{
  "article_text": [
    "this is a revised version of my paper published ( with the same title ) in journal of algebra 259 ( 2003 ) , 142 .",
    "a nucleus of the paper was a part of my ph.d .",
    "thesis supervised by ale drpal ( @xcite ) .",
    "the proof was completed during the postdoctoral stay in turku granted by turku centre for computer science ( tucs ) .",
    "i am grateful especially to juhani karhumki for making that stay possible . when writing the paper i discussed the topic with vesa halava , tero harju , juhani karhumki and juha kortelainen .",
    "after the publication , i received comments from elena ( petre ) czeizler , markku laine and vclav flaka .",
    "the present version was carefully read by ji skora .",
    "i am indebted to all of them for their effort , their comments and suggestions .",
    "the most important difficulty discovered was lemma [ hyper technicke lema ] , which does not hold as it stays in the published text .",
    "the corrected formulation given in the present version is the one from an early draft of the paper .",
    "before the publication , i decided to use a stronger claim , which is in fact never needed in the paper , and which , as it turned out , is fallacious .",
    "elena pointed out some difficulties in the proof , and markku found a counterexample , making it clear that the stronger claim can not be rescued .",
    "the present version was written in october 2007 and august 2012 . the material is partly reorganized , terminology is revised and most proofs rewritten .",
    "i hope that the text is now substantially more readable than the journal version , which is in some places excessively complicated and discouraging . on the other hand , there are no new discoveries and the overall argument remains the same .",
    "binary equality language , i.e. , the set on which two binary morphisms agree , is the most simple non - trivial example of an equality language , the notion of which was introduced in @xcite",
    ". equality languages in general play an important role in formal language theory . for a survey and bibliography see ( * ? ? ?",
    "* section 5 ) .    in the binary case ,",
    "the morphisms are defined on a monoid generated by two letters .",
    "it was for the first time extensively studied by k. ulk ii and j. karhumki in @xcite . there ,",
    "the main claim of our work was conjectured , viz . that a binary equality language is generated by at most two words as soon as at least one of the morphisms is non - periodic ( or , equivalently , injective ) .",
    "an important step towards the proof of the conjecture was made in @xcite where the following partial characterization was obtained .",
    "[ char ] the equality set of two binary morphisms @xmath1 , where @xmath5 , has the following structure :    ( )    [ char1 ] if @xmath6 and @xmath7 are periodic , then either @xmath8 or @xmath9 for some @xmath10 or @xmath11",
    ".    [ char2 ] if exactly one morphism is periodic , then @xmath12 for some word @xmath13 .",
    "[ char3 ] if both @xmath6 and @xmath7 are non - periodic , then either @xmath14 for some words @xmath15 , or @xmath16 for some words @xmath17 .",
    "the question remained open whether the second possibility of case ( [ char3 ] ) , contradicting the conjecture , can actually occur .",
    "in the present paper we show that the answer is negative and , moreover , if @xmath3 and @xmath4 are both nonempty , they start ( and end ) with different letters .",
    "this is formulated in the following main theorem .",
    "[ hlavni veta ] let @xmath1 be non - periodic binary morphisms .",
    "let @xmath3 and @xmath4 , with @xmath18 , be nonempty minimal elements of @xmath0",
    ". then @xmath19    as a trivial consequence we have a solution of the original question .",
    "[ hlavni veta b ] equality language of two nonperiodic binary morphisms is generated by at most two words .",
    "i am not aware of any way how to prove theorem [ hlavni veta b ] not using theorem [ hlavni veta ] .",
    "_ later , in @xcite , it has been shown that the equality sets generated by two words have a precise form .",
    "namely , the following theorem holds true .",
    "let @xmath6 and @xmath7 be distinct nonperiodic binary morphisms such that @xmath0 is generated by two words .",
    "then there is a positive integer @xmath20 such that @xmath21 up to renaming of the letters .",
    "the proof is based on theorem [ hlavni veta ] .    a closely related problem is the size of a test set for binary languages . indeed ,",
    "if two morphisms agree on a language , it must be a subset of their equality language . in @xcite",
    ", it is shown that all binary languages have a three element test set .",
    "our result allows to cut down this bound to two .",
    "let us remark that this improvement is not a simple consequence of the fact that the equality language is generated by two words  the difference in the first ( or last ) letter is a necessary ingredient .",
    "in this section , we fix our notation and recall some basic facts . for a reference and unproved claims see @xcite or @xcite",
    ". if @xmath22 is an alphabet , then let @xmath23 be the free monoid , and @xmath24 the free semigroup generated by @xmath22 .",
    "the empty word is denoted by @xmath25 .",
    "any subset of @xmath23 is called a _",
    "language_. let @xmath26 denote the two - letter alphabet @xmath27 .",
    "the length of the word is denoted by @xmath28 , and @xmath29 denotes the number of occurrences of the letter @xmath30 in @xmath31 .",
    "a _ prefix _ of @xmath31 is any word @xmath32 such that there exists a word @xmath33 with @xmath34 .",
    "the set of all prefixes of @xmath31 is denoted by @xmath35 .",
    "a prefix @xmath36 of @xmath31 is _ proper _ if @xmath37 and @xmath38 .",
    "similarly , _ suffix _ and _ proper suffix _ are defined .",
    "the set of all suffixes of @xmath31 is denoted by @xmath39 .",
    "the first ( the last resp . ) letter of a nonempty word @xmath31 is denoted by @xmath40 ( @xmath41 resp . ) .",
    "a word @xmath36 is called a _ factor _ of @xmath31 if there exist words @xmath42 such that @xmath43 .",
    "if @xmath44 or @xmath45 , then we say that @xmath31 and @xmath36 are _ prefix - comparable _ ( or simply _ comparable _ ) .",
    "the maximal common prefix of words @xmath31 and @xmath36 is denoted by @xmath46 . if @xmath31 and @xmath36 are words , then the maximal _",
    "@xmath31-prefix _ of @xmath36 is the maximal prefix of @xmath36 that is also a prefix of @xmath47 for some @xmath20 .",
    "analogously , we define the maximal @xmath31-suffix of @xmath36 .",
    "we say that two words are _ suffix - comparable _ if one is a suffix of the other .",
    "positive powers @xmath48 of a word are defined as usual , with @xmath49 .",
    "we shall sometimes use also negative powers and work with elements of the free group , in order to simplify notation .",
    "this should not cause any confusion .",
    "for example , if @xmath31 and @xmath36 are comparable , then we shall write @xmath50 even if @xmath36 is a proper prefix of @xmath31 .",
    "in such a case , when @xmath51 , we have @xmath52",
    ".    we shall define regular languages by regular expressions in a standard way .",
    "in particular , the language @xmath53 is denoted by @xmath54 and @xmath55 .",
    "we say that @xmath36 is a prefix ( suffix , factor resp . ) of @xmath54 if @xmath36 is a prefix ( suffix , factor resp . ) of @xmath47 for some @xmath56 .",
    "a nonempty word @xmath31 is called _ primitive _ if and only if @xmath57 implies @xmath58",
    ". the _ primitive root _ of a nonempty word @xmath31 is the ( uniquely given ) primitive word @xmath59 such that @xmath60 .",
    "words @xmath31 and @xmath36 are called _ conjugate _ if @xmath61 and @xmath62 for some words @xmath63 and @xmath64 .",
    "if we speak about minimality or maximality of some element , the implicit ordering is the prefix one , i.e. , @xmath65 if and only if @xmath66 , and @xmath67 if moreover @xmath38 .",
    "( while by the",
    "_ shortest _ word we mean the word with the smallest length . )",
    "let @xmath68 be a word @xmath69 , with @xmath70 and @xmath71 .",
    "then the _ reversal _ of the word @xmath31 , denoted by @xmath72 , is obtained by inverting the order of the letters , viz .",
    "@xmath73 let @xmath6 be an arbitrary morphism .",
    "the _ reversal _ of @xmath6 is the morphism denoted by @xmath74 , which has the same range and domain as @xmath6 , and is defined by @xmath75 for each @xmath76 .",
    "note that in general @xmath77 does not equal to @xmath78 nor to @xmath79 .",
    "instead @xmath80 all concepts and reasonings regarding prefixes are valid analogously for suffixes , reversals considered .",
    "we shall often use the fact .",
    "a morphism @xmath6 defined on @xmath22 is called _ erasing _ if @xmath81 is empty for some @xmath76 .",
    "a morphism @xmath6 is _ periodic _ if there is a word @xmath82 such that @xmath83 , for all words @xmath30 ( or , equivalently , all letters @xmath30 ) .",
    "note that a binary morphism is periodic as soon as it is erasing .",
    "let @xmath84 be a subsemigroup of @xmath24 generated by a set @xmath85 .",
    "the _ rank _ of @xmath85 is the cardinality of the minimal set generating @xmath86 .",
    "we can write @xmath87 by the rank of a monoid @xmath88 we mean the rank of the semigroup @xmath89 .",
    "it is a well known fact that for each set @xmath90 there exists the smallest free subsemigroup of @xmath24 containing @xmath88 and called its _",
    "free hull_. a set generating a free semigroup is called a _",
    "code_. if any two distinct elements of a code are neither prefix nor suffix comparable , the set is called a _ bifix code_.    the _",
    "equality set _ of two morphisms @xmath91 is defined by @xmath92 it is easy to verify that the set @xmath0 is a free submonoid of @xmath93 generated by the set of its minimal elements @xmath94 note that @xmath95 is a bifix code",
    ".    let @xmath96 be a nonperiodic binary morphism .",
    "by @xmath97 we denote the maximal common prefix of @xmath98 and @xmath99 , i.e. @xmath100 since @xmath6 is nonperiodic , we have @xmath101 by lemma [ prim ] below .",
    "if @xmath102 , i.e. @xmath103 , we say that @xmath6 is _",
    "marked_.    similarly we define @xmath104 as the maximal common suffix of @xmath98 and @xmath99 . note that @xmath105 and @xmath106 is equivalent to @xmath74 being marked .",
    "cartesian product @xmath107 is the set of ordered pairs @xmath108 of words .",
    "it can be seen as a monoid with operation of catenation defined by @xmath109 , with the unit @xmath110 .",
    "such a monoid is obviously not free , it is even not isomorphic to a submonoid of a free monoid .",
    "let @xmath111 be two morphisms .",
    "the subset of @xmath107 denoted by @xmath112 and defined by @xmath113 will be called the _ coincidence set _ of morphisms @xmath6 and @xmath7 .",
    "it is generated by the set @xmath114 any pair @xmath115 can be uniquely factorized into minimal pairs @xmath116 satisfying @xmath117 .",
    "this is formulated in the following lemma .",
    "[ freely ] let @xmath6 and @xmath7 be non - erasing morphisms .",
    "then @xmath112 is , as a submonoid of @xmath107 , freely generated by @xmath118 .",
    "moreover , the set @xmath118 is a bifix code .",
    "note that @xmath119 is an element of @xmath112 for each @xmath120 , and @xmath0 is given uniquely by @xmath112 as @xmath121    we present several combinatorial lemmas for future ( often implicit ) reference .",
    "following three lemmas are part of the folklore .",
    "[ prim ] the words @xmath31 and @xmath36 commute if and only if they have the same primitive root .",
    "let @xmath54 and @xmath122 have a common prefix of length @xmath123 .",
    "then the words @xmath31 and @xmath36 commute",
    ".    we shall often use the following lemma .",
    "it is based on the well known fact that a primitive word @xmath82 can not satisfy equality @xmath124 , with @xmath31 and @xmath36 nonempty .",
    "[ factor ]    ( )    [ factor0 ] let @xmath125",
    ". then @xmath31 , @xmath36 and @xmath63 commute .",
    "[ factor3 ]",
    "let @xmath126 be a prefix of @xmath127 .",
    "then @xmath31 and @xmath63 commute .",
    "[ factor1 ] let @xmath128 be a factor of @xmath127 .",
    "then @xmath129 is a suffix of @xmath127 .",
    "[ factor3a ] let @xmath126 be a suffix of @xmath127 and let @xmath63 be a prefix of @xmath126 . then @xmath31 and @xmath63 commute .",
    "[ factor4 ] let @xmath130 , @xmath131 , @xmath63 , @xmath132 be words such that @xmath64 and @xmath63 are conjugate , @xmath133 , and the words @xmath134 , @xmath135 are prefixes of @xmath136 . then @xmath130 is a suffix of @xmath131 and @xmath137 commutes with @xmath63 .    one more lemma , which is easy to prove :    [ gprefix ] let @xmath138 be a marked morphism and let @xmath139 .",
    "then @xmath140 .",
    "the following nice lemma is a key fact about binary morphisms .",
    "[ prefix ] let @xmath141 be a nonperiodic set ( i.e. @xmath142 ) .",
    "let @xmath143 , @xmath144 be words such that @xmath145",
    ". then @xmath146 .",
    "the proof is not difficult ( see @xcite , p. 348 ) .",
    "the lemma immediately implies that for a nonperiodic binary morphism @xmath7 and an arbitrary word @xmath147 long enough , the word @xmath148 is a prefix of @xmath149 and the @xmath150-th letter of @xmath149 indicates the first letter of @xmath31 .",
    "for any @xmath139 we have @xmath151 it is now easy to see that the morphism @xmath152 such that @xmath153 @xmath154 , is well defined .",
    "moreover , it is marked , and the equality ( [ marked definition ] ) holds for any @xmath155",
    ". we shall call it the _ marked version _ of @xmath7",
    ".    * n.b . *",
    "the case @xmath156 is trivial . throughout the paper",
    "we shall implicitly suppose @xmath157 .",
    "in this section we show that at least one of the morphisms @xmath6 and @xmath7 can be supposed to be marked . as we shall see , this will make our research more convenient .",
    "the goal is achieved by choosing a suitable target alphabet .",
    "we say that an ( unordered ) pair of binary morphisms @xmath158 is _ principal _ if the target alphabet @xmath22 generates the free hull of the set @xmath159 .",
    "the previous definition reflects the use of the term `` principal morphism '' in literature ( see for example @xcite , p. 170 ) .",
    "the advantages of principal morphisms stem from the following important property .",
    "let @xmath160 be a finite subset of @xmath23 and let @xmath161 be the minimal generating set of the free hull of @xmath160 . then for each element @xmath162 there is a word @xmath163 such that @xmath164 is a prefix ( suffix resp . ) of @xmath30 .    for the proof see @xcite , lemma 3.1 . for our purpose , note the following immediate corollary .",
    "[ free hull ] let @xmath160 be a finite subset of @xmath23 such that @xmath22 is the base of the free hull of @xmath160 .",
    "then @xmath165    it is quite intuitive that choosing the minimal generating set of the free hull as the target alphabet has no influence on the coincidence set of the morphisms .",
    "the following lemma is formulated for binary morphisms , but it can be trivially extended to any domain alphabet .",
    "[ principalni abeceda ] let @xmath166 , @xmath167 be morphisms @xmath168 .",
    "then there is a principal pair of morphisms @xmath6 , @xmath7 such that @xmath169 moreover , if @xmath166 @xmath167 , @xmath170 , @xmath171 resp .",
    "is marked , then such is also @xmath6 @xmath7 , @xmath74 , @xmath172 resp ..    let @xmath173 be the free hull o the set @xmath174 and let @xmath175 be an alphabet whose cardinality equals the rank of @xmath176 .",
    "then @xmath177 and @xmath176 are isomorphic since they are both free monoids of the same rank ; let @xmath178 be an isomorphism . define morphisms @xmath179 by @xmath180 @xmath181 \\node ( a ) at ( 0,0 ) { $ a^*$ } ; \\node ( f ) at ( 2.5,1 ) { $ f$ } ; \\node ( c ) at ( 2.5,-1 ) { $ c^*$ } ; \\draw[- > ] ( a)--(f ) node [ above , sloped , midway]{{\\small $ g_1,h_1 $ } } ; \\draw[- > ] ( a)--(c ) node [ above , sloped , midway]{{\\small $ g , h$ } } ; \\draw[- > , transform canvas={xshift=-0.9ex } ] ( c)--(f ) node [ left , midway]{{\\small$\\varphi$ } } ; \\draw[- > , transform canvas={xshift=0.9ex } ] ( f)--(c ) node [ right , midway]{{\\small$\\varphi^{-1}$ } } ; \\end{tikzpicture}\\ ] ] then @xmath182 is a principal pair of morphisms , the above diagram commutes , and @xmath183 .",
    "the rest is obvious .",
    "the previous lemma shows that we can always , without loss of generality , suppose that the pair we work with is principal .",
    "we can now prove that this brings about markedness of one of the morphisms .",
    "[ principalni markovanost ] let @xmath6 , @xmath7 be nonperiodic principal morphisms , with @xmath95 nonempty",
    ". then at least one of the morphisms @xmath6 , @xmath7 is marked , and at least one of the morphisms @xmath74 , @xmath172 is marked .",
    "suppose that none of the morphisms is marked , therefore @xmath184 let @xmath30 be a first letter of a word @xmath185 .",
    "then @xmath186 and corollary [ free hull ] implies that the morphisms are periodic , a contradiction",
    ".    obviously , the morphisms @xmath74 , @xmath172 are also principal , since the concept of the free hull is preserved under the reversal symmetry .",
    "this concludes the proof .",
    "in this section , we study the structure of the equality set of nonperiodic morphisms and their relation to the coincidence set .",
    "the previous section justifies why we shall always suppose that @xmath6 is marked .",
    "let @xmath187 be words such that @xmath188 and @xmath189 are comparable . then the word @xmath190 is called an _ overflow _ ( the overflow may be a `` negative '' word if @xmath191 is a prefix of @xmath189 ) .",
    "following lemmas show that the possibility to lengthen the words @xmath31 , @xmath36 to words @xmath192 , @xmath193 such that @xmath194 is very restricted .",
    "namely , the overflow @xmath148 is the only one admitting two different continuations .",
    "[ critical ] let @xmath6 and @xmath7 be binary morphisms , and let @xmath6 be marked .",
    "let @xmath139 be words such that @xmath188 and @xmath189 are comparable and let @xmath195 let @xmath196 be words such that @xmath197 then    * @xmath198 , if @xmath199 ; * @xmath200 , if @xmath201 .    if @xmath130 , @xmath131 , @xmath202 and @xmath203 satisfy the conditions of the lemma , then the same conditions are satisfied also by the words @xmath204 , @xmath205 , @xmath206 and @xmath207 resp .",
    "hence we can suppose that each of the words @xmath208 is longer than @xmath148 .",
    "consider three cases .",
    "first suppose that @xmath209 . by ( [ vsudypritomnyprefix ] )",
    ", @xmath210 is a prefix of both @xmath211 and @xmath212 and @xmath213 since @xmath6 is a marked morphism , this implies that @xmath198 .",
    "@xmath214 2 .",
    "suppose on the other hand that @xmath215 .",
    "then @xmath216 , @xmath217 have the common prefix longer than @xmath148 and @xmath200 is determined by the letter @xmath218 .",
    "@xmath219 3 .",
    "if @xmath220 , then , clearly , @xmath221 .",
    "@xmath222    previous lemma yields the following property .",
    "[ cor1 ] let @xmath6 and @xmath7 be binary morphisms , and let @xmath6 be marked .",
    "let @xmath223 and @xmath224 be distinct elements of @xmath112 , and suppose that @xmath225 and @xmath226 are not comparable . put @xmath227 then @xmath228    we have @xmath229 and @xmath230 where @xmath231 and @xmath232 .",
    "if @xmath233 and @xmath234 are not comparable , then @xmath235 and @xmath236 with @xmath237 and @xmath238 , and the claim follows from lemma [ critical ] .",
    "if @xmath233 and @xmath234 are comparable , then @xmath239 .",
    "since @xmath240 with @xmath241 , lemma [ critical ] yields a contradiction with @xmath232 .",
    "the previous corollary does not hold without the condition that @xmath225 and @xmath226 are not comparable . consider morphisms @xmath242 then @xmath243 , @xmath244 , @xmath245 , and @xmath246    the ground for the characterization of the coincidence set is the following lemma .",
    "[ ef ] let @xmath6 and @xmath7 be binary morphisms , and let @xmath6 be marked .",
    "let the words @xmath247 satisfy following conditions :    ( )    [ ef1 ] @xmath248    [ ef2 ] the words @xmath249 , @xmath250 are minimal , i.e. : if @xmath251 , @xmath252 and @xmath253 , then either @xmath254 or @xmath255 and @xmath256 .",
    "then , given the first letter of @xmath249 or the first letter of @xmath250 , the words @xmath249 and @xmath250 are determined uniquely .",
    "suppose @xmath249 , @xmath250 and @xmath257 , @xmath258 satisfy ( [ ef1 ] ) and ( [ ef2 ] ) , and @xmath259 .",
    "put @xmath260 , @xmath261 .",
    "since @xmath6 is a marked morphism , we have @xmath262 by lemma [ gprefix ] . from ( [ vsudypritomnyprefix ] )",
    "we deduce @xmath263 since @xmath248 and @xmath264 , the equalities ( [ pr1 ] ) , ( [ pr2 ] ) yield @xmath265 since @xmath225 is nonempty , we deduce from ( [ ef2 ] ) that @xmath266 and @xmath267 . similarly",
    "if @xmath268 .",
    "this implies the following lemma .",
    "[ coref ] let @xmath6 and @xmath7 be binary morphisms , and let @xmath6 be marked .",
    "( )    the rank of @xmath269 is at most two .",
    "if the rank of @xmath269 is two and @xmath270 , then @xmath271    recall that @xmath272 to see that @xmath273 the rest is a consequence of lemma [ ef ] .",
    "note that @xmath274 is just another formulation of the fact that @xmath249 , @xmath250 are minimal words satisfying @xmath248 , which are exactly conditions of lemma [ ef ] .",
    "the pairs @xmath275 and @xmath276 are often called _ blocks _ of @xmath6 and @xmath7 .    the question on the structure of the equality set @xmath0",
    "can be seen as a special case of the above considerations .",
    "if conditions @xmath277 are added , then we get the following modifications of lemma [ critical ] , lemma [ cor1 ] , lemma [ ef ] and lemma [ coref ] with analogous proofs , which we omit .",
    "[ critical revisited ] let @xmath6 and @xmath7 be binary morphisms , and let @xmath6 be marked .",
    "let @xmath155 be a word such that @xmath188 and @xmath149 are comparable , and @xmath278 let @xmath231 be words such that @xmath279 then @xmath198 .",
    "[ cor1 revisited ] let @xmath6 and @xmath7 be binary morphisms , and let @xmath6 be marked .",
    "let @xmath225 and @xmath226 be incomparable elements of @xmath0 .",
    "put @xmath280 . then @xmath281    [ ef revisited ]",
    "let @xmath6 and @xmath7 be binary morphisms , and let @xmath6 be marked .",
    "let the word @xmath282 satisfy following conditions :    ( )    @xmath283    the word @xmath249 is minimal , i.e. : if @xmath284 is a prefix of @xmath249 and @xmath285 , then @xmath286 or @xmath287 .",
    "then the word @xmath249 is determined uniquely by its first letter .",
    "[ coref revisited ] let @xmath6 and @xmath7 be binary morphisms , and let @xmath6 be marked .",
    "( )    the rank of @xmath288 is at most two .",
    "if the rank of @xmath288 is two and @xmath289 , then @xmath290    note that the previous lemma proves theorem [ hlavni veta ] for morphisms , which are marked from both sides . in the rest of the paper we show that this is essentially the only situation in which the equality set can have rank greater than one .",
    "marked morphisms are in general much easier to deal with .",
    "that s why it is convenient to work with principal pairs , where one of the morphisms , say @xmath6 , is marked .",
    "moreover , it is always possible to use the marked version @xmath152 instead of @xmath7 to get a marked pair , and thus a better insight into the coincidence set of @xmath6 and @xmath7 .",
    "the block structure of the coincidence set of marked morphisms leads to an important concept of _ successor morphisms _ introduced first in @xcite .",
    "consider marked morphisms @xmath6 and @xmath7 such that @xmath118 consists of two blocks @xmath275 and @xmath276 .",
    "let @xmath63 be an element of @xmath0 .",
    "the equality @xmath291 can be uniquely split into a sequence of blocks .",
    "this means that @xmath63 is an element of @xmath292 , and in the same time an element of @xmath293 .",
    "it is now natural to define the successor morphisms @xmath294 by @xmath295 and to formulate the previous considerations by the following lemma .",
    "[ seq1 ] let @xmath296 be marked morphisms such that @xmath297 then the morphisms @xmath166 , @xmath167 defined by are marked .",
    "if @xmath298 , then there is a unique word @xmath299 such that @xmath300    the morphisms @xmath166 and @xmath167 are marked by lemma [ coref ] .",
    "the existence and uniqueness of the word @xmath301 follows from @xmath302 , and from lemma [ freely ] .",
    "we now have all necessary ingredients for the proof of our main claim , theorem [ hlavni veta ] .",
    "the course of the prove will be essentially by contradiction .",
    "we shall assume that there exists a counterexample to the claim , and gradually show that such an assumption is contradictory .",
    "we first formulate what is understood as a counterexample .",
    "[ counterexample ] we say that a pair of morphisms @xmath182 is a _ counterexample _ if    ( )    [ defa ] the rank of @xmath0 is at least two ;    [ defb ] @xmath6 is marked and @xmath7 is not marked ;    [ delky ] @xmath303 and @xmath304 .",
    "the third condition takes advantage of the symmetry of letters @xmath305 and @xmath306 .",
    "note that the strict inequalities do not harm generality , since @xmath307 or @xmath308 would imply @xmath156 .",
    "since the letters @xmath305 and @xmath306 are not interchangeable anymore , we shall sometimes need the morphism @xmath309 defined by @xmath310 and @xmath311 .",
    "the following lemma yields basic information about the structure of the equality set of a counterexample .",
    "[ counterexample structure ] let @xmath182 be a counterexample",
    ". then there exist nonempty words @xmath312 , @xmath313 and @xmath314 such that @xmath315 , @xmath316 the words @xmath317 , @xmath318 are two distinct elements of @xmath95 and @xmath319 @xmath320    let @xmath31 and @xmath36 be two distinct elements of @xmath95 . note that @xmath31 and @xmath36 are not comparable , and put @xmath321 , @xmath322 and @xmath323 . clearly , @xmath324 and the choice of @xmath313 and @xmath314 is now obvious .",
    "the equalities ( [ zacatek ] ) , ( [ prostredeka ] ) and ( [ prostredekb ] ) are yielded by lemma [ cor1 revisited ] , and @xmath315 follows from @xmath325 .",
    "the equalities , and are of a special importance in the proof .",
    "they represent two points , where the structure of a counterexample is well defined , and which therefore yield information for a combinatorial analysis .",
    "the following lemma makes sure that the counterexample defined above deserves its name .",
    "[ uprava ] let @xmath166 and @xmath167 be nonperiodic binary morphisms such that @xmath326 contains two elements @xmath3 and @xmath4 with the same first letter .",
    "then there is a counterexample @xmath182 such that @xmath327 .",
    "moreover , if @xmath170 ( @xmath171 resp . ) is marked , then also @xmath74 ( @xmath172 resp . )",
    "is marked .",
    "lemma [ principalni abeceda ] yields principal morphisms @xmath6 and @xmath7 such that @xmath327 . by lemma [ principalni markovanost ] and by the symmetry of @xmath6 and @xmath7 , we can suppose that @xmath6 is marked .",
    "similarly , by the symmetry of @xmath305 and @xmath306 , we can suppose that the condition of definition [ counterexample ] is satisfied . in order to see that @xmath182 is a counterexample , it remains to show that @xmath7 is not marked .",
    "if @xmath7 is marked , then both morphisms are marked , and @xmath328 by lemma [ coref revisited ] , contrary to the assumption .",
    "markedness of reversals is conserved by lemma [ principalni abeceda ] .",
    "the further strategy is to show that there is no counterexample .",
    "we shall divide the investigation into several stages .",
    "in this section we investigate two special situations , in which @xmath148 commutes with one of the image words .",
    "we show that those situations lead to a contradiction .",
    "we start with a technical lemma , which will be the core of the proof . in the original version of this paper the claim had the following strong form :    [ hyper technicke lema stare ] _",
    "let @xmath329 be two marked morphisms .",
    "let @xmath31 , @xmath192 , @xmath36 and @xmath330 be words , and @xmath129 , @xmath59 , @xmath331 positive integers such that @xmath332 then @xmath333 .",
    "_    however , as markku laine pointed out by constructing an example , this claim does not hold .",
    "the example is as follows .",
    "let @xmath334 then @xmath335 and @xmath336    we therefore present a bit weaker version , which fits the purpose of this paper .",
    "[ hyper technicke lema ] let @xmath329 be two marked morphisms .",
    "let @xmath31 and @xmath337 be words , and @xmath129 , @xmath59 , @xmath331 positive integers such that @xmath338 then @xmath333 .",
    "recall that we suppose @xmath157 .",
    "( obviously , only @xmath339 is forced if @xmath156 . )",
    "let @xmath6 and @xmath7 be morphisms satisfying assumptions , and suppose that @xmath333 does not hold .",
    "assume , moreover , that @xmath6 and @xmath7 are chosen such that the length of @xmath340 is the smallest possible .",
    "we show that @xmath340 can be shortened , and hence obtain a contradiction .",
    "we first prove that @xmath341 and @xmath342 do not commute .",
    "suppose for a while that @xmath303 , and that @xmath82 is the common primitive root of @xmath341 and @xmath342 . from",
    ", we deduce that @xmath343 is comparable with @xmath344 , which is an element of @xmath345 .",
    "that is a contradiction with @xmath7 being marked . similarly if @xmath346 .",
    "( clearly , @xmath347 implies @xmath156 . )",
    "let us continue the proof of the lemma .",
    "lemma [ gprefix ] applied once to @xmath6 and once to @xmath7 gives @xmath348 1 . if @xmath349 and @xmath350 , then ( [ weq ] ) yields @xmath351 with @xmath352 , @xmath353 .",
    "therefore the words @xmath341 and @xmath342 commute , a contradiction .    \\2 .",
    "suppose next , by symmetry , @xmath354 and @xmath355 . put @xmath356 .",
    "equality ( [ weq ] ) implies @xmath357 where @xmath358 .    the set @xmath112 contains elements @xmath359 and @xmath360 , whence the rank of @xmath112 is two .",
    "let @xmath275 and @xmath276 be the blocks of @xmath6 and @xmath7 , and let @xmath166 , @xmath167 be their successor morphisms defined by .    by symmetry , suppose that @xmath361 .",
    "equality ( [ 1712 ] ) implies that there is a positive integer @xmath362 such that @xmath363 since @xmath341 and @xmath342 do not commute , we deduce that @xmath364 and thus @xmath365 . since @xmath340 and @xmath366 are elements of @xmath367 , both @xmath129 and @xmath331 are multiples of @xmath362 .",
    "put @xmath368 and define words @xmath130 and @xmath202 by @xmath369 since @xmath370 , the words @xmath130 and @xmath202 can be factorized as @xmath371 with @xmath372",
    ". therefore @xmath373 inequality @xmath350 implies @xmath374 , and @xmath365 yields @xmath375 .",
    "this completes the proof .",
    "the following two claims exploit the previous lemma .",
    "the words @xmath312 , @xmath313 and @xmath314 are as in lemma [ counterexample structure ] .",
    "[ nekomutuje s b ] there is no counterexample such that @xmath148 commutes with @xmath376 and @xmath377 .",
    "suppose that @xmath182 is such a counterexample , and let @xmath82 be the common primitive root of @xmath148 and @xmath376 .",
    "let @xmath378 be the maximal @xmath306-prefix of @xmath317 and @xmath379 be the maximal @xmath306-prefix of @xmath380 .",
    "then @xmath381 is the maximal @xmath82-prefix of @xmath382 and @xmath383 is the maximal @xmath82-prefix of @xmath384 .",
    "suppose that @xmath343 commutes with @xmath376 .",
    "since @xmath385 , the equality @xmath386 implies that @xmath341 is comparable with @xmath387 , a contradiction with @xmath6 being marked",
    ". therefore @xmath343 and @xmath376 do not commute .    by lemma [ factor ] , the maximal @xmath82-prefix of @xmath388 is shorter than @xmath389 .",
    "this implies , by , that all words @xmath390 long enough have the same maximal @xmath82-prefix .",
    "in particular , the maximal @xmath82-prefix of @xmath391 is the same as the maximal @xmath82-prefix of @xmath392 . from @xmath393 and @xmath394",
    "we deduce that @xmath395 and @xmath396 .    put @xmath397 and note that @xmath398 is nonempty since @xmath312 contains the letter @xmath305 .",
    "then @xmath399 and lemma [ hyper technicke lema ] , applied to morphisms @xmath400 and @xmath401 , yields a contradiction .",
    "[ nekomutuje s a ] there is no counterexample such that @xmath402 , @xmath148 commutes with @xmath342 , and the common primitive root of @xmath148 and @xmath342 is a suffix of @xmath341 .",
    "as in the previous proof , suppose that @xmath182 satisfies assumptions of the claim and let @xmath82 be the common primitive root of @xmath148 and @xmath342 .",
    "let @xmath403 be the maximal @xmath305-prefix of @xmath318 , and @xmath404 be the maximal @xmath305-prefix of @xmath405 .",
    "first , suppose that @xmath341 commutes with @xmath342 and @xmath148 .",
    "since @xmath6 is marked , the maximal @xmath82-prefix of @xmath406 is @xmath407 . from",
    ", we deduce that the word @xmath148 is the maximal @xmath82-prefix of @xmath408 for any @xmath31 .",
    "hence the maximal @xmath82-prefix of @xmath409 is @xmath410 .",
    "the equality @xmath411 now yields @xmath412 , a contradiction with @xmath303",
    ". therefore @xmath341 and @xmath342 do not commute .",
    "since , by assumption , @xmath82 is a suffix of @xmath341 , lemma [ factor ] implies that the maximal @xmath82-prefix of @xmath413 is equal to the maximal @xmath82-prefix of @xmath341 . using as above , we deduce from that this maximal @xmath82-prefix is equal to @xmath414 . in this case",
    ", the equality @xmath411 implies @xmath415 whence @xmath416 .    for @xmath417",
    "we obtain @xmath418 since @xmath341 and @xmath342 do not commute , we deduce that @xmath419 , whence @xmath420 and morphisms @xmath152 , @xmath6 satisfy assumptions of lemma [ hyper technicke lema ] , a contradiction .",
    "in this section we deal with the situation when @xmath74 is not marked .",
    "note that then @xmath172is marked by lemma [ principalni markovanost ] , and verify that @xmath421 is also a counterexample . recall that @xmath309 exchanges letters @xmath305 and @xmath306 , and it is applied in order to satisfy the condition of definition [ counterexample ] .",
    "this allows to suppose @xmath422 more precisely , if @xmath423 , then we consider @xmath421 , instead of @xmath182 .",
    "the equality ( [ vsudypritomnyprefix ] ) applied to reversals implies that @xmath104 is a suffix of any @xmath188 long enough .",
    "especially , @xmath424 since @xmath148 is a suffix of @xmath425 , which is suffix comparable with @xmath104 , we deduce from that @xmath426 @xmath427 the following claim excludes the situation of this section .",
    "[ spor zg non - empty ] there is no counterexample with @xmath74 not marked .",
    "suppose that @xmath182 is such a counterexample .",
    "suppose first @xmath402 .",
    "the equality @xmath428 yields @xmath429 , and @xmath430 implies that @xmath431 is a prefix of @xmath432 . thus @xmath433 .",
    "let @xmath82 be the common primitive root of @xmath342 and @xmath148 .",
    "from we deduce that @xmath82 is a suffix of @xmath104 , and together with @xmath434 yields that @xmath82 is a suffix of @xmath341 .",
    "this is a contradiction with claim [ nekomutuje s a ] .",
    "suppose then that @xmath377 . from and ( [ zhsufzg ] )",
    "we deduce that @xmath435 is a suffix of @xmath436 .",
    "equalities @xmath428 and @xmath437 imply that @xmath376 is a prefix of @xmath343 , and that @xmath343 is comparable with @xmath435 respectively .",
    "therefore @xmath376 is a prefix of @xmath435 , and lemma [ factor ] yields that @xmath376 and @xmath148 commute , a contradiction with claim [ nekomutuje s b ] .",
    "in this subsection we consider the situation when @xmath74 is marked and @xmath172 is not . we shall not exclude this case directly .",
    "instead we reduce it to the case when both @xmath74 and @xmath172 are marked .    to accomplish this plan",
    "we first we need a description of possible counterexample structure that is more precise than lemma [ counterexample structure ] .",
    "[ presna struktura ] let @xmath182 be a counterexample .",
    "then one of the following possibilities takes place .",
    "( )    [ presna struktura1 ] there exist words @xmath438 , and @xmath439 such that @xmath440 where @xmath441 and @xmath442 @xmath443    [ presna struktura2 ] there exist words @xmath444 such that @xmath445 and @xmath446 @xmath447    let @xmath3 and @xmath4 be two shortest elements of @xmath95 . put @xmath448 , and similarly let @xmath449 be the longest common suffix of @xmath3 and @xmath4 . by lemma",
    "[ cor1 revisited ] , applied first to @xmath6 and @xmath7 , and then to @xmath74 and @xmath172 , we have @xmath450 denote by @xmath451 and @xmath202 the words @xmath452 and @xmath453 . clearly , @xmath454 .",
    "first suppose that @xmath451 and @xmath202 are not suffix - comparable . then with a suitable choice of @xmath455 we have @xmath456 , @xmath457 , and @xmath458 for both @xmath459",
    ".    therefore @xmath460 .",
    "we show that @xmath312 is the unique prefix of @xmath3 ( @xmath4 resp . ) satisfying .",
    "suppose first that @xmath461 and @xmath462 .",
    "then it is easy to see that also @xmath463 , @xmath464 , a contradiction with @xmath3 and @xmath4 being the shortest elements of @xmath95 .",
    "let then @xmath465 , for some @xmath466 , and @xmath467",
    ". then @xmath468 is an element of @xmath0 , which is shorter than @xmath469 .",
    "since @xmath3 and @xmath4 are the shortest elements of @xmath95 , it remains that @xmath470 .",
    "but then @xmath451 and @xmath202 are suffix - comparable , a contradiction .    we still have to show that the set @xmath471 generates whole @xmath0 .",
    "suppose that @xmath63 is an element of @xmath0 such that neither @xmath3 , nor @xmath4 is a prefix of @xmath63 , and consider words @xmath472 , @xmath464 .",
    "lemma [ cor1 revisited ] implies that @xmath473 , for both @xmath464 .",
    "it is easy to deduce that @xmath474 and @xmath301 can not be both equal to @xmath312 , a contradiction with the previous paragraph .",
    "consequently , we have the case ( a ) .",
    "suppose now , by symmetry , that @xmath475 .",
    "then @xmath476 and @xmath477 is a subset of @xmath0 .",
    "moreover , @xmath312 and @xmath478 are the only prefixes of @xmath479 satisfying .",
    "the proof is similar as above : any other prefix satisfying allows to drop a part of the word , which contradicts the minimality of @xmath3 and @xmath4 .",
    "we omit details .",
    "this , in particular , implies that @xmath31 is not a suffix of @xmath312 .",
    "we show that @xmath477 generates the whole equality set .",
    "suppose the contrary , and let @xmath63 be the shortest element of @xmath95 that is not in @xmath477 .",
    "as above , the words @xmath480 and @xmath481 satisfy @xmath473 , @xmath464",
    ". therefore @xmath482 , by the previous paragraph . from @xmath483 ,",
    "one obtains that @xmath301 is strictly longer than @xmath312 , which implies @xmath484 .",
    "therefore @xmath485 , for some @xmath64 .",
    "hence @xmath486 is an element of @xmath95 shorter than @xmath63 , and thus an element of @xmath477 .",
    "therefore @xmath487 and @xmath488 , a contradiction .",
    "we have seen that @xmath31 is not a suffix of @xmath312 .",
    "also @xmath312 can not be a suffix of @xmath31 , otherwise @xmath489 will contradict the minimality of @xmath3 and @xmath4 .",
    "we can therefore define @xmath490 as the longest common suffix of @xmath31 and @xmath312 .",
    "the word @xmath490 is not empty since @xmath148 is a suffix of both @xmath188 and @xmath425 , and @xmath74 is marked .",
    "denote , @xmath491 , @xmath492 and @xmath493 .",
    "note that the word @xmath494 is the longest common suffix of @xmath3 and @xmath4 .",
    "lemma [ cor1 revisited ] applied to @xmath495 yields @xmath496 .",
    "the verification of all claims in case ( b ) is now straightforward .",
    "note that the previous lemma proves , in particular , theorem [ char ] .",
    "the following lemma allows to suppose that both @xmath74 and @xmath172 are marked , which was the task of this section .",
    "[ koncove zh prazdne ] let @xmath182 be a counterexample .",
    "then there exists also a counterexample @xmath294 such that both @xmath170 and @xmath171 are marked .",
    "suppose that @xmath182 is a counterexample .",
    "then @xmath74 is marked by claim [ spor zg non - empty ] .",
    "suppose that @xmath497 and define @xmath166 and @xmath167 by @xmath498 it is not difficult to see that the morphism @xmath167 is well defined , it is not marked while @xmath171 is marked .",
    "it remains to show that @xmath499 has rank at least two .",
    "this is a consequence of the characterization presented in lemma [ presna struktura ] .",
    "( we shall use its notation . )    1.if the case ( [ presna struktura1 ] ) of lemma [ presna struktura ] takes place , then @xmath500 @xmath501 2 . if , on the other hand , we have the case ( [ presna struktura2 ] ) of the lemma [ presna struktura ] , then @xmath502 @xmath503 definitions in lemma [ presna struktura ] yield @xmath504 and @xmath505 , whence the equality set has in both cases rank at least two .",
    "from now on we shall suppose that both @xmath74 and @xmath172 are marked .",
    "consider lemma [ presna struktura ] .",
    "it is easy to note that the case of the lemma has to take place , and moreover , the word @xmath449 is empty .",
    "therefore @xmath506 with @xmath507 , @xmath508 , and @xmath509 .",
    "note the following useful fact .",
    "[ mirror ] let @xmath182 be a counterexample such that @xmath74 and @xmath172 are marked . put @xmath510 and @xmath511 .",
    "then the pair @xmath294 is again a counterexample such that @xmath170 and @xmath171 are marked , and @xmath512    the verification is straightforward .    in this section",
    ", we will also need to assume that the pair @xmath182 is a _",
    "shortest counterexample_. that is , @xmath513 is as small as possible .",
    "shortest counterexample have the following important properties , which can be summarized as : there are no repeated overflows .",
    "the proof is similar to the proof of lemma [ hyper technicke lema ] .",
    "if there is a repeated overflow , then we can decompose the counterexample into blocks , and find a shorter counterexample , namely the pair of successor morphisms .",
    "since both @xmath74 and @xmath172 are marked , we will consider their blocks , which are easier to deal with .",
    "[ shortest1 ] let @xmath182 be a counterexample such that @xmath74 and @xmath172 are marked .",
    "let two nonempty prefixes @xmath514 and @xmath515 of @xmath312 satisfy @xmath516 .",
    "then @xmath182 is not a shortest counterexample .",
    "lemma [ coref ] applied to morphisms @xmath74 and @xmath172 implies that pairs @xmath517",
    ", @xmath518 and @xmath519 can be factorized into a sequence of pairs @xmath520 and @xmath521 such that @xmath522 and @xmath523 . turning to reversals and defining @xmath166 and @xmath167 as in we obtain words @xmath524",
    "such that @xmath525 note also that @xmath170 and @xmath171 are marked by lemma [ seq1 ] .",
    "since @xmath526 is a prefix of both @xmath527 and @xmath528 , the words @xmath63 and @xmath64 have a nonempty common prefix . from @xmath157 , it is also easy to see that @xmath529 .",
    "lemma [ uprava ] concludes the proof .",
    "[ shortest2 ] let @xmath182 be a shortest counterexample such that @xmath74 and @xmath172 marked .",
    "let prefixes @xmath514 , @xmath515 , @xmath530 and @xmath531 of @xmath312 satisfy @xmath532 then @xmath533 and @xmath534 .",
    "recall that we allow to be an equality of two `` negative '' words if @xmath535 and @xmath536 .",
    "proceed by contradiction . without loss of generality",
    ", we can suppose @xmath537 and @xmath538 .",
    "let @xmath130 be the longest common suffix of @xmath514 and @xmath530 , and let @xmath131 be the longest common suffix of @xmath515 and @xmath531 .",
    "we want to show that @xmath539 from and @xmath540 , we deduce @xmath541 if @xmath542 and @xmath543 , then follows from . otherwise , we apply lemma [ cor1 ] to morphisms @xmath74 and @xmath172 ( note that the role of @xmath74 and @xmath172 is interchangeable since both are marked ) , and to pairs @xmath544 to obtain @xmath545 whence follows too .",
    "the rest is lemma [ shortest1 ] .",
    "@xmath546 ( 150pt,\\radek)--(210pt,\\radek ) ; \\draw[dashed ] ( 150pt,-\\radek)--(210pt,-\\radek ) ;   \\streda{40}{15 } \\streda{135}{110 }    \\horuzel{5}{$g(\\sigma_1')$ } \\doluzel{-5}{$h(\\sigma_2')$ }   \\horuzel{105}{$g(u_1)$ } \\doluzel{95}{$h(u_2)$ } \\draw[dashed ] ( 80pt,\\radek)--(80pt,-\\radek ) ;   \\horuhornad{-30}{135}{$g(\\sigma_1)$ }    \\doludolpod{-30}{110}{$h(\\sigma_2)$ }   \\end{tikzpicture}\\ ] ]    as a particular case , we point out the following corollary .    [ shortestcor ]",
    "let @xmath182 be a shortest counterexample such that @xmath74 and @xmath172 marked .",
    "let two prefixes @xmath514 and @xmath515 of @xmath312 satisfy @xmath547 .",
    "then @xmath548 .",
    "[ suba ]    in this subsection we show that the word @xmath312 of a counterexample can not start nor end by the letter @xmath305 .",
    "since @xmath303 and @xmath551 for some @xmath552 , we have @xmath553    [ spor pref a ] there is no counterexample such that both @xmath74 and @xmath172 are marked and @xmath549 or @xmath550 .",
    "let first @xmath549 .",
    "as in the proof of claim [ spor zg non - empty ] , we obtain that @xmath148 and @xmath342 have a common primitive root , say @xmath82 . from",
    "we have that @xmath82 is a suffix of @xmath341 , which yields a contradiction with claim [ nekomutuje s a ] .",
    "the case @xmath550 follows from the same considerations for morphisms @xmath74 and @xmath554 by lemma [ mirror ] .",
    "[ subb ] in this subsection we shall suppose that @xmath182 is a counterexample such that @xmath74 and @xmath172 are marked , and @xmath556 .",
    "we shall restrict possible counterexamples to the case @xmath557 .",
    "we first fix some notation .",
    "[ convention ]     * denote by @xmath558 the maximal integer such that @xmath378 is a prefix of @xmath312 .",
    "* denote by @xmath559 the maximal integer such that @xmath560 is a prefix of @xmath561 . *",
    "denote by @xmath562 the maximal integer such that @xmath563 is a suffix of @xmath564 or @xmath565 ( the one of the two equality words ending with @xmath306 ) . *",
    "denote by @xmath566 the maximal integer such that @xmath567 is a suffix of @xmath312 .",
    "we make use of lemma [ mirror ] and suppose that @xmath568 .",
    "in other words , we shall work either with @xmath182 or with @xmath569 depending on whether @xmath312 has more @xmath306s in the front or in the rear .",
    "we first present some auxiliary lemmas .",
    "[ hb gb nekomutuji ] the words @xmath376 and @xmath343 do not commute .",
    "suppose , for a contradiction , that @xmath82 is the common primitive root of @xmath376 and @xmath343 .",
    "since @xmath304 , we deduce , by @xmath428 , that the first occurrence of @xmath341 in @xmath425 is comparable with @xmath82 , a contradiction with @xmath6 being marked .",
    "[ g(b^l)<h(b ) ] @xmath570 .",
    "the word @xmath343 is comparable with @xmath571 and suffix - comparable with @xmath572 . if @xmath573 , then @xmath376 and @xmath343 commute by lemma [ factor ] , a contradiction with lemma [ hb gb nekomutuji ] . @xmath574    [ dlouhe zh ] @xmath575 .",
    "the word @xmath148 is comparable with @xmath571 , since @xmath148 is comparable with @xmath343 , and @xmath571 is a prefix of @xmath343 .",
    "also @xmath148 is suffix - comparable with @xmath576 , by @xmath428 .",
    "first suppose that @xmath577 .",
    "now , if @xmath578 , then @xmath148 and @xmath376 commute by lemma [ factor ] , a contradiction with claim [ nekomutuje s b ] .",
    "suppose now that @xmath148 is shorter than @xmath376 .",
    "recall that @xmath376 is a prefix of @xmath579 , prefix of @xmath343 , and a suffix of @xmath425 . from @xmath428 and @xmath580",
    "we deduce that there is a word @xmath36 such that @xmath581 and at the same time @xmath582 .",
    "again , the words @xmath376 and @xmath148 commute , a contradiction",
    ". @xmath583    an important step in the proof is the following lemma which shows that @xmath341 can not be too short .",
    "[ existujeu ] @xmath584 .    in this proof",
    "we shall consider occurrences of @xmath376s and @xmath343s in @xmath425 and @xmath585 , and their relative position .",
    "the idea is quite intuitive , but we give a more formal definition .",
    "let @xmath586 be positive integers .",
    "denote by @xmath587 the prefix of @xmath312 such that also @xmath588 is a prefix of @xmath312 , and @xmath589 .",
    "we say that the @xmath20th occurrence of @xmath376 in @xmath425 _ starts _ within the @xmath590th occurrence of @xmath343 in @xmath585 , if @xmath591 similarly , we say that the @xmath20th occurrence of @xmath376 in @xmath425 _ ends _ within the @xmath590th occurrence of @xmath343 in @xmath585 , if @xmath592    lemma [ dlouhe zh ] immplies that the last occurrence of @xmath376 in @xmath425 both starts and ends outside @xmath585 .",
    "therefore , by the pigeon hole principle , there is an occurrence of @xmath343 in @xmath585 such that no occurrence of @xmath376 in @xmath425 starts within it .",
    "similarly , there is an occurrence of @xmath343 in @xmath585 within which no @xmath376 ends . from this",
    "it is easy to deduce that @xmath343 is a prefix of @xmath593 , and a suffix of @xmath594 where @xmath129 is a suffix of @xmath376 or @xmath341 , and @xmath362 is a prefix of @xmath376 or @xmath341 . let @xmath82 be the primitive root of @xmath341 .    by @xmath428 , the words @xmath343 and @xmath595 are prefix comparable .",
    "suppose that @xmath596 is a prefix of @xmath343 .",
    "from the fact that @xmath597 is a prefix of @xmath593 we deduce by lemma [ factor ] that @xmath74 is not marked , a contradiction .",
    "similarly , we obtain a contradiction with @xmath6 being marked , if @xmath598 is a suffix of @xmath343 .",
    "therefore @xmath599 and we are through if @xmath600 .",
    "suppose @xmath601 .",
    "again by a pigeon hole principle , there are at least two occurrences of @xmath343 in @xmath425 with no starting @xmath376 . therefore @xmath343 is a prefix of @xmath602 and @xmath603 , where @xmath604 and @xmath605 are proper suffixes of @xmath376 or @xmath341 .",
    "note that @xmath604 and @xmath605 are overflows in @xmath312 , whence @xmath606 by lemma [ shortest2 ] .",
    "suppose , for a contradiction , that @xmath607 . from @xmath606 , it is then not difficult to deduce that @xmath341 overlaps nontrivially with @xmath608 , whence it is not primitive and @xmath609 . from this and from",
    "we obtain @xmath610 a contradiction with lemma [ g(b^l)<h(b ) ]",
    ".    we can now once more point out two commuting words .",
    "[ hb komutuje ] the word @xmath343 commutes with @xmath611 .",
    "@xmath612    lemma [ dlouhe zh ] and the definition of @xmath566 implies that @xmath576 is a suffix of @xmath148 .",
    "the assumption @xmath568 guarantees that @xmath611 is a well defined prefix of @xmath383 .",
    "let @xmath31 be the word @xmath613 , which is a prefix of @xmath341 by lemma [ existujeu ] .",
    "since @xmath385 and @xmath614 , we have @xmath615 the equality @xmath580 now implies that the word @xmath616 is a prefix of @xmath617 and thus @xmath611 commutes with @xmath343 by lemma [ factor ] .    as a consequence",
    ", we have the claim of this section .",
    "[ bb ] if @xmath182 is a shortest counterexample such that @xmath556 , then @xmath618 .",
    "let @xmath82 be the common primitive root of words @xmath343 and @xmath611 .",
    "recall that , by , the maximal @xmath82-prefix of any @xmath619 is @xmath148 .",
    "we deduce the following .    * the maximal @xmath82-prefix of @xmath620 is @xmath621 . *",
    "the maximal @xmath82-prefix of @xmath622 is @xmath623 , which implies that the maximal @xmath82-prefix of @xmath624 is @xmath625    since @xmath312 contains @xmath305 , both maximal @xmath82-prefixes mentioned above are proper .",
    "let first @xmath626 , and put @xmath627 .",
    "if @xmath628 , then @xmath629 , by lemma [ gprefix ] , a contradiction with lemma [ shortestcor ] .    on the other hand , @xmath630 implies @xmath631 , and lemma [ gprefix ] yields @xmath632 and @xmath633 , a contradiction with lemma [ shortest1 ] .",
    "it remains that @xmath634 , which implies @xmath635 and @xmath636 .",
    "this last case is most difficult because it in a way compresses two places we use for the analysis into one , namely the beginning of @xmath312 and the beginning of @xmath637 .",
    "@xmath638(110pt,\\radek)--(110pt,-\\radek ) ; \\end{tikzpicture}\\ ] ]    therefore , we have to employ a more detailed analysis of @xmath639 .    there is no shortest counterexample with @xmath556 .",
    "claim [ bb ] implies @xmath640 whence @xmath641 let @xmath202 be the longest prefix of @xmath639 ending with @xmath305 and satisfying @xmath642 .",
    "it follows that @xmath643 where @xmath644 , @xmath645 and @xmath646 denote @xmath647 and @xmath648 .",
    "@xmath649 from @xmath650 and @xmath651 we obtain @xmath652    let now @xmath164 be the prefix of @xmath99 of length @xmath343 and let @xmath30 be the word such that @xmath653 .",
    "from we deduce that @xmath654 is a prefix of @xmath617 .",
    "also @xmath655 is a prefix of @xmath617 .",
    "lemma [ factor ] now implies that @xmath656 and @xmath657 are suffix comparable . since @xmath74 is marked and both @xmath30 and @xmath130 are suffix comparable with @xmath341 , we deduce @xmath658 .    from lemma [ existujeu ]",
    ", we obtain that @xmath343 is a prefix of @xmath659 whence the word @xmath660 is a prefix of @xmath661 .",
    "lemma [ factor ] now implies that @xmath662 commutes with @xmath343 .",
    "note that @xmath662 is the maximal @xmath343-suffix of @xmath663 and @xmath664 is the maximal @xmath343-suffix of @xmath665 .",
    "minimality of @xmath565 implies that @xmath666 let @xmath36 be the longest common suffix of @xmath564 and @xmath667 .",
    "we apply lemma [ gprefix ] to @xmath74 and obtain that @xmath191 , which is the longest common suffix of @xmath668 and @xmath663 , is equal either to @xmath662 or to @xmath664 . in both cases , @xmath191 commutes with @xmath343 ; let @xmath82 be their common primitive root .",
    "since @xmath74 is marked , the maximal @xmath82-suffix of @xmath668 is @xmath188 where @xmath31 is the maximal @xmath36-suffix of @xmath564 .",
    "since @xmath172 is marked , the maximal @xmath82-suffix of @xmath669 is @xmath670 .",
    "therefore @xmath671 , where @xmath672 is a prefix of @xmath312 since @xmath673 is a prefix of @xmath585 .",
    "hence @xmath182 is not a shortest counterexample by lemma [ shortest1 ] .",
    "this concludes the proof that there is no counterexample . by lemma",
    "[ uprava ] , two minimal elements @xmath3 and @xmath4 of @xmath0 can not start with the same letter if @xmath6 and @xmath7 are both non - periodic .",
    "clearly , also @xmath74 and @xmath172 are non - periodic and @xmath674 , @xmath675 are minimal elements of @xmath676 .",
    "theorem [ hlavni veta ] is proved .",
    "in this section we show that each binary language has a test set of cardinality at most two .",
    "the result is a consequence of theorem [ char ] and theorem [ hlavni veta ] .",
    "_ test set _ of a language @xmath677 is defined as a subset @xmath85 of @xmath678 such that the agreement of two morphisms on the language @xmath85 guarantees their agreement on @xmath678 .",
    "formally , for any two morphisms @xmath6 and @xmath7 defined on @xmath23 @xmath679    the _ ratio _ of a word @xmath147 is denoted by @xmath680 and defined by @xmath681 if @xmath682 , then @xmath683 a word @xmath31 is said to be _ ratio - primitive _ if no proper prefix of @xmath31 has the same ratio as @xmath31 .",
    "it is not difficult to see that each nonempty word @xmath31 has a unique factorization @xmath684 where each @xmath587 is a nonempty ratio - primitive word such that @xmath685 .",
    "we call it the _ ratio - primitive factorization _ of @xmath31 .",
    "let @xmath686 denote the set of all ratio - primitive words @xmath31 such that @xmath31 occurs in the ratio - primitive factorization of at least one word in @xmath678 .",
    "suppose that all words in @xmath678 have the same ratio .",
    "we first find a test set @xmath701 of cardinality at most two for @xmath686 .",
    "if @xmath686 has cardinality at least three , let @xmath702 where @xmath703 and @xmath704 .",
    "let @xmath6 and @xmath7 be morphisms such that @xmath157 , @xmath694 and @xmath695 . since @xmath31 and @xmath36 are ratio - primitive , lemma [ ratio ] implies that @xmath31 and @xmath36 are minimal elements of @xmath0",
    ". therefore both morphisms are periodic by theorem [ char ] and theorem [ hlavni veta ] . by theorem [ char ]",
    ", we have @xmath705 ."
  ],
  "abstract_text": [
    "<S> we show that the equality set @xmath0 of two non - periodic binary morphisms @xmath1 is generated by at most two words . </S>",
    "<S> if the rank of @xmath2 is two , then @xmath3 and @xmath4 start ( and end ) with different letters .    </S>",
    "<S> this in particular implies that any binary language has a test set of cardinality at most two . </S>"
  ]
}