{
  "article_text": [
    "in many applications it is common to separate observed data into groups ( populations ) indexed by some covariate @xmath0 . a particularly fruitful characterization of grouped data is the use of mixture distributions to describe the populations in terms of clusters of similar behaviors .",
    "viewing observations associated with a group as local data , and the clusters associated with a group as local clusters , it is often of interest to assess how the local heterogeneity is described by the changing values of covariate @xmath0 .",
    "moreover , in some applications the primary interest is to extract some sort of global clustering patterns that arise out of the aggregated observations .",
    "consider , for instance , a problem of tracking multiple objects moving in a geographical area .",
    "using covariate @xmath0 to index the time point , at a given time point @xmath0 we are provided with a snapshot of the locations of the objects , which tend to be grouped into local clusters . over time , the objects may switch their local clusters .",
    "we are not really interested in the movement of each individual object .",
    "it is the paths over which the local clusters evolve that are our primary interest .",
    "such paths are the global clusters .",
    "note that the number of global and local clusters are unknown , and are to be inferred directly from the locally observed groups of data .",
    "the problem of estimating global clustering patterns out of locally observed groups of data also arises in the context of functional data analysis where the functional identity information is not available . by the absence of functional identity information ,",
    "we mean the data are not actually given as a collection of sampled functional curves ( even if such functional curves exist in reality or conceptually ) , due to confidentiality constraints or the impracticality of matching the identity of individual functional curves .",
    "as another example , the progesterone hormone behaviors recorded by a number of women on a given day in their monthly menstrual cycle is associated with a local group , which are clustered into typical behaviors .",
    "such local clusters and the number of clusters may evolve throughout the monthly cycle . moreover , aggregating the data over days in the cycle , there might exist one or more typical monthly ( `` global '' trend ) hormone behaviors due to contraception or medical treatments .",
    "these are the global clusters . due to privacy concern , the subject identity of the hormone levels",
    "are neither known nor matched across the time points @xmath0 . in other words ,",
    "the data are given not as a collection of hormone curves , but as a collection of hormone levels observed over time .    in the foregoing examples ,",
    "the covariate @xmath0 indexes the time .",
    "in other applications , the covariate might index geographical locations where the observations are collected .",
    "more generally , observations associated with different groups may also be of different data types .",
    "for instance , consider the assets of a number of individuals ( or countries ) , where the observed data can be subdivided into holdings according to different currency types ( e.g. , usd , gold , bonds ) . here , each @xmath0 is associated with a currency type , and a global cluster may be taken to represent a typical portforlio of currency holdings by a given individual . in view of a substantial existing body of work drawing from the spatial statistics literature that we shall describe in the sequel , throughout this paper a covariate value @xmath0",
    "is sometimes referred to as a spatial location unless specified otherwise .",
    "therefore , the dependence on varying covariate values @xmath0 of the local heterogeneity of data is also sometimes referred to as the spatial dependence among groups of data collected at varying local sites .",
    "we propose in this paper a model - based approach to learning global clusters from locally distributed data . because the number of both global and local clusters are assumed to be unknown , and",
    "because the local clusters may vary with the covariate @xmath0 , a natural approach to handling this uncertainty is based on dirichlet process mixtures and their variants .",
    "a dirichlet process @xmath1 defines a distribution on ( random ) probability measures , where @xmath2 is called the concentration parameter , and parameter @xmath3 denotes the base probability measure or centering distribution  @xcite .",
    "a random draw @xmath4 from the dirichlet process ( dp ) is a discrete measure ( with probability 1 ) , which admits the well - known `` stick - breaking '' representation  @xcite : @xmath5 where the @xmath6 s are independent random variables distributed according to @xmath3 , @xmath7 denotes an atomic distribution concentrated at @xmath6 , and the stick breaking weights @xmath8 are random and depend only on parameter @xmath2 . due to the discrete nature of the dp realizations , dirichlet processes and their variants",
    "have become an effective tool in mixture modeling and learning of clustered data .",
    "the basic idea is to use the dp as a prior on the mixture components in a mixture model , where each mixture component is associated with an atom in @xmath4 .",
    "the posterior distribution of the atoms provides the probability distribution on mixture components , and also yields a probability distribution of partitions of the data .",
    "the resultant mixture model , generally known as the dirichlet process mixture , was pioneered by the work of  @xcite and subsequentially developed by many others ( e.g. ,  @xcite ) .    a dirichlet process ( dp ) mixture can be utilized to model each group of observations , so a key issue is how to model and assess the local heterogeneity among a collection of dp mixtures . in fact , there is an extensive literature in bayesian nonparametrics that focuses on coupling multiple dirichlet process mixture distributions ( e.g. ,  @xcite ) .",
    "a common theme has been to utilize the bayesian hierarchical modeling framework , where the parameters are conditionally independent draws from a probability distribution . in particular , suppose that the @xmath0-indexed group is modeled using a mixing distribution @xmath9 .",
    "we highlight the hierarchical dirichlet process ( hdp ) introduced by  @xcite , a framework that we shall subsequentially generalize , which posits that @xmath10 for some base measure @xmath3 and concentration parameter @xmath2 .",
    "moreover , @xmath3 is also random , and is distributed according to another dp : @xmath11 .",
    "the hdp model and other aforementioned work are inadequate for our problem , because we are interested in modeling the linkage among the groups _ not _ through the exchangeability assumption among the groups , but through the more explicit dependence on changing values of a covariate @xmath0 .",
    "coupling multiple dp - distributed mixture distributions can be described under a general framework outlined by  @xcite . in this framework ,",
    "a dp - distributed random measure can be represented by the random `` stick '' and `` atom '' random variables ( see eq .  ) , which are general stochastic processes indexed by @xmath12 .",
    "starting from this representation , there are a number of proposals for co - varying infinite mixture models  @xcite .",
    "these proposals were designed for functional data only , i.e. , where the data are given as a collection of sampled functions of @xmath0 , and thus not suitable for our problem , because functional identity information is assumed unknown in our setting . in this regard ,",
    "the work of  @xcite are somewhat closer to our setting .",
    "these authors introduced spatial dependency of the local dp mixtures through the stick variables in a number of interesting ways , while @xcite additionally considered spatially varying atom variables , resulting in a flexible model .",
    "these work focused mostly on the problem of interpolation and prediction , not clustering .",
    "in particular , they did not consider the problem of inferring global clusters from locally observed data groups , which is our primary goal .    to draw inferences about global clustering patterns from locally grouped data , in this paper",
    "we will introduce an explicit notion of and model for global clusters , through which the dependence among locally distributed groups of data can be described .",
    "this allows us to not only assess the dependence of local clusters associated with multiple groups of data indexed by @xmath0 , but also to extract the global clusters that arise from the aggregated observations . from the outset",
    ", we use a spatial stochastic process , and more generally a graphical model @xmath13 indexed over @xmath12 to characterize the centering distribution of global clusters . spatial stochastic process and graphical models are versatile and customary choice for modeling of multivariate data  @xcite . to `` link '' global clusters to local clusters , we appeal to a hierarchical and nonparametric bayesian formalism : the distribution @xmath14 of global clusters is random and distributed according to a dp : @xmath15 . for each @xmath0 , the distribution @xmath9 of local clusters",
    "is assumed random , and is distributed according to a dp : @xmath16 , where @xmath17 denotes the marginal distribution at @xmath0 induced by the stochastic process @xmath14 . in other words , in the first stage , the dirichlet process @xmath14 provides support for _ global atoms _ , which in turn provide support for the _ local atoms _ of lower dimensions for multiple groups in the second stage . due to the use of hierarchy and the discreteness property of the dp realizations , there is sharing of global atoms across the groups . because different groups may share only _ disjoint",
    "_ components of the global atoms , the spatial dependency among the groups is induced by the spatial distribution of the global atoms .",
    "we shall refer to the described hierarchical specification as the nested hierarchical dirichlet process ( nhdp ) model .",
    "the idea of incorporating spatial dependence in the base measure of dirichlet processes goes back to  @xcite , although not in a fully nonparametric hierarchical framework as is considered here .",
    "the proposed nhdp is an instantiation of the nonparametric and hierarchical modeling philosophy eloquently advocated in  @xcite , but there is a crucial distinction : whereas teh and jordan generally advocated for a _ recursive _ construction of bayesian hierarchy , as exemplified by the popular hdp  @xcite , the nhdp features a richer _ nested _ hierarchy : instead of taking a joint distribution , one can take marginal distributions of a random distribution to be the base measure to a dp in the next stage of the hierarchy . this feature is essential to bring about the relationship between global clusters and local clusters in our model .",
    "in fact , the nhdp generalizes the hdp model in the following sense : if @xmath13 places a prior with probability one on constant functions ( i.e. , if @xmath18 then @xmath19 ) then the nhdp is reduced to the hdp .",
    "most closely related to our work is the hybrid dp of  @xcite , which also considers global and local clustering , and which in fact serves as an inspiration for this work . because the hybrid dp is designed for functional data , it can not be applied to situations where functional ( curve ) identity information is not available , i.e. , when the data are not given as a collection of curves .",
    "when such functional i d information is indeed available , it makes sense to model the behavior of individual curves directly , and this ability may provide an advantage over the nhdp . on the other hand , the hybrid dp is a rather complex model , and in our experiment ( see section  [ sec - examples ] ) , it tends to overfit the data due to the model complexity .",
    "in fact , we show that the nhdp provides a more satisfactory clustering performance for the global clusters despite not using any functional i d information , while the hybrid dp requires not only such information , it also requires the number of global clusters ( `` pure species '' ) to be pre - specified .",
    "it is worth noting that in the proposed nhdp , by not directly modeling the local cluster switching behavior , our model is significantly simpler from both viewpoints of model complexity and computational efficiency of statistical inference .",
    "the paper outline is as follows .",
    "section  [ sec - gdp ] provides a brief background of dirichlet processes , the hdp , and we then proceed to define the nhdp mixture model .",
    "section  [ sec - properties ] explores the model properties , including a stick - breaking characterization , an analysis of the underlying graphical and spatial dependency , a plya - urn sampling characterization .",
    "we also offer a discussion of a rather interesting issue intrinsic to our problem and the solution , namely , the conditions under which global clusters can be identified based on only locally grouped data . as with most nonparametric bayesian methods , inference is an important issue .",
    "we demonstrate in section  [ sec - inference ] that the confluence of graphical / spatial with hierarchical modeling allows for efficient computations of the relevant posterior distributions .",
    "section  [ sec - examples ] presents several experimental results , including a comparison to a recent approach in the literature .",
    "section  [ sec - discussions ] concludes the paper .",
    "we start with a brief background on dirichlet processes  @xcite , and then proceed to hierarchical dirichlet processes  @xcite . let @xmath20 be a probability space , and @xmath21 . a dirichlet process @xmath1 is defined to be the distribution of a random probability measure @xmath4 over @xmath22 such that , for any finite measurable partition @xmath23 of @xmath24 , the random vector @xmath25 is distributed as a finite dimensional dirichlet distribution with parameters @xmath26 .",
    "@xmath2 is referred to as the concentration parameter , which governs the amount of variability of @xmath4 around the centering distribution @xmath3 .",
    "a dp - distributed probability measure @xmath4 is discrete with probability one .",
    "moreover , it has a constructive representation due to  @xcite : @xmath27 , where @xmath28 are iid draws from @xmath3 , and @xmath7 denotes an atomic probability measure concentrated at atom @xmath6 .",
    "the elements of the sequence @xmath29 are referred to as `` stick - breaking '' weights , and can be expressed in terms of independent beta variables : @xmath30 , where @xmath31 are iid draws from @xmath32 .",
    "note that @xmath33 satisfies @xmath34 with probability one , and can be viewed as a random probabity measure on the positive integers .",
    "for notational convenience , we write @xmath35 , following  @xcite .",
    "a useful viewpoint for the dirichlet process is given by the plya urn scheme , which shows that draws from the dirichlet process are both discrete and exhibit a clustering property . from a computational perspective , the plya urn scheme provides a method for sampling from the random distribution @xmath4 , by integrating out @xmath4 . more concretely ,",
    "let atoms @xmath36 are iid random variables distributed according to @xmath4 . because @xmath4 is random , @xmath36 are exchangeable .",
    "@xcite showed that the conditional distribution of @xmath37 given @xmath38 has the following form : @xmath39 \\sim \\sum_{l=1}^{i-1}\\frac{1}{i-1+\\alpha_0}\\delta_{\\theta_l } + \\frac{\\alpha_0}{i-1+\\alpha_0}g_0.\\ ] ] this expression shows that @xmath37 has a positive probability of being equal to one of the previous draws @xmath38 .",
    "moreover , the more often an atom is drawn , the more likely it is to be drawn in the future , suggesting a clustering property induced by the random measure @xmath4 . the induced distribution over random partitions of @xmath40 is also known as the chinese restaurant process  @xcite .",
    "a dirichlet process mixture model utilizes @xmath4 as the prior on the mixture component @xmath41 . combining with a likelihood function @xmath42",
    ", the dp mixture model is given as : @xmath43 ; @xmath44 .",
    "such mixture models have been studied in the pioneering work of  @xcite and subsequentially by a number of authors  @xcite , for more recent and elegant accounts on the theories and wide - ranging applications of dp mixture modeling , see  @xcite .    [ [ hierarchical - dirichlet - processes . ] ] hierarchical dirichlet processes .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    next , we proceed giving a brief background on the hdp formalism of  @xcite , which is typically motivated from the setting of grouped data . under this setting ,",
    "the observations are organized into groups indexed by a covariate @xmath12 , where @xmath45 is the index set .",
    "let @xmath46 , @xmath47 be the observations associated with group @xmath0 . for each @xmath0 , the @xmath48",
    "are assumed to be exchangeable .",
    "this suggests the use of mixture modeling : the @xmath49 are assumed identically and independently drawn from a mixture distribution .",
    "specifically , let @xmath50 denote the parameter specifying the mixture component associated with @xmath49 . under the hdp formalism",
    ", @xmath51 is the same space for all @xmath12 , i.e. , @xmath52 for all @xmath0 , and @xmath24 is endowed with the borel @xmath53-algebra of subsets of @xmath24 .",
    "@xmath54 is referred to as _ local factors _ indexed by covariate @xmath0 .",
    "let @xmath55 denote the distribution of observation @xmath49 given the local factor @xmath54 .",
    "let @xmath9 denote a prior distribution for the local factors @xmath56 .",
    "we assume that the local factors @xmath54 s are conditionally independent given @xmath9 . as a result",
    "we have the following specification : @xmath57    under the hdp formalism , to statistically couple the collection of mixing distributions @xmath9 , we posit that random probability measures @xmath9 are conditionally independent , with distributions given by a dirichlet process with base probability measure @xmath3 : @xmath58 moreover , the hdp framework takes a fully nonparametric and hierarchical specification , by positing that @xmath3 is also a random probability measure , which is distributed according to another dirichlet process with concentration parameter @xmath59 and base probability measure @xmath13 : @xmath60 an interesting property of the hdp is that because @xmath9 s are discrete random probability measures ( with probability one ) whose support are given by the support of @xmath3 .",
    "moreover , @xmath3 is also a discrete measure , thus the collection of @xmath9 are random discrete measures sharing the same countable support .",
    "in addition , because the random partitions induced by the collection of @xmath54 within each group @xmath0 are distributed according to a chinese restaurant process , the collection of these chinese restaurant processes are statistically coupled .",
    "in fact , they are exchangeable , and the distribution for the collection of such stoschastic processes is known as the chinese restaurant franchise  @xcite .",
    "* setting and notations . * in this paper we are interested in the same setting of grouped data as that of the hdp that is described by eq .  .",
    "specifically , the observations @xmath61 within each group @xmath0 are iid draws from a mixture distribution .",
    "the local factor @xmath50 denotes the parameter specifying the mixture component associated with @xmath49 .",
    "the @xmath56 are iid draws from the mixing distribution @xmath9 .",
    "implicit in the hdp model is the assumptions that the spaces @xmath51 all coincide , and that random distributions @xmath9 are exchangeble .",
    "both assumptions will be relaxed . moreover ,",
    "our goal here is the inference of global clusters , which are associated with global factors that lie in the product space @xmath62 . to this end",
    ", @xmath63 is endowed with a @xmath53-algebra @xmath64 to yield a measurable space @xmath65 . within this paper and in the data illustrations ,",
    "@xmath66 , and @xmath64 corresponds to the borel @xmath53-algebra of subsets of @xmath67 , formally , a _",
    "global factor _ , which are denoted by @xmath68 or @xmath69 in the sequel , is a high dimensional vector ( or function ) in @xmath63 whose components are indexed by covariate @xmath0 .",
    "that is , @xmath70 , and @xmath71 . as a matter of notations",
    ", we always use @xmath72 to denote the numbering index for @xmath73 ( so we have @xmath54 ) .",
    "we always use @xmath74 and @xmath75 to denote the number index for instances of @xmath68 s and @xmath69 s , respectively ( e.g. , @xmath76 and @xmath77 ) .",
    "the components of a vector @xmath76 ( @xmath77 ) are denoted by @xmath78 ( @xmath79 ) .",
    "we may also use letters @xmath80 and @xmath81 beside @xmath0 to denote the group indices .",
    "[ [ model - description . ] ] model description .",
    "+ + + + + + + + + + + + + + + + + +    our modeling goal is to specify a distribution @xmath14 on the global factors @xmath68 , and to relate @xmath14 to the collection of mixing distributions @xmath9 associated with the groups of data .",
    "such resultant model shall enable us to infer about the _",
    "clusters associated with a global factor @xmath68 on the basis of data collected _ locally _ by the collection of groups indexed by @xmath0 . at a high level , the random probability measures @xmath14 and the @xmath9 s are `` glued '' together under the nonparametric and hierarchical framework , while the probabilistic linkage among the groups are governed by a stochastic process @xmath82 indexed by @xmath12 and distributed according to @xmath13 .",
    "customary choices of such stochastic processes include either a spatial process , or a graphical model @xmath13 .",
    "specifically , let @xmath17 denote the induced marginal distribution of @xmath83 .",
    "our model posits that for each @xmath84 , @xmath9 is a random measure distributed as a dp with concentration parameter @xmath85 , and base probability measure @xmath17 : @xmath86 .",
    "conditioning on @xmath14 , the distributions @xmath9 are independent , and @xmath9 varies around the centering distribution @xmath17 , with the amount of variability given by @xmath85 .",
    "the probability measure @xmath14 is random , and distributed as a dp with concentration parameter @xmath59 and base probability measure @xmath13 : @xmath87 , where @xmath13 is taken to be a spatial process indexed by @xmath84 , or more generally a graphical model defined on the collection of variables indexed by @xmath45 . in summary , collecting the described specifications gives the _ nested hierarchical dirichlet process _",
    "( nhdp ) mixture model : @xmath88 as we shall see in the next section , the @xmath77 s , which are draws from @xmath13 , provide the support for global factors @xmath89 , which in turn provide the support for the local factors @xmath90 .",
    "the global and local factors provide distinct representations for both global clusters and local clusters that we envision being present in data .",
    "local factors @xmath54 s provide the support for local cluster centers at each @xmath0 .",
    "the global factors @xmath68 in turn provide the support for the local clusters , but they also provide the support for global cluster centers in the data , when observations are aggregated across different groups .    [ [ relations - to - the - hdp . ] ] relations to the hdp .",
    "+ + + + + + + + + + + + + + + + + + + + +    both the hdp and nhdp are instances of the nonparametric and hierarchical modeling framework involving hierarchy of dirichlet processes  @xcite . at a high - level ,",
    "the distinction here is that while the hdp is a recursive hierarchy of random probability measures generally operating on the same probability space , the nhdp features a nested hierarchy , in which the probability spaces associated with different levels in the hierarchy are distinct but related in the following way : the probability distribution associated with a particular level , say @xmath9 , has support in the support of the marginal distribution of a probability distribution ( i.e. , @xmath14 ) in the upper level in the hierarchy .",
    "accordingly , for @xmath91 , @xmath9 and @xmath92 have support in distinct components of vectors @xmath68 . for a more explicit comparison ,",
    "it is simple to see that if @xmath13 places distribution for _ constant _ global factors @xmath69 with probability one ( e.g. , for any @xmath93 there holds @xmath94 ) , then we obtain the hdp of  @xcite .",
    "given that the multivariate base measure @xmath14 is distributed as a dirichlet process , it can be expressed using sethuraman s stick - breaking representation : @xmath95 .",
    "each atom @xmath77 is multivariate and denoted by @xmath96 .",
    "the @xmath77 s are independent draws from @xmath13 , and @xmath97 .",
    "the @xmath77 s and @xmath98 are mutually independent .",
    "the marginal induced by @xmath14 at each location @xmath84 is : @xmath99 . since each @xmath17 has support at the points @xmath100 , each @xmath9 necessarily has support at these points as well , and",
    "can be written as : @xmath101    let @xmath102 .",
    "since @xmath9 s are independent given @xmath14 , the weights @xmath103 s are independent given @xmath104 . moreover , because @xmath105 it is possible to derive the relationship between weights @xmath103 s and @xmath98 .",
    "following  @xcite , if @xmath13 is non - atomic , it is necessary and sufficient for @xmath9 defined by eq .   to satisfy @xmath106 that the following holds : @xmath107 , where @xmath103 and @xmath98 are interpreted as probability measures on the set of positive integers .",
    "the connection between the nhdp and the hdp of  @xcite can be observed clearly here : the stick - breaking weights of the nhdp - distributed @xmath9 have the same distributions as those of the hdp , while the atoms @xmath108 are linked by a graphical model distribution , or more generally a stochastic process indexed by @xmath0 .    the spatial / graphical dependency given by base measure @xmath13",
    "induces the dependency between the dp - distributed @xmath9 s .",
    "we shall explore this in details by considering specific examples of @xmath13 .    [ cols=\"^,^,^ \" , ]",
    "[ [ simulation - studies . ] ] simulation studies .",
    "+ + + + + + + + + + + + + + + + + + +    we generate two data sets of spatially varying clustered populations ( see fig .",
    "[ fig - data - ab ] for illustrations ) . in both data sets ,",
    "we set @xmath109 . for data set a ,",
    "@xmath110 global factors @xmath111 are generated from a gaussian process ( gp ) .",
    "these global factors provide support for 15 spatially varying mixtures of normal distributions , each of which has 5 mixture components . the likelihood @xmath112 is given by @xmath113 . for each @xmath0",
    "we generated independently 100 samples from the corresponding mixture ( 20 samples from each mixture components ) .",
    "note that each circle in the figures denote a data sample .",
    "this kind of data can be encountered in tracking problems , where the samples associating with each covariate @xmath0 can be viewed as a snapshot of the locations of moving particles at time point @xmath0 .",
    "the particles move in clusters .",
    "they may switch clusters at any time , but the identification of each particle is _ not _ known as they move from one time step to the next .",
    "the clusters themselves move in relatively smoother paths .",
    "moreover , the number of clusters is not known .",
    "it is of interest to estimate the cluster centers , as well as their moving paths . for data set b , to illustrate the variation in the number of local clusters at different locations , we generate a number of global factors that simulate the bifurcation behavior in a collection of longitudinal trajectories . here",
    "a trajectory corresponds to a global factor .",
    "specifically , we set @xmath114 . starting at @xmath115 there is one global factor , which is a random draw from a relatively smooth gp with mean function @xmath116 , where @xmath117 and the exponential covariance function parameterised by @xmath118 , @xmath119 . at @xmath120 ,",
    "the global factor splits into two , with the second one also an independent draw from the same gp , which is re - centered so that its value at @xmath121 is the same as the value of the previous global factor at @xmath121 . at @xmath122 , the second global factor splits once more in the same manner .",
    "these three global factors provide support for the local clusters at each @xmath12 . the likelihood @xmath55 is given by a normal distribution with @xmath123 . at each @xmath0 we generated 30 independent observations .",
    "although it is possible to perform clustering analysis for data at each location @xmath0 , it is not clear how to link these clusters across the locations , especially given that the number of clusters might be different for different @xmath0 s .",
    "the nhdp mixture model provides a natural solution to this problem .",
    "it is fit for both data sets using essentially the same prior specifications .",
    "the concentration parameters are given by @xmath124 and @xmath125 .",
    "@xmath13 is taken to be a mean-0 gp using @xmath126 for data set a , and @xmath127 for data set b. the variance @xmath128 is endowed with prior @xmath129 .",
    "the results of posterior inference ( via mcmc sampling ) for both data sets are illustrated by fig .",
    "[ fig - global - a ] and fig .",
    "[ fig - global - b ] . with both data sets ,",
    "the number global clusters are estimated almost exactly ( 5 and 3 , respectively , with probability @xmath130 ) .",
    "the evolution of the posterior distributions on the number of local clusters for data set b is given in fig .",
    "[ fig - local - b ] . in both data sets ,",
    "the local factors are accurately estimated ( see figs .",
    "[ fig - global - a ] and  [ fig - global - b ] ) . for data set b , due to the varying number of local clusters ,",
    "there are regions for @xmath0 , specifically the interval @xmath131 $ ] where multiple global factors alternate the role of supporting local clusters , resulting in wider credible bands .",
    "in section  [ sec - properties ] we discussed the implications of prior specifications of the base measure @xmath13 for the identifiability of global factors .",
    "we have performed a sensitivity analysis for data set a , and found that the inference for global factors is robust when @xmath132 is set to be in @xmath133 $ ] . for @xmath134 , for instance , which implies that @xmath135 are weakly dependent across @xmath0 s , we are not able to identify the desired global factors ( see fig .  [ fig - identify ] ) , despite the fact that local factors are still estimated reasonably well .",
    "the effects of prior specification for @xmath136 on the inference of global factors are somewhat similar to the hybrid dp model : a smaller @xmath136 encourages higher numbers of and less smooth global curves to expand the coverage of the function space ( see sec .",
    "7.3 of @xcite ) . within our context , the prior for @xmath136 is relatively more robust than that of @xmath132 as discussed above .",
    "the prior for concentration parameter @xmath59 is extremely robust while the priors for @xmath85 s are somewhat less .",
    "we believe the reason for this robustness is due to the modeling of the global factors in the second stage of the nested hierarchy of dps , and the inference about these factors has the effect of pooling data from across the groups in the first stage . in practice , we take all @xmath85 s to be equal to increase the robustness of the associated prior .    [",
    "[ progesterone - hormone - clustering . ] ] progesterone hormone clustering .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we turn to a clustering analysis of progesterone hormone data .",
    "this data set records the natural logarithm of the progesterone metabolite , measured by urinary hormone assay , during a monthly cycle for 51 female subjects .",
    "each cycle ranges from -8 to 15 ( 8 days pre - ovulation to 15 days post - ovulation ) .",
    "we are interested in clustering the hormone levels per day , and assessing the evolution over time .",
    "we are also interested in global clusters , i.e. , identifying global hormone pattern for the entire monthly cycle and analyzing the effects on contraception on the clustering patterns .",
    "see fig .",
    "[ fig - data - pgd ] for the illustration and  @xcite for more details on the data set .    for prior specifications , we set @xmath137 , and @xmath138 for all @xmath0 .",
    "let @xmath139 . for @xmath13 , we set @xmath140 , @xmath141 and @xmath119",
    ". it is found that the there are 2 global clusters with probability close to 1 .",
    "in addition , the mean estimate of global clusters match very well with the sample means from the two groups of women , a group of those using contraceptives and a group that do not ( see fig .",
    "[ fig - data - pgd - dlp ] ) . examining the variations of local clusters ,",
    "there is a significant probability of having only one local cluster during the first 20 days . between day 21 and 24",
    "the number of local clusters is 2 with probability close to 1 . to elaborate the effects of contraception on the hormone behavior (",
    "the last 17 female subjects are known to use contraception ) , a pairwise comparison analysis is performed .",
    "for every two hormone curves , we estimate the posterior probability that they share the same local cluster on a given day , which is then averaged over days in a given interval .",
    "it is found that the hormone levels among these women are almost indistinguishable in the first 20 days ( with the clustering - sharing probabilities in the range of @xmath142 ) , but in the last 4 days , they are sharply separated into two distinct regimes ( with the clustering- sharing probability between the two groups are dropped to @xmath143 ) .",
    "we compare our approach to the hybrid dirichlet process ( hybrid - dp ) approach  @xcite , perhaps the only existing approach in the literature for joint modeling of global and local clusters .",
    "the data are given to the hybrid - dp as the replicates of a random functional curve , whereas in our approach , such functional identity information is not used .",
    "in other words , for us only a collection of hormone levels across different time points are given ( i.e. , the subject i d of hormone levels are neither revealed nor matched with one another across time points ) .",
    "for a sensible comparison , the same prior specification for base measure @xmath13 of the global clusters were used for both approaches .",
    "the inference results are illustrated in fig .",
    "[ fig - data - pgd - dlp ] .",
    "a close look reveals that the global clusters obtained by the hybrid - dp approach is less faithful to the contraceptive / no contraceptive grouping than ours . this can be explained by the fact that hybrid - dp is a more complex model that directly specifies the local cluster switching behavior for functional curves",
    "it is observed in this example that an individual hormone curve tends to over - switch the local cluster assignments for @xmath144 , resulting in significantly less contrasts between the two group of women ( see fig .",
    "[ fig - heat ] and  [ fig - heat - dlp ] ) .",
    "this is probably due the complexity of the hybrid - dp , which can only be overcome with more data ( see propositions 7 and 8 of  @xcite for a theoretical analysis of this model s complexity and posterior consistency ) .",
    "finally , it is also worth noting that the hybrid - dp approach practically requires the number of clusters to be specified a priori ( as in the so - called @xmath75-hybrid - dp in  @xcite ) , while such information is directly infered from data using the nhdp mixture .",
    "we have described a nonparametric approach to the inference of global clusters from locally distributed data .",
    "we proposed a nonparametric bayesian solution to this problem , by introducing the nested hierarchical dirichlet process mixture model .",
    "this model has the virtue of simultaneous modeling of both local clusters and global clusters present in the data .",
    "the global clusters are supported by a dirichlet process , using a stochastic process as its base measure ( centering distribution ) .",
    "the local clusters are supported by the global clusters . moreover",
    ", the local clusters are randomly selected using another hierarchy of dirichlet processes . as a result",
    ", we obtain a collection of local clusters which are spatially varying , whose spatial dependency is regulated by an underlying spatial or a graphical model .",
    "the canonical aspects of the nhdp ( because of its use of the dirichlet processes ) suggest straightforward extensions to accomodate richer behaviors using poisson - dirichlet processes ( also known as the pittman - yor processes ) , where they have been found to be particularly suitable for certain applications , and where our analysis and inference methods can be easily adapted .",
    "it would also be interesting to consider a multivariate version of the nhdp model .",
    "finally , the manner in which global and local clusters are combined in the nhdp mixture model is suggestive of ways of direct and simultaneous global and local clustering for various structured data types .",
    "the plya - urn characterization suggests a gibbs sampling algorithm to obtain posterior distributions of the local factors @xmath54 s and the global factors @xmath76 s , by integrating out random measures @xmath14 and @xmath9 s . rather than dealing with the @xmath54 s and @xmath145 directly , we shall sample index variables @xmath146 and @xmath147 instead , because @xmath54 s and @xmath76 s can be reconstructed from the index variables and the @xmath77 s .",
    "this representation is generally thought to make the mcmc sampling more efficient .",
    "thus , we construct a markov chain on the space of @xmath148 .",
    "although the number of variables is in principle unbounded , only finitely many are actually associated to data and represented explicitly .    a quantity that plays an important role in the computation of conditional probabilities in this approach is the conditional density of a selected collection of data items , given the remaining data . for a single observation @xmath72-th at location @xmath0 , define the conditional probability of @xmath49 under a mixture component @xmath108 , given @xmath149 and all data items except @xmath49 : @xmath150 similary , for a collection of observations of all data @xmath49 such that @xmath151 for a chosen @xmath74 , which we denote by vector @xmath152 , let @xmath153 be the conditional probability of @xmath152 under the mixture component @xmath154 , given @xmath149 and all data items except @xmath152",
    ".    * sampling @xmath155 . * exploiting the exchangeability of the @xmath146 s within the group of observations indexed by @xmath0 , we treat @xmath146 as the last variable being sampled in the group . to obtain the conditional posterior for @xmath146",
    ", we combine the conditional prior distribution for @xmath146 with the likelihood of generating data @xmath49 .",
    "specifically , the prior probability that @xmath146 takes on a particular previously used value @xmath74 is proportional to @xmath156 , while the probability that it takes on a new value @xmath157 is proportional to @xmath85 .",
    "the likelihood due to @xmath49 given @xmath151 for some previously used @xmath74 is @xmath158 . here , @xmath159 .",
    "the likelihood for @xmath160 is calculated by integrating out the possible values of @xmath161 : @xmath162 where @xmath163 is the prior density of @xmath49 . as a result",
    ", the conditional distribution of @xmath146 takes the form @xmath164 if the sampled value of @xmath146 is @xmath165 , we need to obtain a sample of @xmath161 by sampling from eq .  :",
    "* sampling @xmath167 . * as with the local factors within each group , the global factors @xmath76 s are also exchangeable .",
    "thus we can treat @xmath76 for a chosen @xmath74 as the last variable sampled in the collection of global factors .",
    "note that changing index variable @xmath147 actually changes the mixture component membership for relevant data items ( across all groups @xmath0 ) that are associated with @xmath76 , the likelihood obtained by setting @xmath168 is given by @xmath153 , where @xmath169 denotes the vector of all data @xmath49 such that @xmath151 .",
    "so , the conditional probability for @xmath147 is : @xmath170 where @xmath171 .    *",
    "sampling of @xmath59 and @xmath172 .",
    "* we follow the method of auxiliary variables developed by  @xcite and  @xcite .",
    "endow @xmath59 with a @xmath173 prior . at each sampling step , we draw @xmath174 . then the posterior of @xmath59 is can be obtained as a gamma mixture , which can be expressed as @xmath175 , where @xmath176 .",
    "the procedure is the same for each @xmath85 , with @xmath177 and @xmath178 playing the role of @xmath179 and @xmath180 , respectively .",
    "alternatively , one can force all @xmath85 to be equal and endow it with a gamma prior , as in  @xcite ."
  ],
  "abstract_text": [
    "<S> we consider the problem of analyzing the heterogeneity of clustering distributions for multiple groups of observed data , each of which is indexed by a covariate value , and inferring global clusters arising from observations aggregated over the covariate domain . </S>",
    "<S> we propose a novel bayesian nonparametric method reposing on the formalism of spatial modeling and a nested hierarchy of dirichlet processes . </S>",
    "<S> we provide an analysis of the model properties , relating and contrasting the notions of local and global clusters . </S>",
    "<S> we also provide an efficient inference algorithm , and demonstrate the utility of our method in several data examples , including the problem of object tracking and a global clustering analysis of functional data where the functional identity information is not available .    </S>",
    "<S> inference of global clusters from locally distributed data + xuanlong nguyen + department of statistics + university of michigan    * keywords : * global clustering , local clustering , nonparametric bayes , hierarchical dirichlet process , gaussian process , graphical model , spatial dependence , markov chain monte carlo , model identifiability </S>"
  ]
}