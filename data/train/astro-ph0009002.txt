{
  "article_text": [
    "gravitational lensing has proven to be not only important astrophysically , but intriguing mathematically as well .",
    "mathematical investigations of gravitational lens theory have yielded important results and insights,@xcite employing techniques and results from such disparate areas as catastrophe theory , differential geometry and morse theory . in this paper , we illustrate how another seemingly unrelated subject , multidimensional residue calculus , applies to gravitational lensing , and specifically we explain the origin of certain `` magnification relations '' that have been discussed in the lensing literature.@xcite we additionally demonstrate that calculations of these magnification relations are enormously simplified using residue techniques , and illustrate the method by deriving several new results .",
    "this paper is organized as follows . in the remainder of this section",
    ", we introduce the relevant terminology of gravitational lensing , and describe the magnification relations . in section [ sec :",
    "trace ] , we express the problem in terms of residue calculations at the image positions , and thereby relate it to a residue at infinity .",
    "using one - dimensional residue calculus , we derive trace formulas for the magnification relations for a subset of lens models . in section [ sec : residue ] , we consider the general class of lens models , and describe how to perform the necessary multidimensional residue integrals . in section [ sec : example ] , we apply this formalism and derive previously known results , as well as new results . in section [ sec : discuss ] , we summarize our results and discuss implications . the material discussed in sections [ sec : trace]-[sec : example ] may be unfamiliar to astronomers , and so we provide a simple procedure which may be applied to models to obtain their magnification relations , without requiring a detailed understanding of the underlying mathematics .",
    "numerous excellent introductions to gravitational lensing have been written , e.g. refs .",
    "[ ] ; here we briefly summarize some of the results and terminology relevant to our discussion .",
    "the effects of gravitational lensing can perhaps best be understood by considering the time delay of trajectories connecting the lensed source to the observer.@xcite the time delay is a simple sum of two terms , a `` geometrical '' piece , and a `` gravitational '' piece .",
    "let @xmath0 be the 3-d newtonian potential , and @xmath1 the projected 2-d potential , where @xmath2 is a function of cosmology and the source and lens redshifts .",
    "just as @xmath3 , similarly @xmath4 , where @xmath5 is the surface density . in the thin - screen , small deflection limit",
    ", the time delay can be written as @xmath6 where the normalization @xmath7 depends upon cosmology and the lens and source redshifts , @xmath8 is the image location on the sky , and @xmath9 is the location the source would have had , had not the lens intervened .",
    "light rays follow null geodesics , which can be shown to obey fermat",
    "s principle.@xcite plotting time delay as a function of the two angular coordinates on the sky , fermat s principle demands that images arise at the stationary points of this time delay surface . setting the gradient of the time delay to zero gives the so - called `` lens equations '' , the ( real ) solutions of which are the image positions .",
    "since the time delay surface can have multiple stationary points , multiple images of a single source can arise , and the image multiplicity can depend on the source position relative to the lens .",
    "the curves on the source plane separating regions of different image multiplicity are called caustics . as a source crosses over a caustic , its image multiplicity changes by two , as a pair of images either merge together and annihilate , or are created and move apart .",
    "the magnification @xmath10 , which relates differential area elements of the unlensed source to area elements of the lensed images , is simply the inverse of the jacobian @xmath11 of the mapping from image coordinates @xmath8 to source coordinates @xmath9 . since the orientation of an image can be inverted relative to the unlensed source , the magnification can have either sign .",
    "much of the lensing literature adopts the convention of positive magnifications ( i.e. defining @xmath12 ) ; in this paper we always take the magnification to be signed , i.e. @xmath13 .",
    "two astrophysically important types of lenses are compact objects ( like stars or machos ) and galaxies .",
    "the former class are effectively point masses , and so have lensing potentials proportional to the green s function for the 2-d laplacian , i.e. @xmath14 where @xmath15 is proportional to the mass of the point lens .",
    "only the weak - field regime is observationally relevant , so the potentials linearly superpose for multiple point masses ( as long as they are not appreciably separated along the line of sight ) .",
    "galaxies have more complicated , extended mass distributions with correspondingly complicated lens potentials . in principle",
    ", one may decompose the potential into eigenfunctions of the 2-d laplacian@xcite @xmath16 this has the advantage that each term in the expansion relates to a corresponding multipole in the expansion of the surface density . in practice",
    ", it is necessary to truncate the series due to the limited observational constraints . since galaxies are believed to have roughly `` isothermal '' @xmath17 profiles , such truncated series generally consist of variations on the singular isothermal sphere ( sis ) potential @xmath18 .",
    "two examples considered by @xcite are the sis + elliptical potential @xmath19 and the sis + external shear @xmath20 .",
    "another variation@xcite is the singular isothermal ellipse ( sie ) @xmath21 with axis ratio @xmath22 .",
    "other , more elaborate and more physically justified models have been employed in the lensing literature ; here we will focus on simple models such as the above to avoid obfuscating the general method with heavy algebra . in table",
    "[ tab1 ] we list the models considered in this paper .    given a model for the lens , the lensed images of a given source may be found by solving the lens equations as described above . for simple potentials ,",
    "the solutions are often analytic .",
    "for example , consider the the sis + external shear model .",
    "the stationarity equations become @xmath23 where @xmath24 is the image position in polar coordinates , and @xmath25 is the source position . from this , it is easy to show that the quantity @xmath26 satisfies the fourth degree polynomial equation @xmath27 with @xmath28 . as a quartic equation in @xmath29 ,",
    "this can be solved analytically , and from @xmath29 the image coordinates @xmath24 follow simply . for many models ,",
    "it is possible to eliminate all but one variable in a similar fashion and thereby obtain analytic solutions , but for more realistic models , the lens equations must be solved numerically .      as mentioned above , there are in general multiple lensed images for a given source .",
    "these images lie at the discrete positions satisfying the lens equations for a given source position , and the images have different magnifications and orientations .",
    "if we restrict ourselves to purely real solutions of the lens equations ( i.e. the physically observable images ) then the number of images changes when the source crosses over a caustic",
    ". the number of solutions , of course , does not change , but instead a pair of complex solutions become real ( for a source crossing into a caustic ) or a real pair become complex ( for a source crossing out of a caustic).@xcite for certain lens models , such as the simple potentials described above , there may exist certain parameter ranges such that _ all _ solutions to the lens equations are real . in such cases",
    ", it has been shown that there exist interesting and surprising relations among the image positions and magnifications .",
    "first , @xcite considered lensing by a binary microlensing system , involving two point masses , and derived the following result : when the image multiplicity is maximized , the sum of the signed magnifications of all the images is always 1 .",
    "that is , @xmath30 , independent of quantities such as the lens masses , separation , or source position ( as long as the source is inside a caustic ) .",
    "this is quite an astonishing result , as the individual image magnifications can vary wildly as the source position changes , and even diverge as the source crosses a caustic .",
    "witt & mao derived this result by using resultants to obtain a monic polynomial equation satisfied by @xmath10 , and noted that the sum of the roots is given by the subleading coefficient .",
    "@xcite , using similar reasoning , showed that a similar result is true for an arbitrary number of point mass lenses .",
    "@xcite extended this work to galaxy potentials like those described above .",
    "again , the magnification relations were obtained by using elimination theory ( e.g. grbner bases ) to obtain monic polynomial equations in @xmath10 ; the `` total magnification '' was then given by the subleading coefficient .",
    "we summarize these results in table [ tab1 ] .",
    "subsequently , @xcite showed that for a particular class of power - law models , there exist additional magnification relations , involving not only @xmath10 but the image positions as well .",
    "they derived this result by separating the coupled lens equations into disjoint @xmath31 and @xmath32 equations , and then relating @xmath10 to the coefficients .",
    "just as previous work had derived expressions for @xmath33 , witt & mao found expressions for @xmath34 and @xmath35 .",
    "they called these the `` @xmath36 moments '' , and we adopt their terminology here . for example , they found that the first moment @xmath37 for the sie model .",
    "the general pattern seen in previous work is that both the total magnification and the higher moments can be expressed in terms of the model parameters , and that progressively higher moments have progressively more complicated forms involving more of the parameters .",
    "the expressions independence of certain parameters suggests some sort of invariant , but clearly not a topological invariant since certain models seemed not to obey any magnification relations whatsoever .",
    "indeed , the origin of the magnification relations and their absence in certain models has been a mystery . in this paper , we provide an explanation of these relations , and additionally find a method easier than elimination theory to derive them .      as noted above",
    ", the lens equations have multiple discrete solutions , both real and complex .",
    "while only the real solutions have physical meaning , it is instructive to consider the complex solutions as well . in this paper",
    ", we will henceforth treat the image coordinates @xmath8 as complex variables .",
    "we are interested in the sum over these discrete points of various quantities , such as the signed magnification , or magnification times position , etc . from complex analysis , we know that one may relate a sum over discrete points to an integral over a contour encircling those points , by choosing an integrand which has poles at those points . for lensed images , which are stationary points of the time delay",
    ", there is an obvious class of integrands , namely rational functions of the form @xmath38 there are complications , which we discuss later , due to the fact that the integrals here are multidimensional ; however , the analogy to the one dimensional case should be clear .",
    "we need only find the appropriate function @xmath39 such that @xmath40 will have a residue equaling the quantity we wish to sum over the images , and choose a contour large enough to enclose all the images .",
    "now , converting a discrete sum to a contour integral would nt seem to be much progress , however we can use another idea from one dimensional complex analysis . recall that by inverting coordinates ( mapping the origin to infinity and vice versa ) one can see that the sum of the residues of poles inside the contour is equal to the sum of the residues of poles outside the contour , but with opposite sign . in our case",
    ", we are summing over all the finite solutions , so the only pole outside the contour is at infinity .",
    "this is the essence of the method described in this paper : we relate the sum over the images to the behavior of the time delay at infinity , and we simply evaluate the residue at the point(s ) at infinity .",
    "the validity of the resulting magnification relations does not depend on the image coordinates being real , although of course their physical applicability does .    in the following section , we further utilize ordinary complex analysis of one variable and derive trace formulas for those models for which it is easy to eliminate all but one variable . in section [ sec : residue ]",
    ", we consider the general case , and describe the basics of multivariable residue calculus . in section [ sec : example ] we illustrate with specific examples .",
    "in this paper , we shall focus upon models with polynomial lens equations .",
    "algebraic functions , such as @xmath41th roots , can be accommodated by introducing an additional variable for each algebraic function along with the polynomial equation it satisfies .",
    "for example , an equation containing @xmath42 is handled by introducing @xmath43 satisfying @xmath44 .",
    "the method of this section is useful when all but one variable can be conveniently eliminated from the lens equations , e.g. eq . ( [ extshear ] ) .",
    "of course , this is always possible in principle , but it may require computer implementation of grbner basis algorithms in practice .",
    "thus , we assume that the @xmath31-coordinates of the images are the roots @xmath45 of a polynomial equation of degree @xmath41 , @xmath46 we assume that the signed magnification @xmath47 of an image at @xmath31 is given by a rational function , @xmath48 where the denominator has no common roots with @xmath49",
    ". this will necessarily be the case if the coordinates are chosen generically , since there will then be at most one image at a given @xmath31-coordinate , whose magnification must be a single - valued algebraic function of @xmath31 .",
    "we wish to calculate the total magnification @xmath50 where the  trace \" notation will be explained below .",
    "generically , the roots @xmath45 of @xmath49 will be distinct ; since @xmath51 is determined by continuity when some roots coincide we will always consider the generic case .",
    "let @xmath52 $ ] be the ring of polynomials in @xmath31 with complex coefficients .",
    "we call two polynomials @xmath39 and @xmath53 equivalent , writing @xmath54 , if they differ by a polynomial multiple of @xmath49 .",
    "this sorts the polynomials into equivalence classes , and we denote the class containing @xmath39 by @xmath55 $ ] and the set of all equivalence classes by @xmath56 .",
    "this is of use for our problem because all polynomials in a given class take the same values at the @xmath45 and therefore have the same trace .",
    "addition and multiplication of classes are well - defined by @xmath55+[h]=[g+h],\\ ; [ g][h]=[gh],$ ] and @xmath56 is itself a ring .",
    "now we observe that each class @xmath55 \\in a_f$ ] contains a representative which has degree ( at most ) @xmath57 . indeed , the relation @xmath58 implies @xmath59 and this can be used to eliminate all terms of degree @xmath41 or greater from a polynomial @xmath39 .",
    "the resulting polynomial is unique , being determined by its values at the @xmath41 roots @xmath45 .",
    "it follows that @xmath56 is in fact a vector space of dimension @xmath41 over @xmath60 .",
    "now consider , instead of polynomials , the set @xmath61 of rational functions of @xmath31 which are defined at the zeros of @xmath49 , and call two elements equivalent if their difference is @xmath49 times another element .",
    "then all elements of a class have the same trace , and the set @xmath62 of equivalence classes is again a ring .",
    "in fact , it is isomorphic to @xmath56 .",
    "an isomorphism is obtained by associating to a class @xmath55 $ ] in @xmath56 the obvious class @xmath55 $ ] in @xmath62 . to see that this mapping is invertible , we must find a polynomial representative @xmath39 of an arbitrary class @xmath63 $ ] in @xmath62 .",
    "to do so , simply let @xmath64 be the unique polynomial of degree @xmath57 satisfying @xmath65 for all @xmath66 . then @xmath67 is a rational function vanishing at every @xmath45 , so when expressed in lowest terms its numerator must be a multiple of @xmath49 .",
    "therefore @xmath68 $ ] .    at this point",
    "we can explain the  trace \" terminology for the sum over the roots @xmath45.@xcite the vector space @xmath56 has a basis consisting of ( the classes of ) the @xmath41 polynomials @xmath69 of degree @xmath57 defined by @xmath70 .",
    "fix an element @xmath71 and consider the linear operator on @xmath56 given by multiplication by @xmath39 . in the given basis , the matrix of this operator is diagonal , with entries @xmath72 .",
    "hence the trace of this matrix , which is independent of the basis and coincides with the trace of the operator , is simply @xmath73 .",
    "for example , consider @xmath74 , which just gives the sum of the roots .",
    "choosing the basis @xmath75 for @xmath56 , the matrix of the operator of multiplication by @xmath31 has only one nonzero diagonal entry , @xmath76 , arising from the relation @xmath77 .",
    "this recovers the standard result for the sum of the roots of a polynomial and shows how our method generalizes others based on that result @xcite .",
    "returning to the problem of computing the total magnification , we see that @xmath78 $ ] can be computed using any element in its equivalence class .",
    "for example , we can choose the unique polynomial representative of degree @xmath57 .",
    "of course , we do not determine this polynomial from its values @xmath79 , since we do not know the @xmath45 explicitly .",
    "instead , we seek a polynomial solution of degree @xmath57 to the condition ( [ defmu ] ) defining @xmath80 $ ] , @xmath81 = [ p(x)].\\ ] ] this is solved by using eq .",
    "( [ reduce ] ) to reduce the degree of each side to @xmath57 , and then equating coefficients .    to compute the trace we use a formula due to euler , which we derive by means of the residue theorem for complex contour integrals .",
    "a purely algebraic proof is not difficult @xcite , but our derivation shows the relevance of residue methods and motivates the multivariable generalization which we describe in the following section .",
    "consider the contour integral , @xmath82 where the contour is a large circle in the complex plane enclosing all the zeros @xmath45 of @xmath49 .",
    "the integrand has a pole of residue @xmath79 at @xmath45 , and consequently the integral is @xmath83 .",
    "however , we can also regard the contour as encircling the point at infinity and evaluate the integral in terms of the residue there , introducing if we wish the new variable @xmath84 to move the point at infinity to the origin .",
    "furthermore , the integral is unchanged if @xmath85 is replaced by any member of its equivalence class . by choosing the polynomial representative of degree @xmath57",
    "we need only evaluate @xmath86 this proves euler s formula , @xmath87 where it is understood that the polynomial representative of degree @xmath57 is meant in the numerator .",
    "this makes it clear that the total magnification is determined by the leading behavior of @xmath49 and @xmath85 at infinity .    as an example",
    ", we consider a generalization of the sis + elliptical potential ( @xmath88 multipole ) with an arbitrary harmonic , @xmath89 . as an aid to clarity",
    ", we shall depart from conventional notation , and instead rewrite the lens equations so that the variables are @xmath90 , and parameters are denoted @xmath91 . in this case",
    "we define @xmath92 .",
    "the lens equations then take the form ,    @xmath93    with the magnification satisfying @xmath94 \\mu = 2y.\\ ] ] eliminating @xmath32 results in    @xmath95 \\mu   = \\\\",
    "\\nonumber   ab x^{2 m } & + & cd^{-1 } x^{m+1 } + 2b x^m + cd x^{m-1 } + ab .",
    "\\end{aligned}\\ ] ]    dividing through by @xmath31 and replacing @xmath96 in the resulting equation with a polynomial equivalent via the relation @xmath97 produces    @xmath98 \\mu = \\\\",
    "\\nonumber 2ab x^{2m-1 } & + & ( 1+m^{-1})cd^{-1 } x^m + 2b x^{m-1 } + ( 1-m^{-1})cd x^{m-2},\\end{aligned}\\ ] ]    where the left side is precisely in the euler form @xmath85",
    ". then we immediately have the total magnification invariant as @xmath99 it is no harder to verify that the total magnification is the same for a potential containing an arbitrary finite sum of harmonics @xmath100 ; the highest harmonic determines @xmath51 .",
    "other models are amenable to this method as well .    in principle one can compute moments by this method , by replacing @xmath10 with @xmath101 in the relevant equations , but we have preferred the residue methods of the next section for moment computations .",
    "let us review the key steps in our contour integral derivation of euler s formula in the previous section .",
    "first , we expressed the total magnification as a complex contour integral of a function having poles at the image locations .",
    "second , we converted this to an integral around the point at infinity .",
    "this amounts to viewing the complex plane as a subset of the riemann sphere , or complex projective space @xmath102 .",
    "our change of variables @xmath84 connects two coordinate charts on @xmath102 centered at the origin and at infinity .",
    "finally , we evaluated the residue at infinity , making it clear that the total magnification depends on the behavior of the integrand at infinity .",
    "these steps all have multivariable analogs .",
    "in fact , there is a well - developed , if little - known , residue theory for meromorphic differential forms in several complex variables .",
    "this makes it possible to compute directly the total magnification and moments for lens models without reducing to one - variable lens equations .",
    "the theory is particularly effective in the situation of two variables , and we describe it in this case .",
    "references include [ ] .",
    "an application to chemical reaction rate equations appears in ref .",
    "[ ] , but we are not aware of other physical applications in the literature .",
    "we consider a meromorphic two - form @xmath103 on @xmath104 , which we view as a subset of the compact complex projective space @xmath105 . here",
    "@xmath106 are polynomials having finitely many common zeros ( the image locations ) of multiplicity one ( as is generically the case ) , and @xmath39 is also a polynomial .",
    "such a form can be integrated over a 2-cycle , a compact two - dimensional real submanifold of 2 .",
    "since @xmath107 is closed ( @xmath108 ) , the integral depends only on the homology class of the cycle .",
    "for example , in a small neighborhood of a common zero of the @xmath109 , we can integrate over the  torus \" @xmath110 , defining the residue of @xmath107 at this zero : @xmath111 [ the standard orientation of @xmath112 is that specified by the nonvanishing 2-form @xmath113 .",
    "that is , @xmath112 is oriented so that @xmath114 has positive integral . ]",
    "we will always denote by @xmath11 the naive jacobian of the mapping @xmath115 $ ] , namely @xmath116 this coincides with the physical jacobian relating corresponding area elements in the source and image planes if @xmath90 are rectangular coordinates , and @xmath106 are the corresponding lens equations , but requires a correction factor otherwise .",
    "the first key fact we need is that the residue at a nondegenerate zero ( one where @xmath11 does not vanish ) , located say at the origin , is given by@xcite @xmath117 which is equal to the magnification of the corresponding image if @xmath39 is chosen appropriately ( @xmath118 for rectangular coordinates ) .",
    "moments of magnification can be computed by including additional monomial factors in @xmath119 .    next we need the global residue theorem @xcite , which states that the sum of all the residues of a meromorphic form , such as @xmath107 , on any compact manifold , such as @xmath105 , vanishes .",
    "note that this sum is over the common zeros of the @xmath109 only , so that points where only one polynomial vanishes do not contribute ; also the points summed over may depend on the choice of the factorization @xmath120 of the denominator of @xmath107 .",
    "the theorem makes it possible to replace the sum over the residues at the common zeros in @xmath104 by minus the sum of residues at points at infinity in @xmath105 .",
    "this is the fundamental explanation for the existence of magnification relations in general : compactness relates the sum of finite residues to the behavior of the lens equations at infinity , indeed to a finite number of terms in an expansion around infinity .",
    "it remains to explain how to locate the common zeros at infinity and compute their residues .",
    "@xmath105 is conveniently described by homogeneous coordinates @xmath121 \\neq [ 0,0,0]$ ] , where @xmath122 $ ] is identified with @xmath121 $ ] for all complex @xmath123 .",
    "the points with @xmath124 can be represented in the form @xmath125 $ ] and are viewed as the subset @xmath104 of finite points .",
    "the polynomials @xmath126 correspond to homogeneous polynomials @xmath127 .",
    "their common zeros at infinity are those having @xmath128 .",
    "these also lie in coordinate charts diffeomorphic to @xmath104 , described by @xmath129 $ ] or @xmath130 $ ] . in these charts",
    "they can be treated just as  finite \" zeros are .",
    "the meromorphic form @xmath107 is homogenized so as to have total degree zero , that is ,    @xmath131    when @xmath132 , the denominator of @xmath133 takes the form @xmath134 .",
    "this creates a subtlety in that the above theory applies to a chosen factorization of the denominator into two factors .",
    "thus , we may factor it as @xmath135 and treat these as the two factors in applying the residue theorem .",
    "the common zeros then consist of all ( finite and infinite ) common zeros of the @xmath136 , together with any zeros of @xmath137 alone at infinity .",
    "the latter might have been overlooked in a naive application of the theorem . in the examples we will consider in detail ,",
    "no such additional zeros exist , but we will point out a case where they do .    unfortunately , the zeros at infinity are rarely nondegenerate , and their residues can not be computed using eq .",
    "( [ simple ] ) .",
    "instead , they typically lie at singular points of the curves @xmath138 , that is , at least one curve has multiple branches meeting at this point .",
    "there is a classical method , dating back to newton , for finding the branches of an algebraic curve @xmath139 at a singular point , taken to be the origin .",
    "the branches are given as puiseux series , or fractional power series , of the form @xmath140 where the exponents @xmath141 form an increasing sequence of rational numbers whose denominators eventually stabilize .",
    "the possibilities for the leading exponent @xmath142 are determined by requiring that at least two terms in the polynomial @xmath143 have the same degree , while the remaining terms have higher degree .",
    "then @xmath144 is found by demanding the vanishing of the terms of minimal degree .",
    "an elegant graphical method for identifying the possible exponents @xmath142 is provided by the newton polygon , or diagram @xcite . for each monomial @xmath145 appearing in @xmath146 , plot the point @xmath147 in the coordinate plane .",
    "begin at the lowest of the leftmost points ( minimize @xmath148 , then minimize @xmath149 ) and draw a polygonal path with vertices at a subset of the points , terminating at the leftmost of the lowest points ( minimize @xmath149 , then minimize @xmath148 ) , and choosing each successive segment to have the smallest possible slope ( steepest possible negative slope ) .",
    "this is the newton diagram of the polynomial @xmath146 .",
    "the points lying on any segment of the newton diagram represent terms in @xmath150 which will have minimal degree if @xmath142 is chosen as the negative reciprocal of the slope of that segment . the next term in the puiseux series",
    "can be found by applying the same procedure to @xmath151 , and so on .",
    "one term is often enough for computing the total magnification ; higher moments require more terms in general .",
    "the denominators of the exponents stabilize at the stage where the newton diagram has only a single segment .",
    "the curve @xmath139 has at least as many branches at the origin as there are segments in the newton diagram , and has more if there are multiple solutions to the equations for the coefficients @xmath152 .",
    "consider one particular branch @xmath153 of the curve @xmath154 at a singular point , given by a puiseux series @xmath155 , with @xmath156 relatively prime . on this branch",
    "draw a small circle @xmath157 around the origin ; its projection on the @xmath31-plane must wind @xmath41 times around the origin . now construct a 2-torus @xmath158 by  thickening \" @xmath157 : at any point @xmath159 of @xmath157 take a plane transverse to @xmath153 and a small circle in this plane with center @xmath159 .",
    "as @xmath159 moves around @xmath157 this circle sweeps out the torus @xmath158 .",
    "we may construct such a torus for each branch of the curve .",
    "these are called leray tori , and the  thickening \" operator @xmath160 is the leray coboundary .",
    "our objective is to compute the residue integral @xmath161 at the origin .",
    "we can work entirely within a small ball @xmath162 around the origin .",
    "the residue depends on the homology class of @xmath112 in @xmath163 .",
    "as we explain in the appendix , this class is , up to sign , the sum of the classes of the leray tori constructed on the branches of _ either _ of the curves @xmath164 or @xmath165 .",
    "therefore the residue is the sum of the integrals of @xmath107 over either set of leray tori , with appropriate orientation .",
    "the integral over a leray torus @xmath158 lying on a branch of @xmath154 given by a puiseux series @xmath166 is computed using the leray residue formula .",
    "we give this formula under the assumption that @xmath167 does not vanish on the given branch , which amounts to assuming that @xmath166 is a branch of an irreducible factor of @xmath168 which appears to the first power only ( the analog of a simple rather than multiple pole ) .",
    "the general formula can be found in ref .",
    "our case reads @xmath169 which is proved as follows . to integrate over @xmath158",
    ", we can integrate first over the circles in the planes transverse to @xmath157 , then over @xmath157 itself .",
    "since these circles are centered at @xmath164 , we can change variables from @xmath90 to @xmath170 by means of @xmath171 and then integrate over @xmath168 by means of the one - variable residue theorem .",
    "the evaluation of the residue at @xmath164 by substituting @xmath166 leaves another one - variable residue integral to be performed . for this one must keep in mind that the cycle @xmath157 may wind around the origin several times in the @xmath31-plane .",
    "the leray residue formula holds with obvious notational and possible sign changes if the leray torus lies on a branch of @xmath172 , or if we choose to eliminate @xmath31 rather than @xmath32 in favor of a @xmath109 .",
    "in this section we apply the residue methods just developed to various lens models .",
    "the first is a generalized @xmath173 multipole model with potential @xmath174",
    ". we again redefine notation to clarify the computation , writing the variables as @xmath90 and the parameters as @xmath91 .",
    "let @xmath92 .",
    "the lens equations then take the form , @xmath175 because @xmath90 are not rectangular coordinates , there is an extra jacobian factor in the magnification , and we find @xmath176 consequently the total magnification is given by the residue sum , @xmath177 the residue theorem relates this to the sum of the residues at points at infinity in 2 , which are found from the homogeneous forms of the @xmath109 : @xmath178    the common roots at infinity are those with @xmath128 , and there are two : @xmath121 = [ 1,0,0],$ ] and @xmath179 $ ] .",
    "the total magnification is minus the sum of the residues at these points of @xmath180    consider first the point @xmath181 $ ] , which we examine in the affine chart @xmath121 = [ 1,y , u]$ ] , where    @xmath182    and we need the residue at the origin of @xmath183 .    the newton diagram for @xmath168 is shown in figure 1 ; there is a single branch on which to leading order @xmath184 , as is easily verified by solving @xmath185 for @xmath32 .",
    "the leray formula evaluates the residue as the one - variable residue of @xmath186 where @xmath184 .",
    "but it is easily seen that the leading behavior of this 1-form near @xmath187 is @xmath188 , so that there is no pole and no residue for @xmath189 .",
    "( 240,100)(0,-10 ) ( 0,0)(0,1)100 ( 0,0)(1,0)240 ( 0,30 ) ( 90,0 ) ( 150,0 ) ( 180,-3)(0,1)6 ( 180,30 ) ( 0,30)(3,-1)90 ( 0,106)(0,0)@xmath32 ( 246,0)(0,0)@xmath29 ( -15,30)(0,0)@xmath190 ( 90,-10)(0,0)@xmath15 ( 150,-10)(0,0)@xmath191 ( 180,-10)(0,0)@xmath192    we examine the remaining root @xmath179 $ ] in the chart @xmath121 = [ x,1,u]$ ] where    @xmath193    and we compute @xmath194    the newton diagram for @xmath195 is shown in figure 2 , and gives the leading behavior @xmath196 . with this behavior ,",
    "the lowest - order terms of @xmath195 vanish iff @xmath197 , so that there are @xmath192 branches with @xmath198 .    with the leray formula ,",
    "the total magnification becomes @xmath199 the leading terms are readily identified , and indeed the behavior is as @xmath200 , with residue @xmath201 in terms of the original parameters of the model , @xmath202 an attractive generalization of the known result@xcite for @xmath203 .",
    "( 240,240)(0,-10 ) ( 0,0)(0,1)240 ( 0,0)(1,0)240 ( 0,200 ) ( -3,100)(1,0)6 ( 200,0 ) ( 100,-3)(0,1)6 ( 75,150 ) ( 125,100 ) ( 0,200)(1,-1)200 ( 0,246)(0,0)@xmath29 ( 246,0)(0,0)@xmath31 ( -15,100)(0,0)@xmath15 ( -20,200)(0,0)@xmath192 ( 100,-10)(0,0)@xmath15 ( 200,-10)(0,0)@xmath192    once the branches of the @xmath109 have been identified , it is easy to modify the calculation to compute moments rather than total magnification .",
    "for example , let us compute the first @xmath31-moment , @xmath204 .",
    "( we continue to use the @xmath205 notation for the sum over the images . ) since @xmath206 in terms of the physical variables of this model , from the real and imaginary parts of the result we can obtain the moments weighted by @xmath207 and @xmath208 , in the case that all images are real . in homogeneous coordinates",
    "this simply gives an additional factor @xmath209 in the residue in eq .",
    "( [ shearres ] ) . at the point",
    "@xmath181 $ ] this adds a factor @xmath210 to the one - variable residue ( [ shearresx1 ] ) , changing the behavior to @xmath211 .",
    "there is still no contribution for @xmath212 . at the point",
    "@xmath179 $ ] , there is an extra factor @xmath213 in the residue ( [ shearresy1 ] ) , changing the contribution to @xmath214 which can be evaluated in closed form if desired .    from the real part of @xmath215",
    "we can obtain the moment of @xmath216 , the physical @xmath31-coordinate of the image .",
    "this leads to a factor @xmath217 , which worsens the singularity at @xmath179 $ ] to a double pole , requiring an additional term in the puiseux expansion to obtain the residue .",
    "the result , for the true external shear model @xmath203 , is @xmath218    this example illustrates the general situation .",
    "higher moments produce extra monomial factors in the residue expression . in general",
    "this will worsen the singular behavior at points at infinity , although this may not occur for certain branches , such as those at @xmath179 $ ] in the example of @xmath204 .",
    "this will have two effects : points which do not contribute to the total magnification generally will contribute to higher moments , and more terms in the puiseux expansions will be required for higher moments .",
    "both effects will result in higher moments being given by more complex expressions , with more model parameters contributing .",
    "we turn to a second example , the singular isothermal ellipse ( sie ) potential@xcite . for this model @xmath219 , where @xmath90 are rectangular coordinates and @xmath220 are parameters .",
    "the lens equations are    @xmath221    and the magnification is given by @xmath222 algebraic manipulation leads to the polynomial equations , @xmath223 however , these equations have the extraneous solution @xmath224 , which does not satisfy the original lens equations .",
    "this can be eliminated by substituting @xmath225 , and adopting the modified equations @xmath226 where we have set @xmath227 .",
    "relating the naive jacobian @xmath11 of the @xmath109 with respect to @xmath228 to the hessian of @xmath229 gives the magnification in the new variables , @xmath230    the moments of the magnification with respect to @xmath31 are given by @xmath231 in homogeneous coordinates we have @xmath232 and we need to compute @xmath233 there are two common zeros of the @xmath136 at infinity , namely @xmath234 = [ 1,0,0],\\,[0,1,0]$ ] , and in the corresponding affine charts we have @xmath235 the residues at these zeros may be computed via the leray formula applied to the branches of either @xmath168 or @xmath236 ; we have done both computations and the latter seems slightly simpler . in each case",
    "the branches can be determined directly without appealing to the newton diagrams . at",
    "@xmath179 $ ] , the equation @xmath237 is solved by @xmath238 giving one branch for each choice of sign .",
    "the contribution to @xmath239 from one branch is @xmath240 applying the leray formula gives @xmath241 which simplifies to @xmath242 } = x_s^k,\\ ] ] where only the first term in the series expansion of @xmath31 was required .",
    "the two branches at this point thus contribute @xmath243 to the moment of @xmath244 .    at the remaining point",
    "@xmath181 $ ] , @xmath245 is solved by @xmath246 and we need @xmath247 summed over the two branches . integrating over @xmath248 using the leray residue formula and simplifying yields @xmath249},\\ ] ] where @xmath250 . since @xmath251",
    ", there is no pole for @xmath252 : the total magnification and first moment are simply given by the contributions from @xmath179 $ ] .",
    "there is an additional contribution to the second moment given by @xmath253 , which agrees with the result of ref .",
    "we have verified the results of @xcite through the third moment .",
    "those authors noted that the moments of @xmath31 were independent of @xmath254 to this order , and that  this seems remarkable \" in view of the dependence of @xmath10 on this parameter .",
    "the explanation is that the term @xmath255 in @xmath256 does not contribute to the residue for low moments ; indeed it _ does _ contribute to the residues for the third moment but its contribution cancels between the two branches .",
    "the fourth and higher moments do depend on @xmath254 .",
    "lastly , we note that it is entirely straightforward , and no more work , to generalize the calculation to include an arbitrarily oriented external shear term .",
    "the first moment , for example , takes the form @xmath257 where @xmath258 , @xmath259 , and @xmath260 is the orientation angle of the shear ( see table [ tab1 ] ) .    as our final example we consider microlensing due to a collection of @xmath261 coplanar point masses .",
    "we adopt witt s complex notation , writing @xmath262 for the position of an image and @xmath248 for the position of the source .",
    "the lenses have masses @xmath263 and positions @xmath264 .",
    "the lens equations are    @xmath265    and its complex conjugate ; when we complexify the coordinates @xmath90 of an image , @xmath43 and @xmath266 become independent variables and the conjugate equation becomes an independent condition as well . the observable ( real ) images",
    "are those for which @xmath266 is the conjugate of @xmath43 .",
    "clearing denominators , we set    @xmath267    for the magnification we find @xmath268 where @xmath269 . for the @xmath270th moment of magnification , we must compute @xmath271 the homogeneous polynomials are @xmath272 setting @xmath128 , we obtain @xmath273 , so there are two common zeros at infinity , @xmath274 = [ 1,0,0 ] , \\ , [ 0,1,0]$ ] .",
    "however , we can say more : each of these zeros has multiplicity @xmath261 .",
    "since the homogeneous polynomials each have degree @xmath275 , the number of finite common zeros will be @xmath276 , in agreement with previous results @xcite .",
    "dehomogenizing the polynomials at these points , we find @xmath277 because of the complex conjugation symmetry of these expressions , it suffices to examine the branches of , say , @xmath278 to deduce the others .",
    "the newton diagrams of these are shown in figure 3 . in each case , the puiseux series are ordinary power series . for @xmath168 there is a single branch @xmath279 , while for @xmath236 there are @xmath261 branches @xmath280 .",
    "( 440,240)(0,-10 ) ( 0,0)(0,1)240 ( 0,0)(1,0)120 ( 0,40 ) ( 0,80 ) ( 0,120 ) ( 0,160 ) ( 0,200 ) ( 40,0 ) ( 40,40 ) ( 40,80 ) ( 40,120 ) ( 40,160 ) ( 0,40)(1,-1)40 ( 0,246)(0,0)@xmath29 ( 126,0)(0,0)@xmath43 ( -15,40)(0,0)@xmath190 ( -15,160)(0,0)@xmath261 ( -30,200)(0,0)@xmath275 ( 40,-15)(0,0)@xmath190    ( 200,0)(0,1)240 ( 200,0)(1,0)240 ( 200,200 ) ( 200,160 ) ( 240,160 ) ( 240,120 ) ( 280,120 ) ( 280,80 ) ( 320,80 ) ( 320,40 ) ( 360,40 ) ( 360,0 ) ( 200,160)(1,-1)160 ( 200,246)(0,0)@xmath29 ( 446,0)(0,0)@xmath43 ( 197,40)(1,0)6 ( 185,40)(0,0)@xmath190 ( 185,160)(0,0)@xmath261 ( 170,200)(0,0)@xmath275 ( 240,-3)(0,1)6 ( 240,-15)(0,0)@xmath190 ( 360,-15)(0,0)@xmath261    it is now straightforward to compute the residues @xmath281 and determine the moments .",
    "the first two are @xmath282 and @xmath283 .",
    "the single branch contributes @xmath284 to the @xmath270th moment , while the contribution of the @xmath261 branches becomes progressively more complicated .",
    "we have also considered a generalization of the model to include external shear .",
    "this brings the lens equations to the form@xcite @xmath285 and its complex conjugate . defining @xmath136 as before , their zeros at infinity are @xmath181 $ ] and @xmath286 $ ] for @xmath287 , and @xmath179 $ ] and @xmath288 $ ] for @xmath137 . for @xmath289 there are no common zeros at infinity . factoring the denominator of @xmath133 as @xmath135 , the residue theorem gives the sum over the finite common roots as minus the sum of residues at the infinite roots of @xmath137 .",
    "we find , for example , the total magnification @xmath290 , and the first moment @xmath291 note that the first moment s dependence upon the lens positions has vanished .",
    "lccc model & @xmath292 & @xmath293 & @xmath294 + point masses & @xmath295 & 1 & @xmath296 + point masses + shear & @xmath297 & @xmath298 & @xmath299 + sie & @xmath300 & 2 & @xmath301 + sis + elliptical & @xmath302 & 1 & @xmath303 + sis + shear & @xmath304 & @xmath305 & @xmath306 + sie + shear & @xmath307 & @xmath305 & @xmath308 +",
    "we have introduced in this paper a new framework for analyzing gravitational lens models .",
    "the use of residue integrals makes clear the origin of the magnification relations , and facilitates their computation for a wide class of model potentials .",
    "we have also applied this method to a series of models , confirmed and extended previous results , and provided new magnification relations for several models . although multidimensional residue calculus may be unfamiliar to readers from astronomy , one may follow a simple procedure to perform the necessary integrals . basically , the procedure is as follows :    .    from the stationarity equations , construct two polynomials @xmath106",
    "that simultaneously vanish at ( and only at ) the image positions .",
    "define the `` jacobian '' @xmath309 $ ] , and define @xmath310 where @xmath10 is the magnification .",
    "change to homogeneous coordinates : @xmath311 with @xmath312 and homogenize the polynomials by multiplying each by the factor @xmath313 .",
    "also , multiply @xmath39 by @xmath314 .    from the homogenized @xmath315 ,",
    "construct the 2-form @xmath316 , and factor the denominator into two groups ; usually , the grouping @xmath317 suffices .",
    "( henceforth @xmath106 shall refer to the two groups , not the original polynomials . )",
    "if the denominator contains explicit factors of @xmath318 then redefine one of the polynomials , say @xmath236 , to contain these additional factors .    for @xmath128 ,",
    "find the points @xmath319 where @xmath106 simultaneously vanish ; these are the roots at infinity .",
    "pick one of the polynomials ",
    "say @xmath168  and determine the behavior of @xmath164 in the vicinity of each common root .",
    "first define coordinates for the neighborhood of the root .",
    "for example , if the root is @xmath320 , then a good choice would be @xmath321 .",
    "as discussed , there are in general multiple branches of @xmath164 meeting at the root at infinity , each parametrized by a puiseux series @xmath322 .",
    "the @xmath141 s can be determined from the newton diagram , and by substituting in the specified @xmath141 s one may solve for the coefficients @xmath152 .",
    "usually , only the first one or two terms in the series are necessary .",
    "construct the quantity @xmath323 and pick out the term @xmath324 .",
    "the coefficient of @xmath325 is the contribution for this branch ; summing over all the branches gives the residue for each root .",
    "repeat this procedure for all the roots at infinity , and sum their residues . negating this quantity",
    "gives the sum of the residues at finite poles ( the images ) .",
    "the above is of course just a rough outline ; section [ sec : residue ] describes the method in full detail . following this procedure ,",
    "the results listed in table [ tab1 ] can be reproduced with minimal effort . as mentioned earlier , the newton diagram method of determining the branches near",
    "each pole is effective only if the lens equations can be brought into polynomial form , such as for these simple potentials . for more complicated models , introduction of additional variables",
    "may be necessary to handle fractional powers . our method may not be applicable to models involving transcendental functions , in particular functions with essential singularities at infinity .",
    "@xcite and @xcite have considered the applicability of such magnification relations to real gravitational lenses . for galaxies , @xcite has shown that these relations can be an aid in fitting models to lensed objects , or can be used to rule out models _ a priori_. @xcite have shown , however , that reliance upon simple galaxy models can be misleading , when applied to realistic galaxy potentials .",
    "this limits the applicability of magnification relations to making statements about models , as opposed to statements about the lenses themselves . for microlensing",
    ", however , there is no doubt about the accuracy of the point mass approximation , and as such our derived magnification relations may be considered exact .",
    "@xcite have already shown how the total signed magnification ( `` zeroth moment '' ) can be used for binary microlensing to set lower limits on the overall unsigned magnification , useful for example for detecting source blending .",
    "although the multiple images of a microlensing event can not as yet be resolved , precluding the present - day experimental verification of our prediction regarding the first moment , we are hopeful that the future advent of space - based interferometers will allow our microlensing formulae to be tested observationally .",
    "here we explain why the torus @xmath112 defining the local residue at a singular point , taken to be the origin , is homologous to the sum of the leray tori constructed from the branches of _ either _ of the polynomials @xmath126 , and how to determine the correct orientations .",
    "we are grateful to eduard looijenga and peter teichner for explaining the topology to us . see also section 2.2 of @xcite .",
    "we are working locally in a closed ball @xmath162 around the origin , and we denote by @xmath153 the zero locus @xmath326 within @xmath162 .",
    "the various tori define homology classes in @xmath327 .",
    "it is known that @xmath153 is topologically a cone with vertex the origin and base @xmath328 , which is a linked collection of topological circles @xcite .",
    "denote the several branches of @xmath153 as @xmath329 , and the leray torus built on a given branch as @xmath330 .",
    "let @xmath331 be a path running from the origin to @xmath332 along @xmath329 , and returning to the origin along branch @xmath333 .",
    "a subset of these paths forms a basis for the relative homology group @xmath334 .",
    "furthermore , by alexander duality @xcite , an element of @xmath327 is uniquely determined by its linking numbers with these paths ( indeed , with those in a basis alone ) .",
    "( the linking number @xmath335 of a 1-cycle with a 2-cycle in a 4-ball is the intersection number of @xmath336 with any 3-manifold having boundary @xmath337 . )    the leray tori have linking numbers @xmath338 indeed , the intersection of @xmath331 with a solid torus bounded by @xmath339 is the intersection of @xmath331 with @xmath340 , which is one point if the outward segment of @xmath331 lies on branch @xmath341 , and one point ( with opposite orientation ) if the returning segment does .",
    "the sum @xmath342 of leray tori built on branches of @xmath164 therefore has linking number with @xmath331 equal to @xmath343 if @xmath329 is a branch of @xmath168 and @xmath333 is a branch of @xmath236 , @xmath344 if vice - versa , and @xmath345 if @xmath329 and @xmath333 are branches of the same polynomial .",
    "the sum @xmath346 has the negatives of these linking numbers and therefore represents the same homology class but with opposite orientation .",
    "it remains to show that @xmath112 has the linking numbers of @xmath342 .",
    "a solid torus bounded by @xmath112 is given by @xmath347 .",
    "this meets any branch @xmath341 of @xmath164 given by a puiseux series @xmath166 in the locus @xmath348 on @xmath341 .",
    "this set is topologically a circle around the origin , having intersection number @xmath343 with a path radially outward from the origin .",
    "the solid torus meets no branch of @xmath165 .",
    "therefore , radially outward ( inward ) paths on any branch of @xmath168 contribute @xmath343 ( @xmath344 ) to intersection numbers with this solid torus , while paths on branches of @xmath236 contribute nothing .",
    "this duplicates the linking numbers of @xmath342 .",
    "the orientation for @xmath112 used in this argument is indeed the standard one prescribed in section [ sec : residue ] . using the leray residue formula to evaluate",
    "@xmath349 produces a positive contribution from every branch of @xmath168 .",
    "r. d. blandford & r. narayan , , 568 ( 1986 ) .",
    "p. schneider , j. ehlers , & e. e. falco , _ gravitational lenses _",
    "( springer - verlag , berlin , 1992 ) . h.",
    "j. witt , astron .",
    "astrophys . *",
    "236 * , 311 ( 1990 ) .",
    "a. o. petters , j. math .",
    "phys . * 33 * , 1915 ( 1992 ) .",
    "a. o. petters , j. math .",
    "phys . * 34 * , 3555 ( 1993 ) .",
    "h. levine , a. o. petters , & j. wambsganss , j. math . phys . * 34 * , 4781 ( 1993 ) . h. j. witt & s. mao , lett .",
    "* 447 * , 105 ( 1995 ) .",
    "s. h. rhie , , 63 ( 1997 ) .",
    "n. dalal , lett .",
    "* 509 * , 13 ( 1998 )",
    ". h. j. witt & s. mao , mon . not .",
    "royal astron .",
    "* 311 * , 689 ( 2000 ) . c. s. kochanek , 354 ( 1991 ) .",
    "r. d. blandford & c. s. kochanek , 658 ( 1987 ) .        l.a .",
    "aizenberg , a.k .",
    "tsikh , and a.p .",
    "yuzhakov , in g. m. khenkin and a. g. vitushkin , eds .",
    ", _ several complex variables ii . , encyclopedia of mathematical sciences , vol .",
    "8 , _ ( springer - verlag , berlin heidelberg 1994 ) ."
  ],
  "abstract_text": [
    "<S> we investigate the so - called magnification relations of gravitational lensing models . </S>",
    "<S> we show that multidimensional residue integrals provide a simple explanation for the existence of these relations , and an effective method of computation . </S>",
    "<S> we illustrate the method with several examples , thereby deriving new magnification relations for galaxy lens models and microlensing ( point mass lensing ) . </S>"
  ]
}