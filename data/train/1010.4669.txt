{
  "article_text": [
    "[ sec : intro ] this work deals with water behavior of so  called pooled stepped chutes .",
    "this geometry frequently appears in the real water dams and it also appears in mountain rivers to control the bed load transport . in both cases the main concern is to spill excessive floodwater in additional channels next to the dam structure .",
    "these are called pooled stepped chutes or pooled steps . within the pooled steps",
    "additional weirs perpendicular to the flow direction are introduced to increase energy dissipation .",
    "this problem has been gained some attention in recent years in the engineering community , see e.g. @xcite .",
    "however , only a few mathematical discussions are currently available @xcite .",
    "in particular , the modeling and design of the spillways and stepped channels have so far been addressed using experiments and data fitting techniques , see e.g. @xcite . from the measurements empirical formulas",
    "have been derived and used in sophisticated simulations .",
    "the measurements taking into account complex geometries as well as material properties and the air  water mixture leading to a variety of different empirical formulas and tables @xcite .",
    "so far , the mathematical discussion has been limited to a consideration of the effect of the weir at the end of a spillway _ neglecting _ the dynamics of the water inside the pooled channels . here",
    ", we discuss the mathematical implications of considering the coupled problem , i.e. , the dynamics inside the pooled steps and the ( empirical or theoretical ) conditions imposed closed to the weir .",
    "typically , the water flow in the channels is described by the shallow ",
    "water equations whereas the effect of the weir is given by some algebraic condition .",
    "we treat this problem using a network approach with the conditions at the weir as coupling conditions .",
    "we present a well  posedness result for a simple condition based on energy dissipation .",
    "the recent literature offers several results on the modeling of systems governed by conservation laws on networks .",
    "for instance , in  @xcite the modeling of a network of gas pipelines is considered .",
    "the basic model is the @xmath0-system or , in  @xcite , the full set of euler equations .",
    "the key problem in these papers is the description of the evolution of fluid at a junction between two or more pipes .",
    "a different physical problem , leading to a similar analytical framework , is that of the flow of water in open channels , considered for example in  @xcite .",
    "consider a water flow in an open canal affected by a weir or small dam at the point @xmath1 .",
    "if the water level becomes greater than the height of the weir , some water passes over the weir .",
    "similarly to the models in  @xcite we describe the dynamics of the water by the shallow water equations , while the interaction with the weir is described by coupling conditions .",
    "let @xmath2 be respectively the water level ( with respect to the flat bottom ) and its velocity for @xmath3 .",
    "the shallow ",
    "water equations in each canal are given by @xmath4 where @xmath5 is the gravity constant .",
    "two canals are coupled by so  called pooled steps @xcite .",
    "a sketch of this situation is given in figure [ fig : diga ] .",
    "in the engineering literature @xcite ( see also remark [ remark1 ] ) water of height @xmath6 flowing over a weir of height @xmath7 generates a flow @xmath8 @xmath9 where @xmath10 is a constant depending on the air  water  ratio and the detailed geometry . in many situations @xmath11",
    "the equation ( [ 32law ] ) is called @xmath12law .",
    "formally , it can be derived from the following idea : the potential energy of the water flowing over the weir is transformed to kinetic energy .",
    "hence , we have the balance @xmath13 solving for @xmath14 in terms of @xmath15 we obtain the previous formula and @xmath16 is the percentage of energy loss during the change of potential to kinetic energy .",
    "we use this idea to deduce the coupling condition for ( [ eq : sh ] ) at @xmath17 we conserve the total water over the weir and hence @xmath18 the difference in the amount of water overflowing the weir is @xmath19_+ - \\left[h^+-h^+\\right]_+$ ] .",
    "this defines the velocity ( and its sign ) at the weir according to the balance of potential and kinetic energy .",
    "hence , the coupling conditions are @xmath20_+ -          \\left[h^+-h^+\\right]_+\\right )        \\cdot        \\sqrt{\\left[h^--h^-\\right]_+ -          \\left[h^+-h^+\\right]_+ }      \\\\[10pt ]      h^+v^+ = h^-v^- ,    \\end{cases}\\ ] ] where @xmath21 , @xmath22 , @xmath23 while @xmath24 are the heights of the weir to the left and the right ( see figure [ fig : diga ] ) .",
    "[ remark1 ] obviously , ( [ 32law ] ) is only a first approximation on the complex dynamics at the weir , see @xcite . as outlined in the introduction",
    "there exists a variety of empirical formulas in the engineering community .",
    "many of them include further effects as for example the water  air ratio of the overspill or the roughness of the channel bottom .",
    "for example in ( * ? ?",
    "* equation 7.7 ) the following relation has been determined @xmath25 here , we have @xmath26 and the constants are @xmath27 and @xmath28 . since the coefficient @xmath29 is roughly eight times larger than @xmath30 this equation is very similar to ( [ 32law ] ) .",
    "another example is given in @xcite , ( * ? ? ?",
    "* equation 2.502.51 ) , where the following formula has been proposed for the flow with @xmath31 @xmath32    the case of no weir , i.e. , @xmath33 and @xmath34 , lead to the following studied formulas , e.g. @xcite , ( * ? ? ?",
    "* equation 2.38 ) @xmath35 or @xcite , ( * ? ? ?",
    "* equation 2.392.42 ) @xmath36 we restrict our discussion to the still commonly used ( [ 32law ] ) to outline the ideas . further note that additional empirical formulas for the arising wave in the outgoing pooled step are not needed in our approach , since these dynamics are fully covered by the shallow  water equation .",
    "by riemann problem at the weir we define the problem , with initial data @xmath37    [ def : rp ] a solution to the riemann problem , , is a function @xmath38 such that @xmath39 is self - similar and coincides in @xmath40 with the restriction of the lax solution to the standard riemann problem for with initial data @xmath41 while coincides in @xmath42 with the restriction to of the lax solution to the standard riemann problem for with initial data",
    "@xmath43 moreover @xmath44 satisfy .    for studying the riemann problem",
    "we first collect the standard expressions for the eigenvalues , eigenvectors and lax curves for the shallow water equations .",
    "the @xmath45 system of conservation laws in   has the eigenvalues @xmath46 and the eigenvectors @xmath47 , where @xmath48        r_1(h , v ) & = &        \\left [          \\begin{array}{c }            -1 \\\\            -v + \\sqrt{gh }          \\end{array }        \\right ]        &        r_2(h , v )        & = &        \\left [          \\begin{array}{c }            1 \\\\            v + \\sqrt{gh }          \\end{array}\\right ]      \\end{array}\\ ] ] @xmath49 the lax curves of the first and second family , described in figure  [ fig : curvelax ] , are : @xmath50        v_0 - ( h - h_0 ) \\sqrt{\\frac 12 g \\frac{h + h_0}{hh_0 } } & h > h_0 ,      \\end{cases}\\ ] ] @xmath51        v_0 + ( h - h_0 ) \\sqrt{\\frac 12 g \\frac{h + h_0}{hh_0 } } & h < h_0 .",
    "\\end{cases}\\ ] ] the reversed lax curves of the first and second family are given by : @xmath52        v_0 - ( h - h_0 ) \\sqrt{\\frac 12 g \\frac{h + h_0}{hh_0 } } & h < h_0 ,      \\end{cases}\\ ] ] @xmath53        v_0 + ( h - h_0 ) \\sqrt{\\frac 12 g \\frac{h + h_0}{hh_0 } } & h > h_0 .",
    "\\end{cases}\\ ] ]     plane , width=302 ]    concerning the coupling condition , we study the states which satisfy it at the point @xmath1 . we restrict ourselves to the subsonic region @xmath54 . from ,",
    "since the heights are always positive , it follows @xmath55_+ -          \\left[h^+-h^+\\right]_+\\right).\\ ] ] moreover @xmath56_+ -          \\left[h^+-h^+\\right]_+\\right|^{\\frac 32}\\ ] ] which becomes @xmath57_+ -          \\left[h^+-h^+\\right]_+\\right)\\cdot{\\mathop{\\mathrm{sign}}}v^-,\\ ] ] @xmath58_+ = \\left[h^--h^-\\right]_+ -    \\left(\\frac{h^-\\left|v^-\\right|}{c}\\right)^{\\frac 23 }    \\cdot{\\mathop{\\mathrm{sign}}}v^-.\\ ] ] we have also to add the equality of the fluxes , hence we obtain @xmath59_+ = \\left[h^--h^-\\right]_+ -    \\left(\\frac{h^-\\left|v^-\\right|}{c}\\right)^{\\frac 23 }    \\cdot{\\mathop{\\mathrm{sign}}}v^-\\\\    h^+v^+ = h^-v^- .",
    "\\end{cases}\\ ] ] consider first the case where the water level to the right is below the weir , @xmath60 so that @xmath61_+ = 0 $ ] .",
    "if also @xmath62 then no water crosses the weir , while if @xmath63 the water crosses the weir flowing from left to right .",
    "the left state must satisfy @xmath64 and @xmath65_+ -    \\left(\\frac{h^-\\left|v^-\\right|}{c}\\right)^{\\frac 23 }    = 0,\\ ] ] which can be rewritten as @xmath66_+^{\\frac 32}.\\ ] ] the curve @xmath67 where @xmath68 satisfy consists of all the left states which can be connected to a right state with @xmath60 ( see figure [ fig : curvad ] ) .",
    "we call the support of this curve @xmath69 .",
    "the case @xmath70 , @xmath62 is symmetric , hence we call @xmath71 the support of the curve @xmath72_+^{\\frac 32}.\\ ] ] since @xmath73_+^{\\frac 32}= \\tilde c\\sqrt{g}\\left[h^--h^-\\right]_+^{\\frac 32}\\le \\sqrt{g } \\left({h^-}\\right)^{\\frac 32}$ ] both @xmath69 and @xmath71 lye in the subsonic region .",
    "if both levels are above the weir , then gives a unique state @xmath74 which connects a given state @xmath67 .",
    "we call this function @xmath75",
    ". we have the following lemma .",
    "[ lemma : cons ] consider the @xmath76 plane , and define the following sets depicted in figure [ fig : curvad ] : @xmath77_+^{\\frac{3}{2}}\\right\\},\\\\        \\sigma_l&=\\left\\{(h , hv ) : v < 0,\\ ; 0<h \\le h^- \\right\\},\\\\        a^-&=\\left\\{(h , hv ) : 0 < hv < c\\left[h - h^-\\right]_+^{\\frac{3}{2}}\\right\\},\\\\        b^-&=\\left\\{(h , hv ) : v \\le 0,\\ ; h >",
    "h^- \\right\\},\\\\        \\omega_l&=\\left\\{(h , hv ) : hv < -c\\left[h - h^+\\right]_+^{\\frac{3}{2}}\\right\\},\\\\        \\sigma_u&=\\left\\{(h , hv ) : v > 0,\\ ; 0<h \\le h^+ \\right\\},\\\\        a^+&=\\left\\{(h , hv ) : v > 0,\\ ; h >",
    "h^+ \\right\\},\\\\        b^+&=\\left\\{(h , hv ) : -c\\left[h - h^+\\right]_+^{\\frac{3}{2 } } < hv \\le 0\\right\\}.      \\end{split}\\ ] ] then , we have that the coupling condition induces the following assertions :    * no left state @xmath78 can be connected to any right state @xmath79 and no right state @xmath80 can be connected to any left state @xmath81 ; * any left state in @xmath69 can be connected to any right state in @xmath82 with the same flux : @xmath83 ; * any right state in @xmath71 can be connected to any left state in @xmath84 with the same flux : @xmath83 ; * any left state in @xmath85 can be connected to one and only one right state in @xmath86 and any right state in @xmath86 can be connected to one and only one left state in @xmath85 ; * any left state in @xmath87 can be connected to one and only one right state in @xmath88 and any right state in @xmath88 can be connected to one and only one left state in @xmath87 .    ,",
    "title=\"fig:\",width=234 ] , title=\"fig:\",width=234 ]    we omit the proof since it is a straightforward analysis of the coupling conditions .",
    "we call @xmath89 the one to one map that associates to any left state in @xmath90 the corresponding right state in @xmath91 connected through the coupling condition : @xmath92    we also define @xmath93 in such a way that the left state @xmath94 is connected through the coupling condition to the right state @xmath81 for any + @xmath95 .",
    "we are now able to show that the riemann problem can be solved in the large .    for all states",
    "@xmath96 and @xmath97 in the subsonic region , the riemann problem , , has a unique solution satisfying definition [ def : rp ] , whose constant states depend continuously on the initial data and are constructed glueing together a wave of the first family , the coupling condition and a wave of the second family",
    ".    given two states @xmath96 and @xmath97 in the subsonic region , we proceed in the following way for solving the riemann problem .",
    "draw the lax curve of the first family in the @xmath76 plane through @xmath96 . since , in the subsonic region , it is strictly decreasing",
    ", it intersects in one and only one point ( with @xmath98 ) the convex and non decreasing curve @xmath69 .",
    "we call the unique point of intersection @xmath99 .",
    "then , we consider the non increasing curve @xmath100 next , we take the inverse lax curve related to the second characteristic field passing through the right state @xmath97 .",
    "this curve is strictly increasing in the subsonic region and in the upper supersonic region , therefore it has one and only one point of intersection with @xmath101 ( for positive @xmath15 ) , denoted by @xmath102 .",
    "this point might belong to the upper supersonic region .",
    "the riemann problem is finally solved in the following way : take the subsonic ( or lower supersonic ) state @xmath103 on the first lax curve such that @xmath104 and connect @xmath96 to @xmath103 with a wave of the first family .",
    "this wave has negative velocity since the curve belongs entirely to the subsonic region or to the subsonic region and the lower supersonic one .",
    "then , the points @xmath103 and @xmath102 satisfy the coupling conditions .",
    "finally @xmath102 and @xmath97 are connected by a wave of the second family which travels with positive velocity even if @xmath102 happens to be in the upper supersonic region , see figure [ fig : rimprob ] .",
    "this section is devoted to show the well  posedness of the cauchy problem for system for initial data around a constant subsonic state satisfying the coupling condition . for simplicity",
    "we suppose that the water level to the right of the weir is below the weir level , that is @xmath105 .",
    "this implies that the water can only flow from the left to the right of the weir when its left level overflows the weir .",
    "[ mainthm ] given @xmath106 and two constant states in the subsonic region @xmath107 and @xmath108 such that @xmath109_+^{\\frac 32},\\quad h_0v_0 = h_1v_1,\\quad      h_0 > h_0 ^ -,\\quad h_1 < h^+,\\ ] ] then , there exists a closed domain @xmath110 containing all functions with sufficiently small total variation in @xmath40 and @xmath42 and semigroups @xmath111 defined for all @xmath112 sufficiently close to @xmath113 , such that    1 .",
    "[ it : semigroup ] for all @xmath114 and @xmath115 @xmath116 2 .",
    "[ it : lipschitz ] for all @xmath117 , @xmath118 in a suitable neighborhood of @xmath113 and @xmath119 : @xmath120 3 .",
    "[ it : tangent ] if @xmath115 is piecewise constant , then for @xmath121 small , @xmath122 is the glueing of solutions to riemann problems at the points of jump in @xmath123 and at the weir in @xmath1 ; 4 .   [",
    "it : solution ] for all @xmath124 , the map @xmath125 is a weak entropy solution to  , ( see ( * ? ? ?",
    "* definition 4.1 ) , ( * ? ? ?",
    "* definition 2.1 ) ) .",
    "@xmath126 is uniquely characterized by  [ it : semigroup ] ) , [ it : lipschitz ] ) and  [ it : tangent ] ) .    following ( * ? ? ?",
    "* proposition 4.2 ) , the @xmath45 system defined for @xmath127 can be rewritten as the following @xmath128 system defined for @xmath129 : @xmath130 the relation between @xmath131 and @xmath132 , between @xmath133 and the flow in being : @xmath134    \\qquad    \\mathcal{f}(t , x)=    \\left [      \\begin{array}{c }        u_2\\\\        \\frac{u_2 ^ 2}{u_1}+\\frac 12 g u_1 ^ 2\\\\        u_4\\\\        \\frac{u_4 ^ 2}{u_3}+\\frac 12 g u_3 ^ 2      \\end{array }      \\right]\\ ] ] with @xmath129 ; whereas the boundary conditions becomes @xmath135 the thesis now follows from ( * ? ? ?",
    "* theorem 2.2 ) . indeed the assumptions @xmath136 , ( * b * ) and ( * f * ) are therein satisfied .",
    "more precisely the eigenvalues of the jacobian of the flow in are @xmath137 therefore in the subsonic region exactly two are positive and exactly two are negative .",
    "since here @xmath138 , @xmath139 , condition ( @xmath140 ) in ( * ? ?",
    "* theorem 2.2 ) is satisfied with @xmath141 . concerning condition ( * b * ) , the positive eigenvalues with the corresponding eigenvectors evaluated at @xmath142 are @xmath143 @xmath144 conditions imply @xmath145 , and @xmath146=    \\left [      \\begin{array}{cc }        1+\\frac{2}{3c}\\left(\\sqrt{gh}-v_0\\right)\\cdot        \\left(-\\frac{u_2}{c}\\right)^{-\\frac 13 }        & 0\\\\        -v_0+\\sqrt{gh_0 } & v_1+\\sqrt{gh_1 }      \\end{array }      \\right].\\ ] ] the determinant of the above matrix is given by @xmath147 which is strictly positive since @xmath107 and @xmath108 belong to the subsonic region",
    ". thus condition ( * b * ) is satisfied . concerning condition ( * f * ) , system is not necessarily strictly hyperbolic , for it is obtained glueing two copies of system .",
    "nevertheless , the two systems are coupled only through the boundary conditions , hence the whole wave front tracking procedure in the proof of ( * ? ? ?",
    "* theorem 2.2 ) applies . concerning the lipschitz dependence on the height @xmath112 , observe that as in ( *",
    "* theorem 2.2 ) we have for @xmath148 and hence @xmath149",
    "we present some numerical results on pooled steps using a finite  volume method in the conservative variables to solve for the system dynamics in each canal .",
    "the coupling conditions ( [ eq : coupl ] ) induce boundary conditions for each canal at each time  step . for given data @xmath150 close to the weir the conditions yield the boundary states at each connected canal . in the numerical computation of the boundary states we proceed as in section [",
    "sec : rp ] using newton s method applied to ( [ eq : coupl ] ) where @xmath151 and @xmath152 are given by the forward ( backwards ) 1-(2 ) lax  wave curves through the initial state @xmath153 .    according to the solution of the riemann problem described in section [ sec : rp ]",
    "there are three possible scenarios .",
    "if @xmath154 the coupling condition reduce to @xmath155 and no water passes the weir . if @xmath63 and @xmath60 the water is overflowing the weir from the left to the right . if @xmath156 and @xmath157 the water is overflowing the weir from the right to the left . if @xmath156 and @xmath158 the water is flowing from the left or from the right depending on the sign of @xmath159 .",
    "now , we present a numerical result for overflowing three connected pooled  steps .",
    "each canal has length @xmath160 and the height of each weir is 1.5 .",
    "we simulate two situations . in the first case",
    "the initial water level in each canal is low ( equal to @xmath161 in the second case the canals are already full ( height is equal to @xmath162 ) . in both case",
    "the water initial is still @xmath163 and a wave with a height @xmath164 and @xmath165 enters on the first canal .",
    "this wave lasts until @xmath166 and is then followed by a wave of height @xmath167 and zero flux .",
    "the simulation time is @xmath168 for both scenarios .",
    "we present snapshots of height and velocity at different times .",
    "the solid lines are the weir , the dotted line is ground level .",
    "it is a pooled step and therefore the first canal is on a higher level above ground than the last one .    in the first scenario ( see figure [ fig05 ] ) the wave enters the system of pooled steps and overflows the connected canals . after this wave passed the system slowly reaches again an almost steady state . in the second scenario ( see figure [ fig06 ] ) we observe initial dynamics due to the overflow of the pooled steps . on the second canal",
    "these dynamics interact with the incoming wave .",
    "after the wave passed the system slowly reaches a steady state with heights below critical ( i.e. , @xmath169 ) in the first and second canal .",
    "the water is still flowing over the third weir in this simulation .",
    "we thank holger schttrumpf , institut fr wasserwirtschaft , rwth aachen university , for pointing out this interesting problem to us .",
    "the work has been supported by the german research foundation he5286/6 - 1 and daad 50727872 and by the vigoni project 2009 .",
    "the first and third authors acknowledge the warm hospitality of rwth aachen university where part of this work was completed ."
  ],
  "abstract_text": [
    "<S> we consider an application of pooled stepped chutes where the transport in each pooled step is described by the shallow  water equations . </S>",
    "<S> such systems can be found for example at large dams in order to release overflowing water . </S>",
    "<S> we analyze the mathematical conditions coupling the flows between different chutes taken from the engineering literature . </S>",
    "<S> we present the solution to a riemann problem in the large and also a well  posedness result for the coupled problem . </S>",
    "<S> we finally report on some numerical experiments .    _ </S>",
    "<S> 2000  mathematics subject classification : _ 35l65 .    </S>",
    "<S> _ keywords : _ hyperbolic conservation laws on networks , management of water </S>"
  ]
}