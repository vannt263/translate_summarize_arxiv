{
  "article_text": [
    "bayesian nonparametric inference has undergone a tremendous development in the last two decades .",
    "this has been stimulated not only by significant theoretical advances , but also by the availability of new and efficient computational methods that have made inference , based on analytically intractable posterior distributions , feasible .",
    "a recent extensive survey of the state - of - the - art of the discipline can be found in hjort , holmes , mller and walker @xcite .    in this paper , we tackle the problem of estimating continuously varying distributions , given data points observed at different time intervals , possibly not equally spaced . more specifically , we consider the following setting , stated as an assumption for ease of later reference .",
    "[ assumption ] the data generating process is assumed to be a random function @xmath0\\rightarrow\\r_{+}$ ] , @xmath1 , where @xmath2 is a locally compact polish space , @xmath3 is continuous in the sense that @xmath4 as @xmath5 , and sections @xmath6 are densities absolutely continuous with respect to a common dominating measure .    here",
    "we assume that given @xmath6 , the data are such that at time @xmath7 @xmath8 independently of the past observations @xmath9 , for all @xmath10 and all @xmath11 .",
    "hence , observations @xmath12 are exchangeable for fixed @xmath13 and varying @xmath14 , but only partially exchangeable in general . our goal is to define an appropriate prior for @xmath3 and carry out inference on its entire shape .",
    "we will deal with both single and multiple data points available at every time @xmath7 , obtained by letting @xmath15 and @xmath16 in ( [ data ] ) , and refer to these two settings as _ single data _ and _ multiple data _",
    ", respectively .",
    "these are of separate interest as in some frameworks only single data points are available ( e.g. , financial indices ) ; it is then natural to wonder about the model performance in such settings , with structural lack of information , while evaluating the precision gain that can be obtained when more information is available .",
    "the commonly recognised cornerstone for density estimation in a bayesian nonparametric framework is the dirichlet process mixture model , introduced by lo @xcite and recalled in section  [ secdepprocesses ] below .",
    "here the idea is to extend some advantages of using a dirichlet process mixture to the case when @xmath3 is considered to be the realisation of a measure - valued process .",
    "hence , we aim at inducing a prior on the space of functions as in assumption  [ assumption ] by constructing a measure - valued process , with continuous sample paths and marginal states given by a dirichlet process mixture , which is suitable for nonparametric inference in continuous time .",
    "different types of temporal dependence induced on the observations are of interest . here",
    "we focus on markovianity for the mixing measure .",
    "although potential applications of assuming a markovian mixing measure concern a variety of fields such as econometrics , finance and medicine among others , this approach has been object of only a limited amount of research , so far , in the literature on bayesian nonparametric inference . on the other hand , in a context of temporal dependence , the markov property for the mixing measure considerably simplifies the finite dimensional distributions structure , and , most importantly , it need not impose a markovian dependence on the actual observations .",
    "thus , our setting can be regarded in two ways .",
    "one is that of a nonparametric regression , where the mixing measure is indexed by the covariate @xmath17 , and the observations are partially exchangeable .",
    "a second interpretation , given our above requests , is that of a hidden markov model , whereby the unobserved signal is an infinite - dimensional , or measure - valued , markov process .",
    "conditionally on the knowledge of the signal @xmath6 , the observations are independent of each other , and on the past observations , with emission distribution given by the signal state , as in ( [ data ] ) .",
    "the paper is organized as follows .",
    "section  [ secdepprocesses ] recalls the essential preliminary notions , like that of dirichlet process and dirichlet process mixture , and reviews to some extent the literature on the so - called dependent processes in bayesian nonparametrics .",
    "these are in fact measure - valued processes , indexed by time or more generally by covariates , specifically designed for inferential purposes in bayesian nonparametric frameworks with nonexchangeable data .",
    "section  [ secdpm ] moves from the stick - breaking representation of the dirichlet process to construct a class of diffusive dirichlet processes .",
    "the idea consists in replacing the beta - distributed components of the stick - breaking weights with one - dimensional wright  fisher diffusions .",
    "this yields a time - dependent process with purely - atomic continuous paths and marginal states given by dirichlet processes . in order to have a statistical model suitable for estimating functions as in assumption  [ assumption ] ,",
    "we then define a diffusive dirichlet mixture by considering an appropriate hierarchy whose top level is given by a diffusive dirichlet process .",
    "a challenging aspect of statistical models which involve diffusions regards the computational side , even when this is performed via simulation techniques with the aid of a computer . in a nutshell , this is due to the often encountered intractability of the transition density , in the fortunate cases when this is known explicitly .",
    "here we devise a strategy for posterior computation based on gibbs sampling and slice sampling , with the latter used both on the instant - wise infinite - dimensional mixing measure and on the transition density of the time - dependent components . after outlining the algorithm for posterior computation in section  [ postcomputation ] , in section  [ secillustration ]",
    "we illustrate the use of diffusive dirichlet mixtures on two sets of simulated data and on real financial data .",
    "section  [ secdiscussion ] collects some concluding remarks and briefly highlights possible extensions , concerned with the model parametrisation and with the aim of relaxing some model constraints .",
    "all proofs and the algorithm details are deferred to the .",
    "the dirichlet process , introduced by ferguson @xcite and widely accepted as the main breakthrough in the history of bayesian nonparametric statistics , is a discrete random probability measure defined as follows .",
    "let @xmath2 be a polish space endowed with the borel sigma algebra @xmath18 , @xmath19 be the space of borel probability measures on @xmath2 , and let @xmath20 be a nonatomic , finite and nonnull measure on @xmath2 .",
    "a @xmath19-valued random variable @xmath21 is said to be a dirichlet process with parameter @xmath20 , denoted @xmath22 , if for any measurable partition @xmath23 of @xmath2 , the vector @xmath24 has the dirichlet distribution with parameters @xmath25 .",
    "a  second construction of the dirichlet process , still due to ferguson @xcite , exploits the idea of normalising the jumps of a gamma subordinator by their sum , locating the jumps at independent and identically distributed points sampled from @xmath26 .",
    "this strategy has been followed for constructing several other nonparametric priors , among which the normalised inverse - gaussian process lijoi , mena and prnster @xcite and the normalised generalized gamma process lijoi , mena and prnster @xcite .",
    "a later construction of the dirichlet process , formalized by sethuraman  @xcite and particularly useful for our purposes , is usually referred to as the _ stick - breaking representation_. this states that the law of a dirichlet process coincides with the law of the discrete random probability measure @xmath27 obtained by letting @xmath28 and @xmath29 , where @xmath30 and the @xmath31 s and @xmath32 s are mutually independent .",
    "the stick - breaking construction has received a wide appreciation from the bayesian community . in particular , this is due to the fact that it greatly facilitates the implementation of posterior simulation , using markov chain monte carlo techniques that exploit the slice sampler ( damien , wakefield and walker @xcite , walker @xcite ) or the retrospective sampler ( papaspiliopoulos and roberts @xcite ) . such strategies for avoiding infinite computations , without deterministically truncating the random measure , can be used , for example , with dirichlet process mixtures ( lo @xcite ) .",
    "the latter are a very popular class of models which amplifies the use of dirichlet processes to a wider spectrum of statistical applications , most notably density estimation and data clustering , by modelling observations according to the random density @xmath33 where @xmath34 is a kernel density and @xmath35 is as in ( [ rpm - series ] ) .",
    "thanks to the large support properties of the dirichlet prior , the above model results in a very flexible class of distributions : for instance , any density on the real line can be recovered as an appropriate dirichlet mixture of normal densities . for this and other examples see lo @xcite , section  3 and ghosh and ramamoorthi @xcite , section  5 .",
    "many developments which derive from this modelling approach have been proposed .",
    "a first possibility is to replace the dirichlet process in ( [ mixturemodel ] ) by letting @xmath35 be some other discrete nonparametric prior .",
    "see lijoi and prnster @xcite and references therein . a different direction , which currently represents a major research frontier of the area , is to extend @xmath35 in ( [ mixturemodel ] ) in order to accommodate forms of dependence more general than exchangeability . besides pioneering contributions stimulated by cifarelli and regazzini @xcite ,",
    "this line of research was initiated by maceachern @xcite , who proposed a class of _ dependent processes _ , that is a collection of random probability measures @xmath36 where the weights @xmath37 and/or the atoms @xmath32 depend on some covariate @xmath38 .",
    "the current literature on the topic includes , among other contributions : de iorio , mller , rosner and maceachern  @xcite , who proposed a model with an anova - type dependence structure ; gelfand , kottas and maceachern @xcite , who apply the dependent dirichlet process to spatial modelling by using a gaussian process for the atoms ; griffin and steel @xcite , who let the dependence on the random masses be directed by a poisson process ; dunson and park @xcite , who construct an uncountable collection of dependent measures based on a stick - breaking procedure with kernel - based weights ; rodriguez and dunson @xcite , who replace the beta random variables in ( [ stick - breaking - weights ] ) with a transformation of gaussian processes via probit links .",
    "see also dunson , pillai and park @xcite , who define a dirichlet mixture of regression models ; dunson , xue and carin @xcite , who propose a matrix - valued stick - breaking prior ; duan , guindani and gelfand @xcite and petrone , guindani and gelfand @xcite for other developments of dependent priors for functional data ; fuentes - garca , mena and walker @xcite for a dependent prior for density regression ; trippa , mller and johnson  @xcite , who define a dependent process with beta marginals",
    ".    of particular interest for the purposes of this paper are the developments of dependent processes where the space @xmath39 indexes time . in this",
    "regard we mention , among others , dunson @xcite , who models the dependent process as an autoregression with dirichlet distributed innovations , whereas in griffin and steel @xcite the innovation is reduced to a single atom sampled from the centering measure ; caron _ et al . _",
    "@xcite , who model the noise in a dynamic linear model with a dirichlet process mixture ; caron , davy and doucet @xcite , who develop a time - varying dirichlet mixture with reweighing and movement of atoms ; rodriguez and ter horst @xcite , who induce the dependence in time only via the atoms , by making them into an heteroskedastic random walk .    here",
    "we aim at constructing a measure - valued diffusion whose realisations are functions as in assumption  [ assumption ] . in this respect ,",
    "the infinite - dimensional diffusions , found in the literature , which are related to bayesian nonparametric priors are not suitable for efficient inference .",
    "just to mention a few cases , this holds , for example , for the infinitely - many - alleles model ( ethier and kurtz @xcite ) , related to the dirichlet process ; for its two - parameter version ( petrov @xcite ) , related to the two - parameter poisson ",
    "dirichlet distribution ; and for normalised inverse - gaussian diffusions",
    "( ruggiero , walker and favaro @xcite ) , related to normalised inverse - gaussian random measures .",
    "the reasons are mainly due to the fact that an inferential strategy based on these dependent processes , given our current knowledge of their properties , would oblige to update single atoms of a plya urn scheme ( see , e.g. , ruggiero and walker @xcite ; favaro , ruggiero and walker @xcite ) , or otherwise face serious computational issues . to the best of our knowledge , the only model which satisfies the given requirements , among which the feller property , and allows efficient inference is given in mena , ruggiero and walker @xcite .",
    "however , this is based on decreasingly ordered weights , so , despite showing good performance , this feature can nonetheless be considered restrictive for certain applications .",
    "the model developed in the next section removes this constraint by letting only the weights means be ordered , as happens for the dirichlet process .",
    "in this section , we elaborate on a construction provided in feng and wang @xcite , in order to develop a class of measure - valued processes , suitable to be used in a statistical model , with the sought - after features outlined in the .",
    "consider the special case of ( [ depprocesses ] ) given by the collection of random probability measures @xmath40 where @xmath41 for all @xmath42 and @xmath43 is a nonatomic probability measure on @xmath2 . here",
    "the atoms are random but do not vary with time , and the dependence is induced only via the weights .",
    "this setting suffices for guaranteeing enough modelling flexibility ( see section  [ secdiscussion ] for more comments on this point ) , whereas the opposite scheme , obtained by inducing the dependence only via the atoms , may be unsatisfactory .",
    "see , for example , rodriguez and dunson @xcite for a discussion .",
    "recall now the stick - breaking structure of the dirichlet process weights ( [ stick - breaking - weights ] ) .",
    "a natural extension for having time dependence with continuity in @xmath17 is to let @xmath37 diffuse in time , in a way that retains the marginal distributions .",
    "a simple way to achieve such result is to let each component @xmath31 diffuse in @xmath44 $ ] , with fixed marginals , and perform the same construction as in ( [ stick - breaking - weights ] ) .",
    "this can be obtained by letting the @xmath31 s be one - dimensional wright  fisher diffusions , characterised as the unique solution in @xmath44 $ ] of the stochastic differential equation @xmath45\\,\\mathrm { d}t + \\sqrt{v(t ) \\bigl(1-v(t)\\bigr ) } \\,\\mathrm { d}b(t),\\ ] ] where @xmath46 and @xmath47 denotes a standard brownian motion .",
    "see , for example , karlin and taylor @xcite , section  15.2 . for our purposes",
    ", it will suffice to highlight the following properties of wright  fisher diffusions @xmath48 with parameters @xmath49 as in ( [ wf - sde ] ) , henceforth denoted @xmath50 :    * when @xmath48 approaches 0 ( resp .",
    ", 1 ) , the diffusion coefficient converges to 0 and the drift approaches @xmath51 ( resp . , @xmath52 ) , thus keeping the diffusion inside @xmath44 $ ] ; * when @xmath53 , the points 0 and 1 are both _ entrance boundaries _ , implying ( essentially ) that they are never touched for @xmath54 ; * when @xmath55 , @xmath48 has invariant distribution given by a @xmath56 ; * when @xmath55 , @xmath48 is strongly ergodic , that is , irrespective of the initial distribution , the law of @xmath48 will converge to the invariant measure as @xmath17 diverges .",
    "a typical behavior of @xmath48 , together with the occupancy frequencies plotted against the invariant distribution , is shown in figure  [ figwf ] , for values @xmath57 .",
    "note how these parameters make the trajectory occupy the half interval containing the mean value of @xmath58 for most of the time .     and @xmath59 .",
    "below : ergodic frequencies of the above sample - path against invariant distribution @xmath58 . ]",
    "the idea is then to let every @xmath31 in ( [ stick - breaking - weights ] ) vary , independently of the other components , according to a wright  fisher diffusion with parameters @xmath60 , that is @xmath61 , with @xmath62 , and to construct diffusive stick - breaking weights @xmath63 the process @xmath64 defined above for the vector of weights @xmath65 has been characterised by feng and wang @xcite , who investigate its sample path properties .",
    "it is clear that the constraints @xmath66 and @xmath67 are by no means essential but only chosen to preserve the connection with the dirichlet process ( see proposition  [ thmdep - rpm ] below ) .",
    "section  [ secdiscussion ] will briefly discuss possible extensions . with this formulation , ( [ dependentprocess ] )",
    "defines a family of dependent random probability measures which retain at every time point the stick - breaking structure featured by ( [ stick - breaking - weights ] ) .",
    "for ease of reference , we summarise the construction in the following definition .",
    "[ diffusivedp ] a family of dependent random probability measures @xmath68 with representation ( [ dependentprocess])([stick - breaking - wf ] ) is said to be a _ diffusive dirichlet process_.    besides studying @xmath69 , feng and wang @xcite also consider a construction more general than  ( [ dependentprocess ] ) , where the atoms @xmath70 are let to be a markov process on @xmath71 . however , their model is too general for our purposes and its properties are hard to establish without further assumptions on the model components .",
    "hence , we need to formalise the path properties of @xmath72 , as these can not be deduced directly from either of the models considered in their paper .    to this end , denote by @xmath73 the space of continuous functions from @xmath74 to @xmath19 . here",
    "@xmath72 denotes the @xmath75-valued random element @xmath76 , and @xmath77 its coordinate projection at @xmath17 , so that @xmath78 .",
    "we endow @xmath79 with the topology induced by the total variation norm , so that elements of @xmath73 have modulus of continuity @xmath80 and @xmath81 if and only if @xmath82 as @xmath83 , that is if @xmath84 in total variation distance as @xmath85 .",
    "see billingsley @xcite , chapter  2 .",
    "the fact that the diffusive dirichlet process @xmath72 in definition  [ diffusivedp ] has continuous sample paths in total variation , should be intuitive from the construction , since the only time - varying quantities are diffusion processes mapped through a continuous function .",
    "the following proposition formalises this fact .",
    "[ propositiondiffusion ] let @xmath72 be as in definition  [ diffusivedp ] .",
    "then @xmath72 is a feller process with realisations almost surely in @xmath73 .    the feller property for @xmath72 guarantees certain desirable path properties which , among other things , yield the well - definedness of the process and its markovianity .",
    "we refer the reader to ethier and kurtz @xcite , chapter  4 , for more details on feller operators .",
    "however , the continuity of sample paths is not implied by the feller property and is proven separately .",
    "in particular , it is such continuity that will allow , after embedding @xmath72 in an appropriate statistical model , to select almost surely continuous functions as in assumption  [ assumption ] .",
    "since the stationary distribution of the wright  fisher diffusion , used in ( [ stick - breaking - wf ] ) , is the same distribution used in ( [ stick - breaking - weights ] ) for the stick - breaking components , it is also intuitive that the process of definition  [ diffusivedp ] is stationary with respect to the law of a dirichlet process , as stated by the next proposition .",
    "[ thmdep - rpm ] let @xmath72 be as in definition  [ diffusivedp ] and , for a finite nonnull measure @xmath20 on @xmath2 , let @xmath86 denote the law of a dirichlet process",
    ". then @xmath72 is reversible and stationary with respect to @xmath86 . in particular ,",
    "if @xmath87 , then @xmath88 for every @xmath54 .    hence , the marginal states of the diffusive dirichlet process are dirichlet distributed .",
    "here it is important to note that modelling the above measure - valued process as stationary will not constrain the data to come from a stationary process .",
    "this will be more transparent when we will consider the hierarchical statistical model for the data .",
    "on the contrary , this aspect will turn into an advantage since it will allow to propagate in time the support properties of the dirichlet prior .",
    "indeed it is well known that the dirichlet prior has full weak support .",
    "that is , if @xmath2 is the support of the parameter measure @xmath20 , then the support of @xmath86 in the weak topology is @xmath89 see ghosh and ramamoorthi @xcite , section  3.2.3 .",
    "proposition  [ thmdep - rpm ] then implies that at stationarity @xmath77 , marginally , has support ( [ dp - support ] ) .",
    "see also barrientos , jara and quintana @xcite for sufficient conditions for having full weak support in the context of dependent stick - breaking processes .",
    "another byproduct of proposition  [ thmdep - rpm ] is the immediate derivation of the marginal moments of  @xmath72 . in particular , let @xmath87 , with @xmath90 , where @xmath91 and @xmath92 .",
    "then , for all @xmath42 and @xmath93 , @xmath94=g(a),\\qquad \\operatorname{var } \\bigl[p_{t}(a)\\bigr]=\\frac{g(a)(1-g(a))}{\\theta+1},\\ ] ] where @xmath95 denotes ( [ dependentprocess ] ) evaluated at the set @xmath96 .",
    "in addition , the following proposition provides an explicit expression for the autocorrelation function of the process .",
    "[ propacf ] let @xmath72 be as in definition  [ diffusivedp ] . then , for any @xmath97 and any @xmath98 , @xmath99 } { ( 2+\\theta)(1 + 2\\theta)-\\theta \\e^{-\\lambda s}},\\ ] ] where @xmath100 .",
    "as expected , the correlation does not depend on the set @xmath96 , since the time dependence enters only via the weights and not the locations .",
    "furthermore , it is easily seen that the correlation decays exponentially to @xmath101 as @xmath102 .",
    "although this can perhaps be considered as an undesirable property , the existence of a lower bound for the correlation is a common feature of all dependent processes whose atoms are fixed ( see rodriguez and dunson @xcite ) . in section  [ secdiscussion",
    "] , we will provide more comments on this point and outline a possible extension which aims at relaxing some of the model constraints .",
    "the above dependent process can be used to formulate a dependent mixture model by considering the time - varying density @xmath103 where @xmath104 is a kernel density with parameter @xmath105 .",
    "an equivalent formulation is provided in the form of the hierarchical model @xmath106 where @xmath107 denotes that @xmath72 is a diffusive dirichlet process . since @xmath72 is the only time - varying component in the statistical model , the dependent mixture inherits the diffusive behavior from @xmath72 , and proposition  [ thmdep - rpm ] implies that marginally @xmath108 is a dirichlet process mixture .",
    "thus , the dependent mixture induces a prior distribution on the space @xmath73 of continuous functions from @xmath74 to @xmath19 , which almost surely selects functions @xmath109\\rightarrow\\r_{+}$ ] that satisfy assumption  [ assumption ] .",
    "the choice of kernel @xmath110 determines the discrete or continuous nature of the sections @xmath111 and their support .",
    "we overview the strategy for simulating from the posterior distribution of ( [ depmixturemodel ] ) and of other quantities of interest , such as , for example , the mean functional process @xmath112 , which depicts the average stochastic process driving the observations . here",
    "we highlight the main points of interest , while the fully detailed procedure can be found in appendix  [ appa ] . for notational simplicity , and in view of the real data example below , we assume a single data setting .",
    "however , the strategy allows a straightforward extension to the case of multiple observations at every time point .",
    "specifically , we assume data @xmath113 are observed at times @xmath114 , where time intervals are not necessarily equally spaced .",
    "the target of inference is the data generating time - varying distribution @xmath115 , such that @xmath116 .",
    "we model such @xmath3 by means of a diffusive dirichlet mixture , with @xmath117 . to this end , let @xmath118 denote a collection of independent wright  fisher diffusions defined as in ( [ wf - sde ] ) , with @xmath119 .",
    "let also @xmath120 be the random locations sampled from a nonatomic probability measure @xmath43 .",
    "hence , the data generating process is modelled as @xmath121 with @xmath122 as in ( [ stick - breaking - wf ] ) .",
    "the model induces dependence among the observations , which are exchangeable for fixed @xmath17 but partially exchangeable in general .",
    "the infinite dimensionality of the random measure at @xmath17 is dealt with via slice sampling ( damien , wakefield and walker @xcite , walker @xcite ) .",
    "specifically , we extend the slice algorithm in kalli , griffin and walker @xcite to augment the above random density by @xmath123 where @xmath124 is a decreasing function with known inverse @xmath125 , for example , @xmath126 , for @xmath127 . the latent variable @xmath128 indexes which of the kernels @xmath129 better captures the mass at @xmath130 , and given @xmath128 , @xmath131 . for the purpose of estimation ,",
    "it is enough to condition on @xmath132 , rather than on the whole path @xmath133 . in this section and in the",
    ", we will use the notation @xmath134 to indicate generically the law of @xmath135 .",
    "the conditional augmented likelihood is given by @xmath136 k(y_{t_i}\\mid{x}_{s_i}),\\ ] ] where @xmath137 and @xmath138 , with @xmath139 and @xmath140 .",
    "due to the random truncation induced by the slice sampling method , one is only able to learn about the first @xmath141 wright  fisher processes and locations , where @xmath142 and @xmath143 denotes the integer part of @xmath96 .",
    "hence , denoting @xmath144 we see that @xmath145 while the posterior distribution remains the unchanged prior for all @xmath146 , @xmath147 . here",
    "the @xmath148 processes and locations are mutually independent , so that @xmath149 it remains to observe that the finite dimensional distributions for each wright  fisher process are @xmath150 where @xmath151 and @xmath152 denotes the transition density of the wright  fisher diffusion .",
    "this is known explicitly ( ethier and griffiths @xcite ) , but has an infinite series representation .",
    "in view of a further implementation of the slice sampler , we resort to the representation of @xmath152 due to mena and walker @xcite , which reads @xmath153 where @xmath154 is an appropriate deterministic function and @xmath155 a finite mixture of beta distributions .",
    "this leads to an augmentation of @xmath152 similar to that outlined above for @xmath108 , allowing to avoid the infinite computation .    *",
    "input : * data @xmath156 and their recording times @xmath157 * initial values for : * + hyper - parameters in @xmath43 and wf parameters + upper limit @xmath158 for the number of locations and wf processes + membership variables @xmath159 , taking values in @xmath160 + wf processes at @xmath157 and corresponding latent variables + location values sample slice variables @xmath161 and update the value of @xmath162 take extra wf processes and their latent variables from priors update transition density latent variables update wf processes values update location values update wf parameter valuesupdate membership variables @xmath163 taking values in @xmath164    [ algdiffdp ]    with the above specification , a gibbs sampler algorithm can be designed as in algorithm [ algdiffdp ] . the reader is referred to appendix  [ appa ] for the algorithm details not included in this section .",
    "following the above framework , in this section we illustrate an application of the diffusive dirichlet process with simulated and real data . more specifically , we consider :    simulated observations sampled at equally spaced intervals from the time - dependent normal density @xmath165    300 real observations given by daily exchange rates between us dollars and mexican peso during the period from september 26th , 2008 , to december 7th , 2009 .",
    "the assumption of data collected at regular intervals here is for computational simplicity only , as the model , through ( [ wftransition ] ) , allows for not equally spaced samples .    in order to complete the specification of the diffusive mixture",
    ", we use a conjugate vanilla choice for the kernel @xmath110 and centering measure @xmath43 .",
    "specifically , let @xmath166 with @xmath167 .",
    "the parametrization for @xmath43 is chosen to achieve a large variance at the location level , to cover all observations with high probability .",
    "this is required , as the locations are random but fixed over time , and the weight processes should be able to pick any good candidate location within the data state space at a given time . running algorithm [ algdiffdp ] allows to draw posterior inferences for any functional of the diffusive dirichlet mixture model . in particular , besides the time - varying density , we are interested in the mean functional @xmath168 all examples in this section are based on 2000 effective iterations drawn from 10,000 iterations thinned each five and after a burn in period of 5000 iterations .",
    "we verified practical convergence using the convergence diagnostics of gelman and rubin @xcite and of raftery and lewis @xcite , and neither showed any evidence of convergence problems.=1    ) .",
    "the picture shows the true model ( heat contour ) , the pointwise posterior mode ( solid line ) and 95% credible intervals for the mean functional ( dotted lines ) , and the pointwise 95% quantiles of the posterior estimate of the time - varying density ( dotted lines ) . ]",
    "[ figtoy ]    figure  [ figtoy ] shows the results corresponding to a first dataset simulated from ( [ toy ] ) , where 100 single observations are collected at equally spaced intervals . the true data generating process is shown as a heat contour , with darker regions being those of higher probability , and presents traits of nonstationarity and seasonality .",
    "the dots are the simulated data , the solid and dashed lines are the pointwise posterior mode and 95% credible intervals for the mean functional , respectively , and the dotted lines are the pointwise 95% quantiles of the posterior estimate of the time - varying density .",
    "the picture shows that the model correctly captures the nonstationary behaviour with a strong trend and seasonalities . furthermore , even in this setting with structural lack of instant - wise information , due to the availability of only single data points , the uncertainty of the estimates is reasonably low , as the model instantaneous variance is indirectly learned by the algorithm from the overall data pool .",
    "the smoothness level captured by the estimation is also acceptable , given the above considerations on the lack of information and considered that the model is ultimately based on wright  fisher components .    ) .",
    "the picture shows the true model ( heat contour ) , the pointwise posterior mode ( solid line ) and 95% credible intervals for the mean functional ( dotted lines ) , and the pointwise 95% quantiles of the posterior estimate of the time - varying density ( dotted lines ) . ]    in order to investigate the degree of improvement , one can gain with multiple data points , we performed the same type of inference as in figure  [ figtoy ] on a second set of data simulated from ( [ toy ] ) , where at each of the 100 time points , five data are available .",
    "the results , reported in figure  [ figtoymulti ] , show that the accuracy of the estimation increases satisfactorily , as the true model behaviour is captured with considerably less uncertainty .",
    "this is especially true for the mean functional ( solid line ) , whose credible intervals ( dashed lines ) are very narrow .",
    "it is also important to note that the smoothness of the true model is also correctly learned by the estimates .",
    "this is due to the fact that the rough behaviours of the model subcomponents are confined to levels of the hierarchy where their impact on the final estimation , in presence of enough information , is pooled together and softened by adapting the component - specific volatilities .",
    "this however does not prevent the model from capturing quick deviations from a smooth trend , as showed by the next example.=1    for the illustration with real observations , we concentrate on a challenging set of single data points per observation time , which again provides scarce instantaneous information .",
    "financial data sets as in ( ii ) are often described with parametric state - space models .",
    "this can put serious constraints on the ability of the model to capture the correct marginal distributions and quick deviations from the general pattern . by making the nonparametric assumption that the state - space model follows a diffusive dirichlet process mixture",
    ", we are relaxing such constraints and granting great flexibility to the model . in the interpretation related to hidden markov models ,",
    "the unobserved signal here models an evolving distribution , driven by a measure - valued markov process , and the observations are sampled from the signal states .",
    "note however that this framework does not impose any markovianity nor stationarity on the observations .",
    "figure  [ pltfin ] shows the results on the exchange rate data set , with the horizontal axis representing time and the vertical axis representing the index value .",
    "the heat contour outlines the shape of the pointwise posterior estimate for the time - varying density function @xmath108 , with darker regions corresponding to higher posterior probability .",
    "the solid line is the pointwise mode of the posterior mean functional ( [ meanfunc ] ) .",
    "the model is able to capture highly volatile behaviours , such as that encountered in the period between 70 and 130 .",
    "these kind of changes are typically not well recognised by parametric models for time series , which are too rigid to allow for unexpected detours .",
    "figure  [ pltfin2 ] shows a sub - region of figure  [ pltfin ] , where sudden spikes and different local trends are also shown to be correctly captured , regardless of how abrupt these appear .",
    "another important aspect to be noted is the fact the regions of high estimated probability need not correspond to the regions where data are observed , even having single data points , as in the central sub period around day @xmath169 in figure  [ pltfin2 ] .",
    "this feature is determined by the model dependence , which allows to borrow information across time , and should not be confused with model rigidity , as the model clearly captures sudden deviations from the trend as that occurring around time 200 .        .",
    "we introduced a new class of prior distributions on the space of time - indexed , @xmath17-continuous functions @xmath170\\rightarrow\\r _ { + } $ ] , such that @xmath6 is a density for all @xmath171 $ ] .",
    "such priors are induced by diffusive dirichlet process mixtures , which extend the dirichlet process mixture model of lo  @xcite to a framework of feller measure - valued processes with continuous trajectories . the resulting dependent random density ( [ depmixturemodel ] )",
    "can be used to tackle various statistical problems of interest in many fields such as econometrics , finance and medicine among others , when the random phenomena evolving in continuous time are not satisfactorily modelled parametrically . on the other hand",
    ", it can be an alternative to other nonparametric dependent models which are statistically intractable .",
    "for example , when the underlying model structure is linked to population dynamics , it could be desirable to model data by means of fleming  viot processes ( see ethier and kurtz @xcite ) .",
    "however , such a process is computationally intractable in view of inference , and the presented model can then be used to this end , as the main properties of the former such as the stationary measure and path regularity are preserved .",
    "overall , the introduced model exhibits a good mix of flexibility and structure , yet leaving room for computational efficiency .",
    "the full support property of the dirichlet process and the time dependence of wright  fisher diffusions are combined to yield an equilibrated compromise between adaptivity and dependence , and the gibbs sampler with slice steps is simple to implement .",
    "these aspects lead to the ability of jointly detecting smooth and irregular evolutions of the distribution which generates the observations , while borrowing strength between observations when this is needed .",
    "we briefly outline two possible extensions of the model , concerned with certain features that can nonetheless be considered as constraints in certain contexts .",
    "the first is a reparametrisation which retains the overall structure , and aims at broadening the set of stationary distributions of the model .",
    "the second changes the qualitative features of the model and aims at removing some rigidities .",
    "these are concerned with the fact that the correlation is bounded from below , together with the fact that the dependence structure imposes some restrictions on the data generating mechanism .",
    "the construction can be easily extended by relaxing the assumption of identity in distribution of the wf diffusions used in ( [ stick - breaking - wf ] ) .",
    "this can be done , for example , by considering the class of gem diffusions , also developed in feng and wang @xcite , to allow for more general stationary distributions of the weights , such as two - parameter poisson ",
    "dirichlet distributions ( pitman @xcite , pitman and yor @xcite ) or gem distributions ( johnson , kotz and balakrishnan @xcite , chapter  41 ) .",
    "a general construction of the latter class of random measures is obtained by taking @xmath172 in ( [ stick - breaking - weights ] ) , while the former corresponds to choosing @xmath173 and @xmath174 for all @xmath175 . by analogy with the construction in section  [ secdpm ] ,",
    "gem - type measure - valued diffusions can be defined by letting @xmath176 in ( [ stick - breaking - wf ] ) , that is the collection of wright  fisher diffusions which induce the time - dependence in the weights of ( [ dependentprocess ] ) is given by independent , and no longer identically distributed , processes .",
    "an appropriate extension of proposition  [ thmdep - rpm ] easily follows .",
    "one can then replace @xmath72 in ( [ hierarchydiff - dp ] ) with the resulting measure - valued gem process to yield additional modelling flexibility .",
    "the resulting class of dependent mixture models extends , to a time - dependent framework , the priors considered in ishwaran and james @xcite .",
    "of course there is a trade - off between the amount of flexibility one pursues and the amount of parameters one is willing to deal with in terms of computational effort .",
    "the choice of two - parameter poisson ",
    "dirichlet distributions probably guarantees extra flexibility at almost no extra cost , as it allows to control more effectively the posterior distribution of the number of clusters ( lijoi , mena and pr \" unster @xcite ) , and only requires one additional step at every gibbs sampler iteration for updating the posterior distribution of @xmath177 .",
    "a different direction can be considered with the aim of relaxing the dependence structure the model imposes on the data .",
    "this is the object of a currently ongoing work by the authors , of which we concisely outline the main ideas .",
    "we consider a specific choice for the general dependent process @xmath178 parametrised by @xmath179 , which keeps the model complexity and the implied computational burden relatively low , but yields an autocorrelation which vanishes exponentially fast and whose structure can be inferred from the data .",
    "this is obtained , for example , by letting the weights @xmath69 be as in ( [ stick - breaking - wf ] ) , and by letting the initial atoms @xmath180 be updated one at a time after an interval with @xmath181 distribution from the last update . the atom to be replaced is chosen , for example , according to a fixed distribution , and the update is chosen from @xmath43 .",
    "the notation @xmath182 for the resulting model highlights the role of the intensity @xmath183 of the underlying poisson point process which regulates how often these innovations occur",
    ". such specification extends the model of section  [ secdpm ] to a model which is still stationary with respect to the law of a dirichlet process , and has a correlation which decreases to zero exponentially with speed regulated by @xmath183 .",
    "informally , @xmath182 interpolates between the diffusive dirichlet process , obtained as an appropriate limit of @xmath182 as @xmath184 , and a purely discontinuous model @xmath185 , whereby in every finite interval infinitely many atoms are updated , so that for every @xmath186 , @xmath187 and @xmath188 are uncorrelated .",
    "this adds great flexibility to the dependence structure , which can be learned from the data by implementing @xmath182 in a hierarchical model , similar to ( [ hierarchydiff - dp ] ) , augmented with a prior distribution on @xmath183 .",
    "however , besides the clear advantages related to the correlation which is no longer constrained , the model sample paths are no longer continuous but only continuous in probability , and the markov property is retained only with respect to the filtration generated by @xmath189 and not with respect to the natural filtration",
    ". a further alternative , which retains the path continuity , is the possibility of allowing also the atoms to diffuse .",
    "however , this way seems difficult if one is interested in proving minimal theoretical properties for the model .",
    "define @xmath190^{\\infty}\\dvt \\sum _ { i\\ge 1}z_{i}=1 \\biggr\\},\\ ] ] and let , for any fixed sequence @xmath191 , @xmath192 be the set of purely atomic probability measures with support @xmath193 .",
    "denote by @xmath194 the transformation @xmath195 , where @xmath196 and @xmath197^{\\mathbb { n}}\\rightarrow \\delta_{\\infty}$ ] is defined as @xmath198 note that the map @xmath199 is a bijection , with @xmath200 , and that @xmath201 is continuous as a function of @xmath202 in total variation norm , since for every @xmath203 and @xmath204 we can find a neighbourhood @xmath205 so that @xmath206 implies @xmath207 , with @xmath208 since @xmath209 furthermore , @xmath203 is invertible in @xmath210 , with continuous inverse @xmath211 this implies that we can define a feller semigroup @xmath212 on @xmath213 by means of @xmath214\\circ\\varphi_{x}^{-1}$ ] , where @xmath215 is the feller semigroup on @xmath216 corresponding to the process @xmath69 and @xmath217 is as in ( [ psi - inverse ] ) .",
    "theorem  4.2.7 of ethier and kurtz @xcite now implies that for every probability measure @xmath218 on @xmath219 , there exists a markov process @xmath72 corresponding to @xmath220 with initial distribution @xmath218 and sample paths in @xmath221 , the space of right - continuous functions from @xmath74 to @xmath192 with left limits , equipped with the skorohod topology .",
    "see billingsley  @xcite , chapter  3 , for details .",
    "moreover , being a continuous bijection with continuous inverse , for any fixed @xmath105 , @xmath201 is a homeomorphism of @xmath222 into @xmath192 , from which @xmath192 is locally compact and separable .",
    "denote now with @xmath223 and @xmath224 the transition functions corresponding to the semigroups @xmath225 and @xmath215 , respectively , and define @xmath226 as in ( [ neigh ] ) and @xmath227 as in ( [ tvneighbourhood ] ) .",
    "then for every @xmath228 and @xmath204 , we have @xmath229 where the identity follows form the fact that the two events are determined by the same subset of elementary events , and the right - hand side of ( [ no - jumps - condition ] ) follows from the continuity of the trajectories of @xmath69 .",
    "the result now follows from ethier and kurtz @xcite , lemma  4.2.9 .",
    "since @xmath69 is reversible feng and wang @xcite , with each component @xmath230 reversible with respect to a @xmath231 distribution , and the atoms @xmath232 are trivially reversible and independent of @xmath69 , it follows that @xmath72 is reversible .",
    "the full statement now follows by the fact that @xmath233 , and by assuming the initial distribution @xmath234 for all @xmath175 .",
    "we have @xmath235 where @xmath236 here @xmath237 is independent of @xmath17 by stationarity and @xmath238 is obtained by subtraction , since @xmath239 from which @xmath240 and , using ( [ dp - moment ] ) , @xmath241 now , from ( [ stick - breaking - wf ] ) and using independence among the @xmath230 s , we have @xmath242 \\\\ & = & \\e\\bigl[v_{i}(t)v_{i}(t+s)\\bigr]\\prod _ { j < i}\\e",
    "\\bigl(\\bigl(1-v_{j}(t)\\bigr ) \\bigl(1-v_{j}(t+s)\\bigr ) \\bigr ) \\\\ & = & \\e\\bigl[v_{i}(t)v_{i}(t+s)\\bigr]\\prod _ { j <",
    "i } \\biggl(1-\\frac{2}{1+\\theta}+\\e \\bigl[v_{j}(t)v_{j}(t+s ) \\bigr ] \\biggr).\\end{aligned}\\ ] ] since @xmath243=\\e^{-\\lambda s}$ ] with @xmath244 ( cf .",
    "bibby , skovgaard and srensen @xcite ) , it follows that @xmath245=(1+\\theta)^{-2}[1+(2+\\theta)^{-1}\\theta \\e^{-(1+\\theta)s/2}]$ ] , so @xmath246 from which the statement follows by direct computation .",
    "note that by exchanging the limit operation with the sum and the integral ( of positive terms ) in @xmath247 , we obtain @xmath248 , hence @xmath249 .",
    "we illustrate the complementary details of the summary of the simulation - based procedure , provided in section  [ postcomputation ] , for estimating the time - varying density which generates the data",
    ". we will refer to quantities there introduced whenever this does not compromise the readability . here",
    "we provide the general algorithm based on a gem diffusive mixture as discussed in section  [ secdiscussion ] .",
    "for ease of the reader , the simplifications implied by choosing a dirichlet diffusive mixture are made explicit in the last part of the present section .",
    "to recall briefly the relevant notation , let @xmath250 be the data points observed at times @xmath157 , @xmath118 with @xmath251 as in ( [ wf - sde ] ) , @xmath252 with @xmath253 , for @xmath92 nonatomic .",
    "so , for example , @xmath254 in ( [ lawv ] ) becomes a @xmath255 .",
    "note that the @xmath256 parameters must be chosen such that @xmath257 , with @xmath258 as in ( [ stick - breaking - wf ] ) ( the wright  fisher dynamics would then imply the same holds for all @xmath259 ) .",
    "see , for example , ishwaran and james @xcite for sufficient conditions . given the discussion in section  [ postcomputation ] , it remains to make explicit how to update the random measures locations and weights , the slice and membership variables , and how to use the slice sampling on the wright  fisher transition density .",
    "we treat these issues separately .    _ updating the locations_.",
    "since the locations are not time dependent , these are updated as in kalli , griffin and walker @xcite .",
    "that is @xmath260 for @xmath261 , so that only a finite number of locations need to be sampled .",
    "_ updating the weights_. we need the full conditional distributions for each of the @xmath262 wright  fisher values @xmath263 , where @xmath264 , @xmath141 is as in ( [ m = max ] ) and @xmath265 .",
    "hence , for each @xmath264 we have @xmath266 \\\\[-8pt ] \\nonumber & & { } \\times \\bigl(1- { { v}}_j(t_i)\\bigr)^{{\\mathbb{i}}(s_i > j ) } , \\qquad i\\neq1,n , \\\\",
    "\\mathcal{l}\\bigl({{v}}_j(t_n)\\mid\\cdots\\bigr)&\\propto & { { p}}_{{{v}}}\\bigl({{v}}_j(t_{n})\\mid { { v}}_j(t_{n-1 } ) \\bigr ) { { v}}_j(t_n)^{{\\mathbb{i}}(s_n = j ) } \\bigl(1-{{v}}_j(t_n)\\bigr)^{{\\mathbb{i}}(s_n > j)}.\\nonumber \\ ] ] note that dropping the dependence on time in the weights processes @xmath267 would yield @xmath268 \\\\ &",
    "\\propto & \\pi_{{{v } } } ( { { v}}_j ) { { v}}_{j}^{\\sum_{i=1}^n{\\mathbb{i}}(s_i = j ) } ( 1-{{v}}_{j})^{\\sum_{i=1}^n{\\mathbb{i}}(s_i > j)}. \\ ] ] letting @xmath269 , the previous simplifies to @xmath270 which is the usual posterior update in the framework of stick - breaking random probability measures based on beta distributed stick - breaking component .",
    "see kalli , griffin and walker @xcite .",
    "_ updating the slice and membership variables .",
    "_ for each @xmath265 we have @xmath271 and @xmath272 note that since @xmath273 is a finite set , the above distribution involves a finite sampling , namely from @xmath274 , where @xmath125 denotes the inverse of @xmath275 .    _",
    "slicing the wright  fisher transition density_. the analytic form for the transition density of the wright  fisher diffusion model does not take a simple closed form .",
    "one could attempt to use the corresponding spectral representation , which involves an infinite series of orthogonal jacobi polynomials .",
    "however , such infinite number of arguments with alternating sign prevents a robust evaluation of the transition density , especially for the extreme points of the state space . instead , here we opt to use a slightly more general representation given in mena and walker @xcite .",
    "that is , an equivalent formulation of the transition density of the wright  fisher diffusion is @xmath276 where @xmath277 and @xmath278 here @xmath279 is the beta density with parameters @xmath280 and @xmath281 is the binomial probability function with @xmath141 trials and success probability @xmath282 .",
    "a reparametrization of ( [ wf - sde ] ) given by letting @xmath283 leads to writing @xmath284 the above representation is valid for @xmath285 , in which case @xmath286 and @xmath287 are entrance boundaries .",
    "such condition rules out the inconvenient case of weights @xmath267 in ( [ stick - breaking - wf ] ) become @xmath286 or @xmath287 . a byproduct of the above re - parametrization",
    "is that it makes explicit the rate of decay in the autocorrelation function of the wright  fisher diffusion , which for the dirichlet process case ( [ stick - breaking - wf ] ) reduces to @xmath288=\\e^{-(1+\\theta)s/2}$ ] .",
    "see , for example , bibby , skovgaard and srensen  @xcite .",
    "the representation ( [ transwf ] ) is appealing not only due to the fact that it involves elementary functions , but also and foremost since , unlike in the spectral decomposition , the summands are all positive .",
    "it follows that truncations , or rather random truncations such as those invoked by the slice method , are feasible .",
    "indeed , with techniques similar to those used for ( [ dnpmaug2 ] ) we can augment the transition density in order to avoid the infinite computation .",
    "introduce then @xmath289 such that @xmath290 where as before @xmath291 is a decreasing function with known inverse @xmath292 and @xmath293 denotes ( [ funcr ] ) computed on parameters @xmath294 . augmenting for @xmath295 observations by means on @xmath296 leads to the likelihood for @xmath148 processes @xmath297 where @xmath298 , and the subscript `` @xmath299 '' is interpreted as in ( [ 1mnotation ] ) .",
    "therefore , given a prior @xmath300 , the posterior distribution for @xmath294 is @xmath301 furthermore , the full conditionals for the latent variables @xmath302 for each @xmath261 are given by @xmath303 , @xmath304 and @xmath305^{d_j^i}}{\\e^{d_j^ic_j\\tau _ i}\\gamma(b_j+d_j^i - k_j^i)\\gamma(d_j^i - k_j^i+1)g(d_j^i ) } { \\mathbb{i}}\\bigl(k_j^i\\leq d_j^i\\leq g^*\\bigl(o_j^i\\bigr ) \\bigr).\\ ] ]    the supports of @xmath306 and @xmath307 are discrete and bounded , so sampling from such distributions is straightforward , for example , via the inverse cumulative distribution function method .",
    "_ gibbs sampler for diffusive dp mixtures_. when instead of a diffusive gem mixture one chooses the special case of a diffusive dirichlet process mixture , this corresponds to letting @xmath308 , @xmath309 and @xmath310 for all @xmath311 in the above derivation , or equivalently to take independent and identically distributed wright ",
    "fisher processes as in ( [ stick - breaking - wf ] ) . with these specifications the full conditionals",
    "( [ updatev ] ) for the weights processes simplify to @xmath312 assuming independent priors for @xmath313 and @xmath314 , and taking the logarithm , the full conditionals ( [ postparam ] ) become @xmath315 and @xmath316 these can be sampled using the adaptive rejection metropolis sampling ( arms ) algorithm .",
    "the authors are grateful to an associate editor and two anonymous referees for carefully reading the manuscript and for providing constructive comments which led to an improvement of the presentation .",
    "the first author was partially supported by _",
    "nacional de ciencia y tecnologa de mxico _ project 131179 , during the elaboration of this work .",
    "the second author is supported by the european research council ( erc ) through stg `` n - bnp '' 306406 .                            and",
    "regazzini , e. ( 1978 ) .",
    "nonparametric statistical problems under partial exchangeability : the use of associative means .",
    "( original title :  problemi statistici non parametrici in condizioni di scambiabilit parziale : impiego di medie associative \" )",
    ". _ quaderni dellistituto di matematica finanziaria , univ .  of torino",
    "_ , * 3*(12 ) ."
  ],
  "abstract_text": [
    "<S> we introduce a new class of nonparametric prior distributions on the space of continuously varying densities , induced by dirichlet process mixtures which diffuse in time . these select time - indexed random functions without jumps , whose sections are continuous or discrete distributions depending on the choice of kernel . </S>",
    "<S> the construction exploits the widely used stick - breaking representation of the dirichlet process and induces the time dependence by replacing the stick - breaking components with one - dimensional wright  fisher diffusions . </S>",
    "<S> these features combine appealing properties of the model , inherited from the wright  fisher diffusions and the dirichlet mixture structure , with great flexibility and tractability for posterior computation . </S>",
    "<S> the construction can be easily extended to multi - parameter gem marginal states , which include , for example , the pitman  yor process . </S>",
    "<S> a full inferential strategy is detailed and illustrated on simulated and real data .    </S>",
    "<S> ./style / arxiv - general.cfg </S>"
  ]
}