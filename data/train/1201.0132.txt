{
  "article_text": [
    "a countable group @xmath0 is _ amenable _ if it admits a finitely additive , translation invariant measure defined on every subset of @xmath0 such that the measure of @xmath0 is 1 .",
    "such groups are important in measure theory , dynamical systems , and ergodic theory .",
    "nonamenable groups lead to the hausdorff - banach - tarski paradox which asserts that _ one _ copy of the unit ball in @xmath3 can be rigidly torn into finitely many pieces that can be rigidly reassembled to form _ two _ copies of the unit ball .    in @xcite and @xcite ,",
    "erling  gave two geometric characterizations of countable amenable groups @xmath0 .",
    "these characterizations make these groups very attractive to geometric group theorists .",
    "since we emphasize finite subsets @xmath4 of @xmath0 , we shall state the  theorems in a slightly nonstandard way . in particular , flner s statement of theorem 1.2 is in terms of global cooling functions and not local cooling functions .",
    "first we give some introductory definitions .",
    "let @xmath5 denote the cayley graph of an infinite group @xmath0 with finite generating set @xmath6 , let @xmath1 be nonempty and finite , let @xmath7 denote the set of edges of @xmath8 with at least one vertex in @xmath4 , and let @xmath9 denote the set of boundary edges of @xmath4 consisting of those edges that have exactly one vertex in @xmath4 .",
    "orient each edge @xmath10 of @xmath7 with one of its two possible orientations so that @xmath10 has an initial vertex @xmath11 and a terminal vertex @xmath12 . for the edges @xmath10 of @xmath9 , choose the orientation so that @xmath13 .",
    "the _  ratio _ of @xmath4 is the quotient @xmath14 .",
    "( we will see that @xmath15 . )",
    "we will never reduce this fraction except to compare sizes .",
    "that is , if we write that the ratio of @xmath4 is @xmath16 , then we always assume that @xmath17 and that @xmath18 .    a _ cooling function",
    "_  for @xmath4 is a function @xmath19 such that , @xmath20 @xmath21 one can interpret @xmath22 as the heat pumped along @xmath10 from @xmath11 to @xmath12 .",
    "then @xmath23 is the net loss of heat at @xmath24 . the _ cooling norm _  of @xmath25 is @xmath26 .",
    "here are the two  characterizations . for the purposes of this paper",
    ", the reader can take either of these  theorems as defining amenability .",
    "the finitely generated group @xmath0 is amenable if and only if there exist finite subsets @xmath27 exhausting @xmath0 whose  ratios @xmath28 approach @xmath29 .    the finitely generated group @xmath0 is nonamenable if and only if there exist finite subsets @xmath30 exhausting @xmath0 and admitting cooling functions @xmath31 whose cooling norms @xmath32 are uniformly bounded .",
    "though no direct use of measure theory appears in this paper , the reader may appreciate an orientation to s procedures .",
    "s proofs proceed roughly as follows .",
    "first proves his cooling theorem .    if uniformly bounded cooling functions",
    "do not exist , then generalizes an argument of banach which describes an outer measure on the group and applies a version of the hahn - banach theorem to create the desired measure on the group .",
    "it is historically interesting to note that banach s purpose in proving the hahn - banach theorem was to prove that abelian groups are amenable .",
    "if uniformly bounded cooling functions do exist , then the banach argument fails ; and it is fairly easy to show that a measure as in the definition of amenable group can not possibly exist .",
    "the  set theorem then has an easy half and a hard half .",
    "the easy half assumes the existence of subsets whose  ratios approach @xmath29 .",
    "since these sets have relatively small boundaries , it is impossible to pump a lot of heat out of these sets without using cooling functions of large norm . hence cooling functions of uniformly bounded norm",
    "do not exist and the group is amenable .",
    "the hard half assumes that such sets do not exist and , by an extremely indirect proof ,  proves that cooling functions with uniformly bounded norms do exist .",
    "it is the hard half of this proof that has most interest for us .",
    "our goal is to make s indirect proof as direct and as algorithmic as possible . in the process",
    ", we streamline the  proof .",
    "statement 2 of lemma  [ lemma : exists ] shows that cooling functions for @xmath4 always exist in this context . using this",
    ", it is easy to show that the two theorems are equivalent by application of our main theorem :    let @xmath8 be a locally finite graph with vertex set @xmath0 and a nonempty finite subset @xmath2 which admits a cooling function .",
    "then @xmath4 admits a cooling function @xmath25 of minimum possible cooling norm @xmath33 , and @xmath34    that is , the minimum cooling norm is equal to the maximum  ratio of subsets @xmath35 of @xmath4 , taking the flner ratio of the empty set to be 0 .",
    "we call such a cooling function with minimum cooling norm an _ optimal cooling function_. this absolute cooling theorem will be a corollary to the cooling theorem of section  [ sec : cooling ] .",
    "we prove the cooling theorem in section  [ sec : cooling ] by refining flner s original arguments . in section  [ sec : lp ] we interpret this cooling theorem in terms of linear programming and give another proof using standard results of linear programming .",
    "section  [ sec : lp ] concludes with a brief derivation of statement 2 of the cooling theorem using the max flow min cut theorem .",
    "the linear programming approach in section  [ sec : lp ] leads to an algorithm , presented in section  [ sec : algo ] , which is a modification of the standard simplex algorithm .",
    "it finds an optimal cooling function @xmath25 and a flner - optimal subset @xmath36 , that is , a subset @xmath36 whose flner ratio is the maximum possible .",
    "moreover , the subset @xmath35 which the algorithm finds has the property that if @xmath37 is a flner - optimal subset of @xmath4 , then @xmath38 . in other words",
    ", there is a maximal such subset of @xmath4 with maximum flner ratio , and the algorithm finds it .",
    "after section  [ sec : algo ] , we describe our partial results toward another algorithmic process for finding the minimum possible cooling norm @xmath39 , finding an optimal cooling function , and finding a flner - optimal subset @xmath40 .",
    "the main ingredient is the relative cooling theorem , another corollary to the cooling theorem of section  [ sec : cooling ] ( see section  [ sec : relative ] ) .",
    "then we describe the process of peeling layers away from an arbitrary set to find a subset of maximum possible  ratio ( section  [ sec : peelings ] ) . and",
    "finally we show how to build up optimal cooling functions layer by layer from known cooling functions on subsets ( section  [ sec : building ] ) .",
    "it can be challenging to determine whether or not a countable group is amenable .",
    "in particular , despite concerted efforts for over @xmath41 years it is still not known whether or not thompson s group @xmath42 is amenable . and while bartholdi and virg showed in @xcite that the basilica group is amenable , their proof is via random walks and one still does nt know how to construct a flner sequence for it .",
    "our hope is that the results of this paper will serve in exploring amenability for countable groups .    *",
    "permanent setting for the remainder of the paper : * @xmath8 is a locally finite graph ; @xmath0 is the set of vertices of @xmath8 ; @xmath4 is a nonempty finite subset of @xmath0 ; @xmath7 is the set of edges of @xmath8 having at least one vertex in @xmath4 , and @xmath43 is the set of edges of @xmath8 having exactly one vertex in @xmath4 .",
    "* always * we assume that the set @xmath4 admits a cooling function .",
    "* edge orientation : * for each edge @xmath44 , we choose one of the two possible orientations of @xmath10 , so that @xmath10 has an _ initial vertex _ @xmath11 and a _ terminal vertex _ @xmath12 . if @xmath45 , then we choose that orientation which has @xmath13 and @xmath46 .",
    "* we always assume given , * as initial data , a function @xmath47 .",
    "in most applications , this function will be identically equal to @xmath48 , but in the relative cooling theorem it is important that we be allowed to modify this initial data .",
    "* cooling functions : * a _ cooling function rel _ @xmath49 is a function @xmath19 such that @xmath50we may interpret @xmath22 as the heat pumped along edge @xmath10 from initial vertex @xmath11 to terminal vertex @xmath12 .",
    "the function @xmath23 is then the net heat loss at the vertex @xmath24 . the absolute cooling theorem of the introduction deals with the special case where @xmath49 is constant and equal to @xmath48 .",
    "the value @xmath51 gives a lower bound on the amount of heat to be pumped out of vertex @xmath24 .",
    "the sum @xmath52 gives the minimal amount of heat that a cooling function must pump out of @xmath4 through the boundary edges @xmath9 of @xmath4 .",
    "recall that we always assume that @xmath4 admits a cooling function .",
    "the next lemma provides an equivalent condition .",
    "we need two definitions for this .",
    "let @xmath53 be a finite subset of @xmath0 .",
    "a connected component of @xmath53 consists of all the vertices in a connected component of the graph @xmath54 . to say that a connected component @xmath55 of @xmath53 has a nonempty boundary , we mean that @xmath56 .",
    "[ lemma : exists ] ( 1)a nonempty finite subset @xmath53 of @xmath0 admits a cooling function rel @xmath49 if and only if every connected component of @xmath53 has a nonempty boundary .",
    "\\(2 ) if @xmath8 is infinite and connected , then every nonempty finite subset @xmath57 admits a cooling function rel @xmath49 .",
    "let @xmath53 be a nonempty finite subset of @xmath0 .",
    "we first prove the forward implication of statement 1 .",
    "suppose that @xmath53 admits a cooling function rel @xmath49 .",
    "let @xmath55 be a connected component of @xmath53",
    ". then @xmath58 .",
    "edges of @xmath59 conduct no heat from @xmath55 .",
    "thus @xmath60 .",
    "this proves the forward implication of statement 1 .    for the backward implication , suppose that every connected component of @xmath53 has a nonempty boundary .",
    "then for each @xmath61 there exists an edge path @xmath62 , @xmath63 , @xmath64 , @xmath65 with @xmath66 , with @xmath67 for @xmath68 , and with @xmath69 , so that @xmath70 . given @xmath71 , transport @xmath72 units of heat from @xmath66 to @xmath73 , the same from @xmath73 to @xmath74 , etc .",
    ", until @xmath72 units have been , in effect , transported from @xmath75 to @xmath76 with no net gain at any intermediate vertex . that is ,",
    "viewing @xmath77 as oriented from @xmath78 to @xmath79 , we define a function from @xmath80 to @xmath81 so that its value at @xmath82 is @xmath72 and 0 otherwise .",
    "call this function a heat - flow path . adding one heat - flow path for each @xmath83 results in a function @xmath84 satisfying @xmath85 for each @xmath83 . thus @xmath25 is a cooling function rel @xmath49 .",
    "this proves statement 1 of lemma  [ lemma : exists ] .    to prove statement 2 ,",
    "suppose that @xmath8 is infinite and connected .",
    "let @xmath61 .",
    "because @xmath8 is infinite and @xmath53 is finite , there exists @xmath86 .",
    "because @xmath8 is connected , there exists an edge path in @xmath8 joining @xmath71 and @xmath87 .",
    "some edge in this edge path is in @xmath88 .",
    "it follows that every connected component of the boundary of @xmath53 is nonempty .",
    "statement 2 now follows from statement 1 .",
    "this proves lemma  [ lemma : exists ] .",
    "*  ratio : * because we always assume that @xmath4 admits a cooling function rel @xmath49 , lemma  [ lemma : exists ] implies that @xmath89 .",
    "the _  ratio _",
    "@xmath90 measures the average amount of heat that must be pumped out of @xmath4 along each edge @xmath91 by any cooling function rel @xmath49 .",
    "since @xmath4 admits a cooling function rel @xmath49 , so does every nonempty subset @xmath35 of @xmath4 .",
    "so @xmath92 exists for each @xmath35 .",
    "we set @xmath93 .",
    "[ lemma : lowerbd ] if @xmath36 , then @xmath92 is a lower bound on the norm of every cooling function on @xmath4 rel @xmath49 .",
    "since a cooling function must cool each subset @xmath94 , since the heat in @xmath35 must be carried out of @xmath35 along the boundary edges of @xmath35 , and since at least one boundary edge must carry at least the average required per boundary edge , it follows immediately that the minimum cooling norm @xmath33 of a cooling function must be at least as large as the  ratio @xmath92 .    our absolute cooling theorem will show that @xmath39 is exactly equal to the maximum of the flner ratios which occur in this lemma .    * the simplex @xmath95 with vertices @xmath4 and the functions @xmath96 : *",
    "let @xmath95 denote the abstract simplex whose vertices are the elements of the set @xmath4 .",
    "an element of @xmath95 is therefore a function @xmath97 $ ] such that @xmath98 . with each element",
    "@xmath99 we associate a function @xmath100 , where @xmath101 @xmath102 @xmath103    [ thm : cooling ] ( 1 )",
    "if @xmath39 is the minimum possible norm of a cooling function for @xmath4 rel @xmath49 , then the reciprocal @xmath104 is given by the minimum value of a convex function @xmath105 on the simplex @xmath95 as follows : @xmath106 where @xmath107 is the modification of @xmath108 defined above and @xmath109    \\(2 ) the minimum possible norm @xmath39 is given by the maximum  ratio : @xmath110    \\(3 ) if @xmath92 realizes the maximum in ( 2 ) , then the function @xmath111 whose modification @xmath107 is constant on @xmath35 and @xmath112 on @xmath113 realizes the minimum in ( 1 ) .",
    "( 1 ) : the verification that @xmath114 is a convex function is left to the reader . since the function @xmath115 is positive and continuous on the compact set @xmath95 , there is certainly a function in @xmath95 which gives a positive minimum for @xmath114 .    for the rest , we follow s argument .",
    "we fix a candidate norm @xmath39 for a cooling function rel @xmath49 .",
    "we introduce a variable @xmath116 for each @xmath44 and note that a cooling function of norm @xmath117 is an assignment of a real value to each of the variables @xmath116 in such a way that the following inequalities are satisfied : @xmath118 @xmath119the first of these inequalities says that each element of @xmath4 is cooled by the required amount .",
    "the last two inequalities say that the norm of the resulting cooling function is @xmath117 .",
    "we assume that @xmath39 is too small , so that no cooling function exists , and conclude from farkas lemma , lemma  [ lemma : farkas ] , that there exist nonnegative numbers @xmath120 , @xmath121 , and @xmath122 satisfying the following two conditions : @xmath123 and @xmath124 we can not have @xmath120 identically @xmath112 , for then the left - hand side of line  [ lin : line6 ] would be @xmath125 , a contradiction .",
    "we may therefore scale the coefficients @xmath120 , @xmath121 , and @xmath122 so that @xmath126 .",
    "that is , we may assume that @xmath127",
    ". we may assume the function @xmath128 is extended to the vertices of @xmath9 not in @xmath4 so as to be @xmath112 on vertices not in @xmath4 .",
    "it follows that this extended @xmath128 is our standard modification @xmath107 of the function @xmath108 .",
    "we normalize @xmath121 and @xmath122 as follows : we replace the larger of @xmath121 and @xmath122 by the nonnegative difference @xmath129 and the other by @xmath112 .",
    "this has no effect at all on the condition in line  [ lin : line5 ] , and it can only increase the sum in line  [ lin : line6 ] ; so the two conditions are still satisfied .",
    "we claim that @xmath130 .",
    "indeed , the coefficient of @xmath116 in line  [ lin : line5 ] is 0 , and so @xmath131 because of our normalization , one of @xmath121 and @xmath122 is @xmath112 , and so @xmath132 .",
    "hence @xmath133as desired .    with @xmath126 and @xmath134",
    ", we find that line  [ lin : line6 ] is equivalent to @xmath135thus cooling functions of norm @xmath39 exist if @xmath136 .",
    "the converse of this statement can be proved by assuming that there exists @xmath99 with @xmath137 and reversing this argument .",
    "the function @xmath108 determines the numbers @xmath120 as above .",
    "we choose the numbers @xmath121 and @xmath122 as above so that one of them is 0 and so that line  [ lin : line7 ] is satisfied .",
    "we conclude that lines  [ lin : line5 ] and [ lin : line6 ] hold .",
    "now farkas lemma implies that there is no cooling function with norm @xmath39 .",
    "so cooling functions with norm @xmath39 exist if and only if @xmath138 .",
    "this proves ( 1 ) .",
    "\\(2 ) and ( 3 ) : lemma  [ lemma : lowerbd ] shows that the minimum possible cooling norm @xmath39 for @xmath4 must be at least as large as @xmath139 .",
    "our remaining task is to find a subset @xmath35 of maximum  ratio and to show that the function @xmath140 associated with @xmath35 as in ( 3 ) does in fact realize the minimum @xmath141 in ( 1 ) .",
    "suppose that @xmath114 assumes its minimum at @xmath99 .",
    "we let @xmath36 denote the set of points in @xmath4 at which the corresponding function @xmath107 takes its ( positive ) maximum .",
    "we shall see that this set @xmath35 satisfies the required conditions .    as in ( 3 ) , we let @xmath142 be constant and positive , equal to @xmath143 , on @xmath35 , and constant , equal to @xmath112 , on the complement of @xmath35 . the corresponding element @xmath140 therefore satisfies the equation @xmath144 thus @xmath145 .",
    "it is easy to calculate @xmath146 since @xmath147 is only nonzero for @xmath148 .",
    "therefore , @xmath149 we know that @xmath105 realizes the minimum in ( 1 ) .",
    "we complete the proof by showing that @xmath150 so that the latter also realizes the minimum in ( 1 ) .",
    "we apply the methods of the calculus of variations .",
    "we consider the functions @xmath151 defined as follows : @xmath152note that we are simply reducing some of the positive values of @xmath108 by a little bit and are then scaling so as to remain in @xmath95 .",
    "the following lemma completes the proof .",
    "@xmath153    the derivative is certainly @xmath154 since @xmath105 minimizes @xmath114 .",
    "it is an easy matter to take the derivative of @xmath155 if we know which of the two options @xmath156 or @xmath157 is true .",
    "luckily , we can determine appropriate signs @xmath158 for each of our three absolute values @xmath159 , @xmath160 , and @xmath147 , which appear in the defining formula for @xmath105 , @xmath161 , and @xmath146 , and those signs may be chosen compatibly .    to each edge",
    "@xmath44 we assign a number @xmath162 as follows : if @xmath163 , then @xmath164 ; otherwise , @xmath165 .    for @xmath166 sufficiently small",
    ", the function @xmath167 will clearly require the same signs @xmath168 .    because the function @xmath142 is positive only on the elements of @xmath35 , where @xmath107 takes on its maximum value",
    ", @xmath142 will require the same sign provided that exactly one end point of @xmath10 is in @xmath35 .",
    "if neither end point of @xmath10 is in @xmath35 or if both end points of @xmath10 are in @xmath35 , then @xmath169 and we may use the same value of @xmath168 for @xmath142 as has already been chosen for @xmath107 and @xmath167 .",
    "thus we may choose multipliers @xmath162 so that we have the following three equalities for all @xmath166 sufficiently small : @xmath170 @xmath171 @xmath172we would be unable to obtain compatible signs @xmath168",
    "if @xmath35 had been chosen via anything but the _ maximum _ value of @xmath107 . with all absolute value signs replaced by constants @xmath168 , it is an easy matter to calculate @xmath173 by the quotient rule , and the result is as stated in the lemma :    @xmath174    this argument completes the proof of the cooling theorem .",
    "set @xmath175 .",
    "we conclude this section with a discussion of farkas lemma . in section 4 of @xcite ,",
    "flner states essentially the following result , which he presents as a minor modification of a result proved by carver in theorem 3 of @xcite .",
    "[ lemma : farkas ] let @xmath176 be a linear map and let @xmath177 .",
    "then a necessary and sufficient condition that there be no solution to the inequality @xmath178 is that there exist a nonnegative vector @xmath179 , @xmath180 , such that @xmath181 but @xmath182 .",
    "this is one of the equivalent formulations of farkas lemma .",
    "to see this , we apply corollary 7.1e on page 89 of schrijver s book @xcite .",
    "this corollary is one form of farkas lemma .",
    "it states the following , a bit loosely .",
    "let @xmath114 be a matrix and let @xmath183 be a vector . then the system @xmath184 of linear inequalities has a solution @xmath71 , if and only if @xmath185 for each row vector @xmath186 with @xmath187 . replacing @xmath183 with @xmath188 ,",
    "yields the following .",
    "the system @xmath189 of linear inequalities has a solution @xmath71 , if and only if @xmath190 for each row vector @xmath186 with @xmath187 .",
    "lemma  [ lemma : farkas ] is the contrapositive of this .",
    "in this section we give another proof of the cooling theorem , theorem  [ thm : cooling ] , using standard results from linear programming .",
    "murty @xcite and schrijver @xcite are good references for linear programming .",
    "we maintain the notation of section  [ sec : cooling ] .",
    "we wish to minimize the maximum value of @xmath191 subject to the conditions @xmath192 in the spirit of linear programming , we introduce a variable @xmath193 for every @xmath44 and restate this problem as follows . minimize the maximum value of @xmath194 subject to the conditions @xmath195 now we introduce one more variable @xmath196 and in effect replace @xmath193 by @xmath193 divided by the maximum value of @xmath197 to see that our problem is equivalent to the following problem .",
    "maximize @xmath196 subject to the conditions @xmath198 the solution of this problem is the inverse of the solution of our original problem .",
    "this is a linear programming problem in the form @xmath199 as in line 13 on page 90 of schrijver s book @xcite . here",
    "@xmath71 is the column vector of variables @xmath196 , @xmath193 for @xmath200 .",
    "we have that @xmath25 is the row vector with as many components as @xmath71 with the component corresponding to @xmath196 being 1 and all other components being 0 .",
    "similarly , @xmath183 is the column vector of right side constants in line  [ lin : system ] and @xmath114 is the coefficient matrix of this system of linear inequalities .",
    "( the @xmath114 here is not to be confused with our previous @xmath114 . )",
    "now we apply the duality theorem of linear programming . just as farkas lemma , which we encountered at the end of section  [ sec : cooling ] ,",
    "has a number of formulations , so does the duality theorem .",
    "we apply the formulation given in corollary 7.1 g on page 90 of schrijver s book @xcite : @xmath201 provided that both of these sets are nonempty .",
    "the origin is in the first set , so the first set is nonempty .",
    "we will soon see that the second one is nonempty too .",
    "so we now have new variables @xmath202 for every @xmath203 , one for every inequality in line  [ lin : system ] corresponding to an element of @xmath4 .",
    "we also have new variables @xmath116 and @xmath204 for every @xmath44 corresponding to the two inequalities in line  [ lin : system ] for every @xmath44 .",
    "furthermore @xmath87 is the row vector whose entries are these new variables .",
    "the duality theorem transforms our problem into the following one .",
    "minimize @xmath205 subject to the conditions @xmath206 the last equation requires the convention that @xmath207 if @xmath208 .",
    "suppose that we fix the variables @xmath202 and let the variables @xmath116 and @xmath204 vary .",
    "then @xmath209 is fixed for every @xmath44 .",
    "if @xmath87 and @xmath210 are nonnegative real numbers with @xmath211 , a fixed value , then the smallest possible value for @xmath212 is @xmath213 . thus our problem is equivalent to the following one .",
    "minimize @xmath214 subject to the conditions @xmath215 now it is clear that our second set is also nonempty , and we have statement 1 of the cooling theorem .    to prove statements 2 and 3 of the cooling theorem , note that the map @xmath114 is not only convex but piecewise linear .",
    "in fact , its restriction to every cell of the first barycentric subdivision of @xmath95 is linear . as for general linear programming problems",
    ", it follows that its minimum occurs at a vertex of the first barycentric subdivision of @xmath95 .",
    "( see section 3.5.5 of murty s book @xcite or section 8.3 of schrijver s book @xcite . )",
    "these vertices are the points @xmath99 such that @xmath108 is constant on some subset @xmath35 of @xmath4 and 0 on @xmath216 . from the definition of @xmath114",
    ", we see that if @xmath108 is such a point of @xmath95 , then @xmath217 as in line  [ lin : ag ] .",
    "this completes our linear programming proof of the cooling theorem .",
    "we conclude this section with a brief discussion involving the max flow min cut theorem . given the close connection between the max flow min cut theorem and linear programming , ( see section 7.10 of schrijver s book @xcite . )",
    "it should not be surprising that the max flow min cut theorem is relevant to our problem .",
    "we apply theorem 1.1 on page 38 of ford and fulkerson s book @xcite we take the sets @xmath218 and @xmath4 there to be empty and the set @xmath53 there to be our set @xmath4 .",
    "the set @xmath219 there is our @xmath35 .",
    "the function @xmath108 there is our cooling function @xmath25 .",
    "the function @xmath183 there is our @xmath49 .",
    "the function @xmath25 there is our norm @xmath220 .",
    "the conclusion is that the real number @xmath221 is the norm of a cooling function @xmath25 on @xmath4 rel @xmath49 if and only if @xmath222 for every @xmath36 .",
    "thus @xmath223 .",
    "this is statement 2 of the cooling theorem .",
    "the previous section shows that the problem of finding an optimal cooling function is a linear programming problem . as such",
    ", it can be solved by the simplex method . in our situation",
    "every step of the simplex method proceeds as follows .",
    "we have a cooling function @xmath25 , and the simplex method finds the vertices at which @xmath25 is not optimal .",
    "one chooses one of these vertices , and the step concludes with a computation which improves @xmath25 at the chosen vertex .",
    "this algorithm has the defects that at every step the norm of @xmath25 usually does not decrease , there is this choice of vertex , and poor choices might lead to an infinite loop , although a further enhancement of the algorithm can avoid infinite loops .",
    "the algorithm which we present in this section is a greedy algorithm in that at every step we improve our cooling function @xmath25 at every vertex at which @xmath25 is not optimal .",
    "because we deal with every bad vertex , the norm of @xmath25 decreases at every step . in our algorithm the numerator of @xmath224 is always bounded by @xmath225 and the denominator of @xmath224 is bounded by @xmath226 . since @xmath224 decreases at every step , the number of steps is therefore bounded by @xmath227 .",
    "the number of operations per step is linear in @xmath226 .",
    "thus the number of operations required for our algorithm to find the optimal cooling function is cubic in @xmath226 . in practice",
    "it seems to be quadratic .",
    "the steps in our algorithm are far more complicated than the steps of the simplex method , but there are far fewer of them . in our limited experience ,",
    "our algorithm is faster .",
    "moreover , the subset @xmath35 of @xmath4 with maximal flner ratio which our algorithm finds also has the property ( see theorem  [ thm : maxl ] and the discussion immediately preceding it . ) that if @xmath53 is a subset of @xmath4 with maximal flner ratio , then @xmath228 .    here is our modified simplex algorithm .",
    "let @xmath8 be a locally finite graph , as usual .",
    "the edges of @xmath8 are initially undirected .",
    "however , we often direct the edges of @xmath8 , choosing directions to suit the occasion . if @xmath10 is a directed edge of @xmath8 , then , as usual , we let @xmath11 denote the initial vertex of @xmath10 , and we let @xmath12 denote the terminal vertex of @xmath10 .",
    "now we fix a nonempty finite set @xmath4 of vertices of @xmath8 , as usual .",
    "we direct the edges of @xmath7 so that every edge of @xmath229 is directed away from @xmath4 .",
    "let @xmath230 be a nonnegative real number .",
    "a cooling function for @xmath4 relative to @xmath230 is a function @xmath231 such that @xmath232 we refer to this inequality as the vertex condition or vertex inequality at @xmath233 .",
    "the absolute cooling theorem deals with the case in which @xmath234 .",
    "it states that @xmath4 admits a cooling function relative to @xmath234 of minimum norm , and this norm is @xmath235 .",
    "in other words , there exists a maximum value of @xmath230 such that @xmath4 admits a cooling function relative to @xmath230 with norm 1 , and this maximum value of @xmath230 is @xmath236 . in this way we are led to the problem of maximizing @xmath230 over all cooling functions for @xmath4 with norm 1",
    "this is what our modified simplex algorithm does : it maximizes @xmath230 over all cooling functions for @xmath4 with norm 1 . for every edge @xmath44",
    ", we refer to the inequality @xmath237 as the edge condition or edge inequality at @xmath10 .",
    "our modified simplex algorithm proceeds in steps , starting with step 0 .",
    "after @xmath221 steps we have the following .",
    "we have a forest @xmath238 , which is a subgraph of @xmath8 .",
    "the vertex set of @xmath238 equals @xmath4 .",
    "every connected component of @xmath238 is a rooted tree .",
    "we direct every edge of @xmath238 down toward the root of its component .",
    "we also have a set @xmath239 .",
    "no element of @xmath240 is an edge of @xmath238 , and every element of @xmath240 is directed .",
    "we direct the edges of @xmath7 compatibly with @xmath238 , @xmath240 and @xmath229 .",
    "we also have a nonnegative real number @xmath241 . a cooling function for @xmath242",
    "is a function @xmath231 satisfying the following conditions .",
    "1 .   @xmath243 if @xmath244 2 .",
    "@xmath245 if @xmath10 is neither an edge of @xmath238 nor in @xmath246 3 .",
    "@xmath247 for every element @xmath233 of @xmath4 which is not a root of @xmath238 4 .",
    "@xmath248 for every root @xmath233 of @xmath238    in addition to the above , we have a cooling function @xmath249 for @xmath242 with norm 1 which never takes the value @xmath250 .",
    "finally , @xmath241 is maximal with respect to the property that there exists a cooling function for @xmath242 with norm 1 .",
    "given such a quadruple @xmath251 , the algorithm constructs another one @xmath252 with @xmath253 unless the algorithm finds a subset of @xmath4 with maximum flner ratio .",
    "this eventually occurs , the algorithm finds a subset of @xmath4 with maximum flner ratio @xmath254 together with an associated cooling function and the algorithm stops .",
    "the situation at step 0 is as simple as possible .",
    "the forest @xmath255 has no edges .",
    "its connected components , the elements of @xmath4 , are trivial rooted trees .",
    "the set @xmath256 is empty .",
    "the cooling function @xmath257 takes the value 1 on @xmath229 and the value 0 elsewhere .",
    "the maximality of @xmath49 then implies that @xmath258 all conditions are satisfied .",
    "now let @xmath221 be a nonnegative integer , and suppose that we have @xmath238 , @xmath240 , @xmath241 and @xmath249 as above .",
    "we prepare to construct @xmath259 , @xmath260 , @xmath261 and @xmath262 in the next paragraph .",
    "suppose that the edge inequality satisfied by @xmath249 is strict for every edge of @xmath238 .",
    "let @xmath53 be a nontrivial connected component of @xmath238 , and let @xmath233 be a leaf of @xmath53 .",
    "( roots are not leaves . ) because the edge inequality satisfied by @xmath249 at the edge @xmath10 of @xmath53 which contains @xmath233 is strict , it is possible to send slightly more than @xmath263 units of heat toward the root of @xmath53 along @xmath10 while satisfying the vertex equality at @xmath233 for a value slightly larger than @xmath241 .",
    "we modify @xmath249 in this way at every edge of @xmath53 to satisfy the vertex equality at every vertex of @xmath53 other than its root for a real number slightly larger than @xmath241 .",
    "this applies to every such connected component of @xmath238 .",
    "thus because @xmath241 is maximal , the vertex inequality satisfied by @xmath249 for @xmath241 at some root of @xmath238 is actually an equality .",
    "we conclude that either the edge inequality satisfied by @xmath249 at some edge of @xmath238 is actually an equality or the vertex inequality satisfied by @xmath249 for @xmath241 at some root of @xmath238 is actually an equality .",
    "we observe that because @xmath249 never takes the value @xmath250 , if @xmath10 is an edge of @xmath238 , then @xmath264 if and only if @xmath265 .",
    "we digress briefly in this paragraph to show that @xmath254 is a relative flner ratio .",
    "according to the previous paragraph there exists either a root or an edge of @xmath238 such that the inequality satisfied by @xmath249 at either this root or edge is actually an equality .",
    "if this equality holds at a root , then let @xmath233 be this root , and if this equality holds at an edge , then let @xmath233 be the upper vertex of this edge .",
    "let @xmath35 be the set of those vertices in @xmath4 which are either equal to or above @xmath233 relative to @xmath238 . by assumption",
    "the vertex inequality satisfied by @xmath249 for @xmath241 is actually an equality at every element of @xmath35 other than @xmath233 , and now this is even true at @xmath233 .",
    "we combine these equations , one for every vertex of @xmath35 .",
    "we use the facts that @xmath265 for every edge @xmath244 and @xmath266 if @xmath10 is neither an edge of @xmath238 nor in @xmath267 .",
    "we also use the fact that if @xmath233 is not a root , then the edge of @xmath238 immediately below it is directed away from @xmath35 and @xmath249 has value 1 at it . letting @xmath268 denote the set of edges of either @xmath229 or @xmath238 which contain exactly one element of @xmath35 , we obtain that @xmath269 hence @xmath270 , where @xmath271 we view @xmath272 as a relative flner ratio .",
    "it is the flner ratio of @xmath35 relative to @xmath4 , @xmath238 and @xmath240 .",
    "we return to the result of the penultimate paragraph .",
    "either the edge inequality satisfied by @xmath249 at some edge of @xmath238 is actually an equality or the vertex inequality satisfied by @xmath249 for @xmath241 at some root of @xmath238 is actually an equality .",
    "we find every such root and edge .",
    "every such root loses its status as root .",
    "every such edge , but not its vertices , is removed from @xmath238 .",
    "the result is a forest , which we denote by @xmath273 .",
    "every edge just removed from @xmath238 , directed as in @xmath238 , is added to @xmath240 .",
    "the result is a set of directed edges , which we denote by @xmath274 .",
    "the forest @xmath273 has connected components without roots .",
    "we now construct @xmath259 by inductively enlarging the rooted connected components of @xmath273 .",
    "we adjoin certain edges to @xmath273 to construct a maximal forest with at most one root per connected component .",
    "the edges which we adjoin are edges of @xmath275 which are either not in @xmath274 or directed away from the rooted connected components .",
    "so , if possible we adjoin such an edge to @xmath273 , joining one of its rooted connected components with one of its unrooted connected components .",
    "the result is a forest , one of whose rooted connected components contains two connected components of @xmath273 .",
    "if possible we adjoin such an edge to this new forest , joining one of its rooted connected components with one of its unrooted connected components .",
    "we continue in this way as long as possible .",
    "this final forest is @xmath259 .",
    "suppose that @xmath259 has a connected component which is not rooted ( which occurs if @xmath273 has no roots ) .",
    "let @xmath35 be the set of elements of @xmath4 which are not contained in rooted connected components of @xmath259 . then",
    "every edge in @xmath276 is either in @xmath229 or it is in @xmath274 and directed away from @xmath35 .",
    "hence @xmath265 for every @xmath277 .",
    "it follows that @xmath249 is removing as much heat from @xmath35 as is possible while maintaining norm 1 . as in the paragraph which discusses relative flner ratios",
    ", there is no cooling function for @xmath4 with norm 1 relative to a value larger than @xmath278 , where this relative flner ratio is computed relative to @xmath274 . in this case",
    "@xmath35 is a subset of @xmath4 with maximum flner ratio , and the algorithm stops .",
    "suppose that the algorithm does not stop at step @xmath221 .",
    "then every connected component of @xmath259 is rooted .",
    "we define @xmath260 to be the set of directed edges gotten from @xmath274 by deleting those edges of @xmath274 which became edges of @xmath259 .",
    "if @xmath233 is a root of @xmath238 at which the inequality satisfied by @xmath249 for @xmath241 is an equality , then @xmath233 is not a root of @xmath259 .",
    "if @xmath10 is an edge of @xmath238 at which the inequality satisfied by @xmath249 is an equality , that is , @xmath265 , then either @xmath10 is not an edge of @xmath259 or it is directed away from the root of its connected component .",
    "the cooling function @xmath249 need not be a cooling function for @xmath279 mostly because some edge directions might have changed . by simply changing some signs if necessary , @xmath249 determines a cooling function @xmath280 for @xmath279 except for possibly taking the value @xmath250 at some edges . the value of @xmath280 at every edge of @xmath259 is strictly less than 1 . as at the beginning of the passage from step @xmath221 to step @xmath281 , this implies that by appropriately increasing every value of @xmath280 by a positive amount we obtain a cooling function for @xmath279 which satisfies every conditional inequality for a real number strictly larger than @xmath241 . because the vertex inequality for @xmath280 is an equality for every vertex of @xmath259 which is not a root , every value of every cooling function for @xmath282 with @xmath283 is at least as large as the corresponding value of @xmath280 . maximizing ,",
    "we obtain a real number @xmath261 and a cooling function @xmath262 for @xmath284 with norm 1 which never takes the value @xmath250 such that @xmath261 is maximal with respect to the property that there exists a cooling function for @xmath284 with norm 1 .",
    "the quadruple @xmath252 satisfies all required conditions .",
    "this completes the description of the algorithm .    in this paragraph",
    "we show that this algorithm ends with a solution after finitely many steps .",
    "we have seen that @xmath254 is a relative flner ratio for every @xmath221 .",
    "hence the numerator of @xmath241 is bounded by @xmath285 and the denominator of @xmath241 is bounded by @xmath286 .",
    "there are only finitely many possibilities for @xmath241 .",
    "since the sequence @xmath287 is strictly increasing , it follows that the algorithm ends after finitely many steps .",
    "the proof of the following theorem is based on this modified simplex algorithm . by comparing the proof and the algorithm",
    ", one sees that the algorithm finds the subset @xmath35 of the theorem .",
    "[ thm : maxl ] the set @xmath4 contains a maximal flner - optimal subset @xmath35 , that is , a subset @xmath35 with maximum flner ratio , such that every flner - optimal subset of @xmath4 is contained in @xmath35 .    after choosing directions for the edges of @xmath7 , the absolute cooling theorem implies that there exists a cooling function @xmath231 with norm 1 rel @xmath49 , where @xmath49 is the inverse of the maximum flner ratio of a subset of @xmath4 . without loss of generality",
    "we assume that if @xmath288 , then @xmath10 is directed away from @xmath4 and that @xmath243 .",
    "let @xmath53 be a flner - optimal subset of @xmath4 .",
    "so @xmath289 . we direct every edge of @xmath88 away from @xmath53 . by definition @xmath25",
    "satisfies the vertex inequality , @xmath290 for every @xmath291 , and so this holds for every @xmath292 .",
    "we combine these vertex inequalities , one for every element of @xmath53 , and obtain @xmath293 since @xmath237 for every @xmath294 and the number of these summands equals @xmath295 , we can make two conclusions .",
    "one is that every vertex inequality for @xmath53 is actually an equality .",
    "the other is that @xmath243 for every @xmath294 .",
    "we use these two conclusions to construct the maximal subset of @xmath4 with maximum flner ratio . for this",
    "we define a ( nonreflexive , nonsymmetric and nontransitive ) relation on @xmath4 as follows . given @xmath296 , we have that @xmath297 if and only if there exists @xmath44 directed so that @xmath298 , @xmath299 and @xmath300 . ( the condition @xmath300 is equivalent to @xmath301 . ) here we view @xmath25 as being defined not only for every edge @xmath44 with its given direction but also for the opposite edge @xmath302 , so that @xmath303 .",
    "let @xmath304 be the set of vertices of @xmath4 whose associated vertex inequality is strict .",
    "let @xmath219 be the closure of @xmath304 under the above relation .",
    "conclusion one from above implies that every subset of @xmath4 with maximum flner ratio is contained in the complement of @xmath304 .",
    "conclusion two then implies that every subset of @xmath4 with maximum flner ratio is contained in the complement of @xmath219 .",
    "now let @xmath35 be the complement of @xmath219 . to prove the theorem it suffices to prove that @xmath305 , the maximum flner ratio of a subset of @xmath4 .",
    "for this we first observe that every vertex inequality is actually an equality for every element of @xmath35 . furthermore ,",
    "if @xmath277 is directed away from @xmath35 , then @xmath243 .",
    "combining the vertex equalities associated to @xmath35 as in the second paragraph of this proof , we find that @xmath306 .",
    "this implies that @xmath305 .",
    "this proves theorem  [ thm : maxl ] .",
    "our plan for the rest of the paper is to construct cooling functions by finding a flner - optimal subset @xmath40 , building an optimal cooling function @xmath257 on @xmath35 , and then building cooling functions on larger and larger subsets of @xmath4 , extending @xmath257 layer by layer . a cooling function on a smaller subset pumps heat into the layers not yet considered .",
    "thus we need to know when the extension is possible .",
    "this problem is dealt with by means of the relative cooling theorem , which is a corollary to the cooling theorem of section  [ sec : cooling ] .",
    "the only twist in the argument is that we do not apply the theorem to a subgraph of @xmath8 but rather to a slightly modified subgraph .    *",
    "setting : * we assume @xmath8 , @xmath0 , @xmath4 , @xmath7 , and @xmath9 given , with edges @xmath44 oriented as before .    * the modified graph @xmath307 and modified vertex set @xmath308 : * we form a new graph @xmath307 from the graph @xmath309 by splitting all edges @xmath91 apart at any common vertex in the complement of @xmath4 so that the boundary edges have distinct terminal vertices in the complement of @xmath4 .",
    "let @xmath308 be a subset of the set of vertices of @xmath310 with @xmath311 .    * initial conditions : * we assume given a function @xmath312 .",
    "* we assume : * @xmath308 admits a cooling function rel @xmath49 .",
    "lemma  [ lemma : exists ] implies that @xmath308 admits a cooling function rel @xmath49 if and only if every connected component of @xmath308 has a nonempty boundary .",
    "we immediately obtain the following _ relative cooling theorem _ , which is simply the general cooling theorem of section  [ sec : cooling ] applied to our modified graph @xmath307 :    \\(1 ) if @xmath39 is the minimum possible norm of a cooling function rel @xmath49 , then the reciprocal @xmath104 is given by the minimum value of a convex function @xmath105 on the simplex @xmath313 as follows : @xmath314 where @xmath107 is the modification of @xmath108 defined above and @xmath315    \\(2 ) the minimum possible norm @xmath39 is given by the maximum  ratio : @xmath316    \\(3 ) if @xmath92 realizes the maximum in ( 2 ) , then the function @xmath317 whose modification @xmath107 is constant on @xmath35 and @xmath112 on @xmath318 realizes the minimum in ( 1 ) .",
    "we shall apply this relative cooling theorem in section  [ sec : peelings ] .",
    "we assume @xmath8 , @xmath0 , @xmath4 , @xmath7 , @xmath9 , and @xmath319 given as before .",
    "our goal is to find a flner - optimal subset @xmath36 .",
    "we propose to do so by peeling layers away from @xmath4 until we find the desired set .",
    "let @xmath320 be a nonempty subset of @xmath4 , and let @xmath321 .",
    "we have the ( split ) graph @xmath322 from the previous section .",
    "let @xmath323 be the subset of @xmath322 consisting of @xmath320 together with the boundary vertices of @xmath322 arising from ( the splitting of ) points of @xmath53 . if @xmath324 , then we let @xmath325 denote the cardinality of @xmath326 and we let @xmath327 denote the number of edges in @xmath322 having exactly one vertex in @xmath328 .",
    "[ note that if @xmath329 is not joined by its unique edge @xmath10 in @xmath322 to a point of @xmath328 , then @xmath71 is counted in @xmath325 and @xmath10 is counted in @xmath327 .",
    "] we call @xmath320 a _ peeling _ for @xmath4 if @xmath330    the next lemma gives an alternate characterization of peelings .",
    "[ lemma : alt ] let @xmath39 be a positive real number . in the above setting , we extend @xmath331 to @xmath323 by defining @xmath332 for each @xmath333",
    ". then @xmath334 if and only if @xmath335 for every @xmath336 .",
    "in particular , taking @xmath337 shows that @xmath320 is a peeling for @xmath4 if and only if @xmath338 for every @xmath336 .",
    "let @xmath336 .",
    "then @xmath339 so @xmath334 if and only if @xmath340 if and only if @xmath341 this proves lemma  [ lemma : alt ] .",
    "the next lemma gives a basic property of peelings .",
    "[ lemma : peeling0 ] if @xmath320 is a peeling for @xmath4 , then every connected component of @xmath342 has a nonempty boundary .",
    "let @xmath328 be a nonempty subset of @xmath323 . from the definition of peeling , @xmath343 if @xmath344 , then @xmath345 , and so @xmath346 .",
    "it easily follows that @xmath327 is positive for every nonempty subset @xmath328 of @xmath323 .",
    "in particular , it is positive if @xmath328 is a connected component of @xmath323 .",
    "so some edge of @xmath322 contains exactly one vertex of @xmath328 .",
    "this proves lemma  [ lemma : peeling0 ] .",
    "peelings are important for two reasons :    [ thm : peeling1 ] if @xmath320 is a peeling for @xmath347 , then every cooling function for @xmath53 rel @xmath49 can be extended to a cooling function for @xmath4 rel @xmath49 without increasing the cooling norm .",
    "[ thm : peeling2 ] if @xmath53 is a proper subset of @xmath4 which is flner - optimal , then @xmath348 is a peeling for @xmath4 .",
    "these two theorems apply as follows : a subset @xmath4 can be _ peeled _ until a subset @xmath35 is obtained that admits no peeling .",
    "when that happens , theorem  [ thm : peeling2 ] implies that @xmath92 is as large as the  ratio of any of its subsets .",
    "since @xmath4 admits a cooling function rel @xmath49 , so does @xmath35 .",
    "hence , by the cooling theorem , the set @xmath35 admits a cooling function @xmath257 of cooling norm @xmath92 . by theorem  [ thm : peeling1 ] , this cooling function extends to a cooling function for @xmath4 of norm @xmath92 .",
    "we conclude that @xmath92 maximizes the  ratio of subsets of @xmath4 , that @xmath92 is the minimal cooling norm for @xmath4 , and that the extension of @xmath257 is an optimal cooling function for @xmath4 .",
    "the following problems remain :    * problems . *",
    "give an efficient algorithm for determining when a peeling exists .",
    "give an efficient algorithm for finding a peeling when a peeling exists .",
    "suppose we are given a cooling function for @xmath53 rel @xmath49 .",
    "we can modify this function so that it is constant on all boundary edges of @xmath53 and equal to the norm @xmath39 of the function on those edges",
    ". it suffices to show that this modified cooling function extends to a cooling function for @xmath4 rel @xmath49 , for returning the values of the extension on the boundary edges of @xmath53 to their original values will not destroy the cooling properties of the extension .    from this point",
    ", we concentrate on @xmath342 .",
    "we extend @xmath331 to @xmath323 by defining @xmath349 for each @xmath333 .",
    "lemmas  [ lemma : peeling0 ] and [ lemma : exists ] combine to show that @xmath323 admits a cooling function rel @xmath49 .",
    "hence the relative cooling theorem applies to this situation .",
    "it implies that the smallest possible cooling norm for @xmath323 rel @xmath49 is @xmath350 .",
    "lemma  [ lemma : alt ] implies that @xmath351 .",
    "hence a cooling function for @xmath323 with norm @xmath352 provides an extension of the original cooling function for @xmath53 .",
    "this proves theorem  [ thm : peeling1 ] .",
    "let @xmath53 be a proper subset of @xmath4 whose  ratio @xmath337 is maximal among all subsets of @xmath4 .",
    "let @xmath353 , a nonempty subset of @xmath4 .",
    "we prove that @xmath320 is a peeling for @xmath4 .",
    "indeed , statement 2 of the cooling theorem implies that there exists a cooling function @xmath19 for @xmath4 rel @xmath49 of norm @xmath39 .",
    "this function also cools @xmath53 rel @xmath49 . with the edges of @xmath88 oriented away from @xmath53",
    ", the values of @xmath25 on them must be constant with value @xmath39 , for , if some boundary value carries less than the average @xmath39 required of the boundary edges of @xmath53 , then another would have to carry more than the average , a contradiction .",
    "we return to @xmath322 as in the proof of theorem  [ thm : peeling1 ] .",
    "we again extend @xmath331 to @xmath323 by defining @xmath332 for each @xmath333 .",
    "the edges of @xmath354 are in canonical bijective correspondence with the edges of @xmath322 , and so @xmath25 determines a function @xmath355 from the edges of @xmath322 to @xmath81 .",
    "it is clear that @xmath355 cools @xmath320 viewed as a subset of @xmath322 , and @xmath355 also cools @xmath356 because every edge of @xmath88 carries @xmath39 units of heat away from @xmath53 .",
    "so @xmath355 is a cooling function rel @xmath49 with norm @xmath39 .",
    "now we apply statement 2 of the relative cooling theorem to conclude that @xmath357 for every @xmath336",
    ". now lemma  [ lemma : alt ] implies that @xmath320 is a peeling for @xmath4 .",
    "our eventual goal ( unfortunately , only partially completed in this paper ) is to find an efficient algorithm to find a subset @xmath40 having maximum  ratio @xmath92 .",
    "the steps proposed are these :            in the remainder of this section , we show how these steps can be carried out for the @xmath221-ball @xmath362 in the free abelian group @xmath363 with its standard two - generator generating set .",
    "this ball is shaped like a diamond .",
    "asymptotically , the flner - optimal subset of @xmath362 which we find is shaped like a regular octagon ( stop sign ) . to guess the optimal shape",
    ", we simply look at successive ratios as layers are removed at the corners : right , left , top , and bottom .",
    "our first task is to determine when one of these edge layers is in fact a peeling .",
    "( recall section  [ sec : peelings ] . )",
    "the theorems that follow will imply that , in these special cases , we need only compare a single fraction @xmath364 with the  ratio of the set before the deletion .    *",
    "setting : * we consider the cayley graph @xmath8 of @xmath365 with standard generators and initial condition @xmath366 .",
    "we consider @xmath367 finite , @xmath53 a subset of the lower open half - plane and containing @xmath368 \\times \\{-1\\})\\cap \\z^2 $ ] for some positive integer @xmath369 .",
    "we consider @xmath370 \\times \\{0\\})\\cap \\z^2 $ ] .",
    "we ask whether @xmath320 is a peeling for @xmath371 .",
    "we return to @xmath342 as in section  [ sec : peelings ] .",
    "of course , the search for a peeling @xmath320 begins not with @xmath53 but with @xmath381 .",
    "we shall show later that this necessary inequality is equivalent to the inequality with @xmath382 replacing @xmath361 so that , as @xmath320 changes , we need not calculate the  ratio of the new @xmath53 but can instead retain the previously calculated old ratio @xmath382 .        without changing @xmath325 and @xmath383 , we may permute the elements of @xmath320 in such a way that all elements of @xmath384 appear consecutively beginning at @xmath385 . this can only decrease @xmath327 and thereby increase the fraction being maximized .",
    "if @xmath386 , then we may assume that @xmath387 , for the insertion of @xmath388 into @xmath328 will increase @xmath325 by @xmath48 , will decrease @xmath327 by @xmath48 , and will leave @xmath383 unchanged .",
    "if @xmath387 but @xmath389 , then we may assume such points appear just after the pairs described in the paragraphs above .",
    "beginning with the left - most exemplar , we insert @xmath390 into @xmath328 .",
    "this increases @xmath391 by @xmath48 and leaves @xmath325 unchanged . because @xmath375 , it also leaves @xmath327 unchanged .",
    "if some @xmath392 does not appear in @xmath328 , then beginning with the leftmost such @xmath393 , we insert both @xmath390 and @xmath388 .",
    "this increases @xmath391 by @xmath48 , @xmath325 by @xmath48 , and @xmath327 by @xmath48 .",
    "we proceed to the improvement that allows us to substitute @xmath382 for @xmath361 .",
    "let @xmath221 be a nonnegative integer , and let @xmath394 .",
    "we let @xmath395 denote the set remaining after the first @xmath396 horizontal layers are removed from @xmath362 both from top and bottom and the first @xmath396 vertical layers are removed from @xmath362 from both the left and right .",
    "the set @xmath395 is an octagon until @xmath396 reaches @xmath397 , at which point @xmath395 becomes a square .",
    "the set @xmath402 is gotten from @xmath395 by removing four layers from @xmath395 .",
    "removing one layer removes @xmath403 vertices and decreases the number of boundary edges by 2 .",
    "so @xmath395 has @xmath404 more elements than @xmath402 and @xmath405 more boundary edges .",
    "hence if @xmath406 then @xmath407 a bit of algebra now yields that @xmath408 this proves theorem  [ thm : lattice3 ] .",
    "[ thm : lattice4 ] let @xmath409 be the smallest integer greater than @xmath410 then @xmath411 and @xmath412 increases monotonically on the interval @xmath413 and decreases monotonically on the interval @xmath414 .",
    "it is an easy matter to calculate @xmath412 : @xmath415 thus @xmath416 if and only if @xmath417 if and only if @xmath418 set @xmath419 . the smaller root of @xmath420 is @xmath421 since the larger root of @xmath420 is positive and @xmath422 , it follows that @xmath423 .",
    "one verifies that @xmath424 .",
    "if @xmath221 is odd , then this implies that @xmath425 and if @xmath221 is even , then @xmath426 .",
    "thus @xmath411 .",
    "moreover , from the last display we conclude that @xmath427 for @xmath428 and @xmath429 for @xmath414 .",
    "( note that since every term in @xmath420 is even except the last , @xmath420 has no integer roots . )",
    "therefore the desired result follows from theorem  [ thm : lattice3 ] .",
    "theorem  [ thm : lattice4 ] implies that @xmath412 increases monotonically on the interval @xmath432 .",
    "this and theorem  [ thm : lattice3 ] imply that @xmath433 if @xmath434 .",
    "let @xmath435 . because @xmath436 , it follows that the graph @xmath322 is the disjoint union of four graphs , one for each of the four layers in @xmath320 .",
    "theorem  [ thm : lattice1 ] applies to each of these four layers , and we see that its conclusion holds even for @xmath320 . as in corollary",
    "[ cor : lattice2 ] , it follows that @xmath320 is a peeling for @xmath395 if and only if @xmath437 , where @xmath438 .",
    "this completes the proof of theorem  [ thm : lattice5 ] .",
    "the set is clearly an octagon with two horizontal sides of lengths approximately @xmath440 , two vertical sides of lengths approximately @xmath440 , and four diagonal sides at angles of forty - five degrees from the axes , each having ( as yet unknown ) approximate length @xmath441 .",
    "we want to show that @xmath442 .",
    "each diagonal side is the hypotenuse of an isosceles right triangle whose legs are approximately of length @xmath443 .",
    "we calculate : @xmath444 thus , @xmath445we conclude that the octagon is almost regular for large values of @xmath221 .",
    "[ thm : lattice7 ] let @xmath409 be the smallest integer greater than @xmath410 then @xmath439 is a flner - optimal subset of @xmath362 .",
    "that is , the  ratio of @xmath439 is the maximal  ratio of subsets of @xmath362 .",
    "every optimal cooling function on @xmath439 can be extended to a cooling function on @xmath362 without increasing the cooling norm .                for both step  ( 1 ) and step  ( 2 ) of the proof",
    ", we will manipulate what we call _ difference diagrams_. for the first time in this paper we will make use of the fact that we are considering the cayley graph @xmath5 of an infinite group @xmath0 with finite , torsion - free generating set @xmath6 . if @xmath4 is a finite subset of the set of vertices @xmath0 of @xmath8 , and if @xmath450 is a cooling function , then we associate with @xmath108 a _ difference diagram _ @xmath451 as follows : @xmath452 @xmath453 that is , @xmath454 gives the net heat loss at @xmath24 along the orbit of @xmath0 defined by the group generator @xmath25 .",
    "the difference diagram is a refinement of the heat loss function at a vertex that we used in previous sections .",
    "we call @xmath451 a diagram since its values can be recorded at the vertices of the graph @xmath8 in a pictorial diagram . in order to make the relationship completely clear with the heat loss function @xmath23 defined earlier , we note that @xmath455 we need only this simple difference diagram in carrying out step  ( 1 ) of the proof .",
    "however , in step  ( 2 ) we shall consider the difference between difference diagrams defined on two different sets , one containing the other . in order to do this",
    ", we shall have to extend by @xmath112 the difference diagram on the smaller set so that the two difference diagrams have the same domain of definition .",
    "this new difference will be called a _ diagram of second differences_.          in general , since every generator @xmath457 has infinite order and the set @xmath4 is finite , every @xmath25-orbit determines edges @xmath458 , with the initial vertex @xmath459 of @xmath460 and the terminal vertex @xmath461 of @xmath462 lying in the complement of @xmath4 , all other vertices lying in @xmath4 and @xmath463 for @xmath464 .",
    "the edge @xmath460 is a boundary edge so that @xmath465 is given .",
    "inductively , @xmath466 .    in the self - optimal case",
    ", it is important to realize that heat loss is always outwards at the boundary .",
    "this means that in the previous paragraph , the first value @xmath467 must be thought of as a negative number and the terminal value @xmath468 as a positive value , with intermediate values @xmath469 increasing , not necessarily monotonically , from the one value to the other .",
    "it is important that in its possibly oscillatory traverse from the negative value to the positive value , the values @xmath469 never stray from the interval @xmath470 $ ] . in terms of the difference diagram",
    ", this means that the partial sums along initial segments of the orbit remain in the interval @xmath471 $ ] , with the total sum equalling @xmath472 .    in the simplest cases , along each orbit",
    "the difference diagram exhibits a _ partition _ of @xmath471 $ ] ; that is , the values of @xmath451 are positive and sum to @xmath472 .",
    "however , a partition does not always suffice .",
    "when finding a flner - optimal subset of @xmath362 , we shall often have to employ an oscillatory traverse along certain orbits with @xmath451 exhibiting both positive and negative values . the first case where this seems to be necessary",
    "is @xmath473 .",
    "suppose @xmath218 denotes the @xmath447-rectangle @xmath368\\times[1,n])\\cap \\z^2 $ ] .",
    "then @xmath475 we express our cooling function in terms of the unit @xmath476 so that our difference diagram can have integral entries .",
    "boundary values are thus given ( in terms of the prescribed units ) by @xmath477 and the difference diagram must have initial partial sums that traverse from @xmath112 to @xmath478 , never leaving the interval @xmath479 $ ] .",
    "the negative sign is used near initial points of orbits , the positive sign near terminal points of orbits .",
    "a difference diagram is given by the function @xmath480since @xmath481 , each vertex is cooled by exactly @xmath482 fractional units , hence by exactly @xmath48 real unit .",
    "along @xmath393-orbits and @xmath183-orbits , the difference diagram partitions @xmath478 .",
    "hence , the cooling norm is @xmath483 .",
    "since the @xmath447-square @xmath446 is self - optimal by the previous theorem , it is clearly enough to prove that , if @xmath485 and @xmath402 is self - optimal , then @xmath395 is also self - optimal .",
    "let @xmath396 be an integer in the interval @xmath486 $ ] .",
    "we introduce @xmath487 , for @xmath488 , as the set formed from @xmath402 by adding @xmath489 of the layers of @xmath395 not in @xmath402 .",
    "we let @xmath490 .",
    "it suffices to show that , if @xmath487 is self - optimal , then @xmath491 is self - optimal , for @xmath492 .",
    "we shall need the inequalities given in the following lemma .      to prove the second inequality ,",
    "suppose that @xmath495 , as in the proof of theorem  [ thm : lattice3 ] . because @xmath496 , theorems  [ thm : lattice3 ] and [ thm : lattice4 ] combine to imply that @xmath497 .",
    "hence @xmath498 this proves the second inequality .",
    "we prove the first inequality first for the case @xmath499 , where @xmath500 . the inequality is then equivalent to the inequality @xmath501 substituting known values for @xmath502 and @xmath503 , as in the proof of theorem  [ thm : lattice4 ] , we seek to prove that @xmath504 this reduces to @xmath505 equivalently , @xmath506 since @xmath507 , the proof is complete for @xmath499 .      assuming inductively that @xmath487 is self - optimal , we let @xmath451 denote the difference diagram of some optimal cooling function for @xmath487 .",
    "we employ @xmath510 as unit and assume inductively that we can choose the entries of @xmath451 to be integers .",
    "we extend this difference diagram by @xmath112 to the larger set @xmath511 .",
    "we seek a difference diagram @xmath512 , expressed in units @xmath513 , that will exhibit @xmath491 as self - optimal and ask ourselves the properties that must be satisfied by the second difference @xmath514 .",
    "even though the two diagrams are expressed in different units , each will have integer entries , and we express @xmath515 as the integer difference of those entries . in other words",
    ", we manipulate the number of heat loss _ units _ required and compare the number of units in the two diagrams .",
    "\\(1 ) row @xmath256 is assigned @xmath523 tokens .",
    "this new row @xmath256 had no heat loss at all assigned by the cooling function for @xmath487 ; hence the difference function @xmath515 must account for the total difference @xmath523 required along every orbit .",
    "all other rows and columns are assigned only @xmath509 tokens .",
    "this requirement reflects the fact that the old rows and columns require exactly @xmath524 more heat loss units than assigned to that row or column by the cooling function for @xmath487 .",
    "\\(2 ) after distribution , each cell of @xmath256 is to have @xmath525 tokens . at these vertices of the new orbit @xmath256 , the total heat loss recorded by @xmath515",
    "must be @xmath525 since there was no heat loss there with the cooling function for @xmath487 .",
    "all other cells are to have @xmath526 tokens .",
    "this requirement reflects the fact that the old vertices require only @xmath527 more heat loss units than assigned to them by the cooling function for @xmath487 .    * heat - loss token distribution in the new row @xmath256 : * dividing , we find @xmath528where the quotient @xmath529 and the remainder @xmath530 are integers and @xmath531 . that @xmath532 follows from the second inequality of lemma  [ lemma : lattice12 ] with @xmath533 .",
    "that @xmath534 follows from the first inequality of lemma  [ lemma : lattice12 ] with @xmath533 .",
    "thus we may place @xmath529 of the tokens assigned to the row @xmath256 into each cell of @xmath256 , with one extra in each of the first @xmath530 cells .",
    "we may then place either @xmath535 ( or @xmath536 , as appropriate ) column tokens into the cells of @xmath256 so that the total number of tokens in each cell is @xmath525 , as required .",
    "* distribution of the heat - loss tokens associated with the side columns : * in side column @xmath537 , place @xmath526 of the tokens assigned to @xmath537 into each of the bottom @xmath403 cells of @xmath537 .",
    "* the critical region : * almost always there will be cells of the side columns which still contain no heat loss tokens .",
    "these cells will form two triangular regions .",
    "these two triangular regions together with the portions of the central columns at the same height form what we call the _ critical region_. see figure  [ fig : region ] .      * distribution in the central columns beneath the critical region : * consider a row @xmath538 that lies beneath the critical region .",
    "the cells in that row which have not yet been filled with two heat loss tokens are precisely those in the central columns .",
    "place @xmath526 of the heat loss tokens assigned to @xmath538 into each of those cells .",
    "this will use up all of the @xmath509 heat loss tokens assigned to that row .    *",
    "distribution of heat - loss tokens in the critical region : * fill that portion of the triangular regions in row @xmath538 with 2 tokens assigned to @xmath538 in each cell . for large @xmath221 ,",
    "the number of tokens needed for this distribution exceeds the number , @xmath509 , of tokens assigned to @xmath538 .",
    "for each extra token needed , we create a new heat loss token and a compensating _ negative _ heat loss token .",
    "these negative heat loss tokens will be distributed in the intersection of the row @xmath538 with the central columns .    in this paragraph",
    "we verify that the partial sums for @xmath515 along initial segments of @xmath538 stay in the range @xmath539 $ ] .",
    "it will then follow that the partial sums along initial segments of @xmath538 for the associated cooling function stay in the range @xmath540 $ ] .",
    "the number of side columns left of the central columns which intersect @xmath538 in the critical region is at most @xmath541 . in order for the partial sums for @xmath515 along initial segments of @xmath538 to be at most @xmath542 , we need @xmath543",
    "this is equivalent to @xmath544 . as in the proof of theorem  [ thm : lattice4 ] , we let @xmath419 , and we verify that @xmath545 and @xmath546    since @xmath396 is between the smaller root of @xmath420 and @xmath221 , it follows that @xmath544 .",
    "this verifies that our partial sums are at most @xmath542 .",
    "symmetry shows that they are nonnegative .",
    "thus the partial sums for @xmath515 along initial segments of @xmath538 stay in the range @xmath539 $ ] .",
    "we put all of the remaining column tokens in a single pot .",
    "we know exactly how many row tokens remain to be placed in each row , and in each row either every remaining token is positive or every remaining token is negative .",
    "this tells us exactly how many column tokens need to be placed in each row .",
    "we assign that number of column tokens to each row .",
    "three paragraphs below we show that the pot contains exactly the correct number of tokens to do this .",
    "we distribute the column tokens assigned to row @xmath517 as follows .",
    "we place the first column token assigned to row @xmath517 in column @xmath519 , the second in column @xmath547 , the third in column @xmath548 , and so on , continuing to column @xmath519 if necessary , until the column tokens assigned to @xmath517 have been exhausted .",
    "augment row and column numbers by 1 from where the last column token was inserted .",
    "place the column tokens assigned to that row in successive columns .",
    "when we are done , every column will contain the same number , @xmath403 , of column tokens .",
    "then we distribute the remaining row tokens so that the total value of the tokens in each of these cells is 2 .",
    "now we show that the pot contains the correct number of tokens .",
    "suppose that all of the tokens are distributed , possibly leaving some of these cells without the required two tokens .",
    "after distributing all of the tokens , the heat loss along every row and column is @xmath549 units .",
    "there are @xmath550 rows and columns , so the total number of units is @xmath551 .",
    "since there are @xmath552 cells , the average number of units per cell is @xmath525 .",
    "it follows that every cell has received the needed number of tokens .",
    "similarly , if every cell has received the needed number of tokens , then the average heat loss along every row and column is @xmath553 units .",
    "this means that no tokens remain .",
    "the construction is then complete .",
    "it remains only to note that the column distributions are partitions ( no negative values for @xmath515 ) . although the row sums oscillate because of the negative tokens , again the norm stays in the desired bounds .",
    "hence the associated cooling function has the correct norm ."
  ],
  "abstract_text": [
    "<S> erling  proved that the amenability or nonamenability of a countable group @xmath0 depends on the complexity of its finite subsets @xmath1 . </S>",
    "<S> complexity has three measures : maximum  ratio , optimal cooling function , and minimum cooling norm .    </S>",
    "<S> our first aim is to show that , for a fixed finite subset @xmath2 , these three measures are tightly bound to one another . </S>",
    "<S> we then explore their algorithmic calculation .    </S>",
    "<S> our intent is to provide a theoretical background for algorithmically exploring the amenability and nonamenability of discrete groups . </S>"
  ]
}