{
  "article_text": [
    "quantum key distribution ( qkd ) as the main part of quantum cryptography is known to provide information - theoretic ( or unconditional ) security of key distribution .",
    "however , qkd protocols like bb84 assume the employ of single - photon sources @xcite .",
    "in contrast , real - life implementations of qkd setups are based on attenuated laser pulses instead of true single photons  @xcite .",
    "this realization makes qkd vulnerable to various attacks , such as the photon number splitting attack  @xcite .",
    "a well - known tool for solving this problem is the decoy - state method , which can be considered as a standard technique used in many qkd realizations  @xcite .",
    "the decoy - state method uses laser pulses with different intensities .",
    "the intensities are chosen form a certain finite set .",
    "the choices for the pulses are kept in secret by the legitimate sender ( alice ) , but are publicly announced after the reception of all pulses by the legitimate receiver ( bob ) . by analyzing ( i ) statistics of reception for pulses with different intensities and ( ii ) error rates for different intensities , one can estimate the fraction of single - photon pulses and the error rate for single - photon pulses .",
    "in particular , this allows detecting the photon number splitting attack  @xcite .",
    "an important task in the framework of decoy state qkd is to take into account statistical fluctuations ( so called `` finite - key effects '' ) .",
    "several methods are proposed in the literature , including those based on the central limit theorem  @xcite , chernoff  hoefding method  @xcite , and improved chernoff  hoefding method @xcite .    in the present work ,",
    "we propose and analyze an option for processing decoy - state statistics based on the central limit theorem .",
    "namely , we derive expressions for statistical estimations of the fraction of positions ( bits ) in the verified key obtained from single - photon pulses and the error rate in such positions .",
    "they are further used in calculations of the length of the secret ( final ) key with a given tolerable failure probability .",
    "we also provide the results of numerical simulations , which show that these estimations are quite tight .",
    "it should be mentioned that the methods based on the central limit theorem are criticized as not sufficiently rigorous  @xcite .",
    "we estimate the deviations from the gaussian distribution in a rigorous way using the results of ref .  @xcite .",
    "another important practical issue that we discuss is the accurate inclusion of the failure probability of the decoy states statistical estimates into the formula for the total failure probability .",
    "we note that our analysis uses the decoy - state qkd protocol , which is described in ref .",
    "@xcite .",
    "our work is organized as follows . in sec .",
    "[ sec : ppp ] , we describe the basics of the qkd post - processing procedure . in sec .",
    "[ sec : processing ] , we present the suggested method for processing of decoy - state statistics based on the central limit theorem . in sec .  [",
    "sec : simulation ] , we use numerical simulations in order to compare the obtained estimations with theoretical limits of the decoy - state qkd protocol . in sec .",
    "[ sec : deviations ] , we estimate the deviations of the random variables used in our processing procedure from the gaussian distribution . we summarize the main results in sec .  [",
    "sec : conclusion ] .",
    "the operating qkd protocol can be divided into several stages . on the first quantum stage of a qkd protocol",
    ", alice sends quantum states to bob , who measures them .",
    "after the quantum stage alice and bob have two binary strings  so called _ raw keys_. the second state is the use of post - processing procedures .",
    "let us recall the basic stages of post processing the raw keys for the bb84 qkd protocol ( for details , see refs .",
    "@xcite ) :    a.   _ sifting _ : alice and bob announce the bases they use for the preparation and measurement of quantum states and drop the positions with inconsistent bases from the raw keys .",
    "the resulting keys are called the _ sifted keys_. the decoy states statistics is announced on this stage as well . b.   _ information reconciliation _ , also known as _ error correction _ : the removing discrepancies between alice s and bob s sifted keys via communication over the authenticated channel ( for the last issues concerning the adaptation of error - correcting codes for qkd , see ref .",
    "@xcite ) . often this stage is completed by a verification procedure : one legitimate side send a hash - tag of his or her key to the other side to ensure the coincidence of their keys after the error correction .",
    "the blocks of the sifted keys which fail the verification test are discarded at this state .",
    "the resulting common key is called the _ verified key_. c.   _ parameter estimation _ : the estimation of the quantum bit error rate ( qber ) in the sifted keys .",
    "also , processing the decoy states statistics is performed on this stage .",
    "d.   _ privacy amplification _ : the reduction of possible information of an eavesdropper ( eve ) about the keys to a negligible value .",
    "this is achieved by a special contraction of the verified key into a shorter key . for such contractions ,",
    "2-universal hash functions are used .",
    "this provides unconditional security against both classical and quantum eavesdroppers  @xcite .",
    "the resulting key is called the _ secret key _ or the _ final key_. it is the output of a qkd protocol .",
    "post - processing procedures require communication of alice and bob over a classical channel .",
    "this channel is not necessarily private ( eve is freely allowed to eavesdrop it ) , by it must be authentic , i.e. eve can neither change the messages sent via this channel nor send her own messages without being detected . to provide the authenticity of the classical channel , alice and",
    "bob uses message authentication codes .",
    "there are unconditionally secure message authentication codes  @xcite .",
    "[ rem : pe ] classically , parameter estimation stage precedes the information reconciliation  @xcite : the qber value is estimated by random sampling from the sifted keys ( of course , being publicly announced this sample is discarded from the sifted keys ) . in our scheme , following ref .",
    "@xcite , the qber value is determined after the information reconciliation and verification stage : clearly , the straightforward comparison of the keys before and after error correction procedure provides the exact number of corrected errors and corresponding qber value .",
    "this allows one to avoid discarding a part of sifted keys .",
    "this scheme was also used in the recently suggested symmetric blind information reconciliation method  @xcite .",
    "the results of the statistical analysis of decoy states are used in the privacy amplification stage to calculate the length of the final key ( contraction rate ) which provides the required degree of security . for the bb84 protocol ,",
    "the formula is as follows  @xcite : @xmath0-\\text{leak}_{\\text{ec}}+5\\log_2\\varepsilon_{\\rm pa},\\ ] ] where @xmath1 is the length of the verified key , @xmath2 amount of information ( number of bits ) about the sifted keys leaked to eve during the information reconciliation stage , @xmath3 is the binary entropy function , and @xmath4 is a tolerable failure probability for the privacy amplification stage . it can be interpreted as a probability that the privacy amplification stage has not destroyed all eve s information on the verified key and , so eve has partial non - negligible information on the final key .",
    "further , @xmath5 is a lower bound on the fraction of bits in the verified key obtained from single - photon pulses , and @xmath6 is an upper bound on the fraction of errors in such positions in the sifted keys .",
    "it is assumed that the bits of the verified keys obtained from multiphoton pulses are known to the eavesdropper .",
    "the quantity @xmath7 determines the potential knowledge of the bits obtained from single - photon pulses by the eavesdropper . this reflects the essence of qkd : it is impossible to get knowledge of the bits of the sifted key obtained from single - photon pulses without introducing errors in them .",
    "the estimation @xmath5 and @xmath6 is the purpose of the decoy statistics analysis , which is given in the next section and is the main subject of the present paper .",
    "the failure probability for these estimates ( the probability that at least one of these estimates is not true ) must be not greater than some value @xmath8 .    if @xmath9 given by eq .",
    "( [ eq : pa ] ) is positive , then the secret key distribution is possible .",
    "if @xmath10 is the time needed to generate a verified key with the length @xmath1 , then the secret key rate can be defined as follows : @xmath11    let us comment expression ( [ eq : pa ] ) .",
    "essentially , it is taken from ref .",
    "@xcite , where a rigorous proof of unconditional security of the bb84 protocol is given .",
    "strictly speaking , the proof was given for the case when the qber is estimated by random sampling from the sifted keys ( see remark  [ rem : pe ] ) .",
    "however , the scheme when the qber is estimated after the information reconciliation , simplifies the proof and formulas , since , in this case , the qber is estimated not probabilistically but deterministically . actually , we can replace the function @xmath12 in proposition  11 in ref .",
    "@xcite , by an arbitrary number @xmath13 , which is related to the failure probability of the privacy amplification as @xmath14 .",
    "the total failure probability of the qkd system is the sum of the failure probabilities of each component : verification , authentication , privacy amplification , and statistical estimations of @xmath5 and @xmath6 : @xmath15 here @xmath16 is the probability that verification hash tags of alice and bob coincide whereas their keys after the information reconciliation do not , and @xmath17 is the probability that message authentication codes do not detect eve s interference into the classical channel .",
    "the meaning of the total failure probability @xmath18 is as follows : the key generated by the qkd protocol is indistinguishable from the perfectly secure key in any possible context ( any possible application of this key ) with the exception probability at most @xmath18 ( see ref .",
    "@xcite ) .",
    "more precisely , @xmath18 is the trace distance between the actual joint classical - quantum state of alice , bob and eve and the ideal one , which corresponds to the case when alice and bob either have aborted the protocol or alice s and bob s keys coincide and are completely uncorrelated with eve s state .",
    "but @xmath18 as a failure probability : the real state coincides with ideal with the probability at least @xmath19 @xcite .",
    "the derivation of formula ( [ eq : eps ] ) is given in appendix .",
    "let us describe the estimations of @xmath5 and @xmath6 used in eq .",
    "( [ eq : pa ] ) . here",
    "we adopt a finite - key version of the decoy statistics analysis described in ref .",
    "namely , in each round alice sends to bob a fixed number @xmath20 pulses .",
    "each pulse has the `` signal intensity '' @xmath21 with the probability @xmath22 , or the `` decoy intensity '' @xmath23 with the probability @xmath24 , or the `` vacuum intensity '' @xmath25 with the probability @xmath26 .",
    "we note that the intensity of the `` vacuum state '' @xmath27 is close to zero , but not exactly zero due to the technical reasons . in our consideration",
    "we assume @xmath28 .",
    "in fact , the `` vacuum intensity '' is the second decoy intensity .",
    "it is required that @xmath29 and @xmath30 .",
    "signal pulses are used to establish the raw key ( and then the sifted , verified , and secret keys ) , whereas decoy pulses are used to estimate @xmath5 and @xmath6 .",
    "let @xmath31 , and @xmath32 be the numbers of signal , decoy , and vacuum pulses sent by alice ( generally , the do not coincide with @xmath33 , @xmath34 , and @xmath35 due to statistical fluctuations ) and @xmath36 be the numbers of the corresponding pulses registered by bob .",
    "further , let @xmath37 be the probability that bob registers a signal pulse , @xmath38 and @xmath39 be the corresponding probabilities for decoy and vacuum pulses , @xmath40 be the joint probability that a signal pulse contains a single photon and that it is registered .",
    "then @xmath41 is the probability that a bit in the sifted ( as well as verified ) key is obtained from a single - photon pulse .",
    "finally , let @xmath42 be the actual fraction of bits in the verified key obtained from single - photon pulses ( may differ from @xmath43 due to statistical fluctuations ) .",
    "in order to estimate @xmath42 from below , we should estimate @xmath43 from below . to do this",
    ", we shoud estimate @xmath40 from below and @xmath37 from above .    according to ref .",
    "@xcite , the lower bound for @xmath40 is as follows : @xmath44 , \\end{split}\\ ] ] where @xmath45 the estimates of @xmath46 and @xmath39 are given by : @xmath47 due to the central limit theorem , the distribution of the random variable @xmath48 is well approximated by the normal distribution with the mean @xmath49 and standard deviation @xmath50 . if we denote @xmath51 where @xmath52 is the quantile function for the standard normal distribution and @xmath53 is some constant to be specified , then @xmath54\\leq \\frac{\\varepsilon_{\\rm decoy}}a.\\ ] ] this gives lower and upper bounds on @xmath49 : @xmath55 each bound is satisfied with the probability not less than @xmath56 . we will need the upper bound on @xmath37 and two - sided bounds on @xmath38 and @xmath39 .",
    "these five bounds are simultaneously satisfied with the probability not less than @xmath56 .",
    "substitution of these bounds into eq .",
    "( [ eq : q1 ] ) yields : @xmath57\\equiv \\hat q_1^{\\rm",
    "l } , \\end{split}\\ ] ] where @xmath58 thus , we arrive at the following expression : @xmath59 with the probability not less than @xmath60 .",
    "the actual fraction @xmath42 is estimated from below as @xmath61 with the probability not less than @xmath56 , or , @xmath62 with the probability not less than @xmath63 .",
    "we have obtained one of two estimates participating in ( [ eq : pa ] ) .",
    "let us now find @xmath6 . according to ref .",
    "@xcite , we have @xmath64 here @xmath65 is the probability of an erroneous detection of a signal pulse conditioned on the fact that it was detected ( with or without error ) , @xmath66 is the actual qber ( may differ from @xmath65 due to statistical fluctuations ) , @xmath67 is the probability of incorrect detection of a single - photon pulse conditioned on the fact that it was detected , and @xmath68 is the actual fraction of errors in positions obtained from the single - photon pulses .",
    "since @xmath69 with the probability not less than @xmath56 , we arrive at the following expression : @xmath70 with the probability not less than @xmath71 .",
    "finally , @xmath72 with the probability not less than @xmath56 , or @xmath73 with the probability not less than @xmath74 .",
    "the second necessary estimate has been also obtained .",
    "since both estimates must be satisfied with the probability not less than @xmath75 , we set @xmath76 .",
    "we then consider realization of the described procedure on the realistic `` plug - and - play '' qkd setup  @xcite and compare the obtained results with theoretical limitations .",
    "the parameters of the qkd setup implementation are as follows : number of pulses in train @xmath77 , repetition rate of pulses in train 300 mhz , detectors efficiency 10% , detectors dead time 1  @xmath78 , dark count probability @xmath79 , additional losses on bob s side 5  db , fiber attenuation coefficient 0.2  db / km , and interference visibility 97% .",
    "the parameters of the post - processing procedure are as follows : @xmath80 the information leakage on the procedure of error correction and verification are : @xmath81 the length of processed block @xmath1 is limited by the value of 16  mbit or the length of sifted key accumulated after 30 min of the operation of the qkd setup .",
    "we use the differential evolution method for numerical optimization of signal and decoy intensities ( @xmath82 and @xmath83 ) together with their generation probabilities ( @xmath22 and @xmath24 ) .",
    "the `` vacuum intensity '' is fixed at the level @xmath28 , and its generation probability is given by @xmath26 .",
    "the results are presented in fig .",
    "[ fig : simulation ] and fig .",
    "[ fig : qber ] .",
    "we then compare the results given by our approach with the theoretic limit , where we neglect statistical fluctuations and assume that we know the exact values of @xmath42 and @xmath68 ( i.e. , there is no need in statistical estimates and decoy states , @xmath84 , @xmath85 ) . in the theoretical limit , the secret key rate given by the expression : @xmath86,\\ ] ] where @xmath87 is the sifted key rate .",
    "the quantities @xmath87 , @xmath42 , @xmath68 , and @xmath66 in eq .",
    "( [ eq : r_th ] ) depend on the intensity of signal pulses ( @xmath88 for the theoretical limit case ) .",
    "these quantities are obtained from the numerical optimization of the intensities for various communication distances .",
    "the results of the comparison of our approach and theoretical limit are presented in fig .",
    "[ fig : simulation ] . in fig .",
    "[ fig : simulation](a ) it is shown that the proposed approach rather closely approximates the theoretical limit on distances up to 100120 km .",
    "the optimal operating of post - processing procedures on such distances is important , in particular , for inter - city qkd for future quantum networks .",
    "we note that the sifted key rate in the theoretic limit is higher due to higher optimal signal intensity [ fig .",
    "[ fig : simulation](b ) ] and absence of decoy states .",
    "also note that the optimal fraction of decoy states in the proposed approach is relatively small and is about @xmath89 for distances less than 100 km [ see fig .",
    "[ fig : simulation](c ) ] .     and the length of verified key @xmath1 are shown as functions of the communication distance . in the inset the value of qber",
    "is shown as function of the communication distance . ]",
    "in the discussed approach the statistical fluctuations are treated in the framework of the central limit theorem , i.e. we assume that the binomially distributed random variables ( the fraction of positions obtained by single - photon pulses @xmath42 and the error rate in these positions @xmath68 ) are well approximated by the gaussian distribution .",
    "this approach is criticized as not sufficiently rigorous @xcite , in contrast to other approaches which are more rigorous but give slightly worse estimates .",
    "now we are going to estimate deviations from the gaussian distribution .",
    "consider a random variable @xmath90 which follows the binomial distribution with the number of experiments @xmath91 and the success probability in one experiment @xmath92 .",
    "we will denote this as @xmath93 . then according to ref .",
    "@xcite : @xmath94\\leq c_{n , p}(k+1),\\ ] ] where @xmath95 , @xmath96 , and @xmath97 for @xmath98 , @xmath99 @xmath100 and @xmath101 for @xmath102 and @xmath103 .",
    "it can be shown that the deviations from the gaussian distribution become significant for small @xmath91 and/or @xmath92 close to 0 or 1 .",
    "the random variables @xmath104 ( @xmath105 ) , @xmath106 , and @xmath107 from sec .",
    "[ sec : processing ] are binomially distributed , namely , @xmath108 , @xmath109 , @xmath110 .",
    "if the values of @xmath104 and @xmath42 are known and fixed , then @xmath111 and @xmath112 are also binomially distributed : @xmath113 , @xmath114 .",
    "the substitution of estimations obtained in formulas ( [ eq : qj ] ) , ( [ eq : k1 ] ) , ( [ eq : emu ] ) , ( [ eq : e1 ] ) to ( [ eq : zubkovserov ] ) ( with the corresponding parameters @xmath91 and @xmath92 ) gives more precise ( and rigorous ) value of the fail probability @xmath115 .",
    "for the parameters from our simulation , even for minimal @xmath91 ( when @xmath116 on the maximal length 160  km ) and minimal @xmath92",
    "( when @xmath117 for zero length ) and @xmath118 , we then obtain @xmath119 i.e. negligible with respect to @xmath8 .",
    "thus , for practical parameters one can use the proposed formulas .",
    "derivation of a general procedure for decoy state statistics processing based on rigorous formula ( [ eq : zubkovserov ] ) will be a subject for a subsequent work .",
    "we have presented a sort of the decoy state statistics processing .",
    "the final formulas are ( [ eq : k1 ] ) and ( [ eq : e1 ] ) , which give the statistical estimates used in the formula for the length of the final secret key ( [ eq : pa ] ) .",
    "also we claim that the failure probability @xmath8 for the decoy states statistical estimates should be treated as an additional term in the total failure probability @xmath18 in eq .",
    "( [ eq : eps ] ) .",
    "usually , one simply puts @xmath120 and not treat is as an additional term in the total failure probability . from the point of view of the rigorous theory ,",
    "this is not correct : formula ( [ eq : pa ] ) provides the failure probability at most @xmath4 only for true single - photon sources or , at least , when we can estimate @xmath5 and @xmath6 with certainty .",
    "if we can not estimate these quantities with certainty , the failure probability of the estimate should be included as an additional term in the the total failure probability of the qkd system .",
    "appendix is devoted to the rigorous derivation of eq .",
    "( [ eq : eps ] ) for the total failure probability .",
    "finally , we have shown that , for practical parameters , deviations of the binomially distributed random variables used in the decoy states statistics processing from the gaussian distribution can be neglected .",
    "the suggested option for the decoy - state processing is implemented in the proof - of - principle realization of the post - processing procedure for industrial qkd systems  @xcite , which is freely available under gnu general public license ( gpl )  @xcite .",
    "this procedure is used in the modular qkd setup described in ref .",
    "we are grateful to y.v .",
    "kurochkin , a.s .  sokolov , and a.v .",
    "miller for useful discussions . the work of a.t . and e.k . was supported by the grant of the president of the russian federation ( project mk-2815.2017.1 ) .",
    "this section is devoted to the derivation of formula ( [ eq : eps ] ) .",
    "according to the results of ref .",
    "@xcite : @xmath121 where @xmath122 and @xmath123 stand for correctness ( coincidence of alice s and bob s final keys ) and secrecy ( ignorance of eve about the final key ) respectively .",
    "namely , @xmath122 is the probability that alice s and bob s keys do not coincide , but the protocol was not aborted , and @xmath123 is the trace distance between the actual joint classical - quantum state of alice and eve and the ideal one . in our case , @xmath124 i.e. , the alice s and bob s final keys are coincide in case of coincidence of their verification hash tags and their authentication hash tags ( otherwise eve could interfere into the their communication and fake the verification tags ) .",
    "so , the failure probability for correctness is the sum of failure probabilities of the verification and authentication .",
    "further , in case of single - photon sources , @xmath125 ( see , ref .",
    "@xcite ) . in this case",
    "we can estimate @xmath5 and @xmath6 in eq .",
    "( [ eq : pa ] ) with certainty .",
    "if we can not estimate these quantities with certainty , the failure probability of the estimate should be included as an additional term in the total failure probability of the qkd system : @xmath126 a mathematical fact justifying expression eq .",
    "( [ eq : epsec ] ) is as follows .",
    "consider two classical - quantum states : @xmath127 where @xmath128 is a finite set , @xmath129 are probabilities .",
    "let , further , @xmath130 ( event ) , @xmath131 , @xmath132 , @xmath133 @xmath134 @xmath135 where @xmath136 is the trace distance ( for details , see refs .",
    "@xcite ) and @xmath137 .",
    "then @xmath138 where we have used that the trace distance does not exceed unity . in our case",
    "@xmath128 is the set of all pairs @xmath139 , @xmath140 is the subset corresponding to the event @xmath141 @xmath142 , @xmath143 , ( [ eq : dcond ] ) is the trace distance between the actual and the ideal final states of the protocol conditioned on the event that the statistical estimates of @xmath42 and @xmath68 are true , and , finally , ( [ eq : d ] ) is the total trace distance between the actual and the ideal final states of the protocol .    in ref .",
    "@xcite , another formula relating the failure probability and trace distance is used : if @xmath144 is the failure probability , then the trace distance between the actual and the ideal state is bounded from above by @xmath145 , instead of linear formulas ( [ eq : eps ] ) and ( [ eq : epsec ] ) . the reason is the difference between the techniques of security proofs . in ref .",
    "@xcite , entanglement - distillation technique was assumed .",
    "its final result is expressed in terms of fidelity @xmath146 between the actual joint state of alice , bob , and eve @xmath147 and the ideal one @xmath148 .",
    "if @xmath149 , then the trace distance is bounded by @xmath150 in contrast , proofs of refs .",
    "@xcite are information - theoretic and their results are direct bounds on the trace distance ( the leftover hash lemma is essentially the main ingredient yielding such bound )",
    ".    99 c.h .",
    "bennet and g. brassard , https://researcher.watson.ibm.com/researcher/files/us-bennetc/bb84highest.pdf[in _ proceedings of the ieee international conference on computers , systems and signal processing _",
    "bangalore , india ( ieee , new york , 1984 ) , p. 175",
    "] .",
    "n. walenta , a. burg , d. caselunghe , j. constantin , n. gisin , o. guinnard , r. houlmann , p. junod , b. korzh , n. kulesza , m. legr , c.c.w .",
    "lim , t. lunghi , l. monat , c. portmann , m. soucarros , p. trinkler , g. trolliet , f. vannel , and h. zbinden , http://dx.doi.org/10.1088/1367-2630/16/1/013047[new j. phys .",
    "* 16 * 013047 ( 2014 ) ] .",
    "r. renner , https://dx.doi.org/10.1142/s0219749908003256[int .",
    "j. quantum inform .",
    "* 6 * , 1 ( 2008 ) ] ; _ security of quantum key distribution _ , phd thesis , eth zurich ; https://arxiv.org/abs/quant-ph/0512258[arxiv:0512258 ( 2005 ) ] ."
  ],
  "abstract_text": [
    "<S> decoy - state quantum key distribution is a standard tool for long - distance quantum communications . </S>",
    "<S> an important issue in this field is the processing the decoy - state statistics taking into account statistical fluctuations ( or `` finite - key effects '' ) . in this work , </S>",
    "<S> we propose and analyse an option for decoy statistics processing , which is based on the central limit theorem . </S>",
    "<S> we discuss such practical issues as inclusion of the failure probability of the decoy states statistical estimates in the total failure probability of a qkd protocol and also taking into account the deviations of the binomially distributed random variables used in the estimations from the gaussian distribution . </S>",
    "<S> the results of numerical simulations show that the obtained estimations are quite tight . </S>",
    "<S> the proposed technique can be used as a part of post - processing procedures for industrial quantum key distribution systems . </S>"
  ]
}