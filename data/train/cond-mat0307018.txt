{
  "article_text": [
    "magnetization measurements related to the flux penetration and exit in type - ii superconductors have been a benchmark against which various models of the interaction between flux quanta and the underlying pinning structure are tested@xcite .",
    "the critical state theory@xcite provides a quite intuitive and mathematically simple framework for analyzing the above mentioned macroscopic experiments . in brief , one is just led to solve ampre s law in the form @xmath3 , with @xmath4 a material dependent parameter , the so - called critical current density .",
    "this becomes a trivial problem for idealized geometries ( circular cylinders and slabs in longitudinal applied field ) , but may be really tough when one tries to simulate real world problems .",
    "this includes to allow for arbitrary sample shapes , spatial inhomogeneities , and more general restrictions on the current density than the original critical state equation @xmath5 for one - dimensional systems .",
    "several numerical methods have been developed , which partially include the previous requirements , and may be classified in two groups .",
    "on the one side , some models deal with the full electromagnetic problem which arises when flux is changed within the superconductor , by means of a definite current - voltage law ( typically in the form @xmath6 , @xmath7 being a phenomenological exponent)@xcite .",
    "this kind of theory leads to diffusion equations for the electromagnetic fields , which have been solved by a number of techniques .",
    "they do never hold a true critical state , unless for the limit @xmath8 .",
    "on the other hand , the general critical state theories avoid using intermediate electric fields and just concentrate on the metastable states which can be generated by applying external magnetic field changes@xcite .",
    "the material properties are expressed in the form of the restriction for the current density vector @xmath0 , with @xmath2 some bounded set , as dictated by the physics of the problem . to be specific ,",
    "the system either allows dissipativeless current flow for @xmath1 within the region @xmath2 , or undergoes a transition to a very high dissipation regime ( infinite in the mathematical limit ) , which is instantly rejected when @xmath9 . as it has been discussed elsewhere @xcite , the selection of @xmath2",
    "is made on the basis of the physical interactions between vortices and the substrate pinning potential .",
    "thus , a restriction on @xmath1 locally perpendicular to the magnetic field ( @xmath10 ) relates to the pinning interaction of line vortices , and a restriction on the component of @xmath1 parallel to the magnetic field ( @xmath11 ) , comes from intervortex tilt interactions .",
    "also , material isotropy can be incorporated by choosing @xmath2 as a circle , or anisotropy , for instance , selecting @xmath2 in the form of an ellipse .",
    "notice that the one - dimensional critical state hypothesis is included as the particular case @xmath12 $ ] .",
    "the actual solution @xmath5 , which was brilliantly intuited by c. p. bean@xcite , arises from the variational interpretation of faraday s law as a rule of minimum magnetic field changes .    along the past years",
    ", minimum principle formulations for the magnetic behavior of superconductors have been exploited , allowing a simple interpretation of many experimentals facts@xcite .",
    "these include the analysis of crossed field and rotation field experiments , anisotropic responses and the influence of sample s geometry .",
    "it should be emphasized that generalized variational methods are not merely a substitute to differential equation statements of classical physical problems .",
    "additionally , they provide a method to generate laws which incorporate singularities , discontinuities or inequality constraints , which can be hardly dealt with by local differential statements .",
    "this is , for instance , the case of type - ii superconductors , which can be described by the limit @xmath8 in the power - law current - voltage characteristic ( multivalued function ) .",
    "such benefit was already treated in previous issues , where we basically discussed a number of physical observations related to the specific set @xmath2 in the theory . as for the sample s geometry ,",
    "only the slab geometry ( one independent variable ) was treated . in this paper",
    ", we exploit another advantage of the variational statement , i.e. : the ease to pose the problem for any geometry on the finite element discretization .",
    "this allows to simulate a variety of experimental observations related to the sample s topology .",
    "the article is organized as follows . in sec.[secvar ] we pose the physical problem of the critical state in two - dimensional geometry and give some general results for our variational statement . a numerical implementation based on the finite element discretization",
    "is presented in sec.[secnum ] .",
    "this is then applied to several case studies in sec.[seccase ] , i.e. : a cylinder with arbitrary cross section , a granular sample , and a sample with a point defect .",
    "further applications and possible extensions of the theory are discussed in sec.[secdiscuss ] .",
    "in first place , we will define the macroscopic fields involved in the critical state regime and their relation to measurable quantities .",
    "our work has been developed within the assumption that the sample s response is dominated by the so - called _ irreversible _ contribution .",
    "this means that the equilibrium response of the flux line lattice in the absence of pinning centers as well as any possible surface currents are neglected . for global magnetization measurements in which the integrated magnetic moment of the sample is measured ,",
    "this is a very good approximation within the region @xmath13 , unless for weak pinning specimens ( see ref.@xcite and references therein ) .",
    "then , the coarse - grained electrodynamics if formulated in terms of    * the _ flux density _ @xmath14 within the sample is the average of the microscopic field intensity @xmath15 , over a volume which encloses a big number of vortices . * the _ magnetic field _",
    "@xmath16 , in the absence of equilibrium magnetization , is linearly connected to @xmath17 by @xmath18 . *",
    "the averaged current density may be calculated from @xmath19 .",
    "finally , the connection to observable quantities is done by characterizing the external field sources and the sample s response .    * on neglecting finite size effects",
    ", the magnetic source ( @xmath20 ) enters as a boundary condition for the flux density at the surface of the sample .",
    "the tangential component is continuous @xmath21 .",
    "* then , the measured magnetic moment of the sample per unit volume is @xmath22 . here , the average concerns the whole volume of the superconductor .",
    "the magnetization of long specimens with arbitrary cross section was already treated by campbell & evetts@xcite .",
    "a number of general properties of the field penetration profiles were obtained on the basis of the critical state equation , which according to the upper guidelines may be expressed as @xmath23 however , this method is only valid for very simple geometries ( f.i . :",
    "elliptic and rectangular sections ) as , in other cases , the free boundary between the critical ( @xmath24 ) and subcritical ( @xmath25 ) regions is unknown , and at least , a reasonable guess is needed .",
    "this may become very tough as the boundary could even split , giving place to multiply connected topology .",
    "this is depicted in fig.[fig : freebound ] where two subcritical regions appear for the initial magnetization process of a cylinder with concavities in the cross section . in general",
    ", a free boundary problem will arise between regions either affected or not by flux changes in a definite manipulation .",
    "thus , the previous comment extends to the fully pentrated regime when the applied excitation is reversed .",
    "additionally , the underlying assumption @xmath26 is clearly insufficient for describing the full phenomenological scenario .",
    "this requires a more general constitutive law of the kind @xmath0@xcite .",
    "below , we describe the minimal model which accounts for all the aforementioned facts .",
    "free boundaries are no longer a shortcoming , as they will arise from the solution of our statement , which easily applies for any shape of the sample .",
    "special emphasis will be made on this fact through the application to samples with corners , voids , and granular properties .",
    "we proceed along the lines established in previous work@xcite . recall that faraday s law in time discretized form is equivalent to minimizing the spatially integrated magnetic field changes over successive time layers , and that the superconducting properties enter in the form of the restriction @xmath0 .",
    "consider an infinite cylinder of arbitrary cross section subjected to an applied magnetic field parallel to the axis . by virtue of the symmetry",
    ", the internal field will also be parallel to the axis and continuous across the surface , and the induced current density will flow along the basal plane ( xy in what follows ) .",
    "thus , the critical state problem may be formulated as the condition for evolutionary field penetration profiles : @xmath27 = \\int_{\\omega}\\ !",
    "| h_{\\rm n+1 } - h_{\\rm n } |^{2}\\quad { \\rm for } \\quad\\vec{u}\\in\\delta_{\\perp } \\ ; .\\ ] ] in this equation , the following notation is used :    * @xmath28 stands for the planar cross section region .",
    "* @xmath29 is the inner z component of the magnetic field at the time layer @xmath30 .",
    "* @xmath31 is the given previous profile .",
    "* @xmath32 is the control variable . in this problem @xmath33 ,",
    "i.e. : the current density is measured in units of @xmath4 .",
    "* @xmath34 is the control region ( restriction for @xmath32 , @xmath35 rotation of @xmath2 ) .",
    "in former research , we have solved eq.([eqnvarpri ] ) in terms of associated hamilton differential equations within the optimal control theory . as we restricted our attention to the slab geometry in parallel field , a system of ordinary differential equations with prescribed boundary conditions had to be solved . here",
    ", the situation is a bit more involved , as a partial differential equation problem arises .",
    "nevertheless , the same underlying ideas may be used .",
    "on using the formalism of classical mechanics , we define a hamiltonian density , containing the lagrangian density to be minimized and associated auxiliary momenta @xmath36 denoting by @xmath37 , @xmath38 and @xmath39 the optimal solution functions ( i.e. minimizing @xmath40 and satisfying the control system ) , the optimal control equations are @xmath41 @xmath42 and the algebraic condition of maximality @xmath43 it is apparent that this condition is satisfied for a control vector @xmath32 with maximum projection over the associated momentum @xmath44 .",
    "this is completely equivalent to the problems with one independent variable . within @xmath28 one",
    "has @xmath45 ( or 0 ) , with the physical counterpart @xmath24 ( or 0 ) . in general",
    ", one can still identify the critical state condition as @xmath46 with @xmath47 standing for the union of the boundary of the region @xmath34 and the zero point ( @xmath48 ) .    in the case of the slab geometry ,",
    "the main technical difficulty for solving the problem was the existence of a free ( unknown ) point dividing the region penetrated by flux changes and the region free of flux variations at a particular step . in the current case of interest ( more than one independent variable )",
    "the free boundary is either a curve ( 2d systems ) or even a surface ( 3d systems ) .",
    "even more , as shown above ( see fig.[fig : freebound ] ) , the free boundary is quite commonly defined by a collection of disconnected parts .",
    "nevertheless , as it was recognized by prigozhin@xcite , the use of variational statements offers the advantage of applying direct numerical minimization methods in which the distinction between both regions is unnecessary . in this paper",
    ", we will also make use of this benefit for our formulation .",
    "we will introduce an optimization method , which operates over the whole superconducting region and from which the free boundary automatically arises .",
    "however , some further comments on the hamiltonian formulation are convenient as they will provide the basis for the physical interpretation of our calculations .",
    "the boundary conditions to be satisfied by the canonical variables are a generalization of the case for one independent variable . on the one side , owing to the absence of demagnetizing effects @xmath49 is determined on the sample surface @xmath50 by continuity of the external applied field .    on the other hand , the free boundary surrounding the regions unaffected by flux variations ( @xmath51 ) is characterized , according to its undetermined position by @xmath52 notice , that the general situation @xmath53 is allowed .      in this paragraph",
    "we show that the momentum @xmath44 , which has been introduced in the optimal control formulation as a lagrange multiplier , has a clear physical interpretation .",
    "recall that , in the absence of flux cutting phenomena , the continuity equation for the magnetic field may be written as @xmath54 where @xmath55 stands for a magnetic field current density ( not to be mistaken for the electric current density ! ) . in simple words ,",
    "flux variations within a region of the sample are due to the entry or exit of flux lines across its boundary .",
    "now , comparing eq.([eq : continuity ] ) and eq.([eqnham2 ] ) we conclude @xmath56 with @xmath57 the time step in our discretized model .",
    "thus , solving for @xmath44 allows to obtain the trajectories followed by vortices ( _ flux channels _ hereafter ) in the magnetization process .",
    "recall that , isotropy provided , flux channels should be perpendicular to the sample s surface and finish at the free boundary @xmath58 , which surrounds the regions unaffected by flux variations .",
    "this point has been illustrated in fig.[fig : paths ] , where we display the integral lines for the vector @xmath44 in the magnetization process of a superconductor with arbitary cross section .",
    "dashed style has been used for the so - called _ d - lines_@xcite ( qualitative in our plot ) , which are never crossed by the incoming flux tubes .",
    "continuous contours are used for the boundary between critical and subcritical regions .",
    "more details on the actual calculations leading to this plot are given later in the text .",
    "in order to provide a wide application range of this work we describe a triangular finite element implementation of the numerical procedure for solving eq.([eqnvarpri ] ) .",
    "although rectangular meshes are simple and intuitive , triangulation simplifies to deal with any geometry for the region @xmath28 ( sample s cross section ) . from the practical point of view ,",
    "a big number of software facilities for the triangulation of any specified geometry can be found ( and downloaded from the web ) . on the other hand , the fundamental aspects of the method may be found in numerous textbooks on the use of finite element methods in electromagnetism ( see f.i.@xcite ) . here",
    ", we will just recall some notational aspects and a few relevant properties for our work .      as illustrated in fig.[fig",
    ": region ] , the 2 dimensional region @xmath28 will be _ meshed _ by a collection of triangles @xmath59 .",
    "a given triangle @xmath60 is defined by three nodes ( @xmath61 ) .",
    "the set of all nodes is called @xmath62 .    any physical property given by a function on @xmath28",
    "may be approximated in terms of the so - called _ nodal functions _",
    "@xmath63 , which are nothing but the _ barycentric coordinates _ of the point @xmath64@xcite , referred to the triangle @xmath65 to which this point belongs . on using the language of classical mechanics , ( @xmath66 )",
    "are the values of normalized masses ( thus , positive ) which one should place at the vertices of @xmath65 , in order to get the center of mass at @xmath64 .",
    "it is apparent that they provide an affine basis , in terms of which one can express the inner points of a given triangle @xmath67 @xmath68 standing for the coordinates of its vertices in some reference frame .",
    "the approximation of a function on the mesh is now apparent .",
    "for instance , the following expression may be used for the magnetic field at a given point @xmath69 trivially , @xmath70 is nothing but the value of @xmath71 at the node @xmath72 .",
    "eq.([expanh ] ) will be the starting point for obtaining a matrix version of our variational statement ( eq.([eqnvarpri ] ) ) .",
    "let us now review some relevant properties of the nodal functions . for a given triangle , with area @xmath73 one has @xmath74 where @xmath75 and so on , by cyclic permutation . from these expressions",
    "one can verify the very important property that the nodal functions form a _ partition of unity _",
    ", i.e. : @xmath76 based on all this , two fundamental results for our purposes immediately follow @xmath77 and @xmath78      in this paragraph , we show that our variational statement ( eq.([eqnvarpri ] ) ) may be transformed into a nonlinear quadratic optimization problem by using the nodal functions expansion of the field ( eq.([expanh ] ) ) and the above displayed properties of the basis .",
    "thus , for the isotropic case , in which the critical current restriction may be written @xmath79 , the magnetization problem consists of finding the set of mesh coordinates @xmath80 for each time layer , so as to    1.ex    above , we have used @xmath81 @xmath82 and @xmath83 for the subset of boundary nodes , where the magnetic field is determined by the boundary conditions .",
    "some remarks seem to be convenient before discussing the actual implementation of the numerical algorithm stated above .",
    "firstly , we want to emphasize that the method is flexible enough so as to incorporate any critical current restriction .",
    "thus , anisotropy may be modelled by redefinition of the gradient matrix as @xmath84 with @xmath85 the critical current anisotropy constant ( in this case @xmath86 ) .",
    "spatial inhomogeneities in @xmath4 may be dealt with , just by using a _ triangle dependent _ scaling factor in @xmath87 .",
    "finally , field dependent critical currents would be introduced multiplying @xmath87 by some definite function of @xmath71 at the triangle midpoint ( barycenter ) .    from the practical point of view , one will be typically facing a _ large nonlinear and nonlinearly constrained _ optimization problem . here ,",
    "by large it is meant that the number of variables , as well as the number of restrictions could be of several thousands .",
    "computationally , this seems quite a formidable task for a small machine .",
    "fortunately , this kind of problem has been met in the modelling of many physical and scientific phenomena ( both nature and society tend to optimize and seldom behave as linear systems ) , and one can find very efficient software solutions , even for a personal computer .",
    "next , we describe the actual implementation of the previous algorithm which we have adopted for the simulations of several physical problems in this work .",
    "it is based on the computing language matlab@xcite and on the fortran package lancelot@xcite for nonlinear optimization problems .",
    "we have found that this combination provides a rather convenient environment , as one can easily handle the finite element mesh and transfer the data structures from one program to the other .",
    "the selection of the package lancelot as opposed to the straightforward use of the matlab optimization facilities , relates to the higher efficiency of the calculation .",
    "our program is organized according to the following steps .",
    "* definition of the geometry of the region @xmath28 .",
    "* calculation of the finite element triangular mesh on @xmath28 .",
    "* evaluation of the matrix elements @xmath88 and @xmath89 for the actual mesh . * set up of the standard input file for lancelot on the basis of the previous field profile @xmath90 and the matrix elements calculated in ( iii ) * solution of the optimization problem : get the new profile @xmath91 .",
    "* update field profile and iterate from ( iv ) .",
    "it mus be emphasized that the previous process is performed over the full mesh ( i.e. : for unknowns @xmath92 and under the constraints @xmath93 ) . the definition of regions with or without flux variation ( @xmath94 or @xmath95 ) , the boundaries between them ( @xmath58 ) , and the critical or subcritical character ( @xmath96 or @xmath97 ) arise from the optimization process itself . that is to say ,",
    "the totality of mesh points are considered for each iteration , and the optimality process determines where to introduce changes or not .",
    "this mathematical simulation is just a replica of the physical laws ruling out the behavior of the superconductor .",
    "local changes are such that global field variations keep minimum , while also fulfilling the minimum global entropy production rate ( infinite dissipation if @xmath98 ) , and the externally imposed boundary conditions .",
    "a rich phenomenology arises in the magnetic field penetration pattern when one considers the influence of the sample s cross section topology . in this part",
    "we report on how to understand the concept of critical state for arbitrarily shaped samples .",
    "first , we consider the influence of the sample s boundary for the so - defined _ uniform superconductors _ ( the current density restriction is homogeneous in space ) .",
    "secondly , we will concentrate on _ nonuniform superconductors _",
    ", i.e. : the limitations on the current density may change within the sample .",
    "the main property which can be assessed by application of our optimization technique is that , regardless the shape of the cross section , the flux front penetrates through equally spaced contours , which also represent the permanent current streamlines .",
    "such a structure is a straightforward consequence of eq.([eq : cece ] ) , as the model implies a constant gradient , and it has been illustrated in fig.[fig : current ] .",
    "two regions are defined by the clockwise or anti - clockwise circulation of the current , as corresponds to a magnetic history in which the applied field has been increased and then decreased .",
    "notice the boundary line in between .",
    "magnetic hysteresis has also been simulated , and one can observe the standard _ rayleigh - like _ diamagnetic loop already predicted by c.p .",
    "bean for constant @xmath99 in infinite slabs or circular cylinders .",
    "in fact , the flux penetration and exit that takes place along the process ( see fig.[fig : hysteresis ] and fig.[fig : mh ] ) are nothing but the generalization of the behavior for ideal geometries .",
    "the external drive pulls up and down across the boundary , while maximum gradient profiles are defined within the sample .",
    "the interface ( free boundary ) between active and passive regions ( as regards flux changes ) always corresponds to a line of constant distance to the sample s perimeter .    .",
    "]      a number of outstanding effects related to the penetration of magnetic flux in superconductors with corners have been reproduced within the framework of our model .",
    "we will concentrate on the field profiles for the cross section displayed in figs.[fig : freebound ] and [ fig : paths ] .",
    "this example simultaneously holds concave and convex corners , and this enables to visualize several pecularities for non ideal geometries .",
    "fig.[fig : gamma ] shows a sequence of increasing field penetration profiles .",
    "ten contours are plotted , starting with the applied field at the surface .",
    "notice that , as expected , equally spaced curves are obtained",
    ". however , the particular shape of the outer perimeter leads to a splitting process , which takes place as soon as the _ nearest _ points of the penetrating boundaries contact each other .",
    "further profiles are characterized by a disconnected structure in which the free boundary between flux penetrated and flux free regions is the union of disjoint curves ( @xmath100 ) .",
    "another group of properties is related to the corners themselves . for the case of convex corners ,",
    "we have observed the formation of the so - called _ d - lines_@xcite as the locus of points where the current paths display sharp bends .",
    "such lines are intuited in fig.[fig : gamma ] , and have been outlined in fig.[fig : paths ] .",
    "notice that the flux channels do never cross such lines .",
    "geometrically , as vortices always move perpendicular to the current streamlines , they have to be stopped at the points where @xmath1 abruptly changes direction .    for concave corners , a quite different phenomenon is observed . as it was already reported for the case of rectangular geometry@xcite",
    ", concave corners become a source of magnetic flux in the critical state .",
    "this fact is apparent in our simulations .",
    "notice that flux channels display divergence at the concavities , because the flux which replenishes a finite region must be supplied from a single point .",
    "such behavior is of high importance because this point is a natural candidate for the triggering of magnetic instabilities .",
    "just recall that the induced electric field at any point may be identified with the amount of magnetic flux which has crossed the unit length measured along @xmath101 in the unit time .",
    "thus , @xmath101 would become infinite for an ideal corner and , in any case , large for a real one .",
    "as the amount of generated power per unit volume in the critical state is @xmath102 , heat removal would first fail at such points ( provided the sample is thermally homogeneous ) .      in this section",
    ", we present numerical simulations for samples displaying nonhomogeneous behavior of @xmath4 across the section . in principle ,",
    "any physically meaningful dependence @xmath103 could be dealt with . here",
    ", we concentrate on two specific cases : granular samples and samples with voids .      granularity has been a main fact in the development of superconductivity , mainly since the venue of the high temperature superconducting oxides .",
    "owing to their complex chemical structure , these materials have been widespread obtained in ceramic form , typically as a collection of superconducting grains embedded in a poorly superconducting matrix .",
    "their properties have been usually described at a mean field level , characterizing the matrix with some effective parameters@xcite . however",
    ", either analytical or semianalytical statistical theories have been developed under certain simplifying assumptions .",
    "here we emphasize that the magnetic behavior for any geometrical arrangement may be simulated with our numerical approach .",
    "the basic idea that magnetic flux is first screened from the whole volume of the sample by means of _ intergranular currents _ and further penetrates within a collection of basically disconnected grains is visualized .",
    "fig.[fig : granular ] depicts the successive field penetration profiles for a granular sample with rectangular cross section .",
    "a collection of cylindrical granules with elliptical cross sections has been used , assuming a constant critical current within them ( @xmath104 ) which is ten times larger than the intergranular limit ( @xmath105 ) . notice that , at first , a critical state characterized by @xmath106 is built for the intergranular region .",
    "the superconducting grains are _ connected _ in the sense that the field is excluded from the region in between .",
    "as soon as the intergranular shielding is not intense enough , a _",
    "double _ critical state is defined .",
    "the magnetic flux penetrates with constant slope @xmath106 for the intergranular region , and with the slope @xmath104 within the grains .",
    "we have simulated the field penetration profiles within a long superconductor of square cross section with a long cavity of circular shape along the axis , and close to one of the edges ( see fig.[fig : void ] ) .",
    "the structure of the current distribution of such a defect was already discussed by campbell & evetts@xcite and has been accurately reproduced by our optimization principle .",
    "two different simulation methods have been used , producing the same results for the magnetic field evolution .",
    "on the one side , one can describe the whole region as a nonhomogeneous superconductor , formed by a circular cylinder with zero critical current @xmath107 ( @xmath108 will be used for this region ) , embedded in a matrix with finite critical current @xmath109 ( @xmath110 will be used for this region ) .",
    "then , one has @xmath111 and the set of boundary nodes @xmath83 corresponds to the outer square perimeter @xmath112 .",
    "minimization is performed under the restrictions @xmath113 notice that equality constraints correspond to the absence of a pinning structure for the magnetic flux within the hole .",
    "on the other hand , one can also solve the problem by excluding the hole from the mesh .",
    "then , the boundary of the superconductor splits into an outer boundary @xmath112 ( square perimeter ) and an inner boundary @xmath114 ( circular perimeter ) .",
    "minimization is performed according to @xmath115 this means that the magnetic field along the outer boundary is determined by the value of the external excitation , and that it must be constant along the boundary of the hole .",
    "this last condition stems from the fact that the current must flow parallel to the surface of the hole . then @xmath116 is perpendicular to this surface , and thus @xmath117 .",
    "notice that this constant is _ a priori _ unknown and will be determined by the optimization process itself .    as a further technical detail , before discussing the physics of the problem",
    ", we would like to comment that the accuracy of the solution may be increased within a reasonable computational time , by a specific subdomain decomposition related to the structure of the solution itself .",
    "thus , in fig.[fig : void ] we display the actual decomposition of @xmath110 in four triangular subregions , according to the well known _",
    "d - line _ structure of the square cross section , in which sharp bends of the current lines appear along the diagonals . of course , the optimal solution itself should not depend on the specific meshing process , but a much larger number of triangles is required for other choices .",
    "let us now analyze the physical process of magnetizing such a sample .",
    "as it is apparent from fig.[fig : void ] , the magnetic field levels display a constant gradient within the sample . @xmath71",
    "linearly decreases from a constant value at the surface ( the applied field @xmath118 which equals @xmath119 for the n_th _ time step ) , displaying a characteristic _ plateau _ at the hole area",
    ". this plateau changes height along the process , as it is connected to the surface by a constant slope region .",
    "thus , the magnetic field within the sample is _ refresehed _ in the following way . at the beginning",
    ", flux penetrates along channels , which are perpendicular to the outer perimeter and finish at an equidistant square front .",
    "then , as soon as this front reaches the hole a new physical mechanism begins . this has been illustrated in fig.[fig : fluxlines ] by means of a vector plot of the field @xmath120 at a particular time step .",
    "recall that , according to the optimal control equations , the magnetic field current density @xmath55 is proportional to the vector @xmath121 ( see eq.[eq : continuity ] and aside ) .",
    "then , it is apparent that , while following the indicated paths , flux lines will preferentially penetrate along the highlighted channel .",
    "this channel carries all the flux which , on the one side replenishes the volume of the hole , and in addition _ diverges _ radially through its surface , penetrating again into the superconductor .",
    "we want to emphasize that , as remarked by other authors@xcite , the magnetic flux outcoming from the hole meets the channels coming from the outside boundary in a parabolic _ d - line_. this is a simple consequence of the constant critical current ansatz .",
    "discontinuity arises by sharp bending field contours , and this takes place at points equidistant to the center of the hole and to a line parallel to the horizontal edge of the sample .",
    "trivially , such points are the locus of the parabola @xmath122 , with @xmath123 standing for the vertical coordinate of the center of the circle , and @xmath124 for its radius ( the origin has been taken at the center of the square ) .",
    "notice the nice fit of this curve and the place where @xmath32 changes direction in our simulation .",
    ", proportional to the magnetic field current density @xmath125 ( see eq.[eq : continuity ] and aside ) .",
    "a collection of vortex lines is depicted within the void.,height=384 ]",
    "we have applied a direct numerical method for investigating several topological properties of the critical state in type - ii superconductors .",
    "the variational interpretation of faraday s law , constrained by the depinning threshold in the form of the rule @xmath0 for the current density , leads to a standard nonlinear optimization problem on the finite element discretization .",
    "this has been solved by using standard algorithms in the case of long cylinders with arbitrary cross section , and the isotropic case ( @xmath2 is a circle ) .",
    "essentially , the values of the magnetic field at the mesh points ( @xmath126 ) are treated as unknowns for each time layer and a minimizer for the global change @xmath127 is sought . as a result of this method",
    ", we obtain the free boundary between the regions ( un)affected by flux changes , and the circulating current density , which are outputs of the theory .",
    "the algorithm itself chooses whether @xmath128 is zero or not and reproduces the critical behavior @xmath129 .",
    "the high flexibility of the theory allows to simulate a number of physical phenomena as the influence of arbitrary corners in flux penetration , the splitting of free boundaries , spatial inhomogeneities in the critical current , and the calculation of critical state properties in multiply connected topologies ( samples with voids ) .",
    "the fundamental issue @xmath129 of our numerical studies for the 2d problem confirms the result : @xmath130 , which is a straightforward consequence of the optimal control formulation for the variational statement .",
    "this reflects a very general property ( @xmath131 ) , relating to the fact that the cost function does not explicitely depend on the control variables .",
    "in particular , it can be shown that the still challenging full 3d problem is also characterized by the condition @xmath129 .",
    "this is shown below .",
    "the 3d critical state problem may be posed as    1.ex    now , let us assume that the restriction set @xmath2 is convex ( this is not necessary , but simplifies the analysis ) .",
    "then , the optimal control solution @xmath132 verifies @xmath133 \\quad\\forall \\ ; \\vec{u}\\in\\delta,\\;\\ ; 0\\leq\\theta\\leq 1 \\ ; , % \\ ] ] and this leads to @xmath134\\geq 0 \\quad\\forall \\ ; \\vec{u}\\in\\delta\\ ; , \\ ] ] which one can identify as the condition that the _ directional derivative _ for allowed variations within @xmath2 is nonnegative around the minimum .",
    "if one introduces the actual functional of our problem , the following condition is met @xmath135 then , assuming that a vector field @xmath136 exists on @xmath137 such that @xmath138 , one has @xmath139\\geq 0 \\quad \\forall \\ ; \\vec{u}\\in\\delta \\;. % \\ ] ] on using vector formulas , and assuming that the magnetic field at large distances is determined by the external sources , the integral may be transformed to @xmath140 eventually , as any candidate control function should verify the external current restriction , we get @xmath141 in the case of pointwise controls ( the critical current at the point ( x , y , z ) does not depend on sample properties at others ) this is equivalent to@xcite @xmath142 that is to say , the _ maximum projection _ rule implies that the control lies on the boundary ( in the generalized sense , which admits the trivial solution @xmath143 if allowed by the boundary conditions ) .",
    "this ensures that the rule @xmath129 is valid for the general 3d problem within the isotropic case .    from the numerical side ,",
    "the solution of the 3d problem needs a more encompassing view point and more sophisticated ( though available ) mathematical tools . on the one side",
    ", the finite element mesh must be a tessellation by volumes of some shape .",
    "a tetrahedral mesh would seem a natural generalization .",
    "then , one can make use of tetrahedral nodal functions @xmath144 , which verify analogous properties to their 2d counterpart@xcite .",
    "in fact , a vectorial built ( the so - called _ whitney elements _ ) is typically used in computational electromagnetism as the right geometrical framework .",
    "for instance , the natural basis for the magnetic field ( @xmath145 ) is obtained from @xmath146 , where @xmath147 is used for the edge joining nodes @xmath72 and @xmath148 .",
    "finally , although the current density restriction operates on the finite region @xmath28 , one must minimize over the whole space @xmath137 .",
    "this process requires special techniques , such as the restriction to some artificial boundary , the use of adaptive meshing , with larger and larger elements for distant points , etc .",
    "further development of the theory is planned along this line .",
    "financial support from the research program of the university of zaragoza ( project no . 224 - 92 ) is acknowledged .      , _ critical currents in superconductors _",
    "( taylor & francis , london 1972 ) . , _ phys .",
    "lett . _ * 8 * , 250 ( 1962 ) ; _ rev",
    "phys . _ * 36 * , 31 ( 1964 ) .",
    "lett . _ * 71 * , 2821 ( 1993 ) ; _ phys .",
    "b _ * 49 * , 9024 ( 1994 ) ; * 50 * , 4034 ( 1994 ) ; * 52 * , 15442 ( 1995 ) ; * 54 * , 4246 ( 1996 ) ; * 58 * , 6506 , 6523 ( 1998 ) . ,",
    "_ phys . rev .",
    "b _ * 54 * , 3514 ( 1996 ) . , _ nonlinear diffusion of electromagnetic fields ( with applications to eddy currents and superconductivity ) _ , academic press electromagnetism series ( academic press , 1998 ) . , _ j. comput",
    "_ * 129 * , 190 ( 1996 ) ; * 144 * , 180 ( 1998 ) .",
    "lett . _ * 87 * , 127004 ( 2001 ) ; _ phys .",
    "b _ * 65 * , 104514 ( 2002 ) . , _ j. low temp",
    ". phys . _ * 130 * , 129 ( 2003 ) . ,",
    "_ j. appl .",
    "phys . _ * 92 * , 6110 ( 2002 ) . , _ physica c _ * 297 * , 153 ( 1998 ) . , _ computational electromagnetism : variational formulations , complementarity , edge elements _ , academic press electromagnetism series ( academic press , 1998 ) . , _ the finite element method in electromagnetics _ ( john wiley & sons , 2002 ) .",
    "( see http://www.mathworks.com ) .",
    ", _ lancelot : a fortran package for large - scale nonlinear optimization _ , sringer series in computational mathematics ( springer verlag , 1998 ) .",
    "b _ * 38 * , 11391 ( 1988 ) . , _ phys . rev .",
    "b _ * 49 * , 3443 ( 1994 ) . , _ optimal control of systems governed by partial differential equations _ ( springer verlag , 1971 ) ."
  ],
  "abstract_text": [
    "<S> the critical state problem in type - ii superconductivity is described theoretically by a direct optimization method , which allows a straightforward treatment for non idealized geometries .    based on faraday s law and the principle of minimum entropy production , </S>",
    "<S> the magnetic history is built up just by a constrained minimization of the field changes along the process . </S>",
    "<S> constraints are in the form @xmath0 , with @xmath1 the electric current density and @xmath2 some bounded set . </S>",
    "<S> this incorporates the vortex pinning and interaction phenomena and may be used for the modelling of anisotropy , inhomogeneities and flux cutting interactions .    in this work </S>",
    "<S> , our variational statement is posed on the finite element discretization and provides a minimal tool for investigating the effects of the sample s topology on the field penetration patterns . </S>",
    "<S> simulations of ( i ) the contraction and splitting of boundaries between the flux free and penetrated regions , ( ii ) the effect of granularity on the superconducting properties , ( iii ) the influence of defects , and ( iv ) surface curvature phenomena are presented . </S>"
  ]
}