{
  "article_text": [
    "given a multiset @xmath4 of @xmath5 positive integers , a word on @xmath4 is a sequence @xmath6 that reorders the elements in @xmath4 . when @xmath7:=\\{1,\\dots , n\\}$ ] the word is a permutation .",
    "a pair @xmath8 is called an _ inversion _ of @xmath9 if @xmath10 and @xmath11 .",
    "one well - known statistic on words and permutations is @xmath12 , defined as the number of inversions of @xmath9 .",
    "the _ descent set _ and _ descent statistic _ of a word @xmath9 are defined as @xmath13 in @xcite p.  macmahon defined the _ major index _",
    "statistic for a word @xmath9 as @xmath14 and showed the remarkable result that its distribution over all words on @xmath4 is equal to that of the inversion number over the same set .",
    "precisely , for the set @xmath15 of all words on @xmath4 , @xmath16 the proof of   given by macmahon relied on combinatorial analysis , while an elegant bijection @xmath17 such that @xmath18 was constructed later by foata  @xcite .    a _ set partition _ of @xmath19 $ ] is a family of nonempty sets @xmath20 which are pairwise disjoint and whose union is @xmath19 $ ] .",
    "if all the blocks @xmath21 have at most two elements , the set partition is called a _",
    "matching_. if the size of every block is exactly two , the matching is called a _",
    "perfect matching_. a set partition @xmath22 can be represented as a simple graph with vertex set @xmath19 $ ] drawn on a horizontal line , where two vertices are joined by an arc if and only if they represent consecutive elements in the same block of @xmath22 under the numerical order .",
    "two statistics , the numbers of crossings and nestings , arise naturally from such graphical representations , and have been the central topic in many recent research articles , e.g.,@xcite ,  @xcite ,  @xcite ,  @xcite ,  @xcite ,  @xcite ,  @xcite ,  @xcite , to list a few .",
    "a _ crossing _",
    ". _ nesting _ ) of a set partition is a pair of arcs @xmath23 , @xmath24 such that @xmath25 ( resp .",
    "@xmath26 ) .",
    "a crossing can be viewed as a generalization of an inversion on permutations .",
    "hence it is natural to ask what would be the major index for matchings ( set partitions ) that extends macmahon s equidistribution results .",
    "a definition of such a statistic , denoted by pmaj , was proposed by chen et al . in  @xcite . for completeness",
    ", we present the definition for perfect matchings here . the general case for set partitions",
    "is very similar .",
    "label the arcs of a perfect matching @xmath27 of @xmath28 $ ] by @xmath29 in decreasing order with respect to their left endpoints from left to right .",
    "suppose @xmath30 are the right endpoints of arcs from right to left .",
    "then to each right endpoint @xmath31 of an arc associate a word @xmath32 on @xmath19 $ ] where the words @xmath32 are defined backwards recursively : let @xmath33 , where @xmath34 is the label of the arc that ends with @xmath35 .",
    "in general , after defining @xmath32 , assume that the left endpoints of the arcs labeled @xmath36 lie between @xmath31 and @xmath37",
    ". then @xmath38 is obtained from @xmath32 by deleting entries @xmath36 and adding the entry @xmath39 at the very beginning , where @xmath39 is the label of the arc that ends with @xmath37 .",
    "then @xmath40 chen et al .",
    "@xcite computed the generating function for @xmath41 and showed that it is equally distributed with the number of crossings over all matchings with fixed left and right endpoints .",
    "a similar result holds for set partitions .",
    "the aim of this paper is to extend the major index to certain 01-fillings of moon polyominoes which include words and set partitions . in section  [ s : definitions ] we introduce the necessary notations , and describe the definition of the major index for 01-fillings of moon polyominoes .",
    "we explain in section  [ examples ] how the classical definition of major index on words and set partitions can be obtained by considering moon polyominoes of special shapes . in section  [",
    "s : proof ] we show that the maj statistic is equally distributed as ne , the number of north - east chains , by computing the corresponding generating functions . in the fillings of special shapes",
    ", ne corresponds to the number of inversions for words and crossings for set partitions .",
    "therefore , our main result , theorem  [ main ] , leads to a generalization of   and the analogous result for set partitions . in section  [ s : foata ] , we present a bijective proof for the equidistribution of maj and ne , which consists of three maps .",
    "the first is from the fillings of left - aligned stack polyominoes to itself that sends @xmath42 to @xmath43 , constructed in the spirit of foata s second fundamental transformation .",
    "the other two are maps that transform a moon polyomino to a left - aligned stack polyomino with the same set of columns , while preserving the statistics maj and ne , respectively .",
    "composing these three maps yields the desired bijection .",
    "a _ polyomino _ is a finite subset of @xmath44 , where we represent every element of @xmath44 by a square cell .",
    "the polyomino is _ convex _ if its intersection with any column or row is connected .",
    "it is _ intersection - free _ if every two columns are comparable , i.e. , the row - coordinates of one column form a subset of those of the other column .",
    "equivalently , it is intersection - free if every two rows are comparable .",
    "moon polyomino _ is a convex intersection - free polyomino . if the rows ( resp . columns ) of the moon polyomino are left - aligned ( resp .",
    "top - aligned ) , we will call it a _ left - aligned stack polyomino _ ( resp .",
    "_ top - aligned stack polyomino _ ) .",
    "ferrers diagram _ is a left - aligned and top - aligned stack polyomino .",
    "see figure  [ moonexample ] for an illustration .",
    "we are concerned with 01-fillings of moon polyominoes with restricted row sums .",
    "that is , given a moon polyomino @xmath1 , we assign a @xmath45 or a @xmath46 to each cell of @xmath1 so that there is at most one @xmath46 in each row . throughout this paper",
    "we will simply use the term _ filling _ to denote such 01-filling .",
    "we say a cell is empty if it is assigned a @xmath45 , and it is a @xmath46-cell otherwise . given a moon polyomino @xmath1 with @xmath47 columns ,",
    "we label them @xmath48 from left to right .",
    "let @xmath49 be an @xmath47-tuple of nonnegative integers and @xmath3 be a subset of rows of @xmath1 .",
    "we denote by @xmath50 the set of fillings @xmath27 of @xmath1 such that the empty rows of @xmath27 are exactly those in @xmath3 and the column @xmath51 has exactly @xmath52 many 1 s , @xmath53 .",
    "a _ north - east ( ne ) chain _ in a filling @xmath27 of @xmath1 is a set of two @xmath46-cells such that one of them is strictly above and to the right of the other and the smallest rectangle containing them is contained in @xmath1 .",
    "the number of ne chains of @xmath27 will be denoted @xmath54 .",
    "see figure  [ moon ] .     of a moon polyomino @xmath1 for @xmath55 and @xmath56 with @xmath57.,width=94 ]    the set @xmath50 was first studied by a.  kasraoui @xcite , who showed that the numbers of north - east and south - east chains are equally distributed .",
    "the generating functions for these statistics are also presented in ( * ? ? ?",
    "* theorem 4.4 ) .    to define the major index for fillings of moon polyominoes ,",
    "we first state it for rectangular shapes , which is essentially the classical definition of major index for words , ( c.f .",
    "section  [ examplerec ] ) .",
    "let @xmath58 be a filling of a rectangle whose @xmath5 _ nonempty _ rows @xmath30 are numbered from top to bottom .",
    "we define the _ descent statistic _ for @xmath58 as @xmath59 that is , descents of a rectangular filling are ne chains in consecutive nonempty rows .    for each nonempty row @xmath31 of @xmath58 ,",
    "let @xmath60 denote the rectangle that contains the row @xmath31 and all rows in @xmath58 above the row @xmath31 .",
    "[ defrec ] the major index for the rectangular filling @xmath58 is defined to be @xmath61    clearly , the empty rows of @xmath58 do not play any role in @xmath62 .",
    "that is , if we delete them , the major index of the resulting filling remains the same .",
    "[ defmajal ] let @xmath27 be a filling of a moon polyomino @xmath1 .",
    "let @xmath63 be the list of all the maximal rectangles contained in @xmath1 ordered increasingly by height , and denote by @xmath64 the filling @xmath27 restricted on the rectangle @xmath65 .",
    "then the major index of @xmath27 is defined to be @xmath66 where @xmath67 and @xmath68 are defined by  .",
    "in particular , @xmath69 when @xmath27 is a rectangular shape .",
    "it is also clear that @xmath70 is always nonnegative since @xmath71 , @xmath72 .",
    "consider the filling from figure  [ moon ] .",
    "it has four maximal rectangles and @xmath73 .     for a moon polyomino using definition 2.2.,width=415 ]",
    "the major index can be equivalently defined in a slightly more complicated way . however , this way is useful in proofs , especially when one uses induction on the number of columns of the filling , ( c.f .",
    "theorem 4.1 ) .",
    "we state this equivalent definition next .",
    "first we need some notation .",
    "if the columns of @xmath1 are @xmath74 from left to right , it is clear that the sequence of their lengths is unimodal and there exists a unique @xmath75 such that latexmath:[$|c_1| \\leq \\cdots \\leq |c_{k-1}| < |c_k| \\geq    length of the column @xmath51 .",
    "the left part of @xmath1 , denoted by @xmath77 , is the set of columns @xmath51 with @xmath78 and",
    "the right part of @xmath1 , denoted by @xmath79 , is the set of columns @xmath51 with @xmath80 .",
    "note that the columns of maximal length in @xmath1 belong to @xmath79 .",
    "we order the columns of @xmath1 , @xmath74 , by a total order @xmath81 as follows : @xmath82 if and only if    * @xmath83 or * @xmath84 , @xmath85 and @xmath86 , or * @xmath84 , @xmath87 and @xmath88 is to the left of @xmath89 , or * @xmath84 , @xmath90 and @xmath88 is to the right of @xmath89 .",
    "similar ordering of rows was used in  @xcite .    for",
    "every column @xmath85 define the rectangle @xmath91 to be the largest rectangle that contains @xmath88 as the leftmost column . for @xmath92 ,",
    "the rectangle @xmath91 is taken to be the largest rectangle that contains @xmath88 as the rightmost column and does not contain any columns from @xmath77 of same length as @xmath51 .",
    "let @xmath93 be the ordering of the columns of @xmath1 and let @xmath94 be the restriction of @xmath27 on the rectangle @xmath95 , @xmath96 .",
    "then @xmath97 where @xmath98 and @xmath99 are defined by  .",
    "[ majmoonex ] consider the filling @xmath27 from figure  [ moon ] .",
    "the order @xmath81 on the columns of @xmath1 is @xmath100 .",
    "so , @xmath101 , @xmath102 , @xmath103 , @xmath104 , @xmath105 , and @xmath106 , as illustrated in figure  [ moonmaj1 ] . by definition 2.2 , @xmath107",
    ".     for a moon polyomino using definition 2.2.,width=415 ]    definitions  [ defmajal ] and 2.2 are equivalent .",
    "some of the rectangular fillings @xmath94 in definition 2.2 may contain @xmath108 , in which case @xmath109 and formula   can be simplified .",
    "more precisely , there are uniquely determined indices @xmath110 such that @xmath111 . that is , among the rectangle @xmath112 s the maximal ones are @xmath113 .",
    "following the notation in definition 2.2 , the filling @xmath114 is the filling @xmath115 of the @xmath75-th maximal rectangle contained in @xmath1 .",
    "then , after cancellation of some terms , the right - hand side of   becomes the right - hand side of  .",
    "it is well - known that permutations and set - partitions can be represented as fillings of ferrers diagrams ( e.g.  @xcite ,  @xcite ) . here",
    "we will describe such presentations to show how to get the classical major index for words and set partitions from definition 2.2 .      for any rectangle , label the rows from top to bottom , and columns from left to right .",
    "fillings of rectangles are in bijection with words .",
    "more precisely , let @xmath116 be a word with letters in the set @xmath117 $ ] .",
    "the word @xmath9 can be represented as a filling @xmath27 of an @xmath118 rectangle @xmath1 in which the cell in row @xmath119 and column @xmath120 is assigned the integer @xmath46 if @xmath121 , and is empty otherwise .",
    "conversely , each filling of the rectangle @xmath1 corresponds to a word @xmath9 .",
    "it is readily to check that @xmath122 and @xmath123 .",
    "this follows from the fact that @xmath124 .",
    "as explained in  @xcite , general fillings of ferrers diagrams correspond to multigraphs . here",
    "we briefly describe the correspondence when restricted to 01-fillings with row sum at most 1 .",
    "the ferrers diagram is bounded by a vertical line from the left , a horizontal line from above , and a path consisting of east and north steps . following this path starting from the bottom left end",
    ", we label the steps of the path by @xmath125 .",
    "this gives a labeling of the columns and rows of the diagram .",
    "draw @xmath5 vertices on a horizontal line and draw an edge connecting vertices @xmath126 and @xmath127 if and only if there is a 1 in the cell of the column labeled @xmath126 and the row labeled @xmath127 ( see figure  [ ferrers1 ] ) .",
    "the resulting graph has no loops or multiple edges and every vertex is a right endpoint of at most one edge .",
    "the ne chains correspond to crossings of edges in the graph .",
    "if the column sums are at most one , the graph is a matching and the major index of the filling is equal to the major index of the matching as defined in  @xcite . as explained in  @xcite , the case of set partitions can be reduced to that of matchings .",
    "hence fillings of ferrers diagrams include set partitions as well . restricting to the triangular ferrers diagram",
    ", the 01-fillings considered in this paper also include _ linked partitions _ , a combinatorial structure that was studied in  @xcite .          in the case",
    "when @xmath1 is a top - aligned stack polyomino , @xmath70 has a simpler form in terms of the des statistic , just as in words and permutations .",
    "explicitly , if the nonempty rows of @xmath27 are @xmath30 , denote by @xmath128 the filling @xmath27 restricted to the largest rectangle contained in @xmath1 whose bottom row is @xmath31 .",
    "[ stackprop ] let @xmath27 be a filling of a top - aligned stack polyomino and @xmath128 be as defined above .",
    "then @xmath129    let @xmath130 be all the nonempty rows of @xmath27 that are of same length as the last row @xmath131 .",
    "denote by @xmath132 and by @xmath58 the filling of the largest rectangle of @xmath1 containing @xmath131 .",
    "we proceed by induction on the number @xmath5 of rows of @xmath27 .",
    "the claim is trivial when @xmath27 has only one row or is a rectangle .",
    "otherwise , @xmath133 which completes the proof",
    ".    consider the filling @xmath27 of a top - aligned stack polyomino in figure  [ stackmaj ] with @xmath55 and @xmath134 .",
    "@xmath27 has five nonempty rows and , by proposition  [ stackprop ] , @xmath135 .     using proposition  [ stackprop].,width=529 ]    proposition 3.1 will be used in the proof of lemma 5.5 .",
    "in this section we state and prove the main theorem which gives the generating function for maj over @xmath50 , the set of all fillings of the moon polyomino @xmath1 with column sums given by the integer sequence @xmath2 and empty rows given by @xmath3 .",
    "let @xmath136 be the column lengths of @xmath27 and let @xmath137 the number of rows in @xmath3 that intersect the column @xmath51 .",
    "suppose that , under the ordering defined in section  [ s : definitions ] , @xmath138 . then for @xmath139 , define @xmath140 the numbers @xmath141 have the following meaning : if one fills in the columns of @xmath27 from smallest to largest according to the order @xmath81 , then @xmath142 is the number of available cells in the @xmath127-th column to be filled .",
    "[ main ] for a moon polyomino @xmath1 with @xmath47 columns , @xmath143{0pt}{}{h_i}{s_i}_q\\ ] ] where @xmath141 is defined by  .",
    "we postpone the proof of theorem  [ main ] until the end of this section .",
    "suppose @xmath1 is the first moon polyomino in figure  [ moonexample ] , @xmath144 , and @xmath145 .",
    "the @xmath81 order on the columns of @xmath1 is : @xmath146 .",
    "the fifth row intersects all columns except @xmath147 , so , @xmath148 and @xmath149 .",
    "therefore , @xmath150 by theorem  [ main ] , @xmath151{0pt}{}{h_i}{s_i}_q= \\genfrac[]{0pt}{}{2}{1}_q \\genfrac[]{0pt}{}{1}{0}_q\\genfrac[]{0pt}{}{2}{2}_q\\genfrac[]{0pt}{}{3}{1}_q \\genfrac[]{0pt}{}{1}{1}_q = ( 1+q)(1+q+q^2)=1 + 2q+2q^2+q^3 $ ] .",
    "the fillings in @xmath50 are listed in figure  [ theoremexample ] .",
    ".,width=340 ]    let @xmath152 be a permutation of @xmath117 $ ] and let @xmath1 be a moon polyomino with columns @xmath74 .",
    "suppose the shape @xmath153 with columns @xmath154 is also a moon polyomino and @xmath155 with @xmath156 .",
    "then @xmath157 that is , the generating function @xmath158 does not depend on the order of the columns of @xmath1 .",
    "the formula   seems to depend on the order @xmath81 of the columns of the moon polyomino",
    ". however , note that @xmath82 if @xmath159 ; and columns of same length are consecutive in the order @xmath81 .",
    "hence it suffices to compare the terms in the right - hand side of   that come from columns of fixed length .",
    "if @xmath160 are all the columns of @xmath1 of fixed length , then @xmath161 thus the contribution of these columns to the right - hand side of   is @xmath162{0pt}{}{h_{i_{j+r}}}{s_{i_{j+r}}}_q = \\genfrac[]{0pt}{}{h_{i_{j+1}}}{s_{i_{j+1 } } , \\dots , s_{i_{j+k } } , h_{i_{j+1}}- ( s_{i_{j+1}}+ \\cdots + s_{i_{j+k } } ) } _ q.\\ ] ] the last q - multinomial coefficient is invariant under permutations of @xmath163 , and the claim follows",
    ".    the right - hand side of formula   also appeared in the generating function of ne chains , as shown in  @xcite :    [ kastheorem ] @xmath164{0pt}{}{h_i}{s_i}_q.\\ ] ]    combining theorems  [ main ] and  [ kastheorem ] , we have    [ equal ] @xmath165    that is , the maj statistic has the same distribution as the ne statistic over the set @xmath166 . since @xmath54 is the natural analogue of inv for words and permutations , theorem [ equal ] generalizes macmahon s equidistribution result .",
    "we shall prove a lemma about the major index for words and then use it to prove theorem  [ main ] .",
    "[ perm ] let @xmath167 be a word such that @xmath168 for all @xmath126 .",
    "consider the set @xmath169 of all the words @xmath170 that can be obtained by inserting @xmath47 many @xmath5 s between the letters of @xmath9 .",
    "then the difference @xmath171 ranges over the multiset @xmath172 .",
    "it follows that @xmath173{0pt}{}{k+m}{m}_q.\\ ] ] the same statement holds if @xmath167 is a word such that @xmath174 for all @xmath126 and @xmath169 is the set of all the words @xmath170 obtained by inserting @xmath47 many 1 s between the letters of @xmath9 .",
    "we give an elementary proof for the case of inserting @xmath5 s .",
    "the case of inserting 1 s is dealt with similarly . for a word @xmath175",
    "we define the _ descent sequence _ @xmath176 by letting @xmath177 , where @xmath32 is obtained by inserting one @xmath5 in the @xmath126-th gap of @xmath9 , i.e. , @xmath178 .",
    "note that @xmath179 hence , if @xmath180 then @xmath181 is a shuffle of the sequences @xmath182 and @xmath183 which begins with @xmath184 and ends with @xmath45 .",
    "moreover , every such sequence is @xmath181 for some word @xmath9 .",
    "it is not hard to see that the multiset @xmath185 depends only on @xmath181 and not on the letters of @xmath9 .",
    "first we consider the case when @xmath186 , i.e. , @xmath187 $ ] .",
    "inserting @xmath39 @xmath5 s between @xmath188 and @xmath189 increases the major index by @xmath190 .",
    "hence , if one inserts @xmath191 many @xmath5 s between @xmath188 and @xmath189 for @xmath192 , the major index is increased by @xmath193 letting @xmath194 range over all @xmath195-tuples with @xmath196 , the increased amount ranges over the multiset @xmath197 .    to deal with the other possible descent sequences",
    ", we note that any descent sequence @xmath181 can be obtained by applying a series of adjacent transpositions to @xmath198 , where we only transpose adjacent elements @xmath199 which correspond to ascent and descent positions , respectively .",
    "suppose @xmath200 is obtained by transposing the @xmath126-th and @xmath201-st element in @xmath202 , where @xmath137 and @xmath203 correspond to an ascent and a descent in @xmath204 , respectively .",
    "consequently , @xmath205 and @xmath206 , while @xmath207 if and only if @xmath208 for @xmath209 .",
    "it suffices to show that the multisets @xmath185 and @xmath210 are equal .",
    "suppose @xmath211 is obtained by inserting @xmath212 many @xmath5 s in the @xmath127-th gap of @xmath9 , @xmath213 .",
    "let @xmath214 be the word obtained by inserting @xmath215 @xmath5 s in the @xmath127-th gap of @xmath204 where @xmath215 are defined as follows .",
    "+ if @xmath216 then @xmath217 if @xmath218 then @xmath219 this defines a map between sequences @xmath220 with @xmath216 ( resp .",
    "@xmath218 ) , and @xmath221 with @xmath222 ( resp .",
    "@xmath223 ) , which is a bijection .",
    "the @xmath5 s inserted in the @xmath127-th gap of @xmath9 for @xmath224 contribute to @xmath171 the same amount as do the @xmath5 s inserted in the same gaps in @xmath204 to @xmath225 .",
    "the major index contributed to @xmath226 by the segment @xmath227 is the sum of @xmath228 ( which equals the contribution of @xmath229 to @xmath230 ) and @xmath231 similarly , the major index contributed to @xmath232 by the segment @xmath233 is the sum of @xmath126 ( which equals the contribution of @xmath234 to @xmath235 ) and @xmath236 now , one readily checks that @xmath237 .",
    "this completes the proof .",
    "[ gessel ] lemma [ perm ] can be proved in many ways , for example , in ( * ? ? ?",
    "* theorem 1.2 ) foata and han constructed a transformation on the shuffle class sh@xmath238 , where @xmath204 is a nonempty word whose letters are positive integers .",
    "alternatively , one can use the theory of @xmath239-partitions @xcite , which leads to a stronger result , namely , equation   holds if @xmath167 with @xmath240 , @xmath241 and @xmath169 is the set of all words @xmath170 obtained by inserting @xmath47 copies of @xmath242 between the letters of @xmath9 . to show this , it is enough to consider the case when @xmath9 is a permutation of length @xmath75 on @xmath75 distinct numbers between 1 and @xmath243 such that the integers @xmath244 are missing from it and @xmath170 varies over the set @xmath169 of all permutations obtained by inserting @xmath245 in @xmath9 from left to right .",
    "we outline the proof in this general case assuming that the reader is familiar with the theory of @xmath239-partitions .",
    "we adopt the notation and definitions from section 4.5 in  @xcite , which is also a good reference for basic results on @xmath239-partitions .",
    "let @xmath246 be the antichain with @xmath75 elements labeled with the letters of @xmath9 .",
    "let @xmath247 be a disjoint union of @xmath246 and a chain of @xmath47 elements labeled @xmath248 .",
    "we denote by @xmath249 the generating function of all @xmath9-compatible functions @xmath250 \\rightarrow \\mathbb{n}$ ] ( see  @xcite for the definitions ) .",
    "lemma 4.5.2 in  @xcite asserts that @xmath251 all @xmath247-partitions compatible with some @xmath211 are obtained by combining a @xmath246-partition compatible with @xmath9 and a integer partition with at most @xmath47 parts .",
    "therefore , @xmath252 applying lemma 4.5.2 in  @xcite to all @xmath211 , we have @xmath253 combining equations  , , and gives  .",
    "let @xmath254 be the smallest column of @xmath1 in the order @xmath81 and @xmath255 .",
    "note that @xmath254 is the leftmost or the rightmost column of @xmath1 .",
    "let @xmath27 be a filling of @xmath1 with @xmath256 nonempty cells in @xmath254 and let @xmath257 be its restriction on @xmath258 . from definition 2.2 ,",
    "we derive that @xmath259 where @xmath260 is the filling of the rectangle @xmath261 determined by the column @xmath254 .",
    "@xmath260 is obtained by adding a column with @xmath256 many @xmath46-cells to the rectangular filling @xmath262 . using the bijection between fillings of rectangles and words described in section  [ examplerec ]",
    ", one sees that if @xmath254 is the leftmost ( resp .",
    "rightmost ) column in @xmath27 , this corresponds to inserting @xmath256 maximal ( resp .",
    "minimal ) elements in the word determined by the filling @xmath262 .",
    "when the column @xmath254 varies over all possible @xmath263 fillings , by lemma  [ lemma ] , the value @xmath264 varies over the multiset @xmath265 with generating function @xmath266{0pt}{}{h}{s}_q$ ] , where @xmath267 is the value @xmath268 ( resp .",
    "@xmath269 ) if @xmath254 is the leftmost ( resp .",
    "the rightmost ) column of @xmath27 , as defined in  .",
    "therefore , @xmath270{0pt}{}{h}{s}_q \\sum_{m ' \\in { \\textbf{f}}({\\mathcal{m } } ' , { \\textbf{s}}';a ) } q^{{\\mathrm{maj}}(m')}\\ ] ] where @xmath271 is obtained from @xmath2 by removing the first ( resp .",
    "last ) component if @xmath254 is the leftmost ( resp .",
    "rightmost ) column of @xmath27 .",
    "equation   now follows by induction on the number of columns of @xmath1 .",
    "the objective of this section is to give a bijective proof to theorem 4.5 . for the set @xmath15 of all words of a multiset @xmath4 ,",
    "the equidistribution of maj and inv was first proved by macmahon by combinatorial analysis .",
    "this raised the question of constructing a canonical bijection @xmath272 such that @xmath273 .",
    "foata answered the question by constructing an elegant map @xmath274 @xcite , which is referred to as the _ second fundamental transformation _",
    "we begin this section by reviewing foata s map @xmath272 .",
    "let @xmath275 be a word on @xmath276 and let @xmath34 be an integer . if @xmath277 , the @xmath34-factorization of @xmath9 is @xmath278 , where each @xmath191 is a letter less than or equal to @xmath34 , and each @xmath279 is a word ( possibly empty ) , all of whose letters are greater than @xmath34 .",
    "similarly , if @xmath280 , the @xmath34-factorization of @xmath9 is @xmath278 , where each @xmath191 is a letter greater than @xmath34 , and each @xmath279 is a word ( possibly empty ) , all of whose letters are less than or equal to @xmath34 . in each case one defines @xmath281 with the above notation , let @xmath282 and let @xmath283 .",
    "the second fundamental transformation @xmath274 is defined recursively by @xmath284 if @xmath9 has length @xmath46 , and @xmath285 if @xmath9 has length @xmath286 .",
    "the map @xmath274 has the property that it preserves the last letter of the word , and @xmath287 .",
    "foata s map @xmath274 is constructed recursively with certain `` local operations '' to eliminate the difference caused by adding the last letter in the words .",
    "inspired by this idea , we construct a foata - type bijection @xmath288 with the property @xmath289 . the map @xmath290 can be defined directly for left - aligned stack polyominoes .",
    "but we describe it first for ferrers diagrams in section 5.1 , because this case contains all the essential steps and is easy to understand .",
    "this map is a revision of the foata - type bijection presented in the preprint of  @xcite for set partitions , which correspond to fillings with row and column sums at most 1 .",
    "then in section 5.2 we extend the construction to left - aligned stack polyominoes and prove that @xmath289 . in section 5.3 , we construct two bijections , @xmath291 and @xmath292 , that transform a filling of a moon polyomino to a filling of a left - aligned stack polyomino and preserve the statistics maj and ne , respectively . composing these maps with @xmath290 defined on left - aligned stack polyominoes yields a bijection on @xmath0 that sends maj to ne .",
    "the empty rows in the filling @xmath293 do not play any role in the definitions of @xmath70 or @xmath54 .",
    "therefore , in what follows we assume that @xmath294 and describe @xmath290 for fillings without empty rows . for @xmath295 , one can first delete the empty rows of the filling , apply the map @xmath290 , and reinsert the empty rows back .",
    "let @xmath296 be a ferrers diagram and @xmath297 a filling of @xmath296 .",
    "the bijection @xmath290 is defined inductively on the number of rows of @xmath297 , which preserves the first row of @xmath297 . if @xmath297 has only one row , then @xmath298 .",
    "otherwise , we denote by @xmath299 the filling obtained by deleting the top row @xmath300 of @xmath297 .",
    "let @xmath301 and let @xmath302 be the filling obtained by performing the algorithm @xmath303 described below",
    ". then @xmath304 is obtained from @xmath302 by adding the top row @xmath300 .",
    "[ [ section ] ] * * ~~    if @xmath305 is the @xmath46-cell of @xmath300 , then denote by @xmath306 the set of all rows of @xmath307 that intersect the column of @xmath305 . the @xmath46-cells in @xmath306 that are strictly to the left of @xmath305 are called left and the @xmath46-cells in @xmath306 that are weakly to the right of @xmath305 are called right",
    "the cell @xmath305 is neither left nor right .",
    "let @xmath308 ( critical left cell ) be the topmost left @xmath46-cell , and @xmath309 ( critical right cell ) be the leftmost right @xmath46-cell that is above @xmath308 .",
    "if there is more than one such cell the @xmath309 is defined to be the lowest one .",
    "denote by @xmath310 the set of all rows weakly below the row of @xmath309 that intersect the column of @xmath309 and @xmath311 is the set of all rows in @xmath306 that do not intersect the column of @xmath309 .",
    "if @xmath308 does not exist then both @xmath310 and @xmath311 are empty . if @xmath308 exists but @xmath309 does not , then @xmath310 is empty and @xmath311 contains all the rows in @xmath306 weakly below @xmath308 .",
    "[ expressions ] let @xmath312 and @xmath313 be two @xmath46-cells with coordinates @xmath23 and @xmath24 , respectively .",
    "we _ swap the cells @xmath312 and @xmath313 _ by deleting the 1 s from these two cells and write 1 s in the cells with coordinates @xmath314 and @xmath315 .    for a cell @xmath305 , denote by @xmath316 the column of @xmath305 , and @xmath317 the length of @xmath316 .",
    "1 .    2 .    3 .",
    "see figure  [ alg1 ] for illustration of the steps .",
    "* @xmath319note : * this step is well - defined since it can not occur before @xmath320 reaches @xmath308 ( that would contradict the definition of @xmath309 ) and , after that , @xmath321 is always below @xmath308 .",
    "therefore , the @xmath46-cell @xmath322 always exists .",
    "the fact that the square @xmath323 belongs to @xmath324 follows from the definition of @xmath310 and lemma 5.2 ( c ) .     on @xmath310.,width=566 ]    when the algorithm @xmath318 stops , we continue processing the rows of @xmath311 by algorithm @xmath325 .      1",
    "( _ * borrowing * _ ) 3 .    4 .",
    "see figure  [ alg2 ] for illustration of the steps in @xmath325 .     on @xmath311.,width=566 ]",
    "let us note the following easy but useful properties of the algorithm @xmath303",
    ".    1 .   the pointers @xmath321 and @xmath320 process the rows of @xmath310 and @xmath311 from top to bottom . however , while @xmath320 always moves from one row to the next one below it , @xmath321 sometimes stays on the same row ( cf .",
    "step ( b2.2 ) ) and sometimes `` jumps '' several rows below ( cf . step ( b1 ) ) .",
    "2 .   pointer @xmath321 always points to a right @xmath46-cell in @xmath318 and to a left @xmath46-cell in @xmath325 .",
    "further we show some nontrivial properties which will be used to show that the map @xmath290 has the desired property @xmath326 .",
    "[ prop ] suppose in @xmath318 @xmath321 is pointing to @xmath312 and @xmath320 is pointing to @xmath313 .",
    "then    * in the rows between @xmath312 and @xmath313 there are no 1 s weakly to the left of @xmath312 . *",
    "if @xmath322 is the lowest left @xmath46-cell above @xmath312 , then in the rows between @xmath322 and @xmath312 there are no 1 s weakly to the left of @xmath312 .",
    "* the @xmath46-cell @xmath312 is in a column with same length as the column of the critical right cell @xmath309 .",
    "moreover , when @xmath318 stops @xmath321 points to the last row in @xmath310 .",
    "the first two parts are proved by induction on the number of steps performed in the algorithm .    *",
    "the only step which leaves the gap between @xmath321 and @xmath320 nonempty is ( b2.2 ) .",
    "but after this step , the number of 1 s in the rows between @xmath321 and @xmath320 weakly to the left of @xmath312 does not change .",
    "* the case when the last step is ( b2.2 ) follows from the induction hypothesis .",
    "if the last step is ( b1 ) or ( b2.3 ) the claim follows from part ( a ) .",
    "the case when the last step was ( b2.1 ) and the cells @xmath312 and @xmath313 formed an ne chain the claim also follows from part ( a ) and the induction hypothesis .",
    "if in ( b2.1 ) , the cells @xmath312 and @xmath313 do not form an ne chain , in addition to the induction hypothesis , one uses the fact that there are no 1 s in the rows between these two cells which are weakly to the left of @xmath313 . *",
    "the first part follows immediately from the definition of the steps .",
    "if the second part is not true , then the last step must be ( b2.2 ) .",
    "and the column of @xmath312 is longer than the column of @xmath313 .",
    "since this is the last step of @xmath318 , it follows that the column of @xmath312 intersects the top row of @xmath311 .",
    "however , the column of @xmath309 does not intersect the top row of @xmath311 by definition of @xmath311 .",
    "this contradicts the fact that @xmath312 and @xmath309 are in columns of same length .",
    "[ alg ] after algorithm @xmath318 the number of ne chains decreases by the total number of left @xmath46-cells in @xmath310 , whereas after algorithm @xmath325 the number of ne chains increases by the total number of right @xmath46-cells in @xmath311 .    to prove the first part note that pointer @xmath320 points to each left @xmath46-cell in @xmath310 exactly once in the algorithm @xmath318",
    "when that happens , step ( b1 ) is performed during which , by lemma  [ prop](a ) , the number of ne chains decreases by one . in the other steps , the number of ne chains remains unchanged .",
    "this is trivial for steps ( b2.1 ) and ( b2.2 ) , whereas for step ( b2.3 ) it follows from lemma  [ prop ]  ( a ) and  ( b ) .    for the second part , note that pointer @xmath320 points to each right @xmath46-cell in @xmath311 exactly once in the algorithm @xmath325 with possible exception being the top @xmath46-cell in @xmath311 to which it never points . in those steps",
    "the number of ne chains is increased by one , while otherwise it remains the same . when the top @xmath46-cell is right",
    ", then borrowing occurs .",
    "it follows from parts  ( b ) and  ( c ) of lemma  [ prop ] that the number of ne chains is also increased by one .     applied inductively on @xmath327 . the fillings @xmath328 are restrictions of @xmath297 on the last @xmath126 rows.,width=566 ]    [ ferrer ] the map @xmath329 is a bijection .",
    "the proof is quite technical and is given in the appendix .",
    "here we only present an example of the bijection @xmath290 in figure  [ bijex ] and explain how it includes foata s second fundamental transformation .",
    "if the moon polyomino is rectangular , then the algorithm @xmath303 has a simpler description because some of the cases can never arise .",
    "namely , if the cell in the second row forms an ne chain with the top cell ( a descent ) then @xmath330 , and only the steps ( c1 ) and ( c2 ) are performed . otherwise , @xmath331 and , since all columns are of equal height , only the steps ( b1 ) and ( b2.1 ) are performed . in both these cases , via the correspondence between words and rectangular fillings ( c.f .",
    "section  [ examplerec ] ) the algorithms @xmath325 and @xmath318 for rectangles are equivalent to foata s transformation for words  @xcite .",
    "next we extend the bijection @xmath290 to fillings of left - aligned stack polyominoes which sends maj to ne .",
    "let @xmath1 be a left - aligned stack polyomino .",
    "as in the case of ferrers diagrams , we can assume that @xmath332 and only consider fillings without empty rows .",
    "suppose @xmath27 is a filling of @xmath1 with top row @xmath300 .",
    "the map , which is again denoted by @xmath290 , is defined inductively on the number of rows of @xmath27 . if @xmath27 has only one row , then @xmath333 .",
    "otherwise , let @xmath296 be the maximal ferrers diagram in @xmath1 that contains the top row and @xmath334 be @xmath296 without the top row .",
    "let @xmath335 and @xmath336 . to obtain @xmath337",
    "we perform the following steps .",
    "( see figure  [ stack1 ] ) .    1 .",
    "delete the top row of @xmath27 and get @xmath338 .",
    "2 .   apply @xmath290 to @xmath339 and get @xmath340 .",
    "3 .   apply the algorithm @xmath303 to the filling @xmath341 and leave the cells in @xmath342 outside of @xmath307 unchanged .",
    "denote the resulting filling by @xmath343 .",
    "@xmath337 is obtained by adding row @xmath300 back to @xmath343 .     for left - aligned stack polyominoes.,width=566 ]",
    "it is a bijection from @xmath0 to itself since every step is invertible . that the step 3 is invertible follows from the proof of theorem [ ferrer ] .",
    "[ mtf ] using the notation introduced above , @xmath344 where @xmath345 is defined with respect to the top row @xmath300 of @xmath297 as in section  [ ferrers ] .",
    "let @xmath4 be the filling @xmath27 restricted to the rows which are not completely contained in @xmath296 . from the definition of @xmath346 , we have @xmath347 note that @xmath348 , hence   and   give the first equality in  . the second one is readily checked using proposition  [ majstack ] for major index of stack polyominoes .",
    "the rest of this subsection is devoted to proving that the map @xmath290 has the desired property @xmath289 .",
    "we shall need one more lemma .",
    "let @xmath305 be a @xmath46-cell in a filling @xmath27 of a left - aligned stack polyomino .",
    "we say that @xmath305 is _ maximal _ if there is no 1 in @xmath27 which is strictly above and weakly to the left of @xmath305 .",
    "clearly , a maximal cell must be the highest @xmath46-cell in its column . for a maximal cell @xmath305 in @xmath27",
    ", we use @xmath349 to denote the index of the leftmost column ( the columns are numbered from left to right ) to the right of @xmath305 that contains a @xmath46-cell which together with @xmath305 forms an ne chain .",
    "if such a column does not exist set @xmath350 .",
    "[ maxcell ] a @xmath46-cell @xmath305 in @xmath27 is maximal if and only if the highest @xmath46-cell @xmath351 in the same column in @xmath352 exists and is maximal .",
    "moreover , @xmath353 when they are both maximal .",
    "we proceed by induction on the number of rows of @xmath27 and keep the notation as in figure  11 .",
    "the case when @xmath27 has one row is trivial .",
    "suppose that the top row @xmath300 of @xmath27 has a @xmath46-cell @xmath354 in the column @xmath355 .",
    "the cell @xmath354 is maximal in both @xmath27 and @xmath257 and @xmath356 .",
    "note that a @xmath46-cell @xmath357 in @xmath27 ( resp .",
    "@xmath257 ) is maximal if and only if @xmath305 is in column @xmath358 and is maximal in @xmath339 ( resp .",
    "@xmath343 ) .    denote by @xmath359 , @xmath360 , and @xmath361 the highest @xmath46-cells in column @xmath358 in the fillings @xmath339 , @xmath340 , and @xmath343 , respectively . by the induction hypothesis ,",
    "@xmath359 is maximal in @xmath339 if and only if @xmath360 is maximal in @xmath342 .",
    "@xmath343 is obtained from @xmath342 by applying the algorithm @xmath303 with respect to the row @xmath300 to @xmath307 .",
    "@xmath360 is a left cell in this algorithm , and since @xmath303 does not change the relative position of the left @xmath46-cells , @xmath361 is maximal in @xmath343 .",
    "it only remains to prove that @xmath353 .",
    "suppose @xmath362 ( they are equal by the inductive hypothesis ) .    if @xmath363 then @xmath364 . in @xmath342",
    "it corresponds to a @xmath46-cell @xmath365 in a column left of @xmath354 such that @xmath366 form an ne chain . since the algorithm @xmath303 preserves the column sums and the relative positions of left @xmath46-cells , we have @xmath367 , and hence @xmath368 .    if @xmath369 then @xmath370 .",
    "the fact that @xmath371 means that there is no left @xmath46-cell in @xmath342 above and to the right of @xmath360 and , since @xmath303 does not change the relative positions of the left @xmath46-cells , there will be no left @xmath46-cell above and to the right of @xmath361 in @xmath343 .",
    "so , in this case , we conclude @xmath372 .",
    "[ thmphi ] if @xmath27 is a filling of a left - aligned stack polyomino @xmath1 , then @xmath289 .",
    "again we proceed by induction on the number of rows of @xmath27 .",
    "the case when @xmath27 has one row is trivial .",
    "we use the notation as in figure 11 , and let @xmath373 .    by proposition",
    "[ alg ] , the algorithm @xmath303 on @xmath342 decreases ne by one for each left @xmath46-cell in @xmath374 and increases it by one for each right @xmath46-cell in @xmath375 . therefore , @xmath376 since @xmath303 preserves the column sums , @xmath377 hence @xmath378    one the other hand , from lemma  [ mtf ] and the induction hypothesis , one gets @xmath379 so , it suffices to show that    @xmath380    to show equation , note that for a filling of a ferrers diagram @xmath297 the number of rows in @xmath381 is determined by the column indices of @xmath308 ( critical left cell ) and @xmath309 ( critical right cell ) .",
    "the @xmath308 is the topmost left @xmath46-cell which , if exists , is the topmost _ maximal _ cell besides the @xmath46-cell in the first row . by lemma [ maxcell ] , @xmath308 in @xmath382 is in the same column as @xmath383 in @xmath384 , or neither of them exists . the latter case is trivial , as @xmath381 is empty . in the first case ,",
    "let @xmath385 denote the length of row @xmath300 .",
    "then @xmath309 , the critical right cell of @xmath299 , is in the column @xmath386 if @xmath387 and does not exist otherwise .",
    "similarly , the critical right cell of @xmath307 , @xmath388 , is in the column @xmath389 if @xmath390 , and does not exist otherwise . by lemma  [ maxcell ] , @xmath391 , and",
    "this implies  .",
    "now we consider the case when @xmath1 is a general moon polyomino .",
    "we label the rows of @xmath1 by @xmath30 from top to bottom .",
    "let @xmath153 be the unique left - aligned stack polyomino whose sequence of row lengths is equal to @xmath392 from top to bottom .",
    "in other words , @xmath153 is the left - aligned polyomino obtained by rearranging the columns of @xmath1 by length in weakly decreasing order from left to right . for the definitions that follow , we use an idea of m.  rubey  @xcite to describe an algorithm that rearranges the columns of @xmath1 to obtain @xmath153 ( figure  [ alpha ] ) .",
    "+ 1 . set @xmath393 .",
    "if @xmath258 is left aligned go to ( 4 ) .",
    "if @xmath258 is not left - aligned consider the largest rectangle @xmath306 completely contained in @xmath258 that contains @xmath147 , the leftmost column of @xmath258 .",
    "update @xmath258 by letting @xmath258 be the polyomino obtained by moving the leftmost column of @xmath306 to the right end .",
    "go to ( 2 ) .",
    "+ 4 . set @xmath394 .",
    "+    .,width=566 ]    in this section we give two bijections @xmath395 which preserve the major index and the number of ne chains , respectively .",
    "the sequence @xmath271 is obtained by rearranging the sequence @xmath2 in the same way @xmath153 is obtained by rearranging the columns of @xmath1 .",
    "let @xmath58 be a filling of a rectangle @xmath306 with column sums @xmath398 .",
    "first , we describe a transformation @xmath399 which gives a filling of @xmath306 with column sums @xmath400 and preserves the major index .",
    "recall that a descent in @xmath58 is a pair of 1 s in consecutive nonempty rows that form an ne chain .",
    "define an _ ascent _ to be a pair of 1 s in two consecutive nonempty rows that does not form an ne chain .",
    "suppose the first column of @xmath58 has @xmath75 many 1 s : @xmath401 from top to bottom .     for rectangles.,width=566 ]    1 .",
    "let @xmath402 be the rectangle obtained by adding one empty column to @xmath58 from right .",
    "process the @xmath46-cells @xmath401 from bottom to top ( see figure  [ tau ] ) : 2 .",
    "for @xmath403 do the following : + let @xmath404 be the lowest @xmath46-cell above @xmath405 in @xmath402 and @xmath406 be the highest @xmath46-cell below @xmath405 in @xmath402 .",
    "if @xmath404 does not exist or @xmath407 , and @xmath406 does not exist , just move @xmath405 horizontally to the last column of @xmath402 ; 2 .   if ( i ) @xmath404 does not exist or @xmath407 , but @xmath406 exists , or ( ii ) both @xmath404 and @xmath406 exist , and @xmath404 is to the right of @xmath406 : + let @xmath408 be the maximal chain of consecutive ascents in @xmath402 .",
    "move @xmath409 horizontally to the column of @xmath410 , for @xmath411 , and move @xmath412 horizontally to the last column of @xmath402 .",
    "( if @xmath412 is in the last column of @xmath402 , it remains there . )",
    "3 .   if @xmath413 , and ( @xmath404 is weakly to the left of @xmath406 or @xmath406 does not exist ) : + let @xmath414 be the maximal chain of consecutive descents in @xmath402 .",
    "move @xmath409 horizontally to the column of @xmath410 , for @xmath411 , and move @xmath412 horizontally to the last column of @xmath402 .",
    "3 .   delete the first column of @xmath402 .",
    "note that each iteration in step 2 decreases the number of 1 s in the first column of @xmath402 by one and increases the number of 1 s in the last column by one , while the other column sums remain unchanged .",
    "now we are ready to define the map @xmath291 .",
    "suppose @xmath415 .",
    "we perform the algorithm @xmath416 on @xmath27 to transform the shape @xmath1 to @xmath153 . while we are in step 3 , instead of just moving the first column of @xmath306 to the right end , we perform the algorithm @xmath399 on the filling @xmath58 of @xmath306 .",
    "@xmath417 is defined to be the resulting filling of @xmath153 .",
    "[ lemmatau ] the transformation @xmath399 is invertible .",
    "moreover , it preserves the descents and hence @xmath418 .",
    "the map @xmath399 is invertible since @xmath419 can be obtained by taking @xmath420 , where @xmath421 is the rotation of rectangles by @xmath422 .",
    "moreover , each iteration of step 2 of @xmath399 preserves the positions of descents , hence the second part of the claim holds .",
    "[ propf ] the map @xmath423 is a bijection and @xmath397 .",
    "the first part follows from lemma  [ lemmatau ] and the fact that @xmath416 is invertible .",
    "the filling @xmath417 is obtained after several iterations of step 3 in the algorithm @xmath416 combined with application of @xmath399 . for the second part of the claim , it suffices to show that maj is preserved after one such iteration .",
    "let @xmath257 be the filling of the shape @xmath258 obtained from @xmath27 after one step of @xmath291 in which the rectangle @xmath58 is transformed into @xmath424 .",
    "we shall use definition 2.2 to compare @xmath70 and @xmath425 .",
    "let @xmath426 ( resp .",
    "@xmath427 ) be the maximal rectangles of @xmath27 ( resp .",
    "@xmath257 ) , ordered by height . in particular , @xmath64 and @xmath428 are of same size .",
    "suppose @xmath429 , then @xmath430 .",
    "we partition the index @xmath126 into three intervals , according to @xmath431 , @xmath432 , and @xmath433 , and compare the contribution of @xmath64 s in each interval .    1 .   for @xmath434 , the rectangles @xmath64 and @xmath435 are of smaller height than @xmath58 and contain several consecutive rows of @xmath58 . using lemma  [ lemmatau ] we know that the descents in @xmath436 ( resp",
    "@xmath437 ) @xmath434 , are in the same rows as in @xmath438 ( resp .",
    "@xmath439 ) . and",
    "descents formed by one cell in @xmath58 and one cell on the right of @xmath58 are preserved since @xmath399 preserves the row sum of @xmath58 .",
    "consequently , @xmath440 2 .   for @xmath432 , by lemma  [ lemmatau ]",
    ", we have @xmath441 3 .   for @xmath442 ,",
    "the height of the rectangle @xmath64 or @xmath443 is greater than or equal to that of @xmath58 .",
    "each of these rectangles contains several consecutive columns of @xmath58 excluding the first one .",
    "the filling of each subrectangle of @xmath58 consisting of the columns @xmath444 ( @xmath445 ) is equal , up to a rearrangement of the empty rows , to the filling of the subrectangle of @xmath424 consisting of the columns @xmath446 . to see this , note that the shifting of the @xmath46-cells @xmath447 horizontally in the algorithm @xmath399 can be viewed as moving the @xmath46-cell @xmath409 vertically to the row of @xmath448 and moving @xmath449 to the last column of @xmath402 in the row of @xmath412 .",
    "thus , the descent positions in the fillings @xmath436 ( resp .",
    "@xmath450 ) , @xmath442 are the same as in @xmath438 ( resp .",
    "@xmath451 ) .",
    "finally , one checks that the descents formed by one cell in @xmath58 and one cell outside @xmath58 are also preserved . therefore , @xmath452    combining  ,  , and   gives @xmath453 .",
    "suppose @xmath415 . to obtain @xmath456",
    ", we perform the algorithm @xmath416 to transform the shape @xmath1 to @xmath153 and change the filling when we move columns in step 3 so that the number of 1 s in each row and column is preserved .",
    "let @xmath58 be the rectangular filling in step 3 of @xmath416 that contains the column @xmath147 of the current filling .",
    "suppose @xmath147 contains @xmath75 many @xmath46-cells @xmath457 from top to bottom .",
    "shade the empty rows of @xmath58 and the cells in @xmath58 to the right of @xmath457 .",
    "let @xmath458 denote the number of empty white cells in @xmath58 above @xmath459 .",
    "if @xmath460 is the rectangle obtained by moving the column @xmath147 from first to last place , fill it to obtain a filling @xmath461 as follows .    1 .",
    "the rows that were empty remain empty .",
    "shade these rows . 2 .",
    "write @xmath75 many 1 s in the last column from bottom to top so that there are @xmath458 white empty cells below the @xmath126-th 1 , @xmath462 .",
    "3 .   shade the cells to the left of the nonempty cells in the last column .",
    "fill in the rest of the rectangle by writing 1 s in the unshaded rows of @xmath460 so that the unshaded part of @xmath58 to the right of the first column is the same as the unshaded part of @xmath461 to the left of the last column .",
    "see figure  [ mapg ] for an example .",
    ".,width=566 ]    [ propg ] the map @xmath463 is a bijection and @xmath455 .",
    "clearly , every step of @xmath292 is invertible . to see that ne is preserved , it suffices to show that it is preserved in each step of @xmath292 , when one column is moved from left to right .",
    "first note that @xmath464 .",
    "this follows from the fact that the 1 s in the first column of @xmath58 form @xmath465 ne chains from top to bottom , while the 1 s in the last column of @xmath461 form @xmath465 ne chains from bottom to top and the remaining parts of @xmath58 and @xmath461 are essentially equal .",
    "the numbers of ne chains in @xmath27 and @xmath257 respectively made of at least one 1 which is outside of @xmath58 and @xmath461 respectively are equal because each step of @xmath292 preserves the row and column sums .",
    "let @xmath290 denote the foata - type bijection described in section  [ stack ] .",
    "for a general moon polyomino @xmath27 the map @xmath466 is a bijection with the property @xmath467    the maps @xmath291 and @xmath292 permute the columns of @xmath27 together with the corresponding number of 1 s , while @xmath290 preserves the column sums .",
    "moreover , all three of them preserve the empty rows .",
    "therefore , @xmath468 is indeed a map from @xmath50 to itself .",
    "finally ,   follows from proposition  [ propf ] , proposition  [ propg ] , and theorem  [ thmphi ] .",
    "the authors would like to thank ira gessel  @xcite for suggesting a connection between the enumeration of permutations by major index and the theory of @xmath239-partitions .",
    "to show that the map @xmath329 is a bijection , it suffices to describe the inverse of the algorithm @xmath303 .",
    "first , we need to determine what @xmath310 and @xmath311 were . for that we use the following properties of @xmath303 .    1",
    ".   [ r21 ] when @xmath318 stops , the pointer @xmath321 is at the lowest row of @xmath310 pointing at a right @xmath46-cell @xmath359 .",
    "the algorithm @xmath325 does not change the cell @xmath359 and when the whole algorithm @xmath303 terminates , there is no @xmath46-cell below @xmath312 that together with it forms an ne chain .",
    "[ r22 ] after performing @xmath325 , all the right @xmath46-cells in @xmath311 have at least one @xmath46-cell below them with which they form an ne chain .",
    "if @xmath311 was nonempty then , after performing @xmath303 , the lowest row of @xmath311 contains a left @xmath46-cell .",
    "[ borrowing ] if any borrowing occurred and the right cell @xmath469 and the left cell @xmath470 were swapped , then right after this step the cell @xmath314 is a right @xmath46-cell in @xmath310 which forms an ne chain with a left @xmath46-cell from @xmath311 and this is the lowest @xmath46-cell in @xmath310 with this property .    therefore , if @xmath306 has no left @xmath46-cells then @xmath471 . otherwise , find the lowest right @xmath46-cell @xmath354 in @xmath306 such that there is no @xmath46-cell in @xmath306 below it that together with @xmath354 forms an ne chain . then , by properties  [ r21 ] and  [ r22 ] all the nonempty rows in @xmath306 below @xmath354 are in @xmath311 .",
    "if there is no @xmath46-cell @xmath354 with that property , then @xmath311=@xmath306 .",
    "suppose @xmath257 is a filling obtained by applying the algorithm @xmath303 to the filling @xmath293 .",
    "next we show that by applying @xmath472 and @xmath473 to @xmath257 one obtains the filling @xmath27",
    ".    steps ( ib@xmath4751 ) and ( ib@xmath4752 ) clearly invert the steps ( c@xmath4752 ) and ( c@xmath4751 ) , respectively . immediately after the borrowing step in @xmath325 , by lemma  [ prop ] , ( b ) and ( c ) , and property  [ borrowing ] , we can conclude that borrowing has been performed if and only if there is a right @xmath46-cell in @xmath474 which forms an ne chain with a left @xmath46-cell from @xmath311 and does not form an ne chain with any left cells in @xmath310 .",
    "it is clear that step ( id@xmath475 ) detects whether there was any borrowing and inverts it if it occurred .",
    "so , the first algorithm @xmath472 is indeed the inverse of @xmath325 .    in @xmath473 , when @xmath320 points to a left @xmath46-cell we need to invert either ( b1 ) or ( b2.3 ) . using lemma  [ prop ] ( c )",
    "one sees that step ( ib1 ) detects exactly which of ( b1 ) and ( b2.3 ) occurred and inverts it .",
    "if @xmath320 points to a right cell , it is clear that ( ib2.1 ) and ( ib2.2 ) invert the steps ( b2.1 ) and ( b2.2 ) of @xmath318 .",
    "moreover , if both @xmath321 and @xmath320 point to right @xmath46-cells , and there is no left @xmath46-cell above them , then clearly the algorithm @xmath473 leaves them unchanged .",
    "that is , the algorithm @xmath473 preserves all rows that are above the rows in @xmath310 .",
    "therefore , we have @xmath476 this implies that @xmath477 is injective .",
    "since @xmath50 is finite , it follows that @xmath303 is bijective .",
    "chen , i. gessel , c.h .",
    "yan , a.l.b .",
    "yang , a major index for matchings and set partitions , j. combin",
    ". theory ser . a 115 ( 2008 )",
    "10691076 . a longer version containing a bijective proof is on arxiv : math/0701096 .",
    "i.  gessel , applications of quasi - symmetric functions and noncommutative symmetric functions in permutation enumeration , talk presented at the canadian mathematical society winter meeting 2008 , and private communication ."
  ],
  "abstract_text": [
    "<S> we propose a major index statistic on 01-fillings of moon polyominoes which , when specialized to certain shapes , reduces to the major index for permutations and set partitions . </S>",
    "<S> we consider the set @xmath0 of all 01-fillings of a moon polyomino @xmath1 with given column sum @xmath2 whose empty rows are @xmath3 , and prove that this major index has the same distribution as the number of north - east chains , which are the natural extension of inversions ( resp . </S>",
    "<S> crossings ) for permutations ( resp . set partitions ) . </S>",
    "<S> hence our result generalizes the classical equidistribution results for the permutation statistics inv and maj . </S>",
    "<S> two proofs are presented . </S>",
    "<S> the first is an algebraic one using generating functions , and the second is a bijection on 01-fillings of moon polyominoes in the spirit of foata s second fundamental transformation on words and permutations . </S>"
  ]
}