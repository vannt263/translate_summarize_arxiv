{
  "article_text": [
    "the main problem that has motivated the study in this paper is _ approximate range counting_. in a typical example , one is given a set @xmath1 of points in the plane , and the goal is to preprocess @xmath1 into a data structure which supports efficient approximate counting of the number of points of @xmath1 that lie inside a query halfplane .",
    "the hope is that approximate counting can be done more efficiently than exact counting .",
    "this is an instance of a more general and abstract setting . in general , we are given a _ range space _ @xmath2 , where @xmath3 is a set of @xmath4 objects and @xmath5 is a collection of subsets of @xmath3 , called _",
    "ranges_. in a typical geometric setting , @xmath3 is a subset of some infinite ground set @xmath6 ( e.g. , @xmath7 and @xmath3 is a finite point set in @xmath8 ) , and @xmath9{0cm}{0.4cm}}\\right . } } \\right\\}}$ ] , where @xmath10 is a collection of subsets ( _ ranges _ ) of @xmath6 of some simple shape , such as halfspaces , simplices , balls , etc .",
    "( to simplify the notation , we will use @xmath5 and @xmath10 interchangeably . ) the _ measure _ of a range @xmath11 in @xmath3 is the quantity @xmath12 given @xmath2 as above , and a parameter @xmath13 , the goal is to preprocess @xmath3 into a data structure that supports efficient queries of the form : given @xmath14 , compute a number @xmath15 such that @xmath16 we refer to the estimate @xmath17 as an _",
    "@xmath18-approximate count _ of @xmath19 .",
    "the motivation for seeking approximate range counting techniques is that exact range counting ( i.e. , computing the exact value @xmath20 , for @xmath21 ) is ( more ) expensive .",
    "for instance , consider the classical _ halfspace range counting _",
    "problem @xcite , which is the main application considered in this paper . here , for a set @xmath1 of @xmath4 points in @xmath8 , for @xmath22 , the best known algorithm for exact halfspace range counting with near - linear storage takes @xmath23 time @xcite . as shown in several recent papers , if we only want to approximate the count , as in eq .",
    "( [ equation : guarantee ] ) , there exist faster solutions , in which the query time is close to @xmath24 ( and is polylogarithmic in two and three dimensions ) @xcite .",
    "notice that the problem of approximate range counting becomes more challenging as the size of @xmath19 decreases . at the extreme ,",
    "when @xmath25 , we must produce the count _",
    "exactly_. in particular , we need to be able to detect ( without any error ) whether a given query range @xmath26 is _ empty _ , i.e. , satisfies @xmath27 .",
    "thus , approximate range counting ( in the sense defined above ) is at least as hard as range emptiness detection .",
    "we make the standard assumption that the range space @xmath2 ( or , in fact , @xmath28 ) has _ finite vc - dimension _",
    "@xmath29 , which is a constant independent of @xmath4 .",
    "this is indeed the case in many geometric applications . in general , range spaces involving semi - algebraic ranges of _ constant description complexity _ , i.e. , semi - algebraic sets defined as a boolean combination of a constant number of polynomial equations and inequalities of constant maximum degree , have finite vc - dimension .",
    "halfspaces , balls , ellipsoids , simplices , and boxes are examples of ranges of this kind ; see @xcite for definitions and more details .",
    "[ [ known - notions - of - approximations . ] ] known notions of approximations .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    a standard and general technique for tackling the approximate range counting problem is to use @xmath18-approximations",
    "( absolute - error ) @xmath18-approximation _ for @xmath2 is a subset @xmath30 such that , for each @xmath11 , @xmath31 . in the general case",
    ", it is known that a random sample of size @xmath32 is an @xmath18-approximation with at least some positive constant probability  @xcite , and improved bounds are known in certain special cases ; see below for details .",
    "another notion of approximation was introduced by brnnimann_et  al . _",
    "a subset @xmath33 is a _",
    "sensitive @xmath18-approximation _ if for all ranges @xmath34 , we have @xmath35 .",
    "brnnimann_et  al . _",
    "present a deterministic algorithm for computing sensitive approximations of size @xmath36 , in deterministic time @xmath37-sample_. for given parameters @xmath38 , a sample @xmath33 is a @xmath39-sample if , for any range @xmath11 , we have @xmath40 , where @xmath41 .",
    "et  al . _",
    "gave the currently best known upper bound on the size of a sample which guarantees this property , showing that a random sample of @xmath3 of size @xmath42 is a @xmath39-sample with probability at least @xmath43 ; see below for more details .",
    "[ [ relative - pvarepsilon - approximation . ] ] relative @xmath0-approximation .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    in this paper , we consider a variant of these classical structures , originally proposed a few years ago by cohen _",
    "et  al . _",
    "@xcite , which provides _ relative - error approximations_. ideally , we want a subset @xmath30 such that , for each @xmath11 , we have @xmath44 this `` definition '' suffers however from the same syndrome as approximate range counting ; that is , as @xmath45 shrinks , the absolute precision of the approximation has to increase . at the extreme , when @xmath46 , @xmath19 must also be empty ; in general , we can not guarantee this property , unless we take @xmath47 , which defeats the purpose of using small - size @xmath18-approximations to speed up approximate counting .",
    "for this reason , we refine the definition , introducing another fixed parameter @xmath48 .",
    "we say that a subset @xmath30 is a _ relative @xmath0-approximation _ if it satisfies eq .",
    "( [ equation : rel - app ] ) for each @xmath11 with @xmath49 . for smaller ranges",
    "@xmath26 , the error term @xmath50 in eq .",
    "( [ equation : rel - app ] ) is replaced by @xmath51 .",
    "as we will shortly observe , relative @xmath0-approximations are equivalent to @xmath52-samplings , with appropriate relations between @xmath53 , @xmath18 , and @xmath54 , @xmath55 ( see theorem  [ theo : equivalent : sampling ] ) , but this new notion provides a better working definition for approximate range counting and for other applications .    [ [ known - results . ] ] known results .",
    "+ + + + + + + + + + + + + +    as shown by vapnik and chervonenkis @xcite ( see also @xcite ) , there always exist absolute - error @xmath18-approximations of size @xmath56 , where @xmath57 is an absolute constant .",
    "moreover , a random sample of this size from @xmath3 is an @xmath18-approximation with constant positive probability .",
    "this bound has been strengthened by li _",
    "et  al . _",
    "@xcite ( see also @xcite ) , who have shown that a random sample of size @xmath58 is an @xmath18-approximation with probability at least @xmath43 , for a sufficiently large ( absolute ) constant @xmath57 .",
    "( interestingly , until very recently , this result , worked out in the context of machine learning applications , does not seem to have been known within the computational geometry literature . ) @xmath18-approximations of size @xmath59 can also be constructed in deterministic time @xmath60  @xcite .    as shown in @xcite",
    ", there always exist smaller ( absolute - error ) @xmath18-approximations , of size @xmath61 where @xmath62 is the exponent of either the _ primal _ shatter function of the range space @xmath2 ( and then @xmath63 ) or the _ dual _ shatter function ( and then @xmath64 ) . the time to construct these improved @xmath18-approximations is roughly the same as the deterministic time bound of @xcite stated above , for the case of the dual shatter function . for the case of the primal shatter function ,",
    "the proof is only existential .",
    "consider next relative @xmath0-approximations .",
    "one of the contributions of this paper is to show that these approximations are in fact just an equivalent variant of the @xmath52-samplings of li _",
    "et  al . _",
    "@xcite ; see section  [ sec : relations ] . as a consequence",
    ", the analysis of @xcite implies that there exist relative @xmath0-approximations of size @xmath65 , where @xmath57 is an absolute constant .",
    "in fact , any random sample of these many elements of @xmath3 is a relative @xmath0-approximation with constant probability .",
    "success with probability at least @xmath43 is guaranteed if one samples @xmath66 elements of @xmath3 , for a sufficiently large constant @xmath57  @xcite .    to appreciate the above bound on the size of relative @xmath0-approximations , it is instructive to observe that , for a given parameter @xmath53 , any absolute error @xmath67-approximation @xmath68 will approximate `` large '' ranges ( of measure at least @xmath53 ) to within _ relative _ error @xmath18 , as in eq .",
    "( [ equation : rel - app ] ) , as is easily checked ( and the inequality for smaller ranges is also trivially satisfied ) , so @xmath68 is a relative @xmath0-approximation .",
    "however , the vapnik - chervonenkis bound on the size of @xmath68 , namely , @xmath69 , as well as the improved bound of @xcite , are larger by roughly a factor of @xmath70 than the improved bound stated above .",
    "the existence of a relative @xmath0-approximation @xmath68 provides a simple mechanism for approximate range counting : given a range @xmath21 , count @xmath71 exactly , say , by brute force in @xmath72 time , and output @xmath73 as a ( relative ) @xmath18-approximate count of @xmath19 .",
    "however , this will work only for ranges of size at least @xmath74 .",
    "aronov and sharir  @xcite show that an appropriate incorporation of relative @xmath0-approximations into standard range searching data structures yields a procedure for approximate range counting that works , quite efficiently , for ranges of any size .",
    "this has recently been extended , by sharir and shaul  @xcite , to approximate range counting with general semi - algebraic ranges .",
    "[ [ our - results . ] ] our results .",
    "+ + + + + + + + + + + +    in this paper , we present several constructions and bounds involving relative @xmath0-approximations .",
    "we first consider samplings in general range spaces of finite vc - dimension , and establish relations between several different notions of samplings , including @xmath52-samplings , relative @xmath0-approximations , and sensitive @xmath18-approximations .",
    "our main observations are :    \\(i ) the notion of @xmath0-approximation is equivalent to that of @xmath52-sample , by choosing @xmath54 to be proportional to @xmath53 and @xmath55 proportional to @xmath18 ; see theorem  [ theo : equivalent : sampling ] .",
    "\\(ii ) a sensitive @xmath75-approximation is also a relative @xmath0-approximation .",
    "\\(iii ) the result of li _ et  al . _",
    "@xcite is sufficiently powerful , so as to imply known bounds on the size of many of the different notions of samplings , including @xmath18-nets , @xmath18-approximations , sensitive @xmath18-approximations , and , as just said , relative @xmath0-approximations .",
    "some of these connections have already been noted earlier , in @xcite and in @xcite .",
    "we offer this portion of section  [ sec : relations ] as a service to the computational geometry community , which , as already noted , is not as aware of the results of @xcite and of their implications as the machine learning community .",
    "next , we return to geometric range spaces , and study two cases where one can construct relative @xmath0-approximations of smaller size .",
    "the first case involves planar point sets and halfplane ranges , and the second case involves point sets in @xmath8 , @xmath76 , and halfspace ranges . in the planar case , we show the existence , and provide efficient algorithms for the construction , of relative @xmath0-approximations of size @xmath77 .",
    "our technique also shows in this case the existence of sensitive @xmath18-approximations with improved quality of approximation .",
    "specifically , for a planar point set @xmath3 , we show that there exists a subset @xmath33 of size @xmath78 , such that , for any halfplane @xmath26 , we have @xmath79 .",
    "( this new error term is indeed an improvement when @xmath80 and is the same as the standard term otherwise . )    in the planar case , the construction is based on an interesting generalization of spanning trees with small crossing number , a result that we believe to be of independent interest . specifically , we show that any finite point set @xmath1 in the plane has a spanning tree with the following property : for any @xmath81 , any _",
    "@xmath82-shallow _ line ( a line that has at most @xmath82 points of @xmath1 in one of the halfplanes that it bounds ) crosses at most @xmath83 edges of the tree .",
    "in contrast , the classical construction of welzl @xcite ( see also  @xcite ) only guarantees this property for @xmath84 ; i.e. , it yields the uniform bound @xmath85 on the crossing number .",
    "we refer to such a tree as a _ spanning tree with low relative crossing number _ , and show how to use it in the construction of small - size relative @xmath0-approximations .",
    "things are more complicated in three ( and higher ) dimensions . we were unable to extend the planar construction of spanning trees with low relative crossing number to @xmath86 ( nor to higher dimensions ) , and this remains an interesting open problem .",
    "( we give a counterexample that indicates why the planar construction can not be extended `` as is '' to 3-space . ) instead , we base our construction on the shallow partition theorem of matouek@xcite , and construct a set @xmath68 of size @xmath87 , which yields an absolute approximation error of at most @xmath51 for halfspaces that contain _ at most _ @xmath74 points .",
    "note that this is the `` wrong '' inequality  to guarantee small relative error we need this to hold for all ranges with _ at least _",
    "@xmath74 points . to overcome this difficulty",
    ", we construct a _ sequence _ of approximation sets , each capable of producing a relative @xmath18-approximate count for ranges that have roughly a fixed size , where these size ranges grow geometrically , starting at @xmath74 and ending at roughly @xmath4 .",
    "the sizes of these sets decrease geometrically , so that the size of the first set ( that caters to ranges with about @xmath74 points ) , which is @xmath87 , dominates asymptotically the overall size of all of them .",
    "we output this sequence of sets , and show how to use them to obtain an @xmath18-approximate count of any range with at least @xmath74 points .",
    "the situation is somewhat even more complicated in higher dimensions .",
    "the basic approach used in the three - dimensional case can be extended to higher dimensions , using the appropriate version of the shallow partition theorem . however , the bounds get somewhat more complicated , and apply only under certain restrictions on the relationship between @xmath18 and @xmath53 .",
    "we refer the reader to section  [ sec : higher ] , where these bounds and restrictions are spelled out in detail .",
    "the paper is organized as follows : in section  [ sec : relations ] we survey the sampling notions mentioned above , and show how they relate to each other . in section  [ sec : plane ] , we describe how to build a small relative @xmath0-approximation in the planar case , by first showing how to construct a spanning tree with low relative crossing number . in section  [ sec : higher : sec ] , we extend the result to higher dimensions . in section  [ sec : approximate : counting ] , we revisit the problems of halfplane and 3-dimensional halfspace approximate range counting , and provide algorithms whose query time is faster than those in the previous algorithms .",
    "this section is somewhat independent of the rest of the paper , although we do use relative @xmath0-approximations for the 3-dimensional case .",
    "we conclude in section  [ sec : conclusions ] with a brief discussion of the results and with some open problems .",
    "[ sec : relations ]    in this section we study relationships between several commonly used notions of samplings in abstract range spaces . in particular , we show that many of these notions are variants or special cases of one another .",
    "combined with the powerful result of li _",
    "et  al . _",
    "@xcite , this allows us to establish , or re - establish , for each of these families of samplings , upper bounds on the size of samples needed to guarantee that they belong to the family ( with constant or with high probability ) .",
    "[ [ definitions . ] ] definitions .",
    "+ + + + + + + + + + + +    we begin by listing the various kinds of samplings under consideration . in what follows , we assume that @xmath2 is an arbitrary range space of finite vc - dimension @xmath29 .    for a given parameter @xmath13",
    ", a subset @xmath33 is an _",
    "@xmath18-net _ for @xmath2 if @xmath88 , for every @xmath11 such that @xmath89 .    for a given parameter @xmath13",
    ", a subset @xmath33 is an _",
    "@xmath18-approximation _ for @xmath2 if , for each @xmath11 , we have @xmath90 .    for given parameters @xmath91 , a subset @xmath92 is a _ relative @xmath0-approximation _ for @xmath2 if , for each @xmath11 , we have    a.   @xmath93 , if @xmath94",
    ". b.   @xmath95 , if @xmath96 .    for a given parameter @xmath97 ,",
    "a subset @xmath33 is a _",
    "sensitive @xmath18-approximation _ for @xmath2 if , for each @xmath11 , we have @xmath98",
    ".    finally , for a parameter @xmath99 , consider the distance function between nonnegative real numbers @xmath100 and @xmath101 , given by @xmath102 @xmath103 satisfies the triangle inequality  @xcite , and is thus a metric ( the proof is straightforward albeit somewhat tedious ) .    for given parameters @xmath104 and @xmath99 , a subset @xmath105 is a _",
    "@xmath39-sample _ for @xmath2 if , for each range @xmath11 , we have @xmath106 .",
    "( note that @xmath107 is uninteresting , because @xmath108 is always at most @xmath109 . )",
    "[ [ equivalence - of - relative - pvarepsilon - approximations - and - nualpha - samples . ] ] equivalence of relative @xmath0-approximations and @xmath52-samples .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we begin the analysis with the following easy properties .",
    "the first property is a direct consequence of the definition of @xmath108 .",
    "let @xmath110 be non - negative real numbers , with @xmath111 .",
    "then @xmath112 if and only if @xmath113    for any non - negative real numbers , @xmath114 , with @xmath115 , put @xmath116 then we have :    \\(i ) if @xmath117 then @xmath112 .",
    "\\(ii ) if @xmath118 then @xmath119 .",
    "[ cor : d : nu : as : interval ]    if @xmath120 is a @xmath39-sample for @xmath2 , and @xmath121 is a @xmath39-sample for @xmath122 , then @xmath68 is a @xmath123-sample for @xmath2 .    [",
    "lemma : transitive : sample ]    an immediate consequence of the triangle inequality for @xmath124 .",
    "the following theorem is one of the main observations in this section .",
    "let @xmath2 be a range space as above .",
    "a.   if @xmath33 is a @xmath39-sample for @xmath2 , with @xmath125 and @xmath126 , then @xmath68 is a relative @xmath127-approximation for @xmath2 .",
    "b.   if @xmath68 is a relative @xmath52-approximation for @xmath2 , with @xmath128 and @xmath126 then @xmath68 is a @xmath52-sample for @xmath2 .",
    "[ theo : equivalent : sampling ]    \\(i ) by corollary  [ cor : d : nu : as : interval](ii ) , we have , for each @xmath21 , @xmath129 thus , if @xmath130 then @xmath131 , and if @xmath132 then @xmath133 , establishing the claim .",
    "\\(ii ) if @xmath130 then @xmath134 which implies , by corollary  [ cor : d : nu : as : interval](i ) , that @xmath135 .    if @xmath132 then @xmath136 and the claim follows .    for a range space @xmath2 ,",
    "if @xmath120 is a relative @xmath52-sample for @xmath2 , and @xmath121 is a relative @xmath39-sample for @xmath122 , with @xmath137 and @xmath126 , then @xmath68 is a relative @xmath138-approximation for @xmath2 .",
    "[ cor:29iii ]    by theorem  [ theo : equivalent : sampling](ii ) and lemma  [ lemma : transitive : sample ] , @xmath68 is a @xmath139-sample for @xmath2 . by theorem  [ theo :",
    "equivalent : sampling](i ) , it is then a relative @xmath140-approximation for @xmath2 .",
    "we next recall the bound established in @xcite , and then apply it to theorem  [ theo : equivalent : sampling ] . specifically ,",
    "we have :    \\(i ) * ( li _ et  al . _",
    "@xcite ) * a random sample of @xmath3 of size @xmath141 for an appropriate absolute constant @xmath57 , is a @xmath52-sample for @xmath2 with probability at least @xmath43 .",
    "\\(ii ) consequently , a random sample of @xmath3 of size @xmath142 for another absolute constant @xmath143 , is a relative @xmath0-approximation for @xmath2 with probability at least @xmath43 .",
    "[ theo : l : l : s ]    we next observe that @xmath18-nets and @xmath18-approximations are special cases of @xmath52-samples , where the second observation has already been made in @xcite .",
    "the bound on the size of @xmath52-samples ( theorem  [ theo : l : l : s](i ) ) then implies the known bounds on the size of @xmath18-nets ( see @xcite ) and of @xmath18-approximations ( see @xcite ) .",
    "specifically , we have :    let @xmath2 be a range space , as above , and let @xmath144 .",
    "a.   for any @xmath145 and @xmath146 , a @xmath52-sample from @xmath147 is an @xmath18-net for @xmath2 .",
    "consequently , a random sample of @xmath3 of size @xmath148 , with an appropriate choice of the constant of proportionailty , is an @xmath18-net for @xmath2 with probability at least @xmath43 .",
    "b.   if @xmath149 and @xmath150 , then a @xmath52-sample from @xmath147 is an @xmath18-approximation for @xmath2 .",
    "consequently , a random sample of @xmath3 of size @xmath151 , with an appropriate choice of the constant of proportionailty , is an @xmath18-approximation for @xmath2 with probability at least @xmath43 .",
    "[ theo : carnival ]    \\(i ) we need to rule out the possibility that , for some range @xmath21 , we have @xmath152 and @xmath153 .",
    "since @xmath68 is an @xmath154-sample , we must then have @xmath155 which is impossible , since the fraction is at least @xmath156 .",
    "\\(ii ) with this choice of parameters , we have , for any range @xmath21 , @xmath157 as desired .",
    "as noted , the bounds on the sample sizes follow theorem  [ theo : l : l : s](i ) .",
    "we also note the following ( weak ) converse of theorem  [ theo : carnival](ii ) : if @xmath92 is an @xmath158-approximation for @xmath2 then @xmath68 is a @xmath52-sample for @xmath2 .",
    "indeed , we have already noted in the introduction that an @xmath158-approximation for @xmath2 is also a relative @xmath52-approximation , so the claim follows by theorem  [ theo : equivalent : sampling](ii ) .",
    "this is a weak implication , though , because , as already noted in the introduction , the bound that it implies on the size of @xmath52-samples is weaker than that given in @xcite ( see theorem  [ theo : l : l : s ] ( i ) ) .    [ [ sensitive - approximations . ] ] sensitive approximations .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + +    we next show that the existence of sensitive @xmath18-approximations of size @xmath159 can also be established using @xmath52-samples .",
    "the proof is slightly trickier than the preceding ones , because it uses the fact that a sample of an appropriate size is ( with high probability ) a @xmath160-sample , for an entire sequence of pairs @xmath160 .",
    "the bound yielded by the following theorem is in fact ( slightly ) better than the bound established by @xcite , as mentioned in the introduction .",
    "let @xmath2 be a range space , as above , and let @xmath144 . a random sample from @xmath3 of size @xmath161 is a sensitive @xmath18-approximation , with probability @xmath162 .",
    "[ theo : sensitive ]    put @xmath163 , @xmath164 , for @xmath165 .",
    "note that @xmath166 for each @xmath167 .",
    "let @xmath68 be a random sample of size @xmath168 theorem  [ theo : l : l : s ] implies that , with an appropriate choice of the constant of proportionality , the following holds : for each @xmath167 , @xmath68 is a @xmath160-sample , with probability at least @xmath169 .",
    "hence , with probability at least @xmath170 , @xmath68 is a @xmath160-sample for every @xmath167 .",
    "now consider any range @xmath11 , and put @xmath171 , @xmath172 .",
    "let @xmath167 be the index satisfying @xmath173 .",
    "assume first that @xmath174 , so we have @xmath175 , and thus @xmath176 since @xmath68 is a @xmath160-sample , we have @xmath177 if @xmath178 then this implies @xmath179 so sensitivity holds in this case . otherwise , if @xmath180 , then @xmath181 since @xmath182 .",
    "hence , by eq .",
    "( [ equation : stupid ] ) , we have @xmath183 so sensitivity holds in this case too .",
    "finally , assume @xmath184 , so @xmath185 .",
    "in this case we have @xmath186 if @xmath187 then @xmath188 as required . if @xmath189 then we have @xmath190 showing that sensitivity holds in all cases .",
    "it is ineresting to note that the bound on the size of sensitive @xmath18-approximations can not be improved ( for general range spaces with bounded vc - dimension ) .",
    "this is because a sensitive @xmath18-approximation is also an @xmath191-net , and there exist range spaces ( of any fixed vc - dimension @xmath29 ) for which any @xmath191-net must be of size @xmath192 @xcite .",
    "[ [ from - sensitive - to - relative - approximations . ] ] from sensitive to relative approximations .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    our next observation is that sensitive approximations are also relative approximations , with an appropriate calibration of parameters . in a way , this can be regarded as a converse of theorem  [ theo : sensitive ] , which shows that a set which is simultaneously a relative approximation ( i.e. , a @xmath193-sample ) for an entire appropriate sequence of pairs of parameters is a sensitive approximation .",
    "specifically , we have :    let @xmath194 be given parameters , and set @xmath195 . then , if @xmath92 is a sensitive @xmath196-approximation for @xmath2 , it is also a relative @xmath0-approximation for @xmath2 .",
    "[ theo : sensitive : to : relative ]    we are given that @xmath197 for each @xmath11 .",
    "now let @xmath21 be a range with @xmath198 , that is , @xmath199 , for some @xmath107",
    ". then @xmath200 similarly , if @xmath96 , then @xmath201 hence , @xmath68 is a relative @xmath0-approximation .",
    "this observation implies that one can compute relative @xmath0-approximations efficiently , in a deterministic fashion , using the algorithms in @xcite for deterministic construction of sensitive approximations .",
    "we thus obtain the following result .",
    "let @xmath202 be a range space with finite vc - dimension @xmath29 , where @xmath203 , and let @xmath204 be given parameters .",
    "then one can construct a relative @xmath0-approximation for @xmath2 of size @xmath205 , in @xmath206 deterministic time .",
    "[ lemma : r : e : build ]",
    "[ sec : plane ]    in this section , we present a construction of smaller - size relative @xmath0-approximations for the range space involving a set of points in the plane and halfplane ranges",
    ". the key ingredient of the construction is the result of the following subsection , interesting in its own right .",
    "we derive a refined `` weight - sensitive '' version of the classical construct of _ spanning trees with small crossing number _ , as obtained by chazelle and welzl  @xcite , with a simplified construction given in @xcite .",
    "we believe that this refined version is of independent interest , and expect it to have additional applications .    in accordance with standard notation used in the literature ,",
    "we denote from now on the underlying point set by @xmath1 .",
    "we first recall the standard result :    let @xmath1 be a set of @xmath4 points in @xmath8 .",
    "then there exists a straight - edge spanning tree @xmath207 of @xmath1 such that each hyperplane in @xmath8 crosses at most @xmath23 edges of @xmath207 .",
    "[ theo : crossing ]    let @xmath1 be a set of @xmath4 points in the plane .",
    "for a line @xmath208 , let @xmath209 ( resp . ,",
    "@xmath210 ) be the number of points of @xmath1 lying above ( resp . , below or on ) @xmath208 , and define the _ weight _ of @xmath208 , denoted by @xmath211 , to be @xmath212 .",
    "let @xmath213 be the intersection of all closed halfplanes that contain at least @xmath214 points of @xmath1 .",
    "note that , by the centerpoint theorem ( see @xcite ) , @xmath215 is not empty for @xmath216 .",
    "moreover , @xmath215 is a convex polygon , since it is equal to the intersection of a finite number of halfplanes .",
    "( indeed , it is equal to the intersection of all halfplanes containing at least @xmath214 points of @xmath1 and bounded by lines passing through a pair of points of @xmath1 . )",
    "the region @xmath215 can be interpreted as a level set of the _ tukey depth _ induced by @xmath1 ; see @xcite .",
    "let @xmath1 be a set of @xmath4 points in the plane .",
    "( i ) any line @xmath208 that avoids the interior of @xmath215 has weight @xmath217 .",
    "( ii ) any line @xmath208 that intersects the interior of @xmath215 has weight @xmath218 .",
    "[ lemma : weight : line ]    \\(i ) translate @xmath208 in parallel until it supports @xmath215 . the new line @xmath219 must pass through a vertex @xmath220 of @xmath215 which is the intersection of two lines bounding two respective closed halfplanes , each having @xmath82 points in its complement . thus , the union of the complements of these two halfplanes contains at most @xmath221 points , and it contains @xmath219 and @xmath208 .",
    "thus , @xmath208 has at most @xmath221 points on one of its sides .",
    "\\(ii ) the second claim is easy : if the weight of @xmath208 were at most @xmath82 then , by definition , the interior of @xmath215 would be completely contained on one side of @xmath208 .",
    "the set @xmath222 can be covered by pairwise openly disjoint triangles @xmath223 , each containing at most @xmath221 points of @xmath224 , such that _ any _ line intersects at most @xmath225 of these triangles .",
    "moreover , @xmath226 , for each @xmath227 .",
    "[ lemma : cover ]    we construct polygons @xmath228 iteratively , as follows .",
    "let @xmath229 and @xmath230 be the two vertical lines supporting @xmath215 on its left and on its right , respectively .",
    "the polygon @xmath231 ( resp . , @xmath232 ) is the halfplane to the left ( resp .",
    ", right ) of @xmath229 ( resp . , @xmath230 ) .",
    "the construction maintains the invariant that the complement of the union of the polygons @xmath233 constructed so far is a convex polygon @xmath234 that contains @xmath215 and each edge of the boundary of @xmath234 passes through some vertex of @xmath215 , so that @xmath235 consists of pairwise disjoint connected `` pockets '' .",
    "( initially , after constructing @xmath231 and @xmath232 , we have two pockets  the regions lying respectively above and below @xmath215 , between @xmath229 and @xmath230 . )     and the decomposition of its complement . ]",
    "each step of the construction picks a pocket that contains more than @xmath221 points of @xmath1 , finds a line @xmath208 that supports @xmath215 at a vertex of the pocket , and subdivides the pocket into two sub - pockets and a third piece that lies on the other side of @xmath208 .",
    "the line @xmath208 is chosen so that the two resulting sub - pockets contain an equal number of points of @xmath1 . the third piece , which clearly contains at most @xmath221 points of @xmath1 ( see lemma  [ lemma : weight : line ] ) , is taken to be the next polygon @xmath236 , and the construction continues in this manner until each pocket has at most @xmath221 points .",
    "we refer to the polygons @xmath237 constructed up to this point as _ non - terminal_. we then terminate the construction , adding all the pockets to the output collection of polygons , referring to them as _ terminal _ polygons . note that each non - terminal @xmath228 is a ( possibly unbounded ) triangle , having a `` base '' whose relative interior passes through a vertex of @xmath215 , and two other sides , each of which is a portion of a base of an earlier triangle .",
    "the terminal polygons are _ pseudo - triangles _",
    ", each bounded by two straight edges and by a `` base '' which is a connected portion of the boundary of @xmath215 , possibly consisting of several edges . see figure  [ cuts ] .",
    "we claim that each line @xmath208 intersects at most @xmath238 polygons . for this , define the _ weight _ @xmath239 of a non - terminal polygon @xmath228 , for @xmath240 , to be the number of points of @xmath1 in the pocket that was split when @xmath228 was created ; the weight of each terminal polygon is the number of points of @xmath1 that it contains , which is at most @xmath221 .",
    "define the _ level _ of @xmath228 to be @xmath241 .",
    "it is easily checked that @xmath208 crosses at most two terminal polygons ( two if it crosses @xmath215 and at most one if it misses @xmath215 ) , and it can cross both ( non - base ) sides of at most one ( terminal or non - terminal ) polygon .",
    "any other polygon @xmath228 crossed by @xmath208 is such that @xmath208 enters it through its base , reaching it from another polygon whose level is , by construction , strictly smaller than that of @xmath228 .",
    "since there are only @xmath242 distinct levels , the claim follows .",
    "it is easy to verify that the convex hulls @xmath243 are triangles with pairwise disjoint interiors , which have the required properties .",
    "let @xmath244 be a prespecified parameter .",
    "one can construct a spanning tree @xmath207 for @xmath245 , such that each line intersects at most @xmath246 edges of @xmath207 .",
    "[ lemma : level : k ]    construct the decomposition of @xmath222 into @xmath247 covering triangles @xmath248 , using lemma  [ lemma : cover ] .    for each @xmath227",
    ", construct a spanning tree @xmath249 of @xmath250 with crossing number @xmath251 , using theorem  [ theo : crossing ] .",
    "in addition , connect one point of @xmath250 to an arbitrary vertex of @xmath252 .",
    "since @xmath253 and @xmath254 are disjoint , for @xmath255 , it follows that no pair of edges of any pair of ( the plane embeddings of the ) trees among @xmath256 cross each other .",
    "let @xmath257 be the planar straight - line graph formed by the union of @xmath258 , plus the connecting segments just introduced , and let @xmath259 be a spanning tree of @xmath257 ; the vertex set of @xmath259 contains @xmath222 .",
    "let @xmath208 be a line in the plane .",
    "the proof of the preceding lemma implies that @xmath208 intersects at most @xmath238 of the polygons @xmath260 .",
    "hence , @xmath208 crosses at most two edges of @xmath261 , at most @xmath262 of the connecting segments , and it can cross edges of at most @xmath262 trees @xmath249 , for @xmath227 . since @xmath208 crosses at most @xmath251 edges of each such tree , we conclude that @xmath208 crosses at most @xmath246 edges of @xmath259 .    finally , we get rid of the extra `` steiner vertices '' of @xmath259 ( those not belonging to @xmath222 ) in a straightforward manner , by making @xmath259 a rooted tree , at some point of @xmath222 , and by replacing each path connecting a point @xmath263 to an ancestor @xmath264 , where all inner vertices of the path are steiner points , by the straight segment @xmath265 .",
    "this produces a straight - edge spanning tree @xmath207 of @xmath222 , whose crossing number is at most that of @xmath259 .    given a set @xmath1 of @xmath4 points in the plane , one can construct a spanning tree @xmath207 for @xmath1 such that any line @xmath208 crosses at most @xmath266 edges of @xmath207 . the tree @xmath207 can be constructed in @xmath267 ( deterministic ) time , for any fixed @xmath144 .",
    "[ theo : good : partition ]    we construct a sequence of subsets of @xmath1 , as follows .",
    "put @xmath268 . at the @xmath167thstep , @xmath269 ,",
    "consider the polygon @xmath270 , and let @xmath271 .",
    "we stop when @xmath272 becomes empty . by construction ,",
    "the @xmath167th step removes at least @xmath273 points from @xmath274 , so @xmath275 , and the process terminates in @xmath276 steps . for each @xmath167 , construct a spanning tree @xmath249 for @xmath277 , using lemma  [ lemma : level : k ] ( with @xmath278 ) .",
    "connect the resulting trees by straight segments into a single spanning tree @xmath207 of @xmath1 .",
    "we claim that @xmath207 is the desired spanning tree .",
    "indeed , consider an arbitrary line @xmath208 of weight @xmath82 .",
    "observe that @xmath208 can not cross any of the polygons @xmath279 , for @xmath280 , since any line that crosses such a polygon must be of weight at least @xmath281 , by lemma  [ lemma : weight : line](ii ) .",
    "thus @xmath208 crosses only the first @xmath6 layers of our construction .",
    "hence , the number of edges of @xmath207 that @xmath208 crosses is at most @xmath282 as is easily verified .",
    "this establishes the bound on the crossing number of @xmath283 .",
    "[ [ running - time . ] ] running time .",
    "+ + + + + + + + + + + + +    computing @xmath279 can be done in the dual plane , by constructing the convex hulls of the levels @xmath273 and @xmath284 in the arrangement of the lines dual to the points of @xmath274 .",
    "we use the algorithm of matouek  @xcite , which constructs the convex hull of a level in @xmath285 time , for a total of @xmath286 time .",
    "this also subsumes the time needed to construct @xmath272 from @xmath274 , for all @xmath167 .",
    "next , we carry out the constructive proof of lemma  [ lemma : cover ] for @xmath287 , which can be implemented to run in @xmath288 time .",
    "finally , for each set in the cover , we apply the algorithm of @xcite to construct the corresponding subtree with low crossing number .",
    "this takes @xmath289 time for a set of size @xmath290 , for any fixed @xmath144 .",
    "we continue in this fashion , as described in the first part of the proof .",
    "it is now easy to verify that the resulting construction takes overall @xmath267 time , for any fixed @xmath144 .",
    "the main technical step in the construction of theorem  [ theo : good : partition ] is the partition of the set of _",
    "points of @xmath1 , namely , those that are contained in some halfplane with at most @xmath82 points of @xmath1 , into subsets , each containing at most @xmath221 points , so that any line crosses the convex hulls of at most @xmath291 of these subsets .",
    "it is natural to try to extend this construction to three ( or higher ) dimensions .",
    "however , as we show next , there are examples of point sets in @xmath86 where no such partition exists , even when the points are in convex position .    to see this , let @xmath290 be an integer , and put @xmath292 .",
    "define @xmath293 that is , @xmath1 is the set of the vertices of the @xmath294 integer grid in the @xmath295-plane , lifted to the standard ( convex ) paraboloid @xmath296 .",
    "thus , all points of @xmath1 are in convex position ( and are thus @xmath109-shallow ) .",
    "let @xmath297 be an arbitrary parameter , and consider any partition @xmath298 of @xmath1 into @xmath299 sets , where @xmath300 , for @xmath227 .",
    "let @xmath260 denote the two - dimensional convex hull of the projection of @xmath279 onto the @xmath295-plane , for @xmath301 .",
    "the sum of the @xmath302-span and the @xmath303-span of @xmath260 is at least @xmath304 ( or else there would be no room for @xmath279 to contain all its points ) .",
    "hence , the total length of these spans of @xmath248 is at least @xmath305 .",
    "consider the @xmath306 vertical planes @xmath307 , and @xmath308 .",
    "clearly , the overall number of intersection points between the boundaries of the @xmath260 s and these planes is proportional to the sum of their @xmath302-spans and @xmath303-spans .",
    "hence , there is a plane in this family that intersects @xmath309 sets among @xmath248 , and thus it intersects the @xmath310 corresponding convex hulls among @xmath311 .",
    "note that a similar argument can be applied to the set of the vertices of the @xmath312 integer lattice . in this case , for any partition of this set of the above kind , there always exists a plane that crosses the convex hulls of at least @xmath313 of the subsets .",
    "( this matches the upper bound in the partition theorem of matouek  @xcite . ) of course , here , ( most of ) the points are not shallow .    to summarize , there exist sets @xmath1 of @xmath4 points in convex position in 3-space ( so they are all @xmath109-shallow ) , such that any partition of @xmath1 into sets of size ( roughly ) @xmath82 will have a plane that crosses at least @xmath314 sets in the partition .",
    "( without the convex position , or shallowness , assumption , there exist sets for which this crossing number is at least @xmath313 . ) we do not know whether this lower bound is worst - case tight .",
    "that is , can a set @xmath1 of @xmath4 @xmath82-shallow points in 3-space be partitioned into @xmath315 subsets , so that no plane separates more than @xmath316 subsets ?",
    "if this were the case , applying the standard construction of spanning trees with small crossing numbers to each subset would result in a spanning tree with crossing number @xmath317 .",
    "note that this still leaves open the ( more modest ) possibility of a partition which is `` depth sensitive '' , that is , a partition into subsets of size roughly @xmath82 , with the property that any halfspace that contains @xmath290 points crosses at most ( or close to ) @xmath318 sets in the partition .",
    "we can turn the above construction of a spanning tree with small relative crossing number into a construction of a relative @xmath0-approximation for a set of points in the plane and for halfplane ranges , as follows .",
    "let @xmath1 be a set of @xmath4 points in the plane , and let @xmath207 be a spanning tree of @xmath1 as provided in theorem  [ theo : good : partition ] .",
    "we replace @xmath207 by a perfect matching @xmath319 of @xmath1 , with the same relative crossing number , i.e. , the number of pairs of @xmath319 that are separated by a halfplane of weight @xmath82 is at most @xmath83 .",
    "this is done in a standard manner ",
    "we first convert @xmath207 to a spanning path whose relative crossing number is at most twice larger than the crossing number of @xmath207 , and then pick every other edge of the path .",
    "we now construct a coloring of @xmath1 with low discrepancy , by randomly coloring the points in each pair of @xmath319 .",
    "specifically , each pair is randomly and independently colored either as @xmath320 or as @xmath321 , with equal probability .",
    "the standard theory of discrepancy ( see @xcite ) yields the following variant .",
    "given a set @xmath1 of @xmath4 points in the plane , one can construct a coloring @xmath322 , such that , for any halfplane @xmath323 , @xmath324 the coloring is balanced ",
    "each color class consists of exactly @xmath325 points of @xmath1 .",
    "[ lemma : coloring ]    as shown in @xcite , if a halfplane @xmath323 crosses @xmath15 edges of the matching , then its discrepancy is @xmath326 , with high probability . as shown above ,",
    "@xmath327 , for @xmath328 , so the discrepancy of @xmath323 is , with high probability , @xmath329 .",
    "we need the following fairly trivial technical lemma .    for any @xmath330 , @xmath331 , and @xmath332",
    ", we have @xmath333 .",
    "[ lemma : stupid : inequality ]    observe that @xmath334 .",
    "as we next show , the improved discrepancy bound of lemma  [ lemma : coloring ] leads to an improved bound on the size of @xmath52-samples for our range space , and , consequently , for the size of relative @xmath0-approximations .    given a set @xmath1 of @xmath4 points in the plane , and parameters @xmath128 and @xmath335",
    ", one can construct a @xmath336-sample @xmath337 of size @xmath338 .",
    "[ theo : sample : half : planes ]    following one of the classical constructions of @xmath18-approximations ( see @xcite , we repeatedly halve @xmath1 , until we obtain a subset of size as asserted in the theorem , and then argue that the resulting set is a @xmath52-sample .",
    "formally , set @xmath268 , and partition @xmath274 into two equal halves , using lemma  [ lemma : coloring ] ; let @xmath272 and @xmath339 denote the two halves ( consisting of the points that are colored @xmath340 , @xmath341 , respectively ) .",
    "we keep @xmath272 , remove @xmath342 , and continue with the halving process .",
    "let @xmath343 denote the size of @xmath272 .",
    "for any halfplane @xmath323 , we have @xmath344 where @xmath57 is some appropriate constant . recalling that @xmath345 and that @xmath346 , this can be rewritten as @xmath347 since @xmath348 , we have @xmath349 since @xmath350 , we have @xmath351 applying lemma  [ lemma : stupid : inequality ] , with @xmath352 , @xmath353 , and @xmath354 , the last expression is at most @xmath355",
    "this implies that @xmath356 .",
    "the triangle inequality then implies that @xmath357 for @xmath358 .",
    "the theorem then follows by taking @xmath68 to be the smallest @xmath272 which still satisfies this size constraint .",
    "using theorem  [ theo : equivalent : sampling ] , we thus obtain :    given a set @xmath1 of @xmath4 points in the plane , and parameters @xmath13 and @xmath48 , one can construct a relative @xmath0-approximation @xmath337 of size @xmath359 .",
    "[ cor : relative : error : half : planes ]    * remark : * one can speed up the construction of the relative @xmath0-approximation of corollary  [ cor : relative : error : half : planes ] , by first drawing a random sample of slightly larger size , which is guaranteed , with high probability , to be a relative approximation of the desired kind , and then use halving to decimate it to the desired size .",
    "implemented carefully , this takes @xmath360 time , and thus produces a relative @xmath0-approximation , with high probability , of the desired size @xmath359 .",
    "in fact , the preceding analysis leads to an improved bound for sensitive approximations for our range space .",
    "the improvement is in terms of the quality of the `` sensitivity '' of the approximation , which is achieved at the cost of a slight increase ( by a sublogarithmic factor ) in its size , as compared to the standard bound , provided in theorem  [ theo : sensitive ] .",
    "that is , we have :    let @xmath1 be a set of @xmath4 points in the plane , and let @xmath361 be a parameter .",
    "one can compute a subset @xmath362 of size @xmath363 , such that for any halfplane @xmath323 , we have @xmath364 .",
    "fix parameters @xmath128 and @xmath99 , and apply the construction of theorem  [ theo : sample : half : planes ] until we get a subset @xmath68 of size @xmath365 ; the constant of proportionality will be determined by the forthcoming considerations .",
    "the key observation is that @xmath68 is a @xmath52-sample for any @xmath128 and @xmath99 that satisfy @xmath366 , because the construction is oblivious to the individual values of @xmath55 and @xmath54 , and just requires that the size of the sample remains larger than the above threshold .    using this observation",
    ", we proceed to show that @xmath68 satisfies the property asserted in the theorem .",
    "so let @xmath323 be a halfplane .",
    "suppose first that @xmath367 . by corollary  [ cor :",
    "relative : error : half : planes ] , @xmath68 is a relative @xmath368-approximation to @xmath1 , with an appropriate choice of the constant of proportionality ( note the change of roles of `` @xmath53 '' and `` @xmath18 '' ) .",
    "this implies that @xmath369 .",
    "suppose then that @xmath370 , and set @xmath371 .",
    "observe that @xmath372 thus , with an appropriate choice of the constant of proportionality for @xmath290 , @xmath68 is a relative @xmath373-approximation , which implies that @xmath374 as asserted .",
    "this compares favorably with the result of brnnimann_et  al . _",
    "@xcite , which in this case implies that there exists a subset of size @xmath375 such that , for each halfplane @xmath323 , we have @xmath376 . our bound is smaller when @xmath377 and is the same otherwise .",
    "[ sec : higher : sec ]      the construction in higher dimensions is different from the planar one , because of our present inability to extend the construction of spanning trees with low relative crossing number to three or higher dimension .",
    "for this reason we use the following different strategy .",
    "we say that a hyperplane @xmath323 _ separates _ a set @xmath378 if @xmath323 intersects the interior of @xmath379 ; that is , each of the open halfspaces that @xmath323 bounds intersects @xmath380 .",
    "the main technical step in the construction is given in the following theorem .",
    "let @xmath1 be a set of @xmath4 points in @xmath86 , and let @xmath13 , @xmath48 be given parameters .",
    "then there exists a set @xmath337 , of size @xmath381 , such that , for any halfspace @xmath323 with @xmath382 , we have @xmath383    [ theo : a3d ]    * remark : * let us note right away the difference between eq .",
    "( [ equation : a1 ] ) and the situation in the preceding sections .",
    "that is , up to now we have handled ranges of measure _ at least _",
    "@xmath53 , whereas eq .  (",
    "[ equation : a1 ] ) applies to ranges of measure _ at most _ @xmath53 .",
    "this issue requires a somewhat less standard construction , that will culminate in a _ sequence _ of approximation sets , each catering to a different range of halfspace measures .",
    "nevertheless , the overall size of these sets will satisfy the above bound , and the cost of accessing them will be small .",
    "put @xmath384 , and apply the shallow partition theorem of matouek  @xcite , to obtain a partition of @xmath1 into @xmath385 subsets @xmath386 , each of size between @xmath387 and @xmath221 , such that any _ @xmath82-shallow _",
    "halfspace @xmath323 ( namely , a halfspace that contains at most @xmath82 points of @xmath1 ) separates at most @xmath388 subsets , for some absolute constant @xmath57 .",
    "( note that if @xmath323 meets any @xmath272 , it has to separate it , because @xmath323 is too shallow to fully contain @xmath272 . ) without loss of generality , we can carry out the construction so that the size of each @xmath272 is even .",
    "we then construct , for each subset @xmath272 , a spanning tree of @xmath272 with crossing number @xmath389  @xcite , and convert it , as in the preceding section , to a perfect matching of @xmath272 , with the same asymptotic bound on its crossing number , which is the maximum number of pairs in the matching that a halfspace separates .",
    "we combine all these perfect matchings to a perfect matching of the entire set @xmath1 .    we then color each matched pair independently , as above , coloring at random one of its points by either @xmath341 or @xmath340 , with equal probabilities , and the other point by the opposite color .",
    "let @xmath390 be the set of points colored @xmath341 ; we have @xmath391 . with high probability , the discrepancy of any halfspace @xmath323 is at most @xmath392 , where @xmath393 is the crossing number of @xmath323 ( see @xcite ) ; we may assume that the coloring does indeed have this property .",
    "( if we do not care about the running time , we can verify that the constructed set has the required property , and if not regenerate it . )    hence , if @xmath323 is a @xmath82-shallow halfspace , then , by construction , @xmath394 , because @xmath323 separates @xmath395 subsets and crosses @xmath389 edges of the spanning tree of each of them .",
    "hence the discrepancy of any @xmath82-shallow halfspace @xmath323 is @xmath396 .",
    "we continue recursively in this manner for @xmath397 steps , producing a sequence of subsets @xmath398 , where @xmath399 is obtained from @xmath400 by applying the partitioning of @xcite with a different parameter @xmath401 , and then by using the above coloring procedure on the resulting perfect matching .",
    "we take @xmath402 , where @xmath403 is the constant derived in the following lemma .",
    "( the bound asserted in the lemma holds with high probability if we do not verify that our colorings have small discrepancy , and is worst - case if we do verify it . )",
    "there exists an absolute constant @xmath403 such that any @xmath74-shallow halfspace satisfies , for any @xmath404 , @xmath405 where @xmath397 is the largest index satisfying @xmath406 , where @xmath407 .",
    "[ lemma : relative : higher : dim ]    delegated to appendix  [ apnd : proof : a ] .",
    "the lemma implies that @xmath323 is @xmath408-shallow in each of the subsets @xmath409 , so we can use the above bound on the discrepancy of @xmath323 with respect to each of these subsets .",
    "( the reader can note the similarity between the forthcoming analysis and the proof of lemma  [ lemma : relative : higher : dim ] . )",
    "we thus have @xmath410 substituting @xmath411 , for each @xmath167 , and adding up the inequalities , it is easily checked that the last right - hand side dominates the sum ( compare with the analysis in the proof of theorem  [ theo : good : partition ] ) , so we obtain , using the triangle inequality , @xmath412 we choose @xmath397 to be the largest index for which this bound is at most @xmath413 .",
    "that is , @xmath414 .",
    "note that this can be rewritten as @xmath415 , which implies that @xmath406 , as required in lemma  [ lemma : relative : higher : dim ] , provided that @xmath18 is smaller than some appropriate absolute constant .",
    "hence , since @xmath397 was chosen as large as possible , the size of @xmath416 is @xmath417 taking @xmath418 completes the proof of theorem  [ theo : a3d ] .",
    "[ [ construction . ] ] construction .",
    "+ + + + + + + + + + + + +    the preceding construction used a fixed @xmath419 , and assumed that the query halfspace is _ at most _ @xmath82-shallow .",
    "however , our goal is to construct a subset that caters to all halfspaces whose measure is _ at least _ some given threshold . while unable to meet this goal exactly , with a single subset , we almost get there , in the following manner .",
    "let @xmath53 be the given threshold parameter .",
    "we consider the geometric sequence @xmath420 , where @xmath421 ; the last ( largest ) element is @xmath422 , and its index is @xmath423 .",
    "for each @xmath15 , we construct a relative @xmath424-approximation @xmath425 for @xmath1 , as in theorem  [ theo : a3d ] , where @xmath57 is a sufficiently small constant , whose value will be determined later . clearly , the overall size of all these sets is dominated by the size of the first set , namely , it is @xmath426 we output the entire sequence @xmath427 , as a substitute for a single relative @xmath0-approximation , and use it as follows .",
    "[ [ answering - a - query . ] ] answering a query .",
    "+ + + + + + + + + + + + + + + + + +    let @xmath323 be a given halfspace , so that @xmath428 .",
    "let @xmath429 be the index ( initially unknown ) for which @xmath430 .",
    "thus @xmath323 is @xmath431-shallow , and is also @xmath432-shallow , for every @xmath433 .",
    "hence , if we use the set @xmath434 , for each @xmath433 , to approximate @xmath435 , we get , by theorem  [ theo : a3d ] , a count @xmath436 , which satisfies @xmath437 . in other words",
    ", we have @xmath438for each @xmath433 .    to answer the query , we access the sets @xmath439 , in decreasing order , and find the largest index @xmath101 satisfying @xmath440 we return @xmath441 as the desired approximate count .    [ [ analysis . ] ] analysis .",
    "+ + + + + + + + +    we claim that eq .",
    "( [ equation : c : s : hold ] ) must hold at @xmath442 , assuming @xmath443 . indeed , since @xmath444 , we have @xmath445 hence , @xmath446 . on the other hand , @xmath447 . combining these two inequalities ,",
    "we obtain @xmath448 if @xmath443 , as assumed .",
    "our choice of @xmath101 thus satisfies @xmath433 .",
    "moreover , we have @xmath449 this determines @xmath435 , up to a factor of @xmath450 , which thus determines the correct index @xmath15 ( up to @xmath451 ) .",
    "in fact , as our query answering procedure actually does , we do not have to find the exact value of @xmath15 , because we use a smaller value of @xmath18 in the construction of the sets @xmath434 . specifically , with an appropriate choice of @xmath57 , we have @xmath452 , so @xmath453 and , similarly , @xmath454 so @xmath441 is an @xmath18-approximate count of @xmath455 , establishing the correctness of our procedure .",
    "( the specific choice of @xmath57 , which we do not spell out , can easily be worked out from the preceding analysis . )",
    "note that our structure also handles halfspaces @xmath323 with @xmath456 .",
    "specifically , if we find an index @xmath101 satisfying eq .",
    "( [ equation : c : s : hold ] ) then @xmath441 is an @xmath18-approximate count of @xmath455 , as the preceding analysis shows .",
    "if no such @xmath101 is found then we must have @xmath457 ( otherwise , as just argued , there would exist such an @xmath101 and the procedure would find it ) . in this case",
    "we have @xmath458 , and we return @xmath459 with the guarantee that ( a ) @xmath460 , and ( b ) @xmath458 .    note that this constitutes a somewhat unorthodox approach  we have logarithmically many sets instead of a single one ( although their combined size is asymptotically the same as that of the largest one ) , and we access them sequentially to find the one that gives the best approximation . an interesting useful feature of the construction is that , if the given halfspace @xmath323 has weight @xmath435 that satisfies @xmath461 , then the approximate counting mechanism accesses sets whose overall size is only @xmath462 .",
    "that is , the larger @xmath435 is , the faster is the procedure .    to summarize , we have shown :    given a set @xmath1 of @xmath4 points in @xmath86 , and two parameters @xmath13 , @xmath48 , we can construct @xmath463 subsets of @xmath1 , @xmath464 , of total size @xmath465 , so that , given any halfspace @xmath323 containing @xmath466 points of @xmath1 , we can find a set @xmath425 that satisfies @xmath467 the ( brute - force ) time it takes to search for @xmath425 and obtain the count @xmath468 is @xmath469      [ sec : higher ]    the preceding construction can be generalized to higher dimensions , with some complications .",
    "we first introduce the following parameters : @xmath470 note that , for @xmath471 , @xmath472 ( and tends to @xmath473 as @xmath474 increases ) , and @xmath475 ( and tends to @xmath473 as @xmath474 increases ) .",
    "the analogous version of theorem  [ theo : a3d ] is :    let @xmath1 be a set of @xmath4 points in @xmath8 , @xmath471 , and let @xmath13 , @xmath48 be given parameters .",
    "then there exists a set @xmath337 , of size @xmath476 , such that , for any @xmath74-shallow halfspace @xmath323 , we have @xmath477 provided that @xmath478 .",
    "[ theo : add ]    as above , put @xmath479 , and apply matouek s shallow partition theorem @xcite , to obtain a partition of @xmath1 into @xmath480 subsets @xmath386 , each of size between @xmath387 and @xmath221 , such that any @xmath82-shallow halfspace separates at most @xmath481 subsets , for some absolute constant @xmath57 , where @xmath482 .",
    "( as above , if @xmath323 meets any @xmath272 , it has to separate it . ) also , we may assume that the size of each @xmath272 is even .",
    "we then construct , for each subset @xmath272 , a spanning path of @xmath272 with crossing number @xmath483  @xcite , for @xmath484 , convert it to a perfect matching of @xmath272 , with the same asymptotic crossing number , and combine all these matchings to a perfect matching of @xmath1 .",
    "we then apply the same coloring scheme as in the three - dimensional case , and let @xmath390 be the set of points colored by @xmath341 ; we have @xmath485 . with high probability",
    ", the discrepancy of any halfspace @xmath323 is at most @xmath486 , where @xmath393 is the number of pairs in the matching that @xmath323 separates @xcite . if @xmath323 is @xmath82-shallow then , by construction , @xmath487 .",
    "hence the discrepancy of @xmath323 is @xmath488 we continue recursively in this manner for @xmath397 steps , producing , as above , a sequence of subsets @xmath398 , where @xmath399 is obtained from @xmath400 by applying the partitioning of @xcite with a different parameter @xmath401 , and then by using the above coloring procedure on the resulting perfect matching .",
    "we take @xmath402 , where @xmath403 is the constant derived in the following lemma .",
    "( as in the 3-dimensional case , if we want the proof of the theorem to be constructive , we either verify that each half - sample has the desired low discrepancy , and then the bounds are worst - case , or else the bounds hold with high probability . )    there exists an absolute constant @xmath403 such that any @xmath74-shallow halfspace satisfies , for any @xmath404 , @xmath405 where @xmath397 is the largest index satisfying @xmath489 , where @xmath407 .",
    "[ lemma : k : o : k : d ]    delegated to appendix  [ apnd : k : o : k : d ] .    as in the 3-dimensional case ,",
    "the lemma justifies the following chain of inequalities ( note again the similarity between the proof of the lemma and the analysis below ) . @xmath490",
    "substituting @xmath491 , for each @xmath167 , and adding up the inequalities , the last right - hand side dominates , so we obtain @xmath492 substituting @xmath419 and the values of @xmath302 and @xmath303 , this is equal to @xmath493 we choose the first @xmath397 so that this bound is at most @xmath51 .",
    "that is , @xmath494 @xmath495 we note that the choice of @xmath496 satisfies the lower bound constraint in lemma  [ lemma : k : o : k : d ] .",
    "hence , taking @xmath418 completes the proof .    *",
    "obtaining a relative approximate count * is done exactly as in the three - dimensional case , producing a sequence of approximations , and searching through the sequence for the approximation which caters for the correct range of the size of @xmath455 .",
    "we thus have the following result .",
    "given a set @xmath1 of @xmath4 points in @xmath8 , and two parameters @xmath13 , @xmath48 , we can construct @xmath463 subsets of @xmath1 , @xmath464 , of total size @xmath497 , so that , given any halfspace @xmath323 containing @xmath466 points of @xmath1 , we can find a set @xmath425 that satisfies @xmath498 the ( brute - force ) time it takes to search for @xmath425 and obtain the count @xmath468 is @xmath499    [ [ discussion . ] ] discussion .",
    "+ + + + + + + + + + +    we have two competing constructions , the `` traditional '' one , with @xmath500 elements ( see section  [ sec : relations ] ) , and the new one , with @xmath501 elements . the new construction is better , in terms of the size of the approximation , when @xmath502 ( for simplicity , we ignore the constants of proportionality ) . for further simplicity , assume that @xmath53 is not much larger than @xmath18 , so that @xmath503 and @xmath504 are roughly the same , up to some constant factor .",
    "then we replace the above condition by @xmath505 substituting the values of @xmath506 and @xmath507 , and simplifying the expressions , this is equivalent to @xmath508 this establishes a lower bound for @xmath53 , above which the new construction takes over . for example , for @xmath509 , @xmath53 has to be @xmath510 .",
    "[ sec : approximate : counting ]    in this section we slightly deviate from the main theme of the paper . since approximate range counting is one of the main motivations for introducing relative @xmath0-approximations , we return to this problem , and propose efficient solutions for approximate halfspace range counting in two and three dimensions . the solution to the 3-dimensional problem uses relative approximations , whereas the solution to the 2-dimensional problem is simpler and does not require such approximations .",
    "both solutions pass to the dual plane / space , construct a small subset of levels , of small overall complexity , in the arrangement of the dual lines / planes , and search through them with the point dual to the query halfplane / halfspace to retrieve the approximate count .",
    "we first present two solutions for the planar case , and then consider the 3-dimensional case .",
    "let @xmath1 be a set of @xmath4 points in the plane in general position , and @xmath144 be a prescribed parameter .",
    "the task at hand is to preprocess @xmath1 for halfplane approximate range counting ; that is , given a query halfplane @xmath323 , we wish to compute a number @xmath511 that satisfies @xmath512 .",
    "we can reformulate the problem in the dual plane , where the problem is to preprocess the set @xmath513 of lines dual to the points of @xmath1 for approximate vertical - ray range counting queries ; that is , given a vertical ray @xmath514 , we want to count ( approximately , within a relative error of @xmath18 ) the number of lines of @xmath513 that intersect @xmath514 . without loss of generality , we only consider downward - directed rays .",
    "let @xmath515 denote the @xmath167thlevel in the arrangement @xmath516 ; this is the closure of the set of all the points on the lines of @xmath513 that have exactly @xmath167 lines of @xmath513 passing below them .",
    "each @xmath515 is an @xmath302-monotone polygonal curve , and its _ combinatorial complexity _ ( or just _ complexity _ ) is the number of its vertices .    for integers @xmath517 , the total complexity of the levels of @xmath516 in the range @xmath518 $ ]",
    "is @xmath519 .    in particular , the average complexity of a level in this range is @xmath520 .",
    "[ lemma : levels ]    this result is a strengthening of a similar albeit weaker bound due to welzl  @xcite , and is implicit in @xcite .",
    "it was recently rederived , in a more general form , in an unpublished m.sc .",
    "thesis by kapelushnik  @xcite .",
    "we sketch the proof for the sake of completeness .",
    "consider the primal setting , and connect two points @xmath521 by an edge , if the open halfplane bounded by the line through @xmath247 and @xmath220 and lying below that line contains exactly @xmath397 points of @xmath1 ( we refer to @xmath522 as a _ @xmath397-set _ ) , where @xmath523 $ ] .",
    "let @xmath524 denote the resulting set of edges .",
    "all the edges of @xmath524 that are @xmath397-sets can be decomposed into @xmath525 concave chains ( see , e.g. , @xcite ) .",
    "similarly , they can be decomposed into @xmath526 convex chains .",
    "overall , the edges of @xmath524 can be decomposed into at most @xmath527 concave chains , and into at most @xmath528 convex chains .",
    "each pair of a convex and a concave chain can intersect in at most two points .",
    "this implies that the segments of @xmath524 can cross each other at most @xmath529 times .",
    "on the other hand , consider the ( straight - edge plane embedding of the ) graph @xmath530 .",
    "it has @xmath4 vertices , and @xmath531 edges . by the classical crossing lemma ( see @xcite ) , it has @xmath532 crossing pairs of edges ( assuming @xmath533 ) .",
    "we thus have @xmath534 or @xmath535 .",
    "the second claim in the lemma is an immediate consequence of this bound .",
    "\\(i ) for each @xmath536 , for @xmath13 , and for any fixed positive constant @xmath403 , let @xmath82 be an integer chosen randomly and uniformly in the range @xmath537 $ ] .",
    "then the expected complexity of @xmath538 is @xmath539",
    ". this bound also holds , with an appropriate choice of the constant of proportionality , with probability @xmath540 .",
    "\\(ii ) if @xmath538 has complexity @xmath247 then it can be replaced by an @xmath302-monotone polygonal curve with @xmath541 edges , which lies between the two curves @xmath542 and @xmath543 .",
    "[ claim : easy ]    the first claim is an immediate consequence of lemma  [ lemma : levels ] by setting @xmath544 and @xmath545 .",
    "the second claim is well known : the curve is obtained by shortcutting @xmath538 in `` jumps '' of @xmath546 vertices ; see , e.g. , @xcite .",
    "we present two variants of an algorithm for the problem at hand , which differ in the dependence of their performance on @xmath18 .",
    "the first has @xmath547 query time , but requires @xmath548 storage , while the second one uses only @xmath549 storage ( no dependence on @xmath18 ) , but its query time is @xmath550 .",
    "we first compute the union @xmath551 of the first @xmath552 levels of @xmath516 . as is well known ( see , e.g. , @xcite ) , the overall complexity of @xmath551 is @xmath553 .",
    "next , set @xmath554 , for @xmath555 .",
    "let @xmath403 be a constant that satisfies @xmath556 for @xmath13 ( @xmath557 would do ) .",
    "we pick a random level with index in the range @xmath558 ; by claim  [ claim : easy](i ) , most of these levels have complexity @xmath539 .",
    "we thus assume that the chosen level has this complexity ( or else we resample ; since the probability of success is at least @xmath156 , this does not affect the expected running time ) .",
    "we then simplify each such level , using claim  [ claim : easy](ii ) ( with @xmath559 instead of @xmath18 ) .",
    "the resulting polygonal curve @xmath560 is easily seen to lie ( strictly ) between @xmath561 and @xmath562 , and its complexity is @xmath563 in particular , the total complexity of the curves @xmath564 is @xmath565 , and these curves are pairwise disjoint .",
    "together with the segments in @xmath551 , they form a planar subdivision @xmath380 with @xmath548 edges , which we preprocess for efficient point location . using kirkpatrick s algorithm @xcite ,",
    "this can be done with @xmath548 preprocessing time and storage , and a query can be answered in @xmath566 time . we also store ( with no extra asymptotic cost ) a count @xmath567 with each edge @xmath568 of @xmath380 .",
    "it is equal to the level of @xmath568 if @xmath568 is an edge of @xmath551 , and to @xmath496 if @xmath568 is an edge of @xmath569 .",
    "now , given a query point @xmath570 ( i.e. , a downward - directed ray emanating from @xmath570 ) , we locate @xmath570 in @xmath380 and retrieve the count @xmath567 , where @xmath568 is the edge lying directly below @xmath570 .",
    "it is easy to verify that @xmath567 is indeed an @xmath18-approximation of the number of lines below @xmath570 .",
    "we have thus shown :    given a set @xmath1 of @xmath4 points in the plane , and a parameter @xmath13 , one can build , in @xmath571 expected time , a data - structure that uses @xmath548 space , so that , given a query halfplane @xmath323 , one can approximate @xmath572 within relative error @xmath18 , in @xmath573 time .",
    "[ theo : approximate:2:fast ]    the construction is described above , and we only bound the running time .",
    "computing the bottom @xmath319 levels takes @xmath574 time @xcite .",
    "computing the remaining randomly chosen @xmath575 levels requires @xmath576 time per level , using the ( very involved ) dynamic convex hull algorithm of @xcite ( or simpler earlier algorithms with a slight ( logarithmic or sub - logarithmic ) degradation in the running time ) .",
    "overall , the running time is @xmath577 .",
    "let @xmath319 be a random integer in the range @xmath578 $ ] .",
    "by lemma  [ lemma : levels ] , the expected complexity of the level @xmath579 is @xmath549 . by markov",
    "s inequality , the complexity of @xmath579 is @xmath549 with probability at least @xmath156 , with an appropriate choice of the constant of proportionality .",
    "thus , redrawing the index @xmath319 if necessary ( without affecting the expected asymptotic running time ) , we may assume that @xmath579 does have linear complexity .",
    "next , we define the curves @xmath580 as above , with the new value of @xmath319 as the starting index .",
    "note that each @xmath560 is a shortcutting of a random level in the range @xmath581 $ ] , where @xmath582 .",
    "more precisely , we can regard the random choice of the level from which @xmath560 is produced as a 2-step drawing , where we first draw @xmath319 and then draw @xmath82 in the `` middle '' of the range @xmath583 $ ] , as above .",
    "the combined drawing is not exactly uniform , but is close enough to make lemma  [ lemma : levels ] and claim  [ claim : easy ] hold in this scenario too .",
    "we assume @xmath584 , and here we have @xmath585 , but the lemma continues to hold in this case too , as is easily checked . ]",
    "hence , the expected complexity of the level corresponding to @xmath560 is @xmath549 for each @xmath167 .",
    "thus , the overall expected complexity of the shortcut curves @xmath586 is now only @xmath587 ( with a constant of proportionality independent of @xmath18 ) .",
    "we construct the collection of these curves , and assume ( using resampling if necessary ) that their overall complexity is indeed linear .",
    "we preprocess the planar map formed by these curves , and by the edges of @xmath579 , for fast point location , as above , and store with each curve @xmath560 , for @xmath588 , the level @xmath589 that it approximates .",
    "in addition , we sweep @xmath579 from left to right , and store , with each of its edges @xmath568 , the ( fixed ) set of lines passing below ( any point on ) @xmath568 .",
    "this can be done with only @xmath549 storage , using persistence  @xcite .",
    "now , given a query point @xmath570 , we locate it in the planar map .",
    "if it lies above @xmath590 , then the index stored at the segment lying directly below @xmath570 is an @xmath18-approximation of the number of lines below @xmath570 .",
    "if @xmath570 lies below @xmath590 , we find the edge @xmath568 of @xmath579 lying above or below @xmath570 , retrieve the set of lines stored at @xmath568 ( using the persistent data structure ) , and search it , in @xmath591 time , to count ( exactly ) the number of lines below @xmath570 .",
    "we thus have shown :    given a set @xmath1 of @xmath4 points in the plane , and a parameter @xmath13 , one can build , in @xmath592 time , a data - structure that uses @xmath549 space , so that , given a query halfplane @xmath323 , one can approximate @xmath572 , within relative error @xmath18 , in @xmath593 time .",
    "[ theo : approximate:2:small : space ]    the construction requires the computation of @xmath594 levels , each of expected complexity @xmath549 .",
    "thus , this takes @xmath595 time ( or slightly worse , as in the comment in the preceding proof ) .",
    "the query time and space complexity follow from the discussion above .    observe that theorem  [ theo : approximate:2:fast ] and theorem  [ theo : approximate:2:small : space ]",
    "improve over the previous results in @xcite , which have query time @xmath596 .",
    "it would also be interesting to compare these results to the recent technique of aronov and sharir  @xcite ; as presented , this technique caters only to range searching in four and higher dimensions , but it can be adapted to two or three dimensions too .      we can extend the above algorithms to three dimensions . after applying duality , the input is a set @xmath597 of @xmath4 planes in 3-space , which we want to preprocess for approximate vertical ray range counting .",
    "the general idea is very similar : ( i ) compute a sequence of levels of @xmath598 , whose indices form roughly a geometric sequence .",
    "( ii ) replace each level by a simplified @xmath295-monotone polyhedral surface which approximates it well .",
    "( iii ) find the belt between two consecutive surfaces which contains the query point @xmath570 ( the apex of the query vertical ray ) , and thereby obtain the desired approximate count .",
    "implementing step ( ii ) is considerably harder in three dimensions than in the plane , and we do it using an appropriate relative @xmath0-approximation .    for the sake of simplicity of presentation , we do not attempt to optimize the choice of parameters , and just describe the general technique .",
    "concrete and improved versions can be worked out by the interested reader .",
    "[ [ approximating - a - specific - level . ] ] approximating a specific level .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    consider first the problem of approximating a specific level @xmath290 of @xmath598 .",
    "consider the range space that has @xmath597 as the ground set , whose ranges are induced by vertical downward - directed rays , where the range associate with a ray @xmath514 is the subset of planes of @xmath597 crossed by @xmath514 .",
    "this range space has finite vc - dimension , so we can apply to it the analysis of section  [ sec : relations ] .",
    "put @xmath599 , and construct a @xmath600-relative approximation @xmath601 , by taking a random sample of size @xmath602 from @xmath597 ( see theorem  [ theo :",
    "l : l : s ] and @xcite ) ; with high probability , the sample is indeed such an approximation .",
    "set @xmath603 . by construction , the @xmath604thlevel @xmath605 of @xmath606",
    "is guaranteed to lie between the levels @xmath607 and @xmath608 of @xmath598 , so it provides an adequate approximation to the @xmath290thlevel of @xmath598 . since @xmath54 is `` small '' , we can compute @xmath605 in time @xmath609 , using , e.g. , the algorithm of @xcite .",
    "[ [ approximating - all - levels . ] ] approximating all levels .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + +    we first compute explicitly all the @xmath610 bottom levels of @xmath598 .",
    "their overall complexity is @xmath611 @xcite , and their construction takes @xmath612 time @xcite .",
    "next , we approximate each of the levels @xmath613 , up to relative error of @xmath614 , using the algorithm described above , for @xmath615 .",
    "this results in a sequence of @xmath616 pairwise disjoint @xmath295-monotone polyhedral surfaces in @xmath86 ( i.e. , the exact @xmath617 bottom levels , and the additional @xmath618 approximated levels ) .",
    "we need to store these surfaces so that , given a query point @xmath570 , the two surfaces which lie directly above and below @xmath570 can be found efficiently .",
    "this is done using binary search through the sequence of surfaces , where each step of the search is implemented by locating the @xmath295-projection @xmath619 of @xmath570 in the @xmath295-projection of a surface ( which is a planar map ) , and then by testing @xmath570 against the plane inducing the face containing @xmath619 .",
    "thus the cost of a query is @xmath620 .",
    "the index of the surface directly below @xmath570 ( namely , either its exact level if it is one of the first bottom @xmath621 levels , or the index of the level of @xmath598 that it approximates ) yields the desired approximate count .",
    "the preceding analysis is easily seen to imply that the overall storage and preprocessing cost of the algorithm are both @xmath622 .",
    "( concrete and reasonably small values of the powers of the polylogarithmic factor and of the factor @xmath623 can be easily worked out , but we skip over this step . ) hence we obtain the following result .    given a set @xmath1 of @xmath4 points in three dimensions and a parameter @xmath624 , one can build a data - structure , in @xmath625 time and space , so that , given a query halfspace @xmath323 , one can approximate @xmath626 , up to relative error of @xmath627 .",
    "the query time is @xmath620 .",
    "[ theo : approximate:3:fast ]    as in the planar case , theorem  [ theo : approximate:3:fast ] improves over the previous results @xcite , which require @xmath628 time to answer a query .",
    "however , in a subsequent work , afshani and chan  @xcite managed to obtain an improved solution . specifically , they show that , with @xmath629 expected preprocessing time , one can build a data structure of expected size @xmath630 which can answer approximate 3-dimensional halfspace range counting queries in @xmath631 expected time , where @xmath632 is the actual value of the count , and @xmath633 hides constant factors that are polynomial in @xmath610",
    ". it would also be interesting to compare our result to the appropriate variant of the technique of @xcite .",
    "[ sec : conclusions ]    in this paper we first established connections between the @xmath52-samples of li _",
    "et  al . _",
    "@xcite and relative @xmath0-approximations ( and other notions of approximations ) . this has allowed us to establish sharp upper bounds on the size of relative @xmath0-approximations in arbitrary range spaces of finite vc - dimension .",
    "we then turned to study geometric range spaces , and gave a construction of even smaller - size relative approximations for halfplane ranges , by revisiting the classical construction of spanning trees with low crossing number , and by modifying it to be `` weight - sensitive '' .",
    "we then gave similar constructions of `` almost '' relative approximations for halfspace ranges in three and higher dimensions , using a different approach .",
    "finally , we have also revisited the approximate halfspace range - counting problem in two and three dimensions , and provided better algorithms than those previously known .",
    "there are several interesting open problems for further research .",
    "the main one is to extend the construction of spanning trees with small relative crossing number to three and higher dimensions .",
    "another open problem is to improve theorem  [ theo : good : partition ] .",
    "a minor further improvement of theorem  [ theo : good : partition ] is possible by plugging the construction of theorem  [ theo : good : partition ] into the construction of lemma  [ lemma : level : k ] .",
    "this still falls short of the desired spanning tree with crossing number @xmath634 , for a line @xmath283 of weight @xmath635 .",
    "we leave this as an open problem for further research .",
    "interestingly , the partition of lemma  [ lemma : cover ] can be interpreted as a strengthening of the shallow partition theorem of matouek@xcite in two dimensions .",
    "it is quite possible that a similar ( but probably weaker ) strengthening is possible in three and higher dimensions .",
    "the authors thank the anonymous referees for their insightful comments .",
    "the authors also thank boris aronov , ken clarkson , edith cohen , haim kaplan , yishay mansour and shakhar smorodinsky for useful discussions on the problems studied in this paper .",
    "p. k. agarwal , b. aronov , t. m. chan and m. sharir , on levels in arrangements of lines , segments , planes , and triangles , _ discrete comput .",
    "_ 19:315331 , 1998 .",
    "p. afshani and t. m. chan , on approximate range counting and depth , _ discrete comput .",
    "_ 41:321 , 2009 .",
    "n.  amenta , m.  bern , d.  eppstein , and s .- h .",
    "teng , regression depth and center points , _ discrete comput . geom . _ , 23:305323 , 2000 .",
    "a. andrzejak , _ on @xmath82-sets and their generalizations _ , ph.d .",
    "thesis , inst .",
    "fr theoretische informatik , eth zurich , 2000 .",
    "a. andrzejak , b. aronov , s. har - peled , r. seidel , and e. welzl , results on @xmath82-sets and @xmath397-facets via continuous motion arguments , _ proc .",
    "14th annu .",
    "acm sympos .",
    "_ , 1998 , pages 192199 .",
    "b. aronov and s. har - peled , on approximating the depth and related problems , _ siam j.  comput .",
    "_ , 38:899921 , 2008 .",
    "b. aronov and m. sharir , approximate halfspace range counting , _",
    "siam j. comput .",
    "_ , to appear .",
    "h.  brnnimann , b.  chazelle , and j.  matouek , product range spaces , sensitive sampling , and derandomization , _ siam j. comput .",
    "_ , 28:15521575 , 1999 .",
    "g.  s. brodal and r.  jacob .",
    "dynamic planar convex hull . in _ proc .",
    "43th annu .",
    "ieee sympos . found .",
    "_ , pages 617626 , 2002 .",
    "h.  brnnimann , _ derandomization of geometric algorithms _ , ph.d .",
    "thesis , dept .",
    "princeton university , princeton , nj , may 1995 .",
    "t.  m. chan , random sampling , halfspace range reporting , and construction of @xmath636-levels in three dimensions , _ siam j. comput .",
    "_ , 30(2):561575 , 2000 .",
    "b.  chazelle , _ the discrepancy method : randomness and complexity _ , cambridge university press , new york , 2001 .",
    "b. chazelle , the discrepancy method in computational geometry , chapter 44 , in _ handbook of discrete and computational geometry _ , 2nd edition , j.e .",
    "goodman and j. orourke , eds .",
    ", crc press , boca raton , 2004 , pages 983996 .    b. chazelle and e. welzl , quasi - optimal range searching in spaces with finite vc - dimension , _ discrete comput .",
    "_ , 4:467490 , 1989 .",
    "k. l. clarkson and p. w. shor , applications of random sampling in computational geometry , ii , _ discrete comput geom .",
    "_ 4:387421 , 1989 .",
    "e. cohen , h. kaplan , y. mansour and m. sharir , approximations with relative errors in range spaces of finite vc - dimension , manuscript , 2006 .",
    "t. dey , improved bounds for planar @xmath82-sets and related problems , _ discrete comput .",
    "_ 19:373382 , 1998 .",
    "h.  everett , j .-",
    "robert , and m.  van kreveld .",
    "an optimal algorithm for the @xmath637-levels , with applications to separation and transversal problems .",
    ", 6:247261 , 1996 .    s.",
    "har - peled , carnival of samplings : nets , approximations , relative and sensitive , manuscript , 2008 .",
    "http://arxiv.org/abs/0908.3718 and http://valis.cs.uiuc.edu/~sariel / papers/08/sampling_survey/. revised version appears as chapter 6 , `` yet even more on sampling '' in har - peled s class notes .",
    "s.  har - peled and m.  sharir , relative @xmath0-approximations in geometry , manuscript , 2009 .",
    "available from http://valis.cs.uiuc.edu/~sariel/papers/06/relative .",
    "d.  haussler , decision theoretic generalizations of the pac model for neural nets and other learning applications , _ inform .",
    "_ , 100:78150 , 1992 .",
    "d. haussler and e. welzl , epsilon nets and simplex range queries , _ discrete comput .",
    "_ , 2:127151 , 1987 .",
    "l. kapelushnik , _ computing the @xmath82-centrum and the ordered median hyperplane _",
    "thesis , school of computer science , tel aviv university , 2008 .",
    "d. g. kirkpatrick , optimal search in planar subdivisions , _ siam j. comput .",
    "_ 12:2835 , 1983 .",
    "h. kaplan , e. ramos and m. sharir , range minima queries with respect to a random permutation , and approximate range counting , _ discrete comput .",
    "_ , to appear . also in http://www.math.tau.ac.il/~michas/ , 2008",
    "h. kaplan , e. ramos and m. sharir , the overlay of minimization diagrams in a randomized incremental construction , http://www.math.tau.ac.il/~michas/ , 2008 .",
    "h. kaplan and m. sharir , randomized incremental construction of three - dimensional convex hulls and planar voronoi diagrams , and approximate range counting , _ proc .",
    "17th acm - siam sympos . discrete algorithms _ pages 484493 , 2006 .",
    "j. komls , j. pach and g. woeginger , almost tight bounds for @xmath18-nets , _ discrete comput .",
    "_ 7:163173 , 1992 .",
    "y.  li , p.  m. long , and a.  srinivasan , improved bounds on the sample complexity of learning , _ j. comput .",
    "_ , 62:516527 , 2001 .",
    "j.  matouek , construction of epsilon - nets , _ discrete comput .",
    "_ , 5:427448 , 1990 .",
    "j.  matouek , computing the center of planar point sets , in _ computational geometry : papers from the dimacs special year _ ( j.e .",
    "goodman , r. pollack and w. steiger , eds . ) , ams , providence , ri , 1991 , pages 221230 .",
    "j.  matouek , reporting points in halfspaces , _ comput .",
    "theory appl .",
    "_ , 2:169186 , 1991 .",
    "j. matouek , efficient partition trees , _ discrete comput .",
    "_ , 8:315334 , 1992 .",
    "j. matouek , _ geometric discrepancy _ ,",
    "algorithms and combinatorics , vol .",
    "18 , springer verlag , heidelberg , 1999 .",
    "j.  matouek , _ using the borsuk - ulam theorem _ , universitext , springer - verlag , berlin , 2003 , lectures on topological methods in combinatorics and geometry , written in cooperation with anders bjrner and gnter m. ziegler .",
    "j.  matouek , e. welzl and l. wernisch , discrepancy and approximations for bounded vc - dimension , _ combinatorica _ , 13:455466 , 1993 .",
    "j. pach and p. k. agarwal , _ combinatorial geometry _ , wiley interscience , new york , 1995 .",
    "d.  pollard , rates of uniform almost - sure convergence for empirical processes indexed by unbounded classes of functions , manuscript , 1986 .",
    "h. shaul and m. sharir , semi - algebraic range reporting and emptiness searching with applications , manuscript , 2009 .",
    "an earlier incomplete version in _ proc .",
    "16th acm - siam sympos . discrete algorithms _ , pages 525534 , 2005 .",
    "n.  sarnak and r.  e. tarjan , planar point location using persistent search trees , _ commun .",
    ", 29:669679 , 1986 .",
    "m. talagrand , sharper bounds for gaussian and empirical processes , _",
    "annals probab .",
    "_ 22:2876 , 1994 .",
    "vapnik and a. ya .",
    "chervonenkis , on the uniform convergence of relative frequencies of events to their probabilities , _ theory of probability and its applications _ , 16:264280 , 1971 .",
    "e. welzl , more on @xmath82-sets of finite sets in the plane , _ discrete comput .",
    "_ 1:95100 , 1986 .",
    "e.  welzl , on spanning trees with low crossing numbers , in _ data structures and efficient algorithms , final report on the dfg special joint initiative _ ,",
    "volume 594 of _ lect .",
    "notes in comp .",
    "_ , pages 233249 , springer - verlag , 1992 .",
    "[ apnd : proofs ]"
  ],
  "abstract_text": [
    "<S> we re - examine the notion of _ relative @xmath0-approximations _ , recently introduced in @xcite , and establish upper bounds on their size , in general range spaces of finite vc - dimension , using the sampling theory developed in @xcite and in several earlier studies  @xcite . </S>",
    "<S> we also survey the different notions of sampling , used in computational geometry , learning , and other areas , and show how they relate to each other . </S>",
    "<S> we then give constructions of smaller - size relative @xmath0-approximations for range spaces that involve points and halfspaces in two and higher dimensions . </S>",
    "<S> the planar construction is based on a new structure  spanning trees with small _ relative crossing number _ , which we believe to be of independent interest . </S>",
    "<S> relative @xmath0-approximations arise in several geometric problems , such as approximate range counting , and we apply our new structures to obtain efficient solutions for approximate range counting in three dimensions </S>",
    "<S> . we also present a simple solution for the planar case . </S>"
  ]
}