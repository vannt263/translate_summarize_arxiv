{
  "article_text": [
    "quantum communication protocols can perform tasks that are not possible classically such as quantum key distribution @xcite , teleportation @xcite , and quantum memory @xcite .",
    "additionally , quantum communication can outperform possible classical counterparts , as is the case for superdense coding @xcite .    in experimental realizations ( see , e.g. , refs .",
    "@xcite ) , imperfections are inevitable , and the advantage over a classical strategy may be lost .",
    "for example , a classical strategy for a quantum memory performs a quantum measurement on the incoming signal , stores the result classically , and prepares a quantum state corresponding to the stored result as output . for quantum key distribution ( qkd ) ,",
    "the classical strategy to compare against is an intercept - resend attack .",
    "a typical test for quantum memories and teleportation devices is to monitor the fidelity of the stored or transmitted quantum states and to compare the observed value to the theoretical limit for classical strategies @xcite .    especially in infinite - dimensional systems , however , knowing which fidelities are classically achievable is non - trivial .",
    "the question is answered for gaussian distributions of coherent input states in ref .",
    "@xcite , but an answer for general input states is still outstanding .",
    "also , from an experimental viewpoint , a continuum set of test states , such as a gaussian distribution , is problematic , and a test involving only a small number of input states would be preferable .    the test we develop here does not make direct use of any figure of merit and has a simple structure : the quantum device is tested on a set of non - orthogonal signal states , and the corresponding output states are then measured in one of a few measurement settings . in some situations ,",
    "for example , in testing qkd devices or quantum teleportation setups , there might be two parties , possibly at distant locations , one party ( alice ) preparing the input states , and the other ( bob ) performing measurements on the output states . in this case",
    ", the two parties might make use of classical public communication to collect the necessary information to evaluate the test .",
    "in other situations , like testing a quantum memory , the preparation and measurement can be performed by one and the same party .",
    "the test procedure can be reformulated using an entanglement - based description . in this formulation , an alternative description of the state preparation is used @xcite , where alice creates a bipartite , entangled state and sends one subsystem to bob . by performing a suitable measurement on her own subsystem",
    ", she can effectively prepare the desired signal state .",
    "in general , before alice s and bob s measurements , we will have an effective entangled state shared by the two parties .",
    "as far as the action of the quantum device and bob s measurements are concerned , both formalisms are equivalent .",
    "the main test idea is that classical devices , in the special meaning introduced above , will always destroy any entanglement between alice and bob in the entanglement - based description .",
    "conversely , if entanglement in the underlying state can be shown from the measurement data , then the minimal requirement of actual quantum behavior of the device relevant to quantum communication is demonstrated .",
    "note that the notion of classicality tested here and relevant to the use of the devices in a quantum communication context differs from the notion of classicality often discussed in a quantum optical context @xcite .    to use entanglement verification as a first test of a protocol has been proposed in the context of quantum key distribution @xcite .",
    "the underlying idea has also been used to show ultimate limits for specific qkd protocols @xcite . for",
    "other tasks , such as the storage of quantum states , translation to an entanglement - based picture and verification of quantum correlations may provide an easily implementable test .",
    "+ we present in this paper a method to verify entanglement especially suitable for bipartite optical systems , which is in principle not limited to a particular hilbert space dimension or specific choices of measurements .",
    "we define the bipartite expectation value matrix , which allows to detect entanglement even if only partial information on the system is available .",
    "section [ sec : method ] gives the general definitions and properties connected to the verification method .",
    "its workings are exemplified in section [ sec : apply ] on a discrete - continuous cryptography protocol with homodyne detection .",
    "furthermore , the applicability of the verification method to quantum memories is discussed .",
    "section [ sec : evmstokes ] revisits the same protocol and takes into account the phase reference necessary for the detection process .",
    "the resulting description in terms of the stokes operators will serve as a second example of the applicability and limitations of the entanglement verification method and raise questions about the security of quantum key distribution based on homodyne detection .",
    "we show that the security may be compromised by changes in the phase reference intensity .",
    "section [ sec : addm ] investigates remedies in the form of additional measurements .",
    "additional results for the presence of channel losses are given in section [ sec : loss ] .",
    "we close with a conclusion in section [ sec : conclude ] .",
    "in this section we address the problem of entanglement verification in the situation , in which the measurements performed on a bipartite system are not tomographically complete , i.e. , the density matrix of the underlying state can not be completely characterized .",
    "an attempted description in terms of the density matrix will consequently involve many undetermined parameters and will quickly become impractical for higher dimensions .",
    "instead , each set of measurement outcomes defines an equivalence class of compatible states and the specification of this equivalence class , say in the form of a matrix , holds all accessible information .",
    "the size of such a matrix description then depends on the number of measurements rather than the hilbert - space dimensions , and can thus be substantially smaller than the density matrix .",
    "moreover , this description enables the determination of entanglement conditions , by searching the equivalence class for separable states . to this end",
    ", we utilize the bipartite expectation value matrix ( evm ) ( cf .",
    "@xcite ) as an object which contains all measured information on the state .    in the following",
    ", we first present the general construction and properties of the evm and then explain how to use it for a separability criterion .",
    "suppose alice s and bob s systems are associated with hilbert spaces @xmath0 and @xmath1 , respectively , and the joint system is in the state @xmath2 , acting on @xmath3 .",
    "further suppose that alice s and bob s measurements are described by operators @xmath4 and @xmath5 , respectively , for appropriate sets @xmath6 and @xmath7 .",
    "then the entries of the bipartite evm are defined as @xmath8_{ij , kl } = \\text{tr}(\\rho_{ab } \\hat{a}_i^\\dagger \\hat{a}_k \\otimes \\hat{b}_j^\\dagger \\hat{b}_l).\\ ] ] a similar construction in terms of creation and annihilation operators leads to the so - called matrix of moments employed by shchukin _",
    "et al . _  to find criteria for non - classicality @xcite and separability @xcite .",
    "the latter method was extended to finite - dimensional systems in ref .",
    "+ _ observation 1 : _ the expectation value matrix defined by eq .",
    "( [ eq : evm ] ) is hermitian and positive - semidefinite for all physical states @xmath2 .",
    "_ proof : _ the evm is hermitian since @xmath9^\\dagger)^ * \\\\ & = \\text{tr}(\\rho_{ab } \\hat{a}_i^\\dagger \\hat{a}_k \\otimes \\hat{b}_j^\\dagger \\hat{b}_l ) \\\\ & = \\chi_{ij , kl}.\\end{aligned}\\ ] ] non - negativity is shown with the following argument : given a physical state @xmath2 , the quantity tr(@xmath10 ) is non - negative for all operators @xmath11 . assuming the particular bipartite form @xmath12 with the above sets @xmath13 and",
    "@xmath14 , we find @xmath15_{ij , kl } \\ ,",
    "c_{kl } , \\\\ & = \\sum_{ij , kl } \\vec{c}\\ ^\\dagger \\chi(\\rho_{ab } ) \\vec{c } , \\quad \\forall \\vec{c}\\end{aligned}\\ ] ] so @xmath16 is a positive - semidefinite matrix .",
    "@xmath17    remarkably , the class of expectation value matrices contains , by suitable choices of the sets @xmath13 and @xmath7 , the system s density matrix itself as well as the reduced density matrices .",
    "an evm can also contain other useful quantities , such as the covariance matrix .",
    "an explicit construction of an evm which contains @xmath18 and a variant of the covariance matrix of subsystem @xmath19 is used in sec .",
    "[ sec : apply ] .",
    "+      quantum correlations exist in the measurement data if the equivalence class of states compatible with the observed evm can be shown to contain no separable states .",
    "we will use the partial transposition to verify this . due to the product structure of separable states",
    "@xcite , transposition of either subsystem will result in another valid physical state .",
    "therefore , if the partial transpose of a state @xmath20 is not positive , @xmath20 must be entangled @xcite .",
    "this property translates to the evm . since @xmath21 for all physical states @xmath2 , violation of @xmath22 is a sufficient condition for @xmath2 to be entangled .",
    "the same holds for the transpose of subsystem @xmath19 .",
    "in fact , a positivity requirement on a matrix , such as eq .",
    "( [ eq : chipos ] ) , gives rise to a family of inequalities ( cf .",
    "@xcite ) , since eq .  (",
    "[ eq : chipos ] ) holds true if and only if all principle submatrices of @xmath23 have non - negative determinants @xcite .",
    "negativity of any one of these sub - determinants provides a sufficient entanglement criterion , a non - trivial example of which will be given in sec .",
    "[ sec : evmstokes ] .    to evaluate the evm on @xmath24",
    ", we use the invariance of the trace under partial transposition of its argument .",
    "the partial transpose of the state can thus be transferred to a transposition of alice s measurement operators , i.e. : @xmath25_{ij , kl } = \\text{tr}(\\rho_{ab}[(\\hat{a}_i^\\dagger \\hat{a}_k)^t \\otimes \\hat{b}_j^\\dagger \\hat{b}_l]).\\ ] ] the usefulness of the entanglement criterion depends on the connection between the operators @xmath26 and their transpose . in the examples that we consider ,",
    "it turns out that each transposed operator is merely a scalar multiple of one of the original operators , as illustrated in sec .",
    "[ sec : apply ] .",
    "partial transposition is only one of many possible operations to detect entangled states .",
    "in fact , any positive but not completely positive map may be used as long as the adjoint map can act on the measurement operators in a meaningful way .",
    "it may occur in experimental situations that not all entries of the evm can be measured , however carefully the sets @xmath27 and @xmath7 are chosen .",
    "entries which are not accessible must be represented by complex - valued free parameters .",
    "the criterion ( eq .  ( [ eq : chipos ] ) ) can still be evaluated in this case by rephrasing it as follows : if it is not possible to find a set of free parameters such that @xmath28 @xmath2 must have been entangled .",
    "this search through all possible parameter sets is efficiently done with semidefinite programming @xcite .",
    "if it was known which parameter sets are compatible with physically valid states , the criterion ( eq .  ( [ eq : cond ] ) ) with limited information would be as strong as the criterion ( eq .  ( [ eq : chipos ] ) ) for the fully known evm .",
    "this question for physically allowed parameter sets is , however , unanswered at present . + it is important to note that the verification scheme is , in principle , completely general , since neither the definition ( eq .  ( [ eq : evm ] ) ) of the evm nor the conditions in eq .",
    "( [ eq : cond ] ) contain assumptions about the measurements or the dimensionality .",
    "one of the strengths of using the evm - based entanglement verification method is that high - dimensional states can be represented by a low - dimensional matrix , which will be of particular advantage in the continuous - variable regime .",
    "we now apply the verification scheme to quantum key distribution .",
    "when effective entanglement can be verified in a particular implementation , the possibility of an intercept - resend attack is excluded .",
    "the example we use to illustrate the entanglement verification method is a very simple protocol for quantum key distribution @xcite .",
    "alice generates a random classical bit - string which she wishes to share with bob and use to distill secret key . to achieve this",
    ", she simply encodes each  0 \" in a coherent state @xmath29 and each  1 \" in @xmath30 , with @xmath31 real and positive , and sends those signal states over a quantum channel to bob .",
    "the notion of security arises form the non - orthogonality of the two signal states @xmath29 and @xmath30 .    in the equivalent entanglement",
    "based picture , alice s source prepares bipartite states @xmath32 a subsequent projective measurement @xmath33 effectively prepares the above signal states .",
    "also , since system @xmath34 remains in the source , alice has complete knowledge of the reduced density matrix @xmath18 .    under the action of the quantum channel the originally pure signal states evolve to mixed ones .",
    "we denote the resultant states at bob s site by @xmath35 if alice sent a 0 and by @xmath36 if alice sent a 1 .",
    "these conditional states are fed into a standard homodyne detection setup @xcite where they interfere with a strong coherent reference beam on a balanced beam splitter .",
    "the intensity difference of the output arms gives access to the field quadratures , defined as @xmath37 and @xmath38 .",
    "we assume here that for each incoming signal @xmath39 , bob can measure @xmath40 and @xmath41 , where @xmath42 and @xmath43 ( and likewise for @xmath44 )",
    ".    the existence of entanglement for the present quantum key distribution protocol has been investigated in @xcite .",
    "we will reproduce the results of this analysis using the method outlined above and show the equivalence of both approaches ( see appendix [ appsec : equiv ] ) .    with the given measurements ,",
    "the evm is constructed in a straightforward way by choosing @xmath45 , where @xmath46 is some generic ( and irrelevant ) qubit state , and @xmath47 .",
    "consequently , we obtain the @xmath48 matrix @xmath49 with @xmath50 note the special property that @xmath18 is included in the above evm , so @xmath16 indeed contains all information obtainable from the protocol . + we now evaluate the evm on the partially transposed state @xmath24 .",
    "taking an example entry and using the aforementioned invariance of the trace under partial transposition , we find @xmath51_{2,6 } & = \\text{tr } ( \\rho_{ab}^{t_a } [ { \\mbox{$ | 0 \\rangle $ } } { \\mbox{$ \\langle 1 | $ } } \\otimes \\hat{x}\\hat{p } ] ) \\\\",
    "\\nonumber      & = \\text{tr } ( \\rho_{ab } [ { \\mbox{$ | 0 \\rangle $ } } { \\mbox{$ \\langle 1 | $ } } \\otimes \\hat{x}\\hat{p}]^{t_a } ) \\\\ \\nonumber      & = \\text{tr } ( \\rho_{ab } [ { \\mbox{$ | 1 \\rangle $ } } { \\mbox{$ \\langle 0 | $ } } \\otimes \\hat{x}\\hat{p } ] ) \\\\      & = [ \\chi ( \\rho_{ab } ) ] _ { 6,2}\\end{aligned}\\ ] ] and similarly for the other entries . hence , @xmath23 is the block transposition of @xmath16 .",
    "another important point is the undetermined entries of the evm mentioned above .",
    "both off - diagonal blocks , for example , are completely unknown with the exception of their ( 1,1 ) entries . each unknown entry",
    "is represented by a complex number , so that the evm is parameterized as @xmath52 where @xmath53 , @xmath54 and @xmath55 are real parameters and @xmath56 are complex . in the above parameterization , the commutator @xmath57 = \\mathbbm{i } \\hat{\\mathbbm{1}}$ ]",
    "was used to relate the products @xmath58 and @xmath59 to each other .",
    "knowledge of the expectation value of the commutator is crucial for the success of the method .",
    "an example where this expectation value is not known is given in section [ sec : evmstokes ] .    evaluating",
    "the entanglement criterion is now a matter of finding parameter sets @xmath60 such that the evm satisfies the conditions given in eq .",
    "( [ eq : cond ] ) .",
    "the task is simple in the sense that there exist efficient algorithms to solve this semidefinite feasibility problem @xcite . + before presenting results of the numerical analysis , we comment on entangled states with positive partial transposition ( ppt ) . since our method is based on the negativity of the partial transposition , no such states can be detected .",
    "the following observation , however , shows that the given structure of signal states and measurements on system @xmath34 do not allow the detection of ppt entangled states on principle , independent of the method .",
    "_ observation 2 : _",
    "( compare _ lemma 2 _ in @xcite ) let @xmath61 be a ppt entangled state not detected by the evm method . then there exists a separable state compatible with the same measured data .",
    "_ proof : _",
    "@xmath62 is the block transposition of @xmath63 and therefore fits the same experimental data .",
    "then so does the sum @xmath64 , which is the evm of @xmath65 .",
    "this state @xmath66 is invariant under transposition of subsystem @xmath34 .",
    "theorem @xmath67 in ref .",
    "@xcite states that any state of dimension @xmath68 which is invariant under transposition of subsystem @xmath34 is separable .",
    "we argue in appendix [ appsec:2byn ] that this theorem is applicable to the inifinite - dimensional state @xmath66 and therefore , @xmath66 is separable .",
    "results of the numerical evaluation of the semidefinite program naturally rely on actually measured values of the known entries of the evm . in the following ,",
    "we simulate these experimental outcomes with a loss and noise model .",
    "the channel loss is modeled as a scaling factor @xmath69 for the first quadrature moments , i.e. , @xmath70 , and similarly for @xmath71 .",
    "noise in the channel is assumed not to affect the first moments , but to act as a broadening in the observed variances .",
    "the variances are incorporated in the evm ( eq .",
    "( [ eq : chiopen ] ) ) by writing @xmath72 , and @xmath73 .",
    "unless otherwise stated , the noise is modeled to increase var(@xmath74 ) and var(@xmath44 ) equally ( cf .",
    "a corresponding physical setup is a perfect channel with an inserted beam splitter , so that losses are attributed to the beam splitter s reflectivity . feeding a thermal state into the second input port of the beam splitter",
    "can simulate the channel noise .",
    "consequently , this noise model always leads to physical expectation values and actual experimental results are in good agreement with this model @xcite .",
    "it should be noted that the verification method itself is independent of the choice of noise model .",
    "due to the particulars of the noise model , each distinct set of measurement outcomes is characterized , for a fixed loss value , by only two parameters .",
    "namely , the input state overlap @xmath75 , as chosen by alice , and the quadrature variance measured by bob .",
    "all parameter pairs with @xmath76 and @xmath77 are physically valid .",
    "figure [ fig : quad ] shows which of these parameter pairs stem from entangled states .",
    "the plot is shown for @xmath78 .",
    "corresponding curves for other values of the channel transmission have the same characteristic shape , but a smaller gradient , cf .  fig .  2 in ref .",
    "we see that entangled states are detected as long as the excess noise is not too high .",
    "the tolerable excess noise decreases for smaller input overlaps .",
    "actual experiments can deliver values well within this region of entangled states @xcite .",
    "+ note that an extension to heterodyne detection would allow the measurements of @xmath79 and @xmath80 , for @xmath81 .",
    "however , although this reduces the number of free parameters in the evm , the results shown in fig .  [ fig : quad ] would remain the same for the given channel model .",
    "whenever the conditions in eq .",
    "( [ eq : cond ] ) are met , the entanglement verification method is inconclusive , since the numerically - found solution may be unphysical .",
    "the question whether a given evm corresponds to a physical state has no straightforward answer .",
    "therefore , we supplement the method by searching for specific separable states compatible with those data sets satisfying eq .",
    "( [ eq : cond ] ) .",
    "this search is equivalent to finding specific intercept - resend attacks @xcite .",
    "in such an attack , an eavesdropper ( eve ) measures out the signal states when they leave the source and resends appropriately chosen new states according to her measurement outcomes , thus acting as an entanglement - breaking channel @xcite .",
    "intuitively , the non - orthogonality of the signal states protects against such attacks .",
    "when eve tries to distinguish @xmath29 and @xmath30 and reassign new signals accordingly , she inevitably makes errors which will be detectable in bob s observations . in our case",
    ", these errors will manifest themselves in the form of increased uncertainties .",
    "hence , for large measured variances we always expect to find an intercept - resend attack , in analogy to bit - error rates above 25% in the qubit - based bb84 protocol @xcite .",
    "+ a promising , and ultimately successful , choice of measurement for the eavesdropper is a minimum - error discrimination described in ref .",
    "for the signal states @xmath82 , the resulting error probability is given by @xmath83 implementations of this minimum error discrimination measurement are discussed in ref .",
    "@xcite .    in other words ,",
    "if we assume eve to resend either @xmath84 or @xmath85 , she makes a wrong choice with probability @xmath86 . as a result ,",
    "bob s states , conditioned on the original bit - values , become @xmath87 the exact form now depends on the choice of @xmath88 .",
    "we note here that since the original coherent amplitudes @xmath31 have been chosen to be real , the expected variance broadening from the attack will only occur in the @xmath89-direction ( cf .",
    "[ fig : evestates ] ) .",
    "however , bob expects to observe equal variances in @xmath74 and @xmath44 , which is achieved by the eavesdropper with appropriate squeezing operations .",
    "hence , a natural choice of states is @xmath90 where @xmath91 and @xmath92 are the displacement and squeezing operators , respectively , and @xmath93 is a real squeezing parameter @xcite .    .",
    "b ) bob s conditional state @xmath94 after the interaction of the eavesdropper . with probability @xmath95 ,",
    "eve resent @xmath84 ; with probability @xmath86 , she erroneously resent @xmath85 . ]    for each input overlap , the parameters @xmath96 and @xmath93 can now be adjusted to reproduce the values @xmath97 and @xmath98 expected by bob , while inducing the least possible excess variance .",
    "denoting the input state overlap by @xmath99 and the channel transmission again by @xmath100 , the analytic form of the resulting variances in bob s measurements reads @xmath101 and is shown in fig .",
    "[ fig : quad ] .",
    "we see an exact coincidence with the entanglement verification curve .",
    "this coincidence holds for all channel loss values .",
    "the combination of this attack with the entanglement verification method is necessary and sufficient to decide whether measured data is compatible with a separable state or not , for all possible data sets .      to assume equal variances for position and momentum in bob s observations",
    "may be unjustified in some situations , but an extension of the above scheme to unbalanced excess noise is straightforward .",
    "the total measured variance will be comprised of input variance and excess noise , i.e. , @xmath102 and similarly for @xmath44 .",
    "we find that , even in the case @xmath103 , the maximum tolerable noise of entangled states and the minimum variance broadening induced by an attack ( eq .  ( [ eq : equad ] ) )",
    "coincide .",
    "we conclude this section with a short discussion on the application of the verification method to quantum memories .",
    "recently , storage of continuous - variable states of light was realized @xcite .",
    "it was demonstrated that squeezing of vacuum input states was still observable in the output light .",
    "if any two non - orthogonal input states @xmath104 are chosen for testing a quantum memory , we can translate the storage process to an entanglement - based picture , in complete analogy with eq .",
    "( [ eq : entbased ] ) , with @xmath105 replaced by @xmath104 . since the entanglement verification method only depends on the input - state overlap and the first and second moments of the quadratures of the output light , it is applicable to this situation , independent of the particular workings of the storage and readout process .",
    "verifiable entanglement in this picture is sufficient to ensure the quantum nature of the memory .",
    "since this strategy requires no tomographically complete measurements , its experimental realization will require less resources .",
    "this section examines the protocol more closely by including the so - called local oscillator .",
    "this auxiliary light beam is used as a reference to define the signal states phase and is necessary for homodyne detection .",
    "if the local oscillator is in a coherent state of high intensity compared to the signal , the detection setup can be used to measure the field quadratures , as in the previous section .",
    "ideally , the phase reference is prepared locally , but to ensure phase stability , it is common practice to split off the local oscillator in the signal preparation process and send it to bob over the same quantum channel as the signal .",
    "the oscillator then inevitably passes through the insecure domain controlled by the eavesdropper and we can not make unverified assumptions about its state at bob s site .",
    "consequently , the detection process should be regarded as a true two - mode measurement and we will employ the stokes operators to describe it .",
    "typically , the stokes operators are used to describe the quantum polarization of light using a decomposition into two modes of orthogonal polarization ( see , e.g. , ref .",
    "@xcite ) . in our case ,",
    "the modes are spatially separated and we will label them with subscripts  @xmath99 \" and  @xmath106 \" to denote the signal and the local oscillator , respectively . in this language ,",
    "the input signal states are denoted by @xmath107 the stokes operators are defined in terms of mode operators as @xmath108 and the total intensity is often included in the set : @xmath109 their commutation relations are those of the @xmath110 algebra , namely , @xmath111 = 2 \\mathbbm{i } \\epsilon_{ijk } \\hat{s}_k\\ ] ] for @xmath112 , and @xmath113 is the levi - civita symbol . @xmath114 commutes with the other stokes operators . as a consequence of eq .",
    "( [ eq : stcom ] ) , the minimum uncertainty product of any two stokes operators depends on the expectation value of the third : @xmath115 one other property worth mentioning is the operator identity @xmath116      the stokes operators are measured by direct detection of intensity differences @xcite . if the two incoming light modes are spatially separated , the setup is identical to that of a homodyne apparatus . detecting",
    "the @xmath74-quadrature then corresponds to an @xmath117-measurement and the @xmath44-quadrature to @xmath118 .",
    "we therefore assume that the two - mode detection process gives access to the expectation values and variances of @xmath117 and @xmath118 .",
    "+ an evm is now constructed in complete analogy to the previous section , with @xmath119 , resulting in a matrix similar to ( [ eq : chiopen ] ) .",
    "the crucial difference is the commutator , which is unknown for this setting since it is proportional to the unmeasured quantity @xmath120 .",
    "the known entries of this evm are modeled to reflect actual experimental data .",
    "as before , losses can be modeled to downscale the first moments and noise is included as broadening of the variances of @xmath117 and @xmath118 .",
    "numerical results are shown in fig .",
    "[ fig : stokes1 ] , again with the assumption that the observed variances in @xmath117 and @xmath118 are equal .",
    "figure [ fig : stokes1 ] and all following figures are drawn for the loss - less case , since channel loss does not qualitatively change the results . an additional figure including channel loss can be found in section [ sec : loss ] .    .",
    "only data points above the grey shaded area are physically allowed .",
    "solid curve : entanglement verification without additional measurements . dashed line : intercept - resend attack with equal amplitudes in both modes .",
    "dotted line : input state variance for reference . ]",
    "there are two important points to note : firstly , unlike the quadratures , the variances of the stokes operators are not intensity - independent for coherent state input of the form ( eq .  ( [ eq : sigstokes ] ) ) .",
    "rather , @xmath121 holds true for all four stokes operators when evaluated on coherent states @xcite .",
    "hence , the variances of the input states are also plotted . due to the channel noise",
    ", actual measurement results are not expected below this coherent state curve .",
    "secondly , one can show that data sets below the entanglement verification curve are in fact unphysical . as mentioned above",
    ", every valid physical state must lead to a positive evm , which implies that all principle minors of @xmath122 must have non - negative determinants .",
    "taking rows and columns ( 1,2,4 ) to form a particular submatrix , we require @xmath123 with @xmath53 as before and @xmath124 denotes a free parameter ( cf .",
    "( [ eq : chiopen ] ) ) . evaluating",
    "the determinant leads to @xmath125 positivity of the sub - determinant ( 1,4,5 ) translates to the similar condition @xmath126 according to the noise model , @xmath127 and @xmath128 . adding ( [ eq : exist1 ] ) and ( [ eq : exist2 ] ) then gives the final condition @xmath129 which is obviously minimized for @xmath130 . plotting this minimum allowed variance against @xmath99 exactly coincides with the entanglement verification curve shown in fig .",
    "[ fig : stokes1 ] .",
    "consequently , no entangled states are detected by our method in the current measurement setting .",
    "+ to refine this last statement , we can again search for data pairs compatible with separable states by constructing a specific intercept - resend attack . the optimal measurement is the same as before , but the eavesdropper now resends @xmath131 with appropriately chosen parameters .",
    "the intuition behind this particular choice is that equal coherent amplitudes for signal and local oscillator can lead to the same first moments of @xmath117 and @xmath118 as the original signals , but the total intensity is significantly decreased .",
    "this equal - amplitude attack can in principle lead to lower variances in bob s observations than the input states would give , and this is indeed the case , as illustrated in fig .",
    "[ fig : stokes1 ] .",
    "in fact , in the limit of high photon numbers , the gap between existence curve and attack vanishes . +      concluding this section , we find that entanglement verification is not possible with measurements of the first and second moments of @xmath117 and @xmath118 only .",
    "almost all physically valid data sets admit an intercept - resend attack and are therefore compatible with separable states .",
    "no secure key can be distilled from such data .",
    "since homodyne detection is a standard tool for continuous - variable quantum communication , such as quantum key distribution with a gaussian distribution of coherent signal states @xcite , the above attack may be a pitfall for a variety of protocols .",
    "care must be taken that indeed the field quadratures are measured .",
    "ways to ensure this are presented in the following section .",
    "we consider two additional experimentally feasible measurements and investigate their effect on the performance of entanglement detection .",
    "a natural choice is the measurement of the third stokes operator @xmath132 .",
    "its expectation value and variance are easily included in the evm by choosing the constructing set @xmath133 , enlarging @xmath16 to an @xmath134 matrix .",
    "it is now also possible to use the commutator ( eq .",
    "( [ eq : stcom ] ) ) of @xmath117 and @xmath118 to relate products of the form @xmath135 and @xmath136 to each other .",
    "since the entanglement verification method is otherwise identical to the preceding sections , we directly present the results in fig .",
    "[ fig : stokes2 ] .    .",
    "the renormalized quadrature variances ( white circles ) coincide with the stokes operator variances when @xmath132 is measured . dashed line : input state variance for reference . ]",
    "there is a large area above the input state variance for which entanglement is ensured .",
    "in fact , if the results for the quadrature measurements are renormalized by the local oscillator intensity , they coincide with the present curve .",
    "there is an intuitive explanation for these results . since @xmath120 is the difference between the number of photons in the signal mode and that in the local oscillator mode , measuring @xmath120 provides a way of verifying that the phase reference is indeed much more intense than the signal . in this case",
    ", we expect to be able to measure the quadratures . a conceivably simpler way to achieve this verification is to monitor the local oscillator intensity separately",
    ".    however , these are truly additional measurements in the sense that the original setup must be modified .",
    "+ therefore , in section [ sec : totint ] , we briefly examine the situation where , instead of @xmath120 , the total intensity @xmath137 is measured .",
    "the value of @xmath137 is obtained when the two photocurrents in @xmath117 or @xmath118 detection are added rather than subtracted .",
    "depending on the experimental particulars , the total intensity may be available  for free \" with no change in the setup necessary @xcite .",
    "the variance of @xmath114 is not included in the analysis , since the intensity measurement is expected to be much more noisy than the measurements of the other stokes operators .    constructing an evm from @xmath138 gives no advantage over the case when @xmath114 is not included .",
    "as far as entanglement detection is concerned , the results are identical to those shown in fig .",
    "[ fig : stokes1 ] above .",
    "however , the powerful equal - amplitude attack ( eq .  ( [ eq : evestokes ] ) )",
    "is not possible in this setting , and a new intercept - resend strategy must be constructed .",
    "the goal is to show a conceptual difference from quadrature measurements , i.e. , to find an attack that explains data sets which would be attributed to entangled states , if quadrature detection was assumed .",
    "a corresponding attack can indeed be found .",
    "its construction builds on the correspondence between a collection of photons in two possible polarization modes and an ensemble of spin - half particles aligned along some quantization axis .",
    "in fact , the schwinger representation of spin operators @xcite differs from the above definition of the stokes operators only by factors of 2 : @xmath139 .    for eve s attack ,",
    "we use the particular squeezing operation @xmath140 called two - axis countertwisting @xcite , where @xmath141 . her explicit states are given by @xmath142 where @xmath143 is an angular momentum eigenstate , @xmath144 is a small rotation angle and @xmath145 ( @xmath146 ) are photon numbers larger ( smaller ) than the total photon number bob expects to measure .",
    "both the rotation operator @xmath147 @xcite and the two - axis countertwisting operator conserve the total intensity .",
    "the minimum variance broadening induced by this attack is plotted in fig .",
    "[ fig : twoaxis ] together with the entanglement verification curve for quadrature measurements .",
    "there are data sets from separable states well below the latter curve , so monitoring @xmath148 , @xmath149 , and the total intensity is not equivalent to quadrature detection and gives weaker results for entanglement verification .",
    "however , the attack was not evaluated for high photon numbers due to numerical limitations .        to be able to draw a comparison for more realistic intensities",
    ", we can replace eq .",
    "( [ eq : nplus ] ) by a quadrature squeezed state , i.e. @xmath150 the need for numerical evaluation is completely removed by the further simplification @xmath151 where @xmath152 is the two - mode squeezing operator .",
    "although both of these simplifying steps deteriorate the effectiveness of the attack , they can still account for data points below the quadrature entanglement verification curve ( fig .",
    "[ fig : quadaxis ] ) .",
    "the resulting gap does increase with the total photon number , albeit at a much lower rate .",
    "the dashed line results form entanglement verification with quadrature detection .",
    "solid line : attack with a mixture of 2-axis twisted and quadrature squeezed states for stokes and total intensity measurements .",
    "dotted line : the same attack with 2-mode squeezing instead of 2-axis countertwisting . ]    still , a large number of data points is neither explained by the intercept - resend attack nor detected by the entanglement verification method .",
    "it remains unclear if the measurements do not provide enough information on the state or if the construction of the evm is unsuited to verify entanglement for this particular scheme .",
    "this final section concerns the effect of channel loss on all of the above results involving the stokes operators .",
    "it is easily seen that the first moments of the stokes operators scale as the channel transmission @xmath100 , just as the reference coherent state variance . the existence curve , eq .  ( [ eq : exist ] )",
    ", however scales as @xmath153 and so does the corresponding intercept - resend attack .",
    "typical results in the presence of loss are shown in fig .",
    "[ fig : losses ] for 50 % channel transmission , together with the entanglement verification including @xmath120 .",
    "in conclusion , we have constructed bipartite expectation value matrices as a description of systems with partial knowledge .",
    "such matrices were used to formulate general sufficient criteria for entanglement , which allow the evaluation of partial transposition for , in principle , arbitrary dimensions and measurement operators .",
    "the evm method was applied to a communication protocol with coherent signal states and homodyne detection . with",
    "the assistance of an intercept - resend strategy , detection of the first and second moments of the field quadratures was sufficient to attribute all possible measurement outcomes to either separable or entangled states .",
    "a more complete description of the measurements in terms of stokes operators revealed the inaptitude of the protocol to generate secret key .",
    "two examples of additional measurements were considered to rectify this issue .",
    "monitoring of the local oscillator intensity was found to recover the quadrature results . instead , monitoring the total intensity showed data sets neither explainable by entanglement verification nor by the best known intercept - resend strategy .",
    "thus , this last example demonstrated that the success of the presented method crucially depends on the choice and structure of bob s measurements .",
    "this example also underlined the need for a criterion to decide which expectation value matrices are physically valid , which would result in stronger separability conditions .",
    "this question is , however , unanswered at present , and subject to future research .",
    "+ moreover , the presented method is proposed as a simple way to test quantum devices , which may be of particular interest for the continuous - variable storage of light .",
    "two non - orthogonal signal states and detection of the first and second moments of the field quadratures of the output light suffice to verify the quantum operation of the memory , with no need for a complete reconstruction of the output density matrix .",
    "the particular light - atom interactions in the storage process are , as far as entanglement verification is concerned , not relevant .",
    "the authors would like to thank geir - ove myhr , matthias heid , volkher scholz , and johannes rigas as well as otfried ghne and natalia korolkova for helpful discussions .",
    "the help on proving observation 2 provided by marco piani and maciej lewenstein is gratefully acknowledged .",
    "the authors further thank christoffer wittmann and dominique elser for their help on experimental aspects .",
    "this work was funded by the european union through the ist integrated project secoqc and the ist - fet integrated project qap .",
    "further funding was received from the nserc innovation platform quantum works and the nserc discovery grant .",
    "@xcite , the constructed entanglement criteria are based on uncertainty relations . we will show that this approach is equivalent to our method based on partial transposition .",
    "@xcite constructed a symmetric version of the evm defined as @xmath154 with @xmath155 given by @xmath156 then the inequalities @xmath157 with @xmath158 are satisfied by all separable states , and violation implies entanglement .",
    "+ these two inequalities turn out to be equivalent to the conditions @xmath159 for the unsymmetrized evm .",
    "product entries can be split into their symmetrized product and commutator : @xmath160\\\\ & = \\frac{1}{2}(\\hat x \\hat p + \\hat p \\hat x ) + \\frac{1}{2 } \\mathbbm{i},\\end{aligned}\\ ] ] so that @xmath161 . + since bob s operators are transposed according to the rule @xmath162 and @xmath163 , we find that @xmath164 where @xmath165 $ ] and @xmath122 is given by ( [ eq : evmdef ] ) , with @xmath166 replaced by @xmath167 then @xmath168 , i.e. the two conditions ( [ eq : jcond ] ) are , up to a local unitary transformation , equivalent to ( [ eq : hcond ] ) .",
    "we show that theorem 2 in ref .",
    "@xcite applies to the infinite - dimensional case , i.e. , to states @xmath2 on @xmath3 with @xmath169 and @xmath170 .",
    "that is , we prove the statement that if such a state @xmath2 is invariant under transposition of subsystem @xmath34 , it is separable . to this end",
    ", we approximate @xmath2 by finite - dimensional states @xmath171 with normalization factor @xmath172 and the projection operator @xmath173 the vectors @xmath174 form a basis for system @xmath19 . intuitively , @xmath175 where @xmath176 denotes the trace norm . in other words ,",
    "the sequence @xmath177 is convergent .",
    "therefore , @xmath178 , @xmath179 @xmath180 such that @xmath2 and @xmath181 are closer than @xmath182 in trace distance .",
    "furthermore , @xmath181 is invariant under transposition of system @xmath34 : @xmath183^{t_a } \\\\      & = \\mathcal{n } [ ( \\mathbbm{1}_a \\otimes p_b^{(n)})^{t_a } \\rho_{ab}^{t_a } ( \\mathbbm{1}_a \\otimes p_b^{(n)})^{t_a } ] \\\\      & = \\mathcal{n } [ ( \\mathbbm{1}_a \\otimes p_b^{(n ) } ) \\rho_{ab}^{t_a } ( \\mathbbm{1}_a \\otimes p_b^{(n ) } ) ] \\\\      & = \\mathcal{n } [ ( \\mathbbm{1}_a \\otimes p_b^{(n ) } ) \\rho_{ab } ( \\mathbbm{1}_a \\otimes p_b^{(n ) } ) ] \\\\      & = \\sigma_{ab}^{(n)},\\end{aligned}\\ ] ] as by assumption , @xmath184 .",
    "therefore , @xmath181 is separable .",
    "consequently , @xmath2 is approximated by a convex combination of product states , so @xmath2 is separable @xcite ."
  ],
  "abstract_text": [
    "<S> we present a method to test quantum behavior of quantum information processing devices , such as quantum memories , teleportation devices , channels and quantum key distribution protocols . </S>",
    "<S> the test of quantum behavior can be phrased as the verification of effective entanglement . </S>",
    "<S> necessary separability criteria are formulated in terms of a matrix of expectation values in conjunction with the partial transposition map . </S>",
    "<S> our method is designed to reduce the resources for entanglement verification . </S>",
    "<S> a particular protocol based on coherent states and homodyne detection is used to illustrate the method . </S>",
    "<S> a possible test for the quantum nature of memories using two non - orthogonal signal states arises naturally . </S>",
    "<S> furthermore , closer inspection of the measurement process in terms of the stokes operators reveals a security threat for quantum key distribution involving phase reference beams . </S>"
  ]
}