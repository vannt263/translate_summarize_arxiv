{
  "article_text": [
    "it has been known for a long time that there is a wonderful interplay between discrete time stochastic processes and partial differential equations , see the seminal paper by courant , friedrichs and lewy @xcite . since then , the pioneering work of feller revealed deep connections to second order differential equations with `` complicated '' boundary conditions , see the monograph by mandl @xcite for further details .",
    "our intention with this work is to go back to the roots and explore the connections of large systems of ordinary differential equations to parabolic partial differential equations with various ( wentzell , robin ) boundary conditions from a rather particular point of view : given a large system of ordinary differential equations , we construct an `` approximating '' partial differential equation , give estimates on the accuracy of this approximation , and show that in some cases it is much easier to handle the parabolic equation than the large ode system .    the main motivation of this theoretical investigation is to approximate a dynamic process on a network by a partial differential equation .",
    "the network is given by an undirected graph and the process is specified by the possible states of the nodes and the transition probabilities .",
    "typical examples are epidemic processes and opinion propagation on networks . analysing the mean field approximation for the expected number of infected nodes in an epidemic process on a large network we were led to a first order pde approximation in our previous work btkai et al .",
    "@xcite . in a recent paper , in which regular random , erds - rnyi ,",
    "bimodal random , and barabsi - albert graphs are studied , we have shown that a suitable choice of the coefficients in the master equation leads to an ode approximation with tridiagonal transition rate matrices ( see nagy , kiss and simon @xcite ) .",
    "our study in this paper aims at approximating dynamic processes on networks , for which the transition rate matrix of the underlying markov chain has a tridiagonal structure ( with a possible extension to similar matrices ) .",
    "the paper is organized as follows .",
    "first , we introduce our general notation and setup along with a standard heuristic derivation of an approximating pde with dynamic boundary conditions via finite differences .",
    "it is followed by a different finite difference approximation to yield an approximating pde with robin boundary conditions .",
    "then in section 4 we present the operator semigroup theoretic setup with the general approximation theorems needed , and we show how to use the well - developed operator matrix approach to differential operators with wentzell boundary conditions due to engel and coauthors @xcite to prove error estimates .",
    "finally , in the last section we illustrate our results with two examples : the first one is the propagation of two opinions along a cycle graph , called a voter - like model , the second is an @xmath0 type epidemic propagation on a complete graph .",
    "in this section we fix our notation , collect the main definitions , derive the first approximating partial differential equation , and give the main heuristics which lie behind our approximation .",
    "let @xmath1 be a large , fixed integer , and @xmath2 and @xmath3 real - valued functions on @xmath4 $ ] .",
    "for @xmath5 , let @xmath6 , @xmath7 , and @xmath8 .",
    "consider the following tridiagonal matrix @xmath9 and the corresponding ( ode ) system @xmath10 on @xmath11 .",
    "we wish to approximate the solution @xmath12 to this ( ode ) by considering it as a discretisation of a continuous function @xmath13 on the interval @xmath14 $ ] , i.e. , @xmath15 for @xmath5 .",
    "now we derive an approximate ( pde ) for the function @xmath16 using the ( ode ) given above . for any @xmath17",
    "we have : @xmath18 by considering the approximations @xmath19 and @xmath20 using the functions @xmath2 and @xmath3 , and writing @xmath21 , we obtain the approximate ( pde ) @xmath22 valid for @xmath23 . note that the approximation is of order @xmath24 .    on the boundary ,",
    "similar transformations yield the first order boundary equations @xmath25 and @xmath26 note that here the approximations are only of order @xmath27 .",
    "the initial condition @xmath28 is to be chosen as a suitable interpolation of the values @xmath29 at @xmath30 ( @xmath5 ) .",
    "motivated by stochastic processes , we restrict ourselves here to the important special case where the column sums of the matrix @xmath31 are zero , i.e. , @xmath32 , and @xmath33 .",
    "our aim is to find a pde with suitable boundary condition the appropriate discretisation of which results in ( [ eq : ode ] ) , and which preserves the integral of the initial function .",
    "let us seek the pde in the form @xmath34 where @xmath35 and @xmath36 $ ] , and the functions @xmath37 and @xmath38 are to be defined . for the derivation of the boundary conditions we take into account the requirement that @xmath39.\\ ] ] integrating ( [ eq : pde ] ) on @xmath40 $ ] we obtain the equality @xmath41 which obviously holds if @xmath42 @xmath43 hold .",
    "consider now the continuous problem ( [ eq : pde ] ) with boundary conditions ( [ eq : bc1])-([eq : bc2 ] ) and an initial condition @xmath28 obtained from a suitable interpolation of @xmath44 in ( [ eq : ode ] ) .",
    "denote the approximation of the solution at the point @xmath45 by @xmath46 .",
    "we seek the functions @xmath37 and @xmath38 such that by approximating appropriately the derivatives w.r.t .",
    "the variable @xmath47 in ( [ eq : pde ] ) , for the functions @xmath48 @xmath49 we obtain a system of ode s of the form ( [ eq : ode ] ) .",
    "let us approximate the partial derivatives w.r.t .",
    "@xmath47 for the mesh points of the indices @xmath50 by central differences .",
    "to this aim we define two virtual mesh points : @xmath51 and @xmath52 , where the corresponding solutions will be denoted by @xmath53 and @xmath54 , respectively .",
    "then @xmath55 for @xmath50 .",
    "eliminate @xmath56 in the equation for @xmath57 by considering the left - hand side boundary condition ( [ eq : bc1 ] ) .",
    "to do so , we approximate the derivative w.r.t . @xmath47 by central difference , while the function value by the arithmetic mean of the two neighboring values , @xmath56 and @xmath58 , to obtain @xmath59 from this we have @xmath60 which yields @xmath61 comparing to the first equation of , we have @xmath62 comparing the further equations of ( [ eq : u_k ] ) with system ( [ eq : ode ] ) , we obtain the relations @xmath63 it is easy to see that @xmath32 , and similar considerations on the right boundary show that @xmath64 the functions @xmath37 and @xmath38 can be determined from the equations to obtain @xmath65 from which @xmath66 follows .",
    "the order of approximation of this scheme is yet to be calculated .",
    "for @xmath67 the approximation is obviously of order @xmath24 as in the previous example .",
    "however , in the points @xmath68 and @xmath69 ( corresponding to @xmath57 and @xmath70 ) it has only order of @xmath27 , since for @xmath68 we have @xmath71 for @xmath69 similar relations hold .    in the following we consider the exact pde and its solution , the latter being the approximation of the exact solution to the ode at the points @xmath72 , and",
    "show estimates on how good this approximation is .",
    "now we give a rather general setup to prove the desired estimates on the approximation .",
    "we use the theory of operator semigroups and our general reference is engel and nagel @xcite , zagrebnov @xcite , or btkai et al .",
    "@xcite .",
    "[ c : apro1.ass : approx_space ] let @xmath73 , @xmath74 be banach spaces and assume that there are bounded linear operators @xmath75 , @xmath76 with the following properties :    * there is a constant @xmath77 with @xmath78 for all @xmath79 , * @xmath80 , the identity operator on @xmath73 , and * @xmath81 as @xmath82 for all @xmath83 .",
    "[ c : apro1.ass : approx_gener ] suppose that the operators @xmath84 , @xmath85 generate strongly continuous semigroups on @xmath73 and @xmath74 , respectively , and that there are constants @xmath86 , @xmath87 such that the stability condition @xmath88    we will make use of a special variant of the trotter - kato theorem , which we cite here for convenience , see the lectures by btkai , csoms , farkas and ostermann ( * ? ? ?",
    "* proposition 3.8 ) .",
    "[ prop : appr_first_gen ] suppose that assumptions [ c : apro1.ass : approx_space ] hold , that there is a dense subset @xmath89 invariant under the semigroup @xmath90 such that @xmath91 , and that @xmath92 is a banach space with some norm @xmath93 satisfying @xmath94 if there are constants @xmath95 and @xmath96 with the property that for all @xmath97 @xmath98 then for each @xmath99 there is @xmath100 such that @xmath101 moreover , this convergence is uniform in @xmath102 on compact intervals .    this result can be slightly improved in case analytic semigroups are involved .",
    "[ lem : anal_approx ] suppose that the conditions of proposition [ prop : appr_first_gen ] are satisfied and that @xmath85 generates an analytic semigroup . if there is @xmath103 and there are spaces @xmath104 such that @xmath105 for all @xmath106 and @xmath107 holds , then @xmath108 for all @xmath109 and @xmath110 .",
    "note that this condition is for example satisfied if there is @xmath111 so that @xmath112 and @xmath113 holds .    as in the proof of btkai , kiss , sikolya and simon (",
    "* lemma 5 ) , we have the representation @xmath114 for all @xmath115 .",
    "hence , using the analyticy of the semigroup @xmath90 , we obtain the norm estimate @xmath116 where the constants @xmath117 , @xmath118 and @xmath119 only depend on @xmath99 .",
    "we have seen in the calculations of the previous sections that our approximation is of third order in the interior of the interval and of second order on the boundary .",
    "let us formalize now the calculations and put them into the general framework presented above .",
    "our aim is now to show that sufficiently smooth initial values the derived partial differential equation with dynamic boundary conditions and is the right approximation to the ordinary differential equation .    as a first step",
    ", we have to associate to the partial differential equation with boundary conditions and a banach space @xmath74 and a generator @xmath85 . following the approach of engel @xcite or btkai and engel @xcite",
    ", we introduce the spaces @xmath120,\\ ] ] and @xmath121 let us also consider the operators @xmath122 defined on its maximal possible domain , @xmath123 $ ] , and @xmath124 defined on @xmath125 and mapping to @xmath126 .",
    "our associated operator should be @xmath127    further , for a function @xmath128 $ ] we introduce the notation @xmath129    after all these preparations , we can state the main result of this section .",
    "[ thm : main ] consider the ordinary differential equation given by and the approximating partial differential equation with dynamic boundary conditions and , where @xmath130 .",
    "if there is @xmath131 such that @xmath132 , then for all @xmath133 there is @xmath134 such that for all @xmath36 $ ] we get @xmath135    by engel @xcite or btkai and engel ( * ? ? ?",
    "* remark 4.4 ) , the operator @xmath85 generates an analytic semigroup of angle @xmath136 in the space @xmath74 , and this semigroups gives the solutions of the partial differential equation with dynamic boundary conditions and .",
    "further , we introduce the spaces @xmath137 and define the operators @xmath138 as @xmath139 and take @xmath140 to be a suitable interpolation . clearly , these operators and spaces satisfy the conditions in assumptions [ c : apro1.ass : approx_space ] .    abusing the matrix notation ,",
    "define now on @xmath141 the operator @xmath142    taking @xmath143 ( i.e. , @xmath144 and @xmath145 , we see that    @xmath146    and that @xmath147 for @xmath148 , and @xmath149    by the calculations of the previous section , we see that there is @xmath95 such that latexmath:[\\[\\begin{aligned }        hold .",
    "since @xmath85 generates an analytic semigroup , it leaves @xmath151 $ ] invariant .",
    "hence , proposition [ prop : appr_first_gen ] is applicable with @xmath151 $ ] and we obtain the desired estimate for all @xmath152 . to improve this result and relax the regularity assumption on the initial value",
    ", we use the analyticity of the semigroup and lemma [ lem : anal_approx ] with @xmath153 .    introducing the notation @xmath154 ,",
    "our aim now is to show that @xmath155\\cap c^3(0,1)$ ] .",
    "since @xmath156 $ ] , it is enough to show that @xmath157 .",
    "let @xmath158 such that @xmath159 .",
    "then by engel and nagel ( * ? ? ?",
    "* corollary ii.5.28 ) , @xmath160 further , by checking the explicit representation of the resolvent as in the proof in engel and nagel ( * ? ? ?",
    "* theorem vi.4.5 ) , we see that the resolvent is given by the combination of exponential terms and a convolution term . since we are in the interior of the domain , we can drop the exponential terms because they do not disturb regularity and concentrate on the convolution term .",
    "hence we may assume that @xmath161 rewriting , we obtain @xmath162 formally differentiating with respect to @xmath163 behind the first integral , we obtain @xmath164 since this improper integral converges uniformly in @xmath163 on any closed subinterval of @xmath165 , and depends continuously on @xmath163 , the function @xmath166 is indeed continuously differentiable on @xmath165 .      using analogous argument , we can prove the approximating property of the pde with robin boundary conditions .",
    "to this end , we introduce the space @xmath167 $ ] and the operator    @xmath168    with domain @xmath169\\cap c^2(-\\tfrac{h}{2},1+\\tfrac{h}{2})\\,:\\\\    \\frac{\\dd}{\\dd z}\\big(h^2\\frac{a(z)+c(z)}{2}f(z)\\big)+\\big(h\\frac{c(z)-a(z)}{2}f(z)\\big ) = 0 \\\\   \\text { for } z=-\\tfrac{h}2 , 1+\\tfrac{h}{2}\\big\\}.\\end{gathered}\\ ] ] further , as before , for a function @xmath128 $ ] we use the notation @xmath129    [ thm : main2 ] consider the ordinary differential equation given by and the approximating partial differential equation with robin - type boundary conditions and , where @xmath130 . if there is @xmath131 such that @xmath132 , then for all @xmath133 there is @xmath134 such that for all @xmath36 $ ] we get @xmath170    the proof can be carried out in a completely analogous way as for the previous theorem . for second order differential operators with robin - type boundary conditions we refer to the works by arendt and coauthors @xcite or warma @xcite .",
    "the main motivation of the previous theoretical investigation is to approximate a dynamic process on a network with a partial differential equation and to justify empirical observations .",
    "the network is usually given by an undirected graph and the process can be specified by the possible states of the nodes and the transition rate probabilities .",
    "the latter is the probability that the state of a node changes from one state to another depending on the states of the neighbouring nodes . in certain classes of models",
    "the complete state space can be reduced ( using e.g. mean field approximations or structural symmetries ) , leading to tridiagonal systems .    in this section",
    "we show in two cases how the theory can be applied .",
    "the first one is the propagation of two opinions along a cycle graph , called a voter - like model , the second is an @xmath0 type epidemic propagation on a complete graph . as usual in the literature , in both models the natural markov process is conditioned on not reaching the absorbing state(s ) .",
    "let us consider a cycle graph with @xmath171 nodes , i.e. we have a connected graph , in which each node has two neighbours .",
    "a node can be in one of two states , let us denote them by 0 and 1 .",
    "these states represent two opinions propagating along the edges of the graph ( see holley and liggett @xcite ) .",
    "if a node is in state 0 and has @xmath172 neighbours in state 1 ( @xmath173 ) , then its state will change to 1 with probability @xmath174 in a small time interval @xmath175 .",
    "this expresses that opinion 1 invades that node .",
    "the opposite case can also happen , that is a node in state 1 can become a node with opinion 0 with a probability @xmath176 in a small time interval @xmath175 , if it has @xmath172 neighbours in state 0 .",
    "the parameters @xmath177 and @xmath178 characterize the strengths of the two opinions .",
    "the model originates in physics , where in a network of interacting particles each node holds either spin 1 or -1 ( see vazquez and eguiluz @xcite ) . in a single event",
    ", a randomly chosen node adopts the spin of one of its neighbors , also chosen at random .    assuming that at the initial instant the territories of the two opinions are connected sets , the underlying conditioned markov chain can be given as follows .",
    "the state space is the set @xmath179 , where a number @xmath172 represents the state in which there are @xmath180 nodes in state 1 and they form a connected arc along the cycle graph . starting from state @xmath172 the system can move either to state @xmath180 or to @xmath181 , since at a given instant only one node can change its state ( by using the usual assumption that the changes at the nodes can be given by independent poisson processes ) .",
    "when the system moves from state @xmath172 to @xmath180 then a new node in state 1 appears at one of the two ends of the arc of state 1 nodes .",
    "hence the rate of this transition is @xmath182 , expressing that a node in state 0 and having a single neighbour in state 1 becomes a state 1 node , and this can happen at both ends of the state 1 territory .",
    "similarly , the rate of transition from state @xmath172 to @xmath181 is @xmath183 .",
    "let us denote by @xmath184 the probability that the system is in state @xmath172 .",
    "the above transition rates lead to the differential equation @xmath185 ( for @xmath57 and for @xmath186 the equations contain only two terms . ) thus our system of odes takes the form given in ( [ eq : ode ] ) with @xmath187 , @xmath188 and @xmath189}\\equiv -2(\\tau+\\gamma)$ ] , @xmath190 , @xmath191 , yielding to the differential equation @xmath192 with the matrix @xmath193 subject to the initial condition @xmath194 . using ( [ eq : pde_main ] ) the corresponding approximating pde is then given by : @xmath195    to illustrate the effectiveness of our method numerically , we consider the special case of @xmath196 , leading to the simplified equations @xmath197 where the associated generator has all its eigenvalues in @xmath198 $ ] . wishing to apply the fourier method",
    ", we look for the solution in the form @xmath199 it is enough to find the eigenfunctions @xmath200 .",
    "the pde and the boundary conditions then yield the system of equations @xmath201 the first equation yields @xmath202 with @xmath203 , @xmath204 . substituting into the first boundary condition we obtain @xmath205 , allowing us to choose @xmath206 and hence write @xmath207 now substituting into the second boundary condition we obtain @xmath208 this has exactly one solution in each interval @xmath209 for @xmath210 .",
    "the constants @xmath211 are determined by the initial condition @xmath212    introducing the infinite matrix @xmath213 , where @xmath214 is the @xmath215 scalar product , and the vectors @xmath216 and @xmath217 , this leads to the equation @xmath218 for the fourier coefficients of the solution .    , @xmath219 at time @xmath220 obtained from system ( [ eq : odevoter ] ) ( circles ) and the solution @xmath221 of the pde ( [ eq : pdevoter ] ) at time @xmath220 ( continuous line ) , with initially 200 nodes in state 1 with probability 1 , and with @xmath222 , @xmath223 , @xmath224.,width=377 ]    in figure [ fig1 ] the solution of system ( [ eq : odevoter ] ) is compared to the solution of the pde ( [ eq : pdevoter ] ) when @xmath225 , the latter was plotted using the fourier method with the first 40 eigenfunctions .",
    "the first 40 eigenvalues were determined by using newton s method within each interval given above , and then we solved equation ( [ eq : fourier ] ) restricted to the first 40 variables .",
    "we observed that on our desktop computer matlab needed 15.719000 seconds to get the ode solution at @xmath226 , while for the fourier method 0.016000 seconds were needed to solve the pde .",
    "we also compared the solutions of the ode and the pde for the robin - type boundary condition .",
    "for the voter - like model equation has the form @xmath227 with @xmath228 $ ] , and the robin - type boundary conditions read as @xmath229 for @xmath230 $ ] .",
    "the system ( [ eq : odevoter ] ) was solved with matlab s ode45 solver , while the partial differential equation with matlab s pdepe solver .",
    "the results of the comparison are shown in fig .",
    "[ abra_robin ] at time @xmath220 for two different parameter choices .",
    "[ h ! ]",
    "the second motivation of our study comes from epidemiology where a paradigm disease transmission model is the simple susceptible - infected - susceptible ( @xmath0 ) model on a completely connected graph with @xmath231 nodes , i.e. all individuals are connected to each other . from the disease dynamic viewpoint ,",
    "each individual is either susceptible ( @xmath232 ) or infected ( @xmath233 )  a susceptible one with @xmath180 infected neighbours can be infected at rate ( @xmath234 ) and the infected ones can recover at a given rate ( @xmath178 ) and become susceptible again . since the graph is complete , the state space is the set @xmath179 , where a number @xmath172 represents the state in which there are @xmath172 infected nodes . starting from state @xmath172",
    "the system can move either to state @xmath180 or to @xmath181 , since at a given instant only one node can change its state .",
    "when the system moves from state @xmath172 to @xmath180 then a susceptible node becomes infected .",
    "hence the rate of this transition is @xmath235 , expressing that any of the @xmath236 susceptible nodes can become infected and each of them has @xmath172 infected neighbours ( since the graph is complete ) . the rate of transition from state @xmath172 to @xmath181 is @xmath237 , because any of the @xmath172 infected nodes can recover .",
    "let us denote by @xmath184 the probability that the system is in state @xmath172 , i.e. there are @xmath172 infected nodes .",
    "the above transition rates lead to the differential equation @xmath238 ( for @xmath57 and for @xmath186 the equations contain only two terms . )",
    "thus our system of odes takes the form given in ( [ eq : ode ] ) with @xmath239 , @xmath240 and @xmath241 , that is @xmath242 , @xmath243 and @xmath244 .",
    "we note that an approximation of this system by a first order pde was investigated in btkai , kiss , sikolya and simon @xcite . according to ( [ eq : pde_main ] ) our method yields the following second order approximation @xmath245",
    "our theorem implies that the solution of this pde approximates the solution of the corresponding ode ( [ eq : ode ] ) in the order of @xmath246 .",
    "we note that the usually used first order pde approximates the ode in the order of @xmath247 .",
    "the advantage of that first order pde is that it can be solved analytically yielding the well - known mean - field approximation for the expected number of infected nodes , see btkai et al .",
    "our second order pde can not be solved analytically , hence only a numerical approximation can be obtained by using our method . it is the subject of future work to derive pde approximations for epidemic propagation on different random graphs and compare their solutions to those of the original ode system .",
    "supported by the otka grant nr .",
    "k81403 and by the european research council advanced researcher grant no .",
    "227701 ( leader : l. lovsz ) .",
    "a.  btkai , i.z .",
    "kiss , e. sikolya , p.l .",
    "simon , _ differential equation approximations of stochastic network processes : an operator semigroup approach _ , networks and heterogeneous media ( nhm ) * 7 * ( 2012 ) , 4358 . `",
    "doi:10.3934/nhm.2012.7.43 `      k .- j .",
    "engel , _ second order differential operators on @xmath248 $ ] with wentzell  robin boundary conditions _ ,",
    "evolution equations : proceedings in honor of j. a. goldstein s 60th birthday ( g.  ruiz goldstein , r.  nagel , and s.  romanelli , eds . ) , lect .",
    "notes in pure and appl . math .",
    "234 , marcel dekker , 2003 , pp ."
  ],
  "abstract_text": [
    "<S> a large system of ordinary differential equations is approximated by a parabolic partial differential equation with dynamic boundary condition and a different one with robin boundary condition . using the theory of differential operators with wentzell boundary conditions and similar theories , </S>",
    "<S> we give estimates on the order of approximation . </S>",
    "<S> the theory is demonstrated on a voter model where the fourier method applied to the pde is of great advantage . </S>"
  ]
}