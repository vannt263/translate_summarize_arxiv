{
  "article_text": [
    "we consider the problem of cluster detection in a network .",
    "the network is modeled as a graph , and we assume that a random variable is observed at each node .",
    "the task is then to detect a cluster , that is , a connected subset of nodes with values that are larger than usual .",
    "there are a multitude of applications for which this model is relevant ; examples include detection of hazardous materials ( hills  @xcite ) and target tracking ( li  _ et  al . _",
    "@xcite ) in sensor networks ( culler , estrin and srivastava @xcite ) , and detection of disease outbreaks ( heffernan _ et al .",
    "_ @xcite ; rotz and hughes  @xcite ; wagner _",
    "et al . _",
    "pixels in digital images are also sensors , and thus many other applications are found in the rich literature on image processing , for example , road tracking ( geman and jedynak @xcite ) and fire prevention using satellite imagery ( pozo , olmo and alados - arboledas  @xcite ) , and the detection of cancerous tumors in medical imaging ( mcinerney and terzopoulos  @xcite ) .    after specifying a distributional model for the observations at the nodes and a class of clusters to be detected",
    ", the generalized likelihood ratio ( glr ) test is the first method that comes to mind .",
    "indeed , this is by far the most popular method in practice , and as such , is given different names in different fields .",
    "the likelihood ratio is known as the scan statistic in spatial statistics ( kulldorff @xcite ) and the corresponding test as the method of matched filters in engineering ( jain , zhong and dubuisson - jolly  @xcite ; mcinerney and terzopoulos @xcite ) . here",
    "we use the former , where scanning a given cluster @xmath0 means computing the likelihood ratio for the simple alternative where @xmath0 is the anomalous cluster .",
    "various forms of scan statistic have been proposed , differing mainly by the assumptions made on the shape of the clusters .",
    "most methods assume that the clusters are in some parametric family ( e.g. , circular ( kulldorff and nagarwalla  @xcite ) , elliptical ( hobolth , pedersen and jensen  @xcite ; kulldorff _ et al . _",
    "@xcite ) ) or , more generally , deformable templates ( jain , zhong and dubuisson - jolly  @xcite ) . sometimes no explicit shape is assumed , leading to nonparametric models ( duczmal and assuno  @xcite ; kulldorff , fang and walsh @xcite ; tango and takahashi  @xcite ) .",
    "we consider two alternative nonparametric methods , both based on the percolative properties of the network , that is , based on the connected components of the graph after removing the nodes with values below a given threshold .",
    "the simplest is based on the size of the largest connected component after thresholding  the threshold is the only parameter of this method .",
    "if the graph is a one - dimensional lattice , then after thresholding , this corresponds to the test based on the longest run ( balakrishnan and koutras  @xcite ) , which chen and huo  @xcite adapt for path detection in a thin band .",
    "this test has been studied in a similar context in a series of papers ( davies , langovoy and wittich  @xcite ; langovoy and wittich  @xcite ) under the name of maximum cluster test .",
    "the idea behind this method is simple .",
    "when an anomalous cluster is indeed present , the values at the nodes belonging to this cluster are larger than usual and thus more likely to survive the threshold , and because these nodes are also likely to clump together  because the cluster is connected in the graph  the size of the statistic will be ( stochastically ) larger than when no anomalous cluster is present .    more sophisticated , and also parameter - free ,",
    "is the method based on the upper level set scan statistic of patil and taillie @xcite , subsequently developed in the context of ecological and environmental applications ( patil , joshi and koli  @xcite ; patil and taillie  @xcite ; patil _ et al . _",
    "it is the result of scanning over the connected components of the graph after thresholding , which is repeated at all thresholds .",
    "this method obviously is closely related to the scan statistic .",
    "it can be seen as attempting to approximate the scan statistic over all possible connected components of the graph by restricting the class of subsets to be scanned to those surviving a threshold .",
    "our results indicate that this method is in fact more closely related to the previous one ( based on the size of the largest connected component at a given threshold ) , and in some sense provides a way to automatically choose the threshold .",
    "these two percolation - based methods have two significant advantages over the scan statistic .",
    "first , they do not need to be provided with the shape of the clusters to be detected .",
    "thus they are valuable in settings with less previous spatial information .",
    "the second advantage is computational .",
    "the scan statistic tends to be computationally demanding , even in parametric settings , or even outright intractable , particularly in nonparametric settings .",
    "in contrast , these two methods are computationally feasible , and their implementation is fairly straightforward , even for irregular networks .",
    "on the other hand , the scan statistic often relies on the fast fourier transform in the square lattice to scan clusters of known shape over all locations in that network .",
    "in terms of detection performance , we compare these percolation - based methods to the scan statistic in a standard asymptotic decision theoretic framework where the network is a square lattice of growing size and the variables at the nodes are assumed i.i.d . for nodes inside ( resp . , outside ) the anomalous cluster . the performance of the scan statistic in such a framework is well understood and known to be ( near- ) optimal , which makes it the gold standard in detection ( arias - castro , cands and durand  @xcite ; arias - castro , donoho and huo  @xcite ; perone pacifico _",
    "et al . _",
    "@xcite ; walther @xcite ) .",
    "we find that these two methods are suboptimal for the detection of hypercubes , an emblematic parametric class , but are near - optimal for the detection of self - avoiding paths , an emblematic nonparametric class .",
    "the main weakness of these percolation - based methods is that when the per - node signal - to - noise ratio is weak , the connected components after thresholding are heavily influenced by the whimsical behavior of the values at the nodes .",
    "the scan statistic is very effective in such situations .",
    "although this rationale seems to apply particularly well in the case of self - avoiding paths , what makes these methods competitive in this case is that the problem of detecting such objects is intrinsically very hard .",
    "the study of the connected components after thresholding is intrinsically connected to percolation theory ( grimmett @xcite ) , an important branch in probability theory .",
    "in fact , when the node values are i.i.d .",
    " which is the case when no anomalous cluster is present  the only dependence on the distribution at the nodes is the probability of surviving the threshold , and after thresholding , the network is a site percolation model .",
    "( we introduce and discuss these notions in detail later in the article . )",
    "our contribution is a careful analysis of these two nonparametric methods using percolation theory ( grimmett  @xcite ) in a substantial way , thus applying percolation theory in a sophisticated fashion to shed light on an important problem in statistics .",
    "the rest of the paper is organized as follows . in section  [ sec : setting ] we formally introduce the framework and state some fundamental detection bounds . in section  [ sec : scan ] we describe the standard scan statistic and present some results on its performance , showing that it is essentially optimal . in section  [ sec : cc ] , we consider the size of the largest connected component after thresholding . in section  [ sec : uls ] , we consider the upper level set scan statistic .",
    "we briefly discuss implementation issues and present some numerical experiments in section  [ sec : numerics ] . finally , section  [ sec : discussion ] is a discussion section where , in particular , we mention extensions .",
    "we provide proofs in the .",
    "for concreteness , and also for its relevance to signal and image processing , we model the network as a finite subgrid of the regular square lattice in dimension @xmath1 , denoted @xmath2 .",
    "our analysis is asymptotic in the sense that the network is assumed to be large , that is , @xmath3 . to each node @xmath4",
    ", we attach a random variable , @xmath5 .",
    "for example , in the context of a sensor network , the nodes represent the sensors and the variables represent the information that they transmit .",
    "the random variables @xmath6 are assumed to be independent with common distribution in a certain one - parameter exponential family @xmath7 , defined as follows .",
    "let @xmath8 , let @xmath9 be a distribution function with finite non - zero variance @xmath10 , and assume the that moment - generating function @xmath11 is finite for @xmath12 .",
    "then @xmath13 is the distribution function with density @xmath14 with respect to @xmath9 .",
    "we assume further regularity of @xmath9 at later points in this paper . note that our results apply to other distributional models as well , as discussed in section  [ sec : discussion ] .",
    "examples of such a family @xmath15 include the following :    * _ bernoulli model _ : @xmath16 , @xmath17 , relevant in sensor arrays where each sensor transmits one bit ( i.e. , makes a binary decision ) * _ poisson model _ : @xmath18 , popular with count data , for example , arising in infectious disease surveillance systems * _ exponential model _ : @xmath19 ( e.g. , to model response times ) * _ normal location model _ : @xmath20 , standard in signal and image processing , where noise is often assumed to be gaussian .",
    "let @xmath21 be a class of clusters , with a cluster defined as a subset of nodes connected in the graph . under the null hypothesis ,",
    "all of the variables at the nodes have distribution @xmath22 , that is , @xmath23 under the particular alternative where @xmath24 is anomalous , the variables indexed by @xmath0 have distribution @xmath25 for some @xmath26 , that is , @xmath27 we are interested in the situation where the anomalous cluster @xmath0 is unknown , namely in testing @xmath28 against @xmath29 .",
    "we illustrate the setting in figure  [ fig : setting ] in the context of the two - dimensional square grid .     for a beta model where @xmath30 and @xmath31 .",
    "( left ) an instance of the null hypothesis .",
    "( middle ) an instance of an alternative with a square cluster .",
    "( right ) an instance of an alternative with a path . ]",
    "let @xmath21 denote a cluster class for @xmath32 .",
    "as usual , a test @xmath33 is a function of the data , @xmath34 , that takes values in @xmath35 , with @xmath36 corresponding to a rejection , meaning a decision in favor of @xmath37 . for a test @xmath33",
    ", we define its worst - case risk as the sum of its probability of type i error and its probability of type ii maximized over the anomalous clusters in the class @xmath38 a method is formally defined as a sequence of tests @xmath39 for testing @xmath28 versus @xmath37 .",
    "we say that a method @xmath39 is asymptotically powerless if @xmath40 this amounts to saying that as the size of the network increases , the method @xmath39 is not substantially better than random guessing .",
    "conversely , a method @xmath39 is asymptotically powerful if @xmath41 the minimax risk is defined as @xmath42 , and we say that a method is @xmath39 ( asymptotically ) optimal if @xmath43 whenever @xmath44 .",
    "everything else fixed , the latter depends on the behavior of @xmath45 when @xmath46 becomes large .",
    "we say that @xmath39 is optimal up to a multiplicative constant @xmath47 if @xmath48 under @xmath49 whenever @xmath44 under @xmath45 .",
    "we say that @xmath39 is near - optimal if the same is true with @xmath50 replaced by @xmath51 with @xmath52 .",
    "( this occurs here only when @xmath53 polynomially fast and @xmath51 poly - logarithmically fast . )",
    "we focus on situations where the clusters in the class @xmath21 are of same size , increasing with @xmath46 but negligible compared with the size of the entire network .",
    "we do so for the sake of simplicity ; more general results could be obtained as in arias - castro , cands and durand @xcite , arias - castro , donoho and huo  @xcite , perone pacifico _",
    "et al . _",
    "@xcite , walther  @xcite without additional difficulty . assuming a large anomalous cluster allows us to state general results applying to a wide range of one - parameter exponential families ( via the central limit theorem ) .",
    "in addition , note that on the one hand , reliably detecting a cluster of bounded size is impossible in the bernoulli model or any other model where @xmath9 has finite support , whereas on the other hand , detecting a cluster of size comparable to that of the entire network is in some sense trivial , given that the simple test based on the total sum @xmath54 is optimal up to a multiplicative constant .",
    "we consider two emblematic classes of clusters , in some sense at the opposite extremes :    * _ hypercube detection .",
    "_ let @xmath21 denote the class of _ hypercubes _ within @xmath32 of sidelength @xmath55 $ ] with @xmath56 .",
    "this class is parametric , with the location of the hypercube the only parameter . *",
    "_ path detection .",
    "_ let @xmath21 denote the class of _ loopless paths _ within @xmath32 of length",
    "@xmath55 $ ] with @xmath57 .",
    "this class is nonparametric , in the sense that its cardinality is exponential in the length of the paths .",
    "see figure  [ fig : setting ] for an illustration .",
    "( note that a hypercube of side length @xmath58 may be seen as a loopless path of length @xmath59 . )",
    "although we obtain results for both , our main focus is in the setting of hypercube detection , which is relevant to a wider range of applications , in fact any situation where the task is to detect a shape that is not filamentary .",
    "the situation exemplified in the setting of path detection may be relevant in target tracking from video , or the detection of cracks in materials in non - destructive testing .",
    "note that the two settings coincide in dimension one .",
    "we state fundamental detection bounds for each setting .",
    "the following result is standard ( see , e.g. , arias - castro , cands and durand  @xcite ; arias - castro , donoho and huo  @xcite ) .",
    "remember that @xmath10 denotes the variance of @xmath9 .",
    "[ lem : cube ] in hypercube detection , all methods are asymptotically powerless if @xmath60    in fact , the conclusions of lemma  [ lem : cube ] apply for a wide variety of parametric classes , such as discs , a popular model in disease outbreak detection ( kulldorff and nagarwalla  @xcite ) , as well as to nonparametric classes of blob - like clusters ( see arias - castro , cands and durand @xcite ; arias - castro , donoho and huo  @xcite ) .",
    "the following result is taken from arias - castro _ et al . _",
    "@xcite .",
    "[ lem : path ] in path detection , all methods are asymptotically powerless if @xmath61 , in dimension @xmath62 , and the same is true in dimension @xmath63 if @xmath64 , where @xmath65 depends only on @xmath1 .    in dimension @xmath66",
    ", @xmath67 may be taken to be the unique solution to @xmath68 where @xmath69 is the return probability of a symmetric random walk in dimension @xmath1 .",
    "for a subset of nodes @xmath70 , let @xmath71 denote its size and define @xmath72 given a cluster class @xmath73 , we define the ( simple ) scan statistic as @xmath74 where @xmath75 is the mean of @xmath9 .",
    "if @xmath75 is not available , we may use the grand mean @xmath76 instead . in appendix",
    ", we derive this form of the scan statistic as an approximation to the scan statistic of kulldorff @xcite , which is , strictly speaking , the glr and arguably the most popular version , particularly in spatial statistics .",
    "we use this simpler form to streamline our theoretical analysis .",
    "the test that rejects for large values of the scan statistic ( [ scan ] ) , which we call the scan test , is near - optimal in a wide range of settings ( arias - castro , cands and durand  @xcite ; arias - castro , donoho and huo @xcite ; walther  @xcite ) . in particular ,",
    "in the context of a class of hypercubes , and in fact many other parametric classes , this test is asymptotically optimal to the exact multiplicative constant .",
    "[ lem : scan - cube ] in hypercube detection , the scan test is asymptotically powerful if @xmath77    in the context of a class of paths , the following result states that the scan test detects if @xmath45 is bounded away from 0 and sufficiently large .",
    "note that this does not match the order of magnitude of the lower bound given in dimension @xmath62 .",
    "let @xmath78 and @xmath79 .",
    "$ ] ( @xmath80 is the rate function of @xmath9 when @xmath81 . ) the following result is established in arias - castro _ et al . _",
    "@xcite .",
    "[ lem : scan - path ] in path detection , the scan test is asymptotically powerful if @xmath82",
    "we study the test based on the size of the largest connected component after thresholding the values at the nodes .",
    "this test was independently considered in a series of papers ( davies , langovoy and wittich  @xcite ; langovoy and wittich @xcite ) .",
    "our results are seen to sharpen and elaborate on these results . in particular",
    ", we study this test under all three regimes ( subcritical , supercritical , and critical ) .",
    "adapting terminology from percolation theory ( grimmett @xcite ) , for a threshold @xmath83 , we say that a subset @xmath70 is open ( at threshold @xmath84 ) if @xmath85 for all @xmath86 .",
    "let @xmath87 ( resp . ,",
    "@xmath88 ) denote the size of the largest open cluster within @xmath32 ( resp .",
    ", within @xmath0 ) .",
    "the analysis of the test based on @xmath87 , which we call the largest open cluster ( loc ) test , boils down to bounding the size of @xmath87 from above , under @xmath28 , and , because @xmath89 , bounding the size of @xmath88 from below , under @xmath90 .",
    "define @xmath91 , which is bernoulli with parameter @xmath92 .",
    "the process @xmath93 is a site percolation model ( grimmett  @xcite ) . in general , consider a process @xmath94 i.i.d .",
    "bernoulli with parameter @xmath95 , and let @xmath96 denote the size of the largest open cluster within @xmath32 . in dimension",
    "@xmath97 , this process may be seen as a sequence of coin tosses , and @xmath96 viewed as the longest heads run in that sequence . in this context , the erds  rnyi law ( erds and rnyi  @xcite ) says that @xmath98 in higher dimensions @xmath99 , the situation is much more involved .",
    "let @xmath100 denote the critical probability for site percolation in @xmath101 , defined as the supremum over all @xmath102 such that the size of the open cluster at the origin , denoted by @xmath103 , is finite with probability 1 .",
    "( the dependency in @xmath1 is left implicit . )",
    "we consider the subcritical ( @xmath104 ) , supercritical ( @xmath105 ) , and near - critical ( @xmath106 ) cases separately .      in the subcritical case , where @xmath84 is such that @xmath104 , we are able to obtain precise , rigorous results on the performance of the test based on @xmath87 in terms of the function @xmath107 , implicitly defined as @xmath108 ( see grimmett  @xcite , section 6.3 ) . again , the dependency in @xmath1 is left implicit . as a function of @xmath109 , @xmath107 is continuous and strictly decreasing , with limits @xmath110 at @xmath111 and 0 at @xmath112 ( see lemma [ lem : zeta ] ) , whereas @xmath113 for @xmath114 . in the",
    ", we include a proof that @xmath115 for a subcritical threshold @xmath116 .",
    "the convergence result in ( [ s - conv ] ) may be used to bound @xmath87 under the null by taking @xmath117 . under the alternative ,",
    "if we consider a class of hypercubes , then ( [ s - conv ] ) also may be used to bound @xmath88 , because @xmath0 is a scaled version of @xmath32 .",
    "[ thm : cc - cube ] in hypercube detection , the test based on @xmath87 , with @xmath84 fixed such that @xmath118 , is asymptotically powerful if @xmath119 , and asymptotically powerless if @xmath120 , where @xmath121 is the unique solution to @xmath122 .",
    "note that when @xmath84 is fixed , @xmath123 as a function of @xmath124 is continuous and strictly strictly decreasing , by the fact that @xmath125 is continuous and strictly increasing in @xmath124 ( brown  @xcite , cor .",
    "2.6 , 2.22 ) and @xmath107 is continuous and strictly decreasing in @xmath95 ( lemma  [ lem : zeta ] ) .",
    "therefore , @xmath121 in the theorem is well defined .",
    "if instead , we consider a class of paths , then ( [ s1-conv ] ) may be used to bound @xmath88 , because @xmath0 is a scaled version of the lattice in dimension 1 . in congruence with ( [ s1-conv ] ) , we define @xmath126 .",
    "[ thm : cc - path ] in path detection , the test based on @xmath87 , with @xmath84 fixed such that @xmath118 , is asymptotically powerful if @xmath127 , and asymptotically powerless if @xmath128 , where @xmath129 ( resp . , @xmath130 ) is the unique solution to @xmath131 ( resp . , @xmath132 ) .",
    "note that in dimension @xmath99 , the result is not sharp , because we always have @xmath133 .",
    "we believe that sharper forms of this result may be substantially more involved , and for this reason we have not pursued this .",
    "qualitatively , the message is that for both hypercube detection and path detection , the subcritical loc test requires that @xmath45 be larger than a constant to be effective .",
    "compared with the scan statistic , this makes it grossly suboptimal when detecting hypercubes and comparable ( up to a multiplicative constant in @xmath45 ) when detecting self - avoiding paths .",
    "what if we let @xmath134 , so that @xmath135 ?",
    "then the test based on @xmath136 is powerless under some additional conditions on @xmath9 . for @xmath137 , consider the following class of approximately exponential power ( @xmath138 ) distributions , sometimes called subbotin distributions : @xmath139 ( @xmath140 is the survival distribution function of @xmath141 . ) for example , @xmath142 and @xmath143 , whereas @xmath144 behaves roughly as a distribution in @xmath145 .",
    "[ prp : t - large ] assume that @xmath146 for some @xmath147 and @xmath148 . in hypercube detection ,",
    "the test based on @xmath87 is asymptotically powerless when @xmath134 , unless @xmath149 .",
    "here we consider the supercritical regime , where @xmath105 .",
    "( note that necessarily @xmath99 for @xmath150 in dimension 1 . ) in this setting , too , the size of the largest cluster is well understood .",
    "let @xmath151 be the probability that the open cluster at the origin is infinite , and note that @xmath152 for @xmath153 , by the definition of @xmath100 .",
    "we have with probability 1 that @xmath154 ( see falconer and grimmett  @xcite , lemma 2 and proof , penrose and pisztora  @xcite , theorem  4 , pisztora  @xcite ) .",
    "in fact ( with probability @xmath155 ) , the largest open cluster within @xmath32 is unique , and the foregoing statement says that it occupies a non - negligible fraction of @xmath32 . with a supercritical choice of threshold , the loc test is powerless for any @xmath124 if the anomalous cluster is too small , specifically if @xmath156 in the setting of hypercube detection .",
    "indeed , we have the following result .",
    "[ thm : cc - cube - sup ] in hypercube detection , the test based on @xmath87 , with @xmath84 fixed such that @xmath157 , is asymptotically powerful if @xmath158 and @xmath159 , and asymptotically powerless if @xmath156 or if @xmath160 .    thus , for the detection of small clusters , a supercritical loc test is potentially worthless , whereas for larger clusters it improves substantially on the performance of a subcritical loc test , although it is still suboptimal compared with the scan statistic .",
    "( indeed , comparing the exponents when @xmath161 , we have @xmath162 , because @xmath163 . )",
    "we mention that in the context of path detection , the same arguments show that the loc test for any choice of supercritical threshold is asymptotically powerless .      if our goal is to choose a threshold @xmath84 so as to maximize the difference in size for the largest open cluster under the null and under an alternative , then we are necessarily in the neighborhood of the percolation phase transition , which is to say that @xmath164 is small .",
    "( again , here we assume @xmath99 . )",
    "the percolation model is not fully understood in the critical regime , which poses a serious obstacle to a rigorous statistical analysis .",
    "( see grimmett  @xcite , chapter 9 , for a general discussion of this percolation regime . )",
    "we base our discussion on the work of borgs _ et al .",
    "let @xmath165 denote the probability that the open cluster at the origin reaches outside the box @xmath166^d$ ] , and let @xmath167 denote the correlation length , defined as @xmath168 note that , with @xmath169 thus defined , @xmath170 if and only if @xmath171 . the critical exponent for ( subcritical ) correlation length is postulated to be @xmath172 it is not known whether the limit exists for all dimensions , but it is known that @xmath173 whenever it exists .",
    "it is shown in borgs _",
    "et al . _",
    "@xcite that , subject to the existence of this limit together with other scaling assumptions , when @xmath174 varies with @xmath46 , @xmath175 where @xmath176 means that there exists a constant @xmath177 such that @xmath178 in probability .",
    "the scaling assumptions of borgs _ et al . _",
    "@xcite are believed to hold if and only if the number @xmath1 of dimensions satisfies @xmath179 , and they are proved for @xmath62 .",
    "the work of borgs _ et al . _",
    "@xcite was directed at bond percolation only , but similar results are expected for site percolation .    it is known that @xmath180 for site percolation on the triangular lattice ( see smirnov and werner  @xcite ) , and it is believed that this holds for percolation on any two - dimensional lattice .",
    "as described in grimmett @xcite , section 10.4 , it is believed that @xmath181 for @xmath182 , and this has been proved for @xmath183 and for the so - called `` spread - out model '' in @xmath184 and more dimensions ( hara , van der hofstad and slade  @xcite ) .",
    "subject to the assumption that ( [ s - cri ] ) holds , we establish the power of the test based on @xmath87 when choosing @xmath185 near criticality .",
    "we assume that there exists @xmath186 such that @xmath187 , and that @xmath188 is a continuous function of @xmath84 in a neighborhood of @xmath186 .",
    "[ thm : cc - cube - cri ] let @xmath189 be such that @xmath190 for some @xmath191 . in hypercube detection , assuming that ( [ s - cri ] ) holds , the test based on @xmath136 is asymptotically powerful if @xmath192 is sufficiently large .",
    "compared with a subcritical choice of threshold , which requires that @xmath45 be bounded away from 0 for the test to have any power , as seen in theorem  [ thm : cc - cube ] , with a near - critical choice of threshold , the test is able to detect at polynomially small @xmath45 . in particular , with a proper choice of threshold , the test is powerful for @xmath45 of order @xmath193 with @xmath194 . note that , by lemma [ lem : cube ] , all methods are asymptotically powerless if @xmath195 is of order @xmath196 , implying that @xmath197 .",
    "we thus obtain the inequality @xmath198 .",
    "this may be compared with the scaling relation ( grimmett @xcite , equation  ( 9.23 ) ) stating that @xmath199 , where @xmath200 ( @xmath201 ) is the percolation critical exponent for the number of clusters per vertex .",
    "it is believed that @xmath202 when @xmath62 and @xmath203 when @xmath182 .",
    "compared with the performance at supercriticality , the test at near - criticality ( with a proper choice of threshold ) is superior if @xmath204 , which is equivalent to @xmath205 .",
    "for example , with @xmath202 , the near - critical loc test is superior when @xmath206 .",
    "for a threshold @xmath84 , let @xmath207 denote the ( random ) class of clusters within @xmath32 open at @xmath84 , and let @xmath208 , which is also random .",
    "patil and taillie  @xcite suggested scanning the clusters in @xmath209 . to facilitate a rigorous mathematical analysis of its performance , we consider the upper level set ( @xmath210 ) scan at a given threshold @xmath84 , and use the simple scan described in section [ sec : scan ] .",
    "specifically , in correspondence with ( [ scan ] ) , we define the ( simple ) @xmath210 scan statistic at threshold @xmath84 as @xmath211 where @xmath212 ( resp . , @xmath213 )",
    "is the the mean ( resp . ,",
    "variance ) of @xmath214 when @xmath215 , and @xmath216 is a non - decreasing sequence of positive integers .",
    "the @xmath210 scan statistic of patil and taillie  @xcite corresponds ( in its simple form ) to @xmath217 if @xmath212 and/or @xmath218 are not available , we may use their empirical versions based on the @xmath5 that survive the threshold @xmath84 .",
    "we restrict the scan to clusters of size at least @xmath219 to increase power , because the behavior of @xmath220 is , as we show later , completely driven by the smallest open clusters that are scanned , at least when @xmath84 is subcritical .",
    "we present the rest of our discussion in terms of subcritical , supercritical , and near - critical choices of threshold .",
    "we then conclude with a result on the performance of the @xmath210 scan test across all thresholds .",
    "we start by describing the behavior of @xmath221 under the null .",
    "let @xmath222 denote the distribution of @xmath214 under @xmath13 , and let @xmath223 and @xmath224 denote its mean and rate function , respectively .",
    "also , when @xmath225 , or @xmath226 and @xmath227 for some @xmath228 and @xmath229 , let @xmath230 , where @xmath231 is the function defined in lemma [ lem : gamma ] .",
    "note that @xmath232 can be computed explicitly in some cases , like the normal location model , and @xmath233 when @xmath234 , defined ( when it exists ) as the solution to @xmath235 .",
    "[ lem : uls - sub ] assume that @xmath236 and @xmath84 is fixed such that @xmath237 and that @xmath238 for some @xmath239 .",
    "then , under @xmath13 on @xmath32 , the following holds in probability :    1 .   if @xmath240 , then @xmath241 for @xmath46 large enough .",
    "2 .   if @xmath225 , then @xmath242 3 .   if @xmath226 and @xmath146 for some @xmath243 and @xmath229 , then a.   if @xmath228 , the convergence in part 2 applies ; b.   if @xmath244 , @xmath245    in the last case , where @xmath226 , the behavior of @xmath220 is influenced by the very large deviations of @xmath246 for @xmath247 .",
    "( the symbol @xmath248 denotes convolution . )",
    "we choose to state a result for @xmath138 distributions , for which the very large deviations resemble the large deviations .",
    "based on lemma  [ lem : uls - sub ] , we establish the performance of the @xmath210 scan statistic .",
    "we start by arguing that choosing @xmath219 such that @xmath249 leads to a test that may potentially have less power than the test based on the largest cluster after thresholding .",
    "indeed , the behavior of the @xmath210 scan statistic does not depend on @xmath124 as long as @xmath250 .",
    "[ prp : uls - bad ] assume that @xmath146 for some @xmath251 and @xmath148 . in hypercube detection ,",
    "the test based on @xmath221 , with @xmath84 fixed such that @xmath118 and @xmath252 , is asymptotically powerless if @xmath253 .",
    "for example , in the setting just described with @xmath97 , the @xmath210 scan test has ( asymptotically ) no power unless @xmath149 , whereas the test based on the size of the largest cluster after thresholding is , by theorem  [ thm : cc - cube ] , asymptotically powerful if @xmath254 is large enough .",
    "we therefore choose a sequence @xmath219 comparable in magnitude to @xmath255 and state the performance of the @xmath210 scan test in this case .",
    "[ thm : uls - cube ] in hypercube detection , the test based on @xmath221 , with @xmath84 fixed such that @xmath118 and @xmath238 with @xmath256 , is asymptotically powerful if @xmath119 and asymptotically powerless if @xmath120 , where @xmath121 is the unique solution to latexmath:[$\\alpha\\gamma_{\\theta     note that @xmath121 is well defined by lemma  [ lem : gamma - prop ] and that @xmath258 as long as @xmath259 . in any case , the test based on @xmath221 with a subcritical threshold @xmath84 is , in the setting of hypercube detection , asymptotically powerless when @xmath260 , just like the loc test .",
    "in essence , the two tests are qualitatively comparable in this setting .",
    "this is also true in the context of path detection .",
    "let @xmath261 in path detection , the test based on @xmath221 , with @xmath84 fixed such that @xmath118 and @xmath238 with @xmath262 , is asymptotically powerful if @xmath127 , and asymptotically powerless if @xmath128 , where @xmath129 ( resp . , @xmath130 ) is the unique solution to @xmath263 ( resp . , @xmath264 ) .    as in theorem",
    "[ thm : cc - path ] , the result is not as sharp .    qualitatively , we see that the performance of the subcritical @xmath210 scan and loc tests are comparable for both hypercube detection and path detection .      here we consider the choice of a supercritical threshold , where @xmath84 is fixed such that @xmath105 .",
    "we already saw in section  [ sec : cc - cube - sup ] that the largest open cluster is unique and occupies a non - negligible fraction of the entire network .",
    "this is actually true both under the null and under an alternative .",
    "the @xmath210 scan test based solely on the largest open cluster is comparable to the test based on the grand mean after thresholding . in turn",
    ", assuming @xmath84 is fixed , this test is asymptotically powerful when @xmath265 , and asymptotically powerless if @xmath266 and @xmath45 is bounded .",
    "( this is easily seen using chebyshev s inequality . )",
    "this is comparable to the loc test at supercriticality .",
    "in general , the @xmath210 scan statistic includes other ( smaller ) open clusters .",
    "the story of the second - largest cluster of supercritical percolation in a box is not yet complete , and for this reason the behavior of the @xmath210 scan statistic remains incompletely understood .",
    "the difficulty arises from the possibility that the second - largest cluster in @xmath32 might lie at its boundary . whether or not this occurs depends on the outcome of a calculation ( yet to be done ) of energy / entropy type involving so - called `` droplets '' near the boundary of @xmath32 ( see , e.g. , bodineau , ioffe and velenik  @xcite ) . to simplify the discussion , we finesse this problem by working where necessary on @xmath32 with _ toroidal boundary conditions_. that is , whenever we make statements concerning supercritical percolation on the graph @xmath32",
    ", we may add edges connecting sites on its boundary as follows : when @xmath62 , for @xmath267 , an additional edge is placed between site @xmath268 and site @xmath269 , and similarly between @xmath270 and @xmath271 .    in proving exact asymptotics for test statistics under the null , we assume toroidal boundary conditions",
    ". our results on asymptotic power do not require such exact results but require only orders of magnitude , which do not need the toroidal assumption .",
    "we emphasize that similar results are expected to hold with `` free '' ( i.e. , without the extra edges ) rather than toroidal boundary conditions .",
    "once the percolation picture is better understood , such results will follow in the same manner as those presented in this paper .",
    "our results for the torus are also valid if instead we discount open clusters that touch the boundary of @xmath32 . details of this are omitted , and the proofs are essentially the same .",
    "when working on the torus , the second - largest cluster is controlled through the following calculation .",
    "cerf  @xcite proved that the limit @xmath272 exists , with @xmath273 for all fixed @xmath274 .",
    "the dependency on @xmath1 is left implicit .    a result similar to lemma  [ lem : uls - sub ] holds with @xmath275 playing the role of @xmath107 and the exponent of @xmath276 changed in places .",
    "it turns out that we need this result only when @xmath277 . for @xmath278 and a supercritical @xmath84 , let @xmath279 , defined in lemma  [ lem : gamma ] .",
    "[ lem : uls - sup ] assume that @xmath84 is fixed such that @xmath157 and that @xmath238 and @xmath280 for some @xmath281 .",
    "then , under the null , the following holds in probability on the torus @xmath32 :    1 .   if @xmath282 , then @xmath283 .",
    "2 .   if @xmath284 and @xmath285 , then @xmath286^{1/2},\\ ] ] where @xmath287 .",
    "if @xmath288 , then the conclusions of lemma  [ lem : uls - sub ] apply .",
    "( note that @xmath289 . )    based on lemma  [ lem : uls - sup ] , we obtain the following result on the performance of the @xmath210 scan test at supercriticality . as",
    "before , we restrict ourselves to the case where @xmath221 is of order @xmath290 .",
    "we also chose to state a simple result instead of a more precise result with multiple subcases .",
    "this result holds irrespective of the type of boundary condition assumed on @xmath32 .",
    "[ thm : uls - sup ] in hypercube detection , the test based on @xmath221 , with @xmath84 fixed such that @xmath157 and @xmath291 and @xmath292 , is asymptotically powerful ( resp .",
    ", powerless ) if @xmath293 ( \\log m)^{-1/2 } \\to\\infty\\qquad\\mbox{(resp .",
    ", $ \\to0$)}.\\ ] ]    we also mention that the equivalent of theorem  [ thm : uls - path ] holds here as well .    the improvement of the supercritical @xmath210 scan test compared with the supercritical loc test is a weaker requirement on @xmath45 by a logarithmic factor .",
    "thus , this test s performance is still much worse than that of the scan statistic when detecting hypercubes .      if we choose a threshold as described in section  [ sec : cc - cri ] , and if ( [ s - cri ] ) is true , then the power of the @xmath210 scan statistic is greatly improved , as in the case of the loc test .",
    "in fact , it can be proven that theorem  [ thm : cc - cube - cri ] remains valid with @xmath294 replaced with @xmath295 , as long as @xmath296 so that the largest open cluster under the alternative is scanned .",
    "this boils down to showing that under the null , the @xmath210 scan statistic is at most a power of @xmath276 , which we do in lemma  [ lem : uls - orig ] below .",
    "however , the @xmath210 scan test does not seem to offer any substantial gain in power over the loc test , given that @xmath45 is still required to be large enough to change the regime of the percolation process within an alternative @xmath0 from subcritical to supercritical .",
    "that said , actually proving this would require information on the smaller open clusters near criticality , which is scarce and very difficult to obtain ( see borgs _",
    "et al . _",
    "@xcite for some partial results and postulates ) .",
    "finally , we discuss the ( simple ) @xmath210 scan test across all thresholds , as suggested in patil and taillie  @xcite . to take advantage of a phase transition near criticality ,",
    "we assume , as in section  [ sec : cc - cri ] , that there exists @xmath186 such that @xmath187 and that @xmath188 is a continuous function of @xmath84 in a neighborhood of @xmath186 .",
    "we also assume that ( [ s - cri ] ) holds . in proposition",
    "[ prp : uls - bad ] , we showed that scanning small clusters may lead to a decrease in power .",
    "for this reason , and also to facilitate the analysis , we limit ourselves to clusters of size at least @xmath219 ; that is , we consider the test based on @xmath297 where , for definiteness , @xmath298 is calculated on the torus @xmath32 when @xmath299 .",
    "let @xmath300 , where , in congruence with sections  [ sec : uls - sub ] and [ sec : uls - sup ] , @xmath301 with @xmath231 being the function defined in lemma  [ lem : gamma ] .",
    "we first establish the behavior of @xmath302 under the null .",
    "[ lem : uls - orig ] let @xmath303 where @xmath278 , and let @xmath304 be such that @xmath305 . define @xmath306 .",
    "with probability tending to 1 , under @xmath9 , @xmath307 if in addition , either @xmath308 is non - decreasing in @xmath84 or @xmath9 has no atoms on @xmath309 $ ] , then , in probability under @xmath9 , @xmath310    in fact , a result as precise as lemma  [ lem : uls - orig ] is superfluous , given the behavior of the @xmath210 scan statistic under the alternative at supercriticality and near - criticality , which is polynomial in @xmath46 .",
    "the next theorem does not require the use of toroidal boundary conditions .",
    "[ thm : uls - orig ] in hypercube detection and assuming that ( [ s - cri ] ) holds , the test based on @xmath302 , with @xmath311 $ ] for some @xmath312 , is asymptotically powerful if @xmath313 , for some @xmath314 satisfying @xmath315 if @xmath316 .",
    "thus , scanning all thresholds elicits the best performance of the loc tests . nevertheless , the overall test is still suboptimal when detecting hypercubes compared with the scan statistic .",
    "we mention in passing that the same result holds for the simpler test that scans only the largest open cluster at each threshold .",
    "the scan test has been shown to be near - optimal in a wide variety of settings , differing in terms of both network structure and cluster class ( arias - castro , cands and durand  @xcite ; arias - castro , donoho and huo  @xcite ) .",
    "it is computationally demanding , however .",
    "for the simple situation of detecting a hypercube , the scan statistic can be computed in @xmath317 flops , where @xmath318 is the network size if the size of the hypercube is known .",
    "if one scans over all possible hypercubes , then computing the scan statistic requires @xmath319 flops . for nonparametric shapes ,",
    "the computational cost is even higher ; in fact , for the problem of detecting a loopless path , computing the scan statistic corresponds to the reward - budget problem of dasgupta _ et al . _",
    "@xcite , shown there to be np - hard . because the scan statistic is so computationally burdensome , the cluster class is most often taken to be parametric in practice , even though the underlying clusters may take a much wider range of shapes .",
    "for instance , discs are the prevalent shape used in disease outbreak detection ( kulldorff and nagarwalla  @xcite ) , with variants such as ellipses ( hobolth , pedersen and jensen  @xcite ; kulldorff _ et al .",
    "_  @xcite ) . for a wide range of parametric shapes ,",
    "arias - castro , donoho and huo  @xcite recommended a multiscale approximation to the scan statistic .",
    "efforts to move beyond parametric models include tree - based approaches ( kulldorff , fang and walsh  @xcite ) , simulated annealing ( duczmal and assuno  @xcite ) and an exhaustive search among arbitrarily shaped clusters of small size ( tango and takahashi  @xcite ) .",
    "the loc test does not assume any parametric form for the anomalous cluster , and in that sense is nonparametric .",
    "its computational complexity at a given threshold is of order the number of nodes plus the number of edges in the network ( cormen _ et al . _",
    "@xcite ) , and so of order @xmath320 flops for the square lattice .",
    "the @xmath210 scan statistic is nonparametric as well .",
    "computing @xmath321 requires determining @xmath207 , which takes @xmath320 flops , and then scanning over @xmath207 . because the clusters in @xmath207 do not intersect , scanning over them takes order @xmath320 flops .",
    "therefore , computing @xmath322 can be done in @xmath323 flops , where @xmath324 is the number of distinct values at the nodes .",
    "patil and taillie @xcite argued that this can be done faster by using the tree structure of @xmath209 , where the root is the entire network @xmath32 and a cluster @xmath325 is the parent of any cluster @xmath326 such that @xmath327 , where @xmath328 denote the distinct values at the nodes .",
    "we complement our theoretical analysis with some small - scale numerical experiments .",
    "specifically , we explore the power properties of the loc test of section  [ sec : cc ] and the @xmath210 scan test of section [ sec : uls ] in the context of detecting a hypercube in the two - dimensional square lattice .",
    "patil , modarres and patankar  @xcite are developing sophisticated software implementing the @xmath210 scan statistic for use in real - life situations , with more recent variations patil , joshi and koli @xcite . however , this software is not yet available , so we implemented our own ( basic ) routines .",
    "we used the statistical software _",
    "( r core team  @xcite ) with the package ` igraph ` ( csardi  @xcite ) .",
    "our ( basic ) implementation of the @xmath210 scan statistic for a given threshold is much slower than both the scan statistic with a given mask and the loc statistic , especially when there is no constraint on the size of the open clusters to be scanned , that is , when @xmath329 . in all of our experiments , we chose the square lattice in dimension @xmath62 with side length @xmath330 for a total of 250,000 nodes , and we considered three alternatives : squares of side length @xmath331 , corresponding roughly to @xmath332 .",
    "the squares were fixed away from the boundary of the lattice , given that the methods are essentially location - independent .",
    "( this is rigorously true of the scan statistic . )",
    "we assessed the performance of a method in a given situation by estimating its risk , which we define as the sum of the probabilities of type i and type ii errors optimized over all rejection regions .",
    "we first ran some experiments to quickly assess the power of the scan test .",
    "we found that the test agrees very well with the theory ( i.e. , lemma  [ lem : scan - cube ] ) , which we already knew from previous experience .",
    "specifically , we assumed a normal location model and simulated 100 realizations of the null and each of the three alternatives with @xmath333 ( see figure  [ fig : scan ] ) .",
    "-axis is @xmath124 , and the @xmath334-axis is the estimated risk based on 100 replicates . ]",
    "-axis is the percolation probability @xmath335 on the anomalous cluster , and the @xmath334-axis is the estimated risk based on 1000 replicates .",
    "each curve corresponds to a different percolation probability @xmath95 . ]",
    "next , we performed some larger experiments to assess the power of the loc test .",
    "we simply assumed a site percolation model with probability @xmath336 .",
    "note that @xmath100 is not known for site percolation in the square lattice , although @xmath337 from extensive numerical experiments ( feng , deng and blte @xcite ) .",
    "we simulated the null and each of the three alternatives with @xmath338 within the anomalous cluster .",
    "we replicated each situation 1000 times .",
    "the risk curves are shown in figure  [ fig : cc ] .",
    "the test seems to behave similarly above and below criticality . at near - criticality ,",
    "the test is rather erratic . however ,",
    "when the size of the anomalous cluster is large enough , @xmath339 , the risk curve is steepest just under @xmath100 , at @xmath340 in our experiments , with full power against @xmath341 .",
    "figure  [ fig : cc - box ] shows boxplots of the test statistic for the case where @xmath342 and @xmath343 ( subcritical ) , @xmath344 ( near - critical ) , and @xmath345 ( supercritical ) . if we were to use this test in the context of a normal location model , then the correspondence would be @xmath346 ( the threshold ) and @xmath347 , where @xmath348 denotes the normal survival distribution function . figure  [ fig : cc - norm ] plots the risk curves in this context for @xmath349 .",
    "in particular , the test at near - criticality with @xmath350 has full power against the alternative with @xmath342 and @xmath351 .",
    "scale ( @xmath334-axis ) versus the percolation probability @xmath335 , for the alternative @xmath342 and @xmath352 ( from left to right ) .",
    "each boxplot represent 1000 replicates . ]",
    "-axis is @xmath124 , and the @xmath334-axis is the estimated risk based on 1000 replicates .",
    "each curve corresponds to a different threshold  @xmath84 .",
    "the solid (  ) , dashed ( -- ) , dotted ( @xmath353 ) , dot - dashed ( -@xmath354- ) and long - dashed (  ) curves correspond to @xmath355 , respectively . ]",
    "finally , we experimented with the @xmath210 scan test . to limit the size of our simulations , we considered alternatives with @xmath356 with @xmath357 and chose @xmath358 with @xmath359 as thresholds .",
    "we restricted scanning to open clusters of size not smaller than @xmath360 of the size of largest open cluster , essentially falling in the regime of part 2 of lemma  [ lem : uls - sub ] , and also making the computation much faster .",
    "we used 200 replicates .",
    "we again see that the risk curve is sharpest near criticality when the size of the anomalous cluster is sufficiently large , here for @xmath361 .",
    "compared with the loc test , the @xmath210 scan test has more power at large @xmath124 when the cluster is small @xmath362 ( as predicted ) and , more interestingly , slightly more power when the cluster is larger . compared with the scan statistic , which knows the size and shape of the anomalous cluster , the @xmath210 scan test with the best choice of threshold ( corresponding to @xmath344 ) requires approximately threefold greater signal amplitude .",
    "scan test against each of the three alternatives . on the @xmath363-axis",
    "is @xmath124 , and on the @xmath334-axis is the estimated risk based on 200 replicates .",
    "each curve corresponds to a different threshold  @xmath84 .",
    "the solid (  ) , dashed ( -- ) , dotted ( @xmath353 ) , dot - dashed ( -@xmath354- ) and long - dashed (  ) curves correspond to @xmath355 , respectively . ]",
    "the contribution of this paper is a rigorous mathematical analysis of the performance of the loc test independent of , and more extensively than davies , langovoy and wittich  @xcite and langovoy and wittich  @xcite , and of the @xmath210 scan test , both nonparametric and computationally tractable methods .",
    "we made abundant use of percolation theory to establish these results .",
    "we compared the power of these tests with that of the scan statistic , which is known to be near - optimal in a wide array of settings .",
    "although these tests are comparable in power with the scan statistic for the detection of a path , they may be substantially less powerful for the detection of a hypercube .",
    "note , however , that the scan statistic is provided with knowledge about the shape and size of the anomalous cluster . in theory",
    ", we argued that this was the case based on some heuristics and conjectures from percolation theory .",
    "numerically , this appears to be the case when the anomalous cluster is large enough . in our experiments ,",
    "the @xmath210 scan test was slightly more powerful than the loc test , and required a @xmath124 three to four times larger than the scan statistic , which has the advantage of knowing the shape and size of the cluster .",
    "this result is promising , and further numerical experiments are needed to evaluate the power of these tests in truly nonparametric settings , because they do not require previous information about cluster shape , and are computationally more feasible in general .",
    "our theoretical results generalize to other networks that resemble the lattice , with a different critical percolation probability @xmath100 and different functions @xmath107 and @xmath275 .",
    "in particular , we used the self - similarity property of the square lattice and the fact that it has polynomial growth .",
    "our results also generalize to other cluster classes ; in the setting of the square lattice , they extend immediately to any class of clusters that includes a hypercube of comparable size ( e.g. , the class @xmath21 of clusters @xmath0 of size @xmath364^d$ ] ) , such that there is a hypercube @xmath365 with @xmath366 , where @xmath367 more slowly than any negative power of @xmath46 .",
    "in addition , the class might contain clusters of different sizes , although in that case the worst - case risk would be driven by the smallest clusters .",
    "implementation of the scan statistic may be much more demanding in this case .",
    "the main results of section  [ sec : cc ] require only that @xmath368 be twice differentiable in @xmath369 , with @xmath370 for all @xmath369 , which is the case , for example , for location models and scale models if @xmath9 is twice differentiable with a strictly positive first derivate . with some additional work ,",
    "we also can obtain results for classes of `` thin '' clusters as defined in arias - castro , cands and durand @xcite .",
    "the key is to understand the percolation behavior within and near such clusters .",
    "some results are available for slabs ( grimmett  @xcite , theorem 7.2 ) and more general subgraphs of lattices including `` wedges , '' and these appear to be transferable to other `` curved '' slabs .",
    "we write @xmath371 as @xmath372 if @xmath373 .",
    "similarly , we use @xmath374 and @xmath375 and write @xmath376 as @xmath372 if @xmath377 and vice versa . we also use their random counterparts , @xmath378 , @xmath379 , @xmath380 , and @xmath381 .",
    "for example , @xmath382 means that @xmath383 in probability , and @xmath384 means that @xmath385 is bounded in probability , which is to say that @xmath386 as @xmath3 for any @xmath387 satisfying @xmath388 .",
    "we use @xmath389 to denote the indicator function of the set @xmath390 .",
    "the maximum of @xmath58 and @xmath391 is denoted by @xmath392 .      here",
    "we state and prove some results on the sizes of percolation clusters in @xmath101 .",
    "we start by proving some properties of @xmath107 .",
    "recall that @xmath103 denotes the size of the open cluster at the origin . besides the limit in ( [ zeta ] ) , the following bound holds for @xmath393 and all @xmath394 : @xmath395 by grimmett  @xcite , equation ( 6.80 ) , adapted to site percolation .",
    "[ lem : zeta ] the function @xmath107 defined in ( [ zeta ] ) is continuous and strictly decreasing over @xmath396 $ ] , and satisfies @xmath397 and @xmath398 .",
    "let @xmath399 . by coupling @xmath400 and @xmath401 in the usual way , @xmath402 so that @xmath403",
    ". applying grimmett  @xcite , theorem 2.38 , to the event @xmath404 , we find that , as in the proof of grimmett  @xcite , equation ( 6.16 ) , @xmath405 . in summary ,",
    "@xmath406 therefore , @xmath107 is continuous and strictly decreasing on @xmath407 .",
    "moreover , by fixing @xmath408 and letting @xmath409 , we have @xmath410    finally , by grimmett  @xcite , equations ( 6.83 ) , ( 6.56 ) , @xmath411 as @xmath412 .    next ,",
    "we prove ( [ s - conv ] ) .",
    "we do this by standard means , and the claim may be strengthened ( see also grimmett  @xcite ; hofstad and redig  @xcite ) .",
    "[ lem : s - conv ] consider site percolation on @xmath101 with parameter @xmath116 , and let @xmath96 denote the size of the largest open cluster within @xmath32",
    ". then ( [ s - conv ] ) holds , namely @xmath413    fix @xmath414 .",
    "let @xmath415 be the size of the open cluster at a node @xmath416 , which has the same distribution as @xmath103 .",
    "we start with the upper bound . by the union bound ,",
    "@xmath417 thus , using ( [ zeta ] ) , for @xmath418 and @xmath46 large enough , @xmath419 and the term on the right - hand side converges to @xmath420 .    for the lower bound , consider @xmath421 nodes @xmath422 separated from each other and the boundary of @xmath32 by at least @xmath423 .",
    "let @xmath424 . for sufficiently large @xmath46 ,",
    "the events @xmath425 are independent .",
    "therefore , using ( [ zeta ] ) , for large @xmath46 , @xmath426 and the last term on the right - hand side tends to 0 as @xmath3 .",
    "the following result describes the behavior of size of the open cluster at the origin when @xmath95 is small .",
    "it may be made more precise , but we do not pursue this here .    [",
    "lem : p - small ] there exists @xmath427 depending only on @xmath1 such that , for @xmath428 , @xmath429    an _ animal _ is a connected subgraph of @xmath101 containing the origin . the lower bound comes from considering the probability that any given animal of size @xmath58 is open . for the upper bound , by the union bound",
    ", we have latexmath:[${\\mathbb{p}}_p(s= k ) \\le    of animals with @xmath58 vertices .",
    "there is a constant @xmath427 such that @xmath431 , so that @xmath432 when @xmath433 .    we next present a result on the number of open clusters of a given size that is valid for all @xmath102 .    [ lem : nk ] consider site percolation on @xmath101 with parameter @xmath95 , and let @xmath434 denote the number of open clusters of size @xmath58 within @xmath32 .",
    "then , for @xmath435 , @xmath436 in addition , for @xmath437 , @xmath438 thus , for @xmath435 , @xmath439    let @xmath440 be the size of the open cluster at @xmath441 within the box @xmath32",
    ". then @xmath442 where @xmath443 .",
    "we immediately have @xmath444 for the lower bound , we count only nodes away from the boundary , obtaining @xmath445 where @xmath446 .",
    "we turn now to the covariances . by ( [ g3 ] ) , @xmath447 because @xmath448 and @xmath449 are independent if @xmath450 , where @xmath451 denotes @xmath452-norm .",
    "now , @xmath453 so that @xmath454 and the second claim of the lemma follows .",
    "we now describe some properties of the open clusters within @xmath32 in the supercritical regime . in this regime",
    ", it is known that , with probability 1 , there is a unique infinite open cluster in @xmath101 , denoted by @xmath455 ( see , e.g. , grimmett  @xcite , section 8.2 ) . with high probability , the largest open cluster within @xmath32 is a subgraph of this infinite open cluster .",
    "next , we present some additional information on its size , @xmath96 .",
    "[ lem : large - sup ] suppose that @xmath456 .",
    "there is a constant @xmath457 such that , with probability at least @xmath458 , there is a unique largest open cluster within @xmath32 , and it is a subgraph of @xmath455 .",
    "moreover , as @xmath3 , its size @xmath96 satisfies @xmath459 with @xmath460 and @xmath461 .    for the first part and the limiting behavior of @xmath462 as @xmath463 , see the discussion of penrose and pisztora  @xcite , theorems 4 and 6 , and the beginning of this appendix . for the weak limit and the limit size of the variance of @xmath96 , see , for example , penrose  @xcite , theorem 3.2 .",
    "we next describe some properties of the smaller open clusters .",
    "let @xmath464 be the size of the largest open cluster of @xmath101 that is contained entirely within @xmath32 .",
    "[ lem : small - sup ] suppose that @xmath456 .",
    "there exists a positive constant @xmath275 such that @xmath465 for any @xmath466 , there exists @xmath467 such that the following holds : with probability tending to 1 , there exist at least @xmath468 $ ] open clusters of size @xmath469 $ ] of @xmath101 lying within @xmath32 .",
    "our results on exact asymptotics in the supercritical phase concern @xmath32 with toroidal boundary conditions . one effect of removing the boundary from @xmath32 is that the asymptotics of the largest cluster coincide with those of @xmath96 , as well as for the second - largest cluster @xmath470 . in the proof of theorem  [ thm : uls - sup ] , we need an upper bound on the size of the second - largest cluster inside a box with `` free '' boundary conditions .",
    "we do not explore this in detail here , because it relies on extensions of arguments of kesten and zhang @xcite ( see also grimmett  @xcite , proof of theorem 8.65 ) , which have not yet been not fully explored in the literature .",
    "instead , we note that the the second - largest open cluster in a supercritical percolation model on @xmath32 with free boundary conditions has size of order @xmath471",
    ".    proof of lemma  [ lem : small - sup ] it was proven by cerf  @xcite that the limit @xmath472 exists and is strictly positive and finite when @xmath473 .",
    "it is elementary that @xmath275 thus defined is equal to that of ( [ delta ] ) ( see also grimmett  @xcite , section 8.6 ) .",
    "the first part of the lemma follows by the same proof as used in lemma [ lem : s - conv ] .    as in the proof of lemma  [ lem : nk ] ,",
    "the mean number @xmath474 of clusters of size @xmath475 $ ] satisfies @xmath476 } \\exp\\bigl(-\\delta^2(c\\log m)^{(d-1)/d } \\bigr)\\ ] ] for positive constants @xmath477 .",
    "the number of such clusters has variance no larger than @xmath478 for some @xmath479 .",
    "the claim follows by chebyshev s inequality .      here",
    "we present some results for @xmath138 and exponential families of distributions .",
    "our first result is on the size of the maximum of an i.i.d .",
    "sample from an @xmath138 distribution .",
    "[ lem : aep - max ] let @xmath480 for some @xmath481 and @xmath229 .",
    "then , for @xmath482 , @xmath483    fix @xmath484 and define @xmath485 . for @xmath486 large enough , we have , by independence , @xmath487 now redefine @xmath488 .",
    "for @xmath486 large enough , we have , by the union bound ,",
    "@xmath489    we next describe the behavior at infinity of the logarithmic moment - generating function and rate function of an @xmath138 distribution .",
    "[ lem : aep - rate ] let @xmath480 for some @xmath490 and @xmath229 , with logarithmic moment - generating function @xmath491 and rate function @xmath80 . then",
    ", as @xmath492 , @xmath493 and , as @xmath494 , @xmath495    let @xmath496 be the moment - generating function of @xmath497 .",
    "we focus on the upper bound in ( [ lda ] )  obtaining the bound in ( [ lda1 ] ) is analogous  and deduce the lower bound in ( [ lda - star ] ) .",
    "let @xmath498 , @xmath499 , and let @xmath500 be such that @xmath501 for all @xmath502 .",
    "we start from the following bound : @xmath503 we again divide the integral into @xmath504 and @xmath505 , where @xmath506 . for @xmath504",
    ", we bound @xmath507 by its maximum over @xmath508 . for @xmath505 , @xmath509 .",
    "letting @xmath510 , and assuming that @xmath124 is large enough such that @xmath511 , we get @xmath512 thus , when @xmath492 , @xmath513 taking logs and letting @xmath492 , we get @xmath514 then letting @xmath390 tend to @xmath50 , we obtain the upper bound in ( [ lda ] ) .",
    "now , for @xmath363 exceeding the mean of @xmath497 , @xmath515 , and starting from ( [ mgf - ub ] ) , we obtain @xmath516 therefore , @xmath517 then , letting @xmath390 tend to @xmath50 , we obtain the lower bound in ( [ lda - star ] ) .",
    "we now define @xmath231 , first appearing in section  [ sec : uls - sub ] .",
    "our function @xmath231 depends on certain quantities listed in the following lemma .",
    "it also depends on the quantity @xmath518 , which we take as that defined in ( [ zeta ] ) .",
    "it is only through its dependence on @xmath518 that @xmath231 is affected by the geometry of @xmath32 .",
    "[ lem : gamma ] consider a distribution @xmath497 on the real line , possibly discrete but not a point mass , with finite mean @xmath519 and finite moment - generating function at some positive @xmath520 , and let @xmath80 denote its rate function .",
    "let @xmath521 , and fix @xmath522 .    1 .",
    "assume that @xmath523 .",
    "if @xmath524 , or @xmath525 and @xmath480 for some @xmath228 and @xmath148 , then there is a unique solution @xmath526 to the following equation @xmath527 = 1.\\ ] ] 2 .",
    "assume that @xmath528 .",
    "the foregoing holds as long as @xmath529 ( and with @xmath530 interpreted as @xmath110 ) .",
    "let @xmath531 . because @xmath497 is not a point mass , @xmath532 .",
    "define @xmath533 note that @xmath534 is finite ( resp .",
    ", infinite ) if @xmath535 ( resp . , @xmath536 ) .",
    "in addition , @xmath534 , and its derivatives are continuous wherever @xmath537 is finite , and thus are uniformly continuous on any compact subset of @xmath538 on which @xmath537 is finite .",
    "furthermore , @xmath534 is strictly increasing in @xmath231 on the interval @xmath539 .",
    "let @xmath540    thus @xmath541 is finite if @xmath542 , and infinite when @xmath543 is replaced by @xmath544 .",
    "furthermore , for @xmath545 , the infimum is achieved at some value @xmath546 of @xmath547 in a neighborhood where @xmath548 .",
    "assume first that @xmath278 .",
    "it may be seen that @xmath541 is continuous and strictly increasing in @xmath231 on the interval @xmath549 .",
    "let @xmath550 .",
    "then @xmath551 and continuity follows from the properties of @xmath537 noted earlier .",
    "similarly , @xmath552 and strict monotonicity follows similarly .",
    "it suffices to prove that @xmath541 takes values @xmath5431 and _ finite _ values @xmath5441 .",
    "the first claim follows from the fact that , with @xmath553 , @xmath554    we now turn to the second claim , and make use of two general properties of rate functions that follow from dembo and zeitouni  @xcite , equation ( 2.2.10 ) , lemma 2.2.20 .",
    "it is standard that @xmath555 as @xmath556 , where @xmath557 is the variance of @xmath497 .",
    "therefore , @xmath558 with @xmath33 thus chosen , by convexity , @xmath559    assume first that @xmath560 and @xmath561 . by ( [ v2 ] ) , for sufficiently large @xmath231 , @xmath562",
    "\\ge a\\bigl(\\beta(\\nu-\\mu ) + \\sqrt { \\gamma\\beta}\\bigr ) > 1.\\ ] ]    suppose next that @xmath560 and @xmath563 .",
    "let @xmath564 . because @xmath565 if @xmath566 , @xmath567 \\\\[-8pt ] & = & \\beta_0 \\lambda^*\\bigl(\\nu+ \\sqrt{\\gamma\\zeta}\\bigr ) + \\beta_0\\zeta.\\nonumber\\end{aligned}\\ ] ] the limit of this , as @xmath568 , is strictly greater than @xmath569 .",
    "now let @xmath528 and @xmath529 , and note that @xmath570 for all @xmath571 .",
    "suppose that @xmath572 and @xmath573 . by dividing the infimum in ( [ v4 ] ) according to whether or not @xmath574 , we find that @xmath575 by ( [ v3])([v2 ] ) .",
    "this diverges as @xmath576 .    when @xmath226 , some of the arguments fail , because @xmath577 might not be continuous at @xmath578 .",
    "assume that @xmath579 for some @xmath228 and @xmath229 .",
    "note that @xmath580 by lemma [ lem : aep - rate ] . if @xmath581 , @xmath582 when @xmath583 is fixed and @xmath584 , by lemma  [ lem : aep - rate ] , and taking this limit as an extension at @xmath585 , the same arguments used in the case @xmath278 apply .",
    "if @xmath586 , we need slightly different arguments . as",
    "before , let @xmath546 be a minimizer of @xmath534 .",
    "we have that @xmath546 is well defined for all @xmath231 and strictly positive , because @xmath537 is uniformly continuous on any compact of @xmath587 \\times[0 , \\infty)$ ] and @xmath588 when @xmath584 .",
    "thus we may proceed as before in ( [ l - ub])([l - lb ] ) , obtaining that @xmath589 is strictly increasing and continuous . as before , we turn to proving that @xmath590 takes values @xmath5431 and finite values @xmath5441 . first , with @xmath591 and @xmath592 , @xmath593 next , showing that @xmath590 takes finite values above 1 is done exactly as before , except that ( [ v3 ] ) is replaced by @xmath594 by lemma  [ lem : aep - rate ] .",
    "the following result describes the variations of @xmath231 ( defined in lemma  [ lem : gamma ] ) with the parameter of an exponential family .",
    "[ lem : gamma - prop ] consider a natural exponential family of distributions @xmath595 and let @xmath596 and @xmath597 denote the mean and the rate function of @xmath13 , respectively .",
    "let @xmath598 be a continuous and decreasing function of @xmath124 .",
    "then , for any fixed @xmath599 , @xmath600 is continuous and strictly increasing in @xmath124 . moreover , if @xmath601 when @xmath602 , then @xmath603 when @xmath602 .",
    "first , note that @xmath604 ( brown  @xcite , cor .",
    "2.22 ) so that @xmath605 is well - defined .",
    "that @xmath605 is strictly increasing comes from the fact that both @xmath606 and @xmath607 ( @xmath608 fixed ) are decreasing .",
    "the latter can be seen from @xmath609 where @xmath610 is the average of the sample of size @xmath58 from @xmath13 brown  @xcite , cor . 2.22 , and the fact that the distribution of @xmath610 as @xmath124 varies forms a natural exponential family with parameter @xmath611 .",
    "that @xmath605 is continuous comes from the continuity of @xmath606 and @xmath607 ( in @xmath612 ) .    for the behavior near @xmath613 , note that @xmath614 for @xmath615 , so that @xmath616 for any @xmath617 .",
    "combine this with the fact that @xmath596 is strictly increasing in @xmath124 to see that @xmath618 is of order at least @xmath619 .",
    "in fact , it is easy to see that @xmath620 when @xmath621 .      [",
    "sec : proofs ]      by monotonicity , it is sufficient to assume that @xmath622 for all @xmath46 . fix @xmath84 and , for short , let @xmath117 and @xmath623 .",
    "first , assume that @xmath624 , so that @xmath625 .",
    "fix @xmath626 such that @xmath627 and consider the test with rejection region @xmath628 . under @xmath28",
    ", we have @xmath629 by ( [ s - conv ] ) , so that @xmath630 . under @xmath90 , @xmath631 , so that @xmath632 .",
    "thus this test is asymptotically powerful .",
    "now assume that @xmath633 , so that @xmath634 and there is @xmath626 such that @xmath635 .",
    "let @xmath636 .",
    "it is sufficient to show that under both @xmath28 and @xmath90 , @xmath637 with probability tending to 1 , so that the values at the nodes in @xmath0 have no influence on @xmath87 .",
    "indeed , let @xmath638 be a hypercube within @xmath32 of sidelength @xmath639 $ ] which does not intersect @xmath0 .",
    "then @xmath640 , and the distribution of @xmath641 is the same under both @xmath28 and @xmath90 .",
    "in addition , @xmath642 by ( [ s - conv ] ) . now , let @xmath643 be the set of nodes within ( supnorm ) distance @xmath644 from @xmath0 , so that @xmath643 is a hypercube of side length @xmath55 + [ 2(\\log m)^2]$ ] containing @xmath0 in its interior . in the event that @xmath645 , @xmath646 only when @xmath647 .",
    "the distribution of @xmath648 under the null is stochastically bounded by its distribution under @xmath90 , which is itself bounded by its distribution under @xmath649 . even under the latter , @xmath650 by ( [ s - conv ] ) .",
    "we then conclude the proof using the fact that @xmath651 , again by ( [ s - conv ] ) .",
    "here we use the notation and follow the arguments of section [ sec : proof - cc - cube ] .",
    "in addition , let @xmath652 , that is , the function @xmath518 in dimension one . when @xmath653 , we consider @xmath654 . under @xmath28 , we still have @xmath655 . under @xmath90 , @xmath656 , because @xmath0 is isomorphic to a subinterval of the one - dimensional lattice .",
    "we conclude as before that the test with rejection region @xmath628 is asymptotically powerful .    when @xmath657 , we consider @xmath658 . as",
    "before , let @xmath643 be the set of nodes within ( supnorm ) distance @xmath644 from @xmath0 , so that @xmath643 is now a band . as before , it suffices to prove that @xmath650 under @xmath649 .",
    "although ( [ s - conv ] ) can not be applied , because @xmath643 is not isomorphic to a square lattice , its proof via the union bound and ( [ zeta ] ) applies . indeed , fix @xmath659 small enough that @xmath660 . then , for @xmath46 large enough , we have @xmath661      let @xmath662 with @xmath663 fixed .",
    "we first show that @xmath664 with probability tending to 1 under @xmath28 .",
    "we use the notation and arguments provided in the proof of lemma  [ lem : s - conv ] . as in ( [ sm - lb ] ) , @xmath665 & \\leq&\\bigl(1 -p_0(t_m)^{k_m({\\varepsilon } ) } \\bigr)^n \\\\[-2pt ] & \\leq&\\exp\\bigl(- m^{{\\varepsilon}d}/(\\log m)^{2d } \\bigr ) \\to0,\\end{aligned}\\ ] ] where the second inequality holds for @xmath46 large enough by lemma [ lem : p - small ] .",
    "assume that @xmath666 for all @xmath46 .",
    "proceeding as in section  [ sec : proof - cc - cube ] and using the slightly larger region @xmath643 , it is sufficient to show that for @xmath667 small enough , @xmath668 when @xmath669 for all @xmath670 . using the union bound and the fact that @xmath671 , we have=-1 @xmath672 where the last inequality is due to lemma  [ lem : p - small ] ( and @xmath673 is the constant that appears there ) . through integration by parts , for @xmath520 and @xmath484 fixed , we have @xmath674 for sufficiently large @xmath84 . indeed , for @xmath84 large enough , @xmath675 & \\leq&\\exp\\bigl(\\theta t -\\lambda(\\theta ) -c ( 1-{\\varepsilon}/3)^b t^b\\bigr ) + \\int _",
    "t^\\infty\\theta\\exp\\bigl(\\theta x -\\lambda(\\theta ) -c ( 1-{\\varepsilon}/3)^b x^b\\bigr ) \\,\\mathrm{d}x \\\\[-2pt ] & \\leq&\\exp\\bigl(-c ( 1-{\\varepsilon}/2)^b t^b\\bigr ) \\\\[-2pt ] & \\leq & p_0\\bigl((1-{\\varepsilon } ) t\\bigr),\\end{aligned}\\ ] ] where we used the fact that @xmath147 in line 3 and the fact that @xmath676 as @xmath677 ( because @xmath678 ) in lines 2 and 4 .",
    "the last property also implies that @xmath679 for large @xmath84 .",
    "thus , for @xmath46 large enough , @xmath680 , so that taking logs in ( [ sl - ub ] ) , we get @xmath681 when @xmath682 .",
    "( remember that @xmath163 and that @xmath135 , so the middle term is small . )",
    "let @xmath683 denote the expectation of @xmath5 under @xmath13 .",
    "by lemma  [ lem : large - sup ] , under the null , @xmath684 with @xmath685 of order @xmath686 .",
    "write @xmath687 and @xmath688 .",
    "we consider the alternative with anomalous cluster @xmath0 as a two - stage percolation process , where the first stage is percolation on @xmath32 with probability @xmath95 , as under the null , and the second stage is percolation on the closed nodes within @xmath0 , that is , @xmath689 , with ( conditional ) probability @xmath690 . an open cluster at the first stage is called _ small _ if it is not a largest open cluster .    we may assume , except where noted below , that @xmath260 . because @xmath691 which is positive at @xmath277 by choice of @xmath84 , there exists @xmath692 such that @xmath693 let @xmath694 be the difference between the sizes of the largest clusters under the null and the alternative . for @xmath695 , let @xmath696 be the sum of the sizes of all small clusters of the entire lattice that contain some neighbor of @xmath363 .",
    "note that @xmath697 , where @xmath698 is the set of @xmath699 that are closed at the first stage and open at the second stage .",
    "therefore , @xmath700 has expectation bounded above by @xmath701 where @xmath702 is the mean size of a finite open cluster in the infinite lattice .    by ( [ theta2 ] ) and the foregoing , @xmath703 for some @xmath704 . by markov",
    "s inequality , @xmath705 .",
    "thus , if @xmath706 , then @xmath707 , implying that the same central limit law as ( [ clt ] ) holds under the alternative , so that the test based on the largest open cluster is asymptotically powerless .",
    "we also must consider the case where @xmath708 , for which a similar argument is valid",
    ".    now assume that @xmath161 and @xmath709 . by grimmett",
    "@xcite , theorem 8.99 , and standard properties of the largest cluster in a box ( to be found in , e.g. , falconer and grimmett  @xcite ) , with probability tending to 1 , the largest open cluster increases in size by at least @xmath710 for some @xmath711 . by ( [ theta2 ] ) ,",
    "this has order @xmath712 . because @xmath713 for some @xmath714 , the test based on the largest open cluster is asymptotically powerful .",
    "we may assume without loss of generality that @xmath260 as @xmath715 . by ( [ s - cri ] ) and the assumption on @xmath716 , we have that @xmath717 under the null .",
    "now @xmath125 is infinitely differentiable in @xmath124 , with each derivative continuous in @xmath84 and with @xmath718 \\geq\\frac { p_c}{2 } [ { \\mathbb{e}}_0(x_v|x_v > t_c ) -{\\mathbb{e}}_0(x_v ) ] > 0,\\ ] ] uniformly for @xmath84 in a neighborhood of @xmath186 .",
    "therefore , there exists @xmath457 such that @xmath719 for @xmath720 in some neighborhood of @xmath721 .",
    "thus , @xmath722 on such a neighborhood .",
    "let @xmath390 and @xmath626 be such that @xmath723 and @xmath724 , and assume that @xmath725 , based on the statement of the theorem . because @xmath260 and @xmath726 , @xmath727 \\geq \\biggl[\\frac{b}{2c } -a \\biggr ] m^{\\alpha(1/\\nu '' -1/\\nu ' ) } \\to\\infty\\ ] ] for @xmath728 and sufficiently large @xmath46 . by ( [ s - cri ] )",
    "applied to @xmath24 , it follows that @xmath729 under the alternative .",
    "consequently , the test with rejection region @xmath730 is asymptotically powerful .",
    "_ part _ 1 .",
    "this follows immediately from lemma  [ lem : s - conv ] .",
    "therefore , we focus on the remaining two parts .",
    "we use the abbreviated notation @xmath731 , @xmath732 , @xmath733 , @xmath734 , @xmath735 , @xmath736 , and write @xmath737 .",
    "let @xmath738 .",
    "as in lemma  [ lem : nk ] , let @xmath434 denote the number of open cluster of size @xmath58 within @xmath32 , and define @xmath739 where @xmath740 and @xmath610 is the average of an i.i.d .",
    "sample of size @xmath58 from @xmath497 . by the independence of @xmath741 and @xmath742 for @xmath743",
    "distinct , we have @xmath744),\\ ] ] where @xmath745 thus , we turn to bounding @xmath746 .    _",
    "define @xmath747 and fix @xmath663 . for",
    "the lower bound , let @xmath748 be the closest integer to @xmath749 between @xmath219 and @xmath750 , where @xmath751.\\ ] ] we have @xmath752 and we show that for @xmath667 fixed , @xmath753 in probability .",
    "fix @xmath659 .",
    "on the one hand , we use lemma  [ lem : nk ] and ( [ zeta ] ) , to get @xmath754 for @xmath46 large enough .",
    "on the other hand , we use cramr s theorem ( dembo and zeitouni  @xcite , theorem 2.2.3 ) to get @xmath755\\bigr ) \\end{aligned}\\ ] ] for @xmath46 large enough . by the definition of @xmath231 , @xmath756 + a \\zeta= 1 $ ] , and thus for @xmath667 small enough , @xmath757 < 1,\\ ] ] by strict monotonicity , as in the proof of lemma  [ lem : gamma ] .",
    "thus , for @xmath758 small enough , @xmath759 \\leq(1-\\eta ) d \\log m.\\ ] ] it follows that @xmath760 to bound the corresponding variance , we use lemma  [ lem : nk ] to obtain @xmath761 and it follows by chebyshev s inequality that indeed @xmath753 in probability .    because @xmath762 , @xmath763 in @xmath764 , and thus @xmath765    we next show that @xmath766 , which will imply the claim of part 2 .",
    "fix @xmath659 .",
    "we have that @xmath767 where @xmath768 and @xmath769 is the number of clusters of size exceeding @xmath770 $ ] .",
    "we first note that , as in the proof of lemma  [ lem : nk ] , for large @xmath46 , @xmath771    we next turn to @xmath772 , and show that for @xmath667 fixed and @xmath758 small enough , @xmath773 . on the one hand , we use lemma  [ lem : nk ] and ( [ zeta ] ) to get @xmath774 for @xmath46 large enough . on the other hand , by chernoff s bound , @xmath775\\bigr ) .\\ ] ] taken together , we obtain @xmath776 \\bigr ) \\\\ &",
    "\\leq&{\\mathrm{o}}(\\log m ) \\exp\\bigl(d \\log m -(1-\\eta)\\min_{k_m \\leq k \\leq k_m^{(\\eta ) } } \\bigl[k \\zeta+ k \\lambda^ * \\bigl(\\nu+(1+{\\varepsilon } ) x_m/\\sqrt { k } \\bigr ) \\bigr ] \\bigr ) \\\\ & \\leq&{\\mathrm{o}}(\\log m ) \\exp\\bigl ( \\bigl(1 - ( 1-\\eta ) a\\bigr ) d \\log",
    "m\\bigr ) , \\ ] ] where @xmath777.\\ ] ] as in the proof of lemma  [ lem : gamma ] , @xmath778 is continuous in @xmath779 and strictly increasing in @xmath667 .",
    "because @xmath780 by definition of @xmath231 , for @xmath667 fixed , @xmath781 for @xmath758 small enough , in which case @xmath782 as @xmath46 increases .    by ( [ oh1])([oh2 ] ) , we have that @xmath783 . by jensen s inequality , @xmath784 and",
    "the proof of this part is complete . _",
    "we build on the arguments provided so far , which apply essentially unchanged , except in two places . in the lower bound , instead of cramr s theorem",
    ", we use @xmath785 combined with the asymptotic behavior for @xmath786 . in the upper bound , @xmath390 defined in ( [ a ] ) is evaluated differently when @xmath244 .    _ part _",
    "when @xmath586 , we have @xmath787 in ( [ a ] ) ( with @xmath226 ) , because @xmath788 for @xmath231 fixed and @xmath584 , by lemma  [ lem : aep - rate ] . when @xmath581 , we take @xmath200 small enough if the minimum is at @xmath789 . then the other arguments in part 2",
    "apply unchanged .",
    "3(b ) . by the same calculations , @xmath789 in ( [ a ] ) , because @xmath790 for all @xmath791 , and @xmath792 when @xmath584 , because @xmath244 .",
    "this would make @xmath793 in ( [ a ] ) for any @xmath663 , making the arguments for the upper bound collapse . instead , redefine @xmath794 . because @xmath795 uniformly over @xmath796 , for @xmath659 fixed , we have @xmath797 for @xmath46 large enough , by lemma  [ lem : aep - rate ]",
    ". then the term on the right - hand side takes its minimum over @xmath798 at @xmath799 , and from here , the remaining arguments apply .",
    "assume , for simplicity , that @xmath800 for all @xmath46 .",
    "the key point is that @xmath801 .",
    "indeed , we have @xmath802 , where the denominator is constant in @xmath363 and , integrating by parts , @xmath803 from here , we reason as in the proof of proposition  [ prp : t - large ] , using the fact that @xmath804 when @xmath805 , with @xmath147 .",
    "thus @xmath222 and @xmath806 have same ( first - order ) asymptotics , and so nothing distinguishes the asymptotic behavior of @xmath807 under the null and under an alternative . in detail , we proceed as in section  [ sec : proof - cc - cube ] , with the enlarged hypercube @xmath643 , and show that in probability under @xmath649 , @xmath808 where @xmath809 is the @xmath210 scan statistic restricted to open clusters within @xmath643 . because @xmath643 is a scaled version of @xmath32 , @xmath810 and @xmath811 , lemma  [ lem : uls - sub ] applies to yield @xmath812 we then conclude with the fact that @xmath163 .",
    "the proof of theorem  [ thm : uls - cube ] is parallel to that of theorem [ thm : cc - cube ] in section  [ sec : proof - cc - cube ] , but using lemma  [ lem : uls - sub ] in place of lemma  [ lem : s - conv ] .",
    "note that we use the fact that for @xmath84 and @xmath278 fixed , @xmath813 is continuous and strictly increasing in @xmath124 .",
    "this comes from lemma  [ lem : gamma - prop ] and the fact that when @xmath84 is fixed , @xmath222 is also a natural exponential family with parameter  @xmath124 .",
    "similarly , the proof of theorem  [ thm : uls - path ] is parallel to that of theorem  [ thm : cc - path ] in section  [ sec : proof - cc - path ] .",
    "further details are omitted .",
    "the proof is parallel to that of lemma  [ lem : uls - sub ] . in particular",
    ", we use the notation introduced there and only note where the arguments differ ( although never substantially ) .    _ part _ 1 . in this case , by lemma  [ lem : large - sup ] and lemma [ lem : small - sup ] , there is only one open cluster with size @xmath219 or larger , and the result follows from , for example , chebyshev s inequality .    _ part _ 2 .",
    "define @xmath814 and fix @xmath663 . for the lower bound",
    ", we have @xmath815 fix @xmath659 . by lemma  [ lem : nk ] (",
    "still valid ) and ( [ delta ] ) , @xmath816 for @xmath46 large enough . by cramr",
    "s theorem and the fact that @xmath817 when @xmath363 is small , @xmath818\\bigr ) \\\\ & \\geq&\\exp\\bigl(-(1+\\eta ) ( 1-{\\varepsilon}/2 ) x_m^2/(2 \\sigma^2 ) \\bigr)\\end{aligned}\\ ] ] for @xmath46 large enough .",
    "thus , @xmath819 for @xmath46 large enough and @xmath758 small enough . for the variance",
    ", we use lemma  [ lem : nk ] to get @xmath820 we then conclude by chebyshev s inequality .",
    "we now show that @xmath821 in probability .",
    "equation ( [ oh1 ] ) holds with @xmath822^{d/(d-1)}$ ] . as before , @xmath823 by lemma  [ lem : nk ] and ( [ delta ] ) , @xmath824 for @xmath46 large enough .",
    "the absence of a boundary to @xmath32 is being used here .",
    "the tail behavior of percolation clusters near the boundary of a box is not yet fully understood ( see the remark in section [ sec : uls - sup ] ) . by chernoff s bound and the behavior of @xmath80 near the origin , @xmath825 for any @xmath826 .",
    "thus , @xmath827 for @xmath46 large enough and @xmath758 small enough .    _",
    "this part is even more similar to what we did in the proof of lemma  [ lem : uls - sub ] .",
    "the behavior of @xmath807 is driven by the open clusters of size of order @xmath276 , with the only difference being that the term in @xmath828 from the bounds on @xmath434 is negligible .",
    "details are omitted .      without loss of generality ,",
    "we assume that @xmath45 is bounded . by lemma  [ lem : uls - sup ] and our assumptions on @xmath219 , under the null , @xmath829 for a finite constant @xmath830 .",
    "we now consider the alternative , where the anomalous cluster is @xmath0 .",
    "the contribution of the largest open cluster , @xmath831 , is @xmath832 on the right - hand side , the first term is of order @xmath833 , and the second term is of order @xmath834 , by chebyshev s inequality and the fact that , with probability tending to 1 , @xmath835 and @xmath836 , by lemma  [ lem : large - sup ] .",
    "the last term is of ( exact ) order @xmath837 , by the fact that @xmath223 is differentiable at @xmath277 with derivative equal to @xmath838 .",
    "therefore , the @xmath210 scan test is asymptotically powerful when @xmath839 is large enough .",
    "( note that this requires @xmath316 . )",
    "if instead , we have @xmath840 , then the scan over @xmath831 may be ignored , and we need to consider smaller clusters .    by lemma  [ lem : small - sup ] and the upper bound on @xmath219 , the second - largest cluster entirely within @xmath0",
    "is scanned and its contribution is of order @xmath841 , by the same arguments that established the contribution of the largest open cluster .",
    "thus , the @xmath210 scan test is asymptotically powerful when @xmath842 is large enough .",
    "if instead , @xmath843 , the test is asymptotically powerless . indeed , let @xmath643 be the set of nodes within distance @xmath844 from @xmath0 , and let @xmath809 be the result of scanning the open clusters of size at least @xmath219 and entirely within @xmath643 .",
    "as argued in the proof of proposition  [ prp : uls - bad ] , this time using lemma  [ lem : small - sup ] , it is sufficient to show that @xmath845 with probability tending to 1 under @xmath846 . for any open cluster @xmath847 entirely within @xmath643 , @xmath848 so that @xmath849 where the maximum is over open clusters of size at least @xmath219 and entirely within @xmath643 , and the second term is @xmath850 by lemma  [ lem : small - sup ] and the size of @xmath45 .",
    "although @xmath260 varies , this maximum may be handled exactly as in lemma  [ lem : uls - sup ] , so that it is @xmath851 , and we conclude .",
    "we prove only the more refined part .",
    "we use abbreviated notation as before , in particular , we omit the subscript 0 , using @xmath852 , @xmath853 , and so on . the lower bound is obtained via @xmath854 , where @xmath855 defines @xmath856 , and applying lemmas  [ lem : uls - sub ] or  [ lem : uls - sup ] to @xmath857 depending on whether @xmath858 or @xmath859 . for simplicity , we assume that @xmath860 .",
    "if @xmath861 , then we consider a nearby threshold and argue by continuity . for the upper bound , we prove that @xmath862 , where @xmath863 and @xmath864 .    as @xmath84 increases ,",
    "clusters are created and then destroyed in the coupled percolation processes .",
    "suppose the removal at time @xmath84 from the percolation process of vertex @xmath441 creates some cluster @xmath865 at some neighbor @xmath866 of @xmath441 . if @xmath867 , there must exist a vertex @xmath441 and a neighbor @xmath866 such that the cluster formed at @xmath866 at time @xmath5 contributes at some future time @xmath868 an amount at least @xmath869 to @xmath322 . by conditioning on @xmath441 , @xmath5 , and @xmath866 ,",
    "one obtains that @xmath870 where the @xmath871 term covers the probability that the cluster at time @xmath872 , namely @xmath873 , determines @xmath322 , or that a cluster at threshold @xmath874 is of size at least @xmath875 ; @xmath876 is the neighbor set of @xmath441 ; and @xmath877 is the event that :    1 .",
    "@xmath878 satisfies @xmath879 , 2 .",
    "there exists a time @xmath880 such that @xmath865 still exists at time @xmath881 and 3 .",
    "@xmath882 , where @xmath883 is the sum of a @xmath58-sample from @xmath884 .",
    "assume ( briefly ) that @xmath885 is non - decreasing , and note that @xmath886 is automatically non - decreasing .",
    "then as in the proofs of lemmas  [ lem : uls - sub ] and  [ lem : uls - sup ] , and using similar notation , @xmath887 where @xmath888 is the number of @xmath84-open clusters of size @xmath58 and @xmath889 therefore , by ( [ final4 ] ) , @xmath890 \\\\[-8pt ] & & { } + f(t_c+h ) - f(t_c - h)\\nonumber\\end{aligned}\\ ] ] for any @xmath891 .",
    "we bound @xmath892 as we did in the proofs of lemmas [ lem : uls - sub ] and  [ lem : uls - sup ] .",
    "explicitly , when @xmath893 , we use lemma  [ lem : nk ] and ( [ s - ineq ] ) , to get @xmath894 we use chernoff s bound on @xmath895 , to obtain @xmath896 where @xmath897 , @xmath898,\\ ] ] as in ( [ a ] ) , and the last term is the probability that a there is a @xmath84-open of size exceeding @xmath899 .",
    "note that @xmath900 for all @xmath901 because @xmath902 . by continuity of @xmath903 , @xmath904 .",
    "hence , we have the following bound for all @xmath905 , @xmath906 ^ 2 m^{-(a_+ -1 ) d } + \\exp\\bigl(-h d \\log(m)/2\\bigr).\\ ] ] when @xmath907 , we simply use the fact that @xmath908 and bound @xmath895 in the same way .",
    "we get @xmath909 where @xmath910 again , @xmath900 for @xmath911 and @xmath912 as @xmath913 . hence , by continuity of @xmath903 , @xmath914 , so that @xmath915 valid for all @xmath911 . hence",
    ", the two integrals in ( [ uls - ub1 ] ) tend to zero with @xmath46 .",
    "we then let @xmath916 so that @xmath917 , because @xmath497 is continuous at @xmath186 .",
    "assume now that @xmath497 has no atoms on @xmath309 $ ] .",
    "then @xmath918 is continuous on @xmath309 $ ] , and in fact , is uniformly continuous because @xmath919 when @xmath920 , because it is positive on that interval ( because @xmath921 implies that @xmath884 is a point mass ) , @xmath922 . because @xmath923 we can find @xmath924 such that @xmath925 , and also @xmath926 such that @xmath927 let @xmath928 .",
    "we say that a cluster @xmath847 _ scores at time _",
    "@xmath547 if it exists at time @xmath547 and in addition @xmath929    without loss of generality , assume that @xmath186 is not an integer multiple of @xmath758 .",
    "fix two neighbors @xmath930 , and a time @xmath931 . if @xmath932 occurs then either :    a.   @xmath865 scores at some time @xmath933 $ ] , where @xmath934 satisfies @xmath935 , or b.   there exists @xmath936 and @xmath937 such that @xmath938 scores at time @xmath547 .",
    "the latter possibility arises when @xmath865 scores at some time @xmath547 not belonging to the interval @xmath939 .",
    "writing @xmath940 for the interval containing @xmath547 , @xmath865 must exist at the start of this interval , which is to say that @xmath941 .",
    "the probability of ( a ) is no larger than @xmath942 \\dvt y_t(k)/k \\ge\\mu_s + x_m \\sigma_{s}/\\sqrt k\\bigr).\\ ] ] by ( [ final6 ] ) and the fact that @xmath943 is non - decreasing , @xmath944 so that ( [ final8 ] ) is no greater than @xmath945 arguing similarly , part ( b ) has probability no greater than @xmath946    we divide the integral in ( [ final4 ] ) as follows @xmath947 the first integral is bounded by @xmath948 and the third integral by @xmath949 , both terms vanishing as @xmath916 . for the second and fourth integrals , we do exactly as before , separately for ( [ case - a ] ) and ( [ case - b ] )  for the latter , the sum has at most @xmath950 terms in the second integral and at most @xmath951 terms in the fourth integral .      by lemma  [ lem : uls - orig ]",
    ", @xmath302 is of order at most @xmath952 under the null . now consider the alternative with anomalous cluster @xmath0 . if @xmath953 , consider the contribution of the largest open cluster at supercritical threshold @xmath84 and reason as in the proof of theorem  [ thm : uls - sup ] .",
    "otherwise , consider the contribution of the largest open cluster at a threshold @xmath716 such that @xmath954 .",
    "as in theorem  [ thm : cc - cube - cri ] , the largest open cluster will be comparable in size to , and occupy a substantial portion of @xmath0 .",
    "reasoning again as in the proof of theorem  [ thm : uls - sup ] , the contribution is of order @xmath955 , which increases as a positive power of @xmath46 .",
    "we show that the simple scan statistic defined in ( [ scan ] ) approximates the scan statistic of kulldorff  @xcite , which is strictly speaking the glr , defined as follows .",
    "the log - likelihood under @xmath956 is given by @xmath957 assuming @xmath124 and @xmath958 are both unknown , the log glr is defined as @xmath959 which is equal to @xmath960_+.\\ ] ] ( the subscript @xmath961 denotes the positive part . )    under the normal location model , @xmath962 and ( [ scan ] ) is equal to @xmath963 ( we used the fact that @xmath964 . ) if @xmath965 satisfies @xmath966 , which is the case in our examples , the fraction above is equal to @xmath967 . moreover , knowing that there is always a cluster @xmath0 such that @xmath968 , we get that the square root of ( [ scan ] ) is approximately equal to @xmath969 which is the version of ( [ scan ] ) when @xmath75 is unknown .",
    "( note that @xmath970 , by the central limit theorem , so that ( [ scan0 ] ) is within @xmath971 from ( [ scan ] ) . )",
    "this approximation is actually valid more generally , at least in a way that suffices for the asymptotic analysis that we perform in this work . indeed , with @xmath972",
    ", we have @xmath973 in the neighborhood of @xmath75 . assuming that @xmath974 satisfies @xmath975 , which is the case in our examples , the approximation of the square root of ( [ scan ] ) by ( [ scan0 ] ) is valid under the null , because @xmath976 and @xmath977 , by the central limit theorem and the fact that @xmath978 and @xmath966 .",
    "the same applies under the alternative if @xmath260 , so that @xmath979 , and therefore , @xmath980 for any @xmath24 .",
    "when @xmath45 is bounded away from 0 , the two statistics , square root of ( [ scan ] ) and ( [ scan0 ] ) , are both of order @xmath981 , where @xmath0 denotes the cluster under the alternative ( or in the case of the @xmath210 scan , the largest open cluster within the anomalous cluster ) . taken together ,",
    "these findings are sufficient to allow us to conclude that the tests based on ( [ scan ] ) and ( [ scan ] ) behave similarly .",
    "the authors thank ganapati patil for providing additional references on the upper level set scan statistic , and mikhail langovoy for alerting the authors of his work on the loc test .",
    "they are grateful to thierry bodineau and raphal cerf for their remarks on the second - largest cluster in supercritical percolation , and to anonymous referees for helping them improve the presentation of the paper .",
    "eac was partially supported by grants from the national science foundation ( dms-06 - 03890 ) and the office of naval research ( n00014 - 09 - 1 - 0258 ) , as well as a hellman fellowship .",
    "grg was partially supported by the engineering and physical sciences research council under grant ep/103372x/1 ."
  ],
  "abstract_text": [
    "<S> we consider the task of detecting a salient cluster in a sensor network , that is , an undirected graph with a random variable attached to each node . motivated by recent research in environmental statistics and the drive to compete with the reigning scan statistic , we explore alternatives based on the percolative properties of the network . </S>",
    "<S> the first method is based on the size of the largest connected component after removing the nodes in the network with a value below a given threshold . </S>",
    "<S> the second method is the upper level set scan test introduced by patil and taillie [ _ statist . </S>",
    "<S> sci . _ </S>",
    "<S> * 18 * ( 2003 ) 457465 ] . </S>",
    "<S> we establish the performance of these methods in an asymptotic decision- theoretic framework in which the network size increases . </S>",
    "<S> these tests have two advantages over the more conventional scan statistic : they do not require previous information about cluster shape , and they are computationally more feasible . </S>",
    "<S> we make abundant use of percolation theory to derive our theoretical results , and complement our theory with some numerical experiments . </S>"
  ]
}