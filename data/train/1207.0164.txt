{
  "article_text": [
    "given arbitrary convex subsets @xmath12 , we denote the convex hull of their union by @xmath13 .",
    "we call @xmath14 a _ free sum of @xmath0 and @xmath1 _ when @xmath0 and @xmath1 each contain the origin and their respective linear spans are orthogonal coordinate subspaces ( _ i.e. _ , subspaces spanned by subsets of the standard basis vectors @xmath15 ) . more generally , we will write `` @xmath6 is a free sum '' when @xmath14 is a free sum of @xmath0 and @xmath1 up to the action of @xmath16 on @xmath2 . a familiar example is the octahedron @xmath17 in @xmath18 , which is the free sum of the `` diamond '' @xmath19 and the line segment @xmath20 .",
    "free sums arise naturally in toric geometry because the free - sum operation is dual to the cartesian product operation under polar duality : @xmath21 .",
    "for example , the free - sum decomposition above of the octahedron corresponds to the decomposition of the toric variety @xmath22 as the product of @xmath23 and @xmath24 .",
    "our goal is to understand the integer lattice points in a free sum and its integer dilates in terms of the corresponding data for its summands .",
    "of particular interest is the case of a free sum @xmath9 in which @xmath10 and @xmath11 are rational polytopes .",
    "a _ rational _",
    "( respectively , _ lattice _ ) _ polytope _ in @xmath2 is a polytope all of whose vertices are in @xmath25 ( respectively , the _ integer lattice _",
    "@xmath26 ) . given a rational polytope @xmath27 , its _",
    "ehrhart series _",
    "@xmath28 is the generating function of the _ ehrhart quasi - polynomial _ of @xmath10 , which counts the integer lattice points in @xmath29 as a function of an integer dilation parameter @xmath30 .",
    "let @xmath31 denote the _ denominator _ of @xmath10 , the smallest positive integer such that the corresponding dilate of @xmath10 is a lattice polytope . a famous theorem of ehrhart  @xcite says that @xmath32 for some polynomial @xmath33 , the _ @xmath34-polynomial _ of @xmath10 .",
    "( common alternative names for the @xmath34-polynomial include _ @xmath35-polynomial _ and _ ehrhart @xmath36-vector_. ) see , e.g. ,  @xcite for this and many more facts about ehrhart series .",
    "our work is motivated by the following result of b.  braun , which expresses the @xmath34-polynomial of @xmath9 in terms of the @xmath34-polynomials of @xmath10 and @xmath11 when @xmath10 is a reflexive polytope ( defined in section  [ sec : braunformula ] below ) .",
    "[ braunthm ] suppose that @xmath37 are lattice polytopes such that @xmath10 is reflexive , @xmath11 contains the origin in its relative interior , and @xmath9 is a free sum .",
    "then @xmath38 that is , in terms of ehrhart series , @xmath39    our first main result , theorem  [ thm : multivariatebraunsformula ] below , gives a multivariate generalization of theorem  [ braunthm ] for arbitrary compact convex sets .",
    "our second main result , theorem  [ thm : conversebraunformula ] below , characterizes the free sums of rational polytopes that satisfy our multivariate generalization of equation  .",
    "a characterization of the free sums satisfying equation   itself is a consequence . before stating our results , we first need to define some notation .",
    "the ehrhart series is a specialization of a multivariate laurent series defined as follows .",
    "let @xmath40 be the affine embedding @xmath41 . given a convex set @xmath42 ,",
    "let @xmath43 be the set of all nonnegative scalar multiples of elements of @xmath44 .",
    "equivalently , @xmath45 is the intersection of all linear cones containing @xmath44 .",
    "write @xmath46 for the set of integer lattice points in a set @xmath47 .",
    "the _ lattice - point generating function _ @xmath48 of @xmath49 is the formal multivariate laurent series @xmath50 ( here we follow the convention of writing @xmath48 for @xmath51 and @xmath52 for @xmath53 , where @xmath54 . ) the ehrhart series @xmath55 then arises as a specialization of @xmath56 : @xmath57    let @xmath58 denote the standard basis vectors in @xmath59 . given a closed linear cone @xmath60 not containing @xmath61 , define the projection @xmath62 ( where `` @xmath63 '' denotes relative boundary ) by letting @xmath64 given a compact convex set @xmath65 , we write @xmath66 as an abbreviation for @xmath67 .",
    "( we require @xmath0 to be compact so that @xmath68 is closed . )",
    "the _ lower envelope _ of @xmath69 is @xmath70 thus , the lower envelope of @xmath69 is the set of points that are `` vertically minimal '' within @xmath69 .",
    "the _ lower lattice envelope _ of @xmath69 is @xmath71 thus , the lower lattice envelope is the vertical projection of the lattice points in @xmath69 onto the lower envelope of @xmath69 .",
    "observe that the lower lattice envelope is _ not _ necessarily the set @xmath72 of lattice points in the lower envelope of @xmath69 .",
    "in general , some elements of @xmath73 may not be lattice points .",
    "[ thm : multivariatebraunsformula ] suppose that @xmath12 are convex sets such that @xmath0 is compact and @xmath6 is a free sum .",
    "suppose moreover that @xmath74 .",
    "then @xmath75    we call equation the _ multivariate braun equation_. our second main result states that , when @xmath0 and @xmath1 are rational polytopes , the converse of theorem  [ thm : multivariatebraunsformula ] also holds .",
    "( whether the converse holds for free sums @xmath6 of arbitrary convex sets is still an open question . ) given a rational polytope @xmath10 containing the origin , we observe in proposition  [ ratflexiveprop ] below that @xmath76 if and only if the polar dual @xmath77 of @xmath10 ( relative to its linear span ) is a lattice polyhedron .",
    "we show that , if a free sum of rational polytopes satisfies the multivariate braun equation , then the dual of one of those polytopes is a lattice polyhedron .",
    "[ thm : conversebraunformula ] let @xmath78 be rational polytopes such that @xmath9 is a free sum",
    ". then @xmath79 if and only if either @xmath77 or @xmath80 is a lattice polyhedron",
    ".    the univariate analogue of theorem [ thm : conversebraunformula ] is a consequence :    [ thm : conversebraununivariate ] let @xmath78 be rational polytopes such that @xmath9 is a free sum . if either @xmath77 or @xmath80 is a lattice polyhedron , then @xmath81 and hence @xmath82 conversely , if either equation or equation holds , then either @xmath77 or @xmath80 is a lattice polyhedron . in particular , if @xmath78 are lattice polytopes such that @xmath9 is a free sum , then @xmath83 if and only if either @xmath77 or @xmath80 is a lattice polyhedron .    after laying the groundwork for our approach to free sums in section  [ sec : freesumdecompositions ] ,",
    "we prove theorem  [ thm : multivariatebraunsformula ] and various corollaries , including theorem  [ braunthm ] , in section  [ sec : braunformula ] . in section  [ nonbraunformulacase ]",
    ", we give an expression for @xmath84 when @xmath85 is an arbitrary free sum in which @xmath10 is a rational polytope ( theorem  [ thm : nonbraunformulacase ] ) .",
    "we then use this expression to prove theorems  [ thm : conversebraunformula ] and  [ thm : conversebraununivariate ] .    although sections  [ sec : braunformula ] and  [ nonbraunformulacase ] address only the case where @xmath14 is a free sum , our approach is not confined to this situation .",
    "section  [ sec : nonlatticepoints ] introduces the notion of _ affine free sums _",
    "@xmath6 , where @xmath0 and @xmath1 may intersect at an arbitrary rational point .",
    "we derive formulas for the lattice - point generating functions of cones over affine free sums @xmath6 under certain conditions on @xmath0 and @xmath1 .",
    "one case of interest that satisfies these conditions is an affine free sum @xmath85 where @xmath10 is a gorenstein polytope of index @xmath30 intersecting an orthogonal convex set @xmath1 at the unique point @xmath86 such that @xmath87 is a lattice point in the relative interior of @xmath29 ( corollary  [ cor : gorensteinbrauncor ] ) .",
    "we begin our study of the generating function @xmath88 from the vantage point of the following easy identity : given any convex sets @xmath12 , the convex hull @xmath14 of their union satisfies @xmath89 where the sum on the right is the minkowski sum @xmath90 .",
    "the goal of this section is to provide two refinements to equation , first by making the equation `` disjoint '' , and then by restricting the equation to lattice points . as it stands , equation `` double counts '' elements of @xmath91 , in the sense that there are many ways to express an element of the left - hand side as a sum from the right - hand side .",
    "proposition  [ prop : freesumintodisjointboundaryandcone ] below gives a non - double - counting version of equation   under certain conditions on @xmath0 and @xmath1 .",
    "proposition  [ prop : latticefreesumintodisjointboundaryandcone ] below provides a similar expression for the integer lattice points in @xmath92 when @xmath6 is a free sum .",
    "first we make a few additional notational remarks : we write @xmath93 for the orthogonal projection @xmath94 given a subset @xmath47 of @xmath2 or @xmath59 , let @xmath95 be the linear span of @xmath47 .",
    "we say that two sublattices @xmath96 are _ complementary sublattices of @xmath26 _ if each element of @xmath97 is the sum of a unique element of @xmath98 and a unique element of @xmath99 .",
    "hence , when @xmath6 is a free sum , @xmath100 and @xmath101 are complementary sublattices of @xmath26 .",
    "equation says that @xmath102 using the concept of the lower envelope ( defined in section  [ sec : introduction ] ) , we can replace the union above by a disjoint union .",
    "this yields the desired `` disjoint '' version of equation .",
    "we use @xmath103 to denote disjoint union .    [",
    "prop : somewhatintermediate ] suppose that @xmath12 are convex sets with @xmath0 compact and @xmath104 .",
    "suppose in addition that the linear spans of @xmath0 and @xmath1 intersect trivially .",
    "then @xmath105 [ prop : freesumintodisjointboundaryandcone ]    we first show that the union on the right - hand side is a disjoint union .",
    "suppose that @xmath106 for some @xmath107 and @xmath108 .",
    "then we have @xmath109 .",
    "hence @xmath110 because the left - hand side of the equality is in @xmath111 while the right - hand side is in @xmath112 .",
    "since @xmath113 , it follows that @xmath114 .",
    "now , the preimage @xmath115 contains exactly one point in @xmath116 , so @xmath117 , proving disjointness .",
    "it remains only to show that @xmath118 the left - hand side is contained in the right - hand side because @xmath0 is compact , so @xmath119 .",
    "conversely , if @xmath120 for some @xmath121 , then @xmath122 now , @xmath123 is a nonnegative multiple of @xmath124 , which is in @xmath45 because @xmath104 .",
    "thus , adding @xmath123 to both sides of yields @xmath125 .",
    "since @xmath126 , this proves the claim .",
    "our ultimate goal is to understand the generating function @xmath88 , so we need a version of the disjoint union in proposition  [ prop : freesumintodisjointboundaryandcone ] that is restricted to the lattice points in @xmath92 .",
    "this is provided by the following proposition .",
    "see also figure  [ fig : latticefreesumintodisjointboundaryandcone ] .",
    "[ prop : latticefreesumintodisjointboundaryandcone ] suppose that @xmath12 are convex sets such that @xmath0 is compact and @xmath6 is a free sum . then @xmath127    .",
    "the dots indicate elements of @xmath128 .",
    "the shaded regions represent translations of @xmath45 by elements of @xmath128 .",
    "the import of proposition  [ prop : latticefreesumintodisjointboundaryandcone ] is that all lattice points in @xmath92 are within these shaded regions . ]",
    "the elements of the right - hand side are lattice points that are contained in @xmath92 by the previous proposition .",
    "hence , such elements are in the left - hand side .    to prove the converse containment , let @xmath129 be given . by proposition  [ prop : somewhatintermediate ] , there exist @xmath130 and @xmath131 such that @xmath132",
    "thus , @xmath133 .",
    "now , @xmath134 is an integer lattice point in @xmath135 , while @xmath136 and @xmath137 .",
    "since @xmath100 and @xmath101 are complementary sublattices of @xmath26 , it follows that @xmath138 .",
    "furthermore , @xmath139 and @xmath140 , so there exists an integer @xmath141 such that @xmath142 .",
    "therefore , @xmath143",
    ".    if @xmath6 is not a free sum , then proposition [ prop : latticefreesumintodisjointboundaryandcone ] does not hold .",
    "for example , let @xmath144 be the segment @xmath145 $ ] , and let @xmath146 be the segment @xmath147 $ ] .",
    "note that @xmath100 and @xmath101 are not complementary sublattices in @xmath148 , so @xmath6 is not a free sum .",
    "the equation in proposition [ prop : latticefreesumintodisjointboundaryandcone ] fails to hold in this case because , for example , the lattice point @xmath149 appears in @xmath150 but not in @xmath151 .",
    "the multivariate braun equation does not hold for all free sums @xmath6 of convex sets . in this section",
    ", we give conditions on @xmath0 and @xmath1 that suffice to imply equation .",
    "the conditions we give generalize those originally given by braun in  @xcite . in the next section",
    ", we will show that , conversely , our conditions are necessary in the case where @xmath0 and @xmath1 are rational polytopes .    to apply proposition  [ prop : latticefreesumintodisjointboundaryandcone ] , we need to get our hands on the set @xmath128 .",
    "the next proposition considers the case where all the elements of this set are integer lattice points .",
    "[ settogeneratingfctprop ] let @xmath65 be a compact convex set containing the origin .",
    "then the following conditions are equivalent :    1 .",
    "@xmath74 , 2 .",
    "@xmath152 , 3 .",
    "@xmath153 .",
    "we start by proving that ( a ) and ( b ) are equivalent .",
    "first , note that the set containments @xmath154 and @xmath155 always hold . to see that the respective converse containments are equivalent , observe that @xmath156 is a bijection between non - lower - envelope points in @xmath157 and non - lattice points in @xmath128 , with inverse bijection @xmath158 .",
    "thus , if either containment above is an equality , then so too is the other .    finally , the left- ( resp .",
    "right- ) hand side of ( c ) lists the points of the left- ( resp .",
    "right- ) hand side of ( b ) in generating - function form , so ( b ) and ( c ) are equivalent .",
    "theorem  [ thm : multivariatebraunsformula ] is now an easy corollary of the previous proposition .",
    "[ proof : multivariatebraunsformula ] since @xmath159 the set - theoretic equation in proposition  [ prop : latticefreesumintodisjointboundaryandcone ] can be restated in terms of generating functions as follows : @xmath160 the theorem now follows from the equivalence of ( a ) and ( c ) in proposition  [ settogeneratingfctprop ] .",
    "the conditions in proposition  [ settogeneratingfctprop ] take on an especially nice form when the convex set @xmath0 is a rational polytope .",
    "we now show that , in this case , these conditions are equivalent to the condition that the polar dual of @xmath0 is a lattice polyhedron .",
    "we recall the relevant definitions .",
    "the _ polar dual _ of a polytope @xmath161 containing the origin is defined to be the polyhedron @xmath162 where @xmath163 denotes the set of all real - valued linear functionals on a vector space @xmath164 .",
    "( note that we use @xmath165 to refer to the dual of @xmath10 _ with respect to the linear span of @xmath10_. ) in general , @xmath166 may be unbounded , but , if @xmath167 , then @xmath165 is a polytope .",
    "( here we write @xmath168 for the interior of a set @xmath47 relative to the subspace topology on @xmath95 . )",
    "let @xmath169 be linear functionals such that @xmath170 then @xmath77 can be expressed as the minkowski sum of a polytope and a polyhedral cone in the dual space @xmath171 as follows : @xmath172 where @xmath173 denotes the _ positive hull _",
    "@xmath174 of a set @xmath47 .",
    "we call @xmath165 a _ lattice polyhedron _ if its vertices are in the _ dual integer lattice _ defined by @xmath175 a polytope @xmath10 is _ reflexive _ if both @xmath10 and @xmath166 are lattice polytopes .",
    "reflexive polytopes were introduced by victor batyrev to study mirror symmetry in string theory  @xcite .",
    "hibi  @xcite showed that a lattice polytope @xmath10 containing the origin in its interior is reflexive if and only if @xmath176 for all integers @xmath177 .",
    "this latter condition , in turn , is equivalent to @xmath76 .",
    "hibi s proofs carry over with virtually no change if we merely assume that @xmath10 is rational and contains the origin ( not necessarily in its interior ) .",
    "hibi s arguments then show that @xmath77 is a lattice polyhedron if and only if @xmath76 .",
    "we include a proof of this equivalence for completeness ( proposition  [ ratflexiveprop ] below ) .",
    "non - lattice rational polytopes with lattice duals have appeared , e.g. , in  @xcite , which gives a rational analogue of a theorem of hibi on the ehrhart series of reflexive polytopes  @xcite .",
    "[ ratflexiveprop ] let @xmath10 be a rational polytope with @xmath178 .",
    "then @xmath77 is a lattice polyhedron if and only if @xmath76 .",
    "suppose that @xmath77 is a lattice polyhedron .",
    "it is clear that @xmath179 . to prove the converse containment ,",
    "let @xmath180 be given .",
    "by definition of the lower lattice envelope , we have that @xmath181 .",
    "let @xmath182 be the vertices of @xmath165 , and let @xmath183 .",
    "then @xmath184 while @xmath185 for @xmath186 .",
    "thus , @xmath187 . furthermore , since each @xmath188 is a dual integer lattice point , we have that @xmath189 , which implies that @xmath190 , proving the desired containment .",
    "conversely , suppose that @xmath77 has a vertex @xmath191 .",
    "let @xmath192 be the sublattice of @xmath193 on which @xmath194 evaluates as an integer .",
    "thus , @xmath195 is a full - rank proper sublattice of @xmath193 .",
    "let @xmath196 be the facet of @xmath10 supported by the hyperplane @xmath197 .",
    "then there exists a lattice point @xmath198 .",
    "( this may be seen by observing that @xmath199 is a full - dimensional cone containing some element of @xmath195 in its interior .",
    "hence , @xmath199 contains some @xmath195-translate of a fundamental domain of @xmath195 , which in turn contains elements of @xmath200 . )",
    "we then have that @xmath201 but @xmath202 , so that @xmath203 .    as a corollary of propositions [ settogeneratingfctprop ] and [ ratflexiveprop ]",
    ", we find that the multivariate braun equation holds when one of the summands is a rational polytope whose polar dual is a lattice polyhedron .",
    "[ rationalbraunmultivarcor ] let @xmath161 be a rational polytope such that @xmath77 is a lattice polyhedron , and let @xmath42 be a convex set such that @xmath85 is a free sum . then @xmath204    by applying the specialization @xmath205 , we arrive at the following generalization of braun s theorem  [ braunthm ] .",
    "[ braunthmgeneralizedcor ] if @xmath78 are rational polytopes such that @xmath77 is a lattice polyhedron and @xmath9 is a free sum , then @xmath206 and hence @xmath207 in particular , if @xmath78 are lattice polytopes such that @xmath77 is a lattice polyhedron and @xmath9 is a free sum , then @xmath208    corollary  [ braunthmgeneralizedcor ] recovers the following generalization of theorem  [ braunthm ] , due to braun  ( * ? ? ?",
    "* corollary 1 ) : let @xmath10 and @xmath11 be as in theorem  [ braunthm ] , and let @xmath209 ( respectively , @xmath210 ) be a lattice polytope equal to the intersection of @xmath10 ( resp . , @xmath11 ) with a finite collection of half - spaces in @xmath211 ( resp . , @xmath212 ) bounded by hyperplanes passing through the origin",
    ". then @xmath213",
    ".    there are lattice polytopes covered by our corollary  [ braunthmgeneralizedcor ] that do not satisfy the conditions of braun s  ( * ? ? ?",
    "* corollary 1 ) .",
    "for example , let @xmath214 be the polygon @xmath215 .",
    "then @xmath10 is not contained in any reflexive polygon , but the dual of @xmath10 is a lattice polyhedron .",
    "( the polygon @xmath10 is a @xmath216-dimensional analogue of a so - called _ top _ polytope .",
    "top polytopes , like reflexive polytopes , originally arose in string theory   @xcite . )",
    "in this section , we prove theorem  [ thm : conversebraunformula ] , the converse of theorem  [ thm : multivariatebraunsformula ] in the case where the summands are rational polytopes .",
    "that is , we show that , if @xmath10 and @xmath11 are rational polytopes containing the origin such that @xmath217 then either @xmath77 or @xmath80 is a lattice polyhedron .",
    "we also prove theorem  [ thm : conversebraununivariate ] , the univariate version of theorem  [ thm : conversebraunformula ] .",
    "fix a rational polytope @xmath27 such that @xmath218 , and let @xmath42 be a convex set such that is a free sum . as in the previous section , we approach the generating function @xmath219 via the decomposition of @xmath220 given by proposition  [ prop : latticefreesumintodisjointboundaryandcone ] .",
    "the first step , therefore , is to find a useable description of the lower lattice envelope @xmath221 in the case where we do not necessarily have @xmath76 .",
    "write @xmath222 for the denominator @xmath223 of @xmath77 .",
    "for each nonnegative integer @xmath224 , let @xmath225 ( observe that the definition of @xmath226 depends upon the choice of @xmath10 , although this is not reflected in the notation . )",
    "we similarly define the _ shifted lower envelopes _ @xmath227 and @xmath228 of these shifted cones .",
    "the _ rind _ of @xmath229 is @xmath230 .",
    "proposition  [ prop : rindandstrata ] below is a generalization of proposition  [ settogeneratingfctprop ] as applied to any rational polytope containing the origin . before giving the formal statement of proposition [ prop :",
    "rindandstrata ] , we give an informal summary .",
    "see also figure  [ fig : rindandstrata ] .",
    "* each point in the lower lattice envelope is the result of taking a unique lattice point on some shifted lower envelope contained in the rind of @xmath229 and projecting that lattice point down to the lower envelope . *",
    "no lattice point lies between consecutive shifted lower envelopes . *",
    "hence , every lattice point in the rind lies on exactly one of the shifted lower envelopes .",
    "[ prop : rindandstrata ] suppose that @xmath27 is a rational polytope with @xmath178 , and let @xmath231 .",
    "define the shifted cones @xmath232 for @xmath233 as above .",
    "then we have the following :    1 .",
    "@xmath234 2 .",
    "@xmath235 for @xmath236 3 .",
    "@xmath237 for @xmath236 4 .",
    "@xmath238 .    , @xmath239 , where @xmath240 { \\subseteq}{\\mathbb{r}}^{1}$ ] .",
    "the shaded region is the rind of @xmath229 .",
    "observe that every lattice point in the rind lies on one of the shifted lower envelopes shown . ]",
    "the right - hand side of part ( a ) is contained in the left - hand side because elements of the right - hand side are points in @xmath241 that are directly beneath lattice points . to see that the left - hand side of part ( a ) is contained in the right - hand side ,",
    "let @xmath242 be given .",
    "it suffices to show that @xmath243 for some @xmath244 .",
    "let @xmath245 and let @xmath246 .",
    "thus , @xmath247 , but @xmath248 for all @xmath186 .",
    "hence , @xmath249 , so @xmath250 .",
    "now , every vertex @xmath251 of @xmath77 satisfies @xmath252 for all @xmath253 . since @xmath254",
    ", we thus have that @xmath255 for some @xmath256 .",
    "therefore , @xmath257 , as required .    to see that the union in part ( a ) is disjoint",
    ", suppose that @xmath258 for some @xmath259 and @xmath260 , where , without loss of generality , @xmath261 .",
    "then @xmath262 is a lattice point and @xmath263 .",
    "this implies that @xmath264 , showing disjointness and proving part  ( a ) .    to prove part ( b ) ,",
    "suppose that there is an element @xmath265 on the right - hand side that is not on the left - hand side .",
    "then , for some integer @xmath224 such that @xmath266 and some @xmath141 such that @xmath267 , we have @xmath268 .",
    "hence , by part ( a ) , there exist @xmath269 and @xmath270 such that @xmath271 .",
    "this implies that @xmath272 is an integer , which is a contradiction .",
    "this proves part ( b ) .",
    "part ( c ) follows immediately , since it is a restatement of part ( b ) in terms of generating functions .",
    "part ( d ) results from summing both sides of part ( c ) over all integers @xmath224 such that @xmath266 .    using the previous proposition",
    ", we can write down a version of proposition [ prop : latticefreesumintodisjointboundaryandcone ] in which the sets in the disjoint union are indexed by lattice points .",
    "this allows us to translate the resulting set equality directly into an equality of generating functions .",
    "[ thm : nonbraunformulacase ] suppose that @xmath27 is a rational polytope and @xmath42 is a convex set such that @xmath85 is a free sum .",
    "then @xmath273 therefore , @xmath274    by proposition  [ prop : latticefreesumintodisjointboundaryandcone ] , @xmath275 by proposition  [ prop : rindandstrata](a ) , this becomes @xmath276 equation is the restatement of this equality in terms of generating functions , and equation follows from proposition  [ prop : rindandstrata](c ) .",
    "some of the terms in equation may be zero .",
    "for example , if @xmath10 is the interval @xmath277 $ ] , then @xmath278 .",
    "( see figure [ fig : rindandstrata ] . ) nonetheless , if @xmath279 , then @xmath280 for some @xmath281 by proposition  [ ratflexiveprop ] .    before proving theorem  [ thm : conversebraunformula ] , we need two lemmas constraining when lattice points can appear in the shifted lower envelopes of cones over compact convex sets .    [",
    "lem : lowerenvelopesaresymmetric ] let @xmath65 be a compact convex set , and let @xmath282 be a rational number",
    ". then @xmath283 if and only if @xmath284 .",
    "since @xmath285 , a ray @xmath286 originating at @xmath287 contains a lattice point if and only if the inversion of @xmath286 through @xmath288 also contains a lattice point .",
    "hence , the set @xmath289 , which is a union of rays originating at @xmath290 , contains a lattice point if and only if its inversion through @xmath291 contains a lattice point . but",
    "@xmath292 is just the inversion of this latter set through the origin .",
    "that is , @xmath293 since inversion through the origin is a lattice - preserving operation , the claim follows .",
    "[ lem : lowerenvelopescontaininglatticepointshaverationalvertices ] let @xmath11 be a rational polytope , and let @xmath282 be a real number . if @xmath294 then @xmath282 is a rational number .",
    "let @xmath295 , and let @xmath196 be a facet of @xmath296 containing .",
    "then the supporting hyperplane @xmath297 of @xmath296 at @xmath196 is a rational hyperplane containing @xmath298 .",
    "therefore , the translation @xmath299 by an integer lattice point must meet the @xmath124-axis at a rational point .",
    "we are now ready to prove theorem  [ thm : conversebraunformula ] .",
    "[ proof : conversebraunformula ] the `` if '' direction follows immediately from corollary  [ rationalbraunmultivarcor ] . to prove the converse ,",
    "suppose that equation holds but that @xmath77 is not a lattice polyhedron .",
    "then , by proposition  [ ratflexiveprop ] , @xmath300 . hence , by proposition  [ prop : rindandstrata](a ) , there exists a maximum integer @xmath301 with @xmath302 such that @xmath303 .",
    "we claim that the nonemptiness of @xmath304 , in combination with equation  , implies that @xmath305 to see this , apply proposition [ prop : rindandstrata](d ) to rewrite equation   as follows : @xmath306 together with theorem [ thm : nonbraunformulacase ] , this yields @xmath307 or , equivalently , @xmath308 since @xmath309 , the monomials on the left - hand side all have nonnegative coefficients . in particular , since @xmath303 , we must have that @xmath310 , proving equation .",
    "we now show that @xmath311 .",
    "the maximality of @xmath301 implies that @xmath312 which , by lemma  [ lem : lowerenvelopesaresymmetric ] , becomes @xmath313 translating by @xmath124 and then reversing the order of the disjoint union yields @xmath314 since @xmath303 and @xmath315 , we must have @xmath316 , or @xmath311 , as claimed .",
    "we now apply similar reasoning to @xmath296 .",
    "equation implies that @xmath317 once again applying lemma  [ lem : lowerenvelopesaresymmetric ] , we get @xmath318 while , translating the sets in equation by @xmath124 and then reversing the order of the disjoint union , we have @xmath319 since @xmath311 , we can combine equalities and to conclude that @xmath320 hence , by lemma  [ lem : lowerenvelopescontaininglatticepointshaverationalvertices ] , @xmath321 thus , by proposition  [ settogeneratingfctprop ] , we have that @xmath322 . therefore , by proposition  [ ratflexiveprop ] , @xmath80 is a lattice polyhedron .",
    "it is now straightforward to prove theorem  [ thm : conversebraununivariate ] , the univariate analogue of theorem  [ thm : conversebraunformula ] .",
    "[ proof : conversebraununivariate ] corollary [ braunthmgeneralizedcor ] already established that , if either @xmath77 or @xmath80 is a lattice polyhedron , then equations and hold . to prove the converse",
    "suppose that neither @xmath77 nor @xmath80 is a lattice polyhedron .",
    "then , by theorem [ thm : conversebraunformula ] , @xmath323 by theorem [ thm : nonbraunformulacase ] and proposition [ prop : rindandstrata](d ) , this becomes @xmath324 now , since @xmath309 for all @xmath224 , every monomial on the right - hand side appears on the left - hand side .",
    "thus , @xmath325 for some nonzero laurent series @xmath326 with nonnegative coefficients .",
    "hence , specializing equation at @xmath327 yields @xmath328 where @xmath329 is a nonzero power series .",
    "in particular , equation does not hold .",
    "multiplying through by the denominator of the rational function @xmath330 shows that equation also does not hold .",
    "( equation is just the case of equation in which @xmath331 . )",
    "in previous sections , we considered the generating function @xmath332 where @xmath14 was a free sum . in particular , @xmath0 and @xmath1 intersected only at the origin .",
    "matters are essentially the same if @xmath0 and @xmath1 intersect at an arbitrary _ lattice _ point @xmath333 in @xmath26 , since we can reduce the computation of @xmath332 to the previous case via the equation @xmath334 ( here , in accordance with the convention mentioned in section  [ sec : introduction ] , @xmath335 denotes the monomial @xmath336 , where @xmath337 . )",
    "we now turn to the case where @xmath0 and @xmath1 intersect in an arbitrary rational point in @xmath25 . our results in this section",
    "generalize the propositions in section  [ sec : freesumdecompositions ] and some of the results in section  [ sec : braunformula ] .",
    "we begin by extending our earlier definitions of lower ( lattice ) envelopes to accommodate projections that are not in the vertical direction .    given @xmath338 ,",
    "define @xmath339 via @xmath340 where @xmath341 is the last coordinate of @xmath342 .",
    "thus , instead of projecting vertically down to @xmath2 ( as in previous sections ) , @xmath343 projects parallel to @xmath344 . note that @xmath345 .",
    "however , in general we may not have @xmath346 .",
    "given a closed linear cone @xmath60 not containing @xmath347 , define @xmath348 via @xmath349 given a compact convex set @xmath65 , we will write @xmath350 as an abbreviation for @xmath351",
    ". we then define the _",
    "@xmath333-lower envelope _",
    "@xmath352 of @xmath69 via @xmath353 similar to the lower envelope , the @xmath333-lower envelope of @xmath69 is the set of points in @xmath69 that are `` minimal in the direction of @xmath344 '' .",
    "finally , we introduce the notion of _ @xmath333-lower lattice envelope _ of @xmath69 , defined as @xmath354 thus the @xmath333-lower lattice envelope is the projection of the lattice points in @xmath69 in the direction parallel to @xmath344 onto the @xmath333-lower envelope of @xmath69 . the lower ( lattice )",
    "envelope of previous sections reappears as the special case @xmath355 .",
    "[ prop : somewhatintermediateaffine ] suppose that @xmath12 are convex sets with @xmath0 compact .",
    "suppose in addition that the affine spans of @xmath0 and @xmath1 intersect in exactly one rational point @xmath356 .",
    "then @xmath357 [ prop : freesumintodisjointboundaryandconeinpcase ]    once we note that , for @xmath139 , @xmath358 is in @xmath359 , the proof of this proposition is the same as the proof of proposition  [ prop : freesumintodisjointboundaryandcone ] with the appropriate replacements ( such as @xmath360 replaced by @xmath343 , and @xmath361 replaced by @xmath362 ) .",
    "we now seek a restriction of equation to lattice points that is in the spirit of proposition  [ prop : latticefreesumintodisjointboundaryandcone ] . to this end",
    ", we define an analogue of the free - sum operation , which we call an _ affine free sum_. recall that , for @xmath14 to be a free sum , we required that @xmath100 and @xmath101 be complementary sublattices of @xmath26",
    ". one complication of our present case is that @xmath358 is not necessarily a lattice point for every lattice point @xmath342 in @xmath68 .",
    "thus , we consider the refinement @xmath363 of @xmath26 . there are several equivalent characterizations of this lattice :    1 .",
    "@xmath365 is the lattice in @xmath366 generated by @xmath367 under integer linear combinations .",
    "@xmath368 , where @xmath369 is the least common multiple of the denominators of the coordinates of @xmath333 .",
    "we adapt our earlier notation and terminology to work with the lattice @xmath365 as follows . for a subset @xmath47 of @xmath366 ,",
    "let @xmath370 denote the set of points in @xmath371 .",
    "we say that two sublattices @xmath372 are _ complementary sublattices of @xmath365 _ if each element of @xmath373 is the sum of a unique element of @xmath98 and a unique element of @xmath99 .",
    "given convex sets @xmath0 and @xmath1 in @xmath366 , we call @xmath14 an _ affine free sum _ if @xmath0 and @xmath1 intersect at a point @xmath374 such that @xmath375 and @xmath376 are complementary sublattices of @xmath365 .",
    "equivalently , @xmath6 is an affine free sum if @xmath0 and @xmath1 intersect at a unique rational point and @xmath377 where the sum on the right is the minkowski sum .",
    "suppose that @xmath12 are convex sets such that @xmath0 is compact and @xmath14 is an affine free sum of convex sets intersecting at @xmath374 .",
    "then @xmath378 [ prop : latticefreesumintodisjointboundaryandconeinpcase ]      to prove the converse containment , let @xmath379 be given .",
    "then by the previous proposition , @xmath380 where @xmath381 and @xmath131 .",
    "thus , @xmath382 .",
    "now , @xmath383 is in @xmath384 , while @xmath385 and @xmath386 .",
    "thus , the complementarity of @xmath375 and @xmath376 implies that @xmath358 is in @xmath365 .",
    "hence there exists a non - negative integer @xmath141 such that @xmath387 is an integer lattice point in @xmath68 . since @xmath388 , we have @xmath389 , and the result follows .",
    "we first show that ( a ) and ( b ) are equivalent . by definition of the @xmath333-lower envelope and @xmath333-lower lattice envelope",
    ", we have @xmath394 and @xmath395 . as in the proof of proposition  [ settogeneratingfctprop ] , we observe that @xmath396 is a bijection between non - lower - envelope points in @xmath397 and non - lattice points in @xmath398 , with the inverse given by @xmath399 .",
    "the rest of the proof is the same as the proof of proposition  [ settogeneratingfctprop ] .",
    "[ thm : multivariatebraunsformulainpcase ] suppose that @xmath12 are convex sets such that @xmath0 is compact and @xmath14 is an affine free sum of convex sets intersecting at @xmath374 .",
    "further suppose that @xmath391 .",
    "then @xmath400 where @xmath369 .",
    "[ rem : bruns ] it is straightforward to adapt the arguments in section [ nonbraunformulacase ] to prove a converse of theorem [ thm : multivariatebraunsformulainpcase ] analogous to theorem [ thm : conversebraunformula ] .",
    "that is , one can show that , if @xmath401 is an affine free sum of rational polytopes intersecting at @xmath374 , and @xmath402 then @xmath403 .",
    "a recent preprint of w.  bruns proves this result in the general context of arbitrary affine monoids  @xcite .",
    "as is the case with theorem [ thm : multivariatebraunsformula ] , whether the converse of theorem [ thm : multivariatebraunsformulainpcase ] holds for free sums @xmath6 of arbitrary convex sets is still an open question .",
    "[ exm : affinefreesum1 ] let @xmath0 be the line segment from @xmath404 to @xmath405 in @xmath406 and let @xmath1 be the line segment from @xmath407 to @xmath408 in @xmath406 . then @xmath0 and @xmath1 intersect at @xmath409 , and @xmath14 is an affine free sum .",
    "the @xmath333-lower envelope of @xmath68 is the boundary of the cone , and the set of lattice points in the boundary is precisely the set @xmath410 , where @xmath411 .",
    "thus , @xmath0 satisfies the conditions in proposition  [ prop : settogeneratingfctinpcase ] .",
    "hence , theorem  [ thm : multivariatebraunsformulainpcase ] applies , yielding @xmath412    theorem  [ thm : multivariatebraunsformulainpcase ] need not hold if we drop the condition that @xmath391 . if we keep @xmath0 the same set as in example  [ exm : affinefreesum1 ] , but let @xmath1 be the line segment from @xmath413 to @xmath414 in @xmath406 , then @xmath415 , @xmath416 and @xmath417 .",
    "the @xmath333-lower envelope of @xmath68 is still the boundary of the cone , but there are now lattice points in the set @xmath418 that are not in the boundary of the cone .",
    "thus , the conditions in proposition  [ prop : settogeneratingfctinpcase ] are not true of @xmath0 , and so we would need to use generalizations of results from section  [ nonbraunformulacase ] to compute @xmath419 .",
    "we do not develop such generalizations here .",
    "we now consider an important class of polytopes for which the conditions in proposition  [ prop : settogeneratingfctinpcase ] are true , so that theorem  [ thm : multivariatebraunsformulainpcase ] applies when one of the summands is a polytope from this class .",
    "a lattice polytope @xmath10 is _ gorenstein of index @xmath30 _ if there exists a lattice point @xmath420 such that @xmath421 is a reflexive polytope . in particular",
    ", @xmath420 is the unique lattice point in @xmath422 .",
    "the recent paper  @xcite discusses braun s formula in the context of gorenstein polytopes and nef - partitions .      since @xmath425",
    ", we have that @xmath426 .",
    "it is well known that the gorenstein property implies that @xmath427 ( see , _",
    "e.g. _ ,  @xcite ) .",
    "in particular , @xmath428 .",
    "the result follows from proposition [ prop : settogeneratingfctinpcase](b ) .",
    "[ cor : gorensteinbrauncor ] suppose that @xmath161 is a gorenstein polytope of index @xmath30 .",
    "let @xmath420 be the unique lattice point in @xmath423 , and let @xmath424 .",
    "let @xmath42 be a convex set containing @xmath333 such that @xmath429 is an affine free sum .",
    "then @xmath430      in section  [ sec : braunformula ] , we noted that the conditions in proposition  [ settogeneratingfctprop ] applied to a broader family than just the reflexive polytopes .",
    "indeed , in that context , the integrality of the vertices of the polytope was unimportant ; all that we needed was that the polar dual be a lattice polyhedron ( cf .  proposition  [ ratflexiveprop ] ) .",
    "it is natural to expect that the gorenstein condition in proposition  [ prop : gorensteinlowerlatticepoints ] can similarly be weakened to admit non - lattice polytopes .",
    "for example , one might hope that , in proposition  [ prop : gorensteinlowerlatticepoints ] , we could take @xmath10 to be any rational polytope such that , for some integer @xmath30 and some lattice point @xmath432 , @xmath433 is a lattice polyhedron .",
    "unfortunately , this is not the case in general , as the following example shows",
    ".    let @xmath434 { \\subseteq}{\\mathbb{r}}^1 $ ] .",
    "observe that @xmath435 $ ] contains the lattice point @xmath436 and that the polar dual of @xmath437 $ ] is the lattice polytope @xmath438 { \\subseteq}({\\mathbb{r}}^{1})^{\\ast}$ ] .",
    "nonetheless , putting @xmath439 , the @xmath333-lower lattice envelope of @xmath229 contains the non - lattice point @xmath440 .",
    "therefore , the conclusion of proposition  [ prop : gorensteinlowerlatticepoints ] is not true of @xmath10 .",
    "as mentioned in remark  [ rem : bruns ] , recent results by w.  bruns  @xcite generalize our observations to the context of general affine monoids .",
    "nevertheless , as the example above shows , there still remains the problem of characterizing when equation   applies in terms of the summand polytopes , as in proposition  [ ratflexiveprop ] , rather than in terms of the cones over them , as in  @xcite and remark  [ rem : bruns ] .",
    "m.  beck and s.  robins , _ computing the continuous discretely : integer - point enumeration in polyhedra _ , undergraduate texts in mathematics , springer , new york , 2007 , electronically available at http://math.sfsu.edu/beck/ccd.html .",
    "m.  henk , j.  richter - gebert , and g.  m. ziegler , _ basic properties of convex polytopes _ , handbook of discrete and computational geometry , crc press ser .",
    "discrete math .",
    "crc , boca raton , fl , 1997 , pp ."
  ],
  "abstract_text": [
    "<S> let @xmath0 and @xmath1 be convex sets in @xmath2 whose affine spans intersect at a single rational point in @xmath3 , and let @xmath4 . </S>",
    "<S> we give formulas for the generating function @xmath5 of lattice points in all integer dilates of @xmath6 in terms of @xmath7 and @xmath8 , under various conditions on @xmath0 and @xmath1 . </S>",
    "<S> this work is motivated by ( and recovers ) a product formula of b.  braun for the ehrhart series of @xmath9 in the case where @xmath10 and @xmath11 are lattice polytopes containing the origin , one of which is reflexive . in particular , we find necessary and sufficient conditions for braun s formula and its multivariate analogue . </S>"
  ]
}