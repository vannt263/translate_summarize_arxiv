{
  "article_text": [
    "relativistic quantum statistics is important for studying thermodynamic properties of electrons at the elevated degeneracy and relatively high temperature as found in the interior of massive stars .",
    "chandrasekhar @xcite expresses the thermodynamic quantities as integrals of hyperbolic functions [ see eq .",
    "( 170 ) - ( 172 ) of @xcite ] . in a more general way cox & giuli @xcite ,",
    "write them in term of the generalized fermi - dirac ( fd ) functions with different orders [ see eq .",
    "( 24.98 ) - ( 24.100 ) of @xcite ] .",
    "they define the generalized fd functions as    @xmath3    where @xmath4 and @xmath5 are the degeneracy parameter and a dimensionless temperature , respectively . here , @xmath6 is electron mass , @xmath7 absolute temperature , @xmath8 the chemical potential , @xmath9 speed of light in vacuum and @xmath10 the boltzmann constant .",
    "the non - relativistic form of eq .",
    "( 1 ) ( corresponding to @xmath11 ) is    @xmath12    is usually called the fermi - dirac function , and is used to study thermodynamic properties of the degenerate non - relativistic electron gas . for the usual physical applications , both for the non - relativistic and relativistic functions , the index @xmath13 is an integer or half integer with @xmath14 .",
    "no exact analytic formulae are available to evaluate the generalized fd functions in full range of degeneracy and temperature .",
    "some approximate expressions exist for some extreme cases , such as when degeneracy is very low , or extremely high @xcite .",
    "there are also asymptotic expressions for the thermodynamic quantities alone @xcite . on the other hand , eggleton et al .",
    "@xcite , give a very useful global fitting formula for the generalized fd functions [ see also @xcite ] , even though its accuracy is relatively modest .",
    "numerical evaluation of the generalized fd functions is not an easy task .",
    "simple tabular interpolations @xcite can cover only a small range of degeneracy and temperature , and the accuracy is not very good . because the integrand is proportional to @xmath15 when @xmath16 , and decays as @xmath2 when @xmath17 , few simple numeric integration methods can simultaneously cover a sufficiently large range of degeneracy and temperature with acceptable accuracy as well as with an acceptable calculation effort .",
    "@xcite uses a modified gauss quadrature with weight function @xmath18 , and @xcite uses weight function @xmath19 to integrate the generalized fd functions directly .",
    "both methods are relatively fast , but are only good for @xmath20 . in @xcite , a gauss - laguerre quadrature with adjusted decay factor",
    "is used to cover @xmath21 , and approximation formulae beyond that region . in @xcite , different variations of the trapezoidal rule are being used to do the integration , but both involve a heavy trade - off between accuracy and computing time .",
    "mohankumar & natarajan @xcite use another approximation method by subtracting the sum of residues of finite number of poles within a pre - selected contour from results of trapezoidal integration .",
    "this method is fast when @xmath0 is not too big , and the results can reach 14-digit accuracy in double precision for @xmath22 , and when @xmath0 is not too small , typically from @xmath23 to @xmath24 .",
    "it is good to about 10 digits when @xmath0 is as large as 10000 .",
    "however , the number of poles to be included increases rapidly when @xmath0 gets too big . extending this method to calculate different derivatives of the generalized fd functions with",
    "the same order of accuracy is not an easy task .",
    "aparicio @xcite proposed another method which consists of splitting the generalized - fd - function integral into four regions .",
    "the break points are chosen such that errors from all four regions are balanced , and the location of the break points is optimized .",
    "based on the property of the integrand , the gauss - legendre quadratures used are from @xmath25 to @xmath26 , and the gauss - laguerre quadrature from @xmath26 to @xmath17 [ see appendix ( [ bps ] ) ] .",
    "the method is fast ( proportional to the number of points used in gauss quadratures ) and accurate .",
    "extending it to include derivatives of the generalized fd functions is straightforward .",
    "our numerical method to evaluate derivatives of the generalized fd functions follows this scheme closely .",
    "we discuss it in more detail in sect .",
    "3 .    besides the generalized fd functions themselves , their derivatives are also important for computing the thermodynamic quantities of an electron gas .",
    "miralles & van riper @xcite give the results of the first order of derivatives of the generalized fd functions with respect to both @xmath0 and @xmath1 .",
    "they use approximation formulae when @xmath0 is either very large or very small , and interpolate through tables when @xmath0 is in between .",
    "the disadvantage is that it is only accurate to about 6 digits , and discontinuity exists when two different methods join .",
    "also , their results are limited to @xmath27 and @xmath28 only . on the other hand , solar equation of state studies",
    "require up to third order derivatives on the generalized fd functions @xcite .",
    "in particular , the precise data from helioseismology have demonstrated that the relativistic electron gas is necessary for solar modeling @xcite . for solar applications ,",
    "high - precision computations of the relativistic thermodynamic quantities are mandatory @xcite .",
    "because of its complexity , the generalized fd functions have not been fully understood . in sect .",
    "2 we first present some newly found recursion relations , and then discuss some of their properties . the numerical method to calculate derivatives of the generalized fd functions up to the third order",
    "is introduced in sect .",
    "3 , based on the scheme of @xcite . at the end we check the efficiency and validity of some popularly used analytic approximation formulae in several extreme cases in sect .",
    "cox & giuli @xcite show that the generalized fd functions obey the following recursion relations    @xmath29    which link the fd functions @xmath30 and @xmath31 _ via _ both their @xmath0 and @xmath1 derivatives . beyond that",
    ", we have found that the generalized fd functions also obey another recursion relation    @xmath32    which is between the generalized fd functions and their @xmath1 derivatives .    from eq .",
    "( [ fo : rr1 ] ) and eq .",
    "( [ fo : rr2 ] ) we can further derive two useful recursion relations , in which    @xmath33    is a relation among @xmath34 , @xmath30 and @xmath35 , with both @xmath0 and @xmath1 derivatives , and    @xmath36    is between the generalized fd functions and their @xmath0 derivatives only .",
    "these recursion relations can be used to check the accuracy of numerical evaluations as well as to simplify some theoretical expressions .",
    "however , one should keep in mind that when @xmath0 is very small the two terms on the right - hand side of either eq .",
    "( [ fo : rr1 ] ) and eq .",
    "( [ fo : rr3 ] ) are so close to each other that almost perfect cancellation happens .",
    "for this reason , the use of recursion relations to evaluate the derivatives of the generalized fd functions is not always possible .    one interesting property of the recursion relation in eq .",
    "( [ fo : rr1 ] ) is that , for the non - relativistic limit case ( @xmath37 ) , it can be written as :    @xmath38    which can be further written as :    @xmath39    both eqs .",
    "( [ fo : rr5 ] ) and ( [ fo : rr6 ] ) are satisfied for arbitrary @xmath0 .",
    "this is very remarkable , because although the function @xmath40}$ ] is not equal to @xmath41 , when multiplied with the fermi - dirac kernel @xmath42 , it leads to exactly the same value of the definitive integrals as if it were equal to @xmath41 .",
    "another interesting behavior we observed from the generalized fd functions is the dependence on @xmath0 of the following ratio ( see fig .",
    "[ fig : cancel ] ) .",
    "@xmath43 + \\beta     [ \\partial f_{k+1 }   ( \\eta , \\beta ) / \\partial \\eta ] \\}^2 \\over     [ f_k ( \\eta , \\beta ) + \\beta f_{k+1 }   ( \\eta , \\beta ) ] \\ : \\ :     \\ { [ \\partial^2 f_k ( \\eta , \\beta ) / \\partial \\eta^2 ] + \\beta     [ \\partial^2 f_{k+1 }   ( \\eta , \\beta ) / \\partial \\eta^2 ] \\}\\ ] ]    the expression appears in the derivatives of number density or internal energy of the relativistic electron gas ( see @xcite for more detail ) .    for small degeneracy ( @xmath44 )",
    "the ratio ( [ fo : cancel ] ) is very close to 1 for all value of index @xmath13 ( @xmath45 ) and all @xmath46 .",
    "however , when the electron gas is extremely degenerate ( @xmath47 ) , the ratio ( [ fo : cancel ] ) approaches different limits for the non - relativistic and relativistic cases .",
    "for the non - relativistic case ( @xmath37 ) , the limits of ( [ fo : cancel ] ) are @xmath48 when @xmath49 , respectively .",
    "the general expression is @xmath50 for @xmath45 and @xmath51 .",
    "for the relativistic case ( @xmath52 ) the limits of ( [ fo : cancel ] ) are @xmath53 when @xmath54 , respectively .",
    "the general expression is @xmath55 ( @xmath45 ) .",
    "this result is true for @xmath56 .",
    "so for a given small @xmath1 ( @xmath52 ) , that is , in the nearly non - relativistic case , for sufficiently large @xmath0 , the relativistic relation is satisfied , as shown in fig .",
    "( [ fig : cancel ] ) . this property links the behavior of the generalized fd functions of both extreme cases ( very small degeneracy or extremely great degeneracy ) . in appendix ( [ ap : cancel ] ) we will give a proof of this property using asymptotic expansions .",
    "one thing we want to point out is that , because the ratio of eq .",
    "( [ fo : cancel ] ) is very close to unity when @xmath0 is small , one has to be cautious when evaluating the difference between the nominator and denominator for the case of a slightly degenerate electron gas in order to avoid numerical noise due to near cancellation .",
    "we choose the scheme proposed by @xcite to calculate derivatives of the generalized fd functions , because this method is fast , accurate and transparent .",
    "the expressions for the derivatives are listed in appendix ( [ derivative ] ) . in the method",
    "adopted , the integration is further split into four domains .",
    "gauss - legendre quadratures are applied to the first three pieces , starting from @xmath25 to a preselected point @xmath57 , as defined in appendix ( [ bps ] ) . in the last part , where @xmath58 is from @xmath57 to @xmath59 the @xmath2 term dominates , and hence gauss - laguerre quadrature is used .",
    "the positions of the break points are optimized such that the combined errors from all the pieces contributing to the generalized fd functions are minimized and equally distributed among the pieces .",
    "fortunately , the choice of break points turns out rather uncritical for each individual derivative [ see also @xcite ] .",
    "as shown in appendix ( [ derivative ] ) , the integrand of each derivative can be represented as a product of the generalized fd kernel @xmath60/{(\\e^{x-\\eta } + 1)}$ ] with a tuning function .",
    "when @xmath0 and @xmath1 are not very large , this tuning function varies mildly [ see fig .",
    "( [ fig : tf ] ) ] .",
    "hence the same break points chosen for the generalized fd functions themselves can also be applied to their derivatives , and good accuracy is achieved . however ,",
    "when @xmath0 and @xmath1 are getting large , new break points must be chosen .",
    "the @xmath1 derivatives are not very sensitive to the choice of break points .",
    "therefore , we provide new break points only for @xmath0 derivatives .",
    "formulae to calculate break points can be found in appendix ( [ bps ] ) .",
    "one concern in the calculation of the generalized fd functions and their derivatives is how one determines the accuracy of the results . for the generalized fd functions we compare the results of @xcite ( the method adopted in the present paper ) with those of @xcite evaluated in double precision .",
    "we find that they agree with each other to 14-digit accuracy for @xmath0 up to 1000 , and to 10-digit accuracy for @xmath0 up to 10000 .",
    "additionally , both of them agree with @xcite to 8-to-10-digit accuracy for @xmath0 up to 1000 .    for the derivatives of the generalized fd functions , we first test them using the different recursion relations available .",
    "except for the aforementioned cancellations when @xmath0 is small , the recursion relations are satisfied with better than 10-digit accuracy , for all derivatives with @xmath1 being between @xmath61 and @xmath62 and @xmath0 between -100 and 10000 .",
    "the only exception is the third - order derivative with respect to @xmath0 . here",
    ", the same accuracy can only be achieved for @xmath0 less than 500 .",
    "all of the above results refer to double precision ( 128 bits ) ( which is single precision on a cray ) .",
    "of course , better results can be achieved with quadruple precision . in practice ,",
    "if @xmath63 , the recursion relations can be used to convert the third - order @xmath0 derivative into a lower - order one when @xmath0 is big , and in this way , very accurate results can be achieved .    as a second test",
    ", we compare our directly evaluated derivatives with those obtained from numerical differentiation .",
    "for example , we compare @xmath64 from our method with @xmath65 / 2\\ : \\delta \\eta}$ ] , with the difference @xmath66 chosen to be @xmath67 , @xmath68 , @xmath61 , @xmath69 , respectively , and the calculation is done in double precision .",
    "the purpose of the test is ( i ) to test the accuracy of our method , and ( ii ) to find the dependence of @xmath66 as a function of accuracy .",
    "we conclude that both methods agree well . in practice",
    ", a step of @xmath66 or @xmath70 between @xmath67 and @xmath68 is an optimal choice to compute the derivatives of the generalized fd functions by numerical differentiation .",
    "for example , the numerical evaluation of the second - order derivative with respect to @xmath0 from the first - order derivative yields an accuracy of at least 8 digits in double precision .",
    "however , we would like to stress that our direct evaluations are superior to the numerical differentiation used here only for testing purposes .",
    "the accuracy of numerical differentiation can drop to half of the machine precision [ _ i.e. _ to 8 to 9 digits , compared to the 16 digit accuracy of double precision ( non - cray machines ) or single precision ( cray machines ) ] when the aforementioned 3-point numerical differentiation is applied once .",
    "applied twice , the resulting accuracy can drop to 3 to 5 digits for @xmath71 , and only 2 digits when @xmath72 .",
    "applied three times , the resulting accuracy would only be 2 digits when @xmath73 , and for higher @xmath0 values , the results would be completely useless .",
    "this demonstrates the well - known fact that numerical differentiation is a dangerous procedure if it is used beyond first - order derivatives .",
    "in addition , the step size to be used has to be chosen judiciously . for high - precision applications such as found in helioseismology , which requires precise second- and third - order thermodynamic quantities ,",
    "the direct approach method presented in this paper is by far superior to more - than - one - time numerical differentiations .    in this paper",
    "we have always used 200-point gauss quadratures . although fewer - points quadratures are also good for the calculations of the generalized fd functions @xcite , the 200-point gauss quadratures used here guarantee the accuracy of the high - order derivatives . if computing speed is important , and third - order @xmath0-derivatives are not needed , then the 40-to-80-point gauss quadratures in @xcite are a good choice .    to use the program accompanying this paper ,",
    "the user has first to compile and link the three fortran files .",
    "then , upon choosing the index of the requested generalized fd function @xmath13 , the label @xmath74 denoting either the function itself or a specified derivative ( see table [ tb : index ] ) , the range of degeneracy @xmath0 and dimensionless temperature @xmath1 , the program then calculates the desired generalized fd function or derivative .",
    "a sample input is given in the file _ input _ , and the corresponding results are contained in the file",
    "although the present numerical method to evaluate generalized fd functions is accurate within a very large range of input parameters @xmath0 and @xmath1 , analytic approximations still have advantages for theoretical studies and the understanding of the underlying physics",
    ". however , since analytic approximations are usually only valid for restricted parameter regions , we must know them for each of them . in the following ,",
    "we limit ourselves to the properties of the @xmath75 functions only if its behavior is representative for the other cases . otherwise , we discuss the cases of index @xmath75 and @xmath76 .",
    "first we check the accuracy of the non - relativistic ( nr ) fd function as an approximation to the generalized fd functions in the weakly non - relativistic case ( @xmath77 )    @xmath78    from fig .",
    "[ fig : nr ] , we can see that when both @xmath0 and @xmath1 are small the approximation is good to 6 digits , and the accuracy drops when either @xmath0 or @xmath1 is getting big .",
    "considerably better agreement ( twice as many accurate digits , as shown in fig .",
    "[ fig : nr1 ] ) can be reached by including one more term is @xcite :    @xmath79    for the ultra - relativistic case ( @xmath80 ) @xcite , results of the following approximation is shown in fig .",
    "[ fig : er ] :    @xmath81\\ ] ]    the figure shows that more than 6-digit accuracy can be obtained with this formula if @xmath82 , and @xmath0 is not too small , typically @xmath83 , and more than 10-digit accuracy when @xmath84 .    when @xmath85 we can see that the asymptotic expansions by pichon @xcite [ see appendix c.1 , eq .",
    "( c1-c11 ) ; also cox & giuli @xcite ] are very good for @xmath86 ( fig .",
    "[ fig : ed12 ] ) , with better than 12-digit accuracy when @xmath87 .",
    "however , the results are only moderate for @xmath88 ( fig . [",
    "fig : ed32 ] ) and @xmath89 , in which case the accuracy is only better than 6 digits when @xmath90 , and much less accurate when @xmath0 is smaller . for convenience",
    ", we list the formulae for large and small @xmath0 in appendix ( [ asymp ] ) .    when @xmath0 is small , the expression of the generalized fd functions in terms of modified bessel functions [ see appendix c.2 , eq .",
    "( c12-c17 ) ; cox & giuli @xcite ] achieve very high accuracy .",
    "we have used mathematica 4.0 ( for solaris ) to evaluate the modified bessel functions in double precision . since the leading terms in eq .",
    "( [ fo : sd1 ] ) - ( [ fo : sd3 ] ) are comparable when @xmath1 is small , cancellation effect would appear .",
    "a power series expansion expression @xcite is therefore more appropriate .",
    "we have combined the methods and show their results in fig .",
    "[ fig : nd ] .",
    "we have also checked the quality of the fitting formulae by @xcite [ see appendix c.3 , eq .",
    "( c21-c26 ) ] ( fig .",
    "[ fig : egg ] ) .",
    "specifically , we have adopted the expression given by @xcite ( his eq .",
    "5a - 5c ) .",
    "these fitting formulae cover a much larger range of @xmath0 and @xmath1 than those asymptotic formulae above ( but with lower accuracy ) , and they are adequate if accuracy is not critical , and temperature not too high .",
    "for instance , with these fitting formulae we can obtain 4-digit accuracy when @xmath91 and @xmath92 , and 2-digit accuracy when @xmath93 and @xmath94 .",
    "in this paper we have investigated properties of the generalized fd functions in some detail , and we have found some useful new recursion relations . we propose an accurate and relatively fast numerical method to evaluate the derivatives of the generalized fd functions , following the algorithm introduced by @xcite",
    ". limitations of direct numerical differentiation are also discussed .",
    "finally , we have obtained the range of validity of some popular analytic approximations for the generalized fd functions .",
    "zg would like to thank a. natarajan and n. mohabkumar for providing us with their code to evaluate generalized fd functions , and a. nayfonov for useful discussions .",
    "zg , lz and wd are supported in part by the nsf grant ast-9618549 and ast-9987391 .",
    "derivatives of the generalized fd functions up to third order with respect to @xmath0 and @xmath1 .",
    "@xmath95    @xmath96    @xmath97    @xmath98    @xmath99    @xmath100    @xmath101    @xmath102    @xmath103",
    "three break points @xmath104 are [ as shown in @xcite ] : @xmath105 where @xmath106                   fig .  3 : effective range of non - relativistic approximation for @xmath86 from eq . ( [ fo : nr ] ) .",
    "@xmath114 axis is the logarithm of relative difference @xmath115 ; the same notation for figs .",
    "( [ fig : nr1 ] ) to ( [ fig : egg ] ) ."
  ],
  "abstract_text": [
    "<S> the generalized fermi - dirac functions and their derivatives are important in evaluating the thermodynamic quantities of partially degenerate electrons in hot dense stellar plasmas . </S>",
    "<S> new recursion relations of the generalized fermi - dirac functions have been found . </S>",
    "<S> an effective numerical method to evaluate the derivatives of the generalized fermi - dirac functions up to third order with respect to both degeneracy and temperature is then proposed , following aparicio @xcite . a fortran program based on this method , together with a sample test case , </S>",
    "<S> is provided . </S>",
    "<S> accuracy and domain of reliability of some other , popularly used analytic approximations of the generalized fermi - dirac functions for extreme conditions are investigated and compared with our results .    </S>",
    "<S> fermi - dirac functions : equation of state : electron gas : numerical method    * program summary *    _ title of program : _ gfd_d3    _ catalogue identifier : _ ? ? ? ? </S>",
    "<S> _ program summary url : _ </S>",
    "<S> http://www.cpc.cs.qub.ac.uk/summaries/ ? </S>",
    "<S> ? ? </S>",
    "<S> _ program obtainable from : _ cpc program library , queen s university of belfast , n. ireland    _ licensing provisions : _ none    _ computers : _ </S>",
    "<S> sun e4500/e5500 , compaq dec alpha , sgi origin2000 , hp convex exemplar , cray sv1 - 1a/16 - 8 , amd k6 pc , ibm sp2    _ operating systems under which the program has been tested : _ solaris 5.6 , linux ( red hat 5.2 ) , irix 64 , spp - ux 5.3 , unicos 10.0.0.6 , microsoft windows 98 ( 2nd ed . ) , aix 4.2    _ programming language : _ fortran 77    _ number of bytes in distributed program , including test data , etc . : _ </S>",
    "<S> 20758    _ distribution format : _ uuencoded ( gzip ) compressed tar file    _ keywords : _ fermi - dirac functions , equation of state : electron gas , numeric method , astrophysics plasma , stellar evolution    _ nature of physical problem + _ provide numerical method to evaluate generalized fermi - dirac functions and their derivatives with respect to @xmath0 and @xmath1 up to third order . </S>",
    "<S> the results are important for a highly accurate calculation of thermodynamic quantities of an electron gas with partial degeneracy and relatively high temperatures with very high order of accuracy .    </S>",
    "<S> _ method of solution + _ following the scheme proposed by aparicio @xcite , the generalized fermi - dirac integration is split into four optimized regions . </S>",
    "<S> gauss - legendre quadrature is used in the first three pieces , and gauss - laguerre quadrature in the last part when the @xmath2 term in the integrand dominates . </S>",
    "<S> different break points are individually chosen for each @xmath0 derivative .    _ typical running time + _ less than 1 ms for each data point on a dec alpha station with a 533 mhz cpu in double precision .    * long write - up * </S>"
  ]
}