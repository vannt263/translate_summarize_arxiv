{
  "article_text": [
    "the free energy landscapes of complex many - body systems with competing phases or interactions are often characterized by many local minima that are separated by entropic barriers .",
    "the simulation of such systems with conventional monte carlo @xcite or molecular dynamics @xcite methods is slowed down by long relaxation times due to the suppressed tunneling through these barriers .",
    "while at second order phase transitions this slow - down can be overcome by improved updating techniques , such as cluster updates @xcite , this is not the case for systems which undergo a first - order phase transition or for systems that exhibit frustration or disorder . for these systems",
    "one instead aims at improving the way that relatively simple , local updates are accepted or rejected in the sampling process by introducing artificial statistical ensembles such that tunneling times through barriers are reduced and autocorrelation effects minimized . in the following we discuss recently developed techniques to find statistical ensembles that optimize the performance of monte carlo sampling , first in the context of broad - histogram monte carlo algorithms and then outline how these methods can be applied in the context of replica - exchange or parallel - tempering algorithms .",
    "let us consider a first - order phase transition , such as in a two - dimensional @xmath0-state potts model @xcite with a hamiltonian @xmath1 where the spins @xmath2 can take the integer values @xmath3 . for @xmath4",
    "this model exhibits a first - order phase transition , accompanied by exponential slowing down of conventional local - update algorithms . the exponential slow - down",
    "is caused by the free - energy barrier between the two coexisting meta - stable states at the first - order phase transition .",
    "this barrier can be quantified by considering the energy histogram @xmath5 which is the probability of encountering a configuration with energy @xmath6 during the monte carlo simulation .",
    "the density of states is given by @xmath7 where the sum runs over all configurations @xmath8 .",
    "away from first - order phase transitions , @xmath9 has approximately gaussian shape , centered around the mean energy . at first - order phase transitions , where the energy jumps discontinuously , the histogram @xmath9 develops a double - peak structure .",
    "the minimum of @xmath9 between these two peaks , which the simulation has to cross in order to go from one phase to the other , becomes exponentially small upon increasing the system size .",
    "this leads to exponentially large tunneling and autocorrelation times .",
    "this tunneling problem at first - order phase transitions can be aleviated by extended ensemble techniques which aim at broadening the sampled energy space . instead of weighting a configuration @xmath8 with energy @xmath10 using the boltzmann weight @xmath11 more general weights",
    "@xmath12 are introduced which define the extended ensemble .",
    "the configuration space is explored by generating a markov chain of configurations @xmath13 where a move from configuration @xmath14 to @xmath15 is accepted with probability @xmath16 = \\min \\left [ 1,\\frac{w_{\\rm extended}(e_2)}{w_{\\rm extended}(e_1 ) } \\right ] \\;.\\ ] ] in general , the extended weights are defined in a single coordinate , such as the energy , thereby projecting the random walk in configuration space to a random walk in energy space @xmath17 for this random walk in energy space a histogram can be recorded which has the characteristic form @xmath18 where the density of states @xmath19 is fixed for the simulated system .    one choice of generalized weights is the multicanonical ensemble @xcite where the weight of a configuration @xmath8 is defined as @xmath20 .",
    "the multicanonical ensemble then leads to a flat histogram in energy space @xmath21 removing the exponentially small minimum in the canonical distribution . after performing a simulation , measurements in the multicanonical ensemble are reweighted by a factor @xmath22 to obtain averages in the canonical ensemble .    since the density of states and thus the multicanonical weights are not known initially , a scalable algorithm to estimate these quantities is needed .",
    "the wang - landau algorithm @xcite is a simple but efficient iterative method to obtain good approximates of the density of states @xmath19 and the multicanonical weights @xmath23 .",
    "besides overcoming the exponentially suppressed tunneling problem at first - order phase transitions , the wang - landau algorithm calculates the generalized density of states @xmath19 in an iterative procedure .",
    "the knowledge of the density of states @xmath19 then allows the direct calculation of the free energy from the partition function , @xmath24 .",
    "the internal energy , entropy , specific heat and other thermal properties are easily obtained as well , by differentiating the free energy . by additionally measuring the averages @xmath25 of other observables @xmath26 as a function of the energy @xmath6",
    ", thermal expectation values can be obtained at arbitrary inverse temperatures @xmath27 by performing just a single simulation : @xmath28",
    "the multicanonical ensemble and wang - landau algorithm both project a random walk in high - dimensional configuration space to a one - dimensional random walk in energy space where all energy levels are sampled equally often .",
    "it is important to note that the random walk in configuration space , equation  ( [ eq : crw ] ) , is a biased markovian random walk , while the projected random walk in energy space , equation  ( [ eq : erw ] ) , is non - markovian , as memory is stored in the configuration .",
    "this becomes evident as the system approaches a phase transition in the random walk : while the energy no longer reflects from which side the phase transition is approached , the current configuration may still reflect the actual phase the system has visited most recently . in the case of the ferromagnetic ising model , the order parameter for a given configuration at the critical energy @xmath29 ( in two space dimensions ) will reveal whether the system is approaching the transition from the magnetically ordered ( lower energies ) or disordered side ( higher energies ) .",
    "this loss of information in the projection of the random walk in configuration space has important consequences for the random walk in energy space .",
    "most strikingly , the local diffusivity of a random walker in energy space , which for a diffusion time @xmath30 is defined as @xmath31 is _ not _ independent of the location in energy space .",
    "this is illustrated in fig .",
    "[ fig : diffusivity ] for the two - dimensional ising ferromagnet . below the phase transition around @xmath32",
    "a clear minimum evolves in the local diffusivity . in this region",
    "large ordered domains are formed and by moving the domain boundaries through local spin flips only small energy changes are induced resulting in a suppressed local diffusivity in energy space .    because of the strong energy dependence of the local diffusivity the simulation of a multicanonical ensemble sampling all energy levels equally often turns out to be suboptimal @xcite .",
    "the performance of flat - histogram algorithms can be quantified for classical spin models such as the ferromagnet where the number of energy levels is given by @xmath33 $ ] and thereby scales with the number of spins @xmath34 in the system . when measuring the typical round - trip time between the two extremal energies for multicanonical simulations , these round - trip times @xmath35 are found to scale like @xmath36 showing a power - law deviation from the @xmath37-scaling behavior of a completely unbiased random walk . here",
    "@xmath38 is the linear system size and @xmath39 a critical exponent describing the slow - down of a multicanonical simulation in the proximity of a phase transition @xcite .",
    "the value of @xmath39 strongly depends on the simulated model and the dimensionality of the problem . in two dimensions the exponent increases from @xmath40 for the ferromagnet as one introduces competing interactions leading to frustration and disorder .",
    "the exponent becomes @xmath41 for the two - dimensional fully frustrated ising model which is defined by a hamiltonian @xmath42 where the spins around any given plaquette of four spins are frustrated , e.g. by choosing the couplings along three bonds to be @xmath43 ( ferromagnetic ) and @xmath44 ( antiferromagnetic ) for the remaining bond . for the spin glass , where the couplings @xmath45 are randomly chosen to be + 1 or -1 , exponential scaling ( @xmath46 ) is found @xcite .",
    "increasing the spatial dimension of the ferromagnet the exponent is found to decrease as @xmath47 and @xmath48 for dimension @xmath49 and 3 and @xmath39 vanishes for the mean - field model in the limit of infinite dimensions @xcite .",
    "the observed polynomial slow - down of the multicanonical ensemble poses the question whether for a given model there is an optimal choice of the histogram @xmath50 and corresponding weights @xmath51 , which eliminates the slow - down . to address this question an adaptive feedback algorithm has recently been introduced that iteratively improves the weights in an extended ensemble simulation leading to further improvements in the efficiency of the algorithm by several orders of magnitude @xcite",
    "the scaling for the optimized ensemble is found to scale like @xmath52 ^ 2)$ ] thereby reproducing the behavior of an unbiased markovian random walk up to a logarithmic correction .    at the heart of the algorithm",
    "lies the idea to maximize a current @xmath53 of walkers that move from the lowest energy level , @xmath54 , to the highest energy level , @xmath55 , or vice versa , in an extended ensemble simulation by varying the weights @xmath56 . to measure the current a label",
    "is added to the walker that indicates which of the two extremal energies the walker has visited most recently .",
    "the two extrema act as `` reflecting '' and  absorbing \" boundaries for the labeled walker : e.g. , if the label is plus , a visit to @xmath55 does not change the label , so this is a `` reflecting '' boundary .",
    "however , a visit to @xmath54 does change the label , so the plus walker is absorbed at that boundary .",
    "the behavior of the labeled walker is _ not _ affected by its label except when it visits one of the extrema and the label changes .    for the random walk in energy space ,",
    "two histograms are recorded , @xmath57 and @xmath58 , which for sufficiently long simulations converge to steady - state distributions which satisfy @xmath59 . for each energy level",
    "the fraction of random walkers which have label  plus \" is then given by @xmath60 .",
    "the above - discussed boundary conditions dictate @xmath61 and @xmath62 .",
    "the steady - state current to first - order in the derivative is @xmath63 where @xmath64 is the walker s diffusivity at energy @xmath6 .",
    "there is no current if @xmath65 is constant , since this corresponds to the equilibrium state .",
    "therefore the current is to leading order proportional to @xmath66 . rearranging the above equation and integrating on both sides , noting that @xmath53 is a constant and @xmath67 runs from 0 to 1 , one obtains @xmath68 to maximize the current and thus the round - trip rate , this integral",
    "must be minimized .",
    "however , there is a constraint : @xmath69 is a probability distribution and must remain normalized which can be enforced with a lagrange multiplier : @xmath70 to minimize this integrand , the ensemble , that is the weights @xmath71 and thus the histogram @xmath69 are varied .",
    "at this point it is assumed that the dependence of @xmath64 on the weights can be neglected .",
    "the optimal histogram , @xmath50 , which minimizes the above integrand and thereby maximizes the current @xmath53 is then found to be @xmath72 thus for the optimal ensemble , the probability distribution of sampled energy levels is simply inversely proportional to the square root of the local diffusivity .",
    "the optimal histogram can be approximated in a feedback loop of the form    * start with some trial weights @xmath71 , e.g. @xmath73 .",
    "* repeat * * reset the histograms @xmath74 . * * simulate the system with the current weights for @xmath34 sweeps : * * * updates are accepted with probablity @xmath75 $ ] . * * * record the histograms @xmath57 and @xmath58 . * * from the recorded histogram an estimate of the local diffusivity is obtained as @xmath76 where the fraction @xmath65 is given by @xmath60 and @xmath69 is the histogram @xmath77 . * * define new weights as @xmath78 * * increase the number of sweeps for the next iteration + @xmath79 .",
    "* stop once the histogram @xmath69 has converged .",
    "the implementation of this feedback algorithm requires to change only a few lines of code in the original local - update algorithm for the ising model .",
    "some additional remarks are useful :    1 .",
    "in contrast to the wang - landau algorithm , the weights @xmath71 are modified only after a batch of @xmath80 sweeps , thereby ensuring detailed balance between successive moves at all times .",
    "the initial value of sweeps @xmath80 should be chosen large enough that a couple of round trips are recorded , thereby ensuring that steady state data for @xmath57 and @xmath58 are measured .",
    "3 .   the derivative @xmath66 can be determined by a linear regression , where the number of regression points is flexible .",
    "initial batches with the limited statistics of only a few round trips may require a larger number of regression points than subsequent batches with smaller round - trip times and better statistics .",
    "similar to the multicanonical ensemble , the weights @xmath71 can become very large and storing the logaritms may be advantageous .",
    "the reweighting then becomes @xmath81/2 $ ]  .    at the end of the simulation",
    ", the density of states can be estimated from the recorded histogram as @xmath82 and normalized as described above .",
    "[ fig : histogram ] shows the optimized histogram for the two - dimensional ferromagnetic ising model .",
    "the optimized histogram is no longer flat , but a peak evolves at the critical region around @xmath83 of the transition .",
    "the feedback of the local diffusivity reallocates resources towards the bottlenecks of the simulation which have been identified by a suppressed local diffusivity .    when analyzing the scaling of round - trip times for the optimized ensemble one finds a considerable speedup : the power - law slow - down of round - trip times for the flat - histogram ensemble @xmath84 is reduced to @xmath52 ^ 2)$ ] for the optimized ensemble , e.g. there is only a logarithmic correction to the scaling of a completely unbiased random walk with @xmath85-scaling .",
    "for the two - dimensional fully frustrated ising model the scaling of round - trip times is shown in fig .",
    "[ fig : scaling ] . this scaling improvement results in a speedup by a nearly two orders of magnitude already for a system with some @xmath86 spins .",
    "extended ensembles can not only be defined as a function of energy , but in arbitrary reaction coordinates @xmath87 onto which a random walk in configuration space can be projected .",
    "the generalized weights in these reaction coordinates @xmath88 are then used to bias the random walk along the reaction coordinate by accepting moves from a configuration @xmath14 with reaction coordinate @xmath89 to a configuration @xmath15 with reaction coordinate @xmath90 with probability @xmath91 the generalized weights @xmath88 can again be chosen in such a way that similar to a multicanonical simulation a flat histogram is sampled along the reaction coordinate by setting the weights to be inversely proportional to the density of states defined in the reaction coordinates , that is @xmath92 .",
    "an optimal choice of weights can be found by measuring the local diffusivity of a random walk along the reaction coordinates and by applying the feedback method to shift weight towards the bottlenecks in the simulation .",
    "this generalized ensemble optimization approach has recently been illustrated for the simulation of dense lennard - jones fluids close to the vapor - liquid equilibrium @xcite .",
    "the interaction between particles in the fluid is described by a pairwise lennard - jones potential of the form @xmath93 \\ ; ,     \\label{eq : lj}\\ ] ] where @xmath94 is the interaction strength , @xmath95 a length parameter , and @xmath96 the distance between two particles .",
    "it is this distance @xmath96 between two arbitrarily chosen particles in the fluid that one can use as a new reaction coordinate for a projected random walk . for a given temperature defining an extended ensemble with weights @xmath97 and recording a histogram @xmath98 during a simulation will then allow to calculate the pair distribution function @xmath99 .",
    "the pair distribution function @xmath100 is closely related to the potential of mean force ( pmf ) @xmath101 which describes the average interaction between two particles in the fluid in the presence of many surrounding particles .    for high particle densities and low enough temperatures shell structures",
    "form in the fluid which are reminiscent of the hexagonal lattice of the solid structure at very low temperatures .",
    "these shell structures are revealed by a sinusoidal modulation in the pmf .",
    "thermal equilibration between the shells is suppressed by entropic barriers which form between the shells .",
    "again , one can ask what probability distribution , or histogram , should be sampled along the reaction coordinate , in this case the radial distance @xmath96 , so that equilibration between the shells is improved . measuring the local diffusivity for a random walk along the radial distance @xmath96 in an interval",
    "@xmath102 $ ] and subsequently applying the feedback algorithm described above optimized histograms @xmath98 are found which are plotted in fig .",
    "[ fig : lj - histograms ] for varying temperatures @xcite .",
    "the feedback algorithm again shifts additional weight in the histogram towards the bottleneck of the simulation , in this case towards the barriers between the shells .",
    "interestingly , additional peaks emerge in the optimized histogram as the temperature is lowered towards the vapor - liquid equilibrium .",
    "the minima between these peaks point to additional meta - stable configurations which occur at these low temperatures , namely interstitial states which occur as the shells around two particles merge as detailed in ref .",
    "@xcite .",
    "this example illustrates that for some simulations the local diffusivity and optimized histogram _ themselves _ are very sensitive measures that can reveal interesting underlying physical phenomena which are otherwise hard to detect in a numerical simulation . in general",
    ", a strong modulation of the local diffusivity for the random walk along a given reaction coordinate is a good indicator that the reaction coordinate itself is a good choice that captures some interesting physics of the problem .",
    "the simulation of frustrated and/or disordered systems suffers from a similar tunneling problem than the simulation of first - order phase transitions : local minima in energy space are separated by barriers that grow with system size .",
    "while the multicanonical or optimized ensembles do not help with the np - hard problems faced by spin glasses , they are efficient in speeding up simulations of frustrated magnets without disorder @xcite .    an alternative to these extended ensembles for the simulation of frustrated magnets is the  parallel tempering \" or  replica - exchange \" monte carlo method @xcite . instead of performing a single simulation at a fixed temperature ,",
    "simulations are performed for @xmath103 replicas at a set of temperatures @xmath104 .",
    "in addition to standard monte carlo updates at a fixed temperature , exchange moves are proposed to swap two replicas between adjacent temperatures .",
    "these swaps are accepted with a probability @xmath105,\\ ] ] where @xmath106 is the difference in inverse temperatures and @xmath107 the difference in energy between the two replicas @xmath108 and @xmath53 .",
    "the effect of these exchange moves is that a replica can drift from a local free energy minimum at low temperatures to higher temperatures , where it is easier to cross energy barriers and equilibration is fast . upon cooling ( by another sequence of exchanges )",
    "it can end up in a different local minimum on time scales that are much shorter compared to a single simulation at a fixed low temperature .",
    "this random walk of a single replica in temperature space is the conjugate analog of the random walk in energy space discussed for the extended ensemble techniques .",
    "the complement of the statistical ensemble , defined by the weights @xmath56 , is the particular choice of temperature points in the temperature set @xmath109 for the parallel tempering simulation .",
    "the probability of sampling any given temperature @xmath110 in an interval @xmath111 can then be approximated by @xmath112 , where @xmath113 is the length of the temperature interval around the temperature @xmath110 .",
    "this probability distribution @xmath114 is the equivalent to the histogram @xmath69 in the extended ensemble simulations .",
    "the ensemble optimization technique discussed above can thus be reformulated to optimize the temperature set in a parallel - tempering simulation in such a way that the rate of round trips between the two extremal temperatures , @xmath115 and @xmath116 respectively , is maximized @xcite .    starting with an initial temperature set @xmath109",
    "a parallel tempering simulation is performed where each replica is labeled either  plus \" or  minus \" indicating which of the two extremal temperatures the respective replica has visited most recently .",
    "this allows to measure a current of replicas diffusing from the highest to the lowest temperature by recording two histograms , @xmath117 and @xmath118 for each temperature point .",
    "the current @xmath53 is then given by @xmath119 where @xmath120 is the local diffusivity for the random walk in temperature space , and @xmath121 $ ] is the fraction of random walkers which have visited the highest temperature @xmath116 most recently .",
    "the probability distribution @xmath114 is normalized , that is @xmath122 where @xmath123 is a normalization constant . rearranging equation ( [ eq : tcurrent ] ) the local diffusivity @xmath120 of the random walk in temperature space can be estimated as @xmath124 in analogy to the argument for the extended ensemble in energy space the current @xmath53 is maximized by choosing a probability distribution @xmath125 which is inversely proportional to the square root of the local diffusivity .",
    "the optimized temperature set @xmath126 is then found by choosing the @xmath127-th temperature point @xmath128 such that @xmath129 where @xmath103 is the number of temperature points in the original temperature set , and the two extremal temperatures @xmath130 and @xmath131 remain unchanged . similarly to the algorithm for the ensemble optimization this feedback of the local diffusivity should be iterated until the temperature set is converged .    figures [ fig : thistogram ] and [ fig : tsets ] illustrate the so - optimized temperature sets for the ising ferromagnet obtained by several iterations of the above feedback loop . after the feedback of the local diffusivity , temperature points accumulate near the critical temperature @xmath132 of the transition .",
    "this is in full analogy to the optimized histograms for the extended ensemble simulations where resources are shifted towards the critical energy of the transition , for comparison see figs .",
    "[ fig : histogram ] and [ fig : thistogram ] .",
    "it is interesting to note that for the so - optimized temperature set the acceptance rates for swap moves are not independent of the temperature @xcite . around the critical temperature , where temperature points are accumulated by the feedback algorithm ,",
    "the acceptance rates are higher than at higher / lower temperatures , where the density of temperature points becomes considerably smaller after feedback @xcite . the almost markovian scaling behavior for the optimized random walks in either energy or temperature space is thus generated by a problem - specific statistical ensemble which is characterized neither by a flat histogram nor flat acceptance rates for exchange moves , but by a characteristic probability distribution which concentrates resources at the minima of the measured local diffusivity .",
    "the ensemble optimization technique reviewed in this chapter should be broadly applicable to a wide range of applications  possibly speeding up existing uniform sampling techniques by orders of magnitude .",
    "it has recently been used to improve broad - histogram monte carlo techniques @xcite as well as parallel - tempering monte carlo simulations @xcite , with applications to frustrated and disordered spin systems @xcite , dense fluids @xcite , as well as folded proteins @xcite .",
    "it also holds promise to improve the simulation of quantum systems close to a phase transition when optimizing the extended ensemble introduced for the quantum wang - landau algorithm outlined in ref ."
  ],
  "abstract_text": [
    "<S> competing phases or interactions in complex many - particle systems can result in free energy barriers that strongly suppress thermal equilibration . here </S>",
    "<S> we discuss how extended ensemble monte carlo simulations can be used to study the equilibrium behavior of such systems . </S>",
    "<S> special focus will be given to a recently developed adaptive monte carlo technique that is capable to explore and overcome the entropic barriers which cause the slow - down . </S>",
    "<S> we discuss this technique in the context of broad - histogram monte carlo algorithms as well as its application to replica - exchange methods such as parallel tempering . </S>",
    "<S> we briefly discuss a number of examples including low - temperature states of magnetic systems with competing interactions and dense liquids . </S>"
  ]
}