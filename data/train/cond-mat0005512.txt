{
  "article_text": [
    "real - space methods have proven their utility in calculating the linear response of finite systems in time - dependent density functional theory@xcite .",
    "however , there has been the perception that real - space methods are unsuitable for infinite periodic systems .",
    "the problem is that the long range polarization currents are important but are dynamically independent of the local state of the electrons within the unit cell",
    ". stated differently , the polarization gives rise to a surface charge at the surface of any finite sample , but the resulting electric field is independent of the charge density within any cell in the interior .",
    "the necessity to introduce the polarization as an independent degree of freedom has been well recognized in the literature of the density functional theory@xcite .",
    "we will show here that in fact it is straightforward to treat infinite systems in the real - time formulation of tddft , simply by adding as one additional dynamic variable the surface charge .",
    "formally , this is conveniently done adding a gauge field in within a lagrangian",
    ". a gauge formalism has also been very recently applied by kootskra et al @xcite , however using a frequency representation rather than solving real - time equations . in our formulation , we derive the dynamic equations from the lagrangian : l = _ d^3r(_i |_i / i- e a z_i|^22 m + 18v(r)v(r ) + e n(r)v(r ) + e n_ion(r ) v(r ) + @xmath0 + { \\cal v}_{ion}[\\rho(r , r')]\\bigg ) -{\\omega\\over 8\\pi } \\left({d a \\over d t}\\right)^2-i\\int_\\omega d^3 r   \\sum_i\\phi_i^*{\\partial \\phi_i\\over \\partial t}.\\ ] ] here the @xmath1 are the bloch wave functions of the electrons , normalized so that @xmath2 is the electron density .",
    "the volume of the unit cell is @xmath3 .",
    "the electromagnetic interaction is separated into a coulomb field @xmath4 that satisfies periodic boundary conditions in the unit cell and a vector gauge field @xmath5 .",
    "note that the gauge field is uniform , without any dependence on @xmath6 . the electric field",
    "is then given by @xmath7 in these formal equations , we use units with @xmath8 .",
    "the other pieces of the first integral are the usual terms in the kohn - sham energy functional .",
    "the term @xmath9 gives the direct coulomb interaction of the electrons , except for the surface charging .",
    "the ionic interaction is separated then takes the ionic lattice into account automatically . ] into a long - range part that can be associated with an ionic charge density @xmath10 and a short - range part @xmath11 .",
    "the latter depends on the orbital angular momentum of the electrons in typical _ ab initio _ pseudopotentials .",
    "it therefore depends on the full one - electron density matrix @xmath12 .",
    "we have emphasized this point because nonlocal interactions do not respect gauge invariance .",
    "the invariance is of course restored if the density matrix is gauged .",
    "if one expresses the nonlocality in terms of the operator @xmath13 , one makes the replacement @xmath14 .",
    "finally , the @xmath15 is the usual exchange - correlation energy density of density functional theory .    requiring the lagrangian action to be stationary gives equations of motion for @xmath1 and @xmath16 and the poisson equation for @xmath17 .",
    "the dynamic equation for @xmath1 is the time - dependent kohn - sham equation , [ tdlda ] -^22 m_i -e m i a _ z _ i + e^22 m a^2 _ i + ( e v + _ ion n + _ xcn ) _",
    "i = it _ i the equation for @xmath16 is - em_i_i|_z / i |_i + e^2 m a n_e+ a _ _ ion d^3r = 0 where @xmath18 is the number of electrons per unit cell .",
    "the calculation of the dielectric function using the above real - time dynamic equations is very similar to the corresponding calculation of dynamic polarizability of finite systems@xcite .",
    "we first solve the static equations ( with @xmath16=0 ) to get the ground state electron orbitals and the periodic coulomb potential @xmath17 .",
    "the system is then perturbed by making a sudden change in @xmath16 , @xmath19 .",
    "this corresponds to applying a short - duration electric field at @xmath20 , @xmath21 .",
    "the dynamic equations are then applied to evolve the variables in time , finding the time evolution of the polarization electric field @xmath22 .",
    "the dielectric function @xmath23 is just the ratio of the fourier components of the external and the total fields ; it is given by [ epsilon ] 1 ( ) -1 = 1a_0 _ 0_+^ e^it - t d a(t)d t dt . here",
    "@xmath24 is a small quantity to establish the imaginary part of the response . in principle",
    "the resulting theory automatically respects the kramers - kronig relation .",
    "the linear energy - weighted sum rule is easily derived in this formalism .",
    "the sum rule may be expressed as _ 0^ ^-1 ( ) d= - 2 ^2 e^2 n_em . to calculate the sum rule with our lagrangian",
    ", we write the integral using eq .",
    "( 4 ) _ 0^ ^-1 ( ) d= 1a_0 _ 0^dt d a d t im_0^d e^it -t = 2 a_0 ( d^2 a d t^2 ) _ t=0_+ .",
    "the second derivative in the last expression can be easily found from eq .",
    "( 3 ) . at @xmath25 ,",
    "the wave functions have not yet had time to change , @xmath26 and @xmath27 .",
    "then if the last term in eq .",
    "( 3 ) can be neglected , = - 4 e^2 n_e a_0 m and eq .",
    "( 5 ) follows immediately .",
    "thus the time - dependent treatment satisfies the sum rules automatically to the extent permitted by the last term .",
    "that term is only nonzero for nonlocal pseudopotentials , and in fact it may improve the accuracy of the theory by incorporating effects of the core electrons on the dynamic properties@xcite .",
    "let us now see how the gauge field treatment works in a simple analytically solvable model , namely the electron gas . as mentioned before , when the field @xmath28 is applied , there is no immediate response to the operator @xmath13 , since the wave function does not change instantaneously .",
    "however , in the fermi gas , the single - particle states are eigenstates of momentum so the response remains @xmath29 for all time . putting this in eq .",
    "( 3 ) , and dropping the pseudopotential term , the equation for @xmath16 becomes simple harmonic motion , with the solution a(t ) = a_0 _ pl t where @xmath30 is the plasmon frequency , _",
    "pl^2 = 4 e^2 n_e m = 4 e^2 n m. the dielectric function may now be calculated from the time integral eq .",
    "one obtains the familiar electron gas result , ( ) = 1 -_pl^2 ^ 2 .",
    "one sees that the derivation here is much simpler than the usual one using the coulomb gauge .",
    "there one formulates the response in a particle - hole representation , and takes the external field to be of the form @xmath31 with @xmath32 finite . the dielectric function",
    "is then found by taking the @xmath33 limit .",
    "we can make another simple model for the opposite extreme of a tightly bound electron in the unit cell .",
    "assume that the ion potential @xmath34 can be approximated by a harmonic oscillator potential in the region over which the electron wave function is appreciable .",
    "according to kohn s theorem@xcite , the response is just the same as for an isolated electron in the same ionic potential .",
    "this comes out of eq .",
    "( 2 - 3 ) in the following way .",
    "the initial impulse @xmath28 starts the electron moving , and as a result both @xmath35 and @xmath36 become time - dependent .",
    "together with the changing @xmath16 , the electron in the unit cell drags its self - induced field with it , and the accelerations associated with these three terms in eq .",
    "( 2 ) exactly cancel .",
    "the remaining ionic terms then produce simple harmonic motion for @xmath37 .",
    "the computational algorithm we employ is identical to the ones we used for clusters and molecules , which was based on a method introduced in nuclear physics@xcite .",
    "the kohn - sham operator is represented on a real space grid as in ref .",
    "there are a number of technical details associated with the periodicity and with the gauge potential that did not arise for the finite - system calculations . in the new code",
    ", the potential @xmath35 is calculated by fourier transformation of the poisson equation rather than a relaxation method .",
    "this gives automatically the required periodicity to @xmath35 .",
    "the wave functions @xmath1 represent bloch states of the periodic lattice , and they are constructed with the corresponding periodic boundary conditions labeled by the bloch momenta @xmath38 .",
    "the periodic boundary condition on the bloch wave function @xmath39 is easily implemented in the relaxation method used to find eigenstates . in practice , many bloch states are needed to obtain smooth dielectric functions . however , constructing the states takes much less time than for the same number of electrons in a finite system , because the bloch states in a given band are automatically orthogonal .",
    "we use here the same energy density functional that we used previously for finite systems . only the valence electrons are included explicitly ; core electrons are treated by a pseudopotential@xcite .",
    "the exchange - correlation energy of the electrons is calculated in the local density approximation following the prescription of ref .",
    "@xcite .",
    "the presence of a vector gauge potential requires a modification in the pseudopotential calculation , as indicated in the introduction .",
    "in particular , the @xmath16-dependence of the @xmath11 term in eq .",
    "( 2 ) must be consistent with the last term in eq .",
    "( 3 ) in order to have the algorithm conserve energy .",
    "we implement the @xmath16-dependence of @xmath11 simply by gauging the density matrix directly , @xmath40 as in the finite systems calculations , energy is conserved to a very high accuracy with the algorithm @xcite , provided the time step is less than the inverse energy span of the kohn - sham operator .",
    "in this section we demonstrate the feasibility of the method with lithium as an example of a simple metal . as other alkali metals , lithium has a fermi surface which is nearly spherical .",
    "however , unlike sodium and potassium , the effective mass of the electrons at the fermi surface is significantly enhanced over the free - fermi gas value ( @xmath41 ) .",
    "the kohn - sham operator is represented in coordinate space with a uniform spatial mesh .",
    "the lattice spacing of the bcc unit cell of li metal is @xmath42   , and we take a mesh spacing of @xmath43 to subdivide the cell into a @xmath44 lattice of mesh points .",
    "we use a time step of @xmath45 ev@xmath46 which is sufficient to conserve energy to 10@xmath47 ev over the time integration interval , @xmath48 ev@xmath46 .",
    "we sample the occupied states with a uniform mesh in momentum space . with a finite set of occupied orbitals ,",
    "the allowed excitation energies will be discrete , and the metallic behavior , @xmath49 , is only reached in the limit of an infinitely dense momentum space lattice .",
    "however , it is our view that the tdlda loses validity at long times when other degrees of freedom can be excited .",
    "this is the case for the low frequency response of metals , where the imaginary part of the dielectric responses is dominated by phonons and inelastic electron scattering .    in fig .  1 we show the normalized time - dependent polarization field , @xmath50 over the time interval @xmath51 $ ] ev@xmath46 .",
    "the inset shows an expanded view of the initial response in the interval [ 0,1 ] ev@xmath46 .",
    "the dashed line is the comparison with the linear behavior deduced from the sum rule , @xmath52 .",
    "the agreement shows that the local sum rule in nearly satisfied , despite the fairly large optical effective mass .    in fig .",
    "2 we show the inverse dielectric function computed from eq .",
    "( 4 ) for various meshes in the brillouin zone .",
    "we employ @xmath53 ev to smooth the response in the fourier transformation .",
    "we see that the response becomes smoother , the more finely the fermi sea is sampled . with a @xmath54 lattice of bloch states , we get results smooth enough to be compared with measurement .    in fig .",
    "3 we show the real and imaginary parts of the inverse dielectric function in the frequency interval @xmath55 ev/@xmath56 .",
    "the dashed lines show the empirical function from ref .",
    "there is also another theoretical calculation in the literature , @xcite .",
    "the agreement is quite good , especially considering that the calculation is _ ab initio _ with a energy density functional that much simpler than more recent ones .",
    "the main feature in the absorptive response is the plasmon at 7 ev and its width .",
    "the peak position is significantly downshift from the naive plasmon frequency , @xmath57 ev . the width is associated with interband transitions and is also well reproduced .",
    "in this section we compute the dielectric response of a typical elemental insulator , diamond . the diamond lattice is represented in our calculation by the primitive unit cell which contains 8 carbon atoms .",
    "the four valence electrons of each carbon are calculated explicitly while the core electrons are only treated implicitly by the pseudopotential .",
    "we found in earlier studies of carbon structures that the kohn - sham hamiltonian requires a mesh spacing @xmath58    to get orbital energies to an accuracy of 0.1 ev ; in the calculation here we take a @xmath59 lattice in the unit cell which implies @xmath60   . with a smaller mesh spacing than for lithium , the span",
    "the kohn - sham operator is increased and the time step @xmath61 must be reduced accordingly .",
    "we use here @xmath62 ev@xmath46 .    with a cubical unit cell and 8 carbon atoms ,",
    "there are @xmath63 occupied bands . in each band",
    "we take a lattice of up to @xmath64 points to represent the bloch states .    for an insulator ,",
    "a reference point of the vector potential @xmath65 should be irrelevant .",
    "since all the points within brillouin zone are occupied , there is a static solution of eq.(2 - 3 ) for each constant vector potential .",
    "however , in our real - space , real - time calculation , we found this is violated due to the discrete representation in coordinate and momentum spaces .",
    "the total energy does depend on @xmath16 , and there appears a spurious low frequency mode in the vector potential @xmath65 associated with the adiabatic evolution of the electronic wave function .",
    "below that frequency , a spurious conduction feature appears in the response .",
    "these features are shown in the plots of the response in fig .",
    "we see that the spurious adiabatic evolution gives an unphysical plasmon at @xmath66 ev , which dominates the dielectric response at lower frequencies .",
    "though the amount of strength associated with this spurious plasmon is very small , 0.007 electrons out of the total of 32 , it has a qualitative effect on the response at very low frequency .",
    "the frequency and strength decrease the finer the spatial mesh , showing that it is an artifact of the discrete mesh representation of the coordinate space .    to infer the dielectric function near @xmath67",
    ", we apply the kramers - kronig relation to the imaginary part of the response , but excluding the spurious plasmon peak .",
    "this gives the predicted dielectric function shown in fig .",
    "the empirical dielectric function is shown as the dashed line .",
    "the agreement is good , as indeed was found solving the tdlda equations by other methods@xcite , but one can also see the effect of the well - known shortcoming of tdlda , that the predicted band gaps are too small@xcite .",
    "the theoretical absorption strength become significant starting at about 5 ev excitation , while the empirical absorption begins at around 7 ev .",
    "nevertheless , the dielectric constant comes out in good agreement with the empirical@xcite , being within a percent of the empirical value of @xmath68 .",
    "we see that the method not only works in principle , but produces fairly accurate dielectric functions in the cases of a simple metal and a simple insulator . in lithium ,",
    "the theory describes the metallicity as well as the interband transitions . in diamond",
    ", there is a spurious plasmon at low frequency due to the discrete mesh representation in coordinate and momentum spaces .",
    "however , it can be easily dealt with and then the dielectric function has an excellent quality except for a small band gap region .",
    "we find that two benefits of the real - space , real - time formulation of the tdlda in finite systems@xcite are preserved in our implementation here .",
    "the real - space method allows the kohn - sham operator and electron - electron interactions to be evaluated efficiently @xcite . computational efficiency",
    "is also gained by calculating the response in real time in that all frequencies are calculated at once .",
    "finally , the method requires much less storage than methods using a particle - hole representation of the time - varying wave function .",
    "we acknowledge discussions with e.k.u .",
    "gross , r. martin , j. rehr , and r. resta .",
    "this work was supported in part by the department of energy under grant de - fg03 - 00-er41132 , by the dges ( pb98 - 0345 ) and by the jcyl ( va28/99 ) , and by the ministry of education , science and cultures ( japan ) , no .",
    "ji and ky acknowledge the institute of solid state physics , university of tokyo , and the research center for nuclear physics , osaka university for their use of supercomputers .",
    "ar acknowledges the hospitalty of the institute for nuclear theory where this work was started and computer time provided by the centre de coputaci i comunicacions de catalunya .",
    "i. vasiliev , s. ogut , and j.r .",
    "chelikowsky , phys .",
    "82 1919 ( 1999 ) .",
    "k. yabana and g.f .",
    "bertsch , phys .",
    "b54 4484 ( 1996 ) .",
    "r. resta , rev .",
    "66 899 ( 1994 ) .",
    "x. gonze , p. ghosez , and r.w .",
    "godby , phys .",
    "74 4035 ( 1995 )",
    ". g. ortiz , i. souza , r.m .",
    "martin , phys .",
    "80 353 ( 1998 ) .",
    "r. resta , int .",
    "75 599 ( 1999 ) .",
    "f. kootstra , p.l",
    ". de boeij , j.g .",
    "snijders , j. chem .",
    "112(2000 ) april , 6517 . for a study of nonlocal pseupotential effects on oscillator strength , see k. yabana and g.f .",
    "bertsch , phys . rev .",
    "a58 2604 ( 1998 ) .",
    "dobson , phys .",
    "73 2244 ( 1994 ) .",
    "h. flocard , s. koonin , and m. weiss , phys .",
    "c17 1682 ( 1978 ) .",
    "j. chelikowsky , n. troullier , k. wu , and y. saad , phys .",
    "b50 11355 ( 1994 ) .",
    "n. troullier and j.l .",
    "martins , phys .",
    "b43 1993 ( 1991 ) .",
    "l. kleinman and d. bylander , phys .",
    "48 1425 ( 1982 ) . j. perdew and a. zunger , phys .",
    "b23 5048 ( 1981 ) .",
    "crc handbook of chemistry and physics , ( crc press , boca raton , 77th edition ) , p. 12 - 133 .",
    "h. bross and m. ehrnsperger , z. phys .",
    "b97 12 ( 1995).l v.i .",
    "gavrilenko and f. bechstedt , phys .",
    "b55 4343 ( 1997 ) .",
    "hybertsen and s.g .",
    "louie , phys .",
    "b34 5390 ( 1986 ) .",
    "godby , m. schlueter and l.j .",
    "sham , phys .",
    "b37 10159 ( 1988 ) .",
    "bertsch , a. rubio , and k. yabana , to be published , los alamos preprint physics/0003090 ."
  ],
  "abstract_text": [
    "<S> we present an algorithm to calculate the linear response of periodic systems in the time - dependent density functional theory , using a real - space representation of the electron wave functions and calculating the dynamics in real time . </S>",
    "<S> the real - space formulation increases the efficiency for calculating the interaction , and the real - time treatment decreases storage requirements and allows the entire frequency - dependent dielectric function to be calculated at once . </S>",
    "<S> we give as examples the dielectric functions of a simple metal , lithium , and an elemental insulator , diamond . </S>"
  ]
}