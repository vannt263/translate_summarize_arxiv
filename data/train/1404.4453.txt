{
  "article_text": [
    "few years have witnessed the emergence of a very promising linear physical - layer network coding protocol termed _ compute - and - forward_. introduced by nazer and gastpar in @xcite , this scheme allows to harness the multiple access interference to achieve higher transmission rates .",
    "this new framework is applicable to any network configuration accomodating source nodes , relays and destinations that communicate through linear additive white gaussian noise channels .",
    "the role of a relay node observing the output of a multiple access channel is to decode a _ linear integer _",
    "combination of source codewords . given enough linear equations ,",
    "the end destination in the network can ideally recover the original source messages with high transmission rates thanks to the potential properties of nested lattice codes .",
    "the original decoder for the cf consists of a scaling operation and a minimum distance decoding . under these assumptions , a union bound estimate of the error probability at the relays",
    "was derived in @xcite , and we have addressed in @xcite and @xcite the end - to - end error performance evaluation in the multi - source relay channel and the two - way relay channel respectively . later on , independently in @xcite and @xcite , the maximum likelihood ( ml ) decoder was investigated .",
    "an algebraic extension of the cf using lattice partitions related to finitely generated modules over principal ideal domains was proposed by feng _",
    "_ in @xcite assuming also minimum distance decoding .",
    "these works focus on the information theoretic performance of the cf and demonstrate that minimum distance decoding is asymptotically optimal .",
    "nevertheless , the performance of this decoder in practical settings ( finite lattice dimensions and low - complexity encoding schemes ) and the gap to optimal decoders are still not known .",
    "we try in this work to find answers to these issues by investigating optimal decoding criteria for the cf in the basic multiple access channel . after reviewing the original cf encoding and decoding schemes in section ii , our contributions come into light as follows : in section iii , we investigate efficient ml decoding for the fading channel considering integer lattices . by analyzing the one - dimensional case",
    ", we develop a novel near - ml decoder based on diophantine approximation and show by numerical results its gain over the original cf decoder for @xmath0lattices . in section iv",
    ", we analyze the map decoder for the cf in the gaussian channel using real - valued lattices .",
    "we derive a novel union bound estimate on the error probability and propose a lattice design criterion .",
    "then , we derive a novel map decoding metric based on which we develop novel efficient decoding algorithms proved numerically to outperform the conventional cf decoder while maintaining the same complexity order .",
    "an @xmath1-dimensional _ * lattice * _ @xmath2 is a set of points of @xmath3 given by @xmath4 where @xmath5 is called a generator matrix of the lattice . the main characteristic of @xmath2 is _ linearity _ , i.e. for any @xmath6 and @xmath7 , @xmath8 .",
    "a _ * lattice quantizer * _ @xmath9 satisfies for @xmath10 , @xmath11 .",
    "the set of points that quantize to a given lattice point is called the _ * voronoi region*_. the _ * fundamental voronoi region * _ @xmath12 of a lattice @xmath2 corresponds to the voronoi region of the zero vector .",
    "the modulo operation returns the quantization error with respect to @xmath2 . for @xmath10 : @xmath13\\mathrm{mod}\\lambda = \\mathbf{x } -   \\mathit{q}_{\\lambda } \\left ( \\mathbf{x } \\right)$ ] .",
    "a _ * nested lattice code * _ @xmath14 is the set of all points of a lattice @xmath15 ( termed the _ fine _ lattice ) that fall within the fundamental voronoi region of a lattice @xmath16 ( termed the _",
    "lattice ) as : @xmath17\\mathrm{mod}\\lambda_{\\mathrm{c } } , \\lambda_{\\mathrm{f } } \\in \\lambda_{\\mathrm{f}}\\right\\rbrace$ ] .",
    "we consider the real - valued fading multiple access channel ( mac ) composed of @xmath18 sources @xmath19 and a common receiver .",
    "extension of our results to the complex - valued channel follows by considering the real and imaginary parts of the channel outputs separately .",
    "source @xmath20 delivers a length-@xmath21 finite field message @xmath22 drawn independently and uniformally .",
    "encoders @xmath23 at the sources implement the same mapping @xmath24 to map the messages @xmath25 onto codewords @xmath26 from the same nested lattice code @xmath14 according to the symmetric power constraint given by : @xmath27 @xmath15 corresponds to the coding lattice and @xmath16 acts to satisfy the power constraint @xmath28 .",
    "the codewords are assumed to be independent and uniformally distributed over @xmath14 .",
    "the message rate is equal to @xmath29 and is the same for all sources .",
    "sources transmit then their codewords simultaneously across the channel .",
    "the received vector is written as : @xmath30 where @xmath31 denotes the fading coefficient from source @xmath32 to the receiver and @xmath33 denotes the additive white gaussian noise of zero - mean and variance @xmath34 .",
    "let @xmath35^{t}$ ] denote the channel coefficients vector .",
    "in this work we assume fixed channel vector .",
    "nevertheless , our results hold for the fast fading and slow fading channels .",
    "we assume also that channel state information ( csi ) is available only at the receiver and denote by @xmath36 the signal - to - noise ratio ( snr ) .",
    "the receiver attempts to decode a noiseless integer linear combination in the form : @xmath37 \\mathrm{mod}~\\lambda_{\\mathrm{c } } ~,~a_i \\in \\mathbb{z } , i=1, ... ,n\\ ] ] where the network code vector @xmath38^{t } \\in \\mathbb{z}^{n}$ ] is chosen by the receiver .",
    "the latter is equipped with a decoder @xmath39 , that recovers an estimate @xmath40 of @xmath41 .",
    "a decoding error occurs if @xmath42 and the desired equation with a coefficient vector @xmath43 is decoded with an average probability of error @xmath44 if @xmath45 and @xmath46 . a computation rate @xmath47 is said to be achievable",
    "if for any @xmath48 and @xmath1 large enough , there exist an encoder @xmath23 and a decoder @xmath49 , such that for any channel fading vector @xmath50 and network code vector @xmath51 , the receiver can recover the desired equation with an average probability of error @xmath44 as long as the source message rate @xmath52 satisfies : @xmath53 .",
    "the receiver selects a scalar @xmath54 and an integer vector @xmath43 and performs the following steps :    1 .",
    "scale the channel output : @xmath55 .",
    "the resulting effective noise @xmath56 is not gaussian since composed of a quantization error involving the original codewords . at this level , @xmath57 .",
    "2 .   decode to the nearest point in the fine lattice : @xmath58 .",
    "3 .   take the modulo operation with respect to the coarse lattice : @xmath59\\mathrm{mod}~\\lambda_{\\mathrm{c}}$ ] .",
    "we summarize the results regarding the cf protocol in the following theorems @xcite .",
    "[ rcomp ] for a real - valued mac with channel vector @xmath60 , and network code vector @xmath61 the following computation rate @xmath62 , for @xmath54 , is achievable : @xmath63 where @xmath64 .",
    "the computation rate given in theorem [ rcomp ] is only maximized for the mmse scaling factor @xmath65 given by : @xmath66 .",
    "[ aopt ] the optimal network code vector satisfies : @xmath67 where @xmath68 is definite positive .",
    "@xmath69 corresponds to the shortest vector in the lattice @xmath70 of gram matrix @xmath71 .",
    "the conventional decoding scheme for the cf consists of an mmse scaling operation and a minimum distance decoding .",
    "the problem is that in presence of the non - gaussian effective noise @xmath72 , minimum distance decoding is not ml decoding .",
    "although the conventional decoder is proved to be optimal in asymptotic regime using high dimensional lattices , its performance gap to the optimal decoders is not known particularly in practical settings using finite - dimensional lattices .",
    "we aim in the following to study optimal decoding criteria and develop practical efficient decoding algorithms .",
    "although we will consider the real - valued channel , our results hold in the complex - valued channel case using the same techniques at the real and imaginary parts of the channel output separately .",
    "we start in this section with the case of fading channels . the tools we will use in our analysis are valid only in the case of integer lattices ,",
    "thus we will consider an @xmath73dimensional nested lattice code @xmath74 involving a fine lattice @xmath75 of a generator matrix @xmath5 and a coarse lattice @xmath76 .",
    "for this case , @xmath5 is an integer full rank matrix .",
    "we will start with the multi - dimensional case which was independently studied in @xcite then we provide more in depth analysis regarding the one - dimensional case .      after selecting @xmath77 and @xmath43 ,",
    "the receiver scales the channel output to get : @xmath78 where @xmath79 and @xmath80 , and attempts to decode @xmath81 \\mathrm{mod}~\\lambda_{\\mathrm{c}}$ ] .",
    "we are concerned in this part with ml decoding for recovering the integer combination @xmath82 .",
    "the modulo - lattice operation is performed in a second stage separately and does not impact the error performance .",
    "thus , we evaluate the decoding error probability defined as : @xmath83 .",
    "given the vector @xmath43 and the shaping boundaries for the original codewords , it is known that the searched vector @xmath84 belongs to a subset @xmath85 in the fine lattice @xmath15 .",
    "this shaping constraint is also disregarded under the conventional cf decoder . in the following ,",
    "we analyze the ml decoder that takes into consideration this shaping condition .",
    "the ml criterion is based on maximizing the conditional probability @xmath86 according to : @xmath87 given that @xmath88 , we can equivalently write ( [ ml ] ) as : @xmath89 the transmitted codewords are assumed to be uniformally distributed over the nested lattice code @xmath14 , i.e. , @xmath90 are equiprobable . on the other hand",
    ", we have , @xmath91 where @xmath92 . combining ( [ proba ] ) and ( [ ml_1 ] )",
    ", we get : @xmath93 let @xmath94 our objective in the following is to express @xmath95 as a function of the desired equation @xmath84 .",
    "to this end , we need to express the codewords @xmath96 as functions of @xmath84 .",
    "given the integer nature of the vector @xmath43 and the codewords @xmath26 , this task requires to solve the system of diophantine equations @xmath88 . for @xmath73dimensional vectors",
    "this can be done using the hermite normal form ( hnf ) of integral matrices @xcite as explained in the following .",
    "define the integer - valued matrix @xmath97 as @xmath98 $ ] .",
    "the hermite normal form of @xmath99 is such that : @xmath100 $ ] where @xmath101 is a unimodular matrix , and @xmath102 is an invertible matrix .",
    "then , we decompose the matrix @xmath103 in the form : @xmath104 ~,~\\mathbf{v}_i \\in \\mathbb{z}^{n \\times n}~,~\\mathbf{u}_i \\in \\mathbb{z}^{n \\times",
    "n(n-1)}\\ ] ] the solution of the system of diophantine equations is then given by @xmath105 where @xmath106 and @xmath107 belong to the lattice of a generator matrix @xmath108 for @xmath109 .",
    "we go back now to the ml decoding rule defined in ( [ decoding ] ) and replace the vectors @xmath26 by the solution of the diophantine equations we obtain @xmath110 where @xmath111 belongs to the lattice @xmath112 of a generator matrix @xmath113 and @xmath114 .",
    "to find the ml solution , we need to maximize the likelihood function : @xmath115 this function is a sum of gaussian measures , it is periodic and depends on the signal - to - noise ratio .",
    "additionally , its most important characteristic is that it can be flat , which means that for some values of the channel coefficients , the network code vector and the signal - to - noise ratio , the maximum of @xmath95 can be achieved by several values of @xmath84 , which makes the ml decision ambiguous and results in decoding errors .",
    "this flatness behavior is characterized by belfiore and ling in @xcite by the so called the _ flatness factor_. for the ml decoding rule , we should minimize the flatness factor of the lattice @xmath112 over which is performed the sum of the gaussian measures in order to be able to distinguish the maximum values of the likelihood function and perform a correct decoding decision . solving the ml decoding metric requires more research on the sum of gaussian measures .",
    "alternatively , authors in @xcite propose an approximation of ml decoding based on _ diophantine approximation _ and consists in the optimization problem given by : @xmath116 where @xmath117 is a finite subset of the lattice @xmath112 fixed by the boundaries of the original codewords according to the transmission power constraint . for one - dimensional lattices ,",
    "there are several algorithms pertaining to the resolution of the diophantine approximations of reals . however , solving the multi - dimensional case requires additionally to develop efficient algorithms to handle simultaneous diophantine approximations .",
    "we study in the following the 1-d case in more details .      here",
    ", we focus on the case of 1-d lattices in @xmath118 and @xmath119 .",
    "transmitted codewords @xmath120 and @xmath121 are just integer scalars drawn i.i.d from the integer constellation over @xmath118 defined by @xmath122 $ ] for @xmath123 . this integer codebook can be seen as a nested lattice code in @xmath118 involving the fine lattice @xmath124 and the coarse lattice @xmath125 . the channel output in this case is given by : @xmath126 , with @xmath31 and @xmath127 .",
    "the receiver selects the optimal scaling parameter and the optimal network code vector @xmath128^{t}$ ] and attempts to decode the integer combination @xmath129 from the integer set @xmath130 determined by @xmath131 and the values of the coefficients @xmath132 and @xmath133 .",
    "the scaled channel output is given by : @xmath134 under these settings , the ml solution is given by : @xmath135 and the likelihood function is given by : @xmath136 our aim now is to express @xmath95 as a function of @xmath137 only .",
    "therefore , we need to solve the _ diophantine equation _ @xmath138 .",
    "let @xmath139 denote the greatest common divisor ( gcd ) of @xmath132 and @xmath133 .",
    "if the desired scalar @xmath137 is a multiple of @xmath140 , the diophantine equation admits an infinite number of solutions in the form : @xmath141 where @xmath142 and @xmath143 is a particular solution of the equation @xmath144 that can be derived using the _ extended euclid algorithm _ @xcite .",
    "if @xmath137 is not a multiple of @xmath140 , then the diophantine equation has no solutions . for what concerns our case",
    ", the network code vector @xmath43 corresponds to the coordinates of a lattice shortest vector , then the coefficients @xmath132 and @xmath133 are coprime . thus , the diophantine equation under question has always infinite solutions given by the system in ( [ bounds ] ) with @xmath145 .",
    "accordingly , we can write the ml solution in ( [ mlscalar ] ) as @xmath146 where @xmath147 , @xmath148 and @xmath142 .      @xmath95 is a sum of gaussian functions , it is periodic with _",
    "mean _ @xmath149 , _ period _ @xmath150 and _ width _ @xmath151 .",
    "in addition , @xmath95 depends on the snr , the channel coefficients , the coefficient vector @xmath43 and obviously on the constellation bounds defined by @xmath152 .",
    "we illustrate in fig.[flat1 ] an example of the likelihood function obtained for @xmath153 , @xmath154 , @xmath155 at @xmath156 and @xmath157^{t}$ ] .",
    "the optimal network code vector for this case is equal to @xmath158^{t}$ ] .",
    "accordingly , the desired combination should be equal to @xmath159 .",
    "the corresponding likelihood function depicted in fig.[flat1 ] is well maximized at @xmath160 . in this case , it is easy to decode the maximum of @xmath161 since we can distinguish a peak corresponding to the unique @xmath162 for which this function is maximized .    _ - impact of @xmath60 and @xmath43 : _ the choice of the network code vector @xmath43 can greatly impact the behavior of the likelihood function .",
    "particularly , when this integer vector is aligned to the channel vector @xmath60 ( they become colinear ) , the period @xmath163 of the likelihood function becomes small and results in a flatness of @xmath95 and impossibility of decoding the right @xmath162 since the maximum can be obtained for different values .",
    "this result is demonstrated through fig.[flat2 ] obtained at @xmath164 @xmath165^{t } , \\mathbf{a}=[-1~0]^{t}$ ] .",
    "the maximum of the likelihood function is obtained for two integer values @xmath166 and @xmath167 while the correct decodable value must be @xmath168 for the corresponding values of @xmath120 and @xmath121 .",
    "this happens at high snr range for which the maximization of the computation rate requires to align @xmath43 to @xmath60 .",
    "+ _ - impact of the constellation size : _ the likelihood function depends on the constellation size and the values of @xmath152 . when the size of the codebook increases , the set @xmath169 over which the desired combination @xmath137 should be searched becomes large .",
    "consequently , the width of @xmath95 becomes large and the likelihood function is made flat .",
    "thus , decoding the maximal value of @xmath137 becomes ambiguous .",
    "an example of this scenario is illustrated in fig.[flat3 ] obtained for @xmath170^{t } , \\mathbf{a}=[-1~0]^{t}$ ] .",
    "we can see that the likelihood function attains its maximum for @xmath171 and @xmath172 while the correctly decoded value is @xmath173 .",
    "this ambiguity leads to decoding errors .",
    "the sum of gaussian functions in the likelihood function makes the ml decoding hard to handle in practice . for this purpose ,",
    "we use the result stating that for @xmath174 , @xmath95 is maximized for @xmath137 which minimizes @xmath175 . given this observation",
    ", we define a new optimization problem equivalent to ( [ topt ] ) by : @xmath176 let @xmath177 and @xmath178 , then this minimization problem is equivalent to : @xmath179 this problem corresponds to solving the _ inhomogeneous diophantine approximation in the absolute sens _",
    "( ida ) @xcite , @xmath180 , defined as , @xmath181 .",
    "it consists in finding the best rational approximation @xmath182 of the real number @xmath183 assumed an additional real shift @xmath184 . in our setting ,",
    "the set of the diophantine approximations is determined by the limits imposed by the shaping boundaries @xmath169 . in literature , there exist simple and easy - to - implement algorithms to solve diophantine approximations of reals .",
    "the best known one is the _",
    "cassel s algorithm _ @xcite . in this work",
    "we adopt a modified version of this algorithm to take into consideration the shaping constraint and ensure that the resulting solution @xmath185 satisfies @xmath186 .",
    "we address now the performance evaluation of the conventional decoder and the proposed inhomogenous diophantine approximation ( ida ) decoder .",
    "we consider the same settings analyzed previously involving two sources transmitting integer symbols @xmath120 and @xmath121 drawn from the constellation set @xmath187 $ ] .",
    "we analyze the error probability on decoding @xmath137 . for what concerns the conventional decoder , the receiver solves for the best network code vector @xmath43 solution of the shortest vector problem , scales the channel output , then decodes to the nearest integer value . for the ida ,",
    "given the vector @xmath43 , the receiver implements first the _ extended euclid _ algorithm to solve the diophantine equation @xmath144 , then uses the modified cassel s algorithm to find the best inhomogeneous diophantine approximation . in fig.[perf1ml ] minimum distance decoding and ida decoding are compared for @xmath153 .",
    "our results show that both decoding methods achieve same performance in low and moderate snr values .",
    "the importance of the ida method rises asymptotically , since for this case , the conventional decoder presents a floor in the error probability . in fig.[perf2ml ] , we analyze the performance of the proposed ida decoding for three values of the constellation bound , defined by @xmath188 .",
    "this is to understand the impact of the constellation size on the diversity order .",
    "fig.[perf2ml ] illustrates that for @xmath153 or less , the system has a diversity order equal to 1 for real symbols ( which would correspond to a diversity order equal to 2 with complex - valued symbols ) .",
    "however , for higher constellation size , e.g. , for @xmath189 and @xmath190 , the diversity order is limited to @xmath191 .",
    "this is because when the constellation range increases , the likelihood function becomes flat , which makes the error function @xmath180 subject to the diophantine approximation flat .",
    "this result confirms our previous analysis on the impact of the constellation on the likelihood function .",
    "the system we are interested in within now is the real - valued gaussian multiple access channel using real - valued nested lattice coding .",
    "the channel output is given by : @xmath192 .",
    "the receiver aims to decode the noiseless sum @xmath193 \\mathrm{mod}~\\lambda_{\\mathrm{c}}$ ] .",
    "let @xmath194 denote the _ sum codebook _ which is the set of all @xmath195 .",
    "given the linear structure of the coding lattice , @xmath194 will be a subset of the fine lattice @xmath15 restricted to a _",
    "sum shaping region _",
    "@xmath196 such that all sum codewords @xmath197 fall within this region .",
    "in addition , given that @xmath194 is obtained through a superposition of the originally transmitted codewords , its distribution is * no longer uniform*.    using the conventional cf decoder , the receiver decodes @xmath195 using an mmse scaling followed by minimum distance decoding to the nearest point in the fine lattice . using this method , there are three fundamental limitations : @xmath198 the effective noise @xmath199 is not gaussian , @xmath200 the shaping constraint is disregarded , and @xmath201 the non uniform distribution of the sum codebook @xmath194 is not taken into account . a main contribution of this work is the analysis in the following of the optimal map decoding approach that takes into consideration the above mentionned drawbacks of the conventional cf decoder . to the best of our knowledge ,",
    "this is the first investigation of the map decoder for the cf protocol",
    ". we will be interested in decoding @xmath195 given that modulo - lattice operation is done separately and does not impact the decoding error .",
    "we will evaluate thereforre the error probability at the receiver as @xmath202 .      under the non - uniform distribution of the sum codebook , the optimal decoder that minimizes",
    "the probability of decoding error at the receiver is the _ maximum a posteriori _ decoder given according to the following : @xmath203 notice that the map decoder does not involve a scaling step like the conventional decoder keeping the channel noise gaussian . a first contribution in this context consists in deriving in the following theorem a union bound estimate on the decoding error probability .",
    "consider a nested lattice design @xmath204 and a receiver computing a noiseless sum of @xmath18 source codewords in a gaussian mac using the optimal maximum a posteriori decoder .",
    "then the union bound estimate of the probability of decoding error is : @xmath205 where @xmath206 , @xmath207 and @xmath208 denotes the minimum distance of the fine lattice @xmath15 .",
    "the proof of our theorem is based on the pairwise error probability defined as the probability that the sum codeword @xmath197 has a larger map decoding metric in ( [ map ] ) than @xmath209 given that @xmath197 is transmitted .",
    "its expression is formulated as follows @xmath210 where @xmath211 denotes the @xmath212 function and it is easy to prove that @xmath213 is a random gaussian variable of mean @xmath214 and variance @xmath215 given by : @xmath216 using the union bound , we get , @xmath217 we can therefore , using the relation @xmath218 , write : @xmath219 the last step to prove our theorem is based on two facts : @xmath198 for all @xmath220 , @xmath221",
    ". this inequality results from the linear structure and the geometrical symmetric properties of the fine lattice @xmath15 , and @xmath200 @xmath222 is a decreasing function with respect to @xmath223 @xcite .",
    "the proof follows then by considering @xmath224 and @xmath225 as defined above .",
    "given the derived upper bound , we propose a lattice design criterion as follows .",
    "minimization of the error probability under map decoding requires to design nested lattices @xmath226 such that the minimum distance of the fine lattice is maximized .",
    "the upper bound on the error probability is a strictly decreasing function of @xmath224 @xcite , thus a decreasing function of the minimum distance of the lattice @xmath15 .",
    "then in order to make the error probability small , the coding lattice @xmath15 has to have a large minimum distance @xmath208 .",
    "the construction of such good codes is out of the scope of this work . even though , we point out that for lattices built using construction a @xcite over linear codes , this criterion requires to design linear codes with minimum euclidean weights .",
    "we aim in this section to develop practical decoding algorithms that allow to reliably find the optimal map estimate of the optimization problem in ( [ map ] ) . for this purpose",
    ", we study first the statistical distribution of the sum codewords .    the original codewords are drawn uniformally and independently from the nested lattice code , they are modeled by uniform random variables of zero - mean ( @xmath227 ) and variance @xmath228 for @xmath109 .",
    "consider now the sum codewords @xmath195 obtained through the superposition of the vectors sent by the sources .",
    "given the uniform distribution of the original codewords , the _ central limit theorem _ states that @xmath197 is a random variable of mean @xmath229 and variance @xmath230 .",
    "particularly , for increasing number of sources @xmath18 , the sum codewords converge to the normal distribution @xmath231 . in order to be able to use this result to approximate the vectors @xmath197 by random gaussian variables ,",
    "we need in addition to take into consideration the fact that the sum codewords are discrete and correspond to lattice points . for this purpose",
    "we introduce the lattice gaussian distributions .",
    "this tool arises in several problems in coding theory @xcite , mathematics @xcite and cryptography @xcite .",
    "let @xmath232 denote the gaussian distribution of variance @xmath233 centered at the zero vector such that for @xmath234 and all @xmath10 : @xmath235 consider also the @xmath236periodic function defined by : @xmath237 then the sum codewords can be modeled by the discrete gaussian distributions over @xmath15 centered at the zero vector according to : @xmath238 .     + we illustrate in fig.[nested ] two examples of the statistical distribution of the sum codebook resulting from the superposition of 2-dimensional lattice codewords for the cases of @xmath119 and @xmath239 considering a fine lattice @xmath15 of a generator matrix @xmath240 $ ] and the coarse lattice @xmath241 .",
    "these examples show that the lattice gaussian distribution fits our settings . as a proof of concept",
    ", we will show by numerical results that this model is well justified in the context of lattice network coding even for low number of sources .",
    "using this gaussian distribution , the map decoding rule in ( [ map ] ) is equivalent to : @xmath242 the first and second terms in this metric are independent of the variable @xmath197 , they can be disregarded in the optimization over @xmath197 .",
    "then we obtain our novel decoding metric given by : @xmath243 where @xmath244 . using this new metric",
    ", we show in proposition.[mapmeth1 ] that map decoding reduces to solve for a closest vector problem .",
    "[ mapmeth1 ] the map decoding metric in ( [ mapeq ] ) is equivalent to find the closest vector in the lattice @xmath245 of generator matrix @xmath246^{t } \\in \\mathbb{r}^{2n \\times n}$ ] to the vector @xmath247^{t}$ ] according to the following metric : @xmath248    the decoding metric in ( [ mapeq ] ) can be written as : @xmath249 -   \\left [ \\begin{array}{c } \\lambda_{\\mathrm{s } } \\\\",
    "\\beta \\lambda_{\\mathrm{s } } \\end{array}\\right ]   \\right\\| ^{2 } \\right\\rbrace= \\operatorname*{argmin}_{\\lambda_{\\mathrm{s } } \\in \\lambda_{\\mathrm{s } } } \\parallel \\mathbf{y}_{\\mathrm{aug } } - \\mathbf{i}_{\\mathrm{aug } } \\lambda_{\\mathrm{s } } \\parallel^{2 }   \\end{aligned}\\ ] ] where @xmath250^{t } \\in \\mathbb{r}^{2n \\times n}$ ] is a full rank matrix .",
    "on the other hand , given that the sum codewords belong to the fine lattice according to the shaping region @xmath196 , any codeword @xmath197 can be written in the form @xmath251 where @xmath252 and @xmath253 translates the shaping constraint imposed by @xmath196 and can be deduced from the shaping boundaries limited by the transmission power constraint @xmath28 .",
    "consequently the optimization problem in ( [ mapeq1 ] ) is equivalent to solving @xmath254 @xmath255 is a full rank matrix and @xmath256 is an integer vector , then solving ( [ map4 ] ) consists in finding the closest vector @xmath257 to @xmath258 in the @xmath73dimensional lattice @xmath245 of a generated matrix @xmath255 . after finding the optimal integer vector @xmath259 that minimizes the metric in ( [ map4 ] ) ,",
    "the optimal map estimate is deduced by @xmath260 .    in our implementation",
    ", we use a modified version of the sphere decoder to solve this closest vector problem taking into account the shaping constraint .",
    "[ rmqmap ] the map decoding metric in ( [ mapeq ] ) involves two terms each one of them is given by an euclidean distance .",
    "when the first term is dominant , which is the case when @xmath261 , the map decoding rule reduces to ml decoding ( which is equivalent to minimum distance decoding in this case since we do nt perform a scaling step ) . given that @xmath262 depends on the power constraint @xmath28 , we deduce that this case of figure is likely to happen either at high signal - to - noise ratio or when @xmath263 is sufficiently higher than the noise variance @xmath34 .",
    "we expect then that the map decoding and the conventional decoder achieve similar performance at high snr range .",
    "adversely , at the low and moderate snr regime and when the product @xmath263 is small , the second term in the decoding metric applies an incremental constraint that considers the non - uniform distribution of the sum codewords in @xmath194 which is not taken into account under the conventional decoder . in this case",
    ", we expect that the map decoder outperforms the minimum distance decoding - based one .",
    "we provide in the following proposition an equivalent formulation of the map decoding metric .",
    "[ mapmeth2]the map decoding metric in ( [ mapeq ] ) is equivalent to mmse - gdfe preprocessed minimum euclidean distance decoding according to the metric : @xmath264 @xmath265 and @xmath266 denote respectively the forward and backward filters of the mmse - gdfe preprocessing for the channel @xmath267 such that @xmath268 and @xmath269 .",
    "let @xmath270 denote the metric we aim to minimize in ( [ mapeq ] ) , we have the following : @xmath271 where @xmath265 and @xmath266 are chosen such that : @xmath268 and @xmath269 .",
    "given that @xmath272 and independent of @xmath197 , minimization of @xmath270 is equivalent to minimize @xmath273 .",
    "the last piece to our proof is to show that the matrices @xmath274 and @xmath275 correspond to the filters of the mmse - gdfe preprocessing in the system @xmath267 of input @xmath197 and awgn @xmath276 .",
    "this proof is provided in appendix [ appendix : mmsegdfe ] .    in order to find the map estimate according to the decoding metric in ( [ mmsegdfe ] ) , the receiver first performs mmse - gdfe preprocessing , then performs minimum euclidean distance decoding to find the nearest point to @xmath277 in the lattice of generator matrix @xmath278 according to the shaping constraint imposed by the subset @xmath194 .",
    "we evaluate in this subsection the performance of the conventional decoder ( based on mmse scaling and minimum distance decoding ) and the proposed map decoding algorithm implementing a modified sphere decoder .",
    "in addition , in order to validate the gaussianity law assumption we considered to derive our map decoding metric , we include a naive exhaustive search to solve ( [ map ] ) . using this approach , no assumptions on the sum codebook distribution",
    "is considered .",
    "the receiver , given the number of sources and the original codebook associated to the nested lattice @xmath2 , derives the statistics of the sum codebook to compute the corresponding values of @xmath279 for all codewords @xmath280 , then , it exhaustively seeks the codeword which maximizes the decoding metric in ( [ map ] ) .",
    "we study in our analysis two lattice examples as described below .",
    "+    .,width=434,height=340 ]    _ example 1 : 2-dimensional lattice @xmath281 _ for this example we consider the same nested lattice code used to get the statistical distributions plotted in fig.[nested ] for @xmath119 and @xmath239 .",
    "the shaping constraint in this case is given by @xmath282 .",
    "given the number of sources and the power constraint imposed by the coarse lattice , we calculate for each case the bounds requirements to be considered in the decoding process .",
    "numerical results concerning the case @xmath119 , depicted in fig.[perf ] , show that our proposed algorithm achieves almost identical performance as the exhaustive search , which confirms the effectiveness of our metric as well as the validity of the gaussianity law assumption considered to model the sum - codewords even for the case of low number of sources @xmath119 .",
    "moreover , plotted curves show that the map decoder outperforms the conventional minimum distance decoding ( min .",
    "decoding ) .",
    "the gain for this case is limited to @xmath283db for an error probability equal to @xmath284 .",
    "results for the case of @xmath239 plotted in fig.[perf11 ] confirm the previous findings and show that the performance gap between the map and the minimum distance decoder is also not high .",
    "common to these two settings is the high value of @xmath263 , which joins our analysis in the previous remark .",
    ".,width=434,height=340 ]    .,width=434,height=340 ]     + _ example 2 : 4-dimensional lattice @xmath285 _ in this example we have consider the integer fine lattice @xmath15 of a generator matrix the identity @xmath286 together with a cubic shaping region according to @xmath287 .",
    "the aim of considering this example is to analyze the performance of the map decoder when the lattice dimension increases .",
    "simulation results depicted in fig.[perf2map ] show that our proposed map algorithm allows to achieve a gain of @xmath288db at a codeword error rate of @xmath289 over the minimum distance decoder while keeping a small gap to the exhaustive search .",
    "this case shows the merit of applying the map decoding in settings where the product @xmath263 is small .",
    "in addition , we notice that the gap between the map decoder and the conventional one is independent of the lattice dimension , it rather increases in settings involving small @xmath263 .",
    "this work was dedicated to decoding aspects for the compute - and - forward protocol in the basic multiple access real - valued channel . in a first part we studied the fading channel case assuming integer - valued lattices .",
    "we analyzed the @xmath73dimensional case and proposed a novel near - ml decoder based on diophantine approximation .",
    "numerical results for the @xmath290d scenario show the gain of this method over the conventional cf decoder at high snr range .",
    "moreover , we addressed the gaussian channel case . after analyzing the map decoding rule , we derived a novel decoding metric and developed practical algorithms based on lattice spherical decoding showed to outperform the standard minimum distance decoder . in future works",
    ", we aim to investigate the information theoretic performance of our map decoder to evaluate the achievable rate in the two - way gaussian relay channel .",
    "we aim to show that the matrices @xmath274 and @xmath275 in the equivalent map decoding metric correspond respectively to the forward and backward filters of the mmse - gdfe preprocessing in the channel @xmath291 with input @xmath197 such that @xmath292 .",
    "let @xmath293 and @xmath294 be the filters of the mmse - gdfe preprocessing such that : @xmath295 .",
    "let @xmath296 be the effective noise .",
    "the mmse - gdfe filters correspond to the minimization of the variance @xmath297 of the effective noise given by : @xmath298 = \\frac{1}{n } \\mathbb{e } \\left [ \\mathrm{tr } \\left ( \\mathbf{w } \\mathbf{w}^{t } \\right)\\right]= \\frac{1}{n } \\mathrm{tr } \\left (   \\mathbb{e } \\left [ \\left ( \\mathbf{f}_\\mathrm{m}-\\mathbf{b}_{\\mathrm{m } } \\right ) \\lambda_{\\mathrm{s } } \\lambda_{\\mathrm{s}}^{t } \\left ( \\mathbf{f}_{\\mathrm{m } } - \\mathbf{b}_{\\mathrm{m } } \\right)^{t } \\right ] + \\mathbb{e } \\left [ \\mathbf{f}_{\\mathrm{m } } \\mathbf{z } \\mathbf{z}^{t } \\mathbf{f}_{\\mathrm{m}}^{t } \\right ] \\right ) \\notag \\\\   & = \\frac{1}{n } \\mathrm{tr } \\left ( \\left ( \\mathbf{f}_\\mathrm{m}-\\mathbf{b}_{\\mathrm{m } } \\right ) \\underbrace{\\mathbb{e}\\left [ \\lambda_{\\mathrm{s } } \\lambda_{\\mathrm{s}}^{t } \\right]}_{\\sigma_{\\mathrm{s}}^{2}\\mathbf{i}_n } \\left ( \\mathbf{f}_{\\mathrm{m } } - \\mathbf{b}_{\\mathrm{m } } \\right)^{t } + \\mathbf{f}_{\\mathrm{m } } \\underbrace{\\mathbb{e}\\left[\\mathbf{z } \\mathbf{z}^{t } \\right]}_{\\sigma^{2}\\mathbf{i}_n } \\mathbf{f}_{\\mathrm{m}}^{t } \\right ) \\notag \\\\   & = \\frac{\\sigma_{\\mathrm{s}}^{2}}{n } \\mathrm{tr } \\left ( \\mathbf{f}_{\\mathrm{m } } \\left ( \\mathbf{i}_n + \\beta^{2}\\mathbf{i}_n \\right)\\mathbf{f}_{\\mathrm{m}}^{t}\\mathbf{f}_{\\mathrm{m}}\\mathbf{b}_{\\mathrm{m}}^{t}-\\mathbf{b}_{\\mathrm{m}}\\mathbf{f}_{\\mathrm{m}}^{t}+\\mathbf{b}_{\\mathrm{m}}\\mathbf{b}_{\\mathrm{m}}^{t }   \\right ) \\notag   \\end{aligned}\\ ] ] let the matrix @xmath299 such that @xmath300 and @xmath71 such that @xmath301 , then @xmath297 is equal to : @xmath302 for fixed @xmath294 we seek first the optimal forward matrix @xmath293 which minimizes @xmath297 .",
    "this corresponds to have @xmath303 which results in : @xmath304 .",
    "we get : @xmath305 we have @xmath306 wich leads to the minimum variance : @xmath307 .",
    "now , we will show that @xmath308 and @xmath309 .",
    "first , @xmath274 and @xmath275 satisfy same constraints as the mmse - gdfe filters . the last piece to prove the equivalence then is to prove that @xmath274 and @xmath275 allow to minimize the variance of the effective noise @xmath310 .",
    "we compute the corresponding variance refered to @xmath311 : @xmath312 where ( a ) follows from linearity of trace , ( b ) follows from commutativity of trace of matrices @xmath313 , ( c ) follows using @xmath314 .",
    "finally , we use the relation @xmath269 to deduce that @xmath315 which gives @xmath316 .",
    "we get then : @xmath317 ."
  ],
  "abstract_text": [
    "<S> we address in this paper decoding aspects of the compute - and - forward ( cf ) physical - layer network coding strategy . </S>",
    "<S> it is known that the original decoder for the cf is asymptotically optimal . </S>",
    "<S> however , its performance gap to optimal decoders in practical settings are still not known . in this work , </S>",
    "<S> we develop and assess the performance of novel decoding algorithms for the cf operating in the multiple access channel . for the fading channel </S>",
    "<S> , we analyze the ml decoder and develop a novel diophantine approximation - based decoding algorithm showed numerically to outperform the original cf decoder . for the gaussian channel , </S>",
    "<S> we investigate the _ maximum a posteriori _ ( map ) decoder . </S>",
    "<S> we derive a novel map decoding metric and develop practical decoding algorithms proved numerically to outperform the original one .    </S>",
    "<S> submitted paper    physical - layer network coding , compute - and - forward , lattice decoding , maximum a posteriori decoding . </S>"
  ]
}