{
  "article_text": [
    "recently , energy harvesting has become an appealing solution to prolong the lifetime of energy constrained wireless networks such as device centric or sensor based wireless networks . in particular , radio frequency ( rf )",
    "signals radiated by ambient transmitters is a viable new source for wireless energy harvesting . as a result ,",
    "the wireless powered communication network ( wpcn ) has drawn an upsurge of interests , where rf signals are used to wirelessly power user terminals for communication .",
    "a typical wpcn model is shown in fig .",
    "[ fig1 ] @xcite , where an access point ( ap ) with constant power supply coordinates the downlink ( dl ) wireless information and energy transfer to a set of distributed user terminals that do not have embedded energy sources , as well as the wireless powered information transmission from the users in the uplink ( ul ) .",
    "= 0.8     it is worth noting that the dl simultaneous wireless information and power transfer ( swipt ) in wpcns has been recently studied in the literature ( see e.g. @xcite-@xcite ) , where the achievable information versus energy transmission trade - offs were characterized under different channel setups .",
    "however , the above works have not addressed the joint design of dl energy transfer and ul information transmission in wpcns , which is another interesting problem to investigate even by ignoring the dl information transmission for the purpose of exposition . in @xcite ,",
    "a wpcn with single - antenna ap and users has been studied for joint dl energy transfer and ul information transmission .",
    "a `` harvest - then - transmit '' protocol was proposed in @xcite where the users first harvest energy from the signals broadcast by the ap in the dl , and then use their harvested energy to send independent information to the ap in the ul based on time - division - multiple - access ( tdma ) .",
    "the orthogonal time allocations for the dl energy transfer and ul information transmissions of all users are jointly optimized to maximize the network throughput . furthermore",
    ", an interesting `` doubly near - far '' phenomenon was revealed in @xcite , where a far user from the ap , which receives less power than a near user in the dl energy transfer , also suffers from more signal power attenuation in the ul information transmission due to pass loss .",
    "= 0.8     in this paper , we extend the study of @xcite to wpcns with the multi - antenna ap , as shown in fig .",
    "when the ap is equipped with multiple antennas , the amount of energy transferred to different users in the dl can be controlled by designing different energy beamforming weights at the ap , while in the ul all users can transmit information to the ap simultaneously via space - division - multiple - access ( sdma ) , which thus has higher spectrum efficiency than orthogonal user transmissions in tdma as considered in @xcite . to overcome the doubly near - far problem , similar to @xcite , we maximize the minimum ul throughput among all users by a joint optimization of the dl - ul time allocation , the dl energy beamforming , and the ul transmit power allocation plus receive beamforming .",
    "first , we assume that the optimal linear minimum - mean - square - error ( mmse ) based receiver is employed at the ap for ul information transmission , which results in a non - convex problem .",
    "we solve this problem optimally by two steps : first , we fix the dl - ul time allocation and obtain the corresponding optimal dl energy beamforming , ul power allocation and receive beamforming solution ; then , the problem is solved by a one - dimension search over the optimal time allocation .",
    "particularly , for the joint dl energy beamforming and ul power allocation plus receive beamforming optimization , it is shown that this problem is in general non - convex .",
    "however , we establish its equivalence to a spectral radius minimization problem , which is then solved globally optimally by applying the alternating optimization technique @xcite based on the non - negative matrix theory @xcite , @xcite .",
    "notice that the non - negative matrix theory has been applied in the literature to the ul multiuser information transmission with transmit power control and receive beamforming ( see e.g. @xcite , @xcite , and the references therein ) . therefore , our proposed algorithm in this case can be viewed as an extension of the above works to the case with jointly optimizing the dl energy beamforming for wireless power transfer .",
    "it is also worth pointing out that in conventional multi - antenna wireless networks with both the ul and dl information transmissions , a useful tool that has been successfully applied to solve many non - convex design problems is the so - called ul - dl duality @xcite , -@xcite .",
    "different from this conventional setup , in this paper we explore another interesting new relationship between the dl and ul transmissions in a wpcn with coupled dl energy transfer and ul information transmission optimization .",
    "finally , to reduce the complexity of the optimal solution , we propose two suboptimal designs employing the zero - forcing ( zf ) based receive beamforming in the ul information transmission .",
    "the rest of this paper is organized as follows .",
    "section [ sec : system model ] presents the multi - antenna wpcn model with the harvest - then - transmit protocol .",
    "section [ sec : problem formulation ] formulates the minimum throughput maximization problem .",
    "section [ sec : optimal solution ] presents the optimal solution for this problem based on non - negative matrix theory .",
    "section [ a zf - based low - complexity suboptimal solution ] presents two suboptimal designs with lower complexity .",
    "section [ sec : numerical results ] provides numerical results to compare the performances of proposed solutions .",
    "finally , section [ sec : conclusion ] concludes the paper .",
    "_ notation _ : scalars are denoted by lower - case letters , vectors by bold - face lower - case letters , and matrices by bold - face upper - case letters . @xmath0 and @xmath1 denote an identity matrix and an all - zero matrix , respectively , with appropriate dimensions . for a square matrix @xmath2 , @xmath3 denotes the trace of @xmath2 ; @xmath4 ( @xmath5 ) means that @xmath2 is positive ( negative ) semi - definite . for a matrix @xmath6 of arbitrary size , @xmath7 and @xmath8",
    "denote the conjugate transpose and rank of @xmath6 , respectively .",
    "@xmath9 $ ] denotes the statistical expectation .",
    "the distribution of a circularly symmetric complex gaussian ( cscg ) random vector with mean @xmath10 and covariance matrix @xmath11 is denoted by @xmath12 ; and @xmath13 stands for `` distributed as '' .",
    "@xmath14 denotes the space of @xmath15 complex matrices .",
    "@xmath16 denotes the euclidean norm of a complex vector @xmath10 . for two real vectors @xmath10 and @xmath17 , @xmath18 means that @xmath10 is greater than or equal to @xmath17 in a component - wise manner .",
    "consider a wpcn consisting of one ap and @xmath19 users , denoted by @xmath20 , @xmath21 , as shown in fig .",
    "[ fig2 ] . it is assumed that the ap is equipped with @xmath22 antennas , while each @xmath20 is equipped with one antenna . the conjugated complex dl channel vector from the ap to @xmath20 and the reversed ul channel vector are denoted by @xmath23 and @xmath24 , respectively .",
    "we assume that all channels follow independent quasi - static flat fading , where @xmath25 s and @xmath26 s remain constant during one block transmission time , denoted by @xmath27 , but in general can vary from block to block.s can be estimated by the ap based on the pilot signals sent by individual @xmath20 s , while for the dl power transfer , the channels @xmath25 s can be obtained by the ap via , e.g. , sending the pilot signal to all @xmath20 s and collecting channel estimation feedback from individual @xmath20 s . to focus on the performance upper bound , in this paper",
    "we assume that such channel knowledge is perfectly known at the ap for both dl and ul transmissions in each block . ]",
    "= 0.8     in this paper , we assume that all @xmath20 s have no conventional energy supplies ( e.g. fixed batteries ) available and thus need to replenish energy from the signals sent by the ap in the dl .",
    "however , we assume that an energy storage device ( esd ) in the form of rechargeable battery or super - capacitor is still equipped at each user terminal to store the energy harvested from received rf signals for future use .",
    "in particular , we adopt the `` harvest - then - transmit '' protocol proposed in @xcite , as shown in fig .",
    "[ fig3 ] , which is described as follows . in each block , during the first @xmath28 ( @xmath29 ) amount of time , the ap broadcasts energy signals in the dl to transfer energy to all @xmath20 s simultaneously , while in the remaining @xmath30 amount of time of the block , all @xmath20 s transmit their independent information to the ap simultaneously in the ul by sdma using their harvested energy from the dl . for convenience , we normalize @xmath31 in the rest of this paper without loss of generality .",
    "next , in the ul phase , each @xmath20 utilizes its harvested energy in the previous dl phase to transmit information to the ap , as shown in fig . [ fig2](b ) .",
    "the transmit signal of @xmath20 in the ul is then expressed as @xmath53where @xmath54 s denote the information - carrying signals of @xmath20 s , which are assumed to be i.i.d .",
    "circularly symmetric complex gaussian ( cscg ) rvs with zero mean and unit variance , denoted by @xmath55 , @xmath51 , and @xmath56 denotes the transmit power of @xmath20 .",
    "note that @xmath57 , @xmath51 .",
    "the received signal at the ap in the ul is then expressed as @xmath58where @xmath59 denotes the receiver additive white gaussian noise ( awgn ) .",
    "it is assumed that @xmath60 . in this paper",
    ", we assume that the ap employs linear receivers to decode @xmath54 s in the ul . specifically , let @xmath61 denote the receive beamforming vector for decoding @xmath54 , @xmath62 .",
    "define @xmath63^t$ ] and @xmath64 .",
    "then , the signal - to - interference - plus - noise ratio ( sinr ) for decoding @xmath20 s signal is expressed as @xmath65thus , the achievable rate ( in bps / hz ) for the ul information transmission of @xmath20 can be expressed as @xmath66notice that there exists a non - trivial trade - off in determining the optimal dl - ul time allocation @xmath67 to maximize @xmath68 since to increase the transmit power @xmath56 , more time should be allocated to dl energy transfer according to ( [ eq : available power ] ) , while this will reduce the ul information transmission time from ( [ eqn : throughput ] ) .",
    "in this paper , we are interested in maximizing the minimum ( max - min ) throughput of all @xmath20 s in each block by jointly optimizing the time allocation @xmath67 , the dl energy beams @xmath52 , the ul transmit power allocation @xmath69 and receive beamforming vectors @xmath70 , i.e. , @xmath71it is worth noting that the number of energy beams , i.e. , @xmath32 , is a design variable in problem ( [ equ : minimum throughput maximization ] ) .",
    "after the dl energy beamforming solution @xmath52 is obtained , we can set the optimal value of @xmath32 as the number of columns in @xmath52 .",
    "problem ( [ equ : minimum throughput maximization ] ) is non - convex due to the coupled design variables in the objective function as well as the ul transmit power constraints .",
    "note that if we fix @xmath72 and @xmath73 , then problem ( [ equ : minimum throughput maximization ] ) reduces to the following ul sinr balancing problem with the users individual power constraints .",
    "@xmath74the above problem has been solved in the literature .",
    "for example , in @xcite problem ( [ equ : sinr balancing ] ) was decoupled into @xmath19 subproblems , each with one individual user power constraint and thus solvable by the non - negative matrix theory based algorithm proposed in @xcite . in the following two sections ,",
    "we propose both optimal and suboptimal algorithms to solve problem ( [ equ : minimum throughput maximization ] ) , respectively .",
    "in this section , we propose to solve problem ( [ equ : minimum throughput maximization ] ) optimally via a two - step procedure as follows .",
    "first , by fixing @xmath72 , @xmath75 , problem ( [ equ : minimum throughput maximization ] ) reduces to the following problem.@xmath76let @xmath77 denote the optimal value of problem ( [ equ : sinr balancing problem for simo - ic with individual power constraint ] ) with any given @xmath78 . the optimal value of problem ( [ equ : minimum throughput maximization ] )",
    "can then be obtained as @xmath79to summarize , problem ( [ equ : minimum throughput maximization ] ) can be solved in the following two steps : first , given any @xmath78 , we solve problem ( [ equ : sinr balancing problem for simo - ic with individual power constraint ] ) to find @xmath77 ; then , we solve problem ( [ eqn : optimal time allocation ] ) to find the optimal @xmath80 by a simple one - dimension search over @xmath81 . in the rest of this section , we thus focus on solving problem ( [ equ : sinr balancing problem for simo - ic with individual power constraint ] ) with given @xmath78 .",
    "it is worth noting that as will be shown later in the numerical results in section [ sec : numerical results ] , with the optimal solution to problem ( [ equ : sinr balancing problem for simo - ic with individual power constraint ] ) for certain @xmath78 , denoted by @xmath82 , the users individual power constraints in ( [ equ : sinr balancing problem for simo - ic with individual power constraint ] ) are not necessarily all tight , i.e. , there may exist some @xmath83 s such that @xmath84 .",
    "this indicates that power control is in general needed in the ul information transmission since the optimal strategy for each user is not to always transmit with its maximum available power using the harvested energy from the dl power transfer .    by introducing a common sinr requirement @xmath85 for all @xmath20 s , problem ( [ equ : sinr balancing problem for simo - ic with individual power constraint ] )",
    "can be reformulated as the following problem . @xmath86note",
    "that even if we fix @xmath73 in problem ( [ equ : common throughput ] ) , which reduces to the well - known sinr balancing problem given in ( [ equ : sinr balancing ] ) , this problem in general is still non - convex over @xmath69 , @xmath70 and @xmath85 , and as a result its optimal solution can not be obtained by convex optimization techniques @xcite .",
    "however , the non - negative matrix theory @xcite , @xcite has been used in e.g. , @xcite , @xcite , and @xcite to obtain the optimal solution to problem ( [ equ : sinr balancing ] ) . by extending the results in @xcite , @xcite , and @xcite , in the following we present an efficient algorithm to solve problem ( [ equ : common throughput ] ) with the joint dl energy beamforming optimization based on the non - negative matrix theory .",
    "first , we transform the sinr balancing problem given in ( [ equ : common throughput ] ) into an equivalent spectral radius minimization problem , where the spectral radius of a matrix @xmath87 , denoted by @xmath88 , is defined as its maximum eigenvalue in absolute value @xcite , @xcite .",
    "define @xmath89 , @xmath90^t$ ] , and the @xmath91 non - negative matrix @xmath92 as @xmath93where @xmath94_{k , j}$ ] denotes the entry on the @xmath83th row and @xmath95th column of @xmath96 .",
    "furthermore , define @xmath97where @xmath98 denotes a vector with its @xmath83th component being @xmath99 , and all other components being @xmath100",
    ". then we have the following theorem .    [ theorem1 ]",
    "given any feasible @xmath70 and @xmath52 , the optimal sinr balancing solution to problem ( [ equ : common throughput ] ) can be expressed as @xmath101furthermore , define @xmath102 , and @xmath103 as the dominant eigenvector of @xmath104 corresponding to @xmath105 , then @xmath69 is the optimal power solution to problem ( [ equ : common throughput ] ) to achieve @xmath106 given @xmath70 and @xmath52",
    ".    please refer to appendix [ appendix1 ] .",
    "theorem [ theorem1 ] implies that problem ( [ equ : common throughput ] ) is equivalent to the following spectral radius minimization problem . @xmath107",
    "next , we propose an iterative algorithm to solve problem ( [ eqn : equivalent problem ] ) by applying the alternating optimization technique @xcite .",
    "specifically , by fixing the ul receive beamforming @xmath108 , we first optimize the dl energy beamforming @xmath52 by solving the following dl problem : @xmath109let @xmath110 denote the optimal solution to problem ( [ eqn : downlink ] ) , then by fixing @xmath73 , we optimize @xmath70 by solving the following ul problem : @xmath111the above procedure is iterated until both @xmath70 and @xmath52 converge .",
    "first , consider problem ( [ eqn : downlink ] ) .",
    "for convenience , define @xmath112 , and @xmath113^t$ ] .",
    "furthermore , let @xmath114_{i , j}$ ] denote the entry on the @xmath37th row and @xmath95th column of @xmath115 , and @xmath116_j$ ] denote the @xmath95th entry of @xmath117 , @xmath51 .",
    "then we have the following proposition .    [ proposition1 ]",
    "problem ( [ eqn : downlink ] ) is equivalent to the following problem : @xmath118_{i , j}e^{\\tilde{q}_j-\\tilde{q}_i -\\tilde{\\theta}}+y_i(\\bar{{\\mbox{\\boldmath{$ w $ } } } } ) e^{\\tilde{q}_{k+1}-\\tilde{q}_i -\\tilde{\\theta } } \\leq 1 , ~ 1\\leq i \\leq k , \\nonumber \\\\ & ~~ \\sum\\limits_{j=1}^k[{\\mbox{\\boldmath{$ e $ } } } _ k^t{\\mbox{\\boldmath{$ x $ } } } ( \\bar{{\\mbox{\\boldmath{$ w $ } } } } ) ] _ je^{\\tilde{q}_j-\\tilde{q}_{k+1 } - \\tilde{\\theta}}+{\\mbox{\\boldmath{$ e $ } } } _ k^t{\\mbox{\\boldmath{$ y $ } } } ( \\bar{{\\mbox{\\boldmath{$ w $ } } } } ) e^{-\\tilde{\\theta } } \\leq \\frac{\\epsilon",
    "\\bar{\\tau}{\\rm tr}({\\mbox{\\boldmath{$ g $ } } } _ k{\\mbox{\\boldmath{$ s $ } } } ) } { 1-\\bar{\\tau } } , ~ 1\\leq k \\leq k , \\nonumber \\\\ & ~~ { \\rm tr}({\\mbox{\\boldmath{$ s $ } } } ) \\leq p_{{\\rm sum } } , \\nonumber \\\\ & ~~ { \\mbox{\\boldmath{$ s $ } } } \\succeq { \\mbox{\\boldmath{$ 0 $ } } } , \\end{aligned}\\]]where @xmath119 , and @xmath120 , @xmath51",
    ".    please refer to appendix [ appendix2 ] .",
    "thanks to the fact that @xmath121 s are all non - negative matrices , problem ( [ eqn : downlink equivalent convex problem ] ) is a convex optimization problem , which thus can be efficiently solved by cvx @xcite .",
    "let @xmath122 denote the optimal covariance solution to problem ( [ eqn : downlink equivalent convex problem ] ) ; then the optimal @xmath123 number of dl energy beams , i.e. , @xmath124 , for problem ( [ eqn : downlink ] ) can be obtained by computing the eigenvalue decomposition ( evd ) of @xmath122 .",
    "next , consider problem ( [ eqn : uplink ] ) .",
    "since this problem has been solved by @xcite , we refer the readers to the algorithm given in table iv of @xcite for the solution .",
    "last , by iteratively solving problems ( [ eqn : downlink ] ) and ( [ eqn : uplink ] ) , we can solve problem ( [ eqn : equivalent problem ] ) , for which the overall algorithm is summarized in table [ table5 ] .",
    "since the objective value of problem ( [ eqn : equivalent problem ] ) is increased after each iteration , a monotonic convergence can be guaranteed for algorithm [ table5 ] .",
    "however , since problem ( [ eqn : equivalent problem ] ) is a non - convex optimization problem , in general whether the converged solution is globally optimal to problem ( [ eqn : equivalent problem ] ) remains unknown . in the following theorem , we show the global convergence of algorithm [ table5 ] .    ' '' ''    * initialize a feasible @xmath125 and update @xmath126 via the algorithm in table iv of @xcite .",
    "set @xmath127 and @xmath128 ; * * repeat * * * @xmath129 ; * * dl : fix @xmath130 and update @xmath131 by solving problem ( [ eqn : downlink equivalent convex problem ] ) ; * * ul : fix @xmath132 and update @xmath133 via the algorithm in table iv of @xcite ; * * set @xmath134 ; * * until * @xmath135 , where @xmath136 is a small positive number to control the algorithm accuracy .    ' '' ''    [ table5 ]    [ theorem2 ] algorithm [ table5 ] converges to the globally optimal solution to problem ( [ eqn : equivalent problem ] )",
    ".    please refer to appendix [ appendix3 ] .",
    "due to the equivalence between problems ( [ equ : common throughput ] ) and ( [ eqn : equivalent problem ] ) shown in theorem [ theorem1 ] , theorem [ theorem2 ] implies that we can apply algorithm [ table5 ] to obtain the optimal solution to problem ( [ equ : common throughput ] ) .",
    "let @xmath137 and @xmath138 denote the optimal solution to problem ( [ eqn : equivalent problem ] ) obtained by algorithm [ table5 ] .",
    "we define @xmath139 .",
    "then , according to theorem [ theorem1 ] , the optimal value of problem ( [ equ : common throughput ] ) , @xmath140 , is equal to @xmath141 , and the optimal power solution @xmath142 can be obtained from the dominant eigenvector of @xmath143 , i.e. , @xmath144 .",
    "in the previous section , we propose the optimal algorithm to solve problem ( [ equ : minimum throughput maximization ] ) based on the techniques of alternating optimization and non - negative matrix theory .",
    "note that the optimal algorithm requires a joint optimization of the dl energy beams @xmath52 and the ul transmit power allocation @xmath69 plus receive beamforming @xmath70 .",
    "moreover , the optimal time allocation for @xmath67 needs to be obtained by an exhaustive search . in this section ,",
    "we propose two suboptimal solutions for problem ( [ equ : minimum throughput maximization ] ) under the assumption that the number of users is no larger than that of antennas at the ap , i.e. , @xmath145 ; hence , in the ul , the ap can employ the suboptimal zf - based receivers ( instead of mmse - based receivers in the optimal algorithms ) to completely eliminate the inter - user interference , which simplifies the design as shown next .",
    "define @xmath146^h$ ] , @xmath62 , which constitutes all the ul channels except @xmath26 . then with zf - based receivers in the ul , we aim to solve problem ( [ equ : minimum throughput maximization ] ) with the additional constraints : @xmath147 , @xmath51 .",
    "let the singular value decomposition ( svd ) of @xmath148 be denoted as @xmath149^h,\\end{aligned}\\]]where @xmath150 and @xmath151 are unitary matrices , and @xmath152 is a @xmath153 rectangular diagonal matrix .",
    "furthermore , @xmath154 and @xmath155 consist of the first @xmath156 and the last @xmath157 right singular vectors of @xmath148 , respectively .",
    "note that @xmath158 forms an orthogonal basis for the null space of @xmath148 , thus @xmath159 must be in the following form : @xmath160 , @xmath51 , where @xmath161 is an arbitrary @xmath162 complex vector of unit norm .",
    "it can be shown that to maximize the rate of @xmath20 , @xmath161 should be aligned to the same direction as the equivalent channel @xmath163 .",
    "thus , we have@xmath164note that unlike the mmse - based receivers in section [ sec : optimal solution ] , the above zf receivers are not related to @xmath69 and hence do not depend on @xmath52 and @xmath67 .    with the zf receivers given in ( [ eqn : opt zf ] )",
    ", the throughput of @xmath20 given in ( [ eqn : throughput ] ) reduces to @xmath165where @xmath166 denotes the power of the equivalent ul channel for @xmath20 .",
    "based on the achievable rate expression given in ( [ eqn : throughput zf ] ) with zf receive beamforming , we further propose two suboptimal solutions to obtain @xmath67 , @xmath69 , and @xmath52 for problem ( [ equ : minimum throughput maximization ] ) in the following two subsections , respectively",
    ".      with ( [ eqn : throughput zf ] ) , problem ( [ equ : minimum throughput maximization ] ) reduces to @xmath167define @xmath168 , @xmath51 , and @xmath169 . by introducing a common throughput requirement @xmath170 , problem ( [ eqn : zf problem ] )",
    "can be transformed into the following equivalent problem .",
    "@xmath171where @xmath172 .    problem ( [ eqn : equivalent zf problem ] ) can be shown to be convex , and thus it can be solved efficiently by e.g. , the interior - point method @xcite .",
    "let @xmath173 , @xmath174 , @xmath175 and @xmath176 denote the optimal solution to problem ( [ eqn : equivalent zf problem ] ) .",
    "then the optimal power allocation solution to problem ( [ eqn : zf problem ] ) can be obtained as @xmath177 , and the optimal @xmath178 number of energy beams @xmath179 s can be obtained by the evd of @xmath180 .",
    "problem ( [ eqn : zf problem ] ) still requires a joint optimization of @xmath52 , @xmath67 and @xmath69 . to further reduce the complexity ,",
    "in this subsection we propose another suboptimal solution for problem ( [ eqn : zf problem ] ) by separating the optimization of dl energy beamforming and ul power allocation .",
    "first , the dl energy beams @xmath43 s are obtained by solving the following weighted sum - energy maximization problem .",
    "@xmath181where @xmath182 denotes the energy weight for @xmath20 .",
    "note that intuitively , to guarantee the rate fairness among the users , in the dl we should transfer more energy to users with weaker channels ( e.g. , more distant from the ap ) by assigning them with higher energy weights .",
    "therefore , we propose the following energy weight assignment rule that takes the doubly near - far effect into account : @xmath183 , @xmath62 .",
    "let @xmath184 and @xmath185 denote the maximum eigenvalue and its corresponding unit - norm eigenvector of the matrix @xmath186 , respectively",
    ". from @xcite , the optimal value of problem ( [ eqn : maximum energy ] ) given a set of @xmath187 s is then obtained as @xmath188 , which is achieved by @xmath189 and @xmath190 , i.e. , only one energy beam is used .",
    "next , by substituting @xmath191 into problem ( [ eqn : zf problem ] ) , the corresponding optimal time allocation @xmath192 and power allocation @xmath193 can be obtained by solving the following problem : @xmath194    it is worth noting that all @xmath20 s should transmit at full power in the ul in this case since they cause no interference to each other due to the zf receivers used at the ap . as a result , without loss of generality we can substitute @xmath195 into problem ( [ eqn : equivalent subooptimal 2 ] ) to remove the variable @xmath196 , which results in the following equivalent problem : @xmath197    it can be shown that @xmath198 is a concave function over @xmath199 , and thus problem ( [ eqn : equivalent subooptimal zf ] ) is a convex optimization problem , which can be solved efficiently by the interior - point method @xcite .",
    "alternatively , we can apply the bisection method @xcite to search for the optimal @xmath170 , while with given @xmath170 , the optimal time allocation @xmath67 can be efficiently obtained by solving a convex feasibility problem , for which the details are omitted here for brevity .",
    "in this section , we provide numerical examples to validate our results .",
    "we consider a multi - antenna wpcn in which the ap is equipped with @xmath200 antennas , and there are @xmath201 users",
    ". holds in our example ; thus , the two zf receiver based solutions in section [ a zf - based low - complexity suboptimal solution ] are both feasible . ]",
    "we set @xmath202watt ( w ) or @xmath203dbm , @xmath204 , and @xmath205dbm .",
    "the distance - dependent pass loss model is given by @xmath206where @xmath207 is set to be @xmath208 , @xmath209 denotes the distance between @xmath20 and ap , @xmath210 is a reference distance set to be @xmath99 m , and @xmath211 is the path loss exponent set to be @xmath212 .",
    "moreover , we assume that the channel reciprocity holds for the ul and dl channels , i.e. , @xmath213 , @xmath51 .",
    "the channel vectors @xmath25 s are generated from independent rician fading .",
    "specifically , @xmath25 is expressed as @xmath214where @xmath215 is the line of sight ( los ) deterministic component , @xmath216 denotes the rayleigh fading component consisting of i.i.d .",
    "cscg rvs with zero mean and unit covariance , and @xmath217 is the rician factor set to be 3 .",
    "note that for the los component , we use the far - field uniform linear antenna array model with @xmath218^t$ ] with @xmath219 , where @xmath220 is the spacing between successive antenna elements at the ap , @xmath221 is the carrier wavelength , and @xmath222 is the direction of @xmath20 to the ap .",
    "we set @xmath223 , and @xmath224 .",
    "the average power of @xmath25 is then normalized by @xmath225 in ( [ eqn : pass loss ] ) .      in this subsection",
    ", we investigate the performance of the optimal solution proposed in section [ sec : optimal solution ] . in this numerical result",
    ", we set @xmath226 m , @xmath227 m , @xmath228 m , and @xmath229 m .",
    "specifically , the channels @xmath230 $ ] and @xmath231 $ ] are given by @xmath232.\\end{aligned}\\ ] ]    first , we investigate the impact of @xmath67 on the max - min throughput among @xmath20 s .",
    "let @xmath233 denote the max - min throughput achieved by mmse receivers given the time allocation @xmath78 .",
    "for the purpose of comparison , we also study the max - min throughput achieved by zf receivers , denoted by @xmath234 .",
    "note that @xmath235 . also note that @xmath234 can be obtained by solving problem ( [ eqn : zf problem ] ) with @xmath72 .",
    "[ fig4 ] shows @xmath233 versus @xmath234 over @xmath75 .",
    "it is observed that both @xmath233 and @xmath234 are first increasing and then decreasing over @xmath78 .",
    "the reason is as follows .",
    "it can be observed from ( [ eqn : throughput ] ) that when @xmath78 is small , the available transmit power for users given in ( [ eq : available power ] ) is the dominant factor and thus increasing @xmath67 increases the dl energy transfer time and hence the ul transmit power and throughput .",
    "however , when @xmath78 becomes large , the ul transmission time becomes the limiting factor and as a result increasing @xmath67 decreases the ul transmission time and thus the throughput .",
    "it is also observed that mmse receiver achieves higher throughput than zf receiver for any given @xmath78 .",
    "= 0.8   versus @xmath234.,title=\"fig:\",width=377 ]    = 0.8   versus iteration when @xmath236 with different initial points.,title=\"fig:\",width=377 ]    next , we study the performance of the optimal solutions to problem ( [ equ : common throughput ] ) proposed in section [ sec : optimal solution ] with @xmath236 .",
    "[ fig6 ] shows the convergence performance of algorithm [ table5 ] with different initial points of @xmath52 .",
    "specifically , two initial points of @xmath52 are obtained by solving problem ( [ eqn : maximum energy ] ) with @xmath237 and @xmath238 , @xmath51 , respectively .",
    "it is observed that algorithm [ table5 ] does converge to the optimal solution in only @xmath239-@xmath240 iterations for both initial points .",
    "it is also observed that the initial point of @xmath52 obtained by setting @xmath238 , @xmath51 , in problem ( [ eqn : maximum energy ] ) is better than that obtained by setting @xmath237 , @xmath51 , to make algorithm [ table5 ] converge faster .",
    "the reason is as follows .",
    "when we fix @xmath237 , @xmath51 , in problem ( [ eqn : maximum energy ] ) , in the dl the users more far away from the ap tend to be allocated with less energy , i.e. , incurring the doubly near - far effect in the wpcn .",
    "however , by setting @xmath238 , @xmath51 , the users with poorer channels are assigned with higher priority in the dl power transfer , and thus have more transmit power in the ul information transmission .    .@xmath241 versus @xmath242 [ cols=\"^,^,^\",options=\"header \" , ]     furthermore , to illustrate whether power control is needed in the ul information transmission , i.e. , each user transmits at maximum power or not using the energy harvested from the dl power transfer , we show the values of @xmath241 versus @xmath242 , @xmath51 , in table [ table1 ] , where @xmath142 and @xmath138 denote the optimal solution to problem ( [ equ : common throughput ] ) with @xmath236 .",
    "it is observed that the three users that are nearer to the ap , i.e. , @xmath243 , @xmath244 and @xmath245 , should not transmit at maximum power , and thus in general given the optimal dl energy beams @xmath138 , ul power control is needed to maximize the minimum sinr of all users in problem ( [ equ : common throughput ] ) .",
    "= 0.8     last , we study the impact of the number of antennas at the ap on the max - min throughput performance . in this example , we activate one more antenna among the @xmath200 antennas at each time . fig .",
    "[ fig7 ] shows the max - min throughput achieved by the optimal solution in section [ sec : optimal solution ] versus the number of active antennas at the ap .",
    "note that for the case when there is only one active antenna at the ap , since spatial transmit / receive beamforming can not be utilized , we adopt the tdma based solution proposed in @xcite for the siso wpcn . it is observed from fig .",
    "[ fig7 ] that the max - min throughput increases significantly with the number of active antennas at the ap .",
    "= 0.8     in this subsection , we compare the max - min throughput by the optimal solution in section [ sec : optimal solution ] with mmse receivers and the two suboptimal solutions in section [ a zf - based low - complexity suboptimal solution ] with zf receivers . in this example",
    ", it is assumed that all users are of the same distance to the ap , i.e. , @xmath246 , @xmath51 .",
    "[ fig5 ] shows the max - min throughput over @xmath247 . for the purpose of comparison",
    ", we also plot the max - min throughout achieved by solving problem ( [ eqn : equivalent subooptimal zf ] ) where the energy beams @xmath52 are randomly generated rather than obtained via solving problem ( [ eqn : maximum energy ] ) .",
    "it is observed that the throughput decays drastically as @xmath247 increases for all optimal and suboptimal solutions .",
    "it is also observed that for all values of @xmath247 , the throughput by mmse receiver outperforms those of the three suboptimal solutions by zf receiver .",
    "however , when @xmath247 is small , it is observed that both suboptimal solutions 1 and 2 with zf receiver achieve the throughput very close to the optimal solution with mmse receiver .",
    "this is because in this case the available power for ul transmission is large for all @xmath20 s , and thus zf receiver is asymptotically optimal with high signal - to - noise ratio ( snr ) .",
    "furthermore , it is observed that with zf receiver , suboptimal solution 2 performs very close to suboptimal solution 1 , although it is based on separate optimizations of dl energy beamforming and ul power allocation to achieve lower complexity .",
    "however , if the energy beams are randomly generated instead of via solving problem ( [ eqn : maximum energy ] ) , there is a significant loss in the achieved max - min throughput observed with zf receiver .",
    "this paper has studied a wireless powered communication network ( wpcn ) with multi - antenna ap and single - antenna users . under a harvest - then - transmit protocol",
    ", the minimum throughput among all users is maximized by a joint optimization of the dl - ul time allocation , dl energy beamforming , and ul transmit power allocation plus receive beamforming .",
    "we solve this problem optimally via a two - stage algorithm .",
    "first , we fix the dl - ul time allocation and propose an efficient algorithm to obtain the corresponding optimal dl energy beamforming and ul power allocation plus receive beamforming solution based on the techniques of alternating optimization and non - negative matrix theory . then , the problem is solved by a one - dimension search over the optimal dl - ul time allocation . furthermore , two suboptimal solutions of lower complexity are proposed with zf based receive beamforming , and their performances are compared to the optimal solution .",
    "[ lemma5 ] given any receive beamforming vectors @xmath108 and energy beams @xmath73 , the corresponding optimal power allocation @xmath248 and sinr balancing solution @xmath249 to problem ( [ equ : common throughput ] ) must satisfy the following two conditions :      first , we assume that with @xmath248 , there exists an @xmath253 such that @xmath254 .",
    "then , we can decrease the transmit power of @xmath253 and at the same time keep the transmit power of all other @xmath20 s , @xmath255 , unchanged such that @xmath253 s sinr is reduced but still larger than @xmath249 .",
    "note that this will increase each of other @xmath20 s sinr , @xmath256 , to be larger than @xmath249 , since the interference power from @xmath253 is reduced . as a result",
    ", the minimum sinr of @xmath20 s must be larger than @xmath249 with the new constructed power allocation , which contradicts to the fact that @xmath248 is the optimal power solution to problem ( [ equ : common throughput ] ) .",
    "the first part of lemma [ lemma5 ] is thus proved .    next , we assume that with @xmath248 , all the individual power constraints are not tight in ( [ equ : common throughput ] ) , i.e. , @xmath257 , @xmath51 . in this case , define @xmath258 .",
    "then , consider the new power solution @xmath259 , which satisfies all the individual power constraints in problem ( [ equ : common throughput ] ) .",
    "since @xmath260 holds @xmath261 , @xmath51 , the minimum sinr of all @xmath20 s must be increased with the new constructed power solution @xmath262 , which contradicts to the fact that @xmath248 is the optimal power solution to problem ( [ equ : common throughput ] ) .",
    "the second part of lemma [ lemma5 ] is thus proved .",
    "we can express ( [ equ : equal sinr balancing level ] ) for all @xmath83 s in the following matrix form:@xmath263therefore , given any @xmath108 and @xmath73 , the optimal power allocation @xmath248 and sinr balancing solution @xmath249 to problem ( [ equ : common throughput ] ) must satisfy              note that if the sum - power constraint of all users is considered instead , a similar result to lemma [ lemma3 ] has been shown in theorem 1 of @xcite . in the following ,",
    "we extend this result to the case with users individual power constraints .",
    "suppose that there exist two different solutions to equations ( [ eqn1 ] ) and ( [ eqn2 ] ) , denoted by @xmath265 and @xmath266 , respectively . define a sequence of @xmath267 s as @xmath268 , @xmath269 .",
    "we can without loss of generality re - arrange @xmath267 s in a decreasing order by@xmath270since according to ( [ eqn2 ] ) we have @xmath271 , it follows that @xmath272 must hold .",
    "hence , @xmath273 .",
    "moreover , in ( [ eqn : sequence ] ) , at least one inequality must hold with a strict inequality sign because otherwise @xmath274 , @xmath51 , which then implies that only one unique solution to equations ( [ eqn1 ] ) and ( [ eqn2 ] ) exists .",
    "next , we derive the sinr balancing value of @xmath275 as follows:@xmath276based on ( [ equ : equal sinr balancing level ] ) , we have @xmath277similarly , we can show that @xmath278 , which yields@xmath279since ( [ eqn : greater ] ) and ( [ eqn : less ] ) contradict to each other , there must exist one unique solution to equations ( [ eqn1 ] ) and ( [ eqn2 ] ) .",
    "lemma [ lemma3 ] is thus proved .    according to lemma [ lemma3 ]",
    ", there exists a unique solution @xmath265 to equations ( [ eqn1 ] ) and ( [ eqn2 ] ) ; hence , this solution must be the unique solution that can satisfy ( [ eqn1 ] ) , ( [ eqn2 ] ) , and ( [ eqn3 ] ) simultaneously , and thus is optimal to problem ( [ equ : common throughput ] ) .",
    "this indicates that given any @xmath264 and @xmath110 , to find the corresponding optimal power and sinr balancing solution to problem ( [ equ : common throughput ] ) , it is sufficient to study the unique solution to equations ( [ eqn1 ] ) and ( [ eqn2 ] ) .",
    "next , we further investigate the properties of equations ( [ eqn1 ] ) and ( [ eqn2 ] ) . by multiplying both sides of ( [ eqn1 ] ) by @xmath280",
    ", we have @xmath281 therefore , by combining ( [ eqn1 ] ) and ( [ equ : power constraint ] ) , it follows that @xmath282where @xmath283 and @xmath284 is given in ( [ eqn : matrix ak ] ) with @xmath285 .    according to perron - frobenius theory @xcite , for any nonnegative matrix",
    ", there is at least one positive eigenvalue and the spectral radius of the matrix is equal to the largest positive eigenvalue .",
    "furthermore , according to lemma [ lemma3 ] , there is only one strictly positive eigenvalue to matrix @xmath284 .",
    "accordingly , it follows from ( [ equ : matrix form2 ] ) that given @xmath264 and @xmath110 , the inverse of the optimal sinr balancing solution @xmath286 is the spectral radius of @xmath284 . in other words",
    ", we have @xmath287    given @xmath264 and @xmath110 , ( [ eqn : spectral radius1 ] ) relates the optimal sinr balancing solution of problem ( [ equ : common throughput ] ) to the spectral radius of the matrix @xmath284 .",
    "finally , we find @xmath288 as follows .",
    "note that the optimal power allocation @xmath248 and sinr balancing solution @xmath249 to problem ( [ equ : common throughput ] ) satisfy ( [ eqn1 ] ) , ( [ eqn2 ] ) , and ( [ eqn3 ] ) . we express",
    "the above conditions into @xmath19 sets of conditions , with the @xmath83th set of conditions given by @xmath289by multiplying both sides of ( [ eqn1 ] ) by @xmath290 , the power constraint for @xmath20 can be further expressed as @xmath291therefore , ( [ eqn : user k ] ) can be equivalently expressed in the matrix form as @xmath292note that ( [ eqn : matrix k ] ) holds regardless of @xmath83 .",
    "[ lemma4 ] ( * ? ? ?",
    "* theorem 1.6)[lem : non - negative matrix ] let @xmath87 be a non - negative irreducible matrix , @xmath221 a positive number , and @xmath293 , @xmath294 , a vector satisfying @xmath295 then @xmath296 . moreover , @xmath297 if and only if @xmath298 , and in this case @xmath10 is the dominant eigenvector of @xmath87 .      by combining ( [ eqn : spectral radius1 ] ) and",
    "( [ eqn : active power constraint ] ) , ( [ eqn : optimal sinr balancing value ] ) is proved . moreover , according to ( [ equ : matrix form2 ] ) , if @xmath283 is the dominant eigenvector of @xmath284 , then @xmath248 is the optimal power solution to problem ( [ equ : common throughput ] ) given @xmath264 and @xmath110 .",
    "theorem [ theorem1 ] is thus proved .",
    "consider the following problem : @xmath302where @xmath303^t$ ] . according to lemma",
    "[ lemma4 ] , the first set of @xmath19 constraints and @xmath304 indicate that any feasible solution @xmath305 to problem ( [ eqn : downlink equivalent expression ] ) satisfies @xmath306 , @xmath51 . in other words",
    ", the minimum @xmath307 equals to @xmath308 . as a result ,",
    "problem ( [ eqn : downlink equivalent expression ] ) is equivalent to problem ( [ eqn : downlink ] ) .",
    "it can be shown that problem ( [ eqn : downlink equivalent expression ] ) can be further expressed in the following form : @xmath309_{i , j}\\frac{q_j}{q_i \\theta}+y_i(\\bar{{\\mbox{\\boldmath{$ w $ } } } } ) \\frac{q_{k+1}}{q_i \\theta } \\leq 1 , ~ 1\\leq i \\leq k , \\nonumber \\\\ & ~~ \\sum\\limits_{j=1}^k[{\\mbox{\\boldmath{$ e $ } } } _ k^t{\\mbox{\\boldmath{$ x $ } } } ( \\bar{{\\mbox{\\boldmath{$ w $ } } } } ) ] _ j\\frac{q_j}{q_{k+1 } \\theta}+{\\mbox{\\boldmath{$ e $ } } } _ k^t{\\mbox{\\boldmath{$ y $ } } } ( \\bar{{\\mbox{\\boldmath{$ w $ } } } } ) \\frac{1 } { \\theta } \\leq \\frac{\\epsilon \\bar{\\tau}{\\rm tr}({\\mbox{\\boldmath{$ g $ } } } _ k{\\mbox{\\boldmath{$ s $ } } } ) } { 1-\\bar{\\tau } } , ~ 1\\leq k \\leq k , \\nonumber \\\\ & ~~ { \\rm tr}({\\mbox{\\boldmath{$ s $ } } } ) \\leq p_{{\\rm sum } } , \\nonumber \\\\ & ~~ { \\mbox{\\boldmath{$ s $ } } } \\succeq { \\mbox{\\boldmath{$ 0 $ } } } .",
    "\\end{aligned}\\ ] ]    for any scalar @xmath310 , let @xmath311 .",
    "moreover , define @xmath312^t$ ] , @xmath51 .",
    "then , it can be shown that problem ( [ eqn : downlink equivalent gp ] ) is equivalent to problem ( [ eqn : downlink equivalent convex problem ] ) .",
    "proposition [ proposition1 ] is thus proved .",
    "let @xmath313 denote the solution obtained by algorithm [ table5 ] .",
    "according to algorithm [ table5 ] , @xmath313 satisfies : 1 . given @xmath314",
    ", @xmath315 is the optimal solution to problem ( [ eqn : uplink ] ) ; and 2 . given @xmath316 , @xmath317 is the optimal solution to problem ( [ eqn : downlink ] ) .",
    "furthermore , define @xmath318 , and @xmath319 as the dominant eigenvector of the matrix @xmath320 ; then @xmath321 is the optimal power solution to problem ( [ equ : common throughput ] ) given @xmath316 and @xmath314 according to theorem [ theorem1 ] .",
    "according to the definition of @xmath330 s given in ( [ eqn : matrix ak ] ) , we have @xmath331where @xmath332 and @xmath333 are given in ( [ equ : sinr in simo - ic ] ) and ( [ eq : available power ] ) , respectively , @xmath51 .",
    "it is worth noting that @xmath315 is the optimal mmse receiver corresponding to the power allocation @xmath196 , as shown in @xcite , @xcite , which maximizes @xmath332 , @xmath51 . as a result , according to ( [ eqn : a3 ] ) , given any @xmath52 we have @xmath334it then follows @xmath335since ( [ eqn : a5 ] ) holds for all @xmath52 , it follows that @xmath336note that given @xmath316 and @xmath314 , @xmath337 is the dominant eigenvector of @xmath320 , i.e. , @xmath338we thus have @xmath339 , @xmath51 . as a result , with @xmath316 , ( [ eqn : a3 ] ) can be further simplified as @xmath340    next , consider the special case of @xmath314 .",
    "since given @xmath315 and @xmath317 , @xmath196 is the optimal power solution to problem ( [ equ : common throughput ] ) , ( [ eqn2 ] ) and ( [ eqn3 ] ) must hold , i.e. , @xmath341 if @xmath342 , and @xmath343 otherwise . as a result",
    ", it follows that @xmath344thus , we have @xmath345 because @xmath346 if @xmath347 . according to ( [ eqn : a6 ] )",
    ", it thus follows that @xmath348    next , we show @xmath349 by contradiction .",
    "assume that @xmath350 .",
    "in this case , there exists at least a @xmath351 such that @xmath352 . according to ( [ eqn : a8 ] )",
    ", it follows that @xmath353 , @xmath51 .",
    "this indicates that @xmath354according to lemma [ lemma4 ] , it follows from ( [ eqn : a11 ] ) that @xmath355 , @xmath51 . in other words",
    ", we have @xmath356 , which contradicts to the fact that given @xmath315 , @xmath317 is the optimal solution to problem ( [ eqn : downlink ] ) .",
    "therefore , we have @xmath349 .",
    "last , by combining ( [ eqn : a1 ] ) and ( [ eqn : a2 ] ) , we have @xmath357 .",
    "moreover , @xmath358 also holds . to summarize",
    ", we have @xmath359 , i.e. , the solution @xmath313 achieves the optimal value of problem ( [ eqn : equivalent problem ] ) .",
    "theorem [ theorem2 ] is thus proved .",
    "y. huang , c. w. tan , and b. d. rao , `` joint beamforming and power constrol in coordinated multicell : max - min duality , effective network and large system transition , '' _ ieee trans . on wireless commun .",
    "12 , no . 6 , pp . 2730 - 2742 , jun . 2013",
    ".      s. vishwanath , n. jindal , and a. goldsmith , `` duality , achievable rates , and sum - rate capacity of gaussian mimo broadcast channels , '' _ ieee trans .",
    "inf . theory _ ,",
    "2658 - 2668 , oct .",
    "2003 .",
    "l. zhang , r. zhang , y. c. liang , y. xin , and h. v. poor , `` on the gaussian mimo bc - mac duality with multiple transmit covariance constraints , '' _ ieee trans .",
    "inf . theory _",
    "2064 - 2079 , apr . 2012 .",
    "j. xu , l. liu , and r. zhang , `` multiuser miso beamforming for simultaneous wireless information and power transfer , '' in _ proc .",
    "ieee international conference on acoustics , speech , and signal processing ( icassp ) _"
  ],
  "abstract_text": [
    "<S> the newly emerging wireless powered communication networks ( wpcns ) have recently drawn significant attention , where radio signals are used to power wireless terminals for information transmission . in this paper </S>",
    "<S> , we study a wpcn where one multi - antenna access point ( ap ) coordinates energy transfer and information transfer to / from a set of single - antenna users . </S>",
    "<S> a harvest - then - transmit protocol is assumed where the ap first broadcasts wireless power to all users via energy beamforming in the downlink ( dl ) , and then the users send their independent information to the ap simultaneously in the uplink ( ul ) using their harvested energy . to optimize the users throughput and yet guarantee their rate fairness , we maximize the minimum throughput among all users by a joint design of the dl - ul time allocation , the dl energy beamforming , and the ul transmit power allocation plus receive beamforming . </S>",
    "<S> we solve this non - convex problem optimally by two steps . </S>",
    "<S> first , we fix the dl - ul time allocation and obtain the optimal dl energy beamforming , ul power allocation and receive beamforming to maximize the minimum signal - to - interference - plus - noise ratio ( sinr ) of all users . </S>",
    "<S> this problem is shown to be in general non - convex ; however , we convert it equivalently to a spectral radius minimization problem , which can be solved efficiently by applying the alternating optimization based on the non - negative matrix theory . then , the optimal time allocation is found by a one - dimension search to maximize the minimum rate of all users . </S>",
    "<S> furthermore , two suboptimal designs of lower complexity are proposed , and their throughput performance is compared against that of the optimal solution .    wireless power transfer , energy beamforming , wireless powered communication , non - negative matrix theory .    </S>",
    "<S> [ section ] [ section ] [ section ] [ section ] [ section ] [ section ] [ section ] [ section ] </S>"
  ]
}