{
  "article_text": [
    "in this paper we study the cycle structure of random permutations in which the lengths of all cycles are constrained to lie in some infinite set @xmath0 , and permutations may be made more or less likely to be chosen through multiplicative weights placed on their cycles .",
    "cycle structures viewed in this manner are a special case of certain measures on @xmath8 which are conjugation - invariant and assign a weight to each element of @xmath8 based on its cycle structure .",
    "[ def : weighting - sequence ] let @xmath9 be an infinite sequence of nonnegative real numbers .",
    "then the _ weight _ of the permutation @xmath10 , with respect to @xmath11 , is @xmath12 where @xmath13 is the number of cycles of length @xmath14 in @xmath15 .",
    "informally , each cycle in a permutation receives a weight depending on its length , and the weight of a permutation is the product of the weights of its cycles .",
    "the sequence @xmath11 is called a _ weighting sequence_.    for each positive integer @xmath7 , let @xmath16 be a probability space defined as follows . take @xmath17 , the set of permutations of @xmath2 $ ] , and let @xmath18 be the set of all subsets of @xmath8 . endow @xmath16 with a probability measure @xmath19 for each weighting sequence @xmath11 as follows .",
    "let @xmath20 ; that is , each permutation has probability proportional to its weight .",
    "extend @xmath19 to all subsets of @xmath8 by additivity . to streamline the notation ,",
    "we will sometimes write @xmath21 for @xmath22 . the sum of the weights of @xmath11-weighted permutations of @xmath2 $ ] is @xmath23 \\exp \\left ( \\sum_{k \\ge 1 } \\sigma_k z^k / k \\right)\\ ] ] by the exponential formula for labelled combinatorial structures .",
    "we fix some notation .",
    "define the random variable @xmath24 by setting @xmath25 equal to the number of @xmath26-cycles in the permutation @xmath15 .",
    "let @xmath27 be the total number of cycles .",
    "we will often suppress @xmath15 and @xmath28 in the notation , and we will write ( for example ) @xmath29 as an abbreviation for @xmath30 . let @xmath31 .",
    "we define @xmath32 in order to simplify the statement of some results .",
    "this model incorporates various well - known classes of permutations , including generalized derangements ( permutations in which a finite set of cycle lengths is prohibited ) , and the ewens sampling formula from population genetics @xcite , which corresponds to the weighting sequence @xmath33 .",
    "if @xmath11 is a 0 - 1 sequence with finitely many 1s , then this model specializes to random permutations of which all cycle lengths lie in a finite set .",
    "these have a fascinating structure studied by benaych - georges @xcite and timashev @xcite ; a typical permutation of @xmath2 $ ] with cycle lengths in a finite set @xmath0 has about @xmath34 @xmath26-cycles , for each @xmath26 in @xmath0 . in particular , most cycles are of length @xmath35 , which may be unexpected at first glance .",
    "analytically , this situation is studied via the asymptotics of @xmath36 e^{p(z)}$ ] where @xmath37 is a polynomial , as done by wilf @xcite .",
    "yakymiv @xcite has studied the case , alluded to by bender @xcite , in which @xmath11 is a sequence of @xmath38s and @xmath39s with a fixed density @xmath1 of @xmath39s ; the behavior of such permutations is in broad outline similar to that of the ewens sampling formula with parameter @xmath1 .",
    "an `` enriched '' version of the model has been studied by ueltschi and coauthors @xcite . in their model",
    ", permutations are endowed with a spatial structure .",
    "each element of the ground set of the permutation is a point in the plane , and weights involve distances between points . their `` simple model of random permutations with cycle weight '' ( * ? ? ?",
    "2 ) is the model used here , where @xmath40 .",
    "there are other combinatorially interesting conjugation - invariant measures on @xmath8 , including permutations with all cycle lengths distinct @xcite , and permutations with @xmath26th roots for some fixed @xmath26 @xcite .",
    "however the generating functions counting these classes are not exponentials of `` nice '' functions and thus different techniques are required .    throughout this paper",
    ", we often implicitly assume that permutations under the uniform measure on @xmath8 are the `` primitive '' structure , and weighted permutations are a perturbation of these .",
    "here we follow arratia _ et al . _ in @xcite , in embracing a similar philosophy and viewing the permutation as the archetype of a class of `` logarithmic combinatorial structures '' , and flajolet and soria s definition of functions of logarithmic type @xcite .",
    "it will be convenient to use bivariate generating functions which count permutations by their size and number of cycles .",
    "in general , we take @xmath41 to be the bivariate generating function , exponential in @xmath42 and ordinary in @xmath43 , of a combinatorial class @xmath44 , where @xmath45 is the number of objects in @xmath44 of size @xmath7 and with a certain parameter equal to @xmath26 . in our case @xmath7",
    "will be the number of elements of a permutation , and @xmath26 the total number of cycles or the number of cycles of a specified size .",
    "then @xmath36 \\left . {",
    "\\partial \\over \\partial u } f(z ,",
    "u ) \\right|_{u=1 } / [ z^n ] f(z,1)$ ] gives the expected value of the parameter @xmath26 for an object of size @xmath7 selected uniformly at random .",
    "the following lemma will frequently be useful , as it reduces the bivariate analysis to a univariate analysis .",
    "[ fundamental - lemma ] let @xmath46 be the exponential generating function of permutations with weight sequence @xmath11 .",
    "then the expected number of @xmath26-cycles in a permutation chosen according to the measure @xmath19 is @xmath47 f(z ) \\over [ z^n ] f(z)}.\\ ] ]    the bivariate generating function counting the cycles of such permutations is @xmath48 and this can be rewritten as @xmath49 .",
    "thus , from the exponential formula , the bivariate generating function counting such permutations is @xmath50 the expected number of cycles in a random permutation is @xmath36 p_u(z,1)/[z^n ] p(z,1)$ ] , giving the result .",
    "the structure of this paper is as follows . in section 2",
    "we give exact formulas and asymptotic series ( propositions [ ewens - exp - cycles ] and [ ewens - var - cycles ] ) for the mean and variance of the number of cycles of permutations chosen from the ewens distribution .",
    "we also consider the average number of @xmath26-cycles in such permutations of @xmath2 $ ] for fixed @xmath26 ( propositions [ prop - ewens - exp - k - cycles ] and [ ewens - asympt - k - cycles ] ) and for @xmath51 ( proposition [ ewens - asympt - alpha - n - cycles ] ) . an `` integrated '' version of these results , theorem [ bulk - profile - general ] , is one of the main results ; this is a limit law for the probability that a random element of a weighted permutation is in a cycle within a certain prescribed range of lengths . in section 3",
    "we derive similar results for permutations in which all cycle lengths have the same parity .",
    "in addition , we determine the mean and variance of the number of cycles of such permutations ( theorem [ thm - mean - cycles - odd ] treats the odd case , and theorem [ thm - mean - cycles - even ] treats the even case ) . in section 4",
    "we explore connections to the generation of random objects by boltzmann sampling .",
    "the main theorem of this section , theorem [ thm - boltzmann - concentrated ] , states that the boltzmann - sampled permutations of a certain class of approximate size @xmath7 , including the ewens and parity - constrained cases , have their number of cycles distributed with mean and variance approximately a constant multiple of @xmath52 .",
    "the _ ewens distribution _ @xcite on permutations of @xmath2 $ ] with parameter @xmath1 gives to each permutation @xmath15 probability proportional to @xmath53 .",
    "this corresponds to the weighting sequence @xmath54 ; we will write @xmath55 for @xmath56 , and call a random permutation selected in this manner a _ @xmath1-weighted permutation_. in this section we derive formulas for the mean and variance of the number of cycles of permutations chosen from the ewens distribution .",
    "note that the number of cycles can be decomposed into a sum of independent bernoulli random variables .",
    "similar decompositions are due to arratia et al . in (",
    "5.2 ) for general @xmath1 , and feller ( * ? ? ?",
    "* ( 46 ) ) for @xmath57 ; the fact that the number of cycles is normally distributed is seen in ( * ? ? ?",
    "* example 1 ) .",
    "thus this section is largely expository ; the proofs are provided for the purpose of comparison with other proofs to be given below .",
    "the asymptotic series for @xmath58 and @xmath59 appear to be new .",
    "[ ewens - bernoulli ] ( * ? ? ?",
    "* exercise 3.2.3 ) the distribution of the random variable @xmath60 under the measure @xmath61 is that of the sum @xmath62 , where the @xmath63 are independent random variables and @xmath63 has the bernoulli distribution with mean @xmath64 .",
    "the generating function of permutations of @xmath2 $ ] counted by their number of cycles is @xmath65 , where @xmath66 are the stirling cycle numbers .",
    "replacing @xmath43 with @xmath67 and normalizing gives the probability generating function for the number of cycles , @xmath68 and each factor is the probability generating function for a bernoulli random variable .",
    "combinatorially , we can envision this bernoulli decomposition as follows .",
    "we imagine forming a permutation of @xmath2 $ ] by placing the elements @xmath69 in cycles in turn . when the element @xmath26 is inserted , with probability @xmath64 it is placed in a new cycle , and with probability @xmath70 it is placed after any of @xmath71 in the cycle containing that element .",
    "then the probability of obtaining any permutation with @xmath72 cycles is @xmath73 , which is exactly the measure given to this permutation by @xmath74 .",
    "this is an instance of the chinese restaurant process ( * ? ? ?",
    "3.1 ) .    from this decomposition into bernoulli random variables , we can derive formulas for the mean and variance of the number of cycles under the measure @xmath74 .",
    "in particular we note that since @xmath60 is a sum of bernoulli random variables with small mean , the variance of @xmath60 is very close to its mean .",
    "let @xmath75 denote the digamma function @xmath76 ; this has an asymptotic series @xmath77 as @xmath78 .",
    "let @xmath79 be the @xmath7th harmonic number and let @xmath80 be the euler - mascheroni constant .",
    "[ ewens - exp - cycles ] the expected number of cycles of a random @xmath1-weighted permutation of @xmath2 $ ] is @xmath81 ; in particular if @xmath1 is a positive integer we have @xmath82    from theorem [ ewens - bernoulli ] we have @xmath83 now , @xmath84 ; thus @xmath85 this proves that @xmath86 .",
    "the asymptotic series follows from that for @xmath87 where we have used the fact that @xmath88 when @xmath7 is a positive integer .",
    "[ ewens - var - cycles ] the variance of the number of cycles of a random @xmath1-weighted permutation of @xmath2 $ ] is @xmath89    this has an asymptotic series , @xmath90    the proof is similar to that of the previous proposition , noting that the variance of a bernoulli random variable with mean @xmath91 is @xmath92 .    from ( [ ewens - var - series ] )",
    "we can also derive for integer @xmath1 the explicit formula ( not involving @xmath75 ) @xmath93 which holds as @xmath94 .",
    "it suffices to show that @xmath95 to see this , recall the identity @xmath96 ; differentiating gives @xmath97 .",
    "summation over @xmath98 gives ( [ eq : feb-24-iota ] ) .",
    "finally , we recall a normal distribution result for the total number of cycles ( * ? ? ? * ( 5.22 ) ) .",
    "let @xmath99 be the standardization of @xmath60",
    ". then @xmath100 , where @xmath101 is the cumulative distribution function of a standard normal random variable .",
    "this follows from theorem [ ewens - bernoulli ] and the lindeberg - feller central limit theorem .",
    "we have thus far looked at the total number of cycles of @xmath1-weighted permutations .",
    "these distributions , suitably scaled , are continuous in the large-@xmath7 limit .",
    "in contrast , looking at each cycle length separately , we approach a discrete distribution .",
    "more specifically , the number of @xmath26-cycles of @xmath1-weighted permutations of @xmath2 $ ] , for large @xmath7 , converges in distribution to @xmath102 , where @xmath103 denotes a poisson random variable with mean @xmath104 ; here we consider how quickly @xmath105 approaches @xmath106 .",
    "recall that @xmath107 is a random variable , with @xmath108 the number of @xmath26-cycles of a permutation @xmath15 .",
    "[ prop - ewens - exp - k - cycles ] ( * ? ? ?",
    "* ( 37))@xcite the average number of @xmath26-cycles in a @xmath1-weighted permutation of @xmath2 $ ] is @xmath109 where @xmath110 is the `` falling power '' .",
    "we provide a new proof in terms of generating functions .",
    "the bivariate generating function counting @xmath1-weighted permutations by their size and number of @xmath26-cycles is @xmath111 .",
    "the mean number of @xmath26-cycles is given by @xmath112 \\left .",
    "\\partial_u p(z , u ) \\right|_{u=1 } \\over [ z^n ] p(z,1 ) } = { [ z^n ] { \\sigma z^k \\over k } ( 1-z)^{-u\\sigma } \\over [ z^n ] ( 1-z)^{-\\sigma } } = { \\sigma \\over k } { [ z^{n - k}](1-z)^{-\\sigma } \\over [ z^n ] ( 1-z)^{-\\sigma}}\\ ] ] and the binomial formula gives ( [ ewens - exp - k - cycles ] ) .    when @xmath1 is an integer , a combinatorial proof can be obtained by considering @xmath1-weighted permutations as permutations where each cycle is colored in one of @xmath1 colors .",
    "[ ewens - asympt - k - cycles ] there is an asymptotic series for @xmath105 , @xmath113    the numerator and denominator of ( [ ewens - exp - k - cycles ] ) are polynomials in @xmath7 of degree @xmath26 ; write the two highest - degree terms of each explicitly and divide .",
    "[ ewens - asympt - alpha - n - cycles ] fix @xmath114 .",
    "the expected number of elements in @xmath115-cycles of a random @xmath1-weighted permutation satisfies , as @xmath94 , @xmath116    ( here we have assumed for simplicity that @xmath115 is an integer . )    let @xmath117 .",
    "we have from proposition [ prop - ewens - exp - k - cycles ] that @xmath118 we now note that @xmath119 , for constant @xmath120 as @xmath94 , from stirling s formula . applying this twice with @xmath121",
    "gives the result .",
    "it would be of interest to determine the limiting distribution of the number of cycles with length between @xmath5 and @xmath122 for constants @xmath123 and @xmath124 .",
    "there can be at most @xmath125 such cycles , so this random variable is supported on @xmath126 .",
    "thus to determine the limiting distribution it suffices to determine the 0th through @xmath125th moments of this random variable .",
    "the @xmath57 case will be treated in @xcite .",
    "we can essentially integrate the result of proposition [ ewens - asympt - k - cycles ] to determine the number of elements in cycles with normalized length in a specified interval .",
    "however , this can be done in a more general framework . following ( * ? ? ?",
    "vi.1 ) and ( * ? ? ?",
    "1 ) , for constants @xmath127 and @xmath128 we define a @xmath129-domain as a set of the form @xmath130    [ bulk - profile - general ] let @xmath131 be analytic in its intersection with some @xmath129-domain , for some constants @xmath1 and @xmath132 .",
    "then the probability that a uniformly chosen random element of a random @xmath11-weighted permutation of @xmath2 $ ] lies in a cycle of length between @xmath5 and @xmath122 approaches @xmath133 as @xmath94",
    ".    note that analyticity in the slit plane suffices ; this is the case @xmath134 .",
    "we begin by stating two lemmas needed in the proof .",
    "[ bulk - profile - sum ] let @xmath135 be a sequence of nonnegative real numbers with mean @xmath1 .",
    "fix constants @xmath136 .",
    "then @xmath137    we rewrite the sum as an integral , @xmath138 where @xmath139 .",
    "integrating by parts gives @xmath140 differentiation allows us to rewrite the integral in ( [ bulk - profile - sum-1 ] ) as a riemann integral , @xmath141 let @xmath142 .",
    "then the integral on the right - hand side of ( [ bulk - profile - sum-2 ] ) becomes @xmath143 we perform the first integral in ( [ bulk - profile - sum-3 ] ) and note that @xmath144 in ( [ bulk - profile - sum-1 ] ) .",
    "this gives @xmath145 so it suffices to show that the final term in ( [ bulk - profile - sum-4 ] ) is negligible , i. e. @xmath146 since @xmath135 has mean @xmath1 , we have @xmath147 .",
    "thus @xmath148 .",
    "on @xmath149 $ ] , @xmath150 is bounded .",
    "so the integrand above is @xmath151 , and the integral is @xmath152 as desired .",
    "[ bulk - profile - ratio ] say @xmath36 p(z ) = cn^{\\sigma-1 } ( 1 + o(1))$ ] uniformly in @xmath7 , for some positive constants @xmath153 .",
    "then @xmath154 p(z ) \\over [ z^n ] p(z ) } \\sim \\sum_{k = \\lceil \\gamma n \\rceil}^{\\lfloor \\delta n \\rfloor } \\sigma_k \\left ( 1 - { k \\over n } \\right)^{\\sigma-1}\\ ] ] as @xmath94 , for any @xmath155 .    from the hypothesis that @xmath36p(z ) \\sim cn^{\\sigma-1}$ ] , we get @xmath156 p(z ) \\over [ z^n ] p(z ) } \\sim { c(n - k)^{\\sigma-1 } \\over cn^{\\sigma-1 } } = \\left ( 1 - { k \\over n } \\right)^{\\sigma-1}\\ ] ] uniformly as @xmath157 with @xmath158",
    ". therefore @xmath159 p(z ) \\over [ z^n ] p(z ) } & = & \\sum_{k = \\lceil \\gamma n \\rceil}^{\\lfloor \\delta n \\rfloor } \\sigma_k \\left ( 1 - { k \\over n } \\right)^{\\sigma-1 } ( 1 + o(1 ) ) \\\\ & = & \\sum_{k = \\lceil \\gamma n \\rceil}^{\\lfloor \\delta n \\rfloor } \\sigma_k \\left ( 1 - { k \\over   n } \\right)^{\\sigma-1 } + \\sum_{k = \\lceil \\gamma n \\rceil}^{\\lfloor \\delta n \\rfloor } \\sigma_k \\cdot o(1 ) \\cdot \\left ( 1 - { k \\over n } \\right)^{\\sigma-1}. \\label{foo } \\end{aligned}\\ ] ] the first sum in the previous equation is @xmath160 .",
    "the second sum has @xmath160 terms ; since @xmath161 and @xmath162 can both be bounded above on the interval @xmath149 $ ] each term is @xmath163 .",
    "thus the second sum is @xmath151 .",
    "so @xmath159 p(z ) \\over [ z^n ] p(z ) } & = & \\sum_{k = \\lceil \\gamma n \\rceil}^{\\lfloor \\delta",
    "n \\rfloor } \\left ( \\sigma_k \\left ( 1 - { k \\over n } \\right)^{\\sigma-1 } \\right ) + o(n ) \\\\ & = & \\sum_{k = \\lceil \\gamma n \\rceil}^{\\lfloor \\delta n \\rfloor } \\left ( \\sigma_k \\left ( 1 - { k \\over n } \\right)^{\\sigma-1 } \\right ) ( 1 + o(1 ) ) \\end{aligned}\\ ] ] as desired .",
    "this probability can be written as @xmath164 p(z ) \\over [ z^n ] p(z)}.\\ ] ] now , recall @xmath165 by hypothesis .",
    "thus the generating function @xmath166 of @xmath11-weighted permutations is @xmath167 applying the flajolet - odlyzko transfer theorem @xcite , @xmath36 p(z ) = cn^{\\sigma-1 } ( 1+o(1))$ ] for some positive real constant @xmath168 .",
    "thus @xmath166 satisfies the hypotheses of lemma [ bulk - profile - ratio ] . applying that lemma",
    ", we see that this sum is asymptotic to @xmath169 ; the desired result then follows from lemma [ bulk - profile - sum ] .    the hypotheses , and hence the conclusions , of theorem [ bulk - profile - general ] hold for many weight sequences @xmath170 with @xmath171 ; that is , for weight sequences averaging @xmath1 .",
    "in particular , we have the following special case .    [ bulk - profile - ewens ] fix constants @xmath172 .",
    "let @xmath173 be the probability that the element @xmath39 , in a @xmath1-weighted permutation of @xmath2 $ ] , lies in a cycle of length in the interval @xmath149 $ ] .",
    "then @xmath174    we have the cycle generating function @xmath175 ; apply theorem [ bulk - profile - general ] .",
    "for example , setting @xmath176 , we see that for large @xmath7 , 10% of elements of @xmath3-weighted permutations are in cycles of length at least @xmath177 . if we define the `` co - length '' of a cycle of a permutation to be the number of elements _ not _ in that cycle , a cleaner statement of the theorem becomes possible .",
    "the proportion of elements of @xmath1-weighted permutations in cycles of co - length at most @xmath178 is @xmath179",
    ".    it would be desirable to replace the condition in the hypothesis of theorem [ bulk - profile - general ] with the less restrictive @xmath180 it seems likely that this suffices to prove a limit law but the proof does not easily adapt to that case .",
    "this section is devoted to results on random permutations in which all cycle lengths have the same parity ; that is , they are either all even or all odd .",
    "we adopt the notation @xmath181 for the family of measures @xmath19 where @xmath182 , and similarly @xmath183 for the family with @xmath184 ; these are the measures corresponding to permutations with all cycle lengths even and with all cycle lengths odd , respectively .",
    "the results obtained here resemble those for the ewens sampling formula with parameter @xmath3 .",
    "a heuristic explanation for this phenomenon is as follows .",
    "let us produce a permutation of @xmath2 $ ] from the ewens distribution with parameter @xmath3 by first picking a permutation @xmath15 uniformly at random from @xmath8 , and then flipping a fair coin for each cycle of @xmath15 .",
    "if all the coins come up heads we keep @xmath15 ; otherwise we `` throw back ''",
    "the permutation @xmath15 and repeat this process until we have a trial in which all coins come up heads .",
    "the number and normalized size of cycles of permutations obtained in this manner should be similar to those of permutations with all cycle lengths even , since for large permutations the parity constraint is essentially equivalent to a coin flip .",
    "[ exp - k - cycles - even ] the expected number of elements in @xmath26-cycles of a permutation of @xmath2 $ ] with all cycle lengths even is @xmath185 if @xmath26 is even , and 0 if @xmath26 is odd .    by lemma [ fundamental - lemma ]",
    ", we have @xmath186 ( 1-z^2)^{-1/2 } / [ z^n ] ( 1-z^2)^{-1/2}}$ ] ; we apply the binomial theorem and simplify .    for example , when @xmath187 we have @xmath188 and we observe that most entries are in the longer cycles . for @xmath189",
    "this is illustrated in the figure above .",
    "[ figure - even-100 ]     for @xmath190,scaledwidth=50.0% ]    .",
    "[ exp - k - cycles - odd ] the expected number of elements in @xmath26-cycles of a random permutation of @xmath2 $ ] with all cycle lengths odd is @xmath191    the generating function of permutations with all cycle lengths odd , counted by their number of cycles , is @xmath192 .",
    "we use lemma [ fundamental - lemma ] to see that the mean number of elements in @xmath26-cycles is given by @xmath193 \\sqrt{1+z \\over 1-z } / [ z^n ] \\sqrt{1+z \\over 1-z}}.$ ] we recall that @xmath36 \\sqrt{1+z \\over 1-z}$ ] is @xmath194 if @xmath7 is even and @xmath195 if @xmath7 is odd ; substituting and simplifying gives the result .    by similar methods , we can obtain formulas for the exact number of permutations of @xmath2 $ ] with all cycle lengths divisible by @xmath196 , and the exact expected number of @xmath26-cycles in such permutations for integers @xmath26 which are divisible by @xmath196 .",
    "these permutations have exponential generating function @xmath197 .",
    "permutations with all cycle lengths congruent to @xmath26 mod @xmath196 for some nonzero @xmath26 are more difficult to deal with , as it appears that the generating function can not be written in an elementary form except when @xmath196 is even and @xmath198 .",
    "( see ( * ? ? ?",
    "5.0.3 ) for the relevant generating functions . )",
    "[ asymp - exp - k - cycles - odd ]    1 .",
    "the number of elements of @xmath26-cycles in a permutation of @xmath2 $ ] with all cycle lengths odd , for fixed odd @xmath26 , satisfies @xmath199 as @xmath7 approaches @xmath200 through even values , and @xmath201 as @xmath7 approaches @xmath200 through odd values .",
    "2 .   the number of elements of @xmath26-cycles in a permutation of @xmath2 $ ] with all cycle lengths even , for fixed even @xmath26 , satisfies @xmath202 as @xmath7 approaches infinity through even values .    to prove ( a ) , from proposition [ exp - k - cycles - odd ] we have previous formulas for @xmath203 depending on the parity of @xmath7 .",
    "these are fractions which have numerators and denominators which are polynomials in @xmath7 ; we can write out the two highest - degree terms of each polynomial and simplify . to prove ( b ) we proceed similarly from proposition [ exp - k - cycles - even ] .",
    "note that the expected number of elements in @xmath26-cycles of permutations with all cycle lengths even ( or odd ) approaches 1 as @xmath7 gets large , if @xmath26 has the appropriate parity .",
    "assume we are dealing with permutations with all cycle lengths even .",
    "naively , we might add the limits of the expected number of elements in @xmath204-cycles , @xmath205-cycles ,  ,",
    "@xmath7-cycles , and expect to get @xmath7 . but",
    "these are each 1 ; their sum is @xmath206 .",
    "since each element is in a cycle , we must have @xmath207 .",
    "the difficulty is that the convergence of @xmath208 as @xmath94 is not uniform over @xmath26 . under the correct scaling ,",
    "then , subtler phenomena can be seen ; the `` missing '' elements end up disproportionately in the longer cycle lengths for permutations with all cycle lengths even .",
    "we note that similar phenomena of nonuniform convergence have previously been observed in random mappings , for example in @xcite .",
    "[ exp - alpha - n - cycles ] fix @xmath209 . the expected number of elements in @xmath26-cycles in a random permutation of @xmath2 $ ] with all cycle lengths even satisfies _ uniformly _ @xmath210 as @xmath211 with @xmath212 .    the result of proposition [ exp - k - cycles - even ] can be rewritten in terms of factorials as @xmath213 and by stirling s approximation and routine simplifications ,",
    "we have @xmath214 let @xmath157 with @xmath212 .",
    "then we have @xmath215 $ ] , and so @xmath216 .",
    "furthermore @xmath217 , with the constant implicit in the @xmath218-notation being @xmath219 .",
    "therefore @xmath220 uniformly , as @xmath211 with @xmath212 .",
    "furthermore , we can essentially integrate the result of proposition [ exp - alpha - n - cycles ] to determine the cumulative distribution function of the length of the cycle containing a random element of a random permutation with all cycle lengths even ( or odd ) .",
    "this is the content of the next theorem .",
    "[ bulk - profile - even ] fix constants @xmath172 .",
    "let @xmath221 be the probability that @xmath39 is contained in a cycle of length between @xmath5 and @xmath122 of a permutation chosen uniformly at random from all permutations of @xmath2 $ ] with all cycle lengths even .",
    "then @xmath222    since the measure @xmath223 is invariant under conjugation , this is the probability that an element of @xmath2 $ ] chosen uniformly at random is in a cycle of length between @xmath5 and @xmath122 in a random permutation of @xmath2 $ ] with all cycle lengths even .",
    "note that @xmath224 and apply theorem [ bulk - profile - general ] .",
    "the same is true for permutations with all cycle lengths odd ; like those with all cycle lengths even they fall in the `` @xmath225 class '' .",
    "we now move to consider the mean and variance of the total number of cycles of all lengths .",
    "[ thm - mean - cycles - odd ] the mean number of cycles of a randomly chosen permutation of @xmath2 $ ] with all cycle lengths odd is , as @xmath94 , @xmath226 where we take the @xmath227 sign if @xmath7 is odd and the @xmath228 sign if @xmath7 is even .",
    "the variance of the number of cycles is , as @xmath94 , @xmath229    we have the exponential generating function counting such permutations by size and number of cycles , @xmath230 .",
    "we can differentiate to obtain the mean and variance of the number of cycles .",
    "these are given by @xmath231 { 1 \\over 2 } \\sqrt{1+z \\over 1-z } \\log { 1+z \\over 1-z } \\over [ z^n ] \\sqrt{1+z \\over 1-z } } , \\sigma_n^2 : = { [ z^n ] { 1 \\over 4 } \\sqrt{1+z \\over 1-z } \\log^2 { 1+z \\over 1-z } \\over [ z^n ] \\sqrt{1+z \\over 1-z } } + \\mu_n - \\mu_n^2.\\ ] ] let @xmath232 for @xmath233 and let @xmath234 f_r(z)$ ] for @xmath233",
    ". then we have @xmath235 and we need to find asymptotic series for the @xmath236 as @xmath94 .",
    "we observe that @xmath237 is the number of permutations of @xmath2 $ ] with all cycle lengths odd , which is @xmath238 if @xmath7 is even and @xmath239 if @xmath7 is odd ; stirling s formula gives an asymptotic expansion , depending on the parity of @xmath7 . to find a series for @xmath240 as @xmath94 , we expand @xmath241 in a series with terms which are half - integral powers of @xmath242 . from this",
    "we derive a series for @xmath243 with terms of the form @xmath244 where @xmath245 .",
    "the function being expanded is analytic in the complex plane slit along the real half - line @xmath246 ; by ( * ? ? ?",
    "vi.3 ) , an error of @xmath247 in the series for @xmath248 leads to an error @xmath249 in the series for @xmath240 .",
    "we can thus transfer an asymptotic expansion for @xmath248 near @xmath250 to give an expansion for @xmath240 as @xmath94 , and similarly for @xmath251 and @xmath252 . combining these series as specified by ( [ eq : feb-24-lambda ] )",
    "gives the result .",
    "we observe that this is @xmath253 more than the number of cycles of a permutation of @xmath2 $ ] with all cycle lengths even .",
    "the following two results give a decomposition of the number of cycles of permutations with all cycle lengths even into a sum of bernoulli random variables .",
    "[ even - gf ] the generating function of permutations of @xmath254 $ ] with all cycle lengths even , counted by their number of cycles , is @xmath255 \\cdot ( 2n-1)!!\\ ] ]    the bivariate generating function for permutations with all cycle lengths even , counted by their size and number of cycles , is @xmath256 .",
    "let @xmath257 be the desired generating function .",
    "then we have @xmath258 and it is clear that @xmath259 is the zero polynomial for odd @xmath26 . for even @xmath26 ,",
    "the binomial theorem gives @xmath260 and so we have @xmath261 by comparing coefficients ; this can be expanded to give the expression above .",
    "a combinatorial proof is also possible .",
    "recall that we can write a permutation @xmath15 of @xmath2 $ ] in terms of its _ inversion table _",
    ", a sequence of integers @xmath262 , with @xmath263 .",
    "the number of zeros in the sequence @xmath264 is the number of left - to - right maxima of @xmath15 .",
    "the `` fundamental correspondence '' between permutations written in cycle notation and in one - line notation takes permutations with @xmath26 cycles to those with @xmath26 left - to - right maxima ; furthermore , permutations with all cycle lengths even are taken to those with all left - to - right maxima in odd positions , and conversely . thus it suffices to show that @xmath265 is the generating function of permutations with all left - to - right maxima in odd positions , counted by their number of maxima ; this is done by considering the inversion table .",
    "[ thm - mean - cycles - even ] the number of cycles @xmath266 of a random permutation of @xmath254 $ ] with all cycle lengths even , as @xmath94 , is asymptotically normally distributed with @xmath267 and @xmath268    let @xmath269 . from theorem",
    "[ even - gf ] , we have @xmath270 where the @xmath271 are independent bernoulli random variables with @xmath272 . the formula ( [ eq : feb-24-zeta ] ) for the expectation follows from the asymptotic series for the harmonic numbers .",
    "the variance is given by @xmath273 and we need to consider the second sum .",
    "we have @xmath274 , so @xmath275 but @xmath276 , so in fact we get @xmath277 ; from this and ( [ eq : feb-24-zeta ] ) we get ( [ eq : feb-24-eta ] ) .",
    "asymptotic normality follows from the lindeberg - feller central limit theorem @xcite .",
    "there is not such a simple decomposition for permutations with all cycle lengths odd .",
    "however , it appears that the polynomials counting permutations of @xmath2 $ ] with all cycle lengths odd by their number of cycles have only pure imaginary roots .",
    "if this is true , then the number of cycles of a random permutation of @xmath2 $ ] with all cycle lengths odd can be decomposed into a sum of @xmath278 independent @xmath279-valued random variables , plus 1 if @xmath7 is odd .",
    "it may be of interest to study the zeros of these polynomials .",
    "we have at this point seen substantial similarities between permutations with all cycle lengths having the same parity and permutations with cycle weights @xmath3 .",
    "this suggests that an average of weights is in some sense a more fundamental parameter than the individual weights .",
    "this has been anticipated by the notion of a _ function of logarithmic type _",
    "@xcite , which has been used in the study of permutations @xcite .",
    "let @xmath280 \\}$ ] .",
    "a function @xmath281 is called _ logarithmic _ if it is of the form @xmath282 for some constant multiplier @xmath196 and function @xmath283 , where @xmath283 is analytic in @xmath284 and satisfies @xmath285 for some constant @xmath132 as @xmath286 in @xmath284 , and @xmath287 is the unique dominant singularity of @xmath288 on its circle of convergence . in (",
    "1 ) structures having components enumerated by a function of logarithmic type @xmath281 are considered ; for such structures of size @xmath7 , the expected number of cycles is @xmath289 , as is the variance .",
    "however , the structures considered in this paper have not all had components counted by functions of logarithmic type .",
    "for example , the components of permutations with all cycle lengths even are counted by the exponential generating function @xmath290 , which has singularities at @xmath291 and thus does not have a unique dominant singularity .      [ normal - conjecture ] let @xmath9 be a sequence of nonnegative real numbers with mean @xmath292 , that is , with @xmath293",
    ". then permutations of @xmath2 $ ] selected according to the weights @xmath11 have an asymptotically gaussian number of cycles as @xmath94 , with mean and variance asymptotic to @xmath294 .",
    "let @xmath9 be a weighting sequence , and let @xmath295 be a positive real parameter .",
    "let @xmath296 denote the size of the ground set of a permutation @xmath15 .",
    "then we define the _",
    "@xmath11-weighted boltzmann measure with parameter @xmath295 _ on permutations , a probability measure on @xmath297 , by @xmath298      for any choice of @xmath11 and @xmath295 , @xmath300 is a probability measure .",
    "it suffices to show that @xmath300 has total mass 1 .",
    "but @xmath301 is the weighted generating function of cycles , and we can apply the exponential formula . thus @xmath300 is a straightforward weighted generalization of the boltzmann measure on labelled objects studied in @xcite . we also retain the formulas from ( * ? ? ?",
    "* thm 2.1 ) for the expected size and the variance of the size of the objects chosen according to this measure .",
    "let @xmath302 be the exponential generating function of a labelled combinatorial class , and @xmath303 the size of a random object chosen from that class according to the boltzmann measure . then @xmath304      [ thm - boltzmann - concentrated ] let @xmath9 be a weighting sequence with mean @xmath292 .",
    "let @xmath305 be chosen so that @xmath306 .",
    "let @xmath60 be a random variable denoting the number of cycles of a permutation .",
    "then @xmath307 as @xmath308 or @xmath309 .",
    "we begin by showing that if @xmath323 as @xmath94 for some function @xmath324 such that @xmath325 is integrable on @xmath326 , then @xmath327 as @xmath94 .",
    "let @xmath328 .",
    "we integrate @xmath329 by parts , getting @xmath330 clearly @xmath331 , and @xmath332 by assumption , so @xmath333 since @xmath334 as @xmath335 , the integrand satisfies @xmath336 , and",
    "so @xmath337 proving the claim .",
    "now , we need to check that this statement about integrals translates into an analogous one about sums .",
    "let @xmath135 be as in the hypothesis , and let @xmath338 .",
    "then we want to show that @xmath339 as @xmath94 .",
    "we have @xmath340 and so , since @xmath341 for positive integer @xmath26 , @xmath342 since @xmath343 is bounded , the sum on the right - hand side is convergent .",
    "we have @xmath344 , so @xmath345 as well .",
    "thus we have proven the lemma for @xmath346 .",
    "multiplying through by @xmath292 gives the desired result .",
    "applying lemma [ lemma - boltzmann - two ] to the hypothesis , @xmath349 .",
    "we apply lemma [ lemma - polya - szego ] with @xmath350 .",
    "this gives us @xmath351 now , @xmath352 , and @xmath353 , so we have @xmath354 thus the right - hand side here has value @xmath292 , proving ( [ eq : feb-24-theta ] ) .    note that for the boltzmann measure with parameter @xmath295 and weight sequence @xmath11 , we have @xmath355 .",
    "thus the distribution of sizes @xmath303 under this measure has expectation @xmath356 furthermore , the boltzmann distribution @xmath300 can be obtained by taking @xmath357 cycles of length @xmath26 for each @xmath358 and forming uniformly at random a permutation with the resulting cycle type .",
    "the mean and variance of the number of cycles chosen from the distribution @xmath300 is thus exactly @xmath301 .",
    "since we have @xmath359 as @xmath308 by lemma [ lemma - boltzmann - one ] , we can solve for @xmath295 to see that @xmath360 as @xmath308 .",
    "therefore @xmath361 which is the desired result",
    ".    it would be desirable to translate theorem [ thm - boltzmann - concentrated ] into a result about permutations of a fixed size selected uniformly at random ; this is one possible way of proving conjecture [ normal - conjecture ] .",
    "note that @xmath300 is a mixture of the various @xmath19 .",
    "it is often possible to prove results about a family of measures @xmath362 , parametrized by @xmath104 , which are mixtures of well - understood measures @xmath363 , where we draw from @xmath363 with probability @xmath364 ; this goes by the name of analytic de - poissonization @xcite , ( * ? ? ?",
    "10 ) . informally , we pick from @xmath365 where @xmath303 is poisson with parameter @xmath104 . in the case",
    "described here we can get results on permutations chosen from @xmath365 where @xmath303 is the size of objects from a boltzmann distribution ; thus techniques of `` analytic de - boltzmannization '' will be necessary to achieve this goal .",
    "_ acknowledgement .",
    "i thank robin pemantle , my ph.d .",
    "thesis advisor , for very helpful suggestions and valuable support .",
    "i thank the anonymous referee for remarks concerning the proof of theorem [ bulk - profile - general ] .",
    "1 richard arratia , a. d. barbour , and simon tavar .",
    "random combinatorial structures and prime factorizations .",
    "_ notices of the american mathematical society _ 44 ( 1997 ) , 903 - 910 .",
    "richard arratia , a. d. barbour , and simon tavar .",
    "_ logarithmic combinatorial structures : a probabilistic approach .",
    "_ european mathematical society , 2003 .",
    "richard arratia and simon tavar .",
    "limit theorems of combinatorial structures via discrete process approximation .",
    "_ random structures algorithms _ 3 ( 1992 ) , 321 - 345 .",
    "florent benaych - georges .",
    "cycles of random permutations with restricted cycle lengths .",
    "preprint , arxiv:0712.1903 .",
    "edward a. bender .",
    "asymptotic methods in enumeration .",
    "_ siam review _ 16 ( 1974 ) , 485 - 515 .",
    "philippe duchon , philippe flajolet , guy louchard , and gilles schaeffer .",
    "boltzmann samplers for the random generation of combinatorial structures .",
    "combinatorics , probability and computing _ 13 ( 2004 ) , 577 - 625 .",
    "richard durrett .",
    "_ probability : theory and examples .",
    "_ second edition .",
    "duxbury , 1995 .",
    "warren ewens .",
    "the sampling theory of selectively neutral alleles .",
    "_ theoretical population biology _ 3 ( 1972 ) , 87 - 112 .",
    "william feller .",
    "the fundamental limit theorems in probability .",
    "_ bulletin of the american mathematical society _ 51 ( 1945 ) , 800 - 832 .",
    "philippe flajolet , eric fusy , xavier gourdon , daniel panario , and nicolas pouyanne .",
    "a hybrid of darboux s method and singularity analysis in combinatorial asymptotics . _ electronic journal of combinatorics _ , 13(1 ) ( 2006 ) , paper r103 ( 35 pages ) .",
    "philippe flajolet and andrew odlyzko .",
    "random mapping statistics .",
    "_ lecture notes in computer science _ 434 ( 1990 ) , 329 - 354 .",
    "philippe flajolet and andrew odlyzko .",
    "singularity analysis of generating functions .",
    "_ siam journal of discrete mathematics _ 3 ( 1990 ) , 216 - 240 .",
    "philippe flajolet and robert sedgewick .",
    "_ analytic combinatorics_. cambridge university press , 2009 .",
    "philippe flajolet and michele soria .",
    "gaussian limiting distributions for the number of components in combinatorial structures . _ journal of combinatorial theory , series a _ 153 ( 1990 ) , 165 - 182 .",
    "d. gandolfo , j. ruiz , d. ueltschi , on a model of random cycles .",
    "_ journal of statistical physics _ 129 ( 2007 ) , 663 - 676 .",
    "daniel h. greene and donald e. knuth .",
    "_ mathematics for the analysis of algorithms_. third edition .",
    "birkhauser , 1990 .",
    "jennie c. hansen .",
    "order statistics for decomposable combinatorial structures .",
    "_ random structures algorithms _ 5 ( 1994 ) , 517 - 533 .",
    "philippe jacquet and wojciech szpankowski . analytical depoissonization and its applications .",
    "_ theoretical computer science _ 201 ( 1998 ) , 1 - 62 .",
    "michael lugo .",
    "the number of cycles of specified normalized length in permutations . in preparation .",
    "jim pitman ( 2006 ) . _ combinatorial stochastic processes . _",
    "springer , 2006 .",
    "_ springer lecture notes in mathematics _ , volume 1875",
    "george polya and gabor szego .",
    "_ problems and theorems in analysis i. _ springer , 1998 .",
    "corrected reprint of the 1978 edition .",
    "translated from german by dorothee aeppli .",
    "nicolas pouyanne . on the number of permutations admitting an m - th root .",
    "_ electronic journal of combinatorics _",
    "9(1 ) ( 2002 ) , paper r3 ( 12 pages ) .",
    "vladimir n. sachkov .",
    "_ probabilistic methods in combinatorial analysis",
    ". _ cambridge university press , 1997 .",
    "wojciech szpanowski .",
    "_ average - case analysis of algorithms on sequences .",
    "_ wiley , 2001 .",
    "a. n. timashev .",
    "random permutations with cycle lengths in a given finite set .",
    "_ discrete mathematics and applications _ 18 ( 2008 ) , 25 - 39 .",
    "daniel ueltschi and volker betz .",
    "spatial random permutations with small cycle weights .",
    "preprint , arxiv:0812.0569 . g. a. watterson .",
    "models for the logarithmic species abundance distributions . _ theoretical population biology _ 6 ( 1974 ) 217 - 250 .",
    "herbert wilf .",
    "the asymptotics of @xmath366 and the number of elements of each order in @xmath8 , _ bulletin of the american mathematical society _ 15 ( 1986 ) , 228 - 232 .",
    "a. l. yakymiv . on permutations with cycle lengths in a random set .",
    "_ discrete mathematics and applications _ 10 ( 2000 ) , 543 - 551 ."
  ],
  "abstract_text": [
    "<S> this paper develops an analogy between the cycle structure of , on the one hand , random permutations with cycle lengths restricted to lie in an infinite set @xmath0 with asymptotic density @xmath1 and , on the other hand , permutations selected according to the ewens distribution with parameter @xmath1 . </S>",
    "<S> in particular we show that the asymptotic expected number of cycles of random permutations of @xmath2 $ ] with all cycles even , with all cycles odd , and chosen from the ewens distribution with parameter @xmath3 are all @xmath4 , and the variance is of the same order . </S>",
    "<S> furthermore , we show that in permutations of @xmath2 $ ] chosen from the ewens distribution with parameter @xmath1 , the probability of a random element being in a cycle longer than @xmath5 approaches @xmath6 for large @xmath7 . </S>",
    "<S> the same limit law holds for permutations with cycles carrying multiplicative weights with average @xmath1 . </S>",
    "<S> we draw parallels between the ewens distribution and the asymptotic - density case and explain why these parallels should exist using permutations drawn from weighted boltzmann distributions . </S>"
  ]
}