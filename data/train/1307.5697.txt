{
  "article_text": [
    "colour refinement ( a.k.a .",
    "`` naive vertex classification '' or `` colour passing '' ) is a basic algorithmic routine for graph isomorphism testing .",
    "it iteratively partitions , or colours , the vertices of a graph according to an iterated degree sequence : initially , all vertices get the same colour , and then in each round of the iteration two vertices that so far have the same colour get different colours if for some colour @xmath2 they have a different number of neighbours of colour @xmath2 .",
    "the iteration stops if in some step the partition remains unchanged ; the resulting partition is known as the _ coarsest equitable partition _ of the graph . by refining the partition asynchronously using hopcroft s strategy of `` processing the smaller half '' ( for dfa - minimisation @xcite ) , the coarsest equitable partition of a graph can be computed very efficiently , in time @xmath3 @xcite ( also see @xcite for a matching lower bound ) . a beautiful result due to tinhofer @xcite , ramana , scheinerman , and",
    "ullman @xcite and godsil @xcite establishes a tight correspondence between equitable partitions of a graph and fractional automorphisms , which are solutions to the lp relaxation of a natural ilp formulation of graph isomorphism .    in this paper",
    ", we introduce a version of colour refinement for matrices ( to be outlined soon ) and develop a theory of equitable partitions and fractional automorphisms and isomorphisms of matrices .",
    "a surprising application of the theory is a method to reduce the dimensions of systems of linear equations and linear programs .    when applied in the context of graph isomorphism testing , the goal of colour refinement is to partition the vertices of a graph as finely as possible ; ideally , one would like to compute the partition of the vertices into the orbits of the automorphism group of the graph . in this paper ,",
    "our goal is to partition the rows and columns of a matrix as coarsely as possible .",
    "we show that by `` factoring '' a matrix associated with a system of linear equations or a linear program through an `` equitable partition '' of the variables and constraints , we obtain a smaller system or lp equivalent to the original one , in the sense that feasible and optimal solutions can be transferred back and forth between the two via linear mappings that we can compute efficiently .",
    "hence we can use colour refinement as a simple and efficient preprocessing routine for linear programming , transforming a given linear program into an equivalent one in a lower dimensional space and with fewer constraints .",
    "we demonstrate the effectiveness of this method experimentally .    due to the ubiquity of linear programming",
    ", our method potentially has a wide range of applications .",
    "of course not all linear programs show the regularities needed by our method to be effective . yet",
    "this work grew out of applications in machine learning , or more specifically , inference problems in graphical models .",
    "actually , many problems arising in a wide variety of other fields such as semantic web , network communication , computer vision , and robotics can also be modelled using graphical models .",
    "the models often have inherent regularities , which are not exploited by classical inference approaches such as loopy belief propagation .",
    "symmetry - aware approaches , see e.g.  @xcite , run ( a modified ) loopy belief propagation on the quotient model of the ( fractional ) automorphisms of the graphical model and have been proven successful in several applications such as link prediction , social network analysis , satisfiability and boolean model counting problems .",
    "some of these approaches have natural lp formulations , and the method proposed here is a strengthening of the symmetry - aware approaches applied by the second and third author ( jointly with ahmadi ) in @xcite .",
    "consider a matrix @xmath4 .",
    ", respectively , which we assume to be disjoint .",
    "@xmath5 denotes the set of matrices with real entries and row and column indices from @xmath6 , @xmath7 , respectively .",
    "the order of the rows and columns of a matrix is irrelevant for us .",
    "we denote the entries of a matrix @xmath4 by @xmath8 . ]",
    "we iteratively compute partitions ( or colourings ) @xmath9 and @xmath10 of the rows and columns of @xmath11 , that is , of the sets @xmath6 and @xmath7 .",
    "we let @xmath12 and @xmath13 be the trivial partitions . to define @xmath14 , we put two rows @xmath15 in the same class if they are in the same class of @xmath9 and if for all classes @xmath16 of @xmath10 , @xmath17 similarly , to define @xmath18 , we put two columns @xmath19 in the same class if they are in the same class of @xmath10 and if for all classes @xmath20 of @xmath9 , @xmath21 clearly , for some @xmath22 we have @xmath23 for all @xmath24 .",
    "we let @xmath25 . to see that this is a direct generalisation of colour refinement on graphs , suppose that @xmath11 is a @xmath26-@xmath27-matrix , and view it as the adjacency matrix of a bipartite graph @xmath28 with vertex set @xmath29 and edge set @xmath30 .",
    "then the coarsest equitable partition of @xmath11 is equal to the partition of @xmath31 obtained by running colour refinement on @xmath28 starting from the partition @xmath32 .",
    "more generally , we may view every matrix as a weighted bipartite graph , and thus colour refinement on matrices is just a generalisation of standard colour refinement from graphs to weighted bipartite graphs .",
    "all of our results also have a version for arbitrary weighted directed graphs , corresponding to square matrices , but for the ease of presentation we focus on the bipartite case here .    adopting paige and tarjan s @xcite algorithm for colour refinement on graphs",
    ", we obtain an algorithm that , given a sparse representation of a matrix @xmath11 , computes @xmath33 in time @xmath3 , where @xmath34 and @xmath35 is the total bitlength of all nonzero entries of @xmath11 ( so that the input size is @xmath36 ) .    slightly abusing terminology , we say that a _ partition _ of a matrix @xmath4 is a pair @xmath37 of partitions of @xmath6 , @xmath7 , respectively .",
    "such a pair partitions the matrix into `` combinatorial rectangles '' .",
    "a partition @xmath37 of @xmath11 is _ equitable _ if for all @xmath38 , @xmath39 and all @xmath40 , @xmath41 equations and are satisfied .",
    "it is easy to see that the partition @xmath33 computed by colour refinement is the _",
    "coarsest _ equitable partition , in the sense that it is equitable and all other equitable partitions refine it .",
    "the key result that enables us to apply colour refinement to reduce the dimensions of linear programs is a correspondence between equitable partitions and _ fractional automorphisms _ of a matrix .",
    "we view an _ automorphism _ of a matrix @xmath42 as a pair of permutations of the rows and columns that leaves the matrix invariant , or equivalently , a pair @xmath43 of permutation matrices such that @xmath44 a _ fractional automorphism _ of @xmath11 is a pair @xmath45 of doubly stochastic matrices satisfying .",
    "we shall prove ( theorem  [ theo : aut ] ) that every equitable partition of a matrix yields a fractional automorphism and , conversely , every fractional isomorphism @xmath46 yields an equitable partition .",
    "the classes of this equitable partition are simply the strongly connected components of the directed graphs underlying the square matrices @xmath47 .",
    "this basic result is the foundation for everything else in this paper .",
    "we proceed to studying _",
    "fractional isomorphisms _ between matrices .",
    "our goal is to be able to compare matrices across different dimensions , for example , we would like to call the @xmath48-matrix with entry @xmath49 and the @xmath50-matrix with four @xmath27-entries fractionally isomorphic .",
    "the notion of fractional isomorphism we propose may not be the most obvious one , but we show that it is fairly robust .",
    "in particular , we prove a correspondence between fractional isomorphisms and _ balanced equitable joint partitions _ of two matrices . furthermore , we prove that fractionally isomorphic matrices are equivalent when it comes to the solvability of linear programs",
    ".    however , fractional isomorphism is still too fine as an equivalence relation if we want to capture the solvability of linear programs .",
    "we propose an even coarser equivalence relation between matrices that we call _ partition equivalence_. the idea is that two matrices are equivalent if they have `` isomorphic '' equitable partitions .",
    "we prove that two linear programs with associated matrices that are partition equivalent are equivalent in the sense that there are two linear mappings that map the feasible solutions of one lp to the feasible solutions of the other , and these mappings preserve optimality .",
    "every matrix @xmath11 is partition equivalent to a matrix @xmath51 $ ] obtained by `` factoring '' @xmath11 through its coarsest equitable partition ; we call @xmath51 $ ] the _ core factor _ of @xmath11",
    ". we can repeat this factoring process and go to matrices @xmath52,[[[a]]]]$ ] , et cetera , until we finally arrive at the _ iterated core factor _ @xmath53 .",
    "now suppose that @xmath11 is associated with an lp @xmath0 , then @xmath53 is associated with an lp @xmath54 .",
    "to solve @xmath0 , we compute @xmath55 , which we can do efficiently using colour refinement .",
    "the colour refinement procedure also yields the matrices that we need to translate between the solution spaces of @xmath0 and @xmath55",
    ". then we solve @xmath54 and translate the solution back to a solution of @xmath0 .",
    "the potential of our method has been confirmed by our computational evaluation on a number of benchmark lps with symmetries present .",
    "actually , the time spent in total on solving the lps  reducing an lp and solving the reduced lp  is often an order of magnitude smaller than solving the original lp directly .",
    "we have compared our method with a method of symmetry reduction for lps due to bdi , grundhfer and herr  @xcite ; the experiments show that our method is substantially faster .",
    "[ exa : intro ] we consider a linear program in standard form : @xmath56 where @xmath57",
    "we combine @xmath58 in a matrix @xmath59 by putting @xmath60 in the last column , row , respectively .",
    "the lines subdividing the matrix indicate the coarsest equitable partition . as the core factor of @xmath61",
    "we obtain the matrix @xmath62=\\left ( \\begin{array}{cc|cc|c }    3&1&0&2&1\\\\    1&3&2&0&1\\\\    \\hline    6&6&2&2&\\infty \\end{array } \\right).\\ ] ] again , the lines subdividing the matrix indicate the coarsest equitable partition",
    ". the core factor of @xmath63 $ ] , which turns out to be the iterated core factor of @xmath61 , is @xmath64= \\begin{pmatrix }    4&2&1\\\\    12&4&\\infty \\end{pmatrix}\\ ] ] this matrix corresponds to the lp @xmath65 where @xmath66 an optimal solution to ( @xmath1 ) is @xmath67 . to map @xmath68 to a solution of the original lp ( @xmath0 )",
    ", we multiply it with the following matrix .",
    "@xmath69 we will see later where this matrix comes from .",
    "it can be checked that @xmath70 is indeed @xmath71 is a minimal solution to ( @xmath0 ) .      using automorphisms to speed - up solving optimisation problems",
    "has attracted a lot of attention in the literature ( e.g. @xcite ) .",
    "most relevant for us is work focusing on integer and linear programming . for ilps , methods typically focus on pruning the search space to eliminate symmetric solutions , see e.g. @xcite for a survey ) . in linear programming , however , one takes advantage of convexity and projects the lp into the fixed space of its symmetry group  @xcite .",
    "as we will see ( in section  [ sec : symm ] ) , our approach subsumes this method . the second and third author ( together with ahmadi ) observed that equitable partitions can compress lps , as they preserve message - passing computations within the log - barrier method  @xcite .",
    "the present paper builds upon that observation , giving a rigorous theory of dimension reduction using colour - refinement , and connecting to existing symmetry approaches through the notion of fractional automorphisms .",
    "moreover , we show that the resulting theory yields a more general notion of fractional automorphism that ties in nicely with the linear - algebra framework and potentially leads to even better reductions than the purely combinatorial approach of  @xcite .",
    "we use a standard notation for graphs and digraphs . in a graph @xmath72 , we let @xmath73 denote the set of neighbours of vertex @xmath74 , and in a digraph @xmath75 we let @xmath76 and @xmath77 denote , respectively , the sets of out - neighbours and in - neighbours of @xmath74 .    we have already introduced some basic matrix notation in the introduction .",
    "permutation matrix _ is a @xmath26-@xmath27-matrix that has exactly one @xmath27 in every row and column .",
    "we call two matrices @xmath78 and @xmath79 _ isomorphic _ ( and write @xmath80 ) if there are bijective mappings @xmath81 and @xmath82 such that @xmath83 for all @xmath84 .",
    "equivalently , @xmath85 and @xmath86 are isomorphic if there are permutation matrices @xmath87 and @xmath88 such that @xmath89 .",
    "a matrix @xmath90 is _ stochastic _ if it is nonnegative and @xmath91 for all @xmath92 .",
    "it is _ doubly stochastic _ if both @xmath93 and its transpose @xmath94 are stochastic .",
    "observe that a doubly stochastic matrix is always square .",
    "the _ direct sum _ of two matrices @xmath78 and @xmath79 is the matrix @xmath95 with every matrix @xmath96 we associate its _ bipartite graph _ @xmath28 with vertex set @xmath29 and edge set @xmath97 . the matrix @xmath11 is _ connected _ if @xmath28 is connected .",
    "( sometimes , this is called _",
    "decomposable_. ) note that @xmath11 is not connected if and only if it is isomorphic to matrix that can be written as the direct sum of two matrices .",
    "a _ connected component _ of @xmath11 is a submatrix @xmath98 whose rows and columns form the vertex set of a connected component of the bipartite graph @xmath28 . with every square matrix @xmath99 we associate two more graphs : the directed graph",
    "@xmath100 has vertex set @xmath6 and edge set @xmath101 .",
    "the graph @xmath102 is the underlying undirected graph of @xmath100 .",
    "we call @xmath11 _ strongly connected _ if the graph @xmath100 is strongly connected .",
    "( sometimes , this is called _",
    "irreducible_. ) it is not hard to see that a doubly stochastic matrix @xmath93 is strongly connected if and only if the graph @xmath102 is connected .",
    "let @xmath42 .",
    "for all subsets @xmath103 , we let @xmath104 if we interpret @xmath11 as a weighted bipartite graph , then @xmath105 is the total weight of the edges from @xmath20 to @xmath16 .",
    "we write @xmath106 , @xmath107 instead of @xmath108 , @xmath109 . recall that a _ partition of @xmath11 _ is a pair @xmath37 , where @xmath110 is a partition of the set @xmath6 of row indices and @xmath111 is a partition of the set @xmath7 of column indices . using the function @xmath112",
    ", we can express the conditions and for a partition being _ equitable _ as @xmath113 for all @xmath114 .",
    "a _ convex combination _ of numbers @xmath115 is a sum @xmath116 where @xmath117 for all @xmath118 and @xmath119 .",
    "if @xmath120 for all @xmath118 , we call the convex combination _ positive_. we need the following simple ( and well - known ) lemma about convex combinations .",
    "[ lem : invisible_hand ] let @xmath75 be a strongly connected digraph .",
    "let @xmath121 , such that for every @xmath122 , the number @xmath123 is a positive convex combination of all @xmath124 for @xmath125 .",
    "then @xmath126 is constant .",
    "suppose for contradiction that @xmath126 satisfies the assumptions , but is not constant .",
    "let @xmath122 be a vertex with maximum value @xmath123 and @xmath127 such that @xmath128 .",
    "let @xmath20 be a path from @xmath74 to @xmath129 .",
    "then @xmath20 contains an edge @xmath130 such that @xmath131 . by the maximality of @xmath123",
    ", for all @xmath132 it holds that @xmath133 , and this contradicts @xmath134 being a positive convex combination of the @xmath135 for @xmath132 .    sometimes , we consider matrices with entries from @xmath136",
    ". we will only form linear combinations of elements of @xmath137 with nonnegative real coefficients , using the rules @xmath138 for all @xmath139 and @xmath140 , @xmath141 for @xmath142 .",
    "all our results hold for rational and real matrices and vectors . for the algorithms",
    ", we assume the input matrices and vectors to be rational . to analyse the algorithms , we use a standard ram model .",
    "in this section , we describe an algorithm that computes the coarsest equitable partition of a matrix @xmath4 in time @xmath3 . here",
    "@xmath143 and @xmath35 is the total bitlength of all nonzero entries of @xmath11 .",
    "( we use this notation for the rest of this section . )    to describe the algorithm , we view @xmath11 as a weighted bipartite graph with vertex set @xmath29 and edges with nonzero weights representing the nonzero matrix entries . for every vertex @xmath144 and every set @xmath145 of vertices , we let @xmath146 be the sum of the weights of the edges incident with @xmath147 . that is , @xmath148 for @xmath92 and @xmath149 for @xmath150 .",
    "moreover , for every subset @xmath145 , we let @xmath151 be the total bitlength of the weight of all edges incident with a vertex in @xmath152 . for a vertex @xmath147 ,",
    "we write @xmath153 instead of @xmath154 .",
    "note that @xmath155 .",
    "we consider the problem of computing the coarsest equitable partition of @xmath11 .",
    "a naive implementation of the iterative refinement procedure described in the introduction would yield a running time that is ( at least ) quadratic : in the worst case , we need @xmath156 refinement rounds , and each round takes time @xmath157 .    a significant improvement can be achieved if the refinement steps are carried out asynchronously , using a strategy that goes back to hopcroft s algorithm for minimising deterministic finite automata @xcite .",
    "the idea is as follows .",
    "the algorithm maintains partitions @xmath158 of @xmath29 .",
    "we call the classes of @xmath158 _ colours_. initially , @xmath159 .",
    "furthermore , the algorithm keeps a stack @xmath160 that holds some colours that we still want to use for refinement in the future .",
    "initially , @xmath160 holds @xmath161 ( in either order ) . in each refinement step , the algorithm pops a colour @xmath75 from the stack .",
    "we call @xmath75 the _ refining colour _ of this refinement step . for all @xmath144",
    "we compute the value @xmath162 . then for each colour @xmath152 in the current partition that has at least one neighbour in @xmath75 , we partition @xmath152 into new classes @xmath163 according to the values @xmath164 .",
    "then we replace @xmath152 by @xmath163 in the partition @xmath158 .",
    "moreover , we add all classes among @xmath163 _ except for the largest _ to the stack @xmath160 .",
    "if we use the right data structures , we can carry out such a refinement step with refining colour @xmath75 in time @xmath165 .",
    "compared to the standard , unweighted version of colour refinement , the weights add some complication when it comes to computing the partition @xmath163 of @xmath152",
    ". we can handle this by standard vector partitioning techniques , running in time linear in the total bitlength of the weights involved . by not adding the largest among the classes @xmath163 to the stack",
    ", we achieve that every vertex @xmath147 appears at most @xmath166 times in a refining colour @xmath75 .",
    "whenever @xmath147 appears in the refining colour , it contributes @xmath167 to the cost of that refinement step .",
    "thus the overall cost is @xmath168 .",
    "we refer the reader to @xcite for details on the algorithm ( for the unweighted case ) and its analysis .",
    "[ theo : alg ] there is an algorithm that , given a sparse representation of a matrix @xmath11 , computes the coarsest equitable partition of @xmath11 in time @xmath3 .",
    "recall that a _ fractional automorphism _ of a matrix @xmath4 is a pair @xmath169 of doubly stochastic matrices such that @xmath170 in this section , we prove the theorem relating fractional automorphisms to equitable partitions . for every pair @xmath169 of matrices we let @xmath171 be the partition of @xmath6 into the strongly connected components of @xmath93 , and we let @xmath172 be the partition of @xmath7 into the strongly connected components of @xmath173 .",
    "conversely , for every partition @xmath37 of @xmath11 , we let @xmath174[page : xp ] be the matrix with entries @xmath175 if @xmath40 for some @xmath38 and @xmath176 otherwise , and we let @xmath177 be the matrix with entries @xmath178 if @xmath41 for some @xmath39 and @xmath179 otherwise .",
    "[ theo : aut ] let @xmath4 .    1 .",
    "if @xmath37 is an equitable partition of @xmath11 , then @xmath180 is a fractional automorphism .",
    "if @xmath46 is a fractional automorphism of @xmath11 , then @xmath181 is an equitable partition .    to prove ( 1 ) ,",
    "let @xmath37 be an equitable partition of @xmath11 , and let @xmath182 and @xmath183 .",
    "let @xmath184 , and let @xmath38 and @xmath39 be the classes of @xmath74 and @xmath129 , respectively .",
    "then @xmath185 equality @xmath186 can be established by a double - counting argument : we have @xmath187 by and @xmath188 by .    to prove ( 2 ) , let @xmath46 be a fractional automorphism of @xmath11 .",
    "let @xmath189 and @xmath190 .",
    "we need to prove that @xmath191 satisfy and .",
    "we first prove . for every @xmath192 , we have @xmath193 equation @xmath194 holds because @xmath195 and @xmath196 for @xmath197 .",
    "here we use that @xmath16 , which by definition is a strongly connected component of the digraph @xmath198 , is also a connected component of the undirected graph @xmath199 .",
    "equation @xmath200 holds by @xmath201 and @xmath196 for @xmath202 and @xmath203 for @xmath204 .",
    "equation @xmath205 holds , because @xmath206 and @xmath207 .",
    "as the matrix @xmath93 is stochastic , this implies that @xmath208 is a positive convex combination of the @xmath209 for @xmath210 .",
    "as @xmath20 is the vertex set of a strongly connected component of @xmath211 , by lemma  [ lem : invisible_hand ] , it follows that @xmath212 for all @xmath40 .",
    "this proves .",
    "can be proved similarly .",
    "in this section , we want to relate different matrices by `` fractional isomorphisms '' .",
    "let us first review the natural notion of fractional isomorphisms of graphs : if @xmath213 and @xmath214 are ( undirected ) graphs with vertex sets @xmath215 , respectively , and @xmath216 , @xmath217 are their adjacency matrices , then @xmath213 and @xmath214 are _ fractionally isomorphic _ if there is a doubly stochastic matrix @xmath218 such that @xmath219 .",
    "note that this implies @xmath220 , because doubly stochastic matrices are square . viewing matrices as weighted bipartite graphs , it is straightforward to generalise this notion of fractional isomorphism to pairs of matrices of the same dimensions : let @xmath78 , @xmath79 with @xmath220 and @xmath221 . we could call @xmath85 and @xmath86 fractionally isomorphic if there is a pair @xmath222 of doubly stochastic matrices such that @xmath223 ( we need both equations because the full adjacency matrix of the weighted bipartite graph represented by a matrix @xmath11 is @xmath224 . ) if we were only interested in fractional isomorphisms between matrices of the same dimensions , this would be a perfectly reasonable definition .",
    "it is not clear , though , how to generalise it to matrices of different dimensions , and in a sense this whole paper is about similarities between matrices of different dimensions .",
    "if the matrices have different dimensions , we need to drop the requirement of @xmath47 being doubly stochastic .",
    "the first idea would be to require @xmath47 to be stochastic matrices with constant column sums .",
    "the resulting notion of fractional isomorphism is the right one for connected matrices , but has the backdraw that it is not closed under direct sums .",
    "that is , there are matrices @xmath225 such that @xmath226 and @xmath227 are fractionally isomorphic in this sense , but the direct sums @xmath228 and @xmath229 are not ( see example  [ exa : equi ] ) . however , closure under direct sums is something we might expect of something called `` isomorphism '' .",
    "there is an alternative approach to defining fractional isomorphisms that is more robust , but equivalent for connected matrices .",
    "the starting point is the observation that isomorphisms between two graphs correspond to automorphisms of their disjoint union where each vertex of the first graph is mapped to a vertex of the second and vice versa . replacing automorphisms by fractional automorphisms ,",
    "this leads to the following definition .",
    "as above , we consider matrices @xmath78 and @xmath230 , where we assume the sets @xmath231 to be mutually disjoint .",
    "a _ fractional isomorphism _ from @xmath85 to @xmath86 is a fractional automorphism @xmath46 of the direct sum @xmath232 such that , for @xmath233 , for every @xmath234 there is a @xmath235 with @xmath236 and for every @xmath237 there is a @xmath238 with @xmath239 .",
    "the matrices @xmath85 and @xmath86 are _ fractionally isomorphic _",
    "( we write @xmath240 ) if there is a fractional isomorphism from @xmath85 to @xmath86 .",
    "it is not obvious that fractional isomorphism is an equivalence relation ; this will be a consequence of the characterisation of fractional isomorphism by equitable partitions ( see corollary  [ cor : fieq ] ) .",
    "it is also not clear that for connected matrices this notion of fractional isomorphism coincides with the one discussed above ; this is the content of theorem  [ theo : equi ] .",
    "the following five matrices are fractionally isomorphic : @xmath241 for all @xmath242 $ ] , a pair of matrices with all identical entries is a fractional isomorphism .",
    "we now relate fractional isomorphisms to the colour refinement algorithm and equitable partitions .",
    "the standard way of running colour refinement on two graphs is to run it on their disjoint union .",
    "we do the same for matrices , using the direct sum instead of the disjoint union .",
    "let @xmath78 and @xmath79 , where @xmath243 are mutually disjoint .",
    "a _ joint partition _ of @xmath226 is a partition of @xmath244 , that is , a pair @xmath37 of partitions of @xmath245 and @xmath246 , respectively .",
    "a joint partition @xmath37 of @xmath226 is _ balanced _ if all @xmath38 have a nonempty intersection with both @xmath247 and @xmath248 and all @xmath39 have a nonempty intersection with both @xmath249 and @xmath250 .",
    "a joint partition @xmath37 of @xmath226 is _ equitable _ if it is an equitable partition of @xmath244 .",
    "we can compute the coarsest equitable joint partition of @xmath226 using colour refinement .    for all matrices",
    "@xmath226 , the following three statements are equivalent .    1",
    ".   @xmath85 and @xmath86 are fractionally isomorphic .",
    "2 .   @xmath85 and @xmath86 have a balanced equitable joint partition .",
    "3 .   the coarsest equitable joint partition of @xmath85 and @xmath86 is balanced .",
    "the implication ( 3)@xmath251(2 ) is trivial .",
    "the converse implication ( 2)@xmath251(3 ) follows from the observation that if some equitable joint partition is balanced , then the coarsest equitable joint partition is balanced as well .    to prove ( 1)@xmath251(2 ) , suppose that @xmath85 and @xmath86 are fractionally isomorphic .",
    "let @xmath46 be a fractional isomorphism .",
    "let @xmath181 be the corresponding partition of @xmath244 . by theorem  [ theo : aut",
    "] , this partition is equitable and hence an equitable joint partition of @xmath226 . recall that the parts of the partition @xmath171 are the connected components of the undirected graph @xmath252 , because @xmath93 is doubly stochastic . as for every @xmath253 $ ] and @xmath234",
    "there is a @xmath254 with @xmath236 , every connected component of @xmath252 has a nonempty intersection with both @xmath247 and @xmath248 .",
    "similarly , every part of @xmath172 has a nonempty intersection with @xmath249 and @xmath250 .",
    "thus @xmath181 is balanced .    to prove that ( 2)@xmath251(1 ) , let @xmath37 be a balanced equitable joint partition of @xmath255 . then by theorem  [ theo : aut ] , the pair @xmath180 of matrices is a fractional automorphism of @xmath244 . as @xmath37 is balanced , for every @xmath253 $ ] and @xmath234 there is a @xmath254 with @xmath256 , and for every @xmath253 $ ] and @xmath237 there is a @xmath238 with @xmath257 .",
    "thus @xmath180 is a fractional isomorphism from @xmath85 to @xmath86 .",
    "let @xmath225 be matrices such that @xmath240 and @xmath258",
    ". then @xmath259 .",
    "let @xmath37 be the coarsest equitable joint partition of @xmath226 .",
    "then for @xmath260 , the restriction of @xmath37 to @xmath261 is the coarsest equitable partition of @xmath261 .",
    "let @xmath37 be the coarsest equitable joint partition of @xmath226 .",
    "let @xmath262 be the restriction of @xmath37 to @xmath261 , that is , @xmath263 and @xmath264 .",
    "we know that @xmath262 is an equitable partition of @xmath261 .",
    "assume , for the purpose of contradiction , the partition @xmath265 is not the coarsest one on @xmath85 .",
    "( the case for @xmath86 is symmetric . )",
    "let @xmath266 be an equitable partition of @xmath85 that is strictly coarser than @xmath265 .    for classes @xmath267 we write @xmath268 if @xmath269 and @xmath270 are subsets of the same class in @xmath271 .",
    "similarly , for classes @xmath272 we write @xmath273 if @xmath274 and @xmath275 are subsets of the same class in @xmath276 . for @xmath277 , let @xmath278 $ ] denote the class of @xmath74 in @xmath110 . similarly , for @xmath279",
    ", let @xmath280 $ ] denote the class of @xmath129 in @xmath111 . consider the joint partition @xmath281 of @xmath282 , where @xmath283 is induced by the equivalence relation @xmath284\\sim [ v ' ] \\}$ ] and @xmath285",
    "is induced by the equivalence relation @xmath286\\sim [ w ' ] \\}$ ] .",
    "the partition @xmath281 is equitable and coarser than @xmath37 , which is a contradiction .    from the above lemma",
    ", it follows immediately that fractional isomorphism is transitive .",
    "as it is trivially reflexive and symmetric , we obtain the following corollary .",
    "[ cor : fieq ] fractional isomorphism is an equivalence relation .",
    "[ lem : equi1 ] for @xmath233 , let @xmath287 such that @xmath85 is connected .",
    "let @xmath37 be a balanced equitable joint partition of @xmath85 and @xmath86 .",
    "then for all @xmath288 , @xmath289    as usual , for @xmath233 we let @xmath290 . furthermore , for @xmath38 , and",
    "@xmath39 we let @xmath291 and @xmath292 . for all @xmath288 ,",
    "let @xmath293 for some ( and hence all ) @xmath253 $ ] , @xmath294 and @xmath295 for some ( and hence all ) @xmath253 $ ] , @xmath296 .",
    "then for @xmath233 we have @xmath297 since the joint partition @xmath37 is balanced , we have @xmath298 , and thus @xmath299 . furthermore , if @xmath300 then @xmath301 let @xmath302 be the bipartite graph with vertex set @xmath303 and ( undirected ) edges @xmath304 for all @xmath288 such that @xmath305 . as the bipartite graph @xmath306",
    "is connected , the graph @xmath302 is connected as well .",
    "this implies that for all @xmath288 we have @xmath307 as @xmath302 is connected , it suffices to prove this for @xmath308 , and for such @xmath304 it follows immediately from .    as @xmath309",
    ", this implies for all @xmath38 , @xmath310 similarly , for all @xmath39 , @xmath311    [ lem : equi2 ] let @xmath78 and @xmath79 be nonzero matrices such that there exists a pair @xmath222 of stochastic matrices with constant column sums satisfying and .",
    "then @xmath312    suppose for contradiction that @xmath313 .",
    "let us assume that @xmath314 , the proof for the case @xmath315 is similar .",
    "observe that and imply @xmath316 for all @xmath317 .",
    "an easy calculation shows that the matrix @xmath318 is a matrix with constant row an column sums @xmath319 , and the matrix @xmath320 is a matrix with constant row an column sums @xmath321 .",
    "let @xmath322 and @xmath323 and @xmath324 .",
    "then for all @xmath317 we have @xmath325 as both @xmath152 and @xmath75 are doubly stochastic and @xmath326 is nonzero and @xmath327 , this leads to a contradiction .",
    "[ theo : equi ] for @xmath233 , let @xmath287 .",
    "suppose that @xmath85 is connected",
    ". then @xmath226 are fractionally isomorphic if and only if there is a pair @xmath222 of stochastic matrices with constant column sums satisfying and .    to prove the forward direction , let @xmath37 be a balanced equitable joint partition of @xmath226 . for all @xmath253",
    "$ ] , @xmath38 , and @xmath39 , we let @xmath291 and @xmath292 . by lemma  [ lem : equi1 ]",
    ", we have @xmath328 for all @xmath288 , let @xmath293 for some ( and hence all ) @xmath253 $ ] , @xmath294 and @xmath295 for some ( and hence all ) @xmath253 $ ] , @xmath296 .",
    "then for @xmath233 we have @xmath329 we define @xmath218 by @xmath330 if @xmath331 for some @xmath38 and @xmath332 otherwise .",
    "similarly , we define @xmath333 by @xmath334 if @xmath335 for some @xmath39 and @xmath336 otherwise . then for all @xmath337 , @xmath338 where @xmath38 such that @xmath339 . for all @xmath340 , @xmath341 where @xmath38 such that @xmath342 .",
    "thus @xmath93 , and similarly @xmath173 , are stochastic matrices with constant column sums . we claim that @xmath46 satisfies the equations and . to prove ,",
    "let @xmath337 and @xmath343 , and let @xmath288 such that @xmath344 and @xmath345 .",
    "then @xmath346 where @xmath347 follows from .",
    "equation can be proved similarly .    to prove the backward direction ,",
    "let @xmath46 be a pair of stochastic matrices with constant column sums satisfying and .",
    "by lemma  [ lem : equi2 ] , we have @xmath348",
    ". then the column sums of both @xmath93 and @xmath173 are @xmath319",
    ".    1 @xmath349 .",
    "+ let @xmath152 be the @xmath350 diagonal matrix with all diagonal entries @xmath351 , and let @xmath75 be the @xmath352 diagonal matrix with all diagonal entries @xmath351 .",
    "then @xmath353 is a fractional automorphism from @xmath85 to @xmath86",
    ". 2 @xmath354 .",
    "+ in this case , let @xmath152 be the @xmath355 diagonal matrix with all diagonal entries @xmath356 , and let @xmath75 be the @xmath357 diagonal matrix with all diagonal entries @xmath356 . then @xmath358 is a fractional automorphism from @xmath85 to @xmath86 .",
    "the following example shows that the condition in theorem  [ theo : equi ] , that @xmath85 ( or equivalently @xmath86 ) be connected is necessary , even for @xmath26-@xmath27-matrices .",
    "[ every node/.style = circle , fill , minimum height=2mm , inner sep=0pt , thick ]    ( 0,0 ) node ( v1 ) ( 1,0 ) node ( v2 ) ( 2,0 ) node ( v3 ) ( 3,0 ) node ( v4 ) ( 0,1 ) node ( w1 ) ( 1,1 ) node ( w2 ) ( 2,1 ) node ( w3 ) ( 3,1 ) node ( w4 ) ; ( v1 ) edge ( w1 ) ( v2 ) edge ( w2 ) ( v3 ) edge ( w3 ) edge ( w4 ) ( v4 ) edge ( w3 ) edge ( w4 ) ;    ( 0,0 ) node ( v1 ) ( 1,0 ) node ( v2 ) ( 2,0 ) node ( v3 ) ( 3,0 ) node ( v4 ) ( 0,1 ) node ( w1 ) ( 1,1 ) node ( w2 ) ( 2,1 ) node ( w3 ) ( 3,1 ) node ( w4 ) ; ( v1 ) edge ( w1 ) ( v2 ) edge ( w2 ) edge ( w3 ) ( v3 ) edge ( w2 ) edge ( w4 ) ( v4 ) edge ( w3 ) edge ( w4 ) ;    [ exa : equi ] the matrices @xmath359 whose bipartite graphs are displayed in figure  [ fig : equi ] , are easily seen to be fractionally isomorphic , but there is no pair @xmath46 of doubly stochastic matrices satisfying and .",
    "we leave it to the reader to prove these claims .",
    "for our applications , fractional isomorphism is an equivalence relation that is still too fine . in this section",
    ", we introduce a coarser equivalence relation that we will call _ partition equivalence_. for the applications in the next section , it will be helpful to develop partition equivalence for matrices with entries from @xmath136 .",
    "a _ partition matrix _ is a @xmath26-@xmath27 matrix that has exactly one @xmath27-entry in each row and at least one @xmath27-entry in each column .",
    "we usually denote partition matrices by @xmath360 or @xmath361 . with each partition matrix @xmath362",
    "we associate a partition @xmath363 of @xmath6 into parts @xmath364 .",
    "conversely , with every partition @xmath110 of @xmath6 we associate the partition matrix @xmath365 defined by @xmath366 , for all @xmath92 and @xmath38 .",
    "note that partition matrices are stochastic , but , in general , not doubly stochastic . ( the only doubly stochastic partition matrices are the permutation matrices . ) for every partition matrix @xmath367 , we define its _ scaled transpose _ to be the matrix @xmath368 with entries @xmath369 then @xmath370 is the transpose of @xmath360 scaled to a stochastic matrix .",
    "observe that the matrix @xmath371 is symmetric and doubly stochastic . indeed , if @xmath372 for a partition @xmath110 of @xmath6 , then @xmath373 this is precisely the matrix @xmath374 defined on page  .",
    "thus we obtain the following corollary of theorem  [ theo : aut ] .",
    "[ cor : pe - fi ] let @xmath37 be an equitable partition of a matrix @xmath4 , and let @xmath375 and @xmath376 . then @xmath377 is a fractional automorphism of @xmath11 .",
    "a _ factor matrix _ of a matrix @xmath378 is a matrix @xmath379 where @xmath37 is an equitable partition of @xmath11 .",
    "the asymmetry in the definition ( multiplying with @xmath380 rather than @xmath381 ) may seem strange first , but turns out to be necessary in several places .",
    "an immediate advantage of it is that we multiply with stochastic matrices from both sides .",
    "note that for all @xmath288 , @xmath382 for some ( and hence for all ) @xmath192 .",
    "( this is the number we sometimes denote by @xmath383 . )",
    "we will see that factor matrices still carry all information about a matrix necessary to solve systems of linear equations and linear programs .",
    "as the dimensions of @xmath384 are determined by the number of classes of the partition , there is a unique smallest factor matrix @xmath385:=\\pi_{{\\mathcal p}_\\infty}^{{{\\textsf{\\upshape s}}}}a\\pi_{{\\mathcal q}_\\infty},\\ ] ] where , as usual , @xmath33 denotes the coarsest equitable partition of @xmath11 .",
    "we call @xmath51 $ ] the _ core factor _ of @xmath11 . theorem  [ theo : alg ] implies that we can compute the core factor in quasilinear time .",
    "there is an algorithm that , given a sparse representation of a matrix @xmath11 , computes the core factor @xmath51 $ ] in time @xmath3 .",
    "we define the relation @xmath386 on the class of all matrices by letting @xmath387 if there are factor matrices @xmath388 of @xmath85 and @xmath389 of @xmath86 such that @xmath388 and @xmath389 are isomorphic .",
    "observe that for every matrix @xmath378 , @xmath390,\\ ] ] because @xmath391i'$ ] , where @xmath392 denote the identity matrices of the right dimensions .",
    "moreover , for all matrices @xmath393 and @xmath394 we have @xmath395 to see this , suppose that @xmath240 and let @xmath37 be a balanced equitable joint partition of @xmath85 and @xmath86",
    ". for @xmath233 , let @xmath396 and @xmath397 .",
    "then @xmath398 is an equitable partition of @xmath399 .",
    "let @xmath400 and @xmath401 and @xmath402 we claim that @xmath403 via the isomorphism @xmath404 , @xmath405 . to see this ,",
    "let @xmath288 .",
    "then by and @xmath406 for some ( and hence for all ) @xmath407 .",
    "maybe surprisingly , the relation @xmath386 is _ not _ an equivalence relation .",
    "it is obviously reflexive and symmetric , but the next example shows that it is not transitive .",
    "[ exa : icf ] consider the matrix @xmath61 of example  [ exa : intro ] and the factor matrices @xmath63 $ ] and @xmath408 $ ] .",
    "by , we have @xmath409 $ ] and @xmath63\\approx[[{\\widetilde{a}}]]$ ] .",
    "however , we clearly have @xmath410 $ ] , because there is no factor of @xmath61 and thus no matrix @xmath384 with @xmath411 that is smaller than the core factor .",
    "we let @xmath412 be the transitive closure of @xmath386 and call two matrices @xmath226 _ partition equivalent _ if @xmath413 .",
    "let @xmath378 .",
    "we let @xmath51_0:=a$ ] and @xmath51_{i+1}:=[[a]_i]$ ] for every @xmath414 .",
    "then there is an @xmath415 such that @xmath51_i=[a]_{i+1}$ ] .",
    "we denote @xmath51_i$ ] by @xmath53 and call it the _ iterated core factor _ of @xmath11 .",
    "observe that implies that @xmath416    the following example shows that @xmath413 does not necessarily imply @xmath417 and that @xmath53 is not necessarily the smallest matrix partition equivalent to @xmath11 .",
    "this is unfortunate , because it leaves us without an efficient way of deciding partition equivalence .",
    "[ exa : cf ] consider the matrices @xmath418 suppose that for @xmath233 the rows and columns of the matrix @xmath399 are indexed by @xmath419 .",
    "the matrices @xmath85 and @xmath86 are partition equivalent : for the equitable partition ( indicated by the lines in @xmath85 ) @xmath420 of @xmath85 we have @xmath421 thus @xmath422 .",
    "the coarsest equitable partition of @xmath85 is the trivial partition @xmath423 , and thus @xmath424=(2).\\ ] ] the coarsest equitable partition of @xmath86 is the identity partition @xmath425 , which yields @xmath426 thus @xmath427 .",
    "note that this also means that the smallest matrix partition equivalent to @xmath86 is not @xmath428 , as one might have expected , but @xmath429 .",
    "it remains an open question whether partition equivalence is decidable , or even decidable in polynomial time .",
    "note , however , that we can compute @xmath53 from @xmath11 in time @xmath430 .",
    "it is conceivable that this can be improved to @xmath3 , but this remains open as well .",
    "in this section , we will apply our theory of fractional automorphisms and partition equivalence to solving systems of linear equations and linear programs .",
    "let @xmath4 , @xmath431 , @xmath432 , and @xmath433 .",
    "we consider the system @xmath434 of linear equations , the linear program in standard form @xmath435 and the linear program in dual form @xmath436 our results actually extend to arbitrary linear programs , but we focus on these for the ease of presentation .    we need to take the vectors @xmath437 and @xmath2 into account .",
    "let @xmath58 be as above .",
    "we define a matrix @xmath438 , where we assume @xmath439 and @xmath440 , by @xmath441 ( see example  [ exa : intro ] ) . as @xmath11 is a real matrix ( that does not contain @xmath442 as an entry ) , every equitable partition @xmath443 of @xmath61 contains @xmath444 and @xmath445 as separate classes . if we let @xmath446 and @xmath447 , then @xmath37 is an equitable partition of @xmath11 satisfying @xmath448 furthermore , if @xmath443 is the coarsest equitable partition of @xmath61 then @xmath37 is the coarsest equitable partition of @xmath11 that satisfies and .",
    "[ lem : red ] let @xmath449 as above .",
    "let @xmath443 an equitable partition of @xmath61 and @xmath446 , @xmath447 .",
    "furthermore , let @xmath450 and @xmath376 and @xmath451 , @xmath452 , and @xmath453",
    "if @xmath454 is a solution to or a feasible solution to or , then @xmath455 is a solution to ( @xmath456 ) or a feasible solution to ( @xmath457 ) or ( @xmath458 ) , respectively .",
    "+ moreover , if @xmath71 is an optimal solution to or , then @xmath68 is an optimal solution to ( @xmath457 ) or ( @xmath458 ) , respectively .",
    "if @xmath459 is a solution to ( @xmath456 ) or a feasible solution to ( @xmath460 ) or ( @xmath458 ) , then @xmath461 is a solution to or a feasible solution to or , respectively .",
    "+ moreover , if @xmath68 is an optimal solution to ( @xmath460 ) or ( @xmath458 ) , then @xmath71 is an optimal solution to or , respectively .",
    "we only prove this for the linear programs and ( @xmath460 ) in standard form ; the proofs for systems of linear equations and linear programs in dual form are similar .",
    "observe first that @xmath462 . to see this , recall from that @xmath463 if @xmath40 for some @xmath38 and @xmath464 otherwise .",
    "let @xmath92 and @xmath38",
    ". then @xmath465 similarly , @xmath466 .    to prove ( 1 ) ,",
    "let @xmath454 be a feasible solution to and @xmath467 .",
    "then @xmath468 because @xmath469 and @xmath470 is nonnegative .",
    "furthermore , @xmath471 here ( a ) holds because @xmath377 is a fractional automorphism of @xmath11 and ( b ) holds because @xmath462 and @xmath472 .",
    "thus @xmath68 is a feasible solution to ( @xmath460 ) .    before we prove the second assertion of ( 1 ) regarding optimal solutions , we prove the first assertion of ( 2 ) .",
    "let @xmath459 be a feasible solution to ( @xmath460 ) and @xmath473 .",
    "then @xmath474 because @xmath475 and @xmath75 is nonnegative .",
    "furthermore , @xmath476 here ( c ) holds , because @xmath466 , and ( d ) holds , because @xmath377 is a fractional automorphism of @xmath11 . to prove ( e ) , let @xmath92 , and let @xmath38 such that @xmath477 . by",
    ", we have @xmath478 thus @xmath71 is a feasible solution to .",
    "it remains to prove the two assertions about optimal solutions .",
    "suppose first that @xmath454 is an optimal solution to , and let @xmath455 .",
    "then @xmath68 is a feasible solution to ( @xmath460 ) .",
    "we claim that it is optimal .",
    "let @xmath479 be another feasible solution to ( @xmath460 ) .",
    "we shall prove that @xmath480 .",
    "let @xmath481 .",
    "then @xmath482 is a feasible solution to , and thus @xmath483 by the optimality of @xmath71 .",
    "thus @xmath484 here ( f ) holds because @xmath485 . to see this ,",
    "let @xmath150 and @xmath39 such that @xmath486 .",
    "then by , @xmath487 suppose conversely that @xmath459 is an optimal solution to ( @xmath460 ) and let @xmath461 .",
    "then @xmath71 is a feasible solution to .",
    "let @xmath482 be another feasible solution .",
    "then @xmath488 is a feasible solution to ( @xmath460 ) , and by the optimality of @xmath68 we have @xmath480 .",
    "thus @xmath489 the two equations marked ( f ) hold , because @xmath485 , as we have seen above .",
    "note that if we apply the reduction lemma to a system of linear equations , then the vector @xmath2 is irrelevant , and we can simply let @xmath490 .    for simplicity , in the following we state our results only for linear programs in standard form .",
    "the corresponding results for linear programs in dual form or systems of linear equations hold as well .",
    "[ theo : red ] for @xmath233 , let @xmath287 and @xmath491 and @xmath492 and @xmath493 .",
    "suppose that @xmath494 then for @xmath233 there is a matrix @xmath495 such that for all @xmath496 , if @xmath71 is a feasible solution to ( @xmath497 ) then @xmath498 is a feasible solution to ( @xmath499 ) .",
    "furthermore , if @xmath71 is an optimal solution to ( @xmath497 ) then @xmath498 is an optimal solution to ( @xmath499 ) .",
    "assume first that @xmath500 .",
    "for @xmath233 , let @xmath501 be an equitable partition of @xmath399 such that @xmath502 let @xmath503 and @xmath504 be bijections such that @xmath505 for all @xmath506 .",
    "let @xmath507 be the indices of the row and column of @xmath508 such that @xmath509 . recall that @xmath510 and @xmath511 are classes in @xmath512 , respectively",
    "observe that @xmath513 and that all other entries of @xmath514 are real .",
    "thus @xmath515 and @xmath516 .",
    "let @xmath517 and @xmath518 and @xmath519 .",
    "let @xmath520 .",
    "then @xmath521 for all @xmath522 .",
    "let @xmath523 .",
    "then @xmath524 for all @xmath525 .",
    "let @xmath526 .",
    "then @xmath527 for all @xmath528 .",
    "now let @xmath529 be the restriction of @xmath530 to @xmath110 , and let @xmath531 be the restriction of @xmath532 to @xmath111 .",
    "then for all @xmath533 we have @xmath534 and @xmath535 and @xmath536 .",
    "let @xmath537 and @xmath538 be permutation matrices corresponding to the bijections @xmath539 , respectively",
    ". then @xmath540 and @xmath541 and @xmath542 .",
    "now let @xmath543 and @xmath544 .",
    "it follows from the reduction lemma  [ lem : red ] that these matrices satisfy the conditions of the lemma .",
    "let us now consider the general case @xmath545 .",
    "then there is a sequence @xmath546 of matrices such that @xmath547 for all @xmath548 $ ] .",
    "the reason the claim does not follow immediately from the claim for matrices @xmath422 by multiplying the chain of matrices @xmath549 is that the intermediate matrices @xmath550 may not be of the form @xmath551 . observe that a matrix @xmath384 is of this form if and only if it has exactly one @xmath442-entry . as @xmath442 appears in @xmath85 , it is clear that all @xmath550 have at least one @xmath442-entry .",
    "but they may have more than one",
    ". we can handle this by collapsing all @xmath442-entries to a single one . to make this precise ,",
    "consider a matrix @xmath552 .",
    "let @xmath553 be the set of all indices of rows with at least one @xmath442-entry , and let @xmath554 be the set of all indices of columns with at least one @xmath442-entry .",
    "observe that every equitable partition of @xmath384 refines the partition @xmath555 .",
    "let @xmath556 and @xmath557 be arbitrary , and let @xmath558 and @xmath559 .",
    "we define the matrix @xmath560 by @xmath561 it is not hard to prove that for all matrices @xmath562 , @xmath563 thus , coming back to the sequence @xmath546 , we have @xmath564 we have @xmath565 , because @xmath399 only has one @xmath442-entry .",
    "the assertion of the lemma follows .",
    "example  [ exa : intro ] illustrates how the theorem can be applied .",
    "the matrix @xmath75 in is the product of the partition matrices corresponding to the coarsest equitable partitions of @xmath61 and @xmath63 $ ] .",
    "note that theorem  [ theo : red ] is not algorithmic , because we do not know how to decide partition equivalence .",
    "fortunately , this is not a problem for the main application , where we only apply the reduction lemma  [ lem : red ] once to the coarsest equitable partition .",
    "we believe that the gain we may have by searching for a smaller partition equivalent matrix than the core factor , for example the iterated core factor , is almost always outweighed by the additional time spent to find such a matrix .",
    "but we have not yet conducted any systematic experiments in this direction yet .",
    "let us briefly describe our implementation .",
    "we are given @xmath4 , @xmath431 , @xmath432 and want to solve the linear program .",
    "to apply the reduction lemma , instead of computing the coarsest equitable partition of the matrix @xmath551 , we directly compute the coarsest equitable partition @xmath37 of @xmath11 that refines an initial partition @xmath566 depending on the vectors @xmath437 and @xmath2 : @xmath567 is the partition of @xmath6 where @xmath74 and @xmath568 are in the same class if @xmath569 , and @xmath570 is defined similarly from @xmath2 .",
    "( then @xmath571 is the coarsest equitable partition of @xmath61 . )",
    "we compute @xmath37 using colour refinement starting from the initial partition @xmath566 .",
    "our colour refinement implementation is based on the algorithm described in section  [ sec : alg ] .",
    "bdi , grundhfer and herr  @xcite proposed the following method of symmetry reduction for linear programs .",
    "they define an _ automorphism _ of to be a pair @xmath46 of permutation matrices such that @xmath201 and @xmath572 and @xmath573 .",
    "automorphisms have an obvious group structure ; let @xmath574 denote the group of all automorphisms .",
    "bdi et al.observe that for every feasible solution @xmath71 to , @xmath575 is a feasible solution as well , and if @xmath71 is an optimal solution then @xmath68 is an optimal solution .",
    "they argue that @xmath68 is in the intersection @xmath576 of the @xmath27-eigenspaces of all matrices @xmath173 such that @xmath577 for some @xmath93 .",
    "if there are many automorphisms , the dimension of @xmath576 can be expected to be much smaller than @xmath156 , and thus we can reduce the number of variables of the linear program by projecting to @xmath576 .    to see that this method of symmetry reduction is subsumed by our reduction lemma , observe that the pair @xmath46 of matrices defined by @xmath578 is a fractional automorphism of @xmath11 with @xmath572 and @xmath573 , and",
    "thus it yields a fractional automorphism of @xmath61 . by theorem  [ theo : aut ] , @xmath181 is an equitable partition of @xmath11 .",
    "the dimension of the @xmath576 is equal to the rank of @xmath173 , which is at least @xmath579 and thus at least @xmath580 for the coarsest equitable partition @xmath37 of @xmath11 satisfying and .",
    "thus the dimension of the linear program we obtain via the reduction lemma is at most that of the linear program that bdi et al .",
    "project to .",
    "the additional benefit of our method is that colour refinement is much more efficient than computing the automorphism group of a linear program .",
    "( our experiments , described in the next section , show that this last point is what makes our method significantly more efficient in practice . )",
    "our intention here is to investigate the computational benefits of colour refinement for solving linear programs in the presence of symmetries . to this aim , we realised our colour refinement based on the saucy  @xcite , where the unweighted version is already implemented as a preprocessing heuristic for automorphism group computation .",
    "we modified the code to return the colour classes after preprocessing and not proceed with the actual automorphism search . from the colour classes we computed the reduced lps according to lemma  [",
    "lem : red ] .",
    "we used cvxopt ( http://cvxopt.org/ ) for solving the original and reduced linear programs .",
    "we report on the dimensions of the linear programs and on the running times when solving the original linear programs ( without compression ) as well as the reduced ones using colour refinement .",
    "we additionally compare the results to the symmetry reduction approach due to bdi et al .",
    "@xcite described in section  [ sec : symm ] ( which we also implemented using saucy ) .",
    "all experiments were conducted on a standard linux desktop machine with a 3 ghz intel core2-duo processor and 8 gb ram ."
  ],
  "abstract_text": [
    "<S> colour refinement is a basic algorithmic routine for graph isomorphism testing , appearing as a subroutine in almost all practical isomorphism solvers . </S>",
    "<S> it partitions the vertices of a graph into `` colour classes '' in such a way that all vertices in the same colour class have the same number of neighbours in every colour class . </S>",
    "<S> tinhofer @xcite , ramana , scheinerman , and ullman @xcite and godsil @xcite established a tight correspondence between colour refinement and fractional isomorphisms of graphs , which are solutions to the lp relaxation of a natural ilp formulation of graph isomorphism .    </S>",
    "<S> we introduce a version of colour refinement for matrices and extend existing quasilinear algorithms for computing the colour classes . </S>",
    "<S> then we generalise the correspondence between colour refinement and fractional automorphisms and develop a theory of fractional automorphisms and isomorphisms of matrices .    </S>",
    "<S> we apply our results to reduce the dimensions of systems of linear equations and linear programs . </S>",
    "<S> specifically , we show that any given lp @xmath0 can efficiently be transformed into a ( potentially ) smaller lp @xmath1 whose number of variables and constraints is the number of colour classes of the colour refinement algorithm , applied to a matrix associated with the lp . </S>",
    "<S> the transformation is such that we can easily ( by a linear mapping ) map both feasible and optimal solutions back and forth between the two lps . </S>",
    "<S> we demonstrate empirically that colour refinement can indeed greatly reduce the cost of solving linear programs . </S>"
  ]
}