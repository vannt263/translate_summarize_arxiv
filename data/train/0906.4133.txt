{
  "article_text": [
    ", the time at which the signal is to be estimated.,scaledwidth=48.0% ]    estimation theory is the science of determining the state of a system , such as a dice , an aircraft , or the weather in boston , from noisy observations @xcite . as shown in fig .",
    "[ classes ] , estimation problems can be classified into four classes , namely , prediction , filtering , retrodiction , and smoothing . for applications that do not require real - time data , such as sensing and communication , smoothing is the most accurate estimation technique .",
    "i have recently proposed a time - symmetric quantum theory of smoothing , which allows one to optimally estimate classical diffusive markov random processes , such as gravitational waves or magnetic fields , coupled to a quantum system , such as a quantum mechanical oscillator or an atomic spin ensemble , under continuous measurements @xcite . in this paper ,",
    "i shall demonstrate in more detail the derivation of this theory using a discrete - time approach , and how it closely parallels the classical time - symmetric smoothing theory proposed by pardoux @xcite .",
    "i shall apply the theory to the design of homodyne phase - locked loops ( pll ) for narrowband squeezed optical beams , as previously considered by berry and wiseman @xcite .",
    "i shall show that their approach can be regarded as a special case of my theory , and discuss how their results can be generalized and improved .",
    "i shall also discuss the weak value theory proposed by aharonov _",
    "et al . _",
    "@xcite in relation with the smoothing theory , and how their theory may be regarded as a smoothing theory for quantum degrees of freedom . in particular , the smoothing quasiprobability distribution proposed in ref .",
    "@xcite is shown to naturally arise from the statistics of weak position and momentum measurements .",
    "this paper is organized as follows : in sec .",
    "[ classical ] , pardoux s classical time - symmetric smoothing theory is derived using a discrete - time approach , which is then generalized to the quantum regime for hybrid classical - quantum smoothing in sec .  [ hybrid ] .",
    "application of the hybrid classical - quantum smoothing theory to pll design is studied in sec .",
    "[ adaptive ] .",
    "the relation between the smoothing theory and aharonov _ et al . _",
    "s weak value theory is then discussed in sec .",
    "[ conclusion ] concludes the paper and points out some possible extensions of the proposed theory .",
    "consider the classical smoothing problem depicted in fig .  [ classical_smoothing ] .",
    "let @xmath0}\\end{aligned}\\ ] ] be a vectoral diffusive markov random process that satisfies the system it differential equation @xcite @xmath1 where @xmath2 is a vectoral wiener increment with mean and covariance matrix given by @xmath3 the superscript @xmath4 denotes the transpose .",
    "the vectoral observation process @xmath5 satisfies the observation it equation @xmath6 where @xmath7 is another vectoral wiener increment with mean and covariance matrix given by @xmath8 for generality and later purpose , @xmath2 and @xmath7 are assumed to be correlated , with covariance @xmath9 define the observation record in the time interval @xmath10 as @xmath11 the goal of smoothing is to calculate the conditional probability density of @xmath12 , given the observation record @xmath13 in the time interval @xmath14 .",
    "it is more intuitive to consider the problem in discrete time first .",
    "the discrete - time system and observation equations ( [ system ] ) and ( [ observ ] ) are @xmath15 the observation record @xmath16 } & \\equiv   { \\left\\{\\delta y_{t_0},\\delta y_{t_0+\\delta t},\\dots,\\delta y_{t-\\delta t}\\right\\}}\\end{aligned}\\ ] ] also becomes discrete .",
    "the covariance matrices for the increments are @xmath17 and the increments at different times are independent of one another . because @xmath18 and @xmath19 are proportional to @xmath20 , one should keep all linear _ and _ quadratic terms of the wiener increments in an equation according to it calculus when taking the continuous time limit .    with correlated @xmath18 and @xmath19 , it is preferable , for technical reasons , to rewrite the system equation ( [ discrete_system ] ) as @xcite @xmath21},\\end{aligned}\\ ] ] where @xmath22 can be arbitrarily set because the expression in square brackets is zero .",
    "the system equation becomes @xmath23}\\delta t+ d(x_t , t)\\delta y_t   \\nonumber\\\\&\\quad + b(x_t , t)\\delta w_t - d(x_t , t)\\delta v_t.\\end{aligned}\\ ] ] the new system noise is @xmath24\\delta t.\\end{aligned}\\ ] ] the covariance between the new system noise @xmath25 and the observation noise @xmath19 is @xmath26}\\delta t,\\end{aligned}\\ ] ] and can be made to vanish if one lets @xmath27 the new equivalent system and observation model is then @xmath28 } \\nonumber\\\\&\\quad + b(x_t , t)\\delta u_t , \\label{new_system}\\\\ \\delta y_t & = c(x_t , t)\\delta t + \\delta v_t , \\label{new_observ}\\end{aligned}\\ ] ] with covariances @xmath29}\\delta t , \\\\ { \\left\\langle\\delta v_t\\delta v_t^t\\right\\rangle } & = r(t)\\delta t , \\\\ { \\left\\langle\\delta u_t\\delta v_t^t\\right\\rangle } & = 0.\\end{aligned}\\ ] ] the new system and observation noises are now independent , but note that @xmath30 becomes dependent on @xmath31 .      according to the bayes theorem ,",
    "the smoothing probability density for @xmath12 can be expressed as @xmath32 } ) & =   \\frac{p(\\delta y_{[t_0,t-\\delta t]}|x_\\tau ) p(x_\\tau ) } { p(\\delta y_{[t_0,t-\\delta t ] } ) } , \\label{bayes } \\\\",
    "p(\\delta y_{[t_0,t-\\delta t ] } ) & = \\int dx_\\tau p(\\delta y_{[t_0,t-\\delta t]}|x_\\tau ) p(x_\\tau),\\end{aligned}\\ ] ] where @xmath33 and @xmath34 is the _ a priori _ probability density , which represents one s knowledge of @xmath12 absent any observation",
    ". functions of @xmath12 are assumed to also depend implicitly on @xmath35 . splitting @xmath36}$ ] into the past record @xmath37}\\end{aligned}\\ ] ] and the future record @xmath38}\\end{aligned}\\ ] ] relative to time @xmath35 , @xmath39 in eq .",
    "( [ bayes ] ) can be rewritten as @xmath40}|x_\\tau ) & = p(\\delta y_{\\textrm{past}},\\delta y_{\\textrm{future}}|x_\\tau ) \\nonumber\\\\ & = p(\\delta y_{\\textrm{future}}|\\delta y_{\\textrm{past}},x_\\tau ) p(\\delta y_{\\textrm{past}}|x_\\tau).\\end{aligned}\\ ] ] because @xmath19 are independent increments , the future record is independent of the past record given @xmath12 , and @xmath40}|x_\\tau ) & = p(\\delta y_{\\textrm{future}}|x_\\tau)p(\\delta y_{\\textrm{past}}|x_\\tau).\\end{aligned}\\ ] ] equation ( [ bayes ] ) becomes @xmath32 } ) & = \\frac{p(\\delta y_{\\textrm{future}}|x_\\tau)p(\\delta y_{\\textrm{past}}|x_\\tau)p(x_\\tau ) } { \\int dx_\\tau ( \\textrm{numerator } ) } \\nonumber\\\\ & = \\frac{p(\\delta y_{\\textrm{future}}|x_\\tau)p(x_\\tau|\\delta y_{\\textrm{past } } ) } { \\int dx_\\tau ( \\textrm{numerator})}. \\label{twofilter}\\end{aligned}\\ ] ] thus , the smoothing density can be obtained by combining the filtering probability density @xmath41 and a retrodictive likelihood function @xmath42 .      to derive an equation for the filtering probability density @xmath41 , first express @xmath43})$ ] in terms of @xmath44})$ ] as @xmath45 } ) & = \\int dx_t p(x_{t+\\delta t},x_t|\\delta y_{[t_0,t ] } ) \\nonumber\\\\ & = \\int dx_t p(x_{t+\\delta t}|x_t,\\delta y_{[t_0,t ] } ) p(x_t|\\delta y_{[t_0,t]}).\\end{aligned}\\ ] ] @xmath46})= p(x_{t+\\delta",
    "t}|x_t,\\delta y_t,\\delta y_{[t_0,t-\\delta t]})$ ] can be determined from the system equation ( [ new_system ] ) and is equal to @xmath47 , due to the markovian nature of the system process .",
    "so @xmath45 } ) & = \\int dx_t p(x_{t+\\delta t}|x_t,\\delta y_{t } ) p(x_t|\\delta y_{[t_0,t ] } ) , \\label{ck}\\end{aligned}\\ ] ] which is a generalized chapman - kolmogorov equation @xcite .",
    "@xmath48 is @xmath49}^{-1 } \\delta z_t\\bigg\\ } , \\label{gauss_system}\\end{aligned}\\ ] ] where @xmath50}.\\end{aligned}\\ ] ] next , write @xmath51})$ ] in terms of @xmath52})$ ] using the bayes theorem as @xmath53 } ) & = p(x_t|\\delta y_{[t_0,t-\\delta t]},\\delta y_t ) \\nonumber\\\\ & = \\frac{p(\\delta y_t|x_t,\\delta y_{[t_0,t-\\delta t]})p(x_t|\\delta y_{[t_0,t-\\delta t ] } ) } { \\int dx_t ( \\textrm{numerator } ) } \\nonumber\\\\ & = \\frac{p(\\delta y_t|x_t)p(x_t|\\delta y_{[t_0,t-\\delta t ] } ) } { \\int dx_t ( \\textrm{numerator } ) } , \\label{bayes2}\\end{aligned}\\ ] ] where @xmath54 } ) = p(\\delta y_t|x_t)$ ] due to the markovian property of the observation process .",
    "@xmath55 is determined by the observation equation ( [ new_observ ] ) and given by @xmath56}^t { \\left[r(t)\\delta t\\right]}^{-1}\\nonumber\\\\&\\quad\\times { \\left[\\delta y_t - c(x_t , t)\\delta t\\right]}\\bigg\\}. \\label{gauss_observ}\\end{aligned}\\ ] ] hence , starting with the _ a priori _ probability density @xmath57 , one can solve for @xmath41 by iterating the formula @xmath45 } ) & = \\int dx_t p(x_{t+\\delta t}|x_t,\\delta y_t ) \\nonumber\\\\&\\quad\\times \\frac{p(\\delta y_t|x_t)p(x_t|\\delta y_{[t_0,t-\\delta t ] } ) } { \\int dx_t ( \\textrm{numerator})}. \\label{iterate}\\end{aligned}\\ ] ] to obtain a stochastic differential equation for the filtering probability density , defined as @xmath58 in the continuous time limit , one should expand eq .",
    "( [ iterate ] ) to first order with respect to @xmath59 and second order with respect to @xmath31 in a taylor series , then apply the rules of it calculus .",
    "the result is the kushner - stratonovich ( ks ) equation @xcite , generalized for correlated system and observation noises by fujisaki _",
    "et al . _",
    "@xcite , given by @xmath60 } \\nonumber\\\\&\\quad + { \\left(c-{\\langlec\\rangle}_f\\right)}^tr^{-1}d\\eta_t f \\nonumber\\\\&\\quad -\\sum_{\\mu}{\\frac{\\partial } { \\partial x_\\mu } } { \\left[{\\left(bsr^{-1}d\\eta_t\\right)}_\\mu f\\right ] } , \\label{kushner}\\end{aligned}\\ ] ] where @xmath61 the initial condition is @xmath62 @xmath63 is called the innovation process and is also a wiener increment with covariance matrix @xmath64 @xcite .    a linear stochastic equation for an unnormalized @xmath65",
    "is called the duncan - mortensen - zakai ( dmz ) equation @xcite , given by @xmath66 } \\nonumber\\\\&\\quad + c^tr^{-1}dy_t f -\\sum_{\\mu}{\\frac{\\partial } { \\partial x_\\mu } } { \\left[{\\left(bsr^{-1}dy_t\\right)}_\\mu f\\right ] } , \\label{zakai}\\end{aligned}\\ ] ] where the normalization is @xmath67      to solve for the retrodictive likelihood function @xmath42 , note that @xmath68 but @xmath69 can also be expressed in terms of the multitime probability density as @xmath70 } ) & = \\int dx_{[\\tau , t ] } p(x_{[\\tau , t]},\\delta y_{[\\tau , t-\\delta t]}),\\end{aligned}\\ ] ] where @xmath71 } & \\equiv { \\left\\{x_\\tau , x_{\\tau+\\delta t},\\dots , x_t\\right\\ } } , \\\\ \\int dx_{[\\tau , t ] } & \\equiv \\int dx_\\tau \\int dx_{\\tau+\\delta t}\\dots\\int dx_t.\\end{aligned}\\ ] ] the multitime density can be rewritten as @xmath72},\\delta y_{[\\tau , t-\\delta t ] } ) & = p(x_t|x_{[\\tau , t-\\delta t]},\\delta y_{[\\tau , t-\\delta t ] } ) \\nonumber\\\\&\\quad\\times p(x_{[\\tau , t-\\delta t]},\\delta y_{[\\tau , t-\\delta t ] } ) . \\label{multitime}\\end{aligned}\\ ] ] again using the markovian property of the system process , @xmath73},\\delta y_{[\\tau , t-\\delta t ] } ) = p(x_t|x_{t-\\delta    t},\\delta y_{t-\\delta t } ) , \\label{markov_system}\\end{aligned}\\ ] ] which can be determined from the system equation ( [ new_system ] ) and is given by eq .",
    "( [ gauss_system ] ) .",
    "furthermore , @xmath74},\\delta y_{[\\tau , t-\\delta t]})$ ] in eq .",
    "( [ multitime ] ) can be expressed as @xmath75},\\delta y_{[\\tau , t-\\delta t ] } ) & = p(\\delta y_{t-\\delta t}|x_{[\\tau , t-\\delta t]},\\delta y_{[\\tau , t-2\\delta t ] } ) \\nonumber\\\\&\\quad\\times p(x_{[\\tau , t-\\delta t]},\\delta y_{[\\tau , t-2\\delta t ] } ) . \\label{multitime2}\\end{aligned}\\ ] ] using the markovian property of the observation process , @xmath76},\\delta y_{[\\tau , t-2\\delta t ] } ) = p(\\delta y_{t-\\delta t}|x_{t-\\delta t } ) , \\label{markov_observe}\\end{aligned}\\ ] ] which can be determined from the observation equation ( [ new_observ ] ) and is given by eq .",
    "( [ gauss_observ ] ) . applying eqs .",
    "( [ multitime ] ) , ( [ markov_system ] ) , ( [ multitime2 ] ) , and ( [ markov_observe ] ) repeatedly , one obtains @xmath70 } ) & = \\int dx_t \\int dx_{t-\\delta t } p(x_t|x_{t-\\delta t},\\delta y_{t-\\delta t } ) \\nonumber\\\\&\\quad\\times   p(\\delta y_{t-\\delta t}|x_{t-\\delta t } ) \\nonumber\\\\&\\quad\\times \\int dx_{t-2\\delta t } p(x_{t-\\delta t}|x_{t-2\\delta t},\\delta y_{t-2\\delta t } ) \\nonumber\\\\&\\quad\\times   p(\\delta y_{t-2\\delta t}|x_{t-2\\delta t})\\dots",
    "\\nonumber\\\\&\\quad\\times \\int dx_\\tau p(x_{\\tau+\\delta t}|x_\\tau,\\delta y_\\tau ) \\nonumber\\\\&\\quad\\times p(\\delta y_{\\tau}|x_\\tau)p(x_\\tau ) . \\label{expand}\\end{aligned}\\ ] ] comparing this equation with eq .",
    "( [ retro ] ) , @xmath42 can be expressed as @xmath77 defining the unnormalized retrodictive likelihood function at time @xmath78 as @xmath79 one can derive a linear backward stochastic differential equation for @xmath80 by applying it calculus backward in time to eq .",
    "( [ retro2 ] ) .",
    "the result is @xcite @xmath81 which is the adjoint equation of the forward dmz equation ( [ zakai ] ) , to be solved backward in time in the backward it sense , defined by @xmath82 with the final condition @xmath83 the adjoint equation with respect to a linear differential equation @xmath84 is defined as @xmath85 where @xmath86 is a linear operator and @xmath87 is the adjoint of @xmath86 , defined by @xmath88 with respect to the inner product @xmath89    after solving eq .",
    "( [ zakai ] ) for @xmath90 and eq .",
    "( [ backward_zakai ] ) for @xmath91 , the smoothing probability density is @xmath92 since @xmath90 and @xmath91 are solutions of adjoint equations , their inner product , which appears as the denominator of eq .",
    "( [ smooth ] ) , is constant in time @xcite .",
    "the denominator also ensures that @xmath93 is normalized , and @xmath90 and @xmath91 need not be normalized separately .",
    "the estimation errors depend crucially on the statistics of @xmath94 .",
    "if any component of @xmath94 , say @xmath95 , is constant in time , then filtering of that particular component is as accurate as smoothing , for the simple reason that @xmath96 must be the same for any @xmath35 , and one can simply estimate @xmath97 at the end of the observation interval ( @xmath98 ) using filtering alone .",
    "this also means that smoothing is not needed when one only needs to detect the presence of a signal in detection problems @xcite , since the presence can be regarded as a constant binary parameter within a certain time interval . in general , however , smoothing can be significantly more accurate than filtering for the estimation of a fluctuating random process in the middle of the observation interval .",
    "another reason for modeling unknown signals as random processes is robustness , as introducing fictitious system noise can improve the estimation accuracy when there are modeling errors @xcite .",
    "if @xmath99 , @xmath100 , and @xmath101 are gaussian , one can just solve for their means and covariance matrices , which completely determine the probability densities .",
    "this is the case when the _ a priori _ probability density @xmath57 is gaussian , and @xmath102 the means and covariance matrices of @xmath99 , @xmath100 , and @xmath101 can then be solved using the linear mayne - fraser - potter ( mfp ) smoother @xcite .",
    "the smoother first solves for the mean @xmath103 and covariance matrix @xmath104 of @xmath99 using the kalman filter @xcite , given by @xmath105 with the initial conditions at @xmath106 determined from @xmath57 .",
    "the mean @xmath107 and covariance matrix @xmath108 of @xmath100 are then solved using a backward kalman filter , @xmath109 with the final condition @xmath110 and @xmath111 . in practice",
    ", the information filter formalism should be used to solve the backward filter , in order to avoid dealing with the infinite covariance matrix at @xmath112 @xcite .",
    "finally , the smoothing mean @xmath113 and covariance matrix @xmath114 are @xmath115 note that @xmath107 and @xmath108 are the mean and covariance matrix of a likelihood function @xmath116 and not those of a conditional probability density @xmath117 , so to perform optimal retrodiction ( @xmath118 ) one should still combine @xmath107 and @xmath108 with the _ a priori _ values @xcite .",
    "consider the problem of waveform estimation in a hybrid classical - quantum system depicted in fig .",
    "[ hybrid_smooth ] .",
    "the classical system produces a vectoral classical diffusive markov random process @xmath94 , which obeys eq .",
    "( [ system ] ) and is coupled to the quantum system . the goal is to estimate @xmath12 via continuous measurements of both systems .",
    "this setup is slightly more general than that considered in @xcite ; here the observations can also depend on @xmath94 .",
    "this allows one to apply the theory to pll design for squeezed beams , as considered by berry and wiseman @xcite , and potentially to other quantum estimation problems as well @xcite .",
    "the statistics of @xmath94 are assumed to be unperturbed by the coupling to the quantum system , in order to avoid the nontrivial issue of quantum backaction on classical systems @xcite . for simplicity ,",
    "in this section we neglect the possibility that the system noise driving the classical system is correlated with the observation noise , although the noise driving the quantum system can still be correlated with the observation noise due to quantum measurement backaction .",
    "just as in the classical smoothing problem , the hybrid smoothing problem is solved by calculating the smoothing probability density @xmath119 .      because a quantum system is involved , one may be tempted to use a hybrid density operator @xcite to represent one s knowledge about the hybrid classical - quantum system .",
    "the hybrid density operator @xmath120 describes the joint classical and quantum statistics of a hybrid system , with the marginal classical probability density for @xmath12 and the marginal density operator for the quantum system given by @xmath121 } , \\\\",
    "\\hat\\rho(\\tau ) & = \\int dx_\\tau \\hat\\rho(x_\\tau),\\end{aligned}\\ ] ] respectively .",
    "the hybrid operator can also be regarded as a special case of the quantum density operator , when certain degrees of freedom are approximated as classical .",
    "unfortunately , the density operator in conventional predictive quantum theory can only be conditioned upon past observations and not future ones , so it can not be used as a quantum version of the smoothing probability density .    the classical time - symmetric smoothing theory , as a combination of prediction and retrodiction , offers an important clue to how one can circumvent the difficulty of defining the smoothing quantum state . again casting the problem in discrete time , and defining a hybrid effect operator as @xmath122 , which can be used to determine the statistics of future observations given a density operator at @xmath35 , @xmath123},\\end{aligned}\\ ] ]",
    "one may write , in analogy with eq .",
    "( [ twofilter ] ) @xcite , @xmath32 } ) & = \\frac{p(x_\\tau,\\delta y_{\\textrm{future}}|\\delta y_{\\textrm{past } } ) } { p(\\delta y_{\\textrm{future}}|\\delta y_{\\textrm{past } } ) } \\nonumber\\\\ & = \\frac{{\\operatorname{tr}}[\\hat e(\\delta y_{\\textrm{future}}|x_\\tau ) \\hat\\rho(x_\\tau|\\delta y_{\\textrm{past } } ) ] } { \\int dx_\\tau { \\operatorname{tr}}[\\hat e(\\delta y_{\\textrm{future}}|x_\\tau ) \\hat\\rho(x_\\tau|\\delta y_{\\textrm{past } } ) ] } , \\label{two_qfilter}\\end{aligned}\\ ] ] where @xmath124 is the analog of the filtering probability density @xmath41 and @xmath122 is the analog of the retrodictive likelihood function @xmath42 .",
    "one can then solve for the density and effect operators separately , before combining them to form the classical smoothing probability density .",
    "since the hybrid density operator can be regarded as a special case of the density operator , the same tools in quantum measurement theory can be used to derive a filtering equation for the hybrid operator .",
    "first , write @xmath125})$ ] in terms of @xmath126})$ ] as @xmath127 } ) & = \\int dx_t \\mathcal k(x_{t+\\delta t}|x_t)\\hat\\rho(x_t|\\delta y_{[t_0,t ] } ) , \\label{qck}\\end{aligned}\\ ] ] where @xmath128 is a completely positive map that governs the markovian evolution of the hybrid state independent of the measurement process . equation ( [ qck ] ) may be regarded as a quantum version of the classical chapman - kolmogorov equation . for infinitesimal @xmath129 , @xmath130}_{x= x_{t+\\delta t}}.\\end{aligned}\\ ] ]",
    "the hybrid superoperator @xmath131 can be expressed as @xmath132 } \\nonumber\\\\&\\quad + \\frac{1}{2}\\sum_{\\mu,\\nu}{\\frac{\\partial ^2}{\\partial x_\\mu\\partial x_\\nu } } { \\left[{\\left(bqb^t\\right)}_{\\mu\\nu}\\hat\\rho(x)\\right ] } , \\label{super_l}\\end{aligned}\\ ] ] where @xmath133 governs the evolution of the quantum system , @xmath134 governs the coupling of @xmath94 to the quantum system , via an interaction hamiltonian for example , and the last two terms governs the classical evolution of @xmath94 .",
    "next , write @xmath126})$ ] in terms of @xmath135})$ ] using the quantum bayes theorem @xcite as @xmath136 } ) & = \\hat\\rho(x_t|\\delta y_{[t_0,t-\\delta t]},\\delta y_t ) \\nonumber\\\\ & = \\frac{\\mathcal j(\\delta y_t|x_t)\\hat\\rho(x_t|\\delta y_{[t_0,t-\\delta t ] } ) } { \\int dx_t{\\operatorname{tr}}(\\textrm{numerator})}. \\label{qbayes}\\end{aligned}\\ ] ] the measurement superoperator @xmath137 , a quantum version of @xmath55 , is defined as @xmath138 for infinitesimal @xmath59 and measurements with gaussian noise , the measurement operator @xmath139 can be approximated as @xcite @xmath140,\\end{aligned}\\ ] ] where @xmath141 is a vectoral observation process , @xmath142 is a vector of hybrid operators , generalized from the purely quantum @xmath143 operators in ref .",
    "@xcite so that the observations may also depend directly on the classical degrees of freedom , and @xmath144 is assumed to be positive . to cast the theory in a form similar to the classical one , perform unitary transformations on @xmath141 and @xmath143 , @xmath145 where @xmath146 is a unitary matrix , and rewrite the measurement operator as @xmath147 @xmath148 is a generalization of @xmath149 in the classical case , and @xmath150 is again a positive - definite matrix that characterizes the observation uncertainties and is real and symmetric with eigenvalues @xmath151 .",
    "note that @xmath152 is defined as the adjoint of each vector element , and @xmath4 is defined as the matrix transpose of the vector . for example , @xmath153 the evolution of @xmath135})$ ] can thus be calculated by iterating the formula @xmath154 } ) \\nonumber\\\\ & = \\int dx_t \\mathcal k(x_{t+\\delta t}|x_t ) \\frac{\\mathcal j(\\delta y_t|x_t)\\hat\\rho(x_t|\\delta y_{[t_0,t-\\delta t ] } ) } { \\int dx_t{\\operatorname{tr}}(\\textrm{numerator})}.\\end{aligned}\\ ] ] taking the continuous time limit via it calculus and defining the conditional hybrid density operator at time @xmath78 as @xmath155 one obtains @xcite @xmath156 } , \\label{qks}\\end{aligned}\\ ] ] where @xmath157 } , \\\\",
    "d\\eta_t & \\equiv   dy_t - \\frac{dt}{2}{\\langle\\hat c+\\hat c^\\dagger\\rangle}_{\\hat f}\\end{aligned}\\ ] ] is a wiener increment with covariance matrix @xmath64 @xcite , h.c .",
    "denotes the hermitian conjugate , and the initial condition is the _ a priori _ hybrid density operator @xmath158 .",
    "equation ( [ qks ] ) is a quantum version of the ks equation ( [ kushner ] ) and can be regarded as a special case of the belavkin quantum filtering equation @xcite .",
    "a linear version of the ks equation for an unnormalized @xmath159 is @xmath160 and the normalization is @xmath161}.\\end{aligned}\\ ] ] equation ( [ qzakai ] ) is a quantum generalization of the dmz equation ( [ zakai ] ) .      taking a similar approach to the one in sec .",
    "[ retro_smooth ] and using the quantum regression theorem , one can express the future observation statistics as @xcite @xmath162 } \\label{qretro}\\\\ & = \\int dx_t { \\operatorname{tr}}\\bigg[\\int dx_{t-\\delta t } \\mathcal k(x_t|x_{t-\\delta t } ) \\nonumber\\\\&\\quad\\cdot   \\mathcal j(\\delta y_{t-\\delta t}|x_{t-\\delta t } ) \\nonumber\\\\&\\quad\\cdot \\int dx_{t-2\\delta t } \\mathcal k(x_{t-\\delta t}|x_{t-2\\delta t } ) \\nonumber\\\\&\\quad\\cdot   \\mathcal j(\\delta y_{t-2\\delta t}|x_{t-2\\delta t})\\dots",
    "\\nonumber\\\\&\\quad\\cdot \\int dx_\\tau \\mathcal k(x_{\\tau+\\delta t}|x_\\tau ) \\mathcal j(\\delta y_{\\tau}|x_\\tau)\\hat\\rho(x_\\tau)\\bigg ] , \\label{qexpand}\\end{aligned}\\ ] ] which are analogous to eq .",
    "( [ retro ] ) and eq .",
    "( [ expand ] ) , respectively . comparing eq .",
    "( [ qretro ] ) with eq .",
    "( [ qexpand ] ) , and defining the adjoint of a superoperator @xmath163 as @xmath164 , such that @xmath165 } & = { \\operatorname{tr}}{\\left\\{{\\left[\\mathcal o^*\\hat e(x)\\right]}\\hat\\rho(x)\\right\\}},\\end{aligned}\\ ] ] the hybrid effect operator can be written as @xmath166 the operation @xmath167 may also be regarded as a hybrid superoperator on a hybrid operator , and is the adjoint of @xmath168 , defined by @xmath169 with respect to the hilbert - schmidt inner product @xmath170}. \\label{inner}\\end{aligned}\\ ] ] one can then rewrite eqs .",
    "( [ qretro ] ) , ( [ qexpand ] ) , and ( [ hybrid_effect ] ) more elegantly as @xmath171 in the continuous time limit , a linear stochastic differential equation for the unnormalized effect operator @xmath172 can be derived .",
    "the result is @xcite @xmath173 to be solved backward in time in the backward it sense , with the final condition @xmath174 equation ( [ backward_qzakai ] ) is the adjoint equation of the forward quantum dmz equation ( [ qzakai ] ) with respect to the inner product defined by eq .",
    "( [ inner ] ) .",
    "it is a generalization of the classical backward dmz equation ( [ backward_zakai ] ) .    finally , after solving eq .",
    "( [ qzakai ] ) for @xmath175 and eq .",
    "( [ backward_qzakai ] ) for @xmath176 , the smoothing probability density is @xmath177 } { \\int dx{\\operatorname{tr}}[\\hat g(x,\\tau)\\hat f(x,\\tau)]}. \\label{qsmooth}\\end{aligned}\\ ] ] the denominator of eq .",
    "( [ qsmooth ] ) ensures that @xmath93 is normalized , so @xmath175 and @xmath176 need not be normalized separately .",
    "table [ analogs ] lists some important quantities in classical smoothing with their generalizations in hybrid smoothing for comparison .",
    "[ cols=\"<,<,<,<\",options=\"header \" , ]      to solve eqs .",
    "( [ qzakai ] ) , ( [ backward_qzakai ] ) , and ( [ qsmooth ] ) , one way is to convert them to equations for quasiprobability distributions @xcite .",
    "the wigner distribution is especially useful for quantum systems with continuous degrees of freedom .",
    "it is defined as @xcite @xmath178 where @xmath179 and @xmath180 are normalized position and momentum vectors .",
    "it has the desirable property @xmath181 which is unique among generalized quasiprobability distributions @xcite . the smoothing probability density given by eq .",
    "( [ qsmooth ] ) can then be rewritten as @xmath182 where @xmath183 and @xmath184 are the wigner distributions of @xmath185 and @xmath186 , respectively .",
    "equation ( [ wigner_smooth ] ) resembles the classical expression ( [ smooth ] ) with the quantum degrees of freedom @xmath179 and @xmath180 marginalized .",
    "if @xmath187 is nonnegative and the stochastic equations for @xmath188 and @xmath189 converted from eqs .",
    "( [ qzakai ] ) and ( [ backward_qzakai ] ) have the same form as the classical dmz equations given by eqs .",
    "( [ zakai ] ) and ( [ backward_zakai ] ) , the hybrid smoothing problem becomes equivalent to a classical one and can be solved using well known classical smoothers .",
    "for example , if @xmath188 and @xmath189 are gaussian , @xmath93 is also gaussian , and their means and covariances can be solved using the linear mfp smoother described in sec .",
    "consider the pll setup depicted in fig .  [ pll ] .",
    "the optical parametric oscillator ( opo ) produces a squeezed vacuum with a squeezed @xmath180 quadrature and an antisqueezed @xmath179 quadrature .",
    "the squeezed vacuum is then displaced by a real constant @xmath190 to produce a phase - squeezed beam , the phase of which is modulated by @xmath191 , an element of the vectoral random process @xmath94 described by the system it equation ( [ system ] ) .",
    "the output beam is measured continuously by a homodyne pll , and the local - oscillator phase @xmath192 is continuously updated according to the real - time measurement record .",
    "the use of pll for phase estimation in the presence of quantum noise has been mentioned as far back as 1971 by personick @xcite .",
    "wiseman suggested an adaptive homodyne scheme to measure a constant phase @xcite , which was then experimentally demonstrated by armen _ et al . _",
    "for the optical coherent state @xcite .",
    "berry and wiseman @xcite and pope _ et al . _",
    "@xcite studied the problem with @xmath193 being a wiener process .",
    "berry and wiseman later generalized the theory to account for narrowband squeezed beams @xcite .",
    "_ et al.__also studied the problem for the case of @xmath94 being a gaussian process @xcite , but the squeezing model considered in refs .",
    "@xcite is not realistic . using the hybrid smoothing theory developed in sec .",
    "[ hybrid ] , one can now generalize these earlier results to the case of an arbitrary diffusive markov process and a realistic squeezing model .",
    "let @xmath194 be the hybrid density operator for the combined quantum - opo - classical - modulator system .",
    "the evolution of the opo below threshold in the interaction picture is governed by @xmath195 } , \\\\",
    "\\hat h_0 & = -i\\frac{\\hbar\\chi}{2 } { \\left(\\hat a\\hat a-\\hat a^\\dagger\\hat a^\\dagger\\right ) } \\\\ & = \\frac{\\hbar\\chi}{2}{\\left(\\hat q\\hat p + \\hat p \\hat q\\right)},\\end{aligned}\\ ] ] where @xmath196 is the annihilation operator for the cavity optical mode , and @xmath197 and @xmath198 are the antisqueezed and squeezed quadrature operators , respectively , defined as @xmath199 with the commutation relation @xmath200 & = i.\\end{aligned}\\ ] ] the classical phase modulator does not influence the evolution of the opo , so @xmath201 but it modulates the opo output .",
    "@xmath148 in this case is @xmath202 where @xmath203 is the transmission coefficient of the partially reflecting opo output mirror , @xmath204 , and the symbol and sign conventions here roughly follows those of refs .",
    "@xcite . to ensure the correct unconditional quantum dynamics ,",
    "the hamiltonian should be changed to ( ref .",
    "@xcite , sec .",
    "11.4.3 ) @xmath205},\\end{aligned}\\ ] ] in order to eliminate the spurious effect of the displacement term in @xmath206 on the opo .",
    "after some algebra , the forward stochastic equation for the wigner distribution @xmath188 becomes @xmath207 } \\nonumber\\\\&\\quad -{\\left[{\\left(\\chi -\\frac{\\gamma}{2}\\right)}{\\frac{\\partial } { \\partial q}}{\\left ( qf\\right)}+{\\left(-\\chi -\\frac{\\gamma}{2}\\right)}{\\frac{\\partial } { \\partial p}}{\\left(pf\\right)}\\right ] } \\nonumber\\\\&\\quad + \\frac{\\gamma}{4}{\\left({\\frac{\\partial^2 f}{\\partial q^2}}+{\\frac{\\partial^2",
    "f}{\\partial p^2}}\\right)}\\bigg\\ } \\nonumber\\\\&\\quad + dy_t \\bigg[\\sin(\\phi-\\phi_t ' ) { \\left(2b+\\sqrt{2\\gamma}q + \\sqrt{\\frac{\\gamma}{2}}{\\frac{\\partial } { \\partial q}}\\right ) } \\nonumber\\\\&\\quad + \\cos(\\phi-\\phi_t ' ) { \\left(\\sqrt{2\\gamma}p+\\sqrt{\\frac{\\gamma}{2}}{\\frac{\\partial } { \\partial p}}\\right)}\\bigg]f . \\label{wigner_zakai}\\end{aligned}\\ ] ] this is precisely the classical dmz equation ( [ zakai ] ) with correlated system and observation noises .",
    "the equivalent classical system equations are then @xmath208 and the equivalent observation equation is @xmath209 where @xmath210 and @xmath211 are independent wiener increments with covariance @xmath212 . @xmath210 and @xmath211 , which appear in both the system equation and the observation equation , are simply quadratures of the vacuum field , coupled to both the cavity mode and the output field via the opo output mirror",
    ". equations ( [ equiv_system ] ) and ( [ equiv_observ ] ) coincide with the model of berry and wiseman in ref .",
    "@xcite when @xmath94 is a wiener process , and eq .",
    "( [ wigner_zakai ] ) is the continuous limit of their approach to phase estimation .",
    "this approach can also be regarded as an example of the general method of accounting for colored observation noise by modeling the noise as part of the system @xcite .",
    "if @xmath213 , @xmath214 is an additive white gaussian noise , and the model is reduced to that studied in refs .",
    "@xcite . in that case , it is desirable to make @xmath192 follow @xmath193 as closely as possible , so that @xmath5 can be approximated as @xmath215 and the kalman filter can be used if @xmath94 is gaussian @xcite .",
    "provided that eq .",
    "( [ approx ] ) is valid , one should make @xmath192 the conditional expectation of @xmath216 , given by @xmath217 for phase - squeezed beams , it also seems desirable to make @xmath192 close to @xmath193 in order to minimize the magnitude of @xmath218 .",
    "equation ( [ lo_phase ] ) may not provide the optimal @xmath192 in general , however , as it does not necessarily minimize the magnitude of @xmath218 or the estimation errors .",
    "the optimal control law for @xmath192 should be studied in the context of control theory .    while @xmath192 needs to be updated in real time and must be calculated via filtering",
    ", the estimation accuracy can be improved by smoothing .",
    "the backward dmz equation for @xmath189 is the adjoint equation with respect to eq .",
    "( [ wigner_zakai ] ) , given by @xmath219 } \\nonumber\\\\&\\quad + \\frac{\\gamma}{4}{\\left({\\frac{\\partial^2 g}{\\partial q^2}}+{\\frac{\\partial^2 g}{\\partial p^2}}\\right)}\\bigg\\ } \\nonumber\\\\&\\quad + dy_t \\bigg[\\sin(\\phi-\\phi_t ' ) { \\left(2b+\\sqrt{2\\gamma}q - \\sqrt{\\frac{\\gamma}{2}}{\\frac{\\partial } { \\partial q}}\\right ) } \\nonumber\\\\&\\quad + \\cos(\\phi-\\phi_t ' ) { \\left(\\sqrt{2\\gamma}p-\\sqrt{\\frac{\\gamma}{2}}{\\frac{\\partial } { \\partial p}}\\right)}\\bigg]g , \\label{wigner_bzakai}\\end{aligned}\\ ] ] and the smoothing probability density @xmath93 is given by eq .",
    "( [ wigner_smooth ] ) .",
    "the use of linear smoothing for the case of @xmath94 being a gaussian process and @xmath214 being a white gaussian noise has been studied in refs .",
    "practical strategies of solving eqs .",
    "( [ wigner_zakai ] ) and ( [ wigner_bzakai ] ) in general are beyond the scope of this paper , but classical nonlinear filtering and smoothing techniques should help @xcite .",
    "one can also use the hybrid smoothing theory to study the general problem of force estimation via a squeezed probe beam and a homodyne pll , by modeling the phase modulator as a quantum mechanical oscillator instead and combining the problem studied in this section with the force estimation problem studied in ref .",
    "previous sections focus on the estimation of classical signals , but there is no reason why one can not apply smoothing to quantum degrees of freedom as well , as shown in fig .  [ quantum_smoothing ] .",
    "first consider the predicted density operator at time @xmath35 conditioned upon past observations , given by @xmath220},\\end{aligned}\\ ] ] where the classical degrees of freedom are neglected for simplicity .",
    "the predicted expectation of an observable , such as the position of a quantum mechanical oscillator , is @xmath221 } = \\frac{{\\operatorname{tr}}[\\hat o\\hat f(\\tau)]}{{\\operatorname{tr}}[\\hat f(\\tau)]}. \\label{predict}\\end{aligned}\\ ] ] one may also use retrodiction , after some measurements of a quantum system have been made , to estimate its initial quantum state before the measurements @xcite , using the retrodictive density operator defined as @xmath222}.\\end{aligned}\\ ] ] the retrodicted expectation of an observable is @xmath223 } = \\frac{{\\operatorname{tr}}[\\hat g(\\tau)\\hat o]}{{\\operatorname{tr}}[\\hat g(\\tau)]}. \\label{retrodict}\\end{aligned}\\ ] ] causality prevents one from going back in time to verify the retrodicted expectation , but if the degree of freedom with respect to @xmath224 at time @xmath35 is entangled with another `` probe '' system , then one can verify the retrodicted expectation by measuring the probe and inferring @xmath224 @xcite .",
    "the idea of verifying retrodiction by entangling the system at time @xmath35 with a probe can also be extended to the case of smoothing , as proposed by aharonov _",
    "_  @xcite . in the middle of a sequence of measurements ,",
    "if one weakly couples the system to a probe for a short time , so that the system is weakly entangled with the probe , and the probe is subsequently measured , the measurement outcome on average can be characterized by the so - called weak value of an observable , defined as @xcite @xmath225 } { { \\operatorname{tr}}[\\hat g(\\tau)\\hat f(\\tau)]}.\\end{aligned}\\ ] ] the weak value becomes a prediction given by eq .",
    "( [ predict ] ) when future observations are neglected , such that @xmath226 , and becomes a retrodiction given by eq .",
    "( [ retrodict ] ) when past observations are neglected and there is no _ a priori _ information about the quantum system at time @xmath35 , such that @xmath227 .",
    "when @xmath228 and @xmath229 are incoherent mixtures of @xmath224 eigenstates , @xmath230 the weak value becomes @xmath231 and is consistent with the classical time - symmetric smoothing theory described in sec .",
    "[ classical ] .",
    "hence , the weak value can be regarded as a quantum generalization of the smoothing estimate , conditioned upon past and future observations .",
    "one can also establish a correspondence between a classical theory and a quantum theory via quasiprobability distributions .",
    "given the smoothing probability density in terms of the wigner distributions in eq .",
    "( [ wigner_smooth ] ) , one may be tempted to undo the marginalizations over the quantum degrees of freedom and define a smoothing quasiprobability distribution as @xmath232 where @xmath233 and @xmath234 are the wigner distributions of @xmath228 and @xmath229 , respectively .",
    "intriguingly , @xmath235 , being the product of two wigner distributions , can exhibit quantum position and momentum uncertainties that violate the heisenberg uncertainty principle .",
    "this has been shown in ref .",
    "@xcite , when the position of a quantum mechanical oscillator is monitored via continuous measurements and smoothing is applied to the observations . from the perspective of classical estimation theory , it is perhaps not surprising that smoothing can improve upon an uncertainty relation based on a predictive theory .",
    "the important question is whether the sub - heisenberg uncertainties can be verified experimentally .",
    "@xcite argues that it can be done only by bayesian estimation , but in the following i shall propose another method based on weak measurements .",
    "it can be shown that the expectation of @xmath179 using @xmath235 is @xmath236 } { { \\operatorname{tr}}[\\hat g(\\tau)\\hat f(\\tau ) ] } = { \\operatorname{re } } { } _ { \\hat g}{\\langle\\hat q\\rangle}_{\\hat f},\\end{aligned}\\ ] ] which is the real part of the weak value , and likewise for @xmath237 , so the smoothing position and momentum estimates are closely related to their weak values .",
    "more generally , consider the joint probability density for a quantum position measurement followed by a quantum momentum measurement , conditioned upon past and future observations : @xmath238 } , \\label{joint_measurement } \\\\",
    "\\mathcal c & \\equiv \\int dy_q dy_p { \\operatorname{tr}}\\big[\\hat g(\\tau)\\hat m_p(y_p)\\hat m_q(y_q ) \\nonumber\\\\&\\quad\\times \\hat f(\\tau)\\hat m_q^\\dagger(y_q)\\hat m_p^\\dagger(y_p)\\big],\\end{aligned}\\ ] ] where the measurement operators @xmath239}{|q\\rangle}{\\langleq| } , \\\\ \\hat m_p(y_p ) & = \\int dp { \\left(\\frac{\\epsilon_p}{2\\pi}\\right)}^{\\frac{1}{4 } } \\exp{\\left[-\\frac{\\epsilon_p}{4}(y_p - p)^2\\right]}{|p\\rangle}{\\langlep|}\\end{aligned}\\ ] ] are assumed to be gaussian and backaction evading .",
    "after some algebra , @xmath240}\\tilde p(q , p ) , \\label{convolution}\\\\ \\tilde p(q , p ) & \\equiv   \\frac{1}{2\\pi\\mathcal c } \\int du dv\\exp{\\left(-\\frac{\\epsilon_q u^2+\\epsilon_p v^2}{8}\\right ) } \\nonumber\\\\&\\quad\\times { \\left\\langlep+\\frac{v}{2}\\right|}\\hat g(\\tau){\\left|p-\\frac{v}{2}\\right\\rangle}\\exp(ivq ) \\nonumber\\\\&\\quad\\times { \\left\\langleq-\\frac{u}{2}\\right|}\\hat f(\\tau){\\left|q+\\frac{u}{2}\\right\\rangle}\\exp(ipu).\\end{aligned}\\ ] ] from the perspective of classical probability theory , eq .",
    "( [ convolution ] ) can be interpreted as the probability density of noisy position and momentum measurements with noise variances @xmath241 and @xmath242 , when the measured object has a classical phase - space density given by @xmath243 . in the limit of infinitesimally weak measurements , @xmath244 , and @xmath245",
    "thus , @xmath235 can be obtained approximately from an experiment with small @xmath246 and @xmath247 by measuring @xmath248 for the same @xmath186 and @xmath185 and deconvolving eq .",
    "( [ convolution ] ) . in practice ,",
    "@xmath246 and @xmath247 only need to be small enough such that @xmath249 .",
    "this allows one , at least in principle , to experimentally demonstrate the sub - heisenberg uncertainties predicted in ref .",
    "@xcite in a frequentist way , not just by bayesian estimation as described in ref .",
    "note , however , that @xmath235 can still go negative , so it can not always be regarded as a classical probability density .",
    "this underlines the wave nature of a quantum object and may be related to the negative probabilities encountered in the use of weak values to explain hardy s paradox @xcite .",
    "in conclusion , i have used a discrete - time approach to derive the classical and quantum theories of time - symmetric smoothing .",
    "the hybrid smoothing theory is applied to the design of pll , and the relation between the proposed theory and aharonov _ et al . _",
    "s weak value theory is discussed .",
    "possible generalizations of the theory include taking jumps into account for the classical random process @xcite and adding quantum measurements with poisson statistics , such as photon counting @xcite .",
    "potential applications not discussed in this paper include cavity quantum electrodynamics @xcite , photodetection theory @xcite , atomic magnetometry @xcite , and quantum information processing in general . on a more fundamental level",
    ", it might also be interesting to generalize the weak value theory and the smoothing quasiprobability distribution to other kinds of quantum degrees of freedom in addition to position and momentum , such as spin , photon number , and phase .",
    "a general quantum smoothing theory would complete the correspondence between classical and quantum estimation theories .",
    "discussions with seth lloyd and jeffrey shapiro are gratefully acknowledged . this work is financially supported by the keck foundation center for extreme quantum information theory .        h.  l.  van trees , _ detection , estimation , and modulation theory , part i _ ( wiley , new york , 2001 ) ; _ detection , estimation , and modulation theory , part ii : nonlinear modulation theory _",
    "( wiley , new york , 2002 ) ; _ detection , estimation , and modulation theory , part iii : radar - sonar processing and gaussian signals in noise _ ( wiley , new york , 2001 ) .",
    "p.  warszawski , h.  m.  wiseman , and h.  mabuchi , * 65 * , 023802 ( 2002 ) ; p.  warszawski and h.  m.  wiseman , j.  opt .",
    "b : quant .",
    "semiclass .",
    "opt .   * 5 * , 1 ( 2003 ) ; * 5 * , 15 ( 2003 ) ; n. p. oxtoby , p. warszawski , h. m. wiseman , he - bi sun and r. e. s. polkinghorne , * 71 * , 165317 ( 2005 ) .",
    "v.  p.  belavkin , radiotech .",
    "elektron .  * 25 * , 1445 ( 1980 ) ; v.  p.  belavkin , in _ information complexity and control in quantum physics _ , edited by a.  blaquire , s.  diner , and g.  lochak ( springer , vienna , 1987 ) , p.  311 ; v.  p.  belavkin , in _",
    "stochastic methods in mathematics and physics _ , edited by r.  gielerak and w.  karwowski ( world scientific , singapore , 1989 ) , p.  310 ; v.  p.  belavkin , in _ modeling and control of systems in engineering , quantum mechanics , economics , and biosciences _ , edited by a.  blaquire ( springer , berlin , 1989 ) , p.  245 .",
    "a.  barchielli , l.  lanz , and g.  m.  prosperi , nuovo cimento , * 72b * , 79 ( 1982 ) ; found .",
    "* 13 * , 779 ( 1983 ) ; h.  carmichael , _ an open systems approach to quantum optics _ ( springer - verlag , berlin , 1993 ) .",
    "s.  m.  barnett , d.  t.  pegg , j.  jeffers , o.  jedrkiewicz , and r.  loudon , * 62 * , 022313 ( 2000 ) ; s.  m.  barnett , d.  t.  pegg , j.  jeffers , and o.  jedrkiewicz , * 86 * , 2455 ( 2001 ) ; d.  t.  pegg , s.  m.  barnett , and j.  jeffers , * 66 * , 022106 ( 2002 ) ."
  ],
  "abstract_text": [
    "<S> classical and quantum theories of time - symmetric smoothing , which can be used to optimally estimate waveforms in classical and quantum systems , are derived using a discrete - time approach , and the similarities between the two theories are emphasized . </S>",
    "<S> application of the quantum theory to homodyne phase - locked loop design for phase estimation with narrowband squeezed optical beams is studied . </S>",
    "<S> the relation between the proposed theory and aharonov _ et al . _ s weak value theory is also explored . </S>"
  ]
}