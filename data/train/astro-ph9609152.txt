{
  "article_text": [
    "in the limit of small particle masses , a system of self  gravitating masses is described by the poisson ",
    "vlasov equations : the particle  particle scattering becomes unimportant , and the evolution approaches that of a continuous system with a time ",
    "dependent potential ( chandrasekhar 1942 ; sellwood 1987 ) .",
    "n - body codes have a small number of high mass particles compared to a universe of unclustered dark matter .",
    "it is not clear whether the ensemble converges to some or all of the properties of the right solution ( melott 1981 ) .",
    "in fact , one may conclude that if `` ... much of the mass in the universe comprises an invisible component ( the missing mass ) there is no guarantee that the galaxies have ever acted as point particles .",
    "if this were the case , the results from n  body experiments would not apply to the real universe . ''",
    "( hockney and eastwood 1981 , 1988 ) .",
    "the purpose of the letter is to present preliminary results from a longer study to warn of possible problems .",
    "the mean  field approach is typified by the particle ",
    "mesh , or pm method ( doroshkevich et .",
    "al 1980 ; melott 1981 , 1982b ; klypin & shandarin 1983 ) .",
    "particles move in a gravitational potential computed on a mesh .",
    "the shortcoming is that there are no valid results below the mesh scale , since potential and density are smoothed over that scale .",
    "so far no errors have been reported other than this ( rather serious ) limitation .",
    "short  range forces may be added to preserve the @xmath1 force law in close encounters . p@xmath0",
    "m ( particle  particle  particle mesh ) ( hockney & eastwood 1981 ; efstathiou & eastwood 1981 ) and tree codes ( suginohara et al . 1991 ) are two examples , although more recently codes based on adaptive mesh refinement ( pen 1995 ; suisalu & saar 1995 ; gelato et al . 1996 ; kravtsov et al . 1996 ) , have been used .",
    "generally this approach improves resolution of the green function for the poisson equation without improving the resolution of the source term . for this reason we call them hflmr ( high force low mass resolution ) codes .",
    "roughly isotropic contraction of clumps is often used to justify this approach .",
    "tests made by kuhlman et al .",
    "( 1996 ) on generic smooth initial perturbations do not support isotropic collapse . to prevent the formation of tight binaries which slow down execution , all codes resort to force softening , so that on scales less than @xmath2 the force law is softer than @xmath3 .",
    "values of @xmath2 ( in units of the mean interparticle separation @xmath4 ) of 0.01 to 0.2 are common and results are usually presented down to @xmath2 .",
    "we will show that @xmath5 is needed to maintain a collisionless , quasi  continuous system .",
    "computer codes are often cross - checked for convergence , but a common assumption may lead to a common error .",
    "agreement with exact solutions is better , but not easy . one classic test for two  body scattering error is mass segregation . particles of higher mass settle to inner parts of bound systems due to equipartition proceeding by two  body scattering .",
    "efstathiou & eastwood ( 1981 ) found strong segregation in p@xmath0 m .",
    "this result appears to have been largely ignored .",
    "peebles et al ( 1989 ) verified that it could be suppressed in pm with @xmath6 . in an equal mass system , like most cosmological simulations , this error may exist but not result in segregation .",
    "suisalu & saar ( 1996 ) examined deflections and found an indication of trouble in a p@xmath0 m code , but their original method was unable to show whether the scattering was due to mean field or two - body fluctuations .",
    "we suggest a new type of test ( symmetry - breaking ) for codes in the nonlinear regime without an exact solution .",
    "we use a simple system with a clear prediction : plane  wave collapse .",
    "( of course it could be spherical collapse , two - dimensional collapse onto a filament , or any other type of symmetric collapse . )",
    "this has an exact solution up to shell crossing ( zeldovich 1970 ; shandarin & zeldovich 1989 ) , and was used by efstathiou et al .",
    "( 1985 ) in code testing .",
    "however , they worked only in the precollapse regime and along coordinate axes so no collisions were possible .",
    "obviously a collisionless system with only one  dimensional perturbations should remain one - dimensional .",
    "this is the basis of our test , violation of which means the code is collisional or otherwise erroneously scattering particle orbits .",
    "we make the test more relevant by tilting the plane of collapse relative to the simulation cube .",
    "we set up a single perturbation wave @xmath7 = ( 2,3,5)@xmath8 ( @xmath9 , where @xmath8 is the fundamental mode ) by fourier transform on a grid of @xmath10 particles .",
    "we began with an amplitude @xmath11 , and evolved for an expansion factor of 7.7 after the first shell crossing , during which collisions can happen . while the physical system should have no scattering , near misses may generate them numerically .",
    "the role of the symmetry is only to make it detectable . to perform the comparison we used a pm ( melott 1981 , 1986 ) , a p@xmath0 m ( kindly supplied by h. couchman 1991 ) and a tree - code ( suginohara et al .",
    "we also tested the nested  grid particle ",
    "mesh ( ngpm ) code ( splinter 1996 ) .",
    "all runs had identical ( publicly available ) initial conditions .",
    "the initial conditions for the ngpm code were generated in the above manner for both the coarse and fine grid .",
    "we also did cross check runs in which the perturbation @xmath12 was _ not _ tilted with respect to the cube .",
    "the pm run was performed on a 64@xmath0 mesh and duplicated on a 128@xmath0 mesh to emulate a sometimes used modification as well as verify the code - independence of our results .",
    "pm tests were done with traditional two - point differencing and the melott ( 1986 ) improved force resolution staggered mesh scheme .",
    "there was no significant difference in scattering and we report the latter here .",
    "we performed otherwise identical p@xmath0 m and tree tolerance parameter @xmath13 runs with @xmath14 0.1 , and 1.0 , plus a transitional p@xmath0 m run with @xmath14 0.5 . in the p@xmath0 m code , we used two choices of time integration variable and varied the timestep greatly , assuring satisfaction of both courant and leapfrog stability conditions .",
    "the pm and ngpm codes automatically test and adjust timesteps as needed . the adaptive smoothing length capability of the p@xmath0 m code was turned off as suggested by gelb and bertschinger ( 1994 ) . the ngpm code had a refinement factor of 8 , putting it close in spatial resolution to the @xmath15 p@xmath0 m run , but with 512 times increased mass resolution ( an `` hfhmr '' code ) .",
    "results of a much more extended study will be presented elsewhere .",
    "figure 1 shows the overall configuration of the pm system after collapse .",
    "all runs look roughly similar .",
    "differences between tilted runs are shown in figure 2 , in which slices of one collapsed planar region are projected along initial perturbation axis .",
    "the only inhomogeneity should be projection of the initial lattice onto this plane .",
    "some runs show clumping , suggesting scattering error . what all the erroneous hflmr runs ( the p@xmath0 m and tree code runs with @xmath16 , and the 128@xmath0 mesh pm run )",
    "share are softening lengths shorter than the mean interparticle separation .",
    "the runs that performed well ( normal pm , p@xmath0 m and tree with @xmath14 1 , and ngpm ) all have softening comparable to this distance ; of course for ngpm this is a considerably smaller distance , but at no collision penalty .",
    "( axis  aligned pm and p@xmath0 m runs show the lattice , with no clumping visible . )",
    "we use as one quantitative measure the distribution of particle velocities .",
    "they should be strictly normal to the planes ; we separate them into components along the normal and in the plane @xmath17 .",
    "figure 3 shows scatter plots for 1000 randomly selected particles from each of our runs .",
    "many are hidden by superposition .",
    "the correct result is a line along the @xmath18 axis .",
    "this is approached only by non ",
    "sparse pm and ngpm , by p@xmath0 m and tree as the short  range force is turned off , and by axis  aligned runs which have only head  on collisions . with @xmath19 , the most common choice",
    ", the error is large .",
    "the relative error can be made quantitative by comparing the median speed in the plane to the median speed along the normal , as shown in table 1 .",
    "another measure is the kinetic energy ; the mean from motion in the plane and along the normal are also shown in table 1 .",
    "lastly , we show the median value of @xmath20 , the distance in mesh units particles have strayed off the normal trajectory .",
    "all values are the mean or median of 10,000 particles ( subgrid particles in ngpm ) .",
    "aligned pm and p@xmath0 m runs had _ zero _ off  normal velocity ( within computer precision ) .",
    "figure 4 shows a phase  space diagram of a single sheet , including the normal displacement and velocity , with the other four phase space dimensions suppressed . the correct solution is a well  known spiral ( doroshkevich et al .",
    "1980 ; melott 1982a ; bond et al .",
    "the codes that preserve this pattern are those with softening comparable to the mean interparticle separation .",
    "we can verify that scattering is from encounters and not the initial gravity fields by noting that off - normal components are small until shell crossing in all codes ; they increase strongly in the inclined hflmr codes as particles pass each other .",
    "we have shown that hflmr computational methods in widespread use for gravitational clustering in cosmology perform incorrectly on a simple test problem , as a consequence of trying to model a continuous system with discrete masses .",
    "the pm and ngpm methods ( as normally used ) are able to handle this test because there is no evasion of the discreteness limitation .",
    "pm can be forced to fail by increasing the lattice resolution beyond appropriate limits .",
    "hflmr methods work properly if the short range force is turned off or if they are forced to alignment with the coordinate axes .    as convergence to the proper behavior is very slow ( e.g. hockney , 1971 ) , past comparisons by varying particle number have not revealed this ( e.g. efstathiou & eastwood 1981 ) . coupling",
    "these incorrectly evolved systems to hydrodynamics will guarantee that it is being done in the wrong background gravitational potential .",
    "we do not claim the effect will move to larger scales .",
    "melott and shandarin ( 1990 ) , little et al . (",
    "1991 ) , and melott & shandarin ( 1993 ) have shown that small scale effects scarcely propagate to large scales , but more quantitative study is needed .",
    "however , errors would only stop growing in voids or in regions where the particle density exceeds @xmath21 .",
    "questions may be raised about the relevance of our example .",
    "galaxies are not infinite planes .",
    "however , the first collapse on any scale is expected to be sheet  like ( shandarin et al .",
    "1995 ; kuhlman , et al . 1996 ; gouda 1996 ) so there is ample opportunity for this situation to arise .",
    "furthermore , collisionality operates in the absence of symmetry ; our planar collapse study simply makes it starkly obvious .",
    "one may argue that since collapsed pancakes are unstable to small  scale perturbations , the hflmr codes model this correctly , justifying the results they give for small @xmath2 . since there is no small - scale power in the initial conditions , these codes are artificially producing power on small  scales by the growth of shot noise .",
    "the results of a simulation should be a consequence of initial conditions that were imposed .",
    "this is illustrated in the orientation - dependence of the hflmr codes : since we get two completely different results depending on orientation , one must ask , `` which is correct ? ''",
    "most importantly , this serves to raise the question of whether a code performs well overall in a complex nonlinear problem when it can not replicate a simple test case .",
    "as this letter was going to press , we learned of park ( 1997 ) , in which spherical collapse is studied , producing conclusions close to ours .",
    "values @xmath22 or even smaller are used in clustering studies .",
    "one might hope that realistic cosmological scenarios with power on all scales avoid this problem .",
    "impressed perturbations might overwhelm discreteness if the spectrum is normalized to the shot noise level at the particle nyquist frequency ( efstathiou et al .",
    "we tested this by putting in an inclined plane wave close to the particle nyquist frequency , at the white noise amplitude .",
    "again we found strong scattering in a @xmath19 p@xmath0 m run , and essentially none in pm . at this short wavelength",
    "the resolution limitations of pm show themselves in its lower velocity dispersion , so both codes are performing badly .",
    "the accuracy of cosmological results from hflmr codes remains an open question .",
    "suto ( 1991 ) examined the divergence of particle trajectories in a series of n  body cosmological simulations varying @xmath2 .",
    "he found that the comoving trajectories diverged with time as @xmath23 , fitting @xmath24 . by requiring @xmath25 , where @xmath26 is the hubble time we require that deflection of nearby trajectories by shot noise is small .",
    "enforcing such a condition gives @xmath27 , similar to our results , the results of peebles et al .",
    "( 1989 ) and suisalu and saar ( 1996 ) .",
    "one promising method to achieve better force and mass resolution while doing correct physics is nested  grid methods , which put more particles in a region of interest .",
    "such methods are shown here to greatly reduce collisions and may allow the study of small  scale structure to progress ( e.g. villumsen 1988 ; anninos et al . 1994 ; splinter 1996 ) .",
    "putting in a higher particle density acknowledges the inability get something for nothing by sidestepping the laws of physics .",
    "alm and sfs wish to acknowledge the financial support of the nsf  epscor program , nasa grant nagw-3832 , the national center for supercomputing applications , and enn saar for helpful comments .",
    "rjs wishes to thank the center for computational sciences at the university of kentucky and the kentucky space grant consortium for financial support , and hugh couchman for advice in the use of his p@xmath0 m code .",
    "ys thanks resceu ( research center for the early universe , university of tokyo ) , and kek ( national laboratory for high energy physics , japan ) .",
    "anninos , p. , norman , m. , & clarke , d.a .",
    "1994 apj , 436 , 11 bond , j.r . , szalay , a. , & white , s.d.m .",
    "1983 nature 301 , 584 .",
    "chandrasekhar , s. 1942 principles of stellar dynamics , ( new york : dover publications ) couchman , h. 1991 apj , 368 , l23 doroshkevich , a.g . ,",
    "kotok , e.v . ,",
    "novikov , i.d . ,",
    "polyudov , a.n . ,",
    "shandarin , s.f . , & sigov , yu.s .",
    "1980 mnras , 192 , 321 .",
    "efstathiou , g.e .",
    ", davis , m. , frenk , c.s . & white , s.d.m .",
    "1985 apjs , 57 , 241 efstathiou , g.e . & eastwood , j.w .",
    "1981 mnras , 194 , 503 gelato , s. , chernoff , d.f . &",
    "wasserman , i. 1996 apj submitted , astro - ph/9607156 gelb , j.m .",
    ", & bertschinger , e. 1994 apj , 436 , 467 gouda , n. 1996 , preprint hockney , r.w .",
    "1971 j comp phys , 8 , 19 hockney , r.w . & eastwood , j.w .",
    "1981,1988 computer simulation using particles ( new york : mcgraw - hall ) , p. 454",
    "kravtsov , a.v . ,",
    "klypin , a.a . , & khokhlov , a.m. 1996 preprint .",
    "kuhlman , b. , melott , a.l . , & shandarin , s.f .",
    "1996 apjl , 470 , l1 klypin , a.a .",
    "& shandarin , s.f .",
    "1983 mnras , 204 , 891 little , b. , weinberg , d.h . , & park , c. 1991 mnras , 253 , 295 .",
    "melott , a.l .",
    "1981 ph.d .",
    "thesis , university of texas melott , a.l .",
    "1982a phys.rev.lett .",
    "melott , a.l .",
    "1982b nature , 296 , 721 melott , a.l .",
    "1986 phys rev lett , 56 , 1992 melott , a.l . & shandarin , s.f .",
    "1990 nature 346 , 633 melott , a.l .",
    "& shandarin , s.f .",
    "1993 apj , 410 , 469 park , c.b .",
    "1997 aas poster presentation .",
    "peebles , p.j.e . , melott , a.l . ,",
    "holmes , m.r .",
    ", jiang , l.r . , 1989 apj , 345 , 108 pen , ue - li 1995 apjs , 100 , 269 sellwood , j.a .",
    "1987 araa , 25 , 151 shandarin , s.f . , mcdavitt , k. , pauls , j.l , & tinker , j. 1995 phys rev lett , 75 , 7 shandarin , s.f . , & zeldovich , ya.b .",
    "1989 rev mod phys , 61 , 185 splinter , r.j .",
    "1996 mnras , 281 , 281 suisalu , i. & saar , e. 1995 mnras , 274 , 287 suisalu , i. & saar , e. 1996 mnras , submitted astro - ph/9511120 suginohara , t. , suto , y. , bouchet , f.r . , & hernquist , l. 1991 apjs , 75 , 631 suto , y. 1991 publ astron soc japan , 43 , l9 villumsen , j.v .",
    "1988 apjs , 71 , 407 zeldovich , ya.b .",
    "1970 aa , 5 , 84    lcccccc pm & 0.75 & 0.03 & 1.82 & 0.001 & 0.01 pm(n@xmath28,n@xmath29 ) & 0.91 & 0.44 & 2.53 & 0.22 & 0.80 sub - grid(r=8 ) & 0.77 & 0.05 & 1.84 & 0.02 & 0.003 p@xmath0m(@xmath30 ) & 0.70 & 0.05 & 1.99 & 0.004 & 0.03 p@xmath0m(@xmath31 ) & 0.82 & 0.27 & 2.00 & 0.15 & 0.12 p@xmath0m(@xmath32 ) & 0.78 & 0.62 & 2.10 & 0.76 & 0.53 tree(@xmath33 ) & 0.57 & 0.01 & 1.82 & 0.0003 & 0.02 tree(@xmath34 ) & 0.81 & 0.62 & 2.08 & 0.79 & 0.45"
  ],
  "abstract_text": [
    "<S> two - body scattering and other discreteness effects are unimportant in cosmological gravitational clustering in most scenarios , since the dark matter has a small particle mass . </S>",
    "<S> the collective field should determine evolution : two  body scattering in simulations violates the poisson  </S>",
    "<S> vlasov equations . we test this in pm , </S>",
    "<S> p@xmath0 m , tree , and ngpm codes , noting that a collisionless code will preserve the one  dimensional character of plane wave collapse . </S>",
    "<S> we find collisionality vanishing as the softening parameter approaches the mean interparticle separation . </S>",
    "<S> solutions for the problem are suggested , involving greater computer power , pm  based nested grid codes , and a more conservative approach to resolution claims . </S>"
  ]
}