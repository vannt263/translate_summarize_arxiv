{
  "article_text": [
    "the _ kepler _ mission is the tenth mission in nasa s discovery program .",
    "its main objective is to detect earth - size planets in the habitable zone ] [ @xcite ] of sun - like stars and to determine what fraction @xmath0 of all stars in the milky way host such planets .",
    "planet detection in _ kepler _ is performed using transit photometry  [ @xcite ] : a planet transiting between its star and the _ kepler _ photometer blocks a fraction of the stars light proportional to the planet s projected area relative to that of its star , and thus decreases the apparent brightness of the star . for that purpose ,",
    "the _ kepler _ spacecraft is in an earth - trailing orbit and is continuously observing the incoming light of about 156,000 stars in a field of view of 115deg@xmath1 .",
    "the light flux from the stars is recorded using an array of 42 ccds , arranged as 84 module output channels each of which has 1100@xmath21024 pixels .",
    "each ccd is read out in a 6.54sec interval , and the flux for each target is integrated for 29.4minutes , a so - called long cadence ( lc ) interval .",
    "the large number of targets is required because the probability for correct geometric alignment of a planet s orbit with the star - to - photometer - axis is the ratio of the star s radius and the planet orbit radius .",
    "this translates to a transit probability of only about 0.5% of all earth - like planets in a 1au orbit around sun - like stars .",
    "therefore , a sufficiently large number of stars has to be observed to obtain a reliable estimate of the frequency of earth - like planets in our galaxy ( @xmath0 ) .",
    "in addition to these lc targets , a subselection of 512 targets are sampled at 58.35sec `` short - cadence '' ( sc ) intervals , which allows not only for more precise transit timing measurement , but also for detailed asteroseismological investigations of these stars , and for measurements of binary star eclipse timing variations .    with the area ratio of the earth relative to the sun being @xmath3 , detection of transits of earth - like planets",
    "requires an unprecedented photometric precision of 20ppm  [ @xcite ] .",
    "the search for the transits is further complicated by the presence of systematic errors in the photometric data , which occlude the transit signatures as well as other astrophysical signals in the light flux series .",
    "the main causes for the systematic errors are changes in the focus of the photometer ( caused by instrinsic and extrinsic thermal variations ) , differential velocity aberration , residual spacecraft pointing errors on time scales of 15min and greater .",
    "] , mechanical vibrations , and electrical interference with other devices onboard the spacecraft ( typically leading to moir like patterns ) . here",
    "we report on the new presearch data conditioning ( pdc ) module in the _ kepler _ science operations center ( soc ) science processing pipeline , which is specifically designed to remove these systematic errors and other artifacts from the light curves prior to planet detection . the new pdc module , which has been completely rewritten for _ kepler _ soc 8.0 ( the official _ kepler _",
    "software release in august 2011 ) , shows dramatically improved performance  in particular at removing systematic trends while preserving stellar variability , and at detecting and correcting flux discontinuities .",
    "photometric data from the _ kepler _ spacecraft is processed through the _ kepler _ science processing pipeline  [ @xcite ] to extract transit information and export light curves that are readily prepared for asteroseismological analysis .",
    "the raw pixel data from the photometer are passed to the _ calibration _ module ( cal )  [ @xcite ] , which performs pixel - level calibration for target and background pixels .",
    "digital apertures for each target are calculated by the _ target aperture definition _ ( tad ) module  [ @xcite ]",
    ". _ photometric analysis _ ( pa )  [ @xcite ] then selects the pixels defined by the respective target aperture and extracts the light curves , or flux time series , by adding the flux values of these calibrated pixels .",
    "pa also labels anomalies in the data and marks the respective cadences as invalid ( `` gapped '' ) . the flux output from pa",
    "is then passed to _ presearch data conditioning _ ( pdc )  [ @xcite ] , which removes systematic and other errors from the light curves , as described in this paper .",
    "these clean light curves from pdc are then passed as input to the _ transiting planet search _",
    "( tps )  [ @xcite ] module , which employs a wavelet - based adaptive matched filter to detect planet transit signatures ( `` threshold crossing events '' , tces ) in the light curves  [ @xcite ]",
    ". finally , the _ data validation _",
    "( dv ) module  [ @xcite ] , performs a series of tests on the tces detected in tps to establish or break confidence in each event , for instance eliminating false - positives resulting from eclipsing binaries , and to extract physical parameters for each system .",
    "the results from dv are passed to the _ kepler _ science team for further analysis and follow - up observations . for storage and publication to the scientific user community ,",
    "the processed pixels and light curves are exported to the multimission archive at stsci ( mast ) .    in this manuscript",
    "we describe the new presearch data conditioning module in _ kepler _ soc 8.0 , which has been completely rewritten and replaces the previous pdc module .",
    "we will briefly describe the different kinds of systematic errors typically encountered in the light curves , compare the main systematic error cotrending algorithm of the new module with that of the old module , explain the software architecture of the pdc module , and show real light curve examples of the vastly improved performance of the new pdc module .",
    "since one of the major improvements of this completely new version of pdc is the bayesian maximum a posteriori ( map ) approach to cotrending , we will also refer to the new version pdc in _ kepler _ soc 8.0 as `` pdc - map '' , and to pdc pre-8.0 as `` pdc - ls '' ( where ls stands for `` least - squares '' ) , when comparing the two .",
    "_ kepler s _ light curves as they come from pa contain a variety of systematic and other errors , which can occlude the astrophysical features in the light curves , and can prevent detection of small planet transits .",
    "these errors are caused by a variety of instrumental effects , and span a wide range of frequencies and amplitudes .",
    "the most dominant errors mainly result from differential velocity aberration ( dva ) , which can introduce low - frequency systematic errors over the whole quarter .",
    "another source of strong systematic errors , typically with periods of hours to days , are focus changes that are caused by thermal transients .",
    "such temperature changes are usually observed during the recovery from planned or unplanned interrupts in the science data collection .",
    "unplanned interrupts include safe - mode events and loss of fine point .",
    "planned events that interrupt science data collection are the monthly `` earth - points '' and the quarterly rolls . the former is spatial realignment of the _ kepler _ spacecraft to point its high - gain antenna towards earth for data downlink  [ @xcite ] and typically lasts about one day .",
    "the latter is a 90@xmath4 rotation around _",
    "kepler s _ longitudinal axis every three months to keep the solar arrays directed towards the sun , and the radiator which cools the ccd away from it  [ @xcite ] . temperature - change related focus changes can also be faster , such as the intermittent modulation of the focus by @xmath5 every 3.2 hours by a heater on one of the reaction wheel housings , which was partially mitigated after quarter 1  [ @xcite ] .",
    "the magnitude of temperature - related effects on the focus has been found to be @xmath6 per @xmath4c  [ @xcite ] .",
    "fast modes in the systematic errors can also be caused by thermal transients resulting from the reaction - wheel - desaturation on a three day period , and by pointing inaccuracies during the zero - crossings of the reaction - wheels .",
    "in addition to these systematic trends and modulations , the pa light curves suffer from local errors such as outliers , discontinuities , argabrightenings  [ @xcite ] , and gaps in the data .",
    "further , there are also global corrections that have to be applied to the flux amplitude , such as corrections for incompletely captured target flux ( the flux fraction , section  [ sec : fluxfraction ] ) , and for excess light from neighboring stars into the aperture ( crowding metric ) .",
    "these effects are illustrated in figure  [ fig : systematicerrors ] and described in more detail below .",
    "the task of the pdc module in _ kepler _ is to identify and correct all these different kinds of systematic errors , while preserving planet - transits and other astrophysical signals in the light curves .",
    "the main component of pdc - map for removal of systematic trends in the light curves , and arguably the most determinant factor for the significantly improved correction performance as compared to pdc - ls ( before _ kepler _ soc 8.0 ) , is the new cotrending routine which is based on a bayesian maximum a posteriori approach  [ @xcite ] . in general , removal of systematic trends in _ kepler _ data is based on the assumption that the systematic error component in a light curve has a significant degree of correlation with a set of other time series that can be exploited to identify and remove the systematic error . for pdc - ls ,",
    "this set of other time series was given by instrument readings on the _ kepler _ spacecraft , whereas for pdc - map correlations with other light curves are used .",
    "we will give a brief review of the pdc - ls cotrending algorithm before describing the new pdc - map algorithm in _ kepler _ soc 8.0 .",
    "as of _ kepler _ soc 8.0 , the old pdc - ls cotrending algorithm is still used to process short - cadence data ( due to limitations described below ) , and a logic branch on the controller level calls the respective pdc version for either long - cadence or short - cadence data .",
    "removal of systematic errors in pdc - ls was previously performed based on correlations with a set of ancillary engineering data .",
    "these data include the temperatures at the local detector electronics below the ccd array , and polynomials describing the centroid motion of the targets from pa  [ @xcite ] .",
    "this approach is based on the assumption that systematic errors in the light curves can be explained by a combination of instrument effects that are expressed in the engineering data , and the motion of target centroids .",
    "a robust least squares fit of each light curve to the design matrix constructed from these time series is performed to identify and remove correlated signatures .",
    "for further details of the algorithm , see ref .",
    "[ @xcite ] .",
    "pdc - ls did a good job at correcting light curves , and allowed for many of the plethora of new discoveries in planet detection  [ @xcite ] and stellar astrophysics  [ @xcite ] based on _ kepler _ data .",
    "however , it suffered from two deficiencies for a considerable fraction of light curves .",
    "first , the biggest problem observed with pdc - ls was overfitting of the data , which led to removal of stellar variability ",
    "the corrected light curves of many stars appeared overly flat and featureless .",
    "this overfitting was due to the least squares approach to cotrending the light curves . with sufficiently many cotrending basis vectors ,",
    "coincidental correlations of instrument readings with stellar variability happened frequently , and thus the stellar features in the light curves were mistakenly identified as systematic errors and consequently removed .",
    "the bayesian maximum a posteriori approach in pdc - map is specifically designed to prevent overfitting and in fact solves this problem very well , as will be shown in this work .",
    "see figure  [ fig : overfitting ] for some examples of the input light curve to pdc ( the uncorrected flux output from pa ) , the ( overfitted ) output of pdc - ls , and the ( significantly improved ) output of pdc - map .",
    "note that the pdc - ls and pdc - map light curves differ slightly in absolute magnitude , because the flux fraction correction ( see section  [ sec : fluxfraction ] ) was performed differently in pdc - ls .",
    "a second problem of pdc - ls was that high - frequency noise was sometimes injected by the correction , as an unwanted side - effect of reducing the bulk root - mean - square deviation .",
    "a self - check was in place to prevent too strong noise - injection , in which case pdc - ls rejected the systematic error correction and instead returned a light curve where systematic trends were not removed , but only other corrections ( e.g.  discontinuities , outliers , etc ) were applied .",
    "the fraction of targets which were not cotrended at all was considerable .",
    "for instance , of all 162,926 targets observed with _ kepler _ during quarter 7 , 25411 ( 15.6% ) light curves were not cotrended .",
    "the distribution of non - cotrended targets per channel is displayed in figure  [ fig : hist_pdc7fail_fraction ] and ranges from 7.7% to 25.4% per channel .",
    "figure  [ fig : pdcgaveup ] shows some examples of light curves that could not be corrected properly with pdc - ls .",
    "the problem of noise - injection has been significantly reduced in pdc - map , as can be seen in the bottom panels of these examples .",
    "the new version of pdc , pdc - map , uses a different approach in mainly two regards .",
    "first , instead of employing ancillary engineering data , cotrending is performed against the ensemble of light curves on the same channel .",
    "secondly , rather than using a simple least squares fit , a bayesian maximum a posteriori ( map ) approach is used for fitting . note that while this approach does not use any engineering data explicitly , it is still based on the assumption that instrumental signatures are the main cause for systematic errors in the data .",
    "moreover , it assumes that these signatures are highly correlated between targets that are in proximity on the same ccd channel .",
    "this second assumption is a critical ingredient for the bayesian map fit , as it allows for the generation of constraints for the fit by using information about systematics in targets within a neighborhood of the target under investigation .",
    "it is mainly these constraints that prevent overfitting , and thus help to preserve stellar variability .",
    "the map algorithm in pdc is described in detail in a companion paper  [ @xcite ] . here",
    "we will only provide a brief overview to an extent that is relevant in the context of this paper .",
    "cotrending is performed by fitting each light curve to a set of basis vectors , and constraining the fit coefficients in a bayesian maximum a posteriori way by using prior information .",
    "the basis vectors are generated from the 50% most correlated target light curves on the channel , in order to have only the strongest correlated trends in the basis vectors and largely exclude targets with substantial individual fluctuations due to stellar variability .",
    "using singular value decomposition ( svd ) on this set of light curves , the n largest singular vectors are used as basis vectors .",
    "the number of basis vectors to use can be specified as an input parameter to pdc , with eight basis vectors being the default . by construction , these n basis vectors represent the majority of the systematic errors contained in the light curves .",
    "each of the light curves is projected onto these n basis vectors using a least squares fit . to make this fit more robust and prevent overfitting , however , the fit is constrained using prior information from targets which are expected to be affected by similar systematic errors . for that purpose ,",
    "a target neighbor list is generated for each target with respect to their distance in a 3d space spanned by stellar magnitude ( kp ) , right ascension ( ra ) , and declination ( dec ) .",
    "the latter two coordinates , ra and dec , directly translate into the spatial proximity of two targets on the ccd .",
    "further , kp is used as an additional dimension because systematic errors are not only correlated with location on the ccd but also with signal amplitude .",
    "the contribution of each basis vector @xmath7 to each light curve @xmath8 is described in the fit coefficient @xmath9 .",
    "however , instead of simply using the fit coefficient of the least squares fit , the most likely coefficient given the observations in the neighborhood of the target is picked . in bayesian terminology , the posterior probability density function ( pdf ) @xmath10 is maximized , given a prior pdf @xmath11 generated from fit coefficients of all neighboring targets , weighted by their distance to target @xmath8 : @xmath12 the @xmath13 that maximizes @xmath10 is used as the fit coefficient for the map fit .",
    "note that the denominator @xmath14 is simply a normalization over all possible observations @xmath15 and can in practice be omitted in the maximization process .",
    "taking the maximum a posteriori @xmath13 effectively constrains the fit and helps to avoid overfitting . in particular ,",
    "only light curve features that are also present in targets in the neighborhood will be removed , whereas any stellar variability that might have coincidental correlation with some of the basis vectors will be constrained by the prior , and hence be preserved .",
    "figure  [ fig : basisvectorsccdq7 ] shows the first three basis vectors for each channel on the ccd for quarter 7 .",
    "this illustrates how the dominant systematic errors vary across the field of view of the ccd .",
    "however , some trends are observed on almost all channels .      the inputs to pdc are the calibrated , uncorrected flux time series ( measured in photoelectrons ) , as prepared by pa .",
    "one unit of work for pdc is a single module output ( `` channel '' ) from the ccd with the duration of three months , with a sampling period of 29.4minutes .",
    "thus , there are typically 10003500 targets per channel ( see fig .",
    "[ fig : ccdtargets ] ) , and about 4500 data points ( `` cadences '' ) per target .",
    "in addition to the flux time series , the target data structure also contains per - cadence flux uncertainty values and gap indicators to denote invalid cadences , and per - target data such as the flux fraction and crowding metric ( see below ) , as well as bookkeeping information such as the _ kepler _ i d and kic data for each target .",
    "the data flow in pdc - map is displayed in figure  [ fig : pdc_flow_chart ] .",
    "figures [ fig : target158walkthrough ] and [ fig : target850walkthrough ] show two light curve examples as they are being processed throgh pdc .",
    "the individual operations of this sequential processing are described below :      the first step is to flag anomalies in the flux series and mark the respective cadences as not usable ( `` gapped '' ) .",
    "anomalies may affect only one target ( e.g.  undershoot columns  [ @xcite ] ) or all targets on the channel ( e.g.  monthly earth point downlinks , attitude adjustments , spacecraft safe - modes , loss of fine - pointing , and argabrightenings  [ @xcite ] ) , and can have a duration of one to several hundred cadences . the information about the gaps and the type of anomaly is provided separately by pa .",
    "gapped data is labeled as such and is not exported to the mast .      even though gapped data is not being exported , some operations in pdc require contiguous data over the whole time series .",
    "therefore , gaps are filled by linear interpolation for internal use .",
    "note that these linearly interpolated gap values are filled a second time at the end of pdc , using a more sophisticated algorithm ( see below ) to prepare the light curves for tps .",
    "a first coarse cotrending is performed , using the bayesian maximum a posteriori ( map ) approach described above ( [ sec : cotrendingmap ] ) .",
    "this coarse cotrending is only applied temporarily to the flux series to enhance the performance of the next three steps ( iv , v , vi ) , and the coarse correction is removed afterwards in order to perform the proper map correction ( step vii ) .",
    "approximately 3% of the light curves contain one or more noticeable downward step discontinuities per quarter .",
    "the vast majority of these discontinuities are the result of cosmic rays or solar energetic particles striking the photometer and causing permanent local changes in pixel sensitivity , although partial exponential recovery is often observed  [ @xcite ] . depending on the incident angle and",
    "the energy of the cosmic ray , up to a few pixels can be affected , and the net decrease in quantum efficiency is typically @xmath160.5% for a light curve .",
    "since these spsds are not correlated systematics , they can not be removed by the map algorithm ( see step vii ) , and instead a specific submodule exists to detect and correct spsds . the discontinuity correction algorithm used in pdc - ls had a considerable false - negative rate , and was moreover performing a rather crude correction which did not take partial recoveries into account .",
    "the new spsd module in pdc - map is significantly more sophisticated , and performs markedly better at detecting and correcting spsds .",
    "the details of this new algorithm are described in a separate publication  [ @xcite ] . in brief ,",
    "spsd detection is performed by fitting a window of the data to a combination of basis functions , with one of the basis functions modeling a step discontinuity in the flux .",
    "the fit coefficient of this basis function is evaluated in the context of flux variability of the light curve ensemble on that channel , to determine the probability for an underlying spsd .",
    "further checks are performed to prevent false positive detection of transit - like features as discontinuities .",
    "correction then proceeds as a two - stage process , with the first stage estimating the step size ( based on analysis of the entire flux series ) , and the second stage modeling the recovery process .",
    "the sum of these two components is the total correction applied to the light curve .    in the quarter",
    "9 data , spsds were detected in 5252 out of 167404 targets ( 3.1% ) . figure  [ fig : hist_spsd_fraction ] shows a histogram of the fraction of targets containing spsds .",
    "harmonic content can be identified and removed from the light curves of harmonically variable targets .",
    "this step was a mandatory operation in pdc - ls in order to prevent harmonic content from corrupting the least squares fitting in the cotrending routine .",
    "in pdc - map the maximum a posteriori fitting approach is robust against uncorrelated target - specific harmonics and this step is therefore not performed per default , but can be requested with an input parameter .",
    "if harmonics are removed for further processing in pdc they are restored later after cotrending . both corrected harmonics - free as well as corrected light curves with harmonics are exported .    from a theoretical point of view",
    ", one might expect that this ( previously required ) operation of harmonics removal prior to cotrending would improve the cotrending  simply because it reduces the feature complexity of the light curves .",
    "however , we found that it has virtually no effect with the new map cotrending method . in a direct comparison of 1075 light curves processed with and without harmonics removal , we found no difference at all for 97% of the targets . for the remaining 3% , performing harmonics removal before cotrending resulted in weak residual long term trends , which had been identified as very low frequency harmonics by the harmonics detector .",
    "thus , by removing them before cotrending , and restoring them afterwards , these long term trends were preserved in the light curves . without knowing the ground - truth ,",
    "one obviously can not know with certainty whether these long term trends are actually astrophysical effects ( in which case they should be preserved ) , or systematics errors ( in which case they should be removed ) .",
    "however , for most of these cases the low frequency trends seemed to be systematic errors , as judged by comparison with the systematic trends identified for other targets , and therefore performing harmonics removal appeared to actually decrease the quality of the error correction .    in summary , while harmonics removal was a required step in the least squares based cotrending in pdc - ls , it seems that this operation does not improve the error correction ( and may even do harm in a few cases ) in the new bayesian approach of pdc - map .",
    "therefore , this step is skipped by default .",
    "outliers in each flux series are identified based on the mean and standard deviation in a sliding window . the window size and outlier detection threshold",
    "are input parameters to pdc . only isolated ( single cadence )",
    "points above the threshold are considered to be outliers in order to prevent flagging of planet transits or stellar flares as outliers .",
    "these outlier values are `` corrected '' by replacing them with linearly interpolated values .",
    "the purpose of this correction is to prevent false triggering of threshold - crossing - events ( tces ) in tps and also to improve the performance of other operations downstream in pdc . before export to the mast ,",
    "the original outlier values and uncertainties are restored to the corrected light curves and propagated through the pdc correction steps like all regular data points .",
    "the operations of spsd correction ( iv ) , harmonics removal ( v ) , and outlier correction ( vi ) are non - orthogonal to each other . in theory , performing them simultaneously rather than sequentially should yield optimal correction , however at the expense of a substantially more complex algorithm that has not yet developed .",
    "iteration of these operations is an approximation to such a joint fitting approach , and an input parameter was included to iterate the operations iv ",
    "vi for improved correction performance .",
    "in particular , at the time of the design of the architecture it was expected that harmonics removal would improve the performance of the spsd correction  [ @xcite ] ( step iv ) , and hence that iterating operations iv  vi would be beneficial for the overall correction . however , it was found that the presence of harmonics in the frequency- and amplitude - range that is observed in the _ kepler _ data does not decrease the detection performance of the spsd module by more than 1% , while removing them would come with the disadvantages mentioned above for step v. for these reasons , the operations iv  vi are per default only performed once in pdc - map , while leaving the option to perform an iteration in case future design changes should make this desirable .",
    "this operation constitutes the main step for the correction of systematic trends in the light curves .",
    "each flux time series is cotrended against the ensemble of light curves in order to remove correlated trends using a bayesian maximum a posteriori approach as described above ( [ sec : cotrendingmap ] ) . before cotrending",
    ", the correction applied by the coarse cotrending ( step iii ) is restored . the main cotrending procedure ( this step )",
    "is the same as the routine performed in the coarse cotrending ( step iii ) , but with two important differences that make its correction significantly more accurate .",
    "first , only `` clean '' targets , for which no discontinuities had been found ( step iv ) , are considered to generate the basis vectors .",
    "secondly , discontinuities , harmonics ( if enabled ) , and outliers have been removed from the light curves before the fit , which improves the quality of the correction .      transiting planet search ( tps ) requires contiguous data points for all cadences in a light curve , and moreover assumes statistical continuity of the wavelet coefficient variances of the flux time series .",
    "the simple linear gap filling operation does not meet this requirement .",
    "therefore , a more sophisticated gap filling algorithm is employed to refill the gaps of the corrected light curves before export to tps .",
    "the gap filler internally distinguishes between gaps with  short  and with  long  duration .",
    "the boundary for short and long gaps is determined by the gap filling module parameter set , and typically about 125 cadences .",
    "gaps shorter than this threshold are filled with an autoregressive algorithm that estimates sample values in the gaps with a linear prediction based on the correlation in the neighborhood of the gap . for gaps longer than this threshold",
    ", samples away from the edges would tend to become white noise samples , and a different algorithm is therefore used to estimate the gap values : segments on either side of the gap are reflected onto the gap , and a weighted sum of the two segments is taken where the weighting factor for each segment is decreasing linearly with the distance to respective edge of the gap .",
    "this procedure preserves statistical continuity of the data , and in particular , the correlation structure .",
    "however , some smoothing at small scales occurs due to the averaging of two noisy signals . to compensate for this effect",
    ", the variances of the wavelet coefficients of the filled gap are adjusted to match those of the original data in the neighborhood of the gap . preserving the wavelet coefficient statistics",
    "is of particular relevance because tps uses a wavelet - based approach for transit detection  [ @xcite ] .",
    "if harmonic content had been removed from the light curves ( optional step v ) , then it will be added back here , properly cotrended with map .",
    "harmonic - free corrected light curves are exported in addition to the original corrected light curves . per default , harmonics removal is not performed in pdc - map as of _ kepler _ soc 8.0 ( see step v ) .",
    "when generating flux series from pixel data in pa , the optimal aperture  [ @xcite ] for each target may include additional light from nearby light sources .",
    "if not removed , this excess flux would decrease the apparent planet transit depth and lead to a systematic underestimation of planet radii .",
    "the so - called _ crowding metric _ for each target is computed in tad , and reflects which fraction of the flux in the optimal aperture is due to the target itself .",
    "it is a scalar value representing the average over the effective date range .",
    "note that using a scalar average for the crowding metric is an approximation since background sources of light may enter or exit the optimal aperture over the course of the three - month data period .",
    "similarly , using a scalar value for the flux fraction is an approximation because the centroid of the point - spread - function of a target can move over the course of a quarter0.6pixel over 3 months . ] .",
    "similar to excess flux leaking into the optimal aperture , a fraction of the point - spread - function ( psf ) of the target may not be captured in its optimal aperture . to account for this missing fraction",
    ", the _ flux fraction _ , computed by pa , is used to normalize the flux .    together",
    ", these two corrections can be expressed as : @xmath17 where @xmath18 is the corrected cotrended flux , @xmath19 is the cotrended flux , @xmath20 is the crowding metric , and @xmath21 is the flux fraction . the _",
    "median _ is used here , rather than the _ mean _ , to make the normalization robust against mathematical outliers .",
    "this is important in _ kepler _ light curves because transits from planets or eclipsing binaries represent mathematical outliers .",
    "characterizing the performance of systematic trend removal in pdc can be highly subjective which emphasizes the difficulty in the cotrending task .",
    "a human can peruse a selection of light curves and identify poorly cotrended examples to rate performance .",
    "obvious trends and features can be evaluated but subtle issues with the performance will likely be overlooked .",
    "so , in an effort to minimize the subjective analysis , a numerical _ goodness metric _ has been developed .",
    "there are three critical aspects of the cotrending performance to consider in the metric ; 1 ) removal of systematic trends , 2 ) no introduced noise and 3 ) preservation of stellar variability .",
    "a successful cotrend occurs when all three conditions are met , so one can not rely solely on target - to - target correlation , for example , to determine acceptable performance .",
    "overfitting , and hence flattening of stellar features , results in zero correlation but would not be considered a `` good '' correction .",
    "the _ goodness metric _ calculates the cotrending performance in each of the three components using the following methods which were developed experimentally to agree with observations of critical features .",
    "removal of systematic trends is evaluated by the target - to - target correlation .",
    "if the correlation is near zero then in principle no systematics can remain so even with no systematics the off - diagonal correlation matrix will not be exactly zero . ] . the pearson correlation , @xmath22 ,",
    "is computed over the entire module output and the correlation goodness , @xmath23 , is computed as the arithmetic mean of the cube of the absolute value of the correlation between the target under study and all other targets , @xmath24 where @xmath8 refers to the target under study and @xmath7 is summed over all other targets .",
    "@xmath25 is the total number of targets .",
    "the purpose of the cube is to over - emphasize any strong correlations .",
    "@xmath26 is a scaling factor",
    ".    introduced noise is determined by examining the change in the power spectrum density of the noise floor for each light curve before and after the correction , @xmath27 where @xmath28 is the noise floor of the light curve , here defined as the first differences between adjacent flux values .",
    "the noise floor is used because removal of trends can result in large changes in the power spectrum density , but signals close to the nyquist frequency are dominated by noise .",
    "the integral is also only taken about regions where the change in power is greater than one , implying an increase in noise .",
    "the final component , preservation of stellar variability , is the most difficult of the three to numerate .",
    "an exact determination would require knowledge of the intrinsic signal .",
    "since it is not possible to make this determination , an estimate is made by assessing a mid - frequency band region where light curve signals are dominated by stellar features .",
    "high frequency components are removed via a savitzky - golay filter and the low frequency via a 3rd order polynomial removal .",
    "what is left is almost always overwhelmingly dominated by stellar signals .",
    "the exception being the earth - point recovery regions which can be quite strong , so these regions are masked .",
    "the standard deviation of the difference between the resultant mid - frequency light curves before and after the correction , @xmath29 and @xmath30 respectively , is then computed , @xmath31 where @xmath32 is the variability as calculated by pdc - map and is used to emphasize targets with greater variability .",
    "the above three components increase in value ( in the range of [ 0,@xmath33 ) ) as the performance becomes poorer .",
    "but we wish for the `` goodness '' to vary between 0 and 1 , 1 being perfect goodness , and so each component is inverted , @xmath34 the total goodness is then the geometric mean of the three components , @xmath35{g'_{c , i } g'_{n , i } g'_{v , i } } \\quad.\\ ] ] the three weighting parameters are used to adjust the relative emphasis of the three components .",
    "they have been empirically tuned to agree with observations of cotrending performance , with the weighting parameters being @xmath36 , @xmath37 , and @xmath38 .",
    "the above computed _ goodness metric _ has been experimentally developed .",
    "it is used when reviewing data products and as an aid to data users to give an estimate of how well to trust the cotrending performance . for the future",
    "it is planned to incorporate the _ goodness metric _ as a lagrange multiplier in the map posterior pdf and to iteratively improve the map fit .",
    "the output of pdc is a data structure containing the corrected light curves .",
    "if harmonics removal was performed ( step v ) , a second set of corrected light curves without harmonic content is exported as well .",
    "in addition to these flux time series pdc outputs data processing details such as the target and cadence indices of all spsds that were identified , the location of outliers , and diagnostic information such as the bayesian prior weighting for each target .",
    "of these data , tps uses the corrected flux time series with filled gaps .",
    "the corrected flux times series , cotrending basis vectors , and additional processing data such as the goodness metric for each target are exported to the mast .",
    "the unit of work for pdc ( long - cadence ) is one channel for one quarter , so typically 10003500 targets with @xmath164500 data points each .",
    "processing of _ kepler _ data is performed on the _ kepler _ soc computer clusters at nasa ames research center and on the pleiades supercomputer .",
    "the relative processing times of the different pdc components is displayed in figure  [ fig : processingtimes]a and shows that the map - fit and the final gap filling are the computationally most expensive operations . within map ( fig .",
    "[ fig : processingtimes]b ) , the maximization of the posterior pdf consumes the most time .",
    "processing of a typical module output with 10003500 targets with pdc - map takes between 20 and 30 hours on a modern 3ghz cpu with four cores .",
    "we have presented the new ( soc 8.0 ) presearch data conditioning ( pdc ) module of the _ kepler _ science processing pipeline .",
    "the task of the pdc module is to correct the different systematic errors in the _ kepler _ light curves that otherwise occlude planet transits and other astrophysical signatures .",
    "errors that are corrected by pdc include systematic trends in the data ( usually resulting from difference velocity aberration , temperature drift , and pointing errors due to vibrations ) , flux discontinuities ( caused by cosmic rays or solar energetic particles ) , outliers , and scalar corrections to account for the finite point - spread - function of the targets . using a bayesian maximum a posteriori approach to remove correlated trends from the light curves ,",
    "the new pdc ( pdc - map ) has a significantly improved performance as compared with the previous version ( pdc - ls ) that used a least squares fitting approach with ancillary engineering data  [ @xcite ] .",
    "in particular , pdc - map is able to remove systematic errors but at the same time preserve the stellar variability .    despite the dramatic improvements in data correction of this new pdc module",
    ", several further improvements are conceivable and will be implemented in the future .",
    "foremost , the generation of basis vectors for the map cotrending could potentially be improved by performing band - splitting on the light curves and thus operating map on different scales independently .",
    "further , the map cotrending algorithm has several free parameters ( e.g.  the number of basis vectors ) that are given as input parameters .",
    "ideally , these parameters would be chosen automatically , for instance by optimizing the goodness metric .",
    "another potential improvement would be to have time - dependent corrections for the flux - fraction and the crowding - metric , which in the current version are approximated as scalar corrections for each quarter .",
    "finally , due to limitations described above , pdc - map is currently only used for _ kepler _ long - cadence light curves , whereas the old pdc - ls is still being used for short - cadence light curves ",
    "although short - cadence data , with its high relevance for asteroseismological studies amongst others , could greatly benefit from the superior performance of pdc - map as well . even though some limitations inherent to short - cadence data ( such as the sparsity of targets per channel , prohibiting the generation of proper priors in map ) render it impossible to directly apply pdc - map , as is , to short - cadence data ,",
    "several options exist to partly circumvent these limitations and extend the applicability of pdc - map to short - cadence data , such as using interpolated basis vectors from long cadence processing to perform removal of short - cadence systematic trends .",
    "jenkins , j.  m. , smith , j.  c. , tenenbaum , p. , & cleve , j. d. t. j.  v. 2011 , advances in machine learning and data mining for astronomy , ed",
    ". m.  way , j.  scargle , k.  ali , & a.  srivastava ( chapman and hall , crc press )"
  ],
  "abstract_text": [
    "<S> _ kepler _ provides light curves of 156,000 stars with unprecedented precision . </S>",
    "<S> however , the raw data as they come from the spacecraft contain significant systematic and stochastic errors . </S>",
    "<S> these errors , which include discontinuities , systematic trends , and outliers , obscure the astrophysical signals in the light curves . to correct these errors </S>",
    "<S> is the task of the presearch data conditioning ( pdc ) module of the _ kepler _ data analysis pipeline . the original version of pdc in _ kepler </S>",
    "<S> _ did not meet the extremely high performance requirements for the detection of miniscule planet transits or highly accurate analysis of stellar activity and rotation . </S>",
    "<S> one particular deficiency was that astrophysical features were often removed as a side - effect to removal of errors . in this paper </S>",
    "<S> we introduce the completely new and significantly improved version of pdc which was implemented in _ kepler _ </S>",
    "<S> soc 8.0 . this new pdc version , which utilizes a bayesian approach for removal of systematics , reliably corrects errors in the light curves while at the same time preserving planet transits and other astrophysically interesting signals . </S>",
    "<S> we describe the architecture and the algorithms of this new pdc module , show typical errors encountered in _ </S>",
    "<S> kepler _ </S>",
    "<S> data , and illustrate the corrections using real light curve examples . </S>"
  ]
}