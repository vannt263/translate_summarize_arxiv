{
  "article_text": [
    "the _ porto oscillation code _ ( posc ) was initially developed in 1995 to obtain the frequencies of solar models and envelopes .",
    "the first description of the code has been given in @xcite .",
    "the objective of this paper is to present a summary on how posc  calculates the frequencies of oscillations for stellar models .",
    "the paper starts with the basic linear equations describing the oscillations and how these are formulated to be solved numerically .",
    "the boundary conditions used and their implementation are also discussed as well as the accuracy of the calculations .",
    "we end by listing some of the output values provided by the code and some of the applications where the results of the code have been used .",
    "our objective here is to review the necessary equations for _ non - radial adiabatic oscillations _ of spherically symmetric non - rotating stars . by following the work by @xcite it is possible to start from the hydrodynamic equations ( continuity , poisson and conservation of momentum equations ) , in order to obtain a set of equations describing the radial dependence of the amplitude functions for small perturbations .",
    "these perturbations correspond to ; @xmath0 for pressure , @xmath1 for gravitational potential , while @xmath2 is the displacement .",
    "the solutions are writen as @xmath3 \\dis\\phi(t{,}r{,}\\theta{,}\\phi ) = \\phi_0(r ) +     \\tilde\\phi(r)\\;\\ ; y_l^m(\\theta{,}\\phi)\\ ;      e^{\\im\\omega t } \\ ; , \\\\[5pt ] \\dis\\vec{\\xi}(t{,}r{,}\\theta{,}\\phi ) =      \\left[\\xi_r(r),\\ ; \\xi_h(r)\\ ; { \\partial y_l^m\\over \\partial \\theta } ,      { \\xi_h(r ) \\over \\sin\\theta}\\ ; { \\partial y_l^m\\over \\partial\\phi } \\right]\\ ;       e^{\\im\\omega t } .",
    "\\end{array}\\ ] ] where the equilibrium configuration of the stars is described by the functions ; @xmath4 ( for density ) , @xmath5 and @xmath6 . here",
    "@xmath7 is time , @xmath8 the frequency for the oscilating solutions , @xmath9 the horizontal variables while @xmath10 is radial distance and @xmath11 the spherical harmonics characterized by the integer numbers @xmath12 ( mode degree ) and @xmath13 ( azimutal order with @xmath14 ) .    by considering an equation for adiabatic perturbations and after eliminating the dependence on the horizontal coordinates and time , the equations describing the radial amplitude of the small perturbations are obtained in the following form ; @xmath15 \\dis { 1 \\over \\rho_0 } \\left({g_0 \\over c_0 ^ 2 } + { \\diff \\over \\diff r } \\right)\\ ;      \\tilde p - ( \\omega^2{-}n_0 ^ 2)\\ ; \\xi_r - \\devfd{\\tilde\\phi}{r } = 0 \\ ; , \\\\[15pt ] \\dis \\tilde p + { \\rho_0 c_0 ^ 2 n_0 ^ 2 \\over g_0}\\ ; \\xi_r -      { s_l^2 \\over 4\\pi g } \\tilde\\phi +      { c_0 ^ 2\\over 4\\pi gr^2}\\ ;      { \\diff \\over \\diff r } \\left(r^2\\devfd{\\tilde\\phi}{r}\\right ) = 0 .",
    "\\end{array}\\label{eq : basic}\\ ] ]    the equilibrium structure in these equations is also characterized by quantities as gravity @xmath16 and sound speed @xmath17 ; @xmath18 \\dis c_0 ^ 2 = { \\gamma_{1{,}0}\\ ; p_0 \\over \\rho_0 }",
    "\\qquad { \\rm with}\\quad \\gamma_1 \\equiv",
    "\\left ( \\devfp{\\log p}{\\log\\rho } \\right)_s   \\ ; , \\end{array}\\ ] ] where the derivate has been calculated at fixed entropy @xmath19 . there are also two characteristic frequencies ; the _ lamb frequency _ @xmath20 and the _ buoyancy frequency _ @xmath21 ( also known as the brunt - vissl frequency ) , corresponding to @xmath22 \\dis n^2_0 = g_0 \\left ( { 1 \\over \\gamma_{1{,}0}}\\ ; \\devfd{\\log p_0}{r } -       \\devfd{\\log\\rho_0}{r } \\right ) \\cr \\dis \\qquad      = - g_0 \\left ( { g_0\\rho_0 \\over \\gamma_{1{,}0}\\ ; p_0 } +       \\devfd{\\log\\rho_0}{r } \\right ) \\;.",
    "\\end{array}\\ ] ]    if we consider the following dimensionless variables @xmath23 the equations can be written as @xmath24 y_3 - { 4\\pi gr^2\\rho_0",
    "\\over c_0 ^ 2}\\ ; { c_0 ^ 2 \\over rg_0}\\ ; y_4 \\;. \\end{array}\\ ] ]    these form the set of equations we need to solve to obtain the radial behaviour of linear adiabatic oscillations of spherically symmetric stars .",
    "in order to describe the reference / equilibrium model we consider the following dimensionless functions of the equilibrium structure ( as defined by @xcite ) @xmath25 where @xmath26 and @xmath27 are respectively the total mass and radius of the star , while @xmath28 is the mass within a sphere of radius @xmath10 .",
    "these 5 functions are the result of an evolution code , being necessary as the input of the oscillation code .    the four first order differential equations for small amplitudes",
    "can now be written simply as @xmath29",
    "y_2 + a_2 y_3 \\\\[10pt ] \\dis x\\ ; \\devfd{y_2}{x } = \\left ( { \\sigma^2 \\over a_1 } - a_4 \\right )      y_1 + ( 1{+}a_4{-}a_5 ) y_2 - a_4 y_3 \\\\[10pt ] \\dis x\\ ; \\devfd{y_3}{x } = ( 1{-}a_5 ) y_3 + y_4 \\\\[10pt ] \\dis x\\ ; \\devfd{y_4}{x } = a_4a_5 y_1 + a_2a_5 y_2 + \\left [ l(l{+}1 ) - a_2 a_5      \\right ] y_3 - \\\\      \\qquad\\qquad   -a_5 y_4 \\ ; , \\end{array}\\ ] ] where we have introduced the reduced frequency @xmath30    we may write these equations in a vectorial form by defining the matrix , with @xmath31 , @xmath32 \\;. \\label{eq : matrixa}\\ ] ] the system of differential equations is then simply written as @xmath33 where the vector @xmath34 has the components @xmath35 .",
    "to complete the required equations it is also necessary to define four boundary conditions .",
    "the solution is to be found by integrating the equations between the centre of the star ( @xmath36 or @xmath37 ) and the top of the atmosphere ( @xmath38 or @xmath39 ) .",
    "so , in fact we shall be establishing two boundary conditions at @xmath37 and other two at the surface .",
    "the result is an eigenvalue problem with solutions existing for discrete values of @xmath40 .",
    "these are the eigenvalues associated to the corresponding eigenfunctions , that must satisfy the boundary conditions .",
    "since we have four dependent variables , the interior boundary conditions correspond to fix the values for two of the dependent variables .",
    "the other two are then related to these .",
    "the boundary conditions have to guarantee that the solutions are regular in the singular point , @xmath37 , of the differential equations .",
    "so , we start by determining the limiting behaviour of the @xmath41 s when @xmath42 . considering that for @xmath43",
    "we can write ( the subscript `` c '' stands for the value at @xmath37 ) ; @xmath44    these expressions determine the behaviour of the @xmath41 s near the centre as follows from the definitions  ( [ eq : apar ] ) ; @xmath45 where @xmath46 .",
    "if we now replace these in the definition  ( [ eq : matrixa ] ) of the matrix @xmath47 , the problem is reduced to a simple system of differential equations with constant coefficients .",
    "this is , @xmath48 with @xmath49 \\;.\\ ] ] this has a general solution ( non - zero ) given by @xmath50 with @xmath51    these are the two boundary conditions at the centre : from the values of @xmath52 and @xmath53 it is possible to determine @xmath54 and @xmath55 .",
    "two more boundary conditions need to be imposed at the top of the atmosphere . in a similar fashion to what has been done for the centre",
    ", we now need to established what is the limiting behaviour for the @xmath56 s ( the subscript `` @xmath19 '' represents in the following the value at the top of the atmosphere , located at @xmath57 ) for @xmath58 .",
    "there are different options for imposing a boundary condition at the top of the model ( surface ) .",
    "the most commonly used one is to assume an isothermal atmosphere for which we have that , @xmath59 in such an isothermal atmosphere the density decreases exponentially with radius .",
    "this behaviour allows one to approximate the actual value of @xmath60 by zero .",
    "the set of equations is now written as , @xmath61 where the matrix @xmath47 , has been approximated using the approximate values of @xmath41 ( see [ eq : ai - surf ] ) : @xmath62 \\;.\\ ] ] by redoing the analysis presented in the previous subsection , and using @xmath63 it follows that @xmath64 \\dis { \\cal y}_{s,04 } = - ( l{+}1)\\ ; { \\cal y}_{s,03 } \\;.",
    "\\cr \\end{array}\\label{eq : bc - surf1}\\ ] ]    when using the first expression one must be careful since the actual value for @xmath65 can be imaginary . if it happens the solution will have a propagating component at the boundary , which implies that the wave will be loosing energy at this boundary .",
    "this does not correspond to the type of solutions we are looking for ( standing waves ) .",
    "therefore we only consider eigenvalues that are real , corresponding to standing waves , i.e. solutions that are evanescent at the boundaries .",
    "note that this imposes restrictions on the values the frequency @xmath40 can have for possible modes of oscillation .",
    "solutions are only calculated for @xmath66 .",
    "other options for surface boundary conditions are possible ( and have been implemented in posc ) .",
    "the simplest option is to impose full reflection at the top of the model .",
    "such a condition is achieved by setting @xmath67 at @xmath68 , giving that @xmath69 instead of the first expression in eqs  ( [ eq : bc - surf1 ] ) .",
    "in order to calculated the eigenvalues ( frequencies of oscillation ) of a solar model posc  uses a simple numerical scheme to solve the set of equations  ( [ eq : difosc ] ) with the boundary conditions  ( [ eq : bc - cen ] ) and ( [ eq : bc - surf1 ] ) ( or one of the other alternatives ) . in this section",
    "we describe briefly how this is done .",
    "the actual expressions implemented in the code are extracted from the basic dimensionless system of 4 differential equations ; @xmath70 where the matrix @xmath71 is given in eq .",
    "( [ eq : matrixa ] ) .",
    "the functions @xmath41 are as listed in eq .",
    "( [ eq : apar ] ) and known on a mesh from the equilibrium model obtained from solving the stellar structure equations .",
    "we use the dimensionless frequency @xmath40 , related to the actual frequency of oscillation ( @xmath8 ) . as discussed above , under the selected boundary conditions ,",
    "solutions exist only for discrete values of @xmath72 .",
    "the _ mode order _",
    "@xmath73 is associated with the radial structure of the different eigenfunctions that exist for the same mode degree @xmath12 ( the code considers spherical stars , and so the solutions are independent of the azimutal order @xmath13 ) .",
    "these values and the corresponding solution @xmath34 are what we are trying to find .",
    "the method we use consists in , given a value of the degree @xmath12 , to determine the values(s ) of @xmath40 that give a continuous solution at some meeting point ( defined below as @xmath74 ) .",
    "this point is where we stop the integration up from the centre , and the integration down from the atmosphere . in other words",
    "we find the value(s ) of @xmath40 that have a global solution satisfying all our four boundary conditions .",
    "so what we do in fact is to iterate in @xmath40 in order to find the values that give the zeros of a function measuring the fitting of outer and inner solutions at @xmath74 .",
    "due to numerical control of errors and precision of the calculation we redefine the variables for different regions of the model .",
    "we do so by estimating which regions of the star are evanescent for a given frequency .",
    "the two points used here to define these regions are @xmath75 and @xmath76 .",
    "these depend on the model and the values of @xmath8 and degree @xmath12 , corresponding to the roots of the following equation , @xmath77 the acoustic cutoff frequency @xmath78 used here is determined by @xmath79    for the inner ( near the centre ) evanescent region we redefine the variables according to @xmath80 here , @xmath75 is the transition point separating this inner region from the zone where the default variables , as given in eq .",
    "( [ eq : def - eq ] ) , are used .    for the outer evanescent region ( surface layers ) , above @xmath81 , we use instead @xmath82    the equations are integrated from @xmath37 to @xmath83 determining @xmath84 . from there to a fitting point @xmath74 ( well within the oscillatory region ) we calculate the solution using the equations for @xmath34 .",
    "note that the transition from one region to the other is quite natural considering our definitions @xmath84 and @xmath85 of @xmath34 . on the other hand",
    "we integrate inward from @xmath86 to @xmath81 using instead the equations for @xmath85 .",
    "from there , down to @xmath74 we take again the equations for @xmath34 .    resulting from these two integrations",
    "we have the two sets of values at @xmath87 which are then continuous ( after normalization ) .",
    "since the system of equations is linear , this is so if and only if the value of @xmath40 is an eigenvalue . at this point what we actually do is to iterate on @xmath40 to find the zeros of the fitting determinant at @xmath74 .",
    "the method implemented to solve numerically the equations considered above is a shooting method using a second - order differences representation of the equations .",
    "it consists in writing the differential equations relating the values at two mesh points , @xmath88 and @xmath89 , as @xmath90 + { \\cal o}(h_n^3)\\;,\\ ] ] where @xmath91 and with @xmath92 . in order to replace the derivatives we use the different sets of differential equations discussed above for the regions @xmath93 .",
    "we also have to implement the boundary conditions .",
    "it is done by setting the values of @xmath94 and @xmath95 at the boundaries ( centre and surface ) and to calculate the values of @xmath96 and @xmath97 ( at both boundaries ) from the relations constructed in the previous section .",
    "both linearly independent solutions are found by setting the central / atmospheric values of @xmath94 equal to one and @xmath95 alternatively to one and to zero .",
    "the actual solution is a linear combination of these two ( for the interior solution - up to @xmath74 , as well as for the external solution - down to @xmath74 ) .",
    "since we are using a shooting method , from the values of these two solutions ( `` in '' and `` out '' ) at @xmath74 , we construct the matching matrix whose determinant has to be zero if @xmath40 is an eigenvalue .",
    "so the task of finding an eigenvalue is reduced to finding the zero of the determinant for the fitting conditions at @xmath74 .",
    "we maximize the efficiency of the search for the eigenvalues ( zeros of the determinant ) by using the fact that these values are separated approximately by @xmath98      the actual accuracy of the final values of the frequencies are determined by several aspects of the calculation .",
    "as it would be expected , the accuracy of the results ( frequencies ) depends on the accuracy of the equilibrium model being used . here",
    "we do not address this issue , referring the reader to @xcite and @xcite .    but another aspect associated with the equilibrium model , and determining the precision of the calculated eigenvalues , is the mesh on which the equilibrium model is given . to minimise this effect , before calculating the frequencies we produce a re - meshing of the equilibrium model .",
    "the actual details of the new mesh depends on the type of model and oscillation modes being calculated .",
    "we use a receipt similar to the one discussed by @xcite .",
    "this allows us to minimize the errors caused by having too few points where the eigenfunctions are expected to vary more strongly",
    ".    other aspect determining the accuracy of the eigenvalues is of course the numerical method used to integrate the four differential equations discussed above . in our case we have a second order scheme for the integration of the system of differential equations . to this",
    "we have also added the use of reduced dependent variables in the regions where the amplitudes of the eigenfunctions would be otherwise very small .    further to this the code also uses an extrapolation to improve the accuracy of the determination of each frequency .",
    "it is known as richardson extrapolation .",
    "this uses the fact that our second order integration has an error which varies with the inverse of the squared number of mesh points . using such a fact",
    "it can be written that the actual value of the eigenvalue is @xmath99 where @xmath100 is the result found for a mesh of @xmath101 points and @xmath102 for a mesh of @xmath103 points .",
    "the code uses , by default , @xmath104 , giving @xmath105 .",
    "this extrapolation requires extra work but improves significantly the accuracy of the numerical frequencies ( see @xcite ) .     and",
    "@xmath106 are shown . ]",
    "the behaviour of the frequencies with increasing number of mesh points is an internal checkpoint that allows one to identify where the actual frequencies are no longer affected by the precision of the integration scheme .",
    "such a comparison is shown in fig .",
    "[ fig : mesh_dif ] where the frequencies obtained for a solar model in a mesh of 10k points is compared with the frequencies obtained using the same model with 4k and 8k mesh points .",
    "we have also performed a detailed comparison with the results from adipls @xcite to have an external check on the computation .",
    "further comparisons of posc  with other codes has been performed recently by @xcite .    in general ( when using a model in a mesh of @xmath1076k points ) posc  frequencies of oscillation for solar - type stars",
    "have an estimated numerical uncertainty below @xmath108 .",
    "this is below the current observational errors of solar frequencies .",
    "similar values are obtained for oscillation modes of stars of different masses and ages if the mesh is adequately adapted ( in terms of number of points and its distribution ) to the eigenfunctions being calculated ( @xmath109 or @xmath110 modes ) .",
    "the main output of the code are the values of the frequencies of linear adiabatic oscillations of an equilibrium model of a star .",
    "the calculation to be done is defined by an interval in frequency ( @xmath111 ) and in mode degree ( @xmath112 ) .",
    "the mode order of each eigenvalue is obtained using a method similar to the phase diagram as described by @xcite .",
    "it consists in counting the number of times the solution crosses the line @xmath113 in the plane @xmath114 .",
    "if the cross is clockwise it counts as ( -1 ) otherwise as ( + 1 ) . when @xmath115 ( radial modes ) an additional ( + 1 ) cross is considered .    to a total negative counting of the crosses",
    "corresponds a @xmath109-mode while @xmath110-modes have positive counting results , with the number corresponding to the mode order .",
    "the solutions corresponding to @xmath116-mode eigenvalues have a total of zero counts .",
    "the eigenfunctions are provided in different formats ( several normalisations and/or combinations ) depending on what is required .",
    "these are obtained from @xmath34 and correspond to combinations of the functions , @xmath117 the equilibrium structure is also used to calculate different normalizations of the eigenfunctions .",
    "the code provides , in addition to the mode parameters and frequencies , the mode inertia as given by , @xmath118 r^2 \\rho \\ ; \\diff r \\over \\xi_r^2(r ) + l \\ ; \\xi_h^2 ( r ) } \\;.\\ ] ]",
    "this work provides a brief description of posc  - the porto oscillation code .",
    "this code has been developed mainly for calculating linear adiabatic oscillations of stellar models for stars similar to the sun ( in mass ) .",
    "the code is written in fortran  77 and is modular .",
    "it is prepared to accept input models in the amdl format .",
    "tools are also available to convert almost any available stellar model output to the required format to be used by posc .",
    "the code has been applied to several cases , namely the sun @xcite and other stars @xcite , including pre - main sequence models @xcite .",
    "it has also been used to produce the frequencies of reference grids of stellar evolution models for asteroseismology @xcite .",
    "we thank j. christensen - dalsgaard for all the data and documentation provided over the last 20 years that have allowed the author to implement and improve this code .",
    "this work was supported in part by the european helio- and asteroseismology network ( helas ) , a major international collaboration funded by the european commission ( fp6 ) , as well as by fct and poci2010 ( feder ) through projects poci / cte - ast/57610/2004 and poci / v.5/b0094/2005 .",
    "monteiro , m.j.p.f.g . ,",
    "lebreton , y. , montalbn , j. , et al .",
    ": report on the corot evolution and seismic tools activity . in : the corot mission ,",
    "m. fridlund , a. baglin , j. lochard & l. conroy ( eds ) : esa sp-1306 , 363 ( 2006 )"
  ],
  "abstract_text": [
    "<S> the _ porto oscillation code _ ( posc ) has been developed in 1995 and improved over the years , with the main goal of calculating linear adiabatic oscillations for models of solar - type stars . </S>",
    "<S> it has also been used to estimate the frequencies and eigenfunctions of stars from the pre - main sequence up to the sub - giant phase , having a mass between 0.8 and 4 solar masses .    </S>",
    "<S> the code solves the linearised perturbation equations of adiabatic pulsations for an equilibrium model using a second order numerical integration method . </S>",
    "<S> the possibility of using richardson extrapolation is implemented . </S>",
    "<S> several options for the surface boundary condition can be used . in this work </S>",
    "<S> we briefly review the key ingredients of the calculations , namely the equations , the numerical scheme and the output . </S>"
  ]
}