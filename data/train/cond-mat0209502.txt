{
  "article_text": [
    "theoretical predictions of material properties of complex systems consisting of millions of atoms are often limited not by theory but by the calculational techniques .",
    "recently there has been a large effort to develop ab - initio methods that computationally scale linearly with system size @xcite .",
    "the techniques may play an important role in a broad spectrum of science such as molecular biology , materials science , chemistry and nanotechnology .",
    "several of the linear scaling schemes are based on the single - particle density matrix that can be used in order to calculate the energies and densities that occur in self - consistent field theories .",
    "the construction of the density matrix is used as an alternative to solving an eigenvalue problem . for large complex systems within a sparse matrix representation",
    "this approach can be performed more efficiently and instead of a cubic scaling the computational cost scales linearly with the system size @xcite .",
    "the matrix sparsity is essential for the success of density matrix schemes . for materials with a gap the real space representation of the density matrix is sparse @xcite due to a finite interaction length , which is usually referred to as nearsightedness @xcite .",
    "however , within other representations , such as a multi - resolution wavelet basis or a group - renormalization representation , the density matrix is sparse also for metallic systems @xcite .",
    "most techniques for constructing the density matrix can be seen as a polynomial expansion of the density matrix @xmath2 in terms of the hamiltonian operator @xmath3 . in an iterative approach",
    "this expansion can be formulated as @xmath4 the projection polynomials @xmath5 are chosen to achieve a rapid convergence under the conditions of commutation , @xmath6 = 0 $ ] , idempotency , @xmath7 , and particle conservation , @xmath8 = n_e$ ] .",
    "they may either be chosen from a constrained conjugate gradient minimization of the energy functional @xmath9 $ ] @xcite , or as a fast expansion of the step function @xmath10 centered at the chemical potential @xmath11 , or , for finite temperatures , the fermi - dirac distribution @xcite .",
    "each computational step consists of matrix - matrix additions , subtractions and multiplications .",
    "the problem is to find a rapidly convergent expansion that minimizes the number of matrix - matrix multiplications , since these operations are the most time consuming @xcite .",
    "the efficiency of the different density - matrix schemes varies depending on particular characteristics of the problem such as the existence of a band gap , a predefined chemical potential , filling factor , self - consistency cycles , thresholding , basis set and system size . in this letter",
    "we propose a purification algorithm for the construction of the density matrix that is simple , general and rapidly convergent also for very large metallic systems .",
    "the method works with a predefined occupation and does not need the input or adjustment of the chemical potential .",
    "only one previous purification strategy , recently developed by palser and manolopoulos ( pm ) @xcite , exists for this important problem . by using a starting guess @xmath12 with the trace equal to the occupation number and thereafter performing trace - conserving spectral projections",
    ", @xmath13 converges to the correct density matrix without prior knowledge of the chemical potential .",
    "the pm scheme has an excellent performance compared to other methods @xcite .",
    "however , due to the constraint of trace conservation the method is inefficient at low and high partial occupancy .",
    "this is of great concern , for example , when using a multi - resolution wavelet representation for metallic problems , since the fractional filling in this case is low .",
    "the same problem occurs with a minimal basis set at both high and low occupancies .",
    "a simple general algorithm that avoids this particular problem , and still converges as or more rapidly , especially for very large problems , would therefore be of great interest .",
    "the method we propose is based on the continuously increasing purification polynomials with stationary end points in @xmath14 $ ] @xmath15 \\\\",
    "p_{m}^{(b)}(x ) = x^m\\left [ 1+m(1-x ) \\right ] . \\end{array } \\right.\\ ] ] two examples of @xmath16 and @xmath17 , for @xmath18 and @xmath19 , are displayed in fig .",
    "[ polyfig ] .",
    "it can be shown that any combination of these polynomials in an iterative expansion converges to a step function for @xmath20 $ ] , i.e.@xmath21 with the step @xmath22 $ ] . here",
    "@xmath23 is the inflection point of @xmath16 , i.e.  where @xmath24 , @xmath25 , and @xmath26 is the inflection point of @xmath17 .",
    "the convergence towards a step function can be understood from the fact that for each new iteration the new function will still be continuously increasing , but with an in creasing number of vanishing derivatives at the end points .",
    "the asymmetry in the number of vanishing derivatives determines the position of the step .",
    "the choice @xmath27 corresponds to the mcweeny polynomial @xcite . in this symmetric case @xmath28 , and a step",
    "can only be formed at @xmath29 .",
    "the occupation of an operator @xmath30 can be modified such that @xmath31 \\geq tr [ x ] ; & \\varepsilon ( x ) \\in [ \\beta_m,1]\\\\ tr [ p_{m}^{(b)}(x ) ] \\leq tr [ x ] ; & \\varepsilon ( x ) \\in [ 0,1-\\beta_m ] , \\end{array } \\right.\\ ] ] where @xmath32 are the eigenvalues of @xmath30 . for @xmath18",
    "the reverse situation holds , with switched inequalities .",
    "with @xmath33 we can apply the polynomials of eq .",
    "( [ poly ] ) in the expansion of the density matrix , eq .",
    "( [ purif ] ) , such that each step adjusts for the occupation of @xmath34 . in this way",
    "an expansion is created that converges to the density matrix with the correct occupation , i.e.  @xmath35 with @xmath8 = n_e$ ] , but without _ a priori _ knowledge of @xmath11 .",
    "the algorithm ( for @xmath36 ) is given by this pseudocode : @xmath37 - n_e < 0 \\\\",
    "~~ ~~ x_{n+1 } =   p_{m}^{(a)}(x_n )   \\\\ ~~ { \\it else}\\\\ ~~ ~~ x_{n+1 } = p_{m}^{(b)}(x_n ) \\\\",
    "~~ { \\it end}\\\\ ~~ { \\it estimate~ error } \\\\",
    "{ \\it end}\\\\ \\rho_0 = x_n ~ . \\\\ \\end{array}\\ ] ] for @xmath38",
    "the trace condition has to be reversed to @xmath39 .",
    "the scheme can be described as follows : first the hamiltonian is normalized to an initial matrix @xmath12 with all its eigenvalues @xmath40 $ ] .",
    "the constants @xmath41 and @xmath42 are the lowest and highest eigenvalues of @xmath3 , respectively .",
    "these can be approximated by , for example , gersgorin estimates or the lanczos method , with only a small extra computational cost @xcite .",
    "a necessary criterion for convergence is that the unknown chemical potential of the normalized initial matrix @xmath43 $ ] . for intermediate occupancy ,",
    "provided @xmath43 $ ] , @xmath23 can be set to zero in the starting guess .",
    "this usually reduces the number of iterations by one or two steps .",
    "the improvement has not been used in the present study .",
    "after initializing @xmath12 the projections @xmath44 or @xmath45 are performed , adjusting the occupancy and expanding a step function at the same time .",
    "the iteration stops when some appropriate error estimate is less than a predefined error limit .",
    "note , that a high order expansion may lead to too fast convergence , making the adjustment of the occupation impossible .",
    "we may also use combinations with different values of @xmath46 as well as other asymmetric purification polynomials .",
    "any set of asymmetric continuously increasing polynomials in @xmath14 $ ] with stationary points at @xmath47 and @xmath48 can be used equivalently .",
    "the presented algorithm can not handle problems with degenerate eigenstates at @xmath11 .",
    "the algorithm would still converge , but to the wrong density matrix , since the degenerate states would split due to numerical noise .",
    "this differs the presented trace correcting purification scheme from the pm scheme , which correctly can treat the case of degeneracy .",
    "since any combination of the expansion polynomials in eq .",
    "( [ poly ] ) converges to a step function we can use a predefined fixed expansion combination of @xmath49 . in this case",
    "@xmath11 must be known , but the efficiency might be slightly improved compared to the schemes working with a predefined occupancy . for example , we may use the repetitions of the combination @xmath50 or ( for @xmath51 ) only @xmath52 , or only @xmath53 , in the combination @xmath54 where @xmath55 is the normalized chemical potential , @xmath56 .",
    "we can now , as in eq .",
    "( [ purif ] ) , perform the expansion using the fixed repeated combination of @xmath16 and @xmath17 with the starting guess @xmath57^{-1 } , ( 1-\\beta)[\\mu - \\varepsilon_0]^{-1 } \\right\\}. \\end{array}\\ ] ] the constant @xmath58 is here determined by the inflection point of the repeated fixed polynomial combination , e.g.   @xmath23 or @xmath26 for @xmath59 .",
    "the approach can be seen as an asymmetric generalization of the grand canonical mcweeny purification scheme @xcite . with @xmath60",
    "they are equivalent .",
    "the method is directly related to matrix sign function expansions @xcite .",
    "the matrix sign function expansion is equivalent to the purification scheme via a trivial linear transform where the step function expansion is performed between @xmath61 and @xmath62 in the interval @xmath63 $ ] .",
    "if the chemical potential is unknown the density matrix may have to be recalculated with different values of @xmath11 until the occupation is correct .",
    "however , since the density matrix can be described as a superposition of outer products of the occupied eigenstates we can adjust the occupation by adding or subtracting hamiltonian eigenstates close to the chemical potential .",
    "a few of these states can be calculated efficiently , for example , using inverse power iterations @xcite . in this way",
    "the occupation can be adjusted without a complete recalculation of the density matrix with a new shifted chemical potential . moreover , in the case of a material with a gap we do not need to have a very precise prior knowledge of @xmath11 as long as the estimate is somewhere in the gap .",
    "the grand canonical approach , with a predefined fixed @xmath11 , may thus be an efficient alternative to trace correcting purification in some special cases .",
    "to illustrate the efficiency of the expansion techniques we have constructed an @xmath64 hamiltonian test matrix @xmath65 with randomized off - diagonal elements decaying as @xmath66 , and with a uniform distribution of eigenvalues in @xmath14 $ ] .",
    "only the eigenvalue distribution of the hamiltonian is of importance for the convergence . with @xmath67",
    "we have that the occupation factor @xmath68 and it is easy to compare grand canonical schemes with the trace correcting or trace conserving methods .",
    "figure [ conv ] shows the number of matrix multiplications necessary to achieve an error @xmath69 as a function of the filling factor @xmath70 or chemical potential @xmath11 .",
    "the pm trace conserving purification scheme is slow at low and high occupancy ( since the slope at the inflection point tends to 1 as the inflection point approaches 0 or 1 ) , whereas the new trace correcting expansion algorithm , with @xmath18 ( p@xmath71 ) , @xmath72 ( p@xmath73 ) , and @xmath74 ( p@xmath75 ) , has an overall fast convergence .",
    "for example , at @xmath76 occupancy the new scheme with @xmath72 is about twice as fast compared to the pm scheme .",
    "there are essentially three reasons for the improved convergence : _ i ) _ a more optimized ratio between the number of matrix multiplications and the polynomial order , _ ii ) _ a faster increase of the number of vanishing derivatives at the stationary end points , and _",
    "iii ) _ , as will be shown below , a steeper slope at the inflection points , partly due to the asymmetry of the purification polynomials .",
    "the generalized grand canonical expansion with @xmath72 ( p@xmath77 ) converges several steps faster compared to the grand canonical mcweeny ( mcw ) method for the same reasons .",
    "by varying @xmath78 , i.e. the size of the hamiltonian test matrix , we may see how the number of matrix multiplications necessary for convergence scales with system size , or equivalently with the inverse gap at the chemical potential @xmath79 .",
    "the behavior is crucial for very large systems , especially if we wish to construct an expansion scheme that computationally scales linearly with the system size for metallic materials with a vanishing band gap .",
    "figure [ linsc ] displays the number of necessary matrix multiplications as a function of @xmath80 . in the upper graph the results of mcweeny purification ( mcw ) and the trace conserving canonical purification ( pm ) are on top of each other . for this particular symmetrical case",
    "the two schemes are identical @xcite .",
    "the graph indicates a stepwise linear relationship between the number of matrix multiplications @xmath81 necessary for convergence and the logarithm of the system size .",
    "the relation can be approximated by the linear formula @xmath82 the least square fits of @xmath83 are shown together with the values of @xmath84 .",
    "the expansions p@xmath71 , p@xmath75 and p@xmath77 perform equally well or slightly worse compared to p@xmath73 , and are not shown .",
    "the slopes determine the efficiency for very large systems and we find the best scaling for p@xmath73 .",
    "the convergence is determined by the slowest converging eigenvalue @xmath85 , closest above or below the chemical potential of the normalized initial matrix @xmath86 .",
    "this particular eigenvalue should either converge to @xmath48 or @xmath47 . since the purification polynomials are continuously increasing , preserving the order of the eigenvalues , all other eigenvalues converge faster . in the case of grand canonical purification , with a uniform distribution of @xmath78 eigenvalues , @xmath87 .",
    "by means of a linearization of the purification polynomial around @xmath58 it can be shown that @xmath88 , where @xmath89 is the derivative of the purification polynomial at the inflection point , e.g.   @xmath90 .",
    "thus , increasing the number of states by @xmath91 and performing one extra iteration leads to the same error in @xmath92 .",
    "if @xmath93 is the number of multiplications necessary to achieve a fixed error of @xmath92 and @xmath94 is the number of matrix multiplication in one iteration , we have that @xmath95/(\\delta n ) \\approx p[n(k-1)]^{-1}.\\ ] ] let @xmath96 be a continuous version of @xmath93 such that @xmath97^{-1}.\\ ] ] integration gives @xmath98 for some constant @xmath99 .",
    "this approximate formula explains the linear relation in eq .",
    "( [ ordn ] ) and is a useful measure in optimizations of grand canonical expansions .",
    "purification polynomials should be optimized on the criterion of matrix multiplications v.s .",
    "vanishing derivatives at the stationary fixed points , and the slope @xmath100 as estimated in eq .",
    "( [ linsca ] ) .",
    "for example , the purification @xmath101 requires two matrix multiplications in each iteration , it has three vanishing fixed point derivatives , and @xmath102 .",
    "this should be compared to mcweeny purification that also requires two matrix multiplications in each iteration , but with only two vanishing fixed point derivatives , and with a @xmath103 .    for materials with a band gap , the value @xmath104 should be replaced by the gap at the chemical potential @xmath105 . in this case",
    "the scaling with the logarithm of the system size vanishes and the number of necessary matrix multiplication for a predefined convergence accuracy is constant .",
    "notice that one may use different criteria for convergence such as the error per state , per atom , or the total error .",
    "however , this has only a minor effect on the number of necessary matrix multiplications because of the very rapid rate of convergence close to idempotency , which , for example , is quadratic in the wcweeny case .",
    "to further illustrate the performance of the expansion scheme we show the result of an implementation in the mondoscf suite of linear scaling self - consistent field programs @xcite .",
    "figure [ scf ] displays the number of necessary matrix multiplications for clusters and strings of li atoms and for different molecules . in the case of li clusters and strings of li",
    "atoms the systems are metallic in the sense that the gap vanishes in the limit of infinite number of atoms .",
    "this is thus a good test to check the linear relationship between the number of matrix multiplications and the logarithm of the inverse band gap , i.e. the logarithm of the system size for metallic materials .",
    "the p@xmath71 scheme is efficient compared to the pm scheme , especially in the case of sif@xmath106 where the occupancy @xmath70 is high .",
    "this particular example illustrates the inefficiency of the pm scheme at high and low occupancy which is avoided with the trace correcting algorithm . the weak logarithmic dependence between computational cost and system size for metallic systems , illustrated by the dashed lines in the figure ,",
    "is also confirmed .",
    "notice that an actual linear scaling is reached only if the number of non zero elements of the density matrix grows linearly with system size .",
    "this can generally not be achieved within a real - space representation for metallic systems . instead , as mentioned above , a multi - resolution wavelet basis or a group - renormalization approach has to be applied .",
    "however , the number of matrix multiplication necessary for convergence should not be affected by a change of representation since the vanishing gap around the chemical potential will remain the same regardless of the representation , given , in the case of a wavelets , via a biorthogonal transformation of the hamiltonian @xcite .",
    "the p@xmath71 scheme implemented in the mondoscf programs has two major advantages compared to other schemes : _",
    "i ) _ it requires less memory compared to higher order schemes since only second order polynomials are used and intermediate matrix products does not have to be stored . _",
    "ii ) _ it is less complex and only matrix squares has to be calculated . a specially designed algorithm for matrix squares",
    "can possibly be made more efficient than a general matrix product algorithm .",
    "the expansion scheme and the convergence analysis illustrated and argued for here provide a basis for the understanding of purification algorithms and their efficiency , and it shows that the computational complexity , as measured in number of matrix multiplications , essentially is independent of system size even for metallic systems .",
    "this is in contrast to , for example , some conjugate gradient schemes , where in the worst case , the maximal number of iterations was shown to scale as @xmath107 , with @xmath108 varying between @xmath109 for insulators and @xmath48 for metals @xcite .",
    "however , if the additional problem of thresholding is included , which can be performed either via a finite cut - off radius truncation , or via a numerical threshold , the computational complexity as a function of system size , within some required numerical accuracy , becomes far more difficult to analyze and practical experience may be the only way to understand the efficiency .    in the alternative construction of the density matrix using a constrained functional minimization , as devised by li _",
    "@xcite , the mcweeny purification is used to impose idempotency .",
    "the asymmetric polynomial expansions proposed here may serve as a possible alternative .",
    "in summary we have proposed an algorithm for expanding the single - particle density matrix in terms of the hamiltonian that is simple , general , and with a computational complexity essentially independent of system size even for very large metallic systems with a vanishing band gap .",
    "if the expansion is used together with a fixed chemical potential it was shown to be an asymmetric generalization of the grand canonical mcweeny purification .",
    "the algorithm is a substantial improvement of previous schemes and provides together with the presented convergence analysis a framework for the understanding and optimization of purification .",
    "discussions and support from matt challacombe and c.  j. tymczak are gratefully acknowledged .",
    "i am also very thankful for editorial help from  eric chisolm ."
  ],
  "abstract_text": [
    "<S> a purification algorithm for expanding the single - particle density matrix in terms of the hamiltonian operator is proposed . </S>",
    "<S> the scheme works with a predefined occupation and requires less than half the number of matrix - matrix multiplications compared to existing methods at low ( @xmath0 ) and high ( @xmath1 ) occupancy . </S>",
    "<S> the expansion can be used with a fixed chemical potential in which case it is an asymmetric generalization of and a substantial improvement over grand canonical mcweeny purification . </S>",
    "<S> it is shown that the computational complexity , measured as number of matrix multiplications , essentially is independent of system size even for metallic materials with a vanishing band gap . </S>"
  ]
}