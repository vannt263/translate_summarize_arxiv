{
  "article_text": [
    "the large - scale spatial organization of matter in clusters , filaments , sheets and voids , known as the _ cosmic web _ ( peebles 1980 ; bardeen et al . 1986 ; bond et al .",
    "1991 ) , is the manifestation of the anisotropic nature of gravitational collapse .",
    "this typical filamentary pattern has been confirmed by observations , for example with the 2dfgrs , sdss and 2mass redshift surveys of the nearby universe ( colless et al .",
    "2003 ; tegmark et al .",
    "2004 ; huchra et al .",
    "2005 ) , and is routinely seen in large scale @xmath0-body numerical simulations  see for example the new horizon runs ( kim et al .",
    "2011 ) or the recent millennium - xxl ( angulo et al . 2012 ) .",
    "basic characteristics of the cosmic web are the spatial arrangement of galaxies and mass into elongated filaments , sheet - like walls and dense compact clusters , the existence of large near - empty void regions , and the hierarchical nature of this mass distribution ( aragn - calvo et al . 2007 , 2010a , b ; zhang et al .",
    "in particular , as pointed out by bond , kofman & pogosyan ( 1996 ) , ` embryonic ' cosmic web is already present in the primordial density field .",
    "these key properties , along with the alignment of shape and angular momentum of objects ( i.e. argyres et al .",
    "1986 ; catelan et al .",
    "2001 ; lee & springel 2010 ) , are mainly due to the effects of the tidal field , associated with the gravitational potential  while the hessian of the density field ( i.e. the inertia tensor ) plays a secondary role in determining the characteristic pattern of the cosmic web .    pioneering works devoted to the key role of the initial tidal field in shaping large - scale structures trace back to doroshkevich & zeldovich ( 1964 ) , doroshkevich ( 1970 ) , zeldovich ( 1970 ) , sunyaev & zeldovich ( 1972 ) , icke ( 1973 ) , and doroshkevich & shandarin ( 1978 ) ; their studies have contributed to reach a solid understanding of the formation and evolution of structures .",
    "other classical works in this direction ( i.e. peebles 1980 ; white 1984 ; bardeen et al .",
    "1986 ; kaiser 1986 ; bertschinger 1987 ; dubinski 1992 ; bond & myers 1996 ; bond , kofman & pogosyan 1996 ; van de weygaert & bertschinger 1996 ) have considerably improved the statistical description of the cosmic web from first principles .",
    "their impact is broader , as there is a correspondence between structures in the evolved density field and local properties of the linear tidal shear ; this allows one to estimate the morphology of the cosmic web ( bond & myers 1996 ; rossi , sheth & tormen 2011 ) , and is crucial in understanding the nonlinear evolution of cosmic structures ( springel et al . 2005 ; shandarin et al .",
    "2006 ; pogosyan et al .",
    "2009 ) , the statistical properties of voids ( lee & park 2006 ; platen , van de weygaert & jones 2008 ; lavaux & wandelt 2010 ) , the alignment of shape and angular momentum of halos ( west 1989 ; catelan et al . 2001 ; faltenbacher et al . 2009",
    "; lee & springel 2010 ) , and for characterizing the geometry and topology of the cosmic web ( gott et al .",
    "1986 , 1989 ; park & gott 1991 ; park et al .",
    "1992 , 2005 ; van de weygaert & bond 2008 ; forero - romero et al .",
    "2009 ; aragon - calvo et al .",
    "2010a , b ; choi et al . 2010",
    "; shandarin et al . 2010 ; van de weygaert et al . 2011 ; cautun et al .",
    "2012 ; hidding et al .",
    "in addition , the eigenvalues of the mass tidal tensor can be used to classify the large - scale environment ( shen et al .",
    "2006 ; hahn et al . 2007 ; zhang et al . 2009 )",
    " hence their fundamental importance .    in the context of the initial shear field , doroshkevich ( 1970 ) provided a key contribution by deriving the joint probability distribution of an ordered set of eigenvalues in the tidal field matrix corresponding to a gaussian potential , given the variance of the density field . throughout the paper",
    ", we will refer to it as the _ unconditional _ probability distribution of shear eigenvalues . because the initial shear field associated with gaussian statistics plays a major role in the formation of large scale structures ,",
    "considerable analytic work has been based on doroshkevich s unconditional formulas since their appearance , but those relations neglect the fact that halos ( voids ) may correspond to maxima ( minima ) of the underlying density field .",
    "the local extrema of such field ( i.e. peaks / dips ) are plausible sites for the formation of nonlinear structures ( bardeen et al .",
    "1986 ) , and some numerical studies have indeed reported a good correspondence between peaks in the initial conditions and halos at late times ( see in particular ludlow & porciani 2011 ) . hence , their statistical properties can be used to predict the abundances and clustering of objects of various types , and in studies of triaxial formation of large - scale structures ( bardeen et al .",
    "1986 ; bond & myers 1996 ) .    motivated by these reasons , recently rossi ( 2012 ) has provided a set of analytic expressions which extend the work of doroshkevich ( 1970 ) and bardeen et al .",
    "( 1986 )  and are akin in philosophy to that of van de weygaert & bertschinger ( 1996 ) .",
    "these new relations incorporate the peak / dip constraint into the statistical description of the initial shear field , and are able to differentiate between random positions and peak / dips in the correlated density field .",
    "in essence , they allow one to express the joint probability distribution of an ordered set of eigenvalues in the initial shear field , given the fact that positions are peaks or dips of the density  and not just random spatial locations .",
    "these relations are obtained by requiring the density hessian ( i.e. the matrix of the second derivatives of the density field , associated with the curvature ) to be positive / negative definite , which is the case in the vicinity of minima / maxima of the density .",
    "the correlation strength between the gravitational and density fields is quantified via a reduced parameter @xmath1 , which plays a major role in peaks theory ( i.e. @xmath1 is the same as in bardeen et al .",
    "1986 for gaussian smoothing filters ",
    "see appendix [ notation ] ) .",
    "doroshkevich s ( 1970 ) _ unconditional _ formulas are then naturally recovered in the absence of correlation , when @xmath2 . from these new _",
    "conditional _ joint probabilities , it is possible to derive the individual distributions of eigenvalues subjected to the extremum constraint , along with some other related conditional probabilities ; their expressions were also provided in rossi ( 2012 ) , extending the work of lee & shandarin ( 1998 ) .",
    "the primary goal of this paper is show how the main conditional formulas presented in rossi ( 2012 ) and reported here ( equations [ doro_inter_extended ] and [ doro_eigen ] ) lead to a new algorithm  called the ` peak / dip excursion - set - based ' algorithm  to sample the constrained eigenvalues of the initial shear field associated with gaussian statistics , at positions which correspond to peaks or dips of the correlated density field .",
    "while it is clearly possible to sample the constrained eigenvalues of the tidal field directly from the conditional probability distribution function , as done for example by lavaux & wandelt ( 2010 ) in the context of cosmic voids , the theoretical work carried out by rossi ( 2012 ) allows for a much simpler procedure , part of which was previously thought not to be achievable analytically ( see again the appendix b in lavaux & wandelt 2010 ) . besides providing novel theoretical insights ,",
    "the main strength of the algorithm resides in its natural inclusion into the standard excursion set framework , allowing for a generalization . as we will discuss in section [ esmpd ] , this technique potentially solves a long - standing problem of the standard excursion set theory ; moreover , it is well - suited for the ellipsoidal collapse framework .",
    "the other goal of the paper is to present a first physical application of the new algorithm , related to the morphology of the cosmic web . in particular , we provide a new expression for the conditional distribution of shape parameters ( i.e. ellipticity and prolateness ) in the presence of the density peak constraint , which generalizes some previous literature work and combines the formalism of bardeen et al .",
    "( 1986 )  based on the density field  with that of bond & myers ( 1996 )  based on the shear field .",
    "the formula has important implications for the modeling of non - spherical dark matter halos and their evolved halo shapes , in relation to the initial shape distribution .",
    "in addition , we also test and confirm our theoretical predictions for the individual distributions of eigenvalues subjected to the extremum constraint , along with other directly related conditional probabilities .",
    "finally , we illustrate how this algorithm can be readily merged into the excursion set framework ( peacock & heavens 1990 ; bond et al .",
    "1991 ) , and in particular to obtain an excursion set model for peaks and dips in gaussian random fields .",
    "the key point is the ability to differentiate between random positions and peaks / dips , which is contained in equations ( [ doro_inter_extended ] ) and ( [ doro_eigen ] ) and encapsulated in the algorithm . while we leave this latter part to a dedicated forthcoming publication , we anticipate the main ideas here .",
    "we also discuss several other ongoing applications and extensions , towards the development of algorithms for classifying cosmic web structures .",
    "the layout of the paper is organized as follows .",
    "section [ jde ] provides a short review of the key equations derived in rossi ( 2012 ) , which constitute the theoretical framework for the new algorithm described here ; the main notation adopted is summarized in appendix [ notation ] , for convenience .",
    "moving from this mathematical background , section [ pdesa ] presents the new ` peak / dip excursion - set - based ' algorithm ( some insights derived from this part are left in appendix [ insights ] ) , while section [ cdpnt ] tests its performance against various analytic distributions of eigenvalues and related conditional probabilities , subjected to the extremum constraint .",
    "section [ epd ] shows a physical application of the computational procedure , towards the morphology of the cosmic web . a new expression for the conditional distribution of ellipticity and prolateness in the presence of the density peak constraint is also given ; in particular , the description of bardeen et al .",
    "( 1986 ) is combined with that of bond & myers ( 1996 ) .",
    "section [ esmpd ] illustrates how this new algorithm can be readily used to implement an excursion set model for peaks and dips in gaussian random fields , and makes the connection with some previous literature .",
    "finally , section [ conc ] discusses several ongoing and future promising applications , which will be presented in forthcoming publications , and in particular the use of this algorithm for triaxial models of collapse and in relation to the morphology and topology of the cosmic web .",
    "we begin by reexamining two main results derived in rossi ( 2012 ) , which constitute the key for developing a new algorithm to sample the constrained eigenvalues of the initial shear field .",
    "this part may be also regarded as a compact review of the main formulas for the constrained shear eigenvalues , which can be used directly for several applications related to the cosmic web .",
    "the notation adopted here is the same as the one introduced by rossi ( 2012 ) , with a few minor changes to make the connection with previous literature more explicit .",
    "it is summarized in appendix [ notation ] ; a reader not familiar with the notation may want to start from the appendix first .",
    "in particular , in what follows we do not adopt ` reduced ' variables , so that the various dependencies on @xmath3 values ( i.e. @xmath4 for the shear , and @xmath5 for the density hessian ) are now shown explicitly .",
    "however , for the sake of clarity , we omit to indicate the understood dependence of these two global parameters in the left - hand side of all the formulas .",
    "note that we prefer to write @xmath6 and @xmath7 , rather than @xmath8 and @xmath9 , for their more intuitive meaning ( i.e. the label @xmath10 indicates that a quantity is connected to the shear field , while the label @xmath11 points to the hessian of the density field ) . as explained in appendix",
    "[ notation ] , we also introduce the 6-dimensional vectors @xmath12 and @xmath13 , derived from the components of their corresponding shear and density hessian tensors .    rossi ( 2012 ) obtained the following expression for the probability of observing a tidal field @xmath14 for the gravitational potential , given a curvature @xmath15 for the density field : @xmath16 \\label{doro_inter_extended}\\ ] ] where @xmath17 the corresponding unconditional marginal distributions @xmath18 and @xmath19 are multidimensional gaussians , expressed using doroshkevich s formulas as @xmath20,~~ p({\\bf h } ) = { 15 ^ 3 \\over 16 \\sqrt{5 } \\pi^3 } { 1 \\over \\sigma_{\\rm h}^6 } { \\rm exp } \\big [ { - \\rm { 3 \\over 2 \\sigma^2_{\\rm h } } ( 2 h_1 ^ 2 - 5 h_2 ) } \\big ] .",
    "\\label{doro_standard}\\ ] ] equation ( [ doro_inter_extended ] ) generalizes doroshkevich s formulas ( [ doro_standard ] ) to include the fact that halos / voids may correspond to maxima / minima of the density field . note in particular that @xmath21 is a multivariate gaussian distribution with mean @xmath22 and covariance matrix @xmath23 , with @xmath24 given in appendix [ notation ] .",
    "clearly , one can also consider the reverse distribution @xmath25 , the expression of which is given in rossi ( 2012 ) .",
    "this is useful in order to make the connection and extend some results derived in bardeen et al .",
    "( 1986 ) , the subject of a forthcoming publication .",
    "it is also possible to express ( [ doro_inter_extended ] ) in terms of the constrained eigenvalues of @xmath26 , indicated with @xmath27 ( @xmath28 ) and ordered as @xmath29 .",
    "the result is : @xmath30   ( \\zeta_1-\\zeta_2 ) ( \\zeta_1-\\zeta_3 ) ( \\zeta_2-\\zeta_3)\\ ] ] where in terms of constrained eigenvalues we now have : @xmath31 the partial distributions @xmath32 and @xmath33 are expressed by doroshkevich s unconditional formulas as @xmath34 ( \\lambda_1-\\lambda_2 )      ( \\lambda_1-\\lambda_3 ) ( \\lambda_2-\\lambda_3 ) \\label{doro_original}\\ ] ] @xmath35   ( \\xi_1-\\xi_2 )      ( \\xi_1-\\xi_3 ) ( \\xi_2-\\xi_3 ) ,      \\label{doro_original_bis}\\ ] ] where @xmath36 are the eigenvalues of the shear tensor , while @xmath37 are those of the density hessian .",
    "similarly , one can easily obtain formulas for the reverse probability functions .",
    "note also that @xmath38 is simply the overdensity @xmath39 associated to the shear field , while @xmath40 .",
    "later on , we will make use of the peak height @xmath41 and of the peak curvature @xmath42 .    equations ( [ doro_inter_extended ] ) and ( [ doro_eigen ] ) allow one to develop a new algorithm to sample the constrained eigenvalues of the initial shear field , presented in the next section",
    ". it will be then straightforward to use this algorithm in order to implement an excursion set model for peaks and dips in gaussian random fields .",
    "while the constrained eigenvalues of the initial shear field can be sampled directly from their probability distribution function ( i.e. equations [ doro_inter_extended ] or [ doro_eigen ] ) , the new theoretical formalism developed by rossi ( 2012 ) leads to a much simpler algorithm , which is particularly interesting because well - suited for the ellipsoidal collapse model ( section [ epd ] ) , and naturally integrable in the excursion set framework ( section [ esmpd ] ) . in addition , the algebra leading to the new computational procedure allows one to explain analytically how the halo ( void ) shape distributions are altered by the inclusion of the peak ( dip ) constraint , and offers a variety of applications and insights on the statistical description of the cosmic web ( see section [ conc ] and appendix [ insights ] ) . in what follows ,",
    "we present the mathematical aspects of the ` peak / dip excursion - set - based ' algorithm , and describe in detail the novel computational procedure .    in particular , we are mainly interested in the distribution @xmath43 , the joint probability of observing a tidal field @xmath14 for the gravitational potential with a positive density curvature @xmath44 ( i.e. at density peak locations ) . clearly , @xmath45 where @xmath21 and @xmath19 are given by equations ( [ doro_inter_extended ] ) and ( [ doro_standard ] ) , and the integrals are 6-dimensional .",
    "a similar expression can be written in terms of the constrained distributions of eigenvalues , using equation ( [ doro_eigen ] ) instead . in principle , one should then compute the previous integral to obtain @xmath46 .",
    "however , it is easier to sample @xmath21 and impose the condition @xmath44 directly , so that we are effectively computing @xmath47 . given the nature of @xmath21 and @xmath19 expressed by ( [ doro_inter_extended ] ) and ( [ doro_standard ] ) , this can be readily achieved  as the following algebra will show .",
    "in fact , because the elements of the density hessian are drawn from a multivariate gaussian distribution with zero mean and covariance matrix @xmath48 , where @xmath24 is given by equation ( [ matrix_a ] ) , one can simply obtain them by generating six independent zero - mean unit - variance gaussian random variates @xmath49 ( @xmath50 ) , and then determine the various components as : @xmath51    similarly , the elements of the shear tensor are also drawn from a multivariate gaussian distribution with mean zero and covariance matrix @xmath52 .",
    "hence , if @xmath53 ( @xmath50 ) are other six independent zero - mean unit - variance gaussian random variates , the components of the shear tensor are given by : @xmath54    next , consider the 6-dimensional vector @xmath26 , made from the components of the conditional shear field .",
    "its elements are drawn from a multivariate gaussian distribution @xmath21 with mean @xmath22 and covariance matrix @xmath23 , where the elements of the density hessian are expressed by ( [ h_gauss ] ) .",
    "therefore , this implies that the components of @xmath26 are distributed according to : @xmath55 in the previous expression , the various @xmath56 ( @xmath50 ) are other six independent zero - mean unit - variance gaussian variates , while the @xmath57 ( @xmath50 ) are six independent gaussian distributed variates with shifted mean @xmath58 and reduced variance @xmath59 , i.e. @xmath60 .    equations ( [ h_gauss ] ) , ( [ t_gauss ] ) and ( [ t_given_h_gauss ] ) suggest a new excursion - set - based algorithm , in order to obtain the constrained eigenvalues of the matrix having components @xmath61 ( see appendix [ notation ] for the definition of the index @xmath62 )  supplemented by the condition of a positive curvature @xmath15 for the density field ( or negative curvature , for voids ) .",
    "the procedure can be summarized as follows :    1 .",
    "draw six independent zero - mean unit - variance gaussian distributed variates @xmath49 ( @xmath50 ) , and determine the components @xmath63 of the density hessian matrix via equation ( [ h_gauss ] ) .",
    "compute the value of @xmath7 using ( [ eq_sig ] ) .",
    "2 .   calculate the eigenvalues @xmath37 of the previous hessian matrix , and check if they are all positive ( negative ) .",
    "if so , proceed to the next step , otherwise try again .",
    "this will guarantee the hessian to be positive ( negative ) definite ( i.e. the hessian is a real - symmetric matrix ) , which is the condition for maxima ( minima ) of the field . note that this step is clearly not required if we want to sample only @xmath21 .",
    "3 .   draw other six independent gaussian distributed variates @xmath56 ( @xmath50 ) , with mean zero and variance one , and determine the @xmath61 components via equation ( [ t_given_h_gauss ] ) , using the previously accepted values @xmath63 from ( [ h_gauss ] )  while @xmath6 is determined via ( [ eq_sig ] ) .",
    "since we require the density hessian to be positive definite , this means that we are effectively sampling the conditional probability @xmath47  or @xmath64 for a negative definite hessian .",
    "4 .   calculate and store the constrained eigenvalues @xmath27 of the matrix having components @xmath65 .",
    "we leave in appendix [ insights ] some more insights on the main conditional formula ( [ doro_inter_extended ] ) , which readily follow from the previous equations ( [ h_gauss ] ) , ( [ t_gauss ] ) and ( [ t_given_h_gauss ] ) . in the next sections , we will show a few applications of the new algorithm  with particular emphasis on the conditional distributions of shape parameters in triaxial models of structure formation ( i.e. ellipticity and prolateness ) .",
    "additional applications will be presented in forthcoming publications .",
    "the algorithm illustrated in the previous section allows one to test and confirm several formulas derived by rossi ( 2012 ) , regarding conditional distributions and probabilities subjected to the extremum constraint .",
    "we present here results of the comparison ( i.e. theory versus numerical ) , where for simplicity we set @xmath66 ; this corresponds to adopt ` reduced variables ' , as done in rossi ( 2012 ) .",
    "note that we show explicitly the dependencies on @xmath3 values in the following expressions , although we set them to unity in the mock tests .",
    "the individual conditional distributions of shear eigenvalues , for a given correlation strength @xmath1 with the density field ( which encapsulate the peak / dip constraint ) , are given by ( rossi 2012 ) : @xmath67   + { 3 \\sqrt{3 \\pi } \\over \\sqrt{1-\\gamma^2}}~         { \\rm exp } \\big ( - { 15   \\over 4 ( 1-\\gamma^2)}{\\zeta^2_1 \\over \\sigma^2_{\\rm t } }   \\big ) { \\rm erfc } \\big (         -{\\sqrt{3 } \\over 2 \\sqrt{1-\\gamma^2}}{\\zeta_1 \\over \\sigma_{\\rm t } }          \\big )                       \\big ] \\nonumber   \\end{aligned}\\ ] ]    @xmath68 \\end{aligned}\\ ] ]    @xmath69   - { 3 \\sqrt{3 \\pi } \\over \\sqrt{1-\\gamma^2}}~         { \\rm exp } \\big ( - { 15   \\over 4 ( 1-\\gamma^2)}{\\zeta^2_3 \\over \\sigma^2_{\\rm t } }   \\big ) { \\rm erfc } \\big (         { \\sqrt{3 } \\over 2 \\sqrt{1-\\gamma^2}}{\\zeta_3 \\over \\sigma_{\\rm t } }          \\big )                       \\big ] .",
    "\\nonumber   \\end{aligned}\\ ] ]    the previous formulas show explicitly that the conditional distributions of shear eigenvalues are doroshkevich - like expressions , with shifted mean and reduced variance .",
    "different panels in figure [ fig_p_eigen ] display plots of these distributions , contrasted with results from the algorithm presented in section [ pdesa ] , where 500,000 mock realizations are considered . in particular , note the symmetry between @xmath70 and @xmath71 . we expect the mean values and variances of those distributions to be : @xmath72 in the various panels , both theoretical and numerical expectations are reported and found to be in excellent agreement .",
    "for example , when @xmath73 , @xmath74 while the expected theoretical value is @xmath75 , and for the variances @xmath76 where the theoretical expectation is @xmath77 .",
    "obviously , to see explicitly the effect of the peak constraint , one needs to make cuts in @xmath78 from the partial conditional distributions @xmath79 , since @xmath80 .",
    "in particular , expressions for @xmath81 can be derived from ( [ zeta1][zeta3 ] ) via substitution of variables and integration over @xmath44 .",
    "for example , it is straightforward to obtain an analytic formula for @xmath82 . in section [ epd ] , we will return on these issues in more detail , in connection with the conditional ellipticity and prolateness for dark matter halos .",
    "[ top ] , @xmath83 [ middle ] , and @xmath71 [ bottom ] of the initial shear field in the peak / dip picture .",
    "solid curves are equations ( [ zeta1 ] ) , ( [ zeta2 ] ) , ( [ zeta3 ] ) , while histograms are obtained from 500,000 mock realizations via the algorithm described in section [ pdesa ] .",
    "each panel displays the numerical and theoretical expectations for the mean values and variances of these distributions ; their agreement is excellent.,title=\"fig:\",scaledwidth=100.0% ]   [ top ] , @xmath83 [ middle ] , and @xmath71 [ bottom ] of the initial shear field in the peak / dip picture .",
    "solid curves are equations ( [ zeta1 ] ) , ( [ zeta2 ] ) , ( [ zeta3 ] ) , while histograms are obtained from 500,000 mock realizations via the algorithm described in section [ pdesa ] .",
    "each panel displays the numerical and theoretical expectations for the mean values and variances of these distributions ; their agreement is excellent.,title=\"fig:\",scaledwidth=100.0% ]   [ top ] , @xmath83 [ middle ] , and @xmath71 [ bottom ] of the initial shear field in the peak / dip picture .",
    "solid curves are equations ( [ zeta1 ] ) , ( [ zeta2 ] ) , ( [ zeta3 ] ) , while histograms are obtained from 500,000 mock realizations via the algorithm described in section [ pdesa ] .",
    "each panel displays the numerical and theoretical expectations for the mean values and variances of these distributions ; their agreement is excellent.,title=\"fig:\",scaledwidth=100.0% ]    another important distribution is @xmath84 , with @xmath85 being the sum of the constrained eigenvalues , namely the probability distribution of @xmath86 confined in the regions with @xmath87 ( i.e. all positive eigenvalues ) : @xmath88 . \\nonumber\\end{aligned}\\ ] ] this distribution is expected to have mean value @xmath89 it is also easy to see that the maximum of @xmath84 is reached when @xmath90 , and with a more elaborate calculation its variance can be estimated analytically .",
    "the result is : @xmath91 \\simeq 0.31~\\sigma^2_{\\rm t } ( 1-\\gamma^2 ) .",
    "\\label{k1_positive_sig}\\ ] ] figure [ fig_p_k1_positive ] confirms the previous relations , by contrasting equations ( [ k1_positive_eq ] ) , ( [ k1_positive_ave ] ) and ( [ k1_positive_sig ] ) with numerical results from 500,000 realizations from the algorithm presented in section [ pdesa ] .",
    "we find good agreement , and recover correctly the expected mean values and variances of the distributions .",
    "for example , when @xmath92 , we find @xmath93 while the expected theoretical value is @xmath94 , and for the rms values we find @xmath95 where the expected theoretical value is @xmath96 . in the absence of correlations between the potential and density fields ( i.e. when @xmath2 ) , all the previous expressions reduce consistently to the unconditional limit of lee & shandarin ( 1998 ) .    .",
    "solid lines are obtained from equation ( [ k1_positive_eq ] ) , for different values of the correlation parameter @xmath1 , while histograms are drawn from 500,000 realizations via the algorithm described in section [ pdesa ] .",
    "note the excellent agreement between numerical results and theoretical predictions for the corresponding mean and rms values , reported in the various panels .",
    "in addition , solid vertical lines show the expected maximum value of each distribution , while dotted lines represent their corresponding mean value.,scaledwidth=100.0% ]      an important quantity which plays a major role in peaks theory ( bardeen et al .",
    "1986 ) is the distribution of peak heights , namely @xmath97 , where @xmath98 and the overdensity @xmath39 is the trace of the shear tensor  defined in section [ jde ] .",
    "one can easily obtain a simplified analytic expression for this distribution as follows .",
    "first , normalize equation ( [ eigen_doro_ext ] ) by @xmath6 , defining @xmath99 and @xmath100 , so that @xmath101 . in this framework",
    ", @xmath102 is the peak curvature of bardeen et al .",
    "( 1986 ) if gaussian filters are used for computing the moments of the smoothed power spectrum ( equation [ eq_sig ] ) .",
    "since @xmath103 is simply a gaussian with mean zero and variance @xmath59  see rossi ( 2012 )  and because of equation ( [ eigen_doro_ext ] ) , then clearly @xmath104 is also gaussian , with mean @xmath105 and reduced variance @xmath59 .",
    "note in fact that @xmath106 is a bivariate gaussian , because both @xmath107 and @xmath102 are normally distributed random variates .",
    "this implies that @xmath108 , and clearly @xmath109 ( bardeen et al .",
    "1986 )  where @xmath110 according to equation ( 21 ) of lee & shandarin ( 1998 ) . starting from a bivariate gaussian with the previous expected mean value ,",
    "it is then direct to derive a fairly good approximation for the distribution of peak heights , namely @xmath111   \\big [ 1 + { \\rm erf } \\big ( { \\gamma ( \\nu-\\chi ) \\over \\sqrt{2 ( 1-\\gamma^2 ) } }    \\big ) \\big ] \\ ] ] where @xmath112 \\gamma \\simeq 0.86 \\gamma.\\ ] ]    in essence , @xmath113 is a gaussian with shifted mean modulated by the role of the peak curvature , and it consistently reduces to a zero - mean unit - variance gaussian distribution when @xmath2  as expected .",
    "additionally , the previous distribution can be shown to be equivalent to @xmath114 $ ] , where the term in square brackets quantifies the effect of the peak constrain  and so the scale at which the difference between peaks and random positions would appear .",
    "figure [ fig_peak_heights ] shows plots of @xmath113 for different values of @xmath1 . in the various panels , vertical lines",
    "are the expected mean values ; we find good agreement between numerical estimates and theoretical expectations .",
    "for example , when @xmath92 , @xmath115 while @xmath116 .",
    "solid curves in the figure are drawn from equation ( [ eq_peak_heights_proxy ] ) , an approximation which is particularly good for lower values of the correlation strength .    ) , for different values of the correlation parameter @xmath1  as specified in the various panels .",
    "the numerical values for the mean of the distribution as a function of @xmath1 are indicated in each panel , and also marked with vertical lines ; they are in good agreement with theoretical expectations .",
    "solid curves are drawn from equation ( [ eq_peak_heights_proxy]).,scaledwidth=75.0% ]",
    "the theoretical framework outlined in section [ jde ] , along with the algebra leading to the new computational procedure presented in section [ pdesa ] , provides a natural way to include the peak / dip constraint into the initial shape distributions of halos and voids .",
    "this is a key aspect for implementing an excursion set algorithm for peaks and dips in gaussian random fields ( which will be discussed in section [ esmpd ] ) , and has direct applications in the context of triaxial models of structure formation . in particular",
    ", our description combines the formalism of bardeen et al .",
    "( 1986 )  based on the density field  with that of bond & myers ( 1996 )  focused on the shear field .    in",
    "what follows , first we introduce some useful definitions regarding shape parameters ( ellipticity and prolateness ) ; we then provide a new expression for the joint conditional distribution of halo shapes given the density peak constraint , derived from equation ( [ doro_eigen ] ) , which generalizes some previous literature work .",
    "the formula has important implications for the modeling of non - spherical dark matter halos , in relation to their initial shape distribution .",
    "finally , we briefly discuss how the shear ellipticity and prolateness ( and so the initial halo shapes ) are modified by the inclusion of the density peak condition .",
    "our analysis is based on the constrained eigenvalues of the initial shear field ( equations [ doro_eigen]19 ) , and we use the new algorithm to support our description . while here we only consider the case for dark matter halos , it is straightforward to deal with voids . in a forthcoming companion publication , we will present a more detailed study on the morphology of both halos and voids in the peak / dip picture , where we also investigate the modifications induced by primordial non - gaussianity on their shapes ( see also section [ conc ] ) .      in triaxial models of halo formation , such as the ellipsoidal collapse ( icke 1973 ; white & silk 1979 ; barrow & silk 198 ; kuhlman et al .",
    "1996 ; bond & myers 1996 ) , it is customary to characterize the shape of a region by its ellipticity and prolateness . in particular , in the ` peak - patch ' approach of bond & myers ( 1996 ) , the shape parameters are associated with the eigenvalues of the shear field ( @xmath117 in our notation ) .",
    "considering the mapping ( @xmath118 ) , where the subscript @xmath10 refers to the tidal tensor , we can write : @xmath119 where @xmath120 and @xmath121 are the ` unconditional ' shear ellipticity and prolateness .",
    "in particular , if @xmath122 then @xmath123 and therefore @xmath124 .    in the ` peaks theory ' of bardeen et al .",
    "( 1986 ) , instead , ellipticity ( @xmath125 ) and prolateness ( @xmath126 ) are associated with the eigenvalues of the density field ( @xmath78 in our notation ) .",
    "hence , given the mapping ( @xmath127 ) where now the subscript @xmath11 refers to the hessian of the density field , one has : @xmath128 as in the previous case , if @xmath129 then @xmath130 and @xmath131 .",
    "it is therefore natural to consider the ` conditional ' mapping ( @xmath132 ) and define : @xmath133 where @xmath27 are the constrained shear eigenvalues  given by equation ( 19 ) .",
    "in what follows , we will refer to @xmath134 and @xmath135 as to the conditional shear ellipticity and prolateness , respectively ; we will also relate these quantities to the unconditional expressions previously introduced , involving ( @xmath136 ) and ( @xmath137 ) .      combining ( [ eq_dep_t ] ) with doroshkevich s formula ( [ doro_original ] ) , it is straightforward to derive the ` unconditional ' distribution of @xmath120 and @xmath121 given @xmath39 , @xmath138 , related to the gravitational potential . in particular , @xmath139 where @xmath140 is simply a gaussian with zero mean and variance @xmath141 , and @xmath142 .",
    "\\label{gep_uncond_bis}\\ ] ] equation ( [ gep_uncond ] ) implies that the unconditional joint distribution of shear ellipticity and prolateness is independent of that of the overdensity @xmath39 .",
    "similarly , inserting ( [ eq_dep_h ] ) in doroshkevich s formula ( [ doro_original_bis ] ) , one obtains @xmath143 for the quantities related to the density hessian , where @xmath144 is a gaussian with zero mean and variance @xmath145 , while @xmath146.\\ ] ]    along the same lines , combining ( [ eq_dep_t_given_h ] ) with ( [ doro_eigen ] ) and using the definitions introduced in the previous section , it is direct to obtain @xmath147 where @xmath148 is a gaussian distribution with mean zero and variance @xmath149  i.e. equation ( 57 ) in rossi ( 2012 )  and @xmath150 .",
    "\\label{eq_epc}\\ ] ] the previous expression ( [ eq_epc ] ) is the joint conditional distribution of shear ellipticity and prolateness , given @xmath86 and a correlation strength @xmath1 with the density field .",
    "clearly , @xmath151 is also independent of the distribution of @xmath152 .",
    "equation ( [ eq_epc ] ) generalizes the standard joint distribution of halo shape parameters to include the peak constraint , and is another main result of this paper .",
    "note that , in the absence of correlation ( i.e. when @xmath2 ) , @xmath153 , @xmath154 , @xmath155 , so that ( [ eq_epc ] ) reduces consistently to the ` unconditional ' doroshkevich s limit ( [ gep_uncond_bis ] ) .    from this joint conditional probability function ,",
    "it is possible to derive the partial conditional distributions for the shear ellipticity and prolateness given the peak constrain ( which we will discuss next ) , and their expressions at density peak locations , when the condition @xmath44 is satisfied .",
    "distribution of @xmath156 , for different values of the correlation strength @xmath1  as indicated in the panels .",
    "its shape is directly related to the shear conditional ellipticity in the peak / dip picture  see equation ( [ eq_ed_cond ] ) .",
    "[ bottom ] distribution of @xmath157 , for different values of the correlation strength @xmath1 .",
    "this distribution is instead related to the shear conditional prolateness in the peak / dip picture  see equation ( [ eq_pd_cond ] ) .",
    "the numerical values for the mean and variance of the distributions , as a function of @xmath1 , are also indicated in the figures . in both cases ,",
    "solid curves are obtained via numerical integrations starting from the joint conditional distribution of eigenvalues ( [ doro_eigen ] ) .",
    "histograms are drawn from 500,000 realizations , using the algorithm described in section [ pdesa].,title=\"fig:\",scaledwidth=100.0% ]   distribution of @xmath156 , for different values of the correlation strength @xmath1  as indicated in the panels .",
    "its shape is directly related to the shear conditional ellipticity in the peak / dip picture  see equation ( [ eq_ed_cond ] ) .",
    "[ bottom ] distribution of @xmath157 , for different values of the correlation strength @xmath1 .",
    "this distribution is instead related to the shear conditional prolateness in the peak / dip picture  see equation ( [ eq_pd_cond ] ) .",
    "the numerical values for the mean and variance of the distributions , as a function of @xmath1 , are also indicated in the figures . in both cases ,",
    "solid curves are obtained via numerical integrations starting from the joint conditional distribution of eigenvalues ( [ doro_eigen ] ) .",
    "histograms are drawn from 500,000 realizations , using the algorithm described in section [ pdesa].,title=\"fig:\",scaledwidth=100.0% ]     [ top ] and @xmath158 [ bottom ] for different values of the correlation strength @xmath1 . in both figures ,",
    "histograms are drawn from 500,000 realizations using the algorithm described in section [ pdesa ] , while solid curves are obtained via numerical integrations of the joint conditional distribution of eigenvalues ( [ doro_eigen ] ) . in the various panels ,",
    "we also provide the numerical values for the mean and variance of the distributions , as a function of @xmath1 .",
    "in particular , their mean values at @xmath2 allow one to quantify the shift in the mean of the shear ellipticity and prolateness caused by the peak constraint.,title=\"fig:\",scaledwidth=100.0% ]   [ top ] and @xmath158 [ bottom ] for different values of the correlation strength @xmath1 .",
    "in both figures , histograms are drawn from 500,000 realizations using the algorithm described in section [ pdesa ] , while solid curves are obtained via numerical integrations of the joint conditional distribution of eigenvalues ( [ doro_eigen ] ) . in the various panels ,",
    "we also provide the numerical values for the mean and variance of the distributions , as a function of @xmath1 . in particular , their mean values at @xmath2 allow one to quantify the shift in the mean of the shear ellipticity and prolateness caused by the peak constraint.,title=\"fig:\",scaledwidth=100.0% ]      we can readily express the conditional distributions of shear ellipticity and prolateness in the peak / dip picture in terms of the unconditional quantities ( [ eq_dep_t ] ) and ( [ eq_dep_h ] ) .",
    "this is done simply by recalling that the constrained shear eigenvalues are given by @xmath159 , according to equation ( 19 ) .",
    "it is then direct to obtain : @xmath160 the previous relation implies that , for a given @xmath86 , the conditional shear ellipticity will have its mean value shifted by the presence of the peak constraint ; the entity of the shift has to be ascribed to the additional factor @xmath161 , which is given by the density ellipticity ( essentially , the latter term quantifies the role of the peak curvature ) .",
    "the top panel of figure [ fig_cep ] shows the distribution of @xmath156 for different values of the correlation strength @xmath1 , namely the combination of constrained shear eigenvalues which controls the conditional ellipticity  according to equation ( [ eq_ed_cond ] ) .",
    "histograms are drawn from 500,000 realizations using the algorithm described in section [ pdesa ] , while solid curves are obtained via numerical integration  starting from the joint conditional distribution of eigenvalues ( [ doro_eigen ] ) .",
    "in the various panels , we also provide the numerical values for the mean and variance of the distribution , as a function of @xmath1 .    similarly , @xmath162 this expression shows that the conditional shear prolateness can be obtained from the conditional shear ellipticity ( [ eq_ed_cond ] ) and the combination ( @xmath163 ) of the constrained shear eigenvalues .",
    "the bottom panel of figure [ fig_cep ] displays the distribution of @xmath157 , for different values of the correlation strength @xmath1 .",
    "again , solid curves are derived from a numerical integration of equation ( [ doro_eigen ] ) .    of particular interest",
    "are also the distributions @xmath164 and @xmath165 , which will provide the initial triaxial shapes of dark matter halos at peak locations .",
    "they are related to the previous expressions , and can be readily obtained within the outlined formalism ; clearly , they will reduce to the standard ( or unconditional ) shear ellipticity and prolateness when @xmath2 , in the absence of correlation .",
    "we will present a dedicated study focused on the morphology of halos and voids in the peak / dip picture , where we characterize in detail those distributions , especially in relation to the ellipsoidal collapse model .",
    "we anticipate here that several analytic and insightful results on their shapes can be derived , starting from ( [ eq_epc ] ) and using ( [ doro_eigen ] ) , ( [ eq_ed_cond ] ) and ( [ eq_pd_cond ] ) .",
    "for example , according to ( [ eq_ed_cond ] ) , when @xmath166 ( which is equivalent to impose the condition @xmath167 on an ordered set of density hessian eigenvalues ) , then the quantity @xmath168 will essentially provide by how much the mean value of the shear ellipticity has been shifted by the peak constrain .",
    "for the prolateness the situation is slightly more complicated , but according to ( [ eq_pd_cond ] ) the shift can be derived by the additional knowledge of @xmath169 . to this end ,",
    "figure [ fig_cep_pos ] shows the distributions of @xmath170 and @xmath171 , for different values of the correlation strength @xmath1 ( note that the quantities just discussed are their mean values when @xmath2 ) . as in the previous plot ,",
    "histograms are drawn from 500,000 realizations using the algorithm described in section [ pdesa ] , while solid curves are obtained via numerical integrations  starting from the joint conditional distribution of eigenvalues ( [ doro_eigen ] ) .",
    "in the various panels , we also provide the numerical values for the mean and variance of the distribution , as a function of @xmath1 .    as mentioned before",
    ", we will return in more detail on these distributions in a companion publication , to quantify the impact of the peak constrain on their shapes .",
    "we will also make the connection with the work of bardeen et al .",
    "( 1986 ) more explicit  see their appendix c. it will be also interesting to include the role of the peculiar gravity field in our description , along the lines of van de weygaert & bertschinger ( 1996 ) , as well as to extend the work of desjacques ( 2008 ) on the joint statistics of the shear tensor and on the dynamical aspect of the environmental dependence , within this formalism .",
    "the ability to distinguish between random positions and peaks / dips , contained in equations ( [ doro_inter_extended ] ) or ( [ doro_eigen ] ) and achieved by the algorithm presented in section [ pdesa ] , is the key to implement an excursion set model for peaks and dips in gaussian random fields . indeed , the primary motivation ( and one of the main strengths ) of the proposed sampling procedure resides in its direct inclusion into the excursion set framework ( epstein 1983 ; peacock & heavens 1990 ; bond et al .",
    "1991 ; lacey & cole 1993 ) .",
    "in essence , because in our formalism the peak overdensity is simply the trace of the conditional shear tensor ( recall the definitions in section [ jde ] ) , and since in triaxial models of collapse the initial shape parameters are just combinations of the shear eigenvalues ( bond & myers 1996 ) , our prescription provides a direct way to generate the distribution of initial overdensities under the conditions that they are peaks / dips ( i.e. the distribution of peak heights , when @xmath44 )  along with the corresponding conditional distribution of initial shapes ( see section [ epd ] ) . in this respect , it is then straightforward to include this part in standard excursion set algorithms , as those used for example in chiueh & lee ( 2001 ) , sheth & tormen ( 2002 ) or sandvik et al .",
    "( 2007 ) to compute the mass function , or in rossi , sheth & tormen ( 2011 ) to describe halo shapes ; the ` peak / dip excursion - set - based ' algorithm is also useful for computing the halo bias assuming triaxial models of structure formation ( i.e. ellipsoidal collapse ) .",
    "the only main conceptual difference is the pre - selection of peak / dip locations , instead of random positions in the field .",
    "the mass scale of the peak will then be fixed by finding the proper @xmath6 which satisfies the combination of @xmath172 , assuming some structure formation models  as for example the ellipsoidal collapse .",
    "this is particularly useful because the excursion set theory is a powerful tool for understanding various aspects of the full dynamical complexity of halo formation .",
    "perturbations are assumed to evolve stochastically with the smoothing scale , and the problem of computing the probability of halo formation is mapped into the classical first - passage time problem in the presence of a barrier .",
    "a very elegant reformulation of this theory has been recently proposed by maggiore & riotto ( 2010a , b , c ) , who made several technical and conceptual improvements ( i.e. no ad hoc absorbing barrier boundary conditions , account for non - markovianity induced by filtering , unambiguous mass association to a smoothed scale , etc . ) by deriving the original excursion set theory from a path integral formulation  following a microscopical approach .",
    "these authors also noted that the failure of the standard excursion set approach may be related to the inadequacy of the oversimplified physical model adopted for halo formation ( either spherical or ellipsoidal ) , and propose to treat the critical threshold for collapse as a stochastic variable which better captures some of the dynamical complexity of the halo formation phenomenon .",
    "even so , they find that the non - markovian contributions do not alleviate the discrepancy between excursion set predictions and @xmath0-body simulations .",
    "in addition to the problems pointed out by maggiore & riotto ( 2010a , b , c ) , there is also the fact that  in its standard formulation  the excursion set approach is unable to differentiate between peaks / dips and random locations in space  i.e. all points are treated equally . however , since local extrema are plausible sites for the formation of nonlinear structures and there is a good correspondence between peaks in the initial conditions and halos at late times , it may be important to differentiate between those special positions in space .",
    "the algorithm proposed here goes in this direction , since it allows one to pre - select those special points in space around which halos form ( peaks ) , and not just random locations  and permits to associate their corresponding initial shape distribution : in essence , the computational procedure selects a special subset , among all the possible random walks considered in the standard excursion set procedure .",
    "therefore , the ` peak / dip excursion - based ' algorithm can be used to study the mass function of halos and their triaxial shapes at peak / dip positions , and also the halo bias .",
    "in fact , our prescription allows one to generate the initial distributions of overdensity , ellipticity and prolateness ( i.e. shape parameters ) at a scale set by the variance @xmath6 , with the constraint that @xmath39 is a peak ( i.e. the condition @xmath44 on the hessian ) .",
    "one can then just evolve this initial conditional shape distribution by solving a dynamical equation of collapse , and study the final shape distribution ( as done for example in rossi , sheth & tormen 2011 ) but now at peak / dip locations .",
    "alternatively , one can adopt a ` crossing threshold ' , since in the excursion set approach an halo is formed when the smoothed density perturbation reaches a critical value for the first time , and the problem is reduced to a first - passage problem in the presence of a barrier ( i.e. if the overdensity exceeds a critical value , the random walk stops at this scale ; if not , the walk continues to smaller scales ) .",
    "moreover , our numerical technique can be easily integrated in montecarlo realizations of the trajectories obtained from a langevin equation with colored noise ( i.e. bond et al .",
    "1991 ; robertson et al .",
    "2009 ) at peak / dip locations , and even for situations where the walks are correlated  in presence of non - markovian effects , along the lines of de simone et al .",
    "( 2011a , b ) . in this respect ,",
    "our technique is general , since any kind of filter function can be readily implemented .",
    "all these lines of research are ongoing efforts , and will be presented in several forthcoming publications .",
    "from the joint conditional probability distribution of an ordered set of shear eigenvalues in the peak / dip picture ( rossi 2012 ; section [ jde ] , equations [ doro_inter_extended ] and [ doro_eigen ] ) , we derived a new algorithm to sample the constrained eigenvalues of the initial shear field associated with gaussian statistics at peak / dips positions in the correlated density field .",
    "the algorithm , described in section [ pdesa ] , was then used to test and confirm several formulas presented in rossi ( 2012 ) regarding conditional distributions and probabilities , subjected to the extremum constraint ( section [ cdpnt ] ) .",
    "we found excellent agreement between numerical results and theoretical predictions ( figures [ fig_p_eigen ] and [ fig_p_k1_positive ] ) .",
    "in addition , we also showed how the standard distributions of shear ellipticity and prolateness in triaxial models of structure formation are modified by the constraint ( section [ epd ] ; figures [ fig_cep ] and [ fig_cep_pos ] ) , and provided a new expression for the conditional distribution of shape parameters given the density peak requirement ( equation [ eq_epc ] ) , which generalizes some previous literature work .",
    "the formula has important implications for the modeling of non - spherical dark matter halo shapes , in relation to their initial shape distribution , and is directly applicable to the ellipsoidal collapse model ( icke 1973 ; white & silk 1979 ; barrow & silk 1981 ; kuhlman et al .",
    "1996 ; bond & myers 1996 ) . in particular , our novel description is able to combine consistently , for the first time , the formalism of bardeen et al .",
    "( 1986 )  based on the density field  with that of bond & myers ( 1996 )  based on the shear field . along the way , we also discussed the distribution of peak heights ( see figure [ fig_peak_heights ] ) , which plays a major role in peaks theory ( bardeen et al .",
    "1986 ) .    while the primary motivation of this paper was to illustrate the new ` peak / dip excursion - set - based ' algorithm , and to show a few applications focused on the morphology of the cosmic web ( following up , and complementing with some more insights , the theoretical work presented in rossi 2012 ) , the other goal was to describe how the new sampling procedure naturally integrates into the standard excursion set framework ( epstein 1983 ; peacock & heavens 1990 ; bond et al .",
    "1991 ; lacey & cole 1993 )  potentially solving some of its well - known problems .",
    "in particular , in section [ esmpd ] we argued that the ability to distinguish between random positions and peaks / dips , encoded in the algorithm and in equations ( [ doro_inter_extended ] ) and ( [ doro_eigen ] ) derived from first principles , is indeed the key to implement a generalized excursion set model for peaks and dips in gaussian random fields .",
    "this is the actual strength of the proposed computational procedure , since part of the failure of the original excursion set theory may be attributed to its inability to differentiate between random positions and special points ( peaks ) in space around which halos may form .    to this end ,",
    "our simple prescription can be used to study the halo mass function , halo / void shapes and bias at peak / dip density locations , in conjunction with triaxial models of structure formation .",
    "all these research lines are ongoing efforts , subjects of several forthcoming publications .",
    "the essential part is the characterization of the distribution of peak heights , and of the initial shape distribution at peak / dip locations ( equations [ doro_inter_extended ] , [ doro_eigen ] , and [ eq_epc ] ) .",
    "the algorithm presented in this paper offers also a much broader spectrum of applications .",
    "this is because , as pointed out by rossi ( 2012 ) , the fact that the eigenvalues of the hessian matrix can be used to discriminate between different types of structures in a particle distribution is fundamental to a number of structure - finding algorithms , shape - finders algorithms , and structure reconstruction on the basis of tessellations . for example , it can be used for studying the dynamics and morphology of cosmic voids ",
    "see for example van de weygaert & platen ( 2011 ) , bos et al .",
    "( 2012 ) , pan et al .",
    "( 2012 ) , and the monge - ampre - kantorovitch reconstruction procedure by lavaux & wandelt ( 2010 )  and in several observationally - oriented applications , in particular for developing algorithms to find and classify structures in the cosmic web or in relation to its skeleton ( sahni et al . 1998 ; schaap & van de weygaert 2000 ; novikov et al . 2006",
    "; hahn et al . 2007 ; romano - diaz & van de weygaert 2007 ; forero - romero et al . 2009 ; zhang et al .",
    "2009 ; lee & springel 2010 ; aragn - calvo et al .",
    "2010a , b ; platen et al .",
    "2011 ; cautun et al .",
    "2012 ; hidding et al .",
    "another application is related to the work of bond , strauss & cen ( 2010 ) , who presented an algorithm that uses the eigenvectors of the hessian matrix of the smoothed galaxy distribution to identify individual filamentary structures .",
    "in addition , since galaxy clusters are related to primordial density peaks , and there is a correspondence between structures in the evolved density field and local properties of the linear tidal shear , our theoretical framework provides a direct way to relate initial conditions and observables from galaxy clusters .",
    "other intriguing connections involve topological studies of the cosmic web , the genus statistics and minkowski functionals ( gott et al . 1986 , 1989 ; park et al . 1991 , 2005 ; matsubara 2010 ) , and the possibility to address open questions regarding the origin of angular momentum and halo spin within this framework ; this is because the dependence of the spin alignment on the morphology of the large - scale mass distribution is due to the difference in shape of the tidal fields in different environments , and most of the halo properties depend significantly on environment , and in particular on the tidal field  i.e. the environmental dependence of halo assembly time and unbound substructure fraction has its origin from the tidal field ( wang et al .",
    ". it will be also interesting to explore how the new formalism proposed here can be used to study halo spin , shape and the orbital angular momentum of subhaloes relative to the lss , in the context of the eigenvectors of the velocity shear tensor ( see the recent study by libeskind et al . 2013 ) .",
    "in addition , the more complex question of the local expected density field alignment / orientation distribution as a function of the local field value ( bond 1987 ; lee & pen 2002 ; porciani et al . 2002 ; lee , hahn & porciani 2009 ; lee 2011 ) can be addressed within this framework , and is the subject of future studies .    on the theoretical side",
    ", we note that our algorithm is restricted to one scale ( i.e. peaks and dips in the density field , as in bardeen et al .",
    "1986 ) , but the extension to a multiscale _ peak - patch _ approach along the lines of bond & myers ( 1996 ) is doable and subject of ongoing work . as argued in rossi ( 2012 ) , this will allow to account for the role of the peculiar gravity field itself , an important aspect not considered in our formalism but discussed in detail in van de weygaert & bertschinger ( 1996 ) . including all these effects in our framework and translating them into a more elaborated algorithm is ongoing effort , and will allow us to make the connection with the multiscale analysis of the hessian matrix of the density field by van de weygaert & bertschinger ( 1996 ) and aragn - calvo et al .",
    "( 2007 ; 2010a , b )",
    ". it will also allow us to incorporate the distortion effect of the peculiar gravity field in our initial distribution of halo / void shapes ( section [ epd ] ) .",
    "the natural extension of the peak / dip picture for the initial shear to non - gaussian fields is also ongoing effort , along with some other broader applications in the context of the excursion set model  for example in relation to the hot and cold spots in the cosmic microwave background , including the effects of @xmath173-type non - gaussianity on their shapes ( i.e. rossi , chingangbam & park 2011 )  which will be presented in forthcoming publications .",
    "the final stage of this work was completed during the ` apctp - ieu focus program on cosmology and fundamental physics iii ' ( june 11 - 22 , 2012 ) at postech , in pohang , korea .",
    "i would like to thank the organizers of the workshop , and in particular changrim ahn .",
    "also , many thanks to changbom park for a careful reading of the manuscript , and for many interesting discussions , suggestions and encouragement .    99    angulo , r.  e. , springel , v. , white , s.  d.  m. , et al .",
    "2012 , mnras , 426 , 2046 aragn - calvo , m.  a. , platen , e. , van de weygaert , r. , & szalay , a.  s.  2010 , apj , 723 , 364 aragn - calvo , m.  a. , van de weygaert , r. , & jones , b.  j.  t.  2010 , mnras , 408 , 2163 aragn - calvo , m.  a. , jones , b.  j.  t. , van de weygaert , r. , & van der hulst , j.  m.  2007 , a@xmath174a , 474 , 315 argyres , p.  c. , groth , e.  j. , peebles , p.  j.  e. , & struble , m.  f.  1986 , aj , 91 , 471 bardeen , j.  m. , bond , j.  r. , kaiser , n. , & szalay , a.  s.  1986 , apj , 304 , 15 barrow , j.  d. , & silk , j.  1981 , apj , 250 , 432 bertschinger , e.  1987 , apj , 323 , l103 bond , n.  a. , strauss , m.  a. , & cen , r.  2010 , mnras , 409 , 156 bond , j.  r. , kofman , l. , & pogosyan , d.  1996 , nature , 380 , 603 bond , j.  r. , & myers , s.  t.  1996 , apjs , 103 , 1 bond , j.  r. , cole , s. , efstathiou , g. , & kaiser , n.  1991 , apj , 379 , 440 bond , j.  r.  1987 , nearly normal galaxies .  from the planck time to the present , 388 - 397 , ed .",
    "s.  m.  faber , springer - verlag bos , e.  g.  p. , van de weygaert , r. , dolag , k. , & pettorino , v.  2012 , arxiv:1205.4238 catelan , p. , kamionkowski , m. , & blandford , r.  d.  2001 , mnras , 320 , l7 cautun , m. , van de weygaert , r. , & jones , b.  j.  t.  2012 , mnras , 402 chiueh , t. , & lee , j.  2001 , apj , 555 , 83 choi , y .- y . , park , c. , kim , j. , et al .",
    "2010 , apjs , 190 , 181 colless , m. , peterson , b.  a. , jackson , c. , et al .  2003 ,",
    "arxiv : astro - ph/0306581 de simone , a. , maggiore , m. , & riotto , a.  2011 , mnras , 412 , 2587 de simone , a. , maggiore , m. , & riotto , a.  2011 , mnras , 418 , 2403 doroshkevich , a.  g.  1970 , astrofizika , 6 , 581 desjacques , v.  2008 , mnras , 388 , 638 doroshkevich , a.  g. , & zeldovich , y.  b.  1964 , soviet  ast . , 7 , 615 doroshkevich , a.  g. , & shandarin , s.  f.  1978 , soviet  ast . ,",
    "22 , 653 dubinski , j.  1992 , apj , 401 , 441 epstein , r.  i.  1983 , mnras , 205 , 207 faltenbacher , a. , li , c. , white , s.  d.  m. , et al .  2009 , research in astronomy and astrophysics , 9 , 41 forero - romero , j.  e. , hoffman , y. , gottlber , s. , klypin , a. , & yepes , g.  2009 , mnras , 396 , 1815 gott , j.  r. , iii , miller , j. , thuan , t.  x. , et al .",
    "1989 , apj , 340 , 625 gott , j.  r. , iii , dickinson , m. , & melott , a.  l.  1986 , apj , 306 , 341 hahn , o. , carollo , c.  m. , porciani , c. , & dekel , a.  2007 , mnras , 381 , 41 hidding , j. , van de weygaert , r. , vegter , g. , jones , b.  j.  t. , & teillaud , m.  2012 , arxiv:1205.1669 huchra , j. , martimbeau , n. , jarrett , t. , et al .",
    "2005 , maps of the cosmos , 216 , 170 icke , v.  1973 , a@xmath174a , 27 , 1 kaiser , n.  1986 , mnras , 222 , 323 kim , j. , park , c. , rossi , g. , lee , s.  m. , & gott , j.  r. , iii 2011 , journal of korean astronomical society , 44 , 217 kuhlman , b. , melott , a.  l. , & shandarin , s.  f.  1996 , apj , 470 , l41 lacey , c. , & cole , s.  1993 , mnras , 262 , 627 lavaux , g. , & wandelt , b.  d.  2010 , mnras , 403 , 1392 lee , j.  2011 , apj , 732 , 99 lee , j. , & springel , v.  2010 , journal of cosmology and astroparticle physics , 5 , 31 lee , j. , hahn , o. , & porciani , c.  2009 , apj , 705 , 1469 lee , j. , & park , d.  2006 , apj , 652 , 1 lee , j. , & pen , u .- l .  2002 , apj , 567 , l111 lee , j. , & shandarin , s.  f.  1998 , apj , 500 , 14 libeskind , n.  i. , hoffman , y. , forero - romero , j. , et al .",
    "2013 , mnras , 428 , 2489 ludlow , a.  d. , & porciani , c.  2011 , mnras , 413 , 1961 maggiore , m. , & riotto , a.  2010 , apj , 711 , 907 maggiore , m. , & riotto , a.  2010 , apj , 717 , 515 maggiore , m. , & riotto , a.  2010 , apj , 717 , 526 matsubara , t.  2010 , phys .",
    "d , 81 , 083505 novikov , d. , colombi , s. , & dor , o.  2006 , mnras , 366 , 1201 pan , d.  c. , vogeley , m.  s. , hoyle , f. , choi , y .- y .",
    ", & park , c.  2012 , mnras , 421 , 926 park , c. , choi , y .- y .",
    ", vogeley , m.  s. , et al .",
    "2005 , apj , 633 , 11 park , c. , gott , j.  r. , iii , melott , a.  l. , & karachentsev , i.  d.  1992 , apj , 387 , 1 park , c. , & gott , j.  r. , iii 1991 , apj , 378 , 457 peacock , j.  a. , & heavens , a.  f.  1990 , mnras , 243 , 133 peebles , p.  j.  e.  1980 , research supported by the national science foundation .",
    "princeton , n.j . , princeton university press , 1980 .",
    "435 p. platen , e. , van de weygaert , r. , jones , b.  j.  t. , vegter , g. , & calvo , m.  a.  a.  2011 , mnras , 416 , 2494 platen , e. , van de weygaert , r. , & jones , b.  j.  t.  2008 , mnras , 387 , 128 pogosyan , d. , pichon , c. , gay , c. , prunet , s. , cardoso , j.  f. , sousbie , t. , & colombi , s.  2009 , mnras , 396 , 635 porciani , c. , dekel , a. , & hoffman , y.  2002 , mnras , 332 , 339 robertson , b.  e. , kravtsov , a.  v. , tinker , j. , & zentner , a.  r.  2009 , apj , 696 , 636 romano - daz , e. , & van de weygaert , r.  2007 , mnras , 382 , 2 rossi , g.  2012 , mnras , 421 , 296 rossi , g. , sheth , r.  k. , & tormen , g.  2011 , mnras , 416 , 248 rossi , g. , chingangbam , p. , & park , c.  2011 , mnras , 411 , 1880 shandarin , s. , habib , s. , & heitmann , k.  2010 , phys .  rev .",
    "d , 81 , 103006 shandarin , s. , feldman , h.  a. , heitmann , k. , & habib , s.  2006 , mnras , 367 , 1629 sheth , r.  k. , & tormen , g.  2002 , mnras , 329 , 61 sahni , v. , sathyaprakash , b.  s. , & shandarin , s.  f.  1998 , apj , 495 , l5 sandvik , h.  b. , mller , o. , lee , j. , & white , s.  d.  m.  2007 , mnras , 377 , 234 schaap , w.  e. , & van de weygaert , r.  2000 , a@xmath174a , 363 , l29 shen , j. , abel , t. , mo , h.  j. , & sheth , r.  k.  2006 , apj , 645 , 783 springel , v. , et al .",
    "2005 , nature , 435 , 629 sunyaev , r.  a. , & zeldovich , y.  b.  1972 , comments on astrophysics and space physics , 4 , 173 tegmark , m. , blanton , m.  r. , strauss , m.  a. , et al .",
    "2004 , apj , 606 , 702 van de weygaert , r. , pranav , p. , jones , b.  j.  t. , et al .  2011 , arxiv:1110.5528 van de weygaert , r. , & platen , e.  2011 , international journal of modern physics conference series , 1 , 41 van de weygaert , r. , & bond , j.  r.  2008 , a pan - chromatic view of clusters of galaxies and the large - scale structure , 740 , 335 van de weygaert , r. , & bertschinger , e.  1996 , mnras , 281 , 84 wang , h. , mo , h.  j. , jing , y.  p. , yang , x. , & wang , y.  2011 , mnras , 413 , 1973 west , m.  j.  1989 , apj , 347 , 610 weyl h. , 1948 , the classical groups : their invariants and representations ( princeton : princeton university press ) white , s.  d.  m.  1984 , apj , 286 , 38 white , s.  d.  m. , & silk , j.  1979 , apj , 231 , 1 zeldovich , y.  b.  1970 , a@xmath174a , 5 , 84 zhang , y. , yang , x. , faltenbacher , a. , et al .",
    "2009 , apj , 706 , 747",
    "[ notation ]    we summarize here the basic notation adopted in the paper , which is essentially the same as the one introduced by rossi ( 2012 )  with a few minor changes to make the connection with previous literature more explicit . in particular , let @xmath175 denote the displacement field , @xmath176 the potential of the displacement field ( i.e. the gravitational field ) , @xmath177 the source of the displacement field ( i.e. the density field ) . both @xmath177 and @xmath176",
    "are gaussian random fields , the latter specified by the matter power spectrum @xmath178 , with @xmath179 denoting the wave number and @xmath180 the smoothing kernel .",
    "use @xmath181 for the shear tensor",
    "( its eigenvalues are @xmath36 ) , @xmath182 for the hessian matrix of the density @xmath177 ( with eigenvalues @xmath37 ) , @xmath183 for the jacobian of the displacement field , where @xmath184 . indicate with @xmath185 the lagrangian coordinate , with @xmath186 the eulerian coordinate , where @xmath187 .",
    "clearly , @xmath188 the correlations between the shear and density hessian are expressed by : @xmath189    @xmath190    @xmath191    where @xmath192 , @xmath193 , @xmath194 , @xmath195 is the kronecker delta , and @xmath196    @xmath197    in the main text we prefer to use @xmath6 and @xmath7 , rather than the more familiar @xmath8 and @xmath9 , for their intuitive meaning . in particular",
    ", the subscript @xmath10 always indicates that a quantity is related to the shear field , while the subscript @xmath11 denotes a quantity linked to the hessian of the density field .",
    "the shear and density hessian @xmath181 and @xmath182 are real symmetric tensors , so they are specified by 6 components . whenever necessary , we label those components with the symbols @xmath62 or @xmath198 to indicate the various couples , where @xmath199 .",
    "it is also useful to introduce the vectors @xmath14 and @xmath15 , derived from the components of their corresponding tensors , i.e. @xmath12 and @xmath13 .",
    "the constrained eigenvalues of the matrix having components @xmath200 will be indicated with @xmath201 . as shown in rossi ( 2012 ) ,",
    "the covariance matrix of the joint probability distribution of @xmath202 and @xmath203 is simply @xmath204 where @xmath205 with @xmath206 a ( @xmath207 ) identity matrix and @xmath208 a ( @xmath209 ) null matrix . finally , an important ` spectral parameter ' often used here is the ` reduced ' correlation : @xmath210 which plays a crucial role in peaks theory ( i.e. bardeen et al .",
    "1986 ) . if gaussian filters are used in ( [ eq_sig ] ) , then our @xmath1 is the same as the one introduced in bardeen et al .",
    "( 1986 )  specified by their equation ( 4.6a ) .",
    "note that in the main text we also define @xmath211 ; if one adopts reduced variables ( i.e. @xmath212 and @xmath63 normalized by their corresponding rms values @xmath6 and @xmath7 ) , clearly @xmath213 .",
    "the algebra presented in section [ pdesa ] allows one to gain more insights into the joint conditional distribution of eigenvalues in the peak / dip picture ( equation [ doro_inter_extended ] ) . for simplicity , in what follows we consider ` reduced ' variables , so that the various components of @xmath214 and @xmath215 are now normalized by their corresponding rms values ( @xmath6 and @xmath7 , respectively ) . with some abuse of notation ,",
    "we omit the tilde symbol ( used instead in rossi 2012 ) to distinguish between normalized and unnormalized quantities .",
    "it is then possible to characterize and study the properties of the first few elementary symmetric functions of degree @xmath216 for the density hessian , the shear tensor , and the conditional shear tensor  along the lines of weyl ( 1948 ) , doroshkevich ( 1970 ) , sheth & tormen ( 2002 ) and desjacques ( 2008 ) . in particular , it is direct to note that , using equation ( [ h_gauss ] ) and considering six independent gaussian random variates @xmath49 ( @xmath50 ) represented by the six - dimensional vector @xmath217 , one obtains that the first two classical invariants @xmath218 are independent .",
    "this fact implies that @xmath219 hence @xmath19 is the product of two independent distributions , where in particular @xmath220 is a one - dimensional gaussian with mean zero and unity variance .",
    "note also that @xmath221 , where @xmath222 is simply the product of six independent one - dimensional zero mean unit variance gaussians @xmath223 .",
    "similarly , for the shear tensor @xmath14 , one obtains that @xmath224 are also independent , with @xmath53 ( @xmath50 ) other six gaussian random variates represented by the six - dimensional vector @xmath225 .",
    "therefore , @xmath226 with @xmath227 a one - dimensional gaussian distribution .",
    "note again that @xmath228 , where @xmath229 is the product of six independent one - dimensional zero mean unit variance gaussians @xmath223 .",
    "following the previous logic , one would naturally expect that the quantities @xmath230 and @xmath231 , defined in the main text ( see equation [ k_def ] ) , should also be independent .",
    "indeed , it is direct to obtain that ( ravi sheth , private communication ) : @xmath232 \\nonumber \\\\     & = & { ( 1-\\gamma^2 ) \\over 5}~(l_2 ^ 2 + l_3 ^ 2 + l_4 ^ 2 + l_5 ^ 2 + l_6 ^ 2 ) , \\end{aligned}\\ ] ] where @xmath56 ( @xmath50 ) are other six independent gaussian distributed variates with mean zero and unity variance , while @xmath57 ( @xmath50 ) are six gaussian distributed variates with shifted mean @xmath58 and reduced variance @xmath59 , i.e. @xmath60 . hence , the joint conditional distribution of eigenvalues in the peak / dip picture ( equation [ doro_inter_extended ] ) can be written as the product of two independent distributions as follows : @xmath233   } \\over \\sqrt{2 \\pi ( 1-\\gamma^2 ) } } { 15 ^ 3 \\over 8 \\sqrt { 10 } \\pi^{5/2 } } { e^{-5 k_3 ^ 2/[2(1-\\gamma^2 ) ] }     \\over ( 1-\\gamma^2)^{5/2 } } \\equiv p(k_1|\\gamma ) p(k_3|\\gamma ) .",
    "\\label{doro_inter_extended_more}\\ ] ] this latter expression clearly shows that the distribution of constrained @xmath234 is independent of the distribution of the constrained angular momentum @xmath235 , where in particular @xmath236 is a gaussian with zero mean and variance given by @xmath59 , while @xmath237 is a chi - square distribution with five degrees of freedom . once again , note that @xmath238 , where now @xmath239 namely , @xmath240 is now the product of six independent one - dimensional gaussians @xmath241 with shifted mean @xmath58 and reduced variance @xmath59  represented by the six - dimensional vector @xmath242 ."
  ],
  "abstract_text": [
    "<S> we present a new algorithm to sample the constrained eigenvalues of the initial shear field associated with gaussian statistics , called the ` peak / dip excursion - set - based ' algorithm , at positions which correspond to peaks or dips of the correlated density field . </S>",
    "<S> the computational procedure is based on a new formula which extends doroshkevich s unconditional distribution for the eigenvalues of the linear tidal field , to account for the fact that halos and voids may correspond to maxima or minima of the density field . </S>",
    "<S> the ability to differentiate between random positions and special points in space around which halos or voids may form ( i.e. peaks / dips ) , encoded in the new formula and reflected in the algorithm , naturally leads to a straightforward implementation of an excursion set model for peaks and dips in gaussian random fields  one of the key advantages of this sampling procedure . </S>",
    "<S> in addition , it offers novel insights into the statistical description of the cosmic web . as a first physical application </S>",
    "<S> , we show how the standard distributions of shear ellipticity and prolateness in triaxial models of structure formation are modified by the constraint . </S>",
    "<S> in particular , we provide a new expression for the conditional distribution of shape parameters given the density peak constraint , which generalizes some previous literature work . </S>",
    "<S> the formula has important implications for the modeling of non - spherical dark matter halo shapes , in relation to their initial shape distribution . </S>",
    "<S> we also test and confirm our theoretical predictions for the individual distributions of eigenvalues subjected to the extremum constraint , along with other directly related conditional probabilities . </S>",
    "<S> finally , we indicate how the proposed sampling procedure naturally integrates into the standard excursion set model , potentially solving some of its well - known problems , and into the ellipsoidal collapse framework . </S>",
    "<S> several other ongoing applications and extensions , towards the development of algorithms for the morphology and topology of the cosmic web , are discussed at the end .    </S>",
    "<S> [ firstpage ]    methods : analytical  methods : statistical  galaxies : formation  galaxies : halos  cosmology : theory  large - scale structure of universe . </S>"
  ]
}