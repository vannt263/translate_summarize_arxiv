{
  "article_text": [
    "here we present a proof for theorem [ theorem : equivalence ] . for a given function @xmath95 on @xmath12 , define its sampling function at lattice points of @xmath12 by @xmath96 where @xmath97 is the dirac delta function @xmath98 .",
    "let @xmath99 denote the number of primitive cells inside the supercell ( i.e. @xmath42 ) .",
    "note that @xmath100 to see this , observe that @xmath101      now , let @xmath106 . in view of and , @xmath34 is shift - orthogonal if and only if @xmath107 taking fourier transform from both sides , using and using the fact that fourier transform of @xmath108 is @xmath109 yields that @xmath34 is shift - orthogonal if and only if for all @xmath110 , @xmath111    23ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]  + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) ( ,  )  pp .   @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop _ _  ( ,  ) @noop _ _  ( ,  ,  ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( )"
  ],
  "abstract_text": [
    "<S> we propose a method for calculating wannier functions of periodic solids directly from a modified variational principle for the energy , subject to the requirement that the wannier functions are orthogonal to all their translations ( `` shift - orthogonality '' ) . </S>",
    "<S> localization is achieved by adding an @xmath0 regularization term to the energy functional . </S>",
    "<S> this approach results in `` compressed '' wannier modes with compact support , where one parameter @xmath1 controls the trade - off between the accuracy of the total energy and the size of the support of the wannier modes . </S>",
    "<S> efficient algorithms for shift - orthogonalization and solution of the variational minimization problem are demonstrated .    </S>",
    "<S> electronic states in periodic crystals are usually discussed in terms of bloch waves of definite crystal momentum and energy . an alternative description in terms of spatially localized functions </S>",
    "<S> was introduced by gregory wannier @xcite and further developed in @xcite . </S>",
    "<S> these so - called wannier functions are associated with lattice sites , are translational images of each other , and can be chosen to be real and exponentially localized in conventional ( i.e. , topologically trivial ) insulators @xcite . </S>",
    "<S> even though the wannier functions are not the eigenstates of the crystal hamiltonian , they represent a convenient description of the electronic states for understanding such phenomena as electric polarization @xcite , orbital magnetization @xcite , nontrivial insulating states @xcite and range of electronic interactions in condensed matter @xcite . </S>",
    "<S> wannier functions can also be used to increase speed and accuracy of computations . </S>",
    "<S> for instance , they can be used to interpolate the electronic wave functions and band structure throughout the brillouin zone whenever a very large number of @xmath2 points is needed , such as when calculating electron - phonon scattering rates @xcite .    </S>",
    "<S> wannier functions are unitary transformations of bloch waves with different crystal momenta and are usually obtained by optimizing a suitably chosen localization functional . </S>",
    "<S> a particularly successful choice was introduced by marzari and vanderbilt @xcite , in which one minimizes the spread ( second moment ) of the wannier functions , resulting in maximally localized wannier functions ( mlwf ) . due to the non - convexity of the target functional and constraints , </S>",
    "<S> a reasonable initial guess is usually needed to avoid local minima corresponding to poorly localized , complex wannier functions @xcite .    </S>",
    "<S> it is well understood that for insulators wannier functions satisfy the minimum principle for the total energy subject to the constraint of orthogonality to all their translations by lattice vectors ; we refer to this as shift - orthogonality . </S>",
    "<S> the corresponding variational principle was formulated by koster @xcite and used by kohn @xcite in his variational wannier function approach , but it has been seldom used in practice with general bases @xcite .    in this paper , we show that localized wannier modes can be obtained directly from an @xmath0 regularized variational principle without ever calculating crystal eigenstates in the bloch representation . </S>",
    "<S> these ideas generalize earlier work @xcite to systems with translational symmetry . </S>",
    "<S> our approach is well - defined for both insulating and metallic systems , with one parameter providing a systematically controllable trade - off between the accuracy of the total energy and the localization degree of the regularized ( `` compressed '' ) wannier modes . </S>",
    "<S> we also introduce efficient numerical methods to solve the associated constrained variational problem .    for simplicity , we assume that the problem permits real - valued wannier functions . following general practice , we label the wannier functions @xmath3 by a band index @xmath4 and lattice site @xmath5 . </S>",
    "<S> the @xmath6 regularized energy functional introduced in @xcite is written as @xmath7 where the @xmath0 norm of a function is defined as @xmath8 . </S>",
    "<S> the effect of the @xmath0 term is to localize the solutions , and the parameter @xmath1 controls the trade - off between sparsity and accuracy : larger values of @xmath1 give solutions that better minimize the total energy at the expense of more extended wannier functions , while a smaller @xmath1 gives highly localized wave functions at the expense of larger errors in the calculated energies . </S>",
    "<S> furthermore , due to the properties of the @xmath0 term , the functions that minimize eq .   have compact support , i.e. they are nonzero only in a finite spatial region . since the functional is convex , efficient numerical minimization methods can be devised .    </S>",
    "<S> our proposed scheme defines compactly supported wannier modes recursively by minimizing @xmath9 subject to shift - orthogonality and normalization constraints : @xmath10 this generalizes to nonzero crystal potentials the approach used in @xcite to construct the compressed plane wave ( cpw ) bases for the laplacian . </S>",
    "<S> a key advantage of our scheme is that one parameter @xmath1 controls both the physical accuracy and the spatial extent , while not requiring any physical intuition about the properties of the solution . in other words , </S>",
    "<S> the wannier functions are nonzero only in those regions that are required to achieve a given accuracy for the total energy and are zero everywhere else . </S>",
    "<S> the cauchy  </S>",
    "<S> schwarz inequality guarantees that the difference between and the true energy functional is bounded from above by a constant multiple of @xmath11 . </S>",
    "<S> hence , the solutions to the variational problem involving provide an accurate , systematically controllable approximation to the true total energy of the system @xcite . </S>",
    "<S> fully self - consistent calculations can be performed using wannier functions , without any reference to the bloch waves and brillouin zones .    in what follows , </S>",
    "<S> we describe efficient algorithms for solving . </S>",
    "<S> we choose a supercell @xmath12 defined by three lattice vectors @xmath13 where @xmath14 is a @xmath15 nonsingular matrix with integer elements , and @xmath16 are the unit cell vectors of the primitive lattice . </S>",
    "<S> the hamiltonian @xmath17 has the periodicity of the primitive lattice : @xmath18 for the wannier modes in , we impose periodic boundary conditions with respect to the supercell : @xmath19 for physical accuracy , the supercell @xmath20 should be chosen big enough to allow the compressed wannier modes to decay to zero within the range of the supercell , although this is not necessary for the numerical algorithm to work .    </S>",
    "<S> we also introduce the primitive reciprocal lattice @xmath21 such that @xmath22 . </S>",
    "<S> the fourier expansion of a supercell periodic wannier mode @xmath23 will contain only plane waves with wave vectors @xmath24 , where @xmath2 belongs to the first brillouin zone of the primitive lattice and @xmath25 is a reciprocal lattice vector . </S>",
    "<S> fourier expansion of wannier mode @xmath23 includes all plane waves below a certain kinetic energy cutoff @xmath26 : @xmath27 and can be written as @xmath28 where we have defined a cell - periodic bloch function @xmath29 the inverse fourier transform is given by @xmath30 where the integral extends over the supercell and @xmath31 is the supercell volume .    </S>",
    "<S> _ shift - orthogonality : _ one of the key steps for is ensuring that the solution @xmath32 is orthogonal to its own translations by all primitive lattice vectors @xmath5 , as well as orthogonal to all translations of the lower wannier modes @xmath33 . </S>",
    "<S> we say that function @xmath34 is shift - orthogonal if and only if @xmath35 holds for all lattice vectors @xmath5 and @xmath36 . </S>",
    "<S> the nonlinear lagrangian method used to enforce in @xcite is too slow in this context , and here we detail a faster approach adapted from computational harmonic analysis @xcite .    given a supercell periodic function @xmath37 , the objective is to find the projection of @xmath37 to the set of shift orthogonal functions ( see also @xcite ) . in other words , </S>",
    "<S> we need to solve the following minimization problem : @xmath38 note that @xmath39 is not necessarily unique and the set of shift - orthogonal functions is not a vector space because a sum of two shift - orthogonal functions may not be shift - orthogonal . </S>",
    "<S> however , if two shift - orthogonal functions @xmath37 and @xmath40 are orthogonal to all shifts of each other , any normalized linear combination of them will also be shift - orthogonal . </S>",
    "<S> this property allows to design efficient iterative update algorithms for .    </S>",
    "<S> the following theorem is well known in the wavelet community ( e.g. , see eq . 7.19 in @xcite ) . for completeness </S>",
    "<S> , we provide the proof of the theorem in the appendix .    </S>",
    "<S> supercell - periodic function @xmath34 is shift - orthogonal if and only if @xmath41 where @xmath42 is the number of primitive cells inside the supercell . </S>",
    "<S> [ theorem : equivalence ]    a derivation similar to what is used for theorem yields the following theorem :    for two supercell - periodic functions @xmath34 and @xmath43 , @xmath44 if and only if @xmath45 [ theorem : equivalence2 ]    it is seen that these shift - orthogonality conditions amount to orthonormalization imposed on the bloch functions @xmath46 .    theorem [ theorem : equivalence ] and parseval s identity @xmath47 yield a straigtforward algorithm for obtaining the solution to problem . </S>",
    "<S> this algorithm has several important features . </S>",
    "<S> first , it has computational complexity of @xmath48 where @xmath49 is the number of fourier coefficients used to represent function @xmath37 . </S>",
    "<S> second , it is parallelizable over both @xmath2 and @xmath50 . </S>",
    "<S> finally , for a real valued input function @xmath37 , the algorithm outputs a real valued projection @xmath39 . as mentioned earlier , the solution to is not unique if @xmath51 for some @xmath2 . in these situations , </S>",
    "<S> we choose the solution corresponding to the lowest frequency , i.e. @xmath52 .    </S>",
    "<S> next suppose that supercell periodic functions @xmath37 and @xmath53 are given . </S>",
    "<S> theorem [ theorem : equivalence2 ] yields an algorithm similar to the one discussed above that finds a shift - orthogonal projection that is also perpendicular to all translations of @xmath53 : @xmath54    _ computing wannier modes : _ wannier functions as in are minimizers of @xmath9 subject to shift - orthogonality constraints . however , minimization of @xmath9 can not be done efficiently using conventional quadratic optimization techniques due to the discontinuous behavior of the derivative of the @xmath0 term at @xmath55 and the non - convex constraints . </S>",
    "<S> efficient numerical methods for such problems are based on the bregman iteration @xcite . here </S>",
    "<S> , we use the split bregman approach of @xcite , which treats the @xmath6 term by introducing an additional variable @xmath56 with a quadratically constraint to approach the solution , as shown in algorithm [ algorithm : bregman_l1 ] . </S>",
    "<S> the main advantage of this approach is that the minimization of the quadratic functional @xmath57 is separated from the minimization of the @xmath6 term , allowing use of highly efficient quadratic optimization algorithms for the former .    * </S>",
    "<S> input : * @xmath58 , @xmath59 ( empty if @xmath60 ) , @xmath61    * output : * @xmath62    : both @xmath63 are norm-1 random functions defined on @xmath12 . </S>",
    "<S> @xmath64 ; @xmath65 @xmath66 ; @xmath67 ; @xmath68 ; @xmath69 ; @xmath70 .    in algorithm </S>",
    "<S> [ algorithm : bregman_l1 ] , @xmath71 are chosen such that @xmath72 is positive definite , and @xmath1 is chosen such that @xmath73 . </S>",
    "<S> line 3 is equivalent to solving the elliptic equation @xmath74 + \\gamma [ v(\\r)-c(\\r)],\\ ] ] which can be solved by the preconditioned conjugate gradient method , with the preconditioner given by the inverse of a linear elliptic operator @xmath75 in this work , we implement the inverse by a fast poisson solver . in practice </S>",
    "<S> , problem does not need to be solved exactly and a few iterations per cycle are sufficient . </S>",
    "<S> line 4 is solved by the algorithms described for when @xmath60 and by when @xmath76 . </S>",
    "<S> line 5 is solved by a component - wise soft thresholding operation : @xmath77    as an illustration , we find compressed wannier modes for a one - dimensional system with lattice parameter @xmath78 and hamiltonian @xmath79 , where @xmath80 is a superposition of inverted gaussians of two different depths : @xmath81.\\ ] ] we choose @xmath82 , @xmath83 , @xmath84 and @xmath85 , @xmath86 ; the resulting potential @xmath87 is shown in figure [ fig : wannier - functions ] . </S>",
    "<S> the lowest 8 wannier modes are constructed following algorithm [ algorithm : bregman_l1 ] using a supercell of length @xmath88 and parameters @xmath89 . </S>",
    "<S> the results are shown in figure [ fig : wannier - functions ] . </S>",
    "<S> observe that wannier modes of levels 1 and 3 are located within the the deep wells and level 2 is located in the shallow well , corresponding to `` semi - core states '' with flat bands . </S>",
    "<S> higher levels spread over the two types of wells , which suggests that they belong to the continuous spectrum . </S>",
    "<S> adaptively changing @xmath1 in front of the @xmath6 term inversely proportional to the total energy can limit their support . </S>",
    "<S> we note that the wannier modes in all cases are either symmetric or antisymmetric , i.e. they constitute irreducible representations of the symmetry group of the underlying potential . </S>",
    "<S> it remains to be seen whether similar property is preserved in higher dimensions .        </S>",
    "<S> the calculated eigenvalue dispersion for bands 1 - 8 is shown in figure  [ fig : spaghetti ] for exact diagonalization ( continuous line ) and for subspace diagonalization using the lowest 8 wannier modes ( filled circles ) . </S>",
    "<S> the former are calculated as the eigenvalues of the subspace hamiltonian , @xmath90 we see that the agreement is perfect , except for small deviation in the highest band , which is due to the limited number of wannier modes in use .        in conclusion , we have introduced an approach to obtaining compactly supported wannier modes directly from an @xmath0 regularized variational principle for the total energy . </S>",
    "<S> our approach does not require calculation of the bloch states with a subsequent minimization of a nonconvex localization functional and therefore is expected to be more robust . </S>",
    "<S> the proposed numerical algorithms are logically straightforward and simple to implement in existing density - functional theory ( dft ) codes with brillouin zone sampling . </S>",
    "<S> indeed , the key step of algorithm  [ algorithm : bregman_l1 ] involves iterative solution of eq .  , which in turn requires evaluations of @xmath91 . </S>",
    "<S> using the decomposition of @xmath23 into bloch functions according to , we can write @xmath92 where @xmath93 . routines for calculating @xmath94 are already implemented in codes based on the bloch theorem , and can be evaluated by a simple summation or fourier transform over @xmath2 in the brillouin zone . </S>",
    "<S> hence , the computational complexity of the proposed approach is similar to that of conventional bloch function methods and can be used directly in self - consistent dft calculations . </S>",
    "<S> we also hypothesize that @xmath0 regularized wannier modes will be useful for beyond - dft approaches that can benefit from the finite range of electronic states , such as screened exchange and quantum monte carlo methods .    </S>",
    "<S> v.o . was supported by the national science foundation under award no . </S>",
    "<S> dmr-1106024 and used computing resources at the national energy research scientific computing center , which is supported by the us doe under contract no . de - ac02 - 05ch11231 . </S>",
    "<S> the research of r.c . </S>",
    "<S> is partially supported by the us doe under contract no . </S>",
    "<S> de - fg02 - 05er25710 . </S>",
    "<S> the research of s.o . was supported by the office of naval research ( grant n00014 - 11 - 1 - 719 ) . </S>",
    "<S> we acknowledge dr . </S>",
    "<S> j. c. budich , who pointed out the equivalence of shift - orthogonality conditions for the wannier functions and the orthonormality of their bloch functions . </S>"
  ]
}