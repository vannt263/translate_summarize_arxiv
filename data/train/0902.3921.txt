{
  "article_text": [
    "in recent years lattice boltzmann methods ( lbm ) @xcite have been widely used to study multiphase fluids @xcite .",
    "examples of applications are the analysis of growth regimes in phase separation of binary mixtures @xcite or the study of backflow effects in liquid crystal behavior @xcite .",
    "the lbm approach is well suited for dealing with complex geometries or for parallel implementations @xcite .",
    "moreover , in the free - energy approach @xcite , the mesoscale properties of the fluid ( interface structures , coupling with local order parameters , etc . ) can be straightforwardly inserted in the lbm numerical scheme and taken under control . due to the relevance of the method",
    ", it is worth to further develop lbm algorithms in order to improve numerical stability and accuracy , also by optimizing the use of computer resources .",
    "lbm dynamics is defined in terms of kinetic equations for a set of populations @xmath0 representing , at each lattice site and time , the density of particles moving in one of the allowed directions of a given lattice .",
    "the sum over the directions @xmath1 of @xmath0 is the local density of the fluid while the first momentum is related to the local fluid momentum . in one approach a forcing term",
    "is included in the kinetic equations representing the interactions between the components of the mixture @xcite .",
    "differently , the free - energy method was originally developed by fixing the second moment of the populations in terms of the pressure tensor of the fluid mixture @xcite .",
    "it has been applied to complex fluids in refs .",
    "@xcite .    in this paper",
    "we consider an approach similar to the one of ref .",
    "@xcite where a free - energy dependent term is added as a body force in the kinetic equations .",
    "this approach traces back to the work of guo _ et al . _",
    "@xcite where a comparison with different methods to introduce the force is reported . with respect to the algorithm of ref .",
    "@xcite , this allows a better control of the continuum limit still keeping all the advantages of the free - energy method . in ref .",
    "@xcite a lattice boltzmann equation is considered for each component . here",
    "we consider a `` hybrid '' algorithm where lbm is used to simulate navier - stokes equations while finite - difference methods are implemented to simulate the convection - diffusion equation .",
    "such hybrid codes have been used for complex fluids @xcite , liquid crystals @xcite and thermal flows @xcite .",
    "this allows to reduce in a relevant way the amount of required memory in systems with multi - component order parameters or in simulations of three - dimensional systems .    a typical undesired effect due to discretization is the appearing of unphysical flow close to the interfaces .",
    "this flow , often known as spurious velocities , can severely affect the quality of lbm simulations . in this work we discretize the differential operators by a procedure optimized for reducing the magnitude of spurious velocities , following the so - called `` stencil '' method applied in ref .",
    "@xcite to a multiphase one - component fluid . here",
    "we will see that this method allows to reduce spurious velocities of about an order of magnitude .",
    "the paper is organized as follows . in the next section",
    "the lbm algorithm proposed is described and details on the numerical implementation are given . in section 3",
    "results of simulations of test configurations are shown .",
    "we will see how spurious velocities around curved interfaces can be reduced applying a more general stencil to discretize derivatives .",
    "we will also discuss the convection of a drop under a constant force acting for a finite time interval .",
    "then some conclusions will follow in section 4 .",
    "the equilibrium properties of the fluid mixture can be described by a free energy @xmath2\\ ] ] where @xmath3 is the temperature , @xmath4 is the total density of the mixture , and @xmath5 is the scalar order parameter representing the concentration difference between the two components of the mixture .",
    "the term depending on @xmath4 gives rise to the ideal gas pressure @xmath6 which does not affect the phase behavior .",
    "the terms in @xmath5 in the free - energy density @xmath7 correspond to the typical expression of ginzburg - landau free energy used in studies of phase separation @xcite .",
    "the terms in the free energy can be distinguished in two parts : the polynomial terms describe the bulk properties of the mixture and the gradient term is related to the interfacial ones .    in the bulk terms",
    "the parameter @xmath8 is always positive to ensure stability while the parameter @xmath9 can distinguish a disordered ( @xmath10 ) and an ordered ( @xmath11 ) mixture , in which the two components coexist with equilibrium values @xmath12 where @xmath13 @xcite .",
    "the equilibrium profile between the two coexisting bulk components is @xmath14 with interface width @xmath15 and surface tension @xmath16 the thermodynamic functions can be obtained from the free energy ( [ freenergy ] ) by differentiation .",
    "the chemical potential difference between the two components is given by @xmath17 the pressure @xmath18 is a tensor since interfaces in the fluid can exert nonisotropic forces @xcite .",
    "the diagonal part @xmath19 can be obtained from eq .",
    "( [ freenergy ] ) as @xmath20 for a fluid with concentration gradients @xmath18 has to verify the general equilibrium condition @xmath21 @xcite .",
    "a suitable choice for the pressure tensor is @xmath22    the hydrodynamic equations of fluids follow from the conservation laws for mass and momentum . for binary mixtures at constant temperature",
    "the evolution of density , velocity and concentration fields is described by the continuity , the navier - stokes and the convection - diffusion equations @xcite , respectively , @xmath23 where @xmath24 and @xmath25 are the shear and the bulk viscosities , @xmath26 is the mobility coefficient , and @xmath27 is the dimensionality of the system .    equations ( [ conteqn])-([convdiffeqn ] ) can be solved numerically .",
    "we use a mixed approach that consists of a finite difference scheme for solving eq .",
    "( [ convdiffeqn ] ) and of a lbm approach with forcing term for eqs .",
    "( [ conteqn ] ) and ( [ navstokeqn ] ) .",
    "this has the advantage that the amount of required memory can be decreased so that larger systems can be simulated . in our case of study , for a two - dimensional model on a square lattice with nine velocities ( @xmath28 )",
    ", this method allows to reduce the required memory of @xmath29 .",
    "actually , the convection - diffusion equation could have also been solved on a @xmath30 lattice @xcite and in this case the reduction in memory would have been of @xmath31 . moreover , the spurious terms in the continuum equations found in previous formulations based on a free energy @xcite can be avoided .",
    "to solve eqs .",
    "( [ conteqn ] ) and ( [ navstokeqn ] ) we use a lattice boltzmann scheme on a lattice of size @xmath32 in which each site is connected to nearest and next - to - nearest neighbors .",
    "this is one of the simplest geometries which reproduce correctly the navier - stokes equations in continuum limit and is shown in fig .  1 .",
    "horizontal and vertical links have length @xmath33 and diagonal links @xmath34 . on each site",
    "* r * nine lattice velocity vectors @xmath35 are defined .",
    "they have modulus @xmath36 , being @xmath37 the time step , for @xmath38 and modulus @xmath39 for @xmath40 .",
    "moreover , the zero velocity vector @xmath41 is defined .",
    "a set of distribution function @xmath42 is defined on each lattice site @xmath43 at each time @xmath44 .    in the lb scheme for simple fluids @xcite",
    "the distribution functions evolve during the time step @xmath37 according to a single relaxation - time boltzmann equation @xcite @xmath45 , \\ ] ] where @xmath46 is a relaxation parameter and @xmath47 are the local equilibrium distribution functions .",
    "the total density @xmath4 and the fluid momentum @xmath48 are defined by the following relations @xmath49 where @xmath50 is the fluid velocity .",
    "the form of @xmath51 must be chosen so that the mass and momentum are locally conserved in each collision step , therefore the following relations must be satisfied @xmath52 moreover , the @xmath51 s need to have some symmetries so that the navier - stokes equations are reproduced in the continuum limit .",
    "a convenient choice for the local equilibrium distribution functions of an ideal fluid in the case of a @xmath28 model is given by a second order expansion in the fluid velocity @xmath50 of the mawwell - boltzmann distribution @xcite @xmath53,\\ ] ] where @xmath54 is the sound speed in this model , * i * is the unitary matrix and a suitable choice for the coefficients @xmath55 is @xmath56 , @xmath57 for @xmath58 , @xmath59 for @xmath60 .",
    "this form is such that @xmath61    in order to simulate eq .",
    "( [ navstokeqn ] ) where a nonideal pressure tensor @xmath62 appears , we adopt a lb model with a forcing term following a derivation similar to that of ref .  @xcite . in the case of ref .",
    "@xcite the model was used to study forced simple fluids while we address the case of a binary mixture with interaction and interface contributions .",
    "the evolution equation of the distribution functions becomes @xmath63 + \\delta t_{lb } f_i,\\ ] ] where @xmath64 is the forcing term to be properly determined .",
    "the equilibrium distribution functions ( [ espdistrfunc ] ) are not changed except for the formal substitution @xmath65 , where @xmath66 is given by @xmath67 @xmath68 being the force density acting on the fluid and @xmath66 the physical velocity .",
    "the expression of @xmath68 for our case will be given later .",
    "the forcing term @xmath64 can be expressed as a power series at the second order in the lattice velocity @xcite @xmath69 , \\ ] ] where @xmath70 , @xmath71 , and @xmath72 are functions of @xmath68 .",
    "the moments of the force verify the following relations @xmath73 , \\ ] ] and have to be consistent with the hydrodynamic equations .",
    "the continuum limit is obtained by using a chapman - enskog expansion in the knudsen number @xmath74 : @xmath75 @xmath76 @xmath77 @xmath78 we note that the force term is of first order in @xmath74 @xcite .",
    "the continuity and the navier - stokes equations are recovered in the following form @xmath79 in terms of the velocity @xmath66 when the following expressions for the terms @xmath70 , @xmath71 , @xmath72 : @xmath80 are used .",
    "the continuum equations ( [ conteqn ] ) and ( [ nav2 ] ) can be also obtained by a taylor expansion method .",
    "we remark that no spurious terms are present in the continuum equations except for a term of order @xmath81 which is neglected in eq .",
    "( [ nav2 ] ) .",
    "such approximation is correct as far as @xmath82 when the expansion ( [ espdistrfunc ] ) is valid @xcite . in the present formulation the second moment of the equilibrium distribution function ( [ secmoment ] )",
    "does not need to be modified to include the effects of the pressure tensor as in previous models based on a free energy @xcite .",
    "it is straightforward to show that the momentum defined in eq .",
    "( [ newvel ] ) corresponds to an average between the pre- and post - collisional values of the velocity @xmath50 which is the correct way to calculate it when a forcing term is introduced @xcite .",
    "it is this value that appears in the continuum equations and is measured in simulations . as in the case of standard lbm @xcite , the present model is characterized by the fact that @xmath83 with shear viscosity @xmath84 in order to recover eq .",
    "( [ navstokeqn ] ) we have to require that @xmath85 the last equality comes from the fact the term @xmath86 corresponds in lbm to the ideal gas pressure @xmath87 @xcite . finally , the forcing term in eq .",
    "( [ forceevoleqn ] ) has the form @xmath88\\cdot { \\bf f}\\ ] ] with @xmath66 given by eq .",
    "( [ newvel ] ) .",
    "the derivatives of the order parameter in the forcing term ( [ forza ] ) are calculated using a finite difference scheme .",
    "in particular , we have adopted a stencil representation of finite difference operators in the more general way to ensure higher isotropy @xcite , which is known to reduce spurious velocities @xcite .",
    "the schemes for the @xmath89 derivative and the laplacian operators are , respectively , @xmath90   \\label{xstencil}\\ ] ] @xmath91 \\label{laplstencil}\\ ] ] with @xmath92 and @xmath93 to guarantee consistency between the continuous and discrete derivatives @xcite .",
    "the subscript @xmath94 in the symbols of derivatives denotes the discrete operator . in these schemes the central entry is referred to the lattice point where the derivative is computed , and the other entries are referred to the eight neighbor lattice sites .",
    "the discrete derivatives of the order parameter @xmath5 are computed by summing the values in the site and in the eight neighbors with the weights in the matrices ( [ xstencil])-([laplstencil ] ) .",
    "the @xmath95 derivative is computed by transposing the matrix ( [ xstencil ] ) .",
    "the choice of the free parameters @xmath96 and @xmath97 is made in such a way that the spurious velocities are minimized ( see next section ) .",
    "we will refer to this case as the optimal choice ( oc ) .",
    "the values @xmath98 , @xmath99 , @xmath100 , and @xmath101 correspond to the standard central difference scheme denoted as sc .",
    "we will compare sc and oc in the following .",
    "the convection - diffusion equation ( [ convdiffeqn ] ) is solved by using a finite difference scheme . the function @xmath102 is defined on the nodes of the same lattice used for the lb scheme .",
    "the time is discretized in time steps @xmath103 with time values @xmath104 , @xmath105 .",
    "the relationship connecting the two time steps is @xmath106 , being @xmath107 an integer .",
    "we denote any discretized function at time @xmath108 on a node @xmath109 ( @xmath110 ) of the lattice by @xmath111 . at each time step",
    "we update @xmath112 using eq .",
    "( [ convdiffeqn ] ) in two successive partial steps @xcite .",
    "this allows to have a better numerical stability . in the first step we implement the convective term using an explicit euler algorithm @xcite @xmath113 where the velocity @xmath66 comes from the solution of the lb equation .",
    "note that the term @xmath114 has not been neglected since the fluid is not exactly incompressible .",
    "indeed , the navier - stokes equation ( [ nav2 ] ) coming from the lbm contains some compressibility terms which can be anyway kept very small requiring that @xmath82 @xcite .",
    "the derivatives in ( [ adv ] ) are discretized as follows : @xmath115 and analogously for the @xmath95 components .    the diffusive part of eq .",
    "( [ convdiffeqn ] ) is implemented in the second update step using an explicit euler algorithm as @xmath116 \\label{diff}\\ ] ] where @xmath117 and the operator @xmath118 is discretized using the form given in eq .",
    "( [ laplstencil ] ) with the standard choice @xmath100 and @xmath101 .",
    "other choices using a more general stencil for discretizing @xmath118 are possible though we checked that they did not provide any relevant difference .",
    "we considered several test cases in order to validate our model .",
    "we used the values @xmath119 . in the free energy we adopted the parameters @xmath120 , @xmath121 corresponding to an equilibrium interface of width @xmath122",
    "the mobility @xmath26 was set to 5 and the relaxation time @xmath123 was @xmath124 unless differently stated .",
    "we first examined the relaxation to equilibrium of a planar sharp interface on a lattice of size @xmath125 varying @xmath46 in the sc case .",
    "in all the cases the system correctly relaxes to the expected profile ( [ prof ] ) .",
    "one example is reported in fig .  2 .",
    "in the case of a planar interface the fluid velocities @xmath126 decay to negligible values as it should be at equilibrium when @xmath127 and @xmath21 .",
    "we then studied a circular drop as a test for a case with interfaces not aligned with the lattice links . a drop with sharp interface of diameter @xmath128",
    "was placed at the center of a lattice of size @xmath129 and let equilibrate in the sc case .",
    "interfaces relax to the expected profile without deforming the drop but spurious velocities appear as it can be seen in the upper panel of fig .  3 in the case with @xmath130 .",
    "we then used the oc scheme to verify whether spurious velocities could be reduced by using a more isotropic structure for the discrete spatial derivatives in the forcing term ( [ forza ] ) .",
    "we scanned several values of @xmath96 and @xmath97 in order to reduce the maximum value of the velocity @xmath131 on the whole lattice .",
    "the optimal values are summarized in the table i. it is interesting to note that there is a couple of values @xmath132 and @xmath133 which occurs more frequently .",
    "we verified that this choice is also effective in reducing spurious velocities even for the other values of @xmath46 . for this choice of @xmath96 and @xmath97",
    "the maximum velocities differ only by a small percentage from the tabled values .",
    "@cccc@ @xmath123 & @xmath96 & @xmath97 & @xmath134 + 0.6 & 0.3 & 3 & 0.0001753 + 0.8 & 0.3 & 2.5 & 0.0000603 + 1 & 0.3 & 2.5 & 0.0000365 + 1.2 & 0.3 & 2.5 & 0.0000267 + 5 & 0.3 & 2.5 & 0.0000088 + 10 & 0.3 & 2 & 0.0000062 +    [ tbl : scaling ]    velocities can be greatly reduced with respect to the sc case as it can be visually observed in the lower panel of fig .",
    "we also tried to get an analytical estimate of the optimal values of @xmath96 and @xmath97 in the following way . at equilibrium",
    "it holds that @xmath135 .",
    "this expression depends on the first- and third - order derivatives . by using the stencils ( [ xstencil])-([laplstencil ] ) we get for the discretized operators the expressions @xmath136 and @xmath137 so that @xmath138 ( \\delta x)^2 \\partial_x^3 \\partial_y^2\\\\ \\nonumber & + & \\big[\\frac{1}{12 } + \\frac{1 - 2n}{2 } \\big ] ( \\delta x)^2 \\partial_x \\partial_y^4 + ... \\label{39}\\end{aligned}\\ ] ] by imposing that the error terms in the third - order derivative depending on @xmath96 and @xmath97 vanish , we get @xmath139 and @xmath140",
    ". however , this estimate does not correspond to the optimal results of table i. this is due to the fact that these optimal values were found by considering the full dynamical problem with the whole set of equations where we minimized the spurious velocities . in the estimate after eq .",
    "( [ 39 ] ) the coupling with the velocity field was not taken into account so that there is no _ a priori _ reason to expect the same optimal values for @xmath96 and @xmath97 .",
    "a comparison of the spurious velocities in the sc and oc cases is shown in fig .",
    "4 . by using the optimal choice oc",
    "the spurious velocities can be reduced by a factor approximately 10 with respect to the standard case sc over the whole range of @xmath46 values . the stencil forms ( [ xstencil])-([laplstencil ] )",
    "were also applied to the model of ref .",
    "@xcite for nonideal fluids finding a comparable reduction in the magnitude of spurious velocities with respect to the standard case @xcite .",
    "we then studied the motion of an equilibrated drop of diameter @xmath128 in a lattice of size @xmath141 under the effect of an external constant force that acts up to the time @xmath142 and is then switched off .",
    "the additional force @xmath143 acts on the total density .",
    "@xmath144 is in the range @xmath145 $ ] and the oc scheme is used .",
    "the overall system is set in motion rightwards with increasing velocity until the force @xmath146 is on , then it moves with constant speed .",
    "the choice of @xmath144 is such that the final velocity is much smaller than the speed of sound @xmath147 .",
    "the aim was to check whether the system is galilean invariant and the drop is correctly convected by the flow .",
    "we monitored the shape of the drop and measured its center of mass velocity @xmath148 .",
    "this is defined as the average velocity of the center of mass whose position is @xmath149 where the sum is over the lattice nodes @xmath150 inside the drop .",
    "this velocity represents the convection velocity and is compared with the fluid velocity @xmath151 at the center of mass given directly by the lbm . in fig .  5 the comparison between the velocities @xmath148 and @xmath152 along the @xmath89-direction",
    "is shown in the case with @xmath153 .",
    "it is evident that the two coincide indicating that the drop is correctly advected by the fluid .",
    "moreover , its shape is not altered by motion as it can be seen in fig .",
    "6 where some configurations of the system at different times are presented .",
    "moreover , the drop is shown to make clear that it does not change in shape with time .",
    "we measured the ratio of the horizontal and vertical diameters finding that it stays almost constant with a deviation less than @xmath154 from the value 1 .",
    "if the advection velocity is higher , the drop will be slightly deformed being stretched along the @xmath89-direction .",
    "this effect becomes negligible when increasing the surface tension ( [ surftens ] ) via the parameter @xmath155 .",
    "in this paper we have considered a lattice boltzmann method for binary mixtures with thermodynamics fixed by a free - energy functional . we used a mixed method , with continuity and navier - stokes equations simulated by lbm , and convection - diffusion equation by finite difference schemes . differently than in previous free - energy lbm formulations @xcite , the interaction part in the pressure tensor",
    "is not introduced by fixing the second moment of the lbm populations but by introducing a forcing term in the lattice equation .",
    "this approach is suggested by a microscopic picture and allows to obtain a continuum limit without spurious terms . on the other hand",
    ", the mixed or hybrid approach allows a reduction in the required memory and this can be relevant in performing large - scale simulations .    in order to reduce spurious velocities",
    ", differential operators have been discretized by generalizing the usual lattice representations .",
    "free parameters appear and their optimal values have been fixed by requiring that the maximum value of spurious velocities at equilibrium is minimized .",
    "we considered simple test situations , flat interfaces and single drops showing that the correct equilibrium profiles are reproduced .",
    "we found that spurious velocities are reduced of about an order of magnitude when a more general stencil is applied to the derivatives in the forcing term of the lbm equations .",
    "we did not found any relevant difference by applying this procedure to the differential operators appearing in the convection - diffusion equation .",
    "we also checked that our method is stable in phase separation studies , even if we have not reported the results of these simulations in this work .",
    "finally , we checked the effective galilean invariance of the system by advecting for some time interval by a constant force a configuration with one drop and then letting the system to evolve without forcing .",
    "for the cases considered , we did not observe relevant drop deformations , the drop being correctly advected by the surrounding fluid .",
    "r. benzi , s. succi , and m. vergassola , phys . rep . * 222 * , 145 ( 1992 ) ; s. chen and g. d. doolen , annu .",
    "fluid mech . * 30 * , 329 ( 1998 ) ; s. succi , _ the lattice boltzmann equation for fluid dynamics and beyond _",
    "( clarendon press , oxford , 2001 ) .                                                                              .",
    "in the lower panel the drop , extracted from the system , is shown on an underlying mesh to better appreciate its shape.,title=\"fig:\",height=415 ] + . in the lower panel",
    "the drop , extracted from the system , is shown on an underlying mesh to better appreciate its shape.,title=\"fig:\",height=359 ]"
  ],
  "abstract_text": [
    "<S> a hybrid lattice boltzmann method ( lbm ) for binary mixtures based on the free - energy approach is proposed . </S>",
    "<S> non - ideal terms of the pressure tensor are included as a body force in the lbm kinetic equations , used to simulate the continuity and navier - stokes equations . </S>",
    "<S> the convection - diffusion equation is studied by finite difference methods . </S>",
    "<S> differential operators are discretized in order to reduce the magnitude of spurious velocities . </S>",
    "<S> the algorithm has been shown to be stable and reproducing the correct equilibrium behavior in simple test configurations and to be galilean invariant . </S>",
    "<S> spurious velocities can be reduced of about an order of magnitude with respect to standard discretization procedure . </S>"
  ]
}