{
  "article_text": [
    "how should one optimally control a store which is used to make money by buying a commodity when it is cheap , and selling it when it is expensive ?",
    "we are interested in this question primarily in the context of electrical energy systems , where a store may , for example , take in energy at night , when there may be a surplus of supply over demand rendering the excess energy cheap , and release that energy during the day . however , the mathematics we develop is of course more generally applicable .    a major constraint on the operation of electrical energy systems  for example ,",
    "the uk national grid or similar systems in other countries or continents  is that supply and demand need to be kept in very close balance at all times .",
    "it has always been the case that electricity demand is highly variable , notably on daily , weekly and annual cycles , although this variation is in general at least predictable . however , the increasing reliance on renewable sources of generation such as wind and solar power is now introducing both variability and unpredictability in electricity supplies . in order to assist in keeping supply and demand well balanced it is useful to be able to shift electrical energy through time .",
    "the most obvious way to do this is through _ storage _ , which rearranges the profile in time of energy _",
    "supply_. however , the profile in time of _ demand _ may also be rearranged through what is generally referred to as _ demand - side management _ , and it should be noted that the postponement of demand is mathematically equivalent to the use of negative storage  although the practical difficulties with demand - side management are somewhat different .    storage may assist in a large number of ways , most notably :    in shifting energy from times of low demand , when its generation is typically cheap , to times of high demand , when its generation is typically expensive ;    in stabilising the system with respect to small and transient imbalances ;    in reacting to major disturbances , such as sudden loss of generation , transmission failures , or sudden surges in demand .",
    "our interest here is primarily in the first of these  see , for example , @xcite for a broader discussion of storage .",
    "we take an economic view , and investigate the value of energy storage for _ arbitrage _ , that is smoothing price fluctuations over time .",
    "thus it is assumed that energy is always available from somewhere , at a sufficiently high price , and that the value of storage consists of its ability to buy energy when it is cheap and release it when it is expensive .",
    "we work here in a deterministic setting in which we assume that all relevant buying and selling prices are known in advance .",
    "we think of the available storage as a single store .",
    "its _ value _ is equal to the profit which can be made by a notional store `` owner '' buying and selling as above . in the case where the activities of the store are sufficiently significant as to have a market impact ( the store becomes a `` price maker '' ) ,",
    "the _ system _ or _ societal _ value of the store may be similarly calculated by adjusting the notional buying and selling prices so that the store `` owner '' is required to bear also the external costs of the store s activities .",
    "thus our framework is in this respect completely general . we also allow for nonlinear cost functions , for differences in buying and selling prices , for inefficiencies in the storage process , and for input and output rate constraints .    in section  [ sec : problem ] we formally define the relevant mathematical problem and characterise mathematically its optimal solution . in section  [ sec : algorithm ] we provide an algorithm for its solution , which is efficient in the sense we there explain . in particular the decisions to be made at each point in time",
    "typically depend only on a very short future horizon  which is identifiable , but not determined in advance . in section  [ sec",
    ": example ] we give examples based on real data and a real pumped storage facility .",
    "finally , in section  [ sec : conclusions ] we outline some extensions and give concluding remarks .",
    "we work in discrete time , which we take to be integer .",
    "we assume that the store has total _ capacity _ of @xmath0 units of energy , and input and output _ rate constraints _ of @xmath1 and @xmath2 units of power respectively .",
    "we consider also a time - independent ( in)efficiency  @xmath3 associated with the store .",
    "this may be defined as the fraction of energy input which is available for output .",
    "it may be captured in our model either by adjusting buy prices by a factor @xmath4 or by multiplying sell prices by @xmath3 ( the values of @xmath0 in the two cases differing by a factor of @xmath3 ) .",
    "hence , without loss of generality , we take @xmath5 throughout in our mathematical formulation of the problem and its solution .",
    "( a further type of ( in)efficiency , which may be regarded as _ leakage _ over time is considered in section  [ sec : conclusions ] . )",
    "both buying and selling prices at time @xmath6 may conveniently be represented by a function @xmath7 with @xmath8 , which is increasing and convex in @xmath9 and which , for positive @xmath9 , is the price of buying @xmath9 units of energy , and , for negative @xmath9 , is the negative of the price for selling @xmath10 units of energy .",
    "thus the cost of increasing the level of energy in the store by @xmath9 , positive or negative , is always @xmath7 .",
    "the convexity assumption corresponds , for each time @xmath6 , to an increasing cost to the store of buying each additional unit of energy , a decreasing revenue obtained for selling each additional unit of energy , and every unit buying price being at least as great as every unit selling price .    as indicated above ,",
    "if the problem is to determine the value of the store to the entire energy system , or to society , then these prices are taken to be those appropriate to the system or societal costs .",
    "thus , for example , for @xmath9 positive , @xmath7 is the price paid by the store at time @xmath6 for @xmath9 units of energy plus the increased cost paid by other energy users at that time as a result of the store s purchase increasing market prices .",
    "a special case is that of a `` small '' store , whose operations do not influence the market ( the store is a `` price - taker '' rather than a `` price - maker '' ) , and which at time @xmath6 buys and sells energy at given prices per unit of @xmath11 and @xmath12 respectively , where we assume that @xmath13 . here",
    "the function @xmath7 is given by @xmath14    finally , we assume that all prices are known in advance , so that the problem of controlling the store is deterministic .",
    "consider the problem of controlling the store so as to maximise profit over a time interval @xmath15 $ ] .",
    "note that the rate constraints may , if we choose , be absorbed into the cost function  for example , by defining , for each @xmath6 @xmath16 ( formally this defines an extension of the range of the cost functions to include the point at @xmath17 but it is readily verified that this causes no problems ) . for simplicity in the presentation of the theory below we assume this to have been done ; thus see figure  [ fig : cost_fn ] for an illustration of a typical cost function .",
    "( -5,0 )  ( 5,0 ) node [ right ] @xmath9 ; ( 0,-1 )  ( 0,5 ) node [ left ] @xmath7 ;    ( -5,-1 )  ( -4,-1 ) .. controls ( -3,-1 ) .. ( 0,0 ) .. controls ( 4,3 ) .. ( 4,4 )  ( 4,5 ) ; ( -4,0 ) node [ above ] @xmath18 ",
    "( -4,-1 ) ; ( 4,0 ) node [ below ] @xmath1  ( 4,4 ) ; ( -2,-1 ) node [ below ] sell ; ( 3,0.75 ) node [ above ] buy ;    denote the successive levels of the store by a vector @xmath19 where @xmath20 is the level of the store at each successive time @xmath6 .",
    "define also the vector @xmath21 by @xmath22 for each @xmath23 , so that @xmath24 represents the energy added to the store at time  @xmath6 .",
    "it is convenient to assume that both the initial level @xmath25 and the final level @xmath26 of the store are fixed in advance at @xmath27 and @xmath28 .",
    "( if the final level @xmath26 is not fixed and the cost function @xmath29 is strictly increasing , then , for an optimal control , we may take @xmath26 to be minimised ; however , we might , for example , require @xmath30as a contribution to a toroidal solution . )",
    "the problem thus becomes :    choose @xmath31 so as to minimise @xmath32 with @xmath27 and @xmath28 , and subject to the capacity constraints @xmath33    in the case where the cost functions @xmath34 are linear , or piecewise linear , as in the `` small store '' case given by , and in which rate constraints may be present , the problem  @xmath35 may be reformulated as a linear programming problem , and solved by , for example , the use of the minimum cost circulation algorithm ( see , for example , @xcite ) .",
    "our aim in the present paper is to deal with the general case , and to develop an algorithm which proceeds locally in time , providing a solution which is efficient both in the general and in the linear case .    in theorem  [ thm : ls ] below",
    "we use strong lagrangian theory  @xcite to give sufficient conditions for a value @xmath36 of @xmath31 to solve the problem  @xmath35 .",
    "we then discuss briefly how lagrangian theory may be used to show that a solution of the form given always exists .",
    "the truth of this latter assertion is also demonstrated in section  [ sec : algorithm ] when we consider an algorithm for the determination of the solution .",
    "[ thm : ls ] suppose that there exists a vector @xmath37 and a value @xmath38 of @xmath31 such that    @xmath36 is feasible for the stated problem ,    for each @xmath6 with @xmath39 , @xmath40 minimises @xmath41 over all @xmath9 ,    the pair @xmath42 satisfies the complementary slackness conditions , for @xmath43 , @xmath44    then @xmath36 solves the stated problem  @xmath35 .",
    "let @xmath31 be any vector which is feasible for the problem ( with @xmath27 and @xmath28 ) .",
    "then , from the condition  ( ii ) , @xmath45      \\le      \\sum_{t=1}^t\\left[c_t(x_t(s ) ) - \\mu^*_t x_t(s)\\right].\\ ] ] rearranging and recalling that @xmath31 and @xmath36 agree at @xmath46 and at @xmath47 , we have @xmath48 by the condition  ( iii ) , so that the result follows .",
    "as previously discussed , theorem  [ thm : ls ] gives a sufficient condition for a pair  @xmath42 to solve the problem  @xmath35 . as is clear from the condition  ( ii ) of the theorem , the vector @xmath49 has the interpretation that , at each time  @xmath6 , the quantity @xmath50 may be regarded as a notional value per unit of energy in store , and may be used to determine how much further energy to buy or sell at that time .",
    "an optimal solution to the problem  @xmath35 is given by keeping this reference value @xmath50 as constant as possible over time ( for otherwise a `` solution '' may be improved by using a more consistent value of the vector  @xmath49 ) ; the exceptions occur at the boundaries  @xmath46 and @xmath51 of the capacity constraint region , where the above improvements may not be possible and where @xmath52 is allowed to decrease immediately subsequent to those times when the store is empty and to increase immediately subsequent to those times when it is full .",
    "an examination of the relevant strong lagrangian theory ( again see @xcite ) shows that the vector @xmath49 has a representation as @xmath53 where each @xmath54 and @xmath55 are ( strong ) lagrange multipliers associated with respectively the lower bound @xmath46 and upper bound  @xmath0 of the capacity constraint at time @xmath6 .",
    "the standard convexity condition of the supporting hyperplane theorem shows that here a sufficient condition for the existence of such lagrange multipliers is given by the assumed convexity of the cost functions  @xmath34 , and this in its turn is sufficient for the existence of a pair  @xmath42 as in theorem  [ thm : ls ] .",
    "we do not give a formal proof of this assertion here ; rather the algorithm given in the following section constructs such a pair  @xmath42 directly .",
    "we now give an explicit construction of a pair @xmath42 as in theorem  [ thm : ls ] , and hence also an algorithm for the solution of the problem .",
    "this algorithm below may briefly be described as that of attempting to choose @xmath42 so as to satisfy the conditions of theorem  [ thm : ls ] , by choosing the components of these vectors successively in time and by keeping @xmath50 as constant as possible over @xmath6 , changes only being allowed at times when the store is either empty or full .    for further simplicity ,",
    "we suppose first that the cost functions @xmath34 are all strictly convex . for any @xmath6 such that @xmath39 and any ( scalar ) @xmath56 , define @xmath57 to be the unique value of @xmath9 which minimises @xmath58 .",
    "note that @xmath57 is then continuous and increasing ( though not necessarily strictly so ) in @xmath56 .",
    "define a sequence of times @xmath59 and the pair @xmath42 inductively as follows .",
    "suppose that @xmath60 is such that @xmath61 together with @xmath62 and @xmath63 , are all defined .",
    "for each ( scalar ) @xmath56 , define a vector @xmath64 by @xmath65 define the sets @xmath66 and @xmath67 thus @xmath68 and @xmath69 are the sets of @xmath56 for which @xmath70 violates one of the capacity constraints and first does so respectively below or above  in either case at a time which we denote by @xmath71 .",
    "note that , since each @xmath57 is increasing in @xmath56 , we have @xmath72 for all @xmath73 , @xmath74 .",
    "in particular the sets @xmath68 and @xmath69 are disjoint .",
    "note also that since , for all @xmath6 , we have @xmath75 as @xmath76 , the set @xmath68 is nonempty",
    ". let @xmath77 .",
    "we now consider the behaviour of @xmath78 , for which there are three possibilities :    the vector @xmath78 is feasible ; in this case we take @xmath79 and @xmath80 with @xmath81 for @xmath82 ( thus also @xmath80 for all @xmath6 ) ;    the vector @xmath83 belongs to the set @xmath68 ; here there necessarily exists at least one @xmath84 such that @xmath85 ( for otherwise , by the continuity of each @xmath86 in @xmath56 , @xmath56 could be increased above @xmath83 while still belonging to the set @xmath68 ) ; define @xmath87 to be any such @xmath6 , say the largest , and ( again ) take @xmath80 and @xmath81 for all @xmath6 such that @xmath88 ; note also that we then have @xmath89 so that we shall necessarily have @xmath90 ;    the vector @xmath83 belongs to the set @xmath69 ; here , similarly to the case ( b ) , there necessarily exists at least one @xmath84 such that @xmath91 ; define @xmath87 to be any such @xmath6 , again say the largest , and again take @xmath80 and @xmath81 for all @xmath6 such that @xmath92 ; further , in this case we have @xmath93 so that we shall necessarily have @xmath94 .    in the case where the cost functions @xmath34 are all strictly convex",
    ", it now follows immediately from the above construction of the pair @xmath42 that this pair satisfies the conditions ( i)(iii ) of theorem  [ thm : ls ] .    in the case",
    "where , for at least some @xmath6 , the cost function @xmath34 is convex , but not necessarily strictly convex , a little extra care is required .",
    "here , for such @xmath6 , the function @xmath95 is not in general uniquely defined , and , for any given choice , this function is not in general continuous .",
    "however , in essence , the above construction of @xmath42 continues to hold  it is simply a matter , where necessary , of choosing the right value of @xmath57 .",
    "we summarise our results in theorem  [ thm : const ] below .",
    "[ thm : const ] the pair @xmath42 given by the above recursive construction satisfies the conditions ( i)(iii ) of theorem  [ thm : ls ] .",
    "the above algorithm requires the determination , at each of the successive times  @xmath96 , @xmath97 , of the succeeding time @xmath87 and of the common value @xmath83 of @xmath50 for @xmath92 .",
    "this is done by looking ahead for the minimum time horizon necessary for the above determination ; the process then restarts at the time @xmath87 .",
    "a lengthening of the total time @xmath47 over which the optimization is to be performed does not in general change the values of the times @xmath96 , but rather simply creates more of them . in this sense both",
    "the solution to the problem  @xmath35 and the above algorithm are local in time , so that the solution to @xmath35 involves computation which grows essentially linearly in @xmath47 .",
    "the typical length of the intervals between the successive times @xmath96 depends on the shape of the cost functions @xmath34 ( notably the difference between buying and selling prices ) , together with the rate at which these functions fluctuate in time .",
    "this is to be expected as the store operates by selling at prices above those at which it bought , and what is important is the frequency with which such events can occur . for example , such fluctuations may occur in a 24-hour cycle , and , depending on the shape of the cost functions , the typical length of the intervals between the successive times @xmath96 may then be of the order of around 12 hours .",
    "these points are illustrated further in the examples of the following section .",
    "we observe also that , for each time @xmath96 as above , the determination of the succeeding time @xmath87 and of @xmath83 involves some form of search over an interval of the real line and as such may typically only be carried out to a specified degree of precision .",
    "this is inevitable given general convex cost functions .",
    "in this section we look further at the case of a `` small '' store , whose operations do not influence the market , and which at time @xmath6 buys and sells energy at given prices per unit of @xmath11 and @xmath12 respectively ( with @xmath13 ) , so that each of the functions  @xmath7 is as given by  .",
    "we continue to assume the existence of a rate constraint  @xmath98 , which , for mathematical purposes may , as previously observed , be absorbed into the cost functions @xmath7 by appropriately modifying them .",
    "we give a number of results for this case , illustrating them with examples based on real - world data .",
    "it follows from the results of the previous section that , given an initial level @xmath99 and a final level @xmath100 of the store , there exists a pair @xmath42 as in theorem  [ thm : ls ] and such that @xmath36 defines the optimal control of the store over the time interval @xmath15 $ ] .",
    "one immediate consequence of this is that the optimal control is here bang - bang is the sense that , at each time @xmath6 , the store should either buy as much as possible ( subject to the capacity and rate constraints ) , do nothing , or sell as much as possible , according to whether the current `` reference value '' @xmath52 of @xmath56 is above the buy price  @xmath11 , between @xmath11 and the ( lower ) sell price  @xmath12 , or below @xmath12 .",
    "typically we may have @xmath101 for some factor @xmath102 which may be interpreted as representing the efficiency of the store .",
    "as @xmath3 is decreased below @xmath103 the set of times at which buying or selling actually takes place is correspondingly reduced  see the example below .",
    "now note that , apart from the obvious scale factor , the solution @xmath104 to the optimization problem  @xmath35 of problem depends on capacity constraint  @xmath0 and the rate constraint  @xmath98 only through the ratio @xmath105 , which has the dimension of _ time_. as the store capacity @xmath0 is increased ( with @xmath98 held fixed ) , the time horizon required for the determination of each optimal action becomes longer and the corresponding optimal solution more global in character . for @xmath106",
    "there is some scalar @xmath49 such that @xmath107 for all @xmath6 , so that in an optimal solution , at each time @xmath6 , the store buys if and only if @xmath108 and sells if and only if @xmath109 . the scalar @xmath49 is such that the final level of the store is @xmath100 as required .",
    "in contrast , as the rate constraint @xmath98 is increased ( with @xmath0 held fixed ) , the time horizon required for the determination of each optimal action becomes shorter and the corresponding optimal solution more local in character .",
    "these results are illustrated in the examples that follow .",
    "we illustrate our methodology with an example storage facility using parameters motivated by the dinorwig pumped - storage power station in snowdonia , north wales ",
    "see @xcite for a good description of this power station and its uses .",
    "( note , however , that dinorwig is not currently primarily used for price arbitrage , but rather for the provision of fast response services to the gb energy network . )",
    "we use the `` small store '' cost structure  , with @xmath110 for all @xmath6 .",
    "a typical value for  @xmath3 would be  @xmath111 reflecting the approximate efficiency of the dinorwig plant .",
    "we assume also a common input and output rate constraint @xmath112 , say .",
    "the cost series are proportional to the real half - hourly spot market wholesale electricity prices during the period corresponding to the example .",
    "as might be expected these prices show a strong daily cyclical behaviour .",
    "as already observed , for the `` small store '' essentially linear cost structure  , the optimal control is bang - bang in the sense already described above .    in the first of our examples we take the ratio @xmath105 to correspond to 10 half - hourly periods  the total length of time which the dinorwig facility takes to either fill or empty . specially , we considered the choice  @xmath113 energy units and  @xmath114 energy unit per half - hour .",
    "figures  [ fig : a-0.65 ] , [ fig : a-0.75 ] and  [ fig : a-0.85 ] show the two price series  @xmath11 and  @xmath12 for the 7-day period sunday 9 january 2011 to saturday 15 january 2011 inclusive for efficiencies of  @xmath115 and  @xmath116 , respectively .",
    "the decisions to buy , sell or keep the level of the store unchanged are indicated by the red , blue and black line segments , respectively . in the lower panel",
    "we show the series of storage values ,  @xmath20 , over this one - week period .",
    "each day storage is emptied when prices are sufficiently high and filled when prices are low .",
    "notice that as the efficiency ,  @xmath3 , is reduced the number of periods at which it is economic to either buy or sell ( as opposed to doing nothing ) is similarly reduced",
    ".     corresponds to 10 half - hourly periods and  @xmath117 : plots of price series with buy and sell times and of corresponding level of storage.,width=336 ]     corresponds to 10 half - hourly periods and  @xmath118 : plots of price series with buy and sell times and of corresponding level of storage.,width=336 ]     corresponds to 10 half - hourly periods and  @xmath119 : plots of price series with buy and sell times and of corresponding level of storage.,width=336 ]    in our second example we investigate the operation of the storage plant with increasing storage capacity  @xmath0 while keeping the rate constraint  @xmath98 and the two price series as before .",
    "figure  [ fig : b - elarge ] corresponds to the situation that arises when  @xmath0 has increased to the extent that the capacity constraint is no longer active provided only that the initial level  @xmath99 and final level  @xmath100 of the store are taken sufficiently large . here",
    "the storage facility remains nonempty over long periods of time and may take advantage of the price difference between , for example , different seasons of the year .",
    "our third and final example shows in figure  [ fig : b - plarge ] the complementary circumstance when there is effectively no rate constraint , that is we hold  @xmath0 fixed at one energy unit and increase  @xmath98 until the rate constraint in no longer active .",
    "accordingly the finite capacity store is always able to fill entirely and empty completely within a single half - hour period .     is no longer active ( that is ,  @xmath105 is large ) and  @xmath118 : plots of price series with buy and sell times and of corresponding level of storage.,width=336 ]     is small ) and  @xmath118 : plots of price series with buy and sell times and of corresponding level of storage.,width=336 ]",
    "in the preceding sections we have developed the optimization theory associated with the use of storage for arbitrage , and given an algorithm for determining the optimal control policy for , and hence the value of , storage when used for this purpose .",
    "in particular our algorithm captures the fact that the control policy is essentially local in time , in that , for a given system subject to given capacity and rate constraints , at each time optimal decisions are dependent only on the relevant cost functions for what is typically a very short time horizon .",
    "our model accounts for nonlinear cost functions , rate constraints , storage inefficiencies , and the effect of externalities caused by the activities of the store impacting the market .",
    "what we have not done in the present paper is to consider the use of storage for providing a reserve in case of unexpected system shocks , such as sudden surges in demand or shortfalls in supply .",
    "this problem is considered by other authors , in which the probabilities of storage underflows or overflows are controlled to fixed levels .",
    "however , we believe that a further approach here would be to attach economic values to such underflows or overflows , translating to attaching an economic worth to the absolute level the store ( as opposed to attaching a worth to a _ change _ in the level of the store as in the present paper ) . since in practice storage is used both for arbitrage and for buffering or control as described above , this would provide a more integrated approach to the full economic valuation of such storage .",
    "the authors wish to thank their co - workers andrei bejan , janusz bialek , chris dent and frank kelly for very helpful discussions during the preliminary part of this work .",
    "they are also most grateful to the isaac newton institute for mathematical sciences in cambridge for their funding and hosting of a number of most useful workshops to discuss this and other mathematical problems arising in particular in the consideration of the management of complex energy systems .",
    "they are further grateful to national grid plc for additional discussion and the provision of data , and finally to the engineering and physical sciences research council for the support of the research programme under which the present research is carried out .",
    "( the epsrc grant references are as follows : ep / i017054/1 and ep / i016023/1 . )",
    "a.iu  bejan , r.j .",
    "gibbens and f.p.kelly .",
    "statistical aspects of storage systems modelling in energy networks . _",
    "46th annual conference on information sciences and systems ( invited session on optimization of communication networks)_. march 2123 , 2012 , princeton university , usa ."
  ],
  "abstract_text": [
    "<S> we study the optimal control of storage which is used for arbitrage , i.e.  for buying a commodity when it is cheap and selling it when it is expensive . </S>",
    "<S> our particular concern is with the management of energy systems , although the results are generally applicable . </S>",
    "<S> we consider a model which may account for nonlinear cost functions , market impact , input and output rate constraints and inefficiencies or losses in the storage process . </S>",
    "<S> we develop an algorithm which is maximally efficient in the sense that it incorporates the result that , at each point in time , the optimal management decision depends only a finite , and typically short , time horizon . </S>",
    "<S> we give examples related to the management of a real - world system . </S>"
  ]
}