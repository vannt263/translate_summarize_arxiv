{
  "article_text": [
    "a great variety of programs can be found in the literature for automatic gamma - ray spectrum analysis with computers @xcite . an important ingredient of every such program is some peak finding procedure .",
    "usually the following two characteristics of a local maximum of continuous function are used in peak searching algorithms : 1 ) near the maximum the curve is convex and so its second derivative becomes negative , having a minimum value around the maximum of the peak .",
    "2 ) while passing a peak the first derivative changes sign .",
    "the use of the second derivative for automatic photopeak location was proposed by mariscotti @xcite .",
    "the real spectra , however , can have significant fluctuations because of the discrete and statistical nature of the data .",
    "so a discrete analog of the second derivative ( the second difference ) @xmath0 should be used , @xmath1 being the pulse heights of the spectrum in channel i.    to reduce further the influence of the statistical fluctuations , this second difference can be averaged and after n iterations replaced by the generalized second difference @xmath2 its standard statistical deviation is @xmath3 and therefore not only @xmath4 condition is demanded for the peak area location but also a big enough value of @xmath5 .    in @xcite some modification of this method was used . instead of smoothed second difference",
    "one can consider the sum @xmath6 where the @xmath7 coefficients are chosen in such a way that @xmath8 near the peak .",
    "for example in @xcite they take @xmath9 p being some parameter to be optimized .",
    "note that near the peak @xmath10 n(x ) \\ , dx= \\nonumber \\\\ & & \\int_{-\\infty}^{\\infty } \\exp { \\left ( -\\frac{x^2}{2p^2}\\right ) } \\frac{d^2n(x ) } { dx^2 } < 0   \\hspace*{2 mm } .",
    "\\nonumber \\end{aligned}\\ ] ]    in @xcite the smoothed first derivative was used for photopeak searches .",
    "the peak is identified at the point where the first derivative changes sign from positive to negative .",
    "one can smooth not the first or second derivatives but the original data and establish the sign of the first derivative by simply comparing consecutive channels . to increase statistical reliability ,",
    "one demands not only @xmath11 , but also @xmath12 @xcite .",
    "as is claimed in @xcite , for low statistics the best result is given by the following smoothing @xmath13    one more method for photopeak position finding , although somewhat complex , is fitting the whole spectrum or its part by appropriate analytic function .",
    "a lot of various functions were suggested for this purpose , some of them modeling even compton continuum @xcite . if resolution is very good , as it is usually for semiconductor detectors , so that one has almost ideal gaussian peaks and the background in the peak area is nearly constant , it is possible to fit successive small sections of the data by gaussian function and identify the peak position where the amplitude of the fitted gaussian becomes significant @xcite .    in this note",
    "a new and simple enough algorithm is proposed for photopeak searches , which is completely different from the above described methods .",
    "the proposed method is based on a very simple but nice idea , which can be explained as follows .",
    "suppose we place a small ball on the edge of the irregular potential wall :    classical ball will stop in front of the first obstacle .",
    "but if it is a quantum one and can penetrate through narrow barriers it still goes down to the potential wall bottom and oscillates there .    for automatic photopeak finding this idea",
    "can be realized , for example , in such a way .",
    "let us take a point somewhere on the right slope of the peak and let this point can jump left or right by one channel , or remain on its position , so that the probability to jump left is proportional to @xmath14}$ ] and to jump right @xmath15}$ ] .",
    "this point will climb up quickly enough to the photopeak and will oscillate on the top . if now we follow up some amount of jumps and calculate the mean position , this just gives us the photopeak location .    to smear the `` quantum ball '' even more",
    ", one can take for the probability to jump from channel i to channel i-1 : @xmath16 } \\hspace*{2 mm } , \\nonumber \\end{aligned}\\ ] ] where @xmath17 are some numerical constants .",
    "changing them and the number m , one can govern the penetrating ability of the ball .",
    "in fact the above described set of channels and transition probabilities can be treated as a finite markov chain @xcite .    for simplicity",
    "let us assume that from any state ( channel ) in this markov chain only the closest left and right neighbour states can be reached with nonzero probabilities in one step , and that the probability for any state to remain unchanged is zero .",
    "thus the transition probability matrix for this chain looks like @xmath18 where we shall take @xmath19 } \\hspace*{2 mm } , \\label{eq2 } \\end{aligned}\\ ] ] @xmath20 normalization constant is defined from the @xmath21 condition .",
    "this markov chain has a very simple invariant distribution @xcite : @xmath22 @xmath23 being defined from the normalization condition @xmath24    now this invariant distribution has very sharp peaks which correspond to a local maximums in the original spectrum .",
    "this is illustrated by fig.1 .",
    "it is much simpler to identify peaks by some computer program in the @xmath25 distribution than in the original data .",
    "fig.2 gives a clear example of this ( note the logarithmic scale on the vertical axis ) .",
    "in fact this method of photopeak finding can work even for very low statistics , as fig.3 shows .",
    "after the photopeak is located by the above described algorithm , one can fit it by gaussian function and extract its other characteristics . fig.2 and fig.3",
    "show that our `` quantum''algorithm not only gives the peak position , but can also provide useful limits in which it is worthwhile to fit it by gaussian .    for good enough gaussian peaks one can use a non - iterative method for the fast fitting @xcite .",
    "suppose we want to fit a gaussian to the spectrum region from channel @xmath26 to channel @xmath27 .",
    "let us form an array @xmath28 , where m is some integer number .",
    "if we have a pure gaussian @xmath29 } \\hspace*{2 mm } , \\nonumber \\end{aligned}\\ ] ] then @xmath30 does nt depend on i. in fact this will not be the case because of statistical fluctuations and we should find a constant c which minimizes the sum @xmath31 ^ 2}{d^2(i ) } \\ ; \\ ; , \\ ; \\ ; d^2(i)=\\frac{1}{n_i}+\\frac{1}{n_{i+m}}+ \\frac{1}{n_{i-1}}+\\frac{1}{n_{i+m-1 } } \\ ; \\ ; , \\nonumber \\end{aligned}\\ ] ] where @xmath32 is a standard deviation for the casual quantity @xmath33 .",
    "the solution of this linear minimization problem is well known @xmath34 \\bigg/ \\left [ \\sum_{i = m_1 + 1}^{m_2-m } \\frac{1}{d^2(i ) } \\right ] \\ ; \\ ; . \\label{eq5 } \\end{aligned}\\ ] ] if we disregard statistical fluctuations of @xmath32 , the statistical error in determination of c is @xmath35 ^{-1/2 } \\ ; \\ ; .",
    "\\nonumber \\end{aligned}\\ ] ] so we get @xmath36 the parameter m can be determined from the condition @xmath37 to be minimal .",
    "let us take as an estimation @xmath38 .",
    "then @xmath39 , which is minimal for @xmath40 analogously one can find the position and amplitude of the fitted peak by considering arrays @xmath41 and @xmath42 .",
    "the results are @xmath43 \\bigg/ \\left [ \\sum_{i = m_1 + 1}^{m_2-m } \\frac{1}{dp(i)^2 } \\right ] \\nonumber \\\\ & & dp(i)^2=\\frac{\\sigma^2}{m^2 } \\left [ 4(\\delta \\sigma)^2p^2(i)+ \\sigma^2 \\left ( \\frac{1}{n_i}+\\frac{1}{n_{i+m } } \\right ) \\right ] \\ ; \\ ; , \\label{eq8 } \\end{aligned}\\ ] ] and @xmath44 \\bigg/ \\left [ \\sum_{i = m_1}^{m_2 } \\frac{1}{dn(i)^2 } \\right ] \\nonumber \\\\ & & dn(i)^2=\\frac{1}{n_i}+\\left ( \\frac{\\delta \\sigma}{\\sigma } \\right ) ^2 \\left ( \\frac{i - p}{\\sigma } \\right ) ^4 \\ ; \\ ; . \\label{eq9 } \\end{aligned}\\ ] ] where m is defined by eq.7 and @xmath45 relation was assumed while deriving the last equation .",
    "the degree of fit between the calculated and observed spectra can be further analyzed by means of some quantitative criteria , suggested in the literature @xcite .",
    "it seems to us that the proposed algorithm is simple and effective enough to be recommended for practical applications .",
    "an earlier version of it was used with excellent results for uniformity studies of about 1650 naj crystals for snd detector @xcite , and also for vacuum phototriodes testing @xcite .",
    "the author is grateful to v.b .",
    "golubev , s.i .",
    "serednyakov and a.n .",
    "peryshkin for useful discussions",
    ".    99 m.j .",
    "koshelo , p.a .",
    "aarnio , j.t .",
    "routti , nucl .",
    "methods * 190 * ( 1981 ) , 89 .",
    "helmer , c.m .",
    "mccullagh , nucl .",
    "methods * 206 * ( 1983 ) , 477 . m.  hillman , nucl . instrum .",
    "methods * 135 * ( 1976 ) , 363 .",
    "roscoe , a.k .",
    "furr , nucl .",
    "methods * 137 * ( 1976 ) , 173 . t.  sekine , h.  baba , nucl . instrum .",
    "methods * 127 * ( 1975 ) , 261 . j.  morales , j.  navarro , m.  pl , j.a .",
    "villar , nucl .",
    "methods * 184 * ( 1981 ) , 509 .",
    "a.  robertson , w.v .",
    "prestwich , t.j .",
    "kennet , nucl .",
    "methods * 100 * ( 1972 ) , 317 .",
    "mariscotti , nucl .",
    "methods * 50 * ( 1967 ) , 309 .",
    "routti , s.g .",
    "prussin , nucl .",
    "methods * 72 * ( 1969 ) , 125 .",
    ".  giftcioglu , nucl .",
    "methods * 174 * ( 1980 ) , 209 .",
    "slavi , s.p .",
    "bingulac , nucl .",
    "methods * 84 * ( 1970 ) , 261 .",
    "phillips , nucl . instrum .",
    "methods * 153 * ( 1978 ) , 449 .",
    "mcnelles , j.l .",
    "campbell , nucl .",
    "methods * 127 * ( 1975 ) , 73 . y.  takeda , m.  kitamura , k.  kawase , k.  sugijama , nucl . instrum .",
    "methods * 136 * ( 1976 ) , 369 .",
    "jorch , j.l .",
    "campbell , nucl .",
    "methods * 143 * ( 1977 ) , 551 .",
    "a.  dupont , g.  giordano , p.  mandrow , m.  niel , nucl .",
    "methods * 151 * ( 1978 ) , 233 .",
    "campbell , h.h .",
    "jorch , nucl .",
    "methods * 159 * ( 1979 ) , 163 . r.g .",
    "helmer , m.a .",
    "lee , nucl .",
    "methods * 178 * ( 1980 ) , 499 .",
    ".  giftcioglu , nucl .",
    "methods * 198 * ( 1982 ) , 391 .",
    "blok , j.c .",
    "de lange , j.w .",
    "schotman , nucl .",
    "methods * 128 * ( 1975 ) , 545 .",
    "rev . * d6 * ( 1972 ) 1988 . v.i .",
    "romanovskii , discrete markov chains , moscow , gostechizdat , 1949 ( in russian ) .",
    "w.  feller , an introduction in probability theory and its applications , vol.1 , new york , wiley , 1966 .",
    "w.  zimmermann , rev .",
    "* 32 * ( 1961 ) , 1063 .",
    "u.  abbondanno , a.  boiti , f.  demanics , m.r .",
    "malisan , nucl .",
    "methods * 148 * ( 1978 ) , 577 .",
    "u.  abbondanno , a.  boiti , f.  demanics , nucl .",
    "methods * 142 * ( 1977 ) , 605 .",
    "balian , n.w .",
    "eddy , nucl .",
    "methods * 145 * ( 1977 ) , 389 .",
    "misra , n.w .",
    "eddy , nucl .",
    "methods * 166 * ( 1979 ) , 537 . t.  sekine , h.  baba , nucl . instrum .",
    "methods * 133 * ( 1976 ) , 171 . h.  baba , t.  sekine , nucl . instrum .",
    "methods * 151 * ( 1978 ) , 347 .",
    "p.m.  beschastnov , v.b .",
    "golubev , e.a .",
    "pyata et al . , nucl .",
    "methods * a342 * ( 1994 ) , 477 .",
    "bukin , s.i .",
    "dolinskii , v.p .",
    "druzhinin et al . ,",
    "* 56 * ( 1993 ) , 75 .",
    "fig.1  invariant probability distribution u(i ) for single gaussian peak , m=3 ."
  ],
  "abstract_text": [
    "<S> a new , `` quantum mechanical '' algorithm is proposed for automatic photopeak location in gamma - ray spectra from semiconductor and scintillator detectors .    -48pt </S>"
  ]
}