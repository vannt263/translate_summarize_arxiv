{
  "article_text": [
    "semi - markov processes ( smp ) are a wide class of stochastic processes which generalize at the same time both markov chains and renewal processes .",
    "the main advantage of smp is that they allow the use of whatever type of waiting time distribution for modeling the time to have a transition from one state to another one . on the contrary ,",
    "markovian models have constraints on the distribution of the waiting times in the states which should be necessarily represented by memoryless distributions ( exponential or geometric for continuous and discrete time cases respectively ) .",
    "this major flexibility has a price to pay : the parameters to be estimated are more numerous .",
    "+ semi - markov processes generalizes also non - markovian models based on continuous time random walks used extensively in the econophysics community , see for example @xcite .",
    "smp have been used to analyze financial data and to describe different problems ranging from credit rating data modeling @xcite to the pricing of options @xcite .    with the financial industry becoming fully computerized ,",
    "the amount of recorded data , from daily close all the way down to tick - by - tick level , has exploded .",
    "nowadays , such tick - by - tick high - frequency data are readily available for practitioners and researchers alike @xcite .",
    "it seemed then natural to us trying to verify the semi - markov hypothesis of returns on high - frequency data , see @xcite . in that paper",
    "we proposed a semi - markov model showing its ability to reproduce some stylized empirical facts such for example the absence of autocorrelations in returns and the gain / loss asymmetry . in that paper",
    "we showed also that the autocorrelation in the square of returns is higher with respect to the markov model .",
    "unfortunately this autocorrelation was still too small compared to the empirical one .    in order to overcome the problem of low autocorrelation , in this paper we propose an indexed semi - markov model for price return .",
    "more precisely we assume that the intraday returns ( up to one minute frequency ) are described by a discrete time homogeneous semi - markov process .",
    "we introduce a memory index which takes into account the periods of different volatility in the market .",
    "it is well known that the market volatility is autocorrelated , then periods of high ( low ) volatility may persist for long time .",
    "we make the hypothesis that the kernel of the semi - markov process do depend on which level of volatility the market is at that time .    to check whether our hypothesis describes real data we analyzed high frequency data from the italian stock market . by monte carlo simulations we generated synthetic time series of returns by using the semi - markov kernel estimated from real data .",
    "we showed that the synthetic time series are able to reproduce the autocorrelation of the square of returns as observed for the real time series .",
    "we stress the fact that we model returns which are uncorrelated and we obtained correlation in the square of returns .",
    "our approach is different from other models like the garch family where the volatility is modeled directly as an autocorrelated process .",
    "the database used for the analysis is made of high frequency tick - by - tick price data from all the stock in italian stock market from first of january 2007 until end of december 2010 . from prices",
    "we then define returns at one minute frequency .",
    "the plan of the paper is as follows . in section 2",
    "we define the semi - markov model with memory and we show how to compute its transition probabilities . in section 3 , we present the empirical results deriving from the application of our model to real stock market data . finally , in section 4 we present our conclusion .",
    "in this section we propose a generalization of the semi - markov process that is able to represent higher - order dependencies between successive observations of a state variable .",
    "one way to increase the memory of the process is by using high - order semi - markov processes as defined in @xcite .",
    "here we propose a more parsimonious model having the objective of defining a new model that appropriately describes empirical regularities of financial time series . to this end",
    "we extend the model proposed in reference @xcite allowing the possibility of reproducing long - term dependence in the square of stock returns .",
    "let @xmath0 be a probability space and consider the stochastic process @xmath1 with a finite state space @xmath2 . in our framework",
    "the random variable @xmath3 describes the price return process at the @xmath4-th transition .",
    "+ let us consider the stochastic process @xmath5 with values in @xmath6 .",
    "the random variable @xmath7 describes the time in which the @xmath4-th transition of the price return process occurs .",
    "+ let us consider also the stochastic process @xmath8 with values in @xmath6 .",
    "the random variable @xmath9 describes the value of the index process at the @xmath4-th transition .",
    "+ in reference @xcite the process @xmath10 was defined as a reward accumulation process linked to the markov renewal process @xmath11 . in this paper",
    "we introduce a different index process @xmath12 that is defined as follows : @xmath13 where @xmath14 is a borel measurable bounded function and @xmath15 are known and non - random .",
    "+ the process @xmath12 can be interpreted as a moving average of the accumulated reward process with the function @xmath16 as a measure of the rate of reward per unit time .",
    "+ the function @xmath16 depends on the state of the system @xmath17 and on the time @xmath18 .    as an example you can think of the case in which @xmath19 and @xmath20 . in this simple case we have",
    "that : @xmath21 which expresses a moving average of order @xmath22 executed on the series of the square of returns with weights given by the fractions @xmath23 it should be noted that the order of the moving average is on the number of transitions . as a consequence ,",
    "the moving average is executed on time windows of variable length . + to construct an indexed model we have to specify a dependence structure between the variables . toward this end",
    "we adopt the following assumption : @xmath24\\\\ & = p[j_{n+1}=j,\\ : t_{n+1}-t_{n}\\leq t |j_{n}=i , u_{n}^{m}=v]:=q_{ij}^{m}(v;t ) , \\end{aligned}\\ ] ] where @xmath25 is the natural filtration of the three - variate process .",
    "+ the matrix of functions @xmath26 has a fundamental role in the theory we are going to expose . in recognition of its importance",
    ", we call it @xmath27 @xmath28 . + the joint process @xmath29 , which is embedded in the indexed semi - markov kernel , depends on the moving average process @xmath12 , the latter acts as a stochastic index . moreover , the index process @xmath12 depends on @xmath29 through the functional relationship @xmath30 .",
    "+ to describe the behavior of our model at whatever time @xmath31 we need to define additional stochastic processes . + given the three - dimensional process @xmath32 and the indexed semi - markov kernel @xmath33 , we define by @xmath34 where @xmath35 and @xmath36 .",
    "+ the stochastic processes defined in @xmath37 represent the number of transitions up to time @xmath31 , the state of the system ( price return ) at time @xmath31 and the value of the index process ( moving average of function of price return ) up to @xmath31 , respectively .",
    "we refer to @xmath38 as an indexed semi - markov process .",
    "+ the process @xmath39 is a generalization of the process @xmath12 where time @xmath31 can be a transition or a waiting time .",
    "it is simple to realize that if @xmath40 , if @xmath41 we have that @xmath42 .",
    "+ let @xmath43.\\ ] ] be the transition probabilities of the embedded indexed markov chain .",
    "it denotes the probability that the next transition is in state @xmath44 given that at current time the process entered in state @xmath45 and the index process is @xmath46 .",
    "it is simple to realize that @xmath47 let @xmath48 be the sojourn time cumulative distribution in state @xmath49 : @xmath50= \\sum_{j\\in e}q_{ij}^{m}(v;t).\\ ] ] it expresses the probability to make a transition from state @xmath45 with sojourn time less or equal to @xmath31 given the indexed process is @xmath46 .",
    "+ the conditional waiting time distribution function @xmath51 expresses the following probability : @xmath52.\\ ] ] it is simple to establish that @xmath53 to properly assess the probabilistic behavior of the system , we introduce the transition probability function : @xmath54 .",
    "\\end{aligned}\\ ] ] in next proposition we show that the transition probability function of our indexed semi - markov process satisfies a renewal - type equation .",
    "this is an important point because the proposition clearly indicates the mathematical apparatus needed to extend the theoretical investigation of the model .",
    "anyway , the reader can safely skip the proof because the empirical results , illustrated in next section , are obtained via simulation techniques .",
    "+ before we present a lemma which is a required step in the proof of the proposition .",
    "+ for simplicity of notation set @xmath55 hereafter .",
    "[ lemma1 ] for all states @xmath56 , for all times @xmath57 and for any value @xmath58 it results that : @xmath59\\\\ & = e\\bigg[1_{\\{t_{1}\\leq t , j_{n(t_{1})}\\in e\\}}\\cdot\\\\ & p[z(t)=j , u^{m}(t)\\leq v |t_{1 } , j_{n(t_{1})},j_{0}=i_{0}, ... ,j_{-(m+1)}=i_{-(m+1)},t_{0}=0, ... ,t_{-(m+1)}=t_{-(m+1)}]\\bigg ] .",
    "\\end{aligned}\\ ] ]    * proof * first of all we remember a property of the conditional expectation .",
    "let @xmath60 be a random variable and let @xmath61 be an event , then @xmath62=p[a].\\ ] ] a direct application of this property together with the fact that the events @xmath63 are a set of pairwise disjoint events whose union is the entire sample space , produces @xmath64\\\\ & = e\\bigg[p[z(t)=j , u^{m}(t)\\leq v , t_{1}\\leq t , j_{n(t_{1})}\\in e |t_{1 } , j_{n(t_{1})},j_{0}=i_{0}, ... ,j_{-(m+1)}=i_{-(m+1)},\\\\ & \\,\\,,t_{0}=0, ... ,t_{-(m+1)}=t_{-(m+1)}]\\bigg]\\\\ & = e\\bigg[1_{\\{t_{1}\\leq t , j_{n(t_{1})}\\in e\\}}\\cdot\\\\ & p[z(t)=j , u^{m}(t)\\leq v |t_{1 } , j_{n(t_{1})},j_{0}=i_{0}, ... ,j_{-(m+1)}=i_{-(m+1)},t_{0}=0, ... ,t_{-(m+1)}=t_{-(m+1)}]\\bigg ] . \\end{aligned}\\ ] ]    [ prop ] the probabilities @xmath65 verify the following equation : @xmath66    * proof * first of all let us compute the value of the index process @xmath67 given the information set @xmath68 .",
    "because @xmath69 is a transition time , we have that @xmath70 .",
    "moreover @xmath71 and @xmath72 @xmath73 .",
    "then , we have that @xmath74 now , being the events @xmath75 and @xmath76 disjoint , it follows that @xmath77\\\\ & = p[z(t)=j , u^{m}(t)\\leq v , t_{1 } >",
    "t|j_{0}=i_{0}, ... ,j_{-(m+1)}=i_{-(m+1)},t_{0}=0, ... ,t_{-(m+1)}=t_{-(m+1)}]\\\\ & + p[z(t)=j , u^{m}(t)\\leq v , t_{1}\\leq t|j_{0}=i_{0}, ... ,j_{-(m+1)}=i_{-(m+1)},t_{0}=0, ... ,t_{-(m+1)}=t_{-(m+1 ) } ] . \\end{aligned}\\ ] ] observe that @xmath78\\\\ & = p[t_{1 } > t|j_{0}=i_{0}, ... ,j_{-(m+1)}=i_{-(m+1)},t_{0}=0, ... ,t_{-(m+1)}=t_{-(m+1)}]\\\\ & \\cdot p[z(t)=j , u^{m}(t)\\leq v | t_{1 } > t , j_{0}=i_{0}, ... ,j_{-(m+1)}=i_{-(m+1)},t_{0}=0, ... ,t_{-(m+1)}=t_{-(m+1 ) } ] .",
    "\\end{aligned}\\ ] ] the first factor on the right hand side of @xmath79 is @xmath80=1-h_{i_{0}}(u^{m}(0);t)\\\\ & = 1-h_{i_{0}}^{m}\\big(\\frac{1}{-t_{-m-1}}\\sum_{k=0}^{m}\\int_{t_{-k-1}}^{t_{-k}}f(i_{-k-1},s)ds;t\\big ) . \\end{aligned}\\ ] ] the second factor on the right hand side of @xmath79 is @xmath81\\\\ & = p[u^{m}(t)\\leq v |z(t)=j , t_{1 } > t , j_{0}=i_{0}, ... ,j_{-(m+1)}=i_{-(m+1)},t_{0}=0, ... ,t_{-(m+1)}=t_{-(m+1)}]\\\\ & \\cdot p[z(t)=j| t_{1 } > t , j_{0}=i_{0}, ... ,j_{-(m+1)}=i_{-(m+1)},t_{0}=0, ... ,t_{-(m+1)}=t_{-(m+1 ) } ] . \\end{aligned}\\ ] ] now , observe that , @xmath82 means that the time of next transition exceeds @xmath31 and , therefore , up to @xmath31 the process remains in state @xmath83 .",
    "consequently , @xmath84=\\delta_{i_{0}j}.\\ ] ] moreover , because @xmath85 we have that @xmath86 and consequently @xmath87 since @xmath82 , we have that @xmath88 and by substitution we get in @xmath89 .",
    "finally , @xmath90 and @xmath91 , for all @xmath92 , produces @xmath93 in formula @xmath94 we computed the value of the @xmath39 process given the information set @xmath95 ; this proves that the random variable @xmath39 is @xmath96-measurable .",
    "+ by using the properties of the indicator function we have that : @xmath97\\\\ & = e[1_{\\{u^{m}(t)\\leq v\\}}|z(t)=j , t_{1 } > t , j_{0}=i_{0}, ... ,j_{-(m+1)}=i_{-(m+1)},t_{0}=0, ... ,t_{-(m+1)}=t_{-(m+1 ) } ] .",
    "\\end{aligned}\\ ] ] to evaluate the expectation in formula @xmath98 , note again that the conditions @xmath99 are only compatible for @xmath100 , then the value of the process @xmath39 is that expressed in formula @xmath94",
    ". then we can express @xmath98 as follows : @xmath101\\\\ & = 1_{\\big\\{\\frac{1}{t - t_{-m}}\\sum_{k=1}^{m}\\big(\\int_{0}^{t}f(i_{0},s)ds + \\int_{t_{-k}}^{t\\wedge t_{1-k}}f(i_{-k},s)ds\\big)\\leq v \\big\\}}. \\end{aligned}\\ ] ] now let us consider the computation of the second addend on the right hand side of formula @xmath102 . by lemma @xmath103 we know that @xmath104\\\\ & = e\\big[1_{\\{t_{1}\\leq t , j_{n(t_{1})}\\in e\\}}\\cdot\\\\ & p[z(t)=j , u^{m}(t)\\leq v |t_{1 } , j_{n(t_{1})},j_{0}=i_{0},",
    "... ,j_{-(m+1)}=i_{-(m+1)},t_{0}=0, ... ,t_{-(m+1)}=t_{-(m+1)}]\\big ] . \\end{aligned}\\ ] ] because the random variable @xmath67 is @xmath105-measurable , see formula @xmath106 , then formula @xmath107 is equivalent to formula @xmath108 @xmath109\\bigg ] .",
    "\\end{aligned}\\ ] ] now observe that @xmath110\\\\ & = p[t_{1}\\in ( \\tau , \\tau + d\\tau ) , j_{n(t_{1})}=s|u^{m}(0)=\\frac{1}{-t_{-m-1}}\\sum_{k=0}^{m}\\int_{t_{-k-1}}^{t_{-k}}f(i_{-k-1},s)ds , j_{0}=i_{0}]\\\\ & = q_{i_{0}\\,s}^{m}\\bigg(\\frac{1}{-t_{-m-1}}\\sum_{k=0}^{m}\\int_{t_{-k-1}}^{t_{-k}}f(i_{-k-1},s)ds ; d\\tau \\bigg ) .",
    "\\end{aligned}\\ ] ] moreover notice that @xmath111\\\\ & = p[z(t)=j , u^{m}(t)\\leq v|t_{1 } , j_{n(t_{1})},j_{0}=i_{0}, ... ,j_{-m}=i_{-m},t_{0}=0, ...",
    ",t_{-m}=t_{-m}]\\\\ & = \\phi_{(i_{-m}, ... ,i_{0},j_{n(t_{1})};j)}^{m}(t_{-m}, ... ,0,t_{1 } ; t - t_{1},v ) .",
    "\\end{aligned}\\ ] ] then , after an integration over the possible values of @xmath112 $ ] and a summation over the values of @xmath113 , formula @xmath107 becomes equal to @xmath114 a substitution in @xmath102 completes the proof .",
    "+ proposition @xmath115 gives a renewal - type equation for transition probabilities and represents a generalization of the evolution equation for transition probabilities of the semi - markov process .",
    "equation @xmath116 could be used for asymptotic analysis in order to obtain explicit representation of the autocorrelation function .",
    "moreover the numerical solution of equation @xmath116 , based on quadrature formulas , could represent an alternative to the simulative approach used in the next section .",
    "to check the validity of our model we perform a comparison of the behavior of real data returns and returns generated through monte carlo simulations based on the model . in this section we describe the database of real data used for the analysis , the method used to simulate synthetic returns time series and , at the end , we compare results from real and simulated data .      the data we used in this work are tick - by - tick quotes of indexes and stocks downloaded from @xmath117 for the period january 2007-december 2010 ( 4 full years ) .",
    "the data have been re - sampled to have 1 minute frequency .",
    "consider a single day ( say day @xmath92 with @xmath118 ) where @xmath119 is number of traded days in the time series . in our case",
    "we consider four years of trading ( from the first of january 2007 corresponding to @xmath120 ) .",
    "the market in italy fixes the opening price at a random time in the first minute after 9 am , continuous trading starts immediately after and ends just before 5.25 pm , finally the closing price is fixed just after 5.30 pm .",
    "therefore , let us define @xmath121 as the price of the last trading before 9.01.00 am , @xmath122 as the price of the last trading before 9.02.00 am and so on until @xmath123 as the price of the last trading before 5.25.00 pm .",
    "if there are no transactions in the minute , the price remains unchanged ( even in the case the title is suspended and reopened in the same day ) .",
    "also define @xmath124 as the opening price and @xmath123 as the closing price . with this choice @xmath125 .",
    "there was a small difference before the 28th of september 2009 since continuous trading started at 9,05 am , and therefore prior of that date we have @xmath126 . finally , if the title has a delay in opening or it closes in advance ( suspended but not reopened ) , only the effective trading minutes are taken into account . in this case",
    "@xmath4 will be smaller than 507 .",
    "the number of returns analyzed is then roughly 508000 for each stock .",
    "we analyzed all the stocks in the ftsemib which are the 40 most capitalized stocks in the italian stock market .    to be able to model returns as a semi - markov process",
    "the state space has to be discretized . in the example shown in this work we discretized returns into 5 states chosen to be symmetrical with respect to returns equal zero .",
    "returns are in fact already discretized in real data due to the discretization of stock prices which is fixed by each stock exchange and depends on the value of the stock .",
    "just to make an example , in the italian stock market for stocks with value between 5.0001 and 10 euros the minimum variation is fixed to 0.005 euros ( usually called tick ) .",
    "we then tried to remain as much as possible close to this discretization . in figure [ tra ]",
    "we show an example of the number of transition from state @xmath45 to all other states for the embedded markov chain .          in the model described in the previous section and in particular in the definition of the index process @xmath127 the function",
    "@xmath14 is any borel measurable bounded function . to perform simulations",
    ", we choose a function which is both motivated by simplicity ( we want to keep the model as simple as possible ) and by real market behavior .",
    "let us briefly remind that volatility of real market is long range positively autocorrelated and then clustered in time .",
    "this implies that , in the stock market , there are periods of high and low volatility .",
    "motivated by this empirical facts we suppose that also the transition probabilities depends on whether the market is in a high volatility period or in a low one .",
    "we then fixed the function @xmath16 to be the square of returns and the index @xmath127 to be a moving average of this values as described in the example given in eq .",
    "[ exa ] but with different values of the memory @xmath128 .",
    "note that the memory is the number of transitions .",
    "the index @xmath127 obtained from the given definition of @xmath16 was also discretized into 5 states of low , medium low , medium , medium high and high volatility .    according to these choices we estimated , from real data , the probabilities @xmath129 defined in formula ( [ kernel ] ) for different values of @xmath128 .",
    "for the results shown below @xmath128 was chosen to run from 5 to 200 transitions with a step of 5 .",
    "then , this probabilities have been used to simulate synthetic time series of returns needed to compare results from real data and the model as described in the next section .",
    "note that these are step - by - step simulations in which the index @xmath127 has to be calculated from the last @xmath128 simulated transitions .",
    "a very important feature of stock market data is that , while returns are uncorrelated and show an i.i.d . like behavior ,",
    "their square or absolute values are long range correlated .",
    "it is very important that theoretical models of returns do reproduce this features .",
    "we then tested our model to check whether it is able to reproduce such behavior .",
    "given the presence of the parameter @xmath128 in the index function , we also tested the autocorrelation behavior as a function of m.    if @xmath130 indicates returns , the time lagged @xmath131 autocorrelation of the square of returns is defined as    @xmath132    we estimated @xmath133 for real data and for returns time series simulated with different values of the memory @xmath128 .",
    "the time lag @xmath134 was made to run from 1 minute up to 100 minutes .",
    "note that to be able to compare results for @xmath133 each simulated time series was generated with the same length as real data .",
    "results for few values of @xmath128 , for real data and for a semi - markov model without index are shown in figure [ fig1 ] .",
    "as expected , real data do show a long range correlation of volatility let us than analyze results for the synthetic time series .",
    "the simple semi - markov model starts at the same value but the persistence is very short and after few time steps the autocorrelation decrease to zero .",
    "a very interesting behavior is instead shown by the semi - markov models with memory index . if a small memory ( @xmath135 in the shown example ) is used , the autocorrelation is already persistent but again decreases faster than real data . with a longer memory ( @xmath136 )",
    "the autocorrelation remain high for a very long period and also its value is very close to that of real data . if @xmath128 is increased further the autocorrelation drops again to small values .",
    "this behavior suggest the existence of an optimal memory @xmath128 . in our opinion",
    "one can justify this behavior by saying that short memories are not enough to identify in which volatility status is the market , too long memories mix together different status and then much of the information is lost in the average .",
    "all this is shown in figure [ fig2 ] where the mean square error between each autocorrelation function of simulated time series and the autocorrelation function of the real data as a function of @xmath128 is computed .",
    "it can be noticed that there exist an optimal value of the memory @xmath128 that makes the autocorrelation of simulated data closer to that of real data .",
    "we have modeled financial price changes through a semi - markov model where we have added a memory index .",
    "our work is motivated by two main results : the existence in the market of periods of low and high volatility and our previous work @xcite , where we showed that the semi - markov model , even if more realistic than a simple markov model , is not able to capture all the correlation in the square of returns present in real data .",
    "the results presented here show that the semi - markov kernel is influenced by the past volatility .",
    "in fact , if the past volatility is used as a memory index , the model is able to reproduce quite well the behavior of market returns : the returns generated by the model are uncorrelated while the square of returns present a long range correlation very similar to that of real data .",
    "we have also shown that the time length of the memory does play a crucial role in reproducing the right autocorrelation s persistence indicating the existence of an optimal value .",
    "we stress that out model is very different from those of the arch / garch family .",
    "we do not model directly the volatility as a correlated process .",
    "we model returns and by considering the semi - markov kernel conditioned by a memory index the volatility correlation comes out freely .",
    "we are very grateful to maurizio serva , raimondo manca and giuseppe di biase for helpful discussion .",
    "we also thank an anonymous referee for his precious comments .",
    "99                d.m .",
    "guillaume , m.m .",
    "dacorogna , r.r .",
    "davve , j.a .",
    "mwuller , r.b .",
    "olsen , o.v .",
    "pictet . _ from the birds eye to the microscope : a survey of new stylized facts of the intra - daily foreign exchange markets _ , finance and stochastics * 1 * , ( 1997 ) , 95 - 129 ."
  ],
  "abstract_text": [
    "<S> we study the high frequency price dynamics of traded stocks by a model of returns using a semi - markov approach . </S>",
    "<S> more precisely we assume that the intraday returns are described by a discrete time homogeneous semi - markov which depends also on a memory index . </S>",
    "<S> the index is introduced to take into account periods of high and low volatility in the market . </S>",
    "<S> first of all we derive the equations governing the process and then theoretical results are compared with empirical findings from real data . </S>",
    "<S> in particular we analyzed high frequency data from the italian stock market from first of january 2007 until end of december 2010 . </S>"
  ]
}