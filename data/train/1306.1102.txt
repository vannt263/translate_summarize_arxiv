{
  "article_text": [
    "for regular graphs , we have @xmath107 thus @xmath108 for the orthogonality of the eigenvector @xmath109 with respect to the vector @xmath12 , and eqs.(2 ) and ( 3 ) of the main text reduce to @xmath110 and @xmath111    consider the eigenvalue @xmath112 ( which corresponds to the principal eigenvalue of the modularity matrix in the case of detectable communities , as proved in the main text ) . the only term on the l.h.s . of eq .",
    "( [ eq1 ] ) that depends on @xmath29 is @xmath113 , while the only term that depends on @xmath30 is @xmath114 .",
    "this means that eq .",
    "( [ eq1 ] ) can be decoupled in two equations @xmath115 similarly , eq .  ( [ eq2 ] ) leads to @xmath116 since the subgraphs encoded by the adjacency matrices @xmath3 and @xmath4 are regular graphs with valency @xmath29 , this means that @xmath117 and @xmath118 , with @xmath37 and @xmath38 suitable normalization constants .",
    "the same consideration is valid also for the subgraph encoded by the adjacency matrix @xmath119 which is still a regular graph ( with valency @xmath30 in this case ) and thus eq .  ( [ eq1a ] ) and ( [ eq2a ] ) consistently lead to the same solutions @xmath117 and @xmath118 .",
    "since the eigenvector @xmath120 is orthogonal to the vector @xmath12 ( i.e , @xmath121 ) and properly normalized ( i.e. , @xmath122 ) , one finally finds that @xmath123 .",
    "[ [ numerical - estimation - of - the - principal - eigenpair - of - the - modularity - matrix - for - lfr - benchmark - graphs ] ] numerical estimation of the principal eigenpair of the modularity matrix for lfr benchmark graphs ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~"
  ],
  "abstract_text": [
    "<S> communities are fundamental entities for the characterization of the structure of real networks . </S>",
    "<S> the standard approach to the identification of communities in networks is based on the optimization of a quality function known as `` modularity '' . </S>",
    "<S> although modularity has been at the center of an intense research activity and many methods for its maximization have been proposed , not much it is yet known about the necessary conditions that communities need to satisfy in order to be detectable with modularity maximization methods . here </S>",
    "<S> , we develop a simple theory to establish these conditions , and we successfully apply it to various classes of network models . </S>",
    "<S> our main result is that heterogeneity in the degree distribution helps modularity to correctly recover the community structure of a network and that , in the realistic case of scale - free networks with degree exponent @xmath0 , modularity is always able to detect the presence of communities .    </S>",
    "<S> communities are organizational modules that provide a coarse grained view of a complex network  @xcite . depending on the nature of the network </S>",
    "<S> , communities can have different yet fundamental meanings : in biological networks , communities are likely to group entities having the same biological function  @xcite , in the graph of the world wide web they may correspond to groups of pages dealing with the same or related topics  @xcite , in food webs they may identify compartments  @xcite , etc . since communities play an important role for the characterization of the structure of networks , the development of computer algorithms for the detection of communities in networks represents one of the most active areas in network science  @xcite . </S>",
    "<S> in particular , the use of the so - called `` modularity '' has attracted a great attention in recent years  @xcite . </S>",
    "<S> modularity is a quality function that estimates the relevance of a given network partition ( i.e. , a division of the network in a given set of communities ) by comparing the observed number of internal connections of the communities with the expected number of such edges in a random annealed version of the network . </S>",
    "<S> the best community division of the network is then given by the partition that maximizes the modularity function . </S>",
    "<S> + although subjected to some intrinsic limitations  @xcite , modularity has become a standard tool for community detection and several methods for modularity maximization have been developed  @xcite . in this paper , we focus our attention on spectral optimization of the modularity function , i.e. , a maximization method that is essentially based on the determination of the principal eigenpair of the so - called modularity matrix  @xcite . </S>",
    "<S> this represents a way to approximate the configuration corresponding to the maximum of the modularity function , whose determination would be otherwise a np complete problem  @xcite , by relaxing the indices that assign the nodes to the various communities from integer to real valued numbers . </S>",
    "<S> this method provides in general solutions that are consistent with those obtained by other more sophisticated maximization techniques  @xcite , thus the following results can be reasonably considered as valid for any type of community detection algorithm based on modularity maximization .    </S>",
    "<S> we consider here the simple case of a symmetric and weighted network formed only by @xmath1 communities of size @xmath2 . </S>",
    "<S> the adjacency matrices that contain the information about the internal structure of these two groups are denoted respectively with @xmath3 and @xmath4 , while the connections among nodes of different groups are listed in the matrix @xmath5 . </S>",
    "<S> the adjacency matrix of the entire network can be thus written in the following block form @xmath6    according to the definition of the modularity function , in the random annealed version of the network , which preserves on average the node degrees , the probability that two nodes are connected is proportional to the product of the degrees of the two nodes  @xcite . </S>",
    "<S> the entire information of this null model is contained in the square matrix @xmath7 where @xmath8 is the strength vector of the @xmath9-th group , with @xmath10 equal to a vector whose components are equal to the sum of the weights of all edges connecting nodes of the @xmath9-th group to nodes of the @xmath11-th group , and @xmath12 is the vector whose components are all equal to one .    </S>",
    "<S> let us focus our attention on the spectrum of the modularity matrix @xmath13  @xcite . </S>",
    "<S> note that by definition @xmath14 , where @xmath15 is the vector with all components equal to zero , thus any other eigenvector @xmath16 of the modularity matrix @xmath17 , i.e. , @xmath18 , must be orthogonal to the vector @xmath12 . </S>",
    "<S> we can rewrite the eigenvector @xmath19 , where @xmath20 is the part of the eigenvector @xmath16 that corresponds to the @xmath9-th group . </S>",
    "<S> the orthogonality with respect to the eigenvector @xmath12 reads @xmath21 , while the normality of the eigenvector means that @xmath22 . </S>",
    "<S> the eigenvalue problem becomes equivalent to @xmath23 and @xmath24 if we multiply them for @xmath25 , and then take their difference , we obtain    @xmath26    where we have defined @xmath27 . for simplicity , in the following we will consider only cases in which @xmath28 , i.e. , cases in which both groups have a comparable total number of edges .    </S>",
    "<S> , with average internal degree @xmath29 and average external degree @xmath30 such that @xmath31 . </S>",
    "<S> we plot here only the components of one of the two modules , but analogous results ( with opposite sign ) are valid for the other module . </S>",
    "<S> different colors and symbols correspond to different combinations of @xmath29 and @xmath30 . </S>",
    "<S> * b * correlation coefficient between the eigenvector components and the difference between internal and external degrees as a function of @xmath32 . </S>",
    "<S> while the correlation coefficient is not significant in the region in which communities are not detectable [ i.e. , @xmath33 , see eq .  </S>",
    "<S> ( [ eq : poisson_t ] ) ] , it becomes significant in the detectability regime ( i.e. , @xmath34).,scaledwidth=45.0% ]    we define the detectability regime as the regime in which the two pre - imposed communities can be detected by means of modularity spectral optimization . </S>",
    "<S> this regime is characterized by the fact that the components of the principal eigenvector corresponding to the nodes of one of the modules have coherent signs , while the two portions of the eigenvector corresponding to different groups are opposite in sign  @xcite . </S>",
    "<S> if we suppose that these modules are uncorrelated graphs ( i.e. , without further internal sub - community structure ) with prescribed in- and out - strength vectors , we expect that this eigenvector is such that @xmath35 and @xmath36 where @xmath37 and @xmath38 are proportionality constants , while @xmath39 and @xmath40 are respectively the vectors whose entries are given by the difference of the in- and out - strengths of the nodes in the groups 1 and 2 . </S>",
    "<S> eqs .  </S>",
    "<S> ( [ eq : prop1 ] ) and  ( [ eq : prop2 ] ) simply state that the coordinates of @xmath41 and @xmath42 are linearly proportional to the difference of the in- and out- strength vectors , a solution that appears natural if we interpret the modularity function as the stationary solution of a random walk between the two communities  @xcite . </S>",
    "<S> this conjecture is indeed perfectly verified in numerical estimations of the largest eigenvector of the modularity matrix ( see figs .  [ fig1],s1 and s2 ) , and thus eqs .  </S>",
    "<S> ( [ eq : prop1 ] ) and  ( [ eq : prop2 ] ) can be used as a reasonable ansazt for the solution of our problem . if we finally insert eqs .  </S>",
    "<S> ( [ eq : prop1 ] ) and  ( [ eq : prop2 ] ) into eq .  </S>",
    "<S> ( [ eq : diff ] ) , we can give an estimate of the largest eigenvalue @xmath43 of the modularity matrix in the regime of detectable communities , and write @xmath44 where we have used the orthogonality condition @xmath45 , which leads to @xmath46 . </S>",
    "<S> note that expression eq .  </S>",
    "<S> ( [ eq : approx ] ) is valid for given strength vectors . </S>",
    "<S> if we instead assume that the entries of these vectors are random variates obeying the statistical distributions @xmath47 and @xmath48 , we can write @xmath49 where @xmath50 and @xmath51 are respectively the first and the second moments of the distribution @xmath52 . </S>",
    "<S> it is important to stress that eqs .  </S>",
    "<S> ( [ eq : approx ] ) and  ( [ eq : ensemble ] ) give us an estimate of the largest eigenvalue of @xmath17 only in the detectability regime . </S>",
    "<S> if the structure of the entire graph is instead such that the two modules are not detectable by means of modularity maximization , there will another principal eigenvector orthogonal to the previous one , and thus not showing the presence of the two modules . since we have supposed that both modules are randomly generated graphs , the other eigenvalue that is competing with @xmath43 for being the highest eigenvalue of the modularity matrix is given by the second largest eigenvalue of the annealed random network associated to @xmath17  @xcite . in intuitive terms , this means that , in the regime in which the groups are undetectable , the signal present in @xmath53 is not sufficiently high , and @xmath17 is in spectral terms indistinguishable from @xmath54 . in the following , we will consider some examples of network ensembles where both these eigenvalues can be analytically estimated , and thus the detectability problem can be explicitly solved .    _ regular graphs_. in this case , each node has exactly @xmath29 random connections with other nodes in its group , and @xmath30 random connections outside its own group . </S>",
    "<S> eq .  </S>",
    "<S> ( [ eq : diff ] ) reduces to @xmath55 thus either ( i ) @xmath56 and @xmath57 , or ( ii ) @xmath58 , @xmath59 and @xmath60 . in case ( ii ) </S>",
    "<S> , one can also prove that the only possible solution is @xmath61 and @xmath62 ( see supplemental material ) . </S>",
    "<S> the same result can be also obtained using eq .  </S>",
    "<S> ( [ eq : ensemble ] ) that reduces to eq .  </S>",
    "<S> ( [ eq : regular ] ) by setting @xmath63 . </S>",
    "<S> the term of comparison for @xmath43 in the case of regular graphs is given by the second largest eigenvalue of the adjacency matrix of a random regular graph with valency @xmath64 , that is in good approximation equal to @xmath65  @xcite . </S>",
    "<S> eq .  </S>",
    "<S> ( [ eq : regular ] ) tells us that , independently of the system size , the two modules can be either fully detectable or not detectable at all . </S>",
    "<S> the sudden transition between these two regimes happens at the point in which @xmath66 this theoretical prediction is in perfect agreement with the results of the numerical simulations reported in fig .  </S>",
    "<S> [ fig2 ] .     in the case of two random regular graphs ( panels a and b ) and in the case of two poissonian graphs ( panels c and d ) . in both cases </S>",
    "<S> we consider three different network sizes @xmath67 ( blue squares ) , @xmath68 ( red circles ) and @xmath69 ( green triangles ) , and we fix @xmath31 . the results presented here have been obtained by averaging over @xmath70 different realizations of the models . * a * and * c * largest eigenvalue of @xmath17 as a function of @xmath71 . </S>",
    "<S> the full black line corresponds to @xmath71 in panel a , and to eq .  </S>",
    "<S> ( [ eq : poisson ] ) in c. the dashed black lines are given by @xmath72 . </S>",
    "<S> * b * and * d * size independent inner products @xmath73 and @xmath74 as functions of @xmath71 . </S>",
    "<S> , scaledwidth=45.0% ]    _ poissonian networks_. this is the case whose entire spectrum has been analytically determined by nadakuditi and newman  @xcite . </S>",
    "<S> internal degrees in both groups are drawn from a poisson distribution with average @xmath29 , and external degrees are also poissonian variates with average @xmath30 . in this case , the distributions @xmath47 and @xmath48 are two identical skellam distributions , with first moment equal to @xmath75 , and second moment equal to @xmath76  @xcite . </S>",
    "<S> we can reduce eq .  </S>",
    "<S> ( [ eq : ensemble ] ) to @xmath77 this result is identical to the prediction obtained in  @xcite . </S>",
    "<S> the term of comparison for the largest eigenvalue of the modularity matrix is given by the second largest eigenvalue of a random graph with average degree @xmath78 , that is @xmath79  @xcite , and this finally leads to the detectability threshold @xmath80 as already obtained in  @xcite . </S>",
    "<S> the results of numerical simulations perfectly agree with our theoretical prediction ( see fig .  [ fig2 ] ) . </S>",
    "<S> the prediction appears to be not visibly dependent on the system size , and already for small networks eq .  </S>",
    "<S> ( [ eq : poisson_t ] ) represents a very good estimate of the transition point . </S>",
    "<S> we note that , as in the case of regular graphs , for a large portion of the region @xmath81 modularity fails to recover the community structure of the graph . </S>",
    "<S> it is , however , interesting to stress that the detectability threshold is two times smaller than the one registered for regular graphs , and thus the heterogeneity in node degrees seems to enhance the ability of modularity to detect communities .    </S>",
    "<S> _ lfr benchmark graphs_. as a final example , we consider a special case of the benchmark graphs introduced by lancichinetti _ </S>",
    "<S> et al _  </S>",
    "<S> @xcite . </S>",
    "<S> we set @xmath82 and @xmath83 , where the entries of the vector @xmath84 are random variates in the range @xmath85 to @xmath2 taken from a power - law distribution with exponent @xmath86 . </S>",
    "<S> eq .  </S>",
    "<S> ( [ eq : ensemble ] ) becomes @xmath87 where @xmath88 is the riemann zeta function truncated at the @xmath2-th term . the term of comparison for the largest eigenvalue of the modularity matrix is still given by the second largest eigenvalue of the annealed random graph associated with the modularity matrix . </S>",
    "<S> we do not have an exact guess on how this quantity depends on parameters of the network model , but we can use the upper bound of the largest eigenvalue of random scale - free graphs to get more insights . according to the predictions by chung _ </S>",
    "<S> et al _ adapted to the present case , the largest eigenvalue @xmath89 of our random scale - free graphs is equal to the maximum between @xmath90 and @xmath91 , with @xmath92 largest degree in the network  @xcite . in the limit of sufficiently large @xmath2 , we have that : for @xmath0 , the dominating eigenvalue is @xmath93 ; for @xmath94 , the largest eigenvalue is instead @xmath95 . </S>",
    "<S> this has very important implications when compared to our prediction of @xmath43 given in eq .  </S>",
    "<S> ( [ eq : lfr ] ) : ( i ) for @xmath0 , @xmath43 grows as fast as @xmath89 with the system size , thus the detectability threshold should approach zero as @xmath2 increases . </S>",
    "<S> ( ii ) for @xmath96 instead , @xmath89 grows faster than @xmath43 as @xmath2 increases . </S>",
    "<S> the detectability threshold should grow with the system size , and eventually converge to a finite fixed value ( for instance , for @xmath97 we must recover the result valid for the case of regular graphs ) . </S>",
    "<S> + the results of numerical simulations support our thesis ( see fig .  </S>",
    "<S> [ fig3 ] ) . </S>",
    "<S> when we plot @xmath98 as a function of @xmath71 , with @xmath99 and @xmath100 respectively the first and second moments of the strength distribution of the network , we see that when @xmath101 this quantity slowly approaches , as @xmath2 increases , the linear behavior @xmath71 as predicted by eq .  </S>",
    "<S> ( [ eq : lfr ] ) . </S>",
    "<S> this means that , in the limit of infinite large systems , modularity is able to detect the presence of the network blocks for every @xmath81 . </S>",
    "<S> instead , for @xmath94 , the lower part of the curve tends to move away from the linear behavior as the system size grows . </S>",
    "<S> this implies that there will be , also in the limit of infinitely large systems , always a part of the @xmath81 region in which the two blocks are undetectable via modularity maximization .     in the case of two random scale - free graphs with degree exponents @xmath102 ( panels </S>",
    "<S> a and b ) and @xmath103 ( panels c and d ) . in both cases , </S>",
    "<S> we consider several network sizes ranging from @xmath67 to @xmath104 , and we set @xmath31 . the results presented here have been obtained by averaging over @xmath70 different realizations of the models . </S>",
    "<S> to suppress fluctuations , we restricted to the case of networks for which the square of the largest strength is smaller than the sum of all strengths ( i.e. , @xmath105 )  @xcite , although the qualitative outcome does not depend on this choice . for clarity , we placed arrows in the various panels to indicate the direction of increasing @xmath2 . * </S>",
    "<S> a * and * c * largest eigenvalue @xmath43 multiplied by @xmath106 as a function of @xmath71 . </S>",
    "<S> the full black line corresponds to @xmath71 . * </S>",
    "<S> b * and * d * size independent inner products @xmath73 and @xmath74 as functions of @xmath71 . </S>",
    "<S> , scaledwidth=45.0% ]    to summarize , we identified the necessary conditions that communities need to satisfy in order to be detectable by means of modularity maximization . </S>",
    "<S> our results are valid for the case of @xmath1 groups with comparable number of edges , and when the information about the number of such groups is used as ingredient in the maximization of the modularity function . </S>",
    "<S> our main result is that in random network ensembles with pre - imposed community structure , the eigenvector of the modularity matrix that identifies the presence of the block structure is associated with an eigenvalue approximately equal to the ratio between the second and the first moments of the distribution of the difference between internal and external node strengths . </S>",
    "<S> if this eigenvalue is larger than the second largest eigenvalue of the null model associated to the modularity function , then modularity is able to detect such a structure , otherwise not . </S>",
    "<S> this represents a limitation in the case of graphs with homogeneous degrees . increasing the heterogeneity of the network accelerates instead the ability of modularity to recover the correct community structure . for example , adding noise to a regular graph makes the detectability threshold two times smaller . </S>",
    "<S> more importantly , if the heterogeneity of the node degrees is sufficiently high , as in the case of real networked systems , then modularity is always able to detect communities .    </S>",
    "<S> the author thanks a. arenas , r. darst and s. fortunato for helpful discussions on the subject of this article . </S>",
    "<S> the author acknowledges support from the spanish ministerio de ciencia e innovacin through the ramn y cajal program .    </S>",
    "<S> 23 natexlab#1#1bibnamefont # 1#1bibfnamefont # 1#1citenamefont # 1#1url # 1`#1`urlprefix[2]#2 [ 2][]#2    , * </S>",
    "<S> * , ( ) .    </S>",
    "<S> , , , , , * * , ( ) .    , </S>",
    "<S> * * , ( ) .    , </S>",
    "<S> * * , ( ) .    , * * , ( ) .    , </S>",
    "<S> * * , ( ) .    , , , * * , ( ) .    </S>",
    "<S> , , , , * * , ( ) .    , </S>",
    "<S> * * , ( ) .    , * * , ( ) .    , * * , ( ) .    , , </S>",
    "<S> * * , ( ) .    </S>",
    "<S> , , , , , , , * * , ( ) .    , * * , ( ) .    </S>",
    "<S> , * * , ( ) .    , , , ( ) .    , in _ _ </S>",
    "<S> ( , ) , pp . .    , , , , , * * , ( ) .    , </S>",
    "<S> * * , ( ) .    , in _ _ </S>",
    "<S> ( , ) , pp . .    , * * , ( ) .    , , , * * , ( ) .    , , , , </S>",
    "<S> * * , ( ) .    , , , * * ( ) .    </S>",
    "<S> , , , * * , ( ) . </S>"
  ]
}