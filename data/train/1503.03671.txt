{
  "article_text": [
    "in this paper we attack a combinatorial problem previously raised and studied by grinblat in  @xcite .",
    "grinblat s question arose in the study of algebras of sets .",
    "given a nonempty ground set @xmath16 , let @xmath17 denote the power set of @xmath16 .",
    "an _ algebra ( of sets ) _ on @xmath16 is a nonempty family @xmath18 such that : ( 1 ) if @xmath19 then also @xmath20 ; and ( 2 ) if @xmath21 then also @xmath22 .",
    "grinblat investigated necessary and sufficient conditions under which the union of at most countably many algebras on @xmath16 equals @xmath17 .    in this context",
    ", grinblat asks for the smallest integer @xmath0 for which the following holds : `` suppose @xmath1 are @xmath2 algebras on @xmath16 , such that , for each @xmath4 , there exists a collection of at least @xmath5 pairwise disjoint subsets of @xmath16 that are _ not _ in @xmath6",
    ". then there exists a family @xmath23 of @xmath8 pairwise - disjoint subsets of @xmath16 such that , for each @xmath4 and each @xmath24 , if @xmath25 contains one of @xmath26 , @xmath27 and is disjoint from the other , then @xmath28 . ''",
    "grinblat shows that this problem is equivalent to the combinatorial problem presented below .",
    "( the equivalence is quite straightforward if the ground set @xmath16 is finite , but if @xmath16 is infinite then the argument is more delicate .",
    "we refer the reader to  @xcite for more details . )",
    "the combinatorial problem that interests us is the following : let @xmath2 be a positive integer .",
    "let @xmath3 be a finite ground set , and let @xmath1 be @xmath2 equivalence relations on @xmath3 ( or equivalently , partitions of @xmath3 into subsets ) .",
    "if @xmath29 are equivalent under @xmath6 , then we say for short that @xmath30 are @xmath4-equivalent , and we write @xmath31 . the @xmath4-equivalence class of an element @xmath32 is given by @xmath33_i = \\ { b\\in x : a { \\mathrel{\\sim_{i } } } b\\}$ ] .",
    "the _ kernel _ of @xmath6 , denoted @xmath34 , is defined as the set of elements of @xmath3 that are @xmath4-equivalent to some element other than themselves : @xmath35_i\\bigr| > 1 \\bigr\\}.\\ ] ]    ( it will become evident that one can assume without loss of generality that all equivalence classes in each @xmath6 have size at most @xmath36 . )    we shall call a set of @xmath8 _ distinct _ elements @xmath37 a _ rainbow matching _ if @xmath38 for each @xmath4 .",
    "( see e.g.  glebov et al .",
    "@xcite for the term . )",
    "the problem is to find the smallest integer @xmath0 such that , if @xmath39 for all @xmath4 , then @xmath1 have a rainbow matching .",
    "grinblat observed that @xmath40 : if we let all equivalence relations @xmath6 be identical , consisting of @xmath41 equivalence classes of size @xmath36 , then they have no rainbow matching even though @xmath42 .",
    "grinblat also showed that @xmath43 .",
    "the lower bound @xmath44 is illustrated in figure  [ fig_n_3 ] .",
    "grinblat proved in  @xcite that @xmath45 ( he previously announced a slightly weaker bound in  @xcite ) .",
    "he asks whether @xmath13 for all @xmath14 .    in this paper",
    "we improve the upper bound to @xmath15 :    [ thm_bd ] let @xmath1 be @xmath2 equivalence relations with kernels @xmath46 , respectively .",
    "suppose @xmath47 for each @xmath4 , where @xmath48 is a large enough constant",
    ". then @xmath1 have a rainbow matching .",
    "here @xmath49 for all @xmath50 , and yet there is no rainbow matching . ]    as we will see , it is enough to take @xmath51 in theorem  [ thm_bd ] .",
    "we prove theorem  [ thm_bd ] by a modification of grinblat s argument .",
    "the proof follows by induction on the number of equivalence relations @xmath2 , showing that given a rainbow matching ( of @xmath41 pairs ) for the equivalence relations @xmath52 , it is possible to obtain a rainbow matching for @xmath53 .",
    "the proof follows in three main steps , where in each step , we observe that it is either possible to complete a full fledged rainbow matching , or to slightly extend the previous formation at hand .",
    "the final formation , which is the result of the third step , allows us to complete the rainbow matching , concluding the proof .    as mentioned above , we start with a rainbow matching over @xmath52 of the form @xmath54 , where @xmath38 . in the first step ,",
    "we transform the first @xmath55 pairs into a _ track _ of @xmath56 _ components _ of the form @xmath57 , where @xmath58 and @xmath59 ( the choice of indices is without loss of generality , by some renaming of indices ) .",
    "this @xmath60-long track is called @xmath61 and the remaining @xmath62 pairs are called @xmath63 ( see figure  [ fig_train ] ) .",
    "the construction of @xmath61 is inductive , and follows by showing that an @xmath64-long track , for @xmath65 , can be extended .",
    "this is true , since otherwise , there exists a pair @xmath66 that allows us to complete a full fledged rainbow matching .",
    "see lemma  [ lemma_train ] below for the complete argument .    in the second step ,",
    "we consider the elements of @xmath67 and @xmath68 .",
    "specifically , we count the number of such elements that are connected to a component @xmath69 in @xmath61 or to a component @xmath70 in @xmath63 .",
    "we first observe that no such @xmath69 or @xmath70 can account for more than four elements of either @xmath67 and @xmath68 . otherwise , it is not hard to complete a full fledged matching .",
    "we call a component _ heavy _ if it accounts for at least 7 elements in @xmath71 .",
    "we further observe that the existence of @xmath72 heavy components in @xmath61 enables us to complete the desired matching .",
    "we , hence , assume that all but four heavy components appear in @xmath63 .",
    "let @xmath73 be the set of heavy components in @xmath63 .",
    "a simple counting argument yields that @xmath73 is of size at least @xmath74 . assuming that we can not complete a rainbow matching using a single component @xmath69 with @xmath75",
    ", we move on to the following third step .",
    "the third and final step pinpoints a component @xmath76 in @xmath63 , such that there exist @xmath77 with @xmath78 and @xmath79 for many @xmath75 .",
    "furthermore , we prove the existence of two indices @xmath80 , and a `` free '' pair of elements @xmath81 , such that the following substitutions are possible , completing a full fledged rainbow matching : @xmath81 will represent @xmath82 ( replacing @xmath83 ) , the two pairs representing @xmath84 will be replaced with , say , @xmath85 and @xmath86 , and finally , @xmath87 and @xmath88 will now be represented by , say , @xmath89 and @xmath90 , where @xmath91 exist since @xmath80 ( see figure  [ fig_jstar ] for an illustration ) .      in a follow - up paper , clemens et al .",
    "@xcite have solved the problem asymptotically , by showing that @xmath92 .",
    "suppose that @xmath47 for each @xmath93 , for some constant @xmath48 to be specified later .",
    "we can assume by induction on @xmath2 that @xmath94 have a rainbow matching @xmath95 , @xmath96 , @xmath97 , @xmath98 . let @xmath99 .      hence , let us assume that the above is not the case .",
    "thus , every element in @xmath102 must be @xmath7-equivalent to some element of @xmath103 ( possibly more than one ) . however , no two distinct elements of @xmath102 can be @xmath7-equivalent to the _ same _ element of @xmath103 ( by the transitivity of @xmath104 ) .",
    "therefore , by the pigeonhole principle , there must exist an index in @xmath105 , which without loss of generality we assume to be @xmath106 , for which there exist two distinct elements @xmath107 satisfying @xmath108 , @xmath109 .",
    "we can now similarly consider @xmath110 : unless we are immediately done , there must exist an index in @xmath111 , which without loss of generality we assume to be @xmath36 , for which there exist two distinct elements @xmath112 satisfying @xmath113 , @xmath114 .      [ lemma_train ]",
    ". we can find @xmath56 distinct indices in @xmath105 , which without loss of generality we assume to be @xmath116 , and we can find @xmath117 pairwise distinct elements @xmath118 , such that @xmath58 and @xmath59 for all @xmath119 .",
    "[ obs_unless ] if there exist two distinct elements @xmath129 , with @xmath130 , then we are easily done _",
    "unless _ one of @xmath131 belongs to @xmath132 and the other one belongs to @xmath133 for the _ same _ index @xmath134 .",
    "see figure  [ fig_unless ] .",
    "if @xmath135 ( here @xmath136 ) , and @xmath137 belong to different left - side components , or they both belong to the top ( or the bottom ) part of the same left - side component ( case not shown ) , then we can easily complete a rainbow matching ( indicated by the circled edge labels ) . ]",
    "let @xmath139 .",
    "if @xmath140 , then @xmath141 is charged to the component it belongs to . otherwise , by observation  [ obs_unless ] , @xmath141 must be @xmath4-equivalent to some @xmath142 ; then we charge @xmath141 to @xmath143 s component .",
    "( if @xmath141 can be charged to more than one right - side component , then we choose one of them arbitrarily . )",
    "the total number of charges is equal to @xmath144 , which is at least @xmath145 . by observation  [ obs_unless ] and the transitivity of @xmath146",
    ", no component can get more than four charges .",
    "hence , if @xmath147 , then there must be a component in @xmath63 that received four charges . without loss of generality",
    "it is @xmath148 .",
    "of the four elements charged to it , the two not belonging to it are the desired @xmath149 .",
    "consider an element @xmath154 .",
    "if @xmath155 , then we @xmath7-charge @xmath141 to the component it belongs to .",
    "otherwise , by observation  [ obs_1 ] , @xmath141 must be @xmath7-equivalent to some element @xmath156 ; then we @xmath7-charge @xmath141 to the component that contains @xmath143 .",
    "consider the elements of @xmath157 .",
    "we @xmath151-charge every element @xmath158 to the component it belongs to . if @xmath159 for some @xmath4 , then we @xmath151-charge both elements to the component @xmath69 that contains them . for every @xmath160 not covered by the above cases , by observation  [ obs_unless ]",
    "there must be a component @xmath69 that contains an element @xmath161 ( furthermore , either @xmath69 is a right - side component , or else @xmath162 ) ; we charge @xmath163 to @xmath69 .    charging scheme 2 . here",
    "elements that belong to @xmath103 ( such as @xmath165 and @xmath166 ) are always @xmath7- or @xmath167-charged to their own components . elements @xmath168 and @xmath169 are @xmath7-charged to @xmath170 .",
    "elements @xmath171 and @xmath4 are @xmath7-charged to @xmath172 .",
    "element @xmath48 is @xmath167-charged to @xmath170 .",
    "elements @xmath173 and @xmath174 are @xmath167-charged to @xmath175 ( despite the @xmath167-edges to @xmath172 ) .",
    "element @xmath176 is @xmath167-charged either to @xmath177 or to @xmath178 .",
    "element @xmath179 is @xmath167-charged to @xmath178 . ]",
    "since no two different elements outside @xmath103 can be @xmath7-equivalent to the same element of @xmath103 , every component @xmath69 can receive at most two @xmath7-charges from its own elements @xmath10 , @xmath11 , plus at most two more @xmath7-charges from other elements .",
    "the argument regarding @xmath151-charges is only slightly more complicated : there _ might _ be an element @xmath163 in a right - side component @xmath69 that is @xmath151-equivalent to two different elements outside @xmath103 .",
    "however , then they must be @xmath180 , @xmath181 for some left - side component @xmath70 , by observation  [ obs_unless ] . hence , they are @xmath151-charged to @xmath70 and not to @xmath69 .    for each @xmath182 ,",
    "let @xmath183 ( resp .",
    "@xmath184 ) be the number of @xmath7-charges ( resp .",
    "@xmath151-charges ) that component @xmath69 received ; let @xmath185 ( resp .",
    "@xmath186 ) be set of elements _ not _ in @xmath187 that were @xmath7-charged ( resp .  @xmath151-charged ) to @xmath69 ; and let @xmath188 .",
    "the sets @xmath185 are by definition pairwise disjoint , as are the sets @xmath186 .",
    "however , for a fixed  @xmath4 , @xmath185 is not necessarily disjoint from @xmath186 ; and @xmath26 is not necessarily disjoint from @xmath189 .",
    "still , no three sets @xmath26 have a common intersection .",
    "lemma  [ lem_4_charges ] states that @xmath190 and @xmath191 for each @xmath4 .",
    "furthermore , by the argument in the proof of lemma  [ lem_4_charges ] , we have @xmath192 and @xmath193 . moreover , we have @xmath194 and @xmath195 , each of which is at least @xmath196 .",
    "[ lemma_5_7 ] suppose that there exist five different left - side components that receive at least @xmath197 charges each ; namely , suppose there exist @xmath198 , with @xmath199 , such that @xmath200 for each @xmath201 .",
    "then we can complete a rainbow matching .",
    "consider the component @xmath202 . for simplicity",
    "rename its four elements @xmath203 in the obvious way .",
    "since this component received at least three @xmath151-charges , there must be a pair of elements among @xmath203 that are @xmath151-equivalent _ excluding _ the pair @xmath204 .",
    "this pair can not be @xmath205 nor @xmath206 , by observation  [ obs_unless ] .",
    "hence , the pair must be @xmath207 ( case 1 ) , or @xmath208 or @xmath209 ( case 2 ) .    in case 1",
    ", we consider components @xmath210 , @xmath211 , @xmath212 . in each one of them",
    "there must be an @xmath213 or @xmath214 that is @xmath7-equivalent to some @xmath215 . at most two of these @xmath143 s",
    "can be @xmath216 or @xmath217 , so the third one leads to a win , as follows ( see figure  [ fig_win123 ] , top ) : suppose for concreteness that @xmath218 for @xmath219 .",
    "then we take the pairs @xmath220 , @xmath218 ; the pairs @xmath38 for all @xmath221 ; and the pairs @xmath58 for all @xmath222 , except that if @xmath223 for some @xmath224 then we take @xmath225 instead .    now consider case 2 .",
    "suppose for concreteness that @xmath226 ( the case @xmath227 is symmetric ) .",
    "let us look again at component @xmath202 .",
    "first suppose that it received four @xmath7-charges .",
    "then each of @xmath228 must be @xmath7-equivalent to an element not in @xmath103 .",
    "consider the element @xmath229 that is not in @xmath103 .",
    "if @xmath230 then we go to case 2a below ; if @xmath231 then we go to case 2b below .    now suppose @xmath202 received four @xmath151-charges",
    "then we must have _ both _ @xmath226 and @xmath227 .",
    "furthermore , @xmath202 received at least three @xmath7-charges , so at least one of @xmath228 , say @xmath232 , must be @xmath7-equivalent to some @xmath215 .",
    "as before , if @xmath230 we go to case 2a ; otherwise we go to case 2b .",
    "recall that no component can receive more than @xmath241 charges , and that the total number of charges is @xmath242 .",
    "therefore , the number of components that receive at least @xmath197 charges must be at least @xmath243 .",
    "lemma  [ lemma_5_7 ] implies that at most four of these components can be on the left side .",
    "hence , there must be at least @xmath244 right - side components that receive at least @xmath197 charges each .",
    "call such components  heavy \" , and let @xmath73 be the set of their indices ; namely , let @xmath245      let @xmath75 .",
    "it is not necessarily possible to find four distinct elements @xmath252 , @xmath253 , such that @xmath254 and @xmath255 ( even if @xmath256 ) since we could have @xmath257 , @xmath258 , @xmath259 , @xmath260 .",
    "nevertheless , we can prove the following lemma :          suppose first that @xmath268 ( hence , @xmath269 and @xmath270 , so @xmath271 ) .",
    "we have @xmath272 , so there exists an element @xmath273 . if @xmath274 then we can take @xmath275 , @xmath276 and finish ; otherwise , @xmath277 , so we are done by taking @xmath278 , @xmath279 .",
    "suppose for concreteness that @xmath283 ( the three other possibilities are symmetric ) .",
    "consider @xmath284 .",
    "if it contains an element @xmath285 , then we are done by taking @xmath278 , @xmath286 .",
    "hence , assume @xmath287 .",
    "suppose @xmath288 .",
    "suppose for concreteness that @xmath289 and @xmath290",
    ". then @xmath11 must be @xmath7- or @xmath151-equivalent to an element @xmath291 , @xmath292 ; and @xmath214 must be @xmath7- or @xmath151-equivalent to an element @xmath293 , @xmath294 .",
    "if one of @xmath295 is different from @xmath266 , then we are done by taking it and @xmath265 for @xmath296 .",
    "otherwise , we have @xmath297 .",
    "take a third element @xmath298 .",
    "hence , @xmath299 is @xmath7- or @xmath151-equivalent to one of @xmath10 , @xmath213 , @xmath11 , @xmath214 . in the first two cases we take @xmath300 , whereas in the last two cases we take @xmath301 .",
    "finally , suppose @xmath302 .",
    "say @xmath266 is @xmath151-equivalent to @xmath213 .",
    "then @xmath214 must be @xmath7- or @xmath151-equivalent to some element @xmath285 .",
    "then we take @xmath267 to be @xmath299 and one of @xmath265 , @xmath266 .        1 .",
    "if there exist two distinct elements @xmath135 , both outside @xmath303 , then we are done .",
    "2 .   let @xmath70 be a left - side component that is not @xmath4-tainted . then ,",
    "if one of @xmath304 is @xmath4-equivalent to an element @xmath163 outside @xmath305 , then we are done .",
    "recall that @xmath312 .",
    "fix an index @xmath75 , and consider the set @xmath313 . by lemma  [ lemma_outside](_a _ ) , each element of @xmath314 must be @xmath4-equivalent to a _ different _ element of @xmath303 ( by transitivity of @xmath146 ) .",
    "hence , there are at most two elements of @xmath314 that are @xmath4-equivalent to elements of @xmath185 , and at most four more that are @xmath4-equivalent to @xmath213 or @xmath214 in an @xmath4-tainted component @xmath70",
    ". all the remaining elements of @xmath314 must be @xmath4-equivalent to elements of @xmath63 , by lemma  [ lemma_outside](_b _ ) .",
    "let @xmath75 .",
    "consider an element @xmath316 .",
    "if @xmath317 , then @xmath141 is @xmath4-charged to the component it belongs to .",
    "otherwise , if @xmath141 is @xmath4-equivalent to an element of @xmath185 or to @xmath213 or @xmath214 where component @xmath70 is @xmath4-tainted , then @xmath141 is not @xmath4-charged .",
    "otherwise , @xmath141 must be @xmath4-equivalent to an element @xmath142 ; then we charge @xmath141 to the component that contains @xmath143 .",
    "we have @xmath318 , and there are at most six elements of this set that are not charged .",
    "hence , there are at least @xmath319 components that received at least four charges . out of them , at least @xmath320 are right - side components .",
    "let us apply this charging for all @xmath75 .",
    "by the pigeonhole principle , there must be a ",
    "lucky \" right - side component @xmath321 that receives four @xmath4-charges for all @xmath322 , for some subset @xmath323 of size @xmath324 . for each index @xmath325 ,",
    "let @xmath326 be the set of two elements not in @xmath83 that were @xmath179-charged to @xmath83 .",
    "note that each @xmath326 is disjoint from @xmath122 , since elements of @xmath122 were charged to their own components .",
    "furthermore , @xmath326 is disjoint from @xmath327 for each @xmath179 ( since the elements of @xmath327 were not used ) .",
    "let @xmath328 be a pair of distinct indices in @xmath329 .",
    "we would like to choose four distinct elements @xmath330 , with @xmath331 and @xmath332 , such that @xmath333 and @xmath334 .",
    "if such a choice is not possible , then call the pair @xmath335 , @xmath336  conflicting \" .",
    "the _ only _ way for @xmath340 to be conflicting is to have @xmath331 , @xmath341 , @xmath333 , @xmath342 , @xmath343 , @xmath344 .",
    "therefore , if we define an undirected graph having @xmath329 as vertex set , and having an edge @xmath345 whenever @xmath328 are conflicting , this graph can not have an odd cycle , and therefore it is bipartite , and hence it has an independent set of size at least @xmath346",
    ". out of this independent set , we select an arbitrary subset @xmath339 of size @xmath347 .",
    "let @xmath328 be a pair of distinct indices in @xmath339 .",
    "we already know that @xmath335 , @xmath336 are not conflicting , and that @xmath351 .",
    "we would also like to have @xmath352 . if that is the case , call the pair @xmath335 , @xmath336  compatible \" .        since each element can appear in at most two sets @xmath327 ( at most one @xmath358 and at most one @xmath359 ) , there are at least @xmath360 indices @xmath361 for which @xmath362 contains no popular element .",
    "pick one such index @xmath335 .",
    "the elements of @xmath362 appear in at most @xmath363 sets @xmath364 , and the elements of @xmath365 appear in at most @xmath366 other sets @xmath367 . that leaves us with at least @xmath368 choices for @xmath369 that make the pair @xmath335 , @xmath336 compatible .",
    "suppose first that @xmath141 and @xmath143 belong to the same left - side component .",
    "by lemma  [ lemma_compatible ] , let @xmath373 be a compatible pair of distinct indices .",
    "invoke lemma  [ lemma_2_heavy ] with @xmath374 , @xmath375 .",
    "we obtain four distinct elements @xmath254 , @xmath255 , with @xmath376 with @xmath377 .",
    "if we are unlucky and @xmath378 for some index @xmath166 , then we invoke the `` furthermore '' clause of lemma  [ lemma_2_heavy ] with @xmath379 , and we proceed as in figure  [ fig_jstar](_a _ ) .",
    "proof of lemma  [ lemma_jstar ] . here",
    "@xmath164 . in case",
    "( _ a _ ) we have @xmath380 . since the indices @xmath340 are nonconflicting and compatible , the elements @xmath381 are all distinct . in case ( _ b _ ) we have @xmath382 and @xmath383 .",
    "]    now suppose @xmath141 and @xmath143 belong to different left - side components @xmath69 and @xmath70 .",
    "suppose without loss of generality that @xmath384 and @xmath385 .",
    "then we take a @xmath355 such that @xmath386 .",
    "such a @xmath179 must exist , since @xmath387 .",
    "then we proceed as in figure  [ fig_jstar](_b _ ) .    but a pair @xmath141 , @xmath143 as in lemma  [ lemma_jstar ] must exist , since otherwise , every element of @xmath388 would either belong to @xmath16 or be @xmath389-equivalent to a different element of @xmath16 . observe that @xmath390 .",
    "that accounts for only @xmath391 elements of @xmath388 , which is not enough .",
    "this concludes the proof of theorem  [ thm_bd ] . @xmath392",
    "the main difference between charging scheme 2 on the one hand , and charging schemes 1 and 3 on the other hand , is the way they handle the elements of @xmath393 . in charging schemes 1 and 3 these elements",
    "are automatically charged to the component they belong to , whereas in charging scheme 2 they are not .",
    "if we modified charging scheme 3 to be like charging scheme 2 in this respect , then no left - side component would receive more than two @xmath4-charges , improving lemma  [ lemma_cs3 ] .",
    "however , we then run into trouble since the sets @xmath326 might intersect @xmath189 .",
    "thanks to l.  .",
    "( yehuda ) grinblat for suggesting us to look at this problem and for helpful discussions .",
    "special thanks to the referees for reading the paper carefully and providing detailed suggestions . thanks also to anat paskin - cherniavsky for helpful discussions ."
  ],
  "abstract_text": [
    "<S> grinblat ( 2002 ) asks the following question in the context of algebras of sets : what is the smallest number @xmath0 such that , if @xmath1 are @xmath2 equivalence relations on a common finite ground set @xmath3 , such that for each @xmath4 there are at least @xmath5 elements of @xmath3 that belong to @xmath6-equivalence classes of size larger than @xmath7 , then @xmath3 has a rainbow matching  a set of @xmath8 distinct elements @xmath9 , such that @xmath10 is @xmath6-equivalent to @xmath11 for each @xmath4 ?    grinblat has shown that @xmath12 . </S>",
    "<S> he asks whether @xmath13 for all @xmath14 . in this paper </S>",
    "<S> we improve the upper bound ( for all large enough @xmath2 ) to @xmath15 . </S>"
  ]
}