{
  "article_text": [
    "we recorded the spiking activity of @xmath0 ganglion cells from a 1 mm@xmath1 patch of the rat retina , while presenting a complex and dynamical stimulus that consisted of @xmath2 or @xmath3 randomly moving black discs on a bright background ( fig.[figure1]a and methods ) .",
    "our goal was to reconstruct the light intensity as a function of time ( `` luminance trace '' ) at a grid of @xmath4 spatial positions ( `` sites '' ) uniformly tiling the stimulus frame .",
    "stimulus features ( here , disc size ) were smaller than the receptive field center of a typical recorded rgc , making the decoding task non - trivial .",
    "to estimate the luminance trace at any given time , we trained a separate sparse linear decoder for each site on a @xmath5 sliding window of the complete spiking raster , shown in fig.[figure1]b , and represented as spike counts in @xmath6 time bins ( see methods ) . while each decoder in principle had access to all neural responses , our sparse ( l1 ) penalty on decoding weights ensured that the majority of the weights corresponding to redundant or non - informative neural responses for each site were zeroed out , yielding interpretable results which we describe in detail below . when trained on the 10-disc stimulus ,",
    "this procedure predicted well the luminance traces across individual sites on withheld sections of the stimulus ( fig.[figure1]c ) , allowing us to reconstruct the complete movie ( fig.[figure1]d ) .",
    "we expected the performance of our decoder to depend strongly on local coverage , i.e. , on the number of recorded cells whose receptive field centers overlap a given site .",
    "coverage amounted to about six cells on average and exhibited substantial spatial heterogeneity , as shown in fig.[figure1]e .",
    "the quality of our movie reconstruction , measured locally by `` fraction of variance explained '' ( fve , see methods ) , showed similar spatial variation ( fig.[figure1]f ) which correlated strongly with coverage ( fig.[figure1]g ) , and saturated at @xmath7 cells . in",
    "what follows , we restrict our analyses to sites with good coverage that pass a threshold of @xmath8 .",
    "despite the high dimensionality of this regression problem ( decoders have @xmath9 parameters per site ) , sparse regularization ensured uniformly good performance even when tested on out - of - sample stimuli with varying number of discs ( fig.[figure1]h ) .        to analyze how rich stimuli are represented by a population of ganglion cells with densely overlapping receptive fields , we examined the resulting decoding weights in detail .",
    "we found that stimulus readout was surprisingly local .",
    "as illustrated for two example sites in fig.[figure1]i , only a few cells whose receptive field centers were in close proximity to the respective sites were assigned non - negligible decoding weights .",
    "this was true in general : on average @xmath10 cells , whose rf centers were all located within @xmath11 of the decoded site , contributed to the luminance trace reconstruction ; cells beyond this spatial scale contained no decodable information ( si  fig.1 , 2 ) .",
    "our framework also allowed us to construct a `` decoding field '' for every cell ( fig.[figure1]j ) .",
    "a decoding field represents an impulse response of the decoder , i.e. , an additive contribution to the stimulus reconstruction for every spike emitted by a particular cell . because neural encoding is strongly nonlinear",
    ", there is no _ a priori _ reason for the similarity between receptive and decoding fields , especially when , as here , they were inferred under different stimulus conditions .",
    "we nevertheless found a remarkably good correspondence : spatial locations and sizes of the decoding and receptive fields coincided for all cells ( si  fig.3 ) , with decoding fields furthermore exhibiting a clear center - surround - like structure . taken together , these and supplementary results ( si  figs.4",
    ", 5 , 6 ) suggest that retinal responses to complex stimuli can be read out in a highly stereotyped , structured , and local manner .",
    "sd across sites ) , achievable using increasing numbers of cells with highest l1 filter norm . for nonlinear decoding ,",
    "`` all '' is the optimal subset that maximizes performance ( si  fig.7 ) .",
    "* c * : average roc across all testing movie frames . *",
    "d * : fractional improvement ( average @xmath12 sem across sites ) of nonlinear versus linear decoders for test stimuli with different numbers of discs .",
    "all decoders were trained only on the 10-disc stimulus .",
    "* e * : decoding error ( mse ; average @xmath12 sem across sites ) in fluctuating and constant epochs is significantly larger for linear decoders ( p@xmath130.001 ) .",
    "* f * : performance ( f - score ) of linear and nonlinear classifiers for different sites ( black dots ) .",
    "inset : average ( @xmath12 sem ) over sites is significantly different ( p@xmath130.001 ) . ]",
    "could nonlinear decoding improve on these results ?",
    "a tractable method that extends linear regression into the nonlinear domain is kernel ridge regression ( krr ) , which we applied to our recordings using gaussian kernels of cross - validated width ( see methods )  @xcite .",
    "importantly , the success of the nonlinear decoder crucially depended on the proper selection of local groups of cells relevant for each site , as identified by linear decoding : its sparse ( l1 ) regularization acted as `` feature selection '' for the nonlinear problem ( methods , si  fig.7 ) .",
    "nonlinear decoder could then make use of higher - order statistical dependencies within and between the selected spike trains to achieve high performance",
    ".    figure  [ figure2]a shows a luminance trace at one of the example sites , together with its linear and nonlinear reconstruction .",
    "nonlinear decoder tracks better the detailed structure of luminance troughs , which occur when discs cross the site , as well as exhibiting smaller fluctuations when no discs are crossing the site and the true luminance trace is therefore constant .",
    "this is reflected in a substantial overall increase in fraction of variance explained ( fve ) across different sites , shown in fig.[figure2]b . a nonlinear decoder using only two best cells per site outperforms , on average , the best sparse linear decoder constructed from the entire population ; nonlinear performance saturates quickly with the number of cells and peaks when decoding from local @xmath14-cell groups .",
    "an alternative way to compare decoding performance is to threshold the sequence of decoded movie frames ( see si  fig.8 and si movie 1 ) , thereby assigning each site to a decoded dark disc ( `` below threshold '' ) or to the bright background ( `` above threshold '' ) .",
    "decoded movie frames can then be compared to ground truth at each threshold using the receiver operator characteristic ( roc curve ) , shown for both decoders in fig.[figure2]c . in this",
    "metric , nonlinear decoders also consistently outperformed linear ones .",
    "excess nonlinear performance of between 15 and 20% of fve was maintained even when both decoders were trained on 10-disc stimulus and tested on stimuli with smaller number of discs ( fig.[figure2]d ) .",
    "excess nonlinear performance was also observed when decoding from a cell mosaic of a single functional type ( si fig.9 ) and on a repeat experiment ( si fig.10 ) .    a particularly striking feature of our results was the difficulty of the linear decoder to match the true ( constant ) luminance trace when no disc was crossing the corresponding site .",
    "rat retinal ganglion cells are continuously active even when there are no coincident on - center luminance changes , with the activity likely resulting from stimulus changes in the surround , from long - lasting sustained responses to previous stimuli , from effective network coupling to cells that do experience varying input , or from true spontaneous excitation that would take place even in complete absence of stimuli  @xcite . either way , activity of cells at constant local luminance presents a confound that is difficult for a generic linear mechanism to eliminate , which results in decoder fluctuations , or `` hallucinations , '' of sizable variance .",
    "to quantify this effect , we partitioned the luminance traces at every site into constant and fluctuating epochs by means of a simple threshold ( see methods ) , and examined decoding errors separately during both epochs . while the absolute error of the nonlinear decoder was smaller than that of linear in both epochs , the fractional difference was greatest during constant epochs , suggesting that nonlinear decoders might specifically be better at suppressing their responses to spontaneous - like neural activity ( fig.[figure2]e ) .",
    "we reasoned that this improvement comes , in part , from the ability of the nonlinear method to recognize whether there are any on - site luminance fluctuations or not , from the spike trains alone . to test this idea , we trained linear and nonlinear classifiers , operating on identical inputs and with the same kernel parameters as the decoders , to best separate constant from fluctuating activity .",
    "consistent with our expectations , nonlinear classifiers outperformed linear at every site , irrespectively of whether their input were the rasters of all local cells that contribute to the decoding , as shown in fig.[figure2]f , or the raster of a single best cell at every site ( si  fig.11 ) .",
    "sd over repeats .",
    "* c * : increase in decoding error ( mse ) and decrease in classifier performance ( f - score ) when spike - history dependencies or noise correlations are removed ( average @xmath12 sem across sites ) ; percentages report fractional differences relative to the original performance . *",
    "d * : spike count distributions for a single example cell . removing spike - history dependencies broadens the distributions , in particular in constant epochs .",
    "dashed line = expectation for a fully randomized spike train with a matched firing rate .",
    "* e * : fano factor of spike count distributions for spike trains with and without spike - history dependencies .",
    "each point is a cell that contributes most to decoding at a particular site ( when the same cell contributes to multiple sites , average @xmath12 sd across sites is shown ) . ]      next , we attempted to identify the statistics of spike trains that are necessary to explain the excess performance of nonlinear decoders .",
    "our starting point was the following observation : the simplest nonlinear decoders that used a single best cell for each site , when interrogated with a test - set epoch of pure spontaneous activity ( i.e. , neural responses to a completely blank screen ) , yielded luminance traces with significantly smaller variance than their linear counterparts ( si  fig.12 ) . since the only structure in spike trains during spontaneous activity is , by definition , due to `` noise correlations''pairwise or higher - order dependencies between spikes within an individual spike train or across different spike trains  we hypothesized that certain noise correlations could be used by nonlinear decoders also during stimulus presentation to boost their decoding performance .    to test this hypothesis , we made use of many identical repeats of a particular stimulus fragment embedded in our disc movie ( these repeats were used neither for training nor testing ) . using the same decoders as above",
    ", we decoded the original response rasters corresponding to the repeated fragment , as well as rasters in which we shuffled the spikes to remove spike - history dependencies , or to remove cell - cell noise correlations , as shown in fig.[figure3]a ; note that these manipulations left the firing rates of all cells intact .",
    "figure  [ figure3]b shows a stimulus reconstruction at an example site by the nonlinear decoder , for original rasters as well as rasters with removed spike - history dependencies or cell - cell noise correlations . removing cell - cell noise correlations leads to a small increase in the variance of the reconstructions across stimulus repeats , with only marginal differences in the mean reconstructed trace , compared to decoding from intact rasters .",
    "surprisingly , removing spike - history dependencies leads to much worse reconstructions , whose mean is strongly biased and variance increased ; as a result , the dynamic range of the decoded trace is substantially lower compared to decoding from intact rasters .",
    "these observations are summarized across sites in fig.[figure3]c , which shows the increase in decoding error and decrease in classifier performance when spike - history dependencies or cell - cell noise correlations are removed .",
    "removal of cell - cell noise correlations leads to small increases in error , roughly of the same magnitude for both linear and nonlinear decoders ; in contrast , while removal of spike - history dependencies leads to increases in error for both decoders , the effect is more than three - fold larger for the nonlinear decoder .",
    "qualitatively similar conclusions hold for the classifiers trained to separate constant from fluctuating input epochs ( fig.[figure3]c ) , as well as for decoders and classifiers trained on the single best cell per site ( si  fig.13 ) .    having established that spike - history dependencies are crucial to the performance of the nonlinear decoder , we looked at the detailed statistical structure of individual spike trains .",
    "for each neuron that best decoded the luminance trace at a specified site , we focused on @xmath15 ( 20 time bins ) response sequences and constructed a distribution over the number of occupied time bins ( `` spike counts '' ) , separately for epochs where the luminance trace was fluctuating or where it was constant .",
    "as shown in fig.[figure3]d , these distributions differed significantly : the count distribution was much tighter in constant epochs , while the mean firing rate between the epochs did not change much . during fluctuating - input epochs , observing more spikes in a @xmath15 window was more likely than at constant input , but  perhaps surprisingly ",
    "patterns with very low numbers of spikes ( e.g. , zero or one ) were also more likely during fluctuating - input epochs .",
    "the count distribution at fluctuating light was very similar to binomial ( and , at this temporal resolution , poisson ) , while it was tighter at constant light .",
    "these changes could be summarized by a simple statistic , the fano factor @xmath16 ( variance in spike count)@xmath17(mean spike count ) . when we removed spike - history dependencies , fano factor increased for both distributions and they became harder to distinguish from each other .",
    "figure  [ figure3]e shows that this behavior was consistent across all sites , highlighting the very high regularity of neural spiking that resulted in sub - poisson variance ( @xmath18 substantially below 1 ) during epochs of constant luminance .",
    "taken together , our results show that : _",
    "( i ) , _ spike - history dependencies within individual spike trains are crucial for nonlinear decoder performance ; _ ( ii ) , _ these dependencies shape the distribution of spike counts on timescales relevant for decoding ; _ ( iii ) , _ during constant local luminance , spiking activity is very regular ( and statistically similar to true spontaneous activity , see si  fig.14 ) ; _ ( iv ) , _ a simple statistic , which summarizes the effects of spike - history dependencies in different epochs and their changes when the spike trains are shuffled , is the fano factor . while this does not imply that kernelized decoders actually compute some version of a local estimate for the fano factor ( they could be sensitive to other statistics , e.g. , the interspike interval distribution , which also differs substantially between the epochs , see si  fig.15 ) , it is plausible that the underlying reason for nonlinear decoder performance is its ability to recognize high regularity of spiking during epochs of constant local luminance .",
    "can the observed spike - history dependencies , which enable successful nonlinear decoding , be generated by simple and generic neural encoding models ? to address this question , we made use of generalized linear models ( glms )  @xcite , probabilistic functional models of spiking neurons that extend the paradigmatic linear - nonlinear ( ln ) framework by incorporating the recurrent feedback from neuron s past spiking , as schematized in fig.[figure4]a .",
    "previously , glms have been successfully applied to responses of the mammalian retina @xcite and in the cortex  @xcite , and also reproduced well the firing rates of cells recorded in our experiment on the repeated stimulus fragment ( si  fig.16 ) .    ) , and combines additively with the neuron s sensitivity to its own past spiking , given by filter @xmath19 ( with strong refractoriness followed by weak facilitation ) .",
    "importantly , @xmath19 shapes spike - history dependencies in the resulting spike trains . a nonlinear function @xmath20 ( here , threshold - linear ) of the combined sensitivities gives the neuron s instantaneous firing rate that can be used to generate individual spike train instances .",
    "shapes , as well as the temporal and spatial scales of the filters , were realistic for our data . *",
    "b * : example rasters ( 50 repeats ) generated with the encoding model for a given intensity trace and different magnitudes ( @xmath21 ) of spiking history filter @xmath19 .",
    "the rasters are matched in psth ( bottom ) but differ in temporal noise correlations . * c * : average fano factor ( @xmath12 sd ) of the model as a function of @xmath21 in fluctuating and constant epochs .",
    "* d * : decoding error as a function of @xmath21 .",
    "decoders are trained for each separate @xmath21 and tested on withheld stimuli ; shade = sd over 10 spike train realizations . ]",
    "to link encoding models and decodability in a way that would generalize beyond the specifics of our dataset , we created the simplest stereotyped model cell , shown in fig.[figure4]a .",
    "crucially , we parametrized the magnitude of the self - coupling filter with @xmath21 : @xmath22 thus corresponded to a pure ln model , while increasing values of @xmath21 made neural spike trains non - poisson , progressively enforcing dependence on past spiking and consequently increasing the magnitude of the resulting temporal correlations .    with this model in hand , we generated a `` baseline '' raster of repeated responses to a randomly moving disc stimulus at an initial value of @xmath23 , as shown in fig.[figure4]b .",
    "the average firing rate was chosen to be the typical rate of our recorded ganglion cells .",
    "we then systematically changed the value of @xmath21 and , for each value , refitted the nonlinearity to the baseline raster at @xmath23 ( see methods ) .",
    "this procedure generated synthetic rasters that were matched in their peri - stimulus time histograms ( psth ) and stimulus preference , yet differed in the strength of spike - history dependencies .",
    "following our previous analyses , we partitioned the luminance trace into constant and fluctuating epochs , and looked at the spiking statistics in @xmath15 ( 20 time bin ) windows .",
    "fano factor in constant epochs decreased as a function of @xmath21 and dropped substantially below 1 ; in contrast , when on - center luminance was fluctuating , fano factor behaved non - monotonically ( fig.[figure4]c ) . in line with expectations and",
    "behavior observed in our data , fano factor at constant luminance was always below fano factor at fluctuating luminance .",
    "having ensured that the statistics of synthetic rasters qualitatively agreed with the data for the range of @xmath21 we examined , we asked about the performance of linear and nonlinear decoders , trained and tested at different values of @xmath21 .",
    "figure  [ figure4]d plots the decoding error as a function of @xmath21 .",
    "overall , the error levels are in range of those observed for real data ( cf .",
    "fig.[figure1]h ) , with nonlinear decoders outperforming linear by @xmath24 .",
    "interestingly , the minimal error for both decoders is achieved at an intermediate value of @xmath25 , which also corresponds to the point where nonlinear decoders maximally outperform their linear counterparts . at @xmath22 , where the encoding models are effectively ln neurons ,",
    "the decoders differ only marginally in performance ( analogous results hold for the classifiers , see si  fig.17 ) .    in sum , for a generic class of encoding models that are widely applicable to both peripheral as well as central neural processing , there exists a non - trivial strength of spike - history dependence that facilitates stimulus reconstruction , especially with nonlinear readout .",
    "intuitively , the existence of optimal @xmath26 can be explained as a trade - off between ensuring regularity of spiking during constant epochs , which the nonlinear decoder can make use of , while not impeding stimulus encoding during fluctuating epochs ; during these epochs , stimulus - driven term should dominate over sensitivity to past spiking , otherwise excessive dependence on spiking history ( e.g. , @xmath27 in fig.[figure4]b ) could perturb reliable locking to the stimulus .",
    "insights from decoding provide crucial constraints for theoretical models of neural codes .",
    "a large body of work dissects nonlinearities in stimulus processing , from nonlinear summation in the receptive field or during adaptation , to essential spike generation nonlinearities .",
    "consequently , one would expect nonlinear decoding to outperform linear , but reports to that effect are surprisingly scarce  @xcite . in theory",
    "the results of a nonlinear encoding process can be linearly decodable  @xcite , yet whether this is true of real neurons under rich stimulation is still unclear .",
    "another fundamental question concerns the stability of decoding transformations , which has recently received renewed attention in the context of efficient coding  @xcite . approaching this question empirically requires us to first construct high - quality decoders for complete stimulus movies  conceptually , doing the inverse of the state - of - the - art encoding models  @xcite  which remains an open challenge . finally , a number of studies , both theoretical  @xcite and data - driven  @xcite , focused on correlations in neural activity , especially those due to spike - history dependence and network circuitry ( `` noise correlations '' ) ; here , decoding provides a way to quantitatively ask about the functional contribution of such correlations to stimulus reconstruction .",
    "we used large - scale linear and kernelized ( nonlinear ) regressions to directly decode a complex stimulus movie from the output of many simultaneously recorded retinal ganglion cells .",
    "importantly , we did not use any prior knowledge of recorded cells properties ( e.g. , their types or receptive fields ) , or any prior knowledge of the stimulus structure , to carry out the decoding ; as a result , our decoding filters could , at least in principle , be used to decode any stimulus . a combination of sparse prior over decoding filter coefficients and a high - dimensional stimulus revealed a surprisingly local and stereotyped manner in which the retinal code could be read out .",
    "this is in stark contrast to previous work using simple stimuli where the readout was distributed and the resulting decoding filters had no general interpretation  @xcite . while our filters and consequently the `` decoding fields '' were recovered under a particular stimulus class and thus nominally depend on stimulus statistics , it is interesting to speculate whether the retina could adaptively change its encoding properties so as to keep the decoding representations constant , as has recently been suggested  @xcite .",
    "similarity between decoding and receptive fields and generalization to stimuli with different number of discs provide limited circumstantial support for this idea , but a definite answer can only emerge from dedicated experiments that specifically test the stability of decoders under rich stimuli with different statistical structure .",
    "the performance of linear decoders was further improved by using nonlinear decoding .",
    "the improvement was significant , systematic , and reproducible : we observed it at nearly all sites , irrespectively of how many relevant cells we decoded from , when decoding from all recorded cells jointly or a mosaic of a single type , and also in a repeat experiment .",
    "such an improvement is nontrivial , because the increased expressive power of kernelized methods comes at a cost of potentially overfitting models to data ; this was evident also in our failed first attempt to apply nonlinear decoding to the whole recorded population , instead of only to the relevant cells selected by sparse linear decoder at every site .",
    "the performance improvement depended crucially on the spike - history dependence in individual spike trains but only slightly on cell - cell noise correlations  ( cf .",
    "@xcite ) .",
    "what are the methodological advances presented in our work ?",
    "first , the use of sparse linear and kernelized regression , as described here , should provide a tractable way of studying how rich signals are represented in other parts of the brain without making explicit assumptions about the encoding process , thereby providing a complementary , decoder - centric alternative to bayes inversion of probabilistic encoding models .",
    "second , even though the inner workings of kernelized methods are notoriously difficult to interpret intuitively , our analysis suggests that controlled manipulations of spike train statistics can provide valuable insights into which spike train features matter for decoding and which do not .",
    "finally , we provide a preliminary account of how decoding of full complex movies can shed light on the functional contributions of different cell types to stimulus representation , by decoding from individual mosaics or from their combinations , and comparing the performance to that of a complete population .",
    "what are the general implications of our results ?",
    "the high - dimensional nature of our stimulus forced us to decode the movie `` pixel - by - pixel , '' rather than trying to decode its compact representation .",
    "this , in turn , focused our attention on the intermittent nature of signals to be decoded : at any given site , the luminance trace switched between epochs where nothing changed locally , and periods where the trace was fluctuating in time .",
    "such intermittency is common to many natural stimuli across different sensory modalities @xcite , and therefore must shape the way in which sensory information is encoded @xcite . from the decoding perspective , it can , however , also pose a serious challenge : since neurons might be similarly active irrespective of whether the stimulus fluctuates locally or not , a downstream processing layer would have to suppress `` hallucinations '' in response to upstream network - driven or spontaneous activity .",
    "we proposed a simple mechanism to that effect using history dependence of neural spiking : because neuronal encoding is nonlinear , the effect of spike - history dependence on neural firing substantially differs between epochs in which the neuron also experiences a strong stimulus drive and epochs in which it does not . in such situations",
    ", nonlinear methods can discriminate between a true stimulus fluctuation and spontaneous - like firing from statistical structure intrinsic to individual spike trains , even when the mean firing rate does nt change appreciably between different epochs .",
    "this mechanism is not specific to the retina , and may well apply in other systems that display both stimulus - evoked and spontaneous activity .",
    "retinal tissue was obtained from adult ( 8 weeks old ) male long - evans rat ( rattus norvegicus ) and continuously perfused with ames solution ( sigma - aldrich ) and maintained at 32 @xmath28c .",
    "ganglion cell spikes were recorded extracellularly from a multi - electrode array with 252 electrodes spaced 60 @xmath29 m apart ( custom fabrication by innovative micro technologies , santa barbara , ca ) .",
    "experiments were performed in accordance with institutional animal care standards .",
    "the microelectrode covered a total retinal area of @xmath30 1  mm@xmath1 .",
    "for the rat this corresponds to 16 - 17 degrees of visual angle @xcite .",
    "the spike sorting was performed with an in - house method based on @xcite .      the stimulus movie consisted of randomly moving dark discs ( @xmath31= 100  @xmath29 m ) against a bright background ( 100% contrast , 2 @xmath32 10@xmath33 photons / cm@xmath1/s ) .",
    "the discs followed mutually avoiding trajectories generated through an ornstein - uhlenbeck process .",
    "the movie was divided in segments of 1 , 2 , 4 and 10 discs , each 675  s long .",
    "segments with increasing number of discs were presented sequentially and in total 3 segments of each type were shown , amounting to a total experiment time of 135  min .",
    "each segment was regularly interspersed with 18 short ( 7.5  s ) clips of repeated stimulus : in sum , 54 repeated clips were shown for each stimulus with different number of discs .",
    "the stimulus was convolved with a bank of 400 spatial symmetric gaussian filters ( @xmath35=66.67 @xmath29 m ) placed in a regular 20x20 grid to produce local luminance traces .",
    "the filter normalization ensures the resulting traces are bounded in ( 0,1 ) .",
    "the width of the filters was selected in preliminary tests to optimize decoding performance .",
    "the movie stimulus was shown at a refresh rate of 80 hz .",
    "the response spike trains were binned accordingly in bins of 12.5 ms , and time aligned to the stimulus .",
    "the spatio - temporal receptive fields of the retinal ganglion cells were obtained through reverse correlation to a flickering checkerboard stimulus .",
    "the checkerboard was constructed from squares of 130  @xmath29 m that were randomly selected to be black or white at a rate of 40 hz .",
    "retinal spontaneous activity was recorded in full darkness ( blackout condition ) for 2.5  min .",
    "let @xmath36 be a one - dimensional stimulus trace of length @xmath37 time bins .",
    "in the linear decoding framework we assume that an estimate of the stimulus @xmath38 can be obtained from the neural response @xmath39 as @xmath40 , where @xmath41 is a linear filter . in this formulation ,",
    "the response of the retina is represented by the matrix @xmath42 , where @xmath43 is the number of cells and @xmath44 the size in bins of the time window we associate with a single point in @xmath36 ( for all analyses @xmath45 corresponding to a window stretching from -375 ms to 375 ms around the time bin of interest ) .",
    "the extra dimension is a column of ones to account for the bias term in the decoding .",
    "thus , the decoding filter @xmath41 is structured as @xmath46 , $ ] where @xmath47 is the filter corresponding to cell @xmath48 and @xmath49 is the bias term .",
    "we learned the filters @xmath41 by minimizing the square error function with l1-regularization @xmath50 to solve the minimization problem computationally we made use of the lasso algorithm with the routines by kim et al .",
    "data was divided into training and testing sets ( 4.9@xmath3210@xmath51 training points , 2.3@xmath3210@xmath51 testing points ) .",
    "the filters were obtained from the training set and all measures of performance refer to the testing set .",
    "regularization parameter @xmath52 was chosen through 2-fold cross - validation on the training set .",
    "the regularization term ensures the sparsity of the filters . due to this sparsity",
    "some cells have negligible filter norms and therefore do not contribute to the decoding .",
    "this allows us to establish a hierarchy of cells by sorting them according to their filter norm @xmath53 .",
    "`` single - best cell '' for every site refers to the cell with the largest norm .",
    "`` contributing cells '' are the subset of cells with largest norm that jointly account for at least half of the total filter norm @xmath54 .",
    "if instead of l1-regularization we enforce l2-regularization , the linear decoding filters can be obtained analytically through the normal equation @xmath55 thus , an estimate of the stimulus for some new data @xmath56 is given by @xmath57 since this expression only depends on products of spike trains , we can make use of the kernel trick and substitute the usual scalar product by some appropriate nonlinear function @xmath58 of the spike trains . in this way",
    ", we can express our nonlinear decoding problem as @xmath59 where @xmath60 is the @xmath48th row of matrix @xmath39 .",
    "this is known as kernel ridge regression  @xcite . for our analyses",
    "we have used the gaussian kernel @xmath61 before computing the kernel , it is customary to turn the spike trains into smooth traces for the sake of performance @xcite .",
    "we convolved our spike trains with a gaussian filter of 3 time bins width .",
    "the data was divided into training and testing sets ( 9.8@xmath3210@xmath62 training points , 2.3@xmath3210@xmath51 testing points ) .",
    "the parameters @xmath63 and @xmath52 were obtained through joint 3-fold cross - validation on the training set .",
    "the performance of the nonlinear decoder depends on the set of cells considered .",
    "contrary to the linear case where l1-regularization can effectively silence cells by setting their filters to zero , this nonlinear framework can not ignore cells in a similar way .",
    "therefore , including in the analysis non - informative cells can decrease the generalization performance of the decoder . to determine the best subset of cells for decoding we took advantage of the hierarchy of cells established by the linear l1-regularized decoding .",
    "we trained nonlinear decoders with progressively more cells ( best cell , best two cells , etc . ) and selected the subset of minimum decoding error on the training set ( si  fig .",
    "effectively , we jointly cross - validated the three parameters @xmath63 , @xmath52 , and the subset size .      for classification purposes",
    "we assign each time bin to one of two classes : `` fluctuating '' or `` constant '' .",
    "`` fluctuating '' corresponds to discs moving over the site of interest and decreasing the light intensity in that site , while `` constant '' refers to the constant illumination of the site when no discs are present . to label the time bins we use a simple cut - off criterion plus two further correcting steps to account for retinal adaptation effects .",
    "first we label as `` fluctuating '' every bin with stimulus intensity less than 0.99",
    ". then we apply these corrections : _",
    "i ) _ every identified `` constant '' segment shorter than 30 bins ( 375 ms ) is relabelled as `` fluctuating , '' and _ ii ) _ the first 30 bins following a `` fluctuating '' segment are also labelled `` fluctuating . '' in this way the stimulus at each site is divided in segments of fluctuating and constant intensity .",
    "we train both linear and nonlinear support vector machine ( svm ) classifiers to determine , from the spike train response , whether a given time bin is labelled as `` constant '' or `` fluctuating '' .",
    "similarly to the decoding framework , to classify a given bin we consider a time window of @xmath45 bins around it in the response . for the nonlinear svm we use the same gaussian kernel as in nonlinear decoding and",
    "the parameter values obtained when training the decoder .",
    "note that this is not the optimal nonlinear classifier but allows us to evaluate the classifying power of the decoding kernel .      given a stimulus intensity trace @xmath36 and the corresponding decoding prediction",
    "@xmath38 we define the decoding error as the mean squared error @xmath64 we also make use of the related fraction of variance explained defined as @xmath65    to measure decoding performance from the fully decoded movie we build receiver operating curves ( roc ) .",
    "we threshold the decoded intensity trace at each site . if intensity is below threshold , the presence of a disc in the site is predicted . by comparing the prediction to the original stimulus frames as function of the threshold we can evaluate the performance of the decoder as a balance between the true positive ( tp ) and false positive ( fp ) rates @xmath66    to assess the performance of the svm classifiers we use the @xmath67-score measure defined as @xmath68 where @xmath69 is the precision and @xmath70 the recall given by @xmath71 for the binary classification task , `` fluctuating '' is defined as the positive class .",
    "unless otherwise stated , all of the statistical significance tests were performed with the wilcoxon signed rank test .",
    "for each site @xmath63 we determine the set of available cells as those located less than 300 @xmath72 from the site .",
    "we call @xmath73 the total number of available cells at site @xmath63 . in general , @xmath73 is the sum of on and off subtype cells , @xmath74 .",
    "if , from the available cells at site @xmath63 , we pick a random subset of size @xmath75 , the probability of choosing @xmath76 cells is given by the hypergeometric distribution ( random draw without replacement ) @xmath77 the average probability over all sites considered is @xmath78    separately , for each site @xmath63 we have established a hierarchy of cells from their decoding filter norms . following the hierarchy we create decoding sets of different size @xmath37 ( the best cell , the best two cells , etc ) and we count the number of off type cells @xmath76 in them .",
    "we summarize this information in the histogram @xmath79 that counts the number of sites where the decoding set of size @xmath37 contains @xmath76 off cells . with this histogram",
    "we obtain an empirical probability @xmath80 that we can compare with @xmath81 . in particular , the bias reported in si fig.5 is given by @xmath82 only sites with @xmath83 were considered for the comparison ( n=115 ) .",
    "we build an encoding model for a single cell , based on the standard glm type model proposed by pillow et al @xcite .",
    "the cell spikes stochastically through a poisson process with a time - dependent firing rate @xmath84 given by @xmath85 where @xmath86 is a spatio temporal filter acting on stimulus @xmath87 and @xmath19 is a temporal filter of the past spike history of the cell represented by @xmath88 .",
    "the function @xmath89 is a rectifying nonlinearity of the log - exp form @xmath90 .",
    "the stimulus filter @xmath86 factorizes into separate spatial and temporal filters .",
    "the spatial component is given by a balanced difference of gaussians , with widths @xmath91 for the positive and @xmath92 for the negative part , providing a symmetrical center - surround type filter .",
    "the temporal part of the filter is given by a single negative lobe of a @xmath93-like function .",
    "the filter for the past spike history takes the form @xmath94 this filter inhibits firing after a spike but , depending on the values of the parameters , it can have a positive lobe after the inhibitory part that tends to increase the firing rate .",
    "we consider a span of 250 ms ( 20 bins ) for both the past history filter and the temporal part of the stimulus filter .",
    "all elements of the filter are fixed except for the rectifying nonlinearity that is changed according to the value of @xmath21 .",
    "initially , the parameters of the nonlinearity @xmath95 are adjusted to provide an average firing rate similar to that observed in real data .",
    "the @xmath23 model is taken as the ground - truth and every time @xmath21 changes , the nonlinearity @xmath96 is fitted anew by maximizing the likelihood on @xmath23 rasters , in order to reproduce the firing rate trace ( psth ) as closely as possible to the psth generated by @xmath23 .",
    "the model neuron is stimulated with real data and the intensity trace at the central site of its receptive field is the stimulus considered for decoding . the model has been implemented using the nonlinear input model toolbox @xcite .",
    "we thank matthew chalk , cristina savin , and jonathan d victor for helpful comments on the manuscript .",
    "we also thank christoph lampert for useful discussions on kernel methods .",
    "this work was supported by anr optima , the french state program investissements davenir managed by the agence nationale de la recherche [ lifesenses : anr-10-labx-65 ] , by a ec grant from the human brain project ( clap ) and nih grant u01ns090501 to om , the austrian research foundation fwf p25651 to vbs and gt .",
    "vbs is partially supported by contract mec , spain ( grant no .",
    "aya2013 - 48623-c2 - 2 and feder funds ) .",
    "sd was supported by a phd fellowship from the region ile - de - france .",
    "the funders had no role in study design , data collection and analysis , decision to publish , or preparation of the manuscript .",
    "99    rieke f , warland d , de ruyter van steveninck rr , bialek w ( 1997 ) spikes : exploring the neural code ( mit press , cambridge ) .",
    "oram mw , foldiak p , perrett di , sengpiel f ( 1998 ) the ` ideal homunculus ' : decoding neural population signals .",
    "_ trends neurosci _ * 21 : * 25965 .",
    "georgopoulos ap , schwartz ab , kettner re ( 1986 ) neuronal population coding of movement direction .",
    "_ science _ * 233 : * 14161419 .",
    "kay kn , naselaris t , prenger rj , gallant jl ( 2008 ) identifying natural images from human brain activity .",
    "_ nature _ * 452 : * 3525 .",
    "strong sp , koberle r , de ruyter van steveninck rr , bialek w ( 1998 ) entropy and information in neural spike trains .",
    "_ phys rev lett _ * 80 : * 197 .",
    "archer e , park i m , pillow jw ( 2013 ) bayesian entropy estimation for binary spike train data using parametric prior knowledge .",
    "_ advances neural info proc syst _ * 26 : * 17001708 .",
    "tkaik g et al .",
    "( 2014 ) searching for collective behavior in a large network of sensory neurons .",
    "_ plos comput biol _ * 10 : * e1003408 .",
    "borst a , theunissen fe ( 1999 ) information theory and neural coding .",
    "_ nat neurosci _ * 2 : * 94757 .    quiroga rq , panzeri s ( 2013 ) decoding and information theory in neuroscience , pg .",
    "139163 . in principles of neural coding , quiroga and panezeri , eds .",
    "( crc press , boca raton , fl , usa ) .",
    "destexhe a , contreras d ( 2006 ) neuronal computations with stochastic network states .",
    "_ science _ * 314 : * 8590 .    major g , tank dw ( 2004 ) persistent neural activity : prevalence and mechanisms .",
    "_ curr opin neurobiol _ * 14 : * 675684 .",
    "ringach dl ( 2009 ) spontaneous and driven cortical activity : implications for computation .",
    "_ curr opin neurobiol _ * 19 : * 439444 .",
    "tsodyks m , kenet t , grinvald a , arieli a ( 1999 ) linking spontaneous activity of single cortical neurons and the underlying functional architecture . _",
    "science _ * 286 : * 19431946 .",
    "kuffler sw , fitzhugh r , barlow hb ( 1957 ) maintained activity in the cat s retina in light and darkness .",
    "_ j gen physiol _ * 40 : * 683702 .",
    "troy jb , lee bb ( 1994 ) steady discharges of macaque retinal ganglion cells .",
    "_ vis neurosci _ * 11 : * 111 - 118 .    shlens j , field gd , gauthier jl , grivich mi , petrusca d , sher a , litke am , chichilnisky ej ( 2006 ) the structure of multi - neuron firing patterns in primate retina . _",
    "j neurosci _ * 26 : * 82548266 .",
    "freeman dk , heine wf , passaglia cl ( 2008 ) the maintained discharge of rat retinal ganglion cells . _ vis neurosci _ * 25 : * 535548 .",
    "bialek w , rieke f , de ruyter van steveninck rr , warland d ( 1991 ) reading a neural code .",
    "_ science _ * 252 : * 18547 .",
    "warland dk , reinagel p , meister m ( 1997 ) decoding visual information from a population of retinal ganglion cells . _ j neurophysiol _ * 78 : * 23362350",
    ".    marre o et al .",
    "( 2015 ) high accuracy decoding of a dynamical motion from a large retinal population .",
    "_ plos comput biol _ * 11 : * e1004304 .",
    "schwartz g , macke j , amodei d , tang h , berry mj 2nd ( 2012 ) low error discrimination using a correlated population code .",
    "_ j neurophysiol _ * 108 : * 106988 .",
    "frechette es et al .",
    "( 2005 ) fidelity of the ensemble code for visual motion in primate retina .",
    "_ j neurophysiol _ * 94 : * 119135 .",
    "pillow jw et al .",
    "( 2008 ) spatio - temporal correlations and visual signaling in a complete neural population .",
    "_ nature _ * 454 : * 9959 .",
    "meytlis m , nichols z , nirenberg s ( 2012 ) determining the role of correlated firing in large populations of neurons using white noise and natural scene stimuli .",
    "_ vision res _ * 70 : * 4453 .",
    "nichols z , nirenberg s , victor jd ( 2013 ) interacting linear and nonlinear characteristics produce population coding asymmetries between on and off cells in the retina . _",
    "j neurosci _ * 33 : * 1495814973 .",
    "paiva arc , park i m , principe jc ( 2009 ) a reproducing kernel hilbert space framework for spike train signal processing . _ neural comput _ * 21 : * 424449 .    marre o et al .",
    "( 2012 ) mapping a complete neural population in the retina . _",
    "j neurosci _ * 32 : * 1485914873 .    memming park i. et al .",
    "( 2013 ) kernel methods on spike train space for neuroscience : a tutorial .",
    "ieee signal processing magazine 30(4 ) .",
    "truccolo w , eden ut , fellows mr , donoghue jp , brown en ( 2005 ) a point process framework for relating neural spiking activity to spiking history , neural ensemble , and extrinsic covariate effects . _",
    "j neurophysiol _ * 14 : * 10741089 .",
    "pillow jw ( 2007 ) likelihood - based approaches to modeling the neural code . in _",
    "bayesian brain : probabilistic approaches to neural coding _ , k doya ,",
    "s shiii , a pouget , r rao eds , pg .",
    "5370 . mit press ( cambridge , ma , usa ) .",
    "truccolo w , hochberg lr , donoghue jp ( 2010 ) collective dynamics in human and monkey sensorymotor cortex : predicting single neuron spikes . _",
    "nature neurosci _ * 13 : * 105113 .",
    "lawhern v , wu w , hatsopoulos n , paninski l ( 2010 ) population decoding of motor cortical activity using a generalized linear model with hidden states .",
    "_ j neurosci methods _ * 189 : * 267280 .",
    "fernandes nm , pinto bdl , almeida lob , slaets jfw , koberle r ( 2010 ) recording from two neurons : second - order stimulus reconstruction from spike trains and population coding . _",
    "neural comput _ * 22 : * 25372557",
    ".    bialek w , zee a ( 1990 ) coding and computation with neural spike trains .",
    "_ j stat phys _ * 59 : * 103115 .",
    "rad kr , paninski l ( 2011 ) information rates and optimal decoding in large neural populations .",
    "_ adv neural proc syst _ * 24 : * 846854 .",
    "boerlin m , deneve s ( 2011 ) spike - based population coding and working memory .",
    "_ plos comput biol _ * 7 : * e1001080 .",
    "boerlin m , machens ck , deneve s ( 2013 ) predictive coding of dynamical variables in balanced spiking networks .",
    "_ plos comput biol _ * 9 : * e1003258",
    ".    deneve s , chalk m ( 2016 ) efficiency turns the table on neural encoding , decoding and noise .",
    "_ curr opin neurobiol _ * 37 : * 141148 .",
    "averbeck bb , latham pe , pouget a ( 2006 ) neural correlations , population coding and computation .",
    "_ nat rev neurosci _ * 7 : * 358366 .",
    "schneidman e , berry mj 2nd , segev r , bialek w ( 2006 ) weak pairwise correlations imply strongly correlated network states in a neural population .",
    "_ nature _ * 440 : * 1007 - 12 .",
    "ecker as et al .",
    "( 2010 ) decorrelated neuronal firing in cortical microcircuits .",
    "_ science _ * 327 : * 584587 .",
    "granot - atedgi e , tkaik g , segev r , schneidman e ( 2013 ) stimulus - dependent maximum entropy models of neural population codes .",
    "_ plos comput biol _ * 9 : * e1002922 .",
    "hyvrinen a , hurri j , hoyer po ( 2009 ) natural image statistics  a probabilistic approach to early computational vision .",
    "springer , london .",
    "nelken i , rotman y , yosef ob ( 1999 ) response of auditory - cortex neurons to structural features of natural sounds .",
    "_ nature _ * 397 : * 154156 .",
    "vinje we , gallant jl ( 2000 ) sparse coding and decorrelation in primary visual cortex during natural vision .",
    "_ science _ * 287 * : 12731276    froudarakis e et al .",
    "( 2014 ) population code in mouse v1 facilitates readout of natural scene through increased sparseness .",
    "_ nat neurosci _ * 17 * : 851 - 860    baudot p et al .",
    "( 2013 ) animation of natural scene by virtual eye - movements evokes high precision and low noise in v1 neurons .",
    "_ front neural circuits _ * 7 * : 206    hughes , a. ( 1979 ) a schematic eye for the rat .",
    "_ vision res _ 19(5):569 - 88 .",
    "kim s - j , koh k , lustig m , boyd s , and gorinevsky d ( 2007 ) an interior - point method for large - scale l1-regularized least squares . _",
    "ieee j sel topics in sign proc _",
    ", 1(4):606 - 617    lampert ch ( 2009 ) kernel methods in computer vision .",
    "foundations and trends in computer graphics and vision 4(3 )    bishop cm ( 2006 ) pattern recognition and machine learning .",
    "springer    mcfarland jm , cui y , butts da ( 2013 ) inferring nonlinear neuronal computation based on physiologically plausible inputs .",
    "_ plos comput biol _ * 9 : * e1003142 .",
    "sd ) number of contributing cells ( red ) and all cells ( black ) , as a function of distance of the cell s receptive field center to the site where the luminance trace is being decoded . * bottom . * average ( @xmath12 sd ) single cell decoding performance as a function of distance to the site .",
    "cells responses contain no decodable information for sites that are @xmath97 distant from their receptive field centers .",
    "both analyses are done for the 10-disc stimulus.,scaledwidth=28.0% ]"
  ],
  "abstract_text": [
    "<S> retinal circuitry transforms spatiotemporal patterns of light into spiking activity of ganglion cells , which provide the sole visual input to the brain . </S>",
    "<S> recent advances have led to a detailed characterization of retinal activity and stimulus encoding by large neural populations . </S>",
    "<S> the inverse problem of decoding , where the stimulus is reconstructed from spikes , has received less attention , in particular for complex input movies that should be reconstructed `` pixel - by - pixel '' . </S>",
    "<S> we recorded around a hundred neurons from a dense patch in a rat retina and decoded movies of multiple small discs executing mutually - avoiding random motions . </S>",
    "<S> we constructed nonlinear ( kernelized ) decoders that improved significantly over linear decoding results , mostly due to their ability to reliably separate between neural responses driven by locally fluctuating light signals , and responses at locally constant light driven by spontaneous or network activity . </S>",
    "<S> this improvement crucially depended on the precise , non - poisson temporal structure of individual spike trains , which originated in the spike - history dependence of neural responses . </S>",
    "<S> our results suggest a general paradigm in which downstream neural circuitry could discriminate between spontaneous and stimulus - driven activity on the basis of higher - order statistical structure intrinsic to the incoming spike trains .    </S>",
    "<S> decoding plays a central role in our efforts to understand the neural code  @xcite . </S>",
    "<S> while statistical analyses of neural responses can be used to directly estimate  @xcite or bound  @xcite the information content of spike trains , such analyses remain agnostic about what the encoded bits might mean or how they could be read out  @xcite . </S>",
    "<S> in contrast , decoding provides an explicit computational procedure for recovering the stimulus from recorded single - trial neural responses , allowing us to ask not only `` how much '' , but also `` what '' the neural system encodes  @xcite . </S>",
    "<S> this is particularly relevant when a rich stimulus is represented by a large neural population  a regime which is increasingly accessible due to recent experimental progress , and the regime that we explore here .    </S>",
    "<S> one of the hallmarks of large - scale neural activity is the presence of spontaneous and persistent spiking  @xcite . while commonly discussed in a cortical context  ( e.g ,  @xcite ) , similar activity </S>",
    "<S> can also be observed in the sensory periphery  @xcite . from the viewpoint of any downstream information processing , </S>",
    "<S> either by the brain itself or by the decoding algorithms we construct , spontaneous activity presents a confound : if erroneously interpreted as having been caused externally , the system will `` hallucinate '' nonexistent stimuli and will likely respond inappropriately . </S>",
    "<S> importantly , similar confounds can also happen locally when stimuli are high dimensional , e.g. , in parts of a visual scene where light intensity does not fluctuate . </S>",
    "<S> can the neural activity be disambiguated so as to enable reliable stimulus representations , and ultimately percepts , even in presence of spontaneous firing ? more generally , </S>",
    "<S> how can complex stimuli be reconstructed from neural activity ? </S>",
    "<S> we address these questions by decoding the outputs of a mammalian retina .    </S>",
    "<S> decoding from large populations presents a significant technical challenge due to its intrinsic high dimensionality . </S>",
    "<S> past work has predominantly addressed this problem using two approaches . in the first approach , </S>",
    "<S> one only presents stimuli that have simple , low - dimensional representations , in order to turn decoding into a tractable fitting ( e.g. , angular velocity of a moving pattern  @xcite , luminance flicker  @xcite , 1d bar position  @xcite , etc . ) or classification problem ( e.g. , shape identity  @xcite , a small set of orientations or velocities  @xcite , etc . ) . </S>",
    "<S> it is unclear , however , how results for simple stimuli can be generalized to naturalistic stimuli even in principle , as the latter have no low - dimensional representation and , furthermore , the retinal responses are nonlinear . in the second approach , </S>",
    "<S> one first builds a probabilistic encoding model , followed subsequently by model - based inference of the most likely stimulus given the observed neural responses  @xcite . theoretically , this procedure is possible for any stimulus , but in practice model inference is feasible only if it incorporates strong dimensionality reduction assumptions ( e.g. , that neurons respond to a linear projection of the stimulus ) . </S>",
    "<S> here we demonstrate a third alternative , where a complex and dynamical stimulus is reconstructed from the output of the mammalian retina directly , by means of large - scale kernelized regression  @xcite . </S>",
    "<S> retina is an ideal experimental system for such a study , because it permits stable recordings from large , diverse , local populations of neurons under controlled stimulation , where even simultaneous neural spiking events can be sorted reliably  @xcite .    </S>",
    "<S> we start by performing linear decoding from the entire recorded retinal ganglion cell population , to separately reconstruct the temporal light intensity trace at each spatial location in the stimulus movie . when using sparse regularization , we extract and subsequently analyze `` decoding fields , '' the decoding counterpart of the cells receptive fields . </S>",
    "<S> we next examine nonlinear decoding using kernel ridge regression ( krr ) , which provides a substantial increase in performance over linear decoding , and isolate spike train statistics that the nonlinear decoder is making use of . </S>",
    "<S> we conclude by examining how these statistics arise in generative models of spike trains and suggest that they might be essential for separating stimulus - driven from spontaneous activity . </S>"
  ]
}