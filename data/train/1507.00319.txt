{
  "article_text": [
    "the significant development of ultrasound technology in the medical field in recent years has led to the need for simulation tools increasingly realistic .",
    "effects like absorption in biological media , nonlinear propagation , heterogeneities , strong focusing , streaming , resonances , multiple scattering or the presence of discontinuities due to tissue layers or rigid boundaries have to be taken into consideration .",
    "the most general approach for ultrasound simulation is to directly solve the constitutive relations of the nonlinear acoustics .",
    "it also allows the explicit calculation of the particle velocity , what can be used to compute important magnitudes as the vector components of the nonlinear acoustic intensity or the acoustic radiation force .",
    "the numerical resolution of the nonlinear constitutive equations in tissue - like medium supposes a difficult problem due to the large size of the region of interest in relation to the size of the acoustic wavelength and the complexity of the model .",
    "simplifying assumptions have been needed in the past for modeling beam patterns from ultrasound transducers , as one - way parabolic approximations , most based on the khokhlov - zabolotskaya - kuznetsov equation ( kzk ) @xcite . to overcome the validity limitations of the parabolic approximations , i.e. for large aperture focused sound sources or modeling sound field near the acoustic source , many one - way numerical methods",
    "have been proposed , including phenomenological approaches @xcite with tissue attenuation @xcite , or based on the one - way formulation of the westervelt equation @xcite .",
    "tissue inhomogeneity can be modeled in these one - way models @xcite , like transmission though tissue layers with refraction , but they do not take into account backscattering and multiple reflections .",
    "more realistic models , e.g. those accounting for scattering from internal tissue structures , are based on the westervelt - type full - wave equations @xcite .",
    "this full - wave equation has been validated for strongly focused sources @xcite . however , due to the assumptions taken in the derivation of the westervelt equation , the accuracy of this model is limited in practical situations as ( @xmath1 ) the modeling of rigid boundaries where the thermo - viscous boundary layer effects are not - negligible , i.e. in general case where the particle velocity field becomes rotational , ( @xmath2 ) situations where the second order lagrangian density of acoustical energy not vanish , i.e. near the source or in situations where plane progressive waves does not exist and the acoustic field becomes complex due to multiple scattering , reverberation or resonances , ( @xmath3 ) situations where the equilibrium - state particle velocity is not null , including the self generation of acoustic streaming .",
    "@xcite chap . 3 for further discussion .",
    "the recent development of computational capacity has made possible to consider the full constitutive relations ( i.e. without the assumptions discussed above ) .",
    "thus , for small - amplitude acoustic waves , the linearized pressure - velocity formulation of constitutive relations in inhomogeneous media was solved by means of finite - differences in time - domain ( fdtd ) methods with frequency independent losses by manry et al .",
    "@xcite , or using two - step maccormack finite - differences scheme by mast et al . @xcite .",
    "also , relaxation processes can be included in finite difference methods in an efficient way in order to model tissue attenuation and dispersion @xcite .",
    "furthermore , @xmath0-space numerical methods have also been applied to solve the linearized first order equations in lossless inhomogeneous media @xcite . in order to account for soft tissue losses ,",
    "the computational solution of the fractional laplacian by @xmath0-space spectral methods have demonstrated to be extremely efficient due to the spatial frequency domain representation of the acoustic field @xcite .    in the case of nonlinear constitutive relations models ,",
    "the evolution of the acoustic magnitudes have been simulated in time - domain by means of finite differences schemes such as dispersion relation preserving method ( drp ) in ideal fluids and axisymmetric domains @xcite .",
    "thermo - viscous losses in finite - differences methods have been widely used , see sparrow et al .",
    "@xcite . in order to introduce tissue attenuation in the governing equations time - dependent fractional derivatives",
    "can be included by convolutional operators .",
    "thus , in ref .",
    "@xcite an efficient method has been presented , but although the memory requirements can be strongly reduced compared to direct convolutions the algorithm employs up to ten auxiliary fields and a memory buffer of three time steps . furthermore , construction of specific causal memory functions that models soft tissue attenuation and dispersion in navier - stokes equations is also possible @xcite , but certain time history must be stored in memory and in this case the computational domain was restricted to one dimensional propagation .    in order to overcome those numerical limitations , recently @xmath0-space and pseudo - spectral numerical methods",
    "have been applied to constitutive relations in nonlinear regime to solve fractional laplacian operators efficiently @xcite .",
    "furthermore , in the case of domains of hundreds of wavelengths , when the cumulative phase error due to numerical dispersion of standard finite - difference schemes can not be neglected , those spectral numerical methods have reported an improvement in accuracy of the numerical solution .",
    "this two factors , i.e. the negligible numerical dispersion and the efficient resolution of fractional laplacian operators , have led the spectral methods to be widely used in practical applications . however , their main limitation is that the implementation of natural space discontinuities due to tissue layers or rigid boundary conditions leads to errors in the reconstruction of the spectral information due to the poor convergence of fourier series at jumps , i.e. the well - known gibbs oscillations . preventing this kind of errors",
    "is typically achieved by filtering the spatial spectrum @xcite , so the theoretical spatial minimum sampling of two point per wavelength becomes larger .",
    "in addition , these errors propagate globally and affect to the accuracy all over the domain , in contrast with locally propagating errors in finite differences methods .",
    "on the other hand , taking into account the spatial discontinuity due to symmetry boundary condition , axisymmetric domains becomes not feasible by standard @xmath0-space methods , and full 3d domains must be employed even for axisymmetric configurations .",
    "those errors can be prevented by means of the recently developed fourier continuation ( fc ) method @xcite .",
    "however , the discontinuities formed due to shock propagation are still not solved by fc methods and other additional numerical treatment must be applied for correctly describe shock formation , e.g. intensive computations by high order accurate weighted essentially non - oscillatory schemes ( fc / weno ) @xcite .",
    "unlikely , the computational times increases by using those intensive computational techniques and the multiresolution analysis to detect discontinuities in the domain .",
    "the aim of the present work is to present a generalization of the constitutive relations of nonlinear acoustics including multiple relaxation processes in a non - convolutional formulation that allows the time - domain numerical solution by an explicit finite differences numerical scheme .",
    "frequency power law attenuation based in relaxation have been applied in the same way than it has been applied to generalized burgers equation @xcite , khokhlov - zabolotskaya - kuznetsov ( kzk ) model @xcite and westervelt equation @xcite .",
    "the relaxation parameters have been fitted to both exact frequency power law attenuation and empirically measured attenuation of a variety of tissues that does not fit an exact power law .",
    "two processes have been enough to model tissue attenuation with acceptable accuracy over a frequency range covering about 4 octaves , as it was demonstrated by yang et al .",
    "a numerical technique based on artificial relaxation is included to control the non - negligible numerical dispersion of the fdtd method and improve stability when shock waves are present in the solution .",
    "the method includes backscattering and arbitrary propagation direction of finite amplitude beams , and can be specially suitable in axisymmetric configurations where the computational resources for full 3d @xmath0-space methods are prohibitive .",
    "the paper is organized as follows : in sec .",
    "[ s : model ] the model equations that describes the problem are exposed , sec .  [",
    "s : numerical ] describes the computational method presented in this work and in sec .  [ s : validation ] the method is validated comparing the numerical results with analytic solutions for linear , smooth and discontinuous nonlinear waves . in sec .",
    "[ s : result ] solutions for frequency power law media are presented and compared with analytic and numerical solutions obtained by @xmath0-space methods as benchmark case . furthermore , an experimental test was presented where a focused beam propagating in castor oil has been modeled .",
    "finally , a high intensity focused source in the high nonlinear regime focusing in soft - tissue is modeled .",
    "the principles of mass and momentum conservation lead to the main constitutive relations for nonlinear acoustic waves , which for a fluid can be expressed as @xcite @xmath4    and @xmath5    where @xmath6 is the total density field , @xmath7 is the particle velocity vector , @xmath8 is the pressure , and @xmath9 and @xmath10 are the coefficients of shear and the bulk viscosity respectively .",
    "the acoustic waves described by this model exhibit viscous losses with quadratic power law dependence on frequency . in order to include a power law frequency dependence on the attenuation",
    ", a multiple relaxation model will be added into the time domain equations .",
    "the basic mechanism for energy loss in relaxing media is the appearance of a phase shift between the pressure and density fields .",
    "this behavior is commonly modeled as a time dependent relation at the fluid state equation , that for a fluid retaining the material nonlinear effects up to second order an be expressed as @xcite : @xmath11    where @xmath12 is the density perturbation over the stationary density @xmath13 , @xmath14 is the nonlinear parameter , @xmath15 is the small amplitude sound speed , and @xmath16 is the kernel associated with the relaxation mechanism .",
    "the first two terms of the right hand side of eq .",
    "( [ eq : st_cont ] ) describe the instantaneous response of the medium , where the convolutional third term accounts for the  memory time \" of the relaxing media .",
    "thus , by choosing an adequate time function for the kernel @xmath16 the model can present an attenuation and dispersion response that fits the experimental data of the heterogeneous media . however , the direct resolution of the constitutive relations eqs .",
    "( [ eq : continuity]-[eq : st_cont ] ) in this integral form is a complex numerical task due to the convolutional operator .",
    "thus , instead of describe @xmath16 with a specific time domain waveform , the response of the heterogeneous medium can be alternatively described by a sum of @xmath17 relaxation processes with exponential time dependence as : @xmath18    with the @xmath19-th order relaxation kernel expressed as @xmath20    where @xmath21 is the heaviside piecewise function @xmath22 , @xmath23 , @xmath24 is the characteristic relaxation time and @xmath25 the relaxation parameter for the @xmath19-th order process .",
    "this last dimensionless parameter controls the amount of attenuation and dispersion for each process as @xmath26 , where @xmath27 is the sound speed in the high frequency limit associated to @xmath19-th order relaxation process , also known as the speed of sound in the  frozen \" state @xcite . in order to describe relaxation without the need of including a convolutional operator",
    ", we shall define a state variable @xmath28 for each process as @xmath29    thus , using the convolutional property @xmath30 , the time derivative of the relaxation state variable obeys the following relation for the @xmath19-th order process : @xmath31    where @xmath32 is the dirac delta function .",
    "using the eq .",
    "( [ eq : sn ] ) this relation becomes a simple ordinary differential equation for each process as : @xmath33    using again convolutional properties , we can substitute eq .",
    "( [ eq : dsdt ] ) into eq .",
    "( [ eq : relax_define ] ) , and the relaxing nonlinear state eq .",
    "( [ eq : st_cont ] ) becomes : @xmath34    moreover , if  frozen \" sound speed for @xmath17 mechanisms is defined as @xmath35 , eq .",
    "( [ eq : st_final_c0 ] ) leads to : @xmath36    due to the smallness of the relaxation parameter , @xmath25 , i.e. when weak dispersion is modeled , the sound speed in the high frequency limit reduces to @xcite : @xmath37    note eq .",
    "( [ eq : st_final_cinf ] ) for a mono - relaxing media is equivalent to that can be found in literature @xcite @xmath38    thus , the constitutive relations to solve by means of the numerical method in the nonlinear regime are the continuity eq .",
    "( [ eq : continuity ] ) , the motion eq .",
    "( [ eq : momentum ] ) and the second order fluid state relaxing eq .",
    "( [ eq : st_final_cinf ] ) , where the state variable @xmath28 obeys the relation eq .",
    "( [ eq : dsdt ] ) for the @xmath19-th order relaxation process .",
    "although the aim of this work is to model biological media , the generalized formulation presented here can be used to describe the attenuation and hence the dispersion observed in other relaxing media , as the relaxation processes of oxygen and nitrogen molecules in air or the relaxation associated with boric acid and magnesium sulfate in seawater @xcite .      if small amplitude perturbations are considered , an equivalent derivation of this model can be expressed for multiple relaxation media @xcite .",
    "thus , for an homogeneous inviscid relaxing fluid , the linearized continuity and motion eq .",
    "( [ eq : continuity]-[eq : momentum ] ) reduces to @xmath39    and @xmath40    and linearizing the fluid state eq .",
    "( [ eq : st_final_cinf ] ) we obtain : @xmath41    these equations can be solved directly in this form , however , if expressed in pressure - velocity formulation the density field is no longer necessary and computational effort can be reduced .",
    "thereby , assuming a linear  instantaneous \" compressibility @xmath42 , and substituting eq .",
    "( [ eq : lin_st ] ) into eq .",
    "( [ eq : lin_cont ] ) yields @xmath43    then , taking the time derivative of the state variable eq .",
    "( [ eq : dsdt ] ) we get @xmath44    finally , substituting again the linearized state eq .",
    "( [ eq : lin_st ] ) and arranging terms the linearized continuity equation leads to @xmath45    on the other hand , the state evolution equation can be expressed as a function of the acoustic pressure as @xmath46    thus , the linearized governing eq .",
    "( [ eq : lin_momen ] , [ eq : lin_pconti ] ) for a relaxing media are expressed in a pressure - velocity formulation and can be solved together with the coupled state evolution eq .",
    "( [ eq : lin_dsndt ] ) by means of standard finite differences numerical techniques @xcite . in this way",
    ", lossless linear acoustics equations can be obtained by setting @xmath47 or in the limit when the relaxation times @xmath48 . the relaxation behavior described by this linearized model",
    "is achieved too by the formulation described by @xcite , where the relaxation coefficients @xmath25 and the relaxation variable @xmath28 are defined in a different , but analogous way .",
    "in this section the numerical techniques for solving the complete set of equations ( continuity eq .",
    "( [ eq : continuity ] ) , momentum eq .",
    "( [ eq : momentum ] ) , state eq .",
    "( [ eq : st_final_cinf ] ) and the relaxation eq .",
    "( [ eq : dsdt ] ) ) are presented .",
    "the numerical method is based on a second order fdtd method where multiple relaxation processes are included in order to : first , modeling physical attenuation and dispersion at the frequencies of interests and second , correct the numerical dispersion and include artificial attenuation to guarantee convergence in nonlinear regime .",
    "moreover the inclusion of relaxation processes in the presented formulation require only one extra field per relaxation process and no memory buffer is needed .",
    "cylindrical axisymmetric @xmath49 coordinate system is considered in this work , however , the method can be derived in other coordinate systems . as in the standard acoustic fdtd method @xcite",
    ", the particle velocity fields are discretized staggered in time and space respect to the density and pressure fields . as shown in fig .",
    "[ fig1_fdtd_grid ] uniform grid is considered , where @xmath50 , @xmath51 , @xmath52 , with @xmath53 and @xmath54 as the radial and axial spatial steps , and @xmath55 is the temporal step .     and",
    "the @xmath19-th order relaxation process state fields @xmath56 are evaluated at same discrete location as the density @xmath57 .",
    "particle velocity fields are discretized staggered in both space and time respect to the density , pressure and the @xmath19-th order state fields . ]",
    "centered finite differences operators are applied over the partial derivatives of the governing equations .",
    "thus , spatial interpolation is needed over the off - center grid variables in order to fulfill the conservation principles over each discrete cell of the domain @xcite .",
    "the @xmath58 component of eq .",
    "( [ eq : momentum ] ) is expressed in a cylindrical axisymmetric system as @xmath59    each term of the above expression is approximated by centered finite differences evaluated at @xmath60 , @xmath61 , @xmath62 .",
    "this equation can be solved obtaining an update equation for @xmath63 . in the same way , the @xmath64 component of the motion eq .",
    "( [ eq : momentum ] ) is expressed as @xmath65    this equation is approximated by centered finite differences and evaluated at @xmath66 , @xmath67 , @xmath68 .",
    "an update equation is obtained solving this equation for @xmath69 .",
    "equation  ( [ eq : continuity ] ) in cylindrical axisymmetric coordinate system is expressed as @xmath70    following the same procedure , each term of the above expression is approximated by centered finite differences and evaluated at @xmath71 , @xmath72 , @xmath73 , and the update equation is obtained solving this expression for @xmath74 .",
    "a leap - frog time marching is applied to solve eq .",
    "( [ eq : mot_r]-[eq : cont_cyl ] ) for each time step until the desired simulation time is reached .",
    "finally , eq .  ( [ eq : dsdt ] ) is locally solved for @xmath75 by and explicit fourth - order runge - kutta method and then eq .  ( [ eq : st_final_cinf ] ) is used for update the pressure field .",
    "the staggered grid is terminated on velocity nodes , so the boundary conditions are applied on these external nodes , allowing to prevent the singularity of the cylindrical coordinate system : due to the staggered grid , the only variable discretized at @xmath76 is @xmath77 , and axisymmetric condition @xmath78 is applied there .",
    "furthermore , to solve spatial differential operators at boundaries some  ghost \" nodes must be created with the conditions : @xmath79 , @xmath80 , @xmath81 and @xmath82 .",
    "perfectly matched layers ( pml ) @xcite were placed in the limits of the domain ( @xmath83 and @xmath84 ) to avoid spurious reflections from the limits of the integration domain . inside the pml domains linearized acoustic equations",
    "were solved using the complex coordinate screeching formulation @xcite . for a layer of 30 elements and a broadband incident wave with 1 mhz central frequency and non - normal incidence angle ,",
    "these absorbent boundary conditions have reported a reflection coefficient of @xmath85  db .",
    "however , the performance of the pml is amplitude dependent as long as the nonlinear terms are uncoupled to the pml domains . the amplitude dependence of the reflection coefficient is shown in fig .",
    "[ fig2_pml ] , where a pml of 25 layers have reported reflection coefficients @xmath86  db for waves in linear regime and highly nonlinear waves including shocks .",
    "the stability for the lossless linear fdtd algorithm follows the courant - friedrich - levy ( cfl ) condition , that for uniform grid @xmath87 the maximum duration of the time step is limited by @xmath88 where @xmath89 is the number of dimensions ( i.e. @xmath90 in cylindrical axisymmetric coordinate system ) .",
    "that condition essentially states that for a single time step information can not propagate in the numerical grid a distance longer that one cell .",
    "however , if relaxation is included numerical instabilities have been observed when @xmath91 . due to this empirical relation ,",
    "the maximum values for relaxation frequencies are limited too by the chosen spatial discretization by the simple relation @xmath92 where @xmath93 is the maximum relaxation frequency for all processes , @xmath94 is the number of spatial samples per wavelength and @xmath95 the frequency of the propagating wave .",
    "on the other hand , nonlinear effects induce the progressively growing of harmonics of the fundamental frequency of the initial wave . the diffusive viscous terms in eq .",
    "( [ eq : momentum ] ) , attenuates the small - amplitude high - spatial frequencies , damping the  node to node \" numerical oscillations and ensuring numerical stability in weakly nonlinear regime .",
    "thus , for a smooth solution the numerical algorithm shows consistency when @xmath96 , so if stability is achieved by the cfl condition , the convergence is guaranteed .",
    "however , in strongly nonlinear regime , i.e. when sharp waveforms or even shocks are present in the solution , extra numerical techniques must be employed to guarantee convergence .",
    "artificial viscosity can be added when shock waves are present in the solution where a common implementation follows a fourth order spatial filtering @xcite .",
    "thus , the artificial attenuation retrieved by this spatial operator is fourth power of frequency : the low frequency components of the solution remains quasi - undamped , while the higher spatial frequencies are strongly attenuated .",
    "in this way , the solution is smoothed and shock thickness depends on the artificial viscosity coefficient .     and _ anomalous _ dispersion relation for a mono relaxing acoustic media . the straight line @xmath97 represents the reference nondispersive case . ]",
    "however , the main drawback for finite difference methods is numerical dispersion , where the analytic dispersion relation can be expressed in 1d as @xmath98 , with the courant number @xmath99 . in this way",
    ", numerical dispersion reduces phase speed for high frequency components so traveling sharp solutions develop tail oscillations : the low wavenumbers travels fast and left behind high spatial frequencies . in nonlinear regime , is well - known that the combined effects of nonlinearity and strong dispersion can lead rich phenomena , e.g. beatings in the generated harmonics , pulsations on the vertex of a sawtooth wave or soliton formation in strong dispersive media @xcite . in this way",
    ", the numerical dispersion by discreteness of the fdtd methods couple to the physical nonlinearity can lead to a great variety of non - physical or even unstable solutions .    in order to overcome those two limitations , i.e. the generation of harmonics over the discrete limit and the numerical dispersion , we propose the use of artificial relaxation . as fig .",
    "[ artificial_dispersion ] shows , physical relaxation processes introduces _ anomalous _ dispersion , i.e. the phase speed increases in the high frequency regime , opposite to the numerical ( lattice ) dispersion of the finite differences scheme .",
    "thus , by introducing a collection of relaxation processes and choosing its adequate relaxation parameters the high frequency numerical dispersion can be compensated . as a consequence , introduction of those relaxation processes in the high frequency lead to the inevitable inclusion of artificial attenuation .",
    "however , this numerical attenuation is then exploited to limit the growing of higher harmonics in a similar way than artificial viscosity @xcite .",
    "it is worth noting here that , due to the attenuation using artificial relaxation is , at maximum , only second power of frequency , the low frequency range of the solution is therefore also attenuated .",
    "thus , the proposed method is restricted to lossy media .",
    "the adequate relaxation parameters that corrects the numerical dispersion have been found by multi - objective optimization techniques , where two cost function are proposed : one for dispersion and other for attenuation . in the first case ,",
    "the error between the goal ( ideal ) dispersion relation and the retrieved numerical dispersion corrected by multiple artificial relaxation and is evaluated in the high frequency regime . finally , the second cost function is the error between the desired ( ideal ) attenuation and the artificial attenuation evaluated in the low frequency regime .",
    "continuous lines represent the frequency range included by the optimization , while dashed lines shows the not optimized frequency range . as a consequence of correcting dispersion , attenuation increases in the high frequency range , as shown in the top subplot .",
    "this extra attenuation is used as artificial attenuation for numerical - nonlinear stability . ]    a canonical case of a physical single relaxation process is presented . in order to correct numerical dispersion the parameters of two extra artificial relaxation processes",
    "have been found using the multi - objective genetic algorithms provided by the optimization toolbox in matlab r2014a v8.03 .",
    "linear propagation was considered and simulation parameters were set to typical values for water : @xmath100 m / s , @xmath101 kg / m@xmath102 , @xmath103 , @xmath104 pa@xmath105s .",
    "a single physical relaxation process was included , with a characteristic relaxation time of @xmath106 and @xmath107 mhz , and relaxation modulus of @xmath108 that leads to a frozen sound speed of @xmath109 m / s . in this case , the numerical parameters were set to @xmath110 m and @xmath111 s. a plane wave traveling in @xmath112 direction was considered .",
    "thus , the theoretical attenuation for the relaxation processes and including viscosity can be expressed as @xmath113    and the theoretical phase velocity can be predicted as @xcite @xmath114    in order to compute the attenuation and dispersion of the numerical method , simulated pressure was recorded at two locations @xmath115 and @xmath116 , and attenuation and phase velocity were estimated from the spectral components over the bandwidth of the input signal . the numerical attenuation was calculated as @xmath117    where @xmath118 is the fourier transform of the measured pressure waveforms at points @xmath115 and @xmath116 . on the other hand ,",
    "the phase velocity was computed as @xmath119    where correct phase unwrapping is needed in the @xmath120 function .    in this way ,",
    "[ optimized_pareto_single ] shows the retrieved pareto front of the optimization , where 3 different areas can be distinguished . the first area , marked as ( a ) in fig .",
    "[ optimized_pareto_single ] , represents individuals whose numerical dispersion is minimal but attenuation is not optimal .",
    "on the other hand , the individuals around area ( b ) represent a set of relaxation parameters that provides the best agreement between numerical and physical attenuation . a good compromise between both situations",
    "can be obtained in the central area of the pareto front ( c ) , where retrieved attenuation and dispersion in the low frequency band shows good agreement with the physical , and the numerical dispersion has been corrected over a wide frequency range . however , as can be seen in the inset of fig .",
    "[ optimized_pareto_single ] , the dispersion relation retrieved by all the cases corrects the fdtd lossless numerical dispersion relation .",
    "the phase speed of those tree individuals is shown in fig .",
    "[ optimized_att_and_cphase ]  b ) , where it can be seen that in the frequency range selected for the optimization the numerical phase speed is corrected for all the individuals , where the best fit is obtained for individuals in the pareto front area a. on the other hand , the inclusion of artificial relaxation leads to an increasing of the attenuation in the high frequency range , as is shown in fig .",
    "[ optimized_att_and_cphase ]  a ) . in this way , as the phase speed error is reduced the effect of artificial attenuation increases .",
    "although this increasing can be seen as a non - desired counterpart , the appearance of this attenuation is useful in order to control the harmonic growing in nonlinear regime in the same way as artificial viscosity spatial operators @xcite .      .",
    "( b ) nonlinear steady state solution for @xmath121 .",
    "inset shows detailed shock numerical solution for artificial relaxation ( @xmath122 markers ) and artificial viscosity ( @xmath123 markers ) .",
    "( c ) nonlinear steady state solution for @xmath89=0.01.,width=283 ]    in order to validate the method in the nonlinear regime a full - wave simulation was developed in a mono - relaxing media using above parameters .",
    "thus , the analytical ( inverted ) solution for the steady solution with @xmath124 for @xmath125 , @xmath126 for @xmath127 and @xmath128 for @xmath129 , for the retarded time @xmath130 reads @xcite @xmath131    where @xmath132 measures the ratio of relaxation effects to nonlinear effects . for @xmath133 , where no shock is present",
    ", the solution retrieved by fdtd algorithm shows good agreement with analytical and no artificial attenuation is needed .",
    "however , for @xmath134 a discontinuity is present in the solution and convergence is only possible with the inclusion of extra numerical techniques .",
    "thus , fig .",
    "[ shock_optim_dall ]  ( a - c ) shows the analytical and numerical solutions including artificial relaxation and artificial viscosity , where excellent agreement is achieved in all cases . in the case of artificial viscosity , higher harmonics are strongly attenuated and by reducing grid step convergence can be achieved .",
    "due to artificial viscosity operator is essentially a low pass spatial filter , a smoothed version of the shock is achieved .",
    "however , the phase speed of the higher spatial frequencies present in the shock is modified due to numerical dispersion , and for @xmath135 ( fig .",
    "[ shock_optim_dall ]",
    "( b , c ) ) oscillations appears in the tail of the discontinuity , leading to the appearance of non - physical solutions .    on the other hand ,",
    "the proposed method of artificial attenuation by relaxation also limits the harmonic growing so a smooth version of the shock appears .",
    "moreover , artificial relaxation also corrects phase velocity so all the spatial frequencies travels at same speed and no oscillatory tail appears .",
    "the case of @xmath136 is shown in fig .",
    "[ shock_optim_dall ]  ( c ) , where nonlinear effects strongly dominates over attenuation . in this case ,",
    "tail oscillations provided by artificial viscosity increases in amplitude . in contrast , by including artificial relaxation a smoothed version of the shock is captured and accuracy is maintained .",
    "$ ] and the attenuation retrieved . ]    using methodology described above , the optimal relaxation parameters were obtained in order to fit the multiple - relaxation numerical attenuation to frequency power law attenuation in the form @xmath137    where @xmath138 is the power law exponent and @xmath139 the power law coefficient in np ( rad / s)@xmath140m@xmath141 . moreover ,",
    "the numerical dispersion was corrected by means of artificial relaxation in order to fit the corresponding frequency power law dispersion , where its analytical form satisfying causality can be expressed as @xcite @xmath142    this expression is valid for @xmath143 with @xmath144 , and an alternate equation can be found @xcite in the limit for @xmath145 . here ,",
    "simulation parameters were @xmath100 m / s , @xmath101 kg / m@xmath102 , @xmath103 , @xmath146 pa@xmath105s , @xmath147 mhz , @xmath148 m , @xmath149 s ; that leads to 26 elements per wavelength and a cfl number of 0.9 .",
    "only two independent relaxation processes were employed in this section to obtain the target frequency power laws .    $ ] . ]",
    "following the above procedure , the relaxation times @xmath24 and relaxation modulus @xmath25 were optimized for different frequency power laws covering the range of that observed in tissues @xmath150 $ ] . the attenuation coefficient @xmath139 was chosen for each power law to present an attenuation @xmath151 db / cm / mhz@xmath152 .",
    "the fitting was developed over the typical frequency range for medical ultrasound applications , i. e. 1 to 20 mhz for both attenuation and phase speed .",
    "the results for the attenuation and phase speed curves are plotted in fig .",
    "[ fig : attenuation_4 ] and fig .",
    "[ fig : phase_velocity_4 ] , where the theoretical and the numerical predictions agree over the frequency range used for the fitting .       for each frequency region ( i.e. the slope of the curve ) .",
    "]    although a frequency power law dependence can describe the ultrasound attenuation over a finite frequency range , the attenuation data of some particular examples shows variation of the exponent over the entire frequency range @xcite .",
    "thus , fig .",
    "[ fig_tissues ] shows experimental attenuation data curves for some tissues where the local slope of the power law changes over the measured frequency range .",
    "this behavior can be modeled by a sum of relaxation processes by optimizing the relaxation parameters as described above .",
    "thus , the results show that most tissues with locally variable @xmath138 can be fitted by only a pair of relaxation processes , as the same way that for constant - slope frequency power law attenuation@xcite .    in this way",
    ", table  [ table:2:error ] shows the error of the numerical attenuation relative to the experimental data .",
    "the percent relative error was computed as @xmath153 , where @xmath154 is the experimental attenuation data , @xmath155 and @xmath156 define the frequency range of the measurement .",
    ".error of the optimized attenuation response relative to the experimental data for @xmath17 total relaxation processes . [ cols=\"<,^,^,^,^,^ \" , ]     [ table:3:deltac ]    using kramers - kronig relations @xcite , the variations of sound speed @xmath157 can be predicted by the frequency dependent attenuation .",
    "table [ table:3:deltac ] shows the variation of sound speed observed in the numerical solution over the fitted frequency range .",
    "the magnitude of these variations are of the order of magnitude of those measured experimentally in this frequency range , and the frequency dependence observed for the variation is roughly linear as observed in real tissue@xcite .",
    "as expected from the relations between dispersion and absorption @xcite , the magnitude of the variation in sound speed increases as the total variation of the absorption increases for a given frequency range .         and",
    "@xmath158 for thermo - viscous attenuation ( @xmath159 ) .",
    "mendousse analytical solution ( black line ) , @xmath0-space ( gray line ) and fdtd numerical solution ( markers ) .",
    "( bottom ) spatial distribution of the first ten harmonics for mendousse analytical solution ( black line ) , @xmath0-space ( gray line ) and fdtd numerical solution ( markers).,title=\"fig : \" ] +   and @xmath158 for thermo - viscous attenuation ( @xmath159 ) .",
    "mendousse analytical solution ( black line ) , @xmath0-space ( gray line ) and fdtd numerical solution ( markers ) .",
    "( bottom ) spatial distribution of the first ten harmonics for mendousse analytical solution ( black line ) , @xmath0-space ( gray line ) and fdtd numerical solution ( markers).,title=\"fig : \" ]    [ fig : harm_z_g2 ]     and @xmath158 in a tissue - like media with frequency power law @xmath160 .",
    "@xmath0-space ( gray line ) and fdtd numerical solution ( markers ) .",
    "( bottom ) spatial distribution of the first ten harmonics for @xmath0-space ( gray line ) and fdtd numerical solution ( markers).,title=\"fig : \" ] +   and @xmath158 in a tissue - like media with frequency power law @xmath160 .",
    "@xmath0-space ( gray line ) and fdtd numerical solution ( markers ) .",
    "( bottom ) spatial distribution of the first ten harmonics for @xmath0-space ( gray line ) and fdtd numerical solution ( markers).,title=\"fig : \" ]    [ fig : harm_z_g1_6 ]    in order to study the convergence of the numerical calculations to an analytical solution of the model in the nonlinear regime , a medium with frequency squared dependence attenuation is implemented using the adequate relaxation times and relaxation modulus as explained above .",
    "the numerical solution is compared with the analytical solution for a plane wave traveling through a thermo - viscous fluid proposed by mendousse @xcite : @xmath161    where @xmath162 is the goldberg number , defined for power law media as @xmath163 , with absorption length @xmath164 , shock formation distance @xmath165 and normalized distance @xmath166 ; with the parameter of nonlinearity @xmath167 and the acoustic mach number @xmath168 , with @xmath169 is the source particle velocity and @xmath0 the wavenumber .",
    "figure  [ fig : harm_z_g2 ]  ( top ) presents the simulated waveforms at @xmath170 and @xmath158 .",
    "the wave steepening due to nonlinear processes in the absence of dispersion are well resolved by the numerical method presented here . in order to study the accuracy of the algorithm",
    ", the amplitude of the first ten harmonics has been extracted for numerical and analytic solutions and plotted versus @xmath171 in fig .",
    "[ fig : harm_z_g2 ]  ( bottom ) .",
    "the observed relative error of the computational method decreases due to grid coarsening by a square law ( i.e. the numerical scheme is second order accuracy ) .",
    "the magnitude of the error mainly depends on the number of elements per wavelength but , due to not ideal dispersion , also on the traveled propagated distance . including the correction of dispersion by artificial relaxation , for a path length of 100 @xmath172 , a grid of 26 elements per wavelength was needed to obtain a relative error below 1 % for the third harmonic .",
    "obviously , the relative error of the first and second harmonics will be always lower , i.e. the fundamental component error was 0.072 % .",
    "in addition , the solution was compared also to the obtained by a @xmath0-space method applied to the constitutive relations , i.e. the @xmath0-wave algorithm @xcite .",
    "this method was selected due to the low numerical dispersion and the possibility of including frequency power law attenuation .",
    "the result of both computational methods and eq .",
    "( [ eq : medousse ] ) agree over all the spectral components analyzed , showing convergence to the analytic solution .      in the case of frequency power law attenuation media with @xmath173",
    "no general analytic solution exist in nonlinear regime for monochromatic progressive waves .",
    "thus , in order to study convergence in this regime , the proposed fdtd solution was compared with the solution obtained by @xmath0-space methods @xcite . by using same physical and grid parameters in both methods ,",
    "the solutions agrees for different power laws .",
    "thus , fig .",
    "[ fig : g16_pt ]  ( top ) shows the good agreement for the waveforms measured at @xmath174 and @xmath175 obtained for @xmath176 , where the characteristic asymmetry effect of media with _ anomalous _ dispersion ( e.g. relaxing , boundary layer effects)@xcite is observed : the shock front after the rarefaction phase is followed by a rounded positive compression profile . the spatial distribution for each harmonic is shown in fig .",
    "[ fig : harm_z_g1_6 ]  ( bottom ) , where it is observed that the proposed fdtd solution with optimized attenuation and dispersion converges to the obtained by pseudo - spectral methods up to ten harmonics . as in the case of frequency squared media , grid refinement numerical tests have reported a second order accuracy of the fdtd method in nonlinear regime .",
    "an experiment was designed to test the validity of the algorithm for intense beams in frequency power law attenuation media .",
    "the source was formed by a plane single element piezoceramic crystal ( pz 26 , ferroperm piezoceramics , denmark ) mounted in a custom designed steel housing and a polymethyl methacrylate ( pmma ) focusing lens with aperture @xmath177 mm and radius of curvature @xmath178 mm .",
    "the source was driven with a sinusoidal pulse burst of frequency @xmath179 mhz and @xmath180 cycles using a function generator ( 14 bits , 100 ms / s , model pxi5412 , national instruments ) and a linear rf amplifier ( eni 1040l , 400w , 55db , eni , rochester , ny ) .",
    "the pressure waveforms were acquired with a hnr 500 @xmath181 m needle pvdf hydrophone ( onda corp , ca ) , and a digitizer ( 64 ms / s , model pxi5620 , national instruments ) was used . a three - axis micropositioning system ( owis gmbh , germany )",
    "was used to move the hydrophone in three orthogonal directions with an accuracy of 10 @xmath181 m .",
    "the amplitude frequency response of the hydrophone was compensated in post - processing but not in phase due to the absence of phase calibration for this equipment .",
    "the source was completely immersed in a castor oil tank ( @xmath182 mm ) .",
    "we select this frequency power law attenuation media due to the low variability of its acoustic properties along existent literature @xcite . using a sound speed inside the bulk of the lens @xmath183 m / s , and a sound speed of the castor oil of @xmath184 m / s ( at 26 c room temperature ) , the effective lens geometrical focal is estimated as @xmath185 mm , leading to a linear lossless gain of @xmath186 .    on the other hand , a nonlinear simulation including diffraction and frequency power law attenuation with same parameters",
    "was carried out in a workstation ( 20 cores intel xeon e5 - 2680 cpu , 2.8ghz with 256 gb ram ) .",
    "the boundary conditions were implemented for a spherical focused ultrasound source .",
    "the castor oil parameters at 26 c room temperature @xcite , were @xmath184 m / s , @xmath187 kg / m@xmath102 , @xmath188 db / cm / mhz@xmath152 , @xmath189 , @xmath190 .",
    "the grid parameters were @xmath191 @xmath192 m and @xmath193 ns , leading to a cfl number @xmath194 and @xmath195 elements per wavelength at fundamental frequency , note that this grid leads to @xmath196 for third harmonic .    ) , second ( @xmath123 ) and third ( @xmath122 ) obtained by the numerical ( continuous line ) and experimental methods ( markers ) for a focused transducer immersed in castor oil . ]",
    "the balance between nonlinear effects and power law attenuation can be estimated by using the goldberg ratio , @xmath197 where @xmath198 is the shock formation distance and @xmath199 the media attenuation characteristic length .",
    "thus , the amplitude of the source were selected to obtain a goldberg ratio of @xmath200 in order to let the frequency power law attenuation effects slightly dominate over nonlinear effects . on the other hand ,",
    "the ratio between diffraction effects and nonlinear effects can be described by the so called khokhlov number @xcite as @xmath201 , where @xmath202 is the diffraction length and @xmath203 the source radius . for the proposed test a khokhlov number of @xmath204 was selected to let the nonlinear effect slightly dominate over diffraction effects .",
    "the selected excitation pressure amplitude was @xmath205 kpa .",
    "the results are summarized in fig .",
    "[ fig : axial_castor ] , where axial pressure distribution for the fundamental , second and third harmonic are presented .",
    "a good agreement is found between simulations and the experimental test . only far to the focal point",
    "the amplitude there exist differences between computations and experiments , that can be caused by nonuniform vibration of the source @xcite , boundary effects of the pmma lens , or miss - alignment of the source axis and micro - positioning system orthogonal directions along the 100 mm axial measurement .",
    "the maximum amplitudes of the first harmonic were @xmath206 mpa for the experiment and @xmath207 for the numeric .",
    "the second harmonic peak pressure was @xmath208 kpa and @xmath209 kpa , and the third harmonic peak pressure @xmath210 and @xmath211 kpa for the experimental and numeric respectively .",
    "the relative errors between numerical and experimental results are @xmath212 % for the fundamental frequency , @xmath213 % for the second harmonic and @xmath214 % for the third .",
    "no error estimation was done for the peak pressure due to the absence of a phase calibration of the hydrophone .      ) and minimum rarefaction ( @xmath215 ) pressure for a focused beam propagating through a liver tissue layer .",
    "( top ) weakly nonlinear propagation ( @xmath216 ) and ( bottom ) strong nonlinear effects ( @xmath217 ) .",
    "the insets show the waveforms recorded at the geometrical focal.,title=\"fig : \" ] + ) and minimum rarefaction ( @xmath215 ) pressure for a focused beam propagating through a liver tissue layer .",
    "( top ) weakly nonlinear propagation ( @xmath216 ) and ( bottom ) strong nonlinear effects ( @xmath217 ) .",
    "the insets show the waveforms recorded at the geometrical focal.,title=\"fig : \" ]    ) and minimum rarefaction ( @xmath215 ) pressure for a focused beam propagating through a liver tissue layer .",
    "( boundary marked with dashed line ) for @xmath217 .",
    "colorbars are in @xmath218 units . ]    in order to test the algorithm in the very high nonlinear regime with realistic tissue parameters a focused bowl of geometrical focal @xmath219 mm and aperture @xmath177 mm , driven at @xmath147 mhz was numerically tested .",
    "these parameters leads to a source gain @xmath220 and a @xmath221-number@xmath222 , showing that source is beyond the paraxial limit .",
    "the media consist in two layers .",
    "the first layer , where the source was located , was water at 20 c with parameters @xmath223 m / s , @xmath224 kg / m@xmath102 , @xmath225 , @xmath226 db / cm mhz@xmath140 , @xmath227 . at a distance @xmath228 mm , a layer of human liver tissue",
    "was placed , therefore the focal spot is located inside tissue at a depth of 15 mm .",
    "liver tissue parameters @xcite were @xmath229 , @xmath230 kg / m@xmath102 , @xmath231 , @xmath232 db / cm mhz@xmath140 , @xmath233 . in this case , the numerical grid parameters were @xmath191 @xmath192 m and @xmath234 ns , leading to a cfl number @xmath235 and @xmath195 elements per wavelength at fundamental frequency ( @xmath196 for third harmonic ) .",
    "figure  [ fig : cut_insets ] shows the spatial peak pressure profiles for different excitation amplitudes . in fig .",
    "[ fig : cut_insets ]  ( top ) the pressure of the source was @xmath236 mpa , while in the bottom figure was increased to @xmath237 mpa .",
    "thus , for the selected parameters , fig .",
    "[ fig : cut_insets ]  ( top ) present results for @xmath216 and @xmath238 , so the attenuation effects dominates over nonlinear effects and nonlinearity slightly dominates over diffraction effects . in this way , low asymmetry is observed between the positive compression peak , @xmath239 , and the minimum rarefaction pressure distribution , @xmath215 .",
    "the calculated waveform at @xmath240 , shown in the inset of fig .",
    "[ fig : cut_insets ]  ( top ) , is weakly distorted .",
    "however , there exist differences between its normalized peak amplitude @xmath241 and @xmath242 , and the source characteristic linear gain , @xmath220 .",
    "they are caused , in one hand by the attenuation effects , where the value of the lossy linear gain observed was @xmath243 measured at @xmath240 , i.e. the amplitude at the focal was reduced to 87.2% of the lossless amplitude .",
    "on the other hand , the differences due to the asymmetry between compression and rarefaction cycles are caused by the combined effect of nonlinearity and focusing .    if source amplitude is increased to @xmath237 mpa , as shown in fig .",
    "[ fig : cut_insets ]  ( bottom ) , the ratio between attenuation and nonlinear effects is increased to @xmath217 . in this regime ,",
    "nonlinear effects are almost of the same order of attenuation effects . on the other hand",
    ", increasing source amplitude while keeping same transducer parameters implies also the khokhlov number changes to @xmath244 , so the nonlinearity clearly dominates over diffraction effects . in this regime , highly asymmetric pressure distribution",
    "is observed , where the values at focal point are @xmath245 mpa and @xmath246 mpa .    other typical nonlinear phenomena characteristic of high intensity focused sources can also be observed : formation of sharp shock front and its corresponding harmonic generation , or , as fig .",
    "[ fig : mapp_10 ] shows , narrowing of the beam for @xmath239 and broadening for @xmath215 pressure distributions .",
    "in addition , nonlinear focal shift , i.e. displacement of the peak pressure relative to the position of the linear peak pressure can be also predicted for tissue propagation . in the case of @xmath217",
    "it was observed a nonlinear focal shift @xmath247 mm and @xmath248 mm for the @xmath239 and @xmath215 pressure distribution respectively .",
    "a general model based on the full constitutive relations of nonlinear acoustics in relaxing media have been presented in a time - domain formulation which does not require convolutional operators .",
    "a numerical solution by means of finite - differences in time - domain have been obtained , showing that the theoretical attenuation and dispersion due to relaxation processes can be achieved by the numerical method with accuracy .",
    "these results can be also used to model typical relaxation process of other relaxing media ( e. g. the processes observed in air , associated to the molecules of oxygen and nitrogen , or in seawater , associated to the relaxation of boric acid and magnesium sulfate ) .",
    "moreover , a method for modeling frequency power law attenuation by means of multiple relaxation has been implemented in the constitutive relations .",
    "the proposed method can describe local variations of the exponent of the frequency power law , so an arbitrary attenuation curve in the range @xmath249 can be modeled by means of the proper optimization of the relaxation coefficients .",
    "this feature of the presented method is an advantage when compared with most fractional derivatives methods , where the attenuation follows an exact but unique frequency power law over the entire frequency range .",
    "a broad range of human tissues have been modeled and the goodness of the fit using from two to four relaxation processes has been discussed .",
    "furthermore , a computational technique that exploits the _ anomalous _ dispersion of the relaxation processes is employed to mitigate the numerical dispersion of the finite - differences scheme .",
    "thus , while phase speed is corrected by including artificial relaxation processes , its corresponding artificial attenuation is used to improve stability in the nonlinear regime . in this way , smooth and stable versions of shock waves have been obtained and compared with its analytic solution .",
    "furthermore , the validity of the algorithm including diffraction have been tested with experimental measurements of a focused beam in castor oil .    due to the model",
    "is developed from the constitutive relations for nonlinear acoustics , most wave phenomena is captured . as a difference from the one - way models the proposed model implicitly includes multiple wave direction , and , due to the lagrangian density of acoustic energy",
    "is implicitly included in the computation , multiple scattering and strong resonance effects can be accurately described . moreover , unlike kzk and other parabolic approximations , the proposed model captures the diffraction exactly , so for simulation of acoustic beams the field is not approximated only to the beam axis , but also in the near field and far to the beam axis and thus high focused devices can be simulated .",
    "the code has shown to be particularly appropriate if the problem to simulate presents axisymmetry , because the constitutive relations for nonlinear acoustics are solved in a computational 2d domain , while standard @xmath0-space methods need to employ full 3d domains due to the poor convergence of the fourier series at discontinuities ( @xmath76 ) .",
    "this is the case , for example , of the focused ultrasound transducer simulated in sec .",
    "[ s : res : hifu ] , where a full 3d solution will require huge computational resources and calculation times .",
    "finally , due to the particle velocity vector and the acoustic density fields are solved implicitly by the code , this information can be used to estimate other relevant magnitudes as the full nonlinear intensity vector , the nonlinear acoustic radiation forces in these absorbing media or the acoustic streaming generated in frequency power law attenuation fluids .",
    "the authors acknowledge financial support from the fpi program of the universitat politcnica de valncia .",
    "46ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]",
    " + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase    10.1121/1.3614550 [ * * ,   ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * , ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop _ _  ( ,  ,  )  p.   @noop * * ,   ( ) @noop * * , ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * , ( ) link:\\doibase    10.1121/1.4742722 [ * * ,   ( ) ] link:\\doibase 10.1016/j.jcp.2011.08.024 [ * * ,   ( ) ] @noop _ _ ,  cambridge texts in applied mathematics  ( ,  ,  )  p.   @noop _ _ ,  studies in soviet science  ( ,  , )  p.   @noop _ _  ( ,  ,  )  p.   @noop * * ,   ( ) @noop _ _ ,  edited by  ( ,  , )  p.   link:\\doibase 10.1121/1.419657 [ * * ,   ( ) ] link:\\doibase 10.1121/1.426812 [ * * ,   ( ) ] @noop * * ,   ( ) @noop _ _  ( , ,  )  p.   link:\\doibase 10.1121/1.385566 [ * * ,   ( ) ] @noop * * , ( ) @noop * * ,   ( )"
  ],
  "abstract_text": [
    "<S> a time - domain numerical code based on the constitutive relations of nonlinear acoustics for simulating ultrasound propagation is presented . to model frequency power law attenuation , such as observed in biological media , multiple relaxation processes are included and relaxation parameters are fitted to both exact frequency power law attenuation and empirically measured attenuation of a variety of tissues that does not fit an exact power law . a computational technique based on artificial relaxation </S>",
    "<S> is included to correct the non - negligible numerical dispersion of the numerical method and to improve stability when shock waves are present . </S>",
    "<S> this technique avoids the use of high order finite difference schemes , leading to fast calculations . </S>",
    "<S> the numerical code is especially suitable to study high intensity and focused axisymmetric acoustic beams in tissue - like medium , as it is based on the full constitutive relations that overcomes the limitations of the parabolic approximations , while some specific effects not contemplated by the westervelt equation can be also studied . </S>",
    "<S> the accuracy of the method is discussed by comparing the proposed simulation solutions to one - dimensional analytical ones , to @xmath0-space numerical solutions and also to experimental data from a focused beam propagating in a frequency power law attenuation media . </S>"
  ]
}