{
  "article_text": [
    "quantum compiling algorithms decompose ( exactly , without approximations ) an arbitrary @xmath0 unitary matrix acting on @xmath1 qubits , into a sequence of elementary operations ( seo ) . by elementary operations we mean operations that act on only a few ( usually 1 or 2 ) qubits ( for example , all single - qubit rotations and cnots . ) the most efficient quantum compiling algorithms to date are based on a recursive application of the cosine - sine decomposition ( csd ) , a technique first proposed in ref.@xcite .",
    "an implementation of the algorithm of ref.@xcite may be found in the computer program called qubiter ( patented , c++ source code publicly available at www.ar-tiste.com ) .",
    "long after ref.@xcite and qubiter came out , many papers on quantum compiling via recursive csd have appeared .",
    "these can be easily tracked down by making a keyword search in arxiv or google for something like (  cosine - sine \" and  decomposition \" and  quantum \" ) .",
    "we will call the number of cnots in a seo its length .",
    "( single - qubit rotations are not counted because these can be performed much faster than cnots . ) of course , there are many possible ways of decomposing a unitary matrix into a seo , and some of these decompositions have shorter length ( are more efficient ) than others .",
    "the algorithm of ref.@xcite per se does not yield the shortest seo .",
    "finding an optimum ( shortest ) decomposition is a very hard task , and is not our intention here .",
    "a less ambitious , more doable task is to find methods for optimizing small segments of a seo .",
    "call these methods piecewise optimizations .",
    "the hope is that given any seo , one can apply piecewise optimization methods to reduce the original seo into an equivalent seo whose length is much less , and might even be close to the shortest possible length .",
    "an analogy to our piecewise optimization strategy is the following .",
    "think of a seo as being like a path between two points in a manifold .",
    "if this path is initially unnecessary long , one might hope to make it a little less so by breaking it into pieces and optimizing the length of each piece . breaking it into pieces again , and optimizing each piece again .",
    "and so on .",
    "piecewise optimizations involve replacing a small quantum circuit by an equivalent one with fewer cnots .",
    "two circuits are said to be equivalent if one of them multiplied by some external local operations equals the other . by external local operations , we mean single - qubit rotations applied at the beginning or end of the circuit .",
    "this equivalence relation between circuits has its own class functions , which we call circuit invariants .",
    "many excellent papers already exist on the use of such invariants in quantum computing .",
    "see , for example , refs .",
    "@xcite , @xcite , @xcite , and @xcite .",
    "such invariants are a crucial ingredient of this paper .",
    "( however , the paper does not assume that the reader possesses any prior knowledge about these invariants .",
    "the paper is self - contained in this regard . )    besides circuit invariants , another important ingredient of this paper is what we call dressed cnots ( dc - nots ) .",
    "dc - nots are a simple yet very useful generalization of standard cnots .",
    "to my knowledge , this paper is the first one to consider dc - cnots .",
    "dc - nots are convenient because they lump together a cnot and some single - qubit rotations .",
    "modulo external local operations , one can express any circuit solely in terms of a single type of circuit element ( dc - cnots ) , rather than having to express it with two different types of circuit elements ( cnots and single - qubit rotations ) .",
    "after discussing circuit invariants and dc - nots , this paper gives some methods for simplifying 2-qubit and 3-qubit circuits .",
    "much is already known about simplifying 2-qubit circuits .",
    "ref.@xcite shows , via cartan s kak decomposition@xcite , that a 2-qubit circuit with any number of cnots can always be reduced to a circuit with 3 cnots .",
    "refs.@xcite and @xcite give necessary and sufficient conditions for when a 2-qubit circuit with 3 cnots reduces to fewer than 3 cnots . in this paper",
    ", we spend some time re - proving these already known 2-qubit results using the new language of circuit invariants and dc - nots .",
    "this exercise yields new techniques and new geometrical insights that were lacking in previous proofs .    in this paper",
    ", we also present some interesting new ways of simplifying 3-qubit circuits .",
    "our results for 3-qubit circuits rely heavily on our results for 2-qubit circuits .",
    "we include with this paper software ( written in octave / matlab ) that checks many of the algorithms proposed in the paper . in the header of each section , and in the table of contents , each section name is followed by a list in square brackets of the names of the octave m - files relevant to that section .",
    "our software is not intended to be very efficient , or to be free of all conceivable loopholes .",
    "it is only intended to be a proof of principle of our algorithms .",
    "in this section , we discuss notation , linguistic idiosyncrasies and abbreviations that will be used in subsequent sections . if any notation in this paper remains unclear to the reader after reading this section , he should consult ref.@xcite , a review article , written by the author of this paper , that uses the same notation as this paper .",
    "we will often use the symbol @xmath2 for number of bits , and @xmath3 for the corresponding number of states .",
    "we will often abbreviate @xmath4 and @xmath5 by @xmath6 and @xmath7 , respectively .",
    "we will often use a subscript of @xmath8 to denote the final value of quantity that changes ( e.g. , @xmath9 changes to @xmath10 ) .",
    "when we say @xmath11 , we mean @xmath12 . when we write @xmath13 , we mean , the quantity obtained by replacing @xmath14 by @xmath15 everywhere in @xmath16",
    "likewise , by @xmath17 we mean , the quantity obtained by swapping @xmath14 and @xmath15 everywhere in @xmath16 . when we say  @xmath18 is @xmath19 \" we mean  @xmath20 is @xmath21 and @xmath22 is @xmath23 \" .",
    "lhs and rhs will stand for left - hand side and right - hand side .  rhon basis `` will stand for ' ' right - handed orthonormal basis \" .",
    "let @xmath24 .",
    "let @xmath25 denote the real numbers , @xmath26 the complex numbers , @xmath27 all integers ( positive and negative ) . for integers @xmath28 and @xmath29",
    ", @xmath30 will denote all integers from @xmath28 to @xmath29 , including @xmath28 and @xmath29 .",
    "if @xmath31 is anyone of the symbols @xmath32 , and @xmath33 is any set , define @xmath34 if the right hand side is defined .",
    "for example , @xmath35 are the positive integers . as usual , for any set @xmath33 and @xmath36 , @xmath37 will denote the set of r - tuples of @xmath33 , and @xmath38 , the set of @xmath39 matrices with entries in @xmath33 .    as usual , @xmath40 will denote the @xmath41 unitary matrices , and @xmath42 the special ( i.e. , with determinant=1 ) elements of @xmath40 . given any @xmath43",
    ", we define @xmath44 by @xmath45^{\\frac{1}{\\ns}}$ ] , where we choose the principal branch of the function @xmath46 .",
    "we will refer to @xmath44 as the  special counterpart \" of @xmath20 .",
    "( here the adjective  special \" again means  with determinant=1 \" ) .",
    "@xmath47 will denote the set of all 3 dimensional real vectors , and @xmath48 . as is common in the physics literature , a letter with an arrow ( ditto , caret ) over it , as in @xmath49 ( ditto , @xmath9 ) will denote an element of @xmath47 ( ditto , @xmath50 ) . @xmath49 and",
    "@xmath9 will be treated as column vectors when they appear in matrix expressions .",
    "let @xmath51 for @xmath52 .",
    "we will use the following non - standard notation for r - fold cross products : = ( ( ( _ 1_2)_3)_r ) .",
    "for example , @xmath53 .",
    "of course , an ( r+2)-fold cross - product can be reduced to an r - fold cross - product using the well known ",
    "bac minus cab \" identities : for @xmath54 , @xmath55 and @xmath56 .",
    "for example , if @xmath57 are perpendicular unit vectors , then @xmath58 .",
    "suppose @xmath59 .",
    "@xmath60 will denote the angle between @xmath49 and @xmath61 , defined up to @xmath62 .",
    "we will say @xmath49 is parallel to @xmath61 and write @xmath63 iff @xmath64 ; i.e. , iff @xmath65 , or @xmath66 , or @xmath67 .",
    "we will say @xmath49 is perpendicular to @xmath61 and write @xmath68 iff @xmath69 . for @xmath70 , define @xmath71 , * the part of @xmath49 along @xmath61 * , by    = .",
    "for @xmath70 , define @xmath72 , * the part of @xmath49 across @xmath61 * , by    = - = - = .",
    "for any square matrix @xmath20 , @xmath73 will denote its transpose , @xmath74 , its complex conjugate , and @xmath75 , its hermitian conjugate .",
    "@xmath76 will denote the kronecker delta function.(it equals one if @xmath77 and zero otherwise . )",
    "let @xmath78 be the 2d identity matrix and pauli matrices . sometimes , we set @xmath79 and denote the pauli matrices by @xmath80 .",
    "suppose @xmath81 .",
    "define the number operators : @xmath82 and @xmath83 .",
    "note that @xmath84 .",
    "usually , @xmath85 is denoted merely by @xmath86 and @xmath87 by @xmath88 .",
    "if @xmath89 for @xmath90 , let @xmath91 , where any incidence of @xmath92 on the rhs is replaced by @xmath93 .",
    "for example , @xmath94 .    @xmath95 $ ] is the one - bit hadamard matrix and @xmath96 is its @xmath1-fold tensor product . @xmath97",
    "satisfies @xmath98 , @xmath99 , @xmath100 and @xmath101 .",
    "suppose @xmath102 and @xmath103 .",
    "we will abbreviate @xmath104 by @xmath105 .",
    "the standard terminology is to call @xmath106 a * quaternion * , and to call @xmath105 a vector quaternion ( divided by @xmath107 ) . to shorten this terminology",
    ", we will refer to @xmath105 as a * paulion * , and call @xmath49 its * defining vector*. if @xmath108 , we will call @xmath105 a * unit paulion*. one can reduce a product of two paulions by using the identity @xmath109 . for @xmath110 ,",
    "define number operators @xmath111 and @xmath112 .",
    "note that @xmath113 .",
    "if @xmath114 or @xmath115 for @xmath90 , let @xmath91 .",
    "suppose @xmath116 is the set of all matrices @xmath117 that can be expressed in the form @xmath118 , where @xmath119 for all @xmath120 .",
    "suppose @xmath121 is the set of all matrices @xmath122 that can be expressed in the form @xmath123 , where @xmath119 for all @xmath120 .",
    "for every @xmath124 , let @xmath125 or @xmath126 represent the @xmath127 matrix with entries @xmath128 , where @xmath129 .",
    "( the symbol @xmath130 was chosen to evoke the mental picture of a column vector times a row vector ; such is the output of the function @xmath131 ) . for every @xmath132 ,",
    "define @xmath133 .",
    "it s easy to check that @xmath134 so the map @xmath135 is 1 - 1 onto .",
    "let @xmath136 be the set of linear combinations over @xmath26 of elements of @xmath116 , and @xmath137 of @xmath121 .",
    "the map @xmath130 can be extended to @xmath138 , @xmath139 .",
    "@xmath140 is also a 1 - 1 onto map .",
    "henceforth , we will use @xmath130 to refer to both @xmath130 and its extension @xmath140 .",
    "given a matrix @xmath141 , we will call @xmath142 its gamma representation . often , in contexts where this will not lead to confusion , we will drop the @xmath130 superscript and denote @xmath142 simply by @xmath20 .",
    "the next theorem , although almost trivial , will be used frequently in this paper .",
    "[ th - double - cover ] the map @xmath143 , @xmath144 is well defined and onto . in other words : ( well - defined ) if @xmath145 , then @xmath146 . ( onto ) if @xmath147 , then there exist @xmath148 such that @xmath149 .",
    "( well defined ) given @xmath150 , one can always find an angle @xmath151 such that @xmath152 and @xmath153 .",
    "let @xmath154 .",
    "it follows that @xmath155 .",
    "( onto ) given @xmath156 , where @xmath157 and @xmath158 , one can always find a ( non - unique ) pair of unit vectors @xmath9 and @xmath159 in the plane perpendicular to @xmath160 , such that @xmath161 , and @xmath162 points in the @xmath160 direction .",
    "hence , @xmath163 and @xmath164 .",
    "it follows that @xmath165 .",
    "one has :    _ _ _ = _ ( _ + _ ) _ = _ - _ = _ - = _ _ f .",
    "[ eq - paulion - reflection ] a geometrical interpretation of this identity is shown in fig.[fig - paulion - rot]a .",
    "the similarity transformation @xmath166 takes the paulion @xmath167 to @xmath168 , where @xmath10 is the reflection of @xmath9 on @xmath169 .",
    "suppose @xmath170 , and we want to find @xmath147 such that @xmath171 .",
    "such a @xmath172 can be constructed as a product of two paulions ( see fig.[fig - paulion - rot]b ) .",
    "indeed , let @xmath161 and @xmath173 .",
    "let @xmath169 be the vector that bisects the angle between @xmath9 and @xmath159 , and is oriented so that @xmath174 points along @xmath175 .",
    "note that @xmath159 can be obtained by reflecting @xmath9 on the bisector @xmath169 .",
    "_ = e^i _ , _",
    "= _ _ _ . combining these two results yields",
    "_ = ( _ _ ) _ ( _ _ ) = e^-i _ _ e^i _ .",
    "in this section , we will discuss circuit invariants ; i.e. , functions that map all equivalent circuits to the same value . by equivalent circuits we mean circuits that are equal , modulo external local operations .",
    "suppose @xmath20 and @xmath21 are elements of @xmath40 ( i.e. , they are @xmath1-qubit gates ) .",
    "we will say @xmath20 and @xmath21 are * equivalent under local operations on the right hand side ( lo - rhs ) * , and write @xmath176 , iff there exist @xmath177 for @xmath178 such that    b = a ( u_-1  u_2 u_1 u_0 ) .",
    "[ eq - def - lo - rhs ] @xmath179 is clearly an equivalence relation as it is symmetric , reflexive and transitive .",
    "henceforth , we will say that a function @xmath180 with domain @xmath40 is a lo - rhs invariant if for any @xmath181 , @xmath176 implies that @xmath182 for some @xmath183 ( @xmath184 may depend on @xmath185 ) .",
    "a frequent goal is to find a complete set of scalar invariant functions ; that is , a set of functions @xmath186 such that for any @xmath187 , @xmath176 if and only if @xmath188 for all @xmath189 .",
    "an extensive literature already exist on such invariants .",
    "they were first studied by group theorists , and , in more recent times , they have been used by quantum computerists @xcite , @xcite , @xcite , @xcite .    one can define an analogous equivalence relation @xmath190 for local operations on the left hand side ( lo - lhs ) , and an equivalence relation @xmath191 for local operations on both sides ( lo-2s ) . of course , the equivalence classes ( e - classes ) of @xmath179 are a disjoint partition of @xmath40 .",
    "ditto for the e - classes of @xmath192 and @xmath191 .",
    "it s also clear that any e - class for @xmath179 is contained in an e - class for @xmath191 , and that some e - classes of @xmath191 contain more than one e - class of @xmath179 .",
    "( in fact , the e - classes of @xmath179 contained within a single e - class of @xmath191 , can be labeled by the elements of @xmath193 ) .",
    "note that for any @xmath194 ,    ^t_= - _ .[eq - neg - sig ] hence , for @xmath195 and @xmath194 ,    ^t = e^i(- _ ) .",
    "thus , when @xmath147 ( but not when @xmath196 ) , @xmath197 .",
    "for any @xmath43 , define a quadratic ( second order in @xmath20 ) invariant    a^(2 ) = a ^ a^t ^ .",
    "for example , for @xmath198 , @xmath199 .",
    "[ th - quad - invar ]    1 .    2 .   for @xmath200",
    ", @xmath176 if and only if @xmath201 for some @xmath202 .",
    "3 .   for @xmath203 , @xmath176 if and only if @xmath204 for some @xmath183 .    1 .",
    "assume @xmath205 .",
    "@xmath20 can always be represented in the form + a = i^n(a ) ( i a_jk_x_j x_k ) ( i a_j_x_j 1 ) ( i a_k _ 1 x_k ) , [ eq - a - su4 ] where @xmath206 and @xmath207 .",
    "( note that @xmath208 so @xmath209 . )",
    "we are using einstein s implicit summation convention , and @xmath210 range over @xmath211 . by eqs.([eq - neg - sig ] ) and ( [ eq - a - su4 ] ) , + a^t = i^n(a ) ( -i a_k _ 1 x_k ) ( -i a_j_x_j 1 ) ( i a_jk_x_j x_k ) .",
    "thus + a^(2 ) = ( -1)^n(a ) ( i 2a_jk_x_j x_k ) .",
    "[ eq - a - su4-invar ] likewise , @xmath21 can be represented in the form + b = i^n(b ) ( i b_jk_x_j x_k ) ( i b_j_x_j 1 ) ( i b_k _ 1 x_k ) , [ eq - b - su4 ] where @xmath212 and @xmath213 .",
    "then + b^(2 ) = ( -1)^n(b ) ( i 2b_jk_x_j x_k ) .",
    "[ eq - b - su4-invar ] + suppose @xmath176 .",
    "looking at eqs.([eq - def - lo - rhs ] ) , ( [ eq - a - su4 ] ) and ( [ eq - b - su4 ] ) , we see that for every @xmath210 , there exists an integer @xmath214 such that @xmath215 . therefore , + ( i 2a_jk_x_j x_k)= ( i 2b_jk_x_j x_k ) .",
    "[ eq - gist - rproof ] therefore , looking at eqs.([eq - a - su4-invar ] ) and ( [ eq - b - su4-invar ] ) , we see that there exists an integer @xmath86 such that @xmath201 .",
    "+ suppose @xmath201 .",
    "then , looking at eqs.([eq - a - su4-invar ] ) and ( [ eq - b - su4-invar ] ) , we see that for every @xmath210 , there exists an integer @xmath214 such that @xmath216 . therefore , +",
    "( i a_jk_x_j x_k)= ( i b_jk_x_j x_k ) _ j , k[i _ x_j x_k]^n_jk .",
    "[ eq - gist - lproof ] therefore , from eqs.([eq - def - lo - rhs ] ) , ( [ eq - a - su4 ] ) and ( [ eq - b - su4 ] ) , we see that @xmath176 .",
    "2 .   assume @xmath217 .",
    "eqs.([eq - a - su4 ] ) and ( [ eq - a - su4-invar ] ) still apply except that we must replace in them @xmath218 by @xmath219 and @xmath220 by @xmath221 for some @xmath222 .",
    "eqs.([eq - b - su4 ] ) and ( [ eq - b - su4-invar ] ) still apply except that we must replace in them @xmath223 by @xmath224 and @xmath225 by @xmath226 for some @xmath227 .",
    "+ suppose @xmath176 .",
    "eq.([eq - gist - rproof ] ) still applies so there exists @xmath183 such that @xmath204 .",
    "+ suppose @xmath204 .",
    "eq.([eq - gist - lproof ] ) still applies so @xmath176 .    by virtue of theorem",
    "[ th - quad - invar ] , the absolute value of the entries of the matrix @xmath228 are a complete set of lo - rhs scalar invariants for @xmath229 .",
    "theorem [ th - quad - invar](a ) reflects the fact that when @xmath200 , since @xmath20 and @xmath21 must both have unit determinant , the only local operations connecting @xmath20 and @xmath21 are either elements of @xmath230 or @xmath107 or products of these .",
    "applying an @xmath230 gate to the rhs of @xmath20 does not change @xmath228 , whereas applying @xmath107 changes @xmath228 to its negative .",
    "now suppose @xmath231 .",
    "one can represent any @xmath232 as    @xmath233    when the continuous parameters of @xmath20 are small , a^(2 ) e^in(a)[1 + 2i ( a_jk_1x_j x_k+ a_jk_x_j 1 x_k+ a_jk_x_j x_k 1 ) ] .",
    "this @xmath228 is independent of the @xmath234 parameters .",
    "so , for @xmath235 , @xmath236 or @xmath237 is a necessary but not a sufficient condition for @xmath176 .",
    "more invariants than just @xmath228 are needed for @xmath238 .",
    "higher order invariants can be generated as follows .",
    "we will represent them diagrammatically using the symbols defined in fig.[fig - invars - symb ] .",
    "fig.[fig-3bit - invar ] shows second and fourth order invariants under lo - rhs for a circuit with 3 bits .",
    "the same idea can be used to generate invariants of order equal to any even number , for any number of qubits .",
    "fig.[fig - show - are - invars ] explains why the circuits portrayed in fig.[fig-3bit - invar ] are invariant under lo - rhs . roughly speaking ,",
    "if we apply a @xmath147 to the rhs of @xmath232 , then , in the diagram of a fourth order invariant , a copy of @xmath172 must be inserted next to each of the 4 copies of @xmath20 . and",
    "these 4 copies of @xmath172 annihilate each other .",
    "this paper will only use the second order invariant @xmath228 .",
    "we will not even use group theory in this paper . for information on the group theoretic underpinnings of quantum circuit invariants , see , for example , ref.@xcite .",
    "in this section , we define dressed cnots , a simple yet powerful generalization of the standard cnot . we also discuss some simple properties of dressed cnots that will be used in subsequent sections .",
    "the * controlled not ( cnot ) * with control bit 1 and target bit 0 , is defined by    c @c=1em @r=1em @!r & & + & &    = ( -1)^n_x(0)n(1 ) = _ x(0)^n(1 ) .",
    "now suppose @xmath172 and @xmath239 are arbitrary elements of @xmath230 .",
    "define @xmath9 and @xmath240 by @xmath241 and @xmath242 .",
    "then a * dressed cnot ( dc - not ) * connecting bits 0 and 1 , is defined by    c @c=1em @r=1em @!r & & + & &    =    c @c=1em @r=1em @!r & & & & + & & & &    = ( -1)^n_(0 ) n_(1 ) = _ ( 0)^n_(1 ) = _ (1)^n_(0 ) .",
    "we will refer to the vectors @xmath240 and @xmath9 as the * defining vectors * of the dc - not .    sometimes in this paper",
    ", we will draw a circuit containing one or more dc - nots whose oval nodes are empty . by this",
    "we will mean that the omitted defining vectors are arbitrary and their precise value is unimportant in that context .",
    "consider the wire corresponding to bit @xmath243 in a quantum circuit . within the bit-@xmath243 wire ,",
    "consider two adjacent oval nodes belonging to two different dc - nots : @xmath244 if @xmath245 , we will say there is a * breach * at that position in the bit-@xmath243 wire .",
    "if @xmath246 , we will say there is a * foil * at that position in the bit-@xmath243 wire .",
    "c @c=1em @r=1em @!r & & + & &    = ( 1 + _ 1 , + _",
    ",1 - _  , ) .    _",
    "(1)^n_(0 ) = _ (1)n_(0 ) + _ ( 0 ) = ( 1 + _ 1 , + _",
    ",1 - _  , ) .",
    "(    c @c=1em @r=1em @!r & & + & &    ) ^2 = 1 .",
    "@xmath247 .",
    "c @c=1em @r=1em @!r & & + & &    =    c @c=1em @r=1em @!r & & & + & & &    .",
    "[ eq - dcnot - with - neg ]    ^n_(1)= ( -1)^n_(1)_(0)^n_(1)= _ (1)_(0)^n_(1 ) .    in subsequent sections",
    ", we will often need to calculate the effect of a similarity transformation produced by pre and post multiplying an operator by the same dc - not",
    ". the next theorem will be useful for performing such calculations .",
    "c @c=1em @r=1em @!r & & & & + & & & &    = _ 1,+ _  , .",
    "[ eq - sim - trans - of - sig - veca ]    clearly ,    c @c=1em @r=1em @!r & & & & + & & & &    = _ 1 ,",
    ". [ eq - sim - transf - parallel - part ] on the other hand ,    c @c=1em @r=1em @!r & & & & + & & & &    =    c @c=1em @r=1em @!r & & & & + & & & &    = _  , .",
    "[ eq - sim - transf - perp - part ]",
    "in this section we prove what we call a  wake identity \" .",
    "we call it thus because in it , one dc - not is pushed through another , producing a third dc - not as its  wake \" .",
    "suppose @xmath248 .",
    "@xmath249 & \\qw & \\qw & \\qw \\\\ & \\ovalgate{\\hatb ' } & \\foil & \\ovalgate{\\hata'}\\qwx[1 ] & \\qw \\\\ & \\qw & \\qw & \\ovalgate{\\hata '' } & \\qw } \\end{array } & = & \\begin{array}{c } \\qcircuit @c=1em @r=1em @!r { & \\qw & \\ovalgate{\\hatb}\\qwx[1 ] & \\ovalgate{\\hatb}\\qwx[2 ] & \\qw \\\\ & \\ovalgate{\\hata'}\\qwx[1 ] & \\ovalgate{\\hatb ' } & \\qw & \\qw \\\\ & \\ovalgate{\\hata '' } & \\qw & \\ovalgate{\\hata '' } & \\qw } \\end{array } \\label{eq - wake - on - right } \\\\ & = & \\begin{array}{c } \\qcircuit @c=1em @r=1em @!r { & \\ovalgate{\\hatb}\\qwx[2 ] & \\qw & \\ovalgate{\\hatb}\\qwx[1 ] & \\qw \\\\ & \\qw & \\ovalgate{\\hata'}\\qwx[1 ] & \\ovalgate{\\hatb ' } & \\qw \\\\ & \\ovalgate{\\hata '' } & \\ovalgate{\\hata '' } & \\qw & \\qw } \\end{array } \\;.\\end{aligned}\\ ] ]    c @c=1em @r=1em @!r & & & & & & + & & & & & & + & & & & & &    & = & _ (1)^n_(2 ) _",
    "(1)^n_(0 ) _",
    "(1)^n_(2 ) + & = & [ ( -1)^n_(2 ) _",
    "(1)]^n_(0 ) + & = & ( -1)^n_(2)n_(0 ) _",
    "(1)^n_(0 ) + & = &    c @c=1em @r=1em @!r & & & + & & & + & & &    .",
    "in this section , we discuss certain dc - not identities associated with the qubit exchange operator ( a.k.a . swap operator or swapper ) .",
    "we will represent the swapper by a double arrow connecting the two qubits being swapped . by definition ,",
    "the swapper satisfies    c @c=1em @r=1em @!r & & & + & & &    =    c @c=1em @r=1em @!r & & & + & & &    for any @xmath196 . as is well known ( for a proof , see , for example , ref.@xcite )",
    ", the swapper can be expressed as a product of 3 cnots :    c @c=1em @r=1em @!r & & + & &    =    c @c=1em @r=1em @!r & & & & + & & & &    .",
    "the next theorem shows that the swapper can also be expressed as a product of 3 dc - nots .",
    "suppose @xmath250 , @xmath147 , @xmath251 , and @xmath252 .",
    "c @c=1em @r=1em @!r & & + & &    & = &    c @c=1em @r=1em @!r & & & & & & [ eq - swapper - two - vecs ] + & & & & & &     + & = &    c @c=1em @r=1em @!r & & & & & & & + & & & & & & &    [ eq - swapper - four - vecs ] .",
    "since @xmath250 , there exists @xmath253 such that @xmath254 and @xmath255 . then    c @c=1em @r=1em @!r & & + & &    =    c @c=1em @r=1em @!r & & & & + & & & &    =    c @c=1em @r=1em @!r & & & & & & + & & & & & &    =    c @c=1em @r=1em @!r & & & & + & & & &    .",
    "this proves eq.([eq - swapper - two - vecs ] ) .",
    "eq.([eq - swapper - four - vecs ] ) follows from    c @c=1em @r=1em @!r & & + & &    =    c @c=1em @r=1em @!r & & & & & + & & & & &    .",
    "we will refer to the next identity , eq.([eq-2thirds ] ) , as the 2/3-swapper identity , because its lhs contains 2/3 of a swapper .",
    "[ th-2thirds ]    for any @xmath256 ,    [ eq-2thirds ] @xmath257 & \\ovalgate{\\hatz}\\qwx[1 ] & \\qw \\\\ & \\ovalgate{\\hatx } & \\ovalgate{\\hatz } & \\qw } \\end{array } & = & \\begin{array}{c } \\qcircuit @c=1em @r=1em @!r { & \\ovalgate{\\hatqxy}\\qwx[1 ] & \\ovalgate{\\hatz}\\qwx[1 ] & \\gate{u } & \\qw \\\\ & \\ovalgate{\\hatqxy ' } & \\ovalgate{\\hatz } & \\gate{u ' } & \\qw } \\end{array } \\label{eq-2thirds - a } \\\\",
    "& = & \\begin{array}{c } \\qcircuit @c=1em @r=1em @!r { & \\gate{u } & \\ovalgate{\\hatx}\\qwx[1 ] & \\ovalgate{\\hatpzy'}\\qwx[1 ] & \\qw \\\\ & \\gate{u ' } & \\ovalgate{\\hatx } & \\ovalgate{\\hatpzy } & \\qw } \\end{array } \\label{eq-2thirds - b } \\;,\\end{aligned}\\ ] ]    where ( see fig.[fig - qxy - pzy ] )    = c_+ s _ ,  = ( ) _  ,    = c_- s _ , ",
    "= ( ) _  , ( @xmath258 vector has a positive sign in front of @xmath7 , @xmath259 vector has a negative one ) and    u = e^i e^-i , u = ( u)_ .",
    "[ eq-2thirds - u - def ] note that the left - hand sides of eqs.([eq-2thirds - a ] ) and ( [ eq-2thirds - b ] ) are independent of the two angles @xmath14 and @xmath260 ; only their right - hand sides depend on these angles .    from the expression of swapper as a product of 3 cnots , we get    c @c=1em @r=1em @!r & & & & + & & & &    =    c @c=1em @r=1em @!r & & & + & & &    . from fig.[fig - qxy - pzy ]",
    ", it follows that _",
    "= e^i _ e^-i .",
    "thus     + & = &    c @c=1em @r=1em @!r & & & & & & & & + & & & & & & & &     + & = &    c @c=1em @r=1em @!r & & & & & & & + & & & & & & &     + & = &    c @c=1em @r=1em @!r & + &    .",
    "the next theorem follows immediately from the previous one , by a change of basis .",
    "[ th-2thirds - ab ] suppose @xmath261 , @xmath250 , and @xmath248 .",
    "then    c @c=1em @r=1em @!r & & & & + & & & &    & = &    c @c=1em @r=1em @!r & & & & & + & & & & &     + & = &    c @c=1em @r=1em @!r & & & & & + & & & & &    , where    _ f = c_+ s _ , _f = c_  + s_ ,    _ f = c_- s _ , _f = c_  - s_ , and    u = e^i _ e^-i _ , u = e^i _  e^-i _ ",
    ".    just change basis in the space where bit 0 ( ditto , bit 1 ) lives so that @xmath262 is replaced by @xmath263 ( ditto , @xmath264 ) .",
    "we will refer to the next identity , eq.([eq-2thirds - split ] ) , as the 1/3 swapper identity .",
    "[ th-2thirds - split ]    c @c=1em @r=1em @!r & & & + & & &    =    c @c=1em @r=1em @!r & & & & + & & & &    , [ eq-2thirds - split ] where all variables are defined as in theorem [ th-2thirds ] .    from the hermitian conjugate of eq.([eq-2thirds - a ] )",
    ", one gets    c @c=1em @r=1em @!r & & & & + & & & &    =    c @c=1em @r=1em @!r & & & + & & &    .",
    "let @xmath265 and @xmath266 stand for the left and right hand sides of eq.([eq-2thirds - split ] ) .",
    "pre - multiplying both sides of the last equation by @xmath267 \\\\ & \\freeovalgate{\\hatz } } \\end{array } $ ] yields    lhs =    c @c=1em @r=1em @!r & & & & + & & & &    = rhs .",
    "in this section , we present some identities which contain a similarity transformation produced by pre and post multiplying an operator by the same dc - not .",
    "we will refer to the next theorem as the dc - not similarity transformation identity .",
    "[ th - sim - trans ] for any @xmath268 ,    c @c=1em @r=1em @!r & & & & + & & & &    =    c @c=1em @r=1em @!r & & & & + & & & &    , [ eq - sim - trans - id ] where @xmath269 .",
    "note that the lhs of eq.([eq - sim - trans - id ] ) equals its rhs evaluated at @xmath270 .    since    = -(c_+ s _ )",
    ", it follows that    _ + _ & = & _ c_- s _ , c_- s _ + _ c_+ s _ , c_+ s _ + & = & _ + _ .",
    "let lhs and rhs denote the left - hand side and right - hand side , respectively , of eq.([eq - sim - trans - id ] ) . then , using eq.([eq - sim - trans - of - sig - veca ] ) ,    rhs & = &    c @c=1em @r=1em @!r & + &    ( s___xy,1 + c__,1 )    c @c=1em @r=1em @!r & + &    c @c=1em @r=1em @!r & + &    ( c__1,_xy + s__1 , )    c @c=1em @r=1em @!r & + &     + & = & ( s__1 + c _ _ ) ( c__1 , + s _ _ ) + & = & s_c _ ( _ + _ ) + c^2__1 + s^2__1 + & = & s_c _ ( _ + _ ) + c^2__1 + s^2__1 + & = & lhs .",
    "it is convenient to define , for any @xmath271 ,    _",
    "w_1,w_2^= c__1 + s__2 , _",
    "w_1,w_2^= c__1 - s__2 .",
    "[ eq - general - p - q - def ] ( the @xmath175 vectors have a positive sign in front of the sine function whereas the @xmath272 vectors have a negative one ) .",
    "the next theorem follows from the dc - not similarity transformation identity .",
    "[ th - split - sim - trans ]    for any @xmath273 ,    c @c=1em @r=1em @!r & & & & + & & & &    =    c @c=1em @r=1em @!r & & & + & & &    , [ eq - split - sim - trans - id ] where ( see fig.[fig - split - sim - trans ] )    _ f = c_^+ s _ , _f = c_^+ s _ , and    u = ( c_+ s _ ) ( c__^ + s _ ) , u=(u ) _ , where    2= - , 2= -2 .    from fig.[fig - split - sim - trans",
    "] , it follows that    ^= e^ie^-i , and    ^= e^ie^-i .",
    "let lhs and rhs denote the left - hand side and right - hand side , respectively , of eq.([eq - split - sim - trans - id ] ) .",
    "then    lhs =    c @c=1em @r=1em @!r & & & & & & + & & & & & &    , and    rhs =    c @c=1em @r=1em @!r & & & & & + & & & & &    . therefore , eq.([eq - split - sim - trans - id ] ) is equivalent to the assertion that    c @c=1em @r=1em @!r & & & & + & & & &    =    c @c=1em @r=1em @!r & & & & + & & & &    .",
    "now pre - multiply each side of the last equation by @xmath274    c @c=1em @r=1em @!r & & & & + & & & &    =    c @c=1em @r=1em @!r & & & & + & & & &    .",
    "the preceding equation follows from theorem [ th - sim - trans ] and the fact that @xmath275 .",
    "the next theorem is a simple variation of the previous one .",
    "( the left - hand sides of eqs.([eq - split - sim - trans - id ] ) and ( [ eq - split - sim - trans - id2 ] ) differ only in that one circuit has two @xmath259 s in the bit-1 wire whereas the other circuit has two @xmath258 s . )    [ th - split - sim - trans2 ]    c @c=1em @r=1em @!r & & & & + & & & &    =    c @c=1em @r=1em @!r & & & & + & & & &    , [ eq - split - sim - trans - id2 ] where all variables are defined as in theorem [ th - split - sim - trans ] .",
    "let @xmath276 represent the left - hand side of eq.([eq - split - sim - trans - id ] ) , and @xmath277 , the left - hand side of eq.([eq - split - sim - trans - id2 ] ) . then    c @c=1em @r=1em @!r & & + & &    lhs_[eq - split - sim - trans - id ]    c @c=1em @r=1em @!r & & + & &    & = &    c @c=1em @r=1em @!r & & & & & + & & & &     + & = &    c @c=1em @r=1em @!r & & & & & & + & & & & &     + & = &    c @c=1em @r=1em @!r & & + & &    lhs_[eq - split - sim - trans - id2 ]    c @c=1em @r=1em @!r & & + & &",
    "the right - hand sides of eqs.([eq - split - sim - trans - id ] ) and ( [ eq - split - sim - trans - id2 ] ) must be related in the same way as their left - hand sides .",
    "in previous sections we defined the lo - rhs invariant @xmath228 for any @xmath43 .",
    "we also defined dc - nots and discussed some of their properties . in this section , we combine these two concepts : we calculate @xmath228 when @xmath20 is a product of one or more dc - nots acting on the same two qubits .",
    "henceforth , we will denote the product of @xmath278 dc - nots ( all acting on the same two qubits ) by the symbol @xmath279 followed by a list ( enclosed in parenthesis ) of its arguments .",
    "sometimes , if this does nt lead to confusion , its list of arguments will be omitted .",
    "thus ,    _ r (    cccc _ r & & _ 2 & _ 1 + _r & & _2 & _1    ) =    c @c=1em @r=1em @!r & & + & &    c @c=1em @r=1em @!r & & & + & & &    .",
    "the determinant of @xmath279 equals either plus or minus one .",
    "indeed ,    (    c @c=1em @r=1em @!r & & + & &    ) = (    c @c=1em @r=1em @!r & & + & &    ) = = -1 . since @xmath280 , it follows that for @xmath281 ,    ( _ r)= ( -1)^r .",
    "it is convenient to define a matrix @xmath282 by    _",
    "r = ( -1)^_r = i^_r .",
    "henceforth , we will refer to @xmath282 as the * special counterpart * of @xmath279 .",
    "( here the adjective  special \" means  having unit determinant \" ) . @xmath283 and @xmath284 , so @xmath285 .    since @xmath286 ,    ^(2)_r & = & _ r _",
    "r^t + & = &    c @c=1em @r=1em @!r & & + & &    c @c=1em @r=1em @!r & & & & & + & & & & &    c @c=1em @r=1em @!r & & + & &    . for @xmath287",
    ", @xmath288 obeys the following recursion relation :    ^(2)_r+1 =    c @c=1em @r=1em @!r & & + & &    _",
    "r^(2 )    c @c=1em @r=1em @!r & & + & &    .",
    "note that the lo - rhs invariants of @xmath279 and of its special counterpart @xmath282 are related by    _",
    "r^(2 ) = i^r _ r^(2 ) .",
    "[ eq - invar - of - hat - graph ]    the remainder of section [ sec - two - bit - dcnot - rhs - invariants ] consists of 4 subsections which give explicit formulas for @xmath288 for @xmath278 from 1 to 4 .",
    "these 4 subsections are very useful , but make for dry reading when considered in isolation ; they only come alive and prove their mettle as we start using them in subsequent sections .",
    "thus , the reader is advised not to spend too much time on them during his first reading of this paper .",
    "he should skim the 4 subsections , and then come back to them as the need arises .",
    "this part of our program is dedicated to the letters @xmath289 .",
    "^(2)_1 =    c @c=1em @r=1em @!r & & & + & & &    = - _  , .",
    "[ eq - invariant-1bit ]    c @c=1em @r=1em @!r & & & + & & &    =    c @c=1em @r=1em @!r & & & & + & & & &    =    c @c=1em @r=1em @!r & + &    .",
    "this part of our program is dedicated to the letters @xmath290 .",
    "[ th - invar2 ] ^(2)_2 & = &    c @c=1em @r=1em @!r & & & & & + & & & & &     + & = & _ 2r + i_2i + _ 2r + i_2i , [ eq - invariant-2bit ] where    _ 2r= ( ) (  ) ,    _",
    "2i= 0 ,    _ 2r= - _ , , [ eq - def - lam2r ]    _ 2i= _  , + _ , .",
    "[ eq - def - lam2i ]    an explicit expression for @xmath289 was given in section [ sec - invariants-1cnot ] .",
    "eq.([eq - sim - trans - of - sig - veca ] ) shows how to calculate the effect of dc - not similarity transformations .",
    "using these two results , one gets    ^(2)_2 & = &    c @c=1em @r=1em @!r & + &    [ -_ , ]    c @c=1em @r=1em @!r & + &     + & = &    c @c=1em @r=1em @!r & + &    _",
    ",1    c @c=1em @r=1em @!r & + &    c @c=1em @r=1em @!r & + &    _ 1 ,    c @c=1em @r=1em @!r & + &    c @c=1em @r=1em @!r & & + & &    ( -1 ) + & = & ( _ , 1 + _ , ) ( _ 1,+ _ , ) _  , + & = & \\ {    l (  ) ( ) + - _ ,   + + i    . .",
    "= 0 ,    ( _ 2r^)^t _ 2i^=0 ,    _ 2r^(_2i^)^t=0 .",
    "this follows easily from eqs.([eq - def - lam2r ] ) and ( [ eq - def - lam2i ] ) .",
    "it is convenient to parameterize the expression for @xmath290 given by theorem [ th - invar2 ] , using as few parameters as possible .",
    "@xmath290 can be parameterized with 2 real numbers @xmath291 , and 2 rhon bases @xmath292 and @xmath293 .",
    "call these the principal parameters of @xmath290 ( see fig.[fig - principal-2cnot ] ) . more explicitly ,    ^(2)_2=",
    "_ 2r + _ 2r + i_2i , [ eq - diag - invariant-2bit ] where    _",
    "2r= c_ c _ ,    _",
    "2r= -(s _ s _ ) _ 2_2^t ,    _ 2i & = & ( s_c _ ) _",
    "3_1^t + ( c _ s _ ) _ 1_3^t [ eq - mat - single - line - style ] + & = &    l|ll & _ 1^t & _ 3^t + _ 3 & s_c _ & 0 + _ 1 & 0 &",
    "c _ s _    [ eq - mat - table - style ] + & = & ^t .",
    "[ eq - mat - mat - style ] ( eqs.([eq - mat - single - line - style ] ) , ( [ eq - mat - table - style ] ) , and ( [ eq - mat - mat - style ] ) are 3 different styles of representing the same thing . )    define @xmath294 to be the angle between @xmath240 and @xmath295 .",
    "thus    c_ =  , s_ = || .",
    "if @xmath296 , set    ( f_j)_j=1,2,3= (  , , ) . if @xmath297 , choose @xmath298 to be any rhon basis with @xmath299 .    use the previous paragraph with all primes removed to define @xmath14 and @xmath292 .",
    "suppose we are given a matrix which is known to be the lo - rhs invariant @xmath300 of a quantum circuit with 2-qubits and 2 dc - nots .",
    "furthermore , we are asked to extract from this matrix values ( non - unique ones ) for @xmath9,@xmath159,@xmath240 and @xmath295 .",
    "next we will give an algorithm for accomplishing this task .",
    "we will call it our  algorithm for diagonalizing @xmath300 \" .",
    "the algorithm first expresses @xmath300 in term of its principal parameters .",
    "then it solves for @xmath9,@xmath159,@xmath240 and @xmath295 in terms of these parameters .",
    "* algorithm for diagonalizing * @xmath300 :    1 .",
    "set @xmath301 .",
    "set @xmath302 , @xmath303 and @xmath304 .",
    "hence , @xmath305 , where @xmath306 is a real scalar , and @xmath307 are traceless hermitian matrices .",
    "2 .   calculate @xmath308 , @xmath309 , @xmath310 and @xmath311 from @xmath306 and @xmath312 .",
    "( if @xmath313 , then take @xmath314 , and choose @xmath310 and @xmath311 to be any 3d unit vectors . )",
    "[ item - diag - invar2-h - hprime ] choose any rhon basis @xmath315 such that @xmath316 , and any rhon basis @xmath317 such that @xmath318 .",
    "4 .   [ item - diag - invar2-m - matrix ]",
    "find a singular value decomposition ( svd ) of the matrix + m = .",
    "in other words , find 2-dimensional orthogonal matrices @xmath319 and a non - negative 2-dimensional diagonal matrix @xmath320 such that + m = u d v^t . + now calculate @xmath321 , @xmath322 , @xmath323 , @xmath324 , @xmath325 , @xmath326 from + = d , + = [ _3 , _1 ] u , [ eq - f - eq - hu ] and + = [ _ 1 , _ 3]v .",
    "5 .   by expressing @xmath172 on the rhs of eq.([eq - f - eq - hu ] ) in component form ,",
    "it is easy to verify that + _3 _1 = ( u)_3 _1 . @xmath327 and",
    "@xmath328 so + _3_1_2 = ( u ) .",
    "@xmath329 will always equal either @xmath330 or @xmath331 . if @xmath332 , replace @xmath333 and @xmath334 .",
    "these replacements make @xmath335 a right handed basis .",
    "+ if @xmath336 , an analogous procedure can be used to convert @xmath337 into a right - handed basis .",
    "6 .   at this point , we know the four quantities @xmath308 , @xmath321 , @xmath322 , and @xmath309 .",
    "calculate @xmath338 from + ( )= c_c_s _ s _ , and + ( )= s_c_c_s_. + calculate @xmath339 from @xmath340 . 7 .",
    "calculate @xmath341 from : + \\ { + l = _ 1 + = c _ _ 1 - s _ _ 2 + . , \\ { + l ",
    " = c_ _1 - s_ _2 + . .",
    "this part of our program is dedicated to the letters @xmath342 .",
    "[ th - abc - invar3 ] ^(2)_3 & = &    c @c=1em @r=1em @!r & & & & & & & + & & & & & & &    [ eq - invariant-3bit - diag ] + & = & _ 3r + i_3i + _ 3r + i_3i , [ eq - invariant-3bit ] where    _",
    "3r =  ,    _",
    "3i = -()() -()( ) ,    _ 3r= \\",
    "{    l -( ) ( ) _  , + + ( ) ( ) _ , + ( )( ) _  , + + (  ) _ , + ( ) _ , + - _ ,    . ,    _ 3i= \\ {    l + ( ) _ , + (  ) _ ,   + + _ , +  _  ,    . , where @xmath343 and @xmath344 .",
    "^(2)_3 & = &    c @c=1em @r=1em @!r & & + & &    _",
    "2^(2 )    c @c=1em @r=1em @!r & & + & &     + & = &    c @c=1em @r=1em @!r & & + & &    _",
    "2^(2 )    c @c=1em @r=1em @!r & & + & &    ( -_ , ) . an explicit expression for @xmath290 was given in section [ sec - invariants-2cnots ] .",
    "eq.([eq - sim - trans - of - sig - veca ] ) shows how to calculate the effect of dc - not similarity transformations .",
    "[ th - simple - orientation - invar3 ] suppose    =    c @c=1em @r=1em @!r & & & & + & & & &    , =    c @c=1em @r=1em @!r & & & & & & + & & & & & &    .",
    "for any @xmath121 , it is possible to find an @xmath345 such that @xmath346 , and such that ( a)@xmath347 , and ( b)@xmath348 .",
    "as pointed out in the introduction , ref.@xcite shows how to express any 2-qubit unitary operation as a circuit with just 3-cnots .",
    "it is easy to check that conditions ( a ) and ( b ) are satisfied by the 3-cnot circuit given in ref.@xcite .",
    "hence , this theorem has already been proven in ref.@xcite , although ref.@xcite does not explicitly point out this property of their 3-cnot circuit .",
    "the  algorithm for diagonalizing @xmath342 \" , that is presented later in this section , also constitutes a ( constructive ) proof of this theorem .    for @xmath349 ,",
    "define the following two commutators :    [ eq - left - right - commut ] _",
    "l = a^t b - b^t a ,    _ r = a b^t - b a^t .",
    "( here , the letters @xmath350 and @xmath351 stand for left and right .",
    "they indicate on which matrix the transpose symbol acts , either the left or the right matrix in the matrix product . ) ref.@xcite presents a proof ( due to eckart and young ) of the following theorem .",
    "@xmath352 have a simultaneous singular value decomposition ( svd ) if and only if @xmath353_l$ ] and @xmath353_r$ ] are both zero . by a simultaneous svd we mean orthogonal matrices @xmath319 and real diagonal matrices @xmath354 such that    a = ud_av^t , b = u d_b v^t .",
    "[ eq - sim - svd ] when considering the svd of a single matrix @xmath20 , one usually insists in making the entries of @xmath355 non - negative , and calling them the singular values of @xmath20 . in the case of a simultaneous svd ,",
    "one ca nt always make both diagonal matrices non - negative , but one can certainly make one of them so .",
    "of course , the previous paragraph applies almost intact if @xmath20 and @xmath21 are elements of @xmath356 instead of @xmath357 . for @xmath185 complex",
    ", one must replace the @xmath358 ( transpose ) symbol by the @xmath359 ( hermitian conjugate ) symbol in eqs.([eq - left - right - commut ] ) and ( [ eq - sim - svd ] ) .",
    "also , the matrices @xmath319 in eq.([eq - sim - svd ] ) must be unitary instead of orthogonal .",
    "note that when @xmath20 and @xmath21 are hermitian , the condition that @xmath353_l$ ] and @xmath353_r$ ] both vanish becomes simply the condition that @xmath20 and @xmath21 commute .",
    "the eckart , young theorem then becomes a theorem very familiar to practitioners of quantum mechanics : two hermitian operators can be simultaneously diagonalized iff they commute .",
    "l=0 ,    _ r=0 .",
    "let    = ^(2)_3 - ( ^(2)_3 ) , so    _ 3r= , _",
    ",    = [ + ^ , - ^ ] = [ ^ , ] = [ ^(2)_3 , ^(2)_3 ] = 0 , where the last commutator is zero because @xmath342 is unitary .",
    "note that for any @xmath360 ,    & = & \\ {    l + (  + i_ ) ( + i _ ) + - (  + i_ ) ( + i _ )    .",
    "+ & = & i2 [ ( ) _ ,1 - ( )_1 , ] .    from theorem",
    "[ th - abc - invar3 ] , we know that @xmath361 and @xmath361 can be expressed in the form    _ 3r = _ j _ j _ _j,_j , _",
    "3i = _ k _ k _ _k,_k , for some @xmath362 and @xmath363 .",
    "therefore ,    0&= & [ _ 3r , _ 3i ] + & = & _ j , k _ j_k [ _ _j,_j , _ _k,_k ] + & = & i2_j , k",
    "_ j_k [ ( _ j_k)__j_k,1 - ( _j_k)_1,_j_k ] .",
    "this implies that    _ j , k _",
    "j_k ( _ j_k ) _j_k=0 , _ j , k _",
    "j_k ( _j_k ) _ j_k=0 .",
    "[ eq - sum - cross - prods - is - zero ]    now note that _ r & = & ( _ j _ j _j^t_j ) ( _ k _ k _ k^t_k ) - ( _ k _ k _k^t_k ) ( _ j _ j _",
    "j^t_j ) + & = & _ j , k _",
    "j_k(^t_j_k ) [ _j ^t_k - _k ^t_j ] + & = & 0 , where the last expression vanishes due to eq.([eq - sum - cross - prods - is - zero ] ) .",
    "an analogous argument shows that @xmath364_l$ ] also vanishes .",
    "it is convenient to parameterize the expression for @xmath342 given by theorem [ th - abc - invar3 ] , using as few parameters as possible .",
    "@xmath342 can be parameterized with 3 real numbers @xmath365 , and 2 rhon bases @xmath366 and @xmath367 .",
    "call these the principal parameters of @xmath342 ( see fig.[fig - principal-3cnot ] ) . more explicitly ,    ^(2)_3= _ 3r + i_3i + _ 3r + i_3i , [ eq - diag - invariant-3bit ] where",
    "_ 3r = - x_o ,    _ 3i = - y_o ,    _",
    "3r = _ j=1 ^ 3 _ j _ j_(j)^t , [ eq - lam3r - fin ]    _ 3i =",
    "_ j=1 ^ 3 _ j _ j_(j)^t , [ eq - lam3i - fin ] where    x_o = c_s__1 s__2 , [ eq - xo - fin ]    y_o = s_c__1 c__2 , [ eq - yo - fin ]    ( _ j)_j=1,2,3 = ( s_c__1s__2 , s_s__1|c__2| , c_c__1c__2 ) , [ eq - nuj - fin ]    ( _ j)_j=1,2,3 = ( -c_s__1|c__2| , -c_c__1s__2 , s_s__1s__2 ) , [ eq - muj - fin ] where @xmath368 and @xmath369 is the permutation @xmath370",
    ".    we will assume from the onset of this proof that ( a)@xmath371 , and ( b)@xmath372 . this can be assumed without loss of generality because of theorem [ th - simple - orientation - invar3 ] .",
    "let    = sign ( ) , _ 2 = sign ( ) . without loss of generality , we will assume that @xmath373 . if @xmath374 is initially negative , we can make it positive by replacing both @xmath9 and @xmath240 by their negatives .",
    "this replacement will not change @xmath342 . using the circuit shown in eq.([eq - invariant-3bit - diag ] ) , it is easy to prove that @xmath375 is odd in both @xmath9 and @xmath240 .",
    "define s__2 = || , = || = || . to begin",
    ", we will assume that @xmath376 and @xmath377 .",
    "later on , before ending the proof , we will remove these two constraints .    if we define x_o = (  ) , [ eq - xo - init ]    y_o= ( ) ( )  , [ eq - yo - init ]    ( _j)_j=1,2,3= (  , ,  ) ,    ( _ j)_j=1,2,3= ( , , ) , [ eq - gj - init ]    ( _ j)_j=1,2,3= (  s__2 ,  , ( ) ( ) (  ) ) , [ eq - nuj - init ]    ( _ j)_j=1,2,3= ( , , ) , [ eq - vj - init ]    ( _ j)_j=1,2,3= ( - , -()()s__2 ,  ) , [ eq - muj - init ]    ( _ j)_j=1,2,3= ( , , ) , [ eq - uj - init ]    then    ^(2)_3= -x_o -iy_o + _ j=1 ^ 3 _ j _ j_j^t + i_j=1 ^ 3 _ j _ j_j^t .",
    "define an angle @xmath15 by    ( ) =  , ( ) =  .",
    "define angles @xmath378 by    ( _ 1 ) = , ( _ 1 ) = || , and    ( _ 2 ) = , ( _ 2 ) = || .",
    "hence , @xmath379 .",
    "one finds    = s__1|c__2| ,    _ 2 = -_2 ,    _ 3 = -_2 , and    = s__1s__2 .    at this point , it is easy re - express various quantities in terms of the principal parameters .",
    "eq.([eq - xo - init ] ) for @xmath380 , eq.([eq - yo - init ] ) for @xmath381 , eq.([eq - nuj - init ] ) for the @xmath382 , and eq.([eq - muj - init ] ) for the @xmath383 , yield , respectively , eq.([eq - xo - fin ] ) , eq.([eq - yo - fin ] ) , eq.([eq - nuj - fin ] ) , and eq.([eq - muj - fin ] ) .",
    "we can also re - express eqs.([eq - vj - init ] ) and ( [ eq - uj - init ] ) for the @xmath384 and @xmath385 in terms of the principal parameters .",
    "one finds    ( _ j)_j=1,2,3= ( _ 2 , -_2_3 , _ 1 ) = ( _ 2 , _ 3 , _",
    "1 ) , and    ( _ j)_j=1,2,3= ( -_2_2 , _ 3 , _",
    "1 ) = ( _ 2 , _ 3 , _ 1 ) . hence , for @xmath386 , _ j = _",
    "[ eq - v - u - gpi ]    when @xmath387 or @xmath388 vanish , eq.([eq - gj - init ] ) fails to define two of the vectors @xmath389 , eq.([eq - vj - init ] ) fails to define on or two of the vectors @xmath384 , and eq.([eq - uj - init ] ) fails to define on or two of the vectors @xmath385 .",
    "if @xmath390 , the proof survives if we define @xmath366 to be any rhon basis such that @xmath391 and @xmath392 . then define the @xmath385 and @xmath384 vectors in accordance with eq.([eq - v - u - gpi ] ) .",
    "if @xmath393 but @xmath376 , define the @xmath385 and @xmath384 vectors in accordance with eq.([eq - v - u - gpi ] ) .",
    "suppose we are given a matrix which is known to be the lo - rhs invariant @xmath375 of a quantum circuit with 2-qubits and 3 dc - nots .",
    "furthermore , we are asked to extract from this matrix values ( non - unique ones ) for @xmath9 , @xmath159 , @xmath394 , @xmath240 , @xmath295 and @xmath395 .",
    "next we will give an algorithm for accomplishing this task .",
    "we will call it our  algorithm for diagonalizing @xmath375 \" .",
    "the algorithm first expresses @xmath375 in term of its principal parameters .",
    "then it solves for @xmath9 , @xmath159 , @xmath394 , @xmath240 , @xmath295 and @xmath395 in terms of these parameters .",
    "* algorithm for diagonalizing * @xmath396    1",
    ".   set @xmath397 $ ] and @xmath398 $ ] .",
    "set @xmath399 , @xmath400 and @xmath401 .",
    "hence , @xmath402 , where @xmath403 are real scalars , and @xmath404 are traceless hermitian matrices .",
    "2 .   set @xmath405 and @xmath406 .",
    "3 .   do a simultaneous svd of @xmath407 and @xmath408 .",
    "this decomposition is possible since we have shown previously that @xmath409_l$ ] and @xmath409_r$ ] are both zero",
    ". the decomposition yields orthogonal matrices @xmath319 and real diagonal matrices @xmath410 such that + ^_3r = u d_3r v^t , ^_3i = u d_3i v^t . + for @xmath386 , set + _ j = ( d_3r)_jj , _ j = ( d_3i)_jj . set + = u , [ _ 1,_2,_3 ] = v .",
    "4 .   set @xmath411 .",
    "set @xmath412 .",
    "calculate @xmath15 from + c_= , s_= .",
    "if @xmath413 , set + = . on the other hand , if @xmath414 , set + = .",
    "5 .   at this point , we know the four quantities @xmath415 , @xmath416 , @xmath417 , and @xmath418 . calculate @xmath419 from + ( _ 1_2)= c__1c__2 s__1s__2 , and + ( _ 1_2)= s__1c__2 c__1s__2 . +",
    "calculate @xmath420 from @xmath421 .",
    "6 .   at this point",
    ", @xmath418 is guaranteed to be positive , but there is not guarantee that @xmath422 and @xmath387 are individually positive ( they may both be negative ) .",
    "furthermore , at this point there is no guarantee that @xmath423 .",
    "these disagreements with the assumptions of our parameterization can be fixed as follows . if @xmath424 , replace @xmath425 and @xmath426 by their negatives , and replace @xmath427 each by its negative . if @xmath428 , replace @xmath429 and @xmath430 , and replace @xmath427 each by its negative .",
    "calculate @xmath431 from : + \\ { + l = _ 1 + = c__2_1 + s__2_3 + = ( _ 2-_2_1 ) _ 1 + ( _ 2-_2_1 ) _",
    "3 + . , \\ { + l ",
    "= _3 +  = c _ _1 + s _ _2 + . .",
    "note the @xmath432 s in the expression for @xmath9 .",
    "the reason for these @xmath432 s is that in order to obey @xmath373 , one must define the sign of the angle @xmath425 differently depending on whether @xmath433 is positive or negative .",
    "( see fig.[fig - signs - principal-3cnot ] )    [ th - mu - nu - bilinear ] for any @xmath434 ,    _",
    "j_j = x_o y_o . if @xmath435 are 3 distinct element of @xmath211 , then    _ i _ j = -x_o _ k , and    _ i _ j = -y_o _ k",
    ".    follows from the definitions eq.([eq - xo - fin ] ) for @xmath380 , eq.([eq - yo - fin ] ) for @xmath381 , eq.([eq - nuj - fin ] ) for the @xmath382 , and eq.([eq - muj - fin ] ) for the @xmath383 .",
    "define @xmath436 to be the permutation matrix that corresponds to the permutation map @xmath369 used above .",
    "thus ,    = .",
    "if @xmath437 denotes the standard basis , define matrices @xmath438 and @xmath439 by    m_&= & _",
    "j=1 ^ 3 _ j _ j _ ( j ) + & = & diag(_1 , _ 2 , _ 3 ) , and    m_&= & _ j=1 ^ 3 _ j _ j _",
    "( j ) + & = & diag(_1 , _ 2 , _ 3 ) . note that @xmath440 ( given by eq.([eq - lam3r - fin ] ) ) becomes @xmath439 and @xmath441 ( given by eq.([eq - lam3i - fin ] ) ) becomes @xmath438 when the bases @xmath366 and @xmath442 are both rotated into the standard basis .",
    "m_m_^t = m_m_^t = x_o y_o ,    m_^t m_= m^t_m_= x_o y_o , and    ( m_^t)^2 = ( m _ ) - m_.    follows from theorem [ th - mu - nu - bilinear ] .",
    "this part of our program is dedicated to the letters @xmath443 .",
    "[ eq - invar4 ] ^(2)_4 & = &    c @c=1em @r=1em @!r & & & & & & & & & + & & & & & & & & &     + & = & _ 4r + i_4i + _ 4r + i_4i , [ eq - invariant-4bit ] where    _",
    "4r = -_j ( _j)_j _ ( j ) , _",
    "4i = ( _ 4r ) _ ,    _",
    "4r= x_o _ ",
    ", + _ , + _  , + x ,    _ 4i= y_o _  , - _ , - _  , + y , where    = _ j _ j ( _j ) , = ( ) _ ,    = _ j _ j ( _ ( j ) ) , = ( ) _ ,    x = _ j _ j _ , , y = ( x ) _ , where any variables not already defined in the statement of this theorem are defined in section [ sec - invariants-3cnots ] .    ^(2)_4 & = &    c @c=1em @r=1em @!r & & + & &    _",
    "3^(2 )    c @c=1em @r=1em @!r & & + & &     + & = &    c @c=1em @r=1em @!r & & + & &    _",
    "3^(2 )    c @c=1em @r=1em @!r & & + & &    ( -_ , ) .",
    "an explicit expression for @xmath342 was given in section [ sec - invariants-3cnots ] .",
    "eq.([eq - sim - trans - of - sig - veca ] ) shows how to calculate the effect of dc - not similarity transformations .",
    "when the bases @xmath366 and @xmath442 are both taken to be the standard basis , then the quantities @xmath444 , @xmath445 @xmath446 , @xmath447 , @xmath448 , @xmath449 , @xmath450 and @xmath451 ( all defined in theorem [ eq - invar4 ] ) can be expressed in terms of the matrices @xmath452 and the vectors @xmath453 as follows :    _ 4r = -^tm _ , _",
    "4i = ( _ 4r ) _ ,    = , = ( ) _ ,    = , = ( ) _ ,    x= ^t ( ^tm _ ) -m_^t -^t m_+m _ , y = ( x ) _ .    just algebra .",
    "see fig.[fig - m - mu - nu ] .",
    "m_^t = y_o , m_= x_o ,    m_^t = x_o , m_= y_o .    just algebra .",
    "this section deals with 2-qubit circuits , whereas section [ sec-3-qubit - ids ] deals with 3-qubit ones . in this section , with its numerous subsections , we start to reap the benefits of all our preceding hard work . the combination of dressed cnots and the lo - rhs invariant proves to be very useful .",
    "we find simple - to - check necessary and sufficient conditions for the reduction of a quantum circuit with @xmath189 cnots to fewer cnots , where @xmath454 .",
    "plus we show how to express circuits with 1 or 2 controlled - u s as circuits with 2 or fewer cnots . plus",
    "we show how to open and close a breach , a procedure that can reduce any 4-cnot circuit to a 3-cnot one .",
    "in this section we consider a circuit with 2 dc - nots acting on 2 qubits , and show that a symmetry in @xmath290 allows one to swap certain angles without changing the effect of the circuit ( up to lo - rhs ) .",
    "as motivation for the main theorem of this section ( the angle swapping theorem ) , we present the next theorem .",
    "the next theorem shows that the target and control qubits of a controlled - u can be exchanged .",
    "[ th - contr - u - flip ] for any @xmath195 ,    c @c=1em @r=1em @!r & & + & &    =    c @c=1em @r=1em @!r & & & + & & &    .",
    "^n_(0 ) & = & e^i_(1 ) ( )   + & = & e^i _ ( 0 ) ( ) e^-i_(0 ) e^+i_(1 ) + & = & [ e^i _ ( 0 ) ] ^n_(1 ) e^-i_(0 ) e^+i_(1 ) .",
    "the previous theorem immediately implies the next one , which states that we can  swap a breach \" between two qubits .",
    "[ th - swap - breach ] ( swapping a breach ) suppose =    c @c=1em @r=1em @!r & & & & + & & & &    , =    c @c=1em @r=1em @!r & & & & + & & & &    . for any @xmath121 ,",
    "it is possible to find an @xmath345 such that @xmath346 .",
    "define @xmath151 to be the angle between @xmath455 and @xmath456 , and @xmath159 the direction of @xmath457 . then @xmath458 and @xmath459 so @xmath460 .",
    "thus ,    c @c=1em @r=1em @!r & & & & + & & & &    =    c @c=1em @r=1em @!r & & + & &    .",
    "[ eq - swap - breach - left ]    given a unit vector @xmath9 and an angle @xmath151 , we can always find ( non - unique ) unit vectors @xmath175 and @xmath272 such that @xmath461 , and @xmath462 points along @xmath9 .",
    "then @xmath463 and @xmath464 so @xmath465 .",
    "it follows that    c @c=1em @r=1em @!r & & + & &    =    c @c=1em @r=1em @!r & & & & + & & & &    .",
    "[ eq - swap - breach - right ] now apply theorem [ th - contr - u - flip ] to eqs.([eq - swap - breach - left ] ) and ( [ eq - swap - breach - right ] ) .",
    "is it possible to swap a foil instead of a breach ?",
    "yes it is .",
    "in fact , one can swap any angle , as the following theorem shows .",
    "( angle swapping ) let    =    c @c=1em @r=1em @!r & & & + & & &    , =    c @c=1em @r=1em @!r & & & + & & &    . for any @xmath121",
    ", it is possible to find an @xmath345 such that @xmath466 and such that angle@xmath467 = angle@xmath468 and angle@xmath469 = angle@xmath470 .",
    "as proven in section [ sec - invariants-2cnots ] , @xmath471 can be parameterized as follows :    ^(2)= c_ c_-(s _ s _ ) _ 2_2^t + i    l|ll & _ 1^t & _ 3^t + _ 3 & s_c _ & 0 + _ 1 & 0 & c _ s _    , where @xmath472 and where @xmath292 and @xmath298 are two rhon bases such that    = _ 1 , = c__1 - s__2 , and    ",
    "= _1 ,  = c_ _1 - s_ _2 .",
    "@xmath473 can be parameterized in the same way as @xmath471 , but with the replacements @xmath474 , @xmath475 , @xmath476 , and @xmath477 .",
    "our goal is to construct an @xmath345 such that @xmath346 .",
    "such an @xmath345 , if it exists , must satisfy @xmath478 .",
    "we will use the positive sign . in light of eq.([eq - invar - of - hat - graph ] ) , this gives    i^2 ^(2 ) = i^2 ^(2 ) .    from the symmetrical form of the parameterized expressions for @xmath471 and @xmath473 ,",
    "it is clear that these two invariants are equal if their principal parameters are related in the following way :    _ f =  ,",
    "_f = ,    _ 3f=_1 , _ 1f=_3 , _ 2f=-_2 , and    _3f=_1 , _1f=_3 , _2f=-_2 .",
    "these relations between the principal parameters of @xmath471 and @xmath473 imply that    & = &    c @c=1em @r=1em @!r & & & + & & &    [ eq-2to2-left ] + & = &    c @c=1em @r=1em @!r & & & + & & &    , and    & = &    c @c=1em @r=1em @!r & & & + & & &    [ eq-2to2-right ] + & = &    c @c=1em @r=1em @!r & & & + & & &    [ eq-2to2-singular ] .",
    "( eq.([eq-2to2-singular ] ) is valid only if @xmath7 and @xmath479 are both non - zero , whereas eq.([eq-2to2-right ] ) is always valid .",
    "theorem [ th - swap - breach ] corresponds to the case @xmath480 . )",
    "we are done proving the theorem , but we will go one step further , and give the value of the local operations @xmath481 such that    = ( u^u^ ) . when @xmath482 and @xmath483 , the right - hand sides of eqs.([eq-2to2-left ] ) and ( [ eq-2to2-right ] ) appear in theorem [ th-2thirds - split ] .",
    "it follows from theorem [ th-2thirds - split ] and eq.([eq-2thirds - u - def ] ) that    u = e^i _ _ 3 e^-i _ _ 1 , u = ( u)_ ,  .      in this section ,",
    "we give necessary and sufficient conditions for a circuit with 2 dc - nots acting on 2 qubits to reduce to 1 dc - not .",
    "suppose    =    c @c=1em @r=1em @!r & & & + & & &    , =    c @c=1em @r=1em @!r & & + & &    .",
    "for any @xmath121 , it is possible to find an @xmath345 such that @xmath346 if and only if ( @xmath484 and @xmath485 ) or ( @xmath486 and @xmath487 ) .",
    "see fig.[fig-2to1 ] .",
    "suppose @xmath486 and @xmath487 ( the other case is analogous ) . when @xmath486 ,    _ ( 0)^n_(1 ) _",
    "( 0)^n_(1 ) = [ i_(0)]^n_(1 )",
    ". the last equation can be expressed diagrammatically as    c @c=1em @r=1em @!r & & & & + & & & &    =    c @c=1em @r=1em @!r & & & + & & &    .",
    "thus , when @xmath488 and @xmath489 , @xmath121 reduces to a single dc - not .",
    "more generally , @xmath490 .",
    "let @xmath491 be a new circuit obtained by replacing in @xmath121 : @xmath240 by its negative if @xmath492 .",
    "by virtue of eq.([eq - dcnot - with - neg ] ) , @xmath493 , where @xmath196 . if @xmath494 , then @xmath495 .",
    "@xmath346 so @xmath478 . in light of eq.([eq - invar - of - hat - graph ] ) , this gives    i^2^(2 ) = i ^(2 ) .",
    "it follows that    _ 2r + _ 2r + i_2i",
    "= i__f , _ f , where    _ 2r= ( ) (  ) ,    _ 2r= - _ , ,    _ 2i= _  , + _ , .",
    "@xmath496 so @xmath497 or @xmath498 .",
    "assume the former ( the other case is analogous )",
    ". then @xmath250 .",
    "@xmath313 and @xmath497 so @xmath499 , which in turn implies that @xmath500 .      in this section ,",
    "we give necessary and sufficient conditions for a circuit with 2 dc - nots acting on 2 qubits to reduce to zero dc - nots ( i.e. , to merely local operations ) .",
    "suppose    =    c @c=1em @r=1em @!r & & & + & & &    . for any @xmath121 , @xmath501 if and only if @xmath502 and @xmath500 .",
    "see fig.[fig-2to0 ] .",
    "when @xmath503 and @xmath504 , @xmath121 equals 1 .",
    "more generally , @xmath505 and @xmath506 .",
    "let @xmath491 be a new circuit obtained by replacing in @xmath121 : ( 1)@xmath9 by its negative if @xmath507 , ( 2)@xmath240 by its negative if @xmath492 .",
    "by virtue of eq.([eq - dcnot - with - neg ] ) , @xmath508 , where @xmath509 .",
    "if @xmath510 , then @xmath501 .",
    "@xmath501 so @xmath511 . in light of eq.([eq - invar - of - hat - graph ] ) , this gives    i^2 ^(2)= 1 .",
    "it follows that    _ 2r + _",
    "2r + i_2i = 1 .",
    "thus @xmath512 , which implies @xmath502 and @xmath500 .        in this section ,",
    "we give necessary and sufficient conditions for a circuit with 3 dc - nots acting on 2 qubits to reduce to 2 dc - nots .",
    "the constraint @xmath513 shows up below .",
    "the field of spherical geometry sheds some light on this constraint .",
    "if we connect the points @xmath514 by mayor - circle arcs on the unit sphere , then we get what is called a spherical triangle .",
    "@xmath513 if and only if this spherical triangle has a right angle at vertex @xmath159.(see fig.[fig - phi - lam - prime ] for an example of @xmath515 . )",
    "suppose    =    c @c=1em @r=1em @!r & & & & + & & & &    , =    c @c=1em @r=1em @!r & & & + & & &    .",
    "for any @xmath121 , it is possible to find an @xmath345 such that @xmath346 if and only if either @xmath513 or @xmath515 .",
    "see fig.[fig-3to2 ] .",
    "before we start the proof in earnest , let us restate some pertinent formulas taken from previous sections .    from section [ sec - invariants-2cnots ] ,",
    "we know that    ^(2)&= & _ 2r + _",
    "2r + i _ 2i + & = & c_ c_-(s _ s _ ) _ 2_2^t",
    "+ i    l|ll & _ 1^t & _ 3^t + _ 3 & s_c _ & 0 + _ 1 & 0 & c _ s _    .",
    "[ eq - r - invars-3to2 ]    from section [ sec - invariants-3cnots ] , we know that ^(2)= _ 3r + i_3i + _",
    "3i , where    _",
    "3r =  ,    _",
    "3i = -()() -()( ) , [ eq - lam3i-3to2 ]    _ 3r= \\ {    l -( ) ( ) ^t + + ( ) ( ) ^t + ( )( ) ^t + + ( )^t + ( ) ^t + - ^t ,    . and    _ 3i= \\ {    l + ( ) ^t + (  ) ^t",
    "+ + ^t +  ^t    . .",
    "now we begin the proof in earnest .",
    "@xmath346 so @xmath478 . in light of eq.([eq - invar - of - hat - graph ] ) , this gives    i^3 ^(2)= i^2 ^(2 ) .",
    "it follows that    0=_3r=  .",
    "thus , either @xmath516 or @xmath517 .",
    "assume @xmath515 .",
    "( the other case , @xmath513 , is analogous ) .",
    "it is convenient at this point to define a rhon basis @xmath518 for the 3d real space spanned by @xmath519 .",
    "let @xmath520 . if @xmath521 , let    ( _j)_j=1,2,3= (  , , ) .",
    "[ eq - hprime - basis-3to2 ] if @xmath522 , define @xmath518 to be any rhon basis such that @xmath523 and @xmath524 is perpendicular to @xmath525 .",
    "let @xmath526 . since @xmath515 ,     = c__1 - s_ _2 , , ",
    "= _1 ,  = s_ _1 + c_ _3 .",
    "[ eq - abcprime-3to2 ] eqs.([eq - hprime - basis-3to2 ] ) and ( [ eq - abcprime-3to2 ] ) are illustrated in fig.[fig - phi - lam - prime ] .",
    "our goal is to construct an @xmath345 such that @xmath346 .",
    "such an @xmath345 must satisfy @xmath478 .",
    "we will use the positive sign . in light of eq.([eq - invar - of - hat - graph ] ) , this gives    i^3 ^(2 ) = i^2 ^(2 ) .",
    "it follows that :    _ 2r = -_3i , [ eq - cond1 - 3to2 ]    0=_3r , [ eq - cond2 - 3to2 ]    _ 2r = -_3i , [ eq - cond3 - 3to2 ]    _ 2i = _ 3r .",
    "[ eq - cond4 - 3to2 ]    by evaluating eq.([eq - cond1 - 3to2 ] ) , we get    c_c_&= & ( ) ( )  + ( )( ) + & = & ( ) ( ) s_c_ + c_s_.    eq.([eq - cond2 - 3to2 ] ) is satisfied since @xmath515 by assumption .    by evaluating eq.([eq - cond3 - 3to2 ] ) , we get    -s_s__2 _ 2^t = \\ {    l - ( ) ^t + -( )",
    "^t + -^t    . .",
    "define @xmath527 by    = \\",
    "{    l + s_s_ ( ) ^t + -c_c_ ^t + + s_^t    . .",
    "if @xmath521 and @xmath528 , let    s_s_= || , _2 = , _ 2 = .",
    "[ eq - sin - sin-3to2 ] if @xmath529 , set @xmath530 and choose any unit vectors for @xmath310 and @xmath311 . if @xmath528 but @xmath531 , keep eq.([eq - sin - sin-3to2 ] ) for @xmath309 and @xmath310 but use @xmath532 .    by evaluating eq.([eq - cond4 - 3to2 ] ) , we get    _ 2i = _1^t + _2_2^t , [ eq - lam2i - svd ] where    [ eq - defs - v1-v2 ] _ 1 = -c_()+c_s_ + s_c_ ( ) , and    _ 2 = s_s_()()-c_c_+s_ .    at this point , we can follow from step [ item - diag - invar2-h - hprime ] to the end of the algorithm for diagonalizing @xmath290 that was given in section [ sec - invariants-2cnots ] .",
    "this will yield values for @xmath10 , @xmath533 , @xmath534 , and @xmath535 .",
    "compared with the previous theorem , the next theorem imposes more constraints on @xmath121 , and obtains a more constrained @xmath345 .",
    "[ th - persistence ] suppose    =    c @c=1em @r=1em @!r & & & & + & & & &    , =    c @c=1em @r=1em @!r & & & + & & &    .",
    "let @xmath536 and @xmath537 .",
    "for any @xmath121 , if    =0 , and    = 0 ,    then it is possible to find an @xmath345 such that @xmath346 and such that @xmath538 .",
    "( hence , @xmath395  persists \" , from initial circuit @xmath121 to final circuit @xmath345 , as the bottom defining vector of the leftmost dc - not for both circuits . )    the @xmath539 part of the proof of the previous theorem still applies .    using the definitions of @xmath540 and @xmath541 given by eqs.([eq - defs - v1-v2 ] ) ,",
    "it is not hard to show that    _ 1^t_2=0 = 0 .",
    "since @xmath540 and @xmath541 are orthogonal , the singular values and singular vectors of @xmath542 can be obtained simply by inspection of eq.([eq - lam2i - svd ] ) .",
    "if @xmath543 and @xmath544 , then one can immediately set    _3 = _2 , _ 1 = , s_c_= |_2| , and    _1 =  , _ 3 = , c_s_= |_1| .",
    "if @xmath545 but @xmath546 , choose @xmath547 . if @xmath548 but @xmath549 , choose @xmath550 . if @xmath545 and @xmath551 , choose @xmath326 and @xmath325 to be any vectors that make @xmath292 a rhon basis .      in this section ,",
    "we give necessary and sufficient conditions for a circuit with 3 dc - nots acting on 2 qubits to reduce to 1 dc - not .",
    "suppose    =    c @c=1em @r=1em @!r & & & & + & & & &    , =    c @c=1em @r=1em @!r & & + & &    .",
    "let @xmath343 , and @xmath344 .",
    "for any @xmath121 , it is possible to find an @xmath345 such that @xmath346 if and only if one or more of the following are true : ( see fig.[fig-3to1 ] )    1 .   :",
    "@xmath552 and @xmath553 2 .   : @xmath554 and @xmath555 3 .   : @xmath556 and @xmath557 4 .   : @xmath558 and @xmath559 5 .   : @xmath560 and @xmath561 6 .   : @xmath562 and @xmath563 7 .   : \\ { + l = 0 and =0 + = and = + ( ) = - ( ) + . .",
    "[ eq - t4-def ]    consider a circuit of type @xmath564 ( @xmath565 case is analogous ) .",
    "when @xmath566 and @xmath567 , it is obvious that a @xmath564 circuit reduces to a single dc - not .",
    "more generally , @xmath568 and @xmath569 .",
    "let @xmath491 be a new circuit obtained by replacing in @xmath121 : ( 1)@xmath394 by its negative if @xmath570 , ( 2)@xmath395 by its negative if @xmath571 .",
    "by virtue of eq.([eq - dcnot - with - neg ] ) , @xmath572 , where @xmath509 .",
    "if @xmath494 , then @xmath573 .    now consider a circuit of type @xmath574 ( @xmath575 case is analogous ) .",
    "note that when @xmath557 ,    _ _ _ = _ ( ) - = _ _ f , so    c @c=1em @r=1em @!r & & & & + & & & &    =    c @c=1em @r=1em @!r & & + & &    =    c @c=1em @r=1em @!r & & + & &    . thus , when @xmath576 , a @xmath574 circuit reduces to a single dc - not .",
    "more generally , @xmath490 and @xmath577 .",
    "let @xmath491 be a new circuit obtained by replacing in @xmath121 : ( 1)@xmath240 by its negative if @xmath492 , ( 2)@xmath395 by its negative if @xmath571 .",
    "by virtue of eq.([eq - dcnot - with - neg ] ) , @xmath578 , where @xmath579 .",
    "if @xmath494 , then @xmath580 .    circuits of type @xmath581 ( @xmath582 case is analogous ) reduce to a single dc - not by virtue of theorem [ th-2thirds - ab ] .",
    "now consider a circuit of type @xmath583 .",
    "for any @xmath584 and @xmath271 , let @xmath585 and @xmath586 be defined as in eq.([eq - general - p - q - def ] ) .",
    "because of the first line of eq.([eq - t4-def ] ) , one can choose a special coordinate system for bit 0 such that @xmath587 , @xmath588 , @xmath589 , and a special coordinate system for bit 1 such that @xmath590 , @xmath591 , @xmath592 .",
    "see fig.[fig - double - phi - lam ] .",
    "@xmath593 and @xmath594 are portrayed in fig.[fig - double - phi - lam ] , when @xmath595 and @xmath518 are the standard basis . in the special coordinate systems , the first line of eq.([eq - t4-def ] ) is satisfied by construction .",
    "the second line of eq.([eq - t4-def ] ) becomes        ( ) = - ( ) .",
    "[ eq - tan - lam - phi - sig ]    in general , eq.([eq - tan - lam - phi - abs ] ) is satisfied iff @xmath596 and @xmath597 .",
    "this gives 16 sign possibilities , but only 8 of them satisfy eq.([eq - tan - lam - phi - sig ] ) .",
    "indeed , let @xmath598 and @xmath599 denote the following 8 circuits :    _ ( -1)^mr , ( -1)^nr =    c @c=1em @r=1em @!r & & & & + & & & &    , [ eq - all - t4 ] where @xmath600 and @xmath601 .",
    "the following @xmath602 matrix has rows labeled by the 4 possible values of @xmath603 , and columns labeled by the 4 possible values of @xmath604 .",
    "as its @xmath605 entry , the matrix has : the @xmath583 circuit implied by that value of @xmath605 , if such a circuit exists , or an @xmath606 if none exists .",
    "l||c|c|c|c =,= & & - & + & - + & & _ p ,- p & & _ p , p + - & _ -q , q & & _ -q ,- q & + + & & _ -p ,- p & & _ -p , p + - & _ q , q & & _ q ,- q &    .",
    "[ eq - table - t4-ckts ] in conclusion , the 3 lines of eq.([eq - t4-def ] ) imply , in the special coordinate systems , a circuit of type eq.([eq - all - t4 ] ) .    for @xmath607 ( ditto , for @xmath608 )",
    ", there exists an @xmath345 such that @xmath609 by virtue of eq.([eq - split - sim - trans - id ] ) ( ditto , eq.([eq - split - sim - trans - id2 ] ) ) .",
    "the other 6 circuits of table eq.([eq - table - t4-ckts ] ) can be handled as follows .",
    "let @xmath491 be a new circuit obtained by replacing in @xmath121 : ( 1)@xmath604 by @xmath610 if @xmath611 , ( 2)@xmath603 by @xmath612 if @xmath613 .",
    "by virtue of eq.([eq - dcnot - with - neg ] ) , @xmath614 where @xmath615 , and where @xmath491 is of type @xmath607 or @xmath608 .",
    "if @xmath494 , then @xmath573 .",
    "@xmath346 so @xmath478 .",
    "in light of eq.([eq - invar - of - hat - graph ] ) , this gives    i^3 ^(2 ) = i ^(2 ) .",
    "it follows that    _ 3r + i_3i + _",
    "3r + i_3i = _",
    "_f,_f , where    _ 3r =  ,    _",
    "3i = -()() -()( ) , [ eq - lam3i-3to1 ]    _ 3r= \\ {    l -( ) ( ) ^t + + ( ) ( ) ^t + ( )( ) ^t + + ( )^t + ( ) ^t + - ^t ,    . and    _ 3i= \\ {    l + ( ) ^t + (  ) ^t",
    "+ + ^t +  ^t    . .",
    "* first assume that there are no breaches in * @xmath121 ( i.e. , @xmath616 , @xmath617 , @xmath618 , @xmath619 ) .",
    "note that    = 0 =0 .",
    "[ eq-2right - triangles ] this is why . from @xmath620 , we must have either @xmath513 or @xmath515 .",
    "but if one of these holds , then the other one follows .",
    "indeed , assume @xmath513 .",
    "since also @xmath621 , it follows that @xmath622 . from @xmath623 , @xmath624 so @xmath515 . by an analogous argument , assuming @xmath515 leads to @xmath513 .",
    "next note that    [ eq - perp - spreading ] = =0 = =0 , [ eq - perp - spreading - from - a ] and    = =0 = =0 .",
    "[ eq - perp - spreading - from - c ]    eqs.([eq - perp - spreading ] ) become obvious if one uses the bac minus cab identity to expand eqs.([eq-2right - triangles ] ) .",
    "it is convenient at this point to define a rhon basis @xmath518 for the 3d real space spanned by @xmath519 .",
    "let @xmath520 . if @xmath521 , let    ( _j)_j=1,2,3= (  , , ) .",
    "[ eq - gprime - basis-3to1 ] if @xmath531 , let @xmath595 be any rhon basis such that @xmath523 and @xmath524 is perpendicular to @xmath525 .",
    "let @xmath526 . since @xmath515 ,    ",
    "= c__1 - s_ _2 , , ",
    "= _1 ,  = s_ _1 + c_ _3 .",
    "[ eq - abcprime-3to1 ] eqs.([eq - gprime - basis-3to1 ] ) and ( [ eq - abcprime-3to1 ] ) are illustrated in fig.[fig - double - phi - lam ] .",
    "use the previous paragraph with all the primes removed to define angles @xmath625 and a rhon basis @xmath595 for the 3d real space spanned by @xmath626 .    when expressed in terms of @xmath627 and @xmath603",
    ", the constraint @xmath628 reduces to    - [ s_c_c_s_+c_s_s_c _ ] = 0 .",
    "[ eq - eq1-of - system ] likewise , the constraint @xmath623 reduces to    - [ s_c_s_c_+c_s_c _ s _ ] ^t = 0 .",
    "[ eq - eq2-of - system ]    eqs.([eq - eq1-of - system ] ) and ( [ eq - eq2-of - system ] ) imply the following system of 2 equations :    = 0 .",
    "[ eq - system - lam - sol ] this system of equations can also be rewritten in the form :    = 0 .",
    "[ eq - system - phi - sol ]    for eq.([eq - system - lam - sol ] ) , either ( i)the solution is the zero vector , or ( ii)the determinant of the coefficient matrix vanishes .",
    "( i)if the solution is zero , then @xmath629 . since we are assuming no breaches , @xmath521 and @xmath630 , so we must have @xmath631 . by virtue of eq.([eq - perp - spreading - from - a ] ) , this means that the circuit must be of type @xmath581 .",
    "( ii ) if the determinant is zero , then        likewise , for eq.([eq - system - phi - sol ] ) , either ( i)the solution is the zero vector , or ( ii)the determinant of the coefficient matrix vanishes .",
    "( i)if the solution is zero , then @xmath632 . since we are assuming no breaches , @xmath633 and @xmath634 , so we must have @xmath635 . by virtue of eq.([eq - perp - spreading - from - c ] ) , this means that the circuit must be of type @xmath582 .",
    "( ii ) if the determinant is zero , then        suppose we assume that the circuit @xmath121 is not of type @xmath636 .",
    "then , we have shown that it must satisfy eqs.([eq - tan - phi ] ) and ( [ eq - tan - lam ] ) .",
    "but these two equations are the second line of eq.([eq - t4-def ] ) . to prove that the circuit must be of type @xmath583 ,",
    "it remains for us to prove that the third line of eq.([eq - t4-def ] ) also holds .",
    "this third line clearly follows from @xmath628 , where @xmath637 is given by eq.([eq - lam3i-3to1 ] ) .    * next , assume that there is at least one breach in * @xmath121 . without loss of generality ,",
    "assume there is a breach between @xmath9 and @xmath159 ( i.e. , @xmath638 ) .",
    "@xmath638 implies that @xmath557 .",
    "the constraint @xmath628 reduces to    ( ) =0 , [ eq - b - c - volp ] which implies that either @xmath639 or @xmath559 .",
    "the constraint @xmath623 reduces to    ^t = 0 , which implies that either ( i)@xmath640 or ( ii)@xmath641 or ( iii)@xmath642 .",
    "( i)if @xmath640 , then , by eq.([eq - b - c - volp ] ) , @xmath559 . @xmath643 and @xmath559",
    "so @xmath121 is of type @xmath575 .",
    "( ii)if @xmath641 , then , since also @xmath644 , @xmath121 is of type @xmath565 .",
    "( iii)suppose @xmath642 .",
    "assume that @xmath645 as the case when these two vectors are parallel has already been considered .",
    "it follows that the conditions @xmath582 are satisfied .",
    "this is why .",
    "@xmath642 and @xmath645 imply that @xmath646 , and , therefore , by virtue of eq.([eq - b - c - volp ] ) , @xmath647 .",
    "now @xmath647 and @xmath502 imply that @xmath648 .",
    "thus , @xmath649 .",
    "also , @xmath642 implies that @xmath650 .",
    "in this section , we give necessary and sufficient conditions for a circuit with 3 dc - nots acting on 2 qubits to reduce to zero dc - nots ( i.e. , to merely local operations ) .",
    "suppose    =    c @c=1em @r=1em @!r & & & & + & & & &    .",
    "for any @xmath121 , @xmath501 if and only if one of the following is true ( see fig.[fig-3to0 ] )    1 .   :",
    "@xmath651 are mutually orthogonal , and @xmath652 2 .   : @xmath653 are mutually orthogonal , and @xmath654    consider a circuit of type @xmath655 ( @xmath656 case is analogous ) . note that when @xmath653 are mutually orthogonal ,    _ _ _ = i = i . hence ,    c @c=1em @r=1em @!r & & & & + & & & &    =    c @c=1em @r=1em @!r & & + & &    =    c @c=1em @r=1em @!r & & + & &    .",
    "thus , when @xmath576 , a @xmath655 circuit reduces to zero dc - nots .",
    "more generally , @xmath490 and @xmath577 .",
    "let @xmath491 be a new circuit obtained by replacing in @xmath121 : ( 1)@xmath240 by its negative if @xmath492 , ( 2)@xmath395 by its negative if @xmath571 .",
    "by virtue of eq.([eq - dcnot - with - neg ] ) , @xmath578 where @xmath579 .",
    "if @xmath510 , then @xmath501 .",
    "@xmath501 so @xmath511 . in light of eq.([eq - invar - of - hat - graph ] ) , this gives    i^3 ^(2 ) = 1 .",
    "it follows that    _ 3r + i_3i + _",
    "3r + i_3i = i , where    _ 3r =  ,    _",
    "3i = -()() -()( ) ,    _ 3r= \\ {    l -( ) ( ) ^t + + ( ) ( ) ^t + ( )( ) ^t + + ( )^t + ( ) ^t + - ^t ,    . and",
    "_ 3i= \\ {    l + ( ) ^t + (  ) ^t + + ^t +  ^t    . .",
    "@xmath657 so @xmath498 or @xmath497 .",
    "both ca nt be true at once or else we would have @xmath628 , which is false .",
    "assume henceforth that @xmath658 and @xmath497 ( the case @xmath659 and @xmath660 is analogous ) .",
    "when @xmath497 , @xmath661 reduces to @xmath662 , which immediately implies that @xmath654 , and @xmath653 are mutually orthogonal .",
    "thus , circuit @xmath121 must be of type @xmath655 .        in this section ,",
    "we show that any controlled - u can be expressed with just two cnots .",
    "this result was first proven by barenco et al . in ref.@xcite .",
    "their method of proof is long and opaque compared with the ultra simple proof given below .",
    "this attests to the benefits of using dressed cnots .",
    "let @xmath158 .",
    "suppose    =    c @c=1em @r=1em @!r & & + & &    , =    c @c=1em @r=1em @!r & & & + & & &    .",
    "for any @xmath121 , it is possible to find an @xmath345 such that @xmath663 .    given a unit vector @xmath160 and an angle @xmath151 , we can always find ( non - unique ) unit vectors @xmath159 and @xmath9 such that @xmath664 , and @xmath665 points along @xmath160 .",
    "then @xmath666 and @xmath667 so @xmath668 .    ^n(1)=",
    "[ _ ( 0)_(0)]^n(1 ) = _ ( 0)^n(1 ) _",
    "( 0)^n(1 ) .      in this section",
    ", we show that a product of two controlled - us can be expressed with just two cnots .",
    "this  deflation identity \" was first proven in ref.@xcite . unlike the proof of ref.@xcite , the one below uses dressed cnots .",
    "[ th - deflation ] let @xmath669 and @xmath670 .",
    "suppose    =    c @c=1em @r=1em @!r & & & & + & & & &    , =    c @c=1em @r=1em @!r & & & + & & &    .",
    "for any @xmath121 , it is possible to find an @xmath345 such that @xmath346 .    given a unit vector @xmath671 and an angle @xmath672 , we can always find ( non - unique ) unit vectors @xmath673 and @xmath394 such that @xmath674 , and @xmath675 points along @xmath671 .",
    "then @xmath676 and @xmath677 so @xmath678 .",
    "likewise , given a unit vector @xmath671 and an angle @xmath672 , we can always find ( non - unique ) unit vectors @xmath159 and @xmath9 such that @xmath679 .",
    "we are free to rotate the vectors @xmath673 and @xmath394 ( ditto , @xmath159 and @xmath9 ) within the plane they initially span , as long as we do nt change the angle between them .",
    "in particular , we can choose both @xmath394 and @xmath159 to lie along the line of intersection between the planes @xmath680 and @xmath681 .",
    "in other words , we can always choose @xmath566 .",
    "call @xmath682 their common value .",
    "it is now clear that , without loss of generality , we can replace @xmath121 by    =    c @c=1em @r=1em @!r & & & & & & & & + & & & & & & & &    .",
    "our goal is to construct an @xmath345 such that @xmath346 .",
    "such an @xmath345 , if it exists , must satisfy @xmath478 .",
    "we will use the positive sign . in light of eq.([eq - invar - of - hat - graph ] ) , this gives    i^4 ^(2 ) = i^2 ^(2 ) . using the same calculational techniques that were used in section [ sec - two - bit - dcnot - rhs - invariants ]",
    ", one finds    ^(2)= \\ {    l ( ) ( ) -( ) + i + + ^t    . . from section [ sec - invariants-2cnots ] , we know that @xmath473 can be expressed as    ^(2)&= & _ 2r + _",
    "2r + i _ 2i + & = & c_ c_-(s _ s _ ) _ 2_2^t + i    l|ll & _ 1^t & _ 3^t + _ 3 & s_c _ & 0 + _ 1 & 0 & c _ s _    .",
    "[ eq - r - invar-2contr - u ]    we must have    _",
    "2r= c_c_= - ( ) ( ) + (  ) , and    _ 2r= -s_s__2_2^t = -^t .",
    "[ eq - ssff ] define    s_ = || , = || .",
    "if @xmath683 , eq.([eq - ssff ] ) is satisfied by    s_s_= s_ , _2 = , _ 2 = .",
    "[ eq - fprime2-def-2-contr - u ] if @xmath684 , choose @xmath685 and @xmath310 the same way , but choose @xmath311 to be any vector perpendicular to @xmath686 .",
    "if @xmath683 and @xmath377 , define the following two rhon bases ( illustrated in fig.[fig - deflation ] ) :    ( _j)_j=1,2,3= ( , ,  ) , [ eq - hprimej - def-2-contr - u ] and    ( _ j)_j=1,2,3= ( , , ) .",
    "[ eq - hj - def-2-contr - u ] if @xmath684 , pick @xmath317 to be any rhon basis such that @xmath687 . if @xmath393 , pick @xmath315 to be any rhon basis such that @xmath688 . define the following two angles ( illustrated in fig.[fig - deflation ] ) :    _ 2 = angle ( , _ 3 ) , _ 1 = angle ( , _ 3 ) .",
    "we must have    _ 2i&= & -()^t + (  ) ^t - ^t + & = &    l|ll & _ 1^t & _ 3^t",
    "+ _ 3 & -s__1 + c_s__2 & -c__1 + c_c__2 + _ 1 & 0 & -s_    .    at this point",
    ", we can follow from step [ item - diag - invar2-m - matrix ] to the end of the algorithm for diagonalizing @xmath290 that was given in section [ sec - invariants-2cnots ] .",
    "this will yield values for @xmath10 , @xmath533 , @xmath534 , and @xmath535 .",
    "_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ once more unto the breach , dear friends , once more ; or close the wall up with our english dead ! _",
    "( from  king henry v \" by w. shakespeare ) _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _    in this section , we show how to  open and close a breach \" in 2-qubit circuits .",
    "this is a procedure whereby one can reduce any 2-qubit circuit with 4 cnots into a circuit with 3 cnots . applying this procedure repeatedly",
    ", one can reduce any 2-qubit circuit with more than 3 cnots into a circuit with only 3 cnots .",
    "the fact that all 2-qubit circuits can be expressed with 3 ( or fewer ) cnots was first proven in ref.@xcite . unlike the proof below , their proof was based on cartan s kak decomposition@xcite .",
    "( opening a breach ) suppose    =    c @c=1em @r=1em @!r & & & & & + & & & & &    , [ eq - op - cl - breach - call ]    =    c @c=1em @r=1em @!r & & & & & & + & & & & & &    .",
    "[ eq - op - cl - breach - calr ] for any @xmath121 , it is possible to find an @xmath345 such that @xmath346 .",
    "we begin by inserting a  unit wedge \" into @xmath121 :    =    c @c=1em @r=1em @!r & & & & & & & + & & & & & & &    .",
    "[ eq - op - cl - breach - call - wedge ] in eq.([eq - op - cl - breach - call - wedge ] ) , @xmath682 and @xmath689 are auxiliary parameters whose values are still to be defined .",
    "consider separately each half of the circuit in eq.([eq - op - cl - breach - call - wedge ] ) .",
    "our goal is to re - express each half as follows :    c @c=1em @r=1em @!r & & & & + & & & &    =    c @c=1em @r=1em @!r & & & & + & & & &    , [ eq - op - cl - breach - rhs ] and    c @c=1em @r=1em @!r & & & & + & & & &    =    c @c=1em @r=1em @!r & & & & + & & & &    .",
    "[ eq - op - cl - breach - lhs ] from theorem [ th - persistence ] , we know that eq.([eq - op - cl - breach - rhs ] ) will be achieved if we constrain our auxiliary parameters by :    [ eq - op - cl - breach - contraints ] =0 , and    = 0 .",
    "likewise , eq.([eq - op - cl - breach - lhs ] ) will be achieved if we constrain our auxiliary parameters by the same pair of equations as eqs.([eq - op - cl - breach - contraints ] ) , but with @xmath351 subscripts replaced by @xmath350 subscripts .",
    "these 4 constraint equations can be used to solve for the 4 degrees of freedom contained in the auxiliary parameters @xmath682 and @xmath689 .    by a  unit wedge \" we mean a circuit element which equals one .",
    "an analogous concept is a  partition of unity \" .",
    "if it equals one , why use it ? because it depends on new , auxiliary parameters , and , by merging the unit wedge with its surroundings , we get a new expression which contains the auxiliary parameters , but is functionally independent of them .",
    "we can then choose convenient values for the auxiliary parameters .",
    "the net result is that we can transform the original circuit to a new one that performs exactly as the old one but appears different .",
    "note that in eq.([eq - op - cl - breach - call - wedge ] ) we used a unit wedge consisting of a single dc - not times itself .",
    "there was no a priori obvious reason why this unit wedge would lead us to a proof of the theorem .",
    "we could have chosen a unit wedge that provided more auxiliary parameters .",
    "for instance , we could have chosen a product of 3 dc - nots ( times the inverse of the product ) .",
    "after all , 1 dc - not can express only a limited subset of all possible 2-qubit transformations whereas 3 dc - nots can be used to express any of them .",
    "for proving the above theorem , using a unit wedge with only 1 dc - not turned out to be sufficient .",
    "but one can envisage this theorem proving technique being used elsewhere with more complicated unit wedges .",
    "suppose one starts with a circuit which , like @xmath121 in eq.([eq - op - cl - breach - call ] ) , possesses 4 dc - nots . by the last theorem , one can ",
    "open a breach \" in it ; that is , transform it into a circuit which , like @xmath345 in eq.([eq - op - cl - breach - calr ] ) , possesses two adjacent oval nodes both carrying a @xmath689 . then one can combine the two adjacent dc - nots with a @xmath689 node and obtain a controlled - u .",
    "finally , one can use the deflation identity of sec.[sec-2-contr - u ] to express the just created controlled - u and an adjacent dc - not as a circuit with two cnots .",
    "the net effect of this procedure is to reduce any 2-qubit circuit with 4 cnots into one with 3 cnots .",
    "note that in all 3 identities , the initial and final circuits both have the same number of dc - nots , acting on the same 3 qubits . in all 3 cases , we pass a dc - not ( the mobile one ) acting on qubits 0 and 1 through another dc - not ( the static one ) acting on qubits 0 and 2 .",
    "thus , the mobile and static dc - nots both act on qubit 0 , but the second qubit on which they act differs .",
    "we will refer to eq.([eq - bare - pass-1 ] ) , eq.([eq - bare - pass-2 ] ) , and eq.([eq - bare - pass-3 ] ) as the pass - through identities 1,2 , and 3 , respectively . in the initial circuit of pass - through identity @xmath86 ,",
    "the mobile dc - not is part of a group of @xmath86 adjacent dc - nots acting on qubits 0 and 1 .                  .",
    "in eq.([eq - eg - pass - thru ] ) , there are initially 3 adjacent dc - nots on the lhs of the static dc - not . using pass - through identity 1",
    ", we produce 4 adjacent dc - nots on the lhs of the static dc - not . as shown in section [ sec - opening - breach ] , these 4 adjacent dc - nots can always be reduced to 3 dc - nots .",
    "let @xmath690 and @xmath691 . clearly , if @xmath503 , then @xmath663 .",
    "more generally , @xmath505 .",
    "let @xmath491 be a new circuit obtained by replacing in @xmath121 : @xmath9 by its negative if @xmath507 .",
    "by virtue of eq.([eq - dcnot - with - neg ] ) , @xmath692 where @xmath196 .",
    "if @xmath494 , then @xmath495 .",
    "[ eq - pass2-c ] . in ( a )",
    ", we introduced a unit wedge . to go from ( a ) to ( b ) , we passed half of that unit wedge across the  static \" dc - not .",
    "finally , to go from ( b ) to ( c ) , we used eq.([eq-3to1-for - some - t ] ) .",
    "note that section [ sec-3to1-cnots ] gives necessary and sufficient conditions for a 2-qubit circuit with 3 dc - nots to reduce to an equivalent circuit with 1 dc - not . using those necessary and sufficient conditions",
    ", it is easy to check in any particular instance whether there exists a @xmath689 such that eq.([eq-3to1-for - some - t ] ) is satisfied .                                              our goal is to find a @xmath686 and to construct an @xmath345 such that @xmath346 .",
    "such an @xmath345 must satisfy @xmath478 .",
    "we will use the positive sign . in light of eq.([eq - invar - of - hat - graph ] ) , the following must be true :              _ 4i= y_o ^t - ^t - ^t +",
    "the precise definitions of @xmath696 , @xmath697 , @xmath698 , and @xmath699 in terms of @xmath700 , @xmath701 , @xmath702 , and @xmath703 are given in section [ sec - invariants-4cnots ] .",
    "-s_s__2_2^t = - ( x_o ^t + ^t + ^t + x ) .",
    "[ eq - cond3-unfactored ] for eq.([eq - cond3-unfactored ] ) to be true , the rhs of that equation must factor into the product of a column vector times a row vector :                  at this point , we can follow from step [ item - diag - invar2-h - hprime ] to the end of the algorithm for diagonalizing @xmath290 that was given in section [ sec - invariants-2cnots ] .",
    "this will yield values for @xmath10 , @xmath533 , @xmath534 , and @xmath535 .",
    "if @xmath716 and @xmath717 are both non - zero , it is possible to introduce 2 rhon bases @xmath317 and @xmath315 , defined as follows .",
    "define @xmath718 and @xmath719 by _2 = _2 , _ 2 = _ 2 .",
    "define @xmath720 and @xmath721 by"
  ],
  "abstract_text": [
    "<S> quantum compiling algorithms decompose ( exactly , without approximations ) an arbitrary @xmath0 unitary matrix acting on @xmath1 qubits , into a sequence of elementary operations ( seo ) . </S>",
    "<S> there are many possible ways of decomposing a unitary matrix into a seo , and some of these decompositions have shorter length ( are more efficient ) than others . finding an optimum ( shortest ) decomposition is a very hard task , and is not our intention here . </S>",
    "<S> a less ambitious , more doable task is to find methods for optimizing small segments of a seo . </S>",
    "<S> call these methods piecewise optimizations . </S>",
    "<S> piecewise optimizations involve replacing a small quantum circuit by an equivalent one with fewer cnots . </S>",
    "<S> two circuits are said to be equivalent if one of them multiplied by some external local operations equals the other . </S>",
    "<S> this equivalence relation between circuits has its own class functions , which we call circuit invariants . </S>",
    "<S> dressed cnots are a simple yet very useful generalization of standard cnots . after discussing circuit invariants and dressed cnots , </S>",
    "<S> we give some methods for simplifying 2-qubit and 3-qubit circuits . </S>",
    "<S> we include with this paper software ( written in octave / matlab ) that checks many of the algorithms proposed in the paper . </S>"
  ]
}