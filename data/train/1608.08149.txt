{
  "article_text": [
    "minimally invasive surgery ( mis ) practice has several drawbacks for the surgeon , such as , lack of depth perception , or poor localization within operating field due to the limited field of view .",
    "the intra - operative 3d reconstruction of surgical scene simultaneous to tracking endoscope position in real - time provides key information for many mis tasks .",
    "these tasks include surgical navigation ( in case of flexible endoscope ) , and augmented reality ( ar ) overlies of pre - operative medical data in the endoscope live video stream .",
    "recently , computer vision based algorithms have attracted the attention , for their success in providing intra - operative reconstruction of the surgical scene , and the tracking of the stereo - endoscope position @xcite . however , these methods are not adapted to the commonly used monocular endoscope .",
    "structure from motion ( sfm ) methods have been proposed to deal with monocular endoscope @xcite .",
    "however , sfm methods requires offline batch processing , what makes them not suitable for real - time applications .",
    "therefore , in @xcite a tracking sensor is attached to the endoscope to estimate its position .",
    "vslam ( simultaneous location and mapping from visual sensor ) is a popular topic in robotics , which aims at simultaneously building a 3d map of unknown environment while keep track of camera location .",
    "vslam use in mis has been researched by mountney et al .",
    "@xcite , who applied and extended the extended kalman filter slam ( ekf - slam ) framework from davison @xcite to mis environment , but with stereo - endoscope . for periodic liver deformation , mountney and",
    "yang @xcite proposed to learn the parameters of the periodic motion first , and then use it to improve the vslam estimation .    in @xcite ,",
    "klein and murray proposed the parallel tracking and mapping ( ptam ) algorithm that represented a breakthrough in visual slam .",
    "lin et al .",
    "@xcite adapted ptam to a stereo - endoscope in order to reconstruct a denser 3d map than those made by ekf - slam systems .",
    "due to non - rigid deformation in surgical scenes , the use of only a monocular endoscope has proven challenging .",
    "grasa et.al .",
    "@xcite provided experimental evidence of the feasibility of monocular ekf slam in medical scenes . in @xcite",
    ", they provided extensive validation on in - vivo human sequences proofing its ability to be used for hernia defect measurements in hernia repair surgery .",
    "following the venue open by ptam , the orbslam system @xcite has been proposed recently , it has proven as a robust camera tracking and mapping estimator with remarkable camera relocation capabilities .",
    "our first contribution is researching orbslam performance within mis environments .",
    "by only re - tuning the system , the endoscope location was robustly tracked and relocated successfully after tracking loss .",
    "however , it is at the expense of a low map density , mainly due to the lack of repeatability of the orb features in some body structures such as the liver .",
    "it is also our contribution a new matching algorithm to densify the map and hence improve the estimated 3d map . in the experimental , section we provide qualitative evaluation of the performance in several in - vivo pig sequences , including respiration , and tools cluttering the endoscope field of view .",
    "we also provide a quantitative assessment that yields an accuracy in the range between 3 mm to 4.5 mm when the vslam map points are compared with respect to a ground truth surface from ct .",
    "additionally , the tracked endoscope location has been exploited to provide support for augmented reality overlays of preoperative models onto the endoscope live video stream .",
    "orbslam is based on keyframes and nonlinear optimization as proposed in ptam .",
    "it includes the covisibility information in the form of a graph as proposed in @xcite , in addition to bag of binary words dbow2 proposed in @xcite for place recognition .",
    "for large scale mapping , scale aware loop closing @xcite is used .",
    "the system uses orb @xcite for feature detection and description in all processes , what boots the performance in the place recognition and loop closure operations .",
    "a complete description of the algorithm can be found in @xcite .",
    "for the sake of completeness , we summarize next the more relevant steps : tracking , mapping and relocation .",
    "[ [ tracking ] ] tracking + + + + + + + +    this task tracks the endoscope location sequentially in every frame of the live video .",
    "the 3d locations of the map points are assumed to be available , each of them with a valid orb binary descriptor . at the current frame ,",
    "an initial guess for the endoscope position is estimated from the previous frame by means of a motion model , then the map points are reprojected to estimate its image in the current frame .",
    "the orb descriptor of each map point is compared with those of all the features detected inside a search region surrounding the predicted point .",
    "the feature point in the image with the smallest hamming distance is selected as the match , only if it is over a threshold .",
    "then the pose of the frame is refined by huber robustified non - linear optimization of the reprojection error for the matched points .",
    "after the optimization stage , the matches are segmented as inliers or outliers according to the huber threshold .",
    "map points rendering outlier matches consistently during initialization are considered non reliable and do not survive in the initialization process .",
    "[ [ mapping . ] ] mapping .",
    "+ + + + + + + +    to build the 3d map of the scene , the system selects a set of frames from the endoscope sequence .",
    "this selected frames are called keyframes . benefiting from the matches provided by the tracking process ,",
    "the system estimates matches across the keyframes .",
    "once the matches are available , the 3d location for the map points and the 3d poses for the keyframes are computed by bundle adjustment ( ba ) .",
    "the algorithm sequentially computes the matches and iteratively improves the map accuracy , in a thread that runs in parallel with the tracking thread , but at lower frequency .",
    "the ba minimizes total huber robustified reprojection error with respect to the keyframe positions , @xmath0 , and the 3d map point locations , @xmath1 : @xmath2 where @xmath3 is the matched observation of the _",
    "j_-th map point by the _ i_-th keyframe .",
    "codes the projection function including perspective and radial distortion .",
    "@xmath4 denotes the robust huber influence function .",
    "as the endoscope explores new areas of the scene not imaged previously , new keyframes are added to the map . after adding a new keyframe , new matches with respect to the previous keyframes",
    "are found to initialize new map points .",
    "initially , map points and keyframes are initialized in excess , then in a second stage a demanding rigorous is applied to select the fittest to survive .",
    "the reasons for culling a map point are : ( 1 ) the point can not be tracked and matched in the following frames .",
    "( 2 ) the projection rays used to triangulate the point in 3d render low parallax .",
    "( 3 ) the triangulated point produces excessive reprojection error over the keyframes where it is observed .",
    "this severe selection of points have proven essential for robust performance in endoscope sequences . the keyframes whose 90% of the map points",
    "have been detected in at least other three keyframes are removed from the map , in order to keep just the more informative ones .",
    "map points are initialized by detecting orb features at different image scales to achieve both scale and rotation invariance .",
    "one of the strong points of the algorithm is that orb features are used both for mapping , and for the place recognition .",
    "place recognition combines a bag of words built from the orb binary descriptors , with the covisibility graph that determines all the keyframes that are observing the same 3d scene region .",
    "[ [ endoscope - relocation . ] ] endoscope relocation .",
    "+ + + + + + + + + + + + + + + + + + + + +    tacking can be lost because of occlusion , feature deletion due to fast endoscope motion , or failure to match enough map points .",
    "therefore , the endoscope has to be located with respect to the map from scratch .",
    "relocation is also known as the kidnapped camera situation .",
    "all the keyframes of the map are stored in a bag of binary words indexed database to recover the more similar keyframes in response to a query image .",
    "more crucially , thanks to the covisibility graph , the set of keyframes observing the same area of the map can be also recovered . after tracking loss ,",
    "the orb detected in the image gathered by the endoscope are used to query the database to detect the set of keyframes that are observing the same scene area as the endoscope image .",
    "additionally , the system also provides a set of putative orb matches between the image and a set of 3d points in the map .",
    "then endoscope position is estimated by p3p and ransac .",
    "once a valid endoscope pose is estimated , the tracking can be resumed .",
    "the mapping thread is responsible for creation / deletion of map points , and map refinement through ba .",
    "after new keyframe arrival , all of its orb features are matched against closest keyframes , and all matched orb points are triangulated and appended to the map .",
    "however , map points can not be initialized on soft organs like liver , because they can not be repetitively detected along several frames in the sequence .",
    "we extended this initialization process to a second stage .",
    "firstly , all matched orb points are triangulated .",
    "secondly , a cross - correlation guided by epipolar geometry is used to find matches for all unmatched orb points in the newly added keyframe , according to algorithm 1 .",
    "[ fig : result of algorithm1 ] shows the map obtained by algorithm 1 . the original map created by orbslam and its reprojection onto one liver image",
    "are shown in fig .",
    "[ fig : result of algorithm1](a ) .",
    "blue rectangles in fig .",
    "[ fig : result of algorithm1](b , d , e ) are keyframes describing endoscope trajectory , camera position in current image is displayed in green .",
    "red points are orb map points . a semi - dense map is obtained by reconstructing points in a sparse regions in the image and represented as green points in fig .",
    "[ fig : result of algorithm1](d , e ) .",
    "more points will be reconstructed when exploring new regions . in subsequent frames , the newly reconstructed points ( by algorithm 1 )",
    "are tracked , firstly , by lucas - kanade optical flow .",
    "secondly , for all untracked points a cross - correlation search guided by epipolar geometry is performed using patch around the point extracted in the keyframe used for its 3d triangulation in algorithm 1 .",
    "[ h ]     +",
    "the performance was evaluated with several in - vivo pig laparoscopy sequences .",
    "the endoscope camera was calibrated following @xcite .",
    "next we detail the different experiments .",
    "more details can be appreciated in our video @xcite      we re - tune the orbslam to overcame the key factors limiting its performance when processing endoscope sequences , we report modifications relative to the orbslam standard rigid case :    search region in tracking : :    .- for tracking , map points are reprojected in the image , and each one    of them defines a search region in which a match with an image    keypoint is attempted .",
    "we have increased the size of the search region    in a factor 1.5 ( 0.5 pixel ) , not to loose some matches due to    potential deformation .",
    "parallax threshold at point initialization : :    .- when a map point is created , it is enforced to have at least a    threshold parallax to ensure that its location in 3d is accurate .",
    "minimum parallax is increased in a factor of 5 , it becomes    1.4035@xmath5 , to increase the accuracy in the    triangulated points .",
    "reprojection error threshold : :    .- a maximum threshold is allowed in the distance between the    reprojected map point and the image keypoints used for its    triangulation .",
    "we reduced this threshold in a factor 10 , it becomes    0.5991 , to ensure that only rigid scene points are included eventually    in the map . hamming distance threshold",
    ": :    .- we reduce the allowed hamming distance between descriptors of    matched image points . we decreased it by a factor 0.9",
    ", it becomes 45    bit , to enforce more similarity in the accepted matches .",
    "we have found that the endoscope tracking qualitatively quite robust and accurate . however , there are many areas of the scene where the system is unable to track map points , being able to match only 24% of the map points visible in the image .",
    "the main reason for this failure in matching , around 50% of the potential matches , is that orb detector is not able to detect repeatable points on soft organs , such as liver .",
    "also , ba in mapping process considers 11% of the map points as non - rigid , this percentage raises up to 25% in areas with visually high non - rigid component . despite the low number of matched map points ,",
    "the system was able to compute an sparse map .",
    "[ perf1d ] shows the reconstructed map which consisted of 66 keyframes and 1566 map points . in this part of the sequence",
    "the endoscope was fixed relative to the operating table , fig .",
    "[ perf1e ] and [ perf1f ] show the ability to estimate the breathing motion , because of the pig breathing there was a forward - backward motion of the diaphragm able to be seen in the camera trajectory .",
    "additionally , the system was able to accurately relocate the endoscope location after tracking loss . in fig .",
    "[ fig : relocation ] , after the exploration phase of the abdominal cavity , the endoscope was extracted outside the cavity while looking at the liver , and it is later reinserted imaging the spleen . since , several spleen points had been mapped before , the system was able to relocate the endoscope location within 3 seconds .",
    "[ h ]    finally , the system has also been tested with challenging gastroscopy sequences which contains reflection and abrupt movements .",
    "it was able to track the endoscope location and reconstruct 3d map of the scene ( cf .",
    "[ fig : gastroscopy ] ) .",
    "the average tracking time per frame was approximately 25 ms on desktop pc with intel(r ) core d -3337u cpu @ 1.80ghz with 6 gb ram .      to evaluate the error associated with the reconstructed point cloud of the scene , two pigs were used inside computed tomography ( ct ) room to obtain in - vivo sequences with ct ground truth surface . a monocular endoscope explores the abdominal cavity before any interaction with the liver .",
    "then a ct scan was performed while the endoscope was fixed by means of an articulated arm as shown in fig .",
    "[ fig : ct_acquisition ] . in all ct acquisitions ,",
    "the tip of the endoscope was included in the ct , to be segmented and extracted from the ct images . the length of the recorded sequences ranged between 2 to 10 minutes .",
    "the abdominal surface was segmented from ct images and considered as ground truth . in order to compare with the the vslam map , firstly , the endoscope was segmented from ct images and its position w.r.t the surface was computed using @xcite .",
    "endoscope position estimated by orbslam and by @xcite were aligned , however vlsam can not recover the scene scale ( @xmath6 ) , and @xcite can not recover the endoscope roll angle ( @xmath7 ) so additional scale and rotational alignment was needed before comparing the two scene maps . the alignment is not a critical process , brute - force search to find both the scale and the roll angle that minimize the distance between the vslam map and the ct surface was used .",
    "the distance is defined as the euclidean distance between each point in the vslam map its closest one on the ct surface .",
    "the closest point on the surface is the one with smallest perpendicular distance .",
    "so the the cost function for the brute - force optimization is : @xmath8 where @xmath9 are ct surface points closest point and @xmath10 are the @xmath11 vslam map points .",
    "@xmath6 and @xmath12 are the scale factor and rotation matrix calculated from the roll angle , respectively .",
    "only 80% of the points are considered in rmse computation .",
    "the remaining 20% are either outliers or points reconstructed on the diaphragm wall which was outside the ct field of acquisition .",
    "the obtained rmse of considering only reconstructed orb points was approximately 3 mm ( cf .",
    "[ fig : pointcloud2surface](a ) ) .",
    "the rmse of the semi - dense map obtained by algorithm 1 was approximately 4.1 mm ( cf .",
    "[ fig : pointcloud2surface](b - c ) ) .",
    "several pig liver sequences are used , which contains instruments interacting with the liver , what generates deformations and occlusions .",
    "[ fig : result1](b - d ) shows the endoscope tracking on one liver sequence , where red points are reconstructed orb points and green points are reconstructed by algorithm 1 . the estimated endoscope position in the current frame",
    "is represented in green rectangle , while the blue rectangles represent the trajectory described as past keyframe positions .",
    "yellow and blue points in fig .",
    "[ fig : result1](a ) are the reprojection of orb points and points reconstructed by algorithm 1 , respectively .",
    "we use the same colors for all subsequent figures .",
    "as it can be noticed , more points were reconstructed particularly on the liver ( fig .",
    "[ fig : result1](e ) ) .",
    "the number of the recovered 3d map points were about 4599 with 58 keyframes .",
    "[ fig : result2 ] shows results on different sequences including different deformations and partial scene occlusion due to an instrument .",
    "[ fig : result2](c ) shows , from a top view , the endoscope position w.r.t the reconstructed 3d map . the reconstructed 3d map , keyframes and current endoscope position for fig . [ fig : result2](d ) are displayed in fig .",
    "[ fig : result2](e , f ) . for first row sequence ,",
    "the size of the reconstructed map were 6750 points , 3263 points for second row sequence and 3740 points for third row sequence .",
    "it is worth noting that the liver of the second pig ( cf . fig .",
    "[ fig : result2 ] second and third rows ) was totally texture - less and it was hardly to detect features on its surface , but the system was able to reconstruct many points on liver .",
    "the endoscope location was successfully tracked during the interaction with liver in all sequences ( cf .",
    "[ fig : result2](b , d , g ) ) .",
    "in case of tracking failure due to feature deletion during fast endoscope movements the system was able to relocate the endoscope location once the endoscope had moved and few orb features were detected .",
    "algorithm 1 is allocated in the tracking thread , increasing its computation time as shown in table 1 , which reports the average additional time due to the reconstruction and matching of all points .",
    "the estimated endoscope location was used to superimpose ar onto one video sequence .",
    "the ar insertion was the liver pre - operative surface segmented from ct images in addition to hepatic veins .",
    "the pre - operative liver surface and hepatic veins were manually registered in first few frames , and then successfully tracked through out the whole video .",
    "few frames are randomly picked to show the augmented results in fig .",
    "[ fig : result3 ] .    to & + new points triangulation & orb triangulation & orb matching & l - k opt .",
    "flow & cross corr . & tracking time + 25.3 & 379.2 & 13.3 & 66.2 & 105.2 +",
    "in this paper , orbslam system has been re - tuned , proving it as a robust method for monocular endoscope tracking and 3d scene reconstruction from the only input of image stream gathered by the endoscope .",
    "additionally , it is extended to reconstruct a semi - dense map of the scene .",
    "the scene map accuracy has been evaluated against ct ground truth surface and achieving 3 - 4.1 mm rmse .",
    "the system has also been tested in several in - vivo sequences where displayed a robust performance , even during partial occlusions and severe deformations . in future work",
    ", the obtained semi - dense map and the tracked 2d points in the image will be used to estimate the non - rigid organ deformations using shape from template techniques .",
    "+   + * acknowledgments : * this work is supported by the direccon general de investigacon centfica y tcnica of spain under project rt - slam dpi2015 - 67275-p +   + * ethical approval : * all applicable international , national , and/or institutional guidelines for the care and use of animals were followed .",
    "5 stoyanov , d. , scarzanella , m.v . ,",
    "pratt , p. , yang , g .- z .",
    ": real - time stereo reconstruction in robotically assisted minimally invasive surgery . in : jiang , t. , navab , n. , pluim , j.p.w . ,",
    "viergever , m.a .",
    "miccai 2010 , part i. lncs , vol .",
    "6361 , pp .",
    "275 - 282 .",
    "( 2010 ) lin , b. , johnson , a. , qian , x. , sanchez , j. , sun , y. : simultaneous tracking , 3d reconstruction and deforming point detection for stereoscope guided surgery .",
    "miccai 2013 .",
    "lncs , vol . 8090 , pp .",
    "35 - 44 ( 2013 ) wu c .- h .",
    ", sun y .- n .",
    ", chang c .- c .",
    ": three - dimensional modeling from endoscopic video using geometric constraints via feature positioning.ieee transactions on biomedical engineering .",
    "vol 54(7 ) , pp .",
    "1199 - 1211 ( 2007 ) sun , d. , liu , j. , linte , c .- a . , duan , h. , robb , r .- a . : surface reconstruction from tracked endoscopic video using the structure from motion approach . in : miar 2013 .",
    "lncs , vol . 8090 , pp .",
    "127 - 135 ( 2013 ) .",
    "mountney , p. , stoyanov , d. , davison , a.j . ,",
    "yang , g .- z . : simultaneous stereoscope localization and soft - tissue mapping for minimal invasive surgery . in : larsen , r. , nielsen , m. , sporring , j. ( eds . ) miccai 2006 , part i. lncs , vol . 4190 , pp .",
    "347 - 354 .",
    "( 2006 ) davison , a.j .",
    ": real - time simultaneous localisation and mapping with a single camera . in : iccv ,",
    "1403 - 1410 ( 2003 ) mountney , p. , yang , g .- z . :",
    "motion compensated slam for image guided surgery . in : jiang , t. , navab , n. , pluim , j.p.w . ,",
    "viergever , m.a .",
    "miccai 2010 , part ii .",
    "lncs , vol . 6362 , pp .",
    "496 - 504 .",
    "( 2010 ) klein , g. , murray , d.w . : parallel tracking and mapping for small ar workspaces . in : ismar ,",
    "225 - 234 .",
    "( 2007 ) grasa , o.g . ,",
    "civera , j. , montiel , j.m.m .",
    ": ekf monocular slam 3d modeling , measuring and augmented reality from endoscope image sequences .",
    "in : miccai 2009 , vol .",
    "2 . ( 2009 ) grasa , o.g . ,",
    "bernal , e. , casado , s. , gil , i. , montiel , j.m.m .",
    "visual slam for handheld monocular endoscope .",
    "ieee transactions on medical imaging , vol 33(1 ) , pp .",
    "135 - 146 .",
    "( 2014 ) mur - artal , r. , montiel , j.m.m . ,",
    "tards , j.d . :",
    "orb - slam : a versatile and accurate monocular slam system .",
    "ieee transaction on robotics vol .",
    "31(5 ) , pp . 1147 - 1163 .",
    "( 2015 ) strasdat , h. , davison a.j . ,",
    "montiel , j.m.m , konolige , k. : double window optimization for constant time visual slam .",
    "ieee international conference on computer vision ( iccv ) , pp .",
    "2352 - 2359 .",
    "( 2011 ) galvez - lpez , d. and tards , j.d . : bags of binary words for fast place recognition in image sequences .",
    "ieee transactions on robotics , vol .",
    "28(5 ) , pp .",
    "1188 - 1197 .",
    "( 2012 ) strasdat , h. , montiel , j.m.m , davison , a.j . :",
    "scale drift - aware large scale monocular slam .",
    "robotics : science and systems vi ( 2010 ) .",
    "rublee , e. , rabaud , v. , konolige , k. , bradski , g. : orb : an efficient alternative to sift or surf .",
    "ieee international conference on computer visition ( iccv ) , pp .",
    "2564 - 2571 ( 2011 ) zhang , z. : a flexible new technique for camera calibration .",
    "ieee transactions on pattern analysis and machine intelligence , vol 22(11 ) , pp .",
    "13301334 ( 2000 ) youtube .",
    "( 2016 , august 1st ) .",
    "orbslam - based endoscope tracking and 3d reconstruction [ video file ] .",
    "retrieved from https://www.youtube.com/watch?v=uzpjhqx5-9a bernhardt , s. , nicolau , s.a .",
    ", agnus , v. , soler , l. , doignon , c. , marescaux , j. : automatic detection of endoscope in intraoperative ct image : application to ar guidance in laparoscopic surgery .",
    "ieee 11th international symposium on biomedical imaging ( isbi ) , pp .",
    "563 - 567 ( 2014 )"
  ],
  "abstract_text": [
    "<S> we aim to track the endoscope location inside the surgical scene and provide 3d reconstruction , in real - time , from the sole input of the image sequence captured by the monocular endoscope . </S>",
    "<S> this information offers new possibilities for developing surgical navigation and augmented reality applications . </S>",
    "<S> the main benefit of this approach is the lack of extra tracking elements which can disturb the surgeon performance in the clinical routine . </S>",
    "<S> it is our first contribution to exploit orbslam , one of the best performing monocular slam algorithms , to estimate both of the endoscope location , and 3d structure of the surgical scene . </S>",
    "<S> however , the reconstructed 3d map poorly describe textureless soft organ surfaces such as liver . </S>",
    "<S> it is our second contribution to extend orbslam to be able to reconstruct a semi - dense map of soft organs . </S>",
    "<S> experimental results on in - vivo pigs , shows a robust endoscope tracking even with organs deformations and partial instrument occlusions . </S>",
    "<S> it also shows the reconstruction density , and accuracy against ground truth surface obtained from ct . </S>"
  ]
}