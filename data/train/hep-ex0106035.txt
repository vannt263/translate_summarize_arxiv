{
  "article_text": [
    "in 1988 - 1989 the new generation of neutrino experiments started at ihep ( protvino ) . it was a result of the physical start of the new ihep - jinr neutrino detector , increased intensity of the ihep 70 - gev proton accelerator and somewhat changed situation in the neutrino physics , which required better accuracy of measurements and inspired interest to experiments with electron neutrinos .",
    "+ most of these experiments were carried out with a nonstandard mode of work of the neutrino facility .",
    "it concerns the beam - dump experiment , the experiment with focusing system switched off and the new experiment with short decay base .",
    "these experiments required a new program for neutrino spectra calculations which could take into account additional effects that become important in these modes of the neutrino beam formation , for example hadronic interactions in the elements of the neutrino channel other that the neutrino target .",
    "+ for this purpose a program based on the geant library @xcite was chosen .",
    "it has the following advantages :    * developped , multiply checked and supported package for a simulation of passage of particles through matter , including hadron showers ; * the way of describing a geometry is sufficiently developped and familiar to most of physicists .",
    "the disadvantage of the full geant - like simulations of processes in the neutrino channel is that it is rather time consuming .",
    "this required usage of tricks that would increase the number of useful decays , but in spite of them , only after appearance of sufficiently powerful computers an accurate calculation of neutrino spectra by such a program became possible .",
    "in the geant library the procedures for random decays of particles in flight are provided .",
    "if geant accomplishes a decay , the particle is stopped ( no more traced ) .",
    "thus , a particle can decay only once , which required the simulation of many particles and a lot of cpu time .",
    "for this reason routines different from the ones of the geant library were used for the simulation of decays .",
    "these routines are called several times on every step of a particle .",
    "the geant table of branching ratios was changed ( some branching ratios are zeroed ) , so that geant does not accomplish decays to neutrinos of the type for which the spectra are being calculated . to take into account correctly the zeroed branching ratios the geant routine gdecay",
    "is slightly changed .",
    "namely , if no decay mode is chosen ( it is now possible since the sum of branching ratios is not equal to unity ) , a particle is not stopped .",
    "thus , a particle makes more steps , which also improves the statistical accuracy of the calculations .",
    "the effect of decreasing number of particles along the beam due to a finite lifetime is taken into account through weights ascribed to particles .",
    "+ unfortunately , although all these tricks certainly decrease the overall statistical errors of calculations , they do not decrease by the same factor all components of these errors .",
    "for example , the fluctuations due to hadron showers are not decreased .",
    "this makes very difficult a direct estimation of statistical uncertainties of spectra .",
    "the only obvious way to estimate them is to compare results of several runs of the program .",
    "this consideration also suggests that there is no sense in very small steps or many decays in one step .",
    "+ some branching ratios , such as the branching ratios to hadrons , are not changed in order to simulate more exactly the beam composition ( for example if a kaon decays to pions , these pions are also traced later ) .",
    "for the same purpose and in order to take into account decays of muons during the calculation of electron neutrino spectra the program has 2 modes of work :    1 .",
    "the calculation of muon neutrino and antineutrino spectra",
    ". the branching ratios of decays to electron neutrinos are not changed since in some of them charged pions are produced .",
    "2 .   the calculation of electron neutrino and antineutrino spectra . the branching ratios of decays to muons are not zeroed .    in each of these modes it is possible to simulate directly hadron showers in the neutrino target induced by initial protons or ( not for the beam dump ) to use parameterized yields of particles from the standard neutrino targets . + as most of programs using geant library the program consists of the following parts :    1 .",
    "the initialization . here beside usual geant calls the geant table of branching ratios is changed .",
    "2 .   the geometry definition .",
    "it is a usual geant geometry definition @xcite except that some volumes should have standard numbers ( the target , lenses and some volumes for the calculation of control distributions ) . besides , the constants for the spectra calculations , such as a distance to a possible detector and its maximal sizes , are set .",
    "3 .   the routine for the action before each event . here",
    "either a proton is put into the geant initial bank ( direct calculation ) or several hadrons with random momentum and angle ( parameterization ) .",
    "4 .   the routine for the action after each step .",
    "it calls the two main routines of the program : + a ) the routine that ascribes a weight to a new particle or calculates a weight after each step . a weight 1 is ascribed to primary protons . in the mode of work with a parameterization a weight to primary hadrons at their first appearance is ascribed according to this parameterization . for other particles , at their first appearance , their creation vertex is searched for in the array of vertices ( this is not in the standard geant banks and common blocks , see below ) . from this",
    "array the initial weight , the type and momentum of a parent particle , the spin direction ( for a muon ) are taken .",
    "if there is a correction factor for the process of creation of this particle by its parent particle the weight is corrected .",
    "after each step the weight is decreased according to the life time of particle divided by the sum of all zeroed branching ratios .",
    "+ b ) the calculation of the neutrino spectra . for two",
    "body decays the limits on the angles in the center of mass system are calculated , so that neutrinos from a decay can be inside the maximal detector volume . for three body decays ,",
    "if a neutrino energy is above threshold and its direction does not hit the detector maximal volume , its azimuthal angle is resimulated withing the limits that contain the maximal detector volume .",
    "the probability of a decay in case of additional limits is multiplied by the corresponding phase space factor .",
    "the matrix element of decays is taken into account .",
    "for decays of muons it depends on the spin direction .",
    "+ the probabilities of decays are put into double precision arrays that correspond and will be rewritten in the end of run into one- and two - dimensional histograms ( energy - radius , energy - angle ) .",
    "the routine for the action after each act of creation of new particles . as usual",
    ", particles below cut and those that do not contribute to the neutrino spectra , are ignored . here",
    "the array of vertices mentioned above is filled",
    "the first calculations of wbb spectra were made in the mode with the full simulation of the hadron shower in the neutrino target , which is a 60 cm long aluminium cylinder .",
    "although the final calculations were made using the parameterization , it is interesting to compare the geant yields with the ones measured in @xcite .",
    "these measurements are rather detailed , they include secondary particles from the primary beam of 67 - gev protons in the momentum range from 5 - 7 gev to 60 gev and the angle range from 0 to 50 mrad , subdivided into energy bins of 1 gev and angle bins of 2 mrad . + the comparison for geant 321 with gheisha is shown in fig .",
    "[ fig : gheisha ] . + the comparison for geant 321 with fluka is shown in fig .",
    "[ fig : fluka ] .    from these fugures one can see that geant",
    "does not simulate correctly the yields of hadrons , the difference reaching a factor of 2 for the case of gheisha .",
    "for this reason in the mode of work with a full simulation the correction by weights ( previous section , 4a ) should be used .",
    "+ special attention should be paid to the spectrum of @xmath0 , for which there are no reliable measurements at 70 gev .",
    "often it was assumed that there is the following relation between the charged and neutral k mesons : @xmath3 it is clear from the following considerations that the relation should be different .",
    "we are usually interested in spectra of rather fast particles , which means that they should be `` leading '' particles , i. e. should contain a quark from the incident proton .",
    "simple counting of quarks shows that the spectrum of @xmath0 should be closer to the spectrum of @xmath2 than to the spectrum of @xmath1 .",
    "+ in order to find the best description the following measurements were analysed : the @xmath0 measurement at fnal @xcite at 300 gev , the charged kaon measurements at cern at 400 gev @xcite and the charged kaon measurements @xcite at ihep ( protvino ) at 67 gev .",
    "all measurements were made on thin targets .",
    "the method @xcite of comparison of spectra at different energies was used .",
    "it uses the variable @xmath4 , the ratio of the energy in the center of mass system to the maximal energy at a given @xmath5 .",
    "the best description was obtained with the following formula : @xmath6 where @xmath7 is the ratio of the distributions u / d in a proton .",
    "this value is a function of a scaling variable @xmath8 , which we substitute here by @xmath9 , which does not introduce a large error since the function does not change rapidly with @xmath8 .",
    "it can be found for example in @xcite .",
    "@xmath10 changes from 1 to 5 as @xmath9 changes from 0 to 1 ( fig .",
    "[ fig : utod ] ) .",
    "the following approximation was used afterwards in calculations of spectra : @xmath11    the uncertainty of formula ( 2 ) is estimated to be 15% , which is a quadratic sum of the uncertainty of the fnal measurements ( 10% ) , the uncertainty of the scaling from 70 to 400 gev ( 10% ) and a smaller uncertainty of the cern measurements . + in fig .",
    "[ fig : k0 ] one can see that the formula ( 2 ) is in a much better agreement with the copper data than @xmath12 .",
    "the agreement of the formula ( 2 ) on berillium is also quite reasonable .",
    "apparently the measurements @xcite on berillium slightly underestimate the yields .",
    "practically the only possible way of spectra calculation for beam dump experiments is the mode with a full simulation of hadron showers in the target .",
    "it is difficult here to use parameterizations .",
    "however , at least the geant ( gheisha ) yields of particles from the first interaction of protons were compared with the results of measurements on the thin copper target @xcite . the difference was similar to that seen in fig .",
    "[ fig : gheisha ] .",
    "a corresponding correction was used in the calculations of spectra ( see section 2 , 4a ) .",
    "+ the systematic uncertainties of the calculated spectra were determined by the systematic uncertainties of the measurements @xcite .",
    "possible uncertaintied in the simulation of the secondary interactions by geant were suppressed since corresponding secondary particles contribute 20 - 30% to the neutrino spectra interesting for the beam dump experiment .",
    "these contributions were so small due to the fact that the experiment @xcite was devoted to the search of hard neutrinos from the charm production which required rather high energy cuts . + it is possible to reduce these uncertainties for the electron neutrino and antineutrino spectra . for this purpose",
    "the reconstructed muon neutrino events were used .",
    "the high energy region of the muon neutrino and antineutrino spectra is dominated by decays of charged kaons ( the contribution from charm estimated from the beam - dump extrapolation method was small ) . for this reason , comparing the number of reconstructed muon neutrino events with the calculated one it is possible to check the charged kaon spectra and to reduce systematic uncertainties .",
    "+ the final accuracy of the spectra calculations were 10% for the electron neutrinos and 16% for the electron antineutrinos .",
    "+ besides , for the beam - dump experiment such important value as a ratio of effective densities of the two targets can be calculated with a very good accuracy . since the dimensions of the half - density target were finite and there were constructive gaps ,",
    "it is not exactly 2 as it was designed .",
    "furthermore , this ratio for muon neutrinos is different from that for electron neutrinos since for the latter there is a contribution from @xmath13 . for such calculations mainly",
    "a correct simulation of the shower shape is needed , which is reproduced by geant more reliably ( this was checked , for example , during the calibration of the neutrino detector ) .",
    "the calculated ratio of the effective densities is 2.0 for muon neutrinos and 1.9 for electron neutrinos ( accuracy 1% , mainly statistical ) .",
    "+ for additional control of the beam and spectra during the beam - dump experiment the muon fluxes in 9 gaps of the muon filter were measured @xcite . in fig .",
    "[ fig : bdmu ] the calculated fluxes are compared with the measured ones ( the accuracy of measurements 3% , to which the uncertainty of the prompt muon pair production subtraction 7% should be added ) .",
    "unfortunately , such control does not allow to improve the accuracy of the electron neutrino spectra calculations since the main source of muons ( more than 80% ) is the decay of pions .",
    "two rather long runs of the ihep - jinr neutrino detector were carried out with the neutrino channel focusing system turned off . such mode of work has the advantage of a higher fraction of electron neutrinos , sufficient to perform some studies .",
    "these runs were also used for the measurement of the total cross section of neutrino and antineutrino interactions ( simultaneously ) .",
    "the corresponding total neutrino fluxes are significantly lower than with the focusing system turned on , but the loss of statistics for the neutrino detector was not dramatic because due to the lack of a resonant beam extraction ( only a fast extraction is available in ihep protvino ) the event aquisition rate is limited by the maximal allowed occupancy of the neutrino detector . in these measurements",
    "it is also important that neutrino and antineutrino spectra are less steep , which decreases the effects of smearing .",
    "+ since in this neutrino beam ( as well as in all the beams described below ) the standard neutrino target was used , the calculations were accomplished in the mode of work of the program that uses the parameterization of secondary particle spectra from the target .",
    "but the data of @xcite could not be used directly since the measurements @xcite were carried out with a 6 cm diameter aluminuim target , whereas in the neutrino runs a 1 cm diameter target was used .",
    "the neutrino spectra in this case are better ( harder ) , but the parameterization should be corrected .",
    "the correction was obtained in the following way : the program was run in the mode of full shower simulation and the correction was obtained by dividing the corresponding yields of hadrons from the targets .",
    "+ in the mode of work with the parameterization the geant correction procedure mentioned in section 2 , 4a , is still needed since part of protons traverse the target without interaction and interact in the lenses , which is simulated by geant .",
    "what is significantly better in this mode of work is that statistical errors at high energy are much lower since the unweighted spectrum of hadrons from a target to be traced by geant is flat ( is not a function of momentum ) .",
    "+ it turned out that without focusing the secondary effects , such as interactions of hadrons in the channel elements are much more important than with normal focusing .",
    "this happens because a bigger fraction of particles hit the walls of the decay tunnel .",
    "in addition , when the focusing system is turned on , the secondary particles from the interactions in the neutrino channel elements are not focused or are not in optimal conditions for a focusing . for this reason",
    "they contribute less to the neutrino spectra .",
    "+ only after calculations with a program based on geant the agreement between the calculated and measured @xcite muon fluxes was obtained .",
    "this is shown in fig .",
    "[ fig : nofocmu ] .",
    "+    the systematic errors of the muon neutrino spectra in the first approximation are those of @xcite , but they are additionally controlled , mainly below 10 gev ( pionic part ) , by the muon flux measurements ( the accuracy of the measurements about 3% ) .",
    "+ in the electron neutrino spectrum for this neutrino channel a contribution from muon decays is significant . for the calculation of this contribution",
    "it is important to take into account the polarization of muons .",
    "these decays increase the electron neutrino spectrum by up to 20% at 3 gev ( thay give softer neutrinos so this difference is the smaller the higher is the energy ) . this effect is even more important for the neutrino beam with focusing . +",
    "here some difficulty was to introduce into the program the parabolic lenses used in ihep because there is no paraboloid shape in geant .",
    "if define these lenses as cylinders , the magnetic field in them is not only non - uniform but non - contiguous and geant does not trace particles correctly . for this reason a routine for the step limitation in the lenses was introduced .",
    "the step is limited so that it is either entirely in a region with field or entirely in a region without field or is very small .",
    "+ the electron neutrino spectrum with a contribution from decays of muons is shown in fig .",
    "[ fig : foc ] .",
    "+ the systematic uncertainty of the neutrino flux calculation consists of the same uncertainties as for the beam with the focusing system off and additional uncertaintied of the focusing system such as a possible inaccurate target and lenses positioning and an uncertainty in the simulation of starting points of particles inside the target .",
    "no studies of the focusing system uncertainties were made with this program , but the previous studies @xcite show that , taking into account muon flux measurements , they can be kept as low as 7%",
    "for this experiment @xcite , with rather complicated and asymmetrical geometry of the decay region , it was very convenient to use geant tools for the description of the geometry .",
    "+ the decay cavity can be described as 4 adjacent ( with steps in the vertical projection ) trapezoids , asymmetric in the vertical projection .",
    "it is narrow near the target to provide a better radiation shielding and wider near the end closest to the detector .",
    "it was made asymmetric because of the danger of `` underground '' muons that can go around the iron muon filter , in the earth under it due to a multiple scattering .",
    "+ in this experiment a contribution from muon decays is also rather significant , including decays of muons in the muon filter ( the path length of muons in it is comparable or even bigger than the length of the decay region ) .",
    "a program for the neutrino spectra calculations based on the geant library is created .",
    "the range of possible applications of the program is very wide .",
    "the author expresses the gratitude to a.s.vovenko , a.i.mukhin , yu.m.sviridov , yu.m.sapunov for helpful discussions , v.i.kravtsov , yu.m.sapunov , k.e.shestermanov for provided routines . + the developments of the program for the neutrino spectra calculations have been possible thanks to the computer power and other support offered by the physics institute of the university of urbino ( italy ) .    99 geant manual , cern program library long writeup w5013 , copyright cern , geneva , 1993 bojko n.i .",
    "et al . , yadernaya fizika , v.31 , p. 1246 ; v.31 , p. 1494",
    "( 1980 ) ; preprint ifve 79 - 77 , serpukhov , 1979 ( russian ) .",
    "the numerical data are only in the preprint and in the ihep data base scubic p. et al .",
    ", phys.rev d18 , p.3115 ( 1978 ) atherton h.w .",
    ", cern 80 - 07 ( 1980 ) taylor f.e .",
    "et al . , phys.rev .",
    "d14 , p.1217 ( 1976 ) johnson j.r .",
    "et al . , phys.rev d17 , p.1292 ( 1978 ) blumlein j. et al . , phys .",
    "b279 , p.405 ( 1991 ) bugorsky a.p .",
    "et al . , nim 146 , p.367 bugorsky a.p .",
    "et al . , preprint ifve 78 - 116 ( russian ) , serpukhov , 1978 ; belkov et al . , preprint ifve 82 - 99 ( russian ) , serpukhov , 1982 a.a .",
    "borisov et al . , phys.lett .",
    "b 369(1996 ) p.39 ."
  ],
  "abstract_text": [
    "<S> the methods of neutrino spectra calculations with geant library and the peculiarities of such calculations for different neutrino beams are summarized . </S>",
    "<S> the formula expressing @xmath0 yields from a neutrino target through the @xmath1 and @xmath2 yields from the same target is proposed .    </S>",
    "<S> neutrino spectra , hadron yields </S>"
  ]
}