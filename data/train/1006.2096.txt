{
  "article_text": [
    "at the heart of many astronomical studies today is the basic step of catalog merging ; combining measurements from different time intervals , wavelengths , and potentially separate instruments and telescopes .",
    "scientific analyses exploit these multicolor cross - matches to understand the temporal and photometric nature of the underlying objects . in doing",
    "so they rely implicitly on the quality of the associations , thus the cross - identification of sources is arguably one of the most important steps in measuring the properties of celestial objects .    in general , cross - matching catalogs",
    "is a difficult problem that can not really be separated from the scientific question at hand .",
    "an example of this is apparent when we consider the case of stellar observations .",
    "stars that move between observations , due to their proper motions , are difficult to merge into multicolor sources ( even within a single survey ) . yet without the multicolor information it might not be possible to classify the source as a star in the first place . with a new generation of surveys that will take large quantities of multicolor photometry covering the galactic plane and observed over a period of several years ( e.g.  the panoramic survey telescope & rapid response system , panstarrs , and the large synoptic survey telescope , lsst ) it is clear that addressing these issues is becoming a serious concern .    in the recent work of @xcite a general probabilistic formalism",
    "was introduced that is extendable to arbitrarily complex models .",
    "the beauty of the approach of bayesian hypothesis testing is that it clearly separates the contributions of different types of measurements , e.g. , the position on the sky or the colors of the sources , yet , naturally combines them into a coherent method .",
    "it is a generic framework that provides the prescription for the calculations that can be refined with more and more sophisticated modeling .    in this paper , we go beyond the simple case of stationary objects , and study the cross - identification of point sources that move on the sky .",
    "most importantly we focus on stars that can be significantly offset between the epochs of observations .",
    "although we only have loose constraints on their proper motions in general , this prior knowledge is enough to revise our static models , and work out the bayesian evidence of the matches . in section  [ sec : bf ]",
    "we introduce a class of models that allow for changes in the position over time .",
    "section  [ sec : prior ] deals with the a priori constraints on the proper motions of the stars and their empirical ensemble statistics . in section  [ sec : res ] we show the improvements over the static model on actual observations of stars , and section  [ sec : sum ] concludes our study . throughout this paper ,",
    "we adopt the convention to use the capital @xmath0 symbol for probabilities and the lower case @xmath1 letter for probability densities .",
    "conceptually , modeling the position of moving sources is straightforward .",
    "the description combines the motion and the uncertainty of the astrometric measurements .",
    "the first question to answer is where on the sky one should expect to see an object of a certain proper motion , if it had been in some known position at a given time .",
    "next , we calculate the evidence that given detections are truly observations of the same object .      the positional accuracy is characterized by a probability density function ( hereafter pdf ) on the celestial sphere . in a given model @xmath2 ,",
    "this @xmath3 function tells us where to expect @xmath4 detections of an object that is at its true location @xmath5 . throughout this paper",
    ", we use 3-dimensional unit vectors for the positions on the sky , e.g. , the aforementioned @xmath4 and @xmath5 quantities . usually the pdf is a very sharp peak and is assumed to be a normal distribution with some angular accuracy @xmath6 .",
    "the correct generalization to directional measurements is the @xcite distribution , @xmath7 whose shape parameter @xmath8 is essentially @xmath9 in the limit of large concentration ; see details in @xcite .",
    "the added complication comes from the fact that some objects are not stationary .",
    "if a given star is at location @xmath5 now and has @xmath10 proper motion then @xmath11 time later , it would be at some other position @xmath12 @xmath13 that is offset by a small displacement along a great circle . by substituting this position into our astrometric model",
    ", we create a new one @xmath14 with the added proper motion , @xmath10 , and time difference , @xmath11 , parameters .",
    "@xmath15 naturally , there is nothing specific in this about the chosen characterization of the astrometry ; one can use any appropriate pdf in place of the fisher distribution instead .      at the heart of the probabilistic cross - identification",
    "is the bayes factor used for hypothesis testing .",
    "the question we are asking is whether our data @xmath16 , a set of detected sources in separate catalogs with positions @xmath17 , are truly from the same object .",
    "for every catalog , we know its epoch and its astrometry characterized by a known @xmath18 pdf .",
    "let @xmath19 denote the hypothesis that assumes that all measured positions are observations of the same object , and let @xmath20 denote its complement , i.e. , any one or more of the detections might belong to a separate object . by definition ,",
    "the bayes factor is the ratio of the likelihoods of the two hypotheses we wish to compare , @xmath21 that are calculated as the integrals over their entire parameter spaces .",
    "if we assume that there is a single object behind the observations , we can integrate over its unknown proper motion and position to calculate @xmath22 where the joint likelihood of @xmath19 given the data is written as the product of the independent components and @xmath23 is the prior on the parameters , which is the subject of the following section .",
    "the actual calculation of this likelihood depends on the prior and might only be accessible via numerical methods .",
    "the complementary hypothesis is more complicated in the sense that the model has a set of independent objects with @xmath24 parameters , however , the result of the calculation turns out to be much simpler . here",
    "the integral separates into the product of @xmath25 for each integral , we can select a reference time such that @xmath26 , hence the effect of the proper motion drops out , and we arrive at the same result as the stationary case discussed by @xcite .",
    "the proper motion really only shows up in the numerator of the bayes factor for assessing the quality of the association . the model is well - defined but the integration domain is set by the joint prior that is yet to be determined . in general",
    ", the prior @xmath27 can be very complicated for its dependence on the properties of the star .",
    "simply put , brighter sources are likely to be closer , and hence , have a larger proper motion .",
    "more complicated is the effect of the color that is ( along with its magnitude ) a proxy for placing the star in different stellar populations with different dynamics . in this paper",
    ", we will not discuss these effects that will be a topic of future work .",
    "we also note that the prior can be a function of the time difference , @xmath28 , to account for cases when the star travels far between observations to a new location with different source density .",
    "however , we expect this to be a small effect because the typical speed of stars and the usual time differences between observations today yield small displacements on the sky",
    ".    using the basic properties of conditional densities , we can write it as the product @xmath29 where the first term is the prior on the position , e.g. , the all - sky prior written with dirac s @xmath30 symbol as @xmath31 and the more complicated second term describes the possible proper motions as a function of location and optionally other properties .",
    "the simplest possible model , after the stationary case , is to assume a uniform prior on @xmath10 up to some @xmath32 limit independent of the location , i.e. , @xmath33 we will use this simple prior for comparison in addition to the stationary case , where @xmath10 is assumed to be negligible .    .",
    "to derive a more realistic @xmath34 prior , we choose to study the ensemble statistics of stars instead of approaching the problem with an analytic model . while the latter would have the advantage of providing a function at an arbitrary resolution , the formulas are difficult to derive and the analytic approximations might miss subtle details of the relation that could be relevant .",
    "we study the properties of stars in the sloan digital sky survey catalog archive that also contains accurate proper motion measurements from the recalibrated united states naval observatory b1.0 catalog ( usno - b ; * ? ? ?",
    "* ) . for this analysis",
    ", we pick stars from the stripe 82 data set where multiple observations are available over 300 square degrees strip covering a narrow range in declination between @xmath35 .",
    "these repeated observations were taken between june and december each year from 1998 to 2005 @xcite . after rejecting saturated and faint sources ( u should be in the range of 1523.5 and g , r , i , z in the range of 14.524 ) , the number of stars is around 100,000 .",
    "this size does not allow for a high - resolution determination of the prior , hence we analyze additional simulation data .    to extend the number of stars used in constructing the prior",
    ", we used the current state - of - the - art besanon models @xcite that match the sdss distributions well . assuming four different stellar populations in the milky way , using the poisson equation and collisionless boltzmann equation with a set of observational parameters ( i.e.  fitting parameters to the dynamical rotation curve ) , they compute the number of stars of a given age , type , effective temperature and absolute magnitude , at any place in the galaxy .",
    "the model has been successfully used for predictions of kinematics and comparison with observational data in studies , e.g. , @xcite , @xcite , @xcite , @xcite , @xcite .",
    "a total of @xmath36 stars were generated from the besanon models using large - field equatorial coordinates , thus the prior is dominated by model data and not by sdss measurements .",
    "the proper motion distribution of sdss data and that of the model are very consistent , with the model yielding somewhat wider distributions than the observations .    in preparation for binning the data ,",
    "we separate the dependence of the prior on the different proper motion components , @xmath37 , and , omitting the explicit hypothesis , we write @xmath38 since the stripe 82 data set in sdss contains sources only in a narrow declination range between @xmath39 and @xmath40 , we can safely neglect the dependence on declination in equation  ( [ pm1 ] ) for the purpose of this study , thus @xmath41 we establish these relations one - by - one starting with the former using the basic property of conditional densities @xmath42 to achieve a better signal - to - noise behaviour across the entire parameter space , we do not use a uniform grid but vary bin sizes so that they follow the asinh ( ) in both parameters . in this way one can have higher resolution bins where more data are available ( around the peak close to 0 ) and wider bins in the tail .",
    "we further improve the quality of the empirical prior by removing high - frequency noise with a convolution filter , whose characteristic width is approximately one pixel in size at any location .",
    "the integral in the denominator is evaluated by counting the stars in the appropriate bins using the widths of the bins to weight the counts .",
    "figure  [ prior1 ] shows the prior using the aforementioned non - linear scale for @xmath43 as function of the position @xmath44 .",
    "the distribution is centered on approximately , and the location of the mode is practically independent of the r.a . as one nears to the direction of the galactic plane ( @xmath45 and @xmath46 are the nearest regions in this stripe ) the distribution becomes sharper .",
    "this is to be expected as , if we included a broader range in right ascension , the pdf would get even narrower as the velocity dispersion of stars decreases .    the second term of equation  ( [ pm2 ] ) is constructed similarly using the same adaptive binning and smoothing but in even higher dimensions .",
    "it is difficult to visualize a 4-dimensional pdf , hence , in figure  [ prior2 ] , we plot slices of the prior at various @xmath44 values .",
    "both axes are shown in the transformed scale .",
    "the values @xmath47 and @xmath48 represent the two edges of stripe 82 , which are closest parts to the galactic plane .",
    "the same effect can be seen on these panels as on figure [ prior1 ] , looking out of the plane the pdf gets more disperse .",
    "the boxy ( squared ) shape of the contour lines arises from the asinh ( ) transformation ; on a linear system , the contours would appear to be more circular .",
    "as mentioned earlier , stripe 82 was observed repeatedly from 1998 to 2005 , between june and december of each year .",
    "thus we can obtain multi - epoch observations to test our method .",
    "we choose a range of stars with different proper motions observed at different epochs . to be sure that for our tests the observed stars are the same in each epoch we select bright stars ( magnitude @xmath49 ) with tolerances in all magnitudes ( typically 0.7 in u , 0.4 in g , r , i and 0.5 in z ) .",
    "the query gives us on the average 20 epochs per star , from which many were observed with small time intervals while the biggest time interval between the epochs is approximately 6.5 years .",
    "we divide the time interval into 3 approximately equal parts and thus get 4 observations of each star with much the same time intervals between them .",
    "according to equations  ( [ int1 ] ) and ( [ int2 ] ) , only ra and dec coordinates are used for calculating the bayes factors , usno measurements of proper motion on the forthcoming figures and tables are only shown as a reference .",
    "we randomly select a dozen stars for the following tests .",
    "we calculate the integrals of the bayes factor numerically .",
    "our monte - carlo implementation generates independent random positions @xmath50 ( 3-d unit vectors ) and two random components of the velocity that yield the @xmath51 vector in the tangent plane of each @xmath52 , i.e. , @xmath53 in theory , one has to integrate the position over the whole celestial sphere , and the proper motion out to infinity , but the integrands always drop sharply in practice , hence one can bound all the relevant parameters easily to reduce the computational need and to use the above approximation to the motion . for more efficient implementations , one can utilize more sophisticated markov chain monte carlo ( mcmc ) methods .",
    "the uncertainty estimates include two separate sources of errors .",
    "the numerical imprecision is tuned by the number of generated random parameters , and can be estimated in the process of the integration . in our calculations , this error term is kept at a low level , and contributes @xmath54 order of magnitude to the value of the weight of evidence .",
    "another source of error comes from the uncertainty in position measurements .",
    "while this is small for the sdss detections , @xmath55 , the short time differences could yield large relative errors in the proper motion . to get the order of this error",
    ", we generate 100 random realizations of the position of every star from the appropriate gaussian distribution , and recalculate the bayes factor to derive the root - mean - square error in the weight of evidence .",
    "the figures later in this section contain error bars that represent these 1@xmath6 deviations .",
    "after the static case , the simplest is a uniform prior as introduced in equation  ( [ eq : uconst ] ) .",
    "this analytic formula may appear at first not to favor any particular proper motion , yet the bayes factor has some non - trivial scaling properties that are worth considering .    as the displacement of the source is a product of the time difference and the proper motion , associations at the same distances but with varying time intervals",
    "will indeed have different bayes factors . in the case of a longer @xmath11",
    ", only smaller proper motions will contribute to the integral in equation  ( [ int1 ] ) shrinking the integral domain .",
    "this yields a scaling by a factor of @xmath56 , as seen in the left panel of figure  [ uniform ] .",
    "this means that associations will be assigned lower qualities if they are farther in time even if their angular separations are identical .",
    "another interesting aspect is the selection of the limiting @xmath32 value .",
    "our choice of 600  mas / yr is admittedly somewhat arbitrary and was selected to cover the stars in our sample .",
    "if one decreased its value then stars moving at faster speeds would quickly get lower bayes factors and clearly not be associated .",
    "increasing limits make the value of the constant prior drop , which in turn will lower the quality of the associations . for illustrating this effect we compute the bayes factors for a star with @xmath57 and @xmath58 years as a function of @xmath32 ,",
    "see the right panel of figure  [ uniform ] . as the prior is proportional to @xmath59",
    ", the curve follows the same trend .",
    "first we analyze the quality of the associations as a function time difference between the observations .",
    "the top panels of figure  [ 2obs ] show the logarithm of the bayes factor , a.k.a .  the weight of evidence for all stars in our test sample as a function of their proper motion .",
    "open circles represent the results from the static model that can be obtained analytically as in @xcite , and crosses show the new measurements from the numerical integration of the improved model using the empirical prior introduced in this study .",
    "triangles signal the value for a simple model of constant proper motion prior with @xmath60 .",
    "if we correct for small relative differences in time intervals between the epochs taking 2 , 4.5 and 6.5 years as a reference respectively , this prior yields practically constant weights of evidence . for reference ,",
    "the @xmath61 threshold is plotted as the dashed horizontal line .",
    "this is the theoretical dividing line above which the observations support the hypothesis of the match .",
    "all panels contain the same objects but the calculations are based on different detections that are farther apart in time as we go from left to right .",
    "what we see immediately is that as the time difference increases , the models provide increasingly different results : the static model starts rejecting stars with larger proper motions much faster than models that accommodates the possibility of the sources moving .",
    "while the only objective measure of the quality for the match is the bayes factor , its interpretation for the uninitiated is admittedly not as obvious at first as a probability value would be , where one has a good sense of the meaning of the values . from the bayes factor , we can calculate the posterior @xmath62 , if we have a prior @xmath63 via the equation @xmath64^{-1}\\ ] ] assuming a constant prior over the sky with the value of @xmath65 , where @xmath66 is the estimated total number of stars on the sky as computed from the average density in sdss , we can plot the matching probabilities for comparison .",
    "note that large posterior probabilities are not sensitive to small modulations in the density ; it changes linearly only for small values of the bayes factor .",
    "the bottom panels of figure  [ 2obs ] use the same symbols as the top ones to illustrate the derived posteriors using the above constant prior .",
    "the difference between the models is possibly even more striking here : while the left panel has very similar estimates from the different models , with time the separations grow large enough to quickly zero out the probabilities for stars with proper motions larger than 100  mas / yr , whereas the new models keep the probabilities significantly larger .",
    "table  [ tab : dt ] contains the measurements for all stars as function of the time difference .",
    "the first column of the table is the identifier of the star , the objid in sdss data release 6 .",
    "the reference proper motion values are taken from ` propermotions ` table of the sdss catalog science archive , which combine the sdss and the recalibrated usno - b astrometry for a precise and reliable determination .",
    "we see two important features of the associations using the new proper motion priors .",
    "the constant prior yields lower and lower bayes factors as the elapsed time increases and the probability drops regardless of the proper motion . even when the separations are small enough for the static model to perfectly recover the object , the constant proper motion prior yields a lower 90% probability .",
    "the empirical prior always outperforms the static model but , in this 2-epoch observation case , the probabilities of the fast stars fall below the constant case or any reasonable probability threshold .",
    "next we turn our attention to the potential improvements from including additional epochs to the data sets . for this comparison , we keep the first and last observations in time , hence the baseline is the same for all cases .",
    "we add to these two observations additional measurements whose epochs are between them in time .",
    "these 2- , 3- and 4-way associations are shown in the left , middle and right panels of figure  [ long_obs ] , respectively .",
    "it is apparent that adding new detections significantly improves the the proper motion models : the reasonably good associations of only two detections are promoted to essentially certain matches by including intermediate detections . in contrast , the static model continues to reject the associations of all high proper motion stars .",
    "we see that one of the stars with @xmath67 actually gets a high probability even in the static model , when the angular separation for only a few years between the epochs is small enough to recover the star .",
    "table  [ tab : n ] shows the measurements as a function of the number of epochs used in the calculations .",
    "we see that the empirical prior of the improved model assigns 100% probability of all stars when considering all 4 epochs , and even the 3-epoch computations would yield close to that with the @xmath68 star getting a lower 97% .",
    "the exception from this is the fastest star at @xmath69 in case of the empirical prior , whose probability is essentially 0 in all panels .",
    "the reason for this is that this star is one of the highest proper motion stars in stripe 82 and even with the generated model stars , which appear in the prior , we have very few ( roughly 40 ) high proper motion stars .",
    "it is worth re - iterating the reason for and the consequence of these results .",
    "associations of more than two detections benefit dramatically more from the proper motion prior because two points can always be connected with a straight line unlike three or more . in other words ,",
    "the prior probability of two detections being on a great circle is 100% but for three or more it is small , hence such combinations will get boosted by the alignment . having seen the convincingly large probabilities for the 3-way cases and assuming the same maximum time difference between observations , one can conclude that , for the time intervals we consider here , surveying strategies with 3 epochs are superior to those with only 2 , but adding more would not improve noticeably our ability to correctly cross - identify the detections .",
    "we presented an improved model for probabilistic cross - identification of stars , which accommodates the possibility of moving objects via a proper motion prior . using the bayesian approach of @xcite , we performed hypothesis testing with the new models on a sample of sdss dr6 stars with known proper motions and compared the results to the static case . in accord with our expectations , we found that moving stars would be missed by association algorithms that neglect to model the motion , but using an empirical prior of the proper motion would assign larger observational evidence to the match and higher probabilities .",
    "the dependence of the quality of these cross - identifications was studied as a function of separation in time ( and space ) as well as using multi - epoch observations .",
    "the sdss stripe 82 sample provided a good test set with 24 detections at different times with a few years in between .",
    "the tests were done assuming a maximum proper motion of 600 mas / yr . we found that , even though the 2-epoch data sets benefit significantly from the proper motion model , the 3-epoch observations essentially recover the right associations even for fast - moving stars , and the 4-epoch cases yield 100% probabilities . we also conclude , that the empirical prior surpasses the static model for the whole range of proper motions , while the uniform prior performs better only for the high proper - motion stars . since the analytically computable static case is still a good model for most celestial sources , it is best to carry out the cross - identification in multiple steps : first finding associations using the static model , and then applying the more computer - intensive proper motion variant only to the remainder of sources . while it might be tempting to simply increase the positional errors to discover the associations of moving sources",
    ", the procedure would be far from optimal .",
    "the overall dominant effect of such changes is that the bayes factor would drop slower with separation , and , since the angular distance is essentially divided by the uncertainty , a ten times larger @xmath6 would practically yield associations out to ten times larger distances ; most of them incidental .",
    "the improvement of our novel approach over such naive workarounds comes from using the true uncertainties and the high sensitivity of the algorithm to sources moving on a great circle as allowed by the proper motion model .",
    "the authors would like to acknowledge the use of the online tools of the besanon collaboration to obtain simulated stars for this study and thank rosemary wyse for her invaluable insights and help with stellar model of the galaxy . t.b .",
    "acknowledges support from the gordon and betty moore foundation via gbmf  554 .",
    "g.k . and i.c .",
    "acknowledge support from nkth : polanyi , kckha005 and otka - mb08a-80177 .",
    "a.c . acknowledges partial support from nsf award ast-0709394 .",
    "rapaport , m. , le campion , j .- f .",
    ", soubiran , c. , daigne , g. , pri , j .-",
    "bosq , f. , colin , j. , desbats , j .-",
    "m . , ducourant , c. , mazurier , j .-",
    "m . , montignac , g. , ralite , n. , rquime , y.,viateau , b.  2001 , a&a , 376,325"
  ],
  "abstract_text": [
    "<S> the cross - identification of sources in separate catalogs is one of the most basic tasks in observational astronomy . </S>",
    "<S> it is , however , surprisingly difficult and generally ill - defined . </S>",
    "<S> recently @xcite formulated the problem in the realm of probability theory , and laid down the statistical foundations of an extensible methodology . in this paper , we apply their bayesian approach to stars with detectable proper motion , and show how to associate their observations . </S>",
    "<S> we study models on a sample of stars in the sloan digital sky survey , which allow for an unknown proper motion per object , and demonstrate the improvements over the analytic static model . </S>",
    "<S> our models and conclusions are directly applicable to upcoming surveys such as panstarrs , the dark energy survey , sky mapper , and the lsst , whose data sets will contain hundreds of millions of stars observed multiple times over several years . </S>"
  ]
}