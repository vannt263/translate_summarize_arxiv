{
  "article_text": [
    "nondestructive measurements of atomic samples are finding an increasing number of applications , especially for metrological purposes since atoms are at the heart of many sensors @xcite such as clocks , magnetometers , gravimeters and gyrometers .",
    "nondestructive measurements show a strongly reduced heating rate compared to fluorescence or absorption probing techniques . for this reason ,",
    "they are exploited , for example , to increase the cycling rate in optical lattice clocks @xcite , thus reducing the dick effect , or to suppress the atom number fluctuations occurring in the successive preparations of cold atomic samples @xcite .",
    "nondestructive measurements preserving the coherence of the atomic sample are of particular interest in atom interferometric sensors , which rely on the wavepacket coherence .",
    "the coherence preserving feature has been demonstrated by the real - time observation of rabi oscillations @xcite and used for state tomography @xcite .",
    "moreover , when these nondestructive measurements are sensitive to the quantum fluctuations of the coherent atomic state , they prepare spin - squeezed states @xcite , and allow the operation of atomic clocks beyond the shot - noise limit @xcite .",
    "this publication is a companion article of ref .",
    "@xcite , where the real - time feedback control of a collective pseudo - spin is considered . as a proof of principle , we present how a feedback control based on a nondestructive measurement protects the state against the decoherence induced by random rotations of the collective spin .",
    "the feedback scheme is similar to the method proposed for a single qubit in ref .",
    "@xcite and later implemented experimentally with photonic qubits @xcite .",
    "it demonstrates that weak measurements monitoring the disturbance caused by the environment can protect the coherence of collective quantum systems @xcite .",
    "our work can serve as a basis for experiments on the coherent feedback control of atomic interferometers , and provides a method to estimate the potential of such feedback systems .    the article is organized as follows . in sec .",
    "[ sec : th_analysis ] , a theoretical introduction to the problem is presented . after recalling the concept of collective pseudo - spin and the related collective unitary evolutions",
    ", we introduce the decoherence process resulting from random collective rotations ( rcrs ) .",
    "more particularly , we present the specific case of a binary rcr , which constitute a practical benchmark used throughout this article to understand and characterize a feedback system on a simple situation .",
    "we then model the nondestructive measurement with a gaussian measurement operator and study the feedback controller in the weak measurement limit . to characterize the feedback efficiency ,",
    "we compare three methods based on the coherence , the entropy and the fidelity , respectively . using a monte - carlo simulation",
    ", we study the crossover between the weak and strong measurement limits , and show that the best efficiency is reached using a weak measurement , for the considered controller .",
    "finally , we analyze the feedback control of a more general kind of collective decoherence , called an analog rcr .",
    "[ sec : exp_impl ] describes the experimental implementation of the feedback scheme with cold @xmath0rb atoms and a dispersive heterodyne detection . after a brief presentation of the dipole trap and of the atomic state preparation",
    ", we explain the implementation of the rcr and the feedback controller with resonant microwave pulses .",
    "it is then shown how a nondestructive probe based on the frequency modulation spectroscopy technique can measure the pseudo - spin collective observable @xmath1 , and how it is possible to cancel the inhomogeneous light - shift of the probe @xcite and the related decoherence  a mandatory condition to implement the control scheme .",
    "we also characterize the decoherence resulting from the inhomogeneous differential light - shift induced by the trapping beam on the clock transition , and show this is not a limitation for the experiments presented here .    finally , in sec .",
    "[ sec : results ] we present the experimental results and focus on the data acquisition and analysis . first ,",
    "from the study of a binary rcr followed by a correction , we analyze the influence of the atom number and of the probe strength on the remaining coherence , using a ramsey - like measurement .",
    "the iteration of the sequence of binary rcrs and feedbacks demonstrates how the collective state can be protected over time . to conclude the experimental realization of an analog rcr",
    "is presented .",
    "in this part , we present the decoherence of a coherent spin state induced by the rcr noise model , and its successive recovery based on a nondestructive detection combined with feedback control [ fig .  [",
    "fig : coherence_bit_phase_flip ]  ( a ) ] . to quantify the correction efficiency ,",
    "different criteria are defined and compared using both analytical results obtained in the weak measurement limit , and numerical simulations . in particular , we analyze the efficiency versus the measurement backaction and show that the maximum efficiency is reached in the weak - measurement regime for all the considered criteria .",
    "prepares a coherent superposition which later undergoes a random collective rotation @xmath2 .",
    "the system is then indirectly measured using a photonic probe that evolves according to a nondestructive interaction @xmath3 .",
    "the final rotation @xmath4 , implementing the correction , is conditioned to the measurement result .",
    "( b ) reduction of the collective spin coherence by the random binary rotation of angle @xmath5 .",
    "the coherence of the statistical mixture after the noise action is the length of the projection of the collective bloch vector on the @xmath6 axis of the sphere.,width=321 ]      the system considered is an ensemble of @xmath7 spin-1/2 indistinguishable particles . from the spin operators @xmath8 related to the @xmath9th particle , the collective operators @xmath10 are built according to @xmath11 .",
    "they are spin operators since they satisfy the commutation relations @xmath12 = i \\epsilon_{ijk } j_{k}$ ] ( @xmath13 is the levi - civita tensor ) .",
    "the basis that codiagonalizes @xmath14 and @xmath1 is called the dicke basis @xmath15 : @xmath16 the collective spin operators are the generators of the unitary group of the collective state rotations . the rotations around each axis @xmath6 , @xmath17 and @xmath18 of the bloch sphere are @xmath19 , @xmath20 and @xmath21 , respectively .",
    "the state @xmath22 is the coherent spin state ( css ) pointing in the @xmath23 direction of the bloch sphere . to simplify the notations , when @xmath24 the css is written as @xmath25 .",
    "the decoherence of a css can occur in two main ways : either the pointing direction of the state is disturbed , or the state leaks out of the maximal @xmath26 css . here",
    "we present a method to correct the coherence loss caused by the first mechanism .",
    "the correction method relies on a measurement , which in turns induces a partial decoherence due to the second mechanism , and a consecutive retroaction on the spin direction .",
    "this approach is investigated both theoretically and experimentally , and we show that , for a suitable trade - off , it can improve the state coherence .      the initial state is the css @xmath27 .",
    "the state @xmath28 experiences a _ binary _ rcr that consists in a rotation of angle @xmath5 with a random direction around the @xmath17 axis of the bloch sphere .",
    "the map of this process @xmath29 is characterized by the following kraus decomposition : @xmath30    the rcr creates a statistical mixture of the states @xmath31 and @xmath32 , as depicted in fig .",
    "[ fig : coherence_bit_phase_flip ]  ( b ) .",
    "more precisely , the density operator generated by the process @xmath2 is : @xmath33 where @xmath34 and @xmath35 .",
    "we consider a situation where the sample is probed with a far off - resonance optical probe .",
    "the detection has a finite resolution @xmath36 and the evolution of the system determined by the measurement is modelled by a set of gaussian measurement operators @xmath37 of the observable @xmath1 : @xmath38 .",
    "\\label{eq : meas_op}\\ ] ] an important case is that of a shot - noise limited detection for which @xmath39 ( @xmath40 is the probe coupling strength depending on the coupling of the atoms to the optical probe and in particular on the on - resonance optical depth , and @xmath41 is the number of photons in the detection pulse @xcite ) .",
    "the values @xmath42 accessible by the measurement are not bounded between @xmath43 and @xmath44 since for a detection with low resolution the uncertainty may be arbitrary large . moreover , @xmath45 since the measurement output is a continuous parameter . in these conditions ,",
    "the measurement operator satisfies the completeness relation : @xmath46 , and the set @xmath47 is a continuous positive operator valued measurement .",
    "if the number of atoms @xmath48 in the sample is large then , by the moivre - laplace theorem ( central - limit theorem for binomial distributions ) , a css @xmath49 can be approximated with a gaussian state @xmath50,\\ ] ] and the width of this distribution is @xmath51 , that is the atomic shot - noise . when a measurement is performed on this state , the probability to obtain @xmath42 at the output is @xmath52 , \\label{eq : proba_n0_css}\\end{aligned}\\ ] ] where @xmath53 is the squeezing factor and @xmath54 characterizes the projectivity of the measurement as the square of the ratio between the width of the atomic wavefunction and the resolution of the detection .",
    "if @xmath55 the projectivity is negligible and the measurement is said to be _",
    "weak_. conversely , in the strong measurement limit ( @xmath56 ) , the measurement operator is a projector : @xmath57 . at the crossover between these two regimes ( @xmath58 ) ,",
    "the state is partially projected and a spin - squeezed state is prepared @xcite . the measurement operator eq .",
    "( [ eq : meas_op ] ) thus models a nondestructive measurement with arbitrary projectivity .",
    "we consider a simple feedback controller that corrects for the disturbance induced by a binary rcr .",
    "the sign of @xmath42 determines the hemisphere where the bloch vector lies and is then sufficient to know which rotation the system has undergone : @xmath59 if the sign is positive , else @xmath60 .",
    "once the rotation sign is determined , a rotation with same angle and opposite sign can be applied to bring the system back into the initial state @xmath28 . assuming that there is no other decoherence source from the probe pulse , this controller is modelled by the following operator sum decomposition :    @xmath61 dm \\nonumber \\\\ & & + \\frac{1}{2 } \\int_{\\mathds{r}_{+ } } \\big [    p\\left ( m| -\\alpha   \\right ) y_{+\\alpha } m_{m } y_{-\\alpha } \\rho y_{-\\alpha}^{\\dagger } m_{m}^{\\dagger } y_{+\\alpha}^{\\dagger }",
    "\\nonumber \\\\ & & \\;\\;\\;\\ ; + p\\left ( m| + \\alpha   \\right ) y_{+\\alpha } m_{m } y_{+\\alpha } \\rho y_{+\\alpha}^{\\dagger } m_{m}^{\\dagger } y_{+\\alpha}^{\\dagger } \\big ] dm , \\nonumber \\\\",
    "\\label{eq : cont_map_bin}\\end{aligned}\\ ] ]    where @xmath62 is the probability to measure @xmath63 given that the state has undergone the collective rotation @xmath64 .",
    "the success probability is defined as the probability to detect a positive rotation sign given that the state experienced a rotation @xmath59 and vice - versa . from eq .",
    "( [ eq : proba_n0_css ] ) , we find : @xmath65 .",
    "\\label{eq : p_success}\\end{aligned}\\ ] ] as we will see , this quantity is the key parameter to describe the output state and thus the behavior of the feedback system in the weak measurement limit .      in the weak measurement limit ( @xmath55 ) , the projectivity is negligible and the measurement does not modify the state ( @xmath66 ) . as a consequence , the controller map eq .",
    "( [ eq : cont_map_bin ] ) becomes : @xmath67 .",
    "\\label{eq : cont_map}\\ ] ]    therefore , if the input state is the coherent superposition @xmath68 , then eq .  ( [ eq : cont_map ] )",
    "means that either the controller took the right decision with probability @xmath69 and the output state is @xmath68 , or the decision was wrong and the output state is @xmath70 depending on the initial rotation induced by the rcr . the density matrix obtained after correction is @xmath71 , explicitly : @xmath72 .",
    "\\label{eq : rho_out}\\ ] ] this state is fully determined from the knowledge of the success probability . for a perfect measurement with @xmath73 ,",
    "the output state is @xmath74 which is the pure initial state : the feedback control thus perfectly corrects the disturbance induced by the rcr . to evaluate the controller in the case of an imperfect detection ( @xmath75 ) , we quantify its efficiency in protecting the initial state .",
    "after the analysis of the retroaction process consisting in a rcr , a measurement and a feedback correction , we quantify the efficiency of the correction in terms of three different parameters characterizing the state :    coherence : :    _ the correction shall increase the coherence_. +    the coherence is defined as the norm of the mean bloch vector    normalized to the sphere radius :    @xmath76 ,    where    @xmath77    and    @xmath78 , entropy : :    _ the correction shall reduce the entropy_. +    the von neumann entropy of a system with density operator    @xmath79 is    @xmath80 , fidelity : :    _ the correction shall increase the fidelity_. +    the fidelity is defined as the projection of the output state    @xmath81 on the input one    @xmath28 :    @xmath82 .    having several parameters to measure",
    "the efficiency is useful since , depending on the experimental context , one may be easier to estimate than another .",
    "but before raising experimental considerations , we study whether those three parameters lead to equivalent definitions of the efficiency .    from the results previously obtained in the weak measurement limit , we calculate the values for the three parameters at the different stages of the retroaction process : when the ensemble is in the initial state ( @xmath28 ) , after the rcr ( @xmath83 ) , and after the correction ( @xmath84 ) .",
    "the results are presented in tab .",
    "[ tab : evol_grand_caract ] and their derivation is detailed in app .",
    "[ app : crit_param ] .",
    ".characteristic parameters quantifying the state at the beginning ( @xmath28 ) , after the binary rcr ( @xmath83 ) and after the correction ( @xmath71 ) .",
    "these results are obtained in the limit of a weak measurement assuming that the binary rcr is the only decoherence source . [ cols=\"^,^,^,^\",options=\"header \" , ]     we already saw above that a perfect detection ( @xmath73 ) would recover a pure state .",
    "conversely , when the detection does not distinguish between the states @xmath85 and @xmath86 then @xmath87 . in that case",
    ", the coherence of the output state reduces to @xmath88 and the entropy increases to @xmath89 . as a consequence ,",
    "when the detection resolution is low the feedback action deteriorates the state instead of protecting it .",
    "we show in fig .",
    "[ fig : coh_ent_fid_vs_ps ] the evolution of the coherence , the entropy and the fidelity versus the success probability for a binary rcr with angle @xmath90 .     versus the success probability , for @xmath90 and in the limit of a large atom number ( @xmath91 ) .",
    "the dotted lines indicate the reference values for the mixed state @xmath83 generated by the rcr ( for the fidelity the dotted line is not visible since it is very close to zero if the binary rcr angle satisfies @xmath92 ) and represent the thresholds above which the correction procedure is efficient.,width=321 ]    we now compare the different efficiency measures by introducing the critical success probability @xmath93 above which the correction improves the relative parameter . for the fidelity ,",
    "the critical probability is @xmath94 ( for @xmath92 ) and the correction is always efficient ; therefore the fidelity should be used with care when dealing with a large particle number system described by a gaussian state . concerning the coherence ,",
    "the critical probability depends on the value of the rcr angle @xmath5 , more precisely for @xmath95 , @xmath96 . for @xmath97 , @xmath98 , whereas it increases to @xmath99 when @xmath100 .",
    "finally , the critical probability related to the entropy is @xmath101 ; it is thus more constraining than the coherence related one , even for @xmath100 .",
    "the comparison of the different measures in the weak measurement regime is given by the following strict inequalities : @xmath102 , therefore they are not equivalent .",
    "however , we will now see , using numerical simulations , that they present a similar behavior .      to study the feedback control of a binary rcr in an arbitrary measurement regime",
    ", we numerically simulate the feedback process using a monte - carlo analysis which generates random trajectories followed by a quantum state during the sequence rcr - measurement - correction .",
    "this allows us to verify the analytical results previously obtained in the weak measurement limit and to study the crossover between the weak and the strong measurement regime .",
    "in this simulation , the nondemolition measurement is supposed to be perfect in the sense that no decoherence ( e.g. spontaneous emission or inhomogeneous light - shift ) is induced by the probe beam .",
    "basis of the eigenstates of @xmath1 and obtained for different values of @xmath103 .",
    "the rcr angle is @xmath104 and @xmath105 .",
    "the distribution are given for each step of a monte - carlo trajectory simulation : the initial css ( black ) , after the rcr ( red , light gray left ) , after the measurement ( blue , dark gray left ) and after the correction ( green , light gray right ) .",
    "note that in the case @xmath106 , the controller took the wrong decision and the output state is a delta peak centered in @xmath107 , meaning that the collective spin is pointing towards the south pole of the bloch sphere.,width=321 ]    the simulation uses as the initial state the css @xmath108 , and applies a binary rcr to it , that is a rotation @xmath109 or @xmath59 with probability @xmath110 .",
    "the rotations of the collective spin are implemented using the wigner d - matrix @xcite . from the measurement operator eq .",
    "( [ eq : meas_op ] ) , we compute the probability density to measure @xmath42 and draw a value for @xmath42 according to this distribution . the measurement operator @xmath111 is then applied to compute the measurement backaction on the state .",
    "then , depending on the sign of @xmath42 , we apply the correction rotation .",
    "examples of distributions obtained along a trajectory for different measurement strengths are presented in fig .",
    "[ fig : distribs_simuls ] .",
    "we see that , due to the projection induced by the measurement , the distribution after the correction rotation is not gaussian for @xmath112 .",
    "the sequence , repeated several times starting with the same initial state , provides a statistical estimate of the success probability .",
    "the fidelity is obtained by projecting the final state on the initial one .",
    "the coherence is calculated from the average over all the simulated trajectories of the norm of the output bloch vector .",
    "finally , the von neumann entropy is @xmath113 with @xmath114 where @xmath115 is the number of simulated trajectories and @xmath116 is the state obtained at the end of the @xmath117th trajectory .     and @xmath90 ( black squares ) and @xmath118 ( blue triangles ) . from top to bottom",
    ": the success probability , the coherence , the entropy and the fidelity are plotted versus @xmath103 .",
    "the solid lines are the analytical results obtained in the weak measurement limit ( @xmath55).,width=321 ]    we run the simulation for a sample containing @xmath105 atoms and for different values of @xmath103 spanning from a weak to a strong measurement .",
    "the results are presented in fig .",
    "[ fig : montecarlo_n1000 ] .",
    "the analytical results obtained in the weak measurement limit ( @xmath119 ) are in good agreement with the simulations .",
    "that is not the case for the strong measurement regime where the analytical expressions are inappropriate because they do not consider the projection of the state resulting from the measurement .",
    "the simulation correctly predicts the increase of the entropy and the decrease of coherence and fidelity with the increasing measurement strength .",
    "we see that , even if the efficiency measures are not equivalent , an optimum is reached for a similar value of @xmath103 for all the three parameters .",
    "moreover , this optimum is reached for @xmath120 , that is for a weak measurement .",
    "it is useful to note that , because of the state projection , it is not possible to fully recover the target state with the chosen controller , and this even in the case of a noise resulting from unitary kraus operators and measured with a perfectly nondestructive detection .",
    "however , the recovered state can be arbitrarily close to the target state given that the on - resonance optical density of the sample is sufficiently large .    to conclude , fidelity , entropy and coherence may all be used to evaluate the efficiency of a feedback system for collective spin states .",
    "however , as shown in sec .",
    "[ sec : feed_eff_crit ] , the fidelity is not strongly discriminant to characterize feedback schemes involving csss due to their quasi - orthogonality .",
    "the coherence is the parameter adopted in the experimental part of this article , since it can be directly determined from the fringe contrast at the output of a ramsey interferometer . in the following sections , we thus consider only the coherence .      the rcr decoherence model is now generalized to a rotation not only with random direction , but also with random angle .",
    "we call such a decoherence model an _ analog _ rcr . for this model ,",
    "the choice of the correction strategy is not trivial : in the following we analyse two possible approaches and compare them considering their effect on the coherence .      as a case study",
    ", we consider a rcr angle @xmath5 uniformly distributed in @xmath121 $ ] .",
    "the continuous kraus operators related to this analog rcr are @xmath122 , for @xmath123 , generating the map : @xmath124 and satisfies the completeness relation : @xmath125 .",
    "therefore , this decoherence process transforms the initial state @xmath68 into @xmath126 , and the coherence of this statistical mixture is ( app .",
    "[ app : coh_mixt_css ] ) : @xmath127 = \\frac{1}{\\pi } \\left| \\int_{-\\pi/2}^{+\\pi/2 } e^{i \\alpha } \\ , d\\alpha \\right| = \\frac{2}{\\pi}.\\ ] ] the coherence is reduced to about 63  % because of the specific analog rcr considered .",
    "the controller is described by a map that sums over all the possible rcr angles @xmath5 and possible measurement outcomes in a sequence noise - measurement - correction : @xmath128 where @xmath129 is the measurement output normalized to the bloch sphere radius , and @xmath130 is the correction angle depending on the measurement result @xmath131 . the conditional probability to measure @xmath131 given that the state has been rotated of an angle @xmath5 around the @xmath17 axis is obtained from eq .",
    "( [ eq : proba_n0_css ] ) : @xmath132,\\ ] ] where @xmath133 . for a weak measurement we can have @xmath134 ,",
    "hence we adopt the following strategy to define the correction angle : @xmath135 where @xmath136 is the feedback gain .      in the weak measurement limit ( @xmath55 ) , @xmath137 and the measurement resolution",
    "@xmath138 is independent of @xmath5 .",
    "if the input state is the coherent superposition @xmath68 , then the output state is : @xmath139 the coherence of this state can be written as ( app .",
    "[ app : coh_mixt_css ] ) : @xmath140    we depicted fig .  [",
    "fig : coherence_analog_feedback](a ) the variation of the coherence versus the measurement resolution for different feedback gains .",
    "we see that at high resolution , a low gain does not allow a full coherence recovery .",
    "however , in a situation where the resolution is low , a reduced gain provides better performances .",
    "this reflects in fig .",
    "[ fig : coherence_analog_feedback](b ) : the optimum gain is below unity for a detection with finite resolution .",
    "it results from a compromise between the strength of the correction and the effect of the detection noise mapped onto the final state through the feedback process .",
    "for example , if @xmath141 a maximum output coherence of about @xmath142 is reached for @xmath143 .     for @xmath144 ( solid line ) , @xmath145 ( dashed line ) and @xmath146 ( dot - dashed line ) .",
    "( b ) coherence versus the feedback gain @xmath136 for @xmath147 ( solid line ) , @xmath148 ( dashed line ) and @xmath141 ( dot - dashed line ) . for both graphs ,",
    "the dotted line is the remaining coherence after the analog rcr.,width=302 ]      we consider an alternative strategy adopting a correction angle proportional to the measurement output : @xmath149 , which avoids the saturation problem for @xmath134 .",
    "moreover , it offers a simplified experimental implementation of the controller since it consists only in a proportional gain .",
    "a comparison of the two strategies is presented in fig .",
    "[ fig : comp_strat ] for @xmath150 , corresponding to the measurement resolution in sec .  [ corr_analog_rcr ] .",
    "the second strategy leads to a better result : with the first strategy a coherence of 0.975 is recovered for an optimum gain @xmath151 whereas it reaches 0.979 for @xmath152 with the second strategy .    .",
    "the dashed black line corresponds to the case where the bloch sphere curvature is compensated and the result is truncated for a measurement result @xmath134 .",
    "the solid line corresponds to a correction angle proportional to the measurement result @xmath131 .",
    "the horizontal dotted line is the remaining coherence after the analog rcr .",
    "the inset is a zoom around the optimum position.,width=264 ]    in that case , the optimum is reached for @xmath153 since @xmath154 .",
    "the angle @xmath155 for which this gain is optimized satisfies @xmath156 and since @xmath157 : @xmath158 for @xmath152 , we find @xmath159 and the gain can be experimentally adjusted by minimizing the angular spread after the correction applied to a css pointing in the direction @xmath160 .",
    "the correction method can be adapted to different kinds of rcrs .",
    "in particular , design of an optimized strategy would benefit from the prior knowledge of the angular distribution produced by a given rcr .",
    "a scheme of the experimental setup implementing the feedback control is presented in fig .",
    "[ fig : setup ] . a detailed description of the initial state preparation in the cavity enhanced dipole trap and of the nondestructive detection can be found in refs .",
    "@xcite . here",
    "we focus on the features which are specific to the feedback application , mainly the implementation of the rcr and of the controller , and how the @xmath1 observable is measured with the nondestructive probe .",
    "we also analyse the main decoherence sources : we show how the inhomogeneous light - shift from the probe can be cancelled and we quantify the decoherence induced by the dipole trap radiation .",
    "the atomic sample is trapped at the center of an optical cavity in a butterfly configuration @xcite .",
    "the cavity is injected with a radiation at 1550  nm to generate the optical trap . due to the @xmath161 transitions at 1529.3  nm ,",
    "the red detuned trapping beam induces a spatially inhomogeneous light - shift on the d@xmath162 transition used for the nondestructive probing @xcite . since a precise frequency setting of the nondestructive probe detunings",
    "is required , this light - shift is compensated by injecting the cavity , using the serrodyne modulation technique @xcite , with a radiation at 1528.7  nm blue detuned with the @xmath161 transitions .    after the loading of the atomic ensemble in the dipole trap , the intracavity power is ramped down in 130  ms from 200  w to about 10  w per cavity arm to evaporatively cool the atomic sample down to a temperature of 10  @xmath163k .",
    "the radius at @xmath164 of the trapped cloud is 50  @xmath163 m .",
    "the atoms are initially trapped in the @xmath165 hyperfine state , and a bias magnetic field of 0.5  gauss is applied in the direction parallel to the polarization of the nondestructive probe .",
    "the procedure to prepare the sample in the @xmath166 state begins with a microwave @xmath167 pulse followed by a light pulse on the @xmath168 transition to repump the residual population from the @xmath169 to the @xmath170 level ; then about one third of the atoms are in the @xmath171 state .",
    "a second @xmath167 pulse is applied to populate only the @xmath172 sublevel of the @xmath169 state .",
    "the residual atoms in the @xmath170 level are expelled from the trap using light tuned on the cycling transition @xmath173 . to increase further the purity of the sample",
    ", the whole sequence is repeated twice .",
    "we characterized the prepared state using an absorption imaging technique and we measured that the cloud contains about @xmath174 atoms and more than 99  % of them are polarized in the @xmath166 state .",
    "the pseudo - spin is realized by the two - level system with eigenstates @xmath175 and @xmath176 .",
    "a resonant microwave radiation prepares an arbitrary coherent superposition of these two states .",
    "the microwave source is composed of a 7  ghz microwave oscillator mixed with a 166  mhz rf source to obtain the 6.834  ghz signal resonant with the pseudo - spin transition . a rabi oscillations measurement is used to determine the @xmath167 pulse duration : @xmath177s .",
    "a rf switch placed on the rf signal produces the microwave pulses .",
    "moreover , a phase - shifter controls the phase of the microwave and thus the rotation axis of the bloch vector .",
    "this phase - shifter is designed to implement the qpsk ( quadrature phase - shift keying ) telecommunication protocol , allowing us to precisely set the microwave phase to the values : @xmath178 , @xmath179 , @xmath167 and @xmath180 with two control bits .",
    "the rcr is implemented using a fpga that generates the desire probability distribution from a quantum random number generator ( qrng  quantis , idquantique ) .",
    "the uniform distribution that generates the analog rcr as well as the sign of the binary rcr are provided by the qrng output .",
    "the detection pulse is demodulated and integrated to obtain its average value . the output of the integrator is then digitized and treated with a micro - controller unit ( mcu , aduc814 from analog devices ) which implements the feedback controller by computing the sign and the duration of the correction microwave pulse .",
    "the detection uses a far off - resonance optical probe @xcite which is phase - shifted depending on the atomic population .",
    "the measurement of the phase - shift is performed by the frequency modulation spectroscopy technique : an optical carrier is modulated to produce sidebands , and one sideband is placed close to an atomic transition so that it undergoes a phase - shift proportional to the population in the probed level .",
    "the amplitude of the beatnote between the sideband and the carrier , detected on a photodiode , depends on the relative phase between these two frequency components , and therefore on the population of the probed atomic level .    in our setup ( fig .",
    "[ fig : setup ] ) an extended cavity diode laser is frequency locked to an atomic reference .",
    "the beam passes through an acousto - optic modulator ( aom ) generating the probe pulses before being phase modulated with an electro - optic modulator ( eom ) feed by the local oscillator ( lo ) at 3.4213  ghz . after passing through the atomic cloud",
    ", the probe beam is detected on a fast photodiode and demodulated with the local oscillator @xcite .      with the two sidebands generated from the phase modulator it is possible to measure the collective pseudo - spin observable @xmath1 , which is the population difference between the @xmath169 and the @xmath170 hyperfine levels :",
    "one sideband is placed close to the @xmath168 transition and the other one close to the @xmath173 transition , as depicted in fig .",
    "[ fig : jz_adjustement ]  ( a ) .",
    "the coupling @xmath181 ( @xmath182 ) of the first ( second ) sideband to the @xmath168 ( @xmath173 ) transition satisfies @xmath183 where @xmath184 is the natural linewidth of the transition , @xmath185 the intensity in a single sideband , @xmath186 the saturation intensity of the transition and @xmath187 the dipolar coupling associated to the @xmath188 transition @xcite .",
    "the phase - shift induced by the atomic sample on the probe is therefore @xmath189 where @xmath190 is the population in @xmath191 . as a consequence ,",
    "if the detunings @xmath192 are adjusted so that @xmath193 then @xmath194 , and the detection measures the collective observable @xmath1 .",
    "rb d@xmath162 transition .",
    "the thick line is the carrier whereas the thin lines are the sidebands .",
    "( b ) coupling of the multi - frequency probe with an ensemble of @xmath0rb atoms versus the detuning of the carrier with respect to the @xmath168 transition .",
    "the modulation frequency is set to @xmath195  ghz .",
    "the points with bars are the experimental results and the solid line is the coupling theoretically expected where the only adjusted parameter is a scaling factor on the amplitude.,width=321 ]    to establish the detunings @xmath192 , we first set the modulation frequency to @xmath195  ghz and prepare the atoms in the coherent superposition @xmath68 so that @xmath196 .",
    "we measure then the demodulated signal versus the detuning of the carrier with respect to the @xmath168 transition . the result in fig .  [",
    "fig : jz_adjustement ]  ( b ) , in very good agreement with the theoretical expectation eq .",
    "( [ eq : coupling_sf ] ) , was obtained with a carrier power of 153  @xmath163w , a power per sideband of 7.1 @xmath163w , and the beam waist of the probe at the trap position is 200  @xmath163 m , which gives an intensity on the atomic sample of 11.2 mw/@xmath197 .",
    "since a @xmath167 transition is probed , the saturation intensity is @xmath198",
    "mw/@xmath197 @xcite .",
    "the condition @xmath199 is reached when the carrier is detuned by 3.291  ghz from the @xmath168 transition .",
    "as shown in sec .",
    "[ sec : th_feed_cont ] , the measurement strength @xmath103 strongly influences the feedback behaviour , therefore it is necessary to determine the regime in which the detection is operated .",
    "the uncertainty of the detection is obtained by performing 1000 detections of the css @xmath68 and the result is plotted in fig .",
    "[ fig : res_detection ] for a probe pulse containing @xmath200 photons per sideband .",
    "we verify that the noise is distributed according to a gaussian distribution with a standard deviation @xmath201 in unit of the bloch sphere radius .",
    "since the trapped cloud contains @xmath202 atoms after the state preparation , the noise in terms of atoms number is @xmath203 .",
    "moreover , the standard deviation of the atomic shot - noise for the css @xmath68 normalized to the bloch sphere radius is @xmath204 .",
    "the measurement strength is thus @xmath205 , as a consequence @xmath55 and the experiment is operated in the weak measurement limit .",
    "photons per sideband in a probe pulse .",
    "the points with errorbars are the experimental results obtained from 1000 measurements and the solid line is a fit with a gaussian distribution.,width=264 ]      the light - shift of the probe beam is often a severe limitation for the use of nondestructive methods in atom interferometry , since it induces a phase - shift that rotates the css around the @xmath18 axis of the bloch sphere .",
    "moreover , a spatially inhomogeneous light - shift , arising from the intensity profile of the beam , is an additional source of decoherence .",
    "the symmetry of the frequency components in the optical probe of our detection scheme allows us to cancel the light - shift , which is a major advantage of the method .",
    "based on the facts that : ( 1 ) to measure the population difference the couplings of each sideband to its probed transition are the same , and ( 2 ) each sideband is on the opposite side of the transition in comparison with the carrier position ; it is possible to compensate for the light - shift induced by each sideband with that induced by the carrier , as depicted in fig .",
    "[ fig : light_shift_probe ]  ( a ) . in fig .",
    "[ fig : light_shift_probe ]  ( b ) , we present a calculation of how much each frequency component contributes to the light - shift as a function of the sideband power .",
    "we observe that the compensation of the light - shift on @xmath169 and @xmath170 occurs for the same power ratio of about 5  % between the sideband and the carrier .",
    "moreover , since the sidebands and the carrier share the same spatial mode , the spatial compensation is perfect .",
    "m. the modulation frequency is @xmath195 ghz and the detunings are @xmath206 mhz and @xmath207 mhz .",
    "dashed lines are the light - shift induced on @xmath169 and solid lines that on @xmath170 .",
    "the curves in blue are the light - shifts of the carrier , in red that of the sidebands and in black the resulting light - shift.,width=321 ]    the experimental determination of the light - shift compensation is performed with a ramsey interferometer where a nondestructive probe pulse is sent between the two @xmath179 microwave pulses .",
    "if the light - shift is not compensated it induces a phase - shift on the collective spin ; hence it is possible to scan interference fringes by changing the power ratio between the sidebands and the carrier , as shown in fig .",
    "[ fig : light_shift_comp_sidebands ] .",
    "the observation of such ramsey fringes provides an accurate determination and thus a precise control of the light - shift . the fringe contrast is smaller than one due to both the spontaneous emission induced by the probe and the inhomogeneous light - shift .",
    "moreover , the fringes are not centered around @xmath208 due to the optical pumping from @xmath169 to @xmath170 that results from the spontaneous emission .",
    "the position of the zero phase - shift fringe , where the maximum contrast is achieved , provides the power required to cancel the light - shift .",
    "we determined that , for a phase modulation at 3.4213  ghz , the power ratio fulfilling the light - shift compensation is 4.6  % , in agreement with the calculation in fig .",
    "[ fig : light_shift_probe ]  ( b ) .",
    "s long pulse is sent in between the two @xmath179 microwave pulse of the interferometer . in the lower inset , the same measurement is performed with a 70  @xmath163s long pulse providing a more precise determination of the compensation ratio .",
    "the upper inset presents the sequence used for the measurement.,width=321 ]      according to @xcite and @xcite , the coherence evolution of a trapped spin ensemble results from two main processes : the inhomogeneous frequency shift induced by the trap profile @xmath209 , and the mean - field interaction shift @xmath210 .",
    "the dipole trap radiation at 1550  nm couples mainly to the d@xmath211 and d@xmath162 transitions , inducing a differential light - shift between the states @xmath212 and @xmath213 ( see inset fig .  [",
    "fig : contrast_vs_time ] ) .",
    "the light - shift inhomogeneity follows the gaussian beam profile , with an amplitude of @xmath214  hz at the trap center ( see app .  [",
    "sec : trap_light_shift_clock ] ) .",
    "as explained in @xcite , the characteristic inhomogeneous shift is @xmath215 , where @xmath216 and @xmath217 , with @xmath218 the trap frequency and @xmath219 the trap beam waist .",
    "thus @xmath220 , where @xmath221 is the ratio between the trap potential depth and the kinetic energy of an atom . in the experimental conditions of fig .",
    "[ fig : contrast_vs_time ] , @xmath222 and @xmath223  hz .",
    "the mean - field shift satisfies @xmath224 , where @xmath225 is the mean atomic density and @xmath226 , for a clock operated between the @xmath227 and @xmath228 states of @xmath0rb @xcite . in the present situation",
    ", we have @xmath229  @xmath230 , and @xmath231  hz . therefore @xmath232 , and the decoherence is dominated by the trap shift .",
    "the evolution of the coherence is measured from the fringe contrast at the output of a ramsey interferometer versus the trapping time @xmath233 , as shown in fig .",
    "[ fig : contrast_vs_time ] . since @xmath232 , we follow @xcite and we fit the contrast evolution with the function @xmath234^{-3/2}$ ] . we find @xmath235  hz , in reasonable agreement with the estimated value .",
    "k trapped with 10  w of optical power at 1550  nm in each cavity arm .",
    "the solid line is the fit described in the text . in the upper inset",
    "the main transitions responsible for the inhomogeneous light - shift when coupled with a 1550  nm light are depicted .",
    "the lower inset shows the experimental sequence used for the measurement.,width=321 ]    this decay time is long compared to the duration of a feedback sequence  which is mainly set by the @xmath167 pulse duration of about 150  @xmath163s . in the present case ,",
    "this decoherence source is not a limiting factor . nevertheless , in the perspective of realizing a trapped atomic clock it may be interesting to cancel it , which is feasible using a beam at 780  nm red detuned with the @xmath236 transition and blue detuned with @xmath237 @xcite or using the vectorial light - shift generated by an elliptical polarization @xcite .",
    "we now report the experimental results of the feedback control .",
    "these results expand on those published in @xcite in two main ways : first , we explore the behavior of the method versus more parameters , namely the atom number and the rcr angle ; second , we present the data analysis of the iterated noise - measurement - correction sequence and show that the independent determination of the different decoherence sources allows us to evaluate the coherence over a large dynamic range with a reduced number of experimental cycles .        here",
    "we analyze the influence of the number of probed atoms on the feedback efficiency by measuring how the success probability changes . in the weak measurement regime and for a binary rcr angle @xmath238 , the success probability [ eq .",
    "( [ eq : p_success ] ) ] must satisfy @xmath239 , \\label{eq : ps_vs_nat_exp}\\ ] ] where @xmath36 is the detection resolution .",
    "as intuition suggests , it is easier to determine the hemisphere where the spin lies when the bloch sphere radius is large , that is for a high atom number compared to @xmath36 .",
    "we verified this behavior by measuring the success probability versus the atom number in the dipole trap .",
    "the atom number is controlled by varying the loading interval for the mot , while the rest of the sequence remains unchanged to maintain constant the size and the temperature of the atomic cloud .",
    "the atom number in the trap is determined using absorption imaging .",
    "the success probability is measured from the repetition of 199 nondestructive detections of a binary rcr with angle @xmath238 . to determine the detection efficiency for a given rcr ,",
    "the decisions taken by the feedback controller are compared _ a posteriori _ with the rcr signs set by the qrng .",
    "the result is depicted in fig .",
    "[ fig : ps_vs_nat ] .",
    "the experimental data are well fitted by eq .",
    "( [ eq : ps_vs_nat_exp ] ) with @xmath240 atoms , in agreement with the result obtained in sec .",
    "[ sec : meas_strength ] .",
    "photons per sideband in each pulse , the pulse duration is 1.5  @xmath163s and the rcr angle is @xmath90 .",
    "the dots are the experimental data and the solid line is a fit with eq .",
    "( [ eq : ps_vs_nat_exp]).,width=302 ]      a compromise has to be made between the resolution of the detection , which must be high enough to detect the rcr effect , and the coherence loss due to the detection induced spontaneous emission .",
    "the trade - off is studied quantitatively by measuring the dependence of the remaining coherence after the correction from the photon number used in the detection pulse .",
    "the output coherence is estimated by adding a @xmath179 pulse after the correction pulse , which closes the ramsey interferometer opened by the initial @xmath179 pulse ( see inset in fig .  [",
    "fig : coherence_vs_np ] ) .",
    "the value of @xmath1 at the interferometer output , averaged over many realizations of the experimental cycle , is an estimate of the remaining coherence .",
    "the results obtained for a rcr angle @xmath118 are presented in fig .",
    "[ fig : coherence_vs_np ] .",
    "the experimental data are fitted with the function : @xmath241 e^{-\\gamma n_{p } } , \\label{eq : fit_vs_np}\\ ] ] where the first factor is the coherence versus the success probability [ eq .",
    "( [ eq : p_success ] ) ] for @xmath118 ( tab .",
    "[ tab : evol_grand_caract ] ) , and the exponential factor accounts for the spontaneous emission induced by @xmath41 photons .     versus the number of photons per sideband and per detection pulse .",
    "the experimental data result from the average of 50 realizations and the error bars are the @xmath242 statistical uncertainty .",
    "the solid line is a fit with eq .",
    "( [ eq : fit_vs_np ] ) and the dashed line is the remaining coherence after the rcr equal to @xmath243 .",
    "the inset shows a scheme of the experimental sequence used to determine the coherence thanks to the final @xmath179 pulse closing a ramsey interferometer.,width=321 ]    for a low photon number in the probe pulse , the success probability is @xmath87 and the remaining coherence after correction is @xmath244 , in good agreement with the experimental observation .",
    "an optimal coherence of 0.985 is recovered for @xmath245 photons : this value is higher than the coherence after the rcr ( @xmath246 ) , which proves the efficiency of the feedback controller according to the coherence criterion defined in sec .",
    "[ sec : feed_eff_crit ] .",
    "we now repeat the sequence rcr - correction to study the long - term efficiency of the feedback controller . characterizing the coherence evolution using the previous method",
    " adding an extra @xmath179 pulse to close a ramsey interferometer  would require a large number of experimental cycles , since the remaining coherence must be estimated after each iteration .",
    "however , we previously verified that the coherence reduction on one iteration results from the product of two contributions : one related to the success probability of the rcr detection , and one to the spontaneous emission induced by the probe ; the trap induced phase - shift being negligible on a single iteration ( see sec .  [",
    "sec : trap_dec ] ) .",
    "therefore , we can estimate the coherence evolution from the independent determination of each process contribution .",
    "this method significantly reduces the number of experimental cycle required for the measurement . here",
    ", we present how the data are analyzed to obtain the coherence , and we study the effect of the finite sample size on the estimation .",
    "for each experimental realization , we record both the rcr sign and that of the correction rotation set by the feedback controller : their comparison determines whether the controller took the right decision .",
    "the results of many experimental realizations [ fig .",
    "[ fig : analysis_data_seq ]  ( d ) ] is compared to those obtained in the absence of feedback [ fig .",
    "[ fig : analysis_data_seq ]  ( a ) ] : during the first 20 iterations the feedback controller mostly takes the right decision , and it converges towards a success probability of @xmath110 due to the decoherence of the sample when the number of iterations increases .",
    "it is important to note that the state can be recovered even after a wrong decision taken by the controller , therefore the feedback scheme is robust against detection and computation errors .",
    "since the applied rcrs and corrections are known , we can reconstruct the path followed by the pseudo - spin during the each sequence [ figs .",
    "[ fig : analysis_data_seq ]  ( b ) and [ fig : analysis_data_seq ]  ( e ) ] .",
    "this analysis performed over many experimental realizations provides an estimate of the state occupancy @xmath247 , which is the probability to be in the state @xmath248 after @xmath249 iterations [ figs .",
    "[ fig : analysis_data_seq ]  ( c ) and [ fig : analysis_data_seq ]  ( f ) ] .",
    "we see that without feedback the system converges quickly towards equidistributed populations , whereas when feedback is applied the occupancy of the target state dominates for several tens of iterations .",
    "the feedback control damps the spin diffusion around the bloch sphere .",
    "the state occupancy in turns allows us to estimate the density operator : @xmath250 .",
    "the coherence is finally calculated using eq .",
    "( [ eq : coh_dft ] ) , and shown in fig .",
    "[ fig : coh_vs_nit ] ( red circles and red line ) .",
    "note that the spontaneous emission lowers the success probability as the number of detections increases , as shown in fig .",
    "[ fig : analysis_data_seq ]  ( d ) , this effect is thus included in the contribution of the state occupancy to the coherence .",
    "the above evaluation of the coherence considers only the contribution resulting from the success probability .",
    "the decoherence due to the probe spontaneous emission must be added , using the decoherence rate @xmath184 ( obtained by the analysis performed in sec .  [",
    "sec : coh_vs_nb_photons ] ) and the total number of photons sent through the atomic sample . the coherence evolution , under the influence of the spontaneous emission only , is depicted in fig .",
    "[ fig : coh_vs_nit ] ( dashed blue line ) .",
    "finally , the estimated coherence ( fig .  [ fig : coh_vs_nit ] , solid black line ) is the product of the two previous contributions ( state occupancy and spontaneous emission ) .    .",
    "the dashed - dotted horizontal grey line is the expected limit on the coherence resolution due to the finite size of the statistical sample [ eq .  ( [ eq : res_coh_fin_size ] ) ] .",
    "the dashed horizontal grey line is the average of the experimental data for @xmath251 and the shaded area indicates the related standard deviation.,width=321 ]    we must also consider the contribution of the inhomogeneous differential light - shift induced by the trapping beam between @xmath212 and @xmath213 ( see sec .  [",
    "sec : trap_dec ] ) .",
    "this effect is a small correction : it reduces the coherence of about 10  % since the experiment lasts 7  ms ( see fig .  [",
    "fig : contrast_vs_time ] ) .",
    "moreover , it influences in the same way the coherence evolutions with and without feedback , therefore it does not play a role in the understanding of the feedback efficiency .    fig .  [",
    "fig : coh_vs_nit ] also displays the evolution of the coherence without feedback ( grey triangles ) estimated from the state occupancy .",
    "we see that , while the first points are following the expected exponential decay @xmath252 ( solid grey line ) , a floor is reached for a number of iterations larger than @xmath253 .",
    "this effect can be understood as a result of the finite number @xmath254 of experimental realizations , which limits the dynamic range of the coherence measurement .",
    "we now quantify this effect .",
    "the probability @xmath255 to be in the state @xmath256 $ ] is estimated with an uncertainty whose standard deviation is @xmath257 as a consequence , this uncertainty on the probability translates into an uncertainty on the estimated coherence : @xmath258 , where @xmath259 is the actual coherence and @xmath260 is the value estimated from @xmath254 samples .",
    "we consider the situation without feedback corrections , allowing us to analyze this effect on a simple and well understood scenario . as shown in app .",
    "[ app : fin_size_samp ] , the variance of the estimated coherence satisfies @xmath261 note that , since @xmath262 as @xmath263 , @xmath260 is an estimator of @xmath259 .",
    "moreover , it is also interesting to observe that @xmath264 as @xmath265 : this effect is less important when the rcr angle @xmath5 is smaller .",
    "this result is compared with the experimental data in fig .",
    "[ fig : coh_vs_nit ] , where the theoretical estimation of @xmath266 is performed with @xmath267 since at each iteration only four states are populated .",
    "following sec .  [",
    "sec : th_analog_rcr ] , we experimentally demonstrate the active stabilization against an analog rcr , detailing the result stated in ref .",
    "the sequence consists in an analog rcr uniformly distributed in @xmath268 $ ] , followed by a 1.5  @xmath163s probe pulse containing @xmath269 photons per sideband and a correction microwave pulse .",
    "the feedback controller sets both the phase sign and the duration of the correction pulse .",
    "we adopt the control strategy where the correction angle is set to be proportional to the @xmath1 measurement result , and the gain is optimized for a rcr angle of @xmath270 .",
    "this value is adopted considering the measurement resolution @xmath271  % and the analysis performed in sec .",
    "[ sec : corr_strat_2 ] .    from the measurement of the pointing direction of the css after the correction versus the direction after the rcr",
    ", we determine the probability distribution of the resulting statistical mixture , shown in fig .",
    "[ fig : analog_feed_res ] .",
    "we first measured this distribution for an analog rcr uniformly distributed in @xmath272 $ ] to verify that the right behavior of the fpga program coupled to the qnrg . in a second time , the distribution after feedback correction was measured .",
    "we see that the distribution is pointing along the @xmath6 axis , as desired .",
    "the spin spread corresponds to a remaining coherence of 0.979 .",
    "another 0.979 factor must be consider due to the spontaneous emission from the probe , resulting in a remaining coherence of 0.958 after feedback correction .",
    "plane of the bloch sphere , obtained from 5000 repetitions of the experimental sequence . in red ( light gray ) is the distribution after an analog rcr uniformly distributed in @xmath272 $ ] , and in blue ( dark gray ) is the resulting distribution after feedback correction.,width=226 ]",
    "we demonstrated , both theoretically and experimentally , that weak nondestructive measurements can be used to control in real - time the orientation of a css .",
    "we studied a benchmark scenario based on rcrs and presented its implementation with a collective atomic pseudo - spin . for this purpose",
    ", we developed a nondestructive probe , based on fm spectroscopy and using a single beam , able to directly probe the population difference on the clock transition of alkali - metal atoms without inducing any light - shift .",
    "we showed that , for an optimal trade - off between spontaneous emission and detection resolution , the feedback control recovers the coherence of the css for different kinds of rcrs ( binary and analog ) .",
    "moreover , it can protect over time a css subject to repeated rcrs .",
    "the demonstration was performed on a ensemble of trapped alkali - metal atoms .",
    "these systems are particularly interesting since trapped ultra - cold atom sensors are at the center of recent developments for long interrogation time embedded interferometers , such as microwave clocks @xcite or gyroscopes @xcite .",
    "the present method is perfectly suited for the real - time monitoring and control of atom interferometers , paving the way towards new interferometric schemes beyond the ramsey sequence , where interrogation and detection would be mixed .",
    "our feedback control scheme can be used for example to lock the atomic state near the zero phase - shift position , realizing sensors with increased dynamic range and improved stability against large perturbations . in particular",
    ", the present feedback control meets the requirements to realize an atomic phase - lock loop @xcite , where not only the frequency but also the phase of an electromagnetic wave would be locked to an atomic reference , dramatically reducing the constraints on the local oscillator phase noise .",
    "we acknowledge funding from dga , cnes , the european union ( eu ) ( isense ) , euramet ( qesocas ) , anr ( miniatom ) , and esf euroquam .",
    "lcfio and syrte are members of the institut francilien de recherche sur les atomes froids ( ifraf ) .",
    "b. acknowledges support from a chair of excellence of rgion aquitaine .",
    "e.  c. acknowledges support from quantel .",
    "in this appendix , we calculate the parameters used to quantify the feedback efficiency : coherence , von neumann entropy and fidelity .",
    "the mean bloch vector related to a css @xmath273 containing @xmath274 atoms is the vector pointing in the @xmath23 direction : @xmath275 the coherence of a css is thus @xmath276 , which proves that the coherence of the initial state @xmath277 is unitary .",
    "let @xmath278 be a set of csss , an arbitrary statistical mixture of these states is described by a density matrix of the form @xmath279 , where @xmath280 . by the linearity of the trace",
    ", we have for @xmath281 : @xmath282 therefore , the mean bloch vector related to the density operator @xmath79 is @xmath283 . as",
    "a consequence , the coherence of the mixture @xmath79 , @xmath284 , takes the explicit form : @xmath285^{1/2}. \\label{eq : coh_gen}\\end{aligned}\\ ] ] using this relation and the expressions of the density matrix @xmath83 ( eq .  ( [ eq : rho_bit_flip ] ) ) and @xmath84 ( eq .  ( [ eq : rho_out ] ) ) , it is straightforward to obtain the values of the coherence given in tab .",
    "[ tab : evol_grand_caract ] .",
    "note that in the case @xmath286 , one obtain the simple relation : @xmath287 in particular , if @xmath288 then the coherence is the modulus of the discrete fourier transform of the probability distribution @xmath289 .",
    "all these results obtained for a discrete probability distribution @xmath289 can be generalized without difficulty to a continuous distribution @xmath290 ( @xmath291 ) by the replacement @xmath292 .",
    "the fidelity with respect to an initial state @xmath293 is : @xmath294 expending the css @xmath273 in the dicke basis @xmath295 provides @xcite : @xmath296 we then obtain the overlap between two csss : @xmath297 which can be approximated with a gaussian distribution , for a large number of atoms ( @xmath298 ) : @xmath299}. \\label{eq : q_func_css}\\ ] ] finally , using eqs .",
    "( [ eq : fidelity_app ] ) and ( [ eq : q_func_css ] ) , one can evaluate the fidelity of the mixture @xmath79 .      from eq .",
    "( [ eq : q_func_css ] ) , it appears that if the rcr angle is large enough so that the angles between the csss @xmath300 in the statistical mixture are large compared to the atomic shot - noise , that is , if they satisfy : @xmath301 then the states are almost orthogonal @xmath302 , and the von neumann entropy of @xmath79 satisfies : @xmath303 in other words , since here the rcr angles are larger than the atomic shot - noise , only the pointing direction of the css matters and the von neumann entropy results to be the shannon entropy .    once again , combining this relation and the expressions of the density matrix @xmath83 [ eq .  ( [ eq : rho_bit_flip ] ) ] and",
    "@xmath84 [ eq .  ( [ eq : rho_out ] ) ] , provides the values of the von neumann entropy in tab .",
    "[ tab : evol_grand_caract ] .",
    "we estimate the differential light - shift induced by the trap radiation between the two hyperfine sub - levels of the 5@xmath304s@xmath305 state .",
    "the trapping radiation couples mainly the fundamental levels to the excited states 5@xmath304p@xmath305 and 5@xmath304p@xmath306 . the transitions and the notations used in the calculation",
    "are introduced in fig .",
    "[ fig : contrast_vs_time ] .",
    "the light - shift induced on the hyperfine state @xmath307 is @xcite : @xmath308 , \\label{eq : light_shift_diff_fund_tot}\\end{aligned}\\ ] ] where @xmath218 is the frequency of the trap radiation , @xmath309 and @xmath310 is the intensity profile of the trap beam .",
    "the hyperfine splitting between the @xmath311 and @xmath312 levels is @xmath313 , and since the following hypothesis are satisfied for @xmath314 : @xmath315 , eq .",
    "( [ eq : light_shift_diff_fund_tot ] ) can be expanded to the first order in @xmath316 .",
    "the differential shift , @xmath317 , can thus be written as @xmath318 i \\left ( \\mathbf{r } \\right),\\end{aligned}\\ ] ] where @xmath319 and @xmath320 .",
    "the wavelengths of the relevant transitions are @xmath321  nm , and the related linewidths are @xmath322  mhz , moreover the hyperfine splitting is @xmath323  ghz @xcite . therefore , the differential shift at the trap center for an optical power of 10  w per cavity arm and a waist of 100  @xmath163 m at 1550  nm is @xmath324  hz .",
    "assuming independent processes , the variance of the estimated coherence is : @xmath325 using eq .",
    "( [ eq : coh_dft ] ) relating @xmath259 to @xmath255 , we obtain : @xmath326 where @xmath288 and @xmath327 , for a rcr angle @xmath5 .",
    "we consider the coherence evolution without feedback correction : in this case the coherence drops rapidly with the number @xmath249 of iterations , since @xmath328 for @xmath329 .",
    "thus for @xmath249 sufficiently large , the estimated coherence is limited by the uncertainty in the estimation of the probabilities : @xmath330 . moreover , since no feedback is applied , the state convergences rapidly towards an uniformly distributed mixture of the states @xmath331 : @xmath332 . in these conditions , injecting eqs .",
    "( [ eq : inter_coh_fin_samp ] ) and ( [ eq : deltap_fin_samp ] ) into eq .",
    "( [ eq : var_coh_fin_samp ] ) provides eq .",
    "( [ eq : res_coh_fin_size ] ) ."
  ],
  "abstract_text": [
    "<S> we consider the decoherence of a pseudo - spin ensemble under collective random rotations , and study , both theoretically and experimentally , how a nondestructive measurement combined with real - time feedback correction can protect the state against such a decoherence process . </S>",
    "<S> we theoretically characterize the feedback efficiency with different parameters  coherence , entropy , fidelity  and show that a maximum efficiency is reached in the weak measurement regime , when the projection of the state induced by the measurement is negligible . </S>",
    "<S> this article presents in detail the experimental results published in [ phys . </S>",
    "<S> rev . lett . * 110 * , 210503 ( 2013 ) ] , where the feedback scheme stabilizes coherent spin states of trapped ultra - cold atoms , and nondestructively probed with a dispersive optical detection . </S>",
    "<S> in addition , we study the influence of several parameters , such as atom number and rotation angle , on the performance of the method . </S>",
    "<S> we analyze the various decoherence sources limiting the feedback efficiency and propose how to mitigate their effect . </S>",
    "<S> the results demonstrate the potential of the method for the real - time coherent control of atom interferometers . </S>"
  ]
}