{
  "article_text": [
    "self consistent particle tracking needs the simultaneous solution of the equation of motion for a multi particle system ( @xmath0 ) and of maxwell s equations .",
    "the effort is usually rather high , as the electro - magnetic field calcualation in time domain has to resolve the dimension of the bunch and of the surrounding geometry : a large volume has to be discretized with high resolution , and a good spatial resolution is related to a fine time step @xcite .",
    "supposed the particle energy is high enough for ultra - relativistic approximations , the motion is approximately uniform and the betatron wavelength is large compared to geometric dimensions as cavities , magnets and wake generating discontinuities . then the electromagnetic problem can be split into independent sub - problems : external fields , wake field interactions and simplified self - interactions .",
    "the separation of external fields is possible without these conditions , but the wake field approach is based on an idealised setup as sketched in fig .",
    "[ wake_geometry ] : a discontinuity , either of geometry or of material properties or of both , is enclosed by semi - infinite beam pipes .",
    "several generations of wake field codes have been developed to solve this problem @xcite .",
    "the model of simplified self interactions calculates so called `` space charge forces '' for a particle distribution in uniform motion , using a lorentz transformation and solving an electrostatic field @xcite .",
    "this report is about the application of wake fields in a tracking program .",
    "the effect of a distributed wakefield generating structure is replaced by a discrete kick at a discrete time , calculated from a wake function that is determined with help of a wake field code .",
    "the wake function has to be described by a flexible format .",
    "we propose a hybrid formulation : the dependency on the longitudinal coordinate @xmath1 ( between source and observer particle ) is tabulated and the transverse dependency ( offset of source and observer particle ) is taylor expanded .",
    "therefore the wake function is stored in a table of taylor coefficents .",
    "the point to point interaction between all particles is calculated by a convolution method",
    ". therefore the line charge density and generalized line charge densities ( the first and second transverse moments ) are calculated on a grid by a binning and smoothing technique .",
    "our method is implemented in the space charge code astra @xcite . as an example we calculate the emittance growth of a bunch in an undulator beam pipe due to resitive wall wake field effects . in this example",
    "the wake per length in a 30 m beam pipe is modeled by about 60 diskrete kicks .",
    "the example considers a real focussing lattice , collective and individual transverse motion and simultaneously longitudinal and transverse effects ( which can not be separeted from each other ) .",
    "the particles are tracked in global cartesian coordinates with @xmath2 , the components of location and momentum , while wake fields are calculation in a local coodinate system with @xmath3 components .",
    "the coordinates of both systems are related by : @xmath4 with @xmath5 the particle index , @xmath6 the vector to the origin of the wake geometry , @xmath7 the unity vector into nominal direction of particle motion and @xmath8 , @xmath9 the orthonormal transverse vectors .",
    "the discrete wake induced kicks are added to the particle momenta when the center of mass of the distribution passes the plane @xmath10 .",
    "the setup is skeched in fig .",
    "[ wake_geometry ] .    for simplicity we set @xmath11 for the following .",
    "a source particle with charge @xmath12 on the trajectory @xmath13 is followed by a observer particle with charge @xmath14 and trajectory @xmath15 .",
    "the source particle causes the electromagentic field @xmath16 , @xmath17 .",
    "the total change of momentum of the observer particle is @xmath18 for the definition of the wake function we follow @xcite with @xmath19 the wake function is causal in the @xmath1 coordinate , the transverse and longitudinal components are related by the panofsky - wenzel - theorem @xmath20 and the longitudinal component is a harmonic function of transverse coordinates @xmath21 for the following we use scalar component functions @xmath22 the implementation of wake fields in astra is based on a second order taylor expansion of the longitudinal wake in the transverse coordinates @xmath23^t                    \\left [ \\begin{array}{ccccc } h_{00}(s ) & h_{01}(s ) & h_{02}(s ) & h_{03}(s ) & h_{04}(s )   \\\\                                                0          & h_{11}(s ) & h_{12}(s ) & h_{13}(s ) & h_{14}(s )   \\\\                                                0          & h_{12}(s ) & h_{22}(s ) & h_{23}(s ) & h_{24}(s )   \\\\                                                0          & h_{13}(s ) & h_{23}(s ) & h_{33}(s ) & h_{34}(s )   \\\\                                                0          & h_{14}(s ) & h_{24}(s ) & h_{34}(s ) & -h_{33}(s )                             \\end{array } \\right ]                    \\left [ \\begin{array}{c } 1 \\\\ u_s \\\\ v_s \\\\ u_o \\\\",
    "v_o \\end{array } \\right ]      .\\ ] ] this approach fulfilles eq .",
    "( [ longitudinal_harmonic ] ) .",
    "the transverse components are uniquely related to the longitudinale wake by causality and panofsky - wenzel - theorem : @xmath24 with the integrated coefficient functions @xmath25 special cases for geometries with symmetry of revolution are the monopole and dipole wake .",
    "the monopole wake @xmath26 is purely longitudinal and independent on offset parameters .",
    "the transverse part of the dipole wake depends linear on the offset of the source particle . due to symmetry the coefficient functions @xmath27 and @xmath28 are identical . therefore the dipole wake functions is @xmath29",
    "for an arbitrary distribution of source particles with charges @xmath30 , total charge @xmath31 and trajectories @xmath32 , the change of momentum of the observer particle is @xmath33 the wake potential @xmath34 characterises the shape dependent wake kick .",
    "it can be computed with electromagnetic field calculation programs as @xcite for continuous gaussian source distributions .",
    "usually the wake function is extrapolated from wake potential computations for small source distributions .",
    "the particle summation in eq .",
    "( [ delta_p_particle_sum ] ) is replaced by a volume integration @xmath35 with @xmath36 the charge density .",
    "formally this can be expressed with a taylor expansion of the wake function as @xmath37 changing the order of summation and integration @xmath38 can be written as sum of one dimensional convolution integrals @xmath39 with scalar functions @xmath40 and @xmath41 described in tab .",
    "[ w - expansion ] .",
    "@xmath42 is the line charge density . in the following we call @xmath43 generalized line charge densities",
    "for the numerical kick calculations three problems have to be solved : the calculation of generalized one dimensional density functions @xmath44 , the representation of coefficient functions @xmath45 and the convolution of these functions .",
    "a _ continuization _ based on a binning and smoothing technique is used to convert the particle set with longitudinal positions @xmath46 and discrete generalized charges @xmath47 to continuous generalized line charge densities @xmath44 .",
    "conventional binning distributes the particle charges to @xmath48 equi - spaced bins ranging over the whole bunch length .",
    "the disadvantages are a spacial resolution independent on particle density , and the bin boundaries are determined by extreme particles ( first and last particle ) . to achive more flexibility , we use bins that fulfill requirements for the length per bin as well as for the charge per bin , and we utilize a multiple binning with @xmath49 different conditions for the first and last bin .    therefore the bunch is split into @xmath50 sub - bins . all inner bins",
    "are composed by @xmath49 consecutive sub - bins , the outer bins may combine less sub - bins , as sketched in fig .",
    "[ binning ] . by doing this ,",
    "@xmath49 different binnings are generated .",
    "the sub - binning is controlled by the linear combination @xmath51 of two auxiliary functions @xmath52 and @xmath53 .",
    "these functions increase along the bunch monotonously from zero to one .",
    "function @xmath52 is proportional to length while @xmath53 increases with the integrated bunch charge .",
    "the boundaries @xmath54 of the sub - bins are the solutions of @xmath55 .",
    "setting @xmath56 to one causes equi - spaced sub - bins , zero leads to equi - charged sub - bins and a middle value generates a mixture of both conditions .",
    "the same bins and sub - bins are used for all generalized charges .",
    "result of the binning procedure are @xmath57 different bins , each characterized by the bin center @xmath58 , the bin width @xmath59 and the bin weights ( the sums of generalized charges ) @xmath60    the smoothing procedure replaces all bins by continuous functions with certain centers , widths and weights and samples the sum of these functions on an equidistant grid : @xmath61 the astra implementation uses rectangular , triangular and gaussian smoothing functions : @xmath62 with @xmath63 , a control parameter .",
    "the grid density is determined by the smallest bin width .",
    "each coefficient function @xmath64 is described by coefficients @xmath65 and limited auxiliary functions @xmath66 , @xmath67 . for the following",
    "we skip the index .",
    "the representation is @xmath68       \\ : \\ : ,       \\label{repres_coef}\\ ] ] with @xmath69 the dirac function , @xmath70 the step function and @xmath71 if @xmath72 .",
    "the term with @xmath73 is skipped for @xmath74 .",
    "the representation is not unique , but very flexible : every coeffcient @xmath75 might vanish and the auxiliary functions migth be identical to zero .",
    "the auxiliary functions are polygons as sketched in fig .",
    "[ aux_function ] .",
    "the table description of auxiliary function @xmath64 is listed in tab .",
    "[ table_aux_function ] .",
    "the entry `` @xmath76 '' describes the subscript of the auxiliary function . for a complete wake field representation",
    "all sub - tables of non vanishing coefficient functions are stacked to one table @xmath77 ,                                       \\mbox{table1 } , \\mbox{table2 } \\ldots \\right )       \\ : \\ : , \\ ] ] with @xmath78 the number of sub - tables .",
    "the order of sub - tables is arbitrary , vanishing coefficients need no representation .      according to eqs .",
    "( [ sum_of_convol],[gen_charge_dens ] ) we need convolution integrals of generalized charges with coefficient functions and integrated coefficient functions : @xmath79 for simplicity we skipped all lower indices . using the representation eq .",
    "( [ repres_coef ] ) and auxiliary functions @xmath80 the convolutions can be rewitten as @xmath81 the integrals are solved piecewise for the generalized charged densities eq .",
    "( [ smooth_gen_line_charge_2 ] ) and polygonal coeffcient functions .",
    "the example of particle motion in an undulator vacuum chamber with resisitve wall wake fields is based on parameters used in @xcite , see tab .  [ schlarb_table ] . for the calculation with astra , a round stainless steel beam pipe with radius @xmath82 mm",
    "is used to cause significant transverse effects .",
    "the undulator chamber of the real facility ( flash ) is made from aluminium .",
    "for the numerical simulation 63 quadrupoles of the fodo lattice are considered and the resistive wall wake of the 30 m beam pipe is simulated by 62 discrete wake kicks ( each for @xmath83 ) applied in the middle of the drifts between the quadrupoles .",
    "the longitudinal wake per length of a round resistive beam pipe is approximated by @xmath84 with @xmath85 @xmath86 the permeability , @xmath87 the permittivity of vaccum and @xmath88 the frequency dependent conductivity of the pipe @xcite .",
    "therefore only three coefficient functions @xmath89 have to be calcualted that are all proportional to @xmath90 , the longitudinal resistive wall wake per length . in the wake table the coefficients @xmath91 , @xmath92 , @xmath93 und @xmath94",
    "are set to zero ( for @xmath95 , @xmath96 and @xmath97 ) , only the auxiliary functions @xmath98 , @xmath99 and @xmath100 are used . in figs .",
    "[ fig4 ] the emittance growth due to dipole wake forces is shown along the undulator and compared with the analytic estimation from @xcite .",
    "the numerical result agrees well with the estimation , but the dipole model is incomplete . fig .",
    "[ fig5 ] shows the emittance growth due to monopole and dipole wake fields .",
    "the longitudinal wake causes an energy spread of abaut 2.4 mev after 30 meters . for off axis particles with that energy spread ,",
    "the quadrupole focussing is significantly altered and the transverse emittance is further increased .",
    "we thank torsten limberg , rainer wanzenberg and igor zagorodnov for useful discussions and comments on this work .",
    "s.  schnepp , e.  gjonaj , t.  weiland : on the development of a self - consistent particle - in - cell ( pic ) code using a time - adaptive mesh technique .",
    "proceedings of the 10th european particle accelerator conference ( epac 2006 ) ( epac 2006 ) , june 01.07.2006 , pp .",
    "2182 - 2184 t.  weiland : comment on wakefield computation in the time domain ( tbci ) .",
    "nim - a 216 , pp .",
    "31 - 34 , 1983 .",
    "mafia collaboration , mafia manual , cst gmbh , darmstadt , 1997 .",
    "i.  zagorodnov : indirect methods for wake potential integration .",
    "phys . rev .",
    "beams 9 , 2006 .",
    "h.  henke and w.  bruns , in proceedings of epac 2006 , edinburgh , scotland ( wepch110 , 2006 ) .",
    "e.  gjonaj , t.  lau , t.  weiland : computation of short range wake fields with pbci .",
    "icfa beam dynamics newsletter ( icfa 2008 ) , april 01.04.2008 , pp . 38 - 52 t.  weiland , r.  wanzenberg : wake fields and impedances , desy m-91 - 06 .",
    "young : `` parmela '' los alamos national laboratory report la - ur-96 - 1835 ( revised april 22 , 2003 )",
    ". k.  flttman , `` astra '' , desy , hamburg , |www.desy.de/  mpyflo| , 2000 .",
    "s.  van der geer , o.  luiten , m.  de loos , g.  pplau , u. van rienen : 3d space - charge model for gpt simulations of high brightness electron bunches , institute of physics conference series , no .",
    "175 , ( 2005 ) , p. 101 .",
    "h.  schlarb , resistive wall wake fields , diploma thesis 1997",
    ". k.  bane : the short - range resistive wall wakefields .",
    "slac - pub-95 - 7074 , dec ."
  ],
  "abstract_text": [
    "<S> tracking calculations of charged particles in electromagnetic fields require in principle the simultaneous solution of the equation of motion and of maxwell s equations . </S>",
    "<S> in many tracking codes a simpler and more efficient approach is used : external fields like that of the accelerating structures are provided as field maps , generated in separate computations and for the calculation of self fields the model of a particle bunch in uniform motion is used . </S>",
    "<S> we describe how an externally computed wake function can be approximated by a table of taylor coefficients and how the wake field kick can be calculated for the particle distribution in a tracking calculation . </S>",
    "<S> the integrated kick , representing the effect of a distributed structure , is applied at a discrete time . as an example </S>",
    "<S> , we use our approach to calculate the emittance growth of a bunch in an undulator beam pipe due to resitive wall wake field effects . </S>"
  ]
}