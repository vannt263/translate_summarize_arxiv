{
  "article_text": [
    "the ever increasing precision of pulsar timing studies , combined , in particular , with the exceptional rotational stability of millisecond pulsars ( msps ) has resulted in a powerful tool for the pursuit of a wide range of scientific goals .",
    "for example , in recent years pulsar timing has been used to find extrasolar planets @xcite , to study matter at super - nuclear densities in the interior of neutron stars @xcite , and the double pulsar system psr j0737 - 3039a / b , provides precise measurements of several ` post keplerian ' parameters allowing for stringent tests of general relativity @xcite .    for a detailed review of pulsar timing",
    "refer to e.g. @xcite . in brief ,",
    "the arrival times of pulses ( toas ) for a particular pulsar will be recorded by an observatory in a series of discrete observations over a period of time .",
    "these arrival times must all be transformed into a common frame of reference , the solar system barycenter , in order to correct for the motion of the earth .    a model for the pulsar",
    "can then be fit to the toas that characterises the properties of the pulsar s orbital motion , as well as its timing properties such as its orbital frequency and spin down .",
    "this is most commonly carried out using the tempo , and more recently , tempo2 pulsar - timing packages @xcite .",
    "tempo2 uses an initial guess to the timing model to generate a set of pre - fit residuals . a fisher - matrix approximation to the timing model parameters",
    "is then calculated and a linear least - squares method is utilised to improve the fit . if desired , multiple iterations can be performed such that the best - fit values for the timing model from the previous iteration are used as the starting guess for the next , until convergence is reached .    when performing this fitting process , tempo2 considers the toas to be solely the sum of a deterministic signal due to the timing model , and a white noise component described completely by the toa uncertainties . in realistic datasets",
    "however this assumption is rarely true . if additional stochastic processes such as intrinsic red spin noise due to rotational irregularities in the neutron star @xcite or correlated noise due to a stochastic gravitational wave background ( gwb ) generated by , for example , coalescing black holes ( e.g. @xcite ) are present in the data then power from these contributions will be absorbed by the timing model , affecting the accuracy of the parameter estimation .",
    "recently , @xcite ( henceforth c11 ) proposed a method of improving the timing model fit by using the cholesky - decomposition of the covariance matrix describing the properties of these additional stochastic processes in the toas , calculated from the power spectral density of the timing residuals .",
    "this can be used to whiten the residuals , after which parameter estimation is performed in these transformed observations using ordinary least squares .    in @xcite ( henceforth vhl2013 ) , however , it is shown that after fitting for the timing model the resulting residuals are not time stationary , and as such the power spectral density of those residuals is not a well defined mathematical quantity .",
    "in addition because the method in c11 does not account for the covariance between the timing model and the stochastic processes , the uncertainties associated with the parameter estimates , in particular those associated with the quadratic spin down , are not optimal .",
    "the preferred approach is therefore to perform a joint analysis of the deterministic timing model and any additional stochastic components present as in vhl2013 .",
    "however , when performing a bayesian analysis using the linearised timing model as presented in vhl2013 it is not possible to perform model selection between different sets of timing model parameters using the evidence .",
    "this is because the maximum likelihood value at which the linearisation is performed will depend upon the exact set of model parameters included , and as such , both the data and the model will vary as the parameter space changes .",
    "it is also not clear how the estimation of the uncertainties of the timing model parameters depends on the linearisation process , especially in the regime where the signal to noise ratio might be low , and the fisher - matrix approximation will be poor .",
    "in this paper we present a solution to these problems in the form of temponest .",
    "temponest provides a means of performing a simultaneous analysis of either the linear or non - linear timing model and additional stochastic parameters using the bayesian inference tool multinest ( @xcite ) to efficiently explore this joint parameter space , whilst using tempo2 as an established means of evaluating the timing model at each point in that space .",
    "temponest allows for robust model selection between different sets of timing model or noise parameters , and requires only basic prior knowledge of the timing model",
    ".    in section [ section : bayes ] we will describe the basic principles of our bayesian approach to data analysis , giving a brief overview of how it may be used to perform model selection , and introduce multinest . in section [ section : models ] we will describe the stochastic models currently available for use in temponest to include with the timing model , including the white noise modifiers efac and equad , along with descriptions of both red spin noise and dispersion measure variations .    we will then perform a series of tests using temponest designed to show some of the included functionality . in section [ section : sims ] we use simulated data to compare the non - linear and linear approximation to the timing model across different noise regimes designed to represent both future and current datasets , whilst in section [ section : realdata ] we apply temponest to two sets of publicly available data , firstly of the binary pulsar b1855 + 09 and then the isolated pulsar b1937 + 21 .",
    "we show how temponest can be used to perform bayesian model selection between different sets of timing model and stochastic parameters , and for the latter case , also compare the parameters estimates and uncertainties for the timing solutions produced by temponest , tempo2 , and the spectralmodel plug - in for tempo2 that uses the principles described in c11 .",
    "we note that the aim of this paper is not to provide a user manual for temponest , but rather give an overview of its functionality .",
    "a development build of temponest is currently available online , with a full public release planned in the near future .",
    "this research is the result of the common effort to directly detect gravitational waves using pulsar timing , known as the european pulsar timing array ( epta ) @xcite .",
    "our method for performing pulsar timing analysis is built upon the principles of bayesian inference , which provides a consistent approach to the estimation of a set of parameters @xmath0 in a model or hypothesis @xmath1 given the data , @xmath2 .",
    "bayes theorem states that :    @xmath3    where @xmath4 is the posterior probability distribution of the parameters , @xmath5 is the likelihood , @xmath6 is the prior probability distribution , and @xmath7 is the bayesian evidence .    in parameter estimation , the normalizing evidence factor",
    "is usually ignored , since it is independent of the parameters @xmath0 .",
    "inferences are therefore obtained by taking samples from the ( unnormalised ) posterior using , for example , standard markov chain monte carlo ( mcmc ) sampling methods .",
    "in contrast to parameter estimation , for model selection the evidence takes the central role and is simply the factor required to normalize the posterior over @xmath0 :    @xmath8    where @xmath9 is the dimensionality of the parameter space .    as the average of the likelihood over the prior ,",
    "the evidence is larger for a model if more of its parameter space is likely and smaller for a model where large areas of its parameter space have low likelihood values , even if the likelihood function is very highly peaked .",
    "thus , the evidence automatically implements occam s razor : a simpler theory with a compact parameter space will have a larger evidence than a more complicated one , unless the latter is significantly better at explaining the data .    the question of model selection between two models @xmath10 and @xmath11",
    "can then be decided by comparing their respective posterior probabilities , given the observed data set @xmath2 , via the model selection ratio @xmath12 :    @xmath13    where @xmath14 is the a priori probability ratio for the two models , which can often be set to unity but occasionally requires further consideration .",
    "evaluation of the multidimensional integral in eq .",
    "[ eq : evidence ] is a challenging numerical task .",
    "standard techniques like thermodynamic integration @xcite are extremely computationally expensive , which makes evidence evaluation at least an order - of - magnitude more costly than parameter estimation .",
    "some fast approximate methods have been used for evidence evaluation , such as treating the posterior as a multivariate gaussian centered at its peak ( see e.g. @xcite ) , but this approximation is clearly a poor one for multimodal posteriors ( except perhaps if one performs a separate gaussian approximation at each mode ) . the savage - dickey density ratio has also been proposed ( see e.g. @xcite ) as an exact , and potentially faster , means of evaluating evidences , but is restricted to the special case of nested hypotheses and a separable prior on the model parameters .    the nested sampling approach @xcite is a monte - carlo method targeted at the efficient calculation of the evidence , but also produces posterior inferences as a by - product .",
    "nested sampling considers the prior volume @xmath15 where the likelihood is greater than some value @xmath16 , which can be written as :    @xmath17    this allows us to rewrite eq .",
    "[ eq : evidence ] as a one - dimensional integral over @xmath16 : @xmath18 when the inverse of @xmath19 , the likelihood value that corresponds to a given prior volume , @xmath20 , exists this integral can then be written : @xmath21 and so the evidence can be calculated as the weighted sum of a set of @xmath22 values of @xmath15 : @xmath23 where the weights @xmath24 are simply given by the trapezium rule @xmath25 .      in @xcite and @xcite this nested sampling framework was built upon with the introduction of the multinest algorithm , which provides an efficient means of sampling from posteriors that may contain multiple modes and/or large ( curving ) degeneracies , and also calculates the evidence . since",
    "its release multinest has been used successfully in a wide range of astrophysical problems , from detecting the sunyaev - zeldovich effect in galaxy clusters @xcite , to inferring the properties of a potential stochastic gravitational wave background in pulsar timing array data @xcite ( henceforth l13 ) .    in brief ,",
    "the multinest algorithm operates by first drawing a set of @xmath26 points from the prior @xmath27 .",
    "an ellipsoidal decomposition is then performed such that the full set of live points is contained within a set of ellipsoids . at each subsequent iteration @xmath28 a point",
    "is drawn with likelihood @xmath29 from the union of these ellipsoids and is checked to see if it satisfies the constraint @xmath30 where @xmath31 is the lowest likelihood value present in the set of live points at that iteration .",
    "if this constraint is satisfied the point replaces the lowest likelihood point in the live set with a probability @xmath32 where @xmath33 is the number of ellipsoids in which the new point lies .    in high dimensions",
    "most of the volume in the ellipsoids lies in their outer shells , thus when the decomposition extends beyond the true iso - likelihood surface , the acceptance rate of new points can decrease significantly . in order to maintain high sampling efficiency in high dimensions multinest",
    "therefore contains a ` constant efficiency ' mode . here",
    "the total volume enclosed by the ellipsoids is adjusted such that the sampling efficiency meets some user set target .",
    "however whilst this mode is adequate for parameter estimation , the evidence values are not reliable .",
    "recently , however , the multinest algorithm has been updated to include the concept of importance nested sampling @xcite ( ins ) which provides a solution to this problem .",
    "full details can be found in @xcite , but the key difference is that , where with normal nested sampling the rejected points play no further role in the sampling process , ins uses every point sampled to contribute towards the evidence calculation .",
    "one outcome of this approach is that even when running in constant efficiency mode the evidence calculated is reliable even in higher ( @xmath34 50 ) dimensional problems .    in pulsar timing analysis",
    "we will often have to deal with timing models that can contain @xmath35 parameters , which , when combined with the properties of the stochastic component of the signal can result in a total dimensionality of 50 - 60 .",
    "as such , the ability to run in constant efficiency mode whilst still obtaining accurate values for the evidence when these higher dimensional problems arise is crucial in order to perform reliable model selection .",
    "for any pulsar we can write the toas for the pulses as a sum of both a deterministic and a stochastic component :    @xmath36    where @xmath37 represents the @xmath9 toas for a single pulsar , with @xmath38 and @xmath39 the deterministic and stochastic contributions to the total respectively , where any contributions to the latter will be modelled as random gaussian processes . writing the deterministic signal due to the timing model as @xmath40 , and the uncertainty associated with a particular toa @xmath28 as @xmath41 we can write the likelihood that the data is described solely by the timing model as :    @xmath42    this represents the simplest model choice possible in temponest , including only those free parameters present in the tempo2 fit .",
    "from here we can now begin to make our model for the stochastic contribution to the signal more realistic by introducing additional parameters to describe the white and red noise components , in order to compare the evidence with this simpler model and determine the optimal set of parameters supported by the data .",
    "when dealing with pulsar timing data , the properties of the white noise can be separated into two components :    1 : : :    for a given pulsar , each toa has an associated error bar , the size of    which will vary across a set of observations .",
    "we can introduce an    extra free parameter , denoted efac , to account for possible    mis - calibration of this radiometer noise @xcite .",
    "the efac parameter    therefore acts as a multiplier for all the toa error bars for a given    pulsar , observed with a particular system .",
    "temponest allows for either    a single efac parameter to be estimated for all toas for a given    pulsar , or , where the observing system has been flagged for each toa ,    a separate efac can be included for each system .",
    "+ 2 : : :    a second white noise component is also used to represent some    additional source of time independent noise , which we call equad . in    principal this parameter represents something physical about the    pulsar , the high frequency tail of the pulsar s red spin noise power    spectrum , or , ` jitter ' @xcite , and so should be independent of the    observing system .",
    "differences in the integration times between toas    for different observing epochs can muddy this physical interpretation    however , and as such as with efac , either a single equad parameter can    be estimated for all toas for a given pulsar , or for each flagged    system separately .    we can therefore rewrite the error @xmath41 associated with each toa @xmath28 as @xmath43 so that : @xmath44 where @xmath45 and @xmath46 represent the efac and equad parameters applied to toa @xmath28 respectively .",
    "note this is not how tempo2 defines the relationship between the equad and efac parameters .",
    "[ eq : tempolike ] can be trivially rewritten to include the new white noise parameters as :    @xmath47      temponest currently supports two methods for describing the intrinsic red noise properties of the pulsar , the recently introduced model independent frequency domain method described in l13 and the power law model , time domain method described in @xcite ( henceforth vh2009 ) .",
    "we begin by writing the red noise component of the stochastic signal , which we will denote @xmath48 , in terms of its fourier coefficients @xmath49 so that @xmath50 where @xmath51 denotes the fourier transform such that for frequency @xmath52 and time @xmath53 we will have both :    @xmath54    and an equivalent cosine term . here",
    "@xmath55 represents the total observing span for the pulsar , and @xmath52 the frequency of the signal to be sampled . defining the number of coefficients to be sampled by @xmath56 , temponest",
    "will then include the set of frequencies with values @xmath57 , where @xmath9 extends from 1 to @xmath56 . for typical pta data @xcite",
    "show that a low frequency cut off of 1/t is sufficient to accurately describe the expected long term variations present in the data . if necessary though it is also possible to specify arbitrary sets of frequencies such that terms with  < < 1/t can be included in the model , or to allow noise terms where the frequency itself is a free parameter .    for a single pulsar the covariance matrix @xmath58 of the fourier coefficients @xmath49 will be diagonal , with components    @xmath59    where there is no sum over @xmath28 , and the set of coefficients @xmath60 represent the theoretical power spectrum for the residuals .",
    "as discussed in l13 , whilst eq [ eq : bprior ] states that the fourier modes are orthogonal to one another , this does not mean that we assume they are orthogonal in the time domain where they are sampled , and it can be shown that this non - orthogonality is accounted for within the likelihood . instead , in bayesian terms",
    ", eq . [ eq : bprior ] represents our prior knowledge of the power spectrum coefficients within the data .",
    "we are therefore stating that , whilst we do not know the form the power spectrum will take , we know that the underlying fourier modes are still orthogonal by definition , regardless of how they are sampled in the time domain .",
    "it is here then that , should one wish to fit a specific model to the power spectrum coefficients at the point of sampling , such as a broken , or single power law , the set of coefficients @xmath60 should be given by some function @xmath61 , where we sample from the parameters @xmath0 from which the power spectrum coefficients @xmath60 can then be derived .",
    "we can then write the joint probability density of the timing model , white noise parameters , power spectrum coefficients and the signal realisation , pr@xmath62 , as :    @xmath63    for our choice of @xmath64 we use an uninformative prior that is uniform in @xmath65 space , and draw our samples from the parameter @xmath66 instead of @xmath67 which has the added advantage that we avoid unnecessary rejections due to samples that have negative coefficients in the sampling process .",
    "given this choice of prior the conditional distributions that make up eq . [ eq : prob ] can be written :    @xmath68 \\nonumber\\end{aligned}\\ ] ]    where @xmath69 and represents the white noise errors in the residuals and :    @xmath70.\\ ] ]    in temponest we then marginalise over all fourier coefficients @xmath49 analytically in order to find the posterior for the remaining parameters alone .",
    "when performing this marginalisation we use a uniform prior for the fourier coefficients , so that , denoting @xmath71 as @xmath72 , @xmath73 as @xmath74 and @xmath75 as @xmath76 our marginalised posterior is given by :    @xmath77 . \\nonumber\\end{aligned}\\ ] ]      here we begin by parameterising the red noise process using a power law spectral density of the form :    @xmath78    where @xmath79 is the spectral density at frequency @xmath80 , @xmath81 is the amplitude of the red noise process and @xmath82 is the spectral index .",
    "we write the time domain covariance matrix @xmath83 between observations @xmath28 and @xmath84 as given in vh2009 :    @xmath85    where @xmath86 is a low frequency cut off and @xmath87 with @xmath88 the @xmath28th toa . in @xcite",
    "it is shown that the quadratic spin down acts to absorb any contribution to the signal that arises from the choice of this low frequency cut off , and as such it is only necessary to choose @xmath86 so that @xmath89 is much greater than the observing time span in order to obtain rapid convergence of the expression .",
    "the result of this however , is that the level of uncertainty in the spin down parameters will be affected to a much greater extent than any others by the presence of low frequency stochastic processes in the data , a fact that we will return to in section [ section:1937 ] . finally denoting the white noise covariance matrix @xmath90 as before we can write the total covariance matrix describing our simulated residuals @xmath91 as :    @xmath92    we can then write our likelihood as :    @xmath93      the plasma located in the interstellar medium ( ism ) , as well as in solar winds and the ionosphere can result in delays in the propagation of the pulse signal between the pulsar and the observatory , an effect that appears as a red noise signal in the timing residuals .    unlike other red noise signals however , the severity of the observed dispersion measure variations is dependant upon the observing frequency , and as such we can use this additional information to isolate the component of the red noise that results from this effect .    in particular ,",
    "the group delay @xmath94 for a frequency @xmath52 is given by the relation :    @xmath95    where the dispersion constant @xmath96 is given by :    @xmath97    and the dispersion measure is defined as the integral of the electron density @xmath33 from the earth to the pulsar :    @xmath98    dispersion measure corrections can be included in the analysis as an additional set of stochastic parameters with only minor modifications to the equations [ eq : margin ] and [ eq : rlike ] allowing as before , using either a power law model or the model independent description . in both cases",
    "we begin by first defining a vector @xmath99 of length equal to the number of observations for a given pulsar as :    @xmath100    for observation @xmath28 with observing frequency @xmath101 .      for the model independent approach",
    "we then need to make a change to our basis vectors such that our dispersion measure fourier modes are described by :    @xmath102    and an equivalent cosine term , where @xmath55 is the length of the observing timespan , and @xmath103 now explicitly denotes the frequency of the signal to be parameterised as before , where the set of frequencies to be included is defined in the same way as for the red spin noise .",
    "unlike when modelling the red spin noise , we no longer have the quadratic in the timing model to act as a proxy to the low frequency ( @xmath104 ) dm variations in our data . as such these terms",
    "must be accounted for either by explicitly including these low frequencies in the model , or by including a quadratic in dm to act as a proxy , as with the red noise , defined as :    @xmath105    with @xmath106 free parameters to be fit for , and @xmath107 the barycentric arrival time for toa @xmath28 .",
    "this can be achieved most simply be adding the timing model parameters @xmath108 and @xmath109 into the pulsar parameter file , and allowing temponest to include them in the fit .      for a detailed discussion of this approach , and comparisons to existing methods",
    "see lee et al .",
    "( submitted ) . in brief , we transform our red noise covariance matrix @xmath110 to :    @xmath111    the total noise covariance matrix can therefore be rewritten as : @xmath112",
    "despite having the ability to fit simultaneously for all the timing model parameters and the stochastic properties of the noise present in the signal , there may be times where it is preferable to marginalise over some of the timing model parameters analytically in order to decrease the dimensionality of the problem .",
    "for example , a set of toas for a single pulsar might be the combination of many different sets of observations taken by different observatories , with phase jumps fitted between each set . if the specific values of these jumps are not of interest then the analysis might be performed faster if the decrease in the number of calculations required to explore the smaller dimensional space outweighs the increase in the calculation time that results from the matrix operations required by the marginalisation process .",
    "if we separate the timing model into a contribution from the set of parameters that we wish to parameterise @xmath40 and a contribution from the set of @xmath113 parameters that we plan to marginalise over analytically @xmath114 then we can write the probability that the data @xmath115 is described by the remaining parameters @xmath116 and any additional parameters @xmath117 we wish to include as :    @xmath118    using a uniform prior on the @xmath113 @xmath119 parameters , we use the same approach as described in @xcite to perform this marginalisation process analytically .",
    "this results in a set of equations [ eq : whitelikemargin ] , [ eq : llikemargin ] that exist in parallel to eqns [ eq : margin ] and [ eq : rlike ] :    @xmath120    where @xmath121 , @xmath122 is the @xmath123 noise covariance matrix as before and @xmath124 is the @xmath125 matrix that performs the marginalisation whose derivation will not be given here but is described in @xcite ,    @xmath126 , \\nonumber\\end{aligned}\\ ] ]    where @xmath127 , @xmath128 and @xmath129 .",
    "we would like to compare the results of the non - linear analysis of the timing model afforded by temponest , with those that can be obtained from the linear approximation , and so we provide a brief description of the linear model below .",
    "given an initial estimate of the @xmath113 timing model parameters @xmath130 a linear approximation can be performed such that any deviations from that estimate are encapsulated using the @xmath113 parameters @xmath131 such that :    @xmath132    therefore , writing the set of post  fit residuals that results from the subtraction of the initial estimate of the timing model from our toas as @xmath133 we can express the change in these residuals that results from the deviation in the timing model parameters @xmath134 as : @xmath135 where @xmath136 is the @xmath137 ` design matrix ' which describes the dependence of the timing residuals on the model parameters .",
    "therefore in all previous equations , we can simply substitute @xmath138 for @xmath139 in order to evaluate the linear approximation to the timing model .",
    "in order to compare the parameter estimates obtained through both the non - linear and the linearised timing models we use a series of three simulations , details of which are given below .",
    "the simulations are designed to make it progressively more difficult to extract the correct timing model parameters , due both to increasing the amplitude of the white noise in the data , and increasing the complexity of the noise by including additional red noise signals .",
    "simulation 1 : : :    the toas consist only of the deterministic timing model and gaussian    white noise with an amplitude of @xmath140 seconds .",
    "+ simulation 2 : : :    as simulation 1 , however with a white noise amplitude of    @xmath141 seconds . + simulation 3",
    ": : :    as simulation 1 , however with the addition of a red noise signal    described by eq.[eq : red ] with @xmath142 and    @xmath143 .",
    "+    in all three simulations we use a simulated timing model for the binary pulsar j1713 + 0747 consistent with current observed values @xcite , details of which are given in table [ table : pulsarparams ] .",
    "when performing the linearised parameterisation of the timing model we perform the linearisation at the injected parameter values in order to maximise the performance of the method , and thus provide the most stringent comparison .",
    "ll + pulsar name & j1713 + 0747 + mjd range & 50000.353002.0 + number of toas & 216 +   + right ascension , @xmath45 & 17:13:49.5325545 + declination , @xmath144 & + 07:47:37.49998 + pulse frequency , @xmath52 ( s@xmath145 ) & 218.81184044143486131 + first derivative of pulse frequency , @xmath146 ( s@xmath147 ) & @xmath1484.0839248109419448511@xmath149 + dispersion measure , @xmath150 ( @xmath151pc ) & 15.9936 + proper motion in right ascension , @xmath152 ( masyr@xmath145 ) & 4.91612625 + proper motion in declination , @xmath153 ( masyr@xmath145 ) & @xmath1483.9208688 + parallax , @xmath154 ( mas ) & 0.9359045 + orbital period , @xmath155 ( d ) & 67.8251296839 + epoch of periastron , @xmath156 ( mjd ) & 54303.63538774 + projected semi - major axis of orbit , @xmath157 ( lt - s ) & 32.34242233904 + longitude of periastron , @xmath158 ( deg ) & 176.20415671 + orbital eccentricity , @xmath159 & 7.4940259711@xmath160 + first derivative of orbital period , @xmath161 & 3.00166@xmath162 + periastron advance , @xmath163 ( deg / yr ) & @xmath1483.6932@xmath160 + companion mass , @xmath164 ( @xmath165 ) & 0.3112297 + longitude of ascending node , @xmath166 ( degrees ) & 93.90581 + orbital inclination angle , @xmath28 ( degrees ) & 71.139153 +   + epoch of frequency determination ( mjd ) & 54312 + epoch of position determination ( mjd ) & 54312 + epoch of dispersion measure determination ( mjd ) & 54312 +   + clock correction procedure & tt(tai ) + solar system ephemeris model & de421 + binary model & t2 + model version number & 5.00 +    [ table : pulsarparams ]    tables [ table : sim1 ] to [ table : sim3 ] show the maximum likelihood , linear and non - linear timing model and stochastic parameter estimates for the three simulations . in all cases we list only a single set of maximum likelihood parameter estimates , as these are the same for both linear and non - linear models",
    "[ figure : sim1 ] to [ figure : sim3 ] then show the one and two dimensional marginalised posteriors for a subset of the non - linear ( top plots ) and linear ( bottom plots ) timing model parameters related to the binary properties of the system that show the greatest differences when comparing the two models . for simulation 3",
    "we substitute two of the timing model parameters in these plots ( the orbital period and eccentricity ) in favour of the spectral index and amplitude of the red noise .",
    "for the three simulations all the posterior distributions for the timing model parameters shown in figs .",
    "[ figure : sim1 ] to [ figure : sim3 ] are consistent with the injected parameter values within 2@xmath167 confidence intervals for both the linear and non - linear timing models . from simulation 1",
    "we see that in the high signal  to  noise regime , there is almost no observable difference between either the parameter estimates or their uncertainties for the linear and non - linear timing models .",
    "this is to be expected as the range of parameter space over which the likelihood remains high is small , and thus the linear approximation should be valid .",
    "as we increase the level of the white noise however , from an amplitude of 100ns to @xmath168 , we begin to see some significant differences between the two models . in particular the companion mass and kopeikin parameters ( kom and kin )",
    "show large curving degeneracies between the parameters .",
    "these non - gaussian features are lost when we transition to the linear regime , which has the result of incorrectly estimating the uncertainties in these parameters .",
    "for example , the 1@xmath167 confidence intervals for the companion mass m2 is a factor 2.4 times smaller in the linear regime when compared to the non - linear .",
    "this effect is accentuated even further in simulation three where we introduce a red noise signal into the data .",
    "here almost all parameters shown in fig . [ figure : sim3 ] show an underestimation of the error in the linear regime , with the most extreme examples showing 1@xmath167 confidence intervals 8.8 and 10.8 times greater in the non - linear model for parameters @xmath169 and @xmath170 respectively .",
    "it is important to note that in both cases we are modelling the red noise in the same way , and thus this effect is solely due to the differences between the linear and non - linear timing models .",
    "as such , any method of pulsar timing analysis that operates in the linear regime , regardless of how it incorporates additional stochastic processes , such as the cholesky method in c11 , will suffer from this effect .    in this one set of simulations we do not see any significant bias in the timing model parameters returned by the linear timing model , however ,",
    "given that the posterior probability distribution of the non - linear timing model shows significant curving degeneracies , and much greater @xmath171 confidence intervals for the binary parameters when compared to the linear model as the noise increases , we would expect that over a large number of realisations the number of occurences of @xmath172 deviations that occur in the linear timing model should exceed that predicted by gaussian statistics . in order to test this hypothesis",
    "we generate a series of 10591 realisations of the noise in simulation 2 , using tempo2 to calculate the parameter estimates with the linear timing model , and count the number of @xmath173 deviations for the binary parameters in the timing model , with @xmath174 the @xmath171 uncertainty returned by tempo2",
    ". given gaussian statistics we would expect @xmath175 such events across all parameters total .",
    "[ figure : sigmadev ] shows a histogram for the number of events for the binary parameters in psr j1713 + 0747 .",
    "the model parameters a1 , m2 , kin and kom show a significant excess from the gaussian prediction , indicating that the linear timing model significantly underestimates the errors in these parameters . comparing this result to fig .",
    "[ figure : sim2 ] we see that these parameters correspond to those that have large curving degeneracies in the posterior probability distribution , with significantly larger 1@xmath167 confidence intervals than those returned by the linear model , confirming our hypothesis .    [ cols=\"<,^,^,^\",options=\"header \" , ]     [ table:1937ev2 ]    table [ table:1937ev2 ] lists the evidence for the different models applied to dataset 2 where we give the value only for the optimal @xmath176 in each case . in all cases",
    "the number of coefficients required by the dm variations was greater than for the red noise .",
    "for dataset 2 the optimal set of frequencies is given by @xmath177 $ ] for the red spin noise , and @xmath178 $ ] for the dm variations .",
    "we find that once again finding the optimal set of frequencies to include results in a significant increase in the @xmath179 evidence of @xmath34 4.5 when compared to the consecutive set . as with dataset 1",
    "we show in fig [ figure : d1res ] the residuals and maximum likelihood signal realisation given the mean posterior values for the power spectrum coefficients obtained by the optimal model independent analysis . fitting for a power law model in both cases results in spectral indices of @xmath180 and @xmath181 for the red noise and dm variations respectively ,",
    "consistent with the model independent analysis . as with dataset 1 this consistency",
    "is supported by the log evidence , which has a maximum when constraining the power spectrum to follow a power law .",
    "compared to dataset 1 the we find neither the red noise nor the dm variation power spectrum in dataset 2 show any sign of a shallow tail .",
    "this suggests that the dm model applied in k94 did not account fully for the higher frequency dm variation , flattening the red noise spectrum of the resultant residuals .",
    "we now perform the analysis of the non - linear timing model simultaneously with the red noise and dm variations , where we model the latter two elements using a power law model as has been supported by the evidence in the preceding stochastic analysis .",
    "@xmath182{lreddmredoptspectrum.pdf } & \\includegraphics[width=85mm]{lreddmdmoptspectrum.pdf } \\\\",
    "\\includegraphics[width=85mm]{highfreqres.pdf } & \\includegraphics[width=85mm]{lowfreqres.pdf } \\\\",
    "\\end{array}$ ]      lccc + pulsar name & b1937 + 21 + mjd range & 46024.848973.8 + number of toas & 420 +   + & temponest & tempo2 & spectral model + right ascension , @xmath45 & 19:39:38.561314(10 ) & 19:39:38.561288(3 ) & 19:39:38.56130(5 ) + declination , @xmath144 & + 21:34:59.1295(2 ) & + 21:34:59.13068(5 ) & + 21:34:59.1291(9 ) + pulse frequency , @xmath52 ( s@xmath145 ) & 641.92823355803(16 ) & 641.9282335579857(7 ) & 641.9282335581(14 ) + first derivative of pulse frequency , @xmath146 ( s@xmath147 ) & @xmath1484.33169(3))@xmath183 & @xmath1484.3316913(15)@xmath183 & @xmath1484.33169(5)@xmath183 + dispersion measure , @xmath150 ( @xmath151pc ) & 71.04003(2 ) & 71.039981(15 ) & 71.040024(15 ) + proper motion in right ascension , @xmath152 ( masyr@xmath145 ) & 0.084(11 ) & 0.054(4 ) & 0.08 ( 7 ) + proper motion in declination , @xmath153 ( masyr@xmath145)&@xmath1480.421(15 ) & @xmath1480.319(4 ) & @xmath148 0.43(2 ) + parallax , @xmath154 ( mas ) & 0.24(9 ) & 0.01(4 ) & 0.20(15 ) + efac&0.88(14 ) &  &",
    " + @xmath65 equad & @xmath1486.59(4 ) &  & ",
    "+ @xmath184 & @xmath1483.30(16 ) &  &  + @xmath185 & 3.9(6 ) &  &  +   + & temponest & tempo2 & spectral model + right ascension , @xmath45 & 19:39:38.561307(10 ) & 19:39:38.561219(3 ) & 19:39:38.561301(19 ) + declination , @xmath144 & + 21:34:59.1296(2 ) & + 21:34:59.13136(5 ) & + 21:34:59.1292(4 ) + pulse frequency , @xmath52 ( s@xmath145 ) & 641.9282335581(3 ) & 641.9282335580713(13 ) & 641.9282335581(9 ) + first derivative of pulse frequency , @xmath146 ( s@xmath147)&@xmath1484.33169(6 ) @xmath183 & @xmath1484.331679(3)@xmath183 & @xmath1484.3317(2)@xmath183 + dispersion measure , @xmath150 ( @xmath151pc ) & 71.041(13 ) & 71.040715(15 ) & 71.04060(12 ) + proper motion in right ascension , @xmath152 ( masyr@xmath145 ) & 0.069(10 ) & @xmath1480.005(3 ) & 0.08(2 ) + proper motion in declination , @xmath153 ( masyr@xmath145)&@xmath1480.411(15 ) & @xmath1480.279(4 ) & @xmath1480.44(5 ) + parallax , @xmath154 ( mas ) & 0.25(10 ) & 0.41(4 ) & 0.19(13 ) + efac&1.29(19 ) &  &  + @xmath65 equad & @xmath1487.3(9 ) &  & ",
    "+ @xmath184 & @xmath1483.7(3 ) &  &  + @xmath185 & 5.3(9 ) &  & ",
    "+ @xmath186 & @xmath1480.15(7 ) &  &  + @xmath187 & 2.7(3 ) &  & ",
    "+   + epoch of frequency determination ( mjd ) & 52601 + epoch of position determination ( mjd ) & 52601 + epoch of dispersion measure determination ( mjd ) & 52601 +   + clock correction procedure & tt(tai ) + solar system ephemeris model & de405 + binary model & none + model version number & 5.00 +    [ table : b1937results ]    table [ table : b1937results ] lists the mean posterior values and associated one sigma uncertainties for our final timing model and stochastic solutions to both datasets 1 and 2 where , following the results in sections [ section:1939d1 ] and [ section:1939d2 ] , the stochastic signals have been modelled as power law processes for both the red noise and dm variations . fig .",
    "[ figure : dmplots ] then shows the one and two dimensional marginalised posteriors for a selection of the modelled parameters ; ra , dec , pmra , pmdec , px and the red noise and dm spectral indices and amplitudes .",
    "as expected the timing model parameters show no evidence for non - linear behaviour in either case despite the high levels of red noise in the dataset . as such",
    "we would expect that our estimates for the stochastic parameters when analytically marginalising over the timing model will be completely consistent with those in the full analysis and indeed this is the case in both datasets .",
    "@xmath188{lredtri.pdf } \\\\ \\hspace{-2.0 cm } \\includegraphics[width=200mm]{lreddmtri.pdf }   \\end{array}$ ]    table [ table : b1937results ] also lists the timing model solutions returned by applying both the standard tempo2 fit and using the spectralmodel plug - in which utilises the cholesky method described in c11 . in order to use the spectralmodel plug - in in the case of dataset 2 we therefore applied the method of @xcite to model the dm variations as a linearly interpolated time series , sampled every 100 days in the observation . unlike the approach in k94",
    "this therefore allows us to include the uncertainties in the dm model in the final timing model solutions whilst still using the cholesky method .",
    "[ figure : dmtime ] shows a graphical representation of the differences between the temponest , spectralmodel and tempo2 results for the timing model parameters given in table [ table : b1937results ] for datasets 1 ( left ) and 2 ( right ) . here the value on the yaxis is given by the difference between the temponest ( or spectralmodel ) estimate , and the tempo2 estimated parameter values , divided by the tempo2 error , which as before we will denote @xmath174 .",
    "the errors are then the 1@xmath167 errors estimated by temponest ( spectralmodel ) which we will denote @xmath189 ( @xmath190 ) .",
    "therefore a fit that is consistent both with the value and error returned by tempo2 would have a value of @xmath191 in fig .",
    "[ figure : dmtime ] .",
    "@xmath192{lredonlycholcompfinal.pdf } & \\hspace{-1.0 cm } \\includegraphics[width=100mm]{septnokaspidmcholcomp2.pdf } \\\\ \\end{array}$ ]    there are several things that are immediately apparent in fig .",
    "[ figure : dmtime ] .",
    "the first is the level of disparity between the parameter estimates returned by tempo2 , and those returned by both temponest and the spectralmodel analysis . with the exception of only dm in dataset 1 , and px in dataset 2 the parameter estimates returned by temponest during the joint analysis are at least 4@xmath174 away from the tempo2 values , with an average deviation of @xmath193 .    whilst the parameter estimates returned by the temponest and spectralmodel analysis are in both cases consistent with one another , the estimates of the uncertainties are several times larger than those returned by temponest by a factor of @xmath194 .",
    "in order to investigate the difference in the uncertainties returned by temponest and the spectralmodel plugin , we first consider the major differences between the different types of analysis :    * temponest uses the full non - linear model compared to the linear approximation in spectralmodel * temponest uses physical priors on parameters such as parallax , such that they must take values greater than zero , spectralmodel does not * temponest includes both red and white noise estimation in the fit with the timing model , spectralmodel does not include additional white noise terms , and fixes the red noise when calculating the uncertainties for the timing model . *",
    "temponest uses a cut off power law model for the red noise , whereas spectralmodel uses a red noise model with a corner frequency at which it turns over .    in order to ascertain how large an effect these differences make we therefore rerun the analysis on dataset 1 , so that we have the same dm model in both cases , whilst making the following changes :    1 : : :    use the linear timing model , linearised at the timing model parameters    estimated by the spectralmodel plug - in without the condition that    parameters must take physical values 2 : : :    as in 1 , but fixing @xmath195 and @xmath196 ,    and fixing the spectral index of the red noise power law to be the    same value used in the spectralmodel plug - in ( @xmath197 )    @xmath198{lredcholcompfinal.pdf } \\\\",
    "\\end{array}$ ]    fig .",
    "[ figure : finalcomp ] shows the timing model parameters estimated from these different approximations in the same format as in fig .",
    "[ figure : dmtime ] .",
    "the red and green points represent the parameter estimates from the full non - linear timing analysis , and the linearised analysis respectively , however there is no discernible difference in either the estimated parameter values , or the uncertainties between these two models , as expected given the set of parameters included in the timing model .",
    "the blue points represent the case where we have not included white noise in the model , and have fixed the spectral index of the red noise to be that used in the spectralmodel analysis ( @xmath197 ) .",
    "here there is a clear increase in the level of uncertainty of the timing model parameters relative to the full analysis by a factor of @xmath194 except for dm which sees the uncertainties decrease by @xmath199 . in both cases",
    "however this brings the estimated uncertainties in line with those derived from the spectralmodel analysis , with remaining differences being of the order @xmath200 , with the exception of the quadratic spin down parameters , from which we would expect the greatest difference given the use of different red noise models .",
    "this clearly emphasises the importance of including as much as is required to fully describe the data simultaneously in the fit along with the timing model parameters .",
    "we should make clear that the magnitude of the differences observed in psr b1937 + 21 will not be typical for most millisecond pulsars , however , the precise level of difference to expect is difficult to quantify a priori , being a function of signal - to - noise , the cadence of the observations , and the complexity of the timing model used to describe the pulsar . we therefore still suggest that unless a full simultaneous analysis such as that described here is performed in every case , the unpredictable variation in the uncertainties returned from the analysis must impact the robustness of the science extracted from that analysis .",
    "we have introduced temponest , a software package that provides a means of performing a robust bayesian analysis of pulsar timing data .",
    "temponest allows for the joint analysis of the timing model along with a range of additional stochastic parameters including efac and equad parameters , and descriptions of both red spin noise and dispersion measure variations using either a power law description of the noise , or in a model - independent way , parameterising the power at individual frequencies in the data .",
    "we have applied temponest to both simulated and real datasets in order to demonstrate several key aspects of functionality .",
    "first we used simulated data for the pulsar psr j1713 + 0747 in order to compare the linear and non - linear timing models where the level of noise varied between simulations , from that expected from the square kilometer array ( @xmath34 100ns white timing noise ) , to a level more representative of current observations , including red spin noise .",
    "we showed that in the high signal  to  noise example the differences between the timing solutions for the linear and non - linear timing model parameters were negligible . in the lower signal  to  noise examples , however , the linear timing model failed to capture all the information present in the data , with large curving degeneracies in the non - linear parameter space leading to uncertainties that exceeded those in the linear approximation by up to an order of magnitude .",
    "we then applied temponest to two publicly available datasets , the binary pulsar b1855 + 09 and the isolated pulsar b1937 + 21 .",
    "for the former we used a model independent method of parameterising the red spin noise in the data and found marginal support for a single low frequency component in addition to the timing model parameters fitted , but found it did not affect the timing model solutions in any observable way , with parameter estimates that were completely consistent with those of tempo2 in all respects .",
    "we then demonstrated the ability for temponest to perform model selection using the evidence by including a series of additional timing model parameters and repeating the analysis in order to find the optimal set that described the data .",
    "this included adding jumps between instrument back ends , and additional physical parameters such as derivatives of the binary period or eccentricity .    in the case of b1937 + 21 we used both a power law , and model independent method of parameterising both the dispersion measure and red noise signals in the data , and found whilst they gave consistent results , the evidence heavily favoured the use of the simpler model , with both components being well described by a power law power spectrum with spectral indices of @xmath201 and @xmath202 respectively . when comparing the timing model solutions returned by temponest from this joint analysis with those of tempo2 we found large discrepancies , both in terms of the parameter estimates themselves and their uncertainties . in the most extreme cases the temponest parameter estimates were up to @xmath203 away from the tempo2 values , with @xmath174 the returned tempo2 uncertainty , whilst the uncertainties themselves were over two orders of magnitude greater in the case of the pulsar s spin down parameters .",
    "when compared to the cholesky method found in the tempo2 spectralmodel plug - in , we found that by not including all the stochastic processes in the analysis simultaneously with the timing model , the timing model parameter uncertainties are overestimated by a factor @xmath194 in almost all cases , showing unambiguously the importance of including as much as is required to fully describe the data simultaneously in the analysis .",
    "this is all the more critical given the precise level of difference to expect for any pulsar is difficult to quantify a priori , being a function of signal - to - noise , the cadence of the observations , and the complexity of the timing model used to describe the pulsar . we therefore suggest that unless a full simultaneous analysis such as that described here is performed in every case , the unpredictable variation in the uncertainties returned from the analysis must impact the robustness of the science extracted from that analysis ."
  ],
  "abstract_text": [
    "<S> a new bayesian software package for the analysis of pulsar timing data is presented in the form of temponest which allows for the robust determination of the non - linear pulsar timing solution simultaneously with a range of additional stochastic parameters . </S>",
    "<S> this includes both red spin noise and dispersion measure variations using either power law descriptions of the noise , or through a model - independent method that parameterises the power at individual frequencies in the signal . </S>",
    "<S> we use temponest to show that at noise levels representative of current datasets in the european pulsar timing array ( epta ) and international pulsar timing array ( ipta ) the linear timing model can underestimate the uncertainties of the timing solution by up to an order of magnitude . </S>",
    "<S> we also show how to perform bayesian model selection between different sets of timing model and stochastic parameters , for example , by demonstrating that in the pulsar b1937 + 21 both the dispersion measure variations and spin noise in the data are optimally modelled by simple power laws . </S>",
    "<S> finally we show that not including the stochastic parameters simultaneously with the timing model can lead to unpredictable variation in the estimated uncertainties , compromising the robustness of the scientific results extracted from such analysis .    </S>",
    "<S> [ firstpage ]    methods : data analysis , pulsars : general , pulsars : individual </S>"
  ]
}