{
  "article_text": [
    "lcls pad development was supported by subcontract from slac under doe contract de - ac02 - 76sf00515 .",
    "detector development at cornell is also supported by doe grants fg02 - 97er62443 , de - fg02 - 10er46693 and the keck foundation .",
    "chess is supported by nsf and nih - nigms under nsf grant dmr-0936384 . the data analysis dealing with the extraction from randomly - oriented",
    ", sparse data is supported by doe grant de - fg02 - 11er16210 .",
    "n.  d. loh , m.  j. bogan , v.  elser , a.  barty , s.  boutet , s.  bajt , j.  hajdu , t.  ekeberg , f.  r. n.  c. maia , j.  schulz , m.  m. seibert , b.  iwan , n.  timneanu , s.  marchesini , i.  schlichting , r.  l. shoeman , l.  lomb , m.  frank , m.  liang , and h.  n. chapman .",
    "cryptotomography : reconstructing 3d fourier intensities from randomly oriented single - shot diffraction patterns . ,",
    "104(22):225501 , jun 2010 .",
    "h.  t. philipp , l.  j. koerner , m.  s. hromalik , m.  w. tate , and s.  m. gruner .",
    "femtosecond radiation experiment detector for x - ray free - electron laser ( xfel ) coherent x - ray imaging .",
    ", 57(6):37953799 , dec 2010 ."
  ],
  "abstract_text": [
    "<S> single - particle imaging experiments of biomolecules at x - ray free - electron lasers ( xfels ) require processing of hundreds of thousands ( or more ) of images that contain very few x - rays . </S>",
    "<S> each low - flux image of the diffraction pattern is produced by a single , randomly oriented particle , such as a protein . </S>",
    "<S> we demonstrate the feasibility of collecting data at these extremes , averaging only 2.5 photons per frame , where it seems doubtful there could be information about the state of rotation , let alone the image contrast . </S>",
    "<S> this is accomplished with an expectation maximization algorithm that processes the low - flux data in aggregate , and without any prior knowledge of the object or its orientation . </S>",
    "<S> the versatility of the method promises , more generally , to redefine what measurement scenarios can provide useful signal in the high - noise regime .    the ultra - intense , ultra - fast x - ray pulses from x - ray free electron lasers ( e.g. , the linac coherent light source , lcls ) , hold potential to provide structural information about proteins that are not available in crystalline form  @xcite . </S>",
    "<S> even with xfels the number of photons scattered at large angles from a single protein is , on average , much less than one photon per pixel per image ( i.e. frame ) . since the measurement is destructive , </S>",
    "<S> many images must be gathered , each from a new molecule . </S>",
    "<S> the situation is further complicated because the samples are imaged in unknown , random orientations . the combination of low - flux and unknown particle orientation tests the information limits posed by measurements with few photons  @xcite .    </S>",
    "<S> recovery of detailed , orientation specific structural information from a data set using many ultra - low intensity x - ray images from a randomly oriented sample has yet to be demonstrated . </S>",
    "<S> the information contained in these snapshots with only a few photons per frame would at first seem deficient to contain both a description of the orientation and intensity of the underlying structure . </S>",
    "<S> we demonstrate a simplified version of an algorithm developed for the x - ray single particle imaging experiment  @xcite is capable of reducing this kind of data even with images that average only 2.5 x - ray photons per frame ( @xmath0 photons per pixel per frame ) . for this demonstration </S>",
    "<S> , we use a pixel array detector having the same cmos front - end as the instrument currently installed at the coherent x - ray imaging ( cxi ) beamline at the linac coherent light source ( lcls ) .  </S>",
    "<S> @xcite    the algorithm for reconstructing the x - ray intensity from data follows the expectation maximization ( em ) principle  @xcite . </S>",
    "<S> em starts with a random model of the intensity , @xmath1 , at each pixel @xmath2 . </S>",
    "<S> these values are iteratively updated by a rule that can only increase the likelihood of the model . </S>",
    "<S> the initial model is random because no information about the model is known .    </S>",
    "<S> each iteration involves two steps . in the first step , each frame of data , @xmath3 , is assigned a probability distribution , @xmath4 , with respect to its unknown rotation , @xmath5 , relative to the current intensity model . </S>",
    "<S> the rotations are sampled in increments of @xmath6 , where @xmath7 defines the angular resolution of the reconstruction . </S>",
    "<S> each frame comprises photon occupancy , @xmath8 , at pixel @xmath2 , which in our low - flux experiment are almost all zero , the exceptions being equal to 1 . because the photon counts are independent poisson samples of the intensity at each pixel , the probability is    @xmath9    where @xmath10 is rotation @xmath5 , applied to pixel @xmath2 </S>",
    "<S> , @xmath11 is the set of pixels recording photons in frame @xmath3 , with the final expression applying in the low - flux limit . </S>",
    "<S> after normalizing the distributions , @xmath4 , the algorithm proceeds to the second step .    in the second step the algorithm aggregates the photon data from all the frames according to the distributions obtained in the first step </S>",
    "<S> : @xmath12 the updated intensity model @xmath13 is an average of the photon counts in all frames with the appropriate distribution of rotations applied to each one . </S>",
    "<S> interpolation is used in both steps , when mapping one square grid ( model ) onto one that has been rotated ( detector ) . </S>",
    "<S> the em algorithm is still valid when the data is winnowed by a structure - neutral criterion , such as the photon occupancy . in our implementation , for example , we discarded all frames with zero occupancy .    </S>",
    "<S> this algorithm is closely analogous to the emc algorithm that was developed for reconstructing the 3-dimensional ( 3d ) intensity of randomly oriented particles  @xcite . </S>",
    "<S> a 3d reconstruction is technically challenging because ( i ) the space of rotations is three - dimensional and ( ii ) the data is tomographic in nature , each frame providing information within only one 2d slice of the 3d model . and while the work required for the 3d reconstructions is correspondingly greater , we find that the performance of the algorithm in 3d with simulated data , and the 2d reconstructions reported here with actual data , is virtually the same when evaluated in terms of convergence ( iteration number ) in the ultra - low - flux limit . </S>",
    "<S> thus , our experiment is directly relevant to the case of single - protein imaging at an xfel .    </S>",
    "<S> an alternative approach being considered  @xcite for determining the rotations of randomly oriented particles involves classifying data on the basis of cross - correlations :    @xmath14    this is not an option in the ultra - low flux limit because the numbers @xmath15 are essentially all zero , and in any event do not distinguish frames derived from like or unlike particle orientations . </S>",
    "<S> the em algorithm , by contrast , compares each frame not with other frames but with the model . </S>",
    "<S> greater sensitivity of rotation determination in the em algorithm can be traced to the multiplicative nature of the comparison expressed by equation ( [ eqn : step1 ] ) .    </S>",
    "<S> the em algorithm should in principle work with arbitrarily low - flux data . </S>",
    "<S> it is clear that this is the case when we consider that there will be rare fluctuations where the photon occupancy is 2 or greater , even when the mean is just a fraction of a photon . </S>",
    "<S> a fair assessment of the viability of reconstructions in the low - flux regime must therefore take into account the inevitability of background . </S>",
    "<S> the effects of background in the interpretation of our results are well captured by a simple information rate ratio :    @xmath16    this is the information rate at signal - to - noise @xmath17 ( the ratio of signal to background photons ) divided by the rate in the limit of infinite @xmath17 . </S>",
    "<S> the formula applies to signals that are two - valued , as in our experiment , where @xmath18 is the open fraction of the mask . </S>",
    "<S> it is derived from the mutual information , @xmath19 , associated with the measurement of @xmath20 photons and an integrated flux , @xmath21 , at one pixel . </S>",
    "<S> the joint probability distribution for this process is @xmath22 where @xmath23 is the poisson distribution for the photon count @xmath20 given flux @xmath21 , and @xmath24 describes the distribution of flux in our model . </S>",
    "<S> we take the limit where both @xmath25 , the signal flux , and @xmath26 , the background flux , are much less than one photon . </S>",
    "<S> the quantity @xmath27 is the mutual information @xmath19 for the experimental parameters divided by the mutual information of the zero - background comparison , where @xmath26 is set to zero ; the result depends only on the ratio @xmath28 .    as an example , consider the case of @xmath29 , which for @xmath30 gives @xmath31 . </S>",
    "<S> a low flux experiment with 2 signal photons per frame and this poor signal - to - noise would therefore be like a zero - background experiment with only 0.02 photons per frame ; the rate of useful frames in this comparison experiment , say having 2 or more photons , would only be 1 in 4000 .    to test the reconstruction algorithm with data from randomly oriented samples , a pattern was cut out of x - ray opaque lead sheet to create an x - ray shadow mask ( figure  [ fig : realpadman1 ] ) . </S>",
    "<S> this mask was then mounted within a 19 mm diameter aperture of an opaque metal disk that fit onto a rotation stage ( a newport urs100bpp ) with the center of rotation approximately at the center of the aperture .    </S>",
    "<S> a very low - power copper anode x - ray tube was used to generate x - rays ( trufocus tfs 6050 cu , 50 w maximum ) . </S>",
    "<S> it was operated at an anode voltage of 10.1 kv to reduce high - energy bremsstrahlung . a 50 micron </S>",
    "<S> thick nickel filter was used to preferentially remove the @xmath32 of the tube spectrum to produce an approximately monochromatic x - ray beam of 8-kev cu @xmath33 radiation . </S>",
    "<S> the rotation stage and aperture were mounted on the end of a 45 cm flight - path to produce a nearly flat - field illumination of x - rays across the 19 mm sample .    </S>",
    "<S> the x - ray mask and a static x - ray image of the pattern are shown in figures 1a and 1b . </S>",
    "<S> cornell s lcls pixel array detector ( pad ) , comprising a single - chip 194 x 185 pixel array , was placed after the mask along the flight path . </S>",
    "<S> the pad was positioned so the entirety of the aperture image was incident on the detector . </S>",
    "<S> the x - ray image shown in figure 1b was collected by summing 432 images of the mask at fixed position . </S>",
    "<S> each 0.1 s image had an occupancy of approximately 0.2 x - ray photons per pixel per frame in the unobstructed regions .    </S>",
    "<S> very low - flux data were also collected with a continuously rotating sample . </S>",
    "<S> the detector collected images at 100 frames per second with a per - frame integration time of 100 microseconds . </S>",
    "<S> the waveforms used for digitization and detector readout were the same as those used when the detector is running at 120 frames per second , the frame rate of the lcls , except the internal trigger was set to a 10 ms period ( rather than 8 ms ) . </S>",
    "<S> x - ray tube currents of 0.15 ma , and 0.03 ma were used to produce varying x - ray intensities . with each current , </S>",
    "<S> hundreds of thousands of images were collected . </S>",
    "<S> figures 2(a - c ) show three typical very low - flux mask images , in each case consisting of only a few x - rays per frame .    </S>",
    "<S> dark signal measurements were made throughout the data collection sequence by periodically taking groups of 144 frames with the x - ray shutter closed . </S>",
    "<S> these dark frames were used to define a low - noise zero - level which was subtracted from individual signal frames to extract the x - ray induced signal from the raw detector output .    </S>",
    "<S> analog integrating detectors are required at xfels because many other experiments deliver more than one x - ray photon per pixel per frame ( as expected at low scattering angles in single particle imaging experiments ) , and the x - ray pulse is too short for photon counting electronics . </S>",
    "<S> minimum signal threshold values can be applied to the analog data to reject low - level noise  @xcite . </S>",
    "<S> the threshold in this experiment was set to 0.7 x - ray photons ( for 2.5 photon / frame data set ) or 0.75 x - ray photons ( for the 11.5 photon / frame data set ) . at these thresholds </S>",
    "<S> approximately 0.05 and 0.01 false positive photon measurements per frame are expected , using a normal distribution and the previously measured  @xcite pixel signal - to - noise ratio of 7 for a single 8-kev x - ray . </S>",
    "<S> the lower threshold was used for 2.5 photon / frame data because this was the last data set taken and progressively less favorable parameters were chosen to test the robustness of the detector and algorithm . </S>",
    "<S> no compensation was used for charge sharing between adjacent pixels , nor were pixel gains individually calibrated . a single </S>",
    "<S> , global threshold and nominal pixel gain value were applied across the array .    </S>",
    "<S> separate data sets analyzed included hundreds of thousands of frames with mean fluxes of 11.5 photons / frame and 2.5 photons / frame .    </S>",
    "<S> reconstructed images are shown in figures  [ fig:115man ] and  [ fig:25man ] . </S>",
    "<S> figure  [ fig:25man ] was reconstructed using 450,000 frames of data with an average of 2.5 photons per frame . </S>",
    "<S> the reconstruction algorithm used 180 equally spaced @xmath34 steps . </S>",
    "<S> figure 2e shows a simple sum of the thresholded frames of data that results in a rotationally smeared image with a uniform angular distribution . </S>",
    "<S> this data set has a total of 1.2 million photons . for comparison , </S>",
    "<S> a data set with a similar total number of photons , but a higher per - frame photon average ( and thus fewer frames ) was also processed . </S>",
    "<S> the reconstruction is shown in figure  [ fig:115man ] , where the average occupancy was 11.5 photons / frame .    </S>",
    "<S> the quality of the two reconstructions differs in both spatial resolution and contrast , with the 11.5 photons / frame data yielding better results . </S>",
    "<S> this agrees with the results of reconstructing 3d intensities from simulated single - particle diffraction data  @xcite , also at very low flux . </S>",
    "<S> the degradation in quality occurs when a significant fraction of the information content in each frame , about half , is just the orientational state . </S>",
    "<S> there is a sharp increase in the iteration count of the em algorithm when this criterion is met : the 2.5 photon / frame data required 220 iterations , compared to 49 iterations for the 11.5 photon / frame data .    by adding a uniform distribution of computer generated photon counts to the data sets , and </S>",
    "<S> processing it by the em algorithm as before , we are able to simulate the effects of background scattering from gas molecules along the path of the incident x - ray beam in single particle experiments . </S>",
    "<S> this should be the major source of background signal and many times larger than the detector noise when the detector data are properly thresholded . </S>",
    "<S> not surprisingly we find deterioration in the quality of the reconstruction . </S>",
    "<S> the degree of degradation is consistent with the information ratio @xmath27 quoted above , which equals 0.26 when signal - to - noise is 1 . with this level of background our data set with 11.5 signal - photons / </S>",
    "<S> frame corresponds to a zero - background data set with only 3 photons / frame . </S>",
    "<S> the resulting reconstruction by the em algorithm was therefore similar to that of our 2.5 photons / frame background - free reconstruction in both image quality and number of iterations ( see figure  [ fig:115backsub ] ) .    </S>",
    "<S> although this demonstration was motivated by the ongoing effort to realize single particle imaging , the strategy we employed applies more generally to measurements which seek to eliminate ensemble averaging and as a result yield extremely weak signals . </S>",
    "<S> temporal averaging is avoided by short pulses of illumination and the spatial counterpart is achieved by isolation ( e.g. single particles ) or focusing , as in the case of ptychography  @xcite . in all these cases </S>",
    "<S> one sacrifices signal , thus putting an increased burden on the recording of weak signals with high fidelity and reconstructing from the resulting very sparse data . </S>",
    "<S> the envisioned single particle experiments at lcls are an extreme example of this , but the same approach would apply even more to experiments with lower intensity sources , for example , energy recovery linac ( erl ) x - ray sources  @xcite . </S>",
    "<S> an erl can deliver very short x - ray pulses that are much less intense than xfel pulses , but deliver many more pulses per second to compensate . </S>",
    "<S> ptychography performed with an erl , in conjunction with our data acquisition / analysis method , looks especially promising . </S>",
    "<S> data acquisition would be fast and yet immune to mechanical instabilities because of the short pulse duration , while jitter in the position of the focus would be algorithmically reconstructed , in analogy with the angle reconstructions in our demonstration . </S>"
  ]
}