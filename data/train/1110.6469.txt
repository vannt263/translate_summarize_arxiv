{
  "article_text": [
    "stochastic mechanisms play key roles in biological systems since the underlying biochemical reactions are subject to molecular - level fluctuations ( see e.g. @xcite ) .",
    "chemical reactions are discrete events occurring between randomly moving molecules .",
    "consequently , the timing of individual reactions is nondeterministic and the evolution of the number of molecules is inherently noisy .",
    "one example of particular importance is the stochastic expression of gene products ( mrna and protein ) @xcite . here , molecular - level fluctuations may cause genetically identical cells in the same environment to display significant variation in phenotypes , loosely defined as any observable biochemical or physical attribute .",
    "while such noise is generally viewed as detrimental due to reduced precision of signal transduction and coordination , several scenarios exist where noise in gene expression may provide a fitness advantage ( see fraser and krn @xcite for a review ) .",
    "for example , it has been proposed that a cell population may enhance its ability to reproduce ( fitness ) by allowing stochastic transitions between phenotypes to increase the likelihood that some cells are better positioned to endure unexpected environmental fluctuations @xcite .    due to the importance of noise in many biological systems , models involving stochastic formulations of chemical kinetics",
    "are increasingly being used to simulate and analyze cellular control systems @xcite . in many cases , obtaining analytical solutions for these models",
    "are not feasible due to the intractability of the corresponding system of nonlinear equations .",
    "thus , a monte carlo ( mc ) simulation procedure for numerically calculating the time evolution of a spatially homogeneous mixture of molecules is commonly employed @xcite . among these procedures ,",
    "the gillespie stochastic simulation algorithm ( ssa ) is the _ de - facto _ standard for simulating biochemical systems in situations where a deterministic formulation may be inadequate @xcite .",
    "the ssa tracks the molecular number of each species in the system as opposed to the variation in concentrations in the deterministic framework .",
    "hence , high network complexity , large separation of time - scales and high molecule numbers can result in computationally intensive executions .",
    "another challenge is the need for simulating cell populations . in many cases ,",
    "gene expression is measured for 10 - 100 thousand individuals sampled from an exponentially growing culture of continuously dividing cells . while the dynamics of individual cells can be appropriately simulated by disregarding daughter cells , repeating such simulations for a fixed number of cells may not capture population variability arising from asymmetric division , for example , or age - dependent effects .",
    "the alternative , tracking and simulating all cells within the population , is intractable beyond a few divisions due to an exponential increase in cpu demands as a function of time @xcite .    here",
    ", we present a flexible algorithm to enable simulations of heterogeneous cell population dynamics at single - cell resolution . deterministic and langevin approaches to account for changes in intracellular content and the constant - number mc method @xcite",
    "were previously been combined to simulate and analyze gene expression across cell populations @xcite . in these studies ,",
    "extrinsic heterogeneity associated with stochastic division and partitioning mechanisms , and intrinsic heterogeneity associated with molecular reaction kinetics were considered .",
    "our algorithm , which combines the exact ssa for single - cell molecular- level modeling and a constant - number mc method for population - level modeling , is designed to incorporate user - defined biologically relevant features , such as gene duplication and cell division , as well as single cell , lineage and population dynamics at specified sampling intervals .",
    "additionally , the ssa , which can be replaced by approximate methods if desired , is implemented within a shared - memory cpu parallelization framework to reduce simulation run - times .",
    "the emphasis of our study is to validate the accuracy of the method by directly comparing simulated results to the analytical solutions of models describing increasingly realistic biological features .",
    "our results indicate that combining the ssa and the constant - number mc provides an efficient and accurate approach to simulate heterogeneous population dynamics , and a reliable tool for the study of population - based models of gene expression incorporating physiological detail and phenotypic variability .",
    "this paper is organized as follows : sections 2 and 3 briefly introduce the ssa and the constant - number mc method , respectively . the developed algorithm is described in section 4 .",
    "section 5 provides the results of the benchmarking against analytical results . finally ,",
    "in section 6 , we demonstrate the applicability of the algorithm to more complex contexts by demonstrating that it can quantitatively reproduce experimental measurements of gene expression dynamics within ` bet- hedging ' cell populations during their adaption to environmental stress .",
    "the work is summarized in section 7 .",
    "the physical basis of the stochastic formulation of chemical kinetics is a consequence of the fact that collisions in a system of molecules in thermal equilibrium is essentially a random process @xcite .",
    "this stochasticity is correctly accounted for by the gillespie ssa , a mc procedure to numerically simulate the time evolution of chemical and biochemical reaction systems . while based on an assumption of intracellular homogeneity and mass - action kinetics , it is the @xmath0 standard for simulations of gene expression . in the direct method",
    "gillespie ssa , @xmath1 chemical reactions @xmath2 with rate constants @xmath3 among @xmath4 chemical species @xmath5 , are simulated one reaction event at a time . the next reaction to occur",
    "( index @xmath6 and its timing ( @xmath7 ) are determined by calculating @xmath1 reaction propensities @xmath8 , given the current number of molecules of each of the @xmath4 chemical species , to obtain an appropriately weighted probability for each reaction .",
    "it can be implemented via the following pseudocode @xcite : +    calculate @xmath9 and @xmath10 generate uniformly distributed random numbers ( @xmath11,@xmath12 ) determine when ( @xmath13 ) and which ( @xmath14 ) reaction will occur set @xmath15 update @xmath16    the ssa can be augmented to incorporate biologically relevant features , such as changes in the volume of the cell during growth , the partitioning of cell volume and content at division and dna replication ( see e.g. @xcite ) .",
    "changes in cell volume may have significant effects on reaction kinetics .",
    "first order reactions have deterministic rate constants ( @xmath17 ) and stochastic rate constants ( @xmath18 ) that are equal and independent of volume @xcite .",
    "however , for higher order reactions , it is necessary to incorporate cell volume @xmath19 into the reaction propensities in order to perform an exact simulation .",
    "for example , the stochastic rate constant for a bimolecular second order reaction @xmath20 at time @xmath21 is given by @xmath22 where @xmath23 is avogadro s number .",
    "therefore , in the ssa , the rates of higher - order reactions must be scaled appropriately by the current cell volume before calculating propensities .",
    "this procedure has previously been demonstrated to provide a satisfying approximation as long as the kinetic time - scale is short compared with the cellular growth rate @xcite .",
    "typically , the volume of each cell @xmath24 is modeled using an exponential growth law @xmath25,\\ ] ] where @xmath26 is the cell volume at the time of its birth , @xmath27 is the time and @xmath28 is the interval between volume doublings .",
    "this functional form allows for the description of dilution as a first- order decay process within a deterministic model of intracellular concentrations .",
    "once the ssa incorporates a continuously increasing cell volume , it is necessary also to specify rules that govern cell division .",
    "one option is ` sloppy cell - size control ' @xcite where the cell division is treated as a discrete random event that take place with a volume - dependent probability .",
    "another simpler option is to assume that division occurs once the cell has exceeded a critical size @xmath29 corresponding to one doubling of its initial volume , @xmath30 .",
    "the volume doubling time @xmath28 then becomes cell division time and @xmath27 becomes the time since the last division . when cell division is triggered , i.e. when @xmath31 , additional rules must be specified to model the partitioning of cellular content between mother and daughter cells .",
    "for example , asymmetric cell division can be modeled by setting @xmath32 .",
    "the molecules of the cell can then be partitioned probabilistically between the two volumes @xcite .",
    "the ssa can accommodate additional discrete events .",
    "for example , the g2/m cell cycle checkpoint which ensure proper duplication of the cell s chromosomes before division , can be modeled by defining a variable representing the completion of dna replication such that cell division is delayed until the dna content of the cell has doubled .",
    "the replication of individual genes , which doubles the maximum rate of gene transcription by doubling the number of corresponding dna templates , can be modeled as a discrete event that occurs at a fixed time @xmath33 after cell division , i.e. when @xmath34 , or as a random event that occurs with some variable probability . in both cases , the dna - replication event can be placed in a cell - specific stack of future events that is compared against @xmath27 ( or @xmath21 in the above pseudocode ) following each ssa step .",
    "events in the stack scheduled to occur before this time are then executed and removed from the stack .",
    "this can be incorporate into the above pseudocode by inserting the following two lines : +   + 8a : * if * @xmath35 * then * ( there are scheduled events ) + 8b : * if * @xmath36 * then * execute event(i ) and delete @xmath37 from stack +   + this approach also provides a convenient basis for simulating the effects of time - delays @xcite .",
    "we note that the exact ssa can be extremely computationally intensive since the step size @xmath38 becomes very small when the total number of molecules is high or the fastest reaction occurs on a time - scale that is much shorter than the time - scale of interest .",
    "it therefore useful to develop techniques that can be used to speed up the simulation .",
    "this can be done , for example , using approximate methods such as the tau - leaping procedure in which each time step @xmath38 advances the system through possibly many reaction events @xcite .",
    "additionally , since many independent runs are required to compute population statistics , parallel computing can be used to further optimize simulation run - times .",
    "implementations of the modified ssa that track only one of the two cells formed during cell division may introduce artifacts in the calculation of population characteristics in the presence of significant phenotypic variability among cells .",
    "for example , gene expression capacity and division time may depend on chronological age ; old cells may express genes at a reduced rate , and daughter cells may need to mature before they can reproduce .",
    "in addition , reproductive rates may be influenced by the accumulation of genetic mutations within a specific cell lineage or by the current levels of gene expression within individual cells .",
    "to simulate stochastic models of gene expression incorporating such features , it is necessary to couple the ssa with simulation techniques used in studies of population dynamics .",
    "the population balance equation ( pbe ) is a mathematical statement of continuity that accounts for all the processes that generate and remove particles from a system of interest @xcite , including individual members of a population @xcite . in a general molecular - dynamics framework ,",
    "the pbe contains terms due to nucleation , coagulation and fragmentation , and so forth , and is mathematically represented by an integro - differential equation that typically must be solved numerically to obtain particle size distribution and densities as a function of time @xcite . due to the integro - differential nature of the problem , discretization of the size distribution",
    "is required .",
    "this is problematic because features of the distribution are not known ahead of time and may change during growth @xcite . to resolve discretization problems that hinder the direct integration of the pbe",
    ", one can use mc methods to sample a finite subset of a system in order to infer its properties and study finite - size effects , spatial correlations , and local fluctuations not captured by a mean field approximation @xcite .",
    "furthermore , a mc method is appropriate as its discrete nature adapts itself naturally to growth processes involving discrete events , and can simulate growth over arbitrary long times with finite numbers of simulation particles while maintaining constant statistical accuracy  @xcite .    in order to construct a reliable and efficient algorithm to simulate biological cell populations ,",
    "a constant - number mc method is adopted to simulate the birth - death processes that take place within such populations @xcite .",
    "this approach permits modeling of growing populations using a fixed number of cells while avoiding the alternative ( i.e. an infinitely growing population ) by sampling @xmath39 particles representing the population as a whole",
    ". it essentially amounts to contracting the physical volume represented by the simulation to continuously maintain a constant number of cells @xcite .",
    "the constant - number mc approach has been successfully applied to a variety of non - biological particulate processes @xcite as well as cell population dynamics @xcite .    in our implementation of the constant - number mc , we keep track of individual mother and daughter cells in two separate arrays .",
    "each time a cell divides , the daughter cell is placed in the daughter array and the time of birth recorded .",
    "then , at specified intervals , cells within the mother array are replaced one at a time , with the oldest daughter cells being inserted first .",
    "because every mother cell is equally likely to be replaced during the sample update , the size distribution of the population remains intact for sufficiently large populations   @xcite . in our case",
    ", the size distribution corresponds to the distribution of cell ages ( or volumes ) across the population .",
    "the constant - number mc method can be represented by the following pseudocode : +    randomly select mother cell replace mother cell with oldest available daughter cell    here , @xmath40 is the interval between population updates and @xmath41 the number of daughter cells born since the last update . to avoid simulating the daughters of daughter cells , @xmath40",
    "is chosen such that mother cells divide at most once , and daughter cells not at all , during a particular @xmath42 interval .",
    "simulations are carried out using an initial population distribution , where gene expression in each cell is described by a user defined set of equations , and population statistics are obtained at a specified sampling interval . here , stochastic simulation is carried out using the gillespie direct method @xcite , however any stochastic simulation method can be implemented .",
    "parallelism is implemented across the simulation ( see fig .",
    "[ flowchart ] and pseudocode in this section ) , as a large number of independent simulations need to be performed when simulating the dynamics of a cell population , in a shared memory multiprocessor environment .",
    "the algorithm can be expressed by the flow diagram ( fig .",
    "[ flowchart ] ) and the following pseudocode : +    _ begin parallel region _",
    "gillespie ssa ( see pseudocode in section 2 ) update @xmath43 execute events in stack with @xmath44 execute cell division increment @xmath41 update @xmath45 _ end parallel region _ execute constant - number mc ( see pseudocode in section 3 ) compute statistics    here , @xmath46 is the total number of cells in the population , @xmath43 the volume of cell @xmath24 , and @xmath45 the user defined population sampling interval .",
    "the algorithm can execute simulations of considerable size in reasonable times .",
    "for example , an ibm with 2 quad - core processors ( 1.86ghz cores ) and 2.0 gb of ram completed a @xmath47 simulation of the network presented in section  [ tdpds ] for 8000 cells in @xmath48 when @xmath49 , @xmath50 , @xmath51 , @xmath52 , @xmath53 , and @xmath54 .",
    "in order to evaluate the accuracy of the present algorithm , we compare simulation results to steady - state and time - dependent analytical solutions of constitutive gene expression models . in this section ,",
    "models describing increasingly realistic biological features are considered and presented along with the derivations of the corresponding analytical solutions .",
    "we have included these details to emphasize the significant complexity associated with the derivation of even simple kinetic models .",
    "part of our motivation for developing the algorithm is the anticipation that finding analytical solutions to models incorporating complex biochemical reaction network and cellular physiology will be intractable .",
    "we begin in subsection 5.1 by considering time - dependent gene expression , i.e. , the transcription of rna and translation of rna into protein , and benchmark this scenario against the corresponding time - dependent analytical distributions . in subsection 5.2",
    "we consider both time - dependent and time - independent gene expression using a model that incorporates the effects of gene duplication and cell division on gene expression dynamics in individual cells using the constant - number mc method .",
    "all simulations statistics were obtained from populations consisting of 8000 cells .",
    "population - based simulation algorithms have the advantage of yielding time - dependent population - distributions as the output . to evaluate the accuracy of our approach in this respect , validation against a time - dependent distribution is of interest . for this purpose",
    ", we simulate a two - stage gene expression model consisting of the following biochemical reactions : @xmath55 where eq .",
    "( [ distr_eq1 ] ) describes transcription at a rate @xmath56 , eq .",
    "( [ distr_eq2 ] ) the degradation of the mrna at a rate @xmath57 , eq .",
    "( [ distr_eq3 ] ) translation at a rate @xmath58 , and eq .  ( [ distr_eq4 ] ) the protein degradation at a rate @xmath59 . here",
    ", all rates are given in probability per unit time and it is assumed that the promoter @xmath60 is always active and thus the model has two stochastic variables , the number of mrnas and the number of proteins @xmath61 .",
    "shahrezaei and swain @xcite studied the system described by eqs .",
    "( [ distr_eq1])-([distr_eq4 ] ) and derived an approximative protein distribution as a function of time .",
    "the approximation is based on the assumption that the degradation of mrna is fast compared to the degradation of proteins ( i.e. @xmath62 ) .",
    "consequently , the dynamics of mrna is at the steady - state for the most of a protein s lifetime .",
    "the essential steps of the derivation are as follows ( see supplementary materials in @xcite for the complete derivation ) :    the chemical master equation ( cme ) describing the probability of having @xmath63 mrnas and @xmath64 proteins for the system in eqs .",
    "( [ distr_eq1]-[distr_eq4 ] ) at time @xmath21 is given by @xmath65 \\nonumber \\\\ & & { } + d_{1}[(n+1)p_{m , n+1}-np_{m , n } ] .",
    "\\nonumber\\end{aligned}\\ ] ] if we let @xmath66 and @xmath67 , the corresponding generating function @xmath68 , defined in @xcite as @xmath69 , is given by @xmath70\\frac{\\partial f }   { \\partial u } = a\\frac{u}{v}f,\\ ] ] where @xmath71 , @xmath72 , @xmath73 , and @xmath74 .",
    "if @xmath75 measures the distance along a characteristic , which starts at @xmath76 with @xmath77 and @xmath78 for some constants @xmath79 and @xmath56 , then from eq .",
    "[ sec5.1mgf ] it is found that @xmath80\\ ] ] using the method of characteristics .",
    "consequently direct integration implies that @xmath81 and eq .",
    "[ sec5.1eqn1 ] has the solution @xmath82\\ ] ] for a constant @xmath83 . by taylor expansion of @xmath84 such that @xmath85 the integral in eq .",
    "[ sec5.1eqn2 ] can be evaluated , and , if stirling s approximation is subsequently applied , @xmath86 is found for @xmath87 to obey @xmath88 or @xmath89 as @xmath90 for @xmath91 .",
    "when @xmath87 , @xmath92 tends rapidly to a fixed function of @xmath93 and the generating function describing the distribution of proteins can be obtained from eq .",
    "[ sec5.1mgf ] @xmath94 integrating eq . [ sec5.1eqn5 ] yields the probability distribution for protein number as a function of time @xmath95^{a}.\\ ] ] by definition of a generating function , expanding @xmath96 in @xmath97 yields @xmath98^{n }           \\left[\\frac{1 + be^{-\\tau}}{1+b}\\right]^{a }           \\times\\vspace{0.5mm}_{2}f_{1}\\left[-n ,- a,1-a - n;\\frac{1+b }   { e^{\\tau } + b}\\right],\\ ] ] where @xmath99 and @xmath100 are the hypergeometric and the gamma function , respectively .",
    "the initial number of proteins @xmath64 is set to zero . in this case , the mean , variance , and protein noise of the process are described respectively by @xmath101 @xmath102 @xmath103^{1/2}.\\ ] ]    to benchmark the ability of the algorithm to accurately generate time - dependent population distributions , we simulated eqs .",
    "( [ distr_eq1])-([distr_eq4 ] ) under conditions where the assumptions of eq .",
    "( [ distr_eq5 ] ) are satisfied , and compared the resulting distributions with corresponding time - dependent analytical distributions . fig .",
    "[ swain_pop_hist ] shows the simulated and analytical distributions at two different values of dimensionless time @xmath38 .",
    "the population statistics , specifically @xmath104 and @xmath105 , as a function of @xmath38 are shown in fig .",
    "[ swain_pop_stats ] . in both cases ,",
    "the simulated protein distributions and statistics are in excellent agreement with the analytical results ( eqs .",
    "( [ distr_eq5])-([distr_eq8 ] ) ) .      to explore the accuracy of the algorithm when simulating models incorporating cell growth , division , and dna replication , we implemented the simplified reaction network presented in swain _ et al .",
    "_  @xcite .",
    "the reduced reaction network was obtained from a model of gene expression consisting of @xmath106 molecular species and @xmath107 chemical reactions . for this simplified network ,",
    "it is possible to derive time - dependent analytical results for the mean protein number and coefficient of variation in protein number .",
    "importantly , by making the appropriate approximations , the effects of gene replication and cell division can be included in the analytical solutions .",
    "the reduced model have two components - one described by the reactions in eqs .",
    "( [ distr_eq1])-([distr_eq4 ] ) ( note that the reaction rates @xmath58 and @xmath57 can be directly related to @xmath108 and @xmath109 in the original model @xcite ) , and another describing pre - transcription kinetics .",
    "this component captures the reversible binding of rnap to the promoter ( rate constants @xmath110 and @xmath111 ) , and the formation of an open promoter complex ( rate constant @xmath112 ) .",
    "these steps are described by the reactions @xmath113{f_{0}}{\\rightleftharpoons } & c                                   \\label{swain2002react1}\\\\          c                  &         \\stackrel{k_{0}}{\\longrightarrow } & d + t                       \\label{swain2002react2}\\end{aligned}\\ ] ] where @xmath114 , @xmath83 and @xmath60 represent the promoter with polymerase unbound , the promoter with polymerase bound and the open promoter complex , respectively . since the total number @xmath64 of dna molecules",
    "is conserved before and after replication , @xmath114 and @xmath83 can be constrained by @xmath115 where @xmath116 and @xmath117 are the number of promoter copies in state @xmath114 and @xmath83 respectively .    to derive an analytical solution",
    ", the authors invoked the assumption that the distributions of @xmath118 , and @xmath119 can be approximated by their steady state distributions .",
    "while this assumption thus ignores the transient dynamics of these species , it is expected to introduce a minimal error since the protein degradation rate @xmath59 is much smaller compared to the other reaction rates . as a consequence , the mean and coefficient of variation protein @xmath120 are time - dependent while the moments of the distributions of the other species are constant .",
    "even with this approximation , the derivation of the analytical solutions for the mean and coefficient of variation is rather arduous . in the following ,",
    "we highlight the only the main points ( the complete derivation can be found in the supplementary material of swain et al .",
    "it consists of three separate stages - the derivation of time - dependent expression for the population mean and noise , the incorporation of gene replication and the addition of cell division .",
    "the first stage is analogous to the derivation of time - dependent moments in section  [ tdpds ] , that is , cell cycle effects are neglected and the probability distributions for the species @xmath121 and @xmath120 is described using the cme . in this case , the variables @xmath122 , and @xmath123 are used to describe the numbers of @xmath124 and @xmath120 , respectively , and @xmath125 denotes the probability density function of the time - dependent state .",
    "the cme can be correspondingly be written in the form @xmath126 + \\cdots,\\end{aligned}\\ ] ] where dots denote similar terms , one for each rate constant .",
    "the cme is then used to derive an expression for the time - dependent probability - generating function .",
    "the probability - generating function is defined by @xmath127 it can easily be seen that differentiating @xmath128 with respect to @xmath129 and setting all @xmath129 to unity , gives @xmath130 and similarly the second derivative gives @xmath131 . applying the transformation given by eq .",
    "( [ sec5.2probgenfunc ] ) to the cme ( eq .",
    "( [ sec5.2me ] ) ) , an expression for the probability - generating function can be obtained .",
    "this expression has the form of the partial differential equation @xmath132\\frac{\\partial f}{\\partial w } + v_{0}(y - x )   \\frac{\\partial f}{\\partial x}\\nonumber \\\\          & & + \\left[v_{1}'z(1+y ) - d_{0}'y\\right]\\frac{\\partial f}{\\partial y }    - d_{1}z\\frac{\\partial f}{\\partial z},\\end{aligned}\\ ] ] where @xmath133 , @xmath134 , @xmath135 , and @xmath136 .",
    "this equation , just like the cme , is practically impossible to solve .",
    "however , the equation can be combined with a second order taylor expansion of eq .",
    "( [ sec5.2probgenfunc ] ) which can be written in the form @xmath137,\\end{aligned}\\ ] ] where the expansion is taken around @xmath138 , @xmath139 , @xmath140 , @xmath141 so that the following holds : @xmath142 , @xmath143 , and @xmath144 . here",
    "it is important to note that only the processes involving protein molecules are time - dependent according to the previous assumptions .",
    "( [ sec5.2taylor ] ) is then substituted to eq .",
    "( [ sec5.2pdepgf ] ) , the coefficients are compared and solvable expressions for the expected values , variances , and covariances of the considered process are obtained .",
    "this gives equations governing the variables @xmath145 and @xmath146 @xmath147 assuming that @xmath148 , eqs .",
    "( [ sec5.2 x4 ] ) and ( [ sec5.2 x44 ] ) can be solved using expressions for the other @xmath149 variables .",
    "the expressions are rather complex and the interested reader should refer to @xcite . solving eqs .",
    "( [ sec5.2 x4 ] ) and ( [ sec5.2 x44 ] ) yields the following expressions for the protein mean and variance @xmath150   \\right ) , \\label{sec5.2protvar}\\end{aligned}\\ ] ] where @xmath151 and @xmath152.\\ ] ] note that @xmath153 is a measure of the mrna fluctuations , @xmath154 , and that @xmath155 is given by @xmath156    the effects of gene replication are incorporated in the second stage of the derivation .",
    "the number of proteins at the beginning of each cell cycle is determined by the time evolution of the system during the cycle of a parent cell . to assess the time evolution of protein molecules during the cell cycle ,",
    "the probability @xmath157 of having @xmath64 proteins at time @xmath21 , given that there were @xmath63 proteins at time @xmath158 is defined and the probability - generating function @xmath159 for this distribution is constructed . by definition ,",
    "the generating function has the form @xmath160 the equation can be expanded around @xmath161 which yields @xmath162+\\cdots\\ ] ] this function can be determined up to the necessary level by means of equations @xmath163 and @xmath164 .",
    "using eq .",
    "[ genfuncqexpand ] , it is obtained that @xmath165^m.\\ ] ] because the gene replication occurs at time @xmath166 , two different forms of @xmath167 have to be considered : @xmath168 which is valid when the gene number is @xmath64 , and @xmath169 which is valid when the gene number is @xmath170 .",
    "thus @xmath171^m,\\ ] ] where @xmath172 .",
    "now it is possible to proceed to the third stage of the derivation where cell division is included .",
    "the third stage incorporates cell division .",
    "cell division is in the model assumed to occur at fixed intervals given by the division time @xmath173 .",
    "when @xmath174 it is assumed that each protein has a 50 % probability of being kept in this cell ( symmetric division ) and the probability of having @xmath64 proteins immediately after the division is the binomial @xmath175 given that there are @xmath63 proteins just before cell division . the transfer probability from one cell cycle to another can be constructed by combining the binomial distribution with the protein distribution derived earlier ( eq .  [ sec5.2taylor ] ) .",
    "after many divisions , the protein number tends to a limit cycle and expressions for the mrna and protein mean and coefficient of variation can be obtained in the limit @xmath176 . through a fairly complicated set of steps",
    ", it can be shown @xcite that the mean mrna number before gene duplication ( @xmath177 ) , and the mrna coefficient of variation are given by @xmath178 the mean protein number and coefficient of variation in protein number as functions of time can be derived as @xmath179\\frac{d_{1}}{d_{0}'}\\phi_{1}(t ) ,   \\label{swain_theor_eq6}\\end{aligned}\\ ] ] where @xmath180 , & \\ : for    \\ ; t_{d } \\leq t \\leq t     \\end{array }     \\right.\\ ] ] and @xmath181 in eqs .",
    "( [ swain_theor_eq4and5 ] ) and ( [ swain_theor_eq7and8 ] ) , @xmath182 and @xmath60 denote the gene replication time and the cell division time , respectively .    it is noted that eqs .",
    "( [ swain_theor_eq1 ] ) and ( [ swain_theor_eq2 ] ) are time independent and that the value of the mean is twice this result after gene replication occurs ( i.e. when @xmath183 ) .",
    "the time independence follows from the assumption that the rna is in a quasi - steady state proportional to the gene copy number @xmath184 , and that all other time dependencies are absorbed into the protein distribution .",
    "our simulation results are compared to the corresponding steady - state and time - dependent analytical solutions ( figs .",
    "[ swain2_fig]- [ swain4_fig ] ) . in these simulations",
    ", we use the same assumptions as in @xcite ; the cell volume increases linearly up to time of cell division @xmath60 , gene replication occurs at @xmath185 and cell division is symmetric with binomial partitioning of molecules .",
    "simulated protein number and concentration , as well as mrna number dynamics , for single cells ( fig .",
    "[ swain2_fig ] ) are comparable with the simulation results obtained by swain _",
    "et al . _",
    ". figures [ swain3_fig ] and [ swain4_fig ] further compare population characteristics estimated from simulations to those predicted by the corresponding steady - state analytical solutions .",
    "both rna ( @xmath186 and @xmath187 , fig .",
    "[ swain3_fig ] ) and protein ( @xmath163 and @xmath188 , fig .",
    "[ swain4_fig ] ) characteristics are in good agreement with the analytical results ( eqs .",
    "( [ swain_theor_eq1])-([swain_theor_eq7and8 ] ) ) .",
    "to investigate sources of external variability in eukaryotic gene expression , volfson _",
    "et al . _",
    "@xcite combined computational modelling with fluorescence data . as part of this study",
    ", the authors simulated the distribution of cell sizes within a population of _ saccharomyces cerevisiae _ ( budding yeast ) . in these simulations ,",
    "cells grew exponentially until they reached a critical volume @xmath189 where they divide .",
    "the volume at division was drawn from a normal distribution with a mean specified as a function of genealogical age and coefficient of variation 0.15 .",
    "following division , the mother cell retained 70 % of the volume ( @xmath190 ) while daughter cells were correspondingly smaller ( @xmath191 ) .",
    "the resulting distribution of cell sizes obtained from an initial population of @xmath192 cells allowed to grow to @xmath193 cells was found to be in agreement with experimental and analytical results @xcite .    the model by volfson _",
    "et al . _",
    "@xcite is ideally suited for benchmarking the constant - number mc method . as in volfson _",
    "et al . _",
    "@xcite , we first simulated the growth of a population initially consisting of @xmath192 cells and obtained the steady - state size distribution once the population grew to @xmath193 cells ( fig .",
    "[ cnmc_fig]a ) .",
    "next , we repeated the simulations using the constant - number mc method to estimate the size distribution from a representative sample ( @xmath194 cells ) of this cell population ( fig .",
    "[ cnmc_fig]b ) .",
    "a plot of the probabilities for the sample population against the probabilities of the ` true ' population shows that the difference between these variables is minimal ( fig .",
    "[ cnmc_fig]c ) .",
    "these results compliment previous studies @xcite demonstrating the ability of the constant - number mc method to capture complex population dynamics .",
    "one of the most interesting potential applications of the simulation algorithm described in section  [ sec : algorithm ] is investigations of interactions between environmental changes , population dynamics and gene expression in individual cells .",
    "for example , it can be used to study the optimization of fitness in fluctuating environments , which is a classic problem in evolutionary and population biology @xcite .",
    "et al . _",
    "@xcite experimentally investigated how stochastic switching between phenotypes in changing environments affected growth rates in fast and slow - switching populations by using the galactose utilization network in _",
    "saccharomyces cerevisiae_. specifically , a strain was engineered to randomly transition between two phenotypes ( @xmath195 and @xmath196 ) characterized by high or low expression of a gene encoding the ura3 enzyme necessary for uracil biosynthesis .",
    "each phenotype was designed to have a growth advantage over the other in one of two environments . in the first environment ( @xmath197 ) which lacks uracil ,",
    "cells in the @xmath195 phenotype have an advantage . in the second environment ( @xmath198 ) , cells in the @xmath196 phenotype have an advantage due to the presence of a drug ( 5-foa ) which is converted into a toxin by the ura3 enzyme . in this environment , which also contains uracil",
    ", cells expressing ura3 will have low viability while cells not expression ura3 will grow normally .",
    "models of gene expression often describe the promoter @xmath60 as being in one of two states : a repressed state @xmath199 ( basal level of gene expression ) or an active state @xmath200 ( upregulated level of gene expression ) corresponding respectively to @xmath196 and @xmath195 phenotypes .",
    "this can be described by the following biochemical reaction scheme @xcite :    @xmath201    @xmath202    @xmath203    @xmath204    @xmath205    @xmath206    where eq .",
    "( [ ouden_eqa ] ) describes the transitions to the @xmath200 and @xmath199 promoter states at rates @xmath207 and @xmath208 respectively , eqs .",
    "( [ ouden_eqb ] ) and ( [ ouden_eqc ] ) the mrna production from the @xmath200 ( at a rate @xmath209 ) and @xmath199 ( at a rate @xmath210 ) states respectively , eq .",
    "( [ ouden_eqe ] ) the protein production from mrna at a rate @xmath58 , and eqs .",
    "( [ ouden_eqd ] ) and ( [ ouden_eqf ] ) respectively the mrna ( at a rate @xmath57 ) and protein ( at a rate @xmath59 ) degradation .",
    "we first follow the approach that was used in acar _",
    "et al . _",
    "@xcite to describe the dynamics of phenotype switching , where cells are in either the @xmath195 or the @xmath196 state : @xmath211 in this scenario , cells randomly switch between the high and low expressing states at rates @xmath207 and @xmath208 ( see @xcite for parameter values corresponding to slow and fast - switching cells ) .",
    "the growth rate ( eq .  ( [ growth_eq ] ) ) of fit cells was set higher than the corresponding growth rate for unfit cells in the same environment . in order to avoid synchronization in the population level dynamics , we set @xmath212 , where @xmath213 is a small random number drawn from a normal distribution with zero mean and 0.2 variance .",
    "figure [ ouden_fig ] shows the growth rates obtained from simulations of slow and fast - switching cell populations , where cells were transfered from e2 to e1 , and vice versa , at @xmath158 .",
    "growth rates show a transition period and a steady - state region . in agreement with experiments ( see acar _",
    "@xcite ) , fast - switching cells were found to recover from the effect of environment change faster than slow - switching cells but have a lower steady - state growth rate .",
    "next we implemented the full model of gene expression described by eqs .",
    "( [ ouden_eqa])-([ouden_eqf ] ) .",
    "the fitness @xmath214 of each cell @xmath24 , which is here defined as a function of the environment and cellular protein concentration @xmath215 $ ] , was described by a hill function    @xmath216^n}{[p]^n+k^n } , & \\ : if \\ ; e = e1 \\\\",
    "\\frac{k^n}{k^n+[p]^n } , & \\ : if \\ ; e = e2 .",
    "\\end{array }     \\right.\\ ] ]    this equation describes partitioning of cells into fit ( @xmath217 ) and unfit ( @xmath218 ) phenotypes corresponding to whether or not their @xmath215 $ ] in a particular environment is above or below a particular value given by the hill coefficient @xmath219 .",
    "the volume of each cell was described by eq .",
    "( [ growth_eq ] ) , except here @xmath220 , where @xmath221 is the cell division time in absence of selection . to incorporate the effect of fitness on gene expression , the value of transcription rate parameter @xmath222 depended on whether or not a cell was fit in either @xmath223 or @xmath224 ( see fig .",
    "[ ouden2_fig ] for parameters ) .",
    "the population distributions obtained for this model are shown in figure [ ouden2_fig ] .",
    "specifically , we first obtained the steady - state protein concentration distributions for cells in @xmath223 and @xmath224 ( fig .",
    "[ ouden2_fig]a and [ ouden2_fig]b respectively ) . here , the majority of cells either fell within a distribution centered at higher value characterizing the @xmath195 cells , or a distribution centered at a lower value of @xmath120 characterizing the @xmath196 cells , in @xmath223 or @xmath224 respectively .",
    "the rest of the cells fell within the distribution capturing the unfit subpopulation in both environments .",
    "these results were found experimentally in @xcite and are expected , as higher levels of the uracil enzyme are either favorable or unfavorable with respect to the fitness of the cells depending on the environment .",
    "next , the time - dependent population distributions after the transition to @xmath223 from @xmath224 , and vice versa , were obtained ( fig . [ ouden2_fig]a and [ ouden2_fig]b respectively ) . here , the dynamics of the two distinct subpopulations of cells in transition between the steady - states are visible . as time progresses after the environmental transition , less and less of the cells are in the unfit state ( @xmath195 in fig .",
    "[ ouden2_fig]a and @xmath196 in fig . [ ouden2_fig]b ) , as the cells in the more fit state ( @xmath196 in fig .",
    "[ ouden2_fig]a and @xmath195 in fig .",
    "[ ouden2_fig]b ) grow and divide at a faster rate and therefore come to dominate the population in terms of absolute numbers .",
    "we have presented a framework for the stochastic simulation of heterogeneous population dynamics .",
    "the accuracy of the method was verified by comparing simulation results of stochastic gene expression and population dynamics with corresponding steady - state and time - dependent analytical solutions and experimental results .",
    "parallel execution of the algorithm was found to significantly decrease run - times in comparison to simulations run on a single processor , and did not introduce errors in numerical results .",
    "the algorithm was also shown to be capable of simulating and capturing the dynamics of a cell population in a fluctuating environment , where phenotypic variability strongly influences gene expression dynamics .",
    "agreement between this framework and the experimental and theoretical results obtained using a deterministic reaction - rate method in acar _ et al . _",
    "@xcite , serves as a further benchmark for the proposed method .",
    "furthermore , the algorithm s ability to capture the steady - state and time - independent phenotypic distributions in this system exemplifies the utility of this approach , as these distributions can not be obtained using a deterministic framework .",
    "current cellular population simulation methods , including the present algorithm , treat the extracellular environment as homogeneous ( e.g.  the spatial - temporal concentration profile of a nutrient required for growth is held constant ) .",
    "this prohibits , for example , the inclusion of competition for a limiting resource in the present implementation .",
    "however , it is possible to model feedback between cells and their environment . the simplest approach would be to assume that the environment is constant over short time intervals .",
    "the change in total population cell volume at the end of each interval could then be used to calculate how much nutrients have been consumed and the parameters describing the environment adjusted accordingly . since the time intervals would have to be sufficiently short",
    "so that the change in concentration of the nutrient during any particular interval is negligible , the computational workload would increase substantially .",
    "the focus of future work will be on developing and benchmarking accurate and efficient augmentations that permit population simulators to handle these and other more complex scenarios .",
    "this work was supported financially by the national science and engineering research council of canada ( nserc ) , the canadian institutes of health research ( cihr ) , the academy of finland ( application number 129657 , finnish programme for centres of excellence in research 2006 - 2011 , and 124615 ) , and the tampere graduate school in information science and engineering ( tise ) .",
    "d.c . , d.f . , and m.k .",
    "developed the serial , and d.c .",
    "the parallel , versions of the algorithm ; d.c . performed the stochastic simulations ; d.c . and j.i .",
    "benchmarked the algorithm ; d.c .",
    ", m.k . , and j.i .",
    "wrote the paper ; m.k . supervised the study .",
    "mantzaris , from single - cell genetic architecture to cell population dynamics : quantitatively decomposing the effects of different population heterogeneity sources for a genetic network with positive feedback architecture , biophys .",
    "j. 92 ( 2007 ) 4271 - 4288 .",
    "the noise in mrna number is also plotted as a function of @xmath64 ( bottom ) .",
    "note that mean mrna values increase and the noise decreases after gene duplication as expected .",
    "black curves indicate analytical values @xcite and red dots simulation results .",
    ", width=529,height=377 ]     for two different values of the protein degradation parameter @xmath59 .",
    "note the increase in protein production rate and decrease in noise levels that occurs after gene duplication at @xmath227 .",
    "red dots indicate simulation results and black curves analytical values @xcite .",
    ", width=529,height=377 ]     cells .",
    "( b ) steady - state size distribution of a representative sample ( @xmath194 cells ) obtained using the constant - number monte carlo method @xcite of the ` true ' population shown in ( a ) .",
    "( c ) plot of the probabilities population shown in ( b ) against the probabilities of the population shown in ( a ) along with linear regression .",
    ", width=529,height=377 ]    .",
    "( b ) growth rates of cells transfered from e1 to e2 at @xmath158 .",
    "note that the transient before the steady - state region is shorter in ( a ) than in ( b ) , and that fast - switching cells recover faster from the environment change but slow - switching cells have a higher steady - state growth , in agreement with experimental results found in @xcite .",
    ", width=453,height=377 ]    ): @xmath228 , @xmath229 , @xmath230 , @xmath231 , @xmath232 . in e1 @xmath233 for fit cells and @xmath234 for unfit cells - vice versa in e2 .",
    "additionally @xmath221 was set to the mean doubling time ( mdt ) of @xmath235  hours for _ saccharomyces cerevisiae _ @xcite .",
    ", width=529,height=377 ]"
  ],
  "abstract_text": [
    "<S> we present an algorithm for the stochastic simulation of gene expression and heterogeneous population dynamics . </S>",
    "<S> the algorithm combines an exact method to simulate molecular - level fluctuations in single cells and a constant - number monte carlo method to simulate time - dependent statistical characteristics of growing cell populations . to benchmark performance </S>",
    "<S> , we compare simulation results with steady - state and time - dependent analytical solutions for several scenarios , including steady - state and time - dependent gene expression , and the effects on population heterogeneity of cell growth , division , and dna replication . </S>",
    "<S> this comparison demonstrates that the algorithm provides an efficient and accurate approach to simulate how complex biological features influence gene expression . </S>",
    "<S> we also use the algorithm to model gene expression dynamics within ` bet - hedging ' cell populations during their adaption to environmental stress . </S>",
    "<S> these simulations indicate that the algorithm provides a framework suitable for simulating and analyzing realistic models of heterogeneous population dynamics combining molecular - level stochastic reaction kinetics , relevant physiological details and phenotypic variability .    </S>",
    "<S> = 1    constant - number monte carlo , stochastic simulation algorithm , gene expression , heterogeneous population dynamics 87.10.mn , 87.10.rt , 87.16.yc , 87.17.ee </S>"
  ]
}