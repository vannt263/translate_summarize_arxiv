{
  "article_text": [
    "_ grid drawings _ of graphs map vertices to grid points , and edges to internally disjoint curves on the grid lines connecting their endpoints .",
    "the appropriate choice of the underlying grid is decisive for the quality and properties of the drawing . _",
    "orthogonal grids _ , where the grid lines are horizontal and vertical lines , are popular and widely used in graph drawing .",
    "their strength lies in their simple structure , their high angular resolution , and the limited number of directions .",
    "graphs admitting orthogonal grid drawings must be _ 4-planar _ , i.e. , they must be planar and have maximum degree  4 . on such grids a single edge consists of a sequence of horizontal and vertical grid segments .",
    "a transition between a horizontal and a vertical segment on an edge is called a _ bend_.",
    "a typical optimization goal is the minimization of the number of bends in the drawing , either in total or by the maximum number of bends per edge .",
    "the popularity and usefulness of orthogonal drawing have their foundations in the seminal work of tamassia  @xcite who showed that for _ plane graphs _ ,",
    "i.e. , planar graphs with a fixed embedding , a bend - minimal planar orthogonal drawing can be computed efficiently .",
    "more generally , tamassia  @xcite established the so - called topology - shape - metrics framework , abbreviated as tsm in the following , for computing orthogonal drawings of 4-planar graphs .",
    "the goal of this work is to provide a similar framework for _ ortho - radial drawings _ , which are based on ortho - radial grids rather than orthogonal grids .",
    "such drawings have applications in schematic graph layouts , e.g. , for metro maps and destination maps ; see fig .",
    "[ fig : intro : berlin ] for an example .",
    "an _ ortho - radial grid _ is formed by @xmath0 concentric circles and @xmath1 spokes , where @xmath2 .",
    "more precisely , the radii of the concentric circles are integers , and the @xmath1 spokes emanate from the center  @xmath3 of the circles such that they have uniform angular resolution ; see fig .",
    "[ fig : pre : drawing ] .",
    "we note that @xmath4 does not belong to the grid .",
    "again vertices are positioned at grid points and edges are drawn as internally disjoint chains of ( 1 ) segments of spokes and ( 2 ) arcs of concentric circles .",
    "as before , a _ bend _ is a transition between a spoke segment and an arc segment .",
    "we observe that ortho - radial drawings can also be thought of as orthogonal drawings on a cylinder ; see fig .",
    "[ fig : pre : drawing ] .",
    "edge segments that are originally drawn on spokes are parallel to the axis of the cylinder , whereas segments that are originally drawn as arcs are drawn on circles orthogonal to the axis of the cylinder .",
    "it is not hard to see that every orthogonal drawing can be transformed into an ortho - radial drawing with the same number of bends .",
    "the converse is , however , not true .",
    "it is readily seen that for example a triangle , which requires at least one bend in an orthogonal drawing , admits an ortho - radial drawing without bends , namely in the form of a circle centered at the origin .",
    "in fact , by suitably nesting triangles , one can construct graphs that have an ortho - radial drawing without bends but require a linear number of bends in any orthogonal drawing .",
    "similarly , the octahedron , which requires an edge with three bends in a planar orthogonal drawing has an ortho - radial drawing with two bends per edge ; see fig .",
    "[ fig : intro : octahedron ] .",
    "[ fig : intro : octahedron ]    [ [ related - work . ] ] related work .",
    "the case of planar orthogonal drawings is well - researched and there is a plethora of results known ; see  @xcite for a survey . here",
    ", we mention only the most recent results and those which are most strongly related to the problem we consider .",
    "a @xmath5-embedding is an orthogonal planar drawing such that each edge has at most @xmath5 bends .",
    "it is known that , with the single exception of the octahedron graph , every planar graph has a 2-embedding and that deciding the existence of a 0-embedding is @xmath6-complete @xcite .",
    "the latter in particular implies that the problem of computing a planar orthogonal drawing with the minimum number of bends is @xmath6-hard .",
    "in contrast , the existence of a 1-embedding can be tested efficiently  @xcite ; this has subsequently been generalized to a version that forces up to @xmath5 edges to have no bends in fpt time w.r.t",
    "@xmath5  @xcite , and to an optimization version that optimizes the number of bends beyond the first one on each edge  @xcite . moreover , for series - parallel graphs and graphs with maximum degree  3 an orthogonal planar drawing with the minimum number of bends can be computed efficiently  @xcite .",
    "the @xmath6-hardness of the bend minimization problem has also inspired the study of bend minimization for planar graphs with a fixed embedding . in his fundamental work tamassia",
    "@xcite showed that for plane graphs , i.e. , planar graphs with a fixed planar embedding , bend - minimal planar orthogonal drawing can be computed in polynomial time .",
    "the running time has subsequently been improved to @xmath7  @xcite .",
    "key to this result is the existence of a combinatorial description of planar orthogonal drawings of a plane graph in terms of the angle surrounding each vertex and the order and directions of bends on the edges but neglecting any kind of geometric information such as coordinates and edge lengths . in particular",
    ", this allows to efficiently compute bend - minimal orthogonal drawings of plane graphs by mapping the purely combinatorial problem of determining an orthogonal representation with the minimum number of bends to a flow problem .",
    "r0.33     in addition , there is a number of works that seek to characterize the plane graphs that can be drawn without bends . in this case",
    "an orthogonal representation essentially only describes the angles around the vertices .",
    "rahman , nishizeki and naznin  @xcite characterize the plane graphs with maximum degree  3 that admit such a drawing and rahman , nakano and nishizeki  @xcite characterize the plane graphs that admit a rectangular drawing where in addition the contour of each face is a rectangle .    in the case of ortho - radial drawings",
    "much less is known .",
    "a natural generalization of the properties of an orthogonal representation to the ortho - radial case , where the angles around the vertices and inside the faces are constrained , has turned out not be sufficient for drawability ; see fig .",
    "[ fig : intro : noteasy ] .",
    "so far characterizations of bend - free ortho - radial drawing have only been achieved for paths , cycles , and theta graphs  @xcite .",
    "for the special case of rectangular ortho - radial drawings , i.e. , every internal face is bounded by a rectangle , a characterization is known for cubic graphs  @xcite .",
    "[ [ contribution - and - outline . ] ] contribution and outline .    since deciding whether a 4-planar graph can be orthogonally drawn in the plane without any bends is @xmath6-complete  @xcite",
    ", it is not surprising that also ortho - radial bend minimization is @xmath6-hard ; see section  [ sec : bend - minimization ] .    as our main result",
    "we introduce a generalization of an orthogonal representation , which we call _ ortho - radial representation _ , that characterizes the 4-plane graphs having bend - free ortho - radial drawings ; see theorem  [ thm : repr : characterization ] .",
    "this significantly generalizes the corresponding results for paths , cycles , theta graphs  @xcite , and cubic graphs  @xcite .",
    "further , this characterization can be seen as a step towards an extension of the tsm framework for computing ortho - radial drawings that may have bends .",
    "namely , once the angles around vertices and the order and directions of bends along each edge of a graph @xmath8 have been fixed , we can replace each bend by a vertex to obtain a graph @xmath9 .",
    "the directions of bends and the angles at the vertices of @xmath8 define a unique ortho - radial representation of @xmath9 , which is valid if and only if @xmath8 admits a drawing with the specified angles and bends .",
    "thus , ortho - radial drawings can indeed be described by angles around vertices and orders and directions of bends on edges .",
    "our main result therefore implies that ortho - radial drawings can be computed by a tsm framework , i.e. , by fixing a combinatorial embedding in a first `` topology '' step , determining a description of the drawing in terms of angles and bends in a second `` shape '' step , and computing edge lengths and vertex coordinates in a final `` metrics '' step .    in the following , we disregard the `` topology '' step and",
    "assume that our input consists of a 4-planar graph with a fixed _ combinatorial embedding _",
    ", i.e. , the order of the incident edges around each vertex is fixed and additionally , one outer face and one central face are specified ; the latter shall contain the center of the drawing .",
    "we present our definition of an ortho - radial representation in section  [ sec : ortho - radial - representations ] . after introducing some basic tools based on this representation in section  [ sec : preliminaries ] , we first present in section  [ sec : characterization - rect ] a characterization for rectangular graphs , whose ortho - radial representation is such that internal faces have exactly four @xmath10 angles , while all other incident angles are @xmath11 ; i.e. , they have to be drawn as rectangles .",
    "the algorithm we use as a proof of drawability corresponds to the `` metrics '' step of an ortho - radial tsm framework .",
    "the characterization corresponds to the output of the `` shape '' step .",
    "based on that special case of 4-planar graphs , we then present the characterization and the `` metrics '' step for general 4-planar graphs in section  [ sec : rectangulation ] .",
    "in this section we introduce basic definitions and conventions on ortho - radial drawings that we use throughout this paper . to that end , we first introduce some basic definitions .",
    "we assume that paths can not contain vertices multiple times but cycles can , i.e. all paths are simple . we always consider cycles that are directed clockwise , so that their interior is locally to the right of the cycle .",
    "a cycle is part of its interior and its exterior .    for a path @xmath12 and vertices @xmath13 and @xmath14 on @xmath12",
    ", we denote the subpath of @xmath12 from @xmath13 to @xmath14 ( including these vertices ) by @xmath15}}$ ] .",
    "we may also specify the first and last edge instead and write , e.g. , @xmath16}}$ ] for edges @xmath17 and @xmath18 on @xmath12 .",
    "we denote the concatenation of two paths @xmath12 and @xmath19 by @xmath20 . for any path @xmath21",
    ", we define its reverse @xmath22 . for a cycle",
    "@xmath23 that contains any edge at most once ( e.g.  if @xmath23 is simple ) , we extend the notion of subpaths as follows : for two edges @xmath17 and @xmath18 on @xmath23 , the subpath @xmath24}}$ ] is the unique path on @xmath23 that starts with @xmath17 and ends with @xmath18 .",
    "if the start vertex @xmath14 of @xmath17 identifies @xmath17 uniquely , i.e. , @xmath23 contains @xmath14 exactly once , we may write @xmath25}}$ ] to describe the path on @xmath23 from @xmath14 to @xmath18 . analogously , we may identify @xmath18 with its endpoint if this is unambiguous .",
    "we are now ready to introduce concepts of ortho - radial drawings .",
    "we are given a @xmath26-planar graph @xmath27 with fixed embedding .",
    "we refer to the directed edge from @xmath13 to @xmath14 by @xmath28 .",
    "consider an ortho - radial drawing  @xmath29 of @xmath8 . recall that we allow no bends on edges .",
    "in @xmath29 a directed edge  @xmath17 is either drawn clockwise , counter - clockwise , towards the center or away from the center ; see fig .  [",
    "fig : pre : drawing ] . using the metaphor of drawing @xmath8 on a cylinder ,",
    "we say that @xmath17 points _ right _ , _ left _ , _ down _ or _ up _ , respectively .",
    "edges pointing left or right are _ horizontal _ edges and edges pointing up or down are _ vertical _ edges .",
    "there are two fundamentally different ways of drawing a simple cycle  @xmath23 : the center of the grid may lie in the interior or the exterior of @xmath23 . in the former case",
    "@xmath23 is _ essential _ and in the latter case it is _ non - essential_. in fig .",
    "[ fig : pre : drawing ] the red cycle is essential and the blue cycle is non - essential .",
    "we further observe that  @xmath29 has two special faces : one unbounded face , called the _ outer face _ , and the _ central face _ containing the center of the drawing .",
    "these two faces are equal if and only if @xmath29 contains no essential cycles .",
    "all other faces of @xmath8 are called _",
    "regular_. ortho - radial drawings without essential cycles are equivalent to orthogonal drawings  @xcite .",
    "that is , any such ortho - radial drawing can be transformed to an orthogonal drawing of the same graph with the same outer face and vice versa .",
    "we represent a face as a cycle @xmath30 in which the interior of the face lies locally to the right of  @xmath30 . note that @xmath30 may not be simple since cut vertices may appear multiple times on @xmath30 . but no directed edge is used twice by @xmath30 .",
    "therefore , the notation of subpaths of cycles applies to faces .",
    "note furthermore that the cycle bounding the outer face of a graph is directed counter - clockwise , whereas all other faces are bounded by cycles directed clockwise .",
    "a face  @xmath30 in @xmath29 is a _ rectangle _ if and only if its boundary does not make any left turns .",
    "that is , if @xmath30 is a regular face , there are exactly @xmath26 right turns , and if @xmath30 is the central or the outer face , there are no turns at all .",
    "note that by this definition @xmath30 can not be a rectangle if it is both the outer and the central face .",
    "in this section , we define ortho - radial representations .",
    "these are a tool to describe the ortho - radial drawing of a graph without fixing any edge lengths . as mentioned in the introduction , they are an analogon to orthogonal representations in the tsm framework .",
    "we observe all directions of all edges being fixed once all angles around vertices are fixed .    for two edges @xmath28 and @xmath31 that enclose the angle  @xmath32 at @xmath14 ( such that the angle measured lies locally to the right of @xmath33 ) , we define the rotation  @xmath34 .",
    "we note that the rotation is 1 if there is a right turn at @xmath14 , @xmath35 if @xmath33 is straight , and @xmath36 if a left turn occurs at @xmath14 . if @xmath37 , it is @xmath38 .",
    "we define the rotation of a path @xmath21 as the sum of the rotations at its internal vertices , i.e. , @xmath39 similarly , for a cycle @xmath40 , its rotation is the sum of the rotations at all its vertices ( where we define @xmath41 ) , i.e. , @xmath42    when splitting a path at an edge , the sum of the rotations of the two parts is equal to the rotation of the whole path .",
    "[ obs : rot_splitting_path ] let @xmath12 be a simple path with start vertex @xmath43 and end vertex @xmath44 .",
    "for all edges @xmath17 on @xmath12 it holds that @xmath45 } } ) + \\operatorname{rot}({\\ensuremath{p[e , t]}})$ ] .",
    "furthermore , reversing a path changes all left turns to right turns and vice versa .",
    "hence , the sign of the rotation is flipped .",
    "[ obs : rot_reverse ] for any path  @xmath12 it holds @xmath46 .    the next observation analyzes _ detours _",
    "; see also figure  [ fig : pre : rot_path_detour ] .",
    "[ fig : pre : rot_path_detour ]    [ obs : pre : rot_path_detour ] let @xmath12 be a path from @xmath14 to @xmath47 and @xmath48 an edge not on @xmath12 such that @xmath49 is an internal vertex of @xmath12 .",
    "if @xmath48 lies locally to the left of @xmath12 , @xmath50}}{+}xy\\right ) + \\operatorname{rot}\\left(yx+{\\ensuremath{p[x , w]}}\\right ) = \\operatorname{rot}\\left(p\\right ) - 2 .",
    "$ ] further , if @xmath48 lies locally to the right of @xmath12 , @xmath50}}{+}xy\\right ) + \\operatorname{rot}\\left(yx+{\\ensuremath{p[x , w]}}\\right ) = \\operatorname{rot}\\left(p\\right ) + 2 .",
    "$ ]        an _ ortho - radial representation _ of a 4-planar graph  @xmath8 consists of a list @xmath51 of pairs @xmath52 for each face @xmath30 , where @xmath17 is an edge on  @xmath30 , and @xmath53 .",
    "further , the outer face and the central face are fixed and one _ reference edge _ @xmath54 in the outer face is given , with @xmath54 oriented such that the outer face is locally to its left . by convention the reference edge is always drawn such that it points right .",
    "we interpret the fields of a pair in @xmath51 as follows : @xmath17 denotes the edge on @xmath30 directed such that @xmath30 lies to the right of @xmath17 .",
    "the field @xmath55 represents the angle inside @xmath30 from @xmath17 to the following edge in degrees . using this information we define the _ rotation _ of such a pair @xmath56 as @xmath57 .    not every ortho - radial representation also yields a valid ortho - radial drawing of a graph . in order to characterize valid ortho - radial representations we introduce _ labelings _ of essential cycles .",
    "these labelings prove to be a valuable tool to ensure that the drawings of all cycles of the graph are compatible with each other .",
    "let @xmath8 be an embedded 4-planar graph and let  @xmath58 be a reference edge of  @xmath8 .",
    "further , let @xmath23 be a simple , essential cycle in @xmath8 , and let @xmath12 be a path from @xmath43 to a vertex @xmath14 on @xmath23 .",
    "the _ labeling _",
    "@xmath59 of @xmath23 induced by @xmath12 is defined for each edge  @xmath17 on  @xmath23 by @xmath60}})$ ] ; see fig .  [",
    "fig : repr : labeling ] for an illustration .",
    "we are mostly interested in labelings that are induced by paths starting at @xmath43 and intersecting @xmath23 only at their endpoints .",
    "we call such paths _ elementary paths_.    we now introduce properties characterizing bend - free ortho - radial drawings , as we prove in theorem  [ thm : repr : characterization ] .",
    "[ def : repr : valid_representation ] an ortho - radial representation is _ valid _ , if the following conditions hold :    1 .",
    "[ cond : repr : sum_of_angles ] the angle sum of all edges around each vertex given by the @xmath55-fields is 360 . 2 .",
    "[ cond : repr : rotation_faces ] for each face @xmath30 , it is @xmath61 3 .",
    "[ cond : repr : labeling ] for each simple , essential cycle @xmath23 in @xmath8 , there is a labeling @xmath59 of @xmath23 induced by an elementary path @xmath12 such that either @xmath62 for all edges  @xmath17 of @xmath23 , or there are edges @xmath63 and @xmath64 on @xmath23 such that @xmath65 and @xmath66 .",
    "the first two conditions ensure that the angle - sums at vertices and inside the faces are correct .",
    "since the labels of neighboring edges differ by at most @xmath67 the last condition ensures that on each essential cycle with not only horizontal edges there are edges with labels @xmath67 and @xmath36 , i.e. , edges pointing up and down .",
    "this reflects the characterization of cycles  @xcite . basing all labels on the reference edge guarantees that all cycles in the graph can be drawn together consistently .    for an essential cycle",
    "@xmath23 not satisfying the last condition there are two possibilities : either all labels of edges on @xmath23 are non - negative and at least one label is positive , or all are non - positive and at least one is negative . in the former case @xmath23 is called _ decreasing _ and in the latter case it is _",
    "increasing_. we call both _ monotone _ cycles .",
    "cycles with only the label 0 are not monotone .",
    "we show that a graph with a given ortho - radial representation can be drawn if and only if the representation is valid , which yields our main result :    [ thm : repr : characterization ] a 4-plane graph admits a bend - free orthogonal drawing if and only if it admits a valid ortho - radial representation .    in the next section ,",
    "we introduce further tools based on labelings .",
    "subsequently , in section  [ sec : characterization - rect ] we prove theorem  [ thm : repr : characterization ] for rectangular graphs . in section  [ sec : rectangulation ] , we generalize the result to 4-planar graphs .",
    "in this section we study the properties of labelings in more detail to derive useful tools for proving theorem  [ thm : repr : characterization ] . throughout this section ,",
    "@xmath8 is a 4-planar graph with ortho - radial representation  @xmath68 that satisfies conditions  [ cond : repr : sum_of_angles ] and [ cond : repr : rotation_faces ] of definition  [ def : repr : valid_representation ] .",
    "further let @xmath54 be a reference edge .",
    "from condition  [ cond : repr : rotation_faces ] we obtain that the rotation of all essential cycles is 0 :    [ obs : rot_essential_cycle ] for any simple essential cycle @xmath23 of @xmath8 it is @xmath69 .",
    "an ortho - radial representation fixes the direction of all edges : for the direction of an edge @xmath17 , we consider a path  @xmath12 from the reference edge to @xmath17 including both edges .",
    "different such paths may have different rotations but we observe that these rotations differ by a multiple of 4 .",
    "an edge @xmath17 is directed right , down , left , or up , if @xmath70 is congruent to 0 , 1 , 2 , or 3 modulo 4 , respectively . if @xmath17 lies on an essential cycle  @xmath23 , we consider the label  @xmath71 induced by any path  @xmath19 instead of a path @xmath12 , as the labels are defined as rotations of such paths .",
    "note that by this definition the reference edge always points to the right .    because the rotation of essential cycles is @xmath35 by observation  [ obs : rot_essential_cycle ] , for two edges on an essential cycle we observe :    [ obs : repr : label_difference ] for any path @xmath12 and for any two edges @xmath17 and @xmath18 on a simple , essential cycle  @xmath23",
    ", it holds that @xmath72}})=\\ell^p_c(e')-\\ell^p_c(e)$ ]    we now show that two elementary paths to the same essential cycle  @xmath23 induce identical labelings of @xmath23 .",
    "two paths @xmath12 and @xmath19 from @xmath54 to vertices on @xmath23 are _ equivalent _ ( @xmath73 ) if the corresponding labelings agree on all edges of @xmath23 , i.e. , @xmath74 for every edge @xmath17 of @xmath23 .    first , we prove that two paths are equivalent if the labels for just one edge are equal .",
    "[ lem : repr : equal_label_all_equal ] let @xmath23 be a simple , essential cycle and @xmath12 and @xmath19 two paths from the endpoint of @xmath54 to vertices on  @xmath23 . if there is an edge @xmath17 on @xmath23 with @xmath74 , then @xmath75 .",
    "denote the endpoints of @xmath12 and @xmath19 on @xmath23 by @xmath76 and @xmath77 , respectively .",
    "let @xmath78 be an edge on @xmath23 such that @xmath79 , which implies by the definition of the labeling @xmath80}})=\\operatorname{rot}(e^\\star{+}q{+}{\\ensuremath{c[q , vw]}}).\\ ] ] for any edge @xmath81 on @xmath23 , we obtain @xmath82}}{+}{\\ensuremath{c[w , y]}}$ ] and @xmath83}}{+}{\\ensuremath{c[w , y]}}$ ] by adding @xmath84}}$ ] to the end of the two paths to @xmath17 .",
    "equation  [ eqn : repr : equal_labels_all_equal : first ] then implies @xmath85 if @xmath86}}$ ] ( as illustrated in fig .",
    "[ fig : repr : equal_labels_edge - after ] ) , it is @xmath87}}={\\ensuremath{c[p , vw]}}{+}{\\ensuremath{c[w , y]}}$ ] and therefore @xmath88 .",
    "otherwise , @xmath89 contains @xmath23 completely and @xmath90}})+\\operatorname{rot}(c)=\\ell^p_c(e')$ ] , since @xmath23 is essential ( i.e. , @xmath91 ) .",
    "this case is shown in fig .",
    "[ fig : repr : equal_labels_edge - on ] .",
    "analogously , we obtain @xmath92 . together with equation  [ eqn : repr : equal_labels_all_equal : second ] we obtain @xmath93 , which implies @xmath73 .        for a further useful property of labelings , we consider two paths which traverse the same cycle @xmath23 . take a cycle @xmath23 and cut it open at two vertices into two parts @xmath94 and @xmath95 and consider a path traversing @xmath23 from cut - point to cut - point ; see fig .",
    "[ fig : repr : paths_cycle ] .",
    "the path either completely includes @xmath94 or @xmath95 ; in the former case , we call the path @xmath12 , in the latter case @xmath19 .",
    "we now show that both paths have the same rotation under certain conditions .",
    "[ lem : repr : rot_paths_cycle ]    let @xmath23 be a simple cycle in @xmath8 . consider two vertices @xmath47 and @xmath49 on @xmath23 and edges @xmath96 and @xmath97 .",
    "let @xmath98}}{+}xy$ ] and @xmath99}}{+}xy$ ]",
    "[ lem : repr : rot_paths_cycle : non - essential ] if @xmath23 is a non - essential cycle and @xmath31 and @xmath48 lie in the exterior of @xmath23 , or 2 .",
    "[ lem : repr : rot_paths_cycle : essential ] if @xmath23 is an essential cycle and @xmath31 lies in the exterior of @xmath23 and @xmath48 in the interior , then it is @xmath100 .    to prove the equality ,",
    "we show in the following that @xmath101 .",
    "we first cut the paths in two parts each and analyze them separately . to this end",
    "we choose arbitrary edges @xmath17 on @xmath102}}$ ] and @xmath18 on @xmath103}}$ ] as shown in fig .",
    "[ fig : repr : paths_cycle ] . by observation  [ obs : rot_splitting_path ] , it is @xmath104 } } ) - \\operatorname{rot}({\\ensuremath{q[v , e ' ] } } ) + \\operatorname{rot}({\\ensuremath{p[e , y ] } } ) - \\operatorname{rot}({\\ensuremath{q[e ' , y ] } } ) .",
    "\\label{eqn : repr : rot_paths_cycle : split}\\end{aligned}\\ ] ]    by definition it is @xmath105}}=vw{+}{\\ensuremath{c[w , e]}}$ ] and @xmath106}}=vw{+}{\\ensuremath{{\\ensuremath{{\\mkern   1.5mu\\overline{\\mkern-1.5muc\\mkern-1.5mu}\\mkern 1.5mu}}}[w , e']}}$ ] .",
    "therefore , we can calculate that difference of the rotations as follows : @xmath107}})-\\operatorname{rot}({\\ensuremath{q[v , e ' ] } } ) & = \\operatorname{rot}({\\ensuremath{p[v , e]}})+\\operatorname{rot}({\\ensuremath{{\\ensuremath{{\\mkern   1.5mu\\overline{\\mkern-1.5muq\\mkern-1.5mu}\\mkern 1.5mu}}}[v , e ' ] } } ) \\nonumber\\\\ & = \\operatorname{rot}(vw{+}{\\ensuremath{c[w , e ] } } ) + \\operatorname{rot}({\\ensuremath{c[{\\ensuremath{{\\mkern   1.5mu\\overline{\\mkern-1.5mue'\\mkern-1.5mu}\\mkern 1.5mu}}},w]}}{+}wv ) \\nonumber\\\\ & = \\operatorname{rot}({\\ensuremath{c[{\\ensuremath{{\\mkern   1.5mu\\overline{\\mkern-1.5mue'\\mkern-1.5mu}\\mkern 1.5mu } } } , e]}})-2 \\label{eqn : repr : rot_paths_cycle : first}\\end{aligned}\\ ] ] the last equality follows from observation  [ obs : pre : rot_path_detour ] , since @xmath31 lies in the exterior of @xmath23 and therefore locally to the left of @xmath108}}$ ] . in a similar spirit one",
    "obtains an equation for the second part : @xmath109}})-\\operatorname{rot}({\\ensuremath{q[e',y]}})=\\operatorname{rot}({\\ensuremath{c[e,{\\ensuremath{{\\mkern   1.5mu\\overline{\\mkern-1.5mue'\\mkern-1.5mu}\\mkern 1.5mu } } } ] } } ) + c \\label{eqn : repr : rot_paths_cycle : second}\\ ] ] here , @xmath4 represents a constant , which depends on whether @xmath48 lies in the exterior of @xmath23 ( case  [ lem : repr : rot_paths_cycle : non - essential ] ; @xmath110 ) or in the interior ( case  [ lem : repr : rot_paths_cycle : essential ] ; @xmath111 ) .    substituting equations  [ eqn : repr : rot_paths_cycle : first ] and [ eqn : repr : rot_paths_cycle : second ] in equation  [ eqn : repr : rot_paths_cycle : split ]",
    ", we get @xmath112 } } ) + \\operatorname{rot}({\\ensuremath{c[e,{\\ensuremath{{\\mkern   1.5mu\\overline{\\mkern-1.5mue'\\mkern-1.5mu}\\mkern 1.5mu } } } ] } } ) - 2 + c.\\ ] ] note that the paths in the equation above together form the cycle  @xmath23 .",
    "hence , it is @xmath113 } } ) + \\operatorname{rot}({\\ensuremath{c[e,{\\ensuremath{{\\mkern   1.5mu\\overline{\\mkern-1.5mue'\\mkern-1.5mu}\\mkern 1.5mu } } } ] } } ) = \\operatorname{rot}(c)$ ] and the equation simplifies to @xmath114    in case [ lem : repr : rot_paths_cycle : non - essential ] the cycle @xmath23 is non - essential and therefore it is @xmath115 .",
    "moreover , we have @xmath110 . plugging these values in equation  [ eqn : repr : rot_paths_cycle : final ]",
    ", we get @xmath101 .    similarly , in case [ lem : repr : rot_paths_cycle : essential ] it is @xmath111 and @xmath91 , since @xmath23 is essential .",
    "therefore , equation  [ eqn : repr : rot_paths_cycle : final ] again gives the desired result .    applying this result repeatedly to a pair of paths ,",
    "we show that the labels of an edge  @xmath17 on an essential cycle @xmath23 induced by two elementary paths @xmath12 and @xmath19 are the same , i.e. , @xmath74 .",
    "we even prove a slightly more general result , where the paths do not need to start at the reference edge but stay between two essential cycles @xmath116 and @xmath117 ; see fig .",
    "[ fig : repr : rotation_paths_to_cycle ] .",
    "[ lem : repr : rotation_paths_to_cycle ] let @xmath116 and @xmath117 be two disjunct essential cycles such that @xmath117 lies in the interior of @xmath116 .",
    "fix an edge @xmath118 on @xmath116 and an edge @xmath119 on @xmath117 .",
    "let @xmath12 and @xmath19 be two paths starting at @xmath43 and ending at @xmath44 such that both paths lie in the interior of @xmath116 and in the exterior of @xmath117",
    ". then @xmath120 .     and @xmath19 from @xmath43 to @xmath44 , which lie between the essential cycles @xmath116 and @xmath117 . here",
    ", the cycle @xmath94 formed by @xmath102}}$ ] and @xmath121}}$ ] is non - essential . ]",
    "let @xmath5 be the number of directed edges on @xmath12 that do not lie on @xmath19 .",
    "we prove the equivalence of @xmath12 and @xmath19 by induction on @xmath5 .",
    "if @xmath122 , @xmath19 contains @xmath12 completely . since both paths have the same start and end points , @xmath12 and @xmath19 are equal .",
    "hence , the claim follows immediately .",
    "if @xmath123 , there is a first edge @xmath31 on @xmath12 such that the following edge does not lie on @xmath19 .",
    "let  @xmath49 be the first vertex on @xmath12 after @xmath47 that lies on @xmath19 and let @xmath124 be the vertex on @xmath125 that follows @xmath49 immediately .",
    "this situation is illustrated in fig .",
    "[ fig : repr : rotation_paths_to_cycle ] . as both @xmath12 and @xmath19 end at  @xmath44",
    ", these vertices always exist .",
    "consider the cycle @xmath126}}{+}{{\\ensuremath{{\\ensuremath{{\\mkern   1.5mu\\overline{\\mkern-1.5muq\\mkern-1.5mu}\\mkern 1.5mu}}}[x , w]}}}$ ] .",
    "we may assume without loss of generality that the edges of @xmath94 are directed such that the outer face lies in the exterior of @xmath94 ( otherwise we may reverse the edges and work with @xmath127 instead ) . note that @xmath128}}$ ] can not intersect @xmath94 ( except for @xmath49 ) , since the interior of @xmath102}}$ ] does not intersect @xmath19 by the definition of @xmath49 .",
    "therefore , @xmath48 lies on the same side of @xmath94 as @xmath117 .",
    "if @xmath94 is non - essential , it does not contain the central face , and hence , @xmath94 can not contain @xmath117 in its interior .",
    "thus , both @xmath31 and @xmath48 lie in the exterior of @xmath94 . by lemma  [ lem : repr : rot_paths_cycle ]",
    ", we have @xmath129}}{+}xy ) = \\operatorname{rot}(vw{+}{\\ensuremath{q[w , x]}}{+}xy)$ ] .",
    "if @xmath94 is essential , @xmath117 lies in the interior of @xmath94 .",
    "hence , @xmath31 lies in the exterior of @xmath94 and @xmath48 in its interior or boundary .",
    "lemma  [ lem : repr : rot_paths_cycle ] states that @xmath129}}{+}xy ) =      \\operatorname{rot}(vw{+}{\\ensuremath{q[w , x]}}{+}xy)$ ] .    in both cases it follows from @xmath130}}={\\ensuremath{q[s , w]}}$ ] that @xmath131}}{+}xy)=\\operatorname{rot}(rs{+}{\\ensuremath{q[s , x]}}{+}xy)$ ] . for @xmath132}}{+}{\\ensuremath{q[x , t]}}$ ]",
    "it therefore holds that @xmath133 . as @xmath134 includes the part of @xmath12 between @xmath47 and @xmath49 it misses fewer edges from @xmath12 than @xmath19 does",
    "hence , the induction hypothesis implies @xmath135 , and thus @xmath120 .",
    "combining lemma  [ lem : repr : rotation_paths_to_cycle ] and lemma  [ lem : repr : equal_label_all_equal ] we show that labelings induced by elementary paths are equal .",
    "[ lem : repr : equivalence_pseudo_elementary_paths ] let @xmath23 be an essential cycle in @xmath8 and let @xmath58 .",
    "if @xmath12 and @xmath19 are paths from @xmath43 to vertices on @xmath23 such that @xmath12 and @xmath19 lie in the exterior of @xmath23 , they are equivalent .",
    "first assume that one of the paths , say @xmath19 , is elementary .",
    "let @xmath76 and @xmath77 be the endpoints of @xmath12 and @xmath19 , respectively .",
    "let @xmath14 be the vertex following @xmath76 on @xmath23 when @xmath23 is directed such that the central face lies in its interior .",
    "we define @xmath136}}$ ] .",
    "it is easy to verify that both @xmath12 and @xmath134 are paths and lie in the exterior of @xmath23 .",
    "therefore , it follows from lemma  [ lem : repr : rotation_paths_to_cycle ] that @xmath137 thus , @xmath12 and @xmath19 are equivalent by lemma  [ lem : repr : equal_label_all_equal ] .",
    "if neither @xmath12 nor @xmath19 are elementary , choose any elementary path  @xmath138 to a vertex on @xmath23 .",
    "the argument above shows that @xmath139 and @xmath140 , and thus @xmath73 .    in the remainder of this section",
    "all labelings are induced by elementary paths . by lemma  [ lem : repr : equivalence_pseudo_elementary_paths ] ,",
    "the labelings are independent of the choice of the elementary path .",
    "hence , we drop the superscript @xmath12 and write @xmath141 for the labeling of an edge @xmath17 on an essential cycle  @xmath23 .",
    "if an edge @xmath17 lies on two simple , essential cycles @xmath116 and @xmath117 , the labels @xmath142 and @xmath143 may not be equal in general . in fig .",
    "[ fig : repr : intersection_cycles - complete ] the labels of the edge @xmath17 are different for @xmath116 and @xmath117 respectively , but @xmath18 has label  @xmath35 on both cycles .",
    "note that @xmath18 is incident to the central face of @xmath144 .",
    "we now show that this is a sufficient condition for the equality of the labels .",
    "[ lem : repr : equal_labels_at_intersection ]    let @xmath116 and @xmath117 be two essential cycles and let @xmath145 be the subgraph of @xmath8 formed by these two cycles .",
    "let @xmath14 be a common vertex of @xmath116 and @xmath117 on the central face of @xmath146 and consider the edge @xmath31 on @xmath116 . denote the vertices before @xmath14 on @xmath116 and @xmath117 by @xmath147 and @xmath148 , respectively",
    ". then @xmath149 .",
    "further , if @xmath31 belongs to both @xmath116 and @xmath117 , the labels of @xmath17 are equal , i.e. , @xmath150 .",
    "first assume that not only @xmath14 but the whole edge @xmath31 lies on the central face of @xmath146 .",
    "let @xmath23 be the cycle bounding the central face of @xmath144 .",
    "let @xmath12 and @xmath19 be elementary paths from the endpoint  @xmath43 of the reference edge to vertices @xmath151 and @xmath152 on @xmath116 and @xmath117 , respectively .",
    "define @xmath153}}$ ] and @xmath154}}$ ] .",
    "the paths @xmath89 and @xmath134 lie in the exterior of @xmath23 .",
    "thus , lemma  [ lem : repr : rotation_paths_to_cycle ] can be applied to @xmath89 and @xmath134 : @xmath155 by the definition of labelings it is @xmath156 and @xmath157 .",
    "substitution into the previous equation give the desired result : @xmath158    if @xmath31 does not lie on the central face , then the edge @xmath159 on @xmath117 does lie on the central face , where @xmath160 denotes the vertex on @xmath117 after @xmath14 . by the argument",
    "above we have @xmath161 since @xmath31 lies locally to the left of both @xmath162 and @xmath163 , it is @xmath164 for @xmath165 and the same constant @xmath166 , which is either @xmath67 or @xmath167 .",
    "hence , we get @xmath168 canceling @xmath166 on both sides gives the desired result .",
    "if @xmath31 lies on both @xmath116 and @xmath117 , observation  [ obs : repr : label_difference ] shows @xmath169 and @xmath170 .",
    "hence , the result above can be simplified to @xmath171 .",
    "intuitively , positive labels can often be interpreted as going downwards and negative labels as going upwards . in fig .",
    "[ fig : repr : intersection_cycles - c1 ] all edges of @xmath172}}$ ] have positive labels and in total the @xmath124-coordinate decreases along this path , i.e. , the @xmath124-coordinate of @xmath14 is greater than the @xmath124-coordinate of @xmath47 .    using this intuition , we expect that a path  @xmath12 going down can not intersect a path  @xmath19 going up such that @xmath12 starts below @xmath19 and ends above it . in lemma",
    "[ lem : repr : illegal_intersection ] , we show that this assumption is correct if we restrict ourselves to intersections on the central face .",
    "[ lem : repr : illegal_intersection ]    let @xmath23 and @xmath94 be two simple , essential cycles in @xmath8 sharing at least one vertex .",
    "let @xmath146 be the subgraph of @xmath8 composed of the two cycles @xmath23 and @xmath94 and denote the central face of @xmath146 by @xmath30 .",
    "take subpaths @xmath33 of @xmath23 and @xmath173 of @xmath94 with the same vertex  @xmath14 in the middle , which also lies on @xmath30 .    1 .",
    "[ lem : repr : illegal_intersection - in ] if @xmath174 and @xmath175 , @xmath176 lies in the interior of @xmath23 .",
    "[ lem : repr : illegal_intersection - out ] if @xmath177 and @xmath178 , @xmath179 lies in the exterior of @xmath23 .",
    "case [ lem : repr : illegal_intersection - in ] . since the central face  @xmath30 lies in the interior of both @xmath23 and @xmath94 and @xmath14 on the boundary of @xmath30 , one of the edges @xmath31 and @xmath179 lies on @xmath30 .",
    "we denote this edge by @xmath180 and it is either @xmath181 ( as in fig .",
    "[ fig : repr : illegal_intersection - in ] ) or @xmath182 . by the lemma  [ lem : repr : equal_labels_at_intersection ]",
    ", we have @xmath183 . applying @xmath184 and @xmath175",
    ", we obtain @xmath185 .",
    "therefore , @xmath176 lies to the right of or on @xmath186 and thus in the interior of @xmath23 .",
    "case [ lem : repr : illegal_intersection - out ] .",
    "assume that @xmath179 does not lie in the exterior of @xmath23 , that is , @xmath179 lies locally to the right of @xmath33 .",
    "therefore , @xmath179 lies on @xmath30 , and lemma  [ lem : repr : equal_labels_at_intersection ] implies that @xmath187 since @xmath179 lies locally to the right of @xmath33 , it is @xmath188 and therefore @xmath189 here , the last equality follows from observation  [ obs : repr : label_difference ] . but this contradicts the assumption @xmath177 .",
    "hence , @xmath179 must lie in the exterior of @xmath23 .    for the correctnes proof in section  [ sec :",
    "rectangulation ] , a crucial insight is that for cycles using an edge which is part of a face , we can find an alternative cycle without this edge in a way that preserves labels on the common subpath :    [ lem : rect : existence_c ] if an edge @xmath17 belongs to both a simple essential cycle  @xmath23 and a regular face  @xmath190 with @xmath191 , then there is a simple essential cycle  @xmath94 not containing @xmath17 such that @xmath94 can be decomposed into two paths @xmath12 and @xmath19 , where @xmath12 or @xmath192 lies on @xmath190 and @xmath193 .",
    "consider the graph @xmath194 composed of the essential cycle @xmath23 and the regular face  @xmath190 . in @xmath146 the edge @xmath17 can not lie on both the outer and the central face .",
    "if @xmath17 does not lie on the outer face , we define @xmath94 as the cycle bounding the outer face but directed such that it contains the center in its interior ( see fig .",
    "[ fig : rect : existence_c-outer ] ) .",
    "otherwise , @xmath94 denotes the cycle bounding the central , which is illustrated in fig .",
    "[ fig : rect : existence_c-center ] .    since @xmath23 lies in the exterior of @xmath190 , the intersection of @xmath23 with @xmath94 forms one contiguous path  @xmath19 . setting @xmath195 yields a path that lies completely on @xmath190 ( it is possible though that @xmath12 and @xmath190 are directed differently ) .    using this lemma",
    ", we construct an essential cycle @xmath94 without the new edge @xmath196 from an essential cycle  @xmath23 including @xmath196 . also , @xmath23 and",
    "@xmath94 have a common path  @xmath12 lying on the central face of @xmath197 .",
    "thus , lemma  [ lem : repr : equal_labels_at_intersection ] implies labelings of @xmath23 and @xmath94 being equal on @xmath12 .",
    "[ cor : rect : existence_c_intersection ] for essential cycles @xmath23 , @xmath94 and the path @xmath198 from lemma  [ lem : rect : existence_c ] , it is @xmath199 for all edges @xmath17 on @xmath12 .    for two intersecting essential cycles where all labels on one cycle are 0 , we also observe :        [ lem : rect : two_cycles_horizontal ] let @xmath23 and @xmath94 be two essential cycles that have at least one common vertex . if all edges on @xmath94 are labeled with @xmath35 , @xmath23 is neither increasing nor decreasing .",
    "the situation is illustrated in fig .",
    "[ fig : rect : horizontal_cycle ] .",
    "if the two cycles are equal , the claim clearly holds . otherwise , we show that one can find two edges on @xmath23 such that the labels of these edges have opposite signs .",
    "let @xmath31 be an edge of @xmath23 but not of @xmath94 such that @xmath14 lies on the central face  @xmath200 of @xmath201 , and denote the vertex before @xmath14 on @xmath94 by @xmath13 .",
    "by lemma  [ lem : repr : equal_labels_at_intersection ] it is @xmath202 the second equality follows from the assumption that @xmath203 .",
    "let @xmath124 be the first common vertex of @xmath23 and @xmath94 on the central face  @xmath200 after @xmath14 .",
    "that is , @xmath204}}$ ] is a part of one of the cycles @xmath23 and @xmath94 and intersects the other cycle only at @xmath14 and @xmath124 .",
    "we denote the vertex on @xmath23 before @xmath124 by @xmath49 and the vertex after @xmath124 on @xmath94 by @xmath205 .",
    "again by lemma  [ lem : repr : equal_labels_at_intersection ] we have @xmath206 by construction @xmath31 and @xmath48 lie on the same side of @xmath94 .",
    "hence , @xmath33 and @xmath207 both make a right turn if @xmath31 and @xmath48 lie in the interior of @xmath94 and a left turn otherwise .",
    "thus , it is @xmath208 , and equations  [ eqn : rect : two_cycles_horizontal : vw ] and [ eqn : rect : two_cycles_horizontal : xy ] imply that @xmath209 and @xmath210 have opposite signs .",
    "hence , @xmath23 is neither in-  nor decreasing .",
    "in this section , we prove theorem  [ thm : repr : characterization ] for rectangular graphs .",
    "a _ rectangular graph _ is a graph together with an ortho - radial representation in which every face is a rectangle .",
    "we define two flow networks that assign consistent lengths to the graph s edges , one for the vertical and one for the horizontal edges .",
    "these networks are straightforward adaptions of the networks used for drawing rectangular graphs in the plane  @xcite . in the following , _ vertex",
    "_ and _ edge _ refer to the vertices and edges of the graph  @xmath8 , whereas _",
    "node _ and _ arc _ are used for the flow networks .       the network @xmath211 with nodes  @xmath212 and arcs  @xmath213 for the vertical edges contains one node for each face of @xmath8 except for the central and the outer face .",
    "all nodes have a demand of  0 . for each vertical edge @xmath17 in @xmath8 , which we assume to be directed upwards , there is an arc @xmath214 in @xmath215 , where @xmath30 is the face to the left of @xmath17 and @xmath216 the one to its right .",
    "the flow on @xmath217 has the lower bound @xmath218 and upper bound @xmath219 .",
    "an example of this flow network is shown in fig .",
    "[ fig : draw : flows - ver ] .    to obtain a drawing from a flow in @xmath215",
    ", we set the length of a vertical edge  @xmath17 to the flow on @xmath220 .",
    "the conservation of the flow at each node @xmath30 ensures that the two vertical sides of the face  @xmath30 have the same length .",
    "similarly , the network  @xmath221 assigns lengths to the radial edges . there is a node for all faces of @xmath8 , and an arc @xmath214 for every horizontal edge @xmath17 in @xmath8 , which we assume to be oriented clockwise .",
    "additionally , @xmath221 includes one arc from the outer to the central face .",
    "again , all edges require a minimum flow of 1 and have infinite capacity .",
    "the demand of all nodes is 0 .",
    "[ fig : draw : flows - hor ] shows an example of such a flow network .",
    "[ thm : rect : flows - to - drawing ] a pair of valid flows in @xmath221 and @xmath215 bijectively corresponds to a valid ortho - radial drawing of @xmath8 respecting @xmath68 .    given a feasible flow @xmath222 in @xmath215 , we set the length of each vertical edge  @xmath17 of @xmath8 to the flow @xmath223 on the arc @xmath220 that crosses @xmath17 .",
    "for each face @xmath30 of @xmath8 , the total length of its left side is equal to the total amount of flow entering @xmath30 .",
    "similarly , the length of the right side is equal to the amount of flow leaving @xmath30 .",
    "as the flow is preserved at all nodes of @xmath215 , the left and right sides of @xmath30 have the same length .",
    "similarly , one obtains the length of the radial edges from a flow in @xmath221 .",
    "similarly , given a drawing of @xmath68 , we can extract a flow in the networks . since the opposing sides of the rectangles have the same length , the flow is preserved at the nodes .",
    "moreover , all sides have length at least @xmath67 and therefore the minimum flow on all arcs is guaranteed .    using this equivalence of drawings and feasible flows ,",
    "we show the characterization of rectangular graphs .",
    "[ thm : draw : rectangle_drawing ] let @xmath27 be a plane graph with an ortho - radial representation  @xmath68 satisfying conditions  [ cond : repr : sum_of_angles ] and [ cond : repr : rotation_faces ] of definition  [ def : repr : valid_representation ] such that all faces are rectangles .",
    "let @xmath221 and @xmath215 be the flow networks as defined above .",
    "the following statements are equivalent :    1 .",
    "[ item : draw : rectangle_drawing : drawing ] there is an ortho - radial drawing of @xmath68 .",
    "[ item : draw : rectangle_drawing : set ] no @xmath224 exists such that there is an arc from @xmath225 to @xmath226 in @xmath215 but not vice versa .",
    "[ item : draw : rectangle_drawing : valid ] @xmath68 is valid .    [",
    "item : draw : rectangle_drawing : drawing ] @xmath227 [ item : draw : rectangle_drawing : valid ] : let @xmath29 be an ortho - radial drawing of @xmath8 preserving the embedding described by @xmath68 and let @xmath23 be a simple , essential cycle directed such that the center lies in its interior .",
    "our goal is to show that @xmath23 is neither an increasing nor a decreasing cycle . to this end",
    ", we construct a path @xmath12 from the reference edge to a vertex on @xmath23 such that the labeling of @xmath23 induced by @xmath12 attains both positive and negative values .    in @xmath29",
    "either all vertices of @xmath23 have the same @xmath124-coordinate , or there is a maximal subpath @xmath19 of @xmath23 whose vertices all have the maximum @xmath124-coordinate among all vertices of @xmath23 .",
    "in the first case , we may choose the endpoint  @xmath14 of the path  @xmath12 arbitrarily , whereas in the second case we select the first vertex of @xmath19 as @xmath14 .",
    "from @xmath43 to @xmath14constructed backwards by going only up or left  does not intersect the interior of @xmath23 .",
    "the rotations of the edges on @xmath12 relative to @xmath54 are 0 or 1 . ]",
    "we construct the path @xmath12 backwards ( i.e. , the construction yields @xmath192 ) as follows : starting at @xmath14 we choose the edge going upwards from @xmath14 , if it exists , or the one leading left . since all faces of @xmath8 are rectangles , at least one of these always exists .",
    "this procedure is repeated until the endpoint  @xmath43 of the reference edge is reached .",
    "an example of the constructed path is shown in fig .",
    "[ fig : draw : drawing_to_representation ]    to show that this algorithm terminates , we assume that this was not the case .",
    "as @xmath8 is finite , there must be a first time a vertex  @xmath47 is visited twice .",
    "hence , there is a cycle  @xmath94 in @xmath29 containing @xmath47 that contains only edges going left or up .",
    "as all drawable essential cycles with edges leading upwards must also have edges that go down  @xcite , all edges of @xmath94 are horizontal . by construction",
    ", there is no edge incident to a vertex of @xmath94 that leads upwards .",
    "the only cycle with this property , however , is the one enclosing the outer face , because @xmath8 is connected . but this cycle contains the reference , and therefore the algorithm halts .",
    "this not only shows that the construction of @xmath12 ends , but also that @xmath12 is a path ( i.e. , the construction does not visit a vertex twice ) .",
    "however , @xmath12 might be not elementary , since it may intersect @xmath23 multiple times ( e.g.  in fig .",
    "[ fig : draw : drawing_to_representation ] @xmath12 contains two vertices of @xmath23 : @xmath14 and @xmath49 ) . but @xmath14 has the smallest @xmath124-coordinate among all vertices of @xmath12 and the largest among those on @xmath23 .",
    "thus , no part of @xmath12 lies inside @xmath23 .",
    "hence , lemma  [ lem : repr : equivalence_pseudo_elementary_paths ] guarantees that the labeling @xmath59 induced by @xmath12 coincides with the labeling @xmath228 induced by any elementary path . to show that @xmath68 satisfies condition  [ cond : repr : labeling ] of definition  [ def : repr : valid_representation ]",
    ", we consider the labeling @xmath59 induced by @xmath12 .",
    "let @xmath229 be the vertex following @xmath14 on @xmath23 . by construction of @xmath12 ,",
    "the labeling of @xmath230 induced by @xmath12 is @xmath35 .",
    "if all edges of @xmath23 are horizontal , this implies @xmath62 for all edges @xmath17 of @xmath23 , which satisfies condition  [ cond : repr : labeling ] .",
    "otherwise , we claim that the edge @xmath231 directly before @xmath19 and the edge @xmath232 directly following @xmath19 on @xmath23 have labels @xmath36 and @xmath233 , respectively .",
    "since all edges on @xmath19 are horizontal and @xmath64 goes down , we have @xmath234}})=1 $ ] and therefore @xmath235 .",
    "similarly , @xmath236 implies that @xmath237 .",
    "[ item : draw : rectangle_drawing : set ] @xmath227 [ item : draw : rectangle_drawing : drawing ] : by lemma  [ thm : rect : flows - to - drawing ] the existence of a drawing is equivalent to the existence of feasible flows in @xmath221 and @xmath215 .",
    "we claim that @xmath221 always possesses a feasible flow . to construct a flow , note that @xmath221 without the arc from the outer face  @xmath216 to the central face  @xmath30 is a directed acyclic graph with @xmath30 as its only source and @xmath216 as its only sink . for each arc @xmath238 in @xmath221",
    "there is a directed path  @xmath239 from @xmath30 to @xmath216 via @xmath55 . adding the arc  @xmath240",
    ", we obtain the cycle  @xmath241 .",
    "letting one unit flow along each of these cycles @xmath242 and adding all flows gives the desired flow in @xmath221 . by construction ,",
    "each arc  @xmath55 lies on at least one cycle ( namely  @xmath242 ) , and hence , the minimum flow of @xmath67 on @xmath55 is satisfied .    to construct a feasible flow in @xmath215",
    "we again compose cycles of flow . in order to find a directed cycle using an arc  @xmath217",
    ", we define the set @xmath243 of all nodes @xmath244 for which there exists a directed path from @xmath216 to @xmath244 in @xmath215 . by definition",
    ", there is no arc from a vertex in @xmath243 to a vertex not in @xmath243 .",
    "as @xmath215 satisfies  [ item : draw : rectangle_drawing : set ] , @xmath243 does not have any incoming arcs either . hence ,",
    "@xmath245 and there is a directed path from @xmath216 to @xmath30 . closing this path with the arc @xmath217 results in a cycle of @xmath215 , which we denote by @xmath246 .    repeating this process for all arcs of @xmath215",
    ", we obtain the set  @xmath247 of the cycles  @xmath242 ( @xmath248 ) .",
    "we set the flow @xmath249 on each arc  @xmath55 as the number of the cycles in @xmath247 containing  @xmath55 .",
    "since @xmath55 lies on @xmath242 , the flow on @xmath55 is at least 1 .",
    "as @xmath222 is the sum of unit flows along cycles , the flow is conserved at all nodes , i.e. , the sum of the flows on incoming arcs of a node @xmath30 is equal to the flow on arcs leaving @xmath30 .",
    "therefore , @xmath222 is a feasible flow in @xmath215 .",
    "[ item : draw : rectangle_drawing : valid ] @xmath227 [ item : draw : rectangle_drawing : set ] : instead of proving this implication directly , we show the contrapositive .",
    "that is , we assume that there is a set @xmath250 of nodes in @xmath215 such that @xmath226 has no outgoing but at least one incoming arc . from this assumption",
    "we derive that @xmath68 is not valid , as we find an increasing or decreasing cycle .",
    "let @xmath251 $ ] denote the node - induced subgraph of @xmath215 induced by the set @xmath226 .",
    "without loss of generality , @xmath226 can be chosen such that @xmath251 $ ] is weakly connected",
    ". if @xmath251 $ ] is not weakly connected , at least one weakly - connected component of @xmath251 $ ] possesses an incoming arc and we can work with this component instead .    as each node of @xmath226 corresponds to a face of @xmath8 , @xmath226 can also be considered as a collection of faces of @xmath8 . to distinguish the two interpretations of @xmath226",
    ", we refer to this collection of faces by @xmath252 .",
    "our goal is to show that the innermost or the outermost boundary of @xmath252 forms a cycle in the original graph @xmath8 that has no valid labeling .     of nodes in a graph  @xmath8 such that @xmath251 $ ] has no outgoing but two incoming arcs  @xmath55 and @xmath253 .",
    "the set of faces  @xmath252 corresponding to the nodes in @xmath226 are shaded with blue .",
    "the outermost boundary of @xmath252 forms an increasing cycle  @xmath23 .",
    "the edges on this cycle with label @xmath36 are exactly those that are crossed by @xmath55 or @xmath253 .",
    "all other edges on @xmath23 are labeled with 0 .",
    "note that the edge on @xmath23 at the bottom is curved because @xmath8 does not admit an ortho - radial drawing . ]    fig .",
    "[ fig : draw : impossible_cycle ] shows an example of such a set @xmath226 of nodes . here",
    ", the arcs @xmath55 and @xmath253 lead from a node outside of @xmath226 to one in @xmath226 .",
    "these arcs cross edges on the outer boundary of @xmath252 , which point upwards .",
    "each node of @xmath226 has at least one outgoing arc , which must end at another node of  @xmath226 .",
    "hence , @xmath226 contains a cycle , and therefore @xmath252 separates the outer and the central face of @xmath8 .",
    "thus , the cycle  @xmath23 that constitutes the outermost boundary of @xmath252 , i.e. , the smallest cycle containing all faces of @xmath252 , is essential .",
    "similarly , we define @xmath94 as the cycle forming the innermost boundary of @xmath252 .    by assumption",
    "there is an arc  @xmath55 from a node entering @xmath226 from the outside .",
    "since @xmath251 $ ] is weakly connected , @xmath252 has no holes and the edge  @xmath17 crossed by @xmath55 either lies on @xmath23 or @xmath94 . in the former case @xmath17 points up whereas in the latter case @xmath17 points down .",
    "if @xmath17 lies on @xmath23 we prove in the following that @xmath23 is an increasing cycle .",
    "similarly one can show that @xmath94 is a decreasing cycle if @xmath17 lies on @xmath94 .",
    "we only present the argument for @xmath23 as the one for @xmath94 is similar .",
    "we first observe that no edge on @xmath23 is directed downwards , since the arc  @xmath220 corresponding to a downward edge  @xmath17 would lead from a node in @xmath226 to a node outside of @xmath226 .",
    "to restrict the possible labels for edges on @xmath23 , we construct an elementary path  @xmath12 from the endpoint @xmath43 of the reference edge to a vertex on @xmath23 .",
    "the construction is similar to the one we used to show that the existence of a drawing implies the validity of the representation , but this time the construction works forwards starting at  @xmath43 .",
    "if the current vertex lies on @xmath23 , the path is completed .",
    "otherwise , we append the edge going down , if it exists , or the one that goes to the right . as above one can show that this procedure produces a path  @xmath12 .",
    "it is even elementary , because we stop when a vertex on @xmath23 is reached .",
    "let @xmath14 be the endpoint of @xmath12 and @xmath47 the vertex on @xmath23 following @xmath14 . by construction ,",
    ". therefore , @xmath255 if @xmath31 points right or @xmath256 if it points up .",
    "since no edge on @xmath23 has a label that is congruent to 1 modulo 4 ( i.e. , the edge is downwards ) and the labels of neighboring edges differ by @xmath36 , @xmath35 or @xmath67 , we obtain @xmath257 for all edges @xmath258 .",
    "in particular , @xmath259 . but",
    "the edge @xmath17 crossed by the arc  @xmath55 points upwards and therefore @xmath260 . hence , @xmath23 is an increasing cycle and @xmath68 is not valid .    by @xcite an ortho - radial drawing of a graph satisfies conditions  [ cond : repr : sum_of_angles ] and  [ cond : repr : rotation_faces ] of definition  [ def : repr : valid_representation ] .",
    "therefore , theorem  [ thm : draw : rectangle_drawing ] implies the characterization of ortho - radial drawings for rectangular graphs .",
    "[ cor : draw : characterization ] a rectangular 4-plane graph admits a bend - free ortho - radial drawing if and only if its ortho - radial representation is valid .",
    "in the previous section we proved for rectangular graphs that there is an ortho - radial drawing if and only if the ortho - radial representation is valid .",
    "we extend this result to 4-planar graphs by reduction to the rectangular case . in this section",
    "we provide a high - level overview of the reduction ; a detailed proof is found in section  [ sec : rect : correctness ] .",
    "in section  [ sec : rect : algorithm ] we present an algorithm augmenting @xmath8 such that all faces become rectangles . as we show in section  [ sec : rect : correctness ] we then can apply corollary  [ cor : draw : characterization ] to show the remaining implication of theorem  [ thm : repr : characterization ] .",
    "given a graph @xmath8 and its ortho - radial representation @xmath68 as input , we present a rectangulation algorithm that augments  @xmath68 producing a graph @xmath9 with ortho - radial representation @xmath261 such that all faces except the central and outer face of @xmath261 are rectangles .",
    "moreover , we ensure that the outer and the central face of @xmath261 make no turns .",
    "let @xmath13 be a vertex that has a left turn on a face @xmath30 and @xmath31 be an edge on @xmath30 .",
    "let further @xmath44 be the vertex before @xmath13 on @xmath30 .",
    "we obtain an _ augmentation _",
    "@xmath262 from @xmath68 by splitting the edge  @xmath31 into two edges @xmath263 and @xmath264 introducing a new vertex  @xmath205 .",
    "further , we insert the edge @xmath196 in the interior of @xmath30 such that @xmath196 points in the same direction as @xmath265 . for an illustration of an augmentation see fig .",
    "[ fig : rect : insertion ] .     is connected to an arbitrary edge  @xmath48 that has label  0 and @xmath95 is connected to a new vertex on the old reference edge  @xmath118 .",
    "the edge  @xmath28 is selected as the new reference edge . ]",
    "if the central and outer faces are not rectangles , we insert triangles in both faces and suitably connect these to the original graph ; see fig .",
    "[ fig : rect : outer_central_face ] . for the central face",
    "@xmath216 we identify an edge @xmath17 on the simple cycle  @xmath23 bounding @xmath216 such that @xmath266 . since @xmath68 is valid and @xmath23 is an essential cycle , such an edge must exist .",
    "we then insert a new cycle  @xmath94 of length  3 inside @xmath216 and connect one of its vertices to a new vertex on @xmath17 . the new cycle  @xmath94 now forms the boundary of the central face.analogously , we insert into the outer face a cycle  @xmath95 of length @xmath267 which contains @xmath8 and is connected to the reference edge . in the remainder",
    "we therefore only need to consider regular faces . by definition of a rectangle ,",
    "as long as there is a regular face that is not a rectangle , there is a left turn on that face .",
    "we augment that face with an additional edge such that the left turn is resolved and no further left turns are introduced , which guarantees that the procedure of augmenting the graph terminates .",
    "we further argue that we augment the given representation in such a way that it remains valid .",
    "conditions  [ cond : repr : sum_of_angles ] and [ cond : repr : rotation_faces ] of definition  [ def : repr : valid_representation ] are easy to preserve if we choose the targets of the augmentation correctly ; the proof is analogous to the proof by tamassia  @xcite . in particular",
    ", the next observation helps us to check for these two conditions .",
    "[ obs : rect : augmentation_conditions_1_to_4 ] the representation @xmath268 satisfies conditions  [ cond : repr : sum_of_angles ] and  [ cond : repr : rotation_faces ] of definition  [ def : repr : valid_representation ] if and only if @xmath269}})=2 $ ] .",
    "we further have to check condition  [ cond : repr : labeling ] , i.e. , we need to ensure that we do not introduce monotone cycles when augmenting the graph .",
    "we now describe the approach in more detail .",
    "tamassia  @xcite shows that if there is a left turn , there also is a left turn on a face @xmath30 such that the next two turns on @xmath30 are right turns .",
    "we resolve that left turn by augmenting  @xmath8 , which we sketch in the following .",
    "let @xmath13 be the vertex at which face @xmath30 takes that left turn .",
    "let @xmath44 be the vertex before @xmath13 on @xmath30 .",
    "we differentiate two major cases , namely that @xmath265 is either vertical or horizontal .    * case 1 , @xmath265 is vertical .",
    "* let @xmath31 be the edge that appears on @xmath30 after the two right turns following the left turn at  @xmath13 .",
    "we show that creating a new vertex @xmath205 on @xmath31 and adding the edge @xmath196 ( cf . to fig .",
    "[ fig : rect : insertion - ver ] for an example ) always upholds validity ; see  section  [ sec : rect : correctness ] for details .    * case 2 , @xmath265 is horizontal .",
    "* this case is more intricate , because we may introduce decreasing or increasing cycles by augmenting the graph .",
    "[ fig : rect : insertion - hor_dec ] shows an example , where the graph does not include a descending cycle without the edge @xmath196 , but inserting @xmath196 introduces one .",
    "we therefore do not just consider @xmath262 , but @xmath270 for a set of _ candidate edges _",
    "@xmath17 : these include all edges @xmath271 on @xmath30 such that @xmath272}})=2 $ ] .",
    "hence , condition  [ cond : repr : sum_of_angles ] and condition  [ cond : repr : rotation_faces ] are satisfied by observation  [ obs : rect : augmentation_conditions_1_to_4 ] . if there is a candidate @xmath17 such that @xmath270 does not contain a monotone cycle , we are done .",
    "so assume that there is no such candidate and , furthermore , assume without loss of generality that @xmath265 points to the right .",
    "let the set of candidates be ordered as they appear on @xmath30 .",
    "we show that introducing an edge from @xmath13 to the first candidate never introduces an increasing cycle , while introducing an edge from @xmath13 to the last candidate never introduces a decreasing cycle .",
    "this also implies that there must be a consecutive pair of candidates @xmath31 and @xmath271 such that introducing an edge from @xmath13 to @xmath31 creates a decreasing cycle and introducing an edge from  @xmath13 to @xmath271 creates an increasing cycle .    in section  [ sec :",
    "rect : correctness ] we show that in that case , one of the edges @xmath273 or @xmath274 can be inserted without introducing a monotone cycle . together with observation  [ obs : rect : augmentation_conditions_1_to_4 ] , this concludes the proof that we can always remove the left turn at @xmath13 from the representation while maintaining its validity .",
    "altogether , the algorithm consists of first finding a suitable left turn in the representation , then determining which of the two cases applies and finally performing the augmentation . in particular , when augmenting the graph , we need to ensure that we do not introduce monotone cycles . checking for monotone cycles",
    "can trivially be done by testing all essential cycles . however",
    ", this may require an exponential number of tests and it is unknown whether this test can be done in polynomial time .",
    "[ fig : rect : only_horizontal ]    therefore , one might wish to avoid the insertion of horizontal edges .",
    "however , faces can be shaped in which horizontal insertions are necessary , even if one additionally searches for left turns that are preceded ( and not only followed ) by two right turns .",
    "for example , the u - shaped face in fig .",
    "[ fig : rect : only_horizontal ] only admits the insertion of new edges that point left or right .      following the proof structure outlined in the previous section",
    "we argue more detailedly that a valid augmentation always exists .",
    "we start with case 1 , in which the inserted edges is vertical and show that a valid augmentation always exists .    [",
    "lem : rect : insertion_of_vertical_edge ] let @xmath31 be the first candidate edge after @xmath13 .",
    "if the edge of @xmath30 entering @xmath13 points up or down , @xmath268 is a valid ortho - radial representation of the augmented graph @xmath275 .",
    "assume that @xmath268 contains a simple increasing or decreasing cycle @xmath23 .",
    "as @xmath68 is valid , @xmath23 must contain the new edge @xmath196 in either direction ( i.e. , @xmath196 or @xmath276 ) .",
    "let @xmath190 be the new rectangular face of @xmath275 containing @xmath13 , @xmath14 and @xmath205 , and consider the subgraph @xmath194 of @xmath275 . according to lemma  [",
    "lem : rect : existence_c ] there exists a simple essential cycle @xmath94 that does not contain @xmath196 .",
    "moreover , @xmath94 can be decomposed into paths @xmath12 and @xmath19 such that @xmath12 lies on @xmath190 and @xmath19 is a part of @xmath23 .    the goal is to show that @xmath94 is increasing or decreasing .",
    "we present a proof only for the case of increasing @xmath23 .",
    "the proof for decreasing cycles can be obtained by flipping all inequalities .",
    "for each edge @xmath17 on @xmath19 the labels @xmath141 and @xmath277 are equal by lemma  [ lem : repr : equal_labels_at_intersection ] , and hence @xmath278 . for an edge @xmath279 , there are two possible cases : @xmath17 either lies on the side of @xmath190 parallel to @xmath196 or on one of the two other sides . in the first case , the label of @xmath17 is equal to the label @xmath280 ( @xmath281 if @xmath23 contains @xmath276 instead of @xmath196 ) . in particular",
    "the label is negative .",
    "in the second case , we first note that @xmath277 is even , since @xmath17 points left or right .",
    "assume that @xmath277 was positive and therefore at least @xmath167 .",
    "then , let @xmath18 be the first edge on @xmath94 after @xmath17 that points to a different direction .",
    "such an edge exists , since otherwise @xmath94 would be an essential cycle whose edges all point to the right but they are not labeled with 0 .",
    "this edge @xmath18 lies on @xmath19 or is parallel to @xmath196 .",
    "hence , the argument above implies that @xmath282 .",
    "however , @xmath283 differs from @xmath277 by at most @xmath67 , which requires @xmath284 .",
    "therefore , @xmath277 can not be positive .",
    "we conclude that all edges of @xmath94 have a non - positive label .",
    "if all labels were @xmath35 , @xmath23 would not be an increasing cycle by lemma  [ lem : rect : two_cycles_horizontal ] .",
    "thus , there exists an edge on @xmath94 with a negative label and @xmath94 is an increasing cycle in @xmath68 .",
    "but as @xmath68 is valid , such a cycle does not exist , and therefore @xmath23 does not exist either . hence , @xmath268 is valid .    in case 2",
    "the inserted edge is horizontal .",
    "if there is a candidate @xmath17 such that @xmath285 is valid , we choose this augmentation and the left turn at @xmath13 is removed successfully .",
    "otherwise , we make use of the following structural properties . as mentioned before we assume in the following that @xmath196 points to the right ; the other case can be treated analogously .",
    "[ lem : rect : first_candidate ] let @xmath31 be the first candidate after @xmath13 .",
    "no increasing cycle exists in @xmath268 .",
    "let @xmath190 be the new rectangular face of @xmath268 containing @xmath13 , @xmath14 and @xmath205 , and assume that there is an increasing cycle @xmath23 in @xmath268 .",
    "this cycle must use either @xmath196 or @xmath276 .",
    "similar to the proof of lemma  [ lem : rect : insertion_of_vertical_edge ] , we find an increasing cycle  @xmath94 in @xmath68 , contradicting the validity of @xmath68 .    to this end , we construct the graph @xmath146 as the union of @xmath23 and @xmath190 . by lemma  [ lem : rect : existence_c ] , there exists a simple essential cycle @xmath94 without @xmath196 and @xmath276 that can be decomposed into a path @xmath12 on @xmath190 and a path @xmath286 such that all edges of @xmath19 have non - positive labels .",
    "we show in the following that the edges of @xmath12 also have non - positive labels .",
    "contains @xmath196 .",
    "there are three possibilities for edges on @xmath94 that lie not on @xmath23 : they lie on the left side of @xmath190 ( like @xmath287 ) , on the top ( like @xmath288 ) , or on the right side formed by only the edge @xmath263 . ]",
    "if @xmath23 contains @xmath196 , there are three possibilities for an edge @xmath17 of @xmath12 , which are illustrated in fig .",
    "[ fig : rect : first_candidate ] : the edge  @xmath17 lies on the left side of @xmath190 and points up , @xmath17 is parallel to @xmath196 , or @xmath289 . in the first case @xmath290 and in the second case @xmath291 .",
    "if @xmath289 , @xmath23 can not contain @xmath292 and therefore @xmath293 . then , @xmath294 . in all three cases",
    "the label of @xmath17 is at most 0 .",
    "if @xmath23 contains @xmath276 , the label of @xmath276 has to leave a remainder of 2 when it is divided by 4 since @xmath276 points to the right .",
    "as the label is also at most @xmath35 , we conclude @xmath295 .",
    "the edges of @xmath12 lie either on the left , top or right of @xmath190 .",
    "therefore , the label of any edge @xmath17 on @xmath12 differs by at most 1 from @xmath296 , and thus we get @xmath278 .    summarizing the results above",
    ", we see that all edges on @xmath94 are labeled with non - positive numbers .",
    "the case that all labels of @xmath94 are equal to 0 can be excluded , since @xmath23 would not be an increasing cycles by lemma  [ lem : rect : two_cycles_horizontal ] .",
    "hence , @xmath94 is an increasing cycle , which was already present in @xmath68 , contradicting the validity of @xmath68 .",
    "thus , no such increasing cycle  @xmath23 in @xmath268 exists .    in order to obtain a similar result for the last candidate",
    ", we give a sufficient condition for the existence of a candidate after an edge .",
    "[ lem : rect : candidate_after_small_rotation ] let @xmath30 be a regular face of @xmath8 and @xmath13 be any vertex on @xmath30 . if @xmath17 is an edge on @xmath30 such that @xmath297}})\\leq 2 $ ] , there is a candidate on @xmath298}}$ ] .    for each edge",
    "@xmath18 on @xmath30 we determine @xmath299}})$ ] . by assumption",
    ", it is @xmath300 . for the last edge @xmath301 on @xmath302}}$ ]",
    "it is @xmath303 .",
    "we use that @xmath30 is a regular face ( i.e. , @xmath304 ) and the rotation @xmath305 at the vertex @xmath13 in @xmath30 is at most 1 .",
    "when going from an edge  @xmath287 to the next edge  @xmath288 , the value assigned to these edges increases by at most 1 , i.e. , @xmath306 .",
    "therefore , there exists an edge  @xmath18 between @xmath17 and @xmath301 , i.e. , on @xmath298}}$ ] such that @xmath307 .",
    "we now show that augmenting to the last candidate does not create any decreasing cycles .",
    "[ lem : rect : last_candidate ] let @xmath31 be the last candidate before @xmath13 .",
    "no decreasing cycle exists in @xmath268 .    .",
    "the cycle @xmath23 is decreasing and it is assumed that @xmath308 . ]    the face @xmath30 is split in two parts when @xmath196 is inserted .",
    "let @xmath190 be the face containing @xmath14 and @xmath309 the one containing @xmath47 .",
    "assume that there is a simple decreasing cycle  @xmath23 in @xmath268 .",
    "then , either @xmath196 or @xmath276 lies on @xmath23 .",
    "we use a similar strategy as in the proof of lemma  [ lem : rect : insertion_of_vertical_edge ] to find a decreasing cycle in @xmath68 , which contradicts that @xmath68 is valid .",
    "consider the graph @xmath310 composed of the decreasing cycle @xmath23 and @xmath309 .",
    "lemma  [ lem : rect : existence_c ] shows that there exists an essential cycle  @xmath94 in @xmath146 that can be decomposed into a path @xmath12 on @xmath309 and @xmath311 ( see fig .",
    "[ fig : rect : last_candidate ] ) .",
    "we show in the following that @xmath94 is a decreasing cycle . but all edges of @xmath94 are already present in @xmath68 , contradicting the assumption that @xmath68 is valid . for all edges @xmath312",
    ", we have @xmath313 by corollary  [ cor : rect : existence_c_intersection ] .    to show that edges on @xmath12 also have non - negative labels , we assume this was not the case , i.e.",
    ", there is an edge @xmath314 such that @xmath308 .",
    "we present a detailed argument for the case that @xmath23 uses @xmath196 ( and not @xmath276 ) .",
    "then , @xmath12 is directed such that @xmath309 lies to the left of @xmath12 . at the end of the proof",
    ", we briefly outline how the argument can be adapted if @xmath23 uses @xmath276 .",
    "our goal is to show that there must be a candidate on @xmath30 after @xmath124 and in particular after the last candidate @xmath31a contradiction . to this end",
    ", we first assume that @xmath315 } } < 3)$ ] , which we prove later on . by lemma  [ lem :",
    "rect : candidate_after_small_rotation ] there then is a candidate on @xmath316}}$ ] . in particular",
    ", this candidate comes after @xmath31 , contradicting the assumption that @xmath31 is the last candidate .",
    "moreover , not all labels of edges on @xmath94 can be 0 , since @xmath23 would not be decreasing ( cf .",
    "lemma  [ lem : rect : two_cycles_horizontal ] ) .",
    "thus , @xmath94 is a decreasing cycle that consists solely of edges of  @xmath8 .",
    "but as @xmath68 is valid such a cycle can not exist , showing that @xmath268 contains no decreasing cycle either .",
    "it remains to show the upper bound @xmath315 } } ) < 3 $ ] .",
    "let @xmath317 and @xmath318 be the last and the first edge of @xmath19 , respectively .",
    "in order to simplify the descriptions of the paths we use below , we assume without loss of generality that @xmath317 and @xmath318 have no common endpoints .",
    "this property does not hold , only if @xmath19 has at most two edges , in which case we may subdivide an edge of @xmath19 to lengthen @xmath19 .",
    "applying lemma  [ lem : repr : rot_paths_cycle ] to @xmath319}}$ ] and @xmath320}}$ ] , we get @xmath321 } } ) = \\operatorname{rot}({\\ensuremath{c'[a , d]}}).\\ ] ] splitting the paths at @xmath196 and @xmath48 , respectively , the total rotation does not change ( cf .",
    "observation  [ obs : rot_splitting_path ] ) . @xmath322 } } )   & = \\operatorname{rot}({\\ensuremath{c[a , uz ] } } ) + \\operatorname{rot}({\\ensuremath{c[uz , d ] } } ) \\\\",
    "\\operatorname{rot}({\\ensuremath{c'[a , d ] } } ) & = \\operatorname{rot}({\\ensuremath{c'[a , xy ] } } ) + \\operatorname{rot}({\\ensuremath{c'[xy , d]}})\\end{aligned}\\ ] ] combining the previous equations gives @xmath323 } } ) + \\operatorname{rot}({\\ensuremath{c[uz , d ] } } ) - \\operatorname{rot}({\\ensuremath{c'[a , xy ] } } ) -",
    "\\operatorname{rot}({\\ensuremath{c'[xy , d ] } } ) = 0.\\ ] ] as @xmath324}}={\\ensuremath{{\\ensuremath{{\\mkern   1.5mu\\overline{\\mkern-1.5muf''\\mkern-1.5mu}\\mkern 1.5mu}}}[xy , c]}}{+}cd$ ] , we get @xmath325}})=\\operatorname{rot}({\\ensuremath{{\\ensuremath{{\\mkern   1.5mu\\overline{\\mkern-1.5muf''\\mkern-1.5mu}\\mkern 1.5mu}}}[xy , c]}}+cd ) =   -\\operatorname{rot}\\left(dc{+}{\\ensuremath{f''[c , yx]}}\\right).\\ ] ] the last equality follows from the fact that the rotation of the reverse of a path is the negative rotation of the path ( cf .  observation  [ obs : rot_reverse ] ) . applying lemma  [ lem : repr : rotation_paths_to_cycle ] to @xmath326}}$ ] and @xmath327}}{+}cd$ ] , we get @xmath328 } } ) = \\operatorname{rot}({\\ensuremath{f''[uz , c]}}+cd).\\ ] ] substituting equations  [ eqn : rect : last_candidate : cxy_d ] and [ eqn : rect : last_candidate : cuz_d ] into equation  [ eqn : rect : last_candidate : first_sum ] yields @xmath329 } } ) + \\operatorname{rot}({\\ensuremath{f''[uz , c]}}{+}cd ) -   \\operatorname{rot}({\\ensuremath{c'[a , xy ] } } ) + \\operatorname{rot}(dc{+}{\\ensuremath{f''[c , yx ] } } ) = 0.\\ ] ] note that if one joins @xmath327}}{+}cd$ ] and @xmath330}}$ ] together , the resulting path is almost @xmath331}}$ ] except for the detour via @xmath332 . observation  [ obs : pre : rot_path_detour ] therefore implies @xmath333}}{+}cd\\right ) +   \\operatorname{rot}\\left(dc{+}{\\ensuremath{f''[c , yx]}}\\right ) = \\operatorname{rot}({\\ensuremath{f''[u , yx]}})-2.\\ ] ] substituting this equality in equation  [ eqn : rect : last_candidate : second_sum ] and rearranging results in @xmath334 } } ) = 2 + \\operatorname{rot}({\\ensuremath{c'[a , xy ] } } ) -   \\operatorname{rot}({\\ensuremath{c[a , uz]}}).\\ ] ] by observation  [ obs : repr : label_difference ] the rotations on an essential cycle can be expressed as the difference of labels . here",
    ", we have @xmath335}})=\\ell_{c'}(xy)-\\ell_{c'}(ab)$ ] and @xmath336}})=\\ell_c(uz)-\\ell_c(ab)$ ] .",
    "additionally @xmath317 lies on @xmath19 , and therefore it is @xmath337 .",
    "hence , @xmath338 } } ) & = 2 +   \\ell_{c'}(xy)-\\ell_{c'}(ab)-\\ell_c(uz)+\\ell_c(ab ) \\nonumber\\\\   & = 2+\\ell_{c'}(xy)-\\ell_c(uz ) \\nonumber\\\\   & < 2.\\end{aligned}\\ ] ] by construction of @xmath268 the rotations of @xmath339}}$ ] and @xmath340}}$ ] differ by exactly 1 , i.e. , @xmath341}}=\\operatorname{rot}{\\ensuremath{f''[u , yx]}}+1<3.\\ ] ]    we assumed that @xmath23 uses @xmath196 in that direction .",
    "if @xmath276 lies on @xmath23 , a similar argument shows that @xmath94 would also be a decreasing cycle , contradicting that assumption that @xmath68 is valid .    by assumption @xmath285 contains a monotone cycle for all candidate edges @xmath17 . by lemma  [ lem : rect : first_candidate ] the augmentation for the first candidate contains a decreasing cycle and by lemma  [ lem : rect : last_candidate ] the augmentation for the last candidate has an increasing cycle .",
    "hence , there are consecutive candidates @xmath31 and @xmath271 such that @xmath268 has a decreasing cycle and @xmath342 an increasing cycle .    [",
    "lem : rect : between_decreasing_and_increasing ] let @xmath19 be the path on @xmath30 between the candidates @xmath31 and @xmath271 . then , there is a path  @xmath12 in @xmath8 containing @xmath47 , @xmath229 and @xmath13 such that the edges point to the right .",
    "more precisely , @xmath12 starts at @xmath47 or @xmath229 and ends at @xmath13 , and either @xmath19 or @xmath343 forms the first part of @xmath12 .",
    "moreover , the start vertex of @xmath12 has no incident edge to its left .     and @xmath344 at the same time .",
    "the edge @xmath196 is replaced by the path @xmath345 and @xmath344 by @xmath346 . ]",
    "let @xmath205 be the new vertex inserted in @xmath268 and @xmath347 the one in @xmath342 . since both @xmath196 and @xmath344 point to the right , there is no augmentation of @xmath68 containing both edges .",
    "we need to compare @xmath268 and @xmath342 though .",
    "therefore , we use the following construction , which models all important aspects of both representations : starting from @xmath68 we insert new vertices @xmath205 on @xmath31 and @xmath347 on @xmath271 .",
    "we connect @xmath13 and @xmath205 by a path of length 2 that points to the right and denote its internal vertex by @xmath49 .",
    "furthermore , a path of length  2 from @xmath49 via a new vertex @xmath124 to @xmath347 is added .",
    "the edge @xmath48 points down and @xmath348 to the right . in the resulting ortho - radial representation @xmath349 the edge @xmath196 is modeled by the path @xmath345 and @xmath344 by @xmath346 . the resulting construction is depicted in fig .  [",
    "fig : rect : between_structure ] .",
    "take any simple decreasing cycle in @xmath268 . as @xmath68 is valid",
    ", this cycle must contain either @xmath196 or @xmath276 .",
    "we obtain a cycle  @xmath23 in @xmath350 by replacing @xmath196 with @xmath345 ( or @xmath276 with @xmath351 ) .",
    "note that @xmath352 and @xmath353 have the same label as @xmath196 , and the labels of all other edges on the cycles stay the same .",
    "therefore , @xmath23 is a decreasing cycle .",
    "similarly , there exists a simple increasing cycle in @xmath342 , which contains @xmath344 or @xmath354 .",
    "replacing @xmath344 with @xmath346 ( or @xmath354 with @xmath355 ) we get a cycle @xmath94 in @xmath350 .",
    "note that @xmath94 might not be an increasing cycle as @xmath210 might be positive .",
    "but the labels of all other edges are at most 0 and there exists an edge with a negative label . in other words , outside of @xmath30 the cycle @xmath94 behaves exactly like an increasing cycle .    for",
    "now we assume that the original cycles use @xmath196 and @xmath344 in these directions . at the end of the proof",
    ", we shall see that this is in fact the only possibility .",
    "the proof is structured as follows : first , we show @xmath356 .",
    "this also determines the labels of @xmath23 and @xmath94 in the interior of @xmath30 . in a second step",
    ", we find that at least one of the vertices @xmath47 and @xmath229 has no incident edge to the left and the other vertex lies on both @xmath23 and @xmath94 .",
    "note that @xmath357 is possible . in this case",
    ", @xmath357 has all the properties mentioned .",
    "moreover , we prove that the path  @xmath19 on @xmath30 between @xmath47 and @xmath229 ( of length  0 if @xmath357 ) is straight and can be used as the first part of the desired path @xmath12 . from this information",
    "we can infer that there are three possibilities as shown in fig .",
    "[ fig : rect : horizontal_between ] : either @xmath357 , all edges on @xmath30 between @xmath47 and @xmath229 point right , or they all point left .",
    "finally , we show that outside of @xmath30 , the cycles @xmath23 and @xmath94 are equal . in particular , all their edges point to the right and",
    "we can use them as the second part of the desired path  @xmath12 .",
    "did not lie on the central face  @xmath200 , there would be edges @xmath317 on @xmath23 and @xmath358 on @xmath94 such that @xmath317 would lie on @xmath200 but @xmath358 does not .",
    "but as @xmath359 and @xmath360 , the edge @xmath358 would have to lie inside @xmath200 . hence , this situation does not occur . ]    to show @xmath361 , we consider the graph @xmath201 formed by the two cycles @xmath23 and @xmath94 and denote its central face by  @xmath200 . by lemma  [ lem : repr : equal_labels_at_intersection ]",
    "it suffices to show that @xmath352 lies on @xmath200 .",
    "assume for the sake of contradiction that this was not the case .",
    "then , @xmath48 , @xmath353 and @xmath348 do not lie on @xmath200 either .",
    "hence , @xmath200 is formed completely by edges in @xmath362}})\\cup   e({\\ensuremath{c'[z ' , u]}})$ ] .",
    "as @xmath23 and @xmath94 were constructed by subdividing edges of simple cycles , they are simples themselves .",
    "therefore , the edges of @xmath200 do not all belong to the same cycle .",
    "therefore , there is an edge @xmath317 on @xmath200 such that @xmath363 lies on both @xmath23 and @xmath94 but @xmath317 only belongs to @xmath23 and not to @xmath94 ( cf .",
    "[ fig : rect : between_impossible_central_face ] ) .",
    "since @xmath23 is a decreasing cycle , it is @xmath359",
    ".    moreover , let @xmath253 be the vertex before @xmath363 on @xmath94 . since @xmath94 is almost an increasing cycle , we get @xmath360 unless @xmath364 .",
    "but this is impossible since @xmath124 does not lie on @xmath200 .",
    "lemma  [ lem : repr : illegal_intersection ] therefore implies that @xmath358 lies in the interior of @xmath23 .",
    "but then @xmath317 would not lie on @xmath365 , contradicting the choice of @xmath317 .",
    "thus , @xmath352 is part of @xmath200 .    hence , lemma  [ lem : repr : equal_labels_at_intersection ] applies to @xmath352 and we obtain @xmath366 thus , @xmath367 .",
    "furthermore , we get @xmath368 .",
    "therefore , @xmath23 contains @xmath264 , because otherwise @xmath292 would be labeled with @xmath36 .",
    "similarly , we see that @xmath369 lies on @xmath94 .    as a next step",
    "we prove that one of @xmath229 and @xmath47 has no incident edge to its left and the other vertex lies on both @xmath23 and @xmath94 .",
    "this is the case if @xmath370 , since any subgraph to the left of this vertex would contain a candidate .",
    "remember that we treat degree-1 vertices as two left turns with an edge in between and this edge can be a candidate .",
    "therefore , even in the extreme case , where the subgraph to the left of @xmath370 is just one path that points left , we find a candidate  namely the leftmost endpoint of the path .",
    "if @xmath371 , @xmath30 makes either a left or a right turn at @xmath47 . if @xmath30 makes a left turn at @xmath47 , @xmath23 makes a left turn there as well .",
    "let @xmath44 be the vertex at which @xmath23 leaves @xmath30 after @xmath47 .",
    "in other words , @xmath44 is the last vertex of @xmath23 such that @xmath372}}$ ] lies on @xmath30 .",
    "all edges of @xmath30 starting at @xmath44 lie to the right of @xmath23 ( i.e. , in the interior of @xmath23 ) .",
    "this situation is illustrated in fig .",
    "[ fig : rect : between_left_turn_w ] .",
    "we show that @xmath372}}$ ] contains @xmath229 and that all edges of @xmath373}}$ ] point to the right .",
    "if @xmath372}}$ ] makes turns , the first turn can not be a left turn , since the edge following the turn would lie on @xmath23 and be labeled with @xmath36 . if the first turn is a right turn , the edge following the turn is the candidate @xmath271 .",
    "but then @xmath374 would contain the decreasing cycle @xmath375}}{+}uz'$ ] , which contradicts the choice of @xmath271 ( cf .",
    "[ fig : rect : between_left_turn_w - turn ] ) .",
    "hence , it remains the case in which @xmath372}}$ ] is straight , which is illustrated in fig .",
    "[ fig : rect : between_left_turn_w - straight ] . the edge following @xmath44 on @xmath23 must point right .",
    "therefore , @xmath30 makes a right turn at @xmath44 implying @xmath376 . in all possible cases ,",
    "@xmath229 lies on both @xmath23 and @xmath94 and the path @xmath377}}$ ] is straight and points to the right .",
    "if @xmath30 makes a right turn at @xmath47 , we consider the edge @xmath378 following this turn .",
    "@xmath379}}=\\operatorname{rot}{\\ensuremath{f[u , vw ] } } + \\operatorname{rot}(vwa ) = 2 + 1=3\\ ] ] since @xmath271 is a candidate , it is @xmath380 } } ) = 2 $ ] . when walking along @xmath30 the rotation changes by at most  1 per step , since degree-1 vertices are treated as two steps .",
    "hence , the rotations of all the edges between @xmath31 and @xmath271 must be at least @xmath267 .",
    "otherwise , there would be another candidate in between .",
    "therefore , @xmath30 makes a left turn at  @xmath229 .     makes a right turn at @xmath47",
    ", it makes a left turn at @xmath229 .",
    "the longest common path @xmath381}}$ ] on @xmath94 and @xmath382 contains @xmath47 and all its edges point to the right . ]",
    "as @xmath94 enters @xmath229 on the edge @xmath369 from below , @xmath94 must leave @xmath229 to the right .",
    "thus , there is a part of @xmath94 starting at @xmath229 that lies on @xmath382 .",
    "let @xmath44 be the last vertex on @xmath94 such that @xmath383}}={\\ensuremath{{\\ensuremath{{\\mkern   1.5mu\\overline{\\mkern-1.5muf\\mkern-1.5mu}\\mkern 1.5mu}}}[v ' , t]}}$ ] .",
    "[ fig : rect : between_right_turn_w ] illustrates the situation .",
    "similar to the case above , we analyze the first turn of @xmath381}}$ ] , if it exists , and show that @xmath47 lies on this path .",
    "moreover , we see that all edges of this path point to the right . because @xmath94 is an increasing cycle and the first edge of @xmath381}}$ ] is labeled with @xmath35 , the first turn can not be a right turn .",
    "if it is a left turn , the left turn must occur at @xmath47 .",
    "note that in this case @xmath268 contains an increasing cycle .",
    "we shall see that this situation actually can not occur , but we can not exclude this possibility yet . if @xmath381}}$ ] makes no turns , the edge on @xmath94 after @xmath44 also points to the right and the edge on @xmath30 incident to @xmath44 is the candidate @xmath31 .",
    "hence , the path @xmath384}}$ ] points completely to the right .    in all cases we found a ( possibly empty ) path  @xmath19 from @xmath229 to @xmath47 or vice versa , whose edges point to the right .",
    "moreover , the endpoint  @xmath44 of this path lies on both @xmath23 and @xmath94 .",
    "the path @xmath19 is the initial part of the desired path  @xmath12 . to construct the remaining part of @xmath12",
    ", we prove that @xmath385}}={\\ensuremath{c'[t , u]}}$ ] .",
    "moreover , we show that all edges on this path point to the right .    assume for the sake of contradiction that @xmath385}}\\neq{\\ensuremath{c'[t , u]}}$ ] .",
    "then , let @xmath317 be the last edge of @xmath385}}$ ] that does not lie on @xmath94 .",
    "let @xmath358 be the edge of @xmath94 entering @xmath363 .",
    "by lemma  [ lem : repr : illegal_intersection ] the edge @xmath358 lies in the interior of @xmath23 . but then consider the last common vertex @xmath4 of @xmath23 and @xmath94 before @xmath363 .",
    "we denote the edges of @xmath23 and @xmath94 starting at @xmath4 by @xmath318 and @xmath386 , respectively . as @xmath317 lies in the interior of @xmath23 , so does @xmath386 . but",
    "according to lemma  [ lem : repr : illegal_intersection ] the edge @xmath387 lies in the exterior of @xmath23 , a contradiction .",
    "thus , all edges of @xmath388}}$ ] lie on @xmath389}}$ ] as well .",
    "since these are both paths from @xmath44 to @xmath13 , this means that they are equal . to shorten the notation",
    ", we refer to @xmath385}}$ ] as @xmath138 . since @xmath361 , it is @xmath199 for all edges @xmath17 on @xmath138 .",
    "moreover , as @xmath23 is a decreasing and @xmath94 an ( almost ) increasing cycle , these labels must be @xmath35 .",
    "in particular , all edges on @xmath138 point to the right .",
    "thus , @xmath390 is a path containing both @xmath391 and @xmath47 ending at @xmath13 , such that all edges of @xmath12 point to the right , which concludes the proof for the case when both @xmath23 and @xmath94 use the edge @xmath352 in this direction .",
    "it remains to show that neither @xmath23 nor @xmath94 can contain @xmath392 . by an argument similar to the one above ,",
    "we know that @xmath392 lies on the boundary of the central face  @xmath200 of @xmath201 . since @xmath23 and @xmath94 contain @xmath200 in their interiors , any edge @xmath17 on one of them incident to @xmath200",
    "is directed such that @xmath200 lies locally to the right of @xmath17 . if @xmath23 and @xmath94 used @xmath352 in different directions",
    ", this implies that @xmath393 lies locally to the right of both @xmath352 and @xmath392 , which is impossible .",
    "hence , if @xmath392 lies on one cycle , it lies on the other one , too . in this case",
    ", it is @xmath394 . but @xmath392 points to the left and therefore its label must leave a remainder of 2 when divided by 4 . thus , the assumption that both @xmath23 and @xmath94 contain @xmath352 is justified as none of the other cases can occur .",
    "there are three possible ways how the vertices @xmath47 and @xmath229 can be arranged on @xmath12 ; see  fig .  [",
    "fig : rect : horizontal_between ] .",
    "either @xmath357 , @xmath47 comes before @xmath229 , or @xmath229 comes before @xmath47 . in any case we denote the start vertex of @xmath12 by @xmath205 . according to lemma  [ lem : rect : between_decreasing_and_increasing ] ,",
    "no edge is incident to the left of  @xmath205 .",
    "hence , the insertion of the edge  @xmath196 such that it points right gives a new ortho - radial representation  @xmath261 , which is valid by the following lemma .",
    "[ lem : rect : horizontal_cycle_valid ] let @xmath261 be the ortho - radial representation that is obtained from @xmath68 by adding the edge  @xmath196 pointing to the right as in lemma  [ lem : rect : between_decreasing_and_increasing ] .",
    "then , @xmath261 is valid .    by construction",
    ", @xmath261 satisfies conditions  [ cond : repr : sum_of_angles ] and  [ cond : repr : rotation_faces ] of definition  [ def : repr : valid_representation ] .",
    "let @xmath395 be the new cycle whose edges point right .",
    "it is @xmath396 for each edge @xmath17 of @xmath94 .",
    "no essential cycles without @xmath196 or @xmath276 is increasing or decreasing , since they are already present in the valid representation  @xmath68 .",
    "if an essential cycle  @xmath23 contains @xmath196 or @xmath276 and in particular the vertex  @xmath13 , lemma  [ lem : rect : two_cycles_horizontal ] states that @xmath23 is neither increasing nor decreasing .",
    "thus , @xmath261 satisfies condition  [ cond : repr : labeling ] and is therefore valid .    putting all results together we see that the rectangulation algorithm presented in section  [ sec : rect : algorithm ] works correctly .",
    "that is , given a valid ortho - radial representation  @xmath68 , the algorithm produces another valid ortho - radial representation  @xmath261 such that all faces of @xmath261 are rectangles and @xmath68 is contained in @xmath261 . combining this result with corollary  [ cor : draw : characterization ] we obtain the following theorem .",
    "[ thm : rect : representation_to_drawing ]",
    "let @xmath68 be a valid ortho - radial representation of a graph @xmath8 .",
    "then there is a drawing of @xmath8 representing @xmath68 .",
    "theorem  [ thm : rect : representation_to_drawing ] shows one direction of implication of theorem  [ thm : repr : characterization ] .",
    "the other direction is proved by the following theorem .",
    "[ thm : rect : drawing_to_representation ] for any drawing  @xmath29 of a 4-planar graph  @xmath8 there is a valid ortho - radial representation of  @xmath8 .",
    "we first note that any drawing @xmath29 fixes an ortho - radial representation up to the choice of the reference edge .",
    "let @xmath68 be such an ortho - radial representation where we pick an edge  @xmath54 on the outer face as the reference edge such that @xmath54 points to the right and lies on the outermost circle that is used by @xmath29 ( as in fig .",
    "[ fig : rect : geometric_rectangulation - complete ] ) . by",
    "@xcite the representation  @xmath68 satisfies conditions  [ cond : repr : sum_of_angles ] and  [ cond : repr : rotation_faces ] of definition  [ def : repr : valid_representation ] .",
    "to prove that @xmath68 also satisfies condition  [ cond : repr : labeling ] , i.e. , @xmath68 does not contain any increasing or decreasing cycles , we show how to reduce the general case to the more restricted one , where all faces are rectangles . by corollary  [ cor :",
    "draw : characterization ] the existence of a drawing and the validity of the ortho - radial representation are equivalent .    given the drawing  @xmath29 ,",
    "we augment it such that all faces are rectangles .",
    "this rectangulation is similar to the one described in section  [ sec : rect : algorithm ] but works with a drawing and not only with a representation .",
    "we first insert the missing parts of the innermost and outermost circle that are used by @xmath29 such that the outer and the central face are already rectangles . for each left turn on a face",
    "@xmath30 at a vertex @xmath13 , we then cast a ray from @xmath14 in @xmath30 in the direction in which the incoming edge of @xmath13 points ( cf .",
    "[ fig : rect : geometric_rectangulation - face ] ) .",
    "this ray intersects another edge in @xmath29 .",
    "say the first intersection occurs at the point  @xmath76 .",
    "either there already is a vertex  @xmath205 drawn at @xmath76 or @xmath76 lies on an edge . in the latter case , we insert a new vertex , which we call  @xmath205 , at @xmath76 .",
    "we then insert the edge @xmath196 in @xmath8 and update @xmath29 and @xmath68 accordingly .    repeating this step for",
    "all left turns , we obtain a drawing  @xmath397 and an ortho - radial representation  @xmath261 of the augmented graph  @xmath9 ( see  fig .  [",
    "fig : rect : geometric_rectangulation - complete ] for an example of @xmath397 ) . as the labelings of essential cycles",
    "are unchanged by the addition of edges elsewhere in the graph , any increasing or decreasing cycle in @xmath68 would also appear in @xmath261 .",
    "but by corollary  [ cor : draw : characterization ] @xmath261 is valid , and hence neither @xmath68 nor @xmath261 contain increasing or decreasing cycles .",
    "thus , @xmath68 satisfies condition  [ cond : repr : labeling ] and is valid .",
    "garg and tamassia  @xcite showed that it is @xmath6-complete to decide whether a 4-planar graph admits an orthogonal drawing without any edge bends ( othogonal embeddability ) . in this section ,",
    "we study the analogous problem for ortho - radial drawings and prove that it is @xmath6-complete as well .",
    "we say a graph  @xmath8 admits an _ ortho - radial ( or orthogonal ) embedding _ , if there is an embedding of @xmath8 such that @xmath8 can be drawn ortho - radially ( or orthogonally ) without bends .",
    "does a 4-planar graph @xmath8 admit an ortho - radial embedding ?    to show that ortho - radial embeddability is @xmath6-hard , we reduce planar monotone 3-sat , which was shown to be @xmath6-hard by  @xcite , to ortho - radial embeddability .    given a boolean formula  @xmath398 in conjunctive normal form , such that each clause contains exactly three literals that are either all positive or all negative and a planar representation of its variable - clause - graph in which the variables are placed on one line , the clauses with only positive literals above that line and the clauses with only negative literals below this line .",
    "is @xmath398 satisfiable ?    to reduce from planar monotone 3-sat to ortho - radial embedding",
    "we first construct an equivalent instance  @xmath8 of orthogonal embeddability as described by blsius et  al .",
    "we then build a structure around @xmath8 yielding a graph  @xmath9 such that in any ortho - radial representation of @xmath9 the representation  @xmath68 of @xmath8 does not contain any essential cycles .",
    "in other words , @xmath68 is actually an orthogonal representation of @xmath8 .",
    "hence , an ortho - radial embedding of @xmath9 can only exist if @xmath8 admits an orthogonal embedding .",
    "we may assume without loss of generality that @xmath8 is connected as otherwise , we handle each component separately .",
    "the construction of @xmath9 from @xmath8 is based on the fact that there is only one way to ortho - radially draw a triangle  @xmath23 , i.e. , a cycle of length  3 , without bends : as an essential cycle on one circle of the grid .",
    "we build a graph @xmath146 consisting of three triangles called @xmath116 , @xmath117 and @xmath399 and denote the vertices on @xmath400 by @xmath401 , @xmath402 and @xmath403 .",
    "furthermore , @xmath146 contains the edges @xmath404 and @xmath405 . in fig .",
    "[ fig : embed : embedding ] @xmath146 is formed by the black edges .    to connect @xmath146 and @xmath8",
    ", we identify a vertex  @xmath205 in @xmath8 , called the _ port _ of @xmath8 , such that either there is an orthogonal embedding of @xmath8 with @xmath205 on the outer face and the angle at @xmath205 in the outer face is at least @xmath406 , or @xmath8 does not admit an orthogonal embedding .",
    "we shall see later how such a vertex can be identified in polynomial time .",
    "we connect @xmath205 and @xmath407 by a path  @xmath12 whose length is equal to the number of edges in @xmath8 and denote the resulting graph by  @xmath9 ( cf .",
    "[ fig : embed : embedding ] ) .",
    "[ lem : embed : equivalence ] the graph @xmath9 admits an ortho - radial embedding if and only if @xmath8 admits an orthogonal embedding with the port  @xmath205 on the outer face such that the angle at  @xmath205 in the outer face is at least @xmath406",
    ".    let @xmath261 be a valid ortho - radial representation of @xmath9 without edge bends . in @xmath261",
    "all three cycles @xmath116 , @xmath117 and @xmath399 are essential cycles . hence , @xmath117 lies between @xmath116 and @xmath399 .",
    "furthermore , @xmath8 either lies inside the area enclosed by @xmath116 , @xmath117 and @xmath404 ( as shown in fig .",
    "[ fig : embed : embedding-12 ] ) , or in the area enclosed by @xmath117 , @xmath399 and @xmath405 ( as in fig .",
    "[ fig : embed : embedding-23 ] ) .",
    "therefore , @xmath8 can not contain any essential cycles .",
    "hence , the ortho - radial representation of @xmath8 can be interpreted as an orthogonal representation , and thus , @xmath8 admits an orthogonal embedding .",
    "since @xmath12 ends at the port  @xmath205 and intersects @xmath8 only at @xmath205 , the angle at  @xmath205 in the outer face of @xmath8 must be at least @xmath406 .",
    "let @xmath68 be an orthogonal representation of @xmath8 without bends such that @xmath205 lies on the outer face and the angle at @xmath205 in the outer face is at least @xmath406 .",
    "we interpret @xmath68 as an ortho - radial representation of @xmath8 and extend it to a representation of @xmath9 as follows : we embed @xmath146 such that @xmath116 lies in the interior of @xmath117 , which in turn lies in @xmath399 .",
    "we place @xmath8 between @xmath116 and @xmath117 as shown in fig .",
    "[ fig : embed : embedding-12 ] . since @xmath68 has no bends , the path @xmath12 connecting @xmath8 and @xmath146 needs to make at most as many turns as there are edges incident to the outer face of @xmath8 .",
    "since the length of @xmath8 is equal to the number of edges of @xmath8 , we can place @xmath12 such that all turns occur at its vertices , that is , without edge bends .",
    "as the angle at the port  @xmath205 has at least @xmath406 , @xmath12 can lie completely in the exterior of  @xmath8 .",
    "the construction of @xmath9 relies on the fact that we find a vertex  @xmath205 in @xmath8 such that placing  @xmath205 on the outer face of @xmath8 does not restrict the possible embeddings too much . in order to show how @xmath205 can be chosen , we present some details of the reduction from planar monotone 3-sat to orthogonal embeddability by blsius et  al .  @xcite .",
    "the idea behind the reduction is to rebuild the variable - clause graph of @xmath398 and represent the truth values by edge bends .",
    "[ fig : embed : reduction ] provides an example of this construction .",
    "blsius et  al .",
    "introduce edges that must have exactly one bend ( _ 1-edges _ ) and represent true and false as bends in different directions . in our figures ,",
    "1-edges are drawn as dashed blue lines ( e.g. , in fig .",
    "[ fig : embed : reduction - graph ] ) .",
    "however , instances of orthogonal embeddability can not contain 1-edges and the gadget shown in fig .",
    "[ fig : embed : gadgets - edge ] is used instead . flipping the embedding of this gadget changes the direction of the bend .",
    "we want to choose the port  @xmath205 on a part of @xmath8 that corresponds to one of the outermost clauses ( e.g. , on @xmath408 or @xmath409 in fig .",
    "[ fig : embed : reduction ] ) . the gadget they use to represent clauses ,",
    "is shown in fig .",
    "[ fig : embed : gadgets - clause ] .",
    "note that the boxes are not vertices but occurrences of the graph in fig .",
    "[ fig : embed : gadgets - vertex ] .",
    "consider the gadget for one of the outermost clauses in the variable - clause graph .",
    "we choose any degree-2 vertex of the box in the corner as out port  @xmath205 ( cf .",
    "[ fig : embed : gadgets - clause ] ) . by the following lemma this vertex has the desired properties .",
    "[ lem : embed : existence_z ] let @xmath205 be the port of @xmath8 as selected above . then",
    ", exactly one of the following is true :    1 .   there is an orthogonal embedding of @xmath8 in which @xmath205 lies on the outer face and the angle at @xmath205 in the outer face is at least @xmath406 .",
    "2 .   the graph @xmath8 does not admit any orthogonal embedding .    if @xmath8 admits an orthogonal embedding , then @xmath398 is satisfiable @xcite .",
    "but then @xmath8 can be embedded like the variable - clause graph of @xmath398 .",
    "in particular , @xmath205 lies on the outermost clause gadget . by the choice of @xmath205 this implies that @xmath205 also lies on the outer face of the whole graph @xmath8 .",
    "moreover , the angle at @xmath205 can be set to @xmath410 .",
    "finding such a vertex @xmath205 was the missing piece in the reduction from planar monotone 3-sat to orthogonal embeddability .",
    "[ thm : embed : np_completeness ] ortho - radial embeddability is @xmath6-complete .    clearly , ortho - radial embeddability lies in @xmath6 .",
    "the construction presented above first transforms an instance  @xmath398 of planar monotone 3-sat to an instance  @xmath8 of orthogonal embeddability and then to an instance @xmath9 of ortho - radial embeddability . by lemma  [ lem :",
    "embed : equivalence ] the graph  @xmath9 admits an ortho - radial embedding if and only if @xmath8 admits an orthogonal embedding with @xmath205 on the outer face .",
    "according to lemma  [ lem : embed : existence_z ] this is in turn equivalent to the existence of an orthogonal embedding of @xmath8 without requiring @xmath205 to lie on the outer face .",
    "blsius et  al .",
    "@xcite prove that @xmath8 admits an orthogonal embedding if and only if @xmath398 is satisfiable . in total",
    ", this implies that @xmath398 and @xmath9 are equivalent .",
    "furthermore , the reduction runs in polynomial time .",
    "as planar monotone 3-sat is @xmath6-hard  @xcite , ortho - radial embeddability is @xmath6-hard as well .",
    "one might wonder why we do not directly reduce orthogonal embeddability to ortho - radial embeddability but instead start from planar monotone 3-sat .",
    "this is due to the fact that we need to connect the triangles to a vertex of the instance  @xmath8 of orthogonal embeddability .",
    "therefore , we must find a vertex  @xmath205 on @xmath8 that can lie on the outer face .",
    "that is , if @xmath8 admits an orthogonal drawing , there is an orthogonal drawing of @xmath8 such that @xmath205 lies on the outer face . for arbitrary instances",
    ", we can not identify such a vertex easily . for instances created by the reduction from planar monotone 3-sat however",
    ", we can exploit the structure to find a suitable vertex .",
    "in this paper we considered orthogonal drawings of graphs on cylinders .",
    "our main result is a characterization of the 4-plane graphs that can be drawn bend - free on a cylinder in terms of a combinatorial description of such drawings .",
    "these ortho - radial representations determine all angles in the drawing without fixing any lengths , and thus are a natural extension of tamassia s orthogonal representations .",
    "however , compared to those , the proof that every valid ortho - radial representation has a corresponding drawing is significantly more involved .",
    "the reason for this is the more global nature of the additional property required to deal with the cyclic dimension of the cylinder .",
    "our ortho - radial representations establish the existence of an ortho - radial tsm framework in the sense that they are a combinatiorial description of the graph serving as interface between the `` shape '' and `` metrics '' step .    for rectangular 4-plane graphs",
    ", we gave an algorithm producing a drawing from a valid ortho - radial representation .",
    "our proof reducing the drawing of general 4-plane graphs with a valid ortho - radial representation to the case of rectangular 4-plane graphs is constructive ; however , it requires checking for the violation of our additional consistency criterion .",
    "it is an open question whether this condition can be checked in polynomial time .",
    "these algorithms correspond to the `` metrics '' step in a tsm framework for ortho - radial drawings .    since the additional property of the characterization is non - local ( it is based on paths through the whole graph ) , the original flow network by tamassia can not be easily adapted to compute the `` shape '' step of an ortho - radial tsm framework .",
    "we leave this as an open question .",
    "thomas blsius , guido brckner , and ignaz rutter .",
    "complexity of higher - degree orthogonal graph embedding in the kandinsky model .",
    "in andreas  s. schulz and dorothea wagner , editors , _ proceedings of the 22nd annual european symposium on algorithms ( esa14 ) _ , lncs , pages 161172 .",
    "springer , 2014 .",
    "thomas blsius , ignaz rutter , and dorothea wagner .",
    "optimal orthogonal graph drawing with convex bend costs . in _ proceedings of the 40th int .",
    "colloquium on automata , languages and programming ( icalp13 ) _ , volume 7965 of _ lncs _ , pages 184195 .",
    "springer , 2013 ."
  ],
  "abstract_text": [
    "<S> _ ortho - radial drawings _ are a generalization of orthogonal drawings to grids that are formed by concentric circles and straight - line spokes emanating from the circles center . </S>",
    "<S> such drawings have applications in schematic graph layouts , e.g. , for metro maps and destination maps .    </S>",
    "<S> a plane graph is a planar graph with a fixed planar embedding . </S>",
    "<S> we give a combinatorial characterization of the plane graphs that admit a planar ortho - radial drawing without bends . </S>",
    "<S> previously , such a characterization was only known for paths , cycles , and theta graphs  @xcite , and in the special case of rectangular drawings for cubic graphs  @xcite , where the contour of each face is required to be a rectangle .    </S>",
    "<S> the characterization is expressed in terms of an _ ortho - radial representation _ that , similar to tamassia s _ orthogonal representations _ for orthogonal drawings describes such a drawing combinatorially in terms of angles around vertices and bends on the edges . in this sense </S>",
    "<S> our characterization can be seen as a first step towards generalizing the topology - shape - metrics framework of tamassia to ortho - radial drawings . </S>"
  ]
}