{
  "article_text": [
    "in this paper , we derive the probability distribution of a random variable associated with a brownian motion , namely the time at which a brownian motion attains its maximum value before it crosses the origin for the first time .",
    "this random variable appears quite naturally in different problems such as in queueing theory and in the evolution of stock prices in finance .",
    "let us first consider , for example , a single - server discrete - time queueing process , modelled as a simple random walk  @xcite via:@xmath6 where @xmath7 is the length of the queue at time @xmath8 and @xmath9 s are independent and identically distributed random variables each taking values @xmath10 with probability @xmath11 ( signifying the arrival of a new customer ) , @xmath12 with probability @xmath13 ( indicating the departure of an already served customer ) or @xmath14 with probability @xmath15 . in the queueing language",
    ", this is referred to as the geo / geo/1 queue  @xcite .        given @xmath16 , one calls _ busy period _ the period at the end of which the queue becomes empty for the first time ( see fig .",
    "1 ) : during such a period , the server always has some customers to serve .",
    "it is then natural to enquire about the time at which the queue is at its longest during the busy period . in the random walk model where the queue length @xmath7 is the position of the walker at time step @xmath8 ,",
    "this amounts to investigating the time at which the position of the walker ( initially positive ) is farthest from the origin before it crosses the origin for the first time .",
    "another area where the same variable appears quite naturally is in the evolution of stock prices in finance .",
    "the evolution of a stock price @xmath17 with time @xmath8 is often modelled by the exponential of a random walk  @xcite .",
    "starting from its initial value @xmath18 the price evolves with time stochastically .",
    "a natural question for an agent holding this stock is : what is the suitable time for selling this stock ?",
    "if the stock price goes below a threshold , say @xmath19 , it is too risky to wait any longer .",
    "thus an agent can wait at most up to the time at which the ratio @xmath20 crosses the level @xmath21 from above . within this time",
    ", the ratio @xmath20 will achieve its maximum at some intermediate time which is clearly the best time to sell the stock . assuming that the random variable @xmath22 performs a random walk starting from its initial value @xmath23 , one then wants to calculate the probability distribution of the time at which the random walk is farthest from the origin till its first - passage time through the origin , i.e. , till the time at which @xmath24 , i.e. , @xmath25 indicating the first - passage through the origin .    in this paper , we will consider a further simplified case , namely a continuous - time brownian motion as opposed to the discrete - time random walk in the above two problems . for a continuous - time brownian motion we calculate explicitly , using path - integral methods , the probability density of the time @xmath1 at which a brownian motion @xmath26 ( starting from @xmath27 ) is farthest from the origin before it crosses the origin for the first time .",
    "algorithmically speaking , for each sample of the brownian motion starting at @xmath28 we stop when it crosses the origin for the first time say at time @xmath29 and locate the time @xmath30 at which the brownian motion achieves its maximum value .",
    "note that both @xmath31 ( the first - passage time ) and @xmath1 varies from one sample to another .",
    "we repeat it many times and then construct a histogram of the @xmath1 s which gives its probability density function @xmath0 . even though the discrete - time problem is more relevant",
    ", we expect the continuous - time result to provide the right asymptotics for the discrete problem .",
    "as we will see below , the continuous - time problem , though still non - trivial , is easier to handle analytically",
    ".    note that for a brownian motion or a brownian bridge over a _ fixed _ time interval @xmath32 $ ] , the probability density @xmath33 of the time @xmath34 at which the process attains its maximum is well known  @xcite .",
    "for example , for a zero - drift brownian motion over @xmath32 $ ] starting at the origin , the probability density @xmath35 where @xmath36 $ ] for @xmath37 $ ]  @xcite . on the other hand , for a brownian bridge over the fixed interval @xmath32 $ ] and starting at the origin , the probability density of @xmath34 is uniform , @xmath38 for @xmath39  @xcite .",
    "in contrast , in our case , the brownian motion is not over a fixed time interval , but rather over a variable time interval @xmath40 $ ] where the upper edge @xmath31 is the first - passage time which itself is a random variable  @xcite and hence varies from sample to sample .",
    "the statistical properties of the functionals ( such as the area , the maximum etc . ) of a brownian motion or its variants ( such as a bridge , excursion , meander etc . ) over a fixed time interval have many applications in physics , graph theory , computer science and they have been studied extensively  ( for recent reviews on brownian functionals see  @xcite ) . in particular , the area under a brownian excursion or meander has found many recent applications in problems as diverse as fluctuating interfaces  @xcite , graph enumeration  @xcite , lengths of internal paths in rooted planar trees  @xcite or cost functions in data storage via the `` linear probing with hashing '' algorithm  @xcite .",
    "similarly , the statistical properties of functionals of brownian motion restricted up to its first - passage time ( usually referred to as ` first - passage functionals ' ) also have various applications , and have appeared recently in many different contexts  @xcite , including the computation of the time period of oscillation of an undamped particle in a random potential  @xcite and the determination of the distribution of the lifetime of a comet in the solar system  @xcite .",
    "the probability density of the area swept by an initially positive brownian motion till its first - passage time was computed exactly in @xcite , with an application to queuing theory . in this paper , our focus is on the random variable @xmath1 which , though not quite a functional in the strict sense , is an important random variable associated with such a brownian motion restricted up to its first - passage time .        in @xcite , the authors also computed directly the probability density @xmath41 of the maximum @xmath3 of a brownian motion ( starting at @xmath42 ) before its first - passage time through the origin , via a `` backward '' fokker - planck method and showed that it has a power law behavior @xmath43 where @xmath44 . in this paper , we extend this work using a path decomposition method that allows us to obtain the joint probability density @xmath2 of the maximum @xmath3 and the time @xmath1 at which the maximum occurs before the first - passage time . by integrating over @xmath3 , we then get the ` marginal ' @xmath0 , i.e. the probability density of @xmath1 .",
    "we calculate @xmath0 explicitly both for a driftless and drifted brownian motion .",
    "we also compare the results of numerical simulations to our analytical predictions and find excellent agreement .",
    "we consider a continuous - time brownian motion evolving via @xmath45 , where @xmath46 is a white noise with @xmath47 and @xmath48 .",
    "we start by recalling the quick derivation of @xmath41 given in @xcite :    let @xmath49 be the probability that a brownian particle starting from @xmath50 $ ] exits the interval for the first time through @xmath14 , _ i.e. _ , the probability that the maximum before the first - passage time is less than or equal to @xmath3 . writing @xmath51 for the distribution function of a brownian displacement in the time interval @xmath52 , we have : @xmath53 expanding @xmath54 for small values of @xmath55 , and using the fact that in the absence of drift the mean value of @xmath55 is @xmath14 , one finds that @xmath13 satisfies : @xmath56 whose solution is : @xmath57 as mentioned in its definition , it can easily be seen that @xmath49 also corresponds to the probability that the maximum before the first - passage time is less than or equal to @xmath3 ; therefore , differentiating eq .",
    "[ q ] with respect to @xmath3 gives the probability density of @xmath3 : @xmath58    to compute the joint probability density @xmath2 we proceed as follows .",
    "we first assume that the maximum occurs at @xmath1 and then we split the brownian path into two parts ( before / after @xmath1 , as shown in fig .",
    "3 ) and determine the weights of a path s left - hand side and right - hand side separately .",
    "note that due to the _ markovian _ property of the brownain path , once the position of the walker is specified at @xmath1 , the weights of the left and the right parts become completely _ independent _ and the total weight is just proportional to the product of the weights of the two separate parts .",
    "for the left part , we have a process that propagates from @xmath28 at @xmath59 to @xmath3 at @xmath60 without crossing the level @xmath3 in @xmath61 $ ] ( since @xmath3 is the maximum ) and the level @xmath14 ( the origin ) . for the right part ,",
    "the process propagates from the value @xmath3 at @xmath60 to @xmath14 at @xmath29 where @xmath62 without crossing the level @xmath3 and the level @xmath14 in between .",
    "we need to be careful , however , because , as pointed out in @xcite , a brownian walker that crosses a given level once crosses it infinitely many times immediately after the first crossing .",
    "it is therefore impossible to enforce the constraint @xmath63 and simultaneously forcing the motion to stay below @xmath3 before or after @xmath1 ( for a lattice walk , one does not have this problem since the lattice constant provides a natural cut - off ) . following the method used in  @xcite , we introduce a cut - off @xmath64 by imposing @xmath65 and consider all paths having a maximum less than or equal to @xmath3 and passing through @xmath66 at @xmath60 .",
    "we compute their weight and then let @xmath67 go to @xmath14 eventually .        [ spp ]    on the right side of @xmath60 : we have to determine the weight of a path that starts at @xmath66 and exits for the first time the interval @xmath68 $ ] through @xmath14 .",
    "this is given by eq .",
    "[ q ] : @xmath69    on the left side of @xmath60 : we use a path integral treatment with the feynman - kac formula ( as in @xcite ) giving the weight of a path in terms of the propagator @xmath70 , where @xmath71 with @xmath72 a square well having infinite barriers at @xmath73 and @xmath74 and @xmath75 for @xmath76 ( the infinite barriers at @xmath73 , @xmath74 enforce the condition that the path can penetrate neither at @xmath73 nor at @xmath74 )",
    ". the normalized eigenfunctions of @xmath77 labelled by the integer @xmath78 are @xmath79 with the associated eigenvalues @xmath80 .",
    "the eigenfunction @xmath81 vanishes at both ends @xmath73 and @xmath74 of the box .",
    "the propagator can be easily evaluated in this eigenbasis , @xmath82 and one gets : @xmath83 in the limit when @xmath84 , we get to leading order @xmath85    taking the product of eqs .",
    "[ rhs ] and [ lhs ] , we get the total weight of the path , to leading order in small @xmath67 , @xmath86 the proportionality constant is set by using the normalization constant : @xmath87 it is easy to show that the proportionality constant @xmath88 .",
    "thus , in the limit @xmath89 , we finally obtain @xmath90 as a first check , let us show that @xmath91 , thus recovering the marginal @xmath41 of the maximum in eq .",
    "[ pm ] . integrating over @xmath1 , we get @xmath92 where the last identity can be found ( and derived easily ) in  @xcite .    finally , from eq .  [ jp ]",
    "an integration over @xmath3 ( note that @xmath3 varies from @xmath28 to @xmath93 ) yields the desired marginal @xmath0 : @xmath94 the sum in eq .",
    "[ pts ] can be expressed in terms of a known special function and we get @xmath95\\label{pt}\\ ] ] where @xmath96 is the fourth of jacobi s theta functions ( @xcite ) .",
    "subsequently one can obtain the large and small @xmath1 asymptotics of @xmath0 from the exact expression in eq .",
    "[ pt ] .",
    "we first consider the case when @xmath97 .",
    "changing variables in eq .",
    "[ pts ] through @xmath98 and letting @xmath99 gives for @xmath97 : @xmath100      in the opposite limit @xmath101 , we start from eq .",
    "[ jp ] and first take a laplace transform : @xmath102 where the sum of the series can be found in @xcite . letting @xmath103",
    "become much larger than @xmath104 and @xmath105 , we obtain : @xmath106 which , after the laplace inversion ( @xcite ) yields : @xmath107 integrating over @xmath3 gives for @xmath101 : @xmath108    thus , @xmath0 has power law behavior at both large and small tails . for large @xmath1 , the probability density falls off as @xmath4 , whereas for small @xmath1 it diverges as @xmath5 .",
    "the exact analytical form of @xmath0 and its asymptotes from eqs .",
    "[ pt ] , [ pti ] , [ pt0 ] are plotted ( using mathematica ) in fig .  4 together with the points obtained from the numerical simulation ( with 1,000,000 realisations ) .",
    "they are in good agreement with each other .     and its asymptotes for the driftless case .",
    "in the simulation , @xmath28 was set to @xmath21 .",
    "]    [ drlp ]",
    "we now consider a brownian motion in the presence of a drift @xmath109 . for @xmath110 ,",
    "it is clear that the walker will excape to @xmath93 with a nonzero probability .",
    "this means that with a finite probability @xmath111 . therefore this case is not much of interest in the present context .",
    "instead , we focus here on the opposite case where the drift is towards the origin , i.e. , @xmath112 . the langevin equation describing",
    "the motion becomes : @xmath113 where @xmath114 is the gaussian white noise with @xmath115 and @xmath116 .",
    "we use the same strategy as in the driftless case , _",
    "i.e. _ , splitting the motion into two independant parts ( before and after @xmath1 ) and introducing a small cut - off @xmath67 .    on the right - hand side :",
    "letting , as in the driftless case , @xmath49 be the probability that a brownian particle starting from @xmath50 $ ] exits the interval for the first time through  @xmath14 , we have as before : @xmath53 in the presence of a drift , the mean value of @xmath55 is no longer @xmath14 and one can easily show that the analogue of eq .",
    "[ eqq ] now reads : @xmath117 the solution is : @xmath118 and so we have : @xmath119 as in the driftless case , the probability density of @xmath3 can be obtained by differentiation of eq .",
    "[ dq ] with respect to @xmath3 , as was done in @xcite : @xmath120 where we have added the subscript `` d '' to indicate that the density corresponds to the drifted case .    on the left - hand side",
    ": we use the same path integral method as in the driftless case .",
    "the weight of a path is now proportional to : @xmath121 \\nonumber \\\\=   \\exp \\left [ -\\frac{|\\mu|^2}{2}t_m-|\\mu|\\int_0^{t_m}d\\tau\\:\\frac{dx}{d\\tau}\\right ] \\exp \\left [ -\\frac{1}{2}\\int_0^{t_m}d\\tau\\:\\left(\\frac{dx}{d\\tau}\\right)^2\\right].\\label{fact}\\end{aligned}\\ ] ] the position of the brownian particle at @xmath59 and @xmath60 is known , so we can substitute @xmath122 for @xmath123 in the first exponential factor on the right - hand side of eq .",
    "[ fact ] .",
    "the propagator for the drifted case will therefore be equal to that for the driftless case ( given in eq .",
    "[ propa1 ] ) multiplied by the factor @xmath124 $ ] , and will be given by : @xmath125 \\frac{2}{m}\\sum_{n=1}^{\\infty } \\sin\\left(\\frac{n\\pi x_0}{m}\\right ) \\sin\\left(\\frac{n\\pi ( m-\\varepsilon)}{m}\\right)\\,e^{-\\frac{n^2\\pi^2}{2m^2}t_m}.\\label{ld}\\ ] ]    as in the driftless case , we multiply the weights of the left and right side of @xmath1 derived above ( eqs .  [ qd ] and [ ld ] ) , and take the @xmath126 limit to obtain : @xmath127 where @xmath2 is the joint density for the driftless case given in eq .",
    "( [ jp ] ) . once again , by integrating over @xmath1 , one can recover the marginal probability density of the maximum @xmath128 derived originally in @xcite .",
    "on the other hand , integrating over @xmath3 gives the marginal @xmath129 .",
    "we were not able to derive a compact expression for @xmath129 as in the driftless case , though the asymptotes of @xmath129 can be derived explicitly as shown below .      from eq .",
    "[ jpd ] , we can derive very quickly the behaviour of @xmath129 when @xmath130 . substituting in eq .",
    "[ jpd ] the asymptotic result for the driftless case from eq .",
    "[ jpsa ] and integrating over @xmath3 we get : @xmath131 thus for small @xmath1 , @xmath129 diverges as @xmath132 , as in the driftless case .      to study the behaviour of @xmath129 when @xmath133 , we start from the following expression for @xmath129 : @xmath134 the series in eq .",
    "[ pdtm ] is dominated by the first term ( @xmath135 ) for large  @xmath1 .",
    "hence , retaining only the @xmath135 term and making a change of variable @xmath136 in the integral , we get : @xmath137 for large @xmath1 , the most important contribution to the integral comes from the small @xmath138 regime .",
    "expanding the @xmath139 and @xmath140 functions and keeping only the leading order term reduces the integral to : @xmath141 letting @xmath142 , we next use the saddle point method to obtain the leading term via minimizing the function @xmath143 and get : @xmath144\\ ,   t_m^{-5/6}\\ , e^{-\\frac{|\\mu|^2}{2}t_m-\\frac{3}{2}\\left ( |\\mu|\\pi\\right )   ^{2/3}t_m^{1/3}}\\label{pdla}\\ ] ]    thus , as expected , the density @xmath129 has an exponential decay for large @xmath1 in presence of a negative drift .",
    "figure  5 shows a plot of the asymptotes ( eq .  [ pdsa ] and [ pdla ] ) together with the data from numerical simulation ( 1,000,000 realisations with @xmath145 ) .     and its asymptotes in the presence of a drift towards the origin ( @xmath145 ) .",
    "in the simulation , @xmath28 was set to @xmath21.,width=415,height=472 ]    [ drp ]",
    "in summary , we have obtained an exact expression for the probability density of the time at which a brownian motion attains its maximum before passing through the origin for the first time , and studied the tails of this probability density both for the driftless and for the drifted brownian motion .",
    "this was done by first computing the joint distribution @xmath2 of the maximum @xmath3 attained and the time @xmath1 at which it is attained . in the context of the queuing theory , the result that @xmath0 decreases monotically with increasing @xmath1 suggests that the beginning of a busy period is more likely to be the time at which a queue is at its longest",
    ".    it would be interesting to derive the explicit results , obtained here by the path integral method , from the general theory of filtrations in brownian motion developed recently in @xcite .",
    "it would also be of interest to extend this calculation to the discrete - time random walk case which remains a real challenge .",
    "we thank a. comtet , m.j .",
    "kearney and p.l .",
    "krapivsky for useful discussions .",
    "we also thank m. yor for useful discussions and for pointing out references @xcite .",
    "10 kearney m j 2004,_j .",
    "gen . _ * 37 * , 8421 ."
  ],
  "abstract_text": [
    "<S> we calculate analytically the probability density @xmath0 of the time @xmath1 at which a continuous - time brownian motion ( with and without drift ) attains its maximum before passing through the origin for the first time . </S>",
    "<S> we also compute the joint probability density @xmath2 of the maximum @xmath3 and @xmath1 . in the driftless case </S>",
    "<S> , we find that @xmath0 has power - law tails : @xmath4 for large @xmath1 and @xmath5 for small @xmath1 . in presence of a drift towards the origin </S>",
    "<S> , @xmath0 decays exponentially for large @xmath1 . </S>",
    "<S> the results from numerical simulations are in excellent agreement with our analytical predictions .    </S>",
    "<S> * keywords * : brownian motion , first - passage problems , extreme value problems </S>"
  ]
}