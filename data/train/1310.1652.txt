{
  "article_text": [
    "preserving quantum coherence is key to realizing a quantum computer .",
    "this can be achieved with the help of quantum error correction@xcite ( qec ) , which , in theory , enables any size quantum computation as long as the errors are below certain threshold@xcite .",
    "unfortunately , the threshold to scalable quantum computation is very stringent , presently around @xmath0 infidelity per local gate@xcite .",
    "this value corresponds to encoding logical qubits in individual blocks of physical qubits using toric@xcite , or related surface@xcite or color codes@xcite , and is a huge improvement over the original estimates based on concatenated codes where the threshold value can be two or more orders of magnitude smaller depending on the details@xcite .    in spite of this progress , building a quantum computer with hundreds or thousands of qubits , with gates concurrently operating at the desired level of accuracy , is a great physics and engineering challenge .",
    "it is being pursued by a number of groups , using different physical systems for implementing qubits .",
    "however , the corresponding control algorithms need not necessarily be developed from scratch , since the different physical systems share some key properties .",
    "in particular , qubits with always - on couplings are a natural model for several potential quantum computer ( qc ) architectures such as the original kane proposal@xcite , nitrogen vacancy centers in diamond@xcite , superconducting phase qubits@xcite , and circuit qed lattices@xcite . when compared to their counterparts with tunable couplings , qubits with always - on couplings can be expected to have better parameter stability and longer coherence times .",
    "in addition there is also much to be benefited from over sixty years of development in nuclear magnetic resonance ( nmr ) which has resulted in an amazing degree of control available to such systems@xcite .",
    "related coherent control techniques based on carefully designed pulse sequences to selectively decouple parts of the system hamiltonian have been further developed in application to quantum computing@xcite .",
    "while nmr quantum computing is not easily scalable@xcite , it still holds several records for the number of coherently controlled qubits@xcite .",
    "however , some of these records have been achieved with the help of _ strongly - modulated _ pulses , computer - generated single- and multi - qubit gates tailored for a particular system hamiltonian@xcite .",
    "while such gates can be used in other qc architectures@xcite , they may violate scalability .    on the other hand , nmr - inspired techniques like dynamical decoupling ( dd )",
    "can also be used to control large systems with local interactions , where pulses and sequences intended for a large system can be designed to a given order in the magnus series@xcite on small qubit clusters@xcite .",
    "dd is also excellent in producing accurate control for systems where not all interactions are known as one can decouple interactions with the given symmetry@xcite .",
    "moreover , dd works best against errors coming from low - frequency bath degrees of freedom which tend to dominate the decoherence rates , and it does not require additional qubits . in short , dd is an excellent choice for the first level of coherence protection ; it s use could greatly reduce the required repetition rate of the qec cycle .",
    "this is well recognized in the research community , and applications of dd for quantum computation are actively investigated by a number of groups .",
    "however , most publications on the subject illustrate general principles using just a single qubit as an example , leaving out the issues of design and simulation of scalable approaches to multi - qubit dynamical decoupling .",
    "while the techniques for larger systems exist , they typically require longer decoupling sequences@xcite .",
    "recently , we have suggested a universal set of high - fidelity one- and two - qubit gates for any qubit network that forms a sparse bipartite graph with always - on ising couplings @xcite .",
    "these gates have built - in dd - protection against low - frequency phase noise and use finite - amplitude _ shaped pulses _ which could be experimentally implementable .",
    "they can be executed in parallel for different qubits or pairs of qubits .",
    "these features make the suggested gate set ideal for implementing qec with quantum low - density parity check ( ldpc ) codes@xcite , in particular , surface codes and their finite - rate generalizations@xcite .    in this work",
    "we present the details of the gate design , extend the construction to enable simultaneous gates on a lattice with unequal couplings , and analyze the error operators associated with the constructed gates .",
    "namely we first analyze the errors analytically up to a cubic order in the magnus expansion .",
    "we further study these errors numerically by explicitly integrating the schrdinger equation for time evolution of clusters of up to six qubits , and give a bound on high - order errors for qubits on a large square lattice . using this bound",
    ", we analytically prove that with large enough toric code the present gate set can be used to implement a fault - tolerant quantum memory .",
    "the outline of the paper is as follows . in sec .",
    "[ sec : intro - dd ] we review dynamical decoupling techniques , extend the analytical perturbation theory@xcite to cubic order , and illustrate it for several single - qubit soft - pulse sequences . in sec .",
    "[ sec : gate - set ] we present the details of our universal gate set construction , generalized here to allow simultaneous two - qubit gates on a bipartite network with unequal ising couplings .",
    "we analyze the associated error operators both analytically , to elucidate the dependence on the pulse shapes , and numerically , by the full unitary evolution of small networks with up to six qubits .",
    "an important result is that for our gates implemented as second - order pulse sequences , even with very small infidelities , errors on graphs with vertex degrees exceeding two predominantly involve three - qubit and larger clusters . in sec .",
    "[ sec : scaling ] , we give a bound on the amplitude of errors forming large clusters on a square lattice of qubits for gates designed perturbatively , and show that such gates can be used with the toric code to implement fault - tolerant quantum memory .",
    "lastly , we give our conclusions .",
    "dynamical decoupling originates from the hahn s spin echo experiment@xcite . in the simplest version ,",
    "one applies ideal infinitely - short `` hard '' pulses which perform single - spin unitary rotations .",
    "since the corresponding field is infinite , such rotations are independent of the system hamiltonian .",
    "when the integrated pulse amplitude corresponds to a @xmath1 rotation of the affected spins , the result is a reversal of some terms in the hamiltonian .",
    "for example , for a single spin @xmath2 with the chemical - shift hamiltonian @xmath3 the unitary for a @xmath1 rotation around the @xmath4 axis is @xmath5 , while between the pulses the spin experiences free evolution with the unitary @xmath6 . throughout this paper",
    "we use the standard notation for the pauli matrices @xmath7 , @xmath8 .",
    "a sequence of two such @xmath9 pulses applied at @xmath10 and @xmath11 respectively corresponds to the evolution @xmath12 where we used the pauli matrix identity @xmath13 .",
    "up to an overall phase , the effect of the chemical shift is completely suppressed when the interval between the pulses is a half of the full evolution time , @xmath14 .    in practice",
    ", the pulse duration can not be chosen to be arbitrarily short .",
    "for example , in the case of nmr , the chemical shift hamiltonian  ( [ eq : chemical - shift ] ) is written in the `` rotating frame , '' the interaction representation with respect to the hamiltonian @xmath15 , where @xmath16 is the carrier frequency of the rf field of the pulse .",
    "the actual pulse must have a duration greater than a few cycles at this frequency , @xmath17 .",
    "much more stringent lower limits on the pulse duration come about when homonuclear addressing is needed  in this case selectivity can be achieved when the inverse pulse duration is small compared to the chemical shift difference .",
    "similar lower limits on the pulse duration @xmath18 also exist in the solid state setting .",
    "for example , in the case of superconducting phase qubits , the qubits are formed by the two lowest levels of a non - parabolic potential well . while the qubit frequency is around @xmath19hz , the need to avoid the @xmath20 transition ( typically detuned by some @xmath21 of the qubit frequency @xmath22 ) limits@xcite the pulse duration by @xmath23ns .",
    "generally , in order for pulse - based control to be effective , the field of the pulse must dominate the evolution ; for the hamiltonian  ( [ eq : chemical - shift ] ) this implies the requirement @xmath24 . for any finite - amplitude pulse ,",
    "e.g. , described by the hamiltonian @xmath25 , in the presence of the chemical shift @xmath26 , the actual rotation occurs around the net `` magnetic field '' vector @xmath27 . with generic pulse shapes ( such as a gaussian ) , this produces unitary evolution operator with errors linear in the pulse duration .",
    "the situation gets more complicated in the presence of an environment .",
    "most importantly , dynamical decoupling is not effective against relaxation due to fast degrees of freedom .",
    "for example , in nmr , the nuclear spins have a large energy splitting @xmath28 , the relaxation dynamics is nearly markovian and is described by the transverse and longitudinal relaxation times , @xmath29 and @xmath30 .",
    "while hard @xmath1 pulses commute with the relaxation superoperator , sequences of soft pulses can modify the structure of the relaxation and in particular , redistribute relaxation rates between different channels preserving the combination of @xmath31 @xcite .",
    "dynamical decoupling is much more effective against decoherence caused by the low - frequency environmental modes .",
    "the corresponding evolution is commonly modeled by the general hamiltonian @xmath32 where @xmath33 is the hamiltonian of the qubits and the environment in the absence of control . in this work",
    "we assume that qubits with always - on ising couplings form a bipartite graph @xmath34 with vertex and edge sets @xmath35 and @xmath36 respectively .",
    "namely , we write the `` system '' hamiltonian as : @xmath37 where the two points are neighboring ( coupling @xmath38 ) if the corresponding edge is present in the graph @xmath39 , @xmath40 .",
    "we consider decoherence due to slow dephasing of individual qubits , with the bath and bath - coupling hamiltonians , respectively , @xmath41 we will assume that each qubit has its own individual bath , meaning that the bath operators @xmath42 commute with each other , and the coupling operators @xmath43 commute with all @xmath42 , @xmath44 .    for dynamical decoupling to work , the control hamiltonian @xmath45 must be dominant . to this end , we assume that any large energies have already been eliminated from the system @xmath46 and system - bath coupling @xmath47 hamiltonians by going into the corresponding rotating frame ( interaction representation ) and keeping only the slow parts . while the norm of the bath hamiltonian @xmath48 needs not be finite , the evolution it produces in the hamiltonian @xmath47 must be in some sense slow .",
    "we will assume an upper limit on the norms of the bath coupling operators , @xmath49 , and also limit the @xmath50-times repeated commutators @xmath51\\ldots ] $ ] by @xmath52 , where @xmath53 is the upper cut - off frequency of the bath .",
    "for a bath of harmonic oscillators ( e.g. , phonons ) , these assumptions imply a cut - off on the allowed occupation number of each oscillator .",
    "this can be approximated by ensuring that phonon modes do not form sharp resonances and by providing sufficient cooling .    the bath model  ( [ eq : ising - bath ] )",
    "can be viewed as an effective description of qubits operating well above the bath frequency cut - off to eliminate direct spin flip transitions , with dephasing caused by phonon scattering .",
    "similarly , the system hamiltonian  ( [ eq : ising - network ] ) can be generally obtained as an effective hamiltonian for any set of couplings as long as the transition frequencies of the neighboring qubits differ sufficiently .",
    "we also assume the ability to control the qubits individually , @xmath54 where the control signals @xmath55 are arbitrary , except for some implicit limits on their amplitude and spectrum .",
    "generally , the approach is to treat the control hamiltonian  ( [ eq : control - general ] ) exactly , and analyze the evolution due to the system  ( [ eq : ising - network ] ) and bath  ( [ eq : ising - bath ] ) hamiltonians using the average hamiltonian theory , an improved version of the time - dependent perturbation theory .",
    "one introduces the exact unitary @xmath56 associated with the control operator , and the interaction representation @xmath57 for the remaining parts of the original hamiltonian , where , for e.g. , the interaction representation of the system hamiltonian  ( [ eq : ising - network ] ) is @xmath58 then , the entire evolution operator @xmath59 is decomposed into a product of the unperturbed operator @xmath60 and the unitary @xmath61 for the slow evolution which obeys the integral equation @xmath62 the equation is formally solved in terms of the time - ordered exponent @xmath63 we will also need the corresponding expansion @xmath64 the time - ordered exponent ( [ eq : r - time - ordered ] ) can also be rewritten in terms of an average hamiltonian , @xmath65 the leading - order term in the expansion @xmath66 in powers of the interaction hamiltonian @xmath67 [ see eq .",
    "( [ eq : interaction - hamiltonian ] ) ] is given by its average , @xmath68 while higher - order terms are given by multiple time integrals@xcite of the sums of commutators of @xmath67 evaluated at different time moments @xmath69 .",
    "for the order-@xmath70 average hamiltonian , @xmath71 , one has the sum of commutators of @xmath72 terms evaluated at time moments @xmath73 . when the interaction hamiltonian is a sum of local terms , as @xmath33 in eq .",
    "( [ eq : general - hamiltonian ] ) , the average hamiltonian @xmath74 can be written as a sum of terms with support on different connected clusters .",
    "in particular , with the pairwise qubit couplings following a connectivity graph @xmath75 as in eqs .",
    "( [ eq : ising - network ] ) and ( [ eq : ising - network - rotated ] ) , the clusters correspond to connected subgraphs of @xmath75 .",
    "explicitly , two bonds belong to the same cluster if they are connected either directly ( i.e. , share a qubit ) , or via a continuous chain of connected bonds .",
    "note that , when dealing with the slow bath , it is common to include the bath hamiltonian @xmath76 as a part of the interaction hamiltonian .",
    "it appears unchanged in the leading - order average hamiltonian , @xmath77 , while higher order terms of the expansion contain only multiple commutators of @xmath48 with other perturbing terms .",
    "dynamical decoupling is perturbative in nature .",
    "an analytical perturbation theory expansion convenient for analyzing the effect of pulse shaping on the sequences has been constructed by one of us in refs .  .",
    "here we extend the expansion to include the terms up to third order for the spin - in - dephasing - bath hamiltonian @xmath78 where @xmath79 and @xmath80 are @xmath81-numbers or operators acting on the bath degrees of freedom .",
    "the one - dimensional pulse ( here we assume a rotation around the @xmath4-axis ) is given by a single - qubit version of the control hamiltonian  ( [ eq : control - general ] ) with an arbitrary function @xmath82 , @xmath83 .",
    "the results of this section can be trivially generalized to a rotation around an arbitrary direction @xmath84 in the @xmath4-@xmath85 plane with the help of the unitary @xmath86 .",
    "the time - dependent perturbation theory is formulated with respect to the control evolution alone , with the unitary @xmath87 where the time - dependent phase @xmath88 if we denote the net rotation angle @xmath89 , in the case of a symmetric pulse shape , @xmath90 , the rotation angle has the property @xmath91 . for such cases",
    "it is convenient to introduce the symmetrized rotation angle , @xmath92 .",
    "this function is odd under the pulse - reflection symmetry , @xmath93 .    using the explicit form ( [ eq : pulse - u0 ] ) of the evolution matrix due to the pulse , the interaction representation of the spin - in - a - bath hamiltonian  ( [ eq : qubit - bath ] ) is just a spin rotation around the @xmath4 axis , @xmath94 the `` slow '' evolution is described by the unitary @xmath95 which obeys the equation @xmath96    the net evolution over the duration of the pulse is given in terms of the corresponding average hamiltonian @xmath97 , @xmath98 where @xmath99 . given that the interaction hamiltonian @xmath100 [ see eq .",
    "( [ eq : interacting ] ) ] at time moment @xmath69 is a sum of constant operators multiplied by the functions @xmath101 , @xmath102 , and a constant @xmath103 , the average hamiltonian can be computed order - by - order for an arbitrary pulse shape , in terms of the integrals of products of @xmath104 , @xmath105 , and @xmath106 .    for a symmetric pulse ,",
    "the only non - trivial coefficient in the leading order is @xmath107 which gives the leading - order average hamiltonian@xcite @xmath108 nmr - style first - order self - refocusing pulses@xcite have @xmath109 .",
    "similarly , there are only two independent coefficients in the next order , @xmath110 so that the first - order average hamiltonian reads @xmath111\\bigl(\\cos { \\phi_0\\over2 }    \\sigma^y    - \\sin { \\phi_0\\over2 }    \\sigma^z \\bigr).\\label{eq : have1}\\ ] ] nmr - style second - order pulses@xcite have @xmath112 , which guarantees no error to subleading order with the chemical shift system hamiltonian  ( [ eq : chemical - shift ] ) .",
    "more complicated second - order pulses constructed in ref .",
    ", in addition , have @xmath113 , which suppresses the entire linear - order average hamiltonian  ( [ eq : have1 ] ) .",
    "finally , in the third order , out of 27 combinations of @xmath114 , @xmath115 , and @xmath116 with @xmath117 , there are only five independent combinations , @xmath118 where , e.g. , @xmath119 with the ising system hamiltonian  ( [ eq : qubit - bath ] ) , only the first four coefficients enter the second - order average hamiltonian : @xmath120\\nonumber \\\\    & & + \\tau_p^2\\bigl(\\sigma^y\\sin { \\phi_0\\over2 }    + \\sigma^z\\cos { \\phi_0\\over2 } \\bigr)\\nonumber\\\\    & & \\quad \\times\\left\\ {      \\bigl({\\upsilon\\over24}-\\delta_1\\bigr)[b,[b , a ] ]      -4 \\delta _ 4   \\,a^3 \\right\\}.    \\label{eq : have2}\\end{aligned}\\ ] ]      instead of , or in addition to designing the pulse shapes , one can compensate evolution errors associated with arbitrary pulse shapes by designing sequences of such pulses . at the level of the leading - order average hamiltonian ,",
    "one universal prescription can be formulated simply in terms of eulerian cycles on the cayley graph associated with the decoupling group@xcite .    for a single qubit , up to a phase , the decoupling group is @xmath121 .",
    "it can be generated by unitaries @xmath122 , @xmath123 corresponding to @xmath1 rotations around a pair of orthogonal directions , e.g. , @xmath4 and @xmath85 respectively : @xmath124 .",
    "the corresponding cayley graph has a separate vertex for each group element , and directed edges from each @xmath125 to @xmath126 , for every group generator @xmath127 .    in notations of the sec .",
    "[ sec : intro - average - ham - pulse ] , the two rotations can be implemented using some pulse shapes @xmath128 , @xmath129 , with the nominal rotation angles @xmath1 . then , the corresponding real - world unitaries can be written as @xmath130 , @xmath131 , where @xmath132 @xmath133 , and the errors @xmath134 , @xmath135 , are a combined result of the system - bath hamiltonian @xmath33 and any inaccuracies of the pulse duration , amplitude , and phase .",
    "the assumption is that the pulses can be implemented consistently , so that @xmath134 are the same for identical pulses applied at different times .",
    "an eulerian cycle is a sequence of generators ( directed edges ) such that every edge of the cayley graph is visited . for a single qubit",
    ", the sequence can be chosen , e.g. , as @xmath136 ; the corresponding unitary is given by the product @xmath137 .",
    "the key observation@xcite is that @xmath138 does not contain terms linear in @xmath134 , @xmath139 ; this follows from the fact that the cayley tree has edges of each type starting from every group element .",
    "thus , the leading - order average hamiltonian @xmath140 is independent of the spin variables @xmath7 .    in the notations of sec .",
    "[ sec : intro - average - ham - pulse ] , and in the absence of any pulse errors [ only errors associated with the system - bath hamiltonian  ( [ eq : qubit - bath ] ) are preserved ] , we have @xmath141,\\\\    { \\bar h_0^{(2)}\\over \\tau_p^2}&=&i\\kappa^2\\sigma^z[b , a^2]-    \\left({\\kappa^2\\over4}+\\gamma_2+\\gamma_3\\right)[[b , a],a]\\nonumber    \\\\      & & -{\\zeta\\over2}\\sigma^z    [ b,[b , a]],\\end{aligned}\\ ] ] where @xmath142 , @xmath143 , and @xmath144 , @xmath145 , are defined as the coefficients in eqs .",
    "( [ eq : upsilon - defined ] ) , ( [ eq : zeta - defined ] ) , ( [ eq : delta1 ] ) ,  ( [ eq : delta5 ] ) for the special case of @xmath1 pulses .",
    "generally , for an @xmath146-qubit system , the decoupling group has @xmath147 generators and dimension @xmath148 ; thus an eulerian path consists of @xmath149 elements . because of this exponential scaling ,",
    "the eulerian cycle construction is not directly useful for large multi - qubit systems@xcite .",
    "a generalization of the eulerian cycle construction which allows to generate arbitrary gates has been constructed by khodjasteh and viola@xcite ( more complicated sequences which allow for cancellation to an arbitrary order are also available , see ref .  ) .",
    "the main idea is to construct a non - trivial `` identity '' operator that shares the leading - order error operators @xmath134 [ cf .",
    "( [ eq : ri - operators ] ) ] with those of the gate one is trying to construct .",
    "for a one - dimensional rotation with the pulse shape @xmath150 , @xmath151 ( note the stretching and amplitude reduction ) , such an identity operator is a combination of the unstretched pulse and antipulse@xcite , @xmath152{cc }         v(t ) , & 0\\le t\\le \\tau_p;\\\\        - v(2\\tau_p - t ) , & \\tau_p\\le t\\le 2 \\tau_p .",
    "\\end{array}\\right.\\ ] ] then , if we denote the unitary of the identity operator as @xmath153 , and the unitary of the stretched pulse as @xmath154 , the modified euler sequence@xcite corresponds to the unitary ( total duration @xmath155 ) : @xmath156 if we introduce the unitary corresponding to the ideal gate @xmath157 , and the sequence - error unitary @xmath158 , @xmath159 , the sequence ( [ eq : dcg - orig ] ) produces @xmath160 for any set of pulse shapes implementing the unitaries in eq .",
    "( [ eq : dcg - orig ] ) .",
    "alternatively , the leading - order average hamiltonian of the gate error is just the bath hamiltonian , @xmath161 , independent of the degrees of freedom associated with the spin being decoupled .    explicitly , for the system hamiltonian ( [ eq : qubit - bath ] ) , when symmetric pulse shapes are used to implement the dcg corresponding to an angle-@xmath162 rotation around the @xmath85 axis , the two subleading terms of the average hamiltonian read @xmath163+{\\beta\\over4}\\sigma^y a^2-{i\\over4}[a , b ] } & & \\nonumber\\\\    & & \\qquad \\times \\left[({2\\kappa-\\xi c%\\cos { \\phi_0\\over2 }      -2\\upsilon s%\\sin{\\phi_0\\over2 }      } )",
    "\\sigma^x    + ( { 5\\upsilon c%\\cos { \\phi_0\\over2 }      -\\xi s%\\sin{\\phi_0\\over2 }      } ) \\sigma^z \\right],\\quad \\\\",
    "\\label{eq : dcg2 }    \\lefteqn{{\\bar h_0^{(2)}\\over \\tau_p^2}\\bigr|_{\\kappa,\\upsilon\\to0}=      % % ( \\mathbf{fix this } )    i\\left({\\alpha\\over4}\\sigma^x-{4\\alpha+29\\beta\\over16}\\sigma^y\\right )    [ a^2,b ] } \\\\\\nonumber & + &    { \\big(}{29\\xi s- 6\\delta_1 c-8\\zeta\\over16}\\sigma^z % \\\\\\nonumber & & + { 29\\xi c+6\\delta_1 s \\over 16}\\sigma^x { \\big)}[b,[b , a ] ] \\\\\\nonumber & &   -{1\\over2}\\bigl ( \\gamma_2+\\gamma_3 + { 7\\over4 } ( \\delta_2 +   \\delta_3)\\bigr)[a,[a , b ] ] \\\\\\nonumber & & + { 3\\delta_4\\over2}(s\\sigma^x - c\\sigma^z)a^3 \\label{eq : one - qubit - dcg2}\\end{aligned}\\ ] ] where we introduced @xmath164 , @xmath165 , and assumed @xmath166 in the second - order effective hamiltonian  ( [ eq : one - qubit - dcg2 ] ) .",
    "it is important to note that even though the noise hamiltonian  ( [ eq : qubit - bath ] ) can formally be decoupled with a smaller group ( e.g. , @xmath167 ) , the corresponding eulerian dcg would not be sufficient with generic finite - width pulses .",
    "we confirmed this with an explicit calculation for the partial - group eulerian - sequence unitary [ cf .",
    "( [ eq : dcg - orig ] ) ] @xmath168 the corresponding effective hamiltonian gets a correction already in the leading order : @xmath169 this can be compensated by using self - refocusing pulses with @xmath166 .",
    "then , in the next order we obtain @xmath170 .",
    "% \\left({2\\alpha\\over 3}\\sigma^x+{\\beta\\over 6}\\sigma^y\\right ) a^2 % \\nonumber\\\\ % & & + i { \\xi\\over 6}\\left ( c\\sigma^x+s \\sigma^z \\right ) [ a , b ] .",
    "\\label{eq : dcg-1d - ham1}\\end{aligned}\\ ] ] this , in turn , can be compensated using the second - order self - refocusing pulses in which case we are left only with the second - order hamiltonian @xmath171    \\\\\\nonumber   & \\quad &    -\\bigl({\\gamma_2+\\gamma_3\\over2}+5{\\delta_2+\\delta_3\\over4}\\bigr )     \\big[a,[a , b]\\big ] \\\\",
    "\\nonumber   & \\quad & -\\biggl(\\bigl ( { 11\\xi c\\over8}+{5\\delta_1 s\\over4}\\bigr)\\sigma^x    - \\bigl({\\zeta\\over2}-{13\\xi s\\over8 } +    { 3\\delta_1c\\over4}\\bigr)\\sigma^z\\biggr)\\quad \\\\   & & \\qquad   \\times [ b,[b , a ] ]    \\label{eq : dcg-1d - ham2}\\end{aligned}\\ ] ] note that the pulse shapes from ref .",
    "@xcite have @xmath172 ( @xmath173 for @xmath174 ) ; use of such pulses completely suppresses the subleading hamiltonian  ( [ eq : dcg-1d - ham1 ] ) . in eqs .",
    "( [ eq : dcg-1d - ham1 ] ) , ( [ eq : dcg-1d - ham2 ] ) we kept @xmath175 and @xmath176 non - zero , as for nmr - style self - refocusing pulses@xcite .",
    "in this section we continue using the hamiltonian specified by eqs .",
    "( [ eq : general - hamiltonian ] ) , ( [ eq : ising - network ] ) , ( [ eq : ising - bath ] ) , and ( [ eq : control - general ] ) .",
    "an important property of this hamiltonian is that even in the presence of control on non - neighboring qubits ( e.g. , one of the sublattices ) it separates into small commuting pieces .",
    "these include a `` tuft '' hamiltonian for every controlled qubit @xmath177 : a combination of on - site bath coupling hamiltonian  ( [ eq : ising - bath ] ) with index @xmath177 and all of the nodes ( [ eq : ising - network ] ) from that vertex .",
    "it is easy to see that the corresponding single - tuft unitary can be expressed in terms of the single - qubit average hamiltonian , see eqs .",
    "( [ eq : zeroth - order - ham ] ) , ( [ eq : have1 ] ) , and ( [ eq : have2 ] ) for the first three orders .",
    "we construct the single - qubit rotations using a version of the partial - group eulerian path construction , see sec .",
    "[ sec : intro - eulerian ] .",
    "the qubits are separated into four groups : idle qubits on sublattices @xmath79 and @xmath80 , and the qubits on the same two sublattices which we want to rotate .",
    "these latter should not neighbor each other . in a typical application ,",
    "one - dimensional rotations can be applied to every qubit of one of the sublattices , @xmath79 or @xmath80 .",
    "the sequence is illustrated in fig .",
    "[ fig : y3p ] .",
    "the entire sequence lasts @xmath155 , where @xmath18 is the nominal single - pulse duration , with the entire interval split into sixteen equal intervals of duration @xmath18 . for the idle qubits on sublattice @xmath79 ,",
    "four identical symmetric @xmath9 pulses are executed during the intervals @xmath178 , and @xmath179 [ the top plot , @xmath180 , in fig .  [ fig : y3p ] ] . for the idle qubits on sublattice @xmath80 ,",
    "the @xmath9 pulses of the same shape are executed during the intervals @xmath181 , and @xmath182 , see @xmath183 in fig .",
    "[ fig : y3p ] . on the controlled qubits ,",
    "additional pulses are inserted during the remaining intervals : a symmetric pulse @xmath184 during the intervals @xmath185 , the same but inverted pulse @xmath186 during the intervals @xmath187 , @xmath188 , @xmath189 , and double - duration half - amplitude pulse @xmath150 during the intervals @xmath190 .",
    "all of these pulses should be applied in the direction of the desired rotation .",
    "the curve @xmath191 in fig .",
    "[ fig : y3p ] illustrates a @xmath192 rotation on a qubit of the sublattice @xmath79 .",
    "the average hamiltonian corresponding to such a sequence depends on the chosen graph @xmath75 and on the direction of the applied pulse . for an open four - qubit chain , the desired rotation around the @xmath193 axis for qubits 1 and 3 , and assuming all pulses are symmetric ,",
    "the leading - order average hamiltonian reads @xmath194 this is similar to the case of the partial - group single - qubit dcg , see eq .",
    "( [ eq : dcg-1d - ham0 ] ) : to achieve leading - order decoupling , one needs to use nmr - style self - refocusing pulses with @xmath109 like those developed in refs .  .",
    "the first - order average hamiltonian is a lengthy expression containing the coefficients @xmath195 , @xmath196 , @xmath175 ( corresponding to the angle-@xmath162 pulses ) and two of their counterparts for the @xmath1 pulses , @xmath197 and @xmath198 .",
    "unfortunately , the first - order average hamiltonian remains non - zero even when the second - order pulses similar to those constructed in ref .",
    "are used , with @xmath199 , as well as the regular nmr - style second - order @xmath1 pulses with @xmath200 .",
    "when such pulses are used , we have @xmath201,\\end{aligned}\\ ] ] where we used the assumption @xmath202=0 $ ] , @xmath203=0 $ ] for @xmath204 .    in order to suppress such error terms",
    ", one can use a symmetrized version of the sequence .",
    "namely , the pulses in fig .  [ fig : y3p ] are first executed in reverse order , then directly , for the total duration of @xmath205 .",
    "since the desired rotation is repeated two times , the two @xmath162 pulses in the symmetrized dcg sequence produce a rotation of @xmath206 .",
    "the corresponding leading - order average hamiltonian is just @xmath207 , while in the first order ( when using the second - order pulses with @xmath208 ) , the average hamiltonian is proportional to @xmath175 , @xmath209\\\\ & & \\quad   + ( c_2\\sigma_3^x+s_2\\sigma_3^z)[a_3,b_3]\\bigr\\},%%% \\\\    % % % & & + i{\\tau_p\\xi\\over4 } cs_2    % % % \\left(\\sigma_1^z[a_1,b_1]+\\sigma_3^z[a_3,b_3]\\right ) ,    \\label{eq : dcgi - y3p - ham1}\\end{aligned}\\ ] ] where @xmath210 , @xmath211 as before , and @xmath212 , @xmath213 .",
    "rotation along the @xmath85-axis(shaded region ) using a dcg construction on a bipartite lattice such as a star - graph .",
    "one or both of the sequences of @xmath1 pulses along @xmath4 , @xmath180 and @xmath183 , are executed globally on the idle qubits of the two sublattices .",
    "the single - qubit @xmath192 rotation is implemented as a dcg by adding three pulse - antipulse combinations and the stretched pulse along the @xmath85-axis to the sequence @xmath180 or @xmath183 depending on the sublattice ( @xmath191 is executed on sublattice `` a '' ) .",
    "the pulses in the shaded regions are @xmath214 and the pulses along @xmath4 are @xmath215 from ref .  .",
    "]      with ising couplings , the natural two - qubit gate is the @xmath217 rotation , @xmath218 . to implement such a gate between two neighboring qubits on a bipartite lattice with",
    "always - on ising couplings , one just has to suppress the unwanted couplings .",
    "we design the corresponding sequences starting first with the sequences of hard pulses .",
    "consider two doubled partial - group eulerian sequences , each constructed as four equally spaced @xmath9 pulses , followed by an exactly reversed sequence , see lines @xmath79 and @xmath80 in fig .",
    "[ fig : seq ] . taking the time interval between the pulses to be @xmath219 ( see fig .  [",
    "fig : seq ] ) , the @xmath79 sequence has first four pulses centered at the odd - numbered intervals of duration @xmath219 ( intervals 1 , 3 , 5 , 7 ) , and the trailing four pulses centered at even - numbered intervals ( 10 , 12 , 14 , 16 ) , for the total sequence duration @xmath220 .",
    "the @xmath80 sequence has this pattern reversed , with pulses centered at intervals 2 , 4 , 6 , 8 , 9 , 11 , 13 , 15 .",
    "these sequences provide decoupling of both the single - qubit and the ising hamiltonians , see eqs .",
    "( [ eq : ising - bath ] ) and ( [ eq : ising - network ] ) , as can be deduced from the shading in lines @xmath79 ,",
    "@xmath80 , and @xmath221 in fig .",
    "[ fig : seq ] . due to the sequence symmetry , with @xmath222-pulses ,",
    "all odd orders in the magnus series are suppressed , which guarantees the second order cancellation .",
    "now , any similarly - constructed double - interval sequence ( e.g. , sequence @xmath223 in fig .  [",
    "fig : seq ] ) decouples the corresponding qubit from those on lines @xmath79 and @xmath80 , and also provides the decoupling of the single - qubit hamiltonian  ( [ eq : ising - bath ] ) .",
    "we use this freedom to construct sequences @xmath224 and @xmath223 that provide continuously - varied coupling : @xmath225 where the prefactor @xmath226 is the result of the averaging . with ideal @xmath222 pulses and no dead - time intervals",
    ", the time shift between the sequences must satisfy the condition @xmath227 ; this gives full control over values of the prefactor , @xmath228 .",
    "note also that the leading - order average hamiltonian  ( [ eq : avhamab ] ) becomes exact to all orders , @xmath229 , when the bath couplings [ see eq .",
    "( [ eq : ising - bath ] ) ] are replaced with time - independent energy shifts , @xmath230 , or when the individual bath hamiltonians are dropped , @xmath231 .",
    "when @xmath222-pulses are replaced with soft pulses of duration @xmath18 centered at the same positions , the corresponding leading - order average hamiltonian remains parametrically the same , see eq .",
    "( [ eq : avhamab ] ) . however , since the allowed range of the time shift must be reduced to avoid pulse overlaps , @xmath232 , the prefactor @xmath226 can only be tuned in the range @xmath233 . when used with the nmr - style second - order pulses ( @xmath200 ) ,",
    "the first - order average hamiltonian is zero , while the second - order average hamiltonian is a complicated expression depending on the graph that describes the inter - qubit couplings .",
    "the actual soft - pulse implementation of these sequences used in our simulations is shown in fig .",
    "[ fig : zz ] .",
    "we used @xmath234 and minimum allowed @xmath235 . note that in this particular implementation the prefactor @xmath236 is not adjustable .",
    "rotations on any bipartite graph with equal ising interactions .",
    "the sequences of @xmath1 pulses along the @xmath237axis , @xmath238 and @xmath239 are run on all idle qubits of the sublattices @xmath79 and @xmath80 respectively . which decouple the qubit - qubit interactions as well as the low - frequency phase noise .",
    "for the qubits to be coupled , we replace these with @xmath240 and @xmath241 respectively .",
    "overall this produces an effective hamiltonian with half the ising coupling remaining only for the chosen pairs of qubits , which allows one to implement two - qubit gates .",
    "the second - order self - refocusing pulses @xmath215 have been used in this plot @xcite . ]      the constructions described in the previous two sections , the single - qubit rotations and the adjustable two - qubit @xmath217 gate , form a universal set , meaning that an arbitrary unitary transformation in @xmath146-qubit hilbert space can be expressed as their composition@xcite .",
    "in particular , a single - qubit hadamard gate can be constructed as a combination of two rotations : @xmath242 each of these can be implemented using a single - qubit dcg construction , see sec .  [ sec : dcg ] .",
    "similarly , the controlled - not ( cnot ) gate can be implemented using the following identity@xcite , @xmath243 where the gate is applied on the qubit @xmath244 with the control qubit @xmath245 , @xmath246 and @xmath247 , @xmath248 are the unitaries for single - qubit @xmath249 rotations around the corresponding axes , e.g. , @xmath250 , and @xmath251 , @xmath252 are the conjugate rotations . with the two - qubit @xmath217 rotation implemented as @xmath253 repetitions of the sequence in fig .",
    "[ fig : zz ] , where the average coupling hamiltonian is @xmath254 , the required time interval is @xmath255 . with a single sequence in fig .",
    "[ fig : zz ] of duration @xmath256 , this gives the following crucial design equation , @xmath257 larger values of @xmath258 improve the decoupling accuracy and the gate fidelity in the limit of low noise , but also increase the cost in terms of the number of pulses . for our calculations we used values of @xmath258 from @xmath244 to @xmath259 .",
    "other two - qubit controlled gates such as the controlled-@xmath260 , c-@xmath260 , and controlled-@xmath193 , c-@xmath193 , gates can be similarly implemented by applying suitable transformations to the cnot ( or c-@xmath261 ) gate .",
    "we implemented these using the identities @xmath262 further , two neighboring qubits can be swapped with three cnot gates@xcite .",
    "we emphasize again that our construction allows parallel execution of similar gates on sets of qubits which do not share neighboring pairs .",
    "for example , any set of simultaneous single - qubit rotations on the same sublattice of a bipartite lattice , or simultaneous two - qubit @xmath217 rotations between any set of pairs which do not include neighboring qubits , can be implemented in parallel .",
    "we verified our analytical arguments used to build the quantum gates also by numerical simulations of the single- and the two - qubit gates .",
    "specifically , we computed numerically the unitary evolution matrices @xmath263 corresponding to each of the pulse sequences discussed in the previous sections .",
    "the pulses were applied using the control hamiltonian  ( [ eq : control - general ] ) , in the presence of the ising couplings  ( [ eq : ising - network ] ) and a simplified time - independent bath  ( [ eq : ising - bath ] ) with @xmath264 and the coupling operators @xmath43 replaced by chemical shifts represented by @xmath81-numbers , @xmath230 [ cf .",
    "( [ eq : chemical - shift ] ) ] .    given the `` ideal '' unitary @xmath265 for each gate , we computed the gate fidelity averaged over initial conditions using the equation ( see the appendix in ref .",
    "@xcite ) @xmath266 where @xmath267 is the dimension of the hilbert state , @xmath268 for the case of @xmath146 qubits . specifically , we used two graph families with @xmath269 : a star graph and a chain , see fig .",
    "[ fig : star ] . in both cases , we had the ising coupling hamiltonians  ( [ eq : ising - network ] ) with the fixed values of the couplings , @xmath270 .     star graph and ( b ) @xmath271 chain .",
    "the bonds correspond to ising couplings . ]",
    "all simulations have been done with a custom c++ program using fourth - order runge - kutta algorithm for integrating the unitary dynamics and the ` eigen3 ` library@xcite for matrix arithmetics .",
    "we used 1024 steps per pulse ( @xmath18 ) ; further reducing the step size does not improve the accuracy with standard double precision arithmetics .    here",
    "we discuss the accuracy of the constructed cnot gate , see fig .",
    "[ fig : cnot - seqs ] .",
    "it is implemented in terms of @xmath253 repetitions of the @xmath217-decoupling sequence in fig .",
    "[ fig : zz ] , and four single - qubit operations like the one illustrated in fig .",
    "[ fig : y3p ] , see eq .",
    "( [ eq : cnot ] ) . with the disorder given by chemical shifts only and second - order nmr - style self - refocusing pulses where @xmath112 ( @xmath200 for @xmath1-pulses ) , only the second - order average hamiltonian @xmath272 is non - zero .",
    "this gives the error of the unitary scaling as @xmath273 ^ 3 $ ] , where @xmath274 is the r.m.s .",
    "chemical shift .",
    "the corresponding infidelity should scale as @xmath275 ^ 6    \\label{eq : basic - infidelity - scaling}\\ ] ] on any lattice .",
    "note that we omitted the dimensionless factors dependent on the gate duration , @xmath276 ( the sequences in figs .",
    "[ fig : y3p ] and [ fig : zz ] both have duration of @xmath256 ) , or dependence on the lattice size .",
    "the corresponding scaling and fault - tolerance of this gate set when used to implement quantum memory with the toric code are discussed in sec .",
    "[ sec : scaling ] .",
    "this scaling  ( [ eq : basic - infidelity - scaling ] ) is confirmed in fig .",
    "[ fig : cnots ] , where the infidelities @xmath277 for two lattices as indicated are plotted on log - log scale as a function of r.m.s.chemical shift @xmath278 . for larger @xmath278 , where the infidelities are dominated by the chemical shifts @xmath279 ,",
    "the two graphs are very close and they both have slopes approaching six , in agreement with eq .",
    "( [ eq : basic - infidelity - scaling ] ) .",
    "similarly , for small values of @xmath278 , the infidelities are dominated by the decoupling accuracy of the qubit - qubit interactions @xmath280 . using variants of the same gate with different @xmath281 [ and different @xmath282 ,",
    "( [ eq : tau_p ] ) ] , we verified that in this limit the infidelity also scales as expected from eq .",
    "( [ eq : basic - infidelity - scaling ] ) .",
    "star graph vs.  an @xmath283 chain .",
    "the calculations are averaged over 50 sets of random chemical shifts @xmath279 drawn from a zero - average gaussian distribution . ]",
    "note that a chain where each vertex has at most two neighbors , in the limit of small @xmath26 has the infidelity which is smaller by almost three order of magnitude than that for the star graph of the same size , @xmath283 [ fig .",
    "[ fig : cnots ] ] .",
    "more detailed look into the error distribution associated with such an increase in the infidelity is given by fig .",
    "[ fig : star - weight ] , where the relative and absolute contributions of one- and two - qubit errors to the total gate infidelity are plotted for star graphs with different numbers of leaves . to reduce the relative contribution of the numerical errors , we used sequences similar to those in fig .",
    "[ fig : cnot - seqs ] with @xmath284 .",
    "for small @xmath278 , the infidelity is dominated by the errors in decoupling the inter - qubit couplings . while for a three - qubit chain ( star @xmath285 ) ,",
    "one- and two - qubit errors contribute about a quarter each to the total infidelity in this regime , the contribution of single - qubit errors drops precipitously with the increased number of leaves .",
    "such a dependence is easily explained if we note that the leading- and subleading - order average hamiltonians are suppressed in these calculations , @xmath286 .",
    "the contribution of the higher - order terms is dominated by errors of larger weight : on a star with @xmath287 leaves , there are @xmath288 four - qubit clusters which give contribution to @xmath289 , @xmath290 three - qubit clusters , and only @xmath287 two - qubit clusters .",
    "while these terms are strongly suppressed due to the smallness of @xmath291 , in our simulations it is the errors of weights @xmath292 , @xmath187 and @xmath293 that are most likely to happen . in particular , for @xmath294 ( @xmath188-qubit star ) less than 5% of the total infidelity for small @xmath278 is due to single - qubit errors .     with @xmath284 were used to reduce the relative contribution of the numerical errors . ]",
    "the effect of pulse shape is illustrated in fig .",
    "[ fig : dpulses ] . with first - order pulses ,",
    "only one coefficient is suppressed , @xmath109 ( @xmath295 for @xmath1-pulses ) .",
    "this gives only the leading - order average hamiltonian zero ( @xmath296st order decoupling ) .",
    "similarly , with gaussian pulses , none of the expansion coefficients introduced in sec .",
    "[ sec : intro - average - ham - pulse ] vanishes , so that even the leading - order effective hamiltonian is non - zero ( @xmath297th order decoupling ) .",
    "the corresponding unitaries have errors scaling as @xmath298^{k+1}$ ] with @xmath296 and @xmath297 respectively , which gives the infidelities @xmath299^{2k+2}$ ] .",
    "numerically , we see a dramatic loss in fidelity associated with these pulses .",
    "star graph for different pulse shapes .",
    "we used gaussian pulses , @xmath300 order nmr - type self - refocusing pulses ( @xmath301 from ref .  ) and @xmath302 order pulses ( @xmath303 from ref .  ) . ]",
    "on star graphs with up to six qubits , and also on chains of different length ( not shown ) , we saw that for small @xmath278 the infidelity associated with a single cnot gate is dominated by errors of weight two and larger , while single - qubit errors are relatively suppressed .",
    "such a suppression of few - qubit errors is a typical error distribution expected with any control scheme relying on decoupling sequences to remove the unwanted couplings @xmath280 . indeed , with finite - duration pulses , generally , one can hope to suppress the average hamiltonian only up to some fixed order .",
    "it is the remaining higher - order terms that are predominantly contributing to multi - qubit errors .",
    "an important question is whether such a control scheme can be directly scaled to large systems .",
    "superficially , it is difficult to imagine how this can be the case .",
    "indeed , the coupling hamiltonian  ( [ eq : ising - network ] ) is diagonal , its spectral norm equals the magnitude of the biggest eigenvalue , @xmath304 where @xmath146 is the total number of qubits , and the second equality defines the average product of the vertex degree @xmath287 and the coupling strength @xmath281 .",
    "then , even though formally the convergence radius of the time - dependent perturbation theory is infinite for any finite @xmath146 and @xmath305 , with @xmath146 large , the series is dominated by high orders which are not easily tractable in this form .",
    "nevertheless , the pulse - based control scheme can , indeed , be scalable to large system sizes , when it is combined with an error correcting code .",
    "here we only consider the scalability for the specific case of a toric code implemented on square lattice , with one sublattice used for ancillae and the other one to encode the state to be protected .",
    "an analysis applicable to more general lattices and quantum error - correcting codes will be given elsewhere .",
    "as discussed in the beginning of sec .",
    "[ sec : gate - set ] , the analysis of a collection of pulses simultaneously applied on non - neighboring sites of an ising network is simplified by the structure of the hamiltonian .",
    "the coupling hamiltonian in the interaction representation [ see eq .",
    "( [ eq : ising - network ] ) ] remains a sum of commuting terms : bonds connecting the qubits that are not controlled , and , for every controlled qubit , a `` tuft '' composed of the sum of the operators for the bonds incident to the corresponding vertex .",
    "the errors on these two kinds of clusters will involve at most two and @xmath306 qubits , respectively .",
    "assuming that the phase errors on sites and bonds are properly compensated by the sequences , we are left with the errors due to the individual tuft hamiltonians with the norm limited as @xmath307 the perturbation theory on a single tuft is well controlled when the expansion parameter @xmath308 is small .",
    "the norm of @xmath309-th term in the time - dependent perturbation theory can be upper - bounded by @xmath310 , and for @xmath311 the first non - zero term dominates the expansion .",
    "more precisely , with order-@xmath312 self - refocusing pulses , we have the following upper bound on the total norm of the error operator on a single tuft [ cf .",
    "eq .  [ eq : fid ] ] , @xmath313 when such simultaneous pulse sets are executed repeatedly in a large system , roughly , @xmath314 is the probability amplitude that an error is picked up on a given tuft during a given pulse . at the end of an error correction cycle , after the measurements of all stabilizer generators are done , the system is projected to a particular error configuration with probability given by the square of the sum of all of the amplitudes which give equivalent errors .",
    "while this configuration will contain a finite density of errors , for successful error correction with the toric code@xcite ( as well as generally for codes with limited - weight stabilizer generators , see ref .   for details )",
    "it is important that these errors do not form large clusters . using percolation theory[end : xxx ] , the corresponding condition can be written as the requirement that the total amplitude that a given cluster gets an error during a single cycle be small , @xmath315 with the help of the inequality  ( [ eq : pulse - error - bound ] ) , this gives @xmath316 where we dropped the term @xmath317 assuming @xmath311 .",
    "while this is a valid argument , ( * a * ) it is only applicable in the setting of dynamical decoupling , where all terms associated with the coupling hamiltonian  ( [ eq : ising - network ] ) are suppressed in the average hamiltonian , and ( * b * ) the upper bound @xmath318 on the typical cluster size contributing to the average hamiltonian is too loose and non - specific . in the following sections , we first construct a different version of the same argument , looking at contributions of clusters of different sizes and keeping an accurate track of their count , and then extend the argument to sequences forming non - trivial two - qubit gates .",
    "here we consider a typical pulse sequence of duration @xmath319 designed to produce a single - qubit gate , or a collection of single - qubit gates on some subset of qubits .",
    "we assume a construction similar to the dcgs in sec .",
    "[ sec : dcg ] , where the sequence of a given order @xmath312 ( @xmath320 for the sequence of duration @xmath321 in fig .",
    "[ fig : y3p ] when second - order nmr - style self - refocusing pulses are used ) becomes exact in the limit of infinitely short pulses , @xmath322 .",
    "basically , this means that the full unitary of interest is given entirely by the non - perturbed unitary @xmath323 , while all systematic errors are contained in the slow unitary @xmath324 .    for the toric code ,",
    "the undetectable errors are formed by products of same - kind pauli operators along continuous topologically non - trivial chains@xcite . while the error distribution over ( irreducible ) clusters is given by the average hamiltonian  ( [ eq : cumulants - defined ] )",
    ", we find it more convenient to use directly the expansion of the slow evolution operator @xmath324 , see eq .",
    "( [ eq : r - time - ordered ] ) .",
    "namely , we further expand each term by writing the interaction hamiltonian @xmath325 as a sum of the bond operators .",
    "generally , each term in the resulting expansion can be separated into a product of connected clusters according to which bond operators are present .",
    "the terms in different clusters always commute and , therefore , the corresponding time integrations can be rearranged in the integral  ( [ eq : r - time - ordered ] ) .",
    "then , for any decomposition of the original lattice into a set of disconnected clusters , the corresponding terms in the expansion of @xmath61 factor onto a product of terms corresponding to individual clusters .",
    "the net contribution to a cluster @xmath326 involving @xmath309 bonds can be written as follows @xmath327 where @xmath328 represents the product of @xmath329 terms for the bond @xmath330 evaluated at a subset of time moments @xmath331 , and @xmath332 is the total number of terms in the product .",
    "the condition @xmath333 is needed to ensure that the entire cluster is covered . given the spectral norm for each bond operator , @xmath334 , we have the following bound for the contribution of an @xmath309-bond cluster @xmath335^s.\\ ] ] we replaced the subscript @xmath326 [ see eq .",
    "( [ eq : s - bond - cluster ] ) ] with @xmath309 since the bound  ( [ eq : s - bond - cluster - norm ] ) only depends on the number of bonds @xmath309 in the cluster .",
    "note that for small @xmath336 , the obtained expression scales as @xmath337 .",
    "the effect of dynamical decoupling is to suppress any terms of order @xmath338 in the expansion of @xmath324 . as a result , when expanding @xmath339 , the bound ( [ eq : s - bond - cluster - norm ] ) remains accurate for clusters of size @xmath340 , but there is an additional reduction for small - weight clusters . in particular , with @xmath320 , the bounds for one- and two - bond clusters get modified as follows : @xmath341 where @xmath342 .",
    "overall , for @xmath343 , we can write the upper bound for the amplitude of a given @xmath309-bond cluster as @xmath344 where @xmath345 is the base of the natural logarithm ; this factor can be dropped for @xmath346 . with this result , an upper bound of the amplitude that a given point @xmath4 is in an @xmath309-bond cluster",
    "can be written as @xmath347 where @xmath348 is the number of connected clusters of size @xmath309 which include the point @xmath4 .",
    "for any regular lattice , the number @xmath349 grows at most exponentially with @xmath309 , @xmath350 , where @xmath351 and @xmath352 are some constants that depend on the lattice . a general upper bound on @xmath353 for a degree - limited graph",
    "is given by eq .",
    "( [ eq : power - law ] ) .",
    "overall , for small enough @xmath198 , this gives an exponential tail of the cluster size distribution .",
    "basic conclusion is that errors from parallel single qubit gates stay local as long as they are executed fast enough .",
    "now , consider a sequence of pulses similar to those in figs .",
    "[ fig : zz ] , [ fig : cnot - seqs ] , where the leading - order average hamiltonian @xmath354 is intentionally non - zero , in order to implement a part of some multi - qubit gate . at the same time",
    ", this is an order-@xmath312 sequence : any correction terms appear only in the order @xmath312 and higher of the average hamiltonian expansion , so that @xmath355 , @xmath356 .",
    "now , the actual gate has a duration of @xmath357 , and we want to distinguish between the `` wanted '' effect of the leading - order hamiltonian @xmath354 and the remaining `` unwanted '' terms resulting in errors .",
    "to this end , we use the following decomposition @xmath358^{n_\\mathrm{rep}}=r_0(\\tau_\\mathrm{gate})\\,t_t    \\exp\\left(-i\\int_0^{\\tau_\\mathrm{seq } } dt\\,\\widetilde { \\mathop{\\delta\\ !          h}}(t)\\right),\\ ] ] where @xmath359 corresponds to the `` wanted '' portion of the unitary generated by the sequence leading - order average hamiltonian @xmath360 , and @xmath361 is the remaining part of the interaction hamiltonian in the interaction representation [ see eq .",
    "( [ eq : interaction - hamiltonian ] ) ] , additionally rotated by @xmath362 , @xmath363\\ , r_0(t).\\ ] ]    we are interested in the specific case where the `` wanted '' unitary is a product of two - qubit gates on pairs of qubits corresponding to the edges of the connectivity graph , with each term in the hamiltonian  @xmath364 of the form  ( [ eq : avhamab ] ) , with @xmath365 .",
    "then , the difference hamiltonian @xmath366 is a sum of individual two - qubit bond operators @xmath367 forming the same connectivity graph @xmath75 , with the norm no more than doubled , @xmath368 .",
    "while the unitary transformation  ( [ eq:2nd - average - ham - perturbation ] ) does not change the norm of individual bond operators , it can change their structure . a single - qubit operator @xmath369 or @xmath370 on a qubit from a pair included in @xmath364 is transformed into a two - qubit operator ; and an ising bond with one of its qubits driven can be transformed into a three - qubit operator [ we assume that only non - neighboring bonds are included in @xmath371 .",
    "we can now repeat the arguments from sec .",
    "[ sec:1qubit - clustering ] about the bound  ( [ eq : amplitude - s - one ] ) on the total amplitude of clusters of a given size @xmath309 , connected to a given point @xmath4 .",
    "namely , we treat the extended bonds generated by the transformation  ( [ eq:2nd - average - ham - perturbation ] ) as regular bonds with increased @xmath287 . on square lattice",
    ", this amounts to increasing from @xmath372 to @xmath373 ; this nearly doubles the upper bound for the cluster - number scaling exponent  ( [ eq : power - law ] ) to @xmath374 .",
    "in addition , we have to double the value of @xmath375 to account for possible increased norms of bond operators ; we have @xmath376 .",
    "now that we have an analog of eq .",
    "( [ eq : amplitude - s - one ] ) for a single order-@xmath312 sequence of duration @xmath319 , we will estimate errors after @xmath253 repetitions of the sequence simply by scaling the amplitude of each cluster , and using a percolation - theory argument to account for possible superposition of different clusters .",
    "an amplitude that a given point is connected to a size-@xmath309 cluster is bounded as @xmath377 which is exponentially small at large @xmath309 for @xmath378 and sufficiently small @xmath198 since we assume @xmath379 .",
    "after @xmath253 repetitions of the basic sequence , clusters may overlap .",
    "however , in spite of these overlaps , very large clusters will not form as long as the cluster density is sufficiently far below the percolation threshold .",
    "notice that exponential tail in eq .",
    "( [ eq : any - s - cluster - ampltude ] ) guarantees the existence of a finite percolation threshold .",
    "indeed , an @xmath309-bond cluster can be always covered with a circle of area @xmath380 . for coverage by random circles , a finite percolation threshold exists iff",
    "the radius distribution is such that the average disk area @xmath381 is finite@xcite .",
    "moreover , in a given dimension , the percolation threshold in terms of the average covered fraction has a uniform lower bound which depends on the dimension but not on the details of the radius distribution function@xcite .    in our case",
    ", we can give the following upper bound for the average covered fraction @xmath382 : @xmath383 .",
    "\\nonumber      \\\\      & \\le &   \\pi c n_\\mathrm{rep } ( e\\alpha)^{k+1 }      \\mu{\\partial\\over \\partial\\mu }   \\left[{\\mu(\\mu^{k}-1)\\over            \\mu-1}+{\\mu^{k+1}\\over            1-e\\alpha\\mu } \\right ]      \\\\      & \\le &    \\pi c n_\\mathrm{rep }      ( k+1)(e\\alpha\\mu)^{k+1}\\left[{\\mu\\over ( \\mu-1)^2}+{1\\over            ( 1-e\\alpha\\mu)^2}\\right ] .",
    "\\nonumber\\end{aligned}\\ ] ] since @xmath384 , one needs to ensure at least first - order decoupling ( @xmath378 ) to be able to scale @xmath385 down under the percolation threshold , @xmath386 , and @xmath387 to be able to do it efficiently .",
    "once below the percolation threshold , the amplitude to encounter an error forming a single large cluster becomes exponentially small .",
    "we note that with small @xmath388 , the series  ( [ eq : amplitude - average - area ] ) is dominated by the clusters of size @xmath389 ; these involve @xmath390 qubits and have r.m.s .",
    "linear size of order @xmath391 which corresponds to area @xmath392 . with this estimate ,",
    "we can make a somewhat less conservative estimate of the average covered area fraction  ( [ eq : amplitude - average - area ] ) , @xmath393      the subsequent discussion requires some familiarity with operation of the toric code ; we recommend ref .   for an excellent introduction",
    ".    for a toric code implemented on a plane with separate ancillae for measurement of the plaquette and the vertex stabilizer generators , the entire measurement cycle can be performed in six basic steps : ancilla preparation , four cnot gates , and projective ancilla measurement .",
    "each ancilla for measuring a product of @xmath260 stabilizer generator has to be prepared in the @xmath394 state and measured in the @xmath260 basis , while each ancilla for measuring a product of @xmath261 stabilizer generator has to be initialized in the @xmath395 state and measured in the @xmath260 basis .",
    "we make rather specific ( although not necessarily realistic for every qubit implementation ) simplifying assumptions about the measurement .",
    "namely , we assume ( a ) that a projective measurement in the @xmath260 basis can be done near instantaneously , and ( b ) that after the measurement the qubit appears in the @xmath394 or @xmath396 state according to the measurement outcome .",
    "the assumption ( a ) allows us to avoid additional assumptions about measuring qubits which are coupled , while the assumption ( b ) allows to avoid additional assumptions regarding the ancilla preparation circuit .",
    "notice that the ancillae need not be restored to the @xmath394 state after the measurement .",
    "one limitation of the present scheme is that cnot gates can only be executed on pairs of qubits that do not share neighbors ; effectively this doubles the number of required cnot gates to eight per measurement cycle . as a result ,",
    "the duration of the entire measurement cycle for the toric code is the time it takes to execute two hadamard gates on the ancillae measuring the @xmath261-stabilizer generators , and eight cnot gates .    with the gates implemented as in sec .",
    "[ sec : gate - set ] , a hadamard gate has a duration @xmath205 , and a cnot gate @xmath397 .",
    "the overall cycle duration is @xmath398 where we assumed @xmath399 .",
    "this implies that the expected error - covered area fraction computed for a single cnot gate [ see eq .",
    "( [ eq : amplitude - average - area ] ) ] is increased by an additional order of magnitude .    as a result of the measurement done at the end of each cycle",
    ", the error operator is projected to a state with well - defined stabilizer .",
    "this does not make the error entirely classical as contributions from the error configurations differing by a product of some stabilizer generators have to be added coherently ( these correspond to all deformations of error chains with their ends fixed ) .",
    "note that while the probabilities of various error configurations are , as usual , proportional to the magnitude squared of their amplitudes , a typical outcome will have an error - covered fraction scaling linearly and not quadratically with the estimate in eq .",
    "( [ eq : amplitude - average - area ] ) .",
    "judging from the convergence of the series , for @xmath400 , the likely error configuration will have a spatial structure corresponding to superposition of randomly placed connected clusters involving up to @xmath401 qubits each , with the dominant contribution coming from the biggest size . in the present model where all of the errors come from incomplete suppression of the unwanted couplings ,",
    "( [ eq : ising - network ] ) , we expect to see no correlations between the error patterns encountered in subsequent measurement cycles .    in the discussed model ,",
    "the number of the ancilla qubits equals that of the qubits in the code ; the corresponding per - cycle error probabilities of a qubit error or a measurement error are thus expected to be equal . in the absence of correlations ,",
    "the error positions can be efficiently recovered from repeatedly measured syndromes using the minimal matching algorithm , which gives per - cycle threshold error probability of around @xmath402 per qubit@xcite .",
    "while correlations tend to favor error chains , with @xmath320 , a typical cluster involves four qubits , and it has the linear size of about two lattice constants .",
    "simple scaling suggests that the threshold should not be reduced by more than a factor of four , to about @xmath403 per qubit per cycle . using the area - based estimate @xmath404",
    "[ see eq .",
    "( [ eq : less - conservative - area - fraction ] ) ] , with @xmath320 , @xmath405 , and @xmath406 , we obtain the lower bound for the threshold , @xmath407 , which corresponds to @xmath408 .    note",
    "that this bound is loose as we added the amplitudes of all errors which can happen in the system and have not made any attempt to account for the reduction in the number of error patterns resulting from the projective measurement .",
    "while this estimate proves that the presented universal gate set based on decoupling pulse sequences in a network of qubits with always - on ising couplings can in principle be scalable when used with the toric code , more detailed analysis is needed to optimize the construction and to establish the actual threshold .",
    "in this work we presented the construction and carefully analyzed the errors associated with the universal gate set based on soft - pulse dynamical decoupling sequences .",
    "the gates are designed to work on an idealized network of qubits with always - on ising couplings forming a sparse bipartite graph @xmath75 .",
    "the construction is based on the universal gate set presented by us earlier@xcite , with the difference that now they allow for simultaneous two - qubit gates even in a system where ising couplings are not identical .",
    "the single - qubit gates are based on the dcg construction@xcite ; they allow arbitrary single - qubit rotations",
    ". any combination of single - qubit gates can be executed in parallel on non - neighboring qubits ( e.g. , the entire sublattice of a bipartite graph ) . when used with second - order nmr - style self - refocusing pulses , the constructed sequences eliminate the inter - qubit couplings to second order , and in addition decouple time - independent on - site ising terms ( chemical shifts ) also to second order .",
    "fluctuating ising term ( low - frequency phase noise ) is decoupled to linear order ; second order decoupling of such terms can also be achieved using a symmetrized version of the same construction .",
    "the basic two - qubit gate is an arbitrary - angle @xmath217-rotation ; it can be viewed as a continuous family of doubled eulerian sequences@xcite which allow flexibility of the effective coupling : same average rotation rate can be achieved for qubit pairs with differing ising couplings .",
    "these gates can also be executed in parallel on an arbitrary number of qubit pairs with the restriction that qubits from different pairs can not be directly connected to each other .",
    "in addition to providing controlled removal of unwanted ising couplings to quadratic order ( when used with second - order nmr - style self - refocusing pulses ) , these sequences also decouple low - frequency phase noise to the same order .",
    "we characterized the accuracy of the constructed gates in few - qubit systems using an extension of the analytical average - hamiltonian expansion@xcite , and also numerically by integrating full quantum dynamics of clusters of up to six qubits in the presence of control pulses , coupling hamiltonian , and additional on - site ising terms .",
    "these simulations confirmed that the gates are working as designed , with the systematic portion of the average infidelity of a cnot gate as small as @xmath409 on a chain and @xmath410 on an @xmath283 star graph with @xmath411 repetitions of the basic sequence [ see figs .  [",
    "fig : cnot - seqs ] and [ fig : cnots ] ] .",
    "we also went beyond the fidelity and analyzed the weight distribution of systematic errors generated by our sequences .",
    "it turned out that single- and two - qubit errors are relatively suppressed , while errors of larger weights dominate the evolution .",
    "such an error distribution is expected in any control scheme based on perturbation theory .",
    "scalable quantum computation being the primary target of the present construction , we also analyzed the error patterns that would be expected when this or similarly constructed gate sets are used in a large system .",
    "it turned out that for sequences suppressing the inter - qubit couplings to order @xmath312 , when the couplings are small compared to the inverse sequence duration , dominant errors are formed by clusters involving up to @xmath401 bonds ( up to @xmath390 qubits ) .",
    "while such clusters can sometimes merge forming larger - weight errors , we show that one can choose the parameters so that large error clusters do not form during a measurement cycle that involves several cnot and single - qubit gates .",
    "we analyzed specifically the measurement cycle of the toric code and the corresponding planar layout of qubits and ancillae , and demonstrated that fault tolerant quantum memory can indeed be implemented using our gate set .",
    "a complete analysis of fault - tolerance , e.g. , for the toric code , is beyond the scope of this work .",
    "we notice , however , that the exponential bound eq .",
    "( [ eq : any - s - cluster - ampltude ] ) for the amplitude of a large error clusters is also compatible with the threshold analysis for concatenated codes with noise that involves long - range temporal and spatial correlations@xcite .",
    "fault - tolerance with a concatenated code using the present gate set can be demonstrated by choosing a suitable qubit network , e.g. , a linear qubit chain@xcite .    the most important parameter that governs the likelihood of a run - away large - weight error formation is the sparsity of the coupling network .",
    "it can be characterized by the maximum degree @xmath287 of the corresponding graph . on a chain with @xmath412 , there are only @xmath413 clusters with @xmath309 bonds involving a given qubit ; with @xmath414 , the cluster number grows exponentially with @xmath309 .",
    "this growth has to be overcome by the small expansion parameter @xmath415 : the amplitude of an error cluster involving @xmath309 bonds scales as @xmath416 .    on the other hand , when a large number of qubits are coupled to a single qubit or other quantum system like a harmonic oscillator , it would be much more difficult to control the run - away large weight error formation .",
    "we believe this applies not only to the present gate set based on decoupling sequences , but generally to any kind of control scheme where perturbation theory is used , e.g. , controlled coupling schemes based on tuning qubits in and out of resonance .",
    "we wish to thank kaveh khodjasteh , daniel lidar , and lorenza viola for explaining the working of dcgs .",
    "we would also like to thank alexey kovalev for a number of useful discussions .",
    "this work was supported in part by the u.s .",
    "army research office under grant no .",
    "w911nf-11 - 1 - 0027 , and by the nsf under grant no .",
    "here we derive an upper bound on the number of distinct clusters connected to a given point @xmath4 on a graph @xmath75 with vertex degrees limited by @xmath287 .",
    "first , we notice that a size-@xmath309 cluster containing @xmath4 on @xmath75 , after cutting any loops , can be mapped to a size-@xmath309 cluster on @xmath287-regular tree @xmath417 ( bethe lattice ) , with @xmath4 mapped to the root .",
    "such a mapping can only increase the perimeter ( size of the boundary , i.e. , number of sites outside the cluster but neighboring with a site inside it ) . any size-@xmath309 cluster on @xmath418",
    "has the perimeter @xmath419 ; for a cluster on @xmath39 we have @xmath420 .",
    "second , the number of weight-@xmath309 clusters which contain @xmath4 on @xmath417 is@xcite @xmath421!\\over s!\\ , [ ( z - 2 ) s + 2 ] ! }   \\\\    & = & { s z\\over [ ( z - 2 ) s + 2][(z - 2 ) s + 1]}{(z-1)s\\choose s}.\\quad    \\label{eq : cluster - size - distribution - tz}\\end{aligned}\\ ] ] for large @xmath309 the binomial can be approximated in terms of the binary entropy function , @xmath422 , @xmath423 .",
    "the prefactor in eq .",
    "( [ eq : cluster - size - distribution - tz ] ) is smaller than one for any @xmath424 and @xmath414 ; we obtain @xmath425 for square lattice",
    "( [ eq : power - law ] ) gives @xmath426 ."
  ],
  "abstract_text": [
    "<S> we describe how a universal set of dynamically - corrected quantum gates can be implemented using sequences of shaped decoupling pulses on any qubit network forming a sparse bipartite graph with always - on ising interactions . </S>",
    "<S> these interactions are constantly decoupled except when they are needed for two - qubit gates . </S>",
    "<S> we analytically study the error operators associated with the constructed gates up to third order in the magnus expansion , analyze these errors numerically in the unitary time evolution of small qubit clusters , and give a bound on high - order errors for qubits on a large square lattice . </S>",
    "<S> we prove that with a large enough toric code the present gate set can be used to implement fault - tolerant quantum memory . </S>"
  ]
}