{
  "article_text": [
    "lattice - gas automata dynamics is a discrete form of molecular dynamics . in molecular dynamics",
    "one simulates a many - body system of particles with continuous interaction potentials @xcite .",
    "the particles have continuous positions and momenta . in lattice - gas dynamics the particles positions and momenta are discrete and motion is constrained to a spacetime crystallographic lattice",
    ".    one may also view lattice - gas automata dynamics as an extension of cellular automata , popularized in the physics community by stephen wolfram @xcite .",
    "an elementary treatment of the cellular automata subject is presented by tommaso toffoli and norman margolus in their book on cellular automata machines @xcite .",
    "corresponding to the cellular automata paradigm , lattice - gas automata are ideally suited for massively parallel processing . in lattice - gas automata models , each possible momentum state at a given position",
    "is represented by a single digital bit .",
    "therefore , a pauli exclusion principle is enforced where there can be no more than a single particle per momentum state . as a particle in state @xmath0 at some lattice site of the crystallographic space `` hops '' into state @xmath1 ,",
    "say at a neighboring site , a digital bit is moved from @xmath0 and into @xmath1 .",
    "so in lattice - gas dynamics one simulates a system of boolean particles where the data streaming corresponds to spatial translation and the data permutation corresponds to collisional interactions .",
    "this computational analog of particle dynamics offers an exciting alternative to , and not simply an approximation of , the usual partial differential equations@xcite .",
    "so the lattice - gas methodology has an intrinsic value beyond finite difference schemes .",
    "the lattice gas approach has been extended to a lattice - based krook - bhatnager - gross approximation of the boltzmann equation @xcite , which we call the lattice - boltzmann equation . in place of the exactly computable dynamics of boolean particles , one focuses on a statistical regime where a particle has a probability of occupying a given momentum state .",
    "moreover , many particles can occupy the same momentum state at the same position .",
    "the approach offers both theoretical and computational advantages .",
    "an important theoretical advantage is that one may capture the essential physics of the complex system by stating no more than the system s equilibrium distribution .",
    "computationally it has the advantage of reducing noisy fluctuations in the system at the expense of discarding information concerning particle - particle correlations .",
    "lattice - gas automata in the boltzmann approximation have become one of the most important contributions by the lattice - gas community to high - performance computational physics @xcite .",
    "the lattice - boltzmann equation , usually implemented within one hundred lines of code on a massively parallel processor , allows the researcher to efficiently model complex systems , providing a straightforward particle - based metaphor to computation .",
    "yet it relies on expensive floating point calculations and therefore is most suited for massively parallel machines such as the connection machine-5 ( cm-5 ) . in this paper",
    ", we use the lattice - boltzmann equation only for theoretical analysis  all of our simulations are based on lattice gases .",
    "we have implemented a general lattice - gas automaton on two parallel architectures : the experimental mit cam-8 and the thinking machines corporation cm-5 . very briefly , a cam-8 node has @xmath2 16-bit sites ( 8 mbytes dram ) and a double buffered look - up table ( 2 mbits sram ) , with a clock speed of 25 mhz",
    ". there are no processors , only lookup tables .",
    "the nodes are connected in a 3d mesh .",
    "a cm-5 node has 32 mbytes of dram , four vector units at 16 mhz , and a sparc processor at 32 mhz .",
    "its nodes are connected by a fat - tree network .",
    "the architectures of both machines will be discussed in more detail below .",
    "the presentation here is limited to two - dimensional fluids .",
    "three - dimensional hydrodynamics , immiscible fluids @xcite , multiphase systems @xcite , reaction - diffusion systems , magnetohydrodynamics @xcite , and flow through porous media @xcite are also subjects of active research .",
    "we have implemented hydrodynamic and thermohydrodynamic lattice - gases on the cam-8 , the first lattice - gas experiment conducted on the prototype machine",
    ". results of the cam-8 and cm-5 simulations of the rayleigh - bnard convection instability , kelvin - helmholtz shear instability , and von - karman vortex shedding instability are presented .",
    "our main findings are the following .",
    "the cam-8 delivers 25 million site updates per second per module for a 16 bit lattice gas .",
    "the cm-5 in principle can simulate larger lattices due to its much larger memory size ( 16gbytes on a 512-node partition ) .",
    "in practice the typical problem sizes were almost identical on a 128-node partition of the cm-5 and on an 8-module cam-8 prototype : @xmath3 2d lattices on both machines .",
    "the cm-5 can deliver about 1 million site updates per second per node for a 16 bit lattice gas . for",
    "the cm-5 interprocessor communication cost is small relative to the computation involved in the data streaming and site update when the size of the lattice is large enough .",
    "this suggests that the relatively low communication bandwidth imposes no serious degradation on the delivered performance .",
    "we also find that the delivered performance increases as the lattice size increases , see appendix  [ c * ] .",
    "the best way to report performance of each machine for lattice - gas simulation is to give the site update rate .",
    "the best rate achieved on the thermohydrodynamic lattice - gas was 191 million site updates per second on an 8-module cam-8 and 110 million on on a 256-node partition of the cm-5 . for a simpler problem , the fhp lattice - gas , a 256-node partition of the cm-5 attained a site update rate of 550 million updates per second on a 32k by 2k lattice .",
    "the best rate obtainable on the 8-module cam-8 for the same simple problem is 382 million site updates per second .",
    "the cam-8 prototype is a desktop machine ( see figure  [ cam-8_prototype ] ) containing approximately the same amount of digital logic and memory as is found in a common workstation .",
    "the efficiency of the cam-8 comes at a severe price , in terms of its specialization to a certain class of scientific computations , albeit its applicability is widening @xcite .",
    "let us briefly review some of the historical developments of the lattice - gas subject .",
    "an overview of the lattice - gas subject has also been given by boghosian @xcite .",
    "simple implementations of a discrete molecular dynamics on a square lattice were investigated in the early 1970 s by the french , in particular yves pomeau and coworkers @xcite . by the late 1970 s ,",
    "cellular automata research was underway at the information mechanics group at mit on reversible computation by edward fredkin , tommaso toffoli , and norman margolus@xcite .",
    "the idea of building special - purpose machines to simulate physics - like models on a fine - grained space @xcite originated there and today still remains a strength of that group .",
    "a good review of the kind of cellular automata modeling done in the early 1980 s is given by grard vichniac @xcite . during this time",
    ", stephen wolfram visited the information mechanics group and was stimulated by their work . in 1983",
    "wolfram popularized cellular automata as a simple mathematical model to investigate self - organization in statistical mechanics@xcite .",
    "after visiting the mit information mechanics group in 1983 and seeing a tm - gas simulation on the cam-5 machine of toffoli and margolus@xcite , pomeau realized the potential for simulating large fluid systems and much new interest and activity in the field emerged .",
    "a race began to theoretically prove that a hydrodynamic limit emerges from simple lattice - gas automata .",
    "the intense interest was not stirred as much by the subject of hydrodynamics itself , but instead by the possibility of a simple cellular space - time model capturing such complex natural behavior in an exact way . in 1985",
    "wolfram completed the first hydrodynamics simulations on a triangular lattice @xcite on the connection machine  at this time , lattice - gases were one of the most important applications for the bit oriented single instruction multiple data connection machine . by 1986 frisch , hasslacher , and pomeau had reported the existence of an isotropic two - dimensional lattice - gas on the triangular lattice @xcite . in the same year",
    "wolfram completed the most detailed treatment of the basic theory including novel symmetry considerations and introduced the boltzmann approximation .",
    "_ found the minimal lattice symmetry needed to recover isotropic flow in the continuum limit is a triangular lattice with a particle possessing six momentum states .",
    "their model is now referred to as the fhp - model or hexagonal lattice - gas model . accompanying",
    "the seminal 1986 fhp paper was a paper by margolus , toffoli , and vichniac on cellular - automata supercomputers for fluid - dynamics modeling @xcite .",
    "the contribution of margolus _ et al .",
    "_ complements the theoretical work of frisch _ et al .",
    "_ , pointing out that with dedicated computational hardware the lattice - gas model potentially gains a unique advantage over traditional methods of physical modeling .    by 1987 the lattice - gas methodology",
    "was extended to model three - dimensional flows .",
    "the minimal lattice found by frisch et el .",
    "@xcite was the face centered hypercubic ( fchc ) lattice .",
    "the fchc lattice with 24-nearest neighbors is projected onto three dimensions in a simple fashion by limiting the depth of the fourth dimension of the simulation volume to one lattice link .",
    "research is still underway on finding optimal collisions to minimize the viscosity of the fluid @xcite , however this task has proven very difficult .",
    "the reason for this difficulty is that the fchc lattice - gas has @xmath4 or 16.7 million input configurations . in practice ,",
    "all possible collisions are not included in a simulation because of the large demand for local memory needed to pre - store all the necessary collisional events in table look - up format  an efficient format for implementing complex interactions . to ease memory loads , lattice isometries",
    "are exploited to reduce the size of look - up tables @xcite .",
    "the hope of modeling very high reynolds number flows by lattice - gas automata methods has not yet been realized with models that do not violate semi - detailed balance .",
    "however , lattice - gas models in the boltzmann approximation have shown considerably more success in achieving high reynolds number flows .",
    "recently the first prototype of the next generation cellular automata machine , cam-8 , has been constructed @xcite .",
    "the current 8-module cam-8 prototype , with a site density of @xmath2 16-bit sites per module , has a total of 32 million sites . within the next few years a large cam-8 sponsored by the us air force will be constructed with at least @xmath5 sites and will have a computational rate of approximately 12.5 billion site updates per second .",
    "this site update rate is about two orders of magnitude faster than that achievable with current parallel computers such as the connection machine , cm-5 . in  [ gallery ]",
    "we present some simulation results on the cam-8 prototype and the cm-5 .",
    "there are many reasons for studying lattice - gases , both practical and theoretical .",
    "some commonly cited reasons are oriented towards computer science and issues related to massively parallel processing .",
    "there are also appealing reasons related to modeling physical systems with complex boundary conditions .",
    "the lattice - gas attributes include : 1 ) bit efficiency ; 2 ) inherent simplicity ; 3)logic density ; and 4 ) exact computability .",
    "firstly , lattice - gas automata allow for high bit efficiency .",
    "a single digital bit is used to represent a particle .",
    "unlike in floating point calculations where there exist uncontrolled round - off errors in the least significant bits , in lattice - gases all bits have equal weight , or to quote frisch , there is `` bit democracy . ''",
    "consequently , the efficiency with which bits are used may be higher for lattice - gases .",
    "secondly , lattice - gas automata possess an inherent simplicity . just as simple models in statistical mechanics , such as the ising model , shed light on equilibrium critical phenomena , so too do lattice - gas models shed light on dynamical phenomena@xcite .",
    "moreover , their inherent simplicity gives them pedagogical value since many properties of macroscopic systems can be understood through analytical expressions given very simple local rules .",
    "for example , lattice - gases are a simple way to understand details of fluid systems such as the dependence of the shear viscosity on particle collision rates .",
    "computational fluid dynamics codes are complicated and intricate in their approximations .",
    "lattice - gases are perhaps the simplest expression of navier - stokes flows and are easily implemented .",
    "thirdly , the combination of bit efficiency with the simplicity and locality of some lattice - gas rules allows  in principle  nearly ideal logic density . at the highest logic density that is physically possible",
    ", there is the interesting prospect of lattice - gas architectures built out of `` quantum hardware . ''",
    "there is the expectation that in the future , computation will be achieved on quantum computers @xcite . as the fundamental computational element s size reduces to nano - scale",
    "ranges its behavior is governed by quantum mechanics .",
    "quantum mechanics requires unitary , and hence invertible , time evolution  the microscopic reversibility of the lattice - gas dynamics is important here . even before quantum mechanics becomes a constraint , the reversibility of lattice gas dynamics may become a significant benefit , since at very high logic densities the dissipation of heat caused by irreversible computations will become an issue@xcite .",
    "fourthly , lattice - gas automata are exactly computable .",
    "richard feynman @xcite considered on a discrete spacetime lattice `` the possibility that there is to be an _",
    "exact _ simulation , that the computer will do _ exactly _ the same as nature '' , and that using computers in an exactly computable way may lead to new possibilities in our understanding of physics .",
    "although lattice - gases can not model quantum systems @xcite , they do model classical systems while keeping mass , momentum , and energy exactly conserved .",
    "exact modeling is valuable , for example , in cases where multiparticle correlations are essential to the system s behavior .",
    "lattice - gas simulations can verify theoretical predictions beyond the boltzmann mean - field approximation of uncorrelated collisions : the phenomenon of long - time tails in the velocity autocorrelation function @xcite has recently been observed in lattice gases @xcite .",
    "we first define , in the usual way , what a lattice - gas cellular automaton is .",
    "then we analytically treat the lattice - gas in the boltzmann limit to show that one may use strictly deterministic local rules to obtain the correct macroscopic limit .",
    "we show in particular that a chiral system is adequate to obtain correct hydrodynamics .",
    "we then summarize the derivation of the equations of motion for a thermal lattice - gas .",
    "finally , we discuss our conventions for embedding a hexagonal lattice in a square lattice .",
    "we show the streaming relations used here for local and nonlocal collisions .",
    "variables used are the following    @xmath6 consider a spacetime lattice with @xmath7 spatial sites , unit cell size @xmath8 , and time unit @xmath9 .",
    "particles , with mass @xmath10 , propagate on the lattice with speed @xmath11 .",
    "the lattice vectors are denoted by @xmath12 where @xmath13 .",
    "a particle s state is completely specified at some time , @xmath14 , by specifying its position on the lattice , @xmath15 , and its momentum , @xmath16 .",
    "the particles obey pauli exclusion since only one particle can occupy a single momentum state at a time .",
    "the total number of configurations per site is @xmath17 .",
    "the total number of single particle states available in the system is @xmath18 . with @xmath19 particles in the system ,",
    "we denote the filling fraction by @xmath20 .",
    "the number variable , denoted by @xmath21 , has the value one if a particle exists at site @xmath15 at time @xmath14 in momentum state @xmath22 and zero otherwise .",
    "the evolution of the lattice - gas can be written in terms of @xmath23 as a two - part collision and streaming process .",
    "the collision part permutes the particles locally at each site @xmath24 where @xmath25 represents the collision operator and in general depends on all the particles at the site .",
    "the streaming part permutes the particles globally .",
    "a particle at position @xmath15  hops \" to its neighboring site at @xmath26 and then time is incremented by @xmath9 @xmath27 equation ( [ eq : cellular - update ] ) is the lattice - gas cellular automaton equation of motion . because the dynamics only permutes the occupation of states ,",
    "the system is strictly reversible , see figure  [ collision_streaming ] .      to simplify the theoretical analysis of the lattice - gas dynamics",
    ", it is convenient to work in the boltzmann limit where a field point is obtained by a block average over the number variables .",
    "that is , we may define a single particle distribution function , @xmath28.it should be understood that whenever the single particle distribution function is written , its subscripted index is taken modulo b @xmath29 using the boltzmann molecular chaos assumption the averaged collision operator simplifies to @xmath30 , and by a taylor expansion ( [ eq : cellular - update ] ) we obtain the lattice boltzmann equation @xmath31 a careful treatment of this procedure is given by frisch",
    "a general collision operator is constructed as follows @xmath32 where @xmath33 is a set of occupied particle states and @xmath34 is a scalar coefficient and where each term in the sum is written in factorized form as @xmath35 we expand the distribution function about its equilibrium value , @xmath36 @xmath37 so that , to first order , we have @xmath38 the l.h.s . of ( [ omega - expansion ] ) must vanish , since the particle distribution is non - changing under equilibrium conditions .",
    "the eigenvalues of the jacobian of the collision operator ,    @xmath39    can be calculated and the number of these that vanish must equal the number of invariant quantities in the lattice - gas dynamics . because of the finite - point group symmetry of the spatial lattice , the jacobian matrix will be circulant , its elements can be specified by the difference of their indices , @xmath40 .",
    "this property of the jacobian simplifies the solution of the eigenvalue equation @xmath41 where @xmath42 .",
    "let us make the ansatz that the eigenvectors have the following form @xmath43 then inserting ( [ circulant - ansatz ] ) into ( [ eigen - equation ] ) and taking @xmath44 , gives @xmath45      when implementing a lattice - gas on a parallel computer it is most convenient to use deterministic updating rules .",
    "this is important for several reasons .",
    "first of all , using deterministic rules , the lattice - gas possesses a strict time - reversal invariance .",
    "therefore , it mimics the time - reversal invariance of natural physical laws . as a practical matter",
    ", the reversibility allows one to run the gas dynamics forward to some state and then back to its initial state .",
    "this is a good way to check if the local rules are coded correctly .",
    "second of all , the generation of random numbers typically takes times and using random bits increases the amount of state that the rule must deal with .",
    "therefore , deterministic local rules are used here .",
    "lattice - gas collisions can be catergorized with even or odd chirality .",
    "the method employed here uses even chirality collisions on even time steps and odd chirality collisions on odd time steps , thereby eliminating the need for a random coin toss .",
    "the validity of such a partitioning of the collisions must be justified .",
    "this may be done in a straight forward way using the results of  [ coarse - grained - dynamics ] .",
    "the simplest hydrodynamic example is a definite chirality hexagonal lattice - gas , almost identical to the usual fhp gas except no random coin toss is made . for a hexagonal lattice , @xmath46 , the eigenvectors of the jacobian matrix , ( [ circulant - ansatz ] ) , are simply composed of 1 plus the three roots of -1 @xmath47 where @xmath48 . the collision operator that produces 2-body and 3-body",
    "symmetric collision is the following @xmath49 which is written in expanded form as @xmath50 using ( [ boltzmann - jacobian ] ) the jacobian may be calculated@xmath51}\\end{aligned}\\ ] ] using ( [ circulant - eigenvalues ] ) , the eigenvalues of j may be directly calculated @xmath52 there are only three zero eigenvalues , so the deterministic fhp - type lattice - gas model possesses only three invariants : the total mass and the two components of momentum .",
    "the methodology of successively switching between left and right - handed collision tables is therefore justified , at least in the boltzmann limit .",
    "switching between left and right - handed collision tables is done on the cam-8 since there is no additional time or memory cost ( per module ) incurred in using multiple tables . however , since storing multiple lookup tables costs additional memory on the cm-5 , in practice we use only a single collision table , and therefore , our cm-5 simulations use a chiral lattice - gas .",
    "in fact , the von karman street simulation in  [ gallery ] presented in figure  [ vk_street ] is an example of a chiral lattice - gas .",
    "it is essential to verify that in the macroscopic limit , the cellular automaton equation of motion ( [ eq : cellular - update ] ) leads to navier - stokes hydrodynamics . to verify this , we begin with the most general form of the single particle distribution function , appropriate for even multispeed lattice - gases : the fermi - dirac distribution",
    "fundamentally , this arises because the individual digital bits used to represent particles satisfy a pauli - exclusion principle .",
    "therefore , the distribution must be written as a function of the sum of scalar collison invariants , @xmath53 , implying the following form @xmath54 using the identities in the appendix , an expansion to fourth order of ( [ fermi - dirac - distribution ] ) about zero velocity , close to that previously calculated by chen _",
    "@xcite , is the following @xmath55 where @xmath56 .",
    "the coarse - grain averaged dynamics depend on the following dynamical variables .",
    "+ particle number density : @xmath57 momentum density : @xmath58 moment density flux tensor : @xmath59 total energy density , half the trace of the momentum flux tensor : @xmath60 pressure tensor , @xmath61 : @xmath62 heat flux , @xmath63 : @xmath64 in equilibrium , the cellular automaton dynamical equation ( [ lattice - boltzmann - equation ] ) reduces to    @xmath65    ( [ equil - lattice - boltzmann - equation ] ) implies 3 conservation equations . to obtain these equations , the identities for isotropic lattice vectors given in the appendix are necessary . using ( [ density ] ) and ( [ momentum ] ) in ( [ equil - lattice - boltzmann - equation ] ) gives continuity ( mass conservation ) : @xmath66 using ( [ momentum ] ) and ( [ momentum - flux ] ) in ( [ equil - lattice - boltzmann - equation ] ) gives the navier - stokes equation ( momentum conservation ) : @xmath67 using ( [ pressure - tensor ] ) and ( [ heat - flux ] ) in ( [ equil - lattice - boltzmann - equation ] ) gives the heat equation ( energy conservation ) : @xmath68 where @xmath69 and @xmath70 or @xmath71 .",
    "although the lattice - gas may in principle be comprised of an indefinite number of speeds , from ( [ pressure ] ) we see that the pressure depends upon the square of the bulk velocity , _ i.e. _ it is the difference of the total internal energy of the lattice - gas minus the bulk kinetic energy . in a single speed lattice - gas ,",
    "this kind of velocity dependence is anomalous and is a well known deficiency of the lattice - gas .",
    "however , for a multispeed lattice - gas the existence of this term takes on a physical interpretation . for a classical ideal gas ,",
    "the pressure is proportional to both the sound speed squared and the temperature @xmath72 since @xmath73 , equating ( [ pressure ] ) with the ideal gas law ( [ ideal - gas - law ] ) gives the total internal energy in terms of the bulk kinetic energy @xmath74 and the local particle thermal energy @xmath75 @xmath76 the navier - stokes equation ( [ navier - stokes ] ) , the pressure ( [ pressure ] ) , and the total energy ( [ kinetic+heat_energy ] ) all explicitly have a factor @xmath77 in them .",
    "if @xmath78 , then a multispeed lattice - gas automata would exactly solve the ideal fluid equations where the physical interpretation of the total internal energy would then be that it partitions into a bulk motion term , or kinetic energy , and a fluctuating motion term , or random heat energy associated with a certain gas temperature .",
    "therefore , the multispeed lattice - gas calculation , in the boltzmann limit , would exactly agrees with classical kinetic gas theory , see the expression for the partial pressure of an electron gas given by li and wu @xcite .",
    "the factor @xmath77 approachs one only as the number of speed in the lattice - gas model becomes large .",
    "however , for a small number of speeds , a rescaling of the variables recovers the exact dynamics .",
    "a similar observation has been made by teixeira @xcite in his investigation of multispeed lattice - gas automata models .",
    "in a hexagonal lattice there are six lattice vectors which we enumerate by the following convention @xmath79 where @xmath80 .",
    "the spatial coordinates of the lattice sites may be expressed as follows @xmath81 where @xmath82 and @xmath83 are rectilinear indices which specify the data memory array location used to store the lattice - gas site data . for a multispeed lattice - gas",
    "it is necessary to shift data more than one lattice length .",
    "let @xmath84 . given a particle at site @xmath85",
    ", it may be shifted to a site @xmath86 lattice units away to a remote site @xmath87 by the following mapping @xmath88 where @xmath89 denotes the shifted site , _ i.e. _ @xmath90 with a shift along vector @xmath91 and where division by 2 is considered integer division .",
    "these streaming relations are useful for implementing a lattice gas in a structured language such as the c - language .",
    "our implementation on the cm-5 in the c - language and dpeac use these relations for all address computations . in these streaming relations ,",
    "the modulus operator is base 2 because a two - dimensional hexagonal lattice embedded into a square three - dimensional mesh is pleated .",
    "the simplest way to see this embedding is to define @xmath92 .",
    "therefore the third dimension along the z - axis is narrow , only one lattice distance wide .",
    "half of the lattice sites are at @xmath93 and the other half are at @xmath94 .",
    "this divides the hexagonal lattice into two sublattices that we refer to as _",
    "pleat 0 _ and _ pleat 1_. table  [ stream - vectors ] lists the components of the data translation vectors , or kicks , for each stream direction , @xmath80 , for both pleats .",
    "this kick table was used for the camforth implementation on the cam-8 and the c * implementation on the cm-5 .",
    "this is equivalent our general streaming relations for the case when @xmath95 .",
    "the usefulness of this kind of embedding is that if the data for each one of the sublattices is rendered for display , it can be drawn in simple raster form and fluid structures will appear correctly , _",
    "i.e. _ a sound pulse will appear circular .",
    "the cellular automata machine cam-8 architecture devised by norman margolus of the mit laboratory for computer science @xcite is the latest in a line of cellular automata machines developed by the information mechanics group at mit @xcite .",
    "it is optimized for performing lattice - gas simulations .",
    "the cam-8 architecture itself is a simple abstraction of lattice gas dynamics .",
    "lattice gas data streaming and collisions are directly implemented in the architecture .",
    "the communication network is a cartesian three - dimensional mesh .",
    "crystallographic lattice geometries can be directly embedded into the cam-8 .",
    "each site of the lattice has a certain number of bits ( a multiple of 16 ) which we refer to as a `` cell '' . each bit of the cell , or equivalently each bit plane of the lattice ,",
    "can be translated through the lattice in any arbitrary direction .",
    "the translation vectors for the bit planes are termed `` kicks '' .",
    "the specification of the x , y , and z components of the kicks for each bit plane ( or hyperplane ) exactly defines the lattice .",
    "an interesting property of the architecture is that the kicks can be changed during the simulation .",
    "therefore , the data movement in the cam-8 can be quite general .",
    "once the kicks are specified , the coding of the lattice - gas streaming is completed . in effect , the kicks determine all the global permutations of the data .",
    "local permutations of data occur within the cells .",
    "these permutations are the computational metaphor for physical collisions between particles .",
    "all local permutations are implemented in look - up tables .",
    "that is , all possible physical events with a certain input configuration and a certain output configuration are precomputed and stored in sram , for fast table look - up .",
    "the width of the cam-8 look - up tables are limited to 16-bits , or 64k entries .",
    "this is a reasonable width satisfying the opposing considerations of model complexity versus memory size limitations for the sram .",
    "site permutations of data wider than 16-bits must be implemented in several successive table look - up passes .",
    "since the look - up tables are double buffered , a scan of the space can be performed while a new look - up table is loaded for the next scan .",
    "figure  [ cam-8_system ] is a schematic diagram of a cam-8 system . on",
    "the left is a single hardware module  the elementary `` chunk '' of the architecture . on the right",
    "is an indefinitely extendable array of modules ( drawn for convenience as two - dimensional , the array in normally three - dimensional ) .",
    "a uniform spatial calculation is divided up evenly among these modules , with each module simulating a volume of up to millions of fine - grained spatial sites in a sequential fashion . in the diagram ,",
    "the solid lines between modules indicate a local _ mesh _ interconnection .",
    "these wires are used for spatial data movements .",
    "there is also a tree network ( not shown ) connecting all modules to the front - end host , a sparc workstation with a custom sbus interface card , that controls the cam-8 .",
    "it downloads a bit - mapped pattern as the initial condition for the simulations .",
    "it also sends a `` step - list '' to the cam-8 to specify the sequence of kicks and scans that evolve the lattice - gas in time .",
    "one can view the lattice - gas simulation in real - time since a custom video module captures site data for display on a vga monitor , a useful feature for lattice - gas algorithm development , test and evaluation .",
    "the cam-8 has built - in 25-bit event counters so that measurements can be done in real - time without slowing the lattice - gas evolution .",
    "we have used this feature to do real - time coarse - grain block averaging of the lattice - gas number variables and to compute the components of the momentum vectors for each block .",
    "the amount of coarse - grained data is sufficiently small that it can be transferred back to the front - end host for graphical display as an evolving flow field within an x - window .",
    "see figures  [ convection_rolls ] ,  [ kh_fhp2 ] and  [ vk_street ] for example flow fields .",
    "the thinking machines corporations s cm-5 is a massively parallel computer that contains up to 16384 processing nodes@xcite . figure  [ node ] shows a processing node consisting of a sparc cpu , 32 mbytes of memory and 4 vector processing units .",
    "these processing nodes are all connected via a  fat - tree \" communications net that allows fast inter - node communication .",
    "these processing nodes are controlled by a front - end host computer which is a modified sun workstation .",
    "the sparc processor on each node issues instructions to the vector units and performs most bookkeeping tasks while the vector units perform arithmetic and logical operations on the data .",
    "each vector unit has a peak rate of 32 million 64-bit ops ( floating point or integer ) for a combined total of 128 mops / node .",
    "each node s memory is divided into 8 mbyte banks , one for each vector unit .",
    "each vector unit has it s own independent 128 mbyte / sec path to memory for a combined memory bandwidth of 512 mbyte / sec for each node .",
    "the cm-5 at the army high performance computing research center in minneapolis , minnesota contains 544 nodes for a total of 16 gb of memory and 64 gops of peak processing speed .",
    "we have also implemented a lattice gas simulator on the cm-5 in a multiple instruction multiple data ( mimd ) style .",
    "the cmmd message passing library is used for inter - node communication and host - node interaction . in order to get the highest possible performance we explicitly manipulate the vector units on each node using their assembler language known as dpeac . to ease the burden of hand coding the vector units a macro package known as gcc / dpeac is used .",
    "this package uses features available in the gnu c compiler to issue assembler language instructions from ansi c and simplifies matters considerably .",
    "we partition the problem space into equally sized rectangular units .",
    "each processing node is responsible for updating one of these rectangular units .",
    "this partitioning allows one to send a small number of long messages to connect the space together .",
    "inter - node communication is only necessary along one of the axes of the problem space .",
    "since the inter - node communications network is optimized for long message lengths we expect that this partitioning will make the effective use of available communications bandwidth . within a processing node ,",
    "each of the 4 vector units is responsible for updating it s quarter of the space .",
    "communication between each vector unit s 8 mbyte bank of memory is mediated by the sparc processor .",
    "there are two distinct phases of a lattice gas update cycle .",
    "the first phase is the collision phase where particles can interact .",
    "the second phase involves streaming of the bits to their new locations , consistent with their velocity and the lattice on which the simulation is being performed . in most lattice gas models all collisions can happen concurrently and all sites can stream their data concurrently as well .",
    "the collision phase can be handled via look up tables ( lut s ) for 16 bit sites .",
    "the lut is attractive in that it can be an extremely simple and fast update mechanism .",
    "we have distributed the luts throughout the machine , indeed each vector unit has it s own copy of the lut .",
    "figure [ mem_layout ] shows the memory layout on each node . during the collision",
    "phase each vector unit fetches all the sites in it s partition of the problem space and runs them through it s copy of the lut .",
    "since each vector unit has it s own independent 128 mbyte / sec data path to a bank of memory , this operation can be performed extremely rapidly . with this high degree of parallelism the lut operation",
    "consumes a small fraction of the time necesary to update the space .",
    "as the number of bits of site data grows beyond 16 [ 64k entries ] the lut s begin to consume too much memory . for models that involve larger quantities of site data (",
    "_ i.e. _ # bits @xmath96 20 ) other methods involving lut compression / decompression need to be used for the collision phase.@xcite    the streaming phase is more complex .",
    "the approach taken here is to hold the address of each bit s destination in a pre - computed table .",
    "these tables may be computed in ordinary c , which is advantageous for changing from one model to another .",
    "additionally , potentially complex addressing calculations are performed only once , during initialization .",
    "before a site can be updated , a communication phase must take place so that each site can access all it s neighbors .",
    "communication must take place across node and vector unit boundaries .",
    "the communication is done so that every site has access to all it s neighbor values on one vector unit s 8 mbyte bank of memory . to update a particular site",
    "each vector unit first loads all the neighbors of the site to be updated from the appropriate areas .",
    "then the relevant bits from each neighbor site are extracted sequentially to build up the new site value .",
    "the new site value is then written to memory .",
    "after implementing a lattice - gas simulator with the above considerations in mind we find that we can achieve update rates on the order of 550 msites / sec on a 256 node partition of the cm-5 for the fhp gas model .",
    "this timing was done using a 32k @xmath97 2k lattice .",
    "we find that the longer the system is across each node the greater the performance realized .",
    "this is due to the fact that long system sizes across each node increase the fraction of sites in the interior of each vector unit that do not need to communicate with sites on adjacent vector units or processing nodes .",
    "a well known fluid instability of a thermohydrodynamic system is rayleigh - bnard convection@xcite .",
    "rayleigh - bnard convection is popular because one can observe the onset of order and then the transition to chaos in the flow patterns @xcite .",
    "our implementation of the two - speed hexgonal lattice - gas with a rest particle , includes gravitational forcing , free - slip and no - slip boundaries which may be oriented horizontally , vertically , or inclined @xmath98 , and heating and cooling sites in order to model temperature controlled boundary surfaces .",
    "this has been encoded within the site data space of 16-bits per site for simple implentation on the cam-8 .",
    "the ability of encoding such complex dynamics within 16-bits is one of the remarkable aspects of the lattice - gas formalism in terms of efficient memory use affording us the ability to do flash updating from prestored collision tables .",
    "@xmath99 of the @xmath100 entries in the collision tables are used ( _ i.e. _ , not the identity ) in this model .",
    "similar lattice gas models have been implemented by burges and zaleski @xcite and by chen _",
    "_ @xcite and ernst and das@xcite .    to optimize the collision frequency between the fast and slow particles",
    "we have chosen their momenta to be of unit value .",
    "that is , the slow particles have unit mass , @xmath101 and the fast particles have half the mass , @xmath102 . in this way , @xmath103 and their energies are @xmath104 and @xmath105 . with this convention",
    "we have the usual fhp - type collisions @xcite between the different speed particles while conserving mass , momentum , and energy .",
    "these include head - on 2-body collisions , three - body collisions , collisions with spectators , etc .",
    "grosfils , boon and lallemand have introduced a three - speed thermohydrodynamic gas with speeds @xmath106 and a rest particle @xcite . with this 19-bit model ,",
    "efficient collisional mixing can occur with all particle having the same unit mass . since the particles may now carry different units of energy , in addition to the equation of continuity and euler s equation , in this system we have an energy transport equation .",
    "another well known fluid instability is the kelvin - helmholtz shear instability .",
    "figure  [ kh_fhp2 ] shows the a simulation of a shear instability on a hexagonal lattice @xmath3 in size with toroidal boundary conditions .",
    "a momentum map is overlayed on a vorticity map .",
    "clockwise vorticity is shaded red and counter - clockwise vorticity is shaded blue .",
    "the initial conditions for the simulation are very uniform , see figure  [ kh_fhp2]a .",
    "a gas density is chosen , in this case approximately 1/7 filling , and two horizontal regions are set with uniform , but opposing flow directions .",
    "that is , the majority of the fluid , the background region , is set with a uniform flow velocity of approximately 0.4 @xmath107 ( mach 0.4 ) flowing to the right .",
    "a narrow stripe 256 sites wide is set in the center of the space flowing to the left at -0.4 @xmath107 .",
    "no sinusoidal perturbation is given to the counter - flow narrow stripe region as in previous lattice - gas simulations@xcite .",
    "no external forcing is applied during the simulation run .",
    "the only perturbation is caused by minor fluctations produced by the random number generator when producing a uniform fluid density . after approximately 10,000 time steps , the narrow horizontal center stripe forms a sinusoidal pattern .",
    "the sinsoid s amplitude grows , form a wave that eventually breaks into several counter - rotating vortices and the two flow regions begin to substantially mix .",
    "figure  [ kh_fhp2 ] shows the initial state of the fluid and then the resulting states at 10,000 and 30,000 time steps .",
    "by @xmath108 the formation of a wave is apparent . eventually after 400,000 time steps",
    ", the fluid attains a uniform flow to the right after the system has equilibrated , exactly conserving the momentum in the initial configuration .      figure  [ vk_street ] shows a simulation of vortex shedding from a flat plate after 32,000 time steps on a hexagonal lattice @xmath3 in size .",
    "a momentum map is overlayed on a vorticity map .",
    "clockwise vorticity is shaded red and counter - clockwise vorticity is shaded blue .",
    "a flat plate obstacle is placed in a channel of fluid with a flow directed towards the right of the figure .",
    "the fluid flow is forced by completely reconstructing the fluid s velocity distribution at each time step in a `` forcing strip '' at the left of the channel .",
    "this forcing method prevents sound waves and other disturbances from propagating around the torus in the flow direction and overwhelming the flow behavior .",
    "the boundary conditions are effectively cylindrical .",
    "the flow is started from a random distribution of particles at the appropriate density with a net velocity close to that of the steady state flow . since",
    "this is not a true equilibrium starting condition , some transient behavior appears in the form a sound pulse that propagates down the channel .",
    "this pulse is absorbed by the forcing strip .",
    "after 2000 time steps the system is equilibrated with no transient phenomena visible .",
    "this equilibration time is very short compared with the time necessary for vortex development .",
    "the cylindrical boundary condition appears to work extremely well , allowing one to run the simulation to long times .",
    "we have presented a theoretical description of lattice - gas automata in a discrete d - dimensional space .",
    "attention was focused on two - dimensional fluids for numerical simulation .",
    "we have implemented some lattice - gas fluids on a new prototype cellular automata machine , the cam-8 .",
    "identical models on the cm-5 were also implemented . to illustrate lattice - gas dynamics in the macroscopic limit , several fluid instabilities were tested : ( 1 ) the rayleigh - bnard convective instability just after the critical rayleigh number has been reached in the system by suitable gravitational forcing and temperature gradient ; ( 2 ) the kelvin - helmhotz shear instability ; and ( 3 ) the von karman vortex shedding instability .",
    "the strength of the cam-8 in these simulations is that it is optimized for fine - grained spatial calculations .",
    "it can handle many lookup - tables because of its double buffering .",
    "it can perform data streaming by spatial data shifts without slowing down the simulation . for a multispeed system or a lattice - gas with long - range interactions ,",
    "large shifts are necessary .",
    "the interaction neighborhood on the cam-8 need not be local : data can be shifted to the nearest neighbor or a distance thousands of sites away with the same computational effort .",
    "the strengths of the cm-5 in these simulations are its software , size , and flexibility .",
    "cm-5 applications can be coded largely in standard programming languages such as c and fortran-90 .",
    "cm-5 machines offer the possibility of simulating enormous problem spaces due to their much larger memories . in our implementation",
    ", streaming is done in the cm-5 by address maps preloaded into memory .",
    "although this uses a lot of memory , the flexiblity of precomputed addressing tables simplifies the implementation of complex lattice geometries .",
    "the main theoretical and computational points of this paper are :    \\1 .",
    "deterministic microscopic lattice - gas dynamics produce the correct navier - stokes hydrodynamics in the macroscopic limit where no randomness is used in the local rules .",
    "treating individual digital bits as multispeed fermionic particles allows one to simulate fluid systems where mass , momentum , and energy are exactly conserved and where the dynamics has a time - reversal invariance .",
    "a workstation - scale cam-8 prototype is an efficient , cost - effective platform for lattice gas problems that rivals the capabilities of extant parallel supercomputers .",
    "the lattice gas simulation method may be directly ported to a variety of parallel computer architectures : the facilities provided by most parallel supercomputers are suitable for efficiently running lattice gas applications .",
    "communication costs for running lattice - gas automata simulations decrease as the problem being run increases in size and can essentially be neglected for large systems .    in closing , it is interesting that the massively parallel connection machine 2 , to date has achieved some of the best update rates for lattice - gases , for example , 700 - 750 million sites per second update rate for the fhp lattice - gas@xcite .",
    "building a multiple instruction multiple data connection machine 5 , although more focused on general messaging , has improved upon its predecessor s performance ( for the fhp lattice - gas , currently the cm-5 could exceed 2 billion updates per second on a 1024-node partition ) .",
    "although machines like the cm-5 can solve a wider class of computational problems , we believe that effort spent on exploring locally interacting automata models on fine - grained architectures will lead to new practical methods for accurately modeling physics .",
    "jy would like to thank dr .",
    "bruce boghosian for several discussions , particularly those concerning latttice - gas invariants .",
    "thanks expressed also to donald grantham and dr .",
    "robert mcclatchey of phillips laboratory s atmospheric sciences division for their support of the lattice - gas basic research initiative at our laboratory .",
    "finally , thanks go to dr .",
    "marc jacobs , air force office of scientific research , who promptly arranged for supercomputer time on the connection machine that has proved very valuable to our progress .",
    "research time on the connection machine has been supported by , or in part by the army research office , contract number daal03 - 89-c-0038 with the university of minnesota army high performance computing research center at minneapolis , minnesota .",
    "our cm-5 code for lattice gas simulation will be deposited there for use by interested parties .",
    "our momentum states are @xmath109 , where @xmath110 , and where @xmath111 denotes the particle speeds .",
    "the momentum state - space per particle speed has cardinality @xmath112 .",
    "lattice summations over odd powers of @xmath113 must vanish by symmetry .",
    "the following identities , listed up to the fourth moment , hold for arbitrary values of @xmath112 and spatial dimension @xmath114",
    "@xcite @xmath115 @xmath116 @xmath117 @xmath118      a parallel version of the c - language developed by thinking machines corporation is the c * language@xcite .",
    "this is a well developed language in spirit very close to its predecessor  it is as concise as the c - language itself .",
    "it offers many useful constructs making the coding of algorithms for parallel data very efficient . as typical of most parallel languages",
    ", an array operation is handled in a single instruction  for the most part programming loops do not appear in the code .",
    "most parallel computation is achieved by data movement .",
    "the geometry of the problem is specified at the onset by defining your the data structure s _ shape_.",
    "this is usually a d - dimensional array with a certain size in each dimension .",
    "the shape definition defines all the needed communication topology for the compiler .",
    "it is possible to declare boolean shapes in c*. we have used this feature to encode each bit plane of the lattice - gas .",
    "this is a convenient feature of the language making efficient use of memory . normally , in a lattice - gas code",
    ", one must extract and insert individual bits at the lattice sites .",
    "the option of working directly with boolean arrays has therefore simplified the coding effort substantially .",
    "if individual elements of a parallel array must be accessed , c * uses the syntax of parallel left indexing .",
    "right indexing of arrays is reserved for its usual c - language meaning .",
    "we use right indexed arrays to represent the individual bit planes of the lattice gas .",
    "we have implemented a two - dimensional hexagonal lattice embedded into a three - dimensional mesh .",
    "this implementation is equivalent to our implemention in camforth on the cam-8 and gcc / dpeac on the cm-5 .",
    "streaming of pleat 0 and pleat 1 are coded separately .",
    "we give a c * code fragment for this embedding .",
    "note that the comments to the right of the lines correspond exactly to the kick components listed in table  [ stream - vectors ] . with a few c",
    "* lines of code one can completely implement hexagonal lattice - gas streaming .",
    "we have used the c * command _ to - torus - dim(destination pointer , source , axis , distance ) _ to shift the bit planes with toroidal boundary conditions .",
    "this is an efficient communication routine for sending data in a regular fashion using grid communications .",
    "the partitioning of the space between processors is handled completely by the c * compiler .",
    "we will see how efficiently the compiler does this partitioning in the discussion to follow .",
    "we have tested our c * implementation for different situations .",
    "given a certain lattice size , for example @xmath119 , with have found the performance of the cm-5 to vary linearly with the number of processing nodes .",
    "this linear variation is expected so long as the lattice size is sufficiently large . to determine a reasonable lattice size ,",
    "we have performed repeated simulations with different lattice sizes but with a fixed number of processors .",
    "the results obtained for a fixed 256-node partition of the cm-5 is given in figure  [ cs - embedded - hex ] , in which we plotted simulation site update rates for lattice sizes @xmath120 .",
    "for small lattice sizes , the performance is very poor , on the order of a million site updates per seconds .",
    "this is because the streaming is limited by processor to processor communication bandwidth . as the lattice size increases , the number of sites interior to the node grows and the number of sites on the partition boundary deceases .",
    "consequently , the site update rate continuously improves with larger lattices .",
    "the update rate asymtotically approaches about 25 million site updates per second .",
    "this is equivalent to approximately 100,000 sites updates per processing node .",
    "this is roughly the maximum update rate achievable on a sparcstation 1 .",
    "a full 512-node partition has a peak rate of about 50 million site updates per second , which is about one quarter the speed of the cam-8 .",
    "j.p . rivet and u.",
    "lattice gas automata in the boltzmann approximation . , 302(ii):p .",
    "267 , 1986 . in french .",
    "translation appears in lattice gas methods for partial differential equations , sfi sisoc , eds .",
    "doolen et al . , addison - wesley publishing co. , 1990 .",
    "ccile appert , daniel rothman , and stphane zaleski . a liquid - gas model on a lattice .",
    "in gary  d. doolean , editor , _ lattice gas methods : theory , applications , and hardware _ , pages 8596 .",
    "special issues of physica d , mit / north holland , 1991 .",
    "jeffrey yepez . a reversible lattice - gas with long - range interactions coupled to a heat bath . in gary  d. doolean , editor , _ proceedings of the pattern formation and lattice - gas automata conference_. fields institute , american mathematical society , 1993 .",
    "to appear .",
    "shiyi chen , karen diemer , gary  d. doolen , and kenneth eggert .",
    "lattice gas automata for flow through porous media . in gary  d. doolean , editor , _ lattice gas methods : theory , applications , and hardware _ , pages 7284 .",
    "special issues of physica d , mit / north holland , 1991 .",
    "norman margolus .",
    "cam-8 : a computer architecture based on cellular automata . in gary  d. doolean , editor , _ proceedings of the pattern formation and lattice - gas automata conference_. fields institute , american mathematical society , 1993 . to appear .",
    "stephen wolfram and james  b. salem .",
    "thermodynamics and hydrodynamics with cellular automata . in stephen",
    "wolfram , editor , _ theory and applications of cellular automata _ ,",
    "pages 362365 . world scientific , 1986 . submitted november 1985 .",
    "michel hnon .",
    "viscosity of a lattice gas . in gary  d. doolean , editor , _ lattice gas methods for partial differential equations _",
    ", pages 179207 .",
    "santa fe institute , addison - wesley publishing company , 1990 .",
    "somers and r.c .",
    "rem . the construction of efficient collision tables for fluid flow computations with cellular automata . in p.",
    "manneville , n.  boccara , g.y .",
    "vichniac , and r.  bidaux , editors , _ cellular automata and modeling of complex physical systems _ , pages 161177 .",
    "springer - verlag , februrary 1989 .",
    "proceedings of the winter school , les houches , france .",
    "norman margolus and tommaso toffoli .",
    "cellular automata machines . in gary  d. doolean , editor , _ lattice gas methods for partial differential equations _ , pages 219249 .",
    "santa fe institute , addison - wesley publishing company , 1990 .",
    "the first 8-module cam-8 prototype was operational in the fall of 1992 .",
    "norman margolus .",
    "parallel quantum computation . in w.h .",
    "zurek , editor , _ complexity , entropy , and the physics of information , sfi studies in the sciences of complexity , vol .",
    "viii _ , pages 273287 .",
    "addison - wesley , 1990 .",
    "tsutomu shimomura , gary  d. doolen , brosl hasslacher , and castor fu .",
    "calculations using lattice gas techniques . in gary  d. doolean , editor , _ lattice gas methods for partial differential equations _ , pages 39 .",
    "santa fe institute , addison - wesley publishing company , 1990 .",
    "s.  chen , g.d .",
    "doolean , k.  eggert , d.  grunau , and e.y .",
    "lattice gas simulations of one and two - phase fluid flows using the connection machine-2 . in a.s .",
    "alves , editor , _ discrete models of fluid dynamics _ , pages 232248 .",
    "world scientific , september 1990 .",
    "series on advances in mathematics for applied sciences , vol ."
  ],
  "abstract_text": [
    "<S> a condensed history and theoretical development of lattice - gas automata in the boltzmann limit is presented . </S>",
    "<S> this is provided as background to set up the context for understanding the implementation of the lattice - gas method on two parallel supercomputers : the mit cellular automata machine cam-8 and the connection machine cm-5 . </S>",
    "<S> the macroscopic limit of two - dimensional fluids is tested by simulating the rayleigh - bnard convective instability , kelvin - helmholtz shear instability , and the von karman vortex shedding instability . </S>",
    "<S> performance of the two machines in terms of both site update rate and maximum problem size are comparable . </S>",
    "<S> the cam-8 , being a low - cost desktop machine , demonstrates the potential of special - purpose digital hardware .    </S>",
    "<S> lattice - gas automata fluids on parallel supercomputers    us air force , phillips laboratory , hanscom field , massachusetts    radex corporation , bedford , massachusetts    mit laboratory for computer science , cambridge , massachusetts </S>"
  ]
}