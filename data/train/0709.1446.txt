{
  "article_text": [
    "the structure of complex networks highly affect the critical behavior of different cooperative models @xcite and the nonlinear dynamical process that take place on the network @xcite .",
    "in particular both the directionality of the links which suggest a non symmetric interaction @xcite and the local loop structure @xcite of the network which correlates neighboring nodes has important dynamical consequences .",
    "in fact directionality of links becomes particularly important when a transport process of mass or information takes place in the network @xcite and the loop structure in these directed networks are crucial for assessing the networks robustness characteristics and determining the load distribution .",
    "directed networks are ubiquitous in both man - made and natural systems . some examples of directed networks are the texas power - grid , the world - wide - web , the foodwebs and in biological networks , such as the metabolic network , the transcription network and the neural network .",
    "the local structure of directed network is radically different from the structure of their undirected version @xcite.while many undirected networks are characterized but large clustering coefficient @xcite and large number of short loops @xcite this is not a general trend for directed networks . for example the @xmath0 neural network has a over - representation of short loops compared to a randomized network if the direction of the links is not considered while it has an under - representation of the number of loops when the direction of the links is taken into account @xcite .    nevertheless , while counting small loops is a given network is a relatively easy computation , counting large loops in a real world network is a very hard task .",
    "in fact the number of large loops can , and usually does grow exponentially with the number of nodes @xmath1 in the network .",
    "the known efficient exhaustive algorithms @xcite for counting loops still have a time bound of @xmath2 where @xmath3 are respectively the number of nodes , links and loops in the network .",
    "this task becomes computationally inapplicable for counting large loops in many real networks .",
    "two different approaches for the study of long loops have been proposed : devising montecarlo algorithms , or using belief - propagation ( bp ) algorithms .",
    "the two approaches have both been pursued in the case of undirected networks @xcite .",
    "the bp algorithm  @xcite is a heuristic algorithm which does not have sampling bias as the montecarlo algorithm  @xcite does and is observed to give good results as the size of the network increases .    in this paper",
    "we generalize the bp algorithm proposed by @xcite to directed networks .",
    "we analytically derive the outcome of the algorithm in an ensemble of random uncorrelated networks with given degree sequence of in / out degrees in agreement with the prediction for the average number of nodes in this ensemble @xcite .",
    "we finally study the particular limitations of the algorithm for small network sizes and small number of loops in the graph .",
    "the paper is divided into four further sections . in section 2",
    ", we derive the bp algorithm for directed networks following the similar steps as described in @xcite . in section 3",
    ", we derive the distribution of the small loops in uncorrelated random ensembles . in sections 4 and 5",
    ", we describe the steps in the algorithm and its application to a few characteristic directed networks .",
    "given a network g of @xmath1 nodes and @xmath4 links , we define a partition function @xmath5 as the generating functions of the number @xmath6 of loops of length @xmath7 in the network , z(u)=_lu^l n_l(g ) .",
    "starting with this partition function , we can define a free energy @xmath8 and an entropy @xmath9 of the loops of length @xmath10@xmath9 as the following : f(u)=z(u ) + ( ) = _ l = n .    for each directed link in the network , @xmath11 from node @xmath12 to node @xmath13 ,",
    "if we define a variable @xmath14 which indicates if a given loop passes through the link @xmath15 , the partition function @xmath5 can then be written as z(u)=_\\{s_l}w(\\{s_l})u^_l=1^m s_l , [ z1 ] where @xmath16 is an indicator function of the loops , i.e. it is 1 if the variables @xmath17 have a support which form a closed loop , and it is zero otherwise . as in references  @xcite we take for simplicity a relaxed local form of the indicator function @xmath16 which is 1 also if the assignment of the link variables @xmath18 is compatible with a few disconnected loops .",
    "in particular we take @xmath16 as w(\\{s_l})=_i=1^n w_i(\\{s}_i ) where @xmath19 , and @xmath20 indicates the set of nodes either pointing to @xmath12 or pointed by @xmath12 and where @xmath21 is defined as w_i(\\{s}_i)=\\ {    lcr1 &  _ j_+is_=1   _ j_-is_=1 + 1 &  _",
    "j_+is_=0    _ j_-is_=0 + 0 &    . with @xmath22 and @xmath23",
    "indicating the set of nodes @xmath13 which points to @xmath12 or which are pointed by @xmath12 , respectively . finding the free energy @xmath8 associated with the partition function @xmath24 can be cast into finding normalized distributions @xmath25 which minimize the kullback distance f_gibbs[p_v]=_\\{s_l}p_v(\\{s_l } ) ( ) . in fact it is straightforward to show that @xmath26 assumes its minimal value when @xmath27 .",
    "if the given network is a tree , the trial distribution @xmath28 takes the form p(\\{s_l})=(_l p_l(s_l))^-1(_i p_i(_i ) ) .",
    "[ tree ] with @xmath29 and @xmath30 being the marginal distributions p_(s_)&=&_\\{s_l } s_lp(\\{s_l } ) + p_i(\\{s}_i)&=&_\\{s } \\{s}_ip(\\{s } ) . in a real case ,",
    "when the network is not a tree , we can always take a variational approach and try a given trial distribution of the form ( [ tree ] ) . after taking this variational approach",
    ", we then have to minimize the bethe free energy @xmath31 as f_bethe[\\{p_i},\\{p_l}]=_i _",
    "\\{s}_i s_lp_i(\\{s}_i)()-_l_s_lp_l(s_l)(p_l(s_l)u^s_l ) . for each link",
    "@xmath32 starting from @xmath12 and ending in @xmath13 , there are the constraints p_l(s_l)&=&_\\{s}_ip_i(\\{s}_i ) + p_l(s_l)&= & _ \\{s}_jp_j(\\{s}_j ) .",
    "[ constraint ] introducing the lagrangian multipliers enforcing the conditions @xmath33 and the normalization of the probabilities it is easy to show that a possible parametrization of the marginals is the following , p_l(s_l)&=&(u y_ij _ ji)^s_l + p_i(\\{s}_i)&=&w_i(\\{s}_i)_j _",
    "+ i(u y_ij)^s_<ij>_j _",
    "ij)^s_<ij>. for every directed link @xmath34 from node @xmath12 to node @xmath13 the values of the messages @xmath35 and @xmath36 are fixed by the constraints in eq .",
    "@xmath33 to satisfy the following bp equations : y_ij= + _ ji=. [ bp ] the normalization constants for the marginals is consequently given by c_l&=&1+u y_ij_ji .",
    "+ c_i&=&1+u^2_k_-iy_ki_k _",
    "+ i _ ki . the bethe free energy density @xmath37 becomes nf_bethe(u)=-_l=1^mc_l+_i=1^nc_i .",
    "[ f ] for any given value of @xmath38 the loops length is given by ( u)=_l=1^mp_l(1)=_l . [ ell ] the function @xmath39 can be inverted giving the function @xmath40 and finally proving an expression for the entropy of the loops in the graph under a bethe variational approach , _",
    "bethe()=f(u())-u ( ) .",
    "we consider an ensemble of random directed networks with given degree sequence @xmath41 .",
    "if the maximal in / out connectivities @xmath42/@xmath43 of the network satisfy the inequality @xmath44 , the network is uncorrelated .",
    "by @xmath45 we indicated the degree distribution of the ensemble . in ref .",
    "@xcite an expression for the average number @xmath6 of small loops was given , ( ) ^l valid as long as ln .",
    "[ bound ] is an interesting exercise to see what is the distribution of the number of small loops in the ensemble of directed networks by solving the bp equation for a random directed ensemble in parallel with the distribution found in the undirected case @xcite . in a directed network ensemble",
    "the bp messages @xmath46 and @xmath47 along each link are equally distributed depending only on the value of @xmath38 .",
    "given the bp equations @xmath48 , the distribution @xmath49 of the field @xmath46 has to satisfy the self - consistent equation p(y;u)&= & _ k_out=1^q_0,k_out(y)+_k_in=1^ _ k_out=1^q_k_in , k_out + & & _",
    "0^ dy_1 p(y_1;u )  ,",
    "dy_k_inp(y_k_in;u ) + & & _ 0^d_1 p(_1;u )  d_k_outp(_k_out;u)(y - g_k(\\{y},\\ { } ) ) [ uno ] with g_1=u y_1 + g_k=  k2 . in fact , given a random edge the probability that its starting node @xmath12 has connectivity @xmath50 is given by @xmath51 . the fields @xmath47 have to satisfy a similar recursive equation , i.e. p(;u)&= & _ k_in=1^ q_k_in,0(y)+_k_in=1^",
    "_ k_out=1^q_k_in , k_out + & & _",
    "0^ dy_1 p(y_1;u ) ",
    "du_k_iny_k_inp(y_k_in;u ) + & & _ 0^d_1 p(_1;u )  du_k_out_k_outp(_k_out+;u)(y-_k(\\{y},\\ { } ) ) [ due ] with _ 1=u _ 1 + _ k=  k2 . for a given small value of @xmath52 , the two coupled equations in eq .  @xmath53 and eq .",
    "@xmath54 become independent . by proceeding as in @xcite",
    ", we find that the number of small loops in the ensemble is given by ( ) ^l [ short ] with poisson fluctuations for loops of size @xmath55 . for larger loop sizes up to the boundary limit given by @xmath56 , the average number of loops in the ensemble is still given by @xmath57 but with significant fluctuations in the number of loops .",
    "the study of the partition function eq . @xmath24 carried on in section 2 is such that a new algorithm for counting large loops in a directed network can be formulated . in particular , given a network with @xmath1 nodes and @xmath4 links , the algorithm is :    * initialize the messages @xmath35 , @xmath58 for every directed link between @xmath12 and @xmath13 to random values . * for every value of @xmath38 , iterate the bp equations in eq .",
    "@xmath48 y_ij= + _ ji=. until convergence . *",
    "calculate @xmath39 and @xmath8 from eqn s @xmath59 and @xmath60 which we recall here for convenience ( u)=_l=1^mp_l(1)=_l . nf_bethe(u)&=&-_l=1^m(1+u y_ij_j i ) + & & + _ i=1^n(1+u^2_k_-iy_ki_k _",
    "+ i _ ki ) . *",
    "evaluate @xmath9 by eq .",
    "@xmath61 which again we repeat here for convenience _ bethe((u))=f(u)-(u)u",
    ". [ sigma ]     of the loops of length @xmath7 for the real _ chesapeake _ food - web ( solid line ) and the entropy of the loops counted by exact enumeration ( diamods ) .",
    ", width=245,height=207 ]",
    "we applied the formulated algorithm to a large set of directed networks @xcite .",
    "for some of these networks we calculated the number of loops @xmath6 of lenght @xmath7 directly by exact enumeration @xcite .",
    "we then compare the entropy of the loops @xmath9 find by the bp algorithm with the entropy of the loops @xmath62 find by directed enumeration of the number of loops _ 0()=(n_l = n^ ) we note that for the foodweb with small number of nodes the algorithm does not provide a good approximation for the number of loops present in the graph .",
    "a dramatic example is the chesapeake foodweb . in this case",
    "we were able to count all the loops in the network exhaustively since the network contains very few loops . in this case",
    "the bp algorithm since the loops are few the bp algorithm highly overestimates the largest loop in the network ( see figure [ chesapeake ] ) .",
    "in fact it predict a largest loop of lend @xmath63 where the largest loop is of length @xmath64 .",
    "this effect is observed to be present also in the undirected bp algorithm @xcite .     of the loops of length @xmath7 for the real _ c.elegans _ neural network ( solid line ) and the entropy of the loops counted by exact enumeration for small loops ( small diamods ) .",
    "+ , width=283,height=207 ]    the discrepancy is predicted to be strong only in cases where the size of the network is small and the number of loops in the network is small just as in the chesapeake case .",
    "when the network has a larger number of loops and the entropy of the loops is larger , much better results are expected . in the case of",
    "the _ c. elegans _ neural network ( @xmath65 ) the entropy for small number of loops is overlapping with the results of exact enumeration as it can clearly be seen in figure [ celegans ] .",
    "we further compare the results of the algorithm on a given network and on randomized network ensemble .",
    "a typical example is the metabolic network of _",
    "e. coli _ @xcite in which we could compare the entropy provided by the bp algorithm with the entropy of a series of @xmath66 random network with the same degree distribution .",
    "in conclusion we provide a new algorithm for counting large loops in directed network .",
    "the algorithm is predicted to give good results only for large networks size @xmath1 . in the paper",
    "we demonstrate cases in which it fails to predict the right entropy and loop structure due to the small size of the network .",
    "we propose to study the significance of loops structure in large networks by comparing the results of the algorithm on real networks and randomized networks when networks are large an the number of loops in the network are also large .",
    "we acknowledge g. semerjian and a. e. motter for interesting discussions .",
    "+                                  the network data are available at http://vlado.fmf.unilj.si/pub/networks/data/ ( chesapeake and mondego foodwebs ) , www.cosinproject.org/ ( littlerock and seagrass foodwebs ) , http://cdg.columbia.edu/cdg/ ( _ c .  elegans _ neural network ) , and www.weizmann.ac.il/mcb/urialon/ ( _ s . cerevisiae _",
    "transcription network ) .",
    "the texas power - grid dataset was provided by ken werley ( lanl ) , and the _ e. coli _ metabolic network was generated using flux balance analysis @xcite on the reconstructed metabolic model ije660 available at http://gcrg.ucsd.edu / organisms/. we consider the metabolic network without the metabolites @xmath67 , @xmath68 , @xmath69 , @xmath70 , @xmath71 , @xmath72 , @xmath73 , @xmath74 , and @xmath75 , as in d.  a. fell and a. wagner , nat .",
    "biotech . * 18 * , 1121 ( 2000 ) ."
  ],
  "abstract_text": [
    "<S> we derive a belief - propagation algorithm for counting large loops in a directed network . </S>",
    "<S> we evaluate the distribution of the number of small loops in a directed random network with given degree sequence . </S>",
    "<S> we apply the algorithm to a few characteristic directed networks of various network sizes and loop structures and compare the algorithm with exhaustive counting results when possible . </S>",
    "<S> the algorithm is adequate in estimating loop counts for large directed networks and can be used to compare the loop structure of directed networks and their randomized counterparts . </S>"
  ]
}