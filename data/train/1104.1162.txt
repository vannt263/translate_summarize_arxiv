{
  "article_text": [
    "genetic variants differ in allele frequency by populations , creating stratification due to differential ancestry . as a consequence , case - control studies are susceptible to spurious associations between genetic variants and disease status @xcite .",
    "a large panel of genetic markers can be used to construct an eigenmap , which encodes the ancestry via the relative genetic similarities within the sample . given ancestry coordinates , the effects of population stratification can be controlled by matching cases and controls @xcite or regressing out ancestry @xcite .    in _ gemtools",
    "_ , eigenmaps are constructed using a spectral clustering techniques @xcite , an approach that is closely related to principal component analysis @xcite .",
    "the first computational challenge involves calculation of the inner product matrix @xmath0 , where @xmath1 is an @xmath2 matrix , indexed by @xmath3 subjects and @xmath4 genetic markers .",
    "next , we require the spectral decomposition of an @xmath5 matrix . often the data include tens of thousands of subjects and markers making these computations both slow and memory intensive . to circumvent these challenges",
    "we use a divide and conquer approach that works by clustering individuals of like ancestry and then finding eigenmaps for each cluster .",
    "in addition to computational efficiency , we find that focusing on fine scale structure within clusters facilitates matching of cases and controls of similar ancestry .",
    "thus our approach is faster , more informative , and more accurate than a brute force computational treatment involving the calculation of a single eigenmap of the whole dataset @xcite .",
    "the main function of _ gemtools _ , _ dacgem _ , exploits two features of the problem .",
    "first , for most applications , the eigenmap is not of inherent interest ; the end goal is to cluster subjects of like ancestry . indeed ,",
    "if the sample is drawn from subjects of highly disparate ancestry , an eigenmap of the entire sample will be high dimensional , making it difficult to match , on a fine - scale , subjects of similar ancestry @xcite .",
    "alternatively , if the sample is recursively partitioned into subsets of similar ancestry , then a low dimensional local eigenmap can be estimated for each cluster to determine fine scale structure .",
    "based on a local eigenmap , the cases and controls can be can be matched much more reliably within each cluster .",
    "second , to produce these clusters in a computationally efficient way , it is not necessary to compute the eigenmap using the full sample of @xmath3 subjects",
    ". first we select a _ base _ sample of @xmath6 representative subjects . using this fraction of the data ,",
    "we construct an eigenmap . applying ward s algorithm",
    ", we cluster the base subjects into subsets with relatively similar ancestry . using the nystrom approximation @xcite we project the remainder of the sample onto the map .",
    "finally , each non - base subject is incorporated into the cluster of its nearest base neighbor .",
    "this process is subsequently repeated within each cluster until the resulting subclusters are small and homogeneous . with this divide and conquer approach we restrict the most intensive calculations to the base sample and hence the time and memory required are greatly reduced . at the same time ,",
    "as the algorithm progresses to smaller and smaller clusters , all of the subjects within a cluster can be considered as part of the base sample without incurring any substantial computational cost , and the nystrom approximation is no longer necessary .",
    "our approach builds on the _ spectral - gem _ algorithm @xcite , which provides a context for constructing an eigenmap and subsequent clustering of relatively homogeneous subjects .",
    "this algorithm determines the number of significant dimensions @xmath7 required for each eigenmap .",
    "a genetically homogeneous cluster is defined as one for which the spectral decomposition includes no significant eigen - values @xcite .",
    "the _ dacgem _ algorithm proceeds as follows :    1 .",
    "randomly select @xmath8 subjects and _ mark _ them .",
    "2 .   construct a @xmath9dimensional eigen - map of the marked subjects .",
    "3 .   based on the eigen - map ,",
    "form homogeneous clusters of subjects .",
    "4 .   project unmarked subjects onto the eigen - map . 5 .",
    "group unmarked subjects with nearest cluster in the eigen - map .",
    "repeat steps 1 - 5 for each cluster consisting of @xmath10 or more subjects , until all of the clusters have less than @xmath10 members .",
    "the _ gemtools _ functions are implemented in r and can be run in a variety of operating systems , including windows , linux and macos .",
    "run time is linear in the number of markers ( @xmath4 ) and sub - quadratic in subjects ( @xmath3 ) .",
    "_ gemtools _ provides a computationally efficient alternative to eigenstrat @xcite .",
    "although designed for large data sets , to illustrate _ gemtools _ in detail we used a small sample of publicly available data from the human genome diversity project @xcite .",
    "specifically , we focus on 226 individuals from two continents ( africa and europe ) with 4 and 7 ethnicities representing each continent , respectively . the african ethnicities are biaka pygmies , mandenka , mbuti pygmies , and yorubans .",
    "ethnicities representing europe are adygei , french , french basques , orcadians , italians , russians , and sardinians . from the genome wide platform , and for illustrative purposes ,",
    "we selected only 1,167 nearly independent snps with minor allele frequency greater than 5% ( data posted with software ) .",
    "figure 1 illustrates the outcome of _ dacgem _ using a base sample of @xmath11 and a maximum cluster size of @xmath12 .",
    "the first split separates subjects by continental ancestry .",
    "the second and third splits separate many subjects correctly by ethnicity .",
    "we also applied this method to a multi - ethnic sample including approximately 20,000 subjects with @xmath13 markers , and obtained good results . using a base sample of @xmath14 and maximum cluster size of @xmath15 the run time for this large dataset was 45 minutes with memory use of 6 gb .",
    "direct eigen - analysis and hierarchical clustering of a matrix of order 20,000 is impractical . in its standard implementation , gemtools never uses a matrix of order greater than 1,000 for these two operations . in most steps of the algorithm , matrices are of order less than 500 .",
    "once a cluster with @xmath16 members has been identified , there are two choices for the final step of genetic association analysis . using the _ ccmatchgem _ function an eigenmap for each cluster",
    "is calculated .",
    "cases and controls of like ancestry are matched .",
    "the _ ccmatchgem _",
    "algorithm matches subjects using a @xmath17-dimensional eigenmap , where @xmath18 , and @xmath19 is a user - specified minimum threshold .",
    "alternatively , the clustering process can be continued recursively using the function _ clustergem _ until each cluster has @xmath20 significant dimensions . in this scenario",
    ", one can consider all of the subjects within a sub - cluster as being from a common ancestry and use cluster membership as a factor variable for stratified analysis of the data .",
    "[ [ funding ] ] funding : + + + + + + + +      crossett , a. , kent , b. , klei , l. , ringquist , s. , trucco , m. , roeder , k. , and devlin , b. ( 2010 ) .",
    "using ancestry matching to combine family - based and unrelated samples for genome - wide association studies . , * 29 * , 29322945 .",
    "luca , d. , ringquist , s. , klei , l. , lee , a. , gieger , c. , wichmann , h.  e. , schreiber , s. , krawczak , m. , lu , y. , styche , a. , devlin , b. , roeder , k. , and trucco , m. ( 2008 ) . on the use of general control samples for genome - wide association studies : genetic matching highlights causal variants . , *",
    "82*(2 ) , 453463 .",
    "price , a.  l. , patterson , n.  j. , plenge , r.  m. , weinblatt , m.  e. , shadick , n.  a. , and reich , d. ( 2006 ) .",
    "principal components analysis corrects for stratification in genome - wide association studies . , * 38 * , 904909 ."
  ],
  "abstract_text": [
    "<S> to uncover the genetic basis of complex disease , individuals are often measured at a large number of genetic variants ( usually snps ) across the genome . </S>",
    "<S> gemtools provides computationally efficient tools for modeling genetic ancestry based on snp genotypes . </S>",
    "<S> the main algorithm creates an eigenmap based on genetic similarities , and then clusters subjects based on their map position . </S>",
    "<S> this process is continued iteratively until each cluster is relatively homogeneous . for genetic association studies , </S>",
    "<S> gemtools matches cases and controls based on genetic similarity .      </S>",
    "<S> gemtools source code , documentation , and additional examples are available at http://wpicr.wpic.pitt.edu/wpiccompgen/      roeder@stat.cmu.edu </S>"
  ]
}