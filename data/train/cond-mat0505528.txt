{
  "article_text": [
    "recently , the spin of the electron has caused a resurgence of interest because it promises a wide variety of new devices that combine logic , storage and sensor applications .",
    "moreover , these `` spintronic '' devices might lead to quantum computers and quantum communication based on electronic solid - state devices.@xcite to explain the experimental findings and predict novel magnetic properties of nanostructures , _ ab initio _ electronic structure calculations on these magnetic systems are indispensable .",
    "however , _",
    "ab initio _ electronic structure calculations are usually limited to small and medium size molecular systems .",
    "the obstacle lies in rapidly increasing computational costs as the systems become larger and more complex .",
    "usually , the molecules which possess novel magnetic properties include few hundreds or thousands of atoms .",
    "they are too large to be calculated by conventional _",
    "ab initio _ or density functional theory .",
    "for instance , single - molecule magnets ( smms ) , @xcite which have attracted much interest for the quantum tunneling of magnetization in such systems , are typically very large molecules , e.g. , [ mn@xmath1o@xmath1(o@xmath0cc@xmath2f@xmath3)@xmath4(h@xmath0o)@xmath5@xmath6 , @xcite a smm of mn@xmath1 family , is composed by @xmath7 atoms .",
    "extensively studies on such systems clearly necessitate new methods with desired computational complexity .",
    "linear scaling ( o(n ) ) electronic structure theory in combination with tight - binding , self - consistent hartree - fock ( hf ) or density functional theory ( dft ) has become a very powerful tool to investigate very large complex systems,@xcite such as , the silicon systems,@xcite the giant fullerenes , the low - dimension nanomaterials,@xcite and the biological molecules.@xcite they have been successfully applied to calculate the molecular energies , obtain the optimized molecular geometries and evaluate the static and dynamical molecular properties of very large systems.@xcite many linear scaling methods have already been developed to build the effective hamiltonian@xcite and to avoid cubic scaling roothaan step by replacing it with diagonalization - free alternatives .",
    "@xcite after the algorithms whose computational cost scales asymptotically only linearly with the size of the system are available for building the effective hamiltonian , the roothaan step which updates the occupied spaces becomes the rate - determining step in large enough self - consistent - field ( scf ) calculations .",
    "typically this may occur for calculations involving several thousand basis functions .",
    "two of the main alternatives may be briefly summarized as follows .",
    "one may attempt to update the one - particle density matrix itself,@xcite rather than the molecular orbitals .",
    "recent examples include the improved fermi operator expansion method@xcite and the purification projection schemes which was first proposed by palser and manolopoulos@xcite and later was improved by niklasson and his coworkers.@xcite second , one may attempt to obtain localized molecular orbitals,@xcite rather than the delocalized orbitals that diagonalize the hamiltonian matrix . some systematic comparisons of different approaches have been reported in the context of semiempirical electronic structure methods .",
    "@xcite    however , to the best of our knowledge , linear scaling methods are all exclusively applied to closed shell systems .",
    "as the first attempt of our efforts in the field , we provide a first survey on the possibility of applying the linear scaling methods to open shell systems at self - consistent electronic structure level .",
    "we notice that if the spin multiplicity of the insulating open shell systems can be predetermined , almost all linear scaling methods are readily applicable . but sometimes , without calculations it is hard to determine the spin multiplicity of some complex systems , such as , some inorganic or bioinorganic molecules with the transition metal atoms involved .",
    "usually one needs to calculate few states assuming different spin multiplicities . by comparing their energies one finally determine the spin degree of the systems .",
    "it is inconvenient and time - consuming .",
    "it therefore extremely necessary to develop a method which can automatically determine spin multiplicity of large complex systems while has low computational complexity .",
    "in this work , we develop a general method to determine automatically the spin multiplicity in the calculation and extend the niklasson s trace - correcting density matrix purification algorithm ( tc2 ) to deal with spin unrestricted systems . here , we select the tc2 purification algorithm to demonstrate and implement our new spin unrestricted linear scaling methods since the tc2 purification is very simple and efficient at both low ( @xmath8 ) and high ( @xmath9 ) occupancies .",
    "interestingly , an intriguing density matrix perturbation theory@xcite based on the tc2 purification is proposed and succefully applied to calculate electric polarizability recently.@xcite our methods are implemented in a dft program employing localized numerical atomic orbitals as basis sets.@xcite this paper is organized as follows : in the next section , we shall describe the spin unrestricted linear scaling electronic structure theory .",
    "we illustrate our method by presenting a spin unrestricted version of the tc2 algorithm . in sec .",
    "[ result ] , we describe the details of the implementation and perform some test calculations to illustrate the rightness , robustness , and linear scaling behavior of our methods .",
    "magnetic carbon doped bn nanotubes are studied with the spin unrestricted tc2 method .",
    "our results clearly indicate that the magnetic moments in carbon doped bn nanotubes couple",
    "antiferromagnetically with each other .",
    "we discuss the possibility of applying the spin unrestricted linear scaling methods to magnetic metallic systems in sec .",
    "finally , our concluding remarks are given in sec .",
    "[ conclusion ] .",
    "the most general one - particle reduced density matrix may be written as @xmath10 here @xmath11 ( @xmath12 ) is a combination of a space coordinate @xmath13 ( @xmath14 ) and a spin coordinate @xmath15 ( @xmath16 ) .",
    "it is shown by mcweeny @xcite that in any state where the @xmath17 component of total spin is definite , the two components @xmath18 and @xmath19 must vanish , and the first - order reduced density matrix has the form : @xmath20 for simplicity , we write @xmath21 as @xmath22 , and define the similar abbreviation for @xmath23 . in case where the number of electrons for both spin components are integers , @xmath24 here @xmath25 and @xmath26 are the number of electrons for spin up and spin down components respectively , and @xmath27 represents the total number of electrons .",
    "it indicates that if @xmath25 and @xmath26 are known prior , one can deal with open shell systems without any problem using the linear scaling methods applied to close shell systems .",
    "for example , given @xmath25 and @xmath26 , we can deal with open shell systems using lnvd density matrix minimization ( dmm),@xcite simplified density matrix minimization ( sdmm),@xcite or spectral projection approach . as an example , here we give a spin unrestricted tc2 algorithm with predetermined spin multiplicity ( psutc2 ) to show how it works : @xmath28 with @xmath29 ( @xmath30 is the majority part of the hamiltonian matrix ) where the constants @xmath31 and @xmath32 are the lowest and highest eigenvalues of @xmath33 , respectively .",
    "the purification algorithm for @xmath34 is similar to the above step just with @xmath35 replaced by @xmath36 .",
    "we note that mcweeny has extended his density matrix method to deal with open shell systems with given orbital occupations,@xcite however not in the framework of linear scaling methods . however , sometimes the above algorithm is inconvenient in practical applications since it needs the predefined spin multiplicity .",
    "one shortcoming is that to find the electronic ground states , one must carry out several calculations with different spin multiplicity .",
    "another serious problem is that one may encounter fractional occupation in practical calculations if the spin multiplicity is not the right one with no fractional occupation . under this circumstance",
    ", the algorithm might not be linear scaling using real space representations , or even fail since in this case the density matrix is not idempotent .",
    "here we give a prescription to solve this problem .",
    "we define new @xmath37 and @xmath38 as : @xmath39 here the new operators satisfy @xmath40 , @xmath41 , and @xmath42",
    ". through the newly defined hamiltonian @xmath37 , the spin multiplicity for the ground state can be determined automatically according to the aufbau principle .",
    "it is easy to see that if we find @xmath38 which minimizes @xmath43 within the above constraints , @xmath44 and @xmath34 can be extracted easily from @xmath38 .",
    "in fact , the minimization problem can be solved by many linear scaling methods for closed shell systems .",
    "one difference is that we now deal with matrices with the dimension @xmath45 , here @xmath46 is the number of basis sets .",
    "however , due to the block form of @xmath37 and @xmath38 , the @xmath45 dimension problem can be decomposed into two @xmath46 dimension problems . here",
    "we detail this method by presenting an algorithm based on tc2 projection algorithm .",
    "the spin unrestricted tc2 ( sutc2 ) projection algorithm is given by this pseudocode : @xmath47 - n_e < 0 \\\\",
    "~~ ~~ \\rho_{\\alpha , n+1 } = 2\\rho_{\\alpha , n } - \\rho_{\\alpha , n}^2     \\\\ ~~ ~~ \\rho_{\\beta , n+1 } = 2\\rho_{\\beta , n } - \\rho_{\\beta , n}^2   \\\\ ~~ { \\it else}\\\\ ~~ ~~ \\rho_{\\alpha , n+1 } = \\rho_{\\alpha , n}^2 \\\\ ~~ ~~ \\rho_{\\beta , n+1 } =   \\rho_{\\beta , n}^2",
    "\\\\ ~~ { \\it end}\\\\ ~~ { \\it estimate~ error } \\\\ { \\it end}\\\\ \\rho_{\\alpha }",
    "= \\rho_{\\alpha , n }   \\\\ \\rho_{\\beta } = \\rho_{\\beta , n } ~ .",
    "\\\\ \\end{array}\\ ] ] the scheme can be described as follows : first using the same scaling factors we normalize @xmath30 and @xmath48 to get initial matrices @xmath49 and @xmath50 with all theirs eigenvalues in the range @xmath51 $ ] .",
    "then @xmath52 and @xmath53 are updated in the same way depending on the sum of the traces . in this way , @xmath44 and @xmath34 is obtained using the same purification polynomial .",
    "the monotonicity of the purification polynomial leads to the correct occupations according to the aufbau principle .",
    "although we illustrate our method by presenting only the sutc2 method , however , our method is quite general and can be easily generalized to many other density matrix or localized orbitals based linear scaling methods .",
    "for instance , the kmg functional @xcite can be easily adapted to include spin degrees of freedom given the chemical potential of the magnetic insulating systems .",
    "both schemes developed in this work for dealing with open shell systems are implemented in siesta , a standard kohn - sham density functional program using norm - conserving pseudopotentials and numerical atomic orbitals as basis sets.@xcite in siesta , periodic boundary conditions are employed to simulate both isolated and periodic systems . here",
    "since we aim at large systems , @xmath54-point sampling is used .",
    "there is a linear scaling solver using localized , wannier - like orbitals employing the kmg functional@xcite in siesta .",
    "unfortunately , the convergence of the conjugate gradient ( cg ) minimization of the electronic energy in the first scf step might be extremely slow ( up to 2000 cg iterations , compared to 20 in further scf steps ) .",
    "another inconvenience is the chemical potential must be given prior to conserve the total charge , which might be notably difficult for small gap systems.@xcite thus we implement the robust density matrix purification methods in siesta .",
    "@xcite showed that the multiatom blocked sparse matrix multiplications can be much faster than a standard element - by - element sparse matrix package and also more efficient than the atom - blocked sparse matrix algebra.@xcite the blocking scheme benefits from the use of highly - optimized level-3 basic linear algebra subroutines ( blas ) for large submatrix multiplications .",
    "so in this work , we employ the blocked compressed sparse row ( bcsr)@xcite data structure with multiatom blocks for sparse matrix computations .",
    "we use a multiatom blocked sparse matrix multiplications with dropping ( filtering ) of multiatom blocks with the frobenious norm below a numerical threshold(@xmath55 ) to obtain energy as accurate as 1 mhatree .",
    "relative to the cutoff approach , a major advantage of threshold metered sparse linear algebra is that it avoids discontinuities in the potential energy surface associated with atoms moving in and out of the cutoff radius .",
    "we work in an orthogonal representation though in siesta @xmath37 is evaluated in the nonorthogonal basis of atomic orbitals ( ao ) .",
    "we achieve this by transforming the ao hamiltonian matrix @xmath56 to an orthonormal basis using @xmath57 and obtaining the ao density matrix @xmath58 using @xmath59 , where the inverse factor @xmath60 , and @xmath61 is the cholesky factor for which @xmath62 .",
    "the inverse factor @xmath63 is obtained directly using the state of the art blocked approximate inverse ( ainv ) algorithm.@xcite as for the force and stress calculations , only the orthogonality parts one must care about in our density matrix implementation .",
    "the orthogonality force and stress require the energy - density matrix @xmath64 . in our implementation , the energy - density matrix is calculated as @xmath65 and it is only calculated when the scf reaches its convergence .",
    "all calculations reported here employ the local density approximation ( lda).@xcite and no structural optimizations are performed in all following calculations to save computing resource .",
    "first we validate our methods and our implementation by calculate oxygen molecule with the well known triplet ground state .",
    "as expected , by specifying the spin triplet state , using the psutc2 method , we can get the same energy for the triplet state as that from the diagonalization calculation . and",
    "the sutc2 method can also give the triplet ground state with the same energy for oxygen molecule without given the electronic occupation .",
    "a recent dft calculation indicates that carbon doping induces spontaneous magnetization in bn nanotubes.@xcite the density of states ( dos ) for both carbon substituted bn(5,5 ) nanotube and carbon substituted bn(9,0 ) nanotube display the insulating or semiconducting behavior .",
    "so carbon doping bn nanotubes serve as ideal systems to test our methods .",
    "we choose bn(5,5 ) nanotubes with a boron atom substituted by a carbon for this purpose .",
    "both psutc2 and sutc2 methods are tested . in the psutc2 method , the magnetic moment of these systems is fixed to 1 @xmath66.@xcite for these systems , we find that the psutc2 method is faster by 25% than the sutc2 method . in tc2 methods ,",
    "the efficiency is determined by the magnitude of the band gap.@xcite in the psutc2 method , the convergence for the spin up density matrix is determined by the band gap of the majority part , and so does for the spin down component .",
    "however , the convergence in the sutc2 method depends on the magnitude of the system band gap , which is always smaller in ferromagnetic ( fm ) systems . for antiferromagnetic ( afm ) systems ,",
    "the system band gap are the same as the band gaps for both spin components , and the sutc2 method should be as efficient as the psutc2 method .",
    "so , the psutc2 method is prefered for systems where the spin multiplicity is known prior .",
    "for systems without knowledge for the spin multiplicity , one should use the sutc2 method to account for the magnetic moment of the systems . furthermore ,",
    "if we assume the spin multiplicity is not changed in all scf cycles , we can combine the efficiency of the psutc2 method and the robustness of the sutc2 method by using sutc2 method in the first scf cycle and using psutc2 method in the following scf cycles .",
    "[ fig1 ] shows the cpu time per scf cycle for the diagonalization and psutc2 methods .",
    "three different basis sets ( single-@xmath67 ( sz ) , double-@xmath67 ( dz ) , double-@xmath67 plus polarization functions ( dzp ) ) are employed .",
    "the diagonalization method clearly shows a o(n@xmath68 ) scaling , in contrast sharply to the linear scaling behavior of the psutc2 method for all basis sets .",
    "the critical system size where the psutc2 method is faster than the diagonalization method is dependent on the basis set employed .",
    "for instance , the critical system size is 320 , 300 , and 200 for sz , dz and dzp basis sets respectively .",
    "following the recent discovery of ferromagnetism at room temperature in an all - carbon system consisting of polymerized c60,@xcite there has been increased interest in magnetism in metal - free systems .",
    "although previous experiment indicated a preference for zig - zag and near zig - zag bn tubes,@xcite a very recent high - resolution electron diffraction study on bn nanotubes grown in a carbon - free chemical vapor deposition process revealed a dispersion of the chiral angles @xmath35 in the ranges of @xmath69 and @xmath70.@xcite chiral bn nanotubes usually contain large number of atoms in a unit cell , e.g. , bn(7,6 ) nanotube have 508 atoms in a unit cell with chiral angle @xmath71 .",
    "these nanotubes are difficult to be treated using traditional methods . here",
    "we conduct a linear scaling spin unrestricted calculation on bn(7,6 ) nanotube with a boron atom substituted by a carbon .",
    "the dz basis set is employed for this purpose . for better comparison with carbon doped bn(5,5 ) nanotube",
    ", we show the structure and calculated spin density for both carbon doped bn(5,5 ) nanotube with 500 atoms per cell and and carbon doped bn(7,6 ) nanotube .",
    "clearly , the distribution of spin density for both carbon doped nanotubes is basically the same : the spin density is mainly contributed by carbon 2@xmath72 orbital and the nitrogen atoms near carbon have some small magnetic moments . to learn more knowledge about the electronic and magnetic properties of the system",
    ", we obtain the density of states ( dos ) by a non - scf calculation using diagonalization .",
    "[ fig3 ] shows the total dos ( tdos ) as well as carbon partial dos ( pdos ) for both carbon doped bn(5,5 ) nanotube with 500 atoms per cell and carbon doped bn(7,6 ) nanotube .",
    "we can see that in the plotting energy range , in both cases carbon has sizable contribution only to the two states around the fermi level .",
    "the shape of the dos is very similar for both carbon doped bn nanotubes .",
    "also these dos resemble that of carbon doped bn(5,5 ) nanotube with 80 atoms per cell provided by wu _",
    "@xcite except that the band gap in our case is smaller possibly due to the lda functional we employed .",
    "previous calculations indicated there exist magnetic moments in carbon doped bn nanotubes and our calculations confirm it .",
    "then , how the local magnetic moments in carbon doped bn nanotubes couple with each other : ferromagnetically or antiferromagnetically ? here we conduct some calculations on bn(7,6 ) nanotube with two boron atoms substituted by two carbon atoms to address this issue .",
    "six different configurations ( a , b , c , d , e , and f ) are considered , as shown in fig .",
    "[ fig4](a ) .",
    "the total energy of both afm and fm states for these six carbon doped bn nanotubes is shown in fig .",
    "[ fig4](b ) .",
    "generally , the relatively energy difference converges much faster along with the cutoff radius for the density matrix than the absolute total energy .",
    "in fact , some test calculations indicate that the deviation of the energy difference from the exact value is smaller than 10 mev . as shown in fig .",
    "[ fig4](b ) , structure b with afm state is the most stable configuration among these six carbon doped bn(7,6 ) nanotubes .",
    "moreover , we can see that when two carbon atoms are in the same hexagonal ring , the afm state is more favorable over the fm state .",
    "in addition , the energy difference for b is larger than that for a possibly due to the fact that the two carbon 2@xmath72 orbitals in b are more parallel and thus the superexchange afm interaction in b is larger .",
    "if the distance between two carbon atoms is larger than 3  , i.e. , two carbon atoms are not in the same hexagonal ring , the coupling between two magnetic moments is negligibly small .",
    "so from fig .",
    "[ fig4](b ) , we can conclude that the magnetic moments in carbon doped bn nanotubes couple antiferromagnetically with each other .",
    "recently , developing linear scaling methods to deal with metallic systems has attracted much interest .",
    "baer and head - gordon developed an energy renormalization - group method , with which the computational effort scales near linearly with system size even when the density matrix is highly nonlocal.@xcite goedecker _ et al .",
    "_ showed that in addition to the real - space localization of the density matrix , there is also a localization in fourier space .",
    "@xcite within the multiresolution wavelet representation it was shown how the sparsity of the density matrix is preserved for localized insulating systems as well as for itinerant metallic systems .",
    "@xcite combining such techniques with our methods , o(n ) calculations on metallic magnetic systems might be possible since the number of matrix multiplications in the tc2 purification , essentially is independent of system size even for metallic systems.@xcite although , there are no unfilled shells in spin unrestricted hf theory , as proved by bach _",
    ", @xcite however , for spin unrestricted dft methods , sometimes fractional occupation is possible . in principle , the fractional occupation problem can be treated using pm@xcite or trs4@xcite purification .",
    "so the generalized spin unrestricted form of pm or trs4 purification can treat these systems .",
    "to conclude , we give a first survey on applying linear scaling electronic structure methods to spin unrestricted systems .",
    "two methods are proposed to deal with systems with or without predetermined spin multiplicity respectively .",
    "we demonstrate our methods by detailing the psutc2 and sutc2 projection algorithms .",
    "the current methods have been implemented in a kohn - sham density functional program employing numerical atomic orbitals as basis sets .",
    "we apply our method to deal with magnetic carbon doped bn nanotubes .",
    "carbon doped bn(7,6 ) nantoube has similar magnetic properties as carbon doped bn(5,5 ) nantoube .",
    "moreover , fm coupling is unfavorable for carbon doped bn nantoubes .",
    "the results suggest that our methods pave the way for carrying out linear scaling calculations on spin unrestricted systems , such as magnetic nanostructures .",
    "this work is partially supported by the national project for the development of key fundamental sciences in china ( g1999075305 ) , by the national natural science foundation of china ( 50121202 , 10474087 ) , by the ustc - hp hpc project , by the edf of ustc - sias , and by the sccas .",
    "e. artacho , j. d. gale , a. garca , j. junquera , r. m. martin , p. ordejn , d. snchez - portal , and j. m. soler , user s guide for siesta 1.3 ( http://www.uam.es/departamentos/ciencias/fismateriac/ siesta / manual-1.3/index.html ) ."
  ],
  "abstract_text": [
    "<S> we present an extension of density matrix based linear scaling electronic structure theory to incorporate spin degrees of freedom . when the spin multiplicity of the system can be predetermined , the generalization of the existing linear scaling methods to spin unrestricted cases is straightforward . </S>",
    "<S> however , without calculations it is hard to determine the spin multiplicity of some complex systems , such as , many magnetic nanostuctures , some inorganic or bioinorganic molecules . </S>",
    "<S> here we give a general prescription to obtain the spin - unrestricted ground state of open shell systems . </S>",
    "<S> our methods are implemented into the linear scaling trace - correcting density matrix purification algorithm . </S>",
    "<S> the numerical atomic orbital basis , rather than the commonly adopted gaussian basis functions is used . </S>",
    "<S> the test systems include o@xmath0 molecule , and magnetic carbon doped bn(5,5 ) and bn(7,6 ) nanotubes . using the newly developed method , we find the magnetic moments in carbon doped bn nanotubes couple antiferromagnetically with each other . </S>",
    "<S> our results suggest that the linear scaling spin - unrestricted trace - correcting purification method is very powerful to treat large magnetic systems . </S>"
  ]
}