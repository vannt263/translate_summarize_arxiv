{
  "article_text": [
    "there have been many development in statistics in which geometry , represented by an extension from euclidean to more general spaces , has proved fundamental .",
    "thus , reproducing kernel hilbert spaces is a part of gaussian process methods , sobolev spaces are used for , and besov spaces , for wavelets .",
    "differential geometry , riemannian manifolds , curvature and geodesics are at the core of information geometry , shape analysis and manifold learning .",
    "this paper is concerned with cat(0 ) , and , more generally , cat(k ) .",
    "although related to riemannian manifolds ( @xmath0 denotes the riemannian curvature ) these metric spaces have a less rigid structure and are qualitatively different from the spaces mentioned above .",
    "trees are among the first examples in which cat(0 ) properties have been used in statistics and bioinformatics @xcite : the set of trees ( the tree space ) becomes a geodesic metric space ( to be defined ) when for each tree , the edge lengths are allocated to entries in a vector of sufficient dimension to capture all the tree structures .",
    "then , the metric is the euclidean geodesic distance on a simplicial complex called a  fan \" which is induced by the tree structure : the geodesics are the shortest piecewise linear paths in the fan .",
    "such spaces have already been shown to be cat(0 ) @xcite by gromov s theory @xcite .    for a random variable @xmath1 on a metric space",
    "@xmath2 endowed with a metric @xmath3 the general _ intrinsic mean _ is defined by @xmath4 the empirical intrinsic mean based on data @xmath5 , sometimes called the frchet mean , is defined as @xmath6 where @xmath7 for euclidean space , @xmath8 , the sample mean . in general , @xmath9 is not necessarily convex and the means , @xmath10 , are not unique .",
    "figure [ fig : hyperboloid ] shows that the curvature can affect the property of @xmath9 . in particular , for so - called cat(0 ) spaces , which ( trivially ) include euclidean spaces , the intrinsic means @xmath10 are unique .     for data on",
    "( a ) a hyperboloid ( curvature @xmath11 ) , ( b ) a plane ( @xmath12 ) and ( c ) a sphere ( @xmath13 ) .",
    "the bluer represents the smaller value of @xmath9 . only for the sphere",
    ", @xmath9 has multiple minima .",
    "one hundred data points are sampled independently from a `` gaussian mixture , '' whose density is proportional to @xmath14 where @xmath15 and @xmath16.,title=\"fig:\",width=166 ] + ( a ) hyperboloid     for data on ( a ) a hyperboloid ( curvature @xmath11 ) , ( b ) a plane ( @xmath12 ) and ( c ) a sphere ( @xmath13 ) .",
    "the bluer represents the smaller value of @xmath9 . only for the sphere",
    ", @xmath9 has multiple minima .",
    "one hundred data points are sampled independently from a `` gaussian mixture , '' whose density is proportional to @xmath14 where @xmath15 and @xmath16.,title=\"fig:\",width=166 ] + ( b ) plane     for data on ( a ) a hyperboloid ( curvature @xmath11 ) , ( b ) a plane ( @xmath12 ) and ( c ) a sphere ( @xmath13 ) . the bluer represents the smaller value of @xmath9 . only for the sphere",
    ", @xmath9 has multiple minima .",
    "one hundred data points are sampled independently from a `` gaussian mixture , '' whose density is proportional to @xmath14 where @xmath15 and @xmath16.,title=\"fig:\",width=166 ] + ( c ) sphere    even when the mean is not unique , the function @xmath9 can yield useful information , for example about clustering .",
    "we can also define second - order quantities : @xmath17 and @xmath18 a key concept in the study of these issues is that the metrics are global geodesic metrics , that is metrics based on the shortest path between points measured by integration along a path with respect to a local metric .",
    "the interplay between the global and the local will concern us to a considerable extent .",
    "for some intuition , consider a circle with arc length as distance and the uniform measure .",
    "the frchet intrinsic mean is the whole circle .",
    "we can say , informally , that the non - uniqueness arises because the space is not cat(0 ) .",
    "although the curvature is zero in the riemannian geometry sense , there are other considerations related to `` diameter '' , which prevents it from having the cat(0 ) property @xcite .",
    "if we use the embedding euclidean distance rather than the arc distance , we have the _ extrinsic mean _ , but again , we obtain the whole perimeter . see @xcite for further discussion on the intrinsic and extrinsic means .",
    "the empirical case is also problematic .",
    "for example , two data points on a diameter , with arc length as distance , give intrinsic means on the perpendicular diameter .",
    "simple geometry shows that the empirical extrinsic mean is the whole circle .",
    "we also cover the more general cat(@xmath0 ) spaces giving some new results related to  diameter \" as well as conditions for the uniqueness of intrinsic means not requiring the spaces to be cat(0 ) .",
    "the general form of @xmath9 depends , here , on three parameters , @xmath19 and it can be written in compact form : @xmath20 where the function @xmath21 and the construction of @xmath22 are given below .",
    "once we have introduced this new class of metrics , variety of statistics can be generalised ; intrinsic mean , variance , clustering ( based on local minima of @xmath9 ) . for classification problems , we can select an appropriate metric by cross - validation .",
    "theoretically , we have the opportunity to apply well studies areas of geometry compared with methods based on selection of a good `` loss function . '' in table [ table : generalised_statistics ] , we summarise such generalised statistics .        ' '' ''     + metrics & @xmath23 & @xmath24    ' '' ''     + intrinsic mean & @xmath25 & @xmath26    ' '' ''     + variance & @xmath27 & @xmath28    ' '' ''     + clustering function & @xmath29 & @xmath30    ' '' ''     +    there are many ways to transform one metric into another , regardless of whether they are geodesic metrics .",
    "a straightforward way is to use a concave function @xmath31 such that given a metric @xmath32 , the new metric is @xmath33 .",
    "this is plausible if we use non - convex @xmath34 , which are useful , as will be explained , in clustering and classification .",
    "such concave maps are often interpreted as loss functions , but we will consider them in terms of a change of metric which may lead to selection using geometric concepts .",
    "this is particularly true for the construction of @xmath21 in this paper .",
    "the basic definition and construction from a geodesic metric space to the special geodesics based on accumulation of density are given in the next section , together with the definition of a cat(0 ) space .",
    "in section 3 , we first show that means and medians in simple one - dimensional statistics can be placed into our framework . because geodesics themselves are one - dimensional paths , this should provide some essential motivation .",
    "the @xmath35-metric is obtained by a local dilation .",
    "our computational shortcut is to use _ empirical _ graphs , whose vertices are data points .",
    "we will need , therefore , to define empirical geodesics .",
    "we start with a natural geodesic defined via a probability density function in which the distance along a path is the amount of density  accumulated \" along that path .",
    "then , an empirical version is defined whenever a density is estimated .",
    "we might have based the paper on kernel density estimates ; instead , we have adopted a very geometric construction based on objects such as the the delaunay complex and its skeleton graph .    in section 4 , the @xmath36 metric is introduced .",
    "it is based on a function derived from a geodesic metric via shrinking , pointwise , to an abstract origin ; that is to say an abstract cone is attached . the smaller the value of @xmath37 , the closer to the origin ( apex ) .",
    "the geometry of the two dimensional case drives our understanding of the general case because of the one - dimensional nature of geodesics .",
    "we prove that , for finite @xmath37 , the embedding cone is cat(@xmath0 ) with smaller @xmath0 than the original space .",
    "we cover the more general cat(@xmath0 ) spaces , giving some new results related to  diameter \" , in section 5 , including conditions for the uniqueness of intrinsic means not requiring the spaces to be cat(0 ) .",
    "section 6 provides a summary of the effect of changing @xmath38 and @xmath37 . after some discussion on the selection of @xmath38 and @xmath37 in section 7 , section 8 covers some examples .",
    "the fundamental object in this paper is a geodesic metric space .",
    "this is defined in two stages .",
    "first , define a metric space @xmath39 with base space @xmath1 and metric @xmath40 .",
    "sometimes , @xmath41 will be a euclidean space @xmath42 of dimension @xmath43 , containing the data points , but it may also be some special object such as a graph or manifold .",
    "second , define the length of a ( rectilinear ) path between two points @xmath44 and the geodesic connecting @xmath45 and @xmath46 as the shortest such path .",
    "this minimal length defines a metric @xmath47 , and the space endowed with the geodesic metric is called the geodesic metric space , @xmath48 .",
    "the interplay between @xmath49 and @xmath50 will be critical for this paper , and , as mentioned , we will have a number of ways of constructing @xmath51",
    ".    for data points @xmath52 in @xmath1 , the empirical intrinsic ( frchet ) mean is @xmath53 there are occasions when it is useful to represent @xmath54 as a sub - manifold of a larger space ( such as euclidean space ) @xmath55 with its own metric @xmath56 .",
    "we can then talk about the extrinsic mean : @xmath57 typically , the intrinsic mean is used as an alternative when the geodesic distance , @xmath51 is hard to compute .",
    "the difficultly in considering the intrinsic mean in @xmath58 is that it may not lie in the original base space @xmath1 .",
    "this leads to a third possibility , which is to project it back to @xmath1 , in some way , as an approximation to the intrinsic mean @xmath59 ( which may be hard to compute ) .",
    "we will discuss this again in section 4 .",
    "cat(0 ) spaces , which correspond to non - positive curvature riemannian spaces , are important here because their intrinsic means are unique .",
    "the cat(0 ) property is as follows .",
    "take any three points @xmath60 in a geodesic metric space @xmath1 and consider the  geodesic triangle \" of the points based on the geodesic segments connecting them .",
    "construct a triangle in euclidean 2-space with vertices @xmath61 , called the comparison triangle , whose euclidean distances , @xmath62 , are the same as the corresponding geodesic distances just described : @xmath63 , etc . on the geodesic triangle",
    "select a point @xmath45 on the geodesic edge between @xmath64 and @xmath65 and find the point @xmath46 on the edge @xmath66 of the euclidean triangle such that @xmath67 .",
    "then the cat(0 ) condition is that for all @xmath68 and all choices of @xmath45 : @xmath69 for a cat(0 ) space ( i ) there is a unique geodesic between any two points , ( ii ) the space is contractible , in the topological sense , to a point and ( iii ) the intrinsic mean in terms of the geodesic distance is unique .",
    "cat(@xmath0 ) spaces , a generalization of cat(0 ) spaces , are explained in section [ sec : cat_k ] .",
    "let @xmath1 be a @xmath43-dimensional euclidean random variable absolutely continuous with respect to the lebesgue measure , with density @xmath70 .",
    "let @xmath71\\}$ ] be a parametrised integrable path between two points @xmath72 in @xmath73 , which is rectifiable with respect to the lebesgue measure .",
    "let @xmath74 with appropriate modification in the non - differentiable case , be the local element of length along @xmath75 .",
    "the weighted distance along @xmath75 is @xmath76 the geodesic distance is @xmath77 here we consider a random variable on euclidean space but this can be generalized for riemannian manifolds and even for singular spaces with a density with respect to a base measure naturally defined by the metric .    from the geodesic distances on distributions we shall follow three main directions :    1 .",
    "transform the geodesic metrics in various ways with parameters @xmath78 to obtain a wide class of metrics , 2 .",
    "discover ( locally ) cat(0 ) and cat(@xmath0 ) spaces for certain ranges of the parameters , 3 .",
    "apply empirical versions of the metrics based on an empirical graph whose nodes are the data points .",
    "there is an important distinction between global transformations applied to the whole distance between points and local transformations applied to dilate the distance element .",
    "the general @xmath35 metric is a dilation of the original distance @xmath43 and what we have referred to as a local metric .",
    "it is obtained by transforming the density in ( [ eq : geodesic_dist ] ) .",
    "thus for @xmath71\\}$ ] between @xmath79 and @xmath80 , @xmath81 and @xmath82 changing @xmath38 essentially changes the local curvature . roughly speaking ,",
    "when @xmath38 is more negative ( positive ) , the curvature is more negative ( positive ) .    in the next subsection",
    ", we look at the one - dimensional case .",
    "although this case is elementary , good intuition is obtained by rewriting the standard version in terms of a geodesic metric .",
    "assume that @xmath1 is a continuous univariate random variable with probability density function @xmath70 and cumulative distribution function ( cdf ) @xmath83 .",
    "the mean @xmath84 achieves @xmath85 .",
    "here we are using the euclidean distance : @xmath86 .",
    "the median is defined by @xmath87 . on a geometric basis",
    ", we can say that @xmath88 achieves @xmath89 , where we use a metric that measures the amount of probability between @xmath45 and @xmath90 : @xmath91 carrying out the calculations :    @xmath92    which achieves a minimum of @xmath93 at @xmath94 , as expected .",
    "now let us consider the sample version .",
    "let @xmath95 be the order statistics , which we assume are distinct .",
    "one of the first exercises in statistics is to show that @xmath96 minimises @xmath97 , with respect to @xmath98 .",
    "for the median , first consider using the first of the two approaches with the empirical cdf @xmath99 .",
    "we obtain various definitions depending on our definition of @xmath100 and @xmath101 , or just using convention . using the metric approach",
    "the natural metric is to take @xmath102 with the standard definition of @xmath103 .",
    "applied to distinct data points @xmath104 this is equal to @xmath105 .",
    "for an arbitrary @xmath98 @xmath106 where @xmath107 .",
    "then , @xmath108 is achieved at @xmath109 when @xmath110 is odd and at @xmath111 when @xmath110 is even .",
    "another approach for the median would be to take a piecewise linear approximation to @xmath100 which is equivalent to having a density @xmath103 that is proportional to @xmath112 in the interval @xmath113 .",
    "then , the metric is @xmath114 and @xmath115 is achieved at @xmath109 when @xmath110 is odd and at @xmath116 , when @xmath110 is even .",
    "we can think of this last result in another way .",
    "consider the points @xmath117 as points in @xmath118 $ ] , take the empirical mean of the points and transform them back with the cdf corresponding to @xmath103 , namely , the piecewise linear approximation .",
    "the idea of weighting intervals should provide intuition when we extend the intervals to edges on a graph , because edges are one - dimensional .",
    "there are a number of options to produce an empirical version of the @xmath22 metric , based on the data .",
    "one such option would be to produce a smooth empirical density @xmath119 followed by numerical integration and optimization to compute the geodesics .",
    "we prefer a much simpler method based on a graph constructed from the data .",
    "all geodesic computation is then restricted to the graph .",
    "we list some candidates ( see appendix [ graphs ] for a description of the second and third candidates listed below ) :    1 .   the complete graph with vertices at the data points and all edges , 2 .   the edge graph ( 1-skeleton ) of the delaunay simplicial complex with vertices at the data points , 3 .",
    "the gabriel graph with vertices at the data points .",
    "the discussion below applies to the complete graph or any connected sub - graph . for any such graph , define a version of the @xmath22 distance just for edges , @xmath120 where @xmath121 is the euclidean distance from @xmath122 to @xmath123 .",
    "this can be explained by making a transformation @xmath124 we refer to this as _",
    "edge regularization_. we then apply @xmath38 in the usual way to obtain @xmath125 the new  length \" of each edge @xmath126 is obtained by integrating this  density \" along the edge . in this sense",
    ", @xmath127 also plays the role of density estimation .",
    "although we need a regularization @xmath128 with respect to the dimension @xmath129 for density estimation @xcite , we manage the regularization by rescaling the parameter @xmath38 .",
    "note that @xmath130 gives the unit length and @xmath131 restores the original length .",
    "now we consider only the set of edges @xmath132 of the graph @xmath133 as a metric space with the metric defined by the geodesic : @xmath134 where the infimum is taken over all ( connected ) paths @xmath75 between @xmath135 and @xmath136 .",
    "note that even if @xmath128 can estimate the local density well , it does not follow that the metric @xmath35 can be approximate by the metric @xmath137 since edge lengths @xmath127 on each path @xmath75 are not independent .",
    "it is suggested that further theoretical work is necessary .",
    "here we will admit @xmath137 as an approximation of @xmath35 .",
    "if the graph is not a complete euclidean graph with weights equal to the euclidean lengths of the edges , some edges may not be in any edge geodesics between any pair of vertices .",
    "for an edge - weighted graph @xmath138 with weights @xmath139 on the graph , @xmath140 , which is the union of all the edge geodesics between all pairs of vertices , is called the geodesic sub - graph ( or geodesic graph ) of @xmath138 .",
    "we will see how the geodesic sub - graphs transform as the value of @xmath38 changes .",
    "we make an important general position assumption that the set of values @xmath141 are distinct , that is there are no ties .",
    "this is an additional general position assumption to that given for the delaunay cells ( see appendix [ graphs ] ) .",
    "we order the values using only a single suffix for simplicity : @xmath142 where @xmath143 . for @xmath144 ,",
    "this induces the @xmath145 values : @xmath146    now , consider the geodesics as @xmath147 .",
    "recall that a circuit in a graph is a connected path that begins and ends in some vertex and an elementary circuit is a circuit that visits a vertex no more than once .",
    "consider an edge @xmath148 that has the following property which we call @xmath149 : it is in an elementary circuit @xmath150 of the graph in which all other edges have smaller values of @xmath127 namely @xmath151 then , the path @xmath152 ( within the circuit ) from @xmath122 to @xmath123 not containing the edge @xmath153 has length smaller than @xmath154 when @xmath38 is sufficiently negative : @xmath155    from this argument , we see that for sufficiently large @xmath156 as @xmath38 approaches @xmath157 , every edge having property q is removed from the geodesic sub - graph , and we obtain a tree .",
    "let us summarize this algorithm , which applies to a general edge - weighted graph with distinct edges .",
    "we refer to this algorithm as the _ backwards _ algorithm .",
    "it clearly gives a tree .",
    "let @xmath158 and label the edges @xmath159 in increasing order of their weights .",
    "starting with edge @xmath160 , remove @xmath160 if it is in a cycle otherwise continue to @xmath161 .",
    "( general step ) continue downwards at each stage removing an edge if it is in a cycle of the remaining subgraph .",
    "4 .   stop if no more edges can be removed using step 3 .",
    "there is a natural _ forwards _ algorithm that also yields a tree as follows .    1 .",
    "let @xmath158 and label the edges @xmath159 in increasing order of their weights .",
    "starting with @xmath162 , add an edge if adding it does not create a cycle .",
    "3 .   ( general step ) continue adding an edge at each step provided that the addition does not create a cycle . 4",
    ".   stop if no more edges can be added .",
    "we have the following .    given a connected edge - weighted graph @xmath133 , the backward and forward algorithms yield the same tree , which we call @xmath163 .",
    "let @xmath164 and @xmath165 be the trees generated by the backward and forward algorithms respectively .",
    "any edge of @xmath138 not in @xmath164 can not be in @xmath165 , because it is in a circuit of edges with lower weights than itself , by the forward construction .",
    "this is sufficient because each tree has the same number of edges .",
    "in fact , the tree can be constructed by the simple rule : remove all edges that are in a circuit with  smaller \" edges ; the order in which the edges are removed is irrelevant .",
    "although there are several implementations of forward and backward minimal spanning tree algorithms , their importance here is to give intuition for the construction of geodesics as @xmath166 .",
    "we now show that the tree @xmath163 is the minimal spanning tree in a strong sense .",
    "[ tree1 ] let @xmath133 be a graph with @xmath167 and distinct edge weights @xmath168 .",
    "there is a unique spanning tree @xmath163 whose ordered weights @xmath169 have the following minimal property . if @xmath170 are the ordered weights of any other spanning tree , then @xmath171 with strict inequality for at least one @xmath172 .",
    "moreover @xmath163 is given by the forward ( or backward ) algorithm .",
    "proof . the proof is obtained by contradiction .",
    "let @xmath173 be the tree constructed by the forward algorithm .",
    "let @xmath174 be another spanning tree with ordered weights @xmath170 and suppose that for some @xmath175 with @xmath176 , we have @xmath177 .",
    "let the edges of @xmath178 and @xmath174 be @xmath179 and @xmath180 , respectively . since @xmath181 , we must have @xmath182 . in the sequence @xmath159 ,",
    "let @xmath183 and @xmath184 ; then , we must have @xmath185 . by the nature of the forward algorithm ,",
    "new vertices are used only when an edge is included by the algorithm : all unused edges form circuits and therefore use edges of the tree constructed up to that point .",
    "thus , the subgraph of @xmath133 with edges @xmath186 has exactly @xmath187 vertices ; this value is attained on the addition of the last edge @xmath188 .",
    "however , @xmath174 , which is a subgraph of @xmath133 , attains @xmath187 vertices at @xmath189 with @xmath185 which is a contradiction .",
    "the ordering property in theorem [ tree1 ] is known from the theory of stochastic ordering : if the empirical cdfs of the distances @xmath190 and @xmath191 are @xmath140 and @xmath192 , respectively , then @xmath193 with strict inequality for at least one value ( in fact , over at least one non - empty interval ) .",
    "thus , not only @xmath194 but also @xmath195 for any non - decreasing function @xmath31 .    for sufficiently negative @xmath38 ,",
    "the tree @xmath196 itself , that is the tree as a metric space with metric @xmath22 , is a cat(0 ) space .",
    "we need to extend the metric somewhat so that it applies to the edges , in addition to the nodes . thus , for any two points @xmath197 on the tree ,",
    "define @xmath198 where the integral is taken along the ( unique ) path @xmath199 on the tree and @xmath200 when line element @xmath201 is in edge @xmath202 in @xmath199 .",
    "[ cat1 ] there is an @xmath203 such that for any @xmath204 , the geodesic sub - graph becomes the minimal spanning tree @xmath163 endowed with the @xmath22 metric and , therefore , becomes a cat(0 ) space .",
    "we see that for sufficiently negative @xmath38 , _ every _ geodesic defined with the @xmath22 metric lies in the tree @xmath173 .",
    "in fact , although we started with a general connected graph , any graph for which the edges can be mapped into a euclidean interval gives a cat(0 ) tree using this construction .",
    "there are some well - known algorithms and considerable literature on minimal spanning trees .",
    "remarkably , the minimal spanning tree for a complete euclidean graph is the same as the minimal spanning tree for the delaunay graph and is therefore a subgraph of the delaunay graph .",
    "[ tree2 ] let @xmath138 be a complete edge - weighted graph whose weights are distinct and monotonically related to those of the complete euclidean graph @xmath205 of a point set @xmath1 in @xmath43 dimensions .",
    "then , @xmath138 , @xmath205 , the gabriel graph and the delaunay graph of the point set @xmath1 all have the same and unique minimal spanning tree .    versions of this result are known in two dimensions @xcite , but the authors had some difficulty in finding a concise proof in the literature .",
    "we present a proof in appendix [ proof - mst ] .",
    "thus , any algorithm for finding the minimal spanning tree of a graph will give the minimal spanning tree of the delaunay graph , without having to find the full delaunay complex for any euclidean space into which the points can be embedded .",
    "further , as seen previously , the minimal spanning tree has the strong minimal property in the sense of theorem [ tree2 ] .",
    "we may study the geometry as @xmath38 increases away from @xmath157 .",
    "following theorem [ tree1 ] , we are interested in two cases : the euclidean delaunay graph and the complete euclidean graph . in both cases , we consider the @xmath22 metric .",
    "[ thm : alpha - chain ] let @xmath206 be an edge - weighted graph with distinct weights @xmath207 and let @xmath208 be its geodesic subgraph ; then , @xmath209    proof .",
    "this follows from the consideration of geodesics .",
    "an edge @xmath153 in @xmath138 is not in @xmath208 if it is not a geodesic . in this case",
    ", there is an alternative path @xmath75 from @xmath210 to @xmath175 such that @xmath211 .",
    "however , this inequality is preserved if @xmath38 is decreased , so that @xmath212 is increased .",
    "thus an edge absent from @xmath208 is absent from @xmath213 .",
    "+      let @xmath214 be a geodesic disk of radius @xmath215 centred at @xmath216 .",
    "define the maximum radius @xmath217 of the disk centred at @xmath45 as being cat(@xmath0 ) , that is @xmath218 see section [ sec : cat_k ] for the definition of cat(@xmath0 ) .",
    "if @xmath1 is a metric graph , @xmath219 does not include a cycle whose length is less than @xmath220    consider a rescaling of @xmath1 such that the shortest ( longest ) edge length is 1 , and denote it as @xmath221 for @xmath222 ( @xmath223 ) .",
    "if @xmath224 , @xmath225    because the @xmath38-chain is increasing for @xmath226 , each cycle in @xmath227 is removed one by one as @xmath38 decreases .",
    "furthermore , each cycle length increases as @xmath38 decreases because , by the rescaling , every edge length is greater than 1 and it increases as @xmath38 decreases .",
    "this gives the decreasing property of @xmath228 for @xmath222 .",
    "we can prove the result for @xmath229 similarly .    by the theorem",
    ", @xmath227 becomes `` more cat(@xmath0 ) '' for a smaller @xmath226 . because rescaling of the graph does not affect the uniqueness of the intrinsic mean , @xmath208 tends to have a unique mean for a smaller @xmath226 .",
    "figures [ fig : gaussian_alpha ] ( a)-(f ) are geodesic graphs with different values of @xmath38 for 50 samples of the standard 2-d normal distribution .",
    "we give two cases in which we decrease @xmath38 : the delaunay graph in figure [ fig : gaussian_alpha ] and the complete graph in figure [ fig : gaussian_alpha_complete ] . by the time @xmath230 the cases are indistinguishable and have the same minimal spanning geodesic graph for large negative values of @xmath38 , as expected .",
    "this is predictable from theorem [ tree2 ] and [ thm : alpha - chain ] and gives an important practical strategy : when the dimension is high and @xmath38 is small , use the complete graph rather than the delaunay graph because the former requires computational cost only proportional to @xmath43 , whereas the computational cost of the latter is @xmath231 @xcite @xcite .     for 50 samples from the standard 2-d normal distribution .",
    "the initial graph ( @xmath131 ) is the delaunay graph .",
    "the value @xmath232 for each sample point @xmath45 is represented by the colours red ( small ) and blue ( large ) , and the minimum is represented by a square.,title=\"fig:\",width=170 ] + ( a ) @xmath233     for 50 samples from the standard 2-d normal distribution .",
    "the initial graph ( @xmath131 ) is the delaunay graph .",
    "the value @xmath232 for each sample point @xmath45 is represented by the colours red ( small ) and blue ( large ) , and the minimum is represented by a square.,title=\"fig:\",width=170 ] + ( b ) @xmath131     for 50 samples from the standard 2-d normal distribution .",
    "the initial graph ( @xmath131 ) is the delaunay graph .",
    "the value @xmath232 for each sample point @xmath45 is represented by the colours red ( small ) and blue ( large ) , and the minimum is represented by a square.,title=\"fig:\",width=170 ] + ( c ) @xmath234     +     for 50 samples from the standard 2-d normal distribution .",
    "the initial graph ( @xmath131 ) is the delaunay graph .",
    "the value @xmath232 for each sample point @xmath45 is represented by the colours red ( small ) and blue ( large ) , and the minimum is represented by a square.,title=\"fig:\",width=170 ] + ( d ) @xmath235     for 50 samples from the standard 2-d normal distribution .",
    "the initial graph ( @xmath131 ) is the delaunay graph .",
    "the value @xmath232 for each sample point @xmath45 is represented by the colours red ( small ) and blue ( large ) , and the minimum is represented by a square.,title=\"fig:\",width=170 ] + ( e ) @xmath236     for 50 samples from the standard 2-d normal distribution .",
    "the initial graph ( @xmath131 ) is the delaunay graph .",
    "the value @xmath232 for each sample point @xmath45 is represented by the colours red ( small ) and blue ( large ) , and the minimum is represented by a square.,title=\"fig:\",width=170 ] + ( f ) @xmath237     for 50 samples from the standard 2-d normal distribution .",
    "the initial graph ( @xmath131 ) is the complete graph .",
    "the value @xmath232 for each sample point @xmath45 is represented by the colours red ( small ) and blue ( large ) , and the minimum is represented by a square.,title=\"fig:\",width=170 ] + ( a ) @xmath233     for 50 samples from the standard 2-d normal distribution .",
    "the initial graph ( @xmath131 ) is the complete graph .",
    "the value @xmath232 for each sample point @xmath45 is represented by the colours red ( small ) and blue ( large ) , and the minimum is represented by a square.,title=\"fig:\",width=170 ] + ( b ) @xmath131     for 50 samples from the standard 2-d normal distribution .",
    "the initial graph ( @xmath131 ) is the complete graph .",
    "the value @xmath232 for each sample point @xmath45 is represented by the colours red ( small ) and blue ( large ) , and the minimum is represented by a square.,title=\"fig:\",width=170 ] + ( c ) @xmath234     +     for 50 samples from the standard 2-d normal distribution .",
    "the initial graph ( @xmath131 ) is the complete graph .",
    "the value @xmath232 for each sample point @xmath45 is represented by the colours red ( small ) and blue ( large ) , and the minimum is represented by a square.,title=\"fig:\",width=170 ] + ( d ) @xmath235     for 50 samples from the standard 2-d normal distribution .",
    "the initial graph ( @xmath131 ) is the complete graph .",
    "the value @xmath232 for each sample point @xmath45 is represented by the colours red ( small ) and blue ( large ) , and the minimum is represented by a square.,title=\"fig:\",width=170 ] + ( e ) @xmath236     for 50 samples from the standard 2-d normal distribution .",
    "the initial graph ( @xmath131 ) is the complete graph .",
    "the value @xmath232 for each sample point @xmath45 is represented by the colours red ( small ) and blue ( large ) , and the minimum is represented by a square.,title=\"fig:\",width=170 ] + ( f ) @xmath237",
    "the cat(0 ) property of euclidean space implies that we do not obtain multiple local minima of @xmath239 even for multi - modal distributions .",
    "however , an appropriate concave transformation of the metric can modify the base data space making it less cat(0 ) .",
    "we introduce the @xmath238 metric via a transformation @xmath240 as a candidate .    for any geodesic metric space @xmath241 with metric @xmath242 and a parameter @xmath243",
    ", we can define the metric @xmath244 where @xmath245     for a finite positive @xmath37.,width=264 ]    since @xmath240 is a concave function on @xmath246 ( see figure [ fig : graph_of_g_beta ] ) , @xmath238 becomes a metric but not necessarily a geodesic metric .",
    "we can express this conveniently as @xmath247 , where @xmath248 is the heaviside function , @xmath249 it is easiest to consider the case that @xmath242 is the euclidean distance on the real line . as @xmath250 for small values of @xmath43 ,",
    "the metric behaves like @xmath251 , and as @xmath252 , @xmath43 behaves like @xmath253 rescaled to @xmath254 $ ] . for euclidean distances greater than @xmath37 , @xmath36 returns a constant distance of unity .",
    "the metric has the effect of downsizing large distances to unity . because , as will soon be seen , @xmath238 can be recognized as a geodesic metric of a cone embedding @xmath1 , we refer to the mean @xmath255 as the _ @xmath37-extrinsic mean_.    we consider a scheme in which the real line , or part of it , is mapped into the unit circle , where it can be represented by an angle @xmath256 . in the unit disk , @xmath257 ,",
    "a point is represented by polar coordinates : @xmath258 .",
    "we consider the top half of the unit disk , for which @xmath259 , namely @xmath260 we will now give a rule for travelling from a point @xmath261 in @xmath257 to the point p:@xmath262 .    1 .",
    "if @xmath263 , travel in a straight line to p. this is the geodesic for the euclidean metric 2 .   if @xmath264 , travel first in straight line to the origin @xmath265 and then in a straight line from @xmath265 to p.    we now apply a similar rule to points @xmath266 and @xmath267 .    1",
    "if @xmath268 , we take the euclidean distance @xmath269 2 .   if @xmath270 , we take @xmath271 , indicating a route to the origin and out to the other point .",
    "now , consider two points at @xmath256 and @xmath272 on the circumference of the circle ; then , in case ( d1 ) above , the distance between them is @xmath273 when @xmath274 , we obtain the value 2 .    now , keeping @xmath275 fixed , let us rescale the distance inside the argument .",
    "in terms of the two points just described , we place the first point at p so that @xmath276 and scale the second with a factor @xmath277 .",
    "then , without changing the notation , and removing the factor of 2 , we have @xmath278 .",
    "then , @xmath279 implies that we may use the euclidean distance for a wider interval .",
    "case ( d2 ) above corresponds to the distance @xmath280 before rescaling and the new version @xmath281 achieves the value 1 .",
    "this corresponds precisely to the @xmath36 metric of this section .",
    "the extrinsic mean keeps the mean within the original data space but uses the @xmath238 metric .",
    "we will see below that the @xmath238 metric involves , even in the general case , an extension of the original space by a single dimension .",
    "this distinguishes it from the embeddings for extrinsic means used in the literature , which involve high - dimensional euclidean space , for example the case of the tree space .",
    "controlling @xmath37 , as will be seen below , controls the value of @xmath0 when the embedding space is considered as a cat(@xmath0 ) space .",
    "we have an indirect link between clustering and cat(@xmath0 ) spaces . as @xmath37 decreases while the embedding space becomes more cat(0 ) ( @xmath0 decreasing ) the original space becomes less cat(0 ) .",
    "this demonstrates , we believe , the importance of the cat(@xmath0 ) property in geodesic - based clustering .    in euclidean space ,",
    "the standard euclidean distance dose not exhibit multiple local means because the space is trivially cat(0 ) .",
    "however , by using the @xmath36-metric with a sufficiently small @xmath37 , the space can have multiple local means , as shown in figure [ fig:1dim_beta ] .     against @xmath98 for different values of @xmath37.,title=\"fig:\",width=207 ] + ( a ) density function     against @xmath98 for different values of @xmath37.,title=\"fig:\",width=207 ] + ( b ) @xmath282     +     against @xmath98 for different values of @xmath37.,title=\"fig:\",width=207 ] + ( c ) @xmath283     against @xmath98 for different values of @xmath37.,title=\"fig:\",width=207 ] + ( d )",
    "@xmath284    figure [ fig:1dim_beta_trajectory ] shows a plot of the local minima of @xmath285 against @xmath37 for the same samples as those in figure [ fig:1dim_beta ] .     against @xmath37.,width=264 ]",
    "the above construction is a special case of a general construction that applies to any geodesic metric space and hence to those in this paper .",
    "let @xmath286 be a geodesic metric space with a metric @xmath287 .",
    "a metric cone @xmath288 with @xmath289 is a cone @xmath290 \\slash \\mathcal{x } \\times \\{0\\}$ ] with a metric @xmath291 for any @xmath292 .",
    "the intuitive explanation is as follows .",
    "see figure [ fig : metric - cone - explanation ] .",
    "let @xmath293 be a subset @xmath294 with the geodesic metric on @xmath293 .",
    "thus , @xmath293 and @xmath286 are the same as a set but endowing different metrics .",
    "then @xmath293 is a rescaling of the metric on @xmath286 by @xmath37 . for any @xmath292 , their projections",
    "@xmath295 give two points @xmath296 , respectively .",
    "for a geodesic @xmath297 between @xmath45 and @xmath298 , consider a cone @xmath299\\}$ ] spanned by @xmath300 .",
    "this cone can be isometrically embedded into an `` extended unit circular sector '' , i.e. a covering @xmath301,\\theta \\in ( -\\infty , \\infty)\\}/ \\{(0,\\theta)\\mid \\theta \\in ( -\\infty , \\infty)\\}$ ] of the unit disk corresponding to @xmath302 $ ] .",
    "then @xmath303 and @xmath304 are also mapped into the extended unit circular sector ; the distance @xmath305 for @xmath283 corresponds to the case ( d2 ) of a disk if we set @xmath306 and @xmath307 .",
    "this corresponds to the length of the blue line path in figure [ fig : metric - cone - explanation ] ( b1 ) and ( b2 ) .",
    "for further details on metric cones , refer to @xcite .",
    ".,title=\"fig:\",height=102 ] .,title=\"fig:\",height=94 ]",
    "the following result indicates that the metric cone space preserves the cat(0 ) property of the original space and the smaller values of @xmath37 continue this process .",
    "see section [ sec : versus ] for more details .",
    "[ cone ]    1 .",
    "if @xmath286 is a cat(0 ) space , the metric cone @xmath288 is also cat(0 ) for every @xmath289 .",
    "if @xmath308 is cat(0 ) , @xmath309 is also cat(0 ) for @xmath310 .",
    "if @xmath286 is cat(@xmath0 ) for @xmath311 , @xmath288 becomes cat(0 ) for @xmath312 .    the proof is given in appendix [ proof - cone ] .",
    "a cat(@xmath0 ) space for @xmath313 is a geodesic metric space satisfying the following cat(@xmath0 ) condition .",
    "take any geodesic triangle @xmath314 whose perimeter is less than @xmath315 and select any point @xmath45 on a geodesic @xmath316 .",
    "let @xmath317 be a comparison triangle , which has the same edge length as @xmath314 , on a surface with a constant curvature @xmath0 , i.e. a sphere with radius @xmath318 for @xmath319 , a plane for @xmath320 and a hyperbolic space for @xmath321 . set @xmath46 on @xmath322 satisfying @xmath323 .",
    "then the cat(@xmath0 ) condition is that for all @xmath68 and all choices of @xmath45 , @xmath324 .",
    "thus every cat(@xmath0 ) space is a cat(@xmath325 ) space for @xmath326 .",
    "every metric graph is cat(@xmath0 ) for @xmath319 if and only if there is no loop shorter than @xmath327 because every metric tree is cat(0 ) and therefore cat(@xmath0 ) for @xmath319 .",
    "let @xmath286 be a geodesic metric space and fix it throughout this section .",
    "the diameter of a subset @xmath328 is defined as the length of the longest geodesic in @xmath329 .",
    "we define classes @xmath330 , @xmath331 and @xmath332 as follows .",
    "1 .   @xmath330 : the class of subsets @xmath328 such that the geodesic distance function @xmath333 is strictly convex on @xmath329 for each @xmath334 .",
    "here , `` convex '' means geodesic convex , i.e. a function @xmath239 on @xmath286 is convex iff for every geodesic @xmath335 on @xmath286 , @xmath336 is convex with respect to @xmath337 .",
    "2 .   @xmath331 for @xmath338 $ ] : the class of the subsets @xmath328 such that for any probability measure whose support is in @xmath329 and non - empty , the intrinsic @xmath339-mean exists uniquely .",
    "we refer to @xmath340 as @xmath341 .",
    "@xmath332 : the class of subsets @xmath328 such that for every pair @xmath342 , the geodesic between @xmath129 and @xmath343 is unique .",
    "[ lem : k1 - 1 ] @xmath344 for any @xmath338 $ ] .",
    "if @xmath345 , @xmath346 is a strictly convex function on @xmath329 for each @xmath347 ; hence , @xmath348 is strictly convex for any probability measure @xmath59 whose support is in @xmath329 and non - empty .",
    "thus , @xmath349 .",
    "next , assume that @xmath350 and @xmath351 ; then , there are at least two different geodesics , @xmath352 and @xmath353 , between @xmath45 and @xmath298 .",
    "thus , there are two points @xmath46 and @xmath354 in @xmath355 such that there is no intersection of @xmath352 and @xmath353 between @xmath46 and @xmath354 . then , the mid points of @xmath46 and @xmath354 on each geodesic become intrinsic @xmath339-means of the measure with two equal point masses on @xmath46 and @xmath354 .",
    "this implies that @xmath356 .",
    "let @xmath357 and @xmath358 be the largest values ( including @xmath359 ) such that every subset whose diameter is less than the value belongs to @xmath360 and @xmath332 , respectively .",
    "then , evidently from lemma [ lem : k1 - 1 ] , @xmath361 for @xmath362 .",
    "note that if @xmath286 is cat(0 ) , @xmath363 .",
    "in general , the following theorem holds .",
    "[ diam1 ] [ thm : diameter ]    * if @xmath286 is cat(@xmath0 ) , @xmath364 . *",
    "if @xmath286 is cat(@xmath0 ) , @xmath365 .",
    "* if @xmath286 is a surface with a constant curvature @xmath319 , @xmath366 .    the proof is given in appendix [ proof - diameter ] . by theorem [ thm : diameter](1 ) , @xmath367",
    "thus , a lower curvature @xmath0 gives a wider area where the intrinsic @xmath339-mean is unique . according to theorem [ thm : diameter](3 ) , this lower bound for @xmath368 is the best universal upper bound for any @xmath286 with cat(@xmath0 ) property .    for @xmath369",
    ", @xmath370 is bounded above by @xmath371 where @xmath372 is an increasing function of @xmath300 , as proved in appendix [ proof - gamma ] .",
    "this upper bound shows that the parameter @xmath300 plays a role in controlling the uniqueness of the mean , but it does not in euclidean space , where the @xmath339-mean functions are always convex .",
    "combining the three deformations by @xmath38 , @xmath37 and @xmath300 , a novel frchet mean is proposed : @xmath374 where @xmath375    we now review three main areas : ( i ) cat(0 ) and cat(k ) aspects , ( ii ) uniqueness of means and ( iii ) robustness against outlying data values . in this discussion",
    "we will concentrate on cases that arise from the euclidean graph , considered as a basic metric space from which we can construct a geodesic metric space using@xmath22 , or as the geodesic space for the metric cone extension using the @xmath36 approach .",
    "note that this is a restriction of a very general approach that would start with a density @xmath239 or a smooth empirical density @xmath103 ; first , construct the geodesic metric @xmath22 , and then , possibly apply the @xmath37-cone method to that geodesic metric space .",
    "however we shall prefer the graph approach because it leads to tractable mathematics and much faster computation ; moreover , we are able to capture some of the structure of the data using the complete euclidean graph , the delaunay graph and the gabriel graph .",
    "as mentioned above , we restrict ourselves to the case where the base space is the euclidean graph , i.e. @xmath376 .",
    "it holds that as @xmath377 , all geodesics end up on the minimal spanning tree that is cat(0 ) .",
    "as @xmath38 increases at some point , it ceases to be cat(0 ) but will be cat(k ) for some @xmath0 , which depends on @xmath38 and indeed increases with @xmath38 .    it should be stressed that the theorems on @xmath37 are completely general .",
    "that is they cover arbitrary metric cones based on a geodesic metric space .",
    "if we start with the euclidean graph as our geodesic space , it may not be cat(0 ) , but it can be shown that it is a cat(k ) space for some @xmath0 and will eventually be cat(0 ) for sufficiently small @xmath37 .",
    "while the space is cat(0 ) the intrinsic mean is unique and lies on the minimal spanning tree . for larger values of @xmath38",
    ", there may not be a unique intrinsic mean lying on the geodesic graph , but theorem [ thm : diameter ] suggests that the mean may be unique for values of the diameter that are sufficiently small relative to @xmath378 . for @xmath379 , at @xmath131 and @xmath380 , we obtain the euclidean intrinsic mean and the median , respectively , and these , again , may not be unique .    as noted above , the metric cone embedding the original data space becomes cat(0 ) for sufficiently small @xmath37 sufficiently small .",
    "the following is a possible strategy : starting with the euclidean graph , apply the cone method decreasing @xmath37 until the intrinsic mean is unique ( this may happen at a larger value of @xmath37 than that required to be cat(0 ) ) .",
    "then , project that unique mean back onto the original graph ; the projection is unique by construction provided that the intrinsic mean is not at the apex of the cone .",
    "instead of judging this method now we will wait for some empirical studies .    in the @xmath37 , instead of",
    "the projection of the intrinsic mean in the cone back to the original geodesic space , we prefer the extrinsic mean in which the mean lies in the geodesic space but , but we use the @xmath37 cone metric @xmath238 .",
    "as we decrease @xmath37 we tend to get more local minima .",
    "this is the antithesis of obtaining a cat(0 ) space .",
    "because the @xmath37 metric becomes more concave as @xmath37 decreases for very small @xmath37 , each data point will yield a single `` local mean '' .",
    "for reasonable values of @xmath37 , each data cluster will have a local mean because the function @xmath240 is locally linear and intra - cluster distances are small .",
    "however , when the intra - cluster distances are larger , the concavity dominates , and we obtain multiple local minima .",
    "both larger values of @xmath38 and smaller values of @xmath37 make the function @xmath383 less convex and can lead to multiplicity of the local means .",
    "figures [ fig : alpha - beta - difference ] shows the difference between the effects caused by positive @xmath38 and finite @xmath37 . compared with the original geodesic distance ( figure [ fig : alpha - beta - difference ] ( a ) ) , both ( b ) and ( c ) have multiple local minima of the function @xmath239 . in ( b ) , the three small groups of samples in the top right corner are dealt with one cluster and have a unique local minimum in their midst .",
    "in ( c ) , each of the three small bunches has a local minimum .",
    "however , ( c ) tends to have local minima on a ridge of each cluster . by tuning both @xmath38 and @xmath37 as in ( d ) , we can get local minima at the centre of each cluster .     for 24 samples each from normal distributions with the s.d .",
    "@xmath384 and 8 samples each from normal distributions with the s.d .",
    "initial graph : delaunay .",
    "the value for each @xmath98 is represented by the colour : red ( small ) , blue ( large ) , and minimum by a square.,title=\"fig:\",width=207 ] + ( a ) @xmath386     for 24 samples each from normal distributions with the s.d . @xmath384 and 8 samples each from normal distributions with the s.d .",
    "initial graph : delaunay .",
    "the value for each @xmath98 is represented by the colour : red ( small ) , blue ( large ) , and minimum by a square.,title=\"fig:\",width=207 ] + ( b ) @xmath387     +     for 24 samples each from normal distributions with the s.d . @xmath384 and 8 samples each from normal distributions with the s.d .",
    "initial graph : delaunay .",
    "the value for each @xmath98 is represented by the colour : red ( small ) , blue ( large ) , and minimum by a square.,title=\"fig:\",width=207 ] + ( c ) @xmath388     for 24 samples each from normal distributions with the s.d . @xmath384 and 8 samples each from normal distributions with the s.d .",
    "initial graph : delaunay .",
    "the value for each @xmath98 is represented by the colour : red ( small ) , blue ( large ) , and minimum by a square.,title=\"fig:\",width=207 ] + ( d ) @xmath389      at the beginning of section [ onedim ] , we showed how the univariate median can be considered as an intrinsic mean with respect to a geodesic metric , in both the population case and the empirical case . because the univariate median is well known to be robust against outliers , we can expect means based on empirical geodesics to also be robust . in particular , the flattening of large distances when @xmath37 is small gives an indication as to where to look for robust means .",
    "this flattening idea is not new .",
    "huber @xcite introduced a function similar to our @xmath21 function , which is quadratic in a spherical neighbourhood of zero and flat outside .",
    "if the generalised mean is computed as a frchet mean , we should take the square root of the huber loss function .",
    "various generalisations , including a smoothed version of huber loss function , have been proposed ; see , for example , @xcite .",
    "figure [ fig : robustness ] shows a geodesic graph and the value of @xmath390 for 19 samples from n(0,1 ) and one outlier at @xmath391 .",
    "figure [ fig : robustness ] ( a ) uses ordinary geodesic distance and the sample closest to the outlier sample attains the minimum of @xmath239 .",
    "all of @xmath233 for ( b ) , @xmath283 for ( c ) and @xmath392 for ( d ) attain the minimum of @xmath239 around the mean of the normal distribution and we can see their robustness .",
    "it is interesting that @xmath38 , @xmath37 and @xmath300 can control the trade - off between uniqueness of the mean and robustness of the estimation . in euclidean space",
    "this trade - off is typically studied via the convexities of the loss function , whereas we are making the perhaps novel suggestion that the curvature is an appropriate vehicle .     for 19 samples from n(0,1 ) and one outlier at @xmath391 ( far above the figure region ) .",
    "the value @xmath70 for each sample point @xmath45 is represented by the colours red ( small ) and blue ( large ) and the minimum is represented by a square.,title=\"fig:\",width=207 ] ( a ) @xmath393     for 19 samples from n(0,1 ) and one outlier at @xmath391 ( far above the figure region ) .",
    "the value @xmath70 for each sample point @xmath45 is represented by the colours red ( small ) and blue ( large ) and the minimum is represented by a square.,title=\"fig:\",width=207 ] ( b ) @xmath394     +     for 19 samples from n(0,1 ) and one outlier at @xmath391 ( far above the figure region ) .",
    "the value @xmath70 for each sample point @xmath45 is represented by the colours red ( small ) and blue ( large ) and the minimum is represented by a square.,title=\"fig:\",width=207 ] ( c ) @xmath395     for 19 samples from n(0,1 ) and one outlier at @xmath391 ( far above the figure region ) .",
    "the value @xmath70 for each sample point @xmath45 is represented by the colours red ( small ) and blue ( large ) and the minimum is represented by a square.,title=\"fig:\",width=207 ] ( d ) @xmath396",
    "in this section , we suggest how to select @xmath38 and @xmath37 empirically from the data .",
    "first , assume that we have euclidean data ( equivalnet to @xmath397 and recall the basic effect of decreasing @xmath38 from @xmath398 to @xmath157 . at @xmath399",
    ", we make no change to the metric .",
    "as @xmath38 decreases , we lose edges from the geodesic graph .",
    "that is to say from time to time , an edge that is in a particular geodesic is discarded and every geodesic that passes through that edge then has to use an alternative route .",
    "let us assume that at @xmath38 ( and under mild extra conditions ) , only a single edge @xmath400 is removed and let @xmath401 be its length .",
    "let @xmath402 be the lengths of the edges on the new geodesic that will replace the removed edge .",
    "in addition , let there be @xmath403 distinct geodesics that use @xmath400 .",
    "it is straightforward to see that _ all _ geodesics that use @xmath400 will use the new arc for an interval @xmath404 , for sufficiently small @xmath405 .",
    "the total change in geodesic length is @xmath406 and it is continuous at the current @xmath38 but the first derivative changes : @xmath407 is typically not zero . to see this ,",
    "take the case where all the @xmath408 are equal .",
    "then , the change in the first derivative is @xmath409    in graph theory , the number of geodesics using a particular edge , @xmath403 in our case , is sometimes called the _ edge betweenness_.",
    "we might therefore refer to the term @xmath410 as the weighted betweenness .",
    "this quantity measures changes in the configuration : if @xmath403 and @xmath411 are large then a long edge with large betweenness is removed , and it is replaced by @xmath0 shorter edges from the current geodesic graph .    if @xmath412 is the betweenness of an edge @xmath202 , the total betweenness of a graph @xmath133 is the sum of all the individual edge betweennesses , @xmath413 and the weighted version is @xmath414 which except for a scalar factor is the @xmath415 variance given by @xmath416 , in this paper .",
    "we shall in fact favour the use of @xmath417 ( @xmath418 , and with the above discussion in mind , we will see in examples 1 and 2 that plots of the second derivative of @xmath419 do indeed have pronounced peaks and there is some matching of the @xmath38-values at the peaks with the analogous differential of the aggregate betweenness .",
    "section 4.1 and figure 4 are important for understanding the @xmath37 metric .",
    "we can summarise the material in a way that will indicate how to estimate @xmath37 .",
    "the first point is that @xmath37 provides a metric cone . in one dimension",
    ", we wrap the real line around a circle and attach the origin .",
    "then , the the metric cone is based on the euclidean metric _ inside the cone_. the enlarged space ( referred to as the embedding space ) is cat(0 ) with respect to this metric .",
    "we claim that this construction is fundamental because even in larger spaces , the geodesics are one - dimensional .",
    "every geodesic , in some sense , has its private geodesic , but with a common vertex .",
    "moreover , by theorem [ cone ] , if the base space is cat(0 ) , the embedding space is cat(0 ) , and in both cases , we have a unique intrinsic mean and our statistics are well defined .",
    "howeve , r if we compute the intrinsic mean restricted to the base space , e.g. euclidean space , then the uniqueness no longer holds .",
    "as stated above , the space may not be cat(0 ) for small @xmath37 but may become more so for large @xmath37 .",
    "we can use this to our advantage : for sufficiently large @xmath37 , we expect a single maximum @xmath420 but multiple maxima for smaller @xmath37 , as shown in figure [ fig:1dim_beta ] .",
    "if we recall that the value of the function @xmath421 for a given @xmath37 is helpful in clustering , we can suggest a number of plots to show the local minima .",
    "however , we can say more .",
    "first , note that in one dimension , @xmath422 over @xmath423 $ ] is a smooth kernel with bandwidth @xmath37 .",
    "thus , with @xmath424 , we see that @xmath425 is a smooth density .",
    "this interpretation helps to intuitively choose @xmath37 : a `` typical value '' of @xmath426 , e.g. the average of @xmath427 , by analogy of selection of bandwidth for kernel functions .",
    "another option is to use cycle lengths in the geodesic graph . as can be seen from theorem [ cat1 ] and the proof of theorem [ cone ] ,",
    "if we set @xmath428 for a cycle @xmath300 and its length @xmath429 , then the metric cone generated by the cycle becomes cat(0 ) .",
    "the use of @xmath37 is shown in examples 1 and 3 .",
    "in this section , we apply the @xmath430 metric to real data . because the @xmath431 loss function is more familiar than deformation of metrics by @xmath38 and @xmath37 , we will set @xmath432 and focus on @xmath38 and @xmath37 throughout the section .    for the @xmath35 metric ( for @xmath433 , @xmath432 )",
    ", we briefly describe the computation . for each fixed @xmath38 and each pair of points",
    "initially every @xmath434 is computed , giving a complete graph . on this graph",
    "the @xmath122 to @xmath123 geodesic is computed for all @xmath435 . the geodesic graph , for this @xmath38 ,",
    "is then computed as the union of all such geodesics .",
    "the present version of the software computes the geodesic graph for a grid of around 100 points , depending on the range of @xmath38 . as mentioned",
    ", we are interested , here , only in the range @xmath436 $ ] and typically consider the range @xmath437 $ ] , where @xmath438 is a small positive integer . for each @xmath38 , we compute @xmath439 and @xmath440 .",
    "we apply the @xmath441 metric to the k - nearest neighbour ( k - nn ) method , one of the most popular classification methods .",
    "we will see that if we can choose adequate values for @xmath38 and @xmath37 , the classification error can be reduced .",
    "we use five data sets from he uci machine learning repository @xcite : ( i ) fisher s iris data set ( number of instances @xmath442 , number of attributes @xmath443 , number of clusters @xmath444 ) , ( ii ) wine data set ( @xmath445 , @xmath446 , @xmath444 ) , ( iii ) ionosphere data set ( @xmath447 , @xmath448 , @xmath449 ) , with only real attributes , ( iv ) breast cancer wisconsin ( diagnostic ) data set ( @xmath450 , @xmath451 , @xmath449 ) , and ( v ) yeast data set ( @xmath452 , @xmath453 , @xmath454 ) . the average @xmath455 norm of each data set is normalized to be one .",
    "the euclidean complete graphs are used as the initial metric graphs ( @xmath131 ) , and classification is performed using the weighted k - nn method ( k=10 ) with a common weighting @xmath456 where @xmath43 is the distance to the neighbour data point but using @xmath441 for various values of @xmath457 and @xmath458 .",
    "a half of the samples is selected at random as a training set and the rest half is used as a testing set to evaluate the classification result .",
    "we repeat it 1000 times and estimate the error rate .",
    ".classification by k - nn method [ cols= \" < , > , > , > , > \" , ]     figure [ fig : sushi_dendrograms ] shows the trees ( dendrograms ) for men and women : the first two are the intrinsic means and the next two are centres selected by the minima of @xmath459 , for the selected values of @xmath38 and @xmath37 .",
    "figure [ fig : sushi_f ] was constructed by first finding the two local minima of @xmath459 and then plotting the values of @xmath459 along a geodesic of maximal length passing through the two minima .",
    "it transpires that there are only six trees on this geodesic ( including the two special points ) but we are able to interpolate between the points by extending the range of the argument @xmath98 to include points in the edge , considered as a subset of the metric graph .",
    ".,title=\"fig:\",width=207 ] + ( a ) men    .,title=\"fig:\",width=207 ] + ( b ) women    .,title=\"fig:\",width=207 ] + ( c ) cluster 0    .,title=\"fig:\",width=207 ] + ( d ) cluster 1     along a geodesic passing its two local minima ( @xmath460 ) . the value at each sample point on the geodesic is marked as a circle .",
    "the two red circles correspond to the local minima.,height=226 ]",
    "the @xmath38 metric is a deformation of the starting geodesic , and as @xmath38 becomes more negative , the geodesic graph , namely the union of all the geodesics , becomes sparser , and in our graph representation , it becomes a tree .",
    "the space is cat(k ) with smaller @xmath0 and finally becomes a tree , at which point the space becomes cat(0 ) .",
    "it is quite difficult to see the tree computation because of the numerous short edges , but for moderate values of @xmath38 such as @xmath461 , the structure is tree - like .",
    "abrupt changes in various statistics as @xmath38 changes reveal topological changes in the structure of the geodesic graph , a fact that can be used to tune @xmath38 .",
    "the @xmath37 metric is  non - geodesic \" because although the function @xmath21 operates on a geodesic , that does not mean that the space is a geodesic space in the formal sense .",
    "however the cone construction yields a geodesic metric space , which is cat(@xmath0 ) with a lower value of @xmath0 than the original space , and indeed may be cat(0 ) .",
    "if the @xmath37 metric is projected back to the original space , that space can have a non - convex @xmath239-function with larger @xmath0 .",
    "this is useful for finding clusters because of multiple minima of the @xmath239-function , which is itself similar to a kernel .",
    "the means obtained by the @xmath37-metric may represent the first study of an extrinsic mean via embedding in non - euclidean spaces and the first application of metric cones to statistics and data analysis .",
    "we believe that the curvature of the data space underlying this work demands further investigation whereby connections should be established with recent developments related to empirical geodesic graphs , for example in manifold learning",
    ". one important direction should be the effect of the curvature of the space on the trade - off between the uniqueness of the frecht means and the robustness of estimation .",
    "to this end , @xmath78 and @xmath300 can be seen as parameters that can be tuned to change the curvature and hence study the trade - off .",
    "the delaunay complex is usually defined via the voronoi diagram .",
    "let @xmath462 be distinct points in @xmath73 .",
    "define for @xmath463 the @xmath464 hyperplane @xmath465 perpendicular to and bisecting the line from @xmath122 to @xmath123 .",
    "again for @xmath466 let @xmath467 be the half space bounded by @xmath465 and containing @xmath122 .",
    "then , the voronoi cell of @xmath122 is @xmath468 the elementary definition is that @xmath469 is all those no further from @xmath122 than any other @xmath123 .",
    "the delaunay complex is a simplicial complex with vertices at @xmath122 and one - dimensional edges between @xmath122 and @xmath123 if and only if @xmath467 is a face of @xmath469 ( and @xmath470 ) .",
    "the vertices @xmath122 and the edge set then define the delaunay graph : the graph of the complex .",
    "note that in the text we shall assume a general position when no more than @xmath471 voronoi cells can have a common point , and this guarantees that the delaunay complex has maximum simplexes of dimension @xmath43 and @xmath471 vertices    a well - known property of the voronoi construction , in the general position case , is that the circumscribed sphere of a delaunay simplex contains only the @xmath471 vertices of the simplex , and in fact this is a defining property of the maximal simplexes .",
    "the gabriel graph is defined in an intuitively similar way : the edge from @xmath122 to @xmath123 is included if and only if the unique sphere whose diameter is that edge contains no third point @xmath472 .",
    "it is straightforward to show that the gabriel graph is a subgraph of the delaunay graph .",
    "see @xcite @xcite @xcite for theory , algorithms and applications of delaunay and gabriel graphs .",
    "the delaunay complex has come to prominence in the areas of discrete tube theory and persistent homology @xcite .",
    "\\(1 ) denote the mapped points of @xmath68 and @xmath45 by the projection @xmath473 as @xmath474 and @xmath1 , respectively , as shown in figure [ fig : metric_cones ] ( left ) .",
    "denote the origin of the metric cone as @xmath475 . if the sum of the lengths of the geodesics @xmath476 , @xmath477 and @xmath478 in @xmath293 exceeds @xmath479 , it is easy to see that the cone spanned by @xmath480 becomes cat(0 ) and @xmath314 satisfies the cat(0 ) property . therefore , assume that @xmath481 .",
    "next , let @xmath317 be a comparison triangle of @xmath314 and let @xmath46 be a point on a geodesic @xmath485 such that @xmath486 .",
    "thus , @xmath487 .",
    "arrange the points @xmath488 , @xmath489 and @xmath490 in a three - dimensional euclidean space with origin @xmath491 such that the lengths of @xmath492 , @xmath493 and @xmath494 are equal to the lengths of @xmath495 , @xmath496 and @xmath497 , respectively .",
    "denote the radial projection of @xmath488 , @xmath489 , @xmath490 and @xmath46 to a unit sphere as @xmath498 , @xmath499 , @xmath500 and @xmath501 , respectively , as shown in figure [ fig : metric_cones ] ( right ) . by the definition of a metric cone , @xmath502 and the geodesics @xmath503 , @xmath504 , @xmath505 and @xmath506 in the unit sphere are arcs satisfying @xmath507 , @xmath508 , @xmath509 and @xmath510 .",
    "the unit sphere has a positive constant curvature and @xmath293 is cat(0 ) , @xmath512 .",
    "however , since @xmath513 and @xmath502 , @xmath512 implies that @xmath514 by the property of a metric cone .",
    "thus , @xmath314 has cat(0 ) property and ( 1 ) of the theorem is proved .",
    "\\(2 ) assume that @xmath515 and a metric cone @xmath309 is not cat(0 ) for proving the latter half of the theorem by contradiction .",
    "then , there is a geodesic triangle @xmath516 in @xmath309 and a point @xmath136 on the geodesic @xmath517 such that the geodesic @xmath518 is longer than the corresponding geodesic of a comparison triangle . by defining @xmath519 and @xmath520 as above",
    ", we can say that @xmath521 .",
    "next , each of @xmath522 and @xmath523 corresponds to a point in @xmath524 and we can consider the corresponding points @xmath525 and @xmath526 in the other metric cone @xmath308 .",
    "when restricted to @xmath524 , a geodesic @xmath527 is just a rescaling of @xmath528 and @xmath529 .",
    "now , @xmath530 is a geodesic triangle on the unit sphere , but after rescaling by @xmath531 , we can get a geodesic triangle @xmath532 on a sphere of radius @xmath531 whose edges have the same length as @xmath533 . by a known result on spherical triangles with the same edge lengths on different spheres ,",
    "a larger radius implies a `` thinner '' triangle and @xmath534 where @xmath535 is a point on the geodesic @xmath536 such that @xmath537 .",
    "combining all the arguments gives @xmath538 select a non - degenerate geodesic triangle in @xmath308 by selecting arbitrary points @xmath539 and @xmath540 on the geodesics @xmath541 , @xmath542 and @xmath543 in @xmath308 , respectively , and let @xmath544 be the intersection point of @xmath545 and @xmath546 . then , by @xmath547 , we can say that @xmath548 .",
    "this implies that @xmath308 is not cat(0 ) and ( 2 ) of the theorem is proved .",
    "\\(3 ) for @xmath320 , the statement holds by ( 1 ) . for @xmath319 and @xmath549 ,",
    "it is sufficient to prove for @xmath550 by ( 2 ) .",
    "let @xmath314 be a geodesic triangle in @xmath288 and let @xmath551 be a geodesic triangle in @xmath293 .",
    "let @xmath474 be the projection of @xmath68 , respectively .",
    "if the perimeter of @xmath551 is longer than or equal to @xmath552 , the cone spanned by the perimeter becomes cat(0 ) by the same argument as that for ( 1 ) .",
    "therefore , @xmath314 is cat(0 ) and satisfies the cat(0 ) property .    if the perimeter of @xmath551 is smaller than @xmath552 , since @xmath286 is cat(@xmath0 ) and @xmath293 is cat(1 ) , for any @xmath553 , @xmath554 is shorter than the corresponding great arc @xmath555 of a comparison triangle @xmath556 , which is a spherical triangle on the unit sphere . since a comparison triangle @xmath317 of @xmath314",
    "can be embedded on the cone spanned by @xmath556 , @xmath557 is shorter than the corresponding line segment @xmath558 .",
    "this means the @xmath314 satisfies the cat(0 ) property .",
    "the proof is by contradiction .",
    "we need to show that if we take an edge of the complete graph that is _ not _ a edge of the delaunay graph then it can be replaced by a shorter edge that is in the delaunay graph .",
    "let @xmath126 be our test edge from vertex @xmath210 to vertex @xmath175 .",
    "the edge can not be a boundary edge of the convex hull of the vertices , because it is well known that every such edge is in the delaunay graph .",
    "thus , one of vertices @xmath210 or @xmath175 must be an interior point , say @xmath210 . consider the edge @xmath126 as it leaves @xmath210 . since @xmath210 is completely surrounded by delaunay cells that have @xmath210 as a vertex it must pass through one such cell that we call @xmath257 .",
    "replace one vertex other than @xmath210 , say @xmath559 of @xmath257 , by the vertex @xmath175 .",
    "now , we still have @xmath560 vertices for @xmath561 and we can construct their ( unique ) circumscribing sphere @xmath562 .",
    "now , delaunay cells are uniquely determined as those sets of @xmath560 vertices whose circumscribing sphere does not contain any other points . from this",
    "we see that @xmath559 can not be out side @xmath562 , because otherwise its circumscribing sphere would contain @xmath175 .",
    "our claim is that any @xmath563-dimensional hyperplane @xmath248 that contains the edge @xmath126 has at least one edge of @xmath564 , say @xmath565 , that must be on the  small side \" of @xmath248 in relation to @xmath562 ; that is the side not containing the centre of @xmath562 . any such edge , and therefore , @xmath565 must be shorter than @xmath126 . then",
    ", if @xmath126 were in the minimal spanning tree , we could replace it by @xmath565 , giving a contradiction .",
    "the proof for the gabriel graph is more straightforward .",
    "we need to show that the minimal spanning tree has the gabriel property .",
    "take any edge @xmath126 of the tree if the diametric sphere contains the third vertex @xmath0 then we can replace @xmath126 by @xmath566 or @xmath567 , both of which have a shorter `` length '' than @xmath126 .",
    "this gives a contradiction .",
    "\\(1 ) although this is a known result , for example @xcite @xcite , we show a short proof .",
    "since a comparison triangle for the cat(@xmath0 ) property is on a sphere of radius @xmath318 , first consider the unit sphere @xmath568 and the geodesic distance @xmath43 on it .",
    "take three points @xmath569 and think of the convexity of @xmath570 for @xmath571 . without losing generality ,",
    "assume that @xmath572 is on the plane @xmath573 and @xmath316 is on the plane @xmath574 and let @xmath575 , @xmath576 and @xmath577 for @xmath578$],@xmath579 $ ] .",
    "thus , @xmath580 and @xmath581 .",
    "note that for @xmath582 , @xmath583 for @xmath582 is a convex of @xmath584 . for a @xmath585 , @xmath586 for @xmath571",
    ", @xmath587 is a convex of @xmath584 iff @xmath588 since @xmath589 .",
    "this means that if @xmath586 for @xmath571 , @xmath587 is a convex of @xmath584 .",
    "if @xmath286 is cat(@xmath0 ) and has a diameter of at most @xmath590 , there is a comparison triangle @xmath317 on a sphere of radius @xmath318 such that its perimeter is at most @xmath591 and @xmath592 is a convex of @xmath593 for each @xmath594 because of the argument above after scaling by @xmath318 .",
    "\\(3 ) we show an example of the probability measure with a three - point support on @xmath568 such that the diameter is larger than @xmath595 but can be arbitrarily close to @xmath595 and the uniqueness of the intrinsic @xmath415-mean fails .",
    "take @xmath598 , @xmath599 , @xmath600 and @xmath601 with @xmath602 , as in figure [ fig : cat_hemisphere1 ] .",
    "let @xmath603 be the mid point of @xmath604 for @xmath605 .",
    "put the point masses @xmath606 at @xmath149 and @xmath607 at @xmath608 and @xmath596 , and assume that there is a unique intrinsic median @xmath59 .    by the symmetry , @xmath59 must be on the arc @xmath609 , and if we change the ratio @xmath610 , @xmath59 moves continuously on @xmath609 .",
    "thus , we can set @xmath611 by tuning @xmath610 adequately .",
    "however , @xmath415-dispersion from @xmath1 becomes @xmath612 , and @xmath415-dispersion from @xmath608 becomes @xmath613 .",
    "this contradicts the assumption of @xmath1 being the unique @xmath415-intrinsic mean . since we can set @xmath256 and @xmath614 as arbitrarily small positive numbers , @xmath615",
    "however , by ( 1 ) , @xmath616 ; thus , @xmath617 .",
    "if @xmath286 is a surface with a constant curvature @xmath319 , @xmath618 where @xmath619 is the inverse function of @xmath620^{-1 }   & \\mbox{~for~ } 0 \\leq \\theta \\leq \\pi/6,\\\\      \\left[\\log_2\\frac{\\pi-2\\theta}{\\arccos(\\sin^2\\theta)}\\right]^{-1 }   & \\mbox{~for~ } \\pi/6 < \\theta \\leq \\pi/2    \\end{array } \\right.\\ ] ] for @xmath621 and @xmath622 for @xmath623 .",
    "c1 :  @xmath598 , @xmath625 , +  @xmath626 where @xmath627 , as shown in figure [ fig : cat_hemisphere1 ] .",
    "this satisfies @xmath628 .",
    "+ c2 : @xmath598 , @xmath629 , and @xmath630 , as shown in figure [ fig : cat_hemisphere2 ] .",
    "+ we put point masses @xmath98 at @xmath149 and @xmath607 at @xmath608 and @xmath596 .      for @xmath631 ,",
    "we consider c1 . as in the proof of theorem [ thm : diameter](3 ) , we can set @xmath632 .",
    "let @xmath633 and @xmath634 denote @xmath339-dispersion from @xmath1 and @xmath608 , respectively .",
    "then , @xmath635 therefore , @xmath636 is equivalent to @xmath637                      bose , p. devroye , l. , lffler , m. , snoeyink , j. and verma , v. , almost all delaunay triangulations have stretch factor greater than @xmath644/2 , _ computational geometry _ , vol.44 , no.2 , pp .  121127 , 2011 .",
    "matula , d.  w. and robert r.  s. , properties of gabriel graphs relevant to geographic variation research and the clustering of points in the plane , _ geographical analysis _ ,",
    "vol.12 , no.3 pp .  205222 , 1980 ."
  ],
  "abstract_text": [
    "<S> a methodology is developed for data analysis based on empirically constructed geodesic metric spaces . for a probability distribution </S>",
    "<S> , the length along a path between two points can be defined as the amount of probability mass accumulated along the path . </S>",
    "<S> the geodesic , then , is the shortest such path and defines a geodesic metric . </S>",
    "<S> such metrics are transformed in a number of ways to produce parametrised families of geodesic metric spaces , empirical versions of which allow computation of intrinsic means and associated measures of dispersion . </S>",
    "<S> these reveal properties of the data , based on geometry , such as those that are difficult to see from the raw euclidean distances . </S>",
    "<S> examples include clustering and classification . for certain parameter ranges , </S>",
    "<S> the spaces become cat(0 ) spaces and the intrinsic means are unique . in one case , </S>",
    "<S> a minimal spanning tree of a graph based on the data becomes cat(0 ) . in another , a so - called  metric cone \" construction allows extension to cat(k ) spaces . </S>",
    "<S> it is shown how to empirically tune the parameters of the metrics , making it possible to apply them to a number of real cases . </S>"
  ]
}