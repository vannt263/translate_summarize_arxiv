{
  "article_text": [
    "formally , loop calculus suggests an explicit decomposition of the partition function @xmath9 in terms of a sum over certain loops on the graph @xmath19 .",
    "below we re - derive the loop calculus in more general terms compared to @xcite .",
    "we start with an observation that the partition function , @xmath9 , is invariant with respect to a group of linear gauge transformations of the factor functions @xmath20 described by @xmath21 provided the pairs of conjugated matrices @xmath22 and @xmath23 are related to each other by the special constraint @xmath24 where @xmath25 is @xmath26 if @xmath27 and @xmath28 , otherwise . except as prescribed by eq .",
    "( [ gg ] ) , the gauges are chosen independently at different edges of the graphs . this local freedom in selecting @xmath29",
    "is the key to our further analysis of the partition function , @xmath9 now expressed as @xmath30 where @xmath31 .",
    "we will refer to summation over all allowed configurations of @xmath32 in eq .",
    "( [ zg ] ) as computing a graphic trace : a conventional trace can be considered as a special case of the graphic trace for a graph that consists of a single vertex and a single edge .",
    "our next step in evaluation of eq .",
    "( [ zg ] ) is fixing the gauges , which means imposing constraints on @xmath29 in addition to eq .",
    "( [ gg ] ) .",
    "it is convenient to distinguish a special term in the sum / trace over @xmath32 in eq .",
    "( [ zg ] ) with all @xmath33",
    ". we will refer to this term as the ground or , alternatively , uncolored state ( term ) , while all the other terms in the sum , which contain at least one edge with @xmath34 , are called excited ( colored ) states . obviously for a general gauge choice @xmath29",
    "all kinds of excited states , e.g. with only one edge being excited / colored , provide nonzero contributions to @xmath35 . discussing individual terms in the @xmath36-sum in eq .",
    "( [ zg ] ) we call a vertex colored if at least one edge attached to it is excited / colored .",
    "a bp - gauge corresponds to such a special choice of @xmath29 that makes vanish any contribution in the @xmath36-sum in eq .",
    "( [ zg ] ) that has at least one vertex with only one attached colored edge",
    ". stated differently a bp - gauge prohibits loose excited / colored edges at any vertex .",
    "formally it is expressed as the following set of conditions @xmath37 enforced independently at any vertex of the graph .",
    "combined with the constraints ( [ gg ] ) , eq .  ( [ gcond ] )",
    "can be re - stated in the vector form depending only on the ground state part of the gauges : @xmath38 with @xmath39 we can alternatively derive eq .  ( [ g0 ] ) for bp gauges using a variational approach . to that end",
    "we introduce a functional @xmath40 where @xmath41 , @xmath42 , @xmath43 , and @xmath44 is given by eq .",
    "( [ define - lambda ] ) with @xmath45 replaced by @xmath46 .",
    "the conditions for the stationary points of @xmath47 with respect to @xmath48 , under the additional condition , @xmath49 , recovers eqs .",
    "( [ g0 ] ) .",
    "note that the functional @xmath50 as well as the bp equations ( [ g0],[define - lambda ] ) possess some remaining irrelevant gauge freedom with respect to a set of transformations @xmath51 with @xmath52 .",
    "stated differently , the bp equations fix only the relevant part of the gauge freedom . a connection between the functional @xmath53 and the variational bethe free energy will be established in section [ sec : free ] .",
    "[ t ]   with fourteen possible generalized loops , @xmath54 , shown in bold on the bottom.,title=\"fig:\",scaledwidth=40.0% ]    the conventional form of the bp equations , in terms of the  messages \" @xmath55 , @xmath56 is recovered using the following parametrization @xmath57    our discussion has been applied so far to the case of a general @xmath0-ary alphabet .",
    "we now turn to the simplest binary case @xmath58 , where the ground state parametrization ( [ geta0 ] ) unambiguously fixes the excited states : @xmath59 . substituting the latter expression and eqs .",
    "( [ gcond],[g0 ] ) into eq .",
    "( [ zg ] ) we arrive at the main formula of the loop calculus for the binary alphabet @xmath60 where @xmath61 is the set of generalized loops on the graph , defined as subgraphs of @xmath19 without loose ends , i.e. with degree of connectivity at any vertex ( within the subgraph ) being two or larger .",
    "beliefs are defined here as substitutes for the exact marginal probabilities ( [ b - p - ab ] ) truncated at the first , ground state , term @xmath62 then a single generalized loop contribution , @xmath63 , is expressed in terms of the ground state beliefs in the following simple way @xmath64 the loop calculus construction for a simple example is illustrated schematically in fig .",
    "[ fig:14 ] .",
    "turning to the general @xmath0-ary alphabet case we first notice that all considerations and formulas of the introduction and the first part of section [ sec : bin ] , all the way up to eq .",
    "( [ g0 ] ) , actually apply to the general @xmath0-ary case . partitioning the sum / trace over @xmath32 in eq .",
    "( [ zg ] ) into the ground - state term , with @xmath65 , and the remaining excited - state terms @xmath66 , and emergence of the self - consistent set of equations for the ground state gauges ( [ geta0 ] ) are important general features of the gauge fixing construction .",
    "of course , all the preceding formulas should be understood in terms of the edge variables that assume values from @xmath67 .",
    "generalization of eq .",
    "( [ binary ] ) to a general @xmath0-ary alphabet reads @xmath68 the additional summation over the colored / excited @xmath69 in eq .",
    "( [ lc1 ] ) is a consequence of the fact that for @xmath70 , @xmath69 , is not fixed unambiguously , but rather represents summation over the reduced @xmath1-colors rich set , @xmath71 .",
    "the bp - gauges for the original graphical model are described by eqs .",
    "( [ gg],[gcond ] ) .",
    "the set of excited states gets larger in the @xmath0-ary case and , consequently , there is a big freedom in selecting the orthogonal basis set of excited gauges .",
    "selecting one such solution of eqs .",
    "( [ gg],[gcond ] ) , @xmath72 , and substituting it in eq .",
    "( [ lc1 ] ) we find that @xmath73 becomes the partition function of a reduced graphical model , defined on a subset @xmath74 of @xmath19 , @xmath75 here @xmath76 is the vector constructed of @xmath77 with @xmath78 , with the components labeled by @xmath79 .",
    "@xmath73 may be understood as a partition function of a reduced graphical model , defined on the graph @xmath80 in terms of a reduced ( one element shorter ) alphabet and with the factor functions @xmath81 .",
    "[ t ] , shown in the figure in black , red and blue respectively .",
    "first layer of the tower is bounded by the red dashed box , with the original graph , @xmath82 , shown in black and three generalized loops , @xmath83 , shown in red . on the second layer of the tower each graph from @xmath84 generates its own set of generalized loops .",
    "the next layer of generalized loops , shown in blue , are bounded by three dashed blue boxes with red graph in a box showing respective element of @xmath85 .",
    ", title=\"fig:\",scaledwidth=50.0% ]    this reformulation of the partition function of the original problem in terms of a sum of partition functions over reduced graphical problems can be repeated sequentially : @xmath86 where @xmath87 is the tower of loops and @xmath88 is the partition function of the graphical model defined in terms of a @xmath89-ary variables on the graph @xmath90 , which is a generalized loop of @xmath91 .",
    "all together one arrives at eq .",
    "( [ lc1 ] ) supplemented by the sequence @xmath92 generalization of eq .",
    "( [ zc1 ] ) becomes @xmath93 where @xmath94 is a vector constructed out of the variables defined on all edges of the graph @xmath90 with the components labeled by @xmath95 .",
    "the bp gauges in eqs .",
    "( [ zcj ] ) , @xmath96 , are solutions of eqs .",
    "( [ gg],[gcond ] ) with the original factor functions , @xmath97 replaced by @xmath98 .",
    "it is known that the exact ( equilibrium ) free energy of any classical statistical model can be obtained from a variational principle based on an exact non - equilibrium variational functional of the full belief , @xmath99 , @xmath100 the only stationary point of the functional under the normalization condition @xmath101 reproduces the probability distribution @xmath102 , where @xmath103 is defined by eq .",
    "( [ psigma ] ) .",
    "this stationary point is actually a minimum .",
    "the value of the exact variational functional at its minimum is equal to the exact free energy @xmath104 where @xmath105 , the latter defined above by eq .",
    "( [ psigma ] ) .",
    "hereafter we skip the graph , @xmath106 , index to simplify notations .    introducing an approximate variational ansatz @xmath107 where @xmath108 and @xmath109 are approximations for the corresponding ( exact ) marginal probabilities , we substitute it ( in the spirit of @xcite ) into eq .",
    "( [ f_ex ] ) .",
    "we further invoke another approximation ( both approximations are actually exact in the case of a tree , i.e. a graph with no loops ) @xmath110 this results in the so - called bethe ( approximate ) free energy functional of beliefs @xmath111 : @xmath112 we require the beliefs to obey the positivity , normalizability and compatibility constraints , the features borrowed from the corresponding exact probabilities given by eqs .",
    "( [ b - p - ab ] ) .",
    "thus , we have @xmath113 ( and inversely @xmath114 ) : @xmath115    to establish a connection between the bethe free energy and the functional @xmath116 we introduce the effective lagrangian @xmath117 that depends on all beliefs that satisfy the normalization constrains ( [ norm ] ) with no constraints on @xmath118 .",
    "requiring vanishing of the variation with respect to @xmath119 obviously leads to the constraints given by eq .",
    "( [ cons ] ) , and once all constraints are fulfilled the functional does not depend on @xmath119 ( which should be considered as gauge symmetry ) and coincides with @xmath120 as a function of the beliefs .",
    "this implies a one - to - one correspondence between the extrema of @xmath121 and bethe free energy @xmath120 .",
    "finding extrema of @xmath121 with respect to the beliefs ( this can be technically achieved by introducing lagrange multipliers for the set of constrains ( [ norm ] ) ) leads to beliefs that depend explicitly on @xmath122 : @xmath123 where @xmath124 . substituting the values of beliefs given by eqs .",
    "( [ ba*],[bab * ] ) into eq .",
    "( [ lagr ] ) results in a functional that depends on the @xmath125 variables only @xmath126 the functional @xmath127 possesses strong gauge symmetry : it is invariant under a set of transformations @xmath128 .",
    "the gauge can be partially fixed by implementing a gauge ( normalization ) condition @xmath129 implementing this constraint , the second term in eq .",
    "( [ f - b ] ) vanishes .",
    "this means that switching from the notations of section [ sec : bin ] to our current notations , @xmath130 and @xmath131 , we arrive at @xmath132 .",
    "stated more formally , @xmath116 introduced earlier represents the gauge - invariant functional @xmath133 in a particular gauge determined by eq .",
    "( [ gauge - f - b ] ) .",
    "this implies a one - to - one correspondence of the extrema of @xmath116 to the extrema of @xmath121 , and therefore to the extrema of the bethe free energy @xmath120 .",
    "we first summarize the results presented in the manuscript .",
    "we have introduced a group of gauge transformations that keep the partition function of the graphical model invariant , and naturally split the gauges into the  ground \" and  excited \" parts .",
    "the partition function is decomposed into the principal ground and many excited terms .",
    "each excited contribution is interpreted in terms of an excited subgraph constructed from excited edges . requiring that only excited subgraphs with no loose ends",
    "contribute to the partition function sets the bp equations for the ground gauges .",
    "we show that the bp equations can be derived using a variational principle for the partition function as a function of the ground gauges .",
    "further consideration differs for the binary and @xmath0-ary alphabets . in the binary case",
    "the excited gauges are fixed unambigiously , generating the binary loop series over generalized loops for the partition function @xcite . in the @xmath0-ary case",
    "we pick one ( of many possible ) excited gauges and presenting the full partition function as a sum over generalized loops .",
    "each contribution labeled by a generalized loop can be viewed as a new graphical model defined on this loop with a new set of factor functions .",
    "the loop decomposition procedure is applied again , introducing new ground and excited gauges , fixing the gauges , etc .",
    "the procedure repeated for @xmath1 layers builds a @xmath0-store loop tower .",
    "finally , we showed that the bp - gauges can be determined using a variational principle and related the corresponding functional @xmath116 to the bethe free energy functional constructed in the spirit of @xcite .",
    "these results open new venues for further development , and also raise a set of important and challenging questions listed below .",
    "( 1 ) already the lowest level bp equations in the loop tower , the ground bp - gauge may have multiple solutions .",
    "our construction applied to different solutions will generate different loop decompositions for the partition function .",
    "the question is , whether a preferred solution is in a way better then the others ?",
    "naive intuition suggests that bp gauge with the highest value of @xmath9 would serve better .",
    "( 2 ) furthermore , in the case of a @xmath0-ary alphabet with @xmath70 positivity of the factor functions at higher tower levels is not guaranteed .",
    "the positivity would be desirable for interpreting the auxiliary graphical problems as some actual statistical inference problems , with the factor functions related to probabilities .",
    "on the other hand , there is a big freedom in selecting the excited gauges , and a question surfaces : could one select the excited gauges in a way to guarantee positivity of the higher - level factor functions ?",
    "( 3 ) the bp ground state contribution to the partition function , @xmath134 is positive by construction , however the signs of the excited terms can alternate .",
    "this raises a couple of important questions .",
    "how do the signs of the loop terms depend on the factor functions and the graphical model itself ?",
    "based on our previous experiments @xcite , we know that emergence of an excited loop contribution comparable to the ground state alerts for a possible failure of bp as an approximation to exact inference . how exactly does the sign alternation and relative value of the tower loop contributions affect success or failure of bp as an approximation ? ( 4 ) the equilibrium bethe free energy estimates the value of the partition function , however the variational derivation sketched in section [ sec : free ] does not guarantee that the resulting @xmath135 is actually larger then the exact @xmath136 . indeed in the transition from eqs .",
    "( [ f_ex],[b - ans],[approx-2 ] ) to eqs .",
    "( [ bethe ] ) we further discuss the latter formulation completely ignoring the fact that the conditions ( [ approx-2 ] ) can be violated for the resulting bp solutions .",
    "how does this violation affect the relation , @xmath137 , and what are the consequences of this inequality for the loop series ?",
    "we conclude with mentioning some future research directions .",
    "as demonstrated in @xcite , the loop calculus is suggestive of an efficient truncation of the full series that can potentially improve the bp approximation .",
    "this idea can also be extended to the @xmath0-ary alphabet case , with the tower truncated at some relatively low level .",
    "this approach can obviously find interesting application in decoding of non - binary codes and also in problems , such as computer vision , that require a multi - valued data reconstruction .",
    "the loop tower approach can also be extended to the analogous case of continuous alphabet . in this case",
    "the ground state gauges satisfy a set of integral equations , while the ground and excited states that define the gauges become elements of functional infinite - dimensional hilbert spaces , which makes the tower heights unlimited and the tower loop decomposition turns into an infinite series . finally , we note that the gauge conditions may be chosen in some other non - bp way .",
    "bp - gauge is of a special importance for dilute locally tree - like graphs simply because in the loop - free case the whole loop hierarchy ( the entire loop tower ) disappears .",
    "one could conjecture that for some other classes of graphical models , e.g. those naturally defined on regular lattices , similar cancelations can take place for some alternative specially selected gauges .",
    "the work at los alamos was carried out under the auspices of the national nuclear security administration of the u.s .",
    "department of energy at los alamos national laboratory under contract no .",
    "de - ac52 - 06na25396 .",
    "vyc also acknowledges the support through the start - up grant from wayne state university .",
    "m. chertkov , v. chernyak , loop calculus in statistical physics and information science , phys .",
    "e * 73 * , 065102(r ) ( 2006 ) ; cond - mat/0601487 .",
    "m. chertkov , v. chernyak , _ loop series for discrete statistical models on graphs _ , j. stat .",
    "( 2006 ) p06009 , cond - mat/0603189 .",
    "yedidia , w.t .",
    "freeman , y. weiss , _ constructing free energy approximations and generalized belief propagation algorithms _ , ieee it*51 * , 2282 ( 2005 ) .",
    "m. chertkov , v. chernyak , _ loop calculus helps to improve belief propagation and linear programming decodings of low - density - parity - check codes _ , invited talk at 44th allerton conference ( september 27 - 29 , 2006 , allerton , il ) , arxiv : cs.it/0609154 ."
  ],
  "abstract_text": [
    "<S> loop calculus introduced in @xcite constitutes a new theoretical tool that explicitly expresses the symbol maximum - a - posteriori ( map ) solution of a general statistical inference problem via a solution of the belief propagation ( bp ) equations . </S>",
    "<S> this finding brought a new significance to the bp concept , which in the past was thought of as just a loop - free approximation . in this paper </S>",
    "<S> we continue a discussion of the loop calculus . </S>",
    "<S> we introduce an invariant formulation which allows to generalize the loop calculus approach to a q - are alphabet .    </S>",
    "<S> the manuscript is organized as follows . in section [ sec : bin ] </S>",
    "<S> we introduce a new formulation of the loop calculus in terms of a set of gauge transformations that keep the partition function of the problem invariant . </S>",
    "<S> the full expression contains two terms referred to as the  ground state \" and  excited states \" contributions . </S>",
    "<S> the bp equations are interpreted as a special ( bp ) gauge fixing condition that emerges as a special orthogonality constraint between the ground and the excited states </S>",
    "<S> . stated differently , it selects the generalized loop contributions as the only ones that survive among the excited states . in section [ sec : q ] we demonstrate how the invariant interpretation of the loop calculus , introduced in the section i , allows a natural extension to the case of a general @xmath0-ary alphabet . </S>",
    "<S> this is achieved via a loop tower sequential construction . </S>",
    "<S> the ground level in the tower is exactly equivalent to assigning one color ( out of @xmath0 available ) to the  ground state \" and considering all  excited \" states to be colored in the remaining @xmath1 colors , according to the loop calculus rule . </S>",
    "<S> sequentially , the second level in the tower corresponds to selecting a loop from the previous step , colored in @xmath1 colors , and repeating the same ground vs excited states partitioning procedure into one and the remaining @xmath2 colors , respectively . </S>",
    "<S> the construction proceeds until the complete set of @xmath1 levels in the loop tower ( including the corresponding contributions to the partition function ) is established . in section [ sec : free ] we discuss an ultimate relation between the loop calculus and the bethe free energy variational approach of @xcite .    </S>",
    "<S> we start with defining a statistical inference problem using the so - called forney - style graphical model formulation @xcite . </S>",
    "<S> the basic graph , @xmath3 , is described in terms of vertices , @xmath4 and edges , @xmath5 . </S>",
    "<S> variables , associated with the edges , assume their values in a @xmath0-ary alphabet , @xmath6 . </S>",
    "<S> the probability of a given configuration of variables @xmath7 on the entire graph is described by @xmath8 where @xmath9 is the normalization coefficient , also known as the partition function ; @xmath10 is an arbitrary positive function of the variables , @xmath11 , associated with all edges attached to vertex @xmath12 . </S>",
    "<S> @xmath13 ( or conversely @xmath14 ) indicates that the vertices @xmath15 and @xmath12 share an actual edge of the graph , @xmath16 . </S>",
    "<S> the marginal probabilities , e.g. associated with edges and vertices , @xmath17 constitute what one normally needs to evaluate in order to solve a statistical inference problem . </S>",
    "<S> the marginal probabilities can be also expressed in terms of derivatives of the so - called equilibrium free energy , @xmath18 , with respect to relevant parameters of the factor functions . </S>"
  ]
}