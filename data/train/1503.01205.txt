{
  "article_text": [
    "molecular communication is a promising approach to realise communications among nano - scale devices @xcite .",
    "there are many possible applications with these networks of nano - devices , for example , in - body sensor networks for health monitoring and therapy @xcite .",
    "this paper considers diffusion - based molecular communication networks .    in a diffusion - based molecular communication network ,",
    "transmitters and receivers communicate by using signalling molecules or ligands .",
    "the transmitter uses different time - varying functions of concentration of signalling molecules ( or emission patterns ) to represent different transmission symbols .",
    "the signalling molecules diffuse freely in the medium . when signalling molecules reach the receiver , they react with chemical species in the receiver to produce output molecules .",
    "the counts of output molecules over time is the receiver output signal which the receiver uses to decode the transmitted symbols .",
    "two components in diffusion - based molecular communication system are modulation and demodulation .",
    "a number of different modulation schemes have been considered in the literature .",
    "for example , @xcite consider concentration shift keying ( csk ) where different concentrations of signalling molecules are used by the transmitter to represent different transmission symbols .",
    "other modulation techniques that have been proposed include molecule shift keying ( msk ) @xcite , pulse position modulation ( ppm ) @xcite , amplitude shift keying ( ask)@xcite , frequency shift keying ( fsk ) @xcite , and token communication @xcite .",
    "this paper assumes that the transmitter uses different chemical reactions to generate the emission patterns of different transmission symbols .",
    "the motivation to use this type of modulation mechanism is that chemical reactions are a natural way to produce signalling molecules , e.g. the papers @xcite study a number of molecular circuits ( which are sets of chemical reactions ) that can produce oscillating signals , and the paper @xcite discusses a number of signalling mechanisms in living cells .",
    "we assume the receiver consists of receptors .",
    "when the signalling molecules ( ligands ) reach the receiver , they can react with the receptors to form ligand - receptor complexes ( which are the output molecules in this paper ) .",
    "we consider the problem of using the continuous - time history of the number of complexes for demodulation assuming that the transmitter and receiver are synchronised .",
    "the ligand - receptor complex signal is a stochastic process with three sources of noise because the chemical reactions at the transmitter , the diffusion of signalling molecules and the ligand - receptor binding process are all stochastic .",
    "we derive a continuous - time markov process ( ctmp ) which models the chemical reactions at the transmitter , the diffusion in the medium and the ligand - receptor binding process . by using this model and the theory of bayesian filtering , we derive the maximum a posteriori ( map ) demodulator using the continuous - time history of the number of complexes as the input .",
    "this paper makes two key contributions : ( 1 ) we propose to use a ctmp to model a molecular communication network with chemical reactions at the transmitter , a diffusive propagation propagation medium and receptors at the receiver .",
    "the ctmp captures all three sources of noise in the communication network .",
    "( 2 ) we derive a closed - form expression for the map demodulation filter using the proposed ctmp .",
    "the closed - form expression gives insight into the important elements needed for optimal demodulation , these are the timings at which the receptor bindings occur , the number of unbound receptors and the mean concentration of signalling molecules around the receptors .",
    "the rest of the paper is organised as follows .",
    "section [ sec : related ] discusses related work .",
    "section [ sec : model ] presents the system assumptions , as well as a mathematical model from the transmitter to the ligand - receptor complex signal based on ctmp .",
    "we derive the map demodulator in section [ sec : map ] and illustrate its numerical properties in section [ sec : eval ] . finally , section [ sec : con ] concludes the paper .",
    "there is a growing interest to understand molecular communication from the communication engineering point of view . for recent surveys of the field ,",
    "see @xcite .",
    "we divide the discussion under these headings : transmitters , receivers , models and others . *",
    "transmitters . *",
    "a number of different types of transmission signals have been considered in the molecular communication literature .",
    "the papers @xcite assume that the transmitter releases the signalling molecules in a burst which can be modelled as either an impulse or a pulse with a finite duration .",
    "a recent work in @xcite assumes that the transmitter releases the molecules according to a poisson process . in this paper",
    ", we instead assume that the transmitter uses different sets of chemical reactions to generate different transmission symbols and we use ctmp to model these transmission symbols .",
    "since a poisson process can also be modelled by a ctmp , the transmission process in this paper is more general than that of @xcite .",
    "our ctmp model can also deal with an impulsive input by using an appropriate initial condition for the ctmp .",
    "the use of ctmp as an end - to - end model  which includes the transmitter , the medium and the receiver  does not appear to have been used before .",
    "* receivers .",
    "* demodulation methods for diffusion - based molecular communication have been studied in @xcite .",
    "both papers also use the map framework with discrete - time samples of the number of output molecules as the input to the demodulator . instead , in this paper , we consider demodulation using continuous - time history of the number of complexes .",
    "the demodulation from ligand - receptor signal has also been considered in @xcite .",
    "the key difference is that @xcite uses a linear approximation of the ligand - receptor process while we use a non - linear reaction rate .",
    "the capacity of molecular communications based on ligand - receptor binding has been studied in @xcite assuming discrete samples of the number of complexes are available . a recent work",
    "@xcite considers the capacity of such systems in the continuous - time limit . instead of focusing on the capacity ,",
    "our work focuses on demodulation .",
    "receiver design is an important topic in molecular communication and has been studied in many papers , some examples are @xcite .",
    "these papers either use one sample or a number of discrete samples on the count of a specific molecule to compute the likelihood of observing a certain input symbols .",
    "this paper takes a different approach and uses continuous - time signals .",
    "another approach of receiver design for molecular communication is to derive molecular circuits that can be used for decoding .",
    "an attempt is made in @xcite to design a molecular circuit that can decode frequency - modulated signals .",
    "however , the work does not take diffusion and reaction noise into consideration .",
    "a recent work in @xcite analyses end - to - end molecular communication biological circuits from linear time - invariant system point of view .",
    "the work in @xcite compares the information theoretic capacity of a number of different types of linear molecular circuits .",
    "this paper differs from the previous work in that it uses a non - linear ligand - receptor binding model .",
    "the noise property of ligand - receptor for molecular communication has been characterised in @xcite .",
    "the case for non - linear ligand - receptor binding does not appear to have an analytical solution and @xcite derives an approximate characterisation using a linear reaction rate assuming that the number of signalling molecules around the receptor is large .",
    "this paper uses a non - linear ligand - receptor binding model and no approximation is used in solving the filtering problem .",
    "* models . *",
    "this paper uses the reaction diffusion master equation ( rdme ) @xcite framework to model the reactions and diffusion in the molecular communication networks .",
    "rdme assumes that time is continuous while the diffusion medium is discretised into voxels .",
    "this results in a ctmp with finite number of ( discrete ) states .",
    "rdme has been used to model stochastic dynamics of cells in the biology literature @xcite .",
    "an attraction of rdme is that it has the markov property which means that one can leverage the rich theory behind markov process .",
    "the author of this paper has previously used an extension of the rdme model , called the rdme with exogenous input ( rdmex ) model , to study molecular communication networks in @xcite .",
    "the rdmex assumes that the times at which the transmitter emits signalling molecules are deterministic .",
    "this results in a stochastic process which is piecewise markov or the markov property only holds in between two consecutive emissions by the transmitter . in this paper",
    ", we assume the transmitter uses chemical reactions to generate the signalling molecules .",
    "therefore , the emission timings are not deterministic but are governed by a stochastic process .    in this paper , we assume that the propagation medium is discretised in the voxels . an alternative modelling paradigm that has been used in a number of molecular communication network papers",
    "@xcite is that the transmitter or receiver has a non - zero spatial dimension ( commonly modelled by a sphere ) while the propagation medium is assumed to be continuous .",
    "( note that though @xcite does not explicitly state the dimension of the receiver , one can infer from the fact that the receiver must have a non - zero dimension because it has a non - zero probability of receiving the signalling molecules . )",
    "we believe the technique in this paper can be adapted to this alternative modelling paradigm and we do not expect this alternative modelling paradigm will change the results in this paper ; we will explain this in section [ sec : map : css ] .",
    "there is a rich literature in the modelling of biological systems discussing the difference between : ( 1 ) the particle approach which has a continuous state space because the state of a particle is its position ; and ( 2 ) the mesoscopic approach ( the approach in this paper ) which discretises the medium into discrete voxels and consider the number of molecules in the voxels as the state .",
    "the first approach is more accurate but the computation burden can be high @xcite , while the second approach is accurate for appropriate discretisation @xcite .",
    "there are also hybrid approaches too .",
    "an overview of various modelling and simulation approaches can be found in @xcite .",
    "* others : * the results of this paper may also be of interest to biologists who are interested to understand how living cells can distinguish between different concentration levels @xcite .",
    "the result of this paper can be viewed as a generalisation of @xcite which studies how cells can distinguish between two constant levels of ligand concentration .",
    "this paper considers diffusion - based molecular communication with one transmitter and one receiver in a fluid medium .",
    "figure [ fig : overall ] gives an overview of the setup considered in this paper .",
    "the transmitter uses different chemical reactions to generate the emission patterns of different transmission symbols .",
    "the transmitter acts as the source and emitter of signalling molecules .",
    "the signalling molecules diffuses in the fluid medium .",
    "the front - end of the receiver consists of a ligand - receptor binding process and the back - end consists of the demodulator with the number of complexes as its input .    in this section ,",
    "we first describe the system assumptions in section [ sec : model_basic ] .",
    "we then present , in section [ sec : e2e : g ] , an end - to - end model which includes the transmitter , the transmission medium and the ligand - receptor binding process in the receiver , see the dashed box in figure [ fig : overall ] .",
    "the end - to - end model is a ctmp which includes chemical reactions in the transmitter , diffusion in the medium and the ligand - receptor binding process in the receiver .",
    "we assume that the medium ( or space ) is discretised into voxels while time is continuous .",
    "this modelling framework results in a rdme @xcite , which is a ctmp commonly used to model systems with both diffusion and reactions .",
    "in addition , we assume the communication uses only one type of signalling molecule ( or ligand ) denoted by @xmath0 .",
    "we divide the description of our model into three parts : transmission medium , transmitter and receiver .",
    "we begin with the transmission medium .",
    "table [ tab : notation ] summaries the frequently used notation and chemical symbols .",
    "@xmath1 & dimension of one side of a voxel + @xmath2 & diffusion constant + @xmath3 & diffusion rate between neighbouring voxels + @xmath4 & total number of voxels + @xmath5 & total number of receptors + @xmath6 & reaction rate constant for the binding reaction + @xmath7 & @xmath8 + @xmath9 & reaction rate constant for the unbinding reaction + @xmath10 & a transmission symbol + @xmath11 & number of complexes at time @xmath12 + @xmath13 & number of signalling molecules in voxel @xmath14 at time @xmath12 + @xmath15 & equation . a vector containing the number of signalling molecules in each voxel , the counts of intermediate chemical species in the transmitter and the cumulative count of the number of molecules that have left the system + @xmath16 & the mean number of signalling molecules in the receiver voxel at time @xmath12 if the transmitter sends symbol @xmath10 + @xmath17 & the cumulative number of times the receptors have switched from the unbound to bound state at time @xmath12 + @xmath18 & an unbound receptor + @xmath0 & a signalling molecule + @xmath19 & a complex +      we model the transmission medium as a three dimensional ( 3-d ) space and partition the space into cubic _",
    "voxels _ of volume @xmath20 .",
    "figure [ fig : model ] shows an example of a medium which has a dimension of 4 voxels along both the @xmath21 and @xmath22-directions , and 1 voxel in the @xmath23-direction .",
    "( note that figure [ fig : model ] should be viewed as a projection onto the @xmath24 plane . ) in general , we assume the medium to have @xmath25 , @xmath26 and @xmath27 voxels in the @xmath21 , @xmath22 and @xmath23 directions where @xmath28 and @xmath27 are positive integers . in figure [",
    "fig : model ] , @xmath29 and @xmath30",
    ". we also use @xmath31 to denote the total number of voxels .",
    "we refer to a voxel by a triple @xmath32 where @xmath21 , @xmath22 and @xmath23 are integers or by a single index @xmath33 $ ] .",
    "figure [ fig : model ] shows the triples for some of the voxels .",
    "the single index @xmath34 is calculated from the triple @xmath32 by using @xmath35 .",
    "the single indices for voxels are shown in the top right - hand corner of the voxels in figure [ fig : model ] .",
    "diffusion is modelled by molecules moving from one voxel to a neighbouring voxel . for examples , in figure [ fig :",
    "model ] , molecules can diffuse from voxel 1 to voxels 2 or 5 , from voxel 2 to voxels 1 , 3 and 6 , and so on .",
    "the diffusion of molecules between neighbouring voxels is indicated by the two - way arrows in figure [ fig : model ] .",
    "we assume that the signalling molecule @xmath0 is the only diffusible chemical species in our model and the diffusion coefficient for @xmath0 is @xmath2 .",
    "this means the signalling molecules diffuse from one voxel to a neighbouring voxel at a mean rate of @xmath3 where @xmath36 . in other words , within an infinitesimal time @xmath37 , the probability that a signalling molecule diffuses to a neighbouring voxel is @xmath38 .",
    "note that the expression for @xmath3 can be derived from spatially discretising the diffusion equation into regular cubic voxels of volume @xmath20 , see @xcite or ( * ? ? ?",
    "* section 3 ) .",
    "the dashed lines in figure [ fig : model ] indicate the boundary of our transmission medium .",
    "many different boundary conditions are used by engineers and physicists to model what happens when a molecule reaches the boundary of a medium .",
    "two typical boundary conditions are absorbing and reflecting boundaries @xcite .",
    "an absorbing boundary means that a molecule can leave the transmission medium and once the molecule has left , it will not return to the medium . for example , in figure [ fig : model ] , we allow molecules to leave the medium via one surface of voxel 16 as indicated by the one - way arrow .",
    "mathematically , this is modelled by a rate of leaving the medium , similar to that of modelling the diffusion between the voxels .",
    "a reflecting boundary means that a molecule can not leave the medium , i.e. a molecule hitting a reflecting boundary will stay in the voxel .",
    "our model can capture these boundary conditions .",
    "it has been shown in @xcite that in order for rdme to produce physically meaningful results , the voxel dimension @xmath1 can not be too small and in order for rdme to reduce the discretisation error , @xmath1 can not be too large . in this paper , we assume that @xmath1 comes from a valid range .",
    "the choice of @xmath1 is beyond the scope of the paper and the reader can refer to @xcite for further discussion .    for simplicity , we assume that the medium is homogeneous with a constant diffusion coefficient @xmath2 .",
    "it is straightforward to extend the framework to cover inhomogeneous medium @xcite .",
    "it is also possible to use non - cubic voxels , see @xcite .",
    "we assume the transmitter occupies one voxel . however , it is straightforward to generalise to the case where a transmitter occupies multiple voxels .",
    "we limit our consideration to one symbol interval without inter - symbol interference ( isi ) at this moment .",
    "we will discuss the multiple symbol interval case with isi in section [ sec : isi ] .",
    "we assume that the transmitter can send @xmath39 different symbols @xmath40 where each symbol @xmath10 is characterised by an emission pattern @xmath41 .",
    "the role of emission pattern in molecular communication is the same as that of transmitted signal in electromagnetic communication .",
    "if a transmitter uses a deterministic emission pattern @xmath41 to represent symbol @xmath10 , it means the transmitter emits @xmath41 signalling molecules into the transmitter voxel at time @xmath12 .",
    "we use an example to illustrate the meaning of emission pattern .",
    "consider an emission pattern @xmath42 for symbol 1 where @xmath43 where @xmath44 denotes the kronecker delta , which means @xmath45 if and only if @xmath46 . the emission pattern @xmath42 means that , for symbol 1 , the transmitter emits one signalling molecule at times 1.2 and 5.6 , two signalling molecules at time 8.1 and does not emit any molecules at any other times .    in this paper , we assume that the emission pattern for each symbol is produced by a set of chemical reactions located in the transmitter voxel .",
    "given @xmath39 symbols , the transmitter uses @xmath39 different reactions to generate these symbols , see figure [ fig : overall ] . as an example , a class of chemical reactions inside living cells @xcite is @xmath47 rna +   a }   \\label{cr : rna}\\end{aligned}\\ ] ] where ribonucleic acid ( rna , which is a molecule commonly found in living cells ) produces the chemical species @xmath48 .",
    "this class of chemical reactions can be modelled by a poisson process where molecules of @xmath48 are produced at a mean rate of @xmath49 @xcite .",
    "note that the emission patterns produced by chemical reactions are _ not _ deterministic , but _",
    "stochastic_. the mean emission pattern of this chemical reaction is @xmath50 = \\kappa$ ] . following on from the above example",
    ", one can realise amplitude shift keying ( ask ) in molecular communication by using different chemical reactions that can produce signalling molecules at different mean rates .",
    "for example , if there are four different reactions that can produce signalling molecules at four different mean rates of @xmath51 , @xmath52 , @xmath53 and @xmath54 , then one can use these four different reactions to produce 4 different symbols .",
    "note that it is possible for the four chemical reactions to produce the same emission pattern ( or realisation ) , though with different probabilities .",
    "a standard result in physical chemistry shows that the dynamics of a set of chemical reactions can be modelled by a ctmp @xcite .",
    "therefore , we will model the transmitter by a ctmp .",
    "note that , in this paper , we will not specify the sets of chemical reactions used by the transmitter except for simulation because the map demodulator does not explicitly depend on the sets of chemical reactions that the transmitter uses .",
    "we assume the receiver occupies one voxel and we use @xmath55 to denote the index of the voxel at which the receiver is located . in figure",
    "[ fig : model ] , we assume the receiver is at voxel 7 ( light grey ) and hence @xmath56 for this example .",
    "in addition , we assume that the transmitter and receiver voxels are distinct .",
    "we assume that the receiver has @xmath5 non - interacting receptors and we use @xmath18 as the chemical name for an unbound receptor .",
    "these receptors are fixed in space and do not diffuse , and they are only found in the receiver voxel .",
    "furthermore , these receptors are assumed to be uniformly distributed in the receiver voxel .",
    "the receptor @xmath18 can bind to a signalling molecule @xmath0 to form a ligand - receptor complex ( or complex for short ) @xmath19 , which is a molecule formed by combining @xmath18 and @xmath0 .",
    "this is known as ligand - receptor binding in molecular biology literature @xcite .",
    "the binding reaction can be written as the chemical equation : @xmath57 c } \\label{cr : on }   \\end{aligned}\\ ] ] where @xmath6 is the reaction rate constant .",
    "since the receptors are only found in the receiver voxel , the binding reaction occurs in a volume of @xmath20 , which is the volume of a voxel .",
    "the rate at which the complexes @xmath19 is formed is given by the product of @xmath58 , the number of signalling molecules in the receiver voxel and the number of unbound receptors this footnote explains how @xmath58 comes about .",
    "consider a chemical reaction where reactants s and e react to form product c. we assume the reactions are taking place within a volume of @xmath20 .",
    "let @xmath59 , @xmath60 and @xmath61 be , respectively , the concentration of s , e and c in the volume .",
    "the law of mass action says that @xmath62 . in the case of the ctmp or rdme in this paper",
    ", we want to keep track of the number of molecules in a volume ( the voxel ) instead .",
    "let @xmath63 , @xmath64 and @xmath65 be , respectively , the number of s , e and c molecules in the volume . since concentration and molecule counts are related by @xmath66 etc , we will , in a mathematically loose way , write @xmath67 . since @xmath65 is a discrete quantity ,",
    "the derivative @xmath68 is not defined but we can interpret it as the production rate of molecules @xmath19 .",
    "this explains how to convert the law of mass action , which is in terms of concentration , to the rate law used in rdme which is in terms molecular counts .",
    "this conversion is also discussed in @xcite . ] .",
    "we define @xmath8 and will use @xmath7 in the ctmp .",
    "note that this is equivalent to ligand - receptor binding model used in ( * ? ? ?",
    "* section v - b ) .",
    "a ligand - receptor complex @xmath19 can dissociate into an unbound receptor @xmath18 and a signalling molecule @xmath0 .",
    "this can be represented by the chemical equation @xmath69 e + s } \\label{cr : off }   \\end{aligned}\\ ] ] where @xmath9 is the reaction rate constant .",
    "the rate at which the complexes are dissociating is given by the product of @xmath9 and the number of complexes where @xmath61 is the concentration of the complexes .",
    "we can use the same argument in footnote [ fn : bind ] to show that the dissociation rate of @xmath19 is @xmath70 where @xmath65 is the number of complexes . in particular , note that no scaling by volume @xmath20 of the voxel is required . ] .    since a receptor can either be in an unbound state @xmath18 or in a complex @xmath19",
    ", we have the following conservation relation : the number of unbound receptors plus the number of complexes is equal to the total number of receptors @xmath5 .      in order to derive the map demodulator , we need an end - to - end model which includes the transmitter , the medium and the ligand - binding process , see figure [ fig : overall ] . since chemical reactions ( which includes the chemical reactions in the transmitter as well as the ligand - receptor binding process in the receiver ) and diffusion can be modelled by ctmp , it is possible to use a ctmp as an end - to - end model . in this section",
    "we present a general end - to - end model that includes the transmitter , diffusion and the ligand - receptor process in the receiver .",
    "an excellent tutorial introduction to the modelling of chemical reactions and diffusion by using ctmp can be found in @xcite .",
    "we have also included an example in appendix [ app : e2e_ex ] .",
    "the aim of the end - to - end model is to determine the properties of the receiver signal from the transmitter signal .",
    "the receiver signal in our case is the number of complexes over time .",
    "since the transmitter uses @xmath39 symbols , the transmitter signal is generated by one of the @xmath39 sets of chemical reactions .",
    "this means that we need @xmath39 end - to - end models with a model for each of the @xmath39 symbols or sets of chemical reactions .",
    "the principle behind building these @xmath39 models is identical so without loss of generality , we will assume that the model here is for symbol 0 .",
    "we begin with a few definitions .",
    "let @xmath13 ( where @xmath71 ) be the number of signalling molecules @xmath0 in voxel @xmath14 at time @xmath12 .",
    "in particular , since we have defined @xmath55 to be the index of the receiver voxel , @xmath72 is the number of signalling molecules in the receiver voxel .",
    "we assume the transmitter is a set of chemical reactions which uses @xmath73 intermediate chemical species @xmath74 , @xmath75 , ... and @xmath76 and these intermediate species remain in the transmitter voxel .",
    "let @xmath77 be the number of chemical species @xmath78 in the transmitter voxel at time @xmath12 .",
    "molecules may also be degraded or leave the system forever if absorbing boundary condition is used .",
    "we use @xmath79 to denote the cumulative number of molecules that have left the system . note",
    "that since @xmath80 and @xmath79 are molecular counts , they must belong to the set of non - negative integers @xmath81 .",
    "we define the vector @xmath82 to be : @xmath83^t \\label{eqn : state}\\end{aligned}\\ ] ] where @xmath84 denotes matrix transpose .",
    "let @xmath11 denote the number of complexes or bound receptors at time @xmath12 and @xmath85}$ ] denote the set of integers between @xmath86 and @xmath5 inclusively .",
    "we require that a valid @xmath11 must be an element of @xmath85}$ ] . since there are @xmath5 receptors , the number of unbound receptor is @xmath87 .",
    "the state of the end - to - end model is the tuple @xmath88 .",
    "we will now specify the transition probabilities from state @xmath88 to state @xmath89 .",
    "state transitions can be caused by any one of these events : a chemical reaction in the transmitter , the diffusion of a signalling molecule from a voxel to neighbouring voxel , and the binding or unbinding of a receptor in the receiver .",
    "we know from the theory of ctmp that the probability of two events taking place in an infinitesimal duration of @xmath37 is of the order of @xmath90 . intuitively , this means only one event can occur within @xmath37 .",
    "we can divide the transition probabilities from @xmath88 to @xmath89 into 2 groups depending on whether the number of complexes has changed or not in the time interval @xmath91 .",
    "if the number of complexes has changed from time @xmath12 to @xmath92 , i.e. @xmath93 , this means either a binding reaction or a unbinding reaction has occurred .",
    "if a binding reaction has occurred , then the number of signalling molecules in the receiver voxel is decreased by 1 and the number of complexes @xmath11 is increased by 1 .",
    "this reaction occurs at a mean rate of @xmath94 .",
    "we use @xmath95 to denote the standard basis vector with a ` 1 ' at the @xmath14-th position .",
    "we can write the state transition probability of the receptor binding reaction as : @xmath96     = \\lambda \\ ; n_r(t ) \\ ; ( m - b(t ) ) \\ ; \\delta t \\label{eqn : tp : r1}\\end{aligned}\\ ] ] @xmath97   \\nonumber \\\\   & = \\lambda \\ ; n_r(t ) \\ ; ( m - b(t ) ) \\ ; \\delta t \\label{eqn : tp : r1}\\end{aligned}\\ ] ]    recalling that @xmath55 is the index of the receiver voxel and @xmath72 is the @xmath55-th element of @xmath15 in , the expression @xmath98 is equivalent to @xmath99 , which means the number of signalling molecules in the receiver voxel has decreased by 1 .",
    "similarly , the expression @xmath100 says the number of complexes has increased by 1 .",
    "the right - hand side ( rhs ) of is the transition probability and is given by the product of mean reaction rate and @xmath37 .",
    "similarly , the transition probability of the unbinding reaction is given by : @xmath101   = \\mu \\ ; b(t ) \\ ; \\delta t \\label{eqn : tp : r2 } \\end{aligned}\\ ] ] @xmath102 \\nonumber \\\\   & = \\mu \\ ; b(t ) \\ ; \\delta t \\label{eqn : tp : r2 } \\end{aligned}\\ ] ] where rhs of is the transition probability .",
    "we now specify the second group of transition probabilities with @xmath103 .",
    "these transitions are caused by either a reaction in the transmitter or diffusion of signalling molecules between neighbouring voxels .",
    "let @xmath104 be two valid @xmath15 vectors ; let also @xmath105}$ ] .",
    "for @xmath106 , we write @xmath107     = d_{ij } \\ ; \\delta t   \\label{eqn : tp : eta}\\end{aligned}\\ ] ] @xmath108 \\nonumber \\\\   & = d_{ij } \\ ; \\delta t   \\label{eqn : tp : eta}\\end{aligned}\\ ] ] where @xmath109 is the transition rate from state @xmath110 to state @xmath111 . since this transition is due to either a reaction in the transmitter or diffusion , @xmath109 is independent of the number of complexes @xmath112 .",
    "depending on the type of transition , the value of @xmath109 can depend on the reaction constants in the transmitter , diffusion rate and some states of @xmath113 .",
    "for example , if the transition from @xmath113 to @xmath114 is caused by the diffusion of a signalling molecule from voxel 1 to voxel 2 , we have @xmath115 at a rate of @xmath116 where @xmath117 is the first element in @xmath113 or equivalently the number of signalling molecules in voxel 1 in state @xmath113 ; so , for this example , @xmath118 .",
    "the main advantage of using equation is that it allows us a cleaner abstraction to solve the bayesian filtering problem when deriving the map demodulator .",
    "we also remark that we will not specify the exact expression of @xmath109 because @xmath109 s do not appear explicitly in the demodulator .",
    "equations , and specify all the possible state transitions .",
    "the probability of no state transition is therefore : @xmath119 \\nonumber \\\\    & =   1 - d_{jj } \\ ; \\delta t   - \\lambda \\ ;",
    "n_r(t ) \\ ; ( m - b(t ) ) \\ ; \\delta t - \\mu \\ ; b(t ) \\ ; \\delta t    \\label{eqn : tp : no}\\end{aligned}\\ ] ] where @xmath120    we have now specified all the state transition probabilities for symbol 0 . if a different symbol is used , the value of @xmath73 , the dimension of @xmath15 and the @xmath109 parameters can change",
    ". however , the state transition probabilities still can be summarised by equations of the form , and . in any case",
    ", the derivation of the map demodulator only requires us to work with one symbol at a time .",
    "hence , we will use equations - for any transmission symbol .",
    "note that the ctmp includes all the three sources of noise in our system , due to chemical reactions in the transmitter , random diffusive movements in the medium and the ligand - receptor binding process at the receiver .",
    "some of these noise components have also been characterised in earlier literature .",
    "for example , @xcite discusses sampling noise at the transmitter and counting noise at the receiver .",
    "one can study these noises using the derived ctmp and let us take sampling noise as an example . for the moment , let us isolate the transmitter voxel from the propagation medium , i.e. we do not allow the signalling molecules to leave or enter the transmitter voxel . in this case , the number of signalling molecules in the transmitter voxel is due entirely to chemical reactions and we use @xmath121 to denote the number of signalling molecules in the isolated transmitter voxel at time @xmath12 .",
    "now , let us consider the transmitter voxel again but we allow signalling molecules to diffuse in and out of the voxel ; we use @xmath122 to denote the number of signalling molecules in the transmitter voxel in this case .",
    "it is natural to consider @xmath122 as the transmitter signal because this is the number of signalling molecules in the transmitter voxel .",
    "however , @xmath122 can be different from @xmath121 because signalling molecules can diffuse in and out of the transmitter voxel , which is the cause of sampling noise .",
    "equations to hold for any valid state @xmath88 .",
    "if we collect all the transition probability equations for all valid states , then we can form the infinitesimal generator of the ctmp . for a given initial probability distribution of the initial state @xmath123",
    ", one can in principle solve the first order ordinary differential equation ( ode ) associated with the infinitesimal generator to compute the probability of the number of complexes @xmath11 , or the property of the receiver signal .",
    "however , in practice , this ode is of a very high dimension and it is an active area of research to derive algorithms to solve this ode efficiently and accurately @xcite .",
    "this section aims to derive the optimal demodulator using the ctmp derived in the previous section .",
    "we assume the input to the demodulator is the continuous - time signal @xmath11 which is the number of complexes at time @xmath12 .",
    "there are a number of reasons why we choose to work with the continuous - time signal @xmath11 , rather than its sampled version .",
    "first , the signal @xmath11 may * not * be strictly band limited in the frequency domain .",
    "second , our results show that the optimal demodulator needs to know the time instances at which a receptor is switching from the unbound to bound state . this timing information , which is essentially an impulse , is unfortunately lost by sampling @xmath11 .",
    "third , the solution of the proposed decoding problem can be used to benchmark molecular circuit @xcite based decoders . since molecular circuits use chemical reactions for computation , they are fundamentally analogue circuits .",
    "fourth , there is an increasing interest in the circuit design community to design low - power analogue signal processing circuits @xcite .",
    "an intermediate step to derive the map demodulator is to solve a continuous - time filtering problem . in a filtering problem",
    ", one uses all the observations available up till time @xmath12 to predict the system state at time @xmath12 . for our case ,",
    "the observations are the number of complexes @xmath11 in the continuous interval @xmath124 $ ] .",
    "( this means the number of observations is infinite because we are considering the continuous - time signal @xmath11 in a non - zero time interval @xmath124 $ ] . )",
    "we use @xmath125 to denote the section of the signal @xmath11 in the time interval @xmath124 $ ] .",
    "( note that the @xmath126 is not a set notation . here",
    "@xmath127 is a realisation of the number of complexes in @xmath124 $ ] of the ctmp .",
    "this notation is used in some non - linear filtering literature , e.g. @xcite . )",
    "we can think of @xmath127 as the history of the number of complexes up till time @xmath12 .",
    "the demodulation problem is to use the history @xmath127 to determine which symbol the transmitter has sent .    in sections [ sec : map1 ] to [ sec : map3 ] , we consider only one symbol interval and do not consider isi .",
    "we consider the isi case in section [ sec : isi ] .",
    "we adopt a map framework for detection .",
    "let @xmath128 $ ] denote the posteriori probability that symbol @xmath10 has been sent given the history @xmath127 .",
    "if the demodulation decision is to be done at time @xmath12 , then the demodulator decides that symbol @xmath129 has been sent if @xmath130\\end{aligned}\\ ] ]    instead of working with @xmath128 $ ] , we will work with its logarithm .",
    "let @xmath131)\\end{aligned}\\ ] ]    the first step is to determine @xmath132 from @xmath133 . given @xmath127 is the section of @xmath11 in the time interval @xmath124 $ ]",
    ", one can consider @xmath134 as the concatenation of @xmath127 and the section of @xmath11 in the time interval @xmath135 $ ] .",
    "over an infinitesimal @xmath37 , we can consider the signal @xmath11 is a constant in the time interval @xmath135 $ ] ; we therefore abuse the notation and use @xmath136 to denote the section of @xmath11 in the time interval @xmath135 $ ] . by using bayes rule",
    ", it can be shown that @xmath137 )    - \\log ( \\mathbf{p}[b(t+\\delta t ) | { \\cal b}(t ) ] ) \\label{eqn : logpp_prelim}\\end{aligned}\\ ] ] @xmath137 ) \\nonumber \\\\   & - \\log ( \\mathbf{p}[b(t+\\delta t ) | { \\cal b}(t ) ] ) \\label{eqn : logpp_prelim}\\end{aligned}\\ ] ] where @xmath138 $ ] is the probability that there are @xmath139 complexes given that the transmitter has sent the symbol @xmath10 and the previous history @xmath127 .",
    "the last term on the rhs of , i.e. @xmath140 $ ] , is independent of the transmission symbol so we do not need it for the purpose of detection .",
    "we will focus on determining @xmath138 $ ] .",
    "the problem of determining the probability @xmath138 $ ] is essentially a bayesian filtering problem .",
    "recall that the complete state of the system is @xmath88 and the receiver can only observe @xmath11 , therefore the task of the receiver is to use the history @xmath127 and the system model to do prediction .",
    "standard method can be used to derive @xmath138 $ ] but the derivation is long , especially because of the diffusion terms ; the derivation can be found in appendix [ app : proofa ] .",
    "the result is @xmath141 \\nonumber \\\\       = & \\delta_{b(t+\\delta t ) ,",
    "b(t ) + 1 } \\ ;",
    "\\lambda ( m - b(t ) )   \\ ; \\delta t   \\ ;   \\mathbf{e } [ n_r(t ) | s ,   { \\cal b}(t ) ]   +            \\delta_{b(t+\\delta t ) , b(t ) - 1 } \\ ; \\mu b(t ) \\ ; \\delta t \\ ; + \\nonumber   \\\\         & \\delta_{b(t+\\delta t ) , b(t ) } \\ ;             ( 1 - \\lambda ( m - b(t ) ) { \\mathbf e}[n_r(t ) | s ,   { \\cal b}(t ) ] \\ ; \\delta t - \\mu b(t )   \\ ; \\delta t )          \\label{eqn : predictb}\\end{aligned}\\ ] ] @xmath141 \\nonumber \\\\       = & \\delta_{b(t+\\delta t ) , b(t ) + 1 } \\lambda ( m - b(t ) )   \\ ; \\delta t   \\ ;   \\mathbf{e } [ n_r(t ) | s ,   { \\cal b}(t ) ]   +   \\nonumber \\\\         & \\delta_{b(t+\\delta t ) , b(t ) - 1 } \\mu b(t ) \\ ; \\delta t \\ ; + \\nonumber   \\\\         & \\delta_{b(t+\\delta t ) , b(t ) } \\times \\nonumber \\\\          &   ( 1 - \\lambda ( m - b(t ) ) { \\mathbf e}[n_r(t ) | s ,   { \\cal b}(t ) ] \\ ; \\delta t - \\mu b(t )   \\ ; \\delta t )          \\label{eqn : predictb}\\end{aligned}\\ ] ] note that only one of the three terms on the rhs of equation is non - zero depending on whether the observed @xmath139 is one more , one less or equal to that of @xmath11 .",
    "the term @xmath142 $ ] is the expected number of signalling molecules in the receiver voxel given the history and the symbol @xmath10 .",
    "the meaning of this term is that the receiver uses the history to predict what the expected number of signalling molecules in the receiver voxel is .",
    "note that only the chemical kinetic parameters @xmath7 and @xmath9 of the receptor appear explicitly in equation .",
    "other parameters , such as the set of chemical reaction that generate symbol @xmath10 and the diffusion coefficient , do not appear explicitly in equation but influence the system behaviour via the term @xmath142 $ ] .      by substituting equation into equation and let @xmath37 go to zero , we show in appendix [ app : proofb ] that @xmath143 ) -    \\lambda ( m - b(t ) ) { \\mathbf e}[n_r(t ) | s , { \\cal b}(t ) ] + \\tilde{l}(t )   \\label{eqn : logpp_dd } \\end{aligned}\\ ] ] @xmath143 ) - \\nonumber \\\\   & \\lambda ( m - b(t ) ) { \\mathbf e}[n_r(t ) | s , { \\cal b}(t ) ] + \\tilde{l}(t )   \\label{eqn : logpp_dd } \\end{aligned}\\ ] ] with @xmath144 initialised to the logarithm of the prior probability that symbol @xmath10 is sent .",
    "equation is the _ optimal _ demodulation filter .",
    "the term @xmath17 is the cumulative number of times that the receptors have turned from the unbound to bound state .",
    "the meaning of @xmath17 is illustrated in figure [ fig : ut ] assuming there are two receptors .",
    "the top two pictures in figure [ fig : ut ] show the state transitions for the two receptors .",
    "the third picture shows the function @xmath17 which is increased by one every time a receptor switches from the unbound to bound state .",
    "the bottom picture shows @xmath145 which is the derivative of @xmath17 .",
    "note that @xmath145 consists of a train of impulses ( or dirac deltas ) where the timings of the impulses are the times at which a receptor binding event occurs . loosely speaking",
    ", one may also view @xmath145 as @xmath146 .",
    "the function @xmath147 , which is the last term on the rhs of , contains all the terms that are independent of symbol @xmath10 .",
    "since @xmath133 does not appear on the rhs of , this means that @xmath147 adds the same contribution to all @xmath133 for all @xmath148 .",
    "we can therefore ignore @xmath147 for the purpose of demodulation .",
    "the term @xmath149 $ ] in equation is the prediction of the mean number of signalling molecules in the receiver voxel using the history of receptor state .",
    "this is a filtering problem which requires extensive computation .",
    "instead , we assume that the receiver has prior knowledge that if symbol @xmath10 is transmitted , then the mean number of signalling molecules in the receiver voxel is @xmath150 $ ] and the receiver uses @xmath16 for demodulation .",
    "we can view @xmath16 as internal models that the demodulator uses .",
    "the use of internal models is fairly common in signal processing and communication , e.g. a matched filter correlates the measured data with an expected response .    after making the modifications described in the last two paragraphs",
    ", we are now ready to describe the demodulator . using @xmath11 as the input",
    ", the demodulator runs the following @xmath39 continuous - time filters in parallel : @xmath151 where @xmath152 is initialised to the logarithm of the prior probability that the transmitter sends symbol @xmath10 .",
    "if the demodulator makes the decision at time @xmath12 , then the demodulator decides that symbol @xmath129 has been transmitted if @xmath153 the demodulator structure is illustrated in figure [ fig : demod ] . by comparing equations and",
    ", it can be shown that @xmath154 for any two symbols @xmath155 and @xmath156 .",
    "an interpretation of the demodulation filter output @xmath157 is that @xmath158 is proportional to the posteriori probability @xmath128 $ ] .",
    "note that the replacement of @xmath149 $ ] in equation by @xmath16 means that the demodulation filter is _ sub - optimal_. if @xmath149 $ ] and @xmath16 are close to each other , we expect the performance degradation to be small .",
    "it is an open problem what the difference between @xmath149 $ ] and @xmath16 is .",
    "the difficulty in answering this problem is due to the fact that ligand - receptor binding is a nonlinear process . in appendix [ app : c ] ,",
    "we motivate the closeness between @xmath149 $ ] and @xmath16 by studying an analogous problem in linear time - invariant ( lti ) systems .",
    "we will compare the performance of the optimal and sub - optimal demodulation filters in section [ sec : prop_cf_opt_bf ] .    in order to understand equation",
    ", we consider the situation where symbol 1 generates a lot more signalling molecules than symbol 0 such that it results in more signalling molecules in the receiver voxel , or @xmath159 for all @xmath12 .",
    "if the transmitter sends symbol 1 , then more signalling molecules are expected to reach the receiver voxel .",
    "the consequence is that there are more receptor binding events and the number of unbound receptors @xmath160 is smaller .",
    "therefore , in equation , we expect a big positive contribution from the first term on the rhs and a small negative contribution from the second term .",
    "the net effect is a big @xmath161 . on the other hand ,",
    "if the transmitter sends symbol 0 , the number of receptor binding events is smaller and @xmath160 is big .",
    "this results in a smaller @xmath162 .",
    "therefore , @xmath161 is likely to be bigger than @xmath162 , which means correct detection .",
    "the implementation of the demodulator is an open research problem .",
    "the demodulation filter is an analogue filter and it requires the internal model @xmath163 .",
    "the design of analogue circuits using chemical reactions for calculations is an active research area , see @xcite for a recent overview .",
    "the demodulation filter requires logarithm , multiplication , subtraction , integration and counting the number of times the receptors have switched from the unbound to bound state .",
    "an analogue molecular circuit for calculating logarithm is presented in @xcite .",
    "there are also circuits that can perform multiplication and subtraction @xcite .",
    "living cells are known to use integration @xcite .",
    "it may be possible to implement the counting using a chemical reaction @xcite .",
    "it may be possible to approximate the internal models by using some lower order chemical reactions .",
    "this discussion shows that some components to implement the demodulator exist but the exact implementation remains an open problem .    in order to bypass the difficulty of computing @xmath149 $ ]",
    ", we have proposed to use internal models @xmath16 .",
    "an open research problem is to study sub - optimal estimation of @xmath149 $ ] .",
    "note that @xcite shows that analogue computation is more efficient than digital computation if high precision is not required .",
    "an interesting problem is to study the impact of low precision analogue calculations on the demodulation performance .",
    "we mention in section [ sec : related ] that some papers in molecular communications assume a continuous medium ( rather than discretising the medium into voxels ) and a non - zero receiver size . if a continuous medium is assumed , the state of a signalling molecule in the transmission medium is its position .",
    "let @xmath164 be the probability that a molecule is at position @xmath165 at time @xmath12 .",
    "the time evolution of @xmath164 can again be modelled by a ctmp , which is continuous in both time and space .",
    "the time evolution of @xmath164 is described by the differential chapman - kolmogorov equation ( cke ) @xcite .",
    "it is possible to derive an alternative ctmp by replacing the diffusion of signalling molecules in equation by differential cke as well as by adding equations to describe how the signalling molecules enter or leave the receiver voxel",
    ". we can then apply bayesian filtering to this alternative ctmp .",
    "we expect this alternative ctmp will give the same demodulator filter because in our derivation based on discrete voxels , the map demodulator depends only on the number of the signalling molecules in the receiver voxel and the diffusion parameters do not appear explicitly in the demodulation filter",
    ". further support of this argument is given in the derivation in appendix [ app : proofb ] where we show that the @xmath109 parameters in are cancelled out in deriving the bayesian filter .",
    "it is in principle possible to use the demodulation filters to deal with the case with isi .",
    "we use @xmath166 to denote one symbol duration and we assume that isi only lasts for a finite amount of time . specifically , consider a symbol sent in @xmath167 $ ] , we assume that the effect of this transmission can be neglected after the time @xmath168",
    ". this can be realised by appropriately choosing the transmitter and receiver parameters , @xmath166 and @xmath169 .    in order to make the explanation here a bit more concrete ,",
    "we assume that the transmitter uses @xmath170 symbols and @xmath171 . over a duration of @xmath171 symbols , the possible sequences sent by the transmitter are 000 , 001 , 010 , 011 , ... , 111 .",
    "let @xmath172 denote the mean number of signalling molecules at the receiver voxel if the sequence 000 is sent .",
    "we can similarly define @xmath173 .",
    "consider the transmission of three consecutive symbols @xmath174 and @xmath175 .",
    "assuming that we have an estimation of the first two symbols @xmath176 and @xmath177 , then the decoding of @xmath175 can be done by using the demodulation filter by replacing @xmath16 by @xmath178 .",
    "for example , if @xmath179 and @xmath180 , then one can decode what @xmath175 is by using the demodulator filters @xmath181 and @xmath181 .",
    "although the decision feedback based method can solve the isi problem , the number of internal models increases exponentially with the memory length parameter @xmath169 .",
    "the reason why we need to consider all @xmath182 possible transmission sequences is that the ligand - receptor binding process has a non - linear reaction rate .",
    "a method to reduce the number of internal models is to design the system so that @xmath172 etc .",
    "can be decomposed into a sum .",
    "let @xmath16 ( @xmath183 ) be the mean number of signalling molecules at the receiver voxel if the symbol @xmath10 is sent for one symbol duration and in the absence of isi .",
    "if @xmath184 holds for all @xmath185 and @xmath186 , then one can again make use of decision feedback to decode the isi signal .",
    "however , this time , only @xmath39 internal models are needed .",
    "equation can be made to hold approximately if the number of receptors is large .",
    "this can be explained as follows .",
    "first of all , if ligand - receptor binding is absent , this means there is only free diffusion then equations holds because the mean number of signalling molecules obeys the diffusion equation which is linear .",
    "this means that we need to create an environment that  looks like \" free diffusion even when ligand - receptor binding is present .",
    "this can be realised if the number of signalling molecules that are bound to the receptors is small compared to those that are free .",
    "a method to achieve this is to increase the number of receptors .",
    "we will demonstrate this with a numerical example in section [ sec : eval ] .",
    "however , it is still an open problem to solve the isi in the general case .",
    "the aim of this section is to study the properties of the map demodulator numerically .",
    "we begin with the methodology .",
    "we assume the diffusion coefficient @xmath2 of the medium is 1 @xmath9m@xmath187s@xmath188 .",
    "the receptor parameters are @xmath6 = 0.005 @xmath9m@xmath189 s@xmath188 , @xmath8 , and @xmath190 s@xmath188 .",
    "these values are similar to those used in @xcite and @xcite   = 100 @xmath9m@xmath187s@xmath188 , @xmath6 = 0.2 @xmath9m@xmath189 s@xmath188 and @xmath191 s@xmath188 .",
    "these parameters are 10100 times faster than ours and can be considered as a time - scaling .",
    "note that @xcite uses @xmath192 and @xmath193 instead of , respectively , @xmath6 and @xmath9 . ] .",
    "the above parameter values will be used for all the numerical experiments .    for each experiment ,",
    "the transmitter uses either @xmath170 or @xmath194 symbols .",
    "each symbol is generated by a different sets of chemical reactions .",
    "different experiments may use different sets of chemical reactions and will be described later .",
    "the number of receptors also varies between the experiments .",
    "we use the stochastic simulation algorithm ( ssa ) @xcite to obtain realisations of @xmath11 which is the number of complexes over time .",
    "ssa is a standard algorithm in chemistry to simulate diffusion and reactions ; it is essentially an algorithm to simulate a ctmp .    in order to use equation",
    ", we require the mean number of signalling molecules @xmath16 in the receiver voxel when symbol @xmath10 is sent .",
    "unfortunately , it is not possible to analytically compute @xmath16 from the ctmp because of moment closure problem which arises when the transition rate is a non - linear function of the state @xcite .",
    "we therefore resort to simulation to estimate @xmath16 .",
    "each time when we need an @xmath16 , we run ssa simulation 500 times and average the results to obtain @xmath16 .",
    "note that these simulations are different from those that we use to generate @xmath11 for the performance study .",
    "in other words , the simulations for estimating @xmath16 and for performance study are completely independent .",
    "once @xmath11 and @xmath16 are obtained , we use numerical integration to calculate @xmath157 using equation .",
    "we assume that all symbols appear with equal probability , so we initialise @xmath195 for all @xmath10 .",
    "the optimal demodulation filter requires the term @xmath149 $ ] which can be obtained by solving a bayesian filtering problem .",
    "since filtering problems are computationally expensive to solve , we propose the sub - optimal demodulation filter which uses @xmath150 $ ] as an internal model .",
    "the aim of this section is to compare the performance of these two demodulation filters .    in this comparison",
    ", we consider a medium of 1@xmath9 m @xmath196 @xmath197@xmath9 m @xmath196 @xmath197@xmath9 m .",
    "we assume a voxel size of ( @xmath197@xmath9m)@xmath198 ( i.e. @xmath199 @xmath9 m ) , creating an array of @xmath200 voxels .",
    "the voxel co - ordinates of transmitter and receiver are , respectively , ( 1,1,1 ) and ( 3,1,1 ) .",
    "a reflecting boundary condition is assumed .",
    "the reason why we have chosen to use such a small number of voxels is because of the dimensionality of the filtering problem .",
    "for example , if each voxel can have a maximum of 100 signalling molecules at a time , then there are 10@xmath201 possible @xmath15 vectors and the filtering problem has to estimate the probability @xmath202 $ ] for each possible @xmath15 vector . although there are approximation techniques to solve the bayesian filtering problem , that would introduce inaccuracies",
    ". the use of small number of voxels will allow us to compute @xmath203 $ ] precisely .",
    "for this experiment , we use @xmath170 symbols and two values of @xmath5 ( the number of receptors ) : 5 and 10 . both symbols 0 and 1 use reaction such that symbols 0 and 1 causes , respectively , 10 and 50 signalling molecules to be generated per second on average by the transmitter .",
    "the simulation time is about 1.8 seconds .",
    "we first show that @xmath149 $ ] and @xmath16 are rather similar .",
    "figure [ fig : prop : opt_mean ] shows @xmath16 and a trajectory of @xmath149 $ ] ( obtained from one realisation of @xmath11 ) are pretty similar .",
    "this result is obtained from using @xmath204 and symbol 1 .",
    "the results for other choices of @xmath5 , transmission symbols or other realisations of @xmath11 are similar .",
    "figure [ fig : prop : opt_ser ] shows the mean symbol error rates ( sers ) , for both optimal and sub - optimal demodulation filters , if the detection is done at time @xmath12 = 1 , 1.05 , 1.1 , ... , 1.8 .",
    "the sers is obtained from 400 realisations of @xmath11 .",
    "the difference in sers between the optimal and sub - optimal filter is less than 1% .",
    "we have also checked that the two demodulators make the same decoding decision on average 99.3% of the time .    in the rest of this section",
    ", we will use the sub - optimal demodulation filter because of its lower computational complexity .",
    "we consider a medium of 2@xmath9 m @xmath196 2@xmath9 m @xmath196 1 @xmath9 m .",
    "we assume a voxel size of ( @xmath197@xmath9m)@xmath198 ( i.e. @xmath199 @xmath9 m ) , creating an array of @xmath205 voxels .",
    "the transmitter and receiver are located at ( 0.5,0.8,0.5 ) and ( 1.5,0.8,0.5 ) ( in @xmath9",
    "m ) in the medium . the voxel co - ordinates are ( 2,3,2 ) and ( 5,3,2 ) respectively .",
    "we assume an absorbing boundary for the medium and the signalling molecules escape from a boundary voxel surface at a rate of @xmath206 .",
    "this configuration will be used for the rest of this section .    for this experiment ,",
    "we use @xmath170 symbols and @xmath207 receptors .",
    "both symbols 0 and 1 use reaction such that symbols 0 and 1 causes , respectively , 40 and 80 signalling molecules to be generated per second on average by the transmitter .",
    "the simulation time is about 3 seconds .",
    "figure [ fig : prop_demod_raw_u0 ] shows the demodulation filter outputs @xmath162 and @xmath161 if the transmitter sends a symbol 0 .",
    "it can be seen that @xmath208 most of the time after @xmath209 , which means the detection is likely to be correct after this time .",
    "the sawtooth like appearance of @xmath162 and @xmath161 is due to the fact that every time when a receptor is bound , there is a jump in the filter output according to equation .",
    "figure [ fig : prop_demod_raw_u1 ] shows the filter outputs @xmath162 and @xmath161 if the transmitter sends a symbol 1 ; the behaviour is similar .",
    "figure [ fig : prop_demod_mean_u0 ] shows the _",
    "filter outputs @xmath162 and @xmath161 if the transmitter sends a symbol 0 .",
    "the mean is computed over 200 realisations of @xmath11 .",
    "it can be seen that the mean filter output of @xmath162 is greater than that of @xmath161 .",
    "similarly , if symbol 1 is sent , then we expect of the mean of @xmath161 to be bigger .",
    "the figure is not shown for brevity .",
    "figure [ fig : prop_demod_mean_ser ] shows the mean sers for symbols 0 and 1 if the detection is done at time @xmath12 .",
    "the ser for symbol 1 is high initially but as more information is processed over time , the ser drops to a low value .",
    "this experiment shows that it is possible to use the analogue demodulation filter to compute a quantity that allows us to distinguish between two emission patterns at the receiver .",
    "we continue with the setting of [ sec : prop_demod ] but we vary the number of receptors between 1 and 20 .",
    "we assume the demodulator makes the decision at @xmath210 and calculate the mean ser for both symbols at @xmath210 .",
    "figure [ fig : prop_nrec ] plots the sers versus the number of receptors .",
    "it can be seen that the ser drops with increasing number of receptors .",
    "we have used @xmath170 symbols so far .",
    "we retain the current symbols 0 and 1 , and add a symbol 2 which is also of the form of reaction but its mean rate of production of signalling molecules is 3 times that of symbol 0 .",
    "the number of receptors @xmath5 used are : 1 , 10 , 20 , ... , 150 .",
    "we compute the average ser at @xmath210 assuming each symbol is transmitted with equal probability .",
    "we plot the logarithm of the average ser against @xmath211 in figure [ fig : prop_nrec_3s ] .",
    "it can be seen that the ser drops with increasing number of receptors @xmath5 .",
    "the plot in figure [ fig : prop_nrec_3s ] suggests that , when the number of receptors @xmath5 is large , the relationship between logarithm of ser and @xmath211 is linear .",
    "we perform a least - squares fit for @xmath5 between 50 and 150 .",
    "the fitted straight line is shown in figure [ fig : prop_nrec_3s ] and it has a slope of @xmath212 .",
    "a possible explanation is that , because the receptors are non - interacting , each receptor provides an independent observation .",
    "the empirical evidence suggests that the average ser scales according to @xmath213 asymptotically provided that the voxel volume can contain that many receptors .",
    "equation suggests that if the transmitter uses two sets of reactions which have almost the same mean number of signalling molecules in the receiver voxel , then it may be difficult to distinguish between these two symbols . in this study ,",
    "symbol 0 is generated by reaction with a rate of @xmath49 while symbol 1 is generated by : @xmath214_{\\rm on } &   < - >   [ rna]_{\\rm off } } \\\\",
    "\\cee { [ rna]_{\\rm on }   &   ->[2\\kappa ] [ rna]_{\\rm on } + s   }   \\label{eqn : r1 } \\end{aligned}\\ ] ] where we assume that rna can be in an on or off state , and signalling molecules @xmath0 are only produced when the rna is in the on - state .",
    "we assume that the there is an equal probability for the rna to be in the two states and the reaction rate constant for the production of signalling molecule @xmath0 from @xmath215}_{\\rm on}$ ] is @xmath216 .",
    "this means that the mean rate of production of signalling molecules @xmath0 by symbols 0 and 1 are the same .",
    "this gives rise to very similar @xmath217 and @xmath218 .",
    "figure [ fig : equal ] shows the demodulation filter outputs @xmath162 and @xmath161 for one simulation .",
    "it can be seen that the two outputs are almost indistinguishable .",
    "consequently , the ser is pretty high .",
    "this shows that symbols generated by reactions which have similar mean number of signalling molecules at the receiver voxel can be hard to distinguish .",
    "the aim of this experiment is to study the performance of the demodulator in the presence of isi .",
    "we use the decision feedback method described in section [ sec : isi ] together with the approximation decomposition in .",
    "we vary the number of receptors from 25 to 150 .",
    "we use two different memory lengths @xmath219 of 4 and 5 .",
    "if the memory length is @xmath219 , we express the mean number of output molecules at the current symbol interval as a sum of @xmath219 terms , i.e. a generalisation of to @xmath219 terms .",
    "we carry out the simulation for a duration of 20 symbol lengths and compute the average ser over 20 symbols .",
    "figure [ fig : isi ] shows the average ser versus the number of receptors .",
    "it can be seen that an increasing number of receptors can also be used to deal with isi .",
    "this paper studies a diffusion - based molecular communication network that uses different sets of chemical reactions to represent different transmission symbols . we focus on the demodulation problem .",
    "we assume the receiver uses a ligand - receptor binding process and uses the continuous history of the number of ligand - receptor complexes over time as the input signal to the demodulator .",
    "we derive the maximum a posteriori demodulator by solving a bayesian filtering problem .",
    "let @xmath10 denote the transmitted symbol , our aim is to determine @xmath138 $ ] in terms of the quantity at time @xmath12 . recalling that @xmath88 is the state of the ctmp and since only @xmath127 is observed , the problem of predicting @xmath139 from @xmath127 is a bayesian filtering or hidden markov model problem .",
    "the first step is to condition on the state of the system , as follows : @xmath141 \\\\ & =   \\sum_{i } \\mathbf{p}[n(t+\\delta t ) = \\eta_i , b(t+\\delta t ) | s , { \\cal b}(t ) ]   \\\\ & =   \\sum_{i } \\sum_{j } \\mathbf{p}[n(t+\\delta t ) = \\eta_i , b(t+\\delta t ) | s , n(t ) = \\eta_j , { \\cal b}(t ) ]   \\mathbf{p}[n(t ) = \\eta_j | s ,   { \\cal b}(t ) ]   \\label{eqn : app : int1 } \\\\ & = \\sum_{i } \\sum_{j } \\mathbf{p}[n(t+\\delta t ) = \\eta_i , b(t+\\delta t ) | s , n(t ) = \\eta_j , b(t ) ]   \\mathbf{p}[n(t ) = \\eta_j | s ,   { \\cal b}(t ) ]   \\label{eqn : app : condp}\\end{aligned}\\ ] ] where we have used the markov property @xmath220   = \\mathbf{p}[n(t+\\delta t ) = \\eta_i , b(t+\\delta t ) | s , n(t ) = \\eta_j , b(t)]$ ] to arrive at equation .",
    "we now focus on the term @xmath221 $ ] in equation .",
    "this term is the state transition probability . using the ctmp in section [ sec : model ]",
    ", we have @xmath222 \\\\ \\nonumber   =   & \\delta_{b(t+\\delta t),b(t ) + 1 } p_1 + \\delta_{b(t+\\delta t ) ,",
    "b(t ) - 1 } p_2 + \\delta_{b(t+\\delta t ) , b(t ) } p_3 \\label{eqn : app : p123 } \\end{aligned}\\ ] ] where @xmath223 where @xmath224 is the @xmath55-th element of @xmath113 , i.e. there are @xmath224 signalling molecules in the receiver voxel , and @xmath225 where @xmath226    by substituting equation into equation , we have @xmath227 = \\delta_{b(t+\\delta t ) , b(t ) + 1 } q_1 + \\delta_{b(t+\\delta t ) , b(t ) - 1 }   q_2 + \\delta_{b(t+\\delta t ) , b(t ) } q_3 \\end{aligned}\\ ] ] where @xmath228 \\end{aligned}\\ ] ]    we will now determine @xmath74 , @xmath75 and @xmath229 .    for @xmath74",
    ", we have @xmath230        \\nonumber   \\\\ & = \\lambda ( m - b(t ) )   \\ ; \\delta t   \\ ;   \\sum_{i } \\sum_{j }   \\delta_{\\eta_i , \\eta_j - \\mathbb{1}_r } \\eta_{j , r }   \\mathbf{p}[n(t ) = \\eta_j | s ,   { \\cal b}(t ) ]         \\nonumber \\\\ & =   \\lambda ( m - b(t ) )   \\ ; \\delta t   \\ ;   \\sum_{j \\ ; s.t . \\ ; \\eta_{j , r } \\geq 1 }   \\eta_{j , r }   \\mathbf{p}[n(t ) = \\eta_j | s ,   { \\cal b}(t ) ]          \\label{eqn : app : q1:1 } \\\\      & =   \\lambda ( m - b(t ) )   \\ ; \\delta t   \\ ;   \\sum_{j }   \\eta_{j , r }   \\mathbf{p}[n(t ) = \\eta_j | s ,   { \\cal b}(t ) ]          \\label{eqn : app : q1:2 } \\\\             & =   \\lambda ( m - b(t ) )   \\ ; \\delta t   \\ ;   \\mathbf{e } [ n_r(t ) | s ,   { \\cal b}(t ) ] \\end{aligned}\\ ] ]    note that in equation , the sum is over all states @xmath114 with at least one signalling molecule in the receiver voxel , i.e. @xmath231 . since the summand in equation is zero if @xmath232 , we get the same result if we are to sum over all possible states , that is why equation holds .    for @xmath75 , we have @xmath233   \\nonumber \\\\ & =   \\mu b(t ) \\ ; \\delta t \\sum_{i } \\sum_{j }   \\delta_{\\eta_i , \\eta_j + \\mathbb{1}_r } \\ ; \\mathbf{p}[n(t ) = \\eta_j | s ,   { \\cal b}(t ) ]    \\label{eqn : app : q2:1 } \\\\ & =   \\mu b(t ) \\ ; \\delta t \\sum_{j }   \\mathbf{p}[n(t ) = \\eta_j | s ,   { \\cal b}(t ) ]    \\label{eqn : app : q2:2 } \\\\ & =   \\mu b(t ) \\ ; \\delta t \\ ; \\end{aligned}\\ ] ]    note that equation follows from equation because for every @xmath113 , there is a unique @xmath114 such that @xmath234 holds .    for @xmath229 , we have @xmath235 \\nonumber \\\\    = &",
    "\\sum_{i } \\sum_{j \\neq i }   ( d_{ij } \\ ; \\delta t ) \\mathbf{p}[n(t ) = \\eta_j | s ,   { \\cal b}(t ) ] + \\nonumber \\\\ &   \\sum_{j }   ( 1 - \\lambda \\eta_{j , r } ( m - b(t ) ) \\ ; \\delta t - \\mu b(t ) \\ ; \\delta t - d_{jj } \\ ; \\delta t )   \\mathbf{p}[n(t ) = \\eta_j | s ,   { \\cal b}(t ) ]   \\nonumber \\\\",
    "=   &       \\sum_{j } ( 1 - \\lambda \\eta_{j , r } ( m - b(t ) ) \\ ; \\delta t - \\mu b(t ) \\ ; \\delta t )   \\mathbf{p}[n(t ) = \\eta_j | s ,   { \\cal b}(t ) ] + \\nonumber \\\\ &   ( \\sum_{i } \\sum_{j \\neq i } d_{ij } \\mathbf{p}[n(t ) = \\eta_j | s ,   { \\cal b}(t ) ]   - \\sum_{j } d_{jj } \\mathbf{p}[n(t ) = \\eta_j | s ,   { \\cal b}(t ) ] ) \\ ; \\delta t \\nonumber \\\\   = &   ( 1 - \\lambda ( m - b(t ) ) { \\mathbf e}[n_r(t ) | s ,   { \\cal b}(t ) ] \\ ; \\delta t - \\mu b(t )   \\ ; \\delta t ) + \\nonumber \\\\ &   \\underbrace{(\\sum_{i } \\sum_{j \\neq i } d_{ij } \\mathbf{p}[n(t ) = \\eta_j | s ,   { \\cal b}(t ) ]   - \\sum_{j } \\sum_{i \\neq j } d_{ij } \\mathbf{p}[n(t ) = \\eta_j | s ,",
    "{ \\cal b}(t)])}_{= 0 }   \\ ; \\delta t \\nonumber \\\\   = &   ( 1 - \\lambda ( m - b(t ) ) { \\mathbf e}[n_r(t ) | s ,   { \\cal b}(t ) ] \\ ; \\delta t - \\mu b(t )   \\ ; \\delta t)\\end{aligned}\\ ] ]",
    "having obtained @xmath74 , @xmath75 and @xmath229 , we arrive at : @xmath236    =   & \\delta_{b(t+\\delta t ) , b(t ) + 1 } \\lambda ( m - b(t ) )   \\ ; \\delta t   \\ ;   \\mathbf{e } [ n_r(t ) | s ,   { \\cal b}(t ) ]   +   \\nonumber \\\\    & \\delta_{b(t+\\delta t ) , b(t ) - 1 } \\mu b(t ) \\ ; \\delta t \\ ; + \\nonumber   \\\\ & \\delta_{b(t+\\delta t ) , b(t ) } ( 1 - \\lambda ( m - b(t ) ) { \\mathbf e}[n_r(t ) | s ,   { \\cal b}(t ) ] \\ ; \\delta t - \\mu b(t )   \\ ; \\delta t ) \\label{eqn : app : predictb}\\end{aligned}\\ ] ] note that equation is the same as equation in the main text .      from equation , we have : @xmath237)}{\\delta",
    "t } -   \\lim_{\\delta t \\rightarrow 0 } \\frac{\\log ( \\mathbf{p}[b(t+\\delta t ) | { \\cal b}(t)])}{\\delta t } \\label{eqn : logpp : app : prelim}\\end{aligned}\\ ] ] note that the second term on the rhs is independent of transmission symbol @xmath10 , we will focus on the first term .",
    "note that @xmath138 $ ] , which is given in equation , is a sum three terms with multipliers @xmath238 , @xmath239 and @xmath240 .",
    "since these multipliers are mutually exclusive , we have : @xmath241 \\right )   = &   \\delta_{b(t+\\delta t ) , b(t ) + 1 } \\log \\left ( \\lambda ( m - b(t ) )   \\ ; \\delta t   \\ ;   \\mathbf{e } [ n_r(t ) | s ,   { \\cal b}(t ) ]    \\right ) + \\nonumber \\\\ & \\delta_{b(t+\\delta t ) , b(t ) - 1 } \\log \\left ( \\mu b(t ) \\ ; \\delta t    \\right ) \\nonumber + \\\\ & \\delta_{b(t+\\delta t ) , b(t ) } \\log \\left ( ( 1 - \\lambda ( m - b(t ) ) { \\mathbf e}[n_r(t ) | 1 ,   { \\cal b}(t ) ] \\ ; \\delta t - \\mu b(t )   \\ ; \\delta t )    \\right )   \\label{app : logapprox }   \\\\",
    "\\approx &   \\delta_{b(t+\\delta t ) , b(t ) + 1 } \\log \\left ( \\mathbf{e } [ n_r(t ) | s ,   { \\cal b}(t ) ] \\right ) - \\nonumber \\\\   & \\delta_{b(t+\\delta t ) , b(t ) } \\lambda ( m - b(t ) ) { \\mathbf e}[n_r(t ) | s ,   { \\cal b}(t ) ] \\ ; \\delta t + \\nonumber \\\\   & \\tilde{p}(t )    \\label{eqn : app : likelihood } \\end{aligned}\\ ] ] where we have used the approximation @xmath242 in the last term of equation and have collected all terms that do not depend on @xmath10 in @xmath243 .    by substituting equation into equation , and taking limit @xmath244 ,",
    "we have @xmath245   \\right ) - \\nonumber \\\\ & \\delta_{b(t+\\delta t ) , b(t ) } \\lambda ( m - b(t ) )    \\left ( { \\mathbf e}[n_r(t ) | s ,   { \\cal b}(t ) ] ]   \\right ) + \\tilde{l}(t ) \\label{eqn : app : logmapm1 }   \\\\ = & \\frac{du(t)}{dt }   \\log \\left ( \\mathbf{e } [ n_r(t ) | s ,   { \\cal b}(t ) ]   \\right ) - \\lambda ( m - b(t ) )    \\left ( { \\mathbf e}[n_r(t ) | s ,   { \\cal b}(t ) ]   \\right ) + \\tilde{l}(t ) \\label{eqn : app : logmap}\\end{aligned}\\ ] ] where all terms that are independent of @xmath10 have been collected in @xmath147 .",
    "note that @xmath147 contains some terms that diverges but this is not an issue because for demodulation it is their relative difference @xmath246 ( for any two symbols @xmath155 and @xmath156 ) that matters .",
    "note also that we have used the following reasonings to arrive at equation from equation :    1 .",
    "the term @xmath247 is an impulse whenever a receptor changes from the unbound to the bound state .",
    "this is precisely @xmath248 .",
    "the term @xmath240 is only zero when the number of bound receptors changes and the number of such changes is finite . in other words ,",
    "@xmath249 with probability one .",
    "this allows us to drop @xmath240 .",
    "finally , note that equation is the same as equation .",
    "let @xmath10 denote the transmitted symbol , our aim is to determine @xmath138 $ ] in terms of the quantity at time @xmath12 . recalling that @xmath88 is the state of the ctmp and since only @xmath127",
    "is observed , the problem of predicting @xmath139 from @xmath127 is a bayesian filtering or hidden markov model problem .",
    "the first step is to condition on the state of the system , as follows : @xmath141 \\\\",
    "=   & \\sum_{i } \\mathbf{p}[n(t+\\delta t ) = \\eta_i , b(t+\\delta t ) | s , { \\cal b}(t ) ]   \\\\",
    "=   & \\sum_{i } \\sum_{j } \\mathbf{p}[n(t+\\delta t ) = \\eta_i , b(t+\\delta t ) | s , n(t ) = \\eta_j , { \\cal b}(t ) ] \\times \\nonumber \\\\ & \\mathbf{p}[n(t ) = \\eta_j | s ,   { \\cal b}(t ) ]   \\label{eqn : app : int1 } \\\\",
    "= &   \\sum_{i } \\sum_{j } \\mathbf{p}[n(t+\\delta t ) = \\eta_i , b(t+\\delta t ) | s , n(t ) = \\eta_j , b(t ) ] \\times \\nonumber \\\\ &   \\mathbf{p}[n(t ) = \\eta_j | s ,   { \\cal b}(t ) ]   \\label{eqn : app : condp}\\end{aligned}\\ ] ] where we have used the markov property @xmath220   = \\mathbf{p}[n(t+\\delta t ) = \\eta_i , b(t+\\delta t ) | s , n(t ) = \\eta_j , b(t)]$ ] to arrive at equation .",
    "we now focus on the term @xmath221 $ ] in equation .",
    "this term is the state transition probability .",
    "using the ctmp in section [ sec : model ] , we have @xmath222   \\nonumber   \\\\   =   & \\delta_{b(t+\\delta t ) , b(t ) + 1 } p_1 + \\delta_{b(t+\\delta t ) ,",
    "b(t ) - 1 } p_2 +   \\nonumber   \\\\   &   \\delta_{b(t+\\delta t),b(t ) } p_3 \\label{eqn : app : p123 } \\end{aligned}\\ ] ] where @xmath250 where @xmath224 is the @xmath55-th element of @xmath113 , i.e. there are @xmath224 signalling molecules in the receiver voxel , and @xmath251 where @xmath226    by substituting equation into equation , we have @xmath141 = \\nonumber \\\\ & \\delta_{b(t+\\delta t ) , b(t ) + 1 } q_1 + \\delta_{b(t+\\delta t ) , b(t ) - 1 }   q_2 + \\nonumber \\\\ & \\delta_{b(t+\\delta t ) , b(t ) } q_3 \\end{aligned}\\ ] ] where @xmath228 \\end{aligned}\\ ] ]    we will now determine @xmath74 , @xmath75 and @xmath229 .    for @xmath74 , we have @xmath252        \\nonumber   \\\\ = & \\lambda ( m - b(t ) )   \\ ; \\delta t   \\ ;   \\ ; \\times   \\nonumber \\\\    &   \\sum_{i } \\sum_{j }   \\delta_{\\eta_i , \\eta_j - \\mathbb{1}_r } \\eta_{j , r }   \\mathbf{p}[n(t ) = \\eta_j | s ,   { \\cal b}(t ) ]         \\nonumber \\\\   = & \\lambda ( m - b(t ) )   \\ ; \\delta t   \\ ;   \\sum_{j \\ ; s.t . \\ ; \\eta_{j , r } \\geq 1 }   \\eta_{j , r }   \\mathbf{p}[n(t ) = \\eta_j | s ,   { \\cal b}(t ) ]          \\label{eqn : app : q1:1 } \\\\       =   & \\lambda ( m - b(t ) )   \\ ; \\delta t   \\ ;   \\sum_{j }   \\eta_{j , r }   \\mathbf{p}[n(t ) = \\eta_j | s ,   { \\cal b}(t ) ]          \\label{eqn : app : q1:2 } \\\\              =   & \\lambda ( m - b(t ) )   \\ ; \\delta t   \\ ;   \\mathbf{e } [ n_r(t ) | s ,   { \\cal b}(t ) ] \\end{aligned}\\ ] ] note that in equation , the sum is over all states @xmath114 with at least one signalling molecule in the receiver voxel , i.e. @xmath231 . since the summand in equation is zero if @xmath232 , we get the same result if we are to sum over all possible states , that is why equation holds .    for @xmath75",
    ", we have @xmath233   \\nonumber \\\\ & =   \\mu b(t ) \\ ;",
    "\\delta t \\sum_{i } \\sum_{j }   \\delta_{\\eta_i , \\eta_j + \\mathbb{1}_r } \\ ; \\mathbf{p}[n(t ) = \\eta_j | s ,   { \\cal b}(t ) ]    \\label{eqn : app : q2:1 } \\\\ & =   \\mu b(t ) \\ ; \\delta t \\sum_{j }   \\mathbf{p}[n(t ) = \\eta_j | s ,   { \\cal b}(t ) ]    \\label{eqn : app : q2:2 } \\\\ & =   \\mu b(t ) \\ ; \\delta t \\ ; \\end{aligned}\\ ] ] note that equation follows from equation because for every @xmath113 , there is a unique @xmath114 such that @xmath234 holds .    for @xmath229 , we have @xmath253 \\nonumber \\\\    = &",
    "\\sum_{i } \\sum_{j \\neq i }   ( d_{ij } \\ ; \\delta t ) \\mathbf{p}[n(t ) = \\eta_j | s ,   { \\cal b}(t ) ] + \\nonumber \\\\ &   \\sum_{j }   ( 1 - \\lambda \\eta_{j , r } ( m - b(t ) ) \\ ; \\delta t - \\mu b(t ) \\ ; \\delta t - d_{jj } \\ ; \\delta t ) \\times \\nonumber \\\\   & \\mathbf{p}[n(t ) = \\eta_j | s ,   { \\cal b}(t ) ]   \\nonumber \\\\",
    "=   &       \\sum_{j } ( 1 - \\lambda \\eta_{j , r } ( m - b(t ) ) \\ ; \\delta t - \\mu b(t ) \\ ; \\delta t )           \\mathbf{p}[n(t ) = \\eta_j | s ,   { \\cal b}(t ) ] + \\nonumber \\\\ &   ( \\sum_{i } \\sum_{j \\neq i } d_{ij } \\mathbf{p}[n(t ) = \\eta_j | s ,   { \\cal b}(t ) ]   - \\sum_{j } d_{jj } \\mathbf{p}[n(t ) = \\eta_j | s ,   { \\cal b}(t ) ] ) \\ ; \\delta t \\nonumber \\\\   = &   ( 1 - \\lambda ( m - b(t ) ) { \\mathbf e}[n_r(t ) | s ,   { \\cal b}(t ) ] \\ ; \\delta t - \\mu b(t )   \\ ; \\delta t ) + ( \\delta t ) \\ ;   \\times \\nonumber \\\\ &   \\underbrace{(\\sum_{i } \\sum_{j \\neq i } d_{ij } \\mathbf{p}[n(t ) = \\eta_j | s ,   { \\cal b}(t ) ]   - \\sum_{j } \\sum_{i \\neq j } d_{ij } \\mathbf{p}[n(t ) = \\eta_j | s ,   { \\cal b}(t)])}_{= 0 }    \\nonumber \\\\   = &   ( 1 - \\lambda ( m - b(t ) ) { \\mathbf e}[n_r(t ) | s ,   { \\cal b}(t ) ] \\ ; \\delta t - \\mu b(t )   \\ ; \\delta t)\\end{aligned}\\ ] ] having obtained @xmath74 , @xmath75 and @xmath229 , we arrive at : @xmath254 \\nonumber \\\\    =   & \\delta_{b(t+\\delta t ) , b(t ) + 1 } \\lambda ( m - b(t ) )   \\ ; \\delta t   \\ ;   \\mathbf{e } [ n_r(t ) | s ,   { \\cal b}(t ) ]     \\nonumber \\\\    & + \\delta_{b(t+\\delta t ) , b(t ) - 1 } \\mu b(t ) \\ ; \\delta t \\ ; + \\nonumber   \\\\ & \\delta_{b(t+\\delta t ) , b(t ) } \\times \\nonumber \\\\   & ( 1 - \\lambda ( m - b(t ) ) { \\mathbf e}[n_r(t ) | s ,   { \\cal b}(t ) ] \\ ; \\delta t - \\mu b(t )   \\ ; \\delta t ) \\label{eqn : app : predictb}\\end{aligned}\\ ] ] note that equation is the same as equation in the main text .      from equation",
    ", we have : @xmath255)}{\\delta t } - \\nonumber \\\\ & \\lim_{\\delta t \\rightarrow 0 } \\frac{\\log ( \\mathbf{p}[b(t+\\delta t ) | { \\cal b}(t)])}{\\delta t } \\label{eqn : logpp : app : prelim}\\end{aligned}\\ ] ] note that the second term on the rhs is independent of transmission symbol @xmath10 , we will focus on the first term .",
    "note that @xmath138 $ ] , which is given in equation , is a sum three terms with multipliers @xmath238 , @xmath239 and @xmath240 .",
    "since these multipliers are mutually exclusive , we have : @xmath256 \\right )   \\nonumber   \\\\ = &    \\delta_{b(t+\\delta t ) , b(t ) + 1 } \\times \\nonumber \\\\   & \\log \\left ( \\lambda ( m - b(t ) )   \\ ; \\delta t   \\ ;   \\mathbf{e } [ n_r(t ) | s ,   { \\cal b}(t ) ]    \\right ) + \\nonumber \\\\ & \\delta_{b(t+\\delta t ) , b(t ) - 1 } \\log \\left ( \\mu b(t ) \\ ; \\delta t    \\right ) \\nonumber + \\\\ & \\delta_{b(t+\\delta t ) , b(t ) } \\times \\nonumber \\\\   & \\log \\left ( ( 1 - \\lambda ( m - b(t ) ) { \\mathbf e}[n_r(t ) | 1 ,   { \\cal b}(t ) ] \\ ; \\delta t - \\mu b(t )   \\ ; \\delta t )    \\right )   \\label{app : logapprox }   \\\\",
    "\\approx &   \\delta_{b(t+\\delta t ) , b(t ) + 1 } \\log \\left ( \\mathbf{e } [ n_r(t ) | s ,   { \\cal b}(t ) ] \\right ) - \\nonumber \\\\   & \\delta_{b(t+\\delta t ) , b(t ) } \\lambda ( m - b(t ) ) { \\mathbf e}[n_r(t ) | s ,   { \\cal b}(t ) ] \\ ; \\delta t + \\nonumber \\\\   & \\tilde{p}(t )    \\label{eqn : app : likelihood } \\end{aligned}\\ ] ] where we have used the approximation @xmath242 in the last term of equation and have collected all terms that do not depend on @xmath10 in @xmath243 .    by substituting equation into equation , and taking limit @xmath244 , we have @xmath257   \\right ) - \\nonumber \\\\ & \\delta_{b(t+\\delta t ) , b(t ) } \\lambda ( m - b(t ) )    \\left ( { \\mathbf e}[n_r(t ) | s ,   { \\cal b}(t ) ] ]   \\right ) + \\tilde{l}(t ) \\label{eqn : app : logmapm1 }   \\\\ = & \\frac{du(t)}{dt }   \\log \\left ( \\mathbf{e } [ n_r(t ) | s ,   { \\cal b}(t ) ]   \\right ) -    \\nonumber \\\\ & \\lambda ( m - b(t ) )    \\left ( { \\mathbf e}[n_r(t ) | s ,   { \\cal b}(t ) ]   \\right ) + \\tilde{l}(t ) \\label{eqn : app : logmap}\\end{aligned}\\ ] ] where all terms that are independent of @xmath10 have been collected in @xmath147 .",
    "note that @xmath147 contains some terms that diverges but this is not an issue because for demodulation it is their relative difference @xmath246 ( for any two symbols @xmath155 and @xmath156 ) that matters .",
    "note also that we have used the following reasonings to arrive at equation from equation :    1 .",
    "the term @xmath258 is an impulse whenever a receptor changes from the unbind to the bind state .",
    "this is precisely @xmath248 .",
    "the term @xmath259 is only zero when the number of bound receptors changes and the number of such changes is finite . in other words ,",
    "@xmath260 with probability one .",
    "this allows us to drop @xmath261 .",
    "finally , note that equation is the same as equation .",
    "for this example , we assume the transmission medium consists of 3 voxels as illustrated in figure [ fig : small ] . the transmitter and receiver are assumed to be located in , respectively , voxels 1 and 3 .",
    "we assume reflecting boundary condition which means the signalling molecules can not leave the medium .",
    "this appendix presents an example end - to - end model . for this end - to - end model ,",
    "the transmitter is assumed to send symbol 0 which means it uses the set of chemical reactions corresponding to this symbol .",
    "we therefore view a transmitter as a set of chemical reactions located within the transmitter voxel .",
    "it is still an open problem what chemical reactions are good for communication performance .",
    "the example being used here is not meant to promote the use of a particular set of chemical reactions but our purpose is to show how a set of chemical reactions can be modelled by a ctmp .    for this example",
    ", we assume that the production of the signalling molecules @xmath0 requires two intermediate chemical species @xmath262 and @xmath263 , which are produced by rna@xmath264 and rna@xmath265 .",
    "there are four reactions and they are assumed to take place within the transmitter voxel only .",
    "the four chemical reactions are : @xmath266 rna_1 + f }   \\label{cr : t : r1 }   \\\\ \\cee { rna_2 & ->[k_2 ] rna_2 + g }   \\label{cr : t : r2 }   \\\\ \\cee { f   & ->[k_3 ] s }   \\label{cr : t : r3 }    \\\\ \\cee { s + g &   ->[k_4 ] \\phi }   \\label{cr : t : r4}\\end{aligned}\\ ] ] reaction says that the molecules of @xmath262 are produced at a mean rate of @xmath267 .",
    "similarly , according to reaction , @xmath263 is produced at a mean rate of @xmath268 .",
    "reaction says that @xmath262 is converted to @xmath0 at a mean rate equals to @xmath269 times the number of @xmath262 molecules in the transmitter voxel .",
    "reaction says that @xmath0 and @xmath263 can react to produce a molecule @xmath270 that we are not interested to keep track of in the mathematical model .",
    "if an @xmath0 ( or a @xmath263 ) molecule takes part in reaction , we can consider this @xmath0 ( @xmath263 ) molecule has left the system permanently after the reaction .",
    "the rate of reaction is @xmath271 times the number of @xmath263 molecules and the number of signalling molecules @xmath0 in the transmitter voxel .",
    "we assume that the chemical species rna@xmath264 , rna@xmath265 , @xmath262 and @xmath263 are found in the transmitter voxel only , and they can not leave the transmitter voxel .",
    "this means that we do not need to consider the diffusion of these chemical species .",
    "the only diffusible chemical species in the entire system is the signalling molecule @xmath0 .",
    "we also assume that there is only one of each rna@xmath264 and rna@xmath265 and their counts remain constant .    in order to define the state of the system , we make the following definitions : @xmath13 is the number of signalling molecules in voxel @xmath14 at time @xmath12 , @xmath272 and @xmath273 are respectively the number of @xmath262 and @xmath263 molecules at time @xmath12 , @xmath79 is the cumulative number of molecules that have left the system at time @xmath12 and @xmath11 is the number of complexes ( or bound receptors ) at time @xmath12 .",
    "since a receptor can either be unbound or in a complex , the number of unbound receptors at time @xmath12 is @xmath87 ; therefore , the mathematical model only has to keep track of either the number of unbound receptors or the number of complexes , and we have chosen to keep track of the latter .",
    "the state of the system is completely specified by these seven molecular counts : @xmath274 and @xmath11 .",
    "all the molecular counts should be non - negative integers ( i.e. belonging to the set @xmath275 ) and a further restriction is that @xmath276 or we write @xmath277}$ ] .",
    "we define the vector @xmath15 as @xmath278^t \\label{eqn : ex : state}\\end{aligned}\\ ] ] where the superscript @xmath279 is used to denote matrix transpose . based on the definition of @xmath15 , the state of the system",
    "is the tuple @xmath88 and a valid state must be an element of the set @xmath280}$ ] .",
    "the state of the system changes when a reaction or diffusion event occurs .",
    "our modelling assumptions mean that reactions can only take place in the transmitter or the receiver voxels .",
    "the reactions in the transmitter voxel are @xmath281 .",
    "the reactions taking place in the receiver voxel are and .",
    "the only diffusible chemical species in this system is the signalling molecule @xmath0 . within an infinitesimal time @xmath37 , * at most one * diffusion or",
    "reaction event can occur .",
    "therefore , the dynamics of the system can be specified by the transition probability from state @xmath88 to @xmath282 .",
    "we will now specify these transition probabilities and we begin with the transmitter .    four possible reaction events  can take place in the transmitter voxel .",
    "an occurrence of reaction increases the number of @xmath262 molecules in the transmitter voxel by 1 and this occurs at a mean rate of @xmath267 . by defining @xmath95 to be the standard basis vector with a ` 1 ' at the @xmath14-th position ,",
    "we can write the state transition probability due to reaction as : @xmath283 = k_1 \\ ; \\delta t } \\label{eqn : ex : t1}\\end{aligned}\\ ] ] note that we have used @xmath284 because @xmath272 is increased by 1 if reaction occurs and @xmath272 is the fourth element of @xmath15 in the definition of @xmath15 in .",
    "the right - hand side ( rhs ) of equation is the transition probability that reaction occurs in @xmath91 , which is given by the reaction rate @xmath267 times @xmath37 .",
    "we can write the transition probabilities due to reactions @xmath281 as : @xmath285    & = k_2 \\ ; \\delta t   \\label{eqn : ex : t2 } \\\\   { \\bf p}[n(t+\\delta t ) = n(t)-\\mathbb{1}_4+\\mathbb{1}_1 ,",
    "b(t+\\delta t ) = b(t ) | n(t ) , b(t ) ]    & = k_3 \\ ; n_f(t ) \\ ; \\delta t \\label{eqn : ex : t3 } \\\\",
    "{ \\bf p}[n(t+\\delta t ) = n(t)-\\mathbb{1}_5-\\mathbb{1}_1 + 2\\mathbb{1}_6 , b(t+\\delta t ) = b(t ) | n(t ) , b(t ) ]   & = k_4 \\ ; n_g(t ) \\ ; n_1(t ) \\delta t \\label{eqn : ex : t4 } \\end{aligned}\\ ] ] the rationale behind equation is similar to that of .",
    "equation models reaction .",
    "if reaction occurs , an @xmath262 molecule is converted to an @xmath0 molecule , so the number of @xmath262 molecules @xmath272 ( which is the fourth element of @xmath15 ) is decreased by 1 and the number of signalling molecule in the transmitter voxel @xmath286 ( which is the first element of @xmath15 ) is increased by 1 ; this change in the number of molecules as a result of reaction can be written as @xmath287 in .",
    "equation models reaction . when reaction occurs , a @xmath263 and an @xmath0 molecule in the transmitter are consumed , hence @xmath288 in .",
    "we are not interested to keep track of the molecules as a result of this reaction , we consider these two molecules have left the system permanently and add ` 2 ' to @xmath79 which is at the sixth position of @xmath15 .",
    "the letter ` a ' here comes from absorbing because once a molecule is added to @xmath79 , it will not leave .",
    "note that the rhss of  show the transition probabilities and they are of the form of the transition rate times @xmath37 .",
    "the state of the system can also be changed by signalling molecules diffusing from one voxel to another .",
    "for this example , there are four possible diffusion events , which take place when a signalling molecule diffuses from a voxel to its neighbouring voxel .",
    "the four diffusion events are : from voxel 1 to voxel 2 , from voxel 2 to voxel 1 , from voxel 2 to voxel 3 , and from voxel 3 to voxel 2 .",
    "the transition probabilities of these four events are : @xmath289   & = d \\ ; n_1(t ) \\ ; \\delta t \\label{eqn : ex : d1 } \\\\   { \\bf p}[n(t+\\delta t ) = n(t)+\\mathbb{1}_1-\\mathbb{1}_2 , b(t+\\delta t ) = b(t ) | n(t ) , b(t ) ]    & = d \\ ; n_2(t ) \\ ; \\delta t \\label{eqn : ex : d2 } \\\\   { \\bf p}[n(t+\\delta t ) = n(t)-\\mathbb{1}_2+\\mathbb{1}_3 ,",
    "b(t+\\delta t ) = b(t ) | n(t ) , b(t ) ]   & = d \\ ; n_2(t ) \\ ; \\delta t \\label{eqn : ex : d3 } \\\\",
    "{ \\bf p}[n(t+\\delta t ) = n(t)+\\mathbb{1}_2-\\mathbb{1}_3 , b(t+\\delta t ) = b(t ) | n(t ) , b(t ) ]    & = d \\ ; n_3(t ) \\ ; \\delta t \\label{eqn : ex : d4 } \\end{aligned}\\ ] ] equation is the probability that a signalling molecules diffuses from voxel 1 to voxel 2 .",
    "the occurrence of this event means the number of signalling molecules in voxel 1 ( @xmath290 , which is the first element of @xmath15 ) is decreased by 1 while the number of signalling molecules in voxel 2 ( @xmath291 , which is the second element of @xmath15 ) is increased by 1 .",
    "the probability of this occurring is @xmath38 .",
    "the explanation for the other three transition probabilities are similar .",
    "the last category of state transitions occurs when a receptor is bound or unbound according to chemical reactions and .",
    "the state transition probabilities are : @xmath292     & = \\lambda \\ ; n_3(t ) \\ ; ( m - b(t ) ) \\ ; \\delta t \\label{eqn : ex : r1 } \\\\",
    "{ \\bf p}[n(t+\\delta t ) = n(t)+\\mathbb{1}_3 , b(t+\\delta t ) = b(t ) - 1 | n(t ) , b(t ) ]    & = \\mu \\ ; b(t ) \\ ; \\delta t \\label{eqn : ex : r2 } \\end{aligned}\\ ] ] equation is the transition probability for receptor binding or the formation of new complex .",
    "this event occurs when a signalling molecule in the receiver voxel reacts with a unbound receptor to form a complex . as a result of this reaction ,",
    "the number of signalling molecules in the receiver voxel ( which is voxel 3 in this example ) is decreased by 1 and the number of complexes @xmath11 is increased by 1 .",
    "the rate of this event is proportional to the product of the number of signalling molecules in the receiver voxel @xmath293 and the number of unbound receptors @xmath160 .",
    "equation is the transition probability for a receptor to unbind .",
    "the unbinding reaction causes the number of signalling molecules in the receiver voxel @xmath293 to increase by 1 while the number of complexes @xmath11 to decrease by 1 .",
    "the rate of this reaction is proportional to number of complexes @xmath11 .",
    "equations to give the transition probabilities of the possible events that can occur when the state of the system is @xmath88 .",
    "it is possible that no transitions occurs in the time interval @xmath91 , the probability of this occurring is given by the complementary to that of an event occurring , that is , one minus the sum of the rhss of equations to .",
    "this completes the model .",
    "in section [ sec : map ] , we propose to replace @xmath149 $ ] by @xmath150 $ ] .",
    "the difference between these two quantities is hard to compute because ligand - receptor binding is a non - linear process . in this appendix",
    ", we will provide some justification of this replacement by considering the filtering problem of lti systems .",
    "consider the following continuous - time lti system in state space form @xcite : @xmath294 where ( 1 ) @xmath295 , @xmath41 and @xmath296 are , respectively , the state , input and output vectors ; ( 2 ) @xmath297 is the state noise vector and @xmath298 is the measurement noise vector , where both vectors are zero - mean gaussian white noise ; and ( 3 ) @xmath299 is a state space quadruple .",
    "we assume the dimensions of the vectors and matrices are compatible .",
    "the subscript @xmath10 in @xmath41 plays the same role as the symbol @xmath10 in the main text .",
    "we can use different @xmath10 to choose different input @xmath41 .",
    "we can determine the mean state vector @xmath300 $ ] by taking expectation on both sides of equation to obtain : @xmath301}{dt } = & a { \\mathbf e}[x(t ) ] + b u_s(t ) \\end{aligned}\\ ] ] note that @xmath300 $ ] plays the same role as @xmath150 $ ] .",
    "the filtering problem for a lti system is to estimate the state vector @xmath295 from the continuous history of the output @xmath296 .",
    "a method to realise filtering is to use an observer @xcite : @xmath302 where @xmath39 is the observer gain matrix .",
    "the vector @xmath303 is the estimated state vector from the past history of the output @xmath296 .",
    "the expectation of @xmath303 , i.e. @xmath304 $ ] , plays the same role as @xmath149 $ ] .",
    "we are interested to study the difference @xmath305 - { \\mathbf e}[x(t)]$ ] . by using equations , , and",
    ", it can be shown that @xmath306 obeys the differential equation @xmath307 this means that if the matrix @xmath308 is asymptotically stable , then the difference @xmath306 tends to zero for sufficiently large @xmath12 .",
    "this result suggests that the difference between @xmath149 $ ] and @xmath16 can be small if the filtering error is stable ."
  ],
  "abstract_text": [
    "<S> in a diffusion - based molecular communication network , transmitters and receivers communicate by using signalling molecules ( or ligands ) in a fluid medium . </S>",
    "<S> this paper assumes that the transmitter uses different chemical reactions to generate different emission patterns of signalling molecules to represent different transmission symbols , and the receiver consists of receptors . </S>",
    "<S> when the signalling molecules arrive at the receiver , they may react with the receptors to form ligand - receptor complexes . </S>",
    "<S> our goal is to study the demodulation in this setup assuming that the transmitter and receiver are synchronised . </S>",
    "<S> we derive an optimal demodulator using the continuous history of the number of complexes at the receiver as the input to the demodulator . </S>",
    "<S> we do that by first deriving a communication model which includes the chemical reactions in the transmitter , diffusion in the transmission medium and the ligand - receptor process in the receiver . </S>",
    "<S> this model , which takes the form of a continuous - time markov process , captures the noise in the receiver signal due to the stochastic nature of chemical reactions and diffusion . </S>",
    "<S> we then adopt a maximum a posteriori framework and use bayesian filtering to derive the optimal demodulator . </S>",
    "<S> we use numerical examples to illustrate the properties of this optimal demodulator .    </S>",
    "<S> * keywords : * molecular communication networks ; modulation ; demodulation ; maximum a posteriori ; optimal detection ; stochastic models ; bayesian filtering ; molecular receivers . </S>"
  ]
}