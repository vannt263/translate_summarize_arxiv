{
  "article_text": [
    "as introduced in the main text , we use rf induced evaporation on magnetically trapped @xmath2rb atoms to reach the bec .",
    "the magnetic trap is provided by the chip structures and , before its loading , we perform optical pumping in the @xmath92 magnetic sublevel .",
    "this condensation scheme imply that the initial state of the condensate is the @xmath93 state , so as initial condition every state preparation pulse uses a system in that pure state .",
    "after the bec creation we let expand the atomic cloud in the homogeneous magnetic field for @xmath94 ms and then , using a programmable function generator , we apply to a wire on the chip the signal @xmath95 $ ] , which build up the driving field . in the frequency range @xmath96",
    "$ ] hz in which we constrain @xmath13 the radiation efficiency of the used wire can be considered constant , so the amplitude @xmath97 of the signal can be determined with high accuracy by performing a series of atomic population oscillation to have a rabi frequency @xmath98 khz .    to calibrate the homogeneous magnetic field applied by the helmholtz coils",
    ", we close a multi - state atom interferometer with constant amplitude pulses as in @xcite from which we deduce the right current to apply to the coils to produce the value @xmath99 . to compensate for very slow variations of the magnetic field",
    "we repeat the calibration procedure before the sequence of ten measurements of a given state preparation pulse .    from a statistical analysis of the interferometer output",
    "we also derive information on the residual noise present in the field .",
    "in particular , by the reduction of the fringe contrast we deduce the dephasing rate interval @xmath100 $ ] , while by the variations of the fringe phase we can estimate the amount of shot - to - shot offset field fluctuations , to @xmath54 mg . introducing these parameters in the theoretical model it is possible to derive also a maximal theoretical error by taking the worst and the best output of the model evolution .",
    "those errors are reported in table [ table2 ] .    to observe the evolution during the optimization pulse ,",
    "we splice it in subpulses , measuring the output at the end of each of them .",
    "figure [ si_fig1 ] shows an example of experimental points and theoretical prediction , reported in solid line , relative to the five population @xmath101 driven from the initial state to the ground state of the hamiltonian @xmath58 with @xmath89 being the harmonic potential that oscillates at @xmath102 khz . the optimized preparation pulse is @xmath103 long and ,",
    "after the preparation , we keep the frequency of the potential at the constant target value .",
    "the stability of the populations shows that the system is really in the target state , with the right coherence between the @xmath104 components .     for the preparation of the ground state and the excited state of the hamiltonian @xmath58 with @xmath89 being the harmonic potential that oscillates at @xmath90 khz . the optimally shaped pulse ( gray area )",
    "is followed by a constant one for @xmath91.,scaledwidth=48.0% ]    finally we show in fig .",
    "[ si_fig2 ] the optimal pulses for the preparation of the ground and excited states as in fig .",
    "[ si_fig1 ] .",
    "similar pulses ( with @xmath105 ) have been obtained as a result of our optimization scheme to prepare the other states discussed in the main text .",
    "s. hoyer , f. caruso , s. montangero , m. sarovar , t. calarco , m.b .",
    "plenio and k.b .",
    "whaley , new j. phys .",
    "* 16 * , 045007 ( 2014 ) , special issue article in focus on coherent control of complex quantum systems .              the value of the field @xmath106 is chosen around @xmath107 so that it is much larger than the magnetic noise fluctuations but , at the same time , the current used to produce it is not high enough to cause significant heating of the coils ."
  ],
  "abstract_text": [
    "<S> atom chips provide compact and robust platforms towards practical quantum technologies . </S>",
    "<S> a quick and faithful preparation of arbitrary input states for these systems is crucial but represents a very challenging experimental task . </S>",
    "<S> this is especially difficult when the dynamical evolution is noisy and unavoidable setup imperfections have to be considered . here </S>",
    "<S> , we experimentally prepare with very high small errors different internal states of a rubidium bose - einstein condensate realized on an atom chip . as a possible application of our scheme </S>",
    "<S> , we apply it to improve the sensitivity of an atomic interferometer .    </S>",
    "<S> microscopic magnetic traps , as atom chips @xcite , represent an important advance in the field of degenerate quantum gases towards their realization of practical quantum technological devices . </S>",
    "<S> indeed , applications outside the laboratory depend on the compactness and robustness of these setups . </S>",
    "<S> atom chips have already enabled , for instance , the demonstration of miniaturized interferometers @xcite , or the creation of squeezed atomic states @xcite . </S>",
    "<S> very recently , they have been also applied to the realization of atom interferometers based on non - classical motional states @xcite . </S>",
    "<S> furthermore , atom chips can be integrated with nanostructures @xcite , or photonic components @xcite , to implement new quantum information processing tools , or used as novel platforms for quantum simulations @xcite and controllable coherent dynamics @xcite .    as in most quantum technological applications , </S>",
    "<S> the ability to quickly and faithfully prepare arbitrary input states is of utmost importance . in particular , it is essential to speedup the initialization protocol of these quantum devices in order to reduce the effects of the inevitably present noise and decoherence sources . in this context , </S>",
    "<S> quantum optimal control provides powerful tools to tackle this problem by finding the optimal way to transform the system from an experimentally readily prepared initial condition to a desired state with high fidelity from which further quantum manipulations can be performed @xcite . </S>",
    "<S> it has been successfully implemented in several physical systems , ranging from cold atoms @xcite to molecules @xcite . </S>",
    "<S> recently optimal control algorithms have been developed and successfully applied to many - body quantum systems @xcite .    </S>",
    "<S> in addition , optimal control allows one to speed up the state preparation process up to the ultimate bound imposed by quantum mechanics , the so - called quantum speed limit ( qsl ) @xcite . </S>",
    "<S> indeed , the change of a state into a different one can not occur faster than a time scale that is inversely proportional to the associated energy scale . </S>",
    "<S> this is especially relevant for quantum systems like bose - einstein condensates ( becs ) where it is crucial to perform some desired ( coherent ) task before dephasing processes unavoidably occur @xcite .     and </S>",
    "<S> then halved in the levels @xmath0 and @xmath1 via optimal control . </S>",
    "<S> , scaledwidth=49.0% ]    in this work we present experimental results obtained on a rubidium ( @xmath2rb ) bec , trapped on an atom chip , evolving in a five - level hilbert space given by the five spin orientations of the @xmath3 hyperfine ground states  see fig .  </S>",
    "<S> [ fig1 ] . </S>",
    "<S> we use optimal control theory to design frequency modulated radio - frequency ( rf ) pulses that , starting from a given initial state fixed by the bec evaporation procedure , prepare different arbitrary coherent superpositions of states with high precision . </S>",
    "<S> we also show how the latter scales with the preparation time , with a highly satisfactory agreement between theory and experiment . </S>",
    "<S> we apply , finally , this technique to improve the sensitivity of an atom interferometer .    </S>",
    "<S> [ [ model ] ] model : + + + + + +    in the presence of a magnetic field the degeneracy between the spin orientations of an atomic hyperfine state is lifted . </S>",
    "<S> the phenomenon is described by the breit - rabi formula which determines the energies of all different sublevels . </S>",
    "<S> for the five fold @xmath4 hyperfine ground state of @xmath2rb in the presence of a constant magnetic bias field arbitrarily set to @xmath5 @xcite , the atomic part of the hamiltonian is @xmath6 , where the state basis is chosen to go from @xmath7 to @xmath8 and the energy values have been shifted to set @xmath9 . under the effect of an rf field it is convenient to write the evolution of this system in the rotating wave approximation ( rwa ) . </S>",
    "<S> let us define the terms @xmath10 and @xmath11 where @xmath12 $ ] describes the energy differences between the five @xmath3 levels within the rwa , @xmath13 is the time dependent frequency of the coupling field that will be modulated in order to implement our optimal control scheme.the rabi frequency @xmath14 is proportional to the rf field intensity and , in all our experiments , we set @xmath15 . </S>",
    "<S> hence , the driving field hamiltonian is @xmath16 .    in order to include the unavoidable presence of dephasing noise , mainly originated in our experiment by the presence of environmental magnetic noise superimposed on the bias field </S>",
    "<S> , we also add in our model a lindblad super - operator term @xmath17 , acting on the density matrix @xmath18 as @xmath19 $ ] , which randomizes the phase of each sublevel @xmath20 with a rate @xmath21 . for simplicity </S>",
    "<S> , we assume the same dephasing rate for all five sublevels , i.e. @xmath22 . the time evolution of the density matrix is then given by @xmath23 + { \\cal l}(\\rho(t ) ) \\ ; . \\label{eqn : l}\\ ] ]    [ [ optimal - control ] ] optimal control : + + + + + + + + + + + + + + + +    here , we use a recently introduced versatile and efficient optimization algorithm ( crab )  @xcite for the time dependence @xmath24 with @xmath25 , @xmath26 being the number of frequencies , @xmath27 complex numbers , and @xmath28 the time duration of the modulation . </S>",
    "<S> the optimization is reflected in the modulation of the field s frequency @xmath13 , which we constrain within the range @xmath29 $ ] khz in order to keep the rabi frequency @xmath14 constant ( see supplementary information for further details ) . </S>",
    "<S> the optimization of the control parameters ( @xmath27 ) in @xmath30 is done by means of the subplex variant of the nelder - mead algorithm  @xcite . </S>",
    "<S> the error function to be minimized is @xmath31 , with @xmath32 being the final population ( after time @xmath28 , i.e. at the end of the pulse ) of the sublevel @xmath33 , while @xmath34 are the corresponding target populations we want to achieve . </S>",
    "<S> the initial state @xmath35 is given by all population in the energy level @xmath36 , i.e. @xmath37 . </S>",
    "<S> in the left half of tab . </S>",
    "<S> [ table2 ] , we show the target populations of different target states ( a@xmath38i ) . </S>",
    "<S> note that there are no constraints on the coherence terms ( i.e. , the off - diagonal elements @xmath39 ) , which are however relevant in the context of quantum state preparation . </S>",
    "<S> even if state tomography would have been in principle possible @xcite , it would have been hard to perform it for all cases studied here . for this reason , in the experiment we measure only the populations of the five levels , while in the numerical simulations we take into account the full density matrix during the optimization . </S>",
    "<S> however , we have strong experimental evidence that the coherence terms ( i.e. relative phases ) are also prepared according to our theoretical predictions , because : 1 ) as shown in the fine details of the inset of fig . </S>",
    "<S> [ evolution ] , there is a very good agreement between theory and experiment in the population dynamical evolution , 2 ) when we prepare eigenstates of the hamiltonian ( see fig . </S>",
    "<S> [ hamilchange ] and in the supplementary information fig . </S>",
    "<S> [ si_fig2 ] ) , they do not evolve anymore , as expected if the hamiltonian is kept fixed , 3 ) finally , we consider a multi - state interferometer and our theoretical results are reproduced very well by the experimental data . </S>",
    "<S> these three tests would have failed if all the relative phases had not been prepared as in the target quantum state that is considered in the numerical optimization protocol .    </S>",
    "<S> [ [ experimental - setup ] ] experimental setup : + + + + + + + + + + + + + + + + + + +    we have implemented experimentally the optimal control protocols on a bec of @xmath2rb atoms produced in a magnetic micro - trap realized on an atom chip . </S>",
    "<S> the trap has a longitudinal frequency of @xmath40 while the radial trapping frequency is @xmath41 . </S>",
    "<S> the atoms are evaporated to quantum degeneracy by ramping down the frequency of a radio frequency ( rf ) field . </S>",
    "<S> the bec has typically @xmath42 atoms , at a critical temperature of @xmath43 and is @xmath44 from the chip surface . </S>",
    "<S> the magnetic fields for the micro - trap are provided by a z - shaped wire on the atom chip and an external pair of helmholtz coils . </S>",
    "<S> the rf fields for evaporation and manipulation of the zeeman states are produced by two additional conductors also integrated on the atom chip . </S>",
    "<S> finally the homogeneous bias field that lifts the degeneracy between the spin orientations is created by two further external helmholtz coils @xcite .    </S>",
    "<S> all manipulations are performed @xmath45 after turning off the magnetic trap to guarantee bias field homogeneity and strongly reduce the effects of atomic collisions that can produce decoherence . in this way </S>",
    "<S> the most relevant source of noise on the evolution turns out to be the instability of the environmental magnetic field , which has a spectrum distribution made of several peaks on a decreasing envelope in the low frequency range . to record the number of atoms in each of the @xmath46 states of the @xmath3 hyperfine state we apply a stern - gerlach method . </S>",
    "<S> after the state manipulation has been performed , in addition to the homogeneous bias field , an inhomogeneous magnetic field is applied along the quantization axis for @xmath47 . </S>",
    "<S> this causes the different @xmath46 states to spatially separate . after a time of @xmath48 of expansion a standard absorption imaging sequence </S>",
    "<S> is performed . </S>",
    "<S> the atomic populations in each @xmath46 state is normalized to the total number of observed atoms .    [ [ results ] ] results : + + + + + + + +    .target populations @xmath32 of different target states ( a@xmath38i ) , theoretical ( @xmath49 ) and experimental ( @xmath50 ) error functions in their preparation , and fidelity @xmath51 between the initial and the target state . </S>",
    "<S> the error bars for @xmath49 are obtained considering the maximal deviation when the noise rate @xmath52 is varied in the range @xmath53 \\ 2\\pi$ ] hz and the magnetic field in a @xmath54 mg range around the ideal value @xmath55 . in the absence of dephasing noise , </S>",
    "<S> the theoretically predicted @xmath49 are always smaller than @xmath56 . </S>",
    "<S> [ cols=\"^,^,^,^,^,^,^,^,^\",options=\"header \" , ]     let us define the theoretical state preparation error @xmath49 and the experimentally measured one @xmath50 . </S>",
    "<S> we then apply ten times the same preparation pulse and the reported values of @xmath50 are the corresponding means and standard deviations . </S>",
    "<S> we take into account the presence of magnetic noise in the experiment by including in the theoretical model an effective dephasing with rate @xmath57 $ ] hz ( see eq . </S>",
    "<S> [ eqn : l ] ) .     for the preparation ( grey area ) of a ground state and the highest excited state of the hamiltonian @xmath58 with @xmath59 being the harmonic potential that oscillates at @xmath60 khz for every @xmath61 ( white area ) . </S>",
    "<S> , scaledwidth=50.0% ]    in the right half of tab . </S>",
    "<S> [ table2 ] we show the errors @xmath62 in the preparation of quantum states ( @xmath63 ) , with a highly satisfactory agreement between theory and experiment . </S>",
    "<S> we include also a measure of distance ( uhlmann fidelity @xmath51 @xcite ) between the initial state @xmath35 and the target state @xmath64 , which is defined as @xmath65 , in order to show that the target states do cover a large portion of the hilbert space , i.e. they have varying distances from the initial state . </S>",
    "<S> let us stress that these states can not be prepared by simply using constant pulses @xcite .    as noted above </S>",
    "<S> , these experimental results only show that we are able to prepare different population distributions in the @xmath3 manifold . to directly verify our ability to prepare superposition of levels , </S>",
    "<S> we have prepared the ground state and highest excited state of the hamiltonian @xmath66 in which @xmath67 @xmath68 khz , and observed the absence of any evolution of the population distribution of these states after applying the preparation pulse , i.e. for @xmath69 , while keeping @xmath70 ( @xmath71 is the pulse length ) .     as a function of pulse length @xmath28 , obtained theoretically ( black dots ) , in the absence of dephasing noise , and experimentally ( red dots ) , to prepare the state @xmath72 by optimal control . </S>",
    "<S> the effect of dephasing noise in the range @xmath73 $ ] hz is also considered ( shaded region ) . </S>",
    "<S> the results achievable with constant @xmath74 khz are also shown ( dashed line ) . </S>",
    "<S> inset : theoretical ( lines ) and experimental ( dots ) dynamical evolution of the population of the levels @xmath75 ( blue ) , @xmath76 ( red ) , and the sum of the remaining three levels ( black ) during the application of optimal pulse of length @xmath77 . </S>",
    "<S> , scaledwidth=50.0% ]    the results are reported in fig . </S>",
    "<S> [ hamilchange ] where we plot the experimental points and expected theoretical behaviour . the theoretical prediction without any free parameter </S>",
    "<S> is shown as a continuous line . </S>",
    "<S> some typical examples of optimal pulses are shown in the supplementary information .    </S>",
    "<S> we then proceed to analyse the time limits for the preparation of the states , in other words we are interested in keeping the pulse length as short as possible while still suppressing errors in the state preparation . for this analysis </S>",
    "<S> we choose the target state @xmath72 , fixing different pulse times and minimizing the error function @xmath62 under the same constraint on magnetic field and rabi frequency . in fig . </S>",
    "<S> [ evolution ] we report the results obtained . </S>",
    "<S> the theoretical noiseless results saturate very close to vanishing errors for a pulse length of @xmath78 . for the experimental results we used the same procedure outlined above to determine the error value . </S>",
    "<S> experimental results are perfectly matched to the theoretical noiseless value at short pulse times but deviate for longer pulses , due to the increasing effect of the low frequency experimental noise on the magnetic field . </S>",
    "<S> if we include in the simulation the magnetic field and dephasing noise term fluctuations to correct all the theoretical predictions , we obtain a good agreement with the experimental observation . </S>",
    "<S> the precise matching between theory and experiment is also shown in the inset of fig . </S>",
    "<S> [ evolution ] where we report the experimentally measured values of the atomic populations in the five levels during the application of the @xmath79-pulse . </S>",
    "<S> no fitting procedure was used to get the theoretical results ( shown as continuous lines ) .    </S>",
    "<S> [ [ application - to - interferometry ] ] application to interferometry : + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we have implemented an atomic ramsey interferometer scheme using some of the state preparation pulses listed above . in a conventional ramsey interferometer the application of a @xmath80 pulse creates a balanced superposition of two atomic states separated by an energy difference @xmath81 . after the pulse </S>",
    "<S> , the atoms are let free to evolve for a time @xmath82 , during which the states acquire a phase difference @xmath83 . </S>",
    "<S> then , the application of a second @xmath80 pulse maps this phase difference onto the atomic populations , which then oscillate as @xmath84 . </S>",
    "<S> even if the smallest signal that an interferometer can ultimately resolve is limited by the signal to noise ratio , typically its sensitivity is determined by the maximum slope of the interferometric fringe . </S>",
    "<S> the best achievable sensitivity of a conventional ramsey interferometer is found to improve linearly with @xmath81 .    </S>",
    "<S> the presence of five levels in the @xmath3 manifold complicates the analysis of the interferometer albeit offering a possibility to realise a multi - state interferometer with increased sensitivity @xcite . whereas optimal control would allow to maximize the performance of an interferometer @xcite , for our system this would require an extensive analysis of the content of information of the interferometric output that goes beyond the focus of the present work </S>",
    "<S> nonetheless , as an application of our protocol , we restrict ourselves to interferometric configurations where , for simplicity , only two levels play a role during the free evolution . to this aim </S>",
    "<S> , we use the state preparation pulses a , b , c , d ( all of them populating two initial states only ) , both as input and output beam splitters .    </S>",
    "<S> , calculated as the maximum slope of the fringe with the largest amplitude @xmath72 , normalized with respect to the latter . the quantity @xmath85 </S>",
    "<S> is plotted as a function of the energy gap @xmath81 between the two levels that are initially populated by the optimal control preparation pulse to show the linear dependence between them . </S>",
    "<S> inset : relative populations on the level @xmath36 for the state preparation pulses a ( red circles ) and d ( blue triangles ) vs. time ( @xmath86 ) . </S>",
    "<S> , scaledwidth=50.0% ]    for each preparation pulse we record the interferometric pattern , i.e. the behaviour of the relative populations in the @xmath3 manifold after applying the two pulses and a variable time delay @xmath82 between them . among the five components of the interferometer s signal we select the one with the highest fringe amplitude @xmath72 and we calculate the point - to - point slope selecting its maximum value @xmath87 . since the fringe amplitude can be different for each preparation pulse , we take into account its effect on the sensitivity by plotting in fig . </S>",
    "<S> [ fig4 ] the values @xmath85 with respect to the energy difference @xmath81 between the levels populated via the state preparation pulse . </S>",
    "<S> the results confirm , within the errors , the expected linear dependency between the two quantities . </S>",
    "<S> let us point out that none of these interferometers can be realized without optimal control since no one of the states above ( a , b , c , d ) can be reached with constant pulses . </S>",
    "<S> it must be noted that , in our experiment , we have not taken into consideration the fringe amplitude which could be manipulated by a suitable choice of optimization parameters . </S>",
    "<S> however , this simple application still allows us to achieve a four - fold improvement of the interferometer sensitivity , without changing neither the applied magnetic field nor the time interval between the two pulses .    </S>",
    "<S> [ [ conclusions ] ] conclusions : + + + + + + + + + + + +    the preparation of specific quantum states is a crucial step to control atom - chip devices , especially in the context of quantum information and communication technologies . </S>",
    "<S> however , this is highly non - trivial to perform even theoretically , for instance for complex quantum systems , and especially from the experimental side since one has to deal with imperfections and the presence of noise due to the external environment , limiting the observation time scale . over the last years </S>",
    "<S> , the theory of optimal control has allowed to address this issue in an efficient way , also when working with fragile quantum system and non - unitary ( noisy ) evolutions . here , we have applied optimal control tools to preparare a family of different internal states of a rubidium bose - einstein condensate produced in an atom chip - based micro - trap . in particular </S>",
    "<S> , we theoretically and experimentally find that these states can be prepared with a very small error ( @xmath88 ) , with very short ( control ) pulses successfully overcoming the unavoidable presence of dephasing noise . </S>",
    "<S> hence , we also test these protocols to implement improved interferometric configurations that would have been not accessible without the preparation of some input quantum states by optimal control . </S>",
    "<S> therefore , these results might pave the way for new schemes towards , among others , better control of quantum dynamics , preparation of squeezed states , time - inversion of the system dynamics , realization of quantum gates , and so more powerful quantum information protocols .    </S>",
    "<S> this work was supported by the seventh framework programme for research of the european commission , under fet - open grant malicia , qibec , siqs , and by dfs via sfb / trr21 . </S>",
    "<S> the work of f.c . has been supported by eu fp7 marie - curie programme ( career integration grant ) and by miur - firb grant ( rbfr10m3sb ) . </S>",
    "<S> we thank m. inguscio for fruitful discussions and continuous support . </S>",
    "<S> qstar is the mpq , lens , iit , unifi joint center for quantum science and technology in arcetri .     in the case of the ground state of the hamiltonian @xmath58 with @xmath89 being the harmonic potential that oscillates at @xmath90 khz , for both theory ( lines ) and experiment ( dots ) . </S>",
    "<S> the gray area correspond to the evolution guided by the optimized pulse , and is followed by a constant frequency driving for every @xmath91 , i.e. by the target hamiltonian.,scaledwidth=48.0% ] </S>"
  ]
}