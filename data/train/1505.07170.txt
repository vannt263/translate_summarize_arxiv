{
  "article_text": [
    "euroscience is transforming .",
    "investigators have recently started sharing brain data collected on large human populations @xcite .",
    "the modern era of data sharing has the potential to promote scientific replicability of results and advance our understanding of brain function .",
    "shared data can be accessed by different research groups and analytic tools can be tested and applied to the very same data in attempt to extend and replicate scientific results @xcite .",
    "this fundamental shift of modern neuroscience will allow separating the wheat from the chaff .",
    "this paradigm shift is changing the landscape of brain imaging and motivating investigators to implement new methods for data storage , analysis and sharing @xcite .",
    "hereafter , we show that modern neuroimaging can benefit from recent developments in signal processing @xcite to address the new challenges raised by the most recent growth in data size , resolution and neuroscience models complexity .",
    "standard signal processing methods in neuroimaging are based on classical linear algebra and use mathematical objects such as one dimensional vectors ( @xmath0d ) and two dimensional matrices ( @xmath1d ) .",
    "multiway approaches exploit the properties of arrays of higher order ; arrays with three or more dimensions .",
    "multiway arrays , also referred to as hypermatrices or tensors , are the generalization of vectors and matrices to higher number of dimensions ( @xmath2d ) .",
    "multiway arrays have two primary advantages when applied to neuroimaging data compared to classical linear algebra approaches .",
    "first , neuroimaging data are multidimensional in nature and their structure is preserved by multiway arrays , which in turns allows for straightforward data addressing .",
    "second , they provide convenient and compact representations of neuroimaging models that allows substantial reduction in memory consumption @xcite . below we briefly introduce basic concepts for multyway array decomposition and show one example application of the methods to modeling diffusion imaging and tractography @xcite .",
    "dmri data in combination with fiber tracking allows measuring the anatomy and tissue properties of the human white - matter in living brains @xcite . by measuring living brains",
    "this technology allows correlating the properties of the white matter tissue and structure with human behavior , cognition as well as development and aging in health and disease @xcite .",
    "dmri and tractography generate estimates of white matter tracts and connections , such estimates need methods for routine evaluation and validation @xcite . for example , it is established that different tractography methods can generate different estimates of the shape of the white matter anatomy ( fig .",
    "[ fig : fig_intro]a and b ) .",
    "recently we developed a method called life , linear fascicle evaluation @xcite .",
    "life is an approach to statistical validation of in vivo connectomes that can be applied to individual brains . to validate connectomes in each brain",
    ", life requires as input a set of candidate white - matter fascicles generated using available tractography algorithms @xcite .",
    "the candidate fascicles are used to generate a prediction of the anisotropic diffusion signal measured within the white matter volume using dmri .",
    "the error ( root mean squared error , r.m.s . ) in predicting the diffusion signal is computed using cross - validation and used to establish the accuracy of a tractography solution .",
    "for example , fig .",
    "[ fig : fig_intro]c shows a comparison of the cross - validated r.m.s .",
    "error of two tractography methods in the same brain ( the models shown in fig .",
    "[ fig : fig_intro]a and [ fig : fig_intro]b ) .",
    "the result demonstrate that in a majority of the white matter the model in fig .",
    "[ fig : fig_intro]a has lower r.m.s . error in predicting the diffusion signal .",
    "life predicts the demeaned dmri data by finding the linear combination of the diffusion prediction contributed by all individual fascicles within a connectome .    ) . the demeaned diffusion signal ( brown )",
    "is predicted as the weighted sum of the predictions from all fascicles ( green and red ) in the voxel . * c*. global linear model .",
    "the demeaned measured diffusion signal across all white - matter voxels is organized in a long @xmath0d vector ( @xmath3 ) .",
    "the signal prediction from all fascicle across the full white - matter volume is organized into a large @xmath1d block - sparse matrix @xmath4 .",
    "weights are assigned to each fascicle using an optimization procedure , fascicle weights are organized into a @xmath0d vector ( @xmath5 ) .",
    "notations , @xmath6 represents the number of diffusion directions , @xmath7 the number of voxels , and @xmath8 the number of fascicles ) . * d*. life storage measurements .",
    "the size of the life model ( @xmath1d matrix @xmath4 in panel c ) measured in @xmath9 in several brains and data sets .",
    "matrices built using double floating - point precision.,scaledwidth=42.0% ]    the fundamental problem solved by life is to allow computing an error measure that can be used for a variety of tasks in evaluating individual connectomes properties generated with virtually any tractography method @xcite .",
    "one consequence of formulating the life model as a system of linear equations is the size of the @xmath1d matrix representing the model ( see fig .",
    "[ fig : fig_life]c and eq .",
    "[ eq : matrix_equation ] ) .",
    "the computational demands of the life method represented as @xmath1d matrix are substantial .",
    "given an approximate human white - matter volume of @xmath10 , the spatial and directional resolution of modern dmri measurements and a reasonable number of fascicles in a connectome , the size of the life model can be as large as about @xmath11 ( see fig .",
    "[ fig : fig_life]d ) .",
    "hereafter , we introduce a multiway decomposition method that reduces the size of the life model by over @xmath12 .",
    "the new multiway approach maintains memory consumption under @xmath13 per brain .",
    "the approach can be applied to any linearized model for global tractography , tractography evaluation and microstructure estimation .",
    "below , we ( 1 ) describe the mathematics of the sparse multiway decomposition , ( 2 ) show that memory consumption is quasi - constant as function of connectome size when using the decomposition and ( 3 ) replicate major results of the original life work using the new approach and several datasets @xcite .",
    "we provide open source software implementing the life model at github.com/brain-life/life and francopestilli.github.io/life .",
    "scripts and data used to generate the results in the present articles can be found at these repositories .",
    "[ dwmri ]      diffusion - weighted magnetic resonance imaging data ( dmri ) were collected in five males subjects ( age 37 - 39 ) at the stanford center for cognitive and neurobiological imaging using a 3 t general electric discovery 750 ( general electric healthcare ) equipped with a 32-channel head coil ( nova medical ) .",
    "this dataset is published @xcite and publicly available at http://purl.stanford.edu/rt034xr8593 and http://purl.stanford.edu/ng782rw8378 .",
    "data collection procedures were approved by the stanford university institutional review board . written consent was collected from each participant .",
    "_ stanford @xmath14 diffusion directions data set ( stn96 ) : _ two diffusion - weighted with whole - brain volume coverage were acquired in five individuals within a single scan session using a dual - spin echo diffusion - weighted sequence .",
    "water - proton diffusion was measured using 96 directions chosen using the electrostatic repulsion algorithm @xcite .",
    "diffusion - weighting gradient strength was set to @xmath15 ( @xmath16 @xmath17 ) .",
    "data were acquired at @xmath18 isotropic spatial resolution .",
    "individual data sets were acquired twice and averaged in k - space ( @xmath19 ) .",
    "ten non - diffusion - weighted ( @xmath20 ) images were acquired at the beginning of each scan .",
    "_ stanford @xmath21 diffusion directions data set ( stn150 ) : _ for one subject two dmri data sets were also acquired in a single session using @xmath21 directions , @xmath22 isotropic spatial resolution and b values of @xmath15 ( @xmath23 , and @xmath24 ) .",
    "mri images for stn96 and stn150 were corrected for spatial distortions due to b0 field inhomogeneity .",
    "to do so , b0 magnetic field maps were collected with the same slice prescription as the dmri data using a 16-shot , gradient - echo spiral - trajectory pulse sequence .",
    "two volumes were acquired before and after the dmri scan ( @xmath25 and @xmath26 respectively ) , the phase difference between the volumes was used as an estimate of the magnetic field .",
    "subjects motion was corrected using a rigid - body alignment algorithm @xcite .",
    "diffusion gradients were adjusted to account for the rotation applied to the measurements during motion correction .",
    "the dual - spin echo sequence we used does not require eddy current correction because it has a relatively long delay between the rf excitation pulse and image acquisition .",
    "this allows for sufficient time for the eddy currents to dephase .",
    "processing software is available at https://github.com/vistalab/vistasoft .",
    "the white / gray matter border was defined on the average of two 0.7-mm3 t1-weighted fspgr images acquired in the same scan session .",
    "tissue segmentation was performed using an automated procedure ( freesurfer @xcite ) and refined manually ( http://www.itksnap.org/pmwiki/pmwiki.php ) .",
    "fiber tracking was performed using the mrtrix 0.2 toolbox @xcite .",
    "white - matter tissue was identified from the cortical segmentation performed on the t1-weighted images and resampled at the resolution of the dmri data .",
    "only white - matter voxels were used to seed fiber tracking .",
    "we used two tracking methods : ( i ) tensor - based deterministic tractography @xcite and ( ii ) csd - based probabilistic tracking @xcite with a maximum harmonic order of @xmath27 ( @xmath28 , step size : @xmath29 ; minimum radius of curvature , @xmath30 ; maximum length , @xmath31 ; minimum length , @xmath32 ; fibers orientation distribution function ( @xmath33 ) amplitude cutoff , was set to @xmath34 ) .",
    "we created candidate whole - brain connectomes with @xmath35 fascicles in each individual brain ( five ) , data set ( two ) and tractography method ( two ) .",
    "analysis were performed independently for each brain .",
    "figures of tracts and brain images were generated using the matlab brain anatomy toolbox : https://github.com/francopestilli/mba .",
    "the brain tissue comprises different cell types ( e.g. , neurons , astrocytes and oligodendrocytes ) .",
    "dmri measures signals that depends on the combination of all cellular components within the brain tissue .",
    "the dmri measurements are generally modeled as the linear combination of two primary components .",
    "one component describes the directional diffusion signal and is presumably related primarily to the direction of the neuronal axons wrapped in myelin sheaths ( white matter ) .",
    "this signal is often referred to as _",
    "anisotropic diffusion_. the other component describes _",
    "isotropic diffusion _",
    "( non - directional ) and is presumably related to the combination of signals originating from the rest of the cellular bodies within the brain tissue . below we describe the simplest , fundamental equations used to model the measured dmri signal in relation to the brain tissue components .",
    "dmri measures the diffusion signal with and without diffusion sensitization .",
    "the measured signal results from the combination of diffusion gradient strength , duration and depends on the interval between two applied gradient pulses .",
    "below we denote the strength of sensitization with @xmath36 and the vectors of measured diffusion directions ( directions along which the diffusion - sensitization gradients are applied ) using the unit - norm vector @xmath37 .    for a given sensitization strength @xmath36 and diffusion directions @xmath38",
    ", the diffusion signal measured at each location within a brain ( voxel @xmath39 ) can be computed using the following equation @xcite :    @xmath40    where @xmath41 is the index of the candidate white - matter fascicles within the voxel , @xmath42 is the non diffusion - weighted signal in voxel @xmath39 and @xmath43 is the isotropic apparent diffusion ( diffusion in all directions ) .",
    "the value @xmath44 gives us the apparent diffusion at direction @xmath38 generated by fascicle @xmath41 .",
    "@xmath45 is a symmetric and positive - definite matrix called tensor @xcite .",
    "the tensor allows a compact representation of the diffusion signal measured with dmri .",
    "for example , @xmath46 in the exponent of eq .",
    "[ diffusion_model ] can be replaced with the following simple tensor model : @xmath47 \\end{array }   \\left [ \\begin{array}{ccc } s_a & 0 & 0 \\\\ 0 & s_{r_1 } & 0 \\\\ 0 & 0 & s_{r_2 }   \\end{array }   \\right ] \\left [ \\begin{array}{c } \\u_1 \\\\ \\u_2 \\\\ \\u_3   \\end{array } \\right],\\ ] ] where @xmath48 are the unit - norm orthogonal vectors that correspond to the semi - axes of the diffusion tensor ellipsoid , and @xmath49 , @xmath50 , @xmath51 define the axial and radial diffusivity of the tensor , respectively . in the simplest version of the fascicle model , @xmath52 and @xmath53 , which means that diffusion",
    "is restricted to the main axis direction @xcite .",
    "multiway arrays generalize vectors ( @xmath0d array ) and matrices ( @xmath1d array ) to arrays of higher dimensions , three or more .",
    "such arrays can be used to perform multidimensional factor analysis and decomposition and are of interest to many scientific disciplines @xcite .",
    "below we introduce a few basic concepts and notation helpful in discussing multiway arrays and their decomposition .",
    "we refer the reader to table [ tab : notation ] for a summary of basic notations and definitions .    _ multiway arrays .",
    "_ vectors ( @xmath0d arrays ) and matrices ( @xmath1d arrays ) are denoted below using boldface lower- and upper - case letters , respectively .",
    "for example @xmath54 and @xmath55 represent a vector and a matrix , respectively .",
    "a multiway array , also called @xmath2-th order array , is the generalization of matrices to more than two dimensions and is denoted by an underlined boldface capital letter , e.g. @xmath56 is an @xmath57-rd order array of real numbers .",
    "elements @xmath58 of a multiway array are referred to as @xmath59 .",
    "_ array slices . _",
    "array slices are used to address a multiway array along a single dimension ( a cut through a single dimension of the array ) .",
    "slices are obtained by fixing the index of one dimension of the multiway array while letting the other indices vary .",
    "for example , in a @xmath57-rd order array @xmath56 , we can identify horizontal ( @xmath60 ) , lateral ( @xmath61 ) and frontal ( @xmath62 ) slices by holding fixed the corresponding index of each array dimension ( see fig .",
    "[ fig : fig_nway]a ) .    _ unfolding arrays and mode-@xmath63 vectors .",
    "_ multiway arrays can be conveniently addressed in any dimension by means of mode-@xmath63 vectors . given a multiway array @xmath56 ,",
    "its mode-@xmath63 vectors are obtained by holding all indices fixed except one , thus corresponding to columns ( @xmath64 ) , rows ( @xmath65 ) and so on ( see fig .",
    "[ fig : fig_nway]b ) .",
    "for example , a @xmath57d multiway array can be converted into a matrix by re - arranging its entries ( unfolding ) .",
    "the mode-@xmath63 unfolded matrix , denoted by @xmath66 , where @xmath67 and whose entry at row @xmath68 and column @xmath69 is equal to @xmath70 .",
    "for example , mode-@xmath1 unfolding builds the matrix @xmath71 where its columns are the mode-@xmath1 vectors of the multiway array and the rows are vectorized versions of the lateral slices , i.e. spanning dimensions with indices @xmath60 and @xmath62 ( see fig .",
    "[ fig : fig_nway]c ) .    _ multiway array by matrix product .",
    "_ multiway arrays can be multiplied by matrices ( @xmath1d arrays ) only if the matrix and multiway array sizes match in the mode specified for the multiplication .",
    "this is a generalization of matrix multiplication .",
    "given a multiway array @xmath72 and a matrix @xmath73 , the mode-@xmath63 product @xmath74 is defined by : @xmath75 with @xmath76 ( @xmath77 ) and @xmath78 .",
    "it is noted that this operation involves the products of matrix @xmath79 by each one of the mode-@xmath63 vectors of @xmath80 . in fig .",
    "[ fig : fig_nway]b , the @xmath57-rd order array by matrix product in mode-@xmath1 is illustrated , i.e. @xmath81 . the size of the resulting array @xmath82 is that of @xmath80 in mode-@xmath0 and -@xmath57 while the size of @xmath82 in mode-@xmath1 is @xmath83 , i.e. it is equal to the number of rows in @xmath79 .    .",
    "* d*. array - by - matrix product ( example product in mode-2 ) .",
    "see table [ tab : notation ] for additional information about notation and mathematical definitions.,scaledwidth=45.0% ]    [ tab : notation ]",
    "the linear fascicle evaluation method ( life ; @xcite ) allows evaluating the accuracy of connectomes generated using dmri and any fiber tracking algorithm .",
    "the method evaluates the tractography solution by estimating the contribution to predicting the measured diffusion signal from all fascicles contained in a connectome ( see fig .",
    "[ fig : fig_life]a and b for examples of fascicles ) .",
    "the evaluation method focuses on the fascicles , for this reason it predicts the anisotropic diffusion signal ; the demeaned diffusion signal ( signal that is independent of isotropic diffusion , first term in the right hand of eq .",
    "[ diffusion_model ] ) .",
    "the anisotropic signal within a voxel @xmath39 is predicted by demeaning the signal prediction in the following way : @xmath84 where the mean @xmath85 is defined as @xmath86 with @xmath6 being the number of sensitization directions and @xmath87 is orientation distribution function specific to each fascicle , i.e. the anisotropic modulation of the diffusion signal around its mean and it is defined as follows : @xmath88 the left - side hand in eq .",
    "[ linear_model ] , the demeaned signal , is the difference between the measured diffusion signal and the mean diffusion signal . the right - hand side of eq .",
    "[ linear_model ] is the prediction model .",
    "the life model extends from the single voxel to all white - matter voxels in the following way :    @xmath89    where @xmath90 is a vector containing the demeaned signal for all white - matter voxels @xmath39 and across all diffusion directions @xmath91 , i.e. @xmath92 . the matrix @xmath93 contains at column @xmath41 the signal contribution @xmath87 given by fascicle @xmath41 at voxel @xmath39 across all directions @xmath91 , i.e. , @xmath94 , and @xmath95 contains the weights for each fascicle in the connectome .",
    "these weights are estimated by solving the following non - negative least - square constrained optimization problem : @xmath96    this formulation of the life model requires generating a matrix @xmath4 ( fig . [ fig : fig_life]c ) that is very large and block - sparse .",
    "@xmath4 is sparse because fascicles only cross a subset of all voxels .",
    "the matrix has @xmath97 rows by @xmath8 columns . given an approximate human white - matter volume of 500 @xmath98 the number of voxels ( @xmath7 ) can vary between @xmath99 and @xmath35 depending on the spatial resolution of the dmri acquisition ( normally between 4 - 1.25 @xmath100 ) .",
    "given that modern dmri acquisition parameters measure between @xmath101 and @xmath102 diffusion directions ( @xmath6 ) and that whole - brain connectomes can contain as little as @xmath103 but as much as @xmath104 fascicles ( columns of @xmath4 ) , the size of @xmath4 can vary between @xmath27 and @xmath105 gb using standard double - precision floating - point format and sparse format .",
    "[ fig : fig_life]d shows measurements of the size of @xmath4 in @xmath9 for five individual brains and two datasets .",
    "such large memory requirements necessitate large - memory compute - systems nowadays available in major research institutions ( e.g. , http://rt.uits.iu.edu/bigred2/ , http://karst.uits.iu.edu ) .",
    "below we introduce a novel approach that dramatically reduces the storage requirements of the life model and makes life suitable to run on standard desktop and notebook computers .",
    "major contribution of the present work is a method to represent the life model via sparse tucker decomposition ( std ; @xcite ) . before introducing the method",
    ", we briefly discuss the standard and sparse tucker - decomposition methods ( see also methods [ tab : notation ] )",
    ".    _ data compression by tucker decomposition .",
    "_ ledyard tucker , a mathematician who specialized in statistics and psychometrics , was first in proposing a decomposition approach to multidimensional factorization problems @xcite .",
    "the approach provides a generalization of the low - rank approximation for matrices to multiway arrays . using the tucker model , a @xmath57-rd array @xmath106 ,",
    "is approximated by the following decomposition : @xmath107 with a _ core array _ @xmath108 and _ factor matrices _",
    "the decomposition is not guaranteed to provide a good aproximation , but when it does it compresses data because it uses a core array that is much smaller than the original multiway array , i.e. @xmath110 .",
    "indeed , the tucker model provides us with a powerful compression method .",
    "this is because , instead of storing the whole original multiway array , we can store core array and factors . in this case , eq . [ eq : tucker ] @xcite is called a _ low - rank _ tucker model because @xmath111 is small compared to @xmath80 ( see fig .",
    "[ fig : fig_tucker]a ) .",
    "a simple example can help us explain how compression is obtained with a standard low - rank tucker model .",
    "let consider a situation where @xmath112 and @xmath113 .",
    "the low - rank tucker decomposition of @xmath80 requires storing only @xmath114 values .",
    "where @xmath115 is the number of entries of @xmath111 and @xmath116 and @xmath117 the dimensions of @xmath118 , @xmath119 and @xmath120 .",
    "instead , the full multiway array would require storing @xmath121 values , compression is noticeable especially when @xmath111 is small meaning that @xmath122 .",
    "d multiway array @xmath106 as the product of core array ( green ) @xmath123 by factor matrices @xmath124 ( red , yellow and blue )",
    ". data compression is achieved by considering very small ( dense ) core arrays @xmath111 , meaning that @xmath110 .",
    "* b*. the sparse tucker decomposition ( std ; @xcite ) .",
    "the core array @xmath111 is large but sparse , not dense as in the classical tucker model .",
    "data compression is achieved because of the sparsity of the core array.,scaledwidth=45.0% ]    _ data compression by sparse tucker decomposition : _ if the core @xmath111 of a tucker decomposition of a multiway array is sparse , compression can be achieved even when @xmath111 is very large @xcite .",
    "consider a tucker model with a large but sparse core array @xmath108 , see fig .",
    "[ fig : fig_nway]e .",
    "only some entries in @xmath111 are nonzero , i.e. @xmath125 for @xmath126 where @xmath127 is the number of nonzero entries .",
    "storing @xmath111 all requires storing : ( 1 ) the non - zero coefficients , ( 2 ) their location in @xmath111 , and ( 3 ) the factor matrices @xmath128 .",
    "this means that the storage cost ( order ) of the model is @xmath129 ( assuming that @xmath112 and @xmath113 ) .",
    "hereafter , we refer to this model as sparse tucker decomposition ( std ) .",
    "compared to the classical low - rank tucker model , std can provide better compression ratios with relatively low @xmath127 , i.e. , with very sparse core arrays @xmath111 @xcite .",
    "below we show how to apply the std approach to the life model .",
    "to do so we first explain how the diffusion signals within a voxel predicted by the life model can be represented using dictionaries of precomputed diffusion prediction signals . after that we show how to extend the decomposition approach to the whole white matter volume .",
    "the original life model predicts anisotropic diffusion within a voxel , @xmath39 , at each measured diffusion direction , @xmath38 , by using the orientation of the white matter fascicles intersecting the voxel ( fig .",
    "[ fig : fig_life]b ; @xcite ) .",
    "fascicles are defined as a list of @xmath130 spatial coordinates within the brain , the fascicle _",
    "nodes_. to generate the prediction , a demeaned tensor model is evaluated parallel to the orientation of each fascicle node ( eq . [ eq : o_f ] ) .",
    "hereafter , we simplify the calculations by representing the signal prediction for any arbitrary fascicle - node orientation using a dictionary of diffusion prediction signals generated for a predefined set of orientations regularly sampled over a grid . this grid covers a plausible rage of fascicles orientations on the unit - norm sphere ( shown in fig .",
    "[ fig : fig_life]a ) given the resolution of the dmri data ( fig .",
    "[ fig : fig_dictionary]a ) .",
    "we define the dictionary matrix @xmath131 ( fig .",
    "[ fig : fig_dictionary]b ) containing in its columns the demeaned canonical diffusion signals called _ atoms _ that can be used to approximate fascicles contributions .",
    "more specifically , we define @xmath132 where @xmath133 is the diffusion prediction associated to the atom @xmath134 , i.e. with a single orientation in 3d space .",
    "dictionary atoms are identified by discretizing each spherical coordinate @xmath135 and @xmath136 using a grid of values in the rage @xmath137 ( fig .",
    "[ fig : fig_dictionary]b ) .",
    "the parameter @xmath138 indicates the number of discretization samples on the grid .",
    "for example , @xmath139 indicates a grid resolution of @xmath140 with an approximate atom number @xmath141",
    ".        the dictionary @xmath131 allows predicting the matrix @xmath142 , defined as a block of matrix @xmath4 corresponding to voxel @xmath39 ( see fig . [",
    "fig : fig_dictionary]c ) , by decomposing it in the following way : @xmath143 where @xmath144 is a sparse matrix whose non - zero entries at column @xmath41 indicates the dictionary atoms selected to predict the voxel signal , given the orientations of the fascicles in the voxel . in sum , instead of storing the individual contribution of each fascicle within a voxel , we store only the indices to the dictionary atoms , and avoid multiple versions of very similar signals .",
    "below we extend the std of life from single voxels to the entire white matter volume .",
    "we show that for each data set used we can find a finite number of dictionary atoms that generate predictions as accurate as those obtained with the original life model .",
    "the original life model comprises a single very large block - sparse matrix ( @xmath4 in eq .",
    "[ eq : matrix_equation ] ) .",
    "the matrix @xmath145 can be converted into a multiway array by mapping the diffusion directions ( @xmath91 ) , voxels ( @xmath39 ) and fascicles ( @xmath41 ) , onto the dimensions of a 3d multiway array @xmath146 . representing @xmath4 as a 3d multiway array @xmath147 allows us using a sparse tucker decomposition approach and",
    "compress its size @xcite .    to fully exploit the sparse tucker decomposition we consider both the life model @xmath4 and its optimization problem , as defined in eq .",
    "[ eq : matrix_equation ] .",
    "this equation can be conveniently rewritten using multiway arrays in the following manner ( see fig .",
    "[ fig : fig_tensorlife]a ) : @xmath148 where matrix @xmath149 is the matrix version of vector @xmath3 , and @xmath150 is a 3-way array .",
    "the lateral slices of @xmath147 are defined by the matrices @xmath151 defined in eq .",
    "[ eq : dictmvox ] , these represent matrices @xmath152 corresponding to each white matter voxel .",
    "furthermore , eq . [ eq : dictmvox ] shows that each lateral slice of @xmath147 is scaled by @xmath42 , which we represent at a diagonal matrix @xmath153 .",
    "this allows us writing the life model that encompasses all voxels by using an efficient sparse tucker decomposition ( std ) : @xmath154 where the 3-way array @xmath155 has as lateral slices the matrices @xmath156 and matrix @xmath157 is a diagonal matrix with values @xmath42 along the main diagonal . by combining eqs .",
    "( [ eq : nway_model ] ) and ( [ eq : m_decomposition ] ) we obtain the following sparse tucker decomposition of the life model ( see also fig . [",
    "fig : fig_tensorlife]b ) : @xmath158 @xmath159 is the core of the multiway decomposition , because @xmath159 is sparse it results in strong data compression ( see section [ sec : sto_red ] ) .",
    "below we introduce the set of operations necessary to build and optimize ( fit ) the std life model .",
    "the std life model is built using a large collection of white matter fascicles estimated using computational tractography , the connectome @xcite .",
    "fascicles in the connectome are represented as a list of @xmath130 brain coordinates .",
    "the @xmath159 core - array of std life model is then built in the following way : ( 1 ) the orientation of each fascicle s ( @xmath41 ) node ( @xmath63 ) is identified in spherical coordinates @xmath160 ; ( 2 ) nodes orientation is mapped to the closest atom ( @xmath134 ) in the dictionary ( @xmath161 ) ; ( 3 ) the entry in @xmath159 corresponding to each identified voxel , fascicle and atom is set to @xmath0 :    @xmath162    the rest of the entries in @xmath159 are set to zero .    , eq .",
    "[ eq : m_decomposition ] .",
    "* b*. life problem decomposition by sparse tucker method , eq .",
    "[ eq : lifebid_model ] .",
    ", scaledwidth=35.0% ]      building the std life model is the first of two steps in evaluating a brain connectome .",
    "the final step requires finding the non - negative weights that least - square fit the measured diffusion data .",
    "this is a convex problem that can be solved using a variety of non - negative least squares ( nnls ) optimization algorithms ( [ nnls ] ) .",
    "the original life problem , was solved using a nnls algorithm based on first - order methods @xcite .",
    "hereafter , we show how to modify the optimization algorithm to exploit the std life model .",
    "the optimization of the std life needs to be performed using its core array ( @xmath159 ) and matrices ( @xmath161 and @xmath163 ; eq .",
    "[ eq : m_decomposition ] ) .",
    "the gradient of the original objective function for the life model can be written as follows :",
    "@xmath164 where @xmath165 is the original life model , @xmath166 the fascicle weights and @xmath167 the demeaned diffusion signal . because the std version does not explicitly store @xmath4 in the following section we describe how to perform two basic operations ( @xmath168 and @xmath169 ) using the multiway decomposition to compute the optimization gradient .",
    "appendix a reports pseudocode implementing the operations .      the product @xmath171 can be computed in the following way using a 3d - array by vector product : @xmath172 where the result is a matrix @xmath173 , a matrix version of the vector @xmath3 . using the std life model ( eq . [ eq : m_decomposition ] ) the product",
    "is written as follows :    @xmath174      the product @xmath175 can be computed using the std life model in the following way @xcite : @xmath176 where @xmath177 is the kronecker product .",
    "[ eq : kron ] equation can be written as follows : @xmath178 where @xmath179 stands for the vectorization operation , i.e. to convert a matrix to a vector by stacking its columns in a long vector @xcite .    because matrix @xmath180 is very sparse",
    ", we avoid computing the large and dense matrix @xmath181 and multiply only the non - zero entries in @xmath180 .",
    "this allows maintaining efficient memory usage and limits the necessary number of cpu cycles .",
    "plotted against memory requirement of the std model ( eq . [ eq : m_decomposition ] , @xmath182 , stn96 data , probabilistic tractography , @xmath183 ) . * b*. memory requirement for @xmath4 and std ( eq . [ eq : m_decomposition ] ) as function of the number of measured diffusion directions ( @xmath184 , @xmath182 , stn96 data , probabilistic tractography , @xmath183 ) . * c*. memory requirement for @xmath4 and std ( eq . [ eq : m_decomposition ] ) as function of the number of fascicles in the connectome ( @xmath185 , @xmath182 , stn96 data , probabilistic tractography , @xmath183),scaledwidth=45.0% ]      fig .",
    "[ fig : fig_sto_results]a compares memory usage by @xmath4 ( fig . [ fig : fig_life]c ; @xcite ) and the std life model ( eq . [ eq : m_decomposition ] ) .",
    "the storage requirements of @xmath4 and the std model can also be computed analytically .",
    "to do so we assume that all fascicles have the same number of nodes @xmath186 and that there are no more than one node per fascicle , per voxel . under these assumptions the amount of memory necessary to store each fascicle @xmath41 is proportional to @xmath187 , thus the storage cost of @xmath4 is : @xmath188    conversely , storing fascicles in the std model require @xmath189 values only ( i.e. the set of the non - zero coefficients and their locations within the core multi - way array @xmath159 ) .",
    "thus the amount of memory required by the std model is : @xmath190 where @xmath191 is the storage associated with the dictionary matrix @xmath192 .",
    "please note that @xmath163 is absorbed as @xmath193 without affecting sparsity , i.e. , with no effect on the storage .",
    "storage reduction can be straightforwardly computed as follows : @xmath194    fig .",
    "[ fig : fig_sto_results]b shows memory usage for the models in @xcite and eq .",
    "[ eq : m_decomposition ] as function of number of diffusion directions @xmath6 in the data . given",
    "a fixed number of fascicles @xmath8 and nodes @xmath186 in a brain storage of @xmath4 grows linearly with the number of diffusion directions ( @xmath184 ; see eq .",
    "[ eq : old_life_cost ] ) much faster than the std model ( eq . [ eq : new_life_cost ] ) .",
    "[ fig : fig_sto_results]c shows memory usage for the models in @xcite and eq .",
    "[ eq : m_decomposition ] as function of the number of fascicles in a connectome ( @xmath185 ) .",
    "the storage of @xmath4 grows linearly with @xmath185 and grows much faster than the std model .    in sum",
    ", the std model provides substantial reduction in memory requirements .",
    "the reduction in memory consumption achieved by the std model becomes more important as the number of measured directions and fascicles in a connectome increase .",
    "the std model provides only an approximation of the original life model .",
    "this is because of the discretization introduced by the dictionary ( @xmath161 , see fig .",
    "[ fig : fig_dictionary]a ) . fig .",
    "[ fig : fig_accu_results ] shows that the std model achieves accuracy similar to the original model .",
    "we compared the accuracy of the std model in both , predicting the demeaned signal and estimating the weights of the original model .    )",
    ".,scaledwidth=45.0% ]    fig .",
    "[ fig : fig_accu_results]a shows the difference between the r.m.s error of the std and original life model .",
    "we fit the std model using different number of discretization steps of the spherical coordinates ( [ fig : fig_dictionary]a ) .",
    "to do so , the number of discretization steps was varied ( @xmath195 and @xmath196 ) and the difference in mean r.m.s . in predicting the demeaned diffusion signal across the whole white - matter volume",
    "was computed in reference to the mean r.m.s . of the original model . the mean r.m.s .",
    "used for comparison was cross - validated to an independent data set ( @xcite ) .",
    "[ fig : fig_accu_results]b shows the relative error of the std model in estimating the weights assigned by the original life model to each fascicle .",
    "we fit the std model using different number of discretization steps of the spherical coordinates as in [ fig : fig_accu_results]a .",
    "we computed the relative error in the estimated weights as @xmath197 where @xmath198 , @xmath199 are the weights of the original and std models , respectively .",
    "results show that for the data sets tested , @xmath200 allows achieving error below 1% .",
    "we demonstrated that a sparse tucker decomposition model achieves similar accuracy to the original life model and reduces storage requirements by 97% .",
    "[ fig : fig_replic_results ] shows that the std model replicates a major result of the original @xcite .",
    "the scatter plot shows the cross - validated r.m.s . in predicting the demeaned diffusion signal of a probabilistic and deterministic tractography connectome .",
    "results show that the std model replicates the findings of @xcite demonstrating a larger r.m.s . for the deterministic tractogrpahy connectome in a majority of the white matter volume ( see fig .",
    "[ fig : fig_intro]c for the same plot computed using the original life model ) .      the matlab implementation of life software using the new std model is provided at github.com/brain-life/life and francopestilli.github.io/life .",
    "the matlab implementation uses the matlab tensor toolbox @xcite and mex files compiled for mac osx and 64-bit linux distributions .",
    "the software has been tested to run on a standard notebook computers with less then 8 gb of ram . processing a whole brain connectome with 500,000 fascicles of the stn150 dataset using a single cpu thread ( notebook computer ,",
    "2.2ghz intel core i7 processor and 8 gb ram ) requires about 5 hours ( @xmath182 ) .    ) and tensor - based deterministic tractography and the std life model with discretization parameter @xmath182.,scaledwidth=45.0% ]",
    "the number of brain dataset collected using modern neuroimaging methods is growing at exponentially fast pace . at the same time",
    "both data resolution , as well as the size of the populations of human brains being acquired and shared are growing @xcite .",
    "the next generation of brain science will require collaborative efforts between the neuroscience community as well as the informatics and signal processing communities @xcite .",
    "the present article focuses on the application of modern signal processing methods for big data to neuroimaging .",
    "more speficically we present an example application to diffusion imaging and tractography evaluation @xcite .",
    "major value of dmri and tractography is to allow measuring white - matter in living brains in an individualized manner , one brain at the time .",
    "major efforts are being put forth to improve the representation of the white matter at the macro- , meso- and micro - structural level @xcite .",
    "the digital nature of neuroimaging data and the availability of large in - vivo databases affords developing new methods to built individual connectomes and compute their accuracy , and validate the results @xcite .",
    "computational tractography methods exploit the diffusion - weighted signal measured with mri to identify plausible trajectories of white matter tracts .",
    "most tractography methods estimate candidate tracts one node at a time . beyond the great excitement",
    "brought about by all these technologies , much work is necessary to develop approaches for evaluation and validation of results @xcite . to date two primary approaches",
    "have been used to tractography validation .",
    "first , the geometric accuracy of tractography has been compared to simulated and physical phantoms @xcite .",
    "second , tracts and connections identified using tractography have been compared to connections obtained with staining methods in postmortem tissue @xcite .",
    "these validation approaches have helped establishing that tractography is accurate to a certain degree and can well identify tracts within the core white matter .",
    "attempts to improve tractography have focussed on what is called global tractography .",
    "global tractography methods evaluate the plausibility of the tractography estimates by comparing individual streamlines trajectories with models of the dmri signal or heuristic rules about streamline smoothness@xcite .",
    "alternative approaches to global tractography have proposed the concurrent estimation of the biophysical properties of the white matter fascicles and surrounding tissue @xcite . historically global tractography methods have been considered computationally intensive tasks with limited applicability to routine study of the human brain in healthy and diseased populations .    recently a method for tractography evaluation based on linearized models @xcite has been proposed and applied to study living connectomes @xcite .",
    "the method separates the process of tracking from that of global evaluation of the fascicles @xcite .",
    "similarly a family of algorithms based on linearized models have been proposed to solve a series of estimation problems identified in modern tractogrpahy , as well as for studying of the tissue microstructure @xcite .",
    "this new generation of linearized methods for microstructure estimation , tractography evaluation are paving the road for new avenues of investigation and the study of the white matter in vivo .",
    "the contribution of the work presented here is to introduce the general framework of multiway decomposition methods that can potentially be applied to any type of linearized neuroimaging models .",
    "the decomposition methods allow reducing the computational complexity of the neuroimaging models and in doing so can increase the impact of these models .",
    "the application of multiway decomposition methods to neuroimaging will pave the road to use global estimation and evaluation methods to study large populations of human brains with increasingly high spatial resolution and to apply the modern methods to study the human brain in normal and clinical populations such as those available in modern databases @xcite .",
    "below we report pseudo code for the two operations necessary to fit the decomposed life model .",
    "these operations provide the option of being implemented using multi - threading methods .",
    "this is because the instances in the loop are independent and allow parallel computations .",
    "[ alg : m_times_w ] decomposition components ( @xmath201 , @xmath202 , @xmath203 ) and vector @xmath204 .",
    "@xmath205    @xmath206 ; ` the result is a very large but still very sparse 3d - array . `",
    "@xmath207 ; ` the result is a large but very sparse matrix ( n_a \\times n_v ) ` @xmath208 ; ` the result is a relatively small matrix ( n_{\\theta } \\times n_v ) ` @xmath209 ;    [ alg : mtransp_times_y ] decomposition components ( @xmath159 , @xmath161 , @xmath163 ) and vector @xmath167 .",
    "@xmath210 ; ` reshape vector \\y into a matrix \\y ` @xmath206 ; ` the result is a very large but still very sparse 3d - array . ` ; @xmath211 , @xmath212 , @xmath213 , @xmath214 indicate the atom , the voxel , the fascicle and coefficient associated to node @xmath63 , respectively , with @xmath215 ; ; ` initialize weights with zeros ` ; ;",
    "we thank hu chen , andrzej cichocki , aviv mezer , ariel rokem , richard shiffrin , olaf sporns and brian wandell for comments on early versions of the manuscript .",
    "we thank robert henschel for support using the high performance computers at indiana university bloomington and holger brunst for support in c code compilation and performance tuning .",
    "this project was funded by indiana university startup funds to f.p .",
    "aganj i , lenglet c , jahanshad n , yacoub e , harel n , thompson pm , sapiro g ( 2011 ) a hough transform global probabilistic approach to multiple - subject diffusion mri tractography .",
    "medical image analysis 15(4):414425    amunts k , lepage c , borgeat l , mohlberg h , dickscheid t , rousseau me , bludau s , bazin pl , lewis lb , oros - peusquens am , shah nj , lippert t , zilles k , evans ac ( 2013 ) bigbrain : an ultrahigh - resolution 3d human brain model .",
    "science 340(6139):14721475        assaf y , alexander dc , jones dk , bizzi a , behrens tej , clark ca , cohen y , dyrby tb , huppi ps , knoesche tr , lebihan d , parker gjm , poupon c , consortium c ( 2013 ) the connect project : combining macro- and micro - structure .",
    "neuroimage 80(c):273282    azadbakht h , parkes lm , haroon ha , augath m , logothetis nk , de  crespigny a , darceuil he , parker gjm ( 2015 ) validation of high - resolution tractography against in vivo tracing in the macaque visual cortex .",
    "cerebral cortex            behrens t , johansen - berg h , woolrich m , smith s , wheeler - kingshott c , boulby p , barker g , sillery e , sheehan k , ciccarelli o ( 2003 ) non - invasive mapping of connections between human thalamus and cortex using diffusion imaging .",
    "nature neuroscience 6(7):750757    behrens tej , woolrich mw , jenkinson m , johansen - berg h , nunes rg , clare s , matthews pm , brady jm , smith sm ( 2003 ) characterization and propagation of uncertainty in diffusion - weighted mr imaging .",
    "magnetic resonance in medicine 50(5):10771088          cichocki a , mandic d , de  lathauwer l , zhou g , zhao q , caiafa c , phan ah ( 2015 ) tensor decompositions for signal processing applications : from two - way to multiway component analysis . ieee signal processing magazine 32:145163    cook p , bai y , nedjati - gilani s , seunarine kk , hall mg , parker gj , alexander dc ( 2006 ) camino : open - source diffusion - mri reconstruction and processing . in : 14th scientific meeting of the international society for magnetic resonance in medicine , seattle          fillard p , descoteaux m ,",
    "goh a , gouttard s , jeurissen b , malcolm j , ramirez - manzanares a , reisert m , sakaie k , tensaouti f , yo t , mangin jf , poupon c ( 2011 ) quantitative evaluation of 10 tractography algorithms on a realistic diffusion mr phantom .",
    "neuroimage 56(1):220234            garyfallidis e , brett m , amirbekian b , rokem a , van  der walt s , descoteaux m , nimmo - smith i , nimmo - smith i ( 2014 ) dipy , a library for the analysis of diffusion mri data .",
    "frontiers in neuroinformatics 8:88      gomez j , pestilli f , witthoft n , golarai g , liberman a , poltoratski s , yoon j , grill - spector k ( 2015 ) functionally defined white matter reveals segregated pathways in human ventral temporal cortex associated with category - specific processing . neuron 85(1):216227    gorgolewski k , burns cd , madison c , clark d , halchenko yo , waskom ml , ghosh ss ( 2011 ) nipype : a flexible , lightweight and extensible neuroimaging data processing framework in python .",
    "frontiers in neuroinformatics 5:1313      jbabdi s , bellec p , toro r , daunizeau j , plgrini - issac m , benali h ( 2008 ) accurate anisotropic fast marching for diffusion - based geodesic tractography .",
    "international journal of biomedical imaging 2008(1 - 2):112    jiang h , van zijl pcm , kim j , pearlson gd , mori s ( 2006 ) dtistudio : resource program for diffusion tensor computation and fiber bundle tracking . computer methods and programs in biomedicine 81(2):106116              lazar m , weinstein dm , tsuruda js , hasan km , arfanakis k ,",
    "meyerand me , badie b , rowley ha , haughton v , field a , alexander al ( 2003 ) white matter tractography using diffusion tensor deflection .",
    "human brain mapping 18(4):306321",
    "li l , rilling jk , preuss tm , glasser mf , damen fw , hu x ( 2012 ) quantitative assessment of a framework for creating anatomical brain networks via global tractography . human brain mapping journal 61(4):10171030        parker gjm , stephan ke , barker gj , rowe jb , macmanus dg , wheeler - kingshott cam , ciccarelli o , passingham re , spinks rl , lemon rn ( 2002 ) initial demonstration of in vivo tracing of axonal projections in the macaque brain and comparison with the human brain using diffusion tensor imaging and fast marching tractography .",
    "neuroimage 15(4):797809    parker gjm , haroon ha , wheeler - kingshott cam ( 2003 ) a framework for a streamline - based probabilistic index of connectivity ( pico ) using a structural interpretation of mri diffusion measurements .",
    "journal of magnetic resonance imaging 18(2):242254                  scott a , courtney w , wood d , de  la garza r , lane s , king m , wang r , roberts j , turner ja , calhoun vd ( 2011 ) coins : an innovative informatics and neuroimaging tool suite built for large heterogeneous datasets .",
    "frontiers in neuroinformatics 5:3333      sherbondy a , dyrby t , rowe m , ptito m ( 2011 ) microstructure tracking ( microtrack ) : an algorithm for estimating a multiscale hierarchical white matter model from diffusion - weighted mri . in : proceedings of the 19th international society for magnetic resonance in medicine , montreal      sherbondy aj ,",
    "dougherty rf , ananthanarayanan r , modha ds , wandell ba ( 2009 ) think global , act local ; projectome estimation with bluematter .",
    "audio , transactions of the ire professional group on 12(pt 1):861868    smith sm , jenkinson m , johansen - berg h , rueckert d , nichols te , mackay ce , watkins ke , ciccarelli o , cader mz , matthews pm , behrens tej ( 2006 ) tract - based spatial statistics : voxelwise analysis of multi - subject diffusion data .",
    "neuroimage 31(4):14871505          thomas c , ye fq , irfanoglu mo , modi p , saleem ks , leopold da , pierpaoli c ( 2014 ) anatomical accuracy of brain connections derived from diffusion mri tractography is inherently limited .",
    "proceedings of the national academy of sciences 111(46):16,57416,579                yeatman jd , weiner ks , pestilli f , rokem a , mezer a , wandell ba ( 2014 ) the vertical occipital fasciculus : a century of controversy resolved by in vivo measurements .",
    "proceedings of the national academy of sciences 111(48):e5214e5223    yendiki a , panneck p , srinivasan p , stevens a , zllei l , augustinack j , wang r , salat d , ehrlich s , behrens t , jbabdi s , gollub r , fischl b ( 2011 ) automated probabilistic reconstruction of white - matter pathways in health and disease using an atlas of the underlying anatomy .",
    "frontiers in neuroinformatics 5:2323      zhang s , laidlaw dh ( 2006 ) sampling dti fibers in the human brain based on dwi forward modeling .",
    "international conference of the ieee engineering in medicine and biology society proceedings 1:48854888    zhang y , zhang j , oishi k , faria av , jiang h , li x , akhter k , rosa - neto p , pike gb , evans a , toga aw , woods r , mazziotta jc , miller mi , van zijl pcm , mori s ( 2010 ) atlas - guided tract reconstruction for automated and comprehensive examination of the white matter anatomy .",
    "neuroimage 52(4):12891301      zuo xn , anderson js , bellec p , birn rm , biswal bb , blautzik j , breitner jcs , buckner rl , calhoun vd , castellanos fx , chen a , chen b , chen j , chen x , colcombe sj , courtney w , craddock rc , di  martino a , dong hm , fu x , gong q , gorgolewski kj , han y , he y , he y , ho e , holmes a , hou xh , huckins j , jiang t , jiang y , kelley w , kelly c , king m , laconte sm , lainhart je , lei x , li hj , li k , li k , lin q , liu d , liu j , liu x , liu y , lu g , lu j , luna b , luo j , lurie d , mao y ,",
    "margulies ds , mayer ar , meindl t , meyerand me , nan w , nielsen ja , oconnor d , paulsen d , prabhakaran v , qi z , qiu j , shao c , shehzad z , tang w , villringer a , wang h , wang k , wei d , wei gx , weng xc , wu x , xu t , yang n , yang z , zang yf , zhang l , zhang q , zhang z , zhang z , zhao k , zhen z , zhou y , zhu xt , milham mp ( 2014 ) an open science resource for establishing reliability and reproducibility in functional connectomics .",
    "scientific data 1:140,049"
  ],
  "abstract_text": [
    "<S> the number of neuroimaging data sets publicly available is growing at fast rate . </S>",
    "<S> the increase in availability and resolution of neuroimaging data requires modern approaches to signal processing for data analysis and results validation . </S>",
    "<S> we introduce the application of sparse multiway decomposition methods @xcite to linearized neuroimaging models . </S>",
    "<S> we show that decomposed models are more compact but as accurate as full models and can be successfully used for fast data analysis . </S>",
    "<S> we focus as example on a recent model for the evaluation of white matter connectomes @xcite . </S>",
    "<S> we show that the multiway decomposed model achieves accuracy comparable to the full model , while requiring only a small fraction of the memory and compute time . </S>",
    "<S> the approach has implications for a majority of neuroimaging methods using linear approximations to measured signals .    </S>",
    "<S> * keywords . * brain anatomy , big data , brain mapping , brain networks , connectomics , high - performance computing , individualized medicine , myeline , personalized medicine , precision medicine , tensor decomposition .    2 </S>"
  ]
}