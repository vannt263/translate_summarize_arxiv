{
  "article_text": [
    "geometric integrators are numerical methods that preserve geometric structures and properties of the flow of a differential equation .",
    "structure - preserving integrators have attracted considerable interest due to their excellent numerical behavior , especially for long - time integration of equations possessing geometric properties ( see @xcite , @xcite , @xcite ) .    an important class of structure - preserving integrators",
    "are _ variational integrators _ ( see @xcite ) .",
    "this type of numerical schemes is based on discrete variational principles and provides a natural framework for the discretization of lagrangian systems , including forced , dissipative , or constrained ones .",
    "variational integrators were introduced in the context of finite - dimensional mechanical systems , but were later generalized to lagrangian field theories ( see @xcite ) and applied in many computations , for example in elasticity ( @xcite ) , electrodynamics ( @xcite ) , or fluid dynamics ( @xcite ) .",
    "theoretical aspects of variational integration are well understood in the case when the lagrangian describing the considered system is regular , that is , when the corresponding legendre transform is ( at least locally ) invertible .",
    "however , the corresponding theory for degenerate lagrangian systems is less developed .",
    "the analysis of degenerate systems becomes a little more cumbersome , because the euler - lagrange equations may cease to be second order , or may not even make any sense at all . in the latter case one needs to determine if there exists a submanifold of the configuration bundle @xmath0 on which consistent equations of motion can be derived",
    "this can be accomplished by applying the dirac theory of constraints or the pre - symplectic constraint algorithm ( see @xcite , @xcite ) .",
    "a particularly simple case of degeneracy occurs when the lagrangian is linear in velocities . in that case",
    ", the dynamics of the system is defined on the configuration manifold @xmath1 itself , rather than its tangent bundle @xmath0 , provided that some regularity conditions are satisfied .",
    "such systems arise in many physical applications , including interacting point vortices in the plane ( see @xcite , @xcite , @xcite ) , or partial differential equations such as the nonlinear schrdinger ( @xcite ) , kdv ( @xcite , @xcite ) or camassa - holm equations ( @xcite , @xcite ) . in section  [ sec : numerical experiments ] we show how certain poisson systems can be recast as lagrangian systems whose lagrangians are linear in velocities",
    ". therefore , our approach offers a new perspective on geometric integration of poisson systems , which often arise as semi - discretizations of integrable nonlinear partial differential equations , e.g. , the toda or volterra lattice equations , and play an important role in the modeling of many physical phenomena ( see @xcite , @xcite , @xcite ) .",
    "this paper is organized as follows . in section  [ sec : geometric setup ] we introduce a proper geometric setup and discuss the properties of systems that are linear in velocities . in section  [ sec : veselov discretization and discrete mechanics ] we analyze the general properties of variational integrators and point out how the relevant theory differs from the non - degenerate case . in section",
    "[ sec : variational partitioned runge - kutta methods ] we introduce variational partitioned runge - kutta methods and discuss their relation to numerical integration of differential - algebraic systems . in section  [ sec : numerical experiments ] we present the results of our numerical experiments for kepler s problem , a system of two interacting vortices , and the lotka - volterra model .",
    "we summarize our work and discuss possible extensions in section  [ sec : summary ] .",
    "let @xmath1 be the configuration manifold and @xmath0 its tangent bundle . throughout this work",
    "we will assume that the dimension of the configuration manifold @xmath2 is even .",
    "we will further assume @xmath1 is a vector space and by a slight abuse of notation we will denote by @xmath3 both an element of @xmath1 and the vector of its coordinates @xmath4 in a local chart on @xmath1 .",
    "it will be clear from the context which definition is invoked .",
    "consider the lagrangian @xmath5 given by    @xmath6    where @xmath7 is a smooth one - form , @xmath8 is the hamiltonian , and @xmath9 .",
    "let @xmath10 denote canonical coordinates on @xmath0 , where @xmath11 . in these coordinates we can consider    @xmath12    where summation over repeated greek indices is implied .",
    "the lagrangian is degenerate , since the associated legendre transform    @xmath13    is not invertible .",
    "the local representation of the legendre transform is    @xmath14    that is ,    @xmath15    where @xmath16 denote canonical coordinates on @xmath17 .",
    "the dynamics is defined by the action functional    @xmath18 = \\int_{a}^{b } l\\big(q(t),\\dot q(t)\\big)\\,dt\\ ] ]    and hamilton s principle , which seeks the curves @xmath19 such that the functional @xmath20 $ ] is stationary under variations of @xmath19 with fixed endpoints , i.e. , we seek @xmath19 such that    @xmath21 \\cdot \\delta q(t)=\\frac{d}{d\\epsilon } \\bigg|_{\\epsilon=0}s[q_\\epsilon(t)]=0\\end{aligned}\\ ] ]    for all @xmath22 with @xmath23 , where @xmath24 is a smooth family of curves satisfying @xmath25 and @xmath26 .",
    "the resulting euler - lagrange equations    @xmath27    form a system of _ first - order _ odes , where we assume that the even - dimensional antisymmetric matrix @xmath28 is invertible for all @xmath29 . without loss of generality",
    "we can further assume that the coordinate mapping @xmath30 is invertible and its inverse is smooth : if the jacobian @xmath31 is singular , we can redefine @xmath32 , where @xmath33 are arbitrary functions ; the euler - lagrange equations remain the same , and with the right choice of the functions @xmath33 , the redefined jacobian can be made nonsingular . using @xmath34 , eq .",
    "can be equivalently written as the poisson system    @xmath35    the euler - lagrange equations can also be formulated as the implicit hamiltonian system    @xmath36    since the lagrangian @xmath37 is degenerate , is an index-1 system of differential - algebraic equations ( dae ) , rather than a hamiltonian ode system : the legendre transform is an algebraic equation and has to be differentiated once with respect to time in order to turn this system into .",
    "this reflects the fact that the evolution of the considered degenerate system takes place on the _ primary constraint _ @xmath38 .",
    "it is easy to see that the primary constraint @xmath39 is ( locally ) diffeomorphic to the configuration manifold @xmath1 , where the diffeomorphism @xmath40 is locally , in the coordinates on @xmath17 , given by    @xmath41    where by a slight abuse of notation @xmath42 .",
    "this shows that @xmath43 can also be used as local coordinates on @xmath39 .",
    "note that @xmath44 is simply the restriction of @xmath45 to @xmath39 , i.e. , @xmath46 .",
    "the spaces @xmath1 , @xmath0 , @xmath17 and @xmath39 can be equipped with several symplectic or pre - symplectic forms .",
    "it is instructive to investigate the relationships between them in order to later avoid confusion regarding the sense in which variational integrators for lagrangians linear in velocities are symplectic . on the configuration space",
    "@xmath1 we can define the two - form    @xmath47    which in local coordinates can be expressed as    @xmath48    the two - form @xmath49 is symplectic if it is nondegenerate , i.e. , if the matrix @xmath50 is invertible for all @xmath3 .",
    "the cotangent bundle @xmath17 is equipped with the canonical cartan one - form @xmath51 , which is intrinsically defined by the formula    @xmath52    for any @xmath53 , where @xmath54 is the cotangent bundle projection . in canonical coordinates",
    "we have    @xmath55    we further have the canonical symplectic two - form    @xmath56    the symplectic forms @xmath49 and @xmath57 are related by    @xmath58    this follows from the simple calculation    @xmath59    where we used and the fact that @xmath60 .",
    "hence @xmath61 , and taking the exterior derivative on both sides we obtain .    using the legendre",
    "transform we can define the lagrangian two - form @xmath62 on @xmath0 by @xmath63 , which in canonical coordinates @xmath64 is given by    @xmath65    the lagrangian form @xmath62 is only pre - symplectic , because it is degenerate . noting that @xmath66 , where @xmath67 is the tangent bundle projection , we can relate @xmath49 and @xmath62 through the formula    @xmath68    the symplectic structure on @xmath39 can be introduced in two ways : by pushing forward @xmath49 from @xmath1 , or pulling back @xmath57 from @xmath17 .",
    "both ways are equivalent    @xmath69    where @xmath70 is the inclusion map .",
    "this follows from the calculation    @xmath71    where we used @xmath72 .",
    "if we use @xmath43 as coordinates on @xmath39 , then the local representation of @xmath73 will be given by .",
    "let @xmath74 denote the flow of or .",
    "this flow is symplectic on @xmath1 , that is    @xmath75    this fact can be proven by considering the hamiltonian or poisson properties of equation or equation ( see @xcite , @xcite ) .",
    "it also follows directly from the action principle ( see @xcite ) .",
    "since the lagrangian is degenerate , the dynamics of the system is defined on @xmath1 rather than @xmath0 .",
    "however , we can obtain the associated flow on @xmath0 through lifting @xmath76 by its tangent map @xmath77 .",
    "this flow preserves the lagrangian two - form    @xmath78    this can be seen from the calculation    @xmath79    where we used , , and the property @xmath80 .",
    "the flow @xmath76 induces the flow @xmath81 in a natural way as    @xmath82    this flow is symplectic on @xmath39 , i.e. ,    @xmath83    which can be established through the simple calculation    @xmath84    where we used and .",
    "the flow @xmath85 can be interpreted as the symplectic flow for the hamiltonian dae .",
    "for a veselov - type discretization we consider the discrete state space @xmath86 , which serves as a discrete approximation of the tangent bundle ( see @xcite ) .",
    "we define a discrete lagrangian @xmath87 as a smooth map @xmath88 and the corresponding discrete action    @xmath89    the variational principle now seeks a sequence @xmath90 , @xmath91 , @xmath92 , @xmath93 that extremizes @xmath94 for variations holding the endpoints @xmath90 and @xmath93 fixed .",
    "the discrete euler - lagrange equations follow    @xmath95    assuming that these equations can be solved for @xmath96 , i.e. , @xmath87 is non - degenerate , they implicitly define the discrete lagrangian map @xmath97 such that @xmath98 .",
    "let @xmath99 denote local coordinates on @xmath100 .",
    "we can define the discrete legendre transforms @xmath101 , which in local coordinates on @xmath100 and @xmath17 are respectively given by    @xmath102    where @xmath4 and @xmath103 .",
    "the discrete euler - lagrange equations can be equivalently written as    @xmath104    using either of the transforms , one can define the discrete lagrange two - form on @xmath86 by @xmath105 , which in coordinates gives    @xmath106    it then follows that the discrete flow @xmath107 is symplectic , i.e. , @xmath108 . using the legendre transforms we can pass to the cotangent bundle and define the discrete hamiltonian map @xmath109 by @xmath110 .",
    "this map is also symplectic , i.e. , @xmath111 .      to relate discrete and continuous mechanics",
    "it is necessary to introduce a timestep @xmath112 . if the continuous lagrangian @xmath37 is non - degenerate , it is possible to define a particular choice of discrete lagrangian which gives an exact correspondence between discrete and continuous systems ( see @xcite ) , the so - called _ exact discrete lagrangian _    @xmath113    where @xmath114 is the solution to the continuous euler - lagrange equations associated with @xmath37 such that it satisfies the boundary conditions @xmath115 and @xmath116 .",
    "note , however , that in the case of a regular lagrangian the associated euler - lagrange equations are second order , therefore boundary value problems are solvable , at least for sufficiently small @xmath117 and @xmath118 sufficiently close to @xmath3 . in the case of the lagrangian",
    "the associated euler - lagrange equations are first order in time , therefore we have the freedom to choose an initial condition either at @xmath119 or @xmath120 , but not both . an exact discrete lagrangian analogous to can not thus be defined on whole @xmath86",
    ". we will therefore assume the following definition :    let @xmath121 be the graph of @xmath122 .",
    "the exact discrete lagrangian @xmath123 for the lagrangian is    @xmath124    where @xmath114 is the solution to that satisfies the initial condition @xmath115 .",
    "note that in this definition we automatically have @xmath116 .",
    "as mentioned , the purpose of introducing an exact discrete lagrangian is to establish an exact correspondence between the continuous and discrete systems . for a regular lagrangian @xmath37 and its exact discrete lagrangian @xmath125",
    ", one can show that the exact discrete hamiltonian map @xmath126 is equal to @xmath127 , where @xmath85 is the symplectic flow for the hamiltonian system associated with @xmath37 .",
    "the problem is that the exact discrete lagrangian is not defined on the whole space @xmath100 , so the discrete euler - lagrange equations do not make sense , and it is not entirely clear how to define the associated discrete lagrangian map @xmath128 .",
    "one possible way to deal with this issue is to consider a singular perturbation problem .",
    "assume that @xmath1 is a riemannian manifold equipped with the nondegenerate scalar product @xmath129 .",
    "define the @xmath130-regularized lagrangian    @xmath131    or in coordinates    @xmath132    where @xmath133 denotes the local coordinates of the metric tensor . without loss of generality",
    "assume that in the chosen coordinates @xmath134 and @xmath135 if @xmath136 . for @xmath137",
    "this lagrangian is nondegenerate and the legendre transform @xmath138 is given by    @xmath139    that is ,    @xmath140    the euler - lagrange equations    @xmath141    are second order .",
    "the corresponding hamiltonian equations ( in implicit form ) are    @xmath142    there is no reason to expect that the solutions of or unconditionally approximate the solutions of or , respectively .",
    "the equations form a system of first - order ordinary differential equations , and therefore it is possible to specify arbitrary initial conditions @xmath143 and @xmath144 , whereas initial conditions for have to satisfy the algebraic constraint @xmath145 . under certain restrictive analytic assumptions , for some singular perturbation problems it is possible to show that , in order to satisfy the initial conditions , the solutions initially develop a steep boundary layer , but then rapidly converge to the solution of the corresponding dae system ( see @xcite ) . on the other hand , for other singular perturbation problems , when the initial conditions do not satisfy the algebraic constraint",
    ", it may happen that the solutions do not converge to the solution of the dae , but instead rapidly oscillate ( see @xcite , @xcite ) .",
    "we expect the latter behavior for , as will be demonstrated by a simple example in section  [ sec : example ] .",
    "since our main goal here is to show how the notion of a discrete legendre transform can be introduced for the exact discrete lagrangian , we will make two intuitive , although nontrivial , assumptions .",
    "we refer the interested reader to @xcite and @xcite for techniques that can be used to prove these statements rigorously .",
    "[ ass : initial value problem assumption ] let @xmath146 and @xmath147 be the unique smooth solutions of and on the interval @xmath148 $ ] satisfying the initial conditions @xmath143 , @xmath149 and @xmath150 , where @xmath151",
    ". then @xmath152 , @xmath153 and @xmath154 , @xmath155 uniformly on @xmath148 $ ] as @xmath156 .",
    "[ ass : boundary value problem assumption ] let @xmath19 be the unique smooth solution of on the interval @xmath148 $ ] satisfying the initial condition @xmath143 and let @xmath157 be the unique smooth solution of on the interval @xmath148 $ ] satisfying the boundary conditions @xmath149 , @xmath158 , where @xmath159",
    ". then @xmath152 and @xmath154 uniformly on @xmath148 $ ] as @xmath156 .",
    "with these assumption one can easily see that    @xmath160    where @xmath161 is the exact discrete lagrangian for .      since @xmath162 is regular , @xmath161 is properly defined on the whole space @xmath100 ( or at least in a neighborhood of @xmath163 ) and the associated exact discrete legendre transforms satisfy the properties ( see @xcite )    @xmath164    where @xmath165 is the solution to the regularized euler - lagrange equations satisfying the boundary conditions @xmath166 and @xmath167 , and we denoted @xmath168 , @xmath169 . in the spirit of",
    ", we can assume the following definitions of the exact discrete legendre transforms @xmath170    @xmath171    where @xmath172 and @xmath173 by uniform convergence of @xmath174 .",
    "note that @xmath175 , where @xmath176 and @xmath177 are projections ( both @xmath178 are diffeomorphisms ) .",
    "this is a close analogy to @xmath179 ( see section  [ sec : geometric setup ] ) .",
    "we also note the property    @xmath180    where @xmath114 is the solution of satisfying the initial condition @xmath115 .",
    "this further indicates that our definition of the exact discrete legendre transforms is sensible .",
    "note that @xmath181 .",
    "it is convenient to redefine @xmath182 , that is @xmath183 , so that both transforms are diffeomorphisms between @xmath163 and @xmath39 .",
    "the discrete euler - lagrange equations for @xmath125 can be obtained as the limit of the discrete euler - lagrange equations for @xmath161 , that is , one can substitute @xmath161 in and take the limit @xmath156 on both sides to obtain    @xmath184    this equation implicitly defines the exact discrete lagrangian map @xmath185 , which , given our definitions , necessarily takes the form @xmath186 .",
    "using the discrete legendre transforms @xmath187 we can define the corresponding exact discrete hamiltonian map @xmath188 as @xmath189 .",
    "the simple calculation    @xmath190    shows that the discrete hamiltonian map associated with the exact discrete lagrangian @xmath125 is equal to the hamiltonian flow @xmath127 for , i.e. , the evolution of the discrete systems described by @xmath125 coincides with the evolution of the continuous system described by @xmath37 at times @xmath191 , @xmath192      let us illustrate these ideas with a very simple example for which analytic solutions are known .",
    "let @xmath193 and let @xmath194 denote local coordinates on @xmath1 .",
    "the tangent bundle is @xmath195 , and the induced local coordinates are @xmath196 .",
    "consider the lagrangian    @xmath197    the corresponding euler - lagrange equations are simply    @xmath198    so the flow @xmath199 is the identity , i.e. , @xmath200 .",
    "let @xmath201 denote canonical coordinates on the cotangent bundle @xmath202 .",
    "the legendre transform is    @xmath203    let @xmath117 be a timestep .",
    "note @xmath204 .",
    "the exact discrete lagrangian is therefore    @xmath205    let us now consider the @xmath130-regularized lagrangian    @xmath206    the corresponding euler - lagrange equations take the form    @xmath207    one can easily verify analytically that    @xmath208 & + \\frac{1}{2}\\bigg [ ( y_f - y_i)+(x_f - x_i ) \\cot \\frac{t}{2 \\epsilon}\\bigg ] \\sin \\frac{t}{\\epsilon } \\nonumber \\\\   & - \\frac{1}{2}\\bigg [ ( x_f - x_i)-(y_f - y_i ) \\cot \\frac{t}{2 \\epsilon}\\bigg ] \\cos \\frac{t}{\\epsilon } , \\nonumber \\\\",
    "y^\\epsilon(t ) = \\frac{1}{2}\\bigg [ ( y_i+y_f)+(x_f - x_i ) \\cot \\frac{t}{2 \\epsilon}\\bigg ] & -\\frac{1}{2}\\bigg [ ( x_f - x_i)-(y_f - y_i ) \\cot \\frac{t}{2 \\epsilon}\\bigg ] \\sin \\frac{t}{\\epsilon } \\nonumber \\\\   & - \\frac{1}{2}\\bigg [ ( y_f - y_i)+(x_f - x_i ) \\cot \\frac{t}{2 \\epsilon}\\bigg ] \\cos \\frac{t}{\\epsilon},\\end{aligned}\\ ] ]    is the solution to satisfying the boundary conditions @xmath209 and @xmath210 .",
    "note that if @xmath211 or @xmath212 , then as @xmath156 this solution is rapidly oscillatory and not convergent .",
    "however , if @xmath213 ( cf .",
    "assumption  [ ass : boundary value problem assumption ] ) then we have    @xmath214    and this solution converges uniformly ( in this simple example it is in fact equal ) to the solution of with the same initial condition .",
    "we can also find an analytic expression for the exact discrete lagrangian associated with as    @xmath215    restricting the domain to @xmath163 we get @xmath216 , and comparing to we verify that indeed holds .",
    "the discrete legendre transforms associated with @xmath161 take the form    @xmath217    restricting the domain to @xmath163 and taking the limit @xmath156 as in , we can define the exact discrete legendre transforms associated with    @xmath218    comparing with , we see that the property is satisfied , which replicates the analogous property for regular lagrangians .      for a given continuous system described by the lagrangian @xmath37 ,",
    "a variational integrator is constructed by choosing a discrete lagrangian @xmath87 which approximates the exact discrete lagrangian @xmath125 .",
    "we can define the order of accuracy of the discrete lagrangian in a way similar to that for discrete lagrangians resulting from regular continuous lagrangians ( see @xcite ) .",
    "a discrete lagrangian @xmath219 is of order @xmath220 if there exists an open subset @xmath221 with compact closure and constants @xmath222 and @xmath223 such that    @xmath224    for all solutions @xmath19 of the euler - lagrange equations with initial conditions @xmath225 and for all @xmath226 .",
    "we will always assume that the discrete lagrangian @xmath87 is non - degenerate , so that the discrete euler - lagrange equations can be solved for @xmath96 .",
    "this defines the discrete lagrangian map @xmath227 and the associated discrete hamiltonian map @xmath228 , as in section  [ sec : discrete mechanics ] .",
    "of particular interest is the rate of convergence of @xmath229 to @xmath127 .",
    "one usually considers a _ local error _",
    "( error made after one step ) and a _ global error _ ( error made after many steps )",
    ". we will assume the following definitions , which are appropriate for differential - algebraic systems ( see @xcite , @xcite , @xcite , @xcite ) .",
    "a discrete hamiltonian map @xmath229 is of order @xmath220 if there exists an open set @xmath230 and constants @xmath222 and @xmath231 such that    @xmath232    for all @xmath233 and @xmath234 .",
    "[ thm : definition of the order of convergence ] a discrete hamiltonian map @xmath229 is convergent of order @xmath220 if there exists an open set @xmath230 and constants @xmath222 , @xmath231 and @xmath235 such that    @xmath236    where @xmath237 , for all @xmath233 , @xmath234 , and @xmath238 .    if the lagrangian @xmath37 is regular , then one can show that a discrete lagrangian @xmath87 is of order @xmath220 if and only if the corresponding hamiltonian map @xmath229 is of order @xmath220 ( see @xcite ) .",
    "also , the associated hamiltonian equations are a set of ordinary differential equations , and under some smoothness assumptions one can show that if @xmath229 is of order @xmath220 , then it is also convergent of order @xmath220 ( see @xcite ) . however ,",
    "in the case of the lagrangian it is not true in general  both the order of the discrete lagrangian and the local order of the discrete hamiltonian map may be different than the actual global order of convergence ( see @xcite , @xcite ) , as will be demonstrated in section  [ sec : variational partitioned runge - kutta methods ] .",
    "[ [ example - midpoint - rule . ] ] example : midpoint rule .",
    "+ + + + + + + + + + + + + + + + + + + + + + +    in a simple example we will demonstrate that the variational order of accuracy of a discretization method is unaffected by a degeneracy of a lagrangian @xmath37 . in order to calculate the order of a discrete lagrangian @xmath87",
    ", we can expand @xmath239 in a taylor series in @xmath117 and compare it to the analogous expansion for @xmath125 . if the two expansions agree up to @xmath220 terms , then @xmath87 is of order @xmath220 . expanding @xmath19 in a taylor series about @xmath119 and substituting it in , we get the expression    @xmath240    where we denoted @xmath241 , @xmath242 , etc . , and the lagrangian l and its derivatives are computed at @xmath243 . for the lagrangian the values of @xmath244 , @xmath245 , @xmath246",
    "are determined by differentiating sufficiently many times and substituting the initial condition @xmath247 .",
    "note that in case of regular lagrangians the value of @xmath244 is determined by the boundary conditions @xmath247 , @xmath248 , and the higher - order derivatives by differentiating the corresponding euler - lagrange equations , but apart from that the expression remains qualitatively unaffected .",
    "the _ midpoint rule _ is an integrator obtained by defining the discrete lagrangian    @xmath249    calculating the expansion in @xmath117 yields    @xmath250    comparing this to shows that the discrete lagrangian defined by the midpoint rule is second order regardless of the degeneracy of @xmath37 .",
    "however , as mentioned before , if @xmath37 is degenerate we can not conclude about the global order of convergence of the corresponding discrete hamiltonian map .",
    "the midpoint rule can be formulated as a runge - kutta method , namely the 1-stage gauss method .",
    "we discuss gauss and other runge - kutta methods and their convergence properties in more detail in section  [ sec : variational partitioned runge - kutta methods ] .",
    "note that low - order variational integrators for lagrangians based on the midpoint rule have been studied in @xcite and @xcite in the context of the dynamics of point vortices .",
    "to construct higher - order variational integrators one may consider a class of partitioned runge - kutta ( prk ) methods .",
    "variational partitioned runge - kutta ( vprk ) methods for regular lagrangians are described in @xcite and @xcite . in this section",
    "we show how vprk methods can be applied to systems described by lagrangians such as . as in the case of regular lagrangians",
    ", we will construct an @xmath251-stage variational partitioned runge - kutta integrator for the lagrangian by considering the discrete lagrangian    @xmath252    where the internal stages @xmath253 , @xmath254 , @xmath255 , satisfy the relation    @xmath256    and are chosen so that the right - hand side of is extremized under the constraint    @xmath257    a variational integrator is then obtained by forming the corresponding discrete euler - lagrange equations .",
    "the @xmath251-stage variational partitioned runge - kutta method based on the discrete lagrangian with the coefficients @xmath258 and @xmath259 is equivalent to the following partitioned runge - kutta method applied to the hamiltonian dae :    [ eq : prk for dae ] @xmath260^t \\dot q_i - dh(q_i ) , } \\qquad \\qquad \\qquad i=1,\\ldots , s,\\\\ \\label{eq : prk for dae 2 } \\dot p^i & =   [ d\\alpha(q_i)]^t \\dot q_i - dh(q_i ) , \\qquad \\qquad \\qquad \\ !",
    "i=1,\\ldots , s , \\\\",
    "\\label{eq : prk for dae 3 } q_i & = q + h \\sum_{j=1}^s a_{ij } \\dot q_j , \\phantom{-dh(q_i ) , } \\qquad \\qquad \\qquad i=1,\\ldots , s , \\\\",
    "\\label{eq : prk for dae 4 } p^i & = p + h \\sum_{j=1}^s \\bar a_{ij } \\dot p_j ,   \\phantom{-dh(q_i ) , } \\qquad \\qquad \\qquad \\ , i=1,\\ldots , s,\\\\ \\label{eq : prk for dae 5 } \\bar q & = q + h \\sum_{j=1}^s b_j \\dot q_j,\\\\ \\label{eq : prk for dae 6 } \\bar p & = p + h \\sum_{j=1}^s b_j \\dot p_j,\\end{aligned}\\ ] ]    where the coefficients satisfy the condition    @xmath261    and @xmath262 denote the current values of position and momentum , @xmath263 denote the respective values at the next time step , @xmath264 , @xmath265 , and @xmath253 , @xmath254 , @xmath266 , @xmath267 are the internal stages , with @xmath268 , and similarly for the others .",
    "see theorem  vi.6.4 in @xcite or theorem  2.6.1 in @xcite .",
    "the proof is essentially identical .",
    "the only qualitative difference is the fact that in our case the lagrangian is degenerate , so the corresponding hamiltonian system is in fact the index-1 differential - algebraic system rather than a typical system of ordinary differential equations .",
    "+    [ [ existence - and - uniqueness - of - the - numerical - solution . ] ] existence and uniqueness of the numerical solution .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    given @xmath3 and @xmath269 , one can use equations   to compute the new position @xmath118 and momentum @xmath270 .",
    "first , one needs to solve - for the internal stages @xmath253 , @xmath254 , @xmath266 , and @xmath267 .",
    "this is a system of @xmath271 equations for @xmath271 variables , but one has to make sure these equations are independent , so that a unique solution exists .",
    "one may be tempted to calculate the jacobian of this system for @xmath272 , and then use the implicit function theorem . however , even if we start with consistent initial values @xmath273 , the numerical solution @xmath274 for @xmath275 will only approximately satisfy the algebraic constraint ; so @xmath276 and @xmath277 can not be assumed to be the solution of - for @xmath272 , and consequently , the implicit function theorem will not yield a useful result .",
    "let us therefore regard @xmath3 and @xmath269 as @xmath117-dependent , as they result from the previous iterations of the method with the timestep @xmath117 .",
    "if the method is convergent , it is reasonable to expect that @xmath278 is small and converges to zero as @xmath117 is refined .",
    "the following approach was inspired by theorem  4.1 in @xcite .",
    "[ thm : existence of the numerical solution for prk ] let @xmath279 and @xmath45 be smooth in an @xmath117-independent neighborhood @xmath280 of @xmath3 and let the matrix    @xmath281    be invertible with the inverse bounded in @xmath282 , i.e. , there exists @xmath222 such that    @xmath283    where @xmath284 , @xmath285 , @xmath286 is the @xmath287 identity matrix , and @xmath288 denotes the block diagonal matrix    @xmath289    suppose also that @xmath262 satisfy    @xmath290    then there exists @xmath223 such that the nonlinear system - has a solution for @xmath226 .",
    "the solution is locally unique and satisfies    @xmath291    substitute and in and to obtain    @xmath292    for @xmath255 , where for notational convenience we left the @xmath253 s as arguments of @xmath45 , @xmath293 and @xmath294 , but we keep in mind they are defined by , so that is a nonlinear system for @xmath254 and @xmath267 .",
    "let us consider the homotopy    @xmath295    for @xmath255 .",
    "it is easy to see that for @xmath296 the system has the solution @xmath297 and @xmath298 , and for @xmath299 it is equivalent to .",
    "let us treat @xmath254 and @xmath267 as functions of @xmath300 , and differentiate with respect to this parameter .",
    "the resulting ode system can be written as    [ eq : ode system for dot qi and dot pi ] @xmath301    where for compactness we introduced the following notations : @xmath302 , similarly for @xmath303 ; @xmath304 is the @xmath251-dimensional vector of ones ; @xmath305 , and similarly , @xmath306 denotes the block diagonal matrix    @xmath307    with @xmath308 , where @xmath309 denotes the hessian matrix of the respective function , and summation over @xmath310 is implied .",
    "the system is further simplified if we substitute in . this way we obtain an ode system for the variables @xmath311 of the form    @xmath312 \\frac{d \\dot q}{d\\tau } = \\nonumber \\\\ & ( \\mathcal{\\bar{a } } \\mathbbm{1}_s)\\otimes dh(q ) - \\frac{1}{h}\\mathbbm{1}_s\\otimes\\big(p-\\alpha(q)\\big).\\end{aligned}\\ ] ]    since @xmath45 is smooth , we have    @xmath313_{ij } = a_{ij } d\\alpha(q_i ) = a_{ij } d\\alpha(q_j ) + o(\\delta ) = \\big [ ( \\mathcal{a}\\otimes i_n ) \\{d\\alpha\\ } \\big]_{ij } + o(\\delta),\\ ] ]    where @xmath314 for @xmath315 assumed small , but independent of @xmath117 . moreover , since @xmath45 and @xmath279 are smooth , the term @xmath306 , as a function of @xmath311 , is bounded in a neighborhood of 0 .",
    "therefore , we can write as    @xmath316 \\frac{d \\dot q}{d\\tau } = ( \\mathcal{\\bar{a } } \\mathbbm{1}_s)\\otimes dh(q ) - \\frac{1}{h}\\mathbbm{1}_s\\otimes\\big(p-\\alpha(q)\\big).\\end{aligned}\\ ] ]    by , for sufficiently small @xmath117 and @xmath315 , the matrix @xmath317 has a bounded inverse , provided that @xmath318 remain in @xmath280 .",
    "therefore , the ode with the initial condition @xmath319 has a unique solution @xmath320 on a non - empty interval @xmath321 , which can be extended until any of the corresponding @xmath322 leaves @xmath280 .",
    "let us argue that for a sufficiently small @xmath117 we have @xmath323 . given and",
    ", the ode implies that    @xmath324    therefore , we have    @xmath325    and further    @xmath326    for @xmath327 .",
    "this implies that all @xmath322 remain in @xmath280 for @xmath328 if @xmath117 is sufficiently small .",
    "consequently , the ode has a solution on the interval @xmath329 $ ] .",
    "then @xmath330 and @xmath331 satisfy the estimates , and are a solution to the nonlinear system - .",
    "the corresponding @xmath267 and @xmath266 can be computed using and , and the remaining estimates can be proved using the fact that @xmath45 and @xmath279 are smooth .",
    "this completes the proof of the existence of a numerical solution to - .    in order to prove local uniqueness , we substitute the second equation of in the first one to obtain a nonlinear system for @xmath254 , namely    @xmath332    for @xmath255 , where we again left the @xmath253 s for notational convenience .",
    "suppose there exists another solution @xmath333 that satisfies the estimates , and denote @xmath334 .",
    "based on the assumptions , we have @xmath335 , i.e. , it is at least bounded as @xmath336 .",
    "we will show that for sufficiently small @xmath117 we in fact have @xmath337",
    ". since @xmath338 satisfy , we have    @xmath339    for @xmath255 .",
    "subtract from , and linearize around @xmath254 . based on the fact that @xmath335 , and using the notation introduced before , we get    @xmath340 \\delta \\dot q + o(h^2 \\|\\delta \\dot q \\|).\\ ] ]    by a similar argument as before , for sufficiently small @xmath117 the matrix @xmath341 $ ] has a bounded inverse , therefore implies @xmath342 , that is ,    @xmath343    for some constant @xmath344 .",
    "note that for @xmath345 we have @xmath346 , and therefore @xmath347 , which completes the proof of the local uniqueness of a numerical solution to - .    .",
    "[ [ remarks . ] ] remarks .",
    "+ + + + + + + +    the condition may be tedious to verify , especially if one uses a runge - kutta method with many stages . however , this condition is significantly simplified in the following special cases :    1 .   for a non - partitioned runge - kutta method",
    "we have @xmath348 , and the condition is satisfied if @xmath349 is invertible , and the mass matrix @xmath350 , as defined in section  [ sec : equations of motion ] , is invertible in @xmath280 and its inverse is bounded .",
    "if @xmath351 is antisymmetric , then the condition is satisfied if @xmath352 is invertible , and the matrix @xmath353 is invertible in @xmath280 and its inverse is bounded .",
    "an interesting special case is obtained if we have , in some local chart on @xmath1 , @xmath355 for some constant matrix @xmath356 . without loss of generality",
    "assume that @xmath356 is invertible and antisymmetric .",
    "the lagrangian then takes the form    @xmath357    the euler - lagrange equations become    @xmath358    and the hamiltonian dae system is    @xmath359    let us consider a special case of the method with @xmath360 , i.e. , a non - partitioned runge - kutta method . applying it to we get    [ eq : prk for dae for linear alpha ] @xmath361",
    "since @xmath356 is antisymmetric and invertible , then by theorem  [ thm : existence of the numerical solution for prk ] the scheme yields a unique numerical solution to if the runge - kutta matrix @xmath362 is invertible .",
    "[ thm : equivalence with a rk for the ode ] suppose @xmath362 is invertible and @xmath363 . then the method is equivalent to the same runge - kutta method applied to .",
    "substitute and in , and use the fact @xmath363 to obtain    @xmath364    since @xmath349 is invertible , this implies    @xmath365    substituting this in yields    @xmath366    together with and , this gives a runge - kutta method for . moreover , substituting and @xmath363 in , and using , one has    @xmath367    that is , @xmath368 satisfy the algebraic constraint .",
    "+    [ thm : invariance of the primary constraint ] the numerical flow on @xmath17 defined by leaves the primary constraint @xmath39 invariant , i.e. , if @xmath369 , then @xmath370 .",
    "if the coefficients of the method satisfy the condition , then is a variational integrator and the associated discrete hamiltonian map @xmath229 is symplectic on @xmath17 , as explained in section  [ sec : discrete mechanics ] . given corollary  [ thm : invariance of the primary constraint ] , we further have :    [ thm : symplecticity on the primary constraint ] if the coefficients @xmath258 and @xmath259 in satisfy the condition , then the discrete hamiltonian map @xmath229 associated with is symplectic on the primary constraint @xmath39 , that is , @xmath371 .",
    "[ [ convergence . ] ] convergence .",
    "+ + + + + + + + + + + +    various runge - kutta methods and their classical orders of convergence , that is , orders of convergence when applied to ( non - stiff ) ordinary differential equations , are discussed in many textbooks on numerical analysis , for instance @xcite and @xcite . when applied to differential - algebraic equations , the order of convergence of a runge - kutta method may be reduced ( see @xcite , @xcite , @xcite ) . however , in the case of theorem  [ thm : equivalence with a rk for the ode ] implies that the classical order of convergence of non - partitioned runge - kutta methods is retained .",
    "[ thm : retention of the classical order of convergence ] a runge - kutta method with the coefficients @xmath258 and @xmath259 applied to the dae system retains its classical order of convergence .",
    "let @xmath220 be the classical order of the considered runge - kutta method , @xmath369 an initial condition , @xmath372 the exact solution to such that @xmath373 , and @xmath274 the numerical solution obtained by applying the method iteratively @xmath374 times with @xmath375 .",
    "theorem  [ thm : equivalence with a rk for the ode ] states that the method is equivalent to applying the same runge - kutta method to the ode system .",
    "hence , we obtain convergence of order @xmath220 in the @xmath3 variable , that is , for a fixed time @xmath376 and an integer @xmath377 such that @xmath378 , we have the estimate    @xmath379    for some constant @xmath222 ( cf .",
    "definition  [ thm : definition of the order of convergence ] ) . by corollary  [ thm : invariance of the primary constraint ] we know that @xmath380 , so we have the estimate    @xmath381    which completes the proof , since @xmath382 . +    of particular interest to us are runge - kutta methods that satisfy the condition , for instance symplectic diagonally - implicit runge - kutta methods ( dirk ) or gauss collocation methods ( see @xcite ) .",
    "the @xmath251-stage gauss method is of classical order @xmath383 , therefore we have :    [ thm : order of convergence of gauss methods ] the @xmath251-stage gauss collocation method applied to the dae system is convergent of order @xmath383 .",
    "as mentioned in section  [ sec : variational error analysis ] , the midpoint rule is a 1-stage gauss method , therefore it retains its classical second order of convergence .",
    "[ [ backward - error - analysis . ] ] backward error analysis .",
    "+ + + + + + + + + + + + + + + + + + + + + + + +    the system can be rewritten as the poisson system    @xmath384    with the structure matrix @xmath385 ( see @xcite , @xcite ) .",
    "the flow @xmath76 for this equation is a _ poisson map _ , that is , it satisfies the property    @xmath386^{t } = \\lambda^{-1},\\ ] ]    which is in fact equivalent to the symplecticity property or written in local coordinates on @xmath1 or @xmath39 , respectively .",
    "let @xmath387 represent the numerical flow defined by some numerical algorithm applied to .",
    "we say this flow is a _ poisson integrator _ if    @xmath388^{t } = \\lambda^{-1}.\\ ] ]    the left - hand side of can be regarded as a quadratic invariant of . by theorem",
    "[ thm : equivalence with a rk for the ode ] the method is equivalent to applying the same runge - kutta method to . if its coefficients also satisfy the condition , then it can be shown that the method preserves quadratic invariants ( see theorem  iv.2.2 in @xcite ) .",
    "therefore , we have :    [ thm : r - k methods as poisson integrators ] if @xmath362 is invertible , the coefficients @xmath258 and @xmath259 satisfy the condition , and @xmath363 , then the method is a poisson integrator for",
    ".    the true power of symplectic integrators for hamiltonian equations is revealed through their backward error analysis : a symplectic integrator for a hamiltonian system with the hamiltonian @xmath389 defines the _ exact _ flow for a nearby hamiltonian system , whose hamiltonian can be expressed as the asymptotic series    @xmath390    owing to this fact , under some additional assumptions , symplectic numerical schemes nearly conserve the original hamiltonian @xmath389 over exponentially long time intervals ( see @xcite for details ) .",
    "a similar result holds for poisson integrators for poisson systems : a poisson integrator defines the exact flow for a nearby poisson system , whose structure matrix is the same and whose hamiltonian has the asymptotic expansion ( see theorem  ix.3.6 in @xcite ) .",
    "therefore , we expect the non - partitioned runge - kutta schemes satisfying the condition to demonstrate good preservation of the original hamiltonian @xmath279 .",
    "see section  [ sec : numerical experiments ] for numerical examples .",
    "partitioned runge - kutta methods do not seem to have special properties when applied to systems with linear @xmath354 , therefore we describe them in the general case in section  [ sec : nonlinear alpha ] .",
    "when the coordinates @xmath354 are nonlinear functions of @xmath3 , then the runge - kutta methods discussed in section  [ sec : linear alpha ] lose some of their properties : a theorem similar to theorem  [ thm : equivalence with a rk for the ode ] can not be proved , most of the runge - kutta methods ( whether non - partitioned or partitioned ) do not preserve the algebraic constraint @xmath391 , i.e. , the numerical solution does not stay on the primary constraint @xmath39 , and therefore their order of convergence is reduced , unless they are _",
    "stiffly accurate_.      let us again consider non - partitioned methods with @xmath360 .",
    "convergence results for some classical runge - kutta schemes of interest can be obtained by transforming into a semi - explicit index-2 dae system .",
    "let us briefly review this approach .",
    "more details can be found in @xcite and @xcite .",
    "the system can be written as the quasi - linear dae    @xmath392    where @xmath393 and    @xmath394^t & -i_n \\\\ 0 & 0 \\\\ \\end{matrix } \\right ) , \\qquad\\qquad\\qquad f(y ) = \\left ( \\begin{matrix } dh(q ) \\\\",
    "p-\\alpha(q ) \\\\ \\end{matrix } \\right),\\ ] ]    where @xmath286 denotes the @xmath287 identity matrix .",
    "let us introduce a slack variable @xmath395 and rewrite as the index-2 dae system    [ eq : index 2 dae form ] @xmath396    this system is of index 2 , because it has @xmath397 dependent variables , but only @xmath398 differential equations , and some components of the algebraic equations have to be differentiated twice with respect to time in order to derive the missing differential equations for @xmath395 .",
    "note that @xmath399 is a singular matrix of constant rank @xmath400 , therefore it can be decomposed ( using gauss elimination or the singular value decomposition ) as    @xmath401    for some non - singular matrices @xmath402 and @xmath403 . since @xmath404 is assumed to be smooth , one can choose @xmath94 and @xmath405 so that they are also smooth ( at least in a neighborhood of @xmath406 ) .",
    "premultiplying both sides of by @xmath407 turns the dae into    [ eq : index 2 dae block form ] @xmath408    where we introduced the block structure @xmath409 , @xmath410 , and    @xmath411    since @xmath403 is invertible , we can assume without loss of generality that the block @xmath412 is invertible , too ( one can always permute the columns of @xmath403 otherwise ) .",
    "let us compute @xmath413 from and substitute it in .",
    "the resulting system ,    [ eq : index 2 dae final block form ] @xmath414    has the form of a semi - explicit index-2 dae    @xmath415    provided that    @xmath416    has a bounded inverse .",
    "it is an elementary exercise to show that the partitioned runge - kutta method is invariant under the presented transformation , that is , it defines a numerically equivalent partitioned runge - kutta method for .",
    "runge - kutta methods for semi - explicit index-2 daes have been studied and some convergence results are available .",
    "convergence estimates for the @xmath406 component of can be readily applied to the solution of .    as in section",
    "[ sec : linear alpha ] , of particular interest to us are variational runge - kutta methods , i.e. , methods satisfying the condition , for example gauss collocation methods ( see @xcite , @xcite ) .",
    "however , in the case when @xmath404 is a nonlinear function , the solution generated by the gauss methods does not stay on the primary constraint @xmath39 and this affects their rate of convergence , as will be shown below . for comparison",
    ", we will also consider the radau iia methods ( see @xcite ) , which , although not variational / symplectic , are _ stiffly accurate _ , that is , their coefficients satisfy @xmath417 for @xmath418 , so the numerical value of the solution at the new time step is equal to the value of the last internal stage , and therefore the numerical solution stays on the submanifold @xmath39 .",
    "we cite the following convergence rates for the @xmath406 component of after @xcite and @xcite :    * @xmath251-stage gauss method ",
    "convergent of order @xmath419 , * @xmath251-stage radau iia method ",
    "convergent of order @xmath420 .    with the exception of the midpoint rule ( @xmath421 )",
    ", we see that the order of convergence of the gauss methods is reduced . on the other hand ,",
    "the radau iia methods retain their classical order @xmath420 .",
    "[ [ symplecticity . ] ] symplecticity .",
    "+ + + + + + + + + + + + + +    since the gauss methods satisfy the condition , they generate a flow which preserves the canonical symplectic form @xmath57 on @xmath17 , as explained in section  [ sec : discrete mechanics ]",
    ". however , since the primary constraint @xmath39 is not invariant under this flow , a result analogous to corollary  [ thm : symplecticity on the primary constraint ] does not hold , i.e. , the flow is not symplectic on @xmath39 .      in section  [ sec : numerical experiments ]",
    "we present numerical results for the lobatto iiia - iiib methods ( see @xcite ) .",
    "their numerical performance appears rather unattractive , therefore our theoretical results regarding partitioned runge - kutta methods are less complete .",
    "below we summarize the experimental orders of convergence of the lobatto  iiia - iiib schemes that we observed in our numerical computations ( see figure  [ fig : convergence plots for kepler s problem ] , figure  [ fig : convergence plot for point vortices ] , and figure  [ fig : convergence plot for the lotka - volterra model ] ) :    * @xmath422-stage lobatto  iiia - iiib ",
    "inconsistent , * @xmath423-stage lobatto  iiia - iiib  convergent of order 2 , * @xmath424-stage lobatto  iiia - iiib  convergent of order 2",
    ".    comments regarding the symplecticity of these schemes are the same as for the gauss methods mentioned above in section  [ sec : runge - kutta methods ] .",
    "in this section we present the results of the numerical experiments we performed to test the methods discussed in section  [ sec : variational partitioned runge - kutta methods ] .",
    "we consider kepler s problem , the dynamics of planar point vortices , and the lotka - volterra model , and we show how each of these models can be formulated as a lagrangian system linear in velocities .      a particle or a planet moving in a central potential in two dimensions can be described by the hamiltonian    @xmath425    where @xmath194 denotes the position of the planet and @xmath426 its momentum ; @xmath427 is an arbitrary constant .",
    "the corresponding lagrangian can be obtained in the usual way as    @xmath428    if one performs the standard legendre transform @xmath429 , @xmath430 , then @xmath431 will take the usual nondegenerate form , quadratic in velocities .",
    "however , one can also introduce the variable @xmath432 and view @xmath433 as , that is , a lagrangian linear in velocities ( see  @xcite ) . comparing and",
    "we see that the corresponding @xmath356 is singular . without loss of generality",
    "we replace @xmath356 with its antisymmetric part @xmath434 , which is invertible , and consider the lagrangian    @xmath435    as a test problem we considered an elliptic orbit with eccentricity @xmath436 and semi - major axis @xmath437 .",
    "we took the initial condition at the pericenter , i.e. , @xmath438 , @xmath439 , @xmath440 , @xmath441 .",
    "this is a periodic orbit with period @xmath442 .",
    "a reference solution was computed by integrating until the time @xmath443 using verner s method ( a 6-th order explicit runge - kutta method ; see @xcite ) with the small time step @xmath444 .",
    "the reference solution is depicted in figure  [ fig : reference solution for kepler s problem ] .     using verner s method with the time step @xmath444.,scaledwidth=80.0% ]",
    "we solved the same problem using several of the methods discussed in section  [ sec : variational partitioned runge - kutta methods ] for a number of time steps ranging from @xmath445 to @xmath446 .",
    "the value of the solutions at @xmath443 was then compared against the reference solution .",
    "the max norm errors are depicted in figure  [ fig : convergence plots for kepler s problem ] .",
    "we see that the rates of convergence of the gauss and the 3-stage radau iia methods are consistent with theorem  [ thm : retention of the classical order of convergence ] and corollary  [ thm : order of convergence of gauss methods ] . for the lobatto iiia - iiib methods we observe a reduction of order .",
    "the 2-stage lobatto iiia - iiib method turns out to be inconsistent and is not depicted in figure  [ fig : convergence plots for kepler s problem ] .",
    "both the 3- and 4-stage methods converge only quadratically , while their classical orders of convergence are 4 and 6 , respectively .",
    "we also investigated the long - time behavior of our integrators and conservation of the hamiltonian . for convenience",
    ", we set @xmath447 in , so that @xmath448 on the considered orbit .",
    "we applied the gauss methods with the relatively large time step @xmath449 and computed the numerical solution until the time @xmath450 .",
    "figure  [ fig : energy plots for gauss methods for kepler s problem ] shows that the gauss integrators preserve the hamiltonian very well , which is consistent with corollary  [ thm : r - k methods as poisson integrators ] .",
    "we performed similar computations for the lobatto iiia - iiib and radau iia methods , also with @xmath449 .",
    "the results are depicted in figure  [ fig : energy plots for lobatto and radau methods for kepler s problem ] .",
    "the 3- and 4-stage lobatto iiia - iiib schemes result in instabilities , the planet s trajectory spirals down on the center of gravity , and the computations can not be continued too far in time . the hamiltonian shows major variations whose amplitude grows in time .",
    "the non - variational radau iia scheme yields an accurate solution , but it demonstrates a gradual energy dissipation .     over the time interval @xmath451 $ ] ( _ right column _ ) , with a close - up on the initial interval @xmath452 $ ] shown in the _ left column_.,scaledwidth=90.0% ]          point vortices in the plane are another interesting example of a system with linear @xmath354 ( see @xcite , @xcite , @xcite ) .",
    "a system of @xmath377 interacting point vortices in two dimensions can be described by the lagrangian    @xmath453    with the hamiltonian    @xmath454    where @xmath455 denotes the location of the @xmath456-th vortex , @xmath457 is its circulation , and @xmath427 is an arbitrary constant .    as a test problem we considered the system of @xmath458 vortices with circulations @xmath459 and @xmath460 , respectively , and distance @xmath461 between them .",
    "the vortices rotate on concentric circles about their center of vorticity at @xmath462 and @xmath463 .",
    "we took the initial condition at @xmath464 , @xmath465 , @xmath466 and @xmath467 .",
    "the analytic solution can be found ( see @xcite ) as    @xmath468    where @xmath469 .",
    "this is a periodic solution with period @xmath470 .",
    "see figure  [ fig : reference solution for point vortices ] .     and",
    "@xmath463.,scaledwidth=80.0% ]    we performed similar convergence tests as in section  [ sec : kepler s problem ] .",
    "the value of the numerical solutions at time t=7 were compared against the exact solution .",
    "the max norm errors are depicted in figure  [ fig : convergence plot for point vortices ] .",
    "the results are qualitatively the same as for kepler s problem .         over the time interval @xmath451$].,scaledwidth=90.0% ]     over the time interval @xmath451 $ ] ( _ right column _ ) , with a close - up on the initial interval @xmath471 $ ] shown in the _ left column_.,scaledwidth=80.0% ]    we set @xmath472 in , so that @xmath448 for the considered solution . figure  [ fig : energy plots for gauss methods for point vortices ] and figure  [ fig : energy plots for lobatto methods for point vortices ] show the behavior of the numerical hamiltonian over a long integration interval .",
    "the 3- and 4-stage lobatto iiia - iiib integrators performed better than for kepler s problem . in the case of the gauss methods the hamiltonian stayed virtually constant ",
    "the visible minor erratic oscillations are the result of round - off errors .",
    "the radau iia scheme demonstrated a slow but systematic drift .",
    "the dynamics of the growth of two interacting species can be modeled by the lotka - volterra equations    @xmath473    where @xmath474 denotes the number of predators and @xmath475 the number of prey , and the constants 1 and 2 were chosen arbitrarily .",
    "these equations can be rewritten as the poisson system    @xmath476    where the hamiltonian is given by    @xmath477    with an arbitraty constant @xmath427 ( see @xcite ) .",
    "using an approach similar to the one presented in section  [ sec : kepler s problem ] , one can easily verify that the lagrangian    @xmath478    reproduces the same equations of motion , where @xmath479 .",
    "the coordinates @xmath354 ( cf .",
    "equation  ) were chosen , so that the assumptions of theorem  [ thm : existence of the numerical solution for prk ] are satisfied for the considered runge - kutta methods .    as a test problem we considered the solution with the initial condition @xmath480 and @xmath481 (",
    "note that @xmath482 is an equilibrium point ) .",
    "this is a periodic solution with period @xmath483 .",
    "a reference solution was computed by integrating until the time @xmath484 using verner s method with the small time step @xmath485 .",
    "the reference solution is depicted in figure  [ fig : reference solution for the lotka - volterra model ] .",
    "using verner s method with the time step @xmath485.,scaledwidth=80.0% ]    convergence plots are shown in figure  [ fig : convergence plot for the lotka - volterra model ] .",
    "the convergence rates for the gauss and radau  iia methods are consistent with the theoretical results presented in section  [ sec : runge - kutta methods]we see that the orders of the 2- and 3-stage gauss schemes are reduced .",
    "the 2-stage lobatto iiia - iiib scheme again proves to be inconsistent , and the 3- and 4-stage schemes converge quadratically , just as in section  [ sec : kepler s problem ] and section  [ sec : point vortices ] .",
    "we performed another series of numerical experiments with the time step @xmath449 to investigate the long time behavior of the considered integrators .",
    "the results are shown in figure  [ fig : energy plots for gauss methods for the lotka - volterra model ] and figure  [ fig : energy plots for gauss , lobatto and radau methods for the lotka - volterra model ] .",
    "we set @xmath486 in , so that @xmath448 for the considered solution .",
    "the 1- and 3-stage gauss methods again show excellent hamiltonian conservation over a long time interval .",
    "the 2-stage gauss method , however , does not perform equally well  the hamiltonian oscillates with an increasing amplitude over time , until the computations finally break down .",
    "the lobatto iiia - iiib methods show similar problems as in section  [ sec : kepler s problem ] .",
    "the non - variational radau iia method yields an accurate solution , but demonstrates a steady drift in the hamiltonian .     over the time interval @xmath451 $ ] ( _ right column _ ) , with a close - up on the initial interval @xmath487 $ ] shown in the _",
    "left column_.,scaledwidth=90.0% ]",
    "we analyzed a class of degenerate systems described by lagrangians that are linear in velocities , and presented a way to construct appropriate higher - order variational integrators .",
    "we pointed out how the theory underlying variational integration is different from the non - degenerate case and we made a connection with numerical integration of differential - algebraic equations .",
    "we also performed numerical experiments for several example models .",
    "our work can be extended in several ways . in section  [ sec : lotka - volterra model ] we presented our numerical results for the lotka - volterra model , which is an example of a system for which the coordinate functions @xmath354 are nonlinear .",
    "the 1- and 3-stage gauss methods performed exceptionally well and preserved the hamiltonian over a very long integration time .",
    "it would be interesting to perform a backward error ( or similar ) analysis to check if this behavior is generic .",
    "if confirmed , our variational approach could provide a new way to construct geometric integrators for a broader class of poisson systems",
    ".    it would also be interesting to further consider _ constrained _ systems with lagrangians that are linear in velocities and construct associated higher - order variational integrators .",
    "this would allow to generalize the space - adaptive methods presented in @xcite , @xcite to degenerate field theories , such as the nonlinear schrdinger , kdv or camassa - holm equations .",
    "we would like to thank prof .",
    "ernst hairer and dr .",
    "joris vankerschaver for useful comments and references .",
    "partial funding was provided by nsf grant ccf-1011944 ."
  ],
  "abstract_text": [
    "<S> in this paper we construct higher - order variational integrators for a class of degenerate systems described by lagrangians that are linear in velocities . </S>",
    "<S> we analyze the geometry underlying such systems and develop the appropriate theory for variational integration . </S>",
    "<S> our main observation is that the evolution takes place on the primary constraint and the hamiltonian equations of motion can be formulated as an index-1 differential - algebraic system . </S>",
    "<S> we also construct variational runge - kutta methods and analyze their properties . </S>",
    "<S> the general properties of runge - kutta methods depend on the velocity part of the lagrangian . </S>",
    "<S> if the velocity part is also linear in the position coordinate , then we show that non - partitioned variational runge - kutta methods are equivalent to integration of the corresponding first - order euler - lagrange equations , which have the form of a poisson system with a constant structure matrix , and the classical properties of the runge - kutta method are retained . if the velocity part is nonlinear in the position coordinate , we observe a reduction of the order of convergence , which is typical of numerical integration of daes . </S>",
    "<S> we verify our results through numerical experiments for various dynamical systems . </S>"
  ]
}