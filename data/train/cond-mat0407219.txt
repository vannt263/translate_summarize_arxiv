{
  "article_text": [
    "textbook reaction / transport modeling is based on macroscopic equations - typically partial differential equations embodying conservation laws closed through constitutive relations .",
    "the navier - stokes equations as a model of laminar fluid flow provide a good ilustrative example : they describe the behavior of a very complex system ( molecular collisions and interactions with the flow boundary ) at a level of coarse - graining ( velocity and pressure fields ) which is practical for engineering design ( e.g. pressure drop computations ) .",
    "what makes this possible is _ closures _ : modeling the stresses as functionals of the velocity field through newton s law and viscosity . in engineering modeling",
    "we increasingly encounter systems whose coarse - grained , mesoscopic behavior emerges from the interaction of a number of  agents \" ( molecules in a fluid , cells in a tissue , individuals in a population ) between themselves and with their environment .",
    "it is the coarse - grained behavior that we want to predict , design or control ; yet the available models are only available at a much finer , atomistic or stochastic level .",
    "the closures that will translate these models to  practically predictive \" mesoscopic level models are simply not available in closed form .    over the last few years we have been developing an  equation free \" computational methodology for extracting coarse - grained information from microscopic models ; this methodology provides an alternative to direct , long - term atomistic / stochastic simulation .",
    "our goal is to accelerate the computation of coarse - grained quantities or properties by acting directly , and as parsimoniously as possible , on the direct , full scale ( kinetic monte carlo , kmc , molecular dynamics , md , brownian dynamics , bd , also quantum chemistry based simulators like such as car - parrinello md , cpmd ) simulator .",
    "the basic idea is to use the microscopic simulator as a computational experiment that we can initialize at will .",
    "short bursts of appropriately initialized atomistic simulations are designed , executed , and their results processed to provide  on demand \" the information that one would obtain from coarse - grained models , had these models been available in closed form .",
    "this system identification based  closure on demand \" approach , provides a bridge between traditional continuum numerical analysis ( integration , steady state computation , the solution of linear and nonlinear equations , optimization ) and atomistic / stochastic / individual based simulators .",
    "short , appropriately initialized dynamic simulations of the detailed model (  coarse timestepping \" ) enable the microscopic simulator to perform tasks ( like locating , quantifying the stability of , or optimizing coarse grained stationary states ) that it has not been explicitly designed for .",
    "what makes it possible is the ability of a modeler to _ initialize a computational experiment at will _ ; initializing a laboratory experiment at will is an immensely more difficult task .",
    "this coarse - grained , equation - free computational framework was introduced in ref .  , and has since been used in a number of modeling contexts ( from coarse brownian dynamics of nematic liquid crystals @xcite to coarse molecular dynamics for alanine dipeptide folding @xcite , individual - based modeling of evolving diseases @xcite and lattice gas modeling of surface reactions @xcite ) , see the reviews in refs .  .",
    "the main assumption in this framework is that a separation of time scales ( and concomitant space scales ) prevails in the description of the system state ; indeed , that we can separate the state in a subset of slow ( coarse , macroscopic ) variables @xmath0 and its complement - a subset of fast variables @xmath1 . typically , the slow variables consist of a few of the lower moments of microscopically / stochastically evolving distributions ( such as concentration for chemical reactions , or density and momentum , the zeroth and first moments of a distribution of flowing molecules over velocities ) . over the time scale of interest ,",
    "the dynamics of the fast variables become quickly slaved to the dynamics of the slow ,  master \" variables . if this assumption holds ( and this is a reasonable assumption if the system is believed to have reproducible coarse - grained behavior ) , then one does not need to derive the macroscopic equations explicitly .",
    "one can in effect solve them , and perform system - level computational modeling and design tasks with them without deriving them in closed form ; model evaluations are substituted by  on demand \" information from appropriately initialized microscopic simulations .",
    "the main tool that allows the performance of numerical tasks at the macroscopic level using microscopic simulation codes is the so - called  coarse timestepper \" @xcite .",
    "the timestepper ( which we denote by @xmath2 ) is an operator which maps the state variables @xmath3 forward by time @xmath4 , i.e. @xmath5 . if closed equations for the evolution of the macroscopic variables @xmath3 are available , then the timestepper is simply the solution operator for these equations for time @xmath4 .",
    "when such equations are not available , the timestepper can be estimated by the _ coarse timestepper _ , which we denote by @xmath6 . the coarse timestepper uses detailed microscopic simulations of the system , and then processes the data to estimate the time-@xmath4 map for the evolution of the macroscopic observables for the problem of interest .",
    "the coarse timestepper consists of the following basic elements ( see ref .  ):    1 .",
    "a restriction operator , @xmath7 , from the microscopic level description @xmath1 , to the macroscopic description , @xmath8 .",
    "this operator usually involves averaging over microscopic space and over realizations of the ensemble of microscopic simulations .",
    "2 .   a lifting operator , @xmath9 , which constructs microscopic descriptions @xmath1 consistent with the prescribed macroscopic description , @xmath0 .",
    "this is obviously a  one - to - many \" operation .",
    "lifting from the macroscopic to the microscopic description and then restricting ( projecting ) again should have no effect , i.e. @xmath10 .",
    "3 .   prescribe a macroscopic initial condition @xmath11 .",
    "4 .   transform it through lifting to an ensemble of consistent microscopic realizations , @xmath12 .",
    "evolve these realizations using the microscopic simulator for the desired short macroscopic time @xmath4 , generating the values @xmath13 .",
    "6 .   obtain the restriction @xmath14 and define the coarse timestepper as @xmath15 .",
    "in other words , @xmath16 .    the use of such a coarse timestepper is based on (",
    "i ) the separation of timescales between the micro- and the macroscopic descriptions of the system evolution , similar to that used in deriving explicit closed macroscopic equations and ( ii ) on the assumption of existence of a closed evolution equation _ for the macroscopic variables _ @xmath3 .",
    "the basic premise is that the long - term dynamics of the microscopic simulation can be thought of as lying on a slow , low - dimensional manifold which is _ parametrized _ by the coarse variables . on this manifold ,",
    "the remaining observables are slaved to ( are functionals of ) the chosen coarse variables . therefore",
    ", judicious choice of the coarse variables is crucial for the correct implementation of coarse timestepping .",
    "coarse variables typically include a few lower moments of the microscopically evolving distributions , but any appropriate order parameter set can be used as the observables of choice .",
    "once the coarse variables and the lifting and restriction operators are constructed , the coarse timestepper procedure is easy to realize numerically .",
    "it is also easy to parallelize : each  lifted \" copy for the same coarse initial condition can be executed independently on a different processor over the same wall - clock time .",
    "various system - level tasks can be implemented as computational superstructures around repeated calls to the timestepper .",
    "in particular , the coarse projective euler method @xcite is based on the extrapolation ( projection ) of the evolution of @xmath3 , obtained through the application of the coarse timestepper , over some macroscopic time step @xmath17 . a fixed point for the timestepper , i.e. a point @xmath18 such that @xmath19 , corresponds to an equilibrium configuration of a thermodynamic system ; this allows one to consider using contraction mapping approaches , like the newton - raphson method to obtain the equilibrium states . in this work ,",
    "least squares estimation is used to fit the evolution of the macroscopic observables ( as opposed to the simple extrapolation in ref .  ) and to implement fixed point computations .",
    "other system - level tools that have been implemented using the timestepper for various systems include bifurcation and stability analysis , coarse control , coarse optimization , and the computation of coarse self - similar solutions ( ref .   and references therein . )",
    "it is important to note that  time \" and  evolution \" in the above discussion do not have to be in real physical time ; it could be in the wall - clock time ( iteration count ) of an mc simulation .",
    "in this paper we attempt to accelerate the convergence of a monte carlo ( mc ) simulation to its ultimate stationary state .",
    "we do not study how a real system dynamically approaches equilibrium ; we only demand that our simulation faithfully reproduces the equilibrium , and try to accelerate the approach _ of our simulation _ to _ its _ equilibrium .",
    "it may be helpful to draw an analogy between physical evolution to a steady state , and the evolution of a newton - raphson iteration towards the same steady state for _ deterministic _ problems .",
    "the dynamics of the newton - raphson and the dynamics of physical evolution are different , yet they share the same fixed point . our goal here is to accelerate ( using coarse integration and coarse fixed point techniques ) the convergence of _ our mc computation scheme _ to _ its _ equilibrium , which is hopefully shared with the real , dynamical problem ( with  nature \" ) .",
    "the problem we will study using these coarse - grained , equation free methods , is the spontaneous self - assembly of surfactant molecules in micelles ; we attempt to accelerate the ( artificial ) dynamics of an mc simulation of this process .",
    "it is well known that surfactant molecules , ( amphiphiles , i.e. molecules that contain both hydrophobic and hydrophilic segments ) , spontaneously self - assemble into a variety of structures ( see , e.g. ref .  ) . at low amphiphile concentration , above the critical micelle concentration",
    ", the surfactants assemble into micelles .",
    "we study the micellization process using grand canonical monte carlo ( gcmc ) simulations of the lattice model originally proposed by larson @xcite . despite its simplicity",
    ", this model leads to predictions ( in particular , phase diagrams ) that agree qualitatively with experiments @xcite .",
    "recently , panagiotopoulos and coworkers @xcite have studied micellization using gcmc simulations of the larson model . in order to extrapolate the results to temperature and chemical potentials different from those of actual runs",
    ", they used the histogram reweighting method @xcite .",
    "this method allows one to compute equilibrium distributions of the number of molecules in the system @xmath20 and the energy of the system @xmath21 at some temperature @xmath22 and chemical potential @xmath23 from the simulations performed at some other ( nearby ) @xmath24 and @xmath9 .",
    "this method will not , however , extrapolate _ structural _ properties , such as micelle size or density ; coarse computational techniques ( and , in particular , newton - raphson based continuation ) might be a promising alternative in efficiently exploring the dependence on such variables on parameters .",
    "this paper is organized as follows : in section ii we discuss the larson model implemented in our mc simulation . in the two subsequent sections we discuss our selection of coarse variables ( section iii ) and our lifting procedure ( the construction of microscopic states consistent with coarse observables ) ( section iv ) .",
    "we then discuss and illustrate coarse projective integration ( section v ) and the coarse newton method ( section vi ) . in section",
    "vii we discuss a kmc model fitted from our mc simulations , and apply the same coarse - grained computational methods to it .",
    "we summarize our results and conclude with a discussion in the final section ( viii ) .",
    "in the larson model @xcite studied here , three - dimensional space is discretized into a cubic lattice .",
    "an amphiphile molecule is modeled as a chain of beads and a solvent molecule is modeled by a single bead .",
    "the beads occupy sites on the lattice and the connected beads of an amphiphile molecule are located on the nearest - neighbor sites located along vectors @xmath25 , @xmath26 , @xmath27 and their reflections along the principal axis , resulting in a coordination number of 26 .",
    "there are two types of beads : hydrophobic tail ( t ) and hydrophilic head ( h ) .",
    "the solvent beads are assumed to be identical to the head beads .",
    "hydrophobic interaction is modeled by attractive interaction between the tail beads .",
    "each bead interacts only with its 26 nearest neighbors and the total energy of the system is the sum of pairwise interactions between beads .",
    "the tail - tail interaction energy @xmath28 is -2 and the tail - head and head - head interaction energies @xmath29 and @xmath30 are zero , following ref .  .",
    "it is furthermore assumed that all sites that are not occupied by the amphiphile beads are occupied by the solvent .",
    "this latter assumption implies that there is no need to explicitly consider solvent in the monte carlo ( mc ) moves .",
    "we perform grand canonical monte carlo ( gcmc ) simulations of this model and use the following mix of mc moves : 50% amphiphile transfers ( i.e. addition or removal ) , 49.5% amphiphile partial regrowth moves , and 0.5% cluster moves .",
    "we perform simulations of a linear amphiphile chain h@xmath31t@xmath31 ( which consists of 4 head beads and 4 tail beads ) in a cubic box with the side length of 40 sites , assuming periodic boundary conditions .",
    "this simulation box size is sufficiently large to prevent spurious effects of periodicity : a typical diameter of a micelle observed in the simulations reported here is significantly smaller than half the size of the box side .    a snapshot of a simulation is shown in fig .",
    "[ f : snapshot ] . in this example , we observe that the surfactant molecules have formed three micelles . in addition , there is a significant fraction of smaller clusters .",
    "our working definition of a cluster is an aggregate of amphiphile molecules such that each molecule in a cluster has at least one tail bead which occupies a neighboring site with a tail bead from another amphiphile of the cluster . in other words ,",
    "each cluster molecule interacts through hydrophobic attraction with at least one other cluster molecule .",
    "the cluster size is defined as the number of amphiphiles in this cluster .",
    "note that an isolated amphiphile molecule can be viewed as a cluster of size 1 .",
    "an example of the cluster size distribution obtained from the gcmc simulations is shown in fig .",
    "[ f : coarse_vars]a and is typical for a micellar system .",
    "there are two peaks in the distribution ",
    "one peak corresponding to the small clusters and the other peak corresponding to micelles .",
    "note that there is an almost vanishing probability to observe a cluster of an intermediate size .",
    "this observation is very important and allows us to define a set of coarse variables ( or  coarse observables \" ) .",
    "choosing an appropriate set of coarse variables (  observables \" ) is an important step in the implementation of equation - free computation .",
    "this choice is system - specific and should be guided by physical intuition about the system , or by data analysis techniques ( e.g. ref .  ) .",
    "one of the requirements for the coarse variables is that they provide sufficient information about the system so that the  lifting \" operation ( micro from macro ) can be successfully performed . in earlier work on coarse computation @xcite ,",
    "coarse variables were chosen to be moments of an evolving distribution . lifting then consisted of generating random realizations of a system configuration such that the average and , possibly , the variance of this quantity agreed with the prescribed values .",
    "more sophisticated lifting techniques ( including short , constrained simulations in the spirit of algorithms like shake in molecular dynamics @xcite ) are also being developed and tried .",
    "simple lifting approaches based on only a couple of moments may not be satisfactory for more complex systems such as the one studied in the current work .",
    "in addition to the averages , we also need to preserve more of the structure of the system during the transfer of information between micro and macro ( lifting and restricting ) .",
    "more sophisticated approaches , which take into account the spatial inhomogeneity of a system , have been presented by gear _",
    "_ @xcite . in this",
    "so called micro - galerkin method , an expansion of the spatial distribution of the quantity of interest in a set of global basis functions was used ; these can be traditional polynomial basis functions @xcite or possibly empirical eigenfunctions obtained by principal component data analysis from a microscopic simulation .",
    "principal components of the raw data would give us some averaged structural information about a micelle , e.g. a density profile .",
    "it is not , however , trivial to reconstruct a micelle from its density profile .",
    "we believe that nonlinear data analysis techniques @xcite hold the key to systematic , non - intuitive choices of appropriate coarse observables .    in the case of our micellar system",
    "we kept a database of cluster structures , and used as coarse observables a number of features of the distribution of such structures ; we will describe these observables below . in the lifting procedure ,",
    "we place cluster structures from the database directly into the simulation box according to certain prescribed distribution features .",
    "we envision that for more complex self - assembled systems , such as bilayer or vesicles , one can combine the empirical eigenfunction method with maintaining a structure database .",
    "details on computing the structure database will be provided in section  [ s : euler ] .",
    "in addition to the database , we need to specify distributions of several quantities .",
    "describing these distributions through a finite number of macroscopic observables ( coarse variables ) will be the basis of our coarse timestepper . to choose a reasonable set of observables , capable of parametrizing the evolution of our simulations",
    ", we examine representative simulation runs .",
    "clearly , one needs to know the distribution of clusters . in this work , we assume that the only quantity needed to characterize a cluster is the number of amphiphiles",
    ". that is , all other physical properties of the cluster ( such as its radii of gyration and its energy ) are quickly slaved to the cluster size .",
    "if we monitor clusters of a certain size , we observe that over very short periods of simulation time , their physical attributes will  approach a slow manifold \"  that is , their statistics will very quickly become functions of the size .",
    "the analysis in the companion paper @xcite shows that this is a reasonable assumption for the system considered here .",
    "hence , in order to characterize the clusters contained in the system , we only specify their size distribution shown in fig .  [",
    "f : coarse_vars]a . in addition to the distribution of cluster sizes , we need to specify the concentration of amphiphiles in the system . since we are performing simulations in the grand canonical ensemble , in an equilibrium state , this concentration will fluctuate around some average value . in principle , for a system of fixed volume , to specify concentration , one can specify the total number @xmath20 of amphiphile molecules in the system .",
    "however , we found it more convenient to  split \" this @xmath20 into the  small cluster \" and the  micellar components \" .",
    "this allows us to monitor the density of micelles directly from our coarse variables and to take advantage of the separation of time scales between the micelles and the small clusters , which is discussed below .",
    "we furthermore assume that there is no correlation between sizes of different clusters in the system .",
    "this assumption is reasonable because there are no long - range interactions in the system and the solution non - idealities are only due to excluded volume interactions .",
    "the systems considered here are dilute and hence the non - idealities ( correlations ) are expected to be small .",
    "we will show it later that this assumption indeed holds .    to summarize",
    ", we suggest that the system can be macroscopically successfully characterized by distributions of the following three quantities ( see fig .  [",
    "f : coarse_vars ] ) : ( i ) cluster size , ( ii ) number @xmath32 of micelles in the system , and ( iii ) number @xmath33 of molecules contained in small clusters .    a typical distribution of cluster sizes is shown in fig .",
    "[ f : coarse_vars]a .",
    "clearly , the clusters can be divided into two classes  small clusters and micelles .",
    "small clusters are unstable aggregates of a small number of molecules , usually less than 10 .",
    "they are being formed and destroyed very quickly during a simulation .",
    "for definiteness , we classify a cluster as a micelle if its size exceeds 20 molecules and as a small cluster otherwise .",
    "since there is essentially zero concentration of clusters of size between 20 and 40 , a precise location of the border between micelles and small clusters is unimportant .",
    "the cluster size distribution is further approximated by a gaussian distribution ( dashed line in fig .",
    "[ f : coarse_vars]a ) and the small cluster size distribution is approximated by a poisson distribution ( dotted line in fig .",
    "[ f : coarse_vars]a ) , @xmath34 where @xmath35 is the cluster size and @xmath36 is the average size of a small cluster .",
    "the size distribution of small clusters shows good agreement with the poisson distribution because the probability of formation of a small cluster consisting of @xmath37 molecules ( in an ideal solution ) is proportional to @xmath38 .",
    "hence , the cluster size distribution is described by three parameters : average @xmath39 and standard deviation @xmath40 of the micelle size and the parameter @xmath41 of the poisson distribution of the small cluster sizes .",
    "one more parameter is needed to completely specify the cluster size distribution  namely , the ratio between numbers of molecules contained in the small clusters and in the micelles .",
    "this information is contained in the distributions of @xmath33 and @xmath32 and the section  [ s : lifting ] describes the details of reconstruction of the system from these parameters .",
    "typical examples of distributions of @xmath33 and @xmath32 are shown in fig .",
    "[ f : coarse_vars]b and  [ f : coarse_vars]c , respectively .",
    "the distribution of number @xmath33 of molecules contained in small clusters is approximated by a gaussian distribution @xmath42 here , @xmath43 and @xmath44 are the mean and the standard deviation of @xmath33 and @xmath45 is the gaussian distribution with the mean @xmath39 and the standard deviation @xmath40 . as seen in fig .  [",
    "f : coarse_vars]b , the gaussian distribution provides a good approximation to @xmath46 and hence in our coarse simulation , the distribution of @xmath33 is completely specified by its first two moments , @xmath47 and @xmath44 .",
    "the distribution of the number of micelles @xmath32 is approximated by a gaussian truncated at @xmath48 , i.e. @xmath49 here , @xmath50 is a normalization constant .",
    "this truncation is important , because there is a non - vanishing probability to have zero micelles in the simulation box ( see fig .",
    "[ f : coarse_vars]c ) .",
    "if we were to fit an untruncated gaussian to such a distribution , we would end up with a non - vanishing probability to have a negative number of micelles in the simulation box .",
    "note that , unlike the standard gaussian , the parameters @xmath51 and @xmath52 of @xmath53 in eq .",
    "( [ eq : trunc ] ) do not coincide with the mean @xmath47 and and the standard deviation @xmath54 of @xmath32 .",
    "it is therefore necessary to obtain these parameters from the requirement that the mean and the standard deviation of the truncated distribution coincide with the mean @xmath47 and the standard deviation @xmath54 of @xmath32 .",
    "this is done via solution of a system of two nonlinear equations : @xmath55 note that these equations have a solution for only a subset of values of @xmath47 and @xmath54 .",
    "[ f : coarse_vars]c shows that the truncated gaussian provides a good approximation for @xmath56 .",
    "although we modified the standard gaussian distribution to fit @xmath56 , the distribution of the number of micelles is still specified by its first two moments @xmath47 and @xmath54 .    to summarize , we chose to model the system by 7 coarse variables ( observables ) : 3 for small clusters ( @xmath41 , @xmath43 , @xmath44 ) and 4 for micelles ( @xmath39 , @xmath40 , @xmath47 , @xmath54 ) .",
    "timescales ( in mc iteration  time \" ) for the evolution of these coarse variables are illustrated in figures [ f : small_evol ] and [ f : micelle_evol ] which show evolutions of the coarse variables when the system parameters ( temperature @xmath24 and chemical potential @xmath9 ) are switched from @xmath57 , @xmath58 to @xmath59 , @xmath60 .",
    "the small cluster variables are shown in fig .",
    "[ f : small_evol ] and are extremely fast - they approach the slow manifold on the timescale of less than 0.1 million steps .",
    "the micelle size distribution is also relatively fast  as figs .",
    "[ f : micelle_evol]a and [ f : micelle_evol]b show , equilibration time of the first two moments of the micelle size distribution is on the order of 10 million steps .",
    "the slowest dynamics is that of the micelle number distribution ",
    "it equilibrates on the order of 1000 million steps ( see figs .  [",
    "f : micelle_evol]c and [ f : micelle_evol]d ) .",
    "the observed timescales suggest that the coarse projective integration should be performed for only two variables  @xmath47 and @xmath54  average and standard deviation of number of micelles .",
    "the described choice of coarse variables assumes that there is no correlation between the number of micelles @xmath32 in the system and the micelle size . in order to check this assumption , we computed the correlation coefficient between @xmath32 and the average size of a micelle at different values of temperature @xmath24 and the chemical potential @xmath9 .",
    "results of this calculation are shown in figure  [ f : nmic_corr ] .",
    "for relatively dense systems , the correlation coefficient is non - vanishing and we might need to take it into account when working at those conditions .",
    "however , for low surfactant density ( thick line in fig .",
    "[ f : nmic_corr ] ) , the correlation is negligible .",
    "the coarse integration results below are reported for this low density .",
    "in this section , we describe the lifting procedure , i.e. how realizations of the detailed system are reconstructed from the 7 coarse variables .",
    "since there is no long - range interaction between the clusters in the system and we consider sufficiently dilute systems , the lifting procedure consists of the following two stages : first , we generate a sequence of sizes of clusters to be placed into the system .",
    "second , we place these clusters into the simulation box . in order to improve efficiency of the second stage of lifting",
    ", we sort the list of cluster sizes generated in the first stage in descending order .",
    "this is done because it is easier to place a larger cluster into an emptier system and it does not introduce any bias since correlations between different clusters in the system are negligible . for each cluster size from the list",
    ", we randomly pick a cluster from a database and place it into a random location in the simulation box .",
    "the only requirement in this procedure is that the clusters do not overlap or touch each other . in principle , this procedure can be generalized to the case of denser systems or systems with long - range interactions , where the correlations between clusters become important ( see also ref .  , where pair probabilities between adsorbate atoms must be appropriately initialized ) .",
    "let us now describe the generation of the cluster size list in more detail .",
    "this procedure is split into two parts .",
    "first , the micelle sizes are generated : the number of micelles @xmath32 in the system is sampled from the truncated gaussian distribution eq .",
    "( [ eq : gauss ] ) with mean @xmath47 and standard deviation @xmath54 . then , for @xmath61 , the @xmath62-th micelle size is sampled from the gaussian distribution with parameters @xmath39 and @xmath40 .",
    "the number @xmath33 of molecules contained in small clusters is sampled from the gaussian distribution with parameters @xmath44 and @xmath43 . then the cluster sizes @xmath63 , @xmath64 are sampled from the poisson distribution eq .",
    "( [ eq : poisson ] ) with parameter @xmath41 .",
    "we stop after we have generated @xmath7 clusters such that @xmath65 we then keep all of these clusters if the sum on the right hand side of eq ( [ eq : nsmall ] ) is closer to @xmath33 than the sum on the left hand side .",
    "otherwise , we keep only the first @xmath66 clusters generated .",
    "although this procedure does not always produce exactly @xmath33 molecules in each realization , it does so on average .",
    "moreover , as we have shown , the small cluster variables are slaved to the micellar variables . therefore",
    ", small errors in small clusters lifting will be quickly healed in the microscopic simulation . if necessary , the short  healing \" step can be implemented in a constrained fashion ( evolving the mc simulation with a hard parabolic potential around the target values of the slow observables , as in umbrella sampling @xcite ) .",
    "in this section we describe coarse integration of the micellar system using the coarse projective euler method .",
    "this method is briefly outlined in the introduction and is discussed in more detail by gear and kevrekidis @xcite .",
    "other coarse integration methods are also proposed in ref .   and",
    "their linear stability analysis is performed .",
    "before we start the coarse integration , we perform the microscopic ( gcmc ) simulation and let all the fast modes equilibrate .",
    "fast modes here refer to the small cluster variables and the first two moments of the distribution of micelle sizes .",
    "as shown in section [ s : coarse_var ] , these modes are much faster than the mean @xmath47 and the variance @xmath54 of the number of micelles in the simulation box . after the  fast mode equilibration \" is complete , we let the simulations run for a little longer in order to collect enough samples of clusters for the database .",
    "we run this  database production \" simulation for an additional 5 million steps and use 500 copies of the system .",
    "the database is updated after each 0.1 million steps .",
    "this step size is sufficiently large for the micelle structures to be significantly modified and hence we populate the database with statistically different clusters .",
    "a more detailed analysis of the rate of change of a cluster structure will be presented in the companion paper @xcite .",
    "when the initial preparations are complete , we perform the coarse projection .",
    "the lifting procedure was described in the previous section .",
    "after the lifting , we let the system  heal \" for @xmath67 million steps .",
    "this time is more than sufficient to eliminate any discrepancies in the ( fast ) small cluster variables @xmath41 , @xmath43 , and @xmath44 that might be introduced during the lifting  see the earlier discussion of timescales . since we pick the micelle structures",
    "directly from the  equilibrium \" database , we expect that no healing is needed for the micelle size variables @xmath39 and @xmath40 .",
    "as mentioned above , the initial  healing \" preparatory step can also be implemented in a constrained fashion as in umbrella sampling @xcite .    after the healing is complete",
    ", we perform the ( unconstrained ) simulation for additional @xmath68 million steps .",
    "we then fit a straight line through the computed @xmath69 and @xmath70 and extrapolate these quantities for the macroscopic step @xmath71 million steps , @xmath72 here , @xmath73 are the slow coarse variables and @xmath74 is their slope obtained from the least squares fit to the results of the production run of length @xmath68 million steps .",
    "the fast coarse variables are set to the values from the last step of the previous microscopic simulation run .",
    "results of the coarse integration are shown in fig .",
    "[ f : euler ] .",
    "we observe good agreement -at the level of the macroscopic observables- with the control full scale gcmc run , also shown in this figure .",
    "these simulations are performed for a system switching from @xmath57 , @xmath58 to @xmath59 , @xmath75 .",
    "we used different numbers of copies of the system in the coarse integration and the control run : in the coarse integration , we used 2000 copies and in the control run we used 500 copies .",
    "the number of copies had to be increased for the coarse integration in order to reduce statistical error in the extrapolations : the projection step  magnifies \" the noise and one has to have precise data in order to obtain a reasonable accuracy during extrapolation .",
    "hence , there is a trade off between the size of the projection step and number of copies of the system needed for an accurate extrapolation .    in our particular case ,",
    "the savings of cpu time in the coarse integration ( as compared to the control run ) are about 50% .",
    "the efficiency of the coarse euler scheme is the subject of further investigation ( see section  [ s : kmc ] ) and possible improvements to the method are discussed in section  [ s : discussion ] .",
    "in addition to coarse projective integration , one can perform other system - level tasks , such as fixed point location and stability analysis , using the information obtained from the short - scale simulations . in this section",
    ", we describe an application of a newton - like method to the micellar system .",
    "the approach is based on the observation that the equilibrium configuration of the system corresponds to a solution of a nonlinear system of equations @xmath76 where @xmath77 is the slope of the evolution of the @xmath78-th coarse variable @xmath79 .",
    "the slope of @xmath80 is estimated by fitting a straight line to results of the short - scale microscopic simulations .",
    "hence , one can use the newton method ( or some other method of solution of nonlinear equations ) in order to obtain the equilibrium configuration of the system .    in a newton algorithm for a deterministic problem one",
    "evaluates the residual at the current guess , the jacobian of the equations at the current guess , and solves a linear set of equations to provide the next guess , at which the procedure is repeated .",
    "the construction of variants of the newton method appropriate for fixed point computations in noisy environment is the subject of ongoing research ( e.g. the stochastic approximation algorithms @xcite ) .    in this paper",
    "we try to estimate the deterministic component of the noisy simulation , reducing the variance through averaging a number of copies , and perform newton - raphson on the deterministic part .",
    "the derivatives required in the newton step will be estimated using finite differences ( i.e. by initializing _ macroscopically nearby _ initial conditions , and observing the difference in the evolution of their coarse variables ) .",
    "one important practical twist in our implementation of the newton method for a noisy / stochastic system ( compared to deterministic noise - free system of equations ) is that our lifting procedure does not create microscopic states _",
    "precisely _ consistent with the macroscopic observables ; rather , it creates microscopic states consistent with slightly _ nearby _ observables . in the newton context , the function @xmath80 is computed not for the specified observable values @xmath0 of the coarse variables but for slightly different values .",
    "this happens due to the stochastic nature of our lifting procedure , which involves sampling of the random variables according to a prescribed distribution .",
    "of course , if the sample size is infinitely large , then the moments of the sampled realizations of the system will coincide with the prescribed ones .",
    "however , the finite sample size introduces some statistical errors in the generated moments .",
    "it is also possible , _ after _ lifting and _ before _ the newton procedure , to apply an additional preparatory step , in which the microscopic state is adjusted to correspond to the macroscopic observables exactly ( either through constrained evolution or some sort of simulated annealing ) .",
    "such reasonable modifications of the procedure are the subject of current research ; we are proceeding with our current lifting operator .    to be more specific ,",
    "consider the lifting procedure for micellar systems , which involves sampling of the number of micelles @xmath32 from the first two moments of the truncated gaussian distribution .",
    "i.e. in this case the coarse variables are @xmath81 .",
    "we observe that for the values of @xmath47 and @xmath54 typical for our simulations , one needs at least @xmath82 realizations in order to sample an accurate mean @xmath47 and standard deviation @xmath54 .",
    "this large value of realizations is impractical for the micellar simulations and we have used 2000 copies in our implementation of the newton method .",
    "the implication of this statistical error with our current lifting is that it is necessary to modify the standard finite - difference calculations of the jacobian . in what follows",
    ", we first describe the necessary changes for a one - dimensional function and then generalize them to a system of arbitrary dimensionality .",
    "consider the standard forward difference estimation of a derivative , @xmath83 however , in the lifting , instead of @xmath84 and @xmath85 , we generate @xmath86 and @xmath87 , where @xmath86 denotes the value of a coarse variable which is generated during the lifting step from the prescribed value @xmath84 .",
    "we expect that , as the number of copies of the system approaches infinity , @xmath86 approaches @xmath84 and therefore , for a finite but large number of copies , @xmath86 is not very different from @xmath84 . hence , instead of @xmath88 and @xmath89 , we compute @xmath90 and @xmath91 and thus the correct forward difference estimate for the derivative is @xmath92 we found that this correction to the standard forward difference formula ( [ eq : deriv_standard ] ) is significant in the implementation of the coarse newton method for the micellar system and that taking it into account have improved the convergence of the method .    the correction to the forward - difference scheme described above",
    "is the simplest estimate for the derivative in our noisy system . without more precise lifting",
    ", we do not expect standard higher order schemes to yield significant improvement in the newton convergence .",
    "there is significant recent interest in development of higher order difference schemes for derivative estimation in noisy systems .",
    "in particular , gear @xcite has proposed to use the least - squares fit and drews _ et al .",
    "@xcite have developed a central difference scheme with the weights chosen in order to reduce the variance of the derivative estimate .",
    "their estimate is still @xmath93 but the variance of @xmath94 is reduced .",
    "the work on testing and developing such schemes is currently in progress .    in this paper , we use the corrected forward - difference scheme eq .",
    "( [ eq : deriv_correct ] ) .",
    "let us briefly discuss the generalization of this formula to multiple dimensions while keeping in mind the standard forward - difference scheme , @xmath95 here , @xmath96 is the dimensionality of the ( coarse ) system , @xmath97 is a unit vector pointing in the @xmath62-th direction and @xmath98 is an increment in @xmath99 . due to the uncertainties in the lifting procedure , we actually compute the function @xmath100 at points @xmath101 and @xmath102 . from the taylor expansion of the function @xmath103 , @xmath104 it follows that @xmath105 where @xmath106 terms have been neglected and @xmath107 and @xmath108 , @xmath109 ( @xmath110 denotes the @xmath37-th component of the vector @xmath111 ) .",
    "this formula , eq .",
    "( [ eq : deriv_multidim ] ) , is similar to the forward difference simplex gradient described , e.g. , in ref .   in the context of optimization of noisy functions .",
    "it is possible to use this formula with less or more than @xmath112 evaluations of function @xmath100 . in the first case ,",
    "the solution of eq .",
    "( [ eq : deriv_multidim ] ) will be given by a pseudoinverse of the matrix @xmath113 and the computation will be somewhat similar to the simultaneous perturbation stochastic approximation method @xcite .    in the second case ,",
    "the estimate of the jacobian will be given by the least squares fit @xcite .",
    "in the current work , we limit the estimation of the derivative to the direct use of eq ( [ eq : deriv_multidim ] ) and hence we perform @xmath114 evaluations of the left - hand - side per iteration of the newton method .",
    "we choose the increment @xmath98 of @xmath99 in the calculation of the derivative to be an integer multiple of the statistical error @xmath115 of @xmath99 .",
    "this choice assures that the increments of different coarse variables are not too small ( i.e. not smaller than the noise ) .",
    "the stopping criterion for the iterations is @xmath116 where @xmath117 is the statistical error estimate for the function @xmath77 .",
    "we perform coarse newton simulations for the two slowest coarse variables , @xmath118 the function @xmath100 , i.e. the slope of @xmath0(t ) , is computed by fitting a straight line to result of an  inner \" simulation of 2000 copies of the system .",
    "the inner simulation is performed for 10 million steps : the first 0.2 million steps are used for healing and the linear fit is performed for the last 9.8 million of steps of the run .",
    "the values of the fast coarse variables are initialized at the values at the end at the end of the previous inner integrator run .",
    "results of 3 calculations using the newton method are shown in fig .",
    "[ f : newton ] .",
    "an estimate of the equilibrium solution obtained from an equilibrium run with 500 copies of the system is shown by the circle .",
    "the 3 coarse newton simulations are as follows :    1 .   simulation 1 ( crosses ) : the iterations started relatively close to the solution ; in the derivative estimation , the increment for derivative calculation is @xmath119 .",
    "2 .   simulation 2 ( squares ) : the iterations started at the same point at which the coarse euler simulation started , see fig .",
    "[ f : euler ] ; @xmath119 .",
    "3 .   simulation 3 ( triangles ) : the iterations started at the same point as those of the second run but now the derivative is computed with @xmath120 .    the first simulation converges to a point located close to the estimation of the equilibrium solution .",
    "the slight difference between the equilibrium estimate and the coarse newton method result is probably due to fact that 500 copies ( used in the control run ) of the system do not provide as good statistics as 2000 copies ( used in coarse newton ) do .",
    "however , the situation is worse for the simulations 2 and 3 started relatively far from the stationary point .",
    "these two calculations were terminated after the third iteration because it did not appear that the iterations were converging to a stationary solution . moreover , these iterations are very sensitive to the choice of @xmath121 : even the direction of newton step is altered by changing @xmath121 by a factor of 5 .",
    "one reason for such a poor performance of the newton method far away from the stationary point is the high level of noise . in section [ s : kmc ] we show that the function @xmath100 is very noisy if one only uses 2000 copies of the system .",
    "it is well known , from the simple deterministic context , that newton iteration is quite sensitive ( in a problem - dependent way ) to the choice of initial conditions .",
    "it is mostly in a continuation context ( i.e. when we have the solution at one parameter value , and want to find it at nearby parameter values ) that newton is routinely used . in the context of the present work , we only want to demonstrate that such continuum - inspired algorithms can work when applied appropriately and with sufficient variance reduction .",
    "many deterministic variants of the newton ( including matrix - free newton - krylov methods ) can be easily modified to work in a coarse timestepper context ; which of these will be the least sensitive to noise , and what savings they can produce is the subject of current research .",
    "once more , what we want to show here is that such continuum numerical analysis methods are , indeed , applicable as  wrappers \" around the type of atomistic micellar simulations we perform .",
    "it is also important to notice that algorithms like newton are capable of converging to unstable stationary states ( e.g. transition states ) and can be augmented to converge on _ marginally stable _ states ( at the onset of instabilities ) @xcite .",
    "in addition to computing an equilibrium configuration of the system , results of the newton method can be used to obtain the timescale ( in mc iteration time ) of approach of the coarse variables to this equilibrium .",
    "eigenvalues of the coarse jacobian near a stationary point correspond to timescales of the coarse variables .",
    "for the density variables , @xmath47 and @xmath122 , the eigenvalues computed near the equilibrium solution are on the order of @xmath123 .",
    "this is in contrast with the eigenvalue @xmath124 obtained in the companion paper for the evolution of a single micelle near its equilibrium configuration .",
    "these calculations confirm that there is at least a two order of magnitude separation of times cales between the coarse - grained dynamics of micelle density and the micelle size variables .",
    "in this section , we show that the poor performance of the newton method is due to the high level of noise in the system . the simplest way to estimate",
    "the noise level in the evaluations of function @xmath100 is to compute values of this function on a relatively fine mesh of values of @xmath0 .",
    "unfortunately , this task is formidable for our micellar system  a calculation of the function @xmath100 at a single point takes about 28 hours on a single amd athlon processor and , even with parallelization , the calculation on a fine mesh would take very long time .    in order to compute @xmath100 on a mesh and to prepare the ground for future  experiments \" with various variance - reducing finite - difference methods , we consider the following simple kinetic monte carlo ( kmc ) model .",
    "we assume that there is a discrete set of possible states of the system and we number these states @xmath125 . in the case of a micellar system",
    ", the @xmath78-th state corresponds to the system with @xmath78 micelles in it .",
    "we consider @xmath126 copies of the system and store the data in a form of a histogram @xmath127 so that the value of @xmath128 is the number of copies of the system which are in the @xmath78-th state and @xmath129 .",
    "we further assume that the birth - death process is described by a first - order master equation , @xmath130 where @xmath131 is the matrix of transition rates and @xmath132 is the rate of transition from state @xmath78 to state @xmath62 .",
    "it is shown in the companion paper that the birth - death of micelles can indeed be approximated by the first order kinetic process .",
    "although the solution of equation ( [ eq : master ] ) is straightforward , in some cases this equation is not available in an explicit form .",
    "this happens , in particular , when it is not easy to identify the states of the system or the transition paths between these states .",
    "examples of such systems include diffusion in random media and birth and death of micelles in a system with long - range interactions . in these cases",
    ", one has to resort to some microscopic integration tool such as md or mc instead of solving the more macroscopic master equation .    in order to model the birth - death process and its interaction with the coarse integration tools",
    ", we use stochastic ( kinetic monte carlo , kmc ) simulation @xcite to simulate the equation ( [ eq : master ] ) . in our simulations , we choose kmc parameters which model micelle birth / death process . the transition rates ( i.e. rates of micelle birth and death ) are chosen so that they satisfy the detailed balance condition consistent with the equilibrium distribution @xmath133 , i.e. @xmath134 the equilibrium distribution is obtained from the full scale mc simulation .    the condition ( [ eq : detailed_balance ] ) guarantees convergence of the system to the equilibrium distribution .",
    "the rates of the system are chosen so that one unit of time of the kmc simulation corresponds to one million of gcmc steps .",
    "an example of a kmc simulation with thus chosen transition rates is shown in fig .",
    "[ f : euler_kmc ] .",
    "[ f : euler_kmc]a shows evolution of the probabilities @xmath135 and it is seen that these probabilities do approach an equilibrium .",
    "evolution of the two moments ( mean @xmath47 and standard deviation @xmath54 ) of this distribution is shown in fig .",
    "[ f : euler_kmc]b and [ f : euler_kmc]c",
    ". comparison of fig .",
    "[ f : euler ] and fig .",
    "[ f : euler_kmc ] shows that the kmc model reproduces essential features of the evolution and hence its results can be used to analyse the accuracy coarse integration technique .",
    "thus , in effect , in this model we have completely eliminated the fast dynamics and we focus on the rate - limiting slow dynamics  birth and death of micelles .",
    "we emphasize that  time \" and  dynamics \" here ( as everywhere else in the paper ) refer to the artificial gcmc dynamics .",
    "probably the most important feature of equation - free computation is that the algorithms are in effect  wrappers \" which , through lifting and restriction subroutines , can be combined with _ any _ microscopic / atomistic simulator . in the same way we wrapped coarse projective integration and coarse newton around the gcmc with our 7 coarse observables ,",
    "we will now wrap it around the model kmc simulation ( templated on the gcmc ) .",
    "we perform coarse projective euler integration for the kmc model with 3 different numbers @xmath126 of copies of the system .",
    "the observables here are the average and the standard deviation of the average @xmath47 and the standard deviation @xmath54 of the number of micelles , just as in the coarse integration of the full gcmc model .",
    "results of the coarse kmc integration are shown in figs .",
    "[ f : euler_kmc]b and c by circles .",
    "the timestep of the euler method is @xmath71 and , before each projective step , the inner integration is performed for 10 units of time .",
    "the simulations with larger number of system copies ( @xmath136 and @xmath137 ) converge to the equilibrium solution . however , the simulation with @xmath138 system copies exhibits strong oscillations around the stationary solution . as evident from figs .",
    "[ f : euler_kmc]b and c , the accuracy of the coarse euler method significantly depends on the number @xmath126 of the system copies used in the microscopic simulation .",
    "in addition to @xmath126 , the parameters of the coarse euler method that can significantly affect the accuracy are the the length @xmath139 of the microscopic simulation and a length @xmath140 of the projection interval . for convenience , here we normalize @xmath140 so that @xmath141 corresponds to projection over the internal microscopic simulator step @xmath17 .    in order to investigate the accuracy of the coarse euler projective step , we obtain evolution of coarse variables from the kmc simulation and perform the extrapolation of the coarse variables to various ( normalized ) timesteps @xmath140 .",
    "we perform this projection for various values of realizations of the system @xmath126 and for different lengths of the fitting interval @xmath139 . for each set of parameters @xmath142 , we compute @xmath82 realization of the  average trajectory \" , i.e. a trajectory which one obtains using @xmath126 copies of the kmc system .",
    "these average trajectories are still noisy and hence the projections obtained from different realizations of these trajectories will have some scatter .",
    "we measure this scatter by computing the variance of @xmath82 realizations of such projections .",
    "this variance , which we denote @xmath143 , measures the accuracy of the euler step .",
    "the value of @xmath126 was varied from @xmath144 to @xmath82 , @xmath140 was varied from @xmath145 to @xmath146 , and @xmath139 was varied from 4 to 98 .",
    "initial conditions for the kmc simulation were taken to coincide with those of the simulations shown in fig .",
    "[ f : euler_kmc ] . here , we report results of the projection of @xmath47 .",
    "the conclusions for the other coarse variable , @xmath54 , are similar .",
    "dependence of the variance of @xmath47 , @xmath147 , on the normalized projection time @xmath140 is shown in fig .",
    "[ f : proj_kmc]a for @xmath148 and @xmath149 .",
    "the quadratic dependence of @xmath150 on @xmath140 seen in fig .",
    "[ f : proj_kmc]a is also observed for all values of @xmath126 and @xmath139 considered in our numerical experiments .",
    "we conclude therefore that @xmath151 where @xmath152 is the proportionality coefficient .",
    "we plot @xmath152 for fixed @xmath149 and various @xmath126 as well as for fixed @xmath153 and various @xmath139 in fig .",
    "[ f : proj_kmc]b and observe that , to a good accuracy , @xmath50 is inversely proportional to both @xmath126 and @xmath139 .",
    "we therefore conclude that @xmath154 similar result is obtained for the accuracy of the projection of @xmath54 .",
    "the significance of the scaling eq ( [ eq : efficiency ] ) is that there is a trade - off between the projection interval length @xmath140 and the number of copies @xmath126 and the interval length @xmath139 used in the microscopic simulations .",
    "in other words , if we increase the projection length @xmath140 , then we also need to increase the product @xmath155 by the same factor in order to keep variance of the projected data at the same level as the variance of the original data .    the efficiency of coarse projective integration",
    ", the choice of filtering , variance reduction @xcite and extrapolation techniques it can be combined with , is the subject of current study ; our group as well as other groups are comparing the efficiency of direct simulation to that of coarse integration methods .    * coarse newton method for the kmc model .",
    "* we perform the coarse newton computations for @xmath156 ( the number of copies used in the coarse newton method for micelles ) and @xmath157 ( some large number that is unrealistic for the gcmc simulations ) .",
    "we perform the simulations with forward and central differences .",
    "in the case of the central differences , the jacobian is obtained from the solution of the eq .",
    "( [ eq : deriv_multidim ] ) in the least squares sense .",
    "the increment @xmath121 for calculation of the jacobian is chosen as follows : for simulations with @xmath156 , we set @xmath158 , where @xmath115 is the error estimate of a coarse variable @xmath84 .",
    "this choice is similar to that used in the implementation of the newton method for gcmc simulations .",
    "however , such a choice is not practical for simulations with @xmath159 , since in this case , the noise level is relatively low which leads to very small values of @xmath119 .",
    "hence , in the simulations with @xmath159 , we use increment @xmath160 .",
    "this value roughly corresponds to the increments used in the simulations with @xmath156 .",
    "iterations of the coarse newton method are shown in figs .",
    "[ f : newton_kmc1 ] and [ f : newton_kmc2 ] .",
    "the simulations shown in fig .  [ f : newton_kmc1 ] , are started from a point located relatively close to the equilibrium and the simulations shown in fig .",
    "[ f : newton_kmc2 ] are started from a point located further away from the equilibrium .",
    "the iterations with @xmath159 converge relatively fast to the equilibrium and the convergence is significantly faster if one uses the central difference algorithm .",
    "however , for @xmath148 ( the number of copies which is realistic in our gcmc simulations of the micellar system ) , the rate of convergence is slower and , moreover , the central differences are not guaranteed to provide an improvement of convergence .",
    "in fact , in the simulations shown in fig .",
    "[ f : newton_kmc1 ] , the central differences perform significantly worse than the forward differences .",
    "reliable estimation for the ( coarse ) derivative of a noisy function is a vital element in the bridging of microscopic similations with continuum - type numerical algorithms based on ( macroscopic ) smoothness and taylor series .    finally , in order to estimate the level of noise , we compute one of the nonlinear functions ( @xmath161 = slope of @xmath47 ) for the newton method and plot it in fig .",
    "[ f : kmc_grid ] for @xmath156 , @xmath159 and an analytic result obtained from the solution of the master equation .",
    "we observe that the right - hand side is very noisy even for @xmath159 and is extremely noisy for @xmath156 .",
    "this explains such a poor performance of the coarse newton method for @xmath156 and suggest that a significant effort should be directed towards developing variance - reducing schemes for the newton method @xcite .",
    "we have demonstrated the application of coarse - grained , equation - free computational techniques to the gcmc simulations of the micellar system ( and to their kmc caricature ) . of our 7 coarse variables , 5  fast \" ones ( small cluster parameters @xmath41 , @xmath43 , and @xmath44 and the micelle size variables @xmath39 and @xmath40 )",
    "are observed to be slaved to two slow ( master ) variables : average @xmath47 and the standard deviation @xmath54 of the number of micelles in the system .",
    "although the current coarse computation results do not show significant improvement of the efficiency of the coarse integration as compared to the full - scale mc simulations , several possible improvements of the coarse integration methods are currently a subject of active research .",
    "although in our micellar system , we have already taken advantage of the separation of time scales between the 5 fast coarse variables and the 2 slow coarse variables , the dynamics of the 2 slow coarse variables ( @xmath47 and @xmath54 ) has not been fully explored . in particular , it is possible to improve the efficiency of the coarse computation by a different choice of the slow coarse variables that describe the distribution @xmath56 of the number @xmath32 of micelles in a simulation box . recall that in the current work , these variables are chosen to be the mean @xmath47 and the standard deviation @xmath54 of @xmath32 and @xmath32 is assumed to have a truncated gaussian distribution . a more detailed analysis of the equation ( [ eq : master ] ) , which models evolution @xmath56 , shows a separation of timescales which is absent in the dynamics of @xmath47 and @xmath54 .",
    "this may suggest different coarse variables to represent @xmath56 , that may better reflect the timescale separation in the evolution of @xmath56 .",
    "another possibility for improvement of the accuracy of the coarse euler method lies in the improvement of the projective step . in the current paper",
    ", we have used a linear least squares fit to extrapolate the values of the coarse variables .",
    "we assumed here that the evolution of the coarse variables can be described by a deterministic equation .",
    "these deterministic coarse variables are ensemble averages of stochastic variables ( such as number of micelles in a simulation box , considered in the current papers ) .",
    "it may be advantageous to take the stochasticity of this dynamics into account in the projective integration step ; instead of fitting a deterministic model one may attempt to fit a _ stochastic _ model for the evolution of the observables , as is done in the companion paper @xcite .",
    "better extrapolation schemes ( e.g. based on maximum likelihood estimation and templated on adams - bashforth methods @xcite ) which would incorporate filtering and take into account the correlations between values of the coarse variables at consecutive time steps , may lead to more efficient algorithms .",
    "comparable statements also apply to the coarse newton method .",
    "the point of this paper has been the illustration of a possible bridge between traditional , continuum numerical methods and modern atomistic / microscopic simulations ( here , gcmc simulations of micelle formation ) given the appropriate coarse observables , the detailed ( here gcmc ) simulator is initialized _ conditioned on _ the observables and then evolved for a ( macroscopically ) short time .",
    "the computational data are used to fit a local macroscopic evolution equation which we assume exists . in this paper",
    "we fit only the deterministic component of this equation ; more generally one can try to fit a local stochastic differential equation . the local model is then used to design appropriate initial conditions for new , subsequent computational experiments with the detailed simulator ; the protocol for this  design of computational experiments \"",
    "is provided by continuum numerical algorithms , such as initial value problem solvers ( e.g. forward euler ) , fixed point solvers ( e.g. newton raphson ) eigensolvers etc .",
    "smoothness ( taylor series ) at the level of the macroscopic observables is the underlying point of these methods ; and what makes them possible is the ability to initialize the microscopic simulator essentially  at will \" , consistent with macroscopic observables .",
    "it is appropriate to close this paper with a short  advertisement \" for the companion one @xcite .",
    "in this paper we assumed an underlying smooth deterministic model for the expected behavior of the macroscopic observables .",
    "for certain stochastic systems ( exemplified by a particle in a double well under the effect of noise ) , the long term behavior of the system statistics ( approach to a final equilibrium density ) may well be modeled by continuum equations .",
    "one has to collect simulation data for a single particle over long times , before one can observe the rate of density evolution . for such systems",
    ", it may be more appropriate to fit the short term dynamics in terms of a stochastic differential equation ( e.g. a langevin - type equation ) .",
    "the long characteristic times for the equilibration of our simulation are indeed governed by rare events ( the formation and destruction of micelles ) . in the companion paper",
    "we will show how to use similar  coarse computation \" methods to design experiments based on an _ effective stochastic evolution equation _ for the macroscopic observables , rather than the _ effective deterministic evolution equation _",
    "we used here .",
    ", @xmath58 to @xmath162 , @xmath60 : ( a ) average small cluster size @xmath43 , ( b ) standard deviation @xmath44 of the small cluster size , and ( c ) average number @xmath41 of molecules contained in the small clusters the plots are obtained from averaging of 500 mc realizations .",
    "the error bars are indicated by the thin lines .",
    ", width=480 ]    , @xmath58 to @xmath162 , @xmath60 : ( a ) average micelle size @xmath39 , ( b ) standard deviation @xmath40 of the micelle size , ( c ) average number @xmath47 of micelles in the system , and ( d ) standard deviation @xmath54 of number of micelles in the system .",
    "the plots are obtained from averaging of 500 mc realizations .",
    "the error bars are indicated by the thin lines .",
    ", width=480 ]     and the average micelle size . shown",
    "are simulation results for two sets of parameter values : low surfactant density , @xmath163 ( thick line ) and high surfactant density , @xmath164 ( thin line ) .",
    "both of these simulations have been initialized from a configuration at @xmath165 .",
    "the reported correlation functions are obtained from averaging of 500 mc realizations .",
    ", width=480 ]           copies of the system ( solid lines ) : ( a ) evolution of probability distribution @xmath167 , each line corresponds to a different state @xmath78 , @xmath168 ; ( b ) evolution of the mean @xmath47 , and ( c ) evolution of the standard deviation @xmath54 .",
    "time here is measured in millions of gcmc steps .",
    "circles in plots ( b ) and ( c ) show results of the coarse projective euler method for @xmath156 copies ( black circles ) , @xmath169 copies ( dark gray circles ) , and @xmath159 copies ( light gray circles ) .",
    ", width=480 ]     of projection for @xmath148 , @xmath149 as a function of the normalized extrapolation time @xmath140 ; the thick gray line shows the kmc results and the thin black dashed line shows the quadratic fit ; ( b ) triangles : scaling of the coefficient @xmath50 with respect to @xmath126 , @xmath170 is fixed ; circles : scaling of @xmath50 with respect to @xmath139 ; @xmath148 is fixed .",
    "the dashed lines show the logarithmic fit.,width=480 ]     and closed symbols show simulations with @xmath171 .",
    "circles show iterations of the newton method with the forward difference estimate of the jacobian and squares show the iterations with the central difference estimate of the jacobian .",
    "dashed lines show the estimate of the equilibrium .",
    "solid lines are shown to guide the eye.,width=480 ]"
  ],
  "abstract_text": [
    "<S> we establish , through coarse - grained computation , a connection between traditional , continuum numerical algorithms ( initial value problems as well as fixed point algorithms ) and atomistic simulations of the larson model of micelle formation . </S>",
    "<S> the procedure hinges on the ( expected ) evolution of a few slow , coarse - grained mesoscopic observables of the mc simulation , and on ( computational ) time scale separation between these and the remaining  slaved \" , fast variables . </S>",
    "<S> short bursts of appropriately initialized atomistic simulation are used to estimate the ( coarse - grained , deterministic ) local dynamics of the evolution of the observables . </S>",
    "<S> these estimates are then in turn used to accelerate the evolution to computational stationarity through traditional continuum algorithms ( forward euler integration , newton - raphson fixed point computation ) . </S>",
    "<S> this  </S>",
    "<S> equation - free \" framework , bypassing the derivation of explicit , closed equations for the observables ( e.g. equations of state ) may provide a computational bridge between direct atomistic / stochastic simulation and the analysis of its macroscopic , system - level consequences . </S>"
  ]
}