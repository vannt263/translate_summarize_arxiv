{
  "article_text": [
    "in an important paper , m. e. j. newman studied a network - based susceptible - infectious - removed ( sir ) epidemic model in which infection is transmitted through a network of contacts between individuals @xcite .",
    "the contact network itself was a random undirected network with an arbitrary degree distribution of the form studied by newman , strogatz , and watts @xcite .  given the degree distribution , these networks are maximally random .",
    "thus , they have no small loops in the limit of a large population @xcite .     in the sir model from @xcite , the probability that an infected node @xmath0 makes infectious contact with an adjacent node @xmath1",
    "is given by @xmath2 , where @xmath3 is the rate of infectious contact from @xmath0 to @xmath1 and @xmath4 is the time that @xmath0 remains infectious .",
    "( in this paper , we use _ infectious contact _ to mean a contact that results in infection if and only if the recipient is susceptible . )  the recovery period @xmath4 is a random variable with the cumulative distribution function ( cdf ) @xmath5 and the infectious contact rate @xmath3 has the cdf @xmath6 .",
    "the infectious periods for all individuals are independent and identically distributed ( iid ) and the infectious contact rates for all ordered pairs of individuals are iid",
    ".     this model can be analyzed by mapping the sir model onto a semi - directed network that we call the _ epidemic percolation network _ @xcite .",
    "since the distribution of recovery periods for all nodes and the joint distribution of contact rates for all pairs of connected nodes are defined _ a priori _ , all relevant transmission probabilities can be determined by assigning the infectious periods and contact rate pairs before an epidemic begins .",
    "starting from the contact network , a single realization of the epidemic percolation network can be generated as follows :    1 .",
    "choose a recovery period @xmath4 for every node @xmath0 and choose a contact rate @xmath3 for every ordered pair of connected nodes @xmath0 and @xmath1 in the contact network .",
    "2 .   for each pair of connected nodes @xmath0 and @xmath1 in the contact network , convert the undirected edge between them to a directed edge from @xmath0 to @xmath1 with probability @xmath7 to a directed edge from @xmath1 to @xmath0 with probability @xmath8 and erase the edge completely with probability @xmath9 .",
    "the edge remains undirected with probability @xmath10    the epidemic percolation network is a semi - directed network that represents a single realization of the infectious contact process for each connected pair of nodes , so @xmath11 possible epidemic percolation networks exist for a contact network with @xmath12 edges .",
    "the probability of each network is determined by the underlying sir model .",
    "the epidemic percolation network is very similar to the locally dependent random graph defined by kuulasmaa @xcite for an epidemic on a @xmath13-dimensional lattice , with two important differences : first , the underlying structure of the contact network is not assumed to be a lattice .",
    "second , we replace pairs of ( occupied ) directed edges between two nodes with a single undirected edge .",
    "the idea of the epidemic percolation network is also similar to the idea of forward and backward branching processes , which have been used to derive the probability and final size of an epidemic , respectively , in sir models with independent infectiousness and susceptibility @xcite .",
    "the epidemic percolation network can be thought of as a simultaneous mapping of the forward and backward branching processes that generalizes to models with arbitrary joint distributions of infectiousness and susceptibility .",
    "( the relationship between epidemic percolation networks and branching processes is discussed further in section 5.1 . )     in the appendix , we define epidemic percolation networks for a very general time - homogeneous stochastic sir epidemic model ( which includes network - based models and models with random and proportionate mixing as special cases ) and prove that the size distribution of outbreaks starting from node @xmath0 is identical to the distribution of its out - component sizes in the corresponding probability space of percolation networks .  because of this equality of distribution , epidemic percolation networks can be used to analyze a much more general class of epidemic models than that defined in the introduction .  in this paper , we show how they can be used to analyze stochastic sir epidemic models with random or proportionate mixing .      in this subsection",
    ", we review the structure of directed and semi - directed networks as discussed in @xcite .  reviews of the structure and analysis of undirected and purely directed networks can be found in @xcite .",
    "the _ indegree _ and _ outdegree _ of node @xmath0 are the number of incoming and outgoing directed edges incident to @xmath0 .  since each directed edge is an outgoing edge for one node and an incoming edge for another node , the mean indegree and outdegree of a semi - directed network are equal .  the _ undirected degree _ of node @xmath0 is the number of undirected edges incident to @xmath0 .",
    "a _ component _ is a maximal group of connected nodes .",
    "the _ size _ of a component is the number of nodes it contains and its _ relative size _ is its size divided by the total size of the network .",
    "there are four types of components in a semi - directed network .",
    "the _ out - component _ of node @xmath0 includes @xmath0 and all nodes that can be reached from @xmath0 by following a series of edges in the proper direction ( undirected edges are bidirectional ) .",
    "the _ in - component _ of node @xmath0 includes @xmath0 and all nodes from which @xmath0 can be reached by following a series of edges in the proper direction .  by definition ,",
    "node @xmath0 is in the in - component of node @xmath1 if and only if @xmath1 is in the out - component of @xmath0 .",
    "therefore , the mean size of in- and out - components in any semi - directed network must be equal .",
    "the _ strongly - connected component _ of a node @xmath0 is the intersection of its in- and out - components ; it is the set of all nodes that can be reached from node @xmath0 and from which node @xmath0 can be reached .",
    "all nodes in a strongly - connected component have the same in - component and the same out - component .",
    "the _ weakly - connected component _ of node @xmath0 is the set of nodes that are connected to @xmath0 when the direction of the edges is ignored .     for giant components",
    ", we use the definitions given in @xcite .",
    "giant components are so called because they have asymptotically positive relative size in the limit of a large population .",
    "all other components are `` small '' in the sense that they have asymptotically zero relative size .",
    "there are two phase transitions in a semi - directed network : one where a unique giant weakly - connected component ( gwcc ) emerges and another where unique giant in- , out- , and strongly - connected components ( gin , gout , and gscc ) emerge .",
    "the gwcc contains the other three giant components .",
    "the gscc is the intersection of the gin and the gout , which are the common in- and out - components of nodes in the gscc .",
    "_ tendrils _ are components in the gwcc that are outside the gin and the gout .",
    "_ tubes _ are directed paths from the gin to the gout that do not intersect the gscc .",
    "all tendrils and tubes are small components .",
    "a schematic representation of these components is shown in figure [ bowtie ] .",
    "an _ outbreak _ begins when one or more nodes are infected from outside the population .",
    "these are called _",
    "imported infections_.  the _ final size _ of an outbreak is the number of nodes that are infected before the end of transmission , and its _ relative final size _ is its final size divided by the total size of the network .",
    "the nodes infected in the outbreak can be identified with the nodes in the out - components of the imported infections .",
    "this identification is made mathematically precise in the appendix .",
    "we define a _ self - limited outbreak _ to be an outbreak whose relative final size approaches zero in the limit of a large population .",
    "an _ epidemic _ is an outbreak whose relative final size is positive in the limit of a large population .  for many sir epidemic models ( including the one in the introduction )",
    ", there is an _ epidemic threshold : _ the probability of an epidemic is zero below the epidemic threshold and the probability and relative final size of an epidemic are positive above the epidemic threshold @xcite .",
    "if all out - components in the epidemic percolation network are small , then only self - limited outbreaks are possible .  if the epidemic percolation network contains a gscc , then any infection in the gin will lead to the infection of the entire gout .",
    "therefore , the epidemic threshold corresponds to the emergence of the gscc in the epidemic percolation network .  for any set of imported infections , the probability of an epidemic is equal to the probability that at least one imported infection occurs in the gin .  for any finite set of imported infections ,",
    "the relative final size of an epidemic is asymptotically equal to the proportion of the network contained in the gout .",
    "although some nodes outside the gout may be infected ( e.g. tendrils and tubes ) , they will constitute a finite number of small components whose total relative size is asymptotically zero .",
    "this argument can be extended to epidemic percolation networks for heterogeneous populations .",
    "the size distribution of outbreaks starting from an initial infection in any given node @xmath0 is equal to the distribution of the out - component sizes of node @xmath0 in the probability space of epidemic percolation networks .  in the limit of a large population , the probability that the infection of node @xmath0 causes",
    "an epidemic is equal to the probability that @xmath0 is in the gin and the probability that @xmath0 is infected in an epidemic is equal to the probability that @xmath0 is in the gout .",
    "note that the size distribution of outbreaks and the probability of an epidemic can depend on the initial infection(s ) , but the relative final size of an epidemic does not .       in this paper ,",
    "we show how epidemic percolation networks can be used to analyze stochastic sir epidemic models with random or proportionate mixing .",
    "methods exist to calculate the final size distribution of epidemics for such models in a population of size @xmath14 , but they require solving a recursive system of @xmath14 equations @xcite",
    ".  we will show how the size distribution of outbreaks , the epidemic threshold , and the probability and relative final size of a large epidemic can be calculated in the limit of large @xmath14 by solving a much simpler set of equations",
    ".  these methods also generalize more easily to heterogeneous populations .",
    "we will show that these methods are equivalent to branching processes when the indegree and outdegree of the epidemic percolation network are independent , and we will use them to re - derive classical results from several areas of theoretical infectious disease epidemiology .     the rest of the paper is organized as follows : in section 2 , we find the degree distributions of the epidemic percolation networks corresponding to sir models with random and proportionate mixing .  in section 3",
    ", we review the use of probability generating functions to analyze semi - directed networks and show how these simplify in the case of purely directed networks .  in section 4 , we present a series of simulations to show that epidemic percolation networks accurately predict the mean outbreak size and the probability and final size of an epidemic for sir models with random and proportionate mixing .  in section 5",
    ", we show that epidemic percolation networks with independent indegree and outdegree are equivalent to ( forward and backward ) branching processes and re - derive classical results from the epidemiology of sexually transmitted diseases , vector - borne diseases , and controlled diseases .  in the appendix",
    ", we show that an epidemic percolation network can be defined for any time - homogeneous stochastic sir epidemic model in a closed population and prove that the distribution of outbreaks starting from a node @xmath0 is equal to the distribution of its out - component sizes in the corresponding probability space of epidemic percolation networks .",
    "we conclude that the theory of percolation on semi - directed networks provides a very general framework for the analysis of stochastic sir epidemic models in closed populations .",
    "in this section , we derive probability generating functions for the degree distributions of epidemic percolation networks corresponding to sir models with random mixing and proportionate mixing .",
    "the most important difference between epidemic models with random mixing and network - based models is that the infectious contact rate between any pair of nodes is inversely proportional to the population size .",
    "we deal first with random mixing and introduce proportionate mixing as a generalization .  to introduce random mixing , we modify the epidemic model from the introduction in three ways :    1 .",
    "the contact network is always a complete graph , so infection can be transmitted between any two individuals .   2 .",
    "we relax that assumption ( from @xcite ) that @xmath3 and @xmath15 are iid .  instead , we let @xmath3 and @xmath15 have a joint distribution @xmath16 that is symmetric in its arguments ( i.e. @xmath17 for all @xmath18 )",
    ".  this symmetry forces the joint distribution of contact rates between any two individuals to be independent of the indices assigned to them .",
    "3 .   in a population of size",
    "@xmath14 , the contact rate from @xmath0 to @xmath1 @xmath19 and the contact rate from @xmath1 to @xmath0 is @xmath20 , where @xmath3 and @xmath15 have the joint distribution @xmath16 from above .",
    "the epidemic percolation network for a random mixing model is defined in the same way as that for a network - based model , except that @xmath19 replaces @xmath3 .",
    "let @xmath21 be the conditional probability generating function ( pgf ) for the number of incoming , outgoing , and undirected edges incident to node @xmath0 that appear between @xmath0 and @xmath1 in the epidemic percolation network given @xmath14 , @xmath4 , @xmath3 , @xmath22 , and @xmath15 .",
    "then @xmath23 is @xmath24x\\\\ & + [ 1-\\exp(-\\frac{r_{i}\\beta_{ij}}{n-1})]\\exp(-\\frac{r_{j}\\beta_{ji}}% { n-1})y+[1-\\exp(-\\frac{r_{i}\\beta_{ij}}{n-1})][1-\\exp(-\\frac{r_{j}\\beta_{ji}% } { n-1})]u.\\end{aligned}\\ ] ] in the limit of large @xmath14 , @xmath25 so undirected edges disappear in the limit of a large population .",
    "given @xmath4 and @xmath14 , the conditional pgf for the number of incoming , outgoing , and undirected edges incident to @xmath0 that appear between @xmath0 and a node @xmath26 can be found by integrating over the distribution of possible @xmath27 and @xmath22 : @xmath28e[\\beta](x-1)+r_{i}e[\\beta](y-1)}{n-1}+o(n^{-1}).\\end{aligned}\\ ] ] given @xmath4 and @xmath14 , the conditional pgf for the total number of incoming and outgoing edges incident to @xmath0 in the percolation network is @xmath29e[\\beta](x-1)+r_{i}e[\\beta](y-1)}{n-1}+o(n^{-1}))^{n-1}.\\ ] ] in the limit of large @xmath14 , this converges to @xmath30e[\\beta](x-1)+r_{i}e[\\beta](y-1)}.\\ ] ] therefore , the pgf for the degree distribution of the percolation network in the limit of a large population is @xmath31e[\\beta](x-1)}\\int_{0}^{\\infty}e^{re[\\beta](y-1)}% df(r).\\label{gxy}%\\ ] ]    several results follow immediately from inspection of this function : first , undirected edges vanish in the limit of a large population , leaving a purely directed epidemic percolation network .",
    "second , the indegree and outdegree of nodes in the epidemic percolation network are independent .",
    "third , the indegree has a poisson distribution with mean @xmath32e[\\beta]$ ] .",
    "finally , the outdegree has a conditional poisson distribution for any given recovery period @xmath33 .  the mean outdegree is @xmath32e[\\beta]$ ] as required , but the outdegree distribution is not necessarily poisson .",
    "for example , if @xmath34 exponential(@xmath35 ) , then the outdegree has a geometric(@xmath36}$ ] ) distribution .",
    "more generally , if @xmath34 gamma(@xmath37 ) , then the outdegree has a negative binomial(@xmath38}$ ] ) distribution .       a useful generalization of the sir model with random mixing is to allow the population to be composed of @xmath39 distinct subpopulations , where each subpopulation @xmath40 constitutes a proportion @xmath41 of the overall population .",
    "let @xmath42 be the cumulative distribution function for the recovery period of nodes in subpopulation @xmath40 .",
    "in addition , let each subpopulation @xmath40 have a relative infectiousness @xmath43 and a relative susceptibility @xmath44 .  if nodes @xmath0 and @xmath1 are in subpopulations @xmath45 and @xmath46 , then the infectious contact rate from @xmath0 to @xmath1 is @xmath47 and the infectious contact rate from @xmath1 to @xmath0 is @xmath48 , where @xmath3 and @xmath15 have a joint distribution function @xmath16 as before .",
    "this formulation for an epidemic model with a heterogeneous population is called _ proportionate mixing _ @xcite .",
    "since the relative infectiousness and relative susceptibility are each determined only up to a multiplicative constant , we assume without loss of generality that @xmath49\\alpha_{k}=\\sum_{k=1}^{k}w_{k}\\gamma_{k}=1.\\ ] ]    let @xmath50 be the conditional pgf for the number of incoming , outgoing , and undirected edges incident to @xmath0 that appear between nodes @xmath0 and @xmath1 in subpopulations @xmath45 and @xmath51 in the percolation network given @xmath3 , @xmath52 , @xmath4 , @xmath22 , and @xmath14 .",
    "then @xmath53 equals @xmath54 let @xmath55 be the conditional pgf for the number of incoming , outgoing , and undirected edges incident to @xmath0 that appear between @xmath0 and a node @xmath26 given @xmath45 , @xmath4 , and @xmath14 .",
    "then @xmath56\\alpha_{k_{j}}% e[\\beta]\\gamma_{k_{i}}(x-1)+r_{i}\\alpha_{k_{i}}e[\\beta]\\gamma_{k_{j}}% ( y-1)}{n-1}+o(n^{-1})].\\end{aligned}\\ ] ] the conditional pgf for the total number of incoming , outgoing , and undirected edges incident to node @xmath0 given @xmath4 and @xmath14 is @xmath57\\alpha_{k}e[\\beta]\\gamma_{k_{i}}% ( x-1)+r_{i}\\alpha_{k_{i}}e[\\beta]\\gamma_{k}(y-1)}{n-1}+o(n^{-1})]^{w_{k}(n-1)}%\\ ] ] in the limit of large @xmath14 , this becomes @xmath58\\alpha_{k}% e[\\beta]\\gamma_{k_{i}}(x-1)+r_{i}\\alpha_{k_{i}}e[\\beta]\\gamma_{k}(y-1)]}\\\\ & = e^{e[\\beta]\\gamma_{k_{i}}(x-1)+r_{i}\\alpha_{k_{i}}e[\\beta](y-1)}.\\end{aligned}\\ ] ] integrating over the distribution of infectious periods in subpopulation @xmath45 yields @xmath59\\gamma_{k_{i}}(x-1)}\\int_{0}^{\\infty}e^{r_{i}\\alpha_{k_{i}% } e[\\beta](y-1)}df_{i_{k}}(r_{i}).\\end{aligned}\\ ] ] note that the indegree distribution of subpopulation @xmath45 has a poisson distribution , the outdegree distribution is a mixture of poisson distributions , and the indegree and outdegree are independent within subpopulation @xmath45 .",
    "finally , the pgf for the degree distribution of the epidemic percolation network in the limit of a large population is : @xmath60    the proportional mixing assumption has two important consequences that enormously simplify the analysis of the epidemic percolation network : first , the probability that an edge terminates at a node in subpopulation @xmath40 is proportional to the expected indegree of subpopulation @xmath40 and independent of the node at which the edge began .",
    "second , the probability that an edge originates at a node in subpopulation @xmath40 is proportional to the expected outdegree of subpopulation @xmath40 and independent of the node at which the edge terminates .  to prove the first , we observe that the total number of directed edges to nodes in subpopulation @xmath61 from a node @xmath0 in subpopulation @xmath45 with recovery period @xmath4 is a sum of @xmath62 iid bernoulli random variables with mean @xmath63\\gamma_{k_{0}}}{n-1}+o(n^{-1})\\ ] ] in the limit of large @xmath14 , the number of outgoing edges from node @xmath0 to nodes in subpopulation @xmath61 has a poisson distribution with mean @xmath64\\gamma_{k_{0}}).\\ ] ] the total number of outgoing edges from node @xmath0 has a poisson distribution with mean @xmath65 $ ] , which is a sum of @xmath39 poisson random variables with means @xmath66\\gamma_{k})$ ] , @xmath67 .  by the strong law of large numbers",
    ", the proportion of these edges that terminate at nodes in subpopulation @xmath61 converges almost surely to @xmath68 , which is proportional to the expected indegree of subpopulation @xmath61 and independent of @xmath45 and @xmath4 .",
    "a similar argument shows that the proportion of incoming edges to node @xmath0 that originate at nodes in subpopulation @xmath61 converges almost surely to @xmath69\\alpha_{k_{0}}$ ] , which is proportional to the expected outdegree of subpopulation @xmath61 and independent of @xmath45 and @xmath4 .",
    "methods of calculating the size distribution of small components , the percolation threshold , and the proportion of a network contained in the gin , the gout , and the gscc for semi - directed networks with arbitrary degree distributions have been developed by bogu and serrano @xcite  and meyers , newman , and pourbohloul @xcite .  for purely directed and purely undirected networks ,",
    "these methods simplify to equations derived by newman , strogatz , and watts @xcite .  in this section",
    ", we outline the methods for semi - directed networks and show how they simplify in the case of purely directed networks .",
    "this discussion is adapted from our previous paper @xcite and introduces notation that will be used in the rest of this paper .  for readers who desire an introduction to random graphs and percolation on networks , we recommend albert and barabsi @xcite and newman @xcite .",
    "the networks considered here have no small loops and no two - point degree correlations ( i.e. the degree of a node reached by following an edge forward or backward is independent of the degree of the node from which we start ) .  as shown above ,",
    "this is sufficient for models with random and proportionate mixing .",
    "since these methods assume no clustering of contacts , they do not apply to epidemics on networks with spatial structure @xcite , small - world networks @xcite , or other clustered networks @xcite .",
    "the development of methods for clustered networks is an area of active research @xcite .",
    "nonetheless , the isomorphism to an epidemic percolation network is valid for any time - homogeneous sir model , including models that can not be analyzed via the generating function formalism outlined here .    if @xmath70 , @xmath71 , and @xmath72 are nonnegative integers , let @xmath73 be the derivative obtained after differentiating @xmath70 times with respect to @xmath74 , @xmath71 times with respect to @xmath75 , and @xmath72 times with respect to @xmath76 .",
    "then the mean indegree of the epidemic percolation network is @xmath77 and the mean outdegree is @xmath78 .",
    "let @xmath79 denote the common mean of the directed degrees .",
    "the mean undirected degree is @xmath80 .  for the epidemic percolation network for the homogeneous sir model with random mixing , @xmath81 @xmath32e[\\beta]$ ] and @xmath82 .",
    "let @xmath83 be the pgf for the degree distribution of a node reached by going forward along a directed edge , excluding the edge used to reach the node .",
    "since the probability of reaching any node by following a directed edge is proportional to its indegree , @xmath84 similarly , the pgf for the degree distribution of a node reached by going in reverse along a directed edge ( excluding the edge used to reach it ) is @xmath85 and the pgf for the degree distribution of a node reached by following an undirected edge ( excluding the edge used to reach it ) is @xmath86 the above definitions require that @xmath87 and @xmath88 .  in a purely undirected network ( i.e. @xmath89 ) , we arbitrarily set @xmath90 for all @xmath74 , @xmath75 , and @xmath76 .",
    "@xmath91 in a purely directed network ( i.e. @xmath92 ) , we arbitrarily set @xmath93 for all @xmath74 , @xmath75 , and @xmath76 .",
    "let @xmath94 be the pgf for the size of the out - component at the end of a directed edge and @xmath95 be the pgf for the size of the out - component at the `` end '' of an undirected edge .",
    "then , in the limit of a large population ,    @xmath96    the pgf for the out - component size of a randomly chosen node is    @xmath97    in a purely directed network , @xmath98 for all @xmath99 because @xmath93 for all @xmath74 , @xmath75 , and @xmath76 .",
    "@xmath91thus @xmath100 and @xmath101 .",
    "given power series for @xmath94 and @xmath95 that are accurate to @xmath102 , equations ( [ hf , out ] ) and ( [ hu , out ] ) can be used to obtain series that are accurate to @xmath103 .  with power series for @xmath104 and @xmath95 that are accurate to @xmath102 , equation ( [ hout ] ) can be used to obtain a power series for @xmath105 that is accurate to @xmath103 .",
    "the coefficients on @xmath106 in @xmath94 and @xmath95 are @xmath107 and @xmath108 respectively .",
    "therefore , power series for @xmath94 , @xmath95 , and @xmath105 can be computed to any desired order .  for any @xmath109 $ ]",
    ", @xmath94 and @xmath95 can be calculated with arbitrary precision by iterating equations ( [ hf , out ] ) and ( [ hu , out ] ) starting from initial values @xmath110 .",
    "estimates of @xmath104 and @xmath95 can be used to obtain estimates of @xmath105 with arbitrary precision .     in the limit of a large population ,",
    "the probability that a node has a finite out - component is @xmath111 , so the probability that a randomly chosen node is in the gin is @xmath112 .",
    "the expected size of the out - component of a randomly chosen node is @xmath113 .",
    "taking derivatives in equation ( [ hout ] ) yields @xmath114 taking derivatives in equations ( [ hf , out ] ) and ( [ hu , out ] ) and using the fact that @xmath115 below the epidemic threshold yields a set of linear equations for @xmath116 and @xmath117 .  these can be solved to yield @xmath118 and @xmath119 where the argument of all derivatives is @xmath120 .  in a purely directed network ,",
    "all derivatives involving @xmath121 are zero , so @xmath122 and @xmath123      the in - component size distribution of a semi - directed network can be derived using the same logic used to find the out - component size distribution , except that we consider going backwards along edges .",
    "let @xmath124 be the pgf for the size of the in - component at the beginning of a directed edge , @xmath125 be the pgf for the size of the in - component at the `` beginning '' of an undirected edge , and @xmath126 be the pgf for the in - component size of a randomly chosen node .",
    "then    [ hur , in]@xmath127 power series to arbitrary degrees and numerical estimates with arbitrary precision can be obtained for @xmath124 , @xmath125 , and @xmath126 by iterating these equations in the manner described for @xmath94 , @xmath95 , and @xmath105 .  in a purely directed network ,",
    "@xmath128 for all @xmath99 because @xmath93 for all @xmath74 , @xmath75 , and @xmath76 .",
    "@xmath91thus @xmath129 and @xmath130 .     in the limit of a large population ,",
    "the probability that a node has a finite in - component is @xmath131 , so the probability that a randomly chosen node is in the gout is @xmath132 .",
    "the expected size of the in - component of a randomly chosen node is @xmath133 .",
    "taking derivatives in equation ( [ hin ] ) yields    @xmath134    taking derivatives in equations ( [ hr , in ] ) and ( [ hu , in ] ) and using the fact that @xmath135 in a subcritical network yields @xmath136 and @xmath137 where the argument of all derivatives is @xmath120 .  in a purely directed network , all derivatives involving @xmath121 are zero , so @xmath138 and @xmath139      the epidemic threshold occurs when the expected size of the in- and out - components in the network becomes infinite .",
    "equations ( [ hfout(1 ) ] ) and ( [ huout(1 ) ] ) show that the mean out - component size becomes infinite when @xmath140 and equations ( [ hrin(1 ) ] ) and ( [ huin(1 ) ] ) show that the mean in - component size becomes infinite when @xmath141 from the definitions of @xmath83 , @xmath142 and @xmath143 , both conditions are equivalent to @xmath144 therefore , there is a single epidemic threshold where the gscc , the gin , and the gout appear simultaneously .     in a purely directed network ,",
    "the condition for this epidemic threshold is much simpler because all derivatives with respect to @xmath76 and all derivatives of @xmath121 are zero : the mean out - component size becomes infinite when @xmath145 and the mean in - component size becomes infinite when @xmath146 .",
    "both of these conditions are equivalent to @xmath147 .       in the limit of a large population ,",
    "a node is in the gscc if and only if its in- and out - components are both infinite .",
    "a randomly chosen node has a finite in - component with probability @xmath148 and a finite out - component with probability @xmath149 .",
    "the probability that a node reached by following an undirected edge has finite in- and out - components is the solution to the equation @xmath150 and the probability that a randomly chosen node has finite in- and out - components is @xmath151 @xcite .",
    "thus , the relative size of the gscc is @xmath152 in a purely directed network , this simplifies to @xmath153",
    "the following series of simulations provides some examples of how an epidemic percolation network can be derived from an  sir model with random or proportionate mixing and used to analyze it .",
    "there are three series of homogeneous population models and three series of heterogeneous population models .",
    "predictions for the mean size of outbreaks and the probability and final size of an epidemic were easily obtained and consistently accurate .",
    "models were run on berkeley madonna 8.0.1 ( 1997 - 2000 robert i. macey & george f. oster ) and mathematica 5.0.0.0 ( 1988 - 2003 wolfram research , inc . ) .",
    "all simulations began with a single imported infection randomly chosen from the population .",
    "simulations in berkeley madonna used a poisson approximation to the number of new infections in each time step @xmath154 , with @xmath155 .",
    "simulations in mathematica were based on the general stochastic sir model from the appendix : a recovery time for each infected individual was sampled from the appropriate distribution .",
    "when person @xmath0 was infected , an infectious contact interval for each ordered pair @xmath156 , @xmath157 , was sampled from the appropriate distribution , and the corresponding infectious contact times were calculated .  the minimum infectious contact time for each susceptible individual was stored .",
    "the next infection occurred in the susceptible with the smallest infectious contact time .",
    "the epidemic ended when the minimum infectious contact time among the remaining susceptibles was infinite .",
    "an epidemic was defined to be an outbreak that infected more than 10% or 15% of the population .",
    "these percentages were chosen to obtain an outbreak size much larger than the expected size of self - limited outbreaks and much smaller than the expected size of an epidemic .  for @xmath158 near one , the mean self - limited outbreak size increases and the expected size of an epidemic decreases , leading to poor separation between self - limited outbreaks and epidemics .",
    "since the mean size of self - limited outbreaks approaches a constant and the mean size of an epidemic scales with the population size , this separation can be restored by taking a larger population size .",
    "however , the computational time required for an exact simulation varies roughly with the square of the population size .",
    "thus , we did not attempt simulations for @xmath158 below @xmath159 or @xmath160 .     in this section and the remainder of the paper , we deal exclusively with purely directed epidemic percolation networks .  to simplify notation",
    ", we drop the variable @xmath76 from @xmath161 .",
    "the first series of homogeneous population models had a fixed recovery time , the second series had exponentially - distributed recovery times , and the third series had ten different recovery time distributions .",
    "all models had a single imported infection randomly chosen from the population , a mean recovery time of one , and a basic reproductive number of @xmath158 .",
    "when the recovery time is fixed , the pgf for the degree distribution of the epidemic percolation network is @xmath162 , so the indegree and outdegree have independent poisson distributions with mean @xmath158 .",
    "the model was run at @xmath163 , @xmath160 , @xmath164 , @xmath165 , @xmath166 , @xmath167 , and @xmath168 .  at each @xmath158 ,",
    "the model was run @xmath169 times in a population of @xmath169 individuals .",
    "when the recovery time is exponentially distributed , the pgf for the degree distribution of the epidemic percolation network is @xmath170 so the indegree has a poisson distribution and the outdegree has a geometric distribution .  the mean indegree and outdegree are both @xmath158 .",
    "the model was run at @xmath171 , @xmath164 , @xmath165 , @xmath166 , @xmath167 , @xmath168 , @xmath172 , @xmath173 , @xmath174 , @xmath175 , and @xmath176 .  at each @xmath158 ,",
    "the model was run @xmath169 times with a population of @xmath169 individuals .",
    "details of the recovery time distributions for the third series of simulations are shown in table [ recdistributions ] .",
    "as in the other homogeneous population models , the indegree and outdegree are independent .",
    "the pgf for the indegree is @xmath177 .",
    "the pgf for the outdegree is @xmath178 the pgf for the degree distribution of the epidemic percolation network is @xmath179 .  for each recovery time distribution",
    ", models were run @xmath180 times with a population of @xmath181 individuals at @xmath171 , @xmath164 , @xmath165 , @xmath166 , @xmath167 , and @xmath168 .     in all homogeneous population models ,",
    "an epidemic was said to occur when more than @xmath182 of the population was infected .",
    "as outlined in section 3 , the predicted probability of an epidemic is @xmath112 and the predicted final size of an epidemic is @xmath132 .",
    "the predicted final size of an epidemic for a given @xmath158 was the same for all recovery time distributions , but figure [ p(epi)fig ] shows that the probability of an epidemic depends on both @xmath158 and the recovery time distribution .",
    "the probability and final size of an epidemic were equal only when the recovery time was fixed .",
    "for all other recovery time distributions , the probability of an epidemic was less than its final size ( this inequality is proven in @xcite ) .",
    "figure [ homp(epi ) ] shows a good agreement between the predicted and observed probabilities of an epidemic and figure [ homfs ] shows a good agreement between the observed and predicted final sizes of epidemics .       in the first two series of heterogeneous population models , the population consisted of two subpopulations @xmath183 and @xmath184 of equal size .  the average number of infectious contacts made by a member of subpopulation @xmath184 during his or her recovery period is @xmath35 .",
    "we assumed the following infectious contact rates from @xmath0 to @xmath1 in a population of size @xmath14 : @xmath185 when @xmath0 and @xmath1 are both members of subpopulation @xmath183 , @xmath186 when @xmath0 and @xmath1 are members of different subpopulations , and @xmath187 when @xmath0 and @xmath188 are both in subpopulation @xmath184 .",
    "all models had a mean recovery time of one .  with these assumptions ,",
    "the mean indegree and outdegree of subpopulation @xmath183 were @xmath189 and the mean indegree and outdegree of subpopulation @xmath184 were @xmath35 , producing a positive correlation between susceptibility and infectiousness .    when  the recovery period is fixed , the pgf for the degree distribution of the epidemic percolation network is @xmath190 when the recovery period is exponentially distributed , the pgf for the degree distribution of the epidemic percolation network is @xmath191 each model was run at @xmath192 and @xmath193 .  at each @xmath35 ,",
    "the model was run @xmath169 times .  for models with @xmath194 ,",
    "the population was @xmath169 .  for @xmath195 ,",
    "the population size was @xmath196 .  when @xmath195 , epidemics occur even though the mean degree of the network is less than one .",
    "both series of models were implemented in berkeley madonna .",
    "a third series of simulations was conducted in populations with various mixtures of recovery time distributions .",
    "the population had @xmath181 individuals partitioned into subpopulations @xmath183 and @xmath184 of @xmath197 individuals each .",
    "each model was run under two scenarios :  in the first scenario , subpopulation @xmath183 is twice as infectious per unit time and has the same mean recovery time as subpopulation @xmath184 .",
    "in the second scenario , both subpopulations are equally infectious per unit time but the mean recovery period of subpopulation @xmath183 is twice as long as that of @xmath184 .",
    "the degree distribution of the epidemic percolation network is identical under both scenarios .  in the first scenario",
    ", models were run for all nine possible combinations of the fixed@xmath198 , uniform@xmath199 , and exponential@xmath198 recovery time distributions .  in the second scenario",
    ", models were run for all nine possible combinations of fixed@xmath200 , uniform@xmath201 , and exponential@xmath202 in subpopulation @xmath183 and fixed@xmath198 , uniform@xmath199 , and exponential@xmath198 in subpopulation @xmath184 .",
    "these recovery time distributions are described in table [ recdistributions ] .",
    "every model was run @xmath203 times with @xmath204 .",
    "an epidemic was defined as an outbreak that infected more than @xmath205 of the population .",
    "a similar set of simulations was conducted where subpopulation @xmath183 had a mean indegree of @xmath35 and a mean outdegree of @xmath189 while subpopulation @xmath184 had a mean indegree of @xmath189 and a mean outdegree of @xmath35 , producing a negative correlation between infectiousness and susceptibility .",
    "all of these models were implemented in mathematica .    in the first two series of heterogeneous models , an epidemic was defined to occur when more than @xmath182 of the population was infected .",
    "the predicted probability and final size of an epidemic are @xmath112 and @xmath206 , respectively , according to the epidemic percolation network .  according to a branching process approximation , the predicted probability of an epidemic is @xmath207 , where @xmath208 and the predicted final size of an epidemic is @xmath209 , where @xmath210 figures [ branchingpr(epi ) ] and [ branchingsize ] compare the epidemic percolation network and branching process predictions of the probability and final size of an epidemic .",
    "these models have a positive correlation between infectiousness and susceptibility , so persons infected through indigenous transmission are more infectious than persons randomly selected from the population .",
    "since the branching process approximation implicitly assumes that persons infected through indigenous transmission have the same outdegree distribution as the general population , it consistently underestimates both the probability and final size of an epidemic .",
    "the epidemic percolation network consistently predicts the correct probability and final size of an epidemic .",
    "figure [ hetpr(epi ) ] shows a scatterplot of observed and predicted epidemic probabilities for all heterogeneous population models .",
    "the predicted probability of an epidemic for an initial case randomly chosen from the population is @xmath112 .",
    "the combined `` points show the observed and predicted epidemic probabilities for an initial case randomly chosen from the overall population .",
    "let @xmath211 and @xmath212 be the pgf of the degree distributions of nodes in subpopulations @xmath183 and @xmath184 respectively .",
    "the predicted probability of an epidemic for an initial case chosen randomly from subpopulation @xmath183 is @xmath213 , and the predicted probability of an epidemic for an initial case chosen randomly from subpopulation @xmath184 is @xmath214 .",
    "the subpopulation @xmath183 '' points show the observed and predicted epidemic probabilities for an initial case randomly chosen from subpopulation @xmath183 , and the subpopulation @xmath184 \" points show the observed and predicted epidemic probabilities for an initial case randomly chosen from subpopulation @xmath184 .",
    "all three sets of points are close to the diagonal , showing that epidemic percolation networks accurately predicted the probability of an epidemic .",
    "the predicted cumulative hazard of infection in an epidemic is @xmath215 .",
    "figure [ survival ] shows a scatterplot of the observed and predicted cumulative hazard of infection in an epidemic for all heterogeneous population models .",
    "all points are close to the diagonal , showing that epidemic percolation networks accurately predicted the final size of epidemics .",
    "figure [ finite ] shows a scatterplot of the observed and predicted mean size of outbreaks in the third series of heterogeneous population models .  the mean size of an outbreak started by a single , randomly chosen imported infection is @xmath113 .",
    "the combined `` points show the observed and predicted mean outbreak size for an initial case randomly chosen from the overall population .",
    "the mean size of an outbreak started by an imported infection randomly chosen from subpopulation @xmath183 is @xmath216 and the mean size of an outbreak started by an imported infection randomly chosen from subpopulation @xmath184 is @xmath217 the subpopulation @xmath183 '' points show the observed and predicted mean outbreak size for an initial case randomly chosen from subpopulation @xmath183 , and the subpopulation @xmath184 `` points show the observed and predicted mean outbreak size for an initial case randomly chosen from subpopulation @xmath184 .",
    "all three sets of points are close to the diagonal , showing that epidemic percolation networks accurately predicted the mean sizes of finite epidemics in these models .",
    "models with higher epidemic probabilities tend to have smaller outbreak sizes because large outbreaks are more likely to explode '' and become epidemics .",
    "in this section , we show that epidemic percolation networks can reproduce much of the standard theory of epidemics .",
    "when the indegree and outdegree are independent , the epidemic percolation networks predict the same distribution of outbreak sizes , epidemic threshold , and probability and final size of an epidemic as the forward and backward branching process approximations .",
    "epidemic percolation networks can also reproduce results from models developed specifically for special topics within infectious disease epidemiology .",
    "below , we give examples of the derivation of results from the epidemiology of sexually transmitted diseases , controlled diseases , and vector - borne diseases .       much of the mathematical theory of epidemics has been derived using a branching process as an approximation to the initial spread of disease , where the offspring `` of an individual are the persons he or she infects @xcite .",
    "the branching process approximation remains accurate until the first time at which an infectious individual transmits infection to a person who has already been infected , which happens after an arbitrarily long interval in the limit of a large population @xcite .",
    "we will call this the ' ' forward `` branching process approximation to the initial spread of disease , to distinguish it from the ' ' backward \" branching process discussed later .",
    "if the offspring distribution of a branching process has the pgf @xmath218 , then the probability that the branching process goes extinct is the smallest solution in @xmath219 $ ] of the equation @xmath220 .  if @xmath221 is the pgf for the total number of individuals generated by the branching process ( including the initial individual ) , then @xmath222 @xcite .",
    "_ when an epidemic percolation network has independent indegree and outdegree , it predicts exactly the same outbreak size distribution , epidemic threshold , and probability of an epidemic ( given the infection of a single randomly chosen node ) as a forward branching process approximation to the initial spread of disease .  _",
    "the pgf for the number of secondary infections produced by a randomly chosen imported infection is @xmath223 .",
    "the number of secondary infections produced by persons infected through indigenous transmission has the pgf @xmath224 where the second equality follows from the independence of the indegree and outdegree .",
    "therefore , the initial spread of disease behaves like a branching process whose offspring distribution has the pgf @xmath225 .  the probability of a self - limited outbreak ( i.e. no epidemic ) given the infection of a randomly chosen individual is the smallest solution in @xmath219 $ ] of @xmath226 , which is equivalent @xmath227 .",
    "similarly , @xmath228 and the pgf for outbreak sizes is @xmath229 , which is equivalent to @xmath230 .",
    "another important application of branching processes to sir models with random mixing is the use of a `` backward '' branching process to predict the relative final size of an epidemic , in which the `` offspring '' for each individual @xmath0 are the people who would make infectious contact with @xmath0 if they were infectious .",
    "the relative final size of the epidemic is equal to the probability that the backward branching process never goes extinct @xcite .",
    "_ when an epidemic percolation network has independent indegree and outdegree , it predicts exactly the same relative final size of an epidemic as a backward branching process . _    in the epidemic percolation network , the number of offspring in the backwards branching process for a randomly chosen individual has the pgf @xmath231 .",
    "the pgf for the number of offspring of persons reached by going in reverse along a directed edge is @xmath232 where the final equality follows from the independence of the indegree and outdegree .",
    "therefore , the process of moving backwards along edges in the epidemic percolation network is a branching process whose offspring distribution has the pgf @xmath233 .",
    "the probability that a node is not infected in an epidemic is the smallest solution in @xmath219 $ ] of @xmath234 , which equivalent to @xmath235 .",
    "therefore , the epidemic percolation network and the branching process predict the same relative final size of an epidemic .     in an sir model",
    "whose epidemic percolation network has independent indegree and outdegree , the epidemic percolation network is a simultaneous mapping of the forward and backward branching processes .",
    "however , a branching process assumes that the offspring distribution is the same in each generation of infection ( because the same pgf @xmath218 is used for each generation ) .",
    "this assumption fails in an epidemic percolation network in which the indegree and outdegree are not independent .",
    "epidemic percolation networks generalize to models with arbitrary joint degree distributions because they allow the offspring distribution of the initial node to be different from the offspring distribution of all subsequent generations in the forward and backward branching processes .",
    "if we go forward along edges starting from a randomly chosen node , the offspring distribution of the initial node has the pgf @xmath223 and the offspring distribution of nodes in all subsequent generations has the pgf @xmath236 .  if we go backward starting from a randomly chosen node , then the offspring distribution of the initial node has the pgf @xmath231 and all subsequent generations have the pgf @xmath237 .  when the indegree and outdegree are not independent , @xmath238 and @xmath239 , so both branching process approximations break down .",
    "we find it useful to think of the equations for the component size distributions in section 3 as describing ( forward or backward ) branching processes in which the initial node is allowed to have a different offspring distribution from all subsequent generations .     by mapping the forward and backward infectious contact processes simultaneously",
    ", the crucial role of the gscc in the emergence of epidemics becomes clear .  in a forthcoming manuscript",
    ", we analyze a proportionate mixing model with three subpopulations : one with the greatest probability of being in the gin , one with the greatest probability of being in the gout , and one with the greatest probability of being in the gscc .",
    "vaccinating nodes in the subpopulation most likely to be in the gscc is shown to be the most efficient strategy for reducing both the probability and final size of an epidemic despite the fact that such nodes were of average infectiousness and susceptibility .",
    "we have obtained similar results with network - based models .",
    "nodes with a high probability of being in the gscc are the core group \" that sustains transmission of infection in the population .  if the forward and backward infectious contact processes are treated separately , the notion of the gscc  is lost .",
    "the use of probability generating functions on epidemic percolation networks allows many classical results from the theory of epidemics to be re - derived very easily .",
    "below , we give derivations of results from three different areas of infectious disease epidemiology .",
    "the ability of epidemic percolation networks to encompass these results in a single conceptual framework is a striking demonstration of their utility and generality .",
    "[ sexually transmitted diseases]for many sexually transmitted diseases , variation in levels of sexual activity affect the dynamics of disease transmission .",
    "one important result is that @xmath158 for sexually transmitted diseases depends on both the mean and the variance of the number of sexual partners @xcite .",
    "let @xmath240 be a random variable representing the expected number of sexual partners a person has during his or her recovery period .",
    "if the hazard of infection is proportional to @xmath240 , then@xmath241   , \\ ] ] where @xmath242 and @xmath243 are the mean and variance of the number of sexual partners and @xmath244 is the probability of transmission for each partnership @xcite .",
    "we first partition the population into subpopulations @xmath245 such that subpopulation @xmath0 consists of all persons with @xmath246 .",
    "the proportion of the population in subpopulation @xmath0 is equal to @xmath247 .  since there is a constant probability @xmath244 of transmission for each partnership and @xmath246 is the expected number of partners during the recovery period , the mean outdegree of subpopulation @xmath0 is @xmath248 .",
    "since the hazard of infection in subpopulation @xmath0 is also proportional to @xmath0 , the mean indegree of subpopulation @xmath0 must also be @xmath248 .",
    "the indegree and outdegree of each individual are conditionally independent given @xmath240 , so the pgf for the degree distribution of nodes in subpopulation @xmath0 can be written @xmath249 the pgf of the degree distribution of the epidemic percolation network is @xmath250 the overall mean degree is @xmath251 , and the epidemic threshold is @xmath252   .\\ ] ] therefore , the epidemic percolation network correctly predicts the epidemic threshold for this model .",
    "however , it can also predict the size distribution of outbreaks and the probability and final size of an epidemic .",
    "epidemic percolation networks can also be used to analyze sir  models with more complex relationships between sexual activity , infectiousness , and susceptibility .",
    "[ outbreaks of controlled diseases]for diseases that have been eliminated within a specific country but are not eradicated worldwide ( such as measles in the united states ) , imported cases and cases secondary to importation can still occur .  to evaluate the success of a disease elimination program , it is important to determine whether the observed pattern of outbreaks is consistent with sustained indigenous transmission .",
    "this can be inferred from the final size distribution of outbreaks .  if infectiousness and susceptibility are independent and cases generate secondary cases according to a poisson distribution with mean @xmath253 , all epidemics are finite and epidemic sizes follow a borel - tanner distribution @xcite .",
    "the probability that an outbreak has a final size of @xmath40 is @xmath254 the pgf for the borel - tanner distribution is the unique solution to the equation    @xmath255    below the phase transition , the pgf for the distribution of outbreak sizes in the epidemic percolation network is @xmath105 .",
    "since the incoming and outgoing degree are independent and the outgoing degree is poisson distributed with mean @xmath158 , @xmath256 but then @xmath257 which is identical to equation ( [ borel ] ) .",
    "therefore , @xmath258 , so the out - component sizes in the epidemic percolation network have a borel - tanner distribution .  using the fact that the probability of having an outbreak of size one is @xmath259 , it is easy to check that the first few iterations of equation ( [ bthout ] ) produce coefficients of the form in equation ( [ s ] ) .",
    "[ vector - borne diseases]the model of malaria developed by ross and macdonald consists of humans and mosquitoes .",
    "infected humans recover from malaria at a constant rate @xmath260 , so the average recovery period is @xmath261 .",
    "there are @xmath12 susceptible mosquitoes that bite with a rate @xmath70 and are infected with probability @xmath72 when they bite an infectious human , so each infectious human infects an average of @xmath262 susceptible mosquitoes .",
    "the mortality rate of mosquitoes is @xmath263 , so they survive for an average of @xmath264 time units after being infected .",
    "when an infectious mosquito bites a susceptible human , the human is infected with probability @xmath71 , so each infectious mosquito infects an average of @xmath265 humans .",
    "the epidemic threshold in this model is defined by@xmath266 this was one of the earliest applications of the basic reproductive number @xcite .    the full epidemic percolation network for a vector - borne disease would include nodes representing humans and vectors .",
    "humans infect vectors and vectors infect humans , so every edge in this epidemic percolation network links nodes of different types .",
    "such a network is called a _",
    "bipartite network_.  probability generating functions can be used to analyze undirected bipartite networks @xcite , and these methods can be adapted to directed bipartite graphs .  using the subscript @xmath267 for host and @xmath268 for vector , let @xmath269 be the pgf for the degree distribution among humans and let @xmath270 be the pgf for the degree distribution among vectors .",
    "the epidemic percolation network among humans can then be constructed by drawing an edge from person @xmath0 to person @xmath1 if there is a vector that transfers infection from @xmath0 to @xmath1 .",
    "the pgf for the degree distribution in the human - human epidemic percolation network is @xmath271 where @xmath272 is the probability that a human node in the human - vector epidemic percolation network has @xmath1 incoming edges and @xmath40 outgoing edges , @xmath273 is the pgf for the degree of a vector reached by going backwards along an edge , and @xmath274 is the pgf for the degree of a vector reached by going forward along an edge .",
    "the outbreak size distribution , the epidemic threshold , and the probability and final size of an epidemic among humans can be predicted using @xmath275 .     in the ross - macdonald model , infectiousness and susceptibility",
    "are independent among both humans and mosquitoes .",
    "therefore , @xmath276 and @xmath277 .",
    "the pgf for the out - degree of human nodes is @xmath278 and the pgf for the out - degree of mosquito nodes is@xmath279 since the indegree and outdegree are independent in the human - to - human epidemic percolation network , @xmath280 taking the derivative of @xmath281 at @xmath282 , @xmath283 and we see that the epidemic threshold occurs when @xmath284 , which is identical to the threshold derived by ross and macdonald .",
    "for the epidemic models considered in this paper , methods of finding the exact distribution of outbreak sizes for a homogeneous population of any fixed size @xmath14 exist @xcite .",
    "however , these methods involve solving a recursive system of @xmath14 equations .",
    "by performing these calculations in the limit of a large population , the methods presented in this paper allow a much simpler derivation of the distribution of self - limited outbreak sizes , the epidemic threshold , and the probability and final size of an epidemic .",
    "our methods also generalize much more easily to heterogeneous populations .",
    "as proven in the appendix , the problem of analyzing the final outcomes of any time - homogeneous stochastic sir model can be reduced to the problem of analyzing the components of an epidemic percolation network .  in @xcite",
    ", we showed how epidemic percolation networks can be used to analyze network - based models of the type studied by newman @xcite .  in this paper",
    ", we showed that epidemic percolation networks can be used to analyze stochastic sir models with random and proportionate mixing .  in the limit of a large population ,",
    "the epidemic percolation network for these models is purely directed .  using the probability generating function for its degree distribution",
    ", we accurately predicted the mean size of outbreaks and the probability and final size of epidemics for a variety of models in homogeneous and heterogeneous populations .     the ability of epidemic percolation networks to analyze both network - based and fully - mixed epidemic models makes them a simple but powerful generalization of earlier methods of analyzing stochastic sir models .",
    "we showed that epidemic percolation networks with independent indegree and outdegree are equivalent to forward and backward branching processes , and we used epidemic percolation networks to re - derive classical results from sexually transmitted diseases , vector - borne diseases , and controlled diseases .",
    "epidemic percolation networks may also provide a novel and useful qualitative insight into the control of epidemics .",
    "the emergence of epidemics corresponds to the emergence of the gscc in the epidemic percolation network , so nodes with a high probability of being in the gscc may be important targets for interventions designed to reduce the probability and final size of an epidemic .     *",
    "acknowledgements : * _ this work was supported by the us national institutes of health cooperative agreement 5u01gm076497 `` models of infectious disease agent study '' ( e.k . ) and ruth l. kirchstein national research service award 5t32ai007535 `` epidemiology of infectious diseases and biodefense '' ( e.k . ) , as well as a research grant from the institute for quantitative social sciences at harvard university ( e.k . ) .",
    "we are grateful for the comments of marc lipsitch , james maguire , jacco wallinga , joel c. miller , and the anonymous referees of jtb .",
    "would also like to thank charles larson and stephen p. luby of the health systems and infectious diseases division of icddr , b ( dhaka , bangladesh ) .",
    "_    99 m. e. j. newman ( 2002 ) .",
    "spread of epidemic disease on networks .",
    "_ physical review e _ 66 , 016128 .",
    "m. e. j. newman , s. h. strogatz , and d. j. watts ( 2001 ) .",
    "random graphs with arbitrary degree distributions and their applications , _ physical review e _ 64 : 026118 .",
    "m. bogu and m. a. serrano ( 2005 ) .",
    "generalized percolation in random directed networks . _ physical review e _ 72 : 016106 .",
    "l. a. meyers , m. e. j. newman , and b. pourbohloul ( 2006 ) . predicting epidemics on directed contact networks .",
    "_ journal of theoretical biology _",
    "240(3 ) : 400 - 418 .",
    "e. kenah and j. m. robins ( 2007 ) .",
    "second look at the spread of epidemics on networks .  to be published in",
    "_ physical review e _",
    "76(3 ) ; also available at arxiv.org : q-bio.qm/0610057 .",
    "k. kuulasmaa ( 1982 ) . the spatial general epidemic and locally dependent random graphs .",
    "_ journal of applied probability _",
    "19(4 ) : 745 - 758 ( 1982 ) .",
    "o. diekmann and j. a. p. heesterbeek ( 2000 ) .",
    "_ mathematical epidemiology of infectious diseases : model building , analysis and interpretation_.  chichester , uk : john wiley & sons .    a. broder , r. kumar , f. maghoul , p. raghavan , s. rajagopalan , r. stata , a. tomkins , and j. weiner ( 2000 ) .",
    "graph structure in the web . _ computer networks _ 33 : 309 - 320 .",
    "dorogovtsev , j.f.f .",
    "mendes , and a.n .",
    "sakhunin ( 2001 ) .",
    "giant strongly connected component of directed networks .",
    "_ physical review e _ 64 : 025101(r ) .",
    "r. albert and a .-",
    "barabsi ( 2002 ) .",
    "statistical mechanics of complex networks .",
    "_ reviews of modern physics _ 74 : 47 - 97 .",
    "m. e. j. newman ( 2003a ) .",
    "the structure and function of complex networks .",
    "_ siam reviews _",
    "45(2 ) : 167 - 256 .",
    "m. e. j. newman ( 2003b ) .",
    "random graphs as models of networks , in  _ handbook of graphs and networks , _ pp .",
    "s. bornholdt and h. g. schuster , eds .",
    "berlin : wiley - vch .",
    "newman , a .-",
    "barabsi , and d.j .",
    "watts ( 2006 ) . _ the structure and dynamics of networks _ ( princeton studies in complexity ) .",
    "princeton : princeton university press .",
    "n. schwartz , r. cohen , d. ben - avraham , a .-",
    "barabsi , and s. havlin ( 2002 ) .",
    "percolation in directed scale - free networks .",
    "_ physical review e _ 66 : 015104(r ) .    h. andersson and t. britton ( 2000 ) .  _ stochastic epidemic models and their statistical analysis _",
    "( lecture notes in statistics v.151 ) .",
    "new york : springer - verlag .",
    "l. m. sander , c. p. warren , i. m. sokolov , c. simon , and j. koopman ( 2002 ) .",
    "percolation on heterogeneous networks as a model for epidemics .",
    "_ mathematical biosciences _ 180 : 293 - 305 .",
    "d. j. daley & j. gani ( 1999 ) .  _ epidemic modelling : an introduction _ ( cambridge studies in mathematical biology ) .",
    "cambridge , uk : cambridge university press .",
    "r. m. anderson and r. m. may ( 1991 ) .",
    "_ infectious diseases of humans : dynamics and control_. new york : oxford university press",
    "watts and s. strogatz ( 1998 ) .",
    "collective dynamics of small - world networks .",
    "_ nature _ 393 : 440 - 442 .",
    "f. ball and p. neal ( 2002 ) . a general model for stochastic sir epidemic models with two levels of mixing .",
    "_ mathematical biosciences _ 180 : 73 - 102 .    m. keeling ( 2005 ) .",
    "the implications of network structure for epidemic dynamics . _ theoretical population biology _ 67 : 1 - 8 .    m.a .",
    "serrano and m. bogu ( 2006 ) .",
    "percolation and epidemic thresholds in clustered networks .",
    "_ physical review letters _ 97 : 088701 .",
    "a. gut ( 1995 ) .",
    "_ an intermediate course in probability .",
    "_ new york : springer - verlag .",
    "g. de serres , n. j. gay , and c. p. farrington ( 2000 ) .",
    "epidemiology of transmissible diseases after elimination .",
    "_ american journal of epidemiology _",
    "151(11 ) : 1039 - 1048 .",
    "f. a. haight , m. a. breuer ( 1960 ) .",
    "the borel - tanner distribution .",
    "_ biometrika _",
    "47(1,2 ) : 143 - 146 .",
    "j. wallinga and p. teunis ( 2004 ) .",
    "different epidemic curves for severe acute respiratory syndrome reveal similar impacts of control measures .  _ american journal of epidemiology _",
    "160(6 ) : 509 - 516 .",
    "it is possible to define epidemic percolation networks for a much wider range of stochastic epidemic models than that from the introduction .",
    "first , we specify an sir epidemic model using probability distributions for infectious periods in individuals and times from infection to infectious contact in ordered pairs of individuals .",
    "second , we outline time - homogeneity assumptions under which the epidemic percolation network is defined .  finally , we define infection networks and use them to show that the final outcome of the epidemic model depends only on the set of initial infections and the epidemic percolation network .",
    "this discussion is adapted from that of our previous paper @xcite .",
    "suppose there is a closed population in which every susceptible person is assigned an index @xmath285 .",
    "a susceptible person is infected upon infectious contact , and infection leads to recovery with immunity or death .",
    "each person @xmath0 is infected at his or her _ infection time _",
    "@xmath286 , with @xmath287 if @xmath0 is never infected .",
    "person @xmath0 is removed ( i.e. recovers from infectiousness or dies ) at time @xmath288 , where the _ recovery period _ @xmath4 is a random variable with the cumulative distribution function ( cdf ) @xmath289 .",
    "the recovery period @xmath4 may be the sum of a _ latent period _ , when @xmath0 is infected but not yet infectious , and an _ infectious period _ , when @xmath0 can transmit infection .",
    "we assume that all infected persons have a finite recovery period .",
    "let @xmath290 be the set of susceptible individuals at time @xmath291 .",
    "let @xmath292 be the order statistics of @xmath293 , and let @xmath294 be the index of the @xmath295 person infected .",
    "when person @xmath0 is infected , he or she makes infectious contact with person @xmath26 after an _ infectious contact interval _ @xmath296 .",
    "given @xmath4 , each @xmath296 has a conditional cdf @xmath297 .",
    "let @xmath298 if person @xmath0 never makes infectious contact with person @xmath1 , so @xmath297 may have a probability mass concentrated at infinity .",
    "person @xmath0 can not transmit disease before being infected or after recovering from infectiousness , so @xmath299 for all @xmath300 and @xmath297 is equal to the conditional probability of transmission from @xmath0 to @xmath1 given @xmath4 for all @xmath301 .",
    "the _ infectious contact time _",
    "@xmath302 is the time at which person @xmath0 makes infectious contact with person @xmath1 .  if person @xmath1 is susceptible at time @xmath303 , then @xmath0 infects @xmath1 and @xmath304 .",
    "if @xmath305 , then we must have @xmath306 because person @xmath1 avoids infection at @xmath303 only if he or she has already been infected .     for each person @xmath0 , let his or her _ importation time _",
    "@xmath307 be the first time at which he or she experiences infectious contact from outside the population , with @xmath308 if this never occurs .",
    "let @xmath309 be the cdf of the importation time vector @xmath310 .",
    "before an epidemic begins , an importation time vector @xmath311 is chosen .",
    "the epidemic begins with the introduction of infection at time @xmath312 .",
    "person @xmath313 is assigned an recovery period @xmath314 .",
    "every person @xmath315 is assigned an infectious contact time @xmath316 .",
    "we assume that there are no tied infectious contact times less than infinity .",
    "the second infection occurs at @xmath317 , which is the time of the first infectious contact after person @xmath313 is infected .",
    "person @xmath318 is assigned an recovery period @xmath319 .  after the second infection , each of the remaining susceptibles is assigned an infectious contact time @xmath320 .",
    "the third infection occurs at @xmath321 , and so on .",
    "after @xmath40 infections , the next infection occurs at @xmath322 .",
    "the epidemic stops after @xmath12 infections if and only if @xmath323 .       in principle , the above epidemic algorithm could allow the distributions of the recovery period and outgoing infectious contact intervals for individual @xmath0 to depend on all information about the epidemic available up to time @xmath286 .  in order to generate an epidemic percolation network",
    ", we must ensure that the joint distribution of recovery periods and conditional transmission probabilities for all ordered pairs of individuals are defined _ a priori_.  in order to do this , we place the following restrictions on the model :     1 .",
    "we assume that the distribution of the recovery period vector @xmath324 does not depend on the importation time vector @xmath311 , the contact interval matrix @xmath325 $ ] , or the history of the epidemic .",
    "we assume that the distribution of the infectious contact interval matrix @xmath326 does not depend on @xmath311 or on the history of the epidemic .    with these time - homogeneity assumptions ,",
    "the cumulative distribution functions @xmath327 of recovery periods and @xmath328 of infectious contact intervals are defined _ a priori_.  given@xmath329 and @xmath326 , the epidemic percolation network is a semi - directed network in which there is a directed edge from @xmath0 to @xmath1 iff @xmath330 and @xmath331 , a directed edge from @xmath1 to @xmath0 iff @xmath298 and @xmath332 , and an undirected edge between @xmath0 and @xmath1 iff @xmath330 and @xmath332 .",
    "the entire time course of the epidemic is determined by @xmath333 , @xmath326 , and @xmath311 .",
    "however , its final size depends only on the set @xmath334 of imported infections and the epidemic percolation network .  in order to prove this",
    ", we first define the _ infection network , _ which records the chain of infection from a single realization of the epidemic model .",
    "let @xmath335 be the index of the person who infected person @xmath0 , with @xmath336 for imported infections and @xmath337 for uninfected nodes .",
    "if tied finite infectious contact times have probability zero , then @xmath335 is the unique @xmath1 such that @xmath338 .  if tied finite infectious contact times are possible , then choose @xmath335 from all @xmath1 such that @xmath338 .",
    "the _ infection network _ is a network with an edge set @xmath339 .",
    "it is a subgraph of the epidemic percolation network because @xmath340 for every edge @xmath341 .",
    "since each node has at most one incoming edge , all components of the infection network are trees .",
    "every imported case is either the root node of a tree or an isolated node .",
    "the infection network can be represented by a vector @xmath342 , which is identical to the `` infection network '' defined by wallinga and teunis @xcite .  if @xmath343 , then its infection time is specified by @xmath311 .",
    "if @xmath1 was infected through transmission within the population , then it is connected to an imported infection @xmath344 in the infection network and its infection time is @xmath345 where the edges @xmath346 form a directed path from @xmath347 to @xmath1 .",
    "this path is unique because all nontrivial components of the infection network are trees .",
    "the infection times of all other nodes are infinite .",
    "the removal time of each node @xmath0 is @xmath288 .",
    "therefore , the entire time course of the epidemic is determined by the importation time vector @xmath311 , the recovery period vector @xmath333 , the infectious contact interval matrix @xmath326 .       in an epidemic with recovery period vector @xmath333 and infectious contact interval matrix @xmath326 ,",
    "a node is infected if and only if it is in the out - component of a node @xmath0 with @xmath348 in the epidemic percolation network .",
    "equivalently , a node is infected if and only if its in - component includes a node @xmath0 with @xmath348 .",
    "suppose that person @xmath1 is in the out - component of a node @xmath0 with @xmath348 in the epidemic percolation network .",
    "then there is a series of edges @xmath349 such that the initial node of @xmath350 is @xmath0 , the terminal node of @xmath351 is @xmath1 , and @xmath352 for all @xmath353 .",
    "person @xmath1 receives an infectious contact at or before@xmath354 so @xmath355 and @xmath1 must be infected during the epidemic .  to prove the converse , suppose that @xmath356 .",
    "then there exists an imported case @xmath0 and a directed path with edges @xmath357 from @xmath0 to @xmath1 such that @xmath358 since @xmath356 , it follows that all @xmath352 .",
    "but then each @xmath359 must be an edge with the proper direction in the epidemic percolation network , so @xmath1 is in the out - component of @xmath0 .     by the law of iterated expectation ( conditioning on @xmath360",
    ", this result implies that the probability distribution of outbreak sizes caused by the introduction of infection to node @xmath0 is identical to that of his or her out - component sizes in the probability space of epidemic percolation networks .",
    "furthermore , the probability that person @xmath0 gets infected in an epidemic is equal to the probability that his or her in - component contains at least one imported infection .  in the limit of a large population ,",
    "the probability that node @xmath0 is infected in an epidemic is equal to the probability that he or she is in the gout and the probability that an epidemic results from the infection of node @xmath0 is equal to the probability that he or she is in the gin .",
    "[ ptb ]      [ c]|l|l|l|l|l|**distribution * * & * density function * & * support * & * variance * & * * p(**@xmath361 * ) * + uniform@xmath362 & @xmath363 & @xmath364 & @xmath365 & @xmath366 + @xmath367gamma@xmath368 & @xmath369 & @xmath370 & @xmath371 & @xmath372 + @xmath373exponential@xmath200 & @xmath374 & @xmath375 & @xmath376 & @xmath366 + uniform@xmath199 & @xmath377 & @xmath378 & @xmath379 & @xmath376 + gamma@xmath380 & @xmath381 & @xmath382 & @xmath377 & @xmath383 + exponential@xmath198 & @xmath384 & @xmath382 & @xmath363 & @xmath385 + lognormal@xmath386 & @xmath387 & @xmath388 & @xmath389 & @xmath390 + chisquare@xmath198 & @xmath391 & @xmath382 & @xmath164 & @xmath392 + weibull@xmath393 & @xmath394 & @xmath382 & @xmath168 & @xmath395 + pareto@xmath396,@xmath397 & @xmath398 & @xmath375 & @xmath399 & @xmath366 + uniform@xmath201 * & @xmath376 & @xmath400 & & + exponential@xmath202 * & @xmath401 & @xmath382 & & +"
  ],
  "abstract_text": [
    "<S> in this paper , we outline the theory of epidemic percolation networks and their use in the analysis of stochastic sir epidemic models on undirected contact networks .  </S>",
    "<S> we then show how the same theory can be used to analyze stochastic sir models with random and proportionate mixing .  </S>",
    "<S> the epidemic percolation networks for these models are purely directed because undirected edges disappear in the limit of a large population .  in a series of simulations , </S>",
    "<S> we show that epidemic percolation networks accurately predict the mean outbreak size and probability and final size of an epidemic for a variety of epidemic models in homogeneous and heterogeneous populations .  </S>",
    "<S> finally , we show that epidemic percolation networks can be used to re - derive classical results from several different areas of infectious disease epidemiology .  in an appendix , we show that an epidemic percolation network can be defined for any time - homogeneous stochastic sir model in a closed population and prove that the distribution of outbreak sizes given the infection of any given node in the sir  model is identical to the distribution of its out - component sizes in the corresponding probability space of epidemic percolation networks .  </S>",
    "<S> we conclude that the theory of percolation on semi - directed networks provides a very general framework for the analysis of stochastic sir models in closed populations . </S>"
  ]
}