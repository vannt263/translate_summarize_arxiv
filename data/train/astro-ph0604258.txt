{
  "article_text": [
    "in the study of cosmic large scale structures formation , one generally focuses on the inhomogeneity of the density and velocity fields of dark matter and baryon gas , but assumes that the distribution of background radiation is uniform .",
    "this would be a reasonable approximation when the universe is transparent .",
    "therefore , the effect of radiative transfer is generally ignored in the study of large scale structures on low redshift",
    ". however , the fluctuations in the radiation field is essential in understanding the early universe , especially in the epoches around reionization .",
    "radiative transfer problems are no longer to be overlooked .",
    "many numerical solvers for the radiative transfer equation have been proposed ( abel et al . 1999 , ciardi et al .",
    "2001 , gnedin & abel 2001 , sokasian et al .",
    "2001 , razoumov et al .",
    "2002 , cen 2002 , maselli et al .",
    "2003 ) .    in this paper",
    ", we will introduce the algorithm of the radiative transfer equations based on the finite difference weighted essentially non - oscillatory ( weno ) scheme ( jiang & shu 1996 ) modified with anti - diffusive flux corrections ( xu & shu 2005 ) .",
    "it has been shown that the boltzmann equations can be solved by this weno method with reasonable computational speed at least for one or two spatial dimensions and two or three phase space dimensions plus time ( carrillo et al .",
    "2003 , 2006 ) .",
    "the weno code is effective to capture discontinuities as well as to resolve complicated flow features .",
    "moreover , it is also significantly superior over piecewise smooth solutions containing discontinuities .",
    "it has advantages over the monte - carlo codes in eliminating fluctuations , in obtaining accurate probability density functions , and in accurately resolving time transients of the system .",
    "considering the equation of radiative transfer basically is the same as the boltzmann equation , the weno algorithm for the radiative transfer is straightforward .",
    "moreover , a hybrid algorithm of hydrodynamic / n - body simulation based on weno scheme has been successfully developed ( feng et al . 2004 ) .",
    "this result also motivated us to extend the weno scheme to radiative transfer problems .",
    "it would be a necessary preparation to develop solver of hydrodynamic / radiative transfer problems .",
    "we will demonstrate the weno algorithm by applying the weno code to the strmgren sphere .",
    "the structure and evolution of an individual strmgren sphere are important for the understanding of the reionization process .",
    "the ionization of baryon gas surrounding high redshift objects , such as quasars , stars of first generation , generally is modelled by the strmgren sphere ( madau & rees , 2000 ; cen & haiman 2000 ; white et al .",
    "2003 ; stuart et al . 2004 ; yu & lu 2005 ) .",
    "the strmgren sphere usually is described as a fully ionized region , sharply divided from the neutral hydrogen region on the outside of the sphere .",
    "therefore , we should require the algorithm to be able to 1 . )",
    "capture the sharp boundary between the ionized and neutral regions , and their time - dependence ; 2 . )",
    "accurately calculate the small amount of neutral hydrogen in the sphere and ionized hydrogen outside the sphere .",
    "these two points can be realized by the the weno numerical scheme , as it is effective for problems containing both strong discontinuities and smooth flow structures .",
    "the paper is organized as follows .",
    "section 2 describes the weno numerical scheme .",
    "section 3 gives the numerical solutions of the strmgren sphere .",
    "the discussion and conclusion are presented in  4 .",
    "the derivation of the equation of the radiative transfer is given in the appendix .",
    "the radiative transfer equation in an expanding universe is ( see the appendix ) @xmath0 where @xmath1 is the specific intensity , @xmath2 the cosmic factor , @xmath3 , @xmath4 the frequency of photon , @xmath5 , and @xmath6 a unit vector in the direction of photon propagation . @xmath7 and @xmath8 are , respectively , the absorption and sources of photons .    to demonstrate the weno method , we consider the simplest case .",
    "we ignore the expansion of the universe .",
    "this approximation is correct if the time scale of evolution of photon distribution is much less than the time scale of cosmic expansion .",
    "moreover , the physical and phase spaces are assumed to be 1-dimensional with coordinate @xmath9 . in this case , the radiative transfer equation is @xmath10 the computational domain is discretized into a tensor product mesh .",
    "the mesh is taken to be uniform in the @xmath9-direction , and to be smooth non - uniform in the @xmath4-direction , i.e. @xmath11 where @xmath12 is the mesh size in the @xmath9-direction , and @xmath13 , @xmath14 is the transformed mesh size in the @xmath4 direction . @xmath15 and @xmath16 are , respectively , the sizes of the numerical domain , which are adjusted in the numerical experiment such that @xmath17 , for @xmath18 and all @xmath19 and @xmath4 , and @xmath17 , for @xmath20 and all @xmath19 and @xmath9 .",
    "the approximations to the point values of the solution @xmath21 , denoted by @xmath22 , are obtained with an approximation to the spacial derivatives using the 5th order finite difference weno method ( jiang & shu 1996 ) with anti - diffusive flux corrections ( xu & shu 2005 ) .",
    "* approximation to the derivatives : + to calculate @xmath23 , the variable @xmath4 is fixed and the approximation is performed along the @xmath9-line @xmath24 where the numerical flux @xmath25 is obtained with the procedure given below .",
    "we can use the upwind fluxes without flux splitting in the fifth order weno approximation because the wind direction is fixed ( positive ) . to obtain the sharp resolution of the contact discontinuities , the anti - diffusive",
    "flux corrections are used in our code .",
    "+ first , we denote @xmath26 where @xmath27 and @xmath28 are fixed .",
    "the numerical flux from the regular weno procedure is obtained by @xmath29 where @xmath30 are the three third order fluxes on three different stencils given by @xmath31 and the nonlinear weights @xmath32 are given by @xmath33 with the linear weights @xmath34 given by @xmath35 and the smoothness indicators @xmath36 given by @xmath37 @xmath38 is a parameter to avoid the denominator to become 0 and is taken as @xmath39 times the maximum magnitude of the initial condition @xmath40 in the computation of this paper .",
    "the reconstruction of the finite difference weno flux on the downwind side @xmath41 is obtained in a mirror symmetric fashion with respect to @xmath42 as that for @xmath43 .",
    "+ the anti - diffusive flux corrections are based on the fluxes obtained from the regular weno procedure . it is given by @xmath44 where @xmath45 is the cfl number and the minmod function is defined as @xmath46 @xmath47 of eq.([eq4 ] ) is the discontinuity indicator between 0 and 1 , defined as @xmath48 where @xmath49 with @xmath50 being a small positive number taken as @xmath51 in our computation . @xmath52 and @xmath53 are the maximum and minimum values of @xmath54 for all grid points . with the definition",
    "above , we will have @xmath55 .",
    "@xmath56 in the smooth regions and @xmath57 is close to 1 near strong discontinuities .",
    "the purpose of the anti - diffusive flux corrections is to improve the resolution of contact discontinuities without sacrificing accuracy and stability of the original weno scheme . *",
    "approximation to the evolution with time + the time - derivative @xmath58 in each step @xmath59 is calculated by the third order tvd runge - kutta method as @xmath60 where @xmath61 is the approximation to the spatial derivatives and the source terms : @xmath62 + the runge - kutta method needs to be modified considering the modification on the anti - diffusive flux @xmath63 by @xmath64 where the operator @xmath61 is defined by the anti - diffusive flux @xmath65 given by eq.([eq4 ] ) , and the operator @xmath66 is defined by the modified anti - diffusive flux @xmath67 as @xmath68 and @xmath69 is defined by the modified anti - diffusive flux @xmath70 , @xmath71 here @xmath72 , @xmath73 .",
    "we have given the details of the weno algorithm with anti - diffusive flux corrections only for the one dimensional case to save space .",
    "the finite difference weno scheme is ideally suited for multi - dimensional calculations , as derivatives in each direction can be approximated in an one dimensional setting by fixing the other variables , while still maintaining high order accuracy and stability .",
    "we refer to ( carrillo et al .",
    "2003 , 2006 ) for more details of weno approximations to boltzmann equations .",
    "our radiative transfer equations [ eq.([eq1 ] ) ] are of the same form as the boltzmann equations in ( carrillo et al .",
    "2003 , 2006 ) and hence the algorithms developed there can be applied here without difficulty .",
    "as a test , we consider a point photon source located at the center @xmath74 of a uniformly distributed medium . assuming the source is monochromatic with frequency @xmath75 , and all photons are emitted along the radial direction",
    ", we have @xmath76 and @xmath77 where @xmath78 is the total energy of photons emitted from the sources per unit time .",
    "when @xmath79 , @xmath80 .     given by the numerical solution at @xmath81 ( square ) and the exact solution ( solid line ) .",
    "j(t=0 , r)=@xmath82 . the time is taken to be @xmath83 ( top left ) ; @xmath84 ( top right ) ; @xmath85 ( bottom left ) and @xmath86 ( bottom right ) .",
    "the small windows in the bottom figures are the zoom - in version of the corresponding regions in the circles .",
    ", title=\"fig:\",width=192,height=192 ]   given by the numerical solution at @xmath81 ( square ) and the exact solution ( solid line ) .",
    "j(t=0 , r)=@xmath82 . the time is taken to be @xmath83 ( top left ) ; @xmath84 ( top right ) ; @xmath85 ( bottom left ) and @xmath86 ( bottom right ) .",
    "the small windows in the bottom figures are the zoom - in version of the corresponding regions in the circles .",
    ", title=\"fig:\",width=192,height=192 ]     given by the numerical solution at @xmath81 ( square ) and the exact solution ( solid line ) .",
    "j(t=0 , r)=@xmath82 .",
    "the time is taken to be @xmath83 ( top left ) ; @xmath84 ( top right ) ; @xmath85 ( bottom left ) and @xmath86 ( bottom right ) .",
    "the small windows in the bottom figures are the zoom - in version of the corresponding regions in the circles .",
    ", title=\"fig:\",width=192,height=192 ]   given by the numerical solution at @xmath81 ( square ) and the exact solution ( solid line ) .",
    "j(t=0 , r)=@xmath82 .",
    "the time is taken to be @xmath83 ( top left ) ; @xmath84 ( top right ) ; @xmath85 ( bottom left ) and @xmath86 ( bottom right ) .",
    "the small windows in the bottom figures are the zoom - in version of the corresponding regions in the circles . , title=\"fig:\",width=192,height=192 ]    in this case , eq.([eq1 ] )",
    "could be written in the spherical coordinates as @xmath87 where the absorption coefficient @xmath88 is given by @xmath89 , @xmath27 being the number density of particle of the medium , and @xmath90 the absorption cross - section . in this problem , both @xmath27 and @xmath90 are assumed to be constants .",
    "we define @xmath91 .",
    "then eq.([eq10 ] ) becomes @xmath92 for simplicity , we drop the prime , and use @xmath93 for @xmath94 below .",
    "it will not cause confusion between the @xmath40 in eqs.([eq11 ] ) and ( [ eq10 ] ) , as the former is a function of @xmath19 , @xmath9 , while the later is a function of @xmath19 , @xmath9 , @xmath4 and @xmath6 .",
    "the source term gives a boundary condition at @xmath95 as @xmath96 assuming the source starts to emit photon at @xmath97 , the initial condition is then @xmath98    subject to the conditions ( [ eq12 ] ) and ( [ eq13 ] ) , the exact solution of eq.([eq11 ] ) is @xmath99 where @xmath100 is a step function : @xmath101 , if @xmath102 ; and @xmath103 , if @xmath104 .",
    "the step function is from the radiative front , which propagates with the speed of light @xmath105 .",
    "eq.([eq11 ] ) has the same shape as eq.([eq2 ] ) .",
    "similarly , we can apply the weno scheme to solve eq.([eq11 ] ) .",
    "the boundary condition eq.([eq12 ] ) makes us to take the inflow condition at @xmath95 as @xmath106 the boundary condition at @xmath107 is : @xmath108    figure [ fig1 ] plots both the numerical solution and exact solution at time @xmath109 , 2.0 , 3.0 , 4.0 . clearly , the numerical result displays an excellent agreement with the exact solution even when the number @xmath110 is only 200 .",
    "the discontinuity at the radiative front @xmath105 is also well reproduced in the weno scheme .",
    "we now consider a realistic problem : the ionization of a uniformly distributed hydrogen gas with number density @xmath27 by a point uv photon source located at @xmath95 .",
    "this problem is the well known strmgren sphere if the profile of the ionized sphere is approximated by two sharply divided regions as @xmath111 where @xmath112 , @xmath113 is the number density of neutral hydrogen , hi .",
    "eq.([eq15 ] ) means that within the sphere of radius @xmath114 around the source , hydrogen is fully ionized , while outside the sphere hydrogen atoms remain neutral .",
    "@xmath114 is called the ionized radius of the strmgren sphere , which can be determined by the balance between the rate of recombinations and the emission @xmath115 of ionizing photons ( strmgren 1939 , spitzer 1978 , osterbrook 1989 ) @xmath116 where @xmath117 is the hydrogen recombination coefficient .",
    "the sharp profile eq.([eq15 ] ) , and then eq.([eq16 ] ) , are reasonable if the mean free path of photon @xmath118 is much less than @xmath114 . for strong sources , like quasars @xmath119 s@xmath120 , @xmath114 is much larger than @xmath121 .",
    "however , for weak sources , like population iii stars @xmath122 , @xmath121 is comparable , or even larger than @xmath114 . in this case , the profile eq.([eq15 ] ) is no longer valid . even for strong sources ,",
    "we need to study the small deviation of the profile of ionized sphere from eq.([eq15 ] ) . the profile should be found by solving the radiative transfer equation with proper boundary and initial conditions .",
    "moreover , the profile eq.([eq15 ] ) describes the final state of the ionized sphere around a strong source . to study the reionization history of the universe",
    ", we may need the information of the formation of the ionized sphere i.e. the time - dependence of @xmath123 .",
    "this also requires to solve the radiative transfer equation .    to calculate the profile of the ionized sphere",
    ", we can still use eq.([eq11 ] ) , boundary condition eq.([eq12 ] ) , and initial condition eq.([eq13 ] ) .",
    "the absorption coefficient now is given by @xmath124 where @xmath125 is the absorption cross section at the ionization frequency @xmath75 .",
    "we have @xmath126 @xmath127 .",
    "the number density of neutral hydrogen @xmath113 is determined by the ionization equilibrium equation @xmath128 where @xmath129 , @xmath130 .",
    "we will assume electron density @xmath131 .",
    "this means that the electrons from ionized helium are ignored .",
    "the photoionization is given by @xmath132 the parameters @xmath117 and @xmath133 are the recombination coefficient and collision ionization , respectively , which can be found in e.g. theuns et al ( 1998 ) .",
    "let us rescale the variables by @xmath134 , @xmath135 .",
    "it means that @xmath136 and @xmath137 are , respectively , the time and distance in the units of mean free flight time and mean free path , @xmath138 , of photon @xmath139 in neutral hydrogen gas with density @xmath27 .",
    "in the @xmath140cdm model , @xmath141 @xmath142 , where @xmath143 is the redshift of reionization , the unit of @xmath136 is 0.89 @xmath144 years , and the unit of @xmath137 is 0.27@xmath145 mpc .",
    "we also rescale the intensity by @xmath146 .",
    "eqs.([eq11 ] ) can then be rewritten as @xmath147 the boundary condition ( [ eq12 ] ) and initial condition ( [ eq13 ] ) are , respectively @xmath148 @xmath149 with this rescaling , the photoionization term of eq.([eq19 ] ) is @xmath150 .",
    "the intensity of source is @xmath151 s@xmath120 .      for strong sources ,",
    "@xmath114 is much larger than the mean free path .",
    "we can replace the rate equation ( 18 ) by ionization equilibrium equation @xmath152 , or @xmath153 , where the small term @xmath154 is also dropped .",
    "a typical numerical result of the @xmath155 profile is shown in figure [ fig2 ] , in which @xmath156 , or @xmath157 .",
    "the calculation is performed with @xmath158 .",
    "vs. @xmath9 at time @xmath159 ( top left ) , 60.0 ( top right ) , 90.0 ( bottom left ) , 140.0 ( bottom right ) for a strong source @xmath156 , or @xmath157 s@xmath120 .",
    "the parameter @xmath110 of the numerical calculation is taken to be 1000 .",
    "the ionized radius @xmath114=122.04.,title=\"fig:\",width=192,height=144 ]   vs. @xmath9 at time @xmath159 ( top left ) , 60.0 ( top right ) , 90.0 ( bottom left ) , 140.0 ( bottom right ) for a strong source @xmath156 , or @xmath157 s@xmath120 .",
    "the parameter @xmath110 of the numerical calculation is taken to be 1000 .",
    "the ionized radius @xmath114=122.04.,title=\"fig:\",width=192,height=144 ]     vs. @xmath9 at time @xmath159 ( top left ) , 60.0 ( top right ) , 90.0 ( bottom left ) , 140.0 ( bottom right ) for a strong source @xmath156 , or @xmath157 s@xmath120 .",
    "the parameter @xmath110 of the numerical calculation is taken to be 1000 .",
    "the ionized radius @xmath114=122.04.,title=\"fig:\",width=192,height=144 ]   vs. @xmath9 at time @xmath159 ( top left ) , 60.0 ( top right ) , 90.0 ( bottom left ) , 140.0 ( bottom right ) for a strong source @xmath156 , or @xmath157 s@xmath120 .",
    "the parameter @xmath110 of the numerical calculation is taken to be 1000 .",
    "the ionized radius @xmath114=122.04.,title=\"fig:\",width=192,height=144 ]    figure [ fig2 ] shows that the code can well reveal the jump at radiative front @xmath105 , which propagates with the speed of light .",
    "the evolution of the ionized range can approximately be described as @xmath160 when @xmath19 is small , the increase of ionized sphere is following the radiative front @xmath105 .",
    "the increase will be halted , when the ionization equilibrium is totally established , and the ionized sphere becomes time - independent . for the case of @xmath161 ,",
    "the final state arrives at @xmath162 .",
    "since the bottom right panel of figure [ fig2 ] is for @xmath163 , it should be the final state of the ionized sphere .",
    "the profile of the final state can be approximately described by the strmgren sphere profile eq.([eq15 ] ) , and ionized radius @xmath114 is about 122 mean free path .     vs. @xmath9 at time @xmath164 ( top left ) , 800.0 ( top right ) , 1000.0 ( bottom left ) , 1100.0 ( bottom right ) for a strong source @xmath165 or @xmath166 s@xmath120 .",
    "the parameter @xmath110 of the numerical calculation is taken to be 200 .",
    "the ionized radius @xmath114=1080.0 .",
    ", title=\"fig:\",width=192,height=144 ]   vs. @xmath9 at time @xmath164 ( top left ) , 800.0 ( top right ) , 1000.0 ( bottom left ) , 1100.0 ( bottom right ) for a strong source @xmath165 or @xmath166 s@xmath120 .",
    "the parameter @xmath110 of the numerical calculation is taken to be 200 .",
    "the ionized radius @xmath114=1080.0 . , title=\"fig:\",width=192,height=144 ]     vs. @xmath9 at time @xmath164 ( top left ) , 800.0 ( top right ) , 1000.0 ( bottom left ) , 1100.0 ( bottom right ) for a strong source @xmath165 or @xmath166 s@xmath120 .",
    "the parameter @xmath110 of the numerical calculation is taken to be 200 .",
    "the ionized radius @xmath114=1080.0 .",
    ", title=\"fig:\",width=192,height=144 ]   vs. @xmath9 at time @xmath164 ( top left ) , 800.0 ( top right ) , 1000.0 ( bottom left ) , 1100.0 ( bottom right ) for a strong source @xmath165 or @xmath166 s@xmath120 .",
    "the parameter @xmath110 of the numerical calculation is taken to be 200 .",
    "the ionized radius @xmath114=1080.0 .",
    ", title=\"fig:\",width=192,height=144 ]    if we define an effective ionized radius @xmath167 by @xmath168 we have @xmath169 when @xmath170 .",
    "the physical meaning of @xmath171 is clear .",
    "it gives an equivalent sphere , within which hydrogen is fully ionized .",
    "the ionized radius is essentially the same as the radiative front .",
    "therefore , for strong sources , the radiative front and ionized radius are the same in all time @xmath172 .    from figure [ fig2 ]",
    "we can also see that the neutral hydrogen fraction within the ionized sphere @xmath173 actually is not exactly equal to zero .",
    "although the profile ( [ eq15 ] ) may still be reasonable , @xmath174 can be as large as 10@xmath175 near the ionized radius .",
    "we also calculated the profile with very strong source like @xmath176 , which is shown in figure [ fig3 ] . in this case",
    "the source intensity @xmath177 is larger than that of figure [ fig2 ] by a factor of 10@xmath178 , and therefore , the radius of @xmath114 of figure [ fig3 ] is larger than that of [ fig2 ] by a factor of 10 .",
    "there is also neutral hydrogen left behind the ionization front .",
    "these small amounts of hi are stable , i.e. independent of the parameter @xmath110 .",
    "the neutral hydrogen remained in the ionized sphere is not always negligible .",
    "if the strmgren sphere radius @xmath114 of a source is comparable or less than the mean free path , it is a weak sources . in this case",
    ", we should use eq.(18 ) to describe the ionization evolution .",
    "in the range of @xmath9 less than the mean free path , i.e. @xmath179 , the photonionization @xmath180 is large .",
    "we can keep only the photoionization term @xmath181 on the r.h.s . of eq.(18 ) .",
    "vs. @xmath9 at time @xmath83 ( top left ) , 2.0 ( top right ) , 3.0 ( bottom left ) , 4.0 ( bottom right ) for a weak source @xmath182 or @xmath183 .",
    "the parameter @xmath110 of the numerical calculation is taken to be 200.,title=\"fig:\",width=192,height=144 ]   vs. @xmath9 at time @xmath83 ( top left ) , 2.0 ( top right ) , 3.0 ( bottom left ) , 4.0 ( bottom right ) for a weak source @xmath182 or @xmath183 .",
    "the parameter @xmath110 of the numerical calculation is taken to be 200.,title=\"fig:\",width=192,height=144 ]     vs. @xmath9 at time @xmath83 ( top left ) , 2.0 ( top right ) , 3.0 ( bottom left ) , 4.0 ( bottom right ) for a weak source @xmath182 or @xmath183 .",
    "the parameter @xmath110 of the numerical calculation is taken to be 200.,title=\"fig:\",width=192,height=144 ]   vs. @xmath9 at time @xmath83 ( top left ) , 2.0 ( top right ) , 3.0 ( bottom left ) , 4.0 ( bottom right ) for a weak source @xmath182 or @xmath183 .",
    "the parameter @xmath110 of the numerical calculation is taken to be 200.,title=\"fig:\",width=192,height=144 ]    a solution numerical solution of the profile @xmath184 at @xmath19=1 , 2 , 3 , and 4 are shown in figure [ fig4 ] , in which the source intensity is @xmath182 or @xmath185 s@xmath120 .",
    "the calculation is performed with @xmath81 .",
    "we can see from fig .",
    "4 that the profile is very different from strong source .",
    "the spatial range of @xmath155 significantly less than 1 ( or @xmath123 significantly larger than zero ) is much less than @xmath19 , because the total number of photons emitted from sources within time @xmath19 is less than the number of atoms within radius @xmath105 .",
    "@xmath186 is gradually increasing with @xmath9 .",
    "although the non - zero range of the ionized fraction @xmath187 increases with time , the range @xmath188 is always small .",
    "it implies that the ionized sphere probably is not transparent to ly@xmath189 photons .",
    "figure [ fig4 ] shows that the effective ionized radius @xmath190 [ eq.(24 ) ] for weak sources is @xmath191 , or @xmath192 .",
    "the growth of the ionized range is much slower than the radiative front . with the increase of source intensity",
    ", @xmath193 will gradually approach to 1 , and then , the solution will transfer to the case of strong sources .",
    "let us consider a point source emitting photons with a power law frequency spectrum .",
    "the source function @xmath8 is then @xmath194 where @xmath195 , @xmath189 is the index of the power law .",
    "therefore , different from the problems of  3.1 and 3.2 , we should consider the variable @xmath4 of the frequency space , i.e. @xmath40 is a function of @xmath19 , @xmath9 , and @xmath4 .",
    "the equation of @xmath40 is still the same as eq.([eq11 ] ) , but the absorption coefficient is @xmath4-dependent @xmath196 where the cross section @xmath197 .",
    "the boundary condition now should be @xmath198 and the initial condition is @xmath199     for @xmath182 at time @xmath83 ( top left ) , 2.0 ( top right ) , 3.0 ( bottom left ) , and 4.0 ( bottom right ) . the mesh is taken to be @xmath110=100 , @xmath200=100 , and @xmath16=@xmath201 .",
    ", title=\"fig:\",width=192 ]   for @xmath182 at time @xmath83 ( top left ) , 2.0 ( top right ) , 3.0 ( bottom left ) , and 4.0 ( bottom right ) .",
    "the mesh is taken to be @xmath110=100 , @xmath200=100 , and @xmath16=@xmath201 .",
    ", title=\"fig:\",width=192 ]     for @xmath182 at time @xmath83 ( top left ) , 2.0 ( top right ) , 3.0 ( bottom left ) , and 4.0 ( bottom right ) . the mesh is taken to be @xmath110=100 , @xmath200=100 , and @xmath16=@xmath201 .",
    ", title=\"fig:\",width=192 ]   for @xmath182 at time @xmath83 ( top left ) , 2.0 ( top right ) , 3.0 ( bottom left ) , and 4.0 ( bottom right ) .",
    "the mesh is taken to be @xmath110=100 , @xmath200=100 , and @xmath16=@xmath201 .",
    ", title=\"fig:\",width=192 ]    we still rescale the variables by @xmath202 , @xmath203 , @xmath204 and @xmath205 .",
    "( [ eq19 ] ) is updated as follow , @xmath206 if we ignore the ionizing heating , @xmath174 or @xmath207 is still determined by eq.([eq18 ] ) , but @xmath208 should be given by @xmath209 this integration could be worked out with a quadrature formula accurate of order 4 @xmath210 where @xmath211 , and the weights @xmath212 are given by @xmath213 and @xmath214 by having a non - uniform mesh in the @xmath4-direction , one can not use this quadrature formula directly . however , since a uniform mesh size is used on @xmath215 , with @xmath216 , we can perform the numerical integration with respect to @xmath215 using ( [ eq29 ] ) .     vs. @xmath217 with @xmath218 , @xmath219 ( square ) and the reference solution ( solid ) obtained with @xmath158 , @xmath200=1000 , at time @xmath86 and @xmath9=0.8 ( top left ) , @xmath9=2.0 ( top right ) , @xmath9=2.8(bottom left ) and @xmath9=3.6 ( bottom right ) .",
    ", title=\"fig:\",width=192 ]   vs. @xmath217 with @xmath218 , @xmath219 ( square ) and the reference solution ( solid ) obtained with @xmath158 , @xmath200=1000 , at time @xmath86 and @xmath9=0.8 ( top left ) , @xmath9=2.0 ( top right ) , @xmath9=2.8(bottom left ) and @xmath9=3.6 ( bottom right ) . ,",
    "title=\"fig:\",width=192 ]     vs. @xmath217 with @xmath218 , @xmath219 ( square ) and the reference solution ( solid ) obtained with @xmath158 , @xmath200=1000 , at time @xmath86 and @xmath9=0.8 ( top left ) , @xmath9=2.0 ( top right ) , @xmath9=2.8(bottom left ) and @xmath9=3.6 ( bottom right ) .",
    ", title=\"fig:\",width=192 ]   vs. @xmath217 with @xmath218 , @xmath219 ( square ) and the reference solution ( solid ) obtained with @xmath158 , @xmath200=1000 , at time @xmath86 and @xmath9=0.8 ( top left ) , @xmath9=2.0 ( top right ) , @xmath9=2.8(bottom left ) and @xmath9=3.6 ( bottom right ) .",
    ", title=\"fig:\",width=192 ]    a numerical result of @xmath220 for @xmath221 and @xmath222 is shown in figure [ fig5 ] , which is obtained by the mesh @xmath223=100 , @xmath200=100 and @xmath16=@xmath201 .",
    "it displays the evolution of the frequency - dependence of @xmath224 .",
    "we notice that for the high frequency @xmath225 , the intensity @xmath224 is almost independent of @xmath19 and @xmath9 , while the frequency spectrum at @xmath226 is significantly dependent on both @xmath19 and @xmath9 .     vs. @xmath217 of the numerical solution with @xmath218 , @xmath219 at time @xmath19=4.0 and @xmath9=0.8 ( dash dot dot line ) , @xmath9=2.0 ( dash line ) , @xmath9=2.8 ( dash dot line ) and @xmath2273.6 ( solid line ) .",
    ", width=192 ]    the evolution of the frequency spectrum can be seen more clearly in figure [ fig6 ] , which shows @xmath40 vs. @xmath4 at time @xmath86 and position @xmath228 , 2.0 , 2.8 and 3.6 .",
    "the results of figure [ fig6 ] given by @xmath218 and @xmath219 are the same as that obtained with @xmath158 and @xmath229 .",
    "therefore , the algorithm is also stable and highly accurate in the frequency space . from figure [ fig6 ]",
    ", we can see a significant @xmath9-dependence of the spectrum . at small",
    "@xmath9 , the spectrum essentially is of power law , while at @xmath230 it is similar to a spectrum of self - absorption , i.e. it is low at @xmath231 , and shows a peak at @xmath232 .     vs. @xmath9 with samples of @xmath218 , @xmath219 at time @xmath83 ( left ) and 4.0 ( right ) for wave bands @xmath233 ( solid line ) , @xmath234 ( dash line ) , @xmath235 ( dash dot line ) , @xmath236 ( dot line ) , @xmath237 ( long dash line ) and @xmath238 ( dash dot dot line ) . ,",
    "title=\"fig:\",width=192 ]   vs. @xmath9 with samples of @xmath218 , @xmath219 at time @xmath83 ( left ) and 4.0 ( right ) for wave bands @xmath233 ( solid line ) , @xmath234 ( dash line ) , @xmath235 ( dash dot line ) , @xmath236 ( dot line ) , @xmath237 ( long dash line ) and @xmath238 ( dash dot dot line ) .",
    ", title=\"fig:\",width=192 ]    generally , self - absorption leads to the lack of photons with @xmath239 , and therefore , to the hardening of the frequency spectrum of photons .",
    "one can measure the hardening by the index of power law defined by @xmath240 figure [ fig7 ] plots @xmath189 vs. @xmath4 at different positions @xmath9 and shows that @xmath189 becomes smaller at @xmath241 .",
    "figure [ fig8 ] gives @xmath189 vs. @xmath9 for several @xmath4 .",
    "it shows that @xmath189 becomes smaller at larger @xmath9 .",
    "we described a numerical solver for radiative transfer problems based on the weno scheme modified with anti - diffusive flux corrections .",
    "it has high order of accuracy and good convergence , and is also highly stable and robust for solving problems with both discontinuities and smooth solution structures . using the strmgren sphere or ionized sphere as numerical tests",
    ", we showed that this code is able to resolve the sharp ionized front under a wide parameter range , such as intensity of the source @xmath115 varying from @xmath242 s@xmath120 , which covers various sources responsible for the early reionization in the universe .",
    "since the weno scheme needs more floating point operations per cell than those of the ppm and tvd schemes , it leads to twice or more loss of computational speed .",
    "nevertheless , it has been already successfully applied to kinetic equations of distribution function in phase space with one or two spatial dimensions and two or three phase space dimensions .",
    "it can provide the solution of evolution in both the physical space as well as the frequency space .",
    "therefore , the weno scheme would be useful to study the early stage of reionization , in which ionized region is generally an isolated patch given by individual source with various configuration .",
    "we demonstrate this algorithm with the problems of spherical ionized region exposed to a point source .",
    "it is shown that the radial profile of the fraction of ionized hydrogen is sensitively dependent on the intensity of the sources .",
    "although for strong sources the strmgren sphere provides a good approximation to the ionized sphere , the profile of the sphere actually can not always be approximated as fully ionized spheres sharply separated with neutral hydrogen region . even for strong sources ,",
    "the neutral hydrogen remained in the strmgren ionized sphere may still be significant and important .",
    "there are 1-d radiative transfer codes , such as cloudy94 ( e.g. maselli et al . 2003 ) , which are capable of capturing the sharp boundary of the strmgren sphere .",
    "however , they yield large errors of the neutral hydrogen remained in the sphere .",
    "our result shows that the weno codes can effectively handle the uncertainty around discontinuities .",
    "we studied the time - dependence of the ionized radius @xmath190 .",
    "we found that for strong sources , @xmath169 when @xmath243 .",
    "this is similar to the result of madau & rees 2000 . for weak sources",
    ", we have @xmath244",
    ". however , the evolution of @xmath167 can not be fitted by @xmath245 , which will yields unphysical result @xmath246 at small @xmath19 ( e.g. cen & haiman 2000 ; yu & lu 2005 ) . moreover",
    ", the weno algorithm provides also the solution of the evolution of the photon s frequency spectrum of an ionized sphere .",
    "the weno scheme for radiative transfer problems could be incorporated with the euler hydrodynamics .",
    "for instance , it is straightforward to generalize the calculation of a strmgren sphere to take account of the hydrodynamic effects of the hydrogen gas sphere even when the gaseous sphere undergoes shocks .",
    "* acknowledgments *    this work is supported in part by the us nsf under the grants ast-0506734 and ast-0507340 .",
    "llf acknowledges support from the national science foundation of china under the grant 10573036 .",
    "considering a universe described by a robertson - walker metric , we have @xmath247 where we take @xmath248 .",
    "the summation is over 0 to 3 for repeated greek indices , 0 to 3 for latin indices , @xmath249 is the cosmic factor and @xmath250 .",
    "we consider below the flat universe , i.e. @xmath251 . the distribution function @xmath252 of photons is defined by @xmath253 where @xmath254 is the number of photons in the invariant phase space volume element of @xmath255 the variables @xmath256 is comoving coordinate , @xmath257 , and @xmath258 are 4 momentum , @xmath121 being the affine parameter .",
    "the dirac - delta function @xmath259 in eq.([eqa2 ] ) is due to the 4 momentum @xmath260 of photons to be null , i.e. @xmath261 .    the boltzmann equation of the distribution function @xmath262 is given by ( e.g. bernstein 1988 ) @xmath263 where @xmath264 is collision term , of which the variables are also @xmath265 .",
    "define @xmath266 , it is a unit vector in the direction of photon propagation , @xmath267 . with @xmath268 , we have @xmath269 , or @xmath270 , the frequency @xmath4 of photon . from eq.([eqa4 ] ) , the equation of the distribution function @xmath271 is @xmath272 where the hubble constant @xmath3 . from the definition eq.([eqa2 ] ) of @xmath273 , the specific intensity @xmath274 , which is also a function of @xmath19 , @xmath275 , @xmath4 and @xmath268 .",
    "moreover , if @xmath264 is mainly given by absorption and emission sources , eq.([eqa5 ] ) yields the equation of specific intensity as follows @xmath276 where @xmath7 is the absorption coefficient , and @xmath8 the source function .",
    "eq.([eqa6 ] ) is the equation of radiative transfer in the universe .",
    "the equation ( [ eqa6 ] ) can be rewritten as in the format of a conservation flux as @xmath277 where @xmath5 .",
    "therefore , it can be solved by the weno scheme ."
  ],
  "abstract_text": [
    "<S> we show that the algorithm based on the weighted essentially nonoscillatory ( weno ) scheme with anti - diffusive flux corrections can be used as a solver of the radiative transfer equations . </S>",
    "<S> this algorithm is highly stable and robust for solving problems with both discontinuities and smooth solution structures . </S>",
    "<S> we test this code with the ionized sphere around point sources . </S>",
    "<S> it shows that the weno scheme can reveal the discontinuity of the radiative or ionizing fronts as well as the evolution of photon frequency spectrum with high accuracy on coarse meshes and for a very wide parameter space . </S>",
    "<S> this method would be useful to study the details of the ionized patch given by individual source in the epoch of reionization . </S>",
    "<S> we demonstrate this method by calculating the evolution of the ionized sphere around point sources in physical and frequency spaces . </S>",
    "<S> it shows that the profile of the fraction of neutral hydrogen and the ionized radius are sensitively dependent on the intensity of the source .    </S>",
    "<S> ,    ,    ,    cosmology : theory , gravitation , hydrodynamics , methods : numerical , shock waves + 95.30.jx , 07.05.tp , 98.80.-k </S>"
  ]
}