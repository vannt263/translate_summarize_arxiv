{
  "article_text": [
    "cosmological perturbation theory has recently enjoyed renewed interest .",
    "linear or first order theory is still a very active field of research , though the focus has moved on to higher order and even fully non - linear theory .",
    "this is to a large extent due to the availability of much improved data sets : whereas previously linear theory was sufficient and the power spectrum the observable of choice , now the quality and quantity of the data is such , that higher order observables , as for example the bispectrum , can be compared with the theoretical predictions .",
    "these new data sets come from observations of the cosmic microwave background ( cmb ) on the one hand , such as the one already in progress by _ wmap _ and in the near future also by _",
    "planck_. but also from 21 cm surveys on the other hand , mapping the anisotropies in neutral hydrogen , such as _ lofar _ , now under construction and _ ska _ , currently in its design phase .",
    "einstein s theory of general relativity ( gr ) is highly non - linear , it is therefore difficult to deal with in all but the simplest situations using the full theory .",
    "fortunately for cosmologists the universe appears to the homogeneous and isotropic to a remarkable degree so the friedmann - robertson - walker ( frw ) metric is adequate for many purposes .",
    "for instance , once known local features are removed , the cmb is isotropic to an accuracy of @xmath0 of @xmath1 .",
    "however if we want greater resolution or more detail then the approximation has to take into account anisotropy and inhomogeneity . at present",
    "this can not be done in full generality since we do not have the appropriate exact solutions to einstein s equations .",
    "this is not surprising , given their highly non - linear nature . to deal with this problem cosmologists",
    "have resorted to perturbation methods , which have proved effective in other areas of physics .",
    "previous relevant works on perturbation theory in cosmology at a linear order include refs .",
    "@xcite , and at second order @xcite . beyond linear order",
    "the literature tends to be very technical and difficult for the non - specialist to follow . in this paper",
    "we aim to strike a balance between mathematical rigour using the language and tools of differential geometry , and usability and applicability to the problems of theoretical astrophysics and cosmology .",
    "+ the essential idea behind perturbation theory is very simple , and best illustrated by an example for which we choose the metric tensor in standard cosmology .",
    "we assume that we can approximate the full metric @xmath2 of the universe by an expansion [ xyz ] g _",
    "= g^(0 ) _ + g^(1 ) _ + g^(2)_+  the metric @xmath3 , called the background , is the frw metric with appropriate spatial curvature , i.e. @xmath4 according to the assumptions made about the universe .",
    "the remaining terms are the perturbations of the background .",
    "the first order part is given by g _",
    "= g^(1 ) _ , where the remaining terms are assumed to be negligible compared to @xmath5 and are neglected at _",
    "first order_. in a similar way the higher order perturbations can be identified .",
    "this can be described simply if we assume that the series can be written as g _",
    "= g^(0 ) _ + ^(1 ) _ + ^2",
    "^(2 ) _ +  where the quantities with tildes have absolute magnitudes of order unity , and we assume that @xmath6 . to zeroth order we have @xmath7 and at first order g _ = g^(0 ) _ + ^(1 ) _ , and so on using the fact that at each order the higher order terms can be ignored . in practise",
    "it is often a nuisance to introduce the parameter @xmath8 so , where appropriate we will use the form ( [ xyz ] ) .",
    "issues of convergence can be removed by working within a small enough neighbourhood of the background .",
    "having set up the approximation ( [ xyz ] ) , we have to substitute it into the einstein equations g",
    "= t _ , to obtain approximate solutions at the required order of approximation for the application we have in mind .",
    "this is more difficult than one might imagine .",
    "firstly , perturbations of the metric imply perturbations of the energy momentum tensor , but more importantly , calculation of the connection coefficients and the ricci tensor involves raising and lowering indices and involves terms of different orders . at zero and first order this is not a problem , but at higher orders it makes the calculations much more complicated and so the choice of coordinates or form of the metric can be important . already at second order",
    "we have `` proper '' second order terms and terms quadratic in the first order quantities .",
    "another problem arising in cosmological perturbation theory is the presence of spurious coordinate artefacts or gauge modes in the calculations . although gr is covariant , i.e.  manifestly coordinate choice independent , splitting variables into a background part and a perturbation is not a covariant procedure , and therefore introduces this gauge dependence . prior to 1980",
    "the gauge modes were handled on a case by case basis , when bardeen in ref .",
    "@xcite resolved the issue and provided a systematic procedure for eliminating the gauge freedom at first order . although it is sometimes argued that the covariant approach @xcite avoids the issue of gauge choice it corresponds to the comoving gauge which is made explicit by the inclusion of the velocity field @xcite .",
    "below we will address the gauge issue in some detail and explain how it can be resolved at first and at second order .",
    "+ the paper is organised as follows .",
    "in the next section we introduce perturbation theory using notation and concepts from differential geometry .",
    "in particular we discuss the definition of perturbations and how perturbations change under small coordinate changes . in section [ appl_sect ]",
    "we apply the concepts and results of section [ pert_sect ] .",
    "we discuss the construction of gauge - invariant variables at first and second order . amongst the examples discussed",
    "is the second order tensor perturbation and how it can be rendered gauge - invariant .",
    "we discuss our results in section [ dissc_sect ] .",
    "we finish this paper with an appendix in which we describe the relevant concepts from differential geometry used in section [ pert_sect ] .",
    "we predominantly use conformal time , @xmath9 , related to coordinate time @xmath10 by @xmath11 , where @xmath12 is the scale factor .",
    "derivatives with respect to conformal time are denoted by a dash .",
    "greek indices , @xmath13 , run from @xmath14 , upper case latin indices , @xmath15 run from @xmath16 , while lower case latin indices , @xmath17 , run from @xmath18 .",
    "in this section we introduce perturbation theory using differential geometry . though focusing on cosmology , we keep the discussion general . after giving a definition of perturbations",
    "we introduce and define the concept of gauge and study how perturbations change under gauge transformations .",
    "the relevant definitions from differential geometry are discussed in appendix a.      the application of perturbation methods in space - time brings in a new problem , since among the physical quantities to be perturbed is the space - time itself .",
    "also , because the results will be used in relativistic cosmology , the theory and results must be covariant .",
    "these requirement lead us to base our discussion on the explicitly coordinate independent description of sachs @xcite , stewart and walker @xcite and stewart @xcite . in this case by coordinate independent we mean that the description does not require coordinates and so is intrinsically covariant .",
    "we can and do introduce coordinates to do calculations and simplify the exposition . an alternative and widely used , but coordinate dependent , description is given in ref .  @xcite .",
    "as one would expect the results are the same although , in our view , it is easier to understand and see the source of the final equations in the description of ref .",
    "we will however describe both procedures and show the connection between the two approaches .",
    "+ we now follow stewart @xcite closely and consider a one parameter family of 4-manifolds @xmath19 embedded in a 5-manifold @xmath20 .",
    "each manifold in the family represents a perturbed space - time with the base or unperturbed space - time manifold represented by @xmath21 .",
    "we define a point identification map @xmath22 which identifies points in the unperturbed manifolds with points in the perturbed manifold .",
    "this correspondence specifies a vector field @xmath23 upon @xmath20 .",
    "this field is transverse to @xmath19 at all points .",
    "the points which lie on the same integral curve @xmath24 of @xmath23 are to be regarded as the same point , see fig .",
    "this can be expressed in terms of coordinates .",
    "choose coordinates @xmath25 on @xmath21 and extend them to @xmath20 by requiring that @xmath26 along each of the curves @xmath24 .",
    "this induces coordinates @xmath27 with @xmath28 and @xmath29 on @xmath20 .",
    "we parametrise the curves @xmath24 by @xmath8 and so @xmath30 and we choose the scaling of @xmath31 such that _ : m_0 . in this way",
    "the vector field @xmath23 generates a one to one , invertible , differentiable mapping between @xmath21 and @xmath32 , i.e. a one - parameter group of diffeomorphisms and it follows that @xmath33 . in particular the inverse map from @xmath32 to @xmath34 will be denoted , in an obvious notation , by @xmath35 and the identity map is given by @xmath36 .",
    "given a geometric quantity @xmath37 defined on @xmath20 the simplest way to produce a perturbation expansion of @xmath37 is to expand it as a taylor series along @xmath24 .",
    "this yields a covariant power series for @xmath37 along the curve . to first order",
    "the series has the form @xcite _ * t _ = t_0 + (  _ xt ) |_0 + o(^2 ) , where the @xmath38 is used to indicate that the quantity is the pullback , i.e.  it is @xmath39 evaluated at the point where @xmath40 .",
    "lie derivatives are used instead of partial derivatives so that the series is covariant . for reasons that will become obvious later",
    "it is convenient that the series is pulled back to @xmath41 ( see eq .",
    "( [ a10 ] ) ) . at higher orders",
    "the taylor expansion is given by @xcite [ phistarpertdef ] _ * t _",
    "= t_0 + _ j = 1^ (  ^j_x t ) |_0 , where we note again that @xmath42 is evaluated on @xmath34 .",
    "the expansion automatically provides the covariant perturbation expansion we want .",
    "each term in the series is proportional to a power of @xmath8 .",
    "the first term @xmath43 is proportional to @xmath44 , the background value , the next term @xmath45 is proportional to @xmath8 to the first order and so on , and the @xmath46 order term is given by @xmath47 .",
    "the expansion eq .",
    "( [ phistarpertdef ] ) can be written in a compact and useful form using the exponential operator , _ * t _ = ( e^(_x ) t ) |_0 , here @xmath48 is the perturbed value of @xmath37 pulled back to @xmath21 and so the perturbed value of @xmath37 is given by @xmath49 where we note that we could not have done the subtraction if we had not pulled @xmath50 back to @xmath21 . in an alternative notation , commonly used in the literature , we include the @xmath8 with the @xmath37 and write [ texp ] t = t_0 + t , where [ deltatexp ] t = t_1 + t_2 + t_3 +  , with @xmath51 .",
    "+ in ref .",
    "@xcite the approach is as follows . on a single space - time manifold @xmath52 with coordinates @xmath25 define a background model by assigning to all geometric fields @xmath53 a fixed background value @xmath54 , which is _ not _ itself a geometric quantity , at each point on the manifold . while the fields @xmath53 may transform as scalar , vector or tensor fields we require that the @xmath54 be fixed functions of the coordinates . under a coordinates transformation the @xmath54 will have the same functional dependence on the new coordinates as they had on the old ones .",
    "a perturbation is then given by q = q - ^(0)q .",
    "to relate the two approaches we can think of the @xmath54 quantity playing the role of a quantity defined on @xmath21 in the stewart description and the coordinate change corresponding to a change of coordinates on @xmath32 .",
    "but it is important to note that the approach of ref .",
    "@xcite only one manifold is necessary .",
    "the stewart approach @xcite avoids the need for the quantity @xmath54 , which is not covariant and gives a simple diagrammatic representation at the price of having to introduce the abstract 5-dimensional manifold @xmath20 .",
    "however , note that it is the split into a background and a perturbation which in general is not covariant .",
    "this split is common to both approaches and it gives rise to the gauge dependence .",
    "gauge is arguably the most over - used word in mathematics and physics .",
    "sometimes the meanings are related but often they are not and it is a waste of time trying to relate them . to avoid confusion",
    "we recommend that the word `` gauge '' as used here is interpreted as defined and not related to other uses of the word .",
    "the choice of correspondence between points on @xmath21 with those on @xmath19 or , equivalently , the choice of a vector field @xmath23 is a gauge choice .",
    "the vector field @xmath23 is called the generator of the gauge .",
    "let us now turn to defining gauge dependence in a clearer way .",
    "consider a point @xmath55 in @xmath21 and the generators @xmath23 and @xmath56 corresponding to two different gauge choices ( see fig .",
    "[ pic2 ] ) .",
    "the choice @xmath23 will identify point @xmath55 on @xmath34 with a point @xmath57 on @xmath19 and will assign to @xmath57 the same @xmath25 coordinates as at point @xmath55 . on the other hand",
    "the gauge choice @xmath56 will identify @xmath55 with a different point @xmath58 on @xmath19 assigning in its turn the coordinates of @xmath55 to @xmath58 . clearly",
    "the choice of gauge induces a coordinate change ( a gauge transformation ) on @xmath19 .",
    "this interpretation is called the _ passive view _ ref .",
    "+    for the _ active view _ we choose a point @xmath58 on @xmath19 and find the point @xmath55 on @xmath21 which maps to @xmath58 under the gauge choice @xmath23 and the point @xmath57 , also on @xmath21 , which maps to @xmath58 under the gauge choice @xmath56 , see fig .",
    "[ pic3alt ] . the gauge transformation this time",
    "is defined on @xmath21 and takes the coordinates of @xmath57 to those of @xmath55 in one of the two choices of gauge .    in summary as we shall explain in more detail below , in the active approach the transformation of the perturbed quantities is evaluated at the same coordinate point , whereas in the passive approach the transformation is taken at the same physical point . +    in the passive approach of ref",
    ".  @xcite the role of the background manifold is played by the background quantities @xmath54 and the coordinate transformation corresponding to the gauge choice only affects the geometric quantities @xmath53 .",
    "the perturbation is the difference between @xmath54 and @xmath53 so only half the quantities determining the perturbation are transformed by the gauge transformation .",
    "+ the gauge dependence in perturbation theory stems from the fact that we separate quantities into a background and a perturbed part , a operation not covariant in general , which introduces additional , unphysical degrees of freedom .",
    "however , as shown below in section [ appl_sect ] , by choosing and combining suitable matter and metric variables the gauge dependencies can be made to cancel out ( the quantities so constructed will not change under a gauge transformation ) .",
    "this process is equivalent to choosing suitable physical hypersurfaces , say comoving or of uniform curvature .      to take the argument",
    "further we will now focus on the active interpretation of the gauge transformation .",
    "corresponding to the gauge choice @xmath23 , i.e.  the choice of the vector field @xmath23 transverse to @xmath21 we have a diffeomorphism @xmath59 where @xmath60 and corresponding to the vector field @xmath56",
    "we have a diffeomorphism @xmath61 .",
    "for all @xmath8 these two vector fields induce a diffeomorphism ( gauge transformation ) @xmath62 on @xmath21 given by , see fig .",
    "[ pic3alt ] , _ : m_0 _ 0 , where @xmath63 is made up of two parts - a map @xmath64 from @xmath41 to @xmath65 and a map @xmath66 from @xmath65 to @xmath41 , i.e. _ : = _ - _ . under this gauge transformation",
    "the transformation of a geometric quantity @xmath37 is given by ( see appendix eq .",
    "( [ a6 ] ) and eq .",
    "( [ a9 ] ) ) @xmath67 where we have used the fact that the pull - backs of the transformations induced by the gauge choices can be written as taylor series in terms of the exponential notation as @xmath68 ( for more details again see the appendix eq .",
    "( [ a6 ] ) to eq .",
    "( [ a9 ] ) ) . also note that the @xmath37 here have to be evaluated on @xmath21 but putting @xmath43 would be confusing .",
    "+ now we invoke the baker - campbell - haussdorf formula @xcite which enables us to write @xmath69 in the following form [ 17a ] _ * t = ( _ n = 1^  _ _ n ) t , where @xmath70 , \\ \\ \\ { \\rm and } \\ \\ \\ \\xi_{3 } = \\frac{1}{2}[x + y , [ x , y]]\\,,\\ ] ] and @xmath23 and @xmath56 are the gauge generators , i.e. the vectors which determine the gauge choices .",
    "explicitly the first few terms of the gauge transformation eq .",
    "( [ 17a ] ) are @xmath71 + \\pounds^{3}_{\\xi_{1 } } \\right)t\\big|_{0 } + o(\\eps^{4}))\\,,\\end{aligned}\\ ] ] where we indicate that @xmath37 has to be evaluated on the manifold @xmath72 by the notation @xmath73 .",
    "if we now use the equation ( [ texp ] ) to introduce the results of taylor expanding @xmath37 into the formula eq .",
    "( [ 2.16 ] ) we obtain @xmath74 where @xmath75 is the vector field generating the transformation and @xmath76 .",
    "+ similarly the map ( [ 2.16 ] ) generated by @xmath77 enables us to relate two coordinate systems @xmath78 ( see fig .",
    "[ pic1 ] ) under an infinitesimal transformation generated by @xmath79 . in the active view",
    "this transformation takes the point @xmath55 with coordinates @xmath80 to the point @xmath81 with coordinates @xmath82 . note",
    "that in the active view it is the points that change . applying the map ( [ 17a ] ) it follows [ defcoordtrans ]",
    "x^ ( q ) = e^^|_p x^ ( p ) , where we have used the fact that when acting on scalars @xmath83 and the partial derivatives are evaluated at @xmath55 . ) the signs in the equation relating the coordinates in the passive approach , eq .",
    "( [ passive_coord ] ) below , would conform to those usually found in the literature . ]",
    "the left - hand - side and the right - hand - side of eq .",
    "( [ defcoordtrans ] ) are evaluated at different points .",
    "equation ( [ defcoordtrans ] ) can then be expanded up to second - order as [ coordtrans2 ] x^(q ) = x^(p)+_1^(p ) + ^2 .",
    "note that we do not need eq .",
    "( [ coordtrans2 ] ) to calculate how perturbations change under a gauge transformation in the active approach , it simply tells us how the coordinates of the points @xmath55 and @xmath57 are related in this approach .      in the passive approach",
    "we specify the relation between two coordinate systems directly , and then calculate the change in the metric and matter variables when changing from one system to the other . as long as the two coordinate systems are related through a small perturbation ,",
    "the functional form relating them is quite arbitrary .",
    "however , in order to make contact with the active approach , discussed above , we take eq .",
    "( [ coordtrans2 ] ) as our starting point .",
    "note , that all quantities in the passive approach are evaluated at the same physical point . to take the passive approach further",
    ", we therefore need to rewrite the left - hand - side and the right - hand - side of eq .",
    "( [ coordtrans2 ] ) , since they are evaluated at two different coordinate points , as described above ( see also fig .  [ pic2 ] ) .",
    "we choose @xmath55 and @xmath57 to be points such , that the coordinates of @xmath57 in the new coordinates are the same as the coordinates of @xmath55 in the old coordinates , i.e.  @xmath84 , then use eq .",
    "( [ coordtrans2 ] ) to derive [ coordtrans3 ] ( q ) & = & x^(p ) + & = & x^(q ) -^_1(x(p ) ) -^2 . using the first terms of eq .",
    "( [ coordtrans2 ] ) we have x^(q)= x^(p)+_1^(p ) , to get a taylor expansion for @xmath85 , [ xi1(p ) ] _",
    "1^(p ) & = & _ 1^(x^(q)-_1^(p ) ) + & = & _ 1^(q)-_,_1^  ( q ) , where in the very last term we have replaced @xmath86 by @xmath87 , the correction being of third order .",
    "substituting eq .",
    "( [ xi1(p ) ] ) into eq .",
    "( [ coordtrans3 ] ) finally gives the desired result , namely a relation between the `` old '' ( untilded ) and the `` new '' ( tilde ) coordinate systems , [ passive_coord ] ( q)=x^(q)-_1^(q ) -^2 , all evaluated at the same point @xmath57 .",
    "as an application and illustration of the above we now derive the transformation behaviour under gauge transformations of some quantities at first and second order .",
    "we start at first order by highlighting the two different points of view in how the vector fields inducing the coordinate change affect the perturbations , as detailed above in section [ gaugetrans_sect ] . +",
    "before studying the transformation behaviour of the perturbations , we define and relate them to their respective backgrounds in the following . as our first example",
    "we choose a four - scalar , we use here the energy density @xmath88 , which can be expanded up to second order using eq .",
    "( [ texp ] ) = _ 0+_1 + 12_2 , where we already split @xmath89 into its first and second order parts according to eq .",
    "( [ deltatexp ] ) , the subscripts denoting the order of the perturbations .",
    "our second example is given by the metric tensor @xmath90 , as outlined in eq .",
    "( [ xyz ] ) .",
    "in particular , using eq .",
    "( [ texp ] ) , the complete friedmann - robertson - walker metric tensor , up to and including second - order perturbations , can be written as [ metric1 ] g_00&=&-a^2(1 + 2_1+_2 ) , + g_0i&=&a^2(b_1i+b_2i ) , + g_ij&=&a^2 , where we assumed a flat ( @xmath91 ) background .",
    "the first and second order perturbations @xmath92 and @xmath93 , and @xmath94 and @xmath95 , can be further split according to eqs .",
    "( [ decompbi ] ) and ( [ decompcij ] ) below into scalar , vector and tensor parts ( defined according to their transformation behaviour on spatial 3-hypersurfaces ) , [ decompbi ] b_i & = & b_,i - s_i , + [ decompcij ] c_ij & = & -_ij + e_,ij+ f_(i , j ) + h_ij .",
    "where the vector parts , @xmath96 and @xmath97 , are divergence free , and the tensor part , @xmath98 is divergence free and traceless , i.e. [ divandtraceless ] s^k _  , k=0 , f^k _  , k=0 , h^ik _  , k=0 , h^k _  k=0 .",
    "the order of the perturbations in eqs .",
    "( [ decompbi ] ) , ( [ decompcij ] ) , ( [ divandtraceless ] ) and has been omitted in the above for ease of presentation .",
    "note that @xmath99 is the curvature perturbation , describing the intrinsic scalar curvature of spatial hypersurfaces .",
    "furthermore @xmath100 is the lapse function , @xmath98 the tensor perturbation describing the gravitational wave content , @xmath101 and @xmath102 describe the scalar shear , and @xmath96 and @xmath97 the vector part of the shear .    here and in the following we assume a flat background without loss of generality , just simplifying our calculations and allowing us to use partial derivatives in expressions such as eq .",
    "( [ decompcij ] ) .",
    "the perturbations are decomposed into scalar , vector , and tensor parts since at linear order the governing equations for the different types decouple .",
    "this is however no longer the case at higher orders , and indeed we already see from the gauge - transformations and the definitions of gauge - invariant variables at second order that e.g.  the energy density ( a scalar quantity ) on flat hypersurfaces now also contains first order vector and tensor parts , see eq .",
    "( [ rho2flat ] ) .",
    "finally , we should point out that the decomposition of the metric tensor in eq .",
    "( [ metric1 ] ) is not unique .",
    "this is already evident in the temporal part of the metric tensor , where the lapse function @xmath100 is here simply expanded in a power series , @xmath103 .",
    "alternatively we could have expanded @xmath104 into a power series , this obviously does nt affect the physics . more importantly , also the decomposition of the spatial part of the metric tensor , that is eq .",
    "( [ decompcij ] ) is not unique . indeed , other decompositions are in use and can be just as useful or better , depending on the circumstances and the application intended",
    ". for example it can be useful instead of expanding @xmath99 in eq .",
    "( [ decompcij ] ) directly into a power series , to expand @xmath105 ( see e.g.  ref .",
    "@xcite , and for a relation of the two expansions ref .",
    "@xcite ) .",
    "the passive point of view is very popular at first order , see e.g.  the original paper by bardeen @xcite , the review by kodama and sasaki @xcite , and the one by mukhanov , feldman , and brandenberger @xcite .",
    "the starting point in the passive approach is to identify an invariant quantity , that allows to relate quantities to be evaluated in the two coordinate systems .",
    "we denote the two coordinate systems by @xmath106 and @xmath107 system , and their relation is given by eq .",
    "( [ passive_coord ] ) .",
    "we choose as an example the energy density , @xmath88 , which as a four scalar wo nt change ( however , once it has been split into different orders , it will change ) .",
    "another invariant is the line element @xmath108 , which allows to study the transformation properties of the metric tensor , by exploiting the invariance of @xmath108 , i.e. , ds^2=g_d x^dx^= g_dx^d x^ , which we here will not pursue , but see e.g.  @xcite .    turning instead to the energy density as an illustrative example",
    ", we get the transformation behaviour of the perturbation from the requirement that it has to invariant under a change of coordinate system and therefore has to be the same in the @xmath106 and the @xmath107 system , that is [ tilderho ] ( x^)= ( x^ ) .",
    "to first order , the two coordinate systems are related , using the linear part of eq .",
    "( [ passive_coord ] ) , by x^=x^-_1^. before we can study the transformation behaviour of the perturbations at first order , we split the generating vector @xmath109 into a scalar temporal part @xmath110 and a spatial scalar and vector part , @xmath111 and @xmath112 , according to [ def_xi1 ] _",
    "1^=(_1,_1,^  i+1 ) , where the vector part is divergence - free @xmath113 . then expanding the left - hand side of eq .",
    "( [ tilderho ] ) , we get neglecting terms of @xmath114 , ( x^)&=&(x^-^ ) + & = & ( x^ ) - _ , ^ + & = & _ 0+_1-_0_1 , and similarly expanding the right - hand side of eq .",
    "( [ tilderho ] ) , we have ( x^)=_0(x^)+_1(x^ ) . finally , since by assumption @xmath115",
    ", we get [ rho_trans_passive1 ] _ 1=_1+_0_1 . note that all quantities are evaluated at the same physical point .",
    "we now turn to the active point of view when calculating the effect of gauge transformations on perturbations . here , as detailed in section [ gaugetrans_sect ] above , one actively maps the perturbed quantities from one manifold to another .",
    "the relation of the coordinate systems on the two manifolds is also induced by the map .    at",
    "first order the preference of which approach to use is a question of taste , and as pointed out above most first order papers use passive view point , but see e.g.  @xcite for first order active calculation . however , at second order we found the active view point easier to implement , and it is used in many other second order works , e.g.  refs .",
    "@xcite .",
    "as in the passive view section above , we start with the energy density .",
    "it follows immediately from eq .",
    "( [ 2.18 ] ) that to first order a scalar quantity such as the energy density transforms as [ transrho_1 ] _ 1 = _ 1 + _ 0_1 .",
    "the transformations of the first order metric perturbations also follow from eq .",
    "( [ 2.18 ] ) .",
    "we then find that the metric tensor transforms at first order , as [ general_gmunu1 ] & = & g^(1 ) _",
    "+ g^(0)_,^_1 + g^(0)_^_1  , + g^(0)_^_1  ,    as another example we now turn to the spatial part of the metric tensor . note that eq .",
    "( [ 2.18 ] ) gives only the transformation of the total spatial part of the metric , @xmath116 . if we then ask how the components of @xmath116 transform , we have to use eq .",
    "( [ divandtraceless ] ) .    to get the change of the metric functions in the spatial part of the metric under a gauge transformation",
    ", we get the transformation of the spatial part of the metric @xmath117 , and hence @xmath93 , from eq .",
    "( [ general_gmunu1 ] ) as [ cij1trans ] 2c_1ij=2 c_1ij + 2_1_ij+_1i , j+_1j , i , where we reproduce eq .",
    "( [ decompcij ] ) above for convenience at first order , [ decompcij1 ] 2 c_1ij=-2_1_ij+2e_1,ij+2 f_1(i , j)+h_1ij . taking the trace of eq .",
    "( [ cij1trans ] ) and substituting in eq .",
    "( [ decompcij1 ] ) we get [ cij1trace ] -3_1+^2e_1 = -3_1+^2 e_1 + 3_1+^2_1 .",
    "now applying the operator @xmath118 to eq .",
    "( [ cij1trans ] ) we get a second equation relating the scalar perturbation @xmath119 and @xmath120 , [ cij1divdiv ] -3 ^ 2_1+^2 ^ 2e_1 = -3 ^ 2_1+^2 ^ 2 e_1 + 3 ^ 2_1 + ^2 ^ 2_1 .",
    "taking the divergence of eq .",
    "( [ cij1trans ] ) we get 2c_1ij,^  j=2 c_1ij,^  j + 2_1,i + ^2_1i+^2_1,i .",
    "substituting in our results for @xmath121 and @xmath122 we the arrive at ^2 f_1i= ^2 f_1i+^2 1 .",
    "we can sum up the well known transformations of the first order metric perturbations we have from the above , first for the scalars as ( e.g.@xcite ) [ transphi1 ] & = & 1 + _ 1+_1 , + [ transpsi1 ] _ 1 & = & _ 1-_1 , + [ transb1 ] b_1 & = & b_1-_1+_1 , + [ transe1 ] e_1 & = & e_1+_1 , where @xmath123 , and for the vector perturbations as [ transs1 ] & = & s_1^  i-1 , + [ transf1 ] & = & f_1^  i+1 .    the first order tensor perturbation is found to be gauge - invariant , h_1ij = h_1ij . by substituting eqs .",
    "( [ transphi1 ] ) to ( [ transf1 ] ) into eq .",
    "( [ cij1trans ] ) .",
    "this can also be understood from the stewart - walker lemma @xcite : at first order , quantities that are identically zero in the background are manifestly gauge - invariant , and there is no tensor part in the background .",
    "however , as we shall see below , this only works for quantities at the next higher order : for example the second order tensor perturbations will in general not be gauge - invariant .      to construct a gauge - invariant quantity ,",
    "say the energy density on flat slices , that is hypersurfaces on which @xmath124 , we see from eq .",
    "( [ transpsi1 ] ) that this gives [ flat_def1 ] _ 1 = .",
    "all we need to do next is to substitute eq .",
    "( [ flat_def1 ] ) into eq .",
    "( [ transrho_1 ] ) , and get a gauge - invariant in the sense of being independent of gauge artifacts , for example the energy density on flat slices [ example1 ] _ 1|_flat = _",
    "this is gauge - invariant in the @xmath125-independence sense , but it does depend on the choice of background ( e.g.  a background depending on @xmath126 instead of just time as in frw would obviously give a very different result ) .",
    "this works for all the perturbations and also at second order and higher .",
    "we conclude the above example by observing that to remove the gauge modes on sub - horizon scales , often referred to as specifying the _ threading _ , we can choose @xmath127 , which gives [ flat_def1a ] _ 1 = -e_1 . for the vector modes we choose @xmath128 , which gives [ flat_def1b ] 1 = -f_1^i .",
    "hence in this gauge the spatial part of the perturbed metric is zero with the exemption of the tensor - modes .      at second order",
    "the generating vector @xmath129 is split into a scalar time and scalar and vector spatial part , similarly as at first order , [ def_xi2 ] _",
    "2^=(_2,_2,^  i+2 ) , where the vector part is divergence - free @xmath130 .",
    "we then find from eqs .",
    "( [ 2.18 ] ) that a four scalar transforms at second order [ rhotransform2 ] _ 2 = _ 2 + _ 0_2&+&_1 ( _ 0_1+_0_1+2_1 ) + & + & ( 2_1+_0_1)_,k ( _ 1,^  k+1 ) .",
    "we see here already the coupling between vector and scalar perturbations in the last term through the gradient and @xmath112 .",
    "the gauge is only specified once the scalar temporal gauge perturbations at first and second order , @xmath110 and @xmath131 , and the first order spatial gauge perturbations , @xmath111 and @xmath112 , are specified .",
    "+ the metric tensor transforms at second order , from eq .",
    "( [ 2.18 ] ) as [ general_gmunu2 ] & = & g^(2 ) _ + g^(0)_,^_2 + g^(0)_^_2  , + g^(0)_^_2  , + 2 + & & + g^(0)_,^_1^_1 + g^(0)_,^_1  , ^_1 + 2 + & & + g^(0 ) _",
    "( ^_1  , ^_1 + ^_1  , ^_1 ,   ) + g^(0 ) _ ( ^_1  , ^_1 + ^_1  , ^_1 ,   ) . now following similar lines as at first order in the previous section",
    ", we could get the transformation behaviour for the second order lapse function @xmath132 straight from the @xmath133-component of eq .",
    "( [ general_gmunu2 ] ) .",
    "instead , to keep the discussion as brief as possible , we now turn to the transformation behaviour of the perturbations in the spatial part of the metric tensor . here",
    "we can follow a similar procedure as in the linear case .",
    "but , the task is made more complicated not only by the size of the expressions but more importantly by the fact that now we will have to let inverse laplacians operate on products , in order to get the transformations of the scalar , vector , and tensor parts of the spatial metric .    using eq .",
    "( [ general_gmunu2 ] ) we find that the perturbed spatial part of the metric , @xmath95 , transforms at second order as [ cij2trans ] 2c_2ij&=&2c_2ij+2_2 _ ij + _",
    "2i , j+_2j , i+_ij , where we defined @xmath134 to contain the terms quadratic in the first order perturbations as [ xijdef ] _ ij & & 2_ij + & & + 4 + 2(b_1i_1,j+b_1j_1,i ) + & & + 4_1 ( _ 1i , j+_1j , i ) -2_1,i_1,j+2_1k , i_1  , j^  k + _ 1 ( _ 1i , j+_1j , i ) + ( _ 1i , jk+_1j , ik)_1^  k + & & + _ 1i , k_1  , j^  k+_1j , k_1  , i^  k + _ 1i_1,j+_1j_1,i . note that in eq .",
    "( [ xijdef ] ) above and in the following we will not decompose the spatial part of eq .",
    "( [ def_xi1 ] ) , @xmath135 , whenever convenient to keep the presentation as compact as possible .",
    "the perturbed spatial part of the metric , @xmath95 , is decomposed in eq .",
    "( [ decompcij ] ) above into scalar , vector , and tensor part , which we reproduce here at second order , [ decompcij2 ] 2 c_2ij=-2_2_ij+2e_2,ij+2 f_2(i , j)+h_2ij . taking the trace of eq .",
    "( [ cij2trans ] ) and substituting in eq .",
    "( [ decompcij2 ] ) we get [ cij2trace ] -3+^2 & = & -3_2+^2 e_2 + 3_2 + ^2_2 + ^k _",
    "k , where we find @xmath136 to be [ xtrace ] ^k _  k&= & 3(^2+)_1 ^ 2 + 3(_1_1+_1,k_1^  k ) + & & + 2 + 2b_1k_1,^  k + & & -_1,k_1,^  k + 2_1  , ^k  l_1(k , l ) + _ 1 ^ 2(_1+4_1 ) + ^2_1,k_1^  k + _ 1k_1,^  k. now applying the operator @xmath118 to eq .",
    "( [ cij2trans ] ) we get a second equation relating the scalar perturbations @xmath137 and @xmath138 , [ cij2divdiv ] -^2_2+^2 ^ 2e_2 = -^2_2+^2 ^ 2 e_2+^2_2 + ^2 ^",
    "2_2 + ^ij _  , ij , this gives for the transformations of the curvature perturbation at second order , [ transpsi2 ] _",
    "2=_2-_2-^k _  k + ^-2 ^ij _  , ij , and for the shear scalar , [ transe2 ] e_2=e_2+_2+^-2 ^ -2^ij _  , ij -^-2^k _  k.    taking the divergence of eq .",
    "( [ cij2trans ] ) we get 2c_2ij,^  j=2 c_2ij,^  j + 2_2,i + ^2_2i+^2_2,i+_ik,^  k. substituting in our results for @xmath139 and @xmath140 we then arrive at ^2 f_2i= ^2 f_2i+^2 _ 2i + _",
    "ik,^  k-^-2^kl _  , kli .",
    "finally f_2i= f_2i+_2i + ^-2_ik,^  k-^-2 ^ -2^kl _  , kli .",
    "we finally turn to the tensor perturbation at second order . substituting our previous results for @xmath137 , @xmath138 , and @xmath141 into eq .",
    "( [ cij2trans ] ) we get , probably surprisingly , [ transhij2 ] h_2ij&= & h_2ij+_ij + ( ^-2^kl _  , kl-^k _  k ) _",
    "ij + ^-2 ^ -2^kl _  , klij + & & + ^-2^k _  k , ij -^-2(_ik ,  j^  k+_jk ,  i^  k ) .",
    "although the second - order tensor transformation @xmath142 is not dependent on the second - order gauge - functions @xmath143 , it does depend on first order quantities quadratically .",
    "the same holds for other quantities that are zero in the background : the first order quantity is gauge - invariant by virtue of the stewart - walker lemma @xcite ( and by construction ) .",
    "however the second order quantity is no longer gauge - invariant , as shown above in the case of the tensor perturbation , @xmath142 .",
    "this is not a violation of the stewart - walker lemma , it merely shows that the second order quantities `` live '' in a first order `` background '' .",
    "another example is the anisotropic stress , which is gauge - invariant at first order , but not at second .",
    "we can now construct , just as at first order in section [ construct_sect1 ] , gauge - invariant variables at second order .",
    "we choose the same example as in the previous section , namely the energy density on flat hypersurfaces .",
    "but now also give the second order tensor perturbation in this gauge .",
    "to specify the gauge at second order we choose hypersurfaces on which @xmath144 , and we see from eq .",
    "( [ transpsi2 ] ) that this gives [ flat_def2 ] _ 2=+ , where we get @xmath145 from eq .",
    "( [ xijdef ] ) using the first order gauge generators given above , as [ xijflat ] _",
    "ij&= & 2_ij + _",
    "1(c_1ij+2c_1ij ) + & & + 4 c_1ij , k_1^k + ( 4 c_1ik+_1i , k)_1,j^k + ( 4 c_1jk+_1j , k)_1,i^k + & & + -_1,i_1,j + & & + _ 1 ( _ 1(i , j)+4_1(i , j ) ) + 2_1^k_1(i , j)k + 2_1k , i_1,j^k , + where we defined _ 1i=-(e_1,i+f_1i ) . the trace of eq .",
    "( [ xijflat ] ) is then ^k_k&=&6+_1(c_1  k^k+2c_1  k^k ) + & & + 4 c_1  k , l^k_1^l + 4(2 c_1^kl+_1,^k  l)_1(k , l ) -2 ^ 2e_1,k_1^k + & & + ( 2b_1k+_1k-_1,k)_1,^  k -(_1 ^ 2e_1+4 ^ 2e_1 )",
    ". then substituting at first order eqs .",
    "( [ flat_def1 ] ) , ( [ flat_def1a ] ) , and ( [ flat_def1b ] ) , and at second order eq .",
    "( [ flat_def2 ] ) into eq .",
    "( [ rhotransform2 ] ) , we get the second order energy density perturbation on uniform curvature hypersurfaces @xcite [ rho2flat ] & = & _ 2 + _ 2 + ( ^-2^ij_,ij-^k_k ) + & & + + ( 2_1+_1)_,k_1^k .    the second order tensor perturbation in that the flat gauge , i.e.  on uniform curvature hypersurfaces , is given by substituting eqs .",
    "( [ flat_def1 ] ) , ( [ flat_def1a ] ) , and ( [ flat_def1b ] ) , into eq .",
    "( [ transhij2 ] ) , and we find after some algebra [ hij2flat ] h_2ij&= & h_2ij+_ij + ( ^-2^kl_,kl-^k_k ) _ ij + ^-2 ^ -2^kl_,klij + & & + ^-2^k_k , ij -^-2(_ik , j^  k+_jk , i^  k ) .",
    "this is neither the first , nor will it be the last , discussion of perturbation theory in cosmology .",
    "however , in this concise introduction we have tried to strike a balance between mathematical rigour and ease of application of the results . for a more detailed exposition of cosmological perturbation theory and further references",
    "see ref .",
    "@xcite .",
    "we have here studied perturbations about a flat frw background spacetime .",
    "but as pointed out above , the formalism introduced by bardeen can easily be applied to other settings and background spacetimes , and can also be extended beyond gr . indeed , perturbation theory and the formalism discussed in this paper",
    "can be applied to all covariant metric theories .",
    "although here we have assumed standard four dimensional ( 4d ) einstein gravity throughout , the formalism has also been applied , for example , to 5d braneworld models ( see e.g.  ref .",
    "@xcite for an overview ) , and has been used to construct gauge - invariant variables in that theory .",
    "whereas most of the material discussed in the previous sections has been expounded elsewhere , albeit often in different form and with other aims , we are not aware of the derivation of how the second order tensor perturbations transforms in full generality under gauge - transformations being discussed elsewhere ( see however ref .",
    "@xcite for the case of scalar perturbations ) .",
    "also its representation in the uniform curvature gauge has been discussed for the first time .",
    "these results will be of particular interest in second order calculations of the gravitational wave background @xcite .",
    "the transformations at second order of the decomposed components of the spatial parts of the metric have also not been discussed in the literature before , and will be particularly useful in relating quantities calculated in different gauges .",
    "the authors are grateful to adam christopherson , david seery , and david wands for useful discussions and comments .",
    "in this appendix we bring together some key ideas and definitions from differential geometry , in particular those regarding maps of manifolds , which are useful in setting up perturbation theory in general relativity where covariance matters .",
    "this appendix is not a comprehensive study as our intention is only to show , intuitively , why certain expressions take the form they do and to define some key ideas . in order to be useful to those who do not wish to enter into the formalism of differential geometry we will use coordinate expressions where possible . for those who worry about these things we will therefore be working in coordinate neighbourhoods and all functions",
    "will be assumed to be adequately differentiable as they are for most of cosmology . for more details and a less coordinate dependent approach",
    "the reader is referred to the books by hawking and ellis @xcite and by wald @xcite .",
    "+    * * maps between manifolds * + we assume some familiarity with the definition and properties of differential manifolds and are concerned here with maps between such manifolds , in particular a diffeomorphism .",
    "consider two manifolds @xmath52 and @xmath146 and denote the chart maps ( coordinates ) on each by @xmath147 in words the function @xmath148 assigns coordinates ( in @xmath149 ) to points in the n - dimensional neighbourhood @xmath150 of @xmath151 and @xmath152 does the same in the neighbourhood @xmath153 of @xmath154 .",
    "+ the map : m , is @xmath155 , i.e. infinitely continuously differentiable in the advanced calculus sense , if for each @xmath12 and @xmath156 the map [ map ] f_a ^-1 g^-1_b : u_b u_a , is @xmath155 .",
    "the map @xmath100 is a diffeomorphism if it is one - to - one , onto and @xmath100 and its inverse @xmath157 are @xmath155 . loosely speaking , for coordinates \\{@xmath158 on @xmath149 and @xmath159 on @xmath160 } , eq .",
    "( [ map ] ) relating the coordinates under the map @xmath100 can be represented by the equations y^",
    "= ^(x^ ) , with inverse x^ = ( ^-1)^(y^ ) , where @xmath161 and @xmath162 are @xmath155 . * * maps of vectors induced by mapping manifolds * a manifold map @xmath163 induces a map of the tangent vectors at @xmath55 on @xmath52 to tangent vectors at @xmath164 on @xmath32 .",
    "we will write this map as @xmath165 where @xmath166 and @xmath167 denote the tangent spaces at @xmath55 and @xmath164 . using the coordinate description above",
    ", the map @xmath168 can be written as ( ^*)^ _ = , and if @xmath169 and @xmath170 then ( ^*)^ _ : x^ y^ ,  or   y^ = ( ^*)^ _ x^ = x^ , in the usual notation .",
    "the map @xmath168 is sometimes called a pushforward . * * pullback * + the concept of a pullback is well described by its name .",
    "if we are given a function @xmath171 defined on a manifold @xmath20 so f : n ^n , and a manifold map : m , then @xmath100 can be used to _",
    "@xmath171 from @xmath20 to @xmath52 by using the composite map @xmath172 .",
    "this pulls @xmath171 back from @xmath20 to map @xmath52 to @xmath173 , i.e. f : m ^n .",
    "this is perhaps easier to follow if viewed as a sequence : the @xmath100 maps @xmath52 to @xmath20 then @xmath171 maps @xmath20 to @xmath173 or , in symbols , f : m f : n ^n .",
    "the map @xmath172 is the pullback of @xmath171 . *",
    "* maps of covectors induced by mapping manifolds * + for covectors ( forms or covariant vectors ) the map between manifolds @xmath174 induces a pullback map @xmath38 which takes covectors at @xmath175 on @xmath32 to covectors at @xmath55 on @xmath52 , i.e. , _ * : w_(p ) w_p , where @xmath176 denotes the cotangent space at @xmath164 on @xmath177 and @xmath178 is the cotangent space at @xmath55 on @xmath52 . this can be written in coordinates , by letting @xmath179 and @xmath180 , and we can write x _ = ( _ * ) ^ _ y _ = y _ , y _ = ( ) ^-1 x _ .",
    "the mapping of covariant and contravariant tensors of higher rank follows the same pattern as that for the vectors and covectors .",
    "tensors with mixed co- and contravariant indices also follow this pattern , although proving it requires a little care ( see @xcite p.  438 ) .",
    "a pullback on a vector field effectively reverses the effect of a pushforward and so the definitions of pullback and pushforward act to preserve the scalar property of the product of a vector and a covector . * * pullback of a composite map * + note that for composites of maps the pullback behaves in a different way to the push forward . for pushforward maps , : m , : n , the composite is simply : m . for the corresponding pullback maps we have @xmath181 but , and",
    "this is important , if we remove the bracket we have to reverse the maps _ * _ * : p , [ a9 ] i.e.  @xmath182 as can be seen by looking at the actions of the maps themselves . * * lie derivative * + let @xmath52 be a differential manifold and let @xmath183 be a vector field on @xmath52 , then @xmath183 generates a map of @xmath52 onto itself as follows . in a coordinate neighbourhood",
    "solve the system of ordinary differential equations = ^ , in @xmath184 .",
    "given initial points in @xmath185 at @xmath186 this will generate a unique one parameter family of integral curves with one and only one curve through each point in a neighbourhood .",
    "for an integral curve @xmath24 let @xmath187 be the point a distance @xmath31 along @xmath24 from @xmath55 . applied to the family of curves @xmath188 generates a one parameter family of diffeomorphisms of @xmath185 onto itself .",
    "clearly @xmath189 and @xmath190 is the identity map . +",
    "now let @xmath37 be a tensor field on @xmath52 then the pullback @xmath38 of @xmath100 defines a new tensor field @xmath191 on @xmath52 which is a function of @xmath31 .",
    "this enables us to define the lie derivative , a covariant differentiation on @xmath52 , which does not increase the rank of the tensor .",
    "t : = _ 0 ( _ * t - t ) , [ a10 ] this can be interpreted as follows - the map @xmath192 pulls back the value of @xmath37 at @xmath187 to @xmath55 from which we subtract the actual value of @xmath37 at @xmath55 .",
    "this difference is a well defined tensor quantity since the difference is taken at the point @xmath55 .",
    "we can now take the limit to obtain a meaningful derivative at @xmath55 - called the lie derivative . *",
    "* exponential operator * + given an operator @xmath193 the exponential operator is defined by the formal series e^a : = 1 + a + a^2 + _ n = 3^ ( ) a^n .",
    "thus , for instance , if @xmath194 is the lie derivative operator multiplied by @xmath31 the corresponding exponential operator is given by e^ _ : = 1 +  _ +  _ ^2 + _ n = 3^ ( )  _ ^n ."
  ],
  "abstract_text": [
    "<S> we give a concise , self - contained introduction to perturbation theory in cosmology at linear and second order , striking a balance between mathematical rigour and usability . </S>",
    "<S> in particular we discuss gauge issues and the active and passive approach to calculating gauge transformations . </S>",
    "<S> we also construct gauge - invariant variables , including the second order tensor perturbation on uniform curvature hypersurfaces . </S>"
  ]
}