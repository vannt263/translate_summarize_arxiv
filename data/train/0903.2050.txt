{
  "article_text": [
    "it is well - appreciated in physics that the properties of a field must often be determined indirectly , such as by observing the effect of the field on a test particle .",
    "take magnetometry for example : the strength of a magnetic field might be inferred by observing larmor precession in a spin - polarized atomic sample @xcite and estimating the field strength @xmath1 from the precession rate .",
    "inherent in this process is the fact that the atomic spin must be measured to determine the extent of the magnetically - induced dynamics . for very precise measurements , uncertainty @xmath2 in the estimated value @xmath3 of the field",
    "is dominated by quantum fluctuations in the observations performed on the atomic sample .",
    "the results presented here fall under the umbrella of quantum parameter estimation theory @xcite , where the objective is to work within the rules of quantum mechanics to minimize , as much as possible , the propagation of this quantum uncertainty into the determination of metrological quantities , like @xmath1 .",
    "given , for instance , a @xmath4-axis magnetic field @xmath5 , an atomic sample couples to @xmath1 via the magnetic dipole hamiltonian @xmath6 where @xmath7 is the atomic gyromagnetic ratio and @xmath8 ( @xmath9 ) are the collective spin operators obtained from a symmetric sum over @xmath10 identical spin-@xmath11 atoms .",
    "if the atoms are initially polarized along the @xmath12-axis , the larmor dynamics and thus @xmath1 can be inferred by observing the @xmath13-component of the atomic spin @xmath14 @xcite .",
    "it is possible to place an information - theoretic lower bound on the units - corrected mean - square deviation of any magnetic field estimator @xmath3 from the actual value of the field @xmath1 , @xmath15 via the quantum cramr - rao inequality ( as described in section [ section : cr ] ) @xcite . the behavior of the estimator uncertainty with the number of atoms @xmath10 depends on the characteristics ( e.g. , separable , entangled , etc . ) of the quantum states used to compute the expectation value in eq .",
    "( [ equation::crerror ] ) as well as the nature of the induced dynamics @xcite .",
    "if one does not permit quantum entanglement between the different atoms in the probe , it can be shown that the optimal parameter resolution obtained from eq .",
    "( [ equation::hlarmor ] ) , evolved for a time @xmath16 , is given by the so - called shotnoise uncertainty @xcite @xmath17 whose characteristic @xmath18 scaling is a byproduct of the projection noise @xmath19 for a spin coherent state @xcite ( here @xmath20 for a sample of @xmath10 atoms each with total spin quantum number @xmath11 ) .",
    "it was believed for some time that the fundamental limit to parameter estimation , even when exploiting arbitrary entanglement between atoms in the probe , offers only a quadratic improvement @xmath21 up to an implementation - dependent constant @xmath22 .",
    "( [ equation::deltabhl ] ) has traditionally been called the heisenberg uncertainty scaling , and it can be achieved in principle for various spin resonance metrology problems @xcite , including magnetometry @xcite . for an ensemble of @xmath10 spin-1/2 particles prepared into the initial cat - state @xmath23 ,",
    "the uncertainty scaling is given by @xmath24 and is sometimes called the _ heisenberg limit_.",
    "recently , however , it was shown that @xmath25 scaling can be surpassed @xcite by extending the linear coupling that underlies eq .",
    "( [ equation::hlarmor ] ) to allow for multi - body collective interactions @xcite .",
    "were one to engineer a probe hamiltonian where @xmath1 multiplies @xmath26-body probe operators , such as @xmath27 , then the quantum cramer - rao bound @xcite indicates that the optimal estimation uncertainty would scale more favorably as @xmath28 @xcite .",
    "unfortunately , metrological coupling hamiltonians are rarely up to us they come from nature , like the zeeman interaction suggesting that one is stuck with a given uncertainty scaling without changing the fundamental structure of eq .",
    "( [ equation::hlarmor ] ) .",
    "furthermore , it was shown in ref .",
    "@xcite that the addition of an auxiliary parameter - independent hamiltonian @xmath29 such that @xmath30 does not change the scaling of the parameter uncertainty for any choice of @xmath29 .    at the same time",
    ", however , it should be well - appreciated that the dynamics one encounters in any actual physical setting are _ effective dynamics_. indeed , even the hyperfine zeeman hamiltonian eq .",
    "( [ equation::hlarmor ] ) is an effective description at some level .",
    "this begs the question as to whether one can utilize an auxiliary system to induce effective dynamics that improve the uncertainty scaling in quantum parameter estimation by going outside the structure of eq .",
    "( [ equation::haux ] ) .",
    "the purpose of this paper is to provide some direct evidence that doing so is possible .",
    "we study effective nonlinear couplings generated by double - passing an optical field through an atomic sample ( q.v . figure [ figure::schematic ] ) @xcite .",
    "continuous measurement of the scattered field then allows for the estimation of @xmath31 and by extension , the magnetic field .",
    "building on the quantum stochastic calculus approach in @xcite , we derive the quantum filtering equations for estimating the state of the atomic sample . although the effective dynamics are no longer described by a hamiltonian , we perform numerical calculations of the quantum fisher information to obtain a theoretical lower bound on the uncertainty scaling of an optimal magnetic field estimator @xcite .",
    "our simulations suggest that for certain parameter regimes , the double - pass system s sensitivity to magnetic fields scales better than that of a comparable single - pass system and what would be computed by applying the methods of ref .",
    "@xcite to eq .",
    "( [ equation::haux ] ) .",
    "we also conduct direct simulations of magnetic field estimation for our system using a general nonlinear parameter estimator , called a quantum particle filter @xcite , as further evidence for the improved uncertainty scaling provided by our proposed magnetometer .",
    "unfortunately our results are somewhat muted by the fact that we have , despite our best efforts , not yet found a parameter estimator whose uncertainty scaling can be shown analytically to outperform the conventional heisenberg limit .",
    "in particular , we show that improved scaling is not achieved by a quantum kalman filter @xcite , as such a filter is only suitable for estimating magnetic fields in the linear small - angle regime and where the state is gaussian and the dynamics are well approximated by a low order holstein - primakoff expansion @xcite .",
    "although kalman filters have had success in describing the single - pass system @xcite , simulations suggest the gaussian and small - angle approximations break down precisely when exact simulations of the double - pass system show improved sensitivity . for pedagogical purposes , we detail the derivation of such linear - gaussian filters using the method of projection filtering @xcite .",
    "doing so allows us to observe directly the limitations that arise when imposing the small - angle and gaussian assumptions , and it also provides a framework for the future development of more sophisticated filters . as a consequence ,",
    "our analysis here is restricted to values of the total atomic angular momentum @xmath32 that is small compared to experimentally relevant values .",
    "it remains an important problem to develop nonlinear parameter estimation methods suitable for implementation in an actual laboratory setting .",
    "the remainder of the paper is organized as follows . in section [ sec : continuous_measurement_of_double_pass_system ] , we detail the magnetometer setup and its corresponding quantum stochastic description .",
    "we also present the quantum filtering equation which describes continuous measurement of the double - passed atomic sample . using this model , we present a numerical analysis of the quantum cramr - rao bound in section [ section : cr ] ) and observe an improved uncertainty scaling relative to the shotnoise and heisenberg scalings . in section [ sec : magnetic_field_estimators ]",
    ", we use the double - pass quantum filter to develop quantum particle filters and quantum kalman filters suitable for estimating an unknown magnetic field . in section",
    "[ sec : simulations ] , we present simulations of the particle filter magnetic field estimator and discuss the evidence for improved magnetic field sensitivity in the double - pass system .",
    "we conclude in section [ sec : conclusion ] .    ]",
    "consider the schematic in fig .",
    "[ figure::schematic ] .",
    "the objective of this apparatus is to estimate the strength of a magnetic field oriented along the laboratory @xmath4-axis by observing the effect of that field on the spin state of the atomic sample . like most atomic magnetometer configurations",
    ", our procedure relies upon larmor precession and uses a far - detuned laser probe to observe the spin angular momentum of the atomic sample . unlike conventional atomic magnetometer configurations ,",
    "however , the probe laser is routed in such a way that it passes through the atomic sample twice prior to detection @xcite .",
    "qualitatively , the magnetometer operates as follows .",
    "the incoming probe field propagates initially along the atomic @xmath13-axis and is linearly polarized . as a result of the atomic polarizability of the atoms , the probe laser polarization acquires a faraday rotation proportional to the @xmath13-component of the collective atomic spin .",
    "two folding mirrors are then used to direct the forward scattered probe field to pass through the atomic sample a second time , now propagating along the atomic @xmath4-axis . prior to its second interaction with the atoms ,",
    "polarization optics convert the initial faraday rotation into ellipticity .",
    "thus on the second pass , the atoms perceive the optical helicity as a fictitious @xmath4-axis magnetic field acting in addition to the real field @xmath1 , providing a positive feedback effect modulated by the strength of @xmath1 .",
    "that is , the total larmor precession of the spins is enhanced by an amount which depends on the true strength of @xmath1 .",
    "the twice forward - scattered optical field is then measured in such a way that is sensitive only to the faraday rotation induced by the first pass atom - field interaction .      when the collective spin angular momentum of a multilevel atomic system interacts dispersively with a traveling wave laser field with wavevector @xmath33 , the atomic spin couples to the two polarization modes of the electromagnetic field transverse to @xmath33 .",
    "these polarization modes can can be viewed as a schwinger - bose field that when quantized in terms of a plane - wave mode decomposition yields the familiar stokes operators : @xmath34 here , we have expressed the stokes operators in terms of the schrdinger - picture field annihilation operators , @xmath35 and @xmath36 , for the plane - wave modes with frequency @xmath37 and linear polarization along the x- and y - axes , respectively , as well as their corresponding transformations into the spherical polarization basis .    in developing a physical model for the atom - field interaction in fig .",
    "[ figure::schematic ] , it is convenient to transform from a plane - wave mode decomposition of the electromagetic field to operators that are labeled by time . towards this end , we define the time - domain schwinger boson annihilation operator as the operator distribution @xmath38 where @xmath39 is a form factor .",
    "this definition permits us to express the stokes operators as @xmath40 which should be reminiscent of quadrature operators and also places the field operators in a form that is directly in line with the standard nomenclature adopted in the field of quantum stochastic calculus .    with a suitable orientation of the polarization optics ( @xmath41 and @xmath42 ) in fig .",
    "[ figure::schematic ] , the interaction hamiltonians for each pass of the probe light through the sample are then @xmath43 respectively , where the coupling strengths @xmath44 arise from the atomic - polarizibility level structure for the particular atoms being used @xcite . note that in developing these hamiltonians , which are of the standard atomic polarizability form , it was assumed the laser frequency @xmath45 is far detuned from any atomic resonance so that rank - two spherical tensor interactions can be neglected @xcite .",
    "in practice , the validity of such an assumption can depend heavily on the choice of atomic level structure and experimental parameters such as the intensity and detuning of the probe laser field .",
    "in addition to specifying the hamiltonians for the two atom - field interactions , it is also necessary to stipulate the measurement to be performed on the probe laser .",
    "since we expect that the amount of larmor precession ( possibly augmented by the addition of the double - passed probe field ) will cary information about the magnetic field strength @xmath1 , we must choose the measured field operator @xmath46 appropriately .",
    "since the magnetic field drives rotations about the atomic @xmath4-axis , it is the @xmath13-component of the atomic spin that indicate such a rotation . from the form of the first - pass interaction hamiltonian @xmath47",
    ", we see that the @xmath13-component of the atomic spin couples to dynamics generated by the field operator @xmath48 .",
    "the affect of such a coupling is then observed by measuring the orthogonal quadrature , indicating that the appropriate polarization measurement should be @xmath49 .      analyzing the two individual interactions @xmath50 and @xmath51 is a well studied problem in continuous measurement theory as a weak - coupling limit @xcite .",
    "heuristically , we are interested in the long time cumulative effects of the fast field dynamics relative to the slow atomic dynamics .",
    "much like the classical central limit theorem , the above references show that the cumulative effect of the field converges to a white noise process , so that the overall interaction - picture evolution of the joint atom - field system is well - described by the following quantum stochastic differential equation ( qsde ) propagators @xmath52 as discussed in @xcite , the rates @xmath53 and @xmath54 are evaluated in terms of the original coupling strengths and form factor at the drive laser frequency @xmath45 , @xmath55 is an arbitrary atomic hamiltonian and @xmath56 and @xmath57 are delta - correlated noise operators derived from the quantum brownian motion @xmath58 the noise terms satisfy the quantum it rules : @xmath59 and @xmath60 , and can be viewed heuristically as a consequence of vacuum fluctuations in the probe field .",
    "note that these are field operators and are defined so as to commute with all operators @xmath61 for @xmath62 .    to obtain a single weak - coupling limit for the double - pass interaction ,",
    "we combine the separate equations of motion for the two propagators into a single weak - couping limit as follows .",
    "first , write the two single - pass evolutions in terms of the generators of the dynamics @xmath63 and then expand the differential @xmath64 of the combined propagator @xmath65 such that the combined propagator @xmath66 then satisfies @xmath67 after evaluating the combined evolution for the propagators in eqs .",
    "( [ equation::du1 ] ) and ( [ equation::du2 ] ) in light of the quantum it rules , we find that the single weak - coupling limit propagator satisfies @xmath68\\hat{u}_t .",
    "\\end{gathered}\\ ] ] observe that as a result of the manner in which the combined weak - coupling limit was taken , the hamiltonian term has the property that rates which appear in it differ by a factor of two from those that would be expected from a single weak - coupling limit .",
    "this factor of two is essentially the rescaling of time units that arises from aggregating two sequential weak - coupling limits as a single differential process . to retain consistency with the original definition of the frequencies that appear in the parameter - coupling hamiltonian ,",
    "it is essential to rescale time units such that frequencies in the parameter - coupling hamiltonian are as expected . doing so is accomplished by reversing the effective @xmath69 transformation that occurred in the derivation , and thus dividing all rates by two to give @xmath70\\hat{u}_t\\end{gathered}\\ ] ] where @xmath71 and @xmath72 .",
    "we note that this final result agrees with the propagator obtained by sarma  et .",
    "al @xcite who also derived the quantum stochastic propagator of this system in order to characterize the generation of polarization and spin squeezing as suggested by sherson and mlmer @xcite and muschik et .",
    "al @xcite .",
    "continuous polarimetry measurement of the transmitted probe field is well described by a quantum stochastic calculus model @xcite which in turn allows for statistical inference or quantum filtering of the state of the atomic sample @xcite .",
    "we now derive the quantum filtering equation corresponding to the propagator in eq .",
    "( [ eq : double_pass_prop ] ) and continuous observation of the forward - scattered probe polarization .",
    "our derivation follows the general approach developed in section 4 of ref .",
    "@xcite . in this condensed presentation",
    ", we gloss over some of the technical details that one would consider in a completely rigorous derivation of a quantum filter .",
    "in particular , we do not demonstrate that our result is optimal , nor even delve into the details of what optimal means in this context .",
    "suffice it to say , the results hold up under more rigorous mathematical scrutiny , and the interested reader is encouraged to consult refs .",
    "@xcite for a more thorough discussion of these details .",
    "readers who are familiar with mathematical filtering theory will miss little by only skimming the derivation as it is presented here .",
    "the task of the quantum filter is to construct a best - estimate of atomic observables conditioned on continuous observation of the transmitted probe field .",
    "our first step is one of convenience  we rewrite the double - pass propagator of eq .",
    "( [ eq : double_pass_prop ] ) in the general form @xcite @xmath73\\hat{u}_t , \\ ] ] identifying @xmath74 and @xmath75 .",
    "then , the heisenberg - picture evolution of any atomic observable @xmath76 is given by the so - called quantum flow @xmath77    applying the it product rule ( discussed in appendix [ app : product_rule ] ) twice and noting the schrdinger picture operator satisfies @xmath78 , we find @xmath79)d{{\\hat{s}_t}}^{\\dag }                         + j_t([\\hat{l}^{\\dag},\\hat{x}])d{{\\hat{s}_t}}+ j_t(\\mathcal{l}(\\hat{x}))dt , \\nonumber\\end{aligned}\\ ] ] where we have defined the familiar lindblad generator @xmath80 + \\hat{l}^{\\dag}\\hat{x}\\hat{l }                           - \\frac{1}{2}(\\hat{l}^{\\dag}\\hat{l}\\hat{x }                                        + \\hat{x}\\hat{l}^{\\dag}\\hat{l } ) .\\ ] ] similarly , the observation process corresponding to polarimetric detection of the @xmath4-component of the vector stokes operator is given by @xmath81 two applications of the it product rule , which generate seven initial it products , gives its time evolution as @xmath82    in the language of classical control theory , eqs .",
    "( [ eq : app : dynamics ] ) and ( [ eq : app : observations ] ) are a system / observation pair .",
    "we see that the observations process carries information about the state of the system , @xmath83 , albeit corrupted by the quantum white noise term @xmath84 . moreover , as seen in eq .",
    "( [ eq : app : dynamics ] ) , the system itself is also driven by the quantum white noises .",
    "the quantum filter is tasked with picking out the relevant information from the observations and combining it with the model of the dynamics in order to estimate system observables .",
    "mathematically , the filter is given by the conditional expectation @xmath85 = \\mathbbm{e}[j_t(\\hat{x } ) | z_{(0,t)}],\\ ] ] where @xmath86 is the entire measurement record up to time @xmath16 .",
    "intuitively , we expect that the filter will be some function of the measurement process on which we are conditioning .",
    "this statement can be made more mathematically rigorous by showing that the conditional expectation in eq .",
    "( [ equation::filterce ] ) is adapted to the measurement process .",
    "furthermore , it is possible to derive a recursive form for the filter , in which only the most recent measurement increment is needed to update our estimate , and the dynamical equation for the filter can be written as @xmath87 = k_t(\\hat{x})dt + m_t(\\hat{x } ) dz_t , \\ ] ] where @xmath88 and @xmath89 are yet to be determined functions and the form is the most general we could consider , given that we only have access to the measurements . in order to find the forms of these functions , we can utilize the property of conditional expectation @xmath90      = \\mathbbm{e}[\\hat{y}\\hat{x } ] , \\ ] ] which is true for any @xmath91 that is a function of the measurement process .",
    "one way of enforcing eq .",
    "( [ eqn : cet ] ) is by ensuring that the following holds : @xmath92 e^{\\int_0^t g(s)dz_s}\\right ] = \\mathbbm{e}\\left[j_t(\\hat{x})e^{\\int_0^t g(s)dz_s}\\right],\\ ] ] since by taking linear combinations and appropriate derivatives of either side , any ( analytic ) function @xmath91 of the measurement current can be generated via an appropriate choice of @xmath93 . to simplify the algebraic manipulations , we multiply both sides by the deterministic integrating factor @xmath94 and identify our `` generating function '' as @xmath95 to calculate the stochastic differential equation for @xmath96 , we find it useful to set @xmath97 , so that @xmath98 . using the chain rule and expanding to second order in differentials , we have @xmath99 where we have used the fact that @xmath100 .",
    "since the individual white noise terms , @xmath101 , are zero in expectation , we can formally take the time derivative of either side of eq .",
    "( [ eq : app : filter_equality ] ) as long as we use the it product rule of eq .",
    "( [ eq : app : ito_product ] ) prior to taking the expectation . doing so , we find @xmath102 & = &   \\mathbbm{e}\\left[e_t^g\\left(k_t(\\hat{x } ) + j_t(l + l^{\\dag})m_t(\\hat{x})\\right)\\right .",
    "\\label{eq : app : pitderiv } \\\\      & & \\left .",
    "+ g(t)e_t^g\\left(m_t(\\hat{x } ) + j_t(l+l^{\\dag})\\pi_t[\\hat{x}]\\right)\\right ] \\nonumber \\\\      \\frac{d}{dt}\\mathbbm{e}[e_t^gj_t(\\hat{x } ) ] & = &       \\mathbbm{e}\\left [ e_t^g j_t(\\mathcal{l}[\\hat{x } ] ) \\right .",
    "\\label{eq : app : jtderiv } \\\\       & & \\left .             \\quad\\quad + g(t)e_t^gj_t(\\hat{l}^{\\dag}\\hat{x } + \\hat{x}\\hat{l})\\right ] \\nonumber\\end{aligned}\\ ] ] note that in reaching the above form of eq .",
    "( [ eq : app : jtderiv ] ) , we made use of the identities @xmath103 which are readily verified using the definition of @xmath104 .    to obtain the quantum filtering equation , we equate like terms in eqs .",
    "( [ eq : app : pitderiv ] ) and ( [ eq : app : jtderiv ] ) to enforce eq .",
    "( [ eq : app : filter_equality ] ) , and to ensure that @xmath105 and @xmath106 remain functions of the measurement record , we replace @xmath107 $ ] with @xmath108 $ ] , as this is just eq .",
    "( [ eq : app : filter_equality ] ) with @xmath109 . after a little rearranging ,",
    "we arrive at the _ quantum filtering equation _",
    "@xmath110   & = & \\pi_t[\\mathcal{l}[\\hat{x}]]dt   \\\\      & & + \\left(\\pi_t[\\hat{l}^{\\dag}\\hat{x } + \\hat{x}\\hat{l } ]      - \\pi_t[\\hat{l}^{\\dag } + \\hat{l}]\\pi_t[\\hat{x}]\\right ) \\nonumber \\\\   & &    \\times \\left(dz_t - \\pi_t[\\hat{l } + \\hat{l}^{\\dag } ] dt\\right ) \\nonumber\\end{aligned}\\ ] ]    oftentimes , and particularly in the traditional quantum optics setting , one works with the so - called adjoint form for the filter , which gives a dynamical equation for a density matrix @xmath111 that satisfies @xmath112 = { \\operatorname{tr}\\bigl[\\hat{x}\\rho_t\\bigr]}$ ] .",
    "this is easily determined from eq .",
    "( [ eq : app : quantum_filter_eq ] ) . plugging in the specific @xmath113 and @xmath55 for our double - pass system undergoing larmor precession",
    ", we find the _",
    "double - pass quantum filter _ @xmath114dt + i\\sqrt{km}[{\\hat{f}_{\\mathrm{y}}},\\{{\\hat{f}_{\\mathrm{z}}},\\rho_t\\}]dt \\nonumber \\\\      & &     + m \\mathcal{d}[{\\hat{f}_{\\mathrm{z}}}]\\rho_t dt                + k\\mathcal{d}[{\\hat{f}_{\\mathrm{y}}}]\\rho_t dt \\label{eq : adjoint_quantum_filter } \\\\           & &               + \\left(\\sqrt{m}\\mathcal{m}[{\\hat{f}_{\\mathrm{z}}}]\\rho_t                + i\\sqrt{k}[{\\hat{f}_{\\mathrm{y}}},\\rho_t]\\right)dw_t \\nonumber\\end{aligned}\\ ] ] where the innovations process @xmath115}dt\\ ] ] is a wiener process , i.e. @xmath116 = 0 , dw_t^2 = dt$ ] .",
    "the various superoperators are defined as @xmath117\\rho_t & = { \\hat{f}_{k}}\\rho_t{\\hat{f}_{k}}^{\\dag } - \\frac{1}{2}{\\hat{f}_{k}}^{\\dag}{\\hat{f}_{k}}\\rho_t - \\frac{1}{2}\\rho_t{\\hat{f}_{k}}^{\\dag}{\\hat{f}_{k}}\\\\      \\mathcal{m}[{\\hat{f}_{\\mathrm{z}}}]\\rho_t & = { \\hat{f}_{\\mathrm{z}}}\\rho_t + \\rho_t{\\hat{f}_{\\mathrm{z}}}- 2{\\operatorname{tr}\\bigl[{\\hat{f}_{\\mathrm{z}}}\\rho_t\\bigr]}\\rho_t\\\\      \\{{\\hat{f}_{\\mathrm{z}}},\\rho_t\\ } & = { \\hat{f}_{\\mathrm{z}}}\\rho_t + \\rho_t{\\hat{f}_{\\mathrm{z}}}\\end{aligned}\\ ] ] in looking at the structure of the filter , we see a deterministic term which evolves the current state estimate via the standard open system evolution one would expect for the system .",
    "the stochastic term performs the conditioning and is weighted by the innovations process , which captures how much new information the latest measurements provide .",
    "one other form which is useful when the quantum state remains pure is the stochastic schrdinger equation ( sse ) .",
    "as developed in appendix [ app : sse ] , the sse for the double - pass quantum filter is @xmath118",
    "in order to characterize the performance of the magnetometer , we consider quantum information theoretic bounds on the units - corrected mean - square deviation of the magnetic field estimate @xmath3 of the true magnetic field @xmath1 @xcite , given in eq .",
    "( [ equation::crerror ] ) .",
    "the quantum cramr - rao bound @xcite states that the deviation of _ any _ estimator is constrained by @xmath119 } , \\ ] ] where the quantum fisher information @xmath120 is the expectation of the square of the symmetric logarithmic derivative operator , defined implicitly as @xmath121 for pure states , @xmath122 , so that @xmath123 which indicates @xmath124 in this form , we see that the lower bound is related to the sensitivity of the evolved state to the magnetic field parameter",
    ". that is , any estimator s performance is constrained by how well the dynamics transform differences in the value of @xmath1 into differences in hilbert space .    as discussed by boixo et .",
    "al in @xcite , for hamiltonian evolution , the quantum cramr - rao bound may be expressed in terms of the operator semi - norm , which is the difference between the largest and smallest ( non - degenerate ) eigenvalues of the probe hamiltonian .",
    "for the magnetic dipole hamiltonian in eq .",
    "( [ equation::hlarmor ] ) , this bound is simply the heisenberg limit in eq .",
    "( [ equation::deltabhl ] ) .",
    "more generally , the authors show that a probe hamiltonian which involves @xmath26-body operators gives rise to an uncertainty scaling of @xmath125 .",
    "they further argue that no ancillary quantum systems or auxiliary hamiltonians contribute to this bound ; it is determined solely by the hamiltonian that directly involves the parameter of interest .",
    "such analysis suggests the double - pass quantum system , whose only direct magnetic field coupling is in the magnetic dipole hamiltonian , should show no more sensitivity than a single pass system .",
    "there are several reasons why we believe there is more to the story .",
    "firstly , the unitary evolution of the joint atom - field system in eq .",
    "( [ eq : app : propagator ] ) involves an auxiliary system of infinite dimension .",
    "as such , it is not clear that the arguments leading to the operator semi - norm are valid , in particular due to the fact that the white noise terms @xmath126 are singular .",
    "additionally , the double - pass limit is a markov one , in which the interaction the light field mediates between atoms is essentially instantaneous relative to other time - scales in the problem .",
    "the effective interaction is therefore fundamentally different than one in which measurements of a finite dimensional ancilla system are used to modulate the evolution of the probe atoms .",
    "thus the conditioned system , given in terms of the quantum filter of eq .",
    "( [ eq : app : quantum_filter_eq ] ) or ( [ eq : double_pass_sse ] ) , does not correspond to unitary dynamics .",
    "indeed , looking at eq .",
    "( [ eq : double_pass_sse ] ) , we see that the local generator of dynamics is _ path - dependent _ , given in terms of the expectation of @xmath31 .",
    "therefore , as the magnetic field directly impacts the state through the magnetic dipole term , it also non - trivially modulates future dynamics through a state - dependent generator .",
    "unfortunately , it is not clear how to fold the quantum stochastic or quantum filtered dynamics analytically into the semi - norm bound considered in @xcite . nonetheless , the quantum cramr - rao bound in eq .",
    "( [ eq : cramer_rao ] ) is excellent fodder for computer simulation . by numerically integrating the stochastic schrdinger form of the quantum filter in eq .",
    "( [ eq : double_pass_sse ] ) , a finite difference approximation of @xmath127 may be evaluated for different collective spin sizes @xmath32 .",
    "that is , for a given choice of @xmath32 , a finite difference approximation of the quantum fisher information near @xmath128 can be constructed by co - evolving three trajectories , @xmath129 , @xmath130 , and @xmath131 ( seeded by the same noise realization ) , and calculating @xmath132}.                  \\label{eqn : cr_fd}\\ ] ] the expectation value is then evaluated numerically by averaging over a statistical ensemble of such measurement _ trajectories . _",
    "figure [ fig : cramer_rao ] shows the results of such simulations of the quantum fisher information as a function of the spin size @xmath32 and different relative values of the coupling strengths @xmath133 and @xmath134 . for convenience ,",
    "all rates are taken to be unitless , defined in units of an arbitrary frequency @xmath135 ( which is then set to @xmath136 in the actual simulation ) .",
    "for all cases described here , the quantum filter in eq .",
    "( [ eq : double_pass_sse ] ) was integrated from an initially @xmath12-polarized spin coherent state using a second - order predictor - corrector stochastic integrator @xcite with a step size @xmath137 until a time @xmath138 .",
    "the density operators in eq .",
    "( [ eqn : cr_fd ] ) were constructed as @xmath139 for the state of the system at time @xmath140 evolved under the magnetic field with value @xmath1 .",
    "the finite - difference parameter was chosen to be @xmath141 and @xmath142 .",
    "due to the stochastic nature of the evolution , the finite difference approximation was averaged over 100 trajectories , with each member of the three density matrices coevolved using the same white noise realizations .",
    "the plots in fig .",
    "[ fig : cramer_rao ] correspond to the lower bound determined by eq .",
    "( [ eq : cramer_rao ] ) using the finite difference approximation and finite averaging approximation just described .",
    "the error bars correspond to the standard deviation of the lower bound for the ensemble of 100 trajectories .",
    "a similar finite difference approximation around the mean value @xmath143 was conducted and showed the same behavior as that described here for a mean value of @xmath144 .",
    "figure [ fig : cramer_rao](a ) plots the estimator uncertainty lower bound as a function of @xmath32 for a double - pass system , with @xmath145 and @xmath146 , and an equivalent single - pass system with @xmath147 and @xmath148 . for these parameter values , the simulations show a clear improvement in the scaling of the uncertainty lower bound , even taking into account the increased fluctuations of the double - pass system . also shown",
    "are the analytic scalings for shot - noise uncertainty eq .",
    "( [ equation::deltabsn ] ) , heisenberg uncertainty eq .",
    "( [ equation::deltabhl ] ) ( with @xmath149 ) and the quantum cramr - rao bound for a hypothetical magnetic field coupling interaction @xmath150 .",
    "a least - squares fit to a power - law form suggest the single - pass system scales as @xmath151 , which is in good agreement with the heisenburg - limited scaling of @xmath152 .",
    "a power law fit for the double - pass system gives an exponent of @xmath153 , although its lower bound appears to have more complicated scaling .",
    "in fact , the behavior towards larger @xmath32 suggests that the double - pass system may show a super - polynomial uncertainty scaling .",
    "we note that there is a constant prefactor difference between our estimator simulations and the conventional heisenberg limit .",
    "this prefactor appears in the plot as a constant offset between the simulated single - pass bound and the @xmath154 heisenberg bound .",
    "there are two reasons why one might expect such an offset : ( 1 ) the heisenberg limit is computed from the cramr - rao inequality by optimizing over all initial states , including optimally squeezed states or `` cat '' superposition states which achieve the bound while our procedure begins from a spin coherent state which is then gradually entangled by the measurement process ; ( 2 ) a continuous measurement scenario based on the theory of open quantum systems can not be expressed in the form of a simple hamiltonian .    furthermore , our simulations reveal that the uncertainty scaling of the initially @xmath12-polarized spin coherent state depends sensitively on the particular choice of coupling strengths @xmath133 and @xmath134 , as seen in fig .",
    "[ fig : cramer_rao](b ) .",
    "this figure considers the case of equal coupling strengths , @xmath155 , and we see that the double - pass system quickly loses its advantage after @xmath156 .",
    "this can be understood in light of the quantum stochastic model of the previous subsection . in considering the general stochastic propagator of eq .",
    "( [ eq : app : propagator ] ) , we identified the coupling operator @xmath74 , which if @xmath157 , is essentially the angular momentum lowering operator along @xmath12@xmath158 . if @xmath159 , a continuous measurement of this operator very quickly moves the @xmath160-polarized initial state onto the @xmath161-polarized state , which is an attractive fixed point of @xmath158 .",
    "once this state is reached , the dynamics become relatively insensitive to the magnetic field value and result in a poor uncertainty lower bound . on the other hand ,",
    "if @xmath162 are much smaller than @xmath163 , the positive feedback from the @xmath164 term is washed out by larmor precession .",
    "given that we are interested in detection limits , i.e. @xmath165 , we do not focus on the regime where larmor precession dominates .",
    "regardless , figure [ fig : cramer_rao](b ) suggests that for a given @xmath133 and @xmath166 , there will be some value of @xmath32 after which the lowering operator dynamics dominate , rendering the double - pass system relatively useless for estimating @xmath1 .",
    "but by manipulating @xmath133 and @xmath134 relative to @xmath32 , the extra dynamics allow for an improved sensitivity to the magnetic field .",
    "indeed , fig .",
    "[ fig : cramer_rao](a ) uses a very small second - pass strength @xmath134 , relative to the first - pass strength @xmath133 , so that just the right amount of positive feedback enters via the @xmath164 term in the measured operator .",
    "the positive feedback can be viewed as increasing the magnetic fields effect on the rate of precession .    in short , figure",
    "[ fig : cramer_rao](a ) suggests that there are some parameter values , appropriate for some range of @xmath32 , which show an estimator uncertainty lower bound scaling below the heisenberg limit .",
    "it is important to note that computational constraints limited simulations to @xmath167 , which is well below the collective spin size one might expect for @xmath168 atoms .",
    "however , we believe the scalings are nonetheless suggestive of quite general behavior for this system .",
    "although in practice , it seems that one would need to fine tune the coupling strengths @xmath133 and @xmath134 in order to be in a regime with such scaling . it may be that such coupling strengths are inaccessible in an experimental setting . while this is an important consideration ,",
    "there is a more pressing theoretical question  does a practical estimator exist which saturates the quantum cramr - rao bound ?",
    "we summarize our search for such an estimator in the following section .",
    "while studying the properties of lower bounds on estimator performance is important for developing an understanding of the capabilities of a given parameter coupling scheme , any actual procedure for implementing quantum parameter estimation must also develop a constructive procedure for doing the estimation .",
    "in this section , we consider two methods for estimating the strength of the magnetic field @xmath1 based on the stochastic measurement record @xmath86 . in both cases , we extend the quantum filters developed in the previous section to account for our uncertainty in @xmath1 , which in turn results in new filters capable of estimating @xmath1 . we note that our approach is similar in spirit to refs .",
    "@xcite .",
    "the technique of quantum particle filtering , as developed in ref .",
    "@xcite , leverages the fact that the quantum filtering equations already provide a means for estimating the _ state _ of a quantum system conditioned on the measurement record .",
    "if we place the magnetic field parameter on the same footing as the quantum state , we can simply apply the quantum filtering results we already derived .",
    "indeed , by embedding the magnetic field parameter as a diagonal operator in an auxiliary hilbert space , the quantum filter _ still _ gives the best estimate of _ both _ system and auxiliary space operators .",
    "we accomplish this by promoting the magnetic field parameter to the diagonal operator @xmath169 where @xmath170 is the new auxiliary hilbert space with basis states satisfying @xmath171 and @xmath172 .",
    "all atomic operators and states , which are associated with the atomic hilbert space @xmath173 , act as the identity on @xmath170 , e.g. @xmath174 .",
    "the only operator which joins the two spaces is the magnetic dipole hamiltonian , which is now given by @xmath175 the derivation of the quantum filtering equation is essentially unchanged , provided one replaces atomic operators with the appropriate forms for the joint space @xmath176 .    for parameter estimation , the adjoint form is the more convenient version of the quantum filter . since @xmath177 corresponds to a classical parameter , we require the marginal density matrix @xmath178 $ ] be diagonal in the basis of @xmath177 , so that it corresponds to a classical probability distribution .",
    "this suggests we write the total conditional density matrix in the ensemble form @xmath179 where @xmath180 is precisely the conditional probability density for @xmath1 .",
    "while one could attempt to update this state via the quantum filter , doing so is entirely impractical , as one can not represent an arbitrary distribution for @xmath181 with finite resources .",
    "instead , one approximates the distribution with a weighted set of point masses or _ particles _ : @xmath182 the approximation can be made arbitrarily accurate in the limit of @xmath183 .",
    "plugging this distribution into the ensemble density matrix form of eq .",
    "[ eq : ensemble_continuous_form ] gives @xmath184 each of the @xmath0 triples @xmath185 is called a _",
    "quantum particle_. intuitively , the particle filter works by discretizing the parameter space and then evolving an ensemble of quantum systems according to the exact dynamics for each parameter value .",
    "the filtering equations below perform bayesian inference on this ensemble , updating the relative probabilities of particular parameter values given the measurement record .",
    "the quantum particle filter for the double - pass system with _",
    "@xmath1 is found by plugging the discretized ensemble @xmath186 into the extended double - pass filter . after a little manipulation",
    ", one finds    [ eq : ensemble_filtering_eqs ] @xmath187 } \\nonumber \\\\              & &                  - \\sum_{j=1}^n p_t^{(j)}{\\operatorname{tr}\\bigl[{\\hat{f}_{\\mathrm{z}}}\\rho_t^{(b_j)}\\bigr]})p_t^{(i)}dw_t                     \\\\",
    "d\\rho_t^{(b_i ) } & = & i\\gamma b_i[{\\hat{f}_{\\mathrm{y}}},\\rho_t^{(b_i)}]dt               + \\sqrt{km}[{\\hat{f}_{\\mathrm{y}}},\\{{\\hat{f}_{\\mathrm{z}}},\\rho_t^{(b_i)}\\}]dt \\nonumber\\\\              & & + m \\mathcal{d}[{\\hat{f}_{\\mathrm{z}}}]\\rho_t^{(b_i ) } dt                        + k\\mathcal{d}[{\\hat{f}_{\\mathrm{z}}}]\\rho_t^{(b_i ) } dt \\\\                       & & + \\left(\\sqrt{m}\\mathcal{m}[{\\hat{f}_{\\mathrm{z}}}]\\rho_t^{(b_i ) }                        + i\\sqrt{k}[{\\hat{f}_{\\mathrm{y}}},\\rho_t^{(b_i)}]\\right)dw_t \\nonumber \\\\              dw_t & = & dz_t                   - 2\\sqrt{m}\\sum_{i=1}^np_t^{(i ) }   { \\operatorname{tr}\\bigl[{\\hat{f}_{\\mathrm{z}}}\\rho_t^{(b_i)}\\bigr]}dt      \\end{aligned}\\ ] ]    where the prior distribution @xmath188 is used to determine the initial parameter weights , @xmath189 , and values , @xmath190 .",
    "all initial quantum states , @xmath191 , are taken to be the spin coherent state pointing along @xmath160 .",
    "looking at the structure of this filter , we see that each particle s quantum state @xmath192 evolves under the standard quantum filter we would use if we knew @xmath193 .",
    "the innovations process @xmath194 serves to couple the different particles , since it depends on the ensemble average of the measurement observable .",
    "an estimate of the magnetic field strength is then constructed from the approximate density in eq .",
    "( [ eq : approximate_density ] ) , either taking the most probable @xmath1 value , corresponding to the largest @xmath195 or calculating the expected value of @xmath177 @xmath196 for the latter estimate , the uncertainty is given by @xmath197    one important feature of particle filters which we will mention , but not utilize in this paper , is the potential for resampling",
    ". as presented , the initial particle ensemble @xmath198 fixes the possible values of @xmath190 at the outset . if there are no initial points near the true value of @xmath1 , the filter will by construction have difficulty finding this value .",
    "even if one of the particles is associated with the true value of @xmath1 , the filter still integrates the dynamics for a potentially large number of low weight particles which contribute little to the estimate .",
    "a way around this issue is to resample and create new particles during the course of integration , either drawing from the discrete distribution @xmath199 or using finer and finer regular grids to hone in on important regions of parameter space .",
    "but in both cases , it is not clear how to resample the associated quantum states @xmath192 in order to improve the estimate . rather than considering such options here , we refer the reader to @xcite for more discussion .    finally , we note that the computational resources required for particle filtering are demanding , generally requiring space and time which scale as @xmath200 , though we can get down to @xmath201 if the atomic state remains pure .",
    "moreover , the particle filter is biased for any finite number of particles , although the variance of estimates of random variables using @xmath199 converges as @xmath202 @xcite .",
    "although this will not prohibit us from exploring the magnetic field sensitivity scaling of systems with collective spins up to @xmath203 , using a large particle set is entirely impractical for real systems with @xmath32 orders of magnitude larger . for such systems ,",
    "we need a low - dimensional state representation whose size does not scale with @xmath32 , after which the particle filter becomes a more promising technique for parameter estimation .",
    "we explore low dimensional representations of the double - pass system in the following subsection .      rather than constructing a magnetic field estimator from the exact quantum dynamics",
    ", one could instead first focus on deriving an approximate filter for the atomic state , which is then a starting point for the magnetic field estimator .",
    "indeed , previous work in precision magnetometry via continuous measurement @xcite has taken this route by constructing a _ quantum kalman filter _ to describe the atomic dynamics .",
    "such a filter leverages the fact that for an initially spin polarized state of many atoms ( say along @xmath160 ) , a first order holstein - primakoff expansion @xcite linearizes the small - angle dynamics in terms of a gaussian state characterized by the means @xmath204 , \\pi_t[{\\hat{f}_{\\mathrm{y}}}]$ ] and the covariances @xmath205 . just as in classical filtering theory , the conditional state for a linear system with gaussian noise is itself described by a gaussian distribution and therefore only requires filtering equations for the means and a deterministic equation for the variances @xcite . for the case of magnetometry ,",
    "the number of these parameters is independent of the number of atoms in the atomic ensemble .",
    "we will also find that within this approximation , we can again embed @xmath1 as an unknown state parameter and find a corresponding kalman filter appropriate for estimating its value .",
    "however , applying the small - angle and gaussian approximations in the quantum case is usually done in an ad - hoc fashion , especially in light of the recent introduction of _ projection filtering _ into the quantum filtering setting @xcite . in this framework",
    ", one selects a convenient manifold of states whose parameterization reflects the approximations to enforce . at each point in this manifold ,",
    "the exact differential dynamics induced on these states is orthogonally projected back into the chosen family . for our purposes",
    ", this means projecting the filter in eq .",
    "( [ eq : double_pass_sse ] ) onto a manifold of gaussian spin states .",
    "although the resulting equations are not substantively different than those derived less carefully , we believe the potential application of projection filtering in deriving other approximate filters and master equations warrants the following exposition .      abstractly , projection filtering proceeds as follows .",
    "we assume we already have a dynamical equation , such as eq .",
    "( [ eq : double_pass_sse ] ) , for a given manifold of states , such as pure states . for convenience ,",
    "let these dynamics be represented as @xmath206 , \\ ] ] where @xmath207 is the generator of dynamics .",
    "now select the desired family of `` approximating '' states which are a submanifold of the exact states .",
    "we assume this family is parameterized by a finite number of parameters @xmath208 and we denote states in this family as @xmath209 . at every point in this manifold ,",
    "the tangent space is spanned by the tangent vectors @xmath210 loosely speaking , these tangent vectors",
    "tell us how differential changes in the parameters move us through the corresponding submanifold of @xmath209 states in the space of pure states .",
    "this is particularly useful , as the action of the generator @xmath211 $ ] does not necessarily result in a state within the family . but by projecting the dynamics onto the tangent space , we can find a filter , called the projection filter , which constrains evolution within the chosen submanifold .",
    "explicitly , this projection is written as @xmath212 \\nonumber \\\\          & = & \\sum_i \\frac{\\langle v_i ,              \\mathcal{n}[{\\lvert x_1,x_2,\\ldots , x_n \\rangle } ] \\rangle }                  { \\langle v_i , v_i \\rangle}v_i , \\label{eq : general_projection}\\end{aligned}\\ ] ] where in this pure state formulation , the inner product is the standard hilbert space inner product .",
    "for our double - pass magnetometer , we begin by introducing the two - parameter family of gaussian states @xmath213 where @xmath214 is the spin coherent state pointing along @xmath160 , @xmath215 is a spin squeezing operator @xcite with squeezing parameter @xmath216 and @xmath217 is a rotation about the @xmath4-axis by angle @xmath218 .",
    "intuitively , the squeezing along @xmath13 generated by @xmath215 corresponds to the squeezing induced by measuring @xmath31 .",
    "the rotation via @xmath217 then accounts for both the random evolution due to the measurement as well as any rotation induced by the magnetic field .",
    "the tangent vectors for these states are @xmath219    in calculating the normalization of these tangent vectors , we encounter terms such as @xmath220 more generally , almost all inner - products needed for the projection filter will be of the form @xmath221 here , @xmath222 and @xmath11 are polynomial functions of their arguments . since @xmath217 is a rotation , we can exactly evaluate @xmath223 where @xmath224 this leaves us with expectations of the form @xmath225 where @xmath226 will just be linear combinations of powers and products of @xmath227 .",
    "unfortunately , we can not evaluate this expectation for arbitrary @xmath216 .",
    "however , for small @xmath216 , the state which we are taking expectations with respect to is the `` squeezed vacuum '' in our preferred basis , e.g. it is the state @xmath214 pointing in the same direction , but with squeezed uncertainty in @xmath31 and increased uncertainty in @xmath228 .    for large @xmath32 , angular momentum expectations of such a state",
    "are extremely well described by the holstein - primakoff approximation to lowest order @xcite @xmath229 where @xmath230 , and @xmath231 are bosonic creation and annihilation operators .",
    "we then write our state as @xmath232 , which is the vacuum in the holstein - primakoff representation . under this approximation",
    ", we can use the relations @xmath233 to evaluate the expectation in eq .",
    "( [ eq : hp_expectations ] ) . in light of this approximation ,",
    "the tangent vector overlaps are readily shown to be @xmath234 where the last result indicates the tangent vectors are orthogonal as desired .      before performing orthogonal projection of the dynamics onto the tangent space",
    ", we must first convert the filtering equation from it to stratonovich form . as is discussed in ref .",
    "@xcite , the it chain rule is incompatible with the differential geometry picture of projecting onto the tangent space . fortunately , stratonovich stochastic integrals follow the standard chain rule and are thus amenable to projection filtering methods .",
    "following the derivation in appendix [ sec : app : ito_to_stratonovich ] , we find that the stratonovich sse is given by @xmath235                  -\\frac{\\sqrt{km}}{2}{\\hat{f}_{\\mathrm{x}}}\\right.\\\\               & \\left .",
    "+ 2i\\sqrt{km}{\\langle { \\hat{f}_{\\mathrm{z}}}\\rangle}_t{\\hat{f}_{\\mathrm{y}}}+ i\\sqrt{km } { \\langle { \\hat{f}_{\\mathrm{z}}}{\\hat{f}_{\\mathrm{y}}}\\rangle}_t                  \\right]{\\lvert \\psi \\rangle}_t dt\\\\           & + \\left ( \\sqrt{m}({\\hat{f}_{\\mathrm{z}}}- { \\langle { \\hat{f}_{\\mathrm{z}}}\\rangle}_t ) + i\\sqrt{k}{\\hat{f}_{\\mathrm{y}}}\\right){\\lvert \\psi \\rangle}_t \\circ dw_t ,      \\end{split}\\ ] ] where @xmath236 .    in order to find the projection filter , we compare the general projection formula in eq .",
    "( [ eq : general_projection ] ) to the general dynamical equation for states in our chosen family , given by @xmath237 using the orthogonality of the tangent vectors , the general forms for @xmath238 and @xmath239 are @xmath240 \\rangle}\\\\      d\\xi_t & = \\frac{1}{8f^2}{\\langle v_{\\xi_t } , d{\\lvert \\psi_t \\rangle}[\\xi_t,\\theta_t ] \\rangle } , \\end{aligned}\\ ] ] where @xmath241 $ ] is the evolution of @xmath242 under the stratonovich filter of eq .",
    "( [ eq : double_pass_sse_stratonovich ] ) .    as an example calculation using these methods ,",
    "consider projecting the dynamics generated by the magnetic field term .",
    "its contribution @xmath243 to the @xmath218 dynamics is given by @xmath244 similarly , the contribution to @xmath216 is @xmath245 chugging through the remaining terms in a similar fashion , we arrive at the full projection filter equations @xmath246 \\circ dw_t\\end{aligned}\\ ] ] and @xmath247 converting back to it form using eq .",
    "( [ app : eq : ito_to_stratonovich ] ) , we have    [ eq : projected_filter_ito ] @xmath248dt \\nonumber \\\\                        & & -\\left[\\sqrt{m}e^{-8f\\xi_t}\\cos{\\theta_t } + \\sqrt{k}\\right]dw_t    \\\\",
    "d\\xi_t & = & \\frac{m}{4}e^{-8f\\xi_t}\\cos^2{\\theta_t}dt ,       \\end{aligned}\\ ] ]    where the innovations are now in terms of the approximation of @xmath249 within the gaussian family : @xmath250      we see that the projected filter in eq .",
    "( [ eq : projected_filter_ito ] ) is actually more general than the filters usually derived for the magnetometry problem , which do not distinguish the gaussian and small - angle approximations .",
    "that is , the family of states in eq .",
    "( [ eq : gaussian_state_parameterization ] ) and the approximations considered in the above derivation only enforce the gaussian state assumption through the holstein - primakoff approximation .",
    "we can separately apply the small - angle approximation to recover an equation appropriate for the kalman filter . in this limit , the equation for @xmath216 completely decouples and has a closed form solution @xmath251 .\\ ] ] taking the small - angle approximation for @xmath218 and plugging in the explicit form of @xmath216 gives @xmath252dt\\\\                  - \\left[\\frac{\\sqrt{m}}{1 + 2fmt } + \\sqrt{k}\\right]dw_t , \\end{gathered}\\ ] ] which is linear in the remaining state parameter @xmath218 .    while we could consider the kalman filter for the quantum state alone , we can just as easily account for our uncertainty in @xmath1 at the same time .",
    "that is , if we now embed @xmath1 as a state variable , setting @xmath253^t$ ] , the dynamics can be written in a linear form as @xmath254 equations ( [ eq : linear_system ] ) and ( [ eq : linear_observations ] ) are precisely a classical linear system / observation pair , in which the same white noise process ( the innovations ) drives _ both _ the system and observation processes .",
    "the estimate @xmath255 $ ] admits a kalman filter solution @xcite , given by @xmath256 where @xmath257 is the covariance matrix @xmath258)(\\tilde{x } - \\mathbbm{e}[\\tilde{x}])^t]\\\\        & = \\begin{pmatrix }          \\delta \\tilde{\\theta}_t^2 & \\delta\\tilde{\\theta}_t\\tilde{b}_{kf}\\\\          \\delta\\tilde{\\theta}_t\\tilde{b}_{kf } & \\delta \\tilde{b}_{kf}^2        \\end{pmatrix}\\end{aligned}\\ ] ] and @xmath259 is the innovations constructed from the current @xmath218 estimate in the small - angle approximation .",
    "looking at the explicit system of equations for the variances , we have @xmath260 which are completely _ independent _ of the second - pass coupling strength @xmath134 .",
    "that is , within the small - angle and gaussian approximations , the double - pass system has no improvement in sensitivity and gives rise to the same @xmath152 uncertainty scaling found previously for single - pass systems @xcite .",
    "perhaps this is unsurprising , as we attempted to find a linear description of an essentially non - linear affect .",
    "indeed , the numeric simulations in the next section suggest the single - mode gaussian approximation breaks down just as the double - pass filter begins to show improved sensitivity to the magnetic field parameter .",
    "finally , we note that we have also derived a filtering equation which retains the next term in the holstein - primakoff expansion , but whose @xmath134 dependence nonetheless shows a negligible change relative to the lowest order expansion .",
    "given the absence of an analytic improvement in the sensitivity of the quantum kalman filter , we turn to numerical simulations of the quantum particle filter in order to gauge the potential of the double - pass system for magnetometry .",
    "first recall how the filter would be used in an actual experiment .",
    "continuous measurements of the atomic cloud larmor precessing under a particular , albeit unknown , magnetic field @xmath1 would give rise to the observations process @xmath86 .",
    "this would then be fed into a classical computer to propagate the quantum particle filtering equations given in ( [ eq : ensemble_filtering_eqs ] ) .",
    "the computer would then use the quantum particle set to provide the estimate @xmath261 and uncertainty @xmath262 .    in order to simulate such an experiment",
    ", we can generate the stochastic measurement record @xmath86 using the quantum filter for the double - pass system given in eq .",
    "( [ eq : double_pass_sse ] ) , evolved with a known magnetic field @xmath1 .",
    "since the system is driven by the white noise process @xmath194 , the filtering equations may be integrated by the same integrator previously used to approximate the quantum cramr - rao bound .",
    "the measurements generated by these trajectories are equivalent to what the quantum particle filter would receive in an experiment , which means they can then be fed into the same particle filtering code to simulate an estimate of @xmath1 . in order to compare performance ,",
    "we actually simulate two systems in parallel , one representing the double - pass system and the other , with @xmath263 , representing a single - pass system .",
    "both utilize the same noise realizations on an individual trajectory .    as is common when considering detection limits , we focus on the case of @xmath128 .",
    "although an unbiased estimator would assume no prior knowledge of the magnetic field value , such an approach is impractical for the particle filter , which would fail in approximating such large uncertainty with a finite number of particles . as such",
    ", we take the initial distribution of @xmath1 values for the quantum particle set to be gaussian @xmath264 with mean @xmath265 and variance @xmath266 , where we again set @xmath267 and again define all parameters in units of @xmath135 . for a set of @xmath0 particles ,",
    "the particle magnetic field values @xmath268 are drawn from the initial distribution , with weights @xmath269 .",
    "the initial quantum state for all particles is set to the spin - coherent state along @xmath160,i.e . @xmath214 .",
    "figure [ fig : particlefiltersimulations](a ) shows , with solid lines , the average particle filter uncertainty @xmath270 as a function of @xmath32 , averaged over 100 measurement realizations using @xmath271 particles in each run of the filter .",
    "the error bars represent the the deviation in the simulated uncertainties over the 100 runs . as was the case for the fisher information calculations ,",
    "we observe an improved sensitivity scaling for the double - pass system , albeit with increased fluctuations in the individual run uncertainty @xmath272 .",
    "power - law least - squares fits of the average give a single - pass uncertainty scaling @xmath273 and a double - pass scaling of @xmath274 which are consistent with the quantum cramr - rao scalings in figure [ fig : cramer_rao ] . also shown is the analytic single - pass uncertainty scaling given by numerical integration of the kalman covariance matrix via eq .",
    "( [ eq : kalmanvar ] ) .",
    "we see that this agrees very well with the single - pass particle filter scaling and since it is consistent with previous kalman filters used for magnetometry @xcite , suggests the double - pass scaling does indicate improved sensitivity .        of course",
    ", these statements are not without caveats .",
    "the dashed lines in the plot correspond to the numerically computed quantum cramr - rao bound , which is clearly below the estimates of all the filters .",
    "this might mean that the continuous - measurement which gives rise to the numerical bound via eq .",
    "( [ eq : app : quantum_filter_eq ] ) is simply not saturated by the corresponding estimator for that continuous - measurement .",
    "unfortunately , the above data took a week to generate on a quad - core workstation , indicating the technical challenges already present in simulating an @xmath275 quantum particle set for the depicted range of @xmath32 limits the quality of the statistics .",
    "as previously mentioned , the particle filter approximation is inherently biased , with the variance of estimates converging as @xmath202 .",
    "the inset in figure [ fig : particlefiltersimulations](a ) shows the sample estimator deviation @xmath276 , which is the deviation in the actual performance error of the particle filter on each individual run , i.e. @xmath277 where the true @xmath128 . in other words",
    ", @xmath272 is the uncertainty calculated for an individual trajectory from the particle distribution @xmath199 , which is averaged over many trajectories to get @xmath270 .",
    "however , an individual run of the particle filter also gives an estimate @xmath261 of the true magnetic field @xmath1 .",
    "since we know that the measurements were generated from a system evolved with @xmath128 , we can calculate the deviation in the actual estimates @xmath261 .",
    "if the particle filter were unbiased , we would expect this sample deviation to equal the average particle filter deviation , i.e. @xmath278 .",
    "instead , the sample deviation dwarfs the average estimator uncertainty , indicating that the particle filter bias dominates .",
    "we believe this is primarily a technical issue due to the dwindling contribution of initial particles to the final estimate .",
    "given that the potential particle magnetic field values @xmath268 are fixed at the outset , particles far from the true value will contribute only marginally to the final estimate .",
    "that is , for @xmath190 far from the true @xmath128 , @xmath279 will be relatively small .",
    "this behavior is well known in classical particle filtering @xcite and is characterized by the effective sample size @xmath280 figure [ fig : particlefiltersimulations](b ) shows the average effective particle number fraction @xmath281 and its deviation as a function of @xmath0 for the same trajectories used in part ( a ) of the figure . by the end of integration",
    ", we see that both single and double - pass systems have less than 100 of the initial 1000 particles significantly contributing to the estimate .",
    "the fact that the double - pass system shows a smaller effective particle number is consistent with the increased sample estimator deviation @xmath276 . in order to decrease the bias",
    ", one would need to include more particles or develop a resampling technique .",
    "nonetheless , we still believe the simulations depicted in figure [ fig : particlefiltersimulations](a ) suggest that the double - pass system shows in improved uncertainty scaling .",
    "numerical simulation also provides insight into how the gaussian state assumption of the kalman filter applies in the double - pass case .",
    "figure [ fig : splitting_example ] shows quantum states evolved under two different noise realizations with @xmath282 .",
    "both states were initially spin - polarized along @xmath160 and evolved until time @xmath138 under the full double - pass sse in eq .",
    "( [ eq : double_pass_sse ] ) . the q - function shown",
    "is defined as @xmath283 where the spin - coherent state @xmath284 is the @xmath285 eigenstate of the spin - operator @xmath286 .",
    "although one example shows a gaussian squeezed spin state , the other shows a state with a bimodal gaussian distribution , which we suspect is a consequence of the complicated nonlinear dynamics of eq .",
    "( [ eq : double_pass_sse]) the presence of operators that are nonlinear in the spin observables , such as @xmath287 , do not preserve gaussian states .",
    "therefore , a filter which confines the dynamics to the gaussian family in eq .  ( [ eq : gaussian_state_parameterization ] ) is only likely to remain valid for short time , and helps explain why the kalman filter fails to find a difference between the single and double - pass setup .",
    "these plots suggests a family of bimodal gaussian states might result in a useful projection filter ; we have been unable to find a parameterization of such a family which admits an analytic derivation of a projection filter .",
    "we have explored the use of double - pass continuous measurement for precision magnetometry .",
    "our primary result involves numerical simulations of the quantum cramr - rao bound which indicate that a double - pass system shows an improved magnetic field uncertainty scaling with atom number over a comparable single - pass system , albeit only for particular choices of coupling strengths relative to the collective spin size .",
    "this is in contrast to quantum information theoretic bounds which suggest that the heisenberg limit bounds the uncertainty scaling for both a single and double - pass system .",
    "clearly , future work aimed at reconciling these results is necessary , particularly deriving analytic quantum cramr - rao bounds for unbounded ancilla systems .",
    "however , at a heuristic level , we see that the double - pass provides a positive feedback effect which amplifies the amount of larmor precession due to the magnetic field .",
    "this of course also amplifies the initial spin - projection uncertainty , but the continuous measurement allows us to overcome this uncertainty by actually learning the state of the collective spin .",
    "it is this interplay between amplification and measurement - induced squeezing which requires a fine - tuning of parameter strengths in order to find an improved cramr - rao bound .",
    "we have also explored estimators intended to achieve the uncertainty scaling seen in numerical simulations .",
    "taking a brute force approach , quantum particle filters show evidence of the improved double - pass scaling , although the results suffer from limited statistics which can not be significantly improved with current computational power and methods .",
    "we are likewise limited to studying relatively small atomic ensemble sizes ( small collective spin sizes ) , though we expect the improved scaling to extend to larger ensembles .",
    "more practical quantum kalman filters show no improved sensitivity , which is consistent with an observed breakdown in the gaussian state assumption used to derive them .",
    "however , the general projecting filtering technique used in the kalman filter derivation provides an avenue for deriving more appropriate filters which might prove more tractable for practical magnetic field estimation .",
    "more generally ,",
    "we believe effective nonlinear interactions may prove an important tool in precision measurement .",
    "we thank rob cook , carl caves , anil shaji , steve flammia , sergio boixo and animesh datta for many useful disagreements and discussions .",
    "this work was supported by the nsf ( phy-0639994 ) and the afosr ( fa9550 - 06 - 01 - 0178 ) .",
    "when manipulating products of variables governed by stochastic differential equations , one must be careful to use the it product rule @xcite , which generalizes for the quantum case @xcite as follows .",
    "consider two operators governed by the quantum stochastic differential equations @xmath288 then the product @xmath289 is governed by @xmath290 where we have used the fundamental it products@xmath59 and @xmath60 .",
    "some find it useful to heuristically identify the white noise differentials @xmath291 as order @xmath292 , so that any consistent chain rule requires keeping terms to second order in differentials or equivalently , first order in @xmath293 .",
    "lacking any extra sources of decoherence , pure states remain pure under the dynamics described by the quantum filtering equation . as such ,",
    "it is often convenient for analysis and simulation to have a pure state description of the dynamics in terms of a _ stochastic schrdinger equation _ ( sse ) .",
    "although these have previously appeared in the literature , for completeness we briefly derive the sse for the general adjoint filter @xmath294dt + \\left(\\hat{l}\\rho_t\\hat{l}^{\\dag } - \\frac{1}{2 } \\hat{l}^{\\dag}\\hat{l}\\rho_t - \\frac{1}{2}\\rho_t\\hat{l}^{\\dag}\\hat{l}\\right)dt \\nonumber\\\\             & + \\left ( \\hat{l}\\rho_t + \\rho_t \\hat{l}^{\\dag }              - { \\operatorname{tr}\\bigl[(\\hat{l } + \\hat{l}^{\\dag})\\rho_t\\bigr]}\\rho_t\\right)dw_t .\\end{aligned}\\ ] ] we begin by writing @xmath295 from the it rules , we have @xmath296 comparing the coefficients to the quantum filtering equation , we read off @xmath297 so that @xmath298 we try setting @xmath299 which means that @xmath300 and therefore @xmath301 which is the deterministic part of the quantum filtering equation as desired .",
    "since white noise is non - differentiable , there are a variety of ways to give meaning to the differential @xmath194 when integrated against some other stochastic process .",
    "the most statistically pleasing is the it integral , represented by the sde @xmath302 and which satisfies @xmath303 = a(t , x_t)dt$ ] , but requires using the it chain rule .",
    "conversely , a stratonivich sde , written @xmath304 transforms using the normal chain rule but has a nontrivial expectation .",
    "fortunately , it is straightforward to convert between the two forms , which share the same stochastic coefficient and whose deterministic coefficients are related via @xmath305 where the superscripts denote the @xmath306-th or @xmath26-th entry in the corresponding vector .",
    "we recommend the interested reader consult @xcite for a more complete discussion of the various ways of constructing stochastic integrals and defining white noise increments .    for the double - pass it sse in eq .",
    "( [ eq : double_pass_sse ] ) , we begin the conversion by noting that states with entirely real amplitudes form an invariant set and therefore write @xmath307 .",
    "the stochastic coefficient is then @xmath308      \\end{split}\\ ] ] which has as its @xmath306-th entry @xmath309      \\end{split}\\ ] ] the derivative with respect to @xmath310 is then @xmath311      \\end{split}\\ ] ] so that the sum in eq .",
    "( [ app : eq : ito_to_stratonovich ] ) is      this suggests an equivalent operator form @xmath313 ^ 2       - 2\\sqrt{m}{\\langle { \\hat{f}_{\\mathrm{z}}}(\\sqrt{m}({\\hat{f}_{\\mathrm{z}}}- { \\langle { \\hat{f}_{\\mathrm{z}}}\\rangle } ) + i\\sqrt{k}{\\hat{f}_{\\mathrm{y } } } ) \\rangle}_t      & = & \\left[\\sqrt{m}({\\hat{f}_{\\mathrm{z}}}- { \\langle { \\hat{f}_{\\mathrm{z}}}\\rangle}_t)+ i\\sqrt{k}{\\hat{f}_{\\mathrm{y}}}\\right]^2 \\\\      & & - 2m{\\langle \\delta{\\hat{f}_{\\mathrm{z}}}^2 \\rangle}_t -2i\\sqrt{km}{\\langle { \\hat{f}_{\\mathrm{z}}}{\\hat{f}_{\\mathrm{y}}}\\rangle}_t \\nonumber,\\end{aligned}\\ ] ] where @xmath236 , so the stratonovich sse is @xmath314                -\\frac{\\sqrt{km}}{2}{\\hat{f}_{\\mathrm{x}}}+2i\\sqrt{km}{\\langle { \\hat{f}_{\\mathrm{z}}}\\rangle}_t{\\hat{f}_{\\mathrm{y}}}+ i\\sqrt{km } { \\langle { \\hat{f}_{\\mathrm{z}}}{\\hat{f}_{\\mathrm{y}}}\\rangle}_t                          \\right]{\\lvert \\psi \\rangle}_t dt\\nonumber\\\\                   & & + \\left ( \\sqrt{m}({\\hat{f}_{\\mathrm{z}}}- { \\langle { \\hat{f}_{\\mathrm{z}}}\\rangle})_t + i\\sqrt{k}{\\hat{f}_{\\mathrm{y}}}\\right){\\lvert \\psi \\rangle}_t \\circ dw_t .",
    "\\label{app : eq : sse_stratonovich } \\end{aligned}\\ ] ]"
  ],
  "abstract_text": [
    "<S> we argue that it is possible in principle to reduce the uncertainty of an atomic magnetometer by double - passing a far - detuned laser field through the atomic sample as it undergoes larmor precession . </S>",
    "<S> numerical simulations of the quantum fisher information suggest that , despite the lack of explicit multi - body coupling terms in the system s magnetic hamiltonian , the parameter estimation uncertainty in such a physical setup scales better than the conventional heisenberg uncertainty limit over a specified but arbitrary range of particle number @xmath0 . using the methods of quantum stochastic calculus and filtering theory , we demonstrate numerically an explicit parameter estimator ( called a quantum particle filter ) whose observed scaling follows that of our calculated quantum fisher information . </S>",
    "<S> moreover , the quantum particle filter quantitatively surpasses the uncertainty limit calculated from the quantum cramr - rao inequality based on a magnetic coupling hamiltonian with only single - body operators . </S>",
    "<S> we also show that a quantum kalman filter is insufficient to obtain super - heisenberg scaling , and present evidence that such scaling necessitates going beyond the manifold of gaussian atomic states . </S>"
  ]
}