{
  "article_text": [
    "the solar magnetic carpet is a salt and pepper mix of small - scale opposite polarity magnetic features .",
    "these features are continually evolving in response to the photospheric flow pattern of convective cells known as supergranules .",
    "these cells range in diameter from 10000 km to 50000 km , with an average of between 13000 and 18000 km @xcite .",
    "their flow pattern is described by an upflow at cell centre , followed by radial outflow at roughly 0.5 km s@xmath2 @xcite , and downflow on the order of 0.1 km s@xmath2 at the cell edges @xcite .    due to the constant motion of the underlying granules and supergranules",
    ", magnetic features frequently interact with one another .",
    "new magnetic flux is continually emerging from below the surface in the form of opposite polarity pairs @xcite .",
    "in addition , other features are formed through the coalescence of same - polarity features ; large features may break apart into smaller features ; and features may shrink or disappear through the cancellation of opposite polarity flux . over the last 10 years our understanding of the solar magnetic carpet has greatly increased due to the space missions of soho / mdi and _ hinode_/sot . through these missions ,",
    "many observational studies of the properties of the magnetic carpet have been carried out @xcite .",
    "three main types of small - scale magnetic features have been classified ; these are ephemeral regions , network features and internetwork features .",
    "ephemeral regions are newly emerging bipolar pairs that appear within the supergranular cells .",
    "they have an average lifetime of 4.4 h and typical diameters of 3000 - 5000 km @xcite .",
    "for the first 30 mins after appearing , the two opposite polarities are found to separate from one another at a velocity of around 4.5 - 5 km s@xmath2 @xcite .",
    "later , they slow to a velocity that is on the order of the underlying supergranular flow , @xmath3 0.4 km s@xmath2 @xcite",
    ". give the average flux of an ephemeral region to be 1.3@xmath410@xmath5 mx ( maxwell ) , while find a slightly higher value of 2.8@xmath410@xmath5 mx .",
    "network features are larger features , with diameters in the range 1000 - 10000 km and fluxes of 10@xmath6 - 10@xmath5 mx , that are typically found at sites of strong downflow ,",
    "_ i.e. _ the edges of the supergranular cells @xcite . find them to be slow moving , with an average velocity of just 0.06 km s@xmath2 .",
    "they do not emerge as network concentrations ; rather they are produced from the residuals of other magnetic flux features . around",
    "90% of their flux originates from ephemeral regions , with the remaining 10% arising from internetwork features @xcite .",
    "the final type of small - scale flux features are internetwork features ; they also emerge as bipolar pairs within supergranular cells .",
    "their mean diameter is around 2000 km and their fluxes lie in the range 10@xmath7 - 2@xmath410@xmath6 mx @xcite .",
    "de wijn _ et al .",
    "_  ( @xcite ) find a rms velocity of 1.57@xmath80.08 km s@xmath2 , and an average lifetime of just 10 mins for internetwork features .",
    "deduce an even smaller average lifespan of just 2.9@xmath82.0 mins .",
    "previous theoretical models for the evolution of the magnetic carpet photosphere include , , , and .",
    "describe flux emergence , cancellation , coalescence and fragmentation through equations of magneto - chemistry .",
    "other authors represent magnetic flux features as collections of corks that are passively advected by photospheric flows @xcite , or as a continuous distribution @xcite .",
    "this paper describes a new model that aims to reproduce the main observational properties of this small - scale photospheric field .",
    "many of the parameters built into it are taken from studies of observational data ( such as _ hinode_/sot or soho / mdi magnetograms ) .",
    "the model also includes a supergranular flow pattern @xcite , as well as random small - scale motions to represent the effect of granulation .",
    "the model reproduces observed quantities , such as the power law flux distribution obtained by .",
    "other objectives include reproducing the rapid photospheric recycle time on the order of 1 - 2 h deduced by ; equality of the rates of emergence and cancellation of flux ; and visually , the appearance of a magnetic network along the boundaries of the supergranule cells .",
    "our long term goal is to use the simulated magnetograms produced by this model as lower boundary data in our 3d non - linear force - free coronal field model @xcite .",
    "this model applies a magnetofrictional method to produce a non - potential coronal magnetic field in response to photospheric motions @xcite .",
    "the method will be described in paper 2 @xcite , in which we simulate the non - linear force - free evolution of the coronal field for a series of simple small - scale interactions .",
    "the paper is outlined as follows : section  [ model ] describes the technical aspects of the construction of the 2d magnetic carpet model and how each of the four flux evolution processes are specified .",
    "the results of the simulations are presented in section  [ results ] where we show that the model reproduces many observational parameters .",
    "section  [ conclusion ] gives the discussion , conclusions and an outline of future work we are undertaking .",
    "the construction of the magnetic carpet model is now described .",
    "whilst observational studies use the term ` feature ' to describe small - scale magnetic flux concentrations , we will refer instead to magnetic ` elements ' .",
    "this is to distinguish between a ` magnetic element ' in the model , which we choose to have a specific mathematical form .",
    "in contrast , an observational magnetic feature as would appear in a magnetogram may be composed of several of our magnetic elements .",
    "each magnetic element within the model is treated individually as a unique discrete element .",
    "the sum of all elements then produces a synthetic magnetogram .",
    "this approach differs from other methods in several ways . in cork models ,",
    "each cork represents a single intense flux tube , whereas in our model we represent our magnetic elements with gaussian peaks , allowing features to form that are composed of many peaks and troughs in magnetic field strength . to avoid undesirable numerical effects such as numerical diffusion and pile - up at cancellation points , we move the centres of magnetic elements rather than advect their gaussian profiles .",
    "such a treatment also allows us to easily keep track of the number of elements and exactly which elements are involved in each of the four processes of emergence , cancellation , coalescence and fragmentation at any time .",
    "we first describe the mathematical form of the magnetic elements which produce the synthetic magnetograms . following this ,",
    "examples of the magnetograms produced over a 250 h period are shown . finally , we discuss the rules that govern how the magnetic elements evolve .      for each discrete magnetic element",
    "we assume that the @xmath9-component of the element s magnetic field has a gaussian profile , @xmath10 where @xmath11 is the peak magnetic field strength , @xmath12 is the gaussian half - width and @xmath13 is the distance from the centre of the gaussian .",
    "the total flux , @xmath14 , of each element is : @xmath15        we specify the gaussian half - width of each magnetic element be @xmath16 , where @xmath17 is the diameter of the magnetic element and @xmath18 is its absolute flux , @xmath19 .",
    "the diameter is given by @xmath20 where the parameters @xmath21 and @xmath22 are given by @xmath23 we let @xmath24 mm , @xmath25 mm , @xmath26 mx and @xmath27 mx so that the majority of magnetic elements within the simulation are confined to the range @xmath28 $ ] mm .",
    "these values agree with observed diameters and fluxes for magnetic carpet features such as small network features and internetwork features @xcite .",
    "a plot of diameter versus flux is shown in figure  [ fig : width ] .",
    "equation  ( [ eqn : b01 ] ) may be rearranged to give an expression for the peak magnetic field strength of a single magnetic element , @xmath29 the contribution of the @xmath30th magnetic element to the normal component of the magnetic field is then : @xmath31 @xmath32 where @xmath33 is an arbitrary position , and @xmath34 is the position of the centre of the magnetic flux element .",
    "we sum up the contribution from every magnetic element to give @xmath35 , @xmath36    * *    figure  [ fig : mag_ex ] shows contour plots of @xmath35 for a simulation in which newly emerging bipoles have a total flux in the range @xmath37 - @xmath38 mx .",
    "this simulation is described in more detail in section  [ results ] . a black and white image of the same region is shown to simulate a magnetogram .",
    "throughout the simulation , the motion of the magnetic elements is determined by the underlying supergranular flow , which is described next . in addition",
    ", details of the flux emergence and interaction processes are given in sections  [ subsec : emerge ] , [ subsec : fragment ] and [ subsec : cancel ] . readers not wishing to read the technical details of how these processes are implemented may jump to section  [ results ] .",
    "we construct a supergranular velocity profile for our model that is similar to that of , except that the diameter of each cell varies from supergranule to supergranule . for simplicity",
    "our flow profile is currently steady throughout the simulation , although in reality , supergranules evolve in time .",
    "various authors have estimated lifetimes of supergranules to be anywhere from 10 hours to 2 days , depending on the technique used @xcite . however",
    ", we will show that our steady profile does not lead to an unphysical buildup of magnetic flux at the cell boundaries .",
    "the flow profile of a single supergranule is given by @xmath39 where @xmath40 is the velocity from cell centre in the @xmath41-@xmath42 plane .",
    "@xmath43 is the distance from cell centre , and @xmath44 and @xmath45 are normalised values that determine the flow strength and radius of the supergranule .",
    "we set @xmath46 for all supergranules , which corresponds to 8.7 mm in our simulations .",
    "@xmath47 is a number between 0 and 1 that determines the strength of each cell .",
    "we choose the positions @xmath48 of the centres of @xmath49 supergranules in the simulation . to introduce the influence of cells outside the computed domain",
    ", we translate the positions of these @xmath49 cells eight times to surround the original pattern , as illustrated by figure  [ fig : sgflow](a ) .",
    "the original domain is shown in black , and spans the range @xmath50 \\times [ y_{\\textrm{\\small min}},y_{\\textrm{\\small max}}]$ ] , where we choose @xmath51 mm and @xmath52 mm .",
    "translation of the cells means that the supergranular flow matches through the side boundaries , which are periodic .    * *    to produce the steady flow pattern , the velocity at any point is found by summing over the contributions of @xmath53 supergranular cells .",
    "this includes the @xmath49 original supergranules which describe the central region of figure  [ fig : sgflow](a ) , outlined in black , and the eight sets of translations .",
    "once the contribution of all cells has been calculated , the resulting velocity profile is scaled so that the maximum value of @xmath40 is 0.5 km s@xmath2 @xcite .",
    "the flow profile chosen for the simulation illustrated in figure  [ fig : mag_ex ] is shown in figure  [ fig : sgflow](b ) .",
    "this flow profile is used for all of the simulations described in this paper .",
    "the positions of the cell centres were selected to produce an irregular pattern , as would be seen in real observations of the solar surface .",
    "one can also see flows contributing from the supergranules through the boundaries , as a result of the translation previously described .",
    "contributions from granular motions are also added to each magnetic element s velocity at each time step .",
    "the granular velocity contribution is randomly chosen to be between 0 and 0.1 km s@xmath2 if an element is within @xmath54 of the centre of the supergranular cell , and between 0 and 0.2 km s@xmath2 if it is further out than this , where @xmath55 is the radius of the supergranule .",
    "the direction of this velocity is also chosen as random .",
    "a slightly higher value for the granular velocity contribution is chosen if the magnetic element is near the boundary of the supergranule , since the contribution from the supergranular flow profile is small at these locations .",
    "this prevents elements from becoming stationary once they reach the network between supergranules .",
    "one time step within the model is equal to @xmath56 min .",
    "this is an arbitrary choice within the model and may be chosen to be higher or lower .",
    "we have chosen 1 min as the current cadence of magnetogram data from instruments such as soho / mdi and sdo / hmi are of a similar size .",
    "full disc mdi magnetograms are typically of cadence 1 min at best @xcite , while hmi line - of - sight magnetograms are of cadence 45 s ( http://hmi.stanford.edu/hmi-specs.html ) .",
    "many authors studying the observational properties of the solar magnetic carpet have used magnetogram data sets of cadence roughly 1 min , occasionally averaged over a longer time period to reduce noise , for example , , and .",
    "as higher cadences become available for observational data , we may choose a smaller time step in our model .",
    "the simulations in section  [ results ] are each run for 250 h , which corresponds to 15000 time steps .    in the next three sections ,",
    "we discuss the methods used to implement the processes of emergence , fragmentation , cancellation and coalescence .",
    "each emerging bipole is made up of two separate magnetic elements that are of equal flux and opposite polarity .",
    "we use the term ` bipole ' only when referring to a newly emerging pair of magnetic elements , at all other times we consider single magnetic elements .",
    "to simplify computations and prevent infinitesimally small flux elements from arising , we set the minimum unit of flux that a single polarity may have to be equal to @xmath57 mx , and define all magnetic elements to have flux that is an integer multiple of @xmath58 @xcite .",
    "a bipole of absolute flux @xmath59 consists of two magnetic elements of equal absolute flux , @xmath60 , but opposite polarity .",
    "the total signed flux of the bipole is therefore @xmath61 .      ) , with @xmath62 @xmath63 day@xmath2 and @xmath64.,scaledwidth=60.0% ]    flux emergence within the simulation is determined by the probability distribution for emerging bipoles from .",
    "this is determined from _",
    "high resolution magnetograms and is in the form of a power law : @xmath65 where @xmath62 @xmath63 day@xmath2 and @xmath64 .",
    "the values for @xmath66 and @xmath67 come from a feature tracking study of",
    "_ hinode_/sot data that is described by .",
    "figure  [ fig : em_hinode ] shows a log - log plot of their results for the frequency of emergence versus flux emerged .",
    "tb and tc indicate emergence detected by a _ tracked bipolar _ and a _ tracked cluster _",
    "method respectively .",
    "these methods are explained fully in the original paper .",
    "the subscripts ` d ' and ` c ' stand for the _ downhill _ and _ clumping _ methods of magnetic feature identification , these are described by .",
    "the quantity @xmath68 is the total number of bipoles that emerge with total absolute flux in the range @xmath69 $ ] , where @xmath70 is very small .",
    "the flux emergence rate for bipoles with flux in the range @xmath71 $ ] in mx @xmath63 day@xmath2 may be computed as : @xmath72_{\\phi_a}^{\\phi_b}.\\ ] ] correspondingly , the number of bipoles emerging in the range @xmath71 $ ] in units of @xmath63 day@xmath2 is then @xmath73_{\\phi_{a}}^{\\phi_{b}}.\\ ] ] let @xmath74 and @xmath75 be the minimum and maximum flux allowed for emerging bipoles in our simulation .",
    "they must both be integer multiples of @xmath76 , as each individual polarity will then have an absolute flux that is an integer multiple of @xmath58 .",
    "in addition to this , we must have @xmath77 .",
    "for our simulations , we choose to emerge only discrete values of flux from @xmath74 to @xmath75 in steps of size @xmath78 .",
    "if @xmath79 then the set of emerging flux values of bipoles is @xmath80 for each discrete value @xmath81 , we integrate over the range @xmath82 $ ] to approximate the number of bipoles with that absolute flux that will emerge during the simulation : @xmath83 where @xmath84 is the area of the domain in @xmath85 and @xmath86 is the number of days of the simulation .",
    "we can not allow a non - integer number of bipoles to emerge , so @xmath87 must be converted to an integer , @xmath88 , by rounding up or down randomly .",
    "the @xmath89 bipoles are then randomly assigned a value from @xmath61 to @xmath90 using a uniform distribution , which will be the time step in which they emerge .",
    "this means that a random number of bipoles emerge each time step , and also a random total quantity of flux .",
    "in addition to flux , diameter and sign , several other parameters must be chosen for each newly emerging bipole .",
    "for each bipole , a random uniform integer between @xmath61 and @xmath91 is chosen .",
    "this is the index of the supergranule cell that it will emerge in .",
    "its location within the cell is then randomly chosen .",
    "since ephemeral regions have been observed to emerge with a preference towards the edge of a supergranule @xcite , we also build this into our model .",
    "we allow emergence to occur in the range @xmath92 $ ] , where @xmath55 is the radius of the supergranule .",
    "the final parameter that must be chosen for an emerging bipole is its tilt angle , @xmath93 .",
    "this is the angle of the axis along which the two polarities of the bipole will separate from one another and it is simply a random uniform number between @xmath61 and @xmath94 radians .",
    "the separation velocities of newly emerging magnetic elements are discussed below .",
    "10 mm in area .",
    "the images are taken 4 mins apart , and elements of interest have been numbered from 1 to 3 , where elements 2 and 3 illustrate emergence . this event may be seen in the accompanying movie , ` mag2_em.mpg'.,scaledwidth=80.0% ]    * *    * *    at each time step , newly emerging bipoles are added into the simulation .",
    "each magnetic element undergoes the specified emergence process outlined below until it has travelled @xmath95 from its initial position .",
    "@xmath96 is a constant that defines the separation that a magnetic element must reach from its emergence point before supergranular flows or other processes may take over its evolution .",
    "the element s velocity @xmath97 depends upon how long it has been emerging for and its direction is given by its tilt angle @xmath93 .",
    "observational studies show that the two polarities of a newly emerging bipole initially separate at several km s@xmath2 , later slowing to velocities that are of a similar order to those of the underlying supergranular flows @xcite . within our simulations",
    ", two elements will initially separate with a velocity of @xmath98 km s@xmath2 , slowing to @xmath99 km s@xmath2 after 30 mins and later to @xmath100 km s@xmath2 which is on the order of the underlying supergranular flow .",
    "initially , the positive and negative magnetic elements within the bipole move in opposite directions along the axis of their tilt angle .",
    "figure  [ fig : em1 ] ( and the accompanying movie , ` mag2_em.mpg ' ) shows a sequence of images taken from a small region of the synthetic magnetograms produced by one of the simulations .",
    "the region is @xmath101 mm@xmath102 in area , and the images are taken 4 mins apart .",
    "one can see that between images ( a ) and ( b ) , a new bipole begins to emerge in the centre of the box , the positive and negative polarities are marked ` 2 ' and ` 3 ' respectively .",
    "the two polarities grow in flux as they move apart . towards the end of the sequence , magnetic element 3",
    "begins to interact with a pre - existing magnetic element , indicated by ` 1 ' .",
    "notice also that in addition to the two polarities moving in opposite directions to one another , there is a slight drift of the bipole towards the upper left due to the underlying supergranular flow .",
    "fragmentation within our model is based upon the process described by , which depends upon both the flux of the magnetic element and time .",
    "every element is checked for fragmentation at each time step .",
    "the fragmentation rate @xmath103 is an input parameter for the simulation .",
    "we assume that every element of sufficient flux will fragment within @xmath104 s. suggests that a fragmentation rate of @xmath105 s@xmath2 is required to reproduce the correct absolute flux density and flux distribution , so we take @xmath106 s@xmath2 .",
    "this means that a magnetic element of sufficiently large flux will fragment roughly once every @xmath107 s @xmath3 1 h 50 mins . for an element @xmath30 to have _ sufficient flux _ to fragment",
    ", it must satisfy the inequality @xmath108 where @xmath109 is a random number such that @xmath110 , and @xmath111 .",
    "@xmath112 is fixed at the start of the simulation , but a random @xmath109 is chosen for every magnetic element every time we check whether it will fragment .",
    "take a value of @xmath113 that is at the large end of their range of expected flux values , @xmath114 mx , and @xmath115 . without observational evidence to suggest differently , we take the same values for our simulations . with these parameters ,",
    "the largest value that the right hand side of equation  ( [ eqn : frag1 ] ) can take is @xmath116    similarly , the minimum value that the right hand side of equation  ( [ eqn : frag1 ] ) can take is @xmath61 .",
    "however , elements are not allowed to fragment if they are of unit flux , @xmath58 .",
    "this means that all magnetic elements of absolute flux @xmath117 may fragment , but elements of greater flux have a higher probability of fragmentation .    time dependence is built into the fragmentation process as follows .",
    "if @xmath118 satisfies equation  ( [ eqn : frag1 ] ) , we then choose a random @xmath119 such that @xmath120 .",
    "element @xmath30 will only fragment during the current time step if @xmath121 @xmath122 is the ` age ' of magnetic element @xmath30 in s. an element s age is reset to @xmath61 every time it fragments , coalesces or cancels with another element .",
    "clearly once @xmath123 the right hand side will be greater than 1 , and the inequality will be satisfied .",
    "therefore , all magnetic elements of flux greater than @xmath124 mx are guaranteed to fragment within @xmath125 time steps , unless some other process takes over their evolution before then .      within our simulations , elements are allowed to split into just two new elements at a time . in reality , most fragmenting magnetic features only split into two @xcite . once it has been determined that element @xmath30 will fragment , a new element @xmath126 is introduced to represent the element resulting from the fragmentation .",
    "the flux and diameter of @xmath30 and @xmath126 must now be recomputed . as in , the original flux @xmath118 is split into two new fluxes , @xmath127 and @xmath128 .",
    "if @xmath129 is a random number between 0.55 and 0.95 , then @xmath130 since all fluxes within the simulation must be integer multiples of @xmath58 , we round @xmath131 to the nearest integer .",
    "we then take @xmath132 elements of flux @xmath58 are not allowed to fragment . if @xmath133 , then @xmath134 , and if @xmath135 , then @xmath136 and @xmath137 .",
    "we may now set @xmath138 and @xmath139 , then compute their new diameters @xmath140 and @xmath141 .",
    "10 mm in area .",
    "the images are taken 2 mins apart , and elements of interest have been numbered from 1 to 4 .",
    "these interactions may be seen in the accompanying movie , ` mag3_frag.mpg'.,scaledwidth=100.0% ]    * *    an element s behaviour after it has fragmented depends upon the process that the original element was undergoing before the fragmentation occurred .",
    "if it was undergoing emergence , fragmenting from yet another element , or simply being advected by supergranular flows , then its velocity @xmath40 returns to being determined by this process km s@xmath2 ) , the new elements may be given a ` push ' of @xmath142 km s@xmath2 to help them separate . ] .",
    "in the case of emergence , the two new elements produced by fragmentation are also treated as emerging .",
    "their velocities therefore still decrease with time , though the directions of motion of the two new elements @xmath30 and @xmath126 are different . if @xmath93 is the direction of motion of the original element , then @xmath143 where @xmath144 is randomly chosen for each individual fragmentation @xcite .",
    "therefore the two magnetic elements move in the same direction with slightly offset motions .",
    "if the element determined to fragment was undergoing cancellation or coalescence with another element @xmath145 before it fragmented , the treatment is slightly different . the fluxes and diameters of the two new elements @xmath30 and @xmath126 are computed .",
    "the new element @xmath30 then continues to cancel or coalesce with @xmath145 , while @xmath126 moves off in a different direction at the velocity of the underlying supergranular flow .",
    "the new direction of motion for @xmath126 is given by @xmath146 with @xmath144 random .",
    "the parameter @xmath147 defines the separation that a magnetic element will reach from its point of fragmenting .",
    "an element @xmath30 will continue to move away from its fragmentation site until it has reached a distance of @xmath148 .",
    "figure  [ fig : frag1 ] ( and the accompanying movie , ` mag3_frag.mpg ' ) shows examples of fragmentation occurring within one of the simulations .",
    "element 1 splits to form a new element , 3 , element 2 then begins to fragment to form element 4 .",
    "fragmentation may also be seen in the sequence in figure  [ fig : canc1 ] of the following section , where element 2 fragments into a large and a small element .",
    "every time step , each element that is not currently undergoing the emergence process is checked to see if it will cancel or coalesce with another element . in the current model ,",
    "an element @xmath30 may only cancel or coalesce with one single element at any given time .",
    "first we determine how many magnetic elements are within interaction range of @xmath30 ( including those through the periodic boundaries ) .",
    "an element @xmath126 is defined to be within interaction range if @xmath149 , the separation distance , satisfies @xmath150 where @xmath151 the constant @xmath152 defines the interaction range between two magnetic elements .",
    "it is important that @xmath153 to prevent elements that have just separated from one another due to emergence from immediately cancelling with one another again .",
    "there are also several other conditions for the cancelling or coalescing of @xmath30 with some element @xmath126 :    * @xmath126 must not currently be undergoing emergence , * @xmath126 must not currently be cancelling or coalescing with another element , * if @xmath30 and @xmath126 are in the process of fragmenting from one another , then they are not allowed to immediately coalesce .",
    "if they are still within range after the fragmentation process has ended , they may then coalesce together ( see section  [ subsec : fragment ] ) .",
    "if these conditions are all satisfied by more than one element within range of @xmath30 , then @xmath30 will cancel or coalesce with the closest element .",
    "once it has been determined that two elements will cancel or coalesce , they move together at a constant velocity of @xmath154 km s@xmath2 until their centres meet .",
    "their direction of motion is along the axis defined by their centres .        *",
    "*    since each magnetic element is given a gaussian profile , their profiles overlap as they move towards one another . in the case of cancellation , this results in both magnetic elements shrinking as they move towards one another .",
    "if they are of equal flux and opposite polarity , they will completely cancel one another out .",
    "this is illustrated in figure  [ fig : canc2 ] . within the magnetic carpet model ,",
    "both magnetic elements are removed at this stage . in the case of partial cancellation or coalescence ,",
    "one of the elements is removed when the peaks of their gaussian profiles meet .",
    "the remaining element s flux is then updated to be the difference between the two original flux values .",
    "this new element s motion is now determined by supergranular flows until another process takes over .",
    "10 mm in area .",
    "the images are taken 4 mins apart , and elements of interest have been numbered from 1 to 6 .",
    "these interactions may be seen in the accompanying movie , ` mag1_canc.mpg'.,scaledwidth=100.0% ]    * *    * *    the processes of cancellation and coalescence occur frequently within the model , and can easily be detected by eye in the synthetic magnetograms .",
    "figure  [ fig : canc1 ] ( and the accompanying movie , ` mag1_canc.mpg ' ) shows a sequence of eight images taken from one of the simulations , in which examples of both cancellation and coalescence of magnetic elements can be seen .",
    "we follow the evolution of a negative polarity element 1 , and two positive elements , 2 and 3 . in frame ( d )",
    "an emergence occurs in the bottom left ( 5 and 6 ) and element 2 begins to fragment , creating a new element , 4 .",
    "as the sequence progresses , a cancellation occurs between 1 and 2 , and elements 3 and 4 coalesce . by the end of the sequence , 2 and",
    "4 have disappeared , and 3 has begun cancelling with 5 .      after the parameters for newly emerging bipoles have been determined , we compute the magnetic field on the photosphere for each time step . at each time step ,",
    "we first loop over all magnetic elements and determine their current velocities .",
    "in addition to the four flux evolution processes described in sections  [ subsec : emerge ] ,  [ subsec : fragment ] and  [ subsec : cancel ] , we add a contribution from the underlying supergranular flow to each element s velocity .",
    "this prevents the motion of elements from being too linear , particularly when undergoing emergence .",
    "it seems likely that supergranular flows would continually have an effect on magnetic elements on the real solar surface .",
    "we also add a random motion to every magnetic element that represents the effect of granulation .",
    "the main purpose of this is to prevent elements from becoming stationary once they reach the network between supergranules , as our supergranular flow profile does not currently evolve in time .",
    "we now update the positions of every element according to its velocity : @xmath155 @xmath156    the next stage is to check which elements have just started or finished emerging , cancelling , coalescing or fragmenting .",
    "elements are added and removed from the simulation as necessary , and parameters updated .",
    "we also check that no elements have moved out of the computational domain .",
    "if they have , their coordinates are translated so that they reappear at the opposite side of the box due to the periodic boundaries .    to construct synthetic magnetograms for the line - of - sight component of the magnetic field",
    ", we recompute @xmath35 analytically at each time step from the information stored for each magnetic element .",
    "this simulated magnetogram is output to a file every time step .",
    "the method is as described in section  [ subsec : magn ] .",
    "using the techniques described above , nine simulations are run keeping all interaction and evolution parameters fixed at values determined to produce the most realistic evolution .",
    "the only parameter that is varied is the lowest flux value taken by emerging bipoles . for the model",
    ", we consider a quiet region of the solar surface which has no contribution from active regions .",
    "the parameters common to each model are given in table  [ tab : param ] .",
    "the locations of supergranular cells and the parameters @xmath47 and @xmath157 that specify their strengths are also kept fixed , as described in section  [ subsec : flow ] .",
    ".key parameters within the magnetic carpet model , along with their values specified .",
    "[ cols=\"^,^,^\",options=\"header \" , ]     figure  [ fig : ratefreq ] ( c ) shows a plot of the variation of the emergence and cancellation frequencies throughout the simulation for @xmath158 mx .",
    "the solid line represents emergence , the dashed line represents cancellation .",
    "it can be seen that cancellation events occur more often than emergence events even though the two processes have similar rates .",
    "this is because large flux elements may fragment , which leads to more elements that may cancel . as with emergence and cancellation rates ,",
    "the curves are steadier when @xmath74 is lower .",
    "the average emergence and cancellation frequencies for each simulation are given in table  [ tab : sim2 ] .",
    "in agreement with , the cancellation frequency is always greater than the emergence frequency .",
    "the difference between the frequencies of emergence and cancellation increases with increasing @xmath74 .",
    "this is particularly apparent for larger values of @xmath74 , where emergence only produces a relatively small number of large elements .",
    "these elements may then break apart multiple times to produce large numbers of small continually cancelling and coalescing elements , resulting in a significantly higher frequency of cancellation than emergence .",
    "this occurs because emergence within each simulation is restricted to a narrow range of flux values , whereas cancellation may occur on any scale .",
    "figure  [ fig : ratefreq](d ) shows the ratio of emergence to cancellation frequencies .",
    "note that even though the cancellation frequency ( in @xmath63 day@xmath2 ) may be much greater than the emergence frequency , the rates of emergence and cancellation ( in mx @xmath63 day@xmath2 ) are still roughly equal .",
    "the same quantity of flux emerges and disappears throughout the simulation , only the size of the magnetic elements involved in these processes changes .      * *    figures  [ fig : dist1](a ) and ( b ) show number density plots for the number of magnetic elements as a function of their flux for the simulations with @xmath159 mx and @xmath158 mx . in each case",
    "the black line represents the number density of magnetic elements versus their absolute flux value .",
    "this curve is produced by analysing the distribution every 600 time steps , which is equivalent to every 10 h , and summing up all the flux distributions taken for a particular simulation .",
    "the length of time between samples was chosen so that the flux within the model will have recycled from one sample to the next .",
    "this prevents elements from being counted more than once .",
    "the other four lines on each plot represent the occurrence of each of the four flux evolution processes described in section  [ model ] . in the simulations it is possible to keep track of every event that occurs ,",
    "so the sample size is a lot larger than the flux distribution sample size , as any one element may undergo a number of processes .",
    "the blue line corresponds to the number density of emergences versus the total absolute flux of the emerging bipole , while the red line represents the number density of cancellations versus flux removed during the cancellation event .",
    "it can be seen that the number density of cancellation events is greater than the number density of emergence events until @xmath160 mx .",
    "this fits with previous results that show many more cancellation events occur than emergence events , where the events tend to occur between smaller magnetic elements . above a flux of @xmath161 mx , fragmentation ( purple )",
    "is so strong that it affects the elements before they can cancel ( red ) .",
    "since the rates of emergence and cancellation are roughly equal in each simulation , more large elements must emerge than cancel .",
    "the green line represents the number density of coalescence events versus the absolute flux of the two coalescing elements . in all nine simulations (",
    "only two are illustrated here ) this curve appears to follow the flux distribution curve ( black ) very closely , although the fit is not so good at higher @xmath18 ( larger elements do not exist for very long within the simulation , so many are missed when sampling the flux distribution only once every 600 time steps ) .",
    "this supports the suggestion of , that coalescence is the dominant process for small - scale elements .",
    "they come to this conclusion because this is one of the reasons why fewer small - scale elements are observed on the solar photosphere than are found to emerge",
    ". it can be seen from the plots in figures  [ fig : dist1](a ) and ( b ) that the number density of emerging events ( blue ) is greater than the flux distribution ( black ) for small values of @xmath18 , supporting the fact that coalescence is dominant for small - scale fields . in order for our model to be more conclusive on this matter however , it is necessary to allow the existence and emergence of even smaller flux elements than @xmath57 mx .",
    "since the green ( coalescence ) line follows the flux distribution ( black ) so closely , this implies that any and all magnetic elements may undergo coalescence , it is not flux dependent .",
    "fragmentation is defined in our simulations to be strongly flux dependent .",
    "the purple line represents the number density of fragmentation events versus the flux of the original magnetic element .",
    "the curve for fragmentation is lower than those of all of the other processes for small @xmath18 .",
    "however , it can be seen that as an element s absolute flux increases the fragmentation process becomes dominant .    * *    figure  [ fig : dist2](a ) is a plot of the frequency of occurrence of flux elements versus their flux content , for the simulation with @xmath159 ( black line ) .",
    "units of @xmath162 mx@xmath2 @xmath63 have been chosen for the y - axis in order to compare the plot with figure 5 of .",
    "two straight lines have been fitted to the data .",
    "we note that our data do not span three orders of magnitude , as is technically required to compute a power law relation .",
    "however , power laws have been used for observational data so we have fitted one for comparison .",
    "the red line is fitted using all of the data , and has a slope of -2.68 .",
    "the blue line is fitted for elements in the range @xmath163 mx , therefore missing the low emergence upper flux range , as the sample size for our model is much better for smaller elements .",
    "note that as we are considering an isolated region of the solar surface , the upper bound is solely dependent on emergence and coalescence .",
    "no elements may enter the domain due to the dispersal of magnetic flux from active regions . as a result",
    ", we find that our distribution of elements falls off faster than is observed at higher values of flux .",
    "hence we restrict the power law index to those flux elements that we adequately model .",
    "the fit of the blue line is good in this range .",
    "it has a slope of -1.85 , which is in agreement with the findings of .",
    "they fit a line with a slope of -1.85 to data for flux elements observed by soho / mdi and _ hinode_/sot that spans the range @xmath164 mx , therefore our model , which only models the lower range of this , fits this well .",
    "the method that they use to detect magnetic flux features also differs from the way that we define them .",
    "they use a ` clumping ' method , whereas our definition of a magnetic element is more suited to the ` downhill ' method of feature tracking ( de forest _ et al . _  @xcite ; lamb _ et al",
    "_ ,  @xcite ) .",
    "the downhill method is good at picking out individual peaks in magnetic flux . particularly for larger magnetic regions , several peaks",
    "may be detected by the downhill method and counted as separate magnetic features .",
    "however , the same region may be counted as a single feature by the clumping method ( see figures 1 and 7 of ) .",
    "a flux distribution detected using downhill would result in a ` tail ' towards higher fluxes , as is seen in our figure  [ fig : dist2](a ) .",
    "a feature tracking study of our synthetic magnetograms would be of interest , using a clumping method such as is described by .",
    "the equation of describing the frequency of occurrence of elements with an absolute flux of @xmath18 has the form @xmath165 where @xmath166 is the value obtained using a clumping method of feature tracking . in our simulations , we obtain @xmath167 , which is 3.3 times larger .",
    "a possible reason for this is the difference between our definition of a flux element , and the way that features are defined by . as can be seen in their figure 4(a )",
    ", the clumping method they use produces relatively large , irregularly shaped ` flux massifs ' .",
    "since we define magnetic elements to be compact and circular , such a feature in our model would be composed of many elements .",
    "for this reason we require many more small magnetic elements to describe the flux distribution of the quiet sun , hence the larger value of @xmath168 in the number density equation .",
    "it should be noted that while our definition of a magnetic element is different from that of after it has emerged , this does not affect the emergence power law @xcite , as during the process of emergence our definitions of magnetic elements agree .",
    "our reasoning for the difference in values of @xmath168 is supported by some simple calculations .",
    "if @xmath169 , then the average flux density ( @xmath170 ) and average flux of a magnetic element ( @xmath171 ) are given by @xmath172_{\\phi_{\\textrm{\\tiny min}}}^{\\phi_{\\textrm{\\tiny max}}}\\ ] ] and @xmath173 where @xmath174_{\\phi_{\\textrm{\\tiny min}}}^{\\phi_{\\textrm{\\tiny max}}}.\\ ] ] taking our values of @xmath167 @xmath63 , @xmath159 mx and @xmath175 mx we find @xmath176 mx and @xmath177 mx @xmath63 .",
    "our @xmath170 is consistent with the values given in table  [ tab : sim ] , and is realistic for the quiet sun .",
    "if we now consider the @xmath166 @xmath63 of , but limit the range of flux values considered to be consistent with the quiet sun ( @xmath178 mx ) , we get @xmath179 mx and @xmath180 mx @xmath63 .",
    "our absolute flux density is very similar to theirs , but our average flux element is much smaller .",
    "we also find that we have around three times more magnetic elements per unit area than ( @xmath181 @xmath63 compared with @xmath182 @xmath63 ) .",
    "therefore the difference in the parameters of the power law is due to our varying definition of ` magnetic elements ' to ` magnetic features ' .",
    "the slope of the fitted line in the range @xmath163 mx for each simulation is plotted versus @xmath74 in figure  [ fig : dist2](b ) .",
    "one can see that as @xmath74 increases the slope becomes less steep .",
    "this is because as only larger elements emerge , these large elements have more of an impact on the number density .",
    "such a limited range for emerging bipoles is less realistic , so we would expect this to be less of a match with the results obtained through observations .",
    "when the lower bound of emerging flux is less than @xmath183 mx , the power law index converges around -1.8 .      * *    * *    the plots in figure  [ fig : life ] relate to the _ lifespan _ of magnetic elements within each simulation . within our model",
    ", an element is defined to ` die ' when its flux changes , either by fragmenting into two new elements or cancelling or coalescing with another element .",
    "an element begins its life when it newly emerges ; has just split from another as a result of fragmentation ; or is produced by two separate elements cancelling or coalescing together .",
    "our definition of an element s lifespan likely differs somewhat from that of an observer studying magnetogram data , as does our counting of magnetic elements .",
    "it is easy to count and keep track of the processes that magnetic elements undergo within our model because they are treated as individual point sources .",
    "however , when the synthetic magnetogram is created using the method described in section  [ subsec : magn ] , many of these elements overlap to produce fewer , larger magnetic elements . in addition , the resolution and cadence of real data are not always high enough to be able to detect the smallest and fastest evolving elements .",
    "this is another reason why further study of the photospheric model using the synthetic magnetogram series as input into the variety of feature tracking techniques that have been produced would be of interest .",
    "figure  [ fig : life](a ) shows the log frequency of occurrence of magnetic elements with a lifespan of @xmath184 h , for the simulation in which @xmath159 mx .",
    "the mean lifespan of all elements is plotted for each simulation in figure  [ fig : life](b ) .",
    "it can be seen that most elements do not even ` live ' for one hour before fragmenting , cancelling or coalescing with another .",
    "the mean lifespan of an element is only around 9 - 20 mins .",
    "observationally , it makes more sense that larger , more isolated magnetic elements would be long - lived . however , since fragmentation is so frequent within our model , this is not the case for our simulations .",
    "the longest lived elements most likely occur at the beginning of the simulation before the number of magnetic elements increases to the point where they interact frequently ; or are isolated small elements that do not fragment because their flux is so low . within the synthetic magnetograms ,",
    "large , irregularly shaped features form where several individual elements lie close together but have not yet coalesced .",
    "these elements tend to appear in the network between supergranules .",
    "examples of these can be seen in the six images shown in figure  [ fig : mag ] .",
    "figure  [ fig : life](c ) shows a plot of the age of the oldest magnetic element existing within the model versus time , within the @xmath159 mx simulation .",
    "the dashed red line represents the mean maximum age averaged over the simulation .",
    "the large spikes represent occasional long - lived magnetic elements , but in general the maximum age of an element throughout the simulation remains at roughly 3 - 4 h. in every case the mean maximum age computed for the whole simulation is around this value , as can be seen in figure  [ fig : life](d ) .",
    "this is similar to the lifetime of ephemeral regions , determined by to be around 4.4 h. find the lifespan of internetwork features to be between 1 and 20 mins , with a mean of 2.9@xmath82.0 mins .",
    "the mean lifespan for magnetic elements within our model is 9 - 20 mins .",
    "the _ photospheric recycle time _ is calculated by dividing the mean field by the emergence rate . for our two most realistic simulations , @xmath159 mx and @xmath158 mx",
    ", we find the recycle time to be 1.48 h and 1.75 h respectively .",
    "this is in excellent agreement with s recycle time of 1 - 2 h.    the next section considers one of many possibilities for future studies using this theoretical model for the magnetic carpet , in this example , emergence is switched off midway through the simulation .      * *    * *    clearly , many other studies may be undertaken using our theoretical model simply by varying different input parameters to determine their effect upon photospheric evolution .",
    "one interesting test is to ` switch off ' emergence at some stage in the simulation to observe how rapidly flux disappears .",
    "an example of such a simulation was run with identical parameters to those described in section  [ results ] .",
    "the flux emergence range for newly appearing bipoles is @xmath185 mx .",
    "emergence is switched off at @xmath186 h , and the simulation is allowed to run for a further @xmath187 h. results from this experiment are shown in figure  [ fig : em ] . plot ( a ) shows the total absolute flux and ( b ) shows both the mean field and the number of elements ( @xmath188 ) throughout the simulation .",
    "it can be seen that all three of these quantities rapidly decrease as soon as emergence is switched off after @xmath187 h , levelling off and becoming steady at roughly @xmath189 h. the total number of magnetic elements becomes very small as all remaining flux within the computational box rapidly cancels and coalesces together at the supergranule boundaries .",
    "the synthetic magnetogram images ( c ) and ( d ) are taken at @xmath186 and @xmath189 h. in image ( d ) one can see the few remaining magnetic elements .",
    "they are spaced far from one another where the supergranular velocities are small at the boundaries , so they do not encounter one another before the simulation ends .",
    "if the supergranular flow profile was also allowed to evolve in time , this would likely aid the process by increasing and randomising further the motion of the remaining magnetic elements , eventually removing them completely from the simulation .",
    "the aim of this paper is to construct a realistic model for the photospheric evolution of the solar magnetic carpet , which we intend to use as a lower boundary condition of 3d non - potential modelling .",
    "we have built into this model the processes of flux emergence , cancellation , coalescence and fragmentation , as well as a steady supergranular flow profile that influences the motion of magnetic elements .",
    "many parameters for the model are taken from studies of observational solar data , such as the probability distribution for newly emerging bipoles @xcite and the peak radial velocity of a supergranule @xcite .",
    "a series of nine simulations of length 250 h were run , keeping all parameters fixed apart from the minimum value of total absolute flux , @xmath74 , that a newly emerging bipole may take .",
    "the maximum value for newly emerging bipoles was fixed at @xmath190 mx . the lower the value of @xmath74",
    "is taken to be , the larger the range of emerging flux elements is , and hence the more flux is emerged into the system . the upper bound produces a cap on the size of large elements , and we assume that we are considering a quiet area of the sun , with no input from active regions . a larger flux emergence range is more realistic so as one would expect , the lower the value of @xmath74 , the closer the simulation results agree with solar observations .    particularly for @xmath159 mx and @xmath158 mx , the total absolute flux within the simulation quickly reaches a steady state in which the rates of emergence and cancellation are roughly equal",
    ". these simulations also result in a mean magnetic field that is within the range determined from observations . for the less realistic simulations with the highest @xmath74 ( @xmath191 mx ) the total absolute flux takes longer to reach a steady state illustrated by the fact that the mean emergence rate is slightly higher than the mean cancellation rate . for low @xmath74 ,",
    "the mean field is 4 - 6 g , which fits observational data .",
    "the number of magnetic elements within each simulation very quickly reaches a steady state in all cases however .",
    "this occurs shortly after the first magnetic elements reach the boundaries of the supergranules and begin to interact with one another .",
    "although the cancellation and emergence rates , defined in mx @xmath63 day@xmath2 , become roughly equal for all simulations , it is also the case that the cancellation frequency , in @xmath63 day@xmath2 , is always greater than the emergence frequency .",
    "this is in rough agreement with the theoretical magnetic carpet model of , who attribute the difference to large numbers of cancellations between small magnetic elements arising through fragmentation .",
    "they suggest that the energy release from so many small cancellation events could significantly contribute to the energy required to heat the solar corona . in future in our 3d simulations , we will consider the energy build up at such locations .",
    "the flux distribution resulting from the simulations that include a larger range of flux emergence are in agreement with the power - law distribution of .",
    "the slope of their fitted line is -1.85 , while the slopes produced by our simulations with @xmath159 mx and @xmath158 mx are -1.85 and -1.82 respectively .",
    "our definition of magnetic elements means that our flux distribution would fit better with a downhill method of feature tracking . a feature tracking study of our synthetic magnetograms using a clumping method would be useful to check the power law , in addition to other values such as lifetimes and physical extent of magnetic elements .",
    "our model produces a highly dynamic small - scale photosphere as desired , with the mean lifespan of a magnetic element in any of the simulations being just 9 - 20 mins .",
    "we also find a photospheric recycle time of just 1.48 h , this is in good agreement with s recycle time time of 1 - 2 h.    as suggested in section  [ subsec : noem ] , an evolving supergranular flow profile is one improvement that could be made to the model . determine the average lifespan of a supergranule to be 20 h , whereas find their lifetime to be @xmath192 50 h. assign lifetimes of between 18 and 42 h to the supergranules within their model . in any case , these studies show that a magnetic carpet model that runs for longer than around a day should consider a time evolving flow pattern .",
    "the flow profile evolution could either be built into the model or taken from observational data using a method such as described by .",
    "they track solar photospheric flows by using a ball tracking technique .",
    "the fragmentation process is limitation of our model . rather than allowing fragmentation to arise naturally as a consequence of photospheric flows ,",
    "we currently impose it .",
    "this is another feature of the model that could be improved in future .",
    "the next stage in our process of constructing a non - potential coronal model for the solar magnetic carpet is the theoretical study of small - scale basic interactions between magnetic flux elements , using the technique of .",
    "this will produce a continuously evolving non - linear force - free magnetic field in response to photospheric motions @xcite .",
    "this method has recently been applied to the evolving structure of magnetic filaments @xcite , and a decaying active region observed by soho / mdi @xcite .",
    "it is useful to understand these simple interactions before moving onto more complex cases .",
    "we will later insert the synthetic magnetograms produced by this 2d model into the 3d coronal model as lower boundary data .",
    "we will study many aspects of the resultant coronal magnetic field , such as locations of electric currents , free magnetic energy , and coronal null points , as these are associated with the problem of coronal heating .",
    "it would also be of interest to conduct this study side by side with an identical study of sdo magnetogram data , for which the coronal magnetic field could also be modelled .",
    "since we know exactly which processes are occurring where within the simulated synthetic magnetograms illustrated here , we would be able to relate these with events occurring in the real magnetogram data , and study the simulated coronal field in both cases .",
    "we conclude that we have successfully produced a realistic model for the photospheric evolution of the solar magnetic carpet that reproduces many observational properties .",
    "this will now be used to produce a 3d model for the small - scale coronal magnetic field under controlled circumstances .",
    "kam would like to thank issi ( bern ) for their support of the team `` solar small - scale transient phenomena and their role in coronal heating '' , and teammates for their encouragement and support of her as a young researcher .",
    "she would also like to thank the harvard - smithsonian center for astrophysics ( boston , ma ) for their warm hospitality and helpful discussions during her six week stay in summer 2010 .",
    "kam and dhm gratefully acknowledge the support of the stfc .",
    "dhm would like to thank the royal society for their support through the research grant scheme .",
    "dhm and cep acknowledge the support of the eu - fp7 project swiff .",
    "finally , we thank the anonymous referee , who s helpful comments and suggestions have improved the paper ."
  ],
  "abstract_text": [
    "<S> + this paper describes a new 2d model for the photospheric evolution of the magnetic carpet . </S>",
    "<S> it is the first in a series of papers working towards constructing a realistic 3d non - potential model for the interaction of small - scale solar magnetic fields . in the model , the basic evolution of the magnetic elements </S>",
    "<S> is governed by a supergranular flow profile . </S>",
    "<S> in addition , magnetic elements may evolve through the processes of emergence , cancellation , coalescence and fragmentation . </S>",
    "<S> model parameters for the emergence of bipoles are based upon the results of observational studies . using this model , </S>",
    "<S> several simulations are considered , where the range of flux with which bipoles may emerge is varied . in all cases </S>",
    "<S> the model quickly reaches a steady state where the rates of emergence and cancellation balance . </S>",
    "<S> analysis of the resulting magnetic field shows that we reproduce observed quantities such as the flux distribution , mean field , cancellation rates , photospheric recycle time and a magnetic network . as expected </S>",
    "<S> , the simulation matches observations more closely when a larger , and consequently more realistic , range of emerging flux values is allowed ( @xmath0 mx ) . </S>",
    "<S> the model best reproduces the current observed properties of the magnetic carpet when we take the minimum absolute flux for emerging bipoles to be @xmath1 mx . in future </S>",
    "<S> , this 2d model will be used as an evolving photospheric boundary condition for 3d non - potential modelling . </S>"
  ]
}