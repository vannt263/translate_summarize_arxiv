{
  "article_text": [
    "connections between partial differential equations ( pde ) and stochastic processes are always heated topics in modern mathematics and provide powerful tools for both probability theory and analysis , especially for pde of elliptic and parabolic type@xcite . in the past few decades , their numerical applications have also burgeoned with a lot of developments , such as the ensemble monte carlo method for the boltzmann transport equation@xcite , the random walk method for the laplace equation@xcite and the diffusion monte carlo method for the schrdinger equation@xcite . in particular , the diffusion monte carlo method allows us to go beyond the mean - field approximation and offer a reliable ground state solution to quantum many - body systems . in this work ,",
    "we focus on the probabilistic approach to the equivalent phase space formalism of quantum mechanics , namely , the wigner function approach@xcite , which bears a close analogy to classical mechanics . in recent years",
    ", the wigner equation has been drawing growing attention@xcite and widely used in nanoelectronics@xcite , non - equilibrium statistical mechanics@xcite , quantum optics@xcite , and many - body quantum systems @xcite .",
    "actually , a branch of experiment physics in the community of quantum tomography are devoting to reconstructing the wigner function from measurements@xcite .",
    "moreover , the intriguing mathematical structure of the weyl - wigner correspondence has also been employed in the deformation quantization@xcite .",
    "in contrast to its great theoretical advantages , the wigner equation is extremely difficult to be solved because of the high dimensionality of the phase space as well as the highly oscillating structure of the wigner function due to the spatial coherence@xcite .",
    "although several efficient deterministic solvers , e.g. , the conservative spectral element method ( sem)@xcite and the third - order advective - spectral - mixed scheme ( asm)@xcite , have enabled an accurate transient simulation in 2d and 4d phase space , they are still restricted by the limitation of data storage and increasing computational complexity .",
    "one possible approach to solving the higher dimensional problems is the wigner monte carlo ( wmc ) method , which displays @xmath0 convergence ( @xmath1 is the number of samples ) , regardless of the dimensionality , and scales much better on the parallel computing platform@xcite .",
    "the proposed work is motivated by a recently developed stochastic method , termed the signed particle wigner monte carlo method ( spwmc)@xcite .",
    "this method utilizes the branching of signed particles to capture the quantum coherence , and the numerical accuracy has been validated in 2d situations @xcite .",
    "very recently , it has been also validated theoretically by exploiting the connection between a piecewise - deterministic markov process and the weak formulation of the wigner equation@xcite . in this work",
    ", we use an alternative approach to constructing the mathematical framework for spwmc from the viewpoint of computational mathematics , say , we focus on the probabilistic interpretation of the mild solution of the ( truncated ) wigner equation and its adjoint correspondence .",
    "in particular , we would like to stress that the resulting stochastic model , the importance sampling and the resampling are three cornerstones of a computable scheme for simulating the many - body wigner quantum dynamics .    our first purpose is to explore the inherent relation between the wigner equation and a stochastic branching random walk model , as sketched by the diagram below .",
    "@xmath2{\\textup{integral form } } \\boxed{\\small \\text{renewal - type equation } } \\xleftarrow{\\textup{moment } } \\boxed{\\small \\text{branching random walk}}\\ ] ] with an auxiliary function @xmath3 , we can cast the wigner equation ( as well as its adjoint equation ) into a renewal - type integral equation and prove that its solution is equivalent to the first moment of a stochastic branching random walk . in this manner",
    ", we arrive at the stochastic interpretation of the wigner quantum dynamics , termed the _ wigner branching random walk _",
    "( wbrw ) in this paper .",
    "in particular , the @xmath4-truncated wbrw method recovers the popular spwmc method which needs a discretization of the momentum space beforehand .",
    "although the probabilistic interpretation of the wigner equation naturally gives rises to a statistical method , in practice we have encountered two major problems .",
    "first , such numerical method is point - wise in nature and not very efficient in general unless we are only interested in the solution at specified points@xcite .",
    "second , the number of particles in a branching system will grow exponentially in time@xcite , indicating that the complexity increases dramatically for a long - time simulations .",
    "thus , our second purpose is to discuss how to overcome these two obstacles . as for the first",
    ", we introduce the dual system of the wigner equation and derive an equivalent form of the inner product problem , which allows us to draw weighted samples according to the initial wigner distribution . besides , by exploiting the principle of importance sampling , we can give a sound interpretation to several fundamental concepts in spwmc , such as particle sign and particle weight .",
    "for the second problem , we firstly derive the exact growth rate of branched particles , which reads @xmath5 in time @xmath6 , with @xmath7 pairs of potentials and a constant auxiliary function @xmath8 and then illustrate the basic idea of resampling to control the particle number within a reasonable size . roughly speaking",
    ", we make a histogram through the weighted particles and resample from it at the next step .",
    "such a self - consistent scheme allows us to evolve the wigner quantum dynamics in a time - marching manner and choose appropriate resampling frequencies to control the computational complexity .",
    "the rest of this paper is organized as follows .",
    "section  [ sec : wigner ] reviews briefly the wigner formalism of quantum mechanics . from both theoretical and numerical aspects , it is more convenient to discuss the truncated wigner equation , instead of the wigner equation itself .",
    "thus in section  [ sec : twigner ] , we illustrate two typical ways to truncate the wigner equation , termed the @xmath9-truncated and the @xmath4-truncated models . section  [ sec : integral_form ] manifests the equivalence between the @xmath9-truncated wigner model and a renewal - type integral equation , where an auxiliary function @xmath3 is used to introduce a probability measure .",
    "besides , the set of adjoint equation renders an equivalent representation of the inner product problem .",
    "we will show that such representation , as well as the importance sampling , plays a vital role in wmc and serves as the motivation of wbrw . in section  [ sec :",
    "branching ] , we will prove that the first moment of a branching random walk is exactly the solution of the adjoint equation .",
    "this probabilistic approach not only validates the branching process treatment , but also allows us to study the mass conservation and exponential growth of particle number rigorously .",
    "after theoretical analysis , we turn to discuss the main idea of the resampling procedure and present the numerical challenges in high dimensional problems .",
    "section  [ sec : num_res ] investigates the performance of wbrw by employing sem or asm as the reference .",
    "the paper is concluded in section  [ sec : con ] .",
    "in this section , we briefly review the wigner representation of quantum mechanics .",
    "the wigner function @xmath10 living in the phase space @xmath11 for position @xmath12 and wavevector @xmath13 , @xmath14 is defined by the weyl - wigner transform of the density matrix @xmath15 where @xmath16 gives the probability of occupying the @xmath17-th state , @xmath18 denotes the degree of freedom ( 2@xmath19particle number@xmath19dimensionality ) .",
    "although _ it possibly has negative values _ , the wigner function serves the role as a density function due to the following properties@xcite    * @xmath10 is a real function .",
    "* @xmath20 . * the average of a quantum operator @xmath21 can be written in a form @xmath22 with @xmath23 the corresponding classical function in phase space .",
    "in particular , we can define the _ wigner ( quasi- ) probability _",
    "@xmath24 on a domain @xmath25 by taking @xmath26 @xmath27    to derive the dynamics of the wigner function , we evaluate its first derivative through the schrdinger equation ( or the quantum liouville equation ) @xmath28 combine with the fourier completeness relation @xmath29 and then obtain the wigner equation @xmath30(\\bm{x } , \\bm{k } , t ) , \\label{eq.wigner}\\ ] ] where @xmath31(\\bm{x } , \\bm{k } , t ) & = \\int_{\\mathbb{r}^{d } } \\textup{d } \\bm{\\bm{k}^{\\prime } } f(\\bm{x},\\bm{k}^{\\prime},t)v_{w}(\\bm{x},\\bm{k}-\\bm{k}^{\\prime},t ) , \\label{eq : pd_operator}\\\\ v_{w}(\\bm{x},\\bm{k},t)&=\\frac{1}{\\mi\\hbar ( 2\\pi)^{d}}\\int_{\\mathbb{r}^{d } } \\text{d}\\bm{y } \\me^{-\\mi\\bm{k}\\cdot \\bm{y}}d_{v}(\\bm{x } , \\bm{y } , t ) , \\label{wigner_kernel } \\\\ d_{v}(\\bm{x } , \\bm{y } , t)&=v(\\bm{x}+\\frac{\\bm{y}}{2 } , t)-v(\\bm{x}-\\frac{\\bm{y}}{2 } , t ) .",
    "\\label{dv}\\end{aligned}\\ ] ] here the nonlocal pseudo - differential term @xmath32(\\bm{x } , \\bm{k } , t)$ ] contains the quantum information , @xmath33 denotes a central difference of the potential function @xmath34 , the wigner kernel @xmath35 is defined through the fourier transform of @xmath33 , @xmath36 is the reduced planck constant and @xmath37 is the particle mass ( for simplicity , we assume all particles have the same mass throughout this work ) .",
    "equivalently , we can first perform the integration in @xmath38-space and arrive at another way to formulate the pseudo - differential term @xmath31(\\bm{x } , \\bm{k } , t)&=\\frac{1}{\\mi \\hbar}\\int_{\\mathbb{r}^{d } } { \\textup{d}}\\bm{y } d_{v}(\\bm{x},\\bm{y } , t ) \\widehat{f}(\\bm{x } , \\bm{y } , t ) \\me^{-\\mi \\bm{k}\\cdot \\bm{y } } , \\label{eq : pd_operator_1}\\\\ \\widehat{f}(\\bm{x } , \\bm{y } , t)&=\\frac{1}{(2\\pi)^{d } } \\int_{\\mathbb{r}^{d } } { \\textup{d}}\\bm{k}^{\\prime } f(\\bm{x } , \\bm{k}^{\\prime } , t ) \\me^{\\mi \\bm{k}^{\\prime}\\cdot \\bm{y}}:=\\mathcal{f}^{-1}\\left[f\\right](\\bm{x } , \\bm{y } , t ) .",
    "\\label{eq : fhat}\\end{aligned}\\ ] ] actually , @xmath39 is just another notation for @xmath40 .",
    "one of the most important properties of the wigner equation lies in the anti - symmetry of the wigner kernel @xmath41 then a simple calculation yields @xmath42 which corresponds to the conservation of the zeroth moment ( i.e. , total particle number or mass ) @xmath43    although the wigner equation is completely equivalent to the schrdinger equation in the full space , we would like to point out that such an equivalence is not necessarily true for the truncated wigner equation ( see , e.g.@xcite ) , since for example the truncation of @xmath44-domain may break the fourier completeness relation  . therefore , we must be more careful when doing benchmark tests for stochastic wigner simulations by adopting the schrdinger wavefunction as the reference@xcite , because the underlying models may not be the same .",
    "this also gives rise to the demanding for highly accurate deterministic algorithms , such as sem@xcite and asm@xcite , which can be used to produce a reliable reference solution as already did in@xcite .",
    "in order to numerically solve the wigner equation , we need to discuss the truncated wigner equation on a bounded domain .",
    "it should be noted that the double integrations with respect to @xmath45 and @xmath44 in the pseudo - differential operator ( see eq .   or ) involves the infinite domain due to the fourier transform nature , posing a formidable challenge in seeking numerical approximations . intuitively , an feasible way is either truncating @xmath13-space first or truncating @xmath44-space first , denoted below by the @xmath9-truncated and @xmath4-truncated models , respectively .",
    "it is worth noting that no matter what kind of truncation we choose , the mass conservation   should be maintained in the resulting model as the physical requirement , which may yield additional constraints .",
    "a feasible way to formulate the wigner equation in a bounded domain is to exploit the decay of the wigner function when @xmath46 .",
    "thus we only need to evaluate the wigner function @xmath10 in a finite domain @xmath47\\times [ -l_{2 } , l_{2}]\\cdots \\times [ -l_{d } , l_{d}]$ ] ( @xmath48 ) and a simple nullification can be adopted outside @xmath49 , that yields the @xmath9-truncated wigner equation @xmath50 with the truncated wigner kernel @xmath51 where the rectangular function @xmath52 is given by @xmath53 the truncated wigner kernel @xmath54 in eq .",
    "is used only in the case that the close form of @xmath55 is not available . according to eq .",
    ", it deserves to be mentioned that only a restriction of the wigner kernel on a finite bandwidth @xmath56\\times [ -2l_{2 } , 2l_{2}]\\cdots \\times [ -2l_{d } , 2l_{d}]$ ] ( i.e. , @xmath57 when both @xmath13 and @xmath45 belong to @xmath58 ) is required .",
    "furthermore , it can be easily verified that @xmath59 and thus @xmath60 we expect that any reliable deterministic or stochastic method should preserve this property",
    ".    in general , the truncated wigner kernel @xmath54 can be evaluated by the poisson summation formula @xmath61,\\ ] ] provided that @xmath62 decays for @xmath63 with @xmath64 . here",
    "@xmath65 with @xmath66 being the spacing and @xmath67 .",
    "in this situation , we need to add the constraint@xcite @xmath68 to both maintain the mass conservation and avoid the overlapping between @xmath69 and its adjacent image .    to sum up",
    ", we would like to list several advantages of the @xmath9-truncated model .    * the @xmath9-truncated wigner equation is defined over the continuous @xmath13-space and thus a continuous momentum sampling can be allowed @xcite . *",
    "it preserves the definition of the wigner kernel and avoids the artificial periodic extension of @xmath33 in @xmath44-space .",
    "* when the weyl - wigner transform of @xmath70 has a close form , we can obtain the explicit formula of the wigner kernel and avoid the artificial periodic extension of @xmath55 in @xmath13-space .    the price to pay",
    "is that the sampling in the continuous @xmath13-space needs intricate techniques , such as a rejection - acceptance method or the markov chain monte carlo strategies .",
    "the other way , used in@xcite , is based on the fact that the inverse fourier transformed wigner function @xmath39 defined in eq .",
    "decays when @xmath71 .",
    "thus , we can focus on @xmath39 on a bounded domain @xmath72\\times [ -l_{2 } , l_{2}]\\cdots \\times [ -l_{d } , l_{d}](l_i>0)$ ] , and define the truncated pseudo - differential operator as @xmath73(\\bm{x } , \\bm{k } , t)=\\frac{1}{\\mi \\hbar}\\int_{\\mathcal{y } } { \\textup{d}}\\bm{y } d_{v}(\\bm{x},\\bm{y } , t)\\widehat{f}(\\bm{x } , \\bm{y } , t ) \\me^{-\\mi \\bm{k}\\cdot \\bm{y}}.\\ ] ] with the assumption that it decays at @xmath74 , we can evaluate @xmath39 at a finite bandwidth through the poisson summation formula @xmath75 , ~~ \\bm{y}\\in \\mathcal{y},\\ ] ] where @xmath76 with @xmath77 being the spacing , @xmath78 , @xmath79 .",
    "substituting eq .   into eq",
    ".   leads to @xmath80(\\bm{x } , \\bm{k } , t ) & \\approx \\sum_{\\bm{m } \\in \\mathbb{z}^{d } } f(\\bm{x } , \\bm{m } \\delta \\bm{k } , t)\\tilde{v}_{w}(\\bm{x } , \\bm{k}-\\bm{m}\\delta \\bm{k } , t ) , \\label{eq : pd_operator_sum}\\\\ \\tilde{v}_{w}(\\bm{x } , \\bm{k } , t)&=\\frac{1}{\\mi \\hbar}\\frac{1}{\\left|\\mathcal{y}\\right| } \\int_{\\mathcal{y}}{\\textup{d}}\\bm{y } ~d_{v}(\\bm{x } , \\bm{y } , t ) \\me^{-\\mi \\bm{y } \\cdot \\bm{k}}.\\label{eq : vwtilde}\\end{aligned}\\ ] ] here we have let @xmath81 and used the constraint @xmath82 which serves as the sufficient and necessary condition to establish the semi - discrete mass conversation @xmath83    suppose the wigner function at discrete samples @xmath84 are wanted , then we immediately arrive at the @xmath4-truncated ( or semi - discrete ) wigner equation @xcite @xmath85 which indeed provides a straightforward way for stochastic simulations as used in the spwmc method , and possesses the following properties .",
    "* the modified wigner kernel @xmath86 in eq .   can be treated as the fourier coefficients of @xmath33 ( with a periodic extension ) , and can be recovered by the inverse fourier transform ( possibly by the inverse fast fourier transform ) . *",
    "the continuous convolution is now replaced by a discrete convolution ( see eqs .   and ) , so that the sampling in discrete @xmath13-space can be simply realized in virtue of the cumulative distribution function .",
    "* the set of equidistant sampling in @xmath13-space facilitates the data storage and the code implementation .",
    "although both truncated models approximate the original problem in some extent , their range of applicability is different .",
    "in fact , the modified wigner potential @xmath86 in @xmath4-truncated model is not a trivial approximation to the original wigner potential ( one can refer to the difference between the fourier coefficients and continuous fourier transformation ) .",
    "the convergence @xmath87 is only valid when @xmath88 , or the potential @xmath34 decays rapidly at the boundary of the finite domain ( but this condition is not satisfied for , e.g. , the coulomb - like potential , especially for the coulomb interaction between two particles ) .",
    "by contrast , the @xmath9-truncated model is based on relatively milder assumption , and it is not necessary to change the definition of the wigner kernel unless the poisson summation formula is used .",
    "thus we would like to stress that _ the @xmath9-truncated wigner equation is more appropriate for simulating many - body quantum systems _ and thus adopted hereafter .",
    "in order to establish the connection between the deterministic partial integro - differential equation   and a stochastic process , we need to cast the deterministic equation into a renewal - type integral equation . for this purpose ,",
    "the first crucial step is to introduce an exponential distribution in its integral formulation via _ an auxiliary function @xmath89_. the second one is to split the wigner kernel into several positive parts@xcite , such that each part can be endowed with a probabilistic interpretation .",
    "more importantly , to make the resulting branching random walk computable , we derive the adjoint equation of the wigner equation and obtain an equivalent representation of the inner product  , which explicitly depends on the initial wigner distribution .",
    "therefore , it provides a much more efficient way to draw samples on the phase space , and naturally gives rise to several important features of spwmc , such as the particle sign and particle weight .",
    "the first step is to cast eq .   into a renewal - type equation . to this end",
    ", we can introduce an auxiliary function @xmath3 and add the term @xmath90 in both sides of eq .  , yielding @xmath91 . \\label{eq.wigner_equiv } \\end{split}\\ ] ] at this stage , we only consider a nonnegative bounded @xmath3 , though a time - dependent @xmath92 can be also introduced if necessary and analyzed in a similar way .",
    "in particular , _ we strongly recommend the readers to choose a constant @xmath93 _ in real applications , for the convenience of both theoretical analysis and numerical computation ( vide post ) .",
    "formally , we can write down its integral formulation through the variation - of - constant formula @xmath94 f(\\bm{x } , \\bm{k } , t^{\\prime } ) \\textup{d}t^{\\prime } , \\end{split}\\ ] ] where @xmath95 denotes the semigroup generated by the operator @xmath96 and @xmath97 is the convolution operator which is assumed to be a bounded operator throughout this work .",
    "when @xmath3 is bounded , it only imposes a lyapunov perturbation on a hyperbolic system , so that the operator @xmath95 is also a @xmath98-semigroup@xcite . to further determine how the operator @xmath95 acts on a given function @xmath99)$ ] , we need to solve the following evolution system @xmath100 after performing the coordinate conversion@xcite @xmath101 we obtain @xmath102 where @xmath103 and @xmath104 .",
    "the solution to the above system reads @xmath105 replacing @xmath106 by @xmath107 and making a shift @xmath108 in eq",
    ".   leads to @xmath109 where @xmath110 is termed the _ backward - in - time trajectory _ of @xmath111 with a positive time increment @xmath112 .",
    "after a simple variable substitution ( @xmath113 ) , the integral formulation of the wigner equation becomes @xmath114f(\\bm{x}(t - t^{\\prime } ) , \\bm{k } , t^{\\prime } ) .",
    "\\end{split}\\ ] ] let @xmath115 and assume the auxiliary function satisfies @xmath116 then we have @xmath117 implying that @xmath118 is a probability measure with respect to @xmath119 for a given @xmath120 on @xmath121 , characterized by the auxiliary function @xmath3 . substituting this measure into eq .",
    "gives @xmath122 f(\\bm{x}(t ) , \\bm{k } , 0)+ \\int_{0}^{t } { \\textup{d}}\\mathcal{h}(t^{\\prime } ; \\bm{x } , t ) \\times\\\\ & \\int_{\\mathcal{k } } { \\textup{d}}\\bm{k}^{\\prime}~   f(\\bm{x}(t - t^{\\prime } ) , \\bm{k}^{\\prime } , t^{\\prime } )   \\left\\{\\frac{v_{w}(\\bm{x}(t - t^{\\prime } ) , \\bm{k}-\\bm{k}^{\\prime } , t^{\\prime})}{\\gamma(\\bm{x}(t - t^{\\prime}))}+\\delta(\\bm{k}-\\bm{k}^{\\prime})\\right\\ } , \\end{split}\\ ] ] which can be regarded as _ a kind of renewal - type equation _ in the renewal theory@xcite .",
    "next we turn to consider the wigner kernel @xmath55 , that can not be regarded as a transition kernel directly due to possible negative values .",
    "nevertheless , we can regard it as the linear combination of positive semidefinite kernels .",
    "in general , the wigner kernel @xmath123 is composed of @xmath7 parts @xmath124 that corresponds to the potential @xmath125 , then the wigner kernel can be split into @xmath7 pairs @xmath126 such splitting of @xmath123 is rather important in dealing with many - body systems since combining it with the fourier completeness relation helps to reduce the wigner interaction term into lower dimensional integrals .",
    "owing to the anti - symmetry of @xmath55 ( see eq .  ) , it can be easily verified that @xmath127 thus , it suffices to define a function @xmath128 on @xmath129 , composed of three terms @xmath130    finally , the @xmath9-truncated wigner equation   can be cast into a fredholm integral equation of the second kind @xmath131 where @xmath132    before discussing the probabilistic approach to the integral equation  , we would like first to derive its adjoint equation and attain an equivalent representation of @xmath133 , which serves as the cornerstone of wbrw .      in quantum mechanics ,",
    "it s usually more important to study macroscopically observes @xmath134 , such as the averaged position of particles , electron density , etc , than the wigner function itself . in this regard",
    ", we turn to consider the inner product problem @xmath135 on the domain @xmath136 and a finite time interval @xmath137 $ ] .",
    "for instance , to evaluate the average value @xmath138 at a given final time @xmath139 , we should take @xmath140 then @xmath141    the main goal of this section is to give the explicit formulation of the adjoint equation , starting from eq .   and eq .  . for brevity , we will assume that the potential is time - independent , and thus the kernels becomes @xmath142 \\delta(\\bm{x}-\\bm{x}^{\\prime}).\\end{aligned}\\ ] ]    suppose the kernel @xmath143 is bounded , then it is easy to verify that @xmath144 is a bounded linear operator .",
    "accordingly , we can define the adjoint operator @xmath145 by @xmath146 applying theorem 4.6 in@xcite directly into the fredholm integral equation of the second kind yields @xmath147    formally , it suffices to define @xmath148 since @xmath149 we have @xmath150 namely @xmath151 furthermore , we perform the coordinate conversion @xmath152 with which the jacobian determinant @xmath153 implying the volume unit keeps unchanged ( i.e. , @xmath154 ) , and thus eq .   becomes @xmath155 where we have introduced a _",
    "forward - in - time trajectory _ ( in contrast to the backward - in - time trajectory @xmath156 given in eq .  ) as follows @xmath157 with @xmath158 being the time increment .",
    "actually , eq .   motivates us to combine the exponential factor with @xmath159 and define a new function @xmath160 as @xmath161 please keep in mind that , it is required @xmath162 for convenience in the definition  , before which @xmath163 is always assumed , for example , see eq .  .",
    "consequently , from eq .  , the inner product   can be determined _ only by the ` initial ' data _ , as stated in the following theorem .",
    "the average value @xmath138 of a macroscopic quantity @xmath23 at a given final time @xmath139 can be evaluated by @xmath164 where @xmath165 is defined in eq .  .",
    "according to eq .",
    ", in order to evaluate @xmath166 , the remaining task is to calculate @xmath167 . to this end",
    ", we need first to obtain the expression of @xmath168 from the dual system .    replacing @xmath169 by @xmath170 and performing the coordinate conversion @xmath171 , @xmath172 , @xmath173 in eq .",
    "yield @xmath174 where the trajectory @xmath175 reads @xmath176 which is _ not _ the same as @xmath177 given in eq .",
    "since the underlying wavevectors @xmath178 and @xmath179 are different ! substituting eq .   into eq",
    ".   leads to @xmath180 where @xmath181 from the dual system , we can also obtain a similar expression to eq .   for @xmath182 , and then corresponding time integration with respect to @xmath183 in eq .",
    "becomes @xmath184 where @xmath185    combining eq .   and",
    "the definition   directly gives the adjoint equation for @xmath165 as stated in theorem  [ th : adjoint ] .",
    "[ th : adjoint ] the function @xmath160 defined in eq .",
    "satisfies the following integral equation @xmath186    we call eq .   the adjoint equation of eq .   is mainly because @xmath187 and @xmath188 constitute a dual system in the bilinear form   ( denoted by @xmath189 ) for determining @xmath190 . combining the formal solution @xmath191 of the wigner equation   as well as eqs .   and directly yields @xmath192 in consequence ,",
    "we formally obtain @xmath193 with @xmath194 being the adjoint operator of @xmath195 , indicating that eq .  , in some sense , can be treated as an inverse problem of eq .  , which produces a quantity @xmath188 from the observation @xmath196 at the ending time @xmath139 .",
    "moreover , for given @xmath197 on @xmath198 , we can similarly introduce a probability measure with respect to @xmath119 like @xmath199 because of @xmath200 under the assumption that the auxiliary function satisfies @xmath201 substituting the measure   into eq .   also yields a renewal - type equation @xmath202 a(\\bm{r}(t - t ) , \\bm{k})\\\\ & + \\int_{t}^{t } { \\textup{d}}\\mathcal{g}(t^{\\prime } ; \\bm{r } , t )   \\int_{\\mathbb{r}^d } { \\textup{d}}\\bm{r}^{\\prime } \\int_{\\mathcal{k } } { \\textup{d}}\\bm{k}^{\\prime }   \\frac{\\gamma(\\bm{r}^{\\prime } , \\bm{k}^{\\prime } ; \\bm{r}(t^{\\prime}-t ) , \\bm{k})}{\\gamma(\\bm{r}(t^{\\prime}-t ) ) } \\varphi(\\bm{r}^{\\prime } , \\bm{k}^{\\prime } , t^{\\prime } ) .",
    "\\end{split}\\ ] ]      before launching into the details of probabilistic interpretation , we would like to emphasize the central role of eq .   in computation .",
    "hereto we have shown in eq .   that the average @xmath166 can be evaluated by sampling from the initial wigner function @xmath203 and solving the adjoint equation for @xmath188 , instead of the direct calculation based on @xmath204 as shown in eq .  .",
    "actually , the bilinear form   for determining @xmath166 serves as the foundation of wbrw in which the importance sampling plays a key role .    regarding of the fact that the wigner function may take negative value , we have to introduce an _ instrumental probability distribution _ @xmath205",
    "as follows @xmath206 where @xmath207 is the normalizing factor ( we assume @xmath208 ) @xmath209    now the inner product problem can be evaluated through the importance sampling .",
    "owing to the markovian property of the linear evolution system , it suffices to divide the time interval @xmath210 $ ] into @xmath211 steps , denoted by @xmath212 with @xmath213 , and set @xmath214 as the initial condition .",
    "then we have @xmath215 where @xmath216 discrete samples @xmath217 generated from the instrumental probability distribution @xmath218 , and the ` weight ' @xmath219 reads @xmath220 with @xmath221 being either @xmath222 or @xmath223 due to eq .  .",
    "in fact , the estimator adopted in eq .",
    "implicitly utilizes the strong law of large number @xmath224 it must be emphasized here that the sign function @xmath225 indicates that every super - particle must be endowed with a sign , either positive or negative , for resolving the possible negative part of the wigner function . actually , the concept of signed particles , which emerges naturally here via the importance sampling , is the intrinsic feature of spwmc , that is never seen in classical vlasov or boltzmann simulations .",
    "in particular , the wigner probability on arbitrary domain @xmath25 can be estimated by @xmath226 with @xmath227 .",
    "this motivates us to estimate the wigner function at @xmath228 by the piecewise constant function @xmath229 where @xmath230 gives a partition of @xmath231 , and @xmath232 denotes the volume of @xmath233 and @xmath234 .",
    "in fact , eq .",
    "is the basis of the resampling procedure , which will be discussed in section 5.3 . combining eqs .   and allows us to solve the wigner equation through a time - marching scheme .",
    "the remaining problem is how to estimate @xmath235 , which can be replaced by an additive functional of @xmath23 , as shown in the next section .",
    "hence @xmath236 is evaluated by a purely particle - based scheme in which every super - particle , carrying a weight and a sign , is moving according to several specific rules in the branching particle system .",
    "this section is devoted to the probabilistic interpretation of the adjoint equation . owing to the fact that all the moments of a branching process satisfy the renewal - type equations@xcite",
    ", it motivates us to construct a stochastic branching random walk such that its expectation is equal to the unique solution of eq .  .",
    "in addition to validating wbrw , we also analyze the inherent mass conservation property and derive the exact growth rate of particle number .",
    "most of deductions can be straightforwardly generalized to the ( @xmath9-truncated ) wigner equation due to the strong similarities between eqs .   and .",
    "after the theoretical analysis , we turn to some numerical aspects and discuss the idea of resampling , which is aimed at suppressing the exponential growth of particle number .",
    "it is closely linked to the non - parameter density estimation and presents several challenges in high dimensional cases , as also found in the statistical learning and classification .",
    "finally , we will outline the procedures of the statistical algorithm .      to illustrate the main theorem more clearly",
    ", we first introduce a probabilistic model , a branching particle system associated with an exit system , to describe the wbrw in a picturesque language .",
    "the exit system means that a particle in the branching system will be frozen when its life - length exceeds the final time @xmath139 .",
    "all related rigorous analysis is left for the next subsection .",
    "consider a system of particles moving in @xmath237 $ ] according to the following rules . without loss of generality , the particle ,",
    "starting at time @xmath6 at state @xmath238 , having a random life - length @xmath239 and carrying a weight @xmath240 , is marked .",
    "the chosen initial data corresponds to those adopted in the renewal - type equation  .",
    "rule 1 : :    the motion of each particle is described by a right continuous markov    process .",
    "rule 2 : :    the particle at @xmath238 dies in the age time    interval @xmath241 with probability    @xmath242 , which depends on its    position @xmath243 and the time @xmath6 ( see eq .  ) .    in particular , when using the constant auxiliary function    @xmath244 , the particle dies during time    interval @xmath245 with probability    @xmath246    for small @xmath247 , which is totally independent of    both its position and age . rule 3 : :    if @xmath248 , the particle dies at age    @xmath249 at state    @xmath250 , and produces @xmath251    new particles at states    @xmath252 ,    @xmath253 ,    @xmath254 ,    @xmath255 ,    endowed with updated weights @xmath256 ,    @xmath257 , @xmath254 ,    @xmath258 , respectively .",
    "all these parameters    can be determined by the kernel function in eq .",
    ":    @xmath259 and thus for @xmath260    @xmath261    where the function @xmath262 is the normalizing    factor for both @xmath263 and    @xmath264 , i.e. , @xmath265    because of the mass conservation  , and @xmath266 rule 4 : :    if @xmath267 , say , the life - length of the particle    exceeds @xmath268 , so it will immigrate to the state    @xmath269 and be frozen .",
    "this rule    corresponds to the first right - hand - side term of eq .  , and",
    "the related    probability is    @xmath270 rule 5 : :    the only interaction between the particles is that the birth time and    state of offsprings coincide with the death time and state of their    parent .    in eqs .   and",
    ", we require that @xmath271 and @xmath272 can be normalized , which is not necessarily true for @xmath273 . nevertheless , when the convolution operator @xmath274 is bounded and @xmath10 decays in @xmath49-space sufficiently rapidly , we can approximate the solution of the wigner equation by the @xmath9-truncated correspondence because of the boundedness of the semigroup @xmath95 and @xmath275 thus it suffices to restrict our discussion on the @xmath9-truncated wigner equation and its adjoint counterpart .",
    "now we present the main result .",
    "let @xmath276 be the index set of all frozen particles with the same ancestor initially at time @xmath277 at state @xmath278 carrying the weight @xmath279 , @xmath280 denote the collection of corresponding frozen states , and @xmath281 the updated weight of the @xmath17-th particle .",
    "accordingly , the adjoint equation is solved by @xmath282 where @xmath283 means the expectation with respect to the probability law defined by the above five rules ( its definition is left in section [ sec : branching : analysis ] ) .",
    "furthermore , from eq .  , the quantity @xmath138 is solved by @xmath284,\\ ] ] where @xmath285 means the expectation with respect to @xmath205 .",
    "the proof of eqs .   and",
    "is left for section [ sec : branching : analysis ] .      in the theory of branching process ,",
    "all the moments of an age - dependent branching processes satisfy renewal - type integral equations@xcite , where the term `` age - dependent '' means the probability that a particle , living at @xmath6 , dies at @xmath286 might not be a constant function of @xmath6 . in this regard",
    ", it suffices to define a stochastic branching markov process ( continuous in time parameter ) , corresponding to the branching particle system as described earlier .",
    "the random variable of a branching particle system is the family history , a denumerable random sequence corresponding to a unique family tree .",
    "firstly , we need a sequence to identify the objects in a family . beginning with an ancestor , denoted by @xmath287 , and we can denote its @xmath37-th children by @xmath288 . similarly , we can denote the @xmath289-th child of @xmath17-the child by @xmath290 , and thus @xmath291 means @xmath292-th child of @xmath293-th child of @xmath254 of the @xmath294-child of the @xmath295-th child , with @xmath296 .",
    "the ancestor @xmath287 is omitted here and hereafter for brevity .",
    "our branching particle system involves three basic elements : the position @xmath243 ( or @xmath12 ) , the wavevector @xmath13 and the life - length @xmath239 , and each particle will either immigrate to @xmath297 , then be killed and produce three offsprings , or be frozen when hitting the first exit time @xmath139 .",
    "now we can give the definition of a family history , starting from one particle at age @xmath6 at state @xmath238 .",
    "in the subsequent discussion we let @xmath298 .    a family history @xmath299 stands for a random sequence @xmath300 where the tuple @xmath301 appears in a definite order of enumeration .",
    "@xmath302 , @xmath303 , @xmath304 denote the life - length , starting position and wavevector of the @xmath17-th particle , respectively .",
    "the exact order of @xmath305 is immaterial but is supposed to be fixed .",
    "the collection of all family histories is denoted by @xmath306 .    at this stage , the initial time @xmath6 and the initial state @xmath307 of the ancestor particle @xmath287",
    "are assumed to be non - stochastic .    for each @xmath308 ,",
    "the subfamily @xmath309 is the family history of @xmath310 and its descendants , defined by @xmath311 .",
    "the collection of @xmath312 is denoted by @xmath313 .",
    "equivalently , we can also use the time parameter to identity the path of a particle and all its ancestors in the family history , and denote @xmath314 its state ( i.e. , starting position and wavevector ) at time @xmath315 . taking the particle @xmath316 as an example , we have @xmath317 with @xmath318 , @xmath319 with @xmath320 and @xmath321 , @xmath322 with @xmath323 and @xmath324 , @xmath254 . to characterize the freezing behavior of the particle",
    ", we denote the first exit time by @xmath139 , as boundary conditions are not specified .",
    "[ def : frozen ] suppose the family history starts at time @xmath6 . then a particle @xmath325 is said to be frozen at @xmath139 if the following conditions hold @xmath326 in particular , when @xmath327 , the ancestor particle @xmath287 is frozen . sometimes the particle @xmath328 is also called alive in the time interval @xmath329 $ ] .",
    "the collection of frozen particles is denoted by @xmath330 .",
    "the first exit time @xmath331 from an open set @xmath332 is defined by @xmath333 since a boundary condition is not applied yet , we have @xmath334 with @xmath335 being an open cover of @xmath49 , and thus @xmath336 .",
    "@xmath337 uniquely determines a family history tree , as shown in fig .",
    "[ fig : branching_tree ] .",
    "@xmath338 is a subfamily history that describes the family history of @xmath339 and its descendants , and we have @xmath340 .",
    "the collection of frozen particles is @xmath341 .",
    "hereafter we assume that all particles in the branching particle system will move until reaching the frozen state , and still use @xmath306 to denote the collection of the family history of all frozen particles .",
    "now we need to define a probability measure @xmath342 on @xmath306 , corresponding to the branching process started from state @xmath238 at time @xmath6 .",
    "for the borel sets @xmath343 , @xmath344 on @xmath306 , let @xmath345 , then the probability of the event @xmath346 is @xmath347 with @xmath348 ( @xmath349 ) .",
    "here the transition densities @xmath350 and @xmath351 are given by ( @xmath260 ) @xmath352 where @xmath242 has been defined in eq .",
    "and the random life length @xmath353 satisfies @xmath354 .",
    "@xmath355 corresponds to a random walk . combining with the independence assumption in rule 5 , we are able to define a probability measure @xmath342 on @xmath306 as follows @xmath356 as well as a stochastic branching process @xmath357 . moreover , from eq .",
    ", we can easily verify the following markov property of the stochastic process @xmath357",
    "@xmath358 for any function @xmath359 in a measurable space @xmath360 } \\otimes \\mathcal{f}_{[t , t+\\tau]})$ ] and any function @xmath361 in @xmath362})$ ] , where @xmath363 is the @xmath364-algebra on @xmath365 , @xmath366 is the @xmath364-algebra generated by @xmath314 with @xmath367 , and @xmath368 . that is , _ events observable before and after time @xmath369 are conditionally independent for given state @xmath370_.    since @xmath371 corresponds to a denumerable random sequence , the basic theorem of kolmogorov ( see theorem 6.16 , @xcite ) ensures the existence and uniqueness of such a random process @xmath372 with the probability measure @xmath342 defined on the borel extension @xmath373 of the cylinder sets on @xmath306@xcite .",
    "next we need to define a signed measure valued function @xmath374 through the particle weights and the frozen states , where @xmath375 and @xmath376 stands for the borel cylinder sets on @xmath306 .",
    "according to rule 4 , the frozen state of a particle @xmath377 is @xmath378 with @xmath379 , and the frozen state of @xmath287 is @xmath380 .",
    "[ eq : exit ] suppose @xmath381 is the starting state of a frozen particle @xmath17 in a given family history @xmath299 , and let @xmath382 mean the unit measure concentrated at state @xmath238 .",
    "then we define the exit measure as follows @xmath383 where @xmath384 is the cumulative weight of particle @xmath17 . for an object @xmath385 , @xmath384 is given by @xmath386 where @xmath279 is the initial weight of the ancestor and the function @xmath387 has been defined in eq .  .",
    "moreover , for given @xmath299 and function @xmath196 , we can further define a random integral on the point distribution @xmath388 to ensure a bounded weight , we require @xmath389 for any @xmath390 and @xmath391 .",
    "the first moment of random function @xmath392 is denoted by @xmath393 which reads @xmath394    suppose the ancestor starts at @xmath277 carrying the initial weight @xmath395 . for the family history @xmath299 displayed in fig .",
    "[ fig : branching_tree ] , the random integral @xmath396 is @xmath397    in order to study the particle number in the branching particle system with the family history @xmath299 starting from time @xmath6 , we use a random function @xmath398 to stand for the total number of frozen particles at the final instant @xmath139 . in consequence , the first moment of @xmath398 is @xmath399 which also gives the expectation of the total number of alive particles in time interval @xmath329 $ ] , and should be finite ( see theorem  [ th : finite ] ) .",
    "this further means that @xmath398 is finite almost surely . as the easier case",
    ", the finiteness of @xmath400 for the constant auxiliary function is directly implied from theorem 13.1 and its corollary of chapter vi in  @xcite .",
    "[ th : finite ] suppose the family history @xmath299 starts at time @xmath6 at state @xmath238 , and ends at @xmath139",
    ". then @xmath401 and as a consequence @xmath402 .    .",
    "we define a random function @xmath403 when the particle @xmath328 appears in the family history @xmath299 , otherwise @xmath404 . from eq .   and",
    "definition  [ def : frozen ] , we have @xmath405    let @xmath406 that corresponds to the number of particles born up to the final time @xmath139 .",
    "it is obvious that @xmath407    for constant @xmath408 , we introduce an exponential distribution @xmath409 and define its @xmath211-th convolution by @xmath410 it can be readily verified that @xmath411 , ~ \\forall \\,\\bm{r}\\in\\mathbb{r}^d , ~ \\forall \\ , u\\in [ 0,t],\\ ] ] holds for a sufficiently large integer @xmath9 , e.g. , @xmath412 .",
    "we first show by the mathematical induction that there exists a sufficient large integer @xmath9 and a sufficient large constant @xmath413 such that @xmath414.\\ ] ]    for @xmath415 , we only need @xmath416 and then have @xmath417    assume eq .",
    "is true for @xmath211 .",
    "direct calculation shows @xmath418 which implies that eq",
    ".   holds for @xmath419 , where @xmath364 is short for @xmath420 .    finally , using eqs .",
    "and yields @xmath421 and implies @xmath422 is bounded for the infinite series is convergent ( see lemma 1 of the appendix to chapter vi in  @xcite ) . hence the proof is completed according to eq .  .",
    "moreover , according to definition  [ eq : exit ] and theorem  [ th : finite ] , we can directly show that @xmath423 is integrable , say , @xmath424 provided that @xmath425 is essentially bounded .",
    "that is , both @xmath423 in eq .   and @xmath426 in eq .",
    "are well defined .    with the above preparations , we begin to prove eqs .   and .",
    "[ th : psi ] the first moment @xmath393 defined in eq .",
    "equals to the solution of the adjoint equation  .",
    "let @xmath427 correspond to the case in which the particle travels to @xmath269 and then is frozen .",
    "the probability of such event is @xmath428 by rule 4",
    ". then the remaining case is denoted by @xmath429 .",
    "accordingly , from eq .  , we have @xmath430 and direct calculation gives @xmath431 which recovers the first right - hand - side term of eq .  .",
    "when event @xmath432 occurs , it indicates that @xmath251 offsprings are generated . notice that @xmath433 and thus we have @xmath434 where we have applied rule 3 .",
    "substitute eq .   into the second right - hand - side term of eq",
    ".   leads to @xmath435 where we have used the markov property   as well as the mutual independence among the subfamilies inherited in rule 5 .    finally , by the definition",
    ", we have @xmath436 then the first right - hand - side term of eq .   becomes @xmath437 where we have let @xmath438 and used eqs .   and .",
    "the remaining right - hand - side term of eq .",
    "terms can be treated in a similar way , and putting them together recovers the second right - hand - side term of eq .  .",
    "we complete the proof .",
    "so far we have proven the existence of the solution of the adjoint equation  , while its uniqueness can be deduced by the fredholm alternative .",
    "it remains to validate eq .  .",
    "to this end , we let @xmath439 be a probability measure on the borel sets of @xmath231 with the density @xmath440 , then it yields a unique product measure @xmath441 . consequently , from eq .  , we obtain @xmath442 \\cdot \\frac{f(\\bm{r } , \\bm{k } , 0)}{f_i(\\bm{r } , \\bm{k } , 0 ) } ~   \\nu({\\textup{d}}\\bm{r}\\times { \\textup{d}}\\bm{k } ) \\\\ = & \\iint_{\\mathbb{r}^d \\times \\mathcal{k } \\times \\omega } \\mu_a ( \\omega )   \\cdot \\frac{f(\\bm{r } , \\bm{k } , 0)}{f_i(\\bm{r } , \\bm{k } , 0 ) } ~ \\nu\\otimes\\pi_{0 , \\bm{r } , \\bm{k}}({\\textup{d}}\\bm{r } \\times { \\textup{d}}\\bm{k } \\times { \\textup{d}}\\omega )   \\\\ = & \\mathbb{e}_{f_i}\\left [ \\pi_{t_l , \\bm{r}_\\alpha , \\bm{k}_\\alpha } \\left ( s_\\alpha(0 ) \\cdot h(0 ) \\cdot \\sum_{i\\in\\mathcal{e}(\\omega_\\alpha ) } \\phi_{i,\\alpha } \\cdot a(\\bm{r}_{i,\\alpha},\\bm{k}_{i,\\alpha } ) \\right ) \\right ] , \\end{split}\\ ] ] and thus fully recover eq .",
    "( noting that @xmath276 and @xmath443 denote the same set ) .",
    "in particular , we set @xmath277 , @xmath444 , @xmath445 , and then it s easy to verify that @xmath446 is the unique solution of eq .",
    "using the mass conservation  . by theorem  [ th : psi ] , the first moment of @xmath423 also equals to 1 , i.e. , @xmath447 and then it further implies @xmath448 due to eqs .   and , which is nothing but the mass conservation law  .",
    "furthermore , for such special case , we can show in theorem [ thm_3 ] that @xmath449 is almost sure for any family history @xmath299 , not just the first moment as shown in eq .  .",
    "it implies that any estimator using finite number of super - particles is still able to preserve the mass conservation with probability @xmath223 . @xmath450",
    "[ thm_3 ] suppose that the ancestor particle starts at @xmath277 and carries a weight @xmath279 .",
    "then we have @xmath451 where the event @xmath346 is given by @xmath452    since @xmath398 only takes odd values , it suffices to take @xmath453 and it is easy to see @xmath454 . in the remaining part of the proof , we will omit @xmath455 for brevity .",
    "assume that the statement that @xmath456 is true for @xmath457 , @xmath458 $ ] .",
    "we show below by the mathematical induction that it still holds for @xmath459 .    from @xmath460",
    ", it can be easily verified that @xmath461 thus we have @xmath462 implying @xmath463 furthermore , since @xmath464 , it yields @xmath465+\\sum_{i \\in \\mathcal{e}(\\omega_{2m+1 } ) } \\phi_{i},\\ ] ] we obtain @xmath466    combining eqs .   and with the conditionally independence of @xmath467 yields @xmath468 where the induction hypothesis is applied in the last line , and thus @xmath469 .",
    "accordingly , we have @xmath470 for it is obvious that @xmath471 .",
    "finally , according to the fact that @xmath472 , we have @xmath473 due to the monotone convergence theorem .",
    "hence we complete the proof by setting @xmath277 .    in the proof of theorem  [ thm_3 ] , the latent assumption , namely , _",
    "two particles carrying the same weight but opposite sign must be generated in pair _",
    ", is required to conserve numerically the mass .",
    "now we turn to estimate the growth rate of particles in the branching system . for the constant auxiliary function @xmath474",
    ", the random life - length @xmath239 of a particle starting at time @xmath6 is characterized by an exponential distribution @xmath475 in this case , the growth of particle number has been thoroughly studied in the literature@xcite and we are able to obtain a simple calculation formula of the particle number as shown in theorem  [ th : exp ] .",
    "[ th : exp ] suppose the family history @xmath299 starts at @xmath277 and the constant auxiliary function @xmath474 is adopted .",
    "then the expectation of the total number of frozen particles in time interval @xmath210 $ ] is @xmath476    according to theorem 15.1 of chapter vi in  @xcite , the expectation @xmath477 satisfies the following renewal integral equation @xmath478 we substitute eq .   into eq .   and then can easily verify that @xmath479 is the solution .",
    "the proof is finished .",
    "considering the fact that randomly generated @xmath38 may be rejected in numerical application according to the indicator function in eq .",
    ", we can modify eq .   by replacing @xmath251 with @xmath480 , with @xmath481 the average acceptance ratio of @xmath38 . in consequence ,",
    "the modified expectation of total particle number is @xmath482 .",
    "theorem  [ th : exp ] also provides an upper bound of @xmath483 when the variable auxiliary function satisfies @xmath484 .",
    "whatever the auxiliary function is , it is clear that the particle number will grow exponentially . _ to suppress the particle number , we can either decrease the parameter @xmath408 or choose a smaller final time @xmath139_.    finally , suppose we would like to evolve the branching particle system until the final time @xmath139 .",
    "usually , there are two ways .",
    "one is to evolve the system until each particle is frozen at the final time @xmath139 in a single step .",
    "the other is to divide @xmath139 into @xmath485 with @xmath486 , and then we evolve the system successively in @xmath211 steps .",
    "however , the following theorem tells us that both produce the same @xmath483 .",
    "[ th : g(t ) ] suppose @xmath487 .",
    "then @xmath488 is a markov branching process .",
    "in addition , @xmath489 is a galton - watson process .",
    "we recall that for a galton - watson model , if @xmath490 , then @xmath491 . from eq .  , we know that @xmath492 , so that @xmath493 .",
    "therefore , we can not expect to reduce the particle number by simply dividing @xmath139 into several steps and evolve the particle system successively , which also manifests the indispensability of resampling .      as illustrated in section [ sec : importance_sample ] , it suffices to set the initial and final time to be @xmath494 and @xmath228 , respectively .",
    "thus from the integrability of @xmath423 in eq .   and the strong law of large number in eq .",
    ", we can use the following estimator to calculate eq .  .",
    "@xmath495 with ancestor particles @xmath496 drawn from @xmath497 , which converges almost surely when @xmath498 . according to eq .",
    ", we would like to point out three important features below .",
    "( 1 ) : :    it is unnecessary to know the normalizing factor @xmath207 in    eq .  , since it has been absorbed in the sign function    @xmath499 in eq .  .",
    "( 2 ) : :    it is unnecessary to take multiple replicas of branching particle    system starting from the same ancestor because we only need to    evaluate the expectation of    @xmath500 with respect    to the product measure    @xmath501 . ( 3 ) : :    theorem [ thm_3 ] ensures the mass conservation property",
    ". it must be    mentioned that the conserved quantity is the summation of particle    sign function    @xmath502 , instead of    total particle number @xmath216 .",
    "in fact , the total    particle number may increase in order to capture the negative values    of wigner function .",
    "unfortunately , theorem [ th : exp ] has presented an unpleasant property of such estimator , namely , the exponentially increasing complexity . in this",
    "regard , a resampling procedure , which is based on the statistical properties of the wigner function and density estimation method , must be introduced to save the efficiency , say , to reduce the particle number from @xmath503 to @xmath504 .",
    "the first step is to use the non - parameter density estimation method ( the histogram ) to evaluate @xmath505 through the branched particles on a given suitable partition of the phase space @xmath506 .",
    "the instrumental density @xmath507 can be simply estimated by eq .  .",
    "the successive step is to draw new samples according to the resulting piecewise constant density @xmath507 .",
    "the main problem is how to determine the phase space partition .",
    "the simplest way , as suggested in @xcite , is using the uniformly distributed cells in phase space : @xmath508 , then @xmath509 is estimated by a piecewise constant function @xmath510 with @xmath511 .",
    "then the number of particles allocated in each cell is determined by @xmath512 and the sign by @xmath513 .",
    "the position and wave vector are assumed to be uniformly distributed in each cell .",
    "this approach , usually termed _ annihilation _ in previous work , e.g. @xcite , can reduce the particle number effectively for @xmath514 and still works fairly for @xmath515 ( as shown in section [ sec : num_res ] ) .",
    "unfortunately , it can not work for higher dimensional systems because of the following problems , as also manifested in the statistical community@xcite .",
    "( 1 ) : :    in high dimensional situations , the dimension    @xmath516 of the feature space ( phase space cells )    is too much higher than the sample number , leading to a non - sparse    structure and severe over - fitting .",
    "( 2 ) : :    the uniform distributed hypercube in high - dimensional space is not    very useful to characterize the edges of samples . ( 3 ) : :    the piecewise constant function is discontinuous in nature , so that    sampling from a locally uniform distribution may cause additional    bias .    to resolve these problems , one can utilize many advanced techniques in the statistical learning and density estimation .",
    "the key point is to choose an appropriate @xmath517 ( or feature in statistical terminology ) of the partition . in principle",
    ", @xmath517 must be chosen to strike the balance between accuracy and efficiency .",
    "too small @xmath517 is unable to capture the fine structure of the wigner function @xmath509 , whereas too large @xmath517 may increase the complexity and overfit @xmath509 .",
    "for instance , a possible approach is to resort to tree - based methods to partition the phase space @xcite .",
    "considering that all the statistical techniques are devised for estimating a positive semidefinite density , instead of the quasi - distribution , we need to separate the positive and negative signed particles into two groups and make individual histograms , then merge them into a piecewise constant function .",
    "such pattern is based on the decomposition of the signed measure . in a word , the story in the higher dimensional phase space is totally different because how to efficiently implement the so - called annihilation exploiting the cancelation of weights of opposite sign is still in progress .",
    "the resampling in high dimensional phase space is a complicated issue and beyond the scope of this paper , so we would like to discuss it in our future work . in section  [",
    "sec : num_res ] , we mainly focus on several typical tests for @xmath514 and @xmath515 and show the accuracy of wbrw as well as of the piecewise constant approximation by comparing with two accurate deterministic solvers , i.e. , sem@xcite and asm@xcite .    in summary , the outline of wbrw is illustrated below from @xmath494 to @xmath228 with the time step @xmath112 , @xmath518 .",
    "it suffices to take @xmath519 as the initial state , and @xmath520 for the offsprings in eq .  .",
    "step 1 : sample from @xmath218 : :    the first step is to sample @xmath216 ancestor particles    according to the instrumental distribution    @xmath218 ( see eq .  ) .",
    "each particle has a    state @xmath278 and carries an    initial weight @xmath521 and a sign    @xmath522 . in general",
    ", we can simply take    @xmath523 .",
    "+     for the    gaussian barrier   with @xmath524ev and    @xmath525 nm is utilized in the @xmath9-truncated    wigner simulations.,scaledwidth=49.0%,scaledwidth=38.0% ] step 2 : evolve the particles : :    the second step is to evolve super - particles according to the rules of    branching particle systems .",
    "suppose a particle is born at    @xmath526 $ ] at state    @xmath527 with    weight @xmath528 , and it has a random    life - length @xmath529 satisfying    @xmath530    for the ancestor particle , we have    @xmath531 ,    @xmath532 ,    @xmath533 .",
    "+    if    @xmath534 ,    the particle is frozen at the state    @xmath535    and the probability of this event is    @xmath536    otherwise , the particle travels to a new position    @xmath537 and    dies at time @xmath538    at state    @xmath539 ,    and meanwhile , several new particles are generated according to rule    3 , the probability of which is    @xmath540 .",
    "step 3 : density estimation : :    when all particles in the branching system are frozen , one can record    their positions , wavevectors , and weights .",
    "let    @xmath276 denote the index set of all frozen    particles with the same ancestor initially at state    @xmath278 ,    @xmath280    the collection of corresponding frozen states , and    @xmath281 the updated weight of the    @xmath17-th particle .",
    "accordingly ,    @xmath541 can be estimated as    @xmath542    particularly , plugging into    @xmath543 , we obtain @xmath544 .    +    based on a good partition of phase space :    @xmath506 ,    we are able to update the instrumental density function    @xmath507 by the histogram .",
    "in order to investigate the performance of the wbrw algorithm as well as to verify the theoretical predictions as we discussed earlier such as the effect of constant @xmath408 , the increasing behavior of the particle number and the effect of the time step and the annihilation frequency , we simulate a one - body gaussian barrier scattering in 2d phase space and a two - body helium - like system in 4d phase space .",
    "the relative @xmath545 error is adopted to study the accuracy .",
    "let @xmath546 denote the reference wigner function ( wf ) which could be the exact solution or the numerical solution on a relatively fine mesh , and @xmath547 the numerical solution .",
    "then , the relative errors are written as @xmath548 where @xmath549 and the integrals above are evaluated using a simple rectangular rule over a uniform mesh . to obtain a more complete view of the accuracy",
    ", we also measure corresponding relative errors for physical quantities , e.g. the spatial marginal ( sm ) probability distribution and the momental marginal ( mm ) probability distribution in a similar way , denoted by @xmath550 and @xmath551 , respectively .",
    "+    once wbrw starts , the number of particles increases exponentially with time , thus necessary annihilation operations are required to make the simulation go on well , though they are not inherited in the branching process from the theoretical point of view . in this work , we do such annihilations at a constant frequency , say @xmath552 .",
    "that is , we divide equally the time interval @xmath553 $ ] into @xmath554 subintervals with the partition being @xmath555 the annihilations occur exactly at the time instant @xmath556 for @xmath557 , at which the particle number decreases significantly from @xmath558 to @xmath559 , where @xmath560 ( resp .",
    "@xmath561 ) represents the particle number before ( resp .",
    "after ) the annihilation . for convenience ,",
    "we denote the particle number at @xmath562 and @xmath563 by @xmath564 and @xmath565 , respectively . in each time period",
    "@xmath566 $ ] , the particle number increases from @xmath567 to @xmath558 and corresponding multiple is denoted by @xmath568 for the @xmath9-truncated wigner branching particle model with constant auxiliary function @xmath569 , it has been proved in theorem  [ th : exp ] that such increasing multiple only depends on the time increment @xmath570 and @xmath408 , which means the same increasing multiple exists for each time period , i.e. , @xmath571 for any @xmath572 .",
    "all the numerical results are obtained with our own fortran implementations of wbrw , sem and asm on the computing platform : dell poweredge r820 with @xmath573 intel xeon processor e5 - 4620 ( 2.2 ghz , 16 mb cache , 7.2 gt / s qpi speed , 8 cores , 16 threads ) and 256 gb memory .",
    "a fixed time step @xmath112 is applied and then the total number of time steps becomes @xmath574 when the branching process evolves from @xmath575 to @xmath576 for @xmath577 , particle offspring will be generated .",
    "two gaussian barrier scattering experiments are conducted in 2d phase space .",
    "the first experiment is exactly the same as that adopted in @xcite , while the only change for the second one is the barrier height is increased to @xmath578ev .",
    "the readers are referred to @xcite for the details on the problem setting . as we pointed out earlier , both the @xmath9-truncated ( see eq .  , the model parameter is @xmath579 ) and @xmath4-truncated ( see eq .",
    ", the model parameter is @xmath580 ) branching particle models can be regarded as approximations of the same wigner equation in the unbounded domain , and thus comparable results are expected on the same footing because both gaussian wavepacket and gaussian barrier possess a very nice localized structure . hence we only report numerical results for the @xmath9-truncated model and those for the @xmath4-truncated model can be found in @xcite as well as in an early version of this work @xcite .",
    "the initial particle number is fixed to be @xmath581 , and the reference solutions are obtained by sem , the spectral accuracy of which was well demonstrated in @xcite .",
    "ccccccccc @xmath89 & @xmath582 & @xmath583 & @xmath584 & @xmath585 & @xmath586 & @xmath587 & @xmath588 & time +   + @xmath589 & 9.08e-02 & 3.08e-02 & 3.20e-02 & 5.34 & 3.02 & 1.77 &  & 286.28 + @xmath590 & 9.01e-02 & 3.16e-02 & 3.05e-02 & 5.44 & 3.02 & 1.80 & 1.81 & 291.45 + @xmath591 & 7.95e-02 & 2.74e-02 & 2.46e-02 & 9.62 & 2.95 & 3.26 & 3.27 & 297.72 + @xmath592 & 7.51e-02 & 2.52e-02 & 1.97e-02 & 17.25 & 2.93 & 5.89 & 5.91 & 314.83 +   + @xmath589 & 9.25e-02 & 3.21e-02 & 3.31e-02 & 5.35 & 3.02 & 1.77 &  & 3.38 + @xmath590 & 8.98e-02 & 3.32e-02 & 2.73e-02 & 5.44 & 3.02 & 1.80 & 1.81 & 3.37 + @xmath591 & 7.94e-02 & 2.68e-02 & 2.21e-02 & 9.61 & 2.95 & 3.26 & 3.27 & 4.57 + @xmath592 & 7.55e-02 & 2.51e-02 & 1.99e-02 & 17.26 & 2.93 & 5.89 & 5.91 & 6.55 +   + @xmath589 & 9.43e-02 & 3.18e-02 & 3.75e-02 & 9.72 & 3.12 & 3.13 &  & 2.22 + @xmath590 & 9.00e-02 & 3.45e-02 & 3.43e-02 & 10.07 & 3.10 & 3.25 & 3.27 & 2.95 + @xmath591 & 6.32e-02 & 2.70e-02 & 2.36e-02 & 31.62 & 2.98 & 10.62 & 10.68 & 5.50 + @xmath592 & 5.48e-02 & 2.45e-02 & 2.30e-02 & 102.25 & 2.94 & 34.71 & 34.88 & 14.63 +   + @xmath589 & 1.39e-01 & 4.63e-02 & 4.66e-02 & 30.69 & 3.26 & 9.72 &  & 2.25 + @xmath590 & 1.27e-01 & 4.93e-02 & 4.74e-02 & 33.19 & 3.21 & 10.46 & 10.68 & 2.63 + @xmath591 & 6.69e-02 & 2.83e-02 & 2.79e-02 & 326.99 & 2.92 & 112.65 & 113.98 & 25.10 +   + @xmath589 & 2.86e-01 & 8.12e-02 & 6.82e-02 & 2.73 & 2.58 & 1.06 &  & 23.67 + @xmath590 & 2.87e-01 & 8.02e-02 & 6.53e-02 & 2.73 & 2.57 & 1.06 & 1.06 & 23.82 + @xmath591 & 2.84e-01 & 8.01e-02 & 6.61e-02 & 2.87 & 2.55 & 1.13 & 1.13 & 24.07 + @xmath592 & 2.84e-01 & 8.10e-02 & 6.60e-02 & 3.04 & 2.55 & 1.19 & 1.19 & 24.83 +    in general , the calculation of the normalizing factor @xmath589 in eq .   and sampling from @xmath593 can be realized simultaneously , say , we can calculate the normalization factor through sampling .",
    "the gaussian barrier potential reads @xmath594},\\ ] ] where @xmath595 and @xmath596 denote the barrier height and the barrier center , respectively , and the explicit expression of corresponding wigner kernel is @xmath597 it can be easily seen here that @xmath598 in eq .",
    "is the probability density of the normal distribution @xmath599 , with which we can calculate the integral by the rejection sampling . in actual simulations ,",
    "the number of samples are chosen as @xmath600 for each @xmath601 , and the numerical @xmath589 is shown in fig .",
    "[ fig : xi ] for @xmath524ev and @xmath525 nm . we find there that the normalization factor has a sharp decrease around @xmath602 , whereas it is very flat outside the neighborhood of @xmath602 .",
    "@xmath603 * experiment 1 * to be convenient for comparison , we first take the same experiment as utilized before in @xcite , in which the barrier height is set to be @xmath604ev so that the gaussian wavepacket will be partially reflected . such partial reflection is clearly shown in fig .  [",
    "fig : ex1-wf ] .",
    "five groups of tests with different time steps and annihilation frequencies are performed and related data are displayed in table [ tab : eg1 - 1 ] , from which we are able to find several observations below concerning the accuracy .",
    "( 1 ) : :    the idea of choosing constant auxiliary function    @xmath569 works very well . as we expected",
    ",    with the same @xmath112 and @xmath570 , the larger    value @xmath408 takes , the more accurate solution we    obtain , though more running time it spends .",
    "interestingly , both    accuracy and efficiency of the model with    @xmath605 are very close to those of the model    with @xmath606 , where    @xmath607 .",
    "this also justifies    the proposed mathematical framework , the algorithm of branching    process as well as the implementation in some sense .",
    "( 2 ) : :    highly frequent annihilation operations , e.g. ,    @xmath608fs , destroy the accuracy , even larger constant    auxiliary function can not save it .",
    "but this does not mean a low    annihilation frequency should be appreciated .",
    "actually , when using    @xmath609fs , the accuracy becomes worse than that using    @xmath610fs or 2fs , which may be due to the accumulated    numerical errors , such as the bias caused by the resampling .",
    "that is ,    as we mentioned before , the annihilation adopted here is nothing but a    kind of resampling according to the histogram , and thus possibly cause    some random noises due to its discontinuous nature .",
    "( 3 ) : :    while using the same annihilation frequency , say    @xmath610fs , smaller time step , e.g. ,    @xmath611fs , can not improve the accuracy , as    predicted by theorem  [ th : g(t ) ] .",
    "in fact , the accuracy with    @xmath611fs is almost identical to that with    @xmath612fs .",
    "but the former takes much more running    time than the latter .",
    "moreover , too small time steps will    significantly reduce the probability of branching , which is crucial to    capture the quantum information in stochastic wigner simulations , so    that nearly all particles do field - less travel in phase space .",
    "this    point has been also mentioned in @xcite when choosing the time step .",
    "+   +    next we focus on the efficiency .",
    "one of the main variables shaping the efficiency is the particle number .",
    "since the same initial particle distribution is employed for all runs , we only need to consider the growth rate of particle number .",
    "once choosing the constant auxiliary function @xmath408 and the annihilation frequency @xmath552 , the increasing multiple of particle number can be exactly determined by @xmath588 from theorem  [ th : exp ] , and the eighth column of table [ tab : eg1 - 1 ] shows corresponding theoretical predictions . in our numerical simulations , within every annihilation period @xmath613 $ ] with @xmath614 , we record the starting particle number @xmath567 , the ending particle number @xmath558 , and the related growth rate @xmath615 in eq .  .",
    "let @xmath616 table [ tab : eg1 - 1 ] gives numerical values of above three quantities , see the fifth , sixth and seventh columns . according to table [ tab : eg1 - 1 ]",
    ", we can figure out the following facts on the efficiency .",
    "ccccccccc @xmath89 & @xmath582 & @xmath583 & @xmath584 & @xmath585 & @xmath586 & @xmath587 & @xmath588 & time +   + @xmath589 & 2.6210e-01 & 7.1421e-02 & 7.6208e-02 & 48.63 & 3.95 & 12.45 &  & 11.33 + @xmath590 & 2.5998e-01 & 6.7069e-02 & 8.4044e-02 & 49.58 & 3.94 & 12.71 & 13.04 & 12.48 + @xmath591 & 1.3034e-01 & 3.1041e-02 & 5.5122e-02 & 479.96 & 2.87 & 167.36 & 170.12 & 113.62",
    "+   + @xmath589 & 3.3899e-01 & 1.0171e-01 & 1.9413e-01 & 3.22 & 2.50 & 1.29 &  & 25.33 + @xmath590 & 3.4201e-01 & 1.0674e-01 & 1.9785e-01 & 3.23 & 2.50 & 1.29 & 1.29 & 25.87 + @xmath591 & 3.3697e-01 & 1.0959e-01 & 1.9413e-01 & 4.05 & 2.43 & 1.67 & 1.67 & 28.98 + @xmath592 & 3.4011e-01 & 1.1157e-01 & 1.9734e-01 & 5.18 & 2.40 & 2.16 & 2.16 & 29.80 +    ( 1 ) : :    agreement between the mean value @xmath587 and the    theoretical prediction @xmath588 is readily    seen in all situations . in this case , the average acceptance ratio    @xmath481 almost equals to one due to the localized    structure of the wigner kernel .",
    "actually , the growth rates in the    first five annihilation periods , e.g. for @xmath610fs and    @xmath617 , are 5.92 , 5.87 , 5.88 , 5.89 , and    5.88 , all of which are almost identical to the mean value of 5.89 .",
    "when @xmath618fs , the former is a little less than the    latter , because the particles moving outside the computational domain    @xmath619 are not taken into account . within each    annihilation period , the maximum travel distance of particles can be    calculated by    @xmath620    implying that , the larger value @xmath570 is , the more    particles move outside the domain .",
    "this explains the slight deviation    between @xmath587 and    @xmath588 increases from almost zero to at most    1.33 as @xmath570 increases from @xmath621fs to    @xmath622fs .",
    "moreover , when @xmath610fs , the    increasing multiples for @xmath611fs are identical    to those for @xmath612fs , i.e. ,    @xmath587 is independent of @xmath112 ,    which has been also already predicted by the theoretical analysis .",
    "more details about the agreement of the growth rates of particle    number with the theoretical prediction for @xmath610fs and    @xmath611fs can be found in fig .",
    "[ fig : ex1-np ] .",
    "( 2 ) : :    not like using the constant auxiliary function , we do not have a    simple calculation formula so far for the growth rate of particle    number when using the variable auxiliary function ( i.e. , depending    both on time and trajectories ) .",
    "however , we can still utilize the    growth rate for the case of @xmath623 to    provide a close upper bound for the case of    @xmath605 . as shown in the seventh column of    table  [ tab : eg1 - 1 ] , the variation of the mean growth rate between them    is about 0 , 0.03 , 0.12 and 0.74 for @xmath624 0.1fs , 1fs , 2fs    and 4fs , respectively .",
    "[ fig : ex1-np ] further compares the curves    of growth rate for @xmath610fs and    @xmath611fs within four typical annihilation    periods . by comparing with the wigner functions shown in    fig .",
    "[ fig : ex1-wf ] , we find that the closer to the center the gaussian    wavepacket lives , the larger the deviation between the curves for the    constant and variable auxiliary functions becomes .",
    "such deviation in    accordance with the analysis of @xmath589 shown in    fig .",
    "[ fig : xi ] validates the proposed mathematical theory again .",
    "( 3 ) : :    during the resampling ( annihilation ) procedure , the main objective is    to reconstruct the wigner distribution using less particles , which    explores the cancelation of the weights with opposite signs , see eq .  .    the sixth column of table  [ tab : eg1 - 1 ] tells us that the maximum    particle numbers after resampling for @xmath618fs are    all around 3.00 million , implying that there should be a minimal    requirement of particle number to achieve a comparable accuracy",
    "otherwise , the accuracy will decrease , for example , the values of    @xmath586 for @xmath608fs are around    2.55 million .",
    "[ fig : ex1-npaa ] shows more clearly the typical    history of @xmath625 .",
    "we can find there that , no    matter how huge the particle number before the annihilation    @xmath626 ( which depends on both    @xmath89 and @xmath570 ) is , the particle number    after the annihilation @xmath625 for the simulations    with comparable accuracy exhibits almost the same behavior , which    recovers and extends the so - called  bottom line \" structure described    in @xcite .",
    "such behavior may depend only on the oscillating structure    of the wigner function . on the other hand , highly frequent    annihilations like @xmath608fs",
    "destroy this bottom line    structure and thus the accuracy , see fig .",
    "[ fig : ex1-npaa - b ] , implying    that there are no enough particles to capture the oscillating nature .",
    "@xmath603 * experiment 2 * in this example , we increase the barrier height to @xmath627ev so that the gaussian wavepacket will be totally reflected , see fig .",
    "[ fig : ex2-wf ] .",
    "such augment of the barrier height implies that the growth rate of particle number now is about @xmath628 times larger than that for experiment 1 , and thus it is more difficult to simulate accurately .",
    "based on the observations in experiment 1 , we only test two groups of annihilation periods , @xmath629fs . table  [ tab : eg2 - 1 ] summarizes the running data and confirms again that , the larger constant auxiliary function improves the accuracy , whereas the higher annihilation frequency destroys the accuracy . in order to get a more clear picture on this accuracy issue , we plot both spatial and momental probability distributions at different time instants @xmath630fs in fig .  [ fig : ex2-sm ] against the reference solutions by sem .",
    "we can easily see there that , the loss of accuracy when using @xmath608fs is mainly due to that there are no enough generated particles to capture the peaks reflecting off the barrier ; while the increase of accuracy when using a larger constant auxiliary function , e.g. , @xmath631 , comes from the smaller variation .",
    "actually , similar phenomena also occur in experiment 1 .      as a typical two - body system ,",
    "the two - body helium - like system has been considered in testing deterministic wigner solvers in 4d phase space @xcite . here",
    "we utilize again a helium - like system in which the electron - nucleus and electron - electron interaction is given by @xmath632 where the parameter @xmath633 expresses the screening strength , @xmath634 denotes the position of the nucleus , and @xmath635 is the position of the @xmath17-th electron .",
    "in fact , @xmath636 is the green s function of the 1d screened poisson equation .",
    "the wigner kernel of the electron - nucleus interaction reads @xmath637 and that of the electron - electron interaction @xmath638 therefore we can still use a simple rejection method to draw samples from the target distribution @xmath639 . here",
    "we use the atomic unit , set @xmath640 and @xmath641 and adopt the same initial data as used in @xcite .",
    "the computational domain @xmath642 ^ 2\\times [ -4 ,   4]^2 $ ] is divided into @xmath643 cells .",
    "the reference solution is obtained by asm on a uniform grid mesh with @xmath644 and @xmath645 , while the @xmath49-domain is divided into 8 cells and each cell contains 16 collocation points , and the @xmath646-domain is @xmath647 ^ 2 $ ] .",
    "+   +    to monitor the accuracy , we record the relative errors of the reduced single - body wigner function as given in @xcite , and of corresponding marginal probability distributions .",
    "[ fig : ex3-error ] shows the history of those relative errors .",
    "we can see there that , although the reduced wigner function is comparatively less accurate , it can still yield a more accurate estimation of macroscopically measurable quantities , such as the spatial and momental marginal probability distributions .",
    "this also explains why we see more noise in fig .",
    "[ fig : ex3-wf ] for the reduced wigner function than in fig .",
    "[ fig : ex3-sm ] for the marginal distributions .",
    "the possible reason may lie on the fact that if we wish to be able to estimate a function with the same accuracy as a function in low dimensions , then we need the size of samples to grow exponentially as well .",
    "however , it can be readily observed in figs .",
    "[ fig : ex3-wf ] and [ fig : ex3-sm ] that the main features captured by wbrw are almost identical to those by asm .",
    "finally , we would like to mention that the growth of particle number is closely related to the number of cells ( dimensionality of feature space ) . in this example",
    ", we use a @xmath648 uniformly distributed cells for the resampling and set the initial particle number to be about @xmath649 with the total weighted summation being @xmath650 . it",
    "is shown in fig .",
    "[ fig : ex3-pn ] that the particle number increases soon to @xmath651 , which is comparable to the cell number , and then approaches a stable value around @xmath652 .",
    "so if we refine those cells for the resampling , then the particle number will increase to a higher level .",
    "actually , for higher - dimensional problems like @xmath653 , the number of cells is much higher than that of samples and such a simple cell based resampling strategy can not achieve an efficient annihilation .",
    "hence we have to resort to other advanced techniques to control the sample size in higher - dimensional phase space .",
    "this paper is devoted to the mathematical foundation of the branching random walk algorithm for the many - body wigner quantum dynamics .",
    "although several concepts , such as the signed particle , the adjoint equation and the annihilation procedure , have already been mentioned in previous work , unfortunately related mathematical results are somewhat fragmented or lack of systemic elaboration , and the crucial issues , such as the annihilation of particles and the computational complexity , fall outside the scope of any current available theory .",
    "thus , our original motivation is to provide a framework from the viewpoint of computational mathematics within which all these problems can be fully addressed , and interested readers may get a complete view of the wigner branching random walk algorithm accompanied with both derivation and implementation details in a single reference . only by this way can we analyze its accuracy , point out the numerical challenge and make further improvements .",
    "in fact , we have shown that the signed particle is naturally introduced according to the principle of importance sampling , the motion of particles is described by a probabilistic model , and the annihilation is nothing but the resampling from the instrumental distribution .",
    "although the theoretical part of this work is closely related to that shown recently in @xcite , we adopt a different approach to interpreting the entire story . actually , both approaches succeed in validating the basis of the spwmc , namely , eq .  .",
    "the reason we prefer to the branching random walk model , a mixture of the branching process and the random walk , is that the theory of branching process not only provides a natural interpretation of growth of particles , but also allows us to calculate the particle growth rate exactly and discuss the conservation property .",
    "these results are extremely important in real simulations since it gives us a reasonable criterion to control the computational complexity and allocate computational resources efficiently .",
    "we must admit that the numerical challenges in higher dimensional phase space are very potent , though the numerical accuracy in a 4d helium - like system has also been validated in this work .",
    "the often - used simple cell based resampling technique can not work even for 6d problems .",
    "therefore it is urgent for us to seek an efficient way to reduce the sample size , and some advanced statistical density estimation methods might be taken into account .",
    "this research was supported by grants from the national natural science foundation of china ( nos .  11471025 , 91330110 , 11421101 ) .",
    "the authors are grateful to the useful discussions with zhenzhu chen , paul ellinghaus , mihail nedjalkov and jean michel sellier on the signed particle monte carlo method for the @xmath4-truncated wigner equation ."
  ],
  "abstract_text": [
    "<S> a branching random walk algorithm for the many - body wigner equation and its numerical applications for quantum dynamics in phase space are proposed and analyzed . after introducing an auxiliary function </S>",
    "<S> , the ( truncated ) wigner equation is cast into the integral formulation as well as its adjoint correspondence , both of which can be reformulated into the renewal - type equations and have transparent probabilistic interpretation . </S>",
    "<S> we prove that the first moment of a branching random walk happens to be the solution for the adjoint equation . </S>",
    "<S> more importantly , we detail that such stochastic model , associated with both importance sampling and resampling , paves the way for a numerically tractable scheme , within which the wigner quantum dynamics is simulated in a time - marching manner and the complexity can be controlled with the help of an ( exact ) estimator of the growth rate of particle number . </S>",
    "<S> typical numerical experiments on the gaussian barrier scattering and a helium - like system validate our theoretical findings , as well as demonstrate the accuracy , the efficiency and thus the computability of the wigner branching random walk algorithm .    </S>",
    "<S> * ams subject classifications : * 60j85 ; 81s30 ; 45k05 ; 65m75 ; 82c10 ; 81v70 ; 81q05    </S>",
    "<S> * keywords : * wigner equation ; branching random walk ; quantum dynamics ; adjoint equation ; renewal - type equations ; importance sampling ; resampling ; signed particle monte carlo method </S>"
  ]
}