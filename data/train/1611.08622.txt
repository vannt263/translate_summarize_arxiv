{
  "article_text": [
    "modeling and simulation of multiphase fluid systems with a realistic equation of state ( e.g. peng - robinson equation of state @xcite ) has become an attractive and challenging research topic in the chemical and reservoir engineering @xcite .",
    "it plays very important role in the pore scale modeling and simulation of subsurface fluid flow , especially shale gas reservoir that has become an increasingly important source of natural gas in the recent years .",
    "the mathematical models of multiphase fluids are often formulated by a set of thermodynamic state variables and fluid velocity . in the traditional framework of modeling multiphase fluids ,",
    "the thermodynamic state variables are the pressure , temperature , and chemical composition ( the so - called npt - based framework ) .",
    "this framework has been extensively used in many applications @xcite . however , the npt - based framework has some essential limitations @xcite .",
    "first , a realistic equation of state ( e.g. peng - robinson equation of state ) is a cubic equation with respect to the density , so the density might not be uniquely determined for the specified pressure , temperature , and molar fractions .",
    "second , @xcite states that the specification of pressure , temperature , and mole fractions does not always determine the equilibrium state of the system uniquely .",
    "in addition , in compositional fluid simulation , the pressure is not known a - priori and there exists no intrinsic equation for the pressure .",
    "this leads to the complication of constructing the pressure evolution equation for application of the npt - based framework @xcite .    in order to resolve the issues of the npt - based framework ,",
    "an alternative framework @xcite has been developed , and it uses the moles , volume , and temperature ( the so - called nvt - based framework ) as the primal state variables . the nvt - based framework is initially applied to the phase - split computations of multi - component fluids at the constant moles , volume and temperature ( also called nvt flash computation ) in @xcite , and for the subsequent research progress of the nvt flash computation , we refer to @xcite .",
    "recently , the nvt - based framework has been successfully applied in the numerical simulation of compositional two - phase flow in porous media @xcite . very recently , in @xcite , we have extended the nvt - based framework to the pore scale and developed a diffuse interface model to simulate multi - component two - phase flow with partial miscibility , but the rigorous mathematical analysis is absent to demonstrate the consistency with the thermodynamical laws . in this work",
    ", we will propose a general mathematical model for multi - component two - phase flow with partial miscibility , which is viewed as an extension of the nvt - based framework .",
    "moreover , the proposed model is derived with the mathematical rigor based on the thermodynamic laws and a realistic equation of state ( e.g. peng - robinson equation of state ) .",
    "the diffuse - interface models for two - phase incompressible immiscible fluids have been developed in the literature , @xcite for instance .",
    "the proposed model in this work can characterize the compressibility and partial miscibility . a significant contribution in @xcite",
    "is that an additional term involving mass diffusions is introduced in the momentum equation to ensure consistency with thermodynamics for the case of non - matched densities . as shown in our derivations of section [ secmodel ] , we find that an analogical term that also results from mass diffusions is crucial to establish the thermodynamically consistent model of compressible and partially miscible multi - component two - phase flow .",
    "this term occurs in the momentum equation through a different but natural derived form , which satisfies the thermodynamic laws .",
    "a major distinction is that the nvt - based framework uses the helmholtz free energy rather than gibbs free energy used in the npt - based framework .",
    "the first challenging problem caused by this transition is that the traditional techniques @xcite can no longer work well to derive the two - phase flow model .",
    "it is well known that the entropy balance equation plays a fundamental role in the derivations of two - phase flow model . in the classical non - equilibrium thermodynamics @xcite , the variation of entropy @xmath0 exists , so the gibbs relation can be used to derive this key equation . however ,",
    "when the helmholtz free energy is introduced in the gibbs relation , the variation of entropy @xmath0 is eliminated . as a result",
    ", the gibbs relation can not be used to derive the entropy balance equation as in the classical thermodynamics . in this work ,",
    "we resolve this problem by combing the first law of thermodynamics and the related physical relations , and from this , we derive consistent entropy balance equations .",
    "different from the npt - based framework , we use a thermodynamic pressure , which is no longer an independent state variable in the nvt - based framework , and indeed , it is a function of the molar density and temperature .",
    "consequently , it is never necessary to construct the pressure evolution equation although the velocity field is no longer divergence - free .",
    "the proposed model is related to the dynamic van der waals theory of two - phase fluid flow for a pure substance with the thermodynamic pressure , which is developed from physical point of view @xcite .",
    "such model is first proposed in @xcite , and it has successful applications @xcite for example .",
    "but the proposed model has substantial differences from @xcite that we consider the fluids composed of multiple components and introduce an additional term involving mass diffusions in the momentum equation by a natural way .",
    "moreover , we establish the relation between the pressure gradient and gradients of the chemical potentials . based on these relations , we derive a new formulation of the momentum conservation equation , which shows that the gradients of chemical potentials become the primary driving force of the fluid motion .",
    "this formulation allows us to conveniently prove that the total ( free ) energy of the proposed model is dissipated with time .    for numerical simulation ,",
    "a main challenge of diffuse interface models is to design efficient numerical schemes that preserve the discrete ( free ) energy dissipation @xcite .",
    "there are a lot of efforts on the developments of such schemes in the literature ; in particular , a notable progress is that efficient numerical simulation methods for simulating the model of @xcite have been proposed in @xcite .",
    "the key difficulties encountered in constructing energy - stable numerical simulation for the proposed model are the strong nonlinearity of helmholtz free energy density and tight coupling relations between molar densities and velocity . to resolve these problems , we propose a novel convex - concave splitting of helmholtz free energy density and deal well with the coupling relations between molar densities and velocity through very careful physical observations with a mathematical rigor .",
    "the proposed numerical scheme is proved to preserve the discrete ( free ) energy dissipation .",
    "the key contributions of our work are listed as below :    \\(1 ) a general diffuse interface model with a realistic equation of state ( e.g. peng - robinson equation of state ) is proposed to describe the multi - component two - phase fluid flow based on the principles of the nvt - based framework .",
    "\\(2 ) we combine the first law of thermodynamics and the related physical relations to derive the entropy balance equations , and then we derive a transport equation of the helmholtz free energy density .",
    "finally , using the second law of thermodynamics , we derive a set of unified equations for both interfaces and bulk phases that can describe the partial miscibility of two fluids .",
    "\\(3 ) a term involving mass diffusions is naturally included in the momentum equation to ensure consistency with thermodynamics .",
    "\\(4 ) we prove a relation between the pressure gradient and the gradients of the chemical potentials , and from this , we derive a new formulation of the momentum balance equation , which demonstrates that chemical potential gradients become the primary driving force of the fluid motion .",
    "\\(5 ) we prove that the total ( free ) energy of the proposed model is dissipated with time .",
    "\\(6 ) an energy - dissipation numerical scheme is proposed based on a convex - concave splitting of helmholtz free energy density and a careful treatment of the coupling relations between molar densities and velocity .",
    "numerical tests are carried out to verify the effectiveness of the proposed method .",
    "the rest of this paper is organized as follows . in section 2",
    ", we will introduce the related thermodynamic relations . in section 3 , we derive a general model for multi - component two - phase fluid flow . in section 4 ,",
    "we prove the total ( free ) energy dissipation law of the proposed model . in section 5",
    ", we propose an efficient energy - stable numerical method , and in section 6 numerical tests are carried out to verify effectiveness of the proposed method . finally , concluding remarks are provided in section 7 .",
    "we consider a fluid mixture composed of @xmath1 components under a constant temperature ( @xmath2 ) .",
    "we denote the molar density vector by @xmath3^t$ ] , where @xmath4 is the molar density of the @xmath5th component .",
    "furthermore , we denote the overall volume by @xmath6 , and then the moles of component @xmath5 is @xmath7 .",
    "the nvt - based framework uses the moles of each component ( @xmath8 ) and volume ( @xmath6 ) together with the given constant temperature as the primal state variables . with the relation @xmath9",
    ", the primal state variables can be reduced into the molar density ( @xmath10 ) .    by fundamental laws of thermodynamics @xcite",
    ", we have the gibbs relation @xcite @xmath11 where @xmath12 is the internal energy , @xmath2 is the temperature , @xmath13 is the entropy , @xmath14 is the pressure , and @xmath15 is the chemical potential of component @xmath5 .",
    "we define the helmholtz free energy as usual : @xmath16 with the definition of the helmholtz free energy , we get @xmath17 , and thus , the gibbs relation becomes @xmath18    we first note that the entropy balance equation plays a fundamental role in the derivations of two - phase flow model . in the classical derivations @xcite ,",
    "the gibbs relation is used to derive this key equation because it contains the variation of entropy @xmath0 .",
    "however , we can see from that after the helmholtz free energy is introduced in the gibbs relation , the variation of entropy @xmath0 is eliminated . as a result",
    ", the gibbs relation can not be used to derive the entropy equation as in the classical theory , and it is clearly in need of the other alternative relations . in order to resolve this problem , we will use the first law of thermodynamics and the entropy structure rather than the gibbs relation to derive the entropy balance equation .",
    "we now define the helmholtz free energy density as @xmath19 , and then have its form @xmath20 in general , the helmholtz free energy density is a function of @xmath10 and temperature .",
    "we introduce briefly the formulations of helmholtz free energy density @xmath21 of a homogeneous bulk fluid determined by peng - robinson equation of state , which is widely used in the oil reservoir and chemical engineering .",
    "the proposed model can also apply the other realistic cubic equations of state , for instance , the van der waals equation of state @xcite , which is popularly used in physics .",
    "the helmholtz free energy density @xmath21 of a bulk fluid is calculated by a thermodynamic model as @xmath22 where @xmath23 , @xmath24 and @xmath25 are formulated in the appendix .",
    "the mole - pressure - temperature form of peng - robinson equation of state @xcite is @xmath26 which is a cubic equation of the overall molar density @xmath27 . in the mathematical sense , might have not a unique solution for the specified pressure , temperature , and molar fractions ( that is , @xmath28 are given and thus @xmath29 are known ) .",
    "it is a well - known drawback of the npt - based framework .",
    "however , under the nvt - based framework , can always provide a unique and explicit pressure for given molar density and temperature .",
    "we note that for bulk fluids , the pr - eos formulation is equivalent to the pressure equation ( see the details in the appendix ) @xmath30 which results from .",
    "however , the pressure equation is more general and it can be also used to define and calculate the pressure of an inhomogeneous fluid .    for realistic fluids , the diffuse interfaces always exist between two phases . the interfacial partial miscibility is a phenomenon that the two - phase fluids behave on the interfaces . to model this feature , a local density gradient contribution is introduced into the helmholtz free energy density of inhomogeneous fluids .",
    "the general form of helmholtz free energy density ( denoted by @xmath31 ) is then the sum of two contributions : helmholtz free energy density of bulk homogeneous fluid and a local density gradient contribution : @xmath32 where @xmath33 here , @xmath34 is the cross influence parameter .",
    "the density gradient contribution accounts for the phase transition by the gradual density changes of each component on the interfaces .",
    "but for a bulk phase , the molar density of each component has uniform distribution in space , and in this case , @xmath35 vanishes . for the influence parameters , it is generally considered constant in this paper ( see the appendix ) .",
    "the chemical potential of component @xmath5 is defined as @xmath36 where @xmath37 and @xmath38 is the variational derivative .",
    "moreover , the general pressure can be formulated as @xmath39 where @xmath40 from , the pressure is a function of @xmath10 and @xmath2 in the nvt - based framework , but it is no longer an independent state variable as it is so in the npt - based framework .",
    "in this section , we will derive the general model for the multi - component two - phase fluid flow , in which the viscosity and density gradient contribution to free energy are under consideration .",
    "first , we use the first law of thermodynamics and entropy splitting structure to derive an entropy equation , and then we derive a transport equation of helmholtz free energy density to further reduce the entropy equation . from the reduced entropy equation , we derive a general model of multi - component two - phase flow , which obeys the second law of thermodynamics .",
    "the first law of thermodynamics states @xmath41 where @xmath42 is the time , @xmath43 is the kinetic energy , @xmath44 is the work done by the face force @xmath45 , and @xmath46 stands for the heat transfer from the surrounding that occurs to keep the system temperature constant .",
    "we split the total entropy @xmath13 into a summation of two contributions .",
    "one is the entropy of the system , denoted by @xmath47 .",
    "the other is the entropy of the surrounding , denoted by @xmath48 , which has the relation with @xmath46 as @xmath49 taking into account the relation @xmath50 , and using and , we have @xmath51    we denote by @xmath52 the molar weight of component @xmath5 , and define the mass density of the mixture as @xmath53 in a time - dependent volume @xmath54 , we define the entropy , helmholtz free energy and kinetic energy within @xmath54 as @xmath55 where @xmath56 is the entropy density and @xmath57 is the mass - averaged velocity . applying the reynolds transport theorem and the gauss divergence theorem , we deduce that @xmath58 @xmath59 and @xmath60    in presence of a fluid velocity field , the mass transfer in fluids takes place through the convection in addition to the diffusion of each component .",
    "thus , the mass balance law for component @xmath5 gives us @xmath61 where @xmath62 is the diffusion flux of component @xmath5 and its formulation will be discussed in the latter of this section .",
    "multiplying by @xmath52 and summing them from @xmath63 to @xmath1 , we obtain the mass balance equation @xmath64 substituting into , we have @xmath65 where @xmath66    the work done by @xmath67 is expressed as @xmath68 cauchy s relation between face force @xmath67 and the stress tensor @xmath69 of component @xmath5 gives @xmath70 , and as a result , @xmath71 where @xmath72 is the unit normal vector towards the outside of @xmath54 .",
    "we note that the other external forces including gravity force is ignored in this work , but the model derivations can be easily extended to the cases in the presence of external forces .",
    "substituting , , and into , and taking into account the arbitrariness of @xmath54 , we obtain the entropy balance equation @xmath73 in the following subsections , we will derive the transport equation of helmholtz free energy density to reduce the entropy equation .      from the definition of @xmath74",
    ", we have @xmath75 using the relation and component mass balance equation , we derive the transport equation of helmholtz free energy density @xmath76 as @xmath77 the gradient contribution of helmholtz free energy density can be formulated as @xmath78 and @xmath79 combining - , we deduce the transport equation of the helmholtz free energy @xmath80 as @xmath81 taking into account the identity @xmath82 we can reformulate as @xmath83      substituting into , we reformulate the entropy equation as @xmath84 where @xmath85 is the second - order identity tensor .",
    "we consider the fluid mixture in a closed system with the fixed total moles for each component .",
    "let @xmath86 denote the domain with the fixed volume .",
    "the natural boundary conditions can be formulated as @xmath87 where @xmath88 denotes a normal unit outward vector to the boundary @xmath89 .",
    "integrating over the entire domain , we obtain the change of total entropy @xmath13 with time @xmath90 where @xmath91 . according to the second law of thermodynamics ,",
    "the total entropy shall not decrease with time . using this principle",
    ", we can determine the complete forms of multi - component two - phase flow model .",
    "first , we consider an ideal reversible process to get the form of the reversible stress , and the reversibility implies that there exist no effects of viscosity and friction . in this case , the entropy shall be conserved , so the diffusions vanish , i.e. @xmath92 , and the total tress @xmath69 becomes equal to the reversible stress , denoted by @xmath93 , which must have the form @xmath94 the last term on the right - hand side of shall also be zero as @xmath95    for the realistic irreversible multi - component chemical systems , the driving force for diffusion of each component is the gradient of chemical potentials , so we express the diffusion flux for each component as @xcite @xmath96 where @xmath97 is the mobility .",
    "reciprocal principle @xcite requires the symmetry of @xmath98 , and moreover , the second law of thermodynamics demands that @xmath98 is positive semidefinite or positive definite , i.e. @xmath99 which ensures the non - negativity of the first term on the right - hand side of . in general principle ,",
    "@xmath100 may depend on the chemical potential gradients of other components except for component @xmath5 . in numerical tests of this paper ,",
    "we take a special case of @xmath98 that is a diagonal positive definite matrix ; indeed , we use the following diffusion flux @xcite @xmath101 where @xmath102 is the diffusion coefficient of component @xmath5 .    for the realistic viscous flow , the total stress can be split into two parts : reversible part ( i.e. @xmath93 given in ) and irreversible part ( denoted by @xmath103 ) ; that is , @xmath104 newtonian fluid theory suggests @xmath105 where @xmath106 is the volumetric viscosity and @xmath107 is the shear viscosity .",
    "we assume that @xmath108 and @xmath109 .",
    "so the second term on the right - hand side of is non - negative .",
    "the non - negativity of the last term on the right - hand side of requires that @xmath110    substituting , and into , we obtain the complete momentum balance equation as @xmath111 which is also equivalent to @xmath112 if @xmath62 is taken such that @xmath113 , then is reduced into the form in @xcite , but for the general formulations of @xmath62 , the term @xmath114 or @xmath115 is essential to ensure the thermodynamical consistency @xcite .    in summary , the proposed mathematical model of multi - component two - phase flow is formulated by a nonlinear and fully coupled system of equations including the mass conservation equation coupling with the diffusion flux and the chemical potential , and the momentum balance equation or coupling with the pressure formulation .",
    "in this section , we will demonstrate the total ( free ) energy dissipation property of the proposed model , which seems not an obvious conclusion from its derivation , but it is required for thermodynamical consistency and it is essential to design the stable and efficient numerical methods in the next section . to do this ,",
    "we first reformulate the momentum conservation equation by a simpler form .",
    "this requires the following theorem regarding the relations between the gradients of the pressure and chemical potentials .",
    "[ lempreschptleqnmultigrad ] the gradients of the pressure and chemical potentials have the following relation @xmath116    we recall the relation @xmath117 proved in , and then taking into account chemical potential formulation and pressure formulation , we obtain @xmath118 thus , is obtained .    as a direct application of",
    ", the momentum conservation equation is reformulated as @xmath119 which indicates that the fluid motion is indeed driven by the gradients of chemical potentials .    applying the formulation of momentum conservation equation given in",
    ", we can conveniently prove the total ( free ) energy dissipation property of the proposed model .",
    "we use @xmath120 and @xmath121 to represent the @xmath122 , @xmath123 or @xmath124 inner product and norm respectively .",
    "we define the helmholtz free energy and kinetic energy within the entire domain @xmath86 as @xmath125    the sum of the helmholtz free energy and kinetic energy is dissipated with time , i.e. @xmath126    taking into account the mass balance equation , we obtain @xmath127 multiplying both sides of by @xmath15 and integrating it over @xmath86 , we obtain @xmath128 applying the formulation of @xmath15 , we derive the summation of the first term on the left - hand side of as @xmath129 we denote @xmath130^t$ ] , and further define the norm @xmath131 using and , we have the summation of from @xmath63 to @xmath1 as @xmath132 we combine and @xmath133 where we have also used @xmath134 therefore , the energy dissipation can be obtained from and .",
    "in this section , we will design an energy - dissipated semi - implicit time marching scheme for simulating the proposed multi - component fluid model .",
    "the key difficulties result from the complication of helmholtz free energy density and fully coupling relations between molar densities and velocity .",
    "we resolve these problems through very careful physical observations with a mathematical rigor .",
    "the gradient contribution to the helmholtz free energy density is always convex with respect to molar densities , so it shall be treated implicitly .",
    "the challenge is to deal with the bulk helmholtz free energy density @xmath76 . for the pure substance , the ideal and repulsion terms , i.e. @xmath23 and @xmath24 , result in convex contributions to the helmholtz free energy density @xcite . for the multi - component mixtures ( @xmath135 )",
    ", we can prove the ideal contribution @xmath23 is still convex with respect to molar densities since its hessian matrix is a diagonal positive definite matrix .",
    "however , the repulsion term @xmath24 for multi - component mixtures is never convex due to cross products of multiple components , and it can be easily verified for the binary mixtures through eigenvalue calculations ( we omit the details here ) .",
    "for the pure substance , the attraction term @xmath25 is proved to result in a concave contribution to the helmholtz free energy density @xcite .",
    "but it may be not true for multi - component mixture ; in fact , numerical tests show that the maximum eigenvalues of its hessian matrix may be slightly larger than zero in some cases ( not presented here ) .    in order to construct a strict convex - concave splitting for the case of multi - component mixture , we impose two auxiliary terms on the bulk helmholtz free energy density .",
    "one term is the additional ideal term for the reason that the ideal term is a good approximation of the behavior of many gases and always convex .",
    "the other is a separate repulsion term , denoted by @xmath136 , which reduces the cross products of multiple components in the original repulsion term and is expressed as @xmath137 we note that @xmath138 in terms of its physical meaning , so @xmath139 is well defined .",
    "we define the summation of the above two auxiliary terms as @xmath140 which has a diagonal positive definite hessian matrix @xmath141    we now state a convex - concave splitting of the bulk helmholtz free energy density based on the above auxiliary terms .",
    "let us define a parameter @xmath142 , and then we reformulate the bulk helmholtz free energy density as @xmath143 where @xmath144 @xmath145 the chemical potentials can be reformulated accordingly @xmath146 we make some remarks on the convex - concave splitting given in - : + ( a ) the reason that @xmath24 is considered in the convex part is an observation in numerical tests that positive eigenvalues of @xmath24 are usually large , while its negative eigenvalues are only slightly less than zero .",
    "in contrast , @xmath25 is included in the concave part because numerical tests show that its negative eigenvalues are usually far from zero , while its positive eigenvalues are only slightly larger than zero .",
    "moreover , the attraction force shall result in a concave contribution from the point view of physics @xcite .",
    "+ ( b ) because of strong convexity of @xmath147 , if we choose a sufficiently large @xmath148 , the strict convex - concave splitting can be achieved for the bulk helmholtz free energy density of multi - component mixture . but a very large value for @xmath148 is not necessary in practical computations , and in fact , we just take @xmath149 in our numerical tests , which is enough to gain the numerical convex - concave splitting .",
    "consequently , we assume that there exists a suitable @xmath142 such that the convexity of @xmath150 and concavity of @xmath151 hold .",
    "we consider a time interval @xmath152 $ ] , where @xmath153 .",
    "we divide @xmath154 into @xmath155 subintervals @xmath156 $ ] , where @xmath157 and @xmath158 .",
    "furthermore , we denote @xmath159 . for any scalar @xmath160 or vector @xmath161",
    ", we denote by @xmath162 or @xmath163 its approximation at the time @xmath164 .",
    "we now state the semi - implicit time marching scheme .",
    "first , a semi - implicit time scheme is constructed for the molar density balance equation as @xmath165 where @xmath166 @xmath167 we note that the mobility coefficients @xmath168 generally depend on the molar densities , so we use @xmath169 to denote their values computed from molar densities @xmath170 .    in the previous section ,",
    "we have reformulated the momentum balance equation by the form coupling with the chemical potentials rather than pressure .",
    "a semi - implicit time scheme for the momentum conservation equation is constructed as @xmath171 here , the viscosities @xmath107 and @xmath106 are assumed to be constant .",
    "we now demonstrate that the proposed semi - implicit time scheme satisfies the dissipation property of the total ( free ) energy .",
    "we define the discrete helmholtz free energy and discrete kinetic energy at the time @xmath172 as @xmath173    the sum of the discrete helmholtz free energy and discrete kinetic energy is dissipated with time steps , i.e. @xmath174    multiplying both sides of by @xmath175 and integrating it over @xmath86 , we obtain @xmath176 we define the bulk and gradient contributions of the discrete helmholtz free energy as @xmath177 the convexity and concavity yields @xmath178 using the symmetry of @xmath34 , we can estimate the gradient contribution of helmholtz free energy as @xmath179 since @xmath180 , we obtain from , and that @xmath181 we denote @xmath182^t$ ] , and define the norm of @xmath183 as @xmath184 substituting into yields @xmath185 multiplying both sides of by @xmath186 and and integrating it over @xmath86 , we obtain @xmath187 multiplying by @xmath52 and summing it from @xmath63 to @xmath1 , we obtain the mass balance equation @xmath188 using , we estimate @xmath189 substituting into yields @xmath190 noticing that @xmath191 we combine and and then obtain @xmath192 which yields the energy dissipation .",
    "the above semi - implicit time schemes lead to a nonlinear systems of equations , and consequently , a linearized iterative method is required .",
    "the newton s method is commonly used to solve such systems . here",
    ", we present a mixed iterative method , in which we apply newton s linearization for @xmath193 and treat the rest terms through a simple linearization approach .",
    "we use the superscript @xmath194 to represent the iteration step ; that is , @xmath195 and @xmath196 denote the approximations of @xmath197 and @xmath186 at the @xmath194th iteration .",
    "the initial guess solutions are taken from the previous time step , i.e. @xmath198 and @xmath199 .",
    "once the approximations @xmath195 and @xmath196 are obtained , the new approximations @xmath200 and @xmath201 are calculated as @xmath202 @xmath203 @xmath204 @xmath205 where @xmath206 stands for the hessian matrix of @xmath207 .",
    "the convergence of this iterative method will be studied in the future work .",
    "in this section , we carry out numerical tests regarding multi - component two - phase fluid flow problems and verify the effectiveness of the proposed method .",
    "we consider the fluid flow of a binary hydrocarbon mixture , which is composed of methane ( ch@xmath208 ) and decane ( nc@xmath209 ) .",
    "we take the volumetric viscosity and the shear viscosity as @xmath210pa@xmath211s , and we take the diffusion coefficients in as @xmath212m@xmath213/s . in all numerical examples , the spatial domain is a square domain with the length @xmath214 nm , and a uniform rectangular mesh with @xmath215 elements is applied on the domain .",
    "we employ the cell - centered finite difference method and the upwind scheme to discretize the mass balance equation and the finite volume method on the staggered mesh @xcite for the momentum balance equation , and these spatial discretization schemes can be equivalent to special mixed finite element methods with quadrature rules @xcite .",
    "the stop criterion of the nonlinear solver is that the 2-norm of the relative variation of molar density and velocity between the current and previous iterations is less than @xmath216 , and in many cases , about 2 - 3 nonlinear iterations are required to reach this criterion .",
    "the maximum nonlinear iterations are also set to be not larger than 5 for preventing too many loops .      in this example",
    ", we simulate the dynamical evolution of a square shape fluid droplet , which is initially located in the center of the domain .",
    "the temperature of the fluid keeps 320k constant .",
    "the initial densities of liquid and gas fluids are computed by pr - eos under the pressure 160bar and temperature 320k .",
    "the initial molar densities of methane and decane in gas phase are @xmath217mol / m@xmath218 and @xmath219mol / m@xmath218 respectively , while the initial molar densities of methane and decane in liquid phase are @xmath220mol / m@xmath218 and @xmath221mol / m@xmath218 respectively .",
    "the time step size is taken as @xmath222s , and 45 time steps are simulated .",
    "figure [ squarech4andnc10totalenergytemperature320](a ) clearly depicts the strict dissipation of the total ( free ) energy with time steps .",
    "figure [ squarech4andnc10totalenergytemperature320](b ) is a zoom - in plot of figure [ squarech4andnc10totalenergytemperature320](a ) in the later time steps , and it shows that the total ( free ) energy remains to decrease all the time .",
    "these results verify the effectiveness of the proposed method .",
    "the initial molar density distributions for methane and decane are illustrated in figure [ squarech4andnc10molardensityofch4temperature320k](a ) and figure [ squarech4andnc10molardensityofnc10temperature320k](a ) respectively . in figure [ squarech4andnc10molardensityofch4temperature320k](b)(c ) and figure [ squarech4andnc10molardensityofnc10temperature320k](b)(c )",
    ", we show the changes of each component molar density in the dynamical evolution .",
    "it is obviously observed that the droplet turns to a circle from its initial square shape under the effect of driving force ( i.e. the gradient of chemical potential of this species ) . in figures",
    "[ squarech4andnc10velocitytemperature320k ] , we illustrate the velocity field and magnitudes of both velocity components at the last time step .",
    "we simulate the dynamical evolution of a bubble , which is ellipse shaped in the center of the domain at the initial moment .",
    "the temperature of the fluid is constant at 330k .",
    "the initial molar densities of methane and decane in gas phase are @xmath223mol / m@xmath218 and @xmath224mol / m@xmath218 respectively , while the initial molar densities of methane and decane in liquid phase are @xmath225mol / m@xmath218 and @xmath226mol / m@xmath218 respectively .",
    "we set the time step size @xmath227s , and carry out the simulation for 100 time steps .",
    "we illustrate the total ( free ) energy profiles with time steps in figure [ ellipsech4andnc10totalenergytemperature330](a ) , and further present a zoom - in plot of the later time steps in figure [ ellipsech4andnc10totalenergytemperature330](b ) .",
    "it is still observed that the total ( free ) energy is dissipated with time steps .    in figure [ ellipsech4andnc10molardensityofch4temperature330k ] and figure [ ellipsech4andnc10molardensityofnc10temperature330k ]",
    ", we illustrate the initial molar density configurations for methane and decane and the molar density changes with time steps for each component .",
    "moreover , in figures [ ellipsech4andnc10velocitytemperature330k ] , we illustrate the velocity fields and magnitudes of velocity components at different time steps .",
    "we can observe from these results that at the @xmath228-direction the fluids flow towards to the center from the left and right sides , while at the @xmath229-direction , the fluids are flowing from the center to the bottom and top sides . as a result",
    ", the bubble tends towards a circle from its original ellipse shape .      in this example , there are two bubbles at the initial moment , and the initial molar densities of methane and decane in gas and liquid phases are the same to those in example 2 .",
    "the temperature of the fluid keeps constant at 330k .",
    "we simulate its dynamical evolution for 120 time steps with the time step size @xmath227s .",
    "the total ( free ) energy dissipation profile with time steps is plotted in figure [ twoellipsech4andnc10totalenergytemperature330](a ) , and figure [ twoellipsech4andnc10totalenergytemperature330](b ) is a zoom - in plot in the later time steps .",
    "the results in figure [ twoellipsech4andnc10totalenergytemperature330 ] confirm that the total energy always decays with time steps and consequently the proposed method is effective .",
    "figure [ twoellipsech4andnc10molardensityofch4temperature330k ] and figure [ twoellipsech4andnc10molardensityofnc10temperature330k ] depict the initial molar density configurations and molar density changes with time steps for methane and decane . in figures",
    "[ twoellipsech4andnc10velocitytemperature330k ] , we illustrate the velocity fields and magnitudes of velocity components at different time steps . it can be observed from these simulated results that in the presence of gradients of chemical potentials , the bubbles is first emerging with each other in the sequent dynamical evolution , and at the finial time , the merged bubbles gradually tend to a circle .",
    "the nvt - based framework is a latest alternative setting that is preferred over the npt - based framework to model multiphase fluid flow .",
    "based on the principles of the nvt - based framework , a mathematical model is proposed to describe the multi - component two - phase flow with partial miscibility .",
    "we combine the first law of thermodynamics and the related physical relations to derive the entropy balance equations , and then we derive a transport equation of the helmholtz free energy density . furthermore , using the second law of thermodynamics , we derive a set of unified equations for both interfaces and bulk phases that can describe the partial miscibility of two fluids .",
    "a feature of this model is that a term involving mass diffusions is naturally included in the momentum equation to ensure consistency with thermodynamics .",
    "we prove a relation between the pressure gradient and the gradients of chemical potentials , which leads to a new formulation of the momentum conservation equation , showing that the gradients of chemical potentials become the primary driving force of the fluid motion .",
    "the total ( free ) energy dissipation with time is proved for the proposed model .",
    "an energy - dissipation numerical scheme is proposed based on a convex - concave splitting of helmholtz free energy density and a careful treatment of the coupling relations between molar densities and velocity with a mathematical rigor . finally",
    ", we present numerical results to verify the effectiveness of the proposed method .",
    "[ appendix ]    we describe the detailed formulations of helmholtz free energy density @xmath21 in : @xmath230 @xmath231 @xmath232 where @xmath233 is the overall molar density , and @xmath234 is the universal gas constant . here ,",
    "@xmath235 and @xmath236 are the energy parameter and the covolume , respectively , and these parameters can be calculated as functions of the mixture composition and the temperature .",
    "we denote by @xmath237 and @xmath238 the @xmath5th component critical temperature and critical pressure , respectively . for the @xmath5th component ,",
    "let the reduced temperature be @xmath239 .",
    "the parameters @xmath240 and @xmath241 are calculated as @xmath242 ^ 2,~~~~b_{i}= 0.07780\\frac{rt_{c_i}}{p_{c_i}}.\\end{aligned}\\ ] ] the coefficients @xmath243 are calculated by the following formulas @xmath244 @xmath245 where @xmath246 is the acentric factor .",
    "we let the mole fraction of component @xmath5 be @xmath247 .",
    "then @xmath248 and @xmath236 are calculated by @xmath249 where @xmath250 the given binary interaction coefficients for the energy parameters .",
    "we now show that for bulk homogeneous fluids , the pr - eos formulation is equivalent to the pressure equation .",
    "in fact , in this case , @xmath251 and the corresponding chemical potential of component @xmath5 can be calculated as @xmath252 and furthermore , we deduce that @xmath253 substituting the above equation into yields @xmath254 which is just the pr - eos formulation .",
    "finally , we introduce the formulations of the influence parameters .",
    "the pure component influence parameters @xmath255 are given by @xcite @xmath256,\\end{aligned}\\ ] ] where @xmath257 and @xmath258 are the coefficients correlated merely with the acentric factor @xmath246 of the @xmath5th component by the following relations @xmath259 the cross influence parameter is generally described as the modified geometric mean of the pure component influence parameters @xmath260 and @xmath261 by @xmath262 where the parameters @xmath263 are binary interaction coefficients chosen to satisfy the symmetry @xmath264 and @xmath265 . in the numerical tests of this work , we take @xmath266 for @xmath267 . from the above formulations of the influence parameters , it is generally assumed that the influence parameters rely on the temperature but independent of the component molar density .",
    "k. bao , y. shi , s. sun , and x .- p .",
    "wang . a finite element method for the numerical solution of the coupled cahn - hilliard and navier - stokes system for moving contact line problems . ,",
    "231(24 ) : 80838099 , 2012 .",
    "j. kou and s. sun .",
    "unconditionally stable methods for simulating multi - component two - phase interface models with peng - robinson equation of state and various boundary conditions . , 291(1 ) : 158182 , 2016 ."
  ],
  "abstract_text": [
    "<S> a general diffuse interface model with a realistic equation of state ( e.g. peng - robinson equation of state ) is proposed to describe the multi - component two - phase fluid flow based on the principles of the nvt - based framework which is a latest alternative over the npt - based framework to model the realistic fluids . </S>",
    "<S> the proposed model uses the helmholtz free energy rather than gibbs free energy in the npt - based framework . </S>",
    "<S> different from the classical routines , we combine the first law of thermodynamics and related thermodynamical relations to derive the entropy balance equation , and then we derive a transport equation of the helmholtz free energy density . </S>",
    "<S> furthermore , by using the second law of thermodynamics , we derive a set of unified equations for both interfaces and bulk phases that can describe the partial miscibility of two fluids . a relation between the pressure gradient and chemical potential gradients </S>",
    "<S> is established , and this relation leads to a new formulation of the momentum balance equation , which demonstrates that chemical potential gradients become the primary driving force of fluid motion . </S>",
    "<S> moreover , we prove that the proposed model satisfies the total ( free ) energy dissipation with time . for numerical simulation of the proposed model </S>",
    "<S> , the key difficulties result from the strong nonlinearity of helmholtz free energy density and tight coupling relations between molar densities and velocity . to resolve these problems </S>",
    "<S> , we propose a novel convex - concave splitting of helmholtz free energy density and deal well with the coupling relations between molar densities and velocity through very careful physical observations with a mathematical rigor . </S>",
    "<S> we prove that the proposed numerical scheme can preserve the discrete ( free ) energy dissipation . </S>",
    "<S> numerical tests are carried out to verify the effectiveness of the proposed method .    </S>",
    "<S> multi - component two - phase flow ; diffuse interface model ; partial miscibility ; energy dissipation ; realistic equation of state .    </S>",
    "<S> 65n12 ; 76t10 ; 49s05 </S>"
  ]
}