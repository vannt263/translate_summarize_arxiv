{
  "article_text": [
    "while deceptively simple to consider conceptually , the diffusion of a particle in an inhomogeneous medium is a subtle problem @xcite . for a system consisting of a high viscosity and a low viscosity region , will a tracer particle be found more often on the  thicker \" side , the  thinner \" side , or with an equal probability at all locations ?",
    "while an assumption of a boltzmann distribution would suggest an equal probability at all locations , a simple physical argument suggests that the particle may be more likely to be found on the high viscosity side .",
    "if the only inhomogeneity in the system is the viscosity , then statistically , the dynamics are the same at all points with the exception that time is rescaled on the high viscosity side where the particle moves slower .",
    "hence the particle will spend a greater amount of time on that side and should be more likely to be found there .",
    "while this discussion can go back and forth , in truth each answer corresponds to a different formulation of the problem  both with their own mathematical and physical assumptions .",
    "in essence , the question boils down to considering a particle at the viscosity interface : will there be an additional `` push '' at the interface to the low viscosity side that will compensate the `` trapping '' in the high viscosity region due to the slower dynamics there ?",
    "let us assume that the fluids can be considered implicitly , so their effect on the diffusing particle is reduced to a random force and a friction force that the particle feels .",
    "we further assume that the interface is sharp and that there are no interfacial effects such as surface tension that would make the particle prefer or avoid the interface .",
    "finally , we assume the particle motion is overdamped such that it can be described by the _ overdamped langevin equation _ @xcite .",
    "the situation where the assumption of equivalent dynamics ( apart from the time scale ) holds and particles accumulate on the high viscosity side corresponds to interpreting the stochastic term in the overdamped langevin equation according to the rules of the _ ito calculus _ @xcite .",
    "in other interpretations , of which the most well - known corresponds to _ stratonovich calculus _",
    "@xcite , but perhaps of most interest to physicists is the so - called _ isothermal _ formulation @xcite , the particle  feels \" the interface and has a tendency to move to the low viscosity side . in particular , in the isothermal case ( also referred to in the literature as hnggi - klimontovich or kinetic @xcite ) this bias at the interface cancels the trapping effect and , in the stationary state , the particle has an equal probability of being found at all locations .",
    "there have been several experimental explorations of systems with nonuniform viscosity or , more generally , particle diffusivity @xcite .",
    "most relevantly , van milligen _ et al . _",
    "@xcite performed experiments in which the relative concentration of dye was monitored in a system comprised of two viscosity regions created by adding gelatine to one half of it . in this setup , the dye was found to accumulate on the high viscosity side . as demonstrated in their paper ,",
    "the concentration distributions they observed can be approximated by solutions of the fokker - planck equation , which corresponds to the ito formulation ( see sec .  [",
    "sec : theory ] ) . on the other hand , in experiments by lanon _",
    "@xcite , particles diffused between two nearly , but not perfectly , parallel walls , which , as the authors showed , is equivalent to diffusion with a variable diffusion coefficient . in contrast to ref .",
    "@xcite , while individual particles were observed to drift to regions of higher diffusivity , there was no overall flux when starting with a uniform concentration of particles and hence the uniform concentration was preserved , which is consistent with the isothermal case . on the theoretical side , the general conclusion has been that different formulations can be appropriate depending on the details of the system .",
    "for instance , in a simple model of diffusion in a slowly modulated periodic potential by sokolov  @xcite , ito , stratonovich , and isothermal rules correspond to different variants of the model .",
    "given the experimental and theoretical relevance of diffusion in inhomogeneous media , it is desirable to be able to model it computationally",
    ". one popular computational approach to modeling the dynamics of particles in a fluid medium is molecular dynamics ( md ) @xcite .",
    "two of the most common md approaches assuming an implicit fluid are brownian dynamics ( bd ) and langevin dynamics ( ld ) .",
    "the bd approach consists in solving numerically the overdamped langevin equation in the ito formulation .",
    "ld drops the overdamped assumption and adds an inertial term to the equation of motion that is then solved numerically .",
    "interestingly , even in the limit of an infinitely large damping ( but decreasing the time step so it is always much smaller than the corresponding relaxation time ) , ld is not reduced to bd and instead corresponds to the isothermal formulation of the overdamped langevin equation .",
    "thus the choice between the two methods is not arbitrary when an inhomogeneous system is considered .",
    "_ monte carlo ( mc ) methods _ are another frequently used group of computational approaches @xcite . unlike md , mc methods generally sacrifice at least some aspects of the dynamics of the system to achieve a computational speedup compared to md .",
    "how much is sacrificed can vary .",
    "the popular metropolis algorithm @xcite is designed solely to reproduce the equilibrium state and is generally unsuitable for studying the dynamics , even qualitatively .",
    "for instance , in the problem of inhomogeneous diffusion considered here , a particle would diffuse equally rapidly regardless of the viscosity , _ unless _ care is taken to adjust the step length and/or the time increment at every mc step ( the _ time step _ ) appropriately , which is not a part of the basic algorithm . however , there are also methods ( _ dynamical mc _ ) which do reproduce the principal aspects of the dynamics and even the correct time scale of the process .",
    "this includes generally faster , but sometimes less accurate and/or reliable methods where the particles are restricted to pre - defined points in space forming a lattice ( _ lattice mc _ , or lmc ) , as well as off - lattice methods .",
    "dynamical lmc methods include kinetic monte carlo @xcite and methods designed to reproduce the correct dynamics in an arbitrarily strong uniform field @xcite .",
    "in this article , we present two dynamical lmc algorithms which can be used to generate results consistent with different formulations of the inhomogeneous diffusion problem . we consider a simple system consisting of a single random walker diffusing in a box which contains two separated fluids in equal proportions : a fluid of viscosity @xmath0 on the left side and viscosity @xmath1 on the right side , similar to the experimental setup in ref .  @xcite .",
    "hence , there is a viscosity interface at the center of the box . projecting the motion of the random walker onto the direction perpendicular to the interface reduces the problem to a 1d one .",
    "the particular choice of the problem with a sharp interface has been made for two ( in a way , opposite ) reasons .",
    "on the one hand , _ a priori _ it is the simplest setup in which to study diffusion in an inhomogeneous medium ; it lets us define simple quantities characterizing the process , such as the fraction of the time spent on a particular side of the interface . on the other hand , when it comes to actually solving the problem",
    ", it turns out there are difficulties specifically in the case of a sharp interface , as discussed in sec .",
    "[ sec : theory ] , so in that sense this problem is , in fact , _ more _ complicated than that of a gradual change in viscosity ; our algorithms should generalize straightforwardly to the latter case .",
    "in addition , in future work we intend to apply the algorithms developed here to studying translocation of a polymer through a nanopore in a thin membrane , in which case having different viscosities on the two sides of the membrane with a sharp boundary between them corresponding to the pore is natural .",
    "overall , the system of a single random walker in a fluid with a single , sharp viscosity interface is chosen as a simple  toy problem \" such that we can clearly demonstrate the validity of our lmc algorithms .",
    "however , as will be shown in the results section , many interesting features arise for the dynamics of a particle in such a system  particularly when contrasting results for different calculi .",
    "this manuscript thus not only introduces lmc approaches for simulating diffusion in a system containing regions of differing diffusivity , but it demonstrates the complexity which arises for even the simplest case and highlights the importance of choosing the calculus that is appropriate for the problem under study .    in the next section , we briefly review the relevant parts of the theory of the overdamped langevin equation for the motion of a brownian particle and obtain the corresponding equation for the particle concentration .",
    "we then introduce ito , stratonovich , and isothermal calculi giving some examples of their physical relevance .",
    "we also point out some problems with using the overdamped langevin equation in the case of a sharp interface . in the following two sections , we consider different simulation techniques that can be used for the problem of particle diffusion .",
    "we first note that the well - known bd and ld methods correspond to ito and isothermal calculi , respectively , and then introduce two mc algorithms .",
    "the details of the simulation protocol are outlined in sec .",
    "v , after which in sec .",
    "vi we present comparisons between different methods ( bd , ld , mc ) and results of the simulations .",
    "we end the paper with a discussion of possible uses of the methods developed here and their future generalizations .",
    "diffusion of a pointlike particle along the @xmath2 axis under the influence of a potential @xmath3 can be described by the langevin equation @xcite , @xmath4 where @xmath5 is the particle mass , @xmath6 is the boltzmann constant , @xmath7 is the temperature , and @xmath8 is a random function that satisfies @xmath9 and @xmath10 , where @xmath11 denotes the ensemble average .",
    "the coefficient of the last term follows from the fluctuation - dissipation theorem .",
    "it is assumed that the drag force @xmath12 ( the first term on the right - hand side ) is proportional to the particle velocity @xmath13 , @xmath14 where @xmath15 is the friction coefficient . for a particle moving in a fluid",
    ", @xmath15 is proportional to the fluid viscosity @xmath16 : @xmath17 where @xmath18 is constant for a given particle .",
    "for instance , for a spherical particle of radius @xmath19 , according to the stokes law ( which assumes no - slip boundary conditions for the fluid ) , @xmath20 for other particle shapes and boundary conditions the expression for @xmath18 will be different , but eq .",
    "( [ zetavseta ] ) is still valid .    in many cases of interest , the left - hand side ( or the inertial term ) in eq .",
    "( [ ldiner ] ) is small .",
    "if this term is neglected ( the _ overdamped limit _ ) , we obtain the _ overdamped langevin equation _ @xmath21 it is this limit that we will consider in what follows .",
    "however , neglecting the inertial term can bring about subtle problems , as discussed below .    taking the case of free diffusion [ @xmath22 we can rewrite eq .",
    "( [ ldbm ] ) as @xmath23 the particle diffusion coefficient ( or diffusivity ) @xmath24 is defined by the expression @xmath25 where @xmath26 is the particle displacement over time @xmath27 .",
    "based on eq .",
    "( [ sde ] ) , it can be shown that @xmath28 we then obtain @xmath29      the consideration below and in section  [ fluxes ] is similar to ref .",
    "@xcite , but somewhat more detailed .",
    "if we consider diffusion in a stationary inhomogeneous medium , @xmath24 will be dependent on @xmath2 such that @xmath30    to proceed , we must determine how the multiplicative noise term in eq .",
    "( [ sde_d ] ) is to be evaluated . for a _",
    "deterministic _ differential equation @xmath31 where @xmath32 is a nonrandom and well - behaved function , we can write down the derivative on the left - hand side as the limit of a difference and then @xmath33 in the last term , instead of the value of the function @xmath34 at time @xmath35 , we could have taken its value at time @xmath36 , or any linear combination of the two  this does not matter in the limit @xmath37 , i.e. , in this limit the equation @xmath38\\delta t\\label{determde}\\end{aligned}\\ ] ] can be used with any @xmath39 between zero and one .",
    "varying @xmath39 changes the right - hand side of eq .",
    "( [ determde ] ) by a negligible amount @xmath40 .",
    "however , for _ stochastic _ differential equations , like eqs .",
    "( [ sde_dconst ] ) and ( [ sde_d ] ) , there are complications .",
    "first , @xmath8 is not a well - behaved function . instead of its instantaneous value ,",
    "which is not well - defined , one needs to take its average over the interval @xmath41 , which depends on @xmath41 and is @xmath42 , where @xmath43 is a random number with @xmath44 , @xmath45 and no correlation between different time intervals .",
    "then , for eq .  ( [ sde_dconst ] ) , @xmath46 second , when @xmath24 is variable [ as in eq .",
    "( [ sde_d ] ) ] , there is an additional uncertainty , since the result depends on where @xmath24 is evaluated , that is , on the value of @xmath39 in @xmath47\\delta t } , \\label{stochde}\\end{aligned}\\ ] ] and this dependence now remains even in the limit @xmath37 .",
    "indeed , let us assume _ for now _ that @xmath48 is a smooth function . from now until the end of this section , we will use @xmath49 to denote the value calculated using eq . ( [ stochde ] ) , rather than the actual value of the coordinate at time @xmath36 , thus , the `` @xmath50 '' sign in eq .",
    "( [ stochde ] ) is replaced by the `` @xmath51 '' sign .",
    "expanding @xmath52+o(\\delta t)\\nonumber\\\\ & & \\hspace{-4cm}=\\frac{dd}{dx}r\\sqrt{2[(1-\\alpha)d(x(t))+\\alpha d(x(t+\\delta t))]\\delta t}+o(\\delta t)\\nonumber\\\\ & & \\hspace{-4cm}=\\frac{dd}{dx}r\\sqrt{2d(x(t))\\delta t+o(\\delta t^{3/2})}+o(\\delta t)\\nonumber\\\\ & & \\hspace{-4cm}=\\frac{dd}{dx}r\\sqrt{2d(x(t))\\delta t}+o(\\delta t ) \\label{expansion}\\end{aligned}\\ ] ] and using this in eq .",
    "( [ stochde ] ) , we get @xmath53\\delta t}\\nonumber\\\\ & & \\hspace{-2.3cm}=r\\sqrt{2d(x(t))\\delta t}\\left[1+\\frac{\\alpha(dd / dx)r\\sqrt{2d(x(t))\\delta t}}{2d(x(t))}+o(\\delta t)\\right]\\nonumber\\\\ & & \\hspace{-2.3 cm } = r\\sqrt{2d(x(t))\\delta t}+r^2\\alpha ( dd / dx)\\delta t+o(\\delta t^{3/2}).\\label{stochexp}\\end{aligned}\\ ] ] in eqs .",
    "( [ expansion ] ) , ( [ stochexp ] ) and below , we have not specified explicitly the point at which the derivative @xmath54 is taken .",
    "it is easy to check that replacing the value of @xmath54 at the point @xmath55 with that at the point @xmath49 or vice versa introduces an extra term of order @xmath56 in the last line of eq .",
    "( [ stochexp ] ) that can be neglected , so the exact point at which the derivative is taken does not matter . on the other hand , both the first and the second term in the last line of eq .",
    "( [ stochexp ] ) are important in the limit @xmath37 , even though they are of different orders in @xmath41 , because @xmath57 , but @xmath58 . indeed , over a fixed time interval @xmath27 such that @xmath59 , the contribution of the first term as a function of @xmath60 and @xmath41 is @xmath61 , while that of the second term is @xmath62 , and both terms survive when @xmath37 .",
    "in the second term , we can replace @xmath63 with its average value 1 , since the contribution of the fluctuating part over the interval @xmath27 is @xmath64 , which is negligible when @xmath37 .",
    "this gives @xmath65 it is easy to show that the same result is obtained , if in eq .",
    "( [ stochde ] ) the value of @xmath24 is taken at a single point between the end points of the jump , as in ref .",
    "@xcite , that is , eq .  ( [ stochde ] )",
    "is replaced with @xmath66\\}\\delta t}.\\end{aligned}\\ ] ]    the last term in eq .",
    "( [ drift ] ) is deterministic and produces _ drift _ of the particles in the direction of the diffusivity gradient known as `` spurious flow ''",
    "@xcite , `` spurious drift '' , or `` noise - induced drift '' @xcite .",
    "the drift velocity is @xmath67 it vanishes when @xmath68 .",
    "note that the same drift can be produced by a suitably chosen external deterministic force , so it is always possible to change the value of @xmath39 and still get the same dynamics by introducing an additional fictitious force  @xcite .",
    "although the drift velocity of particles is zero for @xmath68 [ eq .",
    "( [ driftv ] ) ] , the net _ flux _ through a fixed point @xmath69 does not vanish in this case , even without a particle concentration ( or probability density ) gradient . indeed , assuming for simplicity that @xmath70 ( with no influence on the final result ) , in a single jump the point with @xmath71 is crossed from the left by one half of all particles ( namely , those with @xmath72 ) with @xmath2 between @xmath73 and @xmath69 , where @xmath73 obeys the equation @xmath74 or @xmath75\\delta t}\\nonumber\\\\ & & \\hspace{-1.3cm}\\approx \\sqrt{2d(x_0)\\delta t}\\left(1-\\frac{1}{2d(x_0)}\\frac{dd}{dx}(x_0-x_1)\\right),\\end{aligned}\\ ] ] with the solution @xmath76 the number of such particles is @xmath77 where @xmath78 is the ( uniform ) particle concentration .",
    "likewise , the same point @xmath69 is crossed from the right by one half of all particles ( those with @xmath79 ) with @xmath2 between @xmath69 and @xmath80 , with @xmath81 and the number of such particles is @xmath82 the net flux is thus @xmath83 when @xmath84 , the flux due to the drift , @xmath85 , with @xmath86 given by eq .",
    "( [ driftv ] ) , has to be added to eq .",
    "( [ flux0 ] ) , which gives the total flux @xmath87 this flux is nonzero when the drift velocity is zero at @xmath68 , but it vanishes when @xmath88 .",
    "when a concentration gradient is present [ @xmath89 , this adds the usual flux given by fick s first law , @xmath90 : @xmath91 in two special cases this expression is simplified : for @xmath68 , @xmath92 while for @xmath88 , @xmath93 which conforms to normal fickian diffusion rules .",
    "the rate of the concentration change is @xmath94 in particular , for @xmath68 , @xmath95 which is the standard form of the fokker - planck equation without the drift term @xcite ; for @xmath88 , @xmath96 which is fick s second law",
    ".    the stationary state can be obtained by setting @xmath97 in eq .",
    "( [ diffuseq ] ) .",
    "this condition for no net change in the particle concentration is then @xmath98 if there is no net flux , as , for example , when the system is confined between two reflecting walls , then the constant in eq .",
    "( [ equicond ] ) is zero and @xmath99 which gives @xmath100 for @xmath88 , the particles can be found with equal probability anywhere ( @xmath101 ) , but for @xmath102 they are more likely to be found in regions of lower diffusivity ( or higher viscosity ) .      even though the actual solution of eq .",
    "( [ sde_d ] ) depends on the value of @xmath39 in its discretized variant [ eq .",
    "( [ stochde ] ) ] , its _ formal _ solution can always be written as @xmath103 different @xmath39 thus correspond to different interpretations of the formal integral in eq .",
    "( [ formal ] ) , or different _",
    "three cases have received special attention .",
    "the case @xmath68 corresponds to _ ito calculus _ @xcite . in this case , the stationary distribution is given by @xmath104 the primary attractive quality of this formulation is that its implementation is  non - predictive \" : according to eq .",
    "( [ stochde ] ) , the value of the diffusivity @xmath24 is taken at the initial point of the jump only , so , as opposed to all other cases , one does not need to look ahead in time to evaluate the spatially dependent term .",
    "this property makes the ito formulation a frequent choice for mathematical problems  including financial modeling .",
    "but it is also physically relevant : for instance , the overdamped limit of the langevin equation ( [ ldiner ] ) corresponds to the ito calculus in the idealized situation where the temperature varies in space , but the friction coefficient is temperature - independent and thus the same everywhere @xcite .",
    "this is an inherently non - equilibrium situation from the thermodynamic point of view and so the fact that the stationary distribution does not coincide with the equilibrium boltzmann distribution is not surprising .",
    "another example would be a particle in a modulated quasiperiodic potential where the tops of the barriers are all at the same level , but the well depths are position - dependent  @xcite . in this case , the change in diffusivity is accompanied by the change in the free energy and the boltzmann distribution is obeyed .",
    "the case @xmath105 corresponds to the _ stratonovich calculus _",
    "@xcite . in this case , the value of @xmath24 at the midpoint of the jump ( or the average of the values at the endpoints ) is taken .",
    "stratonovich calculus conforms to the `` normal '' rules of calculus .",
    "for example , if @xmath2 obeys eq .",
    "( [ sde_d ] ) , then one would expect @xmath106 where the right - hand side is interpreted according to the rules of the given calculus .",
    "this is indeed true for stratonovich , but not for other calculi .",
    "the stratonovich calculus arises when considering the langevin equation ( [ ldiner ] ) with the noise @xmath8 having a _ finite _ and space- and time - independent correlation time , in the limit when both this correlation time and the relaxation time @xmath107 go to zero , but the former is kept much larger than the latter @xcite . in fact , even for the overdamped langevin equation  ( [ sde_d ] ) ( corresponding to the relaxation time equal to zero ) with a finite noise correlation time the issue of interpretation of the noise term does not arise and the limit when the correlation time goes to zero corresponds unambiguously to the stratonovich calculus  @xcite .",
    "this situation violates the fluctuation - dissipation theorem which requires that a finite noise correlation time be accompanied by a memory in the friction force , thus giving rise to the generalized langevin equation @xcite instead of the ordinary one .",
    "so the fact that the density in the stationary state is not uniform , but rather obeys @xmath108 is natural .",
    "sokolov  @xcite has also proposed a variant of his modulated quasiperiodic potential model that corresponds to the stratonovich calculus ; again , the free energy in that model is position - dependent .",
    "since ito and stratonovich are the two calculi most often discussed in the literature , the choice between different calculi has often been referred to as the `` ito - stratonovich dilemma ''  @xcite .",
    "but besides these two cases , the case @xmath88 is also of special interest , because in that case eq .  ( [ equil ] ) becomes @xmath109 which corresponds to the equilibrium boltzmann distribution in the `` purest '' case when it is only the diffusivity that varies in space , but the particle free energy and the temperature are the same everywhere .",
    "there is no universally accepted name for the @xmath88 calculus , with names such as hnggi - klimontovich @xcite , kinetic @xcite and isothermal @xcite appearing in the literature .",
    "we will use the latter in what follows , since it emphasizes the fact that this calculus corresponds to the case when the system is kept at a constant temperature , as opposed to the ito case which can be achieved by varying the temperature across the system ( still assuming the situation where the free energy would be constant for @xmath110 ) .",
    "so far , we have assumed that @xmath48 varies smoothly in space .",
    "first of all , this allowed us to do the expansion in eq .",
    "( [ expansion ] ) .",
    "even more importantly , we note that if there is a jump in the diffusivity , then even the solution of eq .",
    "( [ sde_d ] ) is not well - defined for @xmath84 .",
    "consider @xmath88 and let us assume that @xmath111 with @xmath112 .",
    "let the particle coordinate at time @xmath35 be @xmath113 and suppose that the time step @xmath41 and the random number @xmath43 chosen at the following step are such that @xmath114 , but @xmath115 .",
    "note that the jump size depends on the final position at time @xmath36 .",
    "if we assume that the particle ends up to the right of the interface , then the jump size should be @xmath116 , but then the particle coordinate after the jump is @xmath115 , so we come to a contradiction .",
    "conversely , if we assume that the particle ends up on the left side , then the jump size should be @xmath117 , but @xmath114 , so there is again a contradiction .",
    "thus at this point the particle behavior is undefined . on the other hand , for @xmath118",
    "it is possible that both assumptions lead to valid results , so there is ambiguity . given that in principle @xmath119 can be arbitrarily close to zero , this will always be a potential problem , no matter how small @xmath41 is .",
    "in fact , this problem exists whenever the jump size depends not just on the initial position , that is , for any @xmath84 .",
    "thus , in order to be able to use eq .",
    "( [ sde_d ] ) [ discretizing it as in eq .",
    "( [ stochde ] ) ] for calculi other than ito ( and even for the very concept of different calculi to be meaningful ) , we need to assume that the function @xmath48 is smooth everywhere . in that case , what we mean by a `` sharp '' interface and a `` jump '' in diffusivity is that actually the diffusivity is smooth and thus the interface between two liquids has a finite width , but the interface is narrow compared to all other length scales ( in our simple problem , there is only one such length scale , the size of the system ) . physically , the smoothness of @xmath24 means that it changes little on the length scale of the typical interatomic distance .",
    "this is very likely to be true in reality , and even if the liquids are completely immiscible and the interface is atomically sharp , but the diffusing particle is much larger than the interatomic distance , the properties of the system are effectively averaged out over the particle size and the condition is satisfied . in this case , eq .",
    "( [ sde_d ] ) is still meaningful for all calculi and in principle can be solved numerically by choosing a very small time step when iterating eq .",
    "( [ stochde ] ) , so that typical particle jumps in the simulation are smaller than the width of the interface .",
    "however , this would be a waste of computational resources ; but choosing a larger step would lead to the indeterminacy problem described above .",
    "this is where lmc methods are helpful , as we will see below .    in the remainder of this paper",
    ", we will concentrate on this situation of a sharp , but not infinitely sharp interface . for simplicity , we will still use notation that may seem to imply that the interface is infinitely sharp , but will keep in mind that in reality it is not .",
    "so , for instance , @xmath120 denotes the particle concentration immediately to the right of the interface , but still far enough from it that the diffusivity has already reached its asymptotic value @xmath121 ; likewise , @xmath122 . bearing this in mind , eq .",
    "( [ equil ] ) for the stationary distribution and its particular cases , eqs .",
    "( [ itostatio ] ) , ( [ stratostatio ] ) , and ( [ isostatio ] ) , should remain valid in our situation .",
    "moreover , we can show that these relations are valid _ at all times _ , even in the transient state , _ in the vicinity of the interface _ , that is , at all times @xmath123^{1-\\alpha}=\\rho(+0,t)[d(+0)]^{1-\\alpha}.\\label{jump}\\ ] ] indeed , with the exception of the case @xmath88 , the first term on the right - hand side of eq .",
    "( [ flux ] ) for the particle flux is large at the interface and in fact infinite in the limit of an infinitely sharp interface .",
    "however , the flux itself , even though it can be nonzero when the stationary state is not reached , is expected to be finite . therefore , the second term on the right - hand side of eq .",
    "( [ flux ] ) should be large ( infinite in the limit ) as well , and the flux @xmath124 can be neglected compared to either of these terms .",
    "dropping @xmath124 in eq .",
    "( [ flux ] ) produces the stationary - state equation  ( [ drhoeq ] ) , from which eq .",
    "( [ jump ] ) follows immediately . in the special case @xmath88 , the first term on the right - hand side of eq .",
    "( [ flux ] ) is zero and therefore the second term is finite , thus there is no jump in @xmath78 , which is likewise consistent with eq .  ( [ jump ] ) .",
    "condition ( [ jump ] ) describes the concentration jump across the interface that forms immediately and always exists , if @xmath125 . the full solution of the diffusion problem for the system consisting of two uniform regions separated by a `` sharp '' interface ( where `` sharp '' is understood as above ) can be obtained by solving two uniform diffusion problems in the two regions , @xmath126 with two additional matching conditions at the interface : eq .",
    "( [ jump ] ) and the flux continuity condition , @xmath127 in addition , of course , there have to be boundary conditions at the walls , for example , the no - flux condition @xmath128 for a reflecting boundary or @xmath129 for an absorbing boundary , where @xmath130 is the coordinate of the boundary .",
    "in this section and the next one , the various simulation approaches used to explore diffusion in an inhomogeneous medium are presented .",
    "we start by describing two well - known molecular dynamics ( md ) approaches , namely , langevin dynamics ( ld ) and brownian dynamics ( bd ) .    md is a simulation approach based on solving equations of motions for particles comprising the system . in the most straightforward , but very computationally intensive approach , both the probe particle(s ) whose diffusion is studied and the fluid particles are included explicitly and newton s second law equations @xmath131 are solved numerically , where @xmath132 and @xmath133 are the mass and the position of the @xmath134th particle and @xmath135 is the sum of all forces acting on it . the computational expense can be reduced by considering the fluid particles implicitly , as is done in the ld and bd approaches .      in the ld approach ( @xcite , sec .",
    "14.4 ) , only the equation of motion of the diffusing particle is considered explicitly and the action of the fluid particles on it is replaced by the friction force and a random force , and the resulting equation of motion is given in 1d by eq .",
    "( [ ldiner ] ) with @xmath136 : @xmath137 dividing by @xmath15 and assuming that @xmath15 is a function of @xmath2 , we obtain @xmath138 or @xmath139 unlike in the case of the first - order eq .",
    "( [ sde_d ] ) , there is no ambiguity due to different interpretations of the random term even when @xmath15 ( or @xmath24 ) is space - dependent , with all interpretations and all `` correct '' numerical methods giving the same solution in the limit when the time step @xmath37 .",
    "this is because , unlike in the case of eq .",
    "( [ sde_d ] ) , the particle velocity does not diverge , thus when the equation is discretized , the displacement during a single step is much smaller [ @xmath140 instead of @xmath141 , so in the limit @xmath37 it no longer matters whether the position at the beginning or at the end of the step is used when calculating @xmath24  @xcite . in practice ,",
    "some variation of the verlet method ( @xcite , sec .",
    "13.4 ) is usually used to solve eq .",
    "( [ ld ] ) numerically . by construction ,",
    "( [ ld ] ) obeys the fluctuation - dissipation theorem , thus in the case @xmath110 the stationary distribution should coincide with the boltzmann distribution @xmath101 . since this fact does not depend on the value of the parameters entering the equation , it should remain valid in the limit @xmath142 when the inertial term vanishes , and thus this overdamped limit should correspond to the isothermal interpretation of eq .",
    "( [ sde_d ] ) .",
    "in fact , this was proved in ref .",
    "@xcite . however , in order to reproduce this result numerically , it is important to retain the inertial term decreasing its coefficient , rather than simply dropping it , and to make sure that the time step is always much smaller than the relaxation time , @xmath107 .",
    "remarkably , unlike eq .",
    "( [ sde_d ] ) with @xmath84 , eq .",
    "( [ ld ] ) can still be solved straightforwardly in the case of a sharp interface , as we will see in sec .",
    "the motion of microscopic particles in a liquid is nearly always overdamped , with the time of relaxation to the terminal velocity , @xmath107 , usually much smaller than any other relevant time scale . as mentioned above",
    ", the time step of the ld algorithm should be much smaller than even this extremely small time .",
    "even if the particle mass @xmath5 is increased artificially to increase the relaxation time and thus the maximum allowed time step , this time step may still end up being too small and as a result , the simulation will be inefficient .",
    "a seemingly straightforward approach is eliminating the left - hand side of eq .",
    "( [ ld ] ) ( the inertial term ) altogether and solving the resulting first - order equation .",
    "this equation coincides with eq .",
    "( [ sde_d ] ) , so the discussion of the ambiguity of the stochastic term in sec .",
    "[ sec : theory ] applies . normally in md simulations , to solve eq .",
    "( [ sde_d ] ) numerically the simplest euler algorithm ( often referred to as euler - maruyama in the stochastic case @xcite ) is used , in which , in order to obtain the particle position at time @xmath36 , the right - hand side of the equation is evaluated at time @xmath35 .",
    "this approach , called brownian dynamics , obviously corresponds to the ito interpretation of the stochastic differential equation ( [ sde_d ] ) .",
    "thus , surprisingly , ld ( even in the overdamped limit ) and bd will give different results when the friction coefficient @xmath15 varies in space , as they correspond to different calculi .",
    "just as ld , bd can be used in the case of a sharp interface without any complications , since these complications only arise for @xmath84 when solving eq .",
    "( [ sde_d ] ) .",
    "some difficulties arise when the random number @xmath43 is chosen to be discrete ( e.g. , @xmath143 ) , as described in sec .",
    "[ sec : mciivsbd ] , so using @xmath43 with a continuous distribution is preferable .",
    "the main goal of this paper is to develop and test lmc algorithms for simulating a random walker at a viscosity interface corresponding to different calculi [ @xmath39 in eq .",
    "( [ stochde ] ) ] , including the popular ito , stratonovich , and isothermal calculi .",
    "there are several reasons to develop such algorithms .",
    "first , lmc algorithms are popular for studying diffusion problems @xcite and in some of these problems studying the case when the effective viscosity is inhomogeneous in space ( e.g. , different degrees of crowding in different parts of the system ) can be of interest ( see , e.g. , ref .",
    "second , lmc algorithms can offer advantages compared to md ( or , in general , solving numerically the langevin equation ) specifically in the case of a sharp interface .",
    "as we have seen , sharp interfaces are algorithmically problematic when solving the overdamped langevin equation , except in the case @xmath68 corresponding to bd .",
    "while the @xmath88 ( isothermal ) case can be treated by ld , this may require a very small time step for the solution to be reliable .",
    "all other cases are in principle equivalent to ito plus an additional drift force , but that drift force would be infinite at the interface and zero elsewhere , which would cause obvious numerical problems .",
    "lmc algorithms , on the other hand , are straightforward in all of these cases , as we will demonstrate .",
    "two different approaches will be taken . in the first method ,",
    "changes in viscosity values are introduced by altering the probability @xmath144 that a particle does not jump during a mc jump attempt : the particle has a higher chance of `` staying put '' in the high viscosity region . in this approach ,",
    "the jump lengths on the low and high viscosity sides are the same .",
    "conversely , in the second method , the change in viscosity across the interface is included by altering the jump length ( i.e. , the mesh step of the lattice ) : the particle jumps shorter distances when the viscosity is higher . here",
    ", the probability of not jumping is constant ( except perhaps for sites adjacent to the interface ) . in both methods",
    "the time step is the same in both regions and stays constant throughout the simulation .",
    "this is essential for so - called numerically exact variants of lmc methods @xcite and is also very helpful when several particles are simulated at once .",
    "both lmc methods are derived based on three requirements : ( 1 ) the diffusion should be unbiased away from the interface , ( 2 ) the diffusion rates should be correct in both regions , and ( 3 ) the probabilities of the moves at the interface should ensure that the stationary distribution given by eq .",
    "( [ equil ] ) is reproduced .",
    "only the last of these requirements depends on the calculus ( the value of @xmath39 ) , and so this value will only affect the rules of the algorithms at the interface , that is , in the only place where the viscosity gradient is present , as expected .    when deriving both algorithms , the following consideration is used .",
    "suppose the particle moves on a lattice with a constant mesh step @xmath145 and the time step is @xmath146 .",
    "at every _ successful _ step ( i.e. , ignoring the time steps where the particle stays put ) , the particle moves left or right with an equal probability .",
    "the mean - square displacement after @xmath60 successful steps is @xmath147 since in time @xmath27 there are @xmath148 total steps and thus on average @xmath149 successful steps , @xmath150 and comparing this to eq .",
    "( [ d ] ) , @xmath151        in the first monte carlo approach , all  successful \" jumps have the same length and the dependence on viscosity is introduced by altering the probability of remaining still during a time step ( fig .",
    "[ fig : mci ] ) .        given the diffusion coefficient @xmath24 and the time step @xmath146 , from eq .",
    "( [ d_lmc ] ) the probabilities to move right and left should be @xmath152 and the probability to stay put , @xmath153 obviously , @xmath146 and @xmath145 need to be chosen so that all of these probabilities are between zero and one for the diffusivities both to the left ( @xmath154 ) and to the right ( @xmath155 ) of the interface .",
    "since @xmath24 is inversely proportional to the fluid viscosity @xmath16 [ see eq .",
    "( [ diffzeta ] ) ] , it follows from eq .",
    "( [ ppm1 ] ) that @xmath156 and @xmath157 should be inversely proportional to @xmath16 , or , introducing the viscosity @xmath158 at which these probabilities are equal to 1/2 and correspondingly @xmath159 , @xmath160 where sub- and superscripts @xmath161 and @xmath162 denote the left and right side of the viscosity interface , respectively , and `` i '' shows that these parameters correspond to the mc i algorithm .",
    "the same probabilities were used previously in refs .",
    "the parameter @xmath158 should not be larger than the smaller of the two viscosities @xmath0 and @xmath1 to ensure that both @xmath163 and @xmath164 are non - negative .",
    "in fact , even the situation where @xmath158 is equal to or only slightly smaller than either @xmath0 or @xmath1 should be avoided , since some simulation artifacts , such as spurious oscillations both in time and in space , are possible when the waiting time is zero  @xcite , or , more generally , the variance of the time between successful steps is small . on the other hand , from eqs .",
    "( [ diffzeta ] ) and ( [ ppm1 ] ) ,",
    "@xmath165 so this limitation on the allowed values of @xmath158 restricts possible choices of @xmath166 and @xmath167 .",
    "the fact that the probabilities of the moves are different in the two parts of the system is depicted schematically in the top part of fig .  [",
    "fig : mci ] .",
    "equations  ( [ ppmlr1 ] ) and ( [ pslr1 ] ) should be used for lattice sites away from the interface .",
    "they ensure that the first two of the three requirements mentioned above ( no bias and the correct diffusivities ) are satisfied .",
    "the third condition , the correct ratio of the particle concentrations on the two sides of the interface , should be achieved by choosing a special set of probabilities for sites near the interface .",
    "it is convenient to choose the lattice so that the interface is on a lattice site .",
    "let us denote this site 0 , and the sites immediately to the left and to the right of it , @xmath168 and @xmath169 , respectively .",
    "since we have a single condition to satisfy for several probabilities , we can make an arbitrary choice that the probabilities of moves out of sites @xmath168 and @xmath169 are still given by eqs .",
    "( [ ppmlr1 ] ) and ( [ pslr1 ] ) and that only the two probabilities for the moves out of site 0 ( plus the rest probability at site 0 ) are special . based on eq .",
    "( [ equil ] ) , the condition that needs to be satisfied is that @xmath170 where @xmath171 is the average number of particles at site @xmath134 in the stationary state . since from detailed balance , @xmath172 and @xmath173 where @xmath174 and @xmath175 are the probabilities of the moves from site 0 to the right and to the left , respectively , we get @xmath176 or @xmath177 this means that for @xmath178 and @xmath84 there is a bias at the interface ( @xmath179 ) .",
    "equation  ( [ ratio1 ] ) defines the ratio @xmath180 , but not each of these probabilities separately . in the isothermal case ( @xmath88 ) , @xmath101 in the stationary state and thus @xmath181",
    "; it is reasonable to require that @xmath182 is the same as @xmath183 and @xmath184 , and this gives unambiguously @xmath185 the probability of staying put is then @xmath186 where the reduced viscosity @xmath187 is the harmonic mean of the two viscosities . since it makes sense for the rate of moving away from the interface to always be related to some sort of average between the two viscosities , we can require , somewhat arbitrarily , that the probability of staying put be given by eq .",
    "( [ ps1int ] ) for all values of @xmath39 and use this as an additional condition together with eq .",
    "( [ ratio1 ] ) to obtain @xmath188 in fact , we have checked for the ito calculus that the dynamics are insensitive to the choice of @xmath189 provided that @xmath190 , which in this case follows directly from eq .",
    "( [ ratio1 ] ) .",
    "results essentially indistinguishable from those generated by the above formulation were obtained in simulations with @xmath191 and @xmath192 .",
    "equations  ( [ p0m1 ] ) and ( [ p0p1 ] ) have simple interpretations in two cases . in the isothermal case ( @xmath88 ) , @xmath193 and @xmath194 .",
    "in other words , the probability of the move to the left from the interface site ( the move that is within the left region ) is the same as the probability of any other move ( from a non - interface site ) within the left region , and the same is true for the right region . this property is illustrated in the middle part of fig .",
    "[ fig : mci ] .",
    "it ensures explicitly the absense of a net flux through any surface when the particle concentration is the same everywhere , the key property of the @xmath88 case mentioned in sec .",
    "[ sec : theory ] , since for every surface drawn between two sites there will be as many particles moving from left to right as from right to left . in the ito case ( @xmath68 ) , the probabilities of moves to the left and to the right from the interface site are equal ( the bottom part of fig .",
    "[ fig : mci ] ) .",
    "this is consistent with the description of the ito formulation in secs .",
    "[ sec : intro ] and [ sec : theory ] as the case where any bias at the interface is absent .",
    "when the ratio of the two viscosities , @xmath0 and @xmath1 , is very large or very small , then , since @xmath158 should be chosen at least as small as the smaller of the two , the probability of moving in the more viscous region will be very low , according to eq .",
    "( [ ppmlr1 ] ) .",
    "this makes the algorithm very inefficient in this case , since many random numbers need to be generated per single successful move .",
    "however , one may note that the number of steps until the next successful move is exponentially distributed , with the probability that this number is @xmath195 being @xmath196 where @xmath197 is either @xmath163 , @xmath164 , or @xmath189 , depending on the location of the particle . instead of waiting for many steps until a successful move , one can move at every step , but advance the clock by @xmath198 instead of @xmath166 , generating @xmath195 from the distribution ( [ ndistr ] ) .",
    "the resulting procedure is exactly equivalent to the original one .",
    "strictly speaking , in this procedure the time step is variable , which in some cases is undesirable , as mentioned above ; however , it is still always a multiple of the basic step @xmath166 .",
    "it is also possible to always advance the clock by the same amount @xmath199 , equal to the average waiting time between successful steps , @xmath200 where @xmath16 is either @xmath0 , @xmath1 , or @xmath201 . while not strictly equivalent to the algorithm given by eqs .",
    "( [ ppmlr1 ] ) and ( [ pslr1 ] ) , such an algorithm should ultimately give the same results in the limit @xmath202 .",
    "the advantage is that the need to draw random numbers from the distribution ( [ ndistr ] ) is avoided .",
    "however , the time step will no longer be a multiple of @xmath146 .",
    "a potentially more serious problem is simulation artifacts that may appear when the waiting time is constant , as mentioned above .",
    "regardless of the utility of this algorithm for actual simulations , it is useful in the analysis of the diffusion problem , as we discuss below .",
    "in both variants of the algorithm ( with random and deterministic clock advancement ) , at each step the moves to the left and to the right are equiprobable , _ except _ when the particle is right at the viscosity interface the probabilities are @xmath203 these probabilities are such that their ratio @xmath204 is the same as @xmath205 , but their sum is unity , so the rest probability is zero",
    ".    note that in the algorithm presented here the particle moves to a neighboring site at every step , that is , the particle motion is simply an ordinary random walk on a 1d lattice , and it is unbiased everywhere , except perhaps at the interface .",
    "( we ignore for the moment the fact that each step takes a different amount of time in different regions . ) in fact , in the special case of the ito calculus the random walk is unbiased at the interface as well , since in that case eqs .",
    "( [ pminussucc ] ) and ( [ pplussucc ] ) give @xmath206 .",
    "in general , the trajectory of the particle can be thought of as consisting of segments of an unbiased random walk terminating at the interface ; every time the interface is reached , the particle chooses to continue on the left side with the probability @xmath207 or on the right side with the probability @xmath208 .",
    "each such choice is independent of all of the previous choices and of whether the particle has reached the interface from the left or from the right .",
    "we will use this consideration in sec .",
    "vib and in appendix b to derive some properties of the system .      in the second mc approach ,",
    "the probability of remaining still , @xmath209 , is independent of the viscosity and instead the length of a successful jump is dependent on the viscosity . to keep the particle on - lattice ,",
    "we introduce a mesh with a different step in the two regions ( fig .",
    "[ fig : mcii ] ) . from eqs .",
    "( [ d_lmc ] ) and ( [ diffzeta ] ) , when @xmath209 and @xmath210 are fixed , the mesh step @xmath211 , so the mesh steps on the left and right sides are , respectively , @xmath212 where @xmath213 and @xmath214 are constants and @xmath215 while it is possible to put the interface at one of the lattice sites , as in mc i , we now place it between two sites to illustrate the possibility of this choice .",
    "the distance between the two sites closest to the interface ( one on each side ) is chosen to be the average of the mesh steps on the two sides , @xmath216 , although the exact value does not matter in the limit @xmath217 .",
    "for all sites not adjacent to the interface , on both sides , the probabilities of the moves are the same , with @xmath218 and the probability of remaining still , @xmath209 , is the same at all these sites , as well .",
    "the choice of @xmath209 is in principle arbitrary .",
    "while @xmath219 seems the most efficient choice at first glance , since the particle would move at every step of the algorithm , this , as mentioned , can introduce artifacts and , in fact , we have recently shown  @xcite that @xmath220 is optimal from the point of view of accuracy of the algorithm and may even be more efficient than @xmath219 , since a coarser mesh can be used to achieve the same accuracy .",
    "for this reason , we choose @xmath220 in this work .    as in mc",
    "i , the probabilities of the moves need to be modified for sites adjacent to the interface .",
    "a reasonable choice is to allow the probabilities of the two moves crossing the interface to change but keep the probabilities of the two other moves leaving these sites that do not cross the interface the same as given by eq .",
    "( [ ppm2 ] ) .",
    "we use the following notation for the probabilities of the moves that are allowed to change : @xmath221 denotes the probability of the move to the right from the site left of the boundary and @xmath222 is the probability of the move to the left from the site right of the boundary .",
    "this notation is similar to that we used for mc i , but it has a somewhat different meaning : in mc i these were the probabilities of the moves from the same interface site , but here these moves cross the interface starting from different sites .",
    "the detailed balance condition is @xmath223 where @xmath224 ( @xmath225 ) is the average number of particles per site to the left ( right ) of the interface in the stationary state . to relate this condition to the stationary distribution of eq .",
    "( [ equil ] ) , we need to keep in mind that the density of sites ( their number per unit length ) is different in the two regions .",
    "the particle concentration @xmath78 is proportional to both the number of particles per site and the site density ; the latter is inversely proportional to the mesh step .",
    "therefore , using eqs .",
    "( [ al ] ) and ( [ ar ] ) for the mesh steps , @xmath226 or @xmath227 again , as in mc i [ cf . eq .",
    "( [ ratio1 ] ) ] , we have one equation for two probabilities . as an additional condition",
    ", we choose @xmath228 which , together with eq .",
    "( [ ratio2 ] ) , gives @xmath229,\\label{p0p}\\\\ p^0_{{{\\rm ii}}-}&=&p^{l , r}_{{{\\rm ii}}\\pm}{\\rm min}\\left[1,\\left(\\frac{\\eta_l}{\\eta_r}\\right)^{1/2-\\alpha}\\right]\\label{p0n}.\\end{aligned}\\ ] ] this is a simple choice that guarantees that both @xmath221 and @xmath222 are always between zero and one for any value of @xmath39 and any choice of @xmath209 .",
    "note that always either @xmath230 or @xmath231 , so only one of these probabilities ( at most ) gets modified compared to the bulk value .",
    "the corresponding probability of staying put is changed accordingly . in the special case @xmath105 ( stratonovich calculus ) ,",
    "@xmath232 , so all probabilities of all moves are the same ( fig .",
    "[ fig : mcii ] ) . while this means that for @xmath105 there is no flux across the interface when @xmath233 , this is not the same as @xmath234 ( a uniform particle distribution ) .",
    "we note that a similar , but off - lattice approach was successfully used recently by one of the authors  @xcite to treat a problem corresponding to the @xmath88 case .",
    "it is instructive to compare the mc ii algorithm described here in the ito case ( @xmath68 ) to the bd algorithm , a single step of which is given by eq .",
    "( [ stochde ] ) with @xmath68 , specifically its variant with the random number @xmath70 .",
    "similarities are obvious : in both cases the time step is fixed and the jump size depends on what region the particle is in , being proportional to @xmath235 ( or inversely proportional to @xmath236 ) .",
    "however , what happens at the interface is different for these two algorithms . in mc ii , in order to stay on - lattice , the lengths of the jumps across the interface are chosen to be the same in both directions , but in bd the jump length depends on what region the jump originates in and thus is different for the left - to - right jumps and the right - to - left jumps .",
    "this difference is crucial and makes it possible to achieve the correct particle concentration jump across the interface in the stationary state while keeping the probabilities of all jumps the same ( effectively equal to @xmath237 , since there is no bias in bd and no staying at rest ) , whereas in mc ii obtaining this concentration jump requires setting @xmath238 .",
    "this is actually a rather subtle issue . indeed , in the stationary state , the left - to - right and the right - to - left fluxes across the interface should be equal .",
    "but then one could argue for the bd algorithm that since the flux is equal to the product of the particle concentration and the jump size and the latter is proportional to @xmath235 , then the stationary concentration ratio @xmath239 should be equal to @xmath240 , instead of the required @xmath241 .",
    "the reason this argument is wrong is that instead of a perfectly sharp jump in the concentration , it actually changes from @xmath242 to @xmath243 over a length scale on the order of the length of the particle jump .",
    "therefore the particle concentrations at the points where the jumps across the interface originate are not equal to the values far from the interface ( @xmath242 and @xmath243 , respectively ) .",
    "note that , while this is true even when @xmath43 is continuously distributed , in the case @xmath70 there is an additional complication that affects the practical use of the bd algorithm : the particle concentration keeps varying wildly even far away from the interface , with the typical length scale of the oscillations again on the order of the particle jump size . as a consequence ,",
    "the results depend strongly on how the data are binned .",
    "for this reason , using @xmath43 from a discrete set is best avoided in practical applications of the bd algorithm .",
    "the system is defined such that the left side extends from a wall at @xmath244 to the interface at @xmath245 and the right side extends from the interface to a wall at @xmath246 , where @xmath247 is the total length of the system .",
    "thus the interface is placed equidistant between the walls .",
    "for all simulations described in this paper , the particle is initially placed at the interface . in the case of the mc ii algorithm ,",
    "when there is no site exactly at the interface , it starts at one of the sites immediately to the left and to the right of the interface with equal probabilities .",
    "two types of simulations are performed .",
    "first , simulations with _ reflecting walls _ at @xmath244 and @xmath248 are conducted . to obtain the stationary particle distributions , relatively long simulations must be performed and thus we focus on a single case where @xmath249 .",
    "additional simulations with _ absorbing walls _ are performed to investigate whether particles preferentially end up at one wall ( herein referred to as an _ ultimate preferential direction _ ) and to measure the conditional mean first passage time ( mfpt ) to each wall . in most of these simulations ,",
    "the viscosity on the left - hand side , @xmath0 , is held fixed and the viscosity on the right - hand side is varied from @xmath250 to @xmath251 ; we also use @xmath252 or even , in appendix a , @xmath253 .    for _ static _ quantities , such as the stationary particle distributions and the ultimate preferential direction , only the ratio of the viscosities across the interface influences the results  the actual values of the viscosities and the proportionality factor @xmath18 in eq .",
    "( [ zetavseta ] ) do not matter .",
    "indeed , for instance , looking at the expressions for the probabilities of the moves of the mc i algorithm [ eqs .",
    "( [ ppmlr1 ] ) , ( [ pslr1 ] ) , ( [ ps1int ] ) , ( [ p0m1 ] ) , and ( [ p0p1 ] ) ] , if @xmath0 and @xmath1 are both changed by some factor and at the same time the adjustable constant @xmath158 is changed by the same factor , then the probabilities of the moves remain the same . what does change is the time scale , since changing @xmath158 changes the time step @xmath166 , according to eq .",
    "( [ eta0i ] ) , which corresponds to speeding up or slowing down the _",
    "dynamics_. since all approaches are expected to also give dynamically correct results such that the mfpts and the decay of the transient behavior towards the stationary state should be consistent for any particular @xmath39 value ( with bd corresponding to @xmath68 and ld to @xmath88 ) , a comparison of the dynamical quantities between the approaches is also meaningful . to make such comparisons , it is obviously necessary to know how the time steps of different algorithms are related .",
    "it is convenient to choose the time step of the mc i algorithm as the unit of time and express all other times and time steps in terms of this unit .",
    "that is , numerically , the time step of mc i will be chosen to be @xmath254 likewise , the mesh step of mc i is chosen as the unit of length ( @xmath255 ) . in these units , we use the system size @xmath256 , except for a single case in appendix a. thus there are 51 lattice sites at integer values of @xmath2 from @xmath257 to @xmath258 , and the interface at @xmath245 coincides with one of the sites as appropriate .",
    "the viscosity is expressed in units of @xmath158 ; thus , numerically @xmath259 according to eq .",
    "( [ eta0i ] ) , in these units @xmath260    in mc ii , we choose arbitrarily @xmath261 in eqs .",
    "( [ al ] ) and ( [ ar ] ) .",
    "the lattice is placed in such a way that the interface is at distance @xmath262 from the site adjacent to it on the left and at distance @xmath263 from the site on the right . for the leftmost site , @xmath264 , and for the rightmost site , @xmath265 .",
    "it is convenient to express the viscosity in units of @xmath214 .",
    "however , for direct comparison with mc i the viscosity unit should be the same in both cases ; thus we need @xmath266  ( @xmath267 ) .",
    "using eqs .",
    "( [ eta0i ] ) and ( [ eta0ii ] ) , @xmath268 so @xmath269 or , using the chosen values for @xmath213 and @xmath167 and keeping in mind that we have chosen the rest probability in mc ii @xmath220 ( as explained in sec .",
    "[ sec : mcii ] ) , @xmath270    while choosing the values of the viscosities , we need to keep in mind that in mc i the viscosities can not be smaller than @xmath271 . for the reflecting wall simulations , @xmath0",
    "is set to 2 , since , as we have mentioned , using a value too close to unity can introduce artifacts in the distribution function .",
    "correspondingly , @xmath272 for @xmath273 . for the absorbing wall case , for the simulations where we vary @xmath274 from 0.1 to 10 , @xmath0 is set to 10 so that @xmath1 can be varied from 1 to 100 .",
    "using @xmath275 is not a problem in this case , since we are not interested in the details of the particle distribution or the fpt distribution , but only the mfpts , in which case all oscillations and other artifacts average out . for @xmath252 and 1000 , we use @xmath276 , as in the reflecting case , so @xmath1 is respectively 100 and 2000 .    for both mc algorithms , when the particle attempts to move left from the leftmost site or right from the rightmost site , in the case of absorbing boundaries it disappears and the simulation is stopped , while in the case of reflecting boundaries the move is rejected .    as for the md simulations ( bd and ld )",
    ", we likewise use @xmath256 and treat the particle as pointlike in the sense that it can approach the walls infinitely closely .",
    "the random terms in the equations of motion are normally distributed .",
    "when attempting to cross a wall , the particle disappears in the absorbing case and is `` reflected '' in the reflecting case .",
    "the latter means that , for example , when the particle crosses the right wall at @xmath246 and would end up at @xmath277 , it is placed at @xmath278 instead and in the ld case the sign of the particle velocity is changed ; similarly for crossing the left wall .",
    "the equations of motion that are solved numerically [ eqs .",
    "( [ sde_d ] ) and ( [ ld ] ) , respectively ] contain the diffusivity @xmath24 .",
    "for comparison to mc , it needs to be expressed in terms of the viscosity given in the same units as in mc simulations , that is , in units of @xmath158 . using eqs .",
    "( [ diffzeta ] ) and ( [ kappa ] ) , in these units @xmath279 for the bd time step @xmath41 , it is reasonable to choose a value similar to the time resolution of the mc schemes . we have chosen @xmath280 for simulations with reflecting boundaries and @xmath281 for simulations with absorbing boundaries . while the latter may appear too large , we have checked that using a ten times smaller step produces equivalent results .",
    "ultimately , this is not surprising : what matters is that the time step is much smaller than the typical time that it takes the particle to reach the boundary starting at the interface , and this condition is satisfied .",
    "the situation with ld is somewhat more complicated .",
    "first of all , the initial velocity of the particle needs to be specified ; it is chosen equal to either @xmath282 or @xmath283 at random .",
    "second , there is one other relevant combination of parameters , @xmath284 , and the associated time scale , @xmath285 .",
    "it determines the inertia in the system , in particular , the correlation time of the particle velocity ( or the time of relaxation to the terminal velocity ) .",
    "since the intent is to model an overdamped system in which inertia is negligible , this time scale should be small , in any case smaller than the time it takes the particle to reach the wall from the interface .",
    "we chose @xmath286 for reflecting boundaries and @xmath287 for absorbing boundaries . in the least favorable case ,",
    "@xmath288 for absorbing boundaries , the relaxation time is @xmath289 .",
    "the typical particle displacement over this time is @xmath290 which is less than a factor of 2 smaller than @xmath291 .",
    "while some discrepancies between ld and the mc and analytic results are indeed found at the lowest viscosities studied , good agreement is obtained for the majority of @xmath1 values .",
    "the time step in ld should be much smaller than the relaxation time ; we choose @xmath292 for reflecting boundaries and @xmath293 for absorbing boundaries .",
    "the least favorable case is the largest @xmath16 in our series for absorbing boundaries , @xmath294 ( in the separate runs with @xmath1=2000 we do not use ld , only mc i ) .",
    "the relaxation time in this case is @xmath295 , so this condition is satisfied .",
    "note that the time step for ld is much smaller than for bd and in fact , ld is the most time - consuming algorithm of all those considered in this paper .",
    "this is expected , since in ld the time step should be much smaller than the relaxation time , which should itself be small ; we note , however , that the efficiency of the ld algorithm could be improved without sacrificing its accuracy by using different @xmath284 and @xmath41 for different viscosity ratios .",
    "in this section , we look at the particle concentration distributions for the case when the particles start at the interface .",
    "we first present the distributions for the ito and isothermal calculi using the mc i and mc ii algorithms , comparing them with the results obtained using bd ( for ito ) and ld ( for isothermal ) .",
    "we then compare the distributions for several different values of @xmath39 using one of the mc algorithms ( mc i ) . in all cases ,",
    "we show the distributions at a time shortly after the start of the simulation and at a long time corresponding to the stationary state .",
    "in addition , for the ito and isothermal calculi we also include one intermediate time , such that the distribution on the low - viscosity side has already reached the quasistationary state , but that on the high - viscosity side still resembles the short - time distribution . for each curve , the total number of runs is 100000 . in each run , a single particle is simulated and its position is determined at the times of interest . in md simulations , the positions are binned with a unit bin size and the centers of the bins at half - integer @xmath2 .",
    "the plotted values @xmath296 are proportional to the numbers of particles @xmath171 found at the given time at the site ( or in the bin ) @xmath134 and inversely proportional to the distance between the sites ( width of the bin ) .",
    "the distributions are normalized so the area under the curve is unity ( thus , in effect , these are probability density distributions ) . in particular , for mc i , bd and ld , since the distance between the sites ( or the width of the bins ) is unity , the normalization condition is @xmath297 where the sum runs over all sites ( bins ) , and thus @xmath298 for mc ii , @xmath299 where the first sum is over the sites in the left region and the second sum is over the sites in the right region , so @xmath300    we also plot the ratio of the numbers of particles on the right and left sides as a function of time . when calculating this ratio , particles exactly at the interface ( which is possible in the mc i case ) are ignored .",
    "the probability distributions @xmath78 as functions of position at three different times are shown in fig .",
    "[ fig : dist_ito](a)(c ) , for all algorithms yielding ito calculus ( mc i , mc ii and bd ) . in fig .",
    "[ fig : dist_ito](a ) , the distribution shortly after starting the simulations , at time @xmath301 , is shown . by this time ,",
    "only very few particles reach the walls , so the distribution is essentially the same as it would be in infinite space , without the walls . in this case ,",
    "theoretically the distribution is expected to follow @xmath302 this satisfies the diffusion equation  ( [ diffpieces ] ) in both regions , as well as the jump condition ( [ jump ] ) and the flux matching condition ( [ fluxcont ] ) , the latter because @xmath303 is zero both at @xmath304 and @xmath305 .    , @xmath306 and @xmath256 : particle concentration distributions , ( a ) at a short time , @xmath301 , ( b ) at an intermediate time , @xmath307 , and ( c ) at a long time , @xmath308 , as well as ( d ) the ratio of the number of particles on the right and left sides of the interface as a function of time , with the initial ( @xmath309 ) and final ( @xmath310 ) times of the transition period marked .",
    "all particles start at the interface in the middle of the system . in all plots ,",
    "the results obtained using both mc methods , as well as bd simulations , are shown.,scaledwidth=35.5% ]    thus the parts of the distribution on the left side ( l ) and the right side ( r ) should both have a gaussian form , but there should be a significant discontinuity in the distribution with a higher concentration of particles on the high viscosity side .",
    "these features are indeed reproduced in fig .",
    "[ fig : dist_ito](a ) .",
    "the discontinuity develops instantaneously ( in a simulation , within a few steps from the beginning ) and results from the trapping effect of high viscosity regions in the ito formulation .",
    "figure [ fig : dist_ito](c ) shows the distribution after a long time ( @xmath308 ) thus corresponding to the stationary state .",
    "while the transient piecewise - gaussian shape has disappeared , the discontinuity persists yielding a step - function form .",
    "recall the ito stationary state condition [ eq .",
    "( [ itostatio ] ) ] which , using @xmath311 , can be written as @xmath312 . hence , as expected , the probability density on l , where the viscosity is low , is less than on r , where the viscosity is high , and the ratio is @xmath313 given the normalization condition @xmath314 , @xmath315 for the case presented in fig .",
    "[ fig : dist_ito ] where @xmath256 , @xmath276 , @xmath306 , we have @xmath316 , @xmath317 . these values are indicated on fig .",
    "[ fig : dist_ito](c ) where @xmath318 as expected for @xmath319 .",
    "note that at short times [ as in fig .",
    "[ fig : dist_ito](a ) ] , the ratio of the probability densities immediately to the right of the interface and immediately to the left of the interface is also the same .",
    "in fact , this is true at all times , as follows from eq .",
    "( [ jump ] ) .",
    "the sharp drops in the distribution near the walls in fig .",
    "[ fig : dist_ito](c ) are discretization and binning artifacts .    in fig .",
    "[ fig : dist_ito](d ) , the ratio of the number of particles on r to l , denoted @xmath320 , is plotted as a function of time .",
    "this ratio is equal to the ratio of the areas under the parts of the distribution curves on r and l. note that @xmath320 increases from a value around 2 and saturates at a value around 4 . hence , there are always more particles on the high viscosity side : under ito conditions , the high viscosity side acts as a trap .",
    "while the saturation value agrees with the stationary state condition of ito calculus , it is interesting that , beyond extremely short time behavior which depends more on the simulation algorithm than the physics , the initial point for the increase during the transient portion is 2 . indeed , from eq .",
    "( [ itoshorttime ] ) valid at short times , the ratio should be @xmath321 .",
    "this is the ratio of the heights of the half - gaussians ( which is equal to @xmath322 ) multiplied by the ratio of their widths ( which is equal to @xmath323 ) . at longer times",
    ", the particles begin to find the edge of the system and bounce back .",
    "correspondingly , the system begins to move towards equilibrium where four times as many particles are found on the high viscosity side .",
    "the transition starts when the particles on the lower - viscosity side reach the boundary , which happens around time @xmath309 such that @xmath324 , thus @xmath325 , or , using eq .",
    "( [ dsimunits ] ) , @xmath326 where @xmath327 is the higher of the two values of the diffusivity and @xmath328 is the corresponding ( lower of the two ) value of the viscosity .",
    "the transition ends when the particles on the higher - viscosity site also reach the boundary , which occurs around @xmath329 for our values of the parameters ( @xmath256 , @xmath330 , @xmath331 ) , @xmath332 and @xmath310=5000 .",
    "these two times are marked on fig .",
    "[ fig : dist_ito](d ) .",
    "the time at which the distributions in fig .  [ fig : dist_ito](a ) are obtained is much smaller than @xmath309 , thus corresponding to the situation before the transition starts , and the value of the ratio @xmath320 at that time is indeed close to two , according to fig .",
    "[ fig : dist_ito](d ) . on the other hand , the time at which the distributions in fig .",
    "[ fig : dist_ito](c ) are obtained is much larger than @xmath310 and thus corresponds to the stationary situation after the transition has ended ; the value of @xmath320 is close to four .    in fig .",
    "[ fig : dist_ito](b ) , we show the distribution at time @xmath307 , which is between @xmath309 and @xmath310 . by time",
    "@xmath35 such that @xmath333 particles on the low - viscosity side would have traversed that side many times , so the distribution on that side should be nearly flat resembling the stationary distribution , but on the other hand , very few particles would have reached the wall on the high - viscosity side , so the distribution on that side should still be close to the short - time gaussian distribution .",
    "even though in our case the ratio @xmath334 is only four , so , strictly speaking , satisfying eq .",
    "( [ intermcond ] ) is impossible , fig .",
    "[ fig : dist_ito](b ) can still serve as a reasonable illustration of that regime .",
    "note that the distribution on the low - viscosity side is not truly stationary , but rather _ quasi - stationary _ , since there is a net outflow of particles to the high - viscosity side , as indicated by the gradual increase of @xmath320 between @xmath309 and @xmath310 [ see fig .",
    "[ fig : dist_ito](d ) ] .",
    "this outflow is slow enough for the distribution to remain nearly flat , but the height of the distribution gradually decreases .",
    "in essence , the height of the plateau on the low - viscosity side adiabatically follows the height of the peak on the high - viscosity side ( which decreases as this peak broadens ) , so that the boundary condition ( [ jump ] ) is satisfied at all times . on the other hand",
    ", this outflow is large enough that the slope of the distribution function is significantly nonzero immediately to the right of the interface in fig .",
    "[ fig : dist_ito](c ) .",
    "however , the viscosity ratio is rather small here and also @xmath35 is close enough to @xmath310 that particles have already started to reach the right wall ( note a nonzero particle concentration next to it ) .",
    "as we argue in appendix a , for a very high viscosity ratio and when the condition ( [ intermcond ] ) is truly satisfied , the derivative at @xmath305 is negligible and the distribution on the high - viscosity side is a gaussian .",
    "taking into account the general character of the distribution at intermediate times between @xmath309 and @xmath310 , we can also obtain approximately the time dependence of the ratio @xmath320 in this time interval .",
    "the number of particles on r , @xmath335 , is roughly proportional to @xmath120 times the width of the distribution on that side , which is @xmath336 .",
    "the number of particles on l , @xmath337 , is proportional to @xmath338 times the length of that part of the system , @xmath246 , which is time - independent .",
    "thus @xmath339\\sqrt{t}$ ] , and , given that , according to eq .",
    "( [ jump ] ) , the ratio in the square brackets is time - independent , @xmath340    this agreement between the theory at @xmath68 and the brownian dynamics results confirms that the bd simulations correspond to ito calculus .",
    "further , note the overall good agreement between the bd simulations and both mc approaches for all the results shown in fig .",
    "[ fig : dist_ito ] . considering factors such as discretization , binning , and noise ,",
    "the fact that the differences are small between the data sets is a convincing validation of the two mc approaches we have developed to simulate ito calculus .",
    "the equivalent plots for all algorithms yielding the isothermal calculus ( mc i , mc ii and ld ) are shown in fig .",
    "[ fig : dist_iso ] .",
    "note that the distributions are now continuous across the interface , in agreement with eq .",
    "( [ jump ] ) for @xmath88 . for the short time behavior shown in fig .",
    "[ fig : dist_iso](a ) , where , again , @xmath301 , the gaussian - like distribution on the left side is wider than that on the right side , as in the ito case .",
    "theoretically , the distribution at short times is given by @xmath341 which is the same as eq .",
    "( [ itoshorttime ] ) for the ito case , except for the prefactors that ensure the continuity across the interface .    , @xmath306 and @xmath256 : particle concentration distributions , ( a ) at a short time , @xmath301 , ( b ) at an intermediate time , @xmath307 , and ( c ) at a long time , @xmath308 , as well as ( d ) the ratio of the number of particles on the right and left sides of the interface as a function of time , with the initial ( @xmath309 ) and final ( @xmath310 ) times of the transition period marked .",
    "all particles start at the interface in the middle of the system . in all plots , the results obtained using both mc methods , as well as ld simulations , are shown . ]    at long times , in the stationary state , there is an equal probability to find a particle anywhere in the system , as is seen in fig .",
    "[ fig : dist_iso](c ) ( @xmath308 ) .",
    "this is consistent with the isothermal stationary state condition [ eq .",
    "( [ isostatio ] ) ] .",
    "the stationary value of the density is obviously given by @xmath342 the time dependence of the ratio of the number of particles on r over l is shown in fig .",
    "[ fig : dist_iso](d ) . here , the transient behavior begins from the ratio of approximately 0.5 .",
    "that is , given the bias at the interface to end up on the lower viscosity side , very rapidly there is a greater number of particles on l , and , contrary to the ito results where there are twice as many particles on the high viscosity side near the beginning , for the isothermal results there are half as many particles on the high viscosity side .",
    "this ratio can again be obtained by considering the peak height and width . here , the peak height is the same on both sides while the ratio of the widths is again @xmath343 . correspondingly , the ratio is @xmath344 .",
    "as the system moves towards equilibrium , @xmath320 again climbs and plateaus , but now it saturates at 1.0 in accord with the isothermal stationary state condition .",
    "the transition between the initial and the final values again starts around @xmath309 given by eq .",
    "( [ t1 ] ) and ends around @xmath310 given by eq .",
    "( [ t2 ] ) . at times between @xmath309 and @xmath310 ,",
    "the distribution is nearly flat ( quasi - stationary ) on the low - viscosity side and gaussian - like on the high - viscosity side , again , as in the ito case [ see fig .  [",
    "fig : dist_iso](b ) for @xmath307 ] .",
    "however , unlike in the ito case , we show in appendix a that even for a large viscosity ratio and @xmath346 , the slope at @xmath347 is significantly nonzero , and , in fact , the interface lies at the inflection point of the gaussian - like curve rather than at its maximum . despite this , the crude arguments leading to eq .",
    "( [ nrovernl ] ) still apply , so we expect that time dependence to still be approximately valid here .",
    "we compare the time dependences of @xmath320 for different calculi in the next section .    in all four plots , again , there is good agreement between all three algorithms .      in fig .",
    "[ fig : dist_all ] , we compare the results for the particle distributions and the ratio @xmath320 for several different calculi ( values of @xmath39 ) , including the already considered ito ( @xmath68 ) and isothermal ( @xmath88 ) limit cases , using the mc i algorithm .",
    "essentially identical results are obtained using mc ii ( not shown ) . figure  [ fig : dist_all](a ) shows the distributions at @xmath301 and fig .",
    "[ fig : dist_all](b ) presents the distributions at @xmath308 . at short times [ fig .",
    "[ fig : dist_all](a ) ] , the distribution is always piecewise - gaussian with @xmath348 there is a jump at the interface in all cases , except @xmath88 , in agreement with eq .",
    "( [ jump ] ) . at long times [ fig .",
    "[ fig : dist_all](b ) ] , the distribution is piecewise - uniform , with @xmath349 which follows from eq .",
    "( [ equil ] ) for the stationary distribution .",
    "again , there is a jump for @xmath125 . in fig .",
    "[ fig : dist_all](c ) , the ratio @xmath320 is plotted .",
    "the short - time value of this ratio is @xmath350 which is the product of the ratio of the peak widths [ @xmath351 ) and the ratio of the peak heights [ @xmath352 .",
    "the long - time ( stationary - state ) value of @xmath320 is @xmath353 for @xmath354 , @xmath320 is always larger than 1 , so there are always more particles on the higher - viscosity r side than on l. for @xmath105 , the ratio is one initially , but then grows above unity . for @xmath88 , there are always more particles on the _ lower - viscosity _ site , but the ratio approaches unity from below as @xmath355 . finally , for @xmath356 , there are more particles on the low - viscosity side initially , but the ratio crosses unity at a finite time and eventually there are more particles on the higher - viscosity side . the transition between the short - time and the long - time values of @xmath320 is roughly between @xmath309 and @xmath310 given by eqs .",
    "( [ t1 ] ) and ( [ t2 ] ) , and the time dependence should still be roughly given by eq .",
    "( [ nrovernl ] ) .     specified in the legend , for @xmath276 , @xmath306 and @xmath256 : particle concentration distributions , ( a ) at a short time , @xmath301 , and ( b ) at a long time , @xmath308 ; ( c ) and ( d ) the ratio of the number of particles on the r and l sides of the interface [ rescaled in ( d ) as indicated ] as a function of time , with the initial ( @xmath309 ) and final ( @xmath310 ) times of the transition period marked . the rescaling factor in ( d ) is chosen so that the values coincide at both small and large times , yet in the intermediate region small differences are observed .",
    "the straight line indicates the predicted @xmath357 behavior .",
    "all particles start at the interface in the middle of the system . ]",
    "note that at both small and large times , if the particle distribution on l is multiplied by @xmath358 , then the resulting function is the same for all @xmath39 : this rescaling eliminates the jump at zero , and the shapes of the distributions in a given region and at any given time are calculus - independent , both at short times ( when they are gaussian with the calculus - independent width ) and at long times ( when they are flat ) .",
    "a reasonable question then is if this is also true at intermediate times and thus at all times .",
    "the answer , perhaps somewhat surprisingly , is _",
    "no_. this can be seen by comparing the shapes of the intermediate - time distributions for the ito [ fig .",
    "[ fig : dist_ito](b ) ] and isothermal [ fig .",
    "[ fig : dist_iso](b ) ] cases that are indeed somewhat different , and , as mentioned , the difference is significant in the high - viscosity - ratio limit ( see appendix a ) .",
    "this difference is also easy to explain : if we take , for example , the solution for the ito case and multiply its left half by @xmath274 , the resulting function will satisfy the diffusion equation ( [ diffpieces ] ) and the jump condition ( [ jump ] ) for @xmath88 , but _ not _ the flux continuity condition ( [ fluxcont ] ) , since only the left - hand side of the latter will be multiplied by @xmath274 , but not the right - hand side .",
    "the cases @xmath359 and @xmath355 are exceptions , because in these limits @xmath303 is zero at both @xmath304 and @xmath305 . however , for intermediate times this can not be the case , since there _ must _ be some net flux between the two sides , or otherwise @xmath320 would remain constant . as a consequence , while the curves in fig .",
    "[ fig : dist_all](c ) for different @xmath39 do look similar , and , in particular , the transition between the low - time and the high - time values of @xmath320 occurs over _ roughly _ the same time interval and according to _ approximately _ the same @xmath357 dependence in all cases , these curves are not perfect rescaled copies of each other : multiplying these functions by @xmath360 so they match at @xmath359 and @xmath355 does not make them coincide everywhere , as illustrated in fig .  [",
    "fig : dist_all](d ) , where small differences between the rescaled curves around @xmath310 are apparent .",
    "that plot also compares the curves with the @xmath361 dependence predicted for large viscosity ratios ; the agreement is reasonable given that in our case the ratio @xmath362 is not large .",
    "we now describe the results of simulations with _ absorbing _ walls , that is , each single - particle simulation run is stopped once the particle reaches one of the two walls . for the ito and isothermal calculi , we first look at whether the particles prefer to end up on one of the walls ( i.e. , whether there is an _ ultimate preferential direction _ ) and find the conditional mfpts , separately for particles reaching each wall . the _ ultimate _ preference is then compared to the preference of the particle to spend more time on one or the other side , which is analyzed in two different ways . unlike the case of reflecting boundaries , where a single set of viscosities was considered , here we vary the ratio of the viscosities , with the viscosity on l kept constant . for each set of viscosities , we carry out 10000 single - particle runs , again starting at the interface , as described in sec .",
    "[ protocol ] .",
    "for the ito calculus we also obtain the full conditional fpt distributions for a single representative viscosity ratio using @xmath363 runs .",
    "results for the absorbing wall simulations in the case of ito calculus are shown in fig .",
    "[ fig : pd_ito ] . figure [ fig : pd_ito](a ) displays the fraction of events absorbed on r , @xmath364 ( dashed lines ) and l , @xmath365 ( solid lines ) for all three algorithms . for each algorithm at any viscosity ratio ,",
    "the number absorbed at l equals the number absorbed at r within error .",
    "thus , under ito conditions , there is no ultimate preferential direction in the system .",
    "this result may seem paradoxical at first , given that for large @xmath274 there are much fewer particles on l than on r _ at any given moment of time _ , which we have seen for reflecting boundaries [ fig .",
    "[ fig : dist_ito](d ) ] and which turns out to be true for absorbing boundaries as well .",
    "the primary reason for the equality in fig .",
    "[ fig : pd_ito ] ( a ) is that particles diffuse faster on l , so even a smaller concentration creates a significant flux towards the left wall .    , @xmath256 , and varying @xmath1 : ( a ) the percentage of particles absorbed by l ( solid lines ) and r ( dashed lines ) walls ; ( b ) the mfpt under the condition that the particle is absorbed by the left wall ( solid lines ) and by the right wall ( dashed lines ) .",
    "all particles start at the interface in the middle of the system . in both plots ,",
    "the results obtained using both mc methods , as well as bd simulations , are shown .",
    "black lines in ( b ) are linear fits to the averages of all three methods.,scaledwidth=40.0% ]    the conditional mfpts to each wall ( which we denote @xmath366 and @xmath367 ) are plotted in fig .",
    "[ fig : pd_ito](b ) .",
    "as would be expected , the time to the lower viscosity side is always less than the time to the high viscosity side with an intersection corresponding to equal times at @xmath368 .",
    "a less obvious fact is that the two times are always of the same order of magnitude even when the viscosities are very different .",
    "in fact , both dependences are linear as demonstrated by straight - line fits ( black lines ) to the averages of all three algorithms , and the slope for the r data is , within the uncertainty , two ( @xmath369 ) times that of the slope for the l data , so the ratio of the two times approaches two as @xmath370 .",
    "this may seem surprising , given that the time @xmath309 [ eq .  ( [ t1 ] ) ] around which a significant ( not exponentially small ) number of particles first reaches the left wall is much smaller in this limit than the corresponding time @xmath310 [ eq .  ( [ t2 ] ) ] for the right wall .",
    "the explanation is that , while it is indeed true that the particle flow to the wall on the low - viscosity side starts at time @xmath371 , it continues until time @xmath372 , as the particles keep `` leaking '' from the high - viscosity side until those that have not been absorbed by the wall on the low - viscosity side are absorbed by the other wall .",
    "even if the means are of the same order of magnitude , the conditional first - passage time _ distributions _",
    "@xmath373 are very different when the viscosities are very different . for the wall on the low - viscosity side",
    ", the flux reaches its maximum very fast , by time @xmath371 and then decreases very gradually ( as a power law ) until time @xmath372 , after which it decays exponentially .",
    "but for the wall on the high - viscosity side , the flux is essentially zero until time @xmath372 and then rises and decays relatively quickly .",
    "this behavior of the distributions is illustrated in fig .",
    "[ fig : distlr ] obtained for a large viscosity ratio ( @xmath276 , @xmath374 , so @xmath252 ) using the mc i method with the waiting time selected from a distribution as given by eq .",
    "( [ ndistr ] ) .",
    "the best fit to the power - law region has the exponent @xmath375 ; we show in appendix a that in the limit of a very large viscosity ratio this exponent is @xmath376 .",
    ", @xmath374 , @xmath256 obtained using the mc i algorithm .",
    "times @xmath309 and @xmath310 given by eqs .",
    "( [ t1 ] ) and ( [ t2 ] ) , respectively , are marked.,scaledwidth=40.0% ]    to derive the properties revealed in fig .",
    "[ fig : pd_ito ] , consider the variant of the mc i algorithm with all steps successful ( no staying put ) and the time increment at each step @xmath377 given by eq .",
    "( [ allsucc ] ) ( see sec .",
    "[ mciallsucc ] ) . recall that",
    "in the ito formulation , there is no bias at the interface [ from eqs .",
    "( [ pminussucc ] ) and ( [ pplussucc ] ) , @xmath378 , or anywhere else in the system . hence , the trajectory of a particle is just an unbiased random walk , except for the fact that the time increment at each step changes depending on what side of the interface the particle is at .",
    "this exception , of course , does not change the fact that this random walk is equally likely to first reach the left or the right wall , since it starts at equal distances from them , which explains the result in fig .  [",
    "fig : pd_ito](a ) . to get insight into the results for the mfpts in fig .",
    "[ fig : pd_ito](b ) , we use the fact that if a particle is released equidistant between two absorbing walls that are at distance @xmath247 from each other and this particle does a random walk with step size unity eventually reaching the right - hand wall , then on average it spends @xmath379 steps on the right - hand side and @xmath380 steps on the left - hand side ( see appendix b )",
    ". then @xmath381,\\ ] ] and similarly , @xmath382,\\ ] ] where @xmath383 and @xmath384 are the time steps [ given by eq .  ( [ allsucc ] ) ] on l and r , respectively , or , using the conventions ( [ tauconv ] ) and ( [ etaconv ] ) , @xmath385,\\label{taur}\\\\ \\tau_l&=&\\frac{d^2\\eta_l}{12}[2+(\\eta_r/\\eta_l)].\\label{taul}\\end{aligned}\\ ] ] for @xmath386 , the dependence of both times on @xmath274 is indeed linear , and the ratio of the slopes is two , in agreement with the data in fig .",
    "[ fig : pd_ito](b ) . in our case (",
    "@xmath256 , @xmath387 ) , @xmath388 this should be compared with the fits to the data ( black lines in fig .",
    "[ fig : pd_ito ] ) , which are @xmath389 the slopes are indeed in agreement ; the small disagreement in the intercepts ( about 10% ) is likely due to discretization effects . in the limit @xmath370 , eqs .",
    "( [ taur ] ) and ( [ taul ] ) become @xmath390 where @xmath310 is given by eq .",
    "( [ t2 ] ) .",
    "this shows that in this limit both times become independent of the lower viscosity and in particular , both are @xmath372 .",
    "we discuss the relation between this result and the fpt distribution in appendix a.      the same data for the case of isothermal calculus are shown in fig .",
    "[ fig : pd_iso ] .",
    "there are significant quantitative and qualitative differences compared to the case of ito calculus .",
    "first , examining fig .",
    "[ fig : pd_iso](a ) , there is a clear ultimate preferential direction in the system .",
    "when @xmath391 , approximately 90% of the particles are absorbed at the r wall .",
    "conversely , when @xmath392 , 90% of the particles are absorbed at the l wall . plotting the data with a log scale for the viscosity ratio [ inset to fig .",
    "[ fig : pd_iso](a ) ] demonstrates that this symmetry holds for all simulated viscosity ratios : @xmath393 where @xmath394 are the probabilities of absorption at the left ( right ) wall when the ratio of viscosities on r and on l is @xmath395 .",
    "this symmetry is a necessary outcome considering that in the algorithms , it is only the ratio of viscosities , and not the absolute value , which influences the dynamics ( beyond simply making all events take longer ) .",
    "the ultimate preferential direction under isothermal conditions arises from the bias at the interface favoring the low viscosity side .",
    "since this bias increases with a larger disparity in viscosities , the strength of the preference in direction also grows .",
    "it must , however , saturate at 100% resulting in the behavior shown in fig .",
    "[ fig : pd_iso](a ) .    , @xmath256 , and varying @xmath1 : ( a ) the fraction of particles @xmath396 absorbed by l ( solid lines ) and r ( dashed lines ) walls ; ( b ) the mfpt under the condition that the particle is absorbed by the left wall ( solid lines ) and by the right wall ( dashed lines ) .",
    "black lines in both plots are theoretical dependences derived in the text .",
    "all particles start at the interface in the middle of the system . in both plots , the results obtained using both mc methods , as well as ld simulations , are shown.,scaledwidth=40.0% ]    the mfpts , shown in fig .",
    "[ fig : pd_iso](b ) , are also quite different from those corresponding to the ito condition .",
    "again , as expected , the time to the lower viscosity side is lower than the time to the high viscosity side with an intersection at @xmath368 .",
    "however , the dependence across the entire viscosity range is clearly not linear .",
    "in fact , considering data for which @xmath397 , while @xmath367 does increase linearly with increasing @xmath398 ( albeit only when this ratio is large ) , @xmath366 appears to saturate .    to understand the results in fig .",
    "[ fig : pd_iso ] , we turn again to the variant of the mc i algorithm with all steps successful . for generality , we consider an arbitrary @xmath39 and then specialize to @xmath88 . for @xmath84 , the segments of the particle trajectory between visits to the interface site are still random walks , but when the particle is at the interface , it chooses to continue on l or on r with the probabilities given by eqs .",
    "( [ pminussucc ] ) and ( [ pplussucc ] ) , respectively .",
    "each such trajectory segment is contained entirely either within the left half or within the right half and for brevity , we refer to these groups of segments as left and right segments .",
    "since the probabilities to reach the respective wall during the left and right segments are equal , the total probability to reach the left wall , @xmath365 , is equal to the fraction of left segments , which in its turn is equal to the probability to start a left segment while at the interface , which is @xmath207 . correspondingly , the probability to reach the right wall , @xmath364 , is @xmath208 .",
    "so @xmath399 note that @xmath400 for @xmath370 whenever @xmath401 , whereas for @xmath68 , @xmath402 , as we have seen in the previous section . in the isothermal case ( @xmath88 )",
    "@xmath403 these functions are plotted in fig .  [",
    "fig : pd_iso](a ) , and agreement with the simulation data is excellent .",
    "equations  ( [ piliso ] ) and ( [ piriso ] ) satisfy the symmetry condition ( [ symm ] ) . at @xmath404 , @xmath405 , while at @xmath406 , @xmath407 , again , in agreement with the simulations .    to calculate the mfpts",
    ", we use the result obtained in appendix b that for a random walk that is unbiased , except at the interface ( where it chooses to go left with probability @xmath207 or right with probability @xmath208 ) , the mean number of steps that the walk absorbed by the right wall spends on r is @xmath408 while on l it spends on average @xmath409 steps .",
    "then the mfpt for the walk ending on the right wall is @xmath410 where we have used eq .",
    "( [ allsucc ] ) for @xmath383 and @xmath384 and conventions ( [ tauconv ] ) and ( [ etaconv ] ) . for walks ending on the left wall , analogously there are on average @xmath411 steps on l and @xmath412 steps on r , and then @xmath413 in particular , in the isothermal case ( @xmath88 ) , @xmath414 equations  ( [ tauriso ] ) and ( [ tauliso ] ) with @xmath387 and @xmath256 are plotted in fig .",
    "[ fig : pd_iso](b ) .",
    "the agreement with the simulations is very good ; discrepancies can be attributed to discretization effects as well as inertial effects in the ld case .",
    "equations  ( [ taur ] ) and ( [ taul ] ) are recovered from eqs .",
    "( [ taurgen ] ) and ( [ taulgen ] ) for @xmath68 . when @xmath274 is large , eqs .",
    "( [ taurgen ] ) and ( [ taulgen ] ) give @xmath415 @xmath416 for @xmath386 , this always gives a linear dependence on @xmath417 for @xmath367 , regardless of @xmath39 , and , unsurprisingly , @xmath418 , again for any @xmath39 .",
    "for @xmath366 , the dependence is @xmath419 , which is linear for @xmath68 , reproducing the result of the previous section , sublinear for @xmath420 , and a constant for @xmath88 , in agreement with fig .",
    "[ fig : pd_iso](b ) . note also that @xmath366 is now of order @xmath421 .",
    "this is determined by the power - law region between @xmath309 and @xmath310 in the fpt distribution that still exists for @xmath401 , as discussed in appendix a.      it is interesting to compare the preferences of the particles to be absorbed by a particular wall ( the _ ultimate preferential direction _ at the end of the trajectory ) to their preference for a particular side at earlier times .",
    "the problem can be formulated in different ways .",
    "first , we can take a sample of particles , calculate the total combined time spent by them on a particular side , and divide by the total combined duration of all trajectories .",
    "obviously , this is the same as the average time that a trajectory spends on a particular side divided by the total average duration of the trajectory . using again the mc i algorithm with all moves successful",
    ", we note that the average number of steps in each segment is the same for left and right segments . denoting the average total number of steps @xmath195 and given that the fraction of left segments is @xmath207 , as discussed in the previous section , the average time a trajectory spends on l is @xmath422 similarly the average time on r is @xmath423 and then the fractions of the time on l and r are @xmath424 these functions for @xmath68 , 0.5 , and 1 are plotted in fig .",
    "[ fig : frac1](a ) together with the results of mc i simulations in these cases , and agreement is excellent .",
    "note that these probabilities are different from the probabilities to reach a particular wall , @xmath396 , given by eqs .",
    "( [ pil ] ) and ( [ pir ] ) .",
    "in particular , while for ito @xmath425 , @xmath426 when @xmath427 .",
    "conversely , for isothermal @xmath428 , but @xmath429 for @xmath427 .",
    "in fact , @xmath365 for ito equals @xmath430 for isothermal , and vice versa , or , in general , @xmath431 at the same time , @xmath432 coincide with the long - time probabilities for particles to be found on a particular side in the problem with reflecting boundaries [ cf .",
    "( [ longtime ] ) ] .    , @xmath256 , and varying @xmath1 , for ito , stratonovich , and isothermal calculi , fractions of time spent by trajectories on l and r defined in two different ways , as described in the text : ( a ) @xmath432 ; ( b ) @xmath433 .",
    "black lines are analytic dependences described in the text : eqs .",
    "( [ fl ] ) and ( [ fr ] ) in ( a ) and eqs .",
    "( [ phil ] ) and ( [ phir ] ) in ( b ) . in all cases ,",
    "particles start at the interface in the middle of the system.,scaledwidth=40.0% ]    second , we can also determine the fraction of the time spent on a particular side for each trajectory in the sample and then _ average these fractions_. we denote these averaged fractions @xmath433 .",
    "this definition gives more weight to short trajectories than the previous one , since a short trajectory contributes little to both the total duration of trajectories and to the duration on a particular side , the quantities that enter the definitions for @xmath432 , but it contributes as much as long trajectories to @xmath433 .",
    "the results for @xmath433 obtained in mc i simulations for @xmath68 , 1/2 , and 1 are shown in fig .",
    "[ fig : frac1](b ) .",
    "these results can be fitted using the approximate expressions , @xmath434 if the equalities ( [ phil ] ) and ( [ phir ] ) were exact , then , ( 1 ) @xmath435 for ito would be equal to @xmath436 for isothermal , and ( 2 ) @xmath435 and @xmath436 for stratonovich ( @xmath105 ) would be exactly @xmath237 for all @xmath274 .",
    "however , we have checked using several different lattice sizes and extrapolating to the infinite size ( results not shown ) that these relations are indeed approximate in the continuum limit and both statements ( 1 ) and ( 2 ) are approximate as well .",
    "comparing eqs .",
    "( [ pil ] ) , ( [ pir ] ) , ( [ fl ] ) , ( [ fr ] ) , ( [ phil ] ) , and ( [ phir ] ) , we note that the average fractions of time spent on the low - viscosity side calculated in both ways are always smaller than the probability to be absorbed by the wall on the low - viscosity side , but the second way of calculating the average gives a result intermediate between the other two .",
    "that is , for @xmath437 , @xmath438 the differences between these quantities are particularly striking when the viscosity ratio is large , in which case both `` @xmath439 '' signs in eq .",
    "( [ relation ] ) turn into `` @xmath440 '' , so there are ranges of @xmath39 where one or two of the quantities @xmath441 and @xmath435 approach zero while @xmath365 approaches unity .",
    "these relations are easy to explain by recalling that many particles that are eventually absorbed by the wall on the low - viscosity side linger until time @xmath442 ( up to @xmath372 ) necessarily spending much of that time on the high - viscosity side , which explains why @xmath443 .",
    "in addition , such long trajectories have a relatively larger weight when calculating @xmath441 than when calculating @xmath435 , which explains @xmath444 .",
    "note that nearly all trajectories reaching the wall on the high - viscosity side spend most of the time on that side .",
    "in this paper , we have developed two dynamical monte carlo algorithms for simulating the dynamics of a particle in the presence of sharp viscosity ( or , in general , diffusivity ) changes applicable to cases where different interpretations of the stochastic term in the corresponding overdamped langevin equation ( or calculi , such as ito , stratonovich , and isothermal ) are appropriate .",
    "the validity of these algorithms was demonstrated by the good agreement between the approaches and with brownian dynamics for the ito calculus and langevin dynamics for the isothermal calculus , as well as with theoretical predictions .",
    "we have argued that mc approaches , such as those developed here , can be particularly advantageous when a sharp interface is present in the system , since solving the overdamped langevin equation directly is problematic in this case , except for the ito calculus ( corresponding to bd ) , while the ld approach is only applicable to the isothermal case and generally more computationally intensive .",
    "while our simulations of particles on a 1d interval with the interface in the middle were intended primarily to validate our approaches , the system itself turned out to be rather interesting , with sometimes non - obvious properties that depend significantly on the choice of the calculus characterized by the parameter @xmath39 that can vary between zero ( ito ) and one ( isothermal ) .",
    "the differences between these extreme cases are summarized in table  [ tab : summary ] for a number of features of the system .",
    "not only do the features vary greatly between calculi , but there are unexpected symmetries between certain features ( indicated by arrows in the table ) . clearly , when modeling a physical system , the choice of calculus in deciding how to treat the interface must be done with great care .",
    "the goal for the future is extending the approaches presented here to more complex and physically interesting situations , such as two- and three - dimensional systems and biased diffusion under the action of a force .",
    "we currently work on applying these algorithms to studying the translocation of a polymer through a hole in a membrane , with fluids of different viscosities on the two sides of the membrane .",
    "of course , extension to the case of several interfaces is straightforward and a gradual change in viscosity can most likely be modeled as many interfaces one lattice site apart . besides this ,",
    "even in the simplest case considered here , the algorithms can be further improved : there are several free parameters that we have chosen arbitrarily , but that can be optimized to speed up the convergence to continuum , so even coarse discretization produces accurate results .",
    "it is useful to note that the physical scenario examined in this paper actually belongs to a more general class of problems .",
    "of course , the discrimination between different calculi arises for any stochastically driven process that can be written as an overdamped langevin equation in which the prefactor of the noise term is state - dependent @xcite .",
    "hence , while we have focused on diffusion in an inhomogenous medium , similar concepts can be applied to many problems including financial modeling @xcite , nmr spectroscopy @xcite , population growth models @xcite , and climate modeling @xcite .",
    "another interesting example is the work by smythe _",
    "@xcite examining noise - induced phase transitions where it was found that digital simulations produced results in agreement with the ito formulation while apparently equivalent analog simulations produced results that agreed with the stratonovich formulation .",
    "given these diverse scenarios , the simulation approaches introduced herein may be useful outside of the problem for which they were originally intended .",
    "this research was supported by grants from nserc and the university of ottawa .",
    "simulations were performed on the sharcnet computer system .",
    "to explain the power - law dependence of the fpt distribution in the intermediate - time regime between @xmath371 [ eq .",
    "( [ t1 ] ) ] and @xmath372 [ eq .  ( [ t2 ] ) ] , as observed in fig .  [ fig : distlr ] , consider the particle distribution function @xmath445 in this regime for the problem with absorbing boundaries .",
    "similar to the case of reflecting boundaries discussed in sec .",
    "[ refl ] , @xmath445 consists of a quasistationary distribution in the low - viscosity region and a `` gaussian - like '' distribution in the high - viscosity region .",
    "( the exact meaning of `` gaussian - like '' will be revealed later . )",
    "the difference is that because of the absorbing boundary conditions [ @xmath446 at the walls ] , the quasistationary part is no longer a constant , but instead a linear function , @xmath447 where @xmath448 . here and in what follows we assume that the left half of the system is the low - viscosity region ( @xmath449 ) .",
    "equation  ( [ qst_abs ] ) provides a relation between the value of @xmath445 at @xmath450 and its derivative : @xmath451 the slope , @xmath452\\right|_{x =- d/2}\\approx\\left.[\\partial\\rho(x , t)/\\partial x]\\right|_{x=-0}$ ] , is related to the flux to the left wall and thus to the conditional fpt distribution for the left wall , @xmath453    from eq .",
    "( [ bcleft ] ) , using the jump condition ( [ jump ] ) and the flux continuity condition ( [ fluxcont ] ) , we obtain a similar relation on the high - viscosity side of the interface : @xmath454 for the diffusion problem in the high - viscosity region , this serves as a boundary condition ( bc ) .",
    "bcs of this type , where the derivative is proportional to the value of the function , are known as _ robin boundary conditions _ @xcite . at times",
    "@xmath455 the right boundary can be ignored , and we can treat this problem as being defined on a semi - infinite interval , @xmath456 with the boundary condition ( [ robinbc ] ) .    the boundary - value problem given by eqs .",
    "( [ diffr ] ) and ( [ robinbc ] ) can be solved exactly in quadratures @xcite .",
    "we will opt instead for a more intuitive approach , and from now on , we will omit all numerical constants of order unity from our considerations . since the bc ( [ robinbc ] ) is intermediate between the absorbing bc @xmath457 and the reflecting bc @xmath452\\right|_{x=+0}=0 $ ] , we can expect that in some limits the former can be approximated by one of the latter two .",
    "for the reflecting bc , with particles starting near @xmath347 at time @xmath458 , the solution is @xmath459 where @xmath460 is a constant . at a given time",
    ", the maximum value of this function is at @xmath245 and equals @xmath460 ; the @xmath2 derivative at that point is zero . on the other hand ,",
    "the maximum absolute value of the @xmath2 derivative is at @xmath461 and is @xmath462 .",
    "the ratio between the maximum absolute value of the derivative and the maximum value of the function is @xmath463 . if this value is much larger than the ratio of the values of the derivative and the function at @xmath347 given by eq .",
    "( [ robinbc ] ) [ this latter ratio is @xmath464 , then just a small shift in space of the solution of the reflecting problem , eq .",
    "( [ reflsol ] ) , will be sufficient to satisfy the bc ( [ robinbc ] ) , so in this situation , which is observed when @xmath465 , or for @xmath466 the solution of the reflecting problem , eq .",
    "( [ reflsol ] ) , is an adequate approximation of the solution of the original problem with the bc ( [ robinbc ] ) . on the other hand ,",
    "considering the solution of the absorbing problem , @xmath467 where @xmath468 is a constant , the maximum value of the function is @xmath469 , the maximum value of the derivative is @xmath470 , and the ratio of the latter and the former is @xmath463 , as in the reflecting case .",
    "but now , in order for the solution with the bc ( [ robinbc ] ) to be obtainable by a small perturbation of that of the absorbing problem , we need this ratio to be much _ smaller _ than that specified by eq .",
    "( [ robinbc ] ) , which happens for @xmath471 , with @xmath472 still given by eq .",
    "( [ tc ] ) .",
    "thus , the solution of the robin boundary - value problem ( [ diffr])([robinbc ] ) crosses over from being `` reflecting - like '' at @xmath473 to being `` absorbing - like '' at @xmath471 .",
    "note that the `` reflecting - like '' solution corresponds to the particle number on r staying nearly constant , whereas the `` absorbing - like '' solution corresponds to this particle number decreasing rapidly ( as @xmath474 ) as the particles are `` absorbed '' by the interface , `` transferred '' to the left side , and `` flow '' to the wall .",
    "however , it should be remembered that our consideration is only valid in the interval @xmath346 . when @xmath68 , @xmath475 , so the `` reflecting - like '' solution should be observed in the whole range of validity , although some `` traces '' of the `` absorbing - like '' solution can appear as one approaches @xmath310 . on the other hand ,",
    "when @xmath476 , @xmath477 , so the solution is `` absorbing - like '' in the whole interval .",
    "of course , since for @xmath478 the particles do not yet feel the walls , the distribution should be the same as in the reflecting case , that is , `` reflecting - like '' ; the transition should occur around @xmath309 .",
    "it is only for @xmath479 that the crossover should actually be observed in the interval @xmath346 .",
    "if we choose @xmath480 , then for @xmath68 the particle distribution in the high - viscosity region should resemble eq .",
    "( [ reflsol ] ) ; for @xmath481 and @xmath88 it should be similar to eq .",
    "( [ abssol ] ) ; finally , for @xmath482 this time equals @xmath472 and the distribution should be a `` hybrid '' of these two cases .",
    "figure  [ fig : abs_dist ] showing the distributions for @xmath276 , @xmath483 , @xmath484 indeed matches these expectations . even though @xmath484 is about 2.5 times larger than @xmath485 ( this larger time",
    "is chosen to have broader distributions , so their features are more visible ) , the crossover is broad enough that this time can still be considered to correspond to the crossover for @xmath482 .",
    "note that the distributions in the low - viscosity region are linear , as given by eq .",
    "( [ qst_abs ] ) ; note also that a different scale had to be used for the low - viscosity region , since the values of the particle density in that region are much lower than in the high - viscosity region . thus , for any @xmath39",
    ", the fraction of particles in the low - viscosity region is very small in this time range ; contrast this with the reflecting case , where , for example , in the isothermal case there are more particles in the low - viscosity region than in the high - viscosity region at all times ( except when @xmath355 , these numbers become equal ) . to obtain the plot in fig .",
    "[ fig : abs_dist ] , the variant of the mc i algorithm with the waiting time drawn from the distribution ( [ ndistr ] ) is used providing significant computational time savings for this large viscosity ratio .    ,",
    "@xmath483 , and @xmath484 with absorbing boundary conditions obtained using the variant of the mc i algorithm with the waiting time drawn from distribution ( [ ndistr ] ) using @xmath363 realizations .",
    "all particles start at the interface in the middle of the system .",
    "different scales are used for the left and right parts of the plot : the left axis corresponds to the left part ( with @xmath276 ) and the right axis corresponds to the right part ( with @xmath483 ) .",
    "the distributions are normalized so that the area under the curves is unity , regardless of the fraction of particles left.,scaledwidth=40.0% ]    we are now in a position to obtain the fpt distribution for the left wall , @xmath486 . in the `` reflecting - like '' situation , considering the solution with the reflecting bc , eq .",
    "( [ reflsol ] ) , by itself , the @xmath2 derivative at @xmath347 is , of course , zero . the next iteration is obtained by inserting the value of the function at this point , @xmath487 , into the bc ( [ robinbc ] ) , which gives @xmath488 . using eqs .",
    "( [ fluxcont ] ) and ( [ pl ] ) , @xmath489 here we have used the fact that @xmath365 is always @xmath490 . in the `` absorbing - like '' case ,",
    "the @xmath2 derivative at @xmath347 is @xmath470 , and in the same way we obtain @xmath491 thus , the @xmath492 dependence should always be a power law ; the exponent can be @xmath493 in the `` reflecting - like '' situation or @xmath494 in the `` absorbing - like '' situation . in fig .",
    "[ fig : dist_taul ] , we plot @xmath486 for @xmath276 and @xmath483 .",
    "we see that indeed , for @xmath495 ( which corresponds to the `` absorbing - like '' situation at all times ) , the dependence is @xmath496 . for @xmath68 ( the `` reflecting - like '' case ) ,",
    "the @xmath474 fit is adequate , although the slope does get steeper close to @xmath310 , as the crossover is starting to be `` felt . '' for a smaller viscosity ratio , as in fig .",
    "[ fig : distlr ] , the crossover is felt over the whole intermediate range of times , which is probably what causes the apparent @xmath497 dependence in that case .",
    "finally , for @xmath498 the curve can not be fitted by a simple power - law function ; apparently , the crossover is so broad that the already large viscosity ratio needs to be increased by at least another order of magnitude before the distinct @xmath474 and @xmath499 regions can be observed .    ,",
    "@xmath483 , and @xmath256 ( dashed lines ) .",
    "all particles start at the interface in the middle of the system .",
    "the solid lines are the data for @xmath500 , rescaled appropriately ( i.e. , the time is divided by 4 and the value is multiplied by 4 ) .",
    "the data are obtained using the variant of the mc i algorithm with the waiting time drawn from the distribution ( [ ndistr ] ) using @xmath363 realizations.,scaledwidth=40.0% ]    to obtain the prefactors ( or the coefficients @xmath460 and @xmath468 ) in @xmath486 , we assume that the _ number _ of particles on r , @xmath335 , at the beginning of the intermediate time interval ( @xmath501 ) is still the same as at @xmath359 , which , in its turn , is the same as in the reflecting case , since at @xmath359 the particles have not reached the boundaries yet .",
    "note that this does not mean that the _ ratio _ @xmath320 at @xmath501 is the same as at @xmath359 , because particles on l do start to be absorbed around @xmath309 , so @xmath337 does change by @xmath371 .",
    "this means that while eq .",
    "( [ shorttime ] ) can be used to get @xmath335 at @xmath501 , @xmath337 needs to be replaced with @xmath502 , where @xmath503 is the total _ initial _ number of particles on both sides .",
    "two cases need to be considered . for @xmath504 , eq .  ( [ shorttime ] ) ( modified as above ) gives @xmath505 , so @xmath506 on the other hand , for @xmath507 , @xmath508 the first case is `` reflecting - like '' at @xmath309 and until @xmath472 ; normalizing the particle distribution function so the area under the whole curve ( l and r ) is unity initially [ and therefore , given eq .",
    "( [ nrlesshalf ] ) , the area under r is still approximately unity at @xmath371 ] , we obtain @xmath510 , thus @xmath511 , and using eq .",
    "( [ plrefl ] ) , @xmath512 after the crossover , @xmath513 ; by matching to eq .",
    "( [ pl11 ] ) at the crossover point @xmath472 , @xmath514 the case @xmath507 is `` absorbing - like '' for all intermediate @xmath35 ; the area under the curve given by eq .",
    "( [ abssol ] ) at @xmath515 is @xmath516 , so , according to eq .",
    "( [ nrgtrhalf ] ) , the normalization condition is @xmath517 , thus @xmath518 , and , using eq .",
    "( [ plabs ] ) , @xmath519 which is the same expression as eq .",
    "( [ pl12 ] ) .",
    "note that eqs .",
    "( [ pl11 ] ) and ( [ pl2 ] ) are not necessarily valid , even approximately , at @xmath520 , mostly because around @xmath309 , and until time @xmath521 , where @xmath522 is a sufficiently large factor , the particle distribution on l may still be very different from that given by eq .",
    "( [ qst_abs ] ) .",
    "[ strictly speaking , this means that using @xmath501 in considerations leading up to eqs .",
    "( [ pl11])([pl2 ] ) is not entirely correct , but since for all practical purposes @xmath522 can be chosen as a large , but finite and constant numerical factor , this does not affect the scalings , apart from at most logarithmic corrections . ] for @xmath476 , the number of particles on @xmath162 relative to the total initial number of particles in the system @xmath503 is always @xmath523 .",
    "on the other hand , using eq .",
    "( [ pl ] ) , the number of particles on @xmath161 ( again , relative to @xmath503 ) at @xmath524 ( at which the above considerations are already valid but still as close to @xmath309 as possible ) is @xmath525 thus by time @xmath526 most particles have already disappeared from the system . this absorption of particles must have happened around time @xmath371 over the time interval @xmath371 .",
    "thus , @xmath527 .",
    "however , eq .  ( [ pl2 ] ) predicts @xmath528 .",
    "so , on top of the power law predicted by eq .",
    "( [ pl2 ] ) there should be an additional peak ( or `` bulge '' ) at @xmath371 of height @xmath529 : @xmath530 this `` bulge '' , in fact , contains nearly all particles , although the rest of the distribution is still important when calculating the mfpt , as we will see . on the other hand , for @xmath504 only a small fraction of all particles , @xmath531 , are on l initially .",
    "even if all of them are absorbed over time @xmath371 , the resulting fpt density is @xmath532 , which is the same as what eq .",
    "( [ pl11 ] ) at @xmath515 gives , so there is no additional  bulge \" .",
    "in fact , in fig .  [",
    "fig : dist_taul ] there appear to be `` bulges '' for all @xmath39 .",
    "however , it should be kept in mind that our discretization is not entirely adequate for this problem with a very high viscosity ratio : at @xmath533 , the width of the distribution on r is less than one , that is , less than one mesh step . in the same figure",
    ", we also show the results obtained for @xmath500 , with the resulting distributions appropriately rescaled .",
    "the `` bulges '' on the corresponding curves with @xmath504 are smaller , so it is reasonable to assume that they largely disappear in the continuum limit . on the other hand ,",
    "the  bulges \" on curves with @xmath476 are of the same size for @xmath256 and @xmath500 and therefore are `` real '' , rather than discretization artifacts .    using our results for fpt",
    ", we can now analyze the expression for the mfpt we have obtained [ eq .",
    "( [ taulgenlim ] ) ] , by decomposing the mfpt into parts associated with different regions of the fpt distribution .",
    "for @xmath476 , the weight of the bulge is nearly one , while the weight of the power - law region is @xmath534 on the other hand , the average time over the  bulge \" is @xmath371 , but the average time over the power - law region is @xmath535 which is much larger . the total mfpt is @xmath536 where the first term comes from the `` bulge '' and the second one comes from the power - law region at intermediate times . note that the second term is always larger than the first one ( except for @xmath88 , when they are equal ) , and therefore it is the second term that determines the character of the mfpt dependence , which indeed coincides with eq .",
    "( [ taulgenlim ] ) . for @xmath504",
    ", there are two power - law regions .",
    "the weight of the first , `` reflecting - like '' region is @xmath537 the weight of the second , `` absorbing - like '' region is @xmath538 so both regions carry equal weight . in fact , the largest contribution comes from the region around @xmath472  the same result is obtained if the lower limit of the first integral and the upper limit of the second integral are replaced by arbitrary values , as long as the first one is much smaller than @xmath472 and the second one is much larger than @xmath472 . to put it differently , of all intervals @xmath539 $ ] with equal @xmath540 ,",
    "the one containing @xmath472 will contribute the most .",
    "however , other regions can not be ignored when calculating the mfpt .",
    "the average time over the `` reflecting - like '' region is @xmath541 while that over the `` absorbing - like '' region is @xmath542 the resulting mfpt is @xmath543 the contribution of the second term dominates ( except for @xmath68 , when these contributions are equal , even though the second region  shrinks into a point \" ) .",
    "again , this second term coincides with eq .",
    "( [ taulgenlim ] ) .",
    "note that for both @xmath504 and @xmath476 , contributions of the parts of the distribution with @xmath544 are significant .",
    "particles spending such a long time before being absorbed necessarily spend most of that time in the high - viscosity region .",
    "note in this regard that the term in eq .",
    "( [ taulgen ] ) associated with the time spent on r dominates for @xmath545 when @xmath370 , and even at @xmath88 the terms corresponding to the time spent on l and on r contribute equally ( by order of magnitude ) .",
    "it is interesting to compare the particle distributions in fig .",
    "[ fig : abs_dist ] with those obtained for the same @xmath0 , @xmath1 , @xmath247 , and @xmath35 for reflecting boundaries .",
    "the crucial difference is that , while in the absorbing case the flow of particles is from the high - viscosity to the low - viscosity region , the opposite is true in the reflecting case , which follows from the fact that for @xmath437 and for all @xmath39 , the ratio @xmath320 grows with time [ see fig .  [",
    "fig : dist_all](c ) ] , yet @xmath546 stays constant .",
    "as mentioned , this growth is proportional to @xmath547 ; given that it occurs between @xmath309 and @xmath310 and using the short - time [ eq .",
    "( [ shorttime ] ) ] and long - time [ eq .  ( [ longtime ] ) ] values of this ratio , we get @xmath548 for @xmath504 this ratio is much larger than unity at all times , and the fraction of particles on r is @xmath549 the derivative of this is equal to the flux of particles into the right region , which in its turn is proportional to the space derivative of the particle distribution function at @xmath305 .",
    "thus , @xmath550 or @xmath551 assuming that the distribution on r can be approximated by one half of a gaussian curve with area @xmath490 [ eq .",
    "( [ reflsol ] ) with @xmath511 ] , the maximum absolute value of the @xmath2 derivative is @xmath553 .",
    "this is much larger than the absolute value of the derivative given by eq .",
    "( [ reflder ] ) for any @xmath554 .",
    "thus , arguing as in the absorbing case , the gaussian with the peak at zero [ eq .",
    "( [ reflsol ] ) ] is indeed a good approximation in this case .",
    "consider now @xmath476 . in this case ,",
    "two situations are possible : for @xmath555 @xmath320 is still large , and the considerations above for @xmath504 mostly apply . in particular , eq .",
    "( [ reflder ] ) and the expression for the maximum absolute value of the @xmath2 derivative of the trial gaussian are still valid , and the absolute value of the former is much smaller than the latter for any @xmath556 , so the gaussian with a peak at zero still approximates the distribution well . on the other hand , for @xmath557 , @xmath558 .",
    "this means that @xmath337 stays nearly constant and thus @xmath445 on l , besides being nearly constant in space , is also nearly constant in time and @xmath559 then , according to the jump condition ( [ jump ] ) , @xmath560 and is likewise time - independent .",
    "the solution of the diffusion equation satisfying the condition @xmath561 for @xmath562 is the complementary error function erfc @xcite , and we get @xmath563 note that @xmath564 , as expected , and also that the inflection point is now at @xmath305 ( indeed , @xmath565 at @xmath305 implies @xmath566 ) .    similar to the absorbing case , we can consider the particle distributions at @xmath480 . we expect the gaussian distribution for @xmath39 between 0 and 0.5 , the complementary error function with the inflection point at 0 for @xmath88 and a `` hybrid '' situation for @xmath567 . in fig .",
    "[ fig : refl_dist ] , we show the results obtained using mc i simulations with @xmath199 given by eq .",
    "( [ allsucc ] ) .",
    "these results confirm our expectations .",
    "the @xmath567 curve resembles the @xmath88 curve , but in the former case the inflection point is clearly shifted to the right of the interface .    , @xmath483 , @xmath484 with reflecting boundary conditions obtained using the variant of the mc i algorithm with the waiting time given by eq .",
    "( [ allsucc ] ) using @xmath363 realizations .",
    "all particles start at the interface in the middle of the system.,scaledwidth=40.0% ]    comparing the results in figs .",
    "[ fig : abs_dist ] and [ fig : refl_dist ] , it is interesting to note a kind of `` mirror symmetry '' between them .",
    "for example , in the absorbing case the distributions with @xmath39 between 0.5 and 1 are very similar in the high - viscosity region , and in the reflecting case the distributions with @xmath39 between 0 and 0.5 have this property . in the absorbing case , @xmath482 is `` hybrid , '' while in the reflecting case , @xmath567 is `` hybrid . '' finally , in the absorbing case the distribution for @xmath88 is given by eq .",
    "( [ abssol ] ) , which is the derivative of the gaussian distribution , and in the reflecting case the distribution for @xmath88 is given by the complementary error function [ eq .  ( [ erfc ] ) ] , which is the integral of the gaussian distribution .",
    "using the mc i algorithm with all move attempts successful ( sec .",
    "[ mciallsucc ] ) reduces the problem of particle diffusion in a system with a diffusivity interface to a lattice random walk that is unbiased everywhere , except perhaps at the interface site . depending on what side of the interface the particle is on",
    ", a single step of this random walk takes a different amount of time , but this can be taken care of separately , by working in terms of the numbers of steps on each side and then multiplying by the respective time steps . in this way , our problem is reduced to that of an ordinary lattice random walk with a constant diffusion rate that starts at the site in the middle between two absorbing walls and can be biased at that site , but nowhere else .",
    "we first consider the case with no bias even at the middle site ( corresponding to the ito calculus ) and then generalize .",
    "first , consider the diffusion on a lattice with mesh step @xmath568 of an ensemble of particles released half - way between walls at @xmath569 , with @xmath246 integer and the initial position of each particle given by @xmath570 . by symmetry , the average mean first passage times ( mfpt ) to either wall ( the conditional mfpts ) are equal and thus equal to the mfpt to either wall ( the unconditional mfpt ) .",
    "if the time is measured in terms of the number of steps , then the mfpt is the average number of steps , which is @xcite @xmath571    to proceed , we can decompose the full trajectory of a particle into segments separated by its visits to the middle site .",
    "each such segment is entirely either in the left half or in the right half and for brevity , we refer to these groups of segments as left and right segments .",
    "consider the ensemble of trajectories ending on the right wall .",
    "taking one such trajectory and replacing all of the right segments ( except for the last one , of course ) with its mirror - image left segment and vice - versa produces another valid trajectory belonging to the ensemble .",
    "therefore , up to the last segment , there should be an equal number of left and right segments on average and they should have the same average duration .",
    "thus , we can divide the trajectory into two parts .",
    "the first part contains all but the last segment and on average , the time spent in both halves of the interval is the same , but the second part , consisting of only the last segment , is entirely in the right half .",
    "the average time corresponding to the second part of the trajectory can be obtained by recasting this problem as an equivalent one .",
    "consider the interval consisting of just the right half of the original interval .",
    "if both boundaries of this interval are treated as absorbing , the particle is released right next to the boundary corresponding to the middle site and the conditional mfpt , given that the particle is absorbed by the other boundary , is calculated , then all trajectories which return to the middle site will be discarded . while the probability of being absorbed by a wall vanishes in the limit when the distance from the point where the particle is released to the opposite wall approaches zero ( on a lattice this probability is @xmath572 ) , the mfpt to the far wall is well - defined and is , for the continuum problem @xcite , @xmath573 where @xmath574 is the distance between the walls ( the length of the half - interval under consideration ) . using eq .",
    "( [ d_lmc ] ) with @xmath159 , @xmath568 and @xmath575 , we convert this result into that for the average number of steps in the corresponding lattice problem , @xmath576 this is the average duration of the second part of the trajectory .",
    "the average duration of the first part is @xmath577 given that on average , the first part contains an equal number of steps on l and on r , but the second part is entirely on the same side as the wall of interest , the average number of steps on the same side as the wall is @xmath578 and the average number of steps on the opposite side is @xmath579    consider now the case when there is bias at the interface , so a particle at the middle site chooses to move left and thus start a left segment with probability @xmath207 or to move right and thus start a right segment with probability @xmath580 .",
    "these probabilities for mc i are given by eqs .",
    "( [ pminussucc ] ) and ( [ pplussucc ] ) .",
    "each of these segments is unbiased and thus , statistically speaking , unmodified compared to the case of no bias . in particular , the distribution of the number of steps in each segment is the same and the probability to reach the wall is the same as well .",
    "this means that eqs .",
    "( [ n ] ) , ( [ n2 ] ) , and ( [ n1 ] ) are still valid .",
    "the only thing that changes is the fractions of left and right segments in the first part of the trajectory , which are now @xmath207 and @xmath208 , respectively .",
    "then , for trajectories ending on the right wall , the average number of steps on r is @xmath581 and on l , @xmath582 similarly , for trajectories ending on the left wall , the average number of steps on l is @xmath583 while on r , @xmath584              w.t .",
    "coffey , yu.p .",
    "kalmykov , and j.t .",
    "waldron , _ the langevin equation : with applications to stochastic problems in physics , chemistry , and electrical engineering _",
    "( world scientific , river edge , nj , 2004 ) ."
  ],
  "abstract_text": [
    "<S> the possibility of different interpretations of the stochastic term ( or calculi ) in the overdamped langevin equation for the motion of a particle in an inhomogeneous medium is often referred to as the `` ito  stratonovich dilemma , '' although there is , in fact , a continuum of choices . </S>",
    "<S> we introduce two monte carlo ( mc ) simulation approaches for studying such systems , with both approaches giving the choice between different interpretations ( in particular , ito , stratonovich , and `` isothermal '' ) . </S>",
    "<S> to demonstrate these approaches , we study the diffusion on a 1d interval of a particle released at an interface ( in the middle of the system ) between two media where this particle has different diffusivities ( for example , two fluids with different viscosities ) . </S>",
    "<S> we consider the properties of the particle distribution for reflecting boundary conditions at the ends of the 1d interval . </S>",
    "<S> a discontinuity at the interface in the stationary - state particle distribution is found , except for the isothermal case , as expected . </S>",
    "<S> we also study the first - passage problem using absorbing boundary conditions . </S>",
    "<S> good agreement is found when comparing the mc approaches against theoretical predictions as well as brownian and langevin dynamics simulations . additionally , while this problem was chosen primarily to verify the algorithms , the results themselves turn out to be interesting </S>",
    "<S>  particularly when comparing across interpretations . </S>",
    "<S> for instance , we report that : 1 ) for some calculi , there can be more particles on the low - viscosity side at earlier times and then more particles on the high - viscosity side at later times ; 2 ) there is no preference to end up on a particular wall for the ito variant , but a bias towards the wall on the low - viscosity side in all other cases ; 3 ) the mean first - passage time to the wall on the low - viscosity side grows as the viscosity on the high - viscosity side is increased , except for the isothermal case where it approaches a constant ; 4 ) when the viscosity ratio is high , the first - passage - time distribution for the wall on the lower - viscosity side is much broader than for the other wall , with a power - law dependence of the former in a certain time interval whose exponent depends on the calculus ; 5 ) the average portion of time the particle spends on a particular side can be very different from the probability to reach the wall on that side and depends significantly on how the averaging is done . </S>"
  ]
}