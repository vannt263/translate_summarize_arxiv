{
  "article_text": [
    "collisionless shocks are widely thought to be effective accelerators of energetic , nonthermal particles ( hereafter cosmic - rays or crs ) .",
    "those particles play central roles in many astrophysical problems .",
    "the physical basis of the responsible diffusive shock acceleration ( dsa ) process is now well established through in - situ measurements of heliospheric shocks @xcite and through analytic and numerical calculations @xcite . while test particle dsa model treatments are relatively well developed ; e.g. , @xcite , it has long been recognized that dsa is an integral part of collisionless shock physics and that there are substantial and highly nonlinear backreactions from the crs to the bulk flows and to the mhd wave turbulence mediating the cr diffusive transport ( see , for example , @xcite and references therein ) .",
    "most critically , the crs can capture a large fraction of the kinetic energy dissipated across such transitions .",
    "as they diffuse upstream the crs form a pressure gradient that decelerates and compresses the entering flow inside a broad shock precursor .",
    "that , in turn , can lead to greatly altered full shock jump conditions , especially if the most energetic crs , which can have very large scattering lengths , escape the system and carry significant energy with them .",
    "also in response to the momentum dependent scattering lengths and flow speed variations through the shock precursor the cr momentum distribution will take on different forms than in a simple discontinuity .",
    "effective analytic ( e.g. , @xcite ) and numerical ( e.g. , @xcite ) methods have been developed that allow one to compute steady - state modified shock properties given an assumed diffusion behavior . on the other hand , as the cr particle population evolves in time during the formation of such a shock the shock dynamics and the cr - scattering wave turbulence evolve as well . for dynamically evolving phenomena , such as supernova remnants , the time scale for shock modification can be comparable to the dynamical time scales of the problem .",
    "the above factors make it essential to be able to include both nonlinear and time dependent effects in studies of dsa .",
    "generally , numerical simulations are called for .",
    "full plasma simulations offer the most complete time dependent treatments of the associated shock microphysics @xcite , but are far too expensive to follow the shock evolution over the time , length and energy scales needed to model astrophysical cr acceleration .",
    "the most powerful alternative approach utilizes continuum methods , with a kinetic equation for each cr component combined with suitably modified compressible fluid dynamical equations for the bulk plasma ( see  2 below ) . by extending that equation set to include relevant wave action equations for the wave turbulence that mediates cr transport ,",
    "a self - consistent , closed system of equations is possible ( e.g. , @xcite ) ) .",
    "continuum dsa simulations of the kind just described are still quite challenging and expensive even with only one spatial dimension .",
    "the numerical difficulty derives especially from the very large range of cr momenta that must be followed , which usually extends to hundreds of gev / c or beyond on the upper end and down to values close to those of the bulk thermal population , with nonrelativistic momenta .",
    "the latter are needed in part to account for `` injection '' of crs due to incomplete thermalization that is characteristic of collisionless shocks .",
    "one computational constraint comes from the fact that cr resonant scattering lengths from mhd turbulence , @xmath1 , are generally expected to be increasing functions of particle rigidity , @xmath2 .",
    "the characteristic length coupling the crs of a given momentum , @xmath3 , to the bulk flow and defining the width of the modified shock precursor is the so - called diffusion length , @xmath4 , where @xmath5 is the cr particle speed , and @xmath6 is the bulk flow speed into the shock .",
    "one must spatially resolve the modified shock transition for the entire range of @xmath7 in order to capture the physics of the shock formation and the spatial diffusion of the crs , in particular .",
    "the relevant @xmath7 typically spans several orders of magnitude , beginning close to the dissipation length of the thermal plasma , which defines the thickness of the classical , `` viscous '' gas shock , also called the `` subshock '' in modified structure .",
    "this resolution requirement generally leads to very fine spatial grids in comparison to the `` outer scale '' of the problem , which must exceed the largest @xmath7 .",
    "two approaches have been applied successfully so far to manage this constraint in dsa simulations .",
    "berezhko and collaborators @xcite developed a method that normalizes the spatial variable by @xmath7 at each momentum value of interest during solution of the cr kinetic equation .",
    "this approach establishes an spatial grid that varies economically in tune with @xmath7 .",
    "derived cr distribution properties at different momenta can be combined to estimate feed - back on the bulk flow at appropriate scales .",
    "the method was designed for use with cr diffusion properties known _ a priori_. it is not readily applied to cr diffusion behaviors incorporating arbitrary , nonlinear feedback between the waves and the crs . as an alternative that can accommodate those latter diffusion properties ,",
    "kang @xcite have implemented diffusive cr transport into a multi - level adaptive mesh refinement ( amr ) environment .",
    "the benefit of amr in this context comes from the feature that the highest resolutions are only necessary very close to the subshock , which can still be treated as a discontinuity satisfying standard rankine - hugoniot relations . by efficient use of spatial gridding both of these computational strategies",
    "can greatly reduce the cost of time dependent dsa simulations .",
    "on the other hand , the above methods do not directly address the principal computational cost in such simulations , so they remain much more costly compared to purely hydrodynamic or mhd simulations .",
    "this is because the dependence of @xmath8 on cr momentum , @xmath3 , adds a physical dimension to the problem . in practice ,",
    "the spatial evolution of the kinetic equation for each cr constituent must be updated over the entire spatial grid at multiple momentum values ; say , @xmath9 .",
    "the value of @xmath9 is usually large , since the spanned range of cr momentum is typically several orders of magnitude .",
    "physically , crs propagate in momentum space during dsa in response to adiabatic compression in the bulk flow , sometimes by momentum diffusion ( see , for example , equation [ dce ] below ) , or because of various irreversible energy loss mechanisms , such as coulomb or radiative losses .",
    "the associated evolution rates for @xmath8 depend on the process , but generally depend on @xmath10 . the conventional approach to evolving @xmath8 approximates @xmath10 through low order finite differences in @xmath11 ( e.g. , @xcite ) . experience has shown that converged solutions of @xmath12 using",
    "such methods require @xmath13 @xcite . in that case , for example , a mere five decades of momentum coverage requires more than 100 grid points in @xmath14 . since spatial update of the kinetic equation at each momentum grid point requires computational effort comparable to that for any of the accompanying hydrodynamical equations ( e.g. , the mass continuity equation ) , cr transport then dominates the computational effort by a very large factor , commonly exceeding an order of magnitude .    an attractive alternative approach to evolving the kinetic equation replaces @xmath8 by its integral moments over a discrete set of finite momentum volumes , in which case @xmath10 is replaced by @xmath8 evaluated at the boundaries of those volumes .",
    "the method we outline here follows that strategy . because @xmath15 is relatively smooth , simple subvolume models",
    "can effectively be applied over moderately large momentum volumes .",
    "we have found this method to give accurate solutions to the evolution of @xmath8 with an order of magnitude fewer momentum bins than needed in our previous finite difference calculations .",
    "the computational effort to evolve the cr population is thereby reduced to a level comparable to that for the hydrodynamics . in recognition of its distinctive features we refer to the method as `` coarse - grained momentum finite volume '' or `` cgmv '' .",
    "it extends related ideas introduced in @xcite , @xcite and @xcite for test particle cr transport . those previous presentations ,",
    "while satisfactorily following cr transport in many large - scale , smooth flows , did not include spatial or momentum diffusion , so could not explicitly follow evolution of @xmath8 during dsa . instead ,",
    "analytic , test - particle solutions for @xmath12 were applied at shock jumps . here",
    "we extend the cgmv method so that it can be applied to the treatment of fully nonlinear cr modified shocks .",
    "we outline the basic cgmv method and its implementation in eulerian hydrodynamics codes in  2 .",
    "several tests are discussed in  3 , and our conclusions are presented in  4 .",
    "the standard diffusion - convection form of the kinetic equation describing the evolution of the isotropic cr distribution function , @xmath16 , can be written in one spatial dimension as ( e.g. , @xcite ) .",
    "@xmath17 where @xmath18 is the bulk flow speed , @xmath19 , @xmath20 is the spatial diffusion coefficient , @xmath21 is the momentum diffusion coefficient , and @xmath22 is a representative source term .",
    "we henceforth express particle momentum in units of @xmath23 , where @xmath24 is the particle mass .",
    "the first rhs term in equation ( [ dce ] ) represents `` momentum advection '' in response to adiabatic compression or expansion . for simplicity of presentation equation [ dce ]",
    "neglects for now propagation of the scattering turbulence with respect to the bulk plasma , which can be a significant influence when the sonic and alfvnic mach numbers of the flow are comparable .",
    "although it is numerically straightforward to include this effect , the details are somewhat complex , so we defer that to a follow - up work focussed on cr transport in mhd shocks .    full solution of the problem at hand requires simultaneous evolution of the hydrodynamical flow , as well as the diffusion coefficients , @xmath20 and @xmath21 . again postponing full mhd , the added equations to be solved are the standard gasdynamic equations with cr pressure included .",
    "expressed in conservative , eulerian formulation for one dimensional plane - parallel geometry , they are @xmath25    @xmath26    @xmath27    where @xmath28 and @xmath29 are the isotropic gas and the cr pressure , respectively , @xmath30 is the total energy density of the gas per unit mass and the rest of the variables have their usual meanings .",
    "the injection energy loss term , @xmath31 , accounts for the energy of the suprathermal particles transferred at low energy to the crs . as usual , cr inertia is neglected in such computations , since the mass fraction of the crs is generally tiny .",
    "we note for completeness that @xmath32 can be computed from @xmath8 using the expression @xmath33 in the simulations described below we set the particle mass , @xmath34 , for convenience .      as mentioned in ",
    "[ intro ] , the momentum advection and diffusion terms in equation [ dce ] typically require @xmath35 when using low order finite difference methods in the momentum coordinate @xcite .",
    "the resulting large number of grid points in @xmath36 makes finding the solution of equation [ dce ] the dominate effort in simulations of dsa . on the other hand , previous studies of dsa as well as direct observations of crs in different environments",
    "have shown that @xmath12 is commonly well described by the form @xmath37 , where @xmath38 , is a slowly varying function of @xmath36 .",
    "thus , we may expect a piecewise powerlaw form to provide an efficient and accurate , two - parameter subgrid model for @xmath39 .",
    "two moments of @xmath12 are sufficient to recover the subgrid model parameters .",
    "we find it convenient to use @xmath40 and @xmath41 the first of these moments , @xmath42 , is proportional to the spatial number density of crs in the momentum bin @xmath43 $ ] , while for relativistic crs , @xmath44 is proportional to the energy density or pressure contribution of crs in the bin . then , for example , @xmath45 , \\label{niq}\\ ] ] where @xmath46 , and @xmath47 with obvious extension to @xmath44 .",
    "either of these moments , plus their ratio , @xmath48 , can be used in straightforward fashion ( e.g. , iteration ) to find both @xmath49 and the intrabin index , @xmath50 .    to evolve @xmath42 and @xmath44 we need the associated moments of equation [ dce ] over the finite momentum volume bounded by @xmath51 . the result for @xmath42",
    "is @xmath52 where @xmath53 is a flux in momentum space , with @xmath54 , and where @xmath55 and @xmath56 are averaged over the momentum interval , according to @xmath57 and @xmath58 extension of the momentum flux term @xmath59 to include other processes such as radiative or coulomb losses is obvious ( e.g. , @xcite ) . in practice",
    "these fluxes should be upwinded according to the signs of @xmath60 and @xmath61 .",
    "evaluation of @xmath59 and @xmath62 at the boundaries of the included momentum range requires application of suitable boundary conditions , of course .",
    "we usually have set @xmath63 . in most cases",
    "we pick a sufficiently large maximum momentum , @xmath64 , that this condition is important only late in the simulation , if at all .",
    "appropriate conditions at the lowest momenta can be more involved , depending on how one intends to connect the cr particle distribution to the thermal particle distribution , as in the injection models discussed below .",
    "the @xmath44-associated moment of equation [ dce ] is @xmath65 where @xmath66 , @xmath67 @xmath68 , and @xmath69 is given by an analogous expression to equation [ sni ] .",
    "we note that momentum binning in the cgmv scheme is quite flexible , so that it can be easily adapted to either uniform or nonuniform momentum bin sizes , or to a momentum range that evolves during the simulation .",
    "we have successfully implemented both nonuniform and evolving momentum bin structures , although , for brevity we do not illustrate them here .",
    "the coefficients in equation [ cne ] are obtained with the aid of the solutions to equations [ masscon ] - [ encon ] , which are updated prior to solution of equations [ dce - n ] and [ dce - g ] .",
    "we note again that similar methods can be applied to follow the evolution of the wave turbulence that resonantly scatters crs and that defines the spatial and momentum diffusion coefficients . in that case one",
    "begins with the wave action equation for the appropriate waves rather than the particle kinetic equation ( e.g. , @xcite ) .",
    "the solution of equation ( [ cne ] ) for either @xmath42 or @xmath44 is quite analogous to our previous fd methods .",
    "thus , since the cgmv method evolves two quantities rather than one , the relative effort required for a given @xmath9 is roughly twice in the cgmv scheme that required in the fd scheme .",
    "our tests confirm this expected scaling . on the other hand ,",
    "since @xmath9 can be dramatically reduced in a cgmv simulation the method can still be more efficient by a large factor .",
    "the most common source term represented by @xmath22 in equation ( [ dce ] ) is injection at the shock of low energy crs from the thermal plasma .",
    "there is presently no generally accepted theory for that process .",
    "however , we have implemented two commonly used models successfully into the cgmv scheme . for completeness",
    "we outline those here .    the simplest and one of the most frequently applied injection models assumes that a small , fixed fraction of the thermal particle flux through the gas subshock , @xmath77 , is injected at a momentum @xmath78 , where @xmath79 is a constant greater than unity and @xmath80 is the plasma sound speed immediately downstream of the subshock ( e.g. , @xcite ) .",
    "this gives @xmath81 , where @xmath82 is the plasma mass density just upstream of the subshock , @xmath83 is the plasma mean particle mass , @xmath6 is the subshock speed with respect to the plasma immediately upstream and @xmath84 is a normalized weight function that allows the injection to be distributed across the numerical shock structure . in this case",
    "@xmath85 , while @xmath86 in the momentum bin with @xmath87 . both @xmath88 and @xmath69",
    "are zero , otherwise .",
    "the energy extracted from the thermal plasma is simply @xmath89 . for convenience",
    "we call this injection model the `` flux fraction '' or `` ff '' model",
    ".      a more sophisticated approach to injection physics includes models of the physical processes moderating particle orbits in the post shock flow region in order to estimate the probability that particles of a given speed will be able to escape back upstream , across the subshock . in such `` thermal leakage '' ( tl ) models for cr injection at shocks ,",
    "most of the downstream thermal protons are locally confined by nonlinear mhd waves and only particles well into the tail of the postshock maxwellian distribution can leak upstream across the subshock . in particular , `` leaking '' particles not only must have velocities large enough to swim against the downstream flow in order to return across the shock , they must also avoid being scattered during that passage by the mhd waves that mediate the plasma subshock . to model tl injection",
    "we utilize a `` transparency function '' , @xmath90 , expressing the probability that supra - thermal particles at a given velocity can leak upstream from behind the subshock ( see @xcite for details ) . in particular we set @xmath91          { ( 1-\\frac{1}{\\tilde{\\upsilon } } ) \\over          ( 1-\\frac{u_2}{\\upsilon } ) }   \\exp\\left\\ { -\\left[\\tilde{\\upsilon}-(1+\\epsilon_b)\\right]^{-2}\\right\\ } , \\label{tau}\\ ] ] where @xmath92 is the postshock flow speed in the subshock frame , @xmath93 is the heaviside step function , and the particle velocity is normalized to @xmath94 .",
    "the parameter , @xmath95 , measures the ratio of the amplitude of the postshock mhd wave turbulence @xmath96 to the general magnetic field aligned with the shock normal , @xmath97 .",
    "both hybrid simulations and theory suggest that @xmath98 @xcite , so that the model is well constrained . with this @xmath99",
    "the shock is completely `` opaque '' to particles with momenta less than @xmath100 , _",
    "@xmath101 for @xmath102 , where @xmath103 .",
    "so @xmath104 is the lowest momentum of the first momentum bin in the tl model and changes in time with the postshock flow speed . for @xmath105 , @xmath106 .",
    "the shock becomes virtually transparent to particles with momenta two to three times greater than @xmath100 . for strong , unmodified shocks @xmath100 in the tl model and @xmath107 in the ff model",
    "are similar when @xmath105 and @xmath108 . under those circumstances",
    "the initial injection rates will be roughly similar , although differences in model physics lead to different behaviors as such shocks become modified ( see , e.g. , @xcite , @xcite , @xcite ) .",
    "the tl model is implemented in the cgmv scheme by the following numerical approach .",
    "after solution of equations ( [ dce - n ] ) and ( [ dce - g ] ) the net changes in @xmath42 and @xmath44 are corrected ( reduced ) in the upstream region by application of the transparency function as follows : @xmath109 and @xmath110 where @xmath111 , found using equation ( [ niq ] ) , is the cr distribution updated with equations ( [ dce - n ] ) and ( [ dce - g ] ) .",
    "the energy loss rate of the bulk plasma to injection into the @xmath112-th cr momentum bin can be approximated by @xmath113 ( see @xcite ) .    with the piece - wise power - law subgrid model ( @xmath114 ) the integrals in equations ( [ leakn])-([leakl ] )",
    "can be written : @xmath115 @xmath116 and @xmath117 in practice , this leakage step is significant only for the lowest few momentum bins , so that this correction need not be applied to all bins .",
    "in order to test the performance of the new cgmv scheme we have installed it into two distinct one - dimensional eulerian hydrodynamic ( hd ) codes that we have previously applied to studies of cr - modified shocks using conventional finite difference ( fd ) methods to solve the diffusion convection equation . in this section",
    "we briefly discuss the results and compare the cgmv and fd behaviors .",
    "both of the host hd codes are constructed from high order , conservative riemann solver - based schemes designed to capture shocks sharply .",
    "first we describe results from the cgmv scheme installed in a second order `` total variation diminished '' ( tvd ) hd code based on the finite difference scheme of harten @xcite .",
    "this is the hd version of the mhd - cr code used by us in a previous study of cr modified shocks @xcite .",
    "gas subshocks in the tvd scheme typically spread over 2 - 3 numerical zones .",
    "an outline of the code mechanics and the fd cr scheme can be found there , in @xcite and references cited in those papers .",
    "the fd solver employed a crank - nicholson routine originally introduced in @xcite for evolving @xmath118 that is similar to equation ( [ cne ] ) . for the tvd tests we applied the ff injection model .",
    "in addition we present cgmv tests carried out with our cosmic ray adaptive refinement shock ( crash ) code .",
    "crash is based on the high order godunov - like shock tracking algorithm of leveque @xcite .",
    "the hydrodynamics routine in that code employs a nonlinear riemann solver to follow shock discontinuities within the zones of an initially uniform grid .",
    "thus , gas subshocks in cr - modified shocks remain discontinuous throughout a simulation , allowing cr transport to be modeled down almost to the scale of the physical shock thickness .",
    "crash also employs adaptive mesh refinement ( amr ) around shocks in order to reduce the computational effort on the spatial grid .",
    "refinement is centered on the subshock and each level spans 100 zones with a resolution twice as fine as the level above it .",
    "the number of refinement levels depends on what is required to capture diffusion of the lowest energy crs .",
    "the standard , previously documented version of crash uses the same fd methods as the tvd code to solve the diffusion convection equation for cr transport .",
    "it is described in @xcite and @xcite . for the crash tests discussed in this paper we employed the tl injection model .",
    "we first examine some results obtained using the tvd - cr code with both fd and cgmv schemes used to model the evolution of a strong cr - modified shock .",
    "fig . 1 and fig",
    ". 2 illustrate the evolution of shocks formed by the reflection of a mach 30 flow ( adiabatic index , @xmath119 ) off the left grid boundary .",
    "the resulting piston - driven shock initially has a mach number , @xmath120 .",
    "the density and sound speed of plasma entering from the right boundary were set to @xmath121 and @xmath122 , respectively , so that the inflow speed was unity .",
    "the time unit for the calculations is also set by these scalings . in order to relate hydrodynamical variables",
    "to cr momenta it is necessary to fix the unit flow speed ( the inflow speed in all the simulations discussed in this paper ) with respect to the speed of light ; i.e. , @xmath123 .",
    "we set @xmath124 in the tvd - cr simulations .",
    "time steps were fixed by a standard courant condition , @xmath125 .    for the simulation illustrated in fig .",
    "1 evolution of the cr distribution is followed over the momentum range @xmath126 = [ 2\\times 10^{-4 } , 1.6\\times 10 ^ 3]$ ] ( @xmath127 ) .",
    "the simulation represented in fig .",
    "2 included the momentum range @xmath126 = [ 2\\times 10^{-4 } , 2.4\\times 10 ^ 5]$ ] ( @xmath128 ) .",
    "the cr diffusion coefficient , @xmath20 is spatially uniform and set to @xmath129 . in a quest for a reasonably generalized behavior that required minimal computational effort ,",
    "this choice was motivated by results from malkov , who found self - similar analytic steady - state solutions for strong cr - modified shocks that apply to all powerlaw forms of @xmath130 , so long as the powerlaw index is steeper that @xmath131 @xcite .",
    "thus , our @xmath20 choice leads to fairly general shock behaviors in a way that minimizes the width of the precursor .",
    "that width , which determines the minimum space that must be simulated ahead of the subshock , is set by @xmath132 , where @xmath133 represents the maximum momentum contained .",
    "the tvd - cr simulations utilize a uniform , fixed grid , so , for example , the bohm diffusion form modeled in the crash simulations below would lead to excessive costs for the tvd - cr fd test simulations presented in this section . the spatial resolution required for the calculations is set by @xmath134 , since accurate solutions of the diffusion - convection equation require good structural information in the diffusive shock precursor upstream of the subshock .",
    "previous convergence tests have shown that @xmath135 is desirable ( e.g. , @xcite ) .",
    "for the problems illustrated in fig . 1 and fig .",
    "2 these considerations led us to set @xmath136 for both the fd and cgmv simulations . by varying this resolution",
    ", we verified that the shock evolution is reasonably converged with respect to @xmath137 .",
    "the simulation followed in fig .",
    "1 assumes a pre - existing cr population , @xmath138 , corresponding to an upstream cr pressure , @xmath139 .",
    "no fresh injection is included at the shock ; i.e. , @xmath140 .",
    "this test then provides a simple and direct comparison between the cgmv and fd schemes for solving the diffusion - convection equation , since it omits any complications related to the injection model .",
    "this simulation pair evolves the shocks until @xmath141 , which is sufficient to accelerate crs to ultrarelativistic momenta .",
    "the spatial grid spans the interval [ 0,16 ] , which is sufficient to contain the leading edge of the cr precursor to the end of the simulation .    the cr - modified shock spatial structures and the cr momentum distributions at the subshock are shown in fig . 1 at times @xmath142 .",
    "before comparing the solutions obtained with the two different methods , it is useful to summarize briefly the physics captured during the shock evolution .",
    "all the behaviors described here have been reported previously by multiple authors .",
    "the figure shows the well - known property of strongly modified shocks that the crs extract most of the energy flux into the structure .",
    "that leads to a substantial drop in the postshock gas pressure , @xmath143 , and a large increase in the postshock density , @xmath144 .",
    "together those indicate a strongly reduced postshock gas temperature .",
    "the decreased temperature is evident in the @xmath145 plot at the subshock , which is dominated at low momenta by the maxwellian distribution of the bulk plasma . as crs diffuse upstream against the inflowing gas",
    "they compress the flow within the precursor , preheating the gas ( adiabatically in these simulations ) .",
    "initially , while the cr pressure is relatively small compared to the incoming momentum flux , the gas subshock remains strong enough to produce a full four times density compression on top of the precompression .",
    "however , the subshock weakens once @xmath146 , reducing the subshock compression in this case to a factor @xmath147 , corresponding to a subshock mach number near 2.3 .",
    "that evolution explains the well - known , transitory `` density spike '' in the shock structures seen after @xmath148 .",
    "we note that since energy extracted from the flow by crs becomes increasingly spread upstream and downstream due to cr diffusion , the total compression in such an _ evolving _ modified shock would always exceed the factor of seven one would predict for a strong , fully relativistic gas shock . for this simulation",
    "no significant cr energy escapes the spatial grid through upstream diffusion .",
    "however , at late times ( @xmath149 ) the partial pressure due to crs just below @xmath150 is sufficient that escape across the upper momentum boundary is significant .",
    "this contributes to the slow decrease in @xmath32 behind the shock and the increasing total compression through the shock transition that is visible in fig . 1 .    in the early evolutionary stages of this flow ,",
    "while shock modification is modest , the cr momentum distribution resembles the powerlaw form , @xmath151 , predicted by test particle theory for a strong shock ( e.g. , @xcite ) . with the spatial diffusion coefficient used in this simulation the high momentum cutoff to",
    "the distribution increases with time approximately as @xmath152 ( see , e.g. , @xcite ) . as shock modification intensifies , most of the flow compression shifts from the subshock to the precursor .",
    "then dsa of high momentum crs occurs predominantly within the precursor rather than near the less important subshock .",
    "consequently the cr distribution develops the familiar upwards - concave form resulting from the momentum dependent cr diffusion length .",
    "crs of higher momentum experience a greater velocity jump within the precursor , so gain more energy each time they are reflected within the shock structure . that flattens the distribution , @xmath12 at momenta below @xmath133 .",
    "the result is a bump in the distribution of @xmath118 . on the other hand , crs with momenta only a little above the injection range",
    "remain trapped close to the subshock .",
    "their distribution closely approaches the steady state , powerlaw , test particle form appropriate to the weakened subshock .",
    "that feature extends upwards in momentum as the bump near @xmath133 moves upwards .",
    "looking finally to compare the two methods used to evolve the shock evolution displayed in fig .",
    "1 we see results from the fd scheme with @xmath153 and the cgmv scheme with @xmath154 .",
    "the agreement is generally very good .",
    "all the dynamical quantities , including shock jumps and the cr momentum distributions show excellent agreement .",
    "the curves representing the fd and cgmv distributions of @xmath144 , @xmath143 and @xmath32 and virtually indistinguishable in the plots .",
    "most notably , all features formed in the fd evolution of the cr momentum distribution are faithfully reproduced by the much coarser cgmv distribution .    given the excellent comparison in this strongly modified flow it is satisfying to note that the execution time required for the cgmv solution was a little less than 20% of that for the fd solution , demonstrating the significantly higher efficiency of the former method .",
    "the speed - up observed in our implementations of the two methods is roughly in accordance with what we would predict for a given reduction factor in the number of momentum values used , since the cgmv method requires one to evolve two distributions @xmath42 and @xmath44 for each momentum bin .",
    "we address convergence with respect to momentum resolution in our discussion of a second shock .",
    "fig.2 shows a mach 30 flow similar to that in fig .",
    "1 . in this case",
    "ff injection is included with commonly assumed values , @xmath155 and @xmath156 ( see  2.3 ) , the upper momentum bound is increased to @xmath157 and the spatial grid extends farther from the piston to @xmath158 .",
    "a negligible pre - existing cr population is included to avoid numerical issues coming from the fact that our cgmv scheme requires computation of the ratio @xmath159 over the entire grid .",
    "the simulations evolved the shock until @xmath160 , which leads to @xmath161 .",
    "the spatial grid , spanning the interval [ 0,25 ] , is sufficient to contain the cr leading edge of the precursor almost to the end of the simulations .",
    "however , after @xmath162 some cr energy escapes through the right boundary , due to diffusion upstream , mimicking the behavior of a `` free escape '' boundary ( feb ) ( e.g. , @xcite and references therein ) . just as for the shock simulated in fig.1 , this energy loss amounts to a cooling process , so that the total shock compression increases with time as the simulation ends .",
    "again the agreement between fd and cgmv simulations is very good .",
    "very early in the evolution of the shock , when the crs are dominated by freshly injected nonrelativistic particles , the shock evolution is slightly faster in the cgmv scheme .",
    "that influence becomes insignificant later on , so that the modified shock structures found by the two schemes are almost identical as is the distribution @xmath118 at the shock .",
    "there is a small residual effect that the position of the subshock in the cgmv simulation lags slightly behind that of the fd simulation , and that @xmath32 is slightly higher in the cgmv simulation near the piston , where the shock first formed .",
    "since the efficiency of the cgmv method comes from its ability to cover the momentum range coarsely , it is important to evaluate how broad the momentum bins can be and still faithfully model the evolution of the shock .",
    "3 illustrates convergence of the cgmv scheme with respect to momentum bin size , @xmath163 , at @xmath164 for the flow modeled in fig .",
    "2 . the upper panel plots the spatial @xmath32 distributions , while the lower panel shows the particle momentum distributions at the gas subshock . for reference",
    "the corresponding fd solution ( @xmath153 ) is shown by the dotted red curves .",
    "solutions from the cgmv scheme are plotted for @xmath165 , @xmath166 and @xmath167 .",
    "even the coarsest of the cgmv solutions is in basic agreement with the other cgmv solutions and with the fd solution .",
    "fine details in the momentum distribution are naturally obscured as the cgmv bin size increases .",
    "the largest bins with @xmath168 span a decade in cr momentum ( @xmath169 ) , but still capture the basic dynamical properties of the crs correctly",
    ".    however , the quality of the cgmv solutions deteriorates for still larger momentum bins in these experiments , once the simple subgrid model for the momentum distribution becomes inadequate . as illustrated in the lower panel of fig .",
    "3 already momentum bins larger than roughly @xmath170 can not closely follow sharper structures in the momentum distibution that develops at the ends of the cr distribution .",
    "that enhances @xmath32 upstream of the subshock , where the flow is both cold and strongly compressed as it approaches the subshock .",
    "when the errors become excessive , for @xmath171 , in this case , @xmath32-induced overcompression in this region can cause the riemann solver in our tvd code to perform poorly or even to fail in high mach number flows .",
    "in general the largest allowed momentum bin size , @xmath172 should depend on the strongest curvature of the cr momentum distribution function as well as the degree of shock modification .      for a third test example",
    "we illustrate in figs .",
    "4 and 5 simulation results using the crash code with the tl injection model applied to a mach 10 flow reflecting off the left computational boundary .",
    "the initial gas shock mach number is approximately 13 . as for the previous test ,",
    "the upstream gas density and flow speed are set to unity , with upstream sound speed , @xmath173 , and @xmath174 .",
    "the time unit is defined accordingly .",
    "cr momenta are tracked over the range @xmath175 $ ] , where @xmath104 is the smallest momentum that can leak upstream ( see equation 15 ) .    in this case a bohm - type diffusion model with @xmath176 , is adopted and the tl injection parameter , @xmath177 is used .",
    "the crash test was significantly more computationally demanding than the tvd - cr tests .",
    "note first that in the crash simulation the value of @xmath178 , while @xmath179 in the previous examples shown in figs . 1 - 3 .",
    "consequently , @xmath180 is about seven times greater in the current case , and the nominal physical scale of the precursor and its formation timescale are similarly lengthened .",
    "in addition , the stronger momentum dependence of bohm diffusion coefficient means that the precursor width expands more strongly as @xmath133 increases",
    ". the associated time rate of increase in @xmath133 is , however , slower , so that the shock must evolve longer to reach a given @xmath133 .",
    "these factors substantially increase the size of the physical domain needed to reach a given @xmath133 .",
    "4 shows the early evolution of this cr - modified shock for @xmath181 as computed with both the fd and the cgmv methods .",
    "the spatial domain for this simulation is [ 0,20 ] .",
    "the base spatial grid included @xmath182 zones , giving @xmath183 .",
    "since it is necessary to resolve structures near the subshock on scales of the diffusion length for freshly injected , suprathermal crs , the amr feature of the crash code is utilized .",
    "the fd simulation is carried out with 7 refined grid levels ; four levels of refined grid are applied in the cgmv simulation .",
    "240 momentum points ( @xmath184)are used in the fd simulation , while the cgmv simulation includes 20 momentum bins ( @xmath185 ) . the time step for each refinement level , @xmath186 ,",
    "is determined by a standard courant condition , that is , @xmath187 .",
    "although the crank - nicholson scheme is stable with an arbitrary time step , the diffusion convection equation is solved with the time step smaller than @xmath188 ) to maintain good accuracy in the momentum space advection ( _ i.e. , _",
    "@xmath189 ) . with @xmath184 , the required time step is smaller by a factor of three or so than the hydrodynamic time step in the fd simulation . consequently ,",
    "the fd diffusion convection solver is typically subcycled about 3 times with @xmath190 for each hydrodynamic time step . because of the much larger @xmath163 , subcycling is not necessary in the cgmv simulation .",
    "that adds another relative economy to the cgmv calculation .    at the end of",
    "this simulation , @xmath191 , the modified shock structure is approaching a dynamical equilibrium in the sense that the postshock values of @xmath144 , @xmath143 and @xmath32 will not change much at later times .",
    "since this shock is weaker than the mach 40 shocks examined earlier modifications are more moderate . on the other hand ,",
    "as expected from the stronger momentum dependence of @xmath7 , the shock precursor broadens much more quickly in the present case .",
    "the cutoff in the cr distribution has reached roughly @xmath192 by @xmath191 .",
    "longer term evolution of this shock will be addressed below .",
    "the agreement between the fd and cgmv solutions shown in fig .",
    "4 is good , although not as close as it was in the examples illustrated in fig . 1 and fig .",
    "2 . the more apparent distinctions between the two solutions in the present case come from effective differences in the application of the tl injection model with bohm diffusion in fd and cgmv methods . recall that the cgmv scheme applies the diffusion coefficients averaged across the momentum bins ( see equations [ kni ] , [ kgi ] ) .",
    "the bohm diffusion model has a very steep momentum dependence for nonrelativistic particles ; namely , @xmath193 . at low momenta where injection takes place",
    "the averaging increases the effective diffusion coefficient , and , thus , the leakage flux of suprathermal particles , leading to higher injection rate compared to the fd scheme for the same tl model parameters .",
    "consequently , the distribution function in the second bin at @xmath194 is slightly higher in the cgmv scheme , as evident in figs .",
    "note that @xmath195 is anchored on the tail of maxwellian distribution .",
    "the cgmv solutions accordingly show slightly more efficient cr acceleration than the fd solutions at early times . in this test @xmath32",
    "is about 5 % greater in the cgmv simulation at @xmath191 .",
    "since the cgmv scheme can be implemented with nonuniform momentum bins , such differences could be reduced by making the momentum bins smaller at low momentum in instances where the details relating to the injection rate were important .",
    "we show in fig .",
    "5 the evolution of this same shock extended to @xmath196 , as computed with the cgmv method .",
    "this simulation is computed on the domain [ 0,800 ] , spanned by a base spatial grid of @xmath197 zones , giving @xmath198 .",
    "we also included 7 refined grid levels at the subshock , giving @xmath199 .",
    "this grid spacing is insufficient for convergence at the injection momentum , @xmath200 , so that the very early evolution is somewhat slower than in the simulations shown in fig .",
    "however , once shock modification becomes strong evolution becomes roughly self - similar , as pointed out previously @xcite .",
    "the time asymptotic states do not depend sensitively on the early injection history .",
    "the self - similar behavior results with bohm diffusion from a match between the upstream and downstream extensions of the cr population .",
    "one also sees from the form of the distribution function in fig .",
    "5 that the postshock gas temperature has stabilized , while the previously - explained concave form to the cr distribution is better developed than it was at earlier times .",
    "this simulation illustrates nicely the relative efficiency of the cgmv scheme .",
    "the equivalent fd simulation would be very much more expensive , because this model requires a long execution time and a large spatial domain .",
    "with bohm diffusion @xmath201 for ultrarelativistic crs , so that the scale of the precursor , @xmath202 . at the same time",
    "the peak in the cr momentum distribution extends relatively slowly , with @xmath203 .",
    "the required spatial grid is , thus , 40 times longer than for the shorter simulation illustrated in fig .",
    "the simulated time interval in the extended simulation was 50 times longer .",
    "together those increase the total computational time by a factor 2000 .",
    "the fd calculation with @xmath204 $ ] to @xmath205 took about 2 cpu days on our fastest available processor , so the extended simulation would have been unrealistic using the fd method .",
    "the extended cgmv simulation , however , required only about 10 times the effort of the shorter fd simulation , clearly demonstrating the efficiency of the cgmv scheme . this speed - up is a result of combination of several factors : 20 times larger grid spacing , no need for subcycling for the diffusion convection solver , and , of course , a smaller number of momentum bins .",
    "detailed time dependent simulations of nonlinear cr shock evolution are very expensive if one allows for inclusion of arbitrary , self - consistent and possibly time dependent spatial diffusion , as well as various other momentum dependent transport processes .",
    "the principal computational cost in such calculations is typically the cr transport itself , and , in self - consistent calculations , the analogous transport of the mhd wave turbulence that mediates cr transport .",
    "tracking these behaviors requires adding at least one physical dimension to the simulations compared to the associated hydrodynamical calculations , since the collisionless media involved are sensitive to the phase space configurations of the particles and waves .",
    "particle kinetic equations ( commonly the so - called diffusion convection equation ) provide a straightforward approach to addressing this problem and can be coupled conveniently with hydrodynamical equations that track mass and bulk momentum and energy effectively .",
    "momentum derivatives of the cr distribution function in the diffusion convection equation are most frequently handled by finite differences . although it is simple , that approach requires moderately fine resolution in momentum space .",
    "that is a primary reason that such calculations are costly .",
    "here we introduce a new scheme to solve the diffusion convection equation based on finite volumes in momentum space with a momentum bin spacing as much as an order of magnitude larger than that of the usual finite difference scheme .",
    "we demonstrate that this coarse grained momentum finite volume ( cgmv ) method can be used successfully to model the evolution of strong , cr - modified shocks at much lower computational cost than the finite difference approach .",
    "the computation efficiency is greatly increased , not only because the number of momentum bins is smaller , but also because the required spatial grid spacing is less demanding due to the coarse - grained averaging of the diffusion coefficient used in the cgmv method .",
    "in addition , larger momentum bin size can eliminate the need of subcycling of the diffusion convection solver that can be necessary in some instances using finite differences in momentum .",
    "thus , the combination of the cgmv scheme with amr techniques as developed in our crash code , for example , should allow more detailed modeling of the diffusive shock acceleration process with a strongly momentum dependent diffusion model such as bohm diffusion , or self - consistent treatments of cr diffusion and wave turbulence transport .",
    "twj is supported by nsf grant ast03 - 07600 , by nasa grants nag5 - 10774 , nng05gf57 g and by the university of minnesota supercomputing institute .",
    "hk was supported by kosef through the astrophysical research center for the structure and evolution of cosmos ( arcsec ) .    .",
    "red lines and stars were obtained using the new cgmv scheme with @xmath154 .",
    "the solutions are almost indistinguishable .",
    "a pre - existing cr population , @xmath138 , corresponding to the upstream cr pressure , @xmath139 is included , without fresh injection at the shock ( @xmath206 ) . ]         at @xmath160 for the same shock as shown in fig 2 .",
    "the different curves represent results computed using the fd scheme and three different momentum resolutions with the cgmv scheme .",
    "bottom : the cr distribution function at the shock from the same simulations . ]       and @xmath207 , respectively .",
    "the heavy dashed lines represent solution at @xmath205 with a conventional finite difference scheme using 240 momentum points ( @xmath184 ) .",
    "the red solid lines and x s represent cgmv solutions at @xmath208 and 1000 with 20 momentum bins ( @xmath185 ) . ]"
  ],
  "abstract_text": [
    "<S> we have developed a new , very efficient numerical scheme to solve the cr diffusion convection equation that can be applied to the study of the nonlinear time evolution of cr modified shocks for arbitrary spatial diffusion properties . </S>",
    "<S> the efficiency of the scheme derives from its use of coarse - grained finite momentum volumes . </S>",
    "<S> this approach has enabled us , using @xmath0 momentum bins spanning nine orders of magnitude in momentum , to carry out simulations that agree well with results from simulations of modified shocks carried out with our conventional finite difference scheme requiring more than an order of magnitude more momentum points . </S>",
    "<S> the coarse - grained , cgmv scheme reduces execution times by a factor approximately half the ratio of momentum bins used in the two methods . depending on the momentum dependence of the diffusion , </S>",
    "<S> additional economies in required spatial and time resolution can be utilized in the cgmv scheme , as well . </S>",
    "<S> these allow a computational speed - up of at least an order of magnitude in some cases .    , </S>"
  ]
}