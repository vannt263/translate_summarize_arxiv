{
  "article_text": [
    "we give new bounds for the number of integral points on elliptic curves .",
    "the method may be said to interpolate between approaches via diophantine techniques ( @xcite , @xcite ) and methods based on quasiorthogonality in the mordell - weil lattice ( @xcite , @xcite , @xcite ) .",
    "we apply our results to break previous bounds on the number of elliptic curves of given conductor and the size of the @xmath0-torsion part of the class group of a quadratic field .",
    "the same ideas can be used to count rational points on curves of higher genus .",
    "let @xmath1 be a positive integer .",
    "we show that there are at most @xmath2 elliptic curves over @xmath3 of conductor @xmath1 .",
    "we also prove that , for every non - zero integer @xmath4 , at most @xmath5 elements of the class group of @xmath6 are @xmath0-torsion .",
    "the latter result provides the first improvement on the trivial bound of @xmath7 , whereas the former improves on @xmath8 , which follows from the said trivial bound ( @xcite , thm 1 ) . the new bound on @xmath0-torsion implies that there are at most @xmath5 cubic extensions of @xmath3 with discriminant @xmath4 ( vd .",
    "@xcite , satz 7 ) .",
    "these results are derived from a new method of obtaining bounds for the number of integral ( or rational ) points on curves of non - zero genus .",
    "these questions have attracted considerable interest ; see , e.g. , @xcite . a number of authors have given improved bounds either conditionally ( @xcite ) or in the average ( @xcite , @xcite , @xcite ) .",
    "the problems are intimately linked : the size of @xmath0-torsion can be bounded above by the number of integral points of moderate height on the variety @xmath9 , whereas elliptic curves of given conductor correspond to @xmath10-integral points on a finite collection of elliptic curves of the form @xmath11 .",
    "the question of the size of @xmath0-torsion is of further interest in view of its connection to the enumeration of cubic fields and to upper bounds for the ranks of elliptic curves .",
    "the techniques in this paper are valid over an arbitrary number field .",
    "for example , one may show that the number of cubic extensions of a fixed number field @xmath12 with prescribed discriminant @xmath13 is @xmath14 for some @xmath15 .",
    "this can be deduced without difficulty from the methods of this paper : the key result about point counting , theorem [ thm : astarte ] , is stated over a number field .",
    "let @xmath16 be an elliptic curve defined over a number field @xmath12 .",
    "let @xmath10 be a finite set of places of @xmath12 .",
    "we wish to bound the cardinality of the set @xmath17 of @xmath10-integral points on @xmath16 .",
    "embed the mordell  weil lattice @xmath18 , modulo torsion , into @xmath19 , so that the canonical height on @xmath16 is taken to the square of the euclidean norm .",
    "regard @xmath17 as a subset of @xmath18 .",
    "one way to bound the cardinality of @xmath17 is to exploit the fact that , in a certain sense , the points of @xmath17 tend to be apart from each other .",
    "this idea is already present in @xcite , @xcite ; let us consider it in the manner of @xcite ,  4 .",
    "after some modest slicing of @xmath17 , we see that any two points on the same slice are separated by almost @xmath20 .",
    "we can then apply the best available results on sphere - packing @xcite to obtain a bound on the number of elements of @xmath17 .",
    "this bound ( cor .  [ cor : agobio ] ) improves on @xcite and seems to be the best to date .",
    "corollary [ cor : newcoeur ] improves on a bound of w. schmidt @xcite .",
    "a major weakness of the relatively naive method discussed thus far is that it is very sensitive to the rank of the mordell - weil lattice .",
    "we have used bounds for sphere - packing problems , and such bounds typically depend exponentially on the dimension of the ambient space .",
    "this makes it difficult to apply to many natural problems , including that of @xmath0-torsion in quadratic class groups , where one has a relatively poor bound on the rank of the mordell - weil lattice . in general , this problem will be particularly severe when one is bounding the number of points on @xmath17 below a certain height @xmath21 , where @xmath21 is comparable to the `` height of @xmath16 , '' i.e. , the logarithm of the largest coefficient in a weierstrass equation of @xmath16 .    our key idea to overcome this obstacle is to exploit a certain feature of the geometry of high - dimensional euclidean spaces , namely , the fact that the solutions to certain special types of packing problems depend relatively weakly on the dimension of the ambient space .",
    "more precisely , consider the question : how many vectors can one pack into the unit sphere on @xmath22 such that the angle between any two is @xmath23 ?",
    "it is not difficult to see ( see remark after prop .  [",
    "prop : kl ] ) that one can give an upper bound _",
    "independent of @xmath24 _ when @xmath25 .",
    "we will exploit a related but considerably deeper feature , namely , that this phenomenon persists ( in a much weakened form ) when @xmath26 : for @xmath27 the work of kabatiansky and levenshtein gives an upper bound , for small @xmath28 , of the form @xmath29 .",
    "the critical feature here is that the constant @xmath30 depends sublinearly on @xmath28 .",
    "we shall exploit this feature by introducing a costly type of slicing of @xmath17 , which allows us to increase the angle of @xmath20 , and thus lowers the bound per slice sharply ; we can see the amount of slicing as a parameter to be optimized .",
    "this slicing is carried out as follows : we choose an auxiliary prime @xmath31 , and partition @xmath17 into the fibers of the reduction map @xmath32 ; the size of @xmath31 is our free parameter .-",
    "adically close .",
    "this is already visible for integers : if @xmath33 are distinct , one has @xmath34 , but if @xmath35 are congruent mod @xmath31 one has @xmath36 . ]",
    "the result obtained from @xmath37 is the same as what arises from @xcite , modulo the difference between the canonical and the naive height .",
    "( this is no coincidence ; as we will see , the similarity between the two underlying procedures runs deep . )",
    "we then show that the results depend continuously on the angle , and that @xmath38 is a locally suboptimal choice in the interval @xmath39 .",
    "thus we will be able to make a better choice within the interval , thus obtaining a result better than the canonical - height analogue of @xcite , and , in general , better than the pure bounds as well .",
    "it is only thus that we are able to break the @xmath40 barrier .",
    "the same ideas can be applied to bounding the number of rational points ( or integer points ) up to a certain height on curves of higher genus .",
    "this matter is discussed further in @xcite , where it is shown how to improve in certain contexts on the exponent @xmath41 occurring in the work of heath - brown @xcite and elkies @xcite .",
    "we have therefore provided in the present paper only a sketch of how to extend these methods to that case  see section [ sec : beyond ] .",
    "the techniques known up to now for bounding integral points on elliptic curves did not suffice to improve on the estimates @xmath8 and @xmath7 .",
    "our method , like many results in diophantine approximation , uses the fact that integer points that are @xmath42-adically close tend to repel each other .",
    "one may see the same underlying idea in the works of bombieri  pila ( @xcite ) and heath - brown @xcite ; for a discussion of the parallels between their methods and those in the present paper , see the remark at the end of section  [ subs : bipbip ] .    independently and simultaneously",
    ", l. b. pierce has proved a bound on @xmath43 that breaks @xmath44 .",
    "pierce s bound is @xmath45 , in general ; for @xmath4 with certain divisibility properties the bound improves to @xmath46 . the methods in @xcite",
    "are quite different from those in the present paper ; they are based on the square sieve .",
    "we would like to thank m. bhargava , a. brumer , s. david , f. gerth , d. goldfeld , r. heath - brown , h. iwaniec , a. j. de jong , l. b. pierce , j. h. silverman and k. soundararajan for their advice and encouragement .",
    "let @xmath12 be a number field .",
    "we write @xmath47 for the ring of integers of @xmath12 , @xmath48 for the semigroup of ideals of @xmath47 , @xmath49 for the class group of @xmath12 , @xmath50 for the set of all places of @xmath12 , and @xmath51 for the set of all infinite places of @xmath12 .",
    "we write @xmath52 for the norm of an ideal @xmath53 . by a _",
    "prime _ we will mean either a finite place of @xmath12 , or the prime ideal corresponding thereto . let @xmath42 be a non - archimedean place of @xmath12 , @xmath54 the completion of @xmath12 at @xmath42 , and @xmath31 the prime of @xmath3 below @xmath42 .",
    "we denote by @xmath55 the valuation , normalized as usual to be surjective , and we shall normalize the absolute value @xmath56 so that it extends the usual value @xmath57 of @xmath3 .",
    "thus , for @xmath58 , @xmath59 , where @xmath60 is the ramification degree of @xmath54 over @xmath61 .    given a set of places @xmath62 , we write @xmath63 for the ring of _ @xmath10-integers_. an @xmath10-integer is an @xmath64 with @xmath65 for @xmath66 .",
    "we write @xmath67 for the product of all finite places in @xmath10 , seen as ideals .",
    "by @xmath68 we mean the @xmath69-torsion subgroup of a group @xmath70 .",
    "define @xmath71 , @xmath72 .",
    "( by @xmath73 we mean the cardinality of a set @xmath74 . ) the number of prime ideals dividing an ideal @xmath53 is denoted by @xmath75 .",
    "if @xmath76 , we may write @xmath77 instead of @xmath78 .    given a place @xmath42 of @xmath12 , we let @xmath79 we further set @xmath80 $ ] where @xmath31 is the place of @xmath81 below @xmath12 ; in particular , @xmath82 or @xmath83 when @xmath42 is complex or real , respectively .    if @xmath84 is an integral domain with quotient field @xmath12 , and @xmath85 is an @xmath84-module , we write @xmath86 for the dimension of @xmath87 over @xmath12 .    for every @xmath88 ,",
    "we define @xmath89 given @xmath64 , we define its _ height _ @xmath90 and its _ absolute height _",
    "@xmath91      let @xmath16 be an elliptic curve over a number field @xmath12 . given a field @xmath92",
    ", we use @xmath93 to denote the set of @xmath94-valued points of @xmath16 .",
    "( thus @xmath95 is the set of rational points of an elliptic curve defined over @xmath3 . )",
    "we take @xmath16 to be given by a weierstrass equation @xmath96 where @xmath97 . by @xmath98 ( resp .",
    "@xmath99 ) we mean the @xmath100-invariant ( resp . discriminant ) of ( [ eq : weierstrass ] ) .",
    "we write @xmath101 , @xmath102 for the @xmath103- and @xmath104-coordinates of a point @xmath105 other than the origin .",
    "given a set of places @xmath106 , we denote by @xmath107 the set of _ @xmath10-integral points _ , i.e. , points with @xmath10-integral coordinates : @xmath108    as is usual , we write @xmath109 for the _ canonical height _ on @xmath16 , defined on all points of @xmath110 .",
    "the canonical height @xmath109 is a positive definite quadratic form on the abelian group @xmath110 , or , by restriction , on @xmath18 .",
    "it lets itself be expressed as a sum of _ local height functions _",
    "@xmath111 , as follows : @xmath112    local height functions are canonically defined up to an additive constant ; we follow the conventions in @xcite , ch .",
    "vi , and @xcite , ch .",
    "vi , which make local heights independent of the model . note that @xmath113 for every place @xmath42 , and , in particular , @xmath114 for any place @xmath42 and any @xmath115 .",
    "we recall that an elliptic curve @xmath16 over a nonarchimedean local field @xmath12 is said to have _ potentially good reduction _ if it admits a model with good reduction in some extension of @xmath12 .",
    "we say that @xmath16 has _ potentially multiplicative reduction _ if it does not have potentially good reduction ; this occurs precisely when the @xmath100-invariant of @xmath16 is not integral",
    ". see ( * ? ? ?",
    "* chapter vii ) .",
    "integral points on elliptic curves tend to repel each other ; so do rational points on curves of higher genus .",
    "a classical formulation of the latter fact is due to mumford @xcite ; the former phenomenon can be seen to surface in @xcite and @xcite . in order to go further , however , we must quantify this repulsion in a fashion that is more uniform and more flexible than those available up to date .",
    "as in @xcite , we will use local heights . roughly speaking ,",
    "we wish to establish a result of the form @xmath116 .",
    "although this is not quite true at places of bad reduction or at the archimedean places , it is true if we subdivide @xmath117 into a fairly small number of slices and ask that @xmath118 lie in the same slice ; see lemmas [ lem : potgood][lem : tetris ] .",
    "one feature of these lemmas is that they provide somewhat sharper results in the region where @xmath119 than elsewhere ; this will eventually be significant in dealing with points of small ( global ) height .",
    "we can then prove the quasi - orthogonality result in prop .",
    "[ prop : affreuse ] . in words , it asserts : integral points are quite far apart from each other in the mordell - weil lattice , and , moreover , forcing two integral points to be congruent modulo some ideal of @xmath120 forces them even further apart in the mordell - weil lattice .",
    "it should be remarked that if one is willing to accept an extra factor of size about @xmath121 in thm [ thm : astarte ] , where @xmath122 is the number of places of potentially multiplicative reduction , the proofs that follow can be considerably simplified . in this context , note that @xmath123 has in fact @xmath124 , so this weaker version would suffice for the applications in section [ sec : ghatyar ] .",
    "indeed , for the applications of section [ sec : ghatyar ] , it is not difficult to avoid local heights completely : since we deal with the curves @xmath125 , one may use the fact that they are all twists of @xmath126 to prove the required special cases of prop .  [",
    "prop : affreuse ] and thm.[thm : astarte ] in an elementary fashion ( cf .",
    "@xcite , lem .  4.16 ) .",
    "[ lem : potgood ] let @xmath16 be an elliptic curve over a non - archimedean local field @xmath54 with potentially good reduction .",
    "let @xmath115 be two distinct points .",
    "then @xmath127    pass to an extension @xmath128 of @xmath54 on which @xmath16 acquires good reduction .",
    "choose a weierstrass equation for @xmath16 over @xmath128 such that @xmath129 .",
    "then @xmath130 .",
    "the statement follows therefrom by direct computation .",
    "( alternatively , use the definition of the local height in terms of the canonical filtration . )",
    "[ lem : potmult ] let @xmath16 be an elliptic curve over a non - archimedean local field @xmath54 with potentially multiplicative reduction . then , for any sufficiently small @xmath131 , there is a partition @xmath132 such that for any two distinct points @xmath133 , @xmath134 and for any two distinct points @xmath135 , @xmath136 , @xmath137 the implied constant is absolute .",
    "the elliptic curve @xmath16 is isomorphic , over an algebraic closure @xmath138 , to a tate curve @xmath139 for some @xmath140 satisfying @xmath141 , where @xmath142 is the @xmath100-invariant of @xmath16 ; see @xcite , ch .",
    "v.    there is a natural composition @xmath143 where @xmath144 is the minimal extension such that @xmath16 acquires split multiplicative reduction over @xmath128 , and the map @xmath28 is given by @xmath145 on the tate curve .",
    "( see @xcite , pp .  6869",
    "@xcite , p.  270 . ) for every @xmath146 , @xmath147 where @xmath148 is an extension of @xmath42 as above , @xmath149 is a uniformizer of @xmath148 , @xmath150 , @xmath151 when @xmath152 , and , if @xmath153 , @xmath154 is the largest integer @xmath155 such that @xmath156 , where @xmath157 is the canonical filtration of @xmath158 .",
    "( see @xcite , pp .",
    "6870 ; cf.@xcite , p.  270 . )",
    "clearly @xmath159 if @xmath160 , it follows that @xmath161 .",
    "define , then , @xmath162 .",
    "it remains to partition @xmath163 .",
    "partition @xmath164 into sets @xmath165 , where @xmath166 : @xmath167    note that @xmath168 is decreasing on @xmath169 $ ] .",
    "suppose @xmath170 both belong to @xmath171 and @xmath172 .",
    "if @xmath173 , we have @xmath174 if @xmath175 then @xmath176 where @xmath177 .",
    "then : @xmath178    ( the last two inequalities are proved in two cases according to whether @xmath179 or @xmath180 . in the former case we have @xmath181 .",
    "in the latter case , @xmath182 and @xmath183 ; in particular @xmath184 .",
    "since @xmath185 , it follows that @xmath186 , where we assume @xmath187 ; similarly , @xmath188 , where we assume @xmath189 . )    combining ( [ eq : jeq0 ] ) and ( [ eq : jeq1 ] ) we obtain in the displayed equation will be used in the proof of lem .",
    "[ lem : tetris ] . ]",
    "@xmath190 for all @xmath191 , @xmath192 , where @xmath172 .",
    "define @xmath193 for @xmath192 .",
    "we set @xmath194 and are done .",
    "[ lem : tetris ] let @xmath16 be an elliptic curve over @xmath195 . then , for any sufficiently small @xmath131 , there is a partition @xmath196 such that for any two distinct points @xmath197 , @xmath198 , @xmath199 and for any two distinct points @xmath197 , @xmath200 , @xmath201 the implied constant in ( [ eq : ago ] ) is absolute .",
    "there is an isomorphism @xmath202 for some @xmath203 in the usual fundamental domain of @xmath204 .",
    "note especially that @xmath205 .",
    "write @xmath206 , @xmath207 .",
    "define @xmath208 , @xmath209  note that @xmath210 .",
    "the local height is given by @xmath211 where @xmath212 and @xmath168 is as in the proof of lem .",
    "[ lem : potmult ] .",
    "( see , e.g. @xcite , ch .",
    "vi , thm 3.4 . )",
    "we partition @xmath213 into sets @xmath165 as in the same proof . for the present proof we adjoin",
    "@xmath214 to @xmath215 , since lem .",
    "[ lem : potmult ] partitions only @xmath216 .    whenever @xmath217 , with @xmath218 , belong to the same set @xmath171 one obtains @xmath219 as in ( [ eq : boundm ] ) , where we assume @xmath220 .",
    "let @xmath221 .",
    "since @xmath222 , we may assume @xmath223 without loss of generality .",
    "let @xmath224 be the annulus @xmath225 ; thus whenever @xmath226 we have @xmath227 .    in view of ( [ eq : tutankhamen ] ) and @xmath228",
    ", it will suffice ( see ( [ eq : strom3 ] ) ) to partition @xmath229 into sets @xmath230 such that @xmath231 if @xmath232 and @xmath233 for some @xmath234 , and @xmath235 if @xmath232 and @xmath233 for some @xmath236 .    _ the region near @xmath237 . _",
    "let @xmath238 .",
    "note @xmath239 .    for @xmath240 , @xmath241 , @xmath242 ( here we use the fact that @xmath210 .",
    ") thus , for any @xmath243 with @xmath244 , @xmath245 we can thus define the sets @xmath246 where @xmath247 and @xmath248 is small enough so that ( a ) @xmath249 in ( [ eq : polen ] ) is less than @xmath250 in absolute value when @xmath251 , ( b ) @xmath252 , and ( c ) @xmath253 , for any @xmath254 , whenever @xmath255 .",
    "the conditions in ( [ eq : varlam ] ) are then satisfied .    _ the region near z=0 .",
    "_ we will partition the region @xmath256 we have the bounds @xmath257 in particular , there is an absolute constant @xmath258 such that , if @xmath259 and @xmath260 , @xmath261    we will eventually choose @xmath262 , so that if @xmath263 , then @xmath264 for all @xmath265 and the set @xmath266 is empty .",
    "we may therefore assume that @xmath260 and that ( [ eqn : froggy ] ) holds .",
    "now , for any @xmath267 such that @xmath268 , @xmath269    for @xmath270 , let @xmath271 where @xmath272 is an absolute constant such that @xmath273 for @xmath274 .",
    "suppose @xmath275 are such that @xmath276 and @xmath277 for some @xmath278 .",
    "then @xmath279 belongs to @xmath229 and satisfies @xmath280 .",
    "then ( [ eqn : froggy ] ) shows that @xmath281 . combining this with ( [ eq : cojones ] )",
    ", we obtain : @xmath282 for @xmath221 with @xmath283 .",
    "we set @xmath284 and are done .",
    "_ the remaining region .",
    "_ it remains to partition the region @xmath285 .",
    "by virtue of ( [ eq : strom1 ] ) and ( [ eq : strom2 ] ) , if @xmath286 , then @xmath287 differs from @xmath288 by an absolutely bounded constant . in particular",
    ", there are absolute constants @xmath289 such that , for any @xmath290 , @xmath291 whenever @xmath292 , and @xmath293 for all @xmath294 . by ( [ eq : bound1 ] ) and ( [ eq : bound2 ] ) , we may choose a sufficiently small ( absolute ) constant @xmath295 such that @xmath296 for all @xmath297 , @xmath298 with @xmath299 , @xmath300 , @xmath301 .",
    "now , for any @xmath302 , @xmath303 with @xmath304 , @xmath223 and @xmath305 .",
    "hence it is enough to partition @xmath306 into squares of side @xmath307 . since @xmath306 is contained in the rectangle @xmath308 , there are @xmath309 such squares .",
    "their images under exp partition @xmath84 into sets @xmath310 , with @xmath311 .",
    "we have @xmath312 for some @xmath313 . by ( [ eq : donaldtrump ] )",
    ", we may conclude that , for @xmath221 with @xmath314 , @xmath315 , we have : @xmath316 which certainly imply ( [ eq : recall ] ) .    _ conclusion .",
    "_ let @xmath317 $ ] be the map @xmath318 .",
    "we partition @xmath319 into the sets @xmath320 where @xmath321 , @xmath322 .",
    "the inequality @xmath323 in ( [ eq : varlam ] ) ensures that @xmath324 for @xmath247 , @xmath325 .",
    "we define @xmath326 to be the sets in ( [ eq : strom3 ] ) arising from @xmath327 , and @xmath328 to be the other non - empty sets in ( [ eq : strom3 ] ) .",
    "[ prop : affreuse ] let @xmath16 be an elliptic curve over a number field @xmath12 , given by a weierstrass equation ( [ eq : weierstrass ] ) .",
    "let @xmath10 be a finite set of places of @xmath12 , including all infinite places and all primes dividing the discriminant of @xmath16 .",
    "let @xmath329 be two distinct @xmath10-integral points .",
    "let @xmath330 be sufficiently small .",
    "assume that @xmath302 and @xmath303 belong to the same set @xmath331 for every infinite place @xmath42 and every place @xmath42 of potentially multiplicative reduction ( see ( [ eq : marmite ] ) , ( [ eq : ago ] ) ) .",
    "furthermore , suppose that @xmath332 where @xmath333 .",
    "let @xmath13 be an ideal of @xmath47 not divisible by any primes in @xmath10 .",
    "assume that @xmath302 and @xmath303 have the same reduction and @xmath13 , there is a well - defined reduction map @xmath334 .",
    "] modulo @xmath13 .",
    "then @xmath335    for every finite place @xmath42 of good reduction , @xmath336 ( by e.g. @xcite , thm .",
    "vi.4.3 , or @xcite , thm .",
    "hence @xmath337 by lemmas [ lem : potgood ] , [ lem : potmult ] and [ lem : tetris ] , together with ( [ eq : frenchfries ] ) , @xmath338 note that @xmath339 .",
    "thus @xmath340 since @xmath341 , @xmath342 are @xmath10-integers , and @xmath10 contains all infinite places and all primes dividing the discriminant of @xmath16 , we see : @xmath343 for @xmath344 .",
    "it remains to consider @xmath345 for @xmath42 finite , @xmath346 .",
    "let @xmath347 be the corresponding prime ideal of @xmath47 , and @xmath348 its multiplicity in @xmath13 .",
    "the point @xmath349 is not @xmath350 , but it is mapped to origin when reduced modulo @xmath351 . hence @xmath352 .",
    "therefore @xmath353 , where @xmath354 is the rational prime lying under @xmath42 and @xmath60 the ramification degree of @xmath54 over @xmath355 .",
    "we note that @xmath356 to conclude .",
    "we will use prop .",
    "[ prop : affreuse ] to give an upper bound on the number of @xmath10-integral points on the curve @xmath357 .",
    "any application of quasi - orthogonality leads fairly naturally to a bound of the form @xmath358 for some constant @xmath359 ( vd .",
    "however , in applications such as estimating the size of @xmath0-torsion , the size of @xmath359 is crucial ; if @xmath359 is too large , one does not recover even the trivial bounds on @xmath0-torsion .",
    "one may optimize the bound by applying sphere packing ( cf .",
    "@xcite ) ; in order to make this approach particularly effective , we first partition the set of integer points on @xmath16 , and then apply sphere - packing bounds to each part separately .    for @xmath360 , we set @xmath361 .",
    "let @xmath362 be the associated metric on @xmath363 .",
    "let @xmath364 .",
    "[ lem : covak ] let @xmath365 be positive real numbers , @xmath366 , @xmath24 a non - negative integer .",
    "let @xmath367 .",
    "then there is a subset @xmath368 and an explicit , absolute constant @xmath369 such that @xmath370 and the @xmath371-balls @xmath372 , for @xmath373 , cover all of @xmath10 .",
    "the idea is to slice @xmath10 into a union of regions where @xmath374 is almost constant and then to consider the points on a lattice in each of these regions .",
    "since we may replace @xmath330 by @xmath375 , it suffices to cover @xmath10 by balls @xmath376 .",
    "let @xmath377 be the largest integer no greater than @xmath378 . for @xmath379 , we set @xmath380",
    ". define @xmath381 .",
    "set @xmath382 then @xmath383 has the required property : given @xmath384 , set @xmath385 then @xmath386 belongs to @xmath383 .",
    "moreover , @xmath297 satisfies @xmath387 , by virtue of the fact that @xmath388 for any @xmath389 .",
    "it remains to estimate @xmath390 :    @xmath391 the result follows by stirling s formula .",
    "we will need lower bounds on the canonical height .",
    "note that there are strong bounds for the _ number _ of points of moderately low height @xcite ; such bounds could be used in place of the following proposition .",
    "[ prop : lowbound ] let @xmath16 be an elliptic curve over a number field @xmath12 .",
    "there is an absolute constant @xmath392 such that , for every non - torsion point @xmath393 , @xmath394 where @xmath122 is the number of places of @xmath12 where @xmath16 has potentially multiplicative reduction , and @xmath142 is the @xmath100-invariant of @xmath16 .    by the proof of the theorem in @xcite ,  4",
    "; see also @xcite , thm .",
    "we shall use the remarkable bounds of kabatiansky and levenshtein .",
    "[ prop : kl ] let @xmath395 be the maximal number of points that can be arranged on the unit sphere of @xmath22 such that the angle @xmath396 between any two of them and the origin is no smaller than @xmath397 .",
    "then for @xmath398 , @xmath399 where the convergence of @xmath400 as @xmath401 is uniform and explicit for @xmath397 within any closed subinterval of @xmath402 . in particular , for @xmath403 ,",
    "we have @xmath404    see @xcite ; vd .",
    "also the expositions in @xcite and @xcite , ch",
    ".  9 .    for fixed @xmath25 , the function @xmath405 is bounded above _ independently _ of @xmath24 : given @xmath406 unit vectors @xmath407 separated by angles of @xmath397 or more , @xmath408    it may hence not be surprising that the derivative of the right side of ( [ eq : packing ] ) is zero for @xmath409 .",
    "this qualitative feature is , in fact , the crucial ingredient in our bound on @xmath0-torsion . in our application",
    ", we will apply ( [ eq : packing ] ) with a @xmath397 that we will have some freedom in choosing .",
    "as @xmath397 decreases , the increase in the right - hand side of ( [ eq : packing ] ) will be offset by a decrease in `` cost '' linear in @xmath397 .",
    "in the neighborhood of @xmath410 , therefore , it will always be advantageous to decrease @xmath397 slightly .",
    "we shall put this idea in practice in the following way .",
    "we shall partition the set of integral points on an elliptic curve so that any two points @xmath118 in the same part are separated by an angle of at least @xmath397 in the mordell - weil lattice .",
    "we will then apply ( [ eq : packing ] ) to bound the number of points in each part .",
    "( we can do the same for rational points on curves of higher genus ; see section [ sec : beyond ] . )",
    "the bounds that correspond to @xmath409 will correspond ( at least in cases where one can bound the difference between canonical and naive heights ) to the `` uniform '' bounds of bombieri - pila and heath - brown . reducing @xmath397",
    "slightly , under favorable circumstances , gives an improvement .",
    "the agreement between the output of this method and the results of @xcite and @xcite is no coincidence : see the remarks after theorem [ thm : astarte ] .      in the theorem that follows ,",
    "the reader might wish to ignore the dependence on @xmath10 in a first reading .",
    "the theorem asserts , in approximate language , that the number of points in @xmath17 of height up to @xmath21 is bounded above by @xmath411 h_0 + ( \\beta(t)+\\epsilon)r}$ ] , where @xmath412 is the mordell - weil rank . here",
    "$ ] is a free parameter that will be optimized in applications : the basic idea is that if @xmath412 is small compared to @xmath21 it is advantageous to take @xmath414 small , whereas in applications where @xmath412 might be very large , we take @xmath414 close to @xmath83 . this optimization process is formalized in cor .",
    "[ cor : bound ] .    roughly speaking , the proof of the theorem proceeds , in words , as follows .",
    "we partition the points of @xmath17 into points mod @xmath415 , where @xmath415 is a suitable ideal in @xmath120 with norm about @xmath411 h_0}$ ] .",
    "[ prop : affreuse ] shows that  after some slight refinement of this partition  the points belonging to the same part are very well - separated in the mordell - weil lattice .",
    "we then apply sphere packing bounds in the form of prop .",
    "[ prop : kl ] to each part separately .",
    "the term @xmath411 h_0}$ ] arises from the number of parts , whereas the term @xmath416 arises from the sphere packing bounds applied to each part .",
    "we finally note that the purpose of most of the auxiliary lemmas on previous pages is to help us carry out the `` slight refinement '' mentioned above .",
    "[ thm : astarte ] let @xmath16 be an elliptic curve over a number field @xmath12 defined by a weierstrass equation ( [ eq : weierstrass ] ) .",
    "let @xmath10 be a finite set of places of @xmath12 , including all infinite places and all primes dividing the discriminant of @xmath16 .",
    "then , for every @xmath417 and every choice of @xmath418 , the number of @xmath10-integer points of @xmath18 of canonical height up to @xmath21 is at most @xmath419   h_0 +   ( \\beta(t ) + \\epsilon ) r}\\right),\\ ] ] for every sufficiently small @xmath330 , where @xmath412 is the rank of @xmath18 as a @xmath420-lattice , @xmath421 is @xmath422 , @xmath359 is an absolute constant , @xmath423 for @xmath424 .",
    "we set @xmath425 .",
    "we first carry out a very mild partitioning ( i.e. , into very few parts ) of @xmath426 so as any two points in the same part have comparable canonical height . applying prop .",
    "[ prop : lowbound ] , we see that one can cover the set @xmath427 by by @xmath428 sets of the form @xmath429",
    ". it therefore suffices to prove the bound , with @xmath430 replaced by @xmath431 , just for the set of points @xmath297 satisfying @xmath432 .",
    "suppose first that @xmath433 .",
    "let @xmath434 be the set of places of @xmath81 below @xmath10 .",
    "if @xmath435})$ ] , where @xmath436 is an appropiately chosen constant , there is a prime @xmath31 of @xmath3 with @xmath437 and @xmath438 .",
    "the ideal @xmath415 of @xmath47 generated by @xmath31 satisfies @xmath439 } s^{\\lbrack k : \\mathbb{q}\\rbrack + 1 } e^{t \\lbrack k:\\mathbb{q}\\rbrack h_0 } .\\ ] ] the @xmath10-integer points of @xmath18 fall into at most @xmath440}({n}{\\mathscr{i}})$ ] classes under reduction modulo @xmath13 .",
    "let @xmath84 be the set of all infinite places and all places of potentially multiplicative reduction .",
    "for every @xmath441 , partition @xmath117 into @xmath442 subsets , where @xmath348 is as in ( [ eq : marmite ] ) for @xmath42 finite , and @xmath348 is as in ( [ eq : ago ] ) for @xmath42 infinite , in both cases with @xmath375 instead of @xmath330 .",
    "consider any tuples @xmath443 , @xmath444 with @xmath445 , @xmath446 .",
    "define @xmath447 to be the set of non - torsion points @xmath448 such that , for all @xmath441 , ( a ) @xmath449 , ( b ) @xmath336 if and only if @xmath450 .",
    "we will show how to bound the cardinality of @xmath451 . combining this with the fact that the number of sets @xmath447 is at most @xmath452 will yield the conclusion .",
    "let @xmath453 .",
    "let @xmath454 be the map defined by @xmath455 since @xmath456 for @xmath457 , prop .",
    "[ prop : lowbound ] implies @xmath458 \\kappa^{s } \\max(1,h(j)).\\ ] ] on the other hand , by @xcite , prop .  3 , ( 1 )",
    ", we have that @xmath459 , and thus @xmath460 whenever @xmath461 . by lemma [ lem : covak ]",
    ", we can cover @xmath462 by at most @xmath463 balls @xmath464 in the metric @xmath465 . for @xmath466 with @xmath467 , we have @xmath468 .",
    "suppose @xmath302 and @xmath303 have the same reduction modulo @xmath415 .",
    "then , by prop.[prop : affreuse ] , @xmath469    embed the mordell - weil lattice @xmath18 modulo torsion into @xmath470 so as to send @xmath109 to the square of the euclidean height . since @xmath471 , the images @xmath472 of @xmath302 and @xmath303 are different from each other and from the origin @xmath350 . by ( [ eq : argante ] ) , and the fact that @xmath473 lie in the interval @xmath474 $ ] , the angle @xmath475 is at least @xmath476 .",
    "we may now apply the kl bound ( prop .",
    "[ prop : kl ] ) , and obtain that there are at most @xmath477 points of @xmath478 with image in a given ball @xmath479 and with prescribed reduction modulo @xmath13 .",
    "( the factor @xmath480 is an upper bound ( @xcite ) on the number of torsion points in @xmath18 . ) combining this with our estimates for the number of possibilities for reduction mod @xmath415 ( [ eq : num1 ] ) , the number of sets @xmath447 ( [ eq : num2 ] ) , and the number of balls @xmath481 ( [ eq : num3 ] ) , we obtain the statement of the theorem .    in the case of @xmath482",
    ", we proceed as above but without using @xmath13 .",
    "note that @xmath482 gives a pure application of sphere - packing , whereas @xmath483 recovers a bound of the quality of @xmath484 ( for some constant @xmath295 ) with almost no dependence on the rank . for our bound on @xmath0-torsion ( theorem [ thm : classbound ] ) we will apply the result with @xmath485 optimized ; for the result on elliptic curves ( theorem [ thm : ecurve ] ) we will apply it with @xmath482 .",
    "the bound with @xmath483 is very closely related to the bombieri - pila bound @xcite . to see this ,",
    "take for a moment @xmath486 and let @xmath16 be given by a weierstrass equation ( [ eq : weierstrass ] ) .",
    "the canonical height of the integral point @xmath487 on @xmath16 is given by @xmath488 ; we shall ignore the term @xmath489 for the sake of exposition .",
    "if @xmath1 is large , then any integral point @xmath490 on @xmath16 with @xmath491 has in fact @xmath492 and thus @xmath493 .",
    "then the bound given by theorem [ thm : astarte ] shows that the number of such points is at most @xmath494 , which agrees with the bound of @xcite in the case of degree @xmath0 .",
    "this apparent coincidence is a sign of a deeper parallelism between the two methods .",
    "suppose one attempts to carry through the proof of theorem [ thm : astarte ] with @xmath495 .",
    "in other words , we choose the auxiliary ideal @xmath13 to satisfy @xmath496 h_0 $ ] . in this case , the remark after prop .",
    "[ prop : kl ] shows that the number of integral points on @xmath16 with height @xmath497 and reducing to a fixed point modulo @xmath13 is bounded independently of the rank of @xmath18 .",
    "this is precisely what @xcite and @xcite prove , as follows : first , let @xmath94 be a large integer .",
    "one constructs a certain meromorphic function @xmath498 on @xmath499 such that @xmath498 vanishes to high order along the diagonally embedded @xmath16 .",
    "if @xmath500 all reduce to the same point ( modulo @xmath13 ) then @xmath501 is @xmath13-adically near the diagonal , so @xmath502 must be divisible by a high power of @xmath13 . on the other hand ,",
    "its archimedean norm is not too large ; if @xmath94 and @xmath13 are chosen correctly , one obtains thus a contradiction .",
    "remarkably , the same function @xmath498 also lurks among our methods . if one were to carry out the proof of theorem [ thm : astarte ] with @xmath503 as suggested , using ( [ eqn : unif ] ) instead of sphere - packing , the crucial ingredient is the fact that @xmath504 for any points @xmath505 .",
    "this may be equivalently phrased : @xmath506 , where the latter sum is taken over unordered subsets @xmath507 of size @xmath508 .    now",
    "the expression @xmath509 is a weil height on @xmath499 with respect to a certain divisor @xmath4 .",
    "( denoting by @xmath510 the projections onto the @xmath511th and @xmath512th factors , for @xmath513 , and by @xmath514 and @xmath515 the divisors on @xmath16 and @xmath516 defined by the origin and diagonal respectively , we can take @xmath517 . ) from this point of view , the assertion that this height is always _ positive _ is ( more or less ) the assertion that @xmath4 is _ effective _ , i.e. that there is a meromorphic function @xmath498 on @xmath499 such that @xmath518 .",
    "it can be verified that , with appropriate choices , this function can be taken to be the function @xmath498 discussed above .",
    "one can push this further to an almost word - for - word translation from one method to another . on the other hand , when @xmath519 , the proof of theorem [ thm : astarte ] begins to use , in an essential way , the geometry of elliptic curves ",
    "one may say : the geometry of curves of non - zero genus  and the translation fails .",
    "this is hardly surprising , as the bombieri ",
    "pila bounds are often tight for rational curves .",
    "we define @xmath520 for @xmath521 , where @xmath522 is as in ( [ eq : dotty ] ) .",
    "we set @xmath523 .",
    "[ cor : bound ] let @xmath16 be an elliptic curve over a number field @xmath12 .",
    "let @xmath10 be a finite set of places of @xmath12 , including all infinite places and all primes dividing the discriminant of @xmath16 .",
    "let @xmath524 .",
    "then , for every @xmath417 , the number of @xmath10-integer points of @xmath18 of canonical height up to @xmath21 is at most @xmath525 for every sufficiently small @xmath330 , where @xmath421 is @xmath422 and @xmath359 is an absolute constant .",
    "the statement is simply that of thm .",
    "[ thm : astarte ] with @xmath414 optimized .",
    "let @xmath10 to be the set of all infinite places and all primes of bad reduction , and assume , for simplicity , that @xmath526 .",
    "assume that @xmath527 for some constant @xmath295 .",
    "then the main contribution to ( [ eq : b ] ) is given by @xmath528 since @xmath529 , the minimum of @xmath530 is attained to the left of @xmath483 . since @xmath531",
    ", we actually have @xmath532 for some constant @xmath533 depending only on @xmath295 .",
    "we obtain a bound of the type @xmath534 for any @xmath535 . as remarked after thm .",
    "[ thm : astarte ] , the bound @xmath536 would be obtained if we proceeded as in @xcite and @xcite ; thus ( [ eq : hj ] ) gives an improvement in the exponent .",
    "there is a long tradition  starting with @xcite  of effective upper bounds on the height of integral points on an elliptic curve .",
    "it is clear that any such bound yields a quantitative result , i.e. , an effective upper bound on the number of integral points .",
    "we will see how upper bounds on heights can be combined with pure quasi - orthogonality so as to show that @xmath537 is essentially bounded by a power of the discriminant @xmath515 of @xmath16 .",
    "there are already bounds of a comparable quality in the literature ; in particular , @xcite can be used to bound @xmath538 by a power of @xmath515 .",
    "what we have here is simply an improvement in the exponent . in the next section",
    ", we will be in a situation in which exponents are crucial ; we will also be able to take advantage of complex multiplication to reduce our exponents further .",
    "we note that for our purposes it is very important that the available bounds for integral points have the property that they bound the canonical height by a power ( or at least a sub - exponential function ) of the coefficients of the elliptic curve . in our context",
    "we will use a very strong bound due to hajdu and herendi @xcite .    in what follows",
    "we take @xmath486 for simplicity .",
    "[ prop : aghyut ] let @xmath16 be an elliptic curve over @xmath3 defined by a weierstrass equation of the form @xmath539 , where @xmath540 .",
    "let @xmath10 be a finite set of places of @xmath3 , including the infinite place .",
    "then , for any @xmath541 , @xmath542 where @xmath543 , @xmath31 is the largest prime in @xmath10 ( set @xmath544 if @xmath545 ) , @xmath515 is the discriminant of @xmath16 , @xmath546 , and @xmath547 are explicit absolute constants .",
    "see @xcite , thm .  2 .",
    "see @xcite for bounds on @xmath548 .",
    "[ cor : agobio ] let @xmath16 be an elliptic curve over @xmath81 defined by a weierstrass equation with integer coefficients .",
    "let @xmath10 be a finite set of places of @xmath81 , including @xmath549 and all primes dividing the discriminant of @xmath16 .",
    "then the number of @xmath10-integer points on @xmath550 is at most @xmath551 for every sufficiently small @xmath330 , where @xmath412 is the rank of @xmath550 as a @xmath420-lattice , @xmath421 is @xmath422 , @xmath359 is an absolute constant , @xmath31 is the largest prime in @xmath10 , @xmath515 is the discriminant of @xmath16 , and @xmath552 is as in ( [ eq : dotty ] ) .",
    "numerically , @xmath553 .",
    "we may , without loss of generality , assume that @xmath16 is given by @xmath554 with @xmath555 .",
    "( indeed , we may make a linear substitution of variables transforming @xmath16 to this form , carrying integer points to integer points , and increasing @xmath556 by at most an absolutely bounded amount . )",
    "the result is then immediate from thm .",
    "[ thm : astarte ] and prop .",
    "[ prop : aghyut ] .",
    "( note that @xmath557 , by prop .",
    "[ prop : aghyut ] itself applied to @xmath558 . )",
    "[ cor : newcoeur ] let @xmath16 be an elliptic curve over @xmath81 defined by a weierstrass equation with integer coefficients",
    ". then the number of integer points on @xmath95 is at most latexmath:[\\[o_{\\epsilon } \\left (     sufficiently small @xmath330 , where @xmath515 is the discriminant of @xmath16 and @xmath552 is as in ( [ eq : dotty ] ) .",
    "numerically , @xmath560 .",
    "we can take @xmath16 to be given by an equation of the form @xmath539 , @xmath540 .",
    "let @xmath561 be sufficiently small . by cor .",
    "[ cor : agobio ] , we obtain a bound of @xmath562 where @xmath412 is the rank of @xmath18 .",
    "let @xmath12 be the cubic field generated by a root of @xmath563",
    ". then @xmath564 by @xcite , prop",
    "( if @xmath565 is not irreducible , a stronger bound follows by @xcite , prop 9.8(b ) . )",
    "since the discriminant of @xmath12 divides @xmath515 , we see that @xmath566 .",
    "finally , @xmath567 for @xmath568 large enough , and thus @xmath569 .",
    "we set @xmath561 small enough in terms of @xmath330 , and are done .",
    "corollary [ cor : newcoeur ] improves on the bound @xmath570 proven by w. schmidt ( @xcite , thm .  1 ) on the basis of the results in @xcite .",
    "the exponent @xmath571 arises from the trivial bound @xmath572 , where @xmath94 is a cubic field over @xmath3 of discriminant @xmath515 .",
    "one of our main tasks in the following section will be to do better than cor .",
    "[ cor : newcoeur ] in the case of mordell equations .",
    "we have not been able to improve on @xmath573 , but , as we will see , we can improve on @xmath574 .",
    "note that cor .",
    "[ cor : newcoeur ] would already be enough to break current bounds on the number of elliptic curves of given conductor ( cf .",
    "[ thm : ecurve ] ) .",
    "throughout this section , let @xmath4 be a nonzero integer .",
    "we denote by @xmath575 the elliptic curve @xmath123 .",
    "suppose , for simplicity , that @xmath4 is negative ; as we will see , we can assume as much by scholz s reflection principle .",
    "we may bound the class number @xmath576 from above by the number of integer points on @xmath577 , @xmath578 .",
    "we then apply cor .",
    "[ cor : bound ] to bound the number of integer points in terms of the rank of @xmath577 .",
    "since @xmath577 has complex multiplication , one may do a cm - descent and thereby bound the rank of @xmath577 in terms of @xmath576 .",
    "we thus establish a feedback that , once started , lowers @xmath576 to an equilibrium point .",
    "note that thm .",
    "[ thm : astarte ] with @xmath482 ( or @xmath483 ) would be insufficient to start the loop ; only a mixed bound will do where a pure bound will not .",
    "the problem of counting elliptic curves of given conductor also reduces to counting points on curves of the form @xmath577 . again",
    ", their rank may be bounded by means of a cm - descent , and the new bounds on @xmath576 can thus be applied .",
    "[ lem : rankbound ] the rank of @xmath579 satisfies @xmath580 for some absolute constants @xmath581 .",
    "see , e.g. , @xcite , prop .  2 .",
    "[ thm : classbound ] let @xmath4 be a positive integer .",
    "suppose @xmath582 is a fundamental discriminant .",
    "then , for every @xmath131 , @xmath583 where @xmath584 is the unique real solution in the range @xmath585 to the equation @xmath586 numerically , @xmath587    let @xmath155 be an embedding of @xmath588 into @xmath589 .",
    "let @xmath590 be an ideal of @xmath591 .",
    "then @xmath592 is a lattice in @xmath589 of covolume @xmath593 .",
    "minkowski s theorem ( see @xcite ) shows that @xmath592 contains @xmath594 with @xmath595 , the implicit constant being absolute .",
    "this implies that @xmath590 contains an element @xmath28 of norm @xmath596 .",
    "then @xmath597 is an integral ideal in the same ideal class as @xmath598 but of norm @xmath599 .",
    "in particular , any @xmath0-torsion class in the ideal class group of @xmath588 has a representative @xmath590 that satisfies @xmath600 .",
    "since @xmath601 is principal , it follows that @xmath602 where @xmath603 .",
    "thus @xmath604 . since @xmath605 is an integer in @xmath588 , we know that @xmath606 and @xmath607 are integers .",
    "since @xmath600 , the @xmath0-torsion class represented by @xmath590 has given us a solution to @xmath608 conversely , any solution to ( [ eq : fred ] ) determines @xmath590 up to @xmath609 possibilities .",
    "we have therefore deduced that @xmath610 is at most a constant times @xmath611    the curve @xmath612 is a twist of @xmath613 , and the map @xmath614 gives an isomorphism @xmath615 over @xmath616 .",
    "thus the difference @xmath617 is bounded above by a constant for all @xmath618 ; on the other hand @xmath619 thus any point @xmath620 satisfying ( [ eq : fredsback ] ) has @xmath621 .",
    "let @xmath622 .",
    "lemma [ lem : rankbound ] shows that , for @xmath4 large enough and any @xmath623 , @xmath624 we apply cor .  [ cor : bound ] with @xmath625 and @xmath626 , obtaining @xmath627 for every @xmath131 .    by ( [ eq : fredsback ] ) and ( [ eqn : gergelyrules ] ) , we conclude that @xmath628 one has the _ a priori _ bound @xmath629 .",
    "we iterate ( [ eq : iter ] ) .",
    "apply scholz s reflection principle ( @xcite ) to obtain @xmath630 therefrom .",
    "[ cor : cor1 ] the number of cubic extensions of @xmath81 of discriminant @xmath4 is @xmath631 , where @xmath584 is as in thm .",
    "[ thm : classbound ] .",
    "this is an immediate consequence of thm.[thm : classbound ] ; see @xcite , satz 7 .",
    "the best previously known bound was the trivial one , namely that @xmath632 .",
    "the conditional results known to the authors are as follows .",
    "s. wong has shown ( @xcite ) that the birch - swinnerton - dyer conjecture , together with the riemann hypothesis for the @xmath94-functions of elliptic curves , implies that @xmath633 .",
    "let @xmath634 be the quadratic dirichlet character associated to @xmath588 .",
    "then the riemann hypothesis for @xmath635 alone implies @xmath636 .",
    "we sketch the proof communicated to us by soundararajan ; see also the remark at the end of @xcite .",
    "assume @xmath637 for simplicity .",
    "let @xmath638 be the galois automorphism of @xmath639 over @xmath81 . assuming the riemann hypothesis for @xmath640 one sees that there are @xmath641 primes @xmath31 with @xmath642 and @xmath643 ; equivalently , there are @xmath644 prime ideals @xmath645 of @xmath646 with @xmath647 and @xmath648 prime .",
    "if two such distinct ideals @xmath649 represented the same class in the quotient group @xmath650 $ ] , then @xmath651 would represent a @xmath0-torsion ideal class ; in particular , @xmath652 would be , as in the proof of thm .",
    "[ thm : classbound ] , an integer of the form @xmath653 .",
    "since @xmath654 , this forces @xmath655 , leading to a contradiction .",
    "this shows that @xmath656 ) \\gg_{\\epsilon } d^{1/6 - \\epsilon}$ ] , which gives @xmath657 )   \\ll_{\\epsilon } d^{1/3+\\epsilon}$ ] as desired .",
    "the following is well - known ; see , e.g. , @xcite , pf . of thm .  1 .",
    "[ lem : mylem ] let @xmath10 be a set of finite places of @xmath3 .",
    "there is a map from the set of all isomorphism classes of elliptic curves over @xmath3 with good reduction outside @xmath658 to the union @xmath659 of the sets of @xmath660-integer points on each of the curves @xmath661 where @xmath662 , @xmath663 .",
    "each fiber has size at most @xmath664 .",
    "see @xcite , p.  100 .",
    "[ thm : ecurve ] the number of elliptic curves over @xmath81 of conductor @xmath1 is @xmath665 for every @xmath131 , where @xmath666 , @xmath522 is as in thm .",
    "[ thm : astarte ] and @xmath584 is as in ( [ eqn : lambdadef ] ) ; numerically , @xmath667 .",
    "let @xmath668 , @xmath669 .",
    "in view of lemma [ lem : mylem ] , @xmath670 where the maximum is taken over all @xmath662 , @xmath663 .    by cor .",
    "[ cor : agobio ] , lem .",
    "[ lem : rankbound ] , and thm .",
    "[ thm : classbound ] we obtain : @xmath671    the above argument shows that , on any mordell curve @xmath672 , where @xmath4 is a rational integer , there are at most @xmath673 integer points .",
    "notice the improvement over cor .",
    "[ cor : newcoeur ] .",
    "we are using , of course , the fact that mordell curves have complex multiplication .",
    "the technique here is also applicable to counting rational points on curves of genus @xmath674 .",
    "this will be pursued in more detail in a separate paper ; here we content ourselves with indicating , in an approximate fashion , how one can use the method of this paper to bound the number of points on a curve of higher genus without knowing the rank of its jacobian .",
    "recall that heath - brown @xcite has shown that if @xmath359 is ( for example ) a plane irreducible curve of degree @xmath675 , then the number of points in @xmath676 of naive height @xmath677 is @xmath678 ; elkies independently proved a related bound @xcite with a view to algorithmic applications .",
    "the method of this paper , roughly speaking , recovers the exponent @xmath41 for curves of higher genus , provided that we may completely ignore the factors of @xmath679 that arise when dealing with weil height functions .",
    "when further simplifications are valid , the procedure delivers an exponent lower than @xmath41 .",
    "let @xmath359 be a proper smooth curve of genus @xmath674 over a number field @xmath12 . to further simplify matters , let us assume that @xmath359 has a @xmath12-rational point @xmath680 .",
    "the factors of @xmath679 that occur in the computations below depend both on @xmath359 and @xmath680 .",
    "let @xmath681 be a weil height with respect to the divisor @xmath682 , and suppose we are interested in bounds for the number of points @xmath683 with @xmath684 .",
    "note that here @xmath685 will denote a weil height `` over @xmath12 '' , not an absolute height normalized by a factor @xmath686}$ ] ( see the difference between ( [ eqn : htrel ] ) and ( [ eqn : htabs ] ) ) . for complete conformity with our previous notation we should denote it @xmath687 , but we shall suppress the @xmath12 subscript for typographical ease .",
    "let @xmath688 be the jacobian of @xmath359 .",
    "let @xmath689 be the embedding that sends @xmath690 to @xmath691 , and let @xmath692 be the associated theta - divisor , i.e. , @xmath693 , taken @xmath694 times .",
    "let @xmath695 be the diagonal , and @xmath696 an associated weil height .",
    "we denote by @xmath697 the inner product on @xmath698 induced by the canonical height associated to @xmath692 , which agrees up to @xmath679 with the weil height associated to the symmetric divisor @xmath699^ { * } \\theta ) \\in \\mathrm{pic}(c ) \\otimes_{{\\mathbb{z } } } { \\mathbb{r}}$ ] .",
    "@xcite , b.5 ; the map @xmath700 on @xmath698 is the map @xmath701 in the notation of @xcite , thm .",
    "b.5.6 . )",
    "we set @xmath702 for @xmath703 .",
    "note that for @xmath704 @xmath705 ( this follows from @xcite , thm .",
    "b.5.9 , since @xmath706 is algebraically equivalent to @xmath707 , cf .",
    "@xcite , thm .",
    "a.8.2.1 ) . by the proof of mumford s gap principle",
    "( see @xcite , thms .",
    "a.8.2.1 and b.6.5 ) , one has , for any @xmath708 , @xmath709    now suppose that @xmath710 are chosen so that @xmath711 .",
    "the theory of local heights ( @xcite ) shows that , if @xmath712 reduce to the same point modulo @xmath645 , any prime ideal of @xmath47 , then @xmath713 .",
    "indeed , the hypothesis guarantees that @xmath714 is @xmath645-adically close to the diagonal , which forces @xmath715 to be large .          for reasons outlined in the remark following proposition [ prop : kl ] ,",
    "the number of vectors in @xmath727 all of whose mutual angles satisfy @xmath728 is bounded by @xmath729 .",
    "it follows that the number of points @xmath683 of height @xmath684 that reduce to a fixed point in @xmath730 is @xmath729 ; in particular , the number of points @xmath683 of height @xmath684 is @xmath731 .    to recognize the exponent , note that if @xmath359 is a curve of degree @xmath675 in a projective space @xmath732 , then the naive ( exponential ) height @xmath733 on @xmath359 satisfies @xmath734 .",
    "thus , the number of points @xmath683 with @xmath735 is @xmath736 , recovering heath - brown s result .",
    "further , one can `` perturb '' this method by decreasing @xmath737 , as was carried out in the text for integral points on elliptic curves ; a small enough perturbation improves the exponent @xmath41 .",
    "this has been carried out in @xcite , which incorporates also some different ideas stemming from the work of heath - brown @xcite .",
    "hjhr baker , a. , the diophantine equation @xmath738 , _ j. lond . math .",
    "* 43 * ( 1968 ) , 19 .",
    "brindza , b. , evertse , j .- h . , and k. gyry , bounds for the solutions of some diophantine equations in terms of discriminants , _ j. austral . math .",
    "ser . a _ * 51 * ( 1991 ) , no",
    ". 1 , 826 .",
    "brumer , a. , and k. kramer , the rank of elliptic curves , _ duke math",
    ". j. _ * 44 * ( 1977 ) , 715743 .",
    "bombieri , e. , and j. pila , the number of integral points on arcs and ovals , _ duke math",
    ". j. _ * 59 * ( 1989 ) , no .",
    "2 , 337357 .",
    "brumer , a. , and j. h. silverman , the number of elliptic curves over @xmath3 with conductor @xmath1 , _ manuscripta math .",
    "_ * 91 * ( 1996 ) , no .",
    "1 , 95102 .",
    "bugeaud , y. , bounds for the solutions of superelliptic equations , _ comp .",
    "_ * 107 * ( 1997 ) , 187219 .",
    "conway , j. h. , and n. j. a. sloane , _ sphere packings , lattices and groups , _ _ grundlehren der mathematischen wissenschaften , 290 _ , springer ",
    "verlag , new york , 1988 .",
    "david , s. , points de petite hauteur sur les courbes elliptiques ,",
    "_ j. number theory _ * 64 * ( 1997 ) , no .",
    "1 , 104129 . duke , w. , bounds for arithmetic multiplicities , _ proceedings of the international congress of mathematicians , vol .",
    "ii ( berlin , 1998 ) _ , _ doc . math . _ * 1998 * , extra vol .",
    "ii , 163172 .",
    "duke , w. , and e.  kowalski , a problem of linnik for elliptic curves and mean - value estimates for automorphic representations ; with an appendix by dinakar ramakrishnan , _ invent .",
    "_ * 139 * ( 2000 ) , no .",
    "elkies , n.d . , rational points near curves and small @xmath739 via lattice reduction , _ algorithmic number theory _ , 3363 , _ lecture notes in computer science , 1838 _ , springer ",
    "verlag , berlin , 2000 .",
    "ellenberg , j. and a. venkatesh , on uniform bounds for rational points on non - rational curves .",
    "_ imrn _ * 35 * ( 2005 ) .",
    "evertse , j .- h . , and j. h. silverman , uniform bounds for the number of solutions to @xmath740 , _ math .",
    "cambridge philos .",
    "soc . _ * 100 * ( 1986 ) , no .",
    "2 , 237248 . fouvry ,  , sur le comportement en moyenne du rang des courbes @xmath741 , _ sminaire de thorie des nombres , paris , 199091 _ , _ progr .",
    "_ , 6184 , birkhuser boston , boston , ma , 1993 .",
    "gross , r. , and j. h. silverman , @xmath10-integer points on elliptic curves , _ pacific j. math .",
    "_ * 167 * ( 1995 ) , no .",
    "2 , 263288 .",
    "hajdu , l. , and t. herendi , explicit bounds for the solutions of elliptic equations with rational coefficients , _ j. symbolic comput . _",
    "* 25 * ( 1998 ) , no .",
    "3 , 361366 .",
    "hasse , h. , arithmetische theorie der kubischen zahlkrper auf klassenkrper  theoretischer grundlage , _ math . z. _ * 31 * ( 1930 ) 565582 .",
    "corrigendum : _ math .",
    "z. _ * 31 * ( 1930 ) 799 .",
    "heath - brown , r. , the density of rational points on curves and surfaces , _ ann . of math .",
    "( 2 ) _ * 155 * ( 2002 ) , no .",
    "2 , 553595 . helfgott , h. a. , on the square - free sieve , _ acta arith .",
    "_ * 115 * ( 2004 ) , no .",
    "4 , 349402 . herrmann , e. , _ bestimmung aller",
    "@xmath10-ganzen lsungen auf elliptischen kurven , _ ph.d .",
    "thesis , universitt des saarlandes .",
    "hindry , m. , and j.  h. silverman , _ diophantine geometry _",
    ", springer ",
    "verlag , new york , 2000 .",
    "kabatjanskii , g. a. , and v. i. levenshtein , bounds for packings on the sphere and in space , _ problemy peredai informacii _ * 14 * ( 1978 ) , no .",
    "kotov , s. v. , and l. a. trelina , @xmath10-ganze punkte auf elliptischen kurven , _ j. reine angew .",
    "math . _ * 306 * ( 1979 ) , 2841 .",
    "lang , s. , _ elliptic curves : diophantine analysis _ , springer ",
    "verlag , 1978 .",
    "levenshtein , v. i. , universal bounds for codes and designs , _ handbook of coding theory _ , north - holland , amsterdam , vol i. , 499648 . mazur , b. , rational points of abelian varieties with values in towers of number fields , _ invent .",
    "_ * 18 * ( 1972 ) , 183266 .",
    "merel , l. , bornes pour la torsion des courbes elliptiques sur les corps de nombres , _ invent .",
    "_ * 124 * ( 1996 ) , no . 13 , 437449 .",
    "mumford , d. , a remark on mordell s conjecture , _ amer .",
    "_ * 87 * ( 1965 ) , 10071016 .",
    "murty , m. r. , exponents of class groups of quadratic fields , _ topics in number theory _ , 229239 , kluwer academic , dordrecht , 1997 .",
    "nekov , j. , class numbers of quadratic fields and shimura s correspondence , _ math .",
    "* 287 * ( 1990 ) , no .",
    "4 , 577594 .",
    "pierce , l. b. , the 3-part of class numbers of quadratic fields , _ j. london math .",
    "( 2 ) _ * 71 * ( 2005 ) , no .  3 , 579598 .",
    "pintr , a. , on the magnitude of integer points on elliptic curves , _ bull .",
    "* 52 * ( 1995 ) , no .",
    "2 , 195199 . schmidt , w. , integer points on curves of genus @xmath83 , _ compositio math . _",
    "* 81 * ( 1992 ) , 3359 .",
    "scholz , a. , ber die beziehung der klassenzahlen quadratischer krper zueinander , _ j. reine angew",
    "_ * 166 * ( 1932 ) , 201203 .",
    "serre , j .-",
    ", _ lectures on the mordell - weil theorem _ , 3rd ed . , vieweg , braunschweig , 1997 .",
    "serre , j .-",
    ", _ local fields _ , springer ",
    "verlag , new york ",
    "berlin , 1979 .",
    "shintani , t. , on dirichlet series whose coefficients are class numbers of integral binary cubic forms , _ j. math .",
    "* 24 * ( 1972 ) , 132188 .",
    "siegel , c. l. , _ lectures on the geometry of numbers _",
    ", notes by b. friedman , rewritten by k. chandrasekharan with the assistance of r. suter , springer ",
    "verlag , berlin , 1989 .",
    "silverman , j. h. , _ advanced topics in the arithmetic of elliptic curves _",
    ", springer - verlag , new york , 1994 .",
    "silverman , j. h. , _ the arithmetic of elliptic curves _",
    ", springer ",
    "verlag , new york , 1985 .",
    "silverman , j. h. , the difference between the weil height and the canonical height on elliptic curves , _ math .",
    "_ * 55 * ( 1990 ) , 723743 .",
    "silverman , j. h. , lower bound for the canonical height on elliptic curves , _ duke math . j. _ * 48 * ( 1981 ) , no .",
    "3 , 633648 .    silverman , j. h. , lower bounds for height functions , _ duke math .",
    "j. _ * 51 * ( 1984 ) , no .  2 , 395403 .",
    "silverman , j. h. , a quantitative version of siegel s theorem : integral points on elliptic curves and catalan curves , _ j. reine angew .",
    "* 378 * ( 1987 ) , 60100 .",
    "soundararajan , k. , divisibility of class numbers of imaginary quadratic fields , _ j. london math . soc .",
    "( 2 ) _ * 61 * ( 2000 ) , no .",
    "3 , 681690 . wong , s. , automorphic forms on @xmath742 and the rank of class groups ,",
    "_ j. reine angew .",
    "_ * 515 * ( 1999 ) , 125153 .",
    "wong , s. , on the rank of ideal class groups , _ number theory ( ottawa , on , 1996 ) _ , 377 - 383 , _",
    "lecture notes , 19 _ , amer .",
    "soc . , providence , ri , 1999 ."
  ],
  "abstract_text": [
    "<S> we give new bounds for the number of integral points on elliptic curves . </S>",
    "<S> the method may be said to interpolate between approaches via diophantine techniques ( @xcite , @xcite ) and methods based on quasiorthogonality in the mordell - weil lattice ( @xcite , @xcite , @xcite ) . </S>",
    "<S> we apply our results to break previous bounds on the number of elliptic curves of given conductor and the size of the @xmath0-torsion part of the class group of a quadratic field . </S>",
    "<S> the same ideas can be used to count rational points on curves of higher genus . </S>"
  ]
}