{
  "article_text": [
    "in the last 15 years , the development of parallel massively sequencing platforms for mapping the genome has completely revolutionized the way of studying gene expression patterns .",
    "these recent technologies called next generation sequencing ( ngs ) allow to simultaneously investigate thousands of features within a single reliable and cost - effective experiment , thus representing a valid alternative to microarray experiments in enhancing our understanding of how genetic differences affect health and disease @xcite .",
    "indeed , these innovative platforms have been quickly applied to many genomic contexts giving rise to a large amount of available data in complex form .",
    "data coming from such experiments are highly structured and their analysis has raised an imperative need for specific methodologies : technical or biological replicates can be observed in several experimental conditions @xcite , and the single observational units , such as genes or exons , are very likely characterized by spatial dependencies and relationships @xcite .",
    "moreover , the abundance of a particular transcript is measured as a count and so the single data point is a discrete measurement .",
    "we consider in this paper the chromatin immunoprecipitation and sequencing ( chip - seq ) data on proteins p300 and cbp analysed by @xcite . in this experiment ,",
    "two technical replicates are observed after 30 minutes from the initial interaction of the proteins with the human genome , with the aim of discovering the binding profile of these transcription factors .",
    "figure [ plot_zoom ] displays summarized counts for 1000 base pairs contiguous windows along chromosome 21 .",
    "the plot shows segments with high read counts and segments where there is a uniformly low level of signal , thus suggesting a potential spatial effect .    ,",
    "width=585 ]    in chip - seq data like the one investigated ( see @xcite for a review ) , researchers usually associate the counts to two specific components : a background level , which accounts for the noise in the process and the inactivity of the regions with respect to protein binding ; a signal level , that is described by a higher counts of sequenced dna fragments , indicating that the protein is actually interacting with those specific genomic regions . from a statistical point of view",
    ", the problem of the detection of such biological processes can be addressed by introducing a mixture model with the aim of identifying groups of genomic regions that exhibit similar expression patterns .",
    "typically , conventional model - based clustering methods perform classification of units into mutually exclusive partitions",
    ". however , looking at figure [ plot_zoom ] , it could be interesting to uncover components that may arise from the multiple overlapping action of the main aforementioned group processes .",
    "multiple partitions can be obtained in ( at least ) two ways : ( a ) by fuzzy or ` soft ' clustering that is the assignment of a unit to the group with some posterior probabilities ( see , for instance , * ? ? ?",
    "* ; * ? ? ?",
    "* ) or ( b ) by accounting for multiple allocations directly within a generative model .",
    "our proposal employs this second perspective that explicitly assumes that genomic units are fully co - actors of multiple processes in a model based framework .",
    "the idea stems from earlier contributions aimed at discovering multiple clusters .",
    "@xcite introduced a probabilistic - based method to discover overlapping cellular processes and the associated gene regulation scheme .",
    "given the complexity of a cellular system , they propose a decomposition of the observed continuous data matrix into layers representing biological processes and groups of co - regulated genes , allowing every unit to express itself in more than one activity layer and belong to multiple clusters . in @xcite and @xcite , the problem of multiple allocation",
    "is solved within a model based clustering strategy , where the distribution of the groups is extended generalizing the gaussian probability distribution used in @xcite to the case of exponential family distributions .",
    "the main idea of such approach known as ` model - based overlapping clustering ' is to re - parameterize the density of the overlapped clusters as the product of some primary densities that , being members of the exponential family , still result in the same parametric family .",
    "@xcite extended these models by employing a nonparametric bayesian technique to infer the number of groups in their overlapping clusters model , while maintaining the characterization of the mixture densities as members of the exponential family .",
    "more recently , @xcite proposed the ` epistatic model based clustering ' for the analysis of microarray data . in this approach ,",
    "a more explicit description of the mixed component densities in terms of gaussians is given ; different interactions between the parameters of the primary groups are investigated but the order of the interactions between these original clusters and the overlapped counterparts is practically limited to the second order .    the aim of this work is to define a general multiple allocation mixture ( mam ) model for analyzing the chip - seq data .",
    "the peculiar features of these experimental data demand for specific treatment .",
    "first , their discrete nature and a marked overdispersion require a flexible count distribution such as the negative binomial , that however does not generally belong to the exponential family , unless its dispersion parameter is known and fixed . to this aim",
    "we generalize the model - based overlapping clustering to arbitrary parametric probabilistic functions .",
    "in addition , as shown in figure [ plot_zoom ] , chip - seq data are characterized by the inflation of non - structural zeros .",
    "these aspects are naturally taken into account by the proposed model , where each component of the multiple mixture corresponds to a primary or to an overlapping cluster distributed as negative binomials with parameters that are function of the primary parameters only .",
    "a further important aspect that emerges from figure [ plot_zoom ] is that the protein interactions with dna are spatially correlated .",
    "we will show that the model can be easily extended in order to account for the spatial linkage among the genes , via a conditional auto - regressive ( car ) process .    in what follows , we will present our proposal in three gradual steps in order to sequentially address these issues .",
    "first , in section 2 , the general mam model will be presented and then we will adapt the model to the ngs data .",
    "we will illustrate how to extend this approach in order to model spatial dependent observations . in section 3 , a simulation study aimed at investigating the flexibility and effectiveness of the proposal is presented .",
    "furthermore , we use the newly developed model to study the genome wide binding of the protein p300 in order to investigate its transcriptional regulatory function . in section 4 , conclusions are discussed .",
    "finite mixture models have been receiving a wide interest in the statistical literature as a tool for performing model based clustering and density estimation ( see * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "let @xmath0 ( @xmath1 ) be an observed vector of values that we want to classify in some unknown groups .",
    "the conventional model based clustering model assumes @xmath2 where @xmath3 are the component densities with parameters @xmath4 and @xmath5 are the prior probabilities to belong to each component , satisfying @xmath6 and @xmath7 . according to this model",
    ", a sample of @xmath8 observations arises from some underlying populations of unknown proportions and the purpose is to decompose the sample into its mixture components , where each component corresponds to a cluster . in doing so , the data are partitioned into mutually exclusive @xmath9 groups .",
    "this is achieved by introducing a latent variable , say @xmath10 , which allocate each observation @xmath11 to the component @xmath12 .",
    "more precisely , @xmath13 is a vector of length @xmath9 that takes the value 1 in correspondence of the cluster assignment , and 0 elsewhere , so that @xmath14 . according to the maximum a posteriori probability ( map ) rule , the partition",
    "is then obtained by assigning subjects to their most likely class according to the posterior probabilities of @xmath15 given the data : @xmath16 in this sense the classification produced by a mixture model is ` hard ' ( because a unit is allocated to the mixture component with the maximum posterior probability of belonging to ) but in principles it could be ` soft ' by assigning each cluster a weight that equals its posterior probability as in the partial membership model @xcite . however",
    ", a soft assignment perspective does not mitigate the limitation of the model based classification , that results when data points may simultaneously belong to multiple clusters .",
    "in such situations , a change in the generative model is required , by explicitly assuming that the allocation vector @xmath13 may contain several - and not just a single - ones .      in order to construct a new generative model for multiple components ,",
    "we define @xmath9 in eq .",
    "( [ mod1 ] ) as the number of primary groups which are not mutually exclusive .",
    "for such a reason , we assume the prior probabilities of each primary group satisfying the constraint @xmath6 but not necessarily summing up to one , @xmath17 .    the total number of possible single and multiple allocation clusters is @xmath18 and @xmath19 is the multiplicity of the cluster membership for the unit @xmath11th .",
    "when @xmath20 we have a single group allocation , otherwise we have multiple group allocations .",
    "more precisely , if @xmath21 the unit @xmath11th belongs to two groups simultaneously .",
    "these two groups altogether may be thought of as a new _ secondary _ group . if @xmath22 the unit belongs to three groups that jointly define a _ tertiary _ group and so forth .",
    "when @xmath23 , the unit is assigned to what we call a ` outward cluster ' : this group collects observations that ideally do not belong to any clusters , and for this reason their distribution might be described by peculiar parameters depending on the empirical context .",
    "for instance , in many applications it could represent a group of outliers or noisy observations , characterized by high variance .",
    "the definition and existence of the ` outward cluster ' is particularly relevant for the analysis of chip - seq data , where the clusters are interpretable as biological processes .",
    "a gene that does not take part to any biological processes will have extremely low values ( close to zero or zero ) .",
    "thus , the outward cluster has the purpose to describe the group of ` inactive genes ' and , in so doing , it acts as a zero - inflation adjustment for the model .    for @xmath9 fixed",
    ", let @xmath24 be a connection matrix of dimension @xmath25 , with elements @xmath26 , containing all the possible assignment configurations .",
    "for instance , for @xmath27 : @xmath28 in this case we define the prior probability to belong to a general ( single or multiple allocation ) group @xmath29 with @xmath30 .",
    "notice that these weights are constructed so that @xmath31 , and the definition comes naturally from the representation of clusters as sets in a sample space .",
    "the multiple allocation mixture model ( mam ) can be defined as a reparameterization of eq .",
    "[ mod1 ] in the new formulation @xmath32 where @xmath33 is a location parameter and @xmath34 is a nuisance parameter .",
    "more specifically , @xmath33 is a function that depends on @xmath35 , which is the @xmath36-th row of @xmath24 , and transforms the primary parameters @xmath37 into the parameters of the multiple allocation components according to several possible schemes :    * _ additive model _ : the parameters of the mixed groups could be the sum of the original parameters , that is @xmath38 } } , \\ ] ] where in the second term the indicator function is introduced to account for the parameters of the outward mixture component ; * _ co - dominance of order 1 _ : @xmath39 } } ; \\ ] ] * _ co - dominance of order 0 _ : @xmath40 } } .\\ ] ]    we will focus on the additive scheme through the rest of the manuscript . finally , the nuisance parameters @xmath34 are taken h - specific because we aim to add more flexibility to the mixture model .",
    "suppose we observe the chip - seq counts of @xmath8 genes in @xmath41 biological conditions or replicates .",
    "we denote @xmath42 the random variable that expresses the read counts , say @xmath43 , mapped to gene @xmath11 ( @xmath11=@xmath44 ) , in sample @xmath45 with @xmath46 .",
    "let @xmath47 be the random vector of length @xmath41 denoting the expression profile of a gene .",
    "let @xmath0 be the observed value .",
    "we assume that @xmath42 is distributed according to the negative binomial ( @xmath48 ) distribution , given both the discrete nature of the observations and the flexibility of having a specific parameter used to model the overdispersion , which makes this distribution preferable over the poisson .",
    "we further assume that , conditional on the group , the replicates are independent draws so that the mixture model in eq .",
    "[ mod2 ] becomes : @xmath49 where @xmath50 are specific dispersion parameters of the negative binomials and @xmath51 are the means defined in the extended space of multiple components .",
    "we allow dispersion parameters @xmath52 to vary for each of the @xmath53 possible assignment and replicates because it is not directly clear a priori what is the most reasonable variance structure to define through a function for the multiple allocation clusters .",
    "this allows , nevertheless , for a certain degree of flexibility in describing the context - specific variability in the data .    with reference to the means",
    "@xmath54 they are modelled as function of primary @xmath9 means through the combination scheme @xmath55 .",
    "more specifically , with reference to the connection matrix @xmath24 in eq . [ con.mat ] , @xmath56 is the mean parameter in condition @xmath45 of the outward distribution ; @xmath57 is the mean parameter of the units that belong to the first primary group only and not to mixed groups , and so on , till @xmath58 that is the mean of the units that belong simultaneously to the three components under condition @xmath45 . given the nature of the data we consider the ` outward ' group as the component devoted to describe the inactive genes and for this reason we fix its mean to a very low value , such as @xmath59 .",
    "the other mean parameters are obtained as combination scheme through @xmath55 of @xmath9 primary values that represent the means of the units that belong to the primary groups or related multiple groups . in order to construct an hierarchical form of the model , we define with @xmath60 the allocation matrix in the augmented space given by @xmath53 as a @xmath61 ` multinomial ' matrix .",
    "while each row of @xmath62 can have multiple ones according to the assignment of the unit to multiple clusters , the rows of @xmath60 only have a single one and the matrix @xmath24 allows for a connection between original parametrization allocation and the re - parametrized version . given the whole set of parameters , say @xmath63 , the joint complete likelihood of our model is the following : @xmath64 inference is carried out within a bayesian framework .",
    "the posterior distribution of the parameters and the latent variables is : @xmath65 with @xmath66 specifies priors for the mixture parameters and @xmath67 as the vector containing the hyper - parameters .",
    "the posterior in eq .",
    "[ postdens ] can then be rewritten as : @xmath68^{\\phi_{hd } } \\left [ \\frac{\\psi(\\boldsymbol{u}_h , \\boldsymbol{\\mu}_d)}{\\phi_{hd}+\\psi(\\boldsymbol{u}_h , \\boldsymbol{\\mu}_d ) } \\right]^{y_{jd } } \\right\\}^{z^*_{jh } } \\times \\\\ & \\times \\prod_{j=1}^{p } \\prod_{h=1}^{k^ * } \\left ( \\prod_{i=1}^k\\pi_i^{u_{hi } } ( 1-\\pi_i)^{1-u_{hi } } \\right)^{z^*_{jh } }    p(\\boldsymbol{\\pi } | \\boldsymbol{\\xi } ) p(\\boldsymbol{\\mu } | \\boldsymbol{\\xi } ) p(\\boldsymbol{\\phi } | \\boldsymbol{\\xi}),\\end{aligned}\\ ] ] where @xmath69 and @xmath70 are prior distributions for these quantities .",
    "as prior distribution for the weights we assume a beta distribution so that we get the following hierarchical structure : @xmath71 for the other two parameters we select conjugate and flat priors .",
    "more precisely , for every @xmath12 and @xmath36 , @xmath72 and @xmath73 , where @xmath74 are elements of the vector @xmath67 of hyperparameters . given these chosen priors , full conditionals can be derived and a gibbs sampling mcmc algorithm applied to estimate the parameters . at the implementation step of the algorithm we exploit the gamma - poisson mixture representation of a negative binomial distribution . we introduce a further latent variabile @xmath75 , specific to each unit @xmath11 in each replicate / condition @xmath45 , that has a gamma density with shape and rate parameters equal to @xmath52 .",
    "it follows that : @xmath76 which allows us to use a gibbs sampler for the mean parameters @xmath77 .      the units / observations ( in our case , genes or genomic locations ) are not independent but spatially correlated .",
    "we introduce the spatial correlation by allowing the primary weights @xmath78 to be @xmath11-varying and we denote them as @xmath79 . the spatial relationship is taken into account by allowing the weights of the mixture in eq .",
    "[ mod2 ] to vary from one gene to another . the way we formulate it is inspired by the work proposed by @xcite .",
    "they first introduced @xmath9 independent @xmath8-dimensional latent variables with a markov random - field distribution .",
    "the weights are then a non - linear function of these latent variables and spatial relationships are expressed in terms of neighborhood relationships",
    ". this could be restrictive because the correlation between two genes should decrease as their distance increases .",
    "we extend the approach by considering a gaussian conditional auto - regressive model @xcite , where the distances are directly used to model correlations instead of dummies denoting the neighborhood condition . in a bayesian framework , this is accomplished by introducing additional layers to the hierarchy formulation shown in eq .",
    "[ hier ] , with their own set of hyper - parameters .",
    "with reference to @xmath80 , we introduce the spatial latent vectors , denoted by @xmath81 , with @xmath82 : each @xmath83 is a gaussian conditional autoregressive model given by @xmath84 where @xmath85 is a precision matrix of order @xmath8 and @xmath86 is some non - linear function of @xmath87 , which are the distances between all the units . more specifically ,",
    "@xmath88 after some algebraic steps it is possible to show that eq .",
    "[ eqn : car ] is equivalent to @xmath89 \\right\\}\\end{aligned}\\ ] ] with @xmath90 the normalization constant @xmath91 in the previous expression , @xmath92 s denote the eigenvalues of the spatial matrix @xmath93 .",
    "given @xmath94 , the weights for location @xmath11 can be obtained via logistic formulation @xmath95 where @xmath96 is a ` shrink - or - stretch ' tuning parameter to be estimated that provides a way to exaggerate the differences in units allocation among the clusters .      in order to account for spatial correlation between the units / observations ( in our case , genes or genetic locations ) , we introduce another layer in the hierarchical structure of the model . starting from eq .",
    "[ jcl ] , the updated joint complete likelihood is : @xmath97 leading to the following posterior distribution @xmath98 where the vector @xmath67 now also contains the hyper - parameters for the new latent layer and @xmath99 is defined as in eq .",
    "( [ postnegbin ] ) .",
    "more precisely , the complete latent structure in eq . [ postcar ] is equal to : @xmath100^{z_{jh}^ * }   \\times \\\\ \\times & \\prod_{i=1}^k c\\exp \\left\\ { -\\frac{1}{2 } \\left [   \\sum_{j=1}^{p } \\sum_{j'=1}^{p } \\gamma_{jj ' } ( x_{ij}-x_{ij'})^2 + \\sum_{j=1}^{p } x_{ij}^2 \\right ] \\right\\}\\end{aligned}\\ ] ] where @xmath90 is the constant defined in eq .",
    "[ eqn : carbis ] .",
    "as proposed in @xcite , we integrate out the latent allocation variable @xmath62 when implementing the metropolis sampler for @xmath101 in order to employ the information carried by the data @xmath102 and bring the two layers of the hierarchical structure of the model closer together .",
    "we assess the performance of our model ( _ mam _ ) under different scenarios and we compare it with a classical non - overlapping components mixture ( _ negbinmix _ ) .",
    "data are generated from two independent negative binomial distributions ( @xmath103 ) and @xmath104 units , allowing for overlapping clusters with a number of groups @xmath105 : in the augmented @xmath53 space this equals to represent a situation , as in a classical model - based clustering framework , where the actual number of groups ranges from @xmath106 to @xmath107 .",
    "we explore three degrees of clustering between primary and outward / non - primary groups by selecting three scenarios which we call low , medium and high activation : this is achieved by setting all the @xmath108 equal to - respectively - @xmath109 , @xmath110 and @xmath111 .",
    "we run both algorithms ( _ mam _ and _ negbinmix _ ) for 10000 mcmc iterations and a 5000 burn - in window is selected . for every @xmath112 ,",
    "we choose hyperparameters of the gamma prior distributions equal to @xmath113 and @xmath114 ; for every dispersion parameter @xmath52 , we select the ranges of the prior uniform distributions to be @xmath115 $ ] . convergence is checked for every chain and we assign to the clusters according to the maximum a posteriori rule : we compute the posterior probabilities of the allocation vectors @xmath116 given the data and , for every unit , we allocate to the component with the highest probability value ( see also section [ model_based ] ) .",
    "we choose as an overall performance indicator the misclassification error rate ( see table [ tabnegbinmix ] ) , that is , the average number of units not correctly allocated when compared to the known true membership .",
    "the posterior means for the parameters in the selected models ( both the overlapping and non - overlapping mixtures ) are consistent with the true values and do not show any substantial bias ."
  ],
  "abstract_text": [
    "<S> model - based clustering is a technique widely used to group a collection of units into mutually exclusive groups . </S>",
    "<S> there are , however , situations in which an observation could in principle belong to more than one cluster . in the context of next - generation sequencing ( ngs ) experiments , for example , the signal observed in the data might be produced by two ( or more ) different biological processes operating together and a gene could participate in both ( or all ) of them . </S>",
    "<S> we propose a novel approach to cluster ngs discrete data , coming from a chip - seq experiment , with a mixture model , allowing each unit to belong potentially to more than one group : these multiple allocation clusters can be flexibly defined via a function combining the features of the original groups without introducing new parameters . </S>",
    "<S> the formulation naturally gives rise to a ` zero - inflation group ' in which values close to zero can be allocated , acting as a correction for the abundance of zeros that manifest in this type of data . </S>",
    "<S> we take into account the spatial dependency between observations , which is described through a latent conditional auto - regressive process that can reflect different dependency patterns . </S>",
    "<S> we assess the performance of our model within a simulation environment and then we apply it to chip - seq real data . </S>",
    "<S> + _ keywords : _ heterogeneity ; model - based clustering ; spatial dependency ; multiple allocations . </S>"
  ]
}