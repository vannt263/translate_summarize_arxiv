{
  "article_text": [
    "samples of phylogenetic trees arise in many different contexts in phylogenetics : examples include bayesian posterior samples , bootstrap samples and collections of trees from different genetic loci .",
    "understanding and summarizing the information present in these samples is challenging due to the difficulty of representing and visualizing regions of the space of possible trees .",
    "consensus trees are typically used to summarize samples .",
    "these represent the features on which trees in the sample tend to agree , and each edge is usually labelled with the proportion of trees in the sample containing that edge .",
    "many different consensus methods have been proposed , differing in the particular features considered and the way conflicts between trees are resolved @xcite .",
    "for example , the adams consensus tree @xcite is constructed using the relationship between every triplet of leaves represented in a sample of rooted trees , and it does not take branch lengths on the trees into account . alternatively , the average consensus tree @xcite is defined using the matrix of path length distances between pairs of leaves on each tree , and it therefore depends on branch lengths . by definition ,",
    "consensus trees only reflect limited aspects of the input sample .",
    "specifically , they do not indicate alternative tree topologies ; they can not capture correlations between different features ; and many do not incorporate information about variability in branch lengths .",
    "consensus networks @xcite were developed to address the first of these issues .",
    "they represent conflicting phylogenetic signals from different trees in a single network structure .",
    "standard tools from multivariate data analysis , such as clustering @xcite and multidimensional scaling @xcite have also been adapted and applied to samples of trees as a means of representing information in the samples more accessibly .",
    "this paper presents a complementary approach which is analogous to a form of principal components analysis ( pca ) adapted to the geometry of the space of phylogenetic trees .",
    "given a sample of different phylogenies sharing the same set of taxa , we construct a principal geodesic , or line , in treespace which is a ` best fit ' to the data in a well - defined sense .",
    "the principal geodesic can be thought of as a @xmath0-parameter continuous family of trees which summarizes the sample , as opposed to the point summary provided by a consensus tree . in common with consensus network methods ,",
    "the principal geodesic can represent a collection of alternative tree topologies , depending on the input sample . by analogy with the first principal component in standard pca",
    ", the principal geodesic represents the most variable features of the sample , in terms of both topology and branch length . as for standard pca , a ` proportion of variance '",
    "summary statistic can be computed for each principal geodesic .",
    "this measures the amount of variability captured by the principal geodesic in relation to the degree of scatter around the geodesic , and therefore indicates how well the principal geodesic summarizes the sample .",
    "our approach relies heavily on geometrical properties of the space of phylogenetic trees .",
    "the space of all possible phylogenetic trees on a fixed set of taxa forms a geometric space which we refer to as _ treespace _",
    "the space is equipped with a metric , usually called the _ geodesic metric _ , and any pair of points can be joined by a unique _ geodesic",
    "_ i.e.  a path of minimal length .",
    "a variety of other metrics exist for measuring differences between phylogenetic trees .",
    "however , the geodesic metric and the picture of treespace provided by billera et al @xcite provide the geometry necessary to perform an analog of pca : namely , a notion of a straight line and a well - defined projection operation onto any given line .",
    "other metrics do not provide these geometrical elements .",
    "a sample of trees can be regarded as being drawn from some distribution on treespace , and our approach attempts to characterize this distribution by approximating the sample with a principal geodesic .",
    "an important feature of the approach is that it uses branch length information as well as topological information from the input sample of trees , since information about the shape of the distribution in treespace would be lost by marginalising out the branch lengths .",
    "for example , if most of the sampled trees had the same topology , then variability in the sample would largely be comprised of variability in the branch lengths for that topology .",
    "our approach can characterise the variability equally well in this situation , or conversely for samples which are widely dispersed over different topologies , and it therefore offers a unified approach independent of the nature of the sample .",
    "branch lengths and tree topology are intimately related since ( i ) tree topology can be changed by continuously shrinking edges to length zero and expanding out alternative edges , and ( ii ) the relative branch lengths in a species tree affect the inferred topology in various ways when constructing a phylogeny from genetic data .",
    "for example , short internal edges can be harder to infer and so lead to alternative topologies .",
    "although biologists are often primarily concerned with the different tree topologies represented within a sample , incorporating branch lengths leads to a more complete picture .",
    "although normally applied to data in vector spaces , pca can be adapted to work in other geometrical spaces .",
    "most importantly , pca has been reformulated in terms of geodesic geometry on riemannian manifolds @xcite including lie groups and shape spaces @xcite .",
    "these ideas have also been extended to certain spaces of trees @xcite .",
    "our algorithm is based on the same type of reformulation , and the first step is to re - express standard pca in terms of the following schema .",
    "suppose @xmath1 is a set of points in a vector space equipped with an inner product and induced metric @xmath2 .",
    "the zero - th order principal component can be defined as the point @xmath3 which minimizes the sum of squared distances @xmath4 .",
    "similarly , the first order principal component @xmath5 is the line which minimizes @xmath6 where @xmath7 denotes projection onto @xmath5 .",
    "this definition extends to the @xmath8-th order principal component @xmath9 which is the @xmath8-dimensional subspace which minimizes the sum of squared projected distances @xmath10 where @xmath11 is projection onto @xmath9 .",
    "algebraic solutions can be obtained for these minimization problems for pca in vector spaces . in particular",
    "@xmath3 is just the sample mean @xmath12 , and @xmath5 is the line through @xmath12 spanned by the eigenvector of the sample covariance matrix with largest eigenvalue .",
    "this schema for constructing @xmath3 and @xmath5 applies exactly as stated above to more general metric spaces equipped with some notion of lines and projection onto lines , such as treespace . in terms of treespace geometry",
    ", @xmath13 is a sample of trees , @xmath5 is a geodesic in treespace and @xmath2 is the geodesic metric . however , in the more general setting , algebraic solutions are not available and @xmath3 is not generally a subspace of @xmath5 @xcite",
    ". this can be demonstrated by simple examples in treespace . in the context of general metric spaces ,",
    "the zero - th order principal component @xmath3 is more commonly known as the _ frchet mean _ , and a stochastic algorithm for computing the frchet mean in treespace has recently been developed @xcite based on previous work in more general metric spaces @xcite . in this paper",
    "we present a stochastic algorithm for constructing @xmath5 in treespace , or more precisely , a geodesic which minimises the sum of squared distances between points in the sample and their projections onto the geodesic .",
    "the algorithm searches through the set of geodesics for a optimal fit to the data , though convergence to local minima is possible .",
    "we call the algorithm _ geophytter_.    the present author has previously published an algorithm called @xmath14pca for constructing the first principal component in treespace @xcite , and the methods presented here form an updated approach to the same problem , overcoming a number of limitations of the original algorithm .",
    "most importantly , @xmath14pca only considers geodesics which lie in a restricted class with simple geometrical properties as candidates for @xmath5 .",
    "the algorithm fails to construct the optimal geodesic for certain data sets on account of this restriction , and in some cases @xmath14pca fails to produce any output at all , such when all the input trees have the same topology .",
    "later in the paper we give examples of biological data sets on which @xmath14pca does not identify an optimal principal geodesic , and give a more thorough technical explanation of the improvements geophytter represents .",
    "other authors @xcite have more recently also described an algorithm for constructing an approximate principal geodesic in treespace , for which the geodesic is constrained to lie between points in the data set .",
    "we apply this algorithm to experimental data sets later in the paper to compare with results obtained using geophytter .",
    "the remainder of the paper has the following structure . after reviewing the geometry of phylogenetic treespace , we then present the stochastic algorithm for constructing principal geodesics .",
    "detailed results are given for two data sets : ( i ) a sample of gene trees for a set of archaea for which gene conversion has affected certain loci and ( ii ) a simulated bootstrap sample of trees affected by long branch attraction .",
    "these illustrate potential biological applications of principal geodesic analysis in treespace .",
    "we also give very brief results for some other data sets to indicate the type of characterization of tree samples that the analysis can provide .",
    "finally , we conclude with a discussion of computational issues and possibilities for further research .",
    "we need to describe the geometry of phylogenetic treespace in order to specify our algorithm fully .",
    "more details about the structure and geometry of treespace are given by billera et al @xcite , and the account presented here is brief .",
    "a phylogenetic tree represents the evolutionary relationships between a set of objects , called _ taxa _ , which label the leaves of the tree .",
    "treespace @xmath15 is the set of all unrooted trees on the set of taxa @xmath16 .",
    "the trees have positive - valued edge weights or _",
    "branch lengths_. sometimes it is convenient to ignore the branch lengths on a tree , in which case we obtain the tree _",
    "topology_. topologies are referred to as _ resolved _",
    "if all the vertices apart from the leaves have degree @xmath17 , but are otherwise called _ unresolved_. a _ split _ is a bipartition of @xmath18 , and every edge in an unrooted tree is associated with the split of taxa induced by cutting the edge .",
    "splits are often written in the notation @xmath19 where @xmath20 is a disjoint union of @xmath18 .",
    "although we work throughout with unrooted trees , the space of rooted trees can be obtained by adding in an additional taxon representing the ancestor of all the taxa in @xmath18 , and so the space of rooted trees is essentially isomorphic to @xmath21 . each tree in @xmath15 contains up to @xmath22 internal edges and exactly @xmath23 _ pendant _ edges , i.e.  those which contain a leaf .",
    "treespace consists of different regions , each corresponding to the set of trees with a particular fully - resolved topology .",
    "if we consider a single fully - resolved tree topology @xmath24 , and ignore the lengths of the pendant edges , then by associating each internal edge with a coordinate axis in @xmath25 there is a bijection between the set of trees with topology @xmath24 and the interior of the _ positive orthant _",
    "@xmath26 where @xmath27 .",
    "the faces of @xmath28 correspond to unresolved trees . continuing to ignore pendant edge lengths",
    ", it follows that as a set , @xmath15 corresponds to @xmath29 , where the union is over all possible fully - resolved tree topologies .",
    "the orthants corresponding to different topologies overlap along their faces in the following way .",
    "the codimension-@xmath0 faces of each orthant correspond to trees in which a single internal edge has contracted to length zero , resulting in a vertex with degree @xmath30 . such a vertex can be resolved in three different ways leading to two new topologies @xmath31 as well as the original @xmath24 .",
    "it follows that each codimension-@xmath0 face of @xmath28 is identified with corresponding faces in @xmath32 and @xmath33 .",
    "the topological operation corresponding to shrinking down an edge and replacing it with one of its two alternatives is referred to as _",
    "nearest neighbor interchange _ ( nni ) and",
    "adjacent regions in @xmath15 contain trees related by nni .",
    "higher codimension faces similarly form the intersection of multiple orthants , and the origin of tree space , corresponding to a tree with no internal edges ( or _ star - tree _ ) , is the unique point in the intersection of all the orthants .",
    "adding back in the pendant edges , @xmath15 is the product @xmath34 where each point in @xmath35 determines a set of pendant edge - lengths .",
    "insight into the structure of treespace can be gained by considering low - dimensional examples . for @xmath36 taxa",
    ", there are @xmath17 possible unrooted tree topologies , so ( ignoring pendant edges for simplicity ) @xmath37 consists of three copies of @xmath38 joined at together at a point which corresponds to a star - tree .",
    "this is illustrated in fig .",
    "[ fig : t4 ] . for @xmath39",
    "there are @xmath40 unrooted tree topologies , so @xmath41 is formed from @xmath40 orthants each of which is a copy of @xmath42 . as fig .",
    "[ fig : t5 ] shows , each orthant is joined to two others along each codimension-@xmath0 face , corresponding to the two choices for nearest - neighbor interchange on a particular edge of a tree .",
    "the combinatorial structure of the orthants corresponds to a copy of the petersen graph , as illustrated by in fig .",
    "[ fig : t5 ] , and @xmath41 is the topological cone of this graph . for @xmath43",
    "the structure is more complicated again , since unlike the case for @xmath36 and @xmath44 , there are different possible unlabelled tree shapes .",
    "however , the underlying principles remain the same for all values of @xmath23 : each orthant corresponds to all the trees with a particular topology , and every orthant is joined to two others along each codimension-@xmath0 face .        [",
    "cols=\"^,^ \" , ]      in order to assess the performance of the algorithm on larger trees , we re - analysed a parametric bootstrap sample of trees considered in @xcite .",
    "this sample was simulated from an underlying tree containing @xmath45 taxa representing major eukaryote groups with an outgroup of archaea .",
    "the tree contained two long branches , corresponding to _ microsporidia _ and _ guillardia _ , in addition to the long branch leading to the archaeal outgroup .",
    "this simulated sample was analysed to explore the possibility of using principal geodesics to capture long branch attraction ( lba ) effects .",
    "the data were transformed prior to construction of principal geodesics by scaling edges : edge lengths were scaled so that every split had unit mean length , with the mean for each split taken across trees containing that split in the data set .",
    "this transformation was performed so that variability was assessed as being relative to edge length , by scaling up the variability in short edges .",
    "analysing transformed data in this way can be thought of as being analogous to using the sample correlation matrix instead of the covariance matrix in standard pca .",
    "more details are given in @xcite .",
    "the analysis was performed ignoring pendant edge lengths in the sample .",
    "[ fig : lba ] shows the end - points of the principal geodesic constructed using the algorithm in sec .",
    "[ sec : alg ] . as the principal geodesic is traversed , the taxa with long branches , _ microsporidia _ and _ guillardia _ , both ` float ' around the tree from their initial positions near fungi and plants respectively , to be grouped next to the archaea . the principal geodesic had @xmath46 and @xmath47 in comparison to the geodesic constructed with @xmath14pca which had @xmath48 and @xmath49 .",
    "both _ microsporidia _ and _ guillardia _ move around the tree , in contrast to the results from @xmath14pca for which only one of the taxa moved in this way .",
    "the principal geodesic does not lie in the class of simple geodesics considered by @xmath14pca , and so @xmath14pca is not able to capture the same result .",
    "when viewed as an animation of trees , the principal geodesic gives an immediate visual representation of the lba effect present in the data set .    the value @xmath47 appears smaller than the values typically obtained in a standard principal components analysis",
    "this is in part due to the high - dimensional nature of treespace , and the following analogy can be used to interpret @xmath50 .",
    "principal geodesic analysis in treespace with @xmath23 taxa can be compared with standard pca in @xmath25 when pendant edges are ignored .",
    "consider the analysis of multivariate normal data for which the variance is @xmath51 along the principal axis , and @xmath52 in all other orthogonal directions .",
    "it follows that the ratio @xmath53 is @xmath54 . for @xmath55 and @xmath56 as above this gives a value of @xmath57 . under this euclidean analogy , and assuming the other effects in the data consist of isotropic noise , the principal geodesic for the bootstrap sample has an associated variance which is a factor @xmath57 times the noise variance .",
    "of course , the analogy with euclidean pca is approximate , but nonetheless this calculation suggests that the lba effect is significantly greater than random noise .",
    "we constructed principal geodesics for several other data sets in order to assess the performance of the algorithm , and give brief details here to indicate the type of results that can be obtained via principal geodesic analysis .",
    "* overall scale : * sometimes gene trees vary in the overall scale of the phylogenies .",
    "we re - analysed the metazoan data set considered in @xcite , and obtained a principal geodesic with @xmath58 .",
    "although this principal geodesic represented some changes in topology , the main feature was the difference in total length of the trees at either end of the geodesic .",
    "* single nni : * we analysed a well - known data set of @xmath59 gene trees for @xmath60 species of yeast @xcite , obtained by maximum likelihood inference .",
    "the principal geodesic passed through the majority consensus topology of the @xmath59 gene trees and involved a single nearest - neighbor interchange between the subtrees ( ( _ c.albicans _ , _",
    "s.kluyveri_ ) , _ s.castellii_ ) and ( _ c.albicans _ , ( _ s.kluyveri _ , _",
    "s.castellii_ ) ) .",
    "the principal geodesic had @xmath61 , suggesting that the majority of variability in the data set was captured by this single nni .",
    "* isotropy : * some data sets are not well represented by a geodesic segment in tree space . in a recent study of turtle evolution @xcite , phylogenies were inferred for various species of turtle , but the individual representing each species was selected at random from a fixed pool of individuals .",
    "phylogenies were constructed for 100 different sets of individuals sampled in this way .",
    "the principal geodesic constructed for this data set had @xmath50 close to the isotropic baseline discussed in sec .",
    "[ sec : rsqu ] .",
    "multiple runs of the algorithm failed to converge to a single geodesic : multiple local optima existed with similar values of the objective function .",
    "this suggests , by analogy with the euclidean case , that the data are ` isotropic ' in treespace with no distribution around a particular geodesic direction .",
    "construction of principal geodesics in treespace is computationally demanding , in most part due to the huge number of possible topologies for the end - points of geodesic segments .",
    "since our algorithm is stochastic it is not possible to give an overall algorithmic complexity , but each evaluation of the objective function  @xmath62 has order @xmath63 where @xmath23 is the number of taxa and @xmath64 the number of data points .",
    "calculation of the objective can be distributed across parallel processors simply by splitting up the data set into subsets , and so the algorithm speed increases linearly with the number of processors .",
    "the run times on a standard desktop computer were approximately @xmath65 minutes for the chaperonin data set and @xmath66 hours for the bootstrap sample of trees to obtain convergence from a single starting point . these times were obtained using @xmath30 cores on a intel core i@xmath67 cpu running at @xmath68ghz with @xmath60 gb memory . however",
    ", very strict convergence criteria were used for the examples when preparing this article . in general",
    "the value of the objective function decreases approximately exponentially as the algorithm proceeds , and the majority of the runtime was spent performing minor adjustments to the segment @xmath69 close to the final value .",
    "faster times could be obtained if the user accepted a greater degree of approximation . in practice ,",
    "the algorithm is probably limited to work with samples containing fewer than @xmath70 taxa and @xmath71@xmath72 trees on a standard desktop computer .",
    "however , parallel computing resources would enable larger data sets , particularly in terms of the number of trees , to be analysed .",
    "the algorithm is implemented in java , and software is freely available from the web site given in the abstract .",
    "an important part of the software is a tool for visualizing geodesics in treespace . in a similar way to phylogenetic network diagrams",
    ", it enables users to relate different topologies associated with a sample .",
    "the user drags a slider to traverse the geodesic and view the corresponding smoothly changing phylogenetic tree .",
    "the collection of topologies along a given geodesic segment is not always compatible with a single rotational ordering of taxa in the plane . finding a rotational ordering for each topology in such a way as to minimize changes in ordering as the geodesic is traversed is problematic ; the geodesic viewer uses simple heuristics to obtain a reasonable solution .",
    "summarizing samples and distributions on treespace is a fundamentally difficult problem due to the high dimensionality and non - euclidean nature of treespace .",
    "dimensional reduction , by fitting appropriate low - dimensional objects to samples of trees , is an obvious approach to adopt .",
    "this article has focussed on the construction of an analog of the first principal component of a sample , without consideration of the higher order components .",
    "construction of the second order component , for example , requires an analogue of a plane or some other @xmath66-dimensional surface in treespace , but the theory of higher - dimensional surfaces in treespace has not yet been developed .",
    "one possibility , a natural extension of the geodesic segments considered in this paper , is to seek a configuration of three points in treespace and consider the projection of the data onto the convex hull of these points .",
    "however , it is possible that completely different objects  not necessarily based on the geodesic geometry  might form better descriptors of distributions of phylogenies .",
    "principal components analysis has been described in this article in terms of a least squares procedure rather than by reference to a probabilistic model . in this way",
    ", the sum of squared distances @xmath73 has essentially played the role of the likelihood of the data .",
    "the likelihood for multivariate normal models on @xmath74 has exactly this form , and this leads to the description of standard pca as a least squares procedure , as given in the introduction .",
    "we adopted the least squares approach in treespace by analogy , but a probabilistic model and a more fully developed theory of distributions on treespace would be highly desirable .",
    "b.  holland and v.  moulton , `` consensus networks : a method for visualising incompatibilities in collections of trees , '' in _ algorithms in bioinformatics_.1em plus 0.5em minus 0.4emspringer , 2003 , lecture notes in computer science .",
    "p.  t. fletcher , c.  lu , and s.  joshi , `` statistics of shape via principal geodesic analysis on lie groups , '' in _ proceedings of ieee computer society conference on computer vision and pattern recognition _ , 2003 , pp .",
    "195 .",
    "marron , s.  jung , and i.  dryden , `` speculation on the generality of the backward stepwise view of pca , '' in _ proceedings of the international conference on multimedia information retrieval_.1em plus 0.5em minus 0.4emacm , 2010 , pp .",
    "227230 .",
    "a.  feragen , m.  owen , j.  petersen , m.  wille , l.  thomsen , a.  dirksen , and de  bruijne  m. , `` tree - space statistics and approximations for large - scale analysis of anatomical trees , '' in _",
    "23rd biennial international conference on information processing in medical imaging ( ipmi ) _ , 2013 .",
    "p.  spinks , r.  thomson , g.  pauly , c.  e. newman , g.  mount , and h.  shaffer , `` misleading phylogenetic inferences based on single - exemplar sampling in the turtle genus pseudemys . ''",
    "_ , vol ."
  ],
  "abstract_text": [
    "<S> most phylogenetic analyses result in a sample of trees , but summarizing and visualizing these samples can be challenging . </S>",
    "<S> consensus trees often provide limited information about a sample , and so methods such as consensus networks , clustering and multidimensional scaling have been developed and applied to tree samples . </S>",
    "<S> this paper describes a stochastic algorithm for constructing a principal geodesic or line through treespace which is analogous to the first principal component in standard principal components analysis . </S>",
    "<S> a principal geodesic summarizes the most variable features of a sample of trees , in terms of both tree topology and branch lengths , and it can be visualized as an animation of smoothly changing trees . </S>",
    "<S> the algorithm performs a stochastic search through parameter space for a geodesic which minimises the sum of squared projected distances of the data points . </S>",
    "<S> this procedure aims to identify the globally optimal principal geodesic , though convergence to locally optimal geodesics is possible . </S>",
    "<S> the methodology is illustrated by constructing principal geodesics for experimental and simulated data sets , demonstrating the insight into samples of trees that can be gained and how the method improves on a previously published approach . </S>",
    "<S> a java package called geophytter for constructing and visualising principal geodesics is freely available from www.ncl.ac.uk/~ntmwn/geophytter .    </S>",
    "<S> _ this is a postprint of an article published in ieee transactions in computational biology and bioinformatics _    </S>",
    "<S> ieee / acm , 2014 . </S>",
    "<S> this is the author s version of the work . </S>",
    "<S> it is posted here by permission of acm for your personal use . not for redistribution . </S>",
    "<S> the definitive version was published in ieee transactions in computational biology and bioinformatics , vol .  </S>",
    "<S> 11 , march - april 2014 , http://doi.ieeecomputersociety.org/10.1109/tcbb.2014.2309599 + </S>"
  ]
}