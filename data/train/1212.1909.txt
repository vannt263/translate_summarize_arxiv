{
  "article_text": [
    "analysis of the increasingly available genomic data continue to reveal the extent of hybridization and its importance in the speciation and evolutionary innovations of several groups of species and animals @xcite . when hybridization occurs , the evolutionary history of the species and their genomes is _ reticulate _ and best modeled by a _ phylogenetic network _ which , in our context , is a special type of rooted , directed , acyclic graphs @xcite .",
    "methods have been devised for inferring phylogenetic networks from pairs of gene trees ( e.g. , @xcite ) , larger collections of gene trees @xcite , and directly from sequence data ( e.g. , @xcite ) .",
    "a salient feature of all these methods is that the incongruence of gene tree topologies , and more generally the heterogeneity among the different loci , is caused solely by reticulate evolutionary events such as horizontal gene transfer or hybridization .",
    "while hybridization causes incongruence among gene trees , other evolutionary events can also result in incongruence , such as incomplete lineage sorting ( ils ) and gene duplication / loss @xcite .",
    "in particular , as ( successful ) hybridization occurs between closely related species , it is important to account simultaneously for incomplete lineage sorting , a phenomenon that arises in similar situations @xcite . while a wide array of methods have been devised for inference under ils along",
    "( see @xcite for recent surveys ) , it is important to integrate both hybridization and ils into a single framework for inference . needless to say , it is important to integrate all sources of incongruence into a single framework , but that is much beyond the scope of this paper .",
    "the main task , then , becomes : given a gene tree topology and a phylogenetic network , to reconcile the gene tree within the branches of the phylogenetic network , thus allowing simultaneously for hybridization and ils .",
    "when a method for achieving this task is  wrapped \" by a strategy for searching the phylogenetic network space , the result is a method for inferring reticulate evolutionary histories in the presence of both hybridization and ils .",
    "therefore , is is very important to solve the reconciliation problem .",
    "indeed , in the last five years , several attempts have been made , following different approaches , to address the problem of inferring hybridization in the presence of ils @xcite .",
    "however , due to the computational challenges of the problem , these methods focused on very limited cases : fewer than 5 taxa , one or two hybridization events , and a single allele sampled per species .",
    "more recently , our group proposed two methods for detecting hybridization in the presence of incomplete lineage sorting , including a probabilistic method which computes the probability of gene tree topologies given a phylogenetic network @xcite and a parsimony method which computes the minimum number of extra lineages @xcite required to reconcile a gene tree within the branches of a phylogenetic network @xcite . while these methods are general in terms of the topologies and sizes of gene trees and phylogenetic networks , they are computationally intensive . in particular , these methods convert a phylogenetic network to a special type of trees , called _ multil - labeled trees _",
    "( mul - trees ) , and conduct computation on these trees while accounting for every possible mapping of genes to their leaves .",
    "this computation can be exponential in the number of leaves , and does explicit computations of coalescent histories of the gene genealogies .    in this paper , we propose a novel way of computing the probability of gene tree topologies given a phylogenetic network , and a novel way of computing the minimum number of extra lineages of a gene tree and a phylogenetic network .",
    "both of them use the concept of _ ancestral configuration _ ( or ac ) which was introduced very recently for computing the probability of gene tree topologies given a species tree @xcite .",
    "the new algorithms are exact and much more efficient than the two mul - tree based algorithms we introduced in @xcite . in our extensive simulation studies ,",
    "we compared the running time of the new ac - based methods with the previous mul - tree based ones .",
    "we show that the new algorithms can speed up the computation by up to 5 orders of magnitude , thus allowing for the analysis of much larger data sets .",
    "furthermore , we discuss how the running time of the new methods is still affected by the topologies of the species networks , more specifically the configurations of reticulation nodes , and the topologies of gene trees .",
    "all methods described in this paper have been implemented in the phylonet software package @xcite which is freely available for download in open source at http://bioinfo.cs.rice.edu/phylonet .",
    "in this work , we assume the following definition of phylogenetic networks @xcite .    [",
    "net - def ] a _",
    "phylogenetic @xmath0-network _ , or @xmath0-network for short , @xmath1 is an ordered pair @xmath2 , where @xmath3 is a directed , acyclic graph ( dag ) with @xmath4 , where ( 1 ) @xmath5 ( @xmath6 is the _ root _ of @xmath1 ) ; ( 2 ) @xmath7 , @xmath8 and @xmath9 ( @xmath10 are the _ external tree nodes _ , or _ leaves _ , of @xmath1 ) ; ( 3 ) @xmath11 , @xmath8 and @xmath12 ( @xmath13 are the _ internal tree nodes _ of @xmath1 ) ; and , ( 4 ) @xmath14 , @xmath15 and @xmath16 ( @xmath17 are the _ reticulation nodes _ of @xmath1 ) ; @xmath18 are the network s edges , and @xmath19 is the _ leaf - labeling _",
    "function , which is a bijection from @xmath10 to @xmath0 .    for the probabilistic setting of the problem , we also associate with every pair of reticulation edges inheritance probabilities @xmath20 and @xmath21 such that @xmath22 . inheritance probability",
    "@xmath23 indicates the proportion of alleles in population @xmath24 that are inherited from population @xmath25 .",
    "gene tree _ is a phylogenetic network with no reticulation nodes .",
    "the way in which a gene evolves within the the branches of a phylogenetic network can be described by a _",
    "coalescent history _",
    "let @xmath1 be a phylogenetic network .",
    "we denote by @xmath26 the set of nodes in @xmath1 and by @xmath27 the set of nodes that are reachable from the root of @xmath1 via at least one path that goes through node @xmath28 . given a phylogenetic network @xmath1 and a gene tree @xmath29 , a _ coalescent history _ is a function @xmath30 such that the following two conditions hold : ( 1 ) if @xmath24 is a leaf in @xmath29 , then @xmath31 is the leaf in @xmath1 with the same label ( in the case of multiple alleles , @xmath31 is the leaf in @xmath1 with the label of the species from which the allele labeling leaf @xmath24 in @xmath29 is sampled ) ; and , ( 2 ) if @xmath24 is a node in @xmath32 , then @xmath31 is a node in @xmath33 .",
    "see fig .",
    "[ fig : coalhis ] in the appendix for an illustration .    given a phylogenetic network @xmath1 and a gene tree @xmath29 , we denote by @xmath34 the set of all coalescent histories .",
    "then the probability of observing gene tree @xmath29 given phylogenetic network @xmath1 is @xmath35 where @xmath36 is the probability of coalescent history @xmath37 given phylogenetic network @xmath1 ( along with its branch lengths and inheritance probabilities ) .",
    "coalescent histories can also be used to compute the minimum number of extra lineages required to reconcile gene tree @xmath29 with @xmath1 , which we denote by @xmath38 , as @xmath39 methods for computing @xmath40 and @xmath38 when @xmath1 is a tree were recently given in @xcite and @xcite , respectively .",
    "recently , we proposed new methods for computing these two quantities when @xmath1 is a phylogenetic network @xcite .",
    "the basic idea of both of these methods is to convert the phylogenetic network @xmath1 into a _",
    "mul - tree _ @xmath41 and then make use of some existing techniques to complete the computation on @xmath41 instead of on @xmath1 .",
    "a mul - tree @xcite is a tree whose leaves are not uniquely labeled by a set of taxa .",
    "therefore , alleles sampled from one species , say @xmath42 , can map to any of the leaves in the mul - tree @xmath41 that are labeled by @xmath42 . for network @xmath1 on taxa @xmath0 ,",
    "we denote by @xmath43 the set of alleles sampled from species @xmath42 ( @xmath44 ) , and by @xmath45 the set of leaves in @xmath41 that are labeled by species @xmath42 .",
    "then a _ valid allele mapping _ is a function @xmath46 such that if @xmath47 , and @xmath48 , then @xmath49 @xcite .",
    "[ fig : net2tree ] in the appendix shows an example of converting a phylogenetic network into a mul - tree along with all valid allele mappings when single allele is sampled per species .",
    "suppose @xmath41 is the mul - tree converted from network @xmath1 .",
    "we denote by @xmath50 the set of all valid allele mappings for mul - tree @xmath41 and gene tree @xmath29 .",
    "then the probability of observing gene tree @xmath29 given @xmath1 can be computed using mul - tree @xmath41 as follows @xmath51 where @xmath52 is the set of coalescent histories of @xmath29 within mul - tree @xmath41 under valid allele mapping @xmath53 , and @xmath54 is the probability of observing coalescent history @xmath37 within @xmath41 under @xmath53 @xcite .",
    "furthermore , the minimum number of extra lineages required to reconcile gene tree @xmath29 with @xmath1 can also be computed using mul - tree @xmath41 by @xmath55 where @xmath56 is the total number of extra lineages of coalescent history @xmath37 within @xmath41 under allele mapping @xmath53 @xcite .",
    "the advantage of the mul - tree based techniques is that once the network is converted to the mul - tree , tree - based techniques from the multi - species coalescent theory apply with minimal revision . nonetheless , from eq . and",
    "eq . we can see that the running time of both two methods depend on the number of valid allele mappings .",
    "let @xmath57 be the set of leaves of @xmath1 , and @xmath58 be the number of alleles sampled from some @xmath42 in @xmath57 in gene tree @xmath29 .",
    "then the number of valid allele mappings of @xmath1 and @xmath29 is bounded from below and above by @xmath59 and @xmath60 , respectively , where @xmath61 and @xmath62 are the minimum and maximum number of reticulation nodes on any path from leaf @xmath42 in @xmath57 to the root of @xmath1 respectively .",
    "we can see that when the number of taxa or sampled alleles increases , or when the number of reticulation nodes increases , this number can quickly become very large which makes the computations prohibitive .",
    "furthermore , computing term @xmath54 in eq .",
    "using coalescent histories will become infeasible when the number of taxa or sampled alleles increases @xcite .",
    "central to our methods is the concept of _ ancestral configuration _ ( or simply configuration , or ac ) .",
    "when it was first introduced , it was defined on species trees for computing the probability of gene tree topologies @xcite . in this work ,",
    "we extend it to species networks . given a species network @xmath1 and a gene tree @xmath29 , an ancestral configuration at node @xmath24 of @xmath1 , which we denote by @xmath63 ( the subscript @xmath24 may be omitted when the identity of node @xmath24 is clear from the context ) ,",
    "is a set of gene lineages at node @xmath24 under some coalescent history @xmath37 in @xmath34 . the number of gene lineages in configuration @xmath63 is denoted by @xmath64 . for example , given the coalescent history @xmath65 shown in fig .",
    "[ fig : coalhis ] , for reticulation node @xmath24 , we have @xmath66 and @xmath67 ; for the root of @xmath1 , we have @xmath68 and @xmath69 .",
    "furthermore , we denote by @xmath70 a set of pairs @xmath71 where @xmath72 is a configuration at node @xmath24 of @xmath1 and @xmath73 is the weight of @xmath72 , and by @xmath74 a set of @xmath71 where @xmath72 is a configuration that about to leave branch @xmath75 of @xmath1 and @xmath73 is the weight of @xmath72 .",
    "we will discuss how to set / use the weight @xmath73 below .",
    "assume @xmath76 and @xmath77 are two gene lineages that meet at some node in a gene tree @xmath29 . when reconciling @xmath29 within the branches of a species network @xmath1 , after they two entered the same branch of @xmath1 , they might or might not have coalesced before leaving that branch , the probability of which depends on the length ( in terms of time ) and width ( in terms of population size ) of that branch",
    ". therefore , one configuration entering a branch of @xmath1 might give rise to several different configurations leaving that branch with different probabilities .",
    "for example , suppose a gene tree @xmath29 has a subtree @xmath78 ( tree with root @xmath79 , leaf - child @xmath80 of the root , child @xmath42 of the root , and two leaves @xmath72 and @xmath81 that are children of @xmath42 ) . then if a configuration @xmath82 entered a branch of @xmath1 , it could give rise to one of three different configurations leaving that branch , including @xmath82 @xmath83 and @xmath84 .",
    "we denote by @xmath85 , for configuration @xmath86 and gene tree @xmath29 , the set of all configurations that @xmath86 might coalesce into with respect to the topology of @xmath29 .",
    "we now show how to use configurations to compute @xmath40 and @xmath38 efficiently .      for a configuration @xmath86 ,",
    "we denote by @xmath87 the minimum total number of extra lineages on all branches that the extant gene lineages in @xmath86 having passed through from time @xmath88 to coalesce into the present gene lineages in @xmath86 . in this method ,",
    "weight @xmath73 in @xmath89 corresponds to @xmath87 , where @xmath90 is either @xmath70 where @xmath24 is a node or @xmath91 where @xmath81 is a branch .",
    "[ lemma : xlupdate ] let @xmath86 be a configuration entering a branch @xmath81 and @xmath92 be a configuration that @xmath86 coalesced into when leaving @xmath81",
    ". then @xmath93 where @xmath94 is the number of extra lineages on branch @xmath81 .",
    "we define a function called * createcacsforxl * which takes a gene tree @xmath29 , a branch @xmath95 of the network @xmath1 and a set of configuration - weight pairs @xmath70 that enter branch @xmath81 , and returns a set of configuration - weight pairs @xmath74 that leave branch @xmath81 .",
    "note that although one configuration can coalesce into several different configurations along a branch , under parsimony we only need to keep the one that has the minimum total number of extra lineages .",
    "therefore @xmath96 and there is 1 - 1 correspondence between configurations in @xmath97 and configurations in @xmath98 .",
    "for a phylogenetic network @xmath1 and a gene tree @xmath29 , the algorithm for computing the minimum number of extra lineages required to reconcile @xmath29 within @xmath1 is shown in alg .",
    "[ alg : countxl ] .",
    "basically , we traverse the nodes of the network in post - order .",
    "for every node @xmath24 we visit , we construct the set of configuration - weight pairs @xmath70 for node @xmath24 based on its type .",
    "recall that there are four types of nodes in a phylogenetic network , which are leaves , reticulation nodes , internal tree nodes , and the root .",
    "finally when we arrive at the root of @xmath1 , we are able to obtain @xmath38 .    at a reticulate node @xmath24 who has parents @xmath99 and @xmath100 ,",
    "every gene lineage could independently choose to go toward @xmath99 or @xmath100 .",
    "so for every @xmath101 in @xmath70 , there are @xmath102 different ways of splitting @xmath86 into two configurations , say @xmath103 and @xmath104 , such that @xmath105 .",
    "for example , a configuration @xmath106 can be split in four different ways including @xmath106 and @xmath107 , @xmath108 and @xmath109 , @xmath109 and @xmath108 , and @xmath107 and @xmath106 .",
    "it is important to keep track of those gene lineages that are originally coming from one splitting so that we could merge them back once they are in the same population again .",
    "note that there is no need to consider coalescent events on branch @xmath110 or @xmath111 , because all gene lineages on these two branches were already in the same population on branch @xmath112 . and under parsimony where all gene lineages are assumed to coalesce as soon as they can , all possible coalescent events that could happen among these gene lineages must have already been applied on branch @xmath113 . as a result ,",
    "@xmath114 and @xmath115 can be put directly into @xmath116 and @xmath117 respectively .",
    "the _ compatibility _ of configurations in the algorithm is defined as follows .",
    "two configurations are compatible if for every reticulation node , either both configurations went through that node and had resulted from the same split of an ancestral configuration , or at least one of the two configurations did not go through that node .",
    "[ fig : algoexample ] in the appendix illustrates configurations generated for every node and branch of a network given a gene tree .      for a configuration @xmath86 ,",
    "we denote by @xmath118 the cumulative probability of the extant gene lineages in @xmath86 coalescing into the present gene lineages in @xmath86 from time @xmath88 . in this method ,",
    "weight @xmath73 in @xmath89 corresponds to @xmath118 , where @xmath90 is either @xmath70 where @xmath24 is a node or @xmath91 where @xmath81 is a branch .",
    "[ lemma : coalesceprobonbranch ] let @xmath86 be a configuration entering branch @xmath81 of network @xmath1 with branch length @xmath119 . then the probability of observing configuration @xmath92 leaving branch @xmath81 is @xmath120 where @xmath121 is the probability that @xmath122 gene lineages coalesce into @xmath123 gene lineages within time @xmath119 , @xmath124 is the number of ways that coalescent events can occur along branch @xmath81 to coalesce @xmath86 into @xmath92 with respect to the gene tree topology , and @xmath125 is the number of all possible orderings of @xmath126 coalescent events .",
    "the details of how to compute @xmath121 , @xmath124 and @xmath125 are given in @xcite .",
    "[ lemma : probupdate ]",
    "let @xmath86 be a configuration entering a branch @xmath81 and @xmath92 be a configuration that @xmath86 coalesced into when leaving @xmath81 .",
    "then @xmath127    we define a function called * createcacsforprob * which takes a gene tree @xmath29 , a branch @xmath95 of the network @xmath1 and a set of configuration - weight pairs @xmath70 that enter branch @xmath81 , and returns a set of all possible configuration - weight pairs @xmath74 that leave branch @xmath81 .",
    "note that several configurations can coalesce into the same configuration along a branch , but we only need to keep one copy of every distinct configuration . here , we define two configurations to be the _ identical _ if they satisfy the following two conditions : ( 1 ) they contain the same set of gene lineages , and ( 2 ) for every reticulation node @xmath128 in the network , either neither of them contain lineages that have passed through it , or the lineages in these two configurations that passed through it originally came from one splitting at node @xmath128 .",
    "the algorithm for calculating the probability of observing a gene tree @xmath29 given a species network @xmath1 is shown in alg .",
    "[ alg : calprob ] .",
    "the basic idea is similar to the parsimony method we described in the previous section .",
    "an illustration is given in fig .",
    "[ fig : algoexample ] .      at every reticulation node @xmath24 in the species network ,",
    "every configuration @xmath86 in @xmath129 is split into two configurations in all @xmath102 possible ways .",
    "this may result in multiple @xmath130 pairs in a @xmath90 set where their configurations have the same set of gene lineages but not considered to be the same because they were not originally from one splitting at some reticulation node some lineages in them have passed through .",
    "it may increase the number of configurations significantly .",
    "it is clear that the running time of both these two algorithms depends on the number of configurations .",
    "so in order to reduce the number of configurations so as to speedup the computation , we make use of _ articulation _ nodes in the graph ( an articulation node is a node whose removal disconnects the phylogenetic network ) . obviously , the reticulation nodes inside the sub - network rooted at an articulation node are independent of the reticulation nodes outside the sub - network .",
    "so at articulation node @xmath24 we can clear all the information about the splittings at all reticulation nodes under @xmath24 so that all configurations at @xmath24 containing the same set of gene lineages are considered to be the same .",
    "more precisely , when traversing the species network , after constructing @xmath70 for some internal tree node @xmath24 as we have described in alg .",
    "[ alg : countxl ] and alg .",
    "[ alg : calprob ] , if @xmath24 is an articulation node , we clear all the information about splittings at all reticulation nodes in the sub - network rooted at @xmath24 . then for counting the minimum number of extra lineages",
    ", we update @xmath70 to be @xmath131 such that only the configuration - weight pair that has the minimum weight is left , using the statement : @xmath132 . and for computing the probability of the topology of a gene tree , we keep only one copy of every distinct configuration in the sense of the set of lineages it contains",
    ". more precisely , we update @xmath70 to be @xmath131 using @xmath133 .",
    "to study the performance of the two methods compared to the mul - tree based ones , we ran all four on synthetic data generated as follows .",
    "we first generated @xmath134 random 24-taxon species trees using phylogen @xcite , and from these we generated random species networks with @xmath135 , @xmath136 , @xmath137 , @xmath138 and @xmath139 reticulation nodes .",
    "when expanding a species network with @xmath77 reticulation nodes to a species network with @xmath140 reticulation nodes , we randomly selected two existing edges in the species network and connected their midpoints from the higher one to the lower one and then the lower one becomes a new reticulation node .",
    "then , we simulated @xmath141 , @xmath142 , @xmath143 , @xmath134 , @xmath144 , @xmath145 and @xmath146 gene trees respectively within the branches of each species network using the ms program @xcite . since the mul - tree methods are computationally very intensive , we employed the following strategy : for the parsimony methods , we bounded the time at 24 hours ( that is , killed jobs that did not complete within 24 hours ) . for the probabilistic ones , we bounded the time at 8 hours .",
    "all computations were run on a computer with a quad - core intel xeon , 2.83ghz cpu , and 4 gb of ram .    for computing the minimum number of extra lineages , the results of the running time of both two methods are shown in fig .",
    "[ fig : mdcresult ] .",
    "overall , both two methods spent more time on data sets where the species networks contain more reticulation nodes .",
    "it is not surprising given the fact that adding more reticulation nodes increases the complexity of the networks in general .",
    "we can see that the speedup of the ac - based method over the mul - tree based method also increased when the number of reticulation nodes in the species networks increased .",
    "it is up to over @xmath147 orders of magnitude . in this figure , we only plot the results of the computations that could finish in @xmath148 hours across all different number of loci sampled .",
    "in fact , the ac based method finished every computation in less than 3 minutes , even for the largest data set which contained species networks with @xmath139 reticulations and @xmath146 gene trees . for the mul - tree based one , out of @xmath134 repetitions the numbers of repetitions that were able to finish in @xmath148 hours across all different loci are @xmath134 , @xmath134 , @xmath149 , @xmath150 and @xmath151 for data sets containing species networks with @xmath135 , @xmath136 , @xmath137 , @xmath138 and @xmath139 reticulation nodes .        for computing the probability of the gene tree topologies given a species network , we were not able to run the mul - tree based one because we found it could not finish the computation in @xmath148 hours given even for the smallest data set ( one gene tree and a species network with one reticulation node ) .",
    "in contrast , the ac - based method only needed @xmath152 seconds on the same data set which implies a speedup of at least @xmath147 orders of magnitude .",
    "part of the results of the ac based algorithm are shown in fig .",
    "[ fig : probresult ] .",
    "again , only the results of the computations that could finish successfully in 24 hours across all loci were plotted .",
    "we can see that the number of data points in the figure decreased significantly when the number of reticulation nodes in the species networks increased .",
    "in fact , out of @xmath134 repetitions , the numbers of repetitions that finished the computations successfully across all different loci are @xmath149 , @xmath150 , @xmath153 , @xmath154 and @xmath155 for data sets containing species networks with @xmath135 , @xmath136 , @xmath137 , @xmath138 and @xmath139 reticulation nodes respectively .",
    "the number of successful runs is much smaller than that for the parsimony method .",
    "furthermore , those computations failed not only because of the 24 hours time limit .",
    "part of them are due to memory issues : the number of configurations generated in the computation in order to cover all the possible coalescence patterns that could arise is much more than that needed in the parsimony method . and the increase in the number of reticulation nodes in the species network might result in a very large increase in the number of configurations .    from fig .",
    "[ fig : mdcresult ] and fig .",
    "[ fig : probresult ] we observe that for both methods , the running time differed significantly from one data set to another .",
    "there are several factors that can affect the number of configurations generated during the computation which directly dominates the running time of the algorithm .",
    "two of the factors that affect performance are the number of leaves under a reticulation node , as well as the topology of the gene tree .",
    "we considered a  controlled \" data set , where we controlled the placement of the reticulation node as well as the shapes of the gene trees . in particular , we considered three networks , each with a single reticulation node , yet with 1 , 8 , and 15 leaves under the reticulation node , respectively ( see fig .",
    "[ fig : analysis1 ] in the appendix ) .",
    "further , we considered two gene trees : @xmath156 , whose topology is  contained \" with each of the three networks , and @xmath157 , whose disagreement with the three phylogenetic networks is very extensive that all coalescence events must occur above the root of the phylogenetic networks ( fig .",
    "[ fig : analysis1 ] in the appendix ) .",
    "we ran both ac - based methods on every pair of phylogenetic network and gene tree .    for the parsimony method ,",
    "if the gene tree is a contained tree of the species network , it can be reconciled into the species network with @xmath88 extra lineages . in this case , for every articulation node @xmath24 of the network , @xmath70 has only one element @xmath158 and @xmath159 , and the running time is almost the same for all three networks and it is very fast ( table [ table : analysis1_mp ] in the appendix ) .",
    "however , for gene tree @xmath160 whose coalescent events have to happen all above the root , for every articulation node @xmath24 , @xmath70 has only one element @xmath158 and @xmath161 where @xmath162 equals the number of leaf nodes under @xmath24 .",
    "we know that at a reticulation node every configuration @xmath86 will give rise to @xmath102 configurations to each of its parents .",
    "therefore , the running time of @xmath160 increased when the number of nodes under the reticulation nodes in the species network increased , and @xmath76 who is a parent of the reticulation node @xmath37 has the largest @xmath70 set and @xmath163 where @xmath162 is the number of leaves under @xmath37 ( table [ table : analysis1_mp ] in the appendix ) .",
    "furthermore , we found that the number of valid allele mappings when using the mul - tree based method is equal to the largest size of @xmath70 generated for a node @xmath24 during the computation when all the coalescent events have to happen above the root of the species network if we do not reduce the number of configurations for articulation nodes .",
    "this is easy to see . for the ac - based algorithm , if we do not clear the splitting information at articulation nodes , then every element in @xmath164 , where @xmath165 is the root of the network , represents a different combination of the ways every leaf lineage took at every reticulation node . and",
    "every valid allele mapping also represents the same thing .",
    "however , for most of the gene trees , not all coalescent events have to happen above the root , and that is part of where the ac - based algorithm improves upon the mul - tree based one . comparing @xmath166 and @xmath160",
    "we can see that for parsimony reconciliations , the more coalescent events that are allowed to occur under reticulation nodes with respect to the topology of the gene tree , the faster the method is .    for the probabilistic method , since we need to keep all configurations so as to cover all possible coalescence patterns , the gene trees whose coalescent events have to happen above the root become the easiest case because they have only one reconciliation .",
    "it is exactly the opposite to the parsimony method where the gene trees whose coalescent events have to happen above the root take longest running time ( table [ table : analysis1_ml ] in the appendix ) . for the mul - tree based method , the probability is computed by summing up the probabilities of all coalescent histories in mul - tree under all valid allele mappings .",
    "however , for most cases using acs to compute the probability of a gene tree given a species tree is much faster than through enumerating coalescent histories due to the fact that the number of coalescent histories is much larger than the number of configurations generated @xcite .",
    "that is part of the reason why the ac based algorithm outperforms the mul - tree based one for computing the probability in terms of efficiency .    a third factor that impacts performance is the dependency of the reticulation nodes in the phylogenetic network ( roughly , how many of them fall on a single path to the root ) .",
    "for parsimonious reconciliations , when the reticulation events are independent ( or , less dependent ) , the method is much faster .",
    "this is not surprising , given that almost all nodes are articulation nodes and the number of acs is reduced significantly . for the probabilistic reconciliation , a similar trend holds , and the dependence of the reticulation nodes results in an explosion in the number of acs .",
    "these results are given in more detail in fig .",
    "[ fig : analysis2 ] and tables [ table : analysis2_mp ] and [ table : analysis2_ml ] in the appendix .    to sum up , for the data sets of the same size ( e.g. , number of taxa and reticulation nodes ) , the running time of the ac - based algorithms increases when there are more leaves under reticulation nodes and when the reticulation nodes are more dependent on each other .",
    "with respect to the topology of the gene tree and the species network , the more coalescent events that are allowed under reticulation nodes the faster the parsimony method is , and the opposite for the probabilistic method . for most cases ,",
    "the ac - based methods are significantly much faster than the mul - tree based ones . for parsimony ,",
    "the gain in terms of efficiency comes from avoiding considering useless allele mappings including the ones that can not yield the optimal reconciliation implied by the coalesced lineages in the configurations and the ones that correspond to the configurations being removed at articulation nodes . for probabilistic reconciliation",
    ", the gain comes from two parts .",
    "one is also avoiding considering useless allele mappings by removing corresponding configurations at articulation nodes .",
    "the other is using ac to compute the probability instead of enumerating the coalescent histories .    10    m.  l. arnold . .",
    "oxford university press , oxford , 1997 .",
    "the role of hybridization in evolution .",
    ", 10(3):551568 , 2001 .",
    "beiko and n.  hamilton .",
    "phylogenetic identification of lateral genetic transfer events .",
    ", 6 , 2006 .    j.h . degnan and n.a .",
    "gene tree discordance , phylogenetic inference and the multispecies coalescent . , 24(6):332340 , 2009 .",
    "degnan and l.a .",
    "gene tree distributions under the coalescent process . , 59:2437 , 2005 .",
    "j.  guohua , l.  nakhleh , s.  snir , and t.  tuller .",
    "inferring phylogenetic networks by the maximum parsimony criterion : a case study . , 24(1):324337 , 2007 .",
    "d.  gusfield , s.  eddhu , and c.h .",
    "optimal , efficient reconstruction of phylogenetic networks with constrained recombination .",
    ", 2:173213 , 2004 .",
    "holland , s.  benthin , p.j .",
    "lockhart , v.  moulton , and k.t .",
    "huber . using supernetworks to distinguish hybridization from lineage - sorting .",
    ", 8:202 , 2008 .",
    "huber , b.  oxelman , m.  lott , and v.  moulton . reconstructing the evolutionary history of polyploids from multilabeled trees .",
    ", 23(9):17841791 , 2006 .",
    "r.  r. hudson .",
    "generating samples under a wright - fisher neutral model of genetic variation .",
    ", 18:337338 , 2002 .",
    "g.  jin , l.  nakhleh , s.  snir , and t.  tuller .",
    "maximum likelihood of phylogenetic networks .",
    ", 22(21):26042611 , 2006 .",
    "s.  joly , p.  a. mclenachan , and p.  j. lockhart . a statistical approach for distinguishing hybridization and incomplete lineage sorting .",
    ", 174(2):e54e70 , 2009 .    l.  s. kubatko . identifying hybridization events in the presence of coalescence via model selection .",
    ", 58(5):478488 , 2009 .    c.  r. linder and l.  h. rieseberg . reconstructing patterns of reticulate evolution in plants . , 91:17001708 , 2004 .",
    "l.  liu , l.  l. yu , l.  kubatko , d.  k. pearl , and s.  v. edwards .",
    "coalescent methods for estimating phylogenetic trees . , 53:320328 , 2009 .",
    "d.  macleod , r.l .",
    "charlebois , f.  doolittle , and e.  bapteste .",
    "deduction of probable events of lateral gene transfer through comparison of phylogenetic trees by recursive consolidation and rearrangement .",
    ".    w.  p. maddison .",
    "gene trees in species trees .",
    "46:523536 , 1997 .    j.  mallet .",
    "hybridization as an invasion of the genome . , 20(5):229237 , 2005 .",
    "j.  mallet .",
    "hybrid speciation . , 446:279283 , 2007 .",
    "c.  meng and l.  s. kubatko . detecting hybrid speciation in the presence of incomplete lineage sorting using gene tree incongruence : a model .",
    ", 75(1):3545 , 2009 .",
    "l.  nakhleh .",
    "evolutionary phylogenetic networks : models and issues . in l.",
    "heath and n.  ramakrishnan , editors , _ the problem solving handbook for computational biology and bioinformatics _ , pages 125158 .",
    "springer , new york , 2010 .",
    "l.  nakhleh , g.  jin , f.  zhao , and j.  mellor - crummey .",
    "reconstructing phylogenetic networks using maximum parsimony . in _ proceedings of the 2005 ieee computational systems bioinformatics conference ( csb2005 ) _ , pages 93102 , 2005 .",
    "l.  nakhleh , d.  ruths , and l.s .",
    "wang . : a fast and accurate heuristic for reconstrucing horizontal gene transfer . in l.",
    "wang , editor , _ proceedings of the eleventh international computing and combinatorics conference ( cocoon 05 ) _ , pages 8493 , 2005 .",
    "lncs # 3595 .",
    "park , g.  jin , and l.  nakhleh .",
    "algorithmic strategies for estimating the amount of reticulation from a collection of gene trees . in _ proceedings of the ninth annual international conference on computational systems biology _ , pages 114123 , 2010 .",
    "park , g.  jin , and l.  nakhleh . bootstrap - based support of hgt inferred by maximum parsimony .",
    ", 10:131 , 2010 .",
    "park and l.  nakhleh .",
    "inference of reticulate evolutionary histories by maximum likelihood : the performance of information criteria . , 2012 .",
    "to appear .",
    "h.j . park and l.  nakhleh . : a fast heuristic for inferring parsimonious phylogenetic networks from multiple gene trees . in _ proceedings of the international symposium on bioinformatics research and applications (",
    "isbra 12 ) _ , volume 7292 of _ lecture notes in bioinformatics _ , pages 213224 , 2012 .",
    "a.  rambaut .",
    "phylogen v1.1 . , 2012 .",
    "hybrid origins of plant species .",
    ", 28:359389 , 1997 .    c.  than and l.  nakhleh .",
    "species tree inference by minimizing deep coalescences . , 5(9):e1000501 , 2009 .    c.  than , d.  ruths , h.  innan , and l.  nakhleh . confounding factors in hgt detection : statistical error , coalescent effects , and multiple solutions . , 14:517535 , 2007 .    c.  than , d.  ruths , and l.  nakhleh . : a software package for analyzing and reconstructing reticulate evolutionary relationships . , 9:322 , 2008 .",
    "l.  van iersel , s.  kelk , r.  rupp , and d.h .",
    "phylogenetic networks do not need to be complex : using fewer reticulations to represent conflicting clusters .",
    ", 26(12):i124i131 , june 2010 .",
    "y.  wu . close lower and upper bounds for the minimum reticulate network of multiple phylogenetic trees . , 26(12):140148 , 2010 .",
    "coalescent - based species tree inference from gene tree topologies under incomplete lineage sorting by maximum likelihood . , 66:763775 , 2012 .    y.  yu , r.m .",
    "barnett , and l.  nakhleh .",
    "parsimonious inference of hybridization in the presence of incomplete lineage sorting , 2012 . under review .    y.  yu , j.h .",
    "degnan , and l.  nakhleh .",
    "the probability of a gene tree topology within a phylogenetic network with applications to hybridization detection .",
    ", 8:e1002660 , 2012 .",
    "y.  yu , c.  than , j.h .",
    "degnan , and l.  nakhleh .",
    "coalescent histories on phylogenetic networks and detection of hybridization despite incomplete lineage sorting . , 60:138149 , 2011 .",
    ".the results of running the ac - based algorithm for computing the minimum number of extra lineages given gene trees and species networks in fig . [ fig : analysis1 ] .",
    "@xmath167 is the number of configurations at the reticulation node @xmath37 and @xmath168 is the maximum number of configurations generated at a node during computation .",
    "we labeled the first node @xmath24 in post - order of traversal that contains the largest @xmath63 set by @xmath76 in fig .",
    "[ fig : analysis1 ] .",
    "furthermore , the last column is the number of valid allele mappings if using the mul - tree based method.[table : analysis1_mp ] [ cols=\"^,^,^,^,^,^,^,^ \" , ]"
  ],
  "abstract_text": [
    "<S> reconciling a gene tree with a species tree is an important task that reveals much about the evolution of genes , genomes , and species , as well as about the molecular function of genes . </S>",
    "<S> a wide array of computational tools have been devised for this task under certain evolutionary events such as hybridization , gene duplication / loss , or incomplete lineage sorting . </S>",
    "<S> work on reconciling gene tree with species phylogenies under two or more of these events have also begun to emerge . </S>",
    "<S> our group recently devised both parsimony and probabilistic frameworks for reconciling a gene tree with a phylogenetic _ network _ , thus allowing for the detection of hybridization in the presence of incomplete lineage sorting . while the frameworks were general and could handle any topology </S>",
    "<S> , they are computationally intensive , rendering their application to large datasets infeasible . in this paper </S>",
    "<S> , we present two novel approaches to address the computational challenges of the two frameworks that are based on the concept of _ ancestral configurations_. our approaches still compute exact solutions while improving the computational time by up to five orders of magnitude . </S>",
    "<S> these substantial gains in speed scale the applicability of these unified reconciliation frameworks to much larger data sets . </S>",
    "<S> we discuss how the topological features of the gene tree and phylogenetic network may affect the performance of the new algorithms . </S>",
    "<S> we have implemented the algorithms in our phylonet software package , which is publicly available in open source . </S>"
  ]
}