{
  "article_text": [
    "biological macromolecules such as dna , rna and proteins play an essential role in all living organisms .",
    "structurally , they are all chains of residues belonging to a small set of basic molecules and the functional characteristics of each macromolecule are determined by the order and composition of its components .",
    "it is therefore not surprising that comparison and alignment of biological sequences is one of the most important contributions from computational biology to modern biosciences .",
    "typical approaches to biosequence comparison are either distance- @xcite or similarity - based @xcite .",
    "the distance - based approaches minimize the cost , while those based on similarity maximize the likelihood of transformation of one sequence into another . in both cases",
    "the comparison scores for sequences are obtained by extension from scores over alphabets of basic molecules .",
    "the algorithms for computation of alignments are based on the dynamic programming technique @xcite .",
    "similarity - based methods became widely accepted because the smith - waterman algorithm @xcite allows computation of local alignments , involving only parts of sequences to be compared .",
    "local alignments are highly appropriate in biological context because elements of structure and function are usually restricted to discrete regions of biosequences and hence strong similarity of fragments of two sequences need not extend to similarity of full sequences .",
    "most distance methods have been global in nature and could not be easily adapted for local comparison .",
    "a downside of using local similarities for sequence comparison is that , while their statistics can be characterized @xcite , no constraints , apart from algorithmic ones , are placed on the form that similarity measures can take . under such conditions , sets of biosequences with similarity measures can not be identified with mathematical structures such as metric or normed spaces , which are a natural framework for many computational techniques such as clustering @xcite and indexing for similarity search @xcite .",
    "in contrast , distance measures on sequences naturally correspond to metrics under some mild restrictions .",
    "while the duality between global similarities and distances has been recognized very early @xcite , it was only recently established independently by stojmirovi @xcite and by spiro and macura @xcite that it is possible to transform local sequence similarity scores derived from many popular scoring functions on building blocks of dna and proteins into distances satisfying the triangle inequality . in the contexts in which they were presented , the results of the above two papers are almost equivalent , however , their perspectives are quite different .",
    "spiro and macura @xcite assume symmetric similarity scores and consider the transformation which converts a similarity to a metric , while @xcite converts similarity into a quasi - metric , a metric without the symmetry axiom .",
    "quasi - metrics naturally correspond to partial orders and are therefore a natural framework for local similarities .    unlike most existing literature entries , which are concerned with alignment algorithms , this paper aims to show a rigorous connection between similarities and distances that are metrics or quasi - metrics .",
    "our main results are presented in a form that allows transfer to domains that are not necessarily related to classical string transformations and for that reason we use the framework of free semigroups .",
    "we define the @xmath0-type edit distance , which generalizes the regular edit distance and allows us to consider many more scoring functions on the amino acid alphabet that fail the requirements in @xcite and @xcite .",
    "our results also allow for similarities and distances that are asymmetric . in order to have an accurate description of distances generated from similarities , we introduce a novel nomenclature .",
    "section [ sec : prelim ] presents the basic definitions .",
    "edit distances and global similarities are discussed in sections [ sec : editdist ] and [ sec : globalsim ] , respectively .",
    "our main result , theorem [ thm : localqm ] is presented in section [ sec : localsim ] and various kinds of local similarities are discussed as examples .",
    "section [ sec : matrices ] examines the applicability of our theory to the actual similarity measures used in contemporary computational biology , while section [ sec : future ] discusses some possible applications of our results and future directions .",
    "we chose to state many of the well - known results formally and to present many examples to enhance readability .",
    "the proofs of the established results are either omitted , or , when generalized in our new framework , relegated to appendix [ app : proofs ] .",
    "recall that the _ free monoid _ on a nonempty set @xmath1 , denoted @xmath2 , is the monoid whose elements , called _ words _ or _ strings _ , are all finite sequences of zero or more elements from @xmath1 , with the binary operation of concatenation .",
    "the unique sequence of zero letters ( empty string ) , which we shall denote @xmath3 , is the identity element .",
    "the _ free semigroup _ on @xmath1 , denoted @xmath4 is the subset of @xmath2 containing all elements except the identity .",
    "the length of a word @xmath5 , denoted @xmath6 , is the number of occurrences of members of @xmath1 in it . for @xmath7 , where @xmath8 , @xmath9 and we set @xmath10 .    for two words",
    "@xmath11 , @xmath12 is a _ factor _ or _ substring _ of @xmath13 if @xmath14 for some @xmath15 and @xmath12 is a _ subsequence _ or _ subword _ of @xmath13 if @xmath16 , where @xmath17 , @xmath18 and @xmath19 . for any @xmath20 , we use @xmath21 to denote the set of all factors of @xmath22 .",
    "we call a semigroup ( monoid ) @xmath23 _ free _ if it is isomorphic to the free semigroup ( monoid ) on some set @xmath1",
    ". the unique set of elements of @xmath24 mapping to @xmath1 under the isomorphism is called the set of _",
    "free generators_.    a dna molecule can be represented as a word in the free semigroup generated by the four - letter nucleotide alphabet @xmath25 .",
    "an rna molecule is a word in the free semigroup generated by the alphabet @xmath26 .",
    "a protein can be thought of as a word in the free semigroup generated by the standard twenty amino acid alphabet .",
    "[ exmp : profiles ] let @xmath1 be a set and denote by @xmath27 the set of all finite measures supported on @xmath1 .",
    "we will call the elements of the free monoid @xmath28 _ profiles _ over @xmath2 .",
    "profiles arise as models of sets of structurally related biological sequences where @xmath1 is the nucleotide or amino acid alphabet .    as a convention , for any word @xmath29 , the notation @xmath30 , where @xmath31 shall mean that @xmath32 while the notation @xmath33 shall imply that @xmath18 . for all @xmath34",
    "we shall use @xmath35 to denote the word @xmath36 and set @xmath37 .",
    "let @xmath38 .",
    "the _ canonical homomorphic extension of @xmath39 to the free monoid @xmath2 _ is a function @xmath40 such that @xmath41 and for all @xmath42 , @xmath43 .",
    "quasi - metrics are asymmetric distance functions that generalize metrics and partial orders . with their associated structures ,",
    "they belong to an area of active research in topology and theoretical computer science @xcite .",
    "we now produce the standard definitions used in the remainder of this paper .",
    "a _ quasi - metric _ on a set @xmath24 is a mapping @xmath44 such that for all @xmath45 :    a.   @xmath46 , and b.   @xmath47 .",
    "the axiom ( ii ) is known as the _ triangle inequality_. if in addition @xmath48 is symmetric , that is @xmath49 for all @xmath50 , then @xmath48 is called a _",
    "metric_. a pair @xmath51 , where @xmath24 is a set and @xmath48 a ( quasi- ) metric , is called a ( quasi- ) metric space .    for a quasi - metric @xmath48 ,",
    "its _ conjugate _ ( or _ dual _ ) quasi - metric , denoted @xmath52 , is defined on @xmath53 by @xmath54 , and its _ associated metric _",
    ", denoted @xmath55 , by @xmath56 .",
    "another frequently used symmetrization of a quasi - metric is the ` sum ' metric @xmath57 defined by @xmath58 .",
    "a ( left ) open ball of radius @xmath59 centered at @xmath60 with respect to a quasi - metric @xmath48 is the set @xmath61 .",
    "the collection of all ( left ) open balls centered at any @xmath62 with any @xmath59 is a base for a topology on @xmath24 induced by @xmath48 .",
    "this topology is in general @xmath63 but not necessarily @xmath64 . for the purpose of this paper",
    ", we will call a quasi - metric @xmath48 _ separating _ if the induced topology is @xmath64 , that is , if @xmath65 implies @xmath66 for all @xmath50 .",
    "every quasi - metric @xmath48 also has its _ associated partial order _ , denoted @xmath67 , defined by @xmath68 .",
    "a quasi - metric @xmath48 is called a _",
    "weightable quasi - metric _",
    "@xcite if there exists a function @xmath69 , called the _",
    "weight function _ or simply the _ weight _ , satisfying for every @xmath70 @xmath71 in this case we call @xmath48 _ weightable _ by @xmath72 .",
    "a quasi - metric @xmath48 is _ co - weightable _ if its conjugate quasi - metric @xmath52 is weightable .",
    "the weight function @xmath72 by which @xmath52 is weightable is called the _ co - weight _ of @xmath48 and @xmath48 is _ co - weightable _ by @xmath72 .",
    "a concept strongly related to weighted quasi - metrics is that of a _ partial metric _ @xcite .",
    "a _ partial metric _ on a set @xmath24 is a mapping @xmath73 such that for all @xmath45 :    a.   @xmath74 ; b.   @xmath75 ; c.   @xmath76 ; d.   @xmath77 .",
    "it has been shown @xcite that there is a bijection between the partial metrics and generalized weighted quasi - metrics : the transformation @xmath78 produces a generalized weighted quasi - metric with weight function @xmath79 out of a partial metric while the @xmath80 produces a partial metric out of a generalized weighted quasi - metric .",
    "waterman , smith and beyer , in their 1976 paper @xcite , introduced a general form of the edit distance on sets of words , henceforth referred to as the wsb distance .",
    "it was constructed by defining a set of allowed weighted transformations between two strings and then minimizing the sum of weights of allowed operations transforming ( in the sense of ordered composition ) one word into another .",
    "they also proposed an algorithm to compute the wsb distance based on dynamic programming .    in this section",
    ", we present a recursive definition of edit distance on a free semigroup that generalizes that of waterman , smith and beyer and describe some of its most important properties .",
    "the edit distance provides the conceptual and algorithmic foundation to both global and local similarities on free semigroups . before producing the main definition ,",
    "we formalize the concept of a _ gap penalty _ , which we will discuss in detail later in the text .",
    "let @xmath1 be a set .",
    "a positive function @xmath81 is called a _",
    "gap penalty _ over @xmath4 if for all @xmath82 , @xmath83 we denote by @xmath84 the set of all gap penalties over @xmath4 .",
    "let @xmath1 be a set , @xmath85 , and @xmath86 and @xmath87 be functions @xmath88 such that @xmath89 .",
    "let @xmath15 and let @xmath90 and @xmath91 .",
    "let @xmath92 and define the distance @xmath93 using the following recursion :    a.   @xmath94 , b.   @xmath95 for all @xmath96 , c.   @xmath97 for all @xmath98 , and d.   for all @xmath98 and @xmath96 @xmath99    the @xmath0 _ edit distance _ between the sequences @xmath22 and @xmath100 ( extending @xmath48 , @xmath86 and @xmath87 ) , is then given by @xmath101 .",
    "[ rem : gappenalties ] we have assumed that @xmath89 instead of just being positive functions in order to have @xmath102 and @xmath103 for all @xmath42 . for a general positive function @xmath104 , the function @xmath105 , given recursively for all @xmath42 by @xmath106 and @xmath107 will belong to @xmath84 and therefore @xmath108 can be used in definition of @xmath109 instead of @xmath86 .",
    "also note that the distance @xmath109 as defined does not extend @xmath48 from @xmath1 in the strict sense , that is , it is not necessarily true that for all @xmath110 , @xmath111 .",
    "however , this statement does become correct if we additionally assume @xmath112 .",
    "[ rem : wsbalgo ] the @xmath0 edit distance between @xmath22 and @xmath100 can be computed using dynamic programming algorithm of waterman , smith and beyer @xcite .",
    "let @xmath113 be an @xmath114 matrix with rows and columns indexed from @xmath115 such that @xmath116 and for all @xmath117 and @xmath118 , @xmath119 , @xmath120 , and @xmath121 then , we have @xmath122 . the original wsb distance is obtained when @xmath123 .      from the recursive definition",
    ", it follows that the @xmath0 edit distance @xmath124 can be decomposed as the @xmath0 sum of the distances of non - overlapping factors of @xmath22 and @xmath100 .",
    "this decomposition provides an optimal _ alignment _ between @xmath22 and @xmath100 .",
    "let @xmath15 .",
    "an _ alignment _ between @xmath22 and @xmath100 is a finite sequence of pairs @xmath125 , where @xmath126 , @xmath127 and for each @xmath128 either    a.   @xmath129 and @xmath130 for some @xmath131 , or b.   @xmath132 , @xmath133 and @xmath134 , or c.   @xmath135 , @xmath136 and @xmath137 .",
    "we will use @xmath138 to denote the set of all alignments of @xmath22 and @xmath100 .",
    "each pair @xmath139 corresponds to an _ edit operation _ that transforms @xmath140 into @xmath141 .",
    "pairs of the form @xmath142 , @xmath143 and @xmath144 where @xmath110 and @xmath145 represent a _ substitution _ of the letter @xmath146 for the letter @xmath147 , _ deletion _ of the word @xmath22 and _ insertion _ of the word @xmath100 , respectively .",
    "insertions and deletions are collectively called _",
    "every transformation @xmath139 can be given a weight or a cost equal to @xmath148 , with the weight of an alignment @xmath125 being equal to the @xmath0 sum of the weights of the individual transformations .",
    "the distance @xmath48 on @xmath1 provides _ substitution costs _ , while the values of @xmath86 and @xmath87 , give the costs of indels .",
    "thus , the edit distance between @xmath22 and @xmath100 can be described as the minimum weighted cost ( in the @xmath0 sense ) of transforming the sequence @xmath22 into @xmath100 using substitutions and indels as edit operations .",
    "this provides an alternative characterization of edit distance , which was long known for the @xmath149 case @xcite and which we state here in general form without proof as lemma [ lemma : aligndecomp ] below .",
    "[ lemma : aligndecomp ] let @xmath1 be a set , @xmath85 , and @xmath150 .",
    "suppose @xmath109 is an @xmath0 edit distance on @xmath2 with respect to @xmath48 , @xmath86 and @xmath87 .",
    "then , for all @xmath15 @xmath151      we now proceed to state the conditions for an @xmath0 edit distance to be a quasi - metric . for simplicity",
    "we restrict ourselves to edit distances with gap penalties that are increasing and depend solely on fragment composition and length , while more general gap penalties are considered in appendix [ app : editdist ] .",
    "[ defn : incrgap ] let @xmath1 be a set .",
    "we call a function @xmath152 _ increasing _ if for all @xmath153 , @xmath154    let @xmath1 be a set .",
    "a function @xmath155 is called a _ composition - length gap penalty _ on @xmath4 if it is increasing and has a form @xmath156 for all @xmath157 , where @xmath158 is a map @xmath159 and @xmath160 is a function @xmath161 .",
    "we denote by @xmath162 the set of all composition - length gap penalties on @xmath4 .",
    "composition - length gap penalties have a component solely dependent on the length of the inserted or deleted word and a composition - dependent component .",
    "current applications of edit distances in computational biology ( see for example @xcite ) mainly use gap penalties that are the same for insertions and deletions and depend solely on the fragment length , thus satisfying our definition of composition - length gap penalties with @xmath163 .",
    "we chose the above definition in order to include all such cases and to provide simple but sufficiently general gap penalties for consideration of global and local similarities .",
    "the requirement for composition - length gap penalties to be increasing is included because it is a necessary condition for applications of our main theorem [ thm : localqm ] .",
    "the most widely used length - dependent gap penalty functions are _ linear _ , of the form @xmath164 , and _ affine _ , of the form @xmath165 , where @xmath166 are constants .",
    "the main advantage of affine gap penalties is that the dynamic programming algorithm for computation of distances in this case can be modified to run in @xmath167 average and worst case time , where @xmath90 and @xmath91 @xcite , as opposed to @xmath168 for the most general wsb algorithm @xcite .",
    "gap penalties of the form @xmath169 have also been considered @xcite .",
    "note that the algorithmic complexity of the wsb algorithm for distances using composition - length gap penalties depends mainly on the form of @xmath160 since the composition - dependent component is linear .",
    "[ thm : editdistqm ] let @xmath1 be a set and let @xmath92 .",
    "suppose @xmath48 is a separating quasi - metric on @xmath1 and @xmath170 such that for all @xmath110 , @xmath171 and @xmath172 let @xmath173 and @xmath174 .",
    "then , the @xmath0 edit distance @xmath109 , extending @xmath48,@xmath86 and @xmath87 , is a separating quasi - metric on @xmath2 .",
    "theorem [ thm : editdistqm ] is a generalization of similar theorems for @xmath123 proven by waterman _",
    "@xcite for constant substitution costs and gap penalties depending on fragment length , and by spiro and macura @xcite in a more general setting .",
    "we state and prove a version with fewer restriction on gap penalties as theorem [ thm : editdistqm1 ] in appendix [ app : editdist ] .",
    "[ rem : invqmsemigroup ] according to @xcite , a quasi - metric @xmath48 defined on a semigroup @xmath23 is called _ invariant _ with respect to @xmath175 if for all @xmath45 , @xmath176 it is apparent from the definition that the edit distance @xmath109 on the free semigroup @xmath2 , which satisfies theorem [ thm : editdistqm ] , is invariant with respect to the string concatenation .",
    "since our @xmath0 edit distances depend on several parameters , we introduce a nomenclature to make this explicit .",
    "let @xmath1 be a set and let @xmath92 .",
    "suppose @xmath109 is an @xmath0 edit distance extending a quasi - metric @xmath48 on @xmath1 and gap penalties @xmath177 such that @xmath178",
    ". we will write @xmath179 if @xmath109 is a quasi - metric and @xmath180 if @xmath109 is a metric ( it is necessary that @xmath181 if @xmath109 is a metric ) .",
    "most ( if not all ) instances of edit distances in computer science , computational biology and pure mathematics involve the @xmath149 edit distances .",
    "below , we outline some of the well - known examples .    [",
    "ex : lev ] the _ levenstein metric _ @xcite ( the original ` string edit distance ' ) is the smallest number of permitted edit operations ( substitutions and indels ) required to transform one string into another . in our nomenclature , for a set of letters @xmath1 , the levenstein distance is realized as @xmath182 where @xmath183 for all @xmath184 and @xmath48 is the _ discrete metric _",
    ", that is , for all @xmath110 @xmath185    [ ex : sellers ] the sellers distance , introduced by sellers in 1974 @xcite , is a metric obtained by extension of a metric @xmath48 on the set @xmath186 , the set of generators plus the identity element , to the free monoid @xmath2 .",
    "it is realized as @xmath182 where @xmath187 for all @xmath184 .",
    "this construction has long been known in the theory of topological groups @xcite as the graev metric @xcite on the free group @xmath188 .",
    "recall that @xmath188 consists of all sequences of letters from the generating set @xmath1 and their inverses ; in other words , @xmath189 , where @xmath190 and @xmath191 is the set consisting of inverses of elements of @xmath1 . let @xmath192 be a metric on the set @xmath193 .",
    "the graev metric @xmath194 is then a maximal invariant metric on @xmath188 such that @xmath194 restricted to the set @xmath195 is equivalent to @xmath192 .",
    "note that the notion of invariance in this context is slightly different than the definition of an invariant quasi - metric on a semigroup from remark [ rem : invqmsemigroup ] above : a metric @xmath192 on a group @xmath23 is called _ invariant _ with respect to @xmath175 if for all @xmath45 , @xmath196 the maximality of the sellers - graev metric can also be observed in the context of the free monoid @xmath2 using the following argument .",
    "let @xmath197 where @xmath48 is a on @xmath1 and @xmath86 is a gap penalty .",
    "define a metric @xmath198 on @xmath199 by @xmath200 it is clear that @xmath109 extends @xmath198 from @xmath199 to @xmath2 .",
    "however , for every @xmath20 , @xmath201 and hence every edit distance extending @xmath198 to @xmath2 will be smaller than the sellers - graev distance .",
    "[ ex : lcs ] let @xmath1 be a set and for @xmath11 denote by @xmath202 the _ longest common subsequence _ of @xmath12 and @xmath13 .",
    "define @xmath203 it can be easily shown that @xmath192 is a metric on @xmath2 and that @xmath192 can be realized as @xmath182 where @xmath183 for all @xmath184 and @xmath204 for all @xmath110 such that @xmath205 ( cf .",
    "@xcite , pp .",
    "246 ) . since @xmath206",
    ", the optimal alignment can be expressed solely in terms of insertions and deletions .",
    "the longest common subsequence metric provides a special case of the sellers - graev metric .",
    "recall that lemma [ lemma : aligndecomp ] indicates that the total @xmath0 edit distance @xmath109 between two words @xmath22 and @xmath100 can be optimally decomposed as an @xmath0 sum of the distances between constituent factors of @xmath22 and @xmath100 .",
    "lemma [ lemma : condp ] below shows that , if the gap penalties are increasing , an arbitrary choice of a factor @xmath207 of @xmath100 decomposes the edit distance between @xmath22 and @xmath100 into @xmath0 sum of the edit distances between fragments of @xmath22 and @xmath100 . in this case , all of @xmath22 is used up while some parts of @xmath100 could be ` lost ' ( figure [ fig : decompose ] ) . a similar splitting",
    "can also be achieved with a choice of a fragment of @xmath22 .",
    "we call this property _ arbitrary decomposability . _",
    "let @xmath1 be a set , let @xmath208 be a distance function on the free monoid @xmath2 and let @xmath92 .",
    "we say that @xmath192 is _ arbitrarily decomposable of order @xmath209 _ if for all @xmath15 ,    a.   for every @xmath210 there exist @xmath211 such that @xmath212 and @xmath213 such that @xmath214 and @xmath215 b.   for every @xmath216 there exist @xmath217 such that @xmath218 and @xmath219 such that @xmath220 and @xmath221    note that if the distance function @xmath192 is symmetric , the two properties above collapse into a single one .",
    "[ lemma : condp ] let @xmath1 be a set and let @xmath85 .",
    "suppose that @xmath86 and @xmath87 are increasing functions @xmath88 such that @xmath89 and @xmath109 is an @xmath0 edit distance on @xmath2 extending @xmath48 , @xmath86 and @xmath87 .",
    "then , @xmath109 is arbitrarily decomposable of order @xmath209 .",
    "we will prove only the first part of the definition of arbitrary decomposability because the second follows by the same argument .",
    "let @xmath15 and let @xmath210 . by lemma [ lemma : aligndecomp ] , the distance @xmath124 can be written as @xmath222 where @xmath126 , @xmath127 .",
    "let @xmath223 be such that @xmath224 , @xmath225 , @xmath226 and @xmath227 ( i.e. @xmath228 is the smallest factor of @xmath100 having @xmath207 as a factor  see figure [ fig : decompose ] ) .",
    "then , the fragments @xmath229 and @xmath230 contain parts of @xmath207 .",
    "( note that @xmath207 always coincides with @xmath228 if the gap penalties depend only on composition . )",
    "consider the fragment @xmath229 . according to lemma [ lemma : aligndecomp ]",
    ", @xmath229 can be either a letter ( @xmath231 ) or a fragment ( @xmath232 ) , since the possibility of @xmath233 was explicitly excluded .",
    "if @xmath231 , let @xmath234 and @xmath235 so that @xmath236 . on the other hand , if @xmath237 , then by lemma [ lemma : aligndecomp ] @xmath238",
    "let @xmath239 be fragments of @xmath229 such that @xmath240 and @xmath241 ( i.e. we split @xmath229 into a part not overlapping with @xmath207 and a part overlapping with it ) .",
    "it is possible that @xmath234 but we always have @xmath242 by construction . by our assumption about increasing gap penalty",
    ", it follows that @xmath243    in a similar way , the fragment @xmath230 can be expressed as @xmath244 where @xmath245 ( i.e. @xmath246 contains the end of @xmath207 ) and @xmath247    now , let @xmath248 , @xmath249 and @xmath250 .",
    "let @xmath251 and @xmath252 .",
    "then , @xmath253 , @xmath254 and @xmath255 since @xmath256 is an alignment of @xmath257 and @xmath207 and hence the @xmath0 sum of distances over it is greater than @xmath258 by lemma [ lemma : aligndecomp ] .",
    "therefore , any @xmath0 edit distance with composition - length gap penalties is arbitrarily decomposable of order @xmath209 .",
    "however , there exist arbitrarily decomposable distances that are not @xmath0 edit distances .",
    "[ ex : gaplessdist ] let @xmath1 be a finite set and let @xmath48 be a metric on @xmath1 . for any @xmath259 , the _ generalized hamming distance",
    "_ @xmath260 on @xmath261 is given for all @xmath262 by @xmath263 it can be easily shown that @xmath260 is a metric . the generalized hamming distance is a natural generalization of the hamming distance @xcite where the distance @xmath48 on @xmath1 is the discrete metric .",
    "let @xmath38 be a function such that for all @xmath110 , @xmath264 it immediately follows that for every @xmath259 and for all @xmath262 , @xmath265 define the distance @xmath266 by extending @xmath260 and @xmath39 so that for all @xmath15 , @xmath267    using ( [ eqn : normpairhamming ] ) , it is easy to show that @xmath192 is a metric on @xmath2 .",
    "furthermore , @xmath192 is arbitrarily decomposable ( of order @xmath268 ) . indeed ,",
    "consider @xmath15 and @xmath210 . if @xmath269 , one immediately obtains the required decomposition using the form of the generalized hamming distance . on the other hand , if @xmath270 , we have @xmath271 leading to the decomposition where @xmath272 and @xmath12 and @xmath13 take all of @xmath100 apart from @xmath207 .    the metric @xmath192 ( generalized to @xmath0 form ) can be interpreted as an ` ungapped ' version of edit distances . here",
    "substitutions are allowed only between sequences of equal length and the function @xmath273 plays a role of gap penalty so that the only way to transform sequences of unequal length is through a full deletion followed by insertion .",
    "a more common approach to sequence comparison is to maximize similarities instead of minimizing distances . in this case",
    "a similarity measure on @xmath1 and gap penalties are used to define the similarity between two sequences in @xmath2 using the needleman - wunsch @xcite or smith - waterman @xcite dynamic programming algorithm , which are very similar to the algorithm for computation of edit distances described above . as in the case of @xmath0 edit distances",
    "above , we define sequence similarities using a recursive definition .    let @xmath1 be a set , @xmath274 , and let @xmath275 .",
    "for any @xmath15 where @xmath90 and @xmath91 , define the _ global ( needleman - wunsch ) similarity _ @xmath276 using the following recursion :    a.   @xmath277 , b.   @xmath278 for all @xmath96 , c.   @xmath279 for all @xmath98 , and d.   for all @xmath98 and @xmath96 @xmath280    the global similarity between the sequences @xmath22 and @xmath100 ( extending @xmath281 , @xmath105 and @xmath282 ) , is defined by @xmath283 .    the algorithm used to compute @xmath149 edit distance ( remark [ rem : wsbalgo ] )",
    "can also be used for computation of similarities by setting @xmath284 , @xmath285 and @xmath286 , computing @xmath109 for @xmath123 and then taking @xmath287 .",
    "the running time of the dynamic programming algorithm depends on the properties of gap penalties , as discussed in the previous section .",
    "note that the gap penalty functions are positive in the case of both distances and similarities , being added in the former case and subtracted in the latter .",
    "it is also possible to express global similarity as a sum of similarities over alignments , as is done for edit distance in lemma [ lemma : aligndecomp ] .",
    "[ ex : lcs1 ] it is well known @xcite that the longest common subsequence problem described in example [ ex : lcs ] can be approached using similarities rather than distances .",
    "let @xmath1 be a set and let @xmath281 be a scoring function on @xmath1 such that @xmath288",
    "if @xmath205 and @xmath289 . let @xmath290 for all @xmath42 .",
    "it is easy to confirm that for @xmath15 , @xmath291 .",
    "relations between global similarities and @xmath149 edit distances were explored early on @xcite .",
    "let @xmath292 be the global similarity with respect to @xmath293 and @xmath282 such that for all @xmath42 , @xmath294 , where @xmath160 is a positive function .",
    "consider the @xmath149 edit distance @xmath109 , extending @xmath85 and the gap penalties @xmath86 and @xmath87 and let @xmath295 .",
    "suppose for all @xmath110 @xmath296 and for all @xmath42 , @xmath297 then , @xmath292 and @xmath109 will induce equivalent sets of optimal alignments and for all @xmath15 , @xmath298    the distance function obtained by taking a constant minus similarity is not guaranteed to satisfy any of the axioms for a metric or a quasi - metric : one problem is that the self - similarity @xmath299 for any @xmath20 is not necessarily a constant . however , under some more restrictive but frequently valid assumptions , it is possible to transform similarities into metrics or quasi - metrics .",
    "we establish the results that have interesting biological interpretations and provide the foundation for considering transformation of local similarities , discussed in section [ sec : localsim ] , to quasi - metrics .",
    "let @xmath24 be a set and let @xmath281 be a ( similarity ) map @xmath300 .",
    "we call @xmath281 a _ sane _ scoring function if for all @xmath50 ,    a.   @xmath301 , b.   @xmath302 , and c.   @xmath303 .",
    "thus , a similarity map is sane if every element of @xmath1 ` keeps its identity ' with respect to it .",
    "every point is similar to itself and this similarity can not be smaller than similarity to any other point .",
    "[ lemma : selfsim ] let @xmath1 be a set and let @xmath274 be a a sane scoring function over @xmath1 .",
    "suppose @xmath275 and @xmath292 the global similarity on @xmath2 with respect to @xmath304 and @xmath105 .",
    "then , @xmath292 is a sane scoring function and for all @xmath20 , @xmath305    proposition [ lemma : selfsim ] and theorem [ thm : editdistqm ] give us a straightforward way to convert global similarities to ( quasi- ) metrics .",
    "since this transformation is based on the transformations of similarity scores to distances on generators , we first introduce additional nomenclature .",
    "[ defn : alphnomen ] let @xmath1 be a set and let @xmath92 . for a sane scoring function @xmath281 on @xmath1 , we will use @xmath306 to denote the distance @xmath307 on @xmath1 given by @xmath308 and @xmath309 to denote the distance @xmath48 on @xmath1 given by @xmath310    note that at this stage we do not make an assumption that @xmath306 is a quasi - metric nor that @xmath309 is a metric .",
    "[ cor : simdist2 ] let @xmath1 be a set and let @xmath92 .",
    "suppose @xmath281 is a sane scoring function on @xmath1 , @xmath311 is a quasi - metric on @xmath1 and @xmath170 such that @xmath312 and @xmath313 let @xmath292 be the global similarity with respect to @xmath293 and @xmath282 and let @xmath314 and @xmath315 for all @xmath42 .",
    "then , the @xmath0 edit distance @xmath179 is given for all @xmath15 by the formula @xmath316    as with edit distances , we now introduce a nomenclature for quasi - metrics and metrics obtained from similarities .",
    "let @xmath1 be a set and let @xmath92 .",
    "suppose @xmath109 is an @xmath0 edit distance obtained from a global similarity @xmath292 on @xmath2 using the formula ( [ eqn : qm ] ) of corollary [ cor : simdist2 ] , where @xmath292 extends @xmath317 and @xmath170",
    ". we will write @xmath318 if @xmath109 is a quasi - metric and @xmath319 if @xmath109 is a metric .",
    "the above nomenclature is redundant , in that every distance derived from similarities using corollary [ cor : simdist2 ] can be expressed using the nomenclatures for edit distances and distances on @xmath1 introduced in definition [ defn : alphnomen ] .",
    "we have chosen to nevertheless introduce the additional notation in order to emphasize that the distances on the free monoid are derived from similarities and also because the computation of distances can be performed using algorithms for similarities .",
    "this notation will also be convenient in the following sections , where local similarities are discussed .",
    "[ ex : gmp ] let @xmath1 be a set and suppose @xmath281 is a sane symmetric function @xmath320 and @xmath321 , depending only on length .",
    "this is a very frequent setup in pairwise comparison of dna and protein sequences ( see section [ sec : matrices ] below for more detailed discussion ) .",
    "define for all @xmath110 , @xmath322 and for all @xmath42 , @xmath323 and @xmath324 .",
    "suppose that the distance @xmath325 is a metric on @xmath1 .",
    "since @xmath281 is sane , @xmath326 is also sane and we have @xmath327 therefore , since @xmath105 depends solely on length , the requirements ( [ eq : gapcond1 ] ) and ( [ eq : gapcond2 ] ) of corollary [ cor : simdist2 ] are satisfied .",
    "let @xmath292 be the global similarity extending @xmath293 and @xmath105 and let @xmath328 be the global similarity extending @xmath329 and @xmath330 .",
    "we conclude that the distance @xmath109 given by @xmath331 is the metric @xmath332 .",
    "this metric can also be expressed as @xmath333 , where @xmath334 for all @xmath42 .",
    "local similarity is computed using the smith - waterman algorithm @xcite .",
    "let @xmath1 be a set , @xmath274 , and let @xmath275 .",
    "let @xmath15 , @xmath90 and @xmath91 .",
    "smith - waterman _ dynamic programming matrix , denoted @xmath335 , is an @xmath114 matrix @xmath336 with rows and columns indexed from @xmath115 such that @xmath337 and for all @xmath98 and @xmath96 , @xmath338 , @xmath339 and @xmath340 the _ local similarity _ between the sequences @xmath22 and @xmath100 ( given @xmath281 , @xmath105 , and @xmath282 ) , denoted @xmath341 , is defined to be the largest entry of @xmath336 , that is , @xmath342 .",
    "local similarity between two words can be realized as global similarity of their fragments .",
    "[ thm : globloc2 ] let @xmath1 be a set , @xmath274 and @xmath275 .",
    "suppose @xmath292 is a global similarity extending @xmath293 and @xmath282 and @xmath343 is the local similarity with respect to @xmath293 and @xmath282 .",
    "then , for all @xmath15 , @xmath344    although conversion of global similarities to distances outlined in section [ sec : globalsim ] is relatively straightforward , its counterpart for local similarity is much less so .",
    "we now use the results from the previous sections to state our main result : construction of quasi - metrics which include conversions of local similarities .",
    "[ thm : localqm ] let @xmath1 be a set and let @xmath92 .",
    "let @xmath192 be a separating quasi - metric on @xmath2 that is arbitrarily decomposable of order @xmath209 .",
    "suppose @xmath39 is a strictly positive and @xmath345 is a non - negative function @xmath159 and @xmath273 and @xmath346 are the canonical homomorphic extensions of @xmath39 and @xmath345 , respectively , to the free monoid @xmath2 .",
    "assume also that for all @xmath15 , @xmath347 then , the function @xmath348 defined by @xmath349 is a quasi - metric on @xmath2 .",
    "let @xmath350 .",
    "since @xmath351 and @xmath352 for any @xmath353 , @xmath354 and since @xmath192 is a quasi - metric and hence positive , it follows that @xmath355 .",
    "furthermore , it is clear that @xmath356 .",
    "suppose that @xmath357 .",
    "then , there exist @xmath353 and @xmath354 such that @xmath358 . since @xmath359 , @xmath360 and @xmath361 for any @xmath362 , it follows that @xmath363 , @xmath364 and @xmath365 .",
    "the first statement implies that @xmath366 since @xmath39 is a strictly positive function , while the last means that @xmath367 ( since @xmath192 is a separating quasi - metric ) .",
    "therefore , @xmath357 implies @xmath368 .",
    "hence , @xmath369 implies @xmath368 and @xmath370 and thus @xmath66 .    to establish the triangle inequality",
    "suppose that @xmath371 for some @xmath353 , @xmath372 and @xmath373 for some @xmath374 and @xmath375 .",
    "write out @xmath376 , @xmath377 where @xmath378 , @xmath379 , @xmath380 and @xmath381 .",
    "if @xmath382 and @xmath383 overlap , that is , if @xmath384 or @xmath385 , let @xmath207 denote the whole overlapping fragment ( for example , if @xmath386 , @xmath387  see figure [ fig : overlap ] ) . if @xmath382 and @xmath383 do not overlap or either @xmath382 or @xmath383 is identity , let @xmath388 .",
    "since @xmath192 is arbitrarily decomposable of order @xmath209 , there exist @xmath389 such that @xmath390 and @xmath391 such that @xmath392 and @xmath393 furthermore , by the same assumption , there exist @xmath394 such that @xmath395 and @xmath396 such that @xmath397 and @xmath398    therefore , using the minkowski inequality , @xmath399    since @xmath273 and @xmath346 are additive functions that satisfy the inequality ( [ eqn : holderrho ] ) and since @xmath207 is the full extent of the overlap between @xmath382 and @xmath383 , we have @xmath400 and @xmath401 hence , by the triangle inequality for @xmath192 , @xmath402 as required .    we have shown in the separation part of the proof of theorem [ thm : localqm ] above that @xmath403 and hence the associated partial order of the quasi - metric @xmath404 is @xmath405 .",
    "if @xmath345 is a strictly positive function , @xmath406 is a separating quasi - metric and the partial order is trivial : @xmath407 implies @xmath66 and hence each point is only comparable to itself .",
    "however , if @xmath345 is zero everywhere , then @xmath407 and @xmath408 implies that @xmath22 is a factor of @xmath100 while @xmath100 is not a factor of @xmath22 , so that @xmath22 and @xmath100 are non - trivially comparable . in this case , the quasi - metric @xmath406 is not separating and it generalizes the substring partial order : for every @xmath15 such that @xmath368 , we have @xmath357 .",
    "therefore , @xmath409 can be interpreted as measuring how far is @xmath22 from being a factor of @xmath100 .",
    "since the identity @xmath3 is a trivial factor of every word and @xmath41 , it follows that ( in the case of @xmath410 ) @xmath411 for every @xmath42 , in contrast to @xmath412 . on the other hand",
    ", it can be easily seen that @xmath413 and hence for all @xmath414 , @xmath415 .",
    "we now introduce a nomenclature for quasi - metrics and their associated metrics defined in theorem [ thm : localqm ] .",
    "let @xmath1 be a set and let @xmath92 .",
    "suppose @xmath192 is a separating quasi - metric on @xmath2 and @xmath39 and @xmath345 are functions @xmath159 that satisfy all the requirements of theorem [ thm : localqm ] with respect to @xmath192 and @xmath209 .",
    "let @xmath406 be the quasi - metric obtained using the formula ( [ eq : localqm ] ) of theorem [ thm : localqm ]",
    ". we will write @xmath416 if @xmath406 is a quasi - metric and @xmath417 if @xmath406 is a metric .",
    "edit distances described in section [ sec : editdist ] are always global : they measure the full cost of transformation between two words in @xmath2 . indeed , a truly ` local ' distance , that is the distance measured on factors of words being compared , would not satisfy the triangle inequality .",
    "the @xmath418 distances are slightly different .",
    "the distance @xmath192 contributes to @xmath406 by evaluating the pair of factors @xmath419 and @xmath382 that are ` closest ' to each other ( relative to @xmath273 and @xmath346 ) , while @xmath273 and @xmath346 score the left - over pieces of @xmath22 and @xmath100 , respectively .",
    "the extent of @xmath419 and @xmath382 relative to @xmath22 and @xmath100 depends on the exact choice of functions @xmath39 and @xmath345 and their relation to the distance @xmath192 .",
    "for example , when @xmath39 and @xmath345 are very large compared to @xmath192 , the factors @xmath419 and @xmath382 will approach the whole sequences @xmath22 and @xmath100 . on the other hand , if @xmath39 and @xmath345 are small , they will contribute most to @xmath420 , depending on the exact properties of @xmath192 .    when both @xmath39 and @xmath345 are strictly positive , the @xmath418 distance has a global character in that the whole of @xmath22 and @xmath100 are accounted for .",
    "if @xmath410 , only @xmath22 contributes to the distance as a whole ; the sequence @xmath100 contributes only through its factor closest to a factor of @xmath22 . in general",
    ", it is possible to favor @xmath22 or @xmath100 by appropriately choosing the values of @xmath39 and @xmath345 .",
    "theorem [ thm : localqm ] can be applied to similarities in the following manner .",
    "let @xmath416 .",
    "define a global similarity @xmath421 on @xmath2 by @xmath422 then , @xmath423 hence , if @xmath421 can be computed using the needleman - wunsch algorithm ( that is , if @xmath192 is an @xmath0 edit distance ) , then @xmath406 can always be evaluated by using the smith - waterman algorithm to compute the local similarity @xmath424 and then using equation ( [ eq : localsimqm ] ) .    since the functions @xmath39 and @xmath345 as well as the quasi - metric @xmath192 are arbitrary , the applicability of theorem [ thm : localqm ] to similarities is very wide .",
    "the following examples are simple corollaries of theorem [ thm : localqm ] and the results in sections [ sec : editdist ] and [ sec : globalsim ] that have important uses in computational biology .",
    "let @xmath1 be a finite set and suppose @xmath281 is a sane symmetric function @xmath320 such that the distance @xmath425 , is a metric on @xmath1 .",
    "let @xmath426 and let @xmath427 .",
    "it is clear from the definitions of @xmath39 and @xmath48 that @xmath428 .",
    "let @xmath192 be the arbitrarily decomposable metric extending the generalized hamming distance based on @xmath48 and @xmath39 to @xmath2 , as in example [ ex : gaplessdist ] and define @xmath429 by @xmath430 . by theorem [ thm : localqm ] we can construct the distance @xmath431 , which is in fact the metric @xmath432 .",
    "the underlying similarity @xmath421 , given by equation ( [ eq : localsimqm ] ) , is @xmath433 where @xmath434 . in computational biology applications",
    ", @xmath435 will be negative ( there will be at least two points in @xmath1 that are dissimilar ) and hence the local similarity will always be realized by aligning the fragments of the same length .",
    "therefore , the local similarity based on @xmath421 is _ gapless similarity _ , which has considerable historical importance since the first version of blast @xcite suite of tools for sequence database search based on local similarities used a heuristic that computed gapless alignments .",
    "gapless alignments had an advantage that they could be computed faster and the statistics of similarity scores arising from them were well characterized @xcite .    in the following examples [ ex : qmlocsim1 ] , [ ex : qmlocsim2 ] and [ ex : mlocsim ]",
    ", we will assume that @xmath274 is a sane scoring function , @xmath170 only depend on length and @xmath436 and @xmath437 are global and local similarity with respect to @xmath281 , @xmath105 and @xmath282 , respectively .",
    "in addition , let @xmath438 for all @xmath439 .",
    "[ ex : qmlocsim1 ] suppose @xmath440 is a quasi - metric . by corollary [ cor : simdist2 ] ,",
    "the distance @xmath441 on @xmath2 given by @xmath442 is a quasi - metric @xmath443 .",
    "consider the distance @xmath444 .",
    "it is easy to see that @xmath445 and hence @xmath446 as remarked earlier , the partial order associated with @xmath404 in this case is subfragment partial order .",
    "furthermore , the triangle inequality for @xmath404 is equivalent to @xmath447    if @xmath437 is symmetric , that is , if @xmath281 is symmetric and @xmath448 , we have @xmath449 and hence @xmath404 is a co - weightable quasi - metric and @xmath450 is a partial metric .",
    "note that in this case , the triangle inequality ( [ eqn : sim2qm011 ] ) is exactly equivalent to the triangle inequality for the symmetrization @xmath451 ( example [ ex : mlocsim ] ) , that is , if @xmath452 is a metric then @xmath404 is a quasi - metric .",
    "the fact that equation ( [ eqn : sim2qm01 ] ) gives a quasi - metric was first established in @xcite .",
    "indeed , the two generate equivalent neighborhoods : for any @xmath20 , the set of all points @xmath453 such that @xmath454 is equal to the set @xmath455 where @xmath456 .    [ ex : qmlocsim2 ] recall the notation from example [ ex : gmp ] , where @xmath281 is symmetric , @xmath448 , @xmath322 , @xmath323 and @xmath324 .",
    "let @xmath457 and @xmath458 be global and local similarity with respect to @xmath326 , @xmath459 and @xmath330 , respectively .",
    "suppose that @xmath460 is a quasi - metric ( equivalently that @xmath309 is a metric ) and consider the quasi - metric @xmath461 . by the argument of example [ ex : qmlocsim1 ] , @xmath462 however , in this case the local similarity @xmath463 is clearly asymmetric .",
    "this similarity score has , to our knowledge , never been previously used for sequence comparison , although it can be easily computed using smith - waterman algorithm ( provided that the particular implementation used allows composition - length gap penalties ) .",
    "it has the advantage that it is still true that @xmath458 is topologically equivalent to @xmath464 and that @xmath464 corresponds to the subfragment partial order .",
    "the asymmetry of @xmath458 may be exploited to favor the integrity of one sequence over the other in biological sequence alignments .",
    "for example , in cases where translated dna sequences are compared to proteins , it is desirable to emphasize the protein sequence , which is ` real ' ( experimentally established ) , at the expense of translated dna sequences , which is only hypothetical .",
    "we intend to evaluate the broad utility of using variants of @xmath458 and @xmath464 for biological sequence comparisons in a subsequent publication .",
    "[ ex : mlocsim ] making the same assumptions as in example [ ex : qmlocsim2 ] above , consider the metric @xmath465 .",
    "it is easy to see that @xmath452 is indeed a metric given by @xmath466    equation ( [ eqn : sim2m01 ] ) , for @xmath123 , was extensively considered in computer science and computational biology .",
    "the @xmath467 similarities ( examples [ ex : lcs ] and [ ex : lcs1 ] ) are related to distances in this way .",
    "@xcite proposed using @xmath452 as a distance on sets of protein sequences but did not explicitly prove it was a metric .",
    "spiro and macura @xcite have given the conditions under which @xmath452 is indeed a metric .",
    "since @xmath437 is here assumed symmetric , this result is equivalent to @xmath468 being a quasi - metric ( example [ ex : qmlocsim1 ] ) , established by stojmirovi @xcite under slightly different assumptions .",
    "@xcite derived the same result as a corollary of a more general inequality for similarities that relied on the finiteness of the generator alphabet . in a poster abstract @xcite , fischer proposed the general form of equation ( [ eqn : sim2m01 ] ) with arbitrary @xmath209 as a way to convert similarities to distances and stated without proof the conditions for @xmath452 to be a metric .    for @xmath469",
    ", the form of equation ( [ eqn : sim2m01 ] ) resembles the formula for the canonical metric in inner - product vector spaces . in this case ,",
    "@xmath22 and @xmath100 would be vectors and @xmath437 would be a positive - definite bilinear form .",
    "theorem [ thm : localqm ] can be applied in the context of free abelian monoids with no change .",
    "we illustrate this by a very simple , followed by a more biologically relevant example .",
    "let @xmath1 be the set of all prime numbers and let @xmath2 be the free abelian monoid over @xmath1 under multiplication ( i.e. the set of natural numbers @xmath470 ) .",
    "let @xmath198 be a discrete metric on @xmath1 ( here we implicitly assume that @xmath1 includes @xmath268 ) and let @xmath471 and @xmath472 for all @xmath439 .",
    "let @xmath192 be the sellers - graev metric extension of @xmath198 to @xmath470 .",
    "it is clear that @xmath473 is just the number of different prime factors between @xmath22 and @xmath100 ( the non - matching prime factors are matched to @xmath268 ) and that it is arbitrarily decomposable .",
    "hence , we can apply theorem [ thm : localqm ] to obtain a quasi - metric @xmath406 , so that @xmath409 is the number of prime factors of @xmath22 not in common to @xmath100 .",
    "the global similarity @xmath421 on @xmath470 ( here equivalent to local similarity ) , given by @xmath474 evaluates to the number of common prime factors ( excluding @xmath268 ) between @xmath22 and @xmath100 .",
    "let @xmath1 be a finite set and let @xmath475 denote the free abelian monoid generated by the set of all words of length exactly @xmath476 ( we will call @xmath477 a @xmath476-tuple ) .",
    "members of @xmath475 are therefore multisets of @xmath476-tuples .",
    "now consider the same structure as in the previous example .",
    "let @xmath198 be a discrete metric on @xmath478 and let @xmath471 and @xmath472 for all @xmath439 .",
    "let @xmath192 be the sellers - graev metric extension of @xmath198 to @xmath475 .",
    "all requirements of theorem [ thm : localqm ] still apply .",
    "the value @xmath409 is the number of @xmath476-tuples that are contained in @xmath22 but not in @xmath100 and the global ( and local ) similarity @xmath421 gives the number of @xmath476-tuples common to both @xmath22 and @xmath100 .",
    "the similarity @xmath421 has been used in computational biology as a computationally inexpensive approximation of global similarity between two sequences @xcite .",
    "each sequence is mapped to @xmath475 by taking the multiset of all of its ( overlapping ) @xmath476-tuples and the similarity @xmath421 is used to approximate the global similarity @xmath436 .",
    "in the previous sections we have made no assumption on the set of generators @xmath1 and all our results apply to arbitrary sets . however , as we noted before , the principal objects motivating our results are sets of biological sequences and profiles derived from them .",
    "the former two sets are finite and therefore the scoring functions over them are given by _",
    "score matrices_. we therefore proceed to discuss the similarity and distance measures on the sets of nucleotides , amino acids and profiles and their applicability to our theory .",
    "the nucleotide alphabet consists of only 4 letters ( ` a ` , ` c ` , ` g ` , and ` t ` ) and the score matrices most frequently used for database search depend on only two parameters , for scoring a match or a mismatch of two nucleotides .",
    "for example , the _ blastn _ program , a part of the blast @xcite suite of tools for sequence database search based on local similarities , which searches a dna database with a dna sequence as a query , uses the scoring matrix of the form @xmath479 the above scoring function is obviously sane and the distance @xmath311 is a discrete metric for any @xmath92 .",
    "therefore , all match / mismatch scoring schemes satisfy the requirements of theorem [ thm : editdistqm ] and its corollaries .",
    "more complex score matrices , where transitions ( changes ` c`@xmath480`t ` and ` a`@xmath480`g ` ) have different scores than transversions ( all other mutations ) have been proposed for improving the accuracy of database searches @xcite .",
    "it is easy to show that the distance @xmath440 ( and hence @xmath306 for all @xmath209 ) will still satisfy the triangle inequality and hence be a metric if the value of distance associated by transition is not greater than twice the transversion distance . since the likelihood and hence the similarity score of transition is larger than that of transversion , this condition is very likely to be satisfied in practice .",
    "for example , all scoring matrices examined by states _",
    "@xcite satisfy this condition and are sane .      unlike the nucleotide alphabet , the standard amino acid alphabet consists of 20 amino acids of markedly different chemical properties and structural roles .",
    "hence , the regularly used amino acid scoring matrices are much more complex than the matrices over nucleotides discussed above .",
    "many amino acid scoring matrices were developed over the years for various purposes , including sequence similarity search , structural prediction and phylogenetic analysis @xcite .",
    "most of them arise from analysis of sets of peptide sequences known to be to a certain extent related .",
    "dayhoff _ et al . _",
    "@xcite proposed in 1970s the family of scoring matrices called pam , which were based on a markov model of evolution of proteins .",
    "pam matrices were the original standard choice for sequence comparison .",
    "several improved versions of pam matrices were constructed later @xcite , in order to address some of the deficiencies arising from lack of sufficient data at the time of the construction of the original pam family . for pam - like matrices ,",
    "the larger the number appended to their name ( such as pam-@xmath481 ) , the sequences to be compared are assumed to have more diverged in evolution .",
    "presently , the most widely used family of scoring matrices is blosum , derived by henikoff and henikoff in 1992 @xcite using an empirical procedure . in particular ,",
    "the blosum62 matrix has long been believed to be among the best performing matrices for general sequence similarity search @xcite and is used as default by blast ( more specifically , the _ blastp _ program ) .",
    "in contrast to the pam - like matrices , the larger the number appended to the name of a blosum matrix , the more the sequences to be compared are assumed to be closely related .",
    "in addition to the above mentioned families , some score matrices were constructed specifically for searches involving transmembrane regions of proteins @xcite while others were derived from structural alignments in order to improve sensitivity of searches involving distantly related proteins @xcite .",
    ".number of triples of amino acids failing the triangle inequality for distances derived from various symmetric score matrices .",
    "all the matrices are considered over the standard ( 20 letter ) amino acid alphabet ( that is , excluding non - standard letters representing more than one amino acid ) . due to symmetry of similarity scores ,",
    "the triangle inequalities for @xmath482 and @xmath483 are equivalent and the column for @xmath483 is omitted . [",
    "cols=\"<,^,>,>,>\",options=\"header \" , ]     table [ tbl : compadj ] shows the violations of the triangle inequality for the distances obtained from some of the matrices from table [ tbl : blosumqm ] , adjusted to take into account the amino acid compositions of proteomes of bacterial species _ clostridium tetani _ and _ mycobacterium tuberculosis_. both of these species have compositionally biased genomes and proteomes .",
    "the matrices were constructed using a newtonian procedure described in @xcite and @xcite .",
    "the background distribution for the second sequence comes from the original blosum62 matrix . in this way",
    ", the constructed similarity scores and distances can be used to compare sequences known to come from the above organisms to sequences from general datasets .",
    "table [ tbl : blosumqm ] and table [ tbl : compadj ] demonstrate that most scoring matrices , both symmetric and asymmetric , can be converted to the @xmath484 metric while many can be converted to @xmath485 quasi - metric as well .",
    "in contrast , most matrices fail the triangle inequalities for @xmath482 and @xmath483 .",
    "therefore , our generalization of edit distances and related sequence similarities to @xmath0 form allows us to use a much wider class of matrices to construct ( quasi- ) metrics on the set of all protein sequences .",
    "this is in contrast to the @xmath149-type results from the previous work @xcite , which only apply to the blosum family plus a few more similar matrices .",
    "recall ( example [ exmp : profiles ] ) that given a set @xmath1 , a profile over @xmath1 is a word in the free monoid @xmath28 , that is , a finite sequence of finite measures over @xmath1 .",
    "in biological applications , @xmath1 is finite and therefore a profile @xmath22 can be treated as a sequence of vectors @xmath486 , where @xmath487 . for each @xmath488 ,",
    "the vector @xmath489 has non - negative entries . in some applications",
    ", it is further assumed that @xmath490 is a probability distribution , that is , that @xmath491 .    in biological context ,",
    "profiles represent generalized sequences over the basic alphabet @xmath1 where each position has a probability distribution of letters instead of a single letter .",
    "they were originally introduced by gribskov _",
    "@xcite in order to improve sensitivity of homology search by considering the information contained in multiple alignments of related proteins to query sequence databases . to do so",
    ", a _ position specific score matrix _ or pssm , which gives a similarity score for each letter in @xmath1 for each position in the query profile , is constructed .",
    "the profile - sequence comparison using pssm can then be performed using the dynamic programming algorithms such as needleman - wunsch or smith - waterman .",
    "profiles can also be used directly in probabilistic hidden markov models @xcite .",
    "profile - based homology searches are widely used and have been shown in general to be more sensitive than sequence database searches with normal sequences as queries @xcite .",
    "profiles can also be compared to other profiles as members of the free monoid @xmath28 using distances or similarities discussed in sections [ sec : editdist ] , [ sec : globalsim ] and [ sec : localsim ] : all that is necessary is to assign a distance or similarity measure on @xmath27 and gap penalties .",
    "many scoring schemes were proposed in due course and we present only a few examples below . for a more detailed overview",
    "we refer the reader to the papers of edgar and sjlander @xcite and marti - renom _ et al . _",
    "@xcite , which study their performance for aligning distantly related protein sequences .",
    "let @xmath492 be two measures in @xmath27 and let @xmath493 and @xmath494 denote a similarity and a distance function , respectively .",
    "the symbol @xmath495 denotes the @xmath496 norm on @xmath497 .",
    "the simplest similarity score between two vectors , used in clustalw software for multiple sequence alignment @xcite ( see also section [ sec : future ] ) is to compute their average over a score matrix @xmath281 on @xmath1 : @xmath498 in general , @xmath499 and @xmath500 are not a quasi - metric or a metric , respectively .    a natural candidate for similarity score between two",
    "vectors @xmath501 and @xmath490 is their dot product , used in @xcite : @xmath502 clearly , @xmath503 is the standard euclidean distance : @xmath504    a variation of the above is the correlation coefficient or cosine of the angle between two vectors used in the lama algorithm @xcite : @xmath505 here @xmath503 can be easily shown to satisfy the triangle inequality . in general , @xmath506 does not separate points , but if @xmath501 and @xmath490 are assumed to be probability vectors , then @xmath506 is indeed a metric .",
    "the jensen - shannon divergence between two probability vectors @xmath501 and @xmath490 , denoted @xmath507 is given by @xmath508.\\ ] ] while @xmath507 is not a metric , taking the square root , that is , letting @xmath509 does give a metric @xcite .",
    "yu @xcite proposed using this metric to compare probability distributions that are components of profiles while yona and levitt @xcite used the following similarity score : @xmath510 where @xmath511 denotes a background distribution .",
    "the above examples suggest that @xmath496-type edit distances and global and local similarities arising from them , could be appropriate for profile - profile comparisons .",
    "our results provide a way to construct a large variety of metrics and quasi - metrics on free semigroups .",
    "in particular , we are able to extend the conversion of similarity score matrices into alphabet ( generator ) distances , to the corresponding conversions of sequence similarities , global and local , to sequence distances .",
    "hence , we are able to treat biosequence sets as spaces with geometry .",
    "the metric and quasi - metric structures provide a much richer framework than the topologies induced from them : for biosequences , @xmath1 is finite and hence all topologies induced from @xmath0 edit distances or local similarity ( quasi- ) metrics are equivalent to the discrete topology .    in terms of statistical characterization ,",
    "since we allowed more general gap penalties and asymmetric scoring matrices , the established statistics for similarities may not be fully transfered to our general distances .",
    "for this reason , to fully exploit our general formulation , it is important to further elaborate on its statistical aspects , which is beyond the scope of the current paper .",
    "apart from setting a general geometric framework for sequence comparison , most direct applications to biology involve clustering .",
    "for example , global clustering of protein sequences has been performed @xcite , using the metric from example [ ex : mlocsim ] and other derivations from similarity score .",
    "however , these works did not consider quasi - metrics and partial orders that could provide a more accurate view of the global protein sequence space .",
    "applications to indexing and multiple sequence alignment , which we discuss in more detail below , can also be considered as clustering .",
    "one of the principal motivations for establishing the triangle inequalities for similarity scores in the literature @xcite was to accelerate similarity search of large dna and protein sequence databases .",
    "it has been identified early on that using the full needleman - wunsch and smith - waterman dynamic programming algorithms to search sequence datasets by sequentially scanning all entries is prohibitively computationally expensive and heuristic methods such as fasta @xcite and blast @xcite were developed .",
    "while very fast , these methods are not _ consistent _ @xcite , that is , they are not guaranteed to retrieve all true neighbors of a given query point .",
    "furthermore , both fasta and blast sequentially scan all of the sequences in the dataset being searched .",
    "the idea behind using the triangle inequalities for accelerating similarity search is to use the intrinsic ` geometry ' of the dataset and the space it lies in to construct an _ indexing scheme _",
    "@xcite , a structure that allows fully retrieving a similarity query without scanning the whole dataset .",
    "a large amount of effort was spent on producing efficient indexing structures , principally concentrating on datasets that are equipped with a metric or a vector space structure : a good overview is by hjaltason and samet in @xcite .",
    "let @xmath512 be a finite sequence dataset .",
    "a range query of @xmath24 based on local similarity @xmath437 ( depending on the score matrix @xmath281 and gap penalties @xmath105 and @xmath282 ) , centered at the query point @xmath20 with threshold @xmath513 is the set @xmath514 we will now consider some ways to construct an indexing structures that accelerate retrieval of @xmath515 .    the first way is to consider biological sequences purely as strings with simple similarity measures often related to levenstein distance and use string - based techniques such as hashing @xcite or suffix arrays @xcite .",
    "such indexing schemes are often not consistent but may show good performance on datasets of dna sequences where the similarity measure is very simple . for proteins ,",
    "one approach was to construct a biologically meaningful metric on the amino acid alphabet and use the edit distance extension of it for sequence comparison and indexing @xcite .",
    "this has an advantage that existing methods for indexing metric spaces can be directly applied but ignores the need for local similarities , which can not be converted into edit distances .",
    "the other approach , investigated by spiro and macura @xcite and more thoroughly implemented by itoh _",
    "@xcite , was to use the inequality ( [ eqn : sim2qm011 ] ) , which holds for some amino acid scoring matrices ( table [ tbl : blosumqm ] ) .",
    "the idea is to cluster proteins according to the local similarity score @xmath437 or associated metric @xmath516 ( where similarity score is assumed symmetric and @xmath438  see example [ ex : mlocsim ] ) , and then , when searching , to compare the query sequence to centers of clusters first and only scan those clusters that overlap the query .",
    "note that while the neighborhoods of @xmath468 are indeed equivalent to queries @xmath515 , this is no longer true for neighborhoods of its metric symmetrization @xmath516 .",
    "hence , direct indexing with respect to the local similarity metric may not be optimal . furthermore",
    ", not all similarity score matrices give rise to @xmath149 quasi - metrics @xmath440 ( table [ tbl : blosumqm ] ) .",
    "many more can be converted to @xmath517 and hence give rise to metrics @xmath518 .",
    "profile - profile comparison methods , relying on inner product for the distance between two distributions , also naturally induce @xmath496-type distances .",
    "none of the methods described above can efficiently cope with this situation and yet there exists a simple way to convert such similarity queries to a sequence of metric queries .",
    "suppose @xmath519 is a metric for some symmetric local similarity @xmath437 .",
    "let @xmath520 we call each set @xmath521 a _ fiber _ and it is obvious that @xmath2 is a disjoint union of all @xmath521 , where @xmath522 runs over the range of self - similarities . for our applications , this range is finite because the sequence datasets are finite .",
    "now consider a query @xmath523 and let @xmath524 .",
    "it is easily established that @xmath525 where @xmath526 ( the closed ball of radius @xmath527 about @xmath22 ) .    hence , to process each local similarity range query , it is sufficient to process a metric range query @xmath528 on each fiber and then collect the results . for practical purposes the fibers need to be reasonably large and small in number , but that is often true because the score matrices are integer - valued .",
    "adjacent fibers that contain too few points can be merged if care is exercised when collecting final results .",
    "each fiber can be indexed separately as a metric space with one of the many existing access methods @xcite or by using a new technique .",
    "the decomposition ( [ eq : fibers ] ) was proposed in @xmath149 form in @xcite for indexing similarity - based range queries and was in turn inspired by decomposition of weightable quasi - metric spaces into fibers used by vitolo @xcite .",
    "therefore , using fibers , a consistent indexing scheme can be constructed for most existing local similarity measures on biological sequences and profiles .",
    "the performance of such schemes is not guaranteed ",
    "it depends on the exact geometry of sequence datasets @xcite .",
    "hence , our theoretical results represent only the first step towards efficient and consistent access methods that are to be achieved in future .    an alternative to fiber decomposition for cases where @xmath529 is truly a",
    "quasi - metric is to use the quasi - metric directly to index the dataset .",
    "pestov and stojmirovi @xcite proposed the concept of a quasi - metric tree : a general indexing scheme for retrieving queries based on quasi - metrics and established conditions for its consistency . note that in the @xmath149 case , using inequality ( [ eqn : sim2qm011 ] ) directly , as in @xcite , produces a structure that is equivalent to a quasi - metric tree .",
    "multiple sequence alignment ( msa ) is among the most valuable tools in computational biology .",
    "it allows extracting and representing biologically important commonalities from sets of sequences @xcite .",
    "construction of multiple alignments from sets of sequences has been extensively researched and a variety of techniques have been proposed @xcite .",
    "the full dynamic programming algorithm for msa is np - complete @xcite and therefore heuristics are commonly employed .",
    "one popular heuristic approach is progressive alignment @xcite .",
    "first , a guide tree is constructed from pairwise dissimilarities between sequences .",
    "then , larger and larger groups of sequences are aligned in pairwise manner , following the branching order of the guide tree from the leaves towards the root .",
    "a number of popular software packages for msa of protein sequences @xcite implement this heuristics .",
    "the success of this approach , greedy in nature , crucially depends on a faithful and evolutionarily meaningful construction of a guide tree for the set of sequences to be aligned . when constructing their guide trees , most methods do not use a true metric to compute pairwise distances @xcite , while those that do @xcite , use the levenstein distance , overlooking the similarities between closely related amino acids .",
    "there are advantages in using the true metric distance for agglomerative hierarchical clustering .",
    "for example , the triangle inequality ensures the transitivity of closeness in distance measure .",
    "furthermore , when this is the case , it was shown that the difference between a hierarchical clustering and the optimal @xmath476-clustering is bounded @xcite .    in this paper",
    "we have demonstrated a way to construct a large class of ( quasi-)metric distances from similarity scores that also naturally account for functional relatedness among amino acids .",
    "the quasi - metrics developed in section [ sec : localsim ] can also provide a rigorous way to naturally interpolate from global to local similarities in constructing guide trees .",
    "let @xmath530 be the metric symmetrizing the quasi - metric @xmath531 , where @xmath532 for all @xmath15 .",
    "observe that by the triangle inequality for @xmath406 , @xmath533 and hence , letting @xmath534 , we have @xmath535    flood , in his phd thesis @xcite and a followup paper @xcite called any pair @xmath536 , where @xmath192 is a metric and @xmath86 a positive function , which satisfies the above property ( [ eqn : normedpair ] ) , a _",
    "normed pair_. the triple @xmath537 , where @xmath536 is a norm pair on @xmath24 , is called a _",
    "every normed space @xmath538 naturally becomes the normed set by setting @xmath539 and @xmath540 .",
    "for any two normed sets @xmath541 and @xmath542 , a function @xmath543 is called a contraction if for all @xmath544 , @xmath545 and for all @xmath546 , @xmath547 according to a result of flood @xcite ( see also @xcite ) , the normed pair structure supports a natural embedding of @xmath24 into a banach space with a certain universal property .",
    "let @xmath548 be a normed set .",
    "there exists a complete normed space @xmath549 and an embedding of @xmath24 into @xmath549 as a normed subset such that every contraction @xmath550 from @xmath24 to a complete normed space @xmath551 lifts to a unique linear contraction @xmath552 .",
    "the pair consisting of @xmath549 and embedding @xmath553 is essentially unique .",
    "elements of @xmath24 are linearly independent .",
    "therefore , spaces of biological sequences with local similarity metric may be founded upon banach ( or even hilbert ) spaces .",
    "however , this result carries only theoretical significance at this point and can not be directly used for clustering or indexing since the free banach space @xmath549 is too large ( it is not desirable that all sequences are linearly independent ) .",
    "nevertheless , the same idea can be used to embed similarity score matrices into finite dimensional normed spaces and hence consider biological sequences as free semigroups over @xmath497 .",
    "a.s . is very grateful to vladimir pestov who as his ph.d . and postdoctoral supervisor read and commented on the early versions of this manuscript .",
    "was supported by the university of ottawa research funds .",
    "this work was supported by the intramural research program of the national library of medicine at national institutes of health .",
    "[ thm : editdistqm1 ] let @xmath1 be a set , let @xmath92 and suppose @xmath48 is a separating quasi - metric on @xmath1 , @xmath554 and @xmath109 is the @xmath0 edit distance extending @xmath48,@xmath86 and @xmath87 .",
    "in addition , assume that for all @xmath110 , @xmath153 ,        let @xmath350 .",
    "clearly , @xmath124 is non - negative since all of @xmath48 , @xmath86 and @xmath87 are non - negative .",
    "also , @xmath563 .",
    "now suppose @xmath564 .",
    "applying lemma [ lemma : aligndecomp ] , we have @xmath565 where @xmath126 , @xmath127 , implying @xmath566 for all @xmath476 since @xmath109 is non - negative .",
    "hence , @xmath567 for all possible cases of @xmath140 and @xmath141 because @xmath48 is a separating quasi - metric and @xmath86 and @xmath87 are strictly positive on @xmath4 .",
    "we will demonstrate the triangle inequality by relying on the minkowski inequality : for any two sequences @xmath146 and @xmath147 of real numbers and @xmath92 , @xmath568 we show by induction that for all @xmath569 , @xmath570 and @xmath571 , @xmath572 let @xmath573 denote a partial order on @xmath574 where @xmath575 if @xmath576 or @xmath577 and @xmath578 or @xmath577 and @xmath579 and @xmath580 ( lexicographic order ) .",
    "the relation @xmath573 is a well - founded partial order of type @xmath581 ( in this case our induction is finite ) and our claim is trivially true for @xmath582 .",
    "assume it is true for all @xmath583 .",
    "there are nine possibilities in total to consider for @xmath584 .",
    "* case 4 : * suppose @xmath594 , for some @xmath595 ( this covers additional two possibilities ) . using lemma [ lemma : aligndecomp ] ,",
    "let @xmath596 be the smallest integer not larger than @xmath597 such that @xmath598 for some @xmath599 , where @xmath600 , and @xmath601 .",
    "note that @xmath602 if and only if @xmath603 , where @xmath604 . in that case , by our assumption ( w7 ) and by minkowski inequality , @xmath605 of course , the same inequality trivially holds if @xmath606 .        * case 5 : * the remaining case is @xmath612 for some @xmath595 and @xmath613 .",
    "the proof for this case exactly mirrors the proof for the previous case , now depending on the assumptions ( w2 ) , ( w4 ) , ( w6 ) and ( w8 ) .    in general the assumptions ( w1 ) ",
    "( w8 ) are sufficient for @xmath109 to be a quasi - metric but not necessary , except in the case of @xmath123 . for example , let @xmath614 , @xmath615 , @xmath181 , @xmath616 , @xmath617 , @xmath618 . in this case the assumptions ( w1 ) and ( w2 ) fail but it can be verified that the triangle inequality for @xmath109 does not fail for any @xmath619 .",
    "the assumptions ( w1)(w8 ) can be significantly simplified if the gap penalties take a more restricted form .",
    "for example , if the gap penalties are increasing , the assumptions ( w5)(w8 ) can be removed .",
    "this restriction is sensible in applications to biological sequence comparisons because algebraic interactions lowering the effective length of the sequence are not allowed . on the other hand ,",
    "if @xmath2 is replaced as the underlying set with a monoid which is not free , or even a group , then gap penalties can not be increasing in the above sense .",
    "since composition - length gap penalties are increasing by definition , theorem [ thm : editdistqm ] is a direct corollary of theorem [ thm : editdistqm1 ] .",
    "furthermore , composition - length gap penalties with @xmath163 , such as linear or affine , satisfy all of ( w1)(w8 ) .",
    "let @xmath1 be a set and let @xmath274 be a a sane scoring function over @xmath1 .",
    "suppose @xmath275 and @xmath292 the global similarity on @xmath2 with respect to @xmath304 and @xmath105 .",
    "then , @xmath292 is a sane scoring function and for all @xmath20 , @xmath305    we will make use of the following lemma , equivalent to lemma [ lemma : aligndecomp ] for distances .",
    "it was likewise proved by smith and waterman @xcite for the @xmath149 case and less general gap penalties .",
    "now suppose @xmath42 and let @xmath626 such that @xmath627 .",
    "let @xmath628 and @xmath629 .",
    "then , @xmath630 since @xmath281 is sane and the whole of @xmath22 is accounted for in fragments indexed by @xmath631 and @xmath441",
    ". therefore , @xmath632 implying @xmath633 and @xmath634 . in the same way it can be shown that @xmath635 and hence that @xmath292 is sane .",
    "let @xmath1 be a set and let @xmath92 .",
    "suppose @xmath281 is a sane scoring function on @xmath1 , @xmath311 is a quasi - metric on @xmath1 and @xmath170 such that @xmath171 and @xmath636 let @xmath292 be the global similarity with respect to @xmath293 and @xmath282 and let @xmath314 and @xmath315 for all @xmath42 .",
    "then , the @xmath0 edit distance @xmath179 is given for all @xmath15 by the formula @xmath637    by construction , @xmath638 and by proposition [ lemma : selfsim ] , @xmath639 as well . by our assumptions on @xmath48 , @xmath105 and @xmath282 and by theorem",
    "[ thm : editdistqm ] , it follows that @xmath109 , the @xmath0 edit distance extending @xmath48 , @xmath86 and @xmath87 , is indeed the separating quasi - metric @xmath640 on @xmath2 .",
    "we will now show by recursion that this quasi - metric is equivalent to the one given by equation ( [ eqn : qm_new ] ) .",
    "m.  o. dayhoff , r.  m. schwartz , and b.  c. orcutt . a model of evolutionary change in proteins . in m.",
    "o. dayhoff , editor , _ atlas of protein sequence and structure _ , volume  5 , chapter  22 , pages 345352 . national biomedical research foundation , 1978 .",
    "i.  fischer .",
    "similarity - preserving metrics for amino - acid sequences .",
    "poster at the 22nd gif meeting on challenges in genomic research : neurodegenerative diseases , stem cells , bioethics , heidelberg 2002 .",
    "j.  m. hellerstein , e.  koutsoupias , and c.  h. papadimitriou . on the analysis of indexing schemes .",
    "in _ proceedings of the sixteenth acm sigact - sigmod - sigart symposium on principles of database systems ( pods97 ) ( tucson , arizona , may ) _ , pages 249256 , 1997 .",
    "nonsymmetric distances and their associated topologies : about the origins of basic ideas in the area of asymmetric topology . in _ handbook of the history of general topology , vol .",
    "3 _ , volume  3 of _ hist .",
    "_ , pages 853968 .",
    "kluwer acad .",
    "publ . , dordrecht , 2001 .",
    "r.  mao , w.  xu , n.  singh , and d.  p. miranker .",
    "an assessment of a metric space database index to support sequence homology . in _",
    "3rd ieee international symposium on bioinformatics and bioengineering ( bibe 2003 ) , ( bethesda , maryland , march 2003 ) _ , pages 375384 , 2003 .",
    "s.  g. matthews .",
    "partial metric topology . in _",
    "papers on general topology and applications ( flushing , ny , 1992 ) _ , volume 728 of _ ann . new york acad .",
    "_ , pages 183197 .",
    "new york acad .",
    ", new york , 1994 .",
    "z.  tan , x.  cao , b.  c. ooi , and a.  k.  h. tung .",
    "the ed - tree : an index for large dna sequence databases . in _",
    "ssdbm2003 : proceedings of the 15th international conference on scientific and statistical database management _ , pages 151160 , washington , dc , usa , 2003 .",
    "ieee computer society .",
    "j.  d. thompson , d.  g. higgins , and t.  j. gibson .",
    ": improving the sensitivity of progressive multiple sequence alignment through sequence weighting , position - specific gap penalties and weight matrix choice .",
    ", 22(22):46734680 , november 1994 ."
  ],
  "abstract_text": [
    "<S> we introduce a geometric framework suitable for studying the relationships among biological sequences . </S>",
    "<S> in contrast to previous works , our formulation allows asymmetric distances ( quasi - metrics ) , originating from uneven weighting of strings , which may induce non - trivial partial orders on sets of biosequences . </S>",
    "<S> the distances considered are more general than traditional generalized string edit distances . in particular </S>",
    "<S> , our framework enables non - trivial conversion between sequence similarities , both local and global , and distances . </S>",
    "<S> our constructions apply to a wide class of scoring schemes and require much less restrictive gap penalties than the ones regularly used . </S>",
    "<S> numerous examples are provided to illustrate the concepts introduced and their potential applications . </S>"
  ]
}