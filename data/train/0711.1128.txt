{
  "article_text": [
    "classifying items with respect to their properties is a fundamental and very old problem .",
    "if the properties are inherent to the objects , the difficulty is deciding first how many groups are required and then establishing the discrimination thresholds for each .",
    "the matter becomes more complicated when instead of the inherent properties , one tries to classify elements based on mutual interactions .",
    "of course , such classifications would be very useful for a better understanding of the mechanisms underlying the behavior of systems encountered in scientific disciplines as diverse as sociology , biology or physics @xcite .",
    "as an example , consider social systems which are often modeled as networks .",
    "the vertices represent individuals and the edges interactions between them .",
    "these interactions can be of many types : friendship , belonging to the same club or school , working together , etc . in these graphs , it is important to be able to group the nodes into what is commonly known as _",
    "communities_. that is , groups of vertices that share a higher number of connections among themselves than with the rest of the network @xcite ( see also @xcite for a recent review ) .",
    "this partition bears information on which persons have a stronger interdependence and may allow to predict the actors that drive the dynamics of the group as a whole . in biology , on the other hand , network methods have been used to understand gene regulatory patterns @xcite . here",
    "each vertex corresponds to a gene and an edge contains information on how the associated protein regulates the synthesis of the protein associated to the second gene . since regulation of gene activity plays a fundamental role in the functioning of the cell @xcite , the community structure points towards the different functional subunits ( see @xcite and references therein ) .",
    "given the relevance of communities , the last years have seen an increase in the number of techniques proposed to detect them . to name a few :",
    "some of them are based on the concept of betweenness ( number of paths passing through a link ) and modularity @xcite , others on synchronization of oscillators @xcite or on other dynamical systems running on the network @xcite , detection of overlapping cliques @xcite or the diffusion of random walkers @xcite .",
    "nevertheless , communities are not the only relevant information that can be extracted from networks .",
    "it is also possible to search for vertices with similar connection patterns ( not necessarily having connections among themselves , as in the case of communities ) that are expected to play equivalent functional roles . in the social networks literature",
    "such nodes are referred to as _ structurally equivalent _",
    "@xcite and have lead to an analysis of social networks based on _ block modeling _ @xcite . in many types of networks , like those formed by webpages or social actors ,",
    "the connection between nodes is often due to some intrinsic properties of the nodes , which we will refer to henceforth as their `` contents '' .",
    "thus it is possible to consider an alternative point of view in which a network structure arises as a result of node contents , leading one to the notion of contents - based networks @xcite .    in many cases ,",
    "network analysis approaches based on communities and those based on some form of node similarity are aimed towards the understanding of very different questions . when viewed within the framework of contents based networks , however , these differences disappear as will be argued below",
    ". we will also show that an extension of newman and leicht s expectation maximization ( em ) method @xcite is well - suited for uncovering content - based structure underlying a network , inverting in practice the process that lead to its formation .",
    "the organization of the paper is as follows : in section ii , content based networks are formally introduced .",
    "next , we describe in section iii our generalization of the em method to directed graphs . in section iv",
    ", we show how the em method can be used to solve the inverse problem , namely to recover the underlying contents - based structure from a given network .",
    "we present in section v analytical results regarding the application of the em method to contents - based networks and the recovery of the contents - based structure .",
    "these results will be complemented with a numerical study in sections vi and vii . in section vii ,",
    "we consider a more realistic situation and ask to what extent an underlying contents - based structure can be recoverred in the presence of disorder in the connections .",
    "finally , we summarize our results and present the conclusions in section viii .",
    "let us define first content - based networks . consider a set of nodes @xmath2 each of which has a _ content _ @xmath3 assigned with @xmath4 , and where @xmath5 are labels for the possible contents .",
    "the structure of the connectivity pattern of the associated content - based network is determined by the function @xmath6 , which is defined for all ordered pairs of contents @xmath7 .",
    "the adjacency matrix of the graph is then given by @xmath8    we see immediately that nodes having the same contents @xmath9 also have the same connection patterns , and thus are structurally equivalent @xcite . as explained before",
    ", this can imply a functional equivalence in the process that generated the network .",
    "the point of view that we will take in this article is to regard contents - based networks as ideal networks , from which the `` real '' networks are obtained through alteration or removal of some of the connections .",
    "note that the range of topologies that can be generated via contents - based network is very broad : if the connectivity function @xmath10 shows a close to diagonal configuration , the network will be formed by a set of almost insulated cliques .",
    "the ideal configuration would be a family of independent communities without interconnections .",
    "another configuration that can be easily reproduced with content - based networks are bipartite graphs . in its most simplest from ,",
    "it is enough to allow the nodes to take one of two possible contents and letting the connectivity function @xmath11 to be non - zero only for the off - diagonal elements .",
    "much more complicated connectivity patterns can be actually achieved by introducing finer contents distinctions and more intricate connectivity functions .",
    "thus a content based graph can in general include all sorts of combinations between community - like and/or multipartite graphs , as can be seen in the example plotted in figure 1 .",
    "another point to note is that originally these networks were proposed in a context where the relation between contents was an order relation @xcite .",
    "this implies that the relation between nodes is not symmetric and the network is therefore more naturally represented by a directed graph . in this case , the connectivity function @xmath11 is non - symmetric in its arguments .",
    "apart from directionality , realistic graphs may present , as well , a certain degree of disorder in their connection patterns .",
    "this effect can be incorporated into the mathematical description by regarding the values of @xmath10 as probabilities of having a link from a node of content @xmath9 to a node of content @xmath12 .",
    "this view transforms the content - based network into a hidden variable graph @xcite .",
    "as we will see later , the em method is still able to extract information from networks produced in this way but the failure rate increases the further @xmath10 deviates from a binary - valued function .    , red @xmath13 , blue @xmath14 , magenta @xmath15 , cyan @xmath16 , olive @xmath17 and orange @xmath18).,width=264 ]    contents",
    "based networks have proven to be very useful in the description of phenomena that include an underlying relation of hierarchy or ordering .",
    "the simplest way of achieving such a relation is to associate with each node a string of letters and letting the relation between any two nodes be based on string inclusion : namely that one string is contained as an uninterrupted subsequence in the other .",
    "networks generated from random strings in this manner have been successfully used to model receptor - ligand interactions in the immune system @xcite , and the transcription factor based gene regulatory network in yeast @xcite .    in this article ,",
    "our goal is to address the _ inverse _ problem : given a network of which we know nothing in advance , is it possible to decide whether there is an underlying contents - based structure and , if so , can we deduce the class membership of its nodes and the class connectivity function ?",
    "moreover , can this be achieved in the presence of noisy connections ? seen in this way , the problem at hand becomes one of statistical inference , very well - suited to em methods @xcite .",
    "given a graph @xmath19 of @xmath20 nodes and an adjacency matrix @xmath21 , the expectation maximization ( em ) algorithm @xcite searches for a partition of the nodes into @xmath22 groups such that a certain log - likelihood function for the graph is maximized .",
    "henceforth we will refer to the groups into which the em method divides the nodes , as _",
    "classes_. note that @xmath22 must not be confused with the number of contents @xmath23 , described in the previous section .",
    "ideally , the optimal number of classes would be @xmath23 , but a criterion independent from the em algorithm is required to determine its value since we assume that in general @xmath23 will not be known in advance .",
    "the variables of the algorithm are the probabilities @xmath24 that a randomly selected node is assigned to class @xmath25 , with @xmath26 , and the set of probabilities @xmath27 of having a connection from a node belonging to class @xmath25 to a certain node @xmath28 . assuming that the functions @xmath29 and @xmath30 are given , the probability @xmath31 of realizing the given graph under a node classification @xmath32 , such that @xmath33 is the class that node @xmath34 has been assigned to , can be written as @xmath35 ,    \\label{eqn : nl_lh}\\ ] ] @xmath31 is the likelihood to be maximized , but it turns out to be more convenient to consider its logarithm instead @xmath36.\\ ] ] treating the a priori unknown class assignment @xmath33 of the nodes as statistical `` unknown data '' , one introduces next the auxiliary probabilities @xmath37 that a node @xmath34 is assigned to class @xmath25 , and considers the averaged log - likelihood constructed as @xmath38.\\ ] ] the maximization of @xmath39 must be performed taking into account the following normalization conditions for the probabilities @xmath30 and @xmath29 @xmath40 the final results are @xmath41 where @xmath42 is the total degree of node @xmath34 .",
    "the still unknown probabilities @xmath43 are then determined a posteriori by noting that @xmath44 from which one obtains @xmath45 eqs .",
    "( [ eqn : pinl ] ) , ( [ eqn : thnl ] ) and ( [ eqn : qnl ] ) form a set of self consistent equations for @xmath46 and @xmath24 that any extremum of the expected log - likelihood must satisfy .",
    "thus , given a graph @xmath19 , the em algorithm consists of picking a number of classes @xmath47 into which the nodes are to be classified and searching for solutions of eqs .",
    "( [ eqn : pinl ] ) , ( [ eqn : thnl ] ) and ( [ eqn : qnl ] ) .",
    "these equations were derived by newman and leicht @xcite .",
    "they also showed that when applied to diverse type of networks the resulting @xmath43 and @xmath27 yield useful information about the internal structure of the network .",
    "note that only a minimal amount of a priori information is supplied : the number of classes @xmath47 and the network .    ) .",
    "the solution a ) comes together with values for @xmath48 for all the nodes and classes , while the solution b ) , which has a lower likelihood , produces @xmath49 for all the nodes in one class and a very small probability for the other .",
    "the plot on the right , solution c ) , is the output offered by the generalization of em with values of @xmath43 virtually one and/or zero.,width=264 ]    however , the em method in the form presented so far does not yet serve our purposes for the following reason : as remarked before , content - based networks are usually represented as directed graphs .",
    "the probability @xmath27 was defined as the probability that a node @xmath28 receives a directed connection from a node belonging to class @xmath25 .",
    "together with the normalization condition for @xmath27 , eq .  ( [ eqn : thnorm ] ) , this implies that the classification must be such that each class @xmath25 has at least one member with non - zero out - degree .",
    "this constraint forces the em algorithm to classify a simple bi - partite graph in the manner depicted in figures 2a or 2b . from a content - based point of view",
    ", on the other hand , the classification that would be more natural is the one displayed figure 2c which is forbidden by the condition of eq .",
    "( [ eqn : thnorm ] ) .",
    "this difficulty is not resolved by re - defining @xmath27 instead as the probability that a node @xmath28 makes a directed connection _ to _ a node belonging to class @xmath25 , since now the classification must be such that each class @xmath25 has at least one member with non - zero in - degree .",
    "we therefore have to generalize the em approach in such a way that the node directionality does not restrict the possible classification of the nodes .",
    "this can be achieved by introducing the probabilities    * @xmath50 of having a uni - directional link from a vertex of class @xmath25 to a node @xmath34 , * @xmath51 of having a uni - directional link from node @xmath34 to a node in class @xmath25 , and * @xmath52 of having a bidirectional link between @xmath34 and a node in class @xmath25 .    with these new definitions",
    "( [ eqn : nl_lh ] ) becomes @xmath53 .",
    "\\nonumber \\label{prob2 } \\end{aligned}\\ ] ] the likelihood can now be written as @xmath54 \\right ] \\right ) , \\nonumber \\\\",
    "\\label{lbardirected}\\end{aligned}\\ ] ] which has to be maximized under the following constraint on the probabilities @xmath27 , @xmath55 implying that there is no isolated node .",
    "the probability @xmath24 , that a randomly selected node belongs to class @xmath25 , is again given by eq .",
    "( [ eqn : pinl ] ) .    introducing the lagrange multipliers",
    "@xmath56 and @xmath57 , to incorporate the constraints , eqs .",
    "( [ eqn : pinorm ] ) and ( [ eqn : thdirnorm ] ) , the expression to be extremized becomes @xmath58 as before , the extremal condition on @xmath59 with respect to @xmath30 gives us @xmath60 where @xmath20 is the total number of nodes .",
    "differentiating @xmath59 with respect to the @xmath29 variables , we get @xcite @xmath61 putting together the three previous expressions and summing over the index of the nodes @xmath28 , we obtain the following result for the lagrange multipliers @xmath62 where @xmath63 , @xmath64 and @xmath65 are the in - degree , out - degree and bi - directional degree of node @xmath34 , respectively . inserting this relation into the previous set of equations , we extract the new extremal conditions for",
    "the @xmath29 s @xmath66 these expressions have to be again supplemented with the self - consistent equation for @xmath43 which now reads @xmath67    note that when we have only bi - directional links so that @xmath68 , it follows from eq .",
    "( [ eqn : thetarj ] ) that @xmath69 .",
    "thus we recover the original em equations under the identification @xmath70 .",
    "it is easily shown that the solutions of the em equations , eqs .",
    "( [ eqn : pinl ] ) , ( [ eqn : thetarj ] ) and ( [ eqn : q_ir ] ) , are such that if two nodes @xmath34 and @xmath28 are structurally equivalent , _",
    "i.e. _ @xmath71 as well as @xmath72 , for all @xmath73 then they will be classified in the same manner : @xmath74 , and @xmath75 , @xmath76 and @xmath77 for all @xmath25 .",
    "this property of the solutions obtained from the em methods renders it very well - suited for detecting any underlying contents - based structure .",
    "one important shortcoming of the em method is that @xmath47 has to be provided as an external parameter .",
    "the algorithm lacks a means to evaluate how good a classification is , and consequently one can not decide which number of classes furnishes an optimal classification of the nodes of a graph . to overcome this problem , we propose to define a measure of the quality of a classification as follows : @xmath78 where the sum runs over all the nodes @xmath34 and classes @xmath25 .",
    "@xmath0 is the average entropy of the classification and as such measures the certainty with which the nodes are assigned to their respective classes .",
    "one can easily see that @xmath79 . for a sharp classification @xmath80 , while the worst - case scenario occurs when @xmath81 .",
    "we will later argue that @xmath0 is a useful statistic to infer @xmath47 .",
    "once an optimal classification has been found , it is possible to determine the connectivity structure among the classes . given an em classification , we will define @xmath82 as the probability that a node in class @xmath25 has a connection to one in class @xmath83 .",
    "this probability can be estimated as @xmath84 by noting that @xmath85 is the posterior probability that given that a node has been assigned to class @xmath25 , the node is @xmath34 . the second term on the right hand side of eq .",
    "( [ eqn : ctilde ] ) must be included as a correction for the absence of self - connections , since by convention , we assume that @xmath86 for all @xmath34 .",
    "@xmath82 , as defined above , is the probability of regarding a connection between two nodes in the graph as being one between nodes of type @xmath25 and @xmath83 . as we will show in the following section ,",
    "if the underlying graph is a contents - based network , a successful application of the em algorithm should result in sharp assignments of nodes into classes and @xmath82 should thus be binary valued ( and moreover be equal to the connectivity function @xmath87 ) .",
    "it is possible to also define a measure of how close the connectivity function resembles one that corresponds to a content - based network by considering the entropy for @xmath88 , @xmath89 we have that @xmath90 .",
    "the maximum of @xmath1 occurs when @xmath91 , i.e. when none of the classes have any preferred connection pattern to any class .",
    "the generalization of the em method , the entropies @xmath0 , @xmath1 and the estimation of @xmath82 are in general applicable to any kind of graph . however , for the purpose of this article we will focus only on their applications to content - based networks .",
    "we will address the general case in a subsequent work @xcite , where we will also show that contents - based networks play a special role for the classifications of the em method .",
    "assume that we are given a contents - based graph @xmath19 that has been constructed from a set of nodes of unknown contents , and an unknown connectivity function @xmath10 .",
    "in this setting , we suppose that the optimal number of classes @xmath47 has already been found and that it is equal to the number of contents @xmath23 .",
    "we would like to know under which conditions the em algorithm can infer the class membership of the nodes as well as the connectivity function .",
    "in other words , given the adjacency matrix @xmath21 , we are looking for a solution of the generalized em equations , eqs .",
    "( [ eqn : thetarj ] ) and ( [ eqn : q_ir ] ) , with @xmath92 along with the unknown class - connectivity function @xmath82 that ideally should coincide with the original @xmath10 .",
    "note that the ansatz eq .",
    "( [ eqn : leakfree ] ) implies that for such a solution @xmath80 .    substituting the above ansatz into eq .",
    "( [ eqn : thetarj ] ) , we find @xmath93 } { \\bar{k}_r^i +   \\bar{k}_r^o - \\bar{k}_r^b } \\nonumber \\\\ { \\overrightarrow}{\\theta}_{rj } & = & \\frac{c(r , x_j ) \\ , \\left [ 1 - c(x_j , r ) \\right ] } { \\bar{k}_r^i +   \\bar{k}_r^o - \\bar{k}_r^b } \\label{eqn : theqs }   \\\\ { \\overleftrightarrow}{\\theta}_{rj } & = & \\frac{c(r , x_j ) c(x_j , r ) } { \\bar{k}_r^i + \\bar{k}_r^o - \\bar{k}_r^b } ,   \\nonumber\\end{aligned}\\ ] ] where @xmath94 , @xmath95 and @xmath96 are the average in - degree , out - degree and bi - directional degree of nodes belonging to class @xmath25 , @xmath97 so that @xmath98 is the total degree of each of the @xmath99 nodes belonging to class @xmath25 .",
    "note that in eq .",
    "( [ eqn : theqs ] ) , the node index @xmath28 enters only through its content @xmath100 , so that @xmath27 is the same for all the nodes that have the same content as @xmath28 .",
    "the same turns out to be true for the @xmath43 .",
    "we thus have @xmath101 for all nodes @xmath34 such that @xmath102 , and from eq .",
    "( [ eqn : q_ir ] ) we obtain @xmath103^{c(t , s ) \\ , ( 1-c(s , t ) ) }    \\right .",
    "\\nonumber \\\\   & \\times &   \\left [ c(s , r ) \\ , ( 1-c(r , s ) )   \\right ] ^{c(s , t ) \\ , ( 1-c(t , s ) ) } \\ , \\nonumber \\\\ & \\times & \\left . \\left",
    "[ c(r , s ) \\ , c(s , r ) \\right ] ^{c(t , s)\\ , c(s , t ) } \\right \\ } , \\label{eqn : cbcondition}\\end{aligned}\\ ] ] where @xmath104 is the normalization constant for @xmath105 .",
    "we now have to consider the conditions on @xmath106 , and @xmath107 such that given the classes @xmath25 and @xmath108 , the terms in the product on the right hand side of eq .",
    "( [ eqn : cbcondition ] ) are non - zero for all @xmath83 , when @xmath109 , and zero for at least one @xmath83 when @xmath110 .",
    "this is a statement about the kind of connections that the nodes of type @xmath25 and @xmath108 make to or receive from nodes of all possible classes @xmath83 .",
    "an inspection of the @xmath111 type terms in the product shows that their contribution to @xmath105 is non - zero if and only if the following two conditions are satisfied for all @xmath83 :    * if there is a connection between @xmath108 and @xmath83 , there must be also a connection between @xmath25 and @xmath83 of the same kind , namely either in , out , or bi - directional .",
    "* whenever there is no connection between @xmath108 and @xmath83 , there can be any kind of connection between @xmath25 and @xmath83 , as well as none at all .",
    "the satisfaction of both conditions can be regarded as constituting a cover type of relation between @xmath25 and @xmath108 , _ i.e. _ nodes belonging to class @xmath25 connect in the same way with all the classes that nodes belonging to class @xmath108 connect , _ but _ they have also some extra connections .",
    "we will denote this relation by @xmath112 and say that @xmath25 covers @xmath108 . from its definition",
    "it is clear that the cover relation is transitive , @xmath113 . when @xmath114 , we also define @xmath115 as the set of extra classes that @xmath25 connects to ( or receives connections from ) relative to those of @xmath108 .    with the above definition",
    ", it can be readily seen that when @xmath114 @xmath116 where the index @xmath117 runs over the extra classes to which @xmath25 is connected .",
    "this implies that @xmath118 thus we find that @xmath119 ( with @xmath120 ) .",
    "thus , when @xmath114 and for large @xmath121 , @xmath105 deviates from our ansatz , eq .",
    "( [ eqn : leakfree ] ) , by an exponentially small amount .    treating the deviations caused by the presence of cover relations among the classes , as a small perturbation to our ansatz , eq .",
    "( [ eqn : leakfree ] ) , we can obtain the leading order expression for @xmath105 as @xmath122 where @xmath123 has been determined from the normalization @xmath124    to the same order , we find also that @xmath125 equations ( [ eqn : qcontbased ] ) and ( [ eqn : picontbased ] ) are the analytical solution of the em equations for a content - based network with connectivity function @xmath87 .",
    "we see that whenever a class @xmath114 , there is a non - zero probability for a node @xmath108 to be also classified as belonging to class @xmath25 .",
    "we will refer to this as a leakage in the class assignment .",
    "however as can be seen from eq .",
    "( [ eqn : qcontbased ] ) , the leakage probabilities vanish exponentially with the size of the classes .",
    "a detailed account of the solution structure for contents - based networks as well as more general types of networks will be given elsewhere @xcite .",
    "for the theoretical example of section v - a .",
    "the number of contents is six : @xmath126 and @xmath17 .",
    "the points represent the ones in the connectivity matrix , the values not marked are zero.,width=226 ]    when the contents - based network is cover - free , the generalized em equations have a leak - free solution and thus the entropy of the class assignments @xmath0 vanishes . on the other hand ,",
    "in the presence of cover relations , the em method will produce assignments with some nodes in multiple classes , i.e. leaks .",
    "we have already found above the leading order behavior for the leakage .",
    "it is not too hard to show that , in that case , @xmath0 is given by @xmath127 where @xmath128 is the number of nodes to which nodes in class @xmath25 are connected in addition to those that nodes in class @xmath108 connect . in many practical situations ,",
    "the number of contents is fixed .",
    "this implies that if the probability of being in class @xmath25 is given by @xmath129 , the actual number of nodes in the @xmath25 class will grow on average as @xmath130 with the system size .",
    "thefore , the factor @xmath131 of eq .",
    "( [ eqn : sqcb ] ) can also be written as @xmath132 where @xmath133 is a constant depending on the connectivity function that generated the network . under these assumptions , the entropy @xmath0 will decrease exponentially with the network size , meaning that even for moderately sized networks the leakages will be in general too small to cause significant misclassification .",
    "as shown in section iv , the solution of the em equations provides us with an estimate for the class connectivity , @xmath82 , given by eq .",
    "( [ eqn : ctilde ] ) . for contents - based networks in the absence of any cover relation among classes , we have , _ cf . _",
    "( [ eqn : pir ] ) , @xmath134 . and from eq .",
    "( [ eqn : ctilde ] ) we immediately find that @xmath135 with @xmath136 . in the presence of cover relations among the classes , there will be corrections that vanish exponentially with the number of nodes in the relevant classes .",
    "these results demonstrate that the em algorithm is capable of inferring the hidden class connectivity function that generated the network .       for the two examples of content - based networks analyzed in the simulation sections .",
    "the number of contents considered is five , @xmath137 and @xmath16 .",
    "the contents of the connectivity function @xmath138 display no cover relation , while in the second example , @xmath139 , @xmath140 .",
    "the networks are generated assuming equal probability for the five contents at the assignation of a content to each node.,title=\"fig:\",width=143 ]   for the two examples of content - based networks analyzed in the simulation sections .",
    "the number of contents considered is five , @xmath137 and @xmath16 .",
    "the contents of the connectivity function @xmath138 display no cover relation , while in the second example , @xmath139 , @xmath140 .",
    "the networks are generated assuming equal probability for the five contents at the assignation of a content to each node.,title=\"fig:\",width=143 ]    in order to further illustrate the theoretical results above , we turn next to an example . consider a network generated from six kinds of contents to be denoted by @xmath126 and @xmath17 , and with the connectivity function as shown in figure 3 .",
    "the following cover relations are present : @xmath141 ; that is , @xmath142 , @xmath143 , and @xmath144 .",
    "in fact , we have chosen this particular example to elucidate the effect of having nested covers and to show that the cover relation is transitive .",
    "for each of the cover relations , the sets of connections to additional classes are @xmath145 , @xmath146 and @xmath147 . when inserted into eq .",
    "( [ eqn : qcontbased ] ) , these relations yield @xmath148 with @xmath149 and all the other values of @xmath150 .",
    "these results are in agreement with what one would expect intuitively . for example , since @xmath142 and @xmath143 , there is a non - zero probability of mistaking nodes of type @xmath151 or @xmath17 by nodes of @xmath13 , i.e. @xmath152 , @xmath153 , and @xmath154 are all non - zero .",
    "however this probability vanishes exponentially with the number of nodes in the classes @xmath16 and @xmath14 . in the large network size limit",
    ", the leakage on @xmath43 , and how far @xmath0 deviates from zero , are determined by the pair of classes @xmath155 such that @xmath25 is the `` tightest '' cover of @xmath108 , these are the pairs @xmath114 for which @xmath156 is smallest , @xmath144 and @xmath142 , in our example .",
    "is represented graphically .",
    "the color of the symbols correspond to the contents of the nodes ( green @xmath151 , red @xmath13 , magenta @xmath14 , blue @xmath15 and cyan @xmath16 ) . on the bottom ,",
    "the spheres radius is proportional to the probability @xmath43 .",
    "on the left , the network is generated using the connectivity function @xmath157 of figure 4 with no cover relation among the classes , while on the right we have used @xmath158 , which incorporates a single cover relation between @xmath151 and @xmath13 such that @xmath140.,title=\"fig:\",width=147 ]   is represented graphically .",
    "the color of the symbols correspond to the contents of the nodes ( green @xmath151 , red @xmath13 , magenta @xmath14 , blue @xmath15 and cyan @xmath16 ) . on the bottom , the spheres radius is proportional to the probability @xmath43 . on the left , the network is generated using the connectivity function @xmath157 of figure 4 with no cover relation among the classes , while on the right we have used @xmath158 , which incorporates a single cover relation between @xmath151 and @xmath13 such that @xmath140.,title=\"fig:\",width=147 ]   is represented graphically .",
    "the color of the symbols correspond to the contents of the nodes ( green @xmath151 , red @xmath13 , magenta @xmath14 , blue @xmath15 and cyan @xmath16 ) . on the bottom , the spheres radius is proportional to the probability @xmath43 . on the left ,",
    "the network is generated using the connectivity function @xmath157 of figure 4 with no cover relation among the classes , while on the right we have used @xmath158 , which incorporates a single cover relation between @xmath151 and @xmath13 such that @xmath140.,title=\"fig:\",width=147 ]   is represented graphically .",
    "the color of the symbols correspond to the contents of the nodes ( green @xmath151 , red @xmath13 , magenta @xmath14 , blue @xmath15 and cyan @xmath16 ) . on the bottom",
    ", the spheres radius is proportional to the probability @xmath43 . on the left",
    ", the network is generated using the connectivity function @xmath157 of figure 4 with no cover relation among the classes , while on the right we have used @xmath158 , which incorporates a single cover relation between @xmath151 and @xmath13 such that @xmath140.,title=\"fig:\",width=147 ]",
    "in the following , we study numerically the ideas introduced in the previous sections .",
    "the generalized version of em will be applied to directed content - based networks generated randomly from the connectivity functions shown in figure 4 .",
    "the nodes of these networks have a content assigned that is selected at random out of @xmath159 five possible contents , denoted by @xmath160 and @xmath16 . since the presence of coverage relations can change the quality of an em classification , we have considered two connectivity functions @xmath10 ( see fig .",
    "4 ) ; one without class coverage , @xmath161 , and another , @xmath162 , with a single cover relation between contents @xmath151 and @xmath13 , such that @xmath140 . in order to improve our numerical estimation of the classification with maximum likelihood",
    ", we implemented a simulated - annealing type of procedure for the optimization of @xmath163 .",
    "( circles ) and its fluctuations @xmath164 ( squares ) as a function of @xmath165 for the networks shown in figure 5 . in order to facilitate visualization ,",
    "the insets show the same curves in a semi - logarithmic plot .",
    "the top panels display the same quantities , @xmath0 and @xmath164 , but ensemble - averaged over different realizations of the content - based networks generated with the connectivity function of figure 4 . ]    in the previous section , we have shown that our generalized em method is able to infer the underlying content - based structure that generated the network .",
    "these calculations were carried out assuming that the number of contents @xmath23 coincides with the number of classes @xmath47 .",
    "let us therefore start by setting @xmath166 . in figure 5",
    ", we show graphically the classifications obtained from the generalized em method as applied to an ensemble of networks of size @xmath167 generated with the connectivity functions of figure 4 .",
    "the color coding is based on the contents of the nodes and will be such that it matches in all the subsequent figures of the paper ( @xmath151 green , @xmath13 red , @xmath14 blue , @xmath15 magenta and @xmath16 cyan ) .",
    "the size of the spheres in the bottom plots are proportional to the probabilities @xmath43 . for these examples",
    "the classification is rather good even in the case when a cover relation is present , as can be readily seen from the bottom diagrams where no major color is misplaced .",
    "in other words , there are not misclassifications , although for the @xmath168 case a small amount of leakage can be noticed .    to try to quantify the quality of these results , we can , as a first measure , count the number of network realizations in our ensemble for which at least two nodes with different contents have been assigned to the same class , with the understanding that a node @xmath34 is assigned to a class @xmath25 whenever @xmath169 .",
    "this is a strict criterion , since it may well be that we are considering as _ erroneous _ a classification with only a single node misclassified .",
    "the result can also slightly depend on the method applied to optimize the likelihood .",
    "still , this definition is a way to play on safe ground and avoid to complicate too much the detection of mistakes in the classification .",
    "let us call this then the error rate of the classification @xmath170 .",
    "for each of the two connectivity functions of fig .",
    "4 , we have studied over @xmath171 realizations of networks of size @xmath167 . in none of them the generalized em method misclassified a single node .",
    "this result is in agreement with our earlier observation that the em method classifies structurally equivalent nodes in the same way .",
    "obtained from the em classification of the networks displayed in figure 5 .",
    "the radii of the circles is proportional to the value of @xmath82 . on the bottom",
    ", we are showing how @xmath1 goes with @xmath165 for the same networks as well as , in the inset , an average over different content - based realizations generated with the connectivity functions of fig .",
    "the next question is then : how can the optimal @xmath47 be determined ?",
    "if the networks studied are content - based , there are several possible answers to this . here",
    "we will outline two of them and will discuss at the end of this section a third one in the context of inferring the class connectivity function . in section iv , we have introduced a measure @xmath0 for the quality of an em classification of the network .",
    "we have also shown that when @xmath172 , @xmath0 is either zero or exponentially small for large content - based networks .",
    "therefore , a signal on @xmath0 can be expected for @xmath173 , if the em algorithm is faced with the challenge of classifying a content - based network with a series of values @xmath47 .",
    "this effect happens because the normalization conditions of eqs .",
    "( [ eqn : pinorm ] ) and ( [ eqn : thdirnorm ] ) impose that no class can be left totally unassigned , @xmath174 for all @xmath25 . the more redundant classes the method has to assign nodes to , the higher @xmath0 becomes . in other words",
    ", we are providing the em algorithm with a larger degree of freedom than required to properly classify the nodes .",
    "the extra freedom leads to structural leakage .",
    "the evolution of @xmath0 with @xmath47 is displayed in figure 6 for the two networks of fig .",
    "5 . these are , of course , particular examples but some general features can be deduced .",
    "first , the value of @xmath0 is rather small or even zero for @xmath175 .",
    "this may be a generic property of content - based networks . as noted before , the structural equivalence of nodes with the same content prevents the em algorithm from putting such nodes into different classes .",
    "this means that once the contents are classified by classes the leakage comes from cover relations between classes and can become very small for big networks . on the other hand ,",
    "when @xmath176 , the availability of excess classes that can not be left totally unassigned causes @xmath0 to be non - zero and to increase steadily with @xmath47 .",
    "the boundary between these two types of behaviors is precisely the unknown @xmath177 .",
    "another peculiarity of the em method applied to contents - based networks is that when @xmath175 , the landscape of the likelihood seems to have a very clear and unique maximum .",
    "the solution at the point of maximum @xmath178 has also a well determined value of @xmath0 .",
    "however , if @xmath179 , the landscape of the likelihood becomes rough , with a large number of local maxima .",
    "the search for the global maximum under such conditions is therefore much harder . and even ,",
    "in the cases where it can be numerically found , say when @xmath177 , it is formed by a set of degenerate extrema with the same value of @xmath180 but very different values of @xmath0 . indeed , the values of the entropy shown in fig . 6 for @xmath179 are averages over the best likelihood solutions found in different realizations of the optimization methods along with their standard deviations @xmath164 .",
    "the dispersion @xmath164 , of @xmath0 around its average , can be used in practice as another estimator for the optimal number of classes ( see fig .",
    "6 ) .            once @xmath23 is known , it is possible to recover @xmath87 as explained in section iv . in the top panels of figure 7 ,",
    "the recovered @xmath82 is displayed for the content based networks of figure 5 .",
    "after the classes of @xmath82 have been properly reordered , it is impossible to distinguish the top panels of fig . 7 from the connectivity functions given in fig .",
    "also , in the lower panels of figure 7 , we have included the evolution of the entropy @xmath1 as a function of @xmath47 .",
    "@xmath1 also shows a clear change of behavior at @xmath173 , suggesting that the best content - based partition of the network happens when the number of classes equals the number of contents .",
    "consequently , @xmath1 , apart from being an estimator of how much a network deviates from a purely content - based graph , is also a useful quantity for deciding when @xmath47 is optimal .     as a function of the probabilities @xmath181 for content - based networks generated with the connectivity functions of figure 4 and with @xmath182 . ]",
    "it is unlikely that in real - world networks the generating processes is error - free . even if the underlaying structure is expected to be a content - based network , errors in the connecting pattern",
    "could naturally arise .",
    "we try to mimic the unexpected connections as well as the absence of expected connections , by introducing the corresponding error probabilities to the process of network generation from its contents .",
    "as before , each node @xmath34 has a content @xmath3 assigned at random from the set of possible contents ( in the case of our example networks the same five possibilities : @xmath183 and @xmath16 ) .",
    "once the contents are established , the structure of the content - based network should be determined completely by the connectivity function @xmath184 : if @xmath185 , there ought to be a link from node @xmath34 to @xmath28 , and none if @xmath186 . as a way of gradually loosing the content - based structure of the connections , we introduce now the probabilities @xmath187 , and @xmath188 , of not having a link , when @xmath189 and having a link although @xmath186 , respectively .",
    "the networks constructed in this way can be regarded as hidden variable graphs @xcite for which the probability of connection between any nodes @xmath34 and @xmath28 is expressed as @xmath190 \\ , p_\\alpha .",
    "\\label{eqn : hidden}\\ ] ] in other words , where in the absence of noise the probability of having a connection was one , it now is @xmath191 , and likewise , where it was zero , it now is @xmath188 .",
    "the extreme limit of this model occurs when @xmath192 , so that the probability of connecting to a node of other class is maximally random and independent of the connectivity function .",
    "we are more interested here in the limit when both @xmath188 and @xmath187 are much smaller than @xmath193 , and the resulting graphs can be seen as a slight modification of a content - based network . for the sake of simplicity ,",
    "all of the results shown below are for @xmath181 .",
    "is represented as a function of the number of classes @xmath165 for two different levels of disorder : the circles are @xmath194 , while the triangles for @xmath195 . on the bottom panels , @xmath0 and @xmath164 versus @xmath165 for the disorder probabilities @xmath194 , circles ( @xmath0 ) and squares ( @xmath164 ) , and @xmath195 , triangles ( @xmath0 ) and stars ( @xmath164 ) . ]",
    "let us begin by looking at how the networks change with increasing assignment error . in the top panels of figure 8",
    ", we display a series of networks generated with the connectivity function @xmath161 for different values @xmath196 .",
    "it is readily seen that the connection patterns associated with the different kinds of content becomes more and more diffuse . on the bottom panels of the same figure",
    ", we show the corresponding class assignment probabilities @xmath43 . while these are just examples , there are some features that are worth pointing out .",
    "the problems in the classification seem to appear somewhere between @xmath194 and @xmath197 .",
    "even at @xmath198 of error the number of nodes misclassified in these networks is not very high .",
    "a closer inspection of the solution found shows that actually only two of the node contents - classes are mingled up , while all the remaining node classes are perfectly assigned . with the aim of quantifying these observations ,",
    "the behavior of @xmath170 is plotted in figure 9 versus the disorder probability .",
    "this plot is , of course , susceptible to slight changes depending on the method used to search for the maximum likelihood and depends on how many realizations of the content - based graphs were considered ( in this case @xmath199 ) .",
    "nevertheless , in our simulations the threshold for a sharp classification of all the nodes of the network is around @xmath200 for graphs without coverage , connectivity function @xmath161 , and much lower , around @xmath201 , for those with a cover relation , @xmath162 .",
    "the exact value will depend on the particular connectivity function , apart from the optimization method , but these values give us already an idea about the order of magnitude of the threshold beyond which the content - based structure can not be recovered anymore .     as a function of the disorder probability @xmath181 for content - based networks generated with the connectivity functions @xmath161 and",
    "@xmath162 depicted in figure 4 .",
    "the red curves correspond to the value of @xmath202 . ]    a next aspect to consider is how the entropies @xmath0 and @xmath1 are affected by the intensity of the disorder , and whether they are still valid estimators to determine the optimal number of classes .",
    "to answer this question , we fix the probabilities @xmath203 at @xmath204 , which seems to be a value where one might plausibly expect to obtain good classifications for both type of networks . in figure 10",
    ", we display @xmath0 , @xmath164 and @xmath1 , as function of the number of classes @xmath165 with the results averaged over different content - based realizations .",
    "indeed , at this level of disorder the entropies can still be used to estimate @xmath205 .",
    "the noise in the connections introduces a small constant background for @xmath1 , which we will denote by @xmath202 , and which can be determined in both examples from the behavior at high values of @xmath165 . we can estimate the value of @xmath202 by noting that when @xmath206 any non - zero entropy should essentially be due to the background from the random connections . substituting the expression for @xmath207 , eq .",
    "( [ eqn : hidden ] ) , into the definition of @xmath1 , eq .",
    "( [ eqn : sc ] ) , should therefore give us an estimate for @xmath202 , @xmath208 for @xmath194 , this yields @xmath209 , close to the value observed in the figure 10 for @xmath210 . to check",
    "how well our estimate for @xmath202 agrees with the values obtained from simulations , we plot in figure 11 @xmath1 vs. the disorder probability at @xmath211 . when the disorder becomes very strong , on the other hand , it might not be possible to find an optimal @xmath165 .",
    "moreover , the presence of very different connection patterns for nodes with the same content renders the existence of such optimal number dubious .",
    "therefore , apart from the obvious classification @xmath212 , there may not be any other sharp classification .",
    "the effects of high disorder can be seen in figure 10 , where the entropies @xmath1 and @xmath0 are represented as a function of @xmath165 for @xmath195 .",
    "the results depend on the connectivity function , @xmath161 seems a little more robust to the disorder as was confirmed by fig . 9 , but the signal in @xmath0 or @xmath164 is clearly lost or has moved to higher values of @xmath165 .",
    "also @xmath1 has lost its capacity to predict @xmath205 and smoothly falls for higher and higher values of @xmath165 .",
    "it is worthy also noting that in spite of the lack of a method to find @xmath205 , if @xmath211 the em method retrieves the appropriate hidden variable theory connectivity function @xmath213 as can be inferred from the good fit produced by eq .",
    "( [ eqn : sc_star ] ) to @xmath1 shown in figure 11 .",
    "the numerical findings of this section show that the classifications of the em method are robust to the introduction of noise in the connection patterns up to a certain point .",
    "the certainty of the classification will suffer , the stronger the disorder becomes .",
    "in fact this is one of the major merits of the em method : it is able to extract the underlying content - based structure even in the presence of a certain level of noisy connections .",
    "in summary , we have shown how the em method for the classification of nodes of a network can be applied to content - based networks in order to extract the underlying content - based structure even in the presence of a certain level of disorder in the connections .",
    "the application of the em method to content - based networks is a natural concept that follows from the observation that the em method classifies structurally equivalent nodes in an identical manner . in this sense",
    ", the em method can be related to the block modeling techniques proposed in social sciences .",
    "content based networks , on the other hand , are of great relevance , since they can be regarded as idealized paradigms of networks with communities or multipartite structures , including mixtures of both .",
    "since in many realistic graphs the vertices carry additional attributes which might influence or even determine their connections to other vertices , being able to extract any content - based pattern can provide information about how the networks emerged .",
    "our approach in this paper has been to start out with pure content - based graphs , and to show analytically as well as numerically that the em method can infer the content - based connectivity pattern .",
    "we have shown also that the existence of cover - relations between contents leads to non - zero probabilities of mistaking nodes belonging to different classes . however , these probabilities vanish exponentially with the increasing number of nodes , _",
    "i.e. _ , the more discriminating information provided to the method . by regarding more realistic networks as perturbations of content - based networks under the addition or removal of connections",
    ", we then asked under which circumstances the em method is still able to perform satisfactorily .",
    "there is a certain level of disorder beyond which the inference of the content - based structure , specially the number of contents , becomes rather hard if not impossible .    in order to estimate the quality of the classification and how far the structure of the network is from a content - based structure , we have introduced two entropies , @xmath0 and @xmath1 , which actually can be useful for the classification of any kind of graphs , including real - world networks .",
    "we have also shown that these entropies are applicable to deduce the optimal number of classes needed by the em method to obtain a sharp classification of the nodes of the network .    _",
    "acknowledgments _ the authors would like to thank alessandro vespignani , santo fortunato , filippo radicchi , and in general the members of the cx - nets collaboration for useful discussions and comments .",
    "funding from the progetto lagrange of the crt foundation , the research fund of boazii university , as well as the nahide and mustafa saydan foundation was received .",
    "in addition , mm would like to acknowledge the kind hospitality of the isi foundation .",
    "the equations written in this form take care of the case when some of the @xmath29 are zero , as can be readily checked by comparing their solution , eq .",
    "( [ eqn : thetarj ] ) , with eqs .",
    "( [ lbardirected ] ) and ( [ thetaeqs ] ) ."
  ],
  "abstract_text": [
    "<S> in this paper , we generalize a recently introduced expectation maximization ( em ) method for graphs and apply it to content - based networks . </S>",
    "<S> the em method provides a classification of the nodes of a graph , and allows to infer relations between the different classes . </S>",
    "<S> content - based networks are ideal models for graphs displaying any kind of community or / and multipartite structure . </S>",
    "<S> we show both numerically and analytically that the generalized em method is able to recover the process that led to the generation of such networks . </S>",
    "<S> we also investigate the conditions under which our generalized em method can recover the underlying contents - based structure in the presence of randomness in the connections . </S>",
    "<S> two entropies , @xmath0 and @xmath1 , are defined to measure the quality of the node classification and to what extent the connectivity of a given network is content - based . </S>",
    "<S> @xmath0 and @xmath1 are also useful in determining the number of classes for which the classification is optimal . </S>"
  ]
}