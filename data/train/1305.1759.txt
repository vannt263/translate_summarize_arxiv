{
  "article_text": [
    "the application of kinetic theory to the modeling of semiconductor devices simulations is a long dated but still very active research field because of the richness and diversity of observed phenomena @xcite . from the mathematical point of view",
    ", semiconductor devices can be accurately described by kinetic equations when the mean free path of the particles is large compared to a macroscopic characteristic length of the system ( @xcite ) . on the other hand ,",
    "when the average time between particles collisions is small , the relevant scaling is the diffusive one and in such regimes these systems can be described by macroscopic drift - diffusion equations @xcite . unfortunately , this passage from the microscopic to the macroscopic description leads to challenging numerical difficulties . indeed , when the macroscopic reference length is several orders of magnitude larger than the mean free path , the kinetic equation contains stiff terms .",
    "this means that classical numerical methods need time step restrictions which make their use prohibitively expensive . in these cases , it becomes attractive to use domain decomposition strategies , which are able to solve the microscopic and the macroscopic models wherever it is necessary .",
    "these approaches have been largely studied for kinetic equations both for the diffusive @xcite and for the hydrodynamic scaling @xcite . however , even if these methods are very efficient they are affected by some difficulties due to the fact that it is not always a simple task to define the different regions of the domain in which the use of a macroscopic model is fully justified . thus in the recent past alternative strategies",
    "have been studied , the so - called asymptotic preserving ( ap ) schemes .",
    "they consist in solving the original kinetic model in the full domain avoiding the time step restriction caused by the presence of different stiff terms in the equations .",
    "the ap methods automatically transform the original problem in the numerical approximations of the relevant macroscopic model when the scaling parameter goes to zero @xcite .",
    "recently , this approach has been considered in the framework of implicit - explicit ( imex ) runge - kutta schemes with the aim of deriving high order numerical methods which are accurate in all regimes @xcite .",
    "this means that such schemes are able to preserve the desired order of accuracy even in the limit when the scaling parameter tends to zero .    in this paper",
    "we develop high order schemes for the resolution of the boltzmann - poisson semiconductor model . in this kind of problems , since the characteristic speed of the hyperbolic part of the kinetic equation is of the order of @xmath0 ( where @xmath1 is proportional to the mean free path ) , the cfl condition for an explicit approach would require @xmath2 .",
    "of course , in the diffusive regime where @xmath3 , this would be too much restrictive since a parabolic condition @xmath4 would suffice to solve the limiting equation .",
    "this kind of difficulties has been studied in @xcite using different semi - implicit approaches",
    ". however , most of the previous literature on the subject , originates consistent low order explicit schemes for the limit model .",
    "such explicit schemes clearly suffer from the usual stability restriction @xmath4 . here , on the contrary to previous approaches , we are able to guarantee for all regimes a linear time step limitation @xmath5 , independently from @xmath1 , and high order accuracy in time and space . in order to accomplish this task , we first rewrite our system using the parity formalism then , following @xcite , we add and subtract the limiting diffusive flux to the convective kinetic flux .",
    "we then discretize the reformulated problem by implicit - explicit runge kutta method .",
    "as we will show this will allow to get asymptotic preserving high order schemes which uniformly work for the different values of @xmath1 and which automatically originate an imex runge - kutta method for the limiting convection - diffusion equation in which the diffusive term is discretized implicitly . finally , in order to permit realistic simulations we consider the challenging case of complex interaction operators .",
    "these terms are handled by introducing a penalization technique which permit to avoid the inversion of such operators when their stiff character suggests an implicit treatment .",
    "the rest of the paper is organized as follows .",
    "first we present the kinetic semiconductor equation , its drift - diffusion limit and the reformulated parity system .",
    "the third section provides the basis of the numerical method describing in details the time discretization .",
    "the fourth section describes phase - space variables discretization , based on conservative finite difference schemes for the space variables and on a gauss - hermite approximation for the velocity variables .",
    "numerical results for the proposed schemes are presented in the fifth section .",
    "a concluding section ends the paper .",
    "we consider the boltzmann equation under the diffusive scaling which describes the time evolution of electrons inside semiconductor devices .",
    "let @xmath6 be the density distribution function for particles at time @xmath7 , where position and velocity variables @xmath8 and @xmath9 are such that @xmath10 , with @xmath11 and @xmath12 or @xmath13 . under these assumptions ,",
    "the time evolution of the system is described by @xcite @xmath14    in this formula , @xmath15 is an integrable function of @xmath9 which models the generation and recombination process inside the semiconductor , @xmath1 is proportional to the mean free path and @xmath16 is the electric field which is self - consistently computed solving a suitable poisson equation for the electric potential @xmath17 .",
    "constants @xmath18 and @xmath19 are respectively the elementary charge and the effective mass of the electrons . the anisotropic collision term @xmath20 is defined by [ eq : q ] q(f ) ( ) = ( , ) \\{m ( ) f ( ) - m ( ) f ( ) } d , where @xmath21 is the constant in time normalized maxwellian at temperature @xmath22@xmath23 and @xmath24 is the anisotropic scattering kernel which is rotationally invariant and satisfies @xmath25 for some given constant @xmath26 .",
    "we also assume that the collision frequency @xmath27 satisfies the following bound for some positive constant @xmath28 @xcite @xmath29 the collision operator is bounded and nonnegative on the hilbert space , see @xcite , + @xmath30 and it has a one - dimensional kernel spanned by @xmath21 .",
    "moreover , if we let @xmath31 be the unique solutions to the problem @xmath32 then , since @xmath24 is rotationally invariant , it follows that there exists a positive constant @xmath33 such that @xmath34 thus , defining the total mass @xmath35 as @xmath36 one can show ( using for example the hilbert expansion @xmath37 with @xmath38 , see @xcite for instance ) that when @xmath39 , @xmath6 is approximated by @xmath40 with @xmath41 satisfying the drift - diffusion equation @xcite @xmath42 in this equation , @xmath33 is the diffusion coefficient defined implicitly in terms of the cross section by ( [ diffc ] ) , the constant @xmath43 is the so - called mobility given by the einstein relation @xmath44 and @xmath45 is the integral of the generation recombination function @xmath46      we now define the even and odd parities formalism which we will use in the development of the numerical schemes . to this aim we split equation ( [ tone ] ) into two equations , one for @xmath9 and one for  @xmath47 @xmath48 next , we introduce the so called even parity @xmath49 and odd parity @xmath50 defined by @xmath51 now , adding and subtracting the two equations in ( [ thtwo ] ) leads to @xmath52 where @xmath53 is the collision frequency defined in ( [ collf ] ) and where we used the property that @xmath54 since @xmath50 is an odd function .",
    "we also assume @xmath55 is an even function , which is a physically consistent choice in semiconductor simulations .",
    "an important advantage of this formulation is that now only one time scale appears in our new system ( [ thsix ] ) .    from the above formulation",
    "it is easy to see that in the limit @xmath56 , formally we get that the integral of the even parity @xmath49 with respect to the velocity variable is the solution to ( [ televen ] ) .",
    "in fact , the macroscopic variable @xmath57 can be expressed in terms of @xmath49 as = f()d = r()d .",
    "taking the formal limit @xmath58 in system ( [ thsix ] ) we get @xmath59 the first equation implies that @xmath60 being ker@xmath61 span@xmath62 .",
    "now , replacing equation ( [ thq:2 ] ) and @xmath63 in the first equation of system ( [ thsix ] ) and integrating over the velocity space gives the drift diffusion equation ( [ televen ] ) . from such computation",
    "we recover , moreover , that @xmath33 is given by the following formula @xmath64 in the following , in order to simplify notations , we will assume @xmath65 and @xmath66 , which implies @xmath67 .",
    "we recall here the system ( [ thsix ] ) that we want to solve @xmath68 and summarize the properties we demand to our time discretization scheme :    1 .",
    "the scheme has to be asymptotic preserving ( ap ) .",
    "this ensures stability condition independently from @xmath1 . in other words ,",
    "the scheme should satisfy the following definition + a consistent time discretization method for ( [ sys_t_solv]-[sys_t_solv2 ] ) of stepsize @xmath69 is _ asymptotic preserving ( ap ) _ if , independently of the initial data and of the stepsize @xmath69 , in the limit @xmath70 becomes a consistent time discretization for equation ( [ televen ] ) .",
    "2 .   the scheme has to be an high order asymptotically accurate ( aa ) method .",
    "this means we want our scheme to satisfy the following definition + a consistent time discretization method for ( [ sys_t_solv]-[sys_t_solv2 ] ) ) of stepsize @xmath69 is _ asymptotically accurate ( aa ) _ if , independently of the initial data and of the stepsize @xmath69 , the order of accuracy in time is preserved for @xmath56 .",
    "3 .   the scheme should solve , in the limit @xmath71 , the drift - diffusion equation ( [ televen ] ) with an implicit treatment of the diffusion term .",
    "this ensures a stability condition for the time step which is of the order of the space discretization : @xmath5 .",
    "4 .   we want to avoid the difficult inversion of complex collision operators which occurs when classical implicit solvers are used .",
    "we now focus on the first three points of the above list while we will discuss the last point at the end of the section . in order to construct time discretizations which satisfy the above requirements we reformulate system ( [ sys_t_solv]-[sys_t_solv2 ] ) following the approach introduced in @xcite .",
    "we add to both sides of equation ( [ sys_t_solv ] ) a term that permits to choose which kind of time integrator ( if explicit or implicit ) we intend to use for the diffusive term in the drift - diffusion equation ( [ televen ] ) .",
    "this term reads @xmath72 where @xmath73 is a positive function such that @xmath74 .",
    "the modified system reads @xmath75 as we will see , the introduction of this new term allows to avoid the parabolic time step limitations for the limit drift diffusion equation ( [ televen ] ) .",
    "we will discuss later the different possible choices for @xmath76 .    in order to write the general time discretization formulation ,",
    "we rewrite the previous system ( [ iesys ] ) in a more compact form as @xmath77 where we defined @xmath78    * remark : * we point out that in this paper we consider the case in which @xmath76 does not depend on the space variable .",
    "more precisely , @xmath76 could depend on @xmath1 but not on @xmath79 and @xmath80 .",
    "since in the general case @xmath1 instead depends on @xmath79 and @xmath80 , in the work we are assuming that in the space - time domain the range in which @xmath1 may vary is small enough to allow us to keep @xmath76 constant .",
    "we numerically observed that this condition is , indeed , true for a large set of values of @xmath1 .",
    "we remind to a future work the development of schemes which could take into account the possibility for @xmath76 to vary .",
    "an imex runge - kutta scheme @xcite applied to the above system reads for the internal stages @xmath81 as @xmath82 while the numerical solution is given by @xmath83 in the above formulas , matrices @xmath84 , @xmath85 for @xmath86 and @xmath87 are @xmath88 matrices such that the resulting scheme is explicit in @xmath89 and implicit in @xmath90 , @xmath91 and @xmath92 . in general , an imex runge - kutta scheme , is characterized by the above defined two matrices and by the coefficient vectors @xmath93 , @xmath94 . since computational efficiency is of paramount importance , in the sequel we restrict our analysis to diagonally implicit runge - kutta ( dirk ) schemes for the source terms ( @xmath95 for @xmath96 ) .",
    "the use of a dirk scheme is enough to ensure that the two transport terms in the two equations of system ( [ iesys ] ) are always explicitly evaluated .",
    "in fact , observe that , when the integration for the odd parity @xmath50 is performed the values of @xmath49 are already available for the corresponding stage .",
    "this is due to the use of a partitioned runge - kutta approach for the time integration of our system .",
    "the type of schemes introduced can be represented with a compact notation by a double butcher tableau , @xmath97    [ cols=\"<,>,^\",options=\"header \" , ]     @xmath97 where coefficients @xmath98 and @xmath99 are given by the usual relation @xmath100 and @xmath101 .",
    "imex schemes are a particular case of additive runge - kutta methods and so the order conditions can be derived as a generalization of the notion of butcher tree ; we refer to  @xcite for more details on the order conditions . before stating the main properties concerning asymptotic preservation and asymptotic accuracy , we characterize the different imex schemes accordingly to the structure of the dirk method . following  @xcite , we call an imex - rk method of type a if the matrix @xmath102 is invertible , or equivalently @xmath103 , @xmath104 while we call it of type ck ( see @xcite ) if the matrix @xmath105 can be written as a = (    ll 0 & 0 + a & a    ) , [ ck1 ] with @xmath106 and the submatrix @xmath107 invertible , or equivalently @xmath103 , @xmath108 .",
    "we write also the matrix @xmath109 for the explicit runge - kutta method a= (    ll 0 & 0 + a &    ) , [ ck2 ] where @xmath110 and @xmath111 .",
    "we now introduce two useful definitions to characterize the properties of the methods in the sequel .",
    "an imex - rk scheme is called _ implicitly stiffly accurate ( isa ) _ if the corresponding dirk method is _ stiffly accurate _ , namely @xmath112 .",
    "if in addition the explicit matrix satisfies @xmath113 , the imex scheme is said to be _ globally stiffly accurate ( gsa ) _ or simply _",
    "stiffly accurate_.    note that for gsa schemes the numerical solution is the same as the last stage value , namely @xmath114 and @xmath115 .",
    "we recall that the order conditions for gsa type @xmath105 imex schemes are particularly restrictive since @xmath116 and @xmath117 .",
    "another restrictive condition is , for high order methods , the request that the matrix @xmath105 is invertible for details see @xcite .",
    "all these requests make very difficult to derive imex gsa schemes of order higher than two .    the detailed analysis of the ap properties of the proposed imex schemes is reported in the appendix . in that part we will give sufficient conditions which guarantee that the schemes are ap and aa . here , we only recall the main results . type @xmath105 imex schemes are asymptotic preserving and asymptotically accurate .",
    "if in addition they are gsa the distribution function is projected over the equilibrium at each time step .",
    "two sufficient conditions for type @xmath118 imex schemes which guarantee the ap and aa properties is that they are @xmath119 and that the initial data are close to the equilibrium state ( we say in this case that the initial data are consistent with the limit problem ) . again in this case , we get also sufficient conditions to assure that the distribution function is projected over the equilibrium state at each time step .    here we show how the density values are obtained and that in the limit the schemes solve the drift - diffusion equation with an implicit treatment of the diffusion term .",
    "observe in fact that in order to use schemes ( [ strk])-([numsolj ] ) , we need to know the values of the density distribution @xmath41 and of its stages implicitly .",
    "these values are obtained by integrating with respect to velocity equation ( [ strk ] ) and ( [ numsolr ] ) .",
    "we denote by @xmath120 , @xmath121 and @xmath122 for @xmath81 , the column vectors of the stages for @xmath49 and @xmath50 respectively and by @xmath123 the vector of the stages of the mass density @xmath41 ; it holds that @xmath124 .",
    "moreover , we denote by @xmath125 the vector containing stage values for @xmath81 and similarly for @xmath126 .",
    "the equation for the internal stages in vector form reads @xmath127 which we can also rewrite as @xmath128 while the equation for the numerical solution is @xmath129 in the above equation the integral of @xmath130 is implicit .",
    "however , it can be ( explicitly ) solved by inverting the matrix describing the discretized diffusion operator related to the term @xmath131 .",
    "this permits to know the density @xmath41 implicitly by the explicit knowledge of @xmath49 and @xmath50 .",
    "finally , in the limit regime , as shown in the appendix , the term @xmath131 is reduced to @xmath132 which means that we get as desired an implicit discretization of the diffusion term .      in the numerical method described in the previous paragraph",
    "the collision operator has to be implicitly computed .",
    "then , it is necessary that one is able to invert it .",
    "this is usually not the case since , in general , collisions are represented by nonlinear multidimensional operators which could be costly to compute or even more to invert .",
    "for this reason , we choose to penalize @xmath133 with a suitable operator @xmath134 which @xmath135 needs to be easier to invert and @xmath136 would not change the asymptotic behavior of the solution .",
    "the second condition is mathematically expressed by ker@xmath61 ker@xmath137 span@xmath62 .",
    "this strategy has been proposed for the boltzmann equation in @xcite and subsequently studied in the context of imex schemes in @xcite .    in order to write the modified imex schemes , we add and subtract to the collision term @xmath133 an operator @xmath134 and then we combine the implicit and the explicit solvers as follows : @xmath138 a possible choice for @xmath134 is a first order approximation of the original operator , obtained using an expansion of @xmath133 near the equilibrium distribution @xmath139 : @xmath140 .",
    "+ since it is not always possible or easy to compute analytically @xmath141 , one can choose to approximate it .",
    "a possibility is then @xmath142 where @xmath143 is an upper bound of @xmath144 .",
    "regardless from the choice of @xmath134 , we apply the imex strategy to the penalized system in the following way @xmath145 observe that computing operator @xmath134 with the implicit solver stabilizes also the non - linear collision operator , without changing the asymptotic behavior of the solution . however , this stabilization is not straightforward , on the contrary in order to stabilize the reformulated system it is necessary that the coefficients of the scheme used for the time integration of the linearized collision operator dominate those used for the time integration of the original operator .",
    "such technique allows us to treat very general collision operators .",
    "we prove in the appendix that both @xmath105 and @xmath118 type imex schemes if also globally stiffly accurate are ap and aa .",
    "more in details , @xmath118 schemes needs the additional hypothesis of consistent initial data to assure that the asymptotic properties are satisfied .",
    "the request that the schemes are @xmath119 in this case becomes necessary for the stability in the limit of zero mean free path .",
    "we discuss in this section the discretizations of velocity and space variables . concerning the velocity variable , because of the particular structure of the problem , it is convenient to approximate @xmath49 and @xmath50 using a gauss - hermite expansion .",
    "we decompose then the unknowns @xmath49 and @xmath50 as follows @xcite : @xmath146 and @xmath147 , with @xmath148 and @xmath149 . in this way it is possible to exploit the gauss - hermite approximations to efficiently and accurately compute the derivatives in @xmath9 and the collision operator ( which is an integral in @xmath9 ) . from ( [ iesys ] )",
    "we have : @xmath150 @xmath151 from equation ( [ iephi ] ) we obtain @xmath152 from which @xmath153 follows , with @xmath154 and @xmath155 .",
    "similarly , from equation ( [ iepsi ] ) we have @xmath156 we conclude this section with an example for @xmath157 : in the particular case in which @xmath158 in ( [ eq : q ] ) , we get the co called _ relaxed time approximation _ ( rta ) .",
    "it is easy to see then that @xmath159 and thus it holds that @xmath160 .",
    "we describe the gauss - hermite approximation ( @xcite ) in the monodimensional case .",
    "the multidimensional case is obtained applying the monodimensional rule dimension - by - dimension .",
    "let consider @xmath146 and @xmath147 , with @xmath161 being the hermite expansion . here",
    "@xmath162 are the renormalized hermite polynomials and coefficients @xmath163 and @xmath164 can be computed thanks to the inverse expansion ( we refer to @xcite for more details ) .",
    "the computation of the collision operator becomes @xmath165 where @xmath166 are points and weights of the gauss - hermite quadrature rule .",
    "finally , the derivatives with respect to @xmath9 , which are given by @xmath167 become @xmath168 @xmath169 * remark : * coefficients @xmath170 for any component of @xmath9 can be computed at the beginning of the simulation and stored in a matrix since they do not depend on functions @xmath171 and @xmath172 .      in this section",
    "we emphasize some requirements about the space discretization of the system .",
    "we want our scheme to work both in the kinetic regime ( @xmath173 ) , in which the hyperbolic behavior is more relevant , and in the limit regime ( @xmath174 ) , in which the system is characterized by diffusive behavior .",
    "moreover , the characteristic speeds of the system ( which are of the order of @xmath0 ) tend to infinity as @xmath175 and so shock capturing methods based on characteristics directions , such as , e.g. , upwind methods , become useless . on the other hand , central differences schemes avoid excessive dissipation but , when @xmath1 is not small or when the limiting equations contain advection terms , may lead to unstable ( or not accurate ) discretizations .    in order to overcome these well - known facts and to have the correct asymptotic behavior , we fix some general requirements for the space discretization :    i ) : :    _ correct diffusion limit : _ as we already observed in previous section ,",
    "if we want a correct approximation in the limit case    @xmath176 , we need that @xmath74 and to use the    same space discretization for the transport terms in ( [ iephiom ] ) and    ( [ iepsiom ] ) ; ii ) : :    _ compact stencil : _ we want to use a scheme with a compact stencil in    the diffusion limit @xmath175 .",
    "this property is    satisfied if point * i ) * is satisfied and we use a suitable    discretization for the second order derivative that characterizes the    diffusion limit ; iii ) : :    _ shock capturing : _ the chosen scheme should be based on high order    shock capturing fluxes for the convection part .",
    "this is necessary not    only for large values of @xmath1 but also when we consider    convection - diffusion type limit equations with small diffusion .",
    "the    high order fluxes are then necessary for all space derivatives except    for the second order term @xmath177    on the right hand side in ( [ iephiom ] ) ; iv ) : :    _ avoid solving nonlinear algebraic equations : _ in order to have a more    efficient method , we do not want to solve the nonlinear equation which    comes from the implicit treatment of the space derivative in equation    ( [ iepsiom ] ) for @xmath172 , ( and in ( [ eq : penj ] ) for the odd    parity @xmath50 ) . to achieve this",
    "we have chosen a partitioned    approach for the time integration , thanks to which the values of    @xmath171 are already available from the previous solution of    ( [ iephiom ] ) .      in order to satisfy the above requirements we choose to use a lax - friedrichs type flux with high order weno reconstruction @xcite .",
    "this gives us the ability to ensure accuracy and also to stabilize the solution in the presence of discontinuities or arising shocks .",
    "our strategy is the following : in the kinetic regime , where transport dominates the dynamics , we use the standard lax - friedrichs type flux with weno reconstruction for the derivatives @xcite . in this case , indeed , this is a proper strategy which allows us to obtain also high order accuracy .",
    "when considering the limiting regime instead , we can not use the lax - friedrichs scheme as it is . as we will show later in this section ,",
    "the numerical viscosity introduced by such scheme in this case is proportional to @xmath0 .",
    "clearly , when the mean free path goes towards zero ( @xmath175 ) such quantity is too large and causes loss of accuracy ( see for instance @xcite ) .",
    "thus , in such situation we decide to bound the numerical viscosity modifying the fluxes .",
    "this is possible because when @xmath1 becomes small the diffusive regime becomes dominant and thus stability is granted by the `` physical '' viscosity given by the system itself .",
    "we point out that , in this work , the stability of the proposed modified fluxes approach is supported by numerical evidence .",
    "theoretical estimates for this technique and for this kind of scaling will be the subject of a future work .",
    "we present here the modified fluxes approach using a model problem .",
    "given the transport equation for the unknown @xmath178 @xmath179 with @xmath180 a hyperbolic flux , we consider a complete discretization in conservation form @xmath181 @xmath182,\\ ] ] where @xmath183 and the parameter @xmath184 represents the numerical viscosity .",
    "the standard lax - friedrichs scheme requires the value @xmath185 .",
    "such scheme is stable if the following two inequalities are satisfied @xmath186 formula ( [ eq : numflux ] ) is the basis for the construction of a conservative numerical flux which can be implemented using eno or weno high order reconstructions @xcite .    to derive the modified fluxes ,",
    "let consider now the prototype system @xmath187 which shares the same structure of our original problem . in the limit @xmath176 , if @xmath188 , the above system leads to the drift - diffusion equation @xmath189 .",
    "we then write a semi - discrete approximation of ( [ eq:1 ] ) as @xmath190 with numerical fluxes given by @xmath191 , \\quad v_{i+1/2 } = { 1\\over2 } \\left [ \\big ( u_{i+1 } + u_i \\big ) -",
    "\\e^2 \\alpha \\ , \\big ( v_{i+1 } - v_i \\big ) \\right]\\ ] ] where @xmath184 is the numerical viscosity as before . rewriting the numerical fluxes as @xmath192 , \\quad v_{i+1/2 }",
    "= { 1\\over2 } \\left [ \\big ( u_{i+1 } + u_i \\big ) - \\alpha_v \\ , \\big ( v_{i+1 } - v_i \\big ) \\right]\\ ] ] we have @xmath193 the stability conditions ( [ lambdalpha ] ) in this case read : @xmath194 @xmath195 as pointed out before , we want to avoid such restrictive time step .",
    "to this aim , close to the limit we modify the numerical viscosity setting @xmath196 more in details , until we reach a regime in which the physical diffusion is not large enough to guarantee stability we need to satisfy  ( [ eq : fluxphys ] ) . on the other hand ,",
    "when physical diffusion becomes relevant , we can avoid such restrictions and we can choose the modified fluxes  ( [ eq : fluxnum ] ) .",
    "the practical choice we did in our numerical tests is @xmath197    to summarize , we write here the complete numerical discretization of system ( [ eq : penr])-([eq : penj ] ) .",
    "we denote the values @xmath198 for @xmath199 and @xmath50 varying in the phase - space index set and at time @xmath200 .",
    "we denote in the same way the other variables appearing in the sequel . for stage vectors @xmath201 and @xmath202 we denote @xmath203 and @xmath204 for @xmath81",
    ". then we have @xmath205                 + \\delta t \\ , a \\left [ { 1\\over\\e^2 } { \\bf { { \\widetilde}l}}_{ij } ( \\phi )                 + \\frac{\\mu}{\\l_j } \\ , \\bv_j^2 \\ , \\phi_{ij}^{\\bx\\bx } \\right ] ,                                  \\label{eq : dfphhi }   \\\\   \\psi_{ij } & = & \\psi_{ij}^n { \\bf e } - \\frac{\\delta t}{\\e^2 } \\ , a \\big [ \\l_j \\psi_{ij }            + \\gamma_{ij } ( \\phi , \\psi , \\alpha_u ) - e_i \\otimes ( \\phi_{ij}^\\bv - 2 \\bv_j \\phi_{ij } ) \\big ] .",
    "\\label{eq : dfpssi}\\end{aligned}\\ ] ] and @xmath206 and @xmath207 for the numerical solution . to make formulas more readable we defined some shorthands .",
    "operator @xmath208 stands for the numerical discretization of the transport derivatives : @xmath209 , obtained as in ( [ eq : modflumix ] ) and it reads @xmath210 with @xmath211 the term @xmath212 is @xmath213 while @xmath214 and @xmath215 stand for the derivative with respect to @xmath9 and are obtained by means of ( [ eq : derv ] ) .    the diffusion term in the r.h.s .",
    "of equation ( [ eq : dfphhi ] ) , i.e. the derivative @xmath216 , stands for the standard central second order finite difference technique , i.e. @xmath217 when the second order time discretizations is used , and for the standard central fourth order finite difference technique when the third order time discretizations are used .",
    "regarding the numerical viscosity in equations ( [ eq : dfphhi ] ) and ( [ eq : dfpssi ] ) , if we are in the kinetic regime we choose the physical values given by ( [ eq : fluxphys ] ) while in the limiting regime we consider the modified ones given by ( [ eq : fluxnum ] ) .",
    "the space discretization of the electric potential @xmath218 can be performed by standard methods @xcite .",
    "the treatment of boundary conditions for the boltzmann - poisson problem in the diffusive limit is , in the general case , a very hard task .",
    "it is necessary to tackle several difficulties , such as complex geometries of the boundaries and to take into account boundary layers . for a consistent treatment of boundary condition",
    "see , for instance , @xcite and references therein .",
    "all these aspects are out of the scope of this article and we will only deal with assigned , constant in time boundary data , the so called maxwellian injection .",
    "we show now a possible strategy for a consistent numerical implementation of such conditions in the one - dimensional situation .",
    "+ for @xmath219 a maxwellian injection is defined by @xmath220 for @xmath221 , where @xmath222 and @xmath223 are assigned nonnegative functions proportional to the maxwellian distribution @xmath21 .",
    "we numerically approximate these conditions in two different ways , depending on the regime in which the system is .",
    "in the kinetic regime , for @xmath224 we set @xmath225 , we extrapolate @xmath226 ( the outgoing particles ) from the values of @xmath49 and @xmath50 inside the domain and then we define @xmath227 and @xmath228 thanks to the parity formulas ( [ eq : parir ] ) and ( [ eq : parij ] ) . at the right boundary @xmath229 a similar treatment is used .    in the diffusive regime instead , to get a boundary condition for @xmath49 and @xmath50 we use the relations ( for positive @xmath230 only ) @xmath231 then we consider equation ( [ thq:2 ] ) , which gives a good approximation of @xmath50 when @xmath1 is small , i.e. @xmath232 , and applying it in ( [ thbound ] ) one gets @xmath233 to approximate @xmath234 and @xmath235 we use one - sided finite difference discretizations of the desired order and to approximate @xmath236 we observe that from ( [ thbound ] ) it holds that @xmath237 which in the end leads to ( up to @xmath238 ) @xmath239",
    "in this section , we present several numerical results to test the performance of the proposed schemes .",
    "we show that our schemes are computationally very efficient , i.e. @xmath5 while at the same time they preserve high order of accuracy in all regimes .",
    "the setting is a monodimensional phase - space , i.e. @xmath240 .    in our computations we use two different scattering cross - sections : a simple isotropic case with a constant cross - section @xmath241 , this corresponds to the relaxation time approximation ( rta ) , for which the collision operator has the simple form @xmath242 and a regularized anisotropic cross section @xcite for electron - phonon interactions ( epi ) @xmath243 where @xmath244 is a smoothed delta function with @xmath245 a positive constant ( we set @xmath246 ) .",
    "when we consider the epi model , we apply the penalization technique using operator @xmath134 given by ( [ eq : penbeta ] ) with @xmath247 ( observe that this corresponds to nothing else but the rta approximation ) . concerning the value of @xmath76",
    ", we choose a simple form given by @xmath248 as we already observed , in this work we assume @xmath76 has a constant for a given value of @xmath1 .",
    "we recall here that more accurate choices are possible for @xmath76 , i.e. @xmath249 , and we remind to a future work for a deeper analysis of this aspect .    in all our numerical tests",
    "the discretization in the velocity space is obtained using @xmath250 gauss - hermite quadrature points , with @xmath251 : there are 8 nodes for positive velocities and 8 for negative ones ( we used scaled values in order to consider the range @xmath252 $ ] , with @xmath253 ) .",
    "the influence of the number of quadrature points on the accuracy of the results is treated , for instance , in @xcite .",
    "the imex schemes we used for our simulations are the second order imex ars-(2,2,2 ) scheme @xcite and the third order imex bpr-(3,5,3 ) scheme @xcite . for the sake of completeness",
    "we report the butcher tables of the schemes in the appendix .",
    "we compare our results also with a simple first order imex scheme , obtained by combining the first order implicit and explicit euler schemes .",
    "a reference solution is always reported for all the tests .      in this problem",
    "we have a potential well in the left half of the slab .",
    "we test the behavior of the scheme when the system is subject to a constant in time , electric field which varies along the @xmath79-axis : it ranges from a minimum value of -10 to a maximum value of @xmath254 .",
    "we perform simulations in both kinetic and fluid regimes , using both scattering kernels . + in the kinetic regime , i.e. @xmath255",
    ", we stop our simulations at time @xmath256 , with @xmath257 $ ] using @xmath258 grid points and with an initial distribution given by @xmath259 . at the boundaries we set the values @xmath260 and @xmath261 and we approximate them as described in previous section .",
    "the other parameters of the simulations are @xmath262 with @xmath263 .",
    "since we are in the kinetic regime , the time step is given by the hyperbolic condition @xmath264 for this test we set the cfl constant to @xmath265 for all schemes .    )",
    "i order , ( @xmath266 ) ii order and ( @xmath267 ) iii order ) mass distributions in the kinetic regime @xmath255 with potential well for the rta model , @xmath268 . on the @xmath79-axis the space variable , on the @xmath269-axis the mass @xmath41 . ]",
    "the computed solutions of the mass density are presented in figure [ fig : test0_rta ] .",
    "we show results for the rta kernel since the obtained results for the epi model are similar .",
    "we compare the reference density , obtained with a fourth order explicit rk scheme with third order weno reconstruction using @xmath270 , with the first , second and third order imex approximations .",
    "as expected , the third order scheme gives a more accurate solution .",
    "next in figure [ fig : test1_rta ] we report the results obtained in the fluid regime in the rta case .",
    "we set in this case @xmath271 and stop the simulation at @xmath272 using @xmath258 grid points while the other parameters are the same as in the kinetic test case . now the time step is @xmath273 with @xmath274 for all orders .",
    "the reference solution in this case is obtained as in @xcite with @xmath270 .    )",
    "i order , ( @xmath266 ) ii order and ( @xmath267 ) iii order ) mass distributions in the limit regime @xmath271 with potential well for the rta model , @xmath275 . on the @xmath79-axis the space variable , on the @xmath269-axis the mass @xmath41 . ]",
    "results clearly show that we are able to overcome the very severe time step restriction that would be necessary for this kind of test , using standard techniques , while still attaining high order of accuracy . indeed",
    ", a simple explicit integrator would require @xmath276 with @xmath277 .",
    "on the other hand , an imex strategy without the implicit treatment of the diffusive term would require @xmath278 , which is @xmath279 times smaller then ours .",
    "indeed , we are able to compute the solution with only a linear dependence of @xmath69 on @xmath279 which is given by ( [ eq : dtm ] ) .      in this test",
    "we study the behavior of the scheme when a non zero source term is present .",
    "the system consists of a diffusive slab with a flat interior source and a constant electric field @xmath280 .",
    "the setting of the problem is as follows : @xmath257 $ ] , @xmath281 and @xmath282 .",
    "the initial distribution is @xmath283 and at the boundaries we set @xmath284 and @xmath285 .",
    "we perform the simulation in the kinetic regime , i.e. @xmath255 , and we stop computations at time @xmath286 , using @xmath258 grid points . the solution for the epi model",
    "is given in figure [ fig : test2_epi ] while that for the rta model is given in figure [ fig : test2_rta ] .",
    "for both tests the hyperbolic time step condition @xmath287 is imposed .",
    "the reference solution is again obtained with a fourth order explicit rk scheme and weno reconstruction with @xmath270 .    )",
    "i order , ( @xmath266 ) ii order and ( @xmath267 ) iii order ) mass distributions in the kinetic regime @xmath255 with a constant electric field and non zero source term for the epi model , @xmath268 . on the @xmath79-axis the space variable , on the @xmath269-axis the mass @xmath41 . ]    ) i order , ( @xmath266 ) ii order and ( @xmath267 ) iii order ) mass distributions in the kinetic regime @xmath255 with a constant electric field and non zero source term for the rta model , @xmath268 . on the @xmath79-axis the space variable , on the @xmath269-axis the mass @xmath41 . ]",
    "the figures show the good behavior of the numerical schemes . in the epi case it is possible to see the difference of the first order from the higher order schemes",
    ". a closer look at the results reveals that higher order methods guarantee more precision with a similar time step condition also in the rta case .    concerning the limit regime , i.e. @xmath288",
    ", the solution at time @xmath289 for the rta model , using @xmath290 grid points and a time step @xmath291 , again with @xmath274 for the three methods is reported in figure [ fig : test3_rta ] . the reference solution in this case",
    "is obtained as in @xcite with @xmath292 , which is @xmath254 times finer then our grid .    )",
    "i order and ( @xmath267 ) iii order ) mass distributions in the limit regime @xmath288 with a constant electric field and non zero source term for the rta model , @xmath275 . on the @xmath79-axis the space variable , on the @xmath269-axis the mass @xmath41 . ]",
    "one can clearly observe that even for coarse discretizations the behavior of the system is well described and that the third order scheme gives very accurate results .",
    "we point out that in this problem the use of an high order in time method gives results which are much more closer to the reference solution than those obtained by a first order in time scheme .",
    "this confirms the importance of developing high order schemes for multiscale problems .      in this last test",
    ", we consider a unipolar diode of type @xmath293 in the diffusive regime @xcite . in this case",
    "the electric field is self - consistently computed by the solution of the poisson equation : @xmath294 where @xmath295 is the scaled debye length , @xmath296 is the voltage applied at the right boundary and @xmath297 is the doping profile @xmath298,\\ ] ] with @xmath299 ( which controls the thickness ) , @xmath300 ( the minimum value ) , @xmath301 and @xmath302 .",
    "we set in addition @xmath288 , @xmath259 , @xmath303 , while the time step is @xmath291 , with @xmath304 .",
    "the other parameters are @xmath305 , \\quad g=0 , \\quad f_l(v ) = m(v ) , \\quad f_r(v)=m(v).\\ ] ] according to @xcite at the boundary we assume @xmath306    ) i order , ( @xmath266 ) ii order and ( @xmath267 ) iii order ) mass distributions for the vlasov - poisson problem in the limit regime @xmath288 for the rta model , @xmath275 . on the @xmath79-axis the space variable , on the @xmath269-axis the mass @xmath41 . ]    the results obtained with the two collision models are very similar and consequently we only report those for the rta approximation . the computed results for the mass density at time @xmath307 with @xmath308 and @xmath309 are given in figure [ fig : test5_rta ] , compared with a reference solution obtained with an explicit solver which is detailed in @xcite with @xmath270 .",
    "for the sake of clarity , we do not show the first order solution since it is very close to the second order one .",
    "this problem ends with a steady solution which shows that our numerical method remains stable in stationary situations .",
    "observe also that , as in the previous cases , the third order approximation gives the better results .",
    "in this paper we have presented an implicit - explicit runge - kutta strategy for the numerical solution of the boltzmann - poisson system for semiconductors in the diffusive scaling .",
    "we established sufficient conditions which permit to get high order in time asymptotic preserving and accurate schemes .",
    "one of the main target of the present work was to overcome the severe time step restrictions to which this kind of problems are usually subject to .",
    "a suitable recombination of the fluxes of the kinetic boltzmann equation with those of the limit diffusive equation , together with an imex strategy , allows us to achieve this goal and to make computation which are subject to a linear time step restriction @xmath5 .",
    "these results have been obtained preserving high order accuracy in time and space for all regimes analyzed . in order to consider more realistic models , a penalization technique which permits to avoid",
    "the costly inversion of non - linear collision operators in the stiff regimes has also been considered .",
    "this allows to treat more realistic physical problems preserving efficiency and without loss of accuracy . in the last part we validated numerically the proposed approach .",
    "the results showed that the desired properties have been obtained .    in the future",
    ", we aim at treating more realistic simulations in the two ( or three ) dimensional setting and to perform a stability analysis of the method developed .",
    "in this appendix we prove the ap property of the schemes proposed .",
    "we start analyzing the imex schemes of type a. for these schemes multiplying equations ( [ strk ] ) and ( [ stjk ] ) by @xmath310 and then setting @xmath176 leads to @xmath311 where @xmath312 and @xmath313 , for @xmath81 are the vectors containing the stages values .",
    "then , since for hypothesis @xmath105 is invertible , we obtain from ( [ eq : equir ] ) that @xmath314 , which implies r^(k ) = p^(k)m , k=1 ,  , .",
    "[ eq : re0 ] moreover , from ( [ eq : equij ] ) it follows that @xmath315 , which implies j = - ( _ r - e_r ) .",
    "[ eq : je0 ] in other words , at each stage the parities @xmath49 and @xmath50 are projected over the equilibrium state . + in the limit @xmath316 , replacing ( [ eq : re0 ] ) and ( [ eq : je0 ] ) in ( [ pkkinsvolta ] ) we get @xmath317 if @xmath74 the above equation is reduced to an arbitrary imex runge - kutta scheme for the drift - diffusion equation in which the diffusion term is discretized implicitly .",
    "we recall in fact that the matrix @xmath105 corresponds to a diagonally implicit runge - kutta method .",
    "let us notice , that at the discrete level the two space derivatives which are related to the transport parts of equations ( [ strk ] ) and ( [ stjk ] ) must be treated with the same numerical scheme otherwise perfect cancellation of the term @xmath318 in equation ( [ pdiscst ] ) is not possible , even if @xmath319=1 .",
    "we analyze now the numerical solution for the macroscopic density in the limit @xmath316 .",
    "this becomes @xmath320 again if the condition @xmath74 is satisfied and the same numerical treatment for the space derivatives is used perfect cancellation of @xmath321 in equation ( [ pdiscsol ] ) is guaranteed .",
    "this means that the diffusive term in the limit is discretized implicitly .    to conclude this part ,",
    "let us observe that an additional requirement may be demanded to our method , namely that in the limit @xmath316 the distribution function is projected over the equilibrium @xmath322 . to find conditions which guarantee this property to be satisfied ,",
    "let us analyze the equation for the parity @xmath323 r^n+1 = r^n + t w^t*f*_1(r , j ) + t w^t _ (  _ r ) + t w^t 1 ^ 2 q(r ) .",
    "replacing @xmath324 in the above equation with its expression obtained from formula ( [ strk ] ) , i.e. @xmath325 , leads to [ eq : nsa ] r^n+1 = r^n + t w^t f_1(r , j ) + t w^tf_2(r ) + w^t a^-1 ( r - r^n - t f_1(r , j ) - t a f_2(r ) ) .",
    "so now , the conditions to satisfy in order to project the distribution function over the equilibrium distribution are @xmath326 , @xmath327 and @xmath328 .",
    "this last condition depends on the stage values vector @xmath130 .",
    "thus the only possibility to satisfy the requirement is that the imex scheme is globally stiffly accurate ( gsa ) . in this case , in fact , we automatically have @xmath329 we can conclude that if the imex scheme is of type a and gsa then @xmath330 .",
    "the request that the matrix @xmath105 is invertible can be very restrictive when high order methods are demanded .",
    "however , under additional hypothesis , we can obtain schemes which are asymptotic preserving , asymptotically accurate with implicit treatment of the diffusive term even when the first row of the implicit runge kutta method contains only zeros . in details",
    ", we can state that if the imex scheme is of type ck and gsa with for initial data which are `` consistent '' with the limit problem then in the limit @xmath316 the scheme ( [ strk])-([numsolj ] ) becomes an imex scheme for the drift diffusion equation ( [ televen ] ) .",
    "the request of consistent initial data means that we want the initial distribution function @xmath331 to be a perturbation of the equilibrium distribution @xmath21 with the perturbation going to zero as @xmath316 . in formulas , for the parities @xmath49 and @xmath50 , the consistency of the initial data with the limit problem ( [ televen ] ) reads r_0=_0 m+g^ , j_0= - _ r_0 + qm e _ r_0 , _ 0 g^=0 .",
    "[ eq : cid ] under these hypothesis , in the limit @xmath316 , in addition to the ap and aa property , the solution is projected over the equilibrium at each time step : @xmath332 .    to prove this ,",
    "let us rewrite all vectors relative to the stages separating the first component from the remaining ones ; for @xmath333 , for example , we have @xmath334 , where the second component is a vector in @xmath335 .",
    "we also define @xmath336 , @xmath337 and similarly for all other vectors .",
    "now for this type of schemes , rewriting ( [ strk ] ) , we obtain @xmath338 while from ( [ numsolr ] ) @xmath339 multiplying ( [ eq : rkck ] ) by @xmath310 and then imposing @xmath176 we obtain @xmath340 since @xmath341 , it holds that @xmath342 and so , being @xmath343 invertible , we have that @xmath344 for @xmath345 , in other words at each stage the distribution function is projected over the equilibrium state .    finally , multiplying ( [ eq : rkck ] ) by @xmath310 leads to @xmath346,\\ ] ] and thus , substituting this equality in ( [ eq : rnp1ck ] ) and using again the fact that @xmath342 , we have @xmath347 again , to assure the projection over the equilibrium of the numerical solution @xmath332 , we need that @xmath348 , @xmath349 , @xmath350 , @xmath351 , @xmath352 and that @xmath353",
    ". these last requirements are automatically satisfied if the imex scheme is also @xmath119 .      in this last part , we prove the ap property of the imex - rk schemes in the penalized case only for type a methods .",
    "a similar proof holds for the ck type scheme under the same additional hypothesis of the non penalized case .",
    "let us rewrite the imex scheme for ( [ eq : penr ] ) in vector form .",
    "the stages are given by @xmath354 while the numerical solution by @xmath355 with @xmath356 being the stages vector of the linearized collision term .",
    "multiplying ( [ eq : penstr ] ) by @xmath310 and imposing @xmath176 , we get the following equality @xmath357 from which : @xmath358 since @xmath359 is lower triangular with diagonal elements equal to zero , we get projection over the equilibrium at each stage @xmath360 concerning the limiting numerical solution we isolate the term @xmath361 in ( [ eq : penstr ] ) and then we substitute it in ( [ eq : pennsr ] ) obtaining @xmath362 observe that , in this case , the numerical solution still depends on @xmath363 , unless we require that our imex scheme satisfies @xmath364 .",
    "this requirement is necessary not only to guarantee the correct projection over the equilibrium but also to be able to actually compute the solution in the limit .",
    "it is easy to verify that the gsa condition is a sufficient condition which permits to guarantee the above requirement but also @xmath365 , @xmath327 , @xmath366 , @xmath367 . in other words that the schemes are ap and that the solution is projected over the equilibrium distribution at each time step .",
    "we report here the butcher tableaux of the second and third order schemes used in our simulations .",
    "namely the second order ars(2,2,2 ) scheme @xcite @xmath368 with @xmath369 and @xmath370 and the third order imex bpr-(3,5,3 ) scheme @xcite @xmath371",
    "the author g. dimarco was supported by the french anr project boost .",
    "j. a. carrillo , i. m. gamba , a. majorana and c. w. shu , a weno - solver for the transients of boltzmann - poisson system for semiconductor devices : performance and comparisons with monte carlo methods , j. comp .",
    "phys . , 184 ( 2003 ) , 498 - 525 .    j. a. carrillo , i. m. gamba , a. majorana and c. w. shu , 2d semiconductor device simulations by weno - boltzmann schemes : efficiency , boundary conditions and comparison to monte carlo methods , j. comp .",
    "phys . , 214 ( 2006 ) , 55 - 80 .                                                                  c. w. shu , essentially non oscillatory and weighted essentially non oscillatory schemes for hyperbolic conservation laws , advanced numerical approximation of nonlinear hyperbolic equations , lecture notes in mathematics , 1697 ( 2000 )"
  ],
  "abstract_text": [
    "<S> in this paper we develop a class of implicit - explicit runge - kutta schemes for solving the multi - scale semiconductor boltzmann equation . the relevant scale which characterizes this kind of problems is the diffusive scaling . </S>",
    "<S> this means that , in the limit of zero mean free path , the system is governed by a drift - diffusion equation . </S>",
    "<S> our aim is to develop a method which accurately works for the different regimes encountered in general semiconductor simulations : the kinetic , the intermediate and the diffusive one . </S>",
    "<S> moreover , we want to overcome the restrictive time step conditions of standard time integration techniques when applied to the solution of this kind of phenomena without any deterioration in the accuracy . as a result , </S>",
    "<S> we obtain high order time and space discretization schemes which do not suffer from the usual parabolic stiffness in the diffusive limit . </S>",
    "<S> we show different numerical results which permit to appreciate the performances of the proposed schemes .    </S>",
    "<S> * keywords:*imex - rk methods , asymptotic preserving methods , semiconductor boltzmann equation , drift - diffusion limit . </S>"
  ]
}