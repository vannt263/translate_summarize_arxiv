{
  "article_text": [
    "the spread of communicable diseases is a dynamical process and as such , understanding and controlling infectious disease outbreaks and epidemics is pertinent to the temporal evolution of disease propagation . historically , this aspect of disease transmission has been studied using coarse - grained dynamical representation of populations , known as compartmental models @xcite . in these models",
    ", a population is divided into a number of epidemiological states ( or classes ) and the time evolution of each is described by a differential equation .",
    "although this approach , and its more complex variants , has been instrumental in understanding several features of infectious diseases over the past 3 decades , it comes with a major simplification .",
    "the simplifying assumption states that the population is `` well mixed '' , _",
    "i.e. _ , every infectious individual has an equal opportunity to infect others .",
    "this assumption may be valid in the broader context of population biology .",
    "human populations , however , tend to contact each other in a heterogeneous manner based on one s age , profession , socio - economic status or behavior , and thus , the well - mixed approximation can not portray an accurate image of disease spread among humans @xcite .",
    "recent advances in network- and percolation - theories , have paved the way for physicists to bring a new perspective to understanding disease spread . over the past decade ,",
    "seminal works by watts and strogatz on small - world networks @xcite , barabasi _ et al .",
    "_ on scale - free networks @xcite and dorogovtsev ,",
    "mendes @xcite , pastor - satorras and vespignani @xcite , among others , on the dynamics of networks , have shed light on a number of intriguing aspects of epidemiological processes . in particular , groundbreaking work by newman _",
    "@xcite has provided a strong foundation for the formulation of epidemiological problems using tools developed by physicists .",
    "various dynamical processes that propagate from neighbour to neighbour on complex ( natural or artificial ) networks , _",
    "e.g. _ , a crawler ( or spider ) browsing the world wide web or rumors spreading in a population , reveals interesting similarities with the spread of epidemics in human population @xcite . in the present work",
    ", we specifically focus on disease propagation as the dynamical phenomenon and use the associated terminology .",
    "our methodology is however quite general and can be applied _",
    "mutatis mutandis _ to other processes that manifest similar dynamical properties .",
    "we are primarily interested in diseases where infected individuals are eventually removed from the dynamics of the system ( _ i.e. _ , infection is followed by naturally - acquired immunity or death ) , implying that the same person can not be infected more than once . at",
    "any given time , we call an individual `` susceptible '' if he has never been exposed to the disease ; `` exposed '' if he has acquired the infection but not currently able to pass on the disease to another person ; `` infectious '' if he is currently able to transmit the infection to others ; `` removed '' if he became immune or succumbed to death after acquiring the infection ; and finally , `` infected '' if he has been exposed to the infectious agent at least once in the past , regardless of his current state ( _ e.g. _ exposed , infectious , removed ) .",
    "network analysis using the generating function formalism , developed by newman _",
    "_ , has proven to be a powerful tool when analyzing the spread of disease within networks @xcite . without directly addressing the question of `` when the transmission occurred ? ''",
    ", it provides reliable results on the final size of an outbreak / epidemic by addressing the question of `` whether transmission occurred ? '' . the first question , _ i.e. _ the time evolution of the system , is presently beyond the formalism as originally derived .",
    "several researchers have recognized the importance of incorporating the notion of time into the generating function formalism that describes percolation dynamics on networks . in broaching this issue ,",
    "many notable advances have been made .",
    "numerous contributions ( for a recent review , see @xcite ) have used an approach closely related to compartmental models to assign a higher strength of infection to nodes of higher degree @xcite .",
    "more recently , marder @xcite has calculated the probability distribution of outbreak sizes as a function of time for infinite - size networks , while volz @xcite has addressed the finite - size effect by deriving estimates of the mean size of a large - scale epidemic , rather than the probability distribution . despite these advances ,",
    "one is required to develop a truly integrated analytical framework that simultaneously encompasses the time progression of disease , the network finite - size effects and the wide variety of possible outcomes .",
    "the major steps towards an integrative formalism are the principal achievement of this paper .",
    "the outline of the paper is as follows . in sec .",
    "[ section : infinitenetformalism ] we define the type of dynamics that will be studied and recall some of the tools used by newman @xcite for infinite networks , to which we add the concept of generations and phase - space representation . in sec .",
    "[ section : discretetimefinitenetwork ] we extend these tools for uses on finite - size networks and sec .",
    "[ section : discussion ] presents some results of our analysis , compares them with some existing models , and discuss possible extensions of the formalism . in sec .",
    "[ section : conclusion ] we give our conclusions and appendices complete the analysis of sec .",
    "[ section : discretetimefinitenetwork ] and [ section : discussion ] .",
    "we map a system of @xmath0 individuals to a _ network _ in which each individual is represented by a _",
    "node _ ( or vertex ) and the connection between each pair of individuals is represented by a _ link _ ( or edge ) .",
    "two nodes are _ neighbours _ if they are joined by a link .",
    "contrary to compartmental approaches , a network representation of a system takes into account that each node does not have the same probability of interacting with every other node ; in fact , one interacts only with its topological neighbours .",
    "each node has a _ degree _",
    "@xmath1 ( number of neighbours ) and the set @xmath2 ( called _ degree sequence _ ) partially defines the network .",
    "similarly , the set of probabilities @xmath3 that a random node has degree @xmath4 is the _ degree distribution_.    in many practical situations , the degree distribution is , together with the size @xmath0 of the network , the only available information on the network structure .",
    "we consider the ensemble of all possible networks obtained by drawing a degree sequence from the provided degree distribution and then , for every node @xmath5 , randomly connect each of its @xmath1 links to those of other nodes ( no _ self - loops _ ) @xcite .",
    "the quantities obtained through this paper are averages on this ensemble .",
    "we add to this maximum entropy definition the restriction that two nodes can not share more than one link ( no _ repeated links _ ) . for sparse graphs  in which the number of links scales linearly with the number of nodes  the probability for such an event decreases as @xmath6 and can be neglected for large networks @xcite .",
    "to perform monte - carlo simulations of epidemic propagations on a network , one requires an explicit knowledge of that network structure .",
    "we have used the following method @xcite to produce a network belonging to the ensemble described above :    1 .   generate a random degree sequence @xmath7 of length @xmath0 subjected to the degree distribution @xmath8 ; 2 .",
    "make sure that @xmath9 is an even number since a link is composed of 2 `` stubs '' ; 3 .   for each @xmath10 , produce a node with @xmath1 stubs ; 4 .   randomly choose a pair of unconnected stubs and connect them together .",
    "repeat until all unconnected stubs are exhausted ; 5 .",
    "test for the presence of self - loops and repeated links .",
    "remove the faulty stubs by randomly choosing a pair of connected stubs and rewire them to the former stubs .",
    "repeat until no self - loop and/or repeated links are found .",
    "with knowledge of the degree sequence of the physical or social network of interest , we can obtain the corresponding degree distribution @xmath3 .",
    "following newman _",
    "_ @xcite and newman @xcite , we define the probability generating function ( _ pgf _ ) @xcite for a random node as @xmath11 respecting the normalization @xmath12 .",
    "the average degree , @xmath13 , can be easily obtained from @xmath14 where the prime denotes the derivative with respect to the argument .",
    "the probability , @xmath15 , that @xmath4 nodes could be reached from the node we arrived at by following a random link ( excluding this link from the count ) , can also be derived as @xmath16    while @xmath17 and @xmath18 contain information about the structure of the physical network linking nodes within the epidemiological system , they do not contain any information about the risk of disease transmission between two neighbouring nodes .",
    "however , with the additional knowledge of the transmissibility , @xmath19  the probability that an infectious node will infect one of its neighbors  we can determine the probability of infecting @xmath20 out of @xmath4 neighbors as @xmath21 the _ pgf _ for the number of infections directly caused by the initially infected node ( `` patient zero '' ) is then @xmath22 similarly , the probability distribution for the number of infections directly caused by a node reached by following a random link is generated by @xmath23 .",
    "we can continue in the same vein and obtain informative results about the final state of the population in an infinite network , after the outbreak / epidemic has ended @xcite ; however , this approach in itself does not yield any information about the duration of the epidemic , its speed of propagation or other time - related quantities .      to study the progression of the outbreak / epidemic over the network , we adopt an approach based on _ generations of infection_. we define _ generation _ @xmath24 as the initial infected node of the outbreak / epidemic ; nodes of generation @xmath25 are those who acquire the disease from a member of generation @xmath26 .",
    "there is clearly a causality link among generations and we would expect nodes of higher generations to become infected , on average , later than those in generations closer to the initial infected node . in a future contribution , we will look more closely into the relationship between generations and continuous time evolution .",
    "we now extend the generating function formalism to introduce a new _ pgf _ for an arbitrary generation @xmath25 @xmath27 as in eq .",
    ", the _ pgf _ for the number of nodes that acquire infection directly from a single node of generation @xmath25 is given by @xmath28 .",
    "this assumption holds when the total number of infected nodes in the current and previous generations is small compared to the size , @xmath0 , of the network .",
    "in such a case , the probability of infecting a node that is already infected is proportional to @xmath6 ; we assume that a node can not be infected twice and the propagation of the disease follows a tree - like structure ( without a closed loop ) .",
    "this condition is fulfilled in large networks either when there is no giant component or when we limit ourselves to the first few generations .",
    "section [ section : discretetimefinitenetwork ] removes these limitations to some extent .    from the properties of the _ pgf _ s ,",
    "the expected number of secondary infections caused directly by an infected node in generation @xmath25 is given by @xmath29 notice that @xmath30 is identical for every generation , except the first one .",
    "it corresponds to a fundamental quantity in epidemiology , the _ basic reproductive number _",
    "@xcite @xmath31 where @xmath32 is the expected number of second neighbors for a randomly chosen node .",
    "@xmath33 implies that the expected number of infectious nodes decreases in consecutive generations , leading to the extinction of the disease .",
    "conversely , @xmath34 implies that the expected number of infectious nodes increases and can potentially lead to an epidemic , which is a _ giant component _ of occupied links in the language of percolation theory @xcite .",
    "it is worth noting that @xmath34 alone does not guarantee the occurrence of an epidemic ; indeed , some realizations may have a number of new infections below the mean value @xmath35 , and therefore lead to the extinction of the disease .      to proceed further",
    ", we define the quantity @xmath36 as the probability of having @xmath37 infected nodes by the end of the @xmath25-th generation , of which @xmath38 became infected during the @xmath25-th generation .",
    "this probability is generated by @xmath39 each element of the ( triangular ) matrix , @xmath36 , can be seen as a possible `` state of infection '' where the @xmath37 and @xmath38 dimensions provide information about the `` position '' ( number of infected ) and `` momentum '' ( new infections ) in the infection space , respectively .    we know from the previous sections that the probability distribution for the number of nodes that acquire infection directly from a single node of generation @xmath26 is generated by @xmath40",
    "moreover , the _ pgf _ for the sum of two independent quantities is given by the product of their _ pgf _",
    "s @xcite .",
    "therefore , the probability @xmath41 that each state @xmath42 of generation @xmath26 leads to @xmath38 new infections in generation @xmath25 is generated by @xmath43^{m ' } \\quad .\\end{aligned}\\ ] ] also , the state @xmath42 has probability @xmath44 at generation @xmath45 and thus makes a contribution @xmath46 to the state @xmath47 at generation @xmath25 .",
    "hence , we obtain the recurrence relation @xmath48^{m ' } = \\sum_{s , m } \\psi_{sm}^g x^s y^m \\label{eq : recurrpsi}\\end{aligned}\\ ] ] with the initial condition @xmath49 ( @xmath50 is the kronecker delta ) . the states for which @xmath51 are absorbing states ; the region above the main diagonal ( @xmath52 ) is forbidden ; and the main diagonal ( @xmath53 ) is only accessible for the initial condition .    finally , inserting eq .",
    "provides the ( _ forward _ ) recurrence relation ( for @xmath54 ) @xmath55^{m ' } \\label{eq : psi0ginf}\\end{aligned}\\ ] ] with the initial condition @xmath56 or @xmath57 , where @xmath50 is the kronecker delta .",
    "equation implies further the recurrence @xmath58 note that @xmath59 generates the probabilities @xmath60 that @xmath37 nodes are infected at generation @xmath25 , independent of the number of new infections .",
    "similarly , @xmath61 generates the probabilities @xmath62 that @xmath38 nodes are infected during generation @xmath25 .",
    "figure [ fig : plinfinite ] illustrates some results of this method for a network of @xmath63 nodes with a power law distribution @xmath64 with @xmath65 , @xmath66 and the transmissibility @xmath67 .",
    "the phase - space representation for generations @xmath68 , @xmath69 and @xmath70 as well as the final state are shown .",
    "figure [ fig : plinfiniteprojection ] provides the corresponding projection @xmath71 on the @xmath37 axis ( solid curves ) .",
    "the numerical results ( crosses ) , theoretical `` infinite - size '' outbreak distribution ( dashed curves ) and theoretical `` infinite - size '' epidemic size ( vertical dashed lines ) are also displayed .",
    "numerical results are obtained by creating an ensemble of @xmath72 equivalent graphs , each of which was used to run @xmath73 simulations , performing @xmath74 epidemic simulations in total . and [ fig : plfinite ] in form of video clips are available from the corresponding author . ]",
    "figure [ fig : plinfiniteprojection ] clearly demonstrates that apart from the small - scale outbreaks , the results from the infinite - size formalism may not correctly predict the outbreak / epidemic size distribution for _ finite - size _ networks when the fraction of the network that has been infected is no longer negligible .",
    "the remedy to this shortcoming is offered in the next section .",
    "as long as one is only interested in the _ initial stage _ of an outbreak , the finite - size of a network has negligible effects on the dynamics of disease spread .",
    "however , the impact of finite - size effects becomes important when a sizable fraction of the network has been affected .",
    "while the size of small outbreaks is mostly governed by stochastic fluctuations , the size of the giant component ( when one exists ) is limited by two principal finite - size effects : the evolution over time of the degree distribution of susceptible nodes and the failure of transmission due to the impossibility of re - infection .    since eq .",
    "exact _ in the infinite limit , we can search for a similar form where the finite - size effects are introduced as a dependency in @xmath75 and @xmath76 of the degree distribution and/or of its parameters . in the following , we describe these effects and how they are introduced into the formalism described in the previous section .",
    "it is worth noting that the finite - size effects considered here , affecting directly the dynamics on the network , should be distinguished from those that alter the structure of the network , for instance through a cutoff in the degree distribution as done in @xcite .      as the disease progresses across the network , susceptible nodes with a higher degree of connectivity",
    "are more likely to acquire the disease than those with fewer connections .",
    "if we focus only on the degree distribution of susceptible cases , the distribution will vary over time ; the portion representing high - degree susceptibles will decrease and the segment representing low - degree susceptibles will increase , to comply with normalization requirements . this variability over time",
    "has a direct effect on the ratio @xmath77 and can lower the reproduction number , @xmath35 , below the threshold value of @xmath78 .",
    "these effects can potentially cause the extinction of the disease although a high number of susceptible nodes is still remaining .",
    "this is particularly important for degree distributions in which some nodes have a degree much higher than the mean degree distribution ( _ e.g. _ , power - law distribution ) : the removal of these nodes will significantly impact the connectivity of the network .    to take this effect into account",
    "we define the generating function for the degree distribution of the remaining susceptibles for the current size , @xmath37 , of the outbreak / epidemic @xmath79 the mean number of susceptibles of degree @xmath4 is thus given by @xmath80",
    ". however , the actual number of susceptibles in a network characterized by @xmath81 will in general be different from the mean value .",
    "nonetheless , the difference becomes negligible in a _ sufficiently large _ population . in this limit , each @xmath82 can be treated as a continuous function of its parameter @xmath37 .",
    "the assumption of a large population is less restrictive than it appears at first glance and , by comparison with the results of numerical simulations presented at the end of this section ( fig .",
    "[ fig : evodegdist ] ) , we can say that it holds for reasonably small populations ( _ e.g. _ @xmath63 for fig .",
    "[ fig : evodegdist ] ) .    since @xmath82 must be normalized ( @xmath83 ) and because the susceptibles of degree @xmath4 have a probability @xmath4 times greater of being newly infected than those of degree @xmath78 , we can derive a differential equation system for the evolution of @xmath82 @xmath84 where the average degree is defined by @xmath85    in the present dynamics , the first infection targets a random susceptible node and thus , does not affect the degree distribution .",
    "therefore , we use the initial condition @xmath86 ( with @xmath87 being the degree distribution of the whole network ) in eq . to get the solution @xmath88^k \\quad , \\label{eq : pksofs}\\end{aligned}\\ ] ] with @xmath89 given by @xmath90 the normalization of @xmath82 leads to the convenient expression @xmath91^k & = g_0\\left(\\theta(s)\\right ) = \\frac{n - s}{n-1 } \\quad .",
    "\\label{eq : g0thetas}\\end{aligned}\\ ] ] moreover , eq . allows us to express @xmath81 in terms of the original @xmath17 as @xmath92    for example , using the poisson distribution @xmath93 in eq .",
    "gives @xmath94^k}{k ! } = e^{-z } e^{z\\theta(s ) } \\quad , \\end{aligned}\\ ] ] from which we can easily isolate @xmath95 \\quad .\\end{aligned}\\ ] ] it follows that the degree distribution of the _ susceptibles _ is also a poisson distribution @xmath96^k / k!\\end{aligned}\\ ] ] with an average degree given by @xmath97 inspection of this last expression reveals that @xmath98 becomes negative when @xmath99 .",
    "this limitation is due to the fact that the large population assumption is no longer respected : it implies the presence of @xmath100 nodes of degree zero , but these nodes can not be infected by the process leading to eq . .",
    "nevertheless , the probability of an epidemic reaching such high values of @xmath37 typically vanishes in most realistic cases .",
    "table [ table : thetas ] compiles the analytic forms of @xmath89 for some typical distributions .",
    "when a closed form satisfying eq .",
    "can not be found , the quantity @xmath82 can nevertheless be derived numerically for each pair of @xmath4 and @xmath37 .    [ cols=\"<,<,<\",options=\"header \" , ]     figure [ fig : evodegdist ] shows the variation of the degree distributions of susceptible nodes for 3 networks : the power - law distribution used in fig .",
    "[ fig : plinfinite ] ; a binomial distribution with @xmath101 and @xmath63 ; and a bimodal distribution , in which the vast majority of nodes ( @xmath102 ) has an average degree of @xmath69 and the rest has an average degree of @xmath103 .",
    "this latter network is particularly interesting as it may correspond to realistic settings such as hospitals , schools or shopping malls .",
    "although slight deviations are caused by the underlying assumptions , there is very good agreement between numerical and analytical results .",
    "once @xmath81 is known , we can show that the degree distribution of the susceptibles in the previous generation is given by @xmath104 . again using mean - value considerations ,",
    "we obtain the degree distribution , @xmath105 , of those that became infectious in the last generation , _",
    "i.e. _ @xmath106 as @xmath107 \\quad .\\end{gathered}\\ ] ] the excess degree of the currently infectious nodes is therefore generated by @xmath108 this distribution can then be used in eq . as a substitute for @xmath109",
    "when finite - size effects can not be neglected .      for networks of finite size , it is no longer possible to completely neglect the effect of closed loops on the dynamics of outbreaks .",
    "indeed , it is possible that some of the neighbors of a newly infected node have previously been infected and , for dynamics where re - infection is impossible , this implies fewer new infections than would have been predicted in an infinite network .",
    "similarly , links between two infectious nodes or links from more than one infectious node to the same susceptible node also reduce the number of new infections .",
    "furthermore , since the pair @xmath75 and @xmath76 completely characterizes the `` state '' of the system in an infinite network , it still carries a lot of information about the corresponding state in finite - size networks .",
    "we thus make the assumption that @xmath75 and @xmath76 are a sufficient basis to incorporate the finite - size effects , _",
    "i.e. _ the loss of transmissions in the finite network that would have occurred in an infinite one .",
    "our main step is to seek a `` mean field '' approximation ( where every parameter other than @xmath75 and @xmath76 is assumed to take its mean value ) to the ratio @xmath110 of mean number of transmissions @xmath111 that _ actually happen _ in the _ finite _ network to the number of transmissions @xmath38 that _ would have occurred _ in an _",
    "infinite _ one .",
    "if each of the @xmath38 infinite network transmissions is treated as having the _ independent _ probability @xmath112 of being lost ( a probability @xmath113 of occurring ) in the finite network , there is then a probability @xmath114 that @xmath111 transmissions occur in the finite network .",
    "similarly , a subgroup @xmath20 of the @xmath38 infinite network transmissions will contribute @xmath115 to the @xmath111 finite network transmissions with probability @xmath116    although these transmissions are not exactly independent events , the independence assumption is a good approximation when the system has many degrees of freedom , _",
    "i.e. _ , it holds when @xmath38 is small compared to the number of susceptibles of nonzero degree .",
    "the probability distributions for @xmath111 ( eq . ) and @xmath115 ( eq . ) therefore hold unless most nodes of the network have been infected , quite unlikely for example in realistic epidemiological applications .",
    "one of the first effects of a non - negligible correlation would typically be a reduction of the variance of the distributions of @xmath111 and @xmath115 .",
    "appendix [ section : rhosm ] provides an expression for @xmath113 under assumptions of continuity ( a differential equation approach similar to the previous section ) for a sizable population , large enough to obtain meaningful mean values .",
    "all but one of these mean values are relatively easy to calculate , the remaining one is derived in appendix [ section : nrsm ] to complete the task .",
    "we now combine the degree distribution of infectious nodes @xmath117 obtained in sec . [",
    "subsection : evodegdist ] with the distribution of @xmath115 to obtain the finite - size network counterpart of eq .",
    "@xmath118    this is now the generating function for the number of new infections caused by a single infectious node in a finite network when the state of the disease is characterized by @xmath75 and @xmath76 ( at generation @xmath25 ) . defining an effective transmissibility @xmath119 , the forward recurrence relation , eq .",
    ", is then replaced by a new expression of the same structure @xmath120^{m ' } \\quad , \\label{eq : psi0gfin}\\end{gathered}\\ ] ] where the evolution of the degree distribution is taken into account by the change @xmath121 while the additional losses of transmissions are introduced by the replacement @xmath122 .",
    "figure [ fig : plfinite ] depicts the phase - space representation for the finite - size power - law network , using the finite - size algorithm of eq . instead of the infinite size approach of eq .",
    "the system studied is identical with that of fig .",
    "[ fig : plinfinite ] and for comparison the infinite - size calculations are superimposed on the new results .",
    "figure [ fig : plfiniteprojection ] presents the corresponding projections on the @xmath37 axis .",
    "there is a major improvement in the agreement with the numerical simulations for all generations and the final state . despite the approximations , and the small size of the network ( @xmath63 ) , this agreement makes us confident that we have captured the major part of the finite - size effects .",
    "furthermore , while the infinite - size formalism produces a single number , @xmath123 , for the giant component size ( represented by the dashed vertical line in fig .",
    "[ fig : plfiniteprojection ] ) , the finite - size formalism produces the _ whole _ probability distribution of sizes above the epidemic threshold .",
    "more on this in the next section .",
    "in what follows , we examine in succession the results of the finite versus infinite formalism on and around the percolation threshold , make a comparison with recent dynamical models of disease propagation , establish the relationship with the reproductive number of epidemiology and briefly discuss possible avenues of improvements concerning clustering and continuous time evolution .",
    "we recall first that the current paper has been strongly influenced by the previous works of @xcite .",
    "their formalism allows for the calculation of the whole distribution of outbreak / epidemic size and probability at the final state of the dynamics ( @xmath124 in the language of this paper ) for infinite networks .",
    "it is based on the _ _",
    "pgf__s @xmath125 and @xmath126 related to @xmath17 and @xmath18 of eqs . and by the relations @xmath127 in particular , the _ pgf _ @xmath125 generates the distribution of size for outbreaks from which the average size of outbreak / epidemic for infinite networks can be expressed as @xmath128 note also that above threshold the fraction of nodes belonging to the giant component is given by @xmath129 ; below threshold @xmath130 as it should .",
    "since sec .",
    "[ section : infinitenetformalism ] is a direct extension of this formalism to discrete time evolution , the values it provides all converge to that of @xcite at the final state of the dynamics .",
    "formally , this is no surprise since as @xmath131 , the recurrence relationship approaches the self - consistency expressions and . in this asymptotic limit , @xmath132 .",
    "similar remarks hold for the work of marder @xcite , another extension of @xcite to discrete time evolution .",
    "by contrast , the formalism of sec . [ section : discretetimefinitenetwork ] takes into account finite - size effects . instead of eq . , the average size of an outbreak / epidemic is now provided by @xmath133 since the distribution @xmath134 is always properly normalized with @xmath135 and @xmath136",
    ".    an important feature of the new formalism is its ability to capture the finite size of an outbreak in the vicinity of the critical transmissibility , @xmath137 , which separates small outbreak and large - scale epidemic zones .",
    "this notion is depicted in fig .",
    "[ fig : plbehaviourthreshold ] where we consider the same power - law network for different transmissibilities @xmath19 ( @xmath138 ) . in an infinite - size network , we observe a `` divergence '' in the outbreak / epidemic size , @xmath139 , just around the transmissibility threshold . however , numerical simulations on finite - size networks ( and similarly real - life outbreaks ) never exhibit such divergence .",
    "figure [ fig : plbehaviourthreshold ] demonstrates that the finite - size formalism can accurately retrieve the size of outbreaks on and around the transmissibility threshold .",
    "away from threshold , infinite and finite methods agree with the simulations , but only the finite - size approach covers smoothly the complete range of transmissibilities without unrealistic divergence",
    ".      it would be informative to compare our method with some other propagation approaches on a structured network .",
    "the chosen models all perform some `` mean field '' approximations that prevent them from taking into account the wide variety of possible outcomes , which can span the whole range from small outbreaks to large - scale epidemics . in effect",
    ", these models can only provide mean values and the quality of the resulting averages is sometimes difficult to estimate .    for the purpose of comparison ,",
    "all the models are defined for the same network ensemble as the one presented in sec .",
    "[ section : infinitenetformalism ] and the quantity that we will focus on is the average size of outbreaks / epidemics at the asymptotic final state of the dynamics .",
    "close in spirit with the present contribution , but technically very different , is the recent approach derived by volz @xcite .",
    "the formalism is based on network - centric quantities ( such as edges linking susceptible nodes to infectious nodes or to other susceptible nodes ) in order to introduce time evolution and finite - size effects .",
    "although it is also based on the _ pgf _ @xmath17 ( eq . ) , it uses a set of differential equations to track the evolution of mean values .",
    "the network - centric quantities are later converted to node - centric quantities , such as the number of infected or susceptible nodes .",
    "the asymptotic ( @xmath140 ) average size of an outbreak / epidemic we are interested in can be cast in the following form @xmath141 where @xmath142 and the full set of differential equations are defined in appendix [ subsection : networkcentric ] .",
    "it is interesting to note that @xmath143 is conceptually related to its counterpart @xmath89 ( eq . ) of the finite - size algorithm , although they are obtained in a completely different manner .",
    "figure [ fig : plbehaviourthreshold ] displays @xmath144 as a function of @xmath19 and shows a remarkable improvement over the infinite size results .",
    "the remaining discrepancy with the simulations and @xmath145 can be attributed to the mean field approximation used where only _ average _ values are evolved in time .",
    "a special class of models for the dynamical propagation on networks is the use of compartmental models where nodes of different degree are placed into different compartments @xcite .",
    "we have integrated the sir - like model of @xcite , whose description is detailed in appendix [ subsection : compartmental ] , to construct the asymptotic average for a population @xmath0 @xmath146 where @xmath147 is the fraction of nodes that are recovered and of degree @xmath4 .",
    "a slight correction to this model has been proposed in @xcite and appendix [ subsection : compartmental ] explains how to obtain the corresponding asymptotic average @xmath148 .",
    "the results seen in fig . [ fig : plbehaviourthreshold ] show large deviations of both models long before the critical @xmath137 for the network and appears valid only for small transmissibility .",
    "the source of failure in reproducing the simulations is quite subtle and has led us to propose an improved version .",
    "although the system appears to be a natural choice , it neglects some important points .",
    "firstly , all infectious nodes ( except the first one ) become infected from one of their neighbors . since a link between two nodes will always remain attached to these two nodes ,",
    "the `` effective '' degree of an infectious node is ( at least ) one less than its actual degree .",
    "we introduce this in the model by transferring nodes from @xmath149 to @xmath150 ( instead of @xmath151 ) . secondly",
    ", an infectious node that infects a previously susceptible node along a given link can not infect again along that same link ; we should reduce the degree of infectious nodes , by one , each time they cause new infections .",
    "thirdly , the same procedure must be done for infectious nodes linked to infectious or removed nodes ( and applied to these infectious or removed nodes , as well ) . to put it differently , the knowledge that no infection occurs carries as much information as the knowledge that an infection occurs and both of these scenarios",
    "must be taken into account when modeling the dynamics of the system .",
    "we have implemented these improvements in the original differential equations ( see appendix [ subsection : improvedcompartmental ] ) and the asymptotic result , say @xmath152 , is plotted in fig .",
    "[ fig : plbehaviourthreshold ] .",
    "the agreement is much better and essentially reproduces the result of volz , @xmath144 .",
    "it seems that our modifications have nicely included the better part of the correct dynamics .",
    "in contrast to the finite - size formalism that takes into account the full stochastic nature of the process , these three systems assumes that the `` average evolution '' occurs at each time .",
    "such an approach seems to be more suitable for an endemic disease in a susceptible - infectious - susceptible ( sis ) dynamics since the stochasticity is averaged when many nodes are infectious at the same time .",
    "when only a small amount of infectious nodes are present at some point in the evolution of the disease ( _ e.g. _ the very beginning ) , the stochastic nature of the dynamics can have tremendous impacts on the long - term behavior of the system .",
    "in particular , it is those very stochastic effects that allow for small components even beyond the epidemic threshold .",
    "systems solely tracking averages can not take into account this important behavior .      in order to establish a link between the present formalism and the classical epidemiological models , it is worth revisiting the interpretation of the basic reproductive number  a key parameter in classical epidemiology @xcite .",
    "we can derive the mean excess degree of the infectious nodes as , @xmath153 , and together with the effective transmissibility @xmath154 , obtain the corresponding _ effective reproduction number _",
    "@xmath155 for each @xmath156 state .",
    "figure [ fig : fieldsplot ] shows the dependency of @xmath157 , @xmath154 , and @xmath158 on @xmath37 and @xmath38 for the networks introduced in fig .",
    "[ fig : evodegdist ] .",
    "the behaviour of the power law distribution is dominated by the variability of @xmath157 , as @xmath154 remains relatively uniform in the vicinity of the epidemic threshold .",
    "however , the converse is true for the binomial distribution ; it is the variability of @xmath154 that is responsible for the behavior of this distribution .",
    "the bimodal distribution is seen as a mixture of these two behaviors .      although most real - world contact networks show a clustered structure , and ways to incorporate this property into the dynamics are rapidly developing @xcite , our model does not at present explicitly account for clustering . in clustered networks , two neighbors of the same node",
    "@xmath10 are more likely to be neighbors of one another than of any other random node .",
    "in fact these `` triangles '' ( or short loops ) are not forbidden in the network ensemble introduced in sec .",
    "[ section : infinitenetformalism ] , and over which our formalism is defined , but their number , however , is ruled by randomness alone and is less than what would be expected in a typical realistic human population for instance . hence , since it has recently been shown that clustering tends to decrease the number of infections in epidemic dynamics @xcite , our model represents a worst case scenario for networks whose clustering properties are stronger than their random values .",
    "one promising way to improve upon the present framework , while keeping the generality of a _",
    "pgf_-based formalism and allowing for better treatment of the evolution on clustered networks , would be to generalize the model to a bipartite graph structure where nodes ( one part of the network ) are assigned to different groups ( the other part of the network ) much in the same spirit as originally studied in @xcite .",
    "another aspect that needs further development is the relationship between discrete ( generational ) and continuous time evolution . for systems where the underlying epidemiological dynamics is a discrete process in time",
    "( _ e.g. _ , there is a constant time interval @xmath159 between successive infections ) , the generational formalism developed in sec .",
    "[ section : infinitenetformalism ] directly represent the evolution of the system over time ( infection of the @xmath25-th generation occurs at time @xmath160 ) .",
    "however , in most natural situations , the underlying dynamics is a continuous process .",
    "we are actively pursuing the issue of a general continuous epidemiological dynamics ; the analysis will be the subject of a forthcoming contribution .",
    "the emergence and re - emergence of infectious diseases pose a great threat to public health .",
    "the potential spread of a new pandemic strain of influenza or other emerging infection , such as sars , may have a devastating impact on human lives and economies .",
    "there is an urgent need to develop reliable quantitative tools that can be used to compare the impact of various intervention strategies in real time .",
    "these tools must be able to incorporate the detailed structure of contact networks responsible for disease spread , as well as compare various intervention outcomes during the time of crisis , in a relatively short time span .",
    "in addition , these tools should be as equally applicable to large - scale networks as to finite - size networks , seeing that many interventions must be implemented not only globally , but locally ( _ e.g. _ , hospital settings , schools ) as well .    in this paper ,",
    "we have introduced and validated a theoretical framework that enables us to incorporate these two important aspects of disease outbreaks / epidemics , simultaneously . specifically an extension to the existing formalism",
    "has been derived while keeping its appealing structure in terms of generating functions . with the introduction of the concept of generations and phase - space representation , eq .  for the infinite - size network with fixed transmissibility @xmath19  has been replaced by eq . to account for finite - size effects through a modified generating function and an effective transmissibility .",
    "this is our finite - size , discrete time algorithm .",
    "one of its important features is its ability to follow the complete diversity of outcomes , not only averages , from small clusters ( outbreaks ) to the giant component ( epidemic ) within each generation . a complete formalism including both finite - size and continuous time with or without correlations between transmissions is still lacking and its derivation is part of ongoing research .",
    "bp would like to acknowledge the support of the canadian institutes of health research ( grants no . mop-81273 and ppr-79231 ) , the michael smith foundation for health research ( senior scholar funds ) and the british columbia ministry of health ( pandemic preparedness modeling project ) .",
    "pan and bd were supported by the above grants and pan is also thankful to cihr for a doctoral scholarship .",
    "ljd is grateful to nserc ( canada ) and fqrnt ( qubec ) for continuing support .",
    "it is important to take into account that the number @xmath111 of new infections that actually occur in a finite network will typically be smaller than the number @xmath38 of new infections that would have happened in an infinite network . as presented in sec .",
    "[ subsection : addlosstrans ] , the @xmath38 links leaving infectious nodes and causing new infections in the infinite network can lead to either susceptible nodes , other infectious nodes or recovered nodes . of these links , only those leading to susceptibles nodes can actually result in new infections in the finite network and , moreover , a susceptible node targeted by more than one of these links contributes to only one transmission .",
    "we note by @xmath162 , @xmath163 and @xmath164 the number of links that are _ not forbidden _ to join infectious nodes to susceptible nodes , other infectious nodes and recovered nodes respectively .",
    "since there is no special restriction forbidding susceptible nodes to be linked to infectious ones , @xmath162 is simply the sum of the degrees of all susceptibles . in the same way",
    ", @xmath163 is the sum of the excess degree of the infectious nodes ( since the sole restriction is that , for generations other than zero , there is at least one link from each infectious nodes to a recovered one ) .",
    "when the state of the infection is characterized by @xmath75 and @xmath76 , these considerations translate to the mean values @xmath165 where @xmath166 and @xmath167 are defined in eq . and",
    "eq . respectively .",
    "more complicated constraints apply to @xmath164 and its mean value @xmath168 is obtained separately in appendix [ section : nrsm ] .",
    "we develop two methods to evaluate @xmath161 , the ratio of the mean number of new infections occurring in the finite network to the number of new infections that would have occurred in an infinite one .",
    "both methods are based on the assumption that the @xmath38 links leading to infections in the infinite limit have the same _ a priori _ probability of targeting any of the @xmath162 , @xmath163 and @xmath164 targets , which is justified when @xmath169 is large compared to the degree of the node of highest degree in the network and is typically satisfied unless most of the network has been infected .",
    "the first of these methods is quick and simple .",
    "the second method is based on a differential equation approach similar to the one used in sec .",
    "[ subsection : evodegdist ] .",
    "as both methods bring the same result , this second approach is an additional justification of the differential equation method for cases where an alternative approach is not known , as in appendix [ section : nrsm ] for instance .",
    "since the @xmath38 links causing infections in the infinite network can lead to @xmath169 potential targets in the finite one , each link belonging to a susceptible node ( _ i.e. _ one of the @xmath162 targets ) has a probability @xmath170 to be one of these links .",
    "if that node is of degree @xmath4 , there is a probability @xmath171 that _ at least one _ of the @xmath38 links leads to it , causing a new infection . using the degree distribution of the susceptibles obtained in sec .",
    "[ subsection : evodegdist ] and the fact that @xmath172 susceptibles are left when the state of the infection is characterized by @xmath75 and @xmath76 , the expected number of new infections in the finite network is then @xmath173 \\nonumber \\\\ & = ( n - s ' ) \\left [ 1 - g_0^s(1 - \\lambda ; s ' ) \\right ] \\quad .",
    "\\label{eq : meantildemquickeasy}\\end{aligned}\\ ] ]    therefore , with the use of eqs .",
    "( [ eq : nsspmp][eq : meantildemquickeasy ] ) , the ratio @xmath161 is provided by @xmath174}{\\tilde{g}_{g-1}'(1;s',m ' ) } \\label{eq : rhospmpexpression}\\end{aligned}\\ ] ] where @xmath175 and @xmath168 is given in appendix [ section : nrsm ] .      in this approach , we relax the numerous constraints of the problem by changing the task to an `` assignment process '' evolving in time . by analogy",
    ", this process is similar to the system children use for their casual sports team when two leaders choose their team members one by one .",
    "it should be clear that the time dependency introduced in this manner is an artificial construct and that only the result at @xmath176 ( `` assignments of teams is completed '' ) is relevant .",
    "we define @xmath177 as the pool of potential infections that occur in the infinite network and for which a target has yet to be assigned at time @xmath178 .",
    "this definition implies the initial condition @xmath179 ; we must also have @xmath180 ( the process must assign a target to each potential infection ) .",
    "we also define @xmath181 , the pool of targets for which assignment of one of the potential infections does not lead to a new infection , yielding the initial condition @xmath182 .",
    "we finally define @xmath183 , the pool of targets belonging to susceptible nodes of degree @xmath4 and to whom the assignment of a potential infection leads to an actual new infection in the finite network . from mean value considerations ,",
    "@xmath184 with @xmath185 .",
    "since the time dependence is arbitrary , we assign targets to the potential infections at a rate proportional to their current population @xmath177 , which is a simple way to obtain @xmath180 . with the definition @xmath186 the probability of assigning a potential infection to other potential infections , other targets not leading to infections , or to targets leading to infections belonging to degree @xmath4 is @xmath187 , @xmath188 and @xmath189 , respectively . moreover , upon assignment of a potential infection to a target belonging to @xmath183 , we transfer the remaining @xmath190 targets to @xmath181 to ensure that later assignment to these targets will not lead to new infections .",
    "these considerations translate into a set of coupled nonlinear differential equations : @xmath191 \\\\ \\frac{d\\beta(t)}{dt } & = -\\alpha(t ) \\frac{\\beta(t)}{\\omega(t ) } + \\sum_k \\alpha(t ) \\frac{\\gamma_k(t)}{\\omega(t ) } ( k - 1 ) \\\\",
    "\\frac{d\\gamma_k(t)}{dt } & = -\\alpha(t ) \\frac{\\gamma_k(t)}{\\omega(t ) } k \\end{split}\\end{aligned}\\ ] ] for all @xmath4 . by summing these terms , we note that @xmath192 , together with @xmath193 , yields the solution @xmath194 where @xmath195 .",
    "this result allows us to rewrite the equation governing @xmath183 as @xmath196 which is completely decoupled from the rest of the system .",
    "this equation has the solution @xmath197 and produces the limit @xmath198 the number of nodes of degree @xmath4 that are infected in the process is thus @xmath199 using the initial conditions , we obtain the average total number of infections in the finite network @xmath200 \\quad .\\end{aligned}\\ ] ] notice that this expression is the same as eq . and thus leads to the same @xmath113 , _",
    "i.e. _ eq . .",
    "while it is quite easy to obtain mean values or even distributions for @xmath163 , @xmath162 and @xmath38 , an independent method is required to evaluate the quantity @xmath164 . here , we use a continuous approach similar to that of appendix [ section : rhosm ] .    again",
    ", we design a differential equation governing the evolution of the continuous counterpart of @xmath164 , denoted @xmath201 , as a function of the number of infections , @xmath37 .",
    "if the @xmath202 excess degrees belonging to a newly infected node , of degree @xmath4 , are linked to susceptible nodes , we expect a fraction @xmath203 of them to be unsuccessful in transmitting the infection to others and thus , contribute to @xmath201 .",
    "however , we expect a fraction , @xmath204 , of the @xmath202 excess degrees to be linking to recovered nodes , with @xmath205 .",
    "these last links actually _ reduce _ the value of @xmath201 , because links between susceptible and recovered nodes are converted to links between recovered and infectious nodes . defining @xmath206",
    "the differential equation considering these effects reads @xmath207 \\nonumber \\\\ & = \\frac{z_2^s(s)}{z_1^s(s ) } \\left [ ( 1-t ) - ( 2-t)\\frac{\\eta(s)}{\\langle n_s(s ) \\rangle } \\right ] \\quad .\\end{aligned}\\ ] ] together with the initial condition @xmath208 , this differential equation can be integrated numerically to provide an expectation value for the number of links between recovered and susceptible nodes when the size of the outbreak / epidemic is @xmath37 .",
    "the quantity @xmath168 , required to fix @xmath209 in appendix [ section : rhosm ] , is the mean number of links emerging from recovered nodes that are allowed to target infectious nodes when we know the current state of the epidemic is characterized by @xmath75 and @xmath76 . as @xmath76 is the current number of infectious nodes , the size of the outbreak / epidemic was",
    "@xmath210 when these infectious nodes were still susceptible nodes ( in the previous generation ) . at that time",
    ", we expect @xmath211 links to join susceptible and recovered nodes ; this number is equal to the expectation value @xmath168 .",
    "the following models are all defined for the same network ensemble as the one presented in sec .",
    "[ section : infinitenetformalism ] , _ i.e. _ their degree distribution @xmath3 is generated by @xmath17 .",
    "[ [ volz-2008-a - network - centric - approach - subsectionnetworkcentric ] ] volz ( 2008 ) : a network - centric approach [ subsection : networkcentric ] ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    at time @xmath178 , let @xmath143 be the fraction of degree one nodes that remain susceptible , @xmath212 , the probability that a susceptible node be connected to an infectious one and @xmath213 , the probability that a susceptible node be connected to a susceptible one , then @xmath214 where @xmath215 is the force of infection , the constant rate at which infectious nodes infect a neighbor and @xmath216 the recovery rate at which infected nodes become recovered . for the purpose of calculations , we have chosen @xmath217 and a related transmissibiliy @xmath218 @xcite .",
    "the initial conditions have been set to @xmath219 , @xmath220 and @xmath221 for @xmath222 satisfying @xmath223 . the asymptotic ( @xmath140 )",
    "average size of outbreak and/or epidemic is then given by @xmath224    [ [ moreno - et - al.-2004-a - compartmental - approach - subsectioncompartmental ] ] moreno _ et al . _",
    "( 2004 ) : a compartmental approach [ subsection : compartmental ] ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    at time @xmath178 , let @xmath225 be the fraction of nodes that are susceptible ( @xmath226 and @xmath227 for the infectious and the removed nodes respectively ) _ and _ of degree @xmath4 subject to the normalization @xmath228        note that a slight correction to this model has been proposed in @xcite in order to take into account that infectious nodes acquired their infection along one of their links and that new transmission is impossible along that link .",
    "the corresponding asymptotic average size of outbreak and/or epidemic @xmath148 is obtained in the same way as for the compartmental approach except that the factor @xmath4 in eq .",
    "has to be replaced by @xmath190 .",
    "[ [ an - improved - compartmental - approach - subsectionimprovedcompartmental ] ] an improved compartmental approach [ subsection : improvedcompartmental ] ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    incorporating in eq .",
    "the improvements described in sec.[section : discussion ] results in a new differential system @xmath235 \\\\ \\frac{dr_k^*(t)}{dt } & = \\phantom{+}i_k^*(t ) + r \\ , \\theta^*(t ) \\bigl [ \\bigl(k + 1\\bigr ) r_{k + 1}^*(t ) - k r_k^*(t ) \\bigr ] \\end{split } \\quad .",
    "\\label{equation : improvedmoreno}\\end{aligned}\\ ] ] @xmath236 is the the corresponding expression for @xmath237 ( eq . [ eq : theta ] ) and the integration is carried out under the same initial conditions .",
    "the asymptotic average size of outbreak and/or epidemic is then also @xmath238 both infinite differential systems and are truncated at @xmath239 in numerical simulations ."
  ],
  "abstract_text": [
    "<S> mathematical models of infectious diseases , which are in principle analytically tractable , use two general approaches . </S>",
    "<S> the first approach , generally known as compartmental modeling , addresses the time evolution of disease propagation at the expense of simplifying the pattern of transmission . </S>",
    "<S> the second approach uses network theory to incorporate detailed information pertaining to the underlying contact structure among individuals while disregarding the progression of time during outbreaks . </S>",
    "<S> so far , the only alternative that enables the integration of both aspects of disease propagation simultaneously _ while preserving the variety of outcomes _ has been to abandon the analytical approach and rely on computer simulations . </S>",
    "<S> we offer a new analytical framework , which incorporates both the complexity of contact network structure and the time progression of disease spread . </S>",
    "<S> furthermore , we demonstrate that this framework is equally effective on finite- and `` infinite''-size networks . </S>",
    "<S> this formalism can be equally applied to similar percolation phenomena on networks in other areas of science and technology .    </S>",
    "<S> = 1 </S>"
  ]
}