{
  "article_text": [
    "in this paper , we study the initial - boundary value problem ( ibvp ) associated to the heat equation and develop a new method of simulation based on the walk on moving sphere algorithm ( woms ) .",
    "the main objective is to construct an efficient approximation to the solution of the ibvp .",
    "the solution is a @xmath0 function @xmath1 satisfying @xmath2 where @xmath3 is a continuous function defined on @xmath4 , @xmath5 is continuous on @xmath6 and @xmath6 denotes a bounded finitely connected domain in @xmath7 . for compatibility reasons we have",
    "also @xmath8 .",
    "the foundation stone of our work is the probabilistic representation for the solution of a partial differential equation .",
    "suppose that we are looking for the solution @xmath9 of some pde defined on the whole space @xmath7 .",
    "under suitable hypothesis we can use the classical form @xmath10 $ ] where @xmath11 is a stochastic process , satisfying a stochastic differential equation , and @xmath3 a known function . in order to approximate @xmath9 ,",
    "the strong law of large number allows us to construct monte carlo methods once we are able to propose an approximating procedure for the stochastic process @xmath12 .",
    "the problem is more difficult when considering problems with boundary conditions .",
    "nevertheless if some regularity is provided we can also find a probabilistic approach . a generic representation , for the solution of the dirichlet problem in a domain @xmath6 ( the solution does not depend on time ) , is @xmath13,\\ ] ] where",
    "@xmath14 are given functions , @xmath15 and @xmath16 .",
    "we refer to several classical books for more details @xcite .",
    "the problem is hard to address as , in order to give an approximation , we need to approach the hitting time , the exit position and sometimes even the path of the process @xmath17 up to exit the domain @xmath6 .    in particular situations we need to characterize either the hitting time @xmath18 or the exit position",
    "@xmath19 , and these problems reveal quite difficult .",
    "the main goal of our work is to handle a more complex situation by unearthing numerical algorithms for the couple @xmath20 itself .    to fix ideas and present a brief history , consider the simple dirichlet problem for laplace s equation in a smooth and bounded domain @xmath21 : @xmath22 we recall the associated probabilistic representation : @xmath23 $ ] where @xmath24 here stands for the @xmath25-dimensional brownian motion starting in @xmath26 .",
    "the original idea in order to approximate @xmath27 by using the walk on spheres algorithm ( wos ) goes back to mller @xcite .",
    "the idea consists in constructing a step by step @xmath7-valued markov chain @xmath28 with initial point @xmath29 which converges towards a limit @xmath30 , @xmath30 and @xmath19 being identically distributed .",
    "let us roughly describe @xmath31 : first , we choose @xmath32 the largest sphere centered in @xmath33 and included in @xmath6 .",
    "the first exit point @xmath34 from the sphere @xmath32 for the brownian motion starting from @xmath33 has an uniform distribution on @xmath35 and is easy to sample .        the construction is pursued with the new starting point given by @xmath34 ( see figure [ wos - figure ] ) .",
    "the algorithm goes on and stops while reaching the boundary @xmath36 . in order to avoid an infinite sequence of hitting times the stopping criteria of",
    "the algorithm includes a @xmath37 test : we stop the markov chain as soon as @xmath38 ( @xmath39 represents here the euclidean distance in @xmath7 ) .",
    "convergence results depending on @xmath37 and on the regularity of @xmath36 can be found in mller @xcite and mascagni and hwuang @xcite .",
    "generalization of this result to a constant drift , by means of convergence theorems for discrete - time martingales , was proposed in the work of villa - morals @xcite , @xcite .",
    "binder and braverman @xcite gave also the complete characterization of the rate of convergence for the wos in terms of the local geometry of @xmath6 .",
    "other elliptic problems have been studied by gurov , whitlock and dimov @xcite .",
    "if needed , we can also approach the boundary hitting time by using the explicit form of its probability distribution function .",
    "however , a real difficult leap appears when we want to move from the simulation of @xmath17 to the simulation of @xmath40 .",
    "for example , if the domain is a sphere then @xmath19 can be simulated by the uniform random variable on the @xmath36 while @xmath41 has an explicit pdf function which is not suited for numerical approaches as it depends on the bessel function .    in previous works @xcite , @xcite ,",
    "@xcite the authors discussed the connexion between the hitting times of the bessel process and brownian ones and introduced a new technique for approximating both the hitting time and the exit position .",
    "these previous studies on the hitting time form the foundation of our current work .",
    "we propose a new algorithm , involving a random walk on heat balls belonging to the domain @xmath42\\times\\mathcal{d}$ ] ( see @xcite p.53 for a definition of the heat ball ) which approaches @xmath43 in general domains . thus we obtain a method for approximating the solution of the equation . let us mention at this stage that sabelfeld @xcite already described a random walk @xmath44 for solving the initial - boundary value problem for the heat equation .",
    "his approach is essentially different : first of all his random walk is valued only on the boundary @xmath42\\times\\partial \\mathcal{d}$ ] and secondly the main argument is based on solving an integral equation of the second kind rather than using monte - carlo techniques .",
    "a nicely written description of the method can be find in @xcite .",
    "let us just note that such algorithm which permits to evaluate @xmath9 is less accurate for large time @xmath45 or non convex domains @xmath6 .",
    "let us now introduce the main results concerning the algorithm random walk on heat balls which approximates @xmath46 , @xmath47 being a @xmath25-dimensional brownian motion .",
    "we just introduce first some preliminary notations : we recall that @xmath48 is the euclidean distance between the point @xmath26 and the boundary of the domain and introduce the function @xmath49 . in the following",
    ", @xmath50 stands for a sequence of independent uniformly distributed random vectors on @xmath51^{\\lfloor d/2\\rfloor+1}$ ] , @xmath52 denote the product of all its coordinates , @xmath53 is a sequence of independent standard gaussian r.v . and @xmath54 a sequence of independent uniformly distributed random vectors on the unit sphere of dimension @xmath25 , centered on the origin .",
    "we assume these three sequences to be independent .",
    "let us define : @xmath55 and construct a sequence @xmath56 by the following procedure ( figure [ woms - figure ] ) .",
    "+    ]    * algorithm *    * algorithm outcomes : * we get thus @xmath57 and @xmath58 the number of steps . +",
    "we propose an approximation of the solution to by using the definition : @xmath59+\\mathbb{e}_{(t , x)}[f_0(x_\\varepsilon)1_{\\ {   x_\\varepsilon\\notin\\partial \\mathcal{d } \\ } } ] , \\quad \\mbox{for}\\quad ( t , x)\\in[0,t]\\times\\overline{\\mathcal{d}}.\\ ] ]    we will prove the convergence of this approximation in proposition [ thm : approx ] : + * convergence result . *",
    "_ let us assume that the initial - boundary value problem admits an unique @xmath60\\times\\mathcal{d})$]-solution @xmath1 , defined by .",
    "we introduce the approximation @xmath61 given by .",
    "then @xmath61 converges towards @xmath1 , as @xmath62 , uniformly with respect to @xmath63 .",
    "moreover there exist @xmath64 and @xmath65 such that @xmath66\\times\\mathcal{d}.\\ ] ] _ an important result , based on the construction of a submartingale related to the riesz potential , completes the convergence of the algorithm : + * efficiency result . *",
    "_ let @xmath67 be a @xmath68-thick domain .",
    "the number of steps @xmath58 , of the approximation algorithm , is almost surely finite .",
    "moreover there exist constants @xmath69 and @xmath70 both independent of @xmath63 such that @xmath71\\le c|\\log \\varepsilon|,\\quad \\mbox{for all } \\ \\varepsilon\\le \\varepsilon_0.\\ ] ] _ the material is organized as follows . in the second section we present mean value properties for the heat equation which plays a central role in the definition of the algorithm .",
    "the third section constructs the random walk on heat balls used to solve the initial - boundary value problem . in section 4 ,",
    "we introduce the stopping procedure of the algorithm and prove the convergence result .",
    "the rate of the algorithm is also analyzed .",
    "we end up the paper with numerical results for two particular domains .",
    "these illustrations corroborate the accuracy of the algorithm .",
    "in this section we will discuss the link between solutions of the heat equation and a particular version of the mean value property .",
    "this link is also an essential tool in the study of the classical dirichlet problem .",
    "let us first note that due to the time reversion , the solution of the initial - boundary value problem for the heat equation is directly related to the solution of the terminal - boundary value problem for the backward heat equation ( heat equation with negative diffusion ) . due to this essential property , we are going to first present a mean value property for the _ backward heat equation _ and then deduce a similar property for the heat equation .",
    "let @xmath72 be an open non empty set of @xmath73 .",
    "a function @xmath74 is said to be a _ reverse temperature _ in @xmath72 if @xmath75 is a @xmath0-function satisfying @xmath76    [ prop : me ] let @xmath77 be a non empty open set . if a function @xmath75 is a _ reverse temperature _ in @xmath72 then it has the following mean value property : @xmath780,1[\\times\\mathbb{s}^d}\\frac{1}{s}\\ , h(t+\\alpha s , x+2\\sqrt{\\alpha}\\psi_d(s)y)\\,\\psi_d^d(s)\\,{\\mathrm{d}}\\sigma(y)\\,{\\mathrm{d}}s,\\ ] ] where @xmath79 is the @xmath25-dimensional sphere of radius @xmath80 , @xmath81 is the lebesgue measure on @xmath79 and @xmath820,1[.\\ ] ] equation is satisfied for any @xmath83 such that @xmath84\\times \\overline{b(x,2\\sqrt{\\alpha d/(2e)})}\\subset a$ ] .",
    "here @xmath85 stands for the euclidean ball centered in @xmath26 of radius @xmath86 , i.e. @xmath87 .    the mean value formula is quite different and more general than the classical formula associated to the heat equation ( see , for instance , theorem 3 on page 53 in @xcite ) . nevertheless , after some transformations on , it is possible to obtain the classical mean value property .",
    "these transformations consist in time reversion and integration with respect to a particular probability distribution function with compact support .",
    "these main ideas appear implicit in the proof of proposition [ prop : regul ] , the details being left to the reader .",
    "let @xmath88 be defined by @xmath89 and let us consider the associated function @xmath90 we introduce @xmath91 a standard @xmath25-dimensional brownian motion and define by @xmath92 the following hitting time @xmath93 let us just notice that this hitting time is bounded by @xmath94 and its distribution function is given by proposition 5.1 in @xcite @xmath95 furthermore the exit location @xmath96 is uniformly distributed on the sphere of radius @xmath97 .",
    "let us consider @xmath75 a reverse temperature on @xmath72 .",
    "by it s formula , we obtain @xmath98 if @xmath99 is small enough , then @xmath100 a.s . using the fact that @xmath75 is a reverse temperature in @xmath72 , in particular , the continuity of @xmath101 is known",
    ", we can prove that the stochastic integral introduced in the it formula is a martingale .",
    "hence the stopping time theorem leads to @xmath102.\\ ] ] by , we get @xmath103 we introduce the change of variable @xmath104 , such that @xmath1050,1[$ ] , and observe that @xmath106 where @xmath107 is defined by .",
    "we get @xmath108 using both the explicit expression of @xmath109 and the classical formula @xmath110 leads to .    the reverse statement of the preceding result",
    "can also be proved .",
    "the first step consists in the following    [ prop1 ] if @xmath75 satisfies the mean value property and is a @xmath0-function for any @xmath111 and @xmath83 such that @xmath84\\times \\overline{b(x,2\\sqrt{\\alpha d/(2e)})}\\subset a$ ] , then @xmath75 is a _ reverse temperature _ in @xmath72 .    let us consider the function @xmath112\\to \\mathbb{r}$ ] defined by @xmath113 for any @xmath114\\times\\mathbb{s}^d$ ] . using the taylor expansion , we get @xmath115 where @xmath116 is uniform with respect to both @xmath117 and @xmath118 variables",
    ". the derivatives of @xmath119 can be computed explicitly and we get : @xmath120 @xmath121 applying the mean value property to both sides of , we obtain @xmath122 where @xmath123\\times\\mathbb{s}^d}\\frac{1}{s}\\,\\psi_d^{d+1}(s)y_j\\,{\\mathrm{d}}\\sigma(y)\\,{\\mathrm{d}}s,\\\\   a_1&=\\frac{\\alpha}{\\gamma(d/2)}\\iint_{(s , y)\\in [ 0,1]\\times\\mathbb{s}^d}\\psi_d^d(s)\\,{\\mathrm{d}}\\sigma(y)\\,{\\mathrm{d}}s,\\\\ a_{i , j}&=\\frac{2\\alpha}{\\gamma(d/2)}\\iint_{(s , y)\\in [ 0,1]\\times\\mathbb{s}^d}\\frac{1}{s}\\ , \\psi_d^{d+2}(s)y_iy_j \\,{\\mathrm{d}}\\sigma(y)\\,{\\mathrm{d}}s.\\end{aligned}\\ ] ] by symmetry arguments , we have @xmath124 and @xmath125 for @xmath126 .",
    "let @xmath127 be a random variable whose probability distribution function is @xmath128}(t).\\ ] ] let us just notice that @xmath129 , @xmath130 being defined by .",
    "then @xmath131 where @xmath132 is a random variable which has the gamma distribution of parameters @xmath133 and @xmath134 .",
    "in particular , @xmath127 has the same distribution as @xmath135 if @xmath25 is even ( here @xmath136 is a sequence of standard uniform independent random variables ) and @xmath127 has the same distribution as @xmath137 if @xmath25 is odd ( here @xmath132 is a standard gaussian r.v .",
    "independent of the sequence @xmath138 ) . therefore if @xmath25 is even , we deduce @xmath139=\\alpha\\mathbb{e}[u_1^{2/d}]\\mathbb{e}[u_2^{2/d}]\\ldots \\mathbb{e}[u_{(d+2)/2}^{2/d}]=\\alpha \\big ( \\frac{d}{d+2 } \\big)^{(d+2)/d}.\\ ] ] for the odd case , @xmath139=\\alpha\\mathbb{e}[u_1^{2/d}]\\mathbb{e}[u_2^{2/d}]\\ldots \\mathbb{e}[u_{\\lfloor d+2\\rfloor/2}^{2/d}]\\mathbb{e}[e^{-g^2/d}]=\\alpha \\big ( \\frac{d}{d+2 } \\big)^{\\lfloor d+2\\rfloor / d}\\mathbb{e}[e^{-g^2/d}].\\ ] ] let us now compute @xmath140 for @xmath141 .",
    "first we observe that @xmath142 so using a convenient change of variable , we get @xmath143=\\alpha \\left(\\frac{d}{d+2}\\right)^{(d+2)/d}\\quad \\mbox{if}\\ d\\ \\mbox{is even},\\end{aligned}\\ ] ] and @xmath144 $ ] if @xmath25 is odd .",
    "so we note that for any @xmath145 , we proved that @xmath146 where @xmath147 is the kronecker s symbol .",
    "equation leads therefore to .    in order to prove the equivalence between the notion of",
    "_ reverse temperature _ and the mean value ( mv ) property defined in , we prove that the mv formula implies the regularity of the solution .",
    "this is the case when the dimension of the space is large enough .",
    "intuitively the regularity increases as the dimension of the space increases .",
    "[ prop : regul ] let @xmath148 and let @xmath75 be a bounded function , defined on an open set @xmath72 and satisfying the mean value property . then @xmath75 is a @xmath149-function .    in the historical proof of the regularity associated to the laplace operator ( proposition 2.5 in @xcite ) ,",
    "the key argument is to introduce a convolution with respect to a @xmath150-function with compact support . for the heat equation",
    ", one needs to handle quite differently and will not be able to prove regularity of infinite order in any case .",
    "let us assume that @xmath151 is a bounded function satisfying the mean value property for @xmath152 small enough , smaller than some @xmath153 .",
    "we introduce a @xmath154- probability distribution function function @xmath155 whose support is included in @xmath156 $ ] with @xmath157 . rewriting the straightforward equality @xmath158 leads to the following mean value property @xmath1590,1[\\times\\mathbb{s}^d } k(\\alpha ) h(t+\\alpha s , x+2\\sqrt{\\alpha}\\psi_d(s)y)\\,\\frac{\\psi_d^d(s)}{s}\\,{\\mathrm{d}}\\sigma(y)\\,{\\mathrm{d}}s\\,{\\mathrm{d}}\\alpha.\\ ] ] in order to do calculation , it is more convenient in this situation to use spherical coordinates in @xmath79 ; for @xmath160 we define @xmath161 by @xmath162 where @xmath163 $ ] , @xmath164 $ ] and @xmath165 .",
    "the change of measure is therefore given by @xmath166 let us now consider another system of coordinates @xmath167 replacing @xmath168 and given by : @xmath169 we recall that @xmath165 by convention .",
    "let us just observe that @xmath170 hence @xmath171 and @xmath172 .",
    "the jacobian determinant of the change of variable is equal to : @xmath173 the mean value property therefore becomes : @xmath174 let us just note that , for the particular choice @xmath175 with @xmath176 , we obtain the classical mean value formula presented in the statement of theorem 3 p. 53 in @xcite .",
    "of course in this case the condition on the smoothness of @xmath155 is not satisfied .    since @xmath83 if and only if @xmath177 and since the support of @xmath155 belongs to @xmath178 , we can replace the integration domain @xmath73 by @xmath179 . the formula can be written as the following convolution integral @xmath180 where @xmath181 in fact , the support of the function @xmath182 is compact due to @xmath155 whose support belongs to @xmath156 $ ] .",
    "the aim is now to deduce the regularity property of @xmath75 from that of @xmath182 .",
    "+   + step 1 . _ regularity with respect to the time variable . _",
    "+ for any @xmath183 , we choose a small neighborhood of the form @xmath184t_0-\\eta , t_0+\\eta[\\times b(x_0,\\eta)$ ] which is contained in @xmath72 and we are going to prove that @xmath75 is @xmath185 with respect to the time variable in this neighborhood .",
    "+ let us denote by @xmath186 then @xmath187 introducing @xmath188 defined by @xmath189 which is a @xmath150 function with compact support due to the regularity of the function @xmath155 and since the support of @xmath155 does not contain a small neighborhood of the origin , we obtain @xmath190 hence @xmath191 let us fix @xmath192 .",
    "we can observe that both @xmath193 and @xmath194 are continuous for @xmath195 that is for @xmath196 belonging to @xmath197 ( the complementary set is negligible for the lebesgue measure ) .",
    "moreover , due to the compact support of @xmath155 , for any @xmath65 small enough , there exists a constant @xmath198 such that @xmath199 hence implies the existence of @xmath200 , @xmath201 and @xmath202 independent of @xmath203 , @xmath1 and @xmath45 such that @xmath204 for any @xmath63 in @xmath184t_0-\\eta , t_0+\\eta[\\times b(x_0,\\eta)\\subset a$ ] .",
    "the right hand side of is integrable as soon as the space dimension satisfies @xmath148 .",
    "since @xmath75 is a bounded function the lebesgue theorem permits to apply results involving differentiation under the integral sign .",
    "the function @xmath75 is therefore @xmath185 with respect to the time variable .",
    "+   + step 2 .",
    "_ regularity with respect to the space variable . _",
    "+ the computation is quite similar as in the first step .",
    "we have : @xmath205 and @xmath206 the second derivative is a continuous function on @xmath207 . since @xmath208 is @xmath150 with a compact support , we know that @xmath152 is bounded and therefore , using , we obtain the following bound : @xmath209 ( here @xmath200 is just a generic constant : the values can change from one computation line to the following one ) .",
    "the conclusion is based on the same argument presented in step 1 : the boundedness of @xmath75 permits to conclude that @xmath75 is @xmath210 with respect to the space variable as soon as @xmath148 .",
    "let us note that the heat equation and the laplace equation have some similar properties .",
    "in particular , solutions of these equations are automatically smooth .",
    "more precisely , if @xmath211 and is a reverse temperature then @xmath212 ( see for instance theorem 8 page 59 in @xcite ) .",
    "in fact , as soon as the dimension @xmath25 is large enough ( @xmath148 ) , the mean value property implies the smoothness as an immediate consequence of proposition [ prop : regul ] .",
    "all results presented so far in this section have an important advantage , they can be adapted to other situations for instance by looking backward in time , or equivalently time reverting .",
    "this observation permits to study properties of the heat equation .",
    "a function @xmath74 is said to be a _ temperature _ in @xmath72 if @xmath75 is a @xmath0-function satisfying the heat equation : @xmath213    by proposition [ prop : me ] , proposition [ prop1 ] and proposition [ prop : regul ] , we obtain the following :    [ thm1 ]    1 .",
    "let @xmath77 be a non empty open set .",
    "if a function @xmath75 is a _ temperature _ in @xmath72 then it has the following mean value property : @xmath2140,1[\\times\\mathbb{s}^d}\\frac{1}{s}\\ , h(t-\\alpha s , x+2\\sqrt{\\alpha}\\psi_d(s)y)\\,\\psi_d^d(s)\\,{\\mathrm{d}}\\sigma(y)\\,{\\mathrm{d}}s,\\ ] ] where @xmath79 is the @xmath25-dimensional sphere of radius @xmath80 , @xmath81 is the lebesgue measure on @xmath79 and @xmath107 is defined in .",
    "equation is satisfied for any @xmath83 such that @xmath215\\times \\overline{b(x,2\\sqrt{\\alpha d/(2e)})}\\subset a$ ] .",
    "2 .   if @xmath75 satisfies the mean value property and is a @xmath0-function for any @xmath111 and @xmath83 such that @xmath215\\times \\overline{b(x,2\\sqrt{\\alpha d/(2e)})}\\subset a$ ] then @xmath75 is a _ temperature _ in @xmath72 .",
    "3 .   for @xmath148 ,",
    "any bounded function @xmath75 is a temperature iff it satisfies the mean value property .",
    "this section deals with existence and uniqueness for solutions of the initial - boundary value problem in a bounded domain @xmath6 . these results are deeply related to the existence of a particular time - discrete martingale : we define @xmath216 a sequence of @xmath217-valued random variables . in order to define this sequence",
    "we introduce @xmath48 the euclidean distance between the point @xmath26 and the boundary of the domain .",
    "we also introduce the function @xmath152 given by : @xmath218    let us consider :    * @xmath50 a sequence of independent uniformly distributed random vectors on @xmath51^{\\lfloor d/2\\rfloor+1}$ ] .",
    "we denote by @xmath52 the product of all coordinates of @xmath219 .",
    "* @xmath53 a sequence of independent standard gaussian r.v . * @xmath54 a sequence of independent uniformly distributed random vectors on the unit sphere of dimension @xmath25 , centered on the origin .",
    "further , we assume that these three sequences are independent .",
    "we define by @xmath220 the natural filtration generated by the sequences @xmath221 , @xmath222 and @xmath223 .",
    "let @xmath224 note the trivial @xmath81-algebra .",
    "let us introduce : @xmath225 the initial value of the sequence @xmath226 is then @xmath227 and the sequence is defined by recurrence as follows : for @xmath228 , @xmath229 x_{n+1}=x_n+2\\sqrt{\\alpha(t_n , x_n)}\\psi_d(r_{n+1})v_{n+1}. \\end{array}\\right.\\end{aligned}\\ ] ] let us first note that , due to the definition , the sequence @xmath226 belongs always to the closed set @xmath42\\times \\overline{\\mathcal{d}}$ ] : the sequence is therefore bounded .",
    "moreover as soon as @xmath230 reaches the boundary of @xmath42\\times \\overline{\\mathcal{d}}$ ] its value is frozen .",
    "[ lem : matg ] if @xmath75 belongs to @xmath231\\times \\overline{\\mathcal{d}})$ ] and if it is a temperature in @xmath42\\times \\mathcal{d}$ ] , then @xmath232 is a bounded @xmath233-martingale .",
    "since @xmath75 is a continuous function on a compact set , it is bounded .",
    "therefore the stochastic process @xmath234 itself is bounded .",
    "we obtain @xmath235&=\\mathbb{e}[h(t_{n+1},x_{n+1})|\\mathcal{f}_n]=:h(t_n , x_n),\\end{aligned}\\ ] ] where @xmath236.\\end{aligned}\\ ] ] since the pdf of @xmath237 is given by @xmath238}(s)$ ] and since @xmath239 is uniformly distributed on the sphere , we obtain : @xmath2400,1[\\times\\mathbb{s}^d}\\frac{1}{s}\\ , h(t-\\alpha(u , v ) s , x+2\\sqrt{\\alpha(u , v)}\\psi_d(s)y)\\,\\psi_d^d(s)\\,{\\mathrm{d}}\\sigma(y)\\,{\\mathrm{d}}s.\\end{aligned}\\ ] ] if @xmath75 belongs to @xmath231\\times \\overline{\\mathcal{d}})$ ] and if it is a temperature in @xmath42\\times \\mathcal{d}$ ] , then theorem [ thm1 ] implies the mean value property .",
    "hence @xmath241 .",
    "we deduce easily that @xmath242=h(t_n , x_n)=\\mathcal{m}_n\\quad a.s.\\ ] ]    [ lem : cv ] the process @xmath243 converges almost surely as @xmath244 to a limit @xmath245 that belongs to the set @xmath2460,t[\\times \\partial \\mathcal{d}$ ] .",
    "let us consider the function @xmath247 the @xmath248-th coordinate of @xmath192 .",
    "we observe that @xmath75 is a temperature and belongs to @xmath249 . by lemma [ lem : matg ]",
    ", we deduce that @xmath250 , the @xmath248-th coordinate of @xmath251 , is a bounded martingale therefore it converges a.s . towards @xmath252 .",
    "since all coordinates converge we deduce that @xmath253 a.s .",
    "+ moreover since @xmath254 is a non - increasing sequence of non negative random times , it converges a.s . towards a r.v .",
    "@xmath255 which belongs to @xmath42 $ ] .",
    "the sequence @xmath226 belongs to the closed set @xmath42\\times\\overline{\\mathcal{d}}$ ] , consequently its limit belongs to the same set . + let us change the starting point of the markov chain by replacing @xmath63 by @xmath245 we obtain a constant markov chain @xmath256 for all @xmath228 .",
    "let us assume that this limit does not belong to @xmath2460,t[\\times \\partial \\mathcal{d}$ ] then @xmath257 a.s .",
    "we deduce that @xmath258 a.s . for this new markov chain since their first coordinates are different a.s .",
    "this fact obviously can not be satisfied by a constant markov chain , therefore @xmath2590,t[\\times",
    "\\partial \\mathcal{d}$ ] .",
    "[ prop : uniq ] _ ( uniqueness ) _ set @xmath260 .",
    "let @xmath1 be a @xmath60\\times\\mathcal{d})$]-function satisfying the initial - boundary value problem and continuous with respect to both variables on @xmath261\\times \\overline{\\mathcal{d}}$ ] .",
    "then @xmath1 is unique and given by the expression @xmath262+\\mathbb{e}_{(t , x)}[f_0(x_\\infty)1_{\\ {   x_\\infty\\notin\\partial \\mathcal{d } \\ } } ] , \\quad \\mbox{for}\\quad ( t , x)\\in[0,t]\\times\\overline{\\mathcal{d}}.\\ ] ]    by lemma [ lem : matg ] , the process @xmath234 is a bounded martingale .",
    "moreover lemma [ lem : cv ] implies that @xmath226 converges to @xmath245 .",
    "since @xmath1 is a continuous function , we deduce that @xmath234 converges a.s . and",
    "in @xmath263 towards @xmath264 . in particular , the martingale property leads to @xmath265.\\ ] ] in order to conclude it suffices to use the initial and boundary conditions .",
    "indeed lemma [ lem : cv ] ensures that @xmath245 belongs to the set @xmath2460,t[\\times \\partial \\mathcal{d}$ ] .",
    "we refer to friedman @xcite for the existence of a solution to the initial - boundary value problem .",
    "more precisely , if the following particular conditions are fulfilled :    * @xmath3 and @xmath5 are continuous functions such that @xmath8 , * the domain has an outside strong sphere property ,    then there exists a smooth solution @xmath1 to : @xmath266 .",
    "this statement results from a combination of theorem 9 page 69 and corollary 2 page 74 in @xcite .",
    "the aim of this section is to contruct an algorithm which approximates @xmath9 , the solution of an initial - boundary value problem when @xmath63 is given . for the dirichlet problem such an algorithm",
    "was introduced by mller @xcite and is called the _ random walk on spheres_. we are concerned with the heat equation instead of the laplace equation and therefore propose an adaptation of this algorithm in order to consider also the time variable .",
    "the algorithm is based on the sequence of random variables @xmath243 defined by .",
    "+ we introduce a stopping rule : let @xmath65 be a small parameter , we define @xmath58 the stopping time : @xmath267 where @xmath152 is given by .    1 .   if @xmath268 then we choose @xmath269 such that @xmath270 and we denote by @xmath271 .",
    "if @xmath272 then we set @xmath273 and @xmath274 .",
    "we are now able to give an approximation of the solution to by using the definition : @xmath275+\\mathbb{e}_{(t , x)}[f_0(x_\\varepsilon)1_{\\ {   x_\\varepsilon\\notin\\partial \\mathcal{d } \\ } } ] , \\quad \\mbox{for}\\quad ( t , x)\\in[0,t]\\times\\overline{\\mathcal{d}}.\\ ] ]    [ thm : approx ] let us assume that the initial - boundary value problem admits an unique @xmath60\\times\\mathcal{d})$]-solution @xmath1 , defined by .",
    "we introduce the approximation @xmath61 given by .",
    "then @xmath61 converges towards @xmath1 , as @xmath62 , uniformly with respect to @xmath63 .",
    "moreover there exist @xmath64 and @xmath65 such that @xmath66\\times\\mathcal{d}.\\ ] ]    using the definition of @xmath1 ( resp .",
    "@xmath61 ) in ( resp . )",
    ", we obtain : @xmath276 is a bounded martingale and since @xmath58 is a finite stopping time , we can apply the optimal stopping theorem leading to @xmath277\\times\\mathcal{d } } \\max\\big\\{\\big| \\frac{\\partial u}{\\partial t}(t , x ) \\big|,\\big|\\frac{\\partial u}{\\partial x}(t , x)\\big|\\big\\}.\\end{aligned}\\ ] ] taking into account the two different situations @xmath272 or @xmath268 , we deduce that @xmath278 the statement follows with the particular choice @xmath279 .",
    "let us now focus our attention on the number of steps needed by the algorithm before stopping . in order to present the main result",
    ", we need some particular properties on the domain @xmath6 . + in the sequel",
    ", we shall assume that @xmath6 is a @xmath68-thick domain , that is : there exists a constant @xmath69 ( so - called the thickness of the domain ) such that @xmath280 here @xmath281 denotes the @xmath25-dimensional hausdorff content of the set @xmath282 .",
    "this property is namely satisfied by    * convex domains ; * domains satisfying a cone condition ; * bounded domains with a smooth boundary @xmath36 .",
    "we observe that the assumption is quite weak . for such domains , we can prove the following rate of convergence .",
    "[ thm : mean - number ] let @xmath67 be a @xmath68-thick domain .",
    "the number of steps @xmath58 , of the approximation algorithm , is almost surely finite .",
    "moreover there exist constants @xmath69 and @xmath70 such that @xmath283\\le c|\\log \\varepsilon|,\\quad \\mbox{for all } \\ \\varepsilon\\le \\varepsilon_0.\\ ] ]    the proof of this result is an adaptation of the classical random walk on spheres @xcite .",
    "nevertheless the dynamics of both coordinates of the random walk on spheres @xmath56 being definitively different , this adaptation requires a quite tedious effort .",
    "in particular , we need to introduce a particular submartingale , based on the random walk , whose properties permit to prove the rate of convergence .      we consider in this section the @xmath68-thick domain @xmath6 which is included in the unit ball of @xmath7 ( assumption of theorem [ thm : mean - number ] ) .",
    "we introduce the set @xmath284 of all borel measures @xmath285 supported inside @xmath286 and outside of @xmath6 , satisfying the following condition : @xmath287 let us define the so - called _ energy function _ @xmath288 : @xmath289 where @xmath290 stands for the riesz potential of the measure @xmath285 , that is , @xmath291 the definition of @xmath288 obviously implies that @xmath292 for any @xmath192 .",
    "[ rem ] binder and bravermann @xcite gave several properties of this energy function .",
    "we just recall some of them :    1 .   since the set of measures @xmath284 is weakly@xmath293-compact , there exists a family of measures @xmath294 , belonging to @xmath284 , such that @xmath295 . this property will play a crucial role in the proof of proposition [ prop : classic ] .",
    "the energy function @xmath288 is subharmonic in @xmath6 .",
    "consequently , due to the construction of the random walk @xmath226 which is based on uniform random variables on moving spheres , the process @xmath296 is a submartingale with respect to the filtration generated by @xmath56 : @xmath297 hence @xmath298\\ge u(x_n)\\quad a.s.\\ ] ] 3 .",
    "easy computations on the riesz potential permits to prove that @xmath299 in particular , we obtain an important property of the submartingale @xmath296 : @xmath300    these properties , of the energy function @xmath288 , permit to sketch the proof of the convergence in the classical random walk on spheres case . indeed we know that @xmath301 is a submartingale and the algorithm stops before @xmath301 becomes too large .",
    "so , it suffices to focus the attention on the time needed by the submartingale to exceed some given large threshold .    in the algorithm described by",
    ", a large value of @xmath301 is not sufficient to ensure that the stopping rule has been reached .",
    "indeed the stopping procedure depends on both space and time variables , through the condition : @xmath302 .",
    "that s why we need to adapt the classical study by considering a martingale based on the riesz potential but taking also into account the decreasing time sequence @xmath303 .",
    "+ let us define the _ modified energy function _ on @xmath73 by @xmath304 this function will play a similar role as the energy function ( in the classical case ) .",
    "in particular , if we apply @xmath305 to the sequence @xmath226 , we obtain a submartingale with nice properties .",
    "[ lem : submart ] we define @xmath306 .",
    "then the process @xmath307 is a @xmath233-submartingale .",
    "first we can notice that @xmath308 by jensen s inequality ( see lemma [ lem : appen : jensen ] ) and using the submartingale property of @xmath301 , we obtain @xmath309&=\\mathbb{e}\\big[\\max\\big\\{\\frac{1}{2 } \\log\\frac{3}{t_{n+1}},u(x_{n+1})\\big\\}\\big\\vert \\sigma(t_n , x_n)\\big]\\\\ & \\ge \\mathbb{e}\\big[\\max\\big\\ { \\frac{1}{2}\\log\\frac{3}{t_{n}},u(x_{n+1})\\big\\}\\big\\vert \\sigma(t_n , x_n)\\big]\\\\ & \\ge \\max\\big\\{\\frac{1}{2 } \\log\\frac{3}{t_{n}},\\mathbb{e}[u(x_{n+1})\\vert \\sigma(t_n , x_n)]\\big\\}\\\\ & \\ge \\max\\big\\ { \\frac{1}{2}\\log\\frac{3}{t_{n}},u(x_n)\\big\\}=\\mathbb{u}_n.\\end{aligned}\\ ] ] we deduce that @xmath310 is a submartingale as announced .    in order to describe an upper - bound for the sequence @xmath311 $ ] , we first point out an inequality relating @xmath312 to the function @xmath313 , which plays an essential role in the algorithm .",
    "[ lem : ineg ] there exists a constant @xmath314 ( depending only on the space dimension @xmath25 ) such that @xmath315    on one hand , the definition of @xmath313 in implies that @xmath316 and consequently @xmath317 using the property , we obtain @xmath318 on the other hand , the definition of @xmath313 also implies @xmath319 combining both inequalities , we deduce that @xmath320 satisfies with @xmath321 .",
    "an immediate consequence of lemma [ lem : ineg ] is an @xmath263-bound of @xmath322 , @xmath323 fixed .",
    "[ prop : l2bound ] let @xmath227 .",
    "there exist two constants @xmath201 and @xmath202 such that , @xmath324\\le ( c_1+c_2 n)^2,\\quad\\mbox{for}\\quad n\\ge \\kappa-\\frac{1}{2}\\log(\\alpha(t , x)).\\ ] ] here @xmath325 stands for the constant defined in lemma [ lem : ineg ] .",
    "let us first recall that @xmath306 .",
    "due to the definition of the function @xmath288 , we observe that @xmath292 for any @xmath192 and consequently @xmath326 and @xmath327 .",
    "due to lemma [ lem : ineg ] , we shall focus our attention on @xmath328 .",
    "+ first we notice that leads to @xmath329 hence @xmath330 moreover by , @xmath331 by its definition , @xmath332 , and we obtain @xmath333 and therefore @xmath334 let us define @xmath335 . combining and we finally obtain @xmath336 let us just note that @xmath337 is a family of independent and identically distributed random variables and @xmath63 is the starting position of the algorithm . let us recall that @xmath327 .",
    "we obtain @xmath338&\\le\\mathbb{e}\\big [ \\big(\\kappa-\\frac{1}{2}\\log(\\alpha(t_n , x_n))\\big)^2 \\big]\\le \\mathbb{e}\\big [ \\big ( \\kappa-\\frac{1}{2}\\log(\\alpha(t_0,x_0 ) ) + \\sum_{k=1}^n w_k\\big)^2 \\big]\\\\ & \\le 2\\big ( \\kappa-\\frac{1}{2}\\log(\\alpha(t , x))\\big)^2 + 2\\mathbb{e}\\big[\\big(\\sum_{k=1}^n w_k\\big)^2 \\big]\\\\ & \\le   2\\big ( \\kappa-\\frac{1}{2}\\log(\\alpha(t , x))\\big)^2 + 2{\\rm var}\\big ( \\sum_{k=1}^n w_k \\big)+2\\mathbb{e}\\big[\\sum_{k=1}^n w_k \\big]^2\\\\ & \\le 2\\big ( \\kappa-\\frac{1}{2}\\log(\\alpha(t , x))\\big)^2   + 2n { \\rm var}(w_1)+2n^2(\\mathbb{e}[w_1])^2\\\\ & \\le 2n { \\rm var}(w_1)+2n^2(\\mathbb{e}[w_1]^2 + 1),\\end{aligned}\\ ] ] due to the hypothesis @xmath339 .",
    "so lemma [ lem : born ] implies the statement of the proposition [ prop : l2bound ] : the upper - bound is quadratic with respect to @xmath323 .",
    "let us now point out a lower - bound for the expected value of the submartingale : @xmath340)_{n\\ge 0}$ ] .",
    "[ prop : lower : mean ] there exist two constants @xmath341 and @xmath342 , such that @xmath343\\ge c_3+c_4n,\\quad n\\ge 1.\\ ] ]    since @xmath307 is a submartingale we know that @xmath340)_{n\\ge 0}$ ] is a non - decreasing sequence , but we need even more .",
    "in fact , due to the following lower - bound : @xmath344 it suffices to point out the existence of a constant @xmath345 such that @xmath346-\\mathbb{e}[\\mathbb{v}_n]\\ge l_0,\\quad \\forall n\\ge 0.\\ ] ] in order to compute such a lower - bound , we consider two cases : either @xmath347 ( event denoted by @xmath348 ) or @xmath349 ( event denoted by @xmath350 ) .",
    "+ _ step 1 .",
    "_ first case : @xmath347",
    ". then the definition of the random walk implies that @xmath351 hence @xmath352 let us denote by @xmath353>0 $ ] . since @xmath301 is a submartingale ( @xmath288 being subharmonic in @xmath6 ) , we get @xmath354&=\\mathbb{e}\\big [ \\frac{1}{4}\\,\\log\\frac{3}{t_{n+1}}1_{\\mathcal{t}_n } \\big]+\\frac{1}{2}\\,\\mathbb{e}\\big[\\mathbb{e } [ u(x_{n+1})|\\mathcal{f}_n]1_{\\mathcal{t}_n } \\big]\\nonumber \\\\ & \\ge \\mathbb{e}\\big [ \\frac{1}{4}\\,\\log\\frac{3}{t_{n}}1_{\\mathcal{t}_n } \\big]+l_1\\mathbb{p}(\\mathcal{t}_n)+\\frac{1}{2}\\,\\mathbb{e}\\big[u(x_{n})1_{\\mathcal{t}_n } \\big]\\nonumber \\\\ & \\ge \\mathbb{e}\\big [ \\mathbb{v}_{n}1_{\\mathcal{t}_n } \\big]+l_1\\mathbb{p}(\\mathcal{t}_n).\\end{aligned}\\ ] ] _ step 2 . _",
    "second case : @xmath349 .",
    "let us recall that the random walk satisfies : @xmath355 where @xmath237 is a continuous random variable whose support is the whole interval @xmath51 $ ] and whose distribution does not depend on @xmath323 . observe also that @xmath356 is also a continuous random variable with support @xmath51 $ ] .",
    "in other words , on the event @xmath349 and given @xmath357 , the @xmath358-th step of the random walk is exactly the same as the @xmath358-th step of the classical random walk on spheres ( see the appendix [ sec : appen ] ) with radius @xmath359 , for which we can obtain some lower - bound . so using proposition [ prop : classic ] , we obtain @xmath360&=\\mathbb{e}\\big [ \\frac{1}{4}\\,\\log\\frac{3}{t_{n+1}}1_{\\overline{\\mathcal{t}}_n } \\big]+\\frac{1}{2}\\,\\mathbb{e } [ u(x_{n+1})1_{\\overline{\\mathcal{t}}_n } ] \\nonumber    \\\\ &",
    "\\ge \\mathbb{e}\\big [ \\frac{1}{4}\\,\\log\\frac{3}{t_{n}}1_{\\overline{\\mathcal{t}}_n } \\big ] + \\frac{1}{2}\\,\\mathbb{e}\\big [ \\mathbb{e } [ u(x_{n+1})|\\sigma(r_{n+1},t_n , x_n)]1_{\\overline{\\mathcal{t}}_n } \\big]\\nonumber    \\\\ & \\ge   \\mathbb{e}\\big [ \\frac{1}{4}\\,\\log\\frac{3}{t_{n}}1_{\\overline{\\mathcal{t}}_n } \\big ] + \\frac{1}{2 } \\,\\mathbb{e } [ ( u(x_{n})+l1_{\\{\\delta/4<1- \\rho(r_{n+1})<\\delta/2 \\}})1_{\\overline{\\mathcal{t}}_n } ] \\nonumber    \\\\ & \\ge \\mathbb{e}\\big [ \\mathbb{v}_{n}1_{\\overline{\\mathcal{t}}_n } \\big]+\\frac{l}{2}\\mathbb{p}(\\{\\delta/4<1- \\rho(r_{n+1})<\\delta/2\\ } \\cap \\overline{\\mathcal{t}}_n)\\\\ & = \\mathbb{e}\\big [ \\mathbb{v}_{n}1_{\\overline{\\mathcal{t}}_n } \\big]+l_2 \\mathbb{p}(\\overline{\\mathcal{t}}_n),\\end{aligned}\\ ] ] where @xmath361 , @xmath237 and @xmath226 being independent . finally taking the sum of and , we obtain with @xmath362 .",
    "we end here the preliminary results concerning the submartingale @xmath307 .",
    "we are now ready to deal with the rate of convergence of the random walk on moving spheres .",
    "let us consider the algorithm @xmath56 given by and stopped as soon as @xmath363 .",
    "we assume that the starting position satisfies @xmath364",
    ". then the mean number of steps is bounded and the bound depends on @xmath365 .",
    "if the starting position @xmath63 satisfies @xmath366 then the algorithm stops immediately ( @xmath367 a.s . ) and the statement is satisfied . from now on",
    ", we assume that @xmath368 .",
    "+ _ step 1 . a remark on the stopping rule .",
    "_ the statement of theorem [ thm : mean - number ] concerns @xmath58 , see , the first time the random walk @xmath56 hits a @xmath37-neighborhood of the boundary . let us introduce another stopping rule concerning @xmath306 , @xmath305 being defined by : @xmath369 let us now point out that @xmath370 a.s . for @xmath37 small enough ( more precisely , we need @xmath371 ) .",
    "+ indeed , let us consider the first case : @xmath372 , then implies that @xmath373 .",
    "moreover , due to the condition @xmath371 , we get @xmath374 and therefore @xmath302 .",
    "+ on the other side , if @xmath375 then @xmath376 and finally @xmath302 .",
    "so we deduce that @xmath377 implies that @xmath302 . in the sequel",
    ", we will find an upper - bound for the mean value of @xmath378 .",
    "+   +   + _ step 2 . _",
    "the aim of the second step is to prove the existence of an integer @xmath379 and a constant @xmath380 both independent with respect to the starting position of the random walk @xmath227 and independent of the parameter @xmath37 such that @xmath381 for @xmath37 small enough .",
    "let us note that the complementary event satisfies , by definition , @xmath382 where @xmath383 and @xmath384 .",
    "we deduce that there exists a particular choice of the integer @xmath385 such that , for @xmath37 small enough , @xmath386 where @xmath387 and @xmath388 are defined in proposition [ prop : lower : mean ] .",
    "so it is sufficient to find a lower - bound of @xmath389 which should be positive when @xmath155 is large . by proposition [ prop : l2bound ] , there exist two constants @xmath201 and @xmath202 such that @xmath324\\le ( c_1+c_2 n ) ^2 , \\quad \\mbox{for any}\\ n\\ge \\kappa-\\frac{1}{2}\\log(\\alpha(t , x)).\\ ] ] due to the condition on the initial position @xmath368 , the previous inequality is satisfied for @xmath390 when @xmath37 is small enough . in particular , it is satisfied for @xmath391 .",
    "we obtain @xmath392&=\\mathbb{e}\\big[\\mathbb{u}_k1_{\\ { \\mathbb{u}_k\\le\\alpha_k \\}}\\big]+\\mathbb{e}\\big[\\mathbb{u}_k1_{\\ { \\mathbb{u}_k>\\alpha_k\\}}\\big]>c_3+c_4k.\\end{aligned}\\ ] ] then by an application of and the cauchy - schwarz inequality , we get @xmath393}\\sqrt{\\mathbb{p}(\\mathbb{u}_k>\\alpha_k)}>c_3+c_4 k.\\ ] ] therefore , due to the upper - bound of the second moment , @xmath394 we deduce @xmath395 for @xmath155 large enough that is @xmath37 small enough .",
    "this implies the existence of the constant @xmath396 in .",
    "+ _ step 3 .",
    "upper - bound of _",
    "@xmath397 $ ] . due to the first step it is sufficient to obtain an upper - bound of @xmath397 $ ] in order to prove the statement of the theorem .",
    "such a result is essentially based on the markov property of the sequence @xmath56 : the second step implies in particular that @xmath398 hence @xmath399&\\le { \\displaystyle}\\sum_{k\\ge 1}&k\\eta\\lfloor -\\log\\varepsilon\\rfloor \\mathbb{p}\\big(\\mathcal{n}'_\\varepsilon\\le k\\eta \\lfloor -\\log\\varepsilon\\rfloor\\big|\\mathcal{n}'_\\varepsilon > ( k-1)\\eta \\lfloor -\\log\\varepsilon\\rfloor\\big)\\\\ & & \\times\\mathbb{p}(\\mathcal{n}'_\\varepsilon > ( k-1)\\eta\\lfloor - \\log\\varepsilon\\rfloor)\\\\ & & \\le \\eta \\lfloor -\\log\\varepsilon\\rfloor \\sum_{k\\ge 1}kp^{k-1}=\\frac{\\eta | \\log\\varepsilon|}{(1-p)^2}.\\end{aligned}\\ ] ]",
    "the aim of this section is to illustrate the random walk on spheres algorithm introduced in section [ sec : approx ] .",
    "let us focus our attention on the numerical approximation of the solution to the value problem : @xmath400 for particular domains @xmath6 .",
    "first we shall present results obtained for the hypercube @xmath4010,1[^d$ ] and secondly the half of a sphere @xmath402 .",
    "of course these toy examples are not directly related to concrete situations in physics but they permit to emphasize the efficiency of the algorithm .",
    "their advantage relies in the easy computation of the distance to the boundary . for more general situations ,",
    "only this part of the procedure has to be modified and can sometimes become quite painful .",
    "let us first introduce the functions which take part to the boundary conditions .",
    "we choose a function with the following simple expression @xmath4030,1[}(x_i),\\quad x\\in\\overline{\\mathcal{d}},\\ \\forall t\\ge 0.\\ ] ] setting @xmath404 , we observe that both the compatibility and the continuity conditions are obviously satisfied . in this particular case , we have already pointed out , in the previous sections , that there exists a unique ( smooth ) solution to the initial - boundary value problem which can be approximated using the algorithm of moving spheres .",
    "+ the solution can be approximated by @xmath405 defined by , the error being directly related to the parameter @xmath406 . since @xmath407 is the expectation of a random variable , we shall use a monte - carlo method in order to obtain an estimated value .",
    "hence    @xmath408    where @xmath409 is a sequence of independent and identically distributed couples of random variables , the distribution being defined at the begining of section [ sec : approx ] .",
    "the difference between @xmath9 and @xmath410 actually relies on both the error described in proposition [ thm : approx ] of order @xmath411 on one hand and the classical error of monte carlo methods of order @xmath412 on the other hand ( the confidence interval depends as usual on the standard deviation of the underlying random variable ) .",
    "+ first let us present @xmath410 for a particular point : the center of the hypercube ( @xmath413 is the default setting in all this subsection ) letting the time cross the whole interval @xmath414 $ ] .     versus @xmath45 for @xmath415 , @xmath416 , @xmath417.,height=226 ]    we present at the same time the associated monte - carlo @xmath418-confidence interval ( figure [ fig0 ] ) .",
    "let us just notice that the choice @xmath415 is not motivated by some computational facilities but rather to produce a clear picture , the confidence interval becoming very small for larger values of @xmath419 .",
    "of course the numerical method permits to observe directly the distribution of the random variable @xmath420 which drastically changes as time elapses ( figure [ fig1 ] and [ fig2 ] ) .",
    "+     random variables @xmath421 for various values of @xmath45 : @xmath422 ( left ) , @xmath423 ( right ) @xmath416 , @xmath417 . , title=\"fig:\",height=226 ]   random variables @xmath421 for various values of @xmath45 : @xmath422 ( left ) , @xmath423 ( right ) @xmath416 , @xmath417 . ,",
    "title=\"fig:\",height=226 ]     for @xmath417 ( left ) and @xmath424 ( right ) , @xmath425 , @xmath416 . , title=\"fig:\",height=226 ] for @xmath417 ( left ) and @xmath424 ( right ) , @xmath425 , @xmath416 .",
    ", title=\"fig:\",height=226 ]    in our example , small values of @xmath421 are more frequently observed for small time values than for large ones .",
    "such behaviour of the random variable is not linked to the particular boundary conditions we introduced , but relies on the following general argument .",
    "the random variable @xmath421 is obtained due to a stopping procedure on @xmath243 defined by .",
    "the sequence is stopped as soon as either @xmath251 is @xmath37-close to the boundary @xmath36 ( we call this event _ stop due to space constraint _ ) or @xmath254 is @xmath37-close to @xmath68 ( _ stop due to time constraint _ ) .",
    "then it seems quite obvious that stops due to time constraint are more likely to occur when @xmath45 becomes small ( see the proportion in figure [ fig3 ] left ) .     for @xmath426 trials , @xmath416 , @xmath417 ( left ) ; histogram of the number of steps @xmath427 , @xmath416 , @xmath417.,title=\"fig:\",height=196 ] for @xmath426 trials , @xmath416 , @xmath417 ( left ) ; histogram of the number of steps @xmath427 , @xmath416 , @xmath417.,title=\"fig:\",height=196 ]    let us now comment the algorithm efficiency by focusing our attention on the number of steps .",
    "the distribution of this random number depends on several parameters : the dimension @xmath25 , the parameter @xmath37 and finally the choice of @xmath63 ( see histogram figure [ fig3 ]  right  for a particular choice of parameters ) .",
    "we have pointed out an upper bound for the average number of steps in theorem [ thm : mean - number ] .",
    "the numerics permit to present different curves illustrating all the dependences : the logarithm growth with respect to the parameter @xmath37 , the surprising behavior when the space position @xmath26 varies and the influence of the dimension ( figures [ fig4 ] and [ fig5 ] ) .     for @xmath428 and @xmath26 the center of the hypercube ( left ) , averaged number of steps versus @xmath1 for @xmath429 and @xmath416 .",
    "in both situations : @xmath426 trials , @xmath417 , @xmath427.,title=\"fig:\",height=207 ] for @xmath428 and @xmath26 the center of the hypercube ( left ) , averaged number of steps versus @xmath1 for @xmath429 and @xmath416 . in both situations : @xmath426 trials , @xmath417 , @xmath427.,title=\"fig:\",height=207 ]    , @xmath416 , @xmath426 trials , @xmath427.,height=207 ]    let us notice that this algorithm is especially efficient ( see the small number of steps ) even in high dimensions .",
    "all the studies developed in the hypercube case can also be considered for the half sphere .",
    "we introduce particular boundary conditions : @xmath430 with @xmath404 .",
    "similarly as above , we present :    * the approximated solution @xmath410 for the default value @xmath431 and for @xmath45 varying in the interval @xmath432 $ ] ( figure [ fig0.1 ] ) , * the distribution of the monte carlo underlying variable @xmath433 for different values of @xmath45 and different dimension values @xmath25 ( figures [ fig1.1 ] and [ fig2.1 ] ) , * different curves illustrating the influence of the parameter @xmath37 , the starting position @xmath26 and the dimension @xmath25 on the averaged number of steps ( figures [ fig3.1 ] and [ fig4.1 ] )     versus @xmath45 for @xmath415 , @xmath416 , @xmath417.,height=188 ]     random variables @xmath421 for various values of @xmath45 : @xmath434 ( left ) , @xmath422 ( right ) @xmath416 , @xmath417 .",
    ", title=\"fig:\",height=170 ]   random variables @xmath421 for various values of @xmath45 : @xmath434 ( left ) , @xmath422 ( right ) @xmath416 , @xmath417 .",
    ", title=\"fig:\",height=170 ]     for @xmath417 and @xmath427 ( left ) , for @xmath424 and @xmath434 ( right ) , both with @xmath416 .",
    ", title=\"fig:\",height=188 ]   for @xmath417 and @xmath427 ( left ) , for @xmath424 and @xmath434 ( right ) , both with @xmath416 .",
    ", title=\"fig:\",height=188 ]     for @xmath428 and @xmath435 ( left ) , averaged number of steps versus @xmath1 for @xmath436 and @xmath416 . in both situations : @xmath426 trials , @xmath417 , @xmath427 .",
    ", title=\"fig:\",height=188 ]   for @xmath428 and @xmath435 ( left ) , averaged number of steps versus @xmath1 for @xmath436 and @xmath416 . in both situations : @xmath426 trials , @xmath417 , @xmath427 .",
    ", title=\"fig:\",height=188 ]    , @xmath416 , @xmath426 trials , @xmath427.,height=188 ]",
    "we first start with jensen s inequality :    [ lem : appen : jensen ] let @xmath47 and @xmath437 be two random variables and @xmath438 a @xmath81-algebra , then @xmath439\\ge \\max ( \\mathbb{e}[x],\\mathbb{e}[y])\\quad \\mbox{and}\\quad \\mathbb{e}[\\max(x , y)|\\mathcal{a}]\\ge \\max ( \\mathbb{e}[x|\\mathcal{a}],\\mathbb{e}[y|\\mathcal{a}]).\\ ] ]    we shall just prove the first inequality .",
    "the proof of the second one is similar .",
    "we get @xmath439=\\mathbb{e}[\\mathbb{e}[\\max(x , y)|x]]\\ge \\mathbb{e}[\\max(x,\\mathbb{e}[y|x])].\\ ] ] since @xmath440)\\ge x$ ] , we deduce that @xmath441)]\\ge \\mathbb{e}[x]$ ] . on the other side @xmath440)\\ge \\mathbb{e}[y|x]$ ] and therefore @xmath441)]\\ge \\mathbb{e}[\\mathbb{e}[y|x]]=\\mathbb{e}[y]$ ] . combining both inequalities leads to the result .",
    "let us now present properties concerning a particular probability distribution arising in the random walk on moving spheres .",
    "[ lem : born ] let @xmath442 where the function @xmath107 is defined by and @xmath443 is a random variable with the following probability density function : @xmath444}(s)=\\frac{1}{s\\gamma(d/2)}\\big(s\\log ( s^{-d/2})\\big)^{d/2}1_{[0,1]}(s).\\ ] ] then @xmath445 has its two first moments ( denoted by @xmath446 and @xmath447 ) bounded .",
    "let us first note that @xmath445 is a non - negative random variable , since @xmath443 and @xmath448 are @xmath51$]-valued .",
    "if we denote @xmath449 and @xmath450 , then it suffices to prove that @xmath451<\\infty$ ] and @xmath452<\\infty$ ] .",
    "1f_b(s)\\,ds\\quad\\mbox{with}\\quad f_b(s)=\\frac{(\\log(1-s))^2}{s\\gamma(d/2 ) } \\big(s\\log ( s^{-d/2})\\big)^{d/2}.\\end{aligned}\\ ] ] let us observe that @xmath454 tends to @xmath68 as @xmath455 and in a neighborhood of @xmath80 , @xmath456 where @xmath457 is a constant .",
    "we deduce that @xmath458 is integrable on the whole interval @xmath51 $ ] which implies that @xmath452<\\infty$ ] .",
    "for @xmath459 we get @xmath460=\\int_0 ^ 1f_a(s)\\,ds\\quad\\mbox{with}\\quad f_a(s)=\\frac{4\\log^2\\big(1-\\sqrt{\\frac{2e}{d}\\ , s\\log(s^{-d/2})}\\big)}{s\\gamma(d/2 ) } \\big(s\\log ( s^{-d/2})\\big)^{d/2}.\\ ] ] in a neigborhood of @xmath68 , we have @xmath461 , in a neighborhood of @xmath80 , we observe @xmath462 and finally in a neigborhood of @xmath463 , @xmath464 .",
    "we deduce that @xmath465 is integrable on the whole interval @xmath51 $ ] and @xmath451<\\infty$ ] .",
    "in this section , we focus our attention to the classical random walk on spheres .",
    "we consider an @xmath68-thick domain @xmath6 , see the definition developed in , and the euclidean distance to the boundary @xmath466 .",
    "the random walk is then defined as follows :    * we start with an initial condition @xmath467 and fix two parameters @xmath65 and @xmath4680,1[$ ] . * while @xmath469 , we construct @xmath470 where @xmath471 stands for a sequence of independent random variables uniformly distributed on the unit sphere in @xmath7 .",
    "we adapt here several results of @xcite to our particular situation .",
    "let us recall that @xmath288 is the _ energy function _ defined by which is based on the set of measures @xmath284 , defined by , and on the riesz potential . since @xmath6 is a @xmath68-thick domain , the following lemma holds .",
    "[ lem : b ] there exist two constants @xmath472 and @xmath473 , such that : for any @xmath474 ( we define @xmath26 the closest point of @xmath118 belonging to the boundary ) and any measure @xmath475 , we have :        [ prop : classic ] let us consider @xmath480 the constant of lemma [ lem : b ] and the random walk @xmath481 defined by with @xmath4681-\\delta/2,1-\\delta/4[$ ] .",
    "then there exists a constant @xmath482 such that the sequence @xmath483 satisfies @xmath484>l,\\quad\\forall n\\ge 0.\\ ] ]    in @xcite , the authors consider a general random walk defined by .",
    "they prove that there exist an interger @xmath155 and a constant @xmath482 such that @xmath485>l$ ] . here",
    "we adapt the proof by introducing a particular condition on the parameter @xmath486 which permits in fact to set @xmath487 .",
    "let us consider @xmath251 .",
    "due to the weak compactness of the set of measures @xmath284 ( see remark [ rem ] ) , there exists a measure @xmath475 such that @xmath488 for this particular measure , either the first or the second point of the previous lemma are satisfied . + * step 1 .",
    "* let us assume that the first point is satisfied that is , @xmath476 when @xmath489 and @xmath478 . since @xmath490 is a submartingale , we get @xmath491&=\\mathbb{e}[u_{n+1}-u^\\mu_{n+1}|x_n]+\\mathbb{e}[u^\\mu_{n+1}-u^\\mu_n|x_n]\\\\ & \\ge \\mathbb{e}[u_{n+1}-u^\\mu_{n+1}|x_n]\\\\ & \\ge \\mathbb{p}\\big(\\vert x_{n+1}-x_n\\vert<\\delta d(x_n ) , \\ , d(x_{n+1})>(\\delta/4 ) d(x_n ) \\big| x_n\\big),\\end{aligned}\\ ] ] where @xmath492 is the closest point of @xmath251 on the boundary @xmath36 .",
    "we denote by @xmath493 which belongs to the unit sphere . using the definition of the random walk and the particular choice of the parameter @xmath486",
    ", we get immediately @xmath494 and @xmath495 let us recall that @xmath496 is a unit vector .",
    "then we define the set @xmath497 of points @xmath1 belonging to the unit sphere of dimension @xmath25 such that @xmath498 .",
    "let us just note that @xmath497 is a non empty open set .",
    "we observe that @xmath499 for any @xmath228 and does not depend on @xmath496 due to rotational invariant of the distribution .",
    "furthermore , for any @xmath500 , implies that @xmath501 . therefore @xmath491&\\ge",
    "\\mathbb{p}\\big(\\vert x_{n+1}-x_n\\vert<\\delta d(x_n ) , \\ , d(x_{n+1})>(\\delta/4 ) d(x_n ) \\big| x_n\\big)\\\\ & \\ge \\mathbb{p}(\\gamma_n\\in\\gamma_{u_n})=p>0.\\end{aligned}\\ ] ] * step 2 .",
    "* the second case concerns the condition @xmath502 by the green formula , for a @xmath210-smooth function @xmath75 , @xmath503-h(x_n)&=\\int_{\\mathbb{s}(x_n,\\beta d(x_n))}h(y)d\\sigma(y)-h(x_n)\\\\ & = \\int_0^{\\beta d(x_n ) } r^{1-d}\\int_{b(x_t , r)}\\delta h ( y ) dv(y)\\,dr.\\end{aligned}\\ ] ] since @xmath504 outside the support of the measure @xmath285 ( consequently @xmath290 is a @xmath210-function in the domain @xmath6 ) , then , for any @xmath118 satisfying @xmath505 , we get @xmath506 applying the previous results to the particular regular function @xmath507 , we deduce : @xmath508=\\mathbb{e}[u^\\mu(x_{n+1})|x_n]-u^\\mu(x_n)\\ge cd(x_n)^{-2}\\int_0^{\\beta d(x_n)}r\\,dr=\\frac{c\\beta^2}{2},\\ ] ] for some positive constant @xmath509 depending on @xmath385 , @xmath486 and @xmath25 .",
    "since @xmath510=\\mathbb{e}[u_{n+1}-u_n|x_n]$ ] , we obtain the announced result ."
  ],
  "abstract_text": [
    "<S> the initial - boundary value problem for the heat equation is solved by using a new algorithm based on a random walk on heat balls . </S>",
    "<S> even if it represents a sophisticated generalization of the walk on spheres ( wos ) algorithm introduced to solve the dirichlet problem for laplace s equation , its implementation is rather easy . </S>",
    "<S> the definition of the random walk is based on a new mean value formula for the heat equation . </S>",
    "<S> the convergence results and numerical examples permit to emphasize the efficiency and accuracy of the algorithm .    </S>",
    "<S> * key words : * initial - boundary value problem , heat equation , random walk , mean - value formula , heat balls , riesz potential , submartingale , randomized algorithm .    * </S>",
    "<S> 2010 ams subject classifications : * primary 35k20 , 65c05 , 60g42 ; secondary 60j22 . </S>"
  ]
}