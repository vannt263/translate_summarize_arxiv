{
  "article_text": [
    "shor s algorithms for factoring and discrete logarithms @xcite , as well as grover s search algorithm @xcite promise substantial quantum speed - up for certain important problems .",
    "another exciting application area for quantum computers is simulation of physical systems , including molecules , strongly correlated spin systems , nuclei , and qcd .",
    "the majority of these problems admit a natural description using continuous variables , such as particle coordinates or field modes .",
    "( `` mode '' may refer to the field strength at a grid point or to a fourier component , depending on which representation is chosen .",
    ") however , we want to perform the simulation using a _ digital _ quantum computer , i.e. , one composed of qubits . in this paper , we address some general issues pertaining to the discretization of continuous variables and round - off errors in the quantum case .",
    "it is worth noting that continuous variables play an important role in algebraic number theory ( for example , consider the use of logarithmic coordinates in the proof of dirichlet s unit theorem @xcite . )",
    "thus , we anticipate that discretization techniques might also be helpful in constructing new quantum algorithms for number - theoretic problems .",
    "to see why the discretization is not entirely trivial , consider a quantum particle characterized by a single coordinate @xmath0 . to represent it in a quantum computer , we approximate @xmath0 by @xmath1 , where @xmath2 is a ( binary - encoded ) integer and @xmath3 is some small constant ( the discretization grid spacing ) . to simplify the notation , we may rescale @xmath0 so that @xmath4 ; thus , we approximate real numbers by integers .",
    "now , suppose we want to change this standard grid to a different one , which is equivalent to stretching or squeezing the wavefunction and putting it back on the same grid .",
    "we call this transformation _ resampling_. if @xmath0 is mapped to @xmath5 , a continuous wavefunction would transform as follows : @xmath6 in the simplest case , @xmath5 = @xmath7 , so that @xmath8 and @xmath9 . naively , this appears to be implementable as a permutation of basis vectors .",
    "however , the discrete version of @xmath10 , @xmath11 is not a permutation ! for @xmath12 the transformation is a stretching ; it maps integers to a subset of integers , leaving some gaps .",
    "for @xmath13 it is a squeezing , therefore two distinct integers may be mapped to the same integer .",
    "fortunately , transformation  ( [ discrete_map ] ) is to be applied to a special class of wavefunction , namely , ones that vary at distances much larger than the grid spacing . in this case , a few lowest bits of @xmath0 are almost in the uniform superposition and thus can be easily removed or added again while maintaining quantum coherence . but adding or removing @xmath14 bits corresponds to stretching ( resp .",
    "squeezing ) by factor @xmath15 .",
    "it is easy to generalize this trick to any scaling factor @xmath16 , or to an arbitrary function @xmath10 .",
    "multidimensional resampling is somewhat more challenging though .",
    "our solution for this case uses multidimensional gaussian states .",
    "of course , the preparation of such states begins with the one - dimensional case .",
    "the transition to higher dimensions requires some care .",
    "one may be tempted to say that a general gaussian is just a product of several one - dimensional gaussians .",
    "however , the implementation of this approach involves the diagonalization of the covariance matrix and a linear change of variables , which in turn requires resampling . to avoid this problem",
    ", we use a special linear transformation , namely shearing , and construct its discrete version explicitly . in the rest of the paper , we simply expand this outline .",
    "the states we wish to prepare are discrete approximations to continuous gaussian functions . in this section",
    "we examine these functions and the approximate forms of interest . in one dimension ,",
    "the gaussian is just the normal distribution familiar from statistics : @xmath17 ( up to a normalization factor ) .",
    "our algorithm is similar to the uniform superposition preparation technique @xcite and its generalization to efficiently integrable distributions @xcite .",
    "however , the latter procedures begin with dissecting the distribution at @xmath18 and setting the highest bit of @xmath0 according to @xmath19 . in comparison",
    ", we first set the _",
    "lowest _ bit and proceed with generating a discrete gaussian on either even integers or odd integers .",
    "this method is slightly more efficient since it does not involve the gauss error function , but rather , the jacobi theta function , which is easier to calculate .    if we treat the gaussian wavefunction as continuous , it has form @xmath20 so that @xmath21 and @xmath22 if we consider it to be a function of an integer value , we have @xmath23 where the function @xmath10 is related to the third jacobi theta function ( @xmath24 ) and is defined as @xmath25 so that @xmath26 if @xmath27 , then @xmath28 is approximately equal to @xmath29 .",
    "we now define the function @xmath30 note that this function is periodic with period @xmath15 .",
    "this allows us to define the quantum state @xmath31    for @xmath32 , this state is very close to a gaussian with mean @xmath33 and standard deviation @xmath34 . a recursive description of the state , @xmath35 where @xmath36 leads almost immediately to an algorithm for preparing it .",
    "note that the sum represented by @xmath28 converges , so we can approximate it with a finite number of terms and keep some number of digits of the answer . however , the convergence is poor when @xmath34 is large .",
    "when @xmath34 is small ( which is the case at a late stage of our recursive algorithm ) , a few terms of the sum will dominate , and only these need be calculated and stored . for large @xmath34 we use @xmath28 = @xmath37 to avoid having to sum an exponentially large number of terms .",
    "the algorithm recursively calls the following subroutine , using the input data @xmath38 and some number of supplementary qubits .",
    "note that the @xmath39 qubits are indexed 0 to @xmath40 , where the 0-th qubit corresponds to the rightmost qubit in a binary representation .    1 .",
    "* calculate and store @xmath41 ( see eqn .",
    "@xmath42 ) and @xmath43 in a k - bit binary representation on supplementary qubits . *",
    "apply the rotation operator r(@xmath41 ) to the 0-th qubit @xmath44\\ ] ] using the bits of @xmath43 as described below . *",
    "uncompute @xmath41 and @xmath43 .",
    "2 .   compute @xmath45 , where @xmath46=@xmath47 and @xmath48 = @xmath49 if the previously rotated qubit is @xmath50 and @xmath48 = @xmath51 if it is @xmath52 .",
    "note that all pairs @xmath53 are stored in supplementary memory until a cleanup phase , see below .",
    "3 .   on the remaining @xmath40 qubits",
    "prepare state @xmath54 .",
    "note that for the last ( ( n-1)th ) qubit , we proceed only through step 1 ( c ) , as after this qubit is rotated we do not need another pair of parameters .",
    "after this last qubit is rotated , right before termination , a last series of steps is performed in which all stored pairs @xmath53 are cleared . to do this ,",
    "the machine erases @xmath55 by recalculating it using @xmath56 and the last output qubit , performing a second controlled xor to the region where @xmath55 is stored , thus clearing @xmath55 from memory .",
    "the process is repeated on @xmath56 , @xmath57 and so on until the supplementary memory is cleared .",
    "since quantum recursion can be counterintuitive and difficult to describe verbally , this algorithm is perhaps easier to understand when presented in circuit form .",
    "the figure shows the gist of the algorithm as well as some of the workings of the supplementary qubits .",
    "note that the double line across the top denotes the classical part of the computer , which in this scheme functions only to transfer the specifications of the gaussian to the quantum part at the end of the process to clear memory .",
    "the single lines with forward slashes ( / ) overlying their left ends represent multiple qubits in the supplementary memory . note that each such line represents the same array at different stages of the computation .",
    "we deviate slightly from conventional notation by introducing the downward arrow conditional , which represents a generalized form of controlled operation .",
    "the downward arrow terminating on the xor symbol on the supplementary array directly above the @xmath58th qubit denotes that the previously used pair @xmath59 and the @xmath60th qubit ( which was just rotated ) are used to control the calculation of @xmath61 and @xmath62 .",
    "note that classically , @xmath62 is a rotation angle equal to @xmath63 if the @xmath60-th qubit is @xmath50 and @xmath64 if the @xmath60-th qubit is @xmath52 .",
    "however , since the previous qubit is always in a superposition state , @xmath62 is always entangled with the previous qubits .",
    "the downward arrow terminating on the i - th rotation operator box indicates that the rotation angle is specified by the controlling qubits , specifically , the qubits in the supplementary containing @xmath62 ( which is shown directly to the right of the downward arrow ) .",
    "this rotation is actually a series of standardized rotations , each controlled by a single qubit of the register storing @xmath62 , as described below .",
    "are stored until the end of computation .",
    "the multi - qubit wires feeding into the black box g are the  working \" supplementary memory that is inverted and cleared in each step.,title=\"fig:\",width=529 ]   are stored until the end of computation .",
    "the multi - qubit wires feeding into the black box g are the  working \" supplementary memory that is inverted and cleared in each step.,title=\"fig:\",width=529 ]    due to finite computational resources , the rotation operator must be implemented approximately .",
    "note that since @xmath41 is a rotation angle between 0 and @xmath65 , so @xmath66 and we can approximate in @xmath14-digits of binary notation that @xmath67 so that @xmath68 .",
    "note that the @xmath69 are either 1 or 0 , as this is a binary representation .",
    "the rotation operator is realized as a sequence of at most @xmath14 standard rotations as @xmath70 .",
    "the precision of this operation on the entire array ( assuming the standard rotations are exact ) is thus @xmath71 and the size of the circuit required to execute the algorithm is polynomial in @xmath72 .",
    "in @xmath73 dimensions , the general gaussian function is @xmath74 , where @xmath75 is a constant , @xmath76 is a real symmetric positive definite matrix ( @xmath77=@xmath76 , and @xmath78 @xmath79 ) , and @xmath80 is vector with s components , @xmath81 where @xmath82 denotes position in @xmath73 space and @xmath83 is a vector denoting the mean of the distribution .",
    "we assume that the register ( call it @xmath84 ) contains @xmath85 qubits , where @xmath14 is some integer .",
    "thus , we can break the array into @xmath73 subarrays ( index them @xmath86 for @xmath87 ) each containing @xmath14 qubits , and write @xmath84=@xmath88 , with multiplication representing array concatenation .",
    "the state space corresponding to @xmath84 is of dimension @xmath89 .",
    "the wavefunction we wish to prepare has form @xmath90 in this expressions @xmath91 = @xmath92 and @xmath93 , @xmath94 = @xmath95 $ ] , where negative integers are represented using two s complement . in the quantum computer , @xmath96 is the basis vector formed by concatenating all binary representations of the entries of @xmath97 .",
    "for example , if @xmath98 , in binary representation , @xmath99 , so if we assume @xmath14=2 , @xmath97 = @xmath100 = @xmath101 . for",
    "@xmath86 , the basis state @xmath102 corresponds to the integer @xmath103 along the @xmath58th coordinate axis in @xmath73 space .",
    "thus , each subarray generates one coordinate axis of the space in question .",
    "note that this space is not a state space in the system , rather , each integer point in the cube described corresponds to one dimension / basis vector of the system s state space .",
    "the reason for the distinction will be clear momentarily .",
    "our method of preparing the general @xmath73-dimensional gaussian relies on a special case of the problem .",
    "note that if the matrix @xmath76 in @xmath104 is diagonal ( in which case , we call it @xmath105 ) , then @xmath106 factors into 1-dimensional gaussians as @xmath107 where @xmath108 is the @xmath58th diagonal element of @xmath105 and @xmath109 the @xmath58-th entry of @xmath80 .",
    "thus in this special case , the state to prepare becomes ( with @xmath97=@xmath110 , where the @xmath111 are @xmath14-digit binary integers )    @xmath112    this state is just a product of 1-dimensional gaussians , which we have already shown how to prepare .",
    "we can prepare this state by preparing @xmath39 simple gaussians on @xmath14 qubit subarrays .",
    "the overall normalization constant ( here denoted by @xmath75 ) is accounted for by the normalization constants of the gaussians on subarrays .",
    "some simple properties of linear algebra and a change of variables allow us to transform this easily prepared state into any arbitrary gaussian .",
    "any real symmetric positive definite matrix @xmath76 can be decomposed as @xmath76 = @xmath113 for some @xmath105 and @xmath114 , where @xmath105 is diagonal and @xmath114 is upper triangular with 1 s on the diagonal ( in other words , a multidimensional shearing matrix ) .",
    "thus , if we apply transformation @xmath115 , then @xmath116    the matrix @xmath114 can be decomposed as the product of shearing matrices with exactly one non - zero off - diagonal entry each .",
    "note that @xmath114 acts numerically on the basis vectors in a classically reversible fashion ( provided relevant parameters are stored ) .",
    "it is not a unitary operator and is not applied directly to the state space of the system .",
    "rather , it maps a vector @xmath97 to a vector @xmath80 ( and the corresponding basis vector @xmath96 to @xmath117 ) as in the following example .",
    "let @xmath114 be a square , 2 by 2 upper triangular matrix with 1 s the diagonal and a real number @xmath41 in the upper right entry and let @xmath97 = @xmath118 .",
    "then , we see that    @xmath119    @xmath120    thus , @xmath114 can act on basis vectors numerically by matrix multiplication with rounding , which , provided the specifications for @xmath114 are stored , is an efficiently reversible classical operation that can thus be carried out on a quantum computer . applying @xmath114 to a superposition of states results in a changes of variable of the kind described above , which turns our set of independent gaussians into the general gaussian , @xmath121",
    "thus , we have an algorithm for preparing the general gaussian function in @xmath39 dimensions .",
    "one application of the gaussian states described above is multidimensional resampling .",
    "this is more clear after a description of resampling in one dimension .",
    "the goal is to stretch or contract a wavefunction with respect to some function @xmath10 , see eqn .",
    "( [ wfmap ] ) .",
    "( we assume that @xmath10 is smooth , monotone , and its derivative is bounded from above and from below . )",
    "such deformations are easily accomplished , provided that @xmath122 is a slowly varying function ( @xmath123 and @xmath124 are very close for all @xmath0 in the range of interest ) .",
    "assume we have two qubit ensembles , @xmath76 and @xmath94 , each containing @xmath39 qubits .",
    "the basis states of ensemble @xmath76 correspond to the @xmath0 axis , those of ensemble @xmath94 to the @xmath125 axis .",
    "the desired original wavefunction @xmath122 is prepared on ensemble @xmath76 , while ensemble @xmath94 is prepared in state @xmath126 .",
    "the state of the combined system is thus @xmath127 if we want to perform a resampling with respect to @xmath128 , then we prepare the uniform superposition state @xmath129 on ensemble b using an algorithm described in problem 9.4 of @xcite .",
    "we describe how parameter @xmath130 is selected shortly . after this operation",
    ", the whole ensemble is in state @xmath131 a simple reversible computation can efficiently transform this state into @xmath132 recall that we wish to prepare the state @xmath133 on an @xmath39-qubit ensemble .",
    "note that if we started with that wavefunction prepared on ensemble @xmath94 with ensemble @xmath76 initialized to @xmath126 , we could carry out a transformation analogous to that above to yield the state @xmath134 if we think of @xmath76 and @xmath94 as generating coordinate axes @xmath0 and @xmath125 , then wavefunctions can be visualized as sets of points in the @xmath135 plane , specifically , as points occupying the vertices of the infinite grid with integer spacing . in this scheme ,",
    "@xmath136 and @xmath137 appear as bands of width @xmath138 about the line @xmath139 .",
    "the amplitudes of basis vectors in @xmath140 and @xmath141 agree on that line ; the only difference is that the amplitudes in @xmath140 are constant on vertical strips whereas the amplitudes in @xmath141 are constant on horizontal strips . if @xmath130 is much larger than the grid spacing but small enough relative to the grid length at which @xmath122 and @xmath142 vary , the amplitudes in intersecting horizontal and vertical strips are close .",
    "thus we have the approximate equality @xmath143 .",
    "this means that by choosing @xmath39 and @xmath130 appropriately and preparing the state @xmath136 , it is virtually equivalent to having prepared the state @xmath137 .",
    "if we then apply ( to the combined ensemble ) the inverse of the computation we would have used to prepare @xmath137 , it is as if we prepared and then uncomputed @xmath137 , leaving the combined ensemble in ( or rather , arbitrarily close to ) the state such that the wavefunction on @xmath94 is @xmath144 and the wavefunction on @xmath76 is @xmath126 .",
    "thus if we can prepare @xmath123 satisfying the necessary smoothness conditions , we can use resampling with supplementary qubits to transform the state to one arbitrarily close to @xmath144 .     and @xmath136 . the grey region ( and the dotted region in the inset ) represents the basis states of the combined ensemble ab that have non - zero amplitudes . in state",
    "@xmath136 the amplitudes on vertical strips are equal , in state @xmath137 amplitudes are constant on horizontal strips .",
    "if n is much larger than the spacing between basis vectors but much smaller than the size of the grid , the amplitudes of basis vectors in a vertical strip will be roughly equal to those of the basis vectors of any horizontal strip that intersects it .",
    "when this is the case , @xmath145 and resampling will work.,width=529 ]    this particular transformation takes advantage of the fact that uniform superpositions on an interval are invariant under stretching or contracting transformation .",
    "multidimensional resampling requires a family of states that is similarly invariant under a general linear transformation .",
    "multidimensional gaussian states satisfy this condition and thus may be used for multidimensional resampling .",
    "we illustrate with a simple example .",
    "note that in the procedure above , if we prepare on ensemble @xmath94 the state @xmath146 with parameters @xmath34 and @xmath33 such that @xmath147 with @xmath148 and @xmath149 instead of the uniform superposition state @xmath150 , the procedure still works .",
    "intuitively , we prepare a series of vertical , parallel gaussian - weighted strips centered somewhere above the @xmath0 axis and shift them up along the line @xmath125 = @xmath7 so that each strip is centered at the line .",
    "the result is that the entire grid has non - zero amplitudes , but all amplitudes except those immediately about @xmath125 = @xmath7 are very , very small , so the result looks very similar to figure  2 and is amenable to resampling as described .",
    "this research was funded by caltech s summer undergraduate research fellowship ( surf ) program .",
    "w.w . would like to thank ning bao , erik winfree , and david renshaw for helpful comments and discussion .",
    "plain p.  w.  shor .",
    "algorithms for quantum computation : discrete logarithms and factoring . in proceedings ,",
    "35th annual symposium on foundations of computer science , ieee press , los alamitos , ca , 1994 . l.  k.  grover .",
    "quantum mechanics helps in searching for a needle in a haystack .",
    "lett.,79(2):325 , 1997 .",
    "k.  ireland , m. rosen . a classical introduction to modern number theory . graduate texts in mathematics , v. 84 .",
    "springer , 1998 ( 2nd edition ) .",
    "a. yu kitaev , a. h. shen , m. n. vyalyi .",
    "classical and quantum computation .",
    "graduate studies in mathematics , v. 47 .",
    "american mathematical society , 2002 .",
    "l.  k.  grover , t.  rudolph . creating superpositions that correspond to efficiently integrable probability distributions .",
    "quant - ph/0208112 ."
  ],
  "abstract_text": [
    "<S> we present an algorithm that prepares multidimensional gaussian wavefunctions on qubit arrays and an application of such wavefunctions to multidimensional resampling , a technique useful in quantum digital simulation . </S>"
  ]
}