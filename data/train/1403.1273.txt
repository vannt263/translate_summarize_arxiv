{
  "article_text": [
    "in their development of the graph minors theory towards the proof of wagner s conjecture  @xcite , robertson and seymour made extensive use of surface embeddings of graphs .",
    "robertson and seymour introduced parameters that measure the density of an embedding , and established results that are not only central to the graph minors theory , but are also of independent interest .",
    "we recall that the _ face - width _ @xmath1 of a graph @xmath0 embedded in a surface @xmath2 is the smallest @xmath3 such that @xmath2 contains a noncontractible closed curve ( a _ loop _ ) that intersects @xmath0 in @xmath3 points .",
    "[ thm : fw - minor ] for any graph @xmath4 embedded on a surface @xmath2 , there exists a constant @xmath5 such that every graph @xmath0 that embeds in @xmath2 with face - width at least @xmath6 contains @xmath4 as a minor .",
    "this theorem , and other related results , spurred great interest in understanding which structures are forced by imposing density conditions on graph embeddings .",
    "for instance , thomassen  @xcite and yu  @xcite proved the existence of spanning trees with bounded degree for graphs embedded with large enough face - width . in the same paper",
    ", yu showed that under strong enough connectivity conditions , @xmath0 is hamiltonian if @xmath0 is a triangulation .",
    "large enough density , in the form of edge - width , also guarantees several nice coloring properties .",
    "we recall that the _ edge - width _ @xmath7 of an embedded graph @xmath0 is the length of a shortest noncontractible cycle in @xmath0 .",
    "fisk and mohar  @xcite proved that there is a universal constant @xmath6 such that every graph @xmath0 embedded in a surface of euler genus @xmath8 with edge - width at least @xmath9 is @xmath10-colorable .",
    "thomassen  @xcite proved that larger ( namely @xmath11 ) edge - width guarantees @xmath12-colorability .",
    "more recently , devos , kawarabayashi , and mohar  @xcite proved that large enough edge - width actually guarantees @xmath12-choosability .    in a direction closer to our current interest ,",
    "fiedler et al .",
    "@xcite proved that if @xmath0 is embedded with face - width @xmath3 , then it has @xmath13 pairwise disjoint contractible cycles , all bounding discs containing a particular face .",
    "brunet , mohar , and richter  @xcite showed that such a @xmath0 contains at least @xmath14 pairwise disjoint , pairwise homotopic , non - separating ( in @xmath2 ) cycles , and at least @xmath15 pairwise disjoint , pairwise homotopic , separating , noncontractible cycles .",
    "we remark that throughout this paper , `` homotopic '' refers to `` freely homotopic '' ( that is , not to `` fixed point homotopic '' ) .    for the particular case",
    "in which the host surface is the torus , schrijver  @xcite unveiled a beautiful connection with the geometry of numbers and proved that @xmath0 has at least @xmath16 pairwise disjoint noncontractible cycles , and proved that the factor @xmath17 is best possible .",
    "the _ toroidal @xmath18-grid _ is the cartesian product @xmath19 of the cycles of sizes @xmath20 and @xmath21 .",
    "see figure  [ fig : torgrid ] .",
    "using results and techniques from  @xcite , de graaf and schrijver  @xcite showed the following :    [ thm : degs ] let @xmath0 be a graph embedded in the torus with face - width @xmath22 .",
    "then @xmath0 contains the toroidal @xmath23-grid as a minor .",
    "de graaf and schrijver also proved that @xmath24 is best possible , by exhibiting ( for each @xmath25 ) a graph that embeds in the torus with face - width @xmath3 and that does not contain a toroidal -grid as a minor . as they observe , their result shows that @xmath26 is the smallest value that applies in ( robertson - seymour s ) theorem  [ thm : fw - minor ] for the case of @xmath27 .      along the lines of the aforementioned de graaf - schrijver result ,",
    "our aim is to investigate the largest size ( meaning the number of vertices ) of a toroidal grid minor contained in a graph @xmath0 embedded in an arbitrary orientable surface of genus greater than zero .",
    "we do not restrict ourselves to square proportions of the grid and define this parameter as follows .",
    "[ def : texpanse ] the _ toroidal expanse _ of a graph @xmath0 , denoted by @xmath28 , is the largest value of @xmath29 over all integers @xmath30 such that @xmath0 contains a toroidal @xmath18-grid as a minor . if @xmath0 does not contain @xmath31 as a minor , then let @xmath32 .",
    "our interest is both in the structural and the algorithmic aspects of the toroidal expanse .",
    "the `` bound of nontriviality '' @xmath30 required by definition  [ def : texpanse ] is natural in the view of toroidal embeddability the degenerate cases @xmath33 are planar , while @xmath19 has orientable genus one for all @xmath30 .",
    "it is not difficult to combine results from  @xcite and  @xcite to show that for each positive integer @xmath34 there is a constant @xmath35 with the following property : if @xmath0 embeds in the orientable surface @xmath36 of genus @xmath37 with face - width @xmath3 , then @xmath0 contains a toroidal @xmath38-grid as a minor ; that is , @xmath39 .    on the other hand ,",
    "it is very easy to come up with a sequence of graphs @xmath0 embedded in a fixed surface with face - width @xmath3 and arbitrarily large @xmath40 : it is achieved by a natural toroidal embedding of @xmath41 for arbitrarily large @xmath21 .",
    "this inadequacy of face - width to estimate the toroidal expanse of an embedded graph is to be expected , due to the one - dimensional character of this parameter .    to this end",
    ", we introduce a new density parameter of embedded graphs that captures the truly two - dimensional character of our problem ; the _ stretch of an embedded graph _ in definition  [ def : stretch ] . using this tool",
    ", we unveil our main result  a tight two - way relationship between the toroidal expanse of a graph @xmath0 in an orientable surface and its _ crossing number _",
    "@xmath42 in the plane .",
    "we furthermore provide an approximation algorithm for both these numbers under an assumption of a sufficiently dense embedding .",
    "a simplified summary of the main results follows :    [ thm : main - overview ] let @xmath2 be an orientable surface of fixed genus @xmath34 , and let @xmath43 be an integer . there exist constants @xmath44 , depending only on @xmath37 and @xmath43 , such that the following holds : if @xmath0 is a graph of maximum degree @xmath43 embedded in @xmath2 with face - width at least @xmath45 , then    * @xmath46 , and * there is a polynomial time algorithm that outputs a drawing of @xmath0 in the plane with at most @xmath47 crossings .",
    "the density assumption that @xmath48 is unavoidable for ( a ) .",
    "indeed , consider a very large planar grid plus an edge .",
    "such a graph clearly admits a toroidal embedding with face - width  @xmath49 . by suitably placing the additional edge ,",
    "such a graph would have arbitrarily large crossing number , and yet no @xmath31 minor .",
    "however , one could weaken this restriction a bit by considering `` nonseparating '' face - width instead , as we are going to do in the proof .",
    "furthermore , we shall show later ( section  [ sec : nodensity ] ) how to remove the density assumption @xmath48 completely for the algorithm ( b ) , using additional results of  @xcite .",
    "regarding the constants @xmath50 we note that , in our proofs ,    * @xmath45 is exponential in @xmath37 ( of order @xmath51 ) , * @xmath52 is independent of @xmath53 , and * @xmath54 and @xmath55 are quadratic in @xmath43 and exponential in @xmath37 ( of order @xmath56 ) .",
    "the rest of this paper is structured as follows . in section  [ sec : prelims ]",
    "we present some basic terminology and results on graph drawings and embeddings , and introduce the key concept of stretch of an embedded graph . in section  [ sec : mainresults ]",
    "we give a commentated walkthrough on the lemmas and theorems leading to the proof of theorem  [ thm : main - overview ] .",
    "the exact value of the constants @xmath50 is given there as well .",
    "some of the presented statements seem to be of independent interest , and their ( often long and technical ) proofs are deferred to the later sections of the paper .",
    "final section  [ sec : concluding ] then outlines some possible extensions of the main theorem and directions for future research .",
    "we follow standard terminology of topological graph theory , see mohar and thomassen  @xcite and stillwell  @xcite .",
    "we deal with undirected multigraphs by default ; so when speaking about a _",
    "graph _ , we allow multiple edges and loops .",
    "the vertex set of a graph @xmath0 is denoted by @xmath57 , the edge set by @xmath58 , the number of vertices of @xmath0 ( the _ size _ ) by @xmath59 , and the maximum degree by @xmath60 .    in this section",
    "we lay out several concepts and basic results relevant to this work , and introduce the key new concept of stretch of an embedded graph .",
    "we recall that in a _ drawing _ of a graph @xmath0 in a surface @xmath2 , vertices are mapped to points and edges are mapped to simple curves ( arcs ) such that the endpoints of an arc are the vertices of the corresponding edge ; no arc contains a point that represents a non - incident vertex . for simplicity",
    ", we often make no distinction between the topological objects of a drawing ( points and arcs ) and their corresponding graph theoretical objects ( vertices and edges ) .",
    "a _ crossing _ in a drawing is an intersection point of two edges ( or a self - intersection of one edge ) in a point other than a common endvertex",
    ". an _ embedding _ of a graph in a surface is a drawing with no edge crossings .",
    "if we regard an embedded graph @xmath0 as a subset of its host surface @xmath2 , then the connected components of @xmath61 are the _ faces _ of the embedding .",
    "we recall that the vertices of the _ topological dual _",
    "@xmath62 of @xmath0 are the faces of  @xmath0 , and its edges are the edge - adjacent pairs of faces of  @xmath0 .",
    "there is a natural one - to - one correspondence between the edges of @xmath0 and the edges of @xmath62 , and so , for an arbitrary @xmath63 , we denote by @xmath64 the corresponding subset of edges of  @xmath65 .",
    "we often use lower case greek letters ( such as @xmath66 ) to denote dual cycles .",
    "the rationale behind this practice is the convenience to regard a dual cycle as a simple closed curve , often paying no attention to its graph - theoretical properties .",
    "let @xmath0 be a graph embedded in a surface @xmath2 of genus @xmath67 , and let @xmath68 be a two - sided surface - nonseparating cycle of @xmath0 .",
    "we denote by @xmath69 the graph obtained by _ cutting @xmath0 through @xmath68 _ as follows .",
    "let @xmath70 denote the set of edges not in @xmath68 that are incident with a vertex in @xmath68 .",
    "orient @xmath68 arbitrarily , so that @xmath70 gets naturally partitioned into the set @xmath71 of edges to the left of @xmath68 and the set @xmath72 of edges to the right of @xmath68 .",
    "now contract ( topologically ) the whole curve representing @xmath68 to a point - vertex @xmath73 , to obtain a pinched surface , and then naturally split @xmath73 into two vertices , one incident with the edges in @xmath71 and another incident with the edges in @xmath72 .",
    "the resulting graph @xmath69 is thus embedded on a surface @xmath74 such that @xmath2 results from @xmath74 by adding one handle .",
    "clearly @xmath75 , and so for every subgraph @xmath76 there is a unique naturally corresponding subgraph @xmath77 ( on the same edge set ) , which we call the _ lift of @xmath70 into  @xmath0_.    the `` cutting through '' operation is a form of a standard surface surgery in topological graph theory , and we shall be using it in the dual form too , as follows .",
    "let @xmath0 be a graph embedded in a surface @xmath2 and @xmath78 a dual cycle such that @xmath79 is two - sided and @xmath2-nonseparating .",
    "now cut the surface along @xmath79 , discarding the set @xmath80 of edges of @xmath0 that are severed in the process .",
    "this yields an embedding of @xmath81 in a surface with two holes .",
    "then paste two discs , one along the boundary of each hole , to get back to a compact surface .",
    "we denote the resulting embedding by @xmath82 , and say that this is obtained by _ cutting @xmath0 along @xmath79_. note that we may equivalently define @xmath82 as the embedded @xmath83 .",
    "note also that @xmath84 , and that the previous definition of a _ lift",
    "_ applies also to this case .",
    "we further look at drawings of graphs ( in the plane ) that allow edge crossings . to resolve ambiguity , we only consider drawings where no three edges intersect in a common point other than a vertex .",
    "the _ crossing number _",
    "@xmath42 of a graph @xmath0 is then the minimum number of edge crossings in a drawing of @xmath0 in the plane .    for the general lower bounds we shall derive on the crossing number of graphs we use the following results on the crossing number of toroidal grids ( see  @xcite ) .",
    "[ thm : crossing - cpcq ] for all nonnegative integers @xmath20 and @xmath21 , @xmath85 .",
    "moreover , @xmath86 for @xmath87 .",
    "we note that this result already yields the easy part of theorem  [ thm : main - overview](a ) :    [ cor : crossing - texp ] let @xmath0 be a graph embedded on a surface",
    ". then @xmath88 .",
    "let @xmath89 be integers that witness @xmath28 ( that is , @xmath0 contains @xmath19 as a minor , and @xmath90 ) .",
    "it is known  @xcite that if @xmath0 contains @xmath4 as a minor , and @xmath91 , then @xmath92 .",
    "we apply this bound with @xmath93 . by theorem  [ thm : crossing - cpcq ] , we then have for @xmath94 that @xmath95 , and for @xmath96 we obtain @xmath97 .      for the rest of the paper",
    ", we shall exclusively focus on orientable surfaces , and for each @xmath98 we let @xmath36 denote the orientable surface of genus @xmath37 .",
    "note that in an embedded graph , paths are simple curves and cycles are simple closed curves in the surface , and hence it makes good sense to speak about their homotopy .",
    "in particular , there are no one - sided cycles embedded in @xmath36 .",
    "if @xmath99 is a path or a cycle of a graph , then the _ length _ @xmath100 of @xmath99 is its number of edges .",
    "we recall that the _ edge - width _ @xmath7 of an embedded graph @xmath0 is the length of a shortest noncontractible cycle in @xmath0 .",
    "the _ nonseparating edge - width _ @xmath101 is the length of a shortest nonseparating ( and hence also noncontractible ) cycle in @xmath0 .",
    "it is easy to see that the face - width @xmath1 of @xmath0 equals one half of the edge - width of the vertex - face incidence graph of  @xmath0 .",
    "it is also an easy exercise to show that @xmath102 . in this paper , we are primarily interested in graphs of bounded degree .",
    "we can thus regard @xmath103 as a suitable ( easier to deal with ) replacement for @xmath1 .    for a cycle ( or an arbitrary subgraph ) @xmath68 in a graph @xmath0",
    ", we call a path @xmath104 a _ @xmath68-ear _ if the ends @xmath105 of @xmath106 belong to @xmath68 , but the rest of @xmath106 is disjoint from @xmath68 .",
    "we allow @xmath107 , i.e. , a @xmath68-ear can also be a cycle .",
    "a @xmath68-ear @xmath106 is a ( with respect to an orientable embedding of @xmath0 ) if the two edges of @xmath106 incident with the ends @xmath105 are embedded on opposite sides of  @xmath68 .",
    "the following simple technical claim is useful .",
    "[ lem : kl2 ] if @xmath68 is a nonseparating cycle in an embedded graph @xmath0 of length @xmath108 , then all @xmath68-switching ears in @xmath0 have length at least @xmath109 .    seeking a contradiction , we suppose that there is a @xmath68-switching ear @xmath110 of length @xmath111 .",
    "the ends of @xmath110 on @xmath68 determine two subpaths @xmath112 ( with the same ends as @xmath110 ) , labeled so that @xmath113",
    ". then @xmath114 ( respectively , @xmath115 ) is a nonseparating cycle , as witnessed by @xmath116 ( respectively , @xmath117 ) . since @xmath118 , then @xmath119 a contradiction .    even though surface surgery can drastically decrease ( and also increase , of course ) the edge - width of an embedded graph in general",
    ", we now prove that this is not the case if we cut through a short cycle ( in lemma  [ lem : cutdew ] we shall establish a surprisingly powerful extension of this simple claim ) .    [",
    "lem : dew2 ] let @xmath0 be a graph embedded in the orientable surface @xmath36 of genus @xmath120 , and let @xmath68 be a nonseparating cycle in @xmath0 of length @xmath108",
    ". then @xmath121 .",
    "let @xmath122 be the two vertices of @xmath69 that result from cutting through @xmath68 , i.e. , @xmath123 .",
    "let @xmath124 be a nonseparating cycle of length @xmath125 .",
    "if @xmath110 avoids both @xmath122 , then its lift @xmath126 in @xmath0 is a nonseparating cycle again , and so @xmath127 . if @xmath110 hits both @xmath122 and @xmath128 is ( any ) one of the two subpaths with the ends @xmath122 , then the lift @xmath129 is a @xmath68-switching ear in @xmath0 .",
    "thus , by lemma  [ lem : kl2 ] , @xmath130    in the remaining case @xmath110 , up to symmetry , hits @xmath52 and avoids  @xmath54 .",
    "then its lift @xmath126 is a @xmath68-ear in @xmath0 .",
    "if @xmath126 itself is a cycle , then we are done as above . otherwise , @xmath131 is the union of three nontrivial internally disjoint paths with common ends , forming exactly three cycles @xmath132 .",
    "since @xmath110 is nonseparating in @xmath69 , each of @xmath133 is nonseparating in  @xmath0 , and hence @xmath134 for @xmath135 .",
    "since every edge of @xmath136 is in exactly two of @xmath133 , we have @xmath137 and @xmath138 , from which we get @xmath139    many arguments in our paper exploit the mutual position of two graph cycles in a surface . in topology , the _ geometric intersection number_-crossing '' .",
    "such a terminology would , however , conflict with the graph crossing number , and we have to avoid it . following  @xcite , we thus use the term `` @xmath140-leaping '' , instead . ]",
    "@xmath141 of two ( simple ) closed curves @xmath142 in a surface is defined as @xmath143 , where the minimum is taken over all pairs @xmath144 such that @xmath145 ( respectively , @xmath146 ) is homotopic to @xmath147 ( respectively , @xmath148 ) . for our purposes , however , we prefer the following slightly adjusted discrete view of this concept .",
    "let @xmath149 be cycles of a graph embedded in a surface @xmath2 .",
    "let @xmath150 be a connected component of the graph intersection @xmath151 ( a path or a single vertex ) , and let @xmath152 ( respectively , @xmath153 ) be the edges immediately preceding and succeeding @xmath106 in @xmath154 ( respectively , @xmath99 )",
    ". see figure  [ fig : defineleap ] .",
    "then @xmath106 is called a _ leap of a , b _ if there is a sufficiently small open neighborhood @xmath155 of @xmath106 in @xmath2 such that the mentioned edges meet the boundary of @xmath155 in this cyclic order ; @xmath156 ( i.e. , @xmath154 and @xmath99 _ meet transversely in  @xmath106 _ ) .",
    "note that @xmath151 may contain other components besides @xmath106 that are not leaps .",
    "[ def : leaping ] two cycles @xmath157 of an embedded graph are in a _ @xmath140-leap position _",
    "( or simply _ @xmath140-leaping _ ) , if their intersection @xmath151 has exactly @xmath140 connected components that are leaps of @xmath157 .",
    "if @xmath140 is odd , then we say that @xmath157 are in an _ odd - leap position_.    we now observe some basic properties of the @xmath140-leap concept :    * if @xmath157 are in an odd - leap position , then necessarily each of @xmath157 is noncontractible and nonseparating .",
    "* it is not always true that @xmath157 in a @xmath140-leap position have geometric intersection number exactly @xmath140 , but the parity of the two numbers is preserved . particularly , @xmath157 are in an odd - leap position if and only if their geometric intersection number is odd .",
    "( we will not directly use this fact herein , though . )",
    "* we will later prove ( lemma  [ lem:3pp ] ) that the set of embedded cycles that are odd - leaping a given cycle @xmath154 satisfies the useful _",
    "@xmath158-path condition _",
    "* section  4.3 ) ) .      in the quest for another embedding density parameter suitable for capturing the two - dimensional character of the toroidal expanse and crossing number problems , we put forward the following concept improving upon the original `` orthogonal width '' of @xcite .",
    "[ def : stretch ]",
    "let @xmath0 be a graph embedded in an orientable surface @xmath2 .",
    "the _ stretch @xmath159 of @xmath0 _ is the minimum value of @xmath160 over all pairs of cycles @xmath161 that are in a one - leap position in  @xmath2 .    as we noted above , if @xmath157 are in an odd - leap position , then both @xmath154 and @xmath99 are noncontractible and nonseparating .",
    "thus it follows that @xmath162 .",
    "we postulate that stretch is a natural two - dimensional analogue of edge - width , a well - known and often used embedding density parameter .",
    "actually , one may argue that the dual edge - width is a more suitable parameter to measure the density of an embedding , and so we shall mostly deal with _ dual stretch_the stretch of the topological dual @xmath62later in this paper ( starting since lemma  [ lem : cr - stretch - torus ] and section  [ sec : mainresults ] ) .",
    "analogously to face - width , we can also define the _ face stretch _ of @xmath0 as one quarter of the stretch of the vertex - face incidence graph of @xmath0 , and this is to be discussed later in section  [ sec : facestretch ] .",
    "we note in passing that although our paper does not use nor provide an algorithm to compute the stretch of an embedding , this can be done efficiently on any surface  @xcite .",
    "we now prove several basic facts about the stretch of an embedded graph .",
    "we start with an easy observation .",
    "[ lem : thstr ] if @xmath68 is a nonseparating cycle in an embedded graph @xmath0 , and @xmath106 is a @xmath68-switching ear in @xmath0 , then @xmath163 .",
    "the ends of @xmath106 partition @xmath68 into two paths @xmath164 , which we label so that @xmath165 .",
    "( in a degenerate case , @xmath166 can be a single vertex ) .",
    "thus @xmath167 .",
    "since @xmath68 and @xmath168 are in a one - leap position , we have @xmath169 .    a tight relation of stretch to the topic of our paper",
    "is illustrated in the following claims .",
    "[ lem : cr - stretch - torus ] if @xmath0 is a graph embedded in the torus , then @xmath170 .",
    "let @xmath171 be a pair of dual cycles witnessing @xmath172 , and let @xmath173 , @xmath174 , and @xmath175 .",
    "note that @xmath176 , and @xmath177 are edge sets in  @xmath0 .",
    "then , by cutting @xmath0 along @xmath147 , we obtain a plane ( cylindrical ) embedding @xmath178 of @xmath179 .",
    "it is easily possible to draw the edges of @xmath180 into @xmath178 in one parallel `` bunch '' along the fragment of @xmath148 such that they cross only with edges of @xmath71 and @xmath181 ( indeed , crossings between edges of @xmath180 are necessary when @xmath182 ) , thus getting a drawing of @xmath0 in the plane",
    ". see figure  [ fig : addedges ] .",
    "the total number of crossings in this particular drawing , and thus the crossing number of @xmath0 , is at most @xmath183 if @xmath0 is a graph embedded in the torus , then @xmath184 .",
    "this follows immediately using corollary  [ cor : crossing - texp ] .",
    "we finish this section by proving an analogue of lemma  [ lem : dew2 ] for the stretch of an embedded graph , showing that this parameter can not decrease too much if we cut the embedding through a short cycle .",
    "this will be important to us since cutting through handles of embedded graphs will be our main inductive tool in the proofs of lower bounds on @xmath42 and @xmath28 .",
    "[ lem : str4 ] let @xmath0 be a graph embedded in the orientable surface @xmath36 of genus @xmath120 , and let @xmath68 be a nonseparating cycle in @xmath0 of length @xmath108",
    ". then @xmath185 .",
    "let @xmath122 be the two vertices of @xmath69 that result from cutting through @xmath68 , i.e. , @xmath123 .",
    "suppose that @xmath186 is attained by a pair of one - leaping cycles @xmath157 in  @xmath69 , with @xmath187 and @xmath188 .",
    "our goal is to show that @xmath189 . using lemma  [ lem : dew2 ] and the fact that both @xmath157 are nonseparating , we get @xmath190    suppose first that both @xmath191 .",
    "then there exists a path @xmath192 connecting @xmath52 to @xmath54 such that @xmath193 . clearly , its lift @xmath129 is a @xmath68-switching ear in @xmath0 , and so by lemma  [ lem : thstr ] and ( [ eq : abrho ] ) , @xmath194    finally suppose that , up to symmetry , @xmath195 but possibly @xmath196 .",
    "consider the lift @xmath197 in @xmath0 ( which is a @xmath68-ear in the case @xmath198 ) .",
    "we define @xmath199 to be @xmath197 if @xmath197 is a cycle , and otherwise @xmath200 where @xmath201 is a shortest subpath with the same ends in @xmath68 as @xmath197 .",
    "we define @xmath202 analogously . with the help of a simple case - analysis ,",
    "it is straightforward to verify that the cycles @xmath203 form a one - leaping pair in @xmath0 , and so again using lemma  [ lem : thstr ] we obtain @xmath204",
    "in this section we shall state the results leading to the proof of theorem  [ thm : main - overview ] , which is given in section  [ sub : mainproof ] .",
    "the proofs of ( most of ) these statements are long and technical , and so they are deferred to the later sections of the paper .    to reach our main goal , i.e. , to provide a proof for theorem  [ thm : main - overview ]",
    ", we aim to :    * extend the upper estimate of lemma  [ lem : cr - stretch - torus ] to surfaces of higher genus than the torus ; and * provide asymptotically matching lower bounds on @xmath42 and @xmath28 in terms of the dual stretch of @xmath0 .",
    "while the upper bounds are given ( cf .",
    "lemma  [ lem : cr - stretch - torus ] ) for the crossing number , the lower bounds here will be investigated for the toroidal expanse . at first glance ,",
    "goal ( i ) would appear to be much easier than ( ii ) , but it is not really so straightforward due to some complications in expressing the upper bound ( cf .",
    "theorem  [ thm : upper - cr ] below ) .",
    "such difficulties are to be expected : for instance , a graph embedded in the double torus could have a huge toroidal grid living in one of the handles , and yet very small dual stretch due to a very small dual edge width in the other handle .",
    "since we will frequently deal with dual graphs in our arguments , we introduce several conventions in order to help comprehension .",
    "when we add an adjective _ dual _ to a graph term , we mean this term in the topological dual of the ( currently considered ) graph . we will denote the faces of an embedded graph @xmath0 using lowercase letters , treating them as vertices of its dual @xmath62 . as we already mentioned in section  [ sub : gdes ] , we use lowercase greek letters to refer to subgraphs ( cycles or paths ) of  @xmath62 , and when there is no danger of confusion , we do not formally distinguish between a graph and its embedding . in particular ,",
    "if @xmath205 is a dual cycle , then @xmath147 also refers to the loop on the surface determined by the embedding  @xmath0 .",
    "finally , we will denote by @xmath206 the nonseparating edge - width of the dual  @xmath62 of  @xmath0 , and by @xmath207 the dual stretch of  @xmath0 .",
    "we first give some basic lower bound estimates for the toroidal expanse , aimed at goal ( ii ) above .",
    "these estimates ultimately rely on the following basic result , which appears to be of independent interest . loosely speaking",
    ", it states that if a graph has two collections of cycles that mimic the topological properties of the cycles that build up a @xmath208-toroidal grid , then the graph does contain such a grid as a minor .",
    "we say that a pair @xmath209 of curves in the torus is a _",
    "( for the fundamental group ) if there are no integers @xmath210 such that @xmath211 is homotopic to @xmath212 .",
    "[ thm : two - cycle - families ] let @xmath0 be a graph embedded in the torus .",
    "suppose that @xmath0 contains a collection @xmath213 of @xmath214 pairwise disjoint , pairwise homotopic cycles , and a collection @xmath215 of @xmath216 pairwise disjoint , pairwise homotopic cycles .",
    "further suppose that the pair @xmath217 is a basis",
    ". then @xmath0 contains a @xmath208-toroidal grid as a minor .",
    "the proof of this statement is in section  [ sec : grids ] .",
    "now recall that in the torus @xmath218 , and so @xmath219 .",
    "hence , for instance , one can formulate theorem  [ thm : degs ] in terms of nonseparating dual edge - width .",
    "along these lines we shall derive the following as a consequence of theorem  [ thm : two - cycle - families ] ( the proof is also in section  [ sec : grids ] ) :    [ thm : agrid - torus ] let @xmath0 be a graph embedded in the torus and @xmath220 .",
    "let @xmath221 be the largest integer such that , in the dual graph @xmath62 , there exists a dual cycle @xmath147 of length @xmath140 and the shortest @xmath147-switching dual ear has length  @xmath221 ( recall from lemma  [ lem : kl2 ] that @xmath222 ) .",
    "if @xmath223 , then @xmath0 contains as a minor the toroidal grid of size @xmath224    hence the toroidal expanse of @xmath0 is at least @xmath225 . on the other hand , since @xmath226 , by theorem  [ thm : degs ] it follows that the toroidal expanse of @xmath0 is at least @xmath227 .",
    "therefore our estimate becomes useful roughly whenever @xmath228 .",
    "now by lemma  [ lem : thstr ] ( applied to @xmath62 ) , we have @xmath229 , and so @xmath228 whenever @xmath230 .",
    "moreover , theorem  [ thm : agrid - torus ] can be reformulated in terms of @xmath231 ( instead of `` @xmath232 '' ) .",
    "this reformulation is important for the general estimate on the toroidal expanse of @xmath0 :    [ cor : agrid - torus ] let @xmath0 be a graph embedded in the torus with @xmath233 .",
    "then @xmath234 furthermore , for any @xmath235 there is a @xmath236 such that if @xmath237 , then @xmath238 .    for the proof of this statement",
    ", we again refer to section  [ sec : grids ] .    stepping up to orientable surfaces of genus @xmath239",
    ", we use lemmas  [ lem : dew2 ] and  [ lem : str4 ] and corollary  [ cor : agrid - torus ] iteratively ( @xmath240 times ) , cutting through shortest nonseparating dual cycles .",
    "this easily leads by induction to the following lower estimate :    [ cor : agrid - all ] let @xmath0 be a graph embedded in the orientable surface @xmath36 , @xmath241 , such that @xmath242",
    ". then @xmath243    this bound is , unfortunately , not strong enough to give the desired conclusion for @xmath120 , but it is nevertheless useful in the course of deriving a stronger estimate later on ( cf .  lemma  [ lem : kl - to - stretch ] ) .",
    "we now tackle task ( i ) : to give an algorithmically efficient upper bound on the crossing number of a graph embedded in @xmath36 .",
    "peter brass conjectured the existence of a constant @xmath6 such that the crossing number of a toroidal graph on @xmath244 vertices is at most @xmath245 .",
    "this conjecture was proved by pach and tth  @xcite .",
    "moreover , pach and tth showed that for every orientable surface @xmath2 there is a constant @xmath246 such that the crossing number of an @xmath244-vertex graph embeddable on @xmath2 is at most @xmath247 ; this result was extended to any surface by brczky , pach , and tth  @xcite .",
    "the constant @xmath246 proved in these papers is exponential in the genus of @xmath2 .",
    "this was later refined by djidjev and vrto  @xcite , who decreased the bound to @xmath248 , and proved that this is tight within a constant factor .    at the heart of these results",
    "lies the technique of ( perhaps recursively ) cutting along a suitable _ planarizing _ subgraph ( most naturally , a set of short cycles ) , and then redrawing the missing edges without introducing too many crossings .",
    "our techniques and aims are of a similar spirit , although our cutting process is more delicate , due to our need to ( eventually ) find a matching lower bound for the number of crossings in the resulting drawing .",
    "our cutting paradigm is formalized in the following definition .",
    "[ def : good - planarizing ] let @xmath0 be a graph embedded in the orientable surface @xmath36 .",
    "a sequence @xmath249 is called a _ good planarizing sequence for @xmath0 _ if the following holds for @xmath250 , letting @xmath251 :    * @xmath252 is a graph embedded in @xmath253 , * @xmath254 is a nonseparating cycle in @xmath255 of length @xmath256 , and * @xmath252 results by cutting the embedding @xmath255 through @xmath254 .",
    "we implicitly associate such a planarizing sequence with the values @xmath257 , where @xmath258 and @xmath259 is the length of a shortest @xmath254-switching ear in @xmath255 , for @xmath250 .    in order to upper bound the crossing number of an embedded graph ,",
    "we make use of good planarizing sequences in the dual graph , as stated in the following result .",
    "[ thm : upper - cr ] let @xmath0 be a graph embedded in @xmath36 .",
    "let @xmath260 be a good planarizing sequence for the topological dual @xmath62 , with associated lengths @xmath261 .",
    "then @xmath262 there is an algorithm that produces a drawing of @xmath0 in the plane with at most crossings in time @xmath263 for fixed  @xmath37 .",
    "the proof of this theorem is given in section  [ sec : drawing - upper ] .",
    "let us briefly revise where we stand in our way towards proving theorem  [ thm : main - overview ] .",
    "the right hand side of part ( a ) already follows from corollary  [ cor : crossing - texp ] , and so to finish this part we need an estimate of the form @xmath264 .",
    "we currently have a lower bound for @xmath28 in terms of @xmath231 ( corollary  [ cor : agrid - all ] ) and an upper bound for @xmath42 in terms of @xmath265 .",
    "it may thus appear that our next task is to bridge the gap by proving that @xmath266 . as it happens , no such statement is true in general , and so we need to find a way around this difficulty .",
    "the following is a key technical claim that allows us to bridge the aforementioned gap .",
    "[ lem : kl - to - stretch ] let @xmath4 be a graph embedded in the orientable surface @xmath36 .",
    "let @xmath267 , and let @xmath221 be the largest integer such that there is a cycle @xmath79 of length @xmath140 in @xmath268 whose shortest @xmath79-switching ear has length  @xmath221 .",
    "assume @xmath269 .",
    "then there exists an integer @xmath270 , @xmath271 , and a subgraph @xmath272 of @xmath4 embedded in @xmath273 such that @xmath274    in a nutshell , the main idea behind the proof of this statement is to cut along handles that ( may ) cause small stretch , until we arrive to the desired toroidal @xmath275 grid .    the arguments required to prove lemma  [ lem : kl - to - stretch ] span two sections .",
    "in section  [ sec : more ] we establish several basic results on the stretch of an embedded graph .",
    "as we believe this new parameter may be of independent interest , it makes sense to gather these results in a standalone section for possible further reference .",
    "the proof of lemma  [ lem : kl - to - stretch ] is then presented in section  [ sec : finding ] .",
    "the importance of lemma  [ lem : kl - to - stretch ] is its crucial role in establishing the following result , the final step in bridging the approximation gap .",
    "[ cor : kl - to - stretch ] let @xmath0 be a graph embedded in @xmath36 .",
    "let @xmath260 be a good planarizing sequence of @xmath62 , with associated lengths @xmath261 .",
    "suppose that @xmath242 .",
    "then @xmath276 consequently , @xmath277    let @xmath278 be the smallest integer such that @xmath279 , and let @xmath280 ( in case @xmath281 , recall that we set @xmath282 ) . thus @xmath4 is embedded in a surface of genus @xmath283 .",
    "an iterative application of lemma  [ lem : dew2 ] yields that @xmath284 .",
    "we now apply lemma  [ lem : kl - to - stretch ] to @xmath4 .",
    "thus the resulting graph @xmath272 of genus @xmath285 satisfies @xmath286 and @xmath287 .",
    "note that , even though @xmath288 may not be a subgraph of @xmath62 , we have that @xmath4 ( and thus @xmath272 ) is a subgraph of @xmath0 , and so @xmath289 . using corollary  [ cor : agrid - all ] we finally get @xmath290 the second inequality then follows immediately by corollary  [ cor : crossing - texp ] .",
    "having deferred the long and technical proofs of the previous subsections for the later sections of the paper , all the ingredients are now in place to prove theorem  [ thm : main - overview ] .",
    "the right hand side inequality in ( a ) follows from corollary  [ cor : crossing - texp ] ( with @xmath291 ) , and the left hand side follows at once by combining theorem  [ thm : upper - cr ] and corollary  [ cor : kl - to - stretch ] . finally we note that part ( b ) follows from theorem  [ thm : upper - cr ] and ( the crossing number inequality in ) corollary  [ cor : kl - to - stretch ] .",
    "in this section we prove theorems  [ thm : two - cycle - families ] and  [ thm : agrid - torus ] and corollary  [ cor : agrid - torus ] .",
    "let @xmath292 be oriented simple closed curves such that @xmath293 is a basis , and such that @xmath147 and @xmath148 intersect ( cross ) each other exactly once . using a standard surface homeomorphism argument ( cf .",
    "@xcite ) , we may assume without loss of generality that each @xmath254 has the same homotopy type as @xmath147 ( we assign an orientation to the cycles @xmath254 to ensure this ) .",
    "thus it follows that the cycles @xmath294 may be oriented in such a way that there exist integers @xmath295 such that the homotopy type of each @xmath294 is @xmath296 .",
    "we assume without loss of generality that @xmath297 .",
    "we let @xmath298 and @xmath299 .",
    "we shall assume that among all possible choices of the collections @xmath213 and @xmath300 that satisfy the conditions in the theorem ( for the given values of @xmath20 and @xmath21 ) , our collection @xmath301 minimizes @xmath302 .",
    "the indices of the @xmath254-cycles ( respectively , the @xmath294-cycles ) are read modulo @xmath20 ( respectively , modulo @xmath21 ) .",
    "we may assume that the cycles @xmath303 appear in this cyclic order around the torus ; that is , for each @xmath304 , one of the cylinders bounded by @xmath254 and @xmath305 does not intersect any other curve in @xmath306 .",
    "moreover , we may choose this labeling so that @xmath148 intersects @xmath307 in this cyclic order .",
    "at first glance it may appear that it is easy to get the desired grid as a minor of @xmath308 , since every @xmath294 has to intersect each @xmath254 in some vertex of @xmath0 ( this follows since each pair @xmath309 is a basis ) .",
    "there are , however , two possible complications . first , two cycles @xmath310 could have many `` zigzag '' intersections , with @xmath294 intersecting @xmath254 , then @xmath305 , then @xmath254 again , etc .",
    "second , @xmath294 may `` wind '' many times in the direction orthogonal to  @xmath254 .",
    "these are the problems to overcome in the upcoming proof .",
    "we start by showing that , even though we may intersect some @xmath254 several times when traversing some @xmath294 , it follows from the choice of @xmath306 that , after @xmath294 intersects @xmath254 , it must hit either @xmath311 or @xmath305 before coming back to @xmath254 .",
    "[ clm_ear ] no @xmath312-ear contained in @xmath313 has both ends on the same cycle @xmath254 .",
    "suppose that there is a @xmath312-ear @xmath314 with both ends on the same @xmath254 .",
    "modify @xmath254 by following @xmath106 in the appropriate section , and let @xmath315 be the resulting cycle .",
    "the families @xmath316 and @xmath300 satisfy the conditions in the theorem . the fact that @xmath317 contradicts the choice of @xmath318 .    for any cycle @xmath68 ,",
    "a _ quasicycle _ is a graph - homomorphic image of @xmath68 without degree-@xmath49 vertices , implicitly retaining its cyclic ordering of vertices .",
    "let @xmath319 be a quasicycle in @xmath0 homotopic to @xmath117 , with its same orientation .",
    "we say that @xmath319 is _ @xmath312-ear good _ if ( cf .",
    "claim  [ clm_ear ] ) no @xmath312-ear contained in @xmath319 has both ends on the same  @xmath254 .",
    "the _ rank _",
    "@xmath320 of @xmath319 is the number of connected components of @xmath321 . by traversing @xmath319",
    "once and registering each time it intersects a curve in @xmath306 , starting with ( some intersection with ) @xmath166 , we obtain an _ intersection sequence _ @xmath322 , @xmath323 , where each @xmath322 is in @xmath324 .",
    "since we chose the starting point of the traversal of @xmath319 so that the first curve of @xmath306 it intersects is @xmath166 , it follows that @xmath325 .",
    "we read the indices of this subsequence modulo @xmath320 .",
    "we denote by @xmath326 , @xmath327 , the path of @xmath319 ( possibly a single vertex ) forming the corresponding intersection with the cycle @xmath328 , and by @xmath329 the path of @xmath319 between @xmath326 and @xmath330 .",
    "if @xmath319 is @xmath312-ear good then @xmath331 , and hence in this case @xmath332 for @xmath327 .",
    "a collection of @xmath312-ear good quasicycles @xmath333 in @xmath0 is _ quasigood _ if it satisfies the property that whenever @xmath334 intersects @xmath335 in a path @xmath106 ( counting also the case of a self - intersection with @xmath336 ) , the following hold up to symmetry between @xmath244 and @xmath337 : ( i )  @xmath338 for an appropriate index @xmath339 of the intersection sequence of @xmath334 for which @xmath340 and @xmath341 ; and ( ii ) the path @xmath342 of @xmath334 stays locally on one side of the ( embedded ) quasicycle @xmath335",
    ". informally , this means that if @xmath334 intersects @xmath335 in  @xmath106 , then @xmath334 makes a @xmath343-ear with @xmath106 `` touching '' @xmath335 from the left side . for further reference",
    "we say that @xmath334 is locally on the _ left side _ of the intersection  @xmath106 .",
    "since @xmath294 is clearly a @xmath312-ear good quasicycle for each @xmath344 , it follows that @xmath345 is a quasigood collection .",
    "now among all choices of a quasigood collection @xmath333 in @xmath0 , we select one minimizing the sum of the ranks of its quasicycles . for each @xmath319 , as above we let @xmath320 denote its rank .    [ clm_quasi ] for all @xmath346 the intersection sequence of @xmath319 satisfies @xmath347 for any @xmath348 .",
    "consequently , @xmath333 is a collection of pairwise disjoint cycles in  @xmath0 .",
    "the conclusion that @xmath349 is a collection of pairwise disjoint cycles directly follows from the first statement in the claim , since it is a quasigood collection .",
    "we hence focus on the first statement in the following .    the main idea in the proof is quite simple :",
    "if @xmath350 , then we could modify @xmath319 rerouting it through @xmath351 instead of @xmath352 , thus decreasing @xmath320 ( and hence the total sum of the ranks ) by @xmath353 , and consequently contradicting the choice of @xmath354 .",
    "we now formalize this idea .",
    "let @xmath355 denote the cylinder bounded by @xmath254 and @xmath305 .",
    "note that if for some @xmath356 we have @xmath350 and @xmath357 , then necessarily for some @xmath358 we must have @xmath359 and @xmath360 .",
    "so , seeking a contradiction , we may suppose that there exist @xmath356 such that @xmath361 and @xmath362 .",
    "then the path @xmath363 is drawn in @xmath355 with both ends on @xmath254 and `` touching ''  ( i.e. , not intersecting transversally ) @xmath305 .",
    "we denote by @xmath364 the open region bounded by @xmath106 and @xmath254 , and by @xmath365 the section of the boundary of @xmath366 not belonging to  @xmath319 .    assuming that @xmath366 is minimal over all choices of  @xmath278",
    "for which @xmath350 , we show that no @xmath335 , @xmath367 , intersects  @xmath366 . indeed ,",
    "if some @xmath335 intersected @xmath366 , then @xmath335 could not enter @xmath366 across @xmath106 by the `` stay on one side '' property of a quasigood collection . hence @xmath335 should enter and leave @xmath366 across  @xmath368 , but not touch @xmath369 , by the minimality of @xmath366 .",
    "but then , @xmath335 would make a @xmath312-ear with both ends on @xmath254 , contradicting the assumption that @xmath335 is @xmath312-ear good .",
    "now we form @xmath370 as the symmetric difference of @xmath319 with the boundary of  @xmath366 ( so that @xmath370 follows @xmath365 ) . to argue that @xmath371 is a quasigood collection again",
    ", it suffices to verify all possible new intersections of @xmath370 along  @xmath365 .",
    "suppose there is an @xmath334 such that its intersection @xmath372 with @xmath254 contains some internal vertex of @xmath365 .",
    "since @xmath334 is disjoint from ( the open region ) @xmath366 , it will `` stay on one side '' of @xmath370 .",
    "if @xmath372 intersects @xmath319 , then @xmath334 must be locally on the left side of this intersection , and so it is also on the left side of the intersection with @xmath370 . if , on the other hand , @xmath372 is disjoint from @xmath319 , then the adjacent paths @xmath373 and @xmath374 have to connect to @xmath311 by claim  [ clm_ear ] , and so we have @xmath375 and @xmath376 as required by the definition for @xmath334 on the left side .",
    "let @xmath377 be the collection derived from @xmath378 by substituting @xmath319 with @xmath370 .",
    "in every case , @xmath377 is quasigood as well , but the sum of the ranks of its elements is strictly smaller ( by  @xmath353 ) than it is for  @xmath378 .",
    "this contradicts the choice of @xmath378 .",
    "[ clm_wonce ] there is a collection of @xmath21 pairwise disjoint , pairwise homotopic noncontractible cycles in  @xmath0 , each of which has a connected nonempty intersection with each cycle in @xmath306 .",
    "it follows from claim  [ clm_quasi ] that the intersection sequence of each @xmath319 is a @xmath379-fold repetition of the subsequence @xmath380 , for some nonnegative integer @xmath379 .",
    "if @xmath381 , we are obviously done , so assume @xmath382 .",
    "our task is to `` shortcut '' each @xmath319 such that it `` winds only once '' in the direction orthogonal to @xmath147 ( more formally , to modify each @xmath319 so that its homotopy type is @xmath383 for some integer @xmath3 ) .",
    "note that , for all @xmath384 , every @xmath254-ear contained in any @xmath319 is @xmath254-switching by claim  [ clm_quasi ] .",
    "each such ear naturally inherits an orientation from @xmath319 , so that after leaving @xmath254 it intersects @xmath385 in this order , and then intersects @xmath254 again .",
    "let @xmath386 be any @xmath166-ear , and let @xmath387 be their start and end points , respectively .",
    "then let @xmath388 be ( any ) one of the two paths contained in @xmath166 with endpoints @xmath389 .",
    "it is clear that the cycle @xmath390 is a simple closed curve that has a connected nonempty intersection with each @xmath254 .",
    "our final task is to find , for each @xmath391 , a homotopic , similarly constructed cycle @xmath392 , so that the cycles @xmath393 are pairwise disjoint .",
    "since @xmath394 is not homotopic to @xmath395 , every @xmath319 has to intersect @xmath394 in @xmath396 ; this intersection is a path @xmath397 ( possibly a single vertex ) .",
    "since the curves @xmath319 are pairwise disjoint , it follows that the paths @xmath397 are also pairwise disjoint . for @xmath391 , let @xmath398 be the point in @xmath397 closest to @xmath399 , and let @xmath400 be the unique @xmath166-ear starting at @xmath398 .",
    "now let @xmath401 be the unique @xmath402-ear starting on a vertex in @xmath400 , and let @xmath403 be the path joining the ends of @xmath401 that is disjoint from @xmath404 . finally , set @xmath405 , for @xmath391 .",
    "it is straightforward to check that the curves @xmath406 satisfy the required properties .    to conclude the proof of theorem  [ thm : two - cycle - families ] , we let @xmath407 be the collection guaranteed by this last claim . for each @xmath304 and @xmath344 , we contract the path @xmath408 to a single vertex ( unless it already is a single vertex ) .",
    "since the curves @xmath409 are pairwise disjoint and pairwise homotopic , it directly follows that the resulting graph is isomorphic to a subdivision of the @xmath208-toroidal grid .",
    "first we show the following .",
    "[ cl : ellcycles ] @xmath0 has a set of at least @xmath410 pairwise disjoint cycles , all homotopic to @xmath147 .",
    "let @xmath70 be the set of those edges of @xmath0 intersected by @xmath147 .",
    "let @xmath411 be loops very close to and homotopic to @xmath147 , one to each side of @xmath147 , so that the cylinder bounded by @xmath412 and @xmath413 that contains @xmath147 intersects @xmath0 only in the edges of @xmath70 .",
    "now we cut the torus by removing the ( open ) cylinder bounded by @xmath412 and @xmath413 , thus leaving an embedded graph @xmath414 on a cylinder @xmath415 with boundary curves ( `` rims '' ) @xmath412 and @xmath413 .",
    "let @xmath416 be a curve on @xmath415 connecting a point of @xmath412 to a point of @xmath413 , such that @xmath416 has the fewest possible points in common with the embedding @xmath4 .",
    "we note that we may clearly assume that the @xmath20 points in which @xmath416 intersects @xmath4 are vertices .    we claim that @xmath417 . indeed ,",
    "if @xmath418 , then the union of all faces incident with the @xmath20 vertices intersected by @xmath416 would contain a dual path @xmath148 of length at most @xmath419 . such @xmath148 would be an @xmath147-switching dual ear in @xmath62 of length less than @xmath221 , a contradiction .",
    "we now cut open the cylinder @xmath415 along @xmath416 , duplicating each vertex intersected by @xmath416 . as a result",
    "we obtain a graph @xmath272 embedded in the rectangle with sides @xmath420 in this cyclic order , so that @xmath421 ( respectively , @xmath422 ) contains @xmath20 vertices @xmath423 ( respectively , @xmath424 ) .",
    "we note that there is no vertex cut of size at most @xmath425 in @xmath272 separating @xmath426 from @xmath427 , for such a vertex cut would imply the existence of a curve @xmath428 from @xmath412 to @xmath413 on @xmath415 intersecting @xmath4 in fewer than @xmath20 points , contradicting our choice of @xmath416 . thus applying menger s theorem we obtain @xmath20 pairwise disjoint paths from @xmath426 to @xmath427 in @xmath272 .",
    "moreover , it follows by planarity of @xmath272 that each of these paths connects @xmath429 to the corresponding @xmath430 for @xmath384 . by identifying back @xmath429 and @xmath430 for @xmath384",
    ", we get a collection of @xmath20 pairwise disjoint cycles in  @xmath4 , each of them homotopic to @xmath147 .",
    "we have thus proved the existence of a collection @xmath306 of @xmath431 pairwise disjoint , pairwise homotopic noncontractible cycles . by theorem  [ thm : degs ] , since @xmath432 , it follows that @xmath0 also contains two collections @xmath433 of cycles such that : ( i ) the cycles in @xmath378 are noncontractible , pairwise disjoint , and pairwise homotopic ; ( ii ) the cycles in @xmath434 are noncontractible , pairwise disjoint , and pairwise homotopic ; ( iii ) for any @xmath435 and @xmath436 , the pair @xmath437 is a basis ; and ( iv ) each of @xmath438 and @xmath439 is at least @xmath440 .",
    "let @xmath441 , @xmath435 , and @xmath436 . from properties",
    "( i)(iii ) it follows that either @xmath209 or @xmath442 is a basis .",
    "therefore the result follows from theorem  [ thm : two - cycle - families ] .",
    "let @xmath220 , and let @xmath221 and @xmath147 be as in theorem  [ thm : agrid - torus ] .",
    "by lemma  [ lem : thstr ] , .",
    "let @xmath443 .",
    "since @xmath444 , it follows that @xmath445 ( with equality at @xmath446 ) . letting @xmath447",
    "we then get , by theorem  [ thm : agrid - torus ] , @xmath448 in order to get the better asymptotic estimate @xmath449 , we directly apply theorem  [ thm : degs ] in the case @xmath450 ; otherwise , we use the stronger bound @xmath451 .",
    "in this section , we prove theorem  [ thm : upper - cr ] .",
    "that is , we provide an efficient algorithm that , given a graph @xmath0 embedded in some orientable surface , yields a drawing of @xmath0 ( with a controlled number of crossings ) in the plane .",
    "although our algorithm takes an embedded graph as its input , we might as well take the non - embedded graph as input without any loss of efficiency ; indeed , mohar  @xcite showed that , for any fixed genus @xmath37 , there is a linear time algorithm that takes as input any graph @xmath0 embeddable in @xmath36 and outputs an embedding of @xmath0 in @xmath36 .",
    "we start with an informal outline of the proof .",
    "we proceed in @xmath37 steps , working at the @xmath452-th step with the pair @xmath453 . for convenience ,",
    "let @xmath251 , and define @xmath454 .",
    "the idea at the @xmath452-th step is to cut from @xmath255 the edges intersected by @xmath455 ( that is , the set @xmath456 ) .",
    "we could then to draw these edges into the embedded graph @xmath252 along the route determined by a @xmath455-switching ear of length @xmath259 in @xmath255 .",
    "this would result in at most @xmath457 new crossings in @xmath252 ( similarly as in figure  [ fig : addedges ] ) . for technical reasons , we consider routing the edges of each @xmath456 in one bunch ( i.e. , along the same route ) , even though routing every edge separately could perhaps save a small number of crossings .    in reality , the situation is not as simple as in the previous sketch .",
    "the main complication comes from the fact that subsequent cutting ( step @xmath458 ) could `` destroy '' the chosen route for @xmath456 ( or at least part of it )",
    ". then it would be necessary to perform a further re - routing for the edges of @xmath456 in step @xmath278 .",
    "this could essentially happen in each subsequent step until the end of the process ( when obtaining planar @xmath459 ) .",
    "we handle this complication in two ways : proof - wise , we track a possible insertion route ( and its necessary modifications ) for @xmath456 through the full cutting process . in particular , we show that the final insertion route is never longer than @xmath460 , for each index @xmath452 .",
    "another detail one has to take care of , is to ensure that such a detour for @xmath456 would not produce significantly more additional crossings than @xmath461 , over all @xmath462 ; this holds as long as @xmath463 is never much smaller than @xmath464 ( cf .",
    "lemma  [ lem : dew2 ] ) .",
    "algorithmically , we will reinsert all edges @xmath465 only at the very end , into @xmath459 .",
    "the previously tracked routes are then upper bounds for the so - achieved solution .    in the proof",
    ", we briefly use the concept of an _ angle _ of a pair of edges in an embedded graph . for this",
    ", we recall that the _ rotation _ of a vertex @xmath73 in an embedded graph is the ( say , counterclockwise , by convention ) cyclic order in which the edges incident with @xmath73 leave this vertex .",
    "suppose now that the rotation of a degree-@xmath466 vertex is @xmath467 , and let @xmath468 be an ordered pair .",
    "then the _ angle _ of @xmath468 is the set of edges @xmath469 ( with indices read modulo @xmath466 ) .",
    "as outlined in the sketch above , we proceed in @xmath37 steps . at the @xmath452-th step , for @xmath470 , we take the embedded graph @xmath255 and cut the surface open along @xmath455 , thus severing the edges in the set @xmath471 .",
    "this decreases the genus by one , and creates two holes , which we repair by pasting a closed disc on each hole .",
    "thus we get the graph @xmath252 embedded in a compact surface with no holes .",
    "[ cl : sumell ] let @xmath472 , and let @xmath473 be an edge in @xmath456 . then , @xmath473 can be drawn into the plane graph @xmath459 with at most @xmath474 crossings .",
    "let @xmath475 be fixed .",
    "in the graph @xmath252 , we let @xmath476 denote the two new faces created by cutting @xmath255 along @xmath455 ( thus each of these faces contains one of the pasted closed discs ) .",
    "let @xmath473 be an edge in @xmath456 , with endpoints @xmath477 ( incident with @xmath478 in @xmath252 ) and @xmath479 ( incident with @xmath480 in @xmath252 ) .    for each @xmath481",
    ", we associate two faces @xmath482 of @xmath483 with @xmath473 . loosely speaking , these faces are the natural heirs in @xmath483 of the faces @xmath478 and @xmath480",
    ", if we stand in @xmath483 on the vertices @xmath477 and @xmath479 ( we note that @xmath476 are faces in @xmath252 , but by the further cutting process , they may not be faces in @xmath483 for some @xmath484 ) .",
    "the faces @xmath482 are recursively defined as follows .",
    "first , let @xmath485 and @xmath486",
    ". now suppose @xmath487 have been defined for some @xmath278 , @xmath488 .",
    "we then let @xmath489 be the unique face @xmath490 of @xmath483 that satisfies the following : if @xmath491 is the pair of edges of @xmath490 incident with @xmath477 , ordered so that the angle of @xmath491 in @xmath492 consists only of @xmath493 and @xmath494 , then the angle of @xmath491 in @xmath495 includes the edges of the face @xmath496 that are incident with @xmath477 .",
    "the face @xmath497 is defined analogously .",
    "the vertex @xmath477 ( respectively , @xmath479 ) is incident to the face @xmath498 ( respectively , @xmath499 ) in the plane embedding @xmath459 .",
    "to finish the proof , it suffices to show that the dual distance between @xmath498 and @xmath499 in @xmath459 is at most @xmath474 .",
    "we prove this via induction over @xmath500 , i.e. , we show that the dual distance between @xmath489 and @xmath497 in @xmath483 is at most @xmath501 .",
    "this holds ( with equality ) for @xmath502 by the definition of @xmath259 . for @xmath458 ,",
    "take a shortest dual path @xmath503 in @xmath495 connecting @xmath496 to @xmath504 . unless @xmath503 intersects @xmath505 ,",
    "its length also bounds the dual distance in @xmath483 .",
    "assuming @xmath506 in @xmath495 , we can replace ( in @xmath483 ) the section of @xmath503 between the first and the last intersection with @xmath505 by a @xmath505-switching ear of length @xmath507 .",
    "it follows that the dual distance between @xmath489 and @xmath497 is at most @xmath508 , as claimed .",
    "now recall that @xmath509 , for @xmath472 . from claim  [ cl : sumell ]",
    "it follows that the edges in @xmath456 can be added to the plane embedding @xmath459 by introducing at most @xmath510 crossings with the edges of @xmath459 .",
    "this measure disregards any additionally crossings arising between edges of @xmath456 .",
    "we add to @xmath459 the edges of @xmath511 , then the edges of @xmath512 , and so on .",
    "as we add the edges of @xmath456 , in the worst case scenario each edge we add crosses every edge already or currently inserted ; thus the total cost of adding the edges of @xmath456 is at most @xmath513 .",
    "overall , the edges @xmath514 can be added to the plane embedding by introducing at most @xmath515 crossings . using that @xmath516 ( cf .",
    "lemma  [ lem : kl2 ] ) , this process yields a drawing of @xmath0 in the plane with at most @xmath517 crossings .",
    "the inductive application of lemma  [ lem : dew2 ] yields @xmath518 for all @xmath519 .",
    "therefore @xmath520    we have thus shown how to produce a drawing of @xmath0 with at most @xmath521 crossings .",
    "it remains to show how such a drawing can be computed efficiently from an embedding of @xmath0 in @xmath36 .",
    "the algorithm runs two phases :    1 .",
    "a good planarizing sequence @xmath260 for @xmath62 is computed using @xmath37 calls to the @xmath263 algorithm of kutz  @xcite , which finds a cycle witnessing nonseparating edge - width in orientable surfaces . during the computation ,",
    "we represent @xmath62 by its rotation scheme which allows fast implementation of the cutting operation as well .",
    "2 .   in the planar graph @xmath459 ,",
    "optimal insertion routes are found for all the missing edges @xmath522 using linear - time breadth - first search in @xmath523 .",
    "a key observation is that we are looking for these insertion routes only between predefined pairs of faces @xmath498 and @xmath499 for each @xmath524 .",
    "since each of @xmath525 and @xmath526 has at most @xmath527 elements for each @xmath470 , it follows that we need to perform at most @xmath528 searches in total ( independently of @xmath529 ) , a process that takes an overall linear time for fixed  @xmath37 . from the practical point of view",
    ", it may be worthwhile to mention that @xmath530 also serves as a natural upper bound for the considered faces .    in view of this , the overall runtime of the algorithm is @xmath531 for each fixed @xmath37 .",
    "in this section , we establish several basic properties on the stretch of an embedded graph .",
    "even though we could have alternatively included these in the next section , as we only require them in the proof of lemma  [ lem : kl - to - stretch ] , we prefer to present them in a separate section , for an easier further reference of the basic properties of this new parameter which may be of independent interest .",
    "we recall that a graph property @xmath532 satisfies the _ @xmath158-path condition _",
    "* section  4.3 ) ) if the following holds : let @xmath533 be a _",
    "theta graph _",
    "( a union of three internally disjoint paths with common endpoints ) such that two of the three cycles of @xmath533 do not possess @xmath532 ; then neither does the third cycle . in the proof of the following lemma we make use of halfedges .",
    "a _ halfedge _ is a pair @xmath534 ( `` @xmath493 at @xmath73 '' ) , where @xmath493 is an edge and @xmath73 is one of the two ends of @xmath493 .",
    "[ lem:3pp ] let @xmath0 be embedded on an orientable surface , and let @xmath68 be a cycle of @xmath0 .",
    "the set of cycles of @xmath0 satisfies the @xmath158-path condition for the property of odd - leaping @xmath68 .",
    "furthermore , not all three cycles in any theta subgraph of @xmath0 can be odd - leaping @xmath68 .",
    "let a theta graph @xmath535 be formed by three paths @xmath536 connecting the vertices @xmath537 in @xmath0 .",
    "we consider a connected component @xmath177 of @xmath538 . if @xmath539 or @xmath540 , then the @xmath158-path condition trivially holds . otherwise , @xmath177 is a path with ends @xmath541 in @xmath0 .",
    "we denote by @xmath542 the edges in @xmath543 incident with @xmath541 , respectively , and by @xmath544 the union of @xmath177 and the halfedges @xmath545 and @xmath546 .",
    "we show that the number @xmath21 of leaps of @xmath544 summed over all three cycles in @xmath533 is always even .    if @xmath547 for @xmath548 , then contracting the edge of @xmath177 incident to @xmath549 clearly does not change the number  @xmath21 . iteratively applying this argument",
    ", we can assume that finally either ( i ) @xmath550 ( and possibly @xmath551 ) , or ( ii ) @xmath552 , @xmath553 , and @xmath554 . in case ( i ) ,",
    "@xmath544 leaps either none or two of the cycles of @xmath533 in the single vertex @xmath555 , and so @xmath556 .",
    "thus we assume for the rest of the proof that ( ii ) holds .    for @xmath135 ,",
    "let @xmath557 ( respectively , @xmath558 ) be the edge of @xmath559 incident with @xmath560 ( respectively , @xmath379 ) . by relabeling @xmath561",
    "if needed , we may assume that the rotation around @xmath560 is one of the cyclic permutations @xmath562 or @xmath563 .",
    "the rotation around @xmath379 could be any of the six cyclic permutations of @xmath564 .",
    "this yields a total of twelve possibilities to explore .",
    "a routine analysis shows that in every case we get @xmath556 , except for the case in which the rotation around @xmath560 is @xmath563 and the rotation around @xmath379 is @xmath565 ; in this case , @xmath544 leaps twice the cycle @xmath566 , and @xmath567 .",
    "altogether , the number of leaps of @xmath68 summed over all three cycles in @xmath533 is even .",
    "hence the number of cycles of @xmath533 which are odd - leaping with @xmath68 is also even , and the @xmath158-path condition follows .",
    "the next claim shows that stretch ( definition  [ def : stretch ] ) could have been equivalently defined as an _ odd - stretch _ , using pairs of odd - leaping cycles instead of one - leaping cycles .",
    "[ lem : odd - stretch ] let @xmath0 be a graph embedded in an orientable surface . if @xmath568 is an odd - leaping pair of cycles in @xmath0 , then @xmath569 .",
    "we choose an odd - leaping pair @xmath568 that minimizes @xmath570 . up to symmetry , @xmath571 .",
    "since @xmath572 , there is a set @xmath573 of pairwise edge - disjoint @xmath68-ears in @xmath110 , such that @xmath574 . by a simple parity argument , there exists a @xmath68-switching ear in @xmath575 . hence if @xmath576 , then @xmath568 are one - leaping , and the lemma immediately follows .    if more than one @xmath68-ear in @xmath575 is switching , then we pick , say , @xmath117 as the shorter of these . by the choice of @xmath110 we have @xmath577 , and so by lemma  [ lem : thstr ] we have @xmath578 as required .    in the remaining case , we have that @xmath579 and exactly one @xmath68-ear in @xmath575 ( say @xmath117 ) is switching .",
    "we pick any @xmath580 , @xmath581 , let @xmath582 be the ends of @xmath294 on @xmath68 , and compare the distance @xmath466 between @xmath583 and @xmath73 on @xmath68 with @xmath584 . if @xmath585 , then both cycles of @xmath586 containing @xmath294 are shorter than @xmath587 , and one of them is odd - leaping with @xmath110 by lemma  [ lem:3pp ] .",
    "this contradicts the choice of  @xmath68 ( for the pair @xmath568 , that is ) .",
    "hence @xmath588 , and summing these inequalities over all @xmath589 we get @xmath590 , where @xmath560 is the distance between the ends of @xmath117 on @xmath68 .",
    "similarly as in lemma  [ lem : thstr ] , we then get @xmath591    [ lem : cutdew ] let @xmath4 be a graph embedded in an orientable surface of genus @xmath120 , and let @xmath592 be a one - leaping pair of cycles witnessing the stretch of @xmath4 , such that @xmath593",
    ". then @xmath594 .",
    "let @xmath68 be a nonseparating cycle in @xmath595 of length @xmath596 .",
    "if its lift @xmath597 is a cycle again , then ( since @xmath597 is nonseparating in @xmath4 ) @xmath598 , and we are done .",
    "thus we may assume that @xmath597 contains an @xmath154-ear @xmath599 such that @xmath600 is a theta graph .",
    "let @xmath601 be the subpaths into which the ends of @xmath106 divide @xmath154 . by lemma  [ lem:3pp ] , exactly two of the three cycles of @xmath600 are odd - leaping with @xmath99 .",
    "one of these cycles is @xmath154 ; let the other one , without loss of generality , be @xmath602 . then @xmath603 using lemma  [ lem : odd - stretch ] , and so @xmath604",
    "furthermore , @xmath605 is nonseparating in @xmath4 , and we conclude that @xmath606    at this point , an attentive reader may wonder why we do not use the cutting paradigm as in lemma  [ lem : cutdew ] in a good planarizing sequence for theorem  [ thm : upper - cr ] ( section  [ sec : drawing - upper ] ) .",
    "indeed , it would seem that the same proof as in section  [ sec : drawing - upper ] works in this new setting , and the added benefit would be an immediately matching lower bound in the form provided by corollary  [ cor : agrid - all ] .",
    "the caveat is that the proof of theorem  [ thm : upper - cr ] strongly uses the fact that subsequent cuts in a planarizing sequence do not involve _ much fewer _ edges ( recall `` @xmath518 for all @xmath519 '' from the proof ) .",
    "if one cuts along the shortest cycle of a pair that witnesses the dual stretch , then the number of cut edges may jump up or down arbitrarily .",
    "thus an attempted proof along the lines of the proof we gave in section  [ sec : drawing - upper ] would ( inevitably ? ) fail at this point .",
    "in this section we prove lemma  [ lem : kl - to - stretch ] .",
    "therefore , we need to generalize the concepts of switching and leaping . given an embedded graph @xmath4 and an embedded subgraph @xmath607 , we want to talk about @xmath110-switching ears , and walks that are @xmath140-leaping @xmath110 , also in cases when @xmath110 is a not necessarily a cycle .",
    "the essential property of a cycle used in these definitions is that it has two clearly defined sides .",
    "we generalize this feature ( to subgraphs that are not necessarily cycles ) to a property we call _",
    "polarity_.      let @xmath4 be a graph cellularly embedded in a surface @xmath2 , and let @xmath110 be a ( not necessarily connected ) subgraph of @xmath4 .",
    "the _ @xmath4-induced _ embedding @xmath608 of the graph @xmath110 is determined by the system of @xmath4-rotations around vertices of @xmath110 restricted to @xmath609 .",
    "intuitively , @xmath608 is obtained from the usual subembedding of @xmath110 in @xmath2 via replacing all non - cellular faces with discs .",
    "notice that @xmath608 has a separate surface for each connected component of  @xmath110 .",
    "if @xmath608 can be face - bicolored , then we say that @xmath110 is _ bipolar in @xmath4 _ , and we associate one chosen facial bicoloring of @xmath608 with  @xmath110 ( notice that this bicoloring is not unique when @xmath110 is not connected )",
    ". we will refer to the facial colors of @xmath608 ( white and black ) as the _",
    "@xmath110-polarities _ in @xmath4 ( positive and negative , respectively ) .",
    "more formally , for @xmath610 and @xmath611 , the halfedge @xmath534 has a _ positive _ ( _ negative _ ) @xmath110-polarity if the position of @xmath493 in the @xmath4-rotation around @xmath73 is between consecutive edges of a white ( black ) @xmath608-face .",
    "clearly , a cycle in any orientable embedding is always bipolar .",
    "also , if @xmath110 is bipolar , then it is eulerian .",
    "a @xmath110-ear @xmath106 is _ @xmath110-polarity switching _ if the halfedges of @xmath106 incident with the ends of @xmath106 are of distinct @xmath110-polarities .",
    "if @xmath110 is a cycle , then being `` @xmath110-polarity switching '' is equivalent to being `` @xmath110-switching '' .",
    "we now consider a ( possibly closed ) walk @xmath612 .",
    "a proper subwalk @xmath177 of @xmath613 is called a _",
    "polarity leap ( of @xmath613 and @xmath110 ) _ if    * @xmath614 and neither the edge @xmath615 preceding @xmath177 in @xmath613 nor the edge @xmath616 succeeding @xmath177 in @xmath613 belong to @xmath110 ( in particular , @xmath177 is neither a prefix nor a suffix of @xmath613 ) , and * the halfedges of @xmath617 incident with @xmath177 are of distinct @xmath110-polarities .",
    "we say that @xmath613 is _ odd - leaping _",
    "bipolar @xmath110 if the number of all proper subwalks of @xmath613 which are polarity leaps is odd ; otherwise @xmath613 is _ even - leaping _ @xmath110 .",
    "notice that being `` one - leaping '' ( definition  [ def : leaping ] ) implies `` odd - leaping '' in this new sense .      informally speaking , the intuition behind our proof of lemma  [ lem : kl - to - stretch ] is to suitably cut down the embedding @xmath0 to a smaller surface ( destroying handles causing small stretch ; remember our aim is to find a subgraph with large stretch ) , while approximately preserving @xmath79 and its switching distance .",
    "the main tool behind the proof of lemma  [ lem : kl - to - stretch ] is the following lemma . to make sense of this statement , and to grasp how this easily leads to the proof of lemma  [ lem : kl - to - stretch ]",
    ", we refer the reader to the informal discussion provided immediately after the statement .",
    "[ lem : cutstep ] let @xmath4 be a graph embedded in an orientable surface .",
    "suppose that :    * there is a bipolar dual subgraph @xmath416 in @xmath268 ; * there exists a closed walk in @xmath268 that is odd - leaping @xmath416 ; and * the shortest @xmath416-polarity switching ear in @xmath268 has length @xmath490 .",
    "let @xmath142 be a one - leaping pair ( any one ) of dual cycles in @xmath268 such that @xmath618 and @xmath619 . then ,",
    "unless ( d ) @xmath620 , the following hold :    * there is a bipolar dual subgraph @xmath421 ( `` induced '' by @xmath416 ) in @xmath621 ; * there exists a closed walk in @xmath621 that is odd - leaping @xmath421 ; and * the shortest @xmath421-polarity switching ear in @xmath621 has length @xmath622 .    conditions ( a ) and ( a ) address the `` preservation of @xmath79 '' requisite from lemma  [ lem : kl - to - stretch ] , and ( c),(c ) address the necessarily long `` switching distance '' . conditions ( b ) and ( b ) have a purely technical purpose .",
    "notice , for instance , that if ( b ) is true , then the embedding @xmath4 is not planar ( and so the stretch of @xmath4 is well defined ) .",
    "indeed , a closed walk odd - leaping a bipolar plane @xmath416 can not exist since such a @xmath416 would equal its @xmath268-induced embedding  @xmath623 , which means that @xmath416 is face - bicolored , too ; a simple parity argument then gives a contradiction . for a similar parity reason , ( b ) implies that a @xmath416-polarity switching ear in @xmath268 ( implicitly required in ( c ) ) must exist . moreover , as we proceed in the cutting process , the non - planarity implied by ( b ) guarantees that we will eventually arrive at the desired exceptional conclusion ( d ) @xmath620 , which is the ultimately desired outcome for lemma  [ lem : cutstep ] .",
    "recall the definition of cutting an embedding @xmath4 along a dual cycle @xmath147 .",
    "the dual graph @xmath624 is obtained from @xmath268 by successive contractions of all the dual edges in @xmath625 into one dual vertex  @xmath478 , and then `` splitting '' @xmath478 into two @xmath626 ( giving the two @xmath147-cut faces of @xmath627 ) .",
    "this `` stepwise contraction '' perspective of cutting turns out to be very useful in our proof .",
    "_ proof of ( a)_. let @xmath428 denote the subgraph of @xmath628 induced by the edges in @xmath629 . if @xmath630 , then clearly ( d ) @xmath620 , and so we may assume that @xmath428 is nonempty . we show that we can choose @xmath631 , under the assumption that @xmath147 contains a @xmath416-polarity switching ear ( the validity of this assumption follows since , if no such switching ear existed , then by ( c ) it would follow that @xmath632 , thus implying ( d ) ) .",
    "the following is immediate from the definition of bipolarity :    [ facta ] if @xmath633 is not a loop - edge and not a @xmath416-polarity switching ear , then the dual graph @xmath634 ( obtained by _ contraction _ of @xmath473 ) is embedded in the same surface as @xmath268 , and the dual subgraph @xmath635 induced by @xmath636 in @xmath637 is bipolar again , where the @xmath635-polarities are naturally inherited from the @xmath416-polarities .",
    "since we assume that @xmath147 contains no @xmath416-polarity switching ear , we can iteratively apply fact  [ facta ] to all edges of @xmath147 except some ( the last one ) @xmath638 . in this way we get an `` intermediate '' embedding @xmath639 such that @xmath616 is a nonseparating dual loop - edge in @xmath628 , and bipolar @xmath640",
    "is naturally derived from @xmath416 .",
    "let @xmath478 be the face of @xmath641 that is the double end of @xmath616 , and let the @xmath628-rotation of edges around @xmath478 be @xmath642 .",
    "the last step in the construction of @xmath628 ( and of @xmath428 ) is to remove @xmath616 and split @xmath478 into @xmath626 such that the @xmath628-rotation around @xmath643 ( respectively , @xmath644 ) is @xmath645 ( respectively , @xmath646 ) .",
    "clearly , @xmath647 stays bipolar in @xmath628 if @xmath648 , and so we assume @xmath649 .",
    "let @xmath650 denote the @xmath628-induced embedding of @xmath428 .",
    "let @xmath651 and @xmath652 be the first and last element of the list @xmath653 , respectively , that are also edges of @xmath428 . note that both ends of @xmath616 in the @xmath628-rotation around @xmath478 are between @xmath652 and @xmath651 .",
    "then , @xmath654 appear consecutively on a unique face @xmath339 of @xmath650 .",
    "analogously , we find a face @xmath655 at  @xmath644 in @xmath650 .",
    "loosely speaking , @xmath656 are the dual @xmath650-faces `` inheriting '' the two @xmath628-faces incident with @xmath616 .",
    "if @xmath657 , then both halfedges of @xmath616 are of the same @xmath658-polarity ( by our assumption on @xmath147 ) , say positive .",
    "hence both @xmath650-faces @xmath339 and @xmath655 will get ( consistently ) positive polarity , and so @xmath428 is bipolar in  @xmath628 . if , on the other hand , @xmath659 , then one of the two faces incident with @xmath616 in the @xmath628-induced embedding @xmath660 of @xmath658 is positive , say the one containing edge(s ) from @xmath645 , and the other one is negative . then the @xmath650-face @xmath339 will be ( consistently ) positive and @xmath655 negative .",
    "thus also in this case @xmath661 is bipolar in  @xmath628 .",
    "_ proof of ( b)_. as in ( a ) , we may assume that @xmath147 contains no @xmath416-polarity switching ear .",
    "we can make a similar assumption with @xmath148 : if there is a @xmath416-polarity switching ear contained in @xmath148 , then @xmath620 ( that is , ( d ) holds ) .",
    "the following counterpart of fact  [ facta ] , formulated for any closed dual walk @xmath662 in @xmath268 , is easily derived from our definition of a leap .",
    "[ factb ] suppose @xmath633 is not a loop - edge and not a @xmath416-polarity switching ear , and denote by @xmath635 , @xmath663 the dual subgraphs induced by @xmath636 and @xmath664 in @xmath634 ( i.e. , after contraction of @xmath473 ) .",
    "then the number of leaps of @xmath635 and @xmath663 in @xmath634 is the same as the number of leaps of @xmath416 and @xmath662 in  @xmath268 , with an exception when @xmath665 and both ends of @xmath473 are incident with leaps of @xmath416 and @xmath662 in  @xmath268 ( in which case the two leaps vanish in @xmath634 ) .",
    "we now proceed in the same way as in ( a ) , and use the same notation @xmath666 @xmath667 @xmath658 , etc .",
    "let @xmath668 be a dual closed walk in @xmath268 odd - leaping @xmath416 , and @xmath669 , @xmath670 denote the dual closed walks in @xmath628 induced by @xmath671 and @xmath672 . by an iterative application of fact  [ factb ] to all edges in @xmath673 , we get that the parity of leaping between @xmath416 and @xmath668 ( respectively",
    ", @xmath416 and @xmath148 ) in @xmath268 is the same as that between @xmath658 and  @xmath669 ( respectively , @xmath658 and @xmath670 ) in @xmath628 .",
    "hence @xmath669 is odd - leaping @xmath658 , and @xmath670 is even - leaping @xmath658 , since @xmath148 contains no @xmath416-polarity switching ear in @xmath268 and so @xmath148 is not odd - leaping @xmath416 .",
    "we note that @xmath674 since @xmath147 intersects @xmath148 , and recall @xmath675 . if @xmath676 , then we moreover remove @xmath616 from @xmath669 ; this does not change the parity of leaping between @xmath658 and @xmath669 .",
    "we say that the dual walk @xmath669 _ passes through _ @xmath478 in @xmath628 if one edge of @xmath669 is from @xmath645 and the next edge of @xmath669 is among @xmath646 , or vice versa . every time @xmath669 passes through @xmath478",
    ", we replace this pass by one iteration of the cycle @xmath670 .",
    "the resulting closed dual walk @xmath677 in @xmath628 ( which does not pass through @xmath478 ) is again odd - leaping @xmath658 , since @xmath670 is even - leaping  @xmath658 .",
    "then , the subgraph @xmath678 induced by @xmath679 in the graph @xmath628 is a closed dual walk odd - leaping @xmath661 .",
    "_ proof of ( c)_. let @xmath680 be a @xmath421-polarity switching ear in @xmath628 of length  @xmath681 . if @xmath682 contains both @xmath147-cut faces @xmath626 , then the lift @xmath683 of a subpath @xmath684 between @xmath643 and @xmath644 is a @xmath416-polarity switching ear , and hence @xmath685 , thus implying ( c ) . otherwise , the lift @xmath686 in @xmath268 is an @xmath687-ear which means that , for some subpath @xmath688 of length at most @xmath689 ( possibly empty ) , @xmath690 is a @xmath416-ear .",
    "since @xmath680 is @xmath421-polarity switching in @xmath628 , and the @xmath421-polarities are inherited from those of @xmath416 in @xmath268 by ( a ) and fact  [ facta ] , we conclude that @xmath690 is a @xmath416-polarity switching ear .",
    "therefore , @xmath691 as claimed .",
    "we proceed by induction , using lemma  [ lem : cutstep ] .",
    "notice that all the conditions ( a),(b),(c ) of lemma  [ lem : cutstep ] are satisfied by the graph @xmath4 , its bipolar dual cycle @xmath692 , and by @xmath693 .",
    "let @xmath694 , @xmath695 , and @xmath696 . until we reach the condition ( d ) @xmath620",
    ", we repeatedly apply lemma  [ lem : cutstep ] for @xmath697 to @xmath698 and @xmath699 , obtaining @xmath700 and @xmath701 . after the maximum possible number @xmath452 of iterations",
    "in which ( d ) does not hold :    * the graph @xmath702 has genus @xmath703 , and it is @xmath704 since ( b ) implies nonplanarity of @xmath702 ; * the nonseparating dual edge - width is @xmath705 ( this follows by iterating lemma  [ lem : cutdew ] @xmath452 times ) ; and * the shortest @xmath455-polarity switching ear in @xmath706 has length at least @xmath707 , since one can iterate @xmath708 at each of the @xmath452 steps .    hence ( as no further iteration is possible ) , we have gotten an @xmath704 such that ( cf .",
    "lemma  [ lem : cutstep ] ) there exists a pair of odd - leaping dual cycles @xmath709 in @xmath706 such that @xmath710 , and ( d ) @xmath711 holds .",
    "consequently , @xmath712 by setting @xmath713 for @xmath714 , lemma  [ lem : kl - to - stretch ] follows .",
    "there are several natural questions that arise",
    ".      one can wonder whether our results , namely about approximating planar crossing number of an embedded graph , can also be extended to nonorientable surfaces of higher genus .",
    "indeed , the upper - bound result of @xcite holds for any surface , and there is an algorithm to approximate the crossing number for graphs embeddable in the projective plane  @xcite .",
    "we currently do not see any reason why such an extension would be impossible .",
    "however , the individual steps become much more difficult to analyze and tie together , since the `` cheapest '' cut through the embedding can cut ( a ) a handle along a two - sided loop , ( b ) an antihandle along a two - sided loop , or ( c ) a crosscap along a one - sided loop . hence it then does not suffice to consider toroidal grids as the sole base case ( and a usable definition of `` nonorientable stretch '' should reflect this ) , but the lower bound may also arise from a projective or klein - bottle grid minor . already for the latter , there are currently no non - trivial results known .",
    "we thus leave this direction for future investigation .",
    "[ [ dependency - of - the - constants - in - theoremthmmain - overview - on - delta - and - g . ] ] dependency of the constants in theorem  [ thm : main - overview ] on @xmath43 and @xmath37 .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    taking a toroidal grid with sufficiently multiplied parallel edges ( possibly subdividing them to obtain a simple graph ) easily shows that a relation between the toroidal expanse and the crossing number must involve a factor of @xmath715 . regarding an efficient approximation algorithm for the crossing number , general dependency on the maximum degree seems unavoidable as well , as is suggested by comparison with related algorithmic results .",
    "however , considering the so - called minor crossing number ( see section  [ sec : minorcr ] below ) , one can avoid this dependency at least in a special case .",
    "the exponential dependency of the constants and the approximation ratio on @xmath37 , on the other hand , is very interesting .",
    "it pops up independently in multiple places within the proofs , and these occurrences seem unavoidable on a local scale , when considering each inductive step independently .",
    "however , it seems very hard to construct any example where such an exponential jump or decrease can actually be observed .",
    "it might be that a different approach with a global view can reduce the dependency in theorem  [ thm : main - overview ] to some @xmath716 factor , cf . also  @xcite .",
    "[ sec : minorcr ] the _ minor crossing number _",
    "@xmath717  @xcite is the smallest crossing number over all graphs @xmath4 that have @xmath0 as their minor .",
    "hence it is , by definition and in contrast to the traditional crossing number , a well - behaved minor - monotone parameter . in general , however , minor crossing number is not any easier to compute  @xcite than ordinary crossing number .",
    "we note the following intuitive observation related to our topic : if @xmath0 is embedded in @xmath2 with face - width  @xmath3 , then @xmath0 is a surface minor of a graph  @xmath4 ( in particular , @xmath4 is embedded in @xmath2 as well ) such that @xmath718 . indeed , consider a loop @xmath719 in @xmath2 attaining @xmath1 and split every vertex intersected by @xmath719 into an edge `` perpendicular '' to @xmath719 .",
    "this results in desired @xmath4 ( for formal details , see the proof of lemma  [ lem : cr - fstretch - torus ] ) .    for an embedded graph @xmath0 ,",
    "let @xmath720 denote the vertex - face incidence ( bipartite ) graph of @xmath0 .",
    "it is well - known that @xmath721 .",
    "we can analogously define the _ face stretch _ of an embedded graph @xmath0 as @xmath722 , and claim :      let @xmath157 be one - leaping cycles of @xmath720 witnessing @xmath724 . when viewing @xmath154 and @xmath99 as simple loops @xmath147 and @xmath148 , respectively , on the surface @xmath2 , they intersect the embedding of @xmath0 only in @xmath725 and @xmath726 vertex points . consider a vertex @xmath73 of @xmath0 intersected by @xmath147 .",
    "we replace @xmath73 in the embedding with two new vertices @xmath727 , where @xmath728 is incident with those edges of @xmath73 on the left - hand side of @xmath147 and @xmath729 with the edges of @xmath73 on the right - hand side of  @xmath147 .",
    "we join @xmath728 to @xmath729 with a new edge ; it is `` perpendicular '' to @xmath147 in the embedding in  @xmath2 ( figure  [ fig : fstr - split ] ) .",
    "let @xmath730 be the new graph having @xmath0 as its minor .",
    "if @xmath73 belongs also to @xmath148 , and there is an edge ( or two ) of @xmath731 in @xmath720 incident to @xmath73 , then we position the corresponding one ( or two ) of  @xmath727 right on this section of @xmath148 close to original  @xmath73 .",
    "so , @xmath148 intersects the embedded graph @xmath730 only in vertex points , as well .",
    "we apply the same construction to the vertices of @xmath730 intersected by @xmath148 , resulting in the desired embedded graph @xmath4 having @xmath0 as its minor .    in @xmath4 , the loop",
    "@xmath147 now intersects exactly @xmath478 edges ( and no vertex ) , while the loop @xmath148 intersects @xmath480 or @xmath732 edges .",
    "the latter case happens when @xmath142 intersect each other in exactly one vertex point @xmath73 of @xmath0 , and hence both @xmath727 belong to @xmath148 in @xmath272 .",
    "( generally , this odd case is unavoidable in the situation illustrated in figure  [ fig : fstr - split ] . ) therefore , up to symmetry between @xmath142 , @xmath4 witnesses that @xmath733 , where @xmath734 .",
    "the next logical step is to translate the findings from section  [ sub : toridalexp ] to the face stretch notion . in the special case of the torus",
    ", this translation in fact makes some things simpler .",
    "consider a graph embedded in the torus @xmath738 .",
    "let @xmath147 be a loop in @xmath738 intersecting @xmath0 only in vertex points .",
    "when cutting along @xmath147 we obtain a cylindrical surface @xmath739 with two borders , corresponding to the former left and right - hand sides of @xmath147 .",
    "we naturally obtain the graph @xmath740 embedded on @xmath739 from @xmath0 by duplicating the vertices @xmath73 cut by @xmath147 along the two borders .",
    "as in the previous proof , each copy of @xmath73 in @xmath740 retains the edges formerly incident to @xmath73 on the respective side of @xmath147 on @xmath738 .",
    "we say that @xmath740 embedded in @xmath739 is obtained by _",
    "cutting @xmath0 along @xmath147_.    [ thm : facegrid - torus ] let @xmath0 be a graph embedded in the torus @xmath738 with @xmath741 .",
    "let @xmath147 be a loop in @xmath738 witnessing the face - width of @xmath0 , and let @xmath740 be a graph embedded in the cylinder @xmath739 , obtained by cutting @xmath0 along @xmath147 . among all pairs of points @xmath742 on the opposite bounderies of @xmath739 ,",
    "let @xmath221 be the least number of points in which a simple arc from @xmath339 to @xmath743 in @xmath739 intersects @xmath740 , not counting @xmath742 themselves . if @xmath744 , then @xmath0 contains a toroidal @xmath745-grid as a minor .",
    "analogously to claim  [ cl : ellcycles ] we prove that @xmath0 has a set of at least @xmath221 pairwise disjoint cycles , all homotopic to @xmath147 in @xmath738 .",
    "then we finish as in the proof of theorem  [ thm : agrid - torus ] , using theorems  [ thm : degs ] and  [ thm : two - cycle - families ] .",
    "the proof is analogous to that of lemma  [ lem : thstr ] , but slightly more complicated .",
    "let @xmath747 be the curve in @xmath739 defining @xmath221 as above , and let @xmath79 denote the corresponding curve back in @xmath0 in @xmath738 .",
    "we can consider @xmath147 and @xmath79 as a cycle and a path , respectively , in the vertex - face incidence graph @xmath720 .",
    "let @xmath748 ( where possibly @xmath749 ) , and let @xmath145 denote the component of @xmath750 having not more intersecting points with the drawing @xmath0 than the other component .",
    "then @xmath751 is a noncontractible loop intersecting @xmath0 in @xmath752 points , as a simple case analysis shows ( observe that , indeed , @xmath753 may be larger than @xmath754 when some of @xmath476 are vertices of @xmath0 ) . in particular , @xmath755 and so @xmath756 and @xmath757",
    "therefore , @xmath147 and @xmath751 define a pair of one - leaping cycles in @xmath720 witnessing @xmath758 .",
    "let @xmath0 , @xmath744 , and @xmath221 be as in theorem  [ thm : facegrid - torus ] .",
    "combining corollary  [ cor : cr - fstretch - torus ] with lemma  [ lem : stretch - kl - torus ] we get @xmath761 .",
    "then , theorem  [ thm : facegrid - torus ] gives @xmath762 and the left - hand side of ( a ) follows .",
    "for the right - hand side , we simply use the fact that @xmath28 is minor monotone and apply corollary  [ cor : crossing - texp ] to the graph witnessing @xmath717 .",
    "for ( b ) we compute the graph @xmath4 from lemma  [ lem : cr - fstretch - torus ] and apply the algorithm of theorem  [ thm : main - overview ] .",
    "the resulting drawing of @xmath4 has at most @xmath763 crossings by the previous , and @xmath764 .",
    "hence the number of crossings in @xmath4 is at most @xmath765 .",
    "obviously , the approximation constants in theorem  [ thm : main - minorcr ] are very rough and can likely be improved a lot . however , the important point is that these constants are independent of the maximum degree .",
    "it is interesting to ask whether theorem  [ thm : main - minorcr ] can be extended to all orientable surfaces analogously to theorem  [ thm : main - overview ] .",
    "although this seems quite plausible , there are complications similar to those seen already in the proofs of lemmas  [ lem : cr - fstretch - torus ] and  [ lem : stretch - kl - torus ] .",
    "consequently , the nice technical properties of stretch presented in section  [ sec : more ] can not be straighforwardly extended to face stretch , and the whole question is left for future research .",
    "our algorithmic technique in section  [ sec : drawing - upper ] starts with a graph on a higher surface , and brings the graph to the plane without introducing too many crossings . as mentioned before , focusing only on surface - operations will inevitably require a certain lower bound on the density of the original embedding .",
    "however , we can naturally combine this algorithm with some other algorithmic results on inserting a _ small _ number of edges into a planar graph , to obtain a polynomial algorithm with essentially the same approximation ratio but without the density requirement .",
    "this combination of algorithms can be sketched as follows :    1 .",
    "as long as the embedding density requirement of theorem  [ thm : main - overview ] is violated , we cut the surface along the violating loops .",
    "let @xmath766 be the set of edges affected by this ; we know that @xmath767 is small , bounded by a function of @xmath37 and @xmath43 .",
    "let @xmath768 .",
    "2 .   by theorem",
    "[ thm : upper - cr ] , applied to @xmath769 , we obtain a suitable set @xmath770 such that @xmath771 is plane .",
    "( @xmath70 is the union of the edge sets corresponding to dual cycles in the considered dual planarizing sequence of  @xmath769 . )",
    "we would like to apply independently @xcite to insert the edges of @xmath180 back to @xmath772 with not many crossings , and theorem  [ thm : upper - cr ] to insert @xmath70 back to @xmath772 .",
    "the number of possible mutual crossing @xmath773 is neglectable , but the real trouble is that @xcite is allowed to change the planar embedding of @xmath772 and hence the insertion routes assumed by theorem  [ thm : upper - cr ] may no longer exist .",
    "fortunately , the number of the insertion routes for @xmath70 is bounded in the genus ( unlike @xmath529 ) , and so the algorithm from @xcite can be adapted to respect these routes without a big impact on its approximation ratio .",
    "unfortunately , turning this simple sketch into a formal proof would not be short , due to the necessity to bring up many fine algorithmic details from @xcite .",
    "that is why we consider another option , allowing short self - contained proof at the expense of giving a weaker approximation guarantee .",
    "we use the following simplified formulation of the main result of @xcite . for a graph @xmath4 and a set of edges @xmath180 with ends in @xmath774 , but @xmath775 , let @xmath776 denote the graph obtained by adding the edges @xmath180 into @xmath4 .",
    "[ thm : apxmei ] let @xmath4 be a connected planar graph with maximum degree  @xmath43 , @xmath180 an edge set with ends in @xmath774 but @xmath777 , and @xmath778 .",
    "there is a polynomial - time algorithm that finds a drawing of @xmath776 in the plane with at most @xmath779 crossings , where @xmath466 is a constant depending only on @xmath43 and @xmath140 . in this drawing , subgraph @xmath4",
    "is drawn planarly , i.e. , all crossings involve at least one edge of @xmath180 .",
    "[ thm : main - nodense ] let @xmath2 be an orientable surface of fixed genus @xmath34 , and let @xmath43 be an integer constant .",
    "assume @xmath0 is a graph of maximum degree @xmath43 embedded in @xmath2 .",
    "there is a polynomial time algorithm that outputs a drawing of @xmath0 in the plane with at most @xmath780 crossings , where @xmath781 is a constant depending on @xmath37 and  @xmath43 .",
    "let @xmath782 be the constants from theorem  [ thm : main - overview ] , depending on @xmath37 and @xmath43 . recall that @xmath45 is nondecreasing in @xmath37 , and",
    "so we may just fix it for the rest of the proof . if @xmath783 , let @xmath79 be the witnessing dual cycle of @xmath0 .",
    "we cut @xmath0 along @xmath79 , and repeat this operation until we arrive at an embedded graph @xmath784 of genus @xmath785 such that @xmath786 ( and hence @xmath787 ) .",
    "let @xmath788 be the affected edges , where @xmath789 is bounded by a constant .",
    "if @xmath790 , then we simply finish by applying theorem  [ thm : apxmei ] .",
    "otherwise , we apply the algorithm of theorem  [ thm : upper - cr ] to @xmath769 , which results in a planar graph @xmath791 and the edge set @xmath792 , such that @xmath70 can be drawn into @xmath772 using at most @xmath793 crossings by theorem  [ thm : main - overview ] . in this resulting drawing of @xmath769",
    "we replace each crossing by a new subdividing vertex .",
    "this gives a planarly embedded graph @xmath794 that contains a planarly embedded subdivision @xmath795 of @xmath772 .",
    "let @xmath796 .",
    "since we clearly may assume that every edge of @xmath70 required at least one crossing in @xmath772 , we have @xmath797 .",
    "now we apply theorem  [ thm : apxmei ] to @xmath798 and @xmath180 ( from the previous paragraph ) .",
    "this gives a drawing @xmath799 of @xmath800 with at most @xmath801 crossings in the plane .",
    "the final task is to put back the edges of @xmath802 into @xmath799 ; note , however , that the planar subdrawing of @xmath795 within @xmath799 is generally different from the original embedding of @xmath795 .",
    "[ cl : edgeback ] suppose @xmath4 is a connected graph embedded in the plane , and @xmath803 are two edges joining vertices of @xmath4 such that @xmath804 is a planar graph . if @xmath493 can be drawn in @xmath4 with @xmath221 crossings , then there is a planar embedding of @xmath804 in which @xmath493 can be drawn with at most @xmath805 crossings .",
    "although @xcite does not explicitly handle the algorithmic aspect of claim  [ cl : edgeback ] , it is easily seen there that the claimed drawing of @xmath806 can be found in polynomial time from the assumed drawing of @xmath807 ( for the algorithm of @xcite , for example , this is a simple special case ) .",
    "let @xmath808 .",
    "by induction on @xmath809 , we apply claim  [ cl : edgeback ] to @xmath810 and @xmath811 , and simultaneously to each @xmath493 from  @xmath180 . as the final result we obtain a planar embedding of @xmath812 . into this @xmath794 , we can draw @xmath180 with at most @xmath813 additional crossings ( compared to the number of crossings achieved by theorem  [ thm : apxmei ] to draw @xmath180 into @xmath769 ) . by turning the vertices of @xmath814 back into edge crossings of @xmath769",
    "this leads to a drawing of @xmath815 with at most @xmath816 crossings where all the remaining terms are constants depending only on @xmath37 and  @xmath43 ."
  ],
  "abstract_text": [
    "<S> we investigate the _ toroidal expanse _ of an embedded graph @xmath0 , that is , the size of the largest toroidal grid contained in @xmath0 as a minor . </S>",
    "<S> in the course of this work we introduce a new embedding density parameter , the _ stretch _ of an embedded graph  @xmath0 , and use it to bound the toroidal expanse from above and from below within a constant factor depending only on the genus and the maximum degree . we also show that these parameters are tightly related to the planar _ crossing number _ of  @xmath0 . as a consequence of our bounds , </S>",
    "<S> we derive an efficient constant factor approximation algorithm for the toroidal expanse and for the crossing number of a surface - embedded graph with bounded maximum degree .    </S>",
    "<S> * keywords : * graph embeddings , compact surfaces , face - width , edge - width , toroidal grid , crossing number , stretch    * ams 2010 subject classification : * 05c10 , 05c62 , 05c83 , 05c85 , 57m15 , 68r10 </S>"
  ]
}