{
  "article_text": [
    "consider some finite classical system which depends on an external parameter , @xmath0 .",
    "for instance , the system might be a lattice of coupled classical spins , and @xmath0 may denote the strength of an externally applied magnetic field ; or , the system might be a gas of particles , and @xmath0 a parameter specifying the volume of a box enclosing the gas .",
    "now suppose that , after allowing the system to come to equilibrium with a heat reservoir at temperature @xmath1 , we change , or `` switch '' , the external parameter , infinitely slowly , from an initial ( say , @xmath2 ) to a final ( @xmath3 ) value .",
    "the system will remain in quasi - static equilibrium with the reservoir throughout the switching process , and the total _ work _ performed on the system will equal the helmholtz free energy difference between the initial and final configurations@xcite : @xmath4 here @xmath5 denotes the equilibrium free energy of the system at temperature @xmath1 , for a fixed value of @xmath0 .",
    "the subscript on @xmath6 reminds us that this result is valid for infinitely slow switching of the parameter .",
    "now , what happens if , after allowing the system and reservoir to equilibrate , we switch the value of @xmath0 at a _",
    "finite _ rate ? in this case",
    "the system will lag behind quasi - static equilibrium with the reservoir , and the total work will depend on the microscopic initial conditions of system and reservoir .",
    "thus , an _ ensemble _ of such switching measurements  each prepared by first allowing the system to equilibrate with the reservoir  will yield a distribution of values of @xmath6 .",
    "let @xmath7 denote this distribution , where @xmath8 is the `` switching time '' over which the value of @xmath0 is changed from 0 to 1 .",
    "( without loss of generality , assume a uniform switching rate : @xmath9 . ) in other words , @xmath10 is the probability that the work performed in switching @xmath0 from 0 to 1 , over a time @xmath8 , will fall between @xmath6 and @xmath11 . in the limit @xmath12 , we get @xmath13 ( eq.[eq : infty ] ) , and so @xmath14 in this limit . for finite @xmath8 , however : ( 1 ) the distribution @xmath15 acquires a finite width , reflecting the fluctuations in @xmath6 from one switching measurement to the next ; and ( 2 ) its centroid shifts to the right : @xmath16 as a result of dissipation ( see fig.[fig : schem])@xcite .",
    "eq.[eq : infty ] gives the free energy difference @xmath17 in terms of the work performed during a single infinite - time ( quasi - static ) process .",
    "by contrast ,",
    "eq.[eq : ineq ] gives an upper bound on @xmath17 , from an ensemble of finite - time ( hence , nonequilibrium ) repetitions of the switching process .",
    "recently@xcite , it was shown that one can in fact extract the value of @xmath17 itself , not just an upper bound , from the information contained in @xmath7 .",
    "specifically , the following result was shown to be valid _ for any switching time _",
    "@xmath8 : @xmath18 where @xmath19 .",
    "this result gives the value of an equilibrium quantity , @xmath17 , in terms of an ensemble of finite - time , nonequilibrium measurements .",
    "as discussed in ref.@xcite and in section [ sec : comp ] below , the inequality @xmath20 , eq.[eq : ineq ] , follows immediately from eq.[eq : iden ] .",
    "eq.[eq : iden ] was derived by treating the system of interest and reservoir , coupled together , as a large , isolated , classical hamiltonian system .",
    "the hamiltonian governing the motion in the full phase space was taken to be a sum of three terms : one for the system of interest ( @xmath21 ) , one for the reservoir , and a final term , @xmath22 , coupling the two .",
    "the magnitude of the interaction term @xmath22 was explicitly assumed to be negligible in comparison with the other two terms . with these assumptions , eq.[eq : iden ] follows from the properties of hamiltonian evolution ( see ref.@xcite for details ) .",
    "the purpose of the present paper is to re - derive the same result within a different framework . instead of considering deterministic evolution in the full phase space  containing both the system of interest and reservoir degrees of freedom  we will treat only the evolution of the system of interest itself , described by a trajectory @xmath23",
    ". this evolution will be stochastic rather than deterministic , and will be governed by a master equation .",
    "we will assume that this stochastic evolution is markovian , and that it satisfies detailed balance .",
    "in presenting this alternative derivation , we are motivated by several factors .",
    "first , master equations are a common tool in statistical physics , therefore it is reassuring to see that eq.[eq : iden ] follows in a natural way from the master equation approach . secondly ,",
    "in this derivation there is no need to explicitly assume weak coupling between system and reservoir , since a reservoir _ per se _ does not enter into the analysis ; given the assumptions stated below , eq.[eq : iden ] is _ identically _ true . finally , one might come away from ref.@xcite with the feeling that that the validity of eq.[eq : iden ] depends directly on the properties of hamiltonian evolution , in particular liouville s theorem .",
    "the treatment herein dispels this notion : hamilton s equations appear nowhere in the derivation .",
    "this point is particularly relevant in the context of numerical simulations , where the evolution of a thermostatted system is often realized with the use of non - hamiltonian equations of motion .",
    "the plan of this paper is as follows . in section [ sec : prelim ]",
    "we establish notation and terminology , and specify precisely our assumptions regarding markovian evolution and detailed balance . in section [ sec : deriv ] we derive our central result . in section",
    "[ sec : examp ] we consider specific examples of stochastic processes for which the result is valid . in section [ sec : comp ] we briefly discuss the possible utility of eq.[eq : iden ] to the numerical computation of free energy differences . in section [ sec : numres ]",
    "we illustrate our central result with numerical simulations , and we conclude with a few remarks in section [ sec : sum ] .",
    "two appendices provide derivations of results used in the main text .",
    "we begin by specifying precisely what we mean by the terms _ work _ and _ free energy _ throughout this paper .",
    "we assume that there exists a phase space of variables ( e.g.  the positions and momenta of constituent particles ) , such that the instantaneous microscopic state of our system is completely described by the values of these variables .",
    "let * z * denote a point in this phase space .",
    "the evolution of our system with time is then described by a trajectory @xmath23 .",
    "the kind of evolution which will most interest us is not the evolution of an isolated system , but rather that of a system in contact with a heat bath .",
    "hence the trajectory @xmath23 will in general be _",
    "stochastic _ , reflecting the `` random '' influence of the heat bath .    next ,",
    "assume the existence of a parameter - dependent hamiltonian @xmath24 .",
    "the hamiltonian is just a function which , for a fixed value of @xmath0 , gives the total energy of the system of interest , in terms of its instantaneous state ( * z * ) .",
    "the value of @xmath0 thus parametrizes the external forces acting on the system ( arising from , e.g. , external fields , confining potentials , etc . )",
    "when the system is isolated , @xmath21 happens to generate the time evolution of the system , through hamilton s equations , but we will not make use of this property in deriving our central result .    given @xmath24 , we now define    [ eq : fdef ] @xmath25    where @xmath26 is a real , positive constant .",
    "( we are being a bit cavalier with units here : @xmath27 should be divided by a constant to make it dimensionless .",
    "however , since this constant only shifts the value of @xmath5 by a fixed amount , and therefore does not affect the free energy difference @xmath28 , we ignore it . )",
    "@xmath29 and @xmath30 are of course the _ partition function _ and _ free energy _ of the system , respectively , and @xmath31 is the temperature , in units of energy ( @xmath32 ) . however , in following the derivation presented below , it may be most convenient to view these quantities abstractly , rather than in connection with their physical significance : @xmath26 is just some positive constant , and @xmath29 and @xmath30 are the functions of @xmath26 defined by eq.[eq : fdef ] . in what follows , we will never compare free energies or partition functions at different temperatures , hence the dependence of @xmath5 and @xmath27 on @xmath26 will be left implicit",
    ".    the central quantity of interest in this paper will be the free energy difference @xmath33 , for a fixed value of @xmath26 .",
    "as mentioned , the time evolution of the system of interest is described entirely by a ( stochastic ) phase space trajectory @xmath23 .",
    "in general , this evolution will depend on the externally imposed time - dependence of @xmath0 , describing the changing external fields to which the system is subject . let us consider the evolution of the system from an initial time , @xmath34 , to a final time , @xmath35 , over which the value of @xmath0 is `` switched '' from 0 to 1 at a uniform rate : @xmath36 . given this time - dependence of @xmath0 , and given the trajectory @xmath23 describing the evolution of the system , the total _ work _ performed on the system",
    "is the time integral of @xmath37 along the trajectory : @xmath38 where @xmath39 . for the evolution of an isolated hamiltonian system",
    ", this reduces to @xmath40 , by hamilton s equations ; in this case the work performed on the system is just the change in its energy . for a system in contact with a heat bath , however , this no longer holds , since there is a constant exchange of energy with the bath .",
    "we will assume that the evolution of our system in phase space is a _",
    "markov process_@xcite .",
    "this means that the stochastic evolution @xmath23 is entirely characterized by the transition probability function @xmath41 .",
    "this gives the probability distribution for finding the system in a state * z * at time @xmath42 , given that at an earlier time @xmath43 it was known to be at @xmath44 . taking the derivative of @xmath45 with respect to @xmath46 and evaluating at @xmath47",
    ", we get a function @xmath48 which gives the instantaneous transition rate from @xmath44 to * z * , at time @xmath43 .",
    "the dependence of @xmath49 on time arises through whatever external parameters of the system and reservoir are available and time - dependent . in our case",
    "we assume only one such parameter , @xmath0  characterizing external forces  therefore we write @xmath50 in other words , the instantaneous transition rate @xmath49 from @xmath44 to * z * depends on @xmath43 only through the value of @xmath51 .",
    "let us now shift our focus from the description of a single system , to that of an _ ensemble _ of systems , each evolving according to the stochastic markov process just described .",
    "this ensemble represents infinitely many independent realizations of the switching process .",
    "if @xmath52 denotes the time - dependent distribution of this ensemble in phase space , then this distribution obeys    [ eq : mast ] @xmath53 where @xmath54 .",
    "we will abbreviate this as @xmath55    where @xmath56 is a linear operator acting on the space of phase space densities @xmath57 .",
    "eq.[eq : mast ] is our master equation ; when the time - dependence of @xmath0 is known , and an initial distribution @xmath58 is specified , eq.[eq : mast ] uniquely determines the subsequent evolution of the phase space density @xmath57 .",
    "in addition to the markov assumption ( eq.[eq : mast ] ) , we will impose another assumption on our stochastic process : detailed balance .",
    "if @xmath0 is held fixed , @xmath23 becomes a _",
    "stationary _ markov process , describing the evolution of a system in contact with a heat reservoir , when the external forces acting on the system are time - independent . under such evolution ,",
    "the canonical distribution in phase space ( corresponding to the fixed value of @xmath0 ) ought to be invariant . by eq.[eq : mast ] , this is equivalent to the statement that @xmath56 annihilates the canonical distribution : @xmath59 this places a condition on the linear operator @xmath56 .",
    "we assume that our stochastic process satisfies this condition , and will refer to this assumption as _",
    "detailed balance_. ( usually , detailed balance is expressed as the following , somewhat stronger assumuption : @xmath60 eq.[eq : stat ] follows immediately from eq.[eq : otherdb ] : just set the products of the cross terms equal , then integrate over @xmath44 .",
    "the distinction between eqs.[eq : stat ] and [ eq : otherdb ] is of little importance in the present context , so for simplicity we refer to eq.[eq : stat ] as detailed balance . )",
    "having been led to assume detailed balance by considering the behavior of the system when @xmath0 is fixed , it may seem natural to make another assumption .",
    "namely , if our stochastic process is meant to describe a system in contact with a reservoir , then for fixed @xmath0 we expect the system to thermalize : after an initial relaxation time , the system samples its phase space canonically ; equivalently , an arbitrary initial ensemble @xmath61 relaxes to a canonical distribution in phase space .",
    "we may express this assumption formally , as : @xmath62 for any normalized @xmath61 .",
    "the operator @xmath63 appearing on the left is just the evolution operator corresponding to the equation of motion @xmath64 , for fixed @xmath0 .",
    "eq.[eq : therm ] says that any initial distribution @xmath61 relaxes to a canonical distribution , and then stays there .",
    "we will refer to this as the assumption of _ thermalization_. note that while thermalization ( eq.[eq : therm ] ) implies detailed balance ( eq.[eq : stat ] ) , the converse is not true . since it will turn out that the proof of eq.[eq : iden ] requires only the weaker assumption of detailed balance , and not the stronger thermalization assumption , we will assume in what follows that eq.[eq : stat ] holds , _ but not necessarily eq.[eq : therm ] _ , unless explicitly stated .",
    "[ physically , we expect both thermalization and detailed balance to hold , as long as our master equation describes a system in contact with a genuine heat reservoir .",
    "however , one can easily imagine situations in which the evolution satisfies eq.[eq : stat ] but not eq.[eq : therm ] .",
    "a specific example , which we will analyze in section [ sec : examp ] , is that of an isolated hamiltonian system .",
    "note that if thermalization does not hold , then the validity of eq.[eq : infty ] , @xmath65 , is not guaranteed , since that result assumes that during an infinitely slow switching process the system remains in quasi - static equilibrium with a reservoir .",
    "eq.[eq : iden ] nevertheless remains valid , provided detailed balance is satisfied . ]    at this point we are ready to proceed with a proof of eq.[eq : iden ] .",
    "concrete examples of stochastic processes satisfying the assumptions made in this section will be discussed in section [ sec : examp ] , and numerically simulated in section [ sec : numres ] .",
    "the overbar appearing on the left side of eq.[eq : iden ] denotes an average over an infinite ensemble of independent realizations ( repetitions ) of the switching process .",
    "each realization is described by a trajectory @xmath23 , @xmath66 , specifying the evolution of the complete set of phase space variables as the external parameter @xmath0 is switched from 0 to 1 .",
    "the entire ensemble is then described by a time - dependent phase space density : at any time @xmath43 , @xmath52 represents a snapshot of the distribution of trajectories in phase space . since we assume that the system equilibrates with the reservoir ( with @xmath0 held fixed at 0 ) before the start of each realization , we have a canonical distribution of initial conditions@xcite : @xmath67 during the switching process , however , the ensemble does not ( in general ) remain in instantaneous canonical equilibrium .",
    "in other words , although the distribution @xmath68 is a ( stationary ) solution of eq.[eq : mast ] for @xmath0 _ fixed _ , it is not , in general , a solution of eq.[eq : mast ] when @xmath0 depends on time .",
    "thus , for @xmath69 , a snapshot of the trajectories will reveal a distribution @xmath52 which lags behind the canonical distribution corresponding to @xmath51 .",
    "the amount of lag present by the time a given value of @xmath0 is reached , will depend on how rapidly or slowly we performed the switching on the way to that value .",
    "for every trajectory @xmath23 in our ensemble , we can compute the total work @xmath6 performed on the system ( eq.[eq : work ] ) .",
    "our task is now to evaluate the ensemble average of @xmath70 . to do this ,",
    "let us first define , for a given trajectory @xmath23 , a function @xmath71 which is the `` work accumulated '' up to time @xmath43 : @xmath72 thus , @xmath73 .",
    "now consider all those trajectories in the ensemble which happen to pass through the phase space point * z * at time @xmath43 , and let @xmath74 denote the average value of @xmath75 , over this particular subset of trajectories .",
    "finally , define @xmath76 note that @xmath77 , since @xmath78 for every trajectory . given these definitions , the ensemble average of @xmath70",
    "may be expressed as : @xmath79 we will now solve for @xmath80 .",
    "the function @xmath81 obeys @xmath82 with @xmath54 . to see this ,",
    "imagine for a moment that each trajectory @xmath23 in the ensemble represents a `` particle '' moving about in phase space .",
    "furthermore , assume that the `` mass '' of each particle is time - dependent , and is given by @xmath83 .",
    "each particle thus begins with mass unity : @xmath84 .",
    "the function @xmath74 is then the average mass of those particles which are found at a point @xmath85 at time @xmath43 , and @xmath81 represents the time - dependent _ mass density _ in phase space ( after normalization of the number density to unity : @xmath86 ) .",
    "this mass density is time - dependent for two reasons .",
    "first , ( a ) the mass of each particle changes with time , at a rate proportional to its instantaneous mass : @xmath87 this contributes a term @xmath88 to @xmath89 .",
    "secondly , ( b ) the mass density evolves due to the flow of particles , described by our master equation , @xmath90 .",
    "this flow of particles contributes a term @xmath91 adding these contributions , a and b , gives eq.[eq : dgdt ] .",
    "an alternative derivation of this evolution equation , based on a path integral formulation , is given in appendix a.    given the initial conditions @xmath92 , eq.[eq : dgdt ] is solved by @xmath93 where @xmath54 , and @xmath94 denotes the canonical distribution in phase space , for a given value of @xmath0 . this result",
    "is easily verified with the help of eq.[eq : stat ] .",
    "then , using eq.[eq : avex ] , we finally arrive at @xmath95 _ q.e.d . _    a different proof of eq.[eq : iden ] has been discovered by gavin e.  crooks@xcite .    it is worthwhile to draw attention to a curious feature of the evolution of our `` mass density '' , @xmath81 .",
    "recall that the evolution of @xmath52 depends nontrivially on the rate at which we switch @xmath0 : at finite switching rates , @xmath52 lags behind the instantaneous equilibrium distribution .",
    "by contrast , the time dependence of @xmath81 is very simple : the mass density is determined uniquely by the instantaneous value of @xmath0 ; see eq.[eq : goft ] .",
    "thus , no matter how slowly or rapidly we switch @xmath0 from 0 to 1 , @xmath81 will always evolve through exactly the same continuous sequence of `` canonical '' mass densities , specified by eq.[eq : goft ] ; @xmath96 _ never develops a lag _ , in the sense that @xmath57 does .",
    "eq.[eq : goft ] also implies the result @xmath97 @xmath54 , which is in effect a restatement of our central result , eq.[eq : iden ] .",
    "we have shown that eq.[eq : iden ] is true for markovian processes satisfying detailed balance .",
    "let us consider a few examples of such processes .      as a first case , we take deterministic evolution under the hamiltonian @xmath21 , as @xmath0",
    "is varied from 0 to 1 : @xmath98 where @xmath99 denotes the poisson bracket .",
    "ordinarily , one would not call this a stochastic process , but of course it may be viewed as a special case of such .",
    "this evolution is markovian , and @xmath56 is just the poisson bracket operator : @xmath100 it immediately follows that detailed balance ( eq.[eq : stat ] ) is satisfied .",
    "the central result of this paper then tells us that , if we ( 1 ) start with a canonical distribution of initial conditions , @xmath101 , and ( 2 ) allow trajectories to evolve deterministically from these initial conditions ( eq.[eq : ham ] ) as @xmath0 is varied from 0 to 1 , then this ensemble of trajectories will satisfy eq.[eq : iden ] , regardless of how slowly or quickly we perform the switching .",
    "this result was proven more directly in ref.@xcite .    since evolution under eq.[eq",
    ": ham ] describes an isolated system ( no heat bath ) , the thermalization assumption ( eq.[eq : therm ] ) is not met , and the work performed in the limit of infinitely slow switching will in general not equal the free energy difference : @xmath102 .",
    "eq.[eq : iden ] nevertheless remains true , even in this limit .",
    "this last statement is easily illustrated with a one - dimensional harmonic oscillator .",
    "let the hamiltonian be @xmath103 for a given temperature , the partition function is given by @xmath104 , and the free energy difference is @xmath105 let us now imagine a trajectory @xmath23 evolving under this hamiltonian , as @xmath0 is changed infinitely slowly from 0 to 1 ; assume for specificity that @xmath106 .",
    "since @xmath107 is an adiabatic invariant for the harmonic oscillator@xcite , we have @xmath108 , where @xmath109 ( @xmath110 ) is the initial ( final ) energy of the oscillator .",
    "the work performed on an isolated system is equal to the change in its energy , so we get @xmath111 e_0 $ ] . a canonical distribution of initial energies @xmath109 then leads , after some algebra , to the following ensemble distribution of values of @xmath6 : @xmath112 where @xmath113 denotes the unit step function .",
    "it is straighforward to verify that this distribution satisfies eq.[eq : iden ] .    as another example , consider a single particle bouncing around inside a three - dimensional cavity with hard walls , where the shape of the cavity is a function of @xmath0 .",
    "let @xmath114 denote the volume of the cavity .",
    "the free energy difference is then @xmath115 .",
    "assume that , when @xmath0 is held fixed , the motion of the particle is ergodic over the energy shell ( the 5-dimensional surface of constant energy in 6-dimensional phase space ) ; also assume that @xmath116 .",
    "now , imagine that we allow the particle to evolve as @xmath0 is switched infinitely slowly from 0 to 1 .",
    "for this system the quantity @xmath117 is an adiabatic invariant@xcite , therefore the total work performed on a particle with initial energy @xmath109 is : @xmath118e_0 $ ] .",
    "taking an ensemble of such particles , defined by a canonical distribution of initial conditions ( at @xmath2 ) , we get @xmath119 where @xmath120 . as with the example of the harmonic oscillator , it is straightforward to show that this distribution @xmath15 satisfies eq.[eq : iden ] .",
    "next , let us consider modifying hamilton s equations , by adding both a frictional and a stochastic force :    [ eq : langevin ] @xmath121    we have assumed a one - degree - of - freedom system , and a hamiltonian @xmath122 .",
    "let us furthermore take the stochastic force , @xmath123 , to represent white noise , with an autocorrelation function given by @xmath124 finally , let us impose a fluctuation - dissipation relation between the frictional and stochastic forces : @xmath125 an ensemble of trajectories evolving under the stochastic process just defined satisfies the fokker - planck equation , @xmath126 since eq.[eq : fp ] is of the form @xmath64 , this process is markovian .",
    "furthermore , inspection reveals that @xmath56 satisfies eq.[eq : stat ] , i.e. detailed balance holds .",
    "thus , the conditions for the validity of eq.[eq : iden ] are met : given an ensemble of systems evolving under this stochastic process , as @xmath0 is changed from 0 to 1 over a time @xmath8 , and given an initial distribution @xmath127 , we are guaranteed that this ensemble will satisfy @xmath128 , for any switching time @xmath8 .",
    "eq.[eq : langevin ] is a _",
    "set of equations .",
    "if @xmath0 is held fixed , an ensemble of trajectories evolving under these stochastic equations of motion will relax to a canonical distribution on phase space .",
    "in other words , the evolution specified by eqs.[eq : langevin ] to [ eq : fd ] satisfies not only detailed balance , but the stronger assumption of thermalization as well . if we start with a canonical distribution , at @xmath2 , and then switch the value of the external parameter infinitely slowly to @xmath3 , then the ensemble of trajectories will remain in quasi - static equilibrium over the course of the switching process : @xmath129 the creeping value of @xmath0 thus drags @xmath52 through a continuous sequence of canonical distributions .",
    "furthermore , in this limit , the `` work accumulated '' will be the same function of time for every trajectory in the ensemble : @xmath130 ; each trajectory represents a system evolving in quasi - static equilibrium with the reservoir .",
    "thus , the quantity @xmath74 defined earlier is given , in this quasi - static limit , by @xmath131 it then follows that the function @xmath132 ( eq.[eq : gdef ] ) satisfies @xmath133 ( eq.[eq : goft ] ) , from which we get @xmath134 .",
    "of course , when we switch @xmath0 from 0 to 1 over a _ finite _",
    "time @xmath8 , neither eq.[eq : quasi - stat ] nor eq.[eq : q ] will in general hold ; nevertheless , eq.[eq : goft ] , and therefore our central result , will remain valid , since eq.[eq : dgdt ] governs the time evolution of @xmath96 regardless of how slowly or quickly we switch the external parameter .",
    "the langevin equations above provide a simple method for numerically simulating the evolution of a thermostatted system ( i.e. a system in contact with a heat bath ) , without explicitly simulating the many degrees of freedom of the bath .",
    "the term @xmath123 may be implemented by generating a small , random momentum `` kick '' at each time step in the numerical integration of the equations of motion .",
    "this method works both for static hamiltonians and  as in the case considered in the present paper  for hamiltonians made time - dependent through the variation of an external parameter . in the past decade or so",
    ", methods for using explicitly _ deterministic _ equations of motion to simulate thermostatted systems , have proven very useful@xcite .",
    "these generally go under the name of _ isothermal molecular dynamics _ ( imd ) .",
    "typically , the heat bath is represented by one or more `` extra '' degrees of freedom .",
    "then , in the extended phase space which includes both the system of interest and the extra degree(s ) of freedom , the evolution is governed by a set of deterministic ( but non - hamiltonian ) equations of motion .",
    "these are tailored so that , when the hamiltonian describing the system of interest is static , the variables representing the system of interest explore phase space canonically , at least to a good approximation .",
    "an example of an imd scheme is _ nos ' e - hoover dynamics_@xcite , represented by the following equations of motion :    [ eq : nh ] @xmath135    we have again assumed a kinetic - plus - potential hamiltonian ; the index @xmath136 runs over all @xmath137 degrees of freedom of the system , @xmath138 is the total kinetic energy of the system , @xmath139 is the thermal average of @xmath140 , and the parameter @xmath141 acts as a relaxation time .",
    "let us imagine a trajectory evolving in the extended phase space , @xmath142-space , under these equations of motion , as @xmath0 is switched from 0 to 1 .",
    "the work @xmath6 performed on the system of interest is defined , as before , by eq.[eq : work ] . while this expression does not explicitly contain the bath variable @xmath143",
    ", @xmath6 is nevertheless a function of the full set of initial conditions , @xmath144 , since the evolution of the system of interest ( * z * ) is coupled to that of the heat bath ( @xmath143 ) .    in ref.@xcite",
    ", it was shown that , if one started with a distribution of initial conditions in the extended phase space given by @xmath145,\\ ] ] and if one then propagated an ensemble of trajectories from these initial conditions , under the nos ' e - hoover ( nh ) equations of motion , as @xmath0 was switched from 0 to 1 over a time @xmath8 , and computed the work @xmath6 for each trajectory , then eq.[eq : iden ] would hold identically for this ensemble .",
    "this was shown by inspection .",
    "our purpose here is to use the central result of the present paper to establish simple criteria for determining whether or not eq.[eq : iden ] is valid for a particular implementation of imd . in general ,",
    "the heat bath is represented by @xmath146 variables , @xmath147 to @xmath148 .",
    "let @xmath149 ) denote a point in the @xmath150-dimensional extended phase space , where @xmath137 is the number of degrees of freedom of the system of interest .",
    "then the thermostatting scheme in question is defined by a set of deterministic equations of motion in this space : @xmath151 of which eq.[eq : nh ] is an example .",
    "an ensemble of trajectories evolving under these equations of motion may be described by a distribution @xmath152 which satisfies the continuity equation , @xmath153    now suppose that we can find a function @xmath154 such that the distribution @xmath155\\ ] ] is stationary under the evolution defined by eq.[eq : scheme ] , when @xmath0 is held fixed .",
    "that is , @xmath156 ( for the nh equations , @xmath157 satisfies this condition . )",
    "we will allow @xmath158 to depend on @xmath26 , and any other _ constant _ parameters , but not on @xmath0 .",
    "the distribution @xmath159 may be viewed as the `` canonical '' distribution in the extended phase space , since it is invariant when @xmath0 is held fixed .",
    "now define a function @xmath160 which we may think of as an _ extended hamiltonian_. ( this is not meant to imply that @xmath161 generates eq.[eq : scheme ] as a `` real '' hamiltonian would ; in general those equations are non - hamiltonian . ) by eq.[eq : nhdb ] : @xmath162    now forget for a moment the division between system of interest and heat bath , and treat the entire extended phase space as a phase space for some system of interest , for which a parameter - dependent energy function , @xmath163 , is defined . the evolution given by eq.[eq : scheme ]",
    "then satisfies the two conditions listed in section [ sec : deriv ] : ( 1 ) it is markovian ( eq.[eq : nhpde ] ) , and ( 2 ) it satisfies detailed balance ( eq.[eq : nhdb2 ] ) .",
    "thus , our central result , @xmath134 , is identically true for an ensemble of trajectories evolving under eq.[eq : scheme ] from an initial distribution @xmath164 , _ provided we replace @xmath24 by @xmath163 in computing @xmath6 and @xmath17_. however , it is easily verified that we will get exactly the same values for both @xmath6 and @xmath17 using @xmath163 , as we would obtain with @xmath24 . in the case of @xmath6 ,",
    "this is because only the first term of @xmath161 ( namely , @xmath21 ) depends on @xmath0 ; for @xmath17 , it follows from the fact that the partition function for the extended hamiltonian factorizes into an integral over the @xmath85 variables and an integral over the @xmath143 variables , and only the former depends on @xmath0 .",
    "( see the definitions of work and free energy , eqs.[eq : fdef ] and [ eq : work ] . )",
    "these considerations lead to the following simple conclusion .",
    "suppose we have a system described by a hamiltonian @xmath24 , and we wish to compute the free energy difference @xmath165 .",
    "suppose furthermore that we are given a scheme for imd ; that is , we have a set of `` heat bath '' variables @xmath166 , along with equations of motion in the extended phase space , as per eq.[eq : scheme ] .",
    "then , if a function @xmath158 of the heat bath variables can be found such that the distribution @xmath167 is stationary under the equations of motion ( with @xmath0 fixed ) , then we can compute @xmath17 as follows .",
    "let an ensemble of trajectories evolve from an initial distribution @xmath168 , as @xmath0 is switched from 0 to 1 over a finite switching time @xmath8 .",
    "compute the work @xmath6 for each trajectory , as per eq.[eq : work ] , and then compute the ensemble average of @xmath70 .",
    "this average will equal @xmath169 .      as a final example  again , motivated by computer simulations  let us consider the evolution of a _",
    "monte carlo _",
    "( mc ) trajectory , as @xmath0 is switched from 0 to 1 . in this case",
    "both the trajectory and the parameter @xmath0 evolved in discrete steps , rather than continuously : @xmath170 the initial point in phase space , @xmath171 , is sampled from a canonical distribution , with the value of @xmath0 fixed at @xmath172 .",
    "one then imagines that @xmath0 changes abruptly from @xmath172 to @xmath173 ; as a result , a quantity of work @xmath174 is performed on the system .",
    "then , the system jumps to the next point in phase space , @xmath175 , generated from @xmath171 by a mc algorithm appropriate to the hamiltonian @xmath176 ( see appendix b ) .",
    "one then continues to alternate between discrete changes in @xmath0 and discrete mc jumps in phase space , until the entire `` trajectory '' ( @xmath177 ) is obtained , and the value of @xmath0 is 1 .",
    "the total work performed during this discrete switching process is : @xmath178.\\ ] ] note that `` time '' does not enter into this scheme .",
    "the quasi - static limit is obtained by letting the number of steps become arbitrarily large : @xmath179 .",
    "let us now imagine that we generate an infinite ensemble of mc trajectories , each of length @xmath146 .",
    "we do this by implementing the above procedure repeatedly , each time feeding in a different string of random numbers to generate the initial conditions @xmath171 , and the subsequent mc steps .",
    "given such an ensemble , we compute the work @xmath6 performed on each trajectory ( eq.[eq : dwork ] ) , and then the ensemble average of @xmath70 . as shown in appendix b , this average will equal @xmath169 .",
    "this should come as no surprise : a trajectory generated by the mc algorithm is a _ markov chain _",
    ", with detailed balance built into the individual steps .",
    "this evolution thus satisfies , in discretized form , the two assumptions required for the validity of eq.[eq : iden ] .",
    "let us now consider the two limiting cases @xmath180 and @xmath179 .",
    "the latter is the mc equivalent of the quasi - static limit . in this case",
    "our ensemble proceeds through a discrete , infinitesimally spaced sequence of canonical equilibrium distributions , and the work performed on each trajectory is @xmath17 , as per eq.[eq : infty ] .",
    "the result @xmath134 then follows automatically . in the opposite limit , @xmath180 ,",
    "the work @xmath6 performed on a particular `` trajectory '' is given by @xmath181 eq.[eq : iden ] then reduces to : @xmath182 where @xmath183 denotes a canonical average with respect to @xmath2 .",
    "this result is a well - known identity for the free energy difference @xmath17 ; see eq.[eq : tp ] below .",
    "while eq.[eq : iden ] is interesting in its own right , it may additionally prove useful in the numerical computation of free energy differences .",
    "the field of free energy computations is decades old , with diverse applications , and a very large body of literature exists on the subject@xcite . in this section , without attempting a survey of the field , we discuss a few points relevant to the possible application of eq.[eq : iden ] to free energy computations .",
    "these comments expand on ones made in ref.@xcite .",
    "most methods of computing free energy differences are variants of either the _ thermodynamic integration _",
    "( ti ) or _ thermodynamic perturbation _ ( tp ) methods .",
    "( for an exception to this statement , see the work of holian , posch , and hoover@xcite , where two new expressions for @xmath17 , based on time - integrated heat transfer , are derived within the framework of isothermal molecular dynamics . )",
    "tp is based on the identity@xcite @xmath184 where @xmath185 denotes a canonical average with respect to a fixed value of @xmath0 . using a method such as monte carlo ,",
    "one samples @xmath146 points in phase space from the canonical distribution corresponding to @xmath2 , and then one takes the average of @xmath186 over these @xmath146 points . in principle , the method is exact for @xmath179 ; in practice , unless the canonical distributions corresponding to @xmath187 and @xmath188 overlap to a significant degree , the average of @xmath186 will be dominated by points in phase space which are visited extremely rarely during the canonical sampling , so numerical convergence with @xmath146 will be prohibitively slow .",
    "one way to get around this problem is to break up the @xmath0-interval @xmath189 $ ] into small sub - intervals , then use eq.[eq : tp ] to compute the free energy difference corresponding to each sub - interval .",
    "other , more sophisticated methods of extracting the best efficiency from eq.[eq : tp ] have been developed over the years@xcite .",
    "ti is based on the identity@xcite @xmath190 the integral on the right may be evaluated by sampling @xmath191 points in phase space from each of @xmath192 different canonical distributions ( corresponding to equally spaced values of @xmath0 from 0 to 1 ) , for a grand total of @xmath193 points sampled .",
    "the average of @xmath194 is then computed at each value of @xmath0 , and from these @xmath192 averages the integral is obtained . with the exception of a few very simple systems ( e.g.  ideal gases , harmonic oscillators ) ,",
    "the standard way to obtain a canonical distribution is to first allow the system to `` age ''  that is , to relax to an equilibrium statistical state  under some mc or imd scheme . in implementing the numerical evaluation of @xmath195 ,",
    "it is often too time - consuming to age the system independently at each of the @xmath192 selected values of @xmath0 .",
    "instead , the final point sampled at one @xmath0 value may be used to generate the initial point sampled at the next value of @xmath0 .",
    "of course , this means that at each @xmath0 ( except @xmath2 ) we are actually sampling from a slightly out - of - equilibrium distribution , which leads to a systematic error ( in fact , an over - estimate ) in the evaluation of the integral .",
    "a limiting case of this procedure arises when we take @xmath196 , i.e.  exactly one point is sampled at each value of @xmath0 .",
    "this is the _ slow growth _ method@xcite .",
    "as stressed by reinhardt and coworkers@xcite , if we view the chain of points @xmath197 thus generated as a _ trajectory _ evolving in phase space ( as @xmath0",
    "is switched from 0 to 1 ) , then the integral appearing on the right side of eq.[eq : ti ] represents the work @xmath6 performed on the system over the course of the switching process .",
    "this picture is a compelling one , as it attaches a very physical interpretation to the numerical evaluation of eq.[eq : ti ] : instead of computing an integral , we are simulating the evolution of a thermostatted system , with the idea that , in the limit of infinitely slow switching , the work performed on the system will equal the free energy difference @xmath17 . for a finite switching rate , the above - mentioned systematic error inherent in the slow growth method is simply a manifestation of the inequality @xmath20 ; see eq.[eq : ineq ] and refs.@xcite .",
    "this interpretation of free energy computations is referred to as _ adiabatic switching _ ( or _ finite - time variation _ ) , and indeed may be viewed as a separate method , distinct from thermodynamic integration .    in the context of adiabatic switching , eq.[eq : iden ]",
    "says that , if we run an ensemble of finite - time ( or finite-@xmath146 , for monte carlo ) simulations of the switching process , using for instance one of the methods described in section [ sec : examp ] , then the average of @xmath70 over this ensemble of simulations will equal @xmath169 . assuming perfect numerical accuracy and an infinite ensemble of simulations , this is an _",
    "exact _ statement .",
    "another way of putting it is as follows : for a single finite - time switching simulation , the value of @xmath70 provides an _ unbiased _ estimate of @xmath169 .",
    "by contrast , the value of @xmath6 gives a biased estimate of @xmath17 ( i.e.  @xmath20 ) .",
    "indeed , the former statement implies the latter , in the same way that eq.[eq : tp ] implies the gibbs - bogoliubov - feynman inequality@xcite : @xmath198 .",
    "let us consider this for a moment",
    ".    given a real function of a real variable , @xmath199 , it is easy to show that , if @xmath200 for all @xmath201 , then @xmath202 for any set of points @xmath203 .",
    "if these points are the result of random sampling from some ensemble , then eq.[eq : math ] , in the limit @xmath179 , may be rewritten as @xmath204 where the overbar denotes an ensemble average . applying this result to @xmath205 , with @xmath206 , we get @xmath207 this is identically true for any distribution @xmath208 .",
    "we may now combine this result with eq.[eq : iden ] to get @xmath20 .",
    "now , what if we perform a finite number , @xmath209 , of identical switching simulations ? let @xmath210 denote the work performed on the system during the @xmath211th simulation , and let @xmath212 be the average over these values .",
    "we may view the @xmath210 s as numbers sampled randomly from a distribution @xmath208 satisfying eq.[eq : iden ] .",
    "then the expectation value of @xmath213 provides a rigorous upper bound on @xmath17 : @xmath214 the double angular brackets , denoting _ expectation value _ , specifically mean an average over all possible sets of @xmath209 simulations .",
    "now , eq.[eq : iden ] suggests that , rather than @xmath213 , we consider the following quantity as our best estimate of @xmath17 : @xmath215 for @xmath216 , @xmath217 and @xmath213 are identical , and the expectation value of either is @xmath218 . for @xmath219 , by contrast , @xmath217 converges to @xmath17 , whereas @xmath213 converges to @xmath218 . for intermediate values of @xmath209 ,",
    "the following inequality chain holds : @xmath220 ( both inequalities are derived by combining eqs.[eq : iden ] and [ eq : math ] with the definitions of @xmath213 and @xmath217 . ) in other words , as an estimate of @xmath17 , the `` exponential average '' , @xmath217 , is statistically less biased than the ordinary average , @xmath213 , for @xmath221 .    on the face of it , the last statement seems to imply that , if we perform more than one switching simulation , then we are better off using @xmath217 rather than @xmath213 as our best guess ( or upper bound ) for @xmath17 . in practice , however , eq.[eq : iden ] may be subject to the same disease as the tp identity , eq.[eq : tp ] .",
    "namely , if the values of @xmath6 obtained from repetitions of the switching simulation typically differ from one another by much more than @xmath31 , then the average of @xmath70 will be dominated by values of @xmath6 which are very rarely sampled@xcite .",
    "thus , the convergence of @xmath217 to @xmath17 , in the limit @xmath219 , may be much slower than the convergence of @xmath213 to @xmath218 , in the same limit .",
    "in other words , for a finite number of switching simulations , @xmath217 may be subject to considerably larger _",
    "statistical _ fluctuations than @xmath213 , even though its _ systematic _ error ( expectation value minus @xmath17 ) is , by eq.[eq : chain ] , smaller .",
    "the preceding comments point to the following tentative conclusion . if one runs a set of @xmath209 switching simulations , with the goal of computing @xmath17 , and if the spread in the values of work @xmath6 obtained is not much larger than @xmath31 , then the exponential average @xmath217 defined by eq.[eq : wxdef ] should provide a better estimate of ( or tighter upper bound on ) @xmath17 than the ordinary average @xmath213 .",
    "this conclusion is supported by a calculation by john e.  hunter iii , as described in ref.@xcite ; see also the numerical illustrations in the following section .",
    "of course , a more detailed study of the possible utility of eq.[eq : iden ] to free energy computations should be made .",
    "in particular , it is not ruled out that there exist methods around the limitation mentioned in the previous paragraphs@xcite .",
    "in this section we illustrate our central result with numerical experiments .",
    "the first four sets of simulations involve a harmonic oscillator whose natural frequency is switched from @xmath222 to @xmath223 .",
    "the evolution is implemented using , in turn , each of the four examples discussed in section [ sec : examp ] .",
    "then , we present results involving a more complicated system : a gas of interacting particles inside an externally pumped piston .",
    "all of these cases satisfy the condition discussed at the end of section [ sec : comp ] , namely , the spread in the values of @xmath6 is not much greater than @xmath31 .",
    "( otherwise , the convergence of @xmath217 to @xmath17 , in the limit of many simulations , would be poor . )    for the harmonic oscillator simulations , we take the hamiltonian given by eq.[eq : hoham ] , with @xmath224 , and @xmath225 as throughout this paper . also , we take @xmath226 .",
    "thus , the free energy difference is @xmath227 .    in the first set of simulations ,",
    "the oscillator is isolated ( it evolves under hamilton s equations , with @xmath0 time - dependent ) , although the initial conditions are sampled from a canonical ensemble corresponding to @xmath228 : @xmath229.\\ ] ] five different values of the switching time were chosen : @xmath230 1.0 , 3.0 , 10.0 , 30.0 , and 100.0 , and for each @xmath8 a total of @xmath231 simulations were carried out .",
    "fig.[fig : ham ] shows the average value of work obtained at each switching time , @xmath213 , as well as the `` exponential average '' , @xmath217 .",
    "( see eqs.[eq : wadef ] and [ eq : wxdef ] . ) since hamiltonian evolution satisfies detailed balance , but not thermalization ( as defined in section [ sec : prelim ] ) , we do not expect the work performed in the limit @xmath12 to equal the free energy difference @xmath17 .",
    "rather , we expect @xmath232 e_0 $ ] for a single trajectory ( see section [ subsec : hamev ] ) , and therefore , for a canonical distribution of initial energies , @xmath233 \\beta^{-1 } = 1.5.\\ ] ] the values of @xmath213 shown in fig.[fig : ham ] are consistent with this expectation .",
    "eq.[eq : iden ] , meanwhile , predicts @xmath234 for _ any _ value of @xmath8 .",
    "again , the numerical results are consistent with the prediction : the values of @xmath217 shown in fig.[fig : ham ] all fall very close to @xmath17 .    for the second set of simulations",
    ", we added a frictional and a stochastic force , as described by eqs.[eq : langevin ] to [ eq : fd ] , with @xmath235 and @xmath226 .",
    "the evolution now represents that of an oscillator coupled to a heat bath . the stochastic force was implemented by generating a random momentum kick ( sampled from a gaussian distribution ) at each time step , @xmath236 , in the numerical integration . as with the hamiltonian evolution ,",
    "@xmath237 simulations were performed at each of the five switching times , and the results for @xmath213 and @xmath217 are plotted in fig.[fig : lang ] . here",
    "we _ do _ expect that the work @xmath6 will approach @xmath238 as @xmath12 , and the results for @xmath213 support this . at the same time , the exponential average @xmath217 falls very close to @xmath17 for each switching time , as predicted by eq.[eq : iden ] .",
    "the next simulations again involved a thermostatted harmonic oscillator , only this time isothermal molecular dynamics was used to implement the coupling to the heat bath .",
    "the particular imd scheme used was developed by hoover and holian@xcite , and involves two heat bath variables , @xmath143 and @xmath239 .",
    "the equations of motion in the extended phase space are    [ eq : imdeq ] @xmath240    where @xmath141 is a relaxation time whose value was set to unity .",
    "a total of @xmath231 switching simulations were performed , with a swtiching time @xmath241 . at the start of each simulation",
    ", initial conditions were sampled from the distribution @xmath242.\\ ] ] it is easily verified by inspection that , if the value of @xmath0 were held fixed at 0 , then this distribution would be invariant under eq.[eq : imdeq ] .",
    "this is therefore the `` canonical distribution '' corresponding to this imd scheme , and the function @xmath158 defined in section [ subsec : imd ] is given by : @xmath243    this set of simulations was used to illustrate eq.[eq : goft ] , evaluated at @xmath35 .",
    "( see the discussion at the end of section [ sec : deriv ] . )",
    "fig.[fig : imd1 ] is a scatter plot showing the distribution of final values in phase space , @xmath244 , for the @xmath237 trajectories .",
    "fig.[fig : imd2 ] shows several contour lines of this distribution , after smearing each point with a gaussian of variance 0.04 in both the @xmath201 and @xmath245 directions .",
    "thus , the lines shown are actually contours of the function @xmath246\\ , \\delta_\\epsilon[p - p_i(t_s)]\\qquad,\\qquad   \\epsilon = 0.04,\\ ] ] where @xmath247 is a normalized gaussian of variance @xmath248 , and @xmath249 gives the phase space evolution of the @xmath211th trajectory in the ensemble of simulations .",
    "as can be seen from both figures , this distribution does not correspond to the canonical distribution for @xmath188 .",
    "indeed , its skewness illustrates the `` lag '' which develops between the evolving phase space density and the instantaneous canonical distribution .",
    "next , the solid lines in fig.[fig : imd3 ] show contours of the function @xmath250 defined in section [ sec : deriv ] , obtained from the same set of simulations . again",
    ", gaussian smoothing was used , so the solid lines are contours of the function @xmath251\\ , \\delta_\\epsilon[p - p_i(t_s)]\\exp -\\beta w_i \\qquad,\\qquad \\epsilon = 0.04,\\ ] ] where @xmath210 is the total work performed on the system during the @xmath211th simulation .",
    "the dashed lines in fig.[fig : imd3 ] show the corresponding contours of the _ predicted _ `` mass density '' @xmath250 ( eq.[eq : goft ] ) , with the same gaussian smoothing function folded in .",
    "the agreement between the two sets of contours is very good .",
    "this shows that , indeed , when one assigns a weight @xmath252 to each of the points in the scatter plot , fig.[fig : imd1 ] , then the resulting weighted distribution is canonical , in the sense of eq.[eq : goft ] .    in the final set of simulations involving the harmonic oscillator , we used monte carlo evolution , with the metropolis algorithm . here",
    ", the duration of a simulation is characterized by the number of mc steps , @xmath146 , rather than by a switching time @xmath8 .",
    "ten different values of @xmath146 were considered , @xmath253 , and for each a total of @xmath237 simulations were performed .",
    "fig.[fig : mc ] shows @xmath213 and @xmath217 for each value of @xmath146 ; as before , the results agree nicely with eqs.[eq : infty ] to [ eq : iden ] .",
    "fig.[fig : mc_dists ] shows @xmath254  the distribution of values of @xmath6 obtained from the @xmath237 simulations  for each of the ten values of @xmath146 .",
    "although the distributions @xmath255 are quite different , the integral @xmath256 ( i.e.  @xmath257 ) is independent of @xmath146 , as shown by the values of @xmath217 in fig.[fig : mc ] .    as a final example",
    ", we take a system more complicated than a harmonic oscillator , namely , a gas of @xmath258 interacting particles inside a piston which is taken through one cycle of pumping .",
    "specifically , the particles are confined within a two - dimensional box with hard walls , whose initial dimensions are @xmath259 ; over the course of the switching process , one of the wall first moves inward until the area enclosed by the box is three - quarters of its initial value , and then back out again .",
    "this pumping of the piston is cosinusoidal : the @xmath260 and @xmath261 dimensions of the box are given by @xmath262 where @xmath263 and the total switching time is @xmath264 .    in their interactions with one another and with the walls ,",
    "the particles act as hard disks of radius @xmath265 ; between collisions each particle moves freely .",
    "( thus , over a switching time @xmath264 , a typical particle suffers several collisions with other particles . )",
    "work is performed on the gas each time a particle bounces off the moving wall .",
    "molecular dynamics was used for the evolution , i.e. continuous trajectories for the particles were computed as functions of time . however , at each time step in the integration of the equations of motion , a single particle was randomly selected , and a random `` kick ''  a discrete change in the momentum of the chosen particle  was generated .",
    "the kick was then either accepted or rejected according to the metropolis algorithm@xcite , corresponding to a temperature @xmath266 .",
    "this simulates coupling to a heat reservoir : if all the walls of the box were fixed , the gas would relax to thermal equilibrium from any initial conditions .",
    "fig.[fig : piston ] shows results obtained from @xmath267 such simulations . for each simulation ,",
    "the initial conditions of the gas were chosen from a canonical ensemble ( @xmath266 ) , and the work performed on the gas , as a function of time , was computed .",
    "the horizontal axis shows time .",
    "the solid line gives the work performed on the gas up to time @xmath43 ",
    "i.e. the `` work accumulated '' , @xmath71  averaged over all @xmath209 simulations .",
    "let @xmath268 denote this average , where @xmath269 is the work accumulated during the @xmath211th simulation .",
    "the dashed line gives the `` exponential average '' @xmath270 of the work accumulated .",
    "both @xmath271 and @xmath272 were computed from the same set of @xmath273 trajectories .",
    "since the piston returns to its initial position at the end of the switching process , the final free energy difference is zero : @xmath274 .",
    "we see that the dashed line indeed returns to zero at @xmath35 , with very good accuracy .",
    "by contrast , the average work performed on the system ( upper line ) ends at @xmath275 .",
    "this represents dissipated energy : the gas `` heats up '' when pumped at a finite rate .    at intermediate times",
    ", we expect @xmath276 ( in the limit of infinitely many switching simulations ) , by eq.[eq : tiden ] .",
    "if the gas were truly ideal , then the free energy difference would be given by : @xmath277 where @xmath278 denotes the area enclosed by the box .",
    "however , since the particles do interact with one another , as hard disks , this expression for @xmath279 is not exact .",
    "nevertheless , the size of each particle is small enough ( @xmath265 ) that eq.[eq : ideal ] ought to represent an excellent approximation .",
    "the dotted line in fig.[fig : piston ] shows this approximation to @xmath279 .",
    "this line is very close to the exponential average ( dashed line ) , in confirmation of our central result , in the form given by eq.[eq : tiden ] .",
    "note that the dotted line represents the work that _ would have been _ performed on the gas , in the limit of infinitely slow switching ( @xmath12 ) .",
    "thus , in the dahsed line , we have effectively extracted this _ quasi - static _ behavior , from an ensemble of _ finite - time _ switching simulations !",
    "the central goal of this paper has been to establish the ( exact ! ) validity of the result @xmath128 , within the framework of the master equation approach .",
    "this result is unusual , in that it expresses _ in the form of an equality _ ( rather than an inequality , e.g. eq.[eq : ineq ] ) the relationship between the work @xmath6 performed on an out - of - equilibrium system ( more precisely , on an _ ensemble _ of systems driven out of equilibrium by varying an external parameter ) , and the free energy difference @xmath17 between two equilibrium states of the system .",
    "a few comments are now in order .    in classical statistical mechanics , the equilibrium `` state '' of a system",
    "is described by a canonical distribution in phase space : @xmath280 .",
    "its free energy is then given by @xmath281 where @xmath282 and @xmath283 .",
    "thus the free energy @xmath284 ( like the entropy @xmath285 ) is a quantity associated with a _ statistical ensemble _ of microscopic states of the system .",
    "when the system depends on some external parameter , then so does the canonical ensemble , as in turn does the free energy .",
    "the quantity @xmath17 of central interest throughout this paper has been the free energy difference ( at constant temperature ) between two such equilibrium ensembles , @xmath286 and @xmath287 .    in deriving eq.[eq : iden ] , we introduced a time - dependent phase space density @xmath52 , describing the evolution of our ensemble of trajectories .",
    "note that , although the initial phase space density coincides with the canonical distribution used to compute the free energy @xmath288 , @xmath289 the final density does _ not _ ( typically ) coincide with the distribution for which @xmath290 is defined : @xmath291 this is due to the lag which develops between the ensemble of trajectories and an instantaneous canonical distribution in phase space . thus , @xmath17 is not the free energy difference between the initial and final states of the system@xcite , but rather  as stated in the previous paragraph  between two different canonical ensembles , @xmath292 and @xmath293 , only the former of which reflects the actual distribution of microscopic states of the system at any time during the switching process .",
    "another way of putting this is as follows .",
    "suppose we are interested in the free energy difference between two equilibrium statistical states of a system , @xmath294 and @xmath295 ( corresponding to @xmath292 and @xmath293 , respectively ) . ordinarily , we would compute or measure @xmath17 by _ reversibly _ carrying the system from @xmath294 to @xmath295 , i.e. by switching @xmath0 infinitely slowly .",
    "eq.[eq : iden ] tells us that , even if we switch _ irreversibly _ , so that the system ends up in some nonequilibrium statistical state @xmath296 , we can still extract @xmath297 from an ensemble of such measurements .",
    "[ of course , if we are dealing with a system which satisfies the thermalization assumption , then , at the end of the switching process , we can always , at no cost in work , hold the value of @xmath0 fixed and allow our ensemble to relax , for an additional time @xmath298 , to thermal equilibrium : @xmath299 . in this case",
    "the @xmath17 which appears on the right side of eq.[eq : iden ] _ does _ equal the free energy difference between the initial and final statistical states of the system . ]",
    "eq.[eq : iden ] was derived , as an identity , under the assumptions of markovian evolution and detailed balance , as spelled out in section [ sec : prelim ] .",
    "this derivation is complementary to the one presented in ref.@xcite , in which the degrees of freedom of the heat reservoir were treated explicitly .",
    "neither of the assumptions of section [ sec : prelim ] was assumed in ref.@xcite , but the coupling between system and reservoir was taken to be weak , so the result there was an approximate one , with small corrections expected from the small but finite interaction hamiltonian .",
    "of course , in a real physical system , neither the markov assumption nor detailed balance will be met exactly , so the derivation presented herein is strictly speaking valid only for a particular class of _ models _ of physical reality . nevertheless , because the result is exact for these models , and because the markov and detailed balance assumptions are often very good approximations for physical systems , the result is a useful one .",
    "furthermore , as illustrated in section [ sec : examp ] , models of thermostatted systems which are commonly used in theoretical and numerical studies _ do _ satisfy these assumptions ; eq.[eq : iden ] is therefore exactly valid for these models .",
    "it would be very interesting , of course , to find a physical system on which a laboratory ( as opposed to numerical ! ) experiment testing the validity of eq.[eq : iden ] would be feasible .",
    "as mentioned in ref.@xcite , such a system would almost certainly have to be micro- , or at most meso- , scopic in size .",
    "finally , from both a theoretical and a computational point of view , it would be worthwhile to consider possible extensions or generalizations of eq.[eq : iden ] .",
    "in particular , are analogous results valid for ensembles other than the canonical ensemble ( fixed @xmath146 , @xmath300 , @xmath1 ) considered here , e.g.microcanonical , grand canonical , isothermal - isobaric , etc ? presumably , the role of the helmholtz free energy @xmath284 would then be played by other thermodynamic potentials , for instance the gibbs free energy in the case of the isothermal - isobaric ensemble .",
    "i would like to thank j.e .",
    "hunter iii , w.p .",
    "reinhardt , and j. tams for sharing with me the results of unpublished numerical simulations .",
    "these discussions have contributed significantly to my understanding of the practical problems likely to arise when applying the central result of this paper to the computation of @xmath17 in complicated systems .",
    "this work was supported by the polish - american maria skodowska - curie joint fund ii , under project paa / nsf-96 - 253 .",
    "in this appendix we present a derivation of eq.[eq : dgdt ] different from the one given in section [ sec : deriv ] .    for a given stochastic trajectory @xmath23 , the work @xmath6 is given by a path integral along that trajectory ( eq.[eq : work ] ) .",
    "we are interested in evaluating the average of @xmath70 over an ensemble of trajectories , obtained by sampling initial conditions from a canonical ensemble and then evolving stochastically from each of these initial conditions . the quantity @xmath301 thus constitutes a `` sum over all paths '' , with each path @xmath23 in our ensemble weighted by the factor @xmath70 .",
    "we may write this as @xmath302\\ , \\exp -\\beta w,\\ ] ] where @xmath303 denotes a measure in the space of paths @xmath23 ; @xmath304 $ ] denotes the probability density ( with respect to this measure ) of choosing @xmath23 by sampling randomly from the ensemble of trajectories ; and @xmath305 $ ] ( as per eq.[eq : work ] ) .",
    "let us now divide the time interval @xmath306 $ ] into @xmath146 time steps of duration @xmath307 , and let us denote a particular trajectory @xmath23 by its phase space locations @xmath308 at times @xmath309 , @xmath310 .",
    "thus , @xmath311 the limit @xmath179 ( with @xmath8 fixed ) is implied . choosing a euclidean measure in path space ,",
    "@xmath312 the probability density for a particular path is @xmath313 =   p({\\bf z}_0 ) p_{\\lambda_1}^{\\delta t}({\\bf z}_0\\vert{\\bf z}_1 ) p_{\\lambda_2}^{\\delta t}({\\bf z}_1\\vert{\\bf z}_2 ) \\cdots p_{\\lambda_n}^{\\delta t}({\\bf z}_{n-1}\\vert{\\bf z}_n).\\ ] ] here , @xmath314 is the probability distribution for the initial condition @xmath171 ; @xmath315 is the transition probability from @xmath44 to @xmath85 ( in time @xmath316 ) as a function of @xmath0 ; and @xmath317 . it is the markov assumption which allows this factorization . the work @xmath6 may be expressed as @xmath318 =   \\sum_{n=1}^n\\ ,",
    "\\delta h_n({\\bf z}_{n-1}),\\ ] ] where @xmath319 . [ in writing eqs.[eq : prob ] and [ eq : appwork ] we implicitly assume that @xmath51 evolves in @xmath146 discrete steps @xmath320 which occur at times @xmath321 .",
    "this `` staircase '' evolution becomes @xmath225 in the limit @xmath179 . ]    combining eqs.[eq : pathsum ] to [ eq : appwork ] , we arrive at @xmath322\\,p({\\bf z}_0 ) e^{-\\beta\\delta h_1({\\bf z}_0 ) } p_{\\lambda_1}^{\\delta t}({\\bf z}_0\\vert{\\bf z}_1 ) \\cdots e^{-\\beta\\delta h_n({\\bf z}_{n-1 } ) } p_{\\lambda_n}^{\\delta t}({\\bf z}_{n-1}\\vert{\\bf z}_n).\\ ] ]    let us now introduce @xmath323\\,p({\\bf z}_0 ) e^{-\\beta\\delta h_1({\\bf z}_0 ) } p_{\\lambda_1}^{\\delta t}({\\bf z}_0\\vert{\\bf z}_1 ) \\cdots e^{-\\beta\\delta h_m({\\bf z}_{m-1 } ) } p_{\\lambda_m}^{\\delta t}({\\bf z}_{m-1}\\vert{\\bf z}),\\ ] ] where @xmath324 .",
    "this is the discretized version of the function @xmath81 introduced in the main body of the text : @xmath325 in particular , note that @xmath326 .",
    "this set of functions @xmath327 satisfy the recursion relation @xmath328 now , to first order in @xmath316 , we have @xmath329 combining this with our recursion relation gives ( to leading order ) @xmath330 =   -\\beta\\,g_m({\\bf z})\\ , \\delta h_{m+1}({\\bf z})/\\delta t +",
    "\\int d{\\bf z}_m\\,g_m({\\bf z}_m ) \\,r_{\\lambda_{m+1}}({\\bf z}_m,{\\bf z}),\\ ] ] which becomes eq.[eq : dgdt ] in the limit @xmath179 .",
    "here we prove the assertion ( made in section [ sec : examp ] ) that eq.[eq : iden ] is identically true when the switching process is carried out using the monte carlo method .",
    "some of the steps in the proof will be similar to those in appendix a , but the assumption @xmath179 will not be made here .    as mentioned in section [ sec : examp ] , a trajectory @xmath197 is obtained by alternating discrete changes in the value of @xmath0 with random jumps in phase space generated by the mc algorithm .",
    "this algorithm  parametrized by the value of @xmath0  takes as input a point @xmath85 , and outputs a point @xmath44 .",
    "let @xmath331 denote the probability of generating an output @xmath44 from an input @xmath85 , for a given value of @xmath0 .",
    "detailed balance is built into the algorithm : @xmath332 for any @xmath0 .",
    "( this may be accomplished by , e.g. , the metropolis method@xcite . )",
    "thus , a canonical distribution of inputs @xmath85 gives a canonical distribution of outputs @xmath44 .",
    "the probability of obtaining a particular trajectory @xmath197 over the course of the entire switching process is then @xmath333 combining this with eq.[eq : dwork ] for the work , we get @xmath334\\,{1\\over z_0 } e^{-\\beta h_0({\\bf z}_0 ) } e^{-\\beta\\delta h_1({\\bf z}_0 ) } p_{\\lambda_1}({\\bf z}_0\\vert{\\bf z}_1 ) \\cdots e^{-\\beta\\delta h_n({\\bf z}_{n-1 } ) } p_{\\lambda_n}({\\bf z}_{n-1}\\vert{\\bf z}_n),\\ ] ] where @xmath335 .",
    "now notice that @xmath336 can be combined with @xmath337 to give @xmath338 .",
    "the only other factor in the integrand which depends on @xmath171 is @xmath339 .",
    "performing the integral @xmath340 , we get @xmath341 using eq.[eq : mcdb ] .",
    "this takes care of the first of the @xmath342 integrals appearing in eq.[eq : long ] .",
    "we now repeat this process , first combining @xmath343 ( obtained from the @xmath344 integration ) with @xmath345 to get @xmath346 , then integrating over @xmath175 , and so forth . at the end of this process of `` rolling up '' the factors and integrating , we are left with @xmath347 q.e.d .",
    "note that eq.[eq : goft ] for @xmath81 , derived within the framework of continuous - time evolution , also has a monte carlo counterpart .",
    "namely , for @xmath324 , let us define @xmath348 where @xmath349 gives the probability of sampling a particular sequence of phase space points in the first @xmath192 monte carlo steps , and @xmath350 is the work accumulated during those steps .",
    "thus , in terms of our ensemble of mc trajectories , @xmath351 is the weighted phase space density after @xmath192 steps , where the weight assigned to each trajectory is @xmath352 .",
    "then , writing an explicit expression for @xmath349 in the form given by eq.[eq : tprob ] , and rolling up factors and integrating as above , it follows easily that @xmath353              we assume these initial conditions regardless of whether or not the thermalization assumption mentioned above is met . thus even if , for instance , the system is isolated during the switching process , we still assume that it was earlier allowed to thermalize with some heat reservoir .                for reviews and reference books ,",
    "see t.p.straatsma and j.a.mccammon , annu.rev.phys.chem .  *",
    "43 * , 407 ( 1992 ) ; m.karplus and g.a.petsko , nature * 347 * , 631 ( 1990 ) ; d.l.beveridge and f.m.dicapua , annu.rev.biophys.biophys.chem .",
    "* 18 * , 431 ( 1989 ) ; c.l.brooks iii , m.karplus , and b.m.pettitt , adv.chem.phys .",
    "* 71 * , 1 ( 1988 ) ; _ simulations of liquids and solids _ , d.frenkel , i.r.mcdonald , g.ciccotti , eds . , chapter 2 ( north - holland , amsterdam , 1986 ) ; d.frenkel and b.smit , _ understanding molecular simulation : from algorithms to applications _ , chapter 7 ( academic press , boston , 1996 ) .",
    "this is easy to see : typically sampled values of @xmath6 are those within a standard deviation or so of the maximum of @xmath208 , while the values of @xmath6 which are most important in determining @xmath301 are those near the maximum of @xmath354 . as a general rule , the two sets will overlap significantly only if the function @xmath70 does not change much over one standard deviation in @xmath6 ."
  ],
  "abstract_text": [
    "<S> it has recently been shown that the helmholtz free energy difference between two equilibrium configurations of a system may be obtained from an ensemble of _ finite - time _ ( nonequilibrium ) measurements of the work performed in switching an external parameter of the system . here </S>",
    "<S> this result is established , as an identity , within the master equation formalism . </S>",
    "<S> examples are discussed and numerical illustrations provided . </S>"
  ]
}