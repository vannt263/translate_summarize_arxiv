{
  "article_text": [
    "quantum key distribution ( qkd ) allows two authenticated users , normally referred to as alice and bob , to generate a private key through an insecure quantum channel controlled by an eavesdropper , eve @xcite .",
    "based on fundamental laws in quantum mechanics , idealized qkd protocols have been proved to be unconditionally secure against adversaries with unlimited computing power and technological capabilities @xcite . however",
    ", practical implementations of qkd protocols unavoidably contain imperfections which may be overlooked in the security proofs .",
    "the disconnection between qkd theory and its real - life implementations has led to various `` side - channel '' attacks @xcite .",
    "one natural solution to the above side - channel attacks is to develop security patches @xcite .",
    "in fact , once a security loophole has been identified , normally it is not too difficult to develop countermeasures to regain the security .",
    "this approach is appealing in practice since it typically can be realized by slightly modifying either the qkd protocol or its implementation , and the resulting key rate could be comparable with that of the original protocol .",
    "however the security can only be proved against known attacks .    another important approach to enhance the security of practical qkd is to develop qkd protocols based on `` untrusted '' device @xcite . among them , the measurement - device - independent ( mdi ) qkd protocol @xcite , has received much attention @xcite .",
    "the mdi - qkd protocol is automatically immune to all side - channel attacks associated with the measurement device which , arguably , is the weakest link in a qkd system .",
    "in fact , the measurement device in mdi - qkd can be treated as a `` black box '' which could even be manufactured and operated by eve .",
    "the feasibility of mdi - qkd has been demonstrated experimentally @xcite .",
    "see @xcite for a recent review .",
    "one drawback of mdi - qkd is the relatively low secure key rate comparing with conventional qkd , such as the decoy - state bb84 protocol .",
    "this is because in most of existing mdi - qkd protocols ( except @xcite ) , secure keys are generated from two - fold coincidence detection events .",
    "the mdi - qkd suffers more from the low detection efficiency of a practical single - photon detector ( spd ) , especially when the finite data size effect is taken into account @xcite .",
    "recently a new qkd protocol , designed to bridge the strong security of mdi - qkd with the high efficiency of conventional qkd , was proposed by several groups @xcite . in this protocol",
    ", the legitimate receiver employs a trusted linear optics network to encode information on photons received from an insecure quantum channel , and then performs a bell state measurement ( bsm ) using untrusted detectors",
    ". one important advantage of this approach is the high key rate comparable with that of a conventional qkd protocol .",
    "this is achieved by replacing the probabilistic two - photon bsm scheme in the original mdi - qkd protocol @xcite by a deterministic single - photon bsm scheme .",
    "following @xcite , we call this new protocol `` detector - device - independent '' ( ddi ) qkd .    in this paper , we scrutinize the underlying assumptions behind ddi - qkd .",
    "one crucial assumption is that the untrusted bsm located inside the receiver s laboratory can not send any `` unwanted '' information to the outside . here",
    ", we show that if the bsm is completely untrusted , a simple scheme would allow the bsm to send information to the outside without being detected : eve can place high - efficiency detectors inside the bsm and program it to selectively report a fraction of the total detection events to simulate practical low - efficiency detectors .",
    "the time delay between adjacent reported events can be used by the bsm to send information .",
    "combined with trojan horse attacks , this scheme could allow eve to gain information of the secure key without introducing any errors .",
    "our results suggest that to establish the security of ddi - qkd , additional assumptions on the measurement device are required .",
    "it is thus very important to clearly spell out those assumptions and place them under scrutiny .",
    "this paper is organized as follows : in section [ sec:2 ] , we briefly review the basic ideas of mdi - qkd and ddi - qkd . in section [ sec:3 ] , we present the details of our attack .",
    "we conclude this paper with a discussion in section [ sec:4 ] .",
    "in a conventional qkd protocol ( see fig.1a ) , alice prepares quantum states and sends them to bob through an insecure quantum channel .",
    "bob receives signals from the quantum channel and performs measurement . in this configuration , it is reasonable to assume that the errors in quantum state preparation can be well controlled and quantified , since this can be done within alice s well protected laboratory without eve s interference . on the other hand ,",
    "the quantum states received by bob are highly unpredictable , since eve could replace alice s quantum states by anything at her will .",
    "eve can interfere the measurement process by either manipulating alice s signal @xcite or sending her own signals into bob s laboratory @xcite .",
    "the above observation could explain why most identified security loopholes in conventional qkd are associated with the measurement device @xcite .",
    "the motivation behind mdi - qkd @xcite is to develop a qkd protocol which is automatically immune to all detector side - channel attacks . in this scheme",
    "( see fig.1b ) , both alice and bob prepare quantum states and send them to an untrusted third party , charlie , who could be a collaborator of eve .",
    "charlie is supposed to measure the correlation between alice s and bob s quantum states and publicly announce the measurement results . given charlie s measurement results , alice and bob can further establish a secure key .",
    "the protocol has been designed in such a way that `` only '' the correlation ( but not the quantum states themselves ) can be determined by charlie faithfully . on one hand , if charlie executes the protocol honestly , he or eve can not gain any information of the secure key .",
    "on the other hand , any attempts by charlie to gain information of the secure key will unavoidably introduce additional noise and can be detected by alice and bob .",
    "the security of mdi - qkd is based on the idea of time - reversed epr qkd @xcite . by allowing eve to fully control the measurement device",
    ", alice and bob can establish a secure key without making any assumptions about how the measurement device works , thus removing any potential detector side - channels .",
    "we remark that mdi - qkd is an ideal building block of multi - user qkd networks , where the expensive measurement device can be placed in an untrusted central node while each qkd user only needs a low - cost state preparation device @xcite .",
    "recently ddi - qkd has been proposed to bridge the strong security of mdi - qkd with the high efficiency of conventional qkd @xcite . for simplicity , in this paper",
    "we assume that a perfect single photon source is employed by alice . in ddi - qkd ( fig.1c )",
    ", alice prepares a single - photon pulse in one of the four bb84 polarization states and sends it to bob through an insecure quantum channel . on receiving the signals",
    ", bob employs a `` trusted '' linear optics network ( lon ) to encode his information on a different ( for example , spatial ) degree of freedom of the incoming signals .",
    "afterwards , the above signals are fed into an `` untrusted '' bsm device which is supposed to perform a single - photon bsm @xcite and report the measurement results to bob . through an authenticated classical channel ,",
    "bob announces which transmitted signals have yielded successful bsm detection events , the bell states obtained , and the basis information associated with those successful events .",
    "alice and bob estimate the quantum bit error rate ( qber ) for the events when they happen to use the same basis . if the qber is below certain threshold , they can further apply error correction and privacy amplification to generate a secure key .",
    "note in fig.1c , the untrusted bsm inside bob s laboratory is represented by a `` black box '' , which is controlled by eve s partner ( fred ) during the qkd process .",
    "in ddi - qkd , bob s encoding device ( lon in fig.1c ) sits between eve and fred . in practice , this design could be prone to trojan horse attacks .",
    "we remark that the threats of trojan horse attacks in conventional qkd and the corresponding countermeasures have been studied previously @xcite . in conventional qkd , eve can only access one end of each user s device . to launch a trojan horse attack , eve can send bright light pulses into the user s system and tries to gain information by measuring the back - reflected light . in practice",
    ", the qkd users can effectively reduce the risk of trojan horse attack by using filters , optical circulators , isolators , and intensity monitors , etc .",
    "however , these countermeasures may not be effective in the case of ddi - qkd , where eve and fred together can access both ends of bob s encoding device .",
    "for example , in each quantum transmission , eve could send her own signal ( which may contain a few photons ) together with alice s photon into bob s laboratory .",
    "both alice s and eve s signals go through bob s encoding device and reach the bsm . inside the bsm , fred could determine bob s bit information precisely by measuring the signal sent by eve . in the meantime",
    "fred can perform an honest bell state measurement on alice s photon . in principle",
    ", fred can have a perfect copy of bob s random bits without introducing any errors .    at this point , security is not compromised since fred is confined within bob s laboratory .",
    "to prevent fred from sending bob s random bits to eve , a crucial assumption is made in ddi - qkd @xcite : fred is only allowed to report the bsm results to bob ; he can not send any `` unwanted '' information to the outside .",
    "however , it could be difficult to justify the above assumption in practice .",
    "below we will show that if the bsm is completely untrusted ( as in the case of mdi - qkd ) , a simple scheme would allow the untrusted bsm to send information to eve . combined with trojan horse attacks discussed above",
    ", this scheme could allow eve to gain information of the final key without being detected .",
    "a practical single photon detector ( spd ) at telecom wavelength has a relatively low detection efficiency ( typically @xmath0 ) . on the top of that ,",
    "all the optical components inside a practical bsm introduce additional losses . under normal operation , bob would expect a low detection rate : most of the time , the bsm will report `` no detection '' ; occasionally , the bsm will report a successful bsm result .",
    "however , eve could place spds with much higher efficiency inside the bsm . in this case , the actual detection rate seen by fred will be much higher than the one expected by bob .",
    "fred can easily simulate a low - efficiency bsm by reporting to bob a small fraction of the total detection events .",
    "he can further take advantage of this `` post - selection '' process to send information to eve .",
    "suppose fred successfully detects the @xmath1 signal sent by alice ; in the meantime , through the trojan horse attack , he also learns bob s bit information corresponding to the same transmission .",
    "fred reports the bsm result to bob honestly .",
    "he also determines the index number @xmath2 of the next bsm result to be reported based on the following rules : if bob s @xmath1 bit value is @xmath3 ( or @xmath4 ) , fred will report a bsm result to make sure that @xmath5 is an even ( or odd ) number .",
    "in other words , fred encodes bob s random bits on the time delays between adjacent bsm results reported to bob .",
    "when bob publicly announces which signals from alice have been detected , eve can decode fred s information and have a perfect copy of bob s random bits .",
    "since fred performs bsm on alice s signals and reports the measurement results to bob honestly , this attack will not introduce additional errors . to further conceal their attack , eve and fred can use pre - shared random numbers to determine whether an even or an odd number is used to encode bit @xmath3 for each reported bsm event .",
    "fred can also carefully control the reporting rate to match it with the one expected by bob .",
    "this attack , in its spirit , is similar to the memory attack on device - independent ( di ) qkd @xcite , which might be applicable whenever an untrusted device is placed inside alice s or bob s secure laboratory . on the other hand ,",
    "our attack is more feasible since fred does not need to access the classical communication channel between alice and bob .",
    "all his activities are confined within the untrusted bsm , as assumed in ddi - qkd .",
    "to prevent the above attack , bob could introduce various countermeasures to detect trojan horse attacks , as suggested in @xcite . in practice , additional filtering and random sampling systems",
    "could be introduced into bob s system to characterize the input signals and mitigate the risk of trojan horse attacks .",
    "however , it is very challenging in practice to implement single - mode filtering .",
    "moreover , additional spds could be required to implement the above countermeasures .",
    "these spds may also suffer from the same side - channel attacks as the spds for secure key generation .",
    "another approach to prevent the above attack is to make additional assumptions about the bsm device @xcite .",
    "instead of treating the bsm device as a completely `` black box '' , as we have assumed above , bob could build the bsm himself and know what is inside the bsm . in this case",
    ", it may be possible to prove security without perfectly modeling the exact behavior of the bsm .",
    "nevertheless , all the assumptions made about the bsm should be clearly specified and be placed under scrutiny . to highlight this point",
    ", we consider the detector blinding attack , which has been successfully demonstrated in conventional qkd systems @xcite .",
    "the basic idea of the detector blinding attack is as follows @xcite .",
    "first , eve sends bright light into bob s system to force the spds into the so - called linear operation mode . in this mode ,",
    "the detector remains sensitive to bright light with a classical optical power threshold @xmath6 .",
    "second , eve performs an intercept and resend attack : she intercepts alice s signal , measures it in a randomly chosen basis , and resends a bright pulse to bob according to her measurement result .",
    "the peak power of the bright pulse is just above @xmath6 .",
    "if bob and eve happen to use the same basis , the bright pulse will be conveyed to one detector and a `` click '' will be registered .",
    "otherwise , the optical power of the bright pulse will be distributed between two spds and no detector clicks .",
    "equivalently , eve has control of bob s measurement basis and it is easy to show that in principle eve can learn the whole key without introducing errors .    the detector blinding attack could also be applied in ddi - qkd if there are certain overlooked imperfections in the bsm .",
    "although the actual implementations of the bsm in @xcite are slightly different , all of them employ four spds to deterministically identify the four bell states , @xmath7 , as shown in fig.2 . in normal qkd operation , if alice and bob use the same basis , only two out of the four spds have non - zero probability ( @xmath8 each in the ideal case ) to detect a photon . on the other hand ,",
    "if alice and bob use different bases , all the four spds have non - zero probability ( @xmath9 each in the ideal case ) to click .",
    "suppose eve launches the detector blinding attack described above .",
    "the optical power of eve s bright pulse will be distributed either between two spds ( if eve and bob use the same basis ) or among four spds ( if they use different bases ) . by carefully controlling the power of the bright pulse , eve can make sure that bob can register a detection event only when they use the same basis .",
    "the above attack can be easily detected if the beam splitters in the bsm are symmetric and all the spds are identical .",
    "this is because when bob and eve use the same basis , the optical power of eve s bright pulse will be evenly distributed between two spds and result in an unusually high double - click rate @xcite .",
    "however , if we allow certain uncharacterized imperfections in the bsm , eve could refine her attack to make it undetectable .",
    "for example , if the spds have different wavelength - dependent efficiencies , then eve could reduce the double - click rate by tailoring the wavelength of her bright pulse . to rule out the possibility of the detector blinding attack in ddi - qkd , we need to quantify the imperfections inside the bsm carefully , or introduce other countermeasures .    in summary , to improve the security of qkd in practice , various qkd protocols , including di - qkd , mdi - qkd and ddi - qkd , have been proposed .",
    "each of them has its own advantages and drawbacks , and might be best for certain applications . in this paper , we investigate some underlying assumptions in ddi - qkd .",
    "our results show that if the bsm in ddi - qkd is completely untrusted , a simple attack could allow eve to gain information of the quantum key without being detected . to prevent the above attack",
    ", either countermeasures to trojan horse attacks or some trustworthiness to the `` untrusted '' bsm device is required .",
    "all these details should be clearly specified and included in the security analysis .",
    "i would like to thank marcos curty for very helpful discussions .",
    "this work was performed at oak ridge national laboratory , operated by ut - battelle for the us department of energy under contract no .",
    "de - ac05 - 00or22725 ."
  ],
  "abstract_text": [
    "<S> measurement - device - independent quantum key distribution ( mdi - qkd ) protocol has been demonstrated as a viable solution to detector side - channel attacks . </S>",
    "<S> one of the main advantages of mdi - qkd is that the security can be proved without making any assumptions about how the measurement device works . </S>",
    "<S> the price to pay is the relatively low secure key rate comparing with conventional qkd , such as the decoy - state bb84 protocol . to bridge the strong security of mdi - qkd with the high efficiency of conventional qkd , a new type of qkd protocol </S>",
    "<S> , the detector - device - independent ( ddi ) qkd has been proposed recently . in this protocol , the legitimate receiver employs a trusted linear optics network to encode information on photons received from an insecure quantum channel , and then performs a single - photon bell state measurement ( bsm ) using untrusted detectors . </S>",
    "<S> one crucial assumption made in ddi - qkd is that the untrusted bsm located inside the receiver s laboratory can not send any unwanted information to the outside . here </S>",
    "<S> , we show that if the bsm is completely untrusted and the expected detection efficiency is low , a simple scheme would allow the bsm to send information to the outside : a sophisticated eavesdropper ( eve ) can place high - efficiency detectors inside the bsm and program it to selectively report a fraction of the total detection events to simulate low - efficiency detectors . </S>",
    "<S> the time delay between adjacent reported events can be used by the bsm to send information . </S>",
    "<S> combined with trojan horse attacks , this scheme could allow eve to gain information of the quantum key without being detected . to prevent the above attack , either countermeasures to trojan horse attacks or some trustworthiness to the `` untrusted '' bsm device is required . </S>"
  ]
}