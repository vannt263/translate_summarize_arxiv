{
  "article_text": [
    "a classical problem of modern high - dimensional statistics is multiple testing in the presence of background noise .",
    "applications are common in the areas of neuroimaging , genomic arrays and astronomy .",
    "these issues become particularly challenging when the background noise is allowed to exhibit more realistic properties than the simple @xmath0 framework , in particular when noise is modeled as a stochastic process or a random field . in this",
    "setting , important progresses have been recently obtained combining ideas from two different streams of research , namely techniques from the multiple testing literature , such as false discovery rate ( fdr ) algorithms , and techniques to investigate excursion probabilities and local maxima for random fields ; we refer for instance to @xcite for further background and discussion .",
    "these works have covered applications in a univariate and multivariate euclidean setting ; analytic properties have been derived under a large sample asymptotic framework , i.e. , under the assumption that the domain of observations is growing steadily , together with the signals to be detected .    in this paper",
    "we introduce a related multiple testing procedure in a setting that is different from the standard euclidean / large same asymptotic framework , yet highly relevant to realistic experimental circumstances for some important areas of application in astronomy .",
    "more precisely , we shall focus on cases where a single realization of a smooth isotropic gaussian random field on the sphere is observed , and a number of well - localized signals are superimposed on such background field .",
    "this is exactly the setting for the so - called point - source detection issue in cosmic microwave background radiation ( cmb ) data experiments ( see i.e. , @xcite ) .",
    "as discussed now in any modern textbook in cosmology ( see for instance @xcite ) , cmb data can be viewed as a single realization of an isotropic gaussian random field , which represents a snapshot \" of the universe at the _",
    "last scattering surface , _ i.e. the time ( approximately @xmath1 years after the big bang , or @xmath2 years ago ) when photons decoupled from electrons and protons and started to travel nearly without interactions in space . as such",
    ", cmb has been repeatedly defined as a goldmine of information on cosmology - two very successful satellite experiments ( wmap from nasa , see http://map.gsfc.nasa.gov/ and planck from esa , see http://www.esa.int/our_activities/space_science/planck ) have now produced full - sky maps of cmb radiations , and these data have been used in several thousand papers over the last few years to address a number of fundamental questions on the dynamics of the big bang , the matter - energy content of the universe , the mechanisms of structure formation , and several others .    from the experimental point of view , it is very important to recall that , superimposed  to cmb radiation , a number of foreground contaminants \" are present ; as a first approximation , we can view them as point - like objects ( galaxies or clusters of galaxies , typically ) .",
    "a major statistical challenge in the analysis of cmb data is the proper identification of such sources ; on the one hand this is important for the proper construction of filtered cmb maps , on the other hand these sources are of great interest on their own as proper astrophysical objects ( in some cases they can be matched with existing catalogues , while in other cases they lead to new discoveries ) .",
    "a number of algorithms have been proposed for these tasks , see for instance @xcite .",
    "these solutions have all been shown to perform well in practice ; however , they have all avoided to face the specific challenges of multiple testing , and in particular none of them has been shown to control in any proper statistical way any aggregate statistics such as the classical family - wise error rate ( fwer ) , false discovery proportion ( fdp ) or false discovery rate ( fdr ) .",
    "our purpose in this paper is to develop in such a spherical framework a rigorous statistical procedure to control error rates in a multiple testing framework .",
    "our starting idea is to extend to these circumstances the smoothing and testing of maxima ( stem ) algorithm advocated in @xcite , and investigate rigorously its statistical properties .",
    "while our construction follows in several ways what was earlier done by these authors , we wish to stress that the new spherical framework poses some major technical and foundational new challenges .",
    "the first of these new challenges is the proper definition of filters and point - like signals in a spherical framework . here",
    ", natural solutions can be found by exploiting recent developments in the analysis of spherical random fields an spherical wavelets . in particular",
    ", we can define bell - shaped signals by adopting a natural definition of a gaussian distribution on the sphere , motivated in terms of diffusion processes ; likewise , filtering can be implemented by wavelet techniques - we find particularly convenient the mexican needlet construction introduced by @xcite , see also @xcite for some earlier applications to cmb data .    a second , more delicate , issue is the rigorous investigation of asymptotic statistical properties .",
    "a crucial staple of the stem algorithm is the possibility to control the fdr , assuming convergence of the empirical distribution of the maxima to its theoretical counterpart . in standard settings",
    "this can be done by resorting to ergodicity properties in a ",
    "large sample asymptotics \" framework , i.e. assuming that the domain of the observations grows larger and larger .",
    "this form of ergodic properties can not be exploited here because our spherical domain is compact .",
    "we shall hence require a convergence result on the empirical distribution of maxima in a high - frequency / fixed domain setting : this result extends to the case of the needlet transform some related computations which were recently performed in @xcite for the case of random spherical harmonics .",
    "in this sense , our setting is related to the increasingly popular fixed - domain asymptotics approach for the analysis of random fields , see i.e. , @xcite .",
    "the plan of this paper is as follows .",
    "our basic setting and model is introduced in section [ s : themodel ] , with section [ s : filtering ] devoted to a careful discussion on the nature and effects of filtering .",
    "section [ s : multipletesting ] provides a description of the multiple testing scheme and discusses the error and power definitions , including the derivation of asymptotic @xmath3-values and our adoption of benjamini and hochberg s ( 1995 ) pioneering approach @xcite .",
    "the proofs of fdr control and tests consistency are collected in section [ s : prooffdr ] , while in section [ numerical ] we provide some numerical results on the empirical performance of the proposed procedures in simulated cmb fields .",
    "finally , two ( long ) appendixes provide a large part of the proofs , in particular , the details of the high frequency ergodicity of the empirical distribution function of local maxima .    for clarity of exposition and concreteness of motivations , throughout the paper",
    "we mainly justify our framework resorting to applications in a cosmological framework ; it is to be stressed , however , that our approach may be applied to many other experimental contexts where data are collected on a sphere , such as geophysics , atmospheric sciences , solar physics , and even ( with some approximations ) neuroimaging , to mention only a few .",
    "this research was supported by the erc grant n.277742 _ pascal _ ( pi domenico marinucci ) ; we are grateful to igor wigman for many insights and suggestions on the computation of variances of critical points .",
    "corresponding author : valentina cammarota , department of mathematics , university of rome tor vergata , via della ricerca scientifica , 1 , i-00133 , italy , cammarot@mat.uniroma2.it .",
    "the purpose of this section is to introduce our model in detail .",
    "as motivated above , our purpose here is to represent a situation where a large number of point sources `` is superimposed on some isotropic background noise '' .",
    "of course , the notions of noise `` and signal '' , here as in any other motivating field , is very much conventional .",
    "for instance , in the cmb - related applications that we have in mind the background gaussian field is eventually the primary object of physical interest for many ( most ) researchers , while the super - imposed point sources are contaminants to be removed ; in other astrophysical areas , on the contrary , the identification of the sources may be by itself a major scientific goal ( a very recent catalogue of detected point sources / astrophysical objects is given for instance by @xcite ) .      to introduce our model for the signal ,",
    "we first need to justify the notion of a gaussian - shaped \" density on the sphere .",
    "we do this in terms of the diffusion equation on the sphere .",
    "more formally , let @xmath4 denote the unit sphere in @xmath5 .    the diffusion equation on the sphere is then given by@xmath6 where @xmath7 is the laplacian operator in @xmath4 and @xmath8 identifies formally a dirac s delta function centered at @xmath9 .",
    "it is standard to write the solution in terms of diffusion operators as @xmath10 where @xmath11 denotes the set of eigenvalues of the spherical laplacian , @xmath12 while @xmath13 represents the family of legendre polynomials@xmath14i.e . ,",
    "@xmath15 , @xmath16 , @xmath17 , etc . , and @xmath18 denotes inner product on @xmath19 by a straightforward analogy with the euclidean case , it is natural / customary to view @xmath20 as the density on @xmath4 of a spherical gaussian \" centred on @xmath21 and having variance @xmath22 .",
    "our point source \" signal will be built from a set of such bell - shaped distributions , localized on some family of points @xmath23 , @xmath24 , belonging to @xmath4 ; we shall allow later their number to grow ( @xmath25 as @xmath26 , where @xmath27 is the frequency ) , and their shape to become more and more localized ( @xmath28 as @xmath29 .",
    "these conditions can be understood by an analogy with the ( now standard ) high - dimensional asympotics framework where the number of parameters is allowed to grow to infinity in the presence of growing number of observations ; likewise , we consider a growing number of sharper and sharper sources as the resolution of our experiments grow better and better , or equivalently as the scales that we are able to probe become smaller and smaller .",
    "it should be noted that , in the absence of these conditions , all our procedures to follow have properties that can be trivially established : in particular , the power of our detection procedures is very easily seen to converge to unity .",
    "more explicitly , we believe that our setting is meaningful and relevant as a guidance for applied scientists ; indeed , in many circumstances ( such as the cmb data analysis framework that we mentioned several times ) the number of tests to implemented ( i.e. , the number of possible galactic sources ) is in the order of several thousands , so it seems more useful to consider this quantity as diverging to infinity together with the number of observations .",
    "we can hence introduce the following sequence of signal - plus - noise models , for @xmath30 @xmath31where the @xmath32 denotes a sequence of deterministic functions on the sphere defined by @xmath33and @xmath34 is the family of spherical gaussian distributions \" on @xmath4 ( centred on @xmath23 and with variance @xmath35 which we introduced above by means of the heat kernel on @xmath4 , i.e. , @xmath36as mentioned earlier , we will set @xmath37 as @xmath38 , so that each kernel @xmath34 will become in the limit more and more concentrated around its center @xmath39 .",
    "let us now focus on the noise \" component @xmath40 here , we need to recall briefly a few standard facts on the harmonic representations of isotropic , finite variance spherical random fields .",
    "in particular , let us assume that @xmath41 is gaussian , zero - mean and isotropic , meaning that the probability laws of @xmath42 and @xmath43 are the same for any rotation @xmath44 . for such fields , it is well - known that the following representation holds in the mean square sense ( see for instance leonenko2 , @xcite ) : @xmath45 where @xmath46 denotes the family of spherical harmonics ( see for instance @xcite , chapters 3 and 5 ) , and @xmath47 denotes the array of random spherical harmonic coefficients , which satisfy @xmath48here , @xmath49 is the kronecker delta function , and the sequence @xmath50 represents the so - called angular power spectrum of the field . as pointed out in @xcite , under isotropy and finite - variance the sequence @xmath51 necessarily satisfies @xmath52 < \\infty $ ] and the random field @xmath53 is mean square continuous .",
    "its covariance function is given by @xmath54 = \\sum_{\\ell = 0}^{\\infty } \\frac{2\\ell + 1}{4\\pi } c_{\\ell } p_{\\ell } ( \\left\\langle x_{1},x_{2}\\right\\rangle ) , \\qquad x_{1},x_{2}\\in { \\mathbb{s}}^{2}.\\]]the fourier components @xmath55 , can be viewed as random eigenfunctions of the spherical laplacian:@xmath56the asymptotic behaviour of @xmath57 and their nonlinear transforms has been studied for instance by @xcite , @xcite and @xcite .",
    "an important step in the implementation of the stem algorithm is kernel smoothing of the observed data .",
    "given the very delicate nature of the asymptotic results in our setting , the definition of the kernel function requires here special care .",
    "we shall propose here to adopt a kernel which is based upon the so - called mexican needlet construction introduced by @xcite , see also @xcite for the investigation of stochastic properties and statistical applications of these techniques .",
    "mexican needlets can be viewed as a natural development of the standard needlet frame which was introduced by @xcite .",
    "loosely speaking , mexican needlets differ from the standard needlet construction inasmuch as they allow for providing a kernel which is unboundedly supported in the harmonic domain ; they can hence be shown to enjoy better localization properties in the real domain , i.e. , faster ( gaussian rather than nearly exponential ) decay of their tails . for our purposes ,",
    "these better localization properties in the real domain turn out to be very important , as they allow a tight control of leakage in the signals .",
    "the mexican needlet transform of order @xmath58 can be defined by @xmath59here , the function @xmath60 is defined by @xmath61 with @xmath62 and it is easily seen to belong to the schwartz class ( i.e. , all its derivatives decay faster than any polynomial ) . the user - chosen integer parameter @xmath3 can be taken for simplicity to be equal to unity for all the developments that follow ; more generally , it has been shown that higher values of @xmath3 entail better properties in the harmonic domain , but worse real - space localization : in particular , a higher number of sidelobes ( see for instance @xcite for discussion and numerical evidence on these issues ) .",
    "let us now recall the standard addition theorem for spherical harmonics ( see @xcite , eq .",
    "3.42 ) @xmath63it is then easy to see that the  filtered noise \" is given by @xmath64 where the last line is due to ( [ specrap ] ) .",
    "on the other hand , for the  filtered signal \" we obtain @xmath65 in words , both the filtered noise and signals are averaged versions , in the harmonic domain , of ( random and deterministic , respectively ) fourier components . summing up",
    ", our kernel transform produces the sequence of smoothed fields @xmath66 our asymptotic theory will be developed in the so - called  high - frequency \" framework ; more precisely , we shall introduce the following assumptions .",
    "[ c : tn&bj ] we have that , as @xmath26@xmath67    in words , we are assuming that both the filter and the signal become more and more localized , the former more rapidly to make identification meaningful . before we discuss these assumptions , however ,",
    "we need to explore in greater detail the properties of these two components ; this task is implemented in the next two subsections .      for the analysis of the signal component",
    "@xmath68 it is convenient to introduce the simple approximation @xmath69where the second line can be easily justified resorting to condition c : tn&bj above .",
    "it is also known that the smoothing kernel @xmath70 , for any @xmath71 has gaussian tails ( up to a polynomial factor ) , and hence decays faster than exponentially ; more precisely one has that there exists a constant @xmath72 such that ( @xcite , @xcite , @xcite ) @xmath73where @xmath74 is the standard geodesic distance on the sphere and @xmath75 denotes the hermite polynomial of degree @xmath76 , which is defined by @xmath77the first few being @xmath78 , @xmath79 , @xmath80 ,",
    "... it is also possible to provide a useful analytic approximation for the functional form of the needlet filter at the highest frequencies @xmath81 indeed geller and mayeli ( 2009 ) @xcite proved the following .",
    "[ gellermayeli ] let @xmath82 and let @xmath83 be fixed .",
    "then as @xmath26 , @xmath84where @xmath85\\ ] ] and @xmath86 is the standard geodesic distance on the sphere .",
    "as a consequence , we have the following analytic expression for our signal when @xmath82 , as @xmath26 : @xmath87it is readily verified that the function @xmath88 has the global maximum @xmath89 and a local minimum @xmath90 .",
    "our next step is to focus on the sequence of filtered noise fields ; as derived above ( equation [ eq : betaj ] ) , they can be expressed as averaged forms of random spherical eigenfunctions , e.g. @xmath91it is convenient to normalize these fields to have unit variance , as follows : @xmath92 } } , \\qquad j=1,2,3,\\dots   \\label{eq : standardize}\\]]let us define also @xmath93}}=\\tilde{\\beta}_{j}+\\frac{\\mu _ { n , j}}{\\sqrt{{\\mathbb{e}}[\\beta _ { j , p}^{2}(x)]}}.   \\label{eq : signal+noise : norm}\\]]a rigorous investigation of the asymptotic properties of these smoothed fields requires some mild regularity assumptions on the power spectrum @xmath94 , which are customary in this branch of literature .",
    "more precisely ( see for instance @xcite , page 257 or @xcite ) ,    [ con]there exists @xmath95 and a function @xmath96 such that@xmath97where @xmath98 for all @xmath99 and for some @xmath100 and @xmath101 , we have @xmath102    condition [ con ] entails a weak smoothness requirement on the behaviour of the angular power spectrum , which is satisfied by cosmologically relevant models ; for instance , this condition is fulfilled by models of the form , where @xmath103 and @xmath104 are two positive polynomials of the same order . in what follows",
    "we denote by @xmath105 the limit @xmath106 .    under condition",
    "[ con ] , it is possible to establish an upper bound on the correlation function of @xmath107 , as follows ( for a proof see @xcite , @xcite ) .",
    "[ con1 ] assume conditions [ con ] holds with @xmath108 and @xmath109 ; then there exists a constant @xmath110 , not depending on @xmath27 , @xmath111 , and @xmath112 , such that the following inequality holds @xmath113where @xmath74 is the standard geodesic distance on the sphere .",
    "the inequality is qualitatively similar to others which were earlier established in the case of standard needlets ; see for instance @xcite .",
    "a quick comparison with the results in @xcite shows an important difference , namely that the rate of decay for the bound on the right - hand side depends on the shape of the kernel ( in particular , on the parameter @xmath3 ) and on the rate of decay of the angular power spectrum ( i.e. , on the parameter @xmath114 ) ; none of these values affect the rate of convergence in the standard needlet case . as a consequence , in the case of mexican needlets , asymptotic uncorrelation only holds under the assumption that @xmath115 so that higher values of @xmath3 are needed to ensure uncorrelation for larger values of @xmath116 we believe this issue can be easily addressed by a plug - in procedure ; for instance , for the cmb applications we mentioned earlier there are strong theoretical motivations and experimental constraints that allow to set @xmath117 so that taking @xmath82 is already enough to ensure the correlation function decays to zero : ample numerical evidence on the uncorrelation properties of mexican needlets is collected in @xcite .",
    "the term @xmath118 appearing in the denominator of is a consequence of some standard technical difficulties when dealing with boundary cases such as @xmath119 .",
    "of course , from proposition [ con1 ] it is immediate to obtain a bound on the covariance ( rather than correlation ) function , indeed we have @xmath120=\\sum_{\\ell = 1}^{\\infty } b^{2}\\big(\\frac{\\ell } { b^{j}};p\\big)c_{\\ell } \\frac{2\\ell + 1}{4\\pi } p_{\\ell } ( \\langle x , y\\rangle ) \\\\",
    "\\leq & \\frac{k_{m}}{(1+j^{-1}b^{j}d(x , y))^{4p+2-\\gamma } } \\sum_{\\ell = 1}^{\\infty } b^{2}\\big(\\frac{\\ell } { b^{j}};p\\big)c_{\\ell } \\frac{2\\ell + 1}{4\\pi } .\\end{aligned}\\ ] ] for the implementation of our multiple testing procedures , we shall need to write down an analytic formula for the asympotic distribution of maxima of the noise components ; to this aim , we need the exact limiting behaviour of higher - order derivatives of the covariance function , evaluated at the origin .",
    "let us first introduce the functions@xmath121for an isotropic gaussian field @xmath122 @xmath123 with covariance function @xmath124 we define @xmath125where @xmath126represent the derivatives of the legendre polynomials evaluated at 1 .",
    "let us write also @xmath127^{2}}{c^{\\prime \\prime } ( \\tilde{\\beta}_{j})}. \\label{eq : kappa}\\ ] ]    [ prop : kappa ] as @xmath128 we have@xmath129and therefore @xmath130where @xmath131 denotes lim@xmath132    we note that the expressions for @xmath133 and @xmath134 will be used in the applied sections below for the numerical evaluation of @xmath3-values .",
    "following the notation in @xcite , we have    @xmath135    and @xmath136indeed @xmath137}{8}=\\frac{\\ell ^{2}(\\ell + 1)^{2}}{8}-\\frac{\\ell ( \\ell + 1)}{4}.\\]]it is also convenient to introduce the notation @xmath138for which we have @xmath139likewise @xmath140 hence @xmath141and finally @xmath142 it follows that @xmath143and@xmath144yielding the desired results .",
    "in the sequel , we let @xmath145 ; all the results below can be trivially extended to choices of other forms of filtering , with different values of @xmath3 ( we stress that the case @xmath82 is the choice that has been usually adopted for applications , see @xcite ) .",
    "to properly approach the detection of point sources as a multiple testing problem , we first need to carefully define the spatial region occupied by the needlet - transformed point sources .",
    "we recall that in condition [ c : tn&bj ] we required that @xmath146 as @xmath26 , meaning that we work in a setting where signals get more and more concentrated in the asymptotic limit ; this is clearly a necessary condition for meaningful results , as we are going to handle an increasing number of signals ( and tests ) and , because we are working on a compact domain , in the absence of such increasing localization the problem would become entirely trivial ( the signal region would cover the sphere ) . at the same time , we required the kernel to concentrate as well , again to avoid an excessive leakage of signal which would make the whole approach meaningless .    to be more precise ,",
    "define the _ signal region _",
    "@xmath147 and _ null region _",
    "@xmath148 , where @xmath149 is a pre - specified location tolerance parameter and @xmath150 is the geodesic ball on @xmath4 with center @xmath23 and radius @xmath151 .",
    "the presence of a tolerance parameter is not only required to settle properly the theoretical framework , but is also consistent with the common scientific practice , see again @xcite , @xcite . we introduce now a further condition .",
    "[ tolerance ] as @xmath128 we have@xmath152 where @xmath153 and @xmath154 are positive constants .",
    "the first two lines of condition [ tolerance ] are meant to ensure that the tolerance radius @xmath155 decays to zero asymptotically faster than the distance between separate sources .",
    "otherwise proper identification and counting of point sources would become unfeasible .",
    "notice that the restriction @xmath156 in condition [ tolerance ] yields @xmath157 implying that the area of null region is always positive and that @xmath158 can not grow too fast , specifically @xmath159 .",
    "it is easy to check that @xmath160    here are some examples for condition [ tolerance ] .",
    "if @xmath161 for some @xmath162 , then the area of signal region tends to 0 .",
    "if @xmath163 for some @xmath164 , then the area of signal region tends to @xmath165 .      as some general notation , for a smooth gaussian random field @xmath166 , define the number of local maxima of @xmath167 exceeding the level @xmath168 over a domain @xmath169 as @xmath170here @xmath171 and @xmath172 denote the gradient and hessian of the field @xmath167 at @xmath111 , and @xmath173 means the hessian @xmath172 is negative definite .",
    "the gradient and hessian can be computed as @xmath174 and @xmath175 , respectively , where @xmath176 and @xmath177 are orthonomal tangent vectors . in",
    "spherical coordinates @xmath178 ,",
    "@xmath179 , these are given by @xmath180 for convenience , denote by @xmath181 the total number of local maxima of @xmath167 over @xmath182 .",
    "suppose now we observe @xmath183 on @xmath4 defined by .",
    "the stem algorithm of @xcite takes in our case the following form .",
    "[ alg : stem ]    1 .",
    "_ kernel smoothing _ : apply the needlet transform to the observed field to obtain the filtered field . normalize by the ( known ) noise variance to obtain the field .",
    "_ candidate peaks _ : find the set of local maxima of @xmath184 on @xmath4 @xmath185 3 .   _ p - values _ : for each @xmath186 , compute the p - value @xmath187 for testing @xmath188 where @xmath189 is a geodesic ball centered at @xmath111 on the sphere and of radius equal to the tolerance radius @xmath190 .",
    "4 .   _ multiple testing _ : notice that @xmath191 is the number of tested hypotheses .",
    "perform a multiple testing procedure on the set of @xmath192 p - values @xmath193 , and declare significant all local maxima whose p - values are smaller than the significance threshold .    next , we carefully define detection errors and power for this testing scheme .",
    "now , for fixed @xmath168 , denote by @xmath194 the set of local maxima exceeding @xmath195 defined via . define the total number of detected peaks and the number of falsely detected peaks as @xmath196respectively .",
    "both are defined as zero if @xmath194 , is empty . as usual",
    ", the false discovery proportion ( fdp ) is proportion of falsely detected peaks , i.e. @xmath197while the false discovery rate ( fdr ) is the expected fdp , i.e. @xmath198we shall denote @xmath199 .",
    "finally , again following the same conventions as in @xcite , @xcite , we define the power of algorithm [ alg : stem ] as the expected fraction of true discovered peaks @xmath200where @xmath201 is the probability of detecting peak @xmath202 @xmath203the indicator function in ensures that only one significant local maximum is counted within the same peak support , so power is not inflated .",
    "given the observed heights @xmath184 at the local maxima @xmath186 , the p - values in step ( 3 ) of algorithm alg : stem are computed as @xmath204 , @xmath205 , where @xmath206denotes the right tail probability of @xmath207 at the local maximum @xmath186 , evaluated under the complete null hypothesis @xmath208 . applying the technique of @xcite",
    ", we have that @xmath209 } { { \\mathbb{e}}[m(\\tilde{\\beta}_{j};{\\mathbb{s}}^{2 } ) ] } = \\int_{u}^{\\infty } f_j(x)\\,dx , \\label{eq : height - distr}\\]]where @xmath210 \\phi ( x)\\phi \\left ( \\frac{\\sqrt{\\kappa _ { 2,j}}x}{\\sqrt{2+\\kappa _ { 1,j}-\\kappa _ { 2,j}}}\\right )   \\\\ & \\quad + \\frac{\\sqrt{\\kappa _ { 2,j}(2+\\kappa _ { 1,j}-\\kappa _ { 2,j})}}{2\\pi } xe^{-\\frac{(2+\\kappa _ { 1,j})x^{2}}{2(2+\\kappa _ { 1,j}-\\kappa _ { 2,j } ) } } \\\\ & \\quad + \\frac{\\sqrt{2}}{\\sqrt{\\pi ( 3+\\kappa _ { 1,j}-\\kappa _ { 2,j})}}e^{-\\frac{(3+\\kappa _ { 1,j})x^{2}}{2(3+\\kappa _ { 1,j}-\\kappa _ { 2,j})}}\\phi \\left ( \\frac{\\sqrt{\\kappa _ { 2,j}}x}{\\sqrt{(2+\\kappa _ { 1,j}-\\kappa _ { 2,j})(3+\\kappa_{1,j}-\\kappa _ { 2,j})}}\\right ) \\bigg\\}. \\end{split}\\ ] ] here @xmath211 , @xmath212 are defined in above , and @xmath213 and @xmath214 denote the standard normal density and distribution functions , respectively .",
    "we can now apply the bh procedure in step ( 4 ) of algorithm [ alg : stem ] , as follows . for a fixed significance level @xmath215 ,",
    "let @xmath202 be the largest index for which the @xmath216th smallest @xmath3-value is less than @xmath217 .",
    "then the null hypothesis @xmath218 at @xmath186 is rejected if @xmath219where @xmath220 is defined as 1 if @xmath221 . since @xmath222 is random , definition is hereby modified to @xmath223where",
    "@xmath224 and @xmath225 are defined in and the expectation is taken over all possible realizations of the random threshold @xmath222 .",
    "since @xmath222 is random , similarly to the definition of @xmath226 , we define @xmath227",
    "the strategy to prove fdr control is to first quantify the expected number of local maxima above any level @xmath195 over the null region ( false discoveries ) and signal region ( true discoveries ) .",
    "this is given in lemmas [ lem : null - region ] and [ lem : signal - region ] below .",
    "[ lem : null - region ] let @xmath168 be fixed .",
    "then as @xmath228 , the expected number of local maxima of @xmath229 above @xmath195 in the null region @xmath230 is @xmath231 = [ 4\\pi -2\\pi(1-\\cos\\rho_j)n_j]r_j(u)+o(e^{-j^{\\nu}}),\\ ] ] where @xmath232 = f_{j}(u ) r_{j } , \\quad u\\in { \\mathbb{r}},\\ ] ] is the expected number of local maxima of @xmath233 exceeding @xmath195 over a unit area on @xmath234 , @xmath235 is the tail distribution function , and @xmath236    recall @xmath237 for every @xmath202 , therefore @xmath238 by the kac - rice metatheorem , lemma [ gellermayeli ] and condition [ tolerance ] , @xmath239\\\\ & = \\int_{\\mathbb{d}_0^{\\rho_j}}\\frac{1}{2\\pi \\sqrt{{\\rm det cov}(\\nabla\\tilde{y}_{n , j}(x))}}{\\mathbb{e}}[|\\text{det}(\\nabla ^{2}\\tilde{y}_{n , j}(x))|\\mathbbm{1}_{\\{\\tilde{y}_{n , j}(x)>u,\\,\\nabla ^{2}\\tilde{y}_{n , j}(x)\\prec 0\\}}|\\nabla \\tilde{y}_{n , j}(x)=0]dx \\\\ & = \\int_{\\mathbb{d}_0^{\\rho_j}}\\frac{1}{2\\pi \\sqrt{{\\rm det cov}(\\nabla\\tilde{\\beta}_{j}(x))}}{\\mathbb{e}}[|\\text{det}(\\nabla ^{2}\\tilde{\\beta}_{j}(x))|\\mathbbm{1}_{\\{\\tilde{\\beta}_{j}(x)>u,\\,\\nabla ^{2}\\tilde{\\beta}_{j}(x)\\prec 0\\}}|\\nabla \\tilde{\\beta}_{j}(x)=0]dx \\\\ & \\quad + o(n_jb^{mj}j^{2\\nu}e^{-j^{2\\nu } } ) , \\end{split}\\]]where @xmath240 is some positive constant .",
    "evaluating the integral yields , where @xmath241\\ ] ] is the expected number of local maxima of @xmath233 exceeding @xmath195 over a unit area on @xmath234 .",
    "the exact expression follows from , while was proved in @xcite .",
    "[ remark : localmax ] * [ asymptotics of @xmath242 . ] * by proposition [ prop : kappa ] , as @xmath26 , @xmath243implying for and that @xmath244    [ lem : signal - region ] let @xmath168 be fixed .",
    "then as @xmath245 , the number of local maxima of @xmath229 over the signal region @xmath246 satisfies @xmath247 & \\ge n_j+o(b^{-2j } ) .",
    "\\end{aligned}\\ ] ]    let @xmath248 . by lemma [ gellermayeli ] , within the domain @xmath249 ,",
    "the mean function of @xmath229 satisfies the assumptions of the unimodal signal model in @xcite with the signal strength being @xmath250 .",
    "it then follows from similar arguments as in @xcite that @xmath251 & = n_j+o(b^{-2j } ) .",
    "\\end{aligned}\\ ] ] the desired results then follow immediately from the observation @xmath252 where the inequality admits the possibility of there being other local maxima in the flatter areas @xmath253 of the needlet transform impulse response .",
    "the exact expected number of these is presumably small , but hard to estimate .    *",
    "[ the rate of @xmath190 ] * the proof of lemma [ lem : signal - region ] explains why the we make the assumption @xmath255 in condition [ tolerance ] above .",
    "this choice of rate for @xmath190 , decaying slightly less slowly than @xmath256 , allows obtaining an asymptotic limit to the number of local maxima over the null region @xmath257 $ ] , while the number of local maxima over the signal region @xmath258 $ ] can be bounded asymptotically .",
    "if we had chosen the rate of @xmath259 for @xmath190 , decaying at a rate @xmath256 , then as shown in the proof of lemma [ lem : signal - region ] , we could obtain an exact limit for the number of local maxima over the signal region ; however in that case , the number of local maxima over the null region would be difficult to quantify due to complicated behavior of the mean function @xmath260 ( after the needlet tranform ) immediately outside that radius .    the following ergodic result , which will be used in the proof of theorem [ thm : fdr ] below",
    ", shows that the variance of the number of local maxima goes to zero after normalization by the expected value .",
    "the result itself is theoretically important and the proof is given in the appendix .",
    "[ var_noise ] [ var ] as @xmath26 @xmath261\\le c(u)j^{2}b^{2j}+o(j^{2}b^{2j}).\\ ] ] where the constant @xmath262 is uniformly bounded with respect to @xmath195 and the @xmath263 term is universal .",
    "following is the first main result of this paper , showing control of fdp and fdr .",
    "[ thm : fdr ] let the assumptions in the model and condition [ tolerance ] hold .",
    "\\(i ) suppose that algorithm [ alg : stem ] is applied with a fixed threshold @xmath195 , then @xmath264r_j(u)}{[4\\pi -2\\pi(1-\\cos\\rho_j)n_j]r_j(u)+n_j}(1+o_p(1)),\\ ] ] where @xmath242 is defined in .",
    "\\(ii ) suppose that algorithm [ alg : stem ] is applied with the random threshold @xmath222 , then @xmath265r_j}{[4\\pi -2\\pi(1-\\cos\\rho_j)n_j]r_j+n_j}+o(1),\\ ] ] where @xmath266 is given by .",
    "\\(i ) by theorem [ var_noise ] and chebyshev s inequality , @xmath267/b^{2j}}{{\\mathbb{e}}[m_{u}(\\tilde{y}_{n , j};{\\mathbb{d}}_{0}^{\\rho_j } ) ] /b^{2j}+m_{u}(\\tilde{y}_{n , j};{\\mathbb{d}}_{1}^{\\rho_j } ) /b^{2j}}(1+o_{p}(1 ) ) .",
    "\\end{split}\\ ] ] it then follows from lemmas [ lem : null - region ] and [ lem : signal - region ] that @xmath268r_{j}(u)}{[4\\pi -2\\pi(1-\\cos\\rho_j)n_j]r_{j}(u)+n_j}(1+o_{p}(1 ) ) .",
    "\\end{split}\\ ] ]    \\(ii ) following a similar argument to that in @xcite , we use the fact that @xmath222 is the smallest @xmath195 satisfying @xmath269 , where @xmath270 and @xmath235 is the height distribution of @xmath271 .",
    "notice that @xmath272}{{\\mathbb{e}}[m(\\tilde{y}_{n , j } ; { \\mathbb{d}}_0^{\\rho_j})]}.\\ ] ] similarly to the proof of part ( i ) , we have @xmath273f_j(u ) + n_j}{{\\mathbb{e}}[m(\\tilde{y}_{n , j } ; { \\mathbb{d}}_0^{\\rho_j } ) ] + n_j } + o_p(1 ) \\\\ & = \\frac{[4\\pi -2\\pi(1-\\cos\\rho_j)n_j]r_jf_j(u ) + n_j}{[4\\pi -2\\pi(1-\\cos\\rho_j)n_j]r_j + n_j } + o_p(1 ) .",
    "\\end{split}\\ ] ] solving the equation @xmath274r_jf_j(u ) + n_j}{[4\\pi -2\\pi(1-\\cos\\rho_j)n_j]r_j + n_j } + o_p(1 ) = f_j(u)\\ ] ] gives an asymptotic solution @xmath275r_j}\\right ) + o_p(1).\\ ] ] since @xmath276 almost surely , we have @xmath277 \\le { \\mathbb{e}}\\left [ \\frac{v_{\\rho_j}(\\tilde{u}_{\\mathrm{bh } , j}^*)}{v_{\\rho_j}(\\tilde{u}_{\\mathrm{bh } , j}^ * ) + w_{\\rho_j}(\\tilde{u}_{\\mathrm{bh } , j}^ * ) } \\right ] \\\\ & \\le \\frac{{\\mathbb{e}}[v_{\\rho_j}(\\tilde{u}_{\\mathrm{bh } , j}^*)]}{{\\mathbb{e}}[v_{\\rho_j}(\\tilde{u}_{\\mathrm{bh } , j}^ * ) ] + { \\mathbb{e}}[w_{\\rho_j}(\\tilde{u}_{\\mathrm{bh } , j}^ * ) ] } ( 1+o(1 ) ) \\le \\frac{{\\mathbb{e}}[m(\\tilde{y}_{n , j } ; { \\mathbb{d}}_0^{\\rho_j})]f_j(\\tilde{u } _ { \\mathrm{bh } , j}^*)}{{\\mathbb{e}}[m(\\tilde{y}_{n , j } ; { \\mathbb{d}}_0^{\\rho_j})]f_j(\\tilde{u}_{\\mathrm{bh } , j}^ * ) + n_j } ( 1+o(1 ) ) \\\\ & = \\alpha\\frac{[4\\pi -2\\pi(1-\\cos\\rho_j)n_j]r_j}{[4\\pi -2\\pi(1-\\cos\\rho_j)n_j]r_j+n_j}+o(1 ) .",
    "\\end{split}\\ ] ]    * [ threshold for fdp ] * to make fdp asymptotically equal to a significance level @xmath278 , the corresponding threshold @xmath195 must satisfy the equation @xmath279r_{j}(u)}{[4\\pi -2\\pi(1-\\cos\\rho_j)n_j]r_{j}(u)+n_j}=\\alpha , \\]]implying @xmath280}.\\]]by remark [ remark : localmax ] , @xmath281 implying that as @xmath245 and @xmath282 , @xmath283 solving the equation @xmath284}\\]]yields the approximate solution @xmath285 according to condition [ tolerance ] , @xmath286 , implying @xmath287 .",
    "therefore , @xmath288 .    *",
    "[ comparison between fdp and bh procedure .",
    "] * dividing both sides of by @xmath289 yields @xmath290r_{j}},\\]]implying the following threshold by fdp for controlling significance level @xmath278 : @xmath291r_{j}}\\right ) .\\]]in comparison , for controlling significance level @xmath292 by the bh procedure , the asymptotic threshold is given by . if we replace @xmath278 by @xmath293r_{j}}{[4\\pi -2\\pi(1-\\cos\\rho_j)n_j]r_{j}+n_j},\\]]then the fdp threshold at significance level @xmath294 is given by @xmath295r_{j}}\\right).\\]]this coincides with the asymptotic threshold @xmath296 by bh procedure . since @xmath297 and @xmath298 , we see that the upper bound in tends to @xmath278 in the limit of high - frequency .",
    "* [ comparison with fwer control ( expected euler characteristic ) .",
    "] * for high values of the threshold @xmath195 , the expected euler characteristic exceeding @xmath195 can be approximated by @xmath299 ; hence , the threshold for controlling the fwer can be obtained by solving the equation @xmath300 . by the discussion in the previous remark ,",
    "this equation becomes @xmath301 , which gives the solution @xmath302 in comparison , the fdr threshold increases at a rate @xmath303 , much slower .      to prove power consistency ,",
    "we first show that , asymptotically , there will be at least one local maximum of @xmath229 within a small ball centered at every point source .",
    "[ lem : power ] for each fixed @xmath202 , there exists @xmath304 such that for sufficiently large @xmath27 , @xmath305 where @xmath306 and @xmath307 is the asymptotic bh threshold .    for each @xmath202 ,",
    "the probability @xmath308 has at least one local maximum above @xmath195 in @xmath309 is the complement of the probability that : ( 1 ) @xmath308 has no local maxima in @xmath310 , or ( 2 ) @xmath308 is below @xmath195 everywhere in @xmath310 .    for ( 1 ) , this is less than the probability that there exists some @xmath311 such that @xmath312 , since all @xmath313 satisfying @xmath314 would imply the existence of at least one local maximum in @xmath310 .",
    "this probability is bounded above by @xmath315where @xmath316 is a positive constant and the last inequality is due to , , lemma [ gellermayeli ] and the fact that @xmath317 is contained in the closure of @xmath310 . by proposition [ prop : kappa ]",
    ", there exists @xmath318 such that for sufficiently large @xmath27 , @xmath319then by the borell - tis inequality , there exists @xmath320 such that for sufficiently large @xmath27 , @xmath321    on the other hand , for ( 2 ) , the probability that @xmath308 is below @xmath195 everywhere in @xmath310 is bounded above by @xmath322 .",
    "the desired result then follows from the observation @xmath323 where the last term in parentheses is much smaller than the second when @xmath307 .",
    "following is the second main result of this paper , showing that the detection power tends to one asymptotically .",
    "[ thm : power ] let the assumptions in the model and condition [ tolerance ] hold .",
    "\\(i ) suppose that algorithm [ alg : stem ] is applied with a fixed threshold @xmath195 , then @xmath324    \\(ii )",
    "suppose that algorithm [ alg : stem ] is applied with the random threshold @xmath325 , then @xmath326    the desired results follow directly from lemma [ lem : power ] and the definitions of power and .",
    "in this section we present numerical evidence on the performance of the algorithm advocated in this work .",
    "one crucial step in the stem algorithm ( algorithm [ alg : stem ] ) is the computation of p - values of detected peaks , based on the distribution of peak heights under the complete noise assumption .",
    "we therefore start our validation by comparing the analytical peak height distribution function given in eqn .",
    "( [ eq : height - distr ] ) with the empirical result from filtered noise monte carlo simulations .",
    "once we establish the validity of the peak height distribution on the noise field , we add simulated point sources to form the full signal - plus - noise monte carlo simulations .",
    "these simulations are used to evaluate the numerical performance of the asymptotic fdp approximation and fdr control of section [ s : prooffdr ] .",
    "all our maps and the corresponding spherical harmonic coefficients are generated using the _",
    "healpix  _ package , which is now the standard routine software for handling cosmological data : see @xcite for a detailed discussion on this package and its main features . in healpix",
    "one can use the _ create_alm _ routine to generate random spherical harmonic coefficients , @xmath327 , with a given power spectrum .",
    "_ takes these coefficients and generate a pixelized gaussian map ; the inverse process is implemented using the _ map2alm _ code . to decompose a map into mexican needlet components , we filter the @xmath327 coefficients by the mexican needlet window functions as given in eqn .",
    "( [ eq : betaj ] ) .",
    "a single healpix  pixel has an area of @xmath328 where @xmath329 is the total number of pixels on a given map .",
    "the resolution is specified by the @xmath330 parameter , which is a multiple of 2 .    to simulate our noise field",
    ", we generated 100 gaussian realization maps of the cmb sky starting from the planck cmb power spectrum .",
    "all maps are simulated with a pixel resolution of @xmath331 .",
    "the standard deviation , also called root mean square ( rms ) , of the simulated noise field is given by @xmath332 where @xmath333 is the planck cmb power spectrum @xcite .    to simulate the finite resolution of the measuring instrument , these maps are then smoothed by a gaussian filter with full - width half max ( fwhm ) of 10 arcmin . in the literature ,",
    "this is usually referred to as a 10 arcmin gaussian beam .",
    "its effect can be thought of as part of the noise autocovariance function , although it is essentially negligible at @xmath334 as in our needlet analysis .",
    "as mentioned above , a point source in the sky is observed by a detector which has a finite angular resolution . with some abuse of nomenclature , the opening angle of the smallest resolvable angular unit , @xmath335 ,",
    "is called the beam of the detector .",
    "the typical angular size of galaxies is of a few arcsecs ( i.e. , one degree divided by @xmath336 ) while the detector beam sizes for typical cmb experiments ( 10 arcmin ) are an order of magnitude larger .",
    "this means that galaxies and other objects with angular size smaller than the beam can be viewed as point sources .",
    "as argued in the previous sections , the convolution of the point sources by the detector beam yields a gaussian bell - like profile in the final map with the peak of the gaussian being at the location of the point sources , @xmath337 .",
    "the signal part of our simulations is hence given by equation eqn .",
    "( [ eq : mu ] ) above , where the coefficient @xmath338 represent the brightness of the @xmath202th point source and @xmath339 is their total number .    it would be possible to consider more realistic models for these point sources , for instance using the so - called planck sky model ( see i.e. , @xcite )",
    "however , this would require a rather lengthy technical discussion on some specific astrophysical and experimental settings , which would not add anything substantial to the understanding of our current algorithm , nor would alter significantly our numerical results .",
    "we therefore delay a more complete analysis of these practical issues to a future , more applied paper .    to simulate our signal model with @xmath339 point sources , we first generated @xmath339 coordinate points randomly with a uniform probability density over the sphere .",
    "second we found the pixels that correspond to these locations on the healpix map ; third we set the values @xmath338 of these pixels as draws from a uniform distribution in the range 0 and @xmath340 .",
    "these amplitudes are given as a multiple of the rms of the noise .",
    "finally , to simulate the instrumental resolution , we convolved the map obtained in the last step by means of a gaussian beam of @xmath341 arcmin .",
    "this final map is now a pixelized version of .",
    "notice that for clarity we have described the smoothing process as a separate operation in the noise and signal maps , but this is , of course , equivalent to doing a single smoothing operation on a signal plus noise map .",
    "the gaussian beam decreases the sources magnitude by a factor proportional to the ratio between the area of a pixel and the area covered by the detector beam . for our choice of the beam and the pixel resolution ,",
    "this factor is an order of magnitude .",
    "since we desired to generate point sources uniformly distributed between 0 and @xmath342 after smoothing , we used @xmath343 .",
    "we considered different values for the total number of sources , i.e. , @xmath339=1000 , 3000 , 5000 .",
    "the final signal - plus - noise monte carlo simulations are then obtained by adding the point sources map to the 100 noise simulations ; an example is provided in fig.([fig : maps ] ) .",
    "note that the point sources are weak and hard to find without statistical analysis .    , @xmath344 and @xmath82 .",
    "the red marks have been added only to visualize the location of the point sources but are not part of the simulation .",
    "[ fig : maps],title=\"fig:\",scaledwidth=98.0% ] + , @xmath344 and @xmath82 .",
    "the red marks have been added only to visualize the location of the point sources but are not part of the simulation .",
    "[ fig : maps],title=\"fig:\",scaledwidth=49.0% ] , @xmath344 and @xmath82 .",
    "the red marks have been added only to visualize the location of the point sources but are not part of the simulation .",
    "[ fig : maps],title=\"fig:\",scaledwidth=49.0% ]      ) and numerical ( @xmath345 ) result .",
    "the mexican needlet parameters used are @xmath82 , @xmath344 and @xmath346 , which corresponds to central multipoles of @xmath347 $ ] .",
    "[ fig : pdf1],title=\"fig:\",scaledwidth=49.0% ] ) and numerical ( @xmath345 ) result .",
    "the mexican needlet parameters used are @xmath82 , @xmath344 and @xmath346 , which corresponds to central multipoles of @xmath347 $ ] .",
    "[ fig : pdf1],title=\"fig:\",scaledwidth=49.0% ] ) and numerical ( @xmath345 ) result .",
    "the mexican needlet parameters used are @xmath82 , @xmath344 and @xmath346 , which corresponds to central multipoles of @xmath347 $ ] .",
    "[ fig : pdf1],title=\"fig:\",scaledwidth=49.0% ] ) and numerical ( @xmath345 ) result .",
    "the mexican needlet parameters used are @xmath82 , @xmath344 and @xmath346 , which corresponds to central multipoles of @xmath347 $ ] .",
    "[ fig : pdf1],title=\"fig:\",scaledwidth=49.0% ]    the theoretical distribution of local maxima ( peaks ) on a mexican needlet filtered gaussian map is given by eqn .",
    "( [ eq : height - distr ] ) .",
    "in fig.([fig : pdf1 ] ) we present the comparison of the theoretical density , @xmath348 , with what we obtained empirically using 100 gaussian map simulations with no point sources .",
    "the upper panels from left to right respectively present the normalized gaussian peak pdfs for needlet frequency @xmath346 , with mexican needlet parameters @xmath344 and @xmath82 .",
    "we chose these values as a natural compromise which on one hand illustrates higher multipoles behaviour , on the other hand still allows for extremely good numerical accuracy ( better than 1% precision for finding peaks ) .",
    "in the lower panel of fig.([fig : pdf1 ] ) we show the relative percentage difference between the analytical and simulation results .",
    "it is easy to see from these figures that the theory fits the numerical results remarkably well .",
    "moreover , the dispersion around the expected value of the pdf decreases as @xmath27 increases , consistently with the ergodicity result of theorem [ var_noise ] .",
    "the first step in the stem algorithm , after needlet filtering , is to normalize the map using its standard deviation , as defined in eqn .",
    "( [ eq : standardize ] ) , to obtain eqn .",
    "( [ eq : signal+noise : norm ] ) .    to find local peaks on a map",
    "we compute the first and second derivatives using healpix  s routine _",
    "the pixels where the first derivative is close to zero ( within a precision of @xmath349 ) are classified as the local extrema .",
    "we then partition these extrema into maxima , minima and saddle using the eigenvalue decomposition of the hessian matrix - of course , maxima are those with all the eigenvalues negative .",
    "it is instructive to look at how the brightness of point sources increase as we filter the signal plus noise map with mexican needlets . in fig.([fig : hist ] ) , we plot the pdf of point source amplitudes before adding noise ( grey curve ) , after adding noise but before needlet filtering ( thick black curve ) , and after filtering with increasing @xmath27 . for the high frequency mexican needlet we considered , @xmath350 , filtering increases the brightness by a factor greater than 4 .",
    "the negative values in the histogram are due to the added gaussian noise ; we do not expect to detect such weak sources based on their amplitude information only .    .",
    "the mexican needlet parameters used are @xmath344 and @xmath82 .",
    "[ fig : hist],scaledwidth=90.0% ]     and @xmath351 .",
    "the mexican needlet parameters used are @xmath344 and @xmath82 .",
    "[ fig : fdp1],title=\"fig:\",scaledwidth=49.0% ]   and @xmath351 .",
    "the mexican needlet parameters used are @xmath344 and @xmath82 .",
    "[ fig : fdp1],title=\"fig:\",scaledwidth=49.0% ]   and @xmath351 .",
    "the mexican needlet parameters used are @xmath344 and @xmath82 .",
    "[ fig : fdp1],title=\"fig:\",scaledwidth=49.0% ]   and @xmath351 .",
    "the mexican needlet parameters used are @xmath344 and @xmath82 .",
    "[ fig : fdp1],title=\"fig:\",scaledwidth=49.0% ]      in eqn .",
    "( [ eq : bound - fdr ] ) of section [ s : prooffdr ] we provided the analytical result on the upper bound of the fdp as a function of the power spectrum of the noise , the total number and the spatial profile of the sources .",
    "here we compare this result with what is obtained from numerical simulations .",
    "the empirical fdp is computed using the following steps : locate maxima on needlet filtered signal - plus - noise monte carlo simulations using our peak detection code ; classify peaks as _ true discovery _ if the location of a maxima corresponds to a known ( input ) point source within @xmath155 pixel radius or _ false discovery _",
    "if there are no input sources within @xmath155 pixels radius of the peak ( @xmath155 corresponding to the tolerance parameter ) ; count the number of true and false discoveries as a function of @xmath155 and the rms of the noise .     for different needlet scales .",
    "the red curve is a plot of @xmath352 , while the black curve is the mean from 100 monte carlo simulations .",
    "the gray shades are for percentiles @xmath353 and @xmath351 . the number of point sources is 5000 .",
    "the mexican needlet parameters used are @xmath344 and @xmath82 .",
    "[ fig : fdr1],title=\"fig:\",scaledwidth=49.0% ]   for different needlet scales .",
    "the red curve is a plot of @xmath352 , while the black curve is the mean from 100 monte carlo simulations .",
    "the gray shades are for percentiles @xmath353 and @xmath351 . the number of point sources is 5000 .",
    "the mexican needlet parameters used are @xmath344 and @xmath82 .",
    "[ fig : fdr1],title=\"fig:\",scaledwidth=49.0% ] +   for different needlet scales .",
    "the red curve is a plot of @xmath352 , while the black curve is the mean from 100 monte carlo simulations .",
    "the gray shades are for percentiles @xmath353 and @xmath351 . the number of point sources is 5000 .",
    "the mexican needlet parameters used are @xmath344 and @xmath82 .",
    "[ fig : fdr1],title=\"fig:\",scaledwidth=49.0% ]   for different needlet scales .",
    "the red curve is a plot of @xmath352 , while the black curve is the mean from 100 monte carlo simulations .",
    "the gray shades are for percentiles @xmath353 and @xmath351 .",
    "the number of point sources is 5000 .",
    "the mexican needlet parameters used are @xmath344 and @xmath82 .",
    "[ fig : fdr1],title=\"fig:\",scaledwidth=49.0% ]    the empirical fdp as a function of @xmath195 , which is in units of the rms of the noise , and the source detection tolerance parameter @xmath155 is computed , according to , as @xmath354    in fig.([fig : fdp1 ] ) we illustrate the comparison of the fdp for thresholds in the filtered map above @xmath355 and @xmath356 for different values of @xmath27 .",
    "we found that setting @xmath357 does not alter significantly our results ( note that the smallest practical radius is @xmath358 ) .",
    "the red curve in these plots corresponds to the first term on the right hand side of eqn .",
    "( [ eq : bound - fdr ] ) , while the black curve is from the mean of the simulations .",
    "the contours from dark to light gray corresponds to the @xmath359 and @xmath360 confidence intervals .",
    "we note that , as expected , the analytic results for the upper bound become larger than the numerical simulations as @xmath27 increases .    , for needlet scale @xmath350 .",
    "the dashed curves are the analytical upper bounds while the solid curves are the corresponding empirical results from 100 monte carlo simulations .",
    "the mexican needlet parameters used are @xmath344 and @xmath82 [ fig : fdp_fdr1],title=\"fig:\",scaledwidth=49.0%,scaledwidth=32.0% ] , for needlet scale @xmath350 .",
    "the dashed curves are the analytical upper bounds while the solid curves are the corresponding empirical results from 100 monte carlo simulations .",
    "the mexican needlet parameters used are @xmath344 and @xmath82 [ fig : fdp_fdr1],title=\"fig:\",scaledwidth=49.0%,scaledwidth=32.0% ]      we now proceed in validating the analytical formalism established in section [ s : prooffdr ] to control the false discovery rate ( fdr ) .",
    "this is done by comparing the analytical upper bound of the fdr , which is given by eqn .",
    "( [ eq : bound - fdr ] ) , with the empirical result from simulations . in fig.([fig : fdr1 ] ) , it is shown that for a given error rate , the empirical fdr is always below the upper limit set by the theory .    in fig.([fig :",
    "fdp_fdr1 ] ) we present the mean fdp and fdr curves together with the corresponding theoretical results for different number of input sources .",
    "again , the fdp and fdr are bounded above by the theoretical bounds .      to quantify how many of the input point sources we discovered in our analysis , in fig.([fig : td ] ) we show the number of peaks that matches the true sources i.e. , the numerator of , which measures the statistical power of the algorithm .",
    "these results show that the power of the stem algorithm is almost 100% in detecting bright sources - indeed , we have detected all input sources whose brightness was above @xmath361 in the unfiltered simulated maps .",
    "overall , we believe that the results in this section provide a strong numerical support for the asymptotic findings that we described earlier in this paper .     as a function of needlet scales , @xmath27 .",
    "the three curves are the mean of 100 monte carlo simulations for the corresponding cases .",
    "the legend shows the number of input point sources in simulations .",
    "the mexican needlet parameters used are @xmath344 and @xmath82 .",
    "[ fig : td],scaledwidth=95.0% ]",
    "we introduce the following notation for the spherical caps in @xmath362 : @xmath363 for any @xmath364 , we say that @xmath365 is a _ maximal @xmath366-net _ , if @xmath367 are in @xmath362 , @xmath368 we have @xmath369 and @xmath370 heuristically , an @xmath366-net is a grid of point at a distance at least @xmath366 from each other , and such that any extra point should be within a distance @xmath366 from a point in the grid , see ( * ? ? ?",
    "* lemma 5 ) . the number @xmath339 of points in a @xmath366-net on the sphere can be bounded from above and from below , indeed we have the following : @xmath371 given an @xmath366-net it is natural to partition the sphere into disjoint sets , each of them associated with a single point in the net .",
    "this task is accomplished by the well - known voronoi cells construction .",
    "let @xmath372 be a maximal @xmath366-net . for all @xmath373 , the associated family of voronoi cells",
    "is defined by @xmath374    we recall that @xmath375 , hence @xmath376 .",
    "let @xmath377 note that , almost surely , the sum of the critical points over the voronoi cells equals the total number of critical points : @xmath378    our proof uses similar ideas to those exploited in @xcite for the analysis of critical points of spherical random eigenfunctions .",
    "in particular , we split the variance into two terms , one related to the correlation between voronoi cells which are further apart than an ( asymptotically vanishing ) threshold ( the so - called long - range component \" ) , the other related to voronoi cells whose distance is smaller than the threshold .    more precisely , we have that @xmath379    in section [ long ] we prove that the asymptotic behaviour of the long - range component is @xmath380 while in section [ short ] we prove that for we have @xmath381 where @xmath382 are uniformly bounded for every @xmath383 .    as in @xcite ,",
    "let us introduce also the two - point correlation function @xmath384 , which is given by @xmath385   \\notag \\\\ & \\times \\varphi _ { x , y}(t_1 , t_2 , 0,0,0,0)\\end{aligned}\\ ] ] where @xmath386 and @xmath387 denotes the density of the 6-dimensional vector @xmath388 in @xmath389 .",
    "note that , by isotropy , the function @xmath384 depends on the points @xmath111 , @xmath112 only through their geodesic distance @xmath390 ; with some abuse of notation , we shall write @xmath391    we are now in the position to investigate the asymptotic behaviour of the long- and short - range components , respectively .      by the kac - rice expectation metatheorem",
    "( see i.e. , @xcite , chapter 11 ) , we have @xmath392 \\mathbb{e}[\\mathcal{n}^{c}(\\tilde{\\beta}_j ; \\mathcal{v}(\\xi _ { k,\\varepsilon } ) , i)]\\end{aligned}\\ ] ] where @xmath393 is the union of voronoi cells which are further away than @xmath394 .",
    "our next result is a convenient expression for the expectation ; here and in the sequel , we use the simplified notation @xmath395 where @xmath396 was introduced in .",
    "[ exp ] @xmath397=\\frac 1 2 \\frac{\\mathcal{b}_{4,j } } { \\mathcal{b}_{2,j } } \\int_{i } p(t ) d t,\\end{aligned}\\ ] ] where the function @xmath3 is defined in .",
    "let @xmath398 be the number of critical points with value in @xmath399 @xmath400 from isotropy and kac - rice metatheorem we immediately get that @xmath397&=4 \\pi \\int_{\\mathbb{r}^4 }    , 0,\\zeta_{1},\\zeta_{2 } , \\zeta_{3 } ) d t \\ ; d \\zeta_{1}\\ ; d \\zeta_{2 } \\ ; d \\zeta_{3}\\end{aligned}\\ ] ] where @xmath401 denotes the joint density of @xmath402 in @xmath403 , @xmath404 , @xmath405 . since , at each fixed @xmath406 , first and second derivatives are uncorrelated we have @xmath407 where @xmath408 , @xmath409 and @xmath410 are the marginal densities of @xmath411 , @xmath412 and @xmath413 respectively .",
    "in view of the results in section [ cov_mat_section ] , we immediately have that @xmath414 and @xmath415 where @xmath416 with the scaling @xmath417 , where @xmath418 and @xmath419 , we obtain @xmath420 and then @xmath421 with @xmath422    in order to bound the variance we need to prove the following : @xmath423 as @xmath424 . the idea of the proof is to give a taylor expansion of the difference between the two integrands in , see @xcite for a related argument .",
    "more precisely , we start by giving the explicit expression of @xmath384 in terms of a gaussian integral ; indeed we write , for @xmath425 , @xmath426 where @xmath427 denotes the joint density of @xmath428 .",
    "we have also @xmath429 where @xmath430 is the density of @xmath431 and @xmath432 , @xmath433 are the conditional densities of @xmath434 and @xmath435 respectively .    in order to investigate the asymptotic behaviour of these densities",
    ", we need first to write the block components of the full covariance matrix of the field and its ( first and second order ) derivatives . in particular ,",
    "we introduce the following notation for the matrix @xmath436 : @xmath437    here , @xmath438 is the @xmath439 covariance matrix of @xmath440 ; @xmath441 is the @xmath442 covariance matrix between @xmath443 and @xmath444 ; @xmath445 is the @xmath446 covariance matrix between @xmath443 and @xmath447 ; @xmath448 is the @xmath449 covariance matrix of @xmath444 ; @xmath450 is the @xmath451 covariance matrix between @xmath452 and @xmath447 ; and finally for @xmath453 is the @xmath454 covariance matrix of the vector @xmath447 ( see appendix [ cov_mat_section ] ) .    with this notation in mind , can easily give the value of the bivariate density for levels , evaluated at the origin ; we have @xmath455 where @xmath456 and @xmath457 are elements of the covariance matrix @xmath448 , whose analytic expression is given below in and .",
    "on the other hand , we have also the conditional densities @xmath458 where @xmath459 moreover @xmath460 where the mean vector and covariance matrix are given by @xmath461 and @xmath462 respectively . after the change of variables @xmath463",
    "we have @xmath464 where @xmath465 the idea to conclude",
    "the proof is to write all the covariance matrix involved as ( small ) perturbations of their limiting values . for definiteness and simplicity",
    ", we consider the case where @xmath466 and @xmath82 ; all the other parameter ranges can be dealt in an entirely analogous way , provided that @xmath467 , as usually required for mexican needlets .",
    "in particular , with a hard computation ( which can be assisted by a computer ) , it is possible to show that the covariance matrix is given by @xmath468 with @xmath469 where we note that in view of , for @xmath470 , we have @xmath471 likewise @xmath472 in the previous formulae , we have introduced the vectors @xmath473 and @xmath474 that collect the perturbing elements of the covariance matrices @xmath475 and @xmath476 respectively , i.e. , @xmath477 in view of lemma [ asymp_matrix ] , these elements are such that there exists a constant @xmath478 @xmath479 in what follows , with a slight abuse of notation , we write the conditional covariance matrices @xmath480 and @xmath476 as a function of @xmath473 and @xmath474 , and the 2-point correlation function @xmath384 as a function of the perturbing elements @xmath481 , @xmath482 and @xmath483 , @xmath484 .",
    "it is a classical result of perturbation theory ( see i.e. , @xcite ) that gaussian expectations are analytic functions of the perturbing elements @xmath481 and @xmath483 , so we can expand them into a taylor polynomial around @xmath485 . in particular , let @xmath486 and @xmath487 as @xmath488 we have the expansions @xmath489 and @xmath490 in view of lemma [ asymp_matrix ] and the analytic expressions of the perturbing elements @xmath491 and @xmath492 we immediately have the following bounds @xmath493 now formula follows by observing that @xmath494 because the leading terms cancel with the centring factor , and all the other components are bounded in view of , and .",
    "this concludes the analysis of the long - range components .",
    "we bound now the contribution of the terms that are at a smaller distance than @xmath495 . as in @xcite",
    ", we can use again the kac - rice metatheorem to show that there exists a constant @xmath304 such that for every nice domain @xmath496 contained in some spherical cap of radius @xmath497 , one has @xmath498=\\iint_{\\mathcal{d } \\times \\mathcal{d } } \\iint_{i \\times i } k_{2,j } ( x , y;t_1,t_2 ) dt_1 dt_2 d x d y.\\ ] ] [ sette.tre ] let @xmath499 then we have    @xmath500 -\\left(\\mathbb{e}\\left [ \\mathcal{n}^{c}(\\tilde{\\beta}_j ; { \\cal v}(\\xi _",
    "{ \\varepsilon , i}),i)\\right]\\right)^{2}.   \\label{lario1}\\end{aligned}\\ ] ]    it is easy to see that @xmath501 \\leq \\mathbb{e}\\left [ \\mathcal{n}^{c}(\\tilde{\\beta}_j ; b(\\xi _ { \\varepsilon , i};\\varepsilon ) , i)\\right ] \\leq \\pi \\varepsilon ^{2 } b^{2j}=o(1 ) , \\label{lario3}\\end{aligned}\\ ] ] by",
    ". moreover we have the following result    [ b ] there exists a constant @xmath304 such that , for @xmath502 , one has @xmath503 with the constant involved in the @xmath504-notation universal .    since @xmath505 is nonnegative for all the values of its arguments , it is enough to study the rate of the following uniform bound in @xmath399 : @xmath506 for @xmath507 . with the change of variable @xmath508",
    ", we need to study @xmath509 first note that @xmath510 and by taylor expanding @xmath511 and @xmath512 ( which again can be assisted by a computer ) , we obtain @xmath513 it is easy to check that @xmath514\\end{aligned}\\ ] ] where @xmath515 is a centred gaussian with covariance matrix @xmath516 @xmath517 because we shall use a cauchy - schwartz bound , it is enough to focus on the blocks on the main diagonal , which we write as @xmath518 where the analytic expressions of the @xmath519 are derived by a computer assisted computation . now , by cauchy - schwartz , we have @xmath520 \\\\ & \\le 3 h_{1,j}(\\psi ) h_{3,j}(\\psi)+6 ( h_{1,j}(\\psi))^{1/2 } ( h_{3,j}(\\psi))^{1/2 } h_{2,j}(\\psi)+3 h_{2,j}(\\psi)^2.\\end{aligned}\\ ] ] and by taylor expanding the @xmath519 around @xmath521 ( again by a computer assisted computation ) we have @xmath520 \\\\ & \\le\\frac{3 \\ ; 2^{-18 j-7 } \\left(2 \\mathcal{b}_{2,j}-\\mathcal{b}_{4,j}\\right ) \\mathcal{b}_{4,j } \\left(2^{8 j+1 } \\mathcal{b}_{2,j } \\left(6 \\mathcal{b}_{2,j}-4 \\mathcal{b}_{4,j}+5 \\mathcal{b}_{6,j}\\right)-9 \\ ; 2^{8 j } \\mathcal{b}_{4,j}^2\\right ) \\psi ^2}{\\mathcal{b}_{2,j } \\left(2 \\mathcal{b}_{2,j}-3 \\mathcal{b}_{4,j}\\right)}+o\\left(\\psi ^3\\right)\\end{aligned}\\ ] ] so that the numerator is uniformly bounded by terms of order @xmath522 and @xmath523    by lemma [ b ] , we have @xmath524 again by . substituting the estimates and into yields @xmath525 and , by , @xmath526 as there are @xmath527 pairs of voronoi cells at distance smaller or equal than @xmath528 , implies that the contribution of this range to is @xmath529",
    "in this section we evaluate the covariance matrix @xmath530 of the 12-dimensional gaussian vector @xmath531 which combines level , gradient and elements of the hessian evaluated at @xmath111 and @xmath112 .",
    "the computations do not require sophisticated arguments , other than iterative derivations of legendre polynomials . note that @xmath530 depends only on the geodesic distance @xmath532 , so ,",
    "abusing notation , we shall write @xmath533 .",
    "it is convenient to write @xmath530 in block - diagonal form , i.e. @xmath534 in what follows we use the notation @xmath535                                    it is a well - known fact in the theory of stationary and isotropic stochastic processes that the covariance of derivative fields can be evaluated by means of derivatives of the covariance functions ; this issue is discussed for instance in @xcite , p. 268 .",
    "hence , for the results to follow , we shall need to control the asymptotic behaviour of higher - order derivatives of this covariance function .",
    "these results are collected in the following proposition .",
    "the result is a simple consequence of equation ( 8) in @xcite , from which we have that @xmath557 & = \\sum_{\\ell = 1}^{\\infty } b^{2}\\big(\\frac{\\ell } { b^{j}};p\\big)c_{\\ell } \\frac{2\\ell + 1}{4\\pi } \\frac{\\partial ^{a}}{\\partial \\theta _ { x}^{a}}\\frac{\\partial ^{b}}{\\partial \\theta _ { y}^{b}}\\frac{\\partial ^{c}}{\\partial \\phi _ { x}^{c}}\\frac{\\partial ^{d}}{\\partial \\phi _ { y}^{d}}p_{\\ell } ( \\langle x , y\\rangle ) \\\\ & \\leq b^{j(a+b+c+d)}\\frac{k_{m}}{(1+j^{-1}b^{j}d(x , y))^{4p+2-\\gamma } } \\sum_{\\ell = 1}^{\\infty } b^{2}\\big(\\frac{\\ell } { b^{j}};p\\big)c_{\\ell } \\frac{2\\ell + 1}{4\\pi } , \\end{aligned}\\]]@xmath558 , so that @xmath556\\leq b^{j(a+b+c+d)}\\frac{k_{m}}{(1+j^{-1}b^{j}d(x , y))^{4p+2-\\gamma } } .\\ ] ]            argueso , f. , salerno , e. , herranz , d. , sanz , j. l. , kuruoglu , e. e. , kayabol , k. ( 2011 ) , a bayesian technique for the detection of point sources in cmb maps , _ monthly notices of the royal astronomical society _ , volume 414 , issue 1 , pp . 410 - 417 , arxiv:1101.1456    axelsson , m. , ihle , h.t . , scodeller , s. , hansen , f. k. ( 2015 ) , testing for foreground residuals in the planck foreground cleaned maps : a new method for designing confidence masks , _ astronomy and astrophysics _ , 578 , a44 , arxiv:1410.7102                                  grski , k.m . , hivon , e. , banday , a.j . , wandelt , b.d . ,",
    "hansen , f.k . ,",
    "reinecke , m. , bartelmann , m. ( 2005 ) , healpix : a framework for high - resolution discretization and fast analysis of data distributed on the sphere , _ astrophysical journal _ , vol.699 , pp .",
    "759 - 771 .",
    "lpez - caniego , m. , herranz , d. , sanz , j.  l. , and barreiro , r.  b. ( 2005 ) , detection of point sources on two - dimensional images based on peaks , _ eurasip journal on applied signal processing , _ vol .",
    "2005 , no .",
    "15 , 2426 - 2436 , astro - ph/0503149        marinucci , d. , pietrobon , d. , balbi , a. , baldi , p. , cabella , p. , kerkyacharian , g. , natoli , p. picard , d. , vittorio , n. , ( 2008 ) , spherical needlets for cmb data analysis , _ monthly notices of the royal astronomical society _ , volume 383 , issue 2 , pp .",
    "539 - 545                    planck collaboration ( 2015 ) planck 2015 .",
    "xxvi , the second planck catalogue of compact sources , http://xxx.lanl.gov/abs/1507.02058 rudjord , o. , hansen , f.k . , lan , x. , liguori , m. marinucci , d. , matarrese , s. ( 2009 ) , an estimate of the primordial non - gaussianity parameter @xmath562 using the needlet bispectrum from wmap , _ astrophysical journal _ ,",
    "volume 701 , issue 1 , pp .",
    "369 - 376 , arxiv:0901.3154    rudjord , o. , hansen , f.k . ,",
    "lan , x. , liguori , m. marinucci , d. , matarrese , s. ( 2010 ) , directional variations of the non - gaussianity parameter @xmath563 , _ astrophysical journal _ ,",
    "volume 708 , issue 2 , pp .",
    "1321 - 1325 , arxiv : 0906.3232    scodeller , s. , rudjord , o. hansen , f.k . ,",
    "marinucci , d. , geller , d. and mayeli , a. ( 2011 ) , introducing mexican needlets for cmb analysis : issues for practical applications and comparison with standard needlets , _ astrophysical journal _ , 733 , 121      scodeller , s. , hansen , f.k .",
    "( 2012 ) , masking versus removing point sources in cmb data : the source corrected wmap power spectrum from new extended catalogue , _ astrophysical journal _ , 761 , 119 , arxiv:1207.2315"
  ],
  "abstract_text": [
    "<S> we present a topological multiple testing scheme for detecting peaks on the sphere under isotropic gaussian noise , where tests are performed at local maxima of the observed field filtered by the spherical needlet transform . </S>",
    "<S> our setting is different from the standard euclidean / large same asymptotic framework , yet highly relevant to realistic experimental circumstances for some important areas of application in astronomy . </S>",
    "<S> more precisely , we focus on cases where a single realization of a smooth isotropic gaussian random field on the sphere is observed , and a number of well - localized signals are superimposed on such background field </S>",
    "<S> . the proposed algorithms , combined with the benjamini - hochberg procedure for thresholding p - values , provide asymptotic strong control of the false discovery rate ( fdr ) and power consistency as the signal strength and the frequency of the needlet transform get large . </S>",
    "<S> this novel multiple testing method is illustrated in a simulation of point - source detection in cosmic microwave background radiation ( cmb ) data .    </S>",
    "<S> * * keywords and phrases : * gaussian random fields ; sphere ; cmb ; height distribution ; overshoot distribution ; needlet transform ; p - value ; threshold ; false discovery rate ; power . * </S>",
    "<S> * ams classification : * 60g15 ; 60g60 ; 62h15 ; 62m15 ; 62m40 </S>"
  ]
}