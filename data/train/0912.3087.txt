{
  "article_text": [
    "during the past two and a half decades the @xmath0 method@xcite for the study of electron quasiparticle excitations has had a number of successes and witnessed significant growth of interest within the computational electronic structure community .",
    "the @xmath0 method is currently being used for predicting electron quasi - particle excitation spectra as well as optical spectra in a variety of materials ranging from bulk solids to nanostructures and organic systems .",
    "the @xmath0 method is also of widespread use as a starting point for bethe - salpeter calculations of two - particle neutral excitations.@xcite current implementations find many diverse applications , including among others the calculation of the optical response of nanostructures,@xcite quantum transport in nanoscale junctions,@xcite pump - probe spectroscopy,@xcite angle - resolved photoemission spectroscopy,@xcite and strongly - correlated systems.@xcite    current trends in the development of improved computational approaches for quasiparticle excitations based on the @xmath0 method include the refinement of the initial guess for the non - interacting green s function and for the polarization operator,@xcite the inclusion of approximate vertex corrections or higher - order self - energy diagrams,@xcite and the description of the frequency - dependent dielectric response beyond the original generalized plasmon - pole approximation.@xcite detailed reviews of past and current developments in @xmath0 techniques can be found in refs .  .",
    "the majority of current @xmath0 implementations obtain the screened coulomb interaction @xmath1 and the non - interacting green s function @xmath2 using a perturbative expansion over the kohn - sham eigenstates ( cf .",
    "[ sec.coulomb ] below ) .",
    "such expansion requires the calculation of both occupied and unoccupied electronic states , as well as their associated optical matrix elements.@xcite a common bottleneck of this approach is that the convergence of the quasi - particle excitation energies with the number of unoccupied states is rather slow.@xcite this difficulty is particularly relevant when calculating the absolute values of the quasiparticle excitation energies.@xcite several avenues have been explored so far in order to circumvent this bottleneck and to perform @xmath0 calculations by employing only occupied electronic states,@xcite or a small number of unoccupied states.@xcite    the main aim of the present work is to demonstrate the feasibility of @xmath0 calculations entirely based on occupied states only.@xcite in practice we adopt the principles of density - functional perturbation theory ( dfpt ) to determine ( i ) the frequency - dependent screened coulomb interaction by directly solving self - consistent linear response sternheimer equations , and ( ii ) the non - interacting green s function by solving inhomogeneous linear systems .",
    "the main advantage of the proposed method is that it does not require the computation of unoccupied electronic states .",
    "in addition , we demonstrate the possibility of fast evaluations of the frequency dependence of the screened coulomb interaction based on _ multishift _ linear - system solvers.@xcite as a proof of concept we have implemented our method within a planewaves empirical pseudopotential scheme,@xcite and validated it by comparing with previous work for the prototypical test case of silicon .",
    "the use of the sternheimer equation for calculating the polarizability in the random - phase approximation ( rpa ) or the inverse dielectric matrix has already been discussed in refs .   and , respectively , within the framework of a non - perturbative supercell approach .",
    "after the introduction of dfpt in the context of lattice - dynamical calculations,@xcite the authors of ref .   proposed the use of the non self - consistent sternheimer method for the calculation of the dielectric matrix .",
    "the elimination of unoccupied electronic states in the evaluation of the screened coulomb interaction has also been proposed recently within the framework of a wannier - like representation of the polarization propagator and the lanczos recursion method.@xcite    this manuscript is organized as follows . in sec .",
    "[ sec.theory ] we describe how the self - consistent sternheimer formalism can be adapted to perform @xmath0 calculations . in particular , we outline the procedure to obtain the screened coulomb interaction in sec .",
    "[ sec.coulomb ] , the non - interacting green s function in sec .",
    "[ sec.green ] , and the @xmath0 self - energy in sec .",
    "[ sec.sigma ] . in sec .",
    "[ sec.theory.g ] we specialize to a planewave basis set representation and derive the key equations for the case of bloch electrons . sections [ sec.coulomb.g ] , [ sec.green.g ] , [ sec.sigma.g ] parallel the corresponding sections in the general theory part , respectively . in sec .",
    "[ sec.scaling ] we critically analyze the advantages and limitations of the present approach with an emphasis on the scaling of the calculations with system size . in sec .",
    "[ sec.results ] we report the results of our test calculations for silicon and compare with previous calculations in the literature .",
    "specifically , we presents results for the direct and inverse dielectric matrix ( sec .",
    "[ sec.5a ] ) , for the analytic continuation of the dielectric matrix using pad approximants ( sec .",
    "[ sec.conv ] ) , for the self - energy ( sec .  [ sec.5c ] ) , and for the spectral function ( sec .",
    "[ sec.5d ] ) . in sec .",
    "[ sec.conclusions ] we discuss possible future developments of our method and discuss our conclusions .",
    "the appendices provide technical details on some numerical algorithms adopted in this work , in particular the preconditioned complex biconjugate gradient method ( appendix  [ app.cbcg ] ) , the analysis of the conditioning of the sternheimer equations ( appendix  [ app.condition ] ) , the analytic continuation using pad approximants ( appendix [ app.pade ] ) , and the use of multishift methods for the simultaneous calculation of the polarization at multiple frequencies ( appendix [ app.multishift ] ) .",
    "in this section we describe how to exploit the sternheimer scheme within density - functional perturbation theory in order to calculate the screened coulomb interaction @xmath3 ( where @xmath4 , @xmath5 are the space variables and @xmath6 is the excitation frequency ) . while the use of the sternheimer approach in dfpt was originally developed bearing in mind the kohn - sham effective hamiltonian , we note that the present procedure applies without restrictions also to post - dft methods such as the lda+u method,@xcite hybrid functionals,@xcite and exact exchange.@xcite we assume rydberg atomic units throughout this manuscript . the hedin s equation which defines the screened coulomb interaction reads:@xcite @xmath7 where @xmath8 denotes the bare coulomb interaction and @xmath9 the irreducible polarization propagator . as eq .",
    "( [ eq.w ] ) is a self - consistent dyson equation for the screened coulomb interaction , it should be possible to solve it recursively in the spirit of density - functional perturbation theory . for simplicity ,",
    "we here specialize to the case of the random - phase approximation ( rpa ) for the polarization propagator .",
    "the generalization of this procedure to include exchange and correlation effects can be performed without difficulties ( cf .",
    "[ sec.vertex ] ) . within the random - phase approximation",
    "the polarization propagator can be written as:@xcite @xmath10 where @xmath11 indicates an electronic eigenstate of the single - particle hamiltonian with energy eigenvalue @xmath12 and occupation number @xmath13 . in the following",
    "we assume that the @xmath11 are kohn - sham eigenstates for definiteness . in eq .",
    "( [ eq.p ] ) the summation indices @xmath14 and @xmath15 run over both occupied and unoccupied electronic states , and the factor of 2 accounts for the spin degeneracy.@xcite although the expression for the rpa polarization eq .",
    "( [ eq.p ] ) has been derived for real frequencies in ref .  , it is possible to continue the polarization throughout the complex plane by using eq .",
    "( [ eq.p ] ) as a definition outside of the real axis .",
    "our goal is to rewrite eqs .",
    "( [ eq.w ] ) and ( [ eq.p ] ) by avoiding explicit summations over the unoccupied electronic states . for this purpose",
    "it is convenient to regard the screened coulomb interaction @xmath3 as a function of the second space variable @xmath5 , whilst the first space variable @xmath4 and the frequency @xmath6 are kept as parameters : @xmath16}(\\rp ) = w(\\r,\\rp;\\w)$ ] .",
    "if the system under consideration is subject to the perturbation @xmath16}(\\rp)$ ] , then within the rpa the first - order variation of the single - particle density matrix @xmath17}$ ] reads @xmath18 } = 2\\sum_{v\\s } \\psi_v^\\star   \\delta \\psi^\\s_{v[\\r,\\w]}.\\ ] ] in eq .",
    "( [ eq.deltan ] ) the index @xmath19 stands for `` valence '' and runs over the occupied electronic states only , the factor of 2 is for the spin degeneracy , and the superscript @xmath20 refer to the positive and negative frequency components of the induced charge .",
    "the first - order variations of the occupied wavefunctions @xmath21}$ ] can be determined by solving the following two sternheimer equations : @xmath22 }   = -(1-\\p )   \\delta v_{[\\r,\\w ] } \\psi_v,\\ ] ] where @xmath23 is the effective single - particle hamiltonian and @xmath24 is the projector on the occupied states manifold . in the particular case of vanishing frequency ( @xmath25 )",
    "the @xmath20 variations of the wavefunctions do coincide , and the standard dfpt equations are recovered .",
    "the screening hartree potential associated with the induced charge @xmath17}$ ] is calculated as usual through @xmath26}(\\rp ) = \\int d\\rpp \\delta n_{[\\r,\\w ] } ( \\rpp ) \\ , v(\\rpp,\\rp),\\ ] ] and finally the screened coulomb interaction in the rpa is obtained as @xmath27}(\\rp ) = v(\\r,\\rp ) + \\delta v^{\\rm h}_{[\\r,\\w]}(\\rp).\\ ] ]    it is tedious but otherwise straightforward to verify that eqs .",
    "( [ eq.deltan])-([eq.w.dfpt ] ) are _ equivalent _ to the original eqs .",
    "( [ eq.w])-([eq.p ] ) .",
    "the only assumptions made in our derivation are that time - reversal symmetry applies , and that the system under consideration has a finite energy gap for electronic excitations .",
    "the assumption of time - reversal symmetry is not essential and is mainly used to obtain a compact expression for the @xmath20 wavefunction perturbations .",
    "the assumption of finite energy gap can be relaxed by using the extension of dfpt to metallic systems developed in ref .  .",
    "there is a simple and intuitive physical meaning associated with the calculation scheme outlined above . to see this we consider an external _ test charge",
    "_ introduced in the system at the point @xmath4 .",
    "this charge generates a bare coulomb potential @xmath28 , and the system responds to such perturbation by generating the induced charge @xmath17}(\\rp)$ ] and the associated screening potential @xmath29}(\\rp)$ ] .",
    "the sum of the external perturbation @xmath28 and the screening potential @xmath29}(\\rp)$ ] yields the screened coulomb interaction @xmath3 at the point @xmath5 within the rpa .    the linear systems in eq .",
    "( [ eq.linsys.1 ] ) must be solved self - consistently . for this purpose",
    "we begin by initializing the screened coulomb interaction @xmath1 using the bare interaction @xmath19 .",
    "we then calculate the linear variations of the wavefunctions @xmath30 . using the calculated linear variations we update the induced charge density @xmath31 and the associated screening potential @xmath32 .",
    "this allow us to generate an improved estimate of the screened coulomb interaction @xmath1 .",
    "we cycle through these steps until convergence of the screened coulomb interaction is achieved",
    ". equations ( [ eq.deltan]),([eq.linsys.1 ] ) can be regarded as the generalization of the self - consistent sternheimer equations used for lattice - dynamical calculations@xcite to finite - frequency test - charge perturbations .    in practical calculations we solve",
    "( [ eq.linsys.1 ] ) along the imaginary frequency axis in order to avoid the null eigenvalues of the operator @xmath33 , and then we perform the analytic continuation of the screened coulomb interaction to real frequencies ( cf .",
    "appendixes [ app.cbcg]-[app.pade ] ) . in the special case of @xmath25",
    "it is convenient to modify the linear operator on the left - hand side of eq .",
    "( [ eq.linsys.1 ] ) by adding the projector on the occupied states manifold @xmath34 : @xmath35 }   = -(1-\\p )   \\delta v_{[\\r,0 ] } \\psi_v,\\ ] ] with @xmath36 set to twice the occupied bandwith .",
    "this extra term does not affect the solutions @xmath37}$ ] which are linear combinations of unoccupied electronic states .",
    "at the same time , the extra term has the effect of shifting away from zero the null eigenvalues of the linear operator @xmath38 thereby making it non singular .",
    "this strategy is common practice in dfpt implementations,@xcite and is discussed in greater detail in appendix [ app.condition ] .      within the scheme outlined here",
    "it is rather straightforward to introduce an approximate vertex correction to the @xmath0 self - energy along the lines of refs .  .",
    "this correction results from setting the self - energy in the first iteration of hedin s equations to the dft exchange - correlation ( xc ) potential , @xmath39 . within the present scheme this correction",
    "is simply obtained by including the variation of the exchange - correlation potential in the self - consistent potential used in eq .",
    "( [ eq.linsys.1 ] ) : @xmath40}\\ !   = \\!-(1-\\p)\\",
    "!   \\big[\\delta v_{[\\r,\\w ] } + k_{\\rm xc}\\delta n_{[\\r,\\w]}\\big ] \\ !",
    "\\psi_v,\\ ] ] @xmath41 being the functional derivative of the xc potential with respect to the density .",
    "the screened coulomb interaction is still to be calculated through eq .",
    "( [ eq.w.dfpt ] ) .",
    "this approach has been called `` @xmath42 '' approximation in ref .   due to the inclusion of the xc contribution in the screening of the test charge . that the inclusion of the xc term in the self - consistent induced potential leads to the @xmath42 approximation can easily be seen as follows .",
    "we combine eqs .",
    "( [ eq.deltan]),([eq.linsys.vertex ] ) to yield the induced charge density ( we use symbolic operator notation for clarity ) : @xmath43^{-1}p .\\ ] ] then , we substitute this result in the definition of the screened coulomb interaction eqs .",
    "( [ eq.dhartree]),([eq.w.dfpt ] ) to find @xmath44^{-1}p \\}.\\ ] ] the last equation yields precisely the screened coulomb interaction in the @xmath42 approximation.@xcite the difference between this approach and the standard @xmath0 approximation is that in this case the screening charge is calculated for an _ electron _ , while in the @xmath0-rpa approximation the screening is calculated for a _",
    "test charge_. it is worth pointing out that in standard implementations of dfpt the xc term is already included in the variation of the self - consistent potential,@xcite therefore the use of the @xmath42 approximation would not require any additional computational developments if the present approach was to be implemented on top of existing dft software .",
    "an alternative approach to the calculation of the screened coulomb interaction using the self - consistent sternheimer equation consists in solving eq .",
    "( [ eq.linsys.1 ] ) non self - consistently . for this purpose",
    "we can replace the self - consistent perturbation @xmath16}(\\rp)$ ] in the right - hand side of eq .",
    "( [ eq.linsys.1 ] ) by the bare coulomb potential @xmath45}(\\rp)=v(\\r,\\rp)$ ] as follows : @xmath46 }   = -(1-\\p )   v_{[\\r ] } \\psi_v,\\ ] ] and we can solve this sternheimer equation with the known term on the right - hand side kept fixed . by constructing the non self - consistent induced charge density @xmath47}$ ] as in eq .",
    "( [ eq.deltan ] ) we then obtain the dielectric matrix @xmath48 : @xmath49}(\\rp).\\ ] ] it is straightforward to check that this procedure correctly leads to the rpa dielectric matrix.@xcite the difference between this approach and the self - consistent calculation described in sec .  [ sec.coulomb ] is that here we also need to invert the dielectric matrix obtained through eq .",
    "( [ eq.diel ] ) in order to calculate the screened coulomb interaction .",
    "this non self - consistent procedure was first proposed in ref .  .",
    "one additional step that we make in the present work is to notice that eq .",
    "( [ eq.linsys.1.nscf ] ) constitutes a _ shifted _ linear system , i.e.  a system where the linear operator @xmath33 differs from the `` seed '' operator @xmath38 only by a constant shift @xmath50 ( @xmath51 being the identity operator ) . in this case",
    "we can take advantage of the _ multishift _ linear system solver of ref .   to determine @xmath52}$ ] for every frequency @xmath6 at the computational cost of one single calculation for the _ seed _ system @xmath53 }   = -(1-\\p )   v_{[\\r ] } \\psi_v$ ] .",
    "this procedure is extremely advantageous as it makes it possible to calculate the entire frequency - dependence by performing one single iterative minimization .",
    "the technical implementation of this procedure is described in appendix [ app.multishift ] .",
    "the calculation of the green s function can efficiently be performed by adopting a strategy similar to the sternheimer approach described in sec .",
    "[ sec.coulomb ] .",
    "we introduce the noninteracting green s function following ref .",
    ": @xmath54 where the sum extends over occupied as well as unoccupied electronic states .",
    "the real infinitesimal @xmath55 is positive ( @xmath56 ) for occupied states and negative ( @xmath57 ) for unoccupied states.@xcite we now split the sum in eq .",
    "( [ eq.green.1 ] ) into occupied ( @xmath19 ) and unoccupied ( @xmath58 ) states : @xmath59 and we add and subtract @xmath60 to obtain : @xmath61 with @xmath62 in the above derivation we assumed again time - reversal symmetry , we used the lorentzian representation of the dirac s delta function for small @xmath63 [ @xmath64 , and we defined @xmath65 .",
    "the component @xmath66 of the green s function is obviously analytic in the upper half of the complex energy plane as its poles lie below the real axis .",
    "the non - analytic component @xmath67 vanishes whenever the frequency @xmath6 is above the chemical potential .",
    "for frequencies @xmath6 below the chemical potential , the non - analytic component introduces the poles associated with the occupied electronic states .",
    "the partitioning of eqs .",
    "( [ eq.green.split.2 ] ) , ( [ eq.green.split.3 ] ) closely reflects the analytic structure of the non - interacting green s function .",
    "a detailed discussion of this aspect can be found in ref .  .",
    "the two components of the green s function in eq .",
    "( [ eq.green.split.2 ] ) are associated with the coulomb hole ( coh ) and the screened exchange ( sex ) terms of the self - energy , @xmath68 and @xmath69 , respectively.@xcite    the computation of the non - analytic component @xmath67 of the green s function in eq .",
    "( [ eq.green.split.3 ] ) is straightforward once the occupied electronic eigenstates have been determined . in order to calculate the analytic component",
    "@xmath66 it is convenient to proceed as in the case of the screened coulomb interaction , by regarding @xmath70 as a parametric function of the the first space variable and of the frequency : @xmath71}(\\rp ) = g^{\\rm a}(\\r,\\rp;\\w)$ ] .",
    "if we apply the operator @xmath72 to both sides of eq .",
    "( [ eq.green.split.2 ] ) , with @xmath73 , and we use the completeness relation @xmath74}(\\rp ) = \\delta(\\r,\\rp ) = \\sum_n \\psi_n(\\r)\\psi_n^\\star(\\rp)$ ] , then we find immediately : @xmath75 } = -\\ , \\delta_{[\\r]}.\\ ] ] as expected , we can determine the analytic part of the green s function by directly solving a linear system . as eq .",
    "( [ eq.green.3 ] ) does not explicitly require unoccupied electronic states , this procedure mimics the sternheimer approach for the screened coulomb interaction outlined in sec .",
    "[ sec.coulomb ] , albeit without the self - consistency requirement .",
    "the procedure described here is especially advantageous because eq .",
    "( [ eq.green.3 ] ) constitutes a shifted linear system , in the same way as eq .",
    "( [ eq.linsys.1.nscf ] ) .",
    "also in this case we exploit the multishift method of ref .   to determine @xmath71}$ ] for every frequency @xmath6 at the computational cost of one single calculation for the seed system @xmath76 } = -\\ , \\delta_{[\\r]}$ ] ( cf .",
    "appendix [ app.multishift ] ) .",
    "the presence of the infinitesimal @xmath77 in @xmath73 guarantees that the linear operator @xmath72 in eq .",
    "( [ eq.green.3.g ] ) is never singular .",
    "this operator can nonetheless become ill - conditioned , hence the use of appropriate preconditioners may become necessary .",
    "we discuss this aspect in appendix  [ app.condition ] .      the electron self - energy in the @xmath0 approximation is:@xcite @xmath78 where @xmath79 is a positive infinitesimal .",
    "at large frequencies the green s function decays as @xmath80 and the screened coulomb interaction tends to the frequency - independent bare coulomb interaction @xmath19 . as a consequence , the integrand in eq .",
    "( [ eq.sigma ] ) decays as @xmath80 and the integration requires some care .",
    "it is convenient to split the self - energy into an exchange contribution @xmath81 and a coulomb term @xmath82.@xcite it is easy to check that the integrand in the coulmb term decays as @xmath83 at large frequencies , therefore the integral is well behaved and the integration can be performed by using a numerical cutoff @xmath84 in eq .",
    "( [ eq.sigma ] ) .",
    "a detailed analysis of the analytic properties of the coulomb term @xmath85 shows that it must decay as @xmath80 at large frequencis , and that the use of the cutoff @xmath86 in the integration introduces an error of the order of @xmath87 , where @xmath88 denotes the characteristic plasmon frequency of the system .    in order to integrate the exchange term we observe that @xmath89 and that the poles of @xmath66 lie in the lower half of the complex plane , hence the integration of the term @xmath90 yields a vanishing contribution . on the other hand , the integration of @xmath91 yields a constant ( frequency - independent ) term.@xcite in summary , we perform the frequency integration in eq .",
    "( [ eq.sigma ] ) by evaluating numerically the coulomb term using an energy cutoff , and by integrating analitycally the exchange term : @xmath92 with @xmath93\\!,\\ ] ] and @xmath94",
    "we here describe our planewaves implementation of the scheme developed in sec .",
    "[ sec.theory ] .",
    "the choice of a planewaves representation was motivated by the need for making contact with existing literature on dielectric matrices,@xcite and by the availability of dfpt software for lattice - dynamical calculations@xcite which was used as a reference for our implementation .",
    "we adopt the following conventions for the transformation from real to reciprocal space .",
    "the wavefunctions transform as usual according to : @xmath95 with @xmath96 the volume of the unit cell and @xmath97 the bloch wavevector .",
    "the bare coulomb interaction transforms according to @xmath98 where @xmath99 is also a bloch wavevector and @xmath100 is the number of such wavevectors in our discretized brillouin zone . in eq .",
    "( [ eq.v ] ) we have @xmath101 . the latter expression for @xmath102",
    "is arrived at by replacing the integration @xmath103 over the crystal volume by an integration over all space .",
    "this choice corresponds to assuming that we can rely on a very fine sampling of the brillouin zone .",
    "had we performed the integration on a sphere with a radius @xmath104 defined by the crystal volume ( @xmath105 ) , then we would have obtained @xmath106 which corresponds to the truncated coulomb potential introduced in ref .  .",
    "we will come back to this aspect in sec .",
    "[ sec.coulomb.g ] .",
    "the screened coulomb interaction and the non interacting green s function transform according to @xmath107 and @xmath108 with similar expressions for @xmath109 , @xmath110 .",
    "we note that the sign convention adopted here in the fourier transforms [ e.g.  @xmath111 in the rhs of eq .",
    "( [ eq.w.bloch ] ) ] is necessary to obtain the compact expression eq .",
    "( [ eq.deltan.bloch ] ) below for the induced charge , and is opposite to the convention adopted in ref .  . before proceeding",
    "it is also convenient to introduce the `` right - sided '' inverse dielectric matrix through @xmath112 by adopting the same convention for the inverse dielectric matrix as for the screened coulomb interaction the above equation can be rewritten as : @xmath113 we note that our eq .",
    "( [ eq.wg ] ) is slightly different from the standard expression [ e.g.  eq .  ( 22 ) of ref .  ] , due to our choice of using the right - sided inverse dielectric matrix .      in order to rewrite eqs .",
    "( [ eq.deltan])-([eq.w.dfpt ] ) in the bloch representation and in reciprocal space we proceed as follows .",
    "we first write the linear systems eq .",
    "( [ eq.linsys.1 ] ) by relabeling the wavefunctions @xmath114 as bloch states @xmath115 : @xmath116 }   = -(1-\\p )   \\delta v_{[\\r,\\w ] } \\psi_{v\\k}.\\ ] ] the linear variations of the wavefunctions can be expanded in terms of bloch waves as follows : @xmath117 } = \\frac{1}{n_\\q\\omega } \\sum_{\\q\\g } \\delta u^\\sigma_{v\\k[\\q,\\g,\\w ] }    { \\rm e}^{i(\\k+\\q)\\cdot\\rp } { \\rm e}^{-i(\\q+\\g)\\cdot\\r},\\ ] ] where @xmath118}$ ] is cell - periodic in @xmath5 . from the linear variations of the wavefunctions we construct the induced charge density using eq .",
    "( [ eq.deltan ] ) : @xmath119 } = \\frac{2}{n_\\k}\\sum_{v\\k\\s } \\psi_{v\\k}^\\star   \\delta \\psi^\\s_{v\\k[\\r,\\w]}.\\ ] ] here the factor @xmath120 takes into account the normalization of the bloch states in the unit cell [ the wavefunctions @xmath114 in eq .",
    "( [ eq.linsys.1 ] ) are normalized in the whole crystal ] .",
    "next we expand the screened coulomb interaction in terms of bloch waves : @xmath121 } ( \\rp ) = \\frac{1}{n_\\q\\omega }   \\sum_{\\q\\g } \\delta v_{[\\q,\\g,\\w]}(\\rp )      { \\rm e}^{-i(\\q+\\g)\\cdot\\r } { \\rm e}^{i\\q\\cdot\\rp},\\ ] ] where @xmath122}$ ] is cell - periodic in @xmath5 . if we now place eqs .",
    "( [ eq.dv.bloch ] ) and ( [ eq123 ] ) into eq .",
    "( [ eq.linsys.3 ] ) we discover that the component @xmath122}$ ] of the perturbing potential corresponding to the bloch wave @xmath123 couples only to the variations of the wavefunctions corresponding to the bloch wave @xmath124 $ ] . as a result the linear system eq .",
    "( [ eq.linsys.1 ] ) becomes : @xmath125 }   = -(1-\\p^{\\k+\\q } ) \\delta v_{[\\q,\\g,\\w ] } u_{v\\k},\\ ] ] where @xmath126 and @xmath127 .",
    "the induced charge density associated with the bloch wave @xmath123 now reads @xmath128 } = \\frac{2}{n_\\k}\\sum_{v\\k\\s } u_{v\\k}^\\star   \\delta u^\\s_{v\\k[\\q,\\g,\\w]}.\\ ] ] this result is very similar to the case of standard dfpt.@xcite the main difference is that in the present case the translational invariance of the screened coulomb interaction induces a coupling between the perturbation with bloch wave @xmath123 in the variable @xmath4 and its induced response with bloch wave @xmath129 in the variable @xmath5 . to conclude our derivation , we rewrite the screened coulomb interaction eq .",
    "( [ eq.w.dfpt ] ) after expanding the cell - periodic function @xmath130}(\\rp)$ ] in planewaves : @xmath131}(\\gp ) ] v(\\q+\\gp).\\ ] ]    in practical calculations we proceed as follows : we first initialize the perturbation in the linear systems using @xmath132}(\\rp ) = v(\\q+\\g ) \\ , { \\rm exp}(\\,i\\g\\cdot\\rp)$ ] .",
    "the solution of the linear systems yields the change in the wavefunctions , which are then used to construct the induced charge , the induced hartree potential , and the updated screened coulomb interaction .",
    "we repeat this procedure by starting with the updated screened coulomb interaction until convergence is achieved . at convergence the self - consistent perturbing potential yields the screened coulomb interaction @xmath133",
    ". the calculation must be repeated for every perturbation , i.e.  for each set of parameters @xmath134 $ ] . at the end of this procedure",
    "it is straightforward to obtain the inverse dielectric matrix @xmath135 using eqs .",
    "( [ eq.w.deltan.g ] ) and ( [ eq.wg ] ) .",
    "alternatively , it is also possible to scale the initial perturbation and use @xmath132 } = { \\rm exp}(i\\g\\cdot\\rp)$ ] to obtain the inverse dielectric matrix at the end of the self - consistent procedure [ indeed eq .  ( [ eq.linsys.4 ] ) is a linear system ] .",
    "the scheme developed here allows us to calculate one row ( in @xmath136 ) of the inverse dielectric matrix @xmath135 by determining the linear response to the perturbation @xmath137 $ ] .",
    "this idea has been discussed already in ref .   in the framework of nonperturbative methods based on supercell calculations .      in order to avoid the singular behavior of the wings of the inverse dielectric matrix in the long wavelength limit ( @xmath138 ) it is convenient to work with the symmetrized inverse dielectric matrix defined as follows:@xcite @xmath139 unlike its unsymmetrized counterpart @xmath135 , the wings of @xmath140 have finite limits at long wavelengths .",
    "the screened coulomb interaction of eq .",
    "( [ eq.wg ] ) is now rewritten in symmetrized form as @xmath141 while the symmetrized inverse dielectric matrix has finite limits at long wavelengths , the screened coulomb interaction still presents a divergence corresponding to the long - range tail of the coulomb potential in real space .",
    "this divergence requires special handling when performing the brillouin zone integration to calculate the @xmath0 self - energy.@xcite we here overcome this difficulty following the prescription of ref .  .",
    "for this purpose we replace the bare coulomb potential @xmath28 by the truncated potential @xmath142 $ ] , @xmath143 being the heaviside step function .",
    "the truncation radius is defined as in sec .",
    "[ sec.coulomb.g ] . using this truncated coulomb potential ,",
    "the final expression for the screened coulomb interaction in reciprocal space becomes : @xmath144 in the long - wavelength limit @xmath145 the head of the truncated screened coulomb interaction ( @xmath146 ) tends to the finite limit @xmath147 and the singular behavior is removed .",
    "optimized truncation strategies have been developed for non - isotropic materials and systems with reduced dimensionality.@xcite      we now specialize eqs .",
    "( [ eq.green.1])-([eq.green.3 ] ) to the case of a planewaves basis and the bloch representation .",
    "we start by rewriting eq .",
    "( [ eq.green.1 ] ) after relabeling the electronic states @xmath148 as bloch states @xmath149 and taking into account the normalization , as already done in sec .",
    "[ sec.coulomb.g ] .",
    "next we expand the green s function in terms of the bloch waves @xmath150 $ ] and @xmath151 : @xmath152 } ( \\rp ) = \\frac{1}{n_\\k\\omega }   \\sum_{\\k\\g } g^{\\rm a}_{[\\k,\\g,\\w]}(\\rp )     { \\rm e}^{-i(\\k+\\g)\\cdot\\r } { \\rm e}^{i\\k\\cdot\\rp},\\ ] ] with @xmath153}(\\rp)$ ] cell - periodic in @xmath5 .",
    "an analogous expansion holds for the non - analytic component @xmath67 .",
    "equations ( [ eq.green.split.2]),([eq.green.split.3 ] ) are now rewritten as : @xmath154}(\\gp )   =   -\\,\\delta_{\\g\\gp},\\ ] ] @xmath155}(\\gp )   =      2\\pi i \\sum_v \\delta(\\w-\\e_{v\\k } ) u^\\star_{v\\k}(\\g)u_{v\\k } ( \\gp).\\ ] ] in deriving eqs .",
    "( [ eq.green.3.g]),([eq.green.4b.g ] ) we made use once again of time - reversal symmetry , yielding @xmath156 . similarly to the case of the screened coulomb interaction , by solving the linear system in eq .",
    "( [ eq.green.3.g ] ) for a set of parameters @xmath157 $ ] we obtain an entire row @xmath136 of the analytic component of the green s function @xmath153}(\\gp)$ ] .      the @xmath0 self - energy in eq .",
    "( [ eq.sigma ] ) is calculated in real space after performing the fourier transforms of @xmath133 and @xmath158 .",
    "the result is then transformed back in reciprocal space to obtain @xmath159 .",
    "the evaluation of the matrix elements of the self - energy in the basis of kohn - sham eigenstates is performed in reciprocal space .",
    "since the planewaves cutoff required to describe the inverse dielectric matrix and the self - energy is typically much smaller than the cutoff used in density - functional calculations,@xcite the procedure described here does not require an excessive computational effort and accounts for only a fraction of the total computation time .",
    "in this section we analyze the computational complexity of the algorithms proposed in sec .",
    "[ sec.theory.g ] , by focusing on our planewaves implementation . without loss of generality",
    "we consider a @xmath160 point sampling of the brillouin zone and we leave aside the frequency - dependence .",
    "we assume that the kohn - sham electronic wavefunctions are expanded in a basis of planewaves with a kinetic energy cutoff @xmath161 , corresponding to @xmath162 plane waves . in the simplest case of norm - conserving pseudopotential approaches",
    "the electronic charge density is described using a basis set with a cutoff @xmath163 , and the corresponding numbers of basis functions and real - space grid points are @xmath164 and @xmath165 , respectively .",
    "the screened coulomb interaction and the green s function are described by a smaller cutoff @xmath166 and @xmath167 planewaves .",
    "the self - energy is expanded in a planewaves basis with cuttoff @xmath168 , and we denote by @xmath169 the number of real - space grid points associated with this basis .      equation ( [ eq.linsys.4 ] ) needs to be solved for each one of the @xmath167 planewave perturbations and the @xmath170 occupied electronic states . for the solution of eq .",
    "( [ eq.linsys.4 ] ) we adopt the complex bi - orthogonal conjugate gradient method of ref .",
    "( cbicg ) , as described in appendix [ app.cbcg ] .",
    "each solution of eq .",
    "( [ eq.linsys.4 ] ) requires two cbicg minimizations ( for @xmath171 ) , and each cbicg minimization consists of two conjugate gradients ( cg ) sequences .",
    "the most time - consuming operation in each cg step is the application of the hamiltonian to the previous search direction , and in particular the fourier transform of the wavefunctions to real - space and back for evaluating the product with the local potential .",
    "fast - fourier - transform ( fft ) algorithms allow us to perform these calculation in @xmath172 floating point operations.@xcite if in average the cg minimization requires @xmath173 steps and the self - consistency loop requires @xmath174 iterations , then the total cost of the entire calculation corresponds to a number of floating point operations @xmath175 where s@xmath0 stands for `` sternheimer gw '' . as @xmath167 , @xmath170 , and @xmath165 scale linearly with the size of the system as measured by the number of atoms @xmath176 , the overall scaling of this procedure is @xmath177 .    for comparison",
    "it is useful to consider the scaling of standard @xmath0 calculations based on the expansion over unoccupied states ( hereafter referred to as the `` hl '' method).@xcite the calculation of the irreducible rpa polarization requires the evaluation of the optical matrix elements between each of the @xmath170 occupied states and each of the @xmath178 unoccupied states .",
    "these matrix elements are typically computed by using fourier transforms of @xmath179 , therefore this procedure requires essentially @xmath180 fourier transforms from real- to reciprocal - space .",
    "each fourier transform is performed on the real - space grid for the density with @xmath165 grid points , therefore the total cost of the standard method corresponds to a number of floating point operations @xmath181 even in this case therefore the overall scaling is @xmath177 .    since the method of ref .   calculates the dielectric matrix and then performs a matrix inversion , in order to compare the prefactors in eqs .",
    "( [ eq.scaling.1 ] ) and ( [ eq.scaling.2 ] ) we consider the non self - consistent calculation of the dielectric matrix as described in sec .",
    "[ sec.diel.nscf ] [ @xmath182 in eq .",
    "( [ eq.scaling.1 ] ) ] , and we restrict ourselves to the calculation of the static dielectric matrix . in this case",
    "only one calculation of eq .",
    "( [ eq.linsys.1 ] ) is required instead of two for @xmath171 , and the two cg sequences of the cbicg algorithm do coincide . as a result , a factor 4 drops out of the prefactor in eq .",
    "( [ eq.scaling.1 ] ) . if we assume for definiteness a perfectly well - conditioned linear system ( condition number @xmath183 ) , and express the number of cg iterations required to achieve convergence through eq .",
    "( [ eq.cg ] ) , then the ratio between the complexity of the s@xmath0 approach in a planewaves implementation and the standard approach becomes @xmath184 where @xmath185 is the relative accuracy of the results . as an example , for a relative accuracy of @xmath186 we find this ratio to be @xmath187 . in the case of silicon , using a typical cutoff @xmath188 ry we obtain @xmath189 , therefore the s@xmath0 approach becomes convenient when more than @xmath1901650 unoccupied states are used in the standard approach .",
    "this is rarely the case as most calculations reported to date use only a few hundreds of unoccupied electronic states .",
    "of course the accuracy of the standard sum - over - states expression is difficult to quantify , and probably a convergence on 5 significant digits is not warranted by a few hundreds of electronic states .",
    "our estimate suggests that the planewaves implementation of our method can be as expensive as the standard approach .",
    "it should be noted , however , that our scheme has the advantage of providing the whole self - energy @xmath191 , while the standard approach typically provides the matrix elements of the self - energy on a small subset of states of the order of @xmath170 .",
    "therefore if we were to perform a comparison based on the same amount of output information , we should use @xmath192 in eq .",
    "( [ eq.scaling.2 ] ) instead of @xmath193 . in this case",
    "( [ eq.ratio.flops ] ) would change into @xmath194 and for @xmath186 we would have @xmath195 .",
    "this clearly shows that , if the entire self - energy was needed ( as opposed to a few matrix elements ) , then our proposed s@xmath0 approach would be more convenient that the standard sum - over - states approach .",
    "the above analysis shows that the main bottlenecks of our method are ( i ) the fourier transform for the application of the hamiltonian and ( ii ) the large basis sets adopted . in order to make the approach proposed here more efficient",
    "we could either move to real - space methods where the application of the hamiltonian scales linearly with system size,@xcite or reduce the size of the basis set by using local orbitals.@xcite fast evaluations of the operation @xmath196 in order-@xmath197 operations should make it feasible @xmath0 calculations with @xmath198 scaling and with a very favorable prefactor .",
    "we will come back to this aspect in sec .",
    "[ sec.conclusions ] .",
    "the complexity of the procedure for calculating the green s function proposed in sec .  [ sec.green ] can be analyzed along the same lines of sec .",
    "[ sec.coulomb.scaling ] .",
    "the main differences in this case are that ( i ) the linear system eq .",
    "( [ eq.green.3 ] ) does not depend on the occupied states , ( ii ) the calculation is non self - consistent , and ( iii ) the calculation is performed for one single frequency @xmath199 , while the entire frequency - dependence is generated through the multishift method . as a result ,",
    "a factor @xmath200 drops out of eq .",
    "( [ eq.scaling.1 ] ) and the computational cost of the green s function calculation reads : @xmath201 the complexity of this calculation is significantly smaller than the complexity of the algorithm for the screened coulomb interaction . in particular , the calculation of the green s function scales as @xmath202 .",
    "this procedure for calculating the green s function is advantageous with respect to an expansion over empty states , as the orthogonalization of the unoccupied states would require a number of floating point operations scaling as @xmath203 .",
    "the self - energy is computed in real - space after obtaining @xmath204 and @xmath3 from @xmath205 and @xmath206 , respectively , and then is tranformed back into reciprocal space .",
    "the 6-dimensional fft transforms require @xmath207 operations for each frequency of the screened coulomb interaction , having defined @xmath208 .",
    "the computational cost of this procedure scales as @xmath202 , and is small with respect to the cost of calculating the screened coulomb interaction .",
    "in order to demonstrate the approach proposed in secs .  [ sec.theory],[sec.theory.g ] we have realized a prototype implementation within the empirical pseudopotential method ( epm ) of ref .  , and we have validated our implementation for the test case of silicon .",
    "table [ tab.1 ] contains some of the components of the inverse dielectric matrix calculated using the self - consistent sternheimer method described in sec .",
    "[ sec.theory.g ] . in all our calculations we used inverse dielectric matrices of size 59@xmath20959 , corresponding to a kinetic energy cutoff of 5 ry for the screened coulomb interaction . for the purpose of comparison with ref .",
    "we calculated the static and long wavelength limit ( @xmath25 , @xmath210 ) of the inverse dielectric matrix for the first few reciprocal lattice vectors .",
    "the authors of ref .   adopted the standard approach based on the expansion over the unoccupied electronic states of the dielectric matrix , and obtained the inverse dielectric matrix by performing matrix inversions . in our calculations",
    "we used the self - consistent method of sec .",
    "[ sec.theory.g ] and no matrix inversion was necessary . the excellent agreement which can be seen in table [ tab.1 ] between our calculations and ref",
    ".   supports the validity of our approach .",
    "c c c & +   + @xmath211 @xmath212 & ref .   & present work + ( 0,0,0 ) ( 0,0,0 ) & 0.083 & 0.0866 + ( 1,1,1 ) ( 1,1,1 ) & 0.605 & 0.6055 + ( , 1,1 ) ( 1,1,1 ) & 0.008 & 0.0076 + ( 1,,1 ) ( , 1,1 ) & 0.010 & 0.0102 + ( 1 , , ) ( , 1,1 ) & 0.045 & 0.0463 + ( 2,0,0 ) ( 1,1,1 ) & -0.038 & -0.0382 + ( 2,0,0 ) ( , 1,1 ) & -0.005 & -0.0049 + ( 2,0,0 ) ( 2,0,0 ) & 0.667 & 0.6671 + ( , 0,0 ) ( 2,0,0 ) & 0.006 & 0.0063 + ( 0,2,0 ) ( 2,0,0 ) & 0.016 & 0.0166 +    next we consider the wavevector dependence of the head of the dielectric matrix @xmath213 .",
    "we performed the calculation by using the non self - consistent method described in sec .",
    "[ sec.diel.nscf ] in order to compare our results with ref .  .",
    "figure [ fig1 ] shows that our calculations are in very good agreement with the results of ref .  .",
    "the slight differences between our results and those of ref .   at large wavevectors can likely be ascribed to the use of a limited number of empty states in the perturbative expansion over unoccupied states in the latter work .",
    "figure [ fig2 ] compares our results for the frequency dependence of the dielectric matrix at long wavelength with the results reported in ref .  .",
    "we focused in particular on the cases illustrated in fig .",
    "3 of ref .  .",
    "apart from some small differences possibly arising from the use of the expansion over unoccupied states in ref .  , even in this case",
    "the agreement between our calculations and those of ref .",
    "is very good throughout the entire frequency range .",
    "the agreement is consistently good for the head of the dielectric matrix and for diagonal and off - diagonal matrix elements .",
    "( color online ) dielectric function of silicon calculated using the empirical pseudopotential method and the non self - consistent sternheimer method of sec .",
    "[ sec.diel.nscf ] : calculated head of the static dielectric function as a function of wavevector @xmath213 ( blue solid line ) , and results from ref .",
    "( red dashed line ) .",
    "we used a planewave kinetic energy cutoff of 5 ry and sampled the brillouin zone through a uniform @xmath214 grid .",
    "the wavevectors are in units of @xmath215 , @xmath216 being the lattice parameter . , title=\"fig:\",width=283][t ]     ( color online ) frequency - dependent dielectric matrix of silicon at long wavelength [ @xmath217 .",
    "the calculations were performed using the empirical pseudopotential method of ref .   and the non self - consistent sternheimer method of sec .  [ sec.diel.nscf ] .",
    "we used a planewave kinetic energy cutoff of 5 ry and sampled the brillouin zone thorough a uniform @xmath218 grid .",
    "such a dense brillouin zone sampling was necessary to correctly describe the absorption onset . in order to avoid null eigenvalues in the linear system eq .",
    "( [ eq.linsys.1.nscf ] ) we performed the calculations by including a small imaginary component of 0.1  ev in the frequency @xmath6 .",
    "the panels ( a)-(c ) correspond to the cases illustrated in fig .  3 of ref .   and",
    "show @xmath219 for ( a ) @xmath146 , ( b ) @xmath220 , and ( c ) @xmath221 , @xmath222 .",
    "the blue solid lines are our calculations , the red dashed lines are from ref .  .",
    "the real and imaginary parts of the dielectric matrix are indicated in each panel .",
    "we note that the scales on the vertical axes correspond to three different orders of magnitude . , title=\"fig:\",width=245][b ]       ( color online ) real part of the long - wavelength dielectric matrix of silicon as a function of frequency .",
    "panels ( a ) and ( b ) of this figure correspond to panels ( a ) and ( b ) of fig .",
    "[ fig2 ] , respectively .",
    "the technical details of the calculations are the same as those described in the caption of fig .",
    "solid blue lines : dielectric matrices calculated directly along the real frequency axis , from fig .",
    "dotted , dashed , and dash - dotted red lines : dielectric matrices obtained from the analytic continuation on the real axis using pad approximants of order 6 , 11 , and 26 , respectively .",
    "the pad approximants were generated using dielectric matrices calculated along the imaginary frequency axis on uniform frequency grids in the range 0 - 50 ev .",
    "for instance , the 6-points approximant corresponds to calculations at the imaginary frequencies of @xmath223 ev .",
    ", title=\"fig:\",width=283][t ]    figure [ fig3 ] shows the quality of the analytic continuation from the imaginary to the real frequency axis using pad approximants ( cf .",
    "appendix [ app.pade]).@xcite we found that this procedure based on pad approximants is generally very stable and requires minimal manual intervention .",
    "approximants of order 5 and higher are able to reproduce the location , the strength , and the width of the main plasmon - pole structure of the dielectric matrix .",
    "head , wings , and body of the dielectric matrix are all described consistently ( cf .",
    "[ fig3 ] ) . although the singularity corresponding to the absorption onset in fig .",
    "[ fig3](a ) is smoothed out by pad approximants of low order , this effect is washed out when calculating the frequency convolution of the green s function with the screened coulomb interaction for the @xmath0 self - energy .",
    "the advantages of performing calculations along the imaginary axis are that ( i ) the linear system in eq .",
    "( [ eq.linsys.1 ] ) becomes increasingly more well - conditioned when approaching large imaginary frequencies , and ( ii ) a moderate brillouin - zone sampling is required to perform calculations along the imaginary axis unlike the case of real - axis calculations . as a result , the worst case scenario for the solution of the linear system eq .",
    "( [ eq.linsys.1 ] ) corresponds to the static case @xmath25 .",
    "these technical aspects are described in detail in appendix  [ app.condition ] .    the typical number of non self - consistent iterations required to solve eq .",
    "( [ eq.linsys.1 ] ) for a fixed @xmath16}$ ] with a relative accuracy of @xmath224 using the cbicg algorithm described in appendix [ app.cbcg ] is @xmath225 ( using the preconditioner of ref .  ) .",
    "this estimate has been obtained by averaging over all the @xmath226 reciprocal lattice vectors , @xmath99-vectors , and imaginary frequencies . the typical number of self - consistent cycles required to obtain the screened coulomb interaction through eq .",
    "( [ eq.linsys.1 ] ) with a relative accuracy of @xmath227 is @xmath228 .",
    "charge - sloshing effects are attenuated by using the potential mixing method proposed in ref .",
    ", appropriately modified to deal with complex potentials .    for completeness",
    "we report here the corresponding figures for the calculation of the green s function using eq .",
    "( [ eq.green.3 ] ) .",
    "the average number of non self - consistent iterations required to obtain the analytic part of the green s function is @xmath229 when preconditioning is adopted ( for this purpose we used a straightforward adaptation of the method of ref .  ) .",
    "however , multishift minimizations as described in appendix [ app.multishift ] do not allow for the use of preconditioning , and in the latter case the number of iterations required to achieve convergence ( within a relative accuracy @xmath224 ) can be as high as @xmath230 .      figures [ fig4 ] and [ fig5 ] show the real part @xmath231 and the imaginary part @xmath232 of the @xmath0 self - energy calculated for the first few silicon eigenstates at @xmath160 using our s@xmath0 method within the epm scheme .",
    "our results are compared with the calculations of of ref .   performed within dft / lda and the projector - augmented wave method ( paw ) .",
    "we calculated the screened coulomb interaction by using a uniform @xmath233 grid to sample the brillouin zone , and pad approximants of order 7 along the imaginary frequency axis .",
    "the frequency integration of the coulomb term @xmath234 of the @xmath0 self - energy in eq .",
    "( [ eq.convolution ] ) was performed by using a coulomb cutoff @xmath235 ev and a grid spacing of 0.5 ev .",
    "the green s function was calculated using an imaginary component @xmath236 ev in eq .",
    "( [ eq.green.3 ] ) . apart from some differences in the damping of the plasmaron peaks ,",
    "the agreement between our calculated self - energy and the results of ref .",
    "is rather good throughout the entire frequency range @xmath237100 ev .",
    "this finding is quite surprising since we are comparing our empirical pseudopotential calculations with low kinetic energy cutoff ( 5 ry ) with the _ ab - initio _ lda calculations including paw core - reconstruction of ref .  .",
    "such agreement probably reflects the ability of the epm method to provide not only a good description of the band structure of silicon , but also a reasonable description of the electronic wavefunctions .",
    "( color online ) real part @xmath238 of the expectation value of the @xmath0 self - energy for the first 8 silicon eigenstates at @xmath239 .",
    "the solid blue lines are our s@xmath0 results using the empirical pseudopotential method .",
    "the dashed red lines are from the first - principles calculation of ref .   using the lda and the paw method .",
    "panels ( a)-(d ) correspond to the states @xmath240 ( band 1 ) , @xmath241 ( bands 2 - 4 ) , @xmath242 ( bands 5 - 7 ) , and @xmath243 ( band 8) , respectively . the energy axis is aligned with the top of the valence band .",
    "the horizontal dotted lines indicate the calculated bare exchange contribution to the self - energy @xmath244 .",
    ", title=\"fig:\",width=226][t ]       ( color online ) imaginary part @xmath245 of the expectation value of the @xmath0 self - energy for the first 8 silicon eigenstates at @xmath239 .",
    "the solid blue lines are our s@xmath0 results using the empirical pseudopotential method .",
    "the dashed red lines are from the first - principles calculation of ref .  .",
    "panels ( a)-(d ) correspond to the states @xmath240 , @xmath241 , @xmath242 , and @xmath243 , respectively .",
    "the energy axis is aligned with the top of the valence band . for comparison ,",
    "the vertical grey lines indicate the locations of the logarithmic singularities at @xmath246 ( @xmath88 being the plasmon energy ) that would arise using a model plasmon - pole dielectric function.@xcite , title=\"fig:\",width=226][t ]     ( color online ) expectation values of the quasiparticle spectral function @xmath247 for the first 8 silicon eigenstates at @xmath239 .",
    "the solid blue lines are our s@xmath0 results using the epm , the dashed red lines are from the first - principles calculation of ref .   using the lda and the paw method .",
    "the expectation values have been calculated within the diagonal approximation of eq .",
    "( [ eq.specfun ] ) . in each panel",
    "the sharp peak near the band extrema corresponds to a well - defined quasi - particle , while the two broad peaks corresponds to plasmarons , i.e.  electrons or holes coupled to a cloud of real plasmons.@xcite the suppression of one of the plasmaron peaks reflects the large imaginary parts of the self - energy in the corresponding panels of fig .",
    "we point out the different vertical scale in panel ( d ) . , width=226 ]    [ cols=\"<,>,<,>,<,>,<,>,<,>,<,^ \" , ]     within the @xmath0 method the values of the quasi - particle excitation energies are typically calculated by using first - order perturbation theory on the dft eigenvalues.@xcite the perturbation operator @xmath248 corresponds to the difference between the @xmath0 self - energy @xmath191 and the dft exchange and correlation potential @xmath249 .",
    "this approach is sensible because the complete quasi - particle equations are similar to the ordinary kohn - sham equations if we replace the self - energy @xmath250 by the dft xc potential @xmath251.@xcite    within the epm scheme the total potential @xmath252 acting on the electrons is specified,@xcite but the electronic charge density is not connected to this potential through a self - consistent procedure.@xcite this limitation makes it difficult to identify an xc contribution within the empirical pseudopotential .",
    "however , since the charge density obtained within the epm method can be regarded as an approximation to the actual charge density,@xcite it appears sensible to obtain the effective xc potential as a functional of the epm charge density using the local density approximation.@xcite this procedure is formally equivalent to assuming that the unscreened ionic pseudopotential @xmath253 is given by @xmath254 , where the hartree potential @xmath255 and the xc potential @xmath251 are calculated using the epm charge density .",
    "_ this uncertainty on the xc potential renders the calculation of the quasi - particle excitation energies somewhat arbitrary , therefore the results presented in the following should be regarded as qualitative and are presented only for the purpose of demonstrating a complete @xmath0 calculation within our s@xmath0 methodology . _    despite the above limitations , the expectation values of the xc potential and of the exchange term of the @xmath0 self - energy calculated here are surprisingly close to those obtained in ref .   using _ ab - initio _ pseudopotentials at the dft / lda level . indeed , for the valence band top @xmath256 state and the conduction band bottom close to the @xmath257 state our calculated xc expectation values are -11.27 ev and -8.97 ev , respectively , while ref .   gives",
    "-11.80 ev and -9.61 ev for the corresponding states at the dft / lda level .",
    "the agreement is even better when comparing the expectation values of the bare exchange part of the @xmath0 self - energy . in this case",
    "we find -12.43 ev and -5.07 ev for the @xmath256 state and the @xmath257 state , respectively , to be compared to the corresponding values of -12.54 ev and -5.28 ev of ref .  .",
    "these results provide an _ a posteriori _ justification to our choice of calculating the xc potential using the epm charge density and the lda functional .",
    "table [ tab.2 ] compares our calculated quasi - particle excitation energies for electronic states at the @xmath160 point and for the conduction band edge of silicon with the results of refs .  .",
    "we find a good overall agreement between these different sets of calculations .",
    "taking into account that we are comparing our s@xmath0 scheme within the epm implementation with more sophisticated _ ab - initio _ calculations , such agreement is rather encouraging .",
    "figure [ fig6 ] shows the calculated quasi - particle spectral function @xmath258 with @xmath259 denoting the @xmath0 spectral function and @xmath260 .",
    "we note that eq .",
    "( [ eq.specfun ] ) is obtained by assuming that the off - diagonal matrix elements of the self - energy in the basis of the unperturbed wavefunctions are negligible .",
    "a diagonal approximation is not always justified , nonetheless we decided to adopt eq .",
    "( [ eq.specfun ] ) to be consistent with ref .  .",
    "figure [ fig6 ] shows good overall agreement between our calculations and the lda / paw results of ref .  .",
    "this comparison demonstrates once again the validity of our methodology .",
    "the results presented in sec .  [ sec.results ] demonstrate the feasibility of the self - consistent sternheimer approach to @xmath0 calculations in the simple case of a prototype implementation based on the empirical pseudopotential method .",
    "the extension of the present methodology to _ ab - initio _ approaches based on norm - conserving@xcite or ultrasoft@xcite pseudopotentials should not present any difficulties as the crucial issues in the calculation have already been addressed in this work .",
    "the main advantage of the present methodology consists of the definitive elimination of the unoccupied electronic states from the calculations of _ both _ the screened coulomb interaction and the non - interacting green s function .",
    "another appealing aspect is that our methodology constitutes a generalization to frequency - dependent perturbations of density - functional perturbation theory,@xcite which is a well established technique with a long history of successes .    as discussed in sec .",
    "[ sec.scaling ] the present approach is comparable in performance to standard@xcite @xmath0 techniques .",
    "the question remains on whether it is possible to make significant improvements over the methodology proposed here _ without compromising on the numerical accuracy_. the most time - consuming step of the entire procedure is the application of the single - particle hamiltonian @xmath23 to a search direction @xmath261 in the hilbert space spanned by the wavefunction basis set during the iterative solution of the linear systems in eq .",
    "( [ eq.linsys.1 ] ) . in order to accelerate this operation",
    "there are possibly three ways ahead : ( i ) the improvement of the minimization algorithms adopted , ( ii ) the use of sparse representations of the hamiltonian , and ( iii ) the use of smaller basis sets .",
    "\\(i ) the iterative solution of eq .",
    "( [ eq.linsys.1 ] ) is here performed by first solving for @xmath262 at fixed @xmath263 , and then by updating @xmath263 in the self - consistency cycle .",
    "it should be possible , at least in principle , to combine these two operations in a single minimization step .",
    "this could be achieved for instance by using the variational formulation of density - functional perturbation theory developed in ref .  , or by using simulated annealing techniques such as the car - parrinello method.@xcite",
    "both of these approaches were developed for hermitian systems , hence appropriate generalizations to non - hermitian systems would be required to solve eq .",
    "( [ eq.linsys.1 ] ) . as mentioned in sec .",
    "[ sec.conv ] the total number of cbicg iterations required to solve eq .",
    "( [ eq.linsys.1 ] ) is typically @xmath264 , therefore the variational formulation of dfpt or the car - parrinello minimization would be convenient if they resulted in a significant reduction of the number of iterations over this figure .",
    "\\(ii ) another possibility for improving the procedure presented in this work is to resort to a real - space representation of the kinetic energy operator in the single - particle hamiltonian .",
    "this can be achieved by calculating the kinetic energy on a real - space mesh using finite - differences methods.@xcite the main advantage of this approach would be to have @xmath0 calculations scaling with the cube of the system size @xmath198 instead of @xmath177 .",
    "however , in actual calculations the numerical prefactor associated with this scaling could be unfavorable .",
    "indeed , the fast fourier transforms used in a planewaves representation to calculate the product of the potential and the wavefunctions require @xmath265 floating point operations , while the cost of the real - space calculation of the laplacian operator to sixth order is @xmath266 ( for a supercell with orthogonal axes).@xcite while these estimates seem to speak in favor of the real - space method , it is advisable to consider that the preconditioner used here@xcite for the cbicg minimization can not be simply adapted to real - space calculations . in absence of effective preconditioners",
    "the planewave method remains advantageous for essentially any relevant system size .",
    "\\(iii ) another interesting option for improving our methodology is to drastically reduce the size of the basis set adopted .",
    "this could be achieved for instance by adapting our implementation to electronic structure packages exploiting local orbitals basis sets.@xcite interestingly the three possibilities here outlined are not mutually exclusive , and probably an appropriate combination of all of these would eventually open the way to the study of electronic excitations in very large systems using the @xmath0 method .    in summary , we propose a new methodology for performing @xmath0 calculations using the self - consistent sternheimer equation ( s@xmath0 ) .",
    "we show how to calculate the screened coulomb interaction and the non - interacting green s function without resorting to unoccupied electronic states .",
    "we successfully demonstrate our method within a planewaves empirical pseudopotential implementation and compare with previous studies for the prototypical test case of silicon . in our method",
    "the standard generalzied plasmon - pole approximation for the frequency dependence of the screened coulomb interaction has been replaced by a direct calculation along the imaginary frequency axis , followed by an analytic continuation to the real axis .",
    "in addition , we introduce the use of multishift linear system solvers for the simultaneous calculation of multiple frequency responses at the cost of one single iterative minimization .",
    "it is our plan to adapt the present approach to deal with first - principles pseudopotentials , and to explore the performance of our procedure in a local orbital real - space implementation .",
    "we hope that this work will stimulate further effort to develop improved methodologies for excited states calculations in large systems .",
    "is grateful to manish jain for drawing ref .   to his attention .",
    "this work was supported by national science foundation grant no .",
    "dmr07 - 05941 and by the director , office of science , office of basic energy sciences , materials sciences and engineering division , u.s .",
    "department of energy under contract no .",
    "de - ac02 - 05ch11231 .",
    "the research leading to these results has received funding from the european research council under the european community s seventh framework programme ( fp7/2007 - 2013 ) / erc grant agreement no .",
    "computational resources were provided by the oxford supercomputing centre .",
    "in this work we solve the linear systems in eq .",
    "( [ eq.linsys.1 ] ) using the complex biorthogonal variant ( cbicg ) of the conjugate gradient method ( cg ) following ref .  .",
    "this method is an extension of the standard conjugate gradients algorithm to the case of general complex matrices . as the cbicg algorithm introduced in ref .",
    "did not include preconditioning , in this appendix we describe the preconditioned version of the algorithm which we derived following ref .  .",
    "we are interested in solving the linear system @xmath267 with a a complex linear operator ( not necessarily hermitian ) , @xmath268 a complex vector , and @xmath269 the unknown solution vector . in the cbicg algorithm of ref .",
    "two sequences of residuals @xmath270 and @xmath271 are generated in such a way that successive residuals are biorthogonal [ i.e.  @xmath272 and @xmath273 . two sequences of search directions @xmath274 and @xmath275",
    "are generated so that successive directions are biconjugate [ i.e.  @xmath276 and @xmath277 .",
    "the algorithm starts by setting the initial residuals to @xmath278 ( @xmath279 being the initial guess for the solution vector @xmath269 ) and @xmath280 , and the initial search directions to @xmath281 and @xmath282 .",
    "next the solution vector , the search directions , and the residuals are updated at each iteration as follows : @xmath283 the time - consuming step in this algorithm corresponds to the application of the operators @xmath284 and @xmath285 to the search directions @xmath274 and @xmath275 . as there are two such operations per iteration ,",
    "the computational complexity is twice that of the standard conjugate gradient algorithm .",
    "the preconditioning of the linear operator can be achieved by left - multiplying the linear system in eq .",
    "( [ eq.axeqb ] ) by @xmath286 : @xmath287 .",
    "if we assume that the preconditioner @xmath288 can be written as @xmath289 , then we can rewrite the system as follows : @xmath290 by defining @xmath291 , @xmath292 , and @xmath293 we obtain the transformed system @xmath294 , for which the standard cbicg method applies . while this procedure is formally correct , it is not convenient to explicitly transform the linear operator",
    ". it is convenient instead to rewrite the procedure in terms of @xmath284 , @xmath268 , and @xmath269 by performing a few formal manipulations . for this purpose",
    "we make the substitutions @xmath295 and @xmath296 .",
    "some algebra leads straightforwardly to the preconditioned version of the cbicg algorithm : @xmath297 the preconditioned cbicg algorithm needs to be intialized with @xmath298 , @xmath299 , @xmath280 , and @xmath282 . in this work",
    "we have used the teter - payne - allan function as the preconditioner @xmath286.@xcite",
    "the iterative calculation of the screened coulomb interaction through eq .",
    "( [ eq.linsys.1 ] ) at finite real frequencies @xmath6 can be considerably more time - consuming than in the static ( @xmath300 ) case .",
    "simple tests indicate that the number of iterations required to achieve convergence increases with increasing frequency @xmath6 .",
    "this behavior suggests that the linear operator in eq .",
    "( [ eq.linsys.1 ] ) becomes progressively more ill - conditioned as the frequency @xmath6 increases .    in order to rationalize this observation",
    ", we here examine the condition number of the linear operator @xmath33 in eq .",
    "( [ eq.linsys.1 ] ) . the minimum number of iterations @xmath301 required for the solution of a linear system using the conjugate gradients algorithm is given by @xmath302 @xmath303 being the condition number of the linear operator and @xmath185 the desired relative accuracy.@xcite while the estimate eq .",
    "( [ eq.cg ] ) has been derived for the original cg algorithm , we found empirically that it also provides a reasonable description of the convergence rate of the complex cbicg version .",
    "the condition number @xmath303 of a linear operator can be calculated as the ratio of its largest to smallest eigenvalues . for a given valence state",
    "@xmath304 the linear operator @xmath305 in eq .",
    "( [ eq.linsys.1b ] ) has the eigenvalues @xmath306 and @xmath307 .",
    "let consider first the simplest case where @xmath25 and @xmath308 .",
    "in this case we find by inspection that the smallest eigenvalue is @xmath309 , @xmath310 being the fundamental energy gap and @xmath311 the valence bandwidth .",
    "it is common practice to set @xmath312 to avoid null eigenvalues .",
    "@xcite with this choice the smallest eigenvalue becomes @xmath310 . on the other hand ,",
    "the largest eigenvalue can be approximated by the cutoff energy of the wavefunction basis set @xmath313 . in this case",
    "the condition number reads @xmath314 . as an example , if we are using a plane - waves basis with a kinetic enegry cutoff of 30 ry , we have an electron energy gap of 1 ev , and the our desired accuracy is @xmath315 , then according to eq .",
    "( [ eq.cg ] ) the minimum number of iterations required to solve the linear system would be @xmath316 .",
    "empirical tests show that this estimate is quite accurate for the system considered in the present work . in order to improve the convergence rate",
    "it is useful to employ preconditioning techniques .",
    "we here adopt the teter - payne - allan preconditioner@xcite in order to `` compress '' the eigenvalue spectrum and thereby reduce the condition number .",
    "an ideal preconditioner would make the linear operator perfectly well conditioned ( @xmath183 ) . in this case",
    "the optimal number of iterations ( for a relative accuracy @xmath315 ) would be as small as @xmath317 .",
    "we have found empirically that by using the teter - payne - allan preconditioner the number of iterations required to achieve convergence was in all cases in the range @xmath3181540 .",
    "we now consider the case of @xmath319 .",
    "simple algebra shows that in this case @xmath320 when @xmath321 .",
    "hence in this case the larger the frequency @xmath6 , the better conditioned the linear system .",
    "we checked this result by explicit calculations .",
    "the worst case in terms of condition number is found when @xmath322 . in fact , as soon as the frequency exceeds the optical excitation threshold @xmath323 , the linear operator acquires null eigenvalues corresponding to the resonance condition @xmath324 . in this latter case the condition number @xmath325 exhibits significant structure , reflecting the joint density of states of the system .",
    "even after preconditioning the system , the number of iterations required to achieve convergence can be as high as @xmath326 , thus rendering this avenue unpractical .",
    "the calculation of the screened coulomb interaction for frequencies slightly off the real axis @xmath327 , with @xmath322 and small @xmath63 , leads to only a small improvement of the convergence rate .",
    "the difficulty of solving iteratively the linear system eq .",
    "( [ eq.linsys.1 ] ) for large positive frequencies is accompanied by the additional difficulty of adequately sampling the brillouin zone to describe the singularities at @xmath324 .",
    "altogether these considerations suggest that an iterative solution of the linear system along the real axis is not convenient from the computational viewpoint . for this reason we decided to evaluate the screened coulomb interaction along the imaginary axis and then to analytically continue the functions to the real axis using _",
    "pad approximants_.@xcite the motivation behind our choice becomes obvious after considering a simple plasmon - pole model of the screened coulomb interaction:@xcite @xmath328,\\ ] ] where @xmath88 is the pole frequency and @xmath329 the static screened coulomb interation .",
    "analytical continuation of this function to the imaginary axis yields @xmath330 equation ( [ eq.pp.im ] ) indicates that the screened coulomb interaction along the imaginary axis contains the same amount of information as the one on the real axis ( @xmath88 and @xmath329 ) , and at the same time does not exhibit any singularities . in this case",
    "the condition number reads ( assuming no preconditioning and @xmath331 for simplicity ) @xmath332^\\frac{1}{2}$ ] , and tends to unity for large imaginary frequencies . as a result , the worst case scenario for the solution of the linear system corresponds to the static case @xmath25 .    in summary , by solving iteratively the linear system along the imaginary axis",
    "we circumvent the difficulties associated with the ill - conditioning of the linear system in eq .",
    "( [ eq.linsys.1 ] ) occurring at real frequencies and the necessity of dense brillouin zone sampling .",
    "the details of the analytic continuation are discussed in appendix [ app.pade ] .",
    "a similar analysis can be carried out for the calculation of the green s function using the method introduced in sec .",
    "[ sec.green ] .",
    "it is straightforward to establish that in this case the condition number of the system is given by @xmath333 .",
    "as the infinitesimal @xmath79 is typically taken to be 0.1 ev , we are effectively dealing with a situation analogous to a small - bandgap semiconductor .",
    "the tpa preconditioner can be adopted to reduce the condition number to @xmath334 , where @xmath335 is the expectation value of the kinetic energy of the highest occupied state and is independent of the basis set cutoff .",
    "numerical tests confirm that this is indeed a sensible and effective strategy .",
    "in order to perform the analytic continuation of the screened coulomb interaction from the imaginary axis to the real axis , we employ diagonal pad approximants.@xcite the pad approximant of order @xmath197 is the optimal rational approximation to a target function @xmath336 known in @xmath197 distinct points @xmath337 ,  @xmath338 .",
    "when @xmath197 is an odd integer the diagonal pad approximant reads @xmath339 and its coefficients @xmath340 , @xmath341 are determined by matching the approximant to the target function in @xmath197 points @xmath342 ,  @xmath338 .",
    "both the coefficients and the pad approximant can be calculated very efficiently using a simple recursive algorithm.@xcite some experimentation indicates that approximants of order @xmath343 are necessary to reproduce a plasmon - pole spectral shape including a finite linewidth .",
    "this observation can be rationalized by considering that a plasmon - pole spectral function is completely defined by the values of the function at @xmath25 , the location , strength , and width of the pole , and the asymptotic value at @xmath344 .",
    "some of this information is redundant and can be obtained by using sum rules.@xcite the parity of the screened coulomb interaction can also be exploited to minimize the number of input frequencies .",
    "the advantage of the pad approximant is that a more refined description of the frequency - dependent screened coulomb interaction can simply be achieved by calculating additional points along the imaginary axis .",
    "we also investigated the possibility of analytically continuing the screened coulomb interaction by using a multi - pole expansion as suggested in ref .  .",
    "we tried one- , two- , and three - pole expansions by determining the coefficients using the simplex method of nelder and mead.@xcite the single - pole approximation appears robust but the quality of the real - axis continuation is poorer than what we obtained by using pad approximants .",
    "multi - pole approximations were found to be unreliable because of their high sensitivity to the initial guesses for the coefficients .",
    "our experience therefore is that the multi - pole expansion is not an optimal choice for an automated procedure where the analytic continuation has to be performed for every @xmath345 , @xmath136 , and @xmath99 of the screened coulomb interaction without manual intervention .",
    "the linear systems eqs .",
    "( [ eq.linsys.1.nscf ] ) and ( [ eq.green.3 ] ) can be solved efficiently by using the `` multishift '' cbicg method of ref .  .",
    "multishift methods exploit the knowledge gained during the iterative solution of the _ seed _ system @xmath346 to determine the solutions of the _ shifted _ system @xmath347 with only a small computational overhead .",
    "the rationale behind such method is that the seed system and the shifted system share the same krilov subspaces @xmath348 , therefore the residuals of the seed and of the shifted systems can be taken to be collinear.@xcite    this multishift technique allows us to determine the entire frequency - dependence of the dielectric matrix by performing one single static calculation for each set of parameters @xmath349,@xmath350 $ ] in eq .",
    "( [ eq.linsys.4 ] ) . for the seed system",
    "the algorithm is still given by eqs .",
    "( [ eq.cg1])-([eq.cg7 ] ) . for the shifted system",
    "we replace the calculation of the residuals @xmath351 and of the coefficients @xmath352 , @xmath353 corresponding to the frequency @xmath6 by the following relations : @xmath354 where the scaling factor @xmath355 is calculated through the recurrence relation @xmath356 in order to obtain collinear residuals @xmath270 and @xmath351 we need to initialize the algorithm using @xmath357 .    the use of eqs .",
    "( [ eq.shift.1 ] ) and ( [ eq.shift.2 ] ) allows us to skip the time - consuming operations involving the hamiltonian in eqs .",
    "( [ eq.cg1 ] ) and  ( [ eq.cg5 ] ) .",
    "this method is extremely convenient for determining the frequency - dependent susceptibility for many frequencies at the cost of one single calculation .",
    "we point out that this method still carries some drawbacks .",
    "one limitation is that this method can not be applied to the self - consistent system of eq .",
    "( [ eq.linsys.1 ] ) , because the know - term on the right - hand side depends on the frequency @xmath6 itself .",
    "therefore the use of the shifted cbicg method is only possible for _ non self - consistent calculations of the dielectric matrix _ and requires explicit matrix inversions to determine the screened coulomb interaction .",
    "this approach can be regarded as an improved version of the technique proposed in ref .  .",
    "another limitation is that the shifted cbicg method does not allow for the use of preconditioners .",
    "in fact the preconditioned seed system @xmath287 and the preconditioned shifted system @xmath358 do not share the same krilov subspaces , hence the residuals can not be taken to be collinear.@xcite the practical consequence is that for systems with large basis set energy cutoffs and small band gaps , the number of iterations required to achieve convergence could be impractically large .",
    "l. hedin and s. lundqvist , effects of the electron - electron and the electron - phonon interaction in the one - electron states of solids , in _ solid state physics _ , ed . by f. seitz , d. turnbull , and h. ehrenreich , ( academic , new york , 1969 ) , vol .",
    "23 , pag . 1 .",
    "had we truncated the integral along the real axis as proposed for the coulomb term , the @xmath359 term would have acquired a spurious frequency dependence associated with the semicircle closing the complex integration path ."
  ],
  "abstract_text": [
    "<S> we propose a novel approach to quasiparticle gw calculations which does not require the computation of unoccupied electronic states . in our approach </S>",
    "<S> the screened coulomb interaction is evaluated by solving self - consistent linear - response sternheimer equations , and the noninteracting green s function is evaluated by solving inhomogeneous linear systems . </S>",
    "<S> the frequency - dependence of the screened coulomb interaction is explicitly taken into account . in order to avoid the singularities of the screened coulomb interaction the calculations </S>",
    "<S> are performed along the imaginary axis , and the results are analytically continued to the real axis through pad approximants . as a proof of concept we implemented the proposed methodology within the empirical pseudopotential formalism and we validated our implementation using silicon as a test case . </S>",
    "<S> we examine the advantages and limitations of our method and describe promising future directions . </S>"
  ]
}