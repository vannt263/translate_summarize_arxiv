{
  "article_text": [
    "we study the following model . given finitely many classes ( or groups ) each containing a given initial number of members , new members arrive one at a time .",
    "for each new member arriving at time @xmath0 , with probability @xmath1 we create a new class in which we place the member ; with probability @xmath2 , we place the member in an existing class .",
    "we assume that each existing class attracts new members with probability proportional to a certain positive function of the cardinality of the group , called the _ reinforcement _ or _ weight scheme _ @xmath3 .",
    "if the groups are allowed to have different reinforcement schemes , then we show that looking at the asymptotics as time tends to infinity we have exactly three different regimes : one group is infinite and all the others are finite ; all groups are infinite ; all groups are finite .",
    "our main result , theorem  [ princres1 ] , shows that in the first regime the process will eventually create a unique infinite group : this happens when each group is reinforced quite a bit , but not too much with respect to the other groups . in the second regime",
    ", the cardinality of each group goes to infinity . finally , in the last regime , all the groups will be finite ; what happens is that the process creates various peaks : in the beginning one group dominates the others , but sooner or later another group will start dominating , and this change happens infinitely many times . in this way , no group dominates definitively the other groups .",
    "this is a kind of `` there is always a faster gun '' principle .",
    "our model is a generalization of two models from two different classes : one model from the class of _ preferential attachment models _ , as introduced in  @xcite and in  @xcite , and one model from the class of _ reinforcement processes _ , as introduced in  @xcite .",
    "the first main model we are generalizing was introduced and studied independently in  @xcite and in  @xcite , and later studied in more detail in  @xcite and  @xcite .",
    "this model is part of the class of _ preferential attachment models _ , which are models of growing networks , and which were first proposed in the highly - influential papers  @xcite and  @xcite . in  @xcite new vertices",
    "arrive at the network one at a time and send a fixed number @xmath4 of edges to already existing vertices ; the probability that a new vertex is linked to a given existing vertex is proportional to the in - degree of the respective existing vertex . here , the in - degree of a vertex is the number of children of that vertex .",
    "the model studied in  @xcite and  @xcite is as follows : consider a model of an evolving network in which new vertices arrive one at a time , each connecting by an edge to a previously existing vertex with a probability proportional to a function  @xmath3 of the existing vertex s in - degree .",
    "this function @xmath3 is called _ attachment rule _ , or _",
    "weight function _ , and it determines the existence of two main different regimes .",
    "the first regime corresponds to @xmath5 , and it was studied in  @xcite and  @xcite ; the second regime corresponds to for @xmath6 , and it was studied in  @xcite .",
    "the third regime corresponds to @xmath7 for @xmath8 , and it was studied in  @xcite . in the first two regimes",
    ", it is shown that the degrees of all vertices grow to infinity ; in the third regime there is a second phase as one vertex eventually dominates all other vertices .",
    "in the first regime , the so - called plya urn , the urn process is exchangeable and is the only case where exchangeability appears ; see @xcite .",
    "( for more results on preferential attachment models , see the survey @xcite . )",
    "preferential attachment models have been motivated by real - life problems , especially in regards to network and internet applications .",
    "one important example of growing networks is the world wide web , in which the more popular a page ( or vertex ) is the more hits it receives ; a similar principle applies to social interaction or to citation networks .",
    "another example is the one of users of a software program who can report bugs on a website .",
    "bugs with the highest number of requests get priority to be fixed .",
    "if the user can not find an existing report of the bug , they can create a new report .",
    "however , it could be that there are duplicate reports , in which case the number of requests is split between the reports , making it less likely that the bug the user found will get fixed . since bugs that have more requests appear higher up the search results , the user is more likely to add a request to an existing report than to a new one .",
    "this can be explained by the fact that such networks are built dynamically and that new vertices prefer to attach themselves to existing popular vertices with high in - degree rather than to existing unpopular vertices with low in - degree .",
    "the second main model we are generalizing is studied in  @xcite and  @xcite .",
    "it is known as the _ generalized plya urn process _ ; it belongs to the class of _ reinforcement processes _ and can be described as follows .",
    "given finitely many bins each containing one ball , new balls arrive one at a time .",
    "for each new ball , with probability @xmath9 we create a new bin in which we place the ball ; with probability @xmath10 , we place the ball in an existing bin .",
    "the probability that the ball is placed in an already existing bin is proportional to @xmath11 , where @xmath12 is the number of balls in that bin .",
    "the case with @xmath13 and @xmath14 is the well - known _ plya urn problem_. for @xmath13 and @xmath15 no new bins are created , and the process is called a _ finite plya process with exponent @xmath16_. if @xmath17",
    ", then the process is called an _ infinite plya process_. similarly to the preferential attachment models , for generalized plya urn processes with @xmath11 , it is known that for @xmath18 the number of balls in all bins eventually grows to infinity , whereas for @xmath19 one bin eventually comes to dominate all other bins .",
    "( a detailed review of a number of other interesting results on plya s urn processes and on reinforcement processes in general is provided in the survey  @xcite . )",
    "the generalized plya urn process has applications to many areas .",
    "we briefly mention one such application to biology ; for an extensive overview of other applications of generalized plya urn processes to reinforced random walks , statistics , computer science , clinical trials , biology , psychology and economics , see , for example , chapter 4 in  @xcite .",
    "the generalized plya urn process with @xmath13 is used in  @xcite and  @xcite to study a real - life application ; the reinforcement scheme used in these papers is set to @xmath20 , with @xmath15 , and real - life data are compared against different values of @xmath16 and initial configurations .",
    "more precisely , the authors study a colony of ants , which explores a chemically unmarked territory randomly , starting from the nest .",
    "the exploration is done on a fixed number @xmath21 of paths of various lengths .",
    "each ant passes along one of the @xmath21 paths leaves a pheromone mark and in this way infuences the following ant s decision in choosing a particular path .",
    "this decision is also influenced by whether the paths of various lengths are discovered at the same time , or whether they are discovered at different times . in the real - life experiment",
    "it is noticed in the case of paths of equal lengths that , after initial fluctuations , one of the paths becomes more or less completely preferred to the others .",
    "we will show in our paper that the above two models , belonging to these two different areas , are in fact closely related because they are both special cases of our much more general model .",
    "the first of our results , theorem  [ princres ] , proved for our general model , unifies the two above - described phase transition results for a very general class of weight functions @xmath3 ; the result holds in particular both for preferential attachment processes and for generalized plya s urn processes .",
    "it is worth noting that our condition on the weight function is much weaker than all previously - proved results for the models we generalize .",
    "moreover , in our main result , theorem  [ princres1 ] , we show , under no assumptions on the weight function , that we can have only three possible phases ; in the third phase , all groups ( resp . , vertices , bins ) stay finite as time tends to infinity . to the best of our knowledge ,",
    "this is the first time when a third regime as described in our theorem  [ princres1 ] , has been proved for any model of preferential attachment or plya s urn type . in the case of weight functions",
    "@xmath3 which give rise to the second phase , we devise in our theorem  [ testo1 ] , and , respectively , in corollary  [ rf ] , a test for obtaining an upper bound , and , respectively , a lower bound , on the probability that a given group ends up being dominant .",
    "the motivation for our model comes from the class of _ species sampling sequences _ , to which class our model belongs .",
    "species sampling sequences are models for exchangeable sequences @xmath22 with a prediction rule , that is , a formula for the conditional distribution of @xmath23 given @xmath24 for @xmath25 more precisely , given the first @xmath0 terms of the sequence @xmath22 , @xmath26 equals the @xmath27th distinct value observed so far with probability @xmath28 , for @xmath29 , and otherwise @xmath26 is a new value with distribution @xmath30 for some probability measure @xmath30 .",
    "species sampling sequences were first introduced and studied in @xcite and are now used extensively in bayesian nonparametric statistics ; see , for example ,  @xcite or @xcite for more on species sampling sequences or for their applications to statistics .",
    "we next introduce precisely our model .",
    "we consider the following model where at each step a new vertex and at most one new edge appear according to the following rules .",
    "the probability that the new vertex is disconnected is positive and may change in time .",
    "when a vertex is disconnected from the existing ones , it becomes a _ pioneer vertex_. we label the pioneer vertices in order of appearance .",
    "given that the new vertex is connected to an existing one , the latter is chosen with probability proportional to a reinforcement scheme of its degree .",
    "the graph formed with this procedure is the union of trees .",
    "each tree has a pioneer vertex as a root .",
    "the tree with root @xmath27 observed at time @xmath0 , is called the @xmath27th group ( or @xmath27th component ) by time @xmath0 .",
    "more formally , fix a collection of positive functions @xmath31 with @xmath32 and @xmath33 for all @xmath34 , and a sequence @xmath35 which takes values in @xmath36 $ ] . set @xmath37 and @xmath38 for all @xmath39 .",
    "set @xmath40 .",
    "we define the random variables @xmath41 and @xmath42 recursively as follows : @xmath43 while @xmath44 for all @xmath45 .",
    "moreover , @xmath46    notice that @xmath47 , and exactly for one index @xmath27 this difference equals 1 .",
    "the random variable @xmath48 is the cardinality of the @xmath27th group by time  @xmath0 .",
    "we call the process @xmath49 a _ generalized attachment model _ whose parameters are the sequence @xmath35 and the reinforcement functions @xmath50 , abbreviated with @xmath51 .",
    "we emphasize the fact that we do not make any assumptions on the update functions @xmath50 , other than positiveness , and @xmath52 is allowed to be random . as shown in theorem  [ princres1 ] , some of our strongest results hold for a group - dependent deterministic reinforcement scheme @xmath53 , that is , where each group @xmath12 follows its own reinforcement scheme @xmath54 , independently of the other groups . from the point of view of applications",
    ", this allows one to take into account the case where different groups have different update schemes , which is what would be expected in many real - life situations .",
    "we use the symbol @xmath55 to denote a generalized attachment model where the update functions @xmath56 are equal to the positive function @xmath3 for each @xmath57 .",
    "we briefly discuss next the link of our work to the recent literature .",
    "the two main models that we generalize were studied in detail in the particular case with reinforcement scheme proportional to @xmath58 , where @xmath15 .",
    "let us look first at the literature on preferential attachment models connected to our generalized attachment model .",
    "the preferential attachment model studied in  @xcite and @xcite is just @xmath59 for the particular case of @xmath60 , where we denoted by @xmath61 the number of groups ( resp .",
    ", vertices ) with no children at time @xmath0 , and where @xmath62 .",
    "then in the growing network , @xmath63 represents the in - degree at time @xmath0 of existing vertex @xmath12 with strictly positive in - degree ; that is , vertex @xmath12 has @xmath64 children . with probability @xmath65",
    ", a new arriving vertex attaches to an existing vertex @xmath12 with strictly positive in - degree @xmath64 ; with probability @xmath66 , a new arriving vertex attaches to one of the existing @xmath67 vertices with @xmath68 in - degree . for the case where the reinforcement function @xmath3 is linear or super - linear ,",
    "@xmath69 is bounded away from @xmath70 , so we can apply our results to the case of preferential attachment models .    in  @xcite",
    "the authors look at the preferential attachment model with reinforcement scheme @xmath71 for which they prove a similar result to our theorem  [ princres ] by using the original rubin construction . in  @xcite and  @xcite , respectively , in  @xcite , the authors give the limiting degree distribution for a wide range of linear , respectively , sub - linear , weight functions .    a different preferential attachment model was studied in  @xcite and  @xcite . in this model",
    "a new vertex arrives at each step and attaches to every existing vertex independently with a probability proportional to a concave weight function @xmath3 of the existing vertex s degree . in",
    "@xcite the authors prove in theorem 1.5 the same type of phase transition as in our theorem  [ princres ] , and they study the degree distribution . in",
    "@xcite they study the existence of a giant component , that is , of a connected component containing a positive fraction of all vertices .",
    "we turn now to the literature on the generalized plya urn model .",
    "this model corresponds to @xmath59 in the particular case with @xmath72 for all @xmath73 , for some fixed @xmath74 . in",
    "@xcite the authors consider both the generalized plya urn model with @xmath13 , when the number of bins is fixed , and with @xmath17 , and they prove by combinatorics techniques a similar result to our theorem  [ princres ] for the case of power functions .",
    "the case with @xmath17 and @xmath75 is studied in  @xcite under two additional assumptions involving the power function @xmath11 , assumptions whose validity is left as an open problem in that paper .",
    "the generalized plya urn model with @xmath13 was also the main object of study in  @xcite and  @xcite . in",
    "@xcite the author studied the case of two fixed bins under a number of technical assumptions on the function @xmath3 , which exclude , for example , the ( super)-exponential functions , and which assumptions are stated in section 4 of that paper .",
    "theorem 3.3.1 in  @xcite proves a result similar to our theorem  [ princres](i ) for the case of a fixed number @xmath4 of bins and under the assumption of monotonicity on the super - linear function @xmath3 .",
    "last , we provide below a definition of species sampling sequences and why @xmath59 is such a sequence . consider a polish space @xmath76 , and let @xmath77 be a diffuse probability measure on @xmath76 , that is , @xmath78 , for all @xmath79 .",
    "denote with @xmath80 the indicator function of the event @xmath81 . a sequence of random variables @xmath82 , with @xmath83 , on @xmath76 which has the distribution @xmath84",
    "is called a _ species sampling sequence _ whenever @xmath85 , @xmath86 , and @xmath87 are @xmath88 measurable , where @xmath89 .",
    "it corresponds to @xmath59 for the case with @xmath90 and @xmath91 for all @xmath92 .",
    "in particular , the blackwell  macqueen urn scheme , also known as chinese restaurant process , is a species sampling sequence with the choice @xmath93 ; it corresponds to @xmath59 with @xmath94 and @xmath95 for all @xmath92 .    in this paper",
    "we give a complete characterization of the existing phases for a very general class of update functions , for the case @xmath96 and for all nonnegative random sequences @xmath97 , with @xmath98 for all @xmath92 . in particular we do not assume any monotonicity on @xmath3 , and our only assumption on @xmath3 is for theorem  [ princres](i ) , and it controls the oscillation of the reinforcement function .",
    "moreover , we prove in theorem  [ princres1 ] that for any group - dependent deterministic reinforcement scheme @xmath53 , where @xmath53 are only assumed to be positive , we can only have three possible phases .",
    "we prove the existence of a third phase by an example .",
    "we emphasize the fact that exactly three phases are admitted for this model .",
    "the following are our main results .",
    "[ princres ] consider a @xmath59 .",
    "suppose that @xmath99 , for some @xmath100 and all @xmath101 .",
    "let @xmath102    if @xmath103 then there will be , a.s .",
    ", exactly one group whose cardinality tends to infinity , all the other groups being finite .",
    "the cardinality of each ( created ) group tends to infinity a.s . if and only if @xmath104    the second condition in ( [ spb ] ) describes a large class of sequences @xmath105 whose reciprocal is summable .",
    "in particular it contains all the monotone sequences , and all the convergent series with @xmath106 .",
    "this condition is used to control the oscillation in the sequence .",
    "we believe that only the first condition in ( [ spb ] ) is needed for the conclusion .",
    "we will show that all the monotone sequences satisfy the second assumption in  ( [ spb ] ) ; to prove ( [ spb ] ) for @xmath107 follows similar reasoning and will be omitted .",
    "we have for large @xmath108 , @xmath109 } 1/f^2(s)+\\sum _ { s = k+1+[f(k+1)]}^{\\infty } 1/f^2(s)\\le\\frac { f(k+1)}{f^2(k+1 ) } \\\\ & & { } + \\frac{1}{f(k+1+[f(k+1)])}\\sum_{s = k+1+[f(k+1)]}^{\\infty } 1/f(s ) \\\\ & \\le&\\frac{f(k+1)}{f^2(k+1)}+\\varepsilon\\frac{1}{f(k+1)}=\\frac { 1}{f(k+1 ) } \\frac{\\varepsilon+1}{\\varepsilon}\\end{aligned}\\ ] ] for some @xmath110 , where for the last inequality we used the fact that@xmath111}^{\\infty } 1/f(s)$ ] converges to @xmath68 as @xmath112 .",
    "we denoted by @xmath113 $ ] the integer part of @xmath114 . therefore @xmath115    if we remove the hypothesis that @xmath116 is bounded away from one , and suppose that @xmath117 , then by borel ",
    "cantelli s lemma there exists a random time @xmath118 such that for any time @xmath119 a new group is formed .",
    "hence the cardinality of each group will remain finite , and only finitely many groups will end up having a cardinality larger than @xmath70 .",
    "we do not study the case of @xmath120 and @xmath121 .",
    "the following result is a corollary to the proof of theorem [ princres](i ) .",
    "it generalizes the results contained in  @xcite about the degree of vertices in the preferential attachment model .",
    "[ findegree ] if the hypothesis of theorem [ princres ] holds , then@xmath122 for only finitely many @xmath27 .",
    "the following theorem establishes that @xmath123 can have only three possible phases .",
    "the theorem holds true if the @xmath124 are random functions independent of @xmath116 satisfying the conditions of the theorem almost surely .",
    "[ princres1 ] consider a @xmath123 .",
    "suppose that @xmath125 , for some @xmath100 and all @xmath101 .    if @xmath126 then there will be , a.s .",
    ", one group whose cardinality tends to infinity , all the other groups being finite .    if @xmath127 then either the cardinality of each ( created ) group tends to @xmath128 , a.s .",
    ", or each of them will be eventually finite , a.s .",
    "we show in example  [ ex1 ] that for the collection of update functions @xmath129 , the cardinality of each group remains finite , a.s .",
    "the third phase seems to arise only when for fixed @xmath0 , @xmath130 is an unbounded sequence .",
    "the previous two theorems rely on a novel modification of a well - known tool used in reinforced random walk processes , the rubin construction , which embeds @xmath123 .",
    "we believe that such a generalized rubin construction as introduced in our paper could have wider applicability to other preferential attachment models .    in the second part of the paper , we are going to estimate the probability that a given group is the leading one .",
    "our first result concerns a _ reinforced urn model_. consider an urn with @xmath21 white balls and @xmath131 red ball and with reinforcement scheme @xmath3 . then if we pick a ball at random , it is white with probability @xmath132 , and red with probability @xmath133 .",
    "suppose that by the time of the @xmath0th extraction we picked @xmath12 white balls and @xmath134 red ones .",
    "the probability to pick a white ball becomes @xmath135 .",
    "we call the urn with these initial conditions and dynamics a reinforced urn model with parameters @xmath21 and @xmath3 [ abbreviated @xmath136 . denote by @xmath137 the probability measure referring to @xmath138 .",
    "we have the following estimate .",
    "[ estur ] fix any @xmath57 and consider a @xmath139 with @xmath140 .",
    "we have @xmath141 where @xmath142 .",
    "the above theorem sheds deeper insight on the evolution of @xmath139 and on theorem  [ princres](i ) : it shows that the leading side in the beginning has a great probability to stay the dominant side . as an example of the power of our bound , take @xmath143 . in this case",
    ", a simple computation gives that @xmath144 hence for large initial weights @xmath21 the white has an overwhelming chance to be the one with cardinality tending to infinity .",
    "the estimate in ( [ bmsb ] ) improves theorem  3.6.2 in  @xcite .",
    "theorem [ estur ] should be also compared with theorem  3 in  @xcite , which is proved under the technical assumptions on the update function @xmath3 stated in section 4 of that paper .",
    "note also that the bound above is an improvement on the upper bound which could be obtained in ( [ bmsb ] ) by means of a similar reasoning to the one in propositions  2.1 and  3.1 from  @xcite .",
    "the cause for this is that the lower / upper bounds in  @xcite are rough for large initial weights .",
    "this is one main reason why the methods there only work for finite graphs and not also for infinite graphs .",
    "our proof is based on an embedding of @xmath138 into brownian motion , and gives robust estimates for all initial weights .",
    "next we turn again to @xmath59 .",
    "suppose that @xmath145 .",
    "theorem  [ princres](i ) guarantees the existence of a unique group whose cardinality goes to infinity .",
    "we call this the leading group . denote by @xmath146 the label of the leading group . in other words , @xmath147 if and only if the leading group is the @xmath12th one .",
    "our goal is to test if a given group , which has a certain advantage on the others , is the leader .",
    "we start by giving an upper bound for the tail of _ lead_.    we give the following construction of @xmath148 .",
    "suppose we have two sequences of random variables , @xmath149 and @xmath150 , satisfying the following .",
    "the variables @xmath151 are i.i.d .",
    "bernoulli with mean @xmath152 , while the variables @xmath153 are described recursively .",
    "we define @xmath154 , and @xmath155 for all @xmath156 . moreover , set @xmath157 .",
    "denote by @xmath158 the @xmath159-algebra generated by @xmath160 , with @xmath161 .",
    "suppose we defined @xmath162 , which is @xmath88-measurable .",
    "the random variable @xmath153 can be chosen to have the following distribution : @xmath163 moreover , we can choose @xmath153 to be independent of @xmath164 with @xmath165 .",
    "denote by @xmath166 .",
    "we define @xmath167 finally , let @xmath168 .",
    "we have that @xmath169 is distributed like the process @xmath170 described in section  [ main ] . at time @xmath0 , @xmath151 will determine if the new vertex is disconnected , and @xmath153 will determine to which of the existing vertices the new arrived will adhere _ if _ it is not disconnected .",
    "notice that @xmath153 is defined also in the case that @xmath171 , that is , in the case that the new vertex is disconnected .",
    "we denote by @xmath172 and @xmath173 . in words , @xmath174 is the time when the @xmath27th group is formed .",
    "we say that the @xmath27th group is generated by the @xmath175th group if @xmath176 ; that is , if we flipped the value of @xmath177 into  @xmath68 , then the new arrival would have joined the group @xmath175 . in this case",
    "we say that @xmath175 is the parent of @xmath27 .",
    "notice that there exists exactly one parent for each integer different from one .",
    "we build a random tree @xmath178 , whose root is one , joining each integer to its parent .",
    "we say that a vertex is at level @xmath0 if its distance from the root is @xmath0 .",
    "denote by @xmath179 the vertices at level @xmath0 .",
    "let @xmath180 .",
    "we have :    [ testo1 ] suppose that the assumptions of theorem  [ princres ] hold",
    ". then @xmath181,\\ ] ] where the sequence @xmath182 as @xmath183 , for fixed value of @xmath184 and @xmath185 , and @xmath186 .",
    "the quantities @xmath187 , @xmath188 and @xmath4 are computable .",
    "the functions @xmath189 are computable for fixed values of @xmath190 and @xmath191 .",
    "the following result is a direct consequence of theorems  [ testo1 ] and  [ estur ] .",
    "[ rf ] suppose that the assumption of theorem [ princres ] holds .",
    "then @xmath192,\\end{aligned}\\ ] ] where the quantities @xmath189 , @xmath4 and @xmath187 and @xmath188 are the same as theorem  [ testo1 ] .    the rest of the paper is structured as follows : in section [ proof21 ] we introduce our generalized rubin construction and give the proof of theorem  [ princres](i ) . in section  [ proof22 ]",
    "we give the proof of theorem  [ princres](ii ) . in section  [ proof23 ]",
    "we prove our main result , theorem  [ princres1 ] , and present an example where the third phase occurs . in section  [ prooft1 ]",
    "we introduce our brownian motion embedding and provide the proof of theorem  [ estur ] . in section  [ lead ] we give the proofs of theorem  [ testo1 ] and of corollary  [ rf ] .",
    "finally , in the we give a brief introduction to the rubin construction , as introduced in  @xcite .",
    "we introduce a modified version of the rubin construction which fits our model . for a detailed explanation of the original rubin construction , see , for example ,  @xcite and  @xcite .",
    "fix a parameter @xmath100 .",
    "we first focus on the case @xmath193 , that is , @xmath194 , and then we extend to the more general case @xmath99 using a coupling .",
    "for any set @xmath195 , let @xmath196 = \\inf\\bigl\\ { x \\dvtx\\ # \\bigl(a \\cap[0,x]\\bigr ) \\ge n+1\\bigr\\},\\ ] ] where the infimum of an empty set is @xmath128 . in words , @xmath197 $ ] is the @xmath198th element of  @xmath81 , ordered from the smallest to the largest .",
    "for example , if @xmath199 , then @xmath200=2 $ ] and @xmath201= 6 $ ] , @xmath202 = \\infty$ ] .",
    "notice also that for the example @xmath203 , is not possible to identify the @xmath198th element .",
    "in fact , in this case , we have that @xmath204 = 0 $ ] for all @xmath205 .    notice that @xmath204 $ ] is always a nondecreasing sequence ,",
    "hence @xmath206 $ ] exists , possibly infinite . for",
    "each @xmath207 let @xmath208 be a sequence of independent exponential@xmath209 random variables , with @xmath210 .",
    "moreover let @xmath211 be a sequence of i.i.d .",
    "bernoulli such that @xmath212 .",
    "we are going to use these sequences to generate a @xmath148 .",
    "the bernoullis will be used to create new groups , while the exponentials play a central role in the allocation of new individuals into existing groups .",
    "we are assuming that all the variables involved are independent of each other .",
    "set @xmath213 , for all @xmath214 .",
    "then , for @xmath215 , let @xmath216 in words , for each @xmath217 , the processes @xmath218 are independent processes with the property that @xmath219 are distributed like binomial with parameters @xmath220 and @xmath10 , while @xmath221 is a random subset of @xmath222 composed by @xmath68 and all the partial sums of the sequence @xmath223 with @xmath224 .",
    "to each element @xmath221 we associate a corresponding bernoulli as follows .",
    "let @xmath225 be a random function defined by @xmath226 ) { { \\,\\stackrel{\\mathrm{def}}{=}\\,}}r^{{({1})}}_{n}$ ] .",
    "the elements in @xmath221 with corresponding bernoulli equal to one , are used to generate new groups for @xmath148 .",
    "the other ones will _ potentially _ belong to the first group and will be labeled one .",
    "we will clarify the last sentence at the end of the construction .",
    "define @xmath227 that is , @xmath228 is composed of \\{0 } and all the points in @xmath229 with bernoulli equal to @xmath68 .",
    "these are the points which do not generate other groups .",
    "we label the points in @xmath228 with @xmath70 . set @xmath230 and define @xmath231",
    "the random variable @xmath232 is the time when the second group is formed .",
    "given @xmath232 , let @xmath233 + \\sum_{i=1}^{n } \\frac { w_{i}^{{({2})}}}{f(n_{2}(i))}\\dvtx n \\ge0 \\biggr\\}\\ ] ] and @xmath234 + \\sum_{i=1}^{n } \\frac { w_{i}^{{({2})}}}{f ( n_{2}(i ) ) } \\dvtx\\mbox { either } n = 0 \\mbox { or both } n \\ge1 \\mbox { and } r^{{({2})}}_{n } = 0 \\biggr\\}.\\ ] ] we label the elements of @xmath235 using 2 . define the function @xmath236 as follows .",
    "if @xmath237 = \\xi_{1}[j]$ ] , for some @xmath238 , then @xmath239 ) = r^{{({1})}}_{j}$ ] . the latter is well defined because all the elements of @xmath221 are a.s . distinct . if @xmath237 = ( \\xi_{2}\\setminus\\xi_{1})[j]$ ] for some @xmath238 , then @xmath239 ) = r^{{({2})}}_{j}$ ] .",
    "notice that @xmath228 and @xmath240 are disjoint , and their union is a proper subset of @xmath241 .",
    "let us describe in words the variables defined so far .",
    "the reinforcement plays no role up to time @xmath232 .",
    "the latter random variable is geometrically distributed with mean @xmath242 . at time @xmath232 , the first group has cardinality @xmath232 , because we count also the point @xmath68 , and a second group is formed .",
    "the random point @xmath243 $ ] is labeled 2 , in fact it belongs to @xmath244 , and it is the smallest point belonging to this random set .",
    "the next point on the line , that is , @xmath245 $ ] can have label @xmath70 , @xmath246 or no label at this stage .",
    "if the latter happens , we label this point with  3 .",
    "if it belongs to @xmath228 , respectively , @xmath240 , its label will be 1 , respectively , 2 . notice that by the definition of these sets , if @xmath245 \\in\\widetilde { \\xi}_{1 } \\cup\\widetilde{\\xi}_{2}$ ] then @xmath247 ) $ ] must be equal to zero .",
    "on the other hand , in the case that @xmath247 ) = 1 $ ] then a new group is formed , which is labeled @xmath248 . the probability that this happens is @xmath152 .",
    "next we want to compute the probability that @xmath245 $ ] has label 1 .",
    "we have the following equality : @xmath249 \\in\\widetilde { \\xi}_{1}\\bigr\\ } \\nonumber \\\\[-8pt ] \\\\[-8pt ] \\nonumber & & \\qquad = \\bigl\\{\\xi_{1}[\\tau_{2}+1]- \\xi_{1}[\\tau_{2 } ] < \\widetilde{\\xi}_{2}[1 ] - \\xi_{1}[\\tau_{2 } ] \\bigr\\ } \\cap \\bigl\\ { g_{2 } \\bigl(\\xi_{1}[\\tau_{2}+1 ] \\bigr ) = 0 \\bigr\\}.\\end{aligned}\\ ] ] note that @xmath243 = \\xi_{1}[\\tau_{2}]$ ] . given @xmath232 , the two events appearing on the right - hand side of ( [ eve ] ) are independent , because the first one depends on the exponentials while the second is determined by the bernoullis .",
    "the probability of the second event , conditionally on @xmath232 , is @xmath10 .",
    "if the random variable @xmath245 $ ] was labeled  1 , then it would belong to @xmath228 and would be equal to @xmath250 = \\sum _ { i=1}^{\\tau_{2 } + 1 } w_{i}^{{({1})}}/f \\bigl(n_{1}(i ) \\bigr ) = \\xi_{1}[\\tau_{2 } ] + w_{\\tau_{2}+1}^{{({1})}}/f \\bigl(n_{1}(\\tau_{2}+1 ) \\bigr).\\ ] ] if @xmath245 $ ] was labeled 2 , then it would belong to @xmath240 and would be equal to @xmath251 = \\xi_{2}[\\tau_{2 } ] + w_{1}^{{({2})}}/f ( 1 ) $ ] . hence @xmath252&= & \\xi_{2}[\\tau_{2 } ] + \\min \\biggl(\\frac{w_{\\tau _ { 2}+1}^{{({1})}}}{f ( n_{1}(\\tau_{2}+1 ) ) } , \\frac{w_{1}^{{({2})}}}{f ( 1 ) } \\biggr ) \\\\ & = & \\xi_{2}[\\tau_{2 } ] + \\min \\biggl(\\frac{w_{\\tau_{2}+1}^{{({1})}}}{f ( \\tau_{2 } ) } , \\frac{w_{1}^{{({2})}}}{f ( 1 ) } \\biggr),\\end{aligned}\\ ] ] where we used @xmath253 .",
    "this last equality comes from the fact that among  @xmath254 , with @xmath255 , the only bernoulli taking value one is @xmath256 .",
    "as @xmath257 equals one plus the number of zeroes among the first @xmath232 bernoulli , it is equal to @xmath232 .",
    "the first event on the right - hand side of ( [ eve ] ) can be rewritten as @xmath258 given @xmath232 , the random variable @xmath259 is exponentially distributed with mean @xmath260 . by a simple integration , we can argue that the probability that , among two independent exponentials , a given one is the smallest is equal to its parameter divided by the sum of the parameters .",
    "hence the probability of the event in  ( [ eve1 ] ) , conditionally on @xmath232 , is @xmath261 .",
    "the probability of the event described in  ( [ eve ] ) , conditionally on @xmath232 , is @xmath262 we infer that the conditional probability that @xmath245 $ ] is labeled 2 is @xmath263 . this is consistent with what happens in @xmath194 .",
    "suppose we defined @xmath264 .",
    "define @xmath265 \\bigr ) = 1\\bigr\\},\\ ] ] that is , the time when the @xmath4th group is formed .",
    "given @xmath266 let @xmath267 + \\sum_{i=1}^{n } \\frac{w_{i}^{{({m-1})}}}{f(n_{m}(i))}\\dvtx n\\ge1 \\biggr\\}\\ ] ] and @xmath268 + \\sum_{i=1}^{n } \\frac{w_{i}^{{({m-1})}}}{f(n_{m}(i))}\\dvtx\\mbox { either } n=0",
    "\\nonumber \\\\[-8pt ] \\\\[-8pt ] \\nonumber & & \\hspace*{72pt}\\qquad { } \\mbox{or both } n\\ge1 \\mbox { and } r^{{({m})}}_{n } = 0 \\biggr\\}.\\end{aligned}\\ ] ] the elements of @xmath269 are labeled @xmath4 .",
    "moreover let @xmath270 be defined as follows .",
    "if there exists @xmath12 such that @xmath271 = \\xi_{m-1}[j]$ ] , then @xmath272 ) = g_{m-1 } ( \\xi_{m-1}[j ] ) $ ] .",
    "if @xmath271 = ( \\xi_{m}\\setminus\\xi_{m-1})[j ] $ ] for some @xmath12 , then set @xmath273 ) = r^{{({m})}}_{j}$ ] .",
    "denote by @xmath274 .",
    "each point @xmath275 belongs , a.s .",
    ", to exactly one @xmath276 for some @xmath277 , that is , @xmath278 . in our construction , we label the point @xmath279 with  @xmath280 if and only if @xmath281 .",
    "define the random function @xmath282 as follows .",
    "if @xmath283 = \\widetilde{\\xi}_{j}[s ] $ ] for some ( a.s . unique ) pair @xmath284 , then @xmath285 ) = r^{{({j})}}_{s}.$ ] notice that @xmath286 can be used to generate a generalized attachment model , as follows . denote by @xmath287 \\mbox { has label $ i$}\\bigr\\}.\\ ] ] then @xmath288 is distributed like the process @xmath289 introduced in section  [ main ] . to see this ,",
    "suppose that in the set @xmath290 , \\mbox { with } i \\le n\\}$ ] there are exactly @xmath291 points labeled @xmath27 , with @xmath292 for some @xmath293 satisfying also @xmath294 for all @xmath295 .",
    "given this , the probability that @xmath296 $ ] is labeled @xmath297 , that is , the probability that @xmath298)$ ] equals one , is exactly @xmath152 .",
    "given that @xmath299 $ ] is not labeled @xmath297 , then the probability that it is labeled @xmath12 , with @xmath300 , is exactly @xmath301 where we used the memoryless property of the exponential random variables .",
    "in fact , using this property , given that @xmath299 $ ] is not labeled @xmath297 , the random variable @xmath299- \\xi[n]$ ] is distributed like the minimum of @xmath4 exponentials with parameters @xmath302 , for @xmath303 .",
    "the probability that the @xmath12th exponential is the minimum is given exactly by ( [ permo ] ) through a simple integration .",
    "summarizing , given that in the set @xmath290,$ ] with @xmath304 there are exactly @xmath291 points labeled @xmath27 , with @xmath305 and @xmath306 for some @xmath307 , the probability that @xmath299 $ ] is labeled @xmath12 , with @xmath300 , is @xmath308    define @xmath309 + \\sum_{i=1}^{\\infty } \\frac { w_{i}^{{({m})}}}{f(n_{m}(i))},\\ ] ] and for any integer @xmath310 , set @xmath311 + \\sum_{s=1}^{n } w^{{({j})}}_{s}/f \\bigl(n_{j}(s ) \\bigr ) \\dvtx n \\ge0 \\biggr\\}.\\ ] ] in the next result , we prove that @xmath312 is a.s .",
    "finite , for any @xmath214 .",
    "this , together with  ( [ xim ] ) and ( [ ximtil ] ) , implies that @xmath313 is an accumulation point for @xmath314 and @xmath315 .",
    "we say that a vertex @xmath175 is generated by @xmath12 if @xmath316 \\in\\xi^{*}_{j}$ ] .",
    "notice that each vertex ( different from 1 ) is generated by exactly one other vertex .",
    "our proof of lemma  [ finit ] relies on the construction of a random tree @xmath317 , built by connecting each vertex to its parent .",
    "notice that this random tree shares the same distribution with @xmath178 , introduced before theorem  [ testo1 ] .",
    "suppose that @xmath318 .",
    "if we switched @xmath319)$ ] from  1 to 0 , we would have that @xmath320 $ ] would have been a point of @xmath321 , and hence it would have had label @xmath12 .",
    "fix @xmath322 .",
    "notice that even if the bernoulli associated to the point @xmath323 $ ] equals  1 , this point might not be able to generate a child in @xmath317 using the exponentials and bernoulli that have been defined so far .",
    "this is the case if @xmath324 ) = \\infty$ ] , when infinitely many vertices have already been generated by the time we reach @xmath323 $ ] and all the @xmath325 have already been used .",
    "this is going to be an important point in the proof of lemma  [ genac ] .",
    "[ finit ] the random variables @xmath326 , with @xmath217 , are almost surely finite .",
    "fix @xmath217 . set @xmath327 , and let @xmath328",
    ". then @xmath329 , with @xmath330 are @xmath331 and are independent of the @xmath332 , with @xmath330 . if @xmath333 , then @xmath334 . hence @xmath335",
    "+ \\sum_{i=1}^{\\infty } \\sum _ { j= z_{m}(i)}^{z_{m}(i+1 ) -1}\\frac{w_{j}^{{({m})}}}{f(n_{m}(j ) ) } \\\\ & = & \\xi[\\tau_{m } ] + \\sum_{i=1}^{\\infty } \\frac1{f(i ) } \\sum_{j= z_{m}(i)}^{z_{m}(i+1 ) -1}w_{j}^{{({m})}}.\\end{aligned}\\ ] ] as the series in the latter expression is composed by nonnegative random variables , it is a.s .",
    "finite if its mean is finite .",
    "its mean is exactly @xmath336 to see this , notice that @xmath337 , is independent of @xmath338 , @xmath339 , which implies @xmath340 = \\frac1{1-p}.\\ ] ] moreover , we have that @xmath341 $ ] is stochastically smaller than @xmath342 this is because @xmath343 - \\xi[n-1]$ ] is stochastically smaller than an exponential random variable whose mean is smaller than @xmath344 .",
    "moreover , the random variable @xmath266 is negative binomial with parameters @xmath4 and @xmath152 .",
    "this can be checked by induction ; in fact , @xmath345 is geometrically distributed with mean @xmath242 .",
    "suppose this is true for @xmath346 .",
    "then we have to wait for an independent @xmath347 to create the next group .",
    "combining this fact with ( [ sumf ] ) we have that @xmath341<\\infty $ ] a.s .",
    "this , together with ( [ finf ] ) implies the lemma .    in the next result",
    "we establish the link between the behavior of the generalized attachment model and the quantity @xmath348 .",
    "[ genac ] the infimum @xmath348 , is a.s .",
    "attained , that is , it is actually a minimum .",
    "the minimizer is a.s .",
    "moreover @xmath349 = \\inf_{i } x^{*}_{i } \\qquad\\mbox{a.s.}\\ ] ]    we select a random subtree of @xmath317 , denoted by @xmath350 , as follows .",
    "the root of this tree is 1 ( i.e. , it is identified with the first group ) . given that a vertex @xmath12 belongs to @xmath351",
    ", its offspring will be those vertices @xmath175 such that @xmath352 \\in\\xi^{*}_{j}\\quad \\mbox{and}\\quad { x^{*}_{u } } < x^{*}_{j}.\\ ] ] recall that @xmath316 = \\xi_{u-1}[\\tau_{u}]= \\xi_{u}^{*}[0].$ ] we are going to prove the following statement : @xmath353 < m$. \\end{tabular}\\ ] ] before we prove ( [ fqaf ] ) we argue that this statement would imply the lemma .",
    "we need only consider the vertices of @xmath351 .",
    "in fact , if @xmath12 is not a vertex of @xmath351 , then there exists a vertex @xmath175 such that @xmath354 .",
    ".    if ( [ fqaf ] ) holds , then for any @xmath191 there are only finitely many vertices @xmath175 in @xmath351 such that @xmath356 .",
    "hence , as each @xmath357 is a.s .",
    "finite , we have that @xmath358 is actually a minimum .",
    "next we prove that the minimizer is a.s .",
    "unique . to prove this last statement",
    ", we prove that for each @xmath359 , we have that @xmath360 and @xmath361 are a.s .",
    "different . to see this ,",
    "notice that @xmath362 $ ] only depends on @xmath363 with @xmath364 .",
    "hence @xmath365 $ ] is independent of @xmath366 $ ] which is determined by a disjoint collection of exponentials and bernoullis .",
    "the probability that @xmath365 $ ] and @xmath367 $ ] are equal is 0 , as they are continuous independent random variables .",
    "this is exactly the probability that @xmath368 .",
    "as the set of @xmath369 , is countable , @xmath360 are all , a.s . , distinct .",
    "next we show that ( [ fqaf ] ) implies ( [ info ] ) .",
    "as already mentioned , the sequence @xmath343 $ ] is a.s .",
    "nondecreasing , that is , @xmath296 \\ge\\xi[n]$ ] , a.s .",
    "$ ] a.s . exists .",
    "notice that for each @xmath27 , @xmath360 is the limit of an increasing sequence taking values in @xmath286 . to see this , notice that @xmath371 + \\sum_{j=1}^{n } \\frac{w_{j}^{{({i})}}}{f(n_{i}(j ) ) } < x^{*}_{i}\\qquad \\forall",
    "n \\ge1,\\ ] ] by the definition of @xmath372 .",
    "hence infinitely many points labeled @xmath27 are smaller than @xmath372 , yielding @xmath373 ) = \\infty$ ] .",
    "this implies that @xmath370 \\le x_{i}^{*}$ ] for each @xmath374 , that is , @xmath370 \\le\\inf_{i } x_{i}^{*}$ ] .",
    "now we turn to the proof of the other inequality which implies  ( [ info ] ) .",
    "fix @xmath375 .",
    "it is sufficient to prove that  ( [ fqaf ] ) implies @xmath376 } \\le \\inf_{i } x^{*}_{i } - { \\varepsilon}\\bigr ) < \\infty.\\ ] ] in fact , if ( [ acm1 ] ) holds , only finitely many @xmath175 satisfy @xmath377 ) $ ] is infinite . denote the set of labels of these groups by @xmath378 . for each element @xmath175 of the finite set @xmath378",
    ", there are only finitely many points of @xmath379 which are smaller than @xmath380 , for otherwise we would have @xmath381 which would yield a contradiction .",
    "hence , for each element @xmath175 of @xmath378 , the set @xmath382 $ ] is finite .",
    "for each @xmath383 we have that there exists a @xmath384 such that @xmath385 \\in\\xi^{*}_{u}$ ] .",
    "this implies that @xmath386 = \\bigcup_{u \\in b } \\xi^{*}_{u } \\cap\\bigl[\\inf_{i } x^{*}_{i } - { \\varepsilon}\\bigr],\\ ] ] and the latter is a finite set .",
    "notice that @xmath387 could take a negative value , but this is not a problem for our reasoning , as then the set appearing in ( [ acm1 ] ) would be empty , and there would be nothing to prove .",
    "next , we prove that ( [ fqaf ] ) implies ( [ acm1 ] ) .",
    "fix a vertex @xmath175 of @xmath351 .",
    "denote by @xmath388 the ancestors of @xmath175 in @xmath351 , that is , the vertices lying on the unique self - avoiding path connecting @xmath175 to the root @xmath70 .",
    "notice that we do not consider @xmath175 ancestor of itself .",
    "if @xmath175 satisfies @xmath389 \\le \\inf_{i } x^{*}_{i } - { \\varepsilon}$ ] , then @xmath175 belongs to @xmath351 .",
    "in fact , @xmath389 \\ge\\xi^{*}_{u(i)}[1]$ ] while @xmath390 , for all @xmath391 .",
    "hence , @xmath392 \\le x^{*}_{u(i-1)},$ ] where we set @xmath393 . as we are assuming that  ( [ fqaf ] ) holds , the random tree @xmath351 has only finitely many vertices @xmath394 satisfying @xmath395>m$ ] . as @xmath396 , a.s .",
    ", we have that  ( [ acm1 ] ) holds .",
    "next , we are going to prove ( [ fqaf ] ) . for any vertex @xmath12 in @xmath351 , denote by @xmath397 the number of its offspring .",
    "notice that the @xmath397 are neither independent nor identically distributed , and @xmath351 is not a galton  watson tree . to see this ,",
    "fix @xmath398 .",
    "if there is an infinite number of elements of @xmath286 to the left of @xmath323 $ ] , that is , @xmath399 \\bigr ] \\bigr ) = \\infty,\\ ] ] then already infinitely many groups have been created . hence @xmath400 <",
    "\\xi^{*}_{j}[n]$ ] for all @xmath401 .",
    "this implies that @xmath323 $ ] can not generate any new group in @xmath350 using the exponentials and bernoullis defined so far , because they have already been used . to overcome this problem",
    ", we create a new tree , larger than @xmath351 , by introducing new random variables which allow also the observations @xmath323 $ ] satisfying ( [ inft1 ] ) to create a new group . to this end",
    ", we should attach to each of these observations a new sequence of independent exponentials and independent bernoullis .",
    "for example , if @xmath323 $ ] satisfies ( [ inft1 ] ) , and the associated bernoulli equals one , a new group , that we label @xmath30 , is created ( notice that we can not use any of the integers as a label , because they are already all taken ) . in this case",
    ", we set @xmath402 = \\xi^{*}_{j}[n]$ ] .",
    "we denote the associated sequence of i.i.d .",
    "exponentials with mean 1 by @xmath403 , and let @xmath404 be the bernoulli associated to group @xmath30 .",
    "we define @xmath405 and @xmath406 using these random variables , as we did in ( [ star ] ) and ( [ ximtil ] ) .",
    "if the group @xmath30 satisfies the second requirement in ( [ require ] ) , that is , @xmath407 } < x^{*}_{j } - \\xi^{*}_{\\nu}[0]$ ] , then @xmath30 belongs to the new tree @xmath408 that we are going to define .",
    "but then we would have to allow that @xmath30 is able to generate groups as well , in the same fashion .",
    "this approach would require that we introduce new sequences of exponentials and bernoullis , and the notation would be quite awkward . hence we prefer a different approach .",
    "before we proceed in a formal description of @xmath409 , notice that for this tree the number of offspring per vertex are independent and identically distributed .",
    "in fact , @xmath410}$ ] is independent of @xmath411 $ ] as determined by disjoint sets of exponentials and bernoulli .",
    "moreover , analyzing the event @xmath412 } < x^{*}_{j } - \\xi^{*}_{\\nu}[0]\\}$ ] , one can easily argue that it does not depend on the exponentials and bernoullis attached to vertices different from @xmath175 and @xmath12 .",
    "summarizing , the number of offspring of @xmath12 in this new tree depends only :    * on the exponentials attached to @xmath12 , with the exception of @xmath413 ; * on the bernoullis attached to @xmath12 ; * and on @xmath414 , if @xmath415 $ ] for some @xmath0 and @xmath416 .",
    "this implies that the number of offspring per vertex are i.i.d .",
    "now we are ready to give a formal construction of @xmath408 .",
    "suppose that to each @xmath417 we associate an extra sequence of exponential random variables @xmath418 , with parameter 1 , and an independent copy , say @xmath419 , of @xmath420 , with @xmath330 let @xmath421 the previous random variable counts also the @xmath0 satysfying @xmath422 ) = \\infty$ ] , hence @xmath423 is stochastically larger than @xmath424 for any @xmath27 .",
    "then the galton  watson tree @xmath408 whose offspring distribution is the same as the one of @xmath423 is stochastically larger than @xmath351 .",
    "we assume that @xmath408 is built on the same probability space of @xmath351 .",
    "in other words , we can assume , and we will , that @xmath351 is a subtree of @xmath408 .",
    "next we prove that the average number of offspring is bounded by a finite constant @xmath4 .",
    "define @xmath425 notice that we should have used different @xmath426 ) instead of @xmath427 , but the two share the same distribution and are independent of the right - hand side , and this notation is easier to handle .",
    "of course , we are allowed to do that because we are interested only in estimating the probability of this event .",
    "we have that @xmath428 \\le\\mathbb{e}\\biggl[\\sum _ { k=1}^{\\infty } \\1_{\\omega _ { k , j}}\\biggr ] = \\sum _ { k=1}^{\\infty } \\mathbb{p}(\\omega_{k , j}).\\ ] ] in order to prove ( [ om1 ] ) , notice that on the left - hand side we count the number of elements in @xmath379 with bernoulli equal to 1 , and which satisfy an extra condition .",
    "the right - hand side counts only those vertices which satisfy the extra condition .",
    "hence we only need to prove that @xmath429 is summable .",
    "notice that @xmath429 is independent of @xmath12 .",
    "recall that @xmath430 denote by @xmath431 , and @xmath432 .",
    "we have @xmath433 & = & \\prod _ { s = k+1}^{\\infty } \\sum_{j=1}^{\\infty } \\biggl(\\frac{f(s)}{f(s ) - \\theta_{k } } \\biggr)^{j } p^{j-1}(1-p ) \\nonumber\\\\ & = & \\prod_{s = k+1}^{\\infty } \\biggl ( \\frac{f(s)}{f(s ) - \\theta_{k } } \\biggr ) ( 1-p ) \\frac{1}{1-   ( pf(s)/(f(s ) - \\theta_{k } ) ) } \\\\ & = & \\prod_{s = k+1}^{\\infty}\\frac { f(s)(1-p)}{f(s)(1-p ) - \\theta_{k}}\\nonumber\\end{aligned}\\ ] ] and @xmath434 & = & \\prod_{s=1}^{\\infty } \\frac { f(s)(1-p)}{f(s)(1-p ) + \\theta_{k}}\\\\ & = & \\prod_{s=1}^k \\frac { f(s)(1-p)}{f(s)(1-p ) + \\theta_{k } } \\prod_{s \\ge k+1 } \\frac { f(s)(1-p)}{f(s)(1-p ) + \\theta_{k}}.\\end{aligned}\\ ] ] hence , @xmath435 e \\bigl[{\\operatorname{e}}^{\\theta_{k } y_{k}}\\bigr]\\nonumber\\\\ & & \\qquad\\le \\prod_{s=1}^k \\frac{f(s)(1-p)}{f(s)(1-p ) + \\theta_{k } } \\prod_{s \\ge k+1 } \\frac{f^2(s)(1-p)^2}{f^2(s)(1-p)^2 - \\theta^2_{k } } \\nonumber\\\\ & & \\qquad= \\prod_{s=1}^k \\frac{1}{1 +   ( \\theta_{k}/(f(s)(1-p ) ) ) } \\prod _ { s = k+1}^{\\infty}\\frac{1}{1 -   ( \\theta^2_{k}/(f^2(s)(1-p)^2 ) ) } \\\\ & & \\qquad\\le\\prod_{s=1}^k \\frac{1}{1 +   ( \\theta_{k}/(f(s)(1-p ) ) ) } \\exp \\biggl\\ { c \\theta_{k } \\sum_{s = k+1}^{\\infty } 1/f^2(s)\\biggr\\}\\nonumber \\\\ & & \\qquad\\le { \\mathrm{const } } \\prod_{s=1}^k \\frac{1}{1 +   ( \\theta_{k}/(f(s)(1-p ) ) ) } , \\nonumber\\end{aligned}\\ ] ] where for the first inequality we used that @xmath436 for @xmath437 and our choice of @xmath438 , and the inequality @xmath439 , for @xmath440 for a proper choice of @xmath441 . using the assumptions in theorem [ princres](i ) and ( [ we1 ] ) , we have that @xmath442 \\le \\mathbb{e}\\biggl[\\sum _ { k=1}^{\\infty } \\1_{\\omega _ { k , j}}\\biggr ] \\le{\\sum _ { k=1}^{\\infty } \\mathbb{e}\\bigl[{\\operatorname{e}}^{- \\theta_{k } z}\\bigr ] e \\bigl[{\\operatorname{e}}^{\\theta_{k } y_{k}}\\bigr ] } { { \\,\\stackrel{\\mathrm{def}}{=}\\,}}m<\\infty,\\ ] ] where , for the finitess of @xmath4 we used the second assumption in theorem  [ princres](i ) , and the fact that @xmath443 is a finite set .    for each vertex @xmath444 in @xmath445 , recall that we denote by @xmath400 $ ] the time when this vertex was generated and by @xmath446 = \\xi^{*}_{u}[0]+ \\sum_{j=1}^{n } w^{{({u})}}_{j}/f(n_{u}(j))$ ] .",
    "this is consistent with our definition given in ( [ star ] ) , but now it is defined for indices which are not necessarily integers . next we prove that each vertex @xmath175 at level @xmath198 has a probability to satisfy @xmath389",
    "< m$ ] which decreases faster than @xmath447 for any @xmath62 . for any vertex @xmath448",
    "we denote by @xmath449 its distance from the root of the tree .",
    "recall that the set of vertices at distance @xmath21 from the root is called level @xmath21 .",
    "fix a large parameter  @xmath191 .",
    "a vertex @xmath175 of @xmath445 is _ good _ if the element which generates @xmath175 is smaller than  @xmath191 .",
    "a  path is a ( possibly finite ) sequence of vertices @xmath450 , such that @xmath451 is generated by @xmath452 .",
    "we say that a path connects vertex @xmath453 to level @xmath198 if the first element of the path is @xmath453 and the last lies at level @xmath198 .",
    "we build the following random path @xmath454 .",
    "we start from @xmath455 and if this vertex has at least one offspring in @xmath408 , we choose one at random assigning the same probability to each offspring .",
    "we denote its label as @xmath456 .",
    "if @xmath456 has at least one offspring , we choose one of them at random and denote its label by @xmath457 .",
    "we follow this procedure until we either reach level @xmath198 or find a vertex with no offspring . the event @xmath458the path  @xmath454 connects @xmath70 to a vertex at level @xmath459 equals the event that each of the @xmath452 has at least one offspring .",
    "hence @xmath460 notice that each event @xmath461 is independent of @xmath462 $ ] and is independent of each @xmath463 with @xmath464 , and @xmath465 .",
    "moreover the events @xmath466 are independent .",
    "define @xmath467 fix @xmath57 .",
    "we have @xmath468 - \\xi^{*}_{u(i)}[0 ] \\le m { | } \\mbox{the path $ \\mathbf{u}$ connects $ 1$}\\nonumber\\hspace*{-35pt}\\\\ & & \\hspace*{135pt}\\qquad\\mbox{to a vertex at level $ n+1 $ } \\biggr ) \\nonumber\\hspace*{-35pt}\\\\ & & \\qquad= \\mathbb{p } \\biggl(\\sum_{i=1}^{n } \\xi^{*}_{u(i)}[1 ] - \\xi^{*}_{u(i)}[0 ] \\le m \\big| \\bigcap_{i=1}^{n } \\ { \\eta_{u(i ) } \\ge1 \\ } \\biggr)\\hspace*{-35pt } \\\\ & & \\qquad\\le\\mathbb{p } \\biggl(\\sum_{i=1}^{n } \\bigl ( \\xi^{*}_{u(i)}[1 ] - \\xi^{*}_{u(i)}[0 ] \\bigr)\\1_{\\{\\eta_{u(i ) } \\le k \\ } } \\le m \\big|\\bigcap_{i=1}^{n } \\{\\eta_{u(i ) } \\ge1 \\ } \\biggr ) \\nonumber\\hspace*{-35pt}\\\\ & & \\qquad\\le\\mathbb{p } \\biggl(\\sum_{i=1}^{n } \\bigl ( \\xi^{*}_{u(i)}[1 ] - \\xi^{*}_{u(i)}[0 ] \\bigr)\\1_{\\{\\eta_{u(i ) } \\le k \\ } } \\le m \\big| \\bigcap_{i=1}^{n } \\{\\eta_{u(i ) } \\ge1 \\ } \\cap\\psi(n , k ) \\biggr ) \\nonumber\\hspace*{-35pt}\\\\ & & \\qquad\\quad { } + \\mathbb{p } \\biggl(\\psi^{c}(n , k ) \\big| \\bigcap _ { i=1}^{n }",
    "\\{\\eta_{u(i ) } \\ge1 \\ } \\biggr).\\nonumber\\hspace*{-35pt}\\end{aligned}\\ ] ] in the last step we used that for any triplet of events @xmath81 , @xmath378 , @xmath469 we have @xmath470 let @xmath471 , @xmath472 , be i.i.d .",
    "random variables taking values in @xmath473 , with distribution @xmath474 the sequence @xmath475 is independent of @xmath452 because the random variables @xmath476 are i.i.d .",
    "moreover , as the @xmath477 are independent , @xmath478 is , conditionally on @xmath479 , binomially distributed with mean @xmath480 .",
    "if @xmath481 is a binomial with parameters @xmath482 , then @xmath483 by a simple exponential bound ; see , e.g. ,  @xcite pages 27 and 35 .",
    "fix @xmath484 .",
    "we can choose @xmath485 such that @xmath486 and @xmath487 where @xmath4 has been defined in ( [ mo ] ) .",
    "we can choose such @xmath488 because@xmath489 .",
    "notice that for any @xmath490 , we have @xmath491 .",
    "moreover if @xmath492 , then @xmath493 this fact is due to the monotonicity of @xmath475 and the convexity of the function @xmath494 , for @xmath495 , and the fact that this function attains its minimum at @xmath496 .",
    "next , let @xmath497 be a sequence of i.i.d .",
    "random variables with distribution @xmath498 in words , @xmath499 is distributed like an exponential with mean @xmath500 conditioned to be smaller than an independent quantity .",
    "we claim that the first probability in the last equation of ( [ nz1 ] ) is smaller or equal to @xmath501 to see this , notice that by a simple exchangeability argument we have that @xmath502 - \\xi^{*}_{u(i)}[0 ] \\bigr)\\1_{\\{\\eta_{u(i ) } \\le k^{*}_r \\ } } \\le m { \\big| } \\bigcap_{i=1}^{n } \\{\\eta_{u(i ) } \\ge1\\ } \\cap\\psi\\bigl(n , k^{*}_r \\bigr ) \\biggr ) \\\\ & & \\qquad= \\mathbb{p } \\biggl(\\sum_{i=1}^{n } \\bigl ( \\xi^{*}_{u(i)}[1 ] - \\xi^{*}_{u(i)}[0 ] \\bigr)\\1_{\\{\\eta_{u(i ) } \\le k^{*}_r \\ } } \\le m { \\big| }",
    "\\bigcap_{i=1}^ { \\lfloor 0.5 n \\rfloor } \\bigl\\{1 \\le\\eta_{u(i ) } \\le k^{*}_r\\bigr\\ } \\biggr ) \\\\ & & \\qquad\\le\\mathbb{p } \\biggl(\\sum_{i=1}^{\\lfloor 0.5n \\rfloor } \\bigl(\\xi^{*}_{u(i)}[1 ] - \\xi^{*}_{u(i)}[0 ] \\bigr)\\1_{\\{\\eta_{u(i ) } \\le k^{*}_r \\ } } \\le m { \\big| } \\bigcap_{i=1}^{\\lfloor 0.5 n \\rfloor } \\bigl\\{1 \\le\\eta_{u(i ) } \\le k^{*}_r\\bigr\\ } \\biggr).\\end{aligned}\\ ] ] again , notice that the events @xmath503 , with @xmath504 , are independent .",
    "given @xmath505 , the random variable @xmath506 - \\xi^{*}_{u(i)}[0 ] $ ] is stochastically larger than @xmath499 , as @xmath507 is a.s .",
    "decreasing in @xmath21 .",
    "this proves the relationship between ( [ nz2 ] ) and the first probability in the last equation of ( [ nz1 ] ) .",
    "next a simple exponential bound , which uses the fact that @xmath499 are independent , yields @xmath508 where @xmath509 as @xmath183 . for each @xmath0 , @xmath189 is the fenchel ",
    "legendre transform ( i.e. , we minimize the exponent on @xmath510 ) of @xmath499 in the point @xmath511 .",
    "hence , the number of good vertices in @xmath351 at level @xmath0 is smaller or equal to @xmath512 hence only finitely many vertices in @xmath408 are good .",
    "this implies that only finitely many vertices in @xmath351 are good , and this , in turn , implies ( [ fqaf ] ) .",
    "proof of theorem  [ princres ] ( ) first suppose that @xmath513 .",
    "the minimum of @xmath358 is a.s .",
    "unique , and we denote it by @xmath514 . by lemma  [ genac ]",
    "@xmath370 = x^{*}_{j^{*}}$ ] , hence the cardinality of group @xmath514 tends to infinity , while the cardinality of each of the other groups is finite .",
    "now we reason for general @xmath99 , using a simple coupling .",
    "let @xmath515 be a sequence of independent bernoullis with @xmath516 .",
    "we use these random variables to relabel the points in @xmath286 as follows .",
    "if @xmath517 , then we set @xmath518 \\cup\\xi \\setminus\\widetilde{\\xi}_{2}$ ] .",
    "if @xmath519 , then @xmath520 . define @xmath521)=1\\}$ ] .",
    "suppose we have defined @xmath522 and @xmath523 , for @xmath524 . on the event",
    "@xmath525 if @xmath526 , respectively , @xmath527 , set @xmath528 \\cup\\theta_{m-1 } \\setminus\\widetilde { \\xi}_{k+1}$ ] , respectively , @xmath529 .",
    "we set @xmath530)=1\\}$ ] .",
    "let @xmath531 .",
    "the process @xmath532 $ ] , with @xmath83 is a @xmath533 ) .",
    "let @xmath534 .",
    "denote by @xmath535 .",
    "this implies that the @xmath27th group in @xmath536 is the @xmath537th group in @xmath286 .",
    "let @xmath538 , and @xmath539 this implies that @xmath540 is actually a minimum and has a unique minimizer .",
    "following the same reasoning given in the previous paragraph , we conclude that the only group whose cardinality grows to infinity is @xmath485 .",
    "proof of corollary  [ findegree ] we first assume that @xmath541 . for any @xmath27 , denote by @xmath542 the set of groups which are generated by @xmath27 . in virtue of ( [ mo ] )",
    ", we have that @xmath543 < x^{*}_{u } \\mbox { for only finitely many $ i \\in e(u)$}\\bigr \\ } \\qquad\\mbox{holds a.s.}\\ ] ] notice that for @xmath175 which is not a vertex of @xmath351 we have that @xmath389 >",
    "\\inf_{i}x^{*}_{i}= \\lim_{n \\ti } \\xi[n]$ ] .",
    "hence , we do not have to consider such @xmath175 .",
    "recall the definition of @xmath544 given before theorem  [ testo1 ] . as for each @xmath118 , there are only finitely many good vertices in @xmath350 , and we get @xmath545 . combining the latter limit with ( [ ny1 ] ) we have that @xmath546 < \\inf_{i } x^{*}_{i } \\mbox { for only finitely many $ u$}\\bigr ) \\\\ & & \\qquad= \\lim_{n \\ti } \\mathbb{p}\\bigl(\\bigl\\{\\widetilde{\\xi}_{u}[1 ] < \\inf_{i } x^{*}_{i } \\mbox { for only finitely many $ u$}\\bigr\\}\\cap\\{\\mathrm{lead } \\notin g_{n}\\}\\bigr ) \\\\ & & \\qquad\\ge\\lim_{n \\ti } \\mathbb{p } \\biggl(\\bigcap_{u \\in\\mathcal{t}_{1 } \\dvtx u \\notin g_{n } } v(u ) \\cap\\{\\mathrm{lead } \\notin g_{n}\\ } \\biggr ) \\\\ & & \\qquad= \\lim_{n \\ti } \\mathbb{p}(\\mathrm{lead } \\notin g_{n } ) = 1.\\end{aligned}\\ ] ] for the general case @xmath99 , apply the same coupling we used at the end of the previous proof .",
    "we first deal with the case @xmath547 .",
    "repeat the construction given in the proof of theorem  [ princres](i ) , under the hypothesis of theorem  [ princres](ii ) .",
    "recall the definition of @xmath548 , @xmath549 and @xmath357 .",
    "recall also the definition of @xmath317 .",
    "the random variables @xmath357 , for @xmath550 , are a.s .",
    "infinite , because the infinite sum of independent exponentials is finite if and only if its mean is finite .",
    "we prove next that for any fixed @xmath551 , @xmath552 > m\\qquad \\mbox{a.s.}\\ ] ] fix a vertex @xmath553 of @xmath317 , and denote by @xmath554 , with @xmath555 its ancestors : that is , @xmath556 \\in\\xi^{*}_{u_{j-1}}$ ] , for all @xmath557 .",
    "then @xmath558 $ ] is stochastically larger than a sum of @xmath220 i.i.d .",
    "exponentials with parameter @xmath559 . hence",
    "@xmath560 = \\infty$ ] , a.s .",
    "now notice that @xmath561 $ ] is a.s .",
    "finite for each @xmath562 .",
    "hence , as @xmath175 grows to infinity , the number of its ancestors grows to infinity , proving ( [ lim ] ) .",
    "since it is easy to adapt the above reasoning to the case @xmath563 , we will leave this task to the reader .",
    "proof of theorem  [ princres1 ] ( ) we first analyze the case @xmath541 . we build a similar construction as the one given in the proof of theorem  [ princres ] , the only difference being that we place @xmath564 instead of @xmath3 .",
    "we leave to the reader to check that this construction embeds our @xmath565 . in this",
    "setting , @xmath566 + \\sum_{j=1}^{\\infty}\\frac{w^{{({i})}}_{j}}{f_{i } ( n_{i}(j ) ) } .\\ ] ] notice that @xmath372 is a.s .",
    "finite if and only if @xmath567 is finite .",
    "hence , we do not exclude that @xmath568 , a.s . , but we know that @xmath569    denote by @xmath570 the smallest accumulation point of @xmath286 .",
    "this minimum accumulation point exists because the set of accumulation points of @xmath286 is closed , and the set @xmath286 is a subset of @xmath222 .",
    "moreover @xmath570 is a.s .",
    "finite because of ( [ acpoin ] ) .",
    "if @xmath571 for all @xmath330 , then @xmath572 < x^{*}_{i}\\qquad \\mbox{for all $ i \\ge1$.}\\ ] ] we need to prove ( [ acp ] ) only for the case @xmath573 , because for the other cases the result is implied by the fact that @xmath570 is an accumulation point which is a.s .",
    "finite and @xmath574 = \\infty$ ] .",
    "assume that @xmath360 is a.s .",
    "finite and notice that for fixed @xmath27 , as @xmath571 , then @xmath575 . as @xmath570 is an accumulation point for @xmath286 , then @xmath576 $ ] is a.s .",
    "infinite . in words",
    "there are infinitely many points of @xmath286 smaller than @xmath577 .",
    "hence @xmath578 \\le\\delta_{i } < x^{*}_{i}.\\ ] ] the inequality in ( [ acp1 ] ) holds for each @xmath27 , yielding ( [ acp ] ) .",
    "moreover , ( [ acp1 ] ) implies that each group will end up having finite cardinality .",
    "this is because @xmath579 $ ] , as @xmath577 is strictly less than @xmath360 which is the only accumulation point for @xmath580 .",
    "the latter statement is a direct consequence of the definitions of @xmath360 and  @xmath580.=-1    on the other hand , if @xmath581 for some @xmath27 , then using again that all the @xmath361 which are finite are also a.s .",
    "distinct , we have that @xmath582 = x^{*}_{i}.$ ] to prove the latter inequality , suppose it is not true , that is , @xmath582",
    "< x^{*}_{i}.$ ] then there would be an accumulation point smaller than @xmath570 , which would yield a contradiction .    next we analyze the general case , that is , @xmath99 , for some @xmath100 and all @xmath92 .",
    "the problem here is that the reinforcement function is group dependent . in the special case @xmath541 we had that the first point labeled @xmath27 was @xmath583 $ ] .",
    "we need to translate the points labeled @xmath27 in the new construction for the general case .",
    "denote by @xmath584 the time when the @xmath27th group is created and denote by @xmath585 the union of the points labeled @xmath12 , with @xmath586 .",
    "we have that the first point labeled @xmath27 is exactly @xmath587.$ ] set @xmath588 - \\xi^{*}_{i}[0]+ \\upsilon_{i-1}\\bigl[v(i)\\bigr ] \\dvtx n \\ge0 \\bigr\\ } , \\nonumber \\\\[-8pt ] \\\\[-8pt ] \\nonumber   u^{*}_{i } & { { \\,\\stackrel{\\mathrm{def}}{=}\\ , } } & x^{*}_{i } - \\xi^{*}_{i}[0]+ \\upsilon_{i-1}\\bigl[v(i)\\bigr].\\end{aligned}\\ ] ] hence @xmath589 moreover , let @xmath590 .",
    "it is easy to check that @xmath591 embeds @xmath592 .",
    "we prove the theorem on the event @xmath593 is a.s .",
    "finite for at least one created group @xmath594 . repeating the argument we gave for the case @xmath541",
    ", we see that either all the groups remains finite or there exists exactly one dominating the others .",
    "proof of theorem  [ princres1 ] ( ) first assume that @xmath541 , for some @xmath100 . under the assumptions of this part of the theorem",
    ", we have that each @xmath595 , a.s .",
    "hence @xmath596 . by our construction , either @xmath597 = \\infty$ ] ,",
    "in which case the cardinality of each group is a.s .",
    "diverging to infinity , or @xmath370=",
    "\\gamma < \\infty$ ] , a.s",
    ". , in which case @xmath598<\\infty$ ] , a.s . in words , in the latter case",
    ", the cardinality of each group will eventually remain finite , for otherwise @xmath599 for some @xmath12 , and this would give a contradiction .    for general @xmath99 , we have that @xmath600 , where the @xmath601 are the random variables defined in ( [ usp3 ] ) . reasoning as in the previous paragraph we get the result for this more general case .",
    "next we show an example where a third phase occurs , that is , @xmath602 in this example we pick @xmath129 and @xmath603 .",
    "notice that @xmath604 , with @xmath330 , is an i.i.d .",
    "sequence of geometrically distributed random variables , with mean @xmath242 .",
    "hence , by a standard exponential bound , we have @xmath605 this implies that @xmath606 next , we use this fact to prove that @xmath607 the latter implies that @xmath608 is not attained . as",
    "this infimum is an accumulation point for @xmath286 , this would imply that the smallest accumulation point of @xmath286 is smaller than @xmath361 , for all @xmath310 .",
    "hence , ( [ thirdphase ] ) would hold .",
    "next we turn to the proof of ( [ intmd1 ] ) .",
    "fix @xmath238 . as @xmath609",
    ", we have that @xmath316 \\le\\xi_{j}[\\tau_{u}]$ ] . hence",
    "@xmath610 + \\sum _ { \\ell=1}^{\\infty } w^{{({u})}}_{\\ell}/f_{u } \\bigl(n_{u}(\\ell)\\bigr ) > x^{*}_{j } \\biggr ) \\nonumber\\hspace*{-35pt } \\\\[-8pt ] \\\\[-8pt ] \\nonumber & & \\quad\\le\\mathbb{p } \\biggl(\\xi_{j}[\\tau_{u } ] + \\sum _ { \\ell=1}^{\\infty } w^{{({u})}}_{\\ell}/f_{u } \\bigl(n_{u}(\\ell)\\bigr ) > x^{*}_{j } \\biggr)\\hspace*{-35pt } \\\\ & & \\quad\\le\\mathbb{p } \\biggl(\\sum_{\\ell=1}^{\\infty } w^{{({u})}}_{\\ell } /f_{u}\\bigl(n_{u}(\\ell ) \\bigr ) > \\sum_{\\ell = u^{2}}^{\\infty } w^{{({j})}}_{\\ell } /f_{j } \\bigl(n_{j}(\\ell)\\bigr ) { | } \\tau_{u }",
    "< u^{2 } \\biggr)+ \\mathbb{p } \\bigl(\\tau_{u } \\ge u^{2 } \\bigr).\\nonumber\\hspace*{-35pt}\\end{aligned}\\ ] ] the last inequality in ( [ seq ] ) is justified as follows . for any pair of events @xmath81 and @xmath378 we have that @xmath611    notice that @xmath612 is measurable with respect to the @xmath159-algebra @xmath613 in words , if we know the first @xmath614 observations of each @xmath615 , with @xmath616 , and the associated bernoullis , we know if the event @xmath612 holds . hence the latter event is independent of the pair @xmath617 hence the last expression in ( [ seq ] ) equals @xmath618 the last expression is summable . to see this , in virtue of ( [ sum1 ] ) , we just need to prove that the first term is summable .",
    "then our argument follows from an application of the first borel ",
    "cantelli lemma .",
    "in fact , the summability implies that @xmath619 for infinitely many @xmath175 .",
    "set @xmath620 , and recall that @xmath12 is fixed .",
    "for any pair of random variables @xmath481 and @xmath621 and any constant @xmath453 , we have that @xmath622 we apply this fact to obtain @xmath623 notice @xmath624 while , by a similar reasoning , @xmath625 notice that in virtue of markov s inequality , we have @xmath626 and the right - hand side is summable in @xmath175 for fixed @xmath12 . in a similar way , using chebyshev s inequality after applying the function @xmath627 to both sides and choosing @xmath628 , we obtain @xmath629 the last expression is summable in @xmath175 , because , for fixed @xmath12 , @xmath630 is larger than @xmath631 for all sufficiently large @xmath175 .",
    "suppose that the positive function @xmath3 satisfies the condition @xmath145 .",
    "consider an urn with @xmath21 white balls and @xmath70 red one .",
    "we pick a ball at random , and it is white with probability @xmath132 .",
    "suppose that by the time of the @xmath0th extraction , we picked @xmath12 white balls and @xmath134 red ones .",
    "the probability to pick a white ball at the next stage becomes @xmath135 .",
    "let @xmath632 denote by @xmath633 the probability measures referring to the urn with initial conditions and dynamics described above .",
    "let @xmath634 and recall that @xmath635 .",
    "let the process @xmath636 be a standard brownian motion , which starts from the point @xmath637 .",
    "denote by @xmath638 the measure associated with this brownian motion .",
    "we use this process to generate the urn sequence described at the beginning of this section , as follows . set @xmath639 and let @xmath640    if @xmath641 , then set @xmath642 ; otherwise set @xmath643 .",
    "suppose we defined @xmath644 and @xmath645 .",
    "set @xmath646 . on the event @xmath647",
    ", we define @xmath648 set @xmath649    by the ruin problem for brownian motion , we have that @xmath650 which is exactly the urn transition probability .    in this way we embedded the urn into brownian motion .",
    "in fact , the process @xmath651 , with @xmath101 , is distributed like the number of white balls withdrawn from the urn associated to the reinforcement scheme described at the beginning of this section .",
    "notice that @xmath652 define @xmath653 this limit exists because the sequence of stopping times @xmath654 is increasing . for this reason @xmath655 is itself a stopping time .",
    "define @xmath656 moreover , in virtue of theorem  [ hrubin ] we have that exactly one of the collection of events @xmath657 and @xmath658 holds finitely many times , a.s .",
    "this implies that the event @xmath659 holds @xmath638-a.s . by our embedding ,",
    "we have that @xmath660 where @xmath661 was defined at the beginning of this section .    proof of theorem  [ estur ] in order to prove our result we only need to prove the following : @xmath662 let @xmath663 this stopping time can be infinite with positive probability .",
    "notice that on @xmath664 , by ( [ punto ] ) , we have that the urn generated by the brownian motion contains , at time @xmath665 , an equal number of white and red balls , and @xmath666 viceversa , if we let @xmath667 then we have that @xmath668 to prove ( [ tie1 ] ) , notice that for @xmath669 , with @xmath670 , the random sequence @xmath671 can not switch sign without becoming @xmath68 .",
    "so if @xmath672 and @xmath673 , for some @xmath674 , then there exists an @xmath280 , with @xmath675 , such that @xmath676 . in this case , by time @xmath280 we have a tie .",
    "we use this fact throughout the proof .    recall that under @xmath638 the brownian motion @xmath677 starts from @xmath678 . for @xmath679 ,",
    "let @xmath680 notice that @xmath681 for @xmath679 .",
    "moreover , by time @xmath682 , with @xmath683 , on the event @xmath684 , at least @xmath12 red balls have been extracted . to see this , we first focus on @xmath685 , and prove that by this time , on the event @xmath686 , at least one red ball has been picked .",
    "suppose that this is not true ; that is , suppose that we picked 0 red balls by time @xmath685",
    ". the reader can check from our embedding that this implies that @xmath687 this would imply that @xmath688 contradicting our hypothesis . by reiterating the same reasoning we get that the statement holds true for any @xmath679 .",
    "define @xmath689 on @xmath690 the brownian motion , after time @xmath691 , will hit @xmath692 before there is a tie in the urn , because @xmath693 , for @xmath679 .",
    "next we prove that for any @xmath694 , if @xmath690 holds , then only a finite number of red balls are extracted , that is , @xmath695 .",
    "we split this proof into two parts : we first prove that @xmath696 and then @xmath697 . in order to prove the first inclusion , recall that under @xmath698 the brownian motion starts at @xmath699 .",
    "this implies that if @xmath700 , then infinitely many balls will be extracted before the brownian motion hits @xmath701 . as @xmath702",
    ", we have that infinitely many balls will be extracted before @xmath703 hits @xmath68 , that is , before a tie .",
    "this implies that @xmath704 , which in turn implies @xmath705 .",
    "next we prove that @xmath706 . on the set @xmath707 , by time @xmath691",
    "the number of red balls extracted is at least @xmath708 .",
    "this implies that @xmath709 this is a consequence of ( [ punto ] ) and the fact that @xmath710 is a nondecreasing random sequence , and if @xmath711 for some @xmath0 , then @xmath712 .",
    "let @xmath713 that is , the first time after @xmath691 that a white ball is extracted . the stopping time @xmath714 could be infinite .",
    "next we prove that on @xmath690 the random time @xmath714 is a.s .",
    "recall that @xmath691 is the first time that the process @xmath703 hits @xmath715 , and that @xmath716 .",
    "this implies that by time @xmath691 the number of white balls generated by the brownian motion , plus the initial @xmath21 , overcomes that of the red ones . on @xmath690 , after time @xmath691 , the process will hit @xmath692 before it hits @xmath68 .",
    "this implies that @xmath717 a.s . on @xmath690 .",
    "in fact if no white balls are extracted after time @xmath691 the process would hit @xmath68 before it hits @xmath692 giving a contradiction .",
    "moreover on @xmath690 , we have that @xmath718 , hence by time @xmath714 the white balls are still ahead with respect the red ones .",
    "we can repeat the same reasoning with @xmath719 to argue that @xmath720 is a.s .",
    "finite and by time @xmath720 the white balls are still in advantage . by reiterating this argument",
    ", we get that only finite many red balls will be extracted , because each @xmath721 occurs before a tie , a.s .",
    "hence @xmath722 holds when @xmath690 holds .",
    "this implies that @xmath723 for each @xmath724 .",
    "if @xmath725 holds , then either @xmath726 holds or @xmath727 holds . if the latter event holds , independently of the past , the probability that only finitely many white balls are picked is exactly 1/2 , by symmetry .",
    "moreover , the events @xmath690 are independent , because they are determined by the behavior of disjoint increments of the brownian motion . by the standard ruin problem for this process",
    ", we have that @xmath728 we get @xmath729",
    "proof of theorem  [ testo1 ] notice that _ lead _ must be a vertex of @xmath351 . under the assumptions of the theorem , the probability that @xmath730 is smaller or equal to the probability that @xmath731 .",
    "the latter probability is bounded as follows : @xmath732 we set @xmath733 and @xmath734 , where @xmath735 . in virtue of ( [ cmlf ] ) ,",
    "the probability that all the vertices at level @xmath0 are good is at least @xmath736 where @xmath189 were introduced at the end of the proof of lemma [ genac ] , and @xmath4 was introduced in ( [ mo ] ) .",
    "recall that @xmath179 is the set of the vertices of @xmath178 at level @xmath0 .",
    "moreover , recall that @xmath737 .",
    "we have @xmath738 & \\le & c_{1}{\\operatorname{e}}^{-c_{2 } m } + m^{n } \\inf_{r > 1 } \\bigl({\\operatorname{e}}^{-c_{n}(r , m ) n } + r^{-n}\\bigr ) .",
    "\\end{aligned}\\ ] ]    proof of corollary  [ rf ] set @xmath739 and define recursively @xmath740 .",
    "notice that @xmath741 .",
    "if a vertex @xmath742 of @xmath178 belongs to @xmath743 , then we have that @xmath744 for some @xmath21 .",
    "we have @xmath745 - \\mathbb{p}(\\mathrm{lead } \\in g_{2}).\\ ] ] we bound the last probability in the previous expression using theorem  [ testo1 ] .",
    "order the groups at level one , starting from the smaller . as @xmath746",
    ", we have that by the time the @xmath21th group at level 1 is created , there are at least @xmath21 balls in urn 1 .",
    "hence , using theorem [ estur ] , we get @xmath747 \\le \\sum_{k=1}^{\\infty } \\frac12 \\prod _ { \\ell=1}^{k-1 } \\frac{f(\\ell)f_{k}}{1 + f(\\ell ) f_{k}}.\\vspace*{-1pt}\\ ] ]",
    "fix two real numbers @xmath190 and @xmath748 , and two sequences of positive real numbers @xmath749 and @xmath750 .",
    "suppose we have an urn with @xmath748 ( resp . ,",
    "@xmath190 ) white ( resp .",
    ", red ) balls .",
    "if at step @xmath751 there are exactly @xmath12 white balls , with @xmath752 , then the probability to pick a white ball is @xmath753 if a white ( resp .",
    ", red ) ball is picked , at time @xmath198 the composition of the urn becomes @xmath754 ( resp .",
    ", j ) white balls and @xmath755 ( resp . , @xmath756 ) red ones . denote by @xmath757 let @xmath758 be the measure describing the dynamics of this urn .",
    "we have the following result , due to herman rubin ; see the appendix in @xcite .",
    "[ hrubin ] we have the following 3 cases :    if @xmath759 and @xmath760 , then both the number or red balls and the number of white balls in the urn goes to @xmath128 , a.s . , as @xmath761 .    if @xmath762 and @xmath760 , then @xmath763    if @xmath762 and @xmath764 , then @xmath765 and both @xmath766 and @xmath767 are strictly positive .",
    "we thank two anonymous referees for their suggestions .",
    "moreover we thank peter mrters for helpful discussions , patrick lahr for spotting a few typos in an early version and roman koteck for pointing out to us the reference @xcite , which was one of the first to introduce preferential attachment schemes ."
  ],
  "abstract_text": [
    "<S> we study a general preferential attachment and plya s urn model . at each step </S>",
    "<S> a new vertex is introduced , which can be connected to at most one existing vertex . </S>",
    "<S> if it is disconnected , it becomes a pioneer vertex . </S>",
    "<S> given that it is not disconnected , it joins an existing pioneer vertex with probability proportional to a function of the degree of that vertex . </S>",
    "<S> this function is allowed to be vertex - dependent , and is called the reinforcement function . </S>",
    "<S> we prove that there can be at most three phases in this model , depending on the behavior of the reinforcement function . </S>",
    "<S> consider the set whose elements are the vertices with cardinality tending a.s . to infinity . </S>",
    "<S> we prove that this set either is empty , or it has exactly one element , or it contains all the pioneer vertices . </S>",
    "<S> moreover , we describe the phase transition in the case where the reinforcement function is the same for all vertices . </S>",
    "<S> our results are general , and in particular we are not assuming monotonicity of the reinforcement function .    finally , consider the regime where exactly one vertex has a degree diverging to infinity . </S>",
    "<S> we give a lower bound for the probability that a given vertex ends up being the leading one , that is , its degree diverges to infinity . </S>",
    "<S> our proofs rely on a generalization of the rubin construction given for edge - reinforced random walks , and on a brownian motion embedding .    , </S>"
  ]
}