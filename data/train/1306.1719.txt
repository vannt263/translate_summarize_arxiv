{
  "article_text": [
    "the wavefunction of a single photon travelling through the photonic chip can be described in the waveguide basis @xmath112 where @xmath113 denotes the presence of a photon in waveguide @xmath114 .",
    "the photon travels through a series of phaseshifters @xmath115 and directional couplers @xmath116 .",
    "the action of each linear element on the wavefunction can be described by a 6 x 6 matrix such that the wavefunction after the element is @xmath117 a phaseshifter applying the phase shift @xmath118 to the photon in waveguide @xmath119 is described by the matrix @xmath120,\\ ] ] where @xmath20 and @xmath19 label the waveguides .",
    "for example a phaseshifter on waveguide 2 is given by @xmath121 which is a unity matrix , where the 2nd element on the diagonal is replaced by a phase factor .",
    "a directional coupler between waveguide @xmath119 and @xmath122 with reflectivity @xmath123 is described by @xmath124\\nonumber \\\\   &   & + \\left(1-\\delta_{ak}-\\delta_{bk}\\right)\\delta_{kl}.\\end{aligned}\\ ] ] as an example a directional coupler with reflectivity @xmath123 between waveguide 2 and waveguide 3 is given by @xmath125 the unitary of the chip @xmath26 has a rather complicated form and we will therefore present it as the product of its elementary building blocks .",
    "it can be written in terms of the preparation stage unitary @xmath126 and the unitary describing the selection of the measurement bases @xmath127 as @xmath128 where the preparation stage unitary can be broken down further into @xmath129 with the unitary of the central part given by @xmath130 where the reflectivities @xmath131 ( design and measured ) can be found in tab  [ tab1 ] .",
    "the two other blocks are given by @xmath132    @xmath133    in the same way the unitary describing the selection of the measurement bases can be written as @xmath134 with @xmath135    @xmath136    this fully defines the single photon unitary of the photonic chip under consideration .",
    "once the unitary is known we can proceed to calculate the probabilities for coincidence counts at the detectors .",
    "we will assume that the source produces photon with a given frequency distribution , so that a photon in wave guide @xmath85 is described by @xmath137 where @xmath138 is the vacuum state , @xmath139 a creation operator for a photon with frequency @xmath140 in waveguide @xmath85 and @xmath141 a normalised amplitude for a frequency so that @xmath142 . with a photonic circuit described by the single photon unitary @xmath26 and an initial state with two photons entering the waveguides @xmath143 and @xmath144 , @xmath145 ,",
    "we can write the wave function at the exit of the circuit as @xmath146 where we defined the two photon state @xmath147 the coincidence counts at detectors @xmath20 and @xmath19 , @xmath23 , are then given by @xmath148 where the number operators are given by @xmath149 after a lengthy but straightforward calculation , contracting pairs of creation and annihilation operators , using the commutation relation @xmath150=\\delta_{ij}\\delta(\\omega_{1}-\\omega_{2})\\ ] ] we obtain @xmath151 with @xmath152 note that we have here selected the frequency distribution to distinguish the photons but a similar argument can be made for other degrees of freedom , e.g. polarisation . in our experiments",
    "we are interested in the the probability of a certain coincidence , given that we insert a photon into each of the waveguides 2 and 4 .",
    "we obtain the probability of coincidence as @xmath153 @xmath154 with the normalisation constant given by @xmath155 which is exactly the form of eq .",
    "( [ coincidenceprob ] ) .",
    "we now show that @xmath58 can be directly obtained from a hong - ou - mandel type experiment .",
    "in such a measurement two photons are directed to two different ports of a directional coupler with reflectivity @xmath123=1/2 .",
    "the unitary is given by @xmath156 what is measured is the number of coincidence counts relative to the number of counts obtained for completely distinguishable photons . for a beam splitter with reflectivity",
    "@xmath123 we obtain @xmath157 normalising this to the number of coincidence counts for completely distinguishable photons we get @xmath158 or expanding around @xmath159 to second order in @xmath160 we obtain @xmath161 this shows that we can directly read off the function @xmath58 from a hong - ou - mandel type experiment and that the error induced by using a non - ideal beam splitter is quadratic in the deviation .",
    "if we want to consider the photonic quantum circuit in the light of quantum computation we have to assign the meaning of qubits to certain combinations of photons .",
    "we do this in the following way : waveguides 2 and 3 encode one qubit in dual rail encoding , while waveguides 4 and 5 encode the second one .",
    "a photon present in waveguide 2 and the second photon in waveguide 4 maps onto the logical two qubit state @xmath162 .",
    "similarly we make the mappings @xmath163 , @xmath164 and @xmath165 .",
    "given the full wave function on the chip and the fact that the detectors only register the presence of a photon , but do not distinguish parameters like polarisation or wavelength , we can construct a reduced density matrix for the two qubit subspace as @xmath166 where the pairs @xmath167 and @xmath168 are taken from @xmath169 the coefficients are given by @xmath170 with @xmath171 given by eq .",
    "( [ largepsi ] ) and @xmath172 defined in eq .",
    "( [ twophotonstate ] ) and the partial trace running over the frequency degree of freedom . in a similar calculation to the previous section and assuming that single photons are inserted in waveguide 2 and 4 we obtain @xmath173 with @xmath174 defined in eq .",
    "( [ pdist ] ) . reinserting this in the equation for the density matrix eq .",
    "( [ dmatr ] ) we see that we can define @xmath175 and"
  ],
  "abstract_text": [
    "<S> integrated quantum photonic circuits are becoming increasingly complex . </S>",
    "<S> accurate calibration of device parameters and detailed characterisation of the prepared quantum states are critically important for future progress . here </S>",
    "<S> we report on an effective experimental calibration method based on bayesian updating and markov chain monte carlo integration . </S>",
    "<S> we use this calibration technique to characterize a two qubit chip and extract the reflectivities of its directional couplers . </S>",
    "<S> an average quantum state tomography fidelity of 93.79@xmath01.05@xmath1 against the four bell states is achieved . </S>",
    "<S> furthermore , comparing the measured density matrices against a model using the non - ideal device parameters derived from the calibration we achieve an average fidelity of 97.57@xmath00.96@xmath1 . </S>",
    "<S> this pinpoints non - ideality of chip parameters as a major factor in the decrease of bell state fidelity . </S>",
    "<S> we also perform quantum state tomography for bell states while continuously varying photon distinguishability and find excellent agreement with theory .    </S>",
    "<S> a large variety of quantum systems have been studied in recent years for use in quantum information processing @xcite . among the possible implementations , quantum information processing based on photons stands out due to its high stability , wide availability and ease of manipulation @xcite . </S>",
    "<S> recent developments in integrated photonics have been promising from the point of view of future large scale on - chip quantum information processing @xcite . </S>",
    "<S> moreover , integrated reconfigurable quantum photonic circuits have shown great potential for generic quantum operations @xcite . </S>",
    "<S> for instance , it has been shown that the generation of arbitrary two - qubit states and the corresponding state tomography can be realised on a chip with high fidelity @xcite . however , with increasing device complexity the accurate calibration of quantum devices becomes a crucially important task . in this paper </S>",
    "<S> we study a reconfigurable two - qubit quantum photonic device designed to create maximally entangled states and to perform quantum state tomography on them . </S>",
    "<S> in particular we focus on statistically rigorous calibration and tomography which allow us to reach a very high fidelity between theoretically expected and measured states .    </S>",
    "<S> the paper is organised as follows . </S>",
    "<S> we first describe the experimental arrangement and the device design . </S>",
    "<S> we continue by detailing the statistical calibration procedure and the used theoretical model that takes into account the finite quantum interference . </S>",
    "<S> we also explain how the state tomography is performed . </S>",
    "<S> we then proceed to the benchmarking results for states ranging from fully mixed to nearly maximally entangled by adjusting photon delay . </S>",
    "<S> we conclude by discussing the results .    </S>",
    "<S> the photonic circuit investigated here was fabricated using silica - on - silicon technology @xcite . </S>",
    "<S> figure  [ fig1 ] shows a schematic design of the device . </S>",
    "<S> a qubit is encoded in the amplitude and phase of a single photon travelling on a pair of waveguides ( path encoding ) @xcite . </S>",
    "<S> for realising a two - qubit state two identical photons and four waveguides are necessary . </S>",
    "<S> for instance one photon at each of the inputs 2 and 4 corresponds to the two qubit state @xmath2 . </S>",
    "<S> the chip can be viewed as composed of three parts : the first part on the left prepares arbitrary single qubit states ( see the pink p / m1 and blue p / m2 blocks in fig .  [ fig1 ] ) . the central part ( see the yellow block c in fig .  [ fig1 ] ) is responsible for the quantum entanglement owing to the probabilistic controlled - not gate  ( cnot ) @xcite . </S>",
    "<S> the blocks on the right hand side are mirror images of the preparation blocks on the left and are used to choose the basis for projective measurements on the two single qubits . </S>",
    "<S> each block consists of a number of directional couplers ( dc ) and voltage - controlled thermal variable phase shifters  @xcite .    </S>",
    "<S> the experimental setup that we used is similar to that of ref .  </S>",
    "<S> @xcite , the only difference being the reconfigurable photonic chip . </S>",
    "<S> the chip was mounted on a chip holder and butt coupled with optical fibre v - groove arrays at the input and output . </S>",
    "<S> photon pairs were generated by a type - i spontaneous parametric down - conversion source , pumped using a 50 mw 405 nm laser . </S>",
    "<S> the 810 nm photons were filtered with 2 nm bandpass filters and collected into polarisation maintaining fibres with aspheric lenses and then directed to the chip . </S>",
    "<S> the detection of photons was done by single photon avalanche diodes connected to the output fibre array with an efficiency of about 50@xmath1 . </S>",
    "<S> all photon arrival times were recorded by a counting card at a time resolution of about 165 ps . </S>",
    "<S> two photon coincidences could then be detected between every pair of output waveguides . </S>",
    "<S> the relative delay of the response time between all the detectors has been calibrated and deducted before counting coincidences . </S>",
    "<S> a time window of 1.5 ns was employed to count coincidence in the experiment . </S>",
    "<S> this width of the window is required because of statistic variation of detector response time . </S>",
    "<S> the random two photon coincidence rate for this time window was calculated in the experiments and was always less than 0.4% .    the generation , manipulation and measurement of entanglement and single qubit mixed states has been demonstrated with a linear photonic two - qubit chip of the same design  @xcite as in the present paper . in those experiments </S>",
    "<S> an average quantum state tomography fidelity of 92.8@xmath02.5@xmath1 was achieved for the four maximally entangled bell states . however , from experiments performed to date , it is unclear what mechanisms cause the decrease from ideal fidelity . </S>",
    "<S> possible causes include distinguishability of the input photon pair , inaccurate phase shifters , non ideal reflectivities of the on - chip directional couplers , variations in the output coupling and photon detection efficiencies . in order to make further improvement to the fidelity of chip operation </S>",
    "<S> it is important to carefully characterise all these . </S>",
    "<S> we focus here on the chip parameters and distinguishability </S>",
    "<S> .    schematic design of the integrated photonic device . </S>",
    "<S> the reconfigurable phase shifters are labelled by @xmath3 and the waveguide directional couplers by dc1 - 13 . </S>",
    "<S> all directional couplers have a design reflectivity of @xmath4 except the ones marked by a dot ( reflectivity @xmath5 ) . </S>",
    "<S> the shaded blocks indicate different functions within the circuit . </S>",
    "<S> the pink p / m1 and blue blocks p / m2 perform single qubit rotations on the target qubit and the control qubit , respectively . </S>",
    "<S> the yellow region c performs a cnot operation . </S>",
    "<S> the arrows on the input side indicate the input waveguides for the photon pair arriving from the source . </S>",
    "<S> we adopt a convention such that the control qubit states @xmath6 and @xmath7 correspond to the output channel pairs 5 and 4 , respectively , while the target qubit states @xmath6 and @xmath7 correspond to the output channel pairs 3 and 2 , respectively.,scaledwidth=90.0% ]    before using the bayesian technique to calibrate the the chip ( passive ) parameters accurate mapping of the phase shift as a function of the applied voltage is required . </S>",
    "<S> the eight resistor - based variable thermo - optic phase shifters dependencies were measured individually with single photons  @xcite . </S>",
    "<S> this was done using interference by sending single photons repeatedly to the waveguides 2 or 4 and then counting the number of output photons within a fixed time window as a function of the heater voltage . </S>",
    "<S> all the eight calibrations were done while the remaining heaters were driven at a medium power level to mimic the conditions during a typical experiment .    </S>",
    "<S> with all the eight phase shifters calibrated , the reflectivities of the 13 on - chip directional couplers @xmath8 could be determined using bayesian inference @xcite . </S>",
    "<S> a statistical model for the set of variables @xmath9 given the set of parameters @xmath10 is described by the conditional probability @xmath11 . </S>",
    "<S> this model can be converted to the distribution of the parameters @xmath12 given a set of observations @xmath9 using the bayes rule @xmath13 where @xmath14 is the prior distribution containing the initial assumptions and @xmath12 is the posterior distribution . in the present context </S>",
    "<S> @xmath9 is the set of observed photon coincidences for different configurations whereas @xmath10 is the set of device parameters . </S>",
    "<S> the rule can be used iteratively for updating the distribution : the latest posterior can be used as a prior for new data . </S>",
    "<S> the method makes the dependence on underlying assumptions transparent and provides a general model that can be applied as long as one is able to write down an appropriate statistical model for the experiment . in the present study </S>",
    "<S> the required likelihood function is for two - photon coincidences , given the parameters of the photonic circuit . evaluating the likelihood function </S>",
    "<S> exactly is hard and we use a markov chain monte carlo ( mcmc ) @xcite method to draw samples from the posterior .    to generate the experimental data for the bayesian inference task we pick 1000 sets of 8 random phases uniformly generated between 0 and 2@xmath15 and bias the phase shifters accordingly . </S>",
    "<S> for each of the 1000 phase settings @xmath16 , @xmath17 , identical photons were sent to waveguides 2 and 4 while we recorded the number of coincidences @xmath18 between all the pairs @xmath19 and @xmath20 of the 6 output channels . </S>",
    "<S> that is , we recorded the frequency of the 15 different coincidence events for 1000 randomly chosen phase settings . </S>",
    "<S> we denote this data set collectively as @xmath21 and the number of coincidences observed for a given phase setting @xmath16 is indicated by @xmath22 . for two channels @xmath23 one </S>",
    "<S> can express the expected probabilities for the observed coincidences compactly as @xmath24.\\nonumber \\end{aligned}\\ ] ] here @xmath25 is a parameter describing the probability that the two photons are distinguishable . </S>",
    "<S> @xmath26 is the underlying @xmath27 unitary describing the single - photon behaviour of the chip . </S>",
    "<S> @xmath28 can be obtained in a straightforward way by combining the effect of the 13 directional couplers and 8 phase shifters ( see [ appendixa ] ) . </S>",
    "<S> the probability @xmath29 thus depends on all the chip parameters of interest . </S>",
    "<S> the normalisation factor @xmath30 is obtained by summing over all the events that our detection scheme can detect . </S>",
    "<S> this is needed since the events corresponding to two photons in the same channel are not measured . for a derivation of the coincidence probabilities starting from the device unitaries </S>",
    "<S> see [ appendixb ] . </S>",
    "<S> the model for the coincidence probability can be interpreted as a statistical mixture of ideal quantum interference behaviour and distinguishable behaviour .    to see how this model can be used to obtain the unknown parameters , </S>",
    "<S> let us consider the probability of observing the set of coincidences @xmath21 given the parameters @xmath31 . </S>",
    "<S> for each of the experiments @xmath32 the probability of observing a number of coincidences @xmath33 is given by the multinomial distribution @xmath34 we can therefore write the total probability as the product of 1000 multinomial distributions ( for a given total number of events @xmath35 for each experiment @xmath32 ) @xmath36 this function should be considered to be the conditional distribution given that @xmath35 events have occurred for each @xmath32 . </S>",
    "<S> although @xmath35 is in principle a stochastic variable , it could just as well be selected by collecting precisely that amount of data . </S>",
    "<S> when the @xmath37 are fixed , this function of @xmath38 is called the likelihood function . </S>",
    "<S> however , we were interested in the distribution of the parameters given the observations , and not vice versa . </S>",
    "<S> we therefore used the bayes theorem to write the so - called posterior distribution for @xmath39 as @xmath40 here the normalisation factor can be in principle obtained by integrating over @xmath39 but in practice it is hard to do without solving for the distribution . </S>",
    "<S> here we took the prior as a constant but set it to zero in unphysical regions of the parameter space .    </S>",
    "<S> it is very difficult to directly evaluate @xmath41 . </S>",
    "<S> instead , we used the markov chain monte carlo metropolis - hastings algorithm to perform a random walk in the parameter space @xmath39 . </S>",
    "<S> this method works by starting from a random point in parameter space and picking trial points randomly in a symmetric way . </S>",
    "<S> a trial point can be accepted or rejected depending on how its probability compares to the probability of the previous point . </S>",
    "<S> the new point is always accepted if it is more probable . </S>",
    "<S> if the new point is less probable it is accepted with the probability corresponding to the ratio of probabilities . </S>",
    "<S> here pseudo random numbers are used . </S>",
    "<S> note that using ratios avoids calculating the normalisation factor . </S>",
    "<S> numerically it is actually much more accurate and stable to perform the comparisons with logarithms of the pseudo random numbers and logarithms of the probabilities @xmath42 . in our case </S>",
    "<S> this approach avoided the need of multiplying 15000 below unity numbers before comparison . </S>",
    "<S> it also eliminated the factorial term which is a constant as a function of @xmath39 . </S>",
    "<S> the resulting data was stored and owing to so - called detailed balance and ergodicity , the walk sampled the distribution as if the points were drawn from it . </S>",
    "<S> one could then calculate e.g. the moments or histograms from the data . for </S>",
    "<S> the data shown below we let the system initialise for 30000 steps and we then sampled for 200000 steps . </S>",
    "<S> the number of steps was chosen empirically . </S>",
    "<S> trials were performed by adding a normally distributed number ( standard deviation was chosen to be 0.5% of design / expected value ) to a randomly picked parameter . without optimising </S>",
    "<S> the code the sampling takes about the same time as the experiment using a laptop running matlab ( overnight ) .    </S>",
    "<S> the resulting expectation values and standard deviations of the reflectivities of the directional couplers 1 - 13 are shown in table  [ tab1 ] . </S>",
    "<S> the differences between fitted and designed values were expected to be less than 5@xmath1 for the process employed . </S>",
    "<S> the slightly larger observed variation indicates that the fabrication process was not fully within specifications . </S>",
    "<S> in addition , we found the probability of two - photon distinguishability ( which equals one minus visibility of two photon interference ) to be @xmath43 . </S>",
    "<S> this probability of distinguishability takes into account all contributions that might deteriorate the visibility of two photon interference such as non - identical spectra and polarisation of the photon source as well as non - uniform refractive index or birefringence in the waveguides .    </S>",
    "<S> c > m2.3cm<>m4.3cm < r@.l & design values & fitted values &   +   @xmath44 & 0.3333 & 0.3257@xmath00.0008 & -2 & 3% + @xmath45 & 0.5000 & 0.5186@xmath00.0007 & 3 & 7% + @xmath46 & 0.5000 & 0.5063@xmath00.0011 & 1 & 3% + @xmath47 & 0.5000 & 0.4494@xmath00.0008 & -10 & 1% + @xmath48 & 0.5000 & 0.4526@xmath00.0010 & -9 & 5% + @xmath49 & 0.5000 & 0.5375@xmath00.0014 & 7 & 5% + @xmath50 & 0.5000 & 0.5635@xmath00.0010 & 12 & 7% + @xmath51 & 0.3333 & 0.3175@xmath00.0005 & -4 & 7% + @xmath52 & 0.5000 & </S>",
    "<S> 0.5381@xmath00.0013 & 7 & 6% + @xmath53 & 0.5000 & 0.5009@xmath00.0016 & 0 & 2% + @xmath54 & 0.5000 & 0.5204@xmath00.0016 & 4 & 1% + @xmath55 & 0.5000 & 0.5760@xmath00.0013 & 15 & 2% + @xmath56 & 0.3333 & 0.2967@xmath00.0007 & -11 & 0% +    to confirm the reliability of the fitted results of both the coupler reflectivities and distinguishability of the photons , two photon interference experiments were carried out over various mach zehnder interferometers on the chip . </S>",
    "<S> figure  [ fig2 ] shows a hong - ou - mandel dip  @xcite , measured over the branch on the top right corner of the chip . </S>",
    "<S> the hong ou mandel dip was obtained by inserting photons in waveguides 1 and 4 and counting the coincidences at waveguides 2 and 3 . </S>",
    "<S> the phase shifters 3 and 4 on the preparation side were adjusted so that the first interference takes place at directional coupler 5 , while phase shifters 5 and 6 were tuned so that the effective reflectivity of the whole branch was as close to 50% as possible ( estimated 52% ) . </S>",
    "<S> the visibility of the dip was measured to be @xmath57 . </S>",
    "<S> another hong ou mandel dip measurement over the central directional coupler 8 yielded a visibility of 73.09@xmath01.0@xmath1 . </S>",
    "<S> this is about 3.1@xmath1 lower than the value ( 76.21@xmath1 ) to be expected from reflectivity of 0.3175 for coupler 8 . </S>",
    "<S> both of the hong ou mandel scans thus resulted in about 3 - 4@xmath1 imperfection which is in agreement with our markov chain monte carlo - based characterisation .    </S>",
    "<S> hong ou mandel dip scan of an on - chip mach zehnder interferometer whose reflectivity is set to 0.5 . </S>",
    "<S> the probability of distinguishability @xmath58 can be obtained from a fit to the measurement of the two photon coincidence counts . </S>",
    "<S> the maximum number of coincidence counts is identified with @xmath59 . , scaledwidth=90.0% ]    having carefully calibrated the integrated quantum photonic chip parameters we then performed a demanding benchmark experiment . </S>",
    "<S> the generation and characterization of maximally entangled bell states offered an ideal test case for this purpose . using inputs 2 and 4 we prepared the initial state @xmath2 and drove the input side phase shifters 1 - 4 to prepare pure product states . </S>",
    "<S> the corresponding bell states @xmath60 , @xmath61 , @xmath62 and @xmath63 could then be produced utilising the cnot gate in the centre of the chip . </S>",
    "<S> however , it is clear from the characterisation of the device that the beam splitter reflectivities deviate from their ideal values and even for perfectly indistinguishable photons we can not expect to be able to prepare precisely these states . </S>",
    "<S> we therefore also calculated the theoretically expected modified density matrices for the purpose of the current benchmark test . similarly to the markov chain monte carlo - based calibration , we modelled the theoretically expected density matrix taking the real chip parameters into account as ( see [ appendixc ] ) @xmath64\\label{twoqubitrho}\\ ] ] within the two - qubit subspace , where @xmath30 is chosen such that @xmath65 . </S>",
    "<S> the indistinguishable part exhibiting ideal quantum interference is obtained simply as @xmath66 using @xmath67 where the amplitudes of the two distinguishable possibilities are @xmath68 and @xmath69 where the unitary @xmath70 is now only of the preparation stage ( see [ appendixa ] ) . </S>",
    "<S> the distinguishable part can be obtained as the statistical mixture of the two distinguishable possibilities @xmath71 in order to arrive at a valid density matrix the two qubit state has to be normalised to account for the fact that the cnot works probabilistically , i.e. the state is projected to the two - qubit subspace . </S>",
    "<S> note that the diagonals of @xmath72 and @xmath73 consist of the familiar looking elements : in the former case probabilities are added , and in the latter case amplitudes are added .    to benchmark the photonic chip we reconstructed the density matrix by quantum state tomography @xcite . instead of the more commonly used maximum likelihood tomography we used bayesian mcmc method . </S>",
    "<S> this serves two purposes : it allows us to conveniently ensure that the density matrix is physical and to obtain rigorous error bars for the density matrix fidelity against theoretical expectations . to obtain the required experimental data , we used nine different phase settings on the output side phase shifters per input state , which are in principle enough to characterise the state fully  @xcite . </S>",
    "<S> that is , we measured the qubits along @xmath74 as accurately as possible . </S>",
    "<S> each one of the measurements gives information not only about the corresponding two - qubit density matrix element but also about the single - qubit terms . </S>",
    "<S> however , to account for imperfections and finite number of repetitions we resorted to numerical methods . </S>",
    "<S> we parametrised the density matrix as @xmath75 , where @xmath76 s are the 15 free real unknown parameters , with @xmath77 , and @xmath78 are the pauli matrices including the identity @xmath79 in the notation . similar to parameter estimation , we can obtain the distribution of the density matrix parameters @xmath80 using @xmath81 or @xmath82 up to a constant . here </S>",
    "<S> @xmath83 denotes the collective set of observations . </S>",
    "<S> we can write the multinomial likelihood as @xmath84 where d is a constant , the index @xmath85 runs over the nine tomography phase settings , @xmath86 is the number of times that we detected the qubit state @xmath87 and @xmath88 is the corresponding expected probability . </S>",
    "<S> these probabilities depend on both the unknown density matrix parameters that we optimise over and the currently known phase settings of the shifters 5 - 8 . </S>",
    "<S> we used a uniform prior @xmath89 over physical density matrices , i.e. @xmath89 is constant whenever the corresponding eigenvalues of @xmath90 are non - negative and zero otherwise . in practice </S>",
    "<S> this means that @xmath91 is set to a large value ( ideally infinite ) whenever the mcmc algorithm attempts to move outside the physical region . </S>",
    "<S> there are numerous other alternative ways to choose the prior @xcite . </S>",
    "<S> we chose the present one due to numerical convenience . </S>",
    "<S> the real part of measured density matrices of all the four bell states are shown in figure  [ fig3 ] . </S>",
    "<S> the fidelity estimates and the mean density matrices are obtained by averaging over the random walk . </S>",
    "<S> both the fidelity against the ideal bell state and the fidelity against the predicted density matrix taking into account the calibrated parameters are shown . </S>",
    "<S> these are denoted by @xmath92 and @xmath93 , respectively . </S>",
    "<S> we used the definition of fidelity @xcite @xmath94 where @xmath95 is the experimentally measured density matrix . to calculate the fidelity @xmath96 we choose the reference density matrix @xmath97 to be the density matrix of one of the bell states . to obtain @xmath98 </S>",
    "<S> we set the reference density matrix to the density matrix calculated using eq .  </S>",
    "<S> ( [ twoqubitrho ] ) with the same settings for the phase shifters as for the bell states but using real coupler efficiencies and taking the non - ideal photon indistinguishability into account . for the four bell states @xmath92 is 93.79@xmath01.05@xmath1 on average </S>",
    "<S> this is an improvement over previously reported @xcite fidelities . </S>",
    "<S> the remaining 5 - 6@xmath1 imperfection mostly arises from the non ideal reflectivities and the photon source , as the average fidelity increases to 97.57@xmath00.96@xmath1 for @xmath93 . </S>",
    "<S> this indicates that a major source of the decrease of the fidelity are the non - ideal reflectivities of the on - chip directional couplers .    generation and measurements of bell states . </S>",
    "<S> ( a)-(d ) : real part of density matrix of bell states @xmath99,@xmath100 , @xmath101 and @xmath102 respectively . </S>",
    "<S> the corresponding phase shifts were @xmath103 , @xmath104 , @xmath105 and @xmath106 for @xmath99 ; @xmath103 , @xmath104 , @xmath107 and @xmath106 for @xmath100 ; @xmath108 , @xmath104 , @xmath107 and @xmath106 for @xmath101 ; @xmath103 , @xmath104 , @xmath105 and @xmath106 for @xmath102 . </S>",
    "<S> the two fidelity values at the top of each figure were calculated against the ideal bell states and best theoretical prediction . </S>",
    "<S> the quoted fidelity values indicate the bayesian 95% confidence intervals . </S>",
    "<S> the insets illustrate typical mcmc fidelity histograms for the ideal ( solid ) and the best theoretical expectation ( dashed).,scaledwidth=100.0% ]    to further demonstrate the agreement with the theoretical model and the experimental results , we varied the relative delay of the two photons and performed quantum state tomography for each fixed delay . </S>",
    "<S> this experiment can be viewed as a hong - ou - mandel measurement for bell states . </S>",
    "<S> depending on the delay between the two photons , the four two - qubit states were expected to change between maximally entangled and totally mixed as predicted by the model presented above . </S>",
    "<S> we compared the measured density matrices against ( i ) the ideal bell states , ( ii ) against the best expected density matrix with finite but optimal @xmath25 with real reflectivities and ( iii ) finally against the delay dependent @xmath109 ( with real reflectivities ) , where @xmath25 was deduced from the independent measurement in fig .  </S>",
    "<S> [ fig2 ] . figure  [ fig4 ] ( a)-(d ) illustrate the results for @xmath99 , @xmath100 , @xmath101 and @xmath102 , respectively . </S>",
    "<S> there are three curves for each state : the lowest ( red ) curve corresponds to case ( i ) , the middle ( blue ) corresponds to case ( ii ) and top ( magenta ) corresponds to case ( iii ) . in cases ( i ) and </S>",
    "<S> ( ii ) one can clearly see how the fidelities peak in analogy with the hong - ou - mandel effect </S>",
    "<S> . comparing the experiments with the detailed model results in an increase in the fidelities . </S>",
    "<S> the tops of the four peaks correspond to fig .  </S>",
    "<S> [ fig3 ] . case ( iii ) shows the agreement of theory and experiment most clearly ; the fidelity of the measured density matrices as a function of delay agrees almost perfectly with the model for the delay dependent @xmath110 which is a statistical mixture of distinguishable and indistinguishable behaviour . </S>",
    "<S> how the reconstructed density matrices evolve as a function of the delay is shown in a supplementary video .    </S>",
    "<S> bell states fidelity as a function of the relative delay of the two photons . </S>",
    "<S> red : @xmath92 , fidelity against ideal bell states . </S>",
    "<S> blue : @xmath93 , fidelity against modified expectation with fitted reflectivities and probability of distinguishability . </S>",
    "<S> magenta : fidelity against the best theoretical expectation using fitted reflectivities and the delay - dependent probability of distinguishability . </S>",
    "<S> this delay - dependent probability is obtained from the independent hong ou mandel dip scan in fig .  </S>",
    "<S> [ fig2].,scaledwidth=100.0% ]    in conclusion , we have presented an accurate calibration method for a reconfigurable two - qubit quantum photonic chip based on bayesian updating and markov chain monte carlo simulation . </S>",
    "<S> an alternative approach to tomography of linear optics circuits has been presented in @xcite . </S>",
    "<S> our method differs in several points . </S>",
    "<S> additional to employing a statistical inference method we use an explicit model of the device and do not look for a general unitary . </S>",
    "<S> this reduces the number of parameters that need to be estimated . </S>",
    "<S> furthermore , our method introduces minimal disturbance from calibration to the actual measurements as it is not necessary to switch the input ports for the photons . </S>",
    "<S> having obtained the real chip and source parameters we checked the fidelity of a prepared state against a theoretical prediction using these parameters . </S>",
    "<S> a maximum fidelity of 98.02@xmath01.03@xmath1 against the theory prediction using the real device parameters shows that practically all error sources are accounted for and improving the photon source as well as the chip fabrication will make it possible to prepare states with fidelities larger than @xmath111 . </S>",
    "<S> a remarkable fact is that the almost unit fidelity also extends to mixed states . </S>",
    "<S> this enables us to reliably prepare not only maximally entangled states but also mixed states with a varying degree of mixedness . </S>",
    "<S> a source of such states can be of considerable interest in investigating mixed state quantum computation and test concepts like quantum discord . </S>"
  ]
}