{
  "article_text": [
    "in this paper we continue our study of the coarse geometry of teichmller  space begun in @xcite .",
    "our goal , as part of gromov s broad program to understand spaces and groups by their coarse or quasi - isometric geometry , is to carry this out in the context of teichmller  space equipped with the teichmller  metric . to state the main theorem ,",
    "let @xmath0 be a connected surface of finite hyperbolic type .",
    "define the complexity of @xmath0 to be @xmath1 where @xmath2 is the genus of @xmath0 and @xmath3 is the number of punctures .",
    "let @xmath4 denote the teichmller  space of @xmath0 equipped with the teichmller  metric @xmath5 .",
    "[ thm : main ] assume @xmath6 .",
    "then , for every @xmath7 there is a constant @xmath8 such that if @xmath9 is a @xmath10quasi - isometry then there is an isometry @xmath11 such that , for @xmath12 @xmath13    recall that a map @xmath14 from a metric space @xmath15 to a metric space @xmath16 is a @xmath17quasi - isometry if it is @xmath18coarsely onto and , for @xmath19 , @xmath20 if equation   holds and the map is not assumed to be onto , then @xmath21 is called a _ quasi - isometric embedding_. one defines , for a metric space @xmath22 , the group @xmath23 as the equivalence classes of quasi - isometries from @xmath24 to itself , with two quasi - isometries being equivalent if they are a bounded distance apart .",
    "when the natural homomorphism @xmath25 is a isomorphism , we say @xmath24 is quasi - isometrically rigid .",
    "then the main theorem restated is that @xmath4 is quasi - isometrically rigid .",
    "note also that , by royden s theorem @xcite , @xmath26 is essentially the mapping class group ( the exceptional cases are the twice - punctured torus and the closed surface of genus @xmath27 where the two groups differ by a finite index ) . hence ,",
    "except for the lower complexity cases , @xmath28 is isomorphic to the mapping class group",
    ". this theorem has also been proven by brian bowditch @xcite by a different method .",
    "there is a fairly long history that involves the study of the group @xmath23 in different contexts . among these ,",
    "symmetric spaces are the closest to our setting .    in the case when @xmath24 is @xmath29 , @xmath30 or @xmath31 ,",
    "the quasi - isometry group is complicated and much larger than the isometry group .",
    "in fact , if a self map of @xmath30 is a bounded distance from an isometry then it induces a conformal map on @xmath32 .",
    "but , every quasi - conformal homeomorphism from @xmath33 extends to a quasi - isometry of @xmath30 .",
    "this , in particular , shows why the condition @xmath6 in theorem  [ thm : main ] is necessary . when @xmath34 , @xmath4 is isometric ( up to a factor of @xmath27 ) to the hyperbolic plane @xmath35 and , as mentioned above , @xmath35 is not rigid .",
    "pansu @xcite proved that other rank one symmetric spaces of non - compact type such as quaternionic hyperbolic space @xmath36 and the cayley plane @xmath37 are rigid .",
    "in contrast , higher rank irreducible symmetric spaces are rigid .",
    "this was proven by kleiner - leeb @xcite ( see also eskin - farb @xcite for a different proof ) . in our setting , when @xmath6 , @xmath4 is analogous to a higher rank symmetric space ( see @xcite and @xcite for discussion about flats in @xmath4 ) and the curve complex @xmath38 , which plays a prominent role in teichmller  theory is analogous to the tits boundary of symmetric space .",
    "continuing the above analogy , the action of mapping class group on teichmller  space is analogous to the action of a non - uniform lattice on a symmetric space .",
    "quasi - isometric rigidity was shown for non - uniform lattices in rank @xmath39 groups other than @xmath40 @xcite and for some higher rank lattices @xcite by schwartz and in general by eskin @xcite .",
    "the quasi - isometric rigidity of the mapping class group @xmath41 was shown by behrstock - kleiner - minsky - mosher @xcite and by hamenstdt  @xcite and later by bowditch @xcite .",
    "more generally bowditch in that same paper showed that if @xmath0 and @xmath42 are closed surfaces with @xmath43 and @xmath44 is a quasi - isometric embedding of @xmath41 in @xmath45 , then @xmath46 and @xmath44 is bounded distance from an isometry .",
    "he also shows quasi - isometric rigidity for teichmller space with the weil - petersson metric @xcite .",
    "we prove this theorem inductively .",
    "to apply induction , we need to consider non - connected surfaces .",
    "let @xmath47 be a possibly disconnected surface of finite hyperbolic type .",
    "we always assume that @xmath47 does not have a component that is a sphere , an annulus , a pair of pants or a torus .",
    "we define the complexity of @xmath47 to be @xmath48 where @xmath49 is the number of connected components of @xmath47 . for point",
    "@xmath50 , let @xmath51 be the short pants decomposition at @xmath52 ( see  [ sec : short ] ) and for a curve @xmath53 define ( see  [ sec : short ] for the exact definition ) @xmath54 for a constant @xmath55 , consider the sets @xmath56 and @xmath57 thinking of @xmath58 as a very large number , we say a quasi - isometry @xmath59 is @xmath60anchored at infinity if the restriction of @xmath61 to @xmath62 is nearly the identity .",
    "that is , for every @xmath63 , @xmath64 our induction step is the following .",
    "[ thm : induction ] let @xmath47 be a surface of finite hyperbolic type .",
    "for every @xmath65 and @xmath60 , there is @xmath66 and @xmath67 so that , for @xmath68 , if @xmath59 is a @xmath69quasi - isometry that is @xmath60anchored at infinity , then for every @xmath50 we have @xmath70    note that @xmath67 depends on the topology of @xmath47 and constants @xmath65 , @xmath60 and @xmath66 , but is independent of @xmath58 .",
    "the overall strategy is to take the quasi - isometry and prove it preserves more and more of the structure of teichmller  space .",
    "section  [ sec : background ] is devoted to establishing notation and background material . in section  [ sec : coarse ] we define the rank of a point as the number of short curves plus the number of complimentary components that are not pairs of pants .",
    "a point has maximal rank if all complimentary components @xmath71 have @xmath72 .",
    "we show in proposition  [ prop : rank - preserved ] that a quasi - isometry preserves points with maximal rank .",
    "the proof uses the ideas of coarse differentiation , previously developed in the context of teichmller  space in @xcite which in turn is based on the work of eskin - fisher - whyte @xcite .",
    "coarse differentiation was also previously used by peng to study quasi - flats in solvable lie groups in @xcite and @xcite .",
    "the important property of maximal rank is that near such a point of maximal rank , teichmller  space is close to being isometric to a product of copies of @xmath35 , with the supremum metric .    in section  [ sec : local ] we prove a local version of the splitting theorem shown in @xcite in the context of symmetric spaces and later in @xcite for products of hyperbolic planes .",
    "there it is proved in theorem  [ thm : factor - preserving ] that a quasi - isometric embedding from a large ball in @xmath73 to @xmath73 can be restricted to a smaller ball where it factors , up to a a fixed additive error .",
    "this local factoring is applied in section  [ sec : local - factors ] to give a bijective association @xmath74 between factors at @xmath52 and at @xmath75 .",
    "we also prove a notion of analytic continuation , namely , we examine when local factors around points @xmath52 and @xmath76 overlap , how @xmath74 and @xmath77 are related .",
    "we use this to show , proposition  [ prop : max - preserved ] , that maximal cusps are preserved by the quasi - isometry .",
    "a maximal cusp is the subset of maximal rank consisting of points where there is a maximal set of short curves all about the same length .",
    "there teichmller  space looks like a cone in a product of horoballs inside the product of @xmath35 .",
    "the set of maximal cusps is disconnected ; there is a component associated to every pants decomposition .",
    "thus , @xmath21 induces a bijection on the set of pants decomposition .",
    "the next step is then to show this map is induced by automorphism of the curve complex , and hence by ivanov s theorem , it is associated to an isometry of teichmller  space . composing @xmath21 by the inverse , we can assume that @xmath21 sends every component of the set of maximal cusps to itself .",
    "an immediate consequence of this is that @xmath21 restricted to the thick part of teichmller  space is a bounded distance away from the identity ( proposition  [ prop : thick ] ) .",
    "from this fact and again applying propositions  [ prop : local - factors ] and [ prop : analytic - continuation ] , we then show , proposition  [ prop : short - curve ] , that for any point in the maximal rank set , the shortest curves are preserved and in fact , for any shortest curve @xmath78 at points @xmath52 , @xmath79 .",
    "this allows one to cut along the shorest curve , induce a quasi - isometry on teichmller  space of lower complexity and proceed by induction .",
    "most of the discussion above also applies for the disconnected subsurfaces . hence , much of sections  [ sec : local - factors ] and [ sec : short - curves ] is written in a way to apply to both @xmath4 and @xmath80 settings .",
    "the induction step is carried out in section  [ sec : induction ] .",
    "we would like to thank brian bowditch for helpful comments on an earlier version of this paper .",
    "the purpose of this section is to establish notation and recall some statements from the literature .",
    "we refer the reader to @xcite and @xcite for basic background on teichmller  theory and to @xcite and @xcite for some background on the geometry of the teichmller  metric .    for much of this paper ,",
    "the arguments are meant to apply to both @xmath4 which is the teichmller  space of a connected surface and to @xmath80 where @xmath47 is disconnected and the space is truncated at infinity . in such situations , we use the notation @xmath81 to refer to either case and use the full notation where the discussion is specific to one case or the other .",
    "similarly , @xmath21 denotes either a quasi - isometry @xmath82 of @xmath4 or a quasi - isometry @xmath61 of @xmath83 .",
    "a similar convention is also applied to other notations as we suppress symbols @xmath0 or @xmath47 to unify the discussion in the two cases .",
    "for example , @xmath84 and @xmath85 could refer to @xmath86 and @xmath87 or to @xmath65 and @xmath60 and @xmath88 could refer to @xmath89 or @xmath90 .    by a _ curve _",
    ", we mean the free isotopy class of a non - trivial , non - peripheral simple closed curve in either @xmath0 or @xmath47 . also , by a subsurface we mean a free isotopy class of a subsurface @xmath91 , where the inclusion map induces an injection between the fundamental groups .",
    "we always assume that @xmath91 is not a pair of pants .",
    "when we say @xmath92 is a curve in @xmath91 , we always assume that it is not peripheral in @xmath91 ( not just in @xmath0 ) .",
    "we write @xmath93 to indicate that the curve @xmath78 is a boundary component of @xmath91 .",
    "we often examine a point @xmath94 from the point of view of its subsurfaces . for every subsurface @xmath91",
    ", there is a projection map @xmath95 defined using the fenchel - nielson coordinates ( see @xcite for details ) . when the boundary of @xmath91 is not short , these maps are not well behaved .",
    "hence these maps should be applied only when there is an upper - bound on the length of @xmath96 ( see below ) .    when @xmath91 is an annulus , or when @xmath97 , the space @xmath98 can be identified with the hyperbolic plane @xmath35 ;",
    "however the teichmller  metric differs from the usual hyperbolic metric by a factor of @xmath27 .",
    "we always assume that @xmath35 is equipped with this metric which has constant curvature @xmath99 .",
    "we denote the @xmath100 simply by @xmath101 .",
    "a _ decomposition _ of @xmath0 is a set @xmath102 of pairwise disjoint subsurfaces of @xmath0 that fill @xmath0 .",
    "subsurfaces in @xmath102 are allowed to be annuli ( but not pairs of pants ) . in this context , _ filling _ means that every curve in @xmath0 either intersects or is contained in some @xmath103 . in particular , for every @xmath103 , the annulus associated to every boundary curve of @xmath91 is also included in @xmath102 .",
    "the same discussion holds for @xmath47 .    for a decomposition @xmath102 and @xmath104",
    "define @xmath105    [ thm : product - regions ] for @xmath106 small enough , @xmath107 is an isometry up to a uniform additive error @xmath108 . here",
    ", the product on the right hand side is equipped with the sup metric .",
    "that is , for @xmath109 @xmath110    for the rest of the paper , we fix the value of @xmath106 that makes this statement hold .",
    "we also assume that two curves of length less than @xmath106 do not intersect .",
    "we refer to @xmath111 as _ the product region associated to @xmath102_.    we say @xmath102 is _ maximal _ if every @xmath103 is either an annulus , or @xmath97 ( recall that pairs of pants are always excluded ) .",
    "that is , if @xmath102 is maximal then the associated product region is isometric , up to an additive error @xmath108 , to a subset of a product space @xmath112 equipped with the sup metric . for the rest of the paper",
    ", we always assume the product @xmath112 is equipped with the sup metric . for points",
    "@xmath113 , we say _",
    "@xmath52 and @xmath114 are in the same maximal product region _ if there is a maximal decomposition @xmath102 where @xmath115 .",
    "note that such a @xmath102 is not unique .",
    "for example , let @xmath116 be a pants decomposition and let @xmath52 be a point where the length in @xmath52 of every curve in @xmath116 is less than @xmath106 .",
    "then there are many decompositions @xmath102 where every @xmath103 is either a punctured torus or a four - times punctured sphere with @xmath117 or an annulus whose core curve is in @xmath116 .",
    "the point @xmath52 belongs to @xmath111 for every such decomposition @xmath102 .",
    "( 100 , 20 ) ( 1,0 ) and @xmath118 are depicted above . note that @xmath119 .",
    "however , for the pants decomposition @xmath120 , any point @xmath94 where all curves in @xmath116 have a length less than @xmath106 is contained in @xmath121.,title=\"fig : \" ] ( 51,0 ) and @xmath118 are depicted above . note that @xmath119 .",
    "however , for the pants decomposition @xmath120 , any point @xmath94 where all curves in @xmath116 have a length less than @xmath106 is contained in @xmath121.,title=\"fig : \" ]    ( 3,17)@xmath122 ( 53,17)@xmath118    ( 13 , -1)@xmath78 ( 35 , -1)@xmath123 ( 74 , 1)@xmath92      the thick part @xmath124 of @xmath81 is the set of points @xmath52 where , for every curve @xmath92 , @xmath125 .",
    "there is a constant @xmath126 ( the bers constant ) so that , for any point @xmath127 , the set of curves that have extremal length at most @xmath126 _ fills _ the surface .",
    "that is , every curve intersects a curve of length at most @xmath126 .",
    "note that every @xmath94 contains a curve of length at most @xmath126 .",
    "in fact , we choose @xmath126 large enough so that every @xmath94 has a pants decomposition of length at most @xmath126 .",
    "we call such a pants decomposition the _ short pants decomposition at @xmath52 _ and denote it by @xmath51 .",
    "we also assume that @xmath106 is small enough so that if @xmath128 ( @xmath78 is @xmath106short ) then @xmath78 does not intersect any @xmath126short curve . hence @xmath51 contains every @xmath106short curve .",
    "it is often more convent to work with the logarithm of length . for @xmath129 and @xmath130 , define @xmath131 to be the largest number so that if @xmath132 then @xmath133 . from the product regions theorem",
    ", we have @xmath134 where the constant on the right hand side depends on the value of @xmath108 and @xmath135 .",
    "we often need to _ pinch _ a curve .",
    "let @xmath94 and @xmath136 be given and let @xmath137 with @xmath138 .",
    "let @xmath76 be a point with @xmath139 and where the length of @xmath78 is @xmath106 .",
    "let @xmath140 and let @xmath141 be the point so that @xmath142 the last condition means @xmath76 and @xmath141 have no relative twisting around @xmath78 .",
    "we then say _",
    "@xmath141 is a point obtained from @xmath52 by pinching @xmath78_. there is a constant @xmath143 so that @xmath144      let @xmath91 be a subsurface of @xmath0 with @xmath145 .",
    "let @xmath146 denote the curve graph of @xmath91 ; that is , a graph where a vertex is a curve in @xmath91 , and an edge is a pair of disjoint curves .",
    "when @xmath147 , @xmath91 does not contain disjoint curves . here an edge is a pair of curves that intersect minimally ; once in the punctured - torus case and twice in the four - times - punctured sphere case . in the case",
    "@xmath91 is an annulus with core curve @xmath78 , in place of the curve complex , we use the subset @xmath148 of all points where the extremal length of @xmath78 is at most @xmath106 .",
    "this is a horoball in @xmath149 .",
    "depending on context , we use the notation @xmath146 or @xmath150 .",
    "there is a projection map @xmath151 that sends a point @xmath152 to a curve @xmath92 in @xmath91 with @xmath153 .",
    "this is not unique but the image has a uniformly bounded diameter and hence the map is coarsely well defined .",
    "when @xmath91 is an annulus , @xmath154 is the same as @xmath155 if @xmath156 and , otherwise , is the point on the boundary of @xmath150 where the real value is twisting of @xmath157 around @xmath78 .",
    "( see @xcite for the definition and discussion of twisting ) .",
    "we can also define a projection @xmath158 where @xmath92 is any curve that intersects @xmath91 non - trivially . if @xmath159 then choose the projection to be @xmath92 .",
    "if @xmath92 is not contained in @xmath91 then @xmath160 is a collection of arcs with endpoints on @xmath96 .",
    "choose one such arc and perform a surgery using this arc and a sub - arc of @xmath96 to find a point in @xmath146 .",
    "the choice of different arcs or different choices of intersecting pants curves determines a set of diameter @xmath27 in @xmath146 ; hence the projection is coarsely defined .",
    "note that this is not defined when @xmath92 is disjoint from @xmath91 .",
    "we also define a projection @xmath161 to be @xmath162 , however we still denote it by @xmath163 . for @xmath164 , we define @xmath165 for curves @xmath78 and @xmath123 , @xmath166 is similarly defined .",
    "in fact , the subsurface projections can be used to estimate the distance between two points in @xmath81 ( @xcite ) .",
    "there is threshold @xmath167 so that @xmath168 where @xmath169 is the set of subsurfaces @xmath71 where @xmath170 .",
    "[ def : cb ] we say a pair of points @xmath171 are @xmath172cobounded relative to a subsurface @xmath173 if @xmath96 is @xmath106short in @xmath52 and @xmath114 and if , for every surface @xmath174 , @xmath175 .",
    "if @xmath176 , we simply say @xmath52 and @xmath114 are @xmath172cobounded .    similarly , we say a pair of curves @xmath177 are @xmath172 cobounded relative to @xmath91 if for every @xmath178 , @xmath179 when defined . if @xmath176 , we simply say @xmath78 and @xmath123 are @xmath172cobounded",
    "a path @xmath180 in @xmath4 or in @xmath146 is @xmath172cobounded relative to @xmath91 if every pair of points in @xmath180 are @xmath172cobounded relative to @xmath91 .",
    "once and for all , we choose a constant @xmath181 so that through every point @xmath12 and for every @xmath91 whose boundary length is at most @xmath106 in @xmath52 , there is a bi - infinite path in @xmath4 passing through @xmath52 that is @xmath181cobounded relative to @xmath91 .",
    "one can , for example take an axis of a pseudo - anosov element in @xmath98 and then use the product regions theorem to elevate that to a path in @xmath81 whose projections to other subsurfaces are constant . when we say a geodesic @xmath180 in @xmath4",
    "is cobounded relative to @xmath91 , we always mean that it is @xmath181cobounded relative to @xmath91 . from equation   ( the distance formula )",
    "we have , for @xmath52 and @xmath114 along such @xmath180 , @xmath182",
    "in this section , we recall some results from @xcite and we develop them further to show that the set of points in teichmller  space with maximum rank is coarsely preserved ( see proposition  [ prop : rank - preserved ] below ) . since the notation @xmath183 and @xmath184 where used in @xcite , we continue to use them in this section .",
    "recall from @xcite that @xmath185 means there is a constant @xmath18 , depending only on the topology of @xmath0 or @xmath47 , so that @xmath186 .",
    "we say @xmath187 and @xmath188 are _",
    "similarly , @xmath189 means there is a constant @xmath18 , depending only on the topology of @xmath0 or @xmath47 , so that @xmath190 .",
    "we say @xmath187 and @xmath188 are _ the same up to an additive error_. for the rest of the paper , we would need to be more careful with constant .",
    "the only constants from this section that is used later is the constant @xmath191 from proposition  [ prop : rank - preserved ] .",
    "a path @xmath192 \\to { { \\mathcal t}}$ ] is called _ a preferred path _ if , for every subsurface @xmath91 , the image of @xmath193 is a reparametrized quasi - geodesic in @xmath146 .",
    "we use preferred paths as coarse analogues of straight lines in @xmath81 .",
    "[ def : size ] a _ box _ in @xmath29 is a product of intervals ; namely @xmath194 , where @xmath195 is an interval in @xmath196 .",
    "we say a box @xmath197 is _ of size @xmath198 _ if , for every @xmath199 , @xmath200 and if the diameter of @xmath197 is less than @xmath198 .",
    "note that if @xmath197 is of size @xmath198 and of size @xmath201 , then @xmath202 .",
    "the box in @xmath29 is always assumed to be equipped with the usual euclidean metric .    for points",
    "@xmath203 , we often treat the geodesic segment @xmath204 $ ] in @xmath197 as an interval of times parametrized by @xmath205 .",
    "a map @xmath206 from a box of size @xmath198 in @xmath29 to @xmath81 is called _ @xmath207efficient _ if , for any pair of points @xmath208 , there is a preferred path @xmath192 \\to { { \\mathcal t}}$ ] so that , for @xmath209 $ ] @xmath210    let @xmath197 be a box of size @xmath58 in @xmath29 and let @xmath211 be a central sub box of @xmath197 with comparable diameter ( say a half ) . for any constant @xmath212 ,",
    "let @xmath213 be a subdivision @xmath211 to boxes of size @xmath198 .",
    "that is ,    1 .",
    "boxes in @xmath213 are of size @xmath198 , 2 .",
    "they are contained in @xmath211 and hence their distance to the boundary of @xmath197 is comparable to @xmath58 , 3 .",
    "they have disjoint interiors and 4 .   @xmath214 .",
    "the following combines theorem  2.5 and theorem  4.9 in @xcite .",
    "[ thm : differentiable ] for every @xmath215 and @xmath216 there is @xmath217 so that the following holds .",
    "for @xmath218 , let @xmath206 be a @xmath17quasi - lipschitz map where @xmath197 is a box of size @xmath58 in @xmath29 . then , there is a scale @xmath219 so that the proportion of boxes @xmath220 where @xmath221 is @xmath207efficient is at least @xmath222 .",
    "even though we have no control over the distribution of efficient boxes , the following lemma says we can still connect every two point in @xmath211 with a path that does not intersect too many non - efficient boxes .",
    "[ lem : path ] let @xmath58 , @xmath198 , @xmath213 , @xmath207 and @xmath223 be as above . then , for any pair of points @xmath224 , there is a path @xmath92 in @xmath211 connecting them so that @xmath92 is covered by at most @xmath225 boxes and the number of boxes in the covering that are not @xmath207efficient is at most @xmath226{\\theta } \\frac lr\\big)$ ] .    let @xmath227{\\theta } \\frac lr$ ] .",
    "first assume that the distance between @xmath228 an @xmath229 to the boundary of @xmath211 is at least @xmath230 .",
    "consider the geodesic segment @xmath204 $ ] .",
    "take a @xmath231dimensional totally geodesic boxes @xmath232 and @xmath233 containing @xmath228 and @xmath229 respectively that are perpendicular to @xmath204 $ ] , parallel to each other and have a diameter @xmath234 .",
    "choose an @xmath198net of points @xmath235 in @xmath236 and @xmath237 in @xmath238 so that @xmath239 $ ] is parallel to @xmath204 $ ] .",
    "we have , for @xmath240 , @xmath241 , [ p_j , q_j ] \\big ) > r \\qquad\\text{and}\\qquad k { \\stackrel{{}_\\ast}{\\asymp}}n^{n-1}.\\ ] ] for @xmath242 , let @xmath243 be the path that is a concatenation of geodesic segments @xmath244 $ ] , @xmath239 $ ] and @xmath245 $ ] .",
    "we claim one of these paths has the above property .",
    "assume , for contradiction , that the number of non - efficient boxes along each @xmath243 is larger than @xmath246 for some large @xmath247 .",
    "then the total number of non - efficient boxes is at least @xmath248 but this is not possible for large enough value of @xmath249 ( see property ( 4 ) of @xmath213 above and theorem  [ thm : differentiable ] ) .",
    "hence , there is a @xmath250 and @xmath199 where @xmath239 $ ] intersects at most @xmath251 non - efficient boxes .",
    "note that , the segments @xmath244 $ ] and @xmath252 $ ] intersect at most @xmath253 boxes each .",
    "hence the number of inefficient boxes intersecting @xmath243 is at most @xmath254 . in the case @xmath228 or @xmath229 are close to the boundary , we choose points @xmath255 and @xmath256 nearby ( distance @xmath230 ) and apply the above argument to find an appropriate path between @xmath255 and @xmath256 and then concatenate this path with segments @xmath257 $ ] and @xmath258 $ ] . the total number of inefficient boxes along this path is at most @xmath259 .",
    "this finishes the proof .      in this section",
    ", we examine efficient maps that are also assumed to be quasi - isometric embeddings .",
    "we will show that they have _ maximal rank _ ; they make small progress in any subsurface @xmath71 with @xmath260 .",
    "[ def : standardflat ] let @xmath102 be decomposition of @xmath0 . for every @xmath103 , let @xmath261 be a preferred path .",
    "consider the box @xmath262 , where @xmath263 is the number of elements in @xmath102 .",
    "consider the map @xmath264 then @xmath265 is a quasi - isometric embedding because each @xmath266 is a quasi - geodesic .",
    "we call this map a _ standard flat _ in @xmath111",
    ".    the map @xmath267 below will be a modified version our map @xmath21 from theorem  [ thm : main ] .",
    "[ thm : tunnel ] for every @xmath268 , @xmath18 and @xmath172 , there is @xmath207 and @xmath216 so that the following holds .",
    "let @xmath269 be an @xmath207efficient @xmath270quasi - isometric embedding defined on a box @xmath271 of size @xmath219 , let @xmath272 be a @xmath172cobounded geodesic in @xmath273 , where @xmath71 is a subsurface with @xmath274 , and let @xmath275 be the closest point projection map from @xmath273 to @xmath272 . then",
    ", for @xmath276 and points @xmath277 , we have @xmath278    assume by way of contradiction that for all large @xmath198 and all small @xmath279 there is a subsurface @xmath71 , @xmath260 , an @xmath172cobounded geodesic @xmath272 in @xmath273 , a box @xmath197 of size @xmath198 in @xmath280 , and an @xmath207efficient map @xmath281 and a pair of points @xmath277 such that @xmath282      let @xmath192 \\to { { \\mathcal t}}$ ] be the preferred path joining @xmath283 and @xmath284 coming from the efficiency assumption .",
    "since @xmath180 is a preferred path , if @xmath285 is a geodesic in @xmath273 joining @xmath286 and @xmath287 , then @xmath285 can be reparametrized so that @xmath288 as stated in equation   we are assuming that the projection of the geodesic @xmath285 to @xmath272 has a length of at least @xmath289 . then",
    ", by the hyperbolicity of @xmath273 , @xmath285 and therefore @xmath290 lie in a uniformly bounded neighborhood of @xmath272 along a segment of @xmath180 of length @xmath291 .",
    "divide this piece of @xmath272 into @xmath292 segments .",
    "let @xmath293 be the corresponding endpoints of these segments which , for @xmath294 , satisfy @xmath295 let @xmath296 $ ] be the middle segment , let @xmath297 \\subset [ a , b]$ ] be the associated time interval and let @xmath298}$ ] .",
    "we claim that , for every @xmath299 so that @xmath300 , ( that is , either @xmath301 or @xmath302 ) the image of the projection of @xmath303 to @xmath304 has a bounded diameter .",
    "note that , since @xmath180 is a preferred path , it is enough to prove either @xmath305 or @xmath306 is uniformly bounded , assuming those curves intersect @xmath299 .",
    "we argue in two cases .",
    "if every curve in @xmath307 $ ] intersects @xmath299 , the claim follows from the bounded geodesic image theorem ( * ? ? ?",
    "* theorem 3.1 ) . otherwise , @xmath308 is close to this segment and hence it is far from curves @xmath309 and @xmath310 .",
    "let @xmath311 and @xmath312 be curves on @xmath272 that are close to @xmath309 and @xmath310 respectively . then",
    ", @xmath308 intersects every curve in @xmath313 $ ] and @xmath314 $ ] and , by the bounded geodesic image theorem , the projections of these segments to @xmath304 have bounded diameters .",
    "but @xmath272 is co - bounded .",
    "hence , @xmath315 and therefore @xmath316 .",
    "this proves the claim .      to obtain a contradiction",
    ", we will find a large sub - box of @xmath197 that maps near a standard flat @xmath265 of maximal rank .",
    "note that the map @xmath317 above is quasi - lipschitz .",
    "choose a constant @xmath318 large compared to the quasi - lipschitz constant of @xmath317 and the hyperbolicity constant of @xmath273 .",
    "let @xmath319 be points in @xmath197 in a neighborhood of @xmath320 respectively so that @xmath321 let @xmath322 be the preferred path joining @xmath323 and @xmath324 be the geodesic in @xmath273 connecting @xmath325 to @xmath326 .",
    "consider the quadrilateral @xmath327 in @xmath273 . from the assumption on @xmath318 , the edges @xmath328",
    "$ ] and @xmath329 $ ] are short compare to @xmath330 $ ] . from the hyperbolicity of @xmath273 , we conclude that @xmath324 has a subsegment @xmath331 that has a bounded hausdorff distance to @xmath332 .",
    "let @xmath333 be the associated subsegment of @xmath322 ( see previous step ) . as we argued in the previous step , the projection of @xmath333 to @xmath304 has a bounded diameter for every @xmath300 .",
    "in fact , it is close to the projection of @xmath303 to @xmath304 .",
    "the union of subsegments of type @xmath334 $ ] fill a @xmath335neighborhood of @xmath297 $ ] and @xmath336 .",
    "therefore , there is a subbox @xmath337 of size @xmath338 such that @xmath339 has bounded diameter for every @xmath300 .",
    "for @xmath340 small to be chosen later , set @xmath341 and assume @xmath279 is chosen so that @xmath342 since @xmath21 is @xmath207efficient and @xmath343 it is @xmath344efficient . by theorem 7.2 of @xcite ( which can be applied if @xmath198 is large enough ) there is a sub - box @xmath345 of size @xmath346 such that @xmath347 is within @xmath348 of a standard flat @xmath265 .",
    "the implied constants depend only on @xmath349 and @xmath88 .",
    "we show this is impossible for @xmath340 sufficiently small .",
    "note that @xmath88 is the maximum dimension of any standard flat .",
    "since @xmath350 is a box of dimension @xmath88 , and @xmath21 is a quasi - isometric embedding , the standard flat @xmath265 must have dimension @xmath88 as well .",
    "let @xmath351 be the decomposition of @xmath0 with @xmath352 , and let @xmath353 be the preferred paths where @xmath354 then @xmath347 is contained in the @xmath348neighborhood of the image of @xmath265 .",
    "we assume @xmath355 is the smallest possible interval for which this holds .",
    "then , for @xmath356 , @xmath357 has a diameter comparable to @xmath358 which is the size of @xmath350 .    since @xmath359 ,",
    "every @xmath356 is either an annulus or @xmath360 .",
    "hence , they can not equal to @xmath71 and , for at least one @xmath356 , we have @xmath300 .",
    "in fact , we can assume @xmath299 is an annulus , because @xmath351 is maximal and if a subsurface is in @xmath351 the annuli associated to its boundary curves are also in @xmath351 .    from the assumption of the minimality of lengths of @xmath355 , we know that every @xmath361 can be completed to a vector in @xmath362 where the image is in the @xmath363neighborhood of @xmath364 .",
    "in addition any point in @xmath365 is @xmath366 close to some @xmath333 .",
    "we already know that for any such @xmath299 the projection of @xmath333 to @xmath304 is @xmath367 . combining these statements",
    "we find that the projection of the image of @xmath265 to @xmath304 of any such @xmath299 has a diameter @xmath368 .",
    "this means the same bound also holds for the diameter of the projection to @xmath369 ; in the case where @xmath299 is an annulus and @xmath308 is short , the two distances are the same .",
    "we have shown @xmath370 therefore , @xmath371 . but @xmath372 for @xmath340 sufficiently small , this is a contradiction .",
    "that is , the theorem holds for appropriate values of @xmath207 and @xmath216 .",
    "recall that , for @xmath12 and a curve @xmath78 , @xmath131 is the largest number such that if @xmath373 then @xmath374 .    for a point @xmath52 in @xmath4 ,",
    "let @xmath375 be the set of curves @xmath78 such that @xmath376 .",
    "[ def : maximal_rank ] a point @xmath12 has _ maximal rank _ when @xmath377 are all either a pair of pants , a once punctured torus or a four - times punctured sphere .",
    "denote the set of points with maximal rank by @xmath378 .",
    "let @xmath379 its complement ; the set with lower rank .",
    "[ def : adjacent ] suppose @xmath380 .",
    "we say a curve @xmath381 is _ isolated _ if by increasing its length to @xmath106 while keeping all other lengths the same one leaves @xmath378 .",
    "a pair of curves in @xmath382 are called _ adjacent _ if increasing both of their lengths to @xmath106 one leaves @xmath378 .",
    "the importance of this definition is that if @xmath383 , then every isolated curve @xmath78 satisfies @xmath384 , and for any pair of adjecent curves @xmath385 , at least one of which satisfies @xmath386 .",
    "[ prop : rank - preserved ] there exists @xmath387 such that , for a point @xmath94 , if @xmath388 then @xmath389 .",
    "suppose by way of contradiction that , for large @xmath191 we have a point @xmath52 such that @xmath388 but @xmath390 .",
    "then there is a subsurface @xmath71 with @xmath260 so that the boundary curves of @xmath71 are @xmath106 short but no curve in @xmath71 is shorter than @xmath106 in @xmath75 .",
    "let @xmath391 be a path passing through @xmath75 that is @xmath181cobounded relative to @xmath71 ( see the discussion after definition  ) .",
    "let @xmath392 be a point in @xmath391 so that the distance in @xmath81 between @xmath75 and @xmath392 is @xmath393 .",
    "since @xmath391 is @xmath181 cobounded , we have from equation   @xmath394 since @xmath21 is a @xmath395quasi - isometry , solving equation   for @xmath396 we get @xmath397 in particular , @xmath398 .    note that",
    ", in addition , for @xmath399 , there is a maximal product region @xmath111 containing both @xmath52 and @xmath114 . for @xmath400",
    "implies that there is a set of curves @xmath401 , where @xmath402 for @xmath403 , and so that the complementary regions have complexity at most one .",
    "for all these curves , we have @xmath404 ; in particular they are at least @xmath106 short in @xmath114 .",
    "this means , both @xmath52 and @xmath114 are in @xmath111 .",
    "in fact , there is a box @xmath405 of size @xmath58 and a quasi - isometry @xmath406 where each @xmath407 is a geodesic and @xmath52 and @xmath114 are contained in @xmath408 ( recall that @xmath211 is the central sub - box of half the diameter ) . the map @xmath409 is a quasi - isometry because @xmath197 is equipped with the euclidean metric and @xmath410 is equipped with the sup metric up to an additive error of @xmath108 .",
    "define @xmath411 then @xmath267 is a @xmath270-quasi - isometric embedding where @xmath268 and @xmath18 depend on @xmath84 , @xmath85 and the complexity @xmath412 .",
    "( @xmath108 depends only on these constants . )",
    "let @xmath272 be the geodesic in @xmath273 that shadows the projection @xmath413 .",
    "then @xmath272 is @xmath172-cobounded with @xmath172 slightly larger than @xmath181 .",
    "define @xmath414 and let @xmath415 be the lipschitz constant of @xmath317 .",
    "let @xmath207 and @xmath216 be constants from theorem  [ thm : tunnel ] associated to @xmath268 , @xmath18 and @xmath172 and chose @xmath223 so that @xmath416{\\theta } \\ , l_\\pi$ ] is small ( see below ) .",
    "then , let @xmath217 be the constant given by theorem  [ thm : differentiable ] ( the dimension @xmath417 equals @xmath88 )",
    ". choose @xmath191 large enough so that @xmath418 applying theorem  [ thm : differentiable ] to @xmath197 , we conclude that there is scale @xmath198 and a decomposition @xmath213 of @xmath211 to boxes of size @xmath198 so that a proportion at least @xmath222 of boxes in @xmath213 are @xmath207efficient .",
    "by lemma  [ lem : path ] , there exists a path @xmath92 joining @xmath52 to @xmath114 that is covered by at most @xmath225 boxes in @xmath213 of which at most @xmath419{\\theta } \\frac{l}{r}\\right)$ ] are not @xmath279efficient .",
    "assume @xmath92 intersect boxes @xmath420 and let @xmath243 be the subinterval of @xmath92 associated to @xmath421 . by the triangle inequality ,",
    "the sum of the diameters of @xmath422 is larger than @xmath423 .",
    "however , by theorem  [ thm : tunnel ] , @xmath424 and the assumption on the number of non - efficient boxes gives @xmath425{\\theta } \\frac{l}{r } \\right ) l_\\pi \\ , r =   \\sqrt[\\xi]{\\theta } \\",
    ", l_\\pi \\ , l.\\ ] ] for @xmath207 and @xmath223 small enough , equations and contradict equation  .",
    "this finishes the proof .",
    "in this section , we prove a local version of splitting theorem proven by kleiner - leeb @xcite and eskin - farb @xcite .",
    "[ thm : factor - preserving ] for every @xmath426 there are constants @xmath216 , @xmath318 and @xmath427 such that , for all @xmath428 and @xmath219 the following holds . let @xmath429 be a ball of radius @xmath198 centered at @xmath430 in @xmath431 and let @xmath432 be a @xmath17quasi - isometric embedding whose image coarsely contains a ball of radius @xmath433 about @xmath434 .",
    "then there is a smaller ball @xmath435 , a permutation @xmath436 and @xmath17quasi isometric embeddings @xmath437 so that the restriction of @xmath267 to @xmath435 is @xmath318close to @xmath438    [ rem : distance ] when we use this theorem in  [ sec : local - factors ] , we need to equip @xmath73 with the @xmath439metric .",
    "however , it is more convenient to use the @xmath440metric for the proof .",
    "note that , if @xmath267 is a quasi - isometry with respect to one metric , it is also a quasi - isometry with respect to the other . for the rest of this section , we assume @xmath73 is equipped with the @xmath440metric . to simplify notation",
    ", we use @xmath441 to denote the distance in both in @xmath35 and in @xmath73 .    for the proof",
    ", we will use the notion of an asymptotic cone .",
    "our brief discussion is taken from @xcite .",
    "a non - principal ultrafilter is a finitely additive probability measure @xmath285 on the subsets of the natural numbers @xmath442 such that    * @xmath443 or @xmath39 for every @xmath444 * @xmath443 for every finite subset @xmath444    given a bounded sequence @xmath445 in @xmath196 , there is a unique limit point @xmath446 such that , for every neighborhood @xmath91 of @xmath447 , the set @xmath448 has full @xmath285 measure .",
    "we write @xmath449 .",
    "let @xmath450 a sequence of metric spaces with base - points .",
    "consider @xmath451 define @xmath452 by @xmath453 now @xmath454 is a pseudo - distance . define the ultralimit of the sequence @xmath450 to be the quotient metric space @xmath455 identifying the points of distance zero .",
    "let @xmath24 be a metric space and @xmath456 be a basepoint .",
    "the asymptotic cone of @xmath24 , @xmath457 , with respect to the non - principal ultrafilter @xmath285 and the sequence @xmath458 of scale factors with @xmath459 and the basepoint @xmath456 , is defined to be the ultralimit of the sequence of rescaled spaces @xmath460 .",
    "the asymptotic cone is independant of the basepoint .    in the case of @xmath35 ,",
    "the asymptotic cone @xmath461 is a metric tree which branches at every point and the asymptotic cone @xmath462 of the product of hyperbolic planes is @xmath463 , the product of the asymptotic cones .",
    "a flat in @xmath464 is a product @xmath465 where @xmath466 is a geodesic in the @xmath467 factor .",
    "we first prove a version of theorem  [ thm : factor - preserving ] with small linear error term .",
    "we then show that , by taking an even smaller ball , the error term can be made to be uniform additive .",
    "[ prop : linear - factoring ] given @xmath468 there exists @xmath469 and @xmath470 such that for all sufficiently small @xmath471 , there exists @xmath216 such that if @xmath472 and @xmath267 is a @xmath270quasi - isometric embedding defined on @xmath429 , such that @xmath473 @xmath18coarsely contains @xmath474 then    * there is a permutation @xmath475 and , for @xmath476 , there is a quasi - isometric embedding @xmath477 so that , for @xmath478 and for @xmath479 , we have @xmath480 * for any @xmath479 and any flat @xmath481 through @xmath482 , there is a flat @xmath483 such that for @xmath484 @xmath485    we begin with a claim .",
    "assume , for given @xmath207 and @xmath470 , that there is a permutation @xmath475 and a constant @xmath486 so that , if @xmath487 differ only in the @xmath467 factor , then @xmath488 and @xmath489 differ in all factors besides the @xmath490 factor by at most @xmath491 .",
    "then the first conclusion holds .    for @xmath492 and an index @xmath199",
    "define @xmath493 to be a point whose @xmath467 coordinate is @xmath52 and whose other coordinates are the same as the coordinates of @xmath430 .",
    "we then define the map @xmath494 by letting @xmath495 to be the @xmath490 coordinate of @xmath496 .",
    "we show that @xmath494 is a quasi - isometric embedding . for @xmath497 @xmath498 in addition since @xmath493 and @xmath499 differ in only one factor , for @xmath500 , @xmath501    hence , @xmath494 is a @xmath502quasi - isometry .",
    "equation   follows from applying the triangle inequality @xmath263times .",
    "now , suppose the first conclusion is false .",
    "then there exists @xmath503 , sequences @xmath504 , and a sequence @xmath505 of @xmath270quasi - isometric embeddings defined on the balls @xmath506 , with @xmath507 , so that the restriction of @xmath505 to @xmath508 does not factor as above .",
    "then , by the above claim , there exists points @xmath509 which differ in one factor only , and such that @xmath510 and @xmath511 differ in at least two factors by an amount that is at least @xmath512 in each .",
    "we can assume @xmath513 for otherwise @xmath514 is bounded .",
    "let @xmath515 and scale the metric on @xmath506 with base - point @xmath516 by @xmath458 . since @xmath517 , we have @xmath518 .",
    "that is , the radius of @xmath506 in the scaled metric still goes to @xmath519 .",
    "however in the scaled metric , the distance between @xmath520 and @xmath521 equals @xmath39 .",
    "let @xmath522 be the the asymptotic cone of @xmath464 with base point @xmath516 and metric @xmath523 .",
    "for any @xmath524 , we define @xmath525 by @xmath526 note that , since by definition @xmath527 is a bounded , for @xmath417 large enough , @xmath528 and @xmath529 is defined .",
    "it is clear that @xmath530 is bi - lipschitz .",
    "we show @xmath531 is onto .    by assumption @xmath532",
    "@xmath18coarsely contains @xmath533 .",
    "consider a point @xmath534 since @xmath535 is bounded , for @xmath417 large enough , @xmath536 .",
    "this means there is @xmath528 so that @xmath537 but @xmath538",
    ". thus @xmath539 and so @xmath531 is onto and hence a homeomorphism .    by the argument in step 3 of section 9 in @xcite the map @xmath531 factors .",
    "the @xmath285-limit points of @xmath540 give a pair of points @xmath541 and @xmath542 in @xmath522 that have the same coordinate in every factor but one and @xmath543 but @xmath544 and @xmath545 differ in at least two coordinates by at least @xmath546 .",
    "this contradicts the assumption that @xmath531 factors .",
    "we now use the first conclusion to prove the second conclusion .",
    "let @xmath547 .",
    "consider a flat @xmath481 through @xmath482 and let @xmath548 $ ] be a geodesic in the @xmath467 factor so that @xmath549\\ ] ] let @xmath550 be the geodesic joining @xmath551 to @xmath552 . since @xmath494 is a quasi - isometric embedding , @xmath553 where the bound depends on @xmath349 .",
    "let @xmath483 be the flat determined by the @xmath550 .",
    "for a point @xmath554 , the @xmath467 coordinate of @xmath555 lies on @xmath466 .",
    "therefore , the @xmath467 coordinate of @xmath556 is distance at most @xmath557 from a point whose @xmath467 coordinate lies on @xmath558 and that in turn is distance @xmath367 from @xmath550 .",
    "since this is true for each @xmath199 , the triangle inequality implies that @xmath559    [ lemma : trivial : flats ] fix a constant @xmath560 .",
    "there exists @xmath561 , such that for all sufficiently small @xmath279 and large @xmath201 the following holds .",
    "suppose @xmath265 , @xmath562 are flats , @xmath563 and @xmath564 then for @xmath565 , @xmath566    we can assume @xmath567 is larger than the hyperbolicity constant for @xmath35 . consider any geodesic @xmath568 whose projection to each factor @xmath35 intersects the disc of radius @xmath569 centered at the projection of @xmath555 to that factor . extend the geodesic so that its endpoints lie further than @xmath567 from the disc .",
    "choose a pair of points in @xmath562 within @xmath567 of the endpoints of @xmath92 and let @xmath570 be the geodesic in @xmath562 joining these points .",
    "then @xmath570 lies within hausdorff distance @xmath567 of @xmath92 .",
    "form the quadrilateral with two additional segments joining the endpoints of @xmath92 and @xmath570 .",
    "since the endpoints are within @xmath567 of each other , the segments joining the endpoints do not enter the disc of radius @xmath571 .",
    "the quadrilateral is @xmath572 thin , where @xmath573 is the hyperbolicity constant for @xmath35 .",
    "therefore @xmath92 and @xmath570 are within hausdorff distance @xmath574 of each other on the disc of radius @xmath571 .    by the second conclusion of proposition  [ prop : linear - factoring ]",
    "there exists @xmath575 so that for all small @xmath207 and large @xmath198 , for any @xmath479 and any flat @xmath265 through @xmath482 , there is a flat @xmath576 such that for @xmath577 @xmath578 now clearly for all @xmath482 , @xmath579 . by lemma  [ lemma :",
    "trivial : flats ] there is @xmath580 and @xmath581 , such that for @xmath279 sufficiently small and @xmath198 large , and any pair of points @xmath582 the flats @xmath583 corresponding to @xmath555 and @xmath482 satisfying the above inequality , are within @xmath584 of each other .",
    "that is , given @xmath265 there is a single flat @xmath562 so that for all @xmath585 , @xmath586    consider any geodesic @xmath466 in the @xmath467 factor of @xmath587 that intersects @xmath588 and fix the other coordinates so that we have a geodesic in @xmath464 that intersects @xmath589 . again",
    "denote it by @xmath466 .",
    "choose a pair of flats @xmath590 that intersect exactly along @xmath466 .",
    "then as we have seen there are flats @xmath591 such that for @xmath592 , @xmath593 and thus for both @xmath592 , @xmath594 since @xmath267 is a quasi - isometric embedding the pair of flats @xmath591 must come @xmath595 close along a single geodesic of length comparable to @xmath198 in one factor in each .",
    "thus we can assume that @xmath267 factors along @xmath466 and sends its intersection with @xmath596 to within @xmath595 of a geodesic @xmath597 in a factor @xmath598 .",
    "now let @xmath599 and set @xmath600 . now consider _ any _ geodesic @xmath180 in the @xmath467 factor that intersects the smaller ball @xmath601 .",
    "we have that @xmath267 factors in the bigger ball @xmath596 along @xmath602 .",
    "we claim that it also sends it also to the same @xmath603 factor .",
    "suppose not , and it sends it to the @xmath604 factor .",
    "choose a geodesic @xmath605 that comes close to both @xmath466 and @xmath180 possibly in the bigger ball @xmath596 .",
    "its image must change from the @xmath603 to the @xmath606 factor , which is impossible since the image of @xmath607 lies in a single factor up to bounded error .",
    "thus the map is factor preserving .",
    "in this section we apply theorem  [ thm : factor - preserving ] to balls in teichmller  space .    for a given @xmath608 and @xmath94 ,",
    "define the @xmath198decomposition at @xmath52 to be the decomposition @xmath102 that contains a curve @xmath78 if and only if @xmath609 .",
    "that is , elements of @xmath102 are either such curves or their complementary components . by convention ,",
    "if @xmath610 and @xmath47 has a component @xmath91 with @xmath97 then @xmath91 ( not any annulus in @xmath91 ) is always included in any @xmath198decomposition of @xmath47 .",
    "this is because @xmath98 is already a copy of @xmath35 .",
    "an @xmath198-decomposition is maximal if there are no complimentary components @xmath71 with @xmath611 .",
    "we always assume @xmath612 is a @xmath613quasi - isometry but , unless specified , it is not always assumed that @xmath21 is anchored .",
    "[ prop : local - factors ] for @xmath84 and @xmath85 as before , there are constants @xmath614 , @xmath615 and @xmath616 so that the following holds . for @xmath617 let @xmath198 be such that @xmath618 let @xmath102 be the @xmath198decomposition at @xmath52 , let @xmath351 be the @xmath619decomposition at @xmath75 and let @xmath620 .",
    "we have    1 .",
    "the decompositions @xmath102 and @xmath351 are maximal . for @xmath621 , we have @xmath622 and @xmath623 .",
    "2 .   there is a bijection @xmath624 and , for every @xmath103 and @xmath625 , there is a @xmath626quasi - isometry @xmath627 so that , for all @xmath621 , @xmath628    condition ( 2 ) above states that the map @xmath21 restricted to @xmath629 is close to the product map @xmath630 .",
    "note also that , since @xmath102 depend on @xmath198 , @xmath74 also depends on @xmath198 .",
    "let @xmath401 be the set of curves @xmath78 with @xmath631 .",
    "since @xmath632 any complementary component @xmath91 of @xmath401 must satisfy @xmath633 . otherwise there would be a pair of adjacent curves @xmath634 with @xmath635 , which means that @xmath636 .",
    "we conclude that @xmath102 is a maximal decomposition .",
    "let @xmath637 . for @xmath638 , we have @xmath639 this",
    ", if @xmath640 is large enough , implies that the curves @xmath641 are @xmath106short in @xmath76 and so @xmath622 .",
    "let @xmath642 be a point such that @xmath643 by proposition  [ prop : rank - preserved ] , @xmath644 using first the triangle inequality and then the fact that @xmath645 is a @xmath395quasi - isometry , we get @xmath646 by picking @xmath640 large enough in terms of @xmath647 , we have @xmath648 this means , as argued above , that if @xmath649 is the collection of curves @xmath123 with @xmath650 , then any complementary components @xmath299 satisfies @xmath651 . hence @xmath351 is a maximal decomposition .",
    "again , since @xmath21 is a @xmath395quasi - isometry , for all @xmath652 , we have @xmath653 the last inequality holds for @xmath640 large enough .",
    "thus , for @xmath654 and @xmath655 , @xmath656 again , for @xmath640 large enough , this means @xmath123 is @xmath106short and thus @xmath657 .    we have shown that @xmath638 implies @xmath658 and @xmath659 . by the minsky product region theorem ( theorem  [ thm : product - regions ] ) the maps @xmath660 and @xmath661",
    "are distance @xmath108 from an isometry .",
    "define @xmath662 by @xmath663 then , if we set @xmath664 , the map @xmath267 is a @xmath665quasi - isometry .    because the map @xmath21 has an inverse , @xmath666 contains a ball of comparable radius about @xmath488 . now theorem",
    "[ thm : factor - preserving ] applied for @xmath667 and @xmath668 says that , there are constants @xmath216 , @xmath427 , @xmath318 and a bijection @xmath669 so that , for @xmath670 the following holds .",
    "assume @xmath671 . then , for each @xmath672 and @xmath673",
    ", there is a @xmath665quasi - isometry @xmath674 such that for @xmath621 , @xmath675 the distance in @xmath676 is the sup metric , each factor of which is either a copy of @xmath35 or a horosphere @xmath677 .",
    "hence , the inequality holds for every factor .",
    "@xmath678 therefore , for @xmath679 , @xmath680 and @xmath640 large enough , the proposition holds .",
    "[ prop : analytic - continuation ] choose @xmath198 so that @xmath681 let @xmath682 be points so that @xmath683 assume every point @xmath684 has the same @xmath198decomposition @xmath102 and the @xmath619decomposition at @xmath75 always contains some subsurface @xmath299 .",
    "then , there is @xmath103 so that @xmath685 and , for every @xmath686 @xmath687    since @xmath688 is a bijection there must be some @xmath91 that is mapped to @xmath299 .",
    "the content of the first conclusion is that the same @xmath91 works at both points .    by assumption , for @xmath689 , the domain of @xmath74 is @xmath102 .",
    "we start by proving the following claim . for @xmath690 and @xmath103 , suppose @xmath691 .",
    "also , assume either @xmath692 or @xmath693 that is , @xmath694 and @xmath695 either differ by @xmath696 in only one factor , or all but one factor .",
    "then @xmath697 .",
    "we prove the claim .",
    "assume the first case holds .",
    "since @xmath698 is a @xmath626quasi - isometry ( proposition  [ prop : local - factors ] ) we have @xmath699 by proposition  [ prop : local - factors ] and the triangle inequality applied twice , we get @xmath700    now suppose @xmath701 for @xmath702 .",
    "since @xmath703 , proposition  [ prop : local - factors ] and the triangle inequality then implies @xmath704 these two inequalities contradict the choice of @xmath198 in the statement of the proposition , proving the the claim .",
    "the proof of the claim when the second assumption holds is similar .",
    "we now prove the proposition . in each @xmath705",
    "choose @xmath706 so that @xmath707 let @xmath694 , @xmath708 and @xmath695 be points in @xmath709 so that , for @xmath710 @xmath711 and @xmath712 note that the claim can be applies to pairs @xmath713 , @xmath714 , @xmath715 and @xmath716 concluding that @xmath717    now , consider @xmath686 and let @xmath718 be so that @xmath719 .",
    "we know @xmath720 therefore , @xmath721 this finishes the proof of the proposition .",
    "[ cor : xi=1 ] if @xmath610 and @xmath91 is a component of @xmath47 with @xmath147 , then for every @xmath722 where @xmath74 is defined , @xmath723 .",
    "note that , by definition , the subsurface @xmath91 is always included in any @xmath198decomposition @xmath102 of @xmath47 .",
    "hence , proposition  [ prop : analytic - continuation ] applies .",
    "that is , for a large @xmath198 as in proposition  [ prop : analytic - continuation ] , if @xmath723 then the same hold for points in an @xmath571neighborhood of @xmath52 .",
    "but the set of points where @xmath74 is defined is connected .",
    "hence , it is enough to show @xmath723 for just one points @xmath52 .",
    "let @xmath724 be the projection of boundary of @xmath62 to @xmath98 .",
    "consider a geodesic @xmath266 in @xmath98 connecting @xmath228 to @xmath255 so that @xmath725 @xmath726 for example , we can choose a geodesic connecting two @xmath58horoballs in @xmath98 that otherwise stays in the thick part of @xmath98 and then we can cut off a subsegment of length @xmath198 from each end",
    ".    let @xmath727 .",
    "choose @xmath728 to have distance @xmath198 from @xmath729 and let @xmath180 be a path in @xmath80 that has constant projection to @xmath71 and projects to @xmath266 in @xmath91 .",
    "that is , @xmath730 then @xmath180 connects a point @xmath722 to a point @xmath731 where @xmath732 , @xmath733 and @xmath734 .",
    "let , @xmath735 , @xmath736 and let @xmath157 and @xmath737 be points on @xmath62 that are distance @xmath198 to @xmath52 and @xmath76 respectively . since @xmath21 is anchored , we have @xmath738 and hence @xmath739 and the same holds for @xmath740 .",
    "also @xmath741 therefore , @xmath742    now , choose points @xmath743 along @xmath180 so that @xmath744 and @xmath745 . as mentioned before , we already know @xmath746 . if @xmath747 , then @xmath748 and hence , by proposition  [ prop : local - factors ] , @xmath749 therefore , @xmath750 for @xmath198 large enough , this contradicts equation  .",
    "hence , @xmath751 .",
    "the goal of this section is to prove proposition  [ prop : short - curve ] .",
    "essentially , this states that if @xmath78 is one of the shortest curves in @xmath52 , then @xmath78 is also short in @xmath75 and , furthermore , @xmath79 .    throughout this section we always assume , if @xmath610 , that @xmath47 does not have any components @xmath91 with @xmath752 .",
    "hence , proposition  [ prop : short - curve ] is the complementary statement to corollary  [ cor : xi=1 ] .",
    "the effect of this assumption is that every curve has an adjacent curve .",
    "the arguments are conceptually very elementary .",
    "however , we need to keep careful track of constants .      for @xmath753 ,",
    "define the @xmath754maximal cone @xmath755 to be the set of points @xmath94 so that    * @xmath382 is a pants decomposition . * for @xmath756 , @xmath757",
    "let @xmath758 . for point @xmath157 to be in @xmath379",
    ", @xmath157 has to contain two adjacent curves that have lengths larger than @xmath106 .",
    "hence , for @xmath759 , we have @xmath760    [ prop : max - preserved ] for every @xmath761 , there is a @xmath762 so that if @xmath763 and @xmath764 then @xmath765 in fact , for every @xmath53 , we have @xmath766    choose @xmath767 large enough so that if @xmath768 then , similar to equation  , we have @xmath769 and so that @xmath770 let @xmath771 .      for adjacent curves",
    "@xmath772 we have @xmath773    [ proof of claim ]    we will later prove that in fact @xmath774 , finishing the proof of the proposition .",
    "we prove the claim by contradiction .",
    "assume that the first inequality in the claim holds and the second is false .",
    "note that we still have , by equations and , that @xmath775 to summarize , we have two adjacent curves @xmath123 and @xmath776 with @xmath777    consider a geodesic @xmath180 moving only in the @xmath776 factor that increases the length of @xmath776 and connects @xmath75 to a point @xmath778 with @xmath779 we have @xmath780 take a sequence of points @xmath781 along @xmath180 with @xmath782 and @xmath783 let @xmath784 , let @xmath785 , let @xmath786 be the @xmath198decomposition at @xmath787 and @xmath788 be the @xmath619decomposition at @xmath789 . by assumption , @xmath790 and hence @xmath791 for every @xmath199 and ,",
    "since the length of no other curve is changing along @xmath180 , all @xmath786 are in fact the same decomposition ( which we denote by @xmath351 ) . also @xmath792",
    "let @xmath793 ,    let @xmath137 with @xmath794 .",
    "let @xmath356 be the component so that @xmath795 , we show by induction on @xmath199 , that @xmath796 and @xmath797 .",
    "assume this for @xmath798 .",
    "since @xmath799 , and @xmath787 and @xmath800 have the same projection to @xmath369 , proposition  [ prop : local - factors ] implies @xmath801 therefore , @xmath802 the last inequality is from the assumption on @xmath571 .",
    "hence , @xmath803 this means in particular that @xmath78 is short enough ( @xmath804 ) and is included in @xmath805 .",
    "moreover by proposition  [ prop : analytic - continuation ] , @xmath806 , completing the induction step . continuing this way ,",
    "we conclude that , for every @xmath130 , @xmath807 , we have @xmath808 in particular , for every pair of adjacent curves in @xmath76 , one satisfies the above inequality . but @xmath809 this is a contradiction , which prove the claim .",
    "we now show that , all curves @xmath810 must in fact satisfy @xmath811 the argument is similar to the one above , so we skip some of the details .",
    "suppose this is false for some curve @xmath123 .",
    "let @xmath78 be a curve so that @xmath812 and @xmath813 be a curve adjacent to @xmath78 .",
    "let @xmath180 be a geodesic that moves only in the @xmath78 and @xmath813 factors , increasing their lengths , that connects @xmath52 to a point @xmath76 where @xmath814 we cover @xmath180 with points @xmath815 so that @xmath816 and @xmath817 .",
    "let @xmath788 be the @xmath198decompositions at @xmath789 and @xmath786 be the @xmath619decomposition at @xmath818 . then , as before , @xmath78 and @xmath813 are in every @xmath788 ( in fact , all @xmath788 are the same decompositions which we denote by @xmath102 ) .",
    "let @xmath819 . by an argument as above , the total movement in any other factor",
    "( besides @xmath123 and @xmath820 ) is at most @xmath821 .    since @xmath822",
    ", we have @xmath823 .",
    "that is , there are two adjacent curves @xmath92 and @xmath570 with @xmath824 but we have @xmath825 for @xmath198 large enough . hence , neither @xmath92 or @xmath570 equals @xmath123 . and",
    "one , say @xmath570 is not contained in @xmath820 .",
    "therefore , @xmath826 now , since @xmath92 is adjacent to @xmath570 , the claim implies , @xmath827 .",
    "however , again as above , @xmath828 this contradicts equation  .",
    "we are done .",
    "let @xmath829 be the complex of pants decompositions of @xmath0 .",
    "for a pants decomposition @xmath830 , define @xmath831 to be the set of points @xmath832 where @xmath833 .",
    "note that @xmath834 is not connected and its connected components are parametrized by @xmath829 : @xmath835 the same is true for @xmath836 and , by proposition  [ prop : max - preserved ] , @xmath837 hence , we can define a bijection @xmath838 so that @xmath839 we will show that @xmath840 is induced by a simplicial automorphism @xmath841 of the curve complex .",
    "note that the definition of @xmath840 depends on the choice of @xmath761 .",
    "[ prop : ivanov ] assuming @xmath761 large enough , there is a simplicial automorphism @xmath842 apriori depending on @xmath761 so that , for a pants decomposition @xmath843 we have @xmath844    choose @xmath761 and @xmath845 so that @xmath846 let @xmath401 be a multi - curve containing @xmath847 curves and let @xmath848 be two extensions of @xmath401 to pants decompositions with @xmath849 .",
    "let @xmath52 be a point in @xmath831 so that @xmath850 and @xmath851 for @xmath403 .",
    "similarly , define @xmath852 so that @xmath853 let @xmath102 be the decomposition consisting of @xmath401 and the complementary subsurface @xmath91 .",
    "then @xmath854 . let @xmath180 be a path connecting @xmath52 to @xmath76 whose projection is constant in every @xmath855 for @xmath403 , is a geodesic connecting @xmath101 to @xmath856 in @xmath98 and has a length @xmath857 .",
    "we have @xmath858 hence proposition  [ prop : local - factors ] and proposition  [ prop : analytic - continuation ] apply to @xmath52 and @xmath76 .",
    "this means @xmath75 and @xmath778 are contained in the same product region , say @xmath859 .",
    "let @xmath860 .",
    "then , for @xmath861 , @xmath862 , @xmath863 but @xmath864 hence , @xmath351 contains a multi curve @xmath865 with @xmath866 curves and @xmath867 and @xmath868 share all but one curve .",
    "that is , there are curve @xmath573 and @xmath869 so that @xmath870 however , for the moment , we do not have a good bound on the intersection number @xmath871 .",
    "we first show that the multi curve @xmath865 does not depend on the choice of @xmath776 .",
    "assume @xmath872 is another curve with @xmath873 , and let @xmath874 .",
    "if @xmath875 then @xmath867 , @xmath868 and @xmath876 share @xmath866 curves . hence these have to be the same multicuve @xmath865 .",
    "if @xmath877 is large , then we can find a sequence @xmath878 of curves that are disjoint from @xmath865 , @xmath879 and @xmath880 .",
    "define @xmath881 . then arguing as above shows that all @xmath882 share the same @xmath866 curves .",
    "that is , the same curve changes from @xmath867 to @xmath876 as it did from @xmath867 to @xmath868 and @xmath883 .    note that we have shown that there is an association between curves in @xmath116 and @xmath867 ; a curve @xmath884 is associated to the curve @xmath885 that is not contained in any @xmath868 constructed as above .",
    "we will show @xmath886 is the same for every @xmath116 .",
    "let @xmath401 be a multi - curve with @xmath887 curves and let @xmath888 be a pants decomposition .",
    "let @xmath889 with @xmath890 for @xmath710 .",
    "denote @xmath891 let @xmath865 be a multi - curve with @xmath892 curves so that @xmath893 . from the discussion above , we know that , there are curves @xmath894 so that .",
    "@xmath895 since @xmath896 and @xmath897 are disjoint , the curves @xmath898 and @xmath899 must be different . also @xmath900 shares @xmath866 curves with both @xmath901 and @xmath902 .",
    "but the map @xmath903 is a bijection and @xmath904 .",
    "moreover since @xmath905 and @xmath906 and @xmath907 are disjoint @xmath900 can not contain both @xmath896 and @xmath898 and similarly it can not contain both @xmath897 and @xmath899",
    ". therefore , @xmath908 that means , @xmath909 because it is the curve that changes from @xmath902 to @xmath910 .",
    "similarly , @xmath911 .",
    "w have shown the association @xmath912 is the same for adjacent pants decompositions in @xmath829 .",
    "hence , it does not depend on @xmath116 and we can define @xmath913 for any pants decomposition @xmath116 containing @xmath123 .",
    "every multi - curve is contained in a pants decomposition .",
    "hence @xmath841 sends disjoint curves to disjoint curves and in fact sends simplifies in @xmath38 to simplices . since @xmath903 is onto , @xmath841 is also onto .",
    "we show @xmath841 is one - to - one .",
    "assume for contradiction that @xmath914 and let @xmath915 and @xmath916 be pants decompositions that contain @xmath78 and @xmath123 respectively but have no curves in common . then @xmath917 and @xmath918 share a curve @xmath573 .",
    "let @xmath919 be a sequence of adjacent pants decomposition all containing @xmath573 and let @xmath920 .",
    "then @xmath921 is contained in every @xmath922 .",
    "this contradicts the assumption that @xmath915 and @xmath916 have no common curves .",
    "we have shown @xmath841 is simplicial and it is a bijection , that is , it is a simplicial automorphism of @xmath38 .",
    "[ rem : identity ] in the case @xmath923 , by a theorem of ivanov @xcite , @xmath841 is induced by an isometry @xmath924 of teichmller  space @xmath4 .",
    "hence , after applying the inverse of this isometry to @xmath21 , we can assume that @xmath841 is the identity map .",
    "in the case @xmath610 and @xmath21 is anchored , we know that @xmath903 is the identity map .",
    "thus , so is @xmath841 .",
    "indeed , for the remainder of the paper , we assume that in these cases @xmath841 is the identity .",
    "we point out that @xmath841 and @xmath925 are different maps .",
    "we now show that on each @xmath761 cone the latter map is the identity as well .",
    "[ cor : f - star ] assume either @xmath926 or @xmath927 is anchored .",
    "let @xmath928 be a point with @xmath929 then for @xmath930 , we have @xmath79 .",
    "let @xmath931 .",
    "then the @xmath198decomposition at @xmath52 is @xmath51 and @xmath619decomposition of @xmath75 is also @xmath51 .",
    "this is because , by remark  [ rem : identity ] and proposition  [ prop : max - preserved ] we have , for @xmath130 @xmath932 hence @xmath933 is some curve in @xmath51 .",
    "take @xmath934 , @xmath935 , let @xmath570 be a curve interesting @xmath92 once or twice that is disjoint from other curves in @xmath116 and let @xmath936 let @xmath852 be a point so that @xmath937 let @xmath180 be a path connecting @xmath52 to @xmath76 that is constant in all other factors . as argued before ,",
    "since @xmath78 remains short along @xmath180 , the length of @xmath933 changes by at most @xmath821 where @xmath938 .",
    "this is less than the change in the length of @xmath92 .",
    "hence @xmath939 .",
    "since we can do this argument for every curve @xmath935 , we conclude @xmath79 .",
    "[ prop : thick ] assume @xmath903 is the identity . then , there is constant @xmath940 so that , if @xmath52 is @xmath106thick , then @xmath941    let @xmath942 be the bers constant which has the property that the set of curves of length at most @xmath943 fill @xmath52 . to find an upper - bound for @xmath944 it is enough to show that , for each @xmath78 with @xmath945 , @xmath78 has bounded length in @xmath75 .",
    "( this follows , for example , from ( * ? ? ? * theorem b ) and the fact that extremal length and hyperbolic lengths are comparable in a thick surface @xmath52 . )",
    "let @xmath761 be as in proposition  [ prop : ivanov ] and @xmath762 be as in proposition  [ prop : max - preserved ] .",
    "for @xmath78 as above , let @xmath116 be a pants decomposition containing @xmath78 and @xmath946 be such that @xmath947 and @xmath948 . then , by proposition  [ prop : max - preserved ] , @xmath949 now we have @xmath950 hence @xmath951 that is , the length of all such @xmath78 in @xmath75 is uniformly bounded and hence @xmath952 is uniformly bounded as well .",
    "[ def : admissible - scale ] fix once and for all @xmath953 suppose we have a set @xmath954 of positive numbers .",
    "@xmath754 is an admissible scale for this set",
    "_ if there is a decomposition @xmath955 of this set so that , if @xmath956 for @xmath957 then @xmath958 , and if they are in different subsets then @xmath959 . we refer to @xmath955 as the _ the partition associated to @xmath754_. we call the set @xmath957 containing the largest elements as the _ top group_.    [ lem : group ] given @xmath960 , there are scales @xmath961 such that for any set @xmath954 of positive numbers , some @xmath962 is an admissible scale for this set .",
    "in fact , we can define @xmath962 recursively as @xmath963    for @xmath964 , let @xmath965 be the partition of @xmath954 containing the fewest number of subsets so that , for @xmath966 and @xmath967 , we have @xmath968 . if we also have @xmath969 for @xmath970 is different sets then @xmath962 is an admissible scale and we are done .",
    "otherwise , for every @xmath199 , there are two sets @xmath971 , @xmath972 and @xmath973 so that @xmath974 .",
    "then , for any @xmath975 and @xmath976 we have @xmath977 which means , @xmath978 and @xmath979 fit in one group in @xmath980 and @xmath981 if this holds for all @xmath199 , then some @xmath982 has size one and @xmath983 would be an admissible scale .      [ prop : short - curve ] assume either @xmath926 of @xmath927 is anchored .",
    "for @xmath984 large enough , the following holds .",
    "let @xmath94 be a point such that , for @xmath130 , @xmath985 and let @xmath754 be an admissible scale for the set @xmath986 with the associated partition @xmath955 .",
    "let @xmath978 be the top group in @xmath955 and let @xmath401 be the set of curves @xmath78 where @xmath987 .",
    "then , for every @xmath403 , we have @xmath988 and @xmath79 .    for @xmath984 large enough , @xmath989",
    "hence , we have the upper - bound .",
    "we also require that @xmath990 where @xmath991 is from lemma  [ lem : group ] .",
    "let @xmath992 and let @xmath993 .",
    "let @xmath649 be the set of curves @xmath123 with @xmath994 .",
    "we have @xmath995    the proof is essentially the same at the proof of proposition  [ prop : max - preserved ] .",
    "choose a path @xmath180 that changes the length of curves in @xmath401 only connecting @xmath52 to a point @xmath76 so that , for @xmath403 , @xmath996 and @xmath997 . since all other curves in @xmath52 are already shorter that @xmath998 , we have @xmath999 we can cover @xmath180 with points @xmath1000 so that @xmath1001 and @xmath1002 .",
    "let @xmath1003 and @xmath1004 . then , as in the proof of proposition  [ prop : max - preserved ] , only the length of @xmath1005 curves can changes substantial from @xmath114 to @xmath1006 .",
    "more precisely , if @xmath649 has more than @xmath1005 curves , then there is @xmath652 so that @xmath1007 also , @xmath1008 .",
    "hence , @xmath1009 this is a contradiction to the assumption @xmath652 .",
    "this proves the claim .",
    "we now show that , in fact , @xmath1010 .",
    "assume there is a curve @xmath1011 .",
    "let @xmath1012 be a point so that @xmath1013 and @xmath1014 let @xmath116 be a pants decomposition containing @xmath649 so that @xmath1015 let @xmath1016 be a point obtained from @xmath1012 by pinching curves @xmath1017 until @xmath1018 .",
    "then @xmath1019    by proposition  [ prop : max - preserved ] , all curves in @xmath116 are still short in @xmath1020 .",
    "this means , @xmath78 is not short , and hence @xmath1021 but we also have @xmath1022 this is a contradiction which proves @xmath1023 .",
    "this and the claim imply @xmath1010 .",
    "we now show @xmath79 for @xmath403 .",
    "this essentially follows from corollary  [ cor : f - star ] .",
    "let @xmath180 be a path connecting @xmath52 to a point @xmath1024 that is constant in the @xmath78 coordinate ( that is , changes the length of all curves until they are comparable to @xmath78 ) .",
    "note that @xmath1025 is large enough that corollary  [ cor : f - star ] applies .",
    "but , by corollary  [ cor : f - star ] @xmath1026 . and",
    "as , we have argued in the proof of claim in proposition  [ prop : max - preserved ] , as we move along @xmath180 from @xmath76 to @xmath52 , @xmath78 remains short both in @xmath1027 and @xmath1028 .",
    "hence , proposition  [ prop : analytic - continuation ] applies to all points along this path and @xmath79 as well .",
    "we are done .",
    "we start by proving the base case of induction ( theorem  [ thm : induction ] ) .",
    "note that when @xmath1029 , the surface @xmath47 is connected and is either a punctured torus or a four - times punctured sphere and @xmath1030 .                  at ( 29 : .94 )",
    "[ circle through=(29 : 1 ) ] ; at ( 61 : .94 ) [ circle through=(61 : 1 ) ] ; at ( 119 : .94 ) [ circle through=(119 : 1 ) ] ; at ( 151 : .94 ) [ circle through=(151 : 1 ) ] ; at ( -29 : .94 ) [ circle through=(-29 : 1 ) ] ; at ( -61 : .94 ) [ circle through=(-61 : 1 ) ] ; at ( -119 : .94 ) [ circle through=(-119 : 1 ) ] ; at ( -151 : .94 ) [ circle through=(-151 : 1 ) ] ;    at ( 70 : .975 ) [ circle through=(70 : 1 ) ] ; at ( 20 : .975 ) [ circle through=(20 : 1 ) ] ; at ( 110 : .975 ) [ circle through=(110 : 1 ) ] ; at ( 160 : .975 ) [ circle through=(160 : 1 ) ] ; at ( -70 : .975 ) [ circle through=(-70 : 1 ) ] ; at ( -20 : .975 ) [ circle through=(-20 : 1 ) ] ; at ( -110 : .975 ) [ circle through=(-110 : 1 ) ] ; at ( -160 : .975 ) [ circle through=(-160 : 1 ) ] ;          let @xmath1035 be given . consider a point @xmath1036 . for @xmath710 , let @xmath1037 \\to { { \\mathcal t}}(\\sigma , l)$ ] be a geodesic so that @xmath1038 and @xmath1039 and @xmath1040 lie on distinct @xmath58horocycles and so that @xmath1034 and @xmath1033 have a definite angle between them ( see fig .  [",
    "fig : base - case ] ) . define @xmath1041 .",
    "then @xmath1042 is a @xmath1043quasi - geodesic . since @xmath61 is anchored , the endpoints of @xmath1042 are uniformly bounded distance from the endpoints of @xmath466 .",
    "this implies @xmath1042 is contained in a uniform bounded neighborhood of @xmath466 .",
    "this means , @xmath1044 is contained in a uniform bounded neighborhood of both @xmath1034 and @xmath1033 .",
    "but , since @xmath1034 and @xmath1033 have a definite size angle between them , the diameter of this set of uniformly bounded .",
    "hence @xmath1045 is uniformly bounded .",
    "[ prop : torus - identity ] assume @xmath47 has a component @xmath71 with @xmath1046 .",
    "let @xmath1047 be a @xmath69quasi - isometry that is anchored .",
    "pick a large @xmath198 so that the statements in  [ sec : local - factors ] apply . then",
    ", there is a constant @xmath1048 so that the following holds .",
    "let @xmath1049 be a point so that @xmath1050 then @xmath1051          to see the upper - bound , we note that , for times @xmath1058 and @xmath205 , @xmath1059 we now check the lower bound . pick a sequence of points in @xmath80 @xmath1060 so that @xmath1061 and @xmath1062 . since @xmath71 is always a factor in any decomposition , we know from proposition  [ prop : local - factors ] that @xmath1063 therefore , ( assuming @xmath1064 ) @xmath1065 now the desired lower bound in the claim follows : @xmath1066    next , we show that , if the end points of @xmath180 are close to @xmath729 then the end points of @xmath1057 are close to the end points of @xmath180 which would imply exactly as in the proof of proposition  [ prop : base - case ] that @xmath1057 stays near @xmath180 . that is , the reader should think of @xmath1012 below as an end point of @xmath180 .",
    "we choose a sequence of points in @xmath1070 @xmath1071 where @xmath1072 also @xmath1073 let @xmath1074 .",
    "note that , @xmath1075 is the point of interest . by proposition",
    "[ prop : local - factors ] , we have @xmath1076 hence , @xmath1077 but @xmath1078 is distance @xmath198 from some point @xmath1079 .",
    "hence @xmath1080 the claim follows from the last two inequalities by the triangle inequality .",
    "we now prove the proposition . for @xmath710 , consider the geodesic segment @xmath1081 \\to { { \\mathcal t}}(w)$ ] where , @xmath1082 , @xmath1039 and @xmath1040 are distance @xmath198 from @xmath729 and so that @xmath1034 and @xmath1033 make a definite size angle at @xmath706 . by claim 1 , the paths @xmath1042",
    "are quasi - geodesics and claim 2 , provides a bound for the distance between @xmath1039 and @xmath1083 and also between @xmath1040 and @xmath1084 .",
    "we can make @xmath1034 and @xmath1033 to be as long as needed .",
    "if the lengths of @xmath466 are long enough compared with the right hand side of equation  , this implies that @xmath1042 stays in a uniform neighborhood of @xmath466 and , in particular , @xmath1085 is near @xmath466 , for @xmath710 . but",
    "@xmath1034 and @xmath1033 make a definite size angle .",
    "hence @xmath1086 is near @xmath706 .",
    "we are done .",
    "[ prop : shortest - identity ] assume either @xmath923 or @xmath610 and @xmath47 has no component with complexity one .",
    "let @xmath612 be a @xmath613quasi - isometry so that the restriction of @xmath21 to the thick part is @xmath940 close to the identity .",
    "pick a large @xmath198 so that the statements in  [ sec : local - factors ] apply .",
    "then there is a constant @xmath1087 so that the following holds .",
    "let @xmath1088 be a point so that ( the second condition applies only when @xmath1089 ) @xmath1090 and let @xmath78 be the shortest curve in @xmath157 ; @xmath1091 .",
    "then @xmath1092    the proof is essentially the same as the proof of proposition  [ prop : torus - identity ] .",
    "let @xmath1093 or @xmath1094 .",
    "for any geodesic @xmath192 \\to { { \\mathcal t}}(\\alpha)$ ] so that @xmath1095 that stays @xmath1096 away from @xmath379 and @xmath1097 , we let @xmath1098 to be a point in @xmath81 that projects to @xmath1027 in @xmath855 and has the same projection to @xmath1099 as @xmath157 .",
    "then @xmath78 is still in the top group of @xmath1098 .",
    "define @xmath1100 assuming @xmath66 is large enough , such geodesics exist . also , by proposition  [ prop : short - curve ] , @xmath1101 .",
    "it can be shown , as in claim 1 in proposition  [ prop : torus - identity ] , that @xmath1057 is a quasi - geodesic with uniform constants .",
    "we choose the end points of @xmath180 so that @xmath1102 .",
    "choose a sequence of points in @xmath1070 @xmath1103 similar to claim 2 in proposition  [ prop : torus - identity ] and let @xmath1104 be a point so that @xmath1105 as before , we have ( here @xmath1106 plays the role of @xmath58 in claim 2 above ) @xmath1107 also , using the fact that points in the thick part move by at most @xmath940 and @xmath1108 has a distance @xmath1109 to the thick part , by the triangle inequality , as in proposition  [ prop : torus - identity ] , we have @xmath1110 noting that @xmath1111 , by the triangle inequality , we have @xmath1112 the same holds for @xmath1113 and @xmath1114 .",
    "note that @xmath1115 and @xmath1116 and @xmath229 are larger than @xmath1117 .",
    "assuming @xmath761 is large compared with @xmath84 , and @xmath1106 is large compared with the additive error in equation  , we have that the distance between the end points of @xmath1057 and @xmath180 is much less than the length of @xmath180 , and hence , @xmath1118 is uniformly close to @xmath180 .",
    "let @xmath1036 be a point satisfying equation  .",
    "let @xmath1099 be the surface obtained from @xmath47 after removing all subsurfaces of complexity one .",
    "let @xmath78 be the shortest curve in @xmath1121 .",
    "let @xmath1122 .    by proposition  [ prop : torus - identity ]",
    ", for any component @xmath71 of @xmath47 with @xmath1123 we have @xmath1124 for @xmath1125 , the point @xmath1126 is point in @xmath80 . define for some @xmath1127 , @xmath1128 by @xmath1129 we will show that @xmath1130 is a quasi - isometry .",
    "it will also turn out that @xmath1131 .",
    "we first show that @xmath1130 is coarsely onto .",
    "this follows from equation   which says that under the map @xmath21 the slice @xmath1132 is mapped a bounded distance from itself .",
    "the same is true for @xmath645 and the coarse onto statement follows .    for @xmath1133 , let @xmath1134 and @xmath1135",
    "then @xmath1136 hence , we only need to check the lower bound .",
    "it is enough to prove this for points @xmath76 and @xmath141 that have a distance of at least @xmath198 from @xmath1137 and @xmath1138 . assuming @xmath66 is large enough , such points exists and form a connected subset of @xmath1139 .",
    "but , we have shown that @xmath1140 hence , @xmath1141 that is , @xmath1130 is a @xmath1142quasi - isometry for @xmath1143 and @xmath1144 .",
    "now , propositions  [ prop : max - preserved ] and [ prop : ivanov ] apply .",
    "in fact , since @xmath21 is anchored , we can conclude that @xmath903 is the identity .",
    "hence , proposition  [ prop : thick ] , implies that @xmath1130 is in fact @xmath940 close to identity in the thick part of @xmath1139 .",
    "therefore , @xmath1145    let @xmath1146 .",
    "now , for any @xmath1147 , let @xmath1148 be the point that projects to @xmath1119 in @xmath855 and projects to @xmath1149 in @xmath1150 .",
    "call the set of points @xmath1151 which project to @xmath1119 the _ slice _ through @xmath1119 . at each point on the slice",
    ", @xmath78 is the shortest curve . for some @xmath1152",
    ", we can define @xmath1153 by @xmath1154 a similar argument to the one above shows that @xmath1155 is a quasi - isometry .",
    "again by equation   both @xmath21 and @xmath645 preserve the slice up to bounded error which says the map @xmath1155 is coarsely onto .",
    "the upper and lower bounds in the definition of quasi - isometry go as before .",
    "we next show that up to bounded additive error for any @xmath1151 in the slice , @xmath78 is the shortest curve on @xmath1156 .",
    "for let @xmath123 the shortest curve .",
    "applying equation   to @xmath645 we see that @xmath1157 this says that @xmath1158 and so by introducing a slightly larger additive error in the constants of quasi - isometry we can assume the image of our map is in @xmath1159 .",
    "we now show that @xmath1155 is anchored .",
    "this is because if @xmath1160 , then for every @xmath1161 , @xmath1162 and every curve @xmath123 is the shortest curve in @xmath1163 .",
    "then as above , the projection of @xmath1164 to every @xmath123 is also close to the projection of @xmath1151 to @xmath123 which in turn is the same as the projection of @xmath1149 to @xmath123 .",
    "that is @xmath1165 is close to @xmath1149 .    by induction , ( theorem  [ thm : induction ] applied to @xmath1150 ) ,",
    "@xmath1155 is @xmath1166close to the identity .",
    "we have shows that the projections of @xmath157 to @xmath1167 , @xmath855 and @xmath1168 are close to the projections of @xmath1169 to the same .",
    "that is , @xmath1169 is close to @xmath157 .",
    "but the set of points satisfying equation   is @xmath198dense in @xmath80 .",
    "thus , for an appropriate value of @xmath67 , the theorem holds .",
    "the proof is the same as above . from proposition  [ prop : ivanov",
    "] we have that there is an isometry of @xmath4 so that if we precompose @xmath21 with this isometry , then @xmath903 is the identity . assuming this",
    "is done , proposition  [ prop : thick ] implies that the restriction of @xmath21 to @xmath124 is @xmath940close to the identity .",
    "now consider a point @xmath1170 and let @xmath78 be the shortest curve in @xmath157 .",
    "choosing @xmath198 large enough so that statements in  [ sec : short - curves ] apply and proposition  [ prop : shortest - identity ] apply and so that @xmath1171 for any subsurface @xmath47 of @xmath0 . if @xmath1172 then , applying proposition  [ prop : shortest - identity ] we have @xmath1173 let @xmath1174 , let @xmath1175 and as before , for some @xmath1127 , define a map @xmath1176 as follows : for @xmath1177 let @xmath12 be a point so that , @xmath1178 now , define @xmath1179 as we argued in the proof of theorem  [ thm : induction ] , this map is a quasi - isometry with uniform constants and it is anchored . hence , by theorem  [ thm : induction ] , we have @xmath1180 the theorem follows from equations   and",
    ".                                                      h.  l. royden .",
    "automorphisms and isometries of teichmller space . in _ advances in the theory of riemann surfaces ( proc .",
    "conf . , stony brook , n.y . , 1969 ) _ , pages 369383 .",
    "ann . of math .",
    "studies , no .",
    "princeton univ . press ,",
    "princeton , n.j . ,"
  ],
  "abstract_text": [
    "<S> we prove that the every quasi - isometry of teichmller  space equipped with the teichmller  metric is a bounded distance from an isometry of teichmller  space . </S>",
    "<S> that is , teichmller  space is quasi - isometrically rigid . </S>"
  ]
}