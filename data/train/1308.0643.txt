{
  "article_text": [
    "in this paper , we consider a simple problem , namely the solution of the scalar wave equation @xmath0 subject to homogeneous initial conditions @xmath1 in the exterior of the unit sphere . here ,",
    "@xmath2 denote the spherical coordinates of a point in @xmath3 with @xmath4 .",
    "standard textbooks on mathematical physics ( such as @xcite ) present exact solutions for the time - harmonic cases governed by the helmholtz equation , but generally fail to discuss the difficulties associated with the fully time - dependent case .",
    "as we shall see , it is a nontrivial matter to develop closed - form solutions , and a surprisingly subtle matter to develop solutions that can be computed without catastrophic cancellation .    in this paper",
    ", we restrict our attention to boundary value problems with dirichlet or robin conditions .",
    "we consider the dirichlet problem first , and assume we are given data on the boundary of the unit sphere of the form : @xmath5 it is natural to begin by expanding both @xmath6 and @xmath7 in terms of spherical harmonics .",
    "@xmath8 where @xmath9 @xmath10 is the standard legendre polynomial of degree @xmath11 , and the associated legendre functions @xmath12 are defined by the rodrigues formula @xmath13    we let @xmath14 and @xmath15 denote the laplace transforms of @xmath16 and @xmath17 : @xmath18 @xmath19 it is straightforward @xcite to see that @xmath14 satisfies the linear second order ordinary differential equation ( ode ) @xmath20 \\hunm(r , s ) = 0,\\ ] ] for which the decaying solution as @xmath21 is the modified spherical hankel function @xmath22 .",
    "it follows that @xmath23 matching boundary data on the unit sphere , we have @xmath24 , and @xmath25    the remaining difficulty is that we have an explicit solution in the laplace transform domain , but we seek the solution in the time domain . for this , we write the right hand side of in a form for which the inverse laplace transform can carried out analytically .",
    "first , from @xcite , we have @xmath26 where @xmath27 ( @xmath28 ) are the simple roots of @xmath29 lying on the open left half of the complex plane .",
    "thus , @xmath30 where the second equality follows from an expansion using partial fractions and the coefficients @xmath31 are given from the residue theorem by the formula : @xmath32 substituting into , we obtain @xmath33 taking the inverse laplace transform of both sides , we have @xmath34 this involves the use of the convolution theorem and the formulas @xmath35 and @xmath36 , where @xmath37 is the heaviside function .",
    "wilcox @xcite studied the solution of the scalar wave equation and derived formula in 1959 . in that short note , wilcox stated that the coefficients @xmath31 given by grew slowly based on the claim that @xmath38 as @xmath39 .",
    "unfortunately , this estimate is incorrect .",
    "in fact , even after multiplication by the exponentially decaying factor @xmath40 , the coefficients @xmath31 ( @xmath28 ) grow exponentially fast as @xmath39 . in the next section , we explain this growth in detail . as a result ,",
    "even though is very convenient for the purpose of theoretical studies , it can not be used for numerical calculation due to catastrophe cancellation in carrying out the summation .",
    "benedict , field and lau @xcite have recently developed algorithms for compressing the kernel , which they call the teleportation kernel , arising in sphere - to - sphere propagation of data both for the standard wave equation as well as wave equations arising in linearized gravitational theories .",
    "for the wave equation their compressed kernels can be used to perform the same function as our solution of the dirichlet problem .",
    "the largest value of @xmath11 considered in @xcite is @xmath41 .",
    "it is as yet unclear if useful compressions for much larger values of @xmath11 can be constructed using their methods .",
    "we first show that the coefficients @xmath31 ( @xmath28 ) defined in grow exponentially as @xmath39 , for fixed large @xmath42 .",
    "indeed , lemma [ lem6.1 ] in section [ sec : num ] shows that the zeros @xmath27 of @xmath29 satisfy the estimates : @xmath43 for all @xmath44 and @xmath45 .",
    "thus when @xmath42 is large , we have @xmath46 where the last line follows from stirling s formula @xmath47 .",
    "we have computed @xmath48 for @xmath49 using , and plotted them in figure [ fig2.1 ] for @xmath50 , clearly exhibiting the exponential growth of @xmath51 .",
    "we also plot @xmath52 as a function of @xmath44 for a fixed value of @xmath11 in fig .",
    "[ fig2.2 ] .    _ for increasing values of @xmath11 , with @xmath50 . ,",
    "height=240 ]     as a function of @xmath44 , for @xmath53 and @xmath50 .",
    ", height=240 ]    from the preceding analysis , it is clear that one can not use as stated , since the desired solution is @xmath54 and catastrophic cancellation will occur in computing @xmath55 from exponentially large intermediate quantities .",
    "fortunately , even though @xmath56 grows exponentially as @xmath11 increases , we can rewrite in the form of a convolution , which involves much more benign growth : @xmath57 where the convolution kernel @xmath58 is defined by the formula @xmath59 if we write @xmath60 then from , we have @xmath61 where @xmath62 is the modified bessel function of the second kind .",
    "the last expression follows from the fact that @xmath63 .",
    "the convolution kernel @xmath64 and its laplace transform @xmath65 are plotted in figs .",
    "[ fig2.3 ] and [ fig2.4 ] , respectively .     as a function of @xmath66 for @xmath53 and @xmath50 .",
    "the left - hand plot shows @xmath64 for @xmath67 $ ] , the middle plot shows the same function on @xmath68 $ ] , and the right - hand plot shows the function on @xmath69$].__,height=240 ]     of the convolution kernel is plotted on the imaginary axis over the range @xmath70 $ ] for @xmath53 and @xmath50 .",
    "the red ( lower ) curve corresponds to the real part of @xmath65 and the blue ( upper ) curve corresponds to its imaginary part.,height=240 ]    the following lemma shows that the convolution kernel grows only quadratically as a function of @xmath11 at @xmath71 .",
    "numerical experiments ( see fig .",
    "[ fig2.3 ] ) suggest that @xmath64 is maximal in magnitude at @xmath71 .",
    "thus , while the sum of exponential expression ( [ eq2.14 ] ) involves catastrophic cancellation , the function @xmath64 is , itself , well - behaved and we may seek an alternative method for the evaluation of the convolution integral .",
    "let @xmath4 .",
    "then @xmath72    by the initial value theorem for the laplace transform , @xmath73 the first equality in follows from . from @xcite ( formula 9.7.2 on page 378 ) , we have the asymptotic expansion @xmath74 where @xmath75 . substituting and into",
    ", we obtain @xmath76 the result now follows from the fact that @xmath77 .    despite the fact that @xmath56 grows exponentially with @xmath11 ,",
    "shows that the _ sum of weights _",
    "@xmath31 is only @xmath78 for fixed @xmath42 .",
    "still , however , the formula can not be used in practice because of catastrophic cancellation in the summation @xmath79 thus , we will need a different representation for the convolution operator @xmath80 which is suitable for numerical computation .      to obtain a stable formula , we note first that we may rewrite in the form : @xmath81 we then use to express @xmath82 as @xmath83    we can , therefore , compute @xmath84 recursively : @xmath85 and , finally , @xmath86    numerical experiments indicate that the above recursion is stable if the zeros @xmath27 of @xmath29 are arranged in ascending order according to their real parts , i.e. , @xmath87 is closest to the negative real axis and @xmath88 is closest to the imaginary axis .",
    "alternatively , it is easy to show that the functions @xmath89 ( @xmath28 ) are the solutions to the following first order system of ordinary differential equations ( odes ) with zero initial conditions .",
    "@xmath90 where @xmath91 is a column vector of length @xmath11 with the @xmath44th entry being @xmath89 , @xmath92 , @xmath93 are @xmath94 constant matrices defined by the formulas @xmath95 and @xmath96 is a column vector of length @xmath11 whose only nonzero entry is @xmath97 .",
    "the ode system can actually be solved analytically .",
    "that is , one may multiply both sides of by @xmath98 to obtain @xmath99 where @xmath100 .",
    "it is clear that @xmath101 is a constant lower triangular matrix .",
    "one could then diagonalize the system using the eigen - decomposition @xmath102 .",
    "this , however , is numerically unstable since @xmath101 is a highly _ nonnormal _ matrix .",
    "thus , even though the condition number of @xmath101 is not very high ( numerical evidence shows that @xmath103 ) , @xmath104 is extremely ill - conditioned .",
    "in fact , more detailed analysis shows that this approach leads exactly to the formula .",
    "nevertherless , the ode system itself can be solved numerically using standard ode packages , albeit less efficiently than the explicit recursive approach we present in section [ sec : num ] , especially for high precision .",
    "in this section , we consider the robin problem for the scalar wave equation on the unit sphere : @xmath105 with homogeneous initial data @xmath106 and the boundary condition @xmath107 it should be noted that tokita @xcite extended wilcox s analysis of the dirichlet problem to the case of robin boundary conditions of the form @xmath108 , although he assumed that @xmath109 in his discussion .",
    "we are primarily concerned with the case @xmath110 since it arises in the solution of the full maxwell equations @xcite .    as in the analysis of the dirichlet problem , we first expand @xmath111 and @xmath112 in terms of spherical harmonics , perform the laplace transform in @xmath66 , match the boundary data and obtain    @xmath113    and @xmath114    we turn now to a study the properties of the kernel in , letting @xmath115 and @xmath116 recalling from [ eq2.8 ] that @xmath117 , we have @xmath118 hence , @xmath119 in particular , for @xmath120 , we have @xmath121 obviously , the poles of @xmath122 are simply the zeros of @xmath123 .",
    "those zeros have been characterized by tokita @xcite in the following lemma .",
    "[ lem3.1 ] _ [ adapted from @xcite . ]",
    "_ for @xmath124 , @xmath125 has @xmath126 simple roots denoted by @xmath127 .",
    "all the roots lie in the open left half of the complex plane symmetrically with respect to the real axis .",
    "furthermore , they satisfy the following estimates @xmath128 @xmath129 .",
    "hence , there exists a positive number @xmath130 such that @xmath131 for all @xmath124 and @xmath132 .    from the preceding lemma , for @xmath124 we have @xmath133",
    "one could carry out a partial fraction expansion for the right hand side of to obtain @xmath134 where the coefficients @xmath135 are given by the formula @xmath136 this would yield @xmath137 unfortunately , the coefficients @xmath135 ( @xmath138 ) behave as badly as the coefficients @xmath31 defined in for the dirichlet problem .",
    "that is , catastrophic cancellation in makes it ill - suited for numerical computation .",
    "fortunately , as in section [ sec : recurrence ] , we can compute @xmath139 without catastrophic cancellation using the following recurrence ( @xmath140 ) : @xmath141 with @xmath142 we leave the derivation of the recurrence to the reader .",
    "it is possible to write down a system of odes that is equivalent to .",
    "we omit details since the derivation is straightforward and we prefer the recurrence for numerical purposes in any case .",
    "in order to carry out the recurrences or , we first need to compute to compute the zeros of @xmath143 and @xmath144 .",
    "the following lemma provides asymptotic approximations of the zeros of these two functions , which we will use as initial guesses followed by a simple newton iteration . in practice",
    ", we have found that six newton steps are sufficient to achieve double precision accuracy for @xmath145 .",
    "[ lem6.1 ] _",
    "( asymptotic distribution of the zeros of @xmath143 and @xmath144 , adapted from @xcite ) ; see also the appendix . _    1 .",
    "the zeros of @xmath146 have the following asymptotic expansion @xmath147 uniformly in @xmath44 , where @xmath148 is defined by the formula @xmath149 @xmath150 is the @xmath44th negative zero of the airy function @xmath151 whose asymptotic expansion is given by the formula @xmath152 and @xmath153 is obtained from inverting the equation @xmath154 where the branch is chosen so that @xmath155 is real when @xmath156 is positive imaginary . in other words , @xmath153 lies on the curve whose parametric equation is @xmath157 where @xmath158 $ ] and @xmath159 is the positive root of @xmath160 .",
    "the zeros of @xmath161 have the asymptotic expansion @xmath162 uniformly in @xmath44 , where @xmath163 is defined by the formula @xmath164 and @xmath165 is the @xmath44th negative zero of the first derivative of the airy function @xmath166 whose asymptotic expansion is given by the formula @xmath167 and @xmath168 is defined as in with @xmath155 replaced by @xmath169 .",
    "figure [ fig6.1 ] shows the zeros of @xmath170 , @xmath171 , @xmath172 and @xmath173 .    , @xmath171 , @xmath172 and @xmath173 .",
    "the zeros of @xmath29 are marked by red @xmath174 , and the zeros of @xmath123 are marked by blue @xmath175 .",
    "_ , height=288 ]      we now present a high - order discretization scheme for computing @xmath84 and @xmath139 .",
    "we will only discuss the computation of @xmath84 in detail , since the treatment of @xmath139 is analogous . recall that the relevant recurrence relations are and .",
    "to proceed , we first introduce the auxillary functions @xmath176 then , becomes @xmath177 it is easy to check that @xmath178 satisfies the recurrence relation @xmath179 thus , we need only consider the calculation of the integral over @xmath180 $ ] . for this , we interpolate @xmath181 by a polynomial of degree @xmath182 with the shifted and scaled legendre nodes as interpolation nodes",
    ". that is , @xmath183 where @xmath184 ( @xmath185 ) are the standard legendre nodes on @xmath186 $ ] and @xmath187 is the @xmath188 entry of the matrix converting function values to the coefficients of a legendre expansion .",
    "substituting into the integral on the right side of and simplifying , we obtain @xmath189 where the coefficients @xmath190 ( @xmath185 ) are given by the formula @xmath191 substituting into , we obtain @xmath192 in order to be able to use , we need to calculate @xmath193 . for this , we can again apply the recurrence and obtain @xmath194 where the coefficients @xmath195 , for @xmath196 , are given by the formula @xmath197    in summary , the algorithm for computing @xmath198 proceeds in two stages : a precomputation stage and a time - marching stage .    for spherical harmonic order @xmath11 , time step @xmath199 , and desired order of accuracy @xmath200 , precompute the coefficients needed in the marching scheme for @xmath84 .    compute and",
    "store the zeros @xmath27 ( @xmath28 ) of @xmath29 .",
    "compute the legendre nodes @xmath184 ( @xmath185 ) and the @xmath201 matrix @xmath6 which converts function values to the coefficients of the corresponding legendre expansion .",
    "compute the integrals @xmath202 . compute and store the coefficients @xmath203 defined in .",
    "compute the integrals @xmath204 . compute and store the coefficients @xmath205 defined in . compute and",
    "store @xmath206 .",
    "compute and store @xmath207 .    given @xmath11 , @xmath42 , @xmath208 , the desired order of accuracy @xmath200 , and the number of desired time steps @xmath209 ,",
    "compute the spherical harmonic mode @xmath84 at @xmath210 defined by .",
    "set @xmath211 .",
    "set @xmath212 .",
    "evaluate the boundary data @xmath213 by computing the spherical harmonic transform of the dirichlet data @xmath7 , and set @xmath214 .",
    "use to compute @xmath215 use to update @xmath216 . set @xmath217 .",
    "compute @xmath218 .",
    "compute @xmath219 .      for each spherical harmonic mode , it is easy to see that the precomputation cost is @xmath220 and the marching cost is @xmath221 , where @xmath200 is the desired order of accuracy and @xmath209 is the total number of time steps . thus , if we truncate the spherical harmonic expansion order at @xmath222 , then the precomputation cost is @xmath223 and the marching cost is @xmath224 .",
    "the cost of computing the spherical harmonic transform of the boundary data at all times is @xmath225 and the cost of the inverse spherical harmonic transform at the final time is @xmath226 .",
    "summing all these factors up , we observe that the total computational cost of our algorithm is @xmath224 .",
    "we have implemented the above algorithm in fortran for both the dirichlet and robin problems governed by the scalar wave equation . to test its convergence and stability , we consider the exact solution @xmath227 with @xmath228 , @xmath229 , @xmath230 , @xmath231 , and @xmath232 , @xmath233 , @xmath234 , @xmath235 .",
    "the numerical solution is computed on a sphere of radius @xmath236 at @xmath237 .",
    "tables [ tab8.1]-[tab8.4 ] show the relative @xmath238 error of the numerical solution of the scalar wave equation for varying values of @xmath222 , the order of the spherical expansion and total number of time steps .",
    "note that the solution is oscillatory in both space and time , so that finite difference or finite element methods would have difficulty computing the solution in the far field with high precision because of numerical dispersion errors . in tables",
    "[ tab8.1 ] and [ tab8.3 ] , the order of temporal convolution is @xmath239 and we break the time interval @xmath240 $ ] into @xmath241 equispaced subintervals ( yielding a total of @xmath242 discretization points in time ) . in tables",
    "[ tab8.2 ] and [ tab8.4 ] , we use @xmath243 terms in the spherical harmonic expansions .",
    "these tables show that numerical solution converges spectrally fast to the exact solution .",
    ".relative @xmath238 error of the numerical solution of the dirichlet problem with increasing spherical harmonic expansion order @xmath222 .",
    "@xmath244 is the total number of discretization on the unit sphere .",
    "since the discretization error is usually greater than the truncation error , @xmath245 is chosen to be @xmath246 .",
    "thus @xmath247 .",
    "the total number of discretization points in time is @xmath248 . [",
    "cols=\"^,^,^,^,^,^,^\",options=\"header \" , ]     .",
    "the exact solution is of the same form as ( [ uexact ] ) - that is , induced by two sources in the interior of the unit sphere . [ fig8.2],height=192 ]     for a  true \" scattering problem .",
    "dirichlet boundary conditions are generated by two exterior sources placed on the @xmath156-axis , at @xmath249 and @xmath250 .",
    "the left - hand plot shows the value of the boundary data at the north pole of the unit sphere as a function of time , and the right - hand plot shows the solution at the north pole of the outer sphere of radius @xmath236 .",
    "[ fig8.3],height=192 ]     for a  true \" scattering problem .",
    "robin boundary conditions are generated by two exterior sources placed on the @xmath156-axis , at @xmath249 and @xmath250 .",
    "the left - hand plot shows the value of the boundary data at the north pole of the unit sphere as a function of time , and the right - hand plot shows the solution at the north pole of the outer sphere of radius @xmath236 .",
    "[ fig8.4],height=192 ]    -plane within the annular region @xmath251 at @xmath252 . with boundary data as in fig .",
    "[ fig8.3 ] .",
    "note that the domain is approximately 50 wavelengths in size .",
    "[ fig8.5],height=192 ]",
    "we have presented an analytic solution for the scalar wave equation in the exterior of a sphere in a form that is numerically tractable and permits high order accuracy even for objects many wavelengths in size . aside from its intrinsic interest in single or multiple scattering from a collection of spheres , our algorithm provides a useful reference solution for any numerical method designed to solve problems of exterior scattering . at the present time , such codes are typically tested by fourier transformation after a long - time simulation and comparison with a set of single frequency solutions computed by separation of variables applied to the helmholtz equation .    an exception is the work of sauter and veit @xcite , who make use of a formulation equivalent to that of wilcox to develop a benchmark solution for a time - domain integral equation solver which can be applied to scattering from general geometries .",
    "exponential ill - conditioning is avoided by considering only low - order spherical harmonic expansions .",
    "recently , grote and sim @xcite have also used an approach based on the local exact radiation boundary conditions proposed in @xcite to develop a new hybrid asymptotic / finite difference formalism for multiple scattering in the time domain .",
    "the advantage of the grote - sim method is that spherical harmonic transformations are unnecessary and the evaluation formulas can be localized in angle .",
    "however , they also restrict their attention to low - order expansions , and our preliminary experiments using their formulas indicate a loss of conditioning for @xmath11 large .",
    "( the loss of conditioning presumably also applies to the radiation boundary conditions in @xcite . )",
    "the method developed here should be of immediate use in both contexts    as implemented above , our algorithm has @xmath253 complexity .",
    "it is possible , however , to reduce the cost to @xmath254 .",
    "this requires the use of a fast spherical harmonic transform ( see , for example , @xcite and references therein ) . with this fast algorithm ,",
    "the cost of each spherical harmonic transform is reduced from @xmath226 to @xmath255 .",
    "second , we believe that the convolution kernels can be compressed as in @xcite , so that they involve only @xmath256 modes for each @xmath11 for a given precision . we note that compressions for @xmath257 and various radii are reported in @xcite , both for the scalar wave equation considered here ( which they call the flat - space wave equation ) and for wave equations with zerilli and regge - wheeler potentials . in the latter cases ,",
    "compressed kernels are also constructed for smaller values of @xmath11 , as the exact kernels do not have rational transforms .",
    "tabulated coefficients required for implementing the compressed kernels may be found online @xcite .",
    "for the extension of the present approach to the full maxwell equations , see @xcite .",
    "software implementing the algorithm of the present paper will be made available upon request .",
    "an alternative analysis of the instability phenomenon can be carried out using the uniform asymptotic expansions of the bessel functons due to olver @xcite .",
    "we first recall the relationship between @xmath62 and the hankel function , @xmath259 : @xmath260 thus the residues we wish to estimate are given by @xmath261 to approximate these for @xmath262 we use ( see @xcite ) : @xmath263 which hold uniformly in @xmath264 ; thus in particular they hold in @xmath265 where we will be using them . here",
    "@xmath155 is given by ( [ eq6.4 ] ) with the replacement @xmath266 .",
    "i. : :    @xmath267 has infinitely many zeros which lie on the    negative real axis .",
    "for @xmath44 large the jth zero ,    @xmath268 , of @xmath267 satisfies ( [ eq6.3 ] )    and the derivative satisfies    @xmath269 ii .",
    ": :    for @xmath270 the    function @xmath267 satisfies the asymptotic formula    @xmath271    using ( i. ) we deduce that the poles , @xmath272 , are asymptotically given by ( [ eq6.1 ] ) and approximately lie on the curve @xmath273 where @xmath274 is defined in ( [ eq6.5 ] ) .",
    "this is the curve for which @xmath275 is real and negative .    to evaluate the residues we must calculate using ( [ ash]),([asdh ] ) @xmath276 where we have introduced @xmath277 obviously the scaling @xmath278 moves @xmath279 off the curve where the argument of the airy function is real and negative . thus using ( [ aiasy ] ) and ( [ eq6.4 ] ) we deduce that the asymptotic formula for @xmath258 contains an exponential term @xmath280 \\nonumber\\end{aligned}\\ ] ] where @xmath281 here we have introduced @xmath282 .    finally , we consider the real part of the expression in parentheses on the second line of ( [ resexp ] ) .",
    "in particular we replace @xmath283 by a continuous variable @xmath284 traversing the scaled curve , @xmath274 , containing the approximate zeros .",
    "then the function @xmath285 depends only on @xmath42 and the coordinate describing the curve ; in particular it is independent of @xmath11 and @xmath44 . in fig .",
    "[ resasy2 ] we plot the real part of @xmath285 scaled by @xmath286 for @xmath50 .",
    "this can be compared with fig .",
    "[ fig2.2 ] by scaling both axes by @xmath53 and recognizing the vertical axis as the base ten logarithm .",
    "we then observe good agreement with the numerical results .",
    "the maximum value plotted in figure [ resasy2 ] is approximately @xmath287 , which is the predicted slope of the straight line plotted in fig .",
    "[ fig2.1 ] .",
    "again the agreement is good .",
    "we note that increasing @xmath42 makes the problem somewhat worse ; the scaled maximum real part is approximately @xmath288 for @xmath289 and @xmath290 for @xmath291 ."
  ],
  "abstract_text": [
    "<S> we derive new , explicit representations for the solution to the scalar wave equation in the exterior of a sphere , subject to either dirichlet or robin boundary conditions . </S>",
    "<S> our formula leads to a stable and high - order numerical scheme that permits the evaluation of the solution at an arbitrary target , without the use of a spatial grid and without numerical dispersion error . in the process , we correct some errors in the analytic literature concerning the asymptotic behavior of the logarithmic derivative of the spherical modified hankel function . </S>",
    "<S> we illustrate the performance of the method with several numerical examples .    65m70 , 78a40 , 78m16 </S>"
  ]
}