{
  "article_text": [
    "the standard paradigm for formation of large scale structure in the universe is based on the growth of small initial density fluctuations in a homogeneous and isotropic medium ( see e.g. @xcite ) . in the currently most popular cosmological models , a dominant fraction ( more than 80 % ) of the clustering matter in the universe",
    "is assumed to be in the form of microscopic particles which interact essentially only by their self - gravity . at the macroscopic scales of interest in cosmology",
    "the evolution of the distribution of this matter is then very well described by the vlasov or `` collisionless boltzmann '' equations coupled with the poisson equation ( see e.g. @xcite ) .",
    "a full solution , either analytical or numerical , of these equations starting from appropriate initial conditions ( ic ) is not feasible .",
    "there are , on the one hand , various perturbative approaches to their solution ( for reviews see e.g. @xcite ) , which allow one to understand the evolution in some limited range ( essentially of small to moderate amplitude fluctuations ) .",
    "on the other hand , there are cosmological n - body simulations ( for reviews see @xcite ) , which solve numerically for the evolution of a system of @xmath0 particles interacting purely through gravity , with a softening at very small scales . the number of particles @xmath0 in the very largest current simulations @xcite is @xmath1 , many more than two decades ago , but still many orders of magnitude fewer than the number of real dark matter particles ( @xmath2 in a comparable volume for a typical candidate ) .",
    "the question inevitably arises of the accuracy with which these `` macro - particles '' trace the desired correlation properties of the theoretical models .",
    "this is the problem of discreteness in cosmological n - body simulations .",
    "it is an issue which is of considerable importance as cosmology requires ever more precise predictions for its models for comparison with observations .    up to now the primary approach to the study of discreteness in n - body simulations",
    "has been through numerical studies of convergence ( see e.g. @xcite ) , i.e. , one changes the number of particles in a simulation and studies the stability of the measured quantities .",
    "where results seem fairly stable , they are assumed to have converged to the continuum limit . while this is a coherent approach , it is far from conclusive as , beyond the range of perturbation theory , we have no theoretical `` benchmarks '' to compare with . nor is there any systematic theory of discreteness effects , e.g. , we have no theoretical knowledge of the @xmath0 dependence of the convergence . given that typically @xmath0 is varied over a very modest range ( typically one or two orders of magnitude ) compared to that separating the simulation from the model ( typically 70 orders of magnitude ) there is much room for error .",
    "different mechanisms by which discreteness effects may make the evolution of n - body simulations different to that of the fluid limit have been discussed in the literature .",
    "a very basic consideration is that of the discreteness effects introduced already in the ic , before any dynamical evolution .",
    "indeed there are necessarily discrepancies between the correlation properties of the discretised ic and those of the input theoretical model , as there are intrinsic fluctuations associated with the particles themselves . for analysis and discussion of these effects",
    "see , e.g. , @xcite .",
    "what is probably the most obvious effect of discreteness , and certainly the one most emphasised in the literature , is two body collisionality : pairs of particles can have strong interactions with one another , which is an effect absent in the collisionless limit . for analysis and discussion of these effects",
    "see , e.g. , @xcite .",
    "in this paper we present an approach which allows in principle a systematic understanding of discreteness effects _ between these two regimes _ , in the evolution from the ic up to the time when two body collisions start to occur .",
    "we do so by developing a perturbative solution to the fully discrete cosmological n - body problem , which is valid in this regime .",
    "this essentially analytic solution can be compared to the analogous fluid ( @xmath3 ) solution , and one can understand exhaustively the modifications introduced , at a given time and length scale , by the finiteness of @xmath0 . while the usefulness of the approach is restricted to the regime of validity of this perturbative approach , we can gain considerable insights into the effects of discreteness and how they introduce error . some of the essential results have already been briefly reported in @xcite . in this paper",
    "we describe in much greater detail the perturbative method used to describe the evolution , and evaluate its regime of validity by extensive comparison with numerical simulations . in a forthcoming paper @xcite",
    "we will discuss the application of this method to the study of discreteness effects in n - body simulations , providing precise quantifications of these effects in the regime in which our treatment is valid .",
    "the perturbative scheme we employ is one which is well known and standard in solid state physics , as it is that used in the treatment of perturbations of a crystal about the local or global minimum of its internal energy . indeed the class of cosmological n - body simulations we consider are those which start by making very small perturbations to particles initially placed on a perfect simple lattice @xcite .",
    "up to an overall change in sign , our perturbative scheme is precisely that one would use for the analysis of the extensively studied coulomb lattice or wigner crystal ( see e.g. @xcite ) , of @xmath0 particles on a lattice interacting by a pure unscreened coulomb force . at linear order ( harmonic analysis )",
    "one simply solves a @xmath4 eigenvalue problem to determine the eigenmodes and eigenvalues of the displacements off the crystal .",
    "this can be done at very low cost in computational resources because of the symmetries of the lattice .",
    "stable ( i.e. dynamically oscillating ) modes in one problem become unstable ( growing and decaying ) modes in the other problem , and vice versa .",
    "one consequence of this which we will discuss briefly here , and more extensively in @xcite , is that , for what concerns discreteness in n - body simulations , there are qualitatively different features on the simple cubic ( sc ) lattice compared to the body centered cubic ( bcc ) or face centered cubic ( fcc ) lattice .",
    "a crucial step in our analysis is evidently the comparison of our solutions for the evolution with those obtained from the treatment of the continuous self - gravitating system .",
    "this latter problem can also be solved in a limited range with a perturbative treatment of the equations of a self - gravitating fluid , which are obtained by truncation of the collisionless boltzmann equation . given that our perturbation scheme works with the displacements of the particles",
    ", one might anticipate that the appropriate perturbation scheme to compare with is that given in the lagrangian formulation of these fluid equations , in which the evolution is described in terms of the trajectories of fluid elements @xcite .",
    "we show explicitly , at linear order , that this is the case : taking the limit in which the perturbations to the lattice are of wavelengths much larger than the lattice spacing @xmath5 the evolution described by our scheme maps precisely on to that at the same order in the lagrangian description of the fluid .",
    "the zeldovich approximation , which is simply the asymptotic form of this solution , can then be understood in very simple analogy with the long - wavelength coherent `` plasma oscillations '' in a unscreened charged plasma .",
    "the paper is organized as follows . in the next section",
    "we describe the perturbative treatment for perturbations off a perfect lattice , for the specific case of gravity .",
    "we work firstly , for simplicity , in a static euclidean universe , giving the explicit expressions for the evolution from general ic ( i.e. any perturbation from the lattice ) . in the following section we explicitly solve the evolution for the case of a simple cubic lattice , and discuss in detail the structure of the spectrum of eigenvalues . in sect .",
    "iv we generalize our results to the case of an expanding universe , and then show explicitly the recovery of the fluid limit given by the solution at the same order of the lagrangian formulation of the equations of a self - gravitating fluid . in the next section we present a comparison of the evolution described by our approximation with that of full numerical n - body simulations .",
    "we consider both uncorrelated initial perturbations ( a `` shuffled lattice '' ) and a set of highly correlated perturbations ( with a power spectrum of density fluctuations @xmath6 ) , like that in current cosmological models . we verify that the agreement is very good , and that the evolution is traced with considerably better accuracy than by the fluid limit at the same order .",
    "both approximations break down when particles start to approach one another ( i.e. `` shell - crossing '' in fluid language ) , which we parametrise through an appropriate statistical measure . in the final section we summarise our results and discuss various further developments of the method presented here which could be pursued , notably the extension of the perturbation scheme to higher than linear order .",
    "this may throw further light on how insights about discreteness gained using this formalism , which will be discussed at length in @xcite , extend into the regime of highly non - linear evolution .",
    "we also discuss briefly the possible interest of solving the cosmological n - body problem on the bcc lattice , as well as the possible extension of our method to ic generated on `` glassy '' configurations .",
    "in this section we start by defining and studying some general properties of the gravitational potential and force of an infinite system of point particles .",
    "we then consider the particular case of a perturbed infinite lattice in a static euclidean space , the generalization to an expanding universe being given in sect .",
    "[ expanding ] . since the force is zero in the unperturbed lattice ,",
    "the dominant contribution to the force in the perturbed case is linear in the relative displacements of the particles . in the last subsection , we consider the equations of motion resulting from this linearized force .",
    "let us consider carefully first the definition of the gravitational force in an infinite system of point particles of equal mass @xmath7 .",
    "we will assume that this system ( either stochastic or deterministic ) is characterized by a well defined mean number density @xmath8 , and mass density @xmath9 .",
    "the gravitational potential of a particle , per unit mass , at @xmath10 , due to the particles in a finite volume @xmath11 , is : [ pot - inf ] ( ) = -gm_ ( v, ) , where the sum is over all the particles contained in the system , and @xmath12 is the window function for the volume @xmath11 , i.e. , v(v , ) = \\ {    ll 1 & v , + 0 , &    .",
    "the force per unit of mass ( i.e. the acceleration ) , due to these same particles , is given by the gradient of the potential : [ force - def ] ( ) = - ( ) .",
    "taking the infinite volume limit @xmath13 , neither the gravitational potential , nor the gravitational force , are well defined . in the first case",
    "the result diverges , while in the second it may be finite or infinite , but its value depends on how the limit is taken is a conditionally convergent series . ] .    in euclidean spacetime",
    "this behaviour in the infinite volume limit may be regulated by the introduction of a negative background  the so - called jeans swindle ( see e.g. @xcite )  so that the potential is defined as [ pot - inf - back ] ( ) & = & -g_v .",
    "this modifies the usual poisson equation to [ poisson - modi ] ^2()=4g(()-_0 ) .",
    "the expression is well defined , provided ( i ) that the limit @xmath13 is taken in a physically reasonable way , and ( ii ) that the fluctuations in the system are sufficiently rapidly decaying at large scales is the power spectrum of density fluctuations , it is simple to show , using the modified poisson equation eq .",
    "( [ poisson - modi ] ) , that convergence of the fluctuations in the gravitational potential requires @xmath14 for @xmath15 . for finite fluctuations in the force",
    "one requires @xmath16 . ] . in the cosmological context",
    "this negative background appears naturally as a consequence of the expansion of the universe ( see sect .  [ expanding ] ) .",
    "the simulations of self - gravitating systems we are interested in are performed using a _",
    "finite _ cubic simulation box of side @xmath17 and volume @xmath18 , subject to periodic boundary conditions .",
    "the force on a particle is thus computed not only from all the other particles inside the simulation box , but also from all the copies of the particles contained in the `` replicas '' .",
    "the reason for using these boundary conditions is that they introduce the inevitable finite size effects without breaking translational invariance : every particle can be considered to be at the centre of the finite box and therefore sees the boundary in the same way .",
    "the infinite system we consider is thus an infinite number of replicas of a finite cubic box , with a negative background as described above to make the force well defined . ] . in this case",
    "the gravitational potential may be written as [ pot - total ] ( ) = _ v , where [ pot - back ] _ b()=g_0 _",
    "r^3 d^3r(v, ) is the contribution from the background , and [ pot - part ] _ p()=-gm_,^ * the contribution from the particles . here",
    "the sum over @xmath19 is restricted to the particles in the box , while the other sum , over the three integers @xmath20 ( i.e. over the images of @xmath19 ) , has a `` * '' to indicate that the term @xmath21 is excluded when @xmath22 .",
    "the gravitational force is : [ force - total ] ( ) = _ v , where [ force - back ] _",
    "r^3 d^3r(v, ) and [ force - part ] _",
    "p()=-gm_,^*(v,+l ) .",
    "note that the contribution from the background is identically zero if one takes a window function with inversion symmetry in @xmath10 ( e.g. a sphere or cube centred on @xmath10 ) .",
    "we consider the infinite lattice generated by the replication of a sc lattice of volume @xmath23 of side @xmath17 with @xmath0 elements , i.e. , whose lattice vectors are @xmath24 with @xmath25\\cap \\mathbb n$ ] and @xmath26 is the lattice spacing .",
    "this lattice ( with a particle at each site ) is now perturbed by applying displacements @xmath27 to each particle @xmath28 , so that the new positions of the particles can be written as [ pos ] = + ( ) .",
    "the `` particle '' term in the gravitational force [ i.e. eq .  ] can then be expanded order by order in taylor series about its value in the unperturbed lattice . at linear order in the relative displacements",
    "@xmath29 we obtain    [ linearized_force ] _",
    "p()&=&-gm _ , ^*\\{+ -3(-+l ) } + & & ( v,+l ) .    the first term in this sum [ first - term ] -gm _ , ^*(v,+l ) has the poor infinite volume behaviour which is regulated , as discussed above , by the contribution coming from the background eq .",
    "( [ force - back ] ) .",
    "the total linearized force is then also well defined , and given by the infinite volume limit of eq .",
    "( [ linearized_force ] ) summed with eq .",
    "( [ force - back ] ) . in the case that we choose to calculate using the infinite volume limit of a volume @xmath11 with inversion symmetry in @xmath10 ( i.e. the displaced position of the particle ) , the full linearized force is thus given by eq .",
    "( [ linearized_force ] ) . if , however , we choose to sum in a volume with inversion symmetry _ in the lattice site _ @xmath28 , it is simple to show that eq .",
    "is identically zero .",
    "the background term then contributes , with the sum @xmath30 $ ] remaining invariant .",
    "the convergence criterion for _ each _ term of is [ convergence ]    depend on the displacement of the particle @xmath28 on which we compute the force , but on _ relative _ displacements of the particles at the position @xmath28 and @xmath31 . under the action of the gravitational interaction , the displacements @xmath27",
    "will typically grow so that the condition eq .",
    "is violated after some time .",
    "however when some pairs of particles no longer satisfy condition , it may nevertheless continue to apply for the rest of the particles and may remain a sufficiently good approximation to the force . in order to have a precise characterization of the regime of validity of the approximation applied to follow the dynamical evolution of a perturbed lattice , it is necessary to compare the results with those obtained from evolution under full gravity .",
    "we will perform such a comparison in sect .",
    "[ comp - nbody ] using n - body simulations .",
    "it is convenient to write the linearized force just discussed in terms of the so - called _ dynamical matrix _ @xmath32 ( see e.g. @xcite ) : [ def - dyn ] ( ) = _ d(-)( ) .",
    "this matrix has the following properties : it is a complete symmetric operator , i.e. , @xmath33 with inversion symmetry , i.e. , @xmath34 .",
    "further , since the same displacement applied to all the particles produces no net force , we have @xmath35 . for any pair interaction potential @xmath36",
    "it is straighforward to show that it can be written as  @xcite [ expr_d ] @xmath37 where _ _ w(_0)=_=_0 and @xmath38 is the periodic function defined as [ w - def ] w()=_v(+l ) , i.e. , the potential due to a single particle and all its copies . for gravity we have @xmath39 and eq .",
    "is implicitly understood to be regulated as discussed at length above by the addition of a uniform negative background .",
    "we will describe below , and in app .",
    "[ ewald - app ] , how we use the well - known ewald summation technique to explicitly perform this sum .",
    "equation   gives the force on a particle , at first order in the displacements , when it is displaced and all the others remain unperturbed ( see fig .",
    "[ d - diag ] ) . for gravity",
    "it is straightforward @xcite to show that [ 4pi3 ] _ ( 0)= g_0 _ , i.e. , the linearized force @xmath40 on a particle due only to its own displacement @xmath41 with respect to the rest of the lattice is [ 4pi3f ] _ s()=g_0 ( ) . the simplest way to derive this result is by summing the force in spheres centred on the _ unperturbed _ position of the displaced particle . in this case",
    "it is straighforward to show , by symmetry , that the linearized direct particle contribution eq .",
    "is zero and the full force is given by the background term eq .  .",
    "the result follows then simply from gauss law which gives that the force comes only from the region inside the sphere shown in fig .",
    "[ d - diag ] .    .",
    "[ d - diag],scaledwidth=25.0% ]      in this section we derive the equations of motion of the particles in the linear approximation , and then solve them .",
    "we treat first a static euclidean space , giving the generalization to a cosmological expanding universe in sect .  [ expanding ] .    using newton s second law and eqs .",
    "and we can write the equation of motion of the particles as : [ eq - motion ] ( , t)=_d(-)(,t ) , where the double dot denotes a double derivative with respect to time .",
    "the expression is a system of vectorial coupled second order differential equations which can be reduced to an eigenvalue problem , using standard techniques . from bloch s",
    "theorem @xcite it follows that eq",
    ".   can be diagonalized by the following combination of plane waves : [ eigenvector ] ( , t)=_(,t)e^i , where the sum over @xmath42 is restricted to the _ first brillouin zone _ ,",
    "i.e. , for a sc lattice to [ k - vect ] = , with @xmath43 such that @xmath44 .",
    "we denote by @xmath45 the fourier transform of @xmath46 : [ eigenvector - inv ] ( , t)=_(,t)e^-i , where the sum is restricted to the simulation box ( i.e. without considering the replicas ) . inserting eq .   in eq .",
    ", we obtain for each @xmath42 : [ eq - motion - k ] ( , t)= ( ) ( , t ) , where @xmath47 is the ft of @xmath48 , defined analogously to . from the properties of @xmath49 given above , it follows that @xmath50 is a real and symmetric operator which satisfies , i.e. , @xmath50 is discontinuous at @xmath51 . ] _ 0 _ ( ) = g_0_. we can now solve eq .   by diagonalizing the @xmath52 matrix @xmath50 . for each @xmath42 , this determines three orthonormal eigenvectors @xmath53 with three associated eigenvalues @xmath54 ( @xmath55 ) satisfying the eigenvalue equation : [ eigen_equation ] ( ) _ n()=_n^2()_n ( ) .",
    "we can decompose each mode @xmath45 in the basis @xmath56 as [ transf - eigen ] ( , t)=_n=1 ^ 3_n ( ) f_n(,t ) .",
    "using eqs .  ,",
    "and we get the following equation for the coefficients @xmath57 : [ eq - modes ] f_n(,t)=_n^2()f_n(,t ) . depending on the sign of @xmath54",
    ", we obtain two classes of solutions @xmath58 and @xmath59 .",
    "we choose them , without any loss of generality , satisfying [ mode - boundary ] @xmath60 the function @xmath58 is associated with initial displacements and @xmath59 with initial velocities . if @xmath61 then [ uv - nonexp - pos ] @xmath62 if @xmath63 [ uv - nonexp - neg ] @xmath64 whereas the modes with positive eigenvalues cause an exponential growth of perturbation in the system , the modes with negative eigenvalues leads to oscillations .",
    "the evolution of the displacement field from any initial state @xmath65 is then given by the transformation [ eigen_evol ] ( , t)=_e^i where the matrix elements of the `` evolution operators '' @xmath66 and @xmath67 are [ evol_operators ] @xmath68 the operator @xmath69 thus evolves the initial displacement field and @xmath70 the initial velocity field .",
    "in this section we describe the determination of the eigenvectors and spectrum of eigenvalues of the dynamical matrix for gravity .",
    "we then discuss the physical meaning of the results , notably identifying how the fluid limit is obtained and how corrections to this limit may be calculated . in this discussion",
    "we will use extensively the strict analogy between the case we are treating and the coulomb lattice , or wigner cystal , studied in condensed matter physics ( see e.g. @xcite ) .",
    "this is a system of positively charged particles embedded in a negative neutralizing background .",
    "the particles interact with a repulsive @xmath72 potential instead of the attractive @xmath73 potential of newtonian gravity .",
    "thus all our results are mapped onto those for the corresponding coulomb lattice by making the formal substitution @xmath74 , where @xmath75 is the electronic charge for the coulomb lattice . ] .",
    "the spectrum of the matrix @xmath71 must be computed numerically .",
    "the matrix @xmath49 is constructed using the ewald sum method @xcite to speed up the convergence of the sum .",
    "we continue to work here explicitly , as above , with a sc lattice of side @xmath17 , with lattice spacing @xmath5 and @xmath0 elements . to determine the dynamical matrix we use the ewald method to evaluate @xmath38 as given in eq .  , splitting it into two pieces using an appropriate damping function @xmath76 : @xmath77 ,   \\end{split}\\ ] ] where @xmath78 is a arbitrary `` damping parameter '' of which the result is independant .",
    "the function @xmath79 is chosen to be equal to unity at @xmath80 and rapidly decaying to zero as @xmath81 goes to infinity .",
    "the first sum is then evaluated in real space and the second one in fourier space , making use of the parseval theorem @xcite , @xmath82 being chosen so that the second term in eq .  ( [ pot_damping ] ) is analytic at @xmath80 and thus rapidly convergent in fourier space .",
    "a common choice for a @xmath72 pair potential is ( ||,)=(|| ) .",
    "the expression for the function @xmath83 is then : [ pot_ewald_div ] w()=w^(r)()+w^(k ) ( ) . in the gravitational case [ pot_ewald ] @xmath84 , \\end{aligned}\\ ] ] where @xmath23 is the volume of the box and the wavevectors @xmath42 are as in eq .  , but with @xmath20 ranging over all triple integers ( i.e. not restricted to the first brillouin zone ) .",
    "there is no @xmath51 term in the sum because of the presence of the negative background : when summed over all the particles , this term is equal to _ 0 _ 0()=-_0 , i.e. , the @xmath85 mode of the potential ( calculated from the poisson equation in fourier space ) which is cancelled by the contribution coming from the negative background .",
    "the ewald sum for the dynamical matrix can then be calculated directly using eq .   and .",
    "the result , as in eq .",
    ", is divided in two parts : @xmath86 for which the explicit expressions are given in app .",
    "[ ewald - app ] .    for the results quoted here we have taken @xmath87 @xcite .",
    "using this numerical value of @xmath88 , it is sufficient to sum for ||3 || . to obtain a well converged determination of the dynamical matrix .",
    "the diagonalization calculation involves essentially @xmath0 operations ( where @xmath0 is the number of particles ) .",
    "it is perfectly feasible , with modest computer resources , to perform this diagonalisation for particle numbers as large as those used in the largest current n - body simulations .",
    "we now describe the spectrum of eigenvalues of the dynamical matrix @xmath49 for a sc lattice . as we have discussed in the introduction , this is the lattice which is used very widely in n - body simulations of structure formation in cosmology .    in fig .",
    "[ fig1 ] we plot the spectrum of a sc lattice , for @xmath89 , obtained with the method outlined in the previous subsection .",
    "we show the normalized eigenvalues [ eigen - norm ] _ n()= as a function of the modulus of the @xmath42 vectors , normalized to the nyquist frequency @xmath90 . with this normalisation",
    "the spectrum remains substantially the same as we increase the number of particles : the only change is that the eigenvalues become denser in the plot , filling out the approximate functional behaviours with more points . for our discussion here there is no interest in considering a greater number of points than that we have chosen .     particles .",
    "the lines correspond to chosen directions in @xmath91 space .",
    "[ fig1],scaledwidth=45.0% ]    for each vector @xmath42 there are three eigenvalues @xmath54 , @xmath55 . each family of eigenvalues ( i.e. with same @xmath92 ) defines a surface , corresponding to the three branches of the frequency - wavevector dispersion relation .",
    "sections of these surfaces are plotted for some chosen directions of the vector @xmath42 in fig .",
    "[ fig1 ] .      before proceeding",
    "further it is useful to derive some important results we will employ much in what follows .",
    "these are well known in the context of the application of this formalism in condensed matter physics ( see e.g. @xcite ) .",
    "first of all , we derive an analytical expression for the dynamical matrix in fourier space .",
    "let us decompose in fourier modes the function @xmath38 defined in eq .",
    "w()=_w()e^i , where the sum over @xmath42 is performed over _ all _ @xmath91 space , i.e. , not restricted to the first brillouin zone and [ ft - pot ] w()=_v_b d^3rw ( ) e^-i .",
    "the derivatives of the periodic potential are [ der_phi ] w_()=-_k_k_w()e^i .",
    "using the definition of the dynamical matrix [ dynamical ] _",
    "( ) = _ _ ( ) e^-i and eqs .",
    "and we obtain : [ dk_first ] _ ( ) = -_,k_k_w( ) ( e^i(-)-e^i ) where we can include the term @xmath93 in the sum because it vanishes . using the orthogonality relation , we have [ ortho ] _",
    "e^i(-)=n__,+ , where the @xmath42 are restricted to the first brillouin zone and @xmath94 are the reciprocal vectors of @xmath28 satisfying = 2 k_n , with @xmath95 . substituting eq .   in we obtain finally the expression @xcite : & & [ d_of_phi]_()= - n_0 k_k_w ( ) + & & - n_0_0 , where @xmath96 is the number density of particles . in the gravitational case , the integral can not be evaluated analytically . however , neglecting finite size effects , this integral can be computed over the whole space and the periodic potential @xmath97 is approximated by the interaction pair potential @xmath98 , so that [ ft - grav ] w()v()=_r^3 d^3r v ( ) e^-i=- . using this it is straightforward to show ( see app .",
    "[ kohn - app ] ) the following simple result : [ kohn ] _ i=1 ^ 3_i^2()=-n_0 k^2w()=4g_0 . in the context of the coulomb lattice",
    "this is a well - known result , the so - called _ kohn sum rule_. in this case the quantity which appears on the r.h.s . of the sum , instead of @xmath99 ,",
    "is @xmath100 where @xmath101 is the _ plasma frequency_. we will discuss further below the significance of this analogy .",
    "we can use these results and the above sum rule to compute  in a different way than in eqs .  ",
    " the @xmath102 term of the dynamical matrix @xmath49 ( i.e. the term giving the force on a particle , at linear order in the relative displacements , when it alone is perturbed off the lattice ) . using the kohn sum rule ,",
    "the trace of the dynamical matrix is : = 4g_0 . if the crystal has three equivalent orthogonal directions then the diagonal terms of the dynamical matrix will be equal . in the case of lattices with special symmetries ( like the sc , bcc and fcc ) it is simple to show that when a single particle is displaced along the direction of an axis , the force acting on it is parallel to the direction of displacement and assuming that the sum over the replicas converges ) . ]",
    "this implies that the non - diagonal terms of the dynamical matrix are zero .",
    "we can therefore conclude that [ d - zero - diag ] _ ( 0)=g_0_.      we have noted that the spectrum of eigenvalues has a clear branch structure . to identify the different branches it is useful to consider the @xmath103 limit keeping the interparticle distance @xmath5 constant .",
    "we expect this to correspond to the fluid limit : a plane wave fluctuation @xmath104 with @xmath105 has a variation scale much larger than the interparticle distance , and therefore does not `` see '' the particles .    from eq .",
    "the limit for @xmath103 is straightforward as the contribution of the sum on the r.h.s .",
    "vanishes in this limit [ d_limit_general ] _",
    "0_()=-n_0 k_k_w ( ) . using the eigenvalue equation with eqs .   and",
    ", it follows that the solutions in the fluid limit are    1 .",
    "one _ longitudinal _ eigenvector polarized parallel to @xmath42 with normalized eigenvalue @xmath106 and 2 .",
    "two _ transverse _ eigenvectors polarized in the plane transverse to @xmath42 with normalized eigenvalues @xmath107 .    as the spectrum of eigenvalues",
    "@xmath108 is exactly the same , up to an overall negative multiplicative constant , to that of the coulomb lattice , we adapt the same terminology as in this context .",
    "the branch of eigenvalues whose associated eigenvectors converges to the longitudinal eigenvector as @xmath109 is called the _ optical _ or longitudinal branch .",
    "the two other branches whose eigenvectors converge to the transverse eigenvectors are called the _",
    "acoustic _ branches . for finite @xmath91 ,",
    "the eigenvectors are not exactly parallel or perpendicular to @xmath110 for all @xmath42 but belong nevertheless to one of the three branches , which define three - dimensional hyper - surfaces in the four - dimensional space @xmath111 space .",
    "the appearance of an optical branch in a monoatomic crystal is a characteristic feature of the @xmath72 interaction potential ( at large @xmath112 ) . in the case of a more rapidly decaying potential at large scales ,",
    "i.e. , @xmath113 with @xmath114 , it becomes a third acoustic branch . in the case of a potential that decays slower at large @xmath112 ,",
    "i.e. , @xmath115 , the optical branch diverges as @xmath103 .",
    "the physical interpretation of the optical branch is that it represents the coherent excitation of the whole lattice with respect to the background @xcite . in a coulomb crystal ,",
    "the optical mode is produced by the lattice moving against this background producing a `` plasma oscillation '' , at the plasma frequency @xmath101 defined above .",
    "this mode is , as we have just seen , purely longitudinal , i.e. , the perturbations are parallel to @xmath42 , while the tranverse modes , i.e. , the perturbations orthogonal to @xmath42 have zero frequency .",
    "the reason for this behaviour of long wavelength density fluctuations can be easily understood .",
    "the density fluctuations are related , in this fluid limit , to the displacements through the continuity equation : ~ , which implies in @xmath91 space that [ rho - k ] ~. thus tranverse modes do not source density fluctuations , and therefore ( by the poisson equation ) they do not produce a force . in the case of gravity , instead of oscillating as in a plasma , the longitudinal mode may be amplified or attenuated ( depending on the initial perturbation ) , in a way which is independent of @xmath91 . as we will discuss in detail below , this is just the well known linear amplification of density fluctuations in a self - gravitating fluid .",
    "we have just seen that the fluid limit is obtained by taking the dynamical matrix as [ dyn - fluid ] ( ) = k_k_. we can estimate analytically the corrections to this limit for small @xmath91 ( i.e. for large wavelengths ) by expanding the eigenvalues and eigenvectors of the full dynamical matrix about @xmath51 .",
    "we note that this corresponds to calculating the difference , at large wavelengths , between the evolution of the perturbed lattice with a finite number of particles and that of the fluid limit .",
    "these are thus what are , in the context of cosmological simulations , `` discreteness effects '' introduced by the modelling of the fluid by such a system .",
    "we will discuss at length this application of this formalism in @xcite .    when expanding the dynamical matrix in taylor series about the fluid limit @xmath116 , it is simple to show that for @xmath72 interactions this series is in even powers of @xmath91 , because @xmath49 is real and @xmath50 analytic for @xmath117 ( see @xcite ) .",
    "it is therefore possible to write the corrections to the eigenvalues of the optical mode as : [ w - smallk - opt ] _ 1 ^ 2()4g_0(1- b_1()k^2 ) , where the expression for @xmath118 can be computed by diagonalizing @xmath50 expanded up to @xmath119 .",
    "the leading correction to the two acoustic modes may be written [ w - small - k - acoust ] @xmath120 the kohn sum rule implies that @xmath121 . in fig .",
    "[ bk ] we show the optical branch , in various different chosen directions .",
    "the approximation with the leading term in the taylor expansion is very good up to the nyquist frequency .    .",
    "the thick line is proportional to @xmath122 .",
    "[ bk],scaledwidth=45.0% ]    in fig .",
    "[ aniso ] we show how the anisotropy of the eigenvalues increases as the modulus of the wave vector increases ( i.e. when we look at smaller spatial scales ) .",
    "we plot , for three ranges of values of the modulus of @xmath42 , the value of the normalized eigenvalues as a function of the angle @xmath123 between @xmath42 and the axis that forms a minimal angle with it .",
    "as @xmath123 increases ( i.e. as @xmath124 decreases with @xmath125 ) there is a clear trend of decrease in the eigenvalue , in each of the three cases .",
    "the difference as a function of orientation of the vector @xmath42 is , however , much more marked for larger @xmath91 , i.e. , at scales closer to the nyquist frequency .",
    "this is not unexpected : the effects of anistropy ( which is completely absent in the fluid limit , in which the eigenvalues are independent of the orientation @xmath42 ) are naturally strongest for the short wavelength modes .     and the axes of the lattice which forms a minimal angle with it .",
    "we see that the effects of anisotropy are strongest for the short - wavelength modes , and decrease as we go towards the fluid limit .",
    "[ aniso],scaledwidth=45.0% ]      the spectrum of the sc lattice fig .",
    "[ fig1 ] includes some modes [ e.g. for @xmath126 with eigenvalues on the optical branch _",
    "larger than the fluid limit_. for example , this is the case for modes with initial displacement @xmath127 , shown in fig .",
    "[ coll - clust]-_(i)_. adjacent planes collapse towards one another , faster than in the fluid limit .",
    "the kohn sum rule eq .",
    "states that the sum of the three eigenvalues @xmath54 is equal to @xmath128 .",
    "therefore , the existence of modes collapsing faster than the fluid limit implies that there are other modes with negative eigenvalues @xmath54 , i.e. , which oscillate .",
    "this is the case , e.g. , of the mode with initial displacement @xmath129 , shown in the fig .",
    "[ coll - clust]-_(ii)_. in this case , contiguous planes oscillate as indicated in the figure .",
    "we will study these modes in greater detail using numerical simulation in sect .",
    "[ sec : oscill ] .",
    "the existence of oscillating modes in a perturbed and cold _ purely _ self - gravitating system ( i.e. without any additional interaction or velocity dispersion giving rise to a restoring pressure ) is an unexpected curiosity , a behaviour qualitatively different to that generically expected based on the analysis of the fluid limit .",
    "translated to the analagous coulomb system , the result means that a sc lattice is , in this case , unstable ( as there are growing modes ) .",
    "while this result has not apparently been shown in the literature , it is not an unexpected result in this context .",
    "it has been established @xcite that for the ( classical ) coulomb lattice that the ground state is the bcc lattice .",
    "it has a lower binding energy than the fcc lattice , which in turn is a lower energy configuration than the sc lattice .",
    "our result implies that the latter is not only a higher energy state , but that it is strictly unstable .",
    "indeed we note that the specific modes we have considered above describe a `` sliding '' of adjacent places in an sc lattice which deform it towards the lower energy configuration represented by the fcc lattice .    , scaledwidth=45.0% ]",
    "in the previous section , we have described the gravitational evolution of a perturbed lattice in a static euclidean universe . in the cosmological context ,",
    "density fluctuations are a perturbation around an homogeneous and isotropic friedmann - robertson - walker ( frw ) solution of einstein s field equations of general relativity . in cosmological n - body simulations , since the regions studied are smaller than the hubble radius and the velocities are non - relativistic , one considers the limit in which the equations of motion of the particles are strictly newtonian in physical coordinates @xmath10 @xcite .",
    "these coordinates are related to the comoving coordinates @xmath130 of the frw solution by [ comoving ] ( t)=a(t)(t ) , where @xmath131 is the scale factor describing the expansion of the universe .",
    "it satisfies the friedmann equation [ friedmann ] ( ) ^2=- , where @xmath132 is the mass density of the universe and @xmath133 the curvature . in the unperturbed frw model the particles",
    "are fixed in comoving coordinates , all deviation from these positions arising from perturbations to this model .",
    "for this reason it is very natural , and convenient , to work in comoving coordinates .",
    "we therefore start by transforming our previous newtonian equations to these coordinates , the only further difference being that we perturb about a time - dependent solution describing an expanding frw universe .    using eq .",
    "the acceleration can be written [ accel ] = a+2 + .",
    "the term @xmath134 can be expressed as the background contribution of the gravitational acceleration .",
    "for the specific case of an einstein de sitter ( eds ) universe , i.e. , a universe containing only matter without curvature [ @xmath135 and @xmath136 , it is given by [ accel - back ] _",
    "0==g_0 , which has exactly the same form ( for @xmath137 ) as the contribution of the negative background of eq .  .",
    "we now write the position of a particle in comoving coordinates in terms of the displacement @xmath41 about the lattice position as ( t)=+(,t ) .",
    "the vector @xmath28 is now the position of the lattice sites in _ comoving coordinates _",
    "( i.e. @xmath28 does not depend on time ) and @xmath46 is the displacement of the particle that was originally at @xmath28 ( in fluid theory , this is a _",
    "lagrangian coordinate _ , see e.g. @xcite ) . by using eq .",
    ", we can write eq .   in an expanding universe as [ eq - motion - exp ] ( , t)=-2(,t)+_^n(-)(,t ) , where we have implicitly included the background term in the dynamical matrix .",
    "we emphasize that _ the dynamical matrix is identical to that in the static case _ : it depends only on the kind of lattice and on the interaction , but not on the dynamics of the background",
    ". therefore all the analysis of this matrix performed in the preceeding section is valid also in this case . from eq .  , the mode equation generalizes simply to [ modes - exp ] f_n(,t)+2f_n(,t)=f_n(,t ) .",
    "this is very similar to the equation of the evolution of a fluid in lagrangian coordinates @xcite .",
    "the difference is only in the factor @xmath54 on the r.h.s . , which in the fluid limit is replaced by @xmath99 .",
    "we derive now the solution of the mode equation in the case of an eds universe .",
    "the evolution of the scale factor is , from eq .  :",
    "^ 2=1 , assuming that @xmath138 . then the mode coefficient equation is [ modes - exp - expl ] f_n(,t)+f_n(,t)=_n()f_n(,t ) , where we have used again the adimensional quantity @xmath108 defined in eq .  .",
    "a set of independent solutions of which satisfies the ic are : [ uv - exp ] @xmath139,\\\\ v_n(\\bk , t)=&\\tilde\\al(\\bk)t_0 \\left[\\left(\\frac{t}{t_0}\\right)^{\\al_n^{-}(\\bk)}-\\left(\\frac{t}{t_0}\\right)^{-\\al_n^{+}(\\bk)}\\right]\\end{aligned}\\ ] ] where ( ) = and @xmath140,\\\\ & \\al_n^{+}(\\bk)=\\frac{1}{6}\\left[\\sqrt{1 + 24\\varepsilon_n(\\bk)}+1\\right].\\end{aligned}\\ ] ] if @xmath141 the solution presents a power - law amplification mode and a power - law decaying mode .",
    "if @xmath142 , there are two decaying modes .",
    "finally , if @xmath143 , the solution is oscillatory and can be written as [ uv - exp - neg ] @xmath144\\\\\\nonumber & + \\frac{1}{6\\ga_n(\\bk)}\\left(\\frac{t}{t_0}\\right)^{-\\frac{1}{6}}\\sin\\left[\\ga_n(\\bk)\\ln\\left(\\frac{t}{t_0}\\right)\\right],\\\\ v_n(\\bk , t)=&\\frac{t_0}{\\ga_n(\\bk)}\\left(\\frac{t}{t_0}\\right)^{-\\frac{1}{6}}\\sin\\left[\\ga_n(\\bk)\\ln\\left(\\frac{t}{t_0}\\right)\\right]\\end{aligned}\\ ] ] where _",
    "n()= , i.e. , the static oscillatory behavior of the static universe survives , but now the oscillation is periodic in the logarithm of time with decreasing amplitude . the evolution of the displacements is computed with eq .  .",
    "the effect of the expansion [ through the `` viscous '' first term of the r.h.s . of eq .  ] is to slow down the growing and decaying mode of the non - expanding exponential solution into a power - law solution .",
    "let us calculate the fluid limit of the solution given by eqs .  , and .",
    "as explained in sect .",
    "[ analy_spectrum ] this corresponds to taking the limit @xmath145 at fixed @xmath5 of the dynamical matrix @xmath50 . in this case , as we have seen in sect .",
    "[ analy_spectrum ] one of the eigenvectors is parallel to @xmath146 , with eigenvalue @xmath99 , and the other two are normal to @xmath146 with eigenvalue equal to zero .",
    "we have then : [ eigen_fluid ] @xmath147 where @xmath148 and @xmath149 are orthogonal to @xmath146 chosen so that @xmath150 .",
    "using in , we get for the mode parallel to @xmath146 : [ parallel ] @xmath151,\\\\ & v_1(\\bk , t)\\equiv v_\\parallel(t)=\\frac{3}{5}t_0\\left[\\left(\\frac{t}{t_0}\\right)^{2/3}-\\left(\\frac{t}{t_0}\\right)^{-1}\\right]\\end{aligned}\\ ] ] and for the modes perpendicular to @xmath146 : [ perp ] @xmath152.\\end{aligned}\\ ] ] the evolution operators are then : [ evol_operators_fluid ] @xmath153,\\end{aligned}\\ ] ] . using eq .",
    "we write the evolution of the displacements in the fluid limit as : [ sol_fluid ] ( , t)&=&_(,t_0)+_(,t_0 ) u_(t ) + & & + _ ( , t_0 ) v_(t ) + _ ( , t_0 ) v_(t ) , where @xmath154 and analogously for the velocities @xmath155 . using the definition of peculiar gravitational acceleration @xmath156 [ g - pec ] = -=-=a",
    ", we can rewrite eq .   [ with eqs .   and ] as : [ sol_fluid_g ] ( , t)&=&_(,t_0 ) + & + & ( , t_0)t_0 ^ 2 + & + & _ ( , t_0 ) t_0 + & + & _ ( , t_0)3t_0 , where @xmath155 is the peculiar velocity defined as [ pec - vel ] ( , t)= - = - .",
    "this formula is precisely the one found in @xcite .",
    "note that in this reference , the lagrangian coordinate @xmath157 corresponds to the position of the particle at @xmath158 , i.e. , @xmath159 . for asymptotically large times",
    "the solution is [ sol_fluid_g_asymp ] ( , t)t_0()^2/3 .",
    "this solution , using eqs . and , gives the following simple relation between the displacements and the peculiar velocity with the peculiar acceleration at any time : [ zeldo - rel ] @xmath160 by imposing the ic [ zeldo - cond ] @xmath161 the evolution is given exactly at any time by eqs .",
    ", which is the well known zeldovich approximation , in which the decaying mode is zero from the initial time . in cosmological n - body simulations of structure formation ic",
    "are canonically imposed @xcite using : given an initial power spectrum of density fluctuations a gaussian realization of the gravitational potential is generated , and used to derive the initial gravitational field @xmath162 at the unperturbed particle positions .",
    "the particles are then displaced and given initial velocities as specified by .",
    "in this section we compare predictions of the perturbative treatment we have presented in the previous sections , which we will now refer to as particle linear theory ( plt ) , to what one obtains with full gravity ( fg ) calculated numerically in n - body simulations .",
    "the aim is to study the limits of validity of plt as the relative displacements of the particles increase .",
    "we also compare with the evolution obtained using standard lagrangian fluid linear theory ( flt ) . at the end of the section we also study further the oscillating modes which were identified in the spectrum of eigenvalues discussed in sect .",
    "[ analy_spectrum ] .",
    "note that time will be expressed everywhere in this section in units of @xmath163 ( i.e. the characteristic time scale in the fluid limit ) , unless otherwise stated .",
    "we also draw the reader s attention to the fact that the simulations we consider in this section are relatively small with respect to typical current standard cosmological simulations , but that this is not a relevant consideration here as plt works for _ any _ finite number of particles . for our purposes here it is sufficient to have a large enough number of particles to separate large scales ( i.e. the box size ) from small scales ( i.e. the interparticle distance ) .",
    "the ic for our study . ] are generated by perturbing in two different ways a sc lattice with @xmath0 particles .",
    "we choose to restrict ourselves to simulations without space expansion and with zero initial velocities .",
    "in any case we will see that the criteria we deduce for validity of the plt are expressed in a very simple way which one would expect to be essentially the same irrespective of the model . ] . in this case",
    "it is straightforward to show , using the results of sects .",
    "[ grav - lat ] and [ analy_spectrum ] , that the displacements of the particles according to plt are @xmath164 where @xmath165 and @xmath166 are defined in eqs .   and  , while the @xmath167 are determined by the ic . in the fluid limit ,",
    "following the discussion in sect .",
    "[ analy_spectrum ] after eq .",
    ", this becomes @xmath168 \\bigg\\ } \\\\ & = { \\mathbf{u}}({\\mathbf{r}},0 ) + \\frac{\\left [ \\cosh\\left(\\sqrt{4\\pi g \\rho_0 } \\",
    "t\\right )    - 1 \\right ] } { 4\\pi g \\rho_0 } \\",
    "\\ddot{{\\mathbf{u}}}({\\mathbf{r}},0 )   \\ .\\label{eq : flt_chap5 } \\end{split}\\ ] ] this therefore corresponds to what we denote by flt . note that in the following , we consider this last equation with the _ full _ initial acceleration @xmath169 , and not the linearized one [ see eq .   or  ] , since in the lagrangian fluid approach , the force on a fluid element is the full gravitational force  @xcite .",
    "we consider two different kinds of initial displacements : spatially uncorrelated , and correlated . in the first case , each particle of the lattice",
    "is randomly displaced , with uniform probability , in a small cubic box centered on its lattice site .",
    "the power spectrum of density fluctuation ( ps ) @xmath170 of the resulting particle distribution is proportional to @xmath122 at small @xmath91 @xcite . for the correlated case",
    ", the displacements are obtained from a set of gaussian variables @xmath171 : the @xmath172th component of the displacement of a particle at the lattice point @xmath173 is then @xmath174}_{\\tilde{u}_\\mu({\\mathbf{k } } ) } \\ .",
    "\\label{eq : kmoins2ic}\\ ] ] the random variables @xmath175 and @xmath176 have average @xmath177 and variance @xmath178 and are statistically independent of one another to be real , the following conditions are required @xmath179 and @xmath180 . ] .",
    "this gives rise , to a good approximation , to a distribution with ps of the density field proportional to @xmath181 at small @xmath91 .",
    "we have performed our fg n - body simulations using the publicly available treecode gadget  @xcite . in table  [",
    "tab : summarysimul ] are summarized the parameters characterizing the two different ic and simulations .",
    "the number of particles in the simulations is @xmath182 and @xmath183 , respectively .",
    "note that the softening lengths @xmath184 chosen are in both cases much smaller than the initial inter - particle distance .",
    "this means that this modification of the gravitational force can be neglected in our calculation of plt since it has already broken down when nearest neighbor particles are so close . for both sets of ic ,",
    "we have considered three different evolutions : ( i ) according to fg , ( ii ) according to plt and ( iii ) according to flt .",
    "snapshots are shown in figs .",
    "[ fig : snapsl16 ] and  [ fig : snapco32 ] . in these projected representations of the configurations at different times ,",
    "we have considered in the latter case ( co32 ) a subvolume of the simulation box containing initially @xmath182 particles in order to facilitate the visual comparison of the two cases . from these figures",
    "one can already see how well , to a first approximation , plt works in predicting the evolution of the two systems considered .",
    "the improvement given by plt over flt as an approximation to the fg evolution is visually very clearly manifest in the case of uc16 . in the case of co32",
    "the difference between the plt and flt is less visually evident , but one can still discern that the former does distinctly better in tracing the non - linear structures forming in the fg simulation .",
    "the reason why the differences are more pronounced in the case of uc16 is simply that in the correponding ic there is , compared to co32 , relatively much more power at small scales than at large scales . as we have seen in sect .",
    "[ analy_spectrum ] , it is at these smaller scales that the two approximations differ .",
    "the amplitudes of the initial displacements in both simulations have been chosen sufficiently small so that linear theory remains valid during a non - negligible time ( in units of @xmath185 ) .",
    "actually both eqs .   and",
    "predict the same evolution when @xmath186 is small : @xmath187 . in order to distinguish predictions of plt from those of flt , the linear regime must last sufficiently long , i.e. , the initial relative displacements of particles must be sufficiently small .",
    "we will see below that , for our chosen initial amplitudes , plt breaks down approximately at the same time in the two systems .",
    "this is purely coincidental .",
    ".summary of the two different distributions used as ic for the comparison between linear theory and true gravity ( uc stands for _ uncorrelated _ while co is for _ correlated _ ) .",
    "the column `` @xmath188 '' gives the average distance between nearest neighbors and its standard deviation , both normalized by @xmath5 .",
    "the next column is the softening length @xmath184 , normalized by @xmath189 , used in the fg simulation .",
    "the fifth column gives the initial value of the function @xmath190 at the interparticle distance , defined in eq .  .",
    "the time in the last column is defined later in the same equation : it gives the time scale at which plt is expected to break down .",
    "[ tab : summarysimul ] [ cols=\"<,^,^,^,^,^,^\",options=\"header \" , ]          +      +              +      +         let us first consider how to characterize quantitatively the regime of validity of plt . as discussed in sect .",
    "[ sub - linear ] , we anticipate that the relevant quantity will be the relative displacement of particles compared to the initial distance separating them .",
    "this motivates the study of the following statistical quantity : @xmath191 where @xmath192 is the trace of the correlation tensor of the displacements which is related to the ps of displacements @xmath193 by , this quantity is actually not well defined , in the sense that it diverges in the thermodynamic limit ( i.e. @xmath194 at fixed number density @xmath195 ) .",
    "indeed for a generic ps of displacements @xmath196 , we have , taking the continuous limit of eq .",
    ", that @xmath197 which is infrared divergent for @xmath198 ( @xmath199 being an ultraviolet cut - off given by the nyquist frequency in this context )",
    ". however , it can be shown @xcite that the function @xmath200 is well defined in the same limit for @xmath201 .",
    "this limit in fact just coincides with the condition that the associated density fluctuations have finite variance , since this requires that @xmath202 .",
    "these divergences in @xmath203 are not a problem provided @xmath200 is well defined : the particles can move an infinite distance from their lattice positions , but what is important for the validity of the approximation used is how much their relative displacements changes compared to their separation . ]",
    "@xmath204 given the convergence criterion eq .",
    ", we expect plt to break down when @xmath205 for some @xmath173",
    ". one would expect that this condition will first be attained for @xmath206 , i.e. , when a significant number of nearest neighbors have come close to one another .",
    "figures  [ fig : evolzetannsl16 ] and  [ fig : evolzetannkm2_2 ] show the evolution of the function @xmath207 averaged over the first six nearest neighbors , i.e. , for the six vectors @xmath173 of norm @xmath208 is symmetric in its first argument .",
    "] , for ic uc16 and co32 respectively . in both cases ,",
    "the fg evolution is compared with the predictions of plt and flt .",
    "the horizontal line is at @xmath209 and allows one to determine the characteristic time @xmath210 such that @xmath211 around which we expect plt to break down , as discussed above .",
    "this time  reported in tab .",
    "[ tab : summarysimul ]  is of the order of @xmath212 for both ic .",
    "we see from these figures that this expectation turns out to be correct : the plt evolution from both sets of ic traces very accurately the fg evolution of the n - body simulation until a time very close to @xmath210 . for uc16 ( fig .",
    "[ fig : evolzetannsl16 ] ) the deviation between the plt and fg evolutions becomes significant for a time just slightly earlier , while for co32 ( fig .",
    "[ fig : evolzetannkm2_2 ] ) this time is slightly later . considering the curves for flt , we see that it does less well than plt in both cases , the improvement given by plt over flt being much more marked in the case of uc16 .",
    "this confirms quantitatively the visual impression of figs .",
    "[ fig : snapsl16 ] and [ fig : snapco32 ] , for the same reason we gave above .",
    "even though @xmath213 is a real space quantity characterising correlation around the inter - particle distance @xmath5 , it is an integral in @xmath91 space which picks up a contribution from longer wave - length modes which are well described ( as discussed in sects .",
    "[ grav - lat ] and [ analy_spectrum ] and further below ) by flt . for the much more infra - red dominated spectrum of displacements of co32",
    "this contribution is much more significant and so flt naturally is a better approximation for this quantity than in the case of uc16 .    ,",
    "defined in eq .",
    ", according to fg , plt and flt in the uc16 simulation .",
    "the horizontal line is @xmath209 and gives the characteristic time @xmath210 around which we expect plt to break down ( as an approximation to fg ) .",
    "[ fig : evolzetannsl16],scaledwidth=50.0% ]     according to fg , lpt and flt in the co32 simulation .",
    "the horizontal line is @xmath209 and gives the characteristic time @xmath210 around which we expect plt to break down ( as an approximation to fg ) .",
    "[ fig : evolzetannkm2_2],scaledwidth=50.0% ]    we next give an alternative , perhaps intuititively more direct , way of quantifying the regime of validity of plt .",
    "we consider the nearest neighbor ( nn ) distribution @xmath214 : at a given time @xmath186 , this function gives the probability density for a particle to have its nearest neighbor at the distance @xmath112 ( see e.g. @xcite ) . in figs .",
    "[ fig : nnsl16 ] and  [ fig : nnco32 ] are shown , for the fg evolution of uc16 and co32 , the cumulative distributions derived from @xmath214 , @xmath215 these represent the probability that a given particle has its nn within a distance @xmath112 .",
    "it allows one to determine quite accurately the time at which `` shell crossing '' occurs .",
    "we see that between @xmath216 and @xmath217 , the behavior of the cumulative distributions changes in an important way : for @xmath218 , almost no particle has its nn closer than a distance @xmath219 , while at time @xmath220 , @xmath221 of the particles have their nn at a distance smaller than this distance .",
    "thus at @xmath216 , the first shell crossings occur and at @xmath222 , approximately half of the particles have already had their own shell crossing or are very close to it .     in the uc16 simulation .",
    "the times are indicated in the legend .",
    "[ fig : nnsl16],scaledwidth=50.0% ]     in the co32 simulation .",
    "the times are indicated in the legend.[fig : nnco32],scaledwidth=50.0% ]      it is interesting to study also the accuracy of plt in tracing the fg evolution of the trajectories of _ individual _ particles ( rather than only averaged quantities ) .",
    "we consider now the relative displacement of a particle with respect to its nn , that is @xmath223 where @xmath224 and @xmath173 are separated by a vector of elementary size @xmath5 .",
    "to do so we have chosen randomly a particle in each simulation and selected among its six initial nn the one which ends up closest to it at the time at which plt breaks down in the corresponding fg simulation ( see figs .  [",
    "fig : distnnsl16 ] and  [ fig : distnnco32 ] ) . in figs .",
    "[ fig : reldisplnnsl16 ] and  [ fig : reldisplnnco32 ] are shown the result for uc16 and co32 respectively .",
    "these two figures allow one to see that for both ic , plt describes very well the evolution of the relative displacement of the two particles considered up to a time of the order of @xmath225 . in both systems , this time is slightly smaller than the time at which the particle selected is the closest to its nn : from figs .",
    "[ fig : distnnsl16 ] and  [ fig : distnnco32 ] we may estimate that this time is approximately @xmath212 in the system uc16 and @xmath226 in co32 .",
    "we also note that plt does again also in this case better than flt in describing the relative displacements .",
    "indeed flt already breaks down at @xmath227 in uc16 and @xmath228 in co32 .",
    "( normalized to @xmath5 ) between a randomly chosen particle in uc16 and its six nn in the fg simulation .",
    "the arrow shows the nn which is used for the study of the relative displacement ( fig .",
    "[ fig : reldisplnnsl16 ] ) .",
    "[ fig : distnnsl16 ] , scaledwidth=50.0% ]     ( normalized to @xmath5 ) between a randomly chosen particle in co32 and its six nn in the fg simulation .",
    "the arrow shows the nn which is used for the study of the relative displacement ( fig .",
    "[ fig : reldisplnnco32 ] ) .",
    "[ fig : distnnco32 ] , scaledwidth=50.0% ]    [ c]@xmath229    of a randomly chosen particle and its nn in uc16 .",
    "the particle is the same as the one chosen for fig .",
    "[ fig : distnnsl16 ] and the nn corresponds to the one indicated by an arrow in this last figure . note that , for clarity , we have shifted two of the coordinates by @xmath230 . [",
    "fig : reldisplnnsl16],title=\"fig:\",scaledwidth=50.0% ]    [ c]@xmath229    of a randomly chosen particle and its nn in co32 .",
    "the particle is the same as the one chosen for fig .",
    "[ fig : distnnco32 ] and the nn corresponds to the one indicated by an arrow in this last figure . note that , for clarity , we have shifted two of the coordinates by @xmath231 .",
    "[ fig : reldisplnnco32],title=\"fig:\",scaledwidth=50.0% ]      in this subsection we consider the comparison of plt with fg and flt in reciprocal space .",
    "we first consider the evolution of the ps of displacements @xmath232 for a few specific vectors @xmath233 .",
    "then we study the evolution of this quantity , but now averaged on vectors @xmath233 of similar modulus . besides verifying the conclusions drawn in sect .",
    "[ analy_spectrum ] , this numerical study allows us to assess the validity of plt for different wavenumbers as a function of time .    following the results and discussion in sect .",
    "[ analy_spectrum ] , we expect firstly to see the plt evolution to differ less and less from flt as we go to longer wavelength modes ( @xmath234 ) , since the eigenvalues and eigenvectors of the modes approach those of the fluid limit in this case . for such modes we expect that plt and flt should both follow the fg evolution accurately up to at least @xmath235 . for short wavelength modes ( @xmath236 )",
    "we expect plt to be significantly more accurate than flt .",
    "as for the time of breakdown of plt for a given mode , we would expect that long wavelength mode evolution should be described accurately by plt for a time longer than that of short wavelength modes : the breakdown of the approximation in the sense we have characterised it above , i.e. , in terms of the approach of nn particles , would not be expected to affect significantly the evolution of longer wavelength modes .",
    "we will discuss this point further below .",
    "figures [ fig : evoluk2sl16 ] and [ fig : evoluk2km2_2 ] show the evolution of @xmath232 , normalized to its initial value ( i.e. at @xmath237 ) , for two chosen vectors @xmath233 with very different lengths and different orientations with respect to the lattice , for ic uc16 and co32 . in both cases",
    ", plt follows very accurately the fg evolution up to a certain time for both long and small wavelength modes .",
    "the time up to which the agreement is good depends , as has been anticipated , on the wavelength .",
    "it breaks down first for the large @xmath91 ( small wavelength ) mode , and significantly later for the small @xmath91 ( large wavelength ) mode . for both ic the effects of non -",
    "linearity become significant for the large @xmath91 mode chosen ( one of the modes of largest modulus in each case ) , at @xmath238 , i.e. , slightly before the time of the first shell crossings as determined above from figs .",
    "[ fig : nnsl16 ] and  [ fig : nnco32 ] . in this case",
    "we see also clearly that flt is a poor approximation to the evolution , corresponding to an evolution with an exponent which is significantly too large . for the long wavelength mode ( one of the modes of smallest modulus in each case ) , on the other hand , we see that flt and plt , as expected predict the same evolution ( at the level of precision allowed by the figures ) . and in this case we see that they both trace the fg evolution very accurately for a very significantly longer time , up to @xmath239 in the case of c032 .     normalized to its initial value for two chosen vectors @xmath233 according to fg ( thick lines ) , plt ( medium lines ) and flt ( thin lines ) with ic uc16 .",
    "the vectors @xmath233 are @xmath240 and @xmath241 .",
    "[ fig : evoluk2sl16],scaledwidth=50.0% ]     but for ic co32 and vectors @xmath242 and @xmath243 .",
    "[ fig : evoluk2km2_2],scaledwidth=50.0% ]    we now consider the ps of displacements @xmath232 , averaged in spherical shells , which we denote simply by @xmath244 : @xmath245 where @xmath246 is the number of vectors @xmath233 in the spherical shell @xmath247 .",
    "this analysis of @xmath244 allows one to observe in further detail how plt fails in describing fg evolution after some time and at different scales .",
    "moreover , it shows how it is more accurate than flt in approximating fg .",
    "figure [ fig : evolpdsl16 ] shows the evolution of the averaged ps of displacements according to fg ( thick lines ) , plt ( medium lines ) and flt ( thin lines ) with ic uc16 .",
    "the first difference between plt and fg appears at large @xmath91 at @xmath248 , slightly before @xmath210 .",
    "this difference propagates to smaller @xmath91 at later times .",
    "flt is already discernibly different from fg at @xmath249 at large @xmath91 and the difference propagates to smaller @xmath91 at later times .    , eq .  , according to fg ( thick lines ) , plt ( medium lines ) and flt ( thin lines ) from ic uc16 . the times are indicated at the left of the curves .",
    "the values of @xmath91 are given in unit of the nyquist frequency @xmath250 .",
    "[ fig : evolpdsl16],scaledwidth=50.0% ]    figure [ fig : evolpdkm2_2 ] is similar to fig .",
    "[ fig : evolpdsl16 ] but concerns ic co32 .",
    "note that , since @xmath251 , it is @xmath252 which is shown in our sum outside the first brillouin zone : we have summed in eq .   over the modes",
    "@xmath253 ^ 3 $ ] rather than @xmath254 ^ 3 $ ] .",
    "this has no bearing on the conclusions drawn here . ] .",
    "similar conclusions can be drawn to those in the uncorrelated case .",
    "the differences between plt and fg become visible at @xmath248 and propagate at later times . actually at @xmath255 , there is no longer good agreement at any @xmath91 .",
    "flt starts to deviate discernibly from fg at @xmath249 .    , eq .  , according to fg ( thick lines ) , plt ( medium lines ) and flt ( thin lines ) from ic co32 . the times are indicated at the left of the curves .",
    "the values of @xmath91 are given in unit of @xmath250 .",
    "note that it is actually @xmath252 which is represented .",
    "[ fig : evolpdkm2_2],scaledwidth=50.0% ]    figs .",
    "[ fig : evolpdsl16 ] and [ fig : evolpdkm2_2 ] thus confirm clearly what was already observed in figs .",
    "[ fig : evoluk2sl16 ] and [ fig : evoluk2km2_2 ] : the breakdown of plt starts at the largest @xmath91 and propagates progressively in time to smaller @xmath91 .",
    "further plt ( and flt ) remain a good approximation to the evolution at the smaller @xmath91 in our simulations at times significantly longer than the time @xmath210 which we used to characterize the global validity of plt .",
    "the reason is simple , and it is the same one which explains , e.g. , why linear fluid theory successfully describes the evolution of small perturbations to a self - gravitating system even when there are strong non - linearities at smaller scales : re - arranging matter in any way , subject only to the constraint that matter and momentum are conserved , up to some real space finite scale , @xmath256 say , can produce , at most , fluctuations at small @xmath91 ( i.e. @xmath257 ) with a ps of density fluctuations @xmath258 . the perturbative approximation to full gravity represented by plt breaks down globally , as we have seen , when nn start to approach one another .",
    "when this happens , however , the full gravitational force can still be approximated for a longer time by the full gravitational force on each particle due its nn particle , plus the force from all other particles still linearised , as in plt , in the relative displacements from their starting positions .",
    "this means that fg can continue to be approximated by plt plus an effective interaction _ of finite range_. this latter interaction can produce at most a term in the ps in @xmath259 , which will always be dominated by the simple amplification given by plt of the initial ps , which in the cases we have considered has a small k behaviour @xmath260 with @xmath261 ( @xmath262 and @xmath263 for uc16 and co32 respectively ) .",
    "an interesting question is whether , at these longer times , plt is a good approximation in so far as it agrees well with flt , or whether it can actually continue to trace the fg evolution better than flt . from the numerical results we have given here it",
    "is not possible to distinguish flt from plt in the corresponding regime .",
    "larger simulations would be required to answer this question .      we have noted in sect .",
    "[ analy_spectrum ] that the spectrum of eigenvalues of the sc lattice contains some negative eigenvalues , which give oscillating modes .",
    "these modes are not of practical importance in typical cosmological simulations since they are relatively few , and in a short time of little importance compared to the unstable modes ( which also have considerably larger exponents . ] ) .",
    "it is nevertheless interesting to study them briefly since they are a peculiarity of the discrete system . indeed , as discussed in sect .",
    "[ analy_spectrum ] such oscillating modes do not exist in fluid theory without initial velocities .    to study these modes we consider a sc lattice with @xmath264 _",
    "even _ is odd or even illustrates again that their presence is entirely associated with the discreteness of the system . ] and the following initial displacement : @xmath265 where @xmath266 is a constant .",
    "this corresponds to displacing each plane of particles with constant @xmath267 in the direction @xmath268 and @xmath269 alternately ( see fig .",
    "[ coll - clust ] ) .",
    "the only excited mode is @xmath270 . according to plt , the eigenvalue associated to this displacement is @xmath271 ( cf .",
    "[ analy_spectrum ] ) and the particles therefore should oscillate .",
    "if no initial velocity is considered , then the motion of a particle should be , as predicted by plt @xmath272 with a frequency @xmath273 .    to observe these oscillations numerically",
    ", we have written a special code to integrate the equations of motion with fg , rather than using the same code ( gadget ) as in the preceeding subsections .",
    "the reason we do this is that it is very difficult numerically to observe them with such a code .",
    "indeed the simulation of oscillating modes would be an interesting and challenging test for the precision of gravitational n - body codes .",
    "the primary difficulty is that the negative eigenvalues are small compared to most of positive ones ( cf .",
    "[ fig1 ] in sect .",
    "[ analy_spectrum ] ) , so that an even much smaller amplitude perturbation in any of these modes can grow as an instability on a time scale much smaller than the period of oscillation .",
    "such small perturbations are clearly created by numerical imprecision , but also , by the intrinsic non - linearities in the fg , i.e. , there is a coupling of modes which is neglected in plt .",
    "thus one must work not only with great numerical precision but also at extremely low amplitude to avoid `` contamination '' by other modes through the non - linearities on the relevant ( long ) time - scale .",
    "the code that we have used has been built specifically for the particular initial displacements   taking into account the following considerations . from the symmetries of the configuration",
    ", it follows that the _ full _ gravitational force on a particle is only along the @xmath274 axis , and modulo a change of sign , all the particles move the same way .",
    "moreover , since the distribution of particles can be seen as two perfect rectangular sub - lattices with lattice spacing @xmath5 in the @xmath274 and @xmath275 directions and @xmath276 in the @xmath277 direction and the other one by the particles displaced by @xmath278 . ]",
    "the force on a given particle is only due to the particles in the sub - lattice which does not contain this particle . in order to evolve the system",
    ", it is therefore sufficient to integrate the equation of motion of a single particle in one dimension with a force coming from half of the particles of the system ( the force is calculated by using the ewald summation formula ) .",
    "the method used for the integration is the _ embedded runge - kutta - fehlberg ( 4 , 5 ) method _ , implemented in the gnu scientific library and more precise than the standard leap - frog method used in cosmological n - body simulations .",
    "one can also note that , due to the periodicity of the system , the number of particles is not important as long as @xmath264 is even : @xmath279 is actually enough .",
    "figure [ fig : oscillation1 ] shows the oscillations along the @xmath274 axis of a particle according to fg ( obtained by using the code we have just described ) and the prediction of plt .",
    "the value of @xmath266 used is @xmath280 , for which we find a perfect agreement between fg and plt .",
    "it is interesting to note that for larger value of @xmath281 , the frequencies of the oscillations measured in the fg simulations decrease and the functional behavior of the oscillations is less and less close to exactly sinusoidal as can be seen in fig .",
    "[ fig : oscillation2 ] .",
    "this trend towards a decreasing frequency [ rather than the constant frequency @xmath282 as in eq .",
    "] as the amplitude increases has a simple explanation : when @xmath283 the full force exactly vanishes as the perturbed configuration is in this case again a perfect sc lattice .",
    "this is also true when @xmath284 , but in that case the resulting distribution is just the initial sc lattice .",
    "it follows that if @xmath2851/4,1/2[$ ] , one observes the same types of oscillation as for @xmath2850,1/4[$ ] due to the invariance of the system under transformation of the type @xmath286 with @xmath287 an integer .     according to fg ( solid line ) and plt ( dashed line ) .",
    "the curves are actually indistinguishable on the plot .",
    "the time is in units of @xmath288 and the displacement is normalized to the value of @xmath266 .",
    "details of the fg simulation are given in the text .",
    "[ fig : oscillation1],scaledwidth=50.0% ]     according to fg ( solid line ) and plt ( dashed line ) .",
    "the last curve ( `` best fit '' , dashed - dotted line ) represents a sine with frequency @xmath289 .",
    "it allows one to see that the frequency of the oscillations is smaller than the one predicted by plt and that the functional behavior is slightly different from an exact sine .",
    "the time is in units of @xmath288 and the displacement is normalized to the value of @xmath266 .",
    "details of the fg simulation are given in the text .",
    "[ fig : oscillation2],scaledwidth=50.0% ]",
    "in this paper we have described in detail a new perturbative treatment which describes the evolution of @xmath0 self - gravitating particles of equal mass initially perturbed off a perfect lattice , subject to periodic boundary conditions , both in a static spacetime and in a cosmological ( expanding ) background .",
    "we have reported specifically the spectrum of eigenvectors and eigenvalues for the modes of the displacement field on a _ simple cubic _ lattice , which is the case of relevance in cosmology .",
    "while the fluid limit ( @xmath290 ) is recovered for long wavelength modes , the full spectrum for the finite @xmath0 system contains both modes with negative eigenvalues , corresponding to oscillations , and modes with exponents greater than in the fluid limit .",
    "further the eigenvalues depend explicitly not only on the modulus of the wave - vector @xmath42 , but also on its orientation with respect to the axes of the lattice .",
    "the breaking of rotational invariance in the lattice is thus imprinted in the evolution of the system .",
    "we have shown , by detailed comparison with numerical simulations , that the linear order of the scheme has approximately the same range of validity as the corresponding ( linear ) order of the fluid theory , up to when particles come very close to one another ( i.e. up to `` shell - crossing '' in fluid language ) .",
    "however it traces the real evolution with greater accuracy than its fluid counterpart .    in the context of cosmological simulations",
    "this means that our method provides a precise tool for quantifying _ fully _ , up to shell crossing , the effects of discreteness in these simulations : these effects are nothing other than the difference between the finite @xmath0 evolution and the fluid limit . in a forthcoming paper @xcite we will explore more extensively this application , giving precise quantitative measures of these effects adapted for use in `` correcting '' such n - body simulations .",
    "we conclude this paper by commenting on a few possible developments of the perturbative theory we have described here .",
    "firstly the method can evidently also be extended to higher order , just as has been done in the analogous treatment of condensed matter system ( see e.g. @xcite ) .",
    "it is straighforward to generalize eq .   to an expansion to any order .",
    "the @xmath172 component of the force reads : [ expansion_force ] f_()&=&_n=0^__,_1 ",
    "_n^(n)(- ) + & & [ u__1()-u__1()]  [u__n()-u__n( ) ] .",
    "the tensor @xmath291 is a function only of the interaction potential @xmath292 and is given by : [ dynamical_general ] _ , _ 1  _n^(n)()= - _ r= r. the analysis can be followed through at any order in analogy to linear order . transforming to reciprocal space",
    "the problem simplifies , but there is now the added complexity of a coupling of modes .",
    "a first calculation of interest would be to map this description , in the fluid limit , onto the corresponding one at the same order in the fluid lagrangian theory .",
    "this latter treatment has been explored extensively in the cosmological literature and compared in detail with numerical simulations ( see e.g. @xcite and references therein ) .",
    "the study of the corrections to this limit should allow one to get some insight on the interplay of non - linearity ( which is of course also a feature of the fluid model ) and the effects of discreteness .",
    "non - linearity in gravity involves the transfer of power from larger to smaller scales , an effect which is often qualitatively argued to make discreteness effects of less consequence .",
    "one might hope to see such a mechanism at play , if indeed it is there .",
    "the approach presented here may also prove useful in providing insight about the nature of existing approximations to self - gravitating systems which go beyond the simple fluid limit , as it provides an `` exact '' evolution of a self - gravitating finite n - body system in a certain range .",
    "for example approximations have been developed to self - gravitating systems involving pressure terms associated to velocity dispersion ( see e.g. @xcite ) . in principle",
    "these terms can be calculated exactly using our perturbative scheme and the improvement ( if this is the case ) they allow to the approximation of the full evolution better understood .",
    "another direction in which this treatment can be generalised is to the consideration of other initial configurations .",
    "we have analysed here almost exclusively the case of perturbations from a sc lattice , as this is the kind of lattice used in cosmological simulations .",
    "our treatment can easily be generalised to other lattices , and a comparative study of the discreteness effects should be straightforward .",
    "without doing any calculation however one simple and interesting result can be given .",
    "it is known that both the bcc and fcc lattice are stable ( or at least meta - stable ) configurations for the coulomb lattice .",
    "this means that there are no unstable modes . for gravity",
    "this implies that there are _ only _ unstable modes .",
    "there are therefore no oscillating modes , and thus , by the kohn sum rule , no modes with exponent greater than in the fluid limit .",
    "consequently either of these lattices would appear to be better lattices to use in n - body simulations , in which one wishes evidently to approach as closely as possible the fluid evolution .",
    "the bcc lattice would appear to be the more interesting of the two , as it is known to be @xcite the most densely packed lattice .",
    "it is also a more isotropic configuration than either the sc or fcc lattice .",
    "another case of interest to analyse would be that of `` glassy '' configurations , which are often used as an alternative to the sc lattice in cosmological simulations @xcite .",
    "these configurations are generated by simulating a set of point particles evolving under negative gravity ( i.e. coulomb forces ) , with an appropriate damping term . by doing",
    "so one arrives at a configuration in which the forces are very small , but which is more isotropic than the lattice ( in which the forces are exactly zero ) . in the approximation that the initial forces are negligible",
    "one could , in principle , carry out the same kind of analysis as given here .",
    "the only difference is that the @xmath293 eigenmodes of the displacement field will not be plane waves , which greatly complicates the analysis compared to the case of the lattice .",
    "numerically however such a solution should be feasible ( for any specified glassy configuration ) , and it would be necessary if this method is to be used to give a precise quantification of discreteness effects from these ic as we can now give , using the analysis presented here , for the case of a lattice .",
    "we do not expect the results , however , to be very different ( either qualitatively or quantitively ) : the effects described here are essentially sampling effects which depend on the sampling scale ( the lattice spacing @xmath5 above ) and not on the precise nature of the sampling",
    ". the particular manifestation of anisotropy which we have observed in the sc lattice will necessarily be quite different , and likely less pronounced , in the glassy case , but the average slowing down of growth at smaller scales would be expected to be very similar in magnitude .",
    "the ewald sum for the dynamical matrix is given from using the ewald sum for the potential : @xmath294 with @xmath295\\\\\\nonumber & \\times&\\frac{4\\alpha^3}{\\sqrt{\\pi}}\\exp(-\\alpha^2|\\br-\\bn l|^2)\\\\ & + & gm\\sum_{\\bn}\\left[\\frac{\\delta_{\\mu\\nu } } { |\\br-\\bn l|^3}-3\\frac{(\\br-\\bn l)_\\mu ( \\br-\\bn l)_\\nu}{|\\br-\\bn l|^5}\\right]\\\\\\nonumber & \\times&\\left[\\mathrm{erfc}(\\alpha|\\br-\\bn l|)+\\frac{2\\alpha}{\\sqrt{\\pi}}\\exp(-\\alpha^2|\\br-\\bn l|^2)|\\br-\\bn l|\\right]\\end{aligned}\\ ] ] and @xmath296 the @xmath297 term is [ ddiag ] ( = 0)=-_0 ( ) .",
    "note that , by symmetry , only the first term of the r.h.s . of and eq .",
    "contribute in the sum of eq .  .",
    "in the case of pure gravity the result of the sum is given by eq . .",
    "we derive here the kohn sum rule .",
    "multiplying eq .",
    "( [ d_of_phi ] ) by @xmath298 and summing over @xmath299 we obtain , with eq .  : _ n=1 ^ 3_n^2()&=&-n_0_n=1 ^ 3 \\ { w()(_n())^2 + & & + _ 0w(+)^2",
    "+ & & -_0w()^2 } . using the orthogonality relation _",
    "n=1 ^ 3(_n())_(_n())_= _ , we get finally @xcite [ sum_rule ] _",
    "i=1 ^ 3_n^2()&=&-n_0 k^2w ( ) + & & -n_0_0(|+|^2w(+)-k^2w ( ) ) . in the case of gravity , using the same approximation as in eq .",
    "we conclude that _",
    "n=1 ^ 3_n^2()=- n_0k^2w()=4g_0 ."
  ],
  "abstract_text": [
    "<S> * abstract *    we present a perturbative treatment of the evolution under their mutual self - gravity of particles displaced off an infinite perfect lattice , both for a static space and for a homogeneously expanding space as in cosmological n - body simulations . </S>",
    "<S> the treatment , analogous to that of perturbations to a crystal in solid state physics , can be seen as a discrete ( i.e. particle ) generalization of the perturbative solution in the lagrangian formalism of a self - gravitating fluid . </S>",
    "<S> working to linear order , we show explicitly that this fluid evolution is recovered in the limit that the initial perturbations are restricted to modes of wavelength much larger than the lattice spacing . </S>",
    "<S> the full spectrum of eigenvalues of the simple cubic lattice contains both oscillatory modes and unstable modes which grow slightly faster than in the fluid limit . </S>",
    "<S> a detailed comparison of our perturbative treatment , at linear order , with full numerical simulations is presented , for two very different classes of initial perturbation spectra . </S>",
    "<S> we find that the range of validity is similar to that of the perturbative fluid approximation ( i.e. up to close to `` shell - crossing '' ) , but that the accuracy in tracing the evolution is superior . </S>",
    "<S> the formalism provides a powerful tool to systematically calculate discreteness effects at early times in cosmological n - body simulations . </S>"
  ]
}