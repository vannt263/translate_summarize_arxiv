{
  "article_text": [
    "crowd counting , which is defined as the number of people in a crowd , has recently drawn great attention due to its wide application in the field of video surveillance , particularly in public security @xcite . among exsiting approaches @xcite , the regression - based framework that learns",
    "a regression function between image representations and count numbers has gained considerable interest @xcite .",
    "the majority of these works usually construct crowd models from patterns of holistic hand - crafted features @xcite such as foreground segment features , internal edge features and texture features .    despite the success of hand - crafted features for crowd counting ,",
    "there still exists two weaknesses .",
    "firstly , they simply characterize the visual contents without capturing the underlying semantic information , which may lead to unsatisfactory performance . in the literature ,",
    "there is limited work on exploring attribute features for crowd counting .",
    "therefore , it is worth exploring the problem how to improve the discriminative power of feature representations by sufficiently mining the rich semantic information . secondly , the holistic features directly obtained from entire images are typically unable to capture locally spatial information and describe the diversity in the crowd distribution , density and behaviors .",
    "thus , it is important to encode spatial cues into the feature learning process for crowd counting .    in this work",
    ", we attempt to design a novel image representation which takes into consideration semantic attributes as well as spatial cues . in order to characterize the distribution of people number ,",
    "we define semantic attributes at the pixel level and learn the semantic feature map via deep convolutional neural network ( cnn ) .",
    "then , a high - level concept named locality - aware feature ( laf ) in the abstract semantic attribute feature map is presented to describe the spatial information in crowd scenes .",
    "1 shows pixel - level attribute feature maps corresponding to two frames of the ucsd dataset .",
    "every point in the feature map can be expressed as a vector of attributes , each element of which is a certain semantic class probability . after obtaining local descriptors",
    "laf from adjacent sampled cells over the semantic feature map , our pipeline adopts an improved method weighted vlad ( w - vlad ) to encode features into image representations .",
    "compared with the traditional method that directly obtains the image representation by aggregating holistic features @xcite , our pipeline that combines laf with w - vlad is more discrimative for creating instance representations .",
    "it can not only adapt to complex diversity in crowd @xcite , but also retain more useful information .",
    "the comparison between our proposed method and the traditional ones is shown in fig .  2 .",
    "in summary , the main contributions of this paper are as follows .    * for the first time , a pixel - level semantic feature map learned by a deep learning model is constructed for local features extraction . * a novel descriptor named laf is proposed to combine both advantages of explicit semantic incorporation and spatial context encoding . * an improved vlad scheme termed w - vlad is applied for encoding descriptors into the final representation . *",
    "extensive experiments on benchmarks demonstrate the effectiveness of our method , even when people in the frames are hard to identify .    the rest of this paper is organized as follows . after reviewing the related work in section , we introduce semantic locality - aware features in section .",
    "then , the thorough experimental evaluations are carried out in section .",
    "finally , the paper is concluded in section .",
    "* counting methods .",
    "* most previous work on crowd counting can be divided into three categories : counting pedestrians by detection @xcite , clustering @xcite and regression @xcite .",
    "the performance of detection approaches highly depend on the whole pedestrian result which is suppressed in densely crowded scenes with significant occlusion .",
    "clustering - based methods that coherent motion patterns are clustered to estimate the crowd number only work well for video frames at a high rate . considering severe occlusions between people in the crowd scene and the requirements of high efficiency for real applications ,",
    "many researchers utilize regressors trained on low - level features to predict the global counts @xcite .",
    "most of these methods are based on low - level features proposed in @xcite . with the ever - growing data volume and computational capability , deep",
    "learning has begun a useful tool in several surveillance applications such as crowd behavior analysis @xcite and crowd segmentation @xcite .",
    "@xcite firstly try to develop a deep model for predicting crowd number and the superior performance validates that deep feature is more discriminative than shallow hand - craft one .    * attribute learning . *",
    "attributes are mid - level semantic properties of objects which bridge the gap between low - level features and high - level representations @xcite . in recent years",
    ", attribute - based representations that describe a target by multiple attribute classes have been widely used to represent objects @xcite , faces @xcite and actions @xcite .",
    "the common characteristics shared by different scenes can express more information @xcite .",
    "@xcite utilize three attributes `` who '' , `` where '' and `` why '' to describe a crowd scene and successfully apply them to analyze crowd behavior .",
    "_ @xcite propose that attributes and interdependencies among them can help to improve object recognition performance .",
    "@xcite present an action recognition framework built upon a latent svm formulation where latent variables capture the degree of each attribute to its action class .",
    "similarly , a binary cumulative attribute is converted from the count number @xcite , which has realized the crowd counting task effectively . however ,",
    "cumulative attribute , only a coarse description of the crowd distribution , is not sufficient for the natural scene .    *",
    "spatial cues encoding .",
    "* recent works demonstrate that it is vital to describe local features with spatial awareness for minimizing the information loss and improving the discriminative power of representations .",
    "usually holistic representations are sensitive to changes in the external environment @xcite .",
    "et al_. @xcite propose a localized approach that estimates the crowd number within different groups and then obtains the total number by summing up all the group results .",
    "@xcite concatenate features in all sub - regions of an image and propose a multi - output regression model to learn the local count .",
    "@xcite advocate a spatial pyramid pooling ( spp ) layer on the entire convolutional feature map and then generates a fixed - length representation for the following fully - connected layers . with spatial information considered ,",
    "these methods either require manually local counting or lead to representations of huge length",
    ".    * vlad encoder .",
    "* as a simplified version of fv @xcite , vlad @xcite only aggregates the first order information which are displacements between features and the corresponding dictionary element . because of the low computation cost and superior performance , vlad has recently been applied in many applications .",
    "@xcite extract convolutional features from different layers of cnn and apply vlad to encode features into a single vector for image retrieval .",
    "multi - vlad @xcite aims at constructing and matching vlad vectors of multi - level images .",
    "_ @xcite improves vlad by optimizing the dictionary and considering high - order statistics .",
    "the key difference between our approach and previous works is that the input to a regression model is a novel and discriminative representation instead of explicit or implicit usage of the low - level feature @xcite . as shown in the top part of fig .",
    "2 , our proposed approach consists of feature map construction , local feature extraction and encoding . in this section ,",
    "we introduce the three aspects in detail .",
    "we attempt to learn image attributes at the pixel level so that semantic information and the diversity of crowd number are sufficiently described . to the best of our knowledge ,",
    "this is the first work that extracts frame features based on pixel - level attributes of a crowd scene .    inspired by the tremendous success of deep convolutional neural network ( cnn ) in pixel labeling @xcite",
    ", we learn the pixel - wise semantic feature map by an off - the - shelf deeply learned cnn model . in this paper",
    ", the state - of - the - art deep semantic segmentation method @xcite is applied to train a model on the cityscape dataset @xcite , in which each pixel is annotated with labels such as _ person _ , _ road _ , _ tree _ and so on .",
    "developed as a deep hierarchical structure , the learned cnn model processes the raw image pixels with several consecutive convolutional layers and contextual deep crf , the output of which is up - sampled as high - level semantic feature map to model the distribution of people in crowd counting .",
    "specifically , the deeply learned model is utilized as a mapping model @xmath0 , where @xmath1 is the original image in a pixel space , @xmath2 is the corresponding semantic feature map ; notions _",
    "n _ , _ p _ respectively denote the image width , height and the number of defined attribute types .",
    "the pixel - wise _ p _ dimensional vector is the probability of _ p _ attribute classes .    instead of low - level simple intensity or texture information , the deeply learned semantic feature map characterizes each pixel with abstract attributes . as shown in fig .",
    "3 , the attribute information indicates the co - occurrence of visual patterns ( _ e.g. , a person is likely to co - occur with the road _ ) , which can provide abundant information for sufficiently describing the crowd scene .          on one hand , it is computationally inefficient to take vectors of every pixel as features . on the other hand ,",
    "computing a feature vector over the entire pixel - wise probability map may lead to large information loss .",
    "the most common method is region division as he _",
    "@xcite do , by which the image is partitioned into multiple cells and the concatenation of all cell - based pooling results is taken as the feature .",
    "theoretically the finer the region is partitioned , the more information is retained and the longer the final representation is .    in order to obtain a balance between accuracy and computational complexity ,",
    "locality - aware features are proposed in this paper .",
    "the process of laf extraction is shown in the right part of fig .",
    "4 and the procedure is mainly summarized as the following three steps :    \\1 ) given a semantic segmentation feature map @xmath2 , we first partition it into @xmath3 cells from which local features are extracted .",
    "\\2 ) each local feature vector of laf is extracted from each cell , in which spatial pyramid is applied to capture spatial relationship .",
    "the spatial pyramid result of each cell is obtained by concatenating and normalizing the @xmath4 mean pooling vectors where @xmath4 is the partition number of a cell . if @xmath5 is defined as the number of attribute classes , then the local feature in each cell is expressed as @xmath6 , where @xmath7 .",
    "the feature vector @xmath8 is able to capture the co - occurrence of different semantic attributes .",
    "\\3 ) finally feature vectors of all cells are aggregated as laf , which can be denoted as : @xmath9\\in   \\mathbb{r}^{d \\times \\emph{n } } ,      1\\leq \\emph{i } \\leq \\emph{n}\\ ] ] where @xmath10 is the number of laf ( namely the number of partitioned cells ) in the image and @xmath11 is the feature vector of the _ i - th _ cell .",
    "in contrast to the spp feature extraction @xcite which only incorporates the coarse spatial cues at the image level , the set of all @xmath3 cell - based features are simultaneously and equally used for subsequent feature encoding ; spatial pyramid used in laf is able to maximize the use of local spatial information and characterize context clues . in a word ,",
    "laf have advantages of capturing finer location information by localized spatial pyramid and controlling the vector length by aggregating local features .",
    "the encoder is utilized to encode a set of low - dimensional local descriptors ( laf here ) to a single compact vector . given a video frame , we first extract laf @xmath12\\in   \\mathbb{r}^{d \\times \\emph{n}}$ ] described above .",
    "let @xmath13 $ ] be projected features related to @xmath14 by pca+whitening for better performance @xcite and @xmath15\\in r^{d\\times k}$ ] is the corresponding dictionary learned offline by k - means .",
    "the original version of vlad is expressed as follows :    @xmath16    the final representation is gained by concatenating the all @xmath17 vectors with normalization followed .",
    "it can be easily seen from the formula ( 2 ) that the weights for all residuals are assigned binary values 0 or 1 .",
    "we try to modify the original vlad into w - vlad .",
    "the formula ( 2 ) is extended to an alternative form , which is shown in ( 3 ) : @xmath18    for the standard vlad , the assignment coefficients @xmath19 can be defined as follows :    @xmath20    on one hand , the assignment method in ( 4 ) is similar to hard - assignment coding @xcite , which may result in relatively high reconstruction error while coding .",
    "on the other hand , the coefficient @xmath19 here can be interpreted as the degree of local feature @xmath21 to cluster center @xmath22 .",
    "in fact , different features may have different relevance to the clusters and it is unreasonable to apply the same weight coefficients even though they are assigned to the same cluster word with the same residual value .    in this paper , we utilize local soft assignment coding ( lsac ) @xcite to compute weights for effectiveness and simplicity :    @xmath23    @xmath24    where @xmath25 denotes the @xmath26 nearest neighbors of @xmath27 in the dictionary and @xmath28 is the smoothing factor controlling the softness of the assignment .",
    "* datesets . * in order to explore whether our method is effective for the dataset in which persons are not easy to identify , we introduce a new dataset caltech 10x ( caltech ) @xcite ( originally utilized for pedestrian detection ) besides the shopping mall dataset ( mall ) @xcite and the established ucsd pedestrian ( ucsd ) @xcite . as shown in fig . 5 , different from mall and ucsd dataset , persons in some frames from caltech are not clearly visible .",
    "we evaluate the proposed approach on the three datasets in this study for comparative evaluation .",
    "table describes the details of all mentioned datasets .",
    "@xmath29 means the frame number , d shows the range of crowd number in a frame roi , and @xmath30 indicates the total number of labeled pedestrians .",
    ".the details of three datasets . [ cols=\"^,^,^,^,^,^,^,^\",options=\"header \" , ]     quantitative results of crowd counting on caltech dataset and that of our method are reported in table .",
    "first , we extract lbp features to predict the crowd number , the corresponding results of which are shown in the top row .",
    "our method only beats lfv by a minor margin .",
    "the possible reason is that for the complicated caltch dataset different weight assignments may be not as important as those for easier datasets such as mall and ucsd .",
    "the comparison results shown in table verify the superiority of our learned representation .",
    "in this paper , we introduce a novel method to obtain representations for crowd frames .",
    "this is the first work that attempts to utilize pixel - wise attribute feature map to describe a crowd scene . completely different from previous features , locality - aware features with spatial cues ( laf )",
    "are extracted from the dense attribute feature map , which has better capability for describing semantic context information in crowd scenes .",
    "we further apply an improved version of vlad , namely w - vlad , which considers different coefficient weights for deviations between descriptors and clusters . the discriminative power and effectiveness of our proposed method",
    "are validated on three benchmarks .",
    "this work is supported by national natural science foundation ( nnsf ) of china under grant .",
    "61473086 , 61375001 partly supported by the open fund of key laboratory of measurement and partly supported by control of complex systems of engineering , ministry of education ( no .",
    "mccse2013b01 ) , the nsf of jiangsu province ( grants no bk20140566 , bk20150470 ) and china postdoctoral science foundation ( 2014m561586 ) .",
    "d. ryan , s. denman , c. fookes , and s. sridharan .",
    "crowd counting using multiple local features . in _ proc .",
    "digital image computing : techniques and applications _ , 2009 . c. zhang , h. li , x. wang , x. yang .",
    "cross - scene crowd counting via deep convolutional neural networks . in _ proc .",
    "ieee conf . comp .",
    "vision and pattern recognition _ , 2015 .",
    "brostow , r. cipolla .",
    "unsupervised bayesian detection of independent motion in crowds . in _ proc .",
    "ieee conf .",
    "comp . vision and pattern recognition _ , 2006 .",
    "p. dollar , c. wojek , b. schiele , p.perona .",
    "pedestrian detection : an evaluation of the state of the art .",
    "_ ieee trans .",
    "pattern analysis and mach .",
    "intelligence_. vol .",
    "743 - 761 , 2012 .",
    "v. rabaud , s. belongie . counting crowded moving objects . in _ proc .",
    "ieee conf .",
    "comp . vision and pattern recognition _ , 2006 .",
    "chan , n. vasconcelos .",
    "counting people with low - level features and bayesian regression .",
    "_ ieee trans . image process .",
    "4 , pp . 2160 - 2177 , 2012 .",
    "c. loy , k. chen , s. gong , t. xiang .",
    "crowd counting and profiling : methodology and evaluation . _",
    "modeling , simulation and visual analysis of crowds .",
    "347 - 382 , 2013 .",
    "a. davies , j. yin , s. velastin .",
    "crowd monitoring using image processing .",
    "_ electronics&communication engineering journal_. vol . 7 , no .",
    "1 , pp . 3747 , 1995 .",
    "chan , z .- s .",
    "j. liang , and n. vasconcelos .",
    "privacy preserving crowd monitoring : counting people without people models or tracking . in _ proc .",
    "ieee conf .",
    "comp . vision and pattern recognition _ , 2008 .",
    "k. chen , c. c. loy , s. gong , and t. xiang .",
    "feature mining for localised crowd counting . in _ proc .",
    "british mach .",
    "vision conf .",
    "_ , 2012 . j. long , e. shelhamer , t. darrellfully .",
    "convolutional networks for semantic segmentation . in _ proc .",
    "ieee conf .",
    "comp . vision and pattern recognition _ , 2015 .",
    "l. chen , g. papandreou , i. kokkinos , k. murphy , a. yuille .",
    "semantic image segmentation with deep convolutional nets and fully connected crfs . in _ int .",
    "representations _ , 2015 .",
    "g. lin , c. shen , i. reid , a. hengel .",
    "efficient piecewise training of deep structured models for semantic segmentation . in _ proc .",
    "ieee conf .",
    "vision and pattern recognition _ , 2016 .",
    "k. chen , s. gong , t. xiang , and c. c. loy .",
    "cumulative attribute space for age and crowd density estimation . in _ proc .",
    "ieee conf .",
    "comp . vision and pattern recognition _ , 2013 .",
    "x. wu , g. liang , k.k .",
    "lee , and y. xu .",
    "crowd density estimation using texture analysis and learning . in _",
    "ieee international conference on robotics and biomimetics _ , 2006 .",
    "h. jegou , f. perronnin , m. douze , j. sanchez , p. perez , and c.schmid . aggregating local image descriptors into compact codes .",
    "_ ieee trans .",
    "pattern analysis and mach .",
    "intelligence_. vol .",
    "9 , pp . 4 - 6 , 2012 . m. li , z. zhang , k. huang , and t. tan .",
    "estimating the number of people in crowded scenes by mid based foreground segmentation and head - shoulder detection . in _ proc .",
    "conf . pattern recognition _ , 2008 .",
    "t. zhao , r. nevatia , and b. wu . segmentation and tracking of multiple humans in crowded environments .",
    "_ ieee trans . pattern analysis and mach .",
    "intelligence_. vol .",
    "1198 - 1211 , 2008 .",
    "g. guo , y. fu , c. dyer , and t. huang .",
    "image - based human age estimation by manifold learning and locally adjusted robust regression .",
    "_ ieee trans .",
    "image process._. vol .",
    "17 , no . 7 , pp . 1178 - 1188 , 2008 .",
    "h. rahmalan , m. nixon , and j. carter . on crowd density estimation for surveillance .",
    "in _ the institution of engineering and technology conference on crime and security _ , 2006 .",
    "j. shao , k. kang , c. c. loy , and x. wang . deeply learned attributes for crowded scene understanding .",
    "in _ proc .",
    "ieee conf .",
    "comp . vision and pattern recognition _ , 2015 .",
    "c. castellano , s. fortunato , and v. loreto",
    ". statistical physics of social dynamics .",
    "_ reviews of modern physics_. vol .",
    "2 , pp . 591 , 2009 .",
    "k. kang , x. wang .",
    "fully convolutional neural network for crowd segmentation . in _ proc .",
    "ieee conf . comp .",
    "vision and pattern recognition _ , 2015 .",
    "t. l. berg , a. c. berg , and j. shih .",
    "automatic attribute discovery and characterization from noisy web data . in _ proc .",
    "comp . vision _ , 2010 .",
    "n. kumar , a. c. berg , p. n. belhumeur , and s. k. nayar . attribute and simile classifiers for face verification . in _ proc .",
    "conf . comp . vision _",
    "y. fu , t. m. hospedales , t. xiang , and s. gong .",
    "attribute learning for understanding unstructured social activity . in _ proc .",
    "conf . comp .",
    "vision_. 2012 .",
    "j. krapac , j. verbeek , f. jurie , modeling spatial layout with fisher vectors for image . in _ proc .",
    "comp . vision _ , 2011 .",
    "h. jegou , f. perronnin , m. douze , j. sanchez , p. perez , and c.schmid , aggregating local image descriptors into compact codes .",
    "_ ieee trans",
    ". pattern analysis and mach .",
    "intelligence_. vol .",
    "9 , pp . 4 - 6 , 2012 . k. liang , h. chang , s. shan , x. chen . a unified multiplicative framework for attribute learning . in _ proc .",
    "conf . comp . vision _ , 2015 .",
    "j. delhumeau , p. gosselin , h. jgou , p. prez . revisiting the vlad image representation . in _",
    "acm multimedia _ , 2013 .",
    "l. liu , l. wang , x. liu , in defense of soft - assignment coding . in _ proc .",
    "conf . comp .",
    "vision _ , 2011 .",
    "a. chan and n. vasconcelos .",
    "counting people with low - level features and bayesian regression .",
    "_ ieee trans .",
    "image process._. vol .",
    "4 , no . 21 , pp . 2160 - 2177 , 2012 .",
    "x. wu , g. liang , k.k .",
    "lee , and y. xu .",
    "crowd density estimation using texture analysis and learning . in _ ieee international conference on robotics and biomimetics _ , 2006 .",
    "x. peng , l. wang , x. wang , y. qiao .",
    "bag of visual words and fusion methods for action recognition .",
    "comprehensive study and good practice .",
    "corr abs/1405.4506 ( 2014 ) .",
    "y. wang and g. mori . a discriminative latent model of object classes and attributes .",
    "in _ proc .",
    "comp . vision _ , 2010 .",
    "j. liu , b. kuipers , s. savarese .",
    "recognizing human actions by attributes . in _ proc .",
    "ieee conf .",
    "comp . vision and pattern recognition _ , 2011 .",
    "k. he , x. zhang , s. ren , j. sun .",
    "spatial pyramid pooling in deep convolutional networks for visual recognition . in _ proc .",
    "comp . vision _ , 2014 .",
    "m. cordts , m. omran , s. ramos , t. rehfeld , m. enzweiler , r. benenson , u. franke , s. roth , and b. schiele .",
    "the cityscapes dataset for semantic urban scene understanding . in _ proc .",
    "ieee conf . comp .",
    "vision and pattern recognition _ , 2016 .",
    "x. peng , l. wang , y. qiao , q. peng . boosting vlad with supervised dictionary learning and high - order statistics . in _ proc .",
    "comp . vision _ , 2014 .",
    "r. arandjelovic and a. zisserman .",
    "all about vlad . in _ proc .",
    "ieee conf .",
    "vision and pattern recognition _ , 2013 .",
    "ng , f.yang , l. s. davis . exploiting local features from deep networks for image retrieval . in _ proc .",
    "ieee conf .",
    "comp . vision and pattern recognition _ ,"
  ],
  "abstract_text": [
    "<S> crowd counting is an important task in computer vision , which has many applications in video surveillance . although the regression - based framework has achieved great improvements for crowd counting , how to improve the discriminative power of image representation is still an open problem . </S>",
    "<S> conventional holistic features used in crowd counting often fail to capture semantic attributes and spatial cues of the image . in this paper </S>",
    "<S> , we propose integrating semantic information into learning locality - aware feature sets for accurate crowd counting . </S>",
    "<S> first , with the help of convolutional neural network ( cnn ) , the original pixel space is mapped onto a dense attribute feature map , where each dimension of the pixel - wise feature indicates the probabilistic strength of a certain semantic class . </S>",
    "<S> then , locality - aware features ( laf ) built on the idea of spatial pyramids on neighboring patches are proposed to explore more spatial context and local information . </S>",
    "<S> finally , the traditional vlad encoding method is extended to a more generalized form in which diverse coefficient weights are taken into consideration . </S>",
    "<S> experimental results validate the effectiveness of our presented method . </S>"
  ]
}