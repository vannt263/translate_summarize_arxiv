{
  "article_text": [
    "in the ab - initio quantum mechanical modeling of many - particle systems , kohn - sham density functional theory ( dft ) @xcite achieves so far the best compromise between accuracy and computational cost , and has become the most widely used electronic structure model in molecular simulations and material science . within the traditional kohn - sham formulation",
    ", the ground state energy and electron density of an @xmath2-electron system can be obtained by minimizing the energy functional @xmath3 = \\int_{\\mathbb{r}^3 } \\left ( \\frac{1}{2}\\sum_{i=1}^{n}|\\nabla\\phi_i({\\bf r})|^2 + v_{\\rm ext}({\\bf r})\\rho({\\bf r } ) ] \\right ) d{\\bf r } + e_{\\rm h}[\\rho ] + e_{\\rm xc}[\\rho]\\ ] ] with respect to orbitals @xmath4 under the constraint @xmath5 . here",
    ", @xmath6 is the electron density , @xmath7 is the electrostatic attraction potential generated by the nuclei , @xmath8=\\frac{1}{2}\\int_{\\mathbb{r}^3}\\int_{\\mathbb{r}^3}\\frac{\\rho({\\bf r})\\rho({\\bf r ' } ) } { |{\\bf r}-{\\bf r'}|}d{\\bf r}d{\\bf r'}$ ] is the hartree energy that describes electron - electron coulomb repulsion energy by a mean field approximation , and @xmath9 $ ] is the so - called exchange - correlation energy functional that includes all the many - particle interactions .",
    "the major drawback of dft is the fact that the exact functional for the exchange - correlation energy is not known .",
    "a basic model is local density approximation ( lda ) @xcite , which is still commonly used in practical calculations .",
    "improvements of this model give rise to the generalized gradient approximation ( gga ) @xcite and hybrid functionals @xcite .",
    "although these models have achieved high accuracy for many chemical and physical systems , there remain well - known limitations .",
    "for example , in systems with significant static correlation @xcite , lda , gga , and also hybrid functionals underestimate the magnitude of the correlation energy .",
    "this becomes particularly problematic for the dissociation of electron pair bonds .",
    "a famous example is the dissociating h@xmath1 molecule : the widely employed lda , gga , and even hybrid models fail rather badly at describing the energy curve for dissociating h@xmath1 .",
    "many efforts have been made in order to make an appropriate ansatz for the exchange - correlation functional and tackle this problem ( e.g. , @xcite ) . in our view , a principal deficiency of these works is the attempt to describe strong correlation within the framework of mean field approximations .",
    "alternatively , dft calculations can also be based on the strongly interacting limit of the hohenberg - kohn density functional , denoted `` strictly correlated electrons '' ( sce ) dft @xcite .",
    "this approach considers a reference system with complete correlation between the electrons , and is able to capture key features of strong correlation within the kohn - sham framework .",
    "the pioneering work @xcite has shown that the sce ansatz can describe certain model systems in the extreme strongly correlated regime with higher accuracy than standard kohn - sham dft .",
    "however , the calculations are presently limited to either one - dimensional or spherically symmetric systems . to our knowledge",
    ", there is no sce - dft calculation for dissociating the h@xmath1 molecule in @xmath10 .    in the sce - dft model ,",
    "the repulsion energy between strongly interacting electrons is related to optimal transport theory .",
    "optimal transport was historically studied in @xcite to model the most economical way of moving soil from one area to another , and was further generalized in @xcite to the kantorovich primal and dual formulation .",
    "the goal is to transfer masses from an initial density @xmath11 to a target density @xmath12 in an optimal way such that the `` cost '' @xmath13 for transporting mass from @xmath14 to @xmath15 is minimized ( see @xcite for a comprehensive treatment )",
    ". the coulomb repulsion energy in the sce - dft model can be reformulated as the optimal cost of an optimal transport problem , if we identify the marginals with the electron density divided by number of electrons , i.e. , @xmath16 , and the cost function with the electron - electron coulomb repulsion @xmath17 for instance , for a two - electron system within the sce - dft framework , the electron repulsion energy for a given single - particle electron density @xmath18 is @xmath19 = \\min_{\\psi } \\bigg\\ { \\int_{\\mathbb{r}^6}\\frac{|\\psi({\\bf r}_1,{\\bf r}_2)|^2}{|{\\bf r}_1-{\\bf r}_2| } d{\\bf r}_1 d{\\bf r}_2 , \\\\",
    "\\int_{\\mathbb{r}^3}|\\psi({\\bf r}_1,{\\bf r})|^2d{\\bf r}_1 = \\int_{\\mathbb{r}^3}|\\psi({\\bf r},{\\bf r}_2)|^2d{\\bf",
    "r}_2 = \\frac{\\rho({\\bf r})}{2 } \\bigg\\}. \\quad\\end{gathered}\\ ] ] strictly speaking , the set of admissible @xmath20 s must be enlarged to probability measures in order to allow strict correlation , which corresponds to concentration of the many - body probability density on a lower dimensional subset @xcite .",
    "there are several mathematical investigations of the relations between sce - dft and optimal transport problems , see @xcite , but important open problems remain . to our knowledge ,",
    "the functional derivative of the sce functional ( alias optimal cost functional ) with respect to the electron density ( alias marginal measure ) is not clear from a mathematical point of view .",
    "however , this result is crucial for deriving the kohn - sham equations needed in practical calculations .",
    "numerical algorithms for optimal transport problems are rather sparse .",
    "explicit solutions for the co - motion functions are known for one - dimensional and spherically symmetric problems @xcite , but can not be generalized to two- and three - dimensional systems",
    ". an alternative route might be the kantorovich dual formulation of the sce functional @xcite . in a complementary work @xcite ,",
    "the h@xmath1 molecule is studied using an ansatz for the dual potential , and there is a recent simulation of a one - dimensional model h@xmath1 molecule using the sce framework @xcite .    in this paper , we give a mathematical derivation of the kohn - sham equations for optimal transport - based dft which is rigorous up to physically expected smoothness and continuity assumptions ( section  [ section - ks ] ) , provide an efficient numerical algorithm for discretising and solving the resulting optimal transport problem for the case of two electrons without restriction to radial symmetry ( section  [ section - numerical ] ) , and then apply this algorithm to a self - consistent dft simulation of the h@xmath1 molecule in the dissociating limit ( section  [ section - h2 ] ) . finally , we show both numerically and by a rigorous mathematical argument that the sce - dft model is accurate for the h@xmath1 molecule in the dissociating limit .",
    "consider a molecular system with @xmath21 nuclei of charges @xmath22 , located at positions @xmath23 , and @xmath2 electrons in the non - relativistic setting .",
    "the electrostatic potential generated by the nuclei is @xmath24 within the dft framework @xcite , the ground state density and energy of the system is obtained by solving the following minimization problem @xmath25+\\int_{\\mathbb{r}^3}v_{\\rm ext}\\rho , ~",
    "\\rho\\geq 0,~\\sqrt{\\rho}\\in h^1(\\mathbb{r}^3),~\\int_{\\mathbb{r}^3}\\rho = n \\bigg\\},\\ ] ] where @xmath18 is the electron density and @xmath26 $ ] is the so - called hohenberg - kohn functional @xcite .",
    "@xmath27 is a universal functional of @xmath18 in the sense that it does not depend on the external potential @xmath7 .",
    "unfortunately , no tractable expression for @xmath27 is known that could be used in numerical simulations .",
    "the standard kohn - sham dft @xcite treats the system as @xmath2 non - interacting electrons , and approximates @xmath26 $ ] by a summation of the kinetic energy @xmath28 = \\inf\\bigg\\ { \\frac{1}{2}\\sum_{i=1}^n \\int_{\\mathbb{r}^3}|\\nabla\\phi_i({\\bf r})|^2 d{\\bf r } , ~ \\phi_i\\in h^1(\\mathbb{r}^3 ) , \\\\ ~ \\sum_{i=1}^n|\\phi_i({\\bf r})|^2 = \\rho({\\bf r}),~\\int_{\\mathbb{r}^3}\\phi_i\\phi_j = \\delta_{ij } \\bigg\\ } , \\quad\\end{gathered}\\ ] ] the hartree energy @xmath8 $ ] , and an exchange - correction energy @xmath9 $ ] , as shown in eq .  .",
    "since the standard non - interacting model can not capture the features that result from strong correlation , it is not able to simulate strongly correlated electron systems , like the h@xmath1 molecule in its dissociating limit .",
    "in contrast to that , the sce - dft model @xcite starts from the strongly interacting limit ( semi - classical limit ) of @xmath27 , and gives rise to the following sce functional ( see @xcite for a mathematical justification ) @xmath29 = \\inf \\big\\ { v_{\\rm ee}[\\rho_n ] , ~\\rho_n({\\bf r}_1,\\dots,{\\bf r}_n)\\geq 0,~\\rho_n~{\\rm is~symmetric},~\\rho_n\\mapsto\\rho \\big\\},\\ ] ] where @xmath30 = \\int_{\\mathbb{r}^{3n}}\\sum_{1\\leq i",
    "< j\\leq n } \\frac{\\rho_n({\\bf r}_1,\\dots,{\\bf r}_n)}{|{\\bf r}_i-{\\bf r}_j| } d{\\bf r}_1\\cdots d{\\bf r}_n,\\ ] ] and @xmath31 means that @xmath18 is the marginal distribution of @xmath32 , that is to say @xmath33 the minimization in eq .",
    "is over all symmetric @xmath2-point probability measures @xmath32 which have the given single - particle density @xmath18 as marginal , and yields the minimum of the electronic coulomb repulsion energy over all such @xmath32 .",
    "the sce - dft model takes @xmath34 $ ] as the only interaction term , replacing @xmath8+e_{\\rm xc}[\\rho]$ ] in standard kohn - sham dft .",
    "the minimization task is in fact an optimal transport problem with coulomb cost @xcite , which has two alternative formulations : the monge formulation and the kantorovich dual formulation . for the monge formulation ,",
    "one uses the ansatz @xmath35 with @xmath36 the so - called co - motion functions ( also called optimal transport maps ) , where we use the convention @xmath37 .",
    "the above ansatz already appears on physical grounds , without reference to optimal transport theory , in @xcite .",
    "since the @xmath2-particle distribution @xmath32 in is zero everywhere except on the set @xmath38 it describes a state where the location of one electron fixes all the other @xmath39 electrons through the co - motion functions @xmath40 , @xmath41 .",
    "the co - motion functions are implicit functionals of the density , determined by the minimization problem and a set of differential equations that ensure the invariance of the density under the coordinate transformation @xmath42 @xcite , i.e. , @xmath43 in terms of these functions , the optimal value of reads @xmath44 = \\frac{1}{n}\\int_{\\mathbb{r}^3 } \\sum_{1\\leq",
    "i < j\\leq n}\\frac{\\rho({\\bf r})}{|t_i({\\bf r})-t_j({\\bf r})|}d{\\bf r}.\\ ] ] note that the ansatz is not in general symmetric under exchanging particle coordinates , nevertheless , dropping the symmetrization does not alter the minimum value of .",
    "alternatively , one can start from the so - called kantorovich dual formulation @xcite .",
    "it has been shown in @xcite that the value of @xmath45 $ ] is exactly given by the maximum of this kantorovich dual problem @xmath46 = \\max\\bigg\\{\\int_{\\mathbb{r}^3}u({\\bf r})\\rho({\\bf r})d{\\bf r},~ \\sum_{i=1}^{n}u({\\bf r}_i)\\leq\\sum_{1\\leq i < j\\leq n}\\frac{1}{|{\\bf r}_i-{\\bf r}_j| } \\bigg\\}.\\ ] ] in what follows , we denote the maximizer of by @xmath47 , which is called the kantorovich potential .",
    "we assume that @xmath47 is unique and depends continuously on @xmath18 in the sense that @xmath48    for numerical implementations , the kantorovich dual formulation has high complexity due to the @xmath49-dimensionality of the constraints . in comparison ,",
    "the monge formulation amounts to a spectacular dimension reduction , in which the unknowns are @xmath39 maps on @xmath10 instead of one function @xmath32 on @xmath50 . however ,",
    "for practical purposes it is currently restricted to spherically symmetric densities and one - dimensional systems , for which the constraints can be solved semi - analytically .",
    "our purpose is to construct an efficient numerical discretization of the monge formulation for @xmath0 electrons which is applicable to non - spherical systems .",
    "by taking @xmath51 as the only interaction term within the kohn - sham dft framework , we can obtain the ground state approximations of energy and electron density by solving the following minimization problem @xmath52 , ~\\phi_i\\in h^1(\\mathbb{r}^3),~\\int_{\\mathbb{r}^3}\\phi_i\\phi_j=\\delta_{ij}\\right\\},\\ ] ] where @xmath53 denotes the kohn - sham orbitals and @xmath54=\\frac{1}{2}\\sum_{i=1}^{n } \\int_{\\mathbb{r}^3}|\\nabla\\phi_i({\\bf r})|^2d{\\bf r } + \\int_{\\mathbb{r}^3}v_{\\rm ext}({\\bf r})\\rho_{\\phi}({\\bf r})d{\\bf r } + v_{\\rm ee}^{\\rm sce}[\\rho_{\\phi}]\\ ] ] with @xmath55 .",
    "we shall derive the self - consistent kohn - sham equations for in this section .",
    "the key point is to calculate the functional derivative of the sce functional @xmath56 / \\delta\\rho$ ] with respect to the single particle density @xmath18 , which is the effective one - body potential coming from the interaction term @xmath34 $ ] . in the derivation below , we make various plausible assumptions on the kantorovich potential such as uniqueness , continuous dependence on the density , and differentiability at relevant points .",
    "we believe these assumptions to be correct except possibly in exceptional situations . a fully rigorous treatment without these assumptions would be desirable , but lies beyond the scope of this paper .",
    "note that the functional @xmath34 $ ] is not defined on arbitrary densities , but only on those with @xmath57 .",
    "therefore , the definition of the functional derivative only specifies its integral against perturbations in the corresponding `` tangent space '' , that is to say perturbations that have integral zero : @xmath58}{\\delta\\rho}\\cdot\\tilde{\\rho } = \\lim_{\\varepsilon\\rightarrow0}\\frac{v_{\\rm ee}^{\\rm sce}[\\rho+\\varepsilon\\tilde{\\rho } ] -v_{\\rm ee}^{\\rm sce}[\\rho]}{\\varepsilon } \\quad{\\rm for~all}~\\tilde{\\rho}~{\\rm with}~\\int_{\\mathbb{r}^3}\\tilde{\\rho}=0.\\ ] ] the following theorem indicates that the functional derivative is nothing but the kantorovich potential @xmath47 with an additive constant .",
    "[ theo - derivative ] assume that the maximizer @xmath47 of is unique and depends continuously on the electron density @xmath18 in the sense of .",
    "then @xmath59=\\delta v_{\\rm ee}^{\\rm sce}[\\rho]/\\delta\\rho$ ] is a functional derivative of @xmath51 at point @xmath18 in the sense of if and only if @xmath60=u_{\\rho}+c \\quad\\text{for any constant } c.\\ ] ]    for any given single - particle density @xmath18 with @xmath57 , and any perturbation @xmath61 with @xmath62 , we define @xmath63 -v_{\\rm ee}^{\\rm sce}[\\rho]}{\\varepsilon}.\\ ] ] for simplicity , we assume @xmath64 .",
    "we have from that @xmath65 using the fact that @xmath66 and @xmath47 are maximizers of with electron density @xmath67 and @xmath18 respectively , we have @xmath68 substituting into gives @xmath69 under the uniqueness and continuity assumption , the right - hand side of converges to the left - hand side as @xmath70 .",
    "hence , for any @xmath61 with @xmath62 , @xmath71 exists and equals @xmath72 .",
    "this together with definition leads to @xmath59=u_{\\rho}$ ] .",
    "note that the map @xmath73}{\\delta\\rho}\\tilde{\\rho}$ ] is unique up to an additive constant since @xmath62 .",
    "therefore , the functional derivative viewed as a function can be modified by any additive constant @xmath74 .",
    "this completes the proof .",
    "the kantorovich potential @xmath47 is related to the co - motion functions in the monge formulation , as noted and justified in @xcite . in what follows",
    ", we give a more mathematical derivation of this relation , which avoids the interpretation of the effective potential as a lagrange multiplier and clarifies the relationship between the variational principle , introduced in @xcite , and the kantorovich dual variational principle .",
    "note that the interpretation of the effective potential as a lagrange multiplier coming from the marginal constraint is heuristically correct , but difficult to make rigorous , the difficulties being related to the notorious `` @xmath75-representability - problem '' , as will be discussed elsewhere .",
    "[ theo - potentials ] let @xmath32 be the minimizer of the optimal transport problem with given single - particle density @xmath18 .",
    "if @xmath47 is the kantorovich potential , i.e. , the maximizer of , and @xmath76 is differentiable , then @xmath77 in particular , if @xmath32 is of the monge form , then @xmath78    we first note that @xmath34 $ ] is convex . to see this ,",
    "let @xmath18 be a convex combination @xmath79 for some @xmath80 , and @xmath81 , @xmath82 be the minimizers of corresponding to the single - particle densities @xmath11 and @xmath12 , we have @xmath83\\leq ( 1-t)v_{\\rm ee}[\\rho_n^a]+tv_{\\rm ee}[\\rho_n^b ] = ( 1-t)v_{\\rm ee}^{\\rm sce}[\\rho_a]+tv_{\\rm ee}^{\\rm sce}[\\rho_b].\\ ] ]    since @xmath34 $ ] is convex , it equals its double legendre transform .",
    "denoting the legendre transform of a functional @xmath84 by @xmath85 , we have @xmath86=\\max_{\\rho}\\left(\\int_{\\mathbb{r}^3}v\\rho - v_{\\rm ee}^{\\rm sce}[\\rho]\\right).\\ ] ] by combining the maximization over @xmath18 and minimization over @xmath31 in , we have @xmath87 & = \\min_{\\rho}\\left(v_{\\rm ee}^{\\rm sce}[\\rho]-\\int_{\\mathbb{r}^3}v\\rho\\right ) \\\\ & = \\min_{\\rho}\\min_{\\rho_n\\mapsto\\rho } \\left(\\int_{\\mathbb{r}^{3n}}c_{\\rm ee}\\rho_n - \\int_{\\mathbb{r}^3}v\\rho\\right ) \\\\ & = \\min_{\\rho_n\\mapsto\\rho } \\int_{\\mathbb{r}^{3n}}\\rho_n({\\bf r}_1,\\dots,{\\bf r}_n ) \\left(c_{\\rm ee}({\\bf r}_1,\\dots,{\\bf r}_n)-\\sum_{i=1}^n v({\\bf r}_i)\\right ) .",
    "\\end{split}\\ ] ] then the double legendre transform is @xmath88=\\max_v\\left(\\int_{\\mathbb{r}^3}v\\rho - v_{\\rm ee}^{\\rm sce*}[v]\\right).\\ ] ] combining , , and the fact that @xmath51 equals its double legendre transform results in the following variational principle @xmath89 = \\max_v\\left ( \\int_{\\mathbb{r}^3}v\\rho + \\min_{\\rho_n}\\int_{\\mathbb{r}^{3n}}\\big(c_{\\rm ee}-\\sum_{i=1}^n v({\\bf r}_i)\\big)\\rho_n \\right).\\ ] ] note that the constraint @xmath31 has been eliminated in . for any fixed @xmath75 , let @xmath90 .",
    "the inner variational principle of reads @xmath91 since @xmath92 is a pure multiplicative operator , it follows ( provided @xmath75 is differentiable ) that the support of any minimizer @xmath32 must be contained in the set of absolute minimizers of @xmath92 . note that on the latter set , @xmath93 .",
    "therefore , we have @xmath94 for @xmath95 .    according to lemma  [ lemma - outersgs ] in the appendix ,",
    "if @xmath96 is a maximizer of , then the corresponding minimizer @xmath97 of the inner optimization of is exactly the minimizer of the original problem .",
    "therefore , implies that if @xmath97 is a minimizer of , and @xmath96 is differentiable , then @xmath98    in order to obtain , it is now only necessary to show that @xmath99 with some constant @xmath100 .",
    "note that the maximum value of is invariant under changing @xmath75 by an additive constant , because the two integrals involving @xmath75 cancel .",
    "therefore , the maximization over @xmath75 in may be restricted to @xmath75 s with the additional property @xmath101 for these @xmath75 s , the minimization over @xmath32 in can be carried out explicitly ( just place the the support of @xmath32 at the global minimizers of @xmath92 ) .",
    "it then follows from that @xmath102 = \\max\\left\\{\\int_{\\mathbb{r}^3}v\\rho,~v~{\\rm satisfies}~\\eqref{proof-1-d}\\right\\}.\\ ] ] since @xmath103 is increasing as a function of the additive constant @xmath74 , condition can be changed into the inequality @xmath104 without affecting the maximal value in .",
    "this yields the kantorovich dual form .",
    "therefore , any maximizer of satisfies that @xmath99 with some constant @xmath100 , which together with implies .",
    "if the minimizer of is of the monge form , then we have @xmath105 with @xmath21 given by .",
    "this implies and completes the proof .    since the coulomb cost function @xmath106 is given by , eq .",
    "is reduced to the following relation according to theorem  [ theo - potentials ] ( see also @xcite ) @xmath107 in case @xmath108 , there is only one co - motion function @xmath109 , and @xmath110 note that solving this equation for @xmath111 gives an instance of the celebrated gangbo - mccann formula @xcite for the optimal map in terms of the kantorovich potential . for",
    "the coulomb cost this formula takes the form @xcite @xmath112 however , unlike , formula generalizes ( in the form of ) to many - body or multi - marginal problems .",
    "thus formula should be viewed as the correct generalization of the gangbo - mccann formula to multi - marginal problems .",
    "we note that our derivation did not make use of coulombic features of the cost ; the same arguments yield a version of eq .   for general pair costs of form @xmath113 , or eq .",
    "for fully general costs .",
    "using theorem [ theo - derivative ] and [ theo - potentials ] , we can derive the kohn - sham equations corresponding to the sce energy functional with a computable effective potential .",
    "it is the euler - lagrange equation corresponding to this minimization problem ( after a unitary transformation to diagonalize the symmetric @xmath114 matrix of lagrange multipliers ) : find @xmath115 such that @xmath116\\big ) \\phi_i & = & \\lambda_i\\,\\phi_i\\quad \\text{in}\\quad\\mathbb{r}^3 , \\quad i=1,2,\\dots , n , \\\\[1ex ] \\displaystyle \\int_{\\mathbb{r}^3}\\phi_i\\,\\phi_j & = & \\delta_{ij}. \\end{array } \\right.\\ ] ] this is a nonlinear eigenvalue problem , where the potential @xmath117 $ ] depends on the electron density @xmath118 associated with the orbitals @xmath119 . a self - consistent field",
    "( scf ) iteration algorithm is commonly resorted to for this nonlinear problem . in each iteration step of the algorithm ,",
    "a new effective potential is constructed from a trial electron density and a linear eigenvalue problem is then solved to obtain the low - lying eigenvalues .",
    "we shall comment further on the additive constant in .",
    "the above equations remain valid when @xmath117 $ ] is modified by an arbitrary additive constant .",
    "this yields the same kohn - sham orbitals @xmath119 and only leads to a corresponding shift of the nonlinear eigenvalues @xmath120 .",
    "however , as pointed out in @xcite , it is only when @xmath117 $ ] is precisely the kantorovich potential that the ground state energy can equal the sum of kohn - sham eigenvalues , i.e. , @xmath121    in summary , an scf algorithm for solving the kohn - sham equation is given by    [ algorithm - ks_sce ] scf iterations for sce - based kohn - sham equations    1 .",
    "given @xmath122 .",
    "let @xmath123 and @xmath124 be an initial electron density .",
    "2 .   calculate the co - motion functions from @xmath125 ( by using the numerical methods introduced in the next section ) .",
    "3 .   calculate the effective potential @xmath126 $ ] by .",
    "solve the linear eigenvalue problem @xmath127\\right)\\phi_i          = \\lambda_i\\phi_i \\quad i=1,\\dots , n\\ ] ] for low - lying eigenvalues to obtain new kohn - sham orbitals , from which a new electron density @xmath128 can be calculated .",
    "if @xmath129 , stop ; else , generate a new electron density @xmath130 by some charge mixing technique and go to 2 .",
    "in each iteration of the scf algorithm for solving , one has to construct @xmath131 $ ] from a trial electron density @xmath61 . according to",
    ", this requires the solution of the optimal transport problem with a given single - particle density to obtain the co - motion functions @xmath132 . for simplicity",
    ", we only consider the case @xmath108 , where only one co - motion function has to be calculated ( which is denoted by @xmath109 in the following ) . for systems with more than two electrons , we refer to section [ section - perspective ] for a future perspective .",
    "we discretize the computational domain into @xmath133 finite elements @xmath134 .",
    "( we replace @xmath10 by a bounded domain so that it can be discretized into a finite number of elements .",
    "this is reasonable since the electron density @xmath135 of a confined system decays exponentially fast to zero as @xmath136 @xcite . )",
    "each element is represented by a point @xmath137 located at its barycenter and its electron mass @xmath138 . within this discretization , we can approximate the two - particle density @xmath139 by a matrix @xmath140 with @xmath141 .",
    "( alternatively , one could identify the entries with the average @xmath142 . )",
    "the continuous problem is then discretized into @xmath143 & \\sum_{1\\leq l\\leq n}x_{kl}=\\frac{1}{2}\\rho_l , \\quad k=1,\\dots , n \\\\[1ex ] & x_{kl}\\geq 0 .",
    "\\end{array}\\ ] ] note that is a linear programming problem of the form @xmath144 where @xmath14 is the vector containing the entries of @xmath145 .",
    "we can solve this problem by standard optimization routines like ` _ _ linprog _ _ ' in . due to the symmetry of the problem",
    ", one can assume that @xmath146 and only needs to consider @xmath147 for @xmath148 . as a remark , the dual problem of ( in the sense of linear programming ) results in a discretized version of the kantorovich dual formulation .",
    "the solution of entails an approximation of the co - motion functions at the barycenters @xmath149 via the matrix @xmath150 : @xmath151 where @xmath147 can also be regarded as the mass of electron transported from @xmath137 to @xmath152 .",
    "if the discretization is sufficiently fine , i.e. , @xmath133 large enough , then @xmath153 is a good approximation of @xmath109 ( see the following numerical example ) . for a _ uniform _ discretization @xmath154",
    ", the degrees of freedom for linear programming may be huge . to reduce the computational cost",
    ", we use a locally refined mesh instead , which has more elements where the electron density is high and less elements where the electron density is low . generally speaking",
    ", the optimal mesh may be such that each element @xmath155 has almost equal electron mass @xmath125 .",
    "this type of mesh can be generated by an adaptive procedure , say , one refines the element when its electron mass is larger than a given threshold and coarse it otherwise .",
    "since the electron density decays exponentially fast to zero as @xmath136 , the mesh is much coarser far away from the nuclei than close to the nuclei , which reduces the degrees of freedom significantly .    as a remark ,",
    "let us assume for a moment that all elements have exactly the same mass , @xmath156 for all @xmath157 .",
    "then the constraints in force @xmath145 to be a _",
    "doubly stochastic _ matrix ( up to a global scaling factor ) with nonnegative entries .",
    "according to birkhoff s theorem , the extremal points of the convex set of admissible matrices @xmath145 are the permutations , i.e. , matrices with exactly one non - zero entry @xmath158 in each row ( or column ) .",
    "since the optimum is obtained at an extremal point , the optimizer can be chosen of this form .",
    "we have thus derived a discrete analogue of the monge formulation , since the sum on the right of eq .",
    "will have exactly one nonzero term .",
    "another important technique to reduce the computational cost is to exploit the symmetry of the system .",
    "if the electron density @xmath18 has some kind of symmetric property , then we can reduce the computations to some subdomain accordingly .",
    "for example , @xcite gives an explicit formula of co - motion functions for spherically symmetric electron densities by making use of the symmetry .",
    "more precisely , it is proven that if the density has the form @xmath159 with some function @xmath160 , then the corresponding co - motion function @xmath109 has to be spherically symmetric itself , that is @xmath161 with some function @xmath162 .",
    "this reduces the three - dimensional spherically symmetric problem into a one - dimensional problem .    here",
    "we consider cylindrically symmetric systems , for instances , biatomic molecules .",
    "the following theorem states that the co - motion function @xmath109 inherits the cylindrical symmetriy of the density .",
    "[ theo - symmetric ] let @xmath108 and denote the cylindrical coordinates by @xmath163 . if @xmath164 with some function @xmath165 , then the corresponding co - motion function @xmath109 satisfies @xmath166 where @xmath167 with some map @xmath168 .",
    "let @xmath169 be the rotation operator with angle @xmath170 around the z - axis , i.e. , @xmath171 .",
    "let @xmath172 be a minimizer of with single - particle electron density @xmath18 , such that @xmath173 with @xmath109 the corresponding co - motion function .",
    "let @xmath174 .",
    "we claim that @xmath175 is also a minimizer of . to see this",
    ", we observe that @xmath176 which satisfies the marginal constraint @xmath177 since @xmath178 .",
    "moreover , we have @xmath179 from the fact that the cost function @xmath180 is invariant under the map @xmath181 . and together",
    "imply that @xmath175 is a minimizer of .",
    "therefore , @xmath182 is also a co - motion function of this problem .",
    "because the co - motion function is unique in the case of two particles ( see @xcite ) , we have @xmath183    since we minimize @xmath184 @xmath109 has to satisfy to maximize the denominator .",
    "this completes the proof .",
    "* example .",
    "* we take a one - dimensional two - electron system as an example to illustrate our numerical method .",
    "although this type of algorithm is not particularly interesting for one - dimensional systems since analytical formulations are known @xcite , it is more suitable to present the numerical results and explain our idea .",
    "let @xmath185 $ ] and @xmath186 , see figure [ fig - rho1d ] .",
    "the exact co - motion function can be calculated explicitly @xmath187^{1/2}\\right ) & { \\rm if}~x\\leq 0 , \\\\ -5\\left(1-\\big[1 - 0.5(-x+5)(0.4 - 0.08x)\\big]^{1/2}\\right ) & { \\rm if}~x>0 .",
    "\\end{cases}\\ ] ] we observe in figure [ fig - comotion ] that the numerical approximations of the co - motion function can be very accurate ( compared with the exact formula ) . figure  [ fig - convergence ] shows the convergence of the uniform numerical approximations .",
    "the nonuniform mesh ( red elements in figure  [ fig - rho1d ] ) achieves a much higher accuracy with the same degrees of freedom , see figure  [ fig - adaptive ] . actually , we observe that the errors of a nonuniform mesh with @xmath188 is even smaller compared to a uniform mesh with @xmath189 on average",
    ".     +    remember that the aforementioned electron density is symmetric in the sense of @xmath190 therefore , the corresponding co - motion function is symmetric itself , i.e. @xmath191 which maps @xmath192 $ ] to @xmath193 $ ] and maps @xmath193 $ ] to @xmath192 $ ] .",
    "hence , it is only necessary to calculate @xmath194 on half of the domain , say , @xmath192 $ ] .",
    "an important application of the numerical methods introduced above is to simulate the h@xmath1 molecule at its dissociating limit .",
    "we provide more details in the next section .",
    "we consider h@xmath1 molecule in this section .",
    "let @xmath195 and @xmath196 be the locations of two hydrogen atoms .",
    "physically , the hydrogen molecule should dissociate into two free hydrogen atoms as the bond length @xmath197 , with the ground state spin - unpolarized .",
    "the spin - restricted hartree - fock and kohn - sham dft models give the correct spin multiplicity , but overestimate total energies , i.e. , higher than that of two free hydrogen atoms . in comparison ,",
    "the spin - unrestricted models give fairly good total energies , while the wave functions are spin - contaminated , which is known as `` symmetry breaking '' in h@xmath1 bond dissociation .    here",
    "we focus on the sce - dft model without symmetry breaking , and show both theoretically and numerically that the restricted kohn - sham model gives the correct ground state energy in the dissociation limit @xmath198 .",
    "denote by @xmath199 the ground state energy of a single hydrogen atom @xmath200 @xmath201 denotes the ground state energy of the hydrogen molecule in the sce - dft model @xmath202 , \\\\",
    "\\phi\\in h^1(\\mathbb{r}^3),~\\|\\phi\\|_{l^2(\\mathbb{r}^3)}=1\\big\\ } , \\quad\\end{gathered}\\ ] ] where @xmath203 .",
    "the following result indicates that the sce - dft model is correct for the h@xmath1 molecule at its dissociating limit .",
    "[ theo - sce - h2 ] let @xmath199 and @xmath201 be given by and respectively .",
    "we have @xmath204    first , we establish an upper bound of @xmath201 .",
    "let @xmath205 and @xmath206 note that @xmath207 is the minimizer of , and @xmath208 implies @xmath209 .",
    "we have @xmath210.\\ ] ] let @xmath211 and @xmath212 .",
    "a direct calculation leads to @xmath213 and @xmath214 let @xmath215 , we have @xmath216 \\leq \\int_{\\mathbb{r}^6}\\frac{\\rho_2({\\bf r}_1,{\\bf r}_2)}{|{\\bf r}_1-{\\bf r}_2|}d{\\bf r}_1d{\\bf r}_2 = \\int_{\\mathbb{r}^3}\\frac{2|\\psi({\\bf r}_1)|^2}{|{\\bf r}_a-{\\bf r}_b|}d{\\bf r}_1 = \\frac{1}{r}.\\ ] ] taking , , and into account , we have @xmath217    to give a lower bound of @xmath201 , we observe that @xmath218 where @xmath219 is the h@xmath220 hamiltonian @xmath221 .",
    "we claim that @xmath222 to show , we first decompose the unity function on @xmath223 into two smooth cutoff functions @xmath224 and @xmath225 , such that @xmath226 , @xmath227 for @xmath228 , @xmath229 for @xmath230 , and @xmath231 with some constant @xmath232 .",
    "let @xmath233 and @xmath234 .",
    "we have @xmath235 and @xmath236 therefore , @xmath237 which implies .",
    "therefore , we obtain from and that @xmath238 together with the upper bound , this leads to at the limit @xmath198 .",
    "in what follows , we present a numerical simulation of the dissociating h@xmath1 molecule to support the theory .",
    "the computations are carried out on a bounded domain @xmath239 ^ 3 $ ] .",
    "we use algorithm  [ algorithm - ks_sce ] to solve for the ground state energies and electron densities for different bond length @xmath240 .",
    "concerning the optimal transport problem , we use the numerical methods introduced in section [ section - numerical ] and calculate the co - motion function in each scf iteration step .",
    "the nonuniform mesh is generated by the package @xcite , a toolbox for parallel adaptive finite element programs developed at the state key laboratory of scientific and engineering computing of the chinese academy of sciences . while the problem is effectively two - dimensional according to theorem  [ theo - symmetric ] , we have performed the calculations in three dimensions since",
    "is tailored to three - dimensional problems .",
    "figure  [ fig_h2_rho_mesh ] shows a contour plot of the electron density at slice @xmath241 and the corresponding mesh .",
    "one observes that the grid reflects the higher density around the nuclei .     for h@xmath1.,title=\"fig:\",height=207]3.0 cm   for h@xmath1.,title=\"fig:\",height=207 ] ( -140,70)(1,1)@xmath242 ( -120,60)(1,1)@xmath243    to further reduce the computational cost",
    ", we can exploit the cylindrical symmetry of the system with the help of theorem  [ theo - symmetric ] . as shown in figure  [ fig_h2_mesh ] , the degrees of freedom can be reduced to @xmath244 of the original volume . for the linear programming problem , we resort to @xcite , a high - performance software for large - scale optimization problems .    the computational results are presented in figure  [ fig_h2_bond ] , in which we compare the bond energies in dependence of @xmath245 using the lda and sce kohn - sham methods , respectively .",
    "here , the bond energies are the ground state energies of the systems minus @xmath246 , which is expected to be zero when the two hydrogen atoms are disassociated .",
    "note that the sce model shows the correct asymptotic behavior , while the lda model fails at large @xmath245 by giving too large energies . for comparison ,",
    "the lda error @xmath247 in @xcite for the infinitely stretched h@xmath1 molecule is lower than in figure  [ fig_h2_bond ] since twice the lda - hydrogen energy is subtracted instead of twice the exact @xmath199 , but remains significant ; errors of similar magnitude are reported there for other functionals such as b3lyp or pbe .",
    "potential energy curve as a function of the bond length for the sce and lda models.,scaledwidth=70.0% ]    as physical explanations for these results , at long internuclear separations , if one electron is located near atom a , the other will be found close to atom b. this correlation is correctly reflected by the optimal transport model , hence the sce model gives asymptotically the product of hydrogen orbitals on the two nuclei .",
    "in contrast , within the kohn - sham lda framework , the two electrons are constrained to be in the same spatial orbital and each electron experiences only the average effect of the other , thus each electron has equal probability of being near a or b , irrespective of the position of the other electron .",
    "the possibility of both electrons being on the same atom is not excluded , as reflected in the wrong asymptotic behavior of the disassociation energy in figure  [ fig_h2_bond ] .",
    "we further compare the electron densities and coulomb potentials obtained by the two different models in figure  [ fig_h2_x_rho_vcu ] .",
    "note that the scalar offset of the potential in the figure is determined by the boundary conditions , i.e. , @xmath248 for lda and @xmath249 for sce @xcite .",
    "the electron densities are actually quite close , while the shape of the potentials differs substantially when @xmath245 is large .",
    "the sce potential is larger between the hydrogen atoms , favoring a depletion of the bond charge whenever the two atoms separate .",
    "this produces the correct results for large @xmath245 .",
    "( indicated by the blue dots inside the red contours ) to the green area , for the h@xmath1 molecule with @xmath250 .",
    "each blue dot corresponds to one barycenter in the numerical discretization , and has been rotated into the @xmath14-@xmath15-plane with @xmath251 for visual clarity .",
    "the green dots are precisely the images of the blue dots under the optimal transport map.,scaledwidth=40.0% ]    finally , as illustration of the co - motion function or optimal map , figure  [ fig_h2_ot_map ] shows the image of the map on a density contour .",
    "the numerical discretization of the sce optimal transport problem with coulomb cost and two marginals leads to the linear programming problem , which can indeed be solved in practice , as we have demonstrated in a proof of concept calculation .",
    "the self - consistent sce - dft simulation of the dissociating h@xmath1 molecule agrees well with the physically correct limit , unlike standard dft models like lda .",
    "the theory of this paper applies to more general systems with arbitrary numbers of electrons , however , the numerical algorithms need further developments . specifically , we can restrict the @xmath2-particle density to the ansatz @xmath252 where @xmath18 is the given single - particle density . here",
    ", @xmath253 represents the probability of the @xmath254th electron being found at @xmath255 while the first electron is located at @xmath256 .",
    "we have @xmath257 with a given discretization @xmath154 and barycenters @xmath137 of @xmath155 , we can approximate @xmath253 by a matrix @xmath258 for @xmath259 .",
    "then the continuous model is reduced to @xmath260 & \\sum_{l=1}^n x_{i , kl } = 1 , \\quad k = 1 , \\dots , n , \\quad i = 2 , \\dots , n \\\\[1ex ] & x_{i , kl } \\ge 0 .",
    "\\end{array}\\ ] ] this is a quadratic programming problem of the form @xmath261 by solving the above quadratic programming problem , we approximate the co - motion functions @xmath262 by the matrices @xmath263 . similar to , the co - motion functions can be approximated by @xmath264 however , a serious difficulty in solving stems from the non - convexity of the matrix @xmath265 .",
    "moreover , the symmetric decomposition is not clear for systems with more than two electrons .",
    "we plan to investigate these issues in future work .",
    "* acknowledgments*c.m .  acknowledges support from the dfg project fr  1275/3 - 1 .",
    "[ lemma - outersgs ] if @xmath96 is a maximizer of with single - particle density @xmath18 , and @xmath266 is a minimizer of the inner optimization of , i.e. the minimizer of @xmath267 then @xmath97 is exactly the minimizer of the constraint minimization problem .",
    "we view the minimization over @xmath32 in as a quadratic variational problem for ( spinless bosonic ) normalized wavefunctions @xmath272 ( by identifying @xmath273 ) : @xmath274 using first order perturbation theory and the fact that @xmath97 is the minimizer of @xmath275 , we obtain @xmath276 substituting into yields @xmath277 which indicates @xmath278 . that is ,",
    "if @xmath96 is a maximizer of the outer optimization of , then the minimizer of the associated inner optimization in automatically has the single - particle density @xmath18 .",
    "moreover , since the term @xmath279 only depends on the single - particle density of @xmath32 , @xmath97 must minimize @xmath280 under the constraint @xmath31 ( because any other minimizer of gives the same value for @xmath281 as @xmath97 ) .",
    "therefore , @xmath97 is also a minimizer of , which completes the proof ."
  ],
  "abstract_text": [
    "<S> in this paper , we study numerical discretizations to solve density functional models in the `` strictly correlated electrons '' ( sce ) framework . unlike previous studies our work </S>",
    "<S> is not restricted to radially symmetric densities . in the sce framework , </S>",
    "<S> the exchange - correlation functional encodes the effects of the strong correlation regime by minimizing the pairwise coulomb repulsion , resulting in an optimal transport problem . </S>",
    "<S> we give a mathematical derivation of the self - consistent kohn - sham - sce equations , construct an efficient numerical discretization for this type of problem for @xmath0 electrons , and apply it to the h@xmath1 molecule in its dissociating limit . </S>",
    "<S> moreover , we prove that the sce density functional model is correct for the h@xmath1 molecule in its dissociating limit . </S>"
  ]
}