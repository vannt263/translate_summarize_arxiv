{
  "article_text": [
    "a number of papers in the literature @xcite , etc . , have considered the complexity of counting problems , proving many such problems to be # p - complete .",
    "other papers have studied the complexity of ambiguous and unique satisfiability problems @xcite , proving such problems to be np - hard and d@xmath0-hard - hardness results are with respect to random polynomial time reductions .",
    "] respectively .",
    "still other papers @xcite have considered the complexity of decision problems when restricted to planar instances , proving many such problems to be np - hard . in this paper , we combine these lines of research and prove for the first time that    * even when restricted to planar instances * , many counting problems remain # p - complete , many ambiguous satisfiability problems remain np - complete and many unique satisfiability problems remain d@xmath0-hard .    previously , very few #",
    "p - hardness results , no np - hardness results , and no + d@xmath0-completeness results were known for counting problems , ambiguous satisfiability problems and unique satisfiability problems , respectively , when restricted to planar instances .",
    "such results are presented for several satisfiability , graph and combinatorial problems .",
    "these results show that planar counting , planar ambiguous satisfiability and planar unique satisfiability problems are _ as hard as _ arbitrary such problems , with respect to polynomial time and random polynomial time reducibilities .",
    "the results in this paper both extend the results in the literature and also provide additional tools for proving hardness results for planar problems for various complexity classes .",
    "these tools include parsimonious and weakly parsimonious crossover boxes , the np - hardness of various basic planar satisfiability problems and the np - hardness of the planar ambiguous satisfiability problems .",
    "( henceforth , we denote the restriction of a problem @xmath3 to planar instances by pl-@xmath3 . )",
    "the particular results presented here include the following :    the problem 3sat has a parsimonious planar crossover box . among other things",
    ", this implies that the problem # pl-3sat is # p - complete , the problem + ambiguous - pl-3sat is np - complete , and the problem unique - pl-3sat is d@xmath0-complete .",
    "the problem 3sat is simultaneously polynomial time , planarity - preserving , and parsimoniously reducible to each of the basic cnf satisfiability problems listed in table 1 .",
    "( previously , 3sat was only known to be so reducible to the problem 1-ex3sat @xcite . )    there exist polynomial time , weakly parsimonious , and planarity - preserving reductions from the problem 1-ex3monosat to several graph problems including minimum vertex cover , minimum dominating set , and minimum feedback vertex set .    using the results 1,2 and 3 , variants of known reductions , and new reductions ,",
    "we show that for all of the problems pl-@xmath3 in table 1 , the problem # pl-@xmath3 is # p - hard .",
    "similarly , we show that for many of the problems in table 1 , the problems ambiguous pl-@xmath3 and unique pl-@xmath3 are np - hard and d@xmath0-hard , respectively .",
    "all of the # p - hardness results for planar counting problems in table 1 can easily be shown to hold , even when the input to the problem consists of    a formula @xmath4 and one of its satisfying assignments , a graph @xmath5 and one of its minimum vertex covers , a graph @xmath5 and one of its dominating sets , etc .",
    "thus the # p - hardness of the problems # pl-@xmath3 in table 1 is not simply a corollary of the np - hardness of the problem pl-@xmath3 , since the problems # pl-@xmath3 are # p - hard , even when restricted to sets of instances for which the problems pl-@xmath3 are trivially polynomial time solvable .",
    "moreover , quoting from @xcite we note that      whether the number of solutions of all np - complete problems are nevertheless polynomial time interreducible ( i.e. , whether np - completeness implies #",
    "p - completeness ) is still open .",
    "\"    corollaries of our results and their proofs include the following :    the problems # 1-valid 3sat and # 1-valid pl-3sat are # p - complete .",
    "( it is trivially seen that every instance of the problem 1-valid 3sat is satisfiable by the assignment making all variables equal to 1 .",
    "see definition [ def2.9 ] . )",
    "the problems ambiguous 1-valid 3sat and ambiguous 1-valid pl-3sat are np - complete .",
    "the problems unique 1-valid 3sat and unique 1-valid pl-3sat are co - np - complete .",
    "assuming p @xmath6 np , there are no @xmath2-approximation algorithms for the problems of maximizing or minimizing a linear objective function subject to a planar system of inequalities over the integers .",
    "table 1 gives a summary of our # p - hardness results .",
    "the rest of the paper is organized as follows .",
    "section [ sec : def ] contains definitions and preliminaries .",
    "section [ sec:3sat ] discusses the complexity of # pl-3sat and other basic cnf satisfiability problems .",
    "these problems are used to prove the # p - hardness of other problems discussed in the subsequent sections .",
    "section [ sec : graph ] discusses the complexity of various counting problems for planar graphs .",
    "section [ sec : unique ] contains the ambiguous and unique satisfiability results and the result on the non - approximability of the objective functions of integer linear programs . finally , ",
    "[ sec : conclusions ] consists of conclusions and open problems .",
    "= 0.8    [ cols=\"^,^,^,^ \" , ]     * table 1 : summary of np- and # p - hardness results for planar instances .",
    "the third column summarizes the decision complexity of the problems while the fourth column summarizes the complexity of the counting versions . a star ( * )",
    "denotes result obtained in this paper .",
    "the numbers in square brackets is the reference where the corresponding result is proved . *",
    "in this section we review the basic definitions and notation used in this paper .",
    "additional definitions can be found in @xcite .",
    "[ def2.1 ] a _ search problem _ @xmath3 consists of a set @xmath7 of objects called _ instances _ , and for each instance @xmath8 , a set @xmath9 $ ] of objects called _ solutions _ for @xmath10 .",
    "an algorithm is said to _ solve _ a search problem @xmath3 if , given @xmath8 as input , the algorithm outputs * no * if @xmath9 = \\phi $ ] and outputs an @xmath11 $ ] otherwise .",
    "[ def2.2 ] the _ enumeration problem _ associated with a search problem @xmath3 is the problem of determining , given @xmath8 , the cardinality of @xmath9 $ ] .",
    "[ def2.3 ] the class # p consists of all enumeration problems associated with search problems @xmath3 such that there is a non - deterministic algorithm for solving @xmath3 such that , for all @xmath8 , the number of distinct accepting sequences for @xmath10 by the algorithm equals @xmath12|$ ] and the length of the longest accepting computation of the algorithm on @xmath8 is bounded by a polynomial in the length of @xmath10 .",
    "[ def2.4 ] a reduction @xcite @xmath13 is _ parsimonious _ if and only if @xmath14 the number of solutions of @xmath10 is equal to the number of solutions of @xmath15 .    [ def2.5 ] a reduction @xmath4 is _ weakly parsimonious _ if and only if @xmath16 , where @xmath17 and @xmath18 denote the number of solutions of @xmath10 and @xmath15 respectively and @xmath19 is a polynomial time computable function represented using binary notation .",
    "an enumeration problem is said to be # p - hard if each problem in # p is polynomial time parsimoniously or weakly parsimoniously turing reducible to it , if in addition , the enumeration problem is in # p , the problem is said to be # p - complete .",
    "[ def2.6 ] # 3sat is the problem of computing the number of satisfying assignments of a boolean formula @xmath20 in conjunctive normal form with at most three literals per clause .",
    "the following basic results on the complexity of counting problems are used in this paper .",
    "@xcite the problems # 3sat and # graph 3-coloring are # p - complete .",
    "[ def2.7 ] the _ bipartite graph _ associated with a cnf satisfiability problem is defined as follows : the clauses and variables in a formula are in one to one correspondence with the vertices of the graph .",
    "there is an edge between a clause node and a variable node if and only if the variable appears in the clause .",
    "a cnf formula is _ planar _ if and only if its associated bipartite graph is planar .",
    "[ def2.8 ] ( 1)ex3sat is the restriction of the problem 3sat to formulas in which each clause has exactly three literals .",
    "( 2)1 - 3sat is the problem of determining if a cnf formula in which each clause has no more than 3 literals has a satisfying assignment such that exactly one literal per clause is satisfied .",
    "( 3)1-ex3sat is the problem of determining if a cnf formula in which each clause has exactly 3 literals has a satisfying assignment such that exactly one literal per clause is satisfied .",
    "( 4)1-ex3monosat is the restriction of 1-ex3sat to formulas having no negated literals .    * definition 2.9 : * @xcite    [ def2.9 ] @xcite a relation @xmath21 is _ 1-valid _ if and only if @xmath22 . a cnf formula @xmath4 is _ 1-valid _ if the formula is satisfied when all the variables in the formula are set to true .",
    "[ def2.10 ] given a boolean formula @xmath20 and an assignment * v * to the variables of @xmath20 , the notation * v*@xmath23 $ ] denotes the value of @xmath20 under * v*.    [ def2.11 ]    \\(1 ) exact cover by 3-sets ( x3c : ) an instance of this problem consists of a set @xmath24 with @xmath25 elements and a collection @xmath26 of 3-element subsets of @xmath24 .",
    "the question is : does there exist a sub - collection @xmath27 of @xmath26 such that every element of @xmath24 occurs in exactly one set in @xmath27 ?",
    "\\(2 ) hitting set : an instance of this problem consists of a collection @xmath26 of subsets of a finite set @xmath28 and a positive integer @xmath29 .",
    "the question is : is there a subset @xmath30 with @xmath31 such that @xmath32 contains at least one element from each subset in @xmath26 ?    as in the case of 3sat , we can associate a bipartite graph @xmath33 with an instance of each of the above problems .",
    "for example pl - x3c is defined as follows : each element in @xmath26 has a corresponding vertex in @xmath28 , each element in @xmath24 has a corresponding vertex in @xmath34 , and a vertex in @xmath28 is joined to a vertex in @xmath34 if and only if the set corresponding to the vertex in @xmath28 contains the element corresponding to the vertex in @xmath34 .",
    "[ def2.12 ]    \\(1 ) dominating set : an instance of this problem consists of an undirected graph @xmath35 , and an integer @xmath36 .",
    "the question is : is there a dominating set of size at most @xmath37 in @xmath5 , i.e. is there a subset @xmath38 of @xmath39 , @xmath40 , such that for each @xmath41 there is a @xmath42 such that @xmath43 ?",
    "\\(2 ) clique cover : an instance of this problem consists of an undirected graph @xmath35 , and an integer @xmath36 .",
    "the question is : is there a clique cover of size at most @xmath37 in @xmath5 , i.e. can the graph be partitioned into at most @xmath37 sets of nodes such that each set is a clique ?",
    "\\(3 ) partition into claws : an instance of this problem consists of an undirected graph @xmath35 , @xmath44 .",
    "the question is : is there a way to partition the edges of the graph into sets @xmath45 , @xmath46 , such that each @xmath47 induces a subgraph isomorphic to @xmath48 ( i.e. a claw ) ?",
    "\\(4 ) feedback vertex set : an instance of this problem consists of a directed graph @xmath49 and an integer @xmath36 .",
    "the question is : is there a feedback vertex set of size at most @xmath37 in @xmath5 , i.e. does there exist a subset @xmath38 of @xmath39 of size at most @xmath37 such that @xmath38 contains at least one vertex from every cycle in @xmath5 ?    [ def2.13 ]",
    "let @xmath3 denote a cnf satisfiability problem",
    ". then the associated _ ambiguous version _ of @xmath3 , denoted by ambiguous-@xmath3 , is the problem of determining , given an instance @xmath10 of @xmath3 and an assignment * v * to the variables of @xmath10 such that * v*@xmath50= 1 $ ] , if there is an additional assignment of values to the variables of @xmath10 satisfying @xmath10 .",
    "the associated _ unique version _ of @xmath3 , denoted by unique-@xmath3 , is the problem of determining if the given instance @xmath10 of @xmath3 has exactly one satisfying assignment .",
    "more generally , let @xmath3 be any decision problem .",
    "henceforth when applicable , we denote the restriction of @xmath3 to planar instances by pl-@xmath3 , the counting version of @xmath3 by # @xmath3 , the ambiguous version of @xmath3 by ambiguous-@xmath3 , and the unique version of the problem by unique-@xmath3 .",
    "for example , recalling definition [ def2.11 ] and the discussion immediately following it ,    ( i)pl - x3c is the problem x3c restricted to instances @xmath51 for which the bipartite graph @xmath33 is planar .",
    "( ii)#x3c is the problem of computing , given @xmath51 , the number of distinct subsets @xmath52 such that each element of @xmath24 occurs in exactly one set in @xmath27 .",
    "\\(iii ) ambiguous - x3c is the problem of determining , given @xmath53 where @xmath52 and each element of @xmath24 occurs in exactly one set in @xmath27 , if there exists another subset @xmath54 that is an exact cover of the elements in @xmath24 .    finally henceforth by _ reduction _ , we mean a polynomial time many one reduction",
    "in this section , we prove that the problem pl-3sat has a parsimonious crossover box . specifically , we show that the crossover box in @xcite is parsimonious .",
    "one immediate corollary is that the problem # pl-3sat is # p - hard .",
    "we also prove that the problem 3sat is planarity preserving and parsimoniously reducible to each of the basic sat problems listed in table 1 .",
    "[ def3.1 ] a * crossover box * for a satisfiability problem @xmath3 is a formula @xmath55 with four distinguished variables @xmath56 , @xmath57 , @xmath58 , @xmath59 , which can be laid out on the plane with the distinguished variables on the outer face , such that    the * old variables * @xmath56 and @xmath58 are opposite to the corresponding * new variables * @xmath57 and @xmath59 ,    each assignment to @xmath56 and @xmath58 can be extended to a satisfying assignment of @xmath55 ,    for any satisfying assignment of @xmath55 , @xmath60 and @xmath61 .",
    "the crossover box is * parsimonious * if and only if for each assignment to the old variables , there is a exactly one extension of this assignment to the variables in the crossover box such that @xmath55 is satisfied .",
    "[ cross ] the problem 3sat has a parsimonious planar crossover box .",
    "hence , 3sat is parsimoniously reducible to pl-3sat and # pl-3sat is # p - complete .",
    "the crossover box described here is the same as the one given in @xcite .",
    "here we prove that the crossover box also preserves the number of solutions .",
    "for expository purposes , we describe the crossover box in two steps .",
    "the first step is to consider the following formula : + @xmath62 @xmath63 @xmath64 @xmath65 @xmath66 @xmath67 @xmath68    following @xcite , we give a intuitive explanation of formula @xmath55 .",
    "clauses 1 , 2 and 3 imply that @xmath69 , clauses 4 , 5 and 6 imply @xmath70 .",
    "clauses 7 , 8 and 9 imply @xmath71 clauses 10 , 11 and 12 imply @xmath72 .",
    "clause 13 ( the four literal clause ) implies that at least one of @xmath73 , @xmath74 , @xmath75 or @xmath76 is true .",
    "clauses 14 , 15 , 16 , 17 imply that @xmath77 and @xmath78 .",
    "finally , clauses 18 and 19 imply @xmath79 and @xmath80 .",
    "it can now be verified that the formula @xmath55 implies @xmath81 and @xmath82 .",
    "for example , consider an assignment * v * such that * v*[@xmath57 ] @xmath84 * v*[@xmath59 ] @xmath86",
    ". then @xmath55 implies that * v*[@xmath74 ] @xmath84 * v*[@xmath76 ] @xmath84 * v*[@xmath73 ] @xmath84 * v*[@xmath90 @xmath84 * v*[@xmath91 @xmath86 and * v*[@xmath75 ] @xmath93 .",
    "we leave it to the reader to verify the other 3 cases .",
    "thus , in any satisfying assignment to @xmath55 , the new variables @xmath94 and @xmath76 are _ functionally _ dependent on @xmath56 and @xmath58 . in other words , given an assignment to the variable @xmath56 and @xmath58 there is a unique way to extend this assignment so as to satisfy all the clauses in @xmath55 .",
    "thus @xmath55 is a parsimonious crossover box .",
    "even though , the formula itself is a parsimonious planar crossover box , it is unsuitable for a reduction to pl-3sat because it has one clause with four literals , namely @xmath95 .",
    "the second step is to obtain the formula @xmath96 by replacing this clause with the formula @xmath97 .",
    "the planarity of the formula @xmath96 is demonstrated in figure  [ crossoverbox1.fig ] .",
    "this step also preserves numbers of satisfying assignments as demonstrated by the following claim .    * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * our second step is to obtain the formula @xmath96 by replacing this clause with the formula + @xmath98 + this step is different from @xcite in that it preserves numbers of satisfying assignments .",
    "the planarity of the formula @xmath96 is demonstrated in figure  [ crossoverbox1.fig ] .",
    "* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *    \\(1 ) exactly one of @xmath99 is true in any satisfying assignment to @xmath55 .",
    "( 2 ) @xmath100 is functionally dependent on @xmath101 and @xmath76 .",
    "thus a satisfying assignment for @xmath55 can be extended in a unique way to a satisfying assignment to the formula @xmath96 .",
    "we prove the claim for the case when @xmath73 is true .",
    "the other three cases are similar .",
    "as already discussed , clauses 14 , 15 , 16 , 17 imply that @xmath77 and @xmath78 .",
    "consider a satisfying assignment * v * such that * v*[@xmath73 ] @xmath93 .",
    "then the above discussion implies that * v*[@xmath74 ] @xmath84 * v*[@xmath76 ] @xmath86 .",
    "now , since @xmath70 and * v*[@xmath74 ] @xmath86 , we have * v*[@xmath90 @xmath102 and * v*[@xmath59 ] @xmath93 .",
    "since @xmath103 and * v*[@xmath59 ] @xmath93 it implies that * v*[@xmath75 ] @xmath86 .",
    "this forces * v*[@xmath100 ] @xmath105 .    * * * * * * * @xmath106 , @xmath107 , @xmath108 , and @xmath109 force that no two variables from the following pairs of variables are true : @xmath73 and @xmath74 , @xmath74 and @xmath110 , @xmath75 and @xmath76 , and @xmath76 and @xmath73 .",
    "we need to show that the remaining pairs of variables @xmath73 and @xmath110 , @xmath74 and @xmath76 also have the property that no two of the variables are true : + let @xmath73 and @xmath110 be true . @xmath69 and @xmath111 .",
    "hence , @xmath112 , @xmath113 and @xmath114 would be true .",
    "therefore , since @xmath70 @xmath74 is also true . however , @xmath74 and @xmath110 both can not be true",
    ". therefore @xmath73 and @xmath110 can not both be true .",
    "similarly , it can be shown that @xmath74 and @xmath76 can be true .",
    "thus at most one of @xmath99 is true in any satisfying assignment to @xmath55 .",
    "therefore , there can be only one value for @xmath100 such that all clauses in @xmath55 are true , since exactly one of @xmath115 and @xmath116 can be true .",
    "@xmath117 * * * * * * * * * * * *    * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * as shown in @xcite , an assignment * v * of truth values to the variables of @xmath118 satisfies @xmath118 iff @xmath119 simultaneously satisfies @xmath120 @xmath121 @xmath71 @xmath122 @xmath79 @xmath123 @xmath81 and @xmath82 . thus the new variables @xmath94 and @xmath76 are functionally dependent on @xmath56 and @xmath58 and hence @xmath55 is a parsimonious crossover box .    it is easily verified that formula @xmath96 is satisfied if and only if the following are simultaneously satisfied : @xmath124 , @xmath125 , and @xmath126 . * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *    thus , the satisfying assignments to @xmath96 satisfy @xmath118 .",
    "it can now be seen that in a satisfying assignment to the variables of @xmath127 , the values of @xmath57 , @xmath112 , @xmath59 , @xmath113 , @xmath73 , @xmath74 , @xmath75 , @xmath76 , and @xmath100 are all functionally dependent on @xmath56 and @xmath58 .",
    "therefore @xmath96 is a parsimonious crossover box .",
    "we can now describe the reduction given in @xcite from 3sat to pl-3sat . for any 3cnf formula ,",
    "lay the formula in the plane , possibly with certain edge pairs crossing over at ",
    "crossover points \" .",
    "this layout is a planar graph with vertex set consisting of the variables , clauses and the crossover points . in this layout , we add a new variable node on the edge between two crossover points or between a crossover point and a clause node as shown in figure  [ fig31.fig ] .",
    "the resulting graph is bipartite where the first set of nodes consists of the variable nodes and the second set consists of the clause nodes and the crossover points .",
    "each edge is between a variable and a crossover point , or between a variable and a clause .",
    "also , each crossover point has four distinct variables as neighbors .",
    "we now replace each crossover point with the crossover box in figure  [ crossoverbox1.fig ] where @xmath112 , @xmath113 , @xmath73 , @xmath74 , @xmath75 , @xmath76 , and @xmath100 are given distinct names in each replacement . here",
    "@xmath56 , @xmath58 , @xmath57 and @xmath59 are identified with the neighbors of the crossover point in cyclic order in the layout .",
    "the new layout is planar and the new formula has the same number of solutions as the original , since in any satisfying assignment the new variables are functionally dependent on the old .",
    "* * * * * * * * * * * * * * * * * * * * * * * * * * * * we remark that the step 2 in the reduction from 3sat to pl-3sat as given in lichtenstein @xcite is not even weakly parsimonious .",
    "recall that , in this step the four literal clause @xmath128 is replaced by the clauses : @xmath97 . to verify that this step is not even weakly parsimonious observe that in any satisfying assignment * v * to the literals @xmath101 and @xmath76 the following hold :    \\(i ) if * v*@xmath129 $ ] = true , then there is exactly one value for * v*@xmath130 $ ] such that @xmath97 = true .",
    "\\(ii ) if * v*@xmath131 $ ] = true , then there are two values for * v*@xmath130 $ ] such that @xmath97 = true .",
    "* * * * * * * * * * * * * * * * * * * * * * * * * * * * *    * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * replace that section of the graph by the crossover box in figure  [ crossoverbox1.fig ] as in @xcite where @xmath57 , @xmath112 , @xmath59 , @xmath113 , @xmath73 , @xmath74 , @xmath75 , @xmath76 , @xmath132 , and @xmath133 are given distinct names in each replacement . in the replacement ,",
    "@xmath56 and @xmath58 are the neighbors of the crossover point corresponding to the variables crossing over .",
    "new edges are added from @xmath57 and @xmath59 , to the corresponding neighbors of the crossover point .",
    "this replacement is done one crossover at a time until the layout of the formula has no crossovers .",
    "the new layout is planar and the new formula has the same number of solutions as the original since , in any satisfying assignment , the new variables are functionally dependent on the old . @xmath117 * * * * * * * * * * * * * * * * * * * * * * * * * * * * *    next , we strengthen theorem [ cross ] by showing that counting the number of satisfying assignments of a planar 3cnf formula is # p - complete , even when the input consists of a planar 3cnf formula @xmath20 and an assignment * v*@xmath23 $ ] to the variables of @xmath20 which satisfies @xmath20 .",
    "[ ambi ] given an instance @xmath20 of pl-3sat and an assignment * v * to the variables of @xmath20 such that * v*@xmath23 = 1 $ ] , the problem of counting the number of satisfying assignments of @xmath20 is # p - complete .",
    "* step 1 : * given an arbitrary planar 3cnf formula @xmath134 , we first construct a new formula + @xmath135 where @xmath136 $ ] .    obviously , an assignment * v * , such that , * v*[@xmath137 @xmath138 * v*[@xmath139 @xmath140 * v*[@xmath141 @xmath138 * v*[@xmath142 @xmath143 satisfies @xmath144 .",
    "hence @xmath144 is always satisfiable . also , the number of satisfying assignments of @xmath144 is one more than the number of satisfying assignments of @xmath4 .",
    "therefore , knowing the the number of satisfying assignments of @xmath144 tells us the number of satisfying assignments of @xmath4 .",
    "* step 2 : * convert @xmath135 , into an equivalent 3cnf formula + @xmath145 , where @xmath146 are new variables .",
    "this is done in the standard way as follows : obtain a parse tree of @xmath144 .",
    "for each non - leaf node in the parse tree introduce new variables @xmath147 , where @xmath148 is the variable corresponding to the root of the parse tree .",
    "each node of the parse tree corresponds to an operator applied to one / two inputs .",
    "let the children of a non leaf node @xmath149 be @xmath150 and @xmath151 .",
    "* case 1 : * if the operator at node @xmath149 is an and operator , construct a new 3cnf formula equivalent to the formula @xmath152 .",
    "* case 2 : * if the operator is an or operator , construct a 3cnf formula equivalent to the formula @xmath153 .",
    "* case 3 : * if the operator is an not operator then construct a 3cnf formula equivalent to the formula @xmath154 .",
    "the final 3cnf formula @xmath155 is a conjunction of all the 3cnf formulas along with @xmath148 .",
    "now it is easy to see that @xmath155 is satisfiable if and only if @xmath144 is satisfiable and the reduction is parsimonious .",
    "( the new variables are functionally dependent on the old . )    * step 3 : * next , lay out @xmath155 on a plane and replace each crossover in the layout by the crossover box described in theorem  [ cross ] .",
    "let @xmath156 be the resulting planar 3cnf formula",
    ". by theorem  [ cross ] , the reduction from @xmath155 to @xmath156 is parsimonious .",
    "thus the number of satisfying assignments of @xmath156 is 1 more than the number of satisfying assignments of @xmath4 .",
    "the theorem now follows .",
    "next we extend this result to prove that counting the number of satisfying assignments of a _",
    "1-valid _ planar 3cnf formula is # p - hard .",
    "[ 1-valid ] the problem # 1-valid pl-3sat is # p - complete .    given an arbitrary pl-3cnf formula @xmath134 and a satisfying assignment * v * such that * v*[f ] @xmath93 , we construct a new formula @xmath157 where @xmath158 are new variables .",
    "the formula @xmath144 is constructed as follows : let @xmath159 be the variables in @xmath4 such that * v*[@xmath160 @xmath84 * v*[@xmath161 @xmath162 * v*[@xmath163 @xmath86 .",
    "then replace @xmath164 by @xmath165 and @xmath166 by @xmath167 , @xmath168 . obviously , the formula @xmath144 is 1-valid and the reduction is parsimonious .",
    "karp and luby @xcite presented randomized fully polynomial time approximation schemes for several # p - complete problems , including # dnf .",
    "since then , substantial research has been done in the area of approximation algorithms for various counting problems .",
    "saluja et al .",
    "@xcite give a logical characterization of the counting problems that have a polynomial time random approximation scheme .",
    "our # p - hardness of # pl-3sat and other problems immediately raise the question of approximating the optimal values of these counting problems . the parsimonious reduction from 3sat to pl-3sat , implies that , given a deterministic polynomial time algorithm @xmath169 to approximately count the number of satisfying assignments of a planar 3cnf formula , we can construct a deterministic polynomial time algorithm @xmath170 with the same performance guarantee , to approximately count the number of satisfying assignments of an arbitrary 3cnf formula .    intuitively theorem  [ cross ] and the above observation mean that counting the number of satisfying assignments of a planar 3cnf formula is _ as hard as _ counting the number of satisfying assignments of an arbitrary 3cnf formula with respect to polynomial time reducibility .",
    "we remark that the result holds even for 1-valid pl-3cnf formulas .",
    "next , we prove the # p - hardness of other basic satisfiability problems .",
    "first we prove two lemmas :    [ ex - one ] let @xmath20 be the planar monotone formula @xmath171 .",
    "then there is a unique satisfying assignment * v * to the variables of @xmath20 such that each clause has exactly one true literal , namely , * v*@xmath172 \\ = \\ $ ] * v*@xmath173   \\ = \\ $ ] * v*@xmath174",
    "\\ =   0 \\ $ ] ; and * v*@xmath175   \\ = 1 \\ $ ] .    by inspection .",
    "[ unique ] the following ex3cnf formula is planar and has exactly one satisfying assignment , namely the assignment * v * defined by * v*@xmath176 = 0 ( 1 \\leq i \\leq 9)$ ] : + @xmath177 .    #",
    "1#20.85#1    planarity is demonstrated by figure [ ex3sat.fig ] . the given assignment *",
    "v * satisfies @xmath5 since each clause of @xmath5 contains a negated literal .",
    "suppose @xmath5 is true .",
    "let * u * be any truth assignment to the variables in @xmath5 , then , @xmath178 by clauses 6 , 8 , and 12 ; @xmath179 by clauses 7 , 9 , and 13 ; @xmath180 by clauses 5 , 10 , and 11 .",
    "therefore , @xmath181 .",
    "hence by clause 14 , * u*[@xmath182 @xmath183 * u*[@xmath184 @xmath183 * u*[@xmath185 @xmath105 . given this @xmath186 by clause 2 ; @xmath187 by clause 3 ; and @xmath188 by clause 4 .",
    "therefore , @xmath189 hence by clause 1 , * u*[@xmath137 @xmath190 * u*[@xmath139 @xmath190 * u*[@xmath191 @xmath192 but this implies that * u*[@xmath193 @xmath190 * u*[@xmath194 @xmath190 * u*[@xmath195 @xmath196 by clauses 5 , 6 , and 7 .",
    "hence in any satisfying assignment * u * of @xmath5 , * u*[@xmath197 @xmath198    next we give planarity - preserving parsimonious reductions from 3sat to the basic sat problems listed in table 1 . without loss of generality ,",
    "we assume that the given instance of the cnf formula does not have any single literal clause .",
    "[ parsi ] there exist planarity - preserving parsimonious reductions from 3sat to each of the following problems : ex3sat , 1 - 3sat , 1-ex3sat , 1-ex3monosat and x3c .",
    "3sat @xmath199 ex3sat :    let @xmath4 be a 3cnf formula with clauses @xmath200 for @xmath201 let @xmath202 be @xmath203 , if @xmath204 is a three - literal clause . if @xmath205 , let @xmath202 be @xmath206    @xmath5 is defined as in lemma [ unique ] and @xmath207 are distinct new variables .",
    "let @xmath208 . then by lemma",
    "[ unique ] , figure [ ex3sat.fig ] and direct inspection of the definitions of the formulas @xmath209 , the reduction mapping @xmath4 into @xmath210 is seen to be a planarity - preserving and parsimonious reduction of the problem 3sat to the problem ex3sat .",
    "3sat @xmath199 1-ex3sat : let @xmath4 be a 3cnf formula with clauses @xmath211 .",
    "+ ( 1 ) for each three - literal clause @xmath212 of @xmath4 , let @xmath213 @xmath214 where @xmath215 and @xmath216 are distinct new variables local to @xmath202 .",
    "+ ( 2 ) for each two literal clause @xmath217 of @xmath4 , let @xmath218 @xmath219 @xmath220 + where @xmath221 @xmath222 @xmath223 @xmath224 @xmath225 @xmath226 @xmath227 and @xmath228 are all new variables local to @xmath229 .",
    "let @xmath230 .    to see the planarity of this reduction see figure [ fig3.fig ] .",
    "we claim that @xmath231 is exactly - one - satisfiable _ if and only if _ the original formula @xmath4 is satisfiable .",
    "moreover the reduction is planarity - preserving and parsimonious . to prove that the reduction is parsimonious , it suffices to show the following two claims :    no assignment of truth values to the variables of clause @xmath232 of @xmath4 which does not satisfy @xmath233 can be extended to an assignment of truth values to the variables of the formula @xmath202 that exactly - one satisfies @xmath202 .",
    "let @xmath234 and * u * be an assignment to the variables such that * u*[@xmath235 @xmath138 * u*[@xmath236 @xmath138 * u*[@xmath237 @xmath238 . let * v * be an exactly - one satisfying assignment to the variables of @xmath202 such that * v*[@xmath235 @xmath138 * v*[@xmath236 @xmath138 * v*[@xmath237 @xmath143 .",
    "( i.e. * v * is an extension of * u*. ) then , the clauses @xmath239 and @xmath240 imply that * v*[@xmath241 @xmath242 * v*[@xmath243 @xmath242 * v*[@xmath244 @xmath245 * v*[@xmath216 ] @xmath247 it follows that * v * does not exactly - one satisfy the clause @xmath248 of @xmath202 .",
    "let @xmath249 and * u * be an assignment to the variables such that * u*[@xmath235 @xmath138 * u*[@xmath236 @xmath250 let * v * be an exactly - one satisfying assignment to the variables of @xmath202 such that * v*[@xmath235 @xmath138 * v*[@xmath236 @xmath250 then , the clauses @xmath251 and @xmath239 imply that * v*[@xmath241 @xmath138 * v*[@xmath243 @xmath252 and * v * [ @xmath244 @xmath253 but given this , the clause @xmath254 implies that * v*[@xmath255 @xmath256 .",
    "lemma [ ex - one ] now implies that * v * does not exactly - one satisfy @xmath257 .    for each satisfying assignment to the variables of the clause @xmath258 of @xmath4 ,",
    "there is exactly one way the assignment can be extended to the variables of the formula @xmath202 so as to exactly - one satisfy @xmath202 .",
    "when @xmath259 , we need to verify that the only exactly - one satisfying assignments @xmath209 are the following :    @xmath260    @xmath261    @xmath262    @xmath263    @xmath264    @xmath265 and    @xmath266    when @xmath267 , we need to verify that the only exactly - one assignments of @xmath209 are the following :    @xmath268 + @xmath269    @xmath270 + @xmath271    @xmath272 + @xmath273    1-ex3sat @xmath199 1-ex3monosat :    let @xmath4 be an instance of 1-ex3sat .",
    "let @xmath274 .",
    "for each @xmath233 construct @xmath202 as follows : replace each negated literal of the form @xmath275 appearing in the clause @xmath233 by a distinct new variable @xmath276 in @xmath233 , then add the clauses @xmath277 @xmath278 . note that for each negated literal , we introduce new copies of the auxiliary variables @xmath279 .",
    "see figure [ 1-ex3-1-3monofig3.fig ] for an example .",
    "let @xmath230 .",
    "then @xmath231 is an instance of 1-ex3monosat obtained from @xmath4 .",
    "the result follows from lemma [ ex - one ] and the fact that for all variables @xmath280 and @xmath281 , @xmath282 is exactly - one - satisfiable _ if and only if _ @xmath283 .",
    "1-ex3monosat @xmath199 x3c :    although dyer and frieze @xcite do not observe this , the reduction given in their paper @xcite from 1-ex3sat to x3c is actually parsimonious .",
    "the reduction presented here is essentially the same as given in @xcite , except that we start from an instance of 1-ex3monosat .",
    "thus in our reduction we do not have to take care of negated literals .",
    "we now describe the reduction . each variable",
    "is represented by a cycle of 3 element sets .",
    "if the variable occurs @xmath284 times in the 1-ex3sat instance then there are @xmath285 sets , with each successive pair of sets sharing an element .",
    "this cycle is augmented with @xmath284 additional sets and @xmath285 elements by adding a 3-set to one of the external elements in each pair .",
    "the 3 elements now corresponding to an appearance of @xmath286 will be called a connector .",
    "the variable @xmath286 is set to true if and only if all three connector elements are covered by the cycle when @xmath286 appears in the corresponding clause .",
    "figure [ x3c1.fig ] illustrates the variable component .",
    "next , consider each clause @xmath287 . each @xmath287",
    "is represented by a configuration shown in figure  [ x3c3.fig ] .",
    "this has 12 elements and 9 sets .",
    "of the 12 elements , 3 are internal and the rest are grouped in groups of 3 .",
    "each group of 3 elements is called a terminal of @xmath287 .",
    "finally , we connect a clause component to the variable component as follows . for each @xmath288",
    "we identify three distinct connector elements with one of the terminals in @xmath287 .",
    "the construction is depicted in figure [ x3c4.fig ] .",
    "let @xmath5 denote the graph obtained as result of the construction .",
    "planarity of @xmath5 follows by the fact that each component replacing a variable and a clause is planar and the components are joined in a planarity preserving way .",
    "we first prove that there is an exact cover of @xmath287 configuration if and only if exactly one terminal is covered externally , when we restrict the covering such that either none or all three of the elements in each terminal are covered externally .",
    "but the configuration has the property that each of the three internal elements appear in 3 of the 9 sets and no two appear in the same set .",
    "it follows that if this configuration forms part of an exact cover by 3-sets , then exactly three of the sets must be used , hence nine of the twelve elements will be covered internally .",
    "moreover this can only be done so that exactly one of the terminals will be left uncovered .",
    "this uncovered terminal is covered by sets in the variable configuration and amounts to setting the literal true .",
    "it can then be argued that the exact cover by 3 sets has a solution if and only if the corresponding 1-ex3monosat instance is satisfiable .",
    "it is easily verified that the reduction is parsimonious .",
    "this is because the clause configuration forces precisely one variable to be set to true and the other two literals to be false .",
    "moreover , for each satisfying assignment of 1-ex3monosat , there is exactly one way the sets can be chosen so as to have an exact cover .",
    "hence , the reduction is parsimonious .",
    "the problems pl - ex3sat , pl-1-ex3sat and + pl-1-ex3monosat are np - complete .",
    "the problems #",
    "pl - ex3sat , # pl-1 - 3sat , # pl-1-ex3sat , # pl-1-ex3monosat and # pl - x3c are # p - complete .    * * * * * * * * * * * * * *    our reduction is essentially the same as that of dyer and frieze except that we start from an instance of 1-ex3monosat .",
    "we briefly mention an application of theorems [ cross ] and [ parsi ] .",
    "a quantified boolean formula is of the form @xmath289 where @xmath290 is a vector of boolean variables , for @xmath291 , @xmath292 is a quantifier free cnf formula , and @xmath293 if @xmath294 is even and @xmath295 if @xmath294 is odd .",
    "the problem qbf is to decide if @xmath169 is satisfiable . without loss of generality",
    "we can assume that @xmath290 s are single variables .",
    "let q - sat and q-3sat be the problem of determining if set of quantified formulas in cnf and 3cnf , form respectively are true .",
    "analogous to the class # p , ladner @xcite defined the class # pspace to be the class of functions @xmath4 such that there is a non - deterministic polynomial space ( nspace ) bounded turning machine @xmath296 such that @xmath297 is equal to the number of distinct accepting computation paths of @xmath296 on @xmath280 . note that for a given @xmath280 the number of distinct accepting computing paths of @xmath296 could be as large as @xmath298 ; thus @xmath299 # pspace can be exponential in length of @xmath280 .",
    "a function @xmath4 is said to be # pspace - hard if each function in the class # pspace is polynomial time _",
    "parsimoniously _ turing reducible to it .",
    "if in addition , @xmath300 # pspace , the problem is said to be # pspace - complete .",
    "note that there is crucial difference in the technique for proving a problem to be # pspace - complete rather than # p - complete . to prove that a problem @xmath3 is # pspace - complete we need a _ parsimonious _ reduction from a known # pspace - complete problem to @xmath3 . in @xcite",
    ", ladner proved that # q-3sat is # pspace - complete .",
    "define a quantified formula to be planar if the bipartite graph associated with the quantifier free part @xmath292 is planar .",
    "we refer the reader to @xcite for additional definitions . as a direct corollary of the parsimonious crossover box",
    ", we get that    the problem # q - pl-3sat is # pspace - complete .",
    "consider an instance @xmath301 , where @xmath302 of the problem q-3sat .",
    "we do the same sequence of steps as in the proofs of theorem [ cross ] .",
    "the auxiliary variables @xmath303 introduced during the reduction are designated as existentially quantified variables .",
    "let @xmath304 be set of clauses in the resulting formula .",
    "hence the instance @xmath5 of the problem q - pl-3sat obtained is given by @xmath305 where @xmath306 , @xmath307 and @xmath308 the following lemma summarizes the property of the reduction .",
    "the lemma follows by the fact that the auxiliary variables @xmath309 in @xmath5 are functionally dependent on the original variables @xmath24 .",
    "[ le : qsat ] ( 1 ) no assignment of truth values to the variables of @xmath20 that does not satisfy @xmath20 can be extended to an assignment of truth values to the variables of the formula @xmath5 that satisfies @xmath5 .",
    "\\(2 ) each assignment to the variables @xmath310 , that satisfies @xmath20 can be extended in a unique way to an assignment to the auxiliary variables @xmath311 , such that @xmath5 is satisfiable .",
    "the proof of the theorem follows from lemma [ le : qsat ] .",
    "the problems q - pl - ex3sat , q - pl-1-ex3sat and q - pl-1-ex3monosat are pspace - complete .",
    "the problems # q - pl - ex3sat , # q - pl-1 - 3sat , # q - pl-1-ex3sat , and # q - pl-1-ex3monosat are # pspace - complete .    * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *",
    "in this section we give parsimonious / weakly parsimonious and planarity preserving reductions from pl-1-ex3monosat to various graph problems .",
    "the problems considered here are minimum vertex cover , minimum dominating set , clique cover , feedback vertex set , partition into claws , partition in triangles and bipartite dominating set .",
    "previously , reductions showing that these problems were np - hard frequently did not preserve the number of solutions .",
    "central to the proofs is the reduction ( called @xmath312 ) from 1-ex3monosat to 3sat with the property that every formula is mapped to a formula in which all satisfying assignments satisfy exactly one literal in each three literal clause .",
    "this in turn enables us to obtain ( weakly ) parsimonious reductions from ex1 - 3monosat to the problems considered here .",
    "* red1 : * let @xmath312 be a mapping from an instance @xmath313 of 1-ex3monosat to an instance @xmath314 of 3sat , where for @xmath315 , @xmath316 @xmath317 @xmath318    the formula @xmath231 has the following properties : + ( 1 ) the satisfying assignments of @xmath231 are * exactly * the exactly - one satisfying assignments of @xmath4 . + ( 2 ) in any satisfying assignment of @xmath231 ,",
    "all but one clause in @xmath202 is exactly - one satisfiable .",
    "+ ( 3 ) each variable in the formula @xmath231 occurs at least twice negated and at least once unnegated .",
    "+ ( 4 ) red1 is planarity preserving.(see figure [ red3.fig ] . ) + ( 5 ) red1 is parsimonious .    by inspection .",
    "we call each of the @xmath202 a _ clause group_. observe that each @xmath202 has four clauses , one of which is a three literal clause and the others are two literal clauses .",
    "[ th : mvc ] there exists a planarity preserving and weakly parsimonious reduction from 1-ex3monosat to each of the following problems : ( 1 ) minimum vertex cover , ( 2 ) minimum dominating set , ( 3 ) minimum feedback vertex set , and ( 4 ) subgraph isomorphism .",
    "\\(1 ) minimum vertex cover :    the reduction is from 1-ex3monosat and is similar to the one given in @xcite for proving np - hardness of minimum vertex cover . let @xmath4 be a 1-ex3monosat formula .",
    "apply @xmath312 to @xmath4 to obtain @xmath231 .",
    "next , starting from @xmath231 construct an instance @xmath319 of the vertex cover problem as shown in figure  [ figvc.fig ] as follows :    consider a clause group @xmath316 @xmath317 @xmath320 corresponding to the clause @xmath321 , construct a triangle with vertices @xmath322 and edges @xmath323 . corresponding to a clause of the form @xmath324 add the edge @xmath325 .",
    "call this the clause graph .    for each variable @xmath280 that appears @xmath149 times",
    "we construct a simple cycle with @xmath326 vertices .",
    "let the odd numbered variables represent the negated occurrences and the even numbered variables represent the unnegated occurrences .",
    "call this the variable graph .",
    "join the vertices of the clause graph to the vertices of the variable graph as follows : consider a clause group @xmath202 .",
    "corresponding to a clause , join the triangle vertices @xmath327 and @xmath328 to the corresponding unnegated occurrences of @xmath329 and @xmath328 in the cycles .",
    "corresponding to a clause of the form @xmath330 , join the two vertices @xmath327 to the negated occurrence of the variables @xmath280 and @xmath281 respectively .",
    "repeat the procedure for each clause group .",
    "now set @xmath331 , where @xmath332 is the length of the cycle of the variable @xmath149 , and @xmath294 is the number of clause groups in @xmath231 .",
    "the reduction is illustrated in figure [ figvc.fig ] .",
    "\\(1 ) the formula @xmath231 is satisfiable if and only if the graph @xmath5 has a vertex cover of size @xmath37 .",
    "+ ( 2 ) the reduction is planarity - preserving and weakly parsimonious .",
    "part 1 : observe that for any vertex cover one needs to pick at least half of the nodes from each cycle , two of the three nodes from each triangle , and one from the simple edge for each two - literal clause .",
    "( recall that there are @xmath25 two - literal clauses in @xmath231 . )",
    "the sum is exactly @xmath37 .",
    "given this observation , the proof is similar to the one given in @xcite .",
    "part 2 : it can be easily verified by observing figure [ figvc.fig ] that the reduction is planarity preserving . to see that for each distinct satisfying assignment of @xmath231 , there are @xmath333 distinct vertex covers of size @xmath37",
    ", one observes that for each satisfying assignment , all but one clause in each clause group has only one true literal .",
    "this forces the choice of vertices from the clause graph , for all clauses having only one true literal . for each satisfying assignment and for each clause group",
    "there is one clause in the clause group in which both the literals are true . for each such clause",
    "any of the two vertices can be included in the vertex cover .",
    "since there are @xmath294 clause groups , we have @xmath294 such clauses and hence we have @xmath333 different vertex covers for each satisfying assignment .    note",
    "that our reduction shows that counting the number of vertex covers of size @xmath334 is # p - hard even if there are * no * vertex covers of size strictly less than @xmath151 . for the next two results , we use such an instance of # -vertex cover for our reductions .",
    "( 2)minimum dominating set :    the reduction is from the minimum vertex cover problem .",
    "the reduction in @xcite from vertex cover to dominating set can be easily modified to get a parsimonious reduction .",
    "let @xmath335 , @xmath336 be an instance of the minimum vertex cover problem .",
    "we construct an instance @xmath337 of the minimum dominating set problem as follows .",
    "there is one vertex in @xmath338 corresponding to every vertex in @xmath339 . for each edge in @xmath340",
    "we also introduce two additional vertices and join them to the two endpoints of the original edge .",
    "formally , @xmath341 , and @xmath342 , where @xmath343 @xmath344 @xmath345 @xmath346    @xmath340 has a minimum vertex cover of size @xmath151 if and only if @xmath347 has a minimum dominating set of size @xmath151 .",
    "furthermore , the reduction is planarity - preserving and parsimonious .",
    "it is easy to see that the reduction is planarity preserving .",
    "consider a minimum vertex cover @xmath348 of @xmath340 . corresponding to @xmath349 we claim that there is exactly one dominating set in the graph @xmath347 , namely the vertex set @xmath350 .",
    "first note that for each edge in the original graph @xmath5 we have 4 new edges and 2 new vertices in @xmath347 .",
    "consider a pair of nodes of the form @xmath351 connected to the nodes @xmath352 and @xmath353 .",
    "it is clear that the only way to dominate both @xmath351 by using only one node is to include one of @xmath352 or @xmath353 in the dominating set .",
    "we need to consider two cases .",
    "first consider the case when exactly one of @xmath354 or @xmath286 is in @xmath349 .",
    "then it is clear that there is exactly one dominating set @xmath355 in @xmath347 corresponding to @xmath349 .",
    "when both @xmath354 and @xmath286 are in @xmath349 , the minimality of @xmath349 implies that at least one edge incident on @xmath354 and at least one edge incident on @xmath286 are covered solely by @xmath354 and @xmath286 respectively .",
    "this implies that both @xmath352 and @xmath353 have to be in any feasible dominating set of @xmath347 .",
    "thus we have exactly one dominating set @xmath355 in @xmath347 corresponding to the vertex cover @xmath349 in @xmath340 .",
    "conversely , consider a minimum dominating set @xmath350 of size @xmath151 in @xmath347 .",
    "consider an edge @xmath356 in @xmath5 . if @xmath352 and @xmath353 are not in @xmath355 , then by construction of @xmath347 , both @xmath357 and @xmath358 are in @xmath355 .",
    "but we could then construct a new dominating set @xmath359 of @xmath347 where @xmath360 clearly @xmath361 which is a contradiction to the assumption that @xmath355 is a minimum dominating set .",
    "thus , @xmath355 does not contain any vertex from the set @xmath362 .",
    "we now claim that @xmath348 is a vertex cover of @xmath5 .",
    "the claim follows by observing that corresponding to each edge @xmath363 , at least one of the vertices @xmath364 are in the set @xmath355 .",
    "we have already argued that @xmath365 .",
    "thus one of @xmath366 is in @xmath355 .",
    "the corresponding vertex in @xmath349 is seen to cover the edge @xmath367 .",
    "( 3)feedback vertex set :    the reduction is from minimum vertex cover problem .",
    "starting from an instance @xmath368 of the minimum vertex cover problem , we construct the graph @xmath347 that is identical to the one given for the minimum dominating set problem . by arguments similar to those given in the proof of minimum dominating set problem",
    ", it is easy to that the @xmath340 has a minimum vertex set of size @xmath37 if and only if @xmath347 has a feedback vertex set of size @xmath37 and that the reduction is parsimonious .",
    "\\(4 ) subgraph isomorphism :    follows directly by taking the graph @xmath369 to be a simple cycle on @xmath370 nodes , and the weakly parsimonious reduction from 3sat to the hamiltonian circuit problem given in provan @xcite .",
    "the problems # pl - minimum vertex cover , # pl - minimum dominating set # pl - minimum feedback vertex set and # pl - subgraph isomorphism are # p - complete .      in this section",
    "we briefly discuss why the reductions studied by @xcite and @xcite from x3c to various other graph problems are parsimonious and planarity preserving .",
    "there exist planarity - preserving and parsimonious reductions from x3c to each of the problems ( 1 ) minimum clique cover , ( 2 ) partition into claws , ( 3 ) bipartite dominating set , ( 4 ) partition into triangles and ( 5 ) minimum hitting set .",
    "\\(1 ) minimum clique cover :    the reduction is the same as given in @xcite . given an instance @xmath371 of x3c such that @xmath372 and @xmath373",
    ", we construct an instance @xmath5 of the minimum clique cover problem such that @xmath5 has a clique cover with cliques of size 3 if and only if @xmath10 has a solution .",
    "the reduction consists of replacing each triple in the instance of @xmath10 by a triangle and by replacing an edge from a triple to an element by a set of triangles .",
    "the reduction is illustrated in figure [ cliquecover.fig ] .",
    "formally , for each element , we have a vertex in @xmath5 .",
    "corresponding to each triple @xmath374 , and the associated edges @xmath375 we create the subgraph as shown in figure [ cliquecover.fig ] .",
    "the graph @xmath5 obtained by carrying out the above reduction for each triple has @xmath376 vertices and @xmath377 edges .",
    "the reduction is planarity preserving as each component is planar and they are joined in a planarity preserving way .",
    "we claim @xmath10 has a solution if and only if @xmath5 has a clique cover of size ( @xmath378 ) . in particular",
    "as shown in @xcite , if @xmath379 are the set of triples in an exact cover then the corresponding clique cover is constructed by taking @xmath380 whenever @xmath381 is in the exact cover and by taking the cliques @xmath382 when the corresponding triple @xmath383 is not in the exact cover .",
    "conversely , since @xmath5 has @xmath384 vertices , if @xmath5 has a clique cover of size @xmath378 it implies that each clique consists of exactly 3 vertices .",
    "( recall we do not have cliques of size four in @xmath5 . ) the corresponding exact cover is given by choosing those @xmath385 such that the triangles @xmath386 are in the clique cover . finally , we prove that the reduction is parsimonious . first note that if the triple triangle @xmath387 is not chosen then we have to choose the triangles @xmath388 so as to cover the triple vertices .",
    "second , once the triangle @xmath387 is chosen there is exactly one way for the auxiliary nodes ( and thus the element nodes ) to be covered ; namely the lower triangle corresponding to the covering triple , i.e. choosing the triangles @xmath389 these observations immediately imply that the reduction is parsimonious .",
    "\\(2 ) partition into claws :    the reduction is from x3c and is the same as the one given in @xcite .",
    "the reduction consists of the following steps .",
    "construct the bipartite graph @xmath390 corresponding to the given instance @xmath391 of x3c .    as in @xcite",
    ", we assume that each element vertex , appears in either two or three sets , i.e. the element vertices have a degree 2 or 3 .",
    "for each element of degree 3 , we add an extra edge and for each element of degree 2 , we add two extra edges .",
    "this is shown in figure [ claws.fig ] .",
    "let @xmath340 denote the resulting graph .    clearly the reduction is planarity preserving .",
    "we now recall the proof in @xcite to show that the edges of @xmath340 can be partitioned into a disjoint set of claws .",
    "note that each element vertex is adjacent to either 1 or 2 vertices of degree 1 , it follows that each element node must be the center of at least one claw .",
    "but each such element node has degree 4 and hence can be the center of exactly one claw . after removing the claws from @xmath340 the resulting graph @xmath347 has the property that all element nodes have degree 1 .",
    "this implies that the only way to partition @xmath347 into claws is for each triple to have a degree of 0 or 3 .",
    "thus the triples with degree 3 induce a solution for the x3c in an obvious way .",
    "conversely , given a solution for @xmath10 , the above argument can be reversed to yield a partition of the edges in @xmath340 into claws .",
    "the following observations immediately imply that the reduction is parsimonious .",
    "there is a unique way to pick the claws in @xmath340 with the element nodes as centers .    in @xmath347 , each triple vertex has degree 3 or 0 and each element node has degree 1 in @xmath347 .",
    "\\(3 ) bipartite dominating set :    reduction from x3c .",
    "the construction is similar to that in @xcite .",
    "let @xmath371 be an instance of pl - x3c with each element occurring in at most 3 triples .",
    "we first construct the bipartite graph @xmath5 associated @xmath10 .",
    "next , we attach a 2-claw ( @xmath392 ) to each triple vertex in @xmath5 as shown in figure  [ dominating.fig ] .",
    "( in @xcite , they add a path of length 2 . )",
    "let @xmath393 denote the graph obtained as a result of the transformation .",
    "the construction is depicted in figure  [ dominating.fig ] . since @xmath5 is bipartite and we added a claw as shown in figure [ dominating.fig ]",
    ", it follows that @xmath393 is also bipartite .",
    "also note that the reduction is planarity preserving and thus @xmath393 is planar .",
    "let the number of triples be @xmath294 and the number of elements be @xmath394 .",
    "then we set @xmath395 .",
    "now by arguments similar to those in @xcite , it is easy to see that @xmath393 has a dominating set of size @xmath151 if and only if @xmath10 has a exact cover of size @xmath396 .",
    "we prove the reduction is parsimonious .",
    "consider a solution @xmath397 for @xmath10 . since each triple in the solution covers three distinct element nodes , these element nodes can not be used to dominate the vertices in @xmath393 without increasing the cardinality of the solution for @xmath393 .",
    "this means that for each of the @xmath396 triples chosen in the solution @xmath397 , we have exactly one node in @xmath393 that can be used in the dominating set so as to dominate all the element nodes . moreover due to the constraints on the size of the dominating set in @xmath393 , it follows that we can select exactly one vertex per claw ( the vertex with degree 3 and marked @xmath56 ) in the dominating set .",
    "these observations imply that the reduction is parsimonious .",
    "\\(4 ) partition into triangles :    the reduction is from x3c and is the same as the reduction described in the proof of clique cover .",
    "given that the resulting graph has no cliques of size 4 , the proof follows .",
    "( 5)minimum hitting set :    as given in @xcite , each instance of vertex cover can be seen to be an instance of hitting set , in which every edge @xmath398 corresponds to the set @xmath399 .",
    "the elements of the set are simply the nodes of the graph .",
    "the result now follows by noting that there is a weakly parsimonious reduction from 3sat to minimum vertex cover .",
    "the problems # pl - minimum clique cover , # pl - partition into claws , # pl - bipartite dominating set , # pl - partition into triangles , and # pl - minimum hitting set are # p - complete .",
    "let @xmath3 be one of the problems in table 1 .",
    "it is # p - complete to count the number of solutions to @xmath3 , even when one is given an instance of @xmath3 and a solution which is guaranteed to satisfy @xmath3 .",
    "starting from a 3cnf formula obtained in the proof of theorem [ ambi ] , we now do the same set of reductions discussed in the earlier theorems to obtain an instance of the problem @xmath3 . since we know that the 3cnf formula is satisfiable",
    ", it follows that the instance of @xmath3 has a solution .",
    "our parsimonious planar crossover box for 3sat can also be used to show that additional problems for planar cnf formulas are _ as hard as _ the corresponding problems for arbitrary cnf formulas , with respect to polynomial time or random polynomial time reducibilities .",
    "we briefly describe these results .",
    "we first recall the definitions of d@xmath0 and random polynomial time reductions from @xcite .",
    "[ def5.1 ] d@xmath0 @xmath400 .",
    "+ intuitively , a problem is in d@xmath0 if it can be solved by asking one question in np and one question in co - np .",
    "[ def5.2 ] problem @xmath169 is reducible to problem @xmath292 by a randomized polynomial time reduction if there is a randomized polynomial time turing machine @xmath34 and a polynomial @xmath396 such that    @xmath401 \\not\\in b ] .$ ]    @xmath402 \\in b$ ] with probability at least @xmath403 $ ] . @xmath117",
    "[ unique - pl-3sat ] unique - pl-3sat is d@xmath0-complete under randomized polynomial time reductions .",
    "we modify the proof of the d@xmath0-completeness of unique sat in @xcite , so that whenever their reduction outputs a boolean formula @xmath4 , output the planar formula pl@xmath404 obtained by applying the parsimonious planar crossover box to @xmath4 .",
    "the formula pl@xmath404 has exactly the same number of satisfying assignments as @xmath4 .",
    "in particular , pl@xmath404 is uniquely satisfiable if and only if @xmath4 is uniquely satisfiable .",
    "a second example is the following :    [ amb - pl-3sat ] ambiguous - pl-3sat is np - complete .",
    "given an instance of an arbitrary 3cnf formula @xmath4 , we first construct a new formula using the same construction as in step 1 of theorem [ ambi ] .",
    "as pointed out in the proof of theorem [ ambi ] , the new formula is ambiguously satisfiable if and only if the original formula is satisfiable .",
    "we then do the same sequence of reductions as in theorem  [ ambi ] to obtain a planar formula that is ambiguously satisfied if and only if the original formula is satisfied .    using the ideas similar to those in the proof of theorem [ 1-valid ]",
    ", we can prove that    [ amb-1-val - pl-3sat ] ambiguous-1-valid pl-3sat is np - complete .",
    "unique-1-valid pl-3sat is co - np - complete .    to prove the membership in co - np , consider an arbitrary formula + @xmath405 which is an instance of 1-valid pl-3sat . by the definition of 1-valid formulas an assignment * v * to the variables such that * v*[@xmath137 @xmath138 * v*[@xmath139 @xmath406 * v*[@xmath141 @xmath407 .",
    "satisfies @xmath405 .",
    "now consider the formula @xmath408 .",
    "@xmath20 is uniquely satisfiable if and only if @xmath369 is unsatisfiable .",
    "to prove co - np - hardness , given a formula @xmath409 , we construct a formula @xmath210 such that    @xmath410 \\bigvee ( \\overline{x_1 } \\wedge \\overline{x_2 } \\ldots \\overline{x_{n+1}})$ ]    now using ideas similar to those in the proof of theorem [ 1-valid ] , we obtain a planar formula @xmath411 with the following properties : + ( 1 ) @xmath411 is 1-valid . + ( 2 ) @xmath411 is uniquely satisfiable _ if and only if _ @xmath4 is unsatisfiable .    combining our parsimonious planar crossover box for 3sat and the reductions to prove theorem [ parsi ]",
    ", we get that exact analogues of theorems  [ unique - pl-3sat]- [ amb-1-val - pl-3sat ] hold for each of the problems : ex3sat,1 - 3sat , 1-ex3sat and 1-ex3monosat .",
    "thus , we have the following corollary .",
    "let @xmath3 be one of the following problems : ex3sat , 1 - 3sat , 1-ex3sat and 1-ex3monosat .",
    "then the problem ambiguous - pl-@xmath3 is np - complete and the problem unique - pl-@xmath3 is d@xmath0-complete under randomized polynomial time reductions .    as a corollary of our parsimonious reductions ,",
    "the unique versions of many graph problems are also d@xmath0-complete .",
    "let @xmath3 be one of the problems pl - partition into triangles , partition into claws , bipartite dominating set .",
    "then the problem ambiguous-@xmath3 is np - complete and the problem unique-@xmath3 is d@xmath0-complete under randomized polynomial reductions .    given that each reduction in the sequence of reductions 3sat @xmath199 pl-3sat @xmath199 pl - ex1 - 3sat @xmath199 pl - x3c is parsimonious , the fact that unique 3sat is d@xmath0-complete and the reduction from x3c to each of the problems mentioned above is parsimonious , the proof of the corollary then is similar to the proof of theorem  [ amb - pl-3sat ] .",
    "next , we give an application of our result that ambiguous pl-3sat is np - complete and prove that it is not possible to approximate the optimal value of the objective function of a integer linear program .",
    "an instance of integer linear program ( ilp ) consists of a system of linear inequalities and an objective function which is to be maximized(minimized ) ; i.e. maximize(minimize ) * c*@xmath280 , subject to the constraints * a*@xmath412 * b*. the variables @xmath280 are allowed to take only integer values .",
    "we say that a minimization problem @xmath3 is @xmath2-approximable , @xmath413 , ( or has an @xmath2-approximation ) if there is a polynomial time algorithm that given an instance @xmath414 finds a solution which is within a factor @xmath2 of an optimal solution for @xmath10 .    [ ilp ] unless p = np , given an instance of the problem ilp and a feasible solution , the maximum ( minimum ) value of the objective function is not polynomial time @xmath2-approximable for any @xmath413 , even when the bipartite graph associated with the set of constraints is planar .",
    "we prove the theorem for the maximization version of the problem .",
    "the proof for the minimization version is similar and hence omitted .",
    "* step 1 : * given a 3sat formula @xmath409 , we construct a formula    @xmath410 \\vee ( \\overline{x_1 } \\wedge \\overline{x_2 } \\ldots \\overline{x_{n+1}})$ ]    it follows that for any assignment * v * , * v*[@xmath415 @xmath416 if and only if either ( i ) * v*[@xmath409 ] @xmath416 and * v*[@xmath418 = 1 $ ] , _ or _",
    "( ii ) * v*[@xmath137 @xmath419 * v*[@xmath139 @xmath420 * v*[@xmath142 @xmath105 . * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * proof : * the proof of claim  [ cl : old5.8 ] is very similar to the proofs of claims 3.7 and 3.8 in theorem [ ambi ] . * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *    * step 2 : * starting from @xmath421 , we construct pl-3sat formula + @xmath422 such that @xmath422 is satisfiable if and only if @xmath423 is satisfiable .    * * * * * * * * @xmath424 with the property that for any assignment * v * , + * v*[@xmath422 ] @xmath416 if and only if * v*[@xmath423 ] @xmath416    * * * * * * *    the construction can be carried out in a similar fashion as in step 2 in proof of theorem [ ambi ] .",
    "we therefore omit the details here .",
    "* step 3 : * let @xmath427 .",
    "construct a new 1-ex3-monosat formula @xmath428 from @xmath429 such that @xmath429 is satisfiable if and only if @xmath428 is satisfiable .",
    "let @xmath430 .",
    "replace each clause @xmath431 by the inequality @xmath432 .",
    "all the inequalities corresponding to the clauses make up the constraints .",
    "we also add constraints that @xmath433 .",
    "the objective function is now simply @xmath434 .",
    "it is easy to verify that the maximum value of the objective function is exactly @xmath435 if @xmath409 is satisfiable and is 0 otherwise .",
    "hence it follows that unless p = np the problem ilp has no polynomial time @xmath2-approximation algorithm for any @xmath436 .    * * * * * * * * * proof : * if @xmath409 is satisfiable then we can satisfy the formula @xmath429 by giving any assignment to @xmath434 . specifically , all the constraints are satisfied by assigning @xmath434 to 1 . therefore the maximum value of the objective function is at least @xmath435 .    on the other hand @xmath409 is not satisfiable then it follows that the only way all the constraints can be satisfied is by setting @xmath437 . therefore the value of the objective function is 0 . * * * * * * * * * * * * *    * * * * * * * * * * * similar ideas can be used to prove that    unless p = np , given an instance of the problem ilp and a feasible solution , the minimum value of the objective function is not polynomial time @xmath2-approximable for any @xmath413 even when the bipartite graph associated with the set of constraints is planar .",
    "* proof : * given a 3sat formula @xmath409 , we construct a formula    @xmath438 \\bigvee ( x_{n+1})$ ] <    the rest of the proof is similar to the proof of theorem [ ilp ] . @xmath117",
    "* * * * * * * * * * * * * *",
    "we showed that for many problems @xmath3 studied in the literature , the problem # pl-@xmath3 , ambiguous - pl-@xmath3 and unique - pl-@xmath3 are _ as hard as _ the respective problems # @xmath3 , ambiguous-@xmath3 and unique-@xmath3 with respect to polynomial time or random polynomial time reducibilities .",
    "we note that the problem # pl - hamiltonian - cycle was proved to be # p - complete by provan @xcite .",
    "we can give an alternate proof of the # p - hardness of # pl - hamiltonian - cycle by a reduction from a variant of @xmath312 .",
    "the reduction is significantly more complicated than that in @xcite .",
    "consequently , we omit it here .    as corollaries of our results , we have shown that many planar problems are complete for the class np , # p and d@xmath0 .",
    "our results and their proofs provide the following general tools for proving hardness results for planar problems :    we have shown how parsimonious and weakly parsimonious crossover boxes can be used to prove the # p - hardness of many planar counting problems .",
    "these ideas were used to prove the # p - hardness of problem # 1-valid pl-3sat .",
    "we extended the class of basic planar cnf satisfiability problems that are known to be np - complete .",
    "previously only pl-3sat @xcite and pl-1-ex3sat @xcite were known to be np - hard .",
    "we expect that the variants of the problem pl-3sat shown to be np - hard here will be useful in proving hardness results for many additional planar problems .",
    "in particular , we have already shown that the problem pl-1 - 3monosat and its variant _ red1 _ are especially useful in proving the # p - hardness of many planar graph problems .",
    "we have shown that the problem ambiguous - pl-3sat can be used to prove the non - approximability of linear integer programming .",
    "recently , there has been a lot of research in the area of approximability of graph and combinatorial problems and the tools for showing negative results are few .",
    "our proof of the non - approximability of the minimum or maximum objective value of an integer linear program is direct and significantly different from the proof given in kann @xcite or zuckerman @xcite .",
    "moreover , in @xcite , we show how to use the np - completeness of ambiguous - pl-3sat to show the non - approximability of several constrained optimization problems even when restricted to _ planar instances_. ( the results in @xcite do not hold for planar instances . )      can natural planar problems be found that are complete for additional complexity classes such as pspace , # pspace , max snp , max @xmath439 etc ?",
    "( in recent papers @xcite , we partially answer this question by showing that a number of problems are complete for the classes pspace , # pspace , max - snp , max @xmath439 , even when restricted to planar instances . )    valiant @xcite has shown that the problem # 2sat is # p - complete .",
    "how hard is the problem # pl-2sat ?",
    "we conjecture that the problem is # p - complete , but it seems to us that different techniques than the ones used here are required to prove this .",
    "we have shown that many unique satisfiability problems are complete for d@xmath0 , even when restricted to planar instances . using our parsimonious reductions",
    ", we then proved the d@xmath0-completeness of a number of graph problems for planar graphs .",
    "a number of such problems for planar graphs remain open .",
    "for example , how hard is the problem unique - pl - hamiltonian circuit ?",
    "do results similar to the ones proved in this paper hold for other restricted classes of graphs , e.g .. intersection graphs of unit disks and squares ? such graphs have been studied extensively by @xcite in context of image processing , vlsi design , geometric location theory , and network design .",
    "* acknowledgments : * we thank the anonymous referee for invaluable suggestions .",
    "these suggestions significantly improved the quality of presentation and helped us in correcting a number of errors in the earlier draft .          * * * * * * a.bertoni , g.mauri , n.sabadini , `` a characterization of the class of functions computable in polynomial time on random access machines '' , proc .",
    "13th annual acm symposium on theory of computing , pp.168 - 176 , 1981 . * * * * * * * * *                , _ local reductions , generalized satisfiability , complexity and efficient approximability : i _ , in preparation . a preliminary version of the paper appears in proc .",
    "9th acm conference on structure in complexity theory , june - july 1994 , pp .",
    "356 - 366 .    , _ local reductions , generalized satisfiability , complexity and efficient approximability : ii _ , in preparation . a preliminary version of the paper appears in proc .",
    "9th acm conf . on structure in complexity",
    "theory , june - july 1994 , pp . 356",
    "- 366 .    , _ parallel approximation schemes for planar and near - planar satisfiability and graph problems _ , submitted , april , 1996",
    ". a preliminary version appears in proc .",
    "of 14th foundations of software technology and theoretical computer science ( fst & tcs ) , lncs 761 , springer verlag , december 1994 , pp .",
    "342 - 353 . a complete version of the paper appears as technical report no .",
    "la - ur-96 - 2723 , los alamos national laboratory , 1996 .          ,",
    "_ monte carlo algorithms for enumeration and reliability problems _ , 24th acm symp . on theory of computing , 1983 ,",
    "pp 54 - 64 .",
    "a complete version appears in journal of complexity , 1(1):45 - 64 , october 1985 .          , _ complexity of hierarchically and 1-dimensional periodically specified problems _",
    ", technical report no .",
    "la - ur-95 - 3348 , los alamos national laboratory , august 1995 .",
    "also presented at the _ dimacs workshop on satisfiability problem : theory and applications , _ march 1996 .            , _ descriptive complexity of # p functions _ , journal of computer and system sciences , 50(3):493 - 505 , june 1995 .",
    ", _ two papers on graph embedding problems _ , technical report , dept of comp .",
    "science , carnegie mellon university , cmu - cs-80 - 102 , 1980 .",
    ", _ np - complete problems have versions that are hard to approximate _ , in proc .",
    "8th annual acm conference on structure in complexity theory , 1993 , pp 305 - 312 .",
    "a complete version titled _ on unapproximable versions of np - complete problems _ appears in siam journal on computing , 25(6):1293 - 1304 , december 1996 ."
  ],
  "abstract_text": [
    "<S> we prove the # p - hardness of the counting problems associated with various satisfiability , graph and combinatorial problems , when restricted to planar instances . </S>",
    "<S> these problems include    3sat , 1 - 3sat , 1-ex3sat , minimum vertex cover , minimum dominating set , minimum feedback vertex set , x3c , partition into triangles , and clique cover .    </S>",
    "<S> we also prove the np - completeness of the ambiguous satisfiability problems @xcite and the d@xmath0-completeness ( with respect to random polynomial reducibility ) of the unique satisfiability problems @xcite associated with several of the above problems , when restricted to planar instances . </S>",
    "<S> previously , very few # p - hardness results , no np - hardness results , and no d@xmath0-completeness results were known for counting problems , ambiguous satisfiability problems and unique satisfiability problems , respectively , when restricted to planar instances .    </S>",
    "<S> assuming p @xmath1 np , one corollary of the above results is    there are no @xmath2-approximation algorithms for the problems of maximizing or minimizing a linear objective function subject to a planar system of linear inequality constraints over the integers .    </S>",
    "<S> planar , 3sat , graphs , # p - complete , d@xmath0-complete , np - complete    68q15 , 68r10 .    </S>",
    "<S> [ theorem]claim </S>"
  ]
}