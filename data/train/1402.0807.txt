{
  "article_text": [
    "theoretical understanding of correlated electron systems is often hindered by the exponential scaling of the computation time and memory required as a function of system size . for systems where the local density or hartree fock approximations fail",
    ", there exists a real computational problem . obtaining quantum chemical _ ab initio _",
    "solutions is impossible for many systems.@xcite even small systems containing only three or four open @xmath0- or @xmath1-shell ions can be too large to compute .",
    "nonetheless , one can obtain information on open shell compounds in the approximation of a single correlated site interacting with mean - field approximated neighbors or bath sites .",
    "such an embedded impurity in a mean - field approximated bath can either be realized by the requirement that the density or the one particle green s function is equivalent on the mean - field approximated sites and the impurity .",
    "the latter results in the dynamical mean field theory ( dmft).@xcite in either case the one - particle energies and hopping integrals can be obtained directly from density functional theory,@xcite or hartree fock calculations.@xcite    in the case of transition metal oxides , the mean - field approximated neighbors are , in first approximation , the ligand o atoms .",
    "if one only includes a single transition metal impurity interacting with ligand orbitals , one obtains multiplet ligand field theory.@xcite ligand field theory is one of the oldest methods used to solve the schrdinger equation .",
    "nonetheless , for correlated insulators it is still a very powerful approximation .",
    "for correlated metals , ligand field theory is clearly not sufficient . in this case",
    "one needs to include a full band , which leads to an anderson impurity model . in an ( cluster )",
    "anderson impurity model there are @xmath2 partially filled impurity levels ( spin , orbital and cluster site ) with correlations between the electrons occupying these levels , each interacting with @xmath3 partially filled bath sites .",
    "this is a highly nontrivial problem whereby in general the basis size scales exponentially in the number of total sites and levels ( @xmath4 ) included in the problem .",
    "nonetheless , an infinite anderson impurity model can be solved .",
    "several methods are available ; each has its virtues , but all have shortcomings .    since the introduction of dmft there has been an enormous development on how to solve an anderson impurity hamiltonian",
    ". for the single - site hubbard model there exist beautiful solutions using numerical renormalization group ( nrg ) theory@xcite or density renormalization group theory.@xcite these methods are hard to apply to situations with multiple interacting orbitals or sites .",
    "hirsch fye ( hf),@xcite and continuous time ( ct ) @xcite quantum monte carlo ( qmc ) methods can be rather efficient for the single site hubbard model as well as some extensions including several correlated fermions , but seem to have problems with low symmetry interactions and systems where the green s function has off - diagonal terms .",
    "a further drawback of qmc implementations is the use of imaginary instead of real frequencies , which leads to an ill - conditioned inversion problem.@xcite    exact diagonalization ( ed ) techniques@xcite can be applied very generally , are implemented using real frequencies , and pose no requirement on the hamiltonian other than that it should be reasonably sparse . the problem with this method , though , is that the mean - field approximated bath has to be represented by a small number of discrete states in order to keep the exponentially growing many - body hilbert space tractable.@xcite this can be improved by selecting a certain subset of many - body states as the basis .",
    "reasonable results for a single ce @xmath5 shell interacting with a free - electron - like band have been obtained by selecting only certain basis functions.@xcite the question of which states to include can be formalized using a configuration interaction@xcite or coupled cluster expansion.@xcite for dmft on the bethe lattice one can , with the use of a configuration interaction expansion of the basis , optimize the basis in such a way that one can obtain a converged ground state.@xcite the configurations included in these calculations are optimized to represent the ground state , but not the excited states needed in the calculation of the one - particle green s function .",
    "presently , configuration interaction calculations do not converge the green s function , which is an important ingredient in dmft .    here",
    "we show how a general solution of the dynamical mean - field equations can be obtained .",
    "we use an ed technique which can include the full rotational invariant coulomb interaction , spin - orbit coupling as well as low - symmetry interactions . in the current paper",
    "we show the solution of the hubbard model on a bethe lattice at @xmath6 .",
    "extensions to higher temperatures might be possible , but have not been tested.@xcite the impurity solver has been used in several multiorbital or multisite calculations@xcite and the inclusion of five ( open @xmath0-shell ) or seven ( open @xmath1-shell ) correlated orbitals or eight ( two dimensional cluster ) correlated sites coupled to several hundreds of uncorrelated bath sites is in principle possible , albeit not yet implemented in the dmft scheme .",
    "the method presented here is similar to a recently independently implemented variational approach based on the configuration interaction expansion by lin and demkov.@xcite as shown in their publication , it is crucial to use an optimized bath parametrization , which they obtain with the use of natural orbitals .",
    "the main difference with our method is that we do not use a configuration interaction expansion of the many - body basis states , but search for the @xmath7 slater determinants with the largest contribution in the full basis .",
    "we thus do not need to set the configurations before the calculation starts , but establish during the calculation which determinants need to be included .",
    "this leads to a different basis for the ground state and excited states .",
    "the resulting method allows for the inclusion of several hundreds of discretized bath sites . on this basis",
    "we are able to find a converged ground state as well as a converged green s function .",
    "in the main part of the paper we first introduce how to implement the dmft self - consistency loop using numerically stable matrix operations on real frequency representations of the green s functions and self - energy .",
    "we continue by showing how one can solve the anderson impurity problem using ed including several hundred bath sites .",
    "the paper is written to convey the general idea and overview of the method without too much detail .",
    "additional details and mathematically rigorous definitions are placed in the appendixes . after the method is introduced , we show results for the hubbard model on a bethe lattice as a function of @xmath8 and number of discretized bath sites .",
    "an important result is that the critical value of @xmath8 , for which the metal insulator transition takes place , depends on the number of sites included .",
    "we compare our results to analytically known sum rules , to nrg results by bulla,@xcite as well as to results obtained from qmc calculations .",
    "good agreement in terms of the quasiparticle weight and bandwidth is obtained .",
    "the same is true for the hubbard bands , which show the same weight , position , and width as found in other methods .",
    "appendix [ app : notation ] discusses the notation used in this paper . in appendix",
    "[ app : gtrans ] we show the relation between different representations of the green s function . in appendix",
    "[ app : lanc ] the lanczos algorithm is explained . in appendix",
    "[ app : lancsparse ] we discuss the optimized many electron sparse slater determinant basis used in the lanczos algorithm . appendix [ app : natorb ] explains the optimized one particle basis functions or orbitals used . in appendix [ app : polered ] we discuss the reduction of poles in the green s functions used , which is equivalent to choosing an optimized number of one - electron basis functions to represent the anderson impurity hamiltonian .",
    "and represented by a square .",
    "the bath sites are labeled by @xmath9 [ panels ( a ) and ( b ) ] or by @xmath10 , @xmath11 , and @xmath12 .",
    "the site occupation is indicated by the filling . for efficient calculations bath sites should either be occupied or empty.,scaledwidth=45.0% ]    the self - consistency loop in the dmft calculations breaks down in four parts.@xcite in the calculation one repeats",
    "steps 1 to 4 until the bath and impurity green s function are converged and do not change between loops .",
    "most dmft implementations use green s functions represented on imaginary frequencies in the self - consistent loop . as",
    "the transformation between green s functions represented on the real and imaginary axis is bijective , this is possible without loss of information .",
    "the disadvantage is that the transformation is also ill conditioned , which requires one to use extraordinarily large numerical accuracy on the imaginary axis.@xcite to circumvent these numerical problems we perform the entire calculation using green s functions represented on the real - frequency axis .",
    "the green s functions and self - energy are expressed as a sum over delta functions , which can be related to the resolvent of a matrix .",
    "one can apply unitary transformations on the matrix representing the green s function without changing the green s function and this is used during the self - consistency loop .",
    "important to note is that during the entire calculation the green s function is expressed as a discrete sum of delta functions with zero width with variable weight and energy .",
    "these poles representing the green s functions and self - energy are never replaced by a sum over lorentzians with finite broadening inside the self - consistency loop .",
    "a finite broadening is included only when plots on the real axis are made . more details about the different representations can be found in appendix [ app : gtrans ] .",
    "below we show the dmft self - consistency loop as implemented in this paper based on green s functions and self energies represented by a sum of delta functions on the real - frequency axis .",
    "we start our self - consistency loop with a known ( @xmath6 ) retarded bath green s function [ @xmath13 . this could be the noninteracting green s function [ @xmath14 if no better approximation is known .",
    "the first task is to define the anderson impurity hamiltonian ( @xmath15 ) , given the bath green s function .",
    "this is a straight - forward task .",
    "the bath green s function is defined and stored by @xmath16 numerical values of @xmath17 and @xmath3 values of @xmath18 as @xmath19 @xmath3 defines the number of discretization points of the green s function as well as the number of bath orbitals in the anderson impurity hamiltonian .",
    "this form of the green s function can easily be obtained from any other representation as shown in appendix [ app : gtrans ] . for cases where the impurity consists of multiple orbitals , sites or spin states ,",
    "@xmath20 and @xmath21 are matrices of dimension @xmath2 by @xmath2 , with @xmath22 labeling the internal spin , orbital and site degree of freedom of the impurity .",
    "we as much as possible suppress summations over @xmath22 using the definitions as given in appendix [ app : notation ] .",
    "the anderson impurity hamiltonian has , besides the additional correlations on the impurity site , an interaction of @xmath23 with a bath site at onsite energy @xmath24 .",
    "graphically , one can represent this hamiltonian and green s function with a single impurity interacting with @xmath3 bath sites as shown in panel ( a ) of figure [ fig : structure ] . in formula",
    "this is @xmath25 with @xmath26 ( @xmath27 ) labeling the impurity ( bath ) and @xmath28 an index for the different discretized bath states .",
    "@xmath29 is the many - body hamiltonian which only acts on the impurity sites , @xmath30 with @xmath31 and @xmath8 numerical parameters defining the one- and two - electron parts of the many - body hamiltonian and @xmath22 being an index for the different fermion quantum states ( orbital , spin , and site ) within the impurity , which here has been written out explicitly .",
    "once the anderson impurity hamiltonian is known , the ground state of this hamiltonian is obtained and the impurity green s function [ @xmath32 is calculated .",
    "this step is discussed in more detail in the next section .",
    "here we just state that the resulting impurity green s function can be expressed as @xmath33 with @xmath34 and @xmath35 numerical values defining the green s function .",
    "@xmath36 defines the number of poles in the impurity green s function and should be at least as large as the number of poles in the bath green s function and probably even slightly larger . in the current paper we use @xmath37 .      from the bath green s function and the impurity green s function",
    "one can calculate the impurity self - energy:@xcite @xmath38 using the previous definitions of @xmath39 and @xmath40 this yields @xmath41 which can be regrouped as @xmath42 with @xmath43 and @xmath44 numerical values defining the self - energy as a function of @xmath45 .    in order for the self - energy to represent a physical quantity ,",
    "@xmath46 must be larger than zero .",
    "this is fulfilled if for any pole at energy @xmath47 originating from the bath green s function there is a pole originating from the impurity green s function at the same energy ( @xmath48 ) with a larger weight ( @xmath49 ) . for calculations with infinity precision math and @xmath50 ,",
    "this is the case and the self - energy will be physical . in real calculations with @xmath3 of the order of several hundred and with computers with 16 digits accuracy , this will not be the case . the self - energy can be made physical by merging poles with a negative weight with poles in the neighborhood . if one orders the poles representing the self - energy in equation ( [ eq : sigma ] ) such that @xmath51 , then a pole with index @xmath28 and @xmath52 is merged with the poles @xmath53 and @xmath54 .",
    "the weight ( @xmath55 ) and energy ( @xmath20 ) of the new poles is chosen such to conserve locally the zeroth and first moment and only introduce small errors in the higher moments .",
    "the removal of the pole with the smallest weight is done first and this is repeated until all poles have a positive weight .",
    "this procedure reduces the number of poles in the self - energy ( @xmath56 ) to a maximum of the number of poles in the impurity green s function ( @xmath36 ) .",
    "the number can be smaller if after merging a pole with negative weight with a neighbor pole the result is still negative .",
    "details of this procedure are presented in appendix [ app : polered ] .",
    "the new bath green s function can be calculated by the noninteracting green s function @xmath57 and the impurity self - energy @xmath58 .",
    "we take @xmath59 with @xmath60 and @xmath23 numerical values defining the noninteracting green s function which is represented by @xmath61 discrete poles as the resolvent of an anderson impurity matrix .",
    "the relation between the representation given here and the density of states as one would obtain in a dft calculation is given in appendix [ app : gtrans ] .",
    "the new bath green s function can be obtained from the self - energy and the noninteracting green s function : @xmath62 the sum over @xmath28 and @xmath63 can be simplified and combined into a single sum by the diagonalization of the anderson impurity matrix ( @xmath64 times , for @xmath65 to @xmath66 ) : @xmath67 the resulting bath green s function is : @xmath68 with @xmath69 and @xmath70 and @xmath47 numerical values obtained from equation ( [ eq : diagonalization ] ) .",
    "the number of poles in the new bath green s function ( @xmath3 ) is equal to @xmath71 , which can become so large that it is problematic in further calculations .",
    "the reduction of the number of poles in @xmath72 is discussed in appendix [ app : polered ] .    the calculation of the new bath green s function , by adding the self - energy to the noninteracting green s function as presented in equation ( [ eq : bathnew ] ) , feels slightly different from the algorithm presented in most papers .",
    "@xcite the current algorithm does not require the explicit calculation of a local green s function .",
    "the simplification of equation ( [ eq : bathnew ] ) furthermore only requires matrix diagonalization , a standard and numerical stable algorithm . during the entire self - consistency loop",
    "the green s functions are defined as a discrete sum of poles with zero broadening .",
    "the resulting bath green s function is given by a set of poles whose energy and weight can be different from the starting bath green s function .",
    "nevertheless , @xmath73 has the same form as @xmath39 from which the first step of the dmft self - consistency loop started .",
    "after the calculation of @xmath72 one can restart the loop until convergence is reached .",
    "the dynamical mean field self - consistency loop requires one to solve an anderson impurity model .",
    "the anderson impurity hamiltonian can be represented as a matrix .",
    "the ground state ( @xmath74 ) is given as the eigenfunction of this matrix with the lowest eigenenergy .",
    "once the ground state has been calculated , the green s function is defined as @xmath75 with @xmath76 and @xmath77 here @xmath78 ( @xmath79 ) creates ( annihilates ) an electron at the impurity site .",
    "the definition of the green s function requires one to calculate ( twice ) the resolvent of the hamiltonian , which , in general , is a computationally involved task . for the special case where the hamiltonian is tridiagonal , with @xmath80 ( @xmath81 ) the first element of the matrix , calculating",
    "its resolvent is trivial and can be written as a continued fraction : @xmath82}\\\\ = \\frac{1}{\\omega - a_1-\\frac{b_1 ^ 2}{\\omega - a_2-\\frac{b_2 ^ 2}{\\omega-\\hdots}}}.\\end{aligned}\\ ] ] creating the hamiltonian in tridiagonal form is done using a lanczos algorithm which creates the krylov basis as : @xmath83 after orthonormalization , the hamiltonian is tridiagonal on this basis and the green s function can be obtained using equation ( [ eq : contfracmain ] ) .",
    "although the lanczos algorithm works great on large sparse matrices , the problem encountered for an impurity coupled to a partially filled band has not been generally solved .",
    "the reason is the exponentially fast growing number of basis states needed .",
    "if one works on a basis of single slater determinants , then the number of slater determinants needed for a half - filled band approximated by 300 poles is @xmath84 .",
    "storing a single vector of this format is far beyond reach of any computational method .",
    "luckily , one can reduce the number to far below @xmath85 , which can be handled with current computers .",
    "this can be done because not all of the @xmath86 determinants are equally important .",
    "the state where in a solid all electrons sit in one corner of the crystal and the rest of the crystal has no electrons is so high in energy and so unlikely , that one can safely neglect it in the calculation .",
    "the method used here searches for the @xmath85 most important determinants in the total space available and uses these to represent the ground state .",
    "the amount of optimization possible depends highly on the hamiltonian as well as on the one - particle orbitals used to create the slater determinants .",
    "optimization works generally better when the hamiltonian spreads over a larger energy scale , with more or less empty and occupied orbitals .",
    "although this is not something one can choose , nature often provides one with a separation of energy scales .",
    "most solids have a separation in bands according to their atomic orbital character .",
    "the different character of bands can be used and for real calculations optimizing the one particle orbitals can mean the difference between a trivial and an impossible calculation .",
    "the importance of the optimization of the one - electron orbitals used in the calculation becomes clear if one looks at a noninteracting system .",
    "for the case of noninteracting electrons , one can easily write down the ground state as a single slater determinant , which is a product of all bloch waves with energies smaller than the fermi energy . if one would not choose the bloch waves as the one particle basis , but some local orbital basis , then each orbital can be partially occupied and an exponential growing number of slater determinants is needed as a function of system size .    for correlated systems ,",
    "the one - electron basis that leads to a ground state that can be represented by a minimal number of slater determinants , is a basis based on natural orbitals .",
    "this is a one particle basis set defined such that the density matrix for the ground state of the many - body hamiltonian is diagonal .",
    "the disadvantage of such a basis set is that one can only obtain it after the ground state calculation is finished .",
    "as all our calculations are done iteratively , this is not a real problem and an optimal basis set is determined together with the ground state .    for fully correlated systems we do not know better single slater determinant basis sets than the natural orbital basis set . for impurity models , where only a few orbitals have full correlations and the others",
    "are treated on a ( dynamical ) mean field level , the introduction of natural orbitals mixes correlated and mean - field approximated sites .",
    "this is not convenient as it complicates the hamiltonian and results in a fully correlated problem .",
    "we therefore only allow basis rotations within the correlated orbital set and within the mean - field approximated orbital set , but do not mix these two different orbital sets .    in order to realize an optimized basis without mixing correlated and uncorrelated fermions",
    ", we need to define a way to rotate the one particle basis of the bath and impurity such that a minimum number of slater determinants is needed in the full many - body calculation without mixing the bath orbitals with the impurity orbitals . in figure",
    "[ fig : structure ] we show three different possible representations of the impurity problem , which are related to each other by a unitary transformation of the bath orbitals .",
    "the representation as shown in figure [ fig : structure ] ( a ) has the advantage that bath orbitals with a high onsite energy are basically empty and bath orbitals with a low energy are basically fully occupied .",
    "the disadvantage is that each bath orbital directly interacts with the impurity site and therefore is important .",
    "one can make a unitary transformation of the bath sites and change the bath geometry such that the impurity site only interacts with one bath orbital , which again interacts with one other bath orbital etc .",
    "as shown in figure [ fig : structure ] ( b ) . in this geometry",
    "the bath orbitals further away from the impurity are less important than those close to the impurity .",
    "each bath orbital is partially occupied and the ground state is given by an exponential growing number of slater determinants when the number of bath sites is increased . the solution is to couple the impurity to two separate chains , one representing the occupied states of the bath and one representing the unoccupied states of the bath . in order to be able to choose any filling of the impurity and still only have fully occupied or fully empty states",
    ", one needs an additional bath site , which for an impurity with a filling of @xmath87 has a filling of @xmath88 .",
    "the resulting total number of electrons is always integer .",
    "this bath geometry is shown in figure [ fig : structure ] ( c ) .    within our calculations",
    "we obtain a similar geometry as shown in figure [ fig : structure ] ( c ) automatically .",
    "we require the density matrix of the impurity as well as the density matrix of the bath to be diagonal . in order to reach this situation ,",
    "we need a starting point , which allows one to calculate the ground state and density matrix of a basis including hundreds of orbitals .",
    "we therefore define a noninteracting reference system which gives a good starting point .",
    "using this reference basis leads exactly to the bath geometry as shown in figure [ fig : structure ] ( c ) . in appendix",
    "[ app : natorb ] we discuss the transition between the different representations in more detail .",
    "in order to test the algorithm as described in the previous two sections , we calculate the hubbard model on a bethe lattice for different values of the coulomb interaction @xmath8 .",
    "the obtained impurity green s function can be seen in figure [ fig : results ] .",
    "the impurity green s functions are represented by a sum of @xmath36 delta functions at some energy and with some weight , such that their sum in the limit where @xmath36 goes to infinite represents the continuous green s function .",
    "the plotted spectra are created by replacing the sum over delta functions by a sum over lorenzians .",
    "the spectra in the top row are a sum of lorenzians with a full width at half maximum of @xmath89 , the spectra in the bottom row are created from a sum of lorenzians with a full width at half maximum of @xmath90 . from left to right we show calculations including 3 , 11 , 31 , 101 and 301 bath sites .",
    "each panel shows calculations for @xmath91 to 2 in steps of 0.25 in units of the band width .",
    "for @xmath8 equal to zero , the impurity green s function has exactly the same number of poles as the bath green s function . for large @xmath8 , the number of poles in either the upper or the lower hubbard band is , again , roughly equal to the number of poles in the bath green s function , although the total number of poles in the impurity green s function , in principle , is allowed to be much larger .",
    "numerically , it turns out that in the large @xmath8 limit , from the 1000 poles we include in the impurity green s function , only a fraction , roughly equal to the number of poles in the bath green s function , carries appreciable weight .",
    "the calculations show a systematic convergence with increasing numbers of poles in the bath green s function . for large and small values of @xmath8",
    "the increase in number of poles enhances the spectral resolution . in order to get continuous spectra",
    ", one needs to broaden by a lorentzian with full width at half maximum equal to three times the band width divided by the number of poles in the bath green s function .",
    "the inclusion of 300 poles in the bath green s function thus allows one to get a spectral resolution of 1% of the band width .",
    "close to the metal - insulator transition there are substantial differences when the number of poles in the bath green s function is enhanced . with only 3 poles in the bath green s function , we find the metal - insulator transition to take place between @xmath92 and @xmath93 . with 11 poles the transition takes place between @xmath94 and @xmath95 .",
    "for 31 and 101 bath sites the transition takes place between @xmath95 and @xmath96 . for 301 bath sites",
    "we even find a metallic solution for @xmath97.@xcite in principle , there is a large range of values of @xmath8 where one can find both a metallic and an insulating solution .",
    "the calculations here always started from a metallic bath green s function .",
    "when both solutions are possible we show the metallic solution .",
    "the fact that the metal - insulator transition is reduced in @xmath8 when fewer poles are included in the bath green s function becomes clear if one looks at the approximations made . due to the discretization of the bath green s function ,",
    "the system considered , in principle , always becomes an insulator , with a gap equal to the band width divided by the number of poles considered .",
    "the smaller the number of poles considered , the larger is the gap in the bath green s function .",
    "coulomb repulsion enhances this gap .",
    "the enhancement of the gap due to correlations is more effective if one already starts with a reasonably large gap for the uncorrelated system .      , 0.5 , 1.0 and 1.25 .",
    "top panels show a lorentzian broadening of full width at half maximum of 0.01 , bottom panels show a lorentzian broadening of full width at half maximum of 0.2 on both the ed and nrg results ( left ) or only the ed results ( right).,scaledwidth=45.0% ]        [ cols=\"^,^,^,^ , > , < , > , < , > , < , > , < , > , < , > , < \" , ]     the calculations of the dynamical mean - field solution of the hubbard model on the bethe lattice can be compared to a huge amount of literature data .",
    "we here include three examples explicitly .",
    "for the metallic cases we compare the ed to the nrg results as obtained by bulla _",
    "_ et al.__@xcite .",
    "nrg in this case is a highly efficient method and the comparison thus provides a stringent test on the current method .",
    "we furthermore compare our ed to qmc calculations .",
    "we used both the hf algorithm as well as the ct algorithm as implemented in the _ triqs _ package.@xcite in order to avoid the analytical continuation of the qmc spectra from the imaginary to the real axis , we transformed our results to the imaginary time axis . in the third subsection",
    "we compare to analytically known sum rules for the green s function and self - energy of a hubbard model on a bethe lattices solved within the dmft approximation .      in figure",
    "[ fig : nrgbulla ] we show a comparison between our results obtained with ed and the results obtained by bulla _ _ et al.__@xcite using nrg .",
    "we find the position and weight of the upper hubbard band , the lower hubbard band , and the quasiparticle peak to be extremely similar . however , there are evidently two differences .",
    "first , the ed results show extra wiggles , almost like noise , compared to the nrg calculations .",
    "such extra features have been reported before , but no full interpretation nor understanding exists . @xcite it has been shown that for an antiferromagnetic solution the upper and lower hubbard bands show magnon sidebands.@xcite for the paramagnetic solution it is not obvious that these features ( paramagnon sidebands ) should exist as well . in our calculations these wiggles are most probably related to numerical instabilities in the lanczos algorithm .",
    "the use of iterative schemes including lanczos , as well as the use of tridiagonal matrices to represent the green s function , can lead to numerical instabilities when using finite precision math .",
    "this is not just a problem of ed , but is a numerical challenge for any method using a krylov basis set on which the hamiltonian is tridiagonal .",
    "all of these methods should take care to prevent number loss within the algorithm when creating the krylov basis .",
    "second , the ed results are sharper at the high - energy side of the upper and lower hubbard bands .",
    "these spectra still have a tail that decays for @xmath98 , but with much smaller spectral weight .",
    "the nrg results are obtained on a logarithmic mesh ; therefore , the accuracy close to the fermi energy is higher than the accuracy of the hubbard bands . in practice",
    ", this can be overcome by an additional broadening at higher frequencies .",
    "if one compares the nrg results to our results broadened by a lorentzian of full width at half maximum of 0.2 the agreement at the hubbard bands is perfect , as can be seen in the bottom panels of figure [ fig : nrgbulla ] .",
    "the overall agreement between our ed results and the nrg results is considerably good .      in order to further compare our numerical results",
    ", we performed qmc calculations .",
    "they are performed at an inverse temperature of @xmath99 in units of the band - width of @xmath100 .",
    "the spin - up and spin - down green s functions are averaged in order to force a paramagnetic solution .",
    "the hf@xcite calculations use 1600 steps in @xmath21 for @xmath101 and 1200 steps for @xmath102 . in the case of ct qmc calculations , 10000 @xmath22  points ( 1025 matsubara frequencies )",
    "were used to sample @xmath103 [ @xmath104 , respectively .",
    "for both the hf and ct qmc , it was ensured that the green s function obey the correct asymptotic behavior ( noise reduction of the numerical data ) .",
    "the ed and nrg results are obtained at @xmath105 , i.e. at 0 kelvin , but the qmc ones are obtained at finite temperature . the former green s function is the ground state expectation value , whereas the latter represents the statistical average at finite temperature , which does lead to differences in the metallic regime close to the metal insulator transition . in order to transform the real - frequency results to the imaginary time axis",
    ", we included a fictitious temperature ( @xmath106 ) in the transformation .    in the left panel of figure  [ fig : gtau ]",
    "we show our ed results , the qmc results and the nrg results for @xmath91 to @xmath107 in steps of 0.25 .",
    "they seem to agree well .",
    "( note that one can not distinguish the four lines plotted in the left panel of figure  [ fig : gtau ] ) in imaginary time green s functions the spectral complexity is encoded in the fine details .",
    "hence , one should compare the differences between the three greens functions obtained by different methods in more detail . in the right four panels of figure",
    "[ fig : gtau ] we show the difference between @xmath103 calculated with ( 1 ) ed and ct - qmc , ( 2 ) ed and hf - qmc , ( 3 ) nrg and ct - qmc and ( 4 ) nrg and hf - qmc .",
    "one should first observe that up to the statistical accuracy with which the qmc calculations have been preformed the hf and the ct algorithm give the same results .",
    "for the metallic cases the differences between our ed calculations and qmc calculations become larger if one gets closer to the metal - to - insulator transition .",
    "the same behavior is true for the comparison between nrg and qmc .",
    "this is not related to numerical problems in either of the two methods , but to the fact that the qmc calculations are preformed at finite temperature ( @xmath99 ) , whereas the ed and the nrg results have been obtained at exactly 0 k. the critical @xmath108 decreases with temperature up to the critical point ; hence , at finite temperature the metal - to - insulator transition occurs for lower @xmath8 values than at @xmath6 k.@xcite in fact , with increasing @xmath8 one notices , that in qmc the spectral weight at the fermi level in the metallic regime gets smaller than in ed / nrg [ @xmath109 . for the insulating case",
    "we basically find , up to the statistical accuracy with which the qmc calculations are preformed , agreement between all different methods shown .",
    "comparing with qmc and nrg we find that the method works well .",
    "note that the small differences between qmc and nrg at @xmath110 are due to the coarse mesh of the nrg data at large @xmath45 , which introduce problems in the transformation from real frequency to imaginary time .",
    "several analytical sum rules exist that relate the first four moments of the impurity green s function , the first two moments , and an additional constant of the self - energy , as well as the first four moments of the bath green s function , to analytically known expressions.@xcite furthermore , koch _ _ et al.__@xcite showed that the total hybridization between the impurity and the bath is related to the first and second moments of the noninteracting green s function .",
    "their relations in our present notation become particularly transparent . given the noninteracting green s function @xmath57 as defined in equation ( [ eq : g0 ] ) and the bath green s function @xmath39 as defined in equation ( [ eq : gb ] ) the hybridization sum rule states that @xmath111 of the noninteracting green s function is equal to @xmath112 of the bath green s function .",
    "our implementation of the self - consistency loop as shown in section [ section : loop ] and particularly equation ( [ eq : bathnew ] ) guarantees that this sum rule is exactly fulfilled .",
    "the momentum sum rules need to be checked agains their numerical values .",
    "they are valid for continuous green s functions and self - energy , but it is _ a - priory _ not obvious how the discretization used in the method presented here influences the moments of the green s functions .",
    "the reduction of poles as described in appendix [ app : polered ] as well as numerical instabilities , could , in principle lead to a violation of these sum rules . below",
    "we show that the moment sum rules are fulfilled very well with the method presented in this paper .",
    "the moments of a green s function ( or self - energy ) are defined as @xmath113 \\omega^m d \\omega.\\ ] ] direct numerical evaluation of this integral is difficult due to problems with number loss .",
    "one can rewrite this integral to a series expansion in @xmath114 whose expansion coefficients are given by @xmath115.@xcite with the use of the kramers - kronig relations , @xmath116 one can rewrite the green s function as a series expansion in @xmath114 , @xmath117    the green s functions in our method are represented by a sum over poles as @xmath118 in order to calculate the moments of this green s function we create a laurent series of @xmath119 : @xmath120 the moments of the green s function can thus be expressed in term of @xmath17 and @xmath18 which are used as numerical values to store the green s function : @xmath121    the analytical expressions for the moments of the green s function of a one band hubbard model on a bethe lattice with @xmath122 , solved within the dmft approximation , are @xmath123 for the self - energy they are @xmath124 where we defined @xmath125 as the prefactor of @xmath126 in the series expansion in @xmath114 .    in table",
    "[ table : moments ] we compare our numerical results with the analytical values . the top half of the table shows the moments of the self - energy ; the bottom half shows the moments of the impurity green s function .",
    "the calculations are done for @xmath91 to @xmath127 in steps of @xmath128 the same steps as used for the spectra shown in figure [ fig : results ] .",
    "we show calculations for @xmath129 and @xmath130 .",
    "the even rows show the analytical and numerical moments , the odd rows show the difference between the numerical and analytical values .",
    "the first moment of the green s function is not included as this is exactly equal to 1 for all calculations .",
    "we find that already for three bath sites there is perfect ( down to the numerical precision possible in a computer @xmath131 ) agreement between our numerical and the analytical results .",
    "it might be surprising that the moments are represented so well , whereas the spectra ( see the left panels of figure [ fig : results ] ) are not converged in the number of bath sites : for @xmath129 we find roughly two peaks per hubbard band and a transition to the insulating state at much too low values of @xmath8 .",
    "this shows once again that the moments of a green s function can be used as a criteria to falsify a numerical method , but even if a numerical method has several moments of the green s function correct it does not imply that the method works .",
    "it might come as a surprise that the moments of the green s function are better reproduced with @xmath129 ( 15 digits correct ) than with @xmath130 ( 5 digits correct ) .",
    "this is most probably related to number loss in the calculations , which is a larger concern when more bath states are included and also probably the reason why increasing the basis to include 1001 bath orbitals did not improve the spectral function further . in any case , we can conclude that the analytically known values for the first four moments of the green s function and the two moments of the self - energy as well as the constant offset in the self - energy are well reproduced in our method .",
    "in this paper we present an efficient ed - based real - frequency solver for the general anderson impurity problem and dmft .",
    "it alleviates the exponential increasing hilbert space encountered by conventional ed algorithms as a function of the number of bath sites .",
    "a specific bath geometry is realized upon which basis set optimization can be applied .",
    "the restricted hilbert space allows calculations including a few hundred bath sites at moderate cost , which solve for spectral functions with energy resolution better than @xmath132 of the bandwidth .",
    "good agreement with other methods including nrg , hf - qmc , and ct - qmc is obtained for model systems over a wide parameter space .",
    "we would like to thank silke biermann , philipp hansmann , alessandro toschi , giorgio sangiovanni and karsten held for stimulating discussions .",
    "financial support from the deutsche forschungsgemeinschaft through grant no . for 1346",
    "is gratefully acknowledged .",
    "in the main paper as well as in the appendixes we use @xmath22 as an index for the different fermion quantum states ( spin , orbital , site ) within the impurity .",
    "@xmath2 is the total number of these degrees of freedom . in most equations",
    "the sum over @xmath22 is suppressed .",
    "for example , let @xmath20 be an @xmath2 by @xmath2 matrix with elements @xmath133 , then @xmath134 the same notation and suppression of internal degrees of freedom are used for the bath sites .",
    "the sum of a scalar and a matrix is used as a shorthand for the sum of a scalar times the identity matrix .",
    "the inverse of a matrix is given by a fraction and the resolvent of a matrix is assumed to be taken such that the poles are in quadrants iii and iv . in formula",
    "this is @xmath135 with @xmath136 an @xmath2-by-@xmath2 identity matrix and @xmath20 a general @xmath2-by-@xmath2 matrix .",
    "the square of a matrix , divided by another matrix should be read as the product of three matrices : @xmath137 with @xmath20 and @xmath21 @xmath2-by-@xmath2 matrices .",
    "we define _ sites _ as a set of one - electron states that arise from the quantization of the bath green s function .",
    "the term _ site _ is chosen because for a finite size tight binding lattice model this quantization can be taken to overlap with the real sites in the lattice model . as stated above , each site ( including the impurity ) can have additional degrees of freedom labeled by @xmath22 .",
    "the impurity site is labeled by @xmath26 , the bath sites are labeled by @xmath27 or by @xmath10 , @xmath138 and @xmath139 .",
    "one - electron states are defined by creating an electron at a given site : @xmath78 or @xmath140 for impurity or bath sites .",
    "we recombine bath sites to optimize our basis and bath geometry .",
    "the relation between the new ( @xmath141 ) and old ( @xmath27 ) sites is given by a unitary rotation matrix @xmath8 with element @xmath142 such that : @xmath143 .",
    "a given filling of these sites defines a single slater determinant function labeled by @xmath144 .",
    "for @xmath145 electrons , the set of slater determinants is given by all subsets @xmath146 of length @xmath145 of the possible fermions ( @xmath22 ) at either the impurity ( @xmath26 ) or the bath ( @xmath27 ) sites : @xmath147 the operator @xmath148 creates a single electron with quantum numbers ( @xmath22 , @xmath26 , @xmath27 ) indexed by @xmath149 .",
    "the slater determinant @xmath150 thus represents a state with @xmath145 electrons .",
    "given a set of slater determinants , one can define the ground state @xmath151 as a linear combination of these many electron determinants : @xmath152 with @xmath17 numerical factors defining the state and @xmath153 to normalize the state .",
    "we use , generally , @xmath151 to label a many - slater - determinant eigenstate on a given basis and @xmath154 to label a many - slater - determinant basis state , which is part of the krylov basis of the hamiltonian starting from a specific state .",
    "in this paper the green s function ( and self - energy ) is expressed as an analytical function involving the sum over @xmath17 and @xmath18 , with @xmath18 related to the spectral weight and @xmath17 related to the energy of the poles .",
    "we use different representations of the green s function in different parts of the code .",
    "the lanczos algorithm produces the green s function as a continued fraction , equation ( [ eq : contfrac ] ) .",
    "the dmft self - consistency loop is written using the green s function as a sum over poles , equation ( [ eq : sumoverpoles ] ) , and as the inverse of the sum over several poles , equation ( [ eq : stargeometry ] ) . in all cases the green s function can be represented as the resolvent of a matrix ( @xmath155 ) and transformations between the different representations of the green s function are unitary matrix transformations of this matrix .",
    "the basis of the matrix @xmath155 can be interpreted as sites and @xmath155 as the hamiltonian determining the onsite energy and hopping of a single electron between different sites .",
    "the green s functions are always represented as a set of delta functions .",
    "only when the green s function is plotted , after the full self - consistency is reached , we broaden the green s function .",
    "( replace the sum over delta functions by a sum over lorentzians . ) in figure [ fig : results ] we show two different lorentzian broadenings [ full with half maximum of 0.01 ( top ) and 0.1 ( bottom ) ] .",
    "the transformation to the imaginary axis as shown in figure [ fig : gtau ] is done without a broadening on the green s function .",
    "the transformation from the real to imaginary axis involves an integral of a kernel times the green s function , which can be performed straightforwardly when the green s function is given as a list of delta functions at energy @xmath17 and weight @xmath156 .    in this section",
    "we discuss the transformations between the different representations in more detail .",
    "if one starts from a density functional theory calculation , the noninteracting green s function is often only known by the spectral function or density of states represented by a list of energies and intensities ( @xmath157 ) .",
    "this defines the green s function as : @xmath158 combining the sum over momenta ( @xmath159 ) and quantized energies @xmath160 into a single sum and rewriting the numerical parameters as @xmath17 and @xmath18 we get : @xmath161 we would like to find a matrix whose resolvent is equal to this green s function , such that numerical operators on the green s function can be implemented as matrix operations . in order to do this we define the matrix @xmath162 and the vector @xmath163 using @xmath164 and @xmath165 , the green s function is defined as the inner product of @xmath165 and the resolvent of @xmath164 : @xmath166 transformations between different representations of the green s function as shown for example in figure [ fig : structure ] can now be written as matrix transformations on @xmath164 : @xmath167 in order to define the different unitary transformations @xmath8 that relate the green s function in the representation as shown in equation ( [ eq : sumoverpoles ] ) to the green s function in the tridiagonal or anderson representation as depicted in figure [ fig : structure ] we take two steps . in the first step we create @xmath168 , which is a dense matrix whose top left - most element of the resolvent represents the green s function . in the second step we apply a unitary matrix transformation on the elements @xmath169 to @xmath145 of @xmath168 to obtain the green s function represented by a tridiagonal ( @xmath170 ) or anderson ( @xmath15 ) hamiltonian . in the first step",
    "we define @xmath171 such that @xmath172 with @xmath173 and @xmath174},\\end{aligned}\\ ] ] whereby the exponent in the last equation represents a matrix inversion and the subscript @xmath175 $ ] represents the element at position 1 after the matrix inversion .",
    "@xmath168 is a dense matrix of dimension @xmath145 by @xmath145 with @xmath145 equal to the number of poles in the green s function as defined in equation ( [ eq : sumoverpoles ] ) .",
    "the elements of @xmath168 are given as @xmath176 with @xmath177 as defined in equation ( [ eq : chi0 ] ) and @xmath178 for @xmath179 obtained from a gram - schmidt orthonormalization of a set of unit vectors that span the basis of @xmath164 .",
    "the anderson representation of the green s function where the site under consideration interacts with @xmath180 noninteracting other sites is given by the hamiltonian @xmath181 and the corresponding green s function is given as : @xmath182    the unitary transformation relating the hamiltonian @xmath15 in equation ( [ eq : hand ] ) to @xmath168 as defined in equation ( [ eq : h1 ] ) is given by the eigenvectors of @xmath183 with the elements of @xmath183 defined as @xmath184    a different unitary transformation of @xmath168 can lead to the representation of the green s function where the site under consideration interacts with exactly one other site , which in turn interacts with one more site building a one dimensional chain of interactions .",
    "the hamiltonian in this case is given by @xmath185 and the green s function as @xmath186 @xmath170 is the tridiagonal form of @xmath168 whose elements are defined in equation ( [ eq : h1 ] ) .",
    "this tridiagonal matrix is obtained by a standard lanczos tridiagonalization routine .",
    "( see appendix [ app : lanc ] and references therein . )",
    "there are several good review articles around describing the lanczos algorithm.@xcite in general , we would not advise to implement the complete lanczos routines itself , but to use one of the libraries available.@xcite in this appendix we provide a short overview of the basic idea behind the lanczos routine , which will help the reader in understanding the implementation of the lanczos routines on a sparse , continuously optimized basis set .",
    "the lanczos routines can be used to find the ground state of a large sparse matrix .",
    "once the ground state is found the same routine can be used to calculate spectral functions , including the one particle green s function . here",
    "we provide some information on both procedures .",
    "the hamiltonian @xmath155 can be represented on a basis as a large , sparse matrix .",
    "we can shift the onsite energy of this matrix such that all eigenvalues are negative .",
    "next we define an arbitrary , random wave function @xmath187 .",
    "this wavefunction can be written as a linear combination of eigenstates , @xmath188 with @xmath189 eigenstates of h such that @xmath190 the states @xmath189 are taken to be ordered such that @xmath191 the state @xmath74 is the ground state one would like to determine .",
    "the state @xmath192 is defined by the recurrent relation @xmath193 besides normalization , @xmath192 is given by @xmath194 as @xmath195 and @xmath196 @xmath197 the overlap of @xmath192 with the ground state @xmath74 is larger than the overlap of @xmath187 : @xmath198 repeatedly applying equation ( [ eq : lancstep ] ) will lead to convergence of @xmath189 to the ground state : @xmath199 .",
    "although the above - described algorithm works and is extreme robust , convergence can be exponentially slow . in order to improve convergence ,",
    "we define a krylov space with a fraction of the size of the total hamiltonian and diagonalize the matrix on this new basis . starting from a random vector @xmath187",
    ", we define the krylov basis by the recurrent relations : @xmath200 the first step defines the basis according to the idea that @xmath201 is closer to the ground state than @xmath202 .",
    "the second step assures that @xmath202 is orthogonal to @xmath203 for all @xmath204 .",
    "the last step in equation ( [ eq : lanckryl ] ) assures normalization of @xmath202 .      in order to calculate spectral or green s functions",
    ", one needs to obtain the resolvent of the hamiltonian projected to a particular state . in general , @xmath206 with @xmath207 ( @xmath208 , @xmath209 , ... ) for the green s function related to photoemission ( inverse photoemission , spin susceptibility , ... ) .",
    "we define @xmath210 and the krylov basis by @xmath203 as defined by the recurrence relations as given in equation ( [ eq : lanckryl ] ) . on this basis ,",
    "the hamiltonian ( @xmath211 ) is tridiagonal and can be parametrized by @xmath17 and @xmath18 : @xmath212 the resolvent of a tridiagonal matrix is given as a continued fraction , @xmath213}\\\\ = \\frac{1}{\\omega-\\alpha_1-\\frac{\\beta_1 ^ 2}{\\omega-\\alpha_2-\\frac{\\beta_2 ^ 2}{\\omega-\\hdots}}},\\end{aligned}\\ ] ] which allows for a straight forward calculation of the green s function corresponding to the transition operator @xmath214 .    for the calculation of spectral functions ( as with the calculation of the ground state )",
    "one should be aware that the construct of the krylov basis includes a fundamental numerical unstable algorithm .",
    "additional orthonormalization steps can be mandatory in order to obtain correct results .",
    "the number of slater determinants available in the many particle basis is so large ( @xmath215 ) that most of them have to be neglected .",
    "this is allowed as long as the total weight of the neglected states is small . in this section",
    "a method is discussed to find the @xmath7 determinants with the largest weight in a relatively short time period .",
    "the general physically relevant hamiltonian is given in second quantization as : @xmath216 with @xmath149 an index for spin , orbital and site index ( bath as well as impurity site ) of the fermions included in the one - particle orbital basis .",
    "note that the hamiltonian in equation ( [ eq : hlanc ] ) is extremely general .",
    "the method described here to find the lowest @xmath7 determinants from a much larger basis set can be used for finite size lattice models with correlations ( heisenberg spin - exchange model , @xmath217 model , hubbard model ) @xcite , ligand field theory calculations @xcite , or other forms of quantum chemistry models where one needs to diagonalize large sparse matrices .    the idea behind the method is to first define a relatively small basis , consisting of only a few slater determinants , based on the hartree - fock or dft energies of the orbitals . in this basis",
    "the ground state wave - function is found as a linear combination of the slater determinants present in the basis .",
    "one then can rotate the one particle orbitals to minimize the number of slater determinants needed as described in appendix [ app : natorb ] .",
    "if there are slater determinants in the basis that do not contribute noticeably to the ground state wave function , these states are removed from the basis .",
    "next the basis is enlarged by acting with the hamiltonian on the ground state wave function in the small basis allowing all states that couple to this state but were not in the basis set to enter .",
    "one continues by finding the ground state wave - function in this new basis .",
    "these steps are repeated until convergence is reached , which can take up to a hundred loops .",
    "nonetheless , finding the ground state even for rather involved basis sets is relatively fast ( sub second on a laptop ) as one starts with very small basis sets and each time the basis set is increased one can use the converged ground state calculation of the previous basis set as a starting point . in order to understand the basics of the algorithm , one can look at a graphical representation of the one - electron states or sites , single slater determinant many electron basis states and multi slater determinant eigenstates .    in figure",
    "[ fig : basis ] the evolution of the basis states is shown .",
    "the one - electron states are represented by circles for the bath sites and a square for the impurity site .",
    "solid circles are occupied , open circles are empty .",
    "the bath sites are labeled by @xmath12 for the valence bath , @xmath11 for the conduction bath and @xmath10 for one site at an energy such that its occupation is @xmath88 with @xmath87 the impurity occupation . in the top panel",
    "we show two basis functions , labeled @xmath218 and @xmath219 .",
    "the valence bath sites are fully occupied ( solid circles ) and the conduction bath sites are completely empty ( open circles ) .",
    "there is furthermore one - electron either at the impurity site @xmath26 , or at the bath site labeled by @xmath10 .",
    "this defines the two basis functions : @xmath218 and @xmath219 .",
    "the ground state in this basis will be some linear combination of these two slater determinants : @xmath220 .    acting with the hamiltonian on @xmath221 allows the electron from the valence bath site labeled @xmath222 to hop to either site @xmath10 or the impurity site , or allows the electron at the impurity site to hop to the conduction bath site @xmath223 .",
    "@xmath224 defines a new function @xmath225 . in order to represent this new function",
    "one needs two more basis states as indicated in the middle panel of figure  [ fig : basis ] : @xmath226 the basis states @xmath218 to @xmath227 span the new , larger basis .",
    "the function @xmath228 , in general , will not be an eigenstate in the new , larger basis . in this new basis , one can find , with the use of a lanczos algorithm the new ground state without too much effort .",
    "the ground state in this basis will be , in general , some linear combination of four basis functions : @xmath229 .",
    "once the ground state in this new basis has been found , one can act with the full hamiltonian on this state , which again will enlarge the basis needed to represent this new state .",
    "the third basis is shown in the bottom panel of figure  [ fig : basis ] .",
    "the third ground state is given as some linear combination of these eight states .    within this loop",
    "the size of the basis set grows exponentially and only a few steps can normally be done before the basis set size is so large that one can not store the eigenstates any - more .",
    "the solution is to remove those basis states that do not noticeably contribute to the ground state .    given a basis set defined by the states @xmath230 and the ground state as @xmath231 , all states @xmath230 are removed from the basis for which @xmath232 with @xmath233 .",
    "this new basis is then enlarged by acting with the hamiltonian on the ground state ( @xmath74 ) and adding those slater determinants to the basis needed to represent @xmath234 . in this new basis",
    "the ground state is found , the determinants not needed to represent the ground state are removed and the basis is extended again by acting with the hamiltonian on the ground state and adding those determinants needed to represent @xmath234 .",
    "this is repeated until convergence is reached , which can take up to 100 repetitions ( generally less ) . for a converged calculation @xmath235 , which is fulfilled for all calculations in this paper up to the numerical accuracy ( @xmath236 )",
    ", one can obtain with floating point ( double ) precision .",
    "one should note that even for a converged calculation acting with the hamiltonian on the ground state in a given basis will add states to the basis that were not included before .",
    "it is just that after diagonalization the new ground state has negligible weight in these determinants such that they are removed from the basis by the truncation procedure ( and added again if one would go for another loop ) .",
    "it can also happen that states removed in an early loop of the calculation will reenter and become important in a later stage of the calculation .",
    "the number of slater determinants in the basis grows exponentially as a function of the number of steps in this algorithm .",
    "it is therefore of uttermost importance to remove those determinants that have a negligible contribution to the ground state . in order to find a ground state wave - function that has most of its weight in only a few determinants",
    ", one needs to optimize the one - particle orbitals . for a hamiltonian where all states are correlated",
    ", this is the basis of natural orbitals .",
    "that is , in this case one rotates the one - particle orbitals after each calculation of the ground state such that the density matrix of the ground state is diagonal . for calculations on an impurity model",
    "this is not most efficient , as it mixes correlated impurity sites with noninteracting bath sites .",
    "the natural orbitals for an impurity model are discussed in appendix  [ app : natorb ] .    for a single band calculation",
    "the algorithm is rather straight - forward and robust . in a multiorbital case one needs to be slightly careful concerning the symmetry of the wave - function related to the starting point .",
    "for example , in the case of co@xmath237 as found in lacoo@xmath238 one finds a local low spin state @xmath239 ( @xmath240 ) and local high spin state @xmath241 ( @xmath242 ) close in energy.@xcite if one starts the algorithm from a low ( high ) spin initial state , one will ( within the ligand field approximation ) converge to the low ( high ) spin eigenstates .",
    "the dmft equations as implemented in this work require one to calculate the ground state and green s function of an anderson impurity problem .",
    "although only the impurity has correlations , an anderson impurity model is still highly nontrivial and shows strong entanglement between the impurity and bath orbitals in the ground state . the ground state is generally not single - slater - determinant representable . in order to minimize the number of slater determinants needed to give a good representation of the ground state , we optimize the one - particle basis set . in this section",
    "we show how to do this .",
    "we label the impurity site by @xmath26 and the bath sites by @xmath27 , with @xmath243 $ ] .",
    "the impurity might have several internal degrees of freedom , as spin , orbital or site which will be labeled by a further quantum number @xmath22 .",
    "the resulting hamiltonian is : @xmath244 the aim is to find a unitary transformation of the one - particle states labeled by @xmath22 , @xmath26 , and @xmath27 such that the ground state can be represented by a minimum amount of slater determinants .",
    "this transformation , however , should not mix impurity ( @xmath26 ) states with bath states ( @xmath27 ) .",
    "if we label the transformed states by @xmath245 , @xmath246 , and @xmath141 , we can define the unitary transformation @xmath247 such that @xmath248 the transformation on the impurity @xmath249 is taken such that the density matrix of the ground state ( @xmath74 ) of @xmath15 is diagonal : @xmath250 this is a trivial , noncostly step in the current method .",
    "the many - body ground state wave - function ( @xmath74 ) is , as described in appendix  [ app : lancsparse ] , first calculated on a small basis , which is then gradually extended . after each calculation of the ground state for a given basis",
    "we calculate the density matrix of the impurity : @xmath251 we can diagonalize this density matrix @xmath252 and the eigenvectors of this matrix define the unitary transformation @xmath249 .",
    "this transformation is applied to both @xmath74 and @xmath15 .",
    "the loop to calculate the ground state is continued by extending the basis set as described in appendix [ app : lancsparse ] .",
    "the transformation of the bath states @xmath253 is less trivial . in principle",
    ", one would like to take the bath discretization to be defined such that the bath density matrix is diagonal in the basis chosen : @xmath254 if for an arbitrary bath discretization one could calculate @xmath74 , one can easily calculate the bath density matrix @xmath255 and the eigenvectors of this matrix define the optimal unitary transformation .",
    "the problem that arises though is that for an arbitrary bath discretization all bath states are important and one can not truncate the many - body wavefunction such that only a few ( maximally @xmath7 ) slater determinants are needed to represent the wavefunction .",
    "once a solution is found , we can define a basis that would have been more efficient , but we need to define the efficient basis before the calculation can be done .",
    "the iterative method , which works well for the impurity sites , is impractical for the bath sites as the number of orbitals involved is too large .",
    "we need to define a unitary transformation @xmath253 that approximately leads to a diagonal density matrix , but can be calculated before the many - body problem is solved .",
    "this is done by introducing a noninteracting reference system : @xmath256 @xmath257 is chosen such that the correct impurity occupation is reproduced .",
    "the correct impurity occupation is known from a previous step in the calculation , which is either a previous dmft loop or a previous calculation with a smaller many - body basis set .",
    "the solution of the reference system , which only has one body interactions , is trivial .",
    "diagonalization of @xmath258 leads to a set of one particle states that are a mixture of bath ( @xmath259 ) and impurity ( @xmath260 ) states .",
    "the many - body ground state ( @xmath74 ) is a single slater determinant in which all one particle eigenstates of @xmath258 with an energy smaller than the chemical potential are occupied . from this state",
    "we can calculate the bath density matrix : @xmath261 we can diagonalize this density matrix @xmath262 and the eigenvectors of this matrix define the unitary transformation @xmath253 .",
    "this transformation is applied to the bath and thereby minimizes the number of slater determinants needed in the calculation .",
    "the optimized bath which leads to a diagonal density matrix ( @xmath263 ) for the ground state of the reference system ( @xmath258 ) always has the same form .",
    "the resulting bath geometry is depicted in figure [ fig : structure ] ( c ) .",
    "it is interesting to study this bath geometry in a bit more detail . for the reference system",
    "the impurity will have an occupation @xmath87 , the bath site labeled by @xmath10 has an occupation @xmath88 .",
    "the bath sites labeled by @xmath138 are all fully occupied and the bath sites labeled by @xmath139 are all completely empty .",
    "the many - body ground state for the reference system is given by only four slater determinants with only partially filled states @xmath26 and @xmath10 , which define a molecular bond between these two states .",
    "for a single band impurity with @xmath22 labeling spin up ( @xmath264 ) and spin down ( @xmath265 ) states , this function can be written as : @xmath266 with @xmath20 and @xmath21 positive parameters such that @xmath267 and the indices as shown in figure [ fig : structure](c ) .",
    "the bath sites labeled by @xmath138 are fully occupied in the ground state and the bath sites labeled by @xmath139 are completely empty .",
    "nonetheless , there is an interaction between the impurity site and these bath sites .",
    "if the interaction between sites @xmath26 and @xmath223 ( @xmath222 ) is @xmath268 ( @xmath269 ) and the interaction between sites @xmath10 and @xmath223 ( @xmath222 ) is given by @xmath270 ( @xmath271 ) , respectively , then the relation between these interactions is @xmath272 the interaction between the occupied states at site @xmath26 with the unoccupied conduction bath sites @xmath223 interferes with the hopping from the occupied state at @xmath10 such that the total interaction cancels .",
    "the basis obtained in the reference system is used as the basis for the correlated anderson impurity problem . here",
    "the molecular orbital formed between the states @xmath26 and @xmath10 becomes partly unoccupied as one moves towards the heitler - london solution for correlated molecular bonds .",
    "the choice of this basis allows one to select a few slater determinants that are important . for the calculations presented in this paper we never needed more than a few thousand determinants to represent the ground state",
    "the number of poles in the bath green s function defines the number of bath sites in the anderson impurity hamiltonian .",
    "the current algorithm is able to include several hundreds of such states .",
    "the new bath green s function has a dimension of @xmath273 , equation ( [ eq : bathnew ] ) and @xmath274 , equation ( [ eq : sigma ] ) .",
    "the number of poles in the bath green s function thus grows rapidly with each self - consistency loop and needs to be reduced .",
    "following the ideas of renormalization group theory , one could choose a fixed set of energies on a logarithmic mesh that is used to represent the bath green s function .",
    "although not a bad choice , especially as it allows one to represent the fermi energy with a large number of poles , we here opt for an adaptive mesh .",
    "we want the green s function to be represented by a large number of poles in those areas where the green s function is large and by a smaller number of poles where the green s function is small . in practice",
    ", we repeatedly remove the pole with the smallest spectral weight and merge this pole with the neighboring poles until the number of poles is reduced to the number of bath orbitals one wants to include in the calculation .",
    "the same procedure is used to remove poles with a negative weight from the self - energy .",
    "starting from a green s function or self - energy represented as @xmath275 with @xmath276 .",
    "we repeatedly determine the pole with the smallest weight ( minimal @xmath277 ) and remove this pole from the green s function , whereby we locally keep the zeroth and first moments conserved .",
    "assuming that the pole with smallest weight is found at position @xmath159 , then after one iteration this leads to the green s function , @xmath278 with @xmath279 ( @xmath280 ) for all @xmath281 , @xmath282 ( @xmath283 ) for all @xmath284 , and : @xmath285    the equations look more involved than they are .",
    "the weight of the pole at positions @xmath159 is split between the weight at position @xmath286 and @xmath287 weighted by the distance to the neighboring pole .",
    "the energy ( @xmath288 ) of pole @xmath286 is shifted such that the first moment of poles @xmath286 and @xmath159 ( multiplied by the partial weight ) is conserved ( the same is true for @xmath289 . ) : @xmath290 this procedure conserves locally the zeroth and first moment , @xmath291 and nonlocally only introduces small errors in the moments of the full green s function .",
    "it should be noted that the shift in spectral weight introduced by this procedure is generally small . for a spectrum with bandwidth @xmath292 represented by @xmath145 poles",
    "the maximum shift of a single pole ( spectral weight times distance ) is of order @xmath293 and thus converges well as a function of @xmath145 .",
    "it is expected that many different algorithms to reduce the number of poles will yield similar results and the procedure presented here might not be the optimum .",
    "any algorithm used should reduce the poles at large energy ( @xmath294 ) with very small weight ( @xmath295 ) as these are most probably spurious eigenstates introduced by the lanczos algorithm and destabilize the self - consistency loops ."
  ],
  "abstract_text": [
    "<S> we here present how a self - consistent solution of the dynamical mean field theory equations can be obtained using exact diagonalization of an anderson impurity model with accuracies comparable to those found using renormalization group or quantum monte carlo methods . </S>",
    "<S> we show how one can solve a correlated quantum impurity coupled to several hundred uncorrelated bath sites , using a restricted active basis set . </S>",
    "<S> the number of bath sites determines the resolution of the obtained spectral function , which consists of peaks with an approximate spacing proportional to the band width divided by the number of bath sites . </S>",
    "<S> the self - consistency cycle is performed on the real frequency axis and expressed as numerical stable matrix operations . </S>",
    "<S> the same impurity solver has been used on ligand field and finite size cluster calculations and is capable of treating involved hamiltonians including the full rotational invariant coulomb interaction , spin - orbit coupling , and low - symmetry crystal fields . </S>",
    "<S> the proposed method allows for the calculation of a variety of correlation functions at little extra cost . </S>"
  ]
}