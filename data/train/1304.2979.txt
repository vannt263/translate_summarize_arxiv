{
  "article_text": [
    "magnetic field extrapolation is an important tool to study the three - dimensional ( 3d ) solar coronal magnetic field , which is still difficult to measure directly @xcite .",
    "the models being used most popularly for field extrapolation are the potential field model , the linear force - free field model , and the nonlinear force - free field ( nlfff ) model .",
    "these models are all based on the same assumption that the lorentz force is self - balancing in the corona , but adopt different simplifications of the current distribution . among these models ,",
    "the nlfff is the most used one for characterizing magnetic field in the low corona , where there is significant and localized electric current , especially in the active regions ( ars ) .",
    "but , to directly solve the general nlfff equation @xmath0 is really difficult .",
    "as is known , the system is nonlinear intrinsically and even the existence and uniqueness of a solution for a given boundary condition are not proved theoretically ; solutions have rarely been found in closed analytic form ( e.g. , * ? ? ?",
    "* ) and in most cases people can only resort to numerical method using computer ( many numerical codes have been developed in the past decades , e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* one may refer to a recent living review by @xcite ) .",
    "moreover the observation can only provide a bottom boundary of data , and even worse , on the photosphere the field is forced significantly by the dense plasma and thus conflicts with the fundamental force - free assumption .",
    "besides the noise in the observation , measurement error and instrumental uncertainty ( e.g. , the well known @xmath1 ambiguity of the transverse fields ) are all rather unfavorable for practical computation .",
    "thus the observed magnetogram usually needs to be preprocessed to remove the force and noise for providing a better input @xcite .",
    "anyhow , at present one can hardly seek an exact force - free solution with the observation information fully satisfied .",
    "the best we can do is to find a good balance between the force - free constraint and deviation from the real observation , i.e. , to seek an approximately force - free solution that matches the photospheric field measurements as well as possible .",
    "recently we have developed a new extrapolation code called cese ",
    "nlfff @xcite , which is based on magnetohydrodynamics ( mhd ) relaxation method and an advanced numerical scheme , the spacetime conservation - element / solution - element ( cese ) method , for faster convergence and better accuracy over the available codes .",
    "the good performance and high accuracy of the code have been demonstrated through critical comparisons with previous joint studies by @xcite and @xcite , in which various nlfff codes are assessed based on several nlfff benchmark tests .",
    "we have also successfully extended the code to application in spherical geometry and seamless full - sphere extrapolation for the global corona @xcite . in this paper",
    "we report the application of the cese  mhd  nlfff code to real solar data , i.e. , the presently released _",
    "sdo_/hmi magnetograms . to deal with the real observation data",
    ", we also have developed a new preprocessing method to remove the force in the raw magnetogram @xcite .",
    "extra advancements are made to the original code to further enhance the ability of handling the high - resolution but noisy data .",
    "magnetograms of two ars , ar  11158 and ar  11283 are sampled for our tests of extrapolation .",
    "the results are carefully assessed both qualitatively and quantitatively .",
    "we show that our code can recover magnetic field lines resembling the plasma loops seen in the _",
    "sdo_/aia images , and reproduce most important structures of the ars remarkably well like the highly - sheared field lines that suspend filaments in ar  11158 and twisted flux rope that corresponds to a sigmoid in ar  11283 .    the remainder of the paper is organized as follows .",
    "we first describe briefly the cese  mhd  nlfff code along with its improvements in section  [ sec : code ] .",
    "the magnetogram from _ sdo_/hmi and the preprocessed result of the raw data are given in section  [ sec : data ] .",
    "we then present the extrapolation results for these data including both the raw and preprocessed magnetogram in section  [ sec : resu ] .",
    "finally , we draw conclusions and give some outlooks for future work in section  [ sec : colu ] .",
    "the basic idea of using the mhd relaxation approach to solve the force - free field is to use some kind of fictitious dissipation to drive the mhd system to an equilibrium in which all the forces can be neglected comparing with the lorentz force while the boundary magnetogram is satisfied . in this way",
    "the lorentz force should be self - balancing and the field can be regarded as the target force - free solution .",
    "we solve the magneto - frictional model equations in the magnetic splitting form as @xmath2 @xmath3 is the target force - free field to be solved , @xmath4 is the potential field matching the normal component of the magnetogram , and @xmath5 is the deviation between @xmath3 and @xmath4 .",
    "@xmath6 is the frictional coefficient and @xmath7 is the numerical diffusive speed of the magnetic monopole . the value of them are respectively given by @xmath8 and @xmath9 in the code , according to the time step @xmath10 and local grid size @xmath11 .",
    "many advantages can be gained by solving such form of above equations @xcite .",
    "the above equation system  ( [ eq : main_equ ] ) is solved by our cese  mhd scheme @xcite . in principle",
    "we can use any available mhd code to solve this set of equations , since it is a subset of the full mhd system .",
    "taking consideration of the computational efficiency and accuracy , we prefer to utilize modern advanced mhd codes .",
    "however , most of the modern mhd codes are based on theory of characteristic decomposition of a hyperbolic system , thus are not suitable for equation ( 2 ) , which is not a hyperbolic system .",
    "the cese scheme is a new method free of characteristic decomposition and is very suitable for the equation form here .",
    "furthermore , the cese - mhd code has been extensively used in solar physics , e.g. , the data - driven evolution modeling of ar @xcite , the global corona @xcite and the interplanetary solar wind @xcite .    to adapt for the application to real solar data",
    ", we have made extra improvements to the previous version of cese  mhd  nlfff .",
    "the first improvement is made to enhance the ability of handling noisy data in the magnetograms . in the noisy weak - field regions of magnetograms ( where the signal - to - noise ratio is small , say @xmath12  g )",
    ", the term @xmath13 could be very large due to numerical gradients of the random noise , thus the velocity @xmath14 is prone to be accelerated to extremely high , which can severely restrict the time step and slow the relaxation process of the entire system , even making the computation unmanageable . to deal with this difficulty , the pseudo - plasma density @xmath15",
    "is designed with @xmath16 , where @xmath17 is the height from the bottom surface and @xmath18  g , @xmath19  pixel . in this way",
    ", the velocity ( near the bottom magnetogram ) in the weak - field regions can be reduced significantly , while it is barely affected in the strong - field regions .",
    "slices through the volume in three axis directions are plotted to show the structure of the blocks and the bottom contour map represents @xmath20 on the photosphere.,scaledwidth=40.0% ]    secondly , to deal with the high - resolution observation data , the extrapolation is performed on a non - uniform grid within a block - structured , distributed - memory parallel computational framework ( e.g. , * ? ? ?",
    "specifically , the whole computational volume is divided into blocks with different spatial resolution , and the blocks are evenly distributed among the processors . within this framework , we have lots of freedom to configure the mesh and save computational resources comparing with a uniform grid . as concentrated strongly in the photosphere but",
    "expanding rapidly into the corona due to abrupt drop of the gas pressure , the coronal field becomes smoother and weaker successively with height .",
    "naturally we use a grid with decreasing resolution with height : at the bottom the grid spacing matches the resolution of the magnetogram and up to the top of the model box , the grid spacing is increased by , say , four times . at present",
    "we use the same resolution in the horizontal plane , and application of adaptive resolution based on the pattern of magnetic flux distribution is under development . with this framework , we also add some coarse buffer blocks around the central volume to reduce influence by the numerical boundaries without adding much computational burden .",
    "an example of the grid is shown in figure  [ fig : grid ] .",
    "routinely the quantities in the computational volume is initialized by setting @xmath21 and @xmath22 .",
    "the potential field @xmath4 is obtained by a green s function method ( e.g. , * ? ? ?",
    "the bottom boundary is incrementally fed with the observed vector magnetogram in tens of alfvn time @xmath23 , while all the other numerical boundaries are fixed with @xmath21 and @xmath24 .",
    "g ; the vectors represent the transverse fields ( above @xmath25  g ) .",
    "the length unit is arcsec.,scaledwidth=40.0% ]      the helioseismic and magnetic imager ( hmi ) on board the _ solar dynamics observatory ( _ sdo _ ) _ provides photospheric vector magnetograms with a high resolution both in space and time .",
    "it observes the full sun with a 4k@xmath264k ccd whose spatial sampling is 0.5 arcsec per pixel .",
    "raw filtergrams are obtained at 6 different wavelengths and 6 polarization states in the fe i 6173   absorption line , and are collected and converted to observable quantities ( like dopplergrams , continuum filtergrams , and line - of - sight and vector magnetograms ) on a rapid time cadence . for the vector magnetic data ,",
    "each set of filtergrams takes 135  s to be completed . to obtain vector magnetograms ,",
    "stokes parameters are first derived from filtergrams observed over a 12-min interval and then inverted through the very fast inversion of the stokes vector @xcite .",
    "the 180@xmath27 azimuthal ambiguity in the transverse field is resolved by an improved version of the `` minimum energy '' algorithm @xcite .",
    "regions of interest with strong magnetic field are automatically identified near real time @xcite .",
    "a detailed description on how the vector magnetograms are produced can be found on the website //http://jsoc.stanford.edu",
    "/ jsocwiki / vectorpaper .",
    "the magnetogram data we use here is downloaded from http://jsoc.stanford.edu/jsocwiki/vectorpaper , where the hmi vector magnetic field data series ` hmi.b_720s_e15w1332 ` are released for several ars .",
    "there are two special formats , i.e. , direct cutouts and remapped images .",
    "we use the remapped format which is more suitable for modeling in local cartesian coordinates , since the images are computed with a lambert cylindrical equal area projection centered on the tracked region . for our test , we select two ars , ar 11158 and ar 11283 , both of which produced x - class flares and were very non - potential .",
    "the full resolution of the data is about 0.5@xmath28 per pixel and we rebin them to 1@xmath28 per pixel for the nlfff modeling .",
    "ar 11158 is a well - known target studied in many recent works for different purposes ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) , and was selected by @xcite for special test on optimizing their extrapolation code with hmi data .",
    "this ar has a multipolar and complex structure .",
    "it produced several major flares and coronal mass ejections ( cmes ) during its disk passage , including the first x - class flare of cycle 24 on 2012 february 15 .",
    "figure  [ fig : vectormap ] ( the first panel ) shows a vector magnetogram of ar 11158 taken at 20:36  ut on 2011 february 14 , which will be used for our computation .",
    "this ar is well isolated from other ones and is almost flux - balanced ( see table  [ tab : quality ] ) , with the main polarities concentrated in the central field of view ( fov ) .",
    "as can be seen , the field shows a strong shearing along the polarity inversion lines ( pils ) .",
    "another one , ar 11283 , is also very eruptive , generating several x - class flares and cmes .",
    "we select a magnetogram taken at 22:00  ut on september 6 , just prior to a major flare at 22:20  ut .",
    "the magnetogram is shown in the second panel of figure  [ fig : vectormap ] . as an input for extrapolation",
    ", this data is not good as ar 11158 s , since the flux is dispersed with some strong polarities almost on the edge of the fov .",
    "also the total flux is not well balanced ( see table  [ tab : quality ] ) , which is unfavorable for our extrapolation .            [",
    "cols=\"<,<,<,<,<,<,<\",options=\"header \" , ]      figure  [ fig : ar11283_aia ] compares the aia 171   loops with the reconstructed field in the same way as figure  5 . for this ar",
    ", the nlfff model appears to perform only slightly better than the potential model ( there are some loops even worse produced by the nlfff model than the potential model near the north - east boundary of the fov ) .",
    "the clearest misalignment with the observation is the large closed loop pointed by the arrow in aia image .",
    "this group of loops are failed to be recovered by both the potential and force - free models which give open field lines instead .",
    "this , however , is not unexpected since the inputted magnetogram has flux unbalanced by @xmath29 .",
    "so there must be field lines from the negative polarity opening in the fov .",
    "the reason for this flux unbalance may be that the positive flux in the east is rather dispersed ( much more than the negative polarity ) , and thus properly be underestimated by the observation .    near the major polarity the structure of the loops is very complex and the extrapolated field shows highly sheared and twisted structures , indicating a significant non - potentiality there .",
    "actually this was the site of the flare and filament eruption .",
    "the distribution of the vertically integrated current shows a strong concentration of current in this region , as denoted by a in figure  [ fig : ar11283_jc ] . in the same figure",
    ", we show the local field structure and the observations from different wavelengths of much higher temperature than 171   .",
    "the magnetic field exhibits a multi - flux rope configuration .",
    "the most remarkable structure is a sigmoid , i.e. , the s - shaped loop in the aia 94   and 335   images .",
    "the sigmoid can be seen most clearly in the aia 94   wavelength ( @xmath30  mk ) with rather thin but enhanced shape , and is also well shaped in the soft x - ray image taken by _",
    "in the fourth panel of the figure the field lines are plotted overlying on the aia 94   image .",
    "it demonstrates that our extrapolation has recovered the sigmoid rather precisely , at least in morphology ( see the precise alignment of the field lines with the shape of the sigmoid ) .",
    "the distribution of the current also resembles roughly the shape of the sigmoid , suggesting that the enhancement of euv and x - ray emission associated with the sigmoid is made by the strong field - aligned current via joule heating of the plasma .",
    "this sigmoid locates between the major positive and negative polarities and the currents reside mostly in the north - east part , as shown by the current distribution .",
    "the twist of the sigmoid field lines is not strong as modeled in other cases such as @xcite or @xcite , and this sigmoid is composed of a single flux rope , which is also different from their results with two flux ropes or double - j shaped current pattern .",
    "the observation and modeling suggest that there seems to be another flux rope overlying the sigmoid , and the flare and cme may be resulted by the eruptions of these flux ropes , which is left for future study .",
    "similarly , we compute the metrics of force - freeness and divergence - freeness for both the full region and the subregion and the results are given in table  [ tab : ar11283 ] . by comparing the results using the raw and preprocessed data",
    ", we find that evidently the preprocessed result is closer to force free , especially of the full region for which the raw data gives cwsin@xmath31 ( @xmath32 ) while the preprocessed data gives cwsin@xmath33 ( @xmath34 ) . thus for this ar the preprocessing indeed improves the extrapolation greatly .",
    "also the divergence is reduced by the preprocessing .",
    "it is noticeable that the total energy content is doubled by the preprocessing , reaching @xmath35  erg .",
    "but even this improvement of the free energy is likely to underestimate the actual value , considering that a x - class flare and cme erupted immediately @xcite . still the current is strongly localized and the free energy is concentrated within the strong - current region , i.e. , subregion a , which occupies only less than one percent of the full volume , but contains most of the free energy .",
    "it is important to monitor the relaxation process to study whether the iteration converges , since there is no theory to guarantee this .",
    "here we study the convergence process of the computations by temporal evolution of several monitors , including the residual of field between two successive iterations @xmath36 ( where @xmath37 denotes the iteration step ) , the metric cwsin and the total energy content .",
    "we record the residual by every ten steps and compute cwsin and total energy by every ten @xmath23 .",
    "results for extrapolation of both ars are plotted in figure  [ fig : conv ] . as can be seen",
    ", the system converges smoothly and fast . during the first 10  @xmath23 ,",
    "the residual keeps increasing because the transverse field is inputted at the bottom continuously , which drives the system away from the initial potential field . after this driving process , the residual drops immediately , indicating a fast relaxation of the system . with about 40 @xmath23 ( nearly 10000 iterations ) , the residual",
    "is already reduced to @xmath38 , and all the metrics and energy almost stagnate afterward .",
    "thus the computations can actually be terminated once the residual is below @xmath39 , which is consistent with our previous studies for benchmark cases @xcite .",
    "it is also noteworthy that the convergence process is rather smooth , without any obvious oscillation or abrupt variation of the residual or the metrics , so the iteration is `` safe '' .",
    "this is a good feature of our code over other iteration codes for extrapolation , e.g. , the @xcite s magnetofrictional code or the @xcite s grad - rubin - like code , which usually show strong oscillatory in the iteration or even fail to converge occasionally @xcite .",
    "in this paper we have applied the cese  mhd  nlfff code to the _ sdo_/hmi vector magnetograms .",
    "two ars are sampled for the test , ar  11158 and ar  11283 , both of which produced x - class flares and were very non - potential .",
    "we compared the results with the _",
    "sdo_/aia images , showing that the reconstructed field lines resemble well most of the plasma loops , which is a basic requirement for an applicable nlfff modeling code @xcite .",
    "because the magnetic flux of the ar  11283 magnetogram is not well balanced , the extrapolation of the large scale field appears not as good as that for ar  11158 .",
    "observation shows that in the core regions of the ars there were filament or sigmoid which are important precursors of eruptions like flares and cmes .",
    "we also found in these places , there were highly - sheared and twisted field lines , i.e. , flux ropes , which contain strong field - aligned currents and plenty of non - potential energy , and our extrapolations recovered indeed well those observed features , especially the sigmoid in ar  11283 . by computing the metric cwsin which measures mean value of misalignment between the magnetic field and electric current , we found that , the force - free constraint is fulfilled very well in the strong - field regions ( cwsin @xmath40 , misalignment about @xmath41 ) but apparently not that well in the weak - field regions ( cwsin @xmath42 , misalignment about @xmath34 ) because of the data noise and the numerical errors of the small currents .",
    "the energy contents of our results are also consistent with the previous computations ( with respect to the ar  11158 , e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ) . in summary",
    "our extrapolation code can be used as a viable tool to study the 3d magnetic field in the corona .",
    "we developed the cese ",
    "nlfff code not only for field extrapolation , but also as a sub - program for the project of data - driven mhd modeling of the ars , the eruptions and their dynamic evolutions in the global corona using continuously - observed data on the photosphere . at present numerical mhd investigations of the solar eruptions",
    "@xcite are mostly based on idealized magnetic configurations without constrained by real observations .",
    "a step forward of understanding what really happens in the solar eruptions , certainly necessitates the observation - constrained numerical model .",
    "for example , considering that nlfff extrapolation can recover highly - sheared magnetic arches and twisted flux ropes , which are basic building blocks of many eruption models ( e.g. , * ? ? ? * ; * ? ? ? * ) , utilizing the extrapolated field from real magnetograms can obviously provide much more realistic initial inputs than those idealized models like @xcite s flux rope model . our future work is to input the extrapolation field as an initial condition into the data - driven full mhd model @xcite , along with the surface plasma flows derived from time - series of photosphere magnetograms ( e.g. , * ? ? ? * ) as bottom boundary condition to stress the model , with an objective to better simulate the initiation and evolution of solar explosive phenomena and their interplanetary evolution process .",
    "this work is jointly supported by the 973 program under grant 2012cb825601 , the chinese academy of sciences ( kzzd - ew-01 - 4 ) , the national natural science foundation of china ( 41204126 , 41274192 , 41031066 , and 41074122 ) , and the specialized research fund for state key laboratories .",
    "data are courtesy of nasa / sdo and the hmi science teams . c.  w. jiang thanks dr .",
    "x. luo for a careful revise of the text .",
    "the authors thank the anonymous referee for invaluable comments .                      , m.  l. , schrijver , c.  j. , barnes , g. , leka , k.  d. , lites , b.  w. , aschwanden , m.  j. , amari , t. , canou , a. , mctiernan , j.  m. , rgnier , s. , thalmann , j.  k. , valori , g. , wheatland , m.  s. , wiegelmann , t. , cheung , m.  c.  m. , conlon , p.  a. , fuhrmann , m. , inhester , b. , & tadesse , t. 2009 , , 696 , 1780                                                            , c.  j. , derosa , m.  l. , metcalf , t. , barnes , g. , lites , b. , tarbell , t. , mctiernan , j. , valori , g. , wiegelmann , t. , wheatland , m.  s. , amari , t. , aulanier , g. , dmoulin , p. , fuhrmann , m. , kusano , k. , rgnier , s. , & thalmann , j.  k. 2008 , , 675 , 1637"
  ],
  "abstract_text": [
    "<S> due to the absence of direct measurement , the magnetic field in the solar corona is usually extrapolated from the photosphere in numerical way . at the moment , the nonlinear force - free field ( nlfff ) model dominates the physical models for field extrapolation in the low corona . </S>",
    "<S> recently we have developed a new nlfff model with mhd relaxation to reconstruct the coronal magnetic field . </S>",
    "<S> this method is based on cese  mhd model with the conservation - element / solution - element ( cese ) spacetime scheme . in this paper , we report the application of the cese  mhd  nlfff code to _ </S>",
    "<S> sdo_/hmi data with magnetograms sampled for two active regions ( ars ) , noaa ar 11158 and 11283 , both of which were very non - potential , producing x - class flares and eruptions . </S>",
    "<S> the raw magnetograms are preprocessed to remove the force and then inputted into the extrapolation code . </S>",
    "<S> qualitative comparison of the results with the _ </S>",
    "<S> sdo_/aia images shows that our code can reconstruct magnetic field lines resembling the euv - observed coronal loops . </S>",
    "<S> most important structures of the active regions are reproduced excellently , like the highly - sheared field lines that suspend filaments in ar  11158 and twisted flux rope which corresponds to a sigmoid in ar  11283 . </S>",
    "<S> quantitative assess of the results shows that the force - free constraint is fulfilled very well in the strong - field regions but apparently not that well in the weak - field regions because of data noise and numerical errors in the small currents .    </S>",
    "<S> = 1    utf8gbsn </S>"
  ]
}