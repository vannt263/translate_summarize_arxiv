{
  "article_text": [
    "the excursion set theory @xcite is a concise yet very successful approach @xcite to study the nonlinear structure formation in the standard cold dark matter ( cdm ) scenario .",
    "starting from an ( usually gaussian ) initial distribution of the density perturbation field at early times , with an evolution model such as the spherical collapse model , to map an initial density perturbation to a nonlinear structure ( dark matter halo ) at some late time , it can predict statistically what fraction of matter has been assembled into the halo at that time .",
    "it makes the physics of structure formation clear and simple , and was a major tool for studying the large - scale structure formation when large cosmological simulations were still beyond the capability of supercomputers .    with the coming of the era of precision cosmology and progresses in supercomputing , @xmath0-body simulations",
    "@xcite have become more common nowadays for its ability to capture non - linear evolution without any assumptions in the evolution model and hence more accurate predictions than the excursion set theory . despite this",
    ", the analytical results of the latter still provide valuable information .",
    "for example , fitting formulae of the mass function can be obtained @xcite , the parameters of which are then calibrated by the numerical simulations @xcite .    in many aspects",
    ", the study of the cause of the accelerated cosmological expansion @xcite follows the same history of the enquiries of cdm : people first ask about their implications in the large , linear structures , and then gradually shift towards the smaller , nonlinear scales , in which process ever advanced techniques and tools are developed . after an initial burst of theoretical or phenomenological models following the first observational evidences of the cosmic acceleration @xcite",
    ", people have spent years trying to understand the behaviour of all these models on large scales , paving the road that leads to a better and full understanding of the theories and preparing for the confrontations with future data .",
    "one important class of such models involves modifications to einstein s general relativity ( gr ) on large scales @xcite . although these modified gravity models are mainly designed to explain the observations , many of the ideas are motivated from studies in fundamental physics , making them very appealing . clearly ,",
    "because gr has been tested rigorously in the laboratories and solar system @xcite , any modifications to it must be strongly suppressed in the local environments and every successful modified gravity model must have some mechanisms to achieve this suppression to pass the first test . in this work",
    "we will focus on a class of models where gr is modified by an additional dynamical scalar degree of freedom ( a scalar field ) which mediates a fifth force of gravitational strength between matter particles ; the equation of motion of this scalar makes it extremely heavy and therefore hard to propagate , or extremely weakly coupled to matter , in regions of high matter density . in both cases the fifth force is suppressed and therefore much weaker than gravity .",
    "the chameleon model of @xcite is a representative example .",
    "chameleon models can have very rich phenomenology .",
    "in many cases , the background evolution can be indistinguishable from that of the standard @xmath1cdm paradigm ( see , e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* for some examples ) .",
    "the linear perturbations on very large scales are unaffected by the fifth force either , because even in low density environments the range of the fifth force is only of order mpc @xcite  which means that observables such as the cosmic microwave background ( cmb ) spectrum and integrated sachs wolfe ( isw ) effect are the same as the @xmath1cdm predictions . finally ,",
    "because of the strong suppression in the solar system , there is no detectable deviation from gr locally .",
    "consequently , the only place where we could expect to see effects of modified gravity would be the nonlinear structures such as voids , clusters and galaxies , which are exactly the regime where numerical simulations are needed to make accurate predictions .",
    "although a number of numerical simulations have already been done for such modified gravity models @xcite , they are still at a very early stage .",
    "the reason is that the equation governing the scalar field is generally very nonlinear and it usually takes much longer to solve it than the standard poisson equation of newtonian gravity .",
    "performing @xmath0-body simulations for modified gravity with very large box sizes and high mass / force resolutions are still a technical challenge , and this fact brings us back to the analytical methods , such as the excursion set theory .    unfortunately , even the application of the excursion set theory becomes very nontrivial in the modified gravity theories .",
    "the nonlinear equation essentially makes the behaviour of the scalar field ( and the fifth force ) sensitively dependent on the surrounding environment , and to determine the mapping from an initial overdensity to a late - time nonlinear structure we need to have knowledge of the environments , which have very different densities and can at best be described by some probability distributions ( see @xcite for an earlier study of such mapping ) . to solve this problem",
    ", @xcite proposed an extension to the standard excursion set theory by solving the above mapping in some specific environments then averaging over the probability distribution of the environments . an alternative way of viewing this approach is that the critical density for halo formation follows a distribution which depends on the environment density contrast  in the language of excursion set theory the barrier is stochastic even though the collapse is described by the deterministic spherical collapse model .",
    "this stochasticity of barrier is in contrast to the one discussed in @xcite in the ellipsoidal collapse model and we refer the readers to the appendix c of @xcite for the discussion regarding the scatter of critical density observed in numerical simulations and the stochasticity of barrier in the excursion set formalism .",
    "the crucial component of the extended excursion set model is the environment : how do we define it ? obviously , different definitions may give rise to different environmental probability distributions , and there must be some physical arguments to motivate the definition . as a first example to illustrate the idea , @xcite define the environment by fixing a lagrangian ( or initial comoving ) size , which is the simplest possibility , surrounding each proto - halo . as we shall discuss below",
    ", this definition has several drawbacks which can be cured by defining the environments as an eulerian ( physical ) size .",
    "this paper is organised as follows : in   [ sect : chameleon ] we briefly review the theoretical model to be considered and summarise its main ingredients .",
    "we then discuss our new definition of environment and its motivation in ",
    "[ sect : env ] .",
    "  [ sect : umf ] is the main part of this work , which gives the numerical results of the unconditional mass function using both lagrangian and eulerian definitions of environments and discusses their difference ; it also compares the two different methods of calculation  numerical integration and monte carlo simulation  and finds good agreement .",
    "the summary and conclusions of this paper can be found in   [ sect : con ] .",
    "this section lays down the theoretical framework for investigating the effects of coupled scalar field(s ) in cosmology .",
    "we shall present the relevant general field equations in   [ subsect : equations ] , and then specify the models analysed in this paper in   [ subsect : specification ] .",
    "the equations presented in this sub - section can be found in @xcite , and are presented here only to make this work self - contained .",
    "we start from a lagrangian density @xmath2 + v(\\varphi ) - c(\\varphi){\\cal l}_{\\rm{dm } } + { \\cal l}_{\\rm{s}},\\end{aligned}\\ ] ] in which @xmath3 is the ricci scalar , @xmath4 with @xmath5 being the gravitational constant , @xmath6 and @xmath7 are respectively the lagrangian densities for dark matter and standard model fields .",
    "@xmath8 is the scalar field and @xmath9 its potential ; the coupling function @xmath10 characterises the coupling between @xmath8 and dark matter .",
    "given the functional forms for @xmath9 and @xmath10 a coupled scalar field model is then fully specified .",
    "varying the total action with respect to the metric @xmath11 , we obtain the following expression for the total energy momentum tensor in this model : @xmath12 + c(\\varphi)t^{\\rm{dm}}_{ab } + t^{\\rm{s}}_{ab},\\end{aligned}\\ ] ] where @xmath13 and @xmath14 are the energy momentum tensors for ( uncoupled ) dark matter and standard model fields . the existence of the scalar field and its coupling change the form of the energy momentum tensor leading to potential changes in the background cosmology and structure formation .",
    "the coupling to a scalar field produces a direct interaction ( fifth force ) between dark matter particles due to the exchange of scalar quanta .",
    "this is best illustrated by the geodesic equation for dark matter particles @xmath15 where @xmath16 is the position vector , @xmath17 the ( physical ) time , @xmath18 the newtonian potential and @xmath19 is the spatial derivative .",
    "the second term in the right hand side is the fifth force and only exists for coupled matter species ( dark matter in our model ) .",
    "the fifth force also changes the clustering properties of the dark matter .    to solve the above two equations we need to know both the time evolution and the spatial distribution of @xmath8 , _",
    "i.e. _ we need the solutions to the scalar field equation of motion ( eom ) @xmath21 or equivalently @xmath22 where we have defined @xmath23 the background evolution of @xmath8 can be solved easily given the present day value of @xmath24 since @xmath25 .",
    "we can then divide @xmath8 into two parts , @xmath26 , where @xmath27 is the background value and @xmath28 is its ( not necessarily small nor linear ) perturbation , and subtract the background part of the scalar field equation of motion from the full equation to obtain the equation of motion for @xmath28 . in the quasi - static limit in which we can neglect time derivatives of @xmath28 as compared with its spatial derivatives ( which turns out to be a good approximation on scales ) , we find @xmath29 where @xmath30 is the background dark matter density .",
    "the computation of the scalar field @xmath8 using the above equation then completes the computation of the source term for the poisson equation @xmath31\\nonumber\\\\ & = & { { \\kappa}\\over{2}}\\left[c(\\varphi)\\rho_{\\rm{dm } } + \\rho_{\\rm{b } } - 2v(\\varphi)\\right ] , \\end{aligned}\\ ] ] where @xmath32 is the baryon density ( we have neglected the kinetic energy of the scalar field because it is always very small for the model studied here ) .      as mentioned above , to fully fix a model we need to specify the functional forms of @xmath9 and @xmath10 . here",
    "we will use the models investigated by @xcite , with @xmath33 and @xmath34^\\alpha}}.\\end{aligned}\\ ] ] in the above @xmath1 is a parameter of mass dimension four and is of order the present dark energy density ( @xmath8 plays the role of dark energy in the models ) .",
    "@xmath35 are dimensionless parameters controlling the strength of the coupling and the steepness of the potentials respectively",
    ".    we shall choose @xmath36 and @xmath37 as in @xcite , ensuring that @xmath38 has a global minimum close to @xmath39 and @xmath40 at this minimum is very large in high density regions .",
    "there are two consequences of these choices of model parameters : ( 1 ) @xmath8 is trapped close to zero throughout cosmic history so that @xmath41 behaves as a cosmological constant ; ( 2 ) the fifth force is strongly suppressed in high density regions where @xmath8 acquires a large mass , @xmath42 ( @xmath43 is the hubble expansion rate ) , and thus the fifth force can not propagate far .",
    "the suppression of the fifth force is even stronger at early times , and thus its influence on structure formation occurs mainly at late times .",
    "the environment - dependent behaviour of the scalar field was first investigated by @xcite , and is often referred to as the ` chameleon effect ' .",
    "the extended excursion set approach for chameleon models proposed in @xcite differs from the original excursion set approach in the introduction of environment , which is important in the chameleon models for two reasons : first , the environmental density determines the critical density for the spherical collapse inside it ; second , an arbitrary spherical overdense region does not reside in an environment with any density equally likely . as a result , in the language of excursion set theory , the calculation of the first - crossing probability of the critical density curve must now be done in different environments and then integrated over the distribution of the environment .",
    "it is therefore evident that the specification of the environment is crucial in the extended excursion set approach . in @xcite ,",
    "the environment is defined as the follows :    1 .",
    "it is a spherical region with a common centre as the considered spherical overdensity ( i.e. , the halo - to - be ) ; 2 .",
    "it is much bigger than the halo - to - be ; 3 .",
    "it is not too big because otherwise it will not give a faithful representation of the environmental density .    as a first approximation",
    ", @xcite defines the environment to have a _",
    "lagrangian _ radius of @xmath44mpc and calls this a fixed - scale environment approximation .",
    "this simplifies the numerical calculation and eliminates the need of monte carlo simulations .",
    "however , the use of the lagrangian radius @xmath45 has certain drawbacks . as a first example , if the environment density is high ( e.g. , close to the critical density for collapse ) , then at late times the sizes of the environment and the halo - to - be could be roughly the same , violating the above requirement that the environment should be much bigger than the halo - to - be . as a second example",
    ", if the environmental density is low , then it expands faster than the cosmic expansion and at late times can become very large in size , no longer providing a faithful representation of the environment .    in @xcite",
    "it has been shown , using numerical simulation results , that the analytical formula for the fifth force used in @xcite is quite accurate , assuming that the environment has an _ eulerian _",
    "( rather than lagrangian ) radius @xmath46mpc ; see fig .  2 there .",
    "as a result , a more physically reasonable definition of the environment is its eulerian radius . as the characteristic length scale in the chameleon models is the compton length @xmath47 of the scalar field ( which is a function of time ) , a physical choice of the eulerian radius @xmath48 of the environment",
    "would then be @xmath49 because matter field within @xmath50 is expected to affect the scalar field value at a point ( this is the meaning of environment ) .",
    "of course , @xmath51 evolves ( increases ) in time , while @xmath48 could either increase or decrease depending on whether the environmental density is lower or higher than the cosmic average .",
    "one can certainly choose @xmath52 throughout the evolution , but this will make the computation rather complicated . an alternative is to have @xmath52 at late times , say @xmath53 where @xmath54 is the formation redshift of halos .",
    "this would mean that at early times @xmath48 can be different from @xmath51 , but there are two reasons to expect the overall effect to be small :    1 .",
    "the fifth force only becomes important at very late times in most chameleon models , and for redshift @xmath55 it is mostly negligible . at low redshifts",
    "the difference between @xmath48 and @xmath51 is small ; 2 .   even at early times",
    ", the difference between @xmath48 and @xmath51 is only big for overdense environments which contract during the cosmic history , but for these environments the fifth force is weak throughout the whole cosmic evolution .    in this work",
    "we shall choose @xmath48 to be smaller than the lagrangian environment @xmath45 but of the same order as @xmath51 .",
    "because the environment is bigger than the range of the fifth force , its evolution could be approximated by the @xmath1cdm model .",
    "the eulerian overdensity at time @xmath17 can be related to the linearly extrapolated density contrast @xmath56 by the spherical collapse model @xcite : @xmath57^{-\\delta_{\\rm sc } } , \\label{eqn : sc}\\end{aligned}\\ ] ] where @xmath58 is the critical density for @xmath1cdm at @xmath59 , @xmath60 is the eulerian volume , @xmath61 the mass within this eulerian volume and @xmath62 is the cosmic background density of matter .",
    "the distribution of the environment density at a given eulerian scale can be computed by the excursion set approach @xcite using the spherical collapse model .",
    ".   defines a curve @xmath63 in the @xmath64-@xmath65 plane ( see below for definition of @xmath65 ) .",
    "the first crossing of this environment barrier gives the value of the linear extrapolated density contrast @xmath56 that a spherical region containing mass @xmath61 must have in order to evolve into an eulerian volume @xmath60 at @xmath17 : @xmath66 , \\label{eqn : eulerbs}\\end{aligned}\\ ] ] where the enclosed mass is a function of @xmath65 ( ses eq .  ) .",
    "the mapping between @xmath61 and @xmath65 depends on the linear matter power spectrum as well as the smoothing kernel .",
    "if a power - law matter power spectrum @xmath67 with the power index @xmath68 is specified , then the above equation can be rewritten as @xmath69 , \\label{eqn : eulerbspkns}\\end{aligned}\\ ] ] where @xmath70 with @xmath71 the filter function and @xmath45 the lagrangian radius of the filter so that @xmath72",
    ". @xmath73 is given by @xmath74 with @xmath44mpc .",
    "in particular for @xmath75 this barrier becomes linear in @xmath76 ( approximating @xmath77 ) and make the analytical analysis easier . in what follows",
    "we shall use @xmath78mpc as suggested by @xcite .",
    "one can make a similar analogy for lagrangian environment , only in this case the barrier is vertical ( see figure  [ fig : env_eu_la ] ) and there is one and only one crossing of this lagrangian barrier .    in the language of excursion set theory , then , the first crossing probability of the moving barrier @xmath79 in @xmath80 $ ] , denoted by @xmath81 , is the probability that an arbitrary point ( the centre of a halo - to - be ) is in an environment whose linearly extrapolated density contrast falls into @xmath82 $ ] and this environment will evolve into a region having an eulerian radius @xmath48 at @xmath54 ; the total mass enclosed in this environment is @xmath83 .",
    "both the environmental density and environmental mass are important for the discussions below .",
    "as a first application of the idea described above , in the rest of the paper we shall study the ( unconditional ) mass function of the chameleon models , using both numerical integration and monte carlo simulations , assuming uncorrelated steps in the framework of the excursion set formalism",
    ". the analysis of correlated steps and the associated conditional mass function and halo bias will be discussed in @xcite .",
    ", of the eulerian ( solid curve ) and lagrangian ( dashed curve ) environments , normalised to unity.,width=359 ]    fig .",
    "[ fig : env_eu_la ] illustratively demonstrates the difference between the two definitions of the environment ( eulerian and lagrangian ) . here , the dotted horizontal line denotes the critical density @xmath58 for a @xmath1cdm collapse , and the middle one of the dashed vertical lines represents the value of @xmath65 corresponding to a lagrangian radius @xmath44mpc , which was used in @xcite as the definition of the ( lagrangian ) environment .",
    "consider now two random walk trajectories ( the blue and red curves ) : they cross the middle vertical dashed line at the two dark grey filled triangles , but do not cross the dotted horizontal line before that .",
    "those two triangles correspond to two very different values of @xmath84 ( @xmath85 and @xmath86 ) and thus the two random walks represent structure formations in very different ( lagrangian ) environments .",
    "the eulerian environment , on the other hand , is defined such that its eulerian radius today is @xmath87mpc and it is represented by the solid curve .",
    "the random walks cross this curve at the two grey filled circles , corresponding to @xmath88 and @xmath89 respectively : the environments are less different if they are eulerian ! in particular , the structure formation relevant for the red random walk now takes place in an overdense rather than underdense environment .",
    "note that the two filled circles correspond to lagrangian radii of @xmath90 and @xmath91mpc ( the left and right vertical dashed lines ) respectively , while the two filled triangles correspond to eulerian radii of @xmath92 ( dash - dotted curve ) and @xmath93mpc ( dash - dot - dot curve ) respectively .",
    "it is clear that the eulerian environment of the blue random walk contains about seven times more matter than that of the red random walk , but if one uses lagrangian definition then both environments contain the same amount of matter .",
    "the above result has implied that the eulerian and lagrangian environments should have different probability distribution functions ( pdfs ) .",
    "we then need to compute the pdf of @xmath84 , @xmath94 , for these environment definitions : the lagrangian density contrast follows the gaussian distribution and the corresponding @xmath94 is given by eq .",
    "( 40 ) of @xcite , while the eulerian density can be considered as a mixture of lagrangian density from different smoothing scales : a dense eulerian environment is evolved from a bigger lagrangian batch but the opposite is true for underdense eulerian environments .",
    "there are different methods to calculate @xmath94 for the eulerian environment : one can either obtain it by solving the first crossing distribution of the barrier in eq .",
    "( see @xcite for uncorrelated steps ; @xcite for correlated steps ) , or using analytical expressions such as the log - normal distribution or the expressions given in @xcite for the evolved nonlinear density contrast and combining that with eq .   to obtain @xmath94 ( recall that @xmath84 is the linearly extrapolated density contrast at the eulerian environment ) . in particular , for power - law matter power spectrum the barrier is given by eq .   and applying the first crossing probability approximation in @xcite ( see @xcite for an explanation for this approximation ) , the distribution of @xmath84 is @xmath95   \\left(1-\\frac{\\delta_{\\rm env}}{\\delta_c}\\right)^{-\\omega/2 - 1 } \\nonumber \\\\ * & \\times",
    "\\exp\\left[-\\frac{\\beta^{\\omega}}{2}\\frac{\\delta_{\\rm env}}{(1-\\delta_{\\rm env}/\\delta_c)^\\omega}\\right],\\end{aligned}\\ ] ] where @xmath96 , @xmath97 , and @xmath98 is the logarithmic derivative of the density fluctuation variance w.r.t .",
    "@xmath61 : @xmath99 the case where @xmath100 is of special interest , since not only the barrier @xmath79 is linear in @xmath65 ( if one set @xmath101 ) , the first crossing probability approximation above is also exact ( see , for example , * ? ? ?",
    "* for derivation ) .",
    "the associated distribution of @xmath84 becomes @xmath102    the two environment density distributions for the case of power - law power spectrum with @xmath103 are shown in fig .",
    "[ fig : env_distr ] , which shows the pdf for the eulerian environment peaks at bigger @xmath84 than that for the lagrangian environment .",
    "the results were computed numerically using the method described in @xcite and used in @xcite .",
    "note that    1 .   if @xmath84 is close to @xmath104 the pdf is smaller for the eulerian environment , because for such an environment to evolve into an eulerian radius of @xmath87mpc today , it must have an extremely large lagrangian size ( @xmath105mpc ) , which is a very rare event ; note that the other reason is due to the approximation formula eq .",
    " it maps @xmath106 to @xmath107 .",
    "hence @xmath108 must go to zero for @xmath109 .",
    "the pdf for lagrangian environment peaks at @xmath110 , because at any value of @xmath65 ( say @xmath111 for @xmath44mpc , middle vertical dashed line of fig .  [ fig : env_eu_la ] ) the value of the random walk position satisfies a gaussian distribution ; 3 .",
    "the pdf for eulerian environment peaks at @xmath112 , because the random walk is crossing a decreasing barrier .",
    "this means that if one integrates over the pdf of environments then more contributions come from higher - density environments under the eulerian definition ; 4 .",
    "the pdf is lower for small @xmath84 ( @xmath113 ) under the lagrangian definition , because underdensities with linearly extrapolated density contrast @xmath114 and lagrangian size @xmath44mpc will have evolved into very large eulerian sizes today ( @xmath115mpc ) , and this is rare event ; in contrast , to have an eulerian size of @xmath87mpc today such undensities can be quite small in initial sizes whose r.m.s fluctuation is bigger and hence the probability is not negligible .",
    ", as a function of the linearly extrapolated environmental density contrast @xmath84 and @xmath65.,width=359 ]        the spherical collapse history of an initial overdensity in a given environment of linearly extrapolated density contrast @xmath84 has been discussed in detail in @xcite , to which interested readers are referred , and here we will only give a qualitative description of the results .",
    "[ fig : dc_grid ] shows the critical density @xmath116 for an initial overdensity to collapse at @xmath59 , as a function of both @xmath65 and @xmath84 . as the fifth force is always attractive ,",
    "@xmath117 where @xmath104 is the critical density if the fifth force vanishes .",
    "furthermore ,    1 .   in high - density environments ( @xmath118 ) the fifth force",
    "is strongly suppressed so that the collapse is governed by newtonian gravity only and @xmath119 ; 2 .",
    "as @xmath84 decreases , the fifth force becomes stronger in general and enhances the matter clustering .",
    "this means that the required critical density to collapse at @xmath54 is lower ; 3 .",
    "very small values of @xmath65 correspond to the very big smoothing scales .",
    "such regions have efficient self - screening of the fifth force irrespective of their environment , and hence @xmath120 for arbitrary @xmath84 for small @xmath65 ; 4 .",
    "large values of @xmath65 correspond to small smoothing scales , which does not have strong self - screening of the fifth force , and hence @xmath121 depends sensitively on @xmath84 .    in practice , once we know @xmath84 , we can fully determine the collapse criteria for halos of arbitrary size in this environment , and therefore the first crossing probability density , @xmath122 , across the barrier @xmath116 . here",
    "@xmath123 denotes it is the conditional first crossing probability that the random walks having _ first _ crossed @xmath79 given in eq .",
    "( [ eq : b_env ] ) at @xmath124 .",
    "one then only needs to average over the first crossing probability distribution of @xmath84 ( which we have found in the previous subsection ) to find the averaged first crossing probability @xmath125 .",
    "as in @xcite , the final first crossing probability , which is related to the unconditional mass function , is calculated by making the environmental average : @xmath126 where the upper limit of the integral is @xmath104 because @xmath127 ( c.f .",
    "[ fig : env_distr ] ) because by definition an environment has not collapsed to form a halo by @xmath54 . in the case of lagrangian environment , @xmath128 is defined so that it is identically zero for @xmath129 , as shown in eq .",
    "( 40 ) of @xcite . for the eulerian environment proposed in this work",
    ", the eulerian barrier always lies below @xmath104 for all @xmath130 hence this upper limit is valid by construction .",
    "the mass function , @xmath131 , is related to @xmath125 by @xmath132 where @xmath133 is the number density of halos and @xmath134 the halo mass . in the literature ,",
    "an alternative quantity which is often used is the collapsed mass fraction @xmath135 , with @xmath136 .",
    "@xmath135 is the fraction of matter in collapsed objects per logarithmic interval of @xmath137 and satisfies @xmath138    in the following subsections , we shall calculate the quantity @xmath135 using two methods : the numerical integration of eq .",
    "( [ eq : num_int ] ) and monte carlo simulations .",
    "we focus on the excursion set with uncorrelated step in the current study but would like to point out that eq .",
    "( [ eq : num_int ] ) applies in both correlated and uncorrelated steps calculation  in the case of correlated steps one must take into account the fact that the condition in @xmath122 is the random walk _ first _ crosses the environment barrier at @xmath84 , or in other words the random walk is non - markovian .",
    "it complicates the analytical calculation and it will be discussed in @xcite . in the present case where the random walk has uncorrelated steps ( it is markovian ) , the conditional probability does not depend on the history of the walk prior to @xmath84 .    in what follows",
    "we apply two approaches to evaluate the halo mass function in modified gravity models .",
    "the numerical integration approach is similar to the previous work by @xcite which applies the method in @xcite ; the monte carlo simulation approach follows the variation of density contrast as a function of smoothing scale and we keep tracks of the first crossing of the environment barrier as well as the first crossing of the consequent modified halo formation barrier .      as numerical examples",
    ", we have calculated @xmath135 as a function of @xmath137 for three models ",
    "grcdm interchangeably . ] and two chameleon models with @xmath139 and @xmath140  all having the same background cosmology .",
    "a power - law matter power spectrum with index @xmath103 is assumed . for each model",
    "we have done the calculation assuming lagrangian and eulerian environments respectively , and the results are shown in fig .",
    "[ fig : nufnu_ni ] .",
    "assuming spherical collapse , there is no environmental dependence in the @xmath1cdm result , which means that the prediction of @xmath135 should be the same whether one uses the lagrangian or eulerian definition of environment .",
    "this has been confirmed in the upper left panel of fig .",
    "[ fig : nufnu_ni ] , which serves as a check of accuracy of the numerical computation . for comparison",
    "we have also plotted the exact analytic solution for the @xmath1cdm model ( solid curve ) @xmath141    in fig .",
    "[ fig : env_distr ] we have seen that the pdf for eulerian environment peaks at higher @xmath84 than the pdf for lagrangian environment .",
    "because higher environmental density means stronger suppression and therefore weaker effect of the fifth force , we would expect that the deviation from @xmath1cdm prediction of @xmath135 be smaller if we use the eulerian instead of lagrangian definition of environment .",
    "this is confirmed by fig .  [",
    "fig : nufnu_ni ] , which shows that the former gives smaller @xmath135 for medium and large @xmath137 ( halos of medium and large sizes ) .    for small values of @xmath137 , on the other hand , @xmath135 is bigger if one uses eulerian environment , because a smaller fraction of matter has fallen into medium and large collapsed halos compared to the case of lagrangian environments , and therefore more matter is left to form the isolated small halos .",
    "note that one disadvantage of using a ( fixed - sized ) lagrangian radius , as in @xcite , is that all the environments have exactly the same initial size and so contain the same amount of matter . in particular , the biggest halo to form in any given environment can not contain more matter than that is contained in the environments , and this places an upper limit of the halo mass , as is shown in fig .",
    "[ fig : nufnu_ni ] . if one uses eulerian environment this problem is solved because the environment can be arbitrarily large in size .",
    "cdm power spectrum where ratios of mass function are taken with respect to that of eulerian environment @xmath142mpc ( red solid curve in figure  [ fig : nufnu_mc ] ) .",
    "three other chameleon models are considered : lagrangian environment with @xmath44mpc ( green boxes ) ; eulerian environment with @xmath143mpc ( blue dotted curves ) and with @xmath144mpc ( magenta dashed curves ) . _",
    "left panel _ : chameleon model with @xmath145 ; _ right panel _ : @xmath146 .",
    "only errors bars for lagrangian environment with @xmath44mpc ( green boxes ) are shown for clarity.,scaledwidth=50.0% ]    in this subsection we compare the first crossing distribution for different models with or without the chameleon fifth force using monte carlo simulations .",
    "it is customary to use the variance in eq .   with a tophat window function to relate @xmath65 and the smoothing scale @xmath3",
    "although strictly speaking it is not fully consistent since random walks with the tophat window function induces correlated steps ( or one needs to use the sharp @xmath147-space window function  which does not have a well defined enclosed mass  to obtain uncorrelated steps ) @xcite .    in the monte carlo simulations a sample of random walks",
    "is generated following the procedure in @xcite .",
    "in hierarchical models , the variance of the density field is a monotonic function of smoothing scale .",
    "hence variance of the density field @xmath65 , the smoothing scale as well as the total mass enclosed are interchangeable quantities . for the case of @xmath1cdm a constant barrier with @xmath148",
    "is assumed . for chameleon models the environment density @xmath84",
    "is recorded at the corresponding scales : for lagrangian environments , the environment density @xmath149 is recored at @xmath150mpc ; for eulerian environment @xmath151 is the height of the random walk where it first crosses the barrier @xmath79 in eq .  .",
    "the halo formation criterion @xmath152 is determined using this environment density @xmath84 ( see fig .  [",
    "fig : dc_grid ] ) .",
    "we then follow the random walk until it first crosses @xmath152 and record the associated value of @xmath65 .",
    "note that an advantage of using an eulerian scale as environment is that the eulerian barrier @xmath79 by definition always lies below the constant barrier  hence it is impossible to reach @xmath104 before crossing @xmath79 and an environment always contains more matter than the halo inside it does . on the other hand , if one uses lagrangian environments , it is possible , though rare , that the random walk reaches @xmath104 at a lagrangian scale bigger than the predefined lagrangian environment radius @xmath45 : this is just the problem we discussed at the end of sect .",
    "[ subsubsect : ni ] , and in this case we assume that the evolution of this huge overdensity follows the background environment ( @xmath153 ) . for @xmath150mpc",
    "it corresponds to first crossing across @xmath104 beyond @xmath154 .",
    "[ fig : nufnu_ni_mc ] compares the output of the monte carlo simulations to that from the numerical integration described in the previous subsection . for this purpose",
    "we have only plotted the @xmath1cdm model and a chameleon model of @xmath139 , adopting the eulerian definition of the environment with a radius of @xmath87mpc .",
    "the predicted mass functions from the two methods agree with each other reasonably in both models and , in the former case , they are consistent with the analytical result as well .",
    "as monte carlo simulations with uncorrelated steps are generally much faster than the numerical integration , we shall use the former to test the effects of different physical parameters .",
    "[ fig : nufnu_mc ] and [ fig : nufnu_ratio ] show the dependency of the collapsed mass fraction @xmath135 on the definition of environment , the initial power spectrum and the model parameter @xmath155 , from which we can see that    1 .   increasing the radius of the eulerian environment results in more big halos because it necessarily means that the pdf of the initial environment density @xmath84 shifts towards lower values of @xmath84 , making the formation of such halos more strongly affected by the fifth force .",
    "this dependence on the eulerian environment radius is subdominant compared to the modification to the gr case ; 2 .",
    "the effect of the eulerian environmental radius on the abundance of small halos is weaker ; 3 .   switching to a lagragian environment results in a distinctive drop in intermediate mass halo  this decrease corresponds to the lagrangian scale chosen : beyond @xmath156 our lagrangian environment chameleon models reverts to the gr mass function ; 4 .",
    "the results using a @xmath1cdm matter power spectrum are similar to the power - law power spectrum with @xmath103 ; 5 .   increasing @xmath155",
    "weakens the chameleon effect which suppresses the fifth force in high matter - density regions , and thus producing more large halos .",
    "for modified gravity models which reduce to newton gravity in high density environments such as the solar system , while at the same time have significant deviations from gr on mpc scales , the environment is often an important concept in both the theory and the techniques used to analyse it . in this paper",
    "we extended the work of @xcite on estimating the modification of halo abundance in chameleon models within the framework of the excursion set approach by considering the possibility of defining environments according to their eulerian , rather than lagrangian , sizes .",
    "being the physical size , the eulerian size changes with time and describes the dynamical nature of the true environment . by choosing the eulerian size to be of the same order as the compton length of the scalar field , the single length scale in the theory , we have a better motivated definition of the environments .",
    "of course , the exact value of the eulerian size @xmath48 is still a free parameter which can be tuned to match the simulation data .",
    "alternatively , one can make certain approximations in the calculation to obtain the functional form of the mass function and then calibrate the parameters using simulations .",
    "another possible solution is by applying correlated steps in the excursion set approach ( see @xcite )  dramatic fluctuations between similar smoothing scales are unlikely with correlated steps and may be able to evade this ambiguity in the choice of eulerian size .",
    "the lagrangian definition of environments also suffers from a limitation , namely that all environments , having the same initial comoving size , contain the same amount of matter .",
    "this effectively sets an upper limit of the halo mass that can be studied .",
    "the eulerian definition of environment solves this problem because here in principle the environment can be infinitely large , and halos of any mass can form within it .    in our theoretical framework",
    ", the effect of different definitions of the environment enters into the calculation through the change in the pdf of @xmath84 , which describes the distribution of density contrast in the environment surrounding halo . since the strength of the fifth force depends on @xmath84 , modifications in @xmath108 alters the halo abundance for different environment defintions .",
    "in particular we found that it is more likely to have high values of @xmath84 in eulerian environment . in this case the fifth force is suppressed and the net result is smaller deviation of the mass function from @xmath1cdm predictions , especially for the big and medium - sized halos .",
    "we have verified this using two methods : numerical integration and monte carlo simulations , and both methods agree with each other .",
    "to briefly summarise , this work emphasises the importance of environment definition in the study of structure formation in modified gravity theories , and lays down the formalism for applying a physically motiviated eulerian environment in the framework of the excursion set approach .",
    "this framework could easily be generated to other types of modified gravity theories , such as the envrionmentally dependent dilation @xcite and the symmetron @xcite modes . within this framework",
    "we can easily analyse other quantities of interests , such as the halo bias , voids statistics and merger tree",
    ". we can also derive approximate analytical expression for the halo mass function and calibrate the parameters with the numerical simulations",
    ". these will be the topics of future works .",
    "bl is supported by the royal astronomical society and the department of physics of durham university , and acknowledges the host of ipmu where this work was initiated .",
    "tyl is supported in part by grant - in - aid for young scientists ( 22740149 ) and by wpi initiative , mext , japan .",
    "bertschinger e. , 1998 , ann .",
    "astrophys . , 36 , 599 bernardeau f. , 1994 , apj , 427 , 51 bond j.  r. , cole s. , efstathiou g. , kaiser n. , 1991 , apj , 379 , 440 brax p. , rosenfeld r. , steer , d.  a. , 2010 , jcap , 08 , 033 brax p. , van de bruck c. , davis a.  c. , shaw d.  j. , 2008 , prd , 78 , 104021 brax p. , van de bruck c. , davis a.  c. , shaw d.  j. , 2010 , prd , 82 , 063519 brax p. , van de bruck c. , davis a.  c. , li b. , shaw d.  j. , 2011 , prd , in press brax p. , valageas p. , 2012",
    ", arxiv:1205.6583 corasaniti p.  s. , achitouv i. , 2011 , prd , 84 , 23009 copeland e.  j. , sami m. , tsujikawa s. , 2006 , ijmpd , 15 , 1753 clifton t. , ferreira p.  g. , padilla a. , skordis c. , 2011 , arxiv:1106.2476 [ astro-ph.co ] davis a.  c. , li b. , mota d.  f. , winther h.  a. , 2011 , apj .",
    ", in press ; arxiv:1108.3082 [ astro-ph.co ] hinterbichler k. , khoury j. , 2010 , prl , 104 , 231301 hu w. , sawicki i. , 2007 , prd , 76 , 064004 jain b. , khoury j. , 2010 , annals phys .",
    ", 325 , 1479 jenkins a.  r. , frenk c.  s. , white s.  d.  m. , colberg j.  m. , cole s. , evrard a.  e. , couchman h.  m.  p. , yoshida n. , 2001 , mnras , 321 , 372 khoury j. , weltman a. , 2004 , prd , 69 , 044026 lam t. y. , sheth r. k. , 2008a , mnras , 386 , 407 lam t. y. , sheth r. k. , 2008b , mnras , 389 , 1249 lam t. y. , sheth r. k. , 2009 , mnras , 398 , 2143 lam t. y. , li b. , 2012 , mnras , submitted ; arxiv:1205.0059 [ astro-ph.co ] li b. , 2011 , mnras , 411 , 2615 li b. , barrow j.  d. , 2007 , prd , 75 , 084010 li b. , barrow j.  d. , 2011 , prd , 83 , 024007 li b. , efstathiou g. , mnras , in press ; arxiv:1110.6440 [ astro-ph.co ] li b. , zhao g. , koyama k. , 2012 , mnras , in press ; arxiv:1111.2602 [ astro-ph.co ] li b. , zhao g. , teyssier r. , koyama k. , 2012 , jcap , 1201 , 051 li b. , zhao h. , 2009 , prd , 80 , 044027 li b. , zhao h. , 2010 , prd , 81 , 104047 li y. , hu w. , 2011 , prd , 84 , 084033 ma c. , maggiore m. , riotto a. , zhang j. , 2011 , mnras , 411 , 2644 maggiore m. , riotto a. , 2010 , apj , 711 , 907 maggiore m. , riotto a. , 2010 , apj , 711 , 515 mota d.  f. , shaw , d.  j. , 2007 , prd , 75 , 063501 musso m. , sheth r. k. , 2012 , arxiv:1201.3876 [ astro-ph.co ] oyaizu h. , 2008 , prd , 78 , 123523 oyaizu h. , lima m. , hu w. , 2008 , prd , 78 , 123524 paranjape a. , sheth r. k. , 2012 , mnras , 419 , 132 paranjape a. , lam t. y. , sheth r. k. , 2012 , mnras , 420 , 1429 paranjape a. , lam t. y. , sheth r. k. , 2012 , mnras , 420 , 1648 perlmutter s.  _ et .",
    "al . _ , 1999 , apj , 517 , 565 riess a.  g.  _ et .",
    "al . _ , 1998 ,",
    "j. , 116 , 1009 schmidt f. , lima m. , oyaizu h. , hu w. , 2009 , prd , 79 , 083518 sheth r.  k. , 1998 , mnras , 300 , 1057 sheth r.  k. , tormen g. , 2002 , mnras , 308 , 119 sheth r.  k. , tormen g. , 2002 , mnras , 329 , 61 tinker j.  l. , kravtsov a.  v. , klypin a. , abazajian k. , warren m.  s. , yepes g. , gottlober s. , holz d.  e. , 2008 , apj , 688 , 709 wang l. , caldwell r.  r. , ostriker j.  p. , steinhardt p.  j. , 2000 , apj , 530 , 17 will c.  m. , _ `` the confrontation between general relativity and experiment '' _ , living rev .",
    "relativity 9 , ( 2006 ) , 3 .",
    "url : http://www.livingreviews.org/lrr-2006-3 zentner a.  r. , 2007 , ijmpd , 16 , 763 zhang j. , hui l. , 206 , apj , 641 , 641 zhao g. , li b. , koyama k. , 2011 , prd , 83 , 044007"
  ],
  "abstract_text": [
    "<S> we have revisited the extended excursion set theory in modified gravity models , taking the chameleon model as an example . instead of specifying their lagrangian size , here we define the environments by the eulerian size , chosen to be of the same order of the compton length of the scalar field by physical arguments . </S>",
    "<S> we find that the eulerian and lagrangian environments have very different environmental density contrast probability distributions , the former more likely to have high matter density , which in turn suppressing the effect of the fifth force in matter clustering and halo formation . </S>",
    "<S> the use of eulerian environments also evades the unphysical restriction of having an upper mass limit in the case of lagrangian environments . </S>",
    "<S> two methods of computing the unconditional mass functions , numerical integration and monte carlo simulation , are discussed and found to give consistent predictions .    </S>",
    "<S> [ firstpage ]    large - scale structure of universe </S>"
  ]
}