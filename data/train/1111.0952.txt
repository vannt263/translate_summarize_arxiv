{
  "article_text": [
    "in the _ nonnegative matrix factorization _ ( nmf ) problem we are given an @xmath0 matrix @xmath1 with nonnegative real entries ( such a matrix will be henceforth called `` nonnegative '' ) and an integer @xmath2 . our goal is to express @xmath1 as @xmath3 where @xmath4 and @xmath5 are nonnegative matrices of size @xmath6 and @xmath7 respectively .",
    "we refer to @xmath11 as the _ inner - dimension _ of the factorization and the smallest value of @xmath11 for which there is such a factorization as the _ nonnegative rank _ of @xmath1 .",
    "an equivalent formulation is that our goal is to write @xmath1 as the sum of @xmath11 nonnegative rank - one matrices.we note that @xmath11 must be at least the rank of @xmath1 in order for such a factorization to exist . in some applications",
    ", it makes sense to instead ask for @xmath8 to be a good approximation to @xmath1 in some suitable matrix norm .",
    "we refer to the problem of finding a nonnegative @xmath4 and @xmath5 of inner - dimension @xmath11 that ( approximately ) minimizes @xmath9 as _ approximate nmf _ , where @xmath10 denotes the frobenius norm . without the restriction that @xmath4 and @xmath5 be nonnegative , the problem can be solved exactly via singular value decomposition @xcite .",
    "nmf is a fundamental problem that has been independently introduced in a number of different contexts and applications .",
    "many interesting heuristics and local search algorithms ( including the familiar expectation maximization or em ) have been proposed to find such factorizations .",
    "one compelling family of applications is data analysis , where a nonnegative factorization is computed in order to extract certain latent relationships in the data and has been applied to image segmentation @xcite , @xcite information retrieval @xcite and document clustering @xcite .",
    "nmf also has applications in fields such as chemometrics @xcite ( where the problem has a long history of study under the name _ self modeling curve resolution _ ) and biology ( e.g. in vision research @xcite ) : in some cases , the underlying physical model for a system has natural restrictions that force a corresponding matrix factorization to be nonnegative . in demography",
    "( see e.g. , @xcite ) , nmf is used to model the dynamics of marriage through a mechanism similar to the chemical laws of mass action . in combinatorial optimization ,",
    "yannakakis @xcite characterized the number of extra variables needed to succinctly describe a given polytope as the nonnegative rank of an appropriate matrix ( called the `` slack matrix '' ) . in communication complexity ,",
    "aho et al @xcite showed that the log of the nonnegative rank of a boolean matrix is polynomially related to its deterministic communication complexity - and hence the famous log - rank conjecture of lovasz and saks @xcite is equivalent to showing a quasi - polynomial relationship between real rank and nonnegative rank for boolean matrices . in complexity theory , nisan used nonnegative rank to prove lower bounds for non - commutative models of computation  @xcite .",
    "additionally , the 1993 paper of cohen and rothblum  @xcite gives a long list of other applications in statistics and quantum mechanics .",
    "that paper also gives an exact algorithm that runs in exponential time .",
    "[ qs:1 ] can a nonnegative matrix factorization be computed efficiently when the inner - dimension , @xmath11 , is small ?",
    "vavasis recently proved that the nmf problem is @xmath17-hard when @xmath11 is large@xcite , but this only rules out an algorithm whose running time is polynomial in @xmath15 , @xmath16 and @xmath11 .",
    "arguably , in most significant applications , @xmath11 is small .",
    "usually the algorithm designer posits a two - level generative model for the data and uses nmf to compute `` hidden '' variables that explain the data .",
    "this explanation is only interesting when the number of hidden variables ( @xmath11 ) is much smaller than the number of examples ( @xmath16 ) or the number of observations per example ( @xmath15 ) . in information retrieval",
    ", we often take @xmath1 to be a `` term - by - document '' matrix where the @xmath18 entry in @xmath1 is the frequency of occurrence of the @xmath19 term in the @xmath20 document in the database . in this context",
    ", a nmf computes @xmath11 `` topics '' which are each a distribution on words ( corresponding to the @xmath11 columns of @xmath4 ) and each document ( a column in @xmath1 ) can be expressed as a distribution on topics given by the corresponding column of @xmath5 @xcite .",
    "this example will be a useful metaphor for thinking about nonnegative factorization .",
    "in particular it justifies the assertion @xmath11 should be small  the number of topics should be much smaller than the total number of documents in order for this representation to be meaningful .",
    "see section  [ sec : appendix : remarks ] for more details .",
    "focusing on applications , and the overwhelming empirical evidence that heuristic algorithms do find good - enough factorizations in practice , motivates our next question .",
    "[ qs:2 ] can we design very efficient algorithms for nmf if we make reasonable assumptions about @xmath1 ?      here",
    "we largely resolve question  [ qs:1 ] .",
    "we give both an algorithm for accomplishing this algorithmic task that runs in polynomial time for any constant value of @xmath11 and we complement this with an intractability result which states that assuming the exponential time hypothesis @xcite no algorithm can solve the exact nmf problem in time @xmath13 .",
    "there is an algorithm for the exact nmf problem ( where @xmath11 is the target inner - dimension ) that runs in time @xmath21 .",
    "this result is based on algorithms for deciding the first order theory of the reals - roughly the goal is to express the decision question of whether or not the matrix @xmath1 has nonnegative rank at most @xmath11 as a system of polynomial equations and then to apply algorithms in algebraic geometry to determine if this semi - algebraic set is non - empty . the complexity of these procedures is dominated by the number of distinct variables occurring in the system of polynomial equations .",
    "in fact , the number of distinct variables plays an analogous role to vc - dimension , in a sense and the running time of algorithms for determining if a semi - algebraic set is non - empty depend exponentially on this quantity .",
    "additionally these algorithms can compute successive approximations to a point in the set at the cost of an additional factor in the run time that is polynomial in the number of bits in the input and output .",
    "the naive formulation of the nmf decision problem as a non - emptiness problem is to use @xmath22 variables , one for each entry in @xmath4 or @xmath5  @xcite .",
    "this would be unacceptable , since even for constant values of @xmath11 , the associated algorithm would run in time exponential in @xmath15 and @xmath16 .    at the heart of our algorithm is a structure theorem  based on a novel method for reducing the number of variables needed to define the associated semi - algebraic set .",
    "we are able to express the decision problem for nonnegative matrix factorization using @xmath23 distinct variables ( and we make use of tools in geometry , such as the notion of a separable partition , to accomplish this @xcite , @xcite , @xcite ) . thus we obtain the algorithm quoted in the above theorem .",
    "all that was known prior to our work ( for constant values for @xmath11 ) was an exponential time algorithm , and local search heuristics akin to the expectation - maximization ( em ) algorithm with unproved correctness or running time .",
    "a natural requirement on @xmath4 is that its columns be linearly independent . in most applications",
    ", nmf is used to express a large number of observed variables using a small number of hidden variables .",
    "if the columns of @xmath4 are not linearly independent then radon s lemma implies that this expression can be far from unique . in the example from information retrieval ,",
    "this translates to : there are candidate documents that can be expressed as a convex combination of one set of topics , or could alternatively be expressed as a convex combination of an entirely disjoint set of topics ( see section  [ subsec : simplicialjustify ] ) .",
    "when we add the requirement that the columns of @xmath4 be linearly independent , we refer to the associated problem as the _ simplicial factorization _ ( sf ) problem . in this case the doubly - exponential dependence on @xmath11 in the previous theorem can be improved to singly - exponential .",
    "our algorithm is again based on the first order theory of the reals , but here the system of equations is much smaller so in practice one may be able to use heuristic approaches to solve this system ( in which case , the validity solution can be easily checked ) .",
    "there is an algorithm for the exact sf problem ( where @xmath11 is the target inner - dimension ) that runs in time @xmath24 .",
    "we complement these algorithms with a fixed parameter intractability result .",
    "we make use of a recent result of patrascu and williams @xcite ( and engineer low - dimensional gadgets inspired by the gadgets of vavasis @xcite ) to show that under the exponential time hypothesis @xcite , there is no exact algorithm for nmf that runs in time @xmath13 .",
    "this intractability result holds also for the sf problem .",
    "if there is an exact algorithm for the sf problem ( or for the nmf problem ) that runs in time @xmath25 then @xmath14-sat can be solved in @xmath26 time on instances with @xmath15 variables .",
    "now we turn to question  [ qs:2 ] .",
    "we consider the nonnegative matrix factorization problem under the `` separability '' assumption introduced by donoho and stodden @xcite in the context of image segmentation .",
    "roughly , this assumption asserts that there are @xmath11 rows of @xmath4 that can be permuted to form the identity matrix .",
    "if we knew the names of these rows , then computing a nonnegative factorization would be easy .",
    "the challenge in this context , is to avoid brute - force search ( which runs in time @xmath27 ) and to find these rows in time polynomial in @xmath15 , @xmath16 _ and _ @xmath11 . to the best of our knowledge",
    "the following is the first example of a polynomial - time algorithm that provably works under a non - trivial condition on the input .",
    "there is an exact algorithm that can compute a separable , nonnegative factorization @xmath28 ( where @xmath11 is the inner - dimension ) in time polynomial in @xmath15 , @xmath16 and @xmath11 if such a factorization exists .",
    "donoho and stodden @xcite argue that the separability condition is naturally met in the context of image segmentation .",
    "additionally , donoho and stodden prove that separability in conjunction with some other conditions guarantees that the solution to the nmf problem is unique .",
    "our theorem above is an algorithmic counterpart to their results , but requires only separability .",
    "our algorithm can also be made noise tolerant , and hence works even when the separability condition only holds in an approximate sense .",
    "indeed , an approximate separability condition is regarded as a fairly benign assumption and is believed to hold in many practical contexts in machine learning .",
    "for instance it is usually satisfied by model parameters fitted to various generative models ( e.g. lda @xcite in information retrieval ) .",
    "( we thank david blei for this information . )",
    "lastly , we consider the case in which the given matrix @xmath1 does not have an exact low - rank nmf but rather can be approximated by a nonnegative factorization with small inner - dimension .    there is a @xmath29-time algorithm that , given a @xmath1 for which there is a nonnegative factorization @xmath8 ( of inner - dimension @xmath11 ) which is an @xmath30-approximation to @xmath1 in frobenius norm , computes @xmath31 and @xmath32 satisfying @xmath33    the rest of the paper is organized as follows : in section  [ sec : simp ] we give an exact algorithm for the sf problem and in section  [ sec : gen ] we give an exact algorithm for the general nmf problem . in section  [ sec : hard ] we prove a fixed parameter intractability result for the sf problem . and in section  [ sec : sep ] and section  [ sec : adv ] we give algorithms for the separable and adversarial nonnegative fatorization problems . throughout this paper",
    ", we will use the notation that @xmath34 and @xmath35 are the @xmath19 column and @xmath20 row of @xmath1 respectively .",
    "here we consider the simplicial factorization problem , in which the target inner - dimension is @xmath11 and the matrix @xmath1 itself has rank @xmath11 . hence in any factorization @xmath28 ( where @xmath11 is the inner - dimension )",
    ", @xmath4 must have full column rank and @xmath1 must have full row rank .",
    "we first argue that the extra restriction imposed in simplicial factorization is natural in many contexts : through a re - scaling ( see section  [ sec : appendix : separable ] for more details ) , we can assume that the columns of @xmath1 , @xmath4 and @xmath5 all have unit @xmath36 norm .",
    "the factorization @xmath37 can be interpreted probabilistically : each column of @xmath1 can be expressed as a convex combination ( given by the corresponding column of @xmath5 ) of columns in @xmath4 . in the example in the introduction , columns of @xmath1",
    "represent documents and the columns of @xmath4 represent `` topics '' . hence a nonnegative factorization is an `` explanation '' : each document can be expressed as a convex combination of the topics .",
    "but if @xmath4 does not have full column rank then this explanation is seriously deficient .",
    "this follows from a restatement of radon s lemma .",
    "let @xmath38 be the convex hull of the columns @xmath39 for @xmath40 .    if @xmath4 is an @xmath6 ( with @xmath41 ) matrix and @xmath42 , then there are two disjoint sets of columns @xmath43 $ ] so that @xmath44 .",
    "the observation implies that there is some candidate document @xmath45 that can be expressed as a convex combination of topics ( in @xmath46 ) , or instead can be expressed as a convex combination of an entirely disjoint set ( @xmath47 ) of topics .",
    "the end goal of nmf is often to use the representation of documents as distributions on topics to perform various tasks , such as clustering or information retrieval .",
    "but if ( even given the set of topics in a database ) it is this ambiguous to determine how we should represent a given document as a convex combination of topics , then the topics we have extracted can not be very useful for clustering !",
    "in fact , it seems unnatural to not require the columns of @xmath4 to be linearly independent !",
    "next , one should consider the process ( probabilistic , presumably ) that generates the datapoints , namley , columns of @xmath1 .",
    "any reasonable process for generating columns of @xmath1 from the columns of @xmath4 would almost surely result in a matrix @xmath1 whose rank equals the rank of @xmath4 .",
    "but then @xmath1 has the same rank as @xmath4 .      in this section",
    "we give an algorithm that solves the simplicial factorization problem in @xmath48 time .",
    "let @xmath49 be the maximum bit complexity of any coefficient in the input .",
    "there is an @xmath50 time algorithm for deciding if the simplicial factorization problem has a solution of inner - dimension at most @xmath11 .",
    "furthermore , we can compute a rational approximation to the solution up to accuracy @xmath51 in time @xmath52 .",
    "the above theorem is proved by using lemma  [ lem : simplicialstruc ] below to reduce the problem of finding a simplicial factorization to finding a point inside a semi - algebraic set with @xmath53 constraints and @xmath54 real - valued variables ( or deciding that this set is empty ) .",
    "the decision problem can be solved using the well - known algorithm of basu et .",
    "al.@xcite solves this problem in @xmath55 time .",
    "we can instead use the algorithm of renegar @xcite ( a bound of @xmath56 on the bit complexity of the coefficients in the solution due to grigorev and vorobjov @xcite ) to compute a rational approximation to the solution up to accuracy @xmath51 in time @xmath52 .",
    "this reduction uses the fact that since @xmath57 have full rank they have `` pseudo - inverses '' @xmath58 , @xmath59 which are @xmath60 and @xmath61 matrices respectively such that @xmath62 .",
    "thus @xmath63 and similarly @xmath64 .",
    "let @xmath65 be a basis for the columns of @xmath1 in @xmath66 , and let @xmath67 be a basis for the rows of @xmath1 in @xmath68 .",
    "then @xmath69 ( a size @xmath7 matrix ) denotes the columns of @xmath1 expressed in the basis @xmath70 , and similarly @xmath71 ( a size @xmath6 matrix ) denotes the rows of @xmath1 expressed in the basis @xmath72 .",
    "[ lem : simplicialstruc ] @xmath1 has a simplicial factorization rank @xmath11 iff for every basis @xmath73 for the columns and basis @xmath74 for the rows of @xmath1 , there are @xmath75 matrices @xmath76 such that : ( i ) @xmath77 and @xmath78 are nonnegative matrices",
    "( ii ) @xmath79    ( `` if '' ) suppose the conditions in the theorem are met",
    ". then set @xmath80 and @xmath81 .",
    "these matrices are nonnegative and have size @xmath6 and @xmath7 respectively , and furthermore are a factorization for @xmath1",
    ". since @xmath82 , @xmath4 and @xmath5 are a simplicial factorization .",
    "( `` only if '' ) conversely suppose that there is a simplicial factorization @xmath28 .",
    "let @xmath83 and @xmath84 be _ arbitrary _ bases for the columns and rows of @xmath1 respectively .",
    "let @xmath46 and @xmath47 be the corresponding @xmath6 and @xmath85 matrices .",
    "let @xmath69 and @xmath86 be @xmath7 and @xmath6 representations in this basis for the columns and rows of @xmath1 - i.e. @xmath87 and @xmath88 .",
    "define @xmath89 matrices @xmath90 and @xmath91 where @xmath58 and @xmath59 are the respective pseudoinverses of @xmath57 .",
    "let us check that this choice of @xmath92 and @xmath93 satisfies the conditions in the theorem .",
    "we can re - write @xmath94 and hence the first condition in the theorem is satisfied . similarly @xmath95 and hence the second and third condition are also satisfied .",
    "@xmath82 , our structure theorem becomes much more complex  both to state and to prove . in what follows",
    ", we will not make any assumptions about @xmath1 and will give a structure theorem and corresponding polynomial time algorithm ( for constant @xmath11 ) for the full nonnegative matrix factorization problem .",
    "now we consider the nmf problem where the factor matrices @xmath57 need not have full rank .    there is a @xmath96 time deterministic algorithm that given an @xmath0 nonnegative matrix @xmath1 outputs a factorization @xmath8 of inner dimension @xmath11 if such a factorization exists .    as in the simplicial case",
    "the main idea will again be a reduction to an existence question for a semi - algebraic set , but this reduction is significantly more complicated than lemma  [ lem : simplicialstruc ] .      our goal is to re - cast nonnegative matrix factorization ( for constant @xmath11 ) as a system of polynomial inequalities where the number of variables is constant , the maximum degree is constant and the number of constraints is polynomially bounded in @xmath15 and @xmath16 .",
    "the main obstacle is that @xmath4 and @xmath5 are _ large _ - we can not afford to introduce a new variable to represent each entry in these matrices .",
    "we will demonstrate there is always a `` minimal '' choice for @xmath4 and @xmath5 so that :    1 .",
    "there is a collection of linear transformations @xmath97 from the column - span of @xmath1 to @xmath98 and a choice function @xmath99 \\rightarrow [ g(r)]$ ] 2 .",
    "and a collection of linear transformations @xmath100 from the row - span of @xmath1 to @xmath98 and a choice function @xmath101 \\rightarrow [ g(r)]$ ]    and these linear transformations and choice functions satisfy the conditions :    1 .   for each @xmath102 $ ] , @xmath103 and 2 .   for each @xmath104 $ ] , @xmath105 .",
    "furthermore , the number of possible choice functions @xmath106 is at most @xmath107 and the number of possible choice functions for @xmath108 is at most @xmath109 .",
    "these choice functions are based on the notion of a simplicial partition , which we introduce later .",
    "we then give an algorithm for enumerating all simplicial partitions ( this is the primary bottleneck in the algorithm ) .",
    "fixing the choice functions @xmath106 and @xmath108 , the question of finding linear transformations @xmath97 and @xmath100 that satisfy the above constraints ( and the constraint that @xmath28 , and @xmath4 and @xmath5 are nonnegative ) is exactly a system of polynomial inequalities with a @xmath110 variables ( each matrix @xmath111 or @xmath112 is @xmath75 ) , degree at most four and furthermore there are at most @xmath113 polynomial constraints .    in this subsection , we will give a procedure ( which given @xmath4 and @xmath5 ) generates a `` minimal '' choice for @xmath4 and @xmath5 ( call this minimal choice @xmath31 and @xmath32 ) , and we will later establish that this `` minimal '' choice satisfies the structural property stated informally above .",
    "let @xmath114}$ ] denote the subsets of @xmath115 $ ] corresponding to maximal independent sets of columns ( of @xmath4 ) .",
    "similarly let @xmath116}$ ] denote the subsets of @xmath115 $ ] corresponding to maximal independent sets of rows ( of @xmath5 ) .",
    "a basic fact from linear algebra is that all maximal independent sets of columns of @xmath4 have exactly @xmath117 elements and all maximal independent sets of rows of @xmath5 similarly have exactly @xmath118 elements .",
    "let @xmath119 be the total ordering on subsets of @xmath115 $ ] of size @xmath120 so that if @xmath46 and @xmath47 are both subsets of @xmath115 $ ] of size @xmath120 , @xmath121 iff @xmath46 is lexicographically before @xmath47 .    given a column @xmath34 , we will call a subset @xmath122 a minimal basis for @xmath34 ( with respect to @xmath4 ) if @xmath123 and for all @xmath124 such that @xmath125 we must have @xmath121 .    [ claim : basis ] if @xmath126 , then there is some @xmath122 such that @xmath123 .    a proper chain @xmath127 is a set of nonnegative matrices for which @xmath28 , @xmath128 and @xmath129 ( the inner dimension of these factorizations is @xmath11 ) and functions @xmath130 \\rightarrow { { \\mathcal{c}}}(a)$ ] and @xmath131 \\rightarrow { \\mathcal{r}}(w')$ ]",
    "such that    1 .   for all @xmath132 $ ] , @xmath133 , @xmath134 and @xmath135 is a minimal basis with respect to @xmath4 for @xmath34 2 .   for all @xmath136 $ ] ,",
    "@xmath137 , @xmath138 and @xmath139 is a minimal basis with respect to @xmath32 for @xmath35 .",
    "note that the extra conditions on @xmath32 ( i.e. the minimal basis constraint ) is with respect to @xmath4 and the extra conditions on @xmath31 are with respect to @xmath32 .",
    "this simplifies the proof that there is always some proper chain , since we can compute a @xmath32 that satisfies the above conditions with respect to @xmath4 and then find an @xmath31 that satisfies the conditions with respect to @xmath32 .",
    "[ lemma : chain ] if there is a nonnegative factorization @xmath28 ( of inner - dimension @xmath11 ) , then there is a choice of nonnegative @xmath140 of inner - dimension @xmath11 and functions @xmath130 \\rightarrow { { \\mathcal{c}}}(a)$ ] and @xmath131 \\rightarrow { \\mathcal{r}}(w')$ ]",
    "such that @xmath127 and @xmath141 , @xmath142 form a proper chain .",
    "the condition that there is some nonnegative @xmath5 for which @xmath28 is just the condition that for all @xmath132 $ ] , @xmath126 .",
    "hence , for each vector @xmath34 , we can choose a minimal basis @xmath122 using claim  [ claim : basis ] .",
    "then @xmath123 so there is some nonnegative vector @xmath143 supported on @xmath46 such @xmath133 and we can set @xmath144 . repeating this procedure for each column @xmath34 , results in a nonnegative matrix @xmath32 that satisfies the condition @xmath145 and for each @xmath132 $ ] , by design @xmath134 and",
    "@xmath135 is a minimal basis with respect to @xmath4 for @xmath34 .",
    "we can re - use this argument above , setting @xmath146 and this interchanges the role of @xmath4 and @xmath5 . hence we obtain a nonnegative matrix @xmath31 which satisfies @xmath147 and for each @xmath136 $ ] , again by design we have that @xmath138 and @xmath139 is a minimal basis with respect to @xmath5 for @xmath35 .",
    "let @xmath148 ( for @xmath122 ) denote the @xmath60 linear transformation that is zero on all rows not in @xmath46 ( i.e. @xmath149 for @xmath150 ) and restricted to @xmath46 is @xmath151 ( where the @xmath152 operation denotes the moore - penrose pseudoinverse ) .",
    "[ lemma : reconstr ] let @xmath127 and @xmath141 and @xmath142 form a proper chain .",
    "for any index @xmath132 $ ] , let @xmath153 and for any index @xmath136 $ ] let @xmath154 . then @xmath155 and @xmath156 .",
    "notice that in the above lemma , the linear transformation that recovers the columns of @xmath32 is based on column subsets of @xmath4 , while the linear transformation to recover the rows of @xmath31 is based on the row subsets of @xmath32 ( not @xmath5 ) .    since @xmath127 and @xmath141 and @xmath142 form a proper chain we have that @xmath157 .",
    "also @xmath158 .",
    "consider the quantity @xmath159 . for any @xmath160 , @xmath161 .",
    "so consider @xmath162 where the last equality follows from the condition @xmath163 .",
    "since @xmath164 we have that @xmath165 is the @xmath166 identity matrix .",
    "hence @xmath155 . an identical argument with @xmath32",
    "replaced with @xmath31 and with @xmath4 replaced by @xmath167 ( and @xmath168 and @xmath169 replaced with @xmath170 and @xmath171 ) respectively implies that @xmath156 too .",
    "note that there are at most @xmath172 linear trasformations of the form @xmath173 and hence the columns of @xmath32 can be recovered by a constant number of linear transformations of the column span of @xmath1 , and similarly the rows of @xmath31 can also be recovered .",
    "the remaining technical issue is we need to demonstrate that there are not too many ( only polynomially many , for constant @xmath11 ) choice functions @xmath141 and @xmath142 and that we can enumerate over this set efficiently . in principle , even if say @xmath174 is just two sets , there are exponentially many choices of which ( of the two ) linear transformation to use for each column of @xmath1 .",
    "however , when we use lexicographic ordering to tie break ( as in the definition of a minimal basis ) , the number of choice functions is polynomially bounded .",
    "we will demonstrate that the choice function @xmath130 \\rightarrow { { \\mathcal{c}}}(a)$ ] arising in the definition of a proper chain can be embedded in a restricted type of geometric partitioning of @xmath1 which we call a simplicial partition .      here",
    ", we establish that the choice functions @xmath141 and @xmath142 in a proper chain are combinatorially simple .",
    "the choice function @xmath141 can be regarded as a partition of the columns of @xmath1 into @xmath175 sets , and similarly the choice function @xmath142 is a partition of the rows of @xmath1 into @xmath176 sets . here",
    "we define a geometric type of partitioning scheme which we call a simplicial partition , which has the property that there are not too many simplicial partitions ( by virtue of this class having small vc - dimension ) , and we show that the partition functions @xmath141 and @xmath142 arising in the definition of a proper chain are realizable as ( small ) simplicial partitions .",
    "a @xmath177-simplicial partition of the columns of @xmath1 is generated by a collection of @xmath178 sets of @xmath120 hyperplanes @xmath179 let @xmath180 , h_j^{i } \\cdot m_{i ' } \\geq 0 \\}$ ] . then this collection of sets of hyperplanes results in the partition    * @xmath181 * @xmath182 * @xmath183 * @xmath184 - p_1 - p_2 ... -p_k$ ]    if @xmath185 , we will be interested in a @xmath186-simplicial partition .",
    "[ lemma : geom ] let @xmath127 and @xmath141 and @xmath142 form a proper chain .",
    "then the partitions corresponding to @xmath141 and to @xmath142 ( of columns and rows of @xmath1 respectively ) are a @xmath186-simplicial partition and a @xmath187-simplicial partition respectively , where @xmath185 and @xmath188 .",
    "order the sets in @xmath174 according to the lexicographic ordering @xmath119 , so that @xmath189 for @xmath190 .",
    "then for each @xmath170 , let @xmath191 be the rows of the matrix @xmath192 . note that there are exactly @xmath185 rows ,",
    "hence this defines a @xmath177-simplicial partition .",
    "@xmath193 if and only if @xmath194 in the @xmath177-simplicial partition generated by @xmath195 .    since @xmath127 and @xmath141 and @xmath142 forms a proper chain , we have that @xmath128 .",
    "consider a column @xmath168 and the corresponding set @xmath196 . recall that @xmath171 is the @xmath20 set in @xmath174 according to the lexicographic ordering @xmath119 .",
    "also from the definition of a proper chain @xmath197 is a minimal basis for @xmath34 with respect to @xmath4 .",
    "consider any set @xmath198 with @xmath199 .",
    "then from the definition of a minimal basis we must have that @xmath200 . since @xmath198 , we have that the transformation @xmath201 is a projection onto @xmath202 which contains @xmath203",
    ". hence @xmath204 , but @xmath200 so @xmath205 can not be a nonnegative vector . hence @xmath34 is not in @xmath206 for any @xmath199 .",
    "furthermore , @xmath34 is in @xmath207 : using lemma  [ lemma : reconstr ] we have @xmath208 and so @xmath209 .",
    "we can repeat the above replacing @xmath4 with @xmath167 and @xmath32 with @xmath31 , and this implies the lemma .      here",
    "we give an algorithm for enumerating all @xmath177-simplicial partitions ( of , say , the columns of @xmath1 ) that runs in time @xmath210 .",
    "an important observation is that the problem of enumerating all simplicial partitions can be reduced to enumerating all partitions that arise from a single hyperplane .",
    "indeed , we can over - specify a simplicial partition by specifying the partition ( of the columns of @xmath1 ) that results from each hyperplane in the set of @xmath211 total hyperplanes that generates the simplicial partition . from this set of partitions",
    ", we can recover exactly the simplicial partition .",
    "a number of results are known in this domain , but surprisingly we are not aware of any algorithm that enumerates all partitions of the columns of @xmath1 ( by a single hyperplane ) that runs in polynomial time ( for @xmath212 and @xmath11 is constant ) without some assumption on @xmath1 .",
    "for example , the vc - dimension of a hyperplane in @xmath11 dimensions is @xmath213 and hence the sauer - shelah lemma implies that there are at most @xmath214 distinct partitions of the columns of @xmath1 by a hyperplane .",
    "in fact , a classic result of harding ( 1967 ) gives a tight upper bound of @xmath215 .",
    "yet these bounds do not yield an algorithm for efficiently enumerating this structured set of partitions without checking _ all _ partitions of the data .",
    "a recent result of hwang and rothblum @xcite comes close to our intended application .",
    "a separable partition into @xmath216 parts is a partition of the columns of @xmath1 into @xmath216 sets so that the convex hulls of these sets are disjoint .",
    "setting @xmath217 , the number of separable partitions is exactly the number of distinct hyperplane partitions . under the condition that @xmath1 is in general position ( i.e. there are no @xmath218 columns of @xmath1 lying on a dimension @xmath219 subspace where @xmath220 ) , hwang and rothblum give an algorithm for efficiently enumerating all distinct hyperplane partitions @xcite .",
    "here we give an improvement on this line of work , by removing any conditions on @xmath1 ( although our algorithm will be slightly slower ) .",
    "the idea is to encode each hyperplane partition by a choice of not too many data points . to do this",
    ", we will define a slight generalization of a hyperplane partition that we will call a hyperplane separation :    a hyperplane @xmath221 defines a mapping ( which we call a hyperplane separation ) from columns of @xmath1 to @xmath222 depending on the sign of @xmath223 ( where the sign function is @xmath224 for positive values , @xmath225 for negative values and @xmath226 for zero ) .",
    "a hyperplane partition can be regarded as a mapping from columns of @xmath1 to @xmath227 where we adopt the convention that @xmath34 such that @xmath228 is mapped to @xmath224 .",
    "a hyperplane partition ( defined by @xmath221 ) is an extension of a hyperplane separation ( defined by @xmath229 ) if for all @xmath168 , @xmath230 .",
    "[ lemma : extension ] let @xmath231 , then for any hyperplane partition ( defined by @xmath221 ) , there is a hyperplane @xmath229 that contains @xmath120 affinely independent columns of @xmath1 and for which @xmath221 ( as a partition ) is an extension of @xmath229 ( as a separation ) .",
    "after an appropriate linear transformation ( of the columns of @xmath1 and the hyperplanes ) , we can assume that @xmath1 is full rank .",
    "if the @xmath221 already contains @xmath120 affinely independent columns of @xmath1 , then we can choose @xmath232 .",
    "if not we can perturb @xmath221 in some direction so that for any column with @xmath233 , we maintain the invariant that @xmath34 is contained on the perturbed hyperplane @xmath234 .",
    "since @xmath231 this perturbation has non - zero inner product with some column in @xmath1 and so this hyperplane @xmath234 will eventually contain a new column from @xmath1 ( without changing the sign of @xmath235 for any other column ) .",
    "we can continue this argument until the hyperplane contains @xmath120 affinely independent columns of @xmath1 and by design on all remaining columns agrees in sign with @xmath221 .",
    "[ lemma : char ] let @xmath231 .",
    "for any hyperplane @xmath221 ( which defines a partition ) , there is a collection of @xmath236 sets of ( at most @xmath237 ) columns of @xmath1 , @xmath238 so that any hyperplanes @xmath239 which contain @xmath240 respectively satisfy : for all @xmath168 , @xmath235 ( as a partition ) is equal to the value of @xmath241 , where @xmath170 is the smallest index for which @xmath242 .",
    "furthermore these subsets are nested : @xmath243 .",
    "we can apply lemma  [ lemma : extension ] repeatedly .",
    "when we initially apply the lemma , we obtain a hyperplane @xmath244 that can be extended ( as a separation ) to the partition corresponding to @xmath221 . in the above function ( defined implicitly in the lemma )",
    "this fixes the partition of the columns except those contained in @xmath244 .",
    "so we can then choose @xmath245 to be the columns of @xmath1 that are contained in @xmath244 , and recurse . if @xmath246 is the largest set of columns output from the recursive call , we can add columns of @xmath1 contained in @xmath244 to this set until we obtain a set of @xmath247 affinely independent columns contained in @xmath244 , and we can output this set ( as @xmath248 ) .",
    "[ thm : enumerate ] let @xmath249 .",
    "there is an algorithm that runs in time @xmath250 time to enumerate all hyperplane partitions of the columns of @xmath1 .",
    "we can apply lemma  [ lemma : char ] and instead enumerate the sets of points @xmath251 .",
    "since these sets are nested , we can enumerate all choices as follows :    * choose at most @xmath120 columns corresponding to the set @xmath248 * initialize an active set @xmath252 * until @xmath253 is empty either * * choose a column to be removed from the active set * * or indicate that the current active set represents the next set @xmath254 and choose the sign of the corresponding hyperplane    there are at most @xmath250 such choices , and for each choice we can then run a linear program to determine if there is a corresponding hyperplane partition .",
    "( in fact , all partitions that result from the above procedure will indeed correspond to a hyperplane partition ) .",
    "the correctness of this algorithm follows from lemma  [ lemma : char ] .",
    "this immediately implies :    there is an algorithm that runs in time @xmath255 that enumerates a set of partitions of the columns of @xmath1 that contains the set of all @xmath177-simplicial partitions ( of the columns of @xmath1 ) .",
    "the results of basu et al @xcite give an algorithm for finding a point in a semi - algebraic set defined by @xmath113 constraints on polynomials of total degree at most @xmath256 , and @xmath257 variables in time @xmath258 .",
    "using our structure theorem for nonnegative matrix factorization , we will re - cast the decision problem of whether a nonnegative matrix @xmath1 has nonnegative rank @xmath11 as an existence question for a semi - algebraic set .",
    "there is an algorithm for deciding if a @xmath0 nonnegative matrix @xmath1 has nonnegative rank @xmath11 that runs in time @xmath259 .",
    "furthermore , we can compute a rational approximation to the solution up to accuracy @xmath51 in time @xmath260 .",
    "we first prove the first part of this theorem using the algorithm of basu et al @xcite , and we instead use the algorithm of renegar @xcite to compute a rational approximation to the solution up to accuracy @xmath51 in time @xmath260 .",
    "suppose there is such a factorization .",
    "using lemma  [ lemma : chain ] , there is also a proper chain .",
    "we can apply lemma  [ lemma : geom ] and using the algorithm in theorem  [ thm : enumerate ] we can enumerate over a superset of simplicial partitions .",
    "hence , at least one of those partitions will result in the choice functions @xmath141 and @xmath142 in the proper chain decomposition for @xmath28 .",
    "using lemma  [ lemma : reconstr ] there is a set of at most @xmath261 linear transformations @xmath262 which recover columns of @xmath32 given columns of @xmath1 , and similarly there is a set of at most @xmath261 linear transformations @xmath263 which recover the rows of @xmath31 given rows of @xmath1 .",
    "note that these linear transformations are from the column - span and row - span of @xmath1 respectively , and hence are from subspaces of dimension at most @xmath11 .",
    "so apply a linear transformation to columns of @xmath1 and one to rows of @xmath1 to to recover matrices @xmath69 and @xmath86 respectively ( which are no longer necessarily nonnegative ) but which are dimension @xmath7 and @xmath6 respectively .",
    "there will still be a collection of at most @xmath261 linear transformations from columns of @xmath69 to columns of @xmath32 , and similarly for @xmath86 and @xmath31 .",
    "we will choose @xmath264 variables for each linear transformation , so there are @xmath265 variables in total .",
    "then we can write a set of @xmath16 linear constraints to enforce that for each column of @xmath266 , the transformation corresponding to @xmath135 recovers a nonnegative vector .",
    "similarly we can define a set of @xmath15 constraints based on rows in @xmath86 .",
    "lastly we can define a set of constraints that enforce that we do recover a factorization for @xmath1 : for all @xmath132 , j \\in [ n]$ ] , let @xmath267 and @xmath268 .",
    "then we write the constraint @xmath269 .",
    "this constraint has degree at two in the variables corresponding to the linear transformations .",
    "lemma  [ lemma : chain ] implies that there is some choice of these transformations that will satisfy these constraints ( when we formulate these constraints using the correct choice functions in the proper chain decomposition ) .",
    "furthermore , any set of transformations that satisfies these constraints does define a nonnegative matrix factorization of inner dimension @xmath11 for @xmath1 .    and of course , if there is no inner dimension @xmath11 nonnegative factorization , then all calls to the algorithm of basu et al @xcite will fail and we can return that there is no such factorization .",
    "the result in basu et .",
    "@xcite is a quantifier elimination algorithm in the blum , shub and smale ( bss ) model of computation  @xcite .",
    "the bss model is a model for real number computation and it is natural to ask what is the bit complexity of finding a rational approximation of the solutions .",
    "there has been a long line of research on the decision problem for first order theory of reals : given a quantified predicate over polynomial inequalities of reals , determine whether it is true or false .",
    "what we need for our algorithm is actually a special case of this problem : given a set of polynomial inequalities over real variables , determine whether there exists a set of values for the variables so that all polynomial inequalities are satisfied . in particular , all variables in our problem are quantified by existential quantifier and there are no alternations . for this kind of problem grigorev and vorobjov @xcite first gave a singly - exponential time algorithm that runs in @xmath270 where @xmath15 is the number of polynomial inequalities , @xmath256 is the maximum degree of the polynomials and @xmath257 is the number of variables .",
    "the bit complexity of the algorithm is @xmath271 where @xmath49 is the maximum length of the coefficients in the input .",
    "moreover , their algorithm also gives an upperbound of @xmath272 on the number of bits required to represent the solutions .",
    "renegar@xcite gave a better algorithm that for the special case we are interested in takes time @xmath273 .",
    "using his algorithm with binary search ( with search range bounded by grigorev et.al.@xcite ) , we can find rational approximations to the solutions with accuracy up to @xmath51 in time @xmath274 .",
    "we note that our results on the sf problem are actually a special case of the theorem above ( because our structural lemma for simplicial factorization is a special case of our general structure theorem ) :    there is an algorithm for determining whether the positive rank of a nonnegative @xmath0 matrix @xmath1 equals the rank and this algorithm runs in time @xmath275 .    if @xmath82 , then we know that both @xmath4 and @xmath5 must be full rank . hence @xmath174 and @xmath276 are both just the set @xmath277 .",
    "hence we can circumvent the simplicial partition machinery , and set up a system of polynomial constraints in at most @xmath278 variables .",
    "[ sec : hardness ]    here we give evidence that finding a simplicial factorization of dimension @xmath11 probably can not be solved in @xmath13 time , unless @xmath14-sat can be solved in @xmath26 time ( in other words , if the exponential time hypothesis of  @xcite is true ) .",
    "surprisingly , even the @xmath17-hardness of the problem for general @xmath11 was only proved quite recently by vavasis  @xcite .",
    "that reduction is the inspiration for our result , though unfortunately we were unable to use it directly to get low - dimensional instances .",
    "instead we give a new reduction using the @xmath256-sum problem .    in the @xmath256-sum problem",
    "we are given a set of @xmath279 values @xmath280 each in the range @xmath281 $ ] , and the goal is to determine if there is a set of @xmath256 numbers ( not necessarily distinct ) that sum to exactly @xmath282 .",
    "this definition for the @xmath256-sum problem is slightly unconventional in that here we allow repetition ( i.e. the choice of @xmath256 numbers need not be distinct ) .",
    "patrascu and williams @xcite recently proved that if @xmath256-sum can be solved in @xmath283 time then @xmath14-sat has a sub - exponential time algorithm .",
    "in fact , in the instances constructed in @xcite we can allow repetition of numbers without affecting the reduction since in these instances choosing any number more than once will never result in a sum that is exactly @xmath282 .",
    "hence we can re - state the results in @xcite for our ( slightly unconventional definition for ) @xmath256-sum .    if @xmath284 and if @xmath256-sum instances of @xmath279 distinct numbers each of @xmath285 bits can be solved in @xmath283 time then @xmath14-sat on @xmath15 variables can be solved in time @xmath26 .",
    "given an instance of the @xmath256-sum , we will reduce to an instance of the intermediate simplex problem defined in @xcite .",
    "given a polyhedron @xmath286 where @xmath287 is an @xmath288 size matrix and @xmath289 such that the matrix @xmath290 $ ] has rank @xmath11 and a set @xmath291 of @xmath16 points in @xmath292 , the goal of the intermediate simplex problem is to find a set of points @xmath253 that form a simplex ( i.e. @xmath253 is a set of @xmath11 affinely independent points ) each in @xmath293 such that the convex hull of @xmath253 contains the points in @xmath291 .",
    "vavasis  @xcite proved that intermediate simplex is equivalent to the simplicial factorization problem .",
    "there is a polynomial time reduction from intermediate simplex problem to simplicial factorization problem and vice versa and furthermore both reductions preserve the value of @xmath11 .",
    "interestingly , an immediate consequence of this theorem is that simplicial factorization is easy in the case in which @xmath294 because mapping these instances to instances of intermediate simplex results in a one dimensional problem - i.e. the polyhedron @xmath293 is an interval .      given the universe @xmath295 for the @xmath256-sum problem , we construct a two dimensional intermediate simplex instance as shown in figure  [ fig : gadget ] .",
    "we will show that the intermediate simplex instance has exactly @xmath279 solutions , each representing a choice of @xmath296 .",
    "later in the reduction we use @xmath256 such gadgets to represent the choice of @xmath256 numbers in the set @xmath46 .",
    "+    recall for a two dimensional intermediate simplex problem , the input consists of a polygon @xmath297 ( which is the hexagon @xmath298 in figure  [ fig : gadget ] ) and a set of points @xmath299 inside @xmath297 ( which are the dots , except for @xmath1 ) .",
    "a solution to this two dimensional intermediate simplex instance will be a triangle inside @xmath297 such that all the points in @xmath291 are contained in the triangle ( in figure  [ fig : gadget ] @xmath300 is a valid solution ) .",
    "we first specify the polygon @xmath297 for the intermediate simplex instance .",
    "the polygon @xmath297 is just the hexagon @xmath298 inscribed in a circle with center @xmath1 .",
    "all angles in the hexagon are @xmath301 , the edges @xmath302 where @xmath30 is a small constant depending on @xmath279 , @xmath256 that we determine later .",
    "the other 3 edges also have equal lengths @xmath303 .",
    "we use @xmath304 and @xmath305 to denote the @xmath306 and @xmath307 coordinates for the point @xmath4 ( and similarly for all other points in the gadget ) .",
    "the hexagon is placed so that @xmath308 , @xmath309",
    ". now we specify the set @xmath291 of @xmath310 points for the intermediate simplex instance . to get these points first take @xmath279 points in each of the 3 segements @xmath311 , @xmath312 , @xmath313 . on @xmath311",
    "these @xmath279 points are called @xmath314 , @xmath315 , ... , @xmath316 , and @xmath317 .",
    "similarly we have points @xmath318 s on @xmath312 and @xmath319 s on @xmath313 , @xmath320 .",
    "now we have @xmath279 triangles @xmath321 ( the thin lines in figure  [ fig : gadget ] ) .",
    "we claim ( see lemma  [ lem : gadgetpoint ] below ) that the intersection of these triangles is a polygon with @xmath310 vertices .",
    "the points in @xmath291 are just the vertices of this intersection .",
    "[ lem : gadgetpoint ] when @xmath322 , the points @xmath323 , @xmath324 , @xmath325 are on @xmath311 , @xmath312 , @xmath313 respectively and @xmath326 , the intersection of the @xmath279 triangles @xmath327 is a polygon with @xmath310 vertices .    since the intersection of @xmath279 triangles @xmath321 is the intersection of @xmath310 halfplanes , it has at most @xmath310 vertices",
    ". therefore we only need to prove every edge in the triangles has a segment remaining in the intersection .",
    "notice that the gadget is symmetric with respect to rotations of @xmath301 around the center @xmath1 . by symmetry",
    "we only need to look at edges @xmath328 .",
    "the situation here is illustrated in figure  [ fig : gadgetproof ] .",
    "since all the halfplanes that come from triangles @xmath321 contain the center @xmath1 , later when talking about halfplanes we will only specify the boundary line .",
    "for example , the halfplane with boundary @xmath328 and contains @xmath319 ( as well as @xmath1 ) is called halfplane @xmath328 .",
    ", title=\"fig:\",width=384 ] +    the two thick lines in figure  [ fig : gadgetproof ] are extensions of @xmath311 and @xmath312 , now they are rotated so that they are @xmath329 .",
    "the two thin lines are two possible lines @xmath328 and @xmath330 .",
    "the differences between @xmath306 coordinates of @xmath39 and @xmath318 are the same for all @xmath168 ( here normalized to 1 ) by the construction of the points @xmath39 s and @xmath318 s .",
    "assume the coordinates for @xmath39 , @xmath331 are @xmath332 and @xmath333 respectively .",
    "then the coordinates for the intersection is @xmath334 .",
    "this means if we have @xmath279 segments with @xmath335 , segment @xmath168 will be the highest one when @xmath306 is in range @xmath336 ( indeed , the lines with @xmath337 have higher slope and will win when @xmath338 ; the lines with @xmath339 have lower slope and will win when @xmath340 ) .",
    "we also want to make sure that all these intersection points are inside the halfplanes @xmath341 s and @xmath342 s .",
    "since @xmath322 , all the @xmath343 s are within @xmath344 $ ] .",
    "hence the intersection point is always close to the point @xmath345 , the distance is at most @xmath346 . at the same time , since @xmath30 is small , the distances of this point @xmath345 to all the @xmath341 s and @xmath342 s are all larger than @xmath347 .",
    "therefore all the intersection points are inside the other @xmath348 halfplanes and the segments will indeed remain in the intersection .",
    "the intersection has @xmath310 edges and @xmath310 vertices .",
    "the intermediate simplex instance has @xmath279 obvious solutions : the triangles @xmath321 , each one corresponds to a value @xmath296 for the @xmath256-sum problem . in the following lemma",
    "we show that these are the only possible solutions .",
    "[ lem : gadget ] when @xmath349 , if the solution of the intermediate simplex problem is @xmath350 , then @xmath350 must be one of the @xmath321 s .",
    "suppose @xmath350 is a solution of the intermediate simplex problem , since @xmath1 is in the convex hull of @xmath351 , it must be in @xmath350 .",
    "thus one of the angles @xmath352 , @xmath353 , @xmath354 must be at least @xmath301 ( their sum is @xmath355 ) . without loss of generality",
    "we assume this angle is @xmath352 and by symmetry assume @xmath293 is either on @xmath311 or @xmath356 .",
    "we shall show in either of the two cases , when @xmath293 is not one of the @xmath39 s , there will be some @xmath357 that is not in the halfplane @xmath358 ( recall the halfplanes we are interested in always contain @xmath1 so we do nt specify the direction ) .",
    "when @xmath293 is on @xmath311 , since @xmath359 , we have @xmath360 ( by symmetry when @xmath361 the angle is exactly @xmath301 ) .",
    "this means we can move @xmath362 to @xmath363 such that @xmath364 .",
    "the intersection of halfplane @xmath365 and the hexagon @xmath298 is at least as large as the intersection of halfplane @xmath358 and the hexagon .",
    "however , if @xmath293 is not any of the points @xmath323 ( that is , @xmath366 ) , then @xmath365 can be viewed as @xmath367 if we add @xmath368 to the set @xmath46 . by lemma  [ lem : gadgetpoint ]",
    "introducing @xmath365 must increase the number of vertices .",
    "one of the original vertices @xmath357 is not in the hyperplane @xmath365 , and hence not in @xmath350 .",
    "therefore when @xmath293 is on @xmath311 it must coincide with one of the @xmath39 s , by symmetry @xmath350 must be one of @xmath321 s",
    ".    when @xmath293 is on @xmath356 , there are two cases as shown in figure  [ fig : gadgetproof2 ] .",
    ", title=\"fig:\",height=288 ] +    first observe that if we take @xmath369 , and generate the set @xmath370 according to @xmath371 , then the gadget is further symmetric with respect to flipping along the perpendicular bisector of @xmath356 .",
    "now without loss of generality @xmath372 .",
    "since every @xmath357 is now in the intersection of @xmath348 triangles , in particular they are also in the intersection of the original @xmath279 triangles , it suffices to show one of @xmath357 ( @xmath373 $ ] ) is outside halfplane @xmath358 .",
    "the first case ( left part of figure  [ fig : gadgetproof2 ] ) is when @xmath374 . in this case",
    "we extend @xmath358 to get intersection on @xmath311 ( @xmath375 ) and intersection on @xmath312 ( @xmath363 ) . again since @xmath359 ,",
    "we have @xmath376 . at the same time we know @xmath377 , so @xmath378 .",
    "similar to the previous case , we take @xmath379 so that @xmath380 .",
    "the intersection of hyperplane @xmath381 and the hexagon @xmath298 is at least as large as the intersection of halfplane @xmath358 and the hexagon .",
    "when @xmath349 , we can check @xmath382 , therefore we can still view @xmath381 as some @xmath383 for @xmath384 .",
    "now lemma  [ lem : gadgetpoint ] shows there is some vertex @xmath357 not in halfplane @xmath381 ( and hence not in halfplane @xmath358 ) .",
    "the final case ( right part of figure  [ fig : gadgetproof2 ] ) is when @xmath385 . in this case",
    "we notice the triangle with 3 edges @xmath386 , @xmath387 , @xmath388 ( the shaded triangle in the figure ) is contained in every @xmath321 , thus it must also be in @xmath350 .",
    "however , since @xmath389 , we know @xmath390 and @xmath391 . in this case",
    "@xmath350 does not even contain the center @xmath1 .",
    "suppose we are given an instance of the @xmath256-sum problem with @xmath279 values @xmath280",
    ". we will give a reduction to an instance of intermediate simplex in dimension @xmath392 .    to encode the choice of @xmath256 numbers in the set @xmath393",
    ", we use @xmath256 gadgets defined in section  [ sec : gad ] .",
    "the final solution of the intermediate simplex instance we constructed will include solutions to each gadget . as the solution of a gadget always corresponds to a number in @xmath394 ( lemma  [ lem : gadget ] ) we can decode the solution and get @xmath256 numbers , and we use an extra dimension @xmath395 that `` computes '' the sum of these numbers and ensures the sum is equal to @xmath282 .",
    "we use three variables @xmath396 for the @xmath19 gadget .",
    "we will use @xmath397 variables : sets @xmath398 for @xmath399 $ ] and @xmath395 .    for all @xmath399 $ ] , @xmath400 $ ] , @xmath401 $ ] and also @xmath402 $ ] .",
    "let @xmath403 be the hexagon abcdef in the two - dimensional gadget given in the section  [ sec : gad ] .",
    "let @xmath404 be the set @xmath405 .",
    "@xmath287 is a tilted - cone that has a hexagonal base @xmath406 and has an apex at the origin .",
    "let @xmath407 be a @xmath408 matrix and @xmath409 so that @xmath410 .",
    "we will use these gadgets to define ( some of the ) constraints on the polyhedron @xmath293 in an instance of intermediate simplex :    for each @xmath399 $ ] , @xmath411 .    hence when restricted to dimensions @xmath412 , @xmath343 , @xmath413 the @xmath19 gadget @xmath406 is on the plane @xmath414 .",
    "we hope that in a gadget , if we choose three points corresponding to the triangle for some value @xmath296 , that of these three points only the point on the @xmath311 line will have a non - zero value for @xmath395 and that this value will be @xmath296 .",
    "the points on the lines @xmath312 or @xmath313 will hopefully have a value close to zero .",
    "we add constraints to enforce these conditions :    for all @xmath399 $ ] , @xmath415    these constraints make sure that points on @xmath312 or @xmath313 can not have large @xmath395 value",
    ".    recall that we use @xmath305 to denote the @xmath307 coordinate of @xmath4 in the gadget in section  [ sec : gad ] .    for all @xmath399 $ ] : @xmath416 $ ]    theses constraints",
    "make sure that points on @xmath311 have values in @xmath393 .",
    "the @xmath311 and @xmath417 constraints all have the property that when @xmath418 ( i.e. the corresponding point is off of the gadget on the plane @xmath414 ) then these constraints gradually become relaxed .    to make sure the gadget still works",
    ", we do nt want the extra constraints on @xmath395 to rule out some possible values for @xmath412 , @xmath343 , @xmath413 s .",
    "indeed we show the following claim .    for all points in @xmath419 ,",
    "there is some choice of @xmath402 $ ] so that @xmath420 and @xmath395 satisfy the @xmath417 and @xmath311 constraints .",
    "the proof is by observing that constraints @xmath311 have almost no effect when @xmath421 and constraints @xmath417 have no effect when @xmath422 .",
    "constraints 1 to 4 define a polyhedron @xmath293 in @xmath397-dimensional space and furthermore the set of constraints that define @xmath293 have full rank ( in fact even the inequalities in the box constraints have full rank ) .",
    "thus this polyhedron is a valid polyhedron for the intermediate simplex problem .",
    "next we specify the points in @xmath291 for the intermediate simplex problem(each of which will be contained in the polyhedron @xmath293 ) .",
    "let @xmath357 ( for @xmath423 $ ] ) be the set @xmath291 in the gadget in section  [ sec : gad ] .",
    "as before , let @xmath424 and @xmath425 be the @xmath307 and @xmath306 coordinates of @xmath357 respectively .",
    "let @xmath395-@xmath426 be the maximum possible @xmath395-value of any point @xmath427 with @xmath414 , @xmath428 , @xmath429 and @xmath430 for all @xmath431 so that @xmath427 is still contained in @xmath293 .",
    "[ def : points ] the set @xmath291 of points for the intermediate simplex problem is    * @xmath432 point : * for all @xmath399 $ ] , @xmath433 and @xmath434    * @xmath5 point : * for all @xmath399 $ ] , @xmath433 and @xmath435    * @xmath436 points : * for each @xmath399 $ ] , for each @xmath423 $ ] set @xmath437 , @xmath438 , @xmath439 and for @xmath431 set @xmath430 . also set @xmath395 to be the @xmath440-@xmath426 .",
    "* @xmath362 point : * for each @xmath399 $ ] , @xmath441 , @xmath442 , @xmath443 and @xmath444    this completes the reduction of @xmath14-sum to intermediate simplex , and next we establish the completeness and soundness of this reduction .",
    "the completeness part is straight forward : for @xmath19 gadget we just select the triangle that corresponds to @xmath445 .",
    "if there is a set @xmath446 of @xmath256 values ( not necessarily distinct ) such that @xmath447 } s_{k_i } = d/2 $ ] then there is a solution to the corresponding intermediate simplex problem .    we will choose a set of @xmath448 points @xmath253 : we will include the @xmath432 and @xmath5 points , and for each @xmath445 , we will choose the triangle corresponding to the value @xmath445 in the @xmath19 gadget .",
    "recall the triangle is @xmath449 in the gadget defined in section  [ sec : gad ] .",
    "the points we choose have @xmath414 and @xmath343 , @xmath413 equal to the corresponding point in the gadget .",
    "we will set @xmath395 to be @xmath445 for the point on the line @xmath311 and we will set @xmath395 to be zero for the other two points not contained in the line @xmath311 .",
    "the rest of the dimensions are all set to 0 .",
    "next we prove that the convex hull of this set of points @xmath253 contains all the points in @xmath291 : the points @xmath432 and @xmath5 are clearly contained in the convex hull of @xmath253 ( and are in fact in @xmath253 ! ) .",
    "next consider some point @xmath436 in @xmath291 corresponding to some intersection point @xmath357 in the gadget @xmath406 . since @xmath357 is in the convex hull of the triangle corresponding to @xmath445 in the gadget @xmath406",
    ", there is a convex combination of the these three points @xmath450 in @xmath253 ( which we call @xmath451 ) so that @xmath452 matches @xmath436 on all coordinates except possibly the @xmath395-coordinate .",
    "furthermore the point @xmath451 has some value in the coordinate corresponding to @xmath395 and this must be at most the corresponding value in @xmath436 ( because we chose the @xmath395-value in @xmath436 to be @xmath440-@xmath426 ) .",
    "hence we can distribute the remaining @xmath453 weight among the @xmath432 and @xmath5 points to recover @xmath436 exactly on all coordinates .",
    "lastly , we observe that if we equally weight all points in @xmath253 ( except @xmath432 and @xmath5 ) we recover the point @xmath362 .",
    "in particular , the @xmath395 coordinate of @xmath362 should be @xmath454 .",
    "next we prove soundness for our reduction .",
    "suppose the solution is @xmath253 , which is a set of @xmath455 points in the polyhedron @xmath293 and the convex hull of points in @xmath253 contains all the @xmath432 , @xmath5 , @xmath436 , @xmath362 points ( in definition  [ def : points ] ) .",
    "the points @xmath432 and @xmath5 must be in the set @xmath253 .",
    "the points @xmath432 and @xmath5 are vertices of the polyhedron @xmath293 and hence can not be expressed as a convex combination of any other set of points in @xmath293 .",
    "now we want to prove the rest of the @xmath456 points in set @xmath253 is partitioned into @xmath256 triples , each triple belongs to one gadget .",
    ".    for @xmath399 $ ] , let @xmath458    the sets @xmath459 partition @xmath460 and each contain exactly @xmath14 nodes .",
    "the sets @xmath459 are disjoint , and additionally each set @xmath459 must contain at least @xmath14 nodes ( otherwise the convex hull of @xmath459 even restricted to @xmath420 can not contain the points @xmath436 ) .",
    "this implies the claim .",
    "recall the gadget in section  [ sec : gad ] is a two dimensional object , but it is represented as a three dimensional cone in our construction .",
    "we would like to apply lemma  [ lem : gadget ] to points on the plane @xmath414 ( in this plane the coordinates @xmath343,@xmath413 act the same as @xmath306 , @xmath307 in the gadget ) .",
    "for each point @xmath461 , let @xmath462 be the intersection of the line connecting the origin and @xmath463 with the @xmath414 base of the set @xmath464 .",
    "let @xmath465 be the point - wise @xmath466 operation applied to each point in @xmath459 .",
    "since the points @xmath436 are in the affine hull of @xmath459 when restricted to @xmath467 , we know @xmath468 must be in the convex hull of @xmath465 . using lemma  [ lem : gadget ] in section  [ sec : gad ] , we get :    @xmath465 must correspond to some triangle @xmath449 for some value @xmath445 .",
    "now we know how to decode the solution @xmath253 and get the numbers @xmath445 .",
    "we will abuse notation and call the 3 points in @xmath459 @xmath469 , @xmath470 , @xmath471 ( they were used to denote the corresponding points in the 2-d gadget in section  [ sec : gad]).we still want to make sure the @xmath395 coordinate correctly `` computes '' the sum of these numbers . as a first step we want to show that the @xmath412 of all points in @xmath459 must be 1 ( we need this because the constraints ab and ce are only strict when @xmath414 ) .",
    "[ lemma : setx ] for each point @xmath461 , @xmath472    suppose , for the sake of contradiction , that @xmath473 ( for @xmath461 ) .",
    "then consider the point @xmath362 . since @xmath447 } x_i(q ) = 1 $ ] , and for any point in @xmath253 @xmath447 } x_i \\le 1 $ ] , there is no convex combination of points in @xmath253 that places non - zero weight on @xmath474 and equals @xmath362 .",
    "let @xmath475 be @xmath476 , we observe that the points in @xmath475 are the only points in @xmath253 that have any contribution to @xmath477 when we want to represent @xmath362 ( using a convex combination ) .",
    "for now we restrict our attention to these three dimensions .",
    "when trying to represent @xmath362 we must have @xmath478 weight in the set @xmath475 ( because of the contribution in @xmath412 coordinate ) .",
    "the @xmath343 , @xmath413 coordinates of @xmath362 are @xmath479 , @xmath480 respectively .",
    "this means if we take projection to @xmath481 plane @xmath1 must be in the convex hull of @xmath475 .",
    "however that is impossible because no two points in @xmath482 contain @xmath1 in their convex hull .",
    "this contradiction implies the lemma .",
    "[ lem : equalweight ] any convex combination of points in @xmath253 that equals the point @xmath362 must place equal weight on all points in @xmath460 .",
    "using lemma  [ lemma : setx ] , we conclude that the total weight on points in @xmath459 is exactly @xmath478 , and there is a unique convex combination of the points @xmath459 ( restricted to @xmath483 ) that recover the point @xmath1 which is the @xmath484 combination .",
    "this implies the lemma .",
    "now we are ready to compute the @xmath395 value of the point @xmath362 and show the sum of @xmath445 is indeed @xmath282 .",
    "when @xmath485 for some large enough constant @xmath73 , if there is a solution to the intermediate simplex instance , then there is a choice of @xmath256 values that sum up to exactly @xmath282 .",
    "as we showed in previous lemmas , the solution to the intermediate simplex problem must contain @xmath432 , @xmath5 , and for each gadget @xmath168 the solution has 3 points @xmath459 that correspond to one of the solutions of the gadget .",
    "suppose for gadget @xmath168 the triangle we choose is @xmath449 . by constraints @xmath311 we know @xmath486 , by constraints @xmath417 we know @xmath487 and @xmath488 .    by lemma  [ lem : equalweight ]",
    "there is only one way to represent @xmath362 , and @xmath489 = 1/6 $ ] .",
    "@xmath490.\\ ] ]    since @xmath491 and @xmath492 s are small , we have @xmath493 $ ] .",
    "however the numbers only have @xmath494 bits and @xmath30 is so small , the only valid value in the range is @xmath282 .",
    "hence the sum @xmath495 must be equal to @xmath282 .",
    "earlier , we gave algorithms for nmf , and presented evidence that no @xmath13 time algorithm exists for determining if a matrix @xmath1 has nonnegative rank at most @xmath11 .",
    "here we consider conditions on the input that allow the factorization to be found in time polynomial in @xmath15 , @xmath16 and @xmath11 .",
    "( in section  [ subsec : separablenoise ] , we give a noise - tolerant version of this algorithm ) . to the best of our knowledge",
    "this is the first example of an algorithm ( that runs in time poly@xmath496 ) and provably works under a non - trivial condition on the input .",
    "donoho and stodden  @xcite in a widely - cited paper identified sufficient conditions for the factorization to be unique ( motivated by applications of nmf to a database of images ) but gave no algorithm for this task .",
    "we give an algorithm that runs in time poly@xmath496 and assumes only one of their conditions is met ( separability ) .",
    "we note that this separability condition is quite natural in its own right , since it is usually satisfied @xcite by model parameters fitted to various generative models ( e.g. lda @xcite in information retrieval ) .",
    "a nonnegative factorization @xmath28 is called _ separable _",
    "if for each @xmath168 there is some row @xmath497 of @xmath4 that has a single nonzero entry and this entry is in the @xmath19 column .",
    "let us understand this condition at an intuitive level in context of clustering documents by topic , which was discussed in the introduction .",
    "recall that there a column of @xmath1 corresponds to a document .",
    "each column of @xmath4 represents a topic and its entries specify the probability that a word occurs in that topic .",
    "the nmf thus `` explains '' the @xmath19 document as @xmath498 where the column vector @xmath499 has ( nonnegative ) coordinates summing to one  in other words , @xmath499 represents a convex combination of topics . in practice , the total number of words @xmath15 may number in the thousands or tens of thousands , and the number of topics in the dozens .",
    "thus it is not unusual to find factorizations in which each topic is flagged by a word that appears only in that topic and not in the other topics  @xcite .",
    "the separability condition asserts that this happens for every topic .    for simplicity",
    "we assume without loss of generality that the rows of @xmath1 are normalized to have unit @xmath36-norm .",
    "after normalizing @xmath1 , we can still normalize @xmath5 ( while preserving the factorization ) by re - writing the factorization as @xmath500 for some @xmath75 nonnegative matrix @xmath501 . by setting @xmath502 the rows of @xmath503",
    "will all have @xmath504 norm 1 .",
    "when rows of @xmath1 and @xmath5 are all normalized the rows of @xmath4 must also have unit @xmath36-norm because    @xmath505    the third equality uses the nonnegativity of @xmath5 .",
    "notice that after this normalization , if a row of @xmath4 has a unique nonzero entry ( the rows in separability ) , that particular entry must be one .",
    "we also assume @xmath5 is a simplicial matrix defined as below .",
    "a nonnegative matrix @xmath5 is _ simplicial _ if no row in @xmath5 can be represented in the convex hull of the remaining rows in @xmath5 .",
    "the next lemma shows that without loss of generality we may assume @xmath5 is simplicial .",
    "[ lemma : alt ] if a nonnegative matrix @xmath1 has a separable factorization @xmath8 of inner - dimension at most @xmath11 then there is one in which @xmath5 is simplicial .",
    "suppose @xmath5 is not simplicial , and let the @xmath20 row @xmath506 be in the convex hull of the remaining rows",
    ". then we can represent @xmath507 where @xmath508 is a nonnegative vector with @xmath509 and the @xmath20 coordinate is 0 .",
    "now modify @xmath4 as follows .",
    "for each row @xmath510 in @xmath4 that has a non - zero @xmath20 coordinate , we zero out the @xmath20 coordinate and add @xmath511 to the row @xmath510 . at the end",
    "the matrix is still nonnegative but whose @xmath20 column is all zeros .",
    "so delete the @xmath20 column and let the resulting @xmath288 matrix be @xmath31 .",
    "let @xmath32 be the matrix obtained by deleting the @xmath20 row of @xmath5 .",
    "then by construction we have @xmath147 .",
    "now we claim @xmath31 is separable .",
    "since @xmath4 was originally separable , for each column index @xmath168 there is some row , say the @xmath512 row , that has a non - zero entry in the @xmath19 column and zeros everywhere else . if @xmath513 then by definition the above operation does not change the @xmath512 row of @xmath4 .",
    "if @xmath514 the @xmath20 index is deleted at the end . in either case",
    "the final matrix @xmath31 satisfies the separability condition .    repeating the above operation for all violations of the simplicial condition we end with a separable factorization of @xmath1 ( again with inner - dimension at most @xmath11 ) where @xmath5 is simplicial .",
    "there is an algorithm that runs in time polynomial in @xmath15 , @xmath16 and @xmath11 and given a matrix @xmath1 outputs a separable factorization with inner - dimension at most @xmath11 ( if one exists ) .",
    "we can apply lemma  [ lemma : alt ] and assume without loss of generality that there is a factorization @xmath28 where @xmath4 is separable and @xmath5 is simplicial .",
    "the separability condition implies that every row of @xmath5 appears among the rows of @xmath1 .",
    "thus @xmath5 is hiding in plain sight in @xmath1 ; we now show how to find it .",
    "say a row @xmath35 is a _ loner _ if ( ignoring other rows that are copies of @xmath35 ) it is not in the convex hull of the remaining rows .",
    "the simplicial condition implies that the rows of @xmath1 that correspond to rows of @xmath5 are loners .",
    "a row @xmath35 is a loner iff @xmath35 is equal to some row @xmath515    suppose ( for contradiction ) that a row in @xmath35 is not a loner and but it is equal to some row @xmath516 .",
    "then there is a set @xmath291 of rows of @xmath1 so that @xmath35 is in their convex hull and furthermore for all @xmath517 , @xmath518 is not equal to @xmath35 .",
    "thus there is a nonnegative vector @xmath519 that is 0 at the @xmath20 coordinate and positive on indices in @xmath291 such that @xmath520 .",
    "hence @xmath521 , but @xmath522 must have unit @xmath36-norm ( because @xmath523 , all rows of @xmath4 have unit @xmath36-norm and are all nonnegative ) , also @xmath522 is non - zero at position @xmath524 .",
    "consequently @xmath516 is in the convex hull of the other rows of @xmath5 , which yields a contradiction .",
    "conversely if a row @xmath35 is not equal to any row in @xmath5 , we conclude that @xmath35 is in the convex hull of the rows of @xmath5 .",
    "each row of @xmath5 appears as a row of @xmath4 ( due to the separability condition ) .",
    "hence @xmath35 is not a loner because @xmath35 is in the convex hull of rows of @xmath1 that are equivalent to @xmath35 itself .",
    "using linear programming , we can determine which rows @xmath35 are loners . due to separability there will be exactly @xmath11 different loner rows , each corresponds to one of the @xmath516 .",
    "thus we are able to recover @xmath32 that is equal to @xmath5 after permutation over rows.we can compute a nonnegative @xmath31 such that @xmath525 , and such solution @xmath31 is necessarily separable ( since it is just equal to @xmath4 after permutation over columns ) .",
    "in any practical setting the data matrix @xmath1 will not have an exact nmf of low inner dimension since its entries are invariably subject to noise .",
    "here we consider how to extend our separability - based algorithm to work in presence of noise .",
    "we assume that the input matrix @xmath245 is obtained by perturbing each row of @xmath1 by adding a vector of @xmath36-norm at most @xmath30 , where @xmath1 has a separable factorization of inner - dimension @xmath11 .",
    "alternatively , @xmath526 for all @xmath168 .",
    "notice that the case in which the separability condition is only approximately satisfied is a subcase of this : if for each column there is some row in which that column s entry is at least @xmath527 and the sum of the other row entries is less than @xmath30 then the matrix @xmath245 will satisfy the condition stated above .",
    "( note that @xmath528 have been scaled as discussed above . )",
    "our algorithm will require one more condition  namely , we require the unknown matrix @xmath5 to be `` robustly '' simplicial instead of just simplicial .",
    "we call @xmath5 _ @xmath529-robust simplicial _ if no row in @xmath5 has @xmath36 distance smaller than @xmath529 to the convex hull of the remaining rows in @xmath5 .",
    "( here all rows have unit @xmath36-norm . )    recall from lemma  [ lemma : alt ] that the simplicial condition can be assumed without loss of generality under separability .",
    "in general @xmath529-robust simplicial condition does not follow from separability . however , any reasonable generative model would surely posit that the matrix @xmath5 whose columns after all represents distributions  satisfies the condition above . for instance , if columns of @xmath5 are picked randomly from the unit @xmath36 ball then after normalization @xmath529 is more than @xmath530 . regardless of whether or not one self - identifies as a bayesian , it seems reasonable that any suitably generic way of picking column vectors would tend to satisfy the @xmath529-robust - simplicial property .",
    "[ thm : separablenoise ] suppose @xmath531 where @xmath4 is separable and @xmath5 is @xmath529-robust simplicial .",
    "let @xmath30 satisfy @xmath532 .",
    "then there is a polynomial time algorithm that given @xmath245 such that for all rows @xmath533 , finds a nonnegative matrix factorization @xmath534 of the same inner dimension such that the @xmath36 norm of each row of @xmath535 is at most @xmath536 .",
    "separability implies that for any column index @xmath168 there is a row @xmath537 in @xmath4 whose only nonzero entry is in the @xmath19 column .",
    "then @xmath538 and consequently @xmath539 . let us call these rows @xmath540 for all @xmath168 the _",
    "canonical rows_. from the above description the following claim is clear since the rows of @xmath1 can be expressed as a convex combination of @xmath516 s .",
    "[ claim : repsentationwitherror ] every row @xmath541 has @xmath36-distance at most @xmath542 to the convex hull of canonical rows .",
    "@xmath543 and we can bound the right hand side by @xmath544 .",
    "next , we show how to find the canonical rows . for a row @xmath541 , we call it a _ robust - loner _",
    "if upon ignoring rows whose @xmath36 distance to @xmath541 is less than @xmath545 , the @xmath36-distance of @xmath541 to the convex hull of the remaining rows is more than @xmath542 .",
    "note that we can identify robust - loner rows using linear programming .",
    "the following two claims establish that a row of @xmath541 is a robust - loner if and only if it is close to some row @xmath516 .",
    "if @xmath541 has distance more than @xmath546 to all of the @xmath516 s , then it can not be a robust loner .",
    "such an @xmath541 has distance at least @xmath256 to each of the canonical rows .",
    "the previous claim shows @xmath541 is close to the convex hull of the canonical rows and thus by definition it can not be a robust - loner .",
    "all canonical rows are robust - loners .    since @xmath547 , when we check",
    "if @xmath540 is a robust - loner ( using linear programming ) , we leave out of consideration all rows that have @xmath36-distance at most @xmath548 to @xmath516 . in particular , this omits any row @xmath541 such that @xmath549 and @xmath550 .",
    "all remaining rows have @xmath551 , and hence the @xmath36 distance of @xmath516 to @xmath552 is at least @xmath553 ( by the @xmath529-robust simplicial property ) , we conclude that the distance between @xmath516 and the convex hull of remaining @xmath35 s must be at least @xmath554 . since @xmath245 is close to @xmath1 the @xmath36-distance between @xmath540 and the convex hull of remaining rows @xmath541 s must be at least @xmath555 .",
    "therefore @xmath540 is a robust - loner .",
    "the previous claim implies that each robust - loner row is within @xmath36-distance @xmath546 to some @xmath516 and conversely , for every @xmath516 there is at least one robust - loner row that is close to it .",
    "since the @xmath36-distances between @xmath516 s are at least @xmath556 , we can apply distance based clustering on the robust - loner rows : place two robust - loner rows into the same cluster if and only if these rows are within @xmath36-distance at most @xmath557 .",
    "clearly we will obtain @xmath11 clusters , one corresponding to each of the @xmath516 s .",
    "choose one row from each of the cluster , and using similar argument as claim  [ claim : repsentationwitherror ] we deduce that every row of @xmath245 is within @xmath558 to the convex hull of the rows we selected .",
    "therefore these rows form a nonnegative @xmath32 and we can find @xmath31 so that @xmath559 for all @xmath170 .",
    "here we consider the case in which the given matrix does not have an exact low - rank nmf but rather can be approximated by a nonnegative factorization with small inner - dimension .",
    "we refer to this as _ approximate _ nmf .",
    "unlike the algorithm in theorem  [ thm : separablenoise ] , the algorithm here works with general nonnegative matrix factorization : we do not make any assumptions on matrices @xmath4 and @xmath5 . throughout this section",
    "we will use @xmath10 to denote the froebenius norm , @xmath560 to denote the spectral norm and @xmath561 applied to a vector will denote the standard euclidean norm .",
    "let @xmath1 be an @xmath562 nonnegative matrix such that there is a factorization @xmath8 satisfying @xmath563 , where @xmath4 and @xmath5 are nonnegative and have inner - dimension @xmath11 .",
    "there is an algorithm that computes @xmath31 and @xmath32 satisfying @xmath564 in time @xmath29 .",
    "note that the matrix @xmath1 need not have low rank , but we will be able to assume @xmath1 has rank at most @xmath11 without loss of generality : let @xmath245 be the best rank at most @xmath11 approximation ( in terms of frobenius norm ) to @xmath1 .",
    "this can be computed using a truncated singular value decomposition ( see e.g. @xcite ) .",
    "since @xmath4 and @xmath5 have inner - dimension @xmath11 , we get :    @xmath565    throughout this section , we will assume that the input matrix @xmath1 has rank at most @xmath11 - since otherwise we can compute @xmath245 and solve the problem for @xmath245 .",
    "then using the triangle inequality , any good approximation to @xmath245 will also be a good approximation to @xmath1 .    throughout this section",
    ", we will use the notation @xmath566 to denote the @xmath567 column of @xmath4 and @xmath568 to denote the @xmath567 row of @xmath5 . note that @xmath568 is a row vector so we will frequently use @xmath569 to denote an outer - product .",
    "next , we apply a simple re - normalization that will allow us to state the main steps in our algorithm in a more friendly notation .",
    "[ lemma : normalization ] we can assume without loss of generality that for all @xmath218 @xmath570 and furthermore @xmath571 .",
    "we can write @xmath572 so we may scale @xmath573 to ensure that @xmath574 .",
    "next , since @xmath4 and @xmath5 are nonnegative we have @xmath575 and @xmath576 and this implies the first condition in the lemma .",
    "next we observe @xmath577 ^ 2 \\ge \\sum_{t=1}^r\\sum_{i=1}^n \\sum_{j=1}^m [ a_t w^t]_{i , j}^2 = { \\left\\lvert a \\right\\rvert}_f^2.\\ ] ] where the inequality follows because all entries in @xmath4 and @xmath5 are nonnegative , and the last equality follows because @xmath578 .",
    "note that this lemma immediately implies that @xmath579 .",
    "the intuition behind our algorithm is to decompose the unknown matrix @xmath5 as the sum of two parts : @xmath580 .",
    "the first part @xmath581 is responsible for how good @xmath8 is as an approximation to @xmath1 ( i.e. , @xmath582 is small ) but could be negative ; the second part @xmath583 has little effect on the approximation but is important in ensuring the sum @xmath584 is nonnegative",
    ". the algorithm will find good approximations to @xmath585 .",
    "what are @xmath585 ?",
    "since removing @xmath583 has little effect on how good @xmath8 is as an approximation to @xmath1 , this matrix should be roughly the projection of @xmath5 onto the `` less significant '' singular vectors of @xmath4 .",
    "namely , let the singular value decomposition of @xmath4 be @xmath586 and suppose that @xmath587 .",
    "let @xmath588 be the largest @xmath218 for which @xmath589 ( where @xmath51 is a constant that is polynomially related to @xmath11 and @xmath30 and will be specified later ) . then set @xmath590    [ lemma : w0 ] @xmath591    by the triangle inequality @xmath592 .",
    "also @xmath593 , so we have    @xmath594 where the last inequality follows because @xmath579 and the spectral norm of @xmath595 is one .",
    "next , we establish a lemma that will be useful when searching for ( an approximation to ) @xmath581 :    [ lem : w0pp ] there is an @xmath7 matrix @xmath596 such that each row is in the span of the rows of @xmath1 and which satisfies @xmath597    consider the matrix @xmath598 . thus @xmath58 is a pseudo - inverse of the truncated svd of @xmath4 .",
    "note that @xmath599 and the spectral norm @xmath600 is at most @xmath601 .",
    "then we can choose @xmath602 .",
    "clearly , each row of @xmath596 is in the span of the rows of @xmath1 .",
    "furthermore , we have @xmath603    [ lemma : w1 ] there is an algorithm that in time @xmath29 finds @xmath604 and @xmath31 such that @xmath605 , @xmath606 and    @xmath607    we use exhaustive enumeration to find a close approximation to the matrix @xmath596 of lemma  [ lem : w0pp ] , and then we use convex programming to find @xmath608 :    the exhaustive enumeration is simple : try all vectors that lie in some @xmath609-net in the span of the rows of @xmath1 , where @xmath610 .",
    "such an @xmath609-net is easily enumerated in the provided time since the row vectors are smaller than @xmath611 and their span is @xmath11-dimensional . contained in this net there must an @xmath612 such that @xmath613 .",
    "using lemma  [ lem : w0pp ] , @xmath614 so the triangle inequality implies @xmath615 .",
    "next , we give a method to find suitable substitutes @xmath608 for @xmath616 respectively so that @xmath617 and @xmath618 is a good approximation to @xmath1 .",
    "let us assume we know the vectors @xmath619 appearing in the svd expression  ( [ eqn : svda ] ) and @xmath620 .",
    "this is easy to guarantee since we can enumerate over all choices of the @xmath619 s ( which are unit vectors in @xmath98 ) using a suitable @xmath621-net where @xmath622 . also , @xmath620 is a scalar value that can be easily guessed within multiplicative factor @xmath623 .",
    "let @xmath624 be the optimal solution to the following convex program :    @xmath625    this is optimization problem is convex since the constraints are linear and the objective function is quadratic but convex .",
    "( in fact this optimization problem can be separated into @xmath16 smaller convex programs because the constraints between different columns of @xmath626 are independent ) .    when the vectors we enumerated ( denoted as @xmath627 )",
    "are close enough to the true values @xmath628 , that is , when @xmath629 , the value of the objective function after substituting @xmath630 by @xmath631 can only change by at most @xmath632 . from now on we work with the true values of @xmath628 .",
    "the claim below and arguments after will still be true although the vectors are not exact .",
    "the optimal value of this convex program is at most @xmath632 .",
    "we prove that @xmath633 is a feasible solution and that the objective value of this solution is the value claimed in the lemma .",
    "since @xmath634 only contributes to the second term of the objective function in ( [ eqn : convexopt ] ) , we can upper bound the objective as @xmath635 the proof is completed because @xmath636 and @xmath637 .    after solving the convex program , we obtaine a candidate @xmath626 .",
    "let @xmath638 . to get the right @xmath31 ( since @xmath32 is fixed )",
    "we can find the @xmath31 that minimizes @xmath639 by solving a least - squares problem .",
    "clearly such an @xmath31 satisfies @xmath640 and the latter quantity is bounded by @xmath641    lemma  [ lemma : w0 ] bounds the first term and lemma  [ lem : w0pp ] bounds the second term .",
    "the square of the last term is bounded by the objective function of the convex program .",
    "finally , by choosing @xmath642 we get @xmath31 , @xmath638 such that @xmath643 .",
    "suppose @xmath4 is an @xmath644 matrix .",
    "suppose there are matrices @xmath645 where @xmath646 is @xmath647 and @xmath648 is @xmath61 with @xmath649 ( entrywise ) and @xmath650 for some @xmath651 $ ] .",
    "[ notation : @xmath566 denotes the @xmath218 th column of @xmath4 as a column vector . ]",
    "there exists a randomized algorithm that can find @xmath646 , @xmath648 with nonnegative entries so that @xmath652 in time @xmath653 .",
    "[ length - x - y ] without loss of generality , we may assume @xmath654 so we may scale @xmath655 to ensure that @xmath656 .",
    "now since @xmath649 , we have @xmath657 and @xmath658 , from which the lemma follows .",
    "suppose the svd of @xmath646 is @xmath659 and suppose @xmath588 is the largest @xmath218 for which @xmath660 .",
    "let @xmath661 ( an @xmath662 matrix ) .",
    "[ this is the psuedo - inverse of @xmath646 , but we have not included the low singular values of @xmath646 , since , intuitively , they are near - singularities and cause problems in the inverse . ]",
    "@xmath663 and so @xmath664 .",
    "@xmath665 now , we draw a sample of @xmath666poly@xmath667 rows of @xmath4 according to length - squared distribution .",
    "if we took the corresponding columns of @xmath5 and multiplied , by the basic matrix multiplication results of drineas , kannan , we can get an approximation to @xmath668 with error in frobenius norm at most @xmath669 .",
    "but , we do not have @xmath5 , so we enumerate all possible values for the @xmath670 entries of @xmath5 in the sample @xmath120 columns where , each entry is enumerated as an integer multiple of poly@xmath671 , so that total frob norm error is at most poly@xmath672 .",
    "thus , at some point in the enumeration , we will get a @xmath673 matrix @xmath293 with latexmath:[\\[\\label{wa - p }    [ the point is that @xmath293 has @xmath675 entries and we can not enumerate all possibilities for this ; we got away with just enumerating @xmath676 entries . ] the components of @xmath648 along @xmath677 are not pined down by @xmath293 ; while these do not cause much error in @xmath678 since @xmath646 has low components along these @xmath679 , but they are important for nonnegativity of @xmath648 .",
    "the following algorithm carefully deals with this issue , keeping all the constraints convex .    1 .",
    "pick by length - squared sampling ( and scale ) poly@xmath680 rows of @xmath4 .",
    "2 .   enumerate corresponding columns of @xmath5 , each entry an integer multiple of poly@xmath672 up to abs value @xmath681 .",
    "3 .   compute @xmath293 approximating @xmath668 for each enumerated @xmath5 in step ( 2 ) .",
    "enumerate candidate @xmath682 , namely , enumerate all @xmath89 matrices , each entry to poly@xmath683 . do gram - schmidt on the matrix and make it orthonormal .",
    "[ at some point , we will enumerate an approximation of the correct @xmath684 to frob error at most poly@xmath683 ; then since the matrix is close to orthonormal , grahm - schmidt will not change it by more than poly@xmath683 . let @xmath685 be the enumerated orthonormal set of vectors .",
    "enumerate @xmath686 .",
    "solve the following convex progam with @xmath687 as the unknowns ( easy to check convexity ) for each enumerate :    @xmath688 .",
    "( i ) : at some point @xmath685 will approximate the correct @xmath684 with @xmath689 .",
    "we will also have the correct @xmath588 and a @xmath293 satisfying ( [ wa - p ] ) . then , since @xmath690 , @xmath691 lemma ( [ length - x - y ] ) implies that @xmath692 . this and ( [ wa - p ] ) bound the first term on the r.h.s .. the hypothesis bounds the second term",
    ". @xmath693 .",
    "thus , ( [ xp - a ] ) is satisfied .",
    "( [ |xt| ] ) holds by lemma ( [ length - x - y ] ) . for ( [ later - x ] ) , note that for @xmath694 , @xmath695 . to see ( [ first - zt ] ) , note that ( [ wa - p ] ) implies that @xmath696 using lemma ( [ length - x - y ] ) and so for @xmath697 , @xmath698",
    "finally we prove ( [ later - zt ] ) holds . since @xmath699 are orthonormal , by ( [ ytp ] ) , @xmath700 . but @xmath701 as required .",
    "now we prove ( ii ) : @xmath702 @xmath703 is bounded by ( [ |xt| ] ) .",
    "@xmath704 and ( [ first - zt ] ) bounds @xmath705 , thus bounding the second term of the r.h.s .",
    "the third term is bounded using ( [ later - x ] ) giving us ( ii ) .",
    "here , we initiated a rigorous study of nonnegative matrix factorization . our hardness result rules out significant improvements over our worst - case results for fixed inner - dimension @xmath11 .",
    "we believe that our @xmath706-time algorithm for finding separable factorizations may point the way for future work .",
    "what other plausible conditions can one impose on the factors in real - life applications ?",
    "we also hope our work promotes further theoretical study of nonnegative rank .",
    "this work is part of a broader agenda of bringing greater rigor to the analysis of algorithms used in machine learning . currently , heuristic approaches are popular because the solution concepts are believed to be intractable .",
    "our results , for example our algorithm for nmf under the separability condition , raise hope that sometimes the solution concepts may not be intractable after all .",
    "we thank david blei and saugata basu for useful discussions .    99    a. aho , j. ullman and m. yannakakis . on notions of information transfer in vlsi circuits . , pp .",
    "133139 , 1983 .",
    "n. alon and s. onn .",
    "separable partitions . , pp . 3951 , 1999 .",
    "s. basu , r. pollack and m. roy . on the combinatorial and algebraic complexity of quantifier elimination . , pp . 10021045 , 1996 .",
    "preliminary version in _ focs _ 1994 .",
    "personal communication .",
    "d. blei , a. ng and m. jordan .",
    "latent dirichlet allocation . , pp .",
    "9931022 , 2003 .",
    "preliminary version in _ nips _ 2001 .",
    "l. blum , f. cucker , m. shub and s. smale . .",
    "springer verlag , 1998 .",
    "g. buchsbaum and o. bloch .",
    "color categories revealed by non - negative matrix factorization of munsell color spectra .",
    "559 - 563 , 2002 .",
    "j. cohen and u. rothblum .",
    "nonnegative ranks , decompositions and factorizations of nonnegative matices . , pp . 149168 , 1993 .",
    "s. deerwester , s. dumais , t. landauer , g. furnas and r. harshman .",
    "indexing by latent semantic analysis . , pp . 391407 , 1990 .",
    "d. donoho and v. stodden .",
    "when does non - negative matrix factorization give the correct decomposition into parts ?",
    ", 2003 .",
    "s. fiorini , t. rothvo@xmath707and h. tiwary . extended formulations for polygons .",
    "arxiv , 2011 .",
    "g. golub and c. van loan .",
    "the johns hopkins university press , 1996 .",
    "d. yu . grigorev and n.n .",
    "vorobjov jr .",
    "solving systems of polynomial inequalities in subexponential time , , volume 5 , issues 1 - 2 , february - april 1988 , pp .",
    "37 - 64    e. harding .",
    "the number of partitions of a set of @xmath279 points in @xmath178 dimensions induced by hyperplanes . , pp . 285289 , 1967 .",
    "schmas de nuptialit : dsquilibre des sexes et clibat . 24:457 - 486 , 1969 .",
    "t. hofmann .",
    "probabilistic latent semantic analysis . , pp .",
    "289296 , 1999 .",
    "non - negative matrix factorization with sparseness constraints . , pp . 14571469 , 2004 .",
    "f. hwang and u. rothblum . on the number of separable partitions . , pp .",
    "423433 , 2011 .",
    "a. hyvrinen , j. karhunen and e. oja . .",
    "wiley interscience , 2001 .",
    "r. impagliazzo and r. paturi . on the complexity of k - sat . 62(2):pp . 367375 , 2001 .",
    "j. kleinberg and m. sandler .",
    "using mixture models for collaborative filtering . , pp . 4969 , 2008 .",
    "preliminary version in _ stoc _ 2004 .",
    "r. kumar , p. raghavan , s. rajagopalan and a. tomkins .",
    "recommendation systems : a probabilistic analysis . , pp . 4261 , 2001 .",
    "preliminary version in _ focs _ 1998 .",
    "w. lawton and e. sylvestre .",
    "self modeling curve resolution . , pp .",
    "617 633 , 1971 .",
    "d. lee and h. seung .",
    "learning the parts of objects by non - negative matrix factorization .",
    "788 - 791 , 1999 .",
    "d. lee and h. seung .",
    "algorithms for non - negative matrix factorization . , pp . 556562 , 2000 .",
    "l. lovsz and m. saks .",
    "communication complexity and combinatorial lattice theory . , pp . 322349 , 1993 .",
    "preliminary version in _ focs _ 1988 .",
    "j. matousek . .",
    "springer , 2002 .",
    "lower bounds for non - commutative computation ( extended abstract ) . , pp . 410418 , 1991 .",
    "p. paatero and u. tapper .",
    "positive matrix factorization : a non - negative factor model with optimal utilization of error estimates of data values .",
    "111 - 126 , 1994 .",
    "m. patrascu and r. williams . on the possibility of faster sat algorithms . ,",
    "pp . 10651075 , 2010 .    c. papadimitriou , p. raghavan , h. tamaki and s. vempala",
    "latent semantic indexing : a probabilistic analysis . ,",
    "pp . 217235 , 2000 .",
    "preliminary version in _ pods _ 1998 .",
    "j. renegar . on the computational complexity and geometry of the first - order theory of the reals . ,",
    "volume 13 , issue 3 , march 1992 , pp .",
    "255 - 352 .",
    "a. seidenberg .",
    "a new decision method for elementary algebra . , pp . 365374 , 1954 .",
    "a. tarski .",
    "a decision method for elementary algebra and geometry .",
    ", 1951 .",
    "w. xu and x. liu and y. gong .",
    "document clustering based on non - negative matrix factorization . , pp .",
    "267273 , 2003 .    s. vavasis . on the complexity of nonnegative matrix factorization . , pp . 1364 - 1377 , 2009",
    ".    m. yannakakis . expressing combinatorial optimization problems by linear programs . , pp . 441466 , 1991 .",
    "preliminary version in _ stoc _ 1988 .",
    "here we explain an application of nmf in detail .",
    "perhaps the best approach is to contrast the nmf problem with a more well - known matrix factorization , the singular value decomposition ( svd ) : a @xmath0 matrix @xmath1 can be written as @xmath708 where the set @xmath709 and the set @xmath710 are orthonormal and @xmath711 ( see e.g. @xcite ) . in a number of applications , we imagine that the columns of @xmath1 represent examples and the rows of @xmath1 represent observed variables . in the context of information retrieval one",
    "often forms @xmath1 as a `` term - by - document '' matrix where the @xmath18 entry in @xmath1 is the frequency of occurrence of the @xmath19 term in the @xmath20 document in the database .",
    "the svd of @xmath1 ( e.g. in latent semantic indexing ( lsi ) @xcite ) is often interpreted as a method to extract `` topics '' in the database : the set of vectors @xmath709 ( in a truncated svd ) is the subspace that contains the maximum variance of the documents , and projecting columns of @xmath1 ( i.e. documents ) onto this basis is interpreted as a decomposition of each document into constituent topics .",
    "documents can then be compared based on an inner - product in this space .    in some sense ,",
    "the decomposition into `` topics '' generated via svd is inconsistent with our intuitive notion of what a topic is .",
    "the vectors @xmath709 have both positive and negative values  these vectors are orthogonal .",
    "for example , imagine some documents are about cars and some others are about the weather .",
    "these `` topics '' would both be negatively correlated with mentioning the word `` elephant ''  i.e. documents about either topic are unlikely to use this word .",
    "what this means is that when we compute the similarity of a pair of documents , the documents will be judged to be more similar if both omit the word `` elephant '' .",
    "but this is not consistent with our intuitive model , and would lead to spurious latent relationships",
    ". we would expect similarity to be based on positive occurrences only .",
    "hofman introduced a related approach ( probabilistic latent semantic indexing @xcite ) in which each document is normalized to be a distribution on words , and the goal is to compute a small set of @xmath11 topics ( which are each distributions on words ) and represent each document as a distribution on topics .",
    "this is equivalent ( after an appropriate renormalization ) to computing a nonnegative factorization of the term - by - document matrix @xmath1 into @xmath8 , where the columns of @xmath4 represent a set of @xmath11 topics and each column of @xmath5 expresses the corresponding document as a distribution on topics .",
    "the advantage of requiring this factorization to be nonnegative is that in hofman s plsi documents are judged to be similar based on words that they both contain . in lsi , documents can also be judged to be similar based on words they both omit .",
    "arguably , hofman s model is more consistent with our intuition and maybe this helps explain why ( computational issues aside ) a nonnegative factorization is , in many cases , preferred over an unrestricted one ."
  ],
  "abstract_text": [
    "<S> in the _ nonnegative matrix factorization _ ( nmf ) problem we are given an @xmath0 nonnegative matrix @xmath1 and an integer @xmath2 . </S>",
    "<S> our goal is to express @xmath1 as @xmath3 where @xmath4 and @xmath5 are nonnegative matrices of size @xmath6 and @xmath7 respectively . in some applications </S>",
    "<S> , it makes sense to ask instead for the product @xmath8 to approximate @xmath1  </S>",
    "<S> i.e. ( approximately ) minimize @xmath9 where @xmath10 denotes the frobenius norm ; we refer to this as _ </S>",
    "<S> approximate nmf_.    this problem has a rich history spanning quantum mechanics , probability theory , data analysis , polyhedral combinatorics , communication complexity , demography , chemometrics , etc . in the past decade nmf </S>",
    "<S> has become enormously popular in machine learning , where @xmath4 and @xmath5 are computed using a variety of local search heuristics . </S>",
    "<S> vavasis recently proved that this problem is np - complete . </S>",
    "<S> ( without the restriction that @xmath4 and @xmath5 be nonnegative , both the exact and approximate problems can be solved optimally via the singular value decomposition . )    we initiate a study of when this problem is solvable in polynomial time . </S>",
    "<S> our results are the following :    1 .   we give a polynomial - time algorithm for exact and approximate nmf for every constant @xmath11 . </S>",
    "<S> indeed nmf is most interesting in applications precisely when @xmath11 is small . </S>",
    "<S> 2 .   we complement this with a hardness result , that if exact @xmath12 can be solved in time @xmath13 , @xmath14-sat has a sub - exponential time algorithm . </S>",
    "<S> this rules out substantial improvements to the above algorithm . </S>",
    "<S> 3 .   </S>",
    "<S> we give an algorithm that runs in time polynomial in @xmath15 , @xmath16 and @xmath11 under the _ separablity _ condition identified by donoho and stodden in 2003 . </S>",
    "<S> the algorithm may be practical since it is simple and noise tolerant ( under benign assumptions ) . </S>",
    "<S> separability is believed to hold in many practical settings .    to the best of our knowledge </S>",
    "<S> , this last result is the first example of a polynomial - time algorithm that provably works under a non - trivial condition on the input and we believe that this will be an interesting and important direction for future work . </S>"
  ]
}