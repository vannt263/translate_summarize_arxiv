{
  "article_text": [
    "one of the main tasks of physics data analysis is to reconstruct the true distribution of a given physical quantity from the observed one , getting rid of the distorsions introduced by the detector response and of the background events .",
    "this can be accomplished by different methods , that follow different approaches .",
    "a possible strategy is to assume that the true distribution ( and the noise too ) is described by a mathematical function depending on a set of free parameters , that have to be estimated .",
    "this approach is called parametric inference ( fits ) and is implemented in the well known least squares or maximum likelihood methods .",
    "parametric inference is a valid choice if there are good reasons to believe that the true distribution can be described by a given analytical function .",
    "on the other hand , sometimes physicists do nt need to interpret the observed data in the framework of a model , but only wish to estimate the true distribution with its uncertainties .",
    "this second approach goes under the name of unfolding ( or deconvolution ) .    in this paper",
    "we will illustrate an unfolding method to reconstruct the energy spectra of point like gamma - ray sources detected by the large area telescope ( lat )  @xcite operating on the _ fermi _ satellite .",
    "the applications of the method to the cases of an isolated point source and of a pulsating source will be also discussed .",
    "the unfolding method that we have developed allows to reconstruct the true energy spectra of gamma - ray point sources detected by the _ fermi _",
    "lat from the observed ones , taking into account the instrument response function ( irf ) .",
    "the procedure can be applied to both steady and pulsating point sources .      for our analysis",
    "we usually select photon events within an energy dependent region of interest ( roi ) centered on the source position .",
    "the maximum allowed angular separation from the source is given by : @xmath1 , 0.35\\degrees \\}\\ ] ] where @xmath2 is the photon energy .",
    "the function in eq .",
    "[ eq : psf ] reproduces the energy dependence of the lat @xmath3 angle containment up to a few @xmath4 for photons converting in the back section of the instrument .",
    "the size and the shape of the analysis roi can be changed by the user , according to the kind of source to be investigated .",
    "photon entering in the detector with zenith angles larger than @xmath5 in the instrument frame are excluded from the analysis .",
    "photons with zenith angles larger than @xmath6 with respect to the earth reference frame are also disregarded in order to avoid contamination from earth albedo .      a crucial point for the analysis ( that is not connected with the method !",
    ") is the evaluation of background , that has to be subtracted from the observed energy spectra .",
    "the background includes an isotropic component , a galactic diffuse component and all the contributions from nearby sources .",
    "its energy spectrum can be evaluated either from real data or from a model .    in the first case",
    "the background events are evaluated selecting the photons coming from an annulus external to the roi used for the analysis .",
    "the background energy spectrum built in this way is then properly rescaled taking into account the solid angle and observation time ratios .",
    "this approach is valid if the background distribution does not exhibit significant spatial gradients , as in the case of point sources far from the galactic plane .",
    "when this condition does not occur , as in the case of point sources close to the galactic planes , the background observed spectrum must be evaluated using a proper background model .",
    "the background spectra can be safely evaluated from real data also when a pulsating point source is being investigated . usually , for this class of sources , it is interesting to study only the pulsed emission . in this case",
    "the timing information allows to build the observed spectrum selecting photons within the roi and with phases in the on - pulse range , and the background spectrum selecting photons within the roi and with phases in the off - pulse range .",
    "the background subtraction is then performed taking the on / off pulse ratio into account .",
    "the relation between the observed energy spectrum is given by the following equation : @xmath7 where @xmath8 is the number of events observed in the @xmath9-th observed energy bin , @xmath10 is the number of real events in the @xmath11-th true energy bin and @xmath12 is the probability that a photon with true energy @xmath13 is detected with an observed energy @xmath14 .",
    "the probabilities @xmath12 are the elements of the so called smearing matrix , which condenses the information about the irf .",
    "it is worth to point out that the smearing matrix includes efficiencies and acceptance .",
    "in fact , the sum @xmath15 represents the probability that a photon generated at the source with true energy @xmath13 is detected with any value of observed energy .",
    "the smearing matrix is evaluated using a monte carlo simulation performed with gleam , the full lat simulation package based on the geant4 toolkit  @xcite .",
    "a trial photon spectrum is simulated and the elements of the smearing matrix are evaluated as : @xmath16 where @xmath10 are the events generated in the @xmath11-th true energy bin and @xmath17 are the events generated in the @xmath11-th true energy bin and detected in the @xmath9-th observed energy bin after applying the analysis cuts .",
    "the incoming photon directions are simulated according to the source pointing history .",
    "once the observed spectrum and the smearing matrix are evaluated , the source spectrum is evaluated by means of a bayesian unfolding iterative procedure  @xcite .",
    "each iteration goes through the following steps :    1 .",
    "the spectrum @xmath10 reconstructed after the previous iteration is assumed as starting point ; 2 .",
    "the smearing matrix is inverted by applying bayestheorem : @xmath18 where @xmath19 and @xmath20 are the normalized observed and true spectra ; 3 .",
    "a new true spectrum is evaluated using the inverted smearing matrix : @xmath21    as a starting point of the first iteration a trial spectrum ( usually a flat one ) is assumed .",
    "the iterative procedure is terminated when the spectrum reconstructed after the last iteration does not differ significantly from the previous one ( a @xmath22 test is performed ) .",
    "usually the convergence is reached after a few iterations and the results does not depend on the input trial spectrum .    after the unfolding procedure has converged , it is possible to calculate the errors associated to the unfolded points by applying error propagation to eq .",
    "[ eq : unfo ]  @xcite .",
    "since the unfolded points are correlated , the errors must be described by means of a covariance matrix .",
    "we have implemented in our code a procedure to evaluate the contributions to the error matrix from both statistical and systematic errors . for what concerns statistical errors ,",
    "we have taken into account the contribution from the limited statistics of the observed data sample as well as the contribution from the finite statistics of the monte carlo sample used to evaluate the smearing matrix .",
    "systematic errors arise from the limited knowledge of the irf , and are evaluated assuming an energy uncertainty depending logarithmically on the observed energy , that changes from @xmath23 below @xmath24 to @xmath25 at @xmath26 and to @xmath27 above @xmath28 .",
    "the full covariance matrix among unfolded points must be used when the unfolded flux has to be fitted with some parametric function  @xcite .",
    "in this section the results obtained applying the unfolding procedure to simulated data sets will be discussed .",
    "simulations have been performed using the _ fermi _ simulation toolkit _",
    "gtobssim_.       region around the 3c454.3 simulated source.,width=283 ]     and an outer radius of @xmath29 , are scaled for the solid angle and live time ratios , and are then subtracted from the counts in the analysis roi.,width=283 ]    a steady point source has been simulated in the 3c454.3 sky position @xmath30 .",
    "the source has been simulated for a total time of @xmath31 , assuming a power law spectrum given by : @xmath32 where @xmath33 is the scale energy .",
    "the spectral index value is @xmath34 and the value of @xmath35 has been chosen to have a flux above @xmath24 of @xmath36 .",
    "both galactic and extragalactic background components have been included in the simulation and the true lat pointing history has been used .",
    "error regions are also shown.,title=\"fig:\",width=283 ]   error regions are also shown.,title=\"fig:\",width=283 ]    fig .",
    "[ fig : map3c ] shows the photon count map in a @xmath29 region centered on the position of the simulated source .",
    "since the source is far away from the galactic plane , the background is nearly isotropic and can be safely evaluated from real data .",
    "the analysis of the 3c454.3 point source has been performed selecting photons in the roi given by eq .",
    "[ eq : psf ] and evaluating the background in an annulus with an inner radius of @xmath37 and an outer radius of @xmath29 . in fig .",
    "[ fig : counts3c ] the observed energy spectrum is shown together with the background energy spectrum .",
    "the signal spectrum is obtained after subtracting the background spectrum from the observed one , after proper normalization .    in fig .  [",
    "fig : pointing3c ] it is shown the expected angular distribution in the instrument coordinates ( @xmath38 and @xmath39 ) of the photons expeted from the 3c454.3 simulated source . the distribution has been built using the information from the spacecraft pointing history .",
    "as it is evident from the figure , the instrument coordinate phase space is not uniformly populated .",
    "this behaviour is due to the relative motion of the satellite with respect to the source , and is taken into account when calculating the smearing matrix .",
    "the region @xmath40 is empty because of the angular selection cut illustrated in section  [ sec : evesel ] .",
    "region around the vela simulated source.,width=283 ]    fig .",
    "[ fig : eff3c].a shows the smearing matrix evaluated for the simulated 3c454.3 point source , using the procedure described in section  [ sec : sm ] . in fig .",
    "[ fig : eff3c ] the effect of energy dispersion is clearly evident . if there were no energy dispersion , the smearing matrix would be diagonal ; the presence of energy dispersion implies off - diagonal terms in the smearing matrix . in fig .",
    "[ fig : eff3c].b it is shown the efficiency as a function of the true energy , evaluated according eq .",
    "[ eq : eff ] .",
    "the efficiency increases with energy reaching a maximum of about @xmath41 at a few tens of @xmath4 and drops at @xmath42 at larger energies .",
    "[ fig : unfo3c ] shows the energy spectrum of the simulated 3c454.3 source reconstructed with the unfolding procedure .",
    "the meaured flux above @xmath24 is of @xmath43 and is consistent with the true value .",
    "the unfolded spectrum has been also fitted with the function of eq .",
    "[ eq : spl ] using the covariance matrix provided by the spectral reconstruction algorithm .",
    "the fit parameters are @xmath44 and @xmath45 , corresponding to a flux above @xmath24 of @xmath46 , that is still consistent with the input value .",
    "a pulsar has been simulated in the vela sky position @xmath47 .",
    "the source has been simulated for @xmath31 , assuming a pulsed spectrum given by : @xmath48 where @xmath33 is the scale energy .",
    "the spectral index value is @xmath49 , the cutoff energy is @xmath50 and the value of @xmath35 has been chosen to have a flux above @xmath24 of @xmath51 .",
    "the scale energy @xmath52 has been set to @xmath53 .",
    "galactic and extragalactic background components have been included in the simulation and the true lat pointing history has been used .",
    "a custom light curve has been used to simulate pulsed emission for a @xmath54 fraction of the total phase interval .     to @xmath55.,width=283 ]    , and are then subtracted from the on - pulse counts.,width=283 ]    fig .",
    "[ fig : mapvela ] shows the photon count map in a @xmath29 region centered on the position of the simulated source . in this case",
    "the source lies on the galactic plane and the background is not isotropic .",
    "however , since we are intersted in the study of the pulsed component of the spectrum , this is not an issue . in fig .",
    "[ fig : lightcurve ] it is shown the light curve obtained selecting photons in the analysis roi of eq .",
    "[ eq : psf ] .",
    "the off - pulse window is defined as the phase interval from @xmath56 to @xmath55 .",
    "the analysis of the vela point source has been performed selecting photons in the roi given by eq .",
    "[ eq : psf ] , with arrival times in the on - pulse window .",
    "[ fig : countsvela ] shows the observed spectrum together with the background spectrum , that is obtained selecting off - pulse photons .",
    "the signal spectrum is evaluated subtracting the off - pulse counts rescaled for the phase ratio @xmath57 to the on - pulse ones .",
    "error regions are also shown.,title=\"fig:\",width=283 ]   error regions are also shown.,title=\"fig:\",width=283 ]    fig .",
    "[ fig : unfovela ] shows the pulsed energy spectrum of the simulated vela source reconstructed with the unfolding procedure .",
    "the meaured flux above @xmath24 is of @xmath58 and is in agreement with the true value .",
    "the unfolded spectrum has been also fitted with the function of eq .",
    "[ eq : ec ] .",
    "the fit parameters are @xmath59 , @xmath60 and @xmath61 , corresponding to a flux above @xmath24 of @xmath62 , that is consistent with the input value .",
    "we have developed a method to reconstruct the energy spectra of both steady and pulsating point sources detected by the _ fermi _",
    "lat , based on a bayesian unfolding technique .",
    "this analysis technique , that takes into account the energy dispersion introduced by the detector and allows to reconstruct the spectra without the need of assuming any parametric model , has been successfully tested with simulated data sets .",
    "if an unfolded spectrum needs to be interpreted in the framework of a given model , it can be easily fitted with any function , taking into account the full covariance matrix , that is evaluated at the end of the unfolding procedure , and that includes both statistical and systematic uncertainties .",
    "the _ fermi _ lat collaboration acknowledges support from a number of agencies and institutes for both development and the operation of the lat as well as scientific data analysis .",
    "these include nasa and doe in the united states , cea / irfu and in2p3/cnrs in france , asi and infn in italy , mext , kek and jaxa in japan , and the k.  a.  wallenberg foundation , the swedish research council and the national space board in sweden . additional support from inaf in italy for science analysis during the operation phase is also gratefully acknowledged ."
  ],
  "abstract_text": [
    "<S> the large area telescope ( lat ) onboard the _ fermi _ satellite is observing the gamma - ray sky in the high energy region , above @xmath0 . </S>",
    "<S> we have developed a method to reconstruct the energy spectra of the gamma - rays detected by the fermi lat instrument based on a bayesian unfolding approach , that takes into account the energy dispersion introduced by the instrument response . </S>",
    "<S> the method has been successfully applied to reconstruct the energy spectra of both steady and pulsating point sources . </S>",
    "<S> the analysis technique will be illustrated and the results obtained in some significant test cases will be discussed . </S>"
  ]
}