{
  "article_text": [
    "cosmic rays were discovered more than one century ago .",
    "one remarkable feature of the cosmic ray spectrum is that it spans more than ten orders of magnitude , up to hundreds of eev ( 1 eev @xmath0 ev ) .",
    "the spectrum roughly follows an inverse power law , which means that the expected flux of particles at the highest energies is extremely low compared to the lower energies .",
    "in fact , at energies of a few eev , only one particle per square kilometer per year is expected .",
    "particles with energies @xmath1 1 eev are referred to as ultra - high energy cosmic rays .",
    "some experiments , such as the pierre auger observatory and the telescope array project , have been designed to increase the statistics of events in this energy range . despite the improved statistics , questions pertaining to the origin , nature and mechanisms of acceleration of these particles ,",
    "remain unanswered .    due to the presence of galactic and extragalactic magnetic fields ,",
    "charged cosmic rays are expected to be deflected .",
    "hence , incoming directions , as measured by a detector , do not point back to the exact position of the source .",
    "the magnitude of the deflection depends on the strength of the intervening fields . in the case of charged particles",
    "the deflections are roughly inversely proportional to the particle energy .",
    "therefore , for coherent fields , the different larmor radii described by cosmic rays can create filamentary structures ordered by energy , known as multiplets .",
    "this allows the reconstruction of the source position , and consequently enhances the possibility to do astronomy with uhecrs .    in this paper",
    "we propose a new method of identifying multiplets , based on the spherical wavelet transform .",
    "the paper is organized as follows : in section [ physics ] , we review the physics underlying multiplets ; in section [ sec::swt ] we present the wavelet transform from a pattern matching algorithm point of view , and give motivations for its use in cosmic ray physics ; in section [ sec::theory ] we present a novel algorithm to identify filamentary structures in cosmic ray maps ; in section [ sec::analysis ] the method is applied to simulated data sets ; in section [ sec::results ] , we present our results ; in section [ sec::conclusion ] we make our final remarks .",
    "several results show that at ultra - high energies the cosmic ray spectrum contains atomic nuclei .",
    "data from the high resolutions fly s eye experiment ( hires ) indicate that uhecrs are probably protons @xcite , whereas the results from the pierre auger observatory indicate that the composition tends to heavy nuclei at the highest energies @xcite . despite this controversy",
    ", one can consider that uhecrs are predominantly charged particles and , as such , can be deflected by magnetic fields .",
    "the deflection expected for a uhecr of charge @xmath2 due to the regular component of the galactic magnetic field ( gmf ) is given approximately by @xcite : @xmath3 where @xmath4 is the energy of the particle , @xmath5 the magnetic field , and @xmath6 the travel distance of the particle .",
    "since @xmath7 g and is coherent over lengths of @xmath8 10 kpc , typical deflections are @xmath8 10@xmath9 for protons of 10 eev .",
    "the expected deflection due to the turbulent component is @xcite : @xmath10 where @xmath11 is the root mean square intensity of the magnetic field and @xmath12 is its coherence length .    according to equation ( [ eq : deflec ] ) the deflection is inversely proportional to the energy of the particle .",
    "therefore it is possible that energy ordered filamentary structures , the so - called multiplets , can be detected in cosmic ray maps as shown in figure [ fig::sphere ] .",
    "another method to detect filamentary structures in the arrival directions distributions of uhecrs was proposed by harari _",
    "et al._@xcite .",
    "an interesting property of the multiplets is that the position of the source can be reconstructed , allowing one to identify uhecrs sources .",
    "a method to reconstruct the source position of a multiplet was presented by golup _",
    "_ @xcite and was used by the pierre auger collaboration to estimate the position of the sources for some possible multiplet candidates @xcite . in the aforementioned work ,",
    "no statistically significant evidence for multiplets arising from magnetic deflections was found for energies above 20 eev .",
    "it is important to notice that for some models of the galactic magnetic fields such as the ones proposed by @xcite cosmic ray multiplets can be formed , whereas in other models such as the one recently proposed by @xcite they are less likely to occur , due to the strength of the field , especially the turbulent component .",
    "the role played by extragalactic magnetic fields in the deflection of uhecrs is not fully understood . simulations of the propagation of uhe particles in the large scale structure of the universe have been performed by several groups @xcite .",
    "however , these results are contradictory and one can not obtain a clear picture of the effects of the extragalactic magnetic field for the deflection of uhecrs .",
    "in many branches of physics , particularly astrophysics and cosmology , wavelets have been successfully applied to solve various problems , particularly related to detection of signals .",
    "wavelets on the plane have been widely used to denoise cosmic microwave background ( cmb ) maps @xcite . however , the problem of identifying anisotropies in the distribution of arrival directions of uhecrs has not been properly addressed , and only a few works @xcite on this topic are available in the literature .",
    "wavelets are commonly used in one and two dimensional data analysis , but in recent years the interest in data lying on the sphere has increased .",
    "this is due to experiments such as the cosmic background explorer ( cobe ) , the wilkinson microwave anisotropy probe ( wmap ) , the planck satellite and the pierre auger observatory , which make use of these kinds of data .",
    "the need to process these data sets drove the interest on new techniques , such as wavelets , under active development .",
    "many interesting applications of spherical wavelets can be found in @xcite .",
    "wavelets can be particularly useful for cosmic ray data analysis , where we usually have to deal with a non uniform exposure .",
    "they are also useful to search for local structures in the sky , with a defined position , such as point sources , and possibly an orientation , such as multiplets .",
    "an event by event analysis is not viable , and the analysis in harmonic space would be even harder since all local properties are lost .",
    "spherical wavelets come up as a good alternative to address these problems . other attractive features of wavelet analysis are :    * any function can be exactly represented by its wavelet coefficients ; * local features of the signal can be enhanced in the wavelet domain , meaning that the number of coefficients needed to represent a given signal is reduced ; * it provides scale decomposition , making it possible to identify structures with different angular sizes and focus on the resolution of interest in the signal ; * it does not rely on any tangent plane approximation , in the case of wavelets on the sphere .",
    "data representation in wavelet domain can be thought as something between pixel and harmonic representation .",
    "sometimes it is very convenient to decompose the data to enhance properties that are not clear in harmonic or pixel domain .",
    "wavelets can be interpreted as local analysis functions which can be rotated and/or dilated , to obtain information regarding the signal morphology .      in this subsection",
    "we show that the problem of finding a multiplet , or any other pattern defined on the sphere , can be treated by the fast rotational matching algorithm @xcite .",
    "let @xmath13 and @xmath14 be two functions defined on the sphere .",
    "assume that @xmath15 is a rotated version of @xmath16 , such that @xmath17 , with @xmath18 , @xmath19 and @xmath20 being euler angles , and @xmath21 denoting the rotation operator in @xmath22 .",
    "if we know that a rotated version of the pattern @xmath16 is present in @xmath15 , we can find its latitude , longitude and orientation on the sphere by correlating all rotated versions of @xmath16 with @xmath15 , and selecting the rotation which maximizes the correlation @xmath23 we can parametrize the rotations in terms of euler angles . in this case the correlation function can be denoted by @xmath24 . in other words , we want to find the angles @xmath18 , @xmath19 and @xmath20 for which @xmath25 is maximum .",
    "the straightforward evaluation of @xmath25 is very time - consuming and not affordable depending on the precision we are using to describe our signal . denoting the band - limit of the signal by @xmath26 , the complexity of equation ( [ corr ] ) is @xmath27 .",
    "this complexity can be reduced to @xmath28 by calculating the correlation in the harmonic domain .",
    "so , we can write the spherical harmonic expansions of @xmath16 and @xmath15 as @xmath29 with @xmath30 being spherical harmonics . using these expansions we can show ( see ref .",
    "@xcite for more details ) that the correlation function ( [ corr ] ) can be cast as @xmath31 where @xmath32 denotes the wigner - d functions and @xmath33 the small wigner - d functions .",
    "this algorithm is called _ fast rotational matching _ , abbreviated to frm .",
    "it uses the fast fourier transform ( fft ) on both @xmath18 and @xmath20 to calculate equation [ cc ] . depending on the tessellation chosen",
    ", the fft can be extended to the @xmath19 coordinate @xcite .",
    "this approach to find a multiplet may not be an option because we do not know exactly the pattern @xmath13 that describes the multiplet .",
    "moreover , for angular resolutions corresponding to a band limit higher than @xmath34 , too much memory would be required . for @xmath35 , for example , approximately 4.5 gb of ram would be necessary in our implementation .    in the next subsection",
    "we show that the difficulties mentioned above can be overcome by using a special family of directional wavelets instead of the pattern itself .    .",
    "]      when the function @xmath16 from equation [ eq::sph ] is a wavelet , and @xmath15 is the signal of interest , equation [ corr ] is the definition of the forward spherical wavelet transform , and the correlation function can be interpreted as the wavelet representation of the signal @xmath15 .",
    "the wavelets used in this work are defined in the harmonic domain .",
    "their harmonic representation has the special property of allowing them to be split into a kernel and a directional part @xmath36 where the kernel @xmath37 is responsible for dilations and @xmath38 is responsible for the directional properties of the wavelets .",
    "this split ensures that dilations do not affect directional properties , so that these two parts can be treated independently .",
    ".first column : scale @xmath39 .",
    "second column : wavelet support .",
    "third column : angular sizes in degrees for which the wavelet is sensitive .",
    "fourth column : maximum precision on the angular variables in degrees . [ cols=\"^,^,^,^\",options=\"header \" , ]     [ table ]    the kernel @xmath37 at each scale @xmath39 has zero values at frequencies outside the range @xmath40 , where @xmath41 is the total number of scales .",
    "this interval is usually referred to as the wavelet support .",
    "the support is related to the frequencies to which the wavelets are sensitive . for a graphical representation see figure [ fig::kernel ] .",
    "it is interesting to notice in this figure that an adequate choice of @xmath39 can suppress some values of @xmath42 , making this method powerful even when we consider the exposure of a detector , which is usually associated with low values of @xmath42 .    in our implementation",
    ", for a given band limit @xmath26 , the number of scales @xmath41 in the wavelet analysis is given by @xmath43 .",
    "since we have used @xmath35 , then @xmath44 . for a physical interpretation , however , it is simpler to think in terms of angular sizes . for that",
    ", we can convert the frequency range into angular sizes using the formula @xmath45 , where @xmath42 is the frequency we are interested in . in table",
    "[ table ] the angular size to which each scale is sensitive is shown .",
    "the sensitivity of the wavelet in finding the angle @xmath20 can be controlled by imposing a band limit on @xmath38 . denoting this band limit by @xmath46 , then @xmath47 for all @xmath48 .",
    "if the directional features of the signal are not relevant for the analysis , low values of @xmath46 , such as @xmath49 , can be used .",
    "the maximum value of @xmath46 at scale @xmath39 is given by @xmath50 .",
    "the precision of the orientation for a given @xmath46 is given by @xmath51 .",
    "in this work , we have used @xmath52 , shown in figure [ fig::wav - show ] , which gives a precision @xmath53 degrees .",
    "this value is a good compromise between computational resources and the required precision .",
    "we have developed an algorithm that uses spherical wavelets to identify and locate filaments in maps containing arrival directions of uhecrs .",
    "the algorithm is described below .    1 .   from a set of events ,",
    "calculate the function @xmath14 that represents the signal .",
    "this involves choosing a tessellation for the sphere , and counting the total number of events contained in each pixel in the sky .",
    "2 .   calculate the fourier expansion of @xmath14 , resulting in the coefficients @xmath54 ( see equation [ eq::sph ] ) .",
    "3 .   choose the appropriate wavelet .",
    "for the family of wavelets used , this involves choosing three parameters , the maximum scale @xmath41 , the scale at which the analysis is performed @xmath39 and the azimuthal band limit , controlled by the parameter @xmath46 .",
    "ideally , the angular size of the wavelet will match the size of the multiplet .",
    "this choice relies on [ table ] .",
    "4 .   calculate @xmath55 from equation ( [ cc ] ) .",
    "5 .   select all @xmath56 such that @xmath57 , where @xmath58 , is threshold value .",
    "select the events at each location @xmath56 ( see section [ sec::selecting ] ) .",
    "this will result in @xmath59 groups of events .",
    "discard all groups of events for which @xmath60 , where @xmath61 is the number of events in the group , and @xmath62 is a threshold value .",
    "8 .   for each group of events ,",
    "calculate the correlation @xmath63 of the graph @xmath64 ( see equation [ corr_corr ] ) .",
    "accept as a multiplet candidate all groups for which @xmath65 , where @xmath66 is a threshold value .",
    "( see section [ sec::selecting ] )      to carry out all steps of this algorithm one needs to establish three threshold values : the wavelet threshold @xmath58 used in step @xmath67 , the minimum number of events @xmath62 , used in step @xmath68 , and the minimum correlation @xmath66 , used in step @xmath69 .    to calculate the thresholds , we have used simulated sky maps containing arrival directions of events isotropically distributed .",
    "no magnetic fields are considered in this case , so that if a multiplet is identified by our method , it certainly happened by chance .",
    "this allows us to establish the threshold values @xmath58 , @xmath66 , and @xmath62 by using the algorithm previously presented in section [ sec::theory ] .",
    "to estimate @xmath66 we use m simulations of isotropic skies , where each simulated sky follows the same injection spectrum and exposure as the data that is being analysed .",
    "@xmath70 is the largest wavelet coefficient obtained for each realization @xmath71 , according to step @xmath67 of the algorithm .    by selecting only one value of @xmath25 for each realization",
    ", we have a single correlation coefficient @xmath72 for each of the simulated isotropic skies , calculated at step @xmath73 of the algorithm .    from @xmath74 wavelet coefficients @xmath70 and correlations @xmath72 , we choose @xmath75 where @xmath76 and @xmath77 denote the average values over @xmath74 realizations , and @xmath78 and @xmath79 their respective standard deviations .",
    "the numbers @xmath80 and @xmath81 are chosen according to the error the user is willing to accept . in this work",
    "we set @xmath82 and @xmath83 .",
    "the threshold value for the number of events in the multiplet , @xmath62 , is chosen depending on the specific problem . in this analysis , for example",
    ", we have chosen @xmath84 , following ref .",
    "@xcite .      to select events around the position where a wavelet has a high magnitude we need the euler angles @xmath18 and @xmath19 , to provide a location in the sky , and the angle @xmath20 , to provide an orientation .",
    "a multiplet can , in principle , describe an arbitrary curve on the celestial sphere , depending on the intervening magnetic fields . to be general for all possible shapes",
    "we have used small segments as shown on figure [ fig::plane ] .",
    "each segment should be small enough so that the curve described by the events is approximately a straight line inside the segment .    a small deflection angle ( @xmath85 )",
    "can be written as @xmath86 , which in spherical coordinates takes the form @xmath87 with @xmath88 being the linear distance over the surface of a sphere of radius @xmath89 .",
    "now we note that the unit vectors @xmath90 and @xmath91 , which point in the direction where @xmath18 and @xmath19 vary , are orthogonal and span the plane tangent to the sphere at @xmath92 . using equation [ displacement ]",
    "we can write a displacement vector , tangent to that point as @xmath93 it is convenient to write @xmath94 in terms of @xmath95 , aligned with the wavelet , and @xmath96 , which is perpendicular to it .",
    "these vectors are related to @xmath90 and @xmath91 by a rotation of an angle @xmath20 in the tangent plane , as shown below : @xmath97 we can now cast equation [ d ] as @xmath98 where @xmath99     are the euler angles associated with the multiplet . ]    with equations [ distance2 ] and [ distance1 ] , we can select events in the sky at the position of maximum wavelet coefficient . the only information required",
    "are the euler angles @xmath18 , @xmath19 , and @xmath20 , since @xmath100 for the celestial sphere .",
    "to simulate both the background and the events belonging to the multiplet , we have used the software crpropa @xcite .",
    "protons were injected following a typical @xmath101 spectrum , for @xmath102 eev .",
    "the effective detector size is a sphere of diameter 1 mpc , and the source was assumed to be in our local universe , at a distance of 30 mpc from the detector .",
    "if the events reach the sphere , a flag  detected \" is raised .",
    "otherwise , the events are rejected . with these settings",
    "we achieve an angular resolution of @xmath103 1.9@xmath9 .    for the isotropic data sets",
    ", the events were simulated in random positions of the sky .",
    "we have divided our analysis in two parts .",
    "first we analyze an isotropic distribution of events to establish the thresholds , as explained in section [ sec::thresholds ] . in the second part of the analysis we used a simulated multiplet composed of 10 events , embedded in the same isotropic",
    "datasets previously used .",
    "we have chosen 10 events based on @xcite , where 10 is the lower number of events found on a multiplet .",
    "the multiplet was simulated in the same direction each time , since by spherical symmetry the simulation is unchanged if both the source position and the magnetic field are rotated by the same angle .",
    "on the other hand , keeping the magnetic field constant and varying the source position could be a source of confusion , since the perpendicular component of the magnetic field would also vary , resulting in different multiplets each time .",
    "in the special case where event trajectories are parallel to the magnetic field , the analysis is pointless , since no multiplet is formed .",
    "the multiplet formation was induced by an uniform magnetic field of 1 ng oriented in the @xmath104 direction . nevertheless , the results are totally independent of the method used to generate the multiplets , since it depends only on the position of the events , and on the energy- deflection correlation .",
    "the number of isotropic events range between 100 and 1000 events , in steps of 100 , and a total of 1000 realizations for each of these values .",
    "the multiplet embedded in one of the isotropic skies containing 1000 isotropically distributed events can be seen in figure [ fig::sim - mult ] .",
    "the simulated multiplet has a correlation coefficient @xmath105 when no background is present .",
    "@xmath63 corresponds to the pearson s coefficient of the @xmath106 graph , given by : @xmath107    the scale at which we performed the analysis was chosen based on table [ table ] . at scales @xmath108 and @xmath109 the angular size of the wavelet is close to what we would expect for a multiplet similar to the simulated one , i.e. @xmath110 . since at scale @xmath111 the maximum precision of the angular variable is @xmath112 , we have used @xmath108 for the analysis .",
    "the size of the segments are @xmath110 , to match the dimensions of the wavelet .",
    "in this section we present the results of the proposed algorithm , when applied to the simulations .    since the magnitude of the wavelet coefficients",
    "are used to select directions of interest in sky maps , i.e. euler angles , establishing the wavelet coefficient threshold is a crucial part of the analysis .",
    "the wavelets should have enough sensitivity to distinguish the cases of interest ( isotropic data sets with an embedded multiplet and without it ) .",
    "figure [ fig::magnitude ] shows the average values of the magnitude of the largest wavelet coefficients found in each realization , for the two data sets .",
    "the error bars are the standard deviation of the 1000 realizations of isotropic skies . in this particular case , for a multiplet composed of 10 events , the error bars start overlapping at around 1000 events , which corresponds to a fraction of events from the multiplet with respect to the background of @xmath113 .",
    "the correlation coefficient is the main observable to properly characterize a multiplet . in this analysis",
    "we have used @xmath114 , which means that a candidate will only be considered a multiplet if it is composed by , at least , 10 events .",
    "we also have to determine the value of @xmath66 , which is the value of the threshold correlation coefficient .",
    "it is expected that the greater the number of isotropically distributed events , which corresponds to the background , the smaller the correlation coefficient .",
    "this is corroborated by figure [ fig::correlation ] , which shows that the correlation coefficient monotonically decreases for larger number of background events , indicating a contamination of the multiplet by the background .",
    "this allows us to establish a threshold value for the correlation coefficient . for 1000 isotropic events the lowest value of @xmath66 considered is @xmath115 , according to equation [ eq::thresholds ] .",
    "it is important to address the questions related to the probability of the algorithm finding a multiplet with @xmath116 in a given data set , when no multiplets are known to be present ( type ii error ) , and the probability of a multiplet having @xmath117 if it is known to be present in the data ( type i error ) . in the isotropic simulations , no multiplets",
    "with @xmath118 were identified for a fraction of events equal to @xmath119 , implying that the maximum type ii error of the method is @xmath120 .",
    "figure [ fig::compare ] shows the type i error introduced by our method .",
    "it is worth mentioning that for the most conservative case , which has the lowest fraction of number of events of the multiplet with respect to the number of events of the background , the type i error introduced by using a threshold value @xmath115 is approximately 25% , whereas for the least conservative case it is around 2% . for a high threshold value such as @xmath121 ,",
    "this error is of the order of 30% for the most conservative case .",
    "it is important to stress that the estimated type i and ii errors depend on the confidence interval adopted , set by the parameters @xmath80 and @xmath81 .",
    "( type i error ) when the multiplet is known to be present in the data set .",
    "each curve corresponds to a different fraction of events of the multiplet with respect to the isotropic background . ]",
    "we have developed a wavelet based analysis method to identify multiplets in maps containing arrival directions of uhecrs .",
    "we have illustrated the method by applying it to a hypothetical scenario with a uniform magnetic field of 1 ng , considering several fractions of events from the multiplet with respect to the background , down to a fraction of @xmath119 .",
    "all the parameters used in this study are rather arbitrary .",
    "these choices were made to illustrate the method , and not to evaluate its overall performance .",
    "the observables used to accept or reject the multiplet candidate were the magnitude @xmath25 of the wavelet coefficient at the multiplet location @xmath122 , the correlation @xmath63 of the deflection versus inverse of the energy graph and the total number of events in the multiplet @xmath62 .",
    "the efficiency of the method was assessed by comparing the analysis when applied to isotropically distributed events with and without an embedded multiplet .",
    "the probability of wrongly accepting a candidate multiplet with a correlation coefficient @xmath63 above the threshold value @xmath123 is below @xmath120 .",
    "the probability of wrongly rejecting a candidate multiplet , when it is known to be present in the data , is in the most conservative case , approximately 30% .",
    "this value goes down to 3% by decreasing the number of isotropic events in the data set . for the adopted correlation coefficient threshold , these values are , respectively , 25% and 2% .",
    "even though we have assumed a uniform detector exposure for the analysis previously presented , the results also hold for a non uniform exposure , since the ideal parameters for a multiplet search in the wavelet analysis suppress low frequency modes that could be related to the coverage of the cosmic ray detector .",
    "the only caveat is that , in this case , the comparison data sets should follow an isotropic distribution modulated by the exposure of the detector .",
    "the method is focused on the search of multiplets , but it can be adapted for generic application to related problems in astrophysics , particularly the ones involving the search of filamentary structures in sky maps .",
    "all results showed in this paper can be easily reproduced with the software swat ( spherical wavelet analysis tool ) , developed by the authors of this paper . in case of interest in the code , please contact us .",
    "the authors wish to thank the pierre auger group of the university of wuppertal ( uw ) , where part of this work has been written , and part of the simulations done , and specially to nils nierstenhfer for the valuable help with the simulations .",
    "we would also like to thank fundao de amparo  pesquisa do estado de so paulo ( fapesp ) for the financial support through grants 2010/07359 - 6 and 2010/04743 - 0 .",
    "part of the simulations were performed in the computational system available at instituto de fsica de so carlos , universidade de so paulo ( ifsc - usp ) , granted by fapesp ( 2008/04259 - 0 ) .",
    "this project was also supported by coordenao de aperfeioamento de nvel superior ( capes ) ."
  ],
  "abstract_text": [
    "<S> due to the action of the intervening cosmic magnetic fields , ultra - high energy cosmic rays ( uhecrs ) can be deflected in such a way as to create clustered energy - ordered filamentary structures in the arrival direction of these particles , the so - called multiplets . in this work </S>",
    "<S> we propose a new method based on the spherical wavelet transform to identify multiplets in sky maps containing arrival directions of uhecrs . </S>",
    "<S> the method is illustrated in simulations with a multiplet embedded in isotropic backgrounds with different numbers of events . </S>",
    "<S> the efficiency of the algorithm is assessed through the calculation of type i and ii errors .    </S>",
    "<S> [ firstpage ]    spherical wavelets , ultra - high energy cosmic rays , cosmic magnetic fields , multiplets </S>"
  ]
}