{
  "article_text": [
    "the euclidean algorithm is the process of comparison of commensurable magnitudes and the modular group @xmath0 is an encoding of this algorithm . since the intellect is ultimately about comparison of magnitudes , it should come as no surprise that the modular group manifests itself in diverse contexts through its action on mathematical objects , no matter what our level of abstraction is . among all manifestations of @xmath0",
    "the following four classical actions are of fundamental nature :    * its left - action on the infinite trivalent plane tree , * its left action on the upper half plane @xmath1 by mbius transformations , * its right - action on the binary quadratic forms , and * its left - conjugation action on itself .",
    "our aim in this paper is to clarify the connections between these four actions .",
    "see @xcite for an overview of the related subjects from a wider perspective .",
    "in particular , the actions in consideration will play a crucial role in observing non - trivial relations between teichmller theory and arithmetic .",
    "such a point of view will be taken in a forthcoming paper where we construct a global groupoid whose objects are ( roughly speaking ) all ideal classes in real quadratic number fields and morphisms correspond to basic graph transformations known as flips . and",
    "this work can also be considered as an introduction to this upcoming work .",
    "let us turn back to our list of actions .",
    "the first one is transitive but not free on the set of neither edges nor vertices of the tree in question . in order to make it free on the set of edges , we add the midpoints as extra vertices thereby doubling the set of edges and call the resulting infinite tree the _ bipartite farey tree @xmath2_. the modular group action is still transitive on the edge set of @xmath2 . now since @xmath0 acts on @xmath2 by automorphisms ; freely on the set of edges of @xmath2 , so does any subgroup @xmath3 of @xmath0 , and by our definition a _ modular graph _ is simply a quotient graph @xmath4 .",
    "this is almost the same thing as a trivalent ribbon graph , except that we consider the midpoints as extra 2-valent vertices and pending edges are allowed .",
    "modular graphs parametrize subgroups up to conjugacy and modular graphs with a base edge classify subgroups of the modular group .",
    "5.5 cm     4 cm     the second action is compatible with the first one in the following sense : the tree @xmath5 which is built as the @xmath0-orbit of the arc connecting two elliptic points on the boundary of the standard fundamental domain , is a topological realization of the farey tree @xmath2 .",
    "consequently , @xmath6 is a topological realization of the graph @xmath4 , as a graph embedded in the orbifold @xmath7 .",
    "this latter has no orbifold points if @xmath3 is torsion - free but always has punctures due to the parabolic elements of @xmath3 , or it has some boundary components .",
    "these punctures are in one - to - one correspondence with the left - turn circuits in @xmath4 .",
    "widening these punctures gives a deformation retract of the ambient orbifold to the graph , in particular the upper half plane @xmath1 retracts to the farey tree @xmath8 . to recover the orbifold from the modular graph one glues punctured discs along the left - turn paths of the graph .",
    "if @xmath3 is torsion - free of finite index , then @xmath7 is an algebraic curve which can be defined over a number field since it is a finite covering of the modular curve @xmath9 . according to bely s theorem , @xcite , any arithmetic surface",
    "can be defined this way , implying in particular that the action of the absolute galois group defined on the set of finite coverings @xmath10 is faithful . but these coverings are equivalently described by the graphs @xmath4 .",
    "this striking correspondence between combinatorics and arithmetic led grothendieck to study dessins from the point of view of the action of the absolute galois group , see @xcite .",
    "however , explicit computations of covering maps @xmath11 required by this approach turned out to be forbiddingly hard if one wants to go beyond some basic cases and only a few uniform theorems could be obtained .",
    "in fact , dessins are more general graphs that correspond to finite coverings of the thrice punctured sphere , which is equivalent to a subsystem of coverings of @xmath12 since @xmath13 is a degree-6 covering of @xmath12 .",
    "the third action in our list is due to gauss . here",
    "@xmath0 acts on the set of binary quadratic forms via change of variables in the well - known manner .",
    "orbits of this action are called _ classes _ and forms in the same class are said to be _",
    "equivalent_. here we are interested in the action on _ indefinite _ forms .",
    "this action always has a cyclic stabilizer group , which is called the proper automorphism group of the form @xmath14 and denoted @xmath15 .",
    "indefinite binary quadratic forms represent ideal classes in the quadratic number field having the same discriminant as the form and hence are tightly related to real quadratic number fields @xcite .",
    "we provide a succinct introduction to binary quadratic forms later in the paper .",
    "the correspondence between forms and dessins can be described briefly as follows : to an indefinite binary quadratic form @xmath14 we associate its proper automorphism group @xmath15 and to @xmath15 we associate the infinite graph @xmath16 , which is called a _",
    "ark_. via the topological realization of @xmath2 , this is a graph embedded in the annulus @xmath17 . the form @xmath18 corresponding to the matrix @xmath19 is found by homogenizing the fixed - point equation of @xmath20 .",
    "arks are infinite  transcendental \" graphs whereas the dessins literature consider only finite graphs .",
    "(  transcendental \" since they correspond to non - algebraic extensions of the function field of the modular curve ) .",
    "this transcendence implies that arks go undetected in the algebraic fundamental group approach , nevertheless we shall see that this does not keep them away from being arithmetic objects .",
    "equivalent forms have conjugate stabilizers ( automorphism groups ) and conjugate subgroups have isomorphic quotient graphs .",
    "it turns out that the set of classes is exactly the set of orbits of hyperbolic elements of @xmath0 under the fourth ( conjugation ) action in our list .",
    "this set of orbits can be identified with the set of bracelet diagrams with beads of two colors .",
    "in fact , arks can be thought of as @xmath21-quotients of periodic rivers of conway @xcite or graphs dual to the coset diagrams of mushtaq , @xcite . as we shall see later in the paper",
    ", arks provide a very nice reformulation of various concepts pertaining to indefinite binary quadratic forms , such as reduced forms and the reduction algorithm , ambiguous forms , reciprocal forms , the markoff value of a form , etc .",
    "for example , arks of reciprocal classes admit an involutive automorphism , and the quotient graph gives an infinite graph with two pending edges .",
    "these graphs parametrize conjugacy classes of dihedral subgroups of the modular group .",
    "arks also provide a more conceptual way to understand the relation between coset diagrams and quadratic irrationalities and their properties as studied in @xcite or in @xcite .        for us",
    "the importance of this correspondence between arks and forms lies in that it suggests a concrete and clear way to consider modular graphs as arithmetic objects viz .",
    "gauss binary quadratic forms , as it was much solicited by grothendieck s dessins school .",
    "we also would like to remark that the clarity of the graph language provides us with new points of view on the classical and deep questions concerning the behavior of class numbers yet the structure of class groups via such graphs remain meager .",
    "moreover , the second named author , in @xcite , has presented an improvement of the age - old reduction algorithm of gauss and gave an algorithmic solution to the representation problem of binary quadratic forms .",
    "the language of arks might also provide a new insight o the real multiplication project of manin and marcoli , see @xcite .",
    "our computations concerning forms and their reduction are done in pari / gp , @xcite with certain subroutines of our own ( source code is available upon request ) .",
    "it is well known that the two elliptic transformations @xmath22 and @xmath23 , respectively of orders 2 and 3 , generate a group of mbius transformations which is isomorphic to the projective group of two by two integral matrices having determinant @xmath24 , the modular group @xcite .",
    "it is also well - known that @xmath25 .",
    "let us now consider the graph @xmath2 ( the bipartite farey tree ) , given by the following data : @xmath26 where @xmath27    is an edge between a vertex @xmath28 and another vertex @xmath29 if and only if @xmath30 and there are no other edges . thus the edge connecting @xmath31 and @xmath32 _ is _",
    "@xmath33 , if this intersection is non - empty .",
    "observe that by construction the graph is bipartite .",
    "the edges incident to the vertex @xmath34 are @xmath35 , and these edges inherit a natural cyclic ordering from the vertex .",
    "thus the farey tree @xmath2 is an infinite bipartite ribbon graph .",
    "it is a tree since @xmath0 is freely generated by @xmath36 and @xmath37 .",
    "the group @xmath0 acts on @xmath2 from the left , by ribbon graph automorphisms , where @xmath19 acts by @xmath38 notice that the action on the set of edges is nothing but the left - regular action of @xmath0 on itself and therefore is free . on the other hand",
    "the action is not free on the set of vertices : the vertex @xmath39 is fixed by the order-2 subgroup generated by @xmath40 , and the vertex @xmath41 is fixed by the order-3 subgroup generated by @xmath42 .",
    "let @xmath3 be any subgroup of @xmath0 .",
    "then @xmath3 acts on @xmath2 from the left and to @xmath3 we associate a quotient graph @xmath4 as follows :    @xmath43    @xmath44 ;    where @xmath45 , and    @xmath46 .    it is easy to see that the incidence relation induced from the farey tree gives a well - defined incidence relation and gives us the graph which we call a _ modular graph_. thus the edge connecting the vertices @xmath47 and @xmath48 is the intersection @xmath49 , which is of the form @xmath50 if non - empty .",
    "there are no other edges .",
    "observe that by construction the graph is bipartite .",
    "the edges incident to the vertex @xmath51 are @xmath52 , and these edges inherit a natural cyclic ordering from the vertex",
    ". in general @xmath4 is a bipartite ribbon graph possibly with pending vertices that corresponds to the conjugacy classes of elliptic elements that @xmath3 contains .",
    "conversely , any connected bipartite ribbon graph @xmath53 , with @xmath54 , such that every @xmath55-vertex is of degree 1 or 2 and every @xmath56-vertex is of degree 1 or 3 , is modular since the universal covering of @xmath53 is isomorphic to @xmath2 .",
    "it takes a little effort to define the fundamental group of @xmath4 , see @xcite , so that there is a canonical isomorphism @xmath57 , with the canonical choice of @xmath58 as a base edge . in general , subgroups @xmath3 of the modular group ( or equivalently the fundamental groups @xmath59 ) are free products of copies of @xmath21 , @xmath60 and @xmath61 , see @xcite .",
    "note that two distinct isomorphic subgroups @xmath62 , @xmath63 of the modular group may give rise to non - isomorphic ribbon graphs @xmath64 and @xmath65 .",
    "we shall see shortly that arks constitute good examples of this phenomena .",
    "in other words , the fundamental group does not characterize the graph .",
    "another basic invariant of @xmath4 is its genus , which is defined to be the genus of the surface constructed by gluing discs along left - turn paths .",
    "this genus is the same as the genus of the riemann surface @xmath66",
    ".    6 cm    [ scale=1.1 ] ( 0,0) ( 0,2) ( 4,0) ( 0,0 ) ; ( 0,0) ( 0,2) ( 4,0) ( 0,0 ) ; ( 0,0 ) circle ( 0.8 mm ) ; ( 0,0 ) circle ( 0.8 mm ) ; at ( 0,0 ) @xmath67 ; ( 4,0 ) circle ( 0.8 mm ) ; ( 4,0 ) circle ( 0.8 mm ) ; ( 0,2 ) circle ( 0.8 mm ) ; ( 0,2 ) circle ( 0.8 mm ) ; ( -0.05,1) ( -0.25,1 ) ; at ( -0.25,0.99 ) @xmath68 ; at ( 0.25,1)[rotate=90 ] ; at ( -0.75,1)[rotate=0 ] ; at ( -0.75,0.75)[rotate=0 ] ; ( 2,-0.05) ( 2,-0.25 ) ; at ( 2,-0.25)[rotate=90 ] @xmath68 ; at ( 2,-0.5)[rotate=0 ] ; ( 2.05,1) ( 2.2,1.3 ) ; at ( 2.2,1.3 ) [ rotate=70]@xmath69 ; at ( 2.25,1.5)[rotate=-30 ] ;    6 cm    [ scale=1.1,dash pattern = on 2pt off 1pt ] ( -0.5,0 ) rectangle ( 0.5,2 ) ; ( 0:0 cm ) circle ( 1 cm ) ; ( -2,0) ( 2,0 ) ; ( -0.5,0) ( -0.5,2 ) ; ( 0.5,cos30) ( 0.5,2 ) ; ( -0.5,cos30) ( -0.5,2 ) ; ( 0.5,0) ( 0.5,2 ) ; ( 0,1) ( 0,2.5 ) ; at ( 0,2.5)[rotate=-90 ] @xmath68 ; ( 1,0 ) arc ( 0:180:1 ) ; at ( -0.5,-0.2 ) @xmath70 ; at ( 0.5,-0.2 ) @xmath71 ; ( 0,1 ) circle ( 0.75 mm ) ; ( cos60,sin60 ) circle ( 0.75 mm ) ; ( cos60,sin60 ) circle ( 0.75 mm ) ; ( -cos60,sin60 ) circle ( 0.75 mm ) ; ( -cos60,sin60 ) circle ( 0.75 mm ) ; ( 0,1 ) circle ( 0.75 mm ) ; at ( 0,1 ) @xmath67 ; ( cos60,sin60 ) circle ( 0.75 mm ) ; ( -cos60,sin60 ) circle ( 0.75 mm ) ;    the set of edges of @xmath4 is identified with the set of right - cosets of @xmath3 , so that the graph @xmath4 has @xmath72 $ ] many edges . in case @xmath3",
    "is a finite index subgroup , the graph @xmath4 is finite . in case @xmath73 ,",
    "the quotient graph @xmath74 is a graph with one edge that looks like as follows :    @xmath75    we call this graph the _",
    "modular arc_. it is a graph whose fundamental group is @xmath0 and whose universal cover is the farey tree @xmath2 . in other words",
    "modular graphs are coverings of the modular arc .",
    "if we consider the action of the modular group on the topological realization @xmath8 of @xmath2 mentioned in the introduction , the topological realization of @xmath76 is the arc @xmath77 in the modular curve connecting two elliptic points .",
    "every modular graph @xmath78 has a canonical  analytical \" realization @xmath79 on the riemann surface @xmath80 with edges being geodesic segments .",
    "equivalently , these edges are lifts of the modular arc by @xmath81 .",
    "if instead we lift the geodesic arc connecting the @xmath55- elliptic point to the cusp to the surface @xmath80 , then we obtain another graph on the surface , which is called an _",
    "ideal triangulation_. lifting the remaining geodesic arc gives rise to yet another type of graph , called a _",
    "lozenge tiling_. so there is a triality , not just duality , of these graphs , see figure  [ fig : triality ] in which the bold figures represent the members of the triality .    3 cm     3 cm     3 cm     in topology , there is a well - known correspondence between subgroups of the fundamental group of a space and the coverings of that space .",
    "the following two results are orbifold ( or  stacky \" ) analogues of this correspondence for coverings of the modular curve , stated in terms of graphs . for more details on fundamental groups and covering theory of graphs",
    "see @xcite .",
    "if @xmath62 and @xmath63 are conjugate subgroups of @xmath0 , then the graphs @xmath64 and @xmath65 are isomorphic as ribbon graphs . hence there is a 1 - 1 correspondence between modular graphs and conjugacy classes of subgroups of the modular group .",
    "[ conjugatesubgroups ]    let @xmath82 .",
    "the desired isomorphism is then the map @xmath83 note that one has @xmath84 .",
    "suppose now that @xmath85 is a ribbon graph isomorphism and let @xmath84 .",
    "this induces an isomorphism of fundamental groups    @xmath86    since @xmath87 is a ribbon graph isomorphism , these two groups are also isomorphic as subgroups of the modular group .",
    "the former group is canonically isomorphic to @xmath62 a whereas the latter group is canonically isomorphic to @xmath88    therefore modular graphs parametrize conjugacy classes of subgroups of the modular group , whereas the edges of a modular graph parametrize subgroups in the conjugacy class represented by the modular graph . in conclusion",
    "we get :    there is a 1 - 1 correspondence between modular graphs with a base edge @xmath89 ( modulo ribbon graph isomorphisms of pairs @xmath90 ) and subgroups of the modular group ( modulo the automorphisms induced by conjugation in @xmath0 ) .",
    "[ thm : modular / graph / vs / subgroups ]    there is a 1 - 1 correspondence between modular graphs with two base edges @xmath91 ( modulo ribbon graph isomorphisms of pairs @xmath91 ) and cosets of subgroups of the modular group ( ( modulo the automorphisms induced by conjugation in @xmath0 ) ) .",
    "[ thm : modular / graph / vs / cosets ]",
    "a _ ark _ is a modular graph of the form @xmath92 where @xmath20 is a hyperbolic element of the modular group .",
    "one has @xmath93 so the ark @xmath94 is a graph with only one circuit , which we call the _ spine _ of the ark .",
    "every ark has a canonical realization as a graph @xmath95 embedded in the surface @xmath96 , which is an annulus since @xmath20 is hyperbolic .",
    "in fact @xmath96 is the annular uniformization of the modular curve @xmath97 corresponding to @xmath98 .",
    "again by hyperbolicity of @xmath20 , this graph will have infinite  farey branches \" attached to the spine in the direction of both of the boundary components of the annulus is parabolic , then @xmath94 has farey branches attached to the spine in only one direction , and its topological realization @xmath95 sits on a punctured disc . if @xmath20 is elliptic , @xmath94 is a tree with a pending edge which abut at a vertex of type @xmath99 when @xmath20 is of order 2 and of type @xmath100 when @xmath20 is of order 3 .",
    "its topological realization @xmath95 sits on a disc with an orbifold point . ] . by proposition  [ conjugatesubgroups ] the graphs @xmath101 and @xmath102 are isomorphic for every element @xmath103 of the modular group and by theorem  [ thm : modular / graph / vs / subgroups ] we deduce the following result , see @xcite :    there are one - to - one correspondences between    * arks and conjugacy classes of subgroups of the modular group generated by a single hyperbolic element , and * arks with a base edge and subgroups of the modular group generated by a single hyperbolic element .    [ cor:1/to/1/corr / between / undirected / carks ]    . ]",
    "a ark is said to be directed if we choose an orientation for the spine .",
    "there are one - to - one correspondences between    * hyperbolic elements of the modular group and directed arks with a base edge , and * conjugacy classes of hyperbolic elements of the modular group and directed arks .",
    "[ cor:1/to/1/corr / between / directed / carks ]      arks are infinite graphs , and each edge of a ark carries a name which is an infinite coset .",
    "in fact , all the combinatorial information of a ark can be encoded in a finite storage as follows : first remove all @xmath55-vertices of the ark .",
    "next , turn once around the spine . upon meeting a @xmath100-vertex on which a branch attached by @xmath37 , cut that branch and tag that @xmath100-vertex with a  0 \" . in a similar fashion , upon meeting a @xmath100-vertex on which a branch attached by @xmath104 , cut that branch and tag that @xmath100-vertex with a  1 \" .",
    "we obtain a finite graph called a _ binary bracelet _ which is by definition an equivalence class of binary strings under cyclic permutations ( i.e. rotations ) and reversals .",
    "conversely , by using the convention @xmath105 and @xmath106 we can reconstruct the ark from its bracelet .",
    "rotations and reversals generate a finite dihedral group , and a binary bracelet may equivalently be described as an orbit of this action .",
    "5 cm     5 cm     for @xmath107 the number of binary bracelets with @xmath108 vertices is @xmath109 this is sequence a000029 ( m0563 ) in oeis  @xcite .",
    "the number of binary bracelets ( arks ) of length @xmath108 is @xmath110 if @xmath108 is even and @xmath111 if @xmath108 is odd where @xmath112 is the number of binary necklaces of length @xmath108 .",
    "an equivalence class of binary strings under rotations ( excluding thus reversals ) is called a _ binary necklace _ , or a _ cyclic binary word_. they are thus orbits of words under the action of a cyclic group and they correspond to directed arks . for @xmath113",
    "the number of binary necklaces of length @xmath108 is @xmath114 which is sequence a000031 ( m0564 ) in oeis .",
    "the number of necklaces ( directed arks ) of length @xmath108 is given by macmahon s formula from 1892 ( also called witt s formula ) reads ( see @xcite , @xcite ) :    @xmath115 where @xmath87 is euler s totient function .",
    "a ark is called _ primitive _ if its spine is not periodic .",
    "aperodic binary necklaces correspond to primitive directed arks . for @xmath113",
    "the number of aperiodic necklaces of length @xmath108 is @xmath116 which is sequence a000031 ( m0564 ) in the database .",
    "there is a formula for the number of aperiodic necklaces of length @xmath108 in terms of mbius function @xmath117 : @xmath118    as mentioned , binary necklaces ( or cyclic binary words or directed arks ) may be viewed as orbits of words under the action of the cyclic group .",
    "choosing an ordering of our letters @xmath119 ( i.e. @xmath120 ) and imposing the lexicographic ordering of the words , one may choose a minimal representative in each orbit .",
    "the minimal representative of a primitive ( aperiodic ) word is called a _ lyndon word_. they were first studied in connection with the construction of bases for free lie algebras and they appear in numerous contexts .",
    "in our case they are @xmath121    one can similarly find representatives for aperiodic binary bracelets ( = primitive indefinite binary quadratic forms ; see below ) .",
    "there are effective algorithms to list all primitive necklaces and bracelets up to a given length ( i.e. duval s algorithm @xcite , the algorithm due to fredricksen , kessler and maiorana @xcite , sawada s algorithm @xcite , etc ) . translated into the language of binary quadratic forms",
    ", this means that it is possible to single out a unique reduced representative in each class of a primitive indefinite binary quadratic form and that it is possible to effectively enumerate all classes of primitive indefinite binary quadratic forms by specifying those reduced representatives .    to sum up",
    ", we may represent primitive arks by primitive bracelets . in order to shorten this representation further",
    ", we may count the number of consecutive 0 s and 1 s and represent arks as sequences of natural numbers @xmath122 , if we agree that this sequence encodes a bracelet that starts with a @xmath123 if the exponent is @xmath123 and @xmath24 if the exponent is @xmath24 .",
    "this representation is directly connected to the  minus \" continued fractions ( see zagier @xcite ) .",
    "a primitive word may have two types of symmetries : invariance under the swap of symbols @xmath124 and invariance under reversal , i.e. palindromic symmetry .",
    "the first symmetry corresponds to ambiguous binary quadratic forms and the second symmetry corresponds to reciprocal binary quadratic forms , as we shall see .",
    "the swap of symbols @xmath124 corresponds to inversion in the class group .",
    "there are several natural invariants associated to a ark _ _.",
    "the combinatorial length @xmath125 of its spine is an invariant .",
    "a hyperbolic invariant of a ark is the metric length @xmath126 of the closed geodesic in the annular surface under its hyperbolic metric induced by the ark .",
    "a conformal invariant of a ark is the modulus @xmath127 of the associated annulus .",
    "finally , the discriminant @xmath128 of the associated form and the absolute value of the trace @xmath129 of the associated matrix are two arithmetic invariants with @xmath130 .",
    "one has @xmath131 the modulus is found as follows : any hyperbolic element @xmath132 is conjugate to an element of the form @xmath133 where @xmath134 is the multiplier of @xmath20 . since the trace is invariant under conjugation , one has @xmath135 .    now @xmath136 acts by mbius transformation @xmath137 , and the quotient map is @xmath138 with the annulus @xmath139 as its image .",
    "hence the modulus of the ambient annulus of the ark is @xmath140 .",
    "it is possible to write down the uniformization @xmath141 explicitly , which is a quite involved expression .",
    "the annular uniformization @xmath142 can be written as @xmath143 .",
    "a _ binary quadratic form _ is a homogeneous function of degree two in two variables @xmath144 ( denoted @xmath145 or in the matrix form : @xmath146 so that @xmath147 )",
    ". if the coefficients @xmath148 are integers the form is called _ integral _ with discriminant @xmath149 .",
    "if @xmath14 is integral and @xmath150 then @xmath14 is called _",
    "primitive_. following gauss we will call a form @xmath145 _ ambiguous _ if @xmath151 for some @xmath152 . finally a form @xmath145 will be referred to as _ reciprocal _",
    "whenever @xmath153 , @xcite .",
    "we call two binary quadratic forms _ equivalent _ if they belong to the same @xmath0 orbit under the above action , under which discriminant is invariant .",
    "let us denote the @xmath0-orbit ( or the equivalence class ) of @xmath14 by @xmath163 $ ] .",
    "the stabilizer of @xmath14 is called its _ automorphism group _ , denoted by @xmath164 , and elements of @xmath164 are called automorphisms of @xmath14 . for a positive definite binary quadratic form @xmath14 , the group @xmath164 is trivial unless @xmath165 or @xmath166 ; @xmath167 if @xmath168 and @xmath169 in case @xmath170 , @xcite . on the other hand , for an indefinite binary quadratic form one has @xmath171 .    given an indefinite binary quadratic form @xmath145 a generator of its automorphism group will be called its _ fundamental automorphism_. note that there are two fundamental automorphisms , one being @xmath172 , the other being its inverse , @xmath173 .",
    "every integral solution @xmath174 of pell s equation : @xmath175 corresponds to an automorphism of @xmath14 given by the matrix : @xmath176 it turns out that the fundamental automorphism is the one having minimal @xmath177 ( * ? ? ?",
    "* proposition 6.12.7 ) .",
    "we saw that an oriented ark with a base edge determines a hyperbolic element of @xmath0 . and",
    "this element in turn determines an indefinite binary quadratic form via @xmath180 .",
    "conversely , given a primitive indefinite binary quadratic form @xmath182 to find @xmath183 such that the matrix @xmath184 we look at solutions @xmath185 of pell s equation @xmath186 . using any such @xmath187",
    "we construct the hyperbolic element : @xmath188 where @xmath189 .",
    "both choices of the sign produces a matrix which maps onto @xmath14 . in fact , the two matrices are inverses of each other in @xmath0 .",
    "consider the form @xmath190 .",
    "it has discriminant @xmath191 .",
    "the pair @xmath192 is a solution to the pell equation @xmath193 .",
    "the two @xmath177 values corresponding to this solution are @xmath194 and @xmath24 . plugging these two values into the matrix above",
    "we get : @xmath195 the pair @xmath196 is also a solution to the above pell equation , and the corresponding matrices are : @xmath197 we would like to remark also that @xmath198 in fact , @xmath199 is one of the two fundamental automorphisms of @xmath14 .",
    "there is a bijection between the set of conjugacy classes of primitive hyperbolic elements in @xmath0 and the set of classes of primitive binary quadratic forms of discriminant @xmath202 ; where a hyperbolic element is called primitive if it is not a power of another hyperbolic element .",
    "we say that an indefinite binary quadratic form @xmath203 is _ reduced _ if the geodesic in @xmath204 connecting the two real fixed points of @xmath205 , called the _ axis _ of @xmath205 and denoted by @xmath206 , intersects with the standard fundamental domain of the modular group .",
    "remark that this definition is equivalent to the one given by gauss in @xcite . ] .",
    "the equivalence of the two definitions is folklore .    the @xmath0 class of an indefinite binary quadratic form contains",
    "more than one reduced form as opposed to definite binary quadratic forms where the reduced representative is unique , see ( * ? ? ?",
    "* section 6.8 ) or ( * ? ? ?",
    "* section 5.6 ) for further discussion .",
    "the classical reduction is the process of acting on a non - reduced form @xmath203 by the matrix @xmath207 where @xmath208    and checking whether the resulting form is reduced or not .",
    "it is known that after finitely many steps one arrives at a reduced form , call @xmath209 .",
    "applying @xmath210 to @xmath209 produces again a reduced form .",
    "moreover , after finitely many iterations one gets back @xmath209 . and this set of reduced indefinite binary quadratic forms",
    "is called the cycle of the class .",
    "our aim is now to reveal the reduction method due to gauss in terms of arks . recall that every edge of a ark may be labeled with a unique coset of the corresponding subgroup",
    "that is to say binary quadratic forms may be used to label the edges of the ark by corollary  [ cor:1/to/1/corr / between / directed / carks ] .    given a hyperbolic element @xmath156 as a word in @xmath37 , @xmath104 and @xmath36 we define the length of @xmath156 , @xmath211 , to be the total number of appearances of @xmath37 , @xmath104 and @xmath36 .",
    "for instance for @xmath212 , @xmath213 .    given an indefinite binary quadratic form ( reduced or non - reduced ) , @xmath14 , let @xmath205 be a primitive hyperbolic element corresponding to @xmath14 . then @xmath214 [ lemma : length / of / reduced / form / is / minimal ]    let us assume from now on that our arks are embedded into an annulus , with an orientation which we will assume to be the usual one .",
    "in addition we also introduce the following shorter notation for our arks : in traversing the spine ( in either direction ) if there are @xmath108 consecutive farey branches in the direction of the same boundary component , then we denote this as a single farey component and write @xmath108 on the top of the corresponding branch , see figure  [ fig : cark / and / its / short / form ] .",
    "we will call such arks _ weighted_.    let @xmath215 be a weighted ark .",
    "edges of the spine are called _ semi - reduced_. in particular , an edge on the spine of @xmath215 is called _ reduced _ if and only if it is on the either side of a farey component which is in the direction of the inner boundary component .",
    "[ defn : reduced / edge ]        remark that as we have fixed our orientation to be the usual one , there is no ambiguity in this definition .",
    "in addition note that semi - reduced edges are in one to one correspondence between the forms @xmath216 in a given class for which @xmath217 .",
    "we are now ready to describe reduction theory of binary quadratic forms in terms of arks .",
    "we have seen that multiplication by the matrix @xmath218 is , in general , the process of moving the base edge of the ark to the spine as a result of lemma  [ lemma : length / of / reduced / form / is / minimal ]",
    ". however , this is not enough .",
    "that is , not every edge on the spine corresponds to a reduced form .",
    "reduced forms correspond to edges where the farey branches switch from one boundary component to the other .",
    "more precisely , we have :    reduced forms in an arbitrary indefinite binary quadratic form class @xmath163 $ ] are in one to one correspondence between the reduced edges of the ark corresponding to the given class .",
    "[ thm : reduced / edges / reduced / bqfs ]          let us consider the form @xmath220 .",
    "it is easy to check that @xmath14 is reduced .",
    "the trace of the class is @xmath222 . by gauss theory",
    "the class @xmath163 $ ] is an element in the quadratic number field with discriminant @xmath223 .",
    "let @xmath224 for some positive integer @xmath108 .",
    "then the identity in the class group is given by the ark in figure  16a and the corresponding form is @xmath225 .",
    "if @xmath226 , then the identity is represented by the form @xmath227 .",
    "the corresponding ark has two farey branches , see figure  16b .",
    "[ ex : identities / having / two / farey / components ]            let us now discuss certain symmetries of a ark . for a given ark @xmath215 let @xmath229 be the ark which is the mirror image of @xmath215 about any line passing through the  center \" of the spine ( assuming that the farey components coming out of the spine in its shorter notation that we have introduced is evenly spaced ) .",
    "it is easy to see that both ideal classes represented by the two arks @xmath215 and @xmath229 have the same discriminant .",
    "a straightforward computation leads to the following :      let us consider the form @xmath231 having discriminant @xmath232 .",
    "the form @xmath233 is an element in the ideal class represented by this form .",
    "the corresponding arks are shown in figure  [ fig : inverse / cark ] .",
    "the forms are inverses of each other .",
    "[ ex : inverse ]          recall that gauss has defined a binary quadratic form to be ambiguous if it is equivalent to its inverse or equivalently if the corresponding equivalence class contains @xmath234 for some @xmath235 , @xmath236 and @xmath237 . following gauss , we define a ark @xmath215 _ ambiguous _ if @xmath215 and @xmath229 are isomorphic as arks , or equivalently correspond to the same subgroup of @xmath0 .",
    "so from proposition  [ propn : inverse / carks ] we deduce :            let us now discuss  rotational \" symmetries .",
    "in section  [ sec : necklace / bracelet ] we defined a directed ark with a base edge _ primitive _ if and only if its spine is not periodic .",
    "let @xmath240 denote the set of primitive arks .",
    "it is easy to see that primitive hyperbolic elements is said to be _ primitive _ if it is not a positive power of another element of the modular group . ] in @xmath0 correspond to primitive arks or equivalently to prime geodesics in @xmath241 .",
    "finally , let @xmath245 denote the mirror of a given ark , that is the ark obtained by reflecting @xmath215 with respect to the spine . once again observe that both @xmath215 and @xmath245 have the same discriminant .",
    "in fact , an indefinite binary quadratic form say @xmath216 is given which is represented by the ark @xmath215 then the ark @xmath245 represents the form @xmath246 and the same holds for every element in @xmath163 $ ] .",
    "we conclude that both arks represent ideal classes that have the same order in the class group .",
    "let @xmath156 be a hyperbolic element in @xmath0 .",
    "in @xcite , sarnak has defined @xmath156 to be reciprocal if @xmath156 is conjugate to its inverse .",
    "the conjugation turns out to be done by a unique element ( up to multiplication by an element in @xmath247 ) of order @xmath248 , and thus reciprocal elements correspond to dihedral subgroups of the modular group - subgroups of @xmath0 . ] .",
    "a form @xmath216 is called reciprocal if @xmath249 .",
    "it is known that reciprocal hyperbolic elements correspond to reciprocal indefinite binary quadratic forms , @xcite . in a similar fashion",
    "we call a ark _ reciprocal _ if @xmath215 and @xmath250 are isomorphic as arks .",
    "in fact since two operators @xmath251 and @xmath252 commute , if @xmath215 is a reciprocal ark then so is @xmath245 .          consider the form @xmath253 .",
    "the corresponding hyperbolic element in @xmath0 is @xmath254 .",
    "the corresponding ark is shown in figure  [ fig : reciprocal ] , where it is easy to see that @xmath215 and @xmath250 are same .",
    "[ ex : reciprocal / cark ]    the forms @xmath255 already appeared in example  [ ex : identities / having / two / farey / components ] are reciprocal and represent identity in the class group .",
    "note also that such forms come from the word @xmath256 .",
    "the arks of these reciprocal identities are in figure  [ fig : identity/5n2 ] .",
    "[ ex : reciprocal / identities ]            there are several important computational problems related to arks , in connection with the class number problems in the indefinite case .",
    "the most basic invariant of a ark is the length of its spine .",
    "the ( absolute ) trace of the associated matrix is another , much subtler invariant .",
    "the problem of listing arks of the same trace is equivalent to the problem of computing class numbers .",
    "also , the gauss product on classes of forms defines an abelian group structure on the set arks of the same trace , namely the _ class group_. it is a work in progress to reach to a new understanding of class groups in terms of the graphical representation of their elements by arks .",
    "let us note in passing that primitive arks parametrize closed geodesics on the modular curve , and so arks are closely connected to symbolic dynamics on the modular curve , see @xcite , encoding of geodesics , and selberg s trace formula , see @xcite .",
    "alternatively one can run over the class of @xmath259 and compute the minima of equivalent forms at a fixed point @xmath260 , for example @xmath261 .",
    "hence the choice of this fixed point @xmath260 defines a function on the set of edges of the associated ark , and the markoff value of the form is the maximal value attained by this function defined on the ark .",
    "there are also arks associated to markoff irrationalities which we call _",
    "markoff arks_. a solution to the representation problem of indefinite binary quadratic forms is given in @xcite and as a by - product markoff value of a given form can be computed .",
    "the algorithms will be available within the software developed by the first two authors and their collaborators , @xcite .            at ( 0,2 ) [",
    "ultra thick]@xmath262 ; at ( 0,-6 ) [ ultra thick]@xmath263 ; at ( 6,0 ) [ ultra thick , rotate=90]@xmath264 ; at ( -2,0 ) [ ultra thick , rotate=90]@xmath265 ; at ( 5.5*cos22.5,5.5*sin22.5 ) [ ultra thick , rotate=22.5]@xmath266 ; at ( 5.5*cos67.5,5.5*sin67.5 ) [ ultra thick , rotate=67.5]@xmath267 ; at ( -5.5*cos22.5,5.5*sin22.5 ) [ ultra thick , rotate=-22.5]@xmath268 ; at ( -5.5*cos67.5,5.5*sin67.5 ) [ ultra thick , rotate=-67.5]@xmath269 ; at ( 5.5*cos22.5,-5.5*sin22.5 ) [ ultra thick , rotate=-22.5]@xmath270 ; at ( 5.5*cos67.5,-5.5*sin67.5 ) [ ultra thick , rotate=-67.5]@xmath271 ; at ( -5.5*cos22.5,-5.5*sin22.5 ) [ ultra thick , rotate=22.5]@xmath268 ; at ( -5.5*cos67.5,-5.5*sin67.5 ) [ ultra thick , rotate=67.5]@xmath269 ;    ( 4*cos45,4*sin45 ) circle ( 2.25 mm ) ; ( 4*cos45,4*sin45 ) circle ( 2.25 mm ) ; at ( 4*cos45,4*sin45 ) [ ultra thick ] @xmath272 ; ( 4*cos-45,4*sin-45 ) circle ( 2.25 mm ) ; ( 4*cos-45,4*sin-45 ) circle ( 2.25 mm ) ; at ( 4*cos-45,4*sin-45 ) [ ultra thick ] @xmath272 ; ( 4*cos135,4*sin135 ) circle ( 2.25 mm ) ; ( 4*cos135,4*sin135 ) circle ( 2.25 mm ) ; at ( 4*cos135,4*sin135 ) [ ultra thick ] @xmath272 ; ( 4*cos-135,4*sin-135 ) circle ( 2.25 mm ) ; ( 4*cos-135,4*sin-135 ) circle ( 2.25 mm ) ; at ( 4*cos-135,4*sin-135 ) [ ultra thick ] @xmath272 ;    to conclude the paper , let us rephrase our main result : we show that the class of every primitive indefinite binary quadratic form is not simply a set but it has the extra structure of an infinite graph , namely a ark , such that the forms in the class are identified with the edges of the graph .",
    "this graph admits a topological realization as a subset of an annulus and explains very well some known phenomena around gauss reduction theory of forms and zagier s reduction of elements of @xmath0 as explained in @xcite . in our point of view both",
    "gauss reduced forms and zagier reduced forms correspond to edges on the what we call spine of the ark .",
    "various properties of forms and their classes are manifested in a natural way on the ark .",
    "the first instance of such a question concerning binary quadratic forms has been addressed by the second named author in @xcite , where he has given an improvement of gauss reduction of binary quadratic forms , and has given solutions to the minimum problem and representation problem of binary quadratic forms .",
    "the first named author is thankful to max planck institute at bonn for their hospitality during the preparation of the current paper .",
    "this research has been funded by the tbitak grant 110t690 .",
    "the first named author was also funded by the galatasaray university research grant 12.504.001 .",
    "the second named author is funded by galatasaray university research grant 13.504.001 .",
    "a.m.  uluda .",
    "the modular group and its actions ( with and appendix by h. ayral ) . in l.",
    "ji , a.  papadopoulos , and s .- t .",
    "yau , editors , _ handbook of group actions_. higher education press and international press , 2014 ."
  ],
  "abstract_text": [
    "<S> we show that the class of every primitive indefinite binary quadratic form is naturally represented by an infinite graph ( named ark ) with a unique cycle embedded on a conformal annulus . </S>",
    "<S> this cycle is called the spine of the ark . </S>",
    "<S> every choice of an edge of a fixed ark specifies an indefinite binary quadratic form in the class represented by the ark . </S>",
    "<S> reduced forms in the class represented by a ark correspond to some distinguished edges on its spine . </S>",
    "<S> gauss reduction is the process of moving the edge in the direction of the spine of the ark . </S>",
    "<S> ambiguous and reciprocal classes are represented by arks with symmetries . </S>",
    "<S> periodic arks represent classes of non - primitive forms . </S>"
  ]
}