{
  "article_text": [
    "the number of known extrasolar planets has exploded in the last two decades . this has been driven by improvements in all of the different techniques used to detect and characterise exoplanets , including the radial velocity ( rv ) method ( e.g. * ? ? ?",
    "* ) , the transit method ( e.g. * ? ? ?",
    "* ) , and gravitational microlensing ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "the problem of inferring the properties of an exoplanetary system from observational data can be challenging . in the case of radial velocity data ,",
    "the expected signal due to an exoplanet is periodic , and the goal is to infer the number of planets in the system , as well as their properties such as orbital periods and eccentricities .",
    "many different techniques have been proposed for doing this .",
    "these techniques fall into two main classes : i ) those based on periodograms , and ii ) those based on model fitting in the bayesian inference framework , to describe the uncertainties probabilistically .",
    "bayesian model fitting via markov chain monte carlo ( mcmc ) tends to be computationally intensive , especially if we want to calculate the posterior distribution for @xmath0 , the number of planets .",
    "it is well known that rv datasets can contain periodic signals resulting from stellar activity rather than planets , which can affect the conclusions we draw about exoplanet systems .",
    "therefore , it is important to develop models which attempt to distinguish stellar activity signals from keplerian planet signals based on the shape of the oscillations and/or additional data constraining the periods of any stellar activity signals",
    ". we do not address this important challenge in the present paper .",
    "rather , we consider the problem of inferring the number @xmath0 of keplerian signals in an rv dataset in a computationally efficient way , under the simplifying assumption that only keplerian signals are present in the data .    we introduce a trans - dimensional birth - death mcmc approach @xcite to inferring @xmath0 .",
    "when @xmath0 is treated as just another model parameter , we can obtain its posterior distribution in a single run .",
    "in addition , rather than trying to sample the posterior distribution , we use diffusive nested sampling ( dns * ? ? ? * ) which replaces the posterior distribution with an alternative _ mixture of constrained priors _ , allowing mixing between separated modes . as a result , we are able to sample the posterior distribution for @xmath0 , and evaluate the marginal likelihood ( including the sum over @xmath0 ) in a single run which takes about 10 minutes on a 2 - 3 planet system . on the other hand",
    "the approach of @xcite takes approximately 30 minutes per planet ( gregory , priv .",
    ". a c++ implementation of our method is available online at https://github.com/eggplantbren/exoplanet under the terms of the gnu general public licence .",
    "bayesian inference is the use of probability theory to describe uncertainty @xcite . in this framework , we approach data analysis problems by first constructing a _ hypothesis space _ , which is the set of possible answers to the problem we are considering .",
    "normally , this is the set of possible values of a vector of parameters @xmath3 whose values we want to know .",
    "we then assign probability distributions called the _",
    "prior _ and the _ sampling distribution_. the prior distribution @xmath4 describes our initial uncertainty about which values of the parameters @xmath3 are plausible , and the sampling distribution @xmath5 describes our initial uncertainty about the data set we re going to observe , as a function of the unknown parameters @xmath3 .",
    "when the data is known , our state of knowledge about the parameter is updated from the prior @xmath4 to the posterior distribution given by bayes rule : @xmath6 where @xmath5 as a function of @xmath3 is called the likelihood , once the actual dataset has been substituted in .",
    "note that some authors do not distinguish between a sampling distribution and a likelihood . throughout this paper",
    "we use the term sampling distribution for @xmath7 if we are discussing a probability distribution ( actually a family of them , indexed by @xmath3 ) over the set of possible datasets .",
    "we use the term _ likelihood _ when the actual dataset has been plugged in , when @xmath7 becomes a scalar function ( not a probability distribution ) over the parameter space .",
    "the denominator , often called the _ evidence _ or _ marginal likelihood _ ,",
    "is given by the expected value of the likelihood with respect to the prior : @xmath8 where the integral is over the entire @xmath9-dimensional parameter space .",
    "in the context of bayesian computation , the prior is often denoted @xmath10 , the likelihood @xmath11 , and the marginal likelihood @xmath12 .",
    "the number of orbiting planets , @xmath0 , is an important parameter . to calculate the posterior distribution for @xmath0",
    ", most authors consider various trial values of @xmath0 , and calculate the marginal likelihood @xmath13 for each possible value of @xmath0 ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) , marginalising over all other model parameters . the posterior distribution for @xmath0 can then be found straightforwardly by using bayes rule with @xmath0 as the only unknown parameter : @xmath14 popular methods for calculating the marginal likelihood are nested sampling @xcite and ideas related to thermodynamic integration ( e.g. * ? ? ?",
    "* ) . relationships between these methods are discussed by @xcite and  @xcite .",
    "this traditional approach can be very time consuming .",
    "methods for calculating the marginal likelihood are already more intensive than standard mcmc methods for sampling the posterior , because they usually involve a sequence of probability distributions ( e.g. the constrained priors in nested sampling , or the annealed distributions in thermodynamic integration ) rather than a single distribution ( the posterior ) .",
    "this intensive process needs to be run many times , for @xmath15 , @xmath16 , @xmath17 , and so on .",
    "the traditional approach to inferring @xmath0 also contradicts fundamental ideas in bayesian computation .",
    "imagine we are trying to compute the posterior distribution for a parameter @xmath18 in the presence of a nuisance parameter @xmath19 .",
    "this is usually solved by exploring the joint posterior for @xmath18 and @xmath19 , and then only looking at the generated values of @xmath18",
    ". nobody would suggest the wasteful alternative of using a discrete grid of possible @xmath18 values and doing an entire nested sampling run for each , to get the marginal likelihood as a function of @xmath18 .",
    "when the hypothesis space for @xmath18 is discrete , mcmc is still possible and there is no reason to switch to the wasteful alternative .",
    "trans - dimensional mcmc methods such as birth - death mcmc @xcite or the more general reversible jump mcmc @xcite treat the model dimension @xmath0 as just another model parameter . at fixed @xmath0 , standard techniques such as the metropolis algorithm can be used to explore the posterior distribution .",
    "additional moves that propose to change the value of @xmath0 are also defined .",
    "the simplest of these are birth - death moves .",
    "more complicated moves , such as split - and - merge , are possible but not always necessary .",
    "trans - dimensional mcmc is a natural tool for a wide range of astronomical data analysis problems ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) .    in the exoplanet context ,",
    "a birth move proposes to add one more planet to the model .",
    "the new planet s properties ( period , amplitude , eccentricity , etc ) are drawn from their prior distribution which may depend on other other model parameters or hyperparameters .",
    "the corresponding death move simply chooses a planet currently in the model , and removes it .",
    "the acceptance probability for these moves is 1 if we want to explore the prior . to implement these moves in nested sampling @xcite , where the target distribution is proportional to the prior but with a hard likelihood constraint ,",
    "then the acceptance probability is 1 if the proposed move satisfies the likelihood constraint , and 0 if it does not .",
    "a recent paper @xcite introduced a general approach to implementing trans - dimensional models within diffusive nested sampling @xcite , a general mcmc algorithm .",
    "the @xcite software predefines the metropolis proposals for exploring trans - dimensional target distributions , including when the prior for the properties of each model component ( i.e. each planet ) is defined hierarchically .",
    "it is well known that bayesian computation ( using mcmc for example ) can be difficult when the posterior distribution is multimodal or has strong dependencies between parameters .",
    "an uncommon but less well - known difficulty is the existence of _ phase transitions _",
    "@xcite .",
    "imagine a high - dimensional unimodal posterior distribution that is composed of a broad , high volume but low density `` slab '' with a narrow , low volume but high density `` spike '' on top of it .",
    "an example is a mixture of two concentric high - dimensional gaussians with different widths .",
    "if you ran mcmc on such a posterior , it would be difficult to jump between the slab and the spike components .",
    "if the mcmc is currently in the spike region ( or phase ) it will be unable to escape : a proposed move into the slab will be rejected because of the ratio of densities .",
    "conversely , if the mcmc was in the slab region , it would be unlikely to go into the spike region , because its volume is so small : it would be very unlikely to _ propose _ to move into the spike .",
    "thus , the situation behaves much like a multimodal posterior , despite only being unimodal .",
    "if the slab contains a very small amount of posterior probability , it is not a problem if an mcmc algorithm spends all its time in the spike .",
    "however , this situation could still cause problems with the calculation of the marginal likelihood if annealing methods are used .",
    "the thermodynamic integral formula gives the log of the marginal likelihood @xmath12 as an average of log likelihoods : @xmath20\\right>_\\beta \\",
    ", d\\beta\\end{aligned}\\ ] ] where the expectation is taken with respect to the distribution with `` inverse temperature '' @xmath21 , proportional to @xmath22 . even if the slab contains virtually zero probability when @xmath23 ( i.e. the posterior ) , for some values of the inverse temperature @xmath21 the slab and the spike will both be important . at these temperatures",
    "the mcmc will fail to mix ( it will incorrectly spend all its time in either the slab or the spike , rather than mixing between the two ) and will give a misleading estimate of the average log likelihood at that temperature and therefore an incorrect marginal likelihood estimate .",
    "phase transitions are well known in statistical mechanics , but can also occur in bayesian data analysis .",
    "typically this occors when the data contains a `` big '' effect which provides a lot of information about some parameters , and a `` small '' subtle effect as well .",
    "nested sampling , and variants such as dns , are not affected by phase transitions because the exploration only makes use of likelihood _ rankings _ , rather than likelihood values themselves , and are therefore invariant under monotonic transformations of the likelihood function .",
    "part of their output , the relationship between the likelihood @xmath24 and the enclosed prior mass @xmath25\\ , d^n\\theta$ ] can be used to diagnose whether the problem contains a phase transition . in particular ,",
    "if the graph of @xmath26 vs. @xmath27 is convex at some point , then a phase transition exists @xcite .      to fit a planet model to rv data",
    ", we need parameters to describe the properties of each planet . for simplicity ,",
    "we describe each planet by five parameters : the orbital period @xmath28 , the semi - amplitude ( in metres per second ) of the rv signal @xmath29 , the phase of the signal @xmath30 ( defined such that @xmath31 gives an rv signal whose maximum is at @xmath32 ) , the eccentricity @xmath33 , and the `` viewing angle '' @xmath34 ( also known as the longitude of the line of sight ) .",
    "we defined our parameters such that in the limit of zero eccentricity , the rv signal of a planet reduces to @xmath35 .",
    "the unknown parameters are : @xmath36 where @xmath0 is the number of planets , @xmath37 are hyperparameters hyperparameters used to define the prior for the properties of the planets , and @xmath38 are the properties of planet @xmath39 .",
    "the parameter @xmath40 describes a dc offset in the data , and @xmath41 and @xmath1 are parameters of the noise distribution which are discussed further below .",
    "note that our parameter @xmath34 is standard , however @xmath30 is non - standard because we assert that @xmath42 always implies the signal is at its maximum at @xmath32 .",
    "our parameter space is equivalent to the standard one , we are just using a different coordinate system .    a standard assumption for the probability distribution of the data given the parameters ( known as the sampling distribution , which becomes the likelihood function when the dataset is known ) is a normal distribution with standard deviation @xmath43 known from the error bars in the data set .",
    "however , it is usually recommended to put in `` safety features '' , in case the data set contains any discrepant measurements , or in case the error bars in the data set are underestimated . to achieve this",
    ", we used a student-@xmath44 distribution instead of a normal distribution , with scale parameter @xmath45 and shape parameter @xmath1 .",
    "the parameter @xmath41 is an `` extra noise '' parameter that effectively increases the size of the error bars , and the shape parameter @xmath1 allows for heavier tails than a normal distribution .",
    "if @xmath1 is large , the student-@xmath44 distribution is approximately a normal distribution , and if @xmath1 is small the noise distribution has much heavier tails . for instance ,",
    "when @xmath46 the student-@xmath44 distribution becomes a cauchy distribution .",
    "all of the model assumptions are specified in detail in table  [ tab : priors ] .",
    "we assigned hierarchical priors to some of the planet s parameters ( i.e. the prior for the planets parameters is defined conditional on some hyperparameters ) .",
    "this allows the model to capture the idea that knowing the values of some planet s parameters provides some information about the parameters of another planet .",
    "not using hierarchical priors usually implies a strong prior commitment to the hypothesis that the properties of the planets are spread out across the whole domain of possible values , which is not necessarily the case .",
    "most of our priors were chosen to represent vague prior knowledge , rather than the judgement of an informed expert on extrasolar planets .",
    "uniform distributions were used for parameters such as phases , where time - translation symmetry seems plausible .",
    "for some parameters we assigned the distribution in terms of the log of the parameter , rather than the parameter itself , when the parameter is positive and uncertain by orders of magnitude .",
    "truncated cauchy distributions were used when there is a preferred value , but since these have very heavy tails , the assumption is quite fail safe relative to other possible `` informative '' assignments such as normal distributions . for example , the prior for @xmath47 , the typical orbital period , is centered around 1 year but could be as low as @xmath48 years or as high as @xmath49 years , a very generous range .",
    "a uniform distribution for @xmath50 would have been more conventional , whereas the cauchy distribution expresses a slight preference for @xmath47 being of order one year .",
    "an apparently strange choice is the conditional prior for the ( logarithms of ) the orbital periods , which is a biexponential distribution given a location parameter @xmath47 and a scale parameter @xmath51 which determines the width of the distribution and scale parameter @xmath52 has probability density function @xmath53 . ] . rather than assigning independent priors to the log periods ,",
    "the hierarchical model allows for the periods to `` cluster around '' a typical period @xmath47 if there is evidence for this . on the other hand , independent priors for the periods would imply a strong prior commitment to the hypothesis that the periods are spread out across the whole prior volume ( equivalent to assuming a fixed large value for @xmath51 ) .",
    "a more conventional choice for the conditional prior given @xmath47 and @xmath51 would have been a normal distribution .",
    "however , the @xcite software needs to know the corresponding cumulative distribution and its inverse , which are not available in closed form for the normal distribution .",
    "our prior for @xmath51 , which controls the diversity of the log - periods , was uniform between 0.1 and 3 , since it is unlikely that many planets have extremely similar or extremely different ( over several orders of magnitude ) orbital periods .    for the velocity semi - amplitudes @xmath54 , we chose an exponential distribution given the hyperparameter @xmath55 which sets the mean of the exponential distribution .",
    "our prior for @xmath55 spans many orders of magnitude but expresses a slight preference for @xmath55 being of order unity , using a cauchy distribution .",
    "the prior for the semi - amplitudes will influence how many of these low amplitude planets will be inferred : if we believe there are many , and the data are uninformative about low amplitude planets , then the posterior distribution for @xmath0 will also indicate that there may be many low amplitude planets . however , their other properties , such as their orbital periods , will not be well determined .",
    "the beta prior for eccentricity was suggested by gregory ( priv .",
    "comm ) and is an approximation to the inferred frequency distribution of eccentricities in the population @xcite .    [ cols=\"<,<,<\",options=\"header \" , ]",
    "the expected ( noise - free ) signal due to an exoplanet is periodic , but non - sinusoidal when the orbit is not perfectly circular . the expected shape @xmath56 of the variations is needed in order to evaluate the likelihood function for any proposed setting of the parameters . to save time , we pre - computed the properties of orbits as a function of eccentricity .",
    "we also made the standard assumption that the planets do not interact , so the expected signal due to several planets is the sum of the contributions of each planet .",
    "consider a test particle moving in the @xmath57-@xmath58 plane under the influence of a point mass at the origin .",
    "the motion of the test particle represents the reflex motion of the host star orbiting around the center of mass of the system .",
    "the equations of motion for the particle are : @xmath59 where @xmath60 .",
    "the solutions to this system of equations are elliptical orbits with the focus at the origin .",
    "we set the initial position to @xmath61 , and the initial velocity to @xmath62 where @xmath63 $ ] . if @xmath64 , the orbit is circular and as @xmath65 decreases the orbit becomes more elliptical . for trial values of @xmath65 ranging from 0.4 to 1 in steps of 0.005 , we calculated the orbit , and saved the velocities @xmath66 and @xmath67 as a function of time to disk .",
    "these saved orbits were used as a lookup table for constructing the expected signal @xmath68 due to a single planet . because of the initial conditions , the simulated orbits were all horizontally aligned .",
    "if the observer is located on the @xmath57-axis a large distance from the origin , they will measure @xmath69 .",
    "however , if the observer is located at an angle @xmath70 with respect to the @xmath57-axis , then the radial velocity measured will instead be @xmath71 .",
    "since the our orientation with respect to the orbits is unknown , each planet requires a `` viewing angle '' parameter @xmath70 also known as the longitude of the line of sight @xcite .",
    "the eccentricity of the orbit , in terms of @xmath65 , is @xmath72 . by precomputing a set of orbits before running the mcmc",
    ", we are able to do @xmath73 15,000 likelihood evaluations per second per cpu core .",
    "to test our proposed methodology , we generated a simulated dataset for a system with @xmath74 planets .",
    "the dataset was `` inspired by '' the @xmath1 oph dataset ( section  [ sec : nu_oph ] ) , and contains two large signals with periods of 530 and 3120 days , whose semi - amplitudes are 291 m s@xmath75 and 181 m s@xmath75 respectively .",
    "the other five planets have much lower semi - amplitudes , ranging from 4 - 30 ms@xmath75 .",
    "the standard deviation for the noise in the data was 5 m s@xmath75 , so some of these low - amplitude signals should be detectable .",
    "the simulated data is shown in figure  [ fig : fake_data ] , along with the true radial velocity curve @xmath56 that was used to generate the data .",
    "oph dataset , which we used to test our methodology .",
    "the dominant signal is from two large planets with periods periods of 530 and 3120 days and semi - amplitudes of 291 m s@xmath75 and 181 m s@xmath75 respectively .",
    "there are also five much smaller planets which contribute small additional effects to the data .",
    "[ fig : fake_data ] ]    we ran our algorithm on the simulated dataset to obtain samples from the posterior distribution .",
    "we obtained 520 posterior samples .",
    "the posterior distribution for @xmath0 , the number of planets , is shown in figure  [ fig : fake_data_n ] .",
    "the true number of planets , 7 , is not the most probable value , but it does have substantial probability .",
    "the posterior distribution suggests that @xmath0 could be anywhere from 6 to 10 .",
    "given the simulated dataset .",
    "the true number of planets was 7 .",
    "[ fig : fake_data_n ] ]    the posterior distribution for the periods @xmath76 is shown in figure  [ fig : fake_data_periods ] . because of the label switching degeneracy , the posterior distribution for each period is identical , so we pooled the samples for all periods . defining the log - periods by @xmath77 $ ] , figure  [ fig : fake_data_periods ] is a monte carlo representation of the mixture distribution @xmath78 if a certain period is accurately measured ( i.e. it appears in close to 100% of the posterior samples and the distribution for its period is very narrow )",
    "then it will appear in figure 3 with a height of @xmath79 .",
    "if the uncertainty in the period is larger than the histogram bin width then the peak will be spread over several bins .",
    "the posterior distribution for the periods , shown in figure  [ fig : fake_data_periods ] , shows that six of the true periods were recovered , with probability close to 1 .",
    "one period ( with @xmath80 ) which was actually present was not `` detected '' because it had a very small amplitude .",
    "we note that the posterior probability near this period should not be precisely zero .",
    "there is also some evidence for periods which did not actually exist , however the posterior probabilities for these peaks are not close to 1 .    ]",
    "the joint posterior distribution for the periods and the amplitudes of the signals is shown in figure  [ fig : fake_data_posterior ] along with the eccentricities . as with figure",
    "[ fig : fake_data_periods ] , the samples for all planets were combined .",
    "the true values are also plotted as circles .",
    "clearly , the reason the period of @xmath81 was not `` detected '' was that it had a very low amplitude of approximately 4 m s@xmath75 which is below the noise level .    ]",
    "the @xmath1 oph system is generally accepted to have two confirmed planets ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) , with periods of @xmath82 and @xmath83 days . to test our approach",
    "we applied it to the rv data from @xcite .",
    "the posterior distribution for @xmath0 , the number of planets , is shown in figure  [ fig : nu_oph_n ] , showing that @xmath0 could be anywhere from 2 to 10 , and the posterior probability that @xmath84 is about 88% .",
    "of course , these extra possible signals are not necessarily a planet but a feature in the data which is better explained by a periodic signal than by noise ( and may have been explained by correlated noise , had we included it ) .",
    "the posterior distribution for the logarithms of the periods is shown in figure  [ fig : nu_oph_periods ] . as in section",
    "[ sec : fake_data ] , the posterior samples for all periods were combined to make this figure , which shows several prominent peaks .",
    "the two peaks with vertical dashed lines are the commonly accepted periods of 530 and 3190 days , and the other prominent peaks ( i.e. signals which have a moderate probability of existence ) have periods of 36.11 @xmath2 0.034 days , 75.58 @xmath2 0.80 days , and 1709 @xmath2 183 days . as with any mcmc output , if we are interested in the probability of any proposition @xmath85 ( for example , `` @xmath86 a planet exists with period between 35 and 37 days '' ) , we can calculate the proportion of the posterior samples for which @xmath85 is true , which ( if we have a lot of samples ) is a monte carlo estimate of the posterior probability of @xmath85 . for @xmath1",
    "oph , we calculated the probability that at least one of these `` extra '' signals ( beyond the two commonly accepted ones ) exists , as 85% . given that they exist , their amplitudes are low , around 5 - 40 metres per second , which we note is above the noise level .",
    "an example model fit to the data is shown in figure  [ fig : nuoph ] .",
    "orbiting @xmath1 oph . the posterior probability of @xmath87 is about 88% , however the prior probability of @xmath87 was already high due to the uniform prior for @xmath0 .",
    "[ fig : nu_oph_n ] ]     oph system .",
    "the two dashed vertical lines are the commonly accepted periods of @xmath82 and @xmath83 days .",
    "the next most prominent peaks with well determined periods are at log periods of around 1.6 , 2.4 , and 3.3 , corresponding to periods of 36.11 @xmath2 0.034 days , 75.58 @xmath2 0.80 days , and 1709 @xmath2 183 days.[fig : nu_oph_periods ] ]     oph radial velocity data and an example model fit which includes a third period .",
    "the amplitude of this additional signal is low but is about twice the reported errorbars on the measurements.[fig : nuoph ] ]     oph analysis .",
    "there are several phase transitions ( concave - up regions ) present .",
    "the small one at @xmath88 separates models which contain additional signals from models that do not . without using nested sampling",
    "it would be more difficult to mix between these two situations and calculate the posterior probability for the existence of the additional signals .",
    "[ fig : logl0 ] ]    figure  [ fig : logl0 ] shows the relationship between the likelihood @xmath24 and the enclosed prior mass @xmath89 for the @xmath1 oph analysis .",
    "these plots are a standard output of nested sampling analyses , and provide insights into the structure of the problem .",
    "concave - up regions of this curve indicate phase transitions which can cause severe problems for annealing - based methods , and sometimes even for sampling the posterior distribution . in this analysis ,",
    "the models with a third signal exist to the left of the phase transition at @xmath88 , and models without the signal exist to the right of the phase transition .",
    "mixing between these two phases is crucial for accurately computing the posterior probability that extra signals exist .",
    "the marginal likelihood for our model was @xmath90 .",
    "nested sampling also allows for calculation of the `` information '' , or kullback - leibler divergence ( a quantity in information theory ) from the prior to the posterior , which quantifies how much we learned about the parameters : @xmath91 \\ , d\\theta\\end{aligned}\\ ] ] an intuitive interpretation of this quantity is the number of times the prior distribution had to be compressed by a factor of @xmath92 ( if the logarithm in the formula is a natural logarithm ) to get to the posterior distribution . for the @xmath1 oph data the information was @xmath93 nats ( natural units ) or 111 bits , so the posterior occupies about @xmath94 times the prior volume",
    "the red dwarf star gliese 581 is thought to host several planets .",
    "exactly how many is a matter of considerable debate . according to @xcite , there are two planets ( b and c , with periods 5.36 and 12.91 days respectively ) whose existence is generally accepted , two more ( d and e , with periods 66 and 3.15 days respectively ) whose existence was mostly accepted , and another two ( f and g , with periods 433 and 36.5 days respectively ) whose existence was generally doubted .",
    "however , @xcite found that planets d and g do not exist but are signals due to stellar activity .",
    "while our model can not account for stellar variability and contribute to that particular discussion , it is a challenging and interesting dataset from an inference point of view . to run our code on the combined dataset from the harps and hires spectrographs , we extended the model to include separate dc offsets for each instrument , as well as separate `` extra noise '' parameters @xmath95 and @xmath1 .",
    "we also increased @xmath96 from 10 to 15 for this system .",
    "the posterior distribution for @xmath0 is shown in figure  [ fig : gliese581_n ] , and shows strong evidence for at least eight periods ( @xmath97 ) .",
    "some authors recommend that the probability of @xmath0 planets should be @xmath98 150 times greater than the probability of @xmath99 planets existing before making a claim that @xmath0 planets have been definitively detected .",
    "such a decision rule is presumably equivalent to a utility function where false positives are much worse than false negatives .",
    "we note that applying this rule to our results , we would assert @xmath100 , even though this has a very small posterior probability .",
    "it is now recognised that there are many possible sources for oscillations in a data set and not all such oscillations should be claimed as planets .",
    "our model can not distinguish between oscillations due to planets and oscillations due to stellar activity : any oscillations found in the dataset will be described as `` planets '' by the model .",
    "another important consideration is the physical stability of the orbital system which is ignored by this type of analysis @xcite .",
    "however it is interesting that we find many more signals in the data than previous authors . by inspecting the posterior distribution for the periods ( figure  [ fig : gliese581_periods ] ) , we see that only 4 of the periods are well determined and have a posterior probability close to 1 ( i.e. they are present in all samples ) , corresponding to the known periods of gliese 581 b , c , d , and e. the other `` periods '' are more uncertain . as with @xmath1 oph , we can calculate the posterior probability of any hypothesis about gliese 581 by computing the fraction of the posterior samples that have that property .",
    "the posterior probabilities for planets b , c , d , and e , are close to 1 .",
    "the posterior probability a signal exists with @xmath101 $ ] is 88% , and the probability for a signal with @xmath102 $ ] is 85% .    one possible explanation for the large number of inferred signals that a non - sinusoidal signal due to stellar activity is being modelled as several periods ( e.g. as happens in asteroseismology when sinusoidal models are used ; * ?",
    "* ) , and if the model were extended to include a `` stochastic '' oscillation ( e.g. * ? ? ?",
    "* ) , the number of periods detected may be reduced substantially .",
    "another contributing factor is the prior for the amplitudes . with these kinds of models ,",
    "the posterior distribution for @xmath0 can be influenced by the prior for the amplitudes @xmath29 .",
    "many authors assign independent broad priors to the amplitudes , and this causes the `` occam s razor '' penalty for adding extra signals to be quite strong .",
    "since we use a hierarchical prior for the amplitudes , if some amplitudes are found to be low , @xmath55 will become small .",
    "when @xmath55 is small , it is likely that any extra signals will have small amplitudes , so the `` occam s razor '' effect is weaker .",
    "an example model fit for gliese 581 is shown in figure  [ fig : gliese581 ] .",
    "orbiting gliese 581.[fig : gliese581_n ] ]    ]    ]    the marginal likelihood was @xmath103 and the information was @xmath104 nats .",
    "this compares favourably to the marginal likelihood of @xmath105 ( for a 6-planet model ) found by @xcite , although it is unclear whether we used exactly the same dataset .",
    "interestingly , the log - likelihood curve ( figure  [ fig : logl ] ) shows this problem has two phase transitions .",
    "while these do not affect the posterior distribution ( as they did for @xmath1 oph ) , they would cause difficulties if we tried to calculte the marginal likelihood using annealing",
    ".     and -45 ) correspond to phase transitions .",
    "thermal approaches to this problem would produce misleading estimates of the marginal likelihood because they would mix poorly at temperatures around 11 and 4 .",
    "[ fig : logl ] ]",
    "in this paper we introduced a trans - dimensional mcmc approach to inferring the number of planets @xmath0 in an exoplanetary system from radial velocity data .",
    "the mcmc was implemented using the framework of @xcite which defines trans - dimensional birth and death moves , and does the sampling with respect to a nested sampling target distribution , rather than directly sampling the posterior .",
    "this approach allows us to compute the results in a single run , which provides posterior samples and an estimate of the marginal likelihood . by using diffusive nested sampling , instead of directly trying to sample the posterior distribution",
    ", we can overcome difficult features in the problem , such as phase transitions and ( to some extent ) multiple modes .",
    "we applied the code to two well - studied rv datasets , @xmath1 oph and gliese 581 . in @xmath1 oph",
    ", we found some evidence for additional signals with low amplitude , but with several possible solutions for their periods .",
    "given our modelling assumptions , the posterior probability at least one of these additional signals is real is 85% .",
    "the posterior distribution contains models both with and without these additional signals , however , these are separated by a phase transition .",
    "therefore mixing between the two situations would be infrequent if we simply tried to sample the posterior distribution .    with the combined hires+harps dataset from gliese 581 , we found evidence for a large number of `` planets '' , although only four have well determined periods , corresponding to the gliese 581 b , c , d , and e. since our model does not include any possibility of stellar variability , any such periodic signals will be attributed to `` planets '' . including non - planetary stellar variability is a crucial next step .",
    "it is a pleasure to thank fengji hou and david hogg ( nyu ) for inspiring me ( bjb ) to finally work on this problem , and phil gregory ( ubc ) for writing so many interesting papers on it .",
    "we also thank tom loredo ( cornell ) and dan foreman - mackey ( nyu ) for interesting conversations and feedback , and ben montet ( caltech ) and geraint lewis ( sydney ) for helpful discussions .",
    "the referee also provided excellent suggestions for improving the manuscript ."
  ],
  "abstract_text": [
    "<S> inferring the number of planets @xmath0 in an exoplanetary system from radial velocity ( rv ) data is a challenging task . </S>",
    "<S> recently , it has become clear that rv data can contain periodic signals due to stellar activity , which can be difficult to distinguish from planetary signals . </S>",
    "<S> however , even doing the inference under a given set of simplifying assumptions ( e.g. no stellar activity ) can be difficult . </S>",
    "<S> it is common for the posterior distribution for the planet parameters , such as orbital periods , to be multimodal and to have other awkward features . </S>",
    "<S> in addition , when @xmath0 is unknown , the marginal likelihood ( or evidence ) as a function of @xmath0 is required . rather than doing separate runs with different trial values of @xmath0 , we propose an alternative approach using a trans - dimensional markov chain monte carlo method within nested sampling . </S>",
    "<S> the posterior distribution for @xmath0 can be obtained with a single run . </S>",
    "<S> we apply the method to @xmath1 oph and gliese 581 , finding moderate evidence for additional signals in @xmath1 oph with periods of 36.11 @xmath2 0.034 days , 75.58 @xmath2 0.80 days , and 1709 @xmath2 183 days ; the posterior probability that at least one of these exists is 85% . </S>",
    "<S> the results also suggest gliese 581 hosts many ( 7 - 15 ) `` planets '' ( or other causes of other periodic signals ) , but only 4 - 6 have well determined periods . </S>",
    "<S> the analysis of both of these datasets shows phase transitions exist which are difficult to negotiate without nested sampling .    </S>",
    "<S> [ firstpage ]    stars : planetary systems  techniques : radial velocities  methods : data analysis  methods : statistical </S>"
  ]
}