{
  "article_text": [
    "as lasers become increasingly complicated , especially in nanophotonic systems with wavelength - scale features @xcite , there has been a corresponding increase in the computational difficulty of solving for their nonlinear behavior , as described by the maxwell  bloch ( mb ) equations @xcite .",
    "to address this key challenge in the design and understanding of lasers , a highly efficient approach to finding the non - linear steady - state properties of complex laser systems has recently been introduced , known by the acronym salt ( steady - state _ ab initio _ laser theory ) . in this paper , we present a technique to _ directly _ solve the salt formulation @xcite of the steady - state mb equations ( using finite - difference frequency - domain ( fdfd ) @xcite or finite - element methods ( fem ) @xcite ) , and we demonstrate that , unlike previous approaches to the salt equations @xcite , our technique scales to full three - dimensional ( 3d ) low - symmetry geometries ( such as photonic - crystal slabs  @xcite ) .    the salt equations ( reviewed in sec .",
    "[ sec : salt_pde ] ) simplify the general mb equations by removing the time dependence for steady - state modes , which allows salt solvers to be potentially far more efficient than previous time - domain approaches @xcite , while providing comparable accuracy @xcite .",
    "however , all earlier approaches to salt required the intermediate construction of a specialized constant - flux ( cf ) basis for the laser modes . while efficient and yielding numerous insights in highly symmetric geometries where it can be constructed semi - analytically , the cf basis becomes unwieldy and numerically expensive for complex low - symmetry laser geometries , especially in three dimensions . in our approach",
    ", we solve the salt equations _ directly _ as a set of coupled nonlinear partial differential equations ( pdes ) , using a combination of newton - raphson @xcite , sparse - matrix solver @xcite , and nonlinear eigenproblem @xcite algorithms in standard fdfd or fem discretizations . in sec .",
    "[ sec : examples ] , we validate our solver against previous cf solutions for one - dimensional ( 1d ) and cylindrical systems , while demonstrating that even in one dimension the cf basis rapidly becomes large and expensive as the system is brought farther above threshold . .",
    "we also demonstrate multi - mode laser solutions ( secs .",
    "[ sec : avoidedcrossing ] and [ sec : examples23d ] ) , and reproduce the non - trivial avoided crossing interaction between lasing and non - lasing modes found in ref .",
    "@xcite .",
    "we conclude in sec .",
    "[ sec : examples23d ] with full 3d vectorial laser - mode solutions for a photonic - crystal slab microcavity @xcite .",
    "the appendixes provide further details on the computational techniques we use in this paper , but in general any standard computational method in electromagnetism could be combined with our nonlinear solver algorithms .",
    "we believe that this computational approach provides a powerful tool to design and explore laser phenomena in the complex geometries accessible to modern nanofabrication , which were previously intractable for accurate modeling .",
    "the maxwell - bloch ( mb ) equations provide the most basic formulation of semi - classical laser theory .",
    "the propagation of the electromagnetic field is given by the classical maxwell equations and only the interaction of the field with the gain medium , represented by an ensemble of two - level atoms embedded in a cavity or background linear medium , is treated quantum mechanically .",
    "the mb equations are a set of time - dependent coupled nonlinear equations that are typically hard to solve analytically , except by using many approximations and idealizations . in the generic case of laser systems where such approximations are not valid , the mb equations have typically been solved using numerically expensive time - domain simulations @xcite . for the case of steady - state lasing , as noted above , a much more efficient theory for calculating the multi - periodic solutions of the mb equations is the _ steady - state ab - initio lasing theory _ ( salt ) @xcite .",
    "this theory has proven to be a viable tool for describing laser systems ranging from random lasers @xcite to coupled laser systems @xcite and photonic - crystal lasers @xcite .",
    "it makes no _ a priori _ assumptions about the geometry of the laser system , treats the open ( non - hermitian ) character of the laser system exactly , and the non - linear hole - burning interactions between the laser modes to infinite order .",
    "more realistic and quantitative laser modeling typically requires treating a gain medium with three , four or more relevant atomic levels , but it has been shown that for the steady - state properties , under the same assumptions as salt , the semiclassical equations can be reduced to an effective two - level ( mb ) system with renormalized parameters and solved with essentially the same efficiency as two - level salt @xcite .",
    "salt can also be used to describe quantum properties of lasers by combining the non - linear scattering matrix of salt with input - output theory , leading specifically to a general formula for the linewidth of each mode in the non - linear steady - state @xcite .    for readers familiar with linear resonant cavities in photonics , which essentially trap light for a long time in a small volume",
    ", a laser can be semiclassically understood via the introduction of nonlinear gain ( amplification ) whose strength is determined by an input - energy  pump \" @xcite . as the pump strength is increased , one eventually reaches a  threshold \" at which the gain balances the cavity loss and a steady - state real - frequency lasing ( `` active '' ) mode comes into existence .",
    "a key element is that the gain is nonlinear : increasing the laser - mode amplitude depletes the excited states of the gain medium ( via a  hole - burning \" term in the gain ) , and so at a given pump strength above threshold there is a self - consistent stable laser amplitude . at higher pump strengths",
    ", however , this picture is complicated by the introduction of additional lasing modes , which interact nonlinearly and whose individual gains and losses are balanced simultaneously by the salt equations .",
    "also , while a linear `` resonant mode '' technically refers to a pole in the green s function ( or scattering matrix ) at a complex frequency lying slightly below the real axis , a lasing mode can arise from _ any _ pole that is pushed up to the real axis by the gain , even poles that start out far from the real axis and do not resemble traditional resonant - cavity modes ( for example , in random lasers  @xcite ) .",
    "a strategy for efficiently solving the salt equations was introduced in @xcite and significantly extended in @xcite .",
    "these existing methods can be viewed as a spectral integral - equation method @xcite : they solve the nonlinear problem by first parametrizing each laser mode in terms of a specialized  spectral \" basis , called the  constant - flux ( cf ) states \" , that solve a _ linear _ non - hermitian maxwell eigenproblem parametrized by its ( unknown ) real lasing frequency . because the frequency is required to be real outside the cavity , the photon flux outside the laser cavity is conserved , unlike the well - known quasi - bound states of the system , which are also purely outgoing , but do not conserve flux .",
    "this basis is defined so that at the lasing threshold for each mode , where the non - linear hole - burning interaction term is zero , one member of the basis set _ is _ the lasing solution .",
    "hence , by construction , the basis expansion for the salt solution above but near threshold converges rapidly even when the non - linear terms are taken into account , and the salt equations reduce to finding a relatively small number of expansion coefficients for each mode . in highly symmetric geometries such as 1d or cylindrical systems with uniform pumping",
    ", the cf states can be found semi - analytically in terms of known solutions of the helmholtz equation in each homogeneous region ( e.g. , in terms of sinusoid or bessel functions ) , and such a basis will typically converge exponentially quickly @xcite to the salt solutions .",
    "furthermore , the cf basis can be used as a starting point for other analyses of laser systems , such as to identify the cause of mode suppression due to modal interactions @xcite and exceptional points @xcite .",
    "however , the cf basis also has some disadvantages for complex geometries or for lasers operating far above threshold where the nonlinearities are strong and the convergence is not so rapid .",
    "in complex geometries where helmholtz solutions are not known analytically , the cf basis itself must be found numerically by a generic discretization ( e.g. , fdfd or fem ) for many real frequencies ( since the lasing frequency is not known _ a priori _ above threshold ) and for multiple cf eigenvalues at each frequency in order to ensure convergence .",
    "the lack of separable solutions in low - symmetry two - dimensional ( 2d ) and 3d geometries also increases the number of basis functions that are required ( in contrast to cylindrical systems , for example , where the solutions @xmath0 can be solved one @xmath1 at a time ) . in three dimensions , where the discretization might have millions of points ( e.g. , on a @xmath2 grid ) , even storing a cf basis consisting of hundreds or thousands of modes becomes a challenge , not to mention the expense of computing this many 3d eigenfunctions numerically or of computing the resulting salt equation terms . as a consequence , our approach in this paper is to abandon the construction of the intermediate cf basis and instead to directly discretize and solve the nonlinear salt pdes .",
    "this approach enables us to solve even low - symmetry 3d systems , and greatly enhances the power of the salt approach for modeling and for the design of realistic laser structures .",
    "the origin of the salt equations are the mb equations , which nonlinearly couple an ensemble of two - level atoms with transition frequency @xmath3 @xmath4 to the electric field @xcite : @xmath5,&\\end{aligned}\\ ] ] here , @xmath6 and @xmath7 are the positive - frequency components of the electric field and polarization , respectively .",
    "the coupling to the negative - frequency components is neglected in terms of a rotating wave approximation ( rwa ) which is both very useful for simplifying the equations and very accurate under general conditions .",
    "note that at no point did we or will we assume the standard slowly - varying envelope approximation , which , if used , reduces the accuracy of the mb solutions .",
    "the population inversion of the medium @xmath8 is given by @xmath9 in the absence of lasing , which is roughly proportional to the external pumping rate and thus generally referred to as the pump strength .",
    "one of the useful features of salt is that this pump strength can have an arbitrary spatial profile in addition to a varying global amplitude , such that one can represent different experimental pumping protocols by evolving along a  pump trajectory \" which we parametrize here by @xmath10 , following ref .",
    "note that if there are gain atoms in unpumped regions of the laser , then the pump strength @xmath11 will be negative in these regions and thus the salt equations will automatically take into account absorption due to unexcited gain atoms . @xmath12 and @xmath13 are the relaxation rates of the polarization and inversion , respectively .",
    "the linear cavity dielectric function @xmath14 is homogeneous outside the cavity region , and consequently a finite spatial domain can be used for the laser system with an outgoing boundary condition .",
    "we have assumed a scalar @xmath14 and dipole matrix element @xmath15 although in anisotropic gain media they can be generalized to tensors .",
    "makes two essential assumptions .",
    "first , it assumes that for a fixed pump strength the electric field and polarization eventually reach a multi - periodic steady state , @xmath16 with @xmath17 unknown lasing modes @xmath18 and _ real _ lasing frequencies @xmath19 .",
    "second , salt makes the    using these well - motivated approximations , eq .",
    "can then be written for each lasing mode @xmath20 as @xmath21      { \\mathbf{\\psi}}_\\mu ( { \\bf x } ) = 0,\\ ] ] where the two - level active gain material is described by the non - linear susceptibility @xmath22 . here ,",
    "@xmath23 , is the lorentzian gain curve , where @xmath24 and @xmath25 the population inversion .",
    "the latter contains the spatial hole - burning term that nonlinearly couples all lasing modes , @xmath26 where the @xmath27 are in their natural unit @xmath28 .",
    "the non - linear salt equations , eq .",
    "( [ eq : saltsystem ] ) , for the electric field of the lasing modes , @xmath29 , and for the associated lasing frequencies @xmath19 can be conceived of as the limit of an amplifying scattering process in which the input goes to zero , corresponding to purely outgoing solutions with real frequency or , equivalently , to a pole in the relevant scattering matrix on the real axis . until the external pump is strong enough for the gain to balance the loss",
    "there will be no solution of this type , i.e. , @xmath30 .",
    "however , when increasing the pump strength , non - trivial solutions appear at a sequence of thresholds and at different frequencies @xmath19 .",
    "the non - linear interaction between these solutions is through the spatial hole - burning and depletion of the gain medium , eq.([eq : nlcoupling ] ) : each lasing mode extracts energy from the pump in a space - dependent manner which in general makes it more difficult for subsequent modes to reach threshold , and also effectively changes the index of refraction of the gain medium . as already noted , eq .",
    "has been solved in 1d and 2d geometries , where either the electric or the magnetic field can be treated as scalar , for diverse systems such as random , microdisk or photonic crystal lasers using an algorithm based on expansion of the solutions in the cf basis @xcite . in the most recent and most efficient formulation ,",
    "the _ linear _ non - hermitian eigenvalue problem , @xmath31 u_n ( \\mathbf{x};k ) = 0,\\ ] ] is used to define the optimal set of threshold cf states @xmath32 and eigenvalues @xmath33 .",
    "the function @xmath34 adapts the basis to the spatial pump profile of the experiment of interest and is nonzero only inside the gain medium .",
    "the @xmath32 form a complete basis and satisfy a biorthogonality relation at any frequency @xmath35 .",
    "equation is solved by projecting the lasing modes @xmath36 into the cf basis .",
    "the resulting non - linear eigenvalue equation can only be satisfied at discrete frequencies which hence determine the lasing frequencies , @xmath19 . in principle",
    "one does not need to pre - calculate and store the cf basis at different real values of @xmath35 but it is numerically favorable to do so in general .",
    "however , the wider the lorentzian gain curve , eq .  ( [ eq : gamma ] ) , is compared to the free spectral range , the more memory intensive the storage of the cf basis becomes , which makes calculations problematic in two and three dimensions .",
    "moreover , if the pump profile @xmath34 is fixed and only its amplitude is varied experimentally , then cf states need only be calculated for various @xmath35 values , but if the pump profile also varies along a pump trajectory then one has to calculate new cf states also for many values of @xmath10 @xcite .",
    "for a limited set of highly symmetric cavities , including piecewise - homogeneous 1d slabs and uniform cylinders , the solution of eq .",
    "is known semi - analytically at any @xmath35 . however , for all other geometries , eq .   must be solved numerically for all relevant @xmath35 needed to build a basis .",
    "consequently , for a fully - vectorial treatment of salt in arbitrary cavities , cf bases can not be used without significant computational costs .",
    "our direct solution method eliminates the computation and storage of cf bases and scales easily to 3d geometries .",
    "the basic idea of our new solution method to obtain the lasing modes in the salt is as follows : we discretize eq .  , using standard discretization techniques like fem ( see appendix [ app : fem ] ) or fdfd ( see appendix [ app : fdfd ] ) , and iteratively solve for the lasing modes @xmath18 and their frequencies @xmath19 at successively increasing values of the pump parameter @xmath10 .",
    "this nonlinear coupled problem is most conveniently solved by using the newton - raphson method . for initial guesses ,",
    "we use the modes at threshold when we are close above threshold , and the modes at the previous pump step when we are far above threshold . in order to find the first threshold and the corresponding solution , eq .",
    "is initially solved for @xmath37 as an eigenvalue problem ( evp ) .",
    "the solutions are the resonances or quasi bound states @xmath38 of the passive cavity , corresponding to the poles of the passive scattering matrix ( @xmath39 matrix ) @xcite with frequencies @xmath40 lying in the negative imaginary half plane ( note that we will label all quantities below threshold with overbars throughout the paper ) . while increasing the pump @xmath10 , eq .",
    "is solved without the nonlinearity in eq .   and",
    "the nonlasing modes near the gain frequency @xmath3 are tracked until the first @xmath41 reaches the real axis and turns the corresponding mode into an active lasing mode , @xmath42 .",
    "once we have crossed the first threshold , we use the solutions for @xmath43 and @xmath44 of the eigenvalue problem at threshold as a first guess for the solution of @xmath45 and @xmath46 in the non - linear newton solver slightly above threshold .",
    "the latter already includes the non - linearity @xmath47 which , once the newton solver has converged , we treat as a fixed function like @xmath48 to examine the remaining non - lasing modes @xmath38 at the current pump strength @xmath10 .",
    "this has to be done in order to verify if further modes cross the lasing threshold . for the non - lasing modes , eq .",
    "is thus only nonlinear in @xmath40 and linear in @xmath38 , such that this problem can be cast into a nonlinear evp  @xcite .",
    "the procedure of increasing the pump is now continued by tracking the lasing mode solving the nonlinear coupled salt system , while the non - lasing modes are evaluated from the corresponding nonlinear evp until a second mode reaches threshold . at this point",
    "the number of lasing modes is increased by 1 and the procedure continues with two and more lasing modes in essentially the same way .     with purely reflecting boundary on the left side and open boundary on the right side . the mode shown in red ( gray)corresponds to the intensity profile of the first lasing mode at threshold .",
    "( b ) salt eigenvalues corresponding to the scattering matrix poles for a uniform and linearly increasing pump strength @xmath49 applied inside the slab [ @xmath50 outside ] .",
    "we use a refractive index @xmath51 in the slab ( @xmath52 outside ) , a gain frequency @xmath53 and a polarization relaxation rate @xmath54 .",
    "the trajectories start at @xmath37 ( circles ) and move toward the real axis with different speed when increasing @xmath10 . the first lasing mode ( dash - dotted red line )",
    "activates at @xmath55 ( triangles ) with @xmath56 .",
    "the trajectories end at @xmath57 ( squares ) where a second lasing mode ( dashed green line ) turns active and the two other non - lasing modes ( blue dotted and yellow solid line ) remain inactive . the values at @xmath57 coincide with the data in fig .",
    "[ fig : isalt ] . ]    to illustrate this approach in more detail , we apply it to the simple one - dimensional edge - emitting laser shown in fig .",
    "[ fig : linevp](a ) which already captures all the main features .",
    "we pump the 1d slab cavity uniformly along its length @xmath58 with a pump strength @xmath59 which , above the first threshold , leads to emission to the right . starting with @xmath37 , where the salt system reduces to a simple resonance problem , we increase @xmath10 and observe that the resonance poles move upwards in the complex plane ; see fig .  [ fig : linevp](b ) where the starting point @xmath37 is marked by circles and the pump value at the first threshold , @xmath60 ,",
    "is marked by triangles .",
    "below this first threshold no mode is lasing , such that the non - linear spatial hole - burning term is zero , resulting in the following pde for all non - lasing modes , @xmath61\\right\\rbrace { \\bar{\\mathbf{\\psi}}}_n({\\bf x } )   =   0\\,,\\ ] ] which is linear with respect to @xmath38 , but into which the resonance values @xmath40 enter non - linearly .",
    "starting at the first threshold , the terms @xmath45 and @xmath62 of the first lasing mode enter the spatial hole - burning denominator in eq .",
    "( where @xmath63 ) , resulting in the following equation for the first lasing mode @xmath45 and its wavenumber @xmath46 , @xmath64   \\big\\rbrace { \\mathbf{\\psi}}_1({\\bf x } )   =   0\\ ] ] which is now nonlinear with respect to both @xmath45 and @xmath46 . when continuing to increase the pump , the frequencies corresponding to the active modes are forced to stick to the real axis , while the eigenvalues associated to all other inactive modes continue moving upwards , see fig .",
    "[ fig : linevp](b ) . to detect the activation of further modes , the inactive modes have to be recalculated again , however , this time by additionally taking into account the spatial hole burning contribution of the currently lasing active mode @xmath65 at a given pump strength @xmath10 . for this , we insert the currently active mode into the denominator of eq .   which turns the above nonlinear problem into another nonlinear ( in @xmath40 ) eigenvalue problem , @xmath66 \\big\\ } { \\bar{\\mathbf{\\psi}}}_n({\\bf x } )   =   0 \\label{eq : inactivemodes}\\ ] ] which , however , has the same structure as eq .  .",
    "as soon as the imaginary part of another eigenvalue @xmath40 reaches the real axis , a new laser mode @xmath67 becomes active which increases the size of the nonlinear problem by 1 .",
    "for even higher pump strength and a larger number of lasing modes this procedure continues accordingly .",
    "note also , that the case when a mode shuts down during the pumping process can be incorporated without major effort .",
    "to summarize , the solution of the salt equations reduces essentially to computing the full nonlinear ( in @xmath18 and @xmath19 ) system of pdes through a newton - raphson method and the computation of an evp which is linear in @xmath38 but which still remains nonlinear in @xmath40 .",
    "details of how to obtain the _ active _ or _ lasing _ solutions @xmath68 of the newton problem as well as the _ inactive _ or _ non - lasing _",
    "solutions @xmath69 through the nonlinear evp are provided in the following two sections .      for modes that are lasing , eq .",
    "is nonlinear in the unknowns @xmath70 .",
    "as theses modes are all coupled together through the spatial hole - burning interaction , they must be solved simultaneously . in general ,",
    "such systems of nonlinear equations can be written in the form @xmath71 where the vector of equations @xmath72 is an analytic nonlinear function of the unknown solution vector @xmath73 which again gathers all unknowns @xmath70 .",
    "this nonlinear problem can generally be solved by using the newton - raphson method  @xcite .",
    "the basic idea is that for a guess @xmath74 for the solution  @xmath73 , one can write @xmath75 where @xmath76 is the jacobian matrix of partial derivatives of @xmath72 with respect to @xmath74 . a solution @xmath73 can usually be obtained by iterating eq .   using only the linear terms .",
    "this iterative algorithm converges  quadratically \" ( squaring the errors on each step @xcite ) if @xmath77 is small .",
    "further , we use an analytic evaluation for the jacobian @xmath76 from eq .  , as described in appendix  [ app : jacobian ] , and do not need to compute it using numerical differentiation schemes . since @xmath76 is then a sparse matrix each iteration can exploit fast algorithms for sparse linear equations @xcite .    to solve eq .   on a discrete level",
    ", we project the complex fields @xmath20 of each lasing mode onto a discrete @xmath78-component basis as explained in appendixes  [ app : fem ] ( for a fem approach ) and [ app : fdfd ] ( for an fdfd approach ) .",
    "unlike the cf basis , we use a _ localized _ basis generated once from a grid or mesh .",
    "this is the key to producing _ sparse _ matrices and hence makes the method scalable to the larger bases required in two and three dimensions .",
    "the discretizations on such a basis turn the fields @xmath18 into complex coefficient vectors",
    "@xmath79 , while @xmath19 is required to be purely real .",
    "because the salt equations are not differentiable in the complex fields ( due to the complex conjugation ) , we split our unknown coefficient vectors @xmath79 ( and the vector function @xmath72 accordingly ) into their real and imaginary parts .",
    "the discretized version of @xmath73 then consists of @xmath80 real unknowns ( fields and frequencies ) .",
    "however , we only obtain @xmath81 real - valued equations from @xmath72 .",
    "the underspecification comes from the fact that the hole - burning term @xmath82 happens to be invariant under global phase rotations @xmath83 .",
    "in addition to the problem of underspecification , there is also a problem of stability : for lasing modes slightly above threshold , the amplitude is nearly zero , which would result in problems distinguishing between the solution we want and the trivial solution @xmath84 .",
    "we resolve both issues by normalizing the amplitude and fixing the phase of all lasing modes while keeping track of their amplitudes using a separate variable .",
    "this procedure results in both the number of real unknowns and the number of real equations being @xmath85 .",
    "further details for our method for lasing modes are given in appendix  [ app : jacobian ] .",
    "note that for the newton - raphson iteration to be scalable to higher dimensions and to high - resolution meshes , it is also important to use a scalable solver ( in our case , the sparse direct solver @xcite pastix @xcite was called from the petsc library @xcite because the jacobian is sparse ) . for very large - scale 3d systems , it may become necessary to use iterative linear solvers @xcite for each newton step instead , in which case it is important to select certain pml formulations @xcite .      in order to find the first pump threshold and the corresponding lasing solution as well as to verify when a new mode activates",
    ", the non - lasing modes have to be monitored while changing the pump .",
    "these non - lasing modes @xmath38 are defined as complex - frequency solutions to eq .",
    "that do not enter into the nonlinear hole burning term in @xmath86 , see eq .  .",
    "due to causality constraints , the complex eigenvalues associated with non - lasing modes , @xmath40 always feature @xmath87 , and usually approach the real axis as @xmath10 is increased ( interesting exceptions are discussed in sec .",
    "[ sec : avoidedcrossing ] ) .",
    "when all lasing modes have been determined for a particular @xmath10 , the function @xmath86 is known and can be treated as a fixed function like @xmath88 , see eq .",
    "( [ eq : inactivemodes ] ) . as outlined in sec .",
    "[ sec : solution_strategy ] , this reduces eq .   to a non - hermitian , nonlinear eigenvalue problem ( nevp ) which is _ linear _ in the eigenvectors @xmath89 , but nonlinear in the complex eigenvalues @xmath40 .    for situations where we are only interested in the behavior of a few lasing modes in a small range of the pump parameter @xmath10 ,",
    "newton s method is still a convenient approach to determine the non - lasing modes and , in fact , the only viable method in terms of computational cost for high resolution 2d or 3d computations . in this case",
    ", we typically use standard evp algorithms to solve eq .",
    "first for @xmath90 ( which is usually either linear or quadratic in @xmath91 , depending on the method for implementing the outgoing radiation condition ) .",
    "this provides us all the modes of interest which we then track to threshold with newton s method as @xmath10 is increased . as in sec .",
    "[ sec : active_modes ] , convergence is  quadratic \" , but , unlike for the lasing modes , eq .   can be used with complex unknowns and equations since eq .",
    "is differentiable in all unknowns once @xmath86 is fixed .",
    "the downside of newton s method is that , in the absence of a good initial guess , it can be very unpredictable and slow to converge .",
    "such a situation arises , e.g. , when the modes that can lase are not known _ a priori _ as in the case where a large number of near - threshold modes are clustered together , all with frequencies close to the gain center @xmath3 .",
    "in this instance , a more general and comprehensive method for evaluating the non - lasing modes is required .",
    "such more general techniques exist in terms of nevp solvers @xcite .",
    "one conceptually simple method for our problem is to divide eqs .",
    "( [ eq : saltsystem ] ) and [ eq : inactivemodes ] ) by @xmath92 , turning the rational evp into a cubic evp which can then be linearized at the expense of making the problem three times as large and possibly also very ill - conditioned .",
    "other , more sophisticated solution methods include  trimmed \" linearization @xcite , newton @xcite , jacobi - davidson @xcite , rational krylov @xcite , and nonlinear arnoldi  @xcite . independently of the chosen solution strategy",
    ", we can take into account that only modes which have a spectral overlap with the gain curve @xmath92 near its center frequency @xmath3 are expected to be candidates for active laser modes .",
    "in addition , the lorentzian gain curve of width @xmath12 produces a singularity in the nevp at @xmath93 which may result in spurious numerical solutions . combining these observations ,",
    "we restrict our attention to those eigenvalues @xmath40 that are in the following cropped subpart of the complex plane : @xmath94\\}$ ] . a suitable method that allows us to conveniently include such auxiliary restrictions",
    "is the contour integral method presented recently in @xcite and reviewed in appendix  [ app : beyn ] .",
    "there , the search for eigenvalues is restricted to a region within a smooth contour such as a circle or an ellipse ; see fig .  [",
    "fig : isalt](a ) . by using the residue theorem ,",
    "all poles of the inverse of the differential operator , which are equivalent to the eigenvalues of the same operator , are obtained within the specified contour .",
    "this feature is not only useful for employing this method as a stand - alone solver for non - lasing modes , but also as a complementary tool to check if , in addition to the limited set of non - lasing modes that are tracked with a newton solver , no new modes have entered the region of interest within the chosen contour .      ( a ) . here the lasing modes for the single pump strength @xmath95 are obtained within three iteration steps ( see blue , red , and green colors , respectively ) .",
    "( a ) in the first step , the eigenfrequencies of eq .",
    "are determined for @xmath95 .",
    "full and empty circles represent modes in the upper ( non physical ) and lower ( nonlasing ) part of the complex plane , respectively .",
    "the dashed ellipse indicates the boundary inside of which all eigenvalues are determined using the contour integral method .",
    "the dotted vertical line marks the most non physical mode which is used as a first guess of a lasing mode in the next step ( b ) .",
    "this ansatz shifts not only the corresponding eigenvalue down to the real axis , but also the other eigenvalues are shifted downwards due to the resulting pump depletion ( see modes indicated in red ) .",
    "( c ) after including again the most non - physical mode of the previous step as a guess for the second lasing mode ( see red dot ) and performing the corresponding iteration with newton , we obtain the solution which coincides exactly with the data in fig .",
    "[ fig : linevp](b ) ( see squares there ) , where two modes are active while all other modes are non - lasing . ]    similar to the single - pole approximation in the cf - expansion method @xcite , it is possible to speed up the calculations of the direct solver when the intensity of the laser is only desired at or starting from a specific pump strength @xmath96 . for this",
    ", we first solve the salt equations , eq .",
    ", only at this desired pump strength @xmath96 by neglecting any spatial hole - burning interactions in @xmath86 .",
    "if @xmath96 happens to be above the first threshold , the corresponding nevp will yield complex frequencies @xmath97 that partly lie in the non physical region above the real axis in the complex plane .",
    "this is shown in fig .",
    "[ fig : isalt](a ) , again for the simple 1d edge - emitting laser introduced above .",
    "next , the most non - physical mode , i.e. , the one which has the eigenvalue with the highest imaginary part , is selected and the corresponding solution vector as well as the real part of the corresponding eigenvalue are used as initial guesses in the nonlinear salt solver .",
    "after the nonlinear iteration converges , the corresponding solution is then included in the spatial hole burning term , which effectively reduces the pump within the system and pulls down all inactive modes in the complex plane ; see fig .",
    "[ fig : isalt](b ) .",
    "if some of the remaining inactive modes are still located above the real axis , this procedure is repeated by increasing the number of active lasing modes until all modes lie on or below the real axis .",
    "the latter are then the true lasing modes of the salt at the desired pump strength @xmath96 ; see fig .",
    "[ fig : isalt](c ) .",
    "hence , as long as the nonlinear solver manages to converge , a solution to the salt can be obtained rather quickly .      for numerical computations",
    ", the outgoing radiation condition must be implemented within a truncated , finite domain . in one dimension",
    ", the radiation condition can be expressed exactly @xcite .",
    "this also allows us to shift the boundary of the domain right to the border of the cavity , which decreases the computational cost .",
    "this method is , however , not easily generalizable to two and three dimensions @xcite .",
    ", the cavity has a uniform dielectric @xmath98 a length @xmath99 , and gain parameters @xmath100 .",
    "for the fdtd simulations additionally @xmath101 was used .",
    "the pml method is nearly as accurate as the outgoing boundary condition , but has the advantage of being easily generalizable to two and three - dimensional calculations @xcite . ]",
    "an efficient and robust alternative is to use the standard perfectly matched layer ( pml ) technique @xcite in which an artificial material is placed at the boundaries .",
    "the material has a certain complex permittivity and permeability such that it is absorbing and analytically reflectionless . in one dimension",
    ", the pml technique can be tested against an exact outgoing boundary condition , and the two methods yield results that are nearly indistinguishable , as shown in fig .",
    "[ fig : outgoing_pml ] . also shown in fig .",
    "[ fig : outgoing_pml ] is a comparison with conventional methods of solving the mb equations using finite difference time domain ( fdtd ) simulations demonstrating the validity of the stationary inversion approximation used in the derivation of the salt equations .",
    "both the quantitative agreement between salt and fdtd solutions as well as the former s substantial numerical efficiency over the latter have been previously documented @xcite .",
    "in this section we will validate our solution strategy against the traditional method based on cf states and we will show first results for prototypical laser cavities .",
    "we demonstrate here the accuracy of the presented direct solver method by studying in more detail the 1d edge - emitting slab laser introduced in sec .",
    "[ sec : solution_strategy ] .",
    "one of the advantages of the direct solver , as compared to the cf method , is    ( a ) .",
    "the cavity has length @xmath102 with a refractive index @xmath103 .",
    "the gain curve has its peak at @xmath104 and a width @xmath105 .",
    "the output intensity is given by @xmath106 evaluated at the right boundary @xmath107 .",
    "the pump is constant in the entire cavity .",
    "solid lines describe the results of our solution method . comparing them to the solutions of the cf - state formalism with 30 ( long dashed ) , 20 ( dashed ) , and 15 ( dash - dotted ) cf - basis functions",
    ", one observes that the two approaches converge towards each other for a sufficiently high number of cf states being included . ]",
    "the accuracy of its solutions far above the threshold . in this regime",
    "the cf basis becomes a poorer match for the lasing modes and , as explained in sec .",
    "[ sec : intro ] , a large number @xmath108 of basis functions is required for convergence compared to near threshold .",
    "this is especially relevant for low-@xmath109 ( short - lifetime ) laser resonators such as random lasers or cavities featuring gain - induced states , as considered , e.g. , in @xcite . in fig .",
    "[ fig : lowq_basis_comp ] the intensity of such a low-@xmath109 cavity is plotted with respect to an overall pump strength @xmath10 for a constant spatial pump profile .",
    "the figure contains both the results of the direct and of the cf state solver . for the latter the solution for different numbers @xmath110 of cf states are depicted , demonstrating that for a larger basis the solution converges towards the solution of the direct solver .",
    "our solution method thus leads to an accuracy far above threshold which can only be achieved by the traditional approach with a considerably large number of cf states .      in the following we consider an example for a laser for which the overall spatial profile of the applied pump , @xmath9 evolves non uniformly as a function of the pump parameter @xmath10 .",
    "as recently pointed out in @xcite such a spatially varying pump function can strongly influence the laser output in a counterintuitive way , .",
    "the system we consider to realize such a behavior consists of two coupled one - dimensional ridge cavities ( see inset fig .  [",
    "fig : shutoff_intensity ] ) which feature strong loss in the absence of pump .",
    "the pump function is defined as follows : for values of the pump parameter @xmath10 between @xmath111 and @xmath112 , only the left cavity of the system is pumped uniformly with an amplitude that is linearly increasing from zero ( at @xmath37 ) to a value where the laser is close above threshold ( at @xmath57 ) . for @xmath10 between @xmath112 and @xmath113 the pump in the left cavity is kept constant ( at the value for @xmath57 ) , while the pump in the right cavity is linearly increased from zero ( at @xmath57 ) to the same pump strength as in the left cavity ( at @xmath114 ) .",
    "since the overall pump strength in the cavity steadily increases , one would expect that also the overall intensity of the laser should increase along this `` pump trajectory '' from @xmath37 to @xmath114 .",
    "instead , the laser displays an intermittent shut down within a whole interval of @xmath10 around @xmath115 , as shown in fig .",
    "[ fig : shutoff_intensity ] .     and an air gap of size @xmath116 , see inset .",
    "the refractive index of the cavity material is @xmath117 and the gain curve is centered at @xmath118 with a width of @xmath119 . for the pump parameter in the interval @xmath120 the pump is linearly increased in the left resonator from zero to @xmath121 ( the intensity pattern of the mode lasing at @xmath57 is shown in the inset ) . for @xmath122 the pump in the left resonator is kept at the value of @xmath123 and the pump in the right resonator is increased from zero to the same value as on the left .",
    "the output intensity here is given by the sum of @xmath106 evaluated on both open ends .",
    "as a result of this pump - trajectory , a non - monotonous evolution of the total emitted laser light intensity is observed with a complete laser turn off at around @xmath115 . ]    .",
    "solid lines represent the eigenvalues computed with our new solution method and dashed lines represent the solutions in the absence of the non - linear spatial hole burning .",
    "colors ( red / blue ) are chosen in correspondence with fig .",
    "[ fig : shutoff_intensity ] .",
    "our results show that the laser shut down can be associated with an avoided level crossing of the salt eigenvalues in the complex plane .",
    "details are shown in the top panel ( a ) , where upward triangles mark the eigenvalues where the first mode starts lasing a second time in the course of the pump trajectory .",
    "downward triangles mark the eigenvalues where the second mode starts lasing for the first time . in the main panel ( b )",
    "circles label the eigenvalues at the starting point of the pump trajectory ( @xmath37 ) and squares label the positions of the eigenvalues at the first threshold . ]    in ref .",
    "[ ] this shutdown attributed to the occurrence of an exceptional point , corresponding to a non - hermitian degeneracy in the tcf eigenvalues @xmath124 [ see eq .",
    "( [ eq : cf ] ) ] when parametrized over both the outside frequency @xmath35 and the pump parameter @xmath10 . in the direct solver",
    ", there no longer exists such a two - dimensional parameter space since the frequency @xmath35 can no longer be freely adjusted outside the cavity .",
    "instead , the frequency @xmath35 is already obtained simultaneously with the corresponding lasing mode .",
    "we can thus expect that the poles associated with the ( non)lasing modes reflect , in some form , their vicinity to the exceptional point through a nontrivial behavior along this pump trajectory . indeed , our calculations show that the intermittent laser shut down is realized in terms of an avoided crossing between a lasing pole and a non - lasing pole in the complex plane ( see fig .",
    "[ fig : shutoff_poles ] ) . here",
    ", the solid lines represent the solutions of the full salt while the dashed lines show the movement of the complex eigenvalues when spatial hole burning is neglected .",
    "in fact , we observe two avoided crossings in this plot .",
    "the first one occurs in the range between @xmath37 ( marked as circles in fig .",
    "[ fig : shutoff_poles ] ) and @xmath57 ( marked as squares ) . in this case",
    "the poles associated with the blue and the red mode first attract each other and then undergo an avoided crossing which pushes the red mode towards and , ultimately , beyond the real axis , i.e. , the lasing threshold .",
    "the second avoided crossing occurs in the interval between @xmath57 and @xmath114 , where we observe that the blue pole moves towards the real axis and interacts with the red pole such as to pull it below the real axis , corresponding to switching this mode off . in a corresponding experiment @xcite",
    ", only the second pole interaction can be directly observed in terms of an intermittent laser shut down , followed by a re - emergence of the laser modes at slightly detuned lasing frequencies .",
    "figure  [ fig : shutoff_poles ] also illustrates a crucial point touched on earlier : if one neglects the non - linear spatial hole burning interaction ( dashed lines ) one obtains poles in the upper half of the complex plane which violate the causality principle for the dielectric response . including spatial hole burning ( solid lines ) , keeps all poles below or on the real axis , as required [ see fig .  [ fig : shutoff_poles](a ) ] .",
    "note , that one also observes how the hole - burning interaction influences the movement of the non - lasing modes in terms of a delayed turn on of the blue mode [ see the line between the two triangles in fig .",
    "[ fig : shutoff_poles](a ) ] .     and dielectric index @xmath125 .",
    "tm - polarized modes are considered and the following gain parameters are used : @xmath126 , @xmath127 . increasing the strength of the uniform pump @xmath49 , we encounter strong non - linear modal competition between the first two lasing modes with the result that for sufficiently large pump strength the second lasing mode is found to suppress the first one ( see top panel ) .",
    "the internal intensity is defined as the integral over the cavity @xmath128 .",
    "the real part of the lasing mode profile @xmath129 at the first threshold is shown for both the exact bessel solution ( @xmath130 ) and for the finite difference solution ( see bottom panel , where blue / white / red color corresponds to negative / zero / positive values ) .",
    "as the pump strength is increased , this profile does not change appreciably apart from its overall amplitude . ]      in this section we briefly explore the applicability of our solution strategy to 2d and 3d setups by considering the following prototypical examples : in the 2d case we investigate a circular dielectric resonator and in the 3d case a photonic - crystal slab .",
    "hexagonal lattice of air holes ( with @xmath131 and radius @xmath132 ) in a dielectric medium with index @xmath133 with a cavity formed by seven holes of radius @xmath134 in which a doubly - degenerate mode is confined by a photonic bandgap ( one of these degenerate modes is selected by symmetry , see text ) .",
    "the gain has @xmath135 , @xmath136 , and non - uniform pump @xmath137 , where the pump profile @xmath138 in the hexagonal region of height @xmath139 in the @xmath140-direction , and @xmath141 outside that region and in all air holes .",
    "the slab has a finite thickness @xmath142 with air above and below into which the mode can radiate ( terminated by pml absorbers ) . ]    in the former situation we study a circular disk with uniform index , which is routinely used in the experiment due to its long - lived resonances associated with `` whispering gallery modes '' @xcite .",
    "for this system we study lasing based on tm polarized modes and compare the newton method presented here ( based on fdfd ) with the previously developed cf - state method @xcite . due to the azimuthal symmetry , the resonant tm modes @xcite are exact solutions of the bessel equation characterized by an azimuthal phase @xmath143 ( with @xmath144 being an integer angular - momentum quantum number ) and subject to outgoing boundary conditions . due to the circular symmetry ,",
    "each of the modes with a given value of @xmath144 comes with a degenerate partner mode , characterized by the quantum number @xmath145 . in the presence of the lasing nonlinearities",
    ", a preferred superposition will typically be selected as the stable solution , e.g. ,  the circulating modes @xmath143 , rather than the @xmath146 and @xmath147 standing waves .",
    "the determination of this stable solution in a degenerate lasing cavity is a complex problem that we plan to address in future work . for validation and demonstration purposes in this paper ,",
    "we simply select _ a priori _ a single solution from each degenerate pair by imposing corresponding symmetry boundary conditions . in the case of the circular cavity ,",
    "we choose the circulating modes with a phase @xmath148 for comparison with the cf solutions .",
    "we obtain these by solving for both the sine and cosine modes ( using the appropriate boundary conditions at the @xmath149 and @xmath150 symmetry planes ) and by combining them to construct the exponentially circulating mode .    under these premises , we find that for uniform pump the first mode turns on at @xmath151 and increases linearly in intensity , as seen in fig .",
    "[ fig : cylinder ] .",
    "the second mode turns on at about twice the pump strength as the first threshold . as the intensity of the second mode increases , we observe a reduction and ultimately a complete suppression of the first mode intensity",
    "this mode competition can be attributed to the following two effects : the two modes have a significant spatial overlap , such that they compete for the same gain through non - linear spatial hole burning which is fully incorporated in salt . in addition , as being spectrally closer to the peak of the gain curve @xmath92 , the second mode can profit more strongly from the gain in the disk than the first mode . as a result , the second mode prevails against the first mode in this non - linear competition .",
    "this behavior of interaction - induced mode switching is general and can be found in other laser configurations and nonlinear media as well @xcite . in fig .",
    "[ fig : cylinder ] we show that this behavior is faithfully reproduced with our approach , not only in terms of the modal intensities as a function of the applied pump ( see top panel ) , but also in terms of the corresponding lasing modes which mirror those obtained with the cf - state technique very accurately ( see bottom panel ) .",
    "the second example we consider is a photonic crystal slab with a `` defect '' ( see inset fig .",
    "[ fig : phc ] ) engineered to efficiently trap a mode @xcite .",
    "the photonic crystal is formed in a dielectric slab by holes which are arranged in a hexagonal lattice and the defect is created by decreasing the radius of seven of the holes in the center . in our study , we focus on a te - like lasing mode , situated at the defect ( spatially ) and in the bandgap of the lattice ( spectrally ) . to select one of the degenerate standing - wave solutions , we impose even and odd symmetry at @xmath152 and @xmath153 , respectively , as well as an even symmetry at @xmath154 .",
    "staying close to a potential experimental realization , we choose the pump profile @xmath9 to be uniform inside the slab material s defect region but zero outside and in the air holes . increasing the overall amplitude of this pump profile , we find the lasing behavior shown in fig .",
    "[ fig : phc ] ( main panel ) .",
    "in this paper , we have presented an algorithm for solving the salt equations which describe the steady - state lasing modes and frequencies of lasers with a free spectral range and a dephasing rate that are both large as compared to the population decay rate and the relaxation oscillation frequency .",
    "these conditions are typically satisfied by microlasers with a linear dimension that does not exceed a few hundred wavelengths .",
    "our solution strategy proceeds by a direct discretization using standard methods as fem or fdfd , without the need for an intermediate cf basis .",
    "the resulting increase in efficiency lets our approach scale to complex 2d and 3d lasing structures , which paves the way for future work in a number of directions .",
    "first , it is now possible to study lasing in much more complex geometries than could previously be readily simulated , offering the possibility of discovering geometries that induce unexpected new lasing phenomena .",
    "going one step further , future computations could search a huge space of lasing structures via large - scale optimization ( `` inverse design '' ) , which has already been applied to the design of _ linear _ microcavities @xcite . since our approach is only more expensive than the solution of linear cavity modes by a small constant factor ( e.g. , the number of modes and the number of newton iterations ) it will be the ideal tool for this purpose .",
    "more complicated gain profiles , lineshapes , and other material properties can easily be incorporated into our approach as well .",
    "salt can , e.g. , be coupled to a diffusion equation in order to model the migration of excited atoms in molecular - gas lasers @xcite .",
    "based on the mathematical relation of the multimode lasing equations to incoherent vector solitons ( appendix [ app : vector_solitons ] ) , we believe that numerical methods commonly used in soliton theory can also be adopted to efficiently solve the multimode salt equations .",
    "another intriguing direction of research is the development of a more systematic approach to modeling lasers with degenerate linear modes , which requires a technique to evaluate the stability of the solution and evolve an unstable mode to a stable mode .",
    "finally , many refinements are possible to the numerical methods , such as efficient iterative solvers and preconditioners for the newton iterations of the lasing modes or criteria to alternate between systematic contour - integral evaluation and simpler newton - inverse tracking of the non - lasing modes . in this sense",
    "our approach has more in common with standard sparse discretization methods used to solve other nonlinear pdes than the cf - basis approach ( which is specialized to the salt problem ) and thus opens the door for more outside researchers and numerical specialists to study lasing problems .",
    "the authors would like to thank the following colleagues for very fruitful discussions : s.  burkhardt , d.  krimer , x.  liang , z.  musslimani , l.  nannen , h.  reid , and j.  schberl .",
    ", j.m.m . , and s.r .",
    "acknowledge financial support by the vienna science and technology fund ( wwtf ) through project no .",
    "ma09 - 030 , by the austrian science fund ( fwf ) through projects no .",
    "sfb ir - on f25 - 14 and no .",
    "sfb nextlite f49-p10 , by the people programme ( marie curie actions ) of the european union s seventh framework programme ( fp7/2007 - 2013 ) under rea grant agreement no .",
    "piof - ga-2011 - 303228 ( project nolacome ) as well as computational resources on the vienna scientific cluster ( vsc ) .",
    "d.l .  and s.g.j .",
    "were supported in part by the afosr muri for complex and robust on - chip nanophotonics ( dr .  gernot pomrenke ) , grant no .",
    "fa9550 - 09 - 1 - 0704 and by the army research office through the institute for soldier nanotechnologies ( isn ) , grant no .",
    "a.d.s .  and a.c .",
    "acknowledge the support by the nsf grants no .",
    "dmr-0908437 and no .",
    "dmr-1307632 and the yale hpc for their computing resources .",
    "in this appendix , we provide further details on setting up the newton - raphson iteration for @xmath17 lasing modes .",
    "first , we describe how to fix the phase and normalization for each mode ( as mentioned in sec .",
    "[ sec : active_modes ] ) .",
    "we choose a point @xmath155 and a constant unit vector @xmath156 such that @xmath157 is nonzero for all lasing modes .",
    "this condition is usually satisfied provided that @xmath155 is neither far outside the cavity nor a point of high symmetry .",
    "we then define the quantity @xmath158 and rescale the field such that the _ physical _ field becomes @xmath159 and the rescaled field satisfies @xmath160 with this redefinition , the rescaled field @xmath20 has a fixed phase and a normalization that distinguishes it from the trivial solution @xmath161 .",
    "further we treat the quantity @xmath162 as a separate unknown that contains the mode s amplitude .",
    "the spatial hole - burning [ eq .  ( [ eq : nlcoupling ] ) ] then becomes @xmath163    now , we describe how to construct the vector of unknowns @xmath73 which , after rescaling , should contain @xmath164 , @xmath19 , and @xmath162 .",
    "first , the discretized fields @xmath164 are described by @xmath78-component complex vectors @xmath165 . the @xmath166 real unknowns for each mode can then be written in block form as @xmath167\\\\ { \\mathrm{im}}[\\mathbf{b}_{\\nu}]\\\\ k_{\\nu}\\\\ s_{\\nu } \\end{array}\\right).\\ ] ] the vector @xmath73 we use for the newton - raphson method contains all @xmath168 in sequence , since the lasing modes are all coupled together through the spatial hole - burning interaction and thus must be solved simultaneously .    next",
    ", we construct the equation vector @xmath72 by discretizing the operator @xmath169 $ ] into a sparse complex matrix @xmath170 . in the discrete basis , eq .  ( [ eq : saltsystem ] ) becomes @xmath171 which gives @xmath78 complex scalar equations , and the normalization condition that fixes the phase [ eq .",
    "( [ eq : rescaled ] ) ] becomes the complex scalar equation @xmath172 , where @xmath173 is the discrete - basis representation of the vector function consisting of the unit vector @xmath174 at point @xmath155 and zero everywhere else .",
    "the real and imaginary parts of these @xmath175 complex equations can be written in block form as @xmath176\\\\ { \\mathrm{im}}\\left[\\mathbf{s}_{\\mu}\\mathbf{b}_{\\mu}\\right]\\\\ { \\mathrm{re}}\\left[\\mathbf{e}^{t}\\mathbf{b}_{\\mu}\\right]-1\\\\ { \\mathrm{im}}\\left[\\mathbf{e}^{t}\\mathbf{b}_{\\mu}\\right ] \\end{array}\\right).\\ ] ] the vector @xmath72 we use for the newton - raphson method contains all @xmath177 in sequence , due to the intermodal coupling .",
    "finally , we describe how to construct the ( real ) jacobian matrix @xmath76 ( which is real ) , which consists of @xmath178 blocks @xmath179 that each have size @xmath166 and have the block form @xmath180 we explicitly construct these blocks by taking derivatives of column blocks of @xmath181 with respect to row blocks of @xmath182 , as defined in eqs .",
    "( [ eq : v ] ) and ( [ eq : f ] ) .",
    "first , we see that @xmath183 , while all other blocks of @xmath184 with @xmath185 are zero .",
    "second , we have the columns @xmath186\\ ] ] and @xmath187,\\ ] ] where the derivatives of @xmath170 are diagonal complex matrices that can be obtained straightforwardly by discretizing the same derivatives of the complex scalar function @xmath188 $ ] .",
    "( in the case that exact outgoing radiation conditions are used for @xmath170 , the matrix for @xmath189 may also depend on @xmath19 and this dependence must also be included in the derivative . )    finally , the remaining blocks are given by @xmath190 where @xmath191 is the kronecker @xmath192 , and @xmath193 is the matrix discretization of the real @xmath194 tensor function @xmath195 with the outer product @xmath196 taken over the real and imaginary parts of the vector components of @xmath197 .",
    "in this appendix we provide details on how to implement our salt solution strategy with a high order finite element method ( @xmath198-fem ) @xcite .",
    "most importantly , our approach does not depend on this specific discretization method , but it entails several significant advantages .",
    "specifically , @xmath198-fem can handle highly complex , irregularly shaped geometries and the higher order discretizations tend to exponentially increase the accuracy of the computations ( if all of the boundary discontinuities and corner singularities are properly taken into account ) .    in order to obtain the discretized formulation ,",
    "we truncate the open problem to a bounded computational domain @xmath199",
    ". then we multiply eq .",
    "( [ eq : saltsystem ] ) with an arbitrary test function @xmath200 and integrate over the domain of the cavity . using the green s formula",
    "this leads to the weak formulation @xmath201 \\cdot v & = 0 ,     \\end{aligned}\\ ] ] where @xmath202 denotes the outer normal vector at the boundary  @xmath203 .",
    "the boundary term @xmath204 has to be replaced by a term incorporating the radiation condition at infinity .",
    "formally , this can be done by @xmath205 , where @xmath206 is the dirichtlet - to - neumann operator @xcite . in one dimension and in two dimensions for te modes",
    "the maxwell equations reduce to the well - known scalar helmholtz equation .",
    "furthermore , in the one - dimensional case the boundary integral can be simply replaced by @xmath207 in higher dimensions an appropriate representation of the open boundary becomes more sophisticated , as mentioned in sec .",
    "[ sec : outgoing ] . for a detailed discussion see @xcite , but eq .   can also be simply used as the first - order approximation of the @xmath206 operator .",
    "the unknown laser modes @xmath18 are sought as a linear combination of element basis functions @xmath208 such that @xmath209 where @xmath210 are piecewise polynomials with local support and @xmath78 is the number of degrees of freedom of the system . for more details on the choice of such a basis , based on high - order elements ,",
    "we refer to @xcite .",
    "we use the notation @xmath211 with a complex fem - coefficient vector @xmath212 . inserting the ansatz eq .",
    "( [ eq : ansatz ] ) into eq .",
    "( [ eq : saltweak ] ) , extracting sums out of the integrals , and assembling the contributions for all elements we arrive at the following finite - element scheme in matrix form : @xmath213{\\bf b_\\mu }   = 0,\\ ] ] where the sparse @xmath214-matrices @xmath215 are the stiffness matrix @xmath216 corresponding to the laplacian or curl - curl term , respectively , the mass matrix @xmath217 containing the passive dielectric function , the matrix @xmath218 which only involves the boundary elements and incorporates the outgoing boundary condition , and the nonlinear contribution @xmath219 which accounts for the nonlinear coupling including the spatial hole burning effect .",
    "for finite - difference calculations shown in the main text , the discretization code implemented in @xcite was used .",
    "the complex electric fields @xmath18 were discretized on an @xmath220 pixel grid of equally spaced points with the @xmath221 operator being conveniently discretized using second - order centered differences on a yee lattice @xcite . to impose outgoing boundary conditions , additional pixels of pml were added at the boundaries with the appropriate absorption , as explained in sec .",
    "[ sec : outgoing ] . for each mirror symmetry in a geometry , we were able to halve the computational domain by replacing the pml at the lower walls with the corresponding boundary conditions of the mirror plane . furthermore , for the cases of tm ( @xmath222 ) and te polarization ( @xmath223 ) , the problem size can be reduced by factors of @xmath224 and @xmath225 , respectively , by projecting @xmath170 and @xmath165 into the nonzero field components only . additionally , 2d calculations were performed by setting @xmath226 and the boundary condition in the @xmath227 direction to be periodic .",
    "1d calculations were performed by doing so for both the @xmath227 and @xmath140 directions .",
    "this section reviews the algorithm for solving a nonlinear evp of the form @xmath228 as discussed in ref .  [ ] . the corresponding inverse matrix @xmath229 can generically be written as @xmath230 where @xmath231 are the desired complex eigenvalues and @xmath232 are the corresponding left and right eigenvectors .",
    "the residual term @xmath233 is holomorphic . using the residue theorem the following two matrices",
    "can be defined : @xmath234 @xmath235 where @xmath236 is a diagonal matrix with the diagonal entries corresponding to all the poles of the inverse matrix @xmath229 inside the contour @xmath237 which in turn are the eigenvalues of @xmath238 .",
    "before we show how the desired matrix @xmath239 is computed from the two matrices @xmath240 and @xmath241 , we discuss the realization of the contour integration which is obtained by numerical quadrature . very fast ( i.e. , exponential )",
    "convergence is achieved with the trapezoidal rule ( * ? ? ?",
    "* theorem 9.28 ) , if the contour is an analytic curve such as a circle or an ellipse .",
    "moreover , inverting the large matrix @xmath238 for each quadrature point is numerically expensive and may even be infeasible given that the inverses are fully populated .",
    "this can be remedied by an approximation scheme that exploits the fact that the rank of the matrices @xmath240 and @xmath241 is given by the number of eigenvalues inside the contour and is thus very small compared to @xmath78 : for a random matrix @xmath242 , we merely evaluate @xmath243 at each quadrature point on the contour , i.e. , we reduce the computational cost to the solution of @xmath244 linear systems for each quadrature point .",
    "the parameter @xmath244 has to be selected slightly larger than the expected size of the number of eigenvalues inside the contour . to obtain the matrix @xmath239 ,",
    "we first compute the ( reduced ) singular value decomposition ( svd ) of @xmath245 then we define the matrix @xmath246 and observe that @xmath239 and @xmath247 are similar , i.e. , @xmath248 for some matrix @xmath249 .",
    "therefore their eigenvalues are the same such that the desired eigenvalues @xmath231 can be obtained from the reduced eigenvalue problem @xmath250 in this short sketch we have assumed that @xmath244 is exactly the number of eigenvalues inside the contour so that @xmath251 exists ; if @xmath244 is larger , the svd of @xmath252 has to be replaced with a rank - revealing variant . in total , the algorithm involves a ( dense ) @xmath253 eigenvalue problem , an svd of an @xmath254 matrix , and @xmath255 sparse linear solves , where @xmath256 is the number of quadrature points for the contour integration .",
    "consequently , the bottleneck of a large scale eigenvalue problem is essentially shifted to the solution of perfectly parallelizable linear systems .",
    "the contour integration method assumes that the contour does not pass through eigenvalues ; since eigenvalues close to the contour could affect the convergence of the quadrature scheme , we compute the residuum of the computed eigenvalues found by the algorithm before proceeding .    our computations are performed with ellipsoidal contours and the trapezoidal rule . if contours are desired that are no longer analytic but only piecewise analytic , then the trapezoidal rule should be replaced by other exponentially convergent schemes such as gaussian or clenshaw curtis quadrature . however , with quadrature error control in place , this method guarantees to find all eigenvalues inside the contour , but avoids spurious eigenvalues at @xmath257 .",
    "other eigenvalue solvers either compute all eigenvalues which is neither realistic nor necessary or rely on local convergence properties .",
    "in this appendix we discuss an interesting mathematical connection between the salt lasing equations in the multimode regime and the nonlinear incoherent `` vector solitons '' in photorefractive media  @xcite .",
    "the noninstantaneous nonlinearity in such media allows more than two components of solitons to be self - trapped and thus to form vector solitons based on the mutual incoherence between their various components ( the term `` vector '' refers here to the locked components that propagate together ) .",
    "following  @xcite , the normalized multimode soliton equations for the scalar electric - field envelopes @xmath258 of @xmath17 interacting beams are : @xmath259 where @xmath260 is the total intensity at infinity and @xmath261 is the peak nonlinear index .",
    "equation   describes @xmath17 coupled beams in a saturable optical photorefractive medium .",
    "such an interaction can form vector solitons that consist of two or more components mutually self - trapped in the nonlinear medium . in the small - intensity regime ( kerr limit ) , and when @xmath262 , the resulting governing equations describe the so - called manakov solitons @xcite , which in 1 + 1 dimensions are known to be integrable .",
    "the stationary soliton solutions have the form @xmath263 with the soliton eigenvalues @xmath264 being real numbers . substituting this ansatz into eq",
    ".   leads to the following nonlinear eigenvalue problem : @xmath265 subject to the boundary conditions @xmath266 . by comparing with eq .",
    ", we stress that eq .",
    "is an eigenvalue problem defined on the whole real line @xmath267 , while the laser problem is restricted to the domain of a finite cavity length , @xmath268 .",
    "hence , as a result of the different boundary conditions eq .   admits a continuum family of soliton solutions for any nonzero positive value of the soliton eigenvalue @xmath269 , whereas eq .   admits a discrete family of solutions corresponding to different lasing frequencies that are determined self - consistently",
    "note also that in extension of the above soliton equations , in salt not only the eigenvectors but also the eigenvalues appear non - linearly . in spite of such characteristic differences we can envision applying various numerical methods developed in the field of nonlinear optics and soliton theory to solve efficiently the multimode salt equations . in particular , the most commonly used techniques used to numerically determine vector soliton solutions are the multi - dimensional newton - raphson method @xcite , the self - consistent method @xcite and the recently developed spectral renormalization method @xcite .",
    "73ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ] ",
    "+ 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty link:\\doibase    10.1126/science.284.5421.1819 [ * * ,   ( ) ] link:\\doibase 10.1038/35036532 [ * * ,   ( ) ] link:\\doibase 10.1038/nphys343 [ * * ,   ( ) ] link:\\doibase 10.1038/nphoton.2011.51 [ * * ,   ( ) ] @noop _ _  ( ,  ) link:\\doibase 10.1103/physreva.74.043822 [ * * ,   ( ) ] link:\\doibase    10.1126/science.1155311 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.82.063824 [ * * ,   ( ) ] link:\\doibase 10.1109/tmtt.1987.1133733 [ * * ,   ( ) ] link:\\doibase 10.1006/jcph.2001.6765 [ * * , ( ) ] , , ,  and  ,  eds . ,  @noop _ _  ( ,  ) @noop _ _  ( , princeton univeristy press ,  ) link:\\doibase 10.1103/physreva.52.3082 [ * * , ( ) ] link:\\doibase 10.1109/8.662652 [ * * ,   ( ) ] link:\\doibase 10.1364/oe.16.016895 [ * * ,   ( ) ] link:\\doibase    10.1364/oe.20.000474 [ * * ,   ( ) ] @noop _ _ ,  ed .",
    "( ,  ) \\doibase http://dx.doi.org/10.1016/s0167-8191(01)00141-7 [ * * ,   ( ) ] link:\\doibase 10.1137/s0895479897324172 [ * * ,   ( ) ]",
    "@noop _ _ ,  ed .",
    "( ,  ) link:\\doibase 10.1016/j.jcp.2012.01.013 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevlett.108.173901 [ * * ,   ( ) ] link:\\doibase    10.1088/0951 - 7715/22/1/c01 [ * * ,   ( ) ] link:\\doibase 10.1038/nphoton.2012.298 [ * * , ( ) ] link:\\doibase    10.1103/physrevlett.111.023902 [ * * ,   ( ) ] link:\\doibase    10.1364/oe.19.001539 [ * * ,   ( ) ] _ _ ,  http://www.eng.yale.edu/stonegroup/publications.html [ ] ,   ( ) link:\\doibase 10.1103/physrevlett.109.063902 [ * * ,   ( ) ] @noop _ _ ,  ed .",
    "( ,  ) @noop _ _ ,  ed .",
    "( ,  ) link:\\doibase    10.1038/ncomms5034 [ * * ,   ( ) ] @noop _ _  ( ,  ) link:\\doibase 10.1103/physreva.43.2446 [ * * ,   ( ) ] link:\\doibase 10.1016/0030 - 4018(84)90016 - 6 [ * * , ( ) ] link:\\doibase 10.1103/physreva.34.4000 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.89.033840 [ * * ,   ( ) ] @noop _ _  ( ,  ) @noop _ _  ( ,  ) in @noop _ _ ,  ( ,  )  pp .",
    "link:\\doibase 10.1137/090777542 [ * * , ( ) ] link:\\doibase 10.1137/1021052 [ * * , ( ) ] link:\\doibase 10.1007/bf01731936 [ * * , ( ) ] \\doibase 10.1023/a:1022414805217 [ * * , ( ) ] \\doibase 10.1023/b : bitn.0000039424.56697.8b [ * * ,   ( ) ] link:\\doibase    10.1007/s13160 - 010 - 0005-x [ * * ,   ( ) ] link:\\doibase 10.1016/j.laa.2011.03.030 [ * * , ( ) ] link:\\doibase 10.1103/physreva.58.2077 [ * * ,   ( ) ] link:\\doibase 10.1006/jcph.1994.1159 [ * * , ( ) ] link:\\doibase 10.1090/s0025 - 5718 - 07 - 02037 - 6 [ * * ,   ( ) ] link:\\doibase    10.1103/physreva.84.023820 [ * * ,   ( ) ] link:\\doibase 10.1038/nature01939 [ * * ,   ( ) ] link:\\doibase 10.1209/0295 - 5075/87/34003 [ * * ,   ( ) ] @noop   ( ) ,   link:\\doibase 10.1364/ol.26.001903 [ * * ,   ( ) ] link:\\doibase 10.1063/1.2838173 [ * * ,   ( ) ] link:\\doibase 10.1016/j.wavemoti.2007.07.012 [ * * , ( ) ] link:\\doibase 10.1364/oe.18.003793 [ * * ,   ( ) ] link:\\doibase    10.1364/oe.19.007513 [ * * ,   ( ) ] http://arxiv.org/abs/1406.6659 [ ( ) ] ,   http://books.google.at/books?id=diyymaeacaaj[__ ] , chapman and hall / crc applied mathematics and nonlinear science series ( ,  ) @noop _ _ ,  ed .",
    "( ,  ) @noop _ _  ( , ,  ) @noop _ _ ,  numerical mathematics and scientific computation ( ,  ) link:\\doibase 10.1364/oe.21.030812 [ * * , ( ) ] _ _ ,  http://math.mit.edu/~xdliang/publication/thesis.pdf [ ] ,   ( ) @noop _ _ ( ,  ) \\doibase http://dx.doi.org/10.1063/1.116659 [ * * ,   ( ) ] http://www.jetp.ac.ru/cgi-bin/index/e/38/4/p693?a=list [ * * ,   ( ) ] \\doibase 10.1023/a:1006935801045 [ * * , ( ) ] link:\\doibase    10.1103/physrevlett.91.213906 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevlett.91.113901 [ * * ,   ( ) ] link:\\doibase 10.1364/ol.30.002140 [ * * , ( ) ]"
  ],
  "abstract_text": [
    "<S> we present an efficient and flexible method for solving the non - linear lasing equations of the steady - state _ ab initio _ laser theory . </S>",
    "<S> our strategy is to solve the underlying system of partial differential equations directly , without the need of setting up a parametrized basis of constant flux states . </S>",
    "<S> we validate this approach in one - dimensional as well as in cylindrical systems , and demonstrate its scalability to full - vector three - dimensional calculations in photonic - crystal slabs . </S>",
    "<S> our method paves the way for efficient and accurate simulations of which were previously inaccessible . </S>"
  ]
}