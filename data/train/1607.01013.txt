{
  "article_text": [
    "it is hard to characterize the atmospheres of transiting exoplanets because the atmospheric signal is @xmath1@xmath2 of the stellar flux @xcite .",
    "unfortunately , most current telescopes and instruments were not designed for these precisions .",
    "consider the spitzer space telescope @xcite : many planets have been observed with its infrared array camera ( irac ; * ? ? ?",
    "* ) , and these light curves are a large part of the available data ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "but as with many detectors , the pixels in irac are not uniformly sensitive , and because _ spitzer _ shakes and drifts slightly on timescales of minutes to days @xcite , photons that hit one spot on a pixel may not get counted the same as those hitting other spots .",
    "that means irac can distort the light we see ( e.g. * ? ? ?",
    "there are many detector models that have been used to deal with sensitivity variations on a pixel .",
    "early analyses of _ spitzer _ light curves used polynomials , such as for tres-1 @xcite and hd 209458b @xcite .",
    "@xcite used kernel regression to analyze irac data of m dwarf gj 436 and kepler space telescope data of g - type kepler-19 , respectively .",
    "improved versions of this method were used for hd 189733b @xcite , hat - p-2b @xcite , wasp-14b @xcite , and both hat - p-7b and wasp-19b @xcite . @xcite used independent component analysis ( ica ; * ? ? ?",
    "* ) to reanalyze irac transit light curves of hd 189733b at 3.6  @xmath3 m .",
    "more recently , @xcite used pixel - level decorrelation ( pld ) to remove red noise from irac data of hat - p-20b .",
    "the authors state this method is better than modeling the sensitivity with the stellar position ( i.e. centroids ) for a few reasons , including that pld is analytically sound and runs fast .    in recent years , many researchers have used bilinearly - interpolated subpixel sensitivity mapping ( bliss ; * ? ? ?",
    "this routine works quickly in a markov chain monte carlo ( mcmc ) because no _ explicit _ parameters are used for the detector sensitivity .",
    "instead , bliss divides the light curve by the guess of the planet s signal at each mcmc step , averages the leftover residuals at many spots on the pixel (  knots \" ) by using the centroids , then interpolates to find the sensitivity at each centroid .",
    "this means bliss optimizes the sensitivity at each knot  it runs efficiently because the weight of each knot at the centroids locations can be calculated ahead of time .",
    "many studies have used bliss to model the intra - pixel sensitivity in _ spitzer _",
    "data , as shown in table [ tab : bliss_planets ] .",
    "@xcite and @xcite also included the full - width half - maximum of the pixel response function in their analyses .",
    "a recent study by @xcite found that bliss , pld , and ica are the most accurate and reliable ways to model irac sensitivity : these methods can usually fit eclipse depths to within @xmath4 the photon limit of the true values .",
    "[ tab : bliss_planets ]    .works that use bliss to model the intra - pixel sensitivity in _ spitzer",
    "_ irac data . [ cols= \" <",
    ", < \" , ]     however , bliss does not fit for the detector sensitivity  it merely optimizes it .",
    "thus , each instance of the astrophysical model in an mcmc ( i.e. each location in parameter space ) can have its own bliss map .",
    "the studies in table [ tab : bliss_planets ] either show the map that matches the best model they found ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ) , or leave out the bliss map entirely ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "indeed , these maps vary during an mcmc , but they always do so jointly with the astrophysical model , so one can not explore the full parameter space . with large numbers of bliss knots , one can also end up fitting noise in the light curve .",
    "both of these issues mean bliss may give astrophysical uncertainties that are too small ( e.g. eclipse depths ; * ? ? ?",
    "* ) .    to date",
    ", nobody has published tests of bliss mapping in controlled conditions , i.e. with synthetic data .",
    "we will investigate bliss by using a simple model of _ spitzer _ irac light curves .",
    "@xcite created bliss to handle the intra - pixel sensitivity in irac data because fitting @xmath5 measurements with @xmath0 model parameters in an mcmc was not feasible .",
    "this is still true , so we test light curves that have a modest number of data by using @xmath6@xmath7 bliss knots  these sets of parameters are small enough that we can _ directly _ fit each knot .",
    "we organize our work as follows : in section [ sec : marg_opt ] , we describe how properly marginalizing a parameter differs from optimizing it , and use examples to show that this can affect the fits on other parameters .",
    "then , in sections [ sec : toy_model ] and [ sec : toy_fits ] , we use a toy model to show that optimizing may cause problems even with simple posteriors and gaussian uncertainties .",
    "we describe our model of the _ spitzer _ irac detector in section [ sec : d_model ] , including how we make mock centroids , then introduce our astrophysical model and synthetic light curves in section [ sec : a_model ] . in section [ sec : b_routine ] , we briefly review bliss , and in section [ sec : map_compare ] , we compare bliss maps to the true sensitivity on the pixel .",
    "we then fit our light curves with mcmc and three models for the pixel sensitivity , including two versions of bliss , in section [ sec : synthetic_fits ] .",
    "we discuss our results in section [ sec : discuss_knot ] and summarize our work in section [ sec : conclude_knot ] . for those interested , the details about how we choose parameters for the pixel s sensitivity and the astrophysical signal",
    "are given in appendices [ sec : d_sens_explain ] and [ sec : a_param_explain ] , respectively .",
    "nuisance parameters are parts of a study that are not interesting , but have to be used to get a good answer . in the context of characterizing transiting planets ,",
    "the detector sensitivity is usually modeled in terms of nuisance parameters .",
    "when fitting a model to data , one explores a posterior probability function : this describes how likely one s model is given each choice of parameter values .",
    "posteriors often have many dimensions , so we show a bivariate gaussian as a simplified example in the upper left panel of figure [ fig : optmarg_posts ] .",
    "this posterior describes the arbitrary parameters x and y , where the lighter colors show pairs of these parameters that are more probable .",
    "even though this 2d gaussian is not oriented along x or y , it is still highly symmetric .",
    "suppose now that parameter y is a nuisance variable , and one would like the posterior ( i.e. the fit ) for the  interesting \" parameter x alone .",
    "there are three general ways to find this , though we will focus on two for the moment .",
    "ideally one should marginalize y , or integrate the 2d posterior over all possible y - values , as shown by the ( normalized ) black curve in the lower left panel of figure [ fig : optmarg_posts ] .",
    "instead one could try optimizing y , or finding the highest probability along y for each value of x , shown in the same panel as a dashed magenta curve . for the bivariate gaussian both methods give identical 1d posteriors on x : the median of each curve",
    "is shown with a color - coded circle , while the bars are the @xmath8 intervals .",
    "in other words , how one deals with this nuisance parameter y does not affect their fit for x.     intervals .",
    "for the bivariate gaussian , one infers the same posterior and fit interval for x by marginalizing or optimizing y  this does not happen in the other two cases .",
    "optimizing a nuisance parameter can make the fit on another variable too precise , too conservative , or even biased . ]",
    "some posteriors are less well - behaved ; we show two examples in the remaining panels of figure [ fig : optmarg_posts ] .",
    "the 2d posterior in the upper center is a  gaussian butterfly , \" which has a narrow range of nonzero y - values around @xmath9 that broadens as @xmath10 increases .",
    "the probability density varies only along x and is inversely related to the width in y  that means the marginalized posterior for x is flat ( black curve in the lower center ) and the optimized version peaks at @xmath9 ( dashed magenta curve ) . if one optimizes this parameter y , their median value for x is correct ( circles ) but their uncertainty is too small ( bars ) .    alternatively ,",
    "consider a 2d posterior shaped like a rosenbrock banana function in the upper right panel of figure [ fig : optmarg_posts ] .",
    "this has two thin branches that join near @xmath11 , where the probability density does not vary the same way in both branches .",
    "the posterior for parameter x after marginalizing y , in the lower right panel , is denser on the right and peaks around @xmath12 . by optimizing y , though",
    ", one misses most of the banana s lower branch and so gets a flatter 1d posterior on x. in this case , the uncertainty on x is _ larger _ when optimizing y , and the median is biased towards smaller x - values .",
    "we alluded above to a third method for fitting parameter x , which is slicing the given 2d posterior along the y - value at its peak .",
    "this is nearly the same as optimizing y for our first two examples , but with the rosenbrock banana the 1d posterior for x has just two narrow , distinct peaks ( not shown ) . for higher dimensional cases",
    ", optimizing typically falls somewhere between marginalizing and slicing the full posterior .",
    "we will return to this idea when testing bliss mapping in an mcmc in section [ sec : fiduc_bj ] .    in general , then , optimizing works well when it approximates marginalizing well : having just the silhouette of the posterior seen by the interesting variable(s ) is enough to describe the nuisance parameter(s ) throughout the space .",
    "this is true for the bivariate gaussian , and in principle for multivariate gaussians , too .",
    "once the posterior is non - convex , has an exotic density profile , or is otherwise oddly shaped , optimizing along one or more dimensions is dicey .",
    "this may bias the best - fit values of interesting parameters and make it hard to quote reasonable uncertainties .      even if a posterior seems well - behaved , optimizing nuisance parameters can still cause problems .",
    "we demonstrate this with a toy example : @xmath13 where @xmath14 is data at time @xmath15 , the @xmath16 , @xmath17 , and @xmath18 are coefficients , and @xmath19 is gaussian noise with uncertainty @xmath20 . a sample dataset from this toy model",
    "is shown in the upper left panel of figure [ fig : samp_toy_poly_resids ] .",
    "we use 1001 evenly - spaced times , @xmath21 $ ] , for a chosen set of parameters , @xmath22 .    , where the black curve is the true function without noise .",
    "_ other panels : _ residuals left after subtracting three incomplete models , with no offset , linear , or quadratic term , from the data at upper left : @xmath18-optimize at upper right ( magenta ) , @xmath17-optimize at lower left ( yellow ) , and @xmath16-optimize at lower right ( cyan ) , respectively .",
    "one can estimate each missing term by splitting the residuals into time groups ( dashed vertical lines ) , finding the mean ( large gray circles ) of each group , and getting the leading part of the trend ( black curves ) through these means .",
    "thus , one can try to optimize each term using data residuals . ]",
    "the simplest way to fit these data is to use equation [ eq : toy_2nd_poly ] , where all four parameters are fit directly .",
    "suppose , though , that one wanted to optimize @xmath18 , @xmath17 , or @xmath16 instead ; we show examples of this strategy in the other panels of figure [ fig : samp_toy_poly_resids ] .",
    "this is essentially how bliss treats pixel sensitivity @xcite , where detector parameters are optimized and astrophysical parameters are fitted .",
    "the idea is to make a model with the interesting variables , then subtract this incomplete model from the data to get residuals .",
    "then one splits the residuals into groups by time , takes the mean of each group , and finds the trend through those means . as shown , this optimizes either the offset ( @xmath18 ) , slope ( @xmath17 ) , or quadratic term ( @xmath16 ) , described ideally in section [ sec : marg_opt ] .",
    "we use obvious names for each method : @xmath18-optimize ( upper right , magenta ) , @xmath17-optimize ( lower left , yellow ) , and @xmath16-optimize ( lower right , cyan ) .",
    "we now use the mcmc code ` emcee ` @xcite to fit the data from figure [ fig : samp_toy_poly_resids ] . for each of our four models ,",
    "we use 240 walkers and start them in a small ball near the true parameters .",
    "we also pick uniform priors on each term in equation [ eq : toy_2nd_poly ] .",
    "we burn - in each chain for 250 steps and run them for another 1000 steps , then thin the chains by the longest autocorrelation time , @xmath23 , that ` emcee ` estimates ( @xmath24@xmath25 steps ) .",
    "example fits are shown in the upper row of figure [ fig : samp_toy_poly_allmcmc ] .",
    "the circles are medians of each chain and bars are @xmath8 intervals , as in figure [ fig : optmarg_posts ] .    , using each of the four models described in section [ sec : toy_model ] .",
    "the circles are best - fit values , bars are @xmath8 intervals , and the dotted black lines show the true values of each parameter . _",
    "lower panels : _ distribution of z - scores ( equation [ eq : z_score ] ) for mcmc fits to 100 random datasets from equation [ eq : toy_2nd_poly ] .",
    "the diamonds are mean values and the bars show @xmath8 intervals .",
    "the fitted uncertainty on a model term ( e.g. upper panels ) is reliable if that term s z - scores are centered on zero and have a width of unity .",
    "the z - scores for the offset term in the @xmath16-optimize model are more spread out by a factor of 2 ( highlighted in red ) .",
    "even with simple models and well - behaved data , optimizing a nuisance term can still lead to poor fits on interesting parameters . ]",
    "most of the fits to the mock data are reasonable .",
    "this is no surprise for the full model ",
    "after all , we used the same four parameters to generate the data .",
    "it is also clear that one could optimize @xmath18 or @xmath17 during the mcmc without hurting anything , although these schemes run no faster than the full model .",
    "the @xmath16-optimize method is different , though .",
    "the linear and noise terms are about the same as the other three methods , but the uncertainty on @xmath18 is noticeably smaller .",
    "the center of the interval is also lower than the other methods .",
    "these walkers overlapped the same part of parameter space but tried a smaller range of offset terms .",
    "we next try fitting 100 different datasets , where we randomly pick @xmath26 $ ] , @xmath27 $ ] , @xmath28 $ ] , and @xmath20 from a normal distribution with mean 50 and width 10 .",
    "we use all four methods with the same mcmc setup as before , and calculate the z - scores for each term : @xmath29 where @xmath30 is the z - score , and @xmath31 and @xmath32 are the fitted value and uncertainty of parameter @xmath33 . if a parameter estimate is unbiased and accurate , then the average z - score should be close to zero and the standard deviation should be close to unity .",
    "we show the z - scores in the bottom panels of figure [ fig : samp_toy_poly_allmcmc ] , where diamonds are the mean values .",
    "the trend in these z - scores is obvious . as we expect , the full model , @xmath18-optimize , and @xmath17-optimize fits look fine : on average we get close to the real parameters and have reasonable uncertainties .",
    "this is even true for parts of @xmath16-optimize , but not the offset that this method finds .",
    "in general this uncertainty on @xmath18 is too small , which is why the z - scores are more spread out than any other fit , by about a factor of 2 . in other words ,",
    "if one were to model this kind of data using @xmath16-optimize , they would be too precise on their guess for @xmath18 .",
    "although this case mimics the _ fits _ in the lower center panel of figure [ fig : optmarg_posts ] , the posterior for our toy model looks like a 4d ellipsoid ( i.e. go stone ) .",
    "either @xmath16-optimize does not  optimize \" in the sense of section [ sec : marg_opt]possible but unlikely  or the density of this posterior varies in an unexpected way .    it may seem silly to optimize the quadratic term in a quadratic equation  if one expects this term , then they should probably fit for it directly .",
    "bliss , however , uses the same strategy to optimize the _",
    "entire _ detector signal , not just one part of it .",
    "as acknowledged by @xcite , this is an expedient shortcut since fitting for @xmath0 knot values is not computationally feasible .",
    "our example posteriors and toy model demonstrate that this shortcut may come at the price of accurate astrophysical parameters .",
    "we begin by simulating the _ spitzer _ detector .",
    "each wavelength channel of irac has an array of pixels , and due to the peak - up , the centroids usually stay within a single pixel for an entire eclipse observation @xcite . in real irac data ,",
    "the image falls on different parts of the pixel because _ spitzer _ both shakes and drifts slightly _ and _ has changes in optics due to thermal expansion and contraction .",
    "we mimic this by modeling the centroid time - series , @xmath34 , with the pointing equations in appendix a1 of @xcite , but make two changes .",
    "we drop their short - term drift because we assume the eclipses we will model do not happen just after a re - pointing . for full - orbit phase curves",
    "where the centroids often cover larger regions of the pixel ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ) , including this drift could make polynomial models ( section [ sec : synthetic_fits ] ) less accurate at describing the sensitivity variations .",
    "we also use regular , as opposed to fractional , brownian motion to make the noise for their  jitter \" term .",
    "this change should not influence the centroids on timescales longer than @xmath25 seconds , i.e. the jitter period .",
    "examples of these centroids are shown in the left panels of figure [ fig : samp_cents_pixsens]this observation lasts 6 hours and has 2160 data , @xmath35 , or about 10 seconds per point .",
    "measurements , or about 10 seconds per datum . _",
    "right : _ an example sensitivity map for the region of the pixel sampled by these centroids ( gray dots ) , where lighter colors are more sensitive areas . the darkest and lightest colors are outside the sensitivity range shown ",
    "no centroids are located in these spots . ]",
    "we model the sensitivity of the central pixel , where @xmath36 are both between @xmath37 $ ] , using a polynomial : @xmath38 where @xmath39 is the sensitivity map and @xmath40 is the polynomial order ( we use @xmath41 ) .",
    "the @xmath42 are coefficients , and the details about how we pick these are given in appendix [ sec : d_sens_explain ] .",
    "this equation keeps the average sensitivity close to unity ; we show an example map in the right panel of figure [ fig : samp_cents_pixsens ] .",
    "the center of the pixel , @xmath43 , is the most sensitive region on the real irac detector ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ) this is not always true for equation [ eq : sens_vars ] .    with the centroids and sensitivity map",
    ", we then make a detector signal , @xmath44 , using : @xmath45 that has a given amplitude , @xmath46 . after getting @xmath44 and before doing anything else",
    ", we also randomly move each centroid using a bivariate gaussian to simulate imperfect centroiding .",
    "these shifts are on the order of @xmath1 pixels ( somewhat smaller than noted in * ? ? ?",
    "* ) and do not strongly affect our results .",
    "the astrophysical signals we are interested in are planetary eclipses , and we use hot jupiters as the model because these are the planets that bliss is often used for .",
    "we assume our planets are on circular orbits and only consider thermal emission .",
    "hot jupiters exhibit thermal phase variations ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) , which we model as a sinusoid , @xmath47 : @xmath48 where @xmath49 is the half - amplitude , @xmath50 is the orbital period , @xmath15 is the time from the start of the observation , and @xmath51 is the phase offset .",
    "the constant keeps @xmath47 close to unity , and we fix @xmath52 hrs because real observations are about that long",
    ".    then we inject the eclipse to get the full astrophysical model , @xmath53 : @xmath54 where @xmath55 is the eclipse depth , @xmath56 is the time at the center of eclipse , and @xmath57 is the time from @xmath56 to ingress or egress .",
    "we choose @xmath58 hr because real eclipses of hot jupiters usually last a couple hours .",
    "the bar in equation [ eq : a_signal ] means we take the average of all data during the eclipse , so ingress and egress are instantaneous and the bottom of the eclipse is flat .",
    "the details about how we choose the other parameters for @xmath53 are given in appendix [ sec : a_param_explain ] .",
    "finally , we combine equations [ eq : d_signal ] and [ eq : a_signal ] to create our model of _ spitzer _ light curves : @xmath59 where @xmath60 is the flux , @xmath44 is the detector signal from section [ sec : d_model ] , and @xmath19 is photon ( gaussian ) noise with uncertainty @xmath20 .",
    "we characterize our light curves using the normalized detector amplitude , @xmath61 , and the significance of the eclipse , @xmath62 , defined by : @xmath63 where @xmath64 is the number of data during the eclipse .",
    "an example light curve is shown in figure [ fig : samp_lightcurve ] , made with the centroids and sensitivity map in figure [ fig : samp_cents_pixsens ] .",
    "the upper panel shows the astrophysical and detector signals as a dark dashed curve and an orange curve , respectively .",
    "these parts are combined in the lower panel : the brown curve is the flux one would see without photon noise , and the black circles are data points , binned in groups of 20 for clarity . for this case , the eclipse is a @xmath65 detection and the detector signal has the same amplitude as the eclipse depth . in real irac data , @xmath46 can be many times larger than @xmath55 ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ) we test more values of @xmath66 in sections [ sec : map_compare ] and [ sec : more_synth_fits ] .    .",
    "the orange curve shows a detector signal made with equation [ eq : d_signal ] and using the centroids and sensitivity map in figure [ fig : samp_cents_pixsens ] .",
    "the eclipse depth and amplitude of the detector signal are equal in this example  we test more values in sections [ sec : map_compare ] and [ sec : more_synth_fits ] . _",
    "lower : _ a mock light curve made with equation [ eq : flux_model ] and the above signals .",
    "the brown curve shows the flux with no photon noise and the black circles are data , binned in groups of 20 for clarity .",
    "the eclipse is a @xmath65 detection for these data . ]",
    "we give a brief summary of bliss here  for details , see @xcite .",
    "a light curve has two main parts : a detector signal ( e.g. due to varying sensitivity on the pixel ) and an astrophysical signal ( e.g. a planetary eclipse ) .",
    "if one knew the astrophysical part and _ divided _ it out of the light curve , all that should be left is the detector signal and photon noise .",
    "each residual is paired with a centroid , so one can group the residuals with a mesh of bliss  knots , \" @xmath67 ( left panel of figure [ fig : samp_mesh_bvstrue ] ) , take the average of each group , and set the values of the knots to these averages .",
    "this estimates what the sensitivity looks like on the pixel around the centroids , and each purple star in figure [ fig : samp_mesh_bvstrue ] is a good bliss knot , or one that has at least one centroid nearby .",
    "note that any knots with just one linked centroid will fit noise by definition , but this can only affect a tiny part of the detector model and so is negligible .",
    "mesh of bliss knots covering the centroids ( gray dots ) from figure [ fig : samp_cents_pixsens ] .",
    "the stars are good knots , or those with at least one centroid nearby , while light red x - marks are bad knots .",
    "the color scale shows how many centroids are linked with each knot ; darker purple stars are knots where more data is averaged to guess the sensitivity there .",
    "bliss then interpolates the sensitivity at each centroid using the four surrounding knots . _",
    "right : _ discrepancies between the bliss and true maps , using equation [ eq : knot_discrep ] . darker reds ( blues )",
    "are where a bliss knot has a higher ( lower ) sensitivity than the pixel at that spot ; the color scale shows up to @xmath68 .",
    "the average discrepancy is about @xmath69 , while the standard deviation is roughly @xmath70very close to the expected rms value of unity .",
    "bliss knots are usually as accurate as the noise in a light curve , but the map can be unreliable when this photon noise is low . ]    to figure out what @xmath44 is , bliss interpolates the sensitivity at each centroid by using the four surrounding knots ( hence bilinear interpolation ) . for centroids where",
    "any of those four knots are unconstrained by the residuals ( light red x - marks in figure [ fig : samp_mesh_bvstrue ] ) , bliss does nearest neighbor interpolation instead .",
    "usually a few of our centroids are just outside the mesh of bliss knots , so we extrapolate the sensitivity at those spots when we can . during the course of an mcmc , a new astrophysical signal is made at each step , the new residuals are averaged , and the detector signal is recalculated . thus , bliss tries to attribute unfitted variations to the detector .",
    "bliss has been used many times to handle sensitivity variations in irac data ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) , and has been shown to be reliable and accurate at estimating the eclipse depths of xo-3b @xcite .",
    "but , no research has looked at the accuracy or precision of bliss _",
    "maps_. we first generate a true sensitivity map by evaluating equation [ eq : sens_vars ] at the location of each knot , which is ideally the best map one could get with bliss .    to guess what the best - fit bliss map would be , we next take @xmath71 in equation [ eq : flux_model ] and use those residuals in the bliss routine ( this estimate is good ; section [ sec : synthetic_fits ] ) .",
    "then we compare the bliss and true maps knot - by - knot : @xmath72 where @xmath73 is the discrepancy of knot @xmath74 , @xmath75 is the value of a bliss knot , @xmath76 is the true sensitivity at the same knot , and @xmath77 is the number of centroids linked to that knot .",
    "the denominator in equation [ eq : knot_discrep ] is the photon noise per bin ( assuming poisson statistics ) , which implicitly weights the discrepancies by the data per knot ( i.e. star color in figure [ fig : samp_mesh_bvstrue ] ) . by getting @xmath78 at each knot",
    ", we can see how good or bad the bliss map is , as shown in the right panel of figure [ fig : samp_mesh_bvstrue ] .    as this demonstrates",
    ", the knots match the true sensitivities to within a few factors of the ( binned ) photon noise ; the largest discrepancy we find is about @xmath79 . even though the astrophysical model is known perfectly here , the bigger discrepancies can still happen anywhere , including near the center of the map where there are more data per knot .",
    "the standard deviation of equation [ eq : knot_discrep ] for all the knots tells us how reliable the bliss map is  average discrepancy matters less because _ spitzer _ is poor for absolute photometry of planetary eclipses ( e.g. * ? ? ?",
    "similar to z - scores in section [ sec : toy_fits ] , we expect an rms value close to unity if the map is good .",
    "for example , the standard deviation on @xmath78 in figure [ fig : samp_mesh_bvstrue ] is about 0.99 ( average is around @xmath69 ) , so these bliss knots are indeed a good match to this pixel s true sensitivity .",
    "we test this for other light curves by varying four parameters : the number of data points ( @xmath35 ) , the total amount of bliss knots ( @xmath67 ) , the eclipse significance , and the normalized detector amplitude .",
    "we start by making an @xmath80 logarithmically - spaced grid of @xmath81 $ ] , @xmath82 $ ] , @xmath83 $ ] , and @xmath84 $ ] , respectively .",
    "then we make a light curve ( equation [ eq : flux_model ] ) at each grid point , get the bliss map as described above , and use equation [ eq : knot_discrep ] to find the standard deviation of @xmath78 . in general , we find a trend in rms values with @xmath85this is the detector amplitude relative to the astrophysical precision on eclipse timescales ( section [ sec : a_model ] ) .",
    "we also find a similar trend with the average data per bliss knot , @xmath86 .",
    "however , the number of _ good _ knots for given data depends on the details of the centroid cluster , so we will focus on @xmath87 below .    for given amounts of data and knots , when @xmath87 is low",
    "the photon noise is much bigger than the detector amplitude , and the standard deviation of @xmath78 is around unity . in these cases",
    "a bliss knot is generally as accurate as the noise in the residuals .",
    "as @xmath87 goes up , the photon noise decreases , and the knots get closer to the true sensitivities while still being noise - limited .",
    "we eventually find an ideal regime , covering about an order of magnitude in @xmath87 , where bliss maps look like a pixel s true sensitivity _ and _ the rms of @xmath78 stays around unity . above this range",
    ", however , the photon noise decreases so much that the standard deviation of @xmath78 grows , even though the knots stay close to their true values .",
    "these are bad levels of @xmath87 because bliss knots are inaccurate for the data and so the maps are unreliable .",
    "as an example , with @xmath88 and @xmath89 , we get ideal bliss maps when @xmath90 $ ] , roughly . assuming that real observations have ( and use ) a similar number of data ( and knots )",
    ", we can guess how good the bliss maps from the studies in table [ tab : bliss_planets ] are .",
    "we estimate the detector amplitudes from uncorrected light curves or the maps if shown , and the eclipse significances from binned light curves that have uncertainty bars . in general",
    ", we find that most studies ( e.g. * ? ? ?",
    "* ) have @xmath87 values within our ideal range  these bliss maps should be reasonable .",
    "two exceptions are @xcite , where we estimate @xmath91 $ ] for wasp-14b at 3.6 @xmath3 m , and @xcite , with @xmath92 $ ] for hd 149026b at 5.8 and 8.0 @xmath3 m . based on the above trend , the bliss knots in these studies could be inaccurate , by a factor between about 1.251.5 .",
    "naturally , higher values of @xmath87 would be worse .",
    "@xcite states that , when possible , one should choose a bin size ( i.e. number of knots ) for bliss which does not depend on the eclipse depth and gives less scatter in the best - fit residuals than nearest neighbor interpolation . for a given light curve , it seems that one could also use @xmath87 to select an ideal number of knots for their bliss routine .",
    "the detector signals ( i.e. sensitivity at each centroid ) behave similarly to the maps .",
    "when we use the bliss and true sensitivity maps to interpolate @xmath44 for a set of centroids , both typically fit the residuals equally well ( i.e. similar chi - square values ) when @xmath87 is in or below the ideal range . for larger @xmath87 where the knots are inaccurate",
    ", bliss maps usually do a little better , but both fits tend to be poor . the photon noise is low in these cases , and neither map can model the detector signal to within the precision of the data . still , in most cases modeling @xmath44 with bliss is statistically as good as interpolating from the true sensitivity at the knots .    because @xcite shows , and our work suggests , that the binning for bliss can affect how one fits an eclipse depth , we will test a few sizes for the knot mesh on our synthetic data ( section [ sec : more_synth_fits ] ) .",
    "though we will make practical choices for @xmath35 and @xmath67 to run mcmc on our light curves , these data mimic published studies and our results should apply to real _ spitzer _ observations .",
    "we want to fit our light curves using mcmc and bliss , but can not use lots of bliss knots because ` emcee ` would run very slowly with that many parameters .",
    "indeed , this why @xcite introduced the residual optimization scheme in the first place .",
    "instead , we start with @xmath93 and @xmath94our average data per good bliss knot is typically within @xmath95 $ ] .",
    "these ratios are smaller than figure 6 of @xcite suggests , but may be similar to other bliss studies ( e.g. figure 5 of * ? ? ?",
    "more importantly , our bliss maps should be reliable for light curves where the product of the eclipse significance and the normalized detector amplitude is less than @xmath96 . as described in section [ sec : map_compare ] , these values of @xmath87 are good approximations for those in published papers . in other words",
    ", we want our fits to represent real data while remaining computationally feasible .",
    "we use three methods to handle the pixel s sensitivity .",
    "since the true sensitivity is generated with a polynomial model , we try polynomial mapping , or @xmath97-type . here",
    "though , we choose @xmath98 instead of the real @xmath41 to mimic our inexact understanding of the intrinsic detector sensitivity ( we test the impact of this choice below ) .",
    "we also use bliss as described by @xcite , or @xmath99-type .",
    "we further want to fit the knots directly , so we modify bliss and make each knot a jump parameter inside the mcmc ( @xmath100-type ) .",
    "everything else about bliss is the same in the @xmath99- and @xmath100-type methods .",
    "we use ` emcee ` as in section [ sec : toy_fits ] , and for each method ( @xmath97- , @xmath99- , and @xmath100-type ) we choose the number of walkers to be @xmath4 the number of @xmath100-type parameters .",
    "the priors on all parameters are uniform , and we again start the walkers in a small ball near the true inputs .",
    "we run each chain until all parameters stabilize for at least @xmath101 the largest autocorrelation estimate , @xmath23 , then drop the burn - in and thin the chains by @xmath23 .",
    "typically , this takes @xmath102@xmath103 steps and ` emcee ` calculates @xmath104 $ ] steps .",
    "for our example light curve from figure [ fig : samp_lightcurve ] , we show all three posteriors on the eclipse depth in figure [ fig : samp_mainposts ] . here",
    "the real depth , @xmath105 , is shown with dashed vertical lines . at the top of each panel ,",
    "we show the median depth as a circle and the @xmath8 intervals with bars ( as in figures [ fig : optmarg_posts ] and [ fig : samp_toy_poly_allmcmc ] ) .",
    "remember that here @xmath106 and @xmath107 .",
    ", fit using mcmc and three models of the sensitivity variations : polynomial or @xmath97-type at the top ( green ) , bliss or @xmath99-type in the middle ( blue ) , and jump - bliss or @xmath100-type at the bottom ( red ) . the dark dashed lines in each panel show the true eclipse depth , @xmath105 .",
    "the circles are medians of each posterior and the bars show the @xmath8 intervals .",
    "the scales for the eclipse depth are the same , though @xmath108 of the @xmath99-type posterior at larger depths is not shown .",
    "all three methods are accurate but the polynomial model is the most precise . ]",
    "the @xmath97-type fit is clearly good since the posterior is gaussian and the @xmath8 interval includes the true eclipse depth .",
    "this is similar for @xmath100-type , although this posterior has heavier tails and so is less precise .",
    "the @xmath99-type posterior is different .",
    "this peak is near the true depth , but the left tail is heavy and a few samples go up to @xmath109 the real depth ( not shown ) .",
    "we find that @xmath100-type has the lowest chi - square , although all three models have @xmath110 .    as @xcite describes in their appendix a , comparing bliss to polynomial models using bayesian information criterion ( bic ; * ?",
    "* ) is not sound : many parameters do not overlap and each bliss knot only interacts with a subset of the data .",
    "one could try modifying bic to account for the latter problem , but that is beyond the scope of this paper .",
    "we will instead compare models in section [ sec : more_synth_fits ] by using accuracy and precision of the fits on the eclipse depth .",
    "for the @xmath99-type model , we find that the best - fit bliss map ( not shown ) is similar to the one we estimated in figure [ fig : samp_mesh_bvstrue ] , aside from a few knots .",
    "we get the same results when we test other light curves , and that means we can usually estimate the best - fit bliss map well without running an mcmc",
    ". our findings in section [ sec : map_compare ] are therefore robust .    - and @xmath100-type models .",
    "lighter colors mean those knots varied relatively more in the @xmath99-type mcmc ; the highest ratios are near the center of the map .",
    "the value of @xmath99- and @xmath100-type knots tend to vary as much during an mcmc , regardless of whether they are jump parameters . ]    to test how the bliss knots vary in the mcmc , we save the knots at every step in the @xmath99-type model and compare the standard deviation of each @xmath99- and @xmath100-type knot in figure [ fig : samp_knots_std ] . even though the @xmath100-type knots are free parameters , the @xmath99-types can vary nearly as much ( color scale ) , especially those in the center of the map .",
    "this is probably because there are more data per knot here , meaning the central knots have the biggest impact on the detector signal and so vary the most .",
    "we see this happen in every light curve we test ( i.e. ratio of standard deviations between @xmath111 $ ] typically ) , so in general bliss knots act like real variables rather than fixed parameters .",
    "we also try slicing through the @xmath100-type mcmc chain ( i.e. posterior ; section [ sec : marg_opt ] ) in the knot parameters .",
    "this shows how the fit to the eclipse depth changes when fixing the knot values , which should be a worst - case scenario for bliss . with @xmath112 good knots , though , this is tricky .",
    "for example , the density of a @xmath113-dimensional gaussian depends on the @xmath20-scaled distance @xmath114 from the mean ( mahalanobis distance ; e.g. * ? ? ? * ) , where @xmath115 has a @xmath116 distribution ( e.g. * ? ? ? * ) .",
    "the chance that a point lies within @xmath117 in our case , or @xmath8 in _ all _ knots , can be estimated as @xmath118 .",
    "our thinned chains only have @xmath119 samples , so it is near - impossible to have any sample close to the best - fit value of every knot .",
    "discrete samples are often _ very _ spread out in a high - dimensional space .    in practice",
    "we take slices much larger than @xmath8 through the @xmath100-type knots to capture close to @xmath120 of the samples .",
    "the above example predicts this happens when @xmath121 .",
    "when we slice around the maximum likelihood value of the knots , we only need @xmath122 .",
    "the median eclipse depth is about @xmath123 lower than in the full chain , and the interval shrinks by roughly @xmath124 . if we slice around the median knot values instead , we only need @xmath125 .",
    "the median eclipse depth goes down by @xmath126 , but the interval is now about @xmath127 smaller .",
    "the low @xmath114-values we find imply that the @xmath100-type posterior is not a multivariate gaussian .",
    "when we test other light curves , the @xmath100-type slices often look similar .",
    "median eclipse depths are usually within @xmath120 of those in the full chains ( i.e. good for @xmath65 eclipses or better ) , and the intervals between @xmath128 narrower to @xmath120 _ wider_. the exceptions are when the eclipse significance is low : these fit intervals on the depth are around half the width of those in the full chains . but generally , slicing through the @xmath100-type posterior  which limits the value of each knot  does not affect the fitted eclipse depth much .",
    "so far we have ( mostly ) considered the fits for a single light curve .",
    "we now try fitting different datasets and changing how many bliss knots we use . for consistency",
    ", we fix all eclipse depths to @xmath105 and test 5 light curves per case we consider .",
    "because we find above that the @xmath99- and @xmath100-type models are similar , we drop @xmath100-type from here on to speed up our fits .",
    "we repeat the @xmath97- and @xmath99-type mcmcs as described in section [ sec : synthetic_fits ] , and since there are several types of changes to consider , we split these sets of light curves into groups .",
    "note that the fits from figure [ fig : samp_mainposts ] are always part of the cases shown as circles below .",
    "we find all @xmath129 and either model can have the lowest value unless stated otherwise .",
    "we first try varying both the eclipse significance and normalized detector amplitude , and show the mean and standard deviation of the z - scores ( equation [ eq : z_score ] ) for the eclipse depth in the left panel of figure [ fig : zscores_accprec_sede ] .",
    "the @xmath97-type models are colored green and the @xmath99-types are blue .",
    "there are also two kinds of z - scores : the darker markers are the fits , while the lighter markers use more conservative intervals we get by testing for time correlations in the best - fit residuals ( @xmath130 plots ; e.g. * ? ? ?",
    "* ; * ? ? ?",
    "these pairs are clarified with connecting lines and the lighter versions are only shown when they do not overlap their darker marker .",
    "are part of the circles  with the @xmath97-type data shown in green and the @xmath99-type in blue .",
    "lighter markers show , when significant , how the z - scores change by accounting for time - correlated residuals via the @xmath130 method ( section [ sec : more_synth_fits ] ) , where the connecting lines are for clarity .",
    "the background shows the expected scatter ( @xmath131 monte carlo ) for sets of 5 reliable z - scores , where lighter colors are more probable and the dashed magenta line is the 99% ellipse .",
    "_ right : _ the reciprocal of both the rms discrepancy ( i.e. accuracy ; z - score numerators ) and rms width of the fit interval ( i.e. precision ; z - score denominators ) for these eclipse depths .",
    "both axes are logarithmic .",
    "note that inflating uncertainties via the @xmath130 method ( lighter markers ) only affects the precision of the fits .",
    "the solid black line shows ideal cases , where accuracy and precision are equal .",
    "parallel , the dotted cyan and dashed red lines show where the ratio is @xmath132 and @xmath133 too conservative and too precise , respectively  the cyan and red background is qualitative for how these trends continue . for reference ,",
    "the black dash - dot lines show where each rms value is equal to the eclipse depth .",
    "bliss gives better fits when the eclipse significance and detector amplitude are both low ( triangles ) or high ( squares ) ; the polynomial model does better otherwise . ]    in section [ sec : toy_fits ] we described that parameter fits are reliable if , after many samples , the z - scores on the fits have an average of about zero and a standard deviation around unity .",
    "each marker here only uses 5 samples , so the background shows the scatter we get when drawing , via monte carlo , @xmath131 sets of 5 samples from a standard normal distribution .",
    "lighter areas are more probable and the dashed magenta ellipse contains 99% of the monte carlo sets .",
    "if a marker is outside this region , it likely means the eclipse depths in that case are being fit unreliably .",
    "bliss has some trouble when the eclipse is noisier and the detector signal is larger ( blue diamond ) , though the @xmath134 on these fits are always better than @xmath97-type .",
    "lowering the photon noise by a factor of 25 means both models give suspect fits ( darker squares ) until @xmath130 factors are included .",
    "z - scores combine the accuracy ( i.e. discrepancy from a true value ; numerator ) and precision ( i.e. width of an interval ; denominator ) of each _ individual _ fit . by separating these pieces",
    ", we can also compare the overall accuracy and precision for _ types _ of fits .",
    "the right panel of figure [ fig : zscores_accprec_sede ] plots the reciprocal of both the rms discrepancy and rms interval width  accuracy goes up logarithmically towards the top and precision towards the right . for reference ,",
    "the black dash - dot lines show where each rms value is equal to the eclipse depth .",
    "ideally markers will be on or near the solid black line , where accuracy equals precision .",
    "this happens for both models with very significant eclipses and small detector signals ( stars ) ; in these cases the model closer to the upper right corner is preferred ( here @xmath97-type ) .    towards",
    "the upper left the fitted eclipse depths are too conservative .",
    "the dotted cyan lines show where the accuracy is @xmath132 and @xmath133 larger than the precision ( e.g. green circle and green triangle ) .",
    "worse , in the other direction the fits are too confident , the dashed red lines showing where accuracy is @xmath132 and @xmath133 _ smaller _ than precision .",
    "the squares are near these lines , but similar to the left panel , accounting for time - correlated residuals ( i.e. inflating the uncertainties ) moves these markers close to the ideal ratio .",
    "these @xmath130 factors can only decrease the precision of the fits ; they can not affect the accuracy .",
    "relative to our original example ( the circles ) , increasing the eclipse significance ( squares and stars ) seems to help bliss more than the polynomial model .",
    "unexpectedly , @xmath97-type is preferred in three of these five cases ( diamonds , circles , and stars ) , and in four is actually the more precise model .",
    "this is unusual because bliss has been shown to perform better than a second - order polynomial on real _ spitzer _ data ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ) . luckily , bliss is more accurate and precise ( factors of @xmath135 and @xmath136 ) for an easy - to - see eclipse and detector signal ( light squares ) , even though @xmath134 is always lower for the polynomial model .",
    "here @xmath137 , which is about double the limit for reliable bliss maps we noted at the beginning of section [ sec : synthetic_fits ] .",
    "it is not too surprising then that @xmath130 factors help tune the precision of these fits .",
    "we show similar z - score , accuracy , and precision data as figure [ fig : zscores_accprec_sede ] for all of the remaining figures . in figure",
    "[ fig : zscores_accprec_nk ] we test how the fits change with the number of data or bliss knots , while keeping @xmath106 and @xmath107 .",
    "since changing the bliss mesh does not affect @xmath97-type , here the green triangle , circle , and star show how the polynomial fits can vary with a different sample of light curves .",
    "the z - scores for both models are acceptable in every case ( i.e. markers inside the dashed magenta ellipse ) and @xmath130 factors are not significant .",
    "we see no trends with either model when varying the amount of data : all these @xmath97-type fits are similar , and @xmath99-type improves in accuracy and precision whether @xmath35 goes up or down .",
    "most cases cluster around @xmath138 better accuracy than @xmath55 , except when using the smaller two bliss meshes ( blue triangle and circle ) .",
    "this means the @xmath99-type fit improves when we increase the number of knots ( blue circle to star ) .",
    "although we find that the polynomial model is both more precise and lies closer to the ideal line in every case , seeing bliss get better with a finer mesh bodes well for real - world fits .    ) or the total number of bliss knots ( @xmath67 ) .",
    "the circles are taken from figure [ fig : zscores_accprec_sede ] .",
    "note that since changing the bliss mesh does nothing to the polynomial model , here the green triangle , circle , and star show how the @xmath97-type fits can vary with different samples .",
    "there are no clear trends when changing the amount of data in the light curve . in most cases ,",
    "the polynomial model has better accuracy and precision , but those differences are much smaller when bliss uses more knots , ideally reversing for higher @xmath67 . ]",
    "next we test how having more red noise can affect the fits . in figure [ fig : zscores_accprec_noise ] we multiply an extra noise ( brownian ) into the light curve to mimic different kinds of time - correlated noise ( i.e. other than intra - pixel sensitivity variations ) . note again that @xmath97-type is always the more precise model here . when this extra noise has the same amplitude as the detector ( triangles ) , the z - scores for both models are as reasonable as in our main case ( circles ) .",
    "we find @xmath97- and @xmath99-type are closer in both accuracy and precision ; the polynomial model is nearer to the ideal ratio while bliss always has a lower @xmath134 . at @xmath4 the detector amplitude ( squares ) ,",
    "the brownian noise makes @xmath99-type overly - precise by a factor of @xmath139 and @xmath97-type by @xmath140 .",
    "both sets of z - scores are also unlikely and using @xmath130 factors does not help much  these change some z - scores yet leave each model s precision about the same .",
    "however , since bliss gets more precise relative to the polynomial model , this could mean real irac data have more red noise than our synthetic light curves .    the case with extra noise at @xmath141",
    "is curious ( stars ) .",
    "the z - scores for @xmath97- and @xmath99-type are clearly poor , and while these change a lot with @xmath130 factors included , neither model moves inside the 99% ellipse .",
    "both models are overly - precise at first , but after using the @xmath130 factors , @xmath99-type is now conservative and the @xmath97-type fit is _",
    "ideal_. this is a good lesson : the accuracy and precision of a model are separate ( rms ) scalars .",
    "z - scores are a discrepancy _ paired _ with a fit interval  those specific pairings matter .",
    "that means different sets of z - scores ( left panels ) can give the same accuracy and precision ( right panels ) .",
    "just because a model does well on average does not mean the individual fits are reliable , and vice versa .    .",
    "the z - scores for the cases with higher noise ( squares and stars ) are all suspect ( i.e. outside the ellipse on the left ) , even though in the highest case the @xmath97-type accuracy and precision are ideal with @xmath130 factors included .",
    "this means a model that fits eclipse depths well on average may still be unreliable .",
    "the polynomial model is more precise than bliss in every case , but the precision of the @xmath99-type fit gets close ( blue square on the right ) .",
    "bliss could be more precise on real data than polynomial models if these observations have more red noise than our synthetic light curves . ]",
    "we also test what happens to the fits when we modify the sensitivity variations on the part of the pixel under the centroids .",
    "first we make light curves with the centroids near the pixel s corner  where high - order terms in equation [ eq : sens_vars ] should dominate more ( appendix [ sec : d_sens_explain])and find that we get similar fits on the eclipse depth for @xmath97- and @xmath99-type .",
    "then in figure [ fig : zscores_accprec_map ] we compare two forms of the variations using two combinations of @xmath62 and @xmath66 .",
    "the circles and squares ( taken from figure [ fig : zscores_accprec_sede ] ) have light curves made with  @xmath97-like \" sensitivity maps , or the polynomial @xmath39 in equation [ eq : sens_vars ] .",
    "the stars and diamonds have  @xmath99-like \" maps instead , which are pixelated at the locations of the bliss knots and then smoothed in between .",
    "this means bliss should be _ the _ perfect model to use on light curves in the latter cases .",
    "when @xmath106 and @xmath107 , bliss goes up in accuracy and precision when switching to the @xmath99-like sensitivity maps .",
    "@xmath97-type also drops in accuracy and now both models give about the same ideal fit . when @xmath142 and @xmath143 , the polynomial model is less precise than with the @xmath97-like maps , but stranger is that _ bliss _ gets worse in both accuracy and precision . here @xmath97-type always has a lower @xmath134 and gives slightly more ideal fits than @xmath99-type .",
    "when we include @xmath130 factors for the cases shown by the diamonds , both models go from being reasonable to having very conservative precisions ( @xmath144 smaller than accuracies ) .",
    "the standard deviation of the z - scores also drops , though both @xmath97- and @xmath99-type stay within the 99% ellipse .",
    "this is different from what we see in figure [ fig : zscores_accprec_noise ] , where now the poor fits show up in the accuracy and precision , not the z - scores .",
    "therefore , both panels of figures [ fig : zscores_accprec_sede][fig : zscores_accprec_map ] are important to see how well a model fits a certain type of light curve . since we find that @xmath130 factors can penalize reasonable fits just as much as poor fits , using them to tune one s precision is not always wise .    -like",
    "( i.e. equation [ eq : sens_vars ] ) or @xmath99-like ( i.e. pixelated then smoothed ) sensitivity map to create a light curve .",
    "the circles and squares are taken from figure [ fig : zscores_accprec_sede ] .",
    "for the cases shown by the diamonds , accounting for time - correlated residuals changes the accuracy and precision from reasonable ( near the solid black line ) to very conservative ( cyan region)using these @xmath130 factors can be dicey .",
    "both methods give similar fits on the eclipse depth for light curves with @xmath99-like sensitivity maps , even though these maps should be ideal for using bliss . ]    to summarize figures [ fig : zscores_accprec_sede][fig : zscores_accprec_map ] , the eclipse significance and detector amplitude usually affect the accuracy and precision of a fitted eclipse depth . changing the amount of data by factors of 2 does not do much , but using more bliss knots improves the @xmath99-type fits noticeably .",
    "having extra red noise in the light curve tends to make both models overly - precise , but could be representative of real observations where bliss is more precise than polynomials .",
    "we find that bliss does fit data with very significant eclipses and large detector amplitudes better than the second - order polynomial .",
    "strangely though , @xmath99-type is no better than @xmath97-type at fitting light curves made from bliss - like sensitivity maps , and in nearly all cases the polynomial model is more precise than bliss .",
    "as for using @xmath130 factors to inflate uncertainties , we get mixed results : these can change overly - precise fits to reasonable ( squares in figure [ fig : zscores_accprec_sede ] ) , but can also make unreliable fits seem ideal ( stars in figure [ fig : zscores_accprec_noise ] ) and reliable fits far too conservative ( diamonds in figure [ fig : zscores_accprec_map ] ) .",
    "we have focused on bliss because it is easy to adapt the method to a full jump - type mcmc .",
    "many researchers use bliss to model intra - pixel sensitivity variations in irac data , but there are other non - parametric methods as well .",
    "the original approach is kernel regression ( kr ) , first used on the gj 436 system by @xcite . to measure the transit depth at a known point in a long time - series , the out - of - transit data ( i.e. a control )",
    "were used to model the detector once at the start of the analysis .",
    "this detector model was then used to correct the in - transit data .    since then",
    ", kr has been applied to phase observations , where the signal spans the entire observed baseline and there are no control data @xcite .",
    "researchers have therefore adopted an optimization strategy similar to bliss : at every mcmc step , the observed flux is divided by the current astrophysical model and kr is applied to the residuals .",
    "the kr implemented by @xcite and @xcite also includes the width of the point - spread function , but this does not change the similarity between kr and bliss .",
    "in fact , recent studies have used this width of the point - spread function in tandem with bliss @xcite .",
    "kr differs superficially from bliss because it has no obvious detector parameters , making it less clear how to adapt kr to full jump - type fits .",
    "nonetheless , one can estimate the effective number of parameters as suggested by footnote 2 of @xcite , typically of order @xmath145 .",
    "given the conceptual similarities between bliss and kr , it is likely that our results about the former apply to the latter .      from the sets of fitted eclipse depths in figures [ fig :",
    "zscores_accprec_sede][fig : zscores_accprec_map ] , it is surprising that a second - degree polynomial is as ( or more ) precise than bliss nearly all the time .",
    "that does not tend to happen with real _ spitzer _ data : in both @xcite and @xcite , the bliss models are more precise than any polynomials the authors test through order @xmath146 .",
    "in fact , the choice between the models seems so clear that many works in table [ tab : bliss_planets ] do not mention polynomials at all . to be fair",
    ", we find bliss to be more accurate and precise for light curves with very significant eclipses and large detector amplitudes ( squares in figure [ fig : zscores_accprec_sede ] ) , and often bliss fits err on the conservative side , which is good .",
    "but for most cases we test , one is better off modeling the sensitivity with a low - order polynomial ",
    "there are several thoughts about why this could be happening",
    ".    it would be great to fit real irac light curves that have @xmath5 data with all of our sensitivity models , but as mentioned in sections [ sec : map_compare][sec : synthetic_fits ] , this is not computationally feasible .",
    "instead we try to _ mimic _ these light curves and fits by using realistic parameters for @xmath53 and @xmath44 , scaling the bliss mesh with the number of data ( section [ sec : synthetic_fits ] ) , and running our mcmc chains until we get many independent samples .",
    "but maybe having more data and bliss knots simply is different , even though the bliss maps should be just as reliable either way .",
    "our bliss knots are usually spaced @xmath147 pixels apart in both @xmath148 and @xmath149in other studies that number can be an order of magnitude smaller ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "bliss might only be more precise than polynomial models when the knots sample smaller parts of the pixel ; we see evidence for that in figure [ fig : zscores_accprec_nk ] .",
    "also , when we set the amplitude of the detector signal in equation [ eq : d_signal ] , we do not choose _ when _ the sensitivity will rise and fall  that would mean explicitly choosing the centroids . instead , the pointing model @xcite and sensitivity map ( appendix [ sec : d_sens_explain ] ) that we use determine how the detector signal looks .",
    "there are two limiting cases when using the @xmath39 from equation [ eq : sens_vars ] : at one end , @xmath44 varies like a wave throughout the observation , meaning the sensitivity variations on that part of the pixel would look quadratic . at the other extreme",
    ", the detector signal is flat with a single large spike or dip at one moment , so that most of the data is not corrupted by the pixel s sensitivity . in either case",
    "our second - order polynomial model would give a good fit , but these limiting @xmath44 are not in most of our light curves .",
    "when @xmath39 is bliss - like ( section [ sec : more_synth_fits ] ) none of this _ should _ be an issue .",
    "one possibility comes straight from @xcite : the mcmc would not converge because the model for the exponential ramp had strong , non - linear correlations . to solve this ,",
    "the authors orthogonalized the ramp parameters , then transformed back to the first model after the mcmc to get the uncertainties .",
    "we have no ramping in our synthetic light curves , but similar correlations could happen in our model for @xmath53 .",
    "we see evidence of this when we try fitting a dc offset in equation [ eq : phase_func ] , which is why we fix the mean of the phase function to unity .",
    "there are a couple of problems with this idea , though .",
    "our mcmc chains have little trouble stabilizing , even if ` emcee ` takes a long time to get there .",
    "also , we fit the astrophysical signal identically for all three of our sensitivity models .",
    "even if our parameters are not ideal , each fit should be affected the same way by @xmath53 , meaning this is probably not why the polynomial models are more precise .    above all",
    "else , one might say we simply have not tested enough ( or the  right \" ) types of light curves .",
    "at worst this means we explored a part of parameter space that differs somehow from real observations .",
    "again , we have chosen a variety of cases based on real irac data , fit five examples of each case to have statistics , and even try cases _ tailored _ to bliss ( figure [ fig : zscores_accprec_map ] ) . indeed , bliss can be about as or more precise than a second - order polynomial : by using more knots , having a strong detector signal with low photon noise , having extra time - correlated noise in the light curve , or having a more pixelated sensitivity map .",
    "yet polynomials are routinely preferred and the bliss method is fundamentally the same each time  we find this odd .",
    "testing types of light curves that extend our cases would be a good way to see if the trends here continue in general .",
    "one might ask where section [ sec : synthetic_fits ] leaves us on dealing with detector signals in _ spitzer _ data .",
    "the pessimistic view is we should all switch to polynomial models and stay away from non - parametric methods , except those that properly marginalize over the detector behavior like ica @xcite or gaussian processes @xcite .",
    "after all , a polynomial model is almost always more precise than bliss at fitting our synthetic eclipses _ and _ is typically better when accuracy is included .",
    "an idea for real light curves , then , could be to use high - order polynomials for the sensitivity ( e.g. @xmath150 ) and just fit all the terms directly .",
    "the number of data is obviously more than we use , but the number of parameters would be similar to any of our ( jump-)bliss models  we find ` emcee ` can handle this many jump parameters",
    ".    there probably is logic in only using polynomials , but that simplifies things too much .",
    "our light curves , despite how we model them , are not _ spitzer _ light curves .",
    "when we try making them or the bliss mesh more realistic , the precision of bliss generally improves more than our polynomial model .",
    "sometimes the accuracy of bliss suffers in these fits , but if we could test the routine in even more realistic cases  especially with extra red noise in the light curve  we might find our fits agree well with previous works .",
    "that raises another thought : it could be that there are other sources of time - correlated noise in irac data , besides the pixel s sensitivity .",
    "for example , @xcite models hd 149026b data with eclipse and detector signals , as we do for our mock data , but also adds a time - dependent ramp model and a visit - dependence to the sensitivity . while we neglect those pieces , other sources of red noise can impact how one fits an eclipse depth ( figure [ fig : zscores_accprec_noise ] ) .",
    "the downside there is that when bliss gets about as precise as our polynomial model , neither approach has the accuracy or reliability to back it up . of course , that may not be a problem if a light curve has many red noise sources ; we only use one extra signal and scale it relative to the detector amplitude .",
    "those facts are bittersweet , but if nothing else we do have a case ( figure [ fig : zscores_accprec_sede ] ) that mirrors other papers based on bliss .",
    "_ there _ the accuracy and precision are in a near - ideal ratio , and we can not know the accuracy of real bliss fits anyway .",
    "part of the worry in using non - parametric models is that they will misfit uncertainties or bias a result ( figure [ fig : optmarg_posts ] ) .",
    "pleasantly , though , bliss does not have these issues systemically  if anything its intervals on the eclipse depth can be too conservative .",
    "a bigger issue is @xmath130 factors because while they are an expedient way to account for time - correlated residuals , they do not always work as intended , sometimes taking a reasonable estimate of the uncertainty and making it overly conservative .    actually , the important point in all of this is that , if a light curve has distinct astrophysical and detector signals , then one could probably use many methods to model that @xmath44 with reasonable success . for example , when we make the sensitivity map more bliss - like ( figure [ fig : zscores_accprec_map ] ) , @xmath44 looks nothing like @xmath53 and we get very similar fits with both models .",
    "that is in contrast to , say , a gradual rise and fall in detector sensitivity while observing a planet , which could easily be confused for phase variations .",
    "this idea even plays out in @xcite : there are multiple ways to model sensitivity variations that can all fit the same eclipse depth well .",
    "it turns out , then , that there is no elixir to deal with _",
    "sensitivity  and so bliss , simply put , can be a useful approach .",
    "we have performed mcmc fits on synthetic data to test how accurate and precise bliss mapping is for modeling intra - pixel sensitivity variations in _ spitzer _",
    "irac light curves .",
    "bliss is a non - parametric method , meaning it uses no jump parameters during the mcmc to model the detector signal .",
    "optimizing nuisance parameters , instead of marginalizing over them , can give both inaccurate and imprecise estimates for other parameters of interest .",
    "even in our toy example with simple posteriors , we find that fitted uncertainties can still be too small , by a factor of 2 . in bliss",
    "the sensitivity maps produced often look like the intrinsic sensitivity  to within the photon noise  and usually give excellent fits to the detector signal .",
    "however , when the photon noise is low , bliss maps can be unreliable , off from the real sensitivity by factors of 1.5 or more .",
    "furthermore , standard bliss ( @xmath99 ) is a viable shortcut to jump - bliss ( @xmath100 ) .",
    "both methods return similar estimates on the astrophysical model , and the knots in standard bliss behave like actual parameters .",
    "curiously , we find that our low - order polynomial model is almost always more precise than bliss at fitting eclipse depths , even when it should be worse by design .",
    "the notable exception is for low - noise eclipses with obvious detector signals .",
    "more importantly , we see evidence that bliss improves when using more knots , and the routine usually gives somewhat conservative fits at worst .",
    "in other words , bliss can be an acceptable way to model _ spitzer _ irac sensitivity .",
    "the authors thank kevin b. stevenson and ben farr ( both u. chicago ) for helpful comments that greatly improved the manuscript .",
    "jcs was funded as a graduate research trainee at mcgill university .",
    "to pick the @xmath42 in equation [ eq : sens_vars ] , we start by choosing how much all the terms added together can change the sensitivity , or @xmath151 .",
    "we divide this value by how many coefficients we have , @xmath152 , where we use @xmath153 because we set @xmath41",
    ". we can not give each polynomial term the same magnitude everywhere on the pixel , so we scale the terms to be the same at some reference distance , @xmath154 , from the pixel center .",
    "this gives us the equation : @xmath155 where @xmath156 is a limit for each coefficient . by doing this",
    ", the lower - order terms will dominate inside @xmath154 and vice versa , so the sensitivity tends to vary more near the pixel edges .",
    "note that the pixel centers have the highest sensitivities in the real irac detector ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ) , which is not always true in this model .",
    "we decide to set @xmath157 and @xmath158 , but other choices work , too .",
    "we next randomly pick each @xmath159 $ ] , then _",
    "rescale _ all these coefficients to get a chosen amplitude for the detector signal , @xmath46 , no matter what centroids we have . for each new sensitivity map ,",
    "we draw and rescale the @xmath42 again .      to choose the parameters for equations [ eq : phase_func ] and [ eq : a_signal ] , we start with the eclipse and work backwards .",
    "we fix @xmath52 hrs and @xmath58 hr , and because we randomly choose @xmath160 $ ] hrs , there is always some baseline before and after the eclipse .",
    "then we pick a value of @xmath66we set @xmath55 first ( to @xmath161 ) if we are fitting the light curve with mcmc and @xmath46 first if making a bliss map ( section [ sec : map_compare ] ) . in the second case ,",
    "the eclipse depth is about @xmath162@xmath163 .",
    "then we look at the phase model .",
    "we randomly pick @xmath164 $ ] hrs , which gives us part of a phase curve , and @xmath165 $ ] , which makes sure the peak of the phase curve happens during the observation",
    ". the bottom of the eclipse should be lower in flux than the phase curve _",
    "could _ be , so we calculate the maximum half - amplitude , @xmath166 , the phase curve could have given the other parameters .",
    "then we randomly choose @xmath167 $ ] , where the lower limit on @xmath49 could be different and is just by choice .",
    "lastly , we pick the amount of photon noise , @xmath20 , depending on how significant we want the eclipse to be ( equation [ eq : signif_ecl ] ) .",
    "our choices give us light curves that mimic real data ; other choices could work as well ."
  ],
  "abstract_text": [
    "<S> much of transiting exoplanet science relies on high - precision photometry . </S>",
    "<S> the current generation of instruments exhibit sensitivity variations greater than the astrophysical signals . for the infrared array camera ( irac ) on the spitzer space telescope , a popular way to handle this is bilinearly - interpolated subpixel sensitivity mapping ( bliss ) . at each step in a markov chain monte carlo ( mcmc ) </S>",
    "<S> , bliss divides the observed flux by the current time - dependent astrophysical model to obtain residuals , which are attributed to the detector sensitivity variations . </S>",
    "<S> bliss then averages the residuals at many spots ( knots ) on the pixel , and interpolates to estimate the position - dependent sensitivity . </S>",
    "<S> we use examples of posterior probability functions to show that this scheme can misfit or bias astrophysical parameters , and a toy model to show that underestimated uncertainties may even happen in very simple cases . </S>",
    "<S> bliss maps of detector sensitivity can also be unreliable if the noise in the data is low . </S>",
    "<S> the problem with testing these methods on real _ spitzer _ data is we would like to know the astrophysical and detector models a priori , so that we can test the accuracy and precision of the fits . </S>",
    "<S> we therefore construct a model of _ spitzer _ light curves with @xmath0 data . </S>",
    "<S> we compare standard bliss to a variant in which the knot values are full - fledged parameters in the mcmc , and to a standard polynomial model . </S>",
    "<S> both types of bliss fit the eclipse depth similarly , and the standard bliss knots vary about as much as the fitted knots , meaning the standard knots behave like real parameters </S>",
    "<S> . the polynomial model is almost always more precise , and usually more accurate , than bliss  except </S>",
    "<S> when the detector signal is strong and the noise in the light curve is low . </S>",
    "<S> the fits we get with bliss also tend to be somewhat conservative at worst . when applied to real _ spitzer _ data , however , bliss yields better fits and more precise astrophysical parameters than polynomial models . </S>",
    "<S> this suggests that bliss may need to use more knots or that real data have different noise properties than our mock light curves . </S>",
    "<S> when we increase the number of bliss knots , add brownian noise to the photometry , or make the sensitivity variations more pixelated , then bliss fits the eclipse depth about as accurately and precisely as  but not more than  the polynomial model . in these and other cases , the detector and astrophysical signals are generally distinct , </S>",
    "<S> implying there can be many ways to model sensitivity variations well . </S>",
    "<S> thus , we deem that bliss could be an acceptable shortcut when used on _ spitzer _ irac eclipse photometry .    _ </S>",
    "<S> keywords : _ eclipses  instrumentation : detectors  methods : data analysis  methods : statistical </S>"
  ]
}