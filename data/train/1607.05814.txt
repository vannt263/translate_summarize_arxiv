{
  "article_text": [
    "in this appendix , we present the calculations to derive eq .",
    "( [ main_eq ] ) . to simplify the discussion ,",
    "we have labeled different modes involved in the calculations in  fig .",
    "[ fig : geneva ] .",
    "suppose that the input state in mode @xmath58 is a coherent state @xmath59 with creation operator @xmath25 .",
    "also , suppose that the input signal in mode @xmath60 is the vacuum state @xmath61 .",
    "then , the output signal in modes @xmath62 and @xmath63 , after the action of the 50:50 beamsplitter ( bs ) , is given by @xmath64 , where @xmath65 and @xmath66 denote the corresponding creation operators for modes @xmath62 and @xmath63 .",
    "next , we consider the phase modulator ( pm ) and the half - wave plate ( hwp ) that act on modes @xmath62 and @xmath63 . the former performs the unitary transformation @xmath67 , where @xmath68 is the creation operator at the output port of the pm .",
    "the hwp applies the unitary transformation @xmath69 and @xmath70 , where @xmath71 and @xmath72 denote the creation operators at the output port of the hwp .",
    "this means , in particular , that the quantum state in modes @xmath73 and @xmath74 has the form @xmath75 with the creation operators @xmath68 and @xmath76 given by @xmath77 and @xmath78 , respectively .",
    "then , after applying the 50:50 bs on modes @xmath73 and @xmath74 , we have that the output state in modes @xmath79 and @xmath80 can be expressed as @xmath81\\bigg\\}\\ket{0}. \\nonumber \\\\\\end{aligned}\\ ] ] finally , if we apply the polarising beamsplitters ( pbs ) ( which we assume reflect horizontally polarised light and let vertically polarised light pass ) on modes @xmath79 and @xmath80 , we find that the state @xmath82 at the input ports of bob s detectors @xmath29 , with @xmath0 , is a tensor product of coherent states given by eq .",
    "( [ main_eq ] ) .    , @xmath60 , @xmath62 , @xmath63 , @xmath73 , @xmath74 , @xmath79 , and @xmath80 correspond to those considered in the calculations of appendix  [ calc_main_eq ] ; the receiver scheme is otherwise identical to fig .",
    "[ mdiqkd_vs_ddiqkd](b )  @xcite . ]",
    "one main assumption of ddiqkd is that bob s linear optics network [ _ i.e. , _  the grey area within bob s receiver in  fig .  [ mdiqkd_vs_ddiqkd](b ) ] is fully characterised and trusted .",
    "note , however , that this does not mean that its devices need to be perfect , as this would be impossible to achieve in practice . in this appendix",
    "we show that eve could also exploit various typical imperfections of bob s linear optics to avoid double clicks when performing the blinding attack described in the main text .     as a function of @xmath32 , when @xmath83 .",
    "( a )  ideal scenario with a perfect pm that has @xmath84 . ( b )",
    "example of a practical case where @xmath85 @xcite .",
    "the normalised energy is defined as the energy divided by the energy of a coherent state with mean photon number @xmath20 .",
    "see text for further details . ]    in particular , we will analyse two possible eavesdropping strategies in this context . in the first one , eve uses the fact that bob s pm @xmath33 is usually not perfect .",
    "more precisely , we study the situation where bob s pm actually applies a phase @xmath86 , where @xmath87 and the parameter @xmath88 characterises the imperfection . in this scenario ,",
    "eve can select her phase @xmath89 , where @xmath90 and @xmath91 is a deviation term that eve can select to control the detectors . according to eq .",
    "( [ main_eq ] ) , the energy at the input ports of bob s detectors @xmath40 , @xmath41 , @xmath92 and @xmath93 is proportional to , respectively , @xmath94 $ ] , @xmath95 $ ] , @xmath96 $ ] , and @xmath97 $ ] . for simplicity ,",
    "below we focus on the case @xmath83 .",
    "the other cases can be analysed similarly .",
    "we consider first the ideal scenario where @xmath84 .",
    "the resulting normalised energies are illustrated in  fig .",
    "[ fig : source](a ) as a function of @xmath32 .",
    "that is , as already seen in the main text , when eve s basis matches that of bob , then two detectors receive maximum energy and , therefore , both click . if bob and eve use different bases then the total energy is equally distributed to all the four detectors and , given that @xmath43 is chosen carefully , none of them click .",
    "suppose now the practical scenario where bob s state preparation is imperfect and @xmath88 is equal to say , for instance , @xmath98 ( or 5 , which is a typical accuracy in practical systems  @xcite ) .",
    "in this situation , the energy distributions shift with respect to each other as highlighted in  fig .  [",
    "fig : source](b ) .",
    "if @xmath99 and eve selects say @xmath100 ( @xmath101 ) then the energy at the input ports of detectors @xmath40 and @xmath93 is , respectively , @xmath102 and @xmath103 ( @xmath104 and @xmath105 ) .",
    "similarly , if @xmath106 the energy at the detectors @xmath41 and @xmath92 is , respectively , @xmath104 and @xmath105 ( @xmath105 and @xmath104 ) .",
    "that is , if eve chooses carefully a suitable value of @xmath107 and @xmath20 such that @xmath108 and @xmath109 , she can guarantee that only one detector clicks each given time , and no double - click is produced .",
    "finally , in the second eavesdropping strategy that we analyse we consider the situation where @xmath84 , but eve exploits the fact that bob s bses are not perfect to avoid double - clicks .",
    "although a 50:50 bs designed to operate at a certain wavelength ( say , for example , at @xmath110  nm ) can achieve nearly perfect splitting ratio at that wavelength , its splitting ratio can vary significantly at a different wavelength . for instance , a custom - made beamsplitter sample studied in ref .",
    "@xcite exhibited an extreme behaviour with splitting ratio of 98.6:1.4 ( 0.3:99.7 ) at @xmath111  nm ( @xmath112  nm ) . while commercial beamsplitter models may exhibit less variation , eve in general can to some extent control the splitting ratio by simply changing the wavelength of the signals  @xcite , and this could be used to avoid double - clicks .",
    "in particular , suppose that eve s signals are in a wavelength such that the splitting ratio of bob s first ( second ) bs is @xmath113 ( @xmath114 ) .",
    "in addition , suppose that the creation operator of eve s coherent states @xmath24 is now given by @xmath115 , where the parameter @xmath116 is chosen by eve . in this scenario , it can be shown that the state at the input ports of bob s detectors @xmath29 is a coherent state of the form @xmath117 where @xmath118 , and @xmath119 .",
    "note that when @xmath120 we obtain eq .",
    "( [ main_eq ] ) .",
    "this means that , in principle , eve might select the parameter @xmath116 and the wavelength of her signals such that the resulting splitting ratios @xmath121 and @xmath122 make the input energies at bob s detectors asymmetric . in so doing , and following a similar argumentation to the one introduced in the previous eavesdropping strategy",
    ", eve can guarantee that when she and bob choose the same basis , only one detector clicks .",
    "this situation is illustrated in  fig .",
    "[ fig : int_mismatch_phpi_2 ] for a particular example where @xmath123 , @xmath124 , @xmath125 , and @xmath126 . in this scenario",
    ", we find that the maximum normalised energy at the input ports of bob s detectors @xmath40 and @xmath93 when eve selects @xmath127 is , respectively , @xmath128 and @xmath129 . similarly , when she chooses @xmath130 the maximum normalised energy at the detectors @xmath92 and @xmath41 is , respectively , @xmath131 and @xmath132 .",
    "therefore , eve can choose the energy of her signals such that only the detector @xmath40 ( @xmath92 ) clicks when @xmath127 ( @xmath130 ) .",
    "that is , by changing the values of the parameters @xmath121 , @xmath122 , and @xmath116 , eve can guarantee that only one detector clicks each given time .",
    "42ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]",
    " + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty link:\\doibase 10.1038/nphoton.2014.149 [ * * ,   ( ) ] link:\\doibase 10.1080/09500340108240904 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.74.022313 [ * * ,   ( ) ] ,   @noop * * ,   ( ) link:\\doibase 10.1364/oe.15.009388 [ * * , ( ) ] link:\\doibase    10.1038/nphoton.2010.214",
    "[ * * ,   ( ) ] link:\\doibase 10.1088/1367 - 2630/12/11/113026 [ * * ,   ( ) ] link:\\doibase    10.1038/ncomms1348 [ * * ,   ( ) ] link:\\doibase    10.1088/1367 - 2630/13/7/073024 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.87.062313 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.91.032326 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.91.062301 [ * * ,   ( ) ] in  link:\\doibase 10.1109/sfcs.1998.743501 [ _ _ ]  ( ,  )  pp .",
    "link:\\doibase    10.1103/physrevlett.98.230501 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.113.140501 [ * * ,   ( ) ] in  link:\\doibase 10.1145/2591796.2591843 [ _ _ ] ( ,  , )  pp .",
    "link:\\doibase    10.1103/physrevlett.108.130503 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevlett.111.130501 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.88.052303 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevlett.111.130502 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.112.190503 [ * * ,   ( ) ] link:\\doibase    10.1038/nphoton.2016.50 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevx.6.011024 [ * * ,   ( ) ] @noop link:\\doibase    10.1038/ncomms4732 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.92.022337 [ * * ,   ( ) ] link:\\doibase    10.1063/1.4903350 [ * * ,   ( ) ] @noop   link:\\doibase 10.1103/physreva.92.012319 [ * * , ( ) ] link:\\doibase 10.1103/physreva.67.040301 [ * * , ( ) ] link:\\doibase    10.1103/physreva.89.022307 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.91.020303 [ * * , ( ) ] link:\\doibase 10.1103/physrevlett.91.057901 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevlett.94.230504 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.94.230503 [ * * ,   ( ) ] in  @noop _ _  ( ,  ,  )  pp .   link:\\doibase 10.1103/physreva.54.2651 [ * * ,   ( ) ]",
    "link:\\doibase 10.1103/physrevlett.92.217903 [ * * , ( ) ] @noop   @noop link:\\doibase    10.1103/physreva.92.032305 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.84.062308 [ * * ,   ( ) ]"
  ],
  "abstract_text": [
    "<S> detector - device - independent quantum key distribution ( ddiqkd ) held the promise of being robust to detector side - channels , a major security loophole in qkd implementations . </S>",
    "<S> in contrast to what has been claimed , however , we demonstrate that the security of ddiqkd is not based on post - selected entanglement , and we introduce various eavesdropping strategies that show that ddiqkd is in fact insecure against detector side - channel attacks as well as against other attacks that exploit device s imperfections of the receiver . </S>",
    "<S> our attacks are valid even when the qkd apparatuses are built by the legitimate users of the system themselves , and thus free of malicious modifications , which is a key assumption in ddiqkd .    _ </S>",
    "<S> introduction._quantum key distribution ( qkd ) , a technique to distribute a secret random bit string between two separated parties ( alice and bob ) , needs to close the gap between theory and practice  @xcite . in theory </S>",
    "<S> , qkd provides information - theoretic security . in practice , however , it does not because qkd implementation devices do not typically conform to the theoretical models considered in the security proofs . as a result , any unaccounted device imperfection might constitute a side - channel which could be used by an eavesdropper ( eve ) to learn the secret key without being detected  @xcite .    to bridge this gap , </S>",
    "<S> various approaches have been proposed recently  @xcite , with measurement - device - independent qkd ( mdiqkd )  @xcite probably being the most promising one in terms of feasibility and performance . </S>",
    "<S> its security is based on post - selected entanglement , and it can remove all detector side - channels from qkd implementations , which is arguably their major security loophole  @xcite . also , its practicality has been already confirmed both in laboratories and via field trials  @xcite . </S>",
    "<S> a drawback of mdiqkd is , however , that it requires high - visibility two - photon interference between independent sources , which makes its implementation more demanding than that of conventional qkd schemes . </S>",
    "<S> in addition , current finite - key security bounds against general attacks  @xcite require larger post - processing data block sizes than those of standard qkd .    to overcome these limitations , </S>",
    "<S> a novel approach , so - called detector - device - independent qkd ( ddiqkd ) , has been introduced recently  @xcite . </S>",
    "<S> it avoids the problem of interfering photons from independent light sources by using the concept of a single - photon bell state measurement ( bsm )  @xcite . as a result </S>",
    "<S> , its finite - key security bounds and classical post - processing data block sizes are expected to be similar to those of prepare - and - measure qkd schemes  @xcite . despite this </S>",
    "<S> presumed promising performance , however , the robustness of ddiqkd against detector side - channel attacks has not been rigorously proven yet , and only partial security proofs have been introduced  @xcite .    here </S>",
    "<S> , we show that , in contrast to what has been claimed  @xcite , the security of ddiqkd _ can not _ </S>",
    "<S> rely on the same principles as mdiqkd ( _ i.e. , _  </S>",
    "<S> post - selected entanglement ) . </S>",
    "<S> more importantly , we demonstrate that ddiqkd is in fact vulnerable to detector side - channel attacks and to other attacks that exploit imperfections of the receiver s devices . these attacks are valid even when alice s and bob s state preparation processes are fully characterised and trusted , an essential assumption in ddiqkd . </S>",
    "<S> moreover , they do not require that eve substitutes bob s detectors with a measurement apparatus prepared by herself to leak key information to the channel  @xcite . </S>",
    "<S> that is , our attacks apply as well to the scenario where alice and bob build the qkd devices themselves .    </S>",
    "<S> _ mdiqkd & ddiqkd._let us start by reviewing the basic principles behind mdiqkd and ddiqkd . to simplify the discussion </S>",
    "<S> , we shall assume that alice and bob have at their disposal perfect single - photon sources . </S>",
    "<S> note , however , that both schemes can operate as well , for instance , with phase - randomised weak coherent pulses in combination with decoy states  @xcite .    </S>",
    "<S> , with @xmath0 , charles single - photon detectors . </S>",
    "<S> ( b )  ddiqkd  @xcite . </S>",
    "<S> hwp , half - wave plate ; and pm , phase modulator . </S>",
    "<S> one single click in the detector d@xmath1 , d@xmath2 , d@xmath3 , or d@xmath4 corresponds to a projection into the bell state @xmath5 , @xmath6 , @xmath7 , or @xmath8 respectively ( see main text for further details ) . in both schemes , </S>",
    "<S> the grey areas denote devices that need to be characterised and trusted . also , alice s and bob s laboratories need to be protected from any information leakage to the outside . ]    </S>",
    "<S> an example of a possible implementation of mdiqkd is illustrated in fig .  </S>",
    "<S> [ mdiqkd_vs_ddiqkd](a )  @xcite . </S>",
    "<S> both alice and bob generate bb84 states  @xcite and send them to an untrusted relay charles . if charles is honest , he performs a two - photon bsm that projects the incoming signals into a bell state . in any case , charles has to declare which of his measurements are successful together with the bell states obtained . </S>",
    "<S> alice and bob then extract a secret key from those successful events where they used the same basis . </S>",
    "<S> importantly , if charles is honest , his bsm measurement post - selects entanglement between alice and bob , and , therefore , he is not able to learn any information about their bit values . to test whether or not charles is honest , alice and bob can simply compare a randomly chosen subset of their data to see if it satisfies the expected correlations associated to the bell states announced . </S>",
    "<S> that is , mdiqkd can be seen as a time - reversed einstein - podolsky - rosen qkd protocol  @xcite . </S>",
    "<S> therefore , its security can be proven without any assumption on the behaviour of charles measurement unit .    </S>",
    "<S> ddiqkd  @xcite aims to follow the same spirit of mdiqkd . </S>",
    "<S> the key idea is to replace the two - photon bsm with a two - qubit single - photon bsm  @xcite . </S>",
    "<S> this requires that alice and bob use two different degrees of freedom of the single - photons to encode their bit information . in so doing </S>",
    "<S> , one avoids the need for interfering photons from independent light sources . </S>",
    "<S> an example of a possible implementation is illustrated in  fig .  </S>",
    "<S> [ mdiqkd_vs_ddiqkd](b )  @xcite ( see also  @xcite for similar proposals ) . here </S>",
    "<S> , alice sends bob bb84 polarisation states : @xmath9 , where @xmath10 ( @xmath11 ) denotes the fock state of a single - photon prepared in horizontal ( vertical ) polarisation , and the phase @xmath12 . </S>",
    "<S> bob then encodes his bit information by using the spatial degree of freedom of the incoming photons . </S>",
    "<S> this is done with a 50:50 beamsplitter ( bs ) together with a phase modulator ( pm ) that applies a random phase @xmath13 to each input signal . </S>",
    "<S> finally , bob performs a bsm that projects each input photon into a bell state : @xmath14 and @xmath15 , where @xmath16 ( @xmath17 ) represents the state of a photon that goes through the upper ( lower ) arm of the interferometer ( see  fig .  </S>",
    "<S> [ mdiqkd_vs_ddiqkd](b ) ) . </S>",
    "<S> a photon detection event ( `` click '' ) in only one detector @xmath18 corresponds to a projection on a particular bell state .    </S>",
    "<S> both mdiqkd and ddiqkd require that alice s and bob s state preparation processes are characterised and trusted . </S>",
    "<S> this is indicated by the grey areas shown in fig .  </S>",
    "<S> [ mdiqkd_vs_ddiqkd ] . in ddiqkd </S>",
    "<S> , the elements inside bob s grey area can be regarded as his trusted transmitter ( when compared to mdiqkd ) . among the trusted components there are elements which belong to the bsm , but , importantly , the detectors @xmath18 do not need to be trusted .    </S>",
    "<S> _ the security of ddiqkd is not based on post - selected entanglement._at a first sight , it seems that the security of ddiqkd follows directly from that of mdiqkd , given , of course , that the assumptions on alice s and bob s state preparation processes are fulfilled  @xcite . </S>",
    "<S> that is , it relies on the fact that the bsm post - selects entanglement between alice and bob . </S>",
    "<S> a first indication that confronts this idea was given recently in  @xcite . </S>",
    "<S> there , it was shown that , in contrast to mdiqkd , ddiqkd is actually insecure if eve is able to replace bob s detectors with a measurement apparatus that leaks information to the channel  @xcite . </S>",
    "<S> although this result is important from a conceptual point of view , it violates one of the security assumptions of ddiqkd : bob s detectors have to be built by a trusted party ( but do not need to be characterised ) to avoid that they intentionally leak key information to the outside  @xcite . </S>",
    "<S> below we show that even in this scenario , the security of ddiqkd can not be based on post - selected entanglement alone , unlike mdiqkd .    for this , we will consider a slightly simplified version of the ddiqkd scheme illustrated in  fig .  </S>",
    "<S> [ mdiqkd_vs_ddiqkd](b ) . </S>",
    "<S> in particular , we will assume that bob s receiver has only one active detector , say for instance the detector @xmath19 , while the other detectors are disabled . </S>",
    "<S> that is , now bob s bsm projects the incoming photons only into the bell state @xmath5 . </S>",
    "<S> if the security of ddiqkd is based on post - selected entanglement , this modification should not affect its security ( only its secret key rate is reduced by a factor of four ) , as a projection into a single bell state should be sufficient to guarantee security  @xcite . </S>",
    "<S> next we show that a blinding attack  @xcite renders ddiqkd insecure in this situation .    in particular </S>",
    "<S> , suppose that eve shines bright light onto bob s detector @xmath19 to make it enter linear - mode operation  @xcite . in this mode </S>",
    "<S> the detector is no longer sensitive to single - photon pulses , but it can only detect strong light . in order to simplify the discussion , we shall assume that @xmath19 always produces a click ( no click ) outcome when the mean photon number @xmath20 of the incoming pulses satisfies @xmath21 ( @xmath22 ) for a certain threshold value @xmath23 . </S>",
    "<S> once @xmath19 is blinded , eve performs an intercept - resend attack on every signal sent by alice . </S>",
    "<S> that is , she measures alice s signals in one of the two bb84 bases ( which eve selects at random for each pulse ) , and she prepares a new signal , depending on the result obtained , that is sent to bob . </S>",
    "<S> intercept - resend attacks correspond to entanglement - breaking channels and , therefore , they can not lead to a secure key  @xcite . </S>",
    "<S> suppose , for instance , that the signals that eve sends to bob are coherent states of the form @xmath24 with creation operator @xmath25 . here , @xmath26 </S>",
    "<S> ( @xmath27 ) denotes the creation operator for horizontally ( vertically ) polarised photons , and the phase @xmath28 depends on eve s measurement result . </S>",
    "<S> more precisely , for each measured signal , eve sends bob a coherent state prepared in the bb84 polarisation state identified by her measurement . </S>",
    "<S> then , it can be shown that the state at the input ports of bob s detectors @xmath29 is a coherent state of the form ( see appendix  [ calc_main_eq ] for details ) @xmath30    0.5    .@xmath31 [ cols=\"^,^,^,^,^\",options=\"header \" , ]     this situation is illustrated in table  [ tbl : main ] , where we show the mean photon number of the incoming light to bob s detectors for all combinations of @xmath32 and @xmath33 . </S>",
    "<S> most importantly , from this table we can see that if @xmath19 is the only active detector and eve selects @xmath20 such that @xmath34 , then bob can only obtain a click when he uses the same measurement basis as eve ( _ i.e. , _  when @xmath35 or @xmath36 ) . </S>",
    "<S> that is , this attack does not introduce any error . </S>",
    "<S> moreover , we have that bob and eve select the same basis with at least @xmath37 probability . </S>",
    "<S> this means that the ddiqkd scheme illustrated in  fig .  </S>",
    "<S> [ mdiqkd_vs_ddiqkd](b ) ( with only one active detector ) is actually insecure against the detector blinding attack for a total system loss beyond only @xmath38  db , just like standard qkd schemes . </S>",
    "<S> this confirms that the security of ddiqkd can not be based on post - selected entanglement . </S>",
    "<S> the same conclusion applies as well to the ddiqkd schemes introduced in refs .  </S>",
    "<S> @xcite ,  @xcite , and  @xcite .    _ insecurity of ddiqkd against detector side - channel attacks._if bob uses four active detectors , the detector blinding attack has one main drawback : it produces double - clicks  @xcite . from table  [ tbl : main ] </S>",
    "<S> one can already see that whenever bob uses the same measurement basis as eve there is always two detectors that click . </S>",
    "<S> for instance , when @xmath39 the detectors @xmath40 and @xmath41 always click , and similar for the other cases . </S>",
    "<S> this means that alice and bob could , in principle , try to monitor double - clicks to detect the presence of eve . </S>",
    "<S> so , the question is whether or not four active detectors can make ddiqkd secure again . as we show below , the answer is `` no '' . </S>",
    "<S> for this , we introduce two possible eavesdropping strategies that exploit practical imperfections of bob s detectors to avoid double - clicks . </S>",
    "<S> see also appendix  [ sca_linearopticsnetwork ] for two alternative attacks that achieve the same goal by exploiting other imperfections of bob s linear optics network .    </S>",
    "<S> the first eavesdropping strategy uses the fact that single - photon detectors respond differently to the same blinding power @xmath42 . </S>",
    "<S> this has been recently analysed in ref .  </S>",
    "<S> @xcite . there </S>",
    "<S> , the authors compare the response of two single - photon detectors in a commercial qkd system clavis2  @xcite to varying blinding power . </S>",
    "<S> they first illuminate the detectors with continuous - wave bright light of power @xmath42 to force them enter linear - mode operation . </S>",
    "<S> then they record the maximum and minimum value of the trigger pulse energy @xmath43 for which the click probabilities are @xmath44 and @xmath45 respectively . </S>",
    "<S> the results are shown in  fig .  </S>",
    "<S> [ blinding](a )  @xcite . for a particular blinding power @xmath42 , </S>",
    "<S> each point in the solid ( dashed ) curves shown in the figure represents the maximum ( minimum ) value of trigger pulse energy @xmath43 for which the detection efficiency @xmath46 is @xmath44 @xmath47 . </S>",
    "<S> the blue and green colours identify the two detectors . </S>",
    "<S> next , we show how this effect could be used to avoid double - clicks .     for two different single - photon detectors @xmath40 and @xmath41 . here , for a particular blinding power @xmath42 , each point in the solid ( dashed ) curves represents the maximum ( minimum ) value of trigger pulse energy @xmath43 for which the detection efficiency @xmath46 is @xmath44 @xmath47 . </S>",
    "<S> the experimental data has been reprinted from ref .  </S>",
    "<S> @xcite . </S>",
    "<S> ( b )  measured detection efficiency mismatch in the time domain between two blinded single - photon detectors at @xmath48 , @xmath49 , and @xmath50 wide trigger pulse ( see main text for further details ) . ]    for this , we return to the blinding attack described above against the ddiqkd implementation illustrated in fig .  </S>",
    "<S> [ mdiqkd_vs_ddiqkd](b ) . for simplicity , </S>",
    "<S> let us consider again the case where @xmath39 . in particular , </S>",
    "<S> suppose for instance that eve wants to force a click only on detector say @xmath40 , and no click on detector @xmath41 . </S>",
    "<S> then , in order to achieve this goal , she can simply choose a combination of @xmath42 and @xmath43 such that the detector @xmath40 ( @xmath41 ) has a non - zero ( zero ) click probability . </S>",
    "<S> if the behaviour of the detector @xmath40 ( @xmath41 ) corresponds to the green ( blue ) curves shown in  fig .  </S>",
    "<S> [ blinding](a ) , then the values @xmath51  mw and @xmath52  pj constitute an example that satisfies this criterion . </S>",
    "<S> similarly , if @xmath53  mw and @xmath54  pj , then eve could make the detector @xmath41 ( @xmath40 ) to have a non - zero ( zero ) click probability . </S>",
    "<S> importantly , note that when bob s basis matches that of eve , only two out of the four detectors @xmath18 might produce a click ( see table  [ tbl : main ] ) . </S>",
    "<S> hence , in these instances eve only needs to avoid double - clicks between two detectors in order to remain undetected . </S>",
    "<S> a similar argument can be applied as well to any other value of @xmath33 and @xmath32 .    </S>",
    "<S> this attack demonstrates that if bob s detectors are uncharacterised , as assumed in ddiqkd , this type of schemes are indeed insecure against detector side - channel attacks . </S>",
    "<S> that is , eve could learn the whole secret key without producing any error nor a double - click .    </S>",
    "<S> a second eavesdropping strategy that also allows eve to avoid double - clicks is based on a time - shift attack  @xcite that exploits the detection efficiency mismatch between bob s detectors . in this type of attack , </S>",
    "<S> eve shifts the arrival time of each signal that she sends to bob such that only one detector can produce a click each given time . here , we have confirmed experimentally that this type of attack is also possible with blinded detectors . for this , we blinded two single - photon detectors from the commercial qkd system clavis2  @xcite and we measured their detection efficiency mismatch . </S>",
    "<S> the experimental results are shown in  fig .  </S>",
    "<S> [ blinding](b ) . </S>",
    "<S> we find , for instance , that whenever bob receives a trigger pulse at the time instance @xmath55 ( @xmath56 ) , only the detector @xmath40 ( @xmath41 ) can produce a click because this instance is outside of the response region of the detector @xmath41 ( @xmath40 ) . </S>",
    "<S> that is , by combining the time - shift attack with the blinding attack introduced in the previous section , eve could again break the security of ddiqkd without introducing errors nor double - clicks .    _ </S>",
    "<S> conclusion._we have analysed the security of detector - device - independent qkd ( ddiqkd ) , a novel scheme that promised to be robust against detector side - channel attacks . </S>",
    "<S> we have shown that its security is not based on post - selected entanglement , as originally claimed . </S>",
    "<S> most importantly , we have presented various eavesdropping attacks that demonstrate that ddiqkd is actually vulnerable to detector side - channel attacks as well as to other side - channel attacks that exploit imperfections of bob s receiver . </S>",
    "<S> these attacks are valid even when alice s and bob s state preparation processes are fully characterised and trusted , and bob s detectors are built by a trusted party and can not be replaced with a measurement device manufactured by eve .    _ </S>",
    "<S> acknowledgments._this work was supported by industry canada , cfi , nserc ( programs discovery , pdf , cryptoworks21 ) , ontario mri , us office of naval research , national natural science foundation of china ( grant no .  </S>",
    "<S> 11304391 ) , spain mineco , feder ( grant no .  tec2014 - 54898-r ) , and galician regional government ( programs em2014/033 , atlanttic ) . </S>",
    "<S> the authors thank i d  quantique for cooperation , technical assistance , and providing the qkd hardware . </S>"
  ]
}