{
  "article_text": [
    "in a recent series of three articles,@xcite the use of bipolar counter - propagating wave methods ( cpwms)@xcite for exact numerical solution of the time - independent  equation was explored .",
    "the basic underlying idea is to decompose the stationary wavefunction , @xmath1 , into a sum of two counter - propagating wave components , i.e. = + .",
    "[ psitot ] if done appropriately , such a decomposition can lead to very important ramifications for quantum trajectory methods ( qtms)@xcite  i.e .",
    ", trajectory - based numerical techniques for performing exact quantum dynamics calculations , based on bohmian mechanics@xcite  due to nonlinearity of the bohmian equations of motion . in particular , the earlier series of articles has culminated in a set of trajectory - based time - dependent methods for computing stationary scattering quantities ( the theoretical underpinning of all chemical reactions ) in one degree of freedom ( dof ) .",
    "these methods were found to be numerically stable and efficient for model systems within a certain regime of system parameters and accuracy typical of molecular applications.@xcite however , more recent investigations have uncovered certain limitations that arise in more extreme cases .",
    "this has motivated the goal of the present paper , to perform a much more detailed numerical analysis of the methods , and to develop a single stable , robust , and efficient `` black - box '' algorithm that can be applied to virtually any 1 dof system with a minimum of user intervention .    in recent years",
    ", qtm s have arisen as a very promising tool for performing accurate quantum dynamics calculations for many - dof systems , using trajectory ensembles in a manner similar to classical simulations.@xcite in the conventional unipolar formulation of bohmian mechanics,@xcite the madelung - bohm amplitude - phase decomposition of the 1 dof @xmath1 , i.e. ( x , t ) = r(x , t ) e^i s(x , t ) / , [ ansatz ] is used to generate the ( presumably classical - like ) quantum field functions , @xmath3 and @xmath4 . for slowly - varying potentials ,",
    "the classical field functions are also slowly - varying , except in the vicinity of caustics .",
    "the corresponding quantum field functions of behave similarly when there is no interference .",
    "however , interference introduces non - classical - like oscillations in the quantum field functions , which in turn lead to numerical difficulties for qtm calculations  collectively referred to as `` the node problem''@xcite ( even though true nodes _ per se _ need not be present ) . as interference is formally unavoidable in any reactive scattering context ,",
    "the node problem is to date the most important issue impeding the progress of qtm s as a general and robust tool for scattering dynamics applications , although much progress has been made.@xcite    the bipolar cpwm approach to the node problem , as adopted here , and in the earlier series of articles,@xcite is inspired by classical and semiclassical theories  which employ a multipolar , -like decomposition as the means of preserving smooth and slowly - varying field functions . for stationary 1 dof applications , the @xmath5 and @xmath6 components are respectively , left- and right - traveling waves , with equal and opposite ( group ) velocities , @xmath7 and @xmath8 .",
    "oscillatory interference behavior is not evident in the individual component field functions , but arises naturally from their linear superposition . for stationary bound state calculations , cancellation of flux",
    "requires that the component densities , @xmath9 and @xmath10 , be equal .",
    "a reasonable generalization of classical field properties can be used to arrive at a unique exact quantum decomposition of the form , which  unlike the conventional unipolar ansatz [ ] satisfies the correspondence principle in the large - action limit.@xcite    for stationary scattering , or continuum state calculations , the non - uniqueness and non - square - integrability of the quantum solutions complicate matters somewhat,@xcite as might be expected .",
    "boundary conditions play an essential role , and specifically for the usual left - incident boundary conditions presumed here , necessarily imply asymmetry and non - zero flux for the corresponding exact quantum stationary solution . conventional scattering theory already provides an _ asymptotic _ ( i.e. @xmath11 ) bipolar decomposition into the familiar `` incident , '' `` transmitted , '' and `` reflected '' plane wave components  in fact the only decomposition possible that does not result in asymptotically oscillatory field functions .",
    "an exact quantum bipolar cpwm decomposition that respects all of the above can be constructed,@xcite with @xmath12 joining the incident and transmitted waves continuously through the interaction region , and @xmath13 , the reflected wave , damping to zero as @xmath14 .",
    "this is again achieved through analogy with semiclassical mechanics , albeit a `` sophisticated '' version.@xcite a key feature is that the trajectories are actually _ classical _ , with all quantum effects arising not from a quantum potential ( as in conventional bohmian mechanics ) , but through dynamical @xmath2 coupling .",
    "conceptually , this gives rise to instantaneous trajectory _",
    "hopping_@xcite from one cpwm component to the other , in the interaction region where the potential @xmath15 is changing . in effect",
    ", one has a _ local , time - dependent _ theory of stationary scattering , instead of the more traditional _ global , time - independent _ picture .",
    "the new theory thus provides some pedagogical insight , analogous to ray optics and cavity ring - down experiments.@xcite however , this paper focuses primarily on numerical aspects of the new approach  which may be regarded as a relaxation method with exponentially - fast convergence , for computing stationary scattering states of desired boundary conditions , and associated reactive scattering quantities such as reflection and transmission probabilities . in comparison with other quantum scattering methods ,",
    "the bipolar cpwm approach offers some decided numerical advantages .",
    "in particular , there is no need to invoke complex scaling ( analytical continuation)@xcite or absorbing boundary conditions ( optical potentials),@xcite as trajectories and field quantities are real - valued throughout .",
    "moreover , the scaling of computational ( cpu ) effort is linear with the grid size , @xmath16 , rather than proportional to @xmath17 .",
    "the new approach may therefore lead to some of the most efficient exact quantum scattering algorithms in existence , but certain practical limitations must first be overcome . to begin with ,",
    "the previous papers propose several distinct algorithms ; a detailed numerical analysis must be performed to determine which of these is `` best , '' from the perspective of numerical stability , robustness , and efficiency . in particular , some of these algorithms appear to be ineffective beyond a certain desired level of accuracy ( sec .  [ oldanalysis ] ) .",
    "the reasons for this must be elucidated via systematic study , in order to develop more efficient implementations . an even greater motivation , though , is the fact that the above problem is greatly exaggerated in the multidimensional case , resulting in numerical instabilities that have thus far hindered efforts in this direction .",
    "another limitation is that some of the previous algorithms are not applicable to completely general systems ( sec .",
    "[ oldmethods ] ) .",
    "this is addressed here by generalizing the methodology to allow for a nearly arbitrary choice of `` classical '' trajectory ( sec .",
    "[ general ] ) .",
    "finally , the robustness of the new algorithms must be demonstrated by application to representative molecular systems encompassing a very broad range of potentials , system parameters , and desired accuracy levels .",
    "one such application area , known to cause difficulties for conventional semiclassical and exact quantum methods , is particularly important  i.e . , the deep tunneling regime ( sec .  [ deeptunnel ] ) .",
    "other examples considered here include asymmetric potentials with barriers ( sec .  [ barrier ] ) and",
    "systems with reaction intermediates ( sec .",
    "[ double ] ) .",
    "here , we summarize some of the developments of refs .  1 - 3 . the basic goal is to define a set of time - evolution equations for the two 1 dof counterpropagating waves , @xmath18 , such that in the large @xmath19 limit , the total @xmath20 of approaches the exact stationary state evolution for the desired energy , @xmath21 , and boundary conditions .",
    "this general approach is thus a `` relaxation method , '' for which @xmath20 at intermediate times need not adhere to the actual time - dependent  equation  although there are versions of the method for which the latter property is also satisfied in a sense.@xcite for the usual left - incident boundary condition , the initial reflected wave must be zero , i.e. @xmath22 . the initial @xmath23 is essentially arbitrary , as it is presumed@xcite that any reasonable choice will converge exponentially quickly in the large time limit .",
    "however , two natural choices have been considered : ( 1 ) @xmath24 , i.e. incident asymptotic plane wave extended throughout space [ with @xmath25 presumed as @xmath26 ; ( 2 ) @xmath27 , i.e. incident wave truncated at left edge of interaction region , @xmath28 . in ref .",
    ", ( 1 ) and ( 2 ) above are referred to respectively as `` non - wave - front '' and `` wave - front '' versions .",
    "the latter gives rise to a useful cavity ring - down dynamical interpretation,@xcite although the former is found to converge more quickly to the exact solution , and is therefore used throughout this paper .",
    "note that ( 1 ) also has its own interpretation , to be discussed shortly .    from ref .",
    ", we also learn that there are two distinct semiclassical formalisms that can be applied to generate exact decompositions ( and associated time - evolution equations ) with the desired theoretical properties  the bremmer approach ( b)@xcite and the frman approach ( f).@xcite of the two , the b approach can only be applied when the trajectories are classical trajectories .",
    "unfortunately , classical trajectories cause numerical instabilities for both b and f evolutions whenever there is tunneling , i.e. for all below - barrier energies , @xmath21 , and is therefore not a viable choice for a completely `` robust '' algorithm",
    ". the f approach , on the other hand , can be generalized for almost _ any _ desired choice of `` semiclassical '' trajectory .",
    "in particular , constant velocity trajectories ( where the speed corresponds to the incident plane wave energy @xmath21 ) handle tunneling without difficulty , and lead to smoother field functions and remarkably simple f time - evolution equations : = i - i v [ pdotunigwf ]    some comments on are in order .",
    "first , these are the lagrangian , or `` hydrodynamic '' equations of motion , meaning that the left hand - side is a total time derivative , as would be appropriate for a trajectory ( moving - grid ) calculation .",
    "note that they require no differentiation of any kind  not even of the potential itself , to construct force fields .",
    "note also that the final , coupling term , i.e. that responsible for all quantum corrections beyond the `` semiclassical '' approximation , is proportional to @xmath15 , and vanishes in the @xmath29 reactant asymptotic limit .",
    "it also vanishes in the product asymptote provided the potential is `` asymptotically symmetric , '' i.e. @xmath30 as @xmath31 ( the asymmetric case will be addressed in sec .  [ discontinuous ] ) .",
    "this ensures that the @xmath32 solutions exhibit the requisite plane wave behavior for the desired energy @xmath21 .",
    "finally , we note that for the special case @xmath33 , i.e. the potential that would classically give rise to the constant velocity trajectories used , all coupling vanishes .",
    "this implies that the non - wave - front initial condition ( 1 ) described above is in fact the `` basic wkb''@xcite approximation in the generalized f sense , as will be exploited in sec .",
    "[ general ] .",
    "since the @xmath34 and @xmath35 trajectories move in opposite directions , the two moving grids are necessarily incommensurate at an arbitrary time , which numerically necessitates the use of interpolation for evaluating the coupling term in .",
    "alternatively , an `` eulerian '' or fixed - grid implementation can be adopted , for which the corresponding time - evolution equations are = v  + i - i v [ pdotuni ] , where @xmath36 is the trajectory speed , and primes denote spatial differentiation .",
    "the grids are now commensurate at all times , obviating the need for interpolation , but numerical differentiation is now required to evaluate the new convective term in .",
    "of the various possible numerical schemes presented in ref .   and above",
    ", we have thus far settled on just two candidates for the present purpose : the trajectory and fixed - grid versions of the non - wave - front , f , constant - velocity trajectory method .",
    "to choose one over the other , we must consider the stated criteria of numerical stability , efficiency , and robustness ( i.e. generality of applicability across different systems and computational accuracy levels ) .    in ref .",
    ", all of the calculations were applied to one degree - of - freedom ( 1 dof ) systems with similar parameter values and energies , and for the most part , to a desired accuracy level of @xmath37 . in this context",
    ", the two numerical schemes were found to be of roughly comparable efficiency ( i.e. total cpu time ) , with the trajectory approach requiring substantially fewer grid points ( around @xmath38 per dof ) and larger time steps ( @xmath39 ) , but a much longer cpu time per step , due primarily to the nearest - neighbor search algorithm that was employed . on the other hand",
    ", there were also clear indications that the trajectory method would become superior at higher accuracies  e.g . , ref .",
    "fig .  5 , which suggests that the fixed - grid error for reflection and transmission probabilities can not be reduced below @xmath40 or so , no matter how many grid points are used .",
    "a limit on achievable accuracy is clearly not a desirable trait for a robust method , and in particular , is complete anathema for accurate deep tunneling applications .",
    "consequently , a detailed numerical analysis of this situation was performed for this paper , in order to gain a thorough understanding of the factors responsible .",
    "in the course of this , it was discovered that the limiting accuracy can be substantially worse for other reasonable system parameter choices , especially for multidimensional systems , and/or those with reaction intermediates  lending additional imperative to the exercise .",
    "the manifestation of the error was quickly identified as oscillations in the right - asymptotic density @xmath41 , which form around @xmath42 , and then propagate inward over time  whereas it is clear from that the solution @xmath43 should be zero asymptotically .    ref .  , and the above - mentioned preliminary numerical investigations for this paper , computed fixed - grid spatial derivatives using centered , fourth - order finite differences@xcite ( one - sided for the endpoints @xmath44 and @xmath45 ) , and fourth - order runge - kutta time integration.@xcite however , the bulk of the present analysis uses second - order finite difference ( two - sided for interior grid points and one - sided for endpoints ) and first - order forward euler time integration , as a deliberate means of exacerbating the problem and simplifying the analysis , in order to identify the cause . the oscillation amplitudes were indeed found to be much larger in this case . it was also found that the oscillation wavelength was always 2 - 3 grid points , regardless of the density of grid points used . with respect to number of grid points , @xmath16 , ( keeping @xmath45 and @xmath44 fixed ) , the amplitude oscillation was found to decrease roughly inversely . reducing the time step had no effect whatsoever on the oscillation amplitude or wavelength , but did reduce the inward propagation speed , roughly proportionally .",
    "all of the above findings support the notion that the oscillation problem is somehow due to spatial differentiation .",
    "it might also be theorized that oscillations arise from the @xmath2 phase difference inherent in the coupling term of , but the wavelengths are incommensurate with what is actually observed . to definitively rule out coupling as the source of the problem ,",
    "however , a calculation was performed for the @xmath33 free particle system , for which there is no coupling  yet the above oscillations were still observed .",
    "another alternative explanation would be von - neumann instabilities.@xcite a straightforward theoretical analysis is possible for the free particle case , and so this was conducted , and compared to numerical tests for a wide range of time steps and grid spacings . in the theoretically von neumann stable regime , the oscillations were still observed , whereas in the von neumann unstable regime , the numerical solutions diverged over time as expected  a different phenomenon entirely .",
    "in fact , _ none _ of the vast literature on pde simulations of which the author is aware can account for the odd oscillatory behavior observed .",
    "the only sensible explanation of the cause can therefore be the `` mixed '' boundary conditions , which are highly non - standard , and perhaps have not been considered previously . in particular , ( x_r , t ) = 0 ; ( x_l , t ) = , [ bcs ] so that the two different components have boundary conditions on opposite sides .",
    "this situation is completely natural , given the counterpropagating nature of the method , and can not be changed through any straightforward theoretical recasting . within the fixed - grid framework",
    ", various numerical solutions have been essayed , including asymptotic plane wave rescaling , and amplitude / phase decomposition of the endpoint @xmath2 components , but none appears to provide substantial relief from the oscillation problem described above .",
    "we are thus led naturally to the trajectory , rather than fixed - grid , version of the non - wave - front , f , constant - velocity method .",
    "5 indicates the high accuracies ( around @xmath46 ) of which the trajectory approach is capable .",
    "this can be largely attributed to the fact that the trajectory version does not require numerical spatial differentiation . however",
    ", a more detailed numerical analysis reveals that the errors in this case also manifest as asymptotic oscillations , albeit of much smaller amplitude than the fixed - grid case , and with different scaling .",
    "more specifically , for a test eckart system comparable to that of ref .  , an inverse quartic relation is found between the oscillation amplitude and grid size , @xmath16 .",
    "this can also be roughly inferred from ref .",
    "fig .  5 , and is in any case not surprising , given that third - order interpolation is used ( sec .  [ interpolation ] ) .",
    "as in the fixed - grid case , the oscillation amplitudes and wavelengths are completely unaffected by time - step size .",
    "however , the latter quantity does turn out to be closely related to another , more serious type of numerical error also observed : in the large @xmath19 limit , the magnitude of @xmath47 grows linearly with @xmath19 in the left - asymptotic region . for typical @xmath48 values and desired accuracy levels , using fourth - order time evolution as in ref .",
    ", the growth rate is so slow as to contribute insignificantly to the final error .",
    "however , this asymptotic growth does present a very significant challenge for extremely accurate calculations ( e.g. @xmath49 as in sec .",
    "[ deeptunnel ] ) and must therefore be addressed .",
    "once again , to exaggerate the effect for analytical purposes , first - order forward euler time integration was used . for the test eckart system ,",
    "the growth rate ( with respect to system time , _ not _ number of time steps ) was found to depend roughly linearly on @xmath48 , and for typical ref .",
    "values ( @xmath50 a.u . , @xmath51 a.u . ) resulted in a final error of @xmath52 .",
    "an effective solution to the asymptotic growth problem has been found , but first it is necessary to divulge further details of the trajectory implementation , as presented schematically in fig .",
    "[ gridfig ] . at @xmath53 , the two trajectory grids ,",
    "i.e. `` upper '' ( for @xmath34 ) and `` lower '' ( for @xmath35 ) are coincident , with grid points at both @xmath45 and @xmath44 , and a uniform grid spacing of @xmath54 . over time , @xmath55 , the right - most trajectory of the upper grid , evolves beyond the interaction region , as does @xmath56 , the left - most point of the lower grid . at time",
    "@xmath57 , when these extremal points have progressed one grid spacing beyond the interaction region , they are discarded , and new upper / lower grid trajectories are introduced at @xmath45/@xmath44 , and assigned @xmath2 values in accord with .",
    "the indexing for both grids is shifted by one , resulting once again in coincident grids identical to that at @xmath53 .",
    "this approach obviates the requirement of a nearest - neighbor search algorithm , thus greatly reducing cpu cost per time step .",
    "it does require that @xmath58 be a multiple of @xmath48 , although in practice , this poses a very minor constraint .    ) and lower ( @xmath6 ) grids of the constant velocity trajectory bipolar counterpropagating wave method . at @xmath53 ,",
    "the @xmath59 points of both grids are distributed uniformly from @xmath45 to @xmath44 , with grid spacing @xmath54 . over time , the upper / lower grid points move with constant velocity @xmath60 . at time @xmath61 , the two grids are again coincident in the interior region .",
    "the two outermost points are deleted , and replaced with two new points ( indicated with open circles ) at the opposite ends of their respective grids , to restore the situation at @xmath53 . ]",
    "note from fig .",
    "[ gridfig ] that at general times within the cycle described above , one or two points from each grid lie outside the range of the opposite grid . in such cases",
    ", one might consider resorting to extrapolation to evaluate the coupling term in , although this approach is _ not _",
    "recommended.@xcite instead , since the exterior points all lie near the edges of the interaction region , we simply set @xmath62 in . in principle , this results in unitary plane wave propagation ( pwp ) for the exterior points . in practice ,",
    "the euler time integrator used here is _ not _ unitary ( nor is runge - kutta)thus causing the observed growth of asymptotic probability .",
    "this situation is well understood in the literature , and various alternative unitary time integrators exist.@xcite however , since the analytical plane wave solution is known , we simply adopt the following exact unitary pwp scheme : _",
    "k(t+ ) = _ k(t ) , [ pwp ] where @xmath63 indexes individual trajectories .",
    "the above pwp modification , applied to extreme points on _ both _ sides of the two grids in lieu of euler time integration , completely eradicates the asymptotic growth of probability over time .",
    "however , it leads to a new problem , i.e. asymptotic `` ramping . ''",
    "the idea here is that as the @xmath64 trajectory travels inward , calculation of the plane wave portion of shifts suddenly from the unitary pwp to the nonunitary euler integrator , causing the final converged solution to manifest a gradual increase in asymptotic @xmath65 from left to right .",
    "this spurious ramping was found to be on the order of a few percent for the test eckart system  though the effect is once again greatly exaggerated here , due to the first - order time integrator used .",
    "still , even with realistic time integrators ( e.g. fourth - order runge kutta ) the ramping problem would cause difficulties for very high - accuracy calculations .",
    "a simple solution is nevertheless available : use the pwp for the plane wave portion of the coordinate range ( i.e. not just in the asymptotic extremes ) .",
    "the first - order forward implementation is therefore as follows : @xmath66 where @xmath67 is computed via interpolation .",
    "use of has eradicated the nonunitary error completely in the test eckart application with parameters described above , resulting in a numerical solution accurate to several parts per thousand throughout the full @xmath68 range .",
    "the error that remains adheres to the form of interpolation error , as discussed above .",
    "as interpolation is a primary source of numerical error , it is essential for the present purpose that this operation be performed in as efficient and accurate a manner as possible .",
    "one of the key presumptions of successful interpolation is that the underlying mathematical function be smooth and well - behaved.@xcite this results not only in more accurate computation , but also better characterization of the numerical analysis .",
    "fortunately , the bipolar cpwm methodology is designed to provide smooth , slowly - varying field functions even when @xmath1 itself is not ; these have indeed been observed in all cases considered thus far , with the f constant - velocity functions being particularly slowly - varying .",
    "other desired attributes of the interpolation routine include generality , robustness , systematic error reduction , and a minimum of required user intervention.@xcite    in the previous work,@xcite fourth - order local polynomial interpolation was used , analogous to a moving least squares method with a stencil of five grid points for the interior of the grid.@xcite at the grid edges , fewer stencil points ( and lower - order polynomials ) were used . in principle , if the field functions are sufficiently smooth , and the grid points ideally distributed , then higher - order calculations can lead to more accurate results .",
    "however , this is not guaranteed , and in some cases higher - order interpolation may introduce unwanted wild oscillation between grid points.@xcite as robustness and ease - of - use are key for the present purpose as described above , we simply adopt third - order interpolation as the most reasonable ( and standard ) choice . also , since edge effects appear to be so important ( sec .",
    "[ oldanalysis ] ) , we retain third - order interpolation to the edges of the grids , i.e. four - point stencils are used throughout for polynomial interpolation .",
    "we also consider spline interpolation,@xcite for which the `` stencil '' is always two grid points , in effect , regardless of order .",
    "spline interpolation has the advantage of continuous second derivatives throughout the coordinate range , yielding `` stiffer '' interpolants that are more stable , and generally more accurate for smooth functions .",
    "the numerical implementation described in sec .",
    "[ constant ] employs interpolation only when evaluating the coupling term , i.e. the very last @xmath67 quantity in .",
    "although are written in terms of @xmath2 , in fact it is the real - valued field quantities , @xmath69 and @xmath70 , obtained from ( x ) = r_(x ) e^i s_(x)/ , [ twolm ] that are designed to be most smooth and slowly - varying ( especially in the classical limit).@xcite numerically , one might consider storing @xmath71 and @xmath72 values instead of @xmath73 s , but the corresponding becomes complicated , nonlinear , and numerically less stable .    instead",
    ", we adopt a `` best of both worlds '' approach , whereby @xmath73 values are stored and used in , @xmath74 s and @xmath75 s obtained at each time - step , and the latter interpolated to compute the coupling term in via . obtaining @xmath76 is straightforward ; however , @xmath77 requires special care in the choice of branch cut , to ensure continuity of the field function throughout the coordinate range .",
    "our simple solution to this well - known dilemma@xcite is the recursive implementation    s_(k+1 ) =    with @xmath78 by definition .",
    "note also that due to the regular structure of the grid , there is no need for a search algorithm to compute the stencil for a given interpolant point , i.e. the total cpu effort per time - step associated with interpolation scales as @xmath16 rather than @xmath79 , placing it on a par with potential function evaluation .",
    "the above @xmath80 interpolation scheme yields phenomenal improvements in accuracy when applied to the test eckart problem of sec .",
    "[ constant ] , as compared to the @xmath2 interpolation applied there .",
    "the numerical solutions still exhibit asymptotic oscillations ; however , these are no longer constant in amplitude , but damp exponentially with increasing @xmath81 , as do the true mathematical solutions . in any case , at the @xmath82 a.u .",
    "grid - edge values considered , the amplitude has been reduced from a few parts per thousand ( sec .",
    "[ constant ] ) to a few parts per _ million _ , using a grid of only @xmath83 points .",
    "we conclude this subsection with a brief numerical comparison between polynomial and spline interpolation ( both third order ) in the context of the above algorithm as applied to the eckart b problem with @xmath84 ( sec .",
    "[ eckart ] ) .",
    "first though , as any complete spline implementation requires specification of the boundary conditions , we compared the accuracy of zero - second - derivative boundaries ( natural splines ) vs. the more usual zero - first - derivative case , for known functions similar to those computed below .",
    "the natural spline case was found to be about an order of magnitude more accurate throughout the coordinate range , and is therefore adopted .    for comparative purposes , both natural spline and polynomial interpolation",
    "were applied to the eckart b problem .",
    "both cases are characterized by quick convergence with respect to grid size , @xmath16 , with the spline case converging more quickly . with respect to the time step , @xmath48 , polynomial interpolation converges more quickly at first",
    " i.e . , for larger @xmath48 values and lower accuracies . beyond a certain point",
    "however , the polynomial error flattens out and even _ increases _ with subsequent decrease in @xmath48 ( even if @xmath16 is allowed to increase ) , whereas the spline error becomes arbitrarily small .",
    "further analysis reveals that this behavior of the polynomial interpolation is due to asympotic oscillations , which increase in amplitude with decreasing @xmath48 , whereas in the spline case , the oscillation amplitudes are independent of @xmath48 .",
    "the polynomial case thus exhibits an effective minimum achievable error , on the order of @xmath40 for the case considered ( note : in conjunction with first - order forward time evolution ) .",
    "the parameters used for this optimized polynomial calculation were also applied to a spline calculation , which was found to be both more accurate ( orders of magnitude so for the transmission probability ) and faster ( by about 30% ) . taking these facts into consideration , we adopt natural cubic spline interpolation from here on out .      the constant - velocity trajectory method as discussed above is not applicable for asymptotically asymmetric potentials@xcite  i.e . , @xmath85 , where @xmath86 and @xmath87 .",
    "mathematically , this is because the coupling term in does not vanish in the product asymptote ( @xmath88 ) , and so the @xmath18 components do not converge over time .",
    "physically , it is because the trajectory velocity @xmath89 is not commensurate with the product translational kinetic energy , @xmath90 . in any event ,",
    "the presumption @xmath91 is too restrictive in practice to be of general use , and so some appropriate resolution must be found .",
    "one might consider the classical trajectory bipolar cpwm , for instance , which would work fine for barrierless reactions ; however , the more general and realistic case of an asymmetric reaction _ with _ a barrier ( fig .",
    "[ asympotfig])and therefore below - barrier energies  would seem to be beyond the reach of either method .",
    "on the other hand , the above difficulty is simply a manifestation of a standard concern that is not at all new in reactive scattering theory ",
    ", that the product and reactant asymptotic potentials , and associated quantum states , are not the same.@xcite various remedies have been prescribed for this , including use of a `` dividing surface''@xcite that partitions configuration space into reactant and product sides . for 1 dof applications , the dividing `` surface '' is just a single point , labelled @xmath92 .",
    "we can easily incorporate the dividing point idea into the constant velocity scheme by using trajectories with reactant asymptotic velocities in the @xmath93 region , and another set with product asymptotic velocities in the @xmath94 region .",
    "the appropriate generalization of ( which holds for any asymptotic values of the potential ) is @xmath95 with `` @xmath96 '' referring to the reactant ( left ) side of @xmath92 , and `` @xmath97 '' the product ( right ) side .",
    "the corresponding trajectory velocities are @xmath98 .",
    "although @xmath1 itself , and its first spatial derivative , must be continuous across @xmath99 at all times , the components @xmath2 are decidedly _ discontinuous_. in a trajectory implementation , @xmath100 and @xmath101 are known quantities , and @xmath102 and @xmath103 are unknown ; however , the @xmath1 constraint above can be used to uniquely specify the latter quantities in terms of the former.@xcite for the sake of numerical efficiency , it is advisable that @xmath104 and @xmath105 trajectories cross @xmath92 at exactly the same time ; when this occurs , these `` edge '' trajectories ( for their respective regions ) are destroyed , and new edge trajectories for @xmath106 and @xmath107 simultaneously created without needing to resort to extrapolation .",
    "this is also when trajectory `` shifting '' occurs , as per sec .",
    "[ constant ] .",
    "the above trajectory crossing condition requires that the grid spacings be different on either side of @xmath92 , i.e. @xmath108 .",
    "in other respects , the algorithm is similar to sec .",
    "[ constant]except that when @xmath109 , we can not use for the edge trajectories near @xmath92 , because the coupling in this region is significant .",
    "instead , we must use , even though this implies extrapolation within a range @xmath110 of @xmath92 .",
    "it would be beneficial to develop a single , robust , and efficient bipolar cpwm scheme with none of the limitations of the previously - described methods .",
    "the method should in other words be continuous , slowly - varying and extrapolation - free , yet applicable to completely general potentials such as that of fig .",
    "[ asympotfig ] . from the discussion in sec .",
    "[ oldmethods ] , it is natural to consider the generalized f approach in this regard . specifically , the `` semiclassical '' trajectories considered need have no direct relation to the actual potential @xmath15 , but rather , are defined for some arbitrary effective potential , @xmath111 , as @xmath112 .",
    "the specific choice @xmath113 reproduces the classical trajectory scheme , @xmath114 the constant - velocity scheme , and @xmath115 the discontinuous scheme .",
    "the ideal @xmath111 should :    1 .",
    "approach the flat @xmath15 function in both asymptotic limits , i.e. @xmath116 2 .",
    "vary smoothly and monotonically through the interaction region .",
    "condition 1 .",
    "results in vanishing asymptotic coupling , whereas 2 .",
    "ensures there are no turning points , so that barrier tunneling poses no difficulties .",
    "a sigmoid ramp function is thus clearly indicated ; below , we present a specific form based on the tanh function that is applicable to extremely general situations .",
    "although this form might not be ideally suited to systems with reaction intermediates , one could in that case add several ramp potentials together to match the reaction profile appropriately . in any event",
    ", we must first work out the theory and numerical implementation for the generalized f - based cpwm approach .",
    "the generalized f decomposition of for stationary scattering states in 1 dof is uniquely determined from the time - independent  equation and the relation@xcite  = -v 2v",
    "[ fpprimeb ] for completely general @xmath7 , these lead to  = a , [ generalppm ] where a = . [ aex ]    for consistency , it is convenient to reexpress the @xmath89 derivatives above in terms of @xmath117 and its derivatives . if the trajectory equations of motion are to have no @xmath2 spatial derivatives as desired , then we must construct a convective term somehow ; this is easily accomplished by multiplying by @xmath118 .",
    "the result is : next , we replace @xmath119 in with @xmath120 .",
    "adding @xmath121 to both sides , and recognizing that for the stationary solution , @xmath122 , we obtain finally    note that for constant velocity trajectories , @xmath123 , and reduces to , as it should . also interesting ( and useful )",
    "is the fact that satisfies the combined continuity relation@xcite  i.e .",
    "the total combined probability ( @xmath124 ) is conserved over time , even though the individual @xmath125 are not .",
    "the precise flux relation giving rise to this is = - j_ , [ fluxrel ] where @xmath126 is the flux , defined in terms of the generalized trajectory velocities . for the constant velocity case ,",
    "this reduces to ref .",
    "( 13 ) .    in implementing the above scheme numerically ,",
    "we borrow from the successful constant - velocity algorithm as much as possible . the condition that over a duration of time , @xmath58 , each grid point should progress to the precise spot vacated by its nearest neighbor , implies a very nonuniform grid  with a higher density of points in areas where @xmath89 is lower , as is appropriate . though by no means",
    "necessary , we find it convenient to compute all of the trajectories in advance . actually , only the single trajectory @xmath127 need be computed  starting at @xmath128 , and propagating classically in accord with @xmath117 to a bit past @xmath42 .",
    "the other trajectories can then be obtained via @xmath129 , and @xmath130 . the @xmath127 values for each positive integer multiple of the cpwm time step , @xmath48 , are computed and stored during this preprocessing phase , as are the corresponding effective potential values @xmath117 , @xmath131 , and @xmath132a technique that can in principle save much cpu time during the subsequent cpwm propagation phase .",
    "note that by design , the trajectory version of involves no explicit spatial differentiation of @xmath2 ; once again , the largest source of numerical error ( and cpu effort ) is interpolation . to ensure that the trajectory calculation does not contribute appreciably to the error , it is performed using a much smaller time step , @xmath133 ; even so , the cpu cost of the preprocessing phase is a trivial part of the whole cost .",
    "also , numerical comparisons with @xmath134 and @xmath135 reveal no discernible difference in computed results .",
    "another difference from the constant - velocity scheme is the choice of initial conditions .",
    "based on the discussion in sec .",
    "[ oldmethods ] , we take @xmath136 to be the basic wkb solution , i.e. _ + ( x,0 ) = , where the initial action , @xmath137 , is also computed during the preprocessing phase ( the initial reflected wave is of course still zero ) .",
    "the generalization of is seemingly non - trivial : with all functions evaluated at @xmath138 .",
    "the rationale is the same as before however : the asymptotically vanishing coupling term in ( but for @xmath1 , rather than just @xmath2 ) is treated using forward euler propagation ; everything else is exponentiated as per .",
    "the proceeding discussion is completely general , i.e. applies to any choice of @xmath111 .",
    "however , for single - barrier reactions ( no intermediates ) , we advocate the following analytical ramp functional form , whose derivatives are also specified : as in sec .",
    "[ discontinuous ] , @xmath92 should be in the middle of the @xmath15 interaction region , and @xmath139 comparable to the interaction region size .      to summarize ,",
    "the key numerical developments in this section have been : ( 1 ) use of trajectory grids that are coincident when @xmath19 is a multiple @xmath58 ( implying that @xmath58 itself is a multiple of @xmath140 ) ; ( 2 ) unitary plane wave ( or exponential ) propagation throughout the coordinate range ; ( 3 ) third - order spline interpolation of @xmath69 and @xmath70 , to evaluate the coupling contribution to the time - evolution equations .    for",
    "asymptotically symmetric potentials , the recipe for numerical propagation of the constant velocity trajectory quantities is as follows :    * move each grid point , @xmath141 , via @xmath142 * for exterior grid points outside the range of the opposite grid , update @xmath73 via . * for interior grid points ,",
    "update @xmath73 via eqs .",
    "( [ totalp ] ) , ( [ twolm ] ) , and ( 9 ) .    for asymptotically asymmetric potentials ,",
    "the ramp trajectory method is preferred over the discontinuous trajectory method ( sec .",
    "[ results ] ) .",
    "the ramp trajectories are computed and stored _ a priori _ , in a preprocessing step .",
    "the subsequent numerical propagation is as follows :    * for exterior grid points outside the range of the opposite grid , update @xmath73 via the first line of . * for interior grid points ,",
    "update @xmath73 via eqs .",
    "( [ totalpgen ] ) , ( [ twolm ] ) , and ( 9 ) .",
    "in this section , the three different numerical algorithms described in detail in sec .",
    "[ theory]i.e .",
    "the constant velocity , discontinuous constant velocity , and ramp trajectory versions of the non - wave - front f trajectory method  are applied to a variety of test applications , in order to assess them for robustness and numerical efficiency . in all cases , first - order forward euler time - evolution",
    "is employed as discussed previously , leading to `` artificially '' small time steps , @xmath48 ( e.g. as compared to the fourth - order runge - kutta results of ref .  ) .",
    "the mass @xmath143 a.u .",
    "is used in all applications .",
    "a thorough and detailed convergence study was performed for each application as follows .",
    "first , given the small oscillations with @xmath68 that characterize the numerical @xmath144 solutions in the asymptotic regions , the usual determination of reflection and transmission probabilities as @xmath145 ; @xmath146 is not used . instead",
    ", a small range of points near @xmath147 is consulted to characterize both mean values _ and uncertainties _ for these quantities .",
    "reducing the oscillatory uncertainty to an acceptably small level is one of two conditions that must be satisfied to achieve convergence ; the second is that variation of the mean @xmath148 and @xmath149 values with respect to all numerical parameters be acceptably small .",
    "the convergence parameters , in the cyclical order in which they are varied ( keeping all others fixed ) are as follows : maximum time , @xmath150 ; grid spacing , @xmath151 ; time step , @xmath48 ; grid boundaries , @xmath147 . for each of the applications considered",
    ", tens of convergence calculations were performed , usually over multiple cycles .",
    "the first application considered is the symmetric eckart barrier,@xcite v(x)=v_0(x)^2 , [ eckartpot ] with parameter values @xmath152 , and @xmath153 a.u , which for the present paper is labeled `` eckart a. '' this application is identical to the eckart problem of ref .  , and is chosen here in part to compare with the previous results . a plot of this potential is presented in fig .",
    "[ sympotfig ] .",
    "a detailed convergence study was performed for the energy equal to the barrier peak , i.e. @xmath154 hartree .",
    "this energy was chosen because it provides a good splitting of probability between @xmath148 and @xmath149 .",
    "of the three numerical methods considered , only the constant velocity method is applicable here  because both the discontinuous constant velocity and ramp trajectory methods reduce to the constant velocity method when the potential @xmath15 is symmetric . in any event ,",
    "the parameters that resulted from the convergence procedure described above , with @xmath37 as the target accuracy for both @xmath148 and @xmath149 , are presented in table  [ sympottab ] column  3 .",
    "these can be compared directly to the ref",
    ".   calculation ( computed to the same level of accuracy ) , presented in column  2 , as well as to the analytical values given in the last two rows .    [ cols=\"^,^,^,^,^,^ \" , ]     the discontinuous constant velocity case is considered first , i.e. table  [ asympottab ] column 2 .",
    "as compared with the eckart a calculation in table  [ sympottab ] column 3 , the most compelling difference is that a much higher density of grid points is needed ( @xmath155 vs. @xmath156 ) , even though the final computed accuracy is somewhat lower .",
    "this is most likely attributable to the use of extrapolation ( sec .",
    "[ discontinuous ] ) in the middle of the interaction region where the coupling is greatest .",
    "one indication is the fact that the asymptotic oscillations are much smaller than for eckart a , and not a contributing factor to the total error .",
    "another significant difference is found in the parameter @xmath157 , which is larger in the uphill ramp case , probably owing to the fact that product trajectories are substantially slower than for eckart a. perhaps for the same reason , @xmath48 is also somewhat larger for the uphill ramp .",
    "the ramp trajectory convergence parameters are shown in table  [ asympottab ] column 3 .",
    "the @xmath158 grid size is now greatly reduced in comparison to column 2 , almost to the eckart a level , again suggesting that the primary source of error in the discontinuous case is extrapolation . the small increase in @xmath16 relative",
    "to eckart a may be due to the fact that grid spacing in product and reactant regions are not independently adjustable ( which may also be a contributing factor in the discontinuous calculation ) . another key difference between the two asymmetric calculations is that @xmath157 is substantially reduced in the ramp trajectory case  most likely reflecting the fact that the initial semiclassical approximation @xmath159 is much closer to the actual solution ( sec .",
    "[ general ] ) .",
    "nevertheless , the time step @xmath48 is substantially larger . taken together , all of the above findings imply that cpu effort for the ramp trajectory calculation is greatly reduced in comparison to the discontinous calculation .      the barrier ramp system ( fig .",
    "[ asympotfig ] ) is the first asymmetric reaction with a barrier to be treated using cpwm methods .",
    "serving as representative of a generic reaction profile , moreover , it is an extremely important benchmark system .",
    "this is especially true for the ramp trajectory method , because @xmath111 , being monotonic , can no longer be equal to @xmath15 , which might in principle affect computational efficiency . to construct a suitable barrier ramp potential , we simply add an eckart barrier and an uphill ramp together .",
    "the eckart parameters [ ] are taken to be @xmath160 a.u . and",
    "@xmath161 a.u , whereas the uphill ramp is identical to that of sec .",
    "[ uphill ] .",
    "the ramp trajectories are also identical to sec .",
    "[ uphill ] , i.e. @xmath111 is the same as before .",
    "the energy @xmath162 a.u is also the same as in sec .",
    "[ uphill ] , as are the asymptotic trajectory velocities , @xmath163 .",
    "the discontinuous and ramp trajectory convergence parameters are shown in table  [ asympottab ] columns 4 and 5 , respectively .",
    "in both cases the grid parameters are nearly identical to the corresponding uphill ramp calculations ( columns 2 and 3)implying that the presence of the barrier introduces no numerical difficulties for either method .",
    "the @xmath157 values are somewhat larger , undoubtedly owing to the fact that the barrier ramp case has much greater reflection.@xcite for the discontinuous calculation , @xmath48 is lower than the uphill ramp value , perhaps because the absolute accuracy of the computed @xmath148 is much less .",
    "this situation is reversed for the ramp trajectory calculation , for which a somewhat smaller @xmath48 is required .",
    "the reason may have to do with the fact that @xmath164 , giving rise to larger coupling in .",
    "the last case to be considered is a system with reaction intermediates . in ref .  , a double - gaussian barrier was employed . here",
    "however , we wish to have more flexibility in the functional form , in order that a wider range of reaction profiles may be considered . to achieve this , a sum of two barrier ramps is used , centered at the transition states on either side of the reaction intermediate .",
    "though symmetry is not required , for simplicity we adopt the symmetric form here as follows : the parameters @xmath160 a.u , @xmath165 , @xmath166 a.u . , and @xmath167 a.u .",
    "are comparable to those used for the barrier ramp and eckart a systems .",
    "the energy , @xmath168 a.u , lies slightly below the barrier peak of around @xmath169 a.u .",
    "a plot is presented in fig .",
    "[ sympotfig ] .",
    "although this system would be a good candidate for a double ramp trajectory scheme ( sec .",
    "[ general ] ) , the constant velocity trajectory algorithm is used here .",
    "convergence for both @xmath148 and @xmath149 to @xmath170 is indicated in table  [ sympottab ] column 6 .",
    "this accuracy is somewhat lower than for eckart a ( column 3 ) , to avoid slow @xmath48 convergence ( sec .",
    "[ eckart ] ) .",
    "the coordinate range is larger than for eckart a , but the grid density is actually somewhat _ smaller _ ( despite the fact that the potential has more features ) , such that the @xmath156 grid size is the same for both .",
    "the convergence time @xmath157 is much larger than for eckart a , as is expected for a system with tunneling and reaction intermediates.@xcite in other respects , the calculation is similar to , and no more difficult than , the other calculations without reaction intermediates .",
    "based on the results as presented above , we conclude that all of the primary goals of this paper have been achieved . in particular , the robustness of the methods are demonstrated by the very broad range of test cases considered .",
    "these may be definitively regarded as `` representative '' of many other 1 dof calculations ( not described here ) that were also performed .",
    "the efficiency of the methods is also established , in that most of the calculations that do not involve deep tunneling or reaction intermediates require no more than about one second of cpu time .",
    "finally , the accuracy levels that can be achieved have been greatly expanded beyond previous limits , e.g. , to twelve - to - thirteen digits past the decimal in the extreme deep tunneling case ( table  [ deeptab ] column 4)probably the highest accuracy ever achieved in a trajectory - based quantum calculation .",
    "although 1 dof systems are usually regarded as trivially soluble , these can nevertheless pose severe numerical difficulties when extremely deep tunneling is involved ; it is therefore particularly encouraging to see that the new methods work well in both this limit , and for more typical molecular situations .",
    "indeed , there do not appear to be any 1 dof applications for which the present algorithms would not work well .",
    "this is of the utmost importance for the main motivation of the present work , i.e. creating a parameter - free ( except for convergence parameters ) `` black - box '' quantum dynamics code for solving any 1 dof stationary scattering problem .",
    "a single universal algorithm is sought , although three specific implementations were considered in this paper : ( 1 ) constant velocity ; ( 2 ) discontinuous constant velocity ; ( 3 ) ramp trajectory .",
    "as both ( 2 ) and ( 3 ) reduce to ( 1 ) in the asymptotically symmetric potential case , the only real choice is between ( 2 ) and ( 3 ) . for reasons elucidated in sec .",
    "[ results ] , ( 3 ) is clearly the better choice , both with respect to numerical efficiency _ and _ robustness . as evidence of the latter , about the same number of grid points",
    "is required for systems with similar parameters , regardless of whether the potential is asymmetric , or has one or more barriers ( compare table  [ sympottab ] columns  3 and 6 with table  [ asympottab ] columns 3 and 5 ) .    the ramp trajectory scheme , ( 3 ) , is therefore proposed for the universal purpose described above .",
    "one can imagine a straightforward procedure to automatize the selection of suitable ramp parameters for any given potential without reaction intermediates .",
    "such a procedure would presumably be easily generalized to multiple ramp trajectories in the case of reaction intermediates , thus maintaining `` black - boxness '' for all cases . on the other hand , even a single ramp is seen to perform very well for multiple barrier systems [ as in sec .",
    "[ double ] , due perhaps to the smoothness of @xmath111 ] , so that a single ramp may be all that is ever actually needed in practice .",
    "in fact an earlier preliminary investigation ( without the numerical refinements of sec .  [ theory ] )",
    "obtained slightly faster convergence and smoother field functions for single vs. double ramp calculations .",
    "note that the dynamical equations derived in sec .",
    "[ general ] are completely _ general _ , and could in principle be used to explore other candidate functional forms for @xmath111 .    in any case , well - documented stand - alone fortran codes for all three algorithms considered here are available from the author on demand  which , in the case of ( 3 ) at least , will also incorporate future developments . note that the weakest algorithmic aspect at present is the first - order forward time integration of the coupling term in the dynamical equations  leading to slow @xmath48 convergence beyond a certain point , and much smaller typical @xmath48 values than in ref .",
    "( @xmath172 a.u . ) , which used standard fourth - order runge - kutta integration .",
    "the first order of business is therefore to incorporate a similar time - integrator into algorithm ( 3)or perhaps something even more advanced , such as the time - adaptive cash - carp method,@xcite or multistep adams - bashforth method.@xcite preliminary investigations indicate that this will lead to far greater time step sizes even than those used in ref .",
    "e.g . , @xmath173 a.u",
    ". or more .",
    "if not the case already , such a modification would result in the most accurate and efficient quantum dynamics codes available for 1 dof systems .    of course , the primary challenge for future development is multidimensional systems . as discussed in sec .",
    "[ intro ] , the theoretical developments are already in place , both for stationary state and wavepacket scattering dynamics . these will be presented in detail in future publications , but a brief outline may be found in the summary and conclusions of ref .  .",
    "for the multidimensional stationary state method , numerical instability of the sort described here has proven to be an issue .",
    "accordingly , new multidimensional algorithms will be developed that incorporate the modifications of the present work .",
    "in addition to ( hopefully ) providing numerical stability , the reduced number of grid points der dof that characterizes the present approach should lead to far greater reductions in cpu effort for applications with more dofs . for wavepacket dynamics , it turns out that more conventional bohmian trajectories are appropriate ( defined via @xmath174 ) . in anticipation of this , we have analyzed @xmath175 curves for the stationary solutions obtained here , and found : ( 1 ) smooth , but not always monotonic , behavior ; ( 2 ) asymptotic agreement with trajectories used here for all but the @xmath176 asympotes ; ( 3 ) exactly _ opposite _ trajectories in the @xmath176 asymptote .",
    "the last observation , though curious , may not be significant , as @xmath177 also vanishes in the same limit",
    ".    this work was supported by an award from the welch foundation ( d-1523 ) .",
    "corey trahan is acknowledged for performing some of the preliminary numerical investigations .",
    "jason mcafee is also acknowledged for his aid in converting this manuscript to an electronic format suitable for the arxiv preprint server ."
  ],
  "abstract_text": [
    "<S> in a recent series of papers [ j. chem . phys . * 121 * 4501 ( 2004 ) , j. chem . </S>",
    "<S> phys . * 124 * 034115 ( 2006 ) , j. chem . </S>",
    "<S> phys . * 124 * 034116 ( 2006 ) ] a bipolar counter - propagating wave decomposition , @xmath0 , was presented for stationary bound states @xmath1 of the one - dimensional  equation , such that the components @xmath2 approach their semiclassical wkb analogs in the large action limit . </S>",
    "<S> the corresponding bipolar quantum trajectories are classical - like and well - behaved , even when @xmath1 has many nodes , or is wildly oscillatory . in this paper , </S>",
    "<S> the earlier results are used to construct a universal `` black - box '' algorithm , numerically robust , stable and efficient , for computing accurate scattering quantities of any quantum dynamical system in one degree of freedom . </S>"
  ]
}