{
  "article_text": [
    "the square site percolation threshold , @xmath1 , is a clearly and simply defined mathematical concept @xcite .",
    "percolation models have been well studied , and are known for their numerous applications @xcite . yet to date , no analytical expression has been found for the numerical value of @xmath1 .",
    "the square site lattice lacks the symmetry that has allowed exact solutions on other topologies @xcite .",
    "so long as the problem remains intractable , statistical estimates from monte carlo studies can , at least , offer approximate values .",
    "such calculations invariably make extensive use of some form of pseudorandom number generator ( prng ) .",
    "a prng is a deterministic algorithm that outputs a sequence of words with properties closely mimicking those of a truly random sequence .",
    "well analysed generators include the linear congruential , lagged fibonacci , generalised feedback shift register , and derivatives thereof @xcite .",
    "because these algorithms are simple , they do not produce output with the complexity of a random sequence @xcite .",
    "the autocorrelation coefficients of a pseudorandom sequence are not identically zero , and these departures from true randomness introduce a sampling bias that leads to systematic error .",
    "twenty years ago , concern was being given to the demands then made of prngs in calculations using @xmath2 pseudorandom numbers generated at mhz rates @xcite .",
    "recently , high performance parallel computer systems with thousands , rather than tens or hundreds , of processors have become much more widely available .",
    "these enable calculations with @xmath3 pseudorandom numbers generated at ghz rates , and are likely to play a central role in future research .",
    "very high precision can now be achieved through brute force of sampling , but accuracy is another matter . for reliable monte",
    "carlo estimates at these new higher precision levels , the prng(s ) chosen must be of sufficient quality .",
    "hence contemporary demands upon prngs are , and will continue to become , much greater than in the past .",
    "this study compares several established prngs within the context of the square site percolation problem .",
    "following application specific testing , a seemingly reliable generator is identified .",
    "this is subsequently used to locate the percolation threshold with , in principle , both accuracy and precision .",
    "throughout this study , the computational word length , @xmath4 , shall be fixed at @xmath5 .",
    "all arithmetical operations taking place within any prng are performed in modulo @xmath6 .",
    "all prng arithmetical operands , and products thereof , are members of @xmath7 , where @xmath8 denotes the set of all integers not less than @xmath9 and not greater than @xmath10 .",
    "consequently the words of any prng output sequence also belong to @xmath7 .",
    "the @xmath11th word of an output sequence shall be denoted by @xmath12 . with one noted exception ,",
    "no output sequence is decimated in any way .",
    "the first million words of each sequence are discarded prior to beginning any monte carlo sampling procedure .",
    "some prngs make use of bit - wise operations within their internal algorithms .",
    "the notation adopted here is @xmath13 for bit - wise boolean logical exclusive - or , and @xmath14 for shift @xmath15 bits to the right ( where @xmath15 is a positive integer ) .",
    "whenever these bit - wise operations are performed , the operands are decomposed into their respective standard binary representations , most - significant bit ( leftmost ) to least - significant bit ( rightmost ) .",
    "arithmetic being constrained to a subset of the integers , any bits shifted to a position right of the decimal point are lost .",
    "hence , within this study , the operation of @xmath14 is equivalent to integer division by @xmath16 .",
    "the specific prngs considered within this exercise are defined as follows .",
    "tt is the two - tap additive lagged fibonacci generator @xmath17 .",
    "this generator has previously been used for high - precision percolation threshold measurement by newman and ziff @xcite .",
    "ttt combines the output from a pair of two - tap generalised feedback shift - register generators , @xmath18 and @xmath19 , to return a single word @xmath20 .",
    "this is the generator most likely used for two and three dimensional percolation by deng and blte @xcite .",
    "swb is a marsaglia and zaman subtract with borrow generator , @xmath21 , where the borrow , @xmath22 , is equal to one if @xmath23 , and is otherwise equal to zero @xcite .",
    "qta is the quad - tap generalised feedback shift - register generator @xmath24 , as used by ziff and stell @xcite ( see @xcite ) .",
    "qtb is the quad - tap generalised feedback shift - register generator @xmath25 .",
    "this generator has been used by newman and ziff , and has been found to produce threshold estimates consistent with those of the tt generator @xcite .",
    "xg is brent s xorgen4096 generator @xcite .",
    "specifically , the implementation xorgen4096i , from his c language xorgens304 distribution , was that used here .",
    "this generator has performed well in randomness tests conducted by lecuyer and simard @xcite .",
    "mt is matsumoto and nishimura s mt19937 mersenne twister generator @xcite .",
    "specifically , their mt19937ar c language distribution was the implementation used here . the mt19937 algorithm has been used for computing integrals in semi - rigorous work by balister , bollobs , walters and riordan @xcite , and for monte carlo sampling by lee @xcite .",
    "dmt is a pair of mt generators operated entirely independently of one another .",
    "the output sequence from each of these generators is decimated , with only every fourth word used .",
    "lattice sites are then selected by means of their cartesian coordinates , using one number from each generator .",
    "this scheme has previously been used by lee @xcite .",
    "let @xmath26 be the number of sites lying on each edge of an @xmath27 square lattice .",
    "every site on that lattice is typically given a unique index or label , @xmath28 . in a microcanonical ensemble monte carlo calculation @xcite , such as those performed here , prng output words , @xmath12 , are used to pseudorandomly select sites , @xmath29 , for occupation .",
    "now , consider a transformation @xmath30 , where @xmath31 is a positive - integer power of two .",
    "this is a distribution preserving many - to - one surjective map from the integers @xmath32 to the integers @xmath33 .",
    "further consider a bijection @xmath34 that maps the integers @xmath35 onto site labels .",
    "with the usual choice of site labels also being the integers @xmath35 , @xmath34 is conventionally taken to be the identity map . in the single generator systems defined above ,",
    "prng output word @xmath12 is associated with site @xmath36 via @xmath37 . for the dmt ,",
    "a pair of prng output words , @xmath38 and @xmath39 ( one from each of the output decimated mt generators ) , is mapped to site @xmath40 via @xmath41 .",
    "this halves the number of bits actually used from each output word ( the most significant bits being those retained ) .",
    "each of these generators must be provided with an initial finite sequence of words from which to begin calculating an infinite pseudorandom sequence . in the case of the tt generator for instance , a list of some @xmath42 initial words is required .",
    "these initial lists were constructed by one of four simpler generators , here denoted lcga , lcgb , lcgm and wmx .",
    "lcga is the linear congruential generator , @xmath43 , suggested by marsaglia @xcite .",
    "lcgb is a similar linear congruential generator , @xmath44 , also due to marsaglia @xcite .",
    "lcgm is the modified linear congruential generator , @xmath45 , appearing in matsumoto and nishimura s mt19937ar distribution of their mersenne twister algorithm .",
    "wmx is the weyl modified marsaglia xorshift generator built into the xorgens4096i algorithm appearing within brent s xorgens304 distribution @xcite .",
    "these initialisation generators are themselves seeded from a single word , @xmath46 .",
    "the ttt and dmt generators both require two initialisation lists , each being derived from one of these four generators , each starting with a distinct independent seed word .",
    "the above listed generators were compared , in the context of site percolation on the square lattice , by using each one to make a monte carlo estimate of the crossing probability function , @xmath47 , at @xmath48 , over the domain @xmath49 .",
    "@xmath47 is defined as the probability that a single cluster connects two specified opposing boundary sides of the @xmath50 square lattice in the microcanonical ensemble when precisely @xmath51 random sites are occupied .",
    "the value of @xmath52 monotonically increases from around @xmath53 at @xmath54 to around @xmath55 at @xmath56 .",
    "hence the occupation domain studied encompasses the critical region of the percolative phase transition .",
    "the numerous lattice configurations required to accurately determine @xmath47 were constructed , from each prng output sequence , over the above domain only , by the unbiased algorithm of lee @xcite .",
    "the only exception was the xg generator from which samples were obtained over the same domain by the unbiased algorithm of newman and ziff @xcite .",
    "the newman and ziff binomial convolution @xmath57 then gives the crossing probability , @xmath58 , in the canonical ensemble where each lattice site is independently randomly occupied at probability @xmath59 @xcite . in principle",
    "the summation should run over all @xmath60 , but as samples were taken only over the restricted domain of @xmath51 above , the summation was truncated accordingly .",
    "the standard deviation of the binomial distribution in equation ( [ ce ] ) is given by @xmath61 .",
    "the data analysis here is concerned with values of @xmath59 such that the distribution maximum , located at @xmath62 , lies between @xmath63 and @xmath64 @xmath65 from the nearest end of the sampling region .",
    "consequently , the truncation induced error in @xmath58 is not more than @xmath66 .",
    "this is completely negligible when compared to statistical sampling uncertainties , which were never less than @xmath67 .",
    "the canonical crossing probability curve is used to identify a site occupation probability , @xmath68 , defined such that @xmath69 where @xmath70 , as determined by ziff and newman @xcite ( their parameter @xmath71 ) . for @xmath72 , to first order @xmath73 @xcite , and hence @xmath68 provides a reasonable estimate of the critical point @xmath1 .",
    "ziff and newman have found that the second order equation @xmath74 is a better model of the data at small @xmath26 @xcite , however the @xmath75 term is negligible for @xmath76 at the levels of precision considered here .",
    "values for @xmath77 were thus obtained from each of the prngs described above .",
    "these were subsequently compared against each other and against previous @xmath1 estimates made with the same generators . for large @xmath26",
    ", @xmath58 rises very steeply in the neighbourhood of @xmath72 .",
    "consequently , @xmath68 is relatively insensitive to the exact value of @xmath78 provided that @xmath79 .",
    "the uncertainty in @xmath78 limits the maximum attainable precision in @xmath77 to @xmath80 .",
    "combinatorial terms of the binomial distribution in equation ( [ ce ] ) were calculated by the essentially exact method of newman and ziff @xcite . for @xmath59 near @xmath1 , use of the gaussian approximation to the binomial would have introduced an error of order @xmath67 in @xmath81 , this corresponding to an error of order @xmath82 in @xmath59 itself .",
    "it is sometimes possible to dispense with the convolution altogether and make a microcanonical ensemble approximation of @xmath83 . with @xmath48 , and for @xmath59 near @xmath1",
    ", this introduces an error of around @xmath84 in @xmath58 , which corresponds to an error of around @xmath85 in @xmath59 .",
    "this approximation is acceptable at low enough precision , has the advantage that only a much narrower domain of sampling need be considered , and has been employed in earlier work by lee @xcite .",
    "however , since the induced error ( measured as the difference between @xmath59 and @xmath86 such that either @xmath87 or @xmath88 ) was found to scale as only @xmath89 , when a set of measurements are to be taken over a range of lattice sizes , to precisions of order @xmath90 , the error will become significant at large @xmath26 .",
    "the approximation was not adopted here .",
    "correlations inevitably found in the output sequence of any deterministic pseudorandom number generator will result in correlations within the spatial pattern of occupied sites upon the lattice .",
    "as noted by compagner @xcite , this in turn will bias the resulting monte carlo estimate of the crossing probability function .",
    "consequently , when estimates obtained from two different generators are inconsistent , then at least one of those generators likely suffers from significant correlations in its output sequence , hence rendering it unsuitable for use at the level of precision of the study .",
    "because the true values of @xmath47 , @xmath58 and @xmath1 are unknown , it will be unclear as to which of the generators is deficient .",
    "while there is merit in performing general tests on prngs , it is often preferable to have an application specific test such as the sensitive hull walk of ziff @xcite . here",
    "a scheme is used that changes the relation between numerical prng output sequences and the spatial patterns of occupied lattice sites , without altering the underlying problem or topology in any way .",
    "the standard enumeration of the lattice , as shown in figure [ ef ] , prescribes a specific relation between patterns in prng output and in clusters of occupied sites . by adopting some other ( nonstandard ) enumeration , as per the example in figure [ ef ] ,",
    "some different relation is obtained .",
    "an ideal random number generator will produce results independent of the chosen enumeration .",
    "a pseudorandom number generator , with correlations in its output sequence , will produce results that do depend upon the enumeration . by comparing results from a common generator on two different lattice enumerations , inadequate , outcome biasing",
    ", generators may be identified .",
    "this simple application specific test does not require knowledge of the percolation threshold or spanning probability curves .",
    "square lattice.[ef ] ]    the direct approach to implementing such an enumeration is to allocate each site a set of pointers explicitly identifying its geometrical neighbours . in the nonstandard enumeration of figure [ ef ] ,",
    "for example , @xmath91 would have pointers to @xmath92 , @xmath93 , @xmath94 and @xmath95 .",
    "sites are pseudorandomly selected as per normal and the monte carlo sampling proceeds just as for the standard enumeration . in practice",
    "this results in a dramatic performance decrease of the simulations ( more than a factor of two was found in this study ) .",
    "the problem is believed to be the cache prefetching of the high performance computer system used , where if , in some linear array , @xmath29 is being accessed then the hardware assumes that @xmath96 ( being the next contiguous data element in memory ) will be wanted next .    an alternative method is to change the mapping , @xmath34 , between scaled prng output words , @xmath97 , and site labels , @xmath98 . in the standard enumeration of figure [ ef ] , @xmath99 is the identity map . in the nonstandard enumeration ,",
    "@xmath100 , @xmath101 , @xmath102 , and so on , with the general relation being @xmath103 ( mod @xmath104 ) .",
    "this is analogous to the cluster label labels of hoshen and kopelman @xcite .",
    "the nonstandard enumeration is that effectively in use , while the standard enumeration is preserved in computer memory , thus avoiding performance problems .",
    "when the hash function , @xmath34 , is simple ( that is , of similar algebraic complexity to the prng ) , it will not so much hide correlations in the output sequence as manifest those patterns in some other way , giving rise to a different estimate for @xmath68 . if , on the ( systematic ) standard enumeration , correlations in prng output lead to spatial correlations of occupied sites that in turn bias the estimate , then , on some other ( systematic ) nonstandard enumeration , those same prng correlations will give rise to spatial correlations of a different nature that bias the estimate in some other way .",
    "this provides a simple , application specific , test for prng biasing of the monte carlo samples .",
    "if a given prng is correlation free , then the estimates derived from it will be independent of the lattice enumeration .",
    "if instead , the prng output does suffer from correlations , then different enumerations may lead to different results .",
    "the test can be tuned , with the hash chosen so as to maximise the observed shift in the test quantity . a simple hash related to the taps or period",
    "is bound to highlight intrinsic prng shortcomings @xcite .",
    "alternatively , a hash much more complex than the generator algorithm could go some way toward hiding output sequence correlation induced bias .",
    "hence define two further generators , tth and mth , as ( respectively ) the exact same tt and mt generators defined previously , but with a somewhat arbitrary non - trivial mapping @xmath105 ( mod @xmath31 ) between integers",
    "@xmath106 and site labels @xmath107 . on a lattice of @xmath48 ,",
    "this hash is equivalent to a systematic nonstandard enumeration where the rightward and downward neighbours of site @xmath29 are ( when they exist ) @xmath108 and @xmath109 respectively .",
    "the various estimates of @xmath77 thus obtained are listed in table [ rt ] .",
    "results are separated according to the generator and initialisation scheme used .",
    "swbb , for instance , indicates the swb generator with its initialisation list derived from the lcgb output sequence .",
    "similarly , xgx is the xg generator initialised from the wmx output sequence .",
    "results shown are based on surveys of order @xmath110 effectively independent samples per occupation level @xmath51 .",
    "each of these sets involved the generation of order @xmath111 to @xmath112 ( approaching @xmath3 in the xorgens case ) , pseudorandom numbers .",
    ".site percolation threshold estimates for the square lattice ( @xmath77 ) obtained by various pseudorandom number generators ( prngs ) as described in the text.[rt ] [ cols=\"<,<\",options=\"header \" , ]     assuming the suitability of the mersenne twister prng for this particular monte carlo application , and also assuming that the median-@xmath59 estimator approaches the critical point as @xmath113 , where @xmath114 , as supported by the data , then a robust estimate for the square site percolation threshold is @xmath115 . a value for @xmath116 is not required . further assuming the suitability of the subtract with borrow , xorgens and both quad - tap generators",
    ", the additional data adjusts this estimate to @xmath117 . continuing to assume the reliability of those generators ,",
    "while dropping the assumed scaling exponent and requiring only that @xmath118 , for some @xmath119 , the estimate becomes @xmath0 .",
    "these three estimates are mutually consistent to well within statistical uncertainties .",
    "the most precise of them has a standard error of @xmath120 , however a degree of caution is warranted in that none of the generators were tested to that level of precision .",
    "that being the case , this study s final estimate for the square site percolation threshold is @xmath121    this , primarily mersenne twister based , estimate is consistent with almost all previous results in table [ ct ] . in particular , it is in good agreement with the mersenne twister derived estimate of lee . taken collectively however , those results , excluding that of lee , would suggest a higher value for @xmath1 , in the vicinity of @xmath122 .",
    "although the value obtained here lies well outside of that range , the difference could be attributable to the various pseudorandom number generators used .",
    "while it is not impossible that the result obtained here may reflect some detectable influence of the chosen generators , precautions against this were taken and no evidence of bias was found .",
    "increasing availability of highly parallel computer facilities now makes it practical to obtain significant quantities of monte carlo data from large lattices .",
    "this allows for greater precision in derived statistics , but requires very good quality pseudorandom number generators as it is well established that inadequate generators lead to erroneous results .",
    "tests were performed upon several generators and it was found that use of simple two - tap generators should probably be avoided for this application .",
    "the mt19937 generator appeared to be suitable and was adopted for the majority of the monte carlo sampling conducted within this study .",
    "no dependence was found upon the ( reasonable ) choice of generator initialisation .",
    "percolation threshold estimates subsequently made from various crossing probability statistics were found to be in good mutual agreement .",
    "the most precise of these was obtained from the median-@xmath59 estimator .",
    "data quality was such that precise results could be obtained without the need to assume a particular scaling exponent .",
    "even so , results were in good agreement with a leading exponent of @xmath123 and no higher order term was found .",
    "the square site percolation threshold was subsequently determined to be @xmath0 .",
    "this estimate is consistent with the majority of earlier results on an individual basis , but not with those same results combined .",
    "evidence suggests , however , that at least some of those earlier results have been influenced by the pseudorandom number generators used .",
    "the generators used here appear to be of adequate quality , and the main generator , mt19937 , passed an application specific test of randomness .",
    "furthermore , efforts were made to ensure the reliability of the error bounds in that final estimate , which should , then , be accurate .",
    "the author would like to thank r.  m.  ziff for raising the need to address the percolation problem with different generators , for discussions of the results and for comments on the manuscript . also h.  w.  j.  blte , r.  p.  brent and p.  h.  l.  martins for providing details on their respective pseudorandom number generators , and a.  j.  e.  dale , g.  l.  evans and c.  j.  mcmurtrie for assistance with bluefern , the university of canterbury s blue gene supercomputing facility , upon which the monte carlo sampling was conducted ."
  ],
  "abstract_text": [
    "<S> a select collection of pseudorandom number generators is applied to a monte carlo study of the two dimensional square site percolation model . a generator suitable for high precision calculations </S>",
    "<S> is identified from an application specific test of randomness . </S>",
    "<S> after extended computation and analysis , an ostensibly reliable value of @xmath0 is obtained for the percolation threshold . </S>"
  ]
}