{
  "article_text": [
    "the study of extrasolar planets is one of the most exciting areas in modern astrophysics @xcite .",
    "a new and particularly important technique is direct imaging  blocking the light from a star to allow a nearby planet to be seen @xcite .",
    "this is very challenging as even the brightest extrasolar planets will be @xmath0 to @xmath1 times fainter than their parent star . to successfully image an extrasolar planet ,",
    "an instrument must be specifically designed to control light scattered by both diffraction and wavefront errors .",
    "an example of such an instrument is the gemini planet imager ( gpi ) .",
    "gpi is a new facility instrument for the gemini south observatory that is designed to directly detect and spectrally characterize young , jovian and super - jovian extrasolar planets , which are difficult to detect with other planet - finding techniques .",
    "scheduled to go on - sky in 2013 , gpi is expected to achieve deeper contrast levels than any instrument currently in operation . as such",
    ", it has very tight alignment tolerances , which are maintained via multiple open and closed loop schemes @xcite .",
    "to this end , gpi contains a large number of moveable surfaces , as well as multiple internal imaging systems in addition to the main science instrument . in order to achieve rapid , precise and repeatable internal system alignment ,",
    "we have automated the processing of this imaging data , utilizing numerous techniques commonly employed in the field of computer vision . in this paper",
    "we discuss three of these applications , and detail their implementation as it applies to gpi components .",
    "gpi s design has been extensively discussed in previous literature ( see , e.g. , @xcite ) . here , we will present a broad overview and focus only on those components and functions relevant to the applications being presented , and common to multiple next - generation , coronagraphic instruments .",
    "gpi can be described in terms of four main subsystems :    1 .",
    "the adaptive optics ( ao ) system , which corrects for atmospheric turbulence @xcite .",
    "2 .   the calibration system ( cal)a modified mach - zehnder interferometer , which is responsible for correcting for non - common path errors@xcite .",
    "the science instrument  an integral field spectrograph ( ifs ) capable of producing dispersed high - resolution spectral images that can then be reconstructed into three dimensional data cubes of two spatial and one wavelength dimensions @xcite .",
    "4 .   the diffraction control system , which creates high contrast regions in the science image .",
    "gpi s primary diffraction control is achieved with an apodized - pupil lyot coronograph ( aplc ) @xcite .",
    "the aplc design addresses several issues associated with applying classical coronagraphs to ground - based telescopes with central obscurations and allows us to remove much of the light diffracted into the halo of the telescope s point spread function ( psf ) , achieving contrasts of up to @xmath2 over the yhjk bands .",
    "the classical lyot coronagraph employs a focal plane mask ( fpm ) to block the light of the bright , on - axis , target star .",
    "some of this light is diffracted about the mask , and appears as a series of bright rings at the edge of the pupil when reimaged in the next pupil plane .",
    "a lyot stop placed in this output pupil , known as the lyot plane , shrinks the pupil and blocks this light , generating regions in the focal plane with very little on - axis light , but which retain the majority of any off - axis source . in the pupil plane , the effect of the focal plane mask is to subtract a version of the input pupil convolved and blurred by the fourier transform of the focal plane stop .",
    "this over - subtracts light outside the pupil and under - subtracts light near the edges ( see @xcite for further discussion ) .    unfortunately , this process is not perfect .",
    "although the diffracted light is concentrated at the edges of the lyot pupil , ringing from the hard - edge , focal - plane stop produces some residual light throughout the entire pupil ; reducing this requires stopping the pupil down by a very large amount , producing even more diffraction as well as significantly impacting the amount of off - axis light transmitted .",
    "the presence of a central obscuration such as a cassegrain secondary mirror , and the ` spiders ' that support it , also diffracts more light into the halo and similarly decreases the efficiency of the system , greatly lowering the achieved contrast . by introducing an apodizer into the pupil plane ,",
    "carefully matched to the dimensions of the focal plane mask , the residual diffraction can be channeled almost completely into a sharp bright ring outside the input pupil and almost completely rejected without undersizing the lyot stop ( see @xcite for discussion ) .",
    "for this to work , the star must be precisely ( @xmath3 , where @xmath4 is the wavelength and @xmath5 the telescope diameter ) centered on the focal plane mask . for comparison , in coronagraphic imaging at the keck observatory , the point spread function moves randomly on the fpm by up to 1 @xmath6 [ marois , 2012 ; personal communication ] .",
    "as the size of the psf is wavelength dependent ( scaling linearly with wavelength ) , the size of the fpm is determined by the band in which the instrument operates , and the design of the apodizer must be matched to a particular fpm . this makes the aplc chromatic , and necessitates a separate fpm and apodizer for each wavelength band in which we wish to operate .",
    "manufacturing the apodizers is also challenging ; gpi uses metal - on - glass microdot masks that have some further inherent chromaticity @xcite , requiring separate focal plane masks for each  20% bandpass .",
    "residual diffraction from obscurations such as the spiders will result in narrow bright features in the output lyot plane that must be also be blocked .",
    "this leads to tight alignment tolerances of less than 1% of the pupil diameter .",
    "these can be relaxed by oversizing the blocked area of the masks , but at a cost of sensitivity and throughput .",
    "the lyot stop can also be used to block other bright features , such as those due to non - functioning actuators in the mems , which would otherwise spread light everywhere in the focal plane .",
    "[ fig : gpi_schematic ] shows a schematic view of the light path through gpi .",
    "light entering gpi from the telescope first passes through the ao system , whose moveable components include an input fold mirror , two deformable mirrors ( dms)a piezo - electric and a mems mirror in a woofer - tweeter arrangement , and a tip - tilt stage on the woofer .",
    "these components operate in closed loop with a shack - hartmann wavefront sensor ( wfs ) .",
    "the beam is split via a dichroic with the visible light portion steered onto the wfs with a pair of pointing and centering mirrors , while the ir light passes through one of the pupil plane apodizers ( held in a filter wheel ) and into the cal system .",
    "the first focal plane in the cal system contains the filter wheel holding all of the fpms .",
    "these are reflective optics with small central holes that allow on - axis light to pass through while off - axis light is reflected . a portion or the on - axis light",
    "is sent to the low - order wavefront sensor ( lowfs)a near - ir shack - hartmann .",
    "the remaining on - axis light is spatially filtered to generate a spherical reference wavefront , interfered with a portion of the off - axis light , and imaged onto an ir detector .",
    "this creates a high - order wavefront sensor ( howfs ) , sensitive to all spatial frequencies not blocked by the fpm .",
    "reconstructed lowfs and howfs wavefronts are applied as reference centroid offsets to the main ao loop at 1 hz , correcting for non - common path errors and maintaining a stable wavefront .",
    "the howfs detector can also be used as a pupil viewer by only imaging light from one leg of the interferometer .    a second set of pointing and centering mirrors then centers the beam on the ifs pupil , which contains a third filter wheel with the lyot stops .",
    "in addition to the lyot stop prescribed by the aplc design , extra stops are included with oversized central obscurations and spiders to simplify alignment in cases where some throughput can be sacrificed , and to ensure that a dark hole can be created even if diffraction about the telescope spiders is more significant than expected .",
    "any light diffracted in this plane will be spread throughout the science image , significantly decreasing achieved contrast , so it is important to ensure that all light can be blocked in any circumstances .",
    "the stops also contain tabs attached to the spiders used to block light from bad actuators in the mems dm .",
    "the ifs also includes a deployable pupil viewing camera that can be used for imaging the ifs entrance pupil , just as the howfs detector can be used to image the cal pupil , and the ao wfs can be used to track the telescope pupil .",
    "it should be noted that the ifs pupil viewer is not a science - grade instrument , does not have an absolute photometric calibration , and suffers from gain drifts and high noise .",
    "these three imaging systems , along with the science instrument itself , provide all of the information required to align the system .    fig .",
    "[ fig : pupil_schematic ] shows a schematic view of the image at the ifs pupil , demonstrating that each of the aplc components , along with the telescope pupil , must be closely aligned for the system to function .",
    "the mems dm plane is typically used as a common reference , with each of the components aligned to this plane independently of the others .",
    "table [ tbl : tolerances ] contains the alignment tolerances of the various components , calculated based on the aplc design , and numerical modeling of the system with a target contrast of @xmath2 .",
    "alignment of all of the optics up to the apodizer is done with data from the ao wfs .",
    "the sensor measures tip and tilt , providing pointing information for the tip / tilt and ao pointing and centering mirrors .",
    "to center the telescope pupil , the wavefront sensor intensities are autocorrelated to find any asymmetries , which are then removed by actuating the input fold mirror .",
    "the ao wfs is aligned to the mems plane by putting a known shape ( a pattern of ` poked ' actuators ) on the dm , and then cross - correlating the input shape with the measured ao wfs phase @xcite .",
    "the measured offsets are corrected with the ao pointing and centering mirrors .",
    "mis - alignment of both the apodizer and lyot stop from the mems plane can be measured in imaging data from the pupil - viewer or howfs detector . as phases on the dms map to intensities in the lyot plane",
    ", it is relatively simple to identify individual mems pokes , especially when the pupil viewer is slightly defocused .",
    "locating the apodizer and lyot stop , however , requires us to automatically identify features on the masks .",
    "section [ sec : ellipse_finding ] details the application of the generalized hough transform for identifying mask contours , while  [ sec : multiline_finding ] describes a clustering technique that is useful in separating pixels belonging to different features of interest ( such as the lyot mask spiders ) .",
    "finally , while gpi is specifically designed to block the light from the target star so that light from the ( much dimmer ) planets can be observed , it is still important to be able to locate the target precisely in the final science images . to accomplish this",
    ", a grid is printed on the apodizer mask , producing four satellite spots at equal distances from the true image center in the focal plane @xcite .",
    "this distance scales with wavelength , and the specific location of the spots can change with instrument alignment . furthermore , the specific location of the spots and their magnitudes are an important diagnostic tool , so it is very useful to have an automated method for finding them , using as few prior assumptions as to their location as possible .",
    "section [ sec : satfinding ] describes a search algorithm that accomplishes this and is generally applicable for efficient location of vertices of regular geometric shapes .",
    "this same technique is also be applied to finding mems pokes in pupil viewer images .",
    "many components of gpi , including the apodizers , the lyot stop and the telescope pupil itself , form circular shapes when imaged at a pupil plane . as various misalignment , projection , and focus effects can cause these circular shapes to become slightly deformed , we wish to generalize the automated location of these shapes as fitting ellipses to the data and do so by applying a hough transform .",
    "the hough transform is a standard tool in computer vision for detecting both analytical curves and arbitrary shapes and is widely used in various image processing applications @xcite .",
    "recent work on the hough transform applied specifically to ellipses has yielded a highly memory - efficient algorithm @xcite .",
    "the hough transform seeks to find a parameter set that maximizes the fit of a set of pixels to a specific class of shapes . for an arbitrary analytic curve of the form @xmath7 , where @xmath8 is the image ( pixel ) location and @xmath9 is an arbitrarily sized vector of parameters , this is equivalent to solving the constraint equation : @xmath10 the algorithm involves the formation of an accumulator array , @xmath11 . for each pixel @xmath8 , all parameter vectors satisfying definition of the curve and eq .",
    "( [ eq : gradient ] ) are found and the corresponding locations in the accumulator array are incremented . at the end of this process , local maxima in @xmath12 will correspond to curves of @xmath13 in the original image .",
    "@xcite    following the formalism of @xcite , an ellipse may be defined via four parameters : @xmath14 where @xmath15 is the ellipse center and @xmath16 are the semi - major and semi - minor axes , respectively .",
    "a fifth parameter , @xmath17 , representing the rotation of the ellipse axes with respect to the image axes is added to fully generalize the description .",
    "thus , if we assume that an arbitrary pair of pixels , @xmath18 and @xmath19 , form the endpoints of the ellipse major axis , the five parameters are given by : @xmath20 given any other point @xmath21 on the ellipse , and defining : @xmath22 the semi - minor axis is approximated as : @xmath23}{a^4 -   ( a^2 + d^2 - f^2)^2 } } \\,.\\ ] ] this allows us to define the accumulator array only for the semi - minor axis",
    ". the maxima of the accumulator array will represent candidate ellipse semi - minor axes ( along with the parameters used to calculate them ) .",
    "the overall maximum can then be taken as the most likely ellipse , or all candidates whose accumulator values exceed a pre - defined threshold can be retained .    for gpi ,",
    "this algorithm is applied to pupil viewer images in order to align the apodizers and lyot masks to the mems plane .",
    "the pupil viewer produces 320x240 pixel images , capturing the ifs entrance pupil in a square approximately 232 pixels in height .",
    "these require some pre - processing before the main algorithm is applied . starting with a dark subtracted image , a @xmath24 pixel median filter",
    "is applied to remove isolated hot and cold pixels and smooth the image .",
    "next , in order to decrease the processing time for the hough transform , a set of candidate pixels is identified by finding pixel locations where the difference between values of neighboring pixels is greater than a threshold set by the image median value .",
    "that is , for an image represented by and @xmath25 matrix @xmath26 , the set of candidate pixels is defined as : @xmath27 \\times [ 1,n ]   \\,,\\ ] ] where @xmath28 is the threshold , set to a multiple of the image median .",
    "the hough transform is then applied to only these candidate pixels , and the global maximum of the accumulator array is retained as the best - fit solution .",
    "[ fig : pupil_hough ] illustrates these steps on a sample data set imaging one of gpi s apodizers .",
    "note that it is not necessary for the candidate set to include all of the pixels belonging to the best - fit ellipse , or even an entire closed curve .",
    "the algorithm works when as few as 50% of the pixels belonging to the feature of interest are identified .",
    "once the center of the apodizer ( or lyot mask ) is found , it is necessary to also find the center of the dm .",
    "to do so , we apply a symmetric shape to the dm in the form of four ` poked ' actuators , producing four symmetric bright spots in the pupil plane .",
    "the points are located using a difference image between the poked and unpoked images and by cross - correlating with a template , or by applying the algorithm described in  [ sec : satfinding ] .",
    "the intersection of these four points is compared to the center of the best - fit ellipse and the difference is used to adjust the beam pointing and align the apodizer and lyot stop planes to the mems dm plane , as illustrated in fig .",
    "[ fig : pupalign ] .    the computation required by the hough transform is relatively minimal , with all processing performed on a single , conventional cpu .",
    "the execution time of these alignments is dominated by the camera integration and readout times and communication overhead associated with sending mirror commands to the mems dm .",
    "this algorithm is also more robust than more conventional ` center of gravity ' image localization techniques , which are much more sensitive to image noise , illumination variations and flat - field errors , and whose results are highly dependent on which pixels are included in the processing . at the same time",
    ", illumination changes in the system and bias drifts in the pupil viewing camera make it difficult to generate a stable template to use for matched filtering or other correlation techniques , whereas the hough transform approach will work as long as there is a measurable intensity difference between the central obscuration and the illuminated portion of the pupil .",
    "an alternative approach to the pupil plane alignment algorithm described in  [ sec : ellipse_finding ] is to use the howfs rather than the pupil viewer .",
    "this has the benefit of a faster readout time , and can be used at the same time as the science instrument , without having to deploy the pupil viewer .",
    "unfortunately , the howfs is lower resolution than the pupil viewer , capturing the masks in only about @xmath29 pixel squares , and individual poked actuators are not as easy to locate as in the pupil images , especially at lower light levels .",
    "the solutions found from poke images on the howfs are therefore not as precise as those from the pupil viewer data . to address this",
    ", we instead can use whole rows and columns of mems actuators to create a cross pattern on the howfs .",
    "the pixels belonging to this shape are much brighter than everything else in the image ( after hot pixels have been removed ) and are therefore simple to extract .",
    "the question then becomes , however , how to automatically group the resulting pixels into four separate line segments .    to accomplish this , we use @xmath30-mean clustering  a commonly applied algorithm in computer vision used to partition a set of @xmath31 observations into @xmath30 topographically distinct clusters .",
    "@xcite given a set of vectors @xmath32 ( in this case , the vectors are 2d pixel locations ) , this algorithm seeks to find the subsets @xmath33 such that : @xmath34 where @xmath35 is the mean of set @xmath36 .",
    "this is achieved iteratively : an initial set of @xmath30 means , @xmath37 , is randomly generated .",
    "the subsets are then assigned as : @xmath38 and the cluster means are subsequently updated based on the new sets : @xmath39 where @xmath40 is the current size of set @xmath36 .",
    "these two steps are repeated until no further changes occur in the subset assignments .    as we have only four clusters in our application , and we can intelligently choose initial means by placing them in the center of the four quadrants of the howfs image , we can typically achieve convergence in only 2 to 3 iterations .",
    "once the four line segments have been identified , we fit lines to each one , and find the intersection point as before .",
    "this procedure is illustrated in fig .",
    "[ fig : howfs_ims ] . note that in this case , we can find misalignment by looking at the relative lengths of the legs , as well as the relative centers of the legs ( given by the intersection of linear fits to the leg pixels ) and the apodizer center . because the apodizer blocks light in the center of the image , and we expect the poke pattern to be symmetric , differences in leg lengths indicate that the apodizer is off - center .",
    "the same approach is also highly useful for tracking misalignment and rotations of the lyot stop with the pupil viewer . in this case , the lines being fit are nt bright regions generated by shapes put on the mems dm , but rather , dark areas generated by the features of the lyot stop itself to block the telescope spiders .",
    "[ fig : lyot_spiders ] illustrates the clustering procedure as applied in this case . once the pixels belonging to the four lyot stop sections are clustered , it is trivial to find linear fits to the data by way of principal component analysis ( pca ) .",
    "we have to use pca rather than simple least - squares because we are fitting a 2d data set and must minimize errors in both directions , rather than just one direction as in a univariate least - squares fit . as we are only interested in the line best fitting each set of pixels , we just need to find the eigenvector of the data covariance corresponding to the major eigenvalue . for each set",
    ", we package the pixel coordinates into vectors @xmath8 and @xmath41 and form the augmented matrix : @xmath42 where @xmath43 and @xmath44 are the sample means of @xmath8 and @xmath41 , respectively , and @xmath45 has dimensionality @xmath46 for an @xmath47 pixel set .",
    "the covariance of @xmath45 is thus given by : @xmath48 where @xmath49 represents the transpose operator , and @xmath50 can be decomposed as : @xmath51 where the columns of @xmath52 are the eigenvectors of @xmath50 and @xmath53 is the diagonal matrix of the corresponding eigenvalues .",
    "assuming that @xmath53 is ordered in decreasing magnitude , the first column of @xmath52 is the major mode of the data and represents the best linear fit to the set .",
    "this method is both computationally efficient and find the minimum distance fit in both dimensions , so it is not biased by varying numbers of pixels at different locations in the set in either dimension , as seen in fig .",
    "[ fig : lyot_spiders ] .",
    "this procedure , along with the one described in ",
    "[ sec : ellipse_finding ] , allows us to find position and rotation information to better than one tenth of one detector pixel in multiple pupil planes ( as measured by the variance of successive fits ) , allowing us to meet our alignment requirements .",
    "furthermore , they require minimal image pre - processing ( typically just a median filter and binary value conversion ) and are widely applicable to any alignment task that involves imaging of regular features .",
    "as previously discussed , the grids printed on the apodizers generate satellite spots in the focal plane images .",
    "these spots shift with pointing and centering changes , and the distance between spots scales with wavelength , but they should always form a perfect square pattern in the final image .",
    "this property allows us to construct and algorithm that efficiently finds these spots without making any prior assumptions as to their location or separation , or requiring any additional knowledge other than the image contents . to begin",
    ", we note that given four points @xmath54 , we can define the set of six distance between them as : @xmath55 where @xmath56 is the set of two element tuples representing all of the combinations of four elements taken two at a time , without repetition .",
    "assuming the set is ordered by increasing magnitude , the four points define a square if and only if the first four distances are equal , the last two distances are equal , and the ratio of the magnitudes of the two subsets of distances is @xmath57 .",
    "of course , if we were to consider every pixel in an image , every single one of them would be a member of at least one such set .",
    "instead , we prioritize pixels by their magnitude , making the assumption that the satellite spots are relatively bright compared with the rest of the image ( although not necessarily the brightest things in the image ) .",
    "we construct a list of the brightest points in the image iteratively , identifying the current brightest point in the image , and then removing it , along with a radius of @xmath58 pixels about it , from the search region ( the value of @xmath58 is determined by the average size of a satellite spot in all possible wavelengths ) .",
    "these bright images are stored in the expanding set @xmath59 , where each vector is the 2d pixel coordinate of each bright spot .",
    "our task then becomes akin to a breadth - first search , where each node is itself a subtree whose branches represent all of the combinations of the root node with three other elements of @xmath60 .",
    "the value of all terminal nodes is binary  either the path to the node matches the condition on the distance set in eq .",
    "( [ eq : cond4 ] ) , or it does not .",
    "the search is terminated as soon as the condition is met .    given this framework ,",
    "it is clear that the cost of expanding each level of the tree grows with the depth ",
    "each additional point to consider increases the size of @xmath61 by a factor of @xmath62 .",
    "thus the search strategy described above is the lowest cost one , and preferable to first collecting all of the candidate points and then performing a depth - first search .",
    "however , the algorithm is by no means optimal , as it will repeatedly deepen paths which can not represent the vertices of a square .",
    "we must therefore introduce pruning and some heuristic function to guide it .",
    "@xcite we do so by noting that for any subset of three of the four vertices , the corresponding subset of of distances : @xmath63 must contain two elements that are equal , and one element that is @xmath57 times larger .",
    "this is a necessary , but not sufficient , condition for defining a square .",
    "this condition allows us to prune whole branches of the tree , and greatly improve the search efficiency .",
    "note that this is the smallest subtree that can be tested , as any two points can form an edge of a square .",
    "operationally , the search is implemented as follows : the set @xmath59 is constructed iteratively as described above . once we have identified three bright spots , we begin maintaining a list of candidate groups that meet the condition on the distance set in eq .",
    "( [ eq : cond3 ] ) .",
    "these are stored in the subset @xmath64 where @xmath65 is the set of all candidate indices , of length @xmath66 . for each new spot after the first three , we construct the set of 3-element tuples , @xmath67 representing the combinations of elements of the candidate set taken three at a time . each of these tuples is augmented with the index of the newest point @xmath47 to create the set of 4-element tuple , @xmath68 , where @xmath69 for each of these , we then construct the set of distances : @xmath70 and test whether it meets the condition for defining a square .",
    "if the condition is not met , the candidate subset is updated in a similar fashion ",
    "testing the combinations of @xmath71 augmented with @xmath47 with the condition on the distance set in eq .",
    "( [ eq : cond3 ] ) . the next brightest point is then identified , and the next iteration started .",
    "[ fig : satfinding1 ] illustrates the application of this algorithm to one slice of a gpi ifs image .",
    "the satellite spots in this case are quite bright , but dimmer than much of the core of the image , and there is much bright speckle noise throughout the image . the image is first convolved with a 2 dimensional gaussian to remove hot and cold pixels and smooth out the image ( essentially acting as a matched filter for the satellite spots ) .",
    "the resultant image then has the algorithm applied to it .",
    "the satellite spots are sequentially added as the fourth through seventh elements of the candidate spot set . however , as all of the first three spots are clustered close together in the center of the image and do not form a right triangle , they do not meet the distance criteria associated with eq .",
    "( [ eq : cond3 ] ) and are therefore not included in any tested combinations .",
    "once the candidate set has been found , each aperture surrounding the candidate locations is again run through a matched filter to find the exact sub - pixel location of the satellite spots centers .",
    "the algorithm works equally well in cases where the satellite spots are significantly dimmer , as demonstrated in fig .",
    "[ fig : satfinding2 ] . in this case , the final satellite spot was only added to the candidate list on the 38th iteration , meaning that there were 73815 possible combinations of four spots , or 7770 possible combinations of three spots from the previous iteration .",
    "however , only 28 subsets ( 0.36% ) had been identified as possible candidates for testing , so that the entire execution time was only 1.45 times longer than in the case shown in fig .",
    "[ fig : satfinding1 ] .",
    "as coronagraphic systems reach higher contrasts they will become more and more sensitive to small environmental effects such as thermal variations and flexure , and will have progressively tighter tolerances on internal alignments .",
    "this will require ever more components to become motorized ( as continually realigning by hand will take too much time ) , which will allow for automation of all repeated alignment tasks . here",
    ", we have demonstrated the utility of applying relatively simple computer vision techniques to perform just such tasks , using both the engineering and science image data generated by the gemini planet imager .",
    "the routines described in this paper are currently in regular use as part of gpi integration and testing , and will continue to be employed as part of gpi s daytime calibrations when it goes on sky .",
    "the motor settings generated in these calibrations will be used as set points for the various mechanical components , and will be updated by thermal models , which themselves have been verified via the same alignment tests .",
    "these algorithms are all easy to implement and adapt to specific systems , and can greatly simplify any task requiring the repeated discovery of semi - regular features . as such tasks are quite common in astronomical imaging and instrumentation , there is a great potential for future applications of these methods , as well as multiple others commonly employed in computer vision . in particular , the satellite spot finding algorithm described in  [ sec : satfinding ] is generally applicable to any problem in which one must find the vertices of regular geometric figures ( i.e. , any regular grid ) in noisy image data .",
    "in fact , the implementation written for finding the satellite spots was applied , unchanged , to the regular shape made by poking mems actuators ( as in fig .",
    "[ fig : pupalign ] ) and automatically detected the generated spots in all instances .",
    "we fully expect that algorithms such as these will play an ever greater role in regular operations of future astronomical instrumentation and will be increasingly applied to automated data processing .",
    "the authors would like to thank the entire gpi collaboration , and especially the gpi integration and testing team for their support and dedication .",
    "portions of this work were performed under the auspices of the u.s .",
    "department of energy by lawrence livermore national laboratory under contract de - ac52 - 07na27344 .",
    "this paper is number llnl - jrnl-599792 .",
    "10    s.  seager , _ exoplanets _ ( university of arizona press , 2011 ) .    c.  marois , b.  macintosh , t.  barman , b.  zuckerman , i.  song , j.  patience , d.  lafreniere , and r.  doyon , `` direct imaging of multiple planets orbiting the star hr 8799 , '' science * 322 * , 1348 ( 2008 )",
    ".    b.  a. macintosh , j.  r. graham , d.  w. palmer , r.  doyon , j.  dunn , d.  t. gavel , j.  larkin , b.  oppenheimer , l.  saddlemyer , a.  sivaramakrishnan _ et  al .",
    "_ , `` the gemini planet imager : from science to design to construction , '' in `` proc .",
    "spie , '' , vol .",
    "7015 ( 2008 ) , vol .",
    "7015 , p. 701518 .",
    "b.  a. macintosh , a.  anthony , j.  atwood , n.  barriga , b.  bauman , k.  caputa , j.  chilcote , d.  dillon , r.  doyon , j.  dunn _ et  al . _ , `` the gemini planet imager : integration and status , '' in `` proc .",
    "spie , '' , vol .",
    "8446 ( 2012 ) , vol .",
    "8446 , p. 84461u .",
    "l.  a. poyneer and b.  macintosh , `` spatially filtered wave - front sensor for high - order adaptive optics , '' josa a * 21 * , 810819 ( 2004 ) .",
    "j.  k. wallace , j.  angione , r.  bartos , p.  best , r.  burruss , f.  fregoso , b.  m. levine , b.  nemati , m.  shao , and c.  shelton , `` post - coronagraph wavefront sensor for gemini planet imager , '' in `` proceedings of the spie , '' , vol .",
    "7015 ( 2008 ) , vol .",
    "7015 , p. 70156n .",
    "j.  maire , m.  perrin , r.  doyon , e.  artigau , j.  dunn , d.  gavel , j.  graham , d.  lafrenire , j.  larkin , j.  lavigne _ et  al .",
    "_ , `` data reduction pipeline for the gemini planet imager , '' in `` proceedings of the spie , '' , vol .",
    "7735 ( 2010 ) , vol .",
    "7735 , p. 773531 .",
    "r.  soummer , `` apodized pupil lyot coronagraphs for arbitrary telescope apertures , '' the astrophysical journal letters * 618 * , 161164 ( 2005 ) .    a.  sivaramakrishnan , j.  lloyd , p.  hodge , and b.  macintosh , `` speckle decorrelation and dynamic range in speckle noise - limited imaging , '' the astrophysical journal letters * 581 * , l59 ( 2006 ) .",
    "a.  sivaramakrishnan and b.  oppenheimer , `` astrometry and photometry with coronagraphs , '' the astrophysical journal * 647 * , 620 ( 2008 ) .",
    "h.  stone , m.  orchard , e.  chang , and s.  martucci , `` a fast direct fourier - based algorithm for subpixel registration of images , '' geoscience and remote sensing , ieee transactions on * 39 * , 22352243 ( 2001 ) .    c.  marois , d.  lafrenire , b.  macintosh , and r.  doyon , `` accurate astrometry and photometry of saturated and coronagraphic point spread functions , '' the astrophysical journal * 647 * , 612 ( 2006 ) .",
    "d.  h. ballard , `` generalizing the hough transform to detect arbitrary shapes , '' pattern recognition * 13 * , 111122 ( 1981 ) .",
    "y.  xie and q.  ji , `` a new efficient ellipse detection method , '' in `` pattern recognition , 2002 .",
    "16th international conference on , '' , vol .  2 ( ieee , 2002 ) , vol .  2 , pp . 957960 .",
    "j.  macqueen , `` some methods for classification and analysis of multivariate observations , '' in `` proceedings of the fifth berkeley symposium on mathematical statistics and probability , '' , vol .  1 ( california , usa , 1967 ) , vol .  1 ,",
    "p.  14 .",
    "s.  russell , `` efficient memory - bounded search methods , '' in `` proceedings of the 10th european conference on artificial intelligence , '' ( john wiley & sons , inc . , 1992 ) , pp .",
    ".[tbl : tolerances ] gpi alignment tolerances [ cols=\"^,<,^,^\",options=\"header \" , ]     @xmath72tolerances are given in percentages of the corresponding pupil size .",
    "+ @xmath73 achieved values are rss errors in tip and tilt on the wfs and errors in x and y on the pupil viewer .",
    "+ @xmath74 measurements in the ao wfs are in fractions of sub - apertures , with 43 sub - apertures across the pupil .",
    "+ @xmath75 the pupil is approximately 232 pupil viewer pixels across .",
    "[ fig : gpi_schematic ] schematic of gpi . circles represent pupil planes , pentagons represent focal planes , and squares are wavefront sensors and detectors .",
    "thick lines represent controllable surfaces such as moveable mirrors and stages , lines with arrows represent the light path , and dashed lines represent imaging of pupil planes by various detectors for alignment purposes . note",
    "that this is a schematic view only : multiple optics , including beam splitters and pupil re - imagers , are not shown here .",
    "the four pupil planes at the top of the schematic must all be aligned to a common plane , with tolerances given in table [ tbl : tolerances ] .",
    "[ fig : pupil_schematic ] schematic of image seen at the gpi ifs pupil .",
    "the black regions represent the lyot stop , the gray regions are light that passes through the lyot stop , and the white regions are light from the telescope pupil spiders and the bright rings diffracted from the focal plane mask , which is stopped by the lyot stop .",
    "this illumination pattern would be approximately what we would see if we could image the reverse side of the lyot stop .",
    "an actual image of the ifs pupil , with only the lyot stop in the beam path , is shown in fig .",
    "[ fig : lyot_spiders ] .",
    "the apodizer , fpm and lyot stop must all be closely aligned for the coronagraph to work properly .",
    "[ fig : pupil_hough ] pupil viewer images of the apodizer only ( no fpm or lyot stop in light path ) .",
    "_ left _ : dark subtracted pupil viewer image , cropped to show the image of the apodizer only .",
    "_ center _ : median filtered image with the candidate pixels for the inner annulus of the apodizer overlaid .",
    "pixels are selected as candidates when they differ from their neighbors by more than 25% of the image median in intensity .",
    "a mask is applied so that pixels belonging to the outer annulus are not considered .",
    "_ right _ : original image with best solution from hough transform overlaid .",
    "[ fig : pupalign ] _ left _ : difference image between poked and flat dm states .",
    "_ right _ : original image with best solution from hough transform and intersection of mems pokes overlaid .",
    "[ fig : howfs_ims ] howfs images of apodizer only ( no fpm in light path ) .",
    "_ left _ : median filtered howfs image , cropped to show the image of the apodizer only .",
    "_ center _ : difference image between cross and flat dm shapes .",
    "_ right _ : the four clusters of pixels automatically detected .",
    "[ fig : lyot_spiders ] pupil viewer images of lyot stop . _ left _ : dark subtracted pupil viewer image , cropped to show lyot stop only .",
    "_ center _ : the original image , median filtered and converted to binary units using the median image value .",
    "the central obscuration of the stop is removed by using the algorithm from  [ sec : ellipse_finding ] .",
    "the remaining features are the stop spiders and tabs used to block bad dm actuators .",
    "the latter are removed by applying a single annulus scaled from the fit to the central obscuration .",
    "_ right _ : the four clusters of pixels belonging to the four spiders automatically detected and with best fit lines .",
    "[ fig : satfinding1 ] _ left _ : single slice of reconstructed gpi ifs data cube .",
    "the satellite spots are circled .",
    "_ center _ : penultimate step of satellite spot finding algorithm .",
    "although six spots have been identified as candidate spots , only three of them have the right geometry to be part of a square , and so the candidate subset only has one element , illustrated by the white triangle .",
    "_ right _ : the original image with the located satellite spots tagged with black dots .",
    "[ fig : satfinding2 ] results of satellite finding , arranged as in fig .",
    "[ fig : satfinding1 ] . in this case , 38 candidate spots were identified before the satellite spots were found , but only 28 candidate subsets required testing at the final step of the iteration .",
    "+     schematic of gpi .",
    "circles represent pupil planes , pentagons represent focal planes , and squares are wavefront sensors and detectors .",
    "thick lines represent controllable surfaces such as moveable mirrors and stages , lines with arrows represent the light path , and dashed lines represent imaging of pupil planes by various detectors for alignment purposes . note",
    "that this is a schematic view only : multiple optics , including beam splitters and pupil re - imagers , are not shown here .",
    "the four pupil planes at the top of the schematic must all be aligned to a common plane , with tolerances given in table [ tbl : tolerances].,scaledwidth=95.0% ]     schematic of image seen at the gpi ifs pupil .",
    "the black regions represent the lyot stop , the gray regions are light that passes through the lyot stop , and the white regions are light from the telescope pupil spiders and the bright rings diffracted from the focal plane mask , which is stopped by the lyot stop .",
    "this illumination pattern would be approximately what we would see if we could image the reverse side of the lyot stop .",
    "an actual image of the ifs pupil , with only the lyot stop in the beam path , is shown in fig .",
    "[ fig : lyot_spiders ] .",
    "the apodizer , fpm and lyot stop must all be closely aligned for the coronagraph to work properly .",
    ", scaledwidth=50.0% ]     pupil viewer images of the apodizer only ( no fpm or lyot stop in light path ) .",
    "_ left _ : dark subtracted pupil viewer image , cropped to show the image of the apodizer only .",
    "_ center _ : median filtered image with the candidate pixels for the inner annulus of the apodizer overlaid .",
    "pixels are selected as candidates when they differ from their neighbors by more than 25% of the image median in intensity .",
    "a mask is applied so that pixels belonging to the outer annulus are not considered .",
    "_ right _ : original image with best solution from hough transform overlaid .",
    ", title=\"fig:\",scaledwidth=33.0% ]   pupil viewer images of the apodizer only ( no fpm or lyot stop in light path ) .",
    "_ left _ : dark subtracted pupil viewer image , cropped to show the image of the apodizer only .",
    "_ center _ : median filtered image with the candidate pixels for the inner annulus of the apodizer overlaid .",
    "pixels are selected as candidates when they differ from their neighbors by more than 25% of the image median in intensity .",
    "a mask is applied so that pixels belonging to the outer annulus are not considered .",
    "_ right _ : original image with best solution from hough transform overlaid .",
    ", title=\"fig:\",scaledwidth=33.0% ]   pupil viewer images of the apodizer only ( no fpm or lyot stop in light path ) .",
    "_ left _ : dark subtracted pupil viewer image , cropped to show the image of the apodizer only .",
    "_ center _ : median filtered image with the candidate pixels for the inner annulus of the apodizer overlaid .",
    "pixels are selected as candidates when they differ from their neighbors by more than 25% of the image median in intensity .",
    "a mask is applied so that pixels belonging to the outer annulus are not considered .",
    "_ right _ : original image with best solution from hough transform overlaid . , title=\"fig:\",scaledwidth=33.0% ]     _ left _ : difference image between poked and flat dm states .",
    "_ right _ : original image with best solution from hough transform and intersection of mems pokes overlaid .",
    ", title=\"fig:\",scaledwidth=33.0% ]   _ left _ : difference image between poked and flat dm states .",
    "_ right _ : original image with best solution from hough transform and intersection of mems pokes overlaid .",
    ", title=\"fig:\",scaledwidth=33.0% ]     howfs images of apodizer only ( no fpm in light path ) .",
    "_ left _ : median filtered howfs image , cropped to show the image of the apodizer only .",
    "_ center _ : difference image between cross and flat dm shapes .",
    "_ right _ : the four clusters of pixels automatically detected . ,",
    "title=\"fig:\",scaledwidth=33.0% ]   howfs images of apodizer only ( no fpm in light path ) .",
    "_ left _ : median filtered howfs image , cropped to show the image of the apodizer only .",
    "_ center _ : difference image between cross and flat dm shapes .",
    "_ right _ : the four clusters of pixels automatically detected . , title=\"fig:\",scaledwidth=33.0% ]     pupil viewer images of lyot stop .",
    "_ left _ : dark subtracted pupil viewer image , cropped to show lyot stop only .",
    "_ center _ : the original image , median filtered and converted to binary units using the median image value .",
    "the central obscuration of the stop is removed by using the algorithm from  [ sec : ellipse_finding ] .",
    "the remaining features are the stop spiders and tabs used to block bad dm actuators .",
    "the tabs at the edge of the pupil are removed by applying a single annulus scaled from the fit to the central obscuration .",
    "_ right _ : the four clusters of pixels belonging to the four spiders automatically detected and with best fit lines.,title=\"fig:\",scaledwidth=32.0% ]   pupil viewer images of lyot stop .",
    "_ left _ : dark subtracted pupil viewer image , cropped to show lyot stop only .",
    "_ center _ : the original image , median filtered and converted to binary units using the median image value .",
    "the central obscuration of the stop is removed by using the algorithm from  [ sec : ellipse_finding ] .",
    "the remaining features are the stop spiders and tabs used to block bad dm actuators .",
    "the tabs at the edge of the pupil are removed by applying a single annulus scaled from the fit to the central obscuration .",
    "_ right _ : the four clusters of pixels belonging to the four spiders automatically detected and with best fit lines.,title=\"fig:\",scaledwidth=32.0% ]     _ left _ : single slice of reconstructed gpi ifs data cube .",
    "the satellite spots are circled .",
    "_ center _ : penultimate step of satellite spot finding algorithm .",
    "although six spots have been identified as candidate spots , only three of them have the right geometry to be part of a square , and so the candidate subset only has one element , illustrated by the white triangle .",
    "_ right _ : the original image with the located satellite spots tagged with black dots .",
    ", title=\"fig:\",scaledwidth=33.0% ]   _ left _ : single slice of reconstructed gpi ifs data cube .",
    "the satellite spots are circled .",
    "_ center _ : penultimate step of satellite spot finding algorithm .",
    "although six spots have been identified as candidate spots , only three of them have the right geometry to be part of a square , and so the candidate subset only has one element , illustrated by the white triangle .",
    "_ right _ : the original image with the located satellite spots tagged with black dots .",
    ", title=\"fig:\",scaledwidth=33.0% ]   _ left _ : single slice of reconstructed gpi ifs data cube .",
    "the satellite spots are circled .",
    "_ center _ : penultimate step of satellite spot finding algorithm .",
    "although six spots have been identified as candidate spots , only three of them have the right geometry to be part of a square , and so the candidate subset only has one element , illustrated by the white triangle .",
    "_ right _ : the original image with the located satellite spots tagged with black dots .",
    ", title=\"fig:\",scaledwidth=33.0% ]     results of satellite finding , arranged as in fig .",
    "[ fig : satfinding1 ] . in this case , 38 candidate spots were identified before the satellite spots were found , but only 28 candidate subsets required testing at the final step of the iteration .",
    "the satellite spots were approximately 50 times fainter than in the previous example , and the contrast in this image was one order of magnitude lower.,title=\"fig:\",scaledwidth=33.0% ]   results of satellite finding , arranged as in fig .",
    "[ fig : satfinding1 ] . in this case , 38 candidate spots were identified before the satellite spots were found , but only 28 candidate subsets required testing at the final step of the iteration .",
    "the satellite spots were approximately 50 times fainter than in the previous example , and the contrast in this image was one order of magnitude lower.,title=\"fig:\",scaledwidth=33.0% ]   results of satellite finding , arranged as in fig .",
    "[ fig : satfinding1 ] . in this case , 38 candidate spots were identified before the satellite spots were found , but only 28 candidate subsets required testing at the final step of the iteration .",
    "the satellite spots were approximately 50 times fainter than in the previous example , and the contrast in this image was one order of magnitude lower.,title=\"fig:\",scaledwidth=33.0% ]"
  ],
  "abstract_text": [
    "<S> modern coronagraphic systems require very precise alignment between optical components and can benefit greatly from automated image processing . </S>",
    "<S> we discuss three techniques commonly employed in the fields of computer vision and image analysis as applied to the gemini planet imager , a new facility instrument for the gemini south observatory . </S>",
    "<S> we describe how feature extraction and clustering methods can be used to aid in automated system alignment tasks , and also present a search algorithm for finding regular features in science images used for calibration and data processing . along with discussions of each technique </S>",
    "<S> , we present our specific implementation and show results of each one in operation . </S>"
  ]
}