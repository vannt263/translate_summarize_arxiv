{
  "article_text": [
    "modern scientific experiments often require considering a large number of hypotheses simultaneously ( @xcite , @xcite ) and has led to extensive interest in controlling for multiple testing ( henceforth , just termed controlling for multiplicity ) .",
    "many multiplicity control methods have been proposed in the frequentist literature , such as the bonferroni procedure which controls the family - wise error rates , and various versions of false discovery rates ( cf.@xmath0@xcite @xmath0 and @xcite ) which control for the fraction of false discoveries to stated discoveries .",
    "the asymptotic behavior of false discovery rate has been studied in @xcite .",
    "the bayesian approach to controlling for multiplicity operates through the prior probabilities assigned to hypotheses .",
    "for instance , in the scenario that is considered herein of testing mutually exclusive hypotheses ( only one of @xmath1 considered hypotheses can be true ) , one can simply assign each hypothesis prior probability equal to @xmath2 and carry out the bayesian analysis ; this automatically controls for multiplicity . that multiplicity is controlled through prior probabilities of hypotheses or models is extensively discussed in @xcite , @xcite , @xcite for a two - groups model , variable - selection in linear models , and subset analysis , respectively .",
    "one of the appeals of the bayesian approach to multiplicity control is that it does not depend on the dependence structure of the test statistics ; the bayes procedure will automatically adapt to the dependence structure through bayes theorem , but the prior probability assignment that is controlling for multiplicity is unaffected by dependence .",
    "in contrast , frequentist approaches to multiplicity control are usually highly affected by test statistic dependence .",
    "for instance , the bonferroni correction is fine if the test statistics for the hypotheses being tested are independent , but can be much too conservative ( losing detection power ) , if the test statistics are dependent .    an interesting possibility for frequentist multiplicity control in dependence situations is thus to develop the procedure in a bayesian fashion and verify that the procedure has sufficient control from a frequentist perspective .",
    "this has the potential of yielding optimally powered frequentist procedures for multiplicity control .",
    "there have been other papers that study the frequentist properties of bayesian multiplicity control procedures ( @xcite , @xcite , @xcite ) , but they have not focused on the situation of data dependence .",
    "we investigate the potential for this program by an exhaustive analysis of the simplest multiple testing problem which exhibits test statistic dependence .",
    "the data @xmath3 arises from the multivariate normal distribution @xmath4 where @xmath5 is the correlation between the observations .",
    "consider testing the @xmath1 hypotheses @xmath6 versus @xmath7 , but under the assumption that at most one alternative hypothesis could be true .",
    "( it is possible that no alternative is true . )",
    "although our study of this problem is pedagogical in nature , such testing problems can arise in signal detection , when a signal could arise in one and only one of @xmath1 channels , and there is common background noise in all channels , leading to the equal correlation structure .",
    "we will , for convenience in exposition , use this language in referring to the situation .    in section 2",
    "we introduce two natural frequentist procedures for multiplicity control in this problem and , in section 3 , we introduce a natural bayesian procedure .",
    "section 4 explores a highly curious phenomenon that is encountered when @xmath5 is near 1 ; when @xmath8 , the bayesian procedure finds the true alternative hypothesis with near certainty , while an ad hoc frequentist procedure fails to do so .",
    "sections 5 and 6 study the frequentist properties of the original bayesian procedure and a type - ii mle approach , showing that , as @xmath9 , the bayesian procedures have strong frequentist control of error .",
    "section 7 considers the situation in which there is a data sample of growing size @xmath10 for each @xmath11 .",
    "two natural frequentist procedures are considered .",
    "declare channel @xmath12 to have the signal if @xmath13 , where @xmath14 is determined to achieve overall family - wise error control @xmath15    ( [ ad hoc_typei ] ) can be expressed as @xmath16^n \\right\\}\\,,\\ ] ] where the expectation is with respect to @xmath17 .    by lemma [ xandz ] in the appendix , under the null model",
    ", @xmath18 can be written as @xmath19 , where the @xmath20 and the @xmath21 are independent standard normal random variables .",
    "thus @xmath22^n \\right\\ } \\ , .",
    "\\end{split}\\ ] ]    * when @xmath23 , @xmath24 , essentially calling for the bonferroni correction .",
    "* when @xmath25 , @xmath26 , so the critical region is the same as that for a single test .",
    "if @xmath27 , @xmath28 , from which it follow that @xmath29 if @xmath25 , by lemma [ xandz ] , @xmath30    the extreme effect of dependence on frequentist multiplicity correction is clear here ; the correction ranges from full bonferroni correction to no correction , as the correlation ranges from 0 to 1",
    ".      a more principled frequentist procedure would be the likelihood ratio test ( lrt ) :    [ lrt ] the test statistic arising from the likelihood ratio test is @xmath31 ^ 2\\ ] ] and the lrt would be to reject the null hypothesis if @xmath32 , where @xmath14 satisfies @xmath33 .",
    "denote @xmath34 and its inverse @xmath35 the likelihood ratio is then , letting @xmath36 denote the density of @xmath37 and @xmath38 , @xmath39 computation yields , defining @xmath40 , @xmath41 from which it is immediate that @xmath42\\right\\}\\\\                  & \\hspace{7 cm }   ( \\text{since } \\sum^n_1 x_j = u_i + x_i   ) \\\\                  & = \\min \\limits_i \\,\\exp\\left\\{\\frac{-1}{2 } \\bigg [ ax_i^2 + 2bu_ix_i + \\frac{b^2}{a}u_i^2 \\bigg ] \\right\\ }          \\\\&=\\min \\limits_i \\",
    ", \\exp\\left\\{\\frac{-1}{2a } ( ax_i + bu_i)^2 \\right\\ } \\ , .",
    "\\end{split}\\ ] ] noting that @xmath43 ^ 2\\\\                  & = \\frac{1}{(1+(n-1)\\rho)(1+(n-2)\\rho ) } \\bigg[\\sqrt{1-\\rho}x_j + n\\rho\\bigg(\\frac{x_j -\\boldsymbol{\\bar{x}}}{\\sqrt{1-\\rho}}\\bigg)\\bigg]^2 \\ , ,          \\end{split}\\ ] ] it is immediate that lr is equivalent to the test statistic @xmath44 .",
    "the rejection region is @xmath45 for some @xmath46 , which is clearly equivalent to @xmath47 for appropriate critical value @xmath14 .",
    "when @xmath23 , @xmath48 , and the lrt reduces to the ad hoc testing procedure in the previous section . on the other hand , as @xmath49 , @xmath50 , which exhibits a quite different behavior that will be discussed later",
    "on the bayesian side , it is convenient to view this as the model selection problem of deciding between the @xmath51 exclusive models @xmath52 where @xmath53 is the vector of all @xmath54 except @xmath11 .",
    "the simplest prior assumption computationally is that , for the nonzero @xmath11 ( if there is one ) , @xmath55 initially we will assume @xmath56 to be known , but later will consider it to be unknown . then under model @xmath57 , the marginal likelihood of model @xmath57 is @xmath58 where @xmath59 the posterior probability of @xmath57 ( that the @xmath60 channel has the signal ) is then @xmath61 where @xmath62 is the prior probability of model @xmath63 .",
    "[ post_full ] for any @xmath64 and positive integer @xmath65 , the null posterior probability is : @xmath66    and the posterior probability of an alternative model @xmath57 is [ eq : post_prob_simplfy ] @xmath67    the posterior probability of @xmath57 is @xmath68    the expression can be simplified by further computing @xmath69,@xmath70 and @xmath71 .",
    "first notice that by the cholesky decomposition @xmath72 for some lower triangular matrix @xmath73 .",
    "then by the woodbury identity , the difference of two inverse matrices can be obtained : @xmath74 where @xmath75 .",
    "therefore , @xmath76 also the ratio of two determinants is @xmath77 by plugging back these quantities into ( [ eq : posterior ] ) , the proof is complete .",
    "( [ eq : post_prob_full ] ) gives the full expression for @xmath78 , without using @xmath79 , and is utilized in the subsequent proofs .",
    "[ post_prob_dim2 ] in particular , when @xmath80 , the null posterior probability is : @xmath81",
    "the following theorem shows the surprising result that , when the dimension is greater than @xmath82 , the bayesian method can correctly select the true model when the correlation goes to one . in two dimensions , however , there is nonzero probability of choosing the wrong alternative model if a non - null model is true .",
    "[ post_prob_rho1 ]    if @xmath80 , @xmath83 and @xmath49 , then : @xmath84    if @xmath85 , @xmath86 and @xmath25 , under model @xmath63 : @xmath87    by lemma [ xandz ] , @xmath88 can be written as @xmath89 .",
    "+ _ case i : n=2 _ : @xmath90 if @xmath91 is true , since both @xmath92 are zero , the dominant term of ( [ prob_dim2_dominated_term ] ) is @xmath93 , so the null posterior probability ( corollary [ post_prob_dim2 ] ) becomes : @xmath94 if @xmath57 is true , the dominant term of ( [ prob_dim2_dominated_term ] ) is @xmath95 ; hence as @xmath49 : @xmath96 using the fact that @xmath97 goes to zero faster than @xmath98 goes to infinity .",
    "if @xmath99 is true : similar to the previous case , ( [ prob_dim2_dominated_term ] ) is @xmath100 , so only the last term in ( [ post_prob_dim2 ] ) remains .",
    "+ _ case ii : @xmath85 _ : denote @xmath101 , @xmath102 ; if @xmath91 is true : take @xmath103 in ( [ eq : post_prob_full ] ) , let @xmath104 + @xmath105 , and note that @xmath106 then @xmath107    if @xmath63 is true ( @xmath108 ) : take @xmath109 in ( [ eq : post_prob_full ] ) : @xmath110    [ lrt_rho_goes_to_1 ] the likelihood ratio test ( theorem [ lrt ] ) is fully powered ( i.e. , rejects the null with probability 1 under an alternative hypothesis ) when @xmath25 and @xmath85 , but ( as with the bayesian test ) is not fully powered when @xmath80 .    by lemma [ xandz2 ] : @xmath111 when @xmath80 , under @xmath57 , when @xmath49 : @xmath112          = 2 \\lim_{\\rho\\rightarrow 1 }          \\max_{j \\in   \\{1,2\\}}\\rho\\bigg ( \\frac{x_j - x_{(-j)}}{2\\sqrt{1-\\rho}}\\bigg)^2\\ , .                                  \\ ] ] for both @xmath113 or @xmath114 , the corresponding likelihood ratios go to infinity at the same asymptotic rate since @xmath115 ^ 2 = \\big[-\\theta_i/(2\\sqrt{1-\\rho})-(z_i - z_{(-i)})/2   \\big]^2 $ ] . when @xmath85 , under @xmath63 , when @xmath49 : @xmath116          & = \\max_i n\\bigg[\\frac{\\theta_i-\\theta_j / n}{\\sqrt{1-\\rho}}+z_i-\\boldsymbol{\\bar{z } }   \\bigg]^2+o(1 ) \\\\          & = n\\bigg[\\frac{\\theta_j(1 - 1/n)}{\\sqrt{1-\\rho}}+z_j-\\boldsymbol{\\bar{z } }   \\bigg]^2+o(1)\\ , .",
    "\\end{split}\\ ] ] in this case , the true alternative model has largest likelihood ratio ( = @xmath117 ) , hence , lrt is fully powered .    from theorem [ post_prob_rho1 ] and [ lrt_rho_goes_to_1 ] ,",
    "when the correlation goes to 1 and the dimension is larger than 2 , both the bayesian procedure and the lrt are fully powered .",
    "this surprising behavior as the correlation goes to one can be explained by the following observations using ( [ xandz ] ) .    when @xmath80 , @xmath118 : @xmath119-[\\theta_j+\\sqrt{\\rho}z+\\sqrt{1-\\rho}z_j ]       = \\begin{cases } 0 \\mbox {     under } m_0    \\\\",
    "\\theta_i \\ , \\ , or\\ ,   -\\theta_j   \\mbox { else}\\ , .",
    "\\end{cases } \\end{split}\\ ] ] hence , one can correctly distinguish the null model if it is true , but can not declare which non - null model is true when @xmath120 is not 0 .    when @xmath85 , @xmath25 : if all pairs @xmath120 are zero , then the null model is true .",
    "if there are pairs @xmath120 , @xmath121 that are nonzero , we can further check whether @xmath122 ( @xmath123 ) equals zero or not to see whether @xmath11 or @xmath54 is nonzero .",
    "note that the ad hoc frequentist test does not have this behavior .",
    "as @xmath25 , the test    * still has probability @xmath124 of incorrectly rejecting a true @xmath91 ; * still has positive probability of not detecting a signal when @xmath57 is true .",
    "this highlights the danger ( in terms of lack of power ) of using ` intuitive ' procedures for multiplicity control .",
    "in this section , we will be studying the false positive probability ( fpp ) theoretically and numerically .",
    "we first need to obtain asymptotic posteriors .",
    "[ lemma : post_n_infinity ] as n @xmath125 under the null model , @xmath126 almost surely .",
    "take @xmath127 in ( [ eq : post_prob_full ] ) : @xmath128 without loss of generality , assuming @xmath129 for all @xmath12 , which holds almost surely by lemma [ x_upper_bdd ] , asymptotic analysis of ( [ post_n_infty_proof ] ) yields : @xmath130 therefore , @xmath131",
    "@xmath132    the summation term in ( [ post_n_infty_proof ] ) becomes : @xmath133+o(1 ) \\bigg)(1+o(1))\\\\                  & \\qquad \\qquad \\text { by the law of large numbers and since } z\\sim n(0,1)\\\\          & = \\exp \\left\\ { \\frac{-\\tau^2}{2(1-\\rho+\\tau^2 ) } z_i^2 \\right\\ }",
    "n \\sqrt { \\frac{1-\\rho+\\tau^2}{1-\\rho}}(1+o(1))\\ , .          \\end{split}\\ ] ] the proof is completed by adding ( [ proof_post_n_infinity_term1 ] ) and ( [ proof_post_n_infinity_term2 ] ) .    note that , by lemma [ xandz2 ] , @xmath134 so that lemma [ lemma : post_n_infinity ] can be written , with respect to @xmath135 : @xmath136    figure  [ fig : p(m1|x)_n_grows ] shows the ratio of the estimated @xmath137 ( from lemma [ post_n_infinity ] ) and the true probability ( from theorem [ eq : post_prob_simplfy ] ) , as @xmath1 grows .",
    "each plot contains @xmath138 different ratio curves based on independent simulations with fixed @xmath139 and @xmath140 .",
    "as can be seen , the ratio goes to @xmath141 when @xmath1 grows and the convergence rate indeed depends on the correlation .",
    "figure  [ fig : p(m1|x)_tau_grows ] gives the estimated and true posterior probability of @xmath142 under the assumption that the null model is true , for fixed @xmath143 and @xmath1 , but varied @xmath140 .",
    "notice that , for fixed @xmath1 , the estimated probability is closer to the true probability when @xmath140 is small but is worse for larger @xmath140 , indicating that larger @xmath1 is required for obtaining the same precision as @xmath140 grows .",
    "the following theorem shows the surprising result that , as @xmath1 grows when the null model is true , the posterior probability of the null model converges to its prior probability .",
    "thus one can not learn that the null model is true .",
    "[ p(m0|x)=r ] as @xmath144 and @xmath64 , under the null model , @xmath145    first note that @xmath146 the summation term in the null posterior ( theorem [ post_full ] ) becomes @xmath147 ^ 2   \\right\\}(1+o(1 ) ) \\\\                                          & = \\bigg(\\frac{1-r}{r}\\bigg ) 1/n \\sqrt{\\frac{1-\\rho}{1-\\rho+\\tau^2 } }                  \\sum^n_1 \\exp\\left\\{\\frac{\\tau^2}{2(1-\\rho+\\tau^2 ) } z_i^2 \\right\\}(1+o(1 ) ) \\,\\ , ( \\text{by lemma } \\ref{xandz2})\\\\                  & \\rightarrow \\frac{1-r}{r } \\quad \\text { ( by the strong law of large numbers ) . }            \\end{split}\\ ] ]    therefore , @xmath148    figure  [ fig : p(m0|x)=r ] shows simulations of the null posterior probability for different numbers of hypotheses and different correlations .",
    "interestingly , by theorem [ post_prob_rho1 ] , the bayes procedure identifies the correct model ( here the null model ) when @xmath1 is fixed and the correlation goes to 1 , resulting in higher initial posterior probability of the null model for highly correlated cases . on the other hand , by theorem [ p(m0|x)=r ] , this posterior probability converges to its prior probability regardless of the correlation .",
    "this convergence can be seen in figure  [ fig : p(m0|x)=r ] .",
    "here we focus on the major goal , to find the frequentist false positive probability under the null model of the bayesian procedure . to begin , we must formally define the bayesian procedure for detecting a signal .",
    "[ defn : model selection ] accept model @xmath57 if its posterior probability @xmath149 , is greater than a specified threshold @xmath150 . if multiple models pass this threshold , choose the one with largest posterior probability .    under the null model ,",
    "the fpp is the frequentist probability of accepting a non - null model .",
    "[ fpp ] under the null model , as @xmath9 , @xmath151    under the null model , by ( [ post_n_infinity ] ) , @xmath152 is equivalent to @xmath153 by fact [ normal_tail ] : @xmath154    @xmath155    this is a surprising and unsettling result : a standard bayesian procedure yields a false positive probability that goes to zero at a polynomial rate .",
    "this is much too strong error probability control from a frequentist perspective ; that it happens on the bayesian side is surely indication that assuming we know @xmath56 is too strong an assumption .",
    "hence we turn to a more flexible approach in the next section .",
    "to increase the frequentist power of the bayes test , we consider adaptive choices of @xmath56 .",
    "first , we consider the choice that maximizes the false positive probability .",
    "then we consider a type ii maximum likelihood approach based on estimating @xmath56 .",
    "[ eb_likelihood ] given null model prior probability @xmath156 , correlation @xmath5 , and decision threshold @xmath157 , as @xmath9 , the choice of @xmath56 that maximizes fpp is @xmath158\\,.\\ ] ] the resulting fpp is @xmath159 where @xmath160    without loss of generality , assume @xmath161 . by the model selection criteria @xmath162 ,",
    "@xmath163 is a false positive if : @xmath164 lemma [ lem_max_tausq_fpp ] establishes that ( [ eq.maximizingtau ] ) maximizes the fpp and , with this choice of @xmath165 , the rejection region becomes @xmath166 finally , @xmath167    so , with this adaptive choice of @xmath56 , the fpp only goes to zero at a @xmath168 rate , much slower than the polynomial rate achieved for fixed @xmath56 .",
    "figure  [ fig : fpp_conv_diff_rho_adapted ] provides the simulated ( red curve ) and theoretical ( in blue ) false positive probability ( fpp ) with respect to the number of hypotheses ( denoted by n ) .",
    "as expected , the simulated results match the theoretical prediction , the rate of convergence being around @xmath169 .",
    "note that the fpp does not become extremely small even for very large @xmath1 .",
    ", @xmath23 as @xmath1 varies from @xmath170 to @xmath171 , @xmath56 is the adaptive choice.,width=377,height=264 ]      the type ii maximum likelihood approach to choice of the prior under the alternative model replaces a pre - specified @xmath56 with that prior variance , @xmath172 , which maximizes the marginal likelihood over all possible @xmath56 ; see @xcite for discussion of this approach .",
    "[ eb_lem ] let @xmath173 be the marginal likelihood of @xmath56 given @xmath174 , namely @xmath175 defining @xmath176 the type ii mle , @xmath172 , can be found as @xmath177    @xmath178 noting that @xmath179 , @xmath180 , @xmath181 and @xmath182 are independent of @xmath56 , the result follows .    [ type ii mle false positive probability ] [ eb_likelihood ] given null prior probability @xmath156 , correlation @xmath5 , and decision threshold @xmath157 , as @xmath9 @xmath183 where @xmath184 satisfies : @xmath185    first , lemma [ lem_max_tausq_fpp ] shows that ( [ eb_z1 ] ) provides the absolute lower bound for @xmath186 to be in the rejection region ; namely @xmath187 .",
    "so the rejection region , denote it by @xmath188 , corresponding to the type ii mle choice of @xmath56 must be a subset of @xmath189 .",
    "divide this interval into @xmath190 where @xmath191 will be chosen large , but fixed .",
    "we first determine @xmath192 .    for any @xmath193 , lemma [ eb_max ] , shows that the type - ii mle estimate is @xmath194 thus , letting @xmath195 denote the smallest value in @xmath192 ( if it exists ) and letting @xmath196 denote the corresponding type - ii mle estimate , the smallest value must satisfy , by ( [ fp_condition ] ) , @xmath197}_{l^*}+o(1)\\bigg ) \\ , .",
    "\\end{split}\\ ] ] this is equivalent to @xmath198 which , using lemma [ l>0 ] ( which shows that @xmath199 ) , can easily be shown to have a unique solution in @xmath192 ( assuming k is larger than , say , @xmath200 ) .",
    "it also also then easy to show that @xmath201    by [ normal_tail ] , @xmath202/2)}/\\sqrt{2\\log n + \\log\\log n + c(p , r)+k } }                  { \\frac{\\sqrt{2\\log",
    "n + \\log\\log n + l^*}\\exp{(-[2\\log n + \\log\\log n + l^*]/2)}}{2\\log n + \\log\\log n + c(p , r)+l^*}- \\frac{\\exp{(-[2\\log",
    "n + \\log\\log n + c(p , r)+k]/2)}}{\\sqrt{2\\log n + \\log\\log n + c(p , r)+k } } } \\\\   & = \\left(\\exp{([c(p , r)+k - l^*]/2)}-1\\right)^{-1 } ( 1+o(1 ) ) \\ , .",
    "\\end{split}\\ ] ] @xmath203 and @xmath204 are fixed , we can clearly choose @xmath191 large enough to make this smaller than any specified @xmath205 .",
    "hence the region @xmath206 can be ignored in the computation of the fpp .",
    "( it is almost certainly part of the rejection region , but we do not know what @xmath207 is for observations in that region and , hence ca nt say for sure . )    we can also use the same argument to say that @xmath208 writing @xmath184 for @xmath209 , it follows that the fpp is @xmath210^{-1/2 }   \\\\                              & \\hspace{10 cm}(1+o(1))(1+\\epsilon)\\\\                                                  & = \\bigg(\\frac{1}{k^*}-\\frac{1}{2}\\bigg )            \\frac{1}{log\\,n } ( 1+o(1))(1+\\epsilon )              \\quad \\text{by ( \\ref{c*})}\\ , .",
    "\\end{split}\\ ] ] since @xmath205 can be made arbitrarily small , the result follows .",
    "note that ( [ k * ] ) can be solved numerically .",
    "for instance , when @xmath211 , @xmath212 .",
    "the solution of @xmath213 with respect to @xmath214 is , indeed , given in figure [ fig : num_kstar ] .",
    "the type ii mle fpp converges to 0 at a logarithmic rate in n , as did the maximal bayesian fpp .",
    "thus both are far less conservative than the bayesian procedures with specified @xmath56 . finally , it is interesting that neither of the adaptive asymptotic fpp s depend on @xmath5 .",
    "figure [ fig : fpp_fixed ] demonstrates how the threshold @xmath157 ( definition [ defn : model selection ] ) can be chosen to achieve a fixed fpp of 0.05 .",
    "because , for a fixed @xmath157 , the fpp goes to zero as a function of @xmath1 , smaller @xmath157 are needed to achieve a fixed fpp as @xmath1 grows .",
    "note that the variation in @xmath157 is actually quite small over the very large range of @xmath1 considered in the figure .",
    "increases , the bayesian threshold probability @xmath157 that would achieve an fpp of @xmath215 . ]",
    "figure [ fig : num_kstar ] gives the value of @xmath213 for different @xmath214 .",
    "( y - axis ) with respect to different @xmath216 ( x - axis ) . ]",
    "figure [ fig : power_analysis_power_versus_theta ] demonstrates the how the detection power varies when the signal size increases .     for fixed @xmath211 , @xmath23 , and different @xmath1 ( see the color legend on the top left ) .",
    "each point is the average acceptance rate of the true non - null model when @xmath11 is as specified on the x - axis . ]",
    "in this section , we generalize model ( [ model ] ) to the scenario where each channel has @xmath10 i.i.d observations .",
    "then the sample mean satisfies @xmath217 hence , @xmath10 can be seen as the precision of @xmath218 .",
    "more generally , we will replace @xmath219 by a function @xmath220 , where @xmath221 decreases to zero as @xmath1 grows .",
    "the theorem below gives the rate of decrease of @xmath220 which guarantees consistency .",
    "for the i.i.d .",
    "case , consistency of all models is only guaranteed if @xmath10 grows faster than @xmath222 ; consistency fails if @xmath10 grows slower than @xmath222 ; and consistency depends on the parameter value if @xmath10 is @xmath223 .",
    "[ information_grows_model ] consider model ( [ model ] ) , with the altered covariance matrix below : @xmath224    1 .",
    "when @xmath225 , consistency holds for both the null and alternative models . 2 .   when @xmath226 , * under @xmath91 : @xmath227\\big)^{-1}\\,,$ ] failing to be consistent .",
    "* under an alternative model @xmath63 , if d @xmath228 , consistency holds for @xmath63 , whereas consistency does not hold otherwise .",
    "when @xmath229 and @xmath230 , consistency does not hold for any model .",
    "in addition , when the null hypothesis is true , @xmath231    write @xmath232 , @xmath233 , and @xmath234",
    ". then a nonzero @xmath235 has prior @xmath236 and ( [ information_grows_model ] ) becomes : @xmath237    _ under the null model _ :",
    "by theorem [ post_full ] , @xmath238 where @xmath239    since @xmath240 , @xmath241 , and @xmath242 , one can apply theorem [ eb_limit_general ] to get the asymptotic analysis of ( [ information_grows_m0 ] ) : @xmath243 \\\\                                          & =   \\frac{1-\\rho}{\\tau^2 } \\bigg [ d_n + \\frac{1}{2}\\bigg(\\frac{d_n}{log\\,n}\\bigg ) \\log\\bigg(\\frac{log\\,n}{d_n}\\bigg)\\bigg ] ( 1+o(1 ) )                                          \\rightarrow                      \\begin{cases }                      \\infty                             & \\mbox { if } d_n \\rightarrow \\infty\\ , , \\\\",
    "\\frac{1-\\rho}{\\tau^2}d             & \\mbox { if } d_n \\rightarrow d\\,,\\\\                      0                                  & \\mbox { if } d_n \\rightarrow 0\\ , .",
    "\\end{cases }                      \\end{split}\\ ] ] hence , under the null hypothesis , @xmath244    _ under the alternative model @xmath63 _ : by theorem [ post_full ] , @xmath245 \\right\\}\\\\                                          & + 1 + \\sum\\limits_{k\\neq j}^n \\exp \\left\\{\\frac{-\\tau^2}{2(\\sigma^2_n+a_n\\tau^2 ) } \\bigg[\\frac{\\theta_j^2}{2(1-\\rho)^2\\sigma_n^2}+o(\\frac{1}{\\sigma_n } ) \\bigg]\\right\\}\\ , .",
    "\\end{split}\\ ] ] the first term is @xmath246 \\right\\ }                       \\bigg(1+o\\bigg(\\sqrt{\\frac{log\\,n } { d_n}}\\bigg)\\bigg)\\\\                                          & = \\sqrt{\\tau^2/(1-\\rho ) } \\sqrt{\\frac{log\\,n}{d_n}}\\bigg(\\frac{r}{1-r}\\bigg ) n^{1-\\frac{\\theta_j^2}{2(1-\\rho)d_n } }                                          \\bigg(1+o\\bigg(\\sqrt{\\frac{log\\,n}{d_n}}\\bigg)\\bigg)\\\\                                          & \\mbox{which $ \\rightarrow 0 $ if and only if } \\lim \\limits_{n\\rightarrow \\infty } d_n < \\frac{\\theta_j^2}{2(1-\\rho)}\\ , .",
    "\\end{split }                      \\normalsize\\ ] ] and the last term , @xmath247 \\right\\}\\bigg(1+o\\bigg(\\sqrt{\\frac{log\\,n } { d_n}}\\bigg)\\bigg)\\\\                                          & = n \\exp \\left\\{-\\frac{\\theta_j^2}{2(1-\\rho)}\\frac{log\\,n}{d_n } \\right\\}\\bigg(1+o\\bigg(\\sqrt{\\frac{log\\,n}{d_n}}\\bigg)\\bigg ) \\\\                                          &",
    "= n^{1-\\frac{\\theta_j^2}{2(1-\\rho)d_n}}\\bigg(1+o\\bigg(\\sqrt{\\frac{log\\,n}{d_n}}\\bigg)\\bigg ) \\ , , \\\\                                          & \\rightarrow 0 \\text { when } \\lim \\limits_{n\\rightarrow \\infty } d_n < \\frac{\\theta_j^2}{2(1-\\rho)}\\ , .",
    "\\end{split}\\ ] ]",
    "the main purpose of this work was to gain understanding of the behavior of bayesian procedures that control for multiple testing , under a scenario of high dependence among test statistics , where frequentist methods for multiplicity control become more difficult to implement when trying to maintain high power . in section [ sec.power ] ,",
    "the bayesian procedure was shown to have unexpectedly high power as the correlation gets large , providing an illustration of the gains that can be had by approaching multiplicity control from the bayesian side .",
    "( bayes theorem often produces things that we could not have produced through our intuition alone . )    the other main issue concerning the behavior of the bayesian procedure is the extent to which it also exhibits desirable frequentist control .",
    "surprising to us was that the bayesian procedure exhibited too - strong frequentist control , with the fpp ( false positive probability under the null model ) going to zero at a polynomial rate , as the number @xmath1 of tests grows .",
    "to a bayesian who believed in the prior distribution that was utilized this would not be viewed as a problem , but we tend to prefer procedures that have a dual bayesian / frequentist interpretation . to this end , adaptive versions of the bayesian procedure were considered , and found to have fpp s going to 0 at the much slower @xmath248 rate ; indeed , unless @xmath1 is huge , the resulting fpps were reasonably moderate .",
    "a number of other surprises were also encountered , such as the fact that , as the number of tests @xmath1 grows , the posterior probability of the null model converges to its prior probability .",
    "( this is actually a very general phenomenon that will be reported elsewhere . )",
    "the situation of having i.i.d .",
    "replicate observations @xmath10 was also considered , and it was shown that one needs @xmath10 to grow faster than @xmath222 to achieve consistency , under both the null and alternative models .",
    "methodologically , if a frequentist were to encounter this particular multiple testing problem and desired a procedure that is fully powered and achieves an fpp of @xmath124 , we would suggest using the adaptive bayesian procedure in section [ sec.adaptivefpp ] .",
    "one solves ( [ eq.adaptivefpp ] ) for the bayesian rejection threshold @xmath157 ( with , say , the default choice of @xmath249 for the prior probability of the null model ) , and then rejects the null and accepts @xmath57 if @xmath250 , where @xmath149 is as in ( [ eq : post_prob_simplfy ] ) with @xmath56 chosen as in ( [ eq.maximizingtau ] ) .",
    "this bayesian procedure will have the unusual power benefits outlined in section [ sec.power ] when the correlation is high , while achieving the desired frequentist fpp ( at least asymptotically ) and likely having the greatest power against alternatives , since the @xmath56 in ( [ eq.maximizingtau ] ) was chosen , in essence , to maximize the power .",
    "the posterior of any non - null model @xmath57 is : @xmath260(1-\\rho ) }   \\left ( ( x_i-\\boldsymbol{\\bar{x}})+\\frac{(1-\\rho)\\boldsymbol{\\bar{x}}}{1+(n-1)\\rho } \\right)^2    \\right\\ }   + \\\\                                          \\sum \\limits_{k=1}^n \\exp\\bigg [ \\frac{-\\tau^2}{2 } \\frac{1+(n-1)\\rho}{[(1-\\rho+\\tau^2)(1+(n-1)\\rho)-\\tau^2\\rho](1-\\rho ) } \\\\",
    "\\hspace{2 cm}\\bigg((x_i+x_k-2\\boldsymbol{\\bar{x}})(x_i - x_k)+2\\frac{\\boldsymbol{\\bar{x}}(x_i - x_k)(1-\\rho)}{1+(n-1)\\rho ) } \\bigg ) \\bigg ]                      \\end{array } \\right\\}^{-1 } \\ , .                                                              \\end{split}\\ ] ] alternatively , in terms of @xmath261 , with @xmath262 : @xmath263(1-\\rho)}\\\\                                          \\hspace{0.5 cm } \\bigg ( \\theta_i-\\bar{\\boldsymbol{\\theta}}+\\sqrt{1-\\rho}(z_i-\\boldsymbol{\\bar{z}})+                                           \\frac{1-\\rho}{1+(n-1)\\rho }                      ( \\bar{\\boldsymbol{\\theta}}+\\sqrt{\\rho}z+\\sqrt{1-\\rho } \\boldsymbol{\\bar{z } } )    \\bigg ) ^2   \\bigg ]   \\\\",
    "+ \\sum \\limits_{k=1}^n \\exp \\bigg [                      \\frac{-\\tau^2}{2 }                                          \\frac{1+(n-1)\\rho}{[(1-\\rho+\\tau^2)(1+(n-1)\\rho)-\\tau^2\\rho]}\\\\                                          \\hspace{2 cm } \\bigg ( \\frac{[\\theta_i+\\theta_k-2\\bar{\\boldsymbol{\\theta}}+\\sqrt{1-\\rho}(z_i+z_k-2\\boldsymbol{\\bar{z}})][\\theta_i-\\theta_k+\\sqrt{1-\\rho}(z_i - z_k)]}{1-\\rho}+ \\\\                                          \\hspace{4 cm } 2\\frac{[\\bar{\\boldsymbol{\\theta}}+\\sqrt{\\rho}z+\\sqrt{1-\\rho}\\boldsymbol{\\bar{z}}][\\theta_i-\\theta_k+\\sqrt{1-\\rho}(z_i - z_k)]}{1+(n-1)\\rho}\\bigg )                      \\bigg ]                      \\end{array } \\right\\}^{-1}\\ , .",
    "\\end{split}\\ ] ]              [ weak law for triangular arrays ( wlta ) ] [ wlln ] for each @xmath1 , let @xmath276 , @xmath277 be independent .",
    "let @xmath278 with @xmath279 and let @xmath280 .",
    "suppose that as @xmath255 : @xmath281 and @xmath282 .",
    "then              checking the second assumption of the wlta : + since @xmath293 , without loss of generality , assume @xmath294 . then noting that @xmath295 the wlta yields @xmath296 in probability , and the result follows .",
    "for the case in which @xmath321 , using corollary [ eb_limit ] , it follows that @xmath322(1+o(1)),\\ ] ] where @xmath323 .",
    "differentiating @xmath324 $ ] and setting the derivative to 0 , yields the solution @xmath325 , which translates into @xmath326 as in the statement of the lemma .",
    "it is straightforward to show that this extrema of @xmath327 is the maximum , and @xmath328 as this maximum thus exceeds the maximum over the domains @xmath316 and @xmath319 , the proof is complete .",
    "benjamini , y. and hochberg , y. ( 1995 ) , `` controlling the false discovery rate : a practical and powerful approach to multiple testing , '' _ journal of the royal statistical society .",
    "series b ( methodological ) _ , pp . 289300 .",
    "bogdan , m. , ghosh , j.  k. , tokdar , s.  t. , et  al .",
    "( 2008 ) , `` a comparison of the benjamini - hochberg procedure with some bayesian rules for multiple testing , '' in _ beyond parametrics in interdisciplinary research : festschrift in honor of professor pranab k. sen _ , pp .",
    "211230 , institute of mathematical statistics ."
  ],
  "abstract_text": [
    "<S> the problem of testing mutually exclusive hypotheses with dependent test statistics is considered . </S>",
    "<S> bayesian and frequentist approaches to multiplicity control are studied and compared to help gain understanding as to the effect of test statistic dependence on each approach . </S>",
    "<S> the bayesian approach is shown to have excellent frequentist properties and is argued to be the most effective way of obtaining frequentist multiplicity control , without sacrificing power , when there is considerable test statistic dependence . </S>"
  ]
}