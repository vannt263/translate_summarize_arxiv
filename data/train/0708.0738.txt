{
  "article_text": [
    "@xcite introduced what is now called the `` aarseth scheme '' or `` the standard scheme '' for the direct integration of gravitational @xmath0-body systems .",
    "it is a combination of the individual timestep algorithm , which allows individual particles to have their own times and timesteps , and variable - stepsize fourth - order adams - moulton predictor - corrector scheme .",
    "the basic idea of individual timestep scheme is as follows .",
    "when particle @xmath1 is integrated from its time @xmath2 to its new time @xmath3 , the calculation of acceleration is done only at its new time , and positions of all other particles at that time are `` predicted '' in some way .",
    "thus , adams - moulton predictor - corrector schemes in the pec ( predict - evaluate - correct ) mode with variable stepsize are suitable for the individual timestep algorithm , because they require the acceleration calculation only at the end of the timestep . in addition , in the pec mode , the acceleration can be calculated from predicted variables .",
    "if we do not use the individual timestep algorithm , we can easily change timesteps if we use single - step integration schemes such as runge - kutta methods .",
    "however , runge - kutta schemes can not be combined with the individual timestep algorithm , because they require the calculation of accelerations in intermediate points . in the case of two particles with different timesteps , in order to integrate the particle with longer timestep , we need the position of the other particle in the past . however , with usual implementation of the individual timestep algorithm , such past data is not available . in principle , we could keep the past trajectory of particles as demonstrated by @xcite .",
    "such schemes are not yet widely used , though a sample implementation does exist@xcite .",
    "the fourth - order aarseth scheme had been the method of choice for the time integration of gravitational @xmath0-body systems .",
    "however , the optimal value for the order of the integration scheme has not been known .",
    "@xcite implemented the aarseth scheme with an arbitrary order , and performed a systematic test of the accuracy .",
    "he found that the optimal choice of the order weekly depends on the required accuracy , and if the required accuracy is very high orders higher than 4 would give better results .",
    "however , he also found that the fourth - order scheme is close to optimal for practical values of required accuracy .",
    "his result , however , is for a pure individual timestep algorithm , for which the calculation cost of the acceleration depends on the order of the integrator , through the calculation cost of predictors for particles other than that integrated .",
    "@xcite and later @xcite introduced the so - called blockstep scheme , in which the timesteps of particles are quantized to powers of two so that multiple particles share exactly the same time . with this blockstep scheme ,",
    "the calculation cost of predictors becomes much smaller than that of the force calculation for any practical value of the order of the integration scheme , and therefore high - order schemes become more efficient than in the case of the original individual timestep algorithm .",
    "@xcite also introduced the concept of hermite scheme , in which the first time derivative of the acceleration is directly calculated and used to construct the interpolation ( actually the extrapolation for the predictor ) polynomial .",
    "as discussed in @xcite , the fourth - order hermite scheme has an extra advantage that it is quite simple to implement .",
    "the predictor polynomial for fourth - order schemes must be at least third order for position and second order for velocity .",
    "fortunately , the directly calculated first time derivative of the acceleration ( _ jerk _ ) is just sufficient to construct predictors .",
    "in other words , fourth - order hermite scheme is effectively a single - step algorithm which does not require the memory of previous timesteps .",
    "another advantage of the fourth - order hermite scheme is that it is time - symmetric , when used with the correct - to - convergence mode .",
    "this feature has been used to achieve effective time - symmetry for the integration of internal motions of binaries @xcite or nearly - circular orbits of planetesimals @xcite . also , in @xcite , a time - symmetric individual timestep algorithm with hermite scheme have been implemented .",
    "the calculation cost of the hermite scheme per timestep is somewhat higher than that of the aarseth scheme , since the jerk must be calculated as well as the acceleration .",
    "however , roughly speaking the hermite scheme allows the timestep larger than that for the aarseth scheme by almost a factor of two , while increase in the calculation cost seems to be less than a factor of two .",
    "thus , by switching from the fourth - order aarseth scheme to the fourth order - hermite scheme , effective gain in calculation speed is achieved while the calculation program becomes simpler .",
    "this combined effect is the reason why the fourth - order hermite scheme is now widely used .",
    "the result shown in @xcite implies that for blockstep algorithms higher - order schemes might be more efficient . in this paper , we construct higher - order generalization of the fourth - order hermite scheme and report their performance .",
    "there are two different ways to construct higher - order generalization of the hermite scheme .",
    "the first one is to use previous timesteps , in the same way as in the original aarseth scheme .",
    "this method was described in @xcite .",
    "the other is to use even higher derivatives directly calculated , while still using only two points in time .",
    "of course , it is possible to combine these two methods .    to our knowledge",
    ", there have been no published work on the latter approach combined with the individual timestep algorithm . at first sight",
    ", it looks nontrivial to combine the direct calculation of the higher - order derivatives and individual timestep algorithm . in section 2",
    ", we show that the combination is actually possible and that it is not much difficult compared to the original fourth - order hermite scheme . in section 3",
    ", we present the result of numerical experiments , and section 4 is for discussions .",
    "in the individual timestep scheme , particle @xmath1 has its own time ( @xmath2 ) , timestep ( @xmath4 ) , position ( @xmath5 ) and velocity ( @xmath6 ) at time @xmath2 , and acceleration ( @xmath7 ) and time derivative(s ) of acceleration ( @xmath8 ) calculated at time @xmath2 .",
    "the integration proceeds according to the following steps :    1 .   select particle @xmath1 with a minimum @xmath9 . set the global time ( @xmath10 ) to be this minimum , @xmath9 .",
    "2 .   predict the positions and necessary time derivatives of all particles at time @xmath10 using the predictor polynomials .",
    "3 .   calculate the acceleration and its time derivative(s ) for particle @xmath1 at time @xmath10 , using the predicted positions etc .",
    "4 .   construct higher order time derivatives using the hermite interpolation based on the new values of acceleration and its derivatives at time @xmath9 and those at the previous time @xmath2 .",
    "apply the corrector to position and velocity using these high - order time derivatives , determine new timestep @xmath4 , and update time @xmath2 .",
    "5 .   go back to step ( 1 ) .",
    "the above description is for the original individual timestep algorithm , and we usually use the so - called blockstep algorithms , in which the timesteps are quantized to powers of two so that particles of the same stepsize share exactly the same time ( mcmillan 1986 ) . in this way , we can calculate forces on these particles in parallel .    in the following , we present the force calculation formula , predictor , corrector , timestep criterion and initialization procedure , in this order .",
    "the gravitational force from particle @xmath11 to particle @xmath1 and its first three time derivatives are expressed as    @xmath12    here , we call the first four time derivatives of the acceleration _ jerk _ , _ snap _ , _ crackle _ and _ pop _ , and @xmath13 , @xmath14 and @xmath15 are given by @xmath16 where @xmath17 , @xmath6 , @xmath7 , @xmath18 and @xmath19 are the position , velocity , total acceleration , total jerk and mass of particle @xmath1 , and @xmath20 , @xmath21 , @xmath22 and @xmath23 @xcite .",
    ". number of floating - point operations in force calculation up to potential , acceleration , jerk , snap and crackle . [ cols= \"",
    "< , < , > \" , ]     in order to examine the behavior of the timestep criterion for different orders , it is necessary to calculate the timesteps with different orders for identical distribution of particles .",
    "we can of course do this for initial condition , but exact comparison is impossible for the later times . in order to make the comparison , we used the system integrated with the eighth - order scheme , and calculated the timesteps with fourth- and sixth - order criteria using the derivatives obtained by the eighth - order hermite interpolation . to determine the stepsize",
    ", we used the accuracy parameter @xmath24 same as that used in the actual time integration .",
    "figure [ fig : dtfrac ] shows the distribution of timesteps for initial plummer model and after the core collapse ( @xmath25 ) .",
    "we can see that the distribution of timesteps depends strongly to the order of the integrator . even for the initial condition ,",
    "the range of timesteps of particles for the eighth - order scheme is much narrower than that for the fourth - order scheme .",
    "this tendency is much more pronounced for the system after the core collapse .",
    "thus , for particles with smallest timesteps , timestep criteria with different orders give similar values .",
    "however , particles with large timesteps have very different stepsizes , depending on the order of the timestep criterion .",
    "figure [ fig : dtrel ] shows actual values of timesteps calculated using timestep criteria of different orders as two - dimensional scattergrams .",
    "we can see the correlation is quite tight , but at the same time highly nonlinear . while particles with small stepsize ( those in the central region of the system ) have similar stepsizes when calculated with different orders , particles with large stepsizes ( those in the outer region of the system ) have very different stepsize depending on the order .",
    "in particular , it seems high - order schemes have maximum stepsizes which depend on the structure of the system .",
    "the initial plummer model allows timesteps up to around 0.1 , while for the collapsed system timestep can not significantly exceed 0.01 in the case of the eighth - order scheme . in other words , the timestep of particles far away from the central region of the system somehow shrinks by a factor of 10 in the case of the eighth - order criterion , while no such shrinking is visible for the fourth - order criterion .      in order to understand this behavior ,",
    "let us consider a simplified model of the collapsed system .",
    "assume that the distribution of particles outside the core is isothermal with @xmath26 , and the core size is @xmath27 .",
    "total mass of the system within radius @xmath28 is 1 , and orbital timescale of particles at radius @xmath29 is @xmath29 .",
    "the mass inside radius @xmath29 is @xmath29 for @xmath30 .",
    "the number of particles in @xmath31 is @xmath0 and mass of particles @xmath32 is @xmath33 . in these units ,",
    "the core mass @xmath34 is around @xmath27 , within a factor of two or so .",
    "first , we consider the contribution of the nearest neighbor , for a particle at @xmath28 .",
    "the distance to the nearest neighbor is roughly @xmath35 .",
    "the timescale in which this distance changes is also @xmath36 , where @xmath37 is the typical relative velocity and is order unity .",
    "therefore , the acceleration and its @xmath38-th derivative have the strength of around @xmath39 we can see that the timestep criteria of the form ( [ eq : generalaarseth ] ) would give similar stepsize of @xmath40 for different orders , if the higher order terms are dominated by the contributions from near neighbors . to put it in words : if you use a local criterion to determine an integration step time scale , you will always get the time needed to reach your nearest neighbor .",
    "now consider the contribution from one particle at small distance @xmath41 from the center , to a particle at distance one from the center .",
    "the strength of the acceleration is of the order @xmath42 .",
    "the orbital timescale is the larger of @xmath29 and @xmath27 .",
    "we call this value , the larger of @xmath29 and @xmath27 , as @xmath43",
    ". the timescale of the change of the acceleration @xmath44 is the orbital timescale @xmath43 , and the fractional change in the acceleration is also order @xmath43 : @xmath45 .",
    "thus the time derivatives of the acceleration have the strength of @xmath46    if @xmath47 , the contribution to the high order derivative of a particle at distance one from the center of the system is larger for a particle with distance @xmath48 from the center than for the nearest neighbor , for sufficiently large values of @xmath38 . for our numerical experiment ,",
    "the size of the core at the core collapse is around 0.003 , which is much smaller than @xmath40 .",
    "thus , for high enough orders like @xmath49 , it seems natural that the contributions from the particles in the core dominate .",
    "for @xmath50 , the nearest neighbor might still be dominant .    from the viewpoint of the accuracy of the time integration",
    ", it seems obvious that the behavior of higher order criteria is better . with low - order criteria",
    ", we effectively ignore the high - frequency variation of the acceleration when integrating the orbits of particles far away from the core . as a result",
    ", there must be the sampling error or aliasing error for the forces from particles in the core , which should show up as the integration error .",
    "the energy error of one particle , due to one particle in the core , in one timestep would be of the order of @xmath51 , since the distance one particle moves in one timestep is @xmath52 and the force error applied during the time the particle moves is @xmath53 .",
    "thus , we have @xmath54 .",
    "the number of error terms is proportional to the number of particles in the system @xmath0 , number of particles in the core @xmath55 , and the average number of timesteps per unit time @xmath56 .",
    "thus , for one time unit , the total error would be of the order of @xmath57 here , we assumed that the errors are random and the total error is proportional to the square - root of the number of error terms .",
    "either assumption might not be correct .",
    "for example , error terms of the forces on different particles from one particle in the central region are likely to be correlated",
    ". therefore the actual error might be larger .    in the above",
    ", we assumed that the error comes only from the sampling of the acceleration .",
    "however , with hermite schemes , what we actually integrate is the high order derivatives directly calculated .",
    "thus , the actual error is probably much bigger than the estimate above . in the case of the fourth - order hermite scheme which uses the first time derivative , the derivative is of the order @xmath33 from equation ( [ eq : corejerk ] ) .",
    "therefore , the energy error of one particles is more like @xmath58 per timestep , and total error is of order of @xmath59    note that the only way , for the current individual timestep scheme , to make this error reasonably small is to shrink the timestep of _ all _ particles in the system so that the orbits of core particles are resolved . in that sense ,",
    "the behavior of the eighth - order scheme is numerically correct , and that of fourth - order scheme is not .",
    "this is probably the reason why the error increases for the fourth - order scheme .",
    "in this paper , we present sixth- and eighth - order hermite schemes to be used with individual timestep algorithm , and compared their performance with that of the fourth - order scheme .",
    "we found that these higher - order schemes do offer practical advantages .",
    "here we speculate on the merit of higher - order schemes , when used with special - purpose computers or parallel implementation of individual timestep algorithm on massively - parallel computers .",
    "one advantage of the direct calculation of higher - order derivatives in hardware is that calculation of higher - order terms can be implement with short word lengths . in the case of grape-4 @xcite or grape-6 @xcite ,",
    "the calculation of acceleration is done with 24-bit mantissa and jerk with 20-bit mantissa .",
    "similarly , it would be okay to calculate snap in 16 bits and crackle in 12 bits .",
    "thus , though the number of operation becomes large as we calculate higher - order terms , the silicon area needed does not increase much . even in the case of general - purpose programmable computers",
    "( including gpus ) , higher - order schemes have extra advantage , since the calculation of high - order terms can be done in lower precision , for example single precision .",
    "many of general - purpose cpus have extra instructions for fast single - precision operations , and gpus are much faster in single precision than in double precision .",
    "another advantage is that the number of particles integrated in one blockstep is larger for higher - order schemes .",
    "thus , we can enjoy more parallelism with higher - order schemes , resulting in higher execution efficiency for both general - purpose parallel computers and grapes .",
    "thus , the higher - order schemes are better not just in the pure operation count but also in hardware efficiency and parallel efficiency .      in section [ sec",
    ": long ] , we have seen that , for high - order schemes , timesteps of a particles in outer region of the system become short to resolve the high - frequency variation of the acceleration due to particles in the central region . in the case of low - order schemes ,",
    "such shrinking did not occur .",
    "however , as a result the energy error became very large .",
    "thus , it seems that we need to make the timestep of all particles small , as the system evolves and the core size becomes smaller .",
    "this means that the analysis of the calculation cost based on the assumption that the nearest neighbor determines the timestep @xcite is not correct .",
    "our conclusion implies that the individual timestep algorithm is not so effective as shown in @xcite , because the maximum timestep of particles is larger than that of the shortest timestep by the factor which only weakly depends on the number of particles in the system . in principle , however , we can reduce the calculation cost by assigning individual timesteps not to particles but to interactions .",
    "even when there is a small core with short orbital period , the force between two particles both far away from the core changes smoothly . strictly speaking , it is not really smooth , since the position and velocity contain the high - frequency terms .",
    "however , these high frequency terms are much smaller than that of accelerations simply because position and velocity are obtained by integrating the acceleration .",
    "thus , if we use relatively low - order schemes or the original adams - type scheme which does not use the time derivatives , we might be able to integrate the interaction between two particles far away from the core with the timestep much larger than that of core particles .",
    "we will investigate the possibility of such a scheme in future papers .",
    "we thank sverre aarseth for his lectures and discussions at mitaka on november , 2007 .",
    "k.  n.   is financially supported by research fellowship of the japan society for the promotion of science ( jsps ) for young scientists .",
    "this work was supported in part by the special coordination fund for promoting science and technology ( grape - dr project ) , from the ministry of education , culture , sports , science and technology ( mext ) of japan .",
    "we consider constructing an interpolation polynomial from acceleration , jerk and snap at time @xmath60 , @xmath61 and those at @xmath62 , @xmath63 .",
    "we define summations and differences of them as @xmath64 where @xmath65 and @xmath66 is the @xmath38th derivative of @xmath67 .",
    "coefficients of the interpolation polynomial at the midpoint @xmath68 are          the interpolation polynomial for the eighth - order integrator is constructed from @xmath72 and @xmath73 . here",
    "@xmath74 is crackle .",
    "even - order coefficients are @xmath75 and odd - order ones are @xmath76 with @xmath77 the eighth - order corrector is @xmath78          funato , y. , makino , j. , mcmillan , s. , & hut , p.  1997",
    ", the combination of theory , observations , and simulation for the dynamics of stars and star clusters in the galaxy , 23rd meeting of the iau , joint discussion 15 , 25 august 1997 , kyoto , japan , meeting abstract . , 15 ,"
  ],
  "abstract_text": [
    "<S> we present sixth- and eighth - order hermite integrators for astrophysical @xmath0-body simulations , which use the derivatives of accelerations up to second order ( _ snap _ ) and third order ( _ crackle _ ) . </S>",
    "<S> these schemes do not require previous values for the corrector , and require only one previous value to construct the predictor . </S>",
    "<S> thus , they are fairly easy to implement . </S>",
    "<S> the additional cost of the calculation of the higher order derivatives is not very high . even for the eighth - order scheme , </S>",
    "<S> the number of floating - point operations for force calculation is only about two times larger than that for traditional fourth - order hermite scheme . </S>",
    "<S> the sixth order scheme is better than the traditional fourth order scheme for most cases . </S>",
    "<S> when the required accuracy is very high , the eighth - order one is the best . </S>",
    "<S> these high - order schemes have several practical advantages . </S>",
    "<S> for example , they allow a larger number of particles to be integrated in parallel than the fourth - order scheme does , resulting in higher execution efficiency in both general - purpose parallel computers and grape systems .    </S>",
    "<S> methods : @xmath0-body simulations , stellar dynamics 95.10.ce , 98.10.+z </S>"
  ]
}