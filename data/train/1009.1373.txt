{
  "article_text": [
    "the greatest common divisor of positive integers @xmath14 and @xmath33 is denoted by @xmath34 .",
    "the goal of this section is to show the following :    [ theorem : zero discrepancy ] let @xmath16 , @xmath9 , @xmath8 , @xmath32 be positive integers with @xmath35 and @xmath36 .",
    "let @xmath37 and @xmath38 .",
    "then there exists a @xmath31 \\times [ l]}$]-uniform @xmath2 table if and only if @xmath39 and @xmath40 are greater than @xmath41 and @xmath42 is even .",
    "this is an immediate consequence of the following lemmas [ lemma : gcd ] and [ lemma : zero discrepancy ] .",
    "[ lemma : gcd ] a @xmath31 \\times [ l]}$]-uniform @xmath2 matrix is @xmath43 \\times [ \\gcd(l , n)]}$]-uniform .    let @xmath17 be a @xmath31 \\times [ l]}$]-uniform @xmath2 matrix . we will show that @xmath17 is @xmath44 \\times [ l]}$]-uniform , where @xmath37 .",
    "we get the conclusion of the lemma by repeating the same argument with rows and columns switched .    for each @xmath18",
    "\\times [ n]$ ] , the regions @xmath45 \\times [ l ] + ( i , j)$ ] and @xmath45 \\times [ l ] + ( i + k , j)$ ] have the same sum on @xmath17 , because each of them combined with @xmath46 \\times [ l ] + ( i + k ' , j)$ ] makes a @xmath3 rectangle .",
    "thus for each @xmath18 \\times [ n]$ ] , the rectangles @xmath47 \\times [ l ] + ( i + q k , j ) , \\qquad q \\in [ m / k'],\\ ] ] all have the same sum on @xmath17 . since @xmath37 , these @xmath48 rectangles cover the strip @xmath49 \\times [ l ] + ( 0 , j)$ ] without overlap .",
    "hence , @xmath50 \\times [ l ] + ( i , j ) \\bigr ) &   =    \\sum _ { q \\in [ m / k ' ] } d \\bigl ( [ k ' ] \\times [ l ] + ( i + q k , j ) \\bigr ) \\\\",
    "\\notag &   =    d ( [ m ] \\times [ l ] + ( 0 , j ) ) =    \\frac 1 k \\sum _ { r \\in [ m ] } d ( [ k ] \\times [ l ] + ( r , j ) ) .",
    "\\end{aligned}\\ ] ] since the rightmost side is a constant independent of @xmath19 by @xmath31 \\times [ l]}$]-uniformity , so is the leftmost side .",
    "thus @xmath17 is @xmath44 \\times [ l]}$]-uniform .",
    "[ lemma : zero discrepancy ] let @xmath16 and @xmath9 be positive integers , and let @xmath35 and @xmath36 be their positive divisors , respectively",
    ". then there exists a @xmath31 \\times [ l]}$]-uniform @xmath2 table if and only if @xmath8 and @xmath32 are greater than @xmath41 and @xmath51 is even .",
    "one direction is a simple generalization of ( * ? ? ?",
    "* theorem  1 ( b , c ) ) :    let @xmath17 be a @xmath31 \\times [ l]}$]-uniform @xmath2 table .",
    "it is easy to see that @xmath52 for each @xmath53 \\times [ l]}$ ] .",
    "since @xmath25 must be an integer , the second claim follows .",
    "for the first claim , assume @xmath54 for contradiction ( the case @xmath55 is similar ) .",
    "then @xmath56 \\times [ l ] ) = d ( [ 1 ] \\times [ l ] + ( 0 , 1))$ ] and hence @xmath57 , contradicting the assumption that @xmath17 is a table .    for the converse , we use the building blocks provided by the following lemma :    @xmath58    [ lemma : block q ] let @xmath59 and @xmath60 be integers and let @xmath9 be a positive multiple of @xmath32 . if @xmath61 is even , then there exists a @xmath62 \\times [ l ] }    $ ] -uniform @xmath63 matrix in which each row is a permutation of @xmath64 $ ] .",
    "a @xmath31 \\times [ l]}$]-uniform @xmath63 matrix and a @xmath44 \\times [ l]}$]-uniform @xmath65 matrix stacked vertically make a @xmath66 \\times [ l]}$]-uniform @xmath67 matrix . also , a @xmath31 \\times [ l]}$]-uniform matrix is @xmath31 \\times [ l']}$]-uniform for any multiple  @xmath40 of @xmath32 .",
    "therefore , it suffices to construct the desired matrix  @xmath68 for the cases @xmath69 , @xmath70 and @xmath71 ( figure  [ figure : construction of q ] ) .",
    "if @xmath69 , let @xmath72 if @xmath73 , then @xmath9 is odd by the assumption ; let @xmath74 if @xmath75 , let @xmath76 it is easy to verify that @xmath68 is @xmath31 \\times [ l]}$]-uniform in each case .",
    "we may assume without loss of generality that @xmath77 is even .",
    "in this case , both @xmath61 and @xmath78 are even , so by lemma  [ lemma : block q ] , there are a @xmath31 \\times [ l]}$]-uniform @xmath63 matrix @xmath68 whose rows are permutations of @xmath64 $ ] , and a @xmath79 \\times [ 1]}$]-uniform @xmath80 matrix @xmath81 whose rows are permutations of @xmath82 $ ] .",
    "define an @xmath83 matrix  @xmath84 by @xmath85 then @xmath84 is @xmath31 \\times [ l]}$]-uniform and its columns are permutations of @xmath49 $ ] . define an @xmath2 matrix @xmath17 by @xmath86 ( figure  [ figure : d is p plus t ] ) .",
    "since @xmath68 and @xmath84 are @xmath31 \\times [ l]}$]-uniform , so is @xmath17 . to see that @xmath17 is a table , suppose that @xmath87 . by and we see that @xmath88 since @xmath68 s rows are permutations ,",
    "the first and the third equation imply that @xmath89 .",
    "since @xmath81 s rows are permutations , this and the second equation imply that @xmath90 .",
    "@xmath91      \\times 9    +      \\left [      \\begin{array}{cccc }       t &       t &        t &        t      \\end{array }     \\right ] \\\\",
    "& \\arraycolsep0pt\\def\\cell#1#2{\\dimen0=1.2em\\advance\\dimen0\\arrayrulewidth\\multiply\\dimen0 by#1\\advance\\dimen0-\\arrayrulewidth\\makebox[\\dimen0]{#2}}\\footnotesize   =    \\begin{array}{|c|c|c|c|c|c|c|c| } \\hline     \\cell{1}{0 } &      \\cell{1}{4 } &      \\cell{1}{1 } &      \\cell{1}{5 } &      \\cell{1}{2 } &      \\cell{1}{6 } &      \\cell{1}{3 } &      \\cell{1}{7 } \\\\ \\hline     \\cell{1}{0 } &      \\cell{1}{4 } &      \\cell{1}{1 } &      \\cell{1}{5 } &      \\cell{1}{2 } &      \\cell{1}{6 } &      \\cell{1}{3 } &      \\cell{1}{7 } \\\\",
    "\\hline     \\cell{1}{7 } &      \\cell{1}{6 } &      \\cell{1}{5 } &      \\cell{1}{4 } &      \\cell{1}{3 } &      \\cell{1}{2 } &      \\cell{1}{1 } &      \\cell{1}{0 } \\\\",
    "\\hline     \\cell{1}{0 } &      \\cell{1}{4 } &      \\cell{1}{1 } &      \\cell{1}{5 } &      \\cell{1}{2 } &      \\cell{1}{6 } &      \\cell{1}{3 } &      \\cell{1}{7 } \\\\",
    "\\hline     \\cell{1}{0 } &      \\cell{1}{4 } &      \\cell{1}{1 } &      \\cell{1}{5 } &      \\cell{1}{2 } &      \\cell{1}{6 } &      \\cell{1}{3 } &      \\cell{1}{7 } \\\\ \\hline     \\cell{1}{7 } &      \\cell{1}{6 } &      \\cell{1}{5 } &      \\cell{1}{4 } &      \\cell{1}{3 } &      \\cell{1}{2 } &      \\cell{1}{1 } &      \\cell{1}{0 } \\\\",
    "\\hline     \\cell{1}{0 } &      \\cell{1}{4 } &      \\cell{1}{1 } &      \\cell{1}{5 } &      \\cell{1}{2 } &      \\cell{1}{6 } &      \\cell{1}{3 } &      \\cell{1}{7 } \\\\",
    "\\hline     \\cell{1}{0 } &      \\cell{1}{4 } &      \\cell{1}{1 } &      \\cell{1}{5 } &      \\cell{1}{2 } &      \\cell{1}{6 } &      \\cell{1}{3 } &      \\cell{1}{7 } \\\\",
    "\\hline     \\cell{1}{7 } &      \\cell{1}{6 } &      \\cell{1}{5 } &      \\cell{1}{4 } &      \\cell{1}{3 } &      \\cell{1}{2 } &      \\cell{1}{1 } &      \\cell{1}{0 } \\\\",
    "\\hline    \\end{array }   \\times 9 +    \\begin{array}{|c|c|c|c|c|c|c|c| } \\hline     \\cell{1}{0 } &      \\cell{1}{6 } &      \\cell{1}{0 } &      \\cell{1}{6 } &      \\cell{1}{0 } &      \\cell{1}{6 } &      \\cell{1}{0 } &      \\cell{1}{6 } \\\\ \\hline     \\cell{1}{1 } &      \\cell{1}{7 } &      \\cell{1}{1 } &      \\cell{1}{7 } &      \\cell{1}{1 } &      \\cell{1}{7 } &      \\cell{1}{1 } &      \\cell{1}{7 } \\\\",
    "\\hline     \\cell{1}{2 } &      \\cell{1}{8 } &      \\cell{1}{2 } &      \\cell{1}{8 } &      \\cell{1}{2 } &      \\cell{1}{8 } &      \\cell{1}{2 } &      \\cell{1}{8 } \\\\",
    "\\hline     \\cell{1}{3 } &      \\cell{1}{3 } &      \\cell{1}{3 } &      \\cell{1}{3 } &      \\cell{1}{3 } &      \\cell{1}{3 } &      \\cell{1}{3 } &      \\cell{1}{3 } \\\\",
    "\\hline     \\cell{1}{4 } &      \\cell{1}{4 } &      \\cell{1}{4 } &      \\cell{1}{4 } &      \\cell{1}{4 } &      \\cell{1}{4 } &      \\cell{1}{4 } &      \\cell{1}{4 } \\\\",
    "\\hline     \\cell{1}{5 } &      \\cell{1}{5 } &      \\cell{1}{5 } &      \\cell{1}{5 } &      \\cell{1}{5 } &      \\cell{1}{5 } &      \\cell{1}{5 } &      \\cell{1}{5 } \\\\",
    "\\hline     \\cell{1}{6 } &      \\cell{1}{0 } &      \\cell{1}{6 } &      \\cell{1}{0 } &      \\cell{1}{6 } &      \\cell{1}{0 } &      \\cell{1}{6 } &      \\cell{1}{0 } \\\\",
    "\\hline     \\cell{1}{7 } &      \\cell{1}{1 } &      \\cell{1}{7 } &      \\cell{1}{1 } &      \\cell{1}{7 } &      \\cell{1}{1 } &      \\cell{1}{7 } &      \\cell{1}{1 } \\\\",
    "\\hline     \\cell{1}{8 } &      \\cell{1}{2 } &      \\cell{1}{8 } &      \\cell{1}{2 } &      \\cell{1}{8 } &      \\cell{1}{2 } &      \\cell{1}{8 } &      \\cell{1}{2 } \\\\",
    "\\hline    \\end{array }   =    \\begin{array}{|c|c|c|c|c|c|c|c| } \\hline     \\cell{1}{0 } &      \\cell{1}{42 } &      \\cell{1}{9 } &      \\cell{1}{51 } &      \\cell{1}{18 } &      \\cell{1}{60 } &      \\cell{1}{27 } &      \\cell{1}{69 } \\\\ \\hline     \\cell{1}{1 } &      \\cell{1}{43 } &      \\cell{1}{10 } &      \\cell{1}{52 } &      \\cell{1}{19 } &      \\cell{1}{61 } &      \\cell{1}{28 } &      \\cell{1}{70 } \\\\",
    "\\hline     \\cell{1}{65 } &      \\cell{1}{62 } &      \\cell{1}{47 } &      \\cell{1}{44 } &      \\cell{1}{29 } &      \\cell{1}{26 } &      \\cell{1}{11 } &      \\cell{1}{8 } \\\\",
    "\\hline     \\cell{1}{3 } &      \\cell{1}{39 } &      \\cell{1}{12 } &      \\cell{1}{48 } &      \\cell{1}{21 } &      \\cell{1}{57 } &      \\cell{1}{30 } &      \\cell{1}{66 } \\\\",
    "\\hline     \\cell{1}{4 } &      \\cell{1}{40 } &      \\cell{1}{13 } &      \\cell{1}{49 } &      \\cell{1}{22 } &      \\cell{1}{58 } &      \\cell{1}{31 } &      \\cell{1}{67 } \\\\",
    "\\hline     \\cell{1}{68 } &      \\cell{1}{59 } &      \\cell{1}{50 } &      \\cell{1}{41 } &      \\cell{1}{32 } &      \\cell{1}{23 } &      \\cell{1}{14 } &      \\cell{1}{5 } \\\\",
    "\\hline     \\cell{1}{6 } &      \\cell{1}{36 } &      \\cell{1}{15 } &      \\cell{1}{45 } &      \\cell{1}{24 } &      \\cell{1}{54 } &      \\cell{1}{33 } &      \\cell{1}{63 } \\\\",
    "\\hline     \\cell{1}{7 } &      \\cell{1}{37 } &      \\cell{1}{16 } &      \\cell{1}{46 } &      \\cell{1}{25 } &      \\cell{1}{55 } &      \\cell{1}{34 } &      \\cell{1}{64 } \\\\",
    "\\hline     \\cell{1}{71 } &      \\cell{1}{56 } &      \\cell{1}{53 } &      \\cell{1}{38 } &      \\cell{1}{35 } &      \\cell{1}{20 } &      \\cell{1}{17 } &      \\cell{1}{2 } \\\\ \\hline    \\end{array}\\end{aligned}\\ ] ]    in the above , we constructed the uniform table as a linear combination of two uniform matrices with smaller entries .",
    "this idea is due to euler  @xcite who gave a construction of a semimagic square ( that is , a @xmath92 \\times [ n ] } \\cup \\overline{[n ] \\times [ 1]})$]-uniform @xmath4 table ) from a pair of special @xmath92 \\times [ n ] } \\cup \\overline{[n ] \\times [ 1]})$]-uniform matrices called _ latin squares_.",
    "in this section , we confine ourselves , as asano et al .",
    "@xcite did , to the case where @xmath93 and @xmath94 .",
    "theorem  [ theorem : zero discrepancy ] states that in this case a uniform table exists if and only if @xmath9 is even . for odd @xmath9 s",
    ", they construct a table with discrepancy @xmath95 , and conjecture that it is the smallest possible .",
    "this is refuted by our figures [ figure : counterexample ] and [ figure : thirty - one ] .",
    "figure  [ figure : counterexample ] was discovered by an exhaustive search .",
    "we describe briefly how figure  [ figure : thirty - one ] was obtained .",
    "let @xmath99 , @xmath100 $ ] and define @xmath101 ^2 \\to [ 0 , 1 ] ^2 $ ] by @xmath102 let @xmath103 be the @xmath4 table whose @xmath19th entry is the rank of @xmath104 ( with some tie - breaking rule ) : @xmath105 ^2      :     \\ ; &        f \\bigl ( s ( i ' , j ' ) \\bigr ) < f \\bigl ( s ( i , j ) \\bigr )        \\ \\text{or } \\   \\\\",
    "\\notag &       \\bigl (          f \\bigl ( s ( i ' , j ' ) \\bigr ) = f \\bigl ( s ( i , j ) \\bigr )         \\ \\text{and } \\",
    "n i ' + j ' < n i + j       \\bigr )     \\,\\bigr\\ }     \\bigr\\rvert.\\end{aligned}\\ ] ] finally , define the desired matrix  @xmath17 by @xmath106 figure  [ figure : thirty - one ] was obtained by this method with @xmath107 and @xmath108 .    to see intuitively why @xmath17 has small discrepancy , note that a @xmath109 region in @xmath17 corresponds to the region in @xmath103 ( or its translate ) shown in figure  [ figure : distant domino pair ] .",
    "these four cells are mapped by @xmath110 to two nearby points @xmath111 and another two points @xmath112 ( the coordinates are modulo @xmath41 ) . since @xmath113 ,",
    "the sum of the values of @xmath114 at these four points is almost zero .",
    "thus , assuming that taking the ranks does not distort the distribution of values too much , we can expect that @xmath17 has low discrepancy .",
    "we add the displacement @xmath115 in in order to reduce the chance of ties in the ranking which seem to work adversely .",
    "as aronov et al .",
    "@xcite point out , our problem is analogous to a common situation in discrete geometry where we try to arrange discrete objects so that they look close to some `` balanced '' continuous distribution .",
    "the constraint peculiar to our problem is that we have to use each number in @xmath30 $ ] exactly once .",
    "the ranking technique used here may be applicable to other problems with this constraint .",
    "however , analyzing its performance seems to be hard : although our computer experiment for several @xmath9 s suggests that the above method achieves sublinear @xmath109 discrepancy , we have no proof yet .",
    "the author thanks tomoko adachi , tetsuo asano , tsukasa kuribayashi , yasuko matsui , shao - chin sung , hideki tsuiki , ryuhei uehara and the referees for helpful comments and discussions .",
    "this work was supported in part by the nakajima foundation and the natural sciences and engineering research council of canada .",
    "an earlier version was presented at the eighth japan - korea joint workshop on algorithms and computation ( waac 2005 ) .    1 b.  aronov , t.  asano , y.  kikuchi , s.c .",
    "nandy , s.  sasahara , and t.  uno .",
    "a generalization of magic squares with applications to digital halftoning .",
    "42(2 ) , pp.143156 , 2008 . t.  asano , s.  choe , s.  hashima , y.  kikuchi , and s .- c . sung .",
    "distributing distinct integers uniformly over a square matrix with application to digital halftoning .",
    "information processing society of japan ( ipsj ) sig technical report al-100 , 2005(26 ) , pp.7986 , 2005 . l.  euler",
    ". de quadratis magicis .",
    "_ commentationes arithmeticae _ 2 , pp.593602 , 1849 .",
    "presented to the st .",
    "petersburg academy in 1776 ."
  ],
  "abstract_text": [
    "<S> completing aronov et  al.s study on zero - discrepancy matrices for digital halftoning , we determine all @xmath0 for which it is possible to put @xmath1 consecutive integers on an @xmath2 board ( with wrap - around ) so that each @xmath3 region has the same sum . for one of the cases where this is impossible , we give a heuristic method to find a matrix with small discrepancy .    </S>",
    "<S> a _ semimagic square _ is a square matrix whose entries are consecutive integers and which has equal row and column sums . </S>",
    "<S> one way to generalize this millennia - old concept is to specify the sums on regions other than rows and columns . </S>",
    "<S> ingenious constructions of squares satisfying various sum constraints have been described by many professional and amateur mathematicians . while most of them are interested in adding more and more constraints to make their squares impressive , one can generally consider sum conditions on any set of regions .    </S>",
    "<S> aronov et al .  </S>",
    "<S> @xcite took up this problem for square regions : is there an @xmath4 matrix with entries @xmath5 ,  </S>",
    "<S> , @xmath6 such that every @xmath7 region has the same sum ? </S>",
    "<S> it is amusing to note that this variant of the classical problem is motivated by an engineering question of finding good dither matrices for _ digital halftoning _ , a method to approximate a continuous - tone image by a binary image for printing ( see their paper for details ) . </S>",
    "<S> they showed  ( * ? ? ? * theorem  1 ) , using what they call _ constant - gap matrices _ , that the answer is yes if @xmath8 and @xmath9 are even or if @xmath9 is an integer power of @xmath8 , and no if @xmath8 and @xmath9 are relatively prime or if @xmath8 is odd and @xmath9 is even </S>",
    "<S> . we will solve this problem completely by determining all @xmath10 for which such matrices exist ( section  [ section : uniform ] ) . </S>",
    "<S> our construction of the matrices is much simpler even for the cases that have already been settled positively . </S>",
    "<S> we also give counterexamples to asano et al.s conjecture on the smallest possible discrepancy when @xmath9 is odd and @xmath11 ( section  [ section : low discrepancy ] ) .      for a positive integer  @xmath12 </S>",
    "<S> , we write @xmath13 = \\{0 , 1 , \\dots , n - 1\\}$ ] . </S>",
    "<S> the remainder when an integer  @xmath14 is divided by @xmath12 belongs to @xmath13 $ ] and is denoted by @xmath15 .    </S>",
    "<S> we consider the slightly generalized setting where the matrices and regions are rectangles instead of squares . </S>",
    "<S> let @xmath16 and @xmath9 be positive integers . for an @xmath2 matrix  @xmath17 and index @xmath18 \\times [ n]$ ] , </S>",
    "<S> we denote the @xmath19th entry of @xmath17 by @xmath20 . </S>",
    "<S> any set @xmath21 \\times [ n]$ ] of indices is called a _ region_. the sum of the numbers on @xmath22 is denoted by @xmath23 . </S>",
    "<S> the _ discrepancy _ of @xmath17 with respect to a set  @xmath24 of regions is the difference between the maximum and minimum @xmath25 as @xmath22 varies in @xmath24 . </S>",
    "<S> when it is zero , @xmath17 is said to be _ </S>",
    "<S> @xmath24-uniform_.    the translate of @xmath22 by @xmath26 </S>",
    "<S> is denoted by @xmath27 \\times [ n].\\ ] ] the set of all translates of @xmath22 is denoted by @xmath28 .    </S>",
    "<S> @xmath29 }    \\begin{array}{|c|c|c|c|c| } \\hline     \\cell{14 } & \\cell{1 } & \\cell{21 } & \\cell{0 } & \\cell{18 } \\\\ </S>",
    "<S> \\hline     \\cell{16 } & \\cell{13 } & \\cell{9 } & \\cell{22 } & \\cell{4 } \\\\ \\hline     \\cell{5 } & \\cell{17 } & \\cell{12 } & \\cell{7 } & \\cell{19 } \\\\ \\hline     \\cell{20 } & \\cell{2 } & \\cell{15 } & \\cell{11 } & \\cell{8 } \\\\ \\hline     \\cell{6 } & \\cell{24 } & \\cell{3 } & \\cell{23 } & \\cell{10 } \\\\ \\hline    \\end{array}\\ ] ]    by an @xmath2 _ table _ we mean an @xmath2 matrix in which each element of @xmath30 $ ] appears exactly once . </S>",
    "<S> we are interested in tables with small ( or zero ) discrepancy with respect to @xmath31 \\times [ l]}$ ] , the set of all @xmath8-by-@xmath32 rectangles ( figure  [ figure : counterexample ] ) . </S>"
  ]
}