{
  "article_text": [
    "a complete description of an isolated system at energy @xmath0 is given by the phase space volume , @xmath1 where @xmath2 are @xmath3-dimensional vectors stating the positions and momenta , respectively , of the @xmath4 particles , @xmath5 the heaviside step function , @xmath6 planck s constant and @xmath7 the hamiltonian .",
    "through this quantity  or the closely related density of states ( dos ) @xmath8the connection with the entropy of classical thermodynamics is established as one of @xmath9 ( hertz definition ) or @xmath10 ( planck definition ) .",
    "these two definitions are not mathematically equivalent and , as pointed out and discussed by dunkel and hilbert ( see ref . and references cited therein ) , there is disagreement in the literature as to which one is correct . however , these two definitions become _ numerically _ the same for large systems . indeed",
    ", if the system is great enough in the number of its degrees of freedom , fluctuations in its kinetic energy will be vanishingly small , the potential energy distribution will be boltzmannian and the system can be said to be at equilibrium at constant temperature , which is a desirable situation as it can be reproduced more readily in reality , for which the systems studied are generally large in this sense .",
    "unfortunately , the size of systems that can be investigated by computer simulation may still be far from adequately approaching this limit .",
    "the most common solution to this problem of size is to couple the system , in the mathematical sense , to an infinitely large heat reservoir at constant temperature , thereby creating a formally infinite system .",
    "this system is governed by the canonical partition function ( cpf ) , which can be expressed as @xmath11 where @xmath12 is the lowest possible energy , @xmath13 boltzmann s constant , and @xmath14 the absolute temperature .",
    "this , or a mathematically equivalent , route to the cpf has been exploited in numerical methods such as the reference system equilibration ( rse ) method @xcite , the histogramming @xcite and multihistogram @xcite methods , the histogram reweighting method @xcite , the wang - landau ( wl ) sampling @xcite , multicanonical methods @xcite , transition matrix methods @xcite or the nested sampling ( ns ) algorithm @xcite .",
    "the cpf is directly related to the free energy by @xmath15 and thus knowledge of it enables one to compute the temperature or volume , @xmath16 , dependence of any desired thermodynamic property . because the integrand @xmath17 is a sharply peaked function in @xmath0 , it is numerically an easier task to obtain the partition function at a specific temperature than to obtain the complete dos .",
    "if one is interested in free energies only at one or a few specific temperatures , _ especially _ low ones , direct methods @xcite to the free energy , _ i. e. _ the cpf at pre - defined temperature , will always be more efficient , simply because they have a smaller region of integration about which to worry .",
    "the dos approach , on the other hand , is more powerful when a range of temperatures is of interest , especially in systems or models where the cpf has no volume dependence , _ e. g. _ lattice models .",
    "the width of the temperature interval of interest implicitly defines the width of corresponding energy interval @xmath18 $ ] that one needs to consider in a numerical search for @xmath19 .",
    "however , for continuous potentials , @xmath19 approaches the known dos of the ideal gas at high @xmath0 , as the kinetic energy contributions will dominate the potential energy ones . in these cases ,",
    "@xmath20 can be defined independently of any temperature .    in the wl method , originally developed for model lattice systems but generalized to continuous hamiltonians by later authors @xcite , the dos is computed through a random walk subject to importance sampling whose weights are iteratively adjusted in an attempt to make all energies equiprobable .",
    "the weights that achieve this are reciprocal to the dos .",
    "the precision by which the weights are adjusted is iteratively increased until desired precision is reached .",
    "the main drawback of the method is that the statistics to estimate the convergence of the weight update factors needs to be gathered anew between each update of the precision , leading in some sense to a `` duplication of efforts . ''",
    "a great wealth of literature has sprung up around the wl method , and its extensions @xcite , and so it is widely known and recognized .",
    "therefore , we shall make use of it for comparison purposes with the perturbation calculations .    in the ns method , efficacy is achieved by having the random walk subject to a weight function that acts on a non - uniform distribution of energy segments , concentrating on the low energy regions .",
    "the limits of each energy segment are calculated `` on the fly , '' starting from high energies and proceeding downwards by cutting the lower segments in two .",
    "the limits are set from the condition that the probability of encountering a configuration belonging to a given segment be equal to a predetermined function of the depth of that segment in the partitioning tree .",
    "once a limit is found , it stays fixed and is never subject to reevaluation .",
    "this removes the `` duplication of efforts '' of the wl algorithm .",
    "the most problematic case for this algorithm is for potentials that exhibit large regions of infinite energy , as in for instance the square - well fluid , because then the energy partitioning scheme can not be gradual .",
    "there is hence no benefit in using the simplification of the hard molecular core with this method .    in the rse method , on the other hand ,",
    "the system is coupled to a finite heat bath with which it is allowed to exchange energy .",
    "the dos of the heat bath is presumed known .",
    "the combined system is evolved according to the microcanonical probability distribution and the probability of the system of having different energies @xmath21 is histogrammatically tracked and related , up to an @xmath22-dependent factor , to the sought system dos .",
    "the main drawback is that the factor can only be calculated precisely for very low energy and smooth potentials , and good statistics is only obtained in a narrow range of @xmath0 below @xmath22 , meaning in practice that several simulations at different @xmath22 have to be run . by careful considerations of the continuity of the dos",
    ", the @xmath22-dependent factor may be extrapolated to higher energies in the end .    in this paper",
    ", we shall investigate an alternative method : a route to obtaining @xmath19 assuming , like the rse method , that the dos of a different system is known . unlike the rse method , however , the idea is that the other system is also similar , and thus knowledge of its dos is able to speed up the calculation by focusing on the difference between the two systems .",
    "this lessens the need for importance sampling ; in essence , the one system is used to sample the important regions of the other system , because these regions are supposedly shared to a large extent because of systemic similarity .",
    "we shall develop the method in the next section , and after that examine some simple numerical examples of its use .",
    "consider two systems , for simplicity labeled as @xmath23 and @xmath24 , for which the dos are @xmath25 ( known ) and @xmath26 ( sought ) .",
    "classical microcanonical sampling of either of these systems can be carried out efficiently if the potential energy depends on the configuration only . under this restriction ,",
    "one simulates a markov process in configuration space using the acceptance probability @xcite , @xmath27 if @xmath28 and zero otherwise , where @xmath29 and @xmath30 denote the potential energies before and after , respectively , an unbiased trial move in configuration space .",
    "this equation represents the ratio between the densities of the kinetic energy states for a @xmath31-dimensional configuration space with @xmath4 molecules , and is the proper weight function to use for the microcanonical ensemble where all accessible states are considered equiprobable .",
    "let us now suppose that systems @xmath23 and @xmath24 are `` similar '' in the sense that they share the same configuration space .",
    "then system @xmath24 , differing only by its potential energy expression , can be viewed as the result of a perturbation on system @xmath23 .",
    "for instance , let us define the generalized hamiltonian , @xmath32 where @xmath33 is the perturbation depending on @xmath34 only , and @xmath35 an interpolating factor between the reference ( @xmath36 ) and fully perturbed ( @xmath37 ) system .",
    "correspondingly , we may define @xmath38 according to eq .",
    "( [ eq : phasevol ] ) after inserting eq .",
    "( [ eq : ham ] ) .",
    "let us now consider the superensemble that includes @xmath35 as an extra coordinate .",
    "tentatively , we write its phase space volume as , @xmath39 where @xmath40 is a formal mass associated with the @xmath35-motion and @xmath41 is a dummy variable of integration for the formal momentum of this motion .",
    "the total energy of this ensemble is @xmath42 which is different from the regular total energy @xmath0 because it also contains a kinetic contribution @xmath43 in addition to that of the regular coordinates .",
    "therefore , we consider instead the _ constrained _ superensemble , whose phase space volume is @xmath44 for which @xmath45 , and so @xmath46 as required .",
    "we then take the derivative with respect to @xmath0 and obtain the constrained dos of the superensemble , @xmath47 because the weighting factor of this integral is @xmath35-independent , the acceptance probability of each state is still only proportional to the density of its kinetic energy states , and we see that the random walk also along the @xmath35-coordinate should be governed by an unmodified eq .",
    "( [ eq : acc ] ) .",
    "we now define an `` equilibrium constant '' @xmath48 as the ratio between the number of cycles the markov chain sampling the constrained superensemble visits system @xmath49 to the number of cycles it visits system @xmath50 .",
    "the existence of this equilibrium constant is guaranteed by the detailed balance condition that the markov chain fulfills . from the direct proportionality between the microcanonical probability and the dos it follows that @xmath51 where @xmath52 is the acceptance probability for changing from @xmath53 to @xmath49 , and @xmath54 denotes a microcanonical ensemble average over the system @xmath55 .",
    "the last equality follows from the flux balance at equilibrium : to wit that the gross flux between two states , given by the product of the acceptance probability and the occupation probability , is equal but of opposing sign in the reverse directions , _",
    "i.  e. _ , @xmath56 where @xmath29 and @xmath57 denote the potential energies of two states defined by any two arbitrary sets of the non - momentum coordinates of the hamiltonian ; in the argument to follow , we restrict our attention to when @xmath58 and @xmath59 correspond to @xmath60 and @xmath61 , irrespective of @xmath34 . the quantity @xmath62 is proportional to the kinetic energy dos , and because the configuration space is sampled subject to this bias , it is thus also proportional to the probability of being in a state of potential energy @xmath63 .",
    "the probability of being in any spatial configuration with @xmath53 is proportional to @xmath64 .",
    "let us therefore divide eq .",
    "( [ eq : balance ] ) by @xmath65 and integrate over the spatial dimensions , @xmath66 we now identify the microcanonical ensemble average of @xmath67 on each side as , @xmath68 and then obtain eq .",
    "( [ eq : equconst ] ) after rearrangement .",
    "it is at this point appropriate to stress that in the case when @xmath69 , eq .",
    "( [ eq : equconst ] ) does not hold and the algorithm , as here outlined , is not applicable .",
    "such is the case of a single particle ( @xmath70 ) confined to two spatial dimensions ( @xmath71 ) ; it is never the case in three spatial dimensions ( @xmath72 ) .",
    "excepting that special case , we have that @xmath73 and it is from this relation that @xmath26 may be extracted , if @xmath25 is known , in addition to the ratio @xmath74 which is always obtained . the method outlined",
    "may be regarded as a special case of bennett s method @xcite , but applied to the microcanonical ensemble . alternatively ,",
    "if one does not sample the transition probabilities , but instead propagates the system between the two states , it may also be regarded as a case of the expanded ensemble method @xcite applied to the microcanonical ensemble ; this , however , is a line of attack which we shall not pursue .",
    "implicit in the derivation so far is that the minimum value of the potential energy expression is to be independent of @xmath35 .",
    "in other words , the `` potential energy '' of a configuration @xmath75 is to be understood as the potential energy _ difference _ with respect to the global potential minimum over @xmath34 keeping @xmath35 constant .",
    "this follows from eq .",
    "( [ eq : balance ] ) ( unless we make @xmath67 explicitly @xmath35-dependent ) and the following argument . in eq .",
    "( [ eq : balance ] ) , the quantity @xmath76 is the kinetic energy .",
    "let us say that the maximum kinetic energy is @xmath0 , obtained when @xmath77 , the minimum potential energy . as the @xmath35-coordinate does not affect the kinetic energy",
    ", the potential energy @xmath77 should correspond to the maximum kinetic energy @xmath0 regardless of the value of @xmath35 .",
    "this does not restrict the method in any formal sense but it may pose a practical hurdle for very complicated hamiltonians for which energy minimization is difficult .",
    "this is especially true if several intermediate @xmath35-values are considered over a chain of gradual perturbations , if these affect the energy minimum in a non - trivial way .      in the simplest case ,",
    "one considers only two systems : reference ( system 0 ) and perturbed system ( system @xmath35 , where @xmath35 indicates the degree of perturbation ) .",
    "given a starting configuration @xmath78 in the phase space of system 0 with the potential energy @xmath29 , the algorithm may be outlined as follows when broken down into its elementary steps .    1 .",
    "generate uniform random number @xmath79 $ ] .",
    "2 .   if @xmath80 , go to step [ item : step ] .",
    "3 .   generate random configuration @xmath81 by random displacement from @xmath78 .",
    "4 .   calculate the energy @xmath30 of @xmath81 .",
    "5 .   generate uniform random number @xmath82 $ ] .",
    "if @xmath83 by eq .",
    "[ [ eq : acc ] ] , let @xmath84 . 7 .",
    "iterate from step 1",
    "[ item : step ] calculate the energy @xmath85 of perturbed system in configuration @xmath78 .",
    "calculate @xmath86 and accumulate average @xmath87 .",
    "are averages converged ?",
    "if not , iterate from step 1 .    here",
    "@xmath88 $ ] is an arbitrary constant that decides the priority among the computer cycles for either propagating the microcanonical system , to insure that the average acceptance probabilities sampled come from more or less uncorrelated points , or sampling the actual averages , to insure they get sufficient statistics . in general ,",
    "the same steps have to be carried out also for system @xmath35 on system 0 , but in some specific cases ( as we shall see below ) this is not necessary , because @xmath89 in these cases .",
    "when one runs the algorithm on many systems , as when one considers gradual perturbations , or for many discrete @xmath0-values , it is natural to run them in parallel for maximum efficacy .",
    "the convergence and accuracy of the proposed method hinge on the accuracy in the ensemble averages @xmath90 and @xmath91 .",
    "since obviously both @xmath92 and @xmath93 hold for all @xmath0 and are thus without statistical uncertainty in this limit , it is certain to state that for any system sufficiently close to the reference system , the perturbation calculations will always be superior to direct methods . in this paper , for the most part convergence has been deemed to have been achieved when @xmath94 differs by less than an amount @xmath95 from its previous value calculated a fixed number of cycles earlier . a more stringent alternative that leaves less room for apparent convergence by chance , and thus a more efficient simulation ,",
    "would be to require that the estimated standard error of each individual average is below some threshold , but the simple convergence criterion has proven satisfactory in the cases considered .",
    "in principle , any two hamiltonians for which we can calculate the requisite ensemble averages @xmath96 and @xmath97 can be used in this method .",
    "the algorithm hence does not pose any greater programming challenges than that of regular metropolis monte carlo techniques . here",
    "we shall consider two primary cases : the square - well fluid and a class of anharmonic einstein crystals ; and one secondary example : the vapor pressure of liquid gold .",
    "the simplicity of the einstein crystal is motivated by a desire to keep the computational demands low as repeated comparisons with other methods quickly become prohibitively expensive otherwise ; the generalization to more degrees of freedom is trivial in all other respects .",
    "the square - well fluid , on the other hand , presents an interesting test case in that appreciable regions of its configuration space are of infinite potential energy .",
    "last but not least , the simplicity of the primary numerical examples makes it easier to gauge the correct behavior to be exhibited by the calculation .",
    "nevertheless , the example calculation of the vapor pressure of gold illustrates the general applicability of the method .",
    "except for the calculations on gold ( see section  [ sec : gold ] ) , all of the numerical examples to be presented have been compiled using the gnu c compiler ( version 4.4.3 ) with its intrinsic random number generator and executed on a single 2 ghz core of the author s `` intel core 2 duo '' laptop computer .",
    "memory demands of the calculations are all insignificant",
    ".      we will investigate in this section some simple numerical test cases on a class of anharmonic einstein crystals . by this we mean three - dimensional crystals for which the cpf of @xmath4 molecules can be written @xmath98 , where @xmath99 is the partition function of a single @xmath31-dimensional oscillator with @xmath100 being the spatial ( not the phase space ) dimensionality .",
    "the anharmonic systems studied were governed by the potential energy expression @xmath101 where the term @xmath102 is the perturbation and @xmath103 the displacement from equilibrium .",
    "let us first consider the case when @xmath104 , because it is the simplest .",
    "the natural reference system to use when approaching the anharmonic einstein crystal is that of the harmonic einstein crystal since @xmath99 for an harmonic oscillator is known analytically : its ( classical ) dos , @xmath105 is independent of energy . in this equation",
    ", @xmath106 is the mass and @xmath107 the force constant .",
    "visual inspection ( figure [ fig : dos ] ) reveals that the logarithms of the resulting dos are quasi - linear in energy with a constant of proportionality directly proportional to @xmath35 .",
    "the vapor is assumed ideal , so that the vapor pressure is given by ( assuming one - dimensional @xmath108 ) , @xmath109 where @xmath110 is the thermal de broglie wavelength .",
    "this equation is derived from the equality between the chemical potentials of the gas and crystal phases in the limit of @xmath111 .",
    "the results of these calculations are shown in figure [ fig : vap ] plotted against temperature .",
    "they are useful as a `` yardstick '' of how large the perturbations considered here are in relation to real systems .    ) for @xmath112 given with respect to the @xmath113 reference dos in one spatial dimension . ]",
    "let us now briefly consider the case when @xmath72 .",
    "the dos of the reference system is then @xmath0-dependent , @xmath114 the calculated dos as a function of energy are shown in figure  [ fig : dos2 ] .",
    "the most striking thing about this calculation is the much quicker convergence times for @xmath72 than for @xmath104 .",
    "the reason is that only one ensemble average has to be sampled in this case , namely @xmath115 , @xmath116 being unity for all @xmath0 and this holds also for @xmath117 .",
    "not only does this bring about a two - fold speed increase because of the reduced workload , but also the statistical uncertainty in the ratio between the two averages is reduced : both because only one average now has statistical uncertainty and also because the individual terms of this average are all non - zero , whereas in the one - dimensional case some terms in the averaging were strictly zero , leading to very oscillatory terms .",
    "the net effect is a quicker convergence and will be quantitatively assessed below .    ) for @xmath112 ( arbitrary units ) in three spatial dimensions . ]",
    "we now turn to a comparison with the wl algorithm in terms of accuracy and speed of convergence . in the discussion to follow ,",
    "the dos has been restricted to 17 energy grid points , spaced @xmath118 units apart .",
    "the maximum random displacement in @xmath103 was @xmath119 for both the wl sampling and perturbation calculations for @xmath104 and @xmath120 for @xmath72 .",
    "for the wl sampling , also the random walk in momentum space used this maximum displacement with the mass taken to be unity . to combat boundary artifacts in the wl simulations , the update rule of schulz _ et al . _",
    "@xcite was employed .",
    "the perturbation calculations do not suffer from any boundary artifacts .    as an objective measure of the convergence",
    ", we calculate the mean deviation of the numerical energy derivative @xmath121 from that of the `` exact '' dos .",
    "when calculating the error of the wl sampling , the `` exact '' dos used for reference has been calculated by long runs of the perturbation method ; likewise , when calculating the error of the perturbation method , the comparison is made with respect to the dos that has been calculated by long runs of the wl sampling .",
    "running shorter simulations with either the perturbation or wl method allows these partially converged results to be compared against the reference curve produced by the other method and used as an indication of the level of convergence attained .",
    "the results of these comparisons are given in figures  [ fig : comp3 ] , [ fig : comp ] and [ fig : comp2 ] .",
    "the absolute values of @xmath122 can not be compared directly as the wl sampling does only provide @xmath123 up to an undetermined multiplicative constant that is unique to each run .    as a check",
    ", the results of these two methods have been found to agree roughly up to the second decimal place in @xmath124 on average for @xmath72 but for @xmath104 , a higher degree of agreement between the two methods is not a problem . to analyze the source of this discrepancy  which on the face of it would seem to indicate that at least one of the algorithms exhibits convergence difficulties to the exact result  we note that whereas the perturbation calculation yields @xmath19 at discrete energy grid points @xmath125 , the wl sampling rather calculates the average @xmath126 over intervals @xmath127 centered on each @xmath128 .",
    "the numerical , finite - difference derivatives do hence not agree between the two methods , unless @xmath19 happens to be a linear or nearly linear function . in any case , this level of accuracy is sufficient for our purposes as it clearly allows us to judge which method is faster .    for the perturbation method ,",
    "there is in principle the question of what the optimal distribution of labor is between sampling the averages required to calculate the ratio of the dos , and how often one propagates the microcanonical markov chains .",
    "no claim is made that the division , of ( 80% probability ) propagating the microcanonical markov chain and ( 20% probability ) sampling averages , employed in this comparison is optimal .",
    "it is outside the scope of this work to provide a detailed analysis of this optimum , or of the influence of step size , acceptance rates and so on .",
    "we note that similar issues are also present for the wl algorithm as , indeed , the rate and reliability of convergence of the wl algorithm has been the subject of much discussion in the literature . in fact , the measure of convergence as originally proposed may lead to convergence difficulties @xcite . indeed , for the case @xmath104 , when run using the requirement that the histogram should be `` flat '' , the wl algorithm is noticeably slower and does not achieve a smooth curve as reliably as the perturbation method ( data not shown ) .    however , if one instead employs the convergence criterion for the wl sampling that was suggested by morozov and lin @xcite where , rather than enforce strict `` flatness '' of the sampled histogram",
    ", we require a minimum number of `` visits '' for each histogram entry before updating the wl precision factor , the wl sampling  still for @xmath104is _ quicker _ than the perturbation method . the convergence according to this criterion",
    "was tested every @xmath129:th cycle and the required minimum number of visits was @xmath130 for the @xmath58:th iteration of the wl sampling . in this equation @xmath131",
    "is the multiplicative precision factor used by the wl algorithm in adjusting the estimate of the dos . in this implementation , it is given by @xmath132 , with @xmath133 . in this comparison",
    "the wl algorithm was initiated from the flat dos of the harmonic oscillator , and so benefits to the exact same extent as the perturbation method from the similarity between the two systems .",
    "let us now comment on the case when @xmath72 . in this case , we find the opposite results as compared to the one - dimensional case in terms of the rate of convergence , namely that the perturbation method is quicker than the wl algorithm , even in the long run .",
    "for a perfectly fair comparison , the convergence of the wl sampling has also been investigated when the algorithm is initialized from the reciprocal of eq .",
    "( [ eq : dos3d ] ) , instead of from a `` blank slate '' . as can be seen in figures  [ fig : comp ] and  [ fig : comp2 ] , the effect is small , within the error bars and mainly confined to the early cycles .",
    "this means that initializing the wl sampling from the dos of the reference system is not a viable alternative to the actual perturbation method .    ) as a function of number of monte carlo cycles ( normalized per number of energy grid points ) from runs of the one - dimensional anharmonic oscillator with @xmath134 and 17 energy grid points . in the graph , the number of monte carlo cycles reported for the perturbation calculations is the actual number times two to correct for that in each cycle two ensemble averages are sampled .",
    "error bars represent standard deviations from three independent runs . ]    ) as a function of the number of monte carlo cycles ( normalized per number of energy grid points ) for the three - dimensional anharmonic oscillator with @xmath135 and 17 energy grid points .",
    "the qualifiers of `` guided '' and `` unguided '' , respectively , denote whether the wl sampling was initialized from the reciprocal dos of the reference state or a `` blank slate '' .",
    "the apparent limiting error reflects the disagreement in the second decimal place about what the limiting average of @xmath136 is according to the two methods .",
    "see text for details . ]",
    "but for @xmath137 . ]",
    "in this numerical example , we consider the square - well fluid as a perturbation of its hard - sphere analog .",
    "the dos of the hard - sphere gas obeys the form @xmath138 , where @xmath139 is an unknown function of the number of particles and volume .",
    "our ignorance of the precise form of this constant of proportionality means that only the ratio between the dos will be possible to provide completely .",
    "this , in turn , means that we can not compute , for instance , the phase diagram of the square - well fluid , but only properties at constant @xmath4 and @xmath16 .",
    "a prime example of such a property is the constant - volume heat capacity .",
    "the unit of energy and temperature that we will use for the remainder of this section is the magnitude of the pair potential at unit distance and @xmath37 .",
    "the unit of length is the hard - core diameter .    to be precise",
    ", the reference system interacts through the pair potential @xmath140 where @xmath141 denotes the intermolecular separation .",
    "the perturbation we introduce is @xmath142 so that the total pair interaction is written @xmath143 for our chosen combination of systems , with the common energy zero - level , transitions from the perturbed system to the reference are always accepted , which means that @xmath144 and so there is , unlike in the previous section , no need to consider two ensembles explicitly .",
    "thus , only configurations of the reference hard - sphere system have to be generated , and furthermore , these configurations are independent of @xmath0 so that all averages @xmath115 can be sampled simultaneously for a given density . in the calculations to follow ,",
    "a random 95% of the monte carlo cycles consisted of propagating the microcanonical markov chain and the remaining 5% of accumulating averages .",
    "we let @xmath145 , an arbitrary choice based purely on aesthetic appeal : it is the lattice constant of the close - packed cubic crystal .",
    "for this system , the energy minimum is @xmath146 for 14 molecules .",
    "thus , we consider the total energy expression , @xmath147 whose zero - level is independent of @xmath35 . in the preceding equation , @xmath148 is the ordered set of all pairwise distances between the fourteen molecules . to satisfy the requirements of the microcanonical ensemble ,",
    "we introduce the constraint that the cluster is confined to a fixed spherical volume , arbitrarily chosen to be either @xmath149 , _",
    "i. e. _ corresponding to a radius of @xmath150 , and a volume fraction of @xmath151 ( `` low density '' ) ; or @xmath152 , corresponding to a radius of @xmath153 , and a volume fraction of @xmath154 ( `` low - medium density '' ) ; or @xmath155 , corresponding to a radius of @xmath156 and a volume fraction of @xmath157 ( `` high density '' ) .    for the propagation of the hard - core markov chain",
    ", one molecule was moved at a time . at the volume fraction of @xmath151 ,",
    "the displacement step was @xmath158 ; at the volume fraction of @xmath154 , it was @xmath120 ; and at the volume fraction of @xmath157 , it was @xmath159 .",
    "these displacements led to acceptance rates of 51% , 54% and 52% , respectively .",
    "the dos was sampled in energy intervals of @xmath160 , starting at @xmath161 for the low - medium density and covering the higher energies in batches of 60 grid points .",
    "the calculations proceeded for at least @xmath162 cycles , which on the author s machine took a little less than 3 minutes of real time for all 60 energy points sampled at once on a single processor core , but considerably longer runs were found necessary to achieve the same level of high convergence in the lowest energy regions , where up to 20 minutes could be necessary .",
    "a refined attack would distribute the energy grid unequally over the energy range .        ) . ]",
    "one interesting aspect of the way we have defined the perturbation in @xmath35 is the self - similarity that arises .",
    "consider @xmath163 , where @xmath164 is any point along the @xmath35-axis .",
    "this quantity is given by , @xmath165 because @xmath166 in this system .",
    "but , @xmath167 therefore , we have the self - similarity relation , @xmath168 we see through this formula when we take the limit @xmath169 that @xmath170 , when @xmath171 .",
    "an indication that the computer code is well and working is that the dos for the square - well tetradecamer ( given on the logarithmic scale with respect to the reference system in figure  [ fig : swdos ] ) actually shows this mathematically proven convergence on that of the hard - sphere tetradecamer at high energies .",
    "the algorithm also runs quicker until convergence in those cases .",
    "the interesting part , where convergence is also a bit more problematic , is for the low energy regions where the dos of the square - well tetradecamer exhibits a clear deviation from its hard - sphere counterpart .",
    "the depth of this `` dip '' in the curve is decreased when the density is increased .",
    "it is easy to see why this should be by considering the close - packed density where the molecules have no liberty of movement left , conditions under which the hard - sphere and the square - well fluid are indistinguishable .    in figure",
    "[ fig : swdos2 ] is shown the temperature dependence of the constant - volume heat capacity of the coupled system at the `` low - medium '' density corresponding to the volume fraction of @xmath154 .",
    "the heat capacity was calculated through the statistical mechanical relation @xmath172 the broad peak in this function at around @xmath173 is characteristic of a first - order phase transition far from the thermodynamic limit @xcite , in contradistinction with the singularity that one obtains for the infinite system , even if contrary to the case of ref .",
    "it is clear from the density in this case that it is question of a gas - liquid rather than a liquid - solid transition . at high temperatures",
    ", we expect the translational equipartition value of @xmath174 to hold , and this is borne out by the graph .",
    "moreover , this is also the limiting heat capacity at low temperatures , since the law of dulong and petit does not hold for the square - well fluid .",
    "this is because the potential is not analytical , and so there is no first - order quadratic potential energy term to contribute to the heat capacity .",
    "this gives rise to a largely symmetric peak in the heat capacity .",
    "for comparison , the heat capacity calculated from regular constant - volume monte carlo simulations and the fluctuation formula , @xmath175 are also shown in figure  [ fig : swdos2 ] .",
    "it is to be noted that these simulations are very difficult to converge in the low - temperature regime , not the least because of the numerical instability that arises from the @xmath176 denominator for small @xmath14 .      in figure",
    "[ fig : swerr ] , we see the level of convergence attained as a function of the monte carlo cycles for both the perturbation calculations and the wl sampling for the `` low - medium '' density .",
    "the implementation of the wl sampling is in everything essential the same as for the oscillators discussed earlier .",
    "the maximum displacement in the random walk was the same as for the perturbation calculations , @xmath120 units in the configurational space and the same in momentum space ( the mass being taken as unity ) .",
    "like then , the error was estimated by comparing the slope of the partially converged @xmath177 of one method , to that of the converged @xmath177 of the other method . because @xmath177 is not a linear function in @xmath0 , and for the reasons discussed earlier , perfect agreement between the two converged derivatives is not attained with the numerical differentiation .",
    "the apparent limiting error is about @xmath178 for the average unsigned difference between the two calculated slopes , which is sufficient for the comparison .    like in the case of the oscillators , it is clear that the perturbation calculations exhibit a greater degree of convergence already after a small number of cycles than the wl sampling .",
    "when the two algorithms are close to maximum convergence , they become more difficult to distinguish .",
    "we also note that although not apparent in this calculation  because the calculation of the energy of the square - well fluid is computationally trivial ",
    "the number of energy evaluations for the perturbation calculations only constitute @xmath179:th of the total number of cycles ( this is because 95% of the cycles are arbitrarily dedicated to propagating the hard - sphere markov chain ) .",
    "this will have an important speed impact when considering more demanding interaction potentials , _",
    "e. g. _ , many - body potentials .",
    "one of the most efficient cases for the perturbation method would thus seem to be the calculation of the dos of many - body potentials with hard - cores ( so that the hard - sphere reference system can be used with benefit ) .    ) as a function of total monte carlo cycles in the energy interval @xmath180 $ ] ( with respect to the ground - state energy ) .",
    "each point is the average of three independent runs . ]",
    "so far , we have only considered systems of low dimensionality and simple hamiltonians .",
    "this has allowed us to compare the speed and accuracy with the wl algorithm , and the calculation of heat capacity with canonical monte carlo simulations , at no excessive numerical demands .",
    "however , the method is also applicable to higher dimensions and more demanding hamiltonians , provided there is a suitable higher - dimensional reference system to use .",
    "when there is , the full benefits of the method are realized .",
    "however , the method may always be applied using the ideal gas as the reference system . although the full power of the method relative to other approaches is not realized ( because the overlap between the system of interest and the reference is small )",
    ", it is always possible in principle to carry out the calculation . to illustrate this ,",
    "our final example is the calculation of the vapor pressure of liquid gold .",
    "we will consider a @xmath181-particle system with periodic boundary conditions .      for completeness",
    ", we note that the normalized dos of the reference ideal gas system is given by @xmath182 where @xmath16 is the volume , @xmath106 the particle mass and @xmath183 denotes the euler @xmath184-function . here",
    "we have included the center - of - mass motion as one of the degrees of freedom .",
    "this is the natural result of our monte carlo approach . in molecular dynamics",
    "implementations , that would not be the case , and consequently the reference dos would be slightly different @xcite . this needs to be kept in mind if a potentially more efficient molecular dynamics sampling is to be attempted . since @xmath25 is known completely , we make use of it in conjunction with eq .",
    "( [ eq : selfsimilar ] ) to obtain @xmath26 at any @xmath0 from simulations over different @xmath35 at a single @xmath0 .",
    "the gold metal was described by the many - body sutton - chen ( sc ) type potential @xcite , @xmath185,\\ ] ] where the parameters @xmath186 are taken from the empirical parametrization of agin _ et al .",
    "_ @xcite intended for classical simulations .",
    "the values for au are @xmath187 , @xmath188 , @xmath189 ev , @xmath190   and @xmath191 . because of the much extra numerical work required for the @xmath181 system and the many - body potential ,",
    "the calculations to be reported have been obtained from eight independent `` intel xeon e5520 '' 2.27 ghz processor cores on a parallel computer architecture .",
    "a single @xmath192-point took about two hours of processor time when run for @xmath193 monte carlo cycles and this was deemed acceptable accuracy .",
    "the @xmath35-parameter was scaled from @xmath120 to @xmath194 in steps of @xmath195 at @xmath196 ev , and from thereon in successive halvings until @xmath197 ; the last point at @xmath113 was calculated by extrapolation ( _ vide infra _ ) .",
    "all simulations were carried out at a density of @xmath198 g / @xmath199 , corresponding according to paradis and coworkers @xcite to the average liquid density in the temperature range 13371500 k for their recent density measurements , for which the thermal volume expansion is about 1% over the same temperature interval .",
    "therefore , a further simplification we make is that the thermal expansion coefficient of our system is taken to be zero . considering the simple ( in relation to the `` real world '' ) interaction potential , this approximation seems justifiable .",
    "the energy minimum was taken as the single - point energy of the fcc symmetry at this density , and was @xmath200 ev .",
    "it is generally not crucial to have an exact value of the potential energy minimum , as an error in this quantity will primarily affect the dos at the low end of the energy range , which translates to low temperatures in the partition function , corresponding to the crystalline state .",
    "the short - range repulsion of the interatomic potential is very steep and resilient to the linear @xmath35-scaling .",
    "connecting with the point at @xmath36 furthermore would seem to require unbiased random sampling , as the states of the ideal gas are completely random .",
    "this step is analogous to the first energy partitioning window in the ns method , which is also obtained by random sampling .",
    "random sampling is inefficient .",
    "however , when @xmath35 is scaled in exponential fashion in the region close to zero , a clear trend is visible ( figure  [ fig : extrapol ] ) which allows us to extrapolate to @xmath36 by the geometric series .",
    "the resulting curve of @xmath201 as a function of @xmath35 is shown in figure  [ fig : logom ] .",
    "the extrapolated part represents about 5% of the cumulative total value .     for each halving of the @xmath35-value in the region @xmath202 .",
    "the dashed line is the average value ( @xmath203 ) used in the extrapolation . ]     and @xmath204 in the calculation of the dos of liquid gold for @xmath196 ev and @xmath181 . from this curve",
    "any arbitrary @xmath0-point of @xmath26 is obtainable through eq .",
    "( [ eq : selfsimilar ] ) . ]",
    "the vapor pressure was calculated according to , @xmath205 where @xmath206 is the partition function of the gold metal .",
    "this equation is derived in the appendix .",
    "we see in figure [ fig : goldpvap ] the calculated vapor pressure as a function of temperature , compared with experimental estimates @xcite .",
    "when judging the quality of the results , it must be kept in mind that the sc potential model is a very simple representation , and the parametrization employed has been derived from properties of the crystalline , and not the liquid , metal .",
    "the potential is clearly not perfect as , for instance , the relative error in the predicted surface tension well exceeds 50% @xcite .",
    "it should come as no surprise then , that the absolute value of the predicted vapor pressure is off by roughly a factor of @xmath207@xmath208 over the temperature interval considered , with the slightly better agreement at the high end of the range .",
    "the variation in this factor of around 10% is smaller than the absolute error , and if the results are interpreted physically in terms of the clausius - clapeyron equation , @xmath209 where @xmath210 is the pressure of some reference state ( its definition is arbitrary but affects the value of @xmath211 ) , we see that this accuracy of the slope translates into a good estimate of the molecular enthalpy of vaporization , @xmath212 .",
    "it is hence primarily the molecular entropy of vaporization , @xmath213 , which is underestimated by this parametrization of the sc potential .",
    "it is not surprising that the accuracy in @xmath214 is higher , as it is related to the average well - depth of the interatomic potential , and has been explicitly fitted for the crystal .",
    "@xmath211 , on the other hand , is related to the _ shape _ of the interatomic potential and is a much more difficult quantity to parametrize .",
    "@xmath215 k and is an extrapolation over the temperature interval considered here . ]",
    "in this paper , it has been shown that calculating the cpf through the dos by a perturbation method is a viable alternative to other techniques if the dos of a related system is known .",
    "the present alternative was found faster than the wl method for the three - dimensional anharmonic einstein crystal , and for the square - well tetradecamer .",
    "technically , the algorithm amounts to sampling ( at most ) two microcanonical ensemble averages and so must be considered very simple .",
    "indeed , one would only need to add a couple of lines of code to pre - existing molecular dynamics programs , for instance , to implement this algorithm ; and it would require also but very modest modifications to most monte carlo programs to implement the microcanonical average .",
    "the greatest obstacle to a pain - free implementation of this method is that the potential energy minimum value has to be independent of @xmath35 , requiring at the very least that efficient energy minimization can be carried out on the systems of interest . however , a poor determination of the energy minimum will affect the low - energy region of the dos disproportionally , and so a very precise determination might not be necessary if one is interested in the high - energy end . another mitigating factor is the obvious fact that for any method or algorithm to calculate the low - energy dos , such energy minimization must be carried out implicitly .",
    "systems for which energy minimization is difficult , for whatever reason , are thus inherently difficult cases for which to calculate the complete dos by any method .",
    "incidentally , we note that efficient energy minimization is also a prerequisite of the wl - like algorithm of soudan _ et al .",
    "_ @xcite .",
    "the foremost advantage of the method is that to calculate the dos of a system similar to one for which this quantity is already known , the least possible extra numerical expenditure should be necessary .",
    "however , the greatest drawback of the method is that prior knowledge of the dos is generally very scarce .",
    "this limits the optimal applicability of this method because the repertoire of systems with known dos does not necessarily include those that are related to the system of study .",
    "it is therefore foreseeable that this algorithm will be most useful in conjunction with another method to calculate the dos . like this , once obtained for one system , a whole series of related systems will be amenable to structured investigation",
    ". such a combination of methods could be , for instance , `` wl plus perturbation '' or a similar recipe .",
    "the cost of acquiring the dos of the reference system , by whatever suitable method , is then offset by the ease of calculation of the dos of the related systems .",
    "also , unless the absolute dos is needed ( to compute , for instance , a phase diagram ) in some situations entropic _ differences _ may suffice .    however , one additional advantage of the perturbation method is its ability to calculate @xmath19 at any @xmath0-value , independently of the @xmath0-range one ultimately considers , which means that the dos can be gradually accrued from completely separate simulations without the need of having to decide on a discretization scheme beforehand .",
    "this means that the algorithm is trivially parallelizable and also opens up a vast array of possibilities for further improvement .",
    "for instance , a `` smart , '' _ e. g. _ automatic and non - uniform , discretization of the energy levels when calculating the dos , so that those regions where the dos varies most rapidly are sampled most thoroughly , is a natural extension , somewhat analogous to the energy segment partitioning of the ns method .",
    "use of the computer resources of the chalmers centre for computational science and engineering ( c@xmath216se ) under project snic001 - 11 - 280 is gratefully acknowledged .",
    "i am thankful to prof .",
    "roland kjellander , and to anonymous referees , for many constructive comments and criticisms .",
    "in the one - component system that we consider , the chemical potential of the liquid is related to the helmholtz free energy @xmath217 through @xmath218 . experimentally , the product @xmath219 is around @xmath220 j whereas the calculated @xmath221 is around @xmath222 j. the second term may therefore safely be neglected in view of the other approximations involved .",
    "the chemical potential of the vapor is @xmath223 . setting @xmath224 , neglecting the pressure - volume term and substituting @xmath225 , one arrives at the result quoted in the text after applying stirling s approximation , @xmath226 .",
    "59ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]",
    " + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty link:\\doibase { 10.1016/j.physa.2006.05.018 } [ * * ,   ( ) ] @noop * * ,   ( ) link:\\doibase { 10.1103/physrevlett.65.1567 } [ * * ,   ( ) ] link:\\doibase    { 10.1103/physreva.46.791 } [ * * ,   ( ) ] link:\\doibase { 10.1007/bf01437480 } [ * * ,   ( ) ] link:\\doibase { 10.1016/s0009 - 2614(95)01226 - 5 } [ * * ,   ( ) ] @noop * * ,   ( ) link:\\doibase { 10.1103/physrevlett.63.1195 } [ * * ,   ( ) ] link:\\doibase { 10.1103/physrevlett.86.2050 } [ * * ,   ( ) ] link:\\doibase { 10.1103/physreve.64.056101 } [ * * ,   ( ) ] link:\\doibase { 10.1016/0370 - 2693(91)91256-u } [ * * ,   ( ) ] link:\\doibase { 10.1103/physrevlett.71.211 } [ * * ,   ( ) ] @noop * * ,   ( ) link:\\doibase { 10.1103/physrevlett.82.476 } [ * * ,   ( ) ] link:\\doibase 10.1209/epl / i2004 - 10486 - 9 [ * * ,   ( ) ] in  @noop _ _ ,  vol .",
    "( )  p. @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase { 10.1103/physrev.184.151 } [ * * , ( ) ] link:\\doibase { 10.1103/physreva.1.1266 } [ * * , ( ) ] link:\\doibase { 10.1016/0009 - 2614(74)80109 - 0 } [ * * ,   ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1063/1.3158605 [ * * , ( ) ] link:\\doibase 10.1142/s0129183102003243 [ * * , ( ) ] link:\\doibase    10.1103/physrevlett.92.097201 [ * * ,   ( ) ] link:\\doibase 10.1103/physreve.71.066705 [ * * ,   ( ) ] @noop * * ,   ( ) link:\\doibase    10.1103/physreve.73.056704 [ * * ,   ( ) ] link:\\doibase 10.1103/physreve.75.046701 [ * * ,   ( ) ] link:\\doibase 10.1103/physreve.78.046705 [ * * ,   ( ) ] link:\\doibase 10.1103/physreve.78.055701 [ * * ,   ( ) ] link:\\doibase 10.1063/1.3647333 [ * * ,   ( ) ] link:\\doibase 10.1103/physreve.84.026701 [ * * ,   ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase { 10.1103/physreva.44.4061 } [ * * , ( ) ] @noop * * ,   ( ) link:\\doibase { 10.1063/1.462133 } [ * * ,   ( ) ] link:\\doibase 10.1103/physreve.67.067102 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.90.035701 [ * * ,   ( ) ] link:\\doibase 10.1063/1.2803061 [ * * , ( ) ] link:\\doibase 10.1103/physreve.85.010102 [ * * ,   ( ) ] @noop * * ,   ( ) link:\\doibase 10.1063/1.3077658 [ * * ,   ( ) ] link:\\doibase { 10.1039/b208653k } [ * * ,   ( ) ] @noop * * ,   ( ) link:\\doibase 10.1103/physreve.59.4781 [ * * ,   ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) http://dx.doi.org/10.1557/proc-554-43 [ * * ( ) ] http://www.springerlink.com/content/v83170035255514g/ [ * * , ( ) ] @noop * * ,   ( )"
  ],
  "abstract_text": [
    "<S> monte carlo switching moves ( `` perturbations '' ) are defined between two or more classical hamiltonians sharing a common ground - state energy . </S>",
    "<S> the ratio of the density of states ( dos ) of one system to that of another is related to the ensemble averages of the microcanonical acceptance probabilities of switching between these hamiltonians , analogously to the case of bennett s acceptance ratio method for the canonical ensemble [ c. h. bennett , _ j. comput </S>",
    "<S> . phys . _ , * 22 * , 245 ( 1976 ) ] . </S>",
    "<S> thus , if the dos of one of the systems is known , one obtains those of the others and , hence , the partition functions . as a simple test case , </S>",
    "<S> the vapor pressure of an anharmonic einstein crystal is computed , using the harmonic einstein crystal as the reference system in one dimension ; an auxiliary calculation is also performed in three dimensions . as a further example of the algorithm , </S>",
    "<S> the energy dependence of the ratio of the dos of the square - well and hard - sphere tetradecamers is determined , from which the temperature dependence of the constant - volume heat capacity of the square - well system is calculated and compared with canonical metropolis monte carlo estimates . for these cases and reference systems , </S>",
    "<S> the perturbation calculations exhibit a higher degree of convergence per monte carlo cycle than wang - landau ( wl ) sampling , although for the one - dimensional oscillator the wl sampling is ultimately more efficient for long runs . </S>",
    "<S> last , we calculate the vapor pressure of liquid gold using an empirical sutton - chen many - body potential and the ideal gas as the reference state . although this proves the general applicability of the method , by its inherent perturbation approach , the algorithm is suitable for those particular cases where the properties of a related system are well known . </S>"
  ]
}