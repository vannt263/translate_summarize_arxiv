{
  "article_text": [
    "in many areas of astronomy , there is a need for image processing and analysis capabilities and light curve extraction .",
    "one such general purpose environment is iraf .",
    "however , especially for ultra - precise photometry in fast - paced areas of research such as exoplanet transits and microlensing , there remains a need for a general , off - the - shelf integrated analysis environment that is at once sophisticated yet easy to use .",
    "indeed , citizen science and professional - amateur collaborations increasingly require robust tools that can deliver research grade results while enabling broad usability .    here",
    "we present astroimagej ( aij ) , an astronomical image analysis software package that is based on imagej ( ij ; @xcite ) , but includes customizations to the base ij code and a packaged set of software plugins that provide an astronomy specific image display environment and tools for astronomy specific data reduction , analysis , modeling , and plotting .",
    "aij and ij are public domain , open source , java programs inspired by nih image for the macintosh computer . some aij capabilities were derived from the _ astronomy _ plugins package written by frederic v. hessman et al . of the inst .",
    "f. astrophysik , georg - august - universitt gttingen .",
    "some astronomical algorithms are based on code from _ jskycalc _ written by john thorstensen of dartmouth college . because aij is java code , the package is compatible with computers running apple os x , microsoft windows , and the linux operating system ( os ) .",
    "aij is a general purpose astronomical image processing tool , plus it provides interfaces to streamline the interactive processing of image sequences .",
    "the current release ( version 3.1.0 ) includes the following features and capabilities :    * interactive display of multiple images and multiple image stacks with fast image zooming , panning , and contrast adjustment similar to _",
    "saoimage ds9 _ * reads and writes fits images with standard headers , as well as most other common image formats ( e.g. tiff , jpeg , png , etc . ) * image calibration including bias , dark , flat , and non - linearity correction with an option to run in real - time during observations with a telescope * interactive time - series differential photometry with an option to run in real - time during observations with a telescope * comparison star ensemble changes without re - running differential photometry * mathematical operations of one image on another or an image stack , and mathematical and logical operations on single images or image stacks * interactive multi - curve plotting streamlined for display of light curves * interactive light curve fitting with simultaneous detrending * plate solving and addition of wcs headers to images seamlessly using the astrometry.net web interface * fits header viewing and editing * astronomical coordinate display for images with wcs * object identification via an embedded simbad interface * image alignment using wcs headers or apertures to correlate stars * non - destructive object annotations / labels using fits header keywords * time and coordinate conversion with capability to update / enhance fits header content ( airmass , @xmath0 , etc . )",
    "* color image creation with native imagej processing power * optionally enter reference star apparent magnitudes to calculate target star magnitudes automatically * optionally create minor planet center ( mpc ) format for direct submission of data to the mpc    the following sections provide an introduction to the astronomy specific capabilities of aij and present the aij specific user interfaces .",
    "the detailed aij user guide , installation packages , and installation instructions are available for download at the aij website .",
    "most of the aij user interface panels include `` tool - tip '' help messages that optionally pop up when the mouse pointer is positioned over an item in the display for more than a second .",
    "an aij user forum is available to facilitate shared support for the software .",
    "aij inherits all of the basic image manipulation and analysis functionality from ij .",
    "the ij website provides detailed user guides and descriptions of its functionality .",
    "when aij is started , the aij toolbar opens and presents the eight aij - specific toolbar icons labeled as 1 - 8 in figure [ fig : aijtoolbar ] .",
    "each of those icons provides direct access to an aij analysis tool or function .",
    "the icon shown depressed and labeled as 1 @xmath1{aijastromodeicon}\\,\\right)$ ] indicates that aij is in astronomy mode . in this mode ,",
    "all images open into the astronomical image display mode discussed in ",
    "[ sec : aijdisplay ] .",
    "icon 2 @xmath2{aijapmodeicon}\\,\\right)$ ] starts single aperture photometry mode as discussed in ",
    "[ sec : singleaperture ] .",
    "a double - click on icon 2 opens the _ aperture photometry settings _ panel discussed in appendix [ sec : photset ] .",
    "icon 3 @xmath3{aijmultiapertureicon}\\,\\right)$ ] starts the multi - aperture differential photometry module discussed in ",
    "[ sec : multiaperture ] .",
    "icon 4 @xmath4{aijbroomtoolicon}\\,\\right)$ ] clears all labels and apertures from the image display .",
    "icon 5 @xmath5{aijmultiploticon}\\,\\right)$ ] starts the multi - plot module discussed in  [ sec : multiplot ] .",
    "icon 6 @xmath6{aijtableopenicon}\\,\\right)$ ] opens previously saved photometry `` measurements tables '' ( see appendix [ app : measurementstable ] ) .",
    "icon 7 @xmath7{aijdpicon}\\,\\right)$ ] opens the _ data processor _ panel discussed in  [ sec : dataprocessor ] .",
    "icon 8 @xmath8{aijccicon}\\,\\right)$ ] opens the _ coordinate converter _ panel discussed in appendix [ sec : coordinateconverter ] .",
    "the 12 icons to the left of the aij icons and all of the menu options are standard ij tools .",
    "these tools can also be used in aij , but normally only the _ file _ menu options are used for typical time - series data reductions .",
    "a single image is opened from the aij toolbar using _",
    "_ file__@xmath9_open_. a time - series of images is opened into an image `` stack '' from the aij toolbar using _ _",
    "file__@xmath9__import__@xmath9_image sequence_. alternatively , an image or an image sequence can be opened by dropping the file or folder , respectively , onto the bottom area of the aij toolbar , or os options can be enabled to automatically open images into aij in response to a double click on the file in an os window . if all images in a sequence will not fit into the computer memory allocated to aij , the sequence can be opened as a `` virtual stack '' . in this mode",
    ", the stack of images can be processed as if all images exist in memory , but aij loads only the single active / displayed image into memory .",
    "virtual stacks perform more slowly than standard stacks , but memory requirements are minimal .",
    "all aij settings are persistent across sessions",
    ". settings for specific configurations can be saved and reloaded later as needed .",
    "many popular image file formats are supported by aij , including the flexible image transport system ( fits ; @xcite ) file format .",
    "the astronomical image display shown in figure [ fig : aijimagedisplay ] is unique to aij and offers numerous display options useful to astronomers .",
    "an image can also be displayed in plain ij display mode , which has no contrast controls , analysis controls , or mouse pointer data decorating the image , by disabling the option at _ _ preferences__@xmath9_use astro - window when images are opened _ in the menus above an open image .",
    "the setting will apply to any new images that are opened . to return to astronomical image display mode , click on the _ astronomy mode _",
    "icon @xmath1{aijastromodeicon}\\,\\right)$ ] in the aij toolbar .",
    "then left - click in an open image . to make the change permanent , re - enable the option at _ _ preferences__@xmath9_use astro - window when images are opened_.    in astronomy mode , a menu system is available at the top of the image display window to provide access to all astronomy specific aij features .",
    "a row of quick access icons for control of frequently used image display options and image analysis tools is located directly above the image .",
    "pixel and world coordinate system ( wcs ; @xcite ) information describing the image location pointed to by the mouse cursor is displayed in the three rows above the quick access icons .",
    "image and wcs format information is displayed in the space under the image menus .",
    "a non - destructive image overlay optionally displays active apertures ( green = target , red = comparison ) , object annotations , plate scale , and image orientation on the sky .    the _ scale _ menu above an image display offers options for the control of image brightness and contrast ( i.e. image scale ) . by default ,",
    "image scale is set automatically and linearly maps the pixel values in the range @xmath10 through @xmath11 to 256 shades of gray running from black through white .",
    "the negative image icon @xmath12{aijimagenegativeicon}\\,\\right)$ ] reverses the mapping to white through black .",
    "several alternate mappings are available at the aij toolbar menu item _ _",
    "image__@xmath9_lookup tables_. the auto scale range can be customized at _ _",
    "scale__@xmath9_set auto brightness & contrast parameters_. image scale can be manually controlled using the interactive histogram and direct entry fields under the image .",
    "the histogram region highlighted in blue indicates the range of pixel values currently being mapped to black through white ( by default ) in the image display .",
    "the controls on the left and right of the blue highlighted region can be dragged left and right , or the entire blue region can be dragged , to change the image scale .",
    "the image updates in real time .",
    "the four boxes under the histogram labeled _ min _ , _ black _ , _ white _ , and _ max _ indicate the minimum pixel value displayed in the histogram , the pixel value mapped to black in the image , the pixel value mapped to white in the image , and the maximum pixel value displayed in the histogram . by default ,",
    "the _ min _ and _ max _ values are set to the minimum and maximum pixel values in the displayed image . to provide finer control of the image scale settings , the _ min _ and _",
    "max _ histogram values can be manually set by the user after enabling _",
    "_ scale__@xmath9_use fixed min and max histogram values_. a red border indicates which boxes are available for user input .",
    "@xmath13enter@xmath14 _ key _ must _ be pressed to activate a new user entered value .",
    "the auto scale icon above an image @xmath15{aijautoscaleicon}\\,\\right)$ ] restores the auto scale settings . if _ _",
    "scale__@xmath9_auto brightness and contrast _ is enabled , a change to a displayed image or a change of which image is displayed from a stack resets the image scale to the automatic settings . to retain manually set values of _ black _ and _ white",
    "_ , enable _ _ scale__@xmath9_fixed brightness and contrast_. to automatically set _ min _ and _ black _ to the minimum pixel value and _ white _ and _ max _ to the maximum pixel value , select _ _",
    "scale__@xmath9_full dynamic range_. image scale may also be adjusted by a right - click and drag in the image . dragging up and down changes the brightness . dragging left and right changes the contrast .",
    "the zoom setting of an image display is most easily changed by rolling a mouse wheel , if available , to zoom the image in and out at the mouse pointer .",
    "alternatively , image zoom changes , centered at the last clicked location in an image , can be controlled using the four magnifying glass icons on the right side of the quick access row , or by pressing the _ up _ and _ down _ arrows on the keyboard .",
    "zoom can also be changed with a control - left - click or control - right - click in the image to zoom in or out , respectively , at the clicked point .",
    "image pan is controlled by a left - click and drag in the image . by default ,",
    "a middle - click in an image centers the clicked location in the image display .",
    "however , this feature can be disabled using the menu option _ _ preferences__@xmath9_middle click centers image at clicked position_. right - click and drag in an image reports arc - length in place of integrated counts in the lower - right - hand box above an image .",
    "alt - left - click near an object to produce an azimuthally averaged radial profile ( i.e. a seeing profile ) plot .",
    "see appendix [ sec : radialprofile ] for more radial profile plot details .    the _ view _ menu above an image provides settings to invert the display of an image in _ x _ and/or _ y_. the _ view _ menu also provides options to enable or disable the display of the zoom indicator , the _ x _ , _ y _ , _ n _ , and",
    "_ e _ directional arrows , and the image plate scale indicators in the image overlay .",
    "if wcs header information is available , aij automatically calculates the @xmath16- and @xmath17-axis plate scales and the orientation of the image on the sky .",
    "if no wcs information is available , the image scale and orientation on the sky can be set manually at _ _",
    "wcs__@xmath9_set pixel scale for images without wcs _ and _ _ wcs__@xmath9_set north and east arrow orientations for images without wcs _ , respectively . image scale and orientation can be extracted from an image with wcs headers and stored in the manual settings by using the menu option _ _",
    "wcs__@xmath9_save current pixel scale and image rotation to preferences_. this option is useful for cases where at least one image in a time - series has been plate - solved , but others have not .    the blue aperture shown near the center of figure [ fig : aijimagedisplay ] moves with the mouse pointer .",
    "as the mouse pointer is moved around in the image , the value of the pixel at the mouse pointer and the peak pixel value and background - subtracted integrated counts ( see  [ sec : singleaperture ] ) within the mouse pointer aperture are updated in the right - hand column of data displayed above the image .",
    "this interactive mouse photometer helps to quickly assess which stars are suitable comparison stars during differential photometry set up .",
    "when aij is used in real - time data reduction mode ( see  [ sec : dataprocessor ] ) , the mouse photometer helps to quickly determine an appropriate image exposure time and telescope defocus setting .",
    "if a time - series of images is opened as an image stack , a scroll bar is displayed directly under the image as shown in figure [ fig : aijimagedisplay ] .",
    "the scroll bar can be moved left and right , or the _ left _ and _ right _ arrow keys on the keyboard can be used to display different images from the sequence . the right - pointing `` play '' icon to the left of the scroll bar will animate the image sequence at a predefined rate . the rate is set by right - clicking on the play icon .",
    "the annotation feature allows objects to be labeled non - destructively in an image overlay .",
    "new object annotations can be added manually , or if the image has wcs information , target names can be extracted from simbad and displayed by right - clicking on an object .",
    "annotations can be edited or deleted by right - clicking near the annotated object ( i.e. below and near the center of the annotation text ) .",
    "the annotations can also be stored in the fits header for display at a later time .",
    "the _ annotate _ menu provides annotation and related fits header storage options .",
    "the annotate icon above an image @xmath18{aijannotateicon}\\,\\right)$ ] toggles the display of annotations in the image overlay .",
    "the second through fifth icons shown as depressed in figure [ fig : aijimagedisplay ] control which components of apertures ( see  [ sec : singleaperture ] ) are displayed and whether an aperture is to be centroided on the nearest star when it is placed .",
    "the delete slice icon @xmath19{aijdeletesliceicon}\\,\\right)$ ] removes the currently displayed slice from a stack , but does not remove the image from permanent storage .",
    "the clear overlay icon @xmath20{aijclearoverlayicon}\\,\\right)$ ] clears all apertures and annotations from the image overlay .",
    "the show apertures icon @xmath21{aijshowaperturesicon}\\,\\right)$ ] displays stored apertures ( see  [ sec : multiaperture ] ) in the image overlay .",
    "the clear measurements icon @xmath22{aijcleartableicon}\\,\\right)$ ] clears all data from the measurements table ( see appendix [ app : measurementstable ] ) .",
    "the multi - aperture @xmath23{aijmultiapertureicon}\\,\\right)$ ] , stack - aligner @xmath24{aijstackalignericon}\\,\\right)$ ] , astrometry @xmath25{aijastrometryicon}\\,\\right)$ ] , and fits header editor @xmath24{aijfitsheadereditoricon}\\,\\right)$ ] icons provide access to features described in  [",
    "sec : multiaperture ] , appendix [ sec : stackaligner ] , appendix [ sec : astrometry ] , and appendix [ sec : fitsheadereditor ] , respectively .      in appendix",
    "[ app : utilities ] we describe the following integrated utilities : coordinate converter ( [ sec : coordinateconverter ] ) , fits header editor ( [ sec : fitsheadereditor ] ) , astrometry / plate solving ( [ sec : astrometry ] ) , image alignment ( [ sec : stackaligner ] ) , radial profile plotting ( [ sec : radialprofile ] ) , photometry settings ( [ sec : photset ] ) , data processor fits header updates ( [ sec : fitsheaderupdates ] ) , and save all ( [ sec : saveall ] ) .    in appendix",
    "[ app : photerr ] we describe photometric uncertainty calculations . in appendix",
    "[ app : apparentmagnitude ] we describe the optional apparent magnitude and apparent magnitude uncertainty calculations . in appendix",
    "[ app : measurementstable ] we describe the measurements table used to store photometric results .",
    "the data processor ( dp ) module provides tools to automate the build of master calibration images , automate calibration of image sequences , and optionally perform differential photometry and light curve plotting .",
    "the dp module is started by clicking the dp icon @xmath26{aijdpicon}\\,\\right)$ ] on the aij toolbar ( labeled 7 in figure [ fig : aijtoolbar ] ) .",
    "the user interface is shown in figure [ fig : aijdataprocessor ] .",
    "dp operates much like a script in that it processes selected calibration and science images in a user defined manner .",
    "fields are provided to define the directory / folder locations and filename patterns of data to be processed .",
    "checkboxes are provided to enable various tasks that can be included in the data processing session .",
    "disabling certain checkboxes will automatically disable other related input fields as appropriate to help the user understand which input fields are interconnected .    the path and image filename pattern matching the raw science images to be processed are set in the _ science image processing _ sub - panel .",
    "file paths and names can be dragged and dropped from the os into a field of the dp panel to minimize typing . the number of files matching the pattern at the specified path shows in the right - hand column labeled _ totals_. the science images can be further filtered based on the image sequence numbers in the filename by entering minimum and/or maximum numbers in the second row of the sub - panel",
    ".    master bias , dark , and flat images can be created by enabling the _ build _ options and entering the paths and filename patterns matching the raw calibration images on the _ build _ lines of the _ bias subtraction _ , _ dark subtraction _ , and _",
    "flat division _ sub - panels , respectively .",
    "the master calibration files are saved using the path and filename specifications in the _ enable _ lines of the three sub - panels . as with the science images , the number of files matching the pattern for each raw calibration image set shows in the right - hand column labeled _",
    "totals_. if one or more of the master calibration files have been previously built , the _ build _ option in the respective sub - panel(s ) can be disabled to skip those master build steps . in this case",
    ", the master calibration path and filename should be specified on the _ enable _ line of the respective sub - panel .",
    "aij provides the option to either average or median combine the raw images when producing the master calibration files .",
    "if the dark subtraction _ scale _ option is enabled , the master dark pixel values are scaled by to the ratio of the science image exposure time to the master dark image representative exposure time . the dark subtraction _ debias _ option controls whether the master dark is saved with or without the bias image subtracted , and specifies whether the master dark image being used for dark subtraction was saved with or without the bias image subtracted . the dark _ scale _ and _ debias _ options are available only if bias subtraction is enabled .",
    "bias subtraction , dark subtraction , and flat - field division can be individually selected using the _ enable _ option in the corresponding sub - panel .",
    "the master calibration image paths and filenames are specified on the _ enable _ line of each sub - panel . when a file path has been entered correctly and matches a stored file , a count of `` 1 '' will appear in the _ totals _ column .",
    "the _ image correction _ sub - panel provides the option to implement ccd nonlinearity correction .",
    "this option replaces each pixel s adu value in the bias - subtracted dark , flat , and science images with the corrected adu value @xmath27 where the coefficients @xmath28 describe the non - linear behavior of the detector .",
    "bias subtraction must be enabled and a master bias image specified to enable the use of non - linearity correction .",
    "remove outliers _",
    "option uses thresholded median filtering to remove artifacts from science images .",
    "this option is useful for improving the cosmetic appearance of images ( e.g. to clean cosmic ray hits and/or hot and cold pixels ) .",
    "however , we strongly suggest that this option _ not _",
    "be used when calibrating images for photometric extraction since it can unpredictably impact the results .",
    "the _ fits header updates _ sub - panel _ general _ option enables the calculation of new astronomical data ( e.g. airmass , time in @xmath0 , target altitude , etc . ) and the addition of those data to the calibrated science image s fits header ( see appendix [ sec : fitsheaderupdates ] for set up details ) .",
    "the _ plate solve _ option enables astrometry and the addition of the resulting wcs data to the calibrated ( and optionally to the raw ) science image s fits header .",
    "click the _ astrometry settings _ icon @xmath29{aijdpastrometryicon}\\,\\right)$ ] in the _ fits header updates _ sub - panel to access the astrometry set up options discussed in appendix [ sec : astrometry ] .",
    "the _ save calibrated images _",
    "sub - panel provides file format and file naming options for saving calibrated images .",
    "the _ 16 _ and _ 32 _ options specify that the calibrated images be saved in 16-bit integer or 32-bit floating point format , respectively .",
    "the _ sub - dir _ box allows the specification of an optional subdirectory of the science image directory to be used when saving the calibrated science images .",
    "the _ suffix _",
    "box allows the specification of an optional suffix to be appended to the raw science image file name when saving calibrated science images .",
    "the _ format _",
    "box allows the specification of a file format to use when saving the calibrated science images .",
    "if this box is left blank , the raw science image format is used .",
    "the _ format _",
    "box tool - tip shows all available file formats .",
    "the _ post processing _ sub - panel provides options to run multi - aperture ( see  [ sec : multiaperture ] ) and multi - plot ( see  [ sec : multiplot ] ) after each image is calibrated to perform differential photometry and display a light curve as the image data are processed .",
    "this feature is particularly useful for real - time reduction of data at the telescope .",
    "other options allow the current light curve plot and image display to be written to a file after each science image is calibrated .",
    "these images can be used to update websites to show the progress of observations .",
    "the _ control panel _ sub - panel provides control over the master calibration build and image calibration process .",
    "if the _ polling interval _ is set to zero , a click on the _ start _ button will build any specified calibration files and process all specified science images .",
    "then dp will return to the stop state .",
    "this mode is ideal for post - observation calibration of data . to calibrate data in real - time , the _ polling interval _ is set to a positive number of seconds @xmath30 . after clicking on _",
    "start _ in this mode , all science images matching the file name and number filters will be processed , and then dp will search for new files matching the pattern every @xmath30 seconds . if dp is operating in this mode while observations are underway , calibration of a new image written from the camera will be started within @xmath30 seconds , and optionally processed by multi - aperture and multi - plot to update the light curve plot . after _",
    "start _ has been clicked , processing can be suspended by clicking on the _ pause _ button . in pause mode ,",
    "the _ start _ button is labeled _",
    "continue_. a click on the _ continue _ button resumes processing , or a click on the _ reset _ button returns dp back to the original state .",
    "another click on the _ start _ button will begin processing _ all _ specified data again .    a click on the _ aperture settings _ button @xmath31{aijdpapseticon}~\\right)$ ] in the _ control panel",
    "_ sub - panel opens the _ aperture photometry settings _ panel discussed in appendix [ sec : photset ] .",
    "a click on the _ change apertures _ button @xmath32{aijdpapchangeicon}~\\right)$ ] causes the _ multi - aperture measurements _ set up panel discussed in  [ sec : multiaperture ] to open the next time the _ start _ button is pressed . if the _ change apertures _",
    "button is not clicked after the _ reset _ button is clicked , the same apertures and aperture locations from the previous dp run will be used the next time the _ start _ button is clicked ( i.e. the _ multi - aperture measurements _ set up panel will _ not _ open before multi - aperture photometry starts ) .",
    "the _ clear measurements table data _ button @xmath32{aijdptableclearicon}~\\right)$ ] allows the user to clear all data from the measurements table at any time .",
    "if the _ clear measurements table data _ button is not clicked before starting a new dp run , new measurements will be appended to any existing measurements in the table .",
    "the number of images processed and the number of images remaining to be processed are displayed in the _ totals _ column of the _ control panel _ sub - panel .",
    "a detailed log of all processing steps with timestamps is created by default .",
    "the log function can be disabled by deselecting the dp menu item",
    "_ _ view__@xmath9_show log of data processing history_. the timestamps can be enabled or disabled in the same menu .",
    "aij provides interactive interfaces for single aperture photometry and multi - aperture differential photometry .",
    "the differential photometry interface is designed to automatically process a time - series of images and measure the light curves of exoplanet transits , eclipsing binaries , or other variable stars , optionally in real time at the telescope .",
    "single aperture photometry measures the flux from a source within a predefined region of interest in an image referred to as an aperture .",
    "aij currently supports circular apertures only .",
    "a representation of an object s flux in the aperture , referred to as net integrated counts , is calculated by summing all of the pixel values within the aperture after subtracting an estimate of the background flux near the aperture .",
    "the background flux is estimated from the pixel values in a background annulus centered on the aperture .",
    "single aperture photometry can be performed by simply placing the mouse pointer near the center of an object in an image .",
    "the net integrated counts within the mouse pointer aperture are shown in the _ int cnts _ display area above the image .",
    "the aperture and background regions are set by double clicking the single aperture icon @xmath33{aijapmodeicon}\\,\\right)$ ] on the toolbar , or single clicking the set aperture icon @xmath34{aijapseticon}\\,\\right)$ ] above an image .",
    "the mouse pointer photometer calculates net integrated counts by summing all of the pixel values in the mouse pointer aperture after subtracting the average value of the sky background annulus from each pixel value .",
    "the results of a single aperture measurement can be recorded in a `` measurements table '' ( see appendix [ app : measurementstable ] ) by enabling the single aperture icon @xmath35{aijapmodeicon}\\,\\right)$ ] on the toolbar and then left - clicking near a star . alternatively , shift - left - click near a star ( without enabling single aperture photometry mode ) as a short cut for single aperture photometry .",
    "these two methods of performing single aperture photometry can optionally use the more sophisticated centroid and sky background measurement algorithms described in  [ sec : multiaperture ] .",
    "an azimuthally averaged radial profile of an object can be plotted by left - clicking near the object in an image , and then selecting _",
    "_ analyze__@xmath9_plot seeing profile _ in the menus above the image display . as a short cut , alt - left - click near an object to produce the plot .",
    "if centroid is enabled , the radial profile will be centered on the object .",
    "click the _ save apertures _",
    "button in the plot to use the aperture radii determined from the radial profile .",
    "see appendix [ sec : radialprofile ] for more details .",
    "aij calculates photometric error as described in appendix [ app : photerr ] . for proper error calculation",
    ", the gain , dark current , and read out noise of the ccd detector used to collect the data must be entered in the _ aperture photometry settings _ panel ( see appendix [ sec : photset ] ) .",
    "differential photometry measures the flux of a target star relative to the combined flux of one or more comparison stars .",
    "the differential measurement is conducted by performing single aperture photometry on one or more target stars and one or more comparison stars .",
    "then a target star s differential flux is calculated by dividing the target star s net integrated counts , @xmath36 , by the sum of the net integrated counts of all comparison stars ( i.e. the sum of @xmath37 , where @xmath38 ranges from 1 to the number of comparison stars @xmath39 ) .",
    "the calculation is : @xmath40 where @xmath41 indicates the target star aperture number and @xmath38 indexes all comparison star aperture numbers .",
    "a measurements table data column labeled @xmath42 contains the differential flux measurement for target star aperture @xmath41 .",
    "the terms relative flux and differential flux are used in this work and in aij interchangeably .",
    "differential photometric error is calculated as described in appendix [ app : photerr ] . for proper error calculation",
    ", the gain , dark current , and read out noise of the ccd detector used to collect the data must be entered in the _ aperture photometry settings _ panel ( see appendix [ sec : photset ] ) .",
    "aij also calculates differential flux for each comparison star aperture by comparing the flux in its aperture to the sum of the flux in all _ other _ comparison star apertures .",
    "the calculation is : @xmath43 where @xmath41 indicates the comparison star aperture number for which differential flux is being calculated and @xmath38 indexes all comparison star aperture numbers .",
    "a measurements table data column labeled @xmath44 contains the differential flux measurement for comparison star aperture @xmath41 .",
    "multi - aperture ( ma ) automates the task of performing differential photometry on a time - series of images .",
    "various settings are presented in a set - up panel , and then the target and comparison star apertures are placed and adjusted interactively by clicking near stars directly in the image display .",
    "the ma module is launched by clicking the ma icon @xmath45{aijmultiapertureicon}\\,\\right)$ ] above an image or in the aij toolbar .",
    "the _ multi - aperture measurements _ set - up panel shown in figure [ fig : aijmultiaperture ] opens .",
    "the top two scroll bars allow the user to set the range of images to be processed .",
    "the three scroll bars immediately below allow the user set the aperture radius , the inner radius of the sky background region , and the outer radius of the sky background region , all in units of pixels .",
    "the _ use previous apertures ... _ option allows the previously defined set of apertures to be re - used .",
    "aperture definitions can also be stored and reopened from disk in the _ file _ menu of the image display .",
    "if wcs headers are available and the _ use ra / dec ... _ option is selected , the saved apertures will be placed according to ra and dec rather than by @xmath16 and @xmath17 pixel coordinates . if the _ reposition aperture to object centroid _ option is selected , a centroid algorithm will attempt to center the aperture on the nearest star .",
    "the _ remove stars from background _",
    "option enables iterative @xmath46 cleaning of the sky - background region .",
    "the iteration continues until the mean adu of the pixels remaining in the background set converges or the maximum number of allowed iterations has been reached without convergence .",
    "the sky background pixels remaining after the cleaning operation are used to calculate and remove the sky background at each pixel in the aperture .",
    "if the _ assume background is a plane _ option is selected , aij fits a plane to the remaining pixels in the background region and subtracts the value of the plane at each pixel within the aperture to remove the sky background contribution .",
    "otherwise , aij subtracts the mean of the remaining pixels in the background annulus from each pixel in the aperture .",
    "if the _ vary photometer aperture radius based on fwhm _ option is enabled , the aperture radius used in an individual image of a time - series is equal to the product of the user specified _ fwhm factor _ and the average full width at half maximum ( fwhm ) from all apertures in that image .",
    "this mode may improve photometric precision when seeing varies significantly or telescope focus drifts within a time - series . if the _",
    "fwhm factor _ is set to `` 0.00 '' , an azimuthally averaged radial profile ( see appendix [ sec : radialprofile ] ) , centered on the aperture , is used to determine the aperture radius based on the _ radial profile mode normalized flux cutoff _ value specified . in this mode , the aperture radius used in an image is equal to the distance from the center of the aperture at which the radial profile value is equal to the specified normalized flux cutoff .",
    "the variable aperture modes should not be used in crowded fields since the changing aperture radius will worsen the effects of variable amounts of contaminating flux blending into the aperture as seeing changes .",
    "if the _ prompt to enter ref star apparent magnitude _ option is enabled , the apparent magnitude of target aperture sources will be calculated from user entered apparent magnitudes of one or more comparison aperture sources .",
    "the target aperture apparent magnitude data can be formatted to submit to the minor planet center using the _ multi - plot main _ panel menu item _",
    "_ file__@xmath9_create minor planet center format_. see appendix [ app : apparentmagnitude ] for details on the use of the apparent magnitude feature .",
    "the _ aperture settings _ button at the bottom provides access to two panels containing detailed settings for the photometric measurements ( see appendix [ sec : photset ] ) .",
    "when all options have been set , the _ place apertures _ button causes the set - up panel to close and the program waits for the aperture positions to be identified by user clicks near stars in the first image of the time - series . if the _ use previous apertures ... _ option is enabled , the user clicks near the first star in the set ( usually the primary target star ) , and all other apertures are placed relative to the first aperture .",
    "if the _ use ra / dec ... _ option is also enabled , no clicks are required to apply the stored apertures since they are placed automatically at the calculated pixel locations corresponding to the stored wcs coordinates .",
    "if photometry settings ( e.g. aperture radii ) need to be refined during aperture placement , click the set aperture icon @xmath47{aijapseticon}\\,\\right)$ ] above the image display .    by default",
    ", a help panel opens that describes actions available at each step during aperture placement . by default",
    ", the first left - click in an image places a target star aperture and all other clicks place comparison star apertures . using shift - left - click",
    "reverses the sense of the default aperture type when placing new apertures .",
    "a shift - left - click in an existing aperture changes it from target to comparison , and vice - verse .",
    "a left - click inside an existing aperture deletes the aperture .",
    "an aperture can be moved by left - clicking inside it and dragging it to a new position .",
    "other options are available as listed in the context sensitive help panel .",
    "when all apertures have been defined as desired , a right - click or press of the _ @xmath13enter@xmath14 _ key will start the automated differential photometry process on all images defined in the set - up panel . if the _ use ra / dec ... _ option is enabled , apertures will first be positioned in each image of the series according to the wcs information in the image header . if not , the aperture placements start on each subsequent image in the series at the same place in @xmath48 space as in the previous image . in both cases , if centroid is enabled for a particular aperture , the centroid function will attempt to center the aperture on the nearest star . for telescopes with poor tracking / guiding or requiring a meridian flip during the time - series",
    ", the images should be plate solved so that the _ use ra / dec ... _ option can be enabled to properly find the initial aperture placements in each image .    the centroid function can be enabled or disabled on a per aperture basis .",
    "an alt - left - click in an existing aperture inverts the sense of centroid for that aperture .",
    "an aperture with centroid enabled has a plus sign showing at its center .",
    "if the first aperture has the centroid function enabled , all non - centroided apertures will move from one image to the next based on the average movement of all centroided apertures .",
    "this allows apertures to be placed around faint stars that are near bright stars that would normally capture the aperture if centroid were enabled .",
    "the photometry data is written to a `` measurements table '' ( see appendix [ app : measurementstable ] ) and optionally plotted by the multi - plot program as ma progresses through the time - series . if ma is run a second time duing the same aij session , the new measurements will be appended to the existing measurements in the measurements table . to clear the measurements table before the second run , click the clear measurements icon @xmath49{aijcleartableicon}\\,\\right)$ ] above the image display .",
    "multi - plot ( mp ) provides a multi - curve plotting facility that is tightly integrated with differential photometry and light curve fitting .",
    "ma can automatically start mp , or mp can be manually started by clicking the mp icon @xmath50{aijmultiploticon}\\,\\right)$ ] on the aij toolbar .",
    "if a measurements table has been created by ma or opened from the os , mp will automatically create a plot based on the last plot settings .",
    "alternatively , plot templates can be saved and restored to easily format commonly created plots .",
    "plotting controls are accessed in two main user interface panels .",
    "the _ multi - plot main _ panel is shown in figure [ fig : aijmpmain ] .",
    "controls include selection of the default @xmath16-axis dataset from a pull - down list of all data columns in the measurements table , the maximum number of plotted datasets and the maximum number of detrend variables displayed in the _ multi - plot y - data _ panel shown in figure [ fig : aijmpydata ] , plot title and subtitle , legend placement and options , @xmath51 and @xmath52axis label and scaling options , and the overall plot size in pixels .",
    "v.marker 1 _ and _ v.marker 2 _ controls provide the option to plot up to two vertical red dashed lines with labels . for example , these lines can be set to mark the predicted ingress and egress times on exoplanet transit light curve plots . as discussed in the last paragraph of appendix",
    "[ sec : coordinateconverter ] , new astronomical data such as airmass , @xmath53 , etc . can be calculated and added to the measurements table using the menu item at _ _ multi - plot main__@xmath9__table__@xmath9_add new astronomical data columns to table_.    the bottom row of _ multi - plot main _ sub - panels provide access to other @xmath16-axis controls that define the regions used when normalizing , detrending , and fitting @xmath17-datasets .",
    "the _ meridian flip _ settings allow the time of the telescope s meridian flip to be specified ( if applicable ) and to optionally mark that time with a light blue dashed vertical line . if _",
    "meridian_flip _ is selected as a detrending parameter for a dataset in the _ multi - plot y - data _ panel , the fitting routine attempts to remove any baseline offsets from one side of the meridian flip to the other .",
    "the _ fit and normalize region selection _",
    "options allow the user to specify additional @xmath16-axis values that define the normalization , detrend , and fit regions .",
    "for example , the _ left _ and _ right _ settings are used to mark the regions used to normalize the data ( which normally exclude the in - transit portion of the light curve ) .",
    "also , the @xmath16-axis mid - point between the _ left _ and _ right _ settings is used as the model fit starting point for the transit model parameter @xmath54 . the _ left trim _ and _",
    "right trim _ settings can be used to exclude leading and/or trailing data from the normalization , detrending , and fitting processes .",
    "a gray vertical dashed line can optionally be displayed to identify the regions on the plot .",
    "additional options are available in the menus at the top of the _ multi - plot main _ panel .",
    "figure [ fig : aijmpplot ] shows an example plot of a wasp-12b transit and demonstrates many of mp s plotting capabilities . the settings shown in figures [ fig : aijmpmain ] ( _ multi - plot main _ ) , [ fig : aijmpydata ] ( _ multi - plot y - data _ ) , and [ fig : aijfitpanel ] ( _ data set 2 fit settings _ ) were used to produce this plot .",
    "the _ multi - plot y - data _ panel is shown in figure [ fig : aijmpydata ] .",
    "each horizontal row in the user interface corresponds to an individual plotted dataset .",
    "the example shown allows up to 13 datasets to be plotted on a single plot . the top row of controls labeled",
    "`` 1 '' under the _ dataset _ heading produce the raw normalized light curve shown as solid blue dots near the top of the plot .",
    "note in particular the _ y - data _ column selected ( rel_flux_t1 ) and the _ norm / mag ref _ mode selected @xmath55{aijmpnormicon}\\,\\right)$ ] .",
    "the green areas in the _ norm / mag ref _ mode icon indicate the regions of the light curve ( relative to the _ left _ and _ right _ markers on the _ multi - plot main _ panel ) that are used to normalize the data . in this case , the in - transit data are not included in the calculation of the normalization parameter .    the second row of plot controls ( _ dataset 2 _ ) again plot the rel_flux_t1 data , but this time after simultaneously detrending and fitting the data as set up in the fit panel shown in figure [ fig : aijfitpanel ] , which is discussed in  [ sec : fitanddetrend ] .",
    "note the reduced systematics and scatter in the data .",
    "this row of controls uses the _",
    "fit mode selection _ @xmath56{aijmpfiticon}\\,\\right)$ ] to enable the fit panel .",
    "note that the _ then shift _ column is set to @xmath57 which shifts the transit baseline down to @xmath58 on the plot for clarify .",
    "the light curve model residuals are shown as open red circles .",
    "the residuals plot controls are available in the fit panel corresponding to the light curve .    the plot controls on rows corresponding to _ dataset 3 _ through _ dataset 9 _ display the first seven comparison star differential light curves on the plot .",
    "the _ fit mode",
    "_ selection @xmath59{aijmpdetrendicon}\\,\\right)$ ] , being completely green , selects all data for detrending , and the flat red line indicates that no transit model is fit ( since no transit event is expected in the comparison stars ) . note that the normalize mode selected under the _ norm / mag ref _ heading is all green also , since all comparison star data can be used for normalization .",
    "each comparison star light curve is shifted from the other light curves for clarity using the _ then shift _ setting .",
    "note that datasets 5 , 8 , and 9 have been binned by 2 data samples using the _ bin size _ setting to reduce the scatter for plotting purposes .",
    "the current implementation of binning is actually averaging of the specified number of data points , rather than binning into fixed size @xmath16-axis bins .",
    "each comparison star light curve has been detrended against airmass . in this example , mp is set to allow up to four trend datasets to be selected for detrending .",
    "note that the first _",
    "trend select _ button is enabled and _ airmass _ is showing in the _ trend dataset _",
    "column for all comparison stars .",
    "if the resulting comparison star light curves are relatively flat , then they should perform well as part of the comparison ensemble .",
    "the plot controls for datasets 10 - 13 create the display of four diagnostic curves .",
    "these curves are plotted relative to the size of the plot page by selecting the _ page rel _",
    "option on each row . in this mode",
    ", the _ scale _ setting forces the plot of the data to fit within a fixed percentage of the plot range .",
    "the _ then shift _ value in this mode is also a percent of the plot range with 0 being in the middle of the plot .",
    "this mode makes scaling of data to fit on a plot easy when the shape of a curve is important , but the actual values of the data are not .",
    "many other plotting options are available , including plotting of error bars ( _ auto error _ ) , legend options , input and output in magnitudes , data averaging / binning , and the option to select independent @xmath16-axis datasets for each @xmath17-axis dataset ( i.e. the _ x - data _ pull - down menus in the _ multi - plot y - data _ panel ) .",
    "datasets displayed in a plot have typically been modified in one or more ways ( e.g. normalized , detrended , converted to / from magnitude , scaled , shifted , binned , etc . ) .",
    "the displayed values can be added to the measurements table as new data columns for further manipulation or permanent storage using the _",
    "button @xmath60{aijmpnewcolicon}\\,\\right)$ ] on the left - hand side of the row corresponding to the plotted data .",
    "model residuals and sampled versions of the model can also be saved to the measurements table using this button .",
    "the legend is shown at the top of the plot in figure [ fig : aijmpplot ] , with the light curves plotted below .",
    "legend entries for each plotted curve can be automatically generated based on the measurements table column names known to be produced by ma by selecting the _ legend type _ icon @xmath61{aijmpautolegend}\\,\\right)$ ] .",
    "a custom legend can be displayed individually or in combination with the automatic legend by enabling the _ legend type _ icon @xmath62{aijmpcustomlegend}\\,\\right)$ ] , or a curve s legend can be disabled by selecting the @xmath63{aijmpnolegend}\\,\\right)$ ] option .",
    "legend settings that affect all legend entries are accessed by clicking the _ legend preferences _",
    "icon @xmath64{aijmplegendoptions}\\,\\right)$ ] at the top - right of the _ multi - plot y - data _ panel . by default",
    ", the model residuals rms values are calculated and displayed in the legend for detrended and fitted light curves .",
    "the light curve model parameter values are optionally shown for fitted light curves .",
    "the predicted time of ingress and egress are shown as red dashed vertical lines .",
    "the meridian flip time is indicated by the light blue vertical dashed line ( although no meridian flip actually occurred for the example observations ) , and the _ left _ and _ right _ gray dashed vertical lines show the boundaries of the normalization , detrending , and fitting regions .",
    "the plot can be zoomed by placing the mouse pointer inside the plot image and rolling the mouse scroll wheel .",
    "also , a left - click in the plot image zooms in by one step , and a right - click zooms out to the full plot . after zooming in",
    ", the plot can be panned with a left - click and drag of the mouse .",
    "a data point can be removed from a plot and measurements table by holding the shift key and moving the mouse over the data point in the plot until it is highlighted .",
    "then , while continuing to hold shift , a left - click will remove the data point .",
    "a shift - right - click will retrieve the deleted point . as shortcuts ,",
    "the _ left _ , _ right _ , _ left trim _ , and _",
    "right trim _ vertical markers can be set at the mouse pointer location in the plot with a control - left - click , control - right - click , control - shift - left - click , and control - shift - right - click , respectively .",
    "all typical data and image products created by a photometry and/or plotting and fitting session can be saved with one action using the _ save all _ feature available in the _ file _ menu of the _ multi - plot main _ panel .",
    "there are also _ file _ menu options in _ multi - plot main _ and image display panels to save each data product separately .",
    "the menu option at _ _",
    "file__@xmath9_save all ( with options ) _ opens a _",
    "save all _ settings panel before saving the files .",
    "the menu option at _ _",
    "file__@xmath9_save all _ runs the process using the previous settings without opening the settings panel",
    ". see appendix [ sec : saveall ] for a full description of the _ save all _ feature .",
    "light curve fitting is enabled for a particular dataset in the _ multi - plot y - data _",
    "panel by selecting the _ fit mode _",
    "icon showing the red transit model on a full green background @xmath56{aijmpfiticon}\\,\\right)$ ] .",
    "when this mode is selected , a _ fit settings _ panel will be displayed for the dataset as shown in figure [ fig : aijfitpanel ] .",
    "the settings in the figure produce the light curve model fit shown in the example plot of figure [ fig : aijmpplot ] .",
    "the transiting exoplanet model is described in @xcite .",
    "the transit is modeled as an eclipse of a spherical star by an opaque planetary sphere .",
    "the model is parametrized by six physical values , plus a baseline flux level , @xmath65 .",
    "the six physical parameters are the planetary radius in units of the stellar radius , @xmath66 , the semi - major axis of the planetary orbit in units of the stellar radius , @xmath67 , the transit center time , @xmath54 , the impact parameter of the transit , @xmath68 , and the quadratic limb darkening parameters , @xmath69 and @xmath70 .",
    "the orbital inclination can be calculated from the model parameters as @xmath71    aij is currently limited to finding the best fit model parameter values and does not provide estimates of the parameter uncertainties .",
    "the best fit model is found by minimizing @xmath72 of the model residuals using the downhill simplex method to find local minima @xcite .    before making adjustments in the _ fit settings _ panel ,",
    "refer  [ sec : multiplot ] and properly configure the _ fit and normalize region selection _ settings and optionally the _ meridian flip _ settings in the _ multi - plot main _ panel , and the _ norm / mag ref _ mode and other settings in the corresponding row of the _ multi - plot y - data _ panel .",
    "the parameter settings in the _ user specified parameters _ sub - panel are not fitted .",
    "the period of the exoplanet s orbit is not well constrained by the transit model , but its value will impact the best fit values of some of the fitted parameters , so the _ period _ value must be entered by the user .",
    "normally , the orbital period is known from rv or wide - field survey photometric data .",
    "the _ host star parameters _ in the same sub - panel are only used to estimate the physical planet radius , @xmath73 , from the fitted parameter @xmath66 .",
    "the host star parameter values are interrelated by tables in @xcite for zero age main sequence ( zams ) stars . the only value used in the calculation of @xmath73 ( displayed near middle of the right - hand side of the panel )",
    "is @xmath74 , so that value should be entered directly if known .",
    "otherwise , entering any one of the other host star parameters will produce a rough estimate of @xmath74 based on the zams assumption .",
    "the _ transit parameters _ sub - panel has seven rows for the seven transit model parameters . _ prior center _ values will need to be set for the seven parameters to ensure the correct @xmath72 minimum is found .",
    "the top four parameters shown in the sub - panel are extracted from the light curve data by default . in the odd case that those estimated values are not correct , the values can be entered directly by the user . in the example shown",
    ", the _ inclination _ prior center value has been set by the user , but no constraints have been placed on the range of valid final fitted values ( although the upper end is limited to @xmath75 by the definition of inclination ) .",
    "the _ quad ld u1 _ and _ quad ld u2 _ parameter values have been set by the user , and the fitted values have been locked to those values by enabling the _ lock _ option beside each one .",
    "the fixed values of u1 and u2 were extracted from the @xcite theoretical models using a website tool .",
    "the best fit transit model parameter values are displayed in the _ best fit _ column .",
    "a green box around the fitted parameter values indicates that the minimization converged to a value less than the _ fit tolerance _ within the _ max allowed steps_. both of those minimization parameters can be set at the bottom of the fit panel in the _ fit control _ sub - panel , but the default values normally work well .    the bottom row in the _ transit parameters _ sub - panel shows several values that are calculated from the best fit model .",
    "the host star s density , @xmath76 , is particularly interesting , since a good estimate can be derived from the transit light curve data alone .",
    "positioning the mouse pointer over any parameter will optionally cause a description of the parameter to be temporarily displayed .",
    "the _ prior width _",
    "column allows the user to optionally limit the range of a parameter s fitted value .",
    "_ prior width _ values are not normally needed , but may be helpful in fitting an ingress- or egress - only partial transit .",
    "the _ stepsize _",
    "column allows the user to set a custom initial minimization step size .",
    "however , the default values for each parameter normally work well , so setting custom values is not usually necessary .",
    "the _ detrend parameters _ sub - panel duplicates the detrend settings on the _ multi - plot y - data _ panel . however , the _ fit settings _ panel provides direct access to all detrend parameters and settings .",
    "prior center values , widths , and fitting step sizes can optionally be set for detrend parameters as well .",
    "light curve detrending is accomplished by including a @xmath72 contribution for each selected detrend parameter in the overall light curve fit .",
    "the @xmath72 contribution at each step of the minimization represents the goodness of the linear fit of the detrend parameters to the light curve after subtracting the light curve model corresponding to the current fit step . the @xmath72 contribution for all @xmath39 detrend parameters",
    "is calculated at each step of the fitting process as @xmath77 where @xmath41 indexes the detrend parameters , @xmath78 indexes the samples of the light curve , @xmath79 is the total number of samples in the light curve , @xmath80 is the observed normalized differential target flux , @xmath81 is the fitted linear coefficient for the detrend parameter values @xmath82 , @xmath83 is the expected value of the flux ( which is the normalized transit model value corresponding to the time of the @xmath84 data sample ) , and @xmath85 is the error in the normalized differential target flux for each sample .    the _ fit statistics _ sub - panel lists five statistical values that allow the user to assess the quality of the data and goodness of the model fit to the data .",
    "the values displayed from left to right are rms of the model residuals , @xmath72 per degree of freedom ( i.e. reduced @xmath72 ) , bayesian information criterion ( bic ) , the number of degrees of freedom , and the total @xmath72 .",
    "bic is defined as @xmath86 where @xmath87 is the number of fitted parameters , and @xmath39 is the number of fitted data points .",
    "the bic can be used to determine whether the addition of a new parameter to a model ( in particular an optional one such as a detrend parameter ) provides a significant improvement in the fit .",
    "if the bic value decreases by more than 2.0 when a model parameter is added , then the new model is preferred over the model with fewer parameters .",
    "a larger decrease in the bic value suggests a stronger preference for the new model .",
    "the _ plot settings _ sub - panel provides options for plotting the light curve model and the residuals .",
    "the _ fit control _ sub - panel settings are not normally needed , since by default the model fit recalculates any time a value in the panel is changed , and since the default _ fit tolerance _ and _ max allowed steps _ settings work for most light curve datasets .",
    "the multi - plot environment allows the user to include or exclude comparison stars from the comparison ensemble without re - running multi - aperture , as long as apertures were defined for all potentially good comparison stars in the original multi - aperture run .",
    "the _ multi - plot reference star settings _ panel shown in figure [ fig : aijmprefstarpanel ] provides a checkbox corresponding to each target and comparison star included in the original multi - aperture differential photometry run .",
    "deselected stars are considered target stars and selected stars are comparison stars belonging to the comparison ensemble .",
    "when a star is added to or removed from the ensemble , the relative flux values for each star are recalculated and the measurements table and plot are updated .",
    "the _ cycle enabled stars less one _ button allows the user to quickly cycle through the comparison ensemble removing one star at a time so that poor comparison stars can be quickly identified and removed from the ensemble .",
    "the _ cycle individual stars _ button can be used to quickly assess the quality of each comparison star individually by cycling through each one as a single comparison star .",
    "aij can be easily upgraded to the latest version using the update facility at _ _ aij toolbar__@xmath9__help__@xmath9_update astroimagej_. the _ astroimagej updater _ panel shown in figure [ fig : aijupdatepanel ] opens .",
    "the latest release notes are displayed by clicking the _ release notes _ button .",
    "the default value displayed in the _ upgrade to _ field is the latest version .",
    "the update is installed by clicking the _ ok _ button .",
    "when the installation is finished , aij automatically closes .",
    "the new version is activated when aij is restarted .",
    "k.a.c . acknowledges support from nasa kentucky space grant consortium graduate fellowships .",
    "k.a.c . and k.g.s .",
    "acknowledge support from nsf paare grant ast-1358862 and the vanderbilt initiative in data - intensive astrophysics .",
    "we thank the anonymous referee for a thoughtful reading of the manuscript and for useful suggestions . this work has made use of the simbad database operated at cds , strasbourg , france .",
    "the coordinate converter ( cc ) module converts astronomical coordinates and times to other formats based on observatory location and target coordinates , and integrates astroimagej with simbad and sky-map.org web services .",
    "cc can be operated as a module under full control of the user , and it can be operated under the control of dp and mp to provide automated calculations within those modules . when operated by the user , all fields are available to be set as desired . when controlled by dp and mp ,",
    "only a subset of fields are enabled for user entry , while the other fields are under the control of the program and disabled ( grayed - out ) to prevent user input .",
    "a cross - platform java based version of cc called astrocc runs completely independent of aij and is available for download from the aij website .",
    "detailed cc help is available in the menus above the cc panel at _ _",
    "the user controlled instance of the _ coordinate converter _",
    "panel is started by clicking the cc icon @xmath88{aijccicon}~\\right)$ ] on the aij toolbar .",
    "figure [ fig : aijccpanel ] shows the panel after entering wasp-12 in the simbad object i d field , selecting the observatory i d , and entering the date and time as utc 2014 - 04 - 06 01:40:49 .",
    "all other coordinate formats , time formats , solar system object proximities and altitudes , and moon phase are automatically calculated .",
    "note that the red background of the moon proximity box indicates that the moon is less than @xmath89 from the target ( @xmath90 in this case ) .",
    "the active coordinate source used to calculate the other coordinate formats has a green border ( j2000 equatorial in this case ) . any coordinate or time format",
    "can become the active source by directly entering a value into the field and pressing _ @xmath13enter@xmath14_. the two fields in the _ utc - based time _ sub - panel shown in figure [ fig : aijccpanel ] with a green background",
    "show the time of pm nautical twilight ( upper ) and am nautical twilight ( lower ) for the date , time , and observatory location specified .",
    "if the date and time showing in the other _ utc - based time _",
    "fields is during dark time , the two twilight field backgrounds are green , otherwise they are gray .",
    "the @xmath53 time format requires dynamical time as the time - base .",
    "dynamical time accounts for the changing rotational speed of the earth by implementing leap - seconds .",
    "leap - second updates are not periodic , but are announced six months before taking effect . the u.s .",
    "naval observatory website posts a list of all leap seconds along with the effective date of each one . to ensure that conversion to @xmath53 time format is accurate , cc s leap second table should be updated by clicking the _ update _ button in the _ dynamic time _ sub - panel every 6 months or so while connected to the internet .",
    "dp creates an instance of cc ( dpcc ) , and depending on user settings , data can be extracted from fits header information or entered manually to control the settings used by dpcc to calculate new astronomical values to add to the calibrated image s fits header information . if the fits header contains the time of observations , the target s simbad i d or coordinates , and the observatory s i d or coordinates , dpcc calculations can be executed with no user input . if target and/or observatory information is not available in the header , that missing information can be entered by the user as previously shown in figure [ fig : aijccpanel ] .",
    "appendix [ sec : fitsheaderupdates ] describes how to set up the various dp fits header update options and modes of operation .    the menu item at _ _ multi - plot main__@xmath9__table__@xmath9_add new astronomical data columns to table _ opens the panel shown in figure [ fig : aijadddatapanel ] .",
    "in that panel , the user sets the time format and data column name to be used for extraction of time from each row in the measurements table .",
    "an instance of cc referred to as mpcc is also opened along with the _ add astronomical data to table _ panel . with the _ ra / dec source _",
    "mode set to _",
    "manual _ as shown in figure [ fig : aijadddatapanel ] , the target coordinates and observatory location should be manually entered into the mpcc panel . with the _ ra / dec source _",
    "mode set to _",
    ", the ra and dec coordinates must have been extracted from the fits header and added to the measurements table during photometry ( see appendix [ sec : photset ] ) . in this case , the corresponding data column labels should be selected in the _ ra column _ and _ dec column _ pull - down menus . then , when the _ update table _ button is clicked , the settings shown in figure [ fig : aijadddatapanel ] will cause new data columns airmass , hjd_utc , and bjd_tdb to be calculated and added to the measurements table .",
    "the new data columns can now be used for plotting , detrending , etc . , and",
    "the updated measurements table can be saved to disk .",
    "information contained in the header of a fits image open in aij can be displayed and optionally edited by clicking the _ fits header editor _ icon @xmath91{aijfitsheadereditoricon}\\,\\right)$ ] above an image display .",
    "the _ fits header editor _ panel shown in figure [ fig : aijfitsheadereditor ] opens .",
    "a fits header is made up of keywords and associated value and comment fields .",
    "fits header keywords and values should not be edited unless the user understands the impact the change may have on the downstream interpretation of the image data .    a header value is edited by double - clicking in the field and editing the value using the keyboard .",
    "the keyword values are locked by default , but can be edited after deselecting the _ lock keyword values _ checkbox .",
    "the _ value _",
    "field may contain a string ( i.e. text enclosed in single quotes ) , integer , real number , or boolean ( i.e. a t or f ) .",
    "aij checks the formatting of the _ value _ field to ensure that the new entry meets the fits specification for one of the data types allowed .",
    "the _ type _ field is automatically set based on contents of the _ value _ field and can not be directly edited .",
    "rows with keyword values simple , bitpix , naxis , naxis1 , and naxis2 can not be edited since these values are automatically set by aij according to the image s characteristics .",
    "the end keyword must always be present in the last row and can not be edited .",
    "the buttons along the bottom of the editor , from left to right , allow the user to delete the selected row of data ( which shows as highlighted in blue ) from the header , insert a new row below the currently selected row , save the contents of the fits header to a text file , save the new header to the image in memory , save the image and new header to disk ( and memory ) using the same filename , save the image and new header to disk using a new filename , or cancel the changes and exit the editor .",
    "the astrometry feature `` plate solves ''",
    "images using an internet connection to the astrometry.net web portal at nova.astrometry.net @xcite .",
    "after a successful astrometric solution is found , wcs headers are automatically added to the fits image header , and the file can optionally be resaved with the new headers .",
    "aij searches the image and extracts the source locations .",
    "only the @xmath48 coordinates for a subset of the brightest extracted sources are sent to nova.astrometry.net .",
    "the actual image is not transferred across the network , which limits network traffic and improves the solve time",
    ".    a left - click on the _ astrometry _ icon @xmath91{aijastrometryicon}\\,\\right)$ ] above an image opens the _ astrometry settings _ panel shown in figure [ fig : aijastrometrypanel ] .",
    "a right - click on the _ astrometry _ icon starts the plate solve process using the previous settings panel values .",
    "a left - click on the _ astrometry _ icon , after the plate solve process has started , aborts the process .",
    "dp also provides an option in the _ fits header updates _ sub - panel ( see figure [ fig : aijdataprocessor ] ) to plate solve each image as part of the calibration process .",
    "a free user key must be obtained from nova.astrometry.net and entered into the _ user key _ field of the _ astrometry settings _ panel to enable the astrometry feature .",
    "images can be blindly solved with no knowledge of the sky coordinates or plate scale of the image .",
    "the default settings shown in figure [ fig : aijastrometrypanel ] should work for most images . solve time",
    "may be faster if the _ plate scale _ is known and entered into the field on the set up panel .",
    "if the approximate sky coordinates of the center of the image are known , entering the _ center ra _ and _ center dec _ values may also improve solve time",
    ". however , the search _ radius _ must be at least as large as the field of view in the image .",
    "if an image has been defocused to improve photometric precision , the _ centroid near peaks _ option may improve the determination of the location of the center of each source .    when the _ start _ button is clicked , the set up panel closes and the plate solve process starts .",
    "progress is shown in the lower half of the aij toolbar . by default ,",
    "a log file is created to record the results of each plate solve .",
    "if a time - series of images have been opened into an aij image stack , the full set of images can be solved by selecting the _ process stack _ option .",
    "the entire plate solve process takes @xmath92 seconds per image .",
    "when a field is successfully solved , nova.astrometry.net returns a list of sources that are in the image .",
    "the source names can be displayed in the image by enabling _",
    "annotate _ and/or saved to the fits header by enabling _",
    "add to header_. more set up information is provided in the tool - tip help that is available for each option in the user interface panel .",
    "the images within a stack can be aligned using the _ stack aligner _",
    "icon @xmath93{aijstackalignericon}\\,\\right)$ ] above an image stack .",
    "the _ stack aligner _ panel shown in figure [ fig : aijstackaligner ] opens and provides two methods to align images . at the time of writing ,",
    "stack aligner only supports image translation for alignment .",
    "image rotation and scaling are not currently implemented .",
    "if all images in the stack have been plate solved , the images can be aligned using information in the wcs headers . to use this mode , enable the _ use only wcs headers",
    "_ option and click the ok button to start the alignment process .",
    "all images in the stack will then be aligned to the first image .",
    "if images have not been plate solved , apertures may be used to identify alignment stars .",
    "aperture placement is performed in the same way as described for multi - aperture in  [ sec : multiaperture ] , and images are aligned based on the average of alignment star centroid offsets between consecutive images .",
    "aperture alignment works best when at least a few ( @xmath94 ) isolated stars are available in the images .",
    "aperture alignment will fail if the shift from one image to the next is larger than the aperture radius .",
    "however , the aperture radius can be made arbitrarily large as long as centroid does nt capture a neighboring star instead of the alignment star . for cases with large image shifts ,",
    "the _ use single step mode _ option allows the user to click on the first alignment star in each image of the sequence , avoiding apertures centroiding on the wrong star .",
    "however , this mode requires the user to click in each image of the sequence , which may become impractical for very long image sequences .",
    "an option is available in the _ process _ menu above an image display that provides _ image stabilizer _",
    "functionality that is useful for processing images of non - stellar objects .",
    "this tool will remove atmospheric jitter from a rapid sequence of planetary or lucky images , or track a comet over a long duration as it moves across a star field .",
    "an azimuthally averaged radial profile of an object can be plotted by left - clicking near an object in an image , and then selecting _",
    "_ analyze__@xmath9_plot seeing profile _ in the menus above the image display . as a short cut ,",
    "simply alt - left - click near an object in an image to produce the plot .",
    "if centroid is enabled , the radial profile will be centered on the object .",
    "figure [ fig : aijseeingprofile ] shows an example radial profile plot .",
    "the plot shows the half - width at half - maximum ( hwhm ) , the fwhm , and suggested aperture radii in pixels .",
    "the aperture radius is set to @xmath95fwhm , the inner radius of the sky - background annulus is set to @xmath96fwhm , and the outer radius of the sky - background annulus is set to @xmath97fwhm .",
    "these radii give an equal number of pixels in the aperture and sky - background annulus .",
    "the fwhm is also given in seconds of arc if valid wcs headers are available .",
    "the _ save aperture _ button transfers the suggested aperture radii to the _ aperture photometry settings _ discussed in appendix [ sec : photset ] .",
    "settings related to photometric measurements are specified in the _ aperture photometry settings _ panel shown in figure [ fig : aijapsetpanel ] and the _ more aperture photometry settings _ panel shown in figure [ fig : aijapsetmorepanel ] .",
    "the _ aperture photometry settings _ panel can be accessed by double - clicking the _ single aperture photometry _",
    "icon @xmath98{aijapmodeicon}\\,\\right)$ ] on the aij toolbar , by clicking the set aperture icon @xmath99{aijapseticon}\\,\\right)$ ] above an image , by clicking the _ aperture settings _ button near the bottom of the _ multi - aperture measurements _ set up panel , or by clicking the set aperture icon @xmath100{aijdpapseticon}\\,\\right)$ ] in the dp _ control panel _ sub - panel .",
    "the _ more aperture photometry settings _ panel is accessed by clicking the _ more settings _ button on the _ aperture photometry settings _ panel .    the _ aperture photometry settings _ panel provides access to the aperture radii , centroid , and background settings that are also available in the _ multi - aperture measurements _ set up panel ( see  [ sec : multiaperture ] ) . a list of fits keywords can be entered to specify that the corresponding numeric data in the image headers be added to the measurements table .",
    "the ccd gain , readout noise , and dark current should be entered for proper photometric error calculations .",
    "linearity and saturation warning levels should be entered so that indicators of those conditions can we properly noted in the measurements table ( see appendix [ app : measurementstable ] ) and the _ multi - plot reference star settings _ panel ( see  [ sec : ensemblemanagement ] ) .",
    "the _ howell _ centroid method @xcite gives highly repeatable _ x , y _ results ( i.e. is not sensitive to the _ x , y _ starting location ) . if the _ howell _ option is disabled , a center - of - mass ( i.e. center - of - flux ) routine is used to calculate the centroid .",
    "this method provides better results when placing apertures around defocused stars .",
    "the top two sections of the _ more aperture photometry settings _ panel allow the selection of photometric data items to be included in the measurements table .",
    "see appendix [ app : measurementstable ] for a description of each data item .",
    "it is highly recommended to enable all data items since some aij functionality requires certain data items to be available in the table .",
    "the maximum number of apertures per image is set high by default , but can be changed as needed .",
    "the aperture display options control which parts of the aperture overlay are displayed on the image . the _ sky annulus _ , _ source number _ , and _ value _ check boxes duplicate the same controls available above an image display . for typical operation , _",
    "clear overlay after use _ should be selected and _ clear overlay before use _ should be deselected .",
    "dp provides the option to calculate new astronomical data and add it to the fits header of a calibrated image .",
    "the option is enabled by selecting the _ general _ check box in the _ fits header updates _ sub - panel of dp .",
    "a set up panel is accessed by clicking the _ general fits header settings _ icon @xmath101{aijfitsheaderupdatesicon}\\,\\right)$ ] .",
    "the _ general fits header settings _ panel shown in figure [ fig : aijfitsheaderupdates ] opens .",
    "the _ fits header input settings _ sub - panel defines fits header keywords that are preexisting in the raw science image headers that may be used in the calculation of various new astronomical data values specified in the _ fits header output settings _ sub - panel .",
    "these new astronomical data are added to the fits header of the calibrated images using the specified keyword names .",
    "the astronomical calculations require the target sky coordinates and observatory geographical coordinates to be supplied to dp coordinate converter ( dpcc ; see appendix [ sec : coordinateconverter ] ) .",
    "both sets of coordinates can be manually entered into dpcc by setting the _ target coordinate source _ option to _ coordinate converter manual entry _ and the _ observatory location source _ option to _ coordinate converter manual entry_. alternatively , coordinate information can be automatically supplied to dpcc from the fits header of the raw image by setting the corresponding keyword names in the _ fits header input settings _ sub - panel and then selecting the appropriate _ target coordinate source _ and _ observatory location source _ to match the type of data in the header ( i.e. a target or observatory name or a set of numeric coordinates ) .",
    "all typical data and image products created by aij can be saved with one action using the _ save all _ features in the _ file _ menu of the _ multi - plot main _ panel .",
    "there are also _ file _ menu options in _ multi - plot main _ and image display panels to save each data product separately .",
    "the menu option at _ _",
    "file__@xmath9_save all ( with options ) _ opens the _ save all _ settings panel shown in figure [ fig : aijsaveallpanel ] .",
    "individual items that can be included in the save all process are enabled in the array of checkboxes at the top of the panel .",
    "a base file name , _ filebase _ , is specified in a separate _ file save _ dialog and then the suffix names specified in the _ save all _ panel are appended as the files are saved .",
    "the checkbox at the bottom of the panel specifies whether images are saved in _",
    "png _ or _ jpg _ format .",
    "the menu option at _ _",
    "file__@xmath9_save all _ runs the process using previous settings without opening the _ save all _ settings panel .",
    "if the _ image _ option is enabled , the image in the active image display ( i.e. the last image clicked with the mouse if more than one is open ) is saved to a file name constructed from the _ filebase _ and the suffix specified in _ science image display suffix _ and with a filetype of _ png _ or _ jpg _ , depending on the format selected at the bottom of the panel . for the configuration shown in figure [ fig : aijsaveallpanel ] , the file would be named `` _ _ filebase___field.png '' .",
    "this image will include any items currently being displayed in the non - destructive image overlay .",
    "if no image display is open , no file will be created . if the _ plot _ option is enabled and a plot is being displayed , the plot image will be saved using the _ filebase _ and file suffix in _ plot image display suffix _ and with a filetype of either _ png _ or _",
    "jpg_.    if the _ plot config _ option is enabled , the current state of all plot settings will be saved to a plot configuration file using the _ filebase _ and file suffix in _ plot config file suffix _ and with a filetype of _",
    "plotcfg_. if _ data table _ is enabled , the full measurements table will be saved to a file using the _ filebase _ and file suffix in _ full data table file suffix _ and with a filetype as specified in the aij toolbar menu item _ _ edit__@xmath9__options__@xmath9__input / output__@xmath9_file extension for tables_. the default filetype is _ xls _ , but this can be changed to something more unique to aij ( e.g _ tbl _ ) so that measurements tables can be set to open into aij with a double - click on the corresponding file in an os window .",
    "_ tip : _ if _ plot config file suffix _ and _ full data table file suffix _ are the same , when a measurements table is opened into aij by dragging it from the os onto a multi - plot panel , or by double - clicking the file in an os window , the plot configuration file will be loaded along with the measurements table so that the corresponding plot will be automatically recreated .",
    "if the _ show data subset panel _ and _ data subset _ options are enabled , the panel shown in figure [ fig : aijsavedatasubsetpanel ] opens as part of the _ save all _ process to allow the user to select a subset of data columns from the measurements table to be saved as a separate tab - delimited file .",
    "the labels of data columns that are to be included are selected in the pull - down menus .",
    "the top - most item appears as the first column in the saved file .",
    "the bottom - most item appears as the last column in the table .",
    "blank entries do not produce a data column .",
    "the table will be saved using the _ filebase _ and file suffix in _ data table subset file suffix _ and with a filetype of _",
    "dat_. if the _ data subset _ option is enabled , but the _ show data subset panel _ option is disabled , a data subset file will be created using the previous settings without opening the _ save data subset _ panel .    if the _ apertures _ option is enabled ,",
    "the aperture settings used in the most recent multi - aperture run are saved to a file using the _ filebase _ and suffix in _ aperture file suffix _ and with a filetype of _",
    "apertures_. if the _",
    "fit panels _",
    "option is enabled , images of all open _ fit settings _ panels are saved to files using the _ filebase _ , the suffix in _",
    "fit panel image suffix _ , the _ data set _ number from the _ multi - plot y - data _ panel , plus the fitted data column name , and with a filetype of either _ png _ or _ jpg_. if the _ fit text _ option is enabled , text - based representations of all open _ fit settings _ panels are saved to files using the _ filebase _ , the suffix in _ fit data text file suffix _ , the _ data set _ number from the _ multi - plot y - data _ panel , plus the fitted data column name , and with a filetype of _",
    "txt_. if the _ log _ option is enabled and a _ log _ panel is open , the log text is saved to a file using the _ filebase _ and suffix in _ log file suffix _ and with a filetype of _",
    "proper estimation of the uncertainty ( i.e. error or noise ) in each photometric measurement is important for reporting the significance of the measurement and plotting error bars in the light curve plot , but it is also important for the proper calculation of the best fit model to the data , since the uncertainty of each measurement , @xmath102 , is part of the @xmath72 calculation used in the fitting process ( e.g. see equation [ eq : chi2fordetrend ] ) . in short ,",
    "the @xmath72 contribution from each data point is weighted by a factor of @xmath103 , which places more weight on data with small errors , and less weight on data with large errors .",
    "@xcite and @xcite discuss the noise contributions to the measurement of a point source using ccd aperture photometry and develop the `` ccd equation '' to estimate the signal - to - noise ratio of a measurement .",
    "@xcite construct a computer model of the same measurement and develop the more rigorous `` revised ccd equation '' .",
    "the equation gives the total noise for a ccd aperture photometry measurement as : @xmath104 where @xmath105 is the gain of the ccd in electrons / adu , @xmath106 is the net ( background subtracted ) integrated counts in the aperture in adu , @xmath107 is the number of pixels in the aperture , @xmath108 is the number of pixels in the region used to estimate sky background , @xmath109 is the number of sky background counts per pixel in adu , @xmath110 is the total dark counts per pixel in electrons , @xmath111 is read noise in electrons / pixel / read , and @xmath112 is the standard deviation of the fractional count lost to digitization in a single pixel ( @xmath113 adu for @xmath114 uniformly distributed between @xmath115 and @xmath116 ) .",
    "if the net integrated counts from the source , @xmath106 , dominates the other terms , and the gain @xmath117 , the total noise approaches the poisson noise limit of @xmath118 .",
    "the noise increases as the number of pixels in the aperture increases ( due to all of the secondary terms in the equation ) , but for a non - ideal ccd , noise introduced by inter - pixel variations decreases with increasing aperture size ( except in the case of perfectly guided telescope ) , so the aperture size needs to be selected after considering both factors .",
    "the number of background region pixels should be chosen to be as large as possible , but not so large that the pixels far from the aperture are no longer representative of the local background at the aperture .",
    "if a source is faint relative to the local sky background , the poisson noise of the sky background may dominate the overall measurement noise .",
    "the aij photometer automatically performs the noise calculation described by equation [ eq : ccdnoise ] for each aperture . for proper noise calculation",
    ", the gain , dark current , and read out noise of the ccd detector used to collect the data must be entered in the _ aperture photometry settings _ panel ( see appendix [ sec : photset ] ) . for differential",
    "photometry , aij propagates the noise from all apertures to derive the error in differential flux measurements .",
    "first , the noise from the apertures of each comparison star are combined in quadrature to give the total comparison ensemble noise : @xmath119 where @xmath38 indexes the comparison stars of the ensemble , and @xmath120 is the noise for each comparison star as calculated by equation [ eq : ccdnoise ] , and @xmath39 is the number of comparison stars .",
    "error is then propagated through the relative flux quotient to find the relative flux error for the target star as : @xmath121 where @xmath122 is the net integrated counts in the target aperture , @xmath123 is the sum of the net integrated counts in the ensemble of comparison star apertures , @xmath124 is the noise in the target star aperture from equation [ eq : ccdnoise ] , and @xmath125 is the ensemble noise from equation [ eq : ensemblenoise ] .",
    "aij labels the relative flux error columns as rel_flux_err_t__nn _ _ , and rel_flux_err_c__nn _ _ for target and comparison stars , respectively , where _ nn _ is the aperture number .",
    "aij estimates the uncertainty in each measurement based only on the factors included in equation [ eq : ccdnoise ] .",
    "additional sources of photometric uncertainty not accounted for by aij include atmospheric scintillation , variable leakage of flux from neighboring stars into the aperture as seeing changes slightly from exposure to exposure , poisson noise in the master dark and master flat images , slight variations in ccd bias in the time - series , cosmic ray impacts on the detector , varying contributions of square pixels to a circular aperture , camera shutter open / close variations , and inaccurate determination of sky - background from exposure - to - exposure .",
    "atmospheric scintillation noise can dominate for short exposures and/or telescopes with small apertures .",
    "@xcite described the theoretical approach to estimating the amount of scintillation noise , @xcite conducted observations to test the theory and formalized the equation , and @xcite clarified a factor in the equation .",
    "the resulting scintillation noise equation is @xmath126 where @xmath127 is the telescope diameter in centimeters , @xmath128 is the airmass , @xmath129 is the exposure time in seconds , and @xmath130 is the altitude of the observatory in meters . again",
    ", this noise source is _ not _ included in the aij photometric uncertainty estimate .",
    "the apparent magnitude of target aperture sources can be calculated by entering the apparent magnitude of one or more comparison aperture sources .",
    "the calculations can be done at the time multi - aperture differential photometry is being processed by enabling the _ prompt to enter ref star apparent magnitude _ option in the _ multi - aperture measurements _ set up panel .",
    "this option causes a _ magnitude entry _",
    "dialog box to appear when a comparison aperture is placed .",
    "the comparison aperture apparent magnitude should be entered , or the entry should be left blank if that comparison aperture is not to be used for target aperture apparent magnitude calculations . however , at least one comparison aperture apparent magnitude must be entered to enable the calculation of target aperture apparent magnitude .",
    "if wcs information is available in the fits image header , simbad information is presented by default to assist in determining the comparison star apparent magnitude .",
    "this option can be disabled in the _ magnitude entry",
    "_ dialog box .",
    "ok _ in the dialog to continue placing apertures .",
    "when _ ok _ is clicked , the comparison aperture magnitude will show by default in the aperture image overlay .",
    "the first value is the magnitude entered by the user , and the second value is the net integrated counts in the aperture .",
    "the display of the two values can be controlled using the two options near the bottom of the image display _ view _ menu in combination with the _ aperture value _ display icon @xmath23{aijapvalueicon}\\,\\right)$ ] .",
    "the target apparent magnitudes are also calculated `` on - the - fly '' from the comparison aperture magnitudes and displayed as part of the target aperture image overlay .",
    "each time a new comparison aperture magnitude is entered , target aperture magnitudes are recalculated from all comparison aperture magnitudes and net integrated counts .",
    "comparison aperture apparent magnitude values can be adjusted or added in the _ multi - plot reference star settings _ panel after differential photometry has been completed .",
    "if magnitude entry boxes are not displayed in the panel , click the _ show magnitudes _ button . after adding or changing a value , the _ @xmath13enter@xmath14 _",
    "key must be pressed to update the target aperture apparent magnitudes and the measurements table entries .",
    "simbad data for a comparison aperture can be accessed by right - clicking on the corresponding comparison aperture magnitude box in the _ multi - plot reference star settings _ panel .",
    "this feature requires that at least the first image used to derive the data in the measurements table have wcs header information , so that the ra__xnn _ and dec__xnn _ columns produced by multi - aperture will exist with valid values in the first row of the table , where _ nn _ is the aperture number , @xmath131 for target apertures , and @xmath132 for comparison apertures .    two columns labeled source_amag__xnn _ and source_amag_err__xnn _ will be included in the measurements table for each target aperture and for each comparison aperture with an apparent magnitude entry , where _ x _ and _ nn _ are as defined previously .",
    "the columns labeled source_amag__xnn _ contain the user entered apparent magnitudes for comparison apertures and the calculated apparent magnitudes for target apertures .",
    "the comparison aperture apparent magnitudes will be constant in the measurements table since the comparison sources are assumed to have constant brightness .",
    "the columns labeled source_amag_err__xnn _ contain the apparent magnitude errors .",
    "these error values do not include the uncertainty in the user entered comparison source apparent magnitudes .",
    "if the source_amag__xnn _ columns are plotted using mp , enable the _ input in mag _ option on the corresponding row of the _ multi - plot y - data _ panel since these are magnitude - based data rather than flux - based data . the source_amag__xnn _",
    "column for the target source of interest is ideal for submitting to the minor planet center using the _ multi - plot main _ menu option _ _ file__@xmath9_create minor planet center format_.    the apparent magnitude of the source in target aperture _ nn _ is calculated as @xmath133 where _ nn _ is the target aperture number , _ xx _ indexes all comparison apertures for which an apparent magnitude has been entered by the user , source_amag_c__xx _ _ are the user entered comparison source apparent magnitudes , and source - sky_t__nn _ _ and source - sky_c__xx _ _ are the net integrated counts in apertures _ nn _ and _ xx _ as defined in appendix [ app : measurementstable ] and  [ sec : photometry ] .",
    "the uncertainty in the apparent magnitude of the source in target aperture _ nn _ is calculated as @xmath134 where _ nn _ is the target aperture number , _ xx _ indexes all comparison apertures for which an apparent magnitude has been entered by the user , source - sky_t__nn _ _ and source - sky_c__xx _ _ are the net integrated counts and source_error_t__nn _ _ and source_error_c__xx _ _ are the net integrated counts uncertainties for apertures _ nn _ and _ xx _ as defined in appendix [ app : measurementstable ] and  [ sec : photometry ] .",
    "the target aperture apparent magnitude uncertainties do not include the uncertainty in the comparison source apparent magnitudes entered by the user .",
    "the uncertainty in the apparent magnitude of the source in comparison aperture _ nn _ is calculated as @xmath135 where _ nn _ is the comparison aperture number and source - sky_c__nn _ _ and source_error_c__nn _ _ are the net integrated counts and the net integrated counts uncertainty , respectively , for comparison aperture _",
    "nn_. the comparison aperture apparent magnitude uncertainty is simply the flux - based photometric error converted to the magnitude scale .",
    "these values do not include the uncertainty in the comparison source apparent magnitudes entered by the user .",
    "the results from single aperture photometry and multi - aperture differential photometry are stored in ",
    "measurements tables \" . for single aperture photometry , each row in a table",
    "contains all measurements produced from a single aperture . for multi - aperture differential photometry",
    ", a row contains all measurements produced by all apertures in a single image , and a row exists for each image that has been processed .",
    "each column contains the same measurement from all images .",
    "columns are labeled with unique names , and those names are available for selection in the pull - down menus in the _ multi - plot main _ and _ multi - plot y - data _ panels .",
    "an example of part of a measurements table is shown in figure [ fig : aijmeasurementstable ] .",
    "as discussed in the last paragraph of appendix [ sec : coordinateconverter ] , new astronomical data such as airmass , @xmath53 , etc . can be calculated and added to the measurements table using the menu item at _ _ multi - plot main__@xmath9__table__@xmath9_add new astronomical data columns to table_.    all data in a measurements table can be cleared by clicking the _ clear measurements table data _",
    "icon @xmath136{aijcleartableicon}\\,\\right)$ ] above an image display or in the _ data processor _ panel .",
    "one or more rows can removed from a table by selecting them using the mouse and then selecting the menu option _",
    "_ edit__@xmath9_clear _ at the top of the measurements table .",
    "measurements tables can be saved using the _ file _ menu options of the measurements table and _ multi - plot main _ panels .",
    "a subset of data columns from a measurements table can be saved using the menu option _ _ multi - plot main__@xmath9_save data subset to file _ as discussed in appendix [ sec : saveall ] .",
    "measurements tables can be opened using the _ file _ menu options on the _ multi - plot main _ panel , the aij toolbar _ read measurements table _ icon @xmath6{aijtableopenicon}\\,\\right)$ ] , or by dragging a measurements table file from an os window and dropping it onto any of the multi - plot control panels .",
    "any tab , comma , or space delimited data table can be opened as a measurements table .",
    "however , we strongly suggest that the first row of the table contain text - based labels for each column so that the multi - plot data column labels will be representative of the data in each column of the table .",
    "the measurements and associated column labels produced when preforming multi - aperture differential photometry are described in the list below . a suffix `` _ _ xnn _ '' denotes the aperture identification , where _ x _ is either t or c for target or comparison aperture , respectively , and _ nn _ is the aperture number .",
    "each measurement item can be selected for inclusion in the measurements table in the _ more aperture photometry settings _ panel ( see appendix [ sec : photset ] ) .    * * j.d.-2400000 * : modified julian date of the observation ( utc based ) .",
    "availability requires utc time and date information in the fits header .",
    "if keyword exptime is also available in the header , time of mid - exposure is indicated , otherwise start of exposure is indicated . *",
    "* jd_utc * : if this keyword value is set and successfully extracted from the fits header , the header value is indicated .",
    "otherwise , the full julian date of the observation ( utc based ) is indicated based on the value in j.d.-2400000 . * * source_radius * : radius of the aperture used to calculate net integrated counts . in fixed aperture mode , this value is the aperture radius set by the user . in variable aperture mode , this value represents the actual aperture radius calculated as the product of the average fwhm in the image and the multiplicative factor set in the _ multi - aperture measurements _ set up panel . *",
    "* fwhm_mult * : in variable aperture mode , this value is the fwhm multiplier set in the _ multi - aperture measurements _ set up panel . in fixed aperture mode ,",
    "this column is not included in the table .",
    "* * source_rad(base ) * : in variable aperture mode , this value represents the fixed aperture radius set by the user and should be set to a number greater than 1.5 times the maximum fwhm expected to ensure proper measurement of fwhm . in fixed aperture mode ,",
    "this column is not included in the table .",
    "* * sky_rad(min ) * : radius of the inner edge of the annulus used to calculate the sky background * * sky_rad(max ) * : radius of the outer edge of the annulus used to calculate the sky background * * x(ij)__xnn _ * : the x - location in imagej pixel coordinates of the center of aperture _ nn _ * * y(ij)__xnn _ * : the y - location in imagej pixel coordinates of the center of aperture _ nn _ * * x(fits)__xnn _ * : the x - location in fits coordinates of the center of aperture _ nn _ * * y(fits)__xnn _ * : the y - location in fits coordinates of the center of aperture _ nn _ * * rel_flux_t__nn _ _ * : the ratio of the net integrated counts in target aperture _ nn _ to the total net integrated counts of all comparison stars . mathematically the value is calculated as source - sky_t__nn _ _ / @xmath137(source - sky_c_xx _ ) , where _ xx _",
    "indexes all comparison star apertures . *",
    "* rel_flux_c__nn _ _ * : the ratio of the net integrated counts in comparison aperture _ nn _ to the total net integrated counts of all _ other _ comparison stars .",
    "mathematically the value is calculated as source - sky_c__nn _ _ / @xmath137(source - sky_c_xx _ ) ,",
    "where _ xx _ indexes all comparison star apertures and @xmath138 .",
    "* * rel_flux_err__xnn _ * : the error in the relative flux for object _",
    "nn_. the error is calculated by propagating all source_error__xnn _ values through the equations defined for rel_flux__xnn _ as described in appendix [ app : photerr ] .",
    "* * rel_flux_snr__xnn _ * : signal - to - noise ratio for rel_flux__xnn_. this value is simply rel_flux__xnn _",
    "/ rel_flux_err__xnn_. * * source - sky__xnn _ * : net integrated counts within aperture _ nn_. net integrated counts is defined as the sum of all pixel values less sky background for all pixels having a center that falls within the aperture radius . * * source_error__xnn _ * : error in the net integrated counts for aperture _",
    "nn_. see appendix [ app : photerr ] for a description of how the photometric error is calculated . *",
    "* source_snr__xnn _ * : signal - to - noise ratio aperture _",
    "nn_. this value is simply source - sky__xnn _",
    "/ source_error__xnn_. * * tot_c_cnts * : the sum of the net integrated counts in all comparison apertures .",
    "tot_c_cnts = @xmath137(source - sky_c_xx _ ) , where _ xx _ indexes all comparison apertures . * * tot_c_err * : the error in tot_c_cnts .",
    "the error is calculated by combining all source_error_c__xx _ _ values in quadrature , where _ xx _ indexes all comparison stars . * * peak__xnn _ * : the highest pixel value in aperture _ nn _ ( _ not _ background subtracted ) * * mean__xnn _ * : the mean pixel value in aperture _ nn _ ( _ not _ background subtracted ) * * sky / pixel__xnn _ * : the sky background estimate for aperture _",
    "nn_. depending on the options selected , the value may be the mean value of all pixels , the mean value of all pixels after iterative @xmath46 cleaning , or a plane fitted to ( possibly @xmath46 iteratively cleaned ) pixels in the sky - background annulus of aperture _ nn_. * * x - width__xnn _ * : an estimate of the x - direction fwhm of the psf of the object in aperture",
    "_ nn_. the aperture radius should extend beyond 1.5 @xmath139 fwhm in the x - direction to enable the best estimate . *",
    "* y - width__xnn _ * : an estimate of the y - direction fwhm of the psf of the object in aperture _ nn_.",
    "the aperture radius should extend beyond 1.5 @xmath139 fwhm in the y - direction to enable the best estimate . * * width__xnn _ * : the mean of the x- and y - direction fwhm values for aperture _",
    "nn_. the aperture radius should extend beyond 1.5 @xmath139 fwhm in the both the x- and y - directions to enable the best estimate . *",
    "* saturated * : zero indicates that the peak value in all apertures is less than the _ saturation warning _ value set in the _ aperture photometry settings _ panel ( see appendix [ sec : photset ] ) .",
    "a number other than zero indicates the highest peak value that exceeded the set limit .",
    "* * source_amag_c__nn _ _ * : comparison aperture _ nn _ apparent magnitude entered by the user .",
    "this column s values are the same in all rows since the comparison source is assumed to be constant .",
    "this column does not exist if apparent magnitude has not been entered for aperture _ nn_. * * source_amag_t__nn _ _ * : target aperture _ nn _ apparent magnitude calculated from all comparison apertures having an apparent magnitude entry .",
    "this column does not exist if apparent magnitude has not been entered for any comparison apertures .",
    "equation [ eq : targetappmag ] defines how this value is calculated . *",
    "* source_amag_err_t__nn _ _ * : target aperture _ nn _ apparent magnitude uncertainty . this column does not exist if apparent magnitude has not been entered for any comparison apertures .",
    "equation [ eq : targetappmagerr ] defines how this value is calculated . *",
    "* source_amag_err_c__nn _ _ * : comparison aperture _ nn _ apparent magnitude uncertainty .",
    "this column does not exist if apparent magnitude has not been entered for aperture _",
    "nn_. equation [ eq : compappmagerr ] defines how this value is calculated .",
    "the numeric values of fits header keywords can also be extracted from an image ( or series of images ) and included in a measurements table when performing single aperture or multi - aperture differential photometry . the associated column in the table",
    "will be labeled using the keyword name .",
    "these keyword names must be specified in the _ keywords ( comma separated ) _ list in the _ aperture photometry settings _ panel ( see appendix [ sec : photset ] ) . as discussed in appendix",
    "[ sec : fitsheaderupdates ] , dp provides the option to calculate new astronomical data and add them to the fits header of a calibrated image . a keyword name specified in the _ keywords ( comma separated ) _ list in the _ aperture photometry settings",
    "_ panel must match the keyword name specified in the _ fits header output settings _ sub - panel of the _ general fits header settings _ panel to properly transfer the dp calculated astronomical data into the measurements table .",
    "in addition , the _ fits header update _",
    "option must be enabled and the target and observatory coordinates must be provided through one of the various options in the dp _ fits header updates _ sub - panel .",
    "utc date , time , and exposure time information must also exist in the fits header of the raw image .",
    "some keywords containing astronomical data calculated by dp that are often extracted from the calibrated image headers and added to the measurements table are listed below .    * * hjd_utc * : utc - based heliocentric julian date of this measurement at the mid - point of the exposure ( see @xcite for a complete definition of @xmath140 ) * * bjd_tdb * : tdb - based barycentric julian date of this measurement at the mid - point of the exposure ( see @xcite for a complete definition of @xmath141 ) * * alt_obj * : altitude of the target coordinates above the horizon at mid - exposure * * airmass * : airmass of the target coordinates at mid - exposure"
  ],
  "abstract_text": [
    "<S> imagej is a graphical user interface ( gui ) driven , public domain , java - based , software package for general image processing traditionally used mainly in life sciences fields . </S>",
    "<S> the image processing capabilities of imagej are useful and extendable to other scientific fields . here </S>",
    "<S> we present astroimagej ( aij ) , which provides an astronomy specific image display environment and tools for astronomy specific image calibration and data reduction . </S>",
    "<S> although aij maintains the general purpose image processing capabilities of imagej , aij is streamlined for time - series differential photometry , light curve detrending and fitting , and light curve plotting , especially for applications requiring ultra - precise light curves ( e.g. , exoplanet transits ) . </S>",
    "<S> aij reads and writes standard fits files , as well as other common image formats , provides fits header viewing and editing , and is world coordinate system ( wcs ) aware , including an automated interface to the astrometry.net web portal for plate solving images . </S>",
    "<S> although aij provides research grade image calibration and analysis tools , its gui driven approach and cross - platform compatibility enable new users , even at the level of undergraduate student , high school student , or amateur astronomer , to quickly start processing , modeling , and plotting astronomical image data with one tightly integrated software package . </S>"
  ]
}