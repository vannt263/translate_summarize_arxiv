{
  "article_text": [
    "relativity is a crucial ingredient in a variety of astrophysical phenomena .",
    "for example the jets that are expelled from the cores of active galaxies reach velocities tantalizingly close to the speed of light , and motion near a black hole is heavily influenced by space - time curvature effects .",
    "in the recent past , substantial progress has been made in the development of numerical tools to tackle relativistic gas dynamics problems , both on the special- and the general - relativistic side , for reviews see @xcite .",
    "most work on numerical relativistic gas dynamics has been performed in an eulerian framework , a couple of lagrangian smooth particle hydrodynamics ( sph ) approaches do exist though .",
    "+ in astrophysics , the sph method has been very successful , mainly because of its excellent conservation properties , its natural flexibility and robustness . moreover , its physically intuitive formulation has enabled the inclusion of various physical processes beyond gas dynamics so that many challenging multi - physics problems could be tackled . for recent reviews of the method",
    "we refer to the literature @xcite .",
    "relativistic versions of the sph method were first applied to special relativity and to gas flows evolving in a fixed background metric @xcite .",
    "more recently , sph has also been used in combination with approximative schemes to dynamically evolve space - time @xcite .",
    "+ in this paper we briefly summarize the main equations of a new , special - relativistic sph formulation that has been derived from the lagrangian of an ideal fluid .",
    "since the details of the derivation have been outlined elsewhere , we focus here on a set of numerical benchmark tests that complement those shown in the original paper @xcite .",
    "some of them are `` standard '' and often used to demonstrate or compare code performance , but most of them are more violent  and therefore more challenging",
    " versions of widespread test problems .",
    "an elegant approach to derive relativistic sph equations based on the discretized lagrangian of a perfect fluid was suggested in @xcite .",
    "we have recently extended this approach @xcite by including the relativistic generalizations of what are called `` grad - h - terms '' in non - relativistic sph @xcite . for details of the derivation",
    "we refer to the original paper @xcite and a recent review on the smooth particle hydrodynamics method @xcite .",
    "+ in the following , we assume a flat space - time metric with signature ( -,+,+,+ ) and use units in which the speed of light is equal to unity , @xmath0 .",
    "we reserve greek letters for space - time indices from 0 ... 3 with 0 being the temporal component , while @xmath1 and @xmath2 refer to spatial components and sph particles are labeled by @xmath3 and @xmath4 .",
    "+ using the einstein sum convention the lagrangian of a special - relativistic perfect fluid can be written as @xcite l_pf , sr= - t^ u_u _ dv[eq : fluid_lag_srt ] , where t^= ( n[1 + u(n , s ) ] + p ) u^u^+ p ^ denotes the energy momentum tensor , @xmath5 is the baryon number density , @xmath6 is the thermal energy per baryon , @xmath7 the specific entropy , @xmath8 the pressure and @xmath9 is the four velocity with @xmath10 being proper time .",
    "all fluid quantities are measured in the local rest frame , energies are measured in units of the baryon rest mass energy obviously depends on the ratio of neutrons to protons , i.e. on the nuclear composition of the considered fluid .",
    "] , @xmath11 . for practical simulations we give up general covariance and perform the calculations in a chosen `` computing frame '' ( cf ) . in the general case ,",
    "a fluid element moves with respect to this frame , therefore , the baryon number density in the cf , @xmath12 , is related to the local fluid rest frame via a lorentz contraction n= n , [ rosswog::eq : n_vs_n ] where @xmath13 is the lorentz factor of the fluid element as measured in the cf .",
    "the simulation volume in the cf can be subdivided into volume elements such that each element @xmath14 contains @xmath15 baryons and these volume elements , @xmath16 , can be used in the sph discretization process of a quantity @xmath17 : f()= _ b f_b w(|-_b|,h),[eq : sph_discret ] where the index labels quantities at the position of particle @xmath14 , @xmath18 .",
    "our notation does not distinguish between the approximated values ( the @xmath17 on the lhs ) and the values at the particle positions ( @xmath19 on the rhs ) .",
    "the quantity @xmath20 is the smoothing length that characterizes the width of the smoothing kernel @xmath21 , for which we apply the cubic spline kernel that is commonly used in sph @xcite .",
    "applied to the baryon number density in the cf at the position of particle @xmath22 , eq .",
    "( [ eq : sph_discret ] ) yields : n_a= n(_a)= _ b _ b w(|_a-_b|,h_a).[eq : dens_summ_sr ] this equation takes over the role of the usual density summation of non - relativistic sph , @xmath23 . since we keep the baryon numbers associated with each sph particle , @xmath15 , fixed , there is no need to evolve a continuity equation and baryon number is conserved by construction .",
    "if desired , the continuity equation can be solved though , see e.g. @xcite .",
    "note that we have used @xmath22 s own smoothing length in evaluating the kernel in eq .",
    "( [ eq : dens_summ_sr ] ) . to fully exploit the natural adaptivity of a particle method",
    ", we adapt the smoothing length according to h_a= ( ) ^-1/d[eq : dens_summ_sr_n_b ] , where @xmath24 is a suitably chosen numerical constant , usually in the range between 1.3 and 1.5 , and @xmath25 is the number of spatial dimensions . hence , similar to the non - relativistic case @xcite , the density and the smoothing length mutually depend on each other and a self - consistent solution for",
    "both can be obtained by performing an iteration until convergence is reached .",
    "+ with these prerequisites at hand , the fluid lagrangian can be discretized @xcite l_sph , sr= - _ b [ 1 + u(n_b , s_b)].[eq : sr : l_sph ] using the first law of thermodynamics one finds ( for a detailed derivation see sec . 4 in @xcite ) for the canonical momentum per baryon _ a = _ a _ a ( 1+u_a+ ) [ eq : can_mom ] , which is the quantity that we evolve numerically .",
    "its evolution equation follows from the euler - lagrange equations , - = 0 , as @xcite = - _ b _ b ( _ a w_ab(h_a ) + _ a w_ab(h_b ) ) , [ eq : momentum_eq_no_diss ] where the `` grad - h '' correction factor _ b1-",
    "k was introduced . as numerical energy variable",
    "we use the canonical energy per baryon , _ a _ a ( 1+u_a+ ) - = _ a _ a + [ eq : sr : epsilon_a ] which evolves according to @xcite = - _ b _ b ( _ a w_ab(h_a ) + _ a w_ab(h_b ) ) .",
    "[ eq : ener_eq_no_diss ] as in grid - based approaches , at each time step a conversion between the numerical and the physical variables is required @xcite .",
    "+ the set of equations needs to be closed by an equation of state . in all of the following tests , we use a polytropic equation of state ,",
    "@xmath26 , where @xmath27 is the polytropic exponent ( keep in mind our convention of measuring energies in units of @xmath11 ) .",
    "to handle shocks , additional artificial dissipation terms need to be included .",
    "we use terms similar to @xcite ( ) _ diss= - _ b _ b _ ab _ ab= - ( _ a^-_b^ ) _ ab [ rosswog::eq : diss_mom ] and ( ) _ diss= - _ b _ b _ ab _ ab = - ( _ a^-_b^)_ab .",
    "[ rosswog::eq : diss_en ] here @xmath28 is a numerical constant of order unity , @xmath29 an appropriately chosen signal velocity , see below , @xmath30 , and @xmath31 is the unit vector pointing from particle @xmath14 to particle @xmath22 . for the symmetrized kernel gradient we use",
    "= . note that in @xcite @xmath32 was used instead of our @xmath33 , in practice we find the differences between the two symmetrizations negligible .",
    "the stars at the variables in eqs .",
    "( [ rosswog::eq : diss_mom ] ) and ( [ rosswog::eq : diss_en ] ) indicate that the projected lorentz factors _",
    "k^= are used instead of the normal lorentz factor .",
    "this projection onto the line connecting particle @xmath22 and @xmath14 has been chosen to guarantee that the viscous dissipation is positive definite @xcite .",
    "+ the signal velocity , @xmath29 , is an estimate for the speed of approach of a signal sent from particle @xmath22 to particle @xmath14 .",
    "the idea is to have a robust estimate that does not require much computational effort .",
    "we use @xcite v_sig , ab= max(_a,_b),[eq : vsig ] where _ k^=",
    "max(0,^_k ) with @xmath34 being the extreme local eigenvalues of the euler equations ^_k= and @xmath35 being the relativistic sound velocity of particle @xmath4 .",
    "these 1d estimates can be generalized to higher spatial dimensions , see e.g. @xcite .",
    "the results are not particularly sensitive to the exact form of the signal velocity , but in experiments we find that eq .",
    "( [ eq : vsig ] ) yields somewhat crisper shock fronts and less smeared contact discontinuities ( for the same value of @xmath28 ) than earlier suggestions @xcite .",
    "+ since we are aiming at solving the relativistic evolution equations of an _ ideal _ fluid , we want dissipation only where it is really needed , i.e. near shocks where entropy needs to be produced .",
    "to this end , we assign an individual value of the parameter @xmath28 to each sph particle and integrate an additional differential equation to determine its value . for the details of the time - dependent viscosity parameter treatment we refer to @xcite .",
    "in the following we demonstrate the performance of the above described scheme at a slew of benchmark tests .",
    "the exact solutions of the riemann problems have been obtained by help of the riemann_vt.f code provided by marti and mller @xcite . unless mentioned otherwise ,",
    "approximately 3000 particles are shown .",
    "this moderately relativistic ( maximum lorentz factor @xmath36 ) shock tube has become a standard touch - stone for relativistic hydrodynamics codes @xcite . it uses a polytropic equation of state ( eos ) with an exponent of @xmath37 and @xmath38_{\\rm l}= [ 40/3 , 10 , 0]$ ] for the left - hand state and @xmath38_{\\rm r}= [ 10^{-6 } , 1 , 0]$ ] for the right - hand state .    : sph results ( circles ) vs. exact solution ( red line ) . from left to right , top to bottom : velocity ( in units of @xmath39 ) , specific energy , computing frame baryon number density and pressure.,title=\"fig : \" ] : sph results ( circles ) vs. exact solution ( red line ) . from left to right , top to bottom : velocity ( in units of @xmath39 ) , specific energy , computing frame baryon number density and pressure.,title=\"fig : \" ]    : sph results ( circles ) vs. exact solution ( red line ) . from left to right , top to bottom : velocity ( in units of @xmath39 ) , specific energy , computing frame baryon number density and pressure.,title=\"fig : \" ] : sph results ( circles ) vs. exact solution ( red line ) . from left to right , top to bottom : velocity ( in units of @xmath39 ) , specific energy , computing frame baryon number density and pressure.,title=\"fig : \" ]    as shown in fig .",
    "[ rosswog::fig:1 ] , the numerical solution at @xmath40 ( circles ) agrees nearly perfectly with the exact one . note in particular the absence of any spikes in @xmath6 and @xmath8 at the contact discontinuity ( near @xmath41 ) , such spikes had plagued many earlier relativistic sph formulations @xcite .",
    "the only places where we see possibly room for improvement is the contact discontinuity which is slightly smeared out and the slight over-/undershoots at the edges of the rarefaction fan .",
    "+ in order to monitor how the error in the numerical solution decreases as a function of increased resolution , we calculate l_1 _",
    "b^n_part |v_b - v_ex(r_b)|,[eq : l1 ] where @xmath42 is the number of sph - particles , @xmath43 the ( 1d ) velocity of sph - particle @xmath14 and @xmath44 the exact solution for the velocity at position @xmath45 .",
    "the results for @xmath46 are displayed in fig .",
    "[ rosswog::fig:2 ] .",
    "the error @xmath46 decreases close to @xmath47 ( actually , the best fit is @xmath48 ) , which is what is also found for eulerian methods in tests that involve shocks .",
    "therefore , for problems that involve shocks we consider the method first - order accurate .    ) as a function of particle number for the relativistic shock tested in riemann problem 1 .",
    "the error decreases close to @xmath49 . ]",
    "the order of the method for smooth flows will be determined in the context of test 6 .      )",
    "are shown as circles , the exact solution as red line . from left to right , top to bottom : velocity ( in units of @xmath39 ) , specific energy , computing frame baryon number density and pressure.,title=\"fig : \" ] ) are shown as circles , the exact solution as red line . from left to right , top to bottom : velocity ( in units of @xmath39 ) , specific energy , computing frame baryon number density and pressure.,title=\"fig : \" ]    ) are shown as circles , the exact solution as red line . from left to right , top to bottom : velocity ( in units of @xmath39 ) , specific energy , computing frame baryon number density and pressure.,title=\"fig : \" ] ) are shown as circles , the exact solution as red line . from left to right , top to bottom : velocity ( in units of @xmath39 ) , specific energy , computing frame baryon number density and pressure.,title=\"fig : \" ]    this test is a more violent version of test 1 in which we increase the initial left side pressure by a factor of 100 , but leave the other properties , in particular the right - hand state , unchanged : @xmath50_{\\rm l}= [ 4000/3 , 10 , 0]$ ] and @xmath50_{\\rm r}= [ 10^{-6},1,0]$ ] .",
    "this represents a challenging test since the post - shock density is compressed into a very narrow `` spike '' , at @xmath40 near @xmath51 .",
    "a maximum lorentz - factor of @xmath52 is reached in this test . + in fig .",
    "[ rosswog::fig:3 ] we show the sph results ( circles ) of velocity @xmath53 , specific energy @xmath6 , the computing frame number density @xmath12 and the pressure @xmath8 at @xmath54 together with the exact solution of the problem ( red line ) .",
    "again the numerical solution is in excellent agreement with the exact one , only in the specific energy near the contact discontinuity occurs some smearing .",
    "this test is an even more violent version of the previous tests .",
    "we now increase the initial left side pressure by a factor of 1000 with respect to test 1 , but leave the other properties unchanged : @xmath50_{\\rm l}= [ 40000/3 , 10 , 0]$ ] and @xmath50_{\\rm r}= [ 10^{-6},1,0]$ ] .",
    "the post - shock density is now compressed into a very narrow `` needle '' with a width of only @xmath55 , the maximum lorentz factor is 6.65 .",
    "+    ) are shown as circles , the exact solution as red line . from left to right , top to bottom : velocity ( in units of @xmath39 ) , specific energy , computing frame baryon number density and pressure.,title=\"fig : \" ] ) are shown as circles , the exact solution as red line . from left",
    "to right , top to bottom : velocity ( in units of @xmath39 ) , specific energy , computing frame baryon number density and pressure.,title=\"fig : \" ]    ) are shown as circles , the exact solution as red line . from left to right , top to bottom : velocity ( in units of @xmath39 ) , specific energy , computing frame baryon number density and pressure.,title=\"fig : \" ] ) are shown as circles , the exact solution as red line . from left",
    "to right , top to bottom : velocity ( in units of @xmath39 ) , specific energy , computing frame baryon number density and pressure.,title=\"fig : \" ]    fig .",
    "[ rosswog::fig:4 ] shows the sph results ( circles ) of velocity @xmath53 , specific energy @xmath6 , the computing frame number density @xmath12 and the pressure @xmath8 at @xmath56 together with the exact solution ( red line ) .",
    "the overall performance in this extremely challenging test is still very good .",
    "the peak velocity plateau with @xmath57 ( panel 1 ) is very well captured , practically no oscillations behind the shock are visible .",
    "of course , the `` needle - like '' appearance of the compressed density shell ( panel 3 ) poses a serious problem to every numerical scheme at finite resolution . at the applied resolution ,",
    "the numerical peak value of @xmath12 is only about half of the exact solution .",
    "moreover , this extremely demanding test reveals an artifact of our scheme : the shock front is propagating at slightly too large a speed .",
    "this problem decreases with increasing numerical resolution and experimenting with the parameter @xmath28 of eqs .",
    "( [ rosswog::eq : diss_mom ] ) and ( [ rosswog::eq : diss_en ] ) shows that it is related to the form of artificial viscosity , smaller offsets occur for lower values of the viscosity parameter @xmath28 . here",
    "further improvements would be desirable .",
    "this is a more extreme version of the test suggested by @xcite .",
    "it starts from an initial setup similar to a normal riemann problem , but with the right state being sinusoidally perturbed .",
    "what makes this test challenging is that the smooth structure ( sine wave ) needs to be transported across the shock , i.e. kinetic energy needs to be dissipated into heat to avoid spurious post - shock oscillations , but not too much since otherwise the ( physical ! ) sine oscillations in the post - shock state are not accurately captured .",
    "we use a polytropic exponent of @xmath37 and [ p , n , v]^l=[1000,5,0 ] ^r=[5,2 + 0.3 ( 50 x),0 ] . as initial conditions , i.e.",
    "we have increased the initial left pressure by a factor of 200 in comparison to @xcite .",
    "( blue ) and @xmath58 ( red ) are overlaid as solid lines.,title=\"fig : \" ]   ( blue ) and @xmath58 ( red ) are overlaid as solid lines.,title=\"fig : \" ]     ( blue ) and @xmath58 ( red ) are overlaid as solid lines.,title=\"fig : \" ]   ( blue ) and @xmath58 ( red ) are overlaid as solid lines.,title=\"fig : \" ]    the numerical result ( circles ) is shown in fig .",
    "[ rosswog::fig:5 ] together with two exact solutions , for the right - hand side densities @xmath59 ( solid blue ) and @xmath60 ( solid red ) .",
    "all the transitions are located at the correct positions , in the post - shock density shell the solution nicely oscillates between the extremes indicated by the solid lines .",
    "the initial conditions of the einfeldt rarefaction test @xcite do not exhibit discontinuities in density or pressure , but the two halfs of the computational domain move in opposite directions and thereby create a very low - density region around the initial velocity discontinuity .",
    "this low - density region poses a serious challenge for some iterative riemann solvers , which can return negative density / pressure values in this region . here",
    "we generalize the test to a relativistic problem in which left / right states move with velocity -0.9/+0.9 away from the central position .",
    "for the left and right state we use @xmath61_{\\rm l}= [ 1 , 1 , -0.9]$ ] and @xmath61_{\\rm r}= [ 1 , 1 ,   0.9]$ ] and an adiabatic exponent of @xmath62 . note that here we have specified the local rest frame density , @xmath5 , which is related to the computing frame density by eq .",
    "( [ rosswog::eq : n_vs_n ] ) .",
    "the sph solution at @xmath63 is shown in fig .",
    "[ rosswog::fig:6 ] as circles , the exact solution is indicated by the solid red line .",
    "small oscillations are visible near the center , mainly in @xmath53 and @xmath6 , and over-/undershoots occur near the edges of the rarefaction fan , but overall the numerical solution is very close to the analytical one . in its current form , the code can stably handle velocities up to 0.99999 , i.e. lorentz factors @xmath64 , but at late times there are practically no more particles in the center ( sph s approximation to the emerging near - vacuum ) , so that it becomes increasingly difficult to resolve the central velocity plateau .     everywhere , @xmath65 and @xmath66.,title=\"fig : \" ]    everywhere , @xmath65 and @xmath66.,title=\"fig : \" ]     everywhere , @xmath65 and @xmath66.,title=\"fig : \" ]    everywhere , @xmath65 and @xmath66.,title=\"fig : \" ]      in this test problem we explore the ability to accurately advect a smooth density pattern at an ultra - relativistic velocity across a periodic box .",
    "since this test does not involve shocks we do not apply any artificial dissipation .",
    "we use only 500 equidistantly placed particles in the interval @xmath67 $ ] , enforce periodic boundary conditions and use a polytropic exponent of @xmath62 .",
    "we impose a computing frame number density @xmath68 , a constant velocity as large as @xmath69 , corresponding to a lorentz factor of @xmath70 , and instantiate a constant pressure corresponding to @xmath71 , where @xmath72 and @xmath73 and @xmath74 .",
    "the specific energies are chosen so that each particle has the same pressure @xmath75 . with these initial conditions the specified density pattern",
    "should just be advected across the box without being changed in shape",
    ". +    , lorentz factor @xmath76 ) of a density pattern across a periodic box .",
    "the advection is essentially perfect , the patterns after 50 ( blue circles ) and 100 ( green triangles ) times crossing the box are virtually identical to the initial condition ( red line ) .",
    "right : decrease of the @xmath46 error as a function of resolution , for smooth flows the method is second - order accurate.,title=\"fig : \" ] , lorentz factor @xmath76 ) of a density pattern across a periodic box . the advection is essentially perfect , the patterns after 50 ( blue circles ) and 100 ( green triangles ) times crossing the box are virtually identical to the initial condition ( red line ) .",
    "right : decrease of the @xmath46 error as a function of resolution , for smooth flows the method is second - order accurate.,title=\"fig : \" ]    the numerical result after 50 times ( blue circles ) and 100 times ( green triangles ) crossing the interval is displayed in fig .",
    "[ rosswog::fig:7 ] , left panel .",
    "the advection is essentially perfect , no deviation from the initial condition ( solid , red line ) is visible .",
    "+ we use this test to measure the convergence of the method in the case of smooth flow ( for the case involving shocks , see the discussion at the end of test 1 ) .",
    "since for this test the velocity is constant everywhere , we use the computing frame number density @xmath12 to calculate @xmath46 similar to eq .",
    "( [ eq : l1 ] ) .",
    "we find that the error decreases very close to @xmath77 , see fig .",
    "[ rosswog::fig:7 ] , right panel , which is the behavior that is theoretically expected for smooth functions , the used kernel and perfectly distributed particles @xcite ( actually , we find as a best - fit exponent -2.07 ) .",
    "therefore , we consider the method second - order accurate for smooth flows .",
    "we have summarized a new special - relativistic sph formulation that is derived from the lagrangian of an ideal fluid @xcite . as numerical variables",
    "it uses the canonical energy and momentum per baryon whose evolution equations follow stringently from the euler - lagrange equations .",
    "we have further applied the special - relativistic generalizations of the so - called `` grad - h - terms '' and a refined artificial viscosity scheme with time dependent parameters .",
    "+ the main focus of this paper is the presentation of a set of challenging benchmark tests that complement those of the original paper @xcite .",
    "they show the excellent advection properties of the method , but also its ability to accurately handle even very strong relativistic shocks . in the extreme shock tube test 3 , where the post - shock density shell is compressed into a width of only 0.1 % of the computational domain",
    ", we find the shock front to propagate at slightly too large a pace .",
    "this artifact ceases with increasing numerical resolution , but future improvements of this point would be desirable .",
    "we have further determined the convergence rate of the method in numerical experiments and find it first - order accurate when shocks are involved and second - order accurate for smooth flows .",
    "j.  a. faber , t.  w. baumgarte , s.  l. shapiro , k.  taniguchi , and f.  a. rasio , _ dynamical evolution of black hole - neutron star binaries in general relativity : simulations of tidal disruption _ , phys",
    "d * 73 * ( 2006 ) , no .  2 , 024012 .",
    "j.  a. faber , f.  a. rasio , and j.  b. manor , _ post - newtonian smoothed particle hydrodynamics calculations of binary neutron star coalescence .",
    "binary mass ratio , equation of state , and spin dependence _ ,",
    "d * 63 * ( 2001 ) , no .  4 , 044012 ."
  ],
  "abstract_text": [
    "<S> in this paper we test a special - relativistic formulation of smoothed particle hydrodynamics ( sph ) that has been derived from the lagrangian of an ideal fluid . </S>",
    "<S> apart from its symmetry in the particle indices , the new formulation differs from earlier approaches in its artificial viscosity and in the use of special - relativistic `` grad - h - terms '' . in this paper </S>",
    "<S> we benchmark the scheme in a number of demanding test problems . </S>",
    "<S> maybe not too surprising for such a lagrangian scheme , it performs close to perfectly in pure advection tests . </S>",
    "<S> what is more , the method produces accurate results even in highly relativistic shock problems .    </S>",
    "<S> i    smoothed particle hydrodynamics , special relativity , hydrodynamics , shocks </S>"
  ]
}