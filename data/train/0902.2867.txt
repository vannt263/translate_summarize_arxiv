{
  "article_text": [
    "the ability to prepare and measure specific quantum states of the light is the keystone of many quantum information processing ( qip ) protocols . these states can be described either with discrete variables in terms of photons , or with continuous variables in terms of waves . in the latter case ,",
    "the physical quantities of interest are the amplitude and the phase of the light wave , or their cartesian counterparts called quadratures @xmath0 and @xmath1 . a very convenient representation of the quantum state is then provided by the wigner function @xmath2 , which corresponds to a quasi - probability distribution of the quadratures , ` quasi- ' because @xmath3 may assume negative values .",
    "an important task for qip is the ability to undo effects of decoherence by ` distillation ' : to obtain a single quantum state that is more pure from two or more copies that have undergone decoherence .",
    "since states of light with gaussian wigner functions can not be distilled with gaussian operations @xcite , one is left with two strategies : either to distill gaussian states with non - gaussian operations , or to distill non - gaussian states with gaussian operations @xcite .",
    "this paper is a contribution to the latter strategy , and focuses on the preparation of the non - gaussian states rather than on their distillation .",
    "the negativity of the wigner function is a standard figure of merit , quantifying at the same time how non - gaussian and how non - classical a quantum state is  @xcite .",
    "one way of obtaining non - gausian states is by conditional photon - counting measurements , as first proposed by dakna _",
    "_  @xcite .",
    "it was soon realized that such conditional measurements can improve quantum teleportation of continuous variables  @xcite . in recent years",
    ", several experiments  @xcite combining continuous- and discrete - variable tools allowed for preparing and observing quantum states of free - propagating light with negative wigner functions  @xcite .",
    "many of these experiments are based on the use of a squeezed vacuum produced by parametric fluorescence , which involves many optical modes  @xcite .",
    "this multimode nature is exhibited in both continuous - wave ( cw ) operation , using optical parametric oscillators ( opo ) below threshold  @xcite , and in pulsed experiments with a single - pass high amplification . in order to make accurate predictions , it is therefore crucial to develop multimode theoretical models .",
    "this was done in  @xcite for setups using an opo , and in  @xcite for pulsed @xmath4-photon fock state tomography in a case of very low squeezing , when fock states expansion are limited to @xmath4 photon only .",
    "however , these models do not fully account for all phenomena linked to the non - constant space and time profiles of the modes under study , the spatial pulse profile in the transverse direction for example , and they especially do not account for gain - induced distortions in the parametric amplification process  @xcite .",
    "as we will see later on , these phenomena are one main signature of this multimode nature , and are critical in the case of single - pass pulsed experiments .    in this paper",
    "we propose an alternative general framework to describe the generation of squeezed light , with a twofold goal : first , to introduce a method that reduces a multimode model to an effective two - mode description .",
    "second , to show that a specific spatio - temporal multimode model for photon - subtraction experiments and our mode - reduction analysis thereof give an improved understanding of state - of - the - art photon - subtraction experiments .    in sec .",
    "[ secmodered ] we show how to reduce a multi - mode model to an effective two - mode model .",
    "this mode - reduction procedure is then applied in sec .",
    "[ secapp ] to give an improved analysis of the photon - subtraction experiments of ref .",
    "we discuss the method and its application and conclude in sec .",
    "[ secdiscconc ] .",
    "some technicalities are deferred to two appendices .",
    "as a starting point we have a complete set of spatial , temporal , or spatio - temporal optical modes , in terms of which the light propagation can be described .",
    "the modes have field operators @xmath5 and @xmath6 with bosonic commutation relations @xmath7=\\delta_{jk}$ ] .",
    "the @xmath8 may also stand for continuous operators like @xmath9 , where @xmath10 is time , with commutation relation @xmath11=\\delta(t - t')$ ] , in which case sums over modes are to be replaced with integrals . to simplify the notation even further , we introduce @xmath12 , the column vector of all the @xmath5 .",
    "similarly @xmath13 is the row vector which has operators @xmath14 as components .",
    "we shall also need the row vector @xmath15 and the column vector @xmath16 .",
    "similar notation will be used for other vectors .    in this section",
    "we consider a general unitary transformation @xmath17 in which output quadratures linearly depend on input quadratures , thus preserving the gaussian nature of the quantum fields .",
    "in fact , the only non - gaussian operation will be the projective measurement , corresponding to a detection event in a subset of the output modes by an avalanche photodiode ( apd ) , see figure  [ gensetup ] .    .",
    "after the transformation a few modes are filtered out and result in a detection event in the avalanche photodiode ( apd ) .",
    "such a detection event in the apd prepares a state in the single mode which is mode analyzed by homodyne detection . ]",
    "we will assume the evolution operator @xmath17 in fig .",
    "[ gensetup ] to be a bogoliubov transformation , where the output field operators depend linearly on the input ones : @xmath18 where @xmath19 and @xmath20 are two matrices which satisfy    @xmath21    whereby the commutation relations of the field operators are preserved .",
    "the output state of the light can be characterized by doing homodyne measurements on a normalized mode described by @xmath22 , which has the mode operator @xmath23 this mode can be defined as the mode that perfectly matches the local oscillator of the homodyne detector . after the bogoliubov transform  ( [ bogoliubov ] ) it is described by @xmath24 without conditioning upon photon detection , and since the gaussian nature of the initial vacuum state is preserved by the bogoliubov transform , the homodyne measurements will show gaussian wigner functions corresponding to squeezed vacuum states of light .",
    "the point is now how to describe the output state conditional upon detection of a photon by the apd , which is a projective measurement .",
    "analogous to the homodyne detection , we assume the photon detection mode @xmath25 to be described by a normalized state @xmath26 , with corresponding field operator @xmath27 after the time evolution described by eq .",
    "( [ bogoliubov ] ) , the output at the photon detector becomes : @xmath28 if we only know that a photon has been detected but not in which detection mode , then we should average the conditional output state over all these detection modes , as is shown in more detail below .    at this point",
    "we have a multimode output state that in principle we can update given the detection of a photon in the detector @xmath25 .",
    "in practice it is convenient to first simplify the multimode expressions  ( [ ahout ] ) and ( [ adout ] ) .",
    "the first and central step in the mode - reduction procedure is to rewrite the homodyne mode eq .",
    "( [ ahout ] ) in the form @xmath29 in terms of new mode operators @xmath30 with standard commutation relations .",
    "the coefficients @xmath31 , and @xmath32 in eq .  ( [ modereductionahout ] )",
    "are found as follows . besides having standard commutations , @xmath33 and @xmath34 in eq .",
    "( [ modereductionahout ] ) should annihilate the vacuum state , so that @xmath33 must contain all annihilation operators in eq .",
    "( [ ahout ] ) :     is followed by a perfect non - degenerate optical parametric amplifier ( ndopa ) with squeezing parameter @xmath35 . ]    @xmath36    with @xmath37 fixed up to a phase factor by @xmath38=1 $ ] .",
    "we choose @xmath37 to be real - valued and positive so that @xmath39 furthermore , from @xmath40=0 $ ] it follows that @xmath41=\\frac{1}{\\eta}\\vec{\\psi}_h^\\dag \\,u\\,v^t\\ , \\vec{\\psi}_h^*.\\end{aligned}\\ ] ] a complex value for @xmath42 can be removed with a redefinition of the phase of the homodyne mode , which just means that we can assume that the state is squeezed in the @xmath43 or @xmath44 direction .",
    "finally , @xmath32 can be found from the fact that @xmath45 and @xmath46 have commutator one , as have @xmath47 and @xmath48 : @xmath49 here again we used the freedom to choose @xmath32 real - valued and nonnegative .",
    "this completes the mathematics of the mode reduction of the multimode homodyning signal .",
    "the physical argument that two and only two modes should remain goes as follows .",
    "the squeezed vacuum after the bogoliubov transform can only be a centered gaussian state , hence it is fully described by only the variances @xmath50 and @xmath51 .",
    "the squeezed vacuum output can therefore be modeled  @xcite by a perfect single - mode degenerate optical parametric amplifier ( dopa ) with squeezing parameter @xmath52 , followed by a perfect non - degenerate optical parametric amplifier ( ndopa ) with squeezing parameter @xmath53 , as presented in figure  [ modelu ] .",
    "this is a two - mode model , with a hilbert space @xmath54 .",
    "the values of the parameters @xmath52 and @xmath55 can be deduced from the two independent coefficients in eqs .",
    "( [ eta]-[beta ] ) , using :    [ equ_gr ] @xmath56    a related squeezing parameter that we will also use in the following is @xmath57 .",
    "we now condition upon the measurement of a click in the photon detector ( apd ) .",
    "we assume to be in the limit that the average number of photons per pulse entering the photon detector is much less than one .",
    "then a single click in the detector corresponds to the detection of a single photon .",
    "one can make a reduced - mode description of the photon detection operator @xmath58 of eq .",
    "( [ ad ] ) , analogous to eq .",
    "( [ modereductionahout ] ) .",
    "the operator @xmath59 can be expanded into a part acting on @xmath54 , plus a component @xmath60 acting on the complementary space @xmath61 orthogonal to @xmath54 : @xmath62 note that @xmath60 on the right - hand side contains all the terms acting on @xmath61 , including creation operators .",
    "the coefficients in  ( [ adperp_mode_red ] ) can again be found by taking commutators , for example :    [ gammadelta ] @xmath63=\\frac{1}{\\eta}\\vec{\\psi}_h^\\dag \\,u\\,v^t\\ , \\vec{\\phi}_d^*(j ) \\label{gamma}\\\\ \\delta_j & = & [ \\hat{a}_1,\\hat{a}_{d,{\\rm out}}(j)]=\\frac{1}{\\beta^*}[\\vec{\\phi}_d^\\dag(j ) \\,v\\,v^\\dag\\ , \\vec{\\psi}_h-\\alpha^*\\gamma_j ] \\label{delta}.\\end{aligned}\\ ] ]    in general , a click recorded in the apd corresponds to the measurement of at least one photon . in the limit of low detection probability ,",
    "the action of the detection is the subtraction of a _ single _ photon .",
    "note that this assumption is practically always obeyed if the parameter @xmath25 is in a continuum ( like in the case of spectral filtering ) , since the probability to have two photons exactly in the same mode is then negligible . henceforth we assume to be in this limit . in the heisenberg picture",
    ", a photon detection then corresponds to the application of the operator @xmath58 to the initial state ( _ i.e. _  to the vacuum state ) , followed by the normalization of the result : @xmath64 is the detection probability for the mode @xmath25 : @xmath65 below we will use that the vacuum expectation value of @xmath66 can be expressed as @xmath67 .    before continuing , it can be instructive to recall the concision allowed by the heisenberg picture . in a single - mode problem ,",
    "a photon - subtracted squeezed state is equivalent to a squeezed single - photon state : this case corresponds to the simple bogoliubov transform @xmath68 , which directly gives a pure @xmath4-photon state ( after normalization ) when applied to the vacuum .",
    "as the states do not evolve in the heisenberg picture , they all can be considered as ` input ' states ; but when measured using output quadratures , this @xmath4-photon state will appear to be squeezed .",
    "we are going to use the same approach in the multimode case .",
    "one can first note that the conditioned state @xmath69 in eq .",
    "( [ psicond ] ) is already a @xmath4-photon state .",
    "this state , however , does not belong to @xmath54 only , so that measurements output are not so obvious to compute .",
    "in fact , we are solely interested in expectation values @xmath70 of operators describing the output that is measured in the homodyne detector .",
    "such expectation values can be written as    @xmath71    in eq .",
    "( [ rewriteexpvalb ] ) , the trace can be separated into a trace over @xmath54 and a trace over @xmath72 , and the latter does not act on the function @xmath73 , whose expectation value is then :    @xmath74    all quantities of interest can therefore be deduced from the input state reduced density matrix @xmath75 , acting in @xmath54 , and the crucial advantage of mode reduction is to allow a simple expression for this matrix : writing @xmath76 , where @xmath77 and @xmath78 are the ground states of @xmath54 and @xmath61 , respectively , and using eqs .",
    "( [ adperp_mode_red],[psicond ] ) , we directly obtain : @xmath79 in terms of the _ modal purity _ @xmath80 and where @xmath81 is an operator that creates a single photon in a superposition of mode  0 and mode  1 .",
    "the state  ( [ rho2 ] ) produced from a detection event in mode @xmath25 is a mixed state , mixing vacuum and a single - photon state with weight @xmath82 . without conditioning or in the limit @xmath83",
    ", we have @xmath84 .      _",
    "squeezed vacuum. _    before determining the output wigner function corresponding to the conditional state  ( [ rho2 ] ) , it is instructive to first determine the wigner function of the output state in the simplest experimental situation , where we ignore the photon detector .",
    "the input state is then @xmath85 .",
    "we will make use of the standard wigner functions of the vacuum @xmath86 and of single - photon states @xmath87 , both with @xmath88 .",
    "clearly , @xmath89(x_{0},p_{0};x_{1},p_{1})$ ] equals @xmath90 .    in order to obtain the output wigner function for the homodyne mode",
    ", we wish to express @xmath89 $ ] as a function of @xmath91 , @xmath92 ( defined from the output homodyne mode @xmath93 given by eq .",
    "( [ modereductionahout ] ) ) .",
    "this requires the introduction of another mode @xmath94 orthogonal to @xmath95 , so that the transformation @xmath96 is symplectic ( _ i.e. _  commutation relations are preserved ) . using the model of fig .",
    "[ modelu ] , one can choose @xmath97 of the form : @xmath98 this form is by no means unique , but this does not pose a problem since mode @xmath99 will eventually be integrated out .",
    "one can now invert the relations ( [ modereductionahout],[a1out ] ) , thereby expressing @xmath100 as a function of @xmath101 , and @xmath102 . after tracing over mode @xmath99 , which amounts to integrating over @xmath103 and @xmath102 , we find the output signal entering the homodyne detector to be a squeezed vacuum state with a gaussian wigner function @xmath104 where @xmath43 and @xmath44 stand for @xmath105 and @xmath106 and with variances    [ defvar ] @xmath107    we can now invert eq .",
    "( [ defvar ] ) and rewrite the three mode - reduction parameters @xmath108 , and @xmath32 in eq .",
    "( [ modereductionahout ] ) in terms of the variances , giving :    [ etaalphabetavxvp ] @xmath109    in the following , we will keep writing @xmath108 , and @xmath32 to shorten notation .",
    "it should be kept in mind , however , that eq .",
    "( [ etaalphabetavxvp ] ) directly expresses these parameters in terms of the measurable variances @xmath110 of the squeezed vacuum .",
    "in particular , @xmath32 vanishes for minimal - uncertainty states .",
    "notice also that the parametrization for the mode - reduction parameters  ( [ etaalphabetavxvp ] ) is equivalent to the one in eq .",
    "( [ equ_gr ] ) in terms of squeezing parameters @xmath52 and @xmath111 .",
    "thus @xmath52 and @xmath111 can be expressed in terms of the variances @xmath110 , and _",
    "vice versa_.    _ photon - subtracted squeezed vacuum. _    as for the squeezed vacuum , we now calculate the wigner function for the photon - subtracted squeezed vacuum , starting with the initial state  ( [ rho2 ] ) .",
    "the mode  ( [ athetaj ] ) has a one - photon excitation in state  ( [ rho2 ] ) .",
    "the orthogonal mode with creation operator @xmath112 is not excited .",
    "hence the wigner function corresponding to the state  ( [ rho2 ] ) is @xmath113 note that in this expression , quadratures @xmath114 , @xmath115 can be easily expressed as functions of quadratures @xmath100 using ( [ athetaj ] ) .",
    "as before , the wigner function for the output signal is found by using the symplectic transformation defined by eqs .",
    "( [ modereductionahout ] ) and ( [ a1out ] ) . by tracing again over the mode @xmath99",
    ", we obtain ( see appendix [ appendixwigner ] ) @xmath116 the constants in this wigner function are given by    [ constantsinw ] @xmath117    note that the wigner function  ( [ wj ] ) of the photon - subtracted squeezed state differs from the wigner function of the squeezed vacuum @xmath118 of eq .",
    "( [ 0_sqz ] ) only because of the polynomial in @xmath43 and @xmath44 between the large brackets .",
    "the same quantities @xmath110 as in eq .",
    "( [ defvar ] ) show up , with or without conditioning .",
    "since in general @xmath119 @xcite , we find the condition @xmath120 .",
    "_ averaged wigner functions. _    practical detectors do not resolve with infinite precision when and where photons are detected .",
    "we should therefore average over all possible microscopic states that agree with the detection record .",
    "we assumed in sec .",
    "[ secconditioning ] that the average number of photons detected per pulse in the apd is much smaller than one .",
    "averaging over unresolved detection events is then equivalent to averaging over single - photon subtraction events .",
    "the wigner transformation of the density matrix is a linear transformation .",
    "therefore , the averaged wigner function @xmath121 is simply obtained by replacing @xmath122 ...",
    "@xmath123 in  ( [ wj ] ) by @xmath124 ... @xmath125 , with the notation @xmath126 here @xmath127 is the sum of the probabilities @xmath128 of microscopic states that agree with the detection record . from eq .",
    "( [ constantsinw ] ) it follows that averaged quantities @xmath124 ... @xmath125 involve sums like @xmath129 ; in the following we will write the respective averages as @xmath130 , @xmath131 or @xmath132 .",
    "the wigner function  ( [ wj ] ) of the photon - subtracted state and its detection - averaged version have a very general significance . before going to sec .  [ secapp ] , devoted to a practical implementation of these results ,",
    "let us finish with some reflections on the detection modes .",
    "all the previous results were derived through the use of a set of detection modes @xmath133 .",
    "the coefficients entering in the averaged wigner function @xmath134 involve quantities like @xmath127 , @xmath130 , @xmath131 or @xmath132 , in which the detection operators only appear through their projection operator : @xmath135 hence one would find the same predicted averages if one would employ a different set of detection modes that has the same associated projector . this projector describes how the setup filters the signal before it enters the photon detector . for example , a time - domain filtering system will be described by @xmath136 , where @xmath137 can be written in terms of a set of modes @xmath9 that are labeled by the time @xmath10 : @xmath138 where @xmath139 when the apd is switched on , and @xmath140 otherwise . to give another important example , a spectral slit can be described with a set of modes @xmath141 with an associated projector @xmath142 where @xmath143 if the frequency @xmath144 is filtered out , and @xmath145 otherwise .",
    "above we have assumed that the filtering of the signal after its production in the dopa was included in the bogoliubov transform @xmath17 . below we will give an alternative description , in which @xmath17 is separated into the transformation due to the production of the squeezed light in the dopa , and the subsequent filtering before detection .",
    "this alternative description will enable a more straightforward comparison with the empirical model in sec .",
    "[ secapp ] .",
    "so , instead of the input - output transform eq .",
    "( [ adout ] ) for the photon detection operator , we now write @xmath146 where the bogoliubov matrix @xmath147 accounts for filters ( as the filters are passive , we have @xmath148 ) ; this matrix @xmath147 is of course unitary , even if the filters can present losses . in fact , losses will be modeled using beamsplitters , where the lost energy is reflected into auxiliary non - relevant modes .",
    "these modes do not interact with the rest of the experiment ( _ i.e. _  they are unaffected by bogoliubov transform @xmath149 ) and will not reach the apd .",
    "but all the other modes , referred to as relevant modes , should be considered as detection modes , and we then have : @xmath150 where @xmath151 is the projector onto the subspace of relevant modes .",
    "let @xmath152 be the projector on the non - relevant modes .",
    "as the latter are unaffected by the transform @xmath149 , we have @xmath153 . inserting the relation @xmath154 into ( [ adoutp ] ) then leads to @xmath155 here the last term on the right annihilates vacuum , and commutes with annihilation operators like @xmath33 or @xmath34 : this term will add no contribution to the results of the previous subsection .",
    "the only change therefore consists in the substitution @xmath156 , so that the operator @xmath157 in eq .",
    "( [ equprojp ] ) should be replaced by @xmath158 where @xmath159 and where we have used standard properties of projection operators ( @xmath160 , @xmath161 ) .",
    "the operator @xmath162 represents the action of the filters restricted to the subspace of relevant modes . if @xmath162 is a projector , such as @xmath137 of eq .",
    "( [ equprojpt ] ) or @xmath163 of eq .",
    "( [ equprojpomega ] ) , then the effect of @xmath164 is the same as of @xmath157 in eq .",
    "( [ equprojp ] ) . this can be easily understood : it is equivalent to say that the filtered modes are blocked , or that they are first redirected into auxiliary modes , and then blocked .    the operator @xmath164 of eq .",
    "( [ equprojp2 ] ) is a more general quantity than @xmath157 in eq .",
    "( [ equprojp ] ) , however , since @xmath164 need not be a projection operator .",
    "it can for instance account for partial absorption of the modes . in that case ,",
    "the spectral transmission @xmath165 in eq .  ( [ equprojpomega ] ) can assume any value between @xmath166 and @xmath4 , to account for filtering systems more complex than a simple spectral slit .",
    "furthermore , the above expressions can simply be generalized to situations where several filters are used .",
    "for example , if a spectral slit @xmath163 is followed by a time - domain filter @xmath137 , then the above expressions for @xmath162 and @xmath164 become @xmath167 , leading to @xmath168 .",
    "at this stage , we have a complete description of the final state starting from the bogoliubov transform  ( [ bogoliubov ] ) .",
    "the results of the previous section are generally valid , since we started with a multimode model that was left unspecified .",
    "our purpose now is to establish a concrete link with the photon - subtraction experiment as described in ref .",
    "@xcite , and to improve its analysis .      in the experiment by ourjoumtsev _",
    "et al . _",
    "@xcite , pulses of squeezed light are produced .",
    "the setup is sketched in figure  [ figdopa ] .",
    "are transformed into pairs of photons of frequency @xmath144 ( in the experiment , the central frequency @xmath169 corresponds to a central wavelength of about @xmath170 ) .",
    "the output signal of the dopa is sampled by a beam splitter with low reflectivity @xmath171 .",
    "if a photon is detected by the apd , then ideally it has been subtracted from the squeezed vacuum . ]    a squeezed vacuum , produced in a single - pass dopa ( a @xmath172 crystal ) by down - conversion of frequency - doubled femtosecond laser pulses , is sampled by a beam splitter with low reflectivity @xmath173 .",
    "two mode filters are placed in front of the apd : a spatial mode filter , that consists in a single - mode fiber , and a spectral slit of width @xmath174 .",
    "if a photon is detected by the apd , then ideally it has been subtracted from the squeezed vacuum .",
    "this subtraction leads to a @xmath4-photon squeezed state , which is very close to a ` schr \" odinger kitten ' state .",
    "quantum state tomography with a balanced homodyne detector  @xcite allows the complete reconstruction of this highly non - gaussian quantum state of light .",
    "the wigner function  ( [ wj ] ) was derived assuming that the mode reduction was performed on the mode entering the homodyne detector . to relate our results to the empirical model discussed in the next subsection",
    ", we here choose to perform the mode reduction to the signal directly after the dopa .",
    "we model the dopa using the scheme presented in fig .",
    "[ modelu ] , where the parameters @xmath52 and @xmath111 are linked to the bogoliubov transform through eqs .",
    "( [ eta]-[equ_gr ] ) . for the calculation of the modes @xmath175 detected by the apd",
    ", the sampling beamsplitter and the mode filters can be separately added to this transform , as explained in sec .",
    "[ subsecdetmodes ] . as stated above , here we chose not to include the sampling beam splitter into the mode reduction .",
    "the wigner function  ( [ wj ] ) then describes the signal just after the dopa .",
    "we therefore still need to account for this sampling beam splitter between the dopa and the homodyne detection , as well as for other losses .",
    "for example , one usually accounts for imperfections of the homodyne detection by adding a fictitious beam splitter of transmission @xmath176 just before the homodyne detection , where @xmath176 is the homodyne detection efficiency .",
    "both those beam splitters can be easily implemented by replacing the variances according to : @xmath177.\\ ] ] and by multiplying @xmath178 , @xmath179 and @xmath180 by @xmath181 . before going into detailed calculations , let us first recall the empirical model that was proposed in ref .",
    "@xcite to account for experimental results .",
    "it is useful to recall the empirical model proposed in ref .",
    "@xcite to explain the experiments , and to see by what assumptions our multimode model reduces to it .",
    "the dopa is again modeled as in fig .",
    "[ modelu ] , producing the same squeezed vacuum . however , in the empirical model it is assumed that the detected photon is either in the homodyne mode with probability @xmath182 , or in an orthogonal mode with probability @xmath183 . in the latter case ,",
    "the detection event is not correlated with the homodyne measurement , and one simply performs a homodyne measurement on squeezed vacuum .",
    "the output density matrix obtained with the empirical model is similar to our @xmath184 in eq .",
    "( [ rho2 ] ) .",
    "in fact , the two would be identical if the detected photon was only due to photons in the mode @xmath185 or from @xmath72 .",
    "this is in general not the case , however , as there will be an admixture from @xmath186 in the photon detection operator .",
    "in fact , in order to completely account for the multimode nature of this experiment , the empirical model should be modified in the way depicted on fig .",
    "[ figmodelubeamsplit ] , with the insertion of a beamsplitter of amplitude reflection and transmission coefficients @xmath187 and @xmath188 that allows interference between @xmath189 and @xmath190 . a photon detection event in such a setup",
    "can indeed be equivalent to the application of @xmath191 to the initial vacuum [ see eqs .",
    "( [ rho2],[athetaj ] ) ] , provided @xmath192 with @xmath193 .",
    "these angles @xmath194 and @xmath195 are mixing angles that fix the probability amplitudes of detection of a photon of mode 0 and of mode 1 .",
    "our angle @xmath195 in general depends both on the squeezing properties of the light source , and on the filtering of the signal before the photon detector , whereas the empirical @xmath196 only depends on the source . within a narrow - filter approximation that will be detailed in next subsection , such a setup can also account for averaged quantities ( [ xbar ] ) with the use of an average angle @xmath197 instead of @xmath195 ( see eq .",
    "( [ theta bar ] ) in the following ) .",
    "this possibility of interference between the homodyne signal and the @xmath190 signal is the crucial difference between the multimode and the empirical models : more interference makes the empirical model worse .",
    "the essential assumption of the empirical model is thus that the photon detection operator does not have a contribution from @xmath190 .",
    "then @xmath198 and @xmath199 could be replaced by @xmath42 and @xmath32 , respectively , according to eqs .",
    "( [ modereductionahout ] ) and ( [ adperp_mode_red ] ) , and the angle @xmath195 in eq .",
    "( [ rho2 ] ) by @xmath196 ( in which case , according to eq .",
    "( [ equivsetup ] ) , the beamsplitter @xmath200 in the equivalent model in fig .",
    "[ figmodelubeamsplit ] can be removed ) .    , the resulting wigner function is equivalent to the two - mode model depicted in the figure .",
    "the dopa may in general be represented by an ideal single mode dopa and a two - mode ndopa as in fig .",
    "[ modelu ] , and the photon counting is a combination of dark counts as well as a coherent mixture of the two output ports of the ndopa . compared to the empirical model developed in ref .",
    "@xcite , the only difference is the presence of the beam splitter @xmath200 which was not present in the empirical model . ]",
    "the empirical wigner function can be easily deduced from eq .",
    "( [ wj ] ) with the above replacements , and has the same form after the replacement of @xmath201 by @xmath202 .",
    "coefficients @xmath203 and @xmath204 are obtained by multiplying @xmath205 , @xmath206 by @xmath207 , and replacing @xmath208 and @xmath209 by @xmath42 and @xmath32 , respectively .",
    "this gives @xmath210 the coefficient @xmath211 is given by @xmath212 , and @xmath213 vanishes .",
    "the empirical model produces intuitive results .",
    "however , it requires justification .",
    "if large spectral slits would be used , then the homodyne mode and many other orthogonal modes would hardly be affected by the slit .",
    "if the detected photon could have come from many modes orthogonal to @xmath185 , then the modal purity @xmath182 would be unacceptably low , and also a large admixture of @xmath190 would enter the detection signal . indeed , some of us found experimentally that the spectral slit should be as narrow as possible , while still allowing the detection of a signal , in order to find the highest modal purities ( see also sec .",
    "[ sec : concretemultimode ] ) .",
    "consequently , narrow slits have been used in the photon - subtraction experiment  @xcite .",
    "although it is obvious that filtering is necessary , the use of a narrow spectral slit before the photon detector does not make the empirical model automatically valid .",
    "a quantitative comparison of both models is therefore needed to test the validity of the empirical model , as given below .",
    "let us now develop a simple spatio - temporal multimode model for which the bogoliubov transformation can be written explicitly .",
    "we assume that light propagation inside the dopa is described by modes of the form @xmath214 where the plane wave is exactly phase - matched , and where the amplitude @xmath178 satisfies the slowly - varying envelope approximation ( svea ) .",
    "this approximation does not hold for all the light that exits the nonlinear crystal , but the homodyne mode is supposed to be phase - matched , and we will assume that the filters before the apd block the modes that are not phase - matched .",
    "we will furthermore neglect diffraction effects within the dopa . in the basis @xmath215 , where @xmath43 and @xmath216 are spatial variables running on the dopa s transverse plane , the @xmath19 and @xmath20 of the bogoliubov transform  ( [ bogoliubov ] ) then become diagonal ( see appendix [ appendixbogoliubov ] ) , and we have @xmath217 in terms of operators that we assume to have commutation relations @xmath218= \\delta(x - x')\\delta(y - y')\\delta(t - t').\\ ] ] coefficients in the transformation  ( [ bogoliubov2 ] ) have the form    [ uvxyt ] @xmath219 , \\label{uxyt}\\\\ v(x , y , t ) & = & \\sinh[\\,q l \\",
    ", e_p(x , y , t)\\ , ] .",
    "\\label{vxyt}\\end{aligned}\\ ] ]    here @xmath220 is the pump - beam amplitude , which we assume to be real - valued .",
    "the parameter @xmath221 takes into account the nonlinearity of the crystal and @xmath222 is its length .",
    "one can allow for group velocity mismatch ( gvm ) in the crystal by convoluting @xmath223 by a rectangular unit gate of duration @xmath224 , the time separation induced by the gvm after passing the crystal ( see appendix [ appendixbogoliubov ] ) .",
    "more precisely , this convolution should be made twice , as we also have gvm for the second harmonic generation ( shg ) of the pump beam .",
    "the @xmath19 and @xmath20 are real - valued functions if the pump beam @xmath223 is so , which is a valid assumption if there is no frequency chirp .",
    "the homodyne mode @xmath225 will also be taken real - valued in the following .",
    "the homodyne signal is then given by @xmath226 , where integration over @xmath227 is implied .",
    "mode reduction now starts with the identification @xmath228 which is eq .",
    "( [ a0 ] ) specified for our spatiotemporal model .",
    "the mode - reduction parameters are now given by spatio - temporal integrals , for example    [ alphaeta2 ] @xmath229    further parameters can be found analogously .    _ averaging over photon detection events. _    we have seen in sec .",
    "[ subsecdetmodes ] that all averaged quantities can be obtained through the determination of the operator @xmath157 defined in ( [ equprojp2 ] ) when the filters are separately added to the bogoliubov transform . in the considered experiment",
    "two filters are used : a rectangular spectral slit , that can be described using ( [ equprojpomega ] ) ; and a monomode fiber that selects a single spatial mode @xmath230 , which we suppose to be real - valued , and therefore corresponds to the projector @xmath231 . note that in this experiment detection times are unknown at the scale of pulses duration , so that there is no time - domain filtering .",
    "( in the analysis one should average over all possible photon detection times . )",
    "we therefore have to use @xmath232 where @xmath233 if @xmath144 enters into the spectral slit , @xmath166 otherwise . here",
    "@xmath171 is the sampling beamsplitter reflectivity , and @xmath234 accounts for all other losses in the conditioning arm ( apd efficiency , optics losses ... ) . as can be seen from eq .",
    "( [ svea0 ] ) , the field amplitudes are defined around a central frequency @xmath169 ( or @xmath235 for the dopa pump beam , see appendix  [ appendixbogoliubov ] ) , so that the frequency @xmath236 for the amplitude fourier transform corresponds in fact to this central frequency ; in that way , a rectangular spectral slit well centered around this central frequency can be defined as @xmath237 $ ] .",
    "the operator @xmath157 defined in eq .",
    "( [ equpmodel ] ) should be applied to fourier - transformed mode functions : @xmath238 using eqs .",
    "( [ pj ] ) ,  ( [ equpmodel ] ) and  ( [ fourier ] ) , the average total photon detection probability per pulse then becomes @xmath239 where the average is taken over the detection modes @xmath240 .",
    "the expression  ( [ ptotcalc ] ) increases linearly with the filter width @xmath174 , but is valid only if @xmath174 is small enough to warrant the svea .",
    "furthermore , when conditioning upon a click in the detector in sec",
    ".  [ secconditioning ] , we assumed that @xmath241 , an assumption that can now be tested with the explicit formula  ( [ ptotcalc ] ) .    in general , the parameters @xmath242 and @xmath243 appear in @xmath134 as product sums like @xmath244 , or @xmath245 .",
    "in our concrete model , the evaluation of detection - averaged coefficients in the wigner function involves integrals of the type : @xmath246 for example , the average @xmath247 is found by substituting both @xmath248 and @xmath249 in  ( [ integral ] ) by the time - domain fourier transform of the function @xmath250 .",
    "[ here and in the following , we abbreviate products like @xmath251 by @xmath252 . ]",
    "since @xmath253 and @xmath254 are fourier transforms of real - valued functions , the corresponding integrals  ( [ integral ] ) are real - valued as well .",
    "hence , all mode - reduction parameters and coefficients in the wigner functions are also real - valued . in particular , the coefficient @xmath255 in @xmath256 vanishes , see eq .",
    "( [ dj ] ) .",
    "there is no difficulty to numerically evaluate integrals  ( [ integral ] ) and we will do that below , but let us first focus on an additional approximation that can considerably simplify these results , without becoming inaccurate .    _ narrow - filter approximation. _    we previously discussed the experimental observation that the spectral slit should be as narrow as possible .",
    "another simplification is possible in that case , that simply consists in neglecting in the integrals  ( [ integral ] ) the frequency dependence of the mode profiles within the narrow width @xmath174 , _",
    "i.e. _ @xmath257 for @xmath258 .",
    "let us recall that this value @xmath236 corresponds to the central frequency @xmath169 of the pulses , where the real - valued amplitudes present a maximum .",
    "this has two consequences : first , the presence of this maximum justifies a zero - order taylor approximation , provided the spectral width @xmath174 is much smaller than the spectral width of the pulses ( typically @xmath259 , where @xmath188 is the pulse duration ) ; second , if all functions involved in  ( [ integral ] ) present a maximum at @xmath236 , then the narrow - filter approximation generates an upper - bound for these integrals , and therefore for quantities like @xmath260 , @xmath261 or the modal purity @xmath262 ( see  [ xij],[xbar ] ) .",
    "this approximation will be applied and tested in sec .",
    "[ secnumerical ] , dedicated to the numerical results .",
    "this approximation brings the following simplification in the integrals  ( [ integral ] ) : @xmath263 evidently , we end up with separate integrals over @xmath264 and @xmath265 , and using the definitions  ( [ gammadelta ] ) we obtain the averages    [ gammabdeltab ] @xmath266    in the narrow - filter approximation , averages of products are simply given by products of averages , @xmath267 , and @xmath268 , etc .",
    "essentially in the @xmath269 limit the filter removes any temporal information about the time the photon was emitted from the dopa .",
    "the photodetection then corresponds to a single mode with @xmath270 , regardless of the average over detection times .",
    "we therefore find for the photon - subtracted squeezed state an average wigner function of the form  ( [ constantsinw ] ) , with coefficients    [ abarbbar ] @xmath271    and @xmath272 and @xmath273 .",
    "using the same substitution in ( [ xij],[athetaj ] ) we can also introduce the averaged modal purity @xmath274 and the average angle @xmath275 defined by : @xmath276    _ constant profiles. _    before dealing with a more realistic case , it is interesting to focus on the case of constant profiles .",
    "let us assume a constant value for @xmath277 , @xmath223 , and @xmath278 within a space - time support of volume @xmath279 .",
    "the normalization of the homodyne mode implies @xmath280 , and equation  ( [ uvxyt],[alphaeta2 ] ) leads to @xmath281 , @xmath282 , and @xmath283 . as @xmath32 vanishes , the mode @xmath34 is no more defined , and eqs .",
    "( [ delta],[deltab ] ) can not be used anymore .",
    "in fact the mode - reduction procedure now leads to an effective _ single_-mode model rather than a two - mode model .",
    "the homodyne mode is now in the single - mode space @xmath284 spanned by @xmath33,@xmath285 .",
    "one can simply put @xmath286 in  ( [ adperp_mode_red ] ) , and hence @xmath287 .",
    "this leads to the average angle @xmath288 .",
    "the modal purity becomes @xmath289 , as it should for a single - mode model .",
    "most importantly , we find @xmath290 , which according to eq .",
    "( [ constantsinw ] ) corresponds to the most negative value for the wigner function at the origin , @xmath291 .",
    "so , with constant profiles and a narrow filter slit , we recover from our multimode model the single - mode description for photon subtraction experiments .",
    "since this limit leads to the most negative wigner function , it represents the ideal limit for producing states for qip applications , at least according to our simple multimode model .",
    "this shows that the multimode nature essentially appears through the mode distortions due to the non - constant space and time profiles of the pulses .",
    "the central role of gain - induced distortions is particularly clear with regard to the multimode nature of the squeezed vacuum produced by the dopa : assuming a constant pump field , that is assuming no gain - induced distortions , is in fact enough to obtain @xmath283 .",
    "let us now return to a more realistic model , taking into account these profiles .    _",
    "gaussian profiles. _    as a more realistic simplification , we assume gaussian profiles for the various fields . for instance , we write the homodyne field @xmath277 as @xmath292 where @xmath293 is the beam waist , @xmath188 the duration of the gaussian pulse , and @xmath294 a normalization constant . the pump beam is usually obtained by shg , in a crystal pumped by a beam identical to the homodyne beam . in the lowest order of the shg process , the profiles of @xmath223 and",
    "@xmath295 have the same shapes , so we can assume another gaussian profile : @xmath296 where one expects the pump pulse duration to be @xmath297 .",
    "however , if gvm is taken into account , this gaussian profile  ( [ epxyt ] ) must be convoluted by rectangular gates . in practice ,",
    "such convolutions lead to beam profiles that are still very close to gaussians .",
    "the final gaussian profile to be introduced here is the spatial mode @xmath230 of the filter in front of the apd .",
    "it is the @xmath298 mode of a monomode fiber that is well approximated by a normalized gaussian of waist @xmath299 .",
    "here our goal is twofold : first , to compare our multimode analysis with the empirical model that was used before to analyze photon subtraction experiments .",
    "second , by exploring our multi - parameter multimode model , we look for parameter regimes that are best suited for producing states with the most negative wigner functions .    _ expansions in pump field. _    for our numerical work",
    "it is convenient to write all fields as taylor expansions in the pump field @xmath223 . from eq .",
    "( [ uvxyt ] ) it follows directly that    [ uuuvvv ] @xmath300 = \\sum_m b_m e_p^m , \\\\",
    "u\\,v(x , y , t ) &",
    "= & \\frac{1}{2}\\sinh[2 q l e_{p } ] = \\sum_m c_m e_p^m ,   \\\\",
    "v^2(x , y , t ) & = &   - \\frac{1}{2 } + \\frac{1}{2}\\cosh[2 q l e_{p } ] = \\sum_m d_m e_p^m,\\end{aligned}\\ ] ]    with @xmath301 as in eq .  ( [ epxyt ] ) .",
    "this defines the constant coefficients @xmath302 , and @xmath303 . for @xmath304 these expansions",
    "converge quite quickly .",
    "we then only have to insert relations ( [ uuuvvv ] ) into the various integrals for an efficient numerical evaluation .",
    "for instance , we can rewrite ( [ eta2 ] ) as : @xmath305 with @xmath306 in the same way we have    [ numeric ] @xmath307    with    [ numeric2 ] @xmath308    after fixing parameters , these expansions in the pump field can be readily used for numerical evaluations .    _ fixing basic parameters. _",
    "first we fix some parameters of our multimode model in order to present numerical results and to see how much our analysis differs from the one in ref .",
    "@xcite , where filtering before the photon detection was not modeled explicitly .",
    "we take @xmath309 and a transmission @xmath310 of the sampling beam splitter .",
    "moreover , we fix @xmath311 , which is compatible with the coupling efficiency into the filtering monomode fiber ( approximately @xmath312 , see ref .",
    "@xcite ) .    regarding efficiency of homodyne detection , the mode @xmath313 considered in sec .",
    "[ secmodered ] was defined as the mode that perfectly matches the local oscillator of the homodyne detection , in other words the matching efficiency equals unity by definition in our model .",
    "the transmission of the optics and the photodetection efficiency together lead to an overall efficiency of homodyne detection @xmath176 .",
    "we put @xmath314 , in agreement with ref .",
    "@xcite .    as stated above , if gvm is taken into account , the almost gaussian profile of the pump pulse is convoluted twice by a rectangular gate with time window @xmath315 .",
    "a @xmath316 crystal of length @xmath317 has @xmath318 . for an initial duration of the homodyne pulse @xmath319 ,",
    "the convolutions indeed lead to a nearly gaussian beam profile with @xmath320 .",
    "we assume the identity @xmath321 in the following .",
    "_ negative wigner functions. _    as stated in the introduction , the global minimum of a wigner function is the standard figure of merit for the nonclassicality and ` non - gaussianity ' of the corresponding state . after subtraction of a single photon ,",
    "the wigner function @xmath322 is always most negative in the origin ( since @xmath323 ) .",
    "figure  [ w0fs ] shows how @xmath324 depends on the squeezing factor @xmath325 .",
    "the most negative values are obtained in the low - squeezing limit @xmath326 .",
    "this can be understood as there is less gain - induced distortions in that case .",
    ", as a function of squeezing parameter @xmath325 , which is varied by changing the quantity @xmath327 .",
    "the narrow - filter approximation was made for the spectral slit .",
    "fixed parameters : pulse parameters @xmath328 , @xmath329 , transmission of sampling beam splitter @xmath330 , efficiency of homodyne detection @xmath331 . ]    , as a function of the spectral slit transmission for the homodyne mode . calculated for @xmath332 , using a complete evaluation of integrals  ( [ integral ] ) , i.e. without the narrow - filter approximation .",
    "the narrow - filter approximation is well satisfied for low transmissions . ]    in ref .",
    "@xcite , the best experimental results ( highest modal purities ) were obtained for @xmath332 . for this value of @xmath333 , which can be selected by choosing the right value for the quantity @xmath327",
    ", we obtain @xmath334 and @xmath335 ; the latter value is close to what was observed in  @xcite , without correction for the detection efficiency . at this stage , it can be interesting to compare this result , obtained using the narrow - filter approximation , with a more accurate calculation based on a complete evaluation of integrals  ( [ integral ] ) .",
    "figure  [ w0modelcompl ] presents the numerical results obtained for @xmath324 at @xmath332 as a function of the spectral slit transmission for the homodyne mode .",
    "( this transmission can be increased by making the spectral slit width @xmath174 larger . ) a minimal value is clearly reached for low transmissions , justifying _ a posteriori _ the use of narrow spectral slits in the experiment of ref .  @xcite . since for low transmissions",
    ", @xmath336 does not differ much from its minimal value , the narrow - filter approximation that we made in sec .",
    "[ sec : concretemultimode ] gives accurate results .",
    ", as a function of @xmath337 , where @xmath338 is the waist of the pump field and @xmath293 is the waist of the homodyne field .",
    "@xmath339 is fixed such that squeezing parameter @xmath332 .",
    "other parameter values as in fig .",
    "[ w0fs ] . ]",
    "figure  [ w0fw ] predicts the behavior of @xmath324 when varying the size of the pump beam .",
    "experimental values for the widths were related by @xmath340  @xcite .",
    "[ w0fw ] clearly shows that one can await a high increase of the negativity from a larger pump beam .",
    "this result was intuitive , as there is less gain - induced distortions in that case , but is here quantified .",
    "this can motivate the use of amplified pulses  @xcite , in order to have a spatially broader pump beam ( _ i.e. _ with larger @xmath341 ) , but with the same intensity .",
    "_ comparison with empirical model. _",
    "measured negative wigner functions were interpreted in  @xcite using the empirical model as introduced in sec .",
    "[ secempirical ] , where the photon is subtracted in the ` good ' mode @xmath45 with probability @xmath182 , and where the state is left in the squeezed vacuum with probability @xmath183 .",
    "as explained before , the main difference between the empirical and our models is that the conditioned state in the former corresponds to the single - photon initial state @xmath342 with @xmath343 , while it corresponds to @xmath344 in the latter , with @xmath345 . these angles @xmath194 and @xmath346 are mixing angles that fix the probability amplitudes of detection of a photon of mode 0 and of mode 1 .",
    "figure  [ theta ] shows @xmath196 and @xmath197 as a function of the squeezing parameter @xmath333 .",
    "clearly , @xmath196 and @xmath197 do not differ too much , and by less than @xmath347 for @xmath332 .",
    "( solid line ) and @xmath196 ( dashed line ) of modes 0 and 1 , as a function of squeezing parameter @xmath333 , which is varied by changing @xmath327 .",
    "other parameter values as in fig .",
    "[ w0fs ] . ]",
    "another important difference between our model and the empirical model is that modal purities @xmath348 in our model are fixed by the relation  ( [ xij ] ) , whereas the parameter @xmath182 in the empirical model is a free parameter .",
    "this freedom can be used to fit the data , _",
    "i.e. _  to have @xmath349 or @xmath350 .",
    "it is however not _ a priori _ possible to fit both parameters @xmath205 and @xmath206 ( [ abar],[bbar ] ) from ( [ abempirical ] ) using only the fitting parameter @xmath182 . in neither model",
    "should the variances @xmath50 and @xmath51 be considered as free fitting parameters of the photon - subtraction experiment , at least their values should agree with the values for @xmath110 obtained by homodyne measurements of the squeezed vacuum .    in our model the mixing angles @xmath351 and their average @xmath346 take into account the filtering of the signal that is used for conditioning . in the empirical model , the corresponding angle @xmath194 is independent of the filtering .",
    "thus it is to be expected that this inaccuracy of the empirical model will lead to optimally fitted modal purities @xmath352 in the empirical model that are systematically lower than the average modal purity @xmath353 in our model .",
    "this is indeed what we find for the curves in figure  [ figwigner ] : the best fit in the present example is obtained for @xmath354 , a value that is indeed smaller but still close to @xmath355 .",
    "the high quality of this fit ( with an error less than @xmath356 ) is directly linked to the fact that in the present case @xmath357 .",
    "there is a possibility to improve this result if @xmath111 is considered as a fitting parameter as well .",
    "we obtained an error of less than @xmath358 between the wigner functions for @xmath359 and @xmath360 , _ i.e. _  for a value of @xmath111 that differs by @xmath361 from the value given by the multimode model .",
    "in other words , if @xmath111 has a great influence on @xmath203 and @xmath204 in ( [ abempirical ] ) , it has a very low impact on @xmath50 , @xmath51 ; the change from @xmath334 to @xmath360 modifies the values of @xmath50 , @xmath51 by only a few @xmath362 , and for this reason it is very difficult to accurately measure @xmath111 from squeezed vacuum @xcite .",
    "these considerations explain why the empirical model can fit experimental data so successfully ; even when @xmath196 is not equal to @xmath275 , the parameter @xmath111 gives a supplementary freedom for fitting .     and",
    "@xmath363 of the wigner function @xmath322 ( solid line ) , and corresponding best fits using the empirical model ( dashed line ) with @xmath364 .",
    "parameter values as in fig .",
    "results of our model and the empirical fits almost overlap . ]",
    "we have introduced a straightforward and physically intuitive procedure that we call ` mode reduction ' to simplify the multimode description of squeezed light to the bare essentials . for photon - subtraction experiments",
    ", this means that the homodyne signal is reduced to an effective two - mode description and the detector signal requires one extra orthogonal effective mode .",
    "we derived the wigner function of the homodyne signal conditional upon the detection of a single photon , and we also showed how to average over possible measurement outcomes .    the general mode - reduction formalism was then applied to a detailed model describing photon subtraction of gaussian spatiotemporal pulses of squeezed light .",
    "this model features many experimental parameters such as beam waists and duration of the pulses that can be independently measured .",
    "indeed , our model does not have free fitting parameters .",
    "this allows one to study in detail what are the crucial experimental parameters to produce optimally negative wigner functions with pulses of squeezed light .",
    "we compared our new model to the empirical model that was used before to analyze photon - subtraction experiments in @xcite .",
    "in fact , the formulae for the output wigner functions look similar .",
    "one crucial difference is that the empirical model does have a free parameter , namely the quantity called the modal purity . in our model modal purities also occur , be it with a slightly different meaning , but they are fixed quantities .",
    "a good agreement between our model and experiments therefore gives more understanding than an accurate fit with the empirical model .",
    "we found that in the range of parameters of the measurements in  @xcite , both our model and the empirical model are accurate . we reasoned that modal purities in our model would be systematically higher , and in our numerical example we found this to be the case .",
    "the accuracy of the empirical model strongly depends on the availability of the free parameter .",
    "it was nevertheless a surprise in the theoretical analysis that the mixing angles @xmath194 and @xmath346 , describing the relative probability of measuring a photon in either one of two effective modes , differ at most @xmath365 in a whole range of squeezing parameters .",
    "our mode - reduction procedure is closely related to the analysis of photon - subtraction experiments of refs .",
    "one could express our mode - reduction parameters in terms of elements of the covariance matrix of refs .",
    ". our output wigner function in eq .",
    "( [ wj ] ) then reduces to the one in ref .",
    "@xcite , but only in the special case that all our mode reduction parameters are real - valued so that @xmath366 in eq .",
    "( [ dj ] ) vanishes .",
    "this we assumed for simplicity in sec .",
    "[ sec : concretemultimode ] .",
    "our mode - reduction procedure is carried out in the heisenberg picture .",
    "we think that our approach has some advantages . in our approach",
    "it becomes quite intuitive in what sense it goes beyond the empirical model of ref .",
    "@xcite . in our concrete multimode analysis",
    ", we include effects not considered in ref .",
    "@xcite , such as the transverse beam profile , for which we found that wider pump beams lead to more negative wigner functions .    in conclusion",
    ", we presented a very concise model that can account for the multimode nature of projective photon - counting measurements .",
    "it gives an intuitive picture of photon - subtraction experiments , close to the empirical model previously published .",
    "this multimode model therefore gives consistent results , in agreement with previously published experiments where pulses of light with negative wigner functions were produced conditionally .",
    "our model can be used to predict the changes in the output upon variation of experimentally relevant parameters , and to optimize the setup design .",
    "we thank k. mlmer for useful discussions .",
    "this work has been supported by the danish research council through quantop , by compas , and by the niels bohr international academy .",
    "in order to derive eq .",
    "( [ wj ] ) from eq .",
    "( [ winitial ] ) , one has first to invert eqs .",
    "( [ modereductionahout],[a1out ] ) , leading to @xmath367 one should then replace in eq.([winitial ] ) @xmath100 by @xmath368 , and @xmath102 , and integrate over @xmath369 , @xmath102 .",
    "it is however convenient to make a change of variables so that the integral is over @xmath370 , @xmath371 instead of @xmath369 , @xmath102 . in this case",
    "the only transforms needed for this calculation is    [ rel_x0p0 ] @xmath372    as well as the transformation of the integral @xmath373 one should then note that the wigner function  ( [ winitial ] ) is the product of a polynomial in @xmath43 , @xmath44 , and of a gaussian term @xmath374 , with @xmath375 with eq .",
    "( [ rel_x0p0 ] ) , the exponent can be rewritten as @xmath376 the integral  ( [ x1p1integral ] ) with eq .",
    "( [ winitial ] ) as its integrand can then be found by replacing in the integrand the squares @xmath377 and @xmath378 by    @xmath379    and by replacing the first - order terms according to    @xmath380",
    "the goal of this appendix is the derivation of the local bogoliubov transformation  ( [ bogoliubov2 ] ) .",
    "we assume that inside the dopa the pump pulse with an angular frequency @xmath235 travels at a speed @xmath381 , with negligible absorption .",
    "this field can therefore be written as @xmath382 where @xmath383 is an arbitrary time delay and where ` @xmath384 ' is a purely conventional phase factor .",
    "let us write the probe beam as @xmath385 where the phase - matching condition @xmath386 is assumed to be satisfied . by using the svea in maxwell s equations , neglecting diffraction terms and considering the first - order dispersion ,",
    "we obtain @xmath387 where @xmath388 .",
    "the substitution of @xmath389 by @xmath10 then leads to @xmath390 where @xmath391 is the gvm . with the assumption that @xmath223 is real - valued , the solution to eq .",
    "( [ svaaeq ] ) becomes @xmath392\\,a_{\\rm in}+\\sinh[\\,q l f_p \\,]\\,a^*_{\\rm in},\\ ] ] where the @xmath215-dependence was suppressed .",
    "the effective pump field @xmath393 is given by @xmath394 with @xmath395 the time separation induced by the gvm after crossing the crystal .",
    "( [ fpintegral ] ) shows that the effective pump field @xmath393 is a convolution of the pump field @xmath223 with a rectangular unit gate of duration @xmath224 , which for @xmath396 is centered around the origin . as the quantized version of eq .",
    "( [ aoutsolved ] ) , we then find eq .",
    "( [ bogoliubov2 ] ) of the main text .",
    "the pump field @xmath397 of the main text is to be understood as the effective pump field @xmath393 derived here .",
    "evidently , @xmath398 in the limit @xmath399 ( no gvm ) .",
    "j.  eisert , s.  scheel , and m.b .",
    "plenio , phys .",
    "89 * , 137903 ( 2002 ) .",
    "g.  giedke and j.i .",
    "cirac , phys .",
    "a * 66 * , 032316 ( 2002 ) .",
    "browne , j.  eisert , s.  scheel , and m.b .",
    "plenio , phys .",
    "a * 67 * , 062320 ( 2003 ) .",
    "kim , e.  park , p.l .",
    "knight , and h.  jeong , phys .",
    "a * 71 * , 043805 ( 2005 ) .",
    "a.  biswas and g.s .",
    "agarwal , phys .",
    "a * 75 * , 032104 ( 2007 ) .",
    "m.  dakna , t.  anhut , t.  opatrn ' y , l.  kn \" oll , and + d .- g .",
    "welsch , phys .",
    "a * 55 * , 3184 ( 1997 ) .",
    "t.  opatrn ' y , g.  kurizki , and d .-",
    "welsch , phys .",
    "a * 61 * , 032302 ( 2000 ) .",
    "lvovsky , h.  hansen , t.  aichele , o.  benson , j.  mlynek , and s.  schiller , phys .",
    "lett . * 87 * , 050402 ( 2001 ) .",
    "j.  wenger , r.  tualle - brouri and p.  grangier , phys .",
    "lett . * 92 * , 153601 ( 2004 ) .",
    "a.  ourjoumtsev , r.  tualle - brouri , j.  laurat , and ph .",
    "grangier , science * 312 * , 83 ( 2006 ) , and supporting online material .",
    "a.  ourjoumtsev , r.  tualle - brouri , and ph .",
    "grangier , phys .",
    "lett . * 96 * , 213601 ( 2006 ) .",
    "k.  wakui , h.  takahashi , a.  furusawa and m.  sasaki , e - print quant - ph/0609153v1 .",
    "neergaard - nielsen , b. nielsen , c.  hettich , k.  mlmer , and e.s .",
    "polzik , phys .",
    "lett . * 97 * , 083604 ( 2006 ) .",
    "a.  ourjoumtsev , h.  jeong , r.  tualle - brouri , p.  grangier , nature * 448 * , 784 ( 2007 ) .",
    "v.  parigi , a.  zavatta , m.  kim , and m.  bellini , science * 317 * , 1890 ( 2007 ) .",
    "kim , j. phys .",
    "b : at . mol .",
    ". phys . * 41 * , 133001 ( 2008 ) .",
    "m. avenhaus , h. b. coldenstrodt - ronge , k. laiho , w. mauerer , i. a. walmsley and c. silberhorn , phys .",
    "* 101 * , 053601 ( 2008 ) .",
    "m.  sasaki and s.  suzuki , phys .",
    "a * 73 * , 043807 ( 2006 ) .",
    "k.  mlmer , e - print quant - ph/0602202v1 .",
    "nielsen and k.  mlmer , phys .",
    "a * 75 * , 023806 ( 2007 ) .",
    "nielsen and k.  mlmer , phys .",
    "a * 76 * , 033832 ( 2007 ) .",
    "f.  grosshans and ph .",
    "grangier , phys .",
    "lett . * 88 * , 057902 ( 2002 ) .",
    "t. aichele , a.i .",
    "lvovsky and s. schiller , eur .",
    "j. d * 18 * , 237 ( 2002 ) .",
    "a. la porta and r. e. slusher , phys .",
    "a * 44 * , 2013 ( 1991 ) .",
    "gardiner and p.  zoller , _ quantum noise _",
    "( springer , berlin , 2000 ) .",
    "j.  wenger , j.  fiurek , r.  tualle - brouri , n.j .",
    "cerf , and p.  grangier , phys .",
    "a * 70 * , 053812 ( 2004 ) .",
    "u.  leonhardt , _ measuring the quantum state of light _ ( cambridge university press , 1997 ) ."
  ],
  "abstract_text": [
    "<S> we present a general model to account for the multimode nature of the quantum electromagnetic field in projective photon - counting measurements . </S>",
    "<S> we focus on photon - subtraction experiments , where non - gaussian states are produced conditionally . </S>",
    "<S> these are useful states for continuous - variable quantum information processing . </S>",
    "<S> we present a general method called mode reduction that reduces the multimode model to an effective two - mode problem . </S>",
    "<S> we apply this method to a multimode model describing broadband parametric downconversion , thereby improving the analysis of existing experimental results . </S>",
    "<S> the main improvement is that spatial and frequency filters before the photon detector are taken into account explicitly . </S>",
    "<S> we find excellent agreement with previously published experimental results , using fewer free parameters than before , and discuss the implications of our analysis for the optimized production of states with negative wigner functions . </S>"
  ]
}