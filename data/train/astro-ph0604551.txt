{
  "article_text": [
    "adaptive optics provides the ability to achieve near diffraction - limited performance on large ground - based telescopes ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "there is a strong incentive to develop and deploy ao systems because the cost of a large , ground - based telescope equipped with ao is modest compared to that of a comparable aperture space telescope .",
    "most large observatories already have ao systems either in place or under development , and the data from these systems are beginning to yield scientific results ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "while ao images show clear advantages over seeing - limited data in resolution and sensitivity , there remain significant obstacles to the full analysis of these data .",
    "characterization of the ao point - spread function ( psf ) is arguably the most serious of these challenges .",
    "conventional ao systems deliver modest correction ( strehl ratio , @xmath0 ) over a field of view of a few tens of arc seconds ( e.g. , * ? ? ?",
    "* ) although some high - order natural guide star systems afford better performance ( e.g. , * ? ? ?",
    "experience shows that the chance of finding a suitable psf star within this field is small .",
    "moreover , because the precision and accuracy of wavefront correction is sensitive to the observing conditions , including seeing , wind speed and brightness of the wavefront reference it is often a futile exercise to observe a psf calibration field at a different time .    changing atmospheric conditions and ao performance lead to variable correction , causing variations in the amount of energy in the diffraction - limited core of the psf relative to the uncorrected seeing halo .",
    "these variations affect the strehl ratio .",
    "systematic errors in photometry will occur if these strehl variations are not taken into account in evaluating the photometric curve of growth and the corresponding aperture corrections .",
    "the angular scales of diffraction and seeing are @xmath1 and @xmath2 , respectively , where @xmath3 is the observing wavelength , @xmath4 is diameter of the telescope , and @xmath5 is the fried parameter . for a large telescope at a good site , operating in the near infrared ( ir ) , the ratio @xmath6 .",
    "thus , the surface brightness of the seeing halo can be more than two orders of magnitude fainter than the psf core , rendering it challenging to measure the seeing halo directly  even if a suitable star is present . the direct approach to estimating the psf is further frustrated because science targets selected for ao observations will tend to have multiple sources per seeing disk .",
    "an innovative approach uses telemetry from the ao system to estimate the psf from the residual wavefront errors @xcite .",
    "however , this method has not been implemented for all ao system architectures , and it can not correct for non - common path wavefront errors between the wavefront sensor and the science camera .",
    "myopic deconvolution is another promising alternative , which simultaneously estimates the source distribution and the psf @xcite . in the `` starfinder '' code @xcite , which is designed for analysis of variable strehl - ratio observations of stellar fields ,",
    "the psf is extracted directly from the image frame .",
    "these approaches use information about the imaging system to various degrees .",
    "for example , in myopic deconvolution it is possible to specify the support of the psf in frequency space @xcite .",
    "it is our objective to capture some rudimentary properties of the atmosphere , ao system , telescope and detector to build a model psf , which can be constrained by ao observations of astronomical scenes .",
    "our primary interest is in estimating the photometric curve of growth , so we consider only the azimuthally averaged psf .",
    "initial astronomical application of this algorithm was made by one of us ( jrg ) in @xcite .",
    "in   [ mtfpsf ] we present our description of an ao system , including partial wavefront correction (   [ partialao ] ) . in   [ extract ] we describe how to interpret the power spectrum of an ao image in terms of the mtf and the source distribution power spectrum . section [ keckaopsf ] describes the influence function of the deformable mirror in the keck ao system .",
    "we use the resulting model to simulate keck ao data (   [ fitting ] ) and show that the psf can be recovered from synthetic images (   [ fakefitting ] ) , and the results of application to keck lgs ao data are outlined in   [ realfitting ] .",
    "the complex optical transfer function ( otf ) describes the response of a linear optical system at some spatial frequency in the image plane , @xmath7 .",
    "the point - spread function ( psf ) forms a fourier pair with the system otf .",
    "each independent component of an optical system , from the atmosphere through to the detector , has its own otf .",
    "the system otf is the product of each of the separate otfs ( e.g. , * ? ? ?",
    "for the bulk of this paper , we consider only circularly symmetric psfs . in this case , the complex part of the otf is zero and the system is fully described by the real part of the otf , which is known as the modulation transfer function ( mtf ) .",
    "we consider three principal components that contribute to the system mtf : the atmosphere ( partially corrected by an ao system ) , the telescope pupil , and the detector .",
    "our notation is summarized in appendix [ mtfs ] .",
    "suppose the phase in the pupil plane of the telescope at a point @xmath8 is @xmath9 and that the phase correction presented by the deformable mirror ( dm ) at this point can be described by the convolution @xmath10 h(\\mathbf{r}-\\mathbf{r } ' ) d \\mathbf{r } ' , \\label{dm_convolution}\\ ] ] where @xmath11 represents the error in the wavefront , and @xmath12 is the influence function of the dm , i.e. , the shape on the dm created by pushing a single actuator .",
    "the term @xmath13 can be used to represent a static wavefront aberration , or the wavefront measurement error .",
    "the corrected phase after the dm is @xmath14 taking the fourier transform of eq .",
    "( [ dm_correction ] ) , substituting @xmath15 from eq .",
    "( [ dm_convolution ] ) , and applying the convolution theorem , the expectation value of the power spectrum of residual phase errors at spatial frequency in the pupil plane , @xmath16 , is @xmath17 ^2    @xmath18 is the fourier transform of the influence function and @xmath19 is the variance of wavefront measurement error . in deriving eq .",
    "( [ phitwiddle ] ) , we assumed that @xmath20 represents uncorrelated , zero - mean noise .",
    "the notation @xmath21 denotes the atmospheric phase error power spectrum ( see   [ atmomtf ] ) .",
    "the ao system can be thought of as high - pass filter in the pupil plane , with filter function @xmath22 ^ 2 $ ] ( see   [ keckaopsf ] and fig .",
    "[ modelmtf ] ( a ) ) .",
    "the ao - corrected atmospheric structure function , @xmath23 , can be found from eq .",
    "( [ dofr ] ) by substituting the filtered phase error power spectrum @xmath24 from eq .",
    "( [ phitwiddle ] ) . since @xmath25 and @xmath18 are both circularly symmetric the 1-d form of the integral can be used .",
    "the expression for the mtf of an ao - corrected atmosphere is then given by eq .",
    "( [ dtot ] ) , @xmath26.\\ ] ] the final system mtf is given by the product of the mtfs for the atmosphere , the telescope ( eq . [ pupmtf ] ) , and the detector ( eq .  [ pixelmtfeq ] ) @xmath27 the final step involves finding the psf ( eq .  [ ttopsf ] ) or the encircled energy ( ee ) ( eq .",
    "[ ttoee ] ) from the hankel transforms of @xmath28 .",
    "we now describe a procedure for estimating the mtf from observations of a crowded stellar field .",
    "consider an astronomical scene consisting of a distribution of sources of amplitude and position given by the function @xmath29 . the resultant image , @xmath30",
    ", @xmath31 is the convolution of this scene with the psf plus additive noise @xmath32 .",
    "we assume that @xmath32 is zero - mean gaussian noise .",
    "this assumption will require our data are accurately sky - subtracted before analysis .",
    "taking the fourier transform of eq .",
    "( [ imageformation ] ) and applying the convolution theorem , we find that the power spectrum of the image , @xmath33 , is the product of the source distribution power spectrum , @xmath34 , and the psf power spectrum , plus a constant noise floor , @xmath35 .",
    "since the psf and the mtf are fourier pairs , the power spectrum of the image is given by latexmath:[\\[\\label{scene }     if the source distribution is spatially uncorrelated then @xmath34 can be approximated as a multiplicative constant , and we should be able to estimate the mtf directly from @xmath37 . using a model for the imaging performance of the ao system ( e.g. ,   [ keckaopsf ] ) , we may fit @xmath37 , yielding the mtf and parameters that characterize the seeing and ao performance . with an estimate of the mtf in hand we can compute quantities of photometric interest , e.g. , the encircled energy versus radius .",
    "if the distribution of sources in an image is not random then it is not a good approximation to treat @xmath34 as a constant and the observed power spectrum is not simply proportional to @xmath38 .",
    "even if the underlying spatial source distribution is random , astronomical luminosity functions are commonly steep , and the power in an image can be dominated by the the poisson fluctuations assoicated with a few bright sources .",
    "thus , if we do not take account of @xmath34 when we estimate @xmath39 our results will suffer from significant bias .    we can correct this systematic error in @xmath38 by first estimating @xmath34 from the location and _ relative _ brightness of stars in the image .",
    "this can be accomplished by using the methods of crowded field photometry to build a model image , @xmath40 ( e.g. , * ? ? ?",
    "the power spectrum of @xmath40 can be used as an estimate of @xmath34 , and the model mtf is multiplied by @xmath41 prior to fitting to the observed power spectrum .",
    "our results show that even a simple estimate of @xmath29 without any knowledge of the psf is effective .",
    "this tactic works well , even when the uncorrected seeing halos of multiple adjacent stars overlap , which will be a common occurrence in ao data .",
    "moreover , this procedure can be applied iteratively with daophot or starfinder to refine the psf and thereby improve @xmath40 .",
    "if the density of stars is sufficient that their diffraction - limited cores are blended , then it is unlikely that we can measure @xmath40 with any reliability .",
    "however , this is the circumstance when the approximation @xmath42 constant may be adequate .",
    "phase information has been discarded in eq .  [ scene ] and",
    "some information about the azimuthal structure of the psf has been lost . however , our goal here is to estimate the angular scales on which is light is scattered so that we can recover the photometric curve of growth .",
    "thus , for the current application we choose to consider only the azimuthally averaged psf and its corresponding 1-d power spectrum .",
    "astronomical ao systems do exhibit non - axisymmetric aberrations  and eq .",
    "( [ scene ] ) does encode information about even - order aberrations , e.g. , astigmatism .",
    "thus , modeling the 2-d power spectrum may be promising for describing effects such as anisoplanatism .",
    "the data are generally multiplied by a window function that represents the field of view and by an apodizing function , which is necessary to reduce spectral leakage . in the fourier domain ,",
    "the window function convolves the fourier transform .",
    "consequently , @xmath33 is broadened relative to the psf power spectrum by the window function . for a square window of width @xmath43 ,",
    "the fwhm of the corresponding @xmath44 function is @xmath45 . since @xmath43 is typically several hundred pixels , the broadening is slight and is ignored in this treatment",
    "to explore the potential for measuring the mtf from astronomical data , we create synthetic images similar to those obtained by an actual ao system . ultimately , we will consider data obtained using the nirc2 camera fed by the keck observatory s ao system operating in lgs mode .",
    "we thus construct model ao psfs and mtfs with parameters appropriate for this system .    for a telescope with a circular pupil and a circular central obscuration",
    ", @xmath46 is a simple analytical function of spatial frequency ( e.g. , * ? ? ? * ) .",
    "although dealing with a circular pupil simplifies the problem , we chose to use the radially averaged mtf derived from the approximately hexagonal keck pupil .",
    "we first generated a keck pupil image for the nirc2 camera operating with the largehex pupil stop using the idl procedure nirc2pupil , which is supplied by the keck observatory .",
    "this pupil map includes the central obscuration and the spiders .",
    "the 2-d autocorrelation function of this image is @xmath46 .",
    "we then average this pupil image in equally spaced radial bins to construct a radially symmetric pupil transfer function .",
    "to express @xmath46 in terms of normalized spatial frequency , we define a cutoff frequency by setting @xmath47  m , the diameter of the circle circumscribing the keck pupil .",
    "the cutoff angular frequency of the system , @xmath48 , is subsequently defined for a telescope with this pupil diameter .    to construct the ao corrected atmospheric mtf",
    ", we adopt a modified kolmogorov atmospheric phase power spectrum with a finite outer scale , @xmath49 ( cf .",
    ".  [ kol_unmod ] ) @xcite .",
    "measurements suggest that the outer scale of turbulence , @xmath50 10100  m .",
    "the form of eq .",
    "( [ kol_mod ] ) is such that the presence of a finite outer scale leaves the power unaffected , at @xmath51 .",
    "we obtain the ao filtered power spectrum @xmath52 by adopting the influence function appropriate for the 349-actuator xinetics inc .",
    "mirror employed in the keck system @xcite .",
    "the properties of this mirror are given by @xcite who approximate the sinc - like influence function as the difference of two gaussians , @xmath53 - \\nonumber \\\\      & &       \\frac{2}{\\pi^2 } \\exp \\left [ -2(\\rho/\\pi\\sigma_{dm})^2 \\right ]              \\big{\\}}\\end{aligned}\\ ] ] where @xmath54 is the radial coordinate on the dm , and @xmath55 defines the spatial scale over which a single dm actuator affects the wavefront .",
    "the fourier transform of this circularly symmetric function is @xmath56    - \\nonumber \\\\            & &     \\frac{1}{2 } \\exp \\left [               -(\\pi^2\\sigma_{dm}\\kappa)^2/2\\right ] .\\end{aligned}\\ ] ] to mimic the effects of variable correction , we replace the influence function by @xmath57 .",
    "a value of @xmath58 implies no correction , @xmath59 yields 6 db , @xmath60 yields 12 db , and @xmath61 gives perfect correction at zero frequency .    using eq .",
    "( [ phitwiddle ] ) for the filtered atmospheric spectrum with an influence function described by eq .",
    "( [ ftkeckif ] ) , and assuming a modified kolmogorov spectrum eq .",
    "( [ kol_mod ] ) , we can calculate the atmospheric mtf by evaluating the integral eq .",
    "( [ dofr ] ) for the structure function and substituting the result in eq .",
    "( [ t_atmos_ao ] ) .",
    "the final system mtf is then the product of the partially corrected atmospheric mtf with the pupil and pixel mtfs ( eq .  [ sysmtf ] ) .",
    "the corresponding psf for these parameters is then found using eq .",
    "( [ ttopsf ] ) .    as an example",
    ", we adopt values of @xmath4 = 10.99  m , @xmath5 = 65  cm , @xmath62 = 30.0  m , @xmath55 = 56  cm ( the spacing of the dm actuators projected onto the primary mirror ) , @xmath3 = 1.65  @xmath63 m , and @xmath60 .",
    "position in the image plane is converted into pixel units for the nirc2 narrow field camera assuming a scale of @xmath64  pixel@xmath65 .",
    "we assume that wavefront measurement error , @xmath66 in eq .",
    "[ phitwiddle ] , is negligible , and set it to zero .",
    "the diffraction - limited psf is computed by substituting @xmath46 for @xmath67 into eq .",
    "( [ ttopsf ] ) .    figure  [ modelmtf ] shows the resultant filtered and unfiltered atmospheric phase power spectra , phase structure functions , and associated mtfs .",
    "the filter function , @xmath68 ^ 2 $ ] in eq .",
    "( [ phitwiddle ] ) , suppresses the power spectrum at low frequencies .",
    "figure  [ modelmtf ] shows that the ao system has no effect on spatial scales smaller than the actuator spacing .",
    "the inability of the ao system to sense and correct for phase errors above the corresponding spatial frequency , along with its imperfect correction within the control bandwidth , prevents the final mtf from reaching the diffraction limited mtf .",
    "the resultant narrow mtf produces a psf broadened from the diffraction - limited case with the familiar core - halo structure in psfs delivered by ao systems ( e.g. , * ? ? ?",
    "the diffraction - limited psf ( no atmosphere ) and the partially corrected case are shown in figure  [ perf_65psf ] .",
    "the psfs shown are constructed by interpolating a highly oversampled psf onto a grid appropriate for the nirc2 camera .",
    "though even a perfect , diffraction limited psf must be sampled onto a pixel array , for the purposes of demonstrating change in strehl ratio , the diffraction limited psf shown has been constructed without taking the pixel mtf into account .",
    "using psfs generated according to the recipe of   [ keckaopsf ] , we generate mock keck images from which we then extract the mtf by fitting our model to the resultant image power spectrum .",
    "we evaluate the robustness of our approach by comparing the input and recovered parameters and we quantify photometric errors by evaluating the discrepancy between the model and reconstructed psf and ee .",
    "we consider three model psfs with @xmath5 = 50 , 65 , and 100  cm , and common parameters @xmath62 = 30  m , @xmath69 = 1.5 , and @xmath55 = 56  cm .",
    "again , we ignore measurement noise by setting @xmath70 . to explore the effects of crowding , we populated images with 5 , 50 , 500 , 5000 , 50,000 , and 5@xmath7110@xmath72 stars in a field of view of @xmath73 .",
    "the stars have random positions and normally distributed brightnesses .",
    "the final step of synthesizing a star field involves convolving the array of delta functions with the psf .",
    "the heights of the delta functions are scaled to approximate the distribution of fluxes present in our data , and we add normally distributed noise to the images to represent detector read noise and poisson sky noise so that the model images have similar signal - to - noise ratios as our observations .",
    "some example model images are shown in figure  [ fakeims ] .",
    "figure  [ fake_data_model ] shows the measured power spectrum of the @xmath74 , @xmath75  cm image from figure  [ fakeims](b ) .",
    "also plotted is the model mtf ( squared ) used to generate the psf multiplied by the input source distribution power spectrum , @xmath76 as calculated from the array of delta functions used to construct the image .",
    "the model spectrum has been fit to the data using only a multiplicative normalization factor and an additive constant to represent the noise .",
    "inspection of this plot suggests that it is reasonable that the mtf should be recoverable from astronomical data .    since our goal is to establish the unknown mtf for real astronomical data we test the ability of a non - linear least squares fit to recover the input parameters from simulated data .",
    "we use the idl procedure mpfit to perform a levenberg - marquardt least - squares fit of our model mtf to eq .",
    "( [ scene ] ) using @xmath41 as an estimate of the source distribution power spectrum .",
    "since we radially average the measured power spectrum , we are able to directly measure the error in each frequency bin by calculating the variance of each ensemble of pixels . we found that reliable error estimates were necessary to obtain unbiassed fits , especially when the ao correction was poor .",
    "the model function for @xmath28 in eq .",
    "[ sysmtf ] is calculated in steps .",
    "the transfer function @xmath77 is calculated numerically from the keck pupil as described in   [ keckaopsf ] .",
    "the pixel transfer function @xmath78 is calculated analytically from eq .",
    "[ pixelmtfeq ] .",
    "both @xmath46 and @xmath79 have no free parameters .",
    "@xmath80 is , itself , calculated in steps .",
    "we first calculate the ao filtered atmospheric phase error power spectrum @xmath81 as given in eq .",
    "[ phitwiddle ] , using eq .",
    "[ kol_mod ] for the unfiltered atmospheric power spectrum and eq .",
    "[ ftkeckif ] in @xmath82 . calculating these quantities introduces the fit parameters @xmath5 , @xmath62 , @xmath55 , @xmath69 , and @xmath83 .",
    "the structure function is then constructed numerically using eq .",
    "( the numerical calculation of the structure function is by far the most computationally time consuming step , a problem compounded by the many iterations necessary of a non - linear least squares fit . ) @xmath84 is then given by eq .",
    "[ dtot ] .",
    "we consider @xmath55 a known quantity and hold it constant at 56  cm .",
    "we also neglect any wavefront measurement error and set @xmath85 .",
    "in addition , we fit for the multiplicative normalization constant of the term @xmath86 and the noise in the image , @xmath35 .",
    "these terms , however , do not affect the resulting psf .",
    "we estimate @xmath41 with a variety of methods .",
    "the first uses aperture photometry : for each image , we perform fits using the daophot routine find implemented in idl to locate sources in the image and to estimate their relative fluxes .",
    "the second method is iterative : using the parameters determined from the find fits we generate a psf and use this psf with the crowded field photometry package starfinder @xcite to again estimate the source function , hopefully more accurately .",
    "( note , we use starfinder only to determine the location and relative intensity of point sources , not to estimate the psf . )",
    "we use parameters from this fit to generate a new psf to use again with starfinder in a subsequent iteration .",
    "the third method is used to investigate how well the fits work when analyzing model data and the source function is known perfectly : we compute @xmath41 directly from the array of delta functions that was used to construct the model image . in either case",
    "we create an array of size equal to the image and place delta functions in this array at the locations of the sources with heights equal to the fluxes .",
    "we radially binned and averaged the resultant 2-d power spectrum to obtain @xmath41 . in order to leave the overall measured power unchanged",
    ", we normalize @xmath41 to have a median value of 1 .",
    "@xmath41 is then an indication of how much @xmath76 deviates from being a multiplicative constant . finally , we also perform fits ignoring the correction for the source distribution power spectrum by setting @xmath87 .",
    "figure  [ fake_data_model ] shows the best fit to the power spectrum for image figure  [ fakeims](b ) ( @xmath88 , @xmath75  cm ) , after two starfinder iterations .",
    "the final fitted mtfs are then used to compute the psfs and encircled energy using eq .",
    "[ ttopsf ] and  [ ttoee ] .",
    "some comparisons of the input and recovered ee curves are shown in figure  [ meas_fitted_ee ] .",
    "in general , the fits are insensitive to the model parameters for @xmath89 150  cm . for @xmath90 2  m ,",
    "the mtf becomes barely distinguishable from the perfect mtf . in this regime",
    "it becomes impossible to contrain any of the parameters .",
    "it is not surprising , therefore , that the fitted parameters for @xmath5 = 100  cm are less accurate than those for @xmath5 = 50  cm and 65  cm .",
    "this degradation in accuracy applies to the fitted parameters for all of the images , as reflected in their calculated formal errors , regardless of the number of stars in the field .",
    "however , in the case of high @xmath5 , the encircled energy and psf are less dependent on the model parameters , so the quantities of interest are left mostly unaffected .    for images containing 500 stars or fewer ,",
    "the recovered photometric growth curves deviate from the true values by less than 2% .",
    "the fits for the images containing five and fifty stars generally returned the input parameters to within the calculated error .",
    "the recovered encircled energy curves for these fits matched the input well , with the maximum deviations from the known growth curves less than 1.5% .",
    "the accuracy was much better than this for @xmath91 and @xmath92 . estimating the source distribution power spectrum and accounting for it in the model improved the fits and was robust . using simple daophot aperture photometry routine for this purpose was sufficient , as the separation between the stars was large .",
    "signal to noise ratio plays a significant role in the accuracy of the fits .",
    "the five star images yielded less accurate fit parameters than the fifty star images . since we did not hold the total flux constant when constructing images with different numbers of stars , we created additional five star images scaled to match the total signal in the fifty star images . performing the fits on these new images yielded more accurate results , in line with those obtained from the fifty star images .",
    "it is more difficult to estimate the source distribution power spectrum for the images with more than fifty stars because of increased crowding .",
    "nonetheless , fitting the 500 star images returned parameters that were close to the input values when we used the iterative method to refine the estimate of the source distribution function .",
    "the resulting photometric growth curves , though less accurate than those for five and fifty stars , do not deviate from the known ones by more than 2% .",
    "using the known source distribution function for these synthentic data yields improved fit parameters , confirming that with this many stars uncertainty in @xmath41 is the dominant source of error .",
    "for the images containing @xmath93 5000 stars , the accuracy of the returned parameters drops again . nonetheless , the best - fit photometric curves of growth differ from the true ones by usually less than 5% . when a field contains so many stars that every beam contains multiple stars , estimating the spatial distribution power spectrum becomes impossible .",
    "in this case , we hope that the assumption of a random distribution of point sources leading to a simplification of @xmath76 as a constant becomes increasingly valid . for the images containing 5000 stars ( @xmath94 0.4 stars per @xmath95 beam ) ,",
    "the best fit parameters deviate significantly from the input parameters .",
    "the field is sufficiently crowded that errors in @xmath41 are large , but not so crowded that @xmath76 may be approximated as a constant .",
    "the deviations in the fitted encircled energy from the true encircled energy are as great as 5% .",
    "these same problems apply to the images with 50,000 stars ( @xmath94 4 stars per beam ) , but to a greater extent . in this regime ,",
    "the fits almost completely fail to return the input parameters . accurately estimating the source distribution here is almost impossible .",
    "the fits performed while considering @xmath76 as a constant do not produce better results , indicating that the field is not random enough to allow this assumption .",
    "the 5 @xmath71 10@xmath72 image ( @xmath94 400 stars per beam ) defies any attempt to estimate the source distribution function .",
    "however , in this limiting case , the field is so crowded that neglecting to account for @xmath96 does not cause the fits to fail .",
    "the fits , though not as accurate as those for the images with 5500 stars , yield encircled energies no more than 6% different from the true curves .",
    "though poor sky subtraction degrades the accuracy of the fits , the effect can be mitigated by filtering out the low spatial frequency bins .",
    "we estimated the background directly from the model images and sky subtracted before finding the power spectrum .",
    "since the sky subtraction will never be perfect and is , for the images with more than 500 stars , significantly inaccurate , the power spectrum is contaminated . however ,",
    "if we assume that the background does not contain much power beyond the lowest few frequency bins , we can exclude these bins from our fits .",
    "( the first two frequency bins in figure  [ fake_data_model ] demonstrate the effect of imperfect sky subtraction . ) for the 5 , 50 , and 500 star images we ignored the first two frequency bins ( @xmath97 ) , which yielded more accurate results than using all data points .",
    "for the 5000 star image , we repeated the fits , filtering out the first three bins .",
    "this resulted in best - fit parameters somewhat closer to the inputs , but did not significantly improve the accuracy of the best fit ee curve .",
    "in general , it appears that the benefits of increased signal to nosie in the images with large numbers of stars , as well as the benefits of the increased validity of the assumption of randomness in the source function , are outweighed by the increased ability to sky subtract and to estimate the source function in images with less crowding .",
    "( assuming , of course , that there is enough signal to be able to use fewer stars . ) for instance , the measured power spectra for the @xmath98 images are noisier than for those with 5 , 50 , and 500 stars , and the fitted parameters are consequently less accurate , even though the assumption of a random spatial distribution holds better for these images than for those with less stars and the signal to noise is much higher .",
    "while our most crowded images ( @xmath98 ) yielded fits less accurate than our least crowded images ( @xmath99 ) , they still led to best - fit curves of growth that were accurate to @xmath100 6% .",
    "there appears to be a regime , however , in which the field is not crowded enough to allow for the approximation of @xmath76 as a constant , but too crowded to allow for an accurate estimation of it .",
    "our example of this is the failed fits for images containing 50,000 stars . in this case",
    ", we were unable to find a satisfactory way to improve the fits .",
    "the nearby dwarf starburst galaxy ngc 1569 ( @xmath101 = @xmath102104  km",
    "s@xmath65 ) was observed with the keck lgs / ao and the nirc2 camera on 2005 march 02 .",
    "the field is centered on the superstar cluster ssc a1/a2 @xcite .",
    "the nirc2 pupil stop was in the largehex position ( circumscribed circle ) and the camera was operating in the narrow field mode ( @xmath103 per pixel ) .",
    "observing conditions were photometric , and the seeing was @xmath104 at @xmath105 . the @xmath106  mag .",
    "equivalent laser guide star was projected at the center of the science camera field of view and ssc a1/a2 was used as the tip - tilt reference .",
    "the science field was observed at an airmass of 1.5 with the ao system running at 450 hz .",
    "we use a 60-second @xmath105-band exposure from this observation to illustrate the application of our psf estimation method .",
    "additional observations with 120-s exposures were also obtained yielding a mosaic with a total exposure time of 15 minutes .",
    "flat - fields were taken at the zenith near midnight and median filtered to remove starlight .",
    "bad pixels in the single 60-s image were repaired by substituting them with an interpolation of the surrounding pixels . as the crowding in the field is relatively low and displays little variation across the field",
    ", conventional sky subtraction was applied using the idl implementation of the daophot routine mmm .",
    "figure  [ realimage ] shows the entire nirc2 field of view .",
    "the image is dominated by the resolved cluster but also includes several hundred unresolved stellar sources .",
    "the cluster light includes extended nebular emission and is therefore not suitable for measuring the mtf .",
    "our goal is to estimate the psf for the regions containing stars .",
    "therefore , we define two subarrays within fig .",
    "[ realimage ] that avoid ssc a and contain approximately 190 and 20 point sources , respectively .",
    "( preliminary photometry indicates that the point sources in the image have absolute @xmath105-band magnitudes consistent with single red supergiant stars . )",
    "anisoplanatism is evident in fig .",
    "[ realimage ] .",
    "we have chosen regions small enough ( @xmath107 @xmath108 and @xmath107 @xmath109 ) so that this effect should be negligible .",
    "for comparison , we also compute the power spectrum for the entire image after masking out the central cluster and two other bright , unresolved objects .",
    "the best - fit power spectrum and encircled energy for the entire image are shown in figures  [ realmtf_a ] and [ realmtf_b ] .",
    "the best - fit parameters are listed in table  [ bestparams_real ] along with those for the fits using the two subarrays . we again hold @xmath55 at a constant 56  cm .",
    "all parameters represent the best - fit after two iterations of using starfinder to estimate the source distribution power spectrum .",
    "we also state the formal errors in the parameters as computed from the covariance matrix . to account for any imperfect sky subtraction",
    ", we do not fit data at @xmath97 .",
    "thus we filter our spectra below the first 1 , 2 , and 5 frequency bins in the small and large subarrays , and in the entire image , respectively .    in   [ fakefitting ]",
    "our model psfs were circularly symmetric and based solely on our model mtf .",
    "all we verified there was the ability to successfully _ extract _ the mtf from data . since real psfs will contain asymmetries and since our model will not describe _ all _ of the factors contributing to an actual mtf ( i.e. , deviations from kolmogorov turbulence , directional dependence in @xmath110 , systematic errors in the wavefront sensor ) we can not expect our real fits to be as accurate as our fake fits .",
    "nevertheless , figure  [ realmtf_a ] shows excellent agreement between measured and best - fit model power spectra  we have evidently included enough detail in our model to capture the essence of the keck ao system . based on the analysis of our synthetic data ,",
    "the recovered values put us in the regime where the fits show good sensitivty to @xmath5 and @xmath69 .",
    "additionally , the three sets of fit parameters mostly agree to within the formal errors .",
    "the values of @xmath62 show some discrepancy , but in this region of model parameter space the mtf and ee show no signficant variation when @xmath62 changes by as much as 10% .",
    "the recovered ee curve is most sensitive to changes in @xmath5 , which stays within error over the three fits .",
    "the density of stars in our image is low enough to enable accurate sky subtraction and estimation of the source distribution function .",
    "all of these factors give us confidence in our derived parameters .",
    "the formal errors decrease significantly as the size of the subarray we use to measure a power spectrum grows . for one ,",
    "the signal to noise ratio of the power spectrum increases when there are more stars . also , larger images give finer sampling of the power spectrum .",
    "for these reasons , and since the best - fit power spectrum for the whole 60-s image is a good quantitative match with the measured one and does not differ significantly from either two subarrays , we choose the entire image best - fit mtf to compute a psf and ee curve .",
    "we use the best - fit parameters to generate an mtf and compute the corresponding psf using eq .",
    "( [ ttopsf ] ) .",
    "the recovered psf is shown in figure  [ fittedpsf ] .",
    "this psf exhibits the same core - halo structure that is evident in the data .",
    "we performed psf fitting and subtraction for a number of bright sources in the image .",
    "a few of the original stars and the residuals after psf subtraction are shown in figure  [ resids ] .",
    "the residuals contain approximately @xmath111 of the original starlight , a failing that can probably be attributed to our initial assumptions about the symmetry of the psf .",
    "indeed , most of the residuals exhibit asymmetric structure .",
    "this indicates that the actual psf s deviation from circular symmetry , something for which our model is unable to account , is responsible for much of the residual starlight .",
    ".best fit parameters for the two sub - arrays indicated in figure  [ realimage ] and for the entire image .",
    "[ bestparams_real ] [ cols=\"^,^,^,^\",options=\"header \" , ]      in this section we investigate the accuracy of photometry extracted from lgs / ao observations by comparing the results with data obtained using hubble space telescope / nicmos .",
    "the psf for hst instruments is well characterized ( e.g. , * ? ? ?",
    "* ) hence the aperture corrections are known and hst data provide a good standard against which ground - based ao measurements can be compared .",
    "ideally , we would perform the lgs / ao photometry in two steps .",
    "first , perform relative photometry using psf fitting with an empirical 2-d psf , which is built from stars judged to be isolated .",
    "second , use our 1-d psf to compute the aperture corrections and place the relative photometry on an absolute scale . since we are interested in the accuracy attainable with our method we have chosen to perform psf fitting photometry with the model 1-d psf obtained as described in   [ realfitting ] . while crowding will limit the precision of this approach , there is no ambiguity in how to calculate the aperture correction .",
    "when applied to an ensemble of stars this one - step method should give a reliable way of evaluating the accuracy of the resultant photometry .",
    "we measure @xmath105-band magnitudes for approximately 250 bright point sources in the field of a single 60-s exposure of ngc 1569 ssc a ( @xmath5 = 56  cm ; strehl = 10.1% ; see   [ realfitting ] ) .",
    "we used five images of the near - infrared standard star sj  9139 @xcite obtained on the same night as the science data to measure the photometric zero point .",
    "hst data were obtained with the nic2 camera in the f160w filter on 1998 february 25 . the keck image and the matching nicmos sub - image",
    "are shown side - by - side in figure  [ keck_hst_ims ] .",
    "photometry for the hst / nicmos images has been extracted by @xcite .",
    "comparison of the photometry obtained from our lgs / ao data begins with matching the catalogs of keck and hst / nicmos sources .",
    "inspection of figure  [ keck_hst_ims ] shows that keck frequently resolves stars that appear as single sources to hst / nicmos .",
    "although we are able to identify more stars in the keck image than presented here , we have selected only those stars that are separated from neighbors by more than @xmath112 in both catalogs .",
    "the central wavelengths of the nicmos f160w filter ( 1.60  @xmath63 m ) and the nirc2 @xmath105-band filter ( 1.63  @xmath63 m ) are similar . however , the filter bandpasses differ significantly , and for these red stars a color correction is necessary to compare space and ground - based measurements .",
    "we correct the hst f160w magnitudes to the keck system based on their f160w - f110w colors , using the method outlined in the appendix of @xcite .",
    "a plot of keck vs. color - corrected hst magnitudes for isolated stars ( figure  [ keck_hst_photom ] ) shows that the mean photometric discrepancy between the two data sets amounts to only a few percent . in this figure",
    "the data points fall along a straight line of unit slope and intercept zero . the mean keck magnitude minus the hst magnitude , @xmath113 , is @xmath114 = 0.05  mag . , and standard deviation is @xmath115 = 0.21  mag .",
    "the standard error of @xmath113 is 0.013 mag .",
    "the agreement between the keck and hst photometry at the 5% level is encouraging , and provides significant validation for our method of finding ao aperture corrections .",
    "however , the roughly 20% scatter for individual measurements , which is several times larger than that expected from source , sky and detector noise , merits some additional comment .    one possible source of scatter is anisoplanatism in the ao images .",
    "a systematic change in the psf and across the field of view would result in seemingly random errors distributed among stars of all magnitudes in figure  [ keck_hst_photom ] .",
    "however , a plot of @xmath113 vs. field angle ( figure  [ anisotropy ] ) shows only a weak trend , and indicates that variation of the ao psf across the keck field of view only contributes a fraction ( @xmath94 10% ) of the 0.21 mag . scatter .",
    "we investigate our internal errors by comparing two independent sets of lgs / ao observations of the field of ncg 1569 ssca .",
    "for the first image we use the same 60-s exposure as above and a 120-s exposure for the second ( @xmath5 = 42  cm ; strehl = 3.7% .",
    "each image has a different psf and a sky background level .",
    "comparing the photometry done from the 60s and 120s exposures gives @xmath116  mag . and @xmath117  mag .",
    "thus , our measurement errors account for only about 20% of the variance between the keck and hst .",
    "likely , the major source of the observed scatter is the natural variability of red supergiants ( rsgs ) , the main stellar component present in this field .",
    "visual inspection of the nirc2 and nicmos images reveal several stars that have brightened or dimmed betweeen 1998 and 2005 . the most variable star , with @xmath118 ,",
    "is indicated by the triangle in figure  [ keck_hst_photom ] and the arrow in figure  [ keck_hst_ims ] . the magnitudes and f160w - f110w colors ( @xmath119 ) of our sample",
    "indicate they are mostly rsgs with masses @xmath120 @xcite .",
    "the most massive few stars are probably between @xmath121 and @xmath122 .",
    "the stars in our sample are unstable and can fluctuate significantly in luminosity .",
    "@xcite has studied this variability in a sample of 2420 rsgs .",
    "the results indicate that stars of these masses and spectral types have average peak - to - trough @xmath123-band amplitudes between 0.1 for @xmath124 stars and 0.4 - 0.8 for @xmath122 stars .",
    "although the amplitude of variation is likely to be less at infrared wavelengths , these findings suggest that we can attribute most of the observed variance to the stars themselves .    since the 120-s exposure exhibited poorer image quality",
    ", it affords the opportunity to examine the photometric integrity for reduced ao correction .",
    "the same photometric keck - hst comparison for these data give @xmath125 mag . and @xmath126  mag .",
    ", confirming that accurate results can be extracted at low strehl ratios .",
    "we have developed a simple model to describe the imaging performance of an ao system .",
    "the model makes assumptions about the shape of the power spectrum of atmospheric phase errors , the pupil geometry , and the dm influence function and has a few adjustable parameters , including the fried parameter ( @xmath5 ) , the degree of ao correction ( @xmath69 ) , and the wavefront measurement noise ( @xmath127 ) . beyond the inherent value of a well defined framework to quantify an observed phenomenon , this method has several advantages in the practical analysis of ao data .",
    "generating numerical mtfs is a cheap and easy way to predict system performance under a variety of conditions , i.e. , seeing , pupil obscuration , dm actuator spacing , & c.    by considering the fourier information present in astronomical images we have shown that it is practical to fit model mtfs to image power spectra , constrain the model parameters and recover the psf , encircled energy and strehl ratio .",
    "high fidelity simulations of ao performance can be performed using computationally intensive monte carlo codes ( e.g. , * ? ? ?",
    "however , we believe that we have shown that it is unnecessary to employ these elaborate methods to compare with observations to estimate photometric curve of growth corrections .    using the method outlined here , the azimuthally averaged psf and hence the photometric curve of growth can be estimated directly from an image containing multiple point sources .",
    "data obtained in varying observing conditions and with changing ao correction can be analyzed so that they are not subject to systematic photometric errors , and separate and potentially unreliable psf star observations are not required .",
    "our method allows one to estimate the psf , even if there are no isolated stars in the image .",
    "although only the azimuthally averaged psf is derived , the fact that the residuals in figure  [ resids ] show mainly azimuthal components means that the curve of growth is valid .",
    "a comparison of keck lgs / ao and hst / nicmos observations of the same field at 1.6  @xmath63 m in ncg  1569 shows that our photometric method is accurate to 5% or better .",
    "the precision of our 1-d psf fitting photometry ( about 10% ) is not limited by photon statistics and detector noise .",
    "we are investigating a hybrid approach which involves conventional 2-d psf fitting photometry using an empirical kernel followed by application of aperture corrections derived from mtf fitting .    treating the otf as a one - dimensional mtf is an approximation .",
    "the wavefront delivered by an ao system often suffers from systematic calibration errors which lead to significant psf azimuthal asymmetry .",
    "non - circular pupils and anisotropic atmospheric turbulence , e.g. , due to a prevailing wind , are the rule rather than the exception .",
    "while odd - order aberrations , e.g. , coma , can not be reconstructed from the power spectrum , even aberrations like astigmatism can be described .",
    "a natural extension to the work presented here is to fit a 2-d otf to the 2-d power spectrum to capture this information",
    ". it will be particularly interesting to investigate the ability of this method to describe the astigmatism introduced by angular anisoplanatism by mapping out the variation of model parameters as a function of field angle .",
    "we thank melissa enoch for her contributions to developing an early version of this algorithm that served as a reference point from which to explore the topic further .",
    "we are also grateful to alessandra aloisi for her assistance in verifying the accuracy of our method by making available to us the hst photometry of ngc  1569 .",
    "this work has been supported by the national science foundation science through ast 0205999 and the center for adaptive optics , managed by the university of california at santa cruz under cooperative agreement no .",
    "ast 9876783 .",
    "keck observatory is operated as a scientific partnership among the california institute of technology , the university of california , and the national aeronautics and space administration .",
    "the observatory was made possible by the generous financial support of the w.m .",
    "keck foundation .",
    "in addition , the authors wish to recognize and acknowledge the very significant cultural role and reverence that the summit of mauna kea has always had within the indigenous hawaiian community .",
    "we are most fortunate to have the opportunity to conduct observations from this mountain .",
    "the optical transfer function ( otf ) specifies the amplitude and phase response of a linear optical imaging system to a stimulus at a given spatial frequency . in general",
    "the otf is complex .",
    "here we consider the special case of a circularly symmetric psf , in which case the complex otf reduces to the real modulation transfer function ( mtf ) .",
    "following @xcite , the mtf , @xmath128 , is a measure of the contrast at spatial frequency @xmath7 in the image , relative to the object .",
    "we expect @xmath129 as @xmath130 . for a pupil with finite support , above some critical spatial frequency , @xmath131 , @xmath132 and all information at frequencies greater than @xmath131",
    "is lost .    in the image plane , the cutoff spatial frequency of a telescope with a circular pupil , diameter , @xmath4 , and observing wavelength , @xmath3 , is @xmath133 this corresponds to a linear image size of @xmath134 , where @xmath135 is the effective focal length at the image plane and @xmath136 is the focal ratio .",
    "it is convenient to use spatial frequencies in units of the cutoff frequency in the image plane , or normalized spatial frequencies , @xmath137 .",
    "the variation in phase of a wavefront , @xmath138 , between two points in the pupil plane of a telescope separated by a distance @xmath139 can be described by the structure function @xmath140 ^ 2 \\rangle,\\ ] ] where @xmath141 denotes a time average .",
    "we reserve lower case , e.g. , @xmath138 , to refer to quantities in the spatial domain , and upper case , e.g. , @xmath142 , for the fourier transformed quantity in the frequency domain .",
    "we use @xmath143 and @xmath144 to refer to spatial coordinates and spatial frequencies in the image plane and @xmath8 and @xmath145 to refer to spatial coordinates and spatial frequencies in the pupil plane .",
    "thus , the relation between position in the pupil plane and spatial frequency in the image plane is @xmath146 .",
    "the structure function can be written in terms of the covariance function , which in turn forms a fourier pair with the two - dimensional phase - error power spectrum , @xmath147 , where @xmath148 is spatial frequency in the pupil plane .",
    "the notation @xmath21 denotes the atmospheric phase error power spectrum , which is shorthand for the expectation value @xmath149 , where @xmath150 denotes the complex conjugate .",
    "consequently , the structure function and the power spectrum are related by the transform @xmath151 d       \\mbox{\\boldmath $ \\kappa$},\\ ] ] where the integral is taken over the infinite domain . in the case of an isotropic power spectrum integration over the angular part yields @xmath152 \\nonumber \\\\              & = &   4 \\pi \\int_{0}^{\\infty }                     |\\phi(\\kappa)|^2                  [ 1-j_0(2\\pi\\;\\kappa r)]\\kappa \\ ; d \\kappa , \\end{aligned}\\ ] ] where @xmath16 @xcite , and @xmath153 is the bessel function of the first kind . note that this transform , as quoted by ( * ? ? ?",
    "* eq . 4.46 ) , contains a typographical error .      where @xmath155 is the separation between two points in the pupil plane and @xmath5 is a scale length known as the fried parameter @xcite .",
    "the phase structure function evaluated at @xmath156 yields the atmospheric mtf structure function @xmath157\\ ] ] @xcite .      in the case of a unaberrated , unobscured , circular pupil",
    ", the otf reduces to the real , circularly symmetric mtf , @xmath158 .",
    "\\label{pupmtf}\\ ] ] in the more general case of a pupil function with central obscuration , secondary spiders and segment gaps , the mtf can be computed numerically from the autocorrelation of the pupil function .",
    "the mtf of a ideal pixel of dimensions @xmath159 can be derived by considering it as a uniformly illuminated square aperture .",
    "the mtf is then given by the fourier transform of this function , which in normalized frequencies is @xmath160 where @xmath161 is the number of pixels per length @xmath162 .",
    "for nyquist sampling , two pixels per @xmath163 , @xmath164 .",
    "for the narrow field camera in keck / nirc2 @xmath165 at @xmath105 band .",
    "the final step involves finding the psf , @xmath166 , and the encircled energy , @xmath167 , from the hankel transforms of the system mtf @xmath168 .",
    "the hankel transform of zero order yields the psf , @xmath169 where @xmath170 is the normalized distance in the image plane , and the hankel transform of first order yields the the encircled energy @xmath171 where @xmath153 and @xmath172 are the bessel functions of the first and second kind , respectively .",
    "the strehl ratio is defined as @xmath173 , where @xmath174 denotes the psf for the unaberrated system .",
    "thus , using eq .",
    "( [ ttopsf ] ) @xmath175"
  ],
  "abstract_text": [
    "<S> the point - spread function ( psf ) of an adaptive optics ( ao ) system is often poorly known . </S>",
    "<S> this ignorance can lead to significant systematic errors . since the degree of ao correction is sensitive to the observing conditions : seeing , wind speed , brightness of the wavefront reference , etc . </S>",
    "<S> , it would be desirable to estimate the psf from the data themselves rather than from observations of a psf star at another time . </S>",
    "<S> we have developed a method to estimate the psf delivered by an ao system in the case where the scene consists of a crowded star field . </S>",
    "<S> we model the modulation transfer function ( mtf ) of several key components of the imaging system ( atmosphere filtered by an ao system , telescope pupil , and pixel array ) . </S>",
    "<S> the power spectrum of the image , even a dense star field , can be used to constrain our model , which in turn can be used to reconstruct the psf . in the case of circularly symmetric psfs , </S>",
    "<S> we demonstrate that the power spectrum of the source distribution function can be successfully removed from the measured mtf and that our fit successfully recovers input parameters from a model data - set constructed from these parameters . </S>",
    "<S> we also show that the method yields reasonable fit parameters and a useful approximation to the psf when applied to data from the laser guide star ( lgs ) ao system at the keck observatory . </S>",
    "<S> comparison of keck lgs / ao data and hubble space telescope observations with nicmos show that photometric accuracy of a few percent can be achieved for data with strehl ratios as low as 4% . </S>"
  ]
}