{
  "article_text": [
    "let @xmath2 be an infinite sequence over a finite alphabet @xmath3 .",
    "we write @xmath4 = a(i)$ ] , and we let @xmath5 $ ] denote the factor of length @xmath1 beginning at position @xmath6 .    an infinite sequence @xmath7 is said to be _",
    "@xmath0-automatic _ if it is computable by a finite automaton taking as input the base-@xmath0 representation of @xmath1 , and having @xmath8 as the output associated with the last state encountered .",
    "for example , in figure  [ fig1 ] , we see an automaton generating the thue - morse sequence @xmath9 . the input is @xmath1 , expressed in base @xmath10 , and the output is the number contained in the state last reached .",
    "# 1#21.0#1    [ fig1 ]    honkala @xcite showed that , given an automaton , it is decidable if the sequence it generates is ultimately periodic . later , leroux @xcite gave a polynomial - time algorithm for the problem .",
    "recently , allouche , rampersad , and shallit found a different proof of honkala s result using a more general technique .",
    "they showed that their technique suffices to show that the following properties ( and many more ) are decidable for @xmath0-automatic sequences @xmath7 :    * given a rational number @xmath11 , whether @xmath7 is @xmath12-power - free ; * given a rational number @xmath11 , whether @xmath7 contains infinitely many occurrences of @xmath12-powers ; * given a rational number @xmath11 , whether @xmath7 contains infinitely many distinct @xmath12-powers ; * given a length @xmath13 , whether @xmath7 avoids palindromes of length @xmath14 .",
    "related results have recently been given by halava , harju , krki , and rigo .    in this paper we show that many additional properties of automatic sequences are decidable using the same general technique .",
    "more significantly , we also show that related enumeration questions on automatic sequences ( such as counting the number of distinct factors of length @xmath1 ) can be solved using a similar technique , in an entirely effective manner . as a consequence ,",
    "we recover or improve results due to moss @xcite ; allouche , baake , cassaigne , and damanik ; currie and saari ; garel @xcite ; fagnot @xcite ; and brown , rampersad , shallit , and vasiga .",
    "our main results about decidability are given in section  [ logicsec ] , and our main results about enumeration are given in section  [ applications ] .    throughout this paper",
    ", @xmath0 denotes a fixed integer @xmath15 , the symbol @xmath16 denotes the non - negative integers @xmath17 , and the symbol @xmath18 denotes the `` extended '' non - negative integers @xmath19 .",
    "after the publication of , the third author noticed that the technique used there was , at its core , very similar to previous techniques developed by bchi , bruyre , michaux , villemaire , and others , involving formal logic ; see , e.g. , .",
    "this was later independently observed by the first author , as well as by vronique bruyre .",
    "as it turns out , the properties ( a)(d ) above are decidable because they are expressible as predicates in the first - order structure @xmath20 , where @xmath21 is the largest power of @xmath0 dividing @xmath1 .",
    "we briefly recall the technique discussed in in the context of a particular example .",
    "suppose we want to decide if an automatic sequence @xmath7 is squarefree ( contains no nonempty square factor ) .",
    "given an automaton @xmath22 generating a @xmath0-automatic sequence @xmath7 , we create , via a series of transformations , a new automaton @xmath23 that accepts the base-@xmath0 representations of integers corresponding to the squares in @xmath7 .",
    "for example , @xmath23 could accept those integers corresponding to the starting position of each square , or those integers corresponding to the lengths of the squares .",
    "the operations we can use in constructing @xmath23 include digit - by - digit addition or subtraction ( with carry , if necessary ) , comparison , and lookup of the corresponding term in @xmath7 ( which comes from simulation of @xmath22 ) .",
    "nondeterminism can be used to implement `` @xmath24 '' , and `` @xmath25 '' can be implemented by nondeterminism combined with suitable negations .    ultimately , then , deciding if @xmath7 is squarefree corresponds to verifying that @xmath26 for the @xmath23 we construct . deciding whether @xmath7 contains",
    "only finitely many square occurrences corresponds to verifying that @xmath27 is finite .",
    "both can easily be done by the standard methods for automata , using depth - first or breadth - first search on the underlying state diagram of the automaton .    in this paper",
    ", we always assume that numbers are encoded in base @xmath0 using the digits in @xmath28 , the _ canonical encoding _ of @xmath1 is the one with no leading zeroes and is denoted @xmath29 .",
    "similarly , if @xmath30 , then by @xmath31_k$ ] we mean @xmath32 , the integer that @xmath33 represents . often we will deal with reversed representations , where the least significant digit appears first .",
    "for example , in the reversed representation , @xmath34 is represented in base @xmath10 by the word @xmath35 .",
    "sometimes we will need to encode pairs , triples , or @xmath12-tuples of integers .",
    "we handle these by first padding the reversed representation of the smaller integer with trailing zeroes , and then coding the @xmath12-tuple as a word over @xmath36 .",
    "for example , the pair @xmath37 could be represented in base-@xmath10 as @xmath38[0,0][1,1][0,1][1,0 ] , \\ ] ] where the first components spell out @xmath39 and the second components spell out @xmath40 .",
    "of course , there are other possible representations , such as @xmath38[0,0][1,1][0,1][1,0][0,0],\\ ] ] which correspond to non - canonical representations having trailing zeroes . in general",
    ", we permit these .",
    "thus , the main idea of can be restated as follows :    if we can express a property of a @xmath0-automatic sequence @xmath7 using quantifiers , logical operations , integer variables , the operations of addition , subtraction , indexing into @xmath7 , and comparison of integers or elements of @xmath7 , then this property is decidable .",
    "[ logic ]    we illustrate the idea with the following new result .",
    "a word @xmath33 is _ bordered _ if it begins and ends with the same word @xmath41 with @xmath42 .",
    "( an example in english is ingoing , which begins and ends with ing . )",
    "otherwise it is _",
    "unbordered_.    let @xmath43 be a @xmath0-automatic sequence .",
    "then the associated infinite sequence @xmath44 defined by @xmath45 is @xmath0-automatic .",
    "the sequence @xmath7 has an unbordered factor of length @xmath1    iff    @xmath46 such that the factor of length @xmath1 beginning at position @xmath47 of @xmath7 is unbordered    iff    there exists an integer @xmath48 such that for all possible lengths @xmath13 with @xmath49 , there is an integer @xmath6 with @xmath50 such that the @xmath6th letter in the supposed border of length @xmath13 beginning and ending the factor of length @xmath1 beginning at position @xmath47 of @xmath7 actually differs in the @xmath6th position    iff    there exists an integer @xmath48 such that for all integers @xmath13 with @xmath49 there exists an integer @xmath6 with @xmath50 such that @xmath51 .    to carry out this test",
    ", we first create an nfa that given the encoding of @xmath52 guesses the base-@xmath0 representation of @xmath6 , digit - by - digit , checks that @xmath53 , computes @xmath54 and @xmath55 on the fly , and checks that @xmath51 .",
    "if such an @xmath6 is found , it accepts .",
    "we then convert this to a dfa , and interchange accepting and nonaccepting states .",
    "this dfa @xmath56 accepts @xmath52 such that there is no @xmath6 , @xmath50 such that @xmath57 .",
    "we then use @xmath56 as a subroutine to build an nfa @xmath58 that on input @xmath59 guesses @xmath13 , checks that @xmath49 , and calls @xmath56 on the result .",
    "we convert this to a dfa and interchange accepting and nonaccepting states to get @xmath60 .",
    "finally , this @xmath60 is used as a subroutine to build an nfa @xmath61 that on input @xmath1 guesses @xmath47 and calls @xmath60 .",
    "the set of such integers @xmath1 then forms a @xmath0-automatic sequence .",
    "consider the problem of determining for which lengths the thue - morse sequence has an unbordered factor .",
    "currie and saari proved that if @xmath62 , then there is an unbordered factor of length @xmath1 .",
    "( also see @xcite , lemma 4.10 and problem 4.1 . )",
    "however , this is not a necessary condition , as @xmath63 =   { \\tt 0011010010110100110010110100101},\\ ] ] which is an unbordered factor of length @xmath64 .",
    "they left it as an open problem to give a complete characterization of the lengths for which @xmath65 has an unbordered factor .",
    "our method shows the characteristic sequence of such lengths is @xmath10-automatic .",
    "further , we conjecture that there is an unbordered factor of length @xmath1 in @xmath65 if and only if the base-@xmath10 expansion of @xmath1 ( starting with the most significant digit ) is not of the form @xmath66 .    in principle",
    "this could be verified , purely mechanically , by our method , but we have not yet done so .",
    "we now turn to deciding if a given automatic sequence @xmath7 has infinite critical exponent ( e.g. ,  ) .",
    "if a word @xmath33 can be written in the form @xmath67 , where @xmath68 is an integer and @xmath69 is a prefix of @xmath41 , then we say it is a fractional power with _ exponent _ @xmath70 . for example , @xmath71 has exponent @xmath72 .",
    "the largest such exponent is called _ the _ exponent of the word",
    ". the _ critical exponent _ of @xmath7 is the supremum , over all finite factors @xmath73 of @xmath7 , of the exponent of @xmath73 .",
    "the following question is decidable : given a @xmath0-automatic sequence , does it contain powers of arbitrarily large exponent ?    @xmath7 has powers of arbitrarily high exponent    iff    the set of pairs @xmath74 = { \\bf x}[i+j+t]$ } \\rbrace\\ ] ] contains pairs @xmath75 with @xmath76 arbitrarily large    iff    for all @xmath77 @xmath78 contains a pair @xmath75 with @xmath79    iff    @xmath80 , the set of base-@xmath0 encodings of pairs in @xmath78 , contains , for each @xmath6 , words ending in @xmath81[*,0]\\cdots [ * , 0]}^i [ b,0]\\ ] ] for some @xmath82 , where @xmath83 means any digit .",
    "but we can easily decide if a regular language contains words ending in arbitrarily long words of this form .    in a similar fashion",
    "we can show    the following question is decidable : given a @xmath0-automatic sequence @xmath7 , does @xmath7 contain arbitrarily large unbordered factors ?",
    "now we turn to questions of recurrence .",
    "an infinite word @xmath84 is said to be _ recurrent _ if every factor that occurs at least once in @xmath85 occurs infinitely often .",
    "equivalently , a word is recurrent if and only if for each occurrence of a factor of @xmath85 , there exists a later occurrence of that factor in @xmath85 .",
    "equivalently , for every @xmath86 , @xmath87 , there exists @xmath88 such that @xmath89 for @xmath90 .",
    "similarly , an infinite word @xmath84 is said to be _ uniformly recurrent _ if every factor that occurs at least once in @xmath85 occurs infinitely often , with bounded gaps between consecutive occurrences .",
    "equivalently , a word @xmath84 is uniformly recurrent iff for every @xmath87 there exists @xmath91 such that for every @xmath86 there exists @xmath92 with @xmath93 such that @xmath94 for @xmath95 .",
    "thus we recover the following recent result of nicolas and pritykin :    it is decidable if a @xmath0-automatic sequence is recurrent or uniformly recurrent .",
    "we now turn to questions of factors shared by two @xmath0-automatic sequences .",
    "fagnot @xcite showed that it is decidable whether two such sequences @xmath96 and @xmath97 have exactly the same set of factors .",
    "this is also decidable by our methods , as follows :    the sequences @xmath96 and and @xmath97 have the same set of factors    iff    for all @xmath98 there exists @xmath48 such that @xmath5 = { \\bf y}[j .. j+n-1]$ ]    iff    for all @xmath99 there exists @xmath48 such that for all @xmath100 we have @xmath101 .    in a similar fashion , the question of whether the set of factors of one @xmath0-automatic word form a subset of the set of factors of another @xmath0-automatic word is decidable .",
    "we now turn to questions of enumeration .",
    "a typical example of the kind of question we are interested in is , given an automatic sequence @xmath102 , how many distinct factors are there of length @xmath1 ?",
    "our goal in the remainder of this paper is to show that these kinds of questions often have a useful answer in terms of _",
    "@xmath0-regular sequences_. a sequence @xmath102 is _",
    "@xmath0-regular _ if the module generated by its @xmath0-kernel , which is the set of all subsequences of the form @xmath103 is finitely generated .",
    "the @xmath0-regular sequences play the same role for integer - valued sequences as the @xmath0-automatic sequences play for sequences over a finite alphabet .",
    "classical examples of @xmath0-regular sequences include polynomials in @xmath1 , and @xmath104 , the sum of the base-@xmath0 digits of @xmath1",
    ".    not only does this interpretation give an explicit and efficient algorithm for computing the values of the sequence in question , it also gives a way to compute many related quantities that , up to now , have received extended treatments in the literature using a wide variety of techniques .",
    "our work therefore extends and unifies many results in the literature .",
    "in order to make our results really precise , we need several sections of preliminary definitions and results .",
    "this is what follows in sections  [ a1][b1 ] .",
    "we resume the exposition of our results in section  [ applications ] .",
    "cobham @xcite showed that a sequence @xmath105 is @xmath0-automatic iff its _",
    "@xmath0-kernel _ is finite .",
    "generalizing this notion , allouche and shallit introduced the notion of @xmath0-regular sequence over a ring @xmath106 .",
    "a sequence is _",
    "@xmath0-regular _ if the module generated by its @xmath0-kernel is finitely generated .",
    "in particular , allouche and shallit were interested in the cases of where the underlying ring is @xmath107 or @xmath108 .",
    "however , as noted in the recent book of berstel and reutenauer , it makes more sense to define the @xmath0-regular sequences over a semiring instead of a ring .",
    "the advantage is greater generality , but at the cost of giving up part of the characterization in terms of the @xmath0-kernel .    to illustrate this ,",
    "consider the sequence @xmath109 defined to be the sum of the bits in the base-@xmath10 representation of @xmath1 .",
    "for example , @xmath110",
    ". then @xmath109 is @xmath10-regular over @xmath107 , as its @xmath10-kernel @xmath111 generates a module @xmath22 that is generated by the sequence @xmath109 itself and the constant sequence @xmath112 .",
    "indeed , we have @xmath113 so that every sequence in the @xmath10-kernel is a @xmath107-linear combination of @xmath114 and the constant sequence @xmath112 .",
    "indeed , it is even true that every sequence in @xmath111 is an @xmath16-linear combination of @xmath114 and the constant sequence @xmath112 .    in ,",
    "the authors show that every sequence in the @xmath0-kernel @xmath111 of a @xmath0-regular sequence over @xmath107 is generated by some finite subset of @xmath111 .",
    "for example , for @xmath114 , the @xmath10-kernel @xmath111 is generated by @xmath114 and @xmath115 .",
    "however , in this example , there is no finite subset @xmath116 such that every sequence in @xmath111 can be written as an @xmath16-linear combination of the sequences in @xmath78 . for every sequence in @xmath111",
    "is of the form @xmath117 with @xmath118 .",
    "if we take some finite subset @xmath116 , then the sequences in @xmath119 of the form @xmath120 all satisfy @xmath121 for some finite @xmath122 .",
    "we then can not get @xmath123 as an @xmath16-linear combination of the sequences in @xmath119 ( as any such combination would have at least two copies of @xmath124 ) .",
    "[ s2 ]    this means that to define @xmath125-regular sequences , we have to give up one characterization in terms of the kernel , given in .",
    "in this section we give a rigorous definition of @xmath126-regular sequences and show that there are a number of alternative characterizations that are equivalent .",
    "first , we give some definitions .",
    "let @xmath127 denote the alphabet @xmath128 .",
    "let @xmath129 denote the set of canonical base-@xmath0 expansions , that is , those with no leading zero .",
    "let @xmath106 be a semiring .",
    "formal series _ is a map @xmath130 . for historical reasons ,",
    "@xmath131 is often written as @xmath132 and @xmath133 itself is expressed as the formal sum @xmath134 .",
    "a formal series @xmath133 taking values in a semiring @xmath106 is said to be _",
    "@xmath106-recognizable _ if @xmath135 for all @xmath136 , where @xmath137 is a morphism from @xmath138 to the set of @xmath139 matrices , @xmath140 is a @xmath141 matrix ( or row vector ) , and @xmath142 is an @xmath143 matrix ( or column vector ) , all with entries in @xmath106 .",
    "the triple @xmath144 is called a _ linear representation _ of @xmath133 .",
    "the reader is directed to and especially for more information about recognizable series .",
    "we recall the following standard result about recognizable series ( , ex .  2.1.3 , p.  42 )",
    ":    let @xmath106 be a semiring , and let @xmath145 be an @xmath106-recognizable series .",
    "then the series @xmath146 defined by @xmath147 is also @xmath106-recognizable .",
    "[ rev ]    next , we prove a somewhat technical lemma that essentially says that we can disregard leading @xmath148 s in the representation of a word .",
    "let @xmath106 be a semiring , and let @xmath145 be an @xmath106-recognizable series .",
    "then there exists another @xmath106-recognizable series @xmath149 such that @xmath150 for all @xmath77 and all @xmath151 .",
    "furthermore , there exists a linear representation @xmath152 for @xmath149 satisfying @xmath153 .",
    "[ lz ]    suppose @xmath144 is a rank-@xmath1 linear representation of @xmath73 .",
    "let @xmath154 denote the @xmath139 identity matrix .",
    "define @xmath155 as follows : @xmath156 \\\\ \\mu'(a ) & = & \\begin{cases }      \\left [ \\begin{array}{cc }      \\mu(0 ) & { \\bf 0 } \\\\      { \\bf 0 } & i_n       \\end{array } \\right ] , & \\text { if $ a = 0 $ ; }   \\\\      \\vphantom{a } & \\\\      \\left [ \\begin{array}{cc }      \\mu(a ) & { \\bf 0 } \\\\",
    "\\mu(a ) & { \\bf 0 }       \\end{array } \\right ] , & \\text { if $ a \\not= 0 $ ; } \\\\      \\end{cases } \\\\ v ' & = & [ v \\quad v ] ^t , \\\\\\end{aligned}\\ ] ] and set @xmath157 .    to see that this works , we will first prove the following two facts : @xmath158 \\label{eq1}\\ ] ] for @xmath77 and @xmath159 \\label{eq2}\\ ] ] for @xmath77 and @xmath160 . the claim ( [ eq1 ] ) is a trivial induction , and is omitted .",
    "let s prove ( [ eq2 ] ) by induction on @xmath161 .",
    "the base case is @xmath162 . in that case @xmath163 , where @xmath164 . from the definition we have @xmath165\\ ] ] so , using ( [ eq1 ] ) , we get @xmath166 = \\left [ \\begin{array}{cc }      \\mu(0^i a ) & { \\bf 0 } \\\\",
    "\\mu(a ) & { \\bf 0 } \\\\",
    "\\end{array } \\right],\\ ] ] as desired . for the induction step ,",
    "assume the result ( [ eq2 ] ) holds for all @xmath167 with @xmath168 ; we prove it for @xmath33 .",
    "write @xmath169 with @xmath164 .",
    "there are two cases : ( i ) @xmath170 for some @xmath171 , and ( ii ) @xmath172 , where @xmath48 and @xmath173 . in case ( i ) we have , by induction , that @xmath174,\\ ] ] and hence @xmath175 = \\left [ \\begin{array}{cc }      \\mu(ax ) & { \\bf 0 } \\\\",
    "\\mu(ax ) & { \\bf 0 } \\\\      \\end{array } \\right ]   = \\left [ \\begin{array}{cc }      \\mu(w ) & { \\bf 0 } \\\\",
    "\\mu(w ) & { \\bf 0 }       \\end{array } \\right],\\ ] ] as desired . in case ( ii ) we have , by induction , that @xmath176,\\ ] ] and again we have @xmath177      = \\left [ \\begin{array}{cc }      \\mu(ax ) & { \\bf 0 } \\\\",
    "\\mu(ax ) & { \\bf 0 } \\\\      \\end{array } \\right ]      =    \\left [ \\begin{array}{cc }      \\mu(w ) & { \\bf 0 } \\\\",
    "\\mu(w ) & { \\bf 0 }       \\end{array } \\right],\\ ] ] as desired .",
    "therefore @xmath178 \\",
    "\\left [ \\begin{array}{cc }      \\mu(w ) & { \\bf 0 } \\\\",
    "\\mu(w ) & { \\bf 0 }       \\end{array } \\right ] = \\left [ \\begin{array}{cc }      \\mu(0^i w ) & { \\bf 0 } \\\\",
    "\\mu(w ) & { \\bf 0 }       \\end{array}\\right],\\ ] ] which completes the induction .    now that we know that ( [ eq1 ] ) and ( [ eq2 ] ) hold , we have , if @xmath179 for some @xmath77 , that @xmath180 \\left [ \\begin{array}{cc }      \\mu(0^i ) & { \\bf 0 } \\\\      { \\bf 0 } & i_n \\end{array}\\right ]   \\left [ \\begin{array}{c }      v \\\\",
    "\\quad \\\\      v       \\end{array }      \\right]\\\\ & = & uv    \\\\ & = & ( f , \\epsilon),\\end{aligned}\\ ] ] as desired .",
    "if @xmath181 with @xmath77 and @xmath182 , then @xmath183   \\left [ \\begin{array}{cc }      \\mu(0^i z ) & { \\bf 0 } \\\\",
    "\\mu(z ) & { \\bf 0 }      \\end{array }      \\right ]       \\left [ \\begin{array}{c }          v \\\\",
    "\\quad \\\\          v           \\end{array }          \\right]\\\\ & = & u \\mu(z ) v \\\\ & = & ( f , z),\\end{aligned}\\ ] ] as desired .",
    "finally , note that @xmath184 \\left [ \\begin{array}{cc }      \\mu(0 ) & { \\bf 0 } \\\\      { \\bf 0 } & i_n \\end{array } \\right ]   = [ \\ \\overbrace{0 \\ 0 \\ \\cdots 0}^n \\quad u ] = u'$ ] .    combining the previous two lemmas ,",
    "we get    let @xmath106 be a semiring , and let @xmath145 be an @xmath106-recognizable series .",
    "then there exists another @xmath106-recognizable series @xmath149 such that @xmath185 for all @xmath77 and all @xmath186 .",
    "furthermore , there exists a linear representation @xmath152 for @xmath149 satisfying @xmath187 .",
    "[ tz ]    we are now ready to state our equivalence theorem .",
    "this result can be viewed as an expanded version of , prop .",
    "1.1 , p.  84 .",
    "let @xmath188 be a sequence taking values in a semiring @xmath106 .",
    "the following are equivalent .",
    "* there exist finitely many sequences @xmath189 such that * * @xmath188 is an @xmath106-linear combination of the @xmath190 ; and * * for each @xmath6 and @xmath191 with @xmath192 and @xmath193 , the subsequence @xmath194 is an @xmath106-linear combination of the @xmath195 .",
    "* there exist finitely many sequences @xmath196 and @xmath0 matrices @xmath197 with entries in @xmath106 such that if @xmath198 then @xmath199 for @xmath200 . and there exists a vector @xmath201 such that @xmath202 .",
    "* there exist a matrix - valued morphism @xmath203 and vectors @xmath204 with entries in @xmath106 , such that @xmath205 and @xmath206 for all @xmath207 with @xmath31_k = n$ ] .",
    "* there exist a matrix - valued morphism @xmath208 and vectors @xmath209 with entries in @xmath106 , such that @xmath210 and @xmath211 for all @xmath207 with @xmath31_k = n$ ] .",
    "* there is an @xmath106-recognizable series @xmath212 such that @xmath213_k)$ ] for all @xmath151 . *",
    "the mapping @xmath214_k)$ ] defines an @xmath106-recognizable series . *",
    "the mapping @xmath215_k)$ ] defines an @xmath106-recognizable series .",
    "* there is an @xmath106-recognizable series @xmath216 such that @xmath217_k)$ ] for all @xmath186 .",
    "[ equiv ]    \\(a ) @xmath218 ( b ) : since each @xmath219 is an @xmath106-linear combination of the @xmath190 , we can express this as the matrix product @xmath199 .",
    "since @xmath220 is an @xmath106-linear combination of the @xmath221 , we can express this as @xmath202 for a suitable vector @xmath222 .",
    "\\(b ) @xmath218 ( c ) : in fact we can take @xmath223 , @xmath224 for @xmath200 , and @xmath225 .",
    "let us prove by induction on @xmath1 that @xmath226 .",
    "the base case is @xmath227 .",
    "then @xmath228 , so @xmath229 , the identity matrix , and @xmath230",
    ".    now assume the result is true for all @xmath231 , and we prove it for @xmath1 .",
    "write @xmath232 for @xmath200 . then by induction @xmath233",
    ". then @xmath234 .",
    "we have @xmath235 .",
    "furthermore , from @xmath236 with @xmath237 , we get @xmath238 .    finally , if @xmath207 is such that @xmath31_k = n$ ] , then @xmath239 for some @xmath240 . because @xmath241 , we have @xmath242 .",
    "\\(c ) @xmath218 ( d ) : let @xmath243 , @xmath244 , and @xmath245",
    ". then from ( c ) we get @xmath246 . furthermore , from @xmath247 we get @xmath248 , and so @xmath249 let @xmath33 be any word such that @xmath31_k = n$ ]",
    ". then we can write @xmath250 for some @xmath77",
    ". then @xmath251 from ( [ star ] ) , and hence @xmath211 , as desired .",
    "\\(d ) @xmath218 ( e ) : we can take @xmath252 .",
    "\\(e ) @xmath218 ( f ) : let @xmath212 be an @xmath106-recognizable series such that @xmath213_k)$ ] for all words @xmath151",
    ". now apply lemma  [ lz ] ; we obtain a new @xmath106-recognizable series @xmath133 with @xmath253 for all @xmath254 and all @xmath255 .",
    "let @xmath256 .",
    "then we can write @xmath257 , where @xmath255",
    ". then @xmath258_k ) = f([0^j x]_k ) = f([w]_k)$ ] .",
    "\\(f ) @xmath218 ( g ) : using lemma  [ rev ] , if @xmath259 is the series defined by @xmath260 , then @xmath259 is also @xmath106-recognizable .",
    "we have @xmath261_k)$ ] .",
    "\\(g ) @xmath218 ( h ) : trivial .",
    "\\(h ) @xmath218 ( a ) : by lemma  [ tz ] there exists an @xmath106-recognizable series @xmath262 with linear representation @xmath263 such that @xmath264 for all @xmath77 and all @xmath186 .",
    "furthermore , @xmath265 .",
    "define the sequences @xmath266 as follows : @xmath267 = \\gamma ' ( ( n)_k^r ) \\cdot d'.\\ ] ] then @xmath268 = \\gamma ' ( ( kn+a)_k^r ) \\cdot d ' . \\label{an00}\\ ] ]    if @xmath269 then @xmath270,\\end{aligned}\\ ] ] which expresses each @xmath219 as a linear combination of @xmath271 .    if @xmath272 , then from ( [ an00 ] ) we get @xmath268 = \\gamma ' ( ( 0)_k^r ) \\cdot d ' = \\gamma'(\\epsilon ) \\cdot d ' = d ' = \\gamma'(0 ) \\cdot d ' =   \\gamma'(a ) \\left[\\begin{array}{c } f_1 ( n ) \\\\",
    "f_2(n ) \\\\ \\vdots \\\\",
    "f_t(n ) \\end{array } \\right].\\ ] ]    furthermore , @xmath273,\\ ] ] which expresses @xmath220 as a linear combination of @xmath271 .",
    "we can now formally define @xmath0-regular sequences over a semiring .",
    "suppose @xmath106 is a semiring , and @xmath274 is a sequence with values in @xmath106 .",
    "if any of the conditions ( a)(h ) in theorem  [ equiv ] hold , then we say that @xmath73 is @xmath275-regular .",
    "if @xmath73 is a sequence such that @xmath220 is an @xmath106-linear combination of some finite subset of its @xmath0-kernel , then it is @xmath126-regular .",
    "[ ker ]    follows from theorem  [ equiv ] ( a ) .",
    "however , unlike the case of @xmath276- or @xmath277-regular sequences , the converse to corollary  [ ker ] does not hold , as we have seen above in example  [ s2 ] .",
    "in this section , our semiring is @xmath278 , the non - negative integers .",
    "we prove a characterization of @xmath16-recognizable series in terms of automata and transducers ( theorem  [ one ] , below ) .",
    "we recall the notion of nondeterministic finite automaton ( nfa ) : it is a 5-tuple @xmath279 , where @xmath280 is a set of states , @xmath281 is a finite alphabet , @xmath282 is the initial state , and @xmath283 is the set of final states , and @xmath284 is the transition function , extended to @xmath285 in the obvious way .",
    "a _ path labeled @xmath286 _ in an nfa is a sequence of states @xmath287 such that @xmath288 for @xmath289 .",
    "it is an _ accepting path _ if @xmath290 and @xmath291 .    we will also be concerned with _",
    "nondeterministic uniform finite - state transducers_. such a transducer produces an output of the same length for every input symbol .",
    "formally , such a transducer @xmath292 , where @xmath293 is the set of permissible transitions .",
    "a transition @xmath294 means that if the transition is in state @xmath295 then on input @xmath191 it has the option ( nondeterministically ) of outputting @xmath296 and entering state @xmath297 .",
    "the output of @xmath298 on input @xmath33 is the set of all words formed by concatenating the outputs on a path labeled @xmath33 from @xmath282 to some state of @xmath299 .    finally , given words @xmath300 and @xmath301 of the same length , but defined over possibly different alphabets ( say , @xmath281 and @xmath3 , respectively ) , we define the word @xmath302 to be the word @xmath303 [ a_2 , b_2 ] \\cdots [ a_n , b_n]$ ] over the alphabet @xmath304 . in this case",
    ", we define the projection maps @xmath305 and @xmath306 .",
    "let @xmath307 be a formal series with @xmath308 .",
    "then the following are equivalent .",
    "* @xmath73 is @xmath16-recognizable .",
    "* there exists an nfa @xmath309 such that for all @xmath136 , there are exactly @xmath310 paths labeled @xmath33 from @xmath282 to a state of @xmath299 .",
    "* there is an alphabet @xmath3 and a regular language @xmath311 such that @xmath312 for all words @xmath33 .",
    "* there is an alphabet @xmath3 and a ( nondeterministic ) @xmath112-uniform finite - state transducer @xmath313 such that @xmath314 for all words @xmath33 .",
    "[ one ]    \\(a ) @xmath218 ( b ) : since @xmath73 is recognizable , there is a matrix representation @xmath144 such that @xmath315 for all @xmath136 . by an exercise in @xcite , ex .",
    "iii.3.3 , p.  426",
    ", we can , without loss of generality , assume that @xmath316 $ ] and @xmath317^t$ ] for some @xmath318 . for completeness , we give the proof here :    given a rank-@xmath319 representation @xmath144 , we produce a new rank-(@xmath320 ) representation @xmath152 defined as follows :    @xmath321 \\\\",
    "\\mu'(a ) & = & \\left [       \\begin{array}{ccc }      0 & [ u \\cdot \\mu(a ) ] & [ u \\cdot \\mu(a ) \\cdot v ] \\\\",
    "\\begin{array}{c }      0 \\\\      \\vdots \\\\      0      \\end{array } &       \\left [      \\begin{array}{c }      \\\\",
    "\\mu(a ) \\\\",
    "\\\\      \\end{array } \\right ]      &      \\left [ \\begin{array}{c }      \\\\",
    "\\mu(a ) \\cdot v \\\\      \\\\",
    "\\end{array } \\right ] \\\\      0 & 0 \\cdots 0 & 0       \\end{array } \\right ] \\\\ v ' & = & [ \\overbrace{0\\ 0\\ \\cdots\\ 0}^{t+1}\\ 1]^t .\\end{aligned}\\ ] ]    now an easy induction on @xmath161 shows that , for @xmath322 , that @xmath323 & [ u \\cdot \\mu(w ) \\cdot v ] \\\\      \\begin{array}{c }      0 \\\\      \\vdots \\\\      0      \\end{array } &       \\left [      \\begin{array}{c }      \\\\",
    "\\mu(w ) \\\\      \\\\",
    "\\end{array } \\right ]      &      \\left [ \\begin{array}{c }      \\\\",
    "\\mu(w ) \\cdot v \\\\      \\\\",
    "\\end{array } \\right ] \\\\      0 & 0 \\cdots 0 & 0       \\end{array } \\right ] .\\ ] ] it follows that , for @xmath324 , @xmath325 . for @xmath326 , we have @xmath327 .",
    "this completes the proof of the exercise .",
    "now that this somewhat technical point has been handled , we turn to the idea of the construction .",
    "the desired interpretation is that @xmath328 should count the number of paths labeled @xmath33 from state @xmath6 to state @xmath47 .",
    "however , this is not sensible if @xmath191 is a single symbol , as there is either one directed edge in the automaton from @xmath6 to @xmath47 labeled @xmath191 , or none . to get around this problem , we make multiple copies of each state , and create a transition from @xmath6 to @xmath328 copies of state @xmath47 .    from the rank-@xmath1 linear representation for @xmath73 , namely @xmath144",
    ", we create an nfa @xmath309 with @xmath310 paths labeled @xmath33 .",
    "let @xmath329 be the maximum entry in all the @xmath330 , @xmath331 .",
    "define @xmath332 \\ : \\",
    "1 \\leq i \\leq n,\\ 1 \\leq j \\leq m \\rbrace \\\\ q_0 & = & [ 1,1 ] \\\\ f & = & \\lbrace [ n , s ] \\ : \\ 1 \\leq s \\leq m \\rbrace \\\\ \\delta([i , j ] , a ) & = & \\lbrace [ r , s ] \\ : \\ 1 \\leq r \\leq n , \\",
    "1 \\leq s \\leq \\mu(a)_{i , r } \\rbrace,\\end{aligned}\\ ] ] where by @xmath333 we mean the entry in row @xmath6 and column @xmath12 of the matrix @xmath330 .    to see that this works ,",
    "let @xmath334 denote the number of paths labeled @xmath33 from @xmath335 $ ] to some member of @xmath336 \\ : \\",
    "1 \\leq s \\leq m \\rbrace$ ] .",
    "we claim that @xmath337 for all @xmath338 such that @xmath339 , @xmath340 , and @xmath136 .",
    "the proof is by induction on @xmath161 .",
    "the base case is @xmath341 . in this case @xmath342 and the only path of length @xmath148 from state @xmath335 $ ] is to @xmath335 $ ] itself , so @xmath343 .",
    "now assume ( [ pmu ] ) holds for all @xmath344 ; we prove it for @xmath33 .",
    "write @xmath169 with @xmath345 .",
    "break the path labeled @xmath33 into two pieces , one labeled @xmath191 and the other labeled @xmath41 .",
    "then @xmath346 \\in \\delta([i , j ] , a ) } } p_{i ' , j ' , r } ( x ) \\\\ & = & \\sum_{{i',j ' :} \\atop      { [ i ' , j ' ] \\in \\delta([i , j ] , a ) } } \\mu(x)_{i ' , r } \\quad \\quad          \\text{(by induction)}\\\\ & = & \\sum_{i ' } \\mu(a)_{i , i ' } \\cdot \\mu(x)_{i ' , r } \\\\ & = & \\mu(ax)_{i , r } , \\end{aligned}\\ ] ] which completes the induction",
    ".    thus @xmath347 , as desired .",
    "\\(b ) @xmath218 ( c ) : given the nfa @xmath309 , we take @xmath348 and define @xmath349 since there are @xmath310 accepting paths for @xmath33 in @xmath22 , and each such path begins with @xmath282 , the result follows .",
    "clearly @xmath80 is regular , as it can be accepted by a simple modification of @xmath22 .",
    "\\(c ) @xmath218 ( d ) : consider a dfa @xmath22 accepting @xmath80 .",
    "we construct a transducer @xmath298 with the same set of states , initial state , and set of final states as @xmath22 . for each transition in @xmath22 of the form @xmath350 ) = q_j$ ] , we define a transition in @xmath298 from @xmath295 to @xmath297 with input @xmath191 and output @xmath351 .",
    "it follows that on input @xmath33 , the transducer @xmath298 outputs all those @xmath41 of the same length for which @xmath352 .",
    "\\(d ) @xmath218 ( a ) : given such a transducer @xmath353 , we define the matrix representation @xmath144 for the series @xmath73 as follows : if @xmath354 , then @xmath316 $ ] and @xmath142 has a @xmath112 in the entries corresponding to final states of @xmath299 , and @xmath148 elsewhere . since @xmath355 by hypothesis , it must be that @xmath356 . now define @xmath357 to be the number of symbols @xmath351 such that @xmath358",
    ".    the preceding theorem would be true if we replace the @xmath112-uniform finite - state transducer with any transducer where no two different paths labeled @xmath33 give the same output .",
    "one way to ensure this is that the output labels form a code , and this is clearly true if the outputs are all of the same length . what happens if the output labels do not form a code ?",
    "is the result still true ?",
    "carpi and maggi defined the class of @xmath0-synchronized sequences , a class which contains the @xmath0-automatic sequences and is properly contained in the class of @xmath0-regular sequences .",
    "a sequence @xmath359 is @xmath0-synchronized if the relation @xmath360 is a right - synchronized rational relation . roughly speaking",
    ", this means that the relation is realized by a length - preserving rational transduction , except that we also permit the presence of `` padding '' symbols at the end of one or the other component of the input .",
    "our transducer - based characterization , combined with theorem  [ equiv ] , characterizes the more general class of @xmath0-regular sequences .",
    "in the usual case where @xmath361 , we can take @xmath3 to be @xmath362 for a suitable @xmath13 , as the following theorem shows .",
    "let @xmath307 be a formal series with @xmath361 and @xmath308 .",
    "then the following are equivalent .",
    "* @xmath73 is @xmath16-recognizable .",
    "* there is an integer @xmath363 and a regular language @xmath364 such that @xmath365 for all words @xmath33 .",
    "* there is an integer @xmath363 and a ( nondeterministic ) @xmath13-uniform finite - state transducer @xmath366 such that @xmath314 .",
    "[ two ]    just like the proof of theorem  [ one ] .",
    "the only difference is that we need to choose @xmath13 large enough so that @xmath367 ; then we just use elements of @xmath362 instead of those in @xmath3 .",
    "in this section , we consider the case where the underlying semiring is @xmath368 , the extended non - negative integers . roughly speaking",
    ", this extension corresponds to the case where a nondeterministic finite automaton or transducer is extended by allowing @xmath369-transitions .",
    "in addition to the usual interpretation for addition and multiplication of natural numbers , we need the following additional rules that turn @xmath18 into a semiring :    * @xmath370 for all @xmath371 ; * @xmath372 for all @xmath373 ; * @xmath374 .",
    "matrices and vectors with entries in @xmath18 can now be multiplied using the usual rules for such multiplication , in addition to the rules ( i)(iii ) , as needed .",
    "let @xmath80 be a regular language .",
    "characteristic series _ of @xmath80 , denoted @xmath375 , is the formal series such that @xmath376 if @xmath377 and @xmath148 otherwise . the _ hadamard product _ of two series , @xmath378 , is the term - by - term product , @xmath379 .",
    "the essential lemma is the following :    given a recognizable formal series @xmath73 over @xmath18 , we can express it as @xmath380 where @xmath149 is a recognizable formal series over @xmath16 and @xmath80 is a regular language .",
    "furthermore , in the sum , we never add @xmath381 to a value other than @xmath148 .",
    "[ twoe ]    there are two main ideas .",
    "the first is that the language @xmath382 is regular .",
    "the second is that @xmath149 can be taken to be a modification of @xmath73 with all occurrences of @xmath381 removed .",
    "first , the construction of @xmath80 .",
    "this is essentially that given in salomaa and soittola , p.  40 ,",
    "exercise 5 .",
    "we create a new finite semiring @xmath383 where the addition and multiplication rules are given as follows :    @xmath384    here @xmath385 should be treated as formal symbols , but the intent is that the symbol @xmath216 denotes `` some positive integer '' .",
    "now we define a morphism of semirings @xmath386 as follows : @xmath387 it is now easy to check that for all @xmath388 we have @xmath389 and @xmath390 , where the operations on the right - hand - side are those in @xmath391 . we extend @xmath392 to apply to vectors and matrices by applying @xmath392 to each entry .",
    "next , we consider the formal series @xmath393 , which takes its values in @xmath391 .",
    "it follows from above that @xmath394 , where @xmath395 , @xmath396 , and @xmath397 .",
    "now we can create a deterministic finite automaton @xmath309 that essentially computes the series @xmath398 .",
    "we do this by letting @xmath280 be the set of all possible @xmath141 row vectors over @xmath391 , letting @xmath399 , and defining the transitions @xmath400 . if we define @xmath401 , then an easy induction gives that @xmath402 , and hence @xmath403 , as desired .",
    "we can now define @xmath80 .",
    "let @xmath299 , the set of final states of @xmath22 , be given by @xmath404 then @xmath405 . by construction",
    ", we have the following equivalences : @xmath406 .",
    "now we turn to the construction of @xmath149 .",
    "let @xmath144 be a linear representation for @xmath73 .",
    "define a map @xmath407 as follows : @xmath408 and extend @xmath409 to apply element - by - element to vectors and matrices in the obvious way .",
    "let @xmath410 , where @xmath411 , @xmath412 for each @xmath345 , and @xmath413 .",
    "the series @xmath149 is created by replacing each occurrence of @xmath381 in @xmath414 and @xmath142 with @xmath148 .",
    "then @xmath149 is evidently @xmath16-recognizable , and we claim that @xmath415 . to see this , note that if @xmath416 , then in the calculation @xmath417 any occurrences of @xmath381 that arise must eventually be multiplied by @xmath148 , yielding @xmath148 .",
    "then replacing @xmath381 with @xmath148 has no effect , since any multiplication involving @xmath148 will also yield @xmath148 .",
    "( note that we are not claiming anything about those @xmath33 for which @xmath418 ; the corresponding values of @xmath149 could be anything . )",
    "it now follows that @xmath419 .",
    "we get the following two corollaries .",
    "[ cor ] if @xmath420 is an @xmath18-recognizable series , then it is @xmath16-recognizable .    from lemma  [ twoe ] ,",
    "we have @xmath421 where @xmath149 is an @xmath16-recognizable formal series and @xmath80 is a regular language . since @xmath422 and from the proof of lemma  [ twoe ]",
    ", we may choose @xmath423 .",
    "so @xmath424 .",
    "given a recognizable formal series @xmath73 over @xmath18 , with linear representation @xmath144 , there exists another linear representation @xmath425 such that the only entries equal to @xmath381 lie in @xmath216 . [ onee ]",
    "first , by a well - known result on the hadamard product ( e.g. , @xcite and , p.  15",
    ", the formal series @xmath426 constructed in lemma  [ twoe ] is recognizable ( over @xmath16 ) .",
    "so @xmath427 has a linear representation @xmath144 that contains no entries of @xmath381 .",
    "similarly , since @xmath80 is a regular language , the characteristic series @xmath375 has a linear representation @xmath428 , where the entries of @xmath429 and @xmath430 are all either @xmath148 or @xmath112 .",
    "from this we can form a new linear representation @xmath425 for @xmath73 , via a direct sum construction , as follows : @xmath431 \\\\",
    "\\beta(a ) & = & \\left [ \\begin{array}{cc }       \\mu(a ) & { \\bf 0 } \\\\      { \\bf 0 } & \\alpha(a )       \\end{array } \\right ] \\\\ q & = & \\ , [ \\ v \\",
    "s ] ^t .\\end{aligned}\\ ] ] here , @xmath432 represents a matrix of @xmath148 s of the appropriate size .",
    "a routine induction shows that @xmath433 contains @xmath434 in the upper left and @xmath435 in the lower right , from which the result follows .",
    "just as the @xmath16-recognizable series have a number of different interpretations in terms of automata and transducers , as we saw in section  [ enn ] , so do the @xmath18-recognizable series ; the difference is that we need to allow @xmath369-transitions .",
    "let @xmath436 be a formal series .",
    "then the following are equivalent :    * @xmath73 is @xmath18-recognizable ; * there exists an nfa-@xmath369 @xmath309 such that , for all @xmath136 , there are exactly @xmath310 paths labeled @xmath33 from @xmath282 to a state of @xmath299 ; * there is an alphabet @xmath3 , a symbol @xmath437 and a regular language @xmath438 such that @xmath439 where @xmath392 is the morphism that maps @xmath191 to @xmath191 for @xmath345 and @xmath440 to @xmath369 ; * there is an alphabet @xmath3 , a symbol @xmath441 , and a regular language @xmath438 such that @xmath442 * there is an alphabet @xmath3 and a nondeterministic finite - state transducer @xmath298 , with inputs of a single letter or @xmath369 on every transition , and outputs of a single letter on every transition , such that @xmath314 .",
    "[ onen ]    we prove the implications in the order ( a ) @xmath218 ( d ) @xmath218 ( e ) @xmath218 ( c ) @xmath218 ( b ) @xmath218 ( a ) .",
    "\\(a ) @xmath218 ( d ) : by theorem  [ twoe ] , we know that @xmath443 , where @xmath444 is a regular language and @xmath149 is an @xmath16-recognizable series .",
    "define @xmath445 ; then @xmath427 is an @xmath16-recognizable series with @xmath446 , so we can apply the implication ( a ) @xmath218 ( c ) in theorem  [ one ] to @xmath427 to get an alphabet @xmath3 and a regular language @xmath447 such that @xmath448 for all words @xmath324 .",
    "let @xmath191 be an arbitrarily chosen , fixed symbol of @xmath3 , and consider the language @xmath449 defined by @xmath450^i \\right ) \\",
    "\\lbrace z \\in   ( ( \\sigma \\ \\cup \\ \\lbrace { \\tt b } \\rbrace ) \\times \\delta)^ * \\ : \\",
    "\\pi_1(z ) \\in ( l_1 - \\lbrace \\epsilon \\rbrace ) \\cdot { \\tt b } ^ * \\text { and } \\pi_2 ( z ) \\in a^ * \\rbrace.\\ ] ] it is easy to see that @xmath449 is regular , as each term of the big union is regular . for the second term , we can ,",
    "given a dfa for @xmath451 , modify it by    * changing each transition on any letter @xmath351 to a transition on @xmath452 $ ] * adding transitions out of each accepting state on @xmath453 $ ] to a new final state @xmath454 and * adding a self - loop labeled @xmath455 $ ] from @xmath454 to itself .",
    "let @xmath456 .",
    "then @xmath80 is regular and , by construction , @xmath457 .",
    "\\(d ) @xmath218 ( e ) : given a dfa @xmath22 for @xmath80 , say @xmath458 where @xmath459 , we create the transducer @xmath298 with the same set of states , initial state , and set of final states as @xmath22 . for each transition in @xmath22 of the form @xmath460 ) = q_j$ ] , we define a transition in @xmath298 from @xmath295 to @xmath297 with input @xmath191 and output @xmath351 , except that if @xmath461 , then we set the corresponding transition in @xmath298 to have input @xmath369 .",
    "each word that @xmath22 accepts , having first component @xmath462 and second component @xmath296 , corresponds to an input @xmath33 of @xmath298 and an output of @xmath296 .",
    "the result now follows .",
    "\\(e ) @xmath218 ( c ) : the construction of the previous paragraph is completely reversible , which shows that ( e ) @xmath218 ( d ) . but clearly ( d ) @xmath218 ( c ) .",
    "\\(c ) @xmath218 ( b ) : let @xmath463 be a regular language such that @xmath464 and let @xmath465 be a dfa accepting @xmath80 , where @xmath466 .",
    "we now create an nfa-@xmath369 @xmath23 with the desired property , by modifying @xmath22 , as follows : first , the set of states is expanded from @xmath280 to @xmath467 .",
    "second , if @xmath22 has a transition @xmath350 ) = q_j$ ] with @xmath345 , then @xmath23 has transitions @xmath468 , a ) = [ q_j , b]$ ] for all @xmath469 .",
    "similarly , if @xmath22 has a transition @xmath470 ) = q_j$ ] , then @xmath23 has a transition @xmath468 , \\epsilon ) = [ q_j , b]$ ] for all @xmath469 .",
    "the initial state is @xmath471 $ ] for some arbitrary element @xmath472 , and the set of final states of @xmath23 is @xmath473 .",
    "the formal proof that this works is essentially the proof of ( a ) @xmath218 ( b ) in theorem  [ one ] and is omitted .",
    "\\(b ) @xmath218 ( a ) : given the nfa-@xmath369 @xmath474 , we create some associated matrices @xmath475 for @xmath476 . if the set of states @xmath477 , then @xmath475 has a @xmath112 in row @xmath6 and column @xmath47 iff @xmath478 .",
    "now any finite path labeled @xmath300 in the transition diagram of @xmath22 looks like @xmath479 for some @xmath480 with @xmath481 .    let @xmath482 ; this is a matrix with possibly infinite entries .",
    "then the entry in row @xmath6 and column @xmath47 of @xmath483 gives the number of paths from state @xmath295 to state @xmath297 in @xmath22 . if @xmath484 $ ] and @xmath142 is the @xmath485-vector corresponding to the final states of @xmath22 , then @xmath486 is the number of accepting paths labeled @xmath33 .",
    "if we now define @xmath487 for @xmath345 and @xmath488 , then @xmath489 is a linear representation for @xmath73 .",
    "now that all the basic definitions and results are out of the way , we can resume our work on enumeration . the common theme in what follows is to show that some well - studied sequence is @xmath0-regular , by combining theorem  [ one ] or theorem  [ onen ] ( which characterize the formal series associated with counting the number of paths , or certain subsets of regular languages , or size of transduced sets , as @xmath16- or @xmath18-recognizable ) with theorem  [ equiv ] , which shows the equivalence between @xmath0-regular sequence and recognizable formal series .",
    "here is a simple example :    let @xmath490 be any finite set of integers , and consider @xmath491 , the sequence that counts the number of reversed representations of @xmath1 in base @xmath0 , where the digits are chosen only from @xmath490 , and where reversed representations with trailing zeroes are not allowed .",
    "then @xmath491 is @xmath492-regular .",
    "[ ns ]    we construct a transducer @xmath298 having @xmath493 distinct outputs on input @xmath494 . on input",
    "@xmath29 , the transducer @xmath298 guesses a possible representation @xmath33 using only the digits of @xmath490 , simultaneously `` normalizes '' it , digit - by - digit , to @xmath167 , and checks that the normalized representation is equal to the input . if it is , then @xmath33 is output .",
    "there are some details to handle if @xmath33 is shorter or longer than @xmath494 . if @xmath33 is shorter , then we allow padding of @xmath33 with trailing zeroes",
    ". if @xmath33 is longer , then we handle this by permitting @xmath298 to perform @xmath369-transitions on the input after it has processed all the symbols of @xmath494 .",
    "then , using theorem  [ onen ] together with theorem  [ equiv ] and corollary  [ cor ] , we see that @xmath491 is an @xmath492-regular sequence .",
    "let @xmath495 denote the number of representations of @xmath1 in base @xmath10 , using the digits @xmath128 .",
    "then @xmath496 , from the uniqueness of binary representations , and @xmath497 is the stern - brocot sequence evaluated at @xmath498 . from theorem  [ ns ] , we see that all these sequences are @xmath499-regular .",
    "see @xcite .",
    "we now turn to our main enumeration results .",
    "let @xmath500 be a @xmath0-automatic sequence .",
    "let @xmath493 be the number of distinct factors of length @xmath1 in @xmath7 .",
    "then @xmath491 is an @xmath492-regular sequence .",
    "to count distinct factors of length @xmath1 , we count the _ first _ occurrences of each factor .",
    "the number of distinct factors of length @xmath1 in @xmath7 equals the number of indices @xmath6 such that there is no index @xmath501 with the factor of length @xmath1 beginning at position @xmath6 equal to the factor of length @xmath1 beginning at position @xmath47 .",
    "consider the set @xmath502 then , by theorem  [ logic ] , the language @xmath503 defined to be the base-@xmath0 encoding of elements of @xmath78 , forms a regular language .",
    "we assume without loss of generality that if one representation of @xmath504 appears in @xmath503 , then they all do , including the ones with leading ( actually , trailing zeroes ) .",
    "we now apply a transducer to @xmath503 , changing every representation of @xmath504 as follows : we change every @xmath148 after the last nonzero digit in the first component to @xmath440 .",
    "this transformation preserves the regularity of @xmath503 .",
    "finally , we discard every representation that ends with @xmath505 $ ] .",
    "the effect of this is to ensure that @xmath1 in the first component , up to ignoring the @xmath506 s , has a single representation , and that each @xmath6 corresponding to a particular @xmath1 has a unique representation . using theorems  [ one ] and [ equiv ] , we see that @xmath491 is @xmath492-regular .",
    "moss @xcite proved , among other things , that a sequence that is the fixed point of a @xmath0-uniform morphism has a @xmath0-regular subword complexity function . with our technique , we obtain her result for these sequences and also the slightly more general case of @xmath0-automatic sequence .",
    "the sequence counting the number of palindromic factors of length @xmath1 is @xmath492-regular .    the number of distinct palindromes of length @xmath1 in * x *    is equal to    the number of indices @xmath6 such that @xmath5 $ ] is a palindrome and @xmath5 $ ] does not appear previously in @xmath7    is equal to    the number of indices @xmath6 such that @xmath5 = { \\bf x}[i .. i+n-1]^r$ ] and for all @xmath47 with @xmath507 , @xmath5 $ ] is not the same as @xmath508 $ ]    is equal to    the number of indices @xmath6 such that for all @xmath319 , @xmath509 , @xmath510 and for all @xmath47 with @xmath507 , there exists @xmath140 with @xmath511 such that @xmath512 .",
    "now apply theorems  [ one ] and [ equiv ] .",
    "allouche , baake , cassaigne , and damanik , thm .",
    "10 , proved that the palindrome complexity of the fixed point of a primitive @xmath0-uniform morphism is @xmath0-automatic .",
    "our result is more general : it shows that the palindrome complexity of a @xmath0-automatic sequence is @xmath0-regular , and hence is @xmath0-automatic iff it is bounded .",
    "jean - paul allouche kindly informs us that our result has just been obtained independently by carpi and dalonzo .",
    "let @xmath220 denote the number of unbordered factors of length @xmath1 of the thue - morse sequence",
    ". here is a brief table of the values of @xmath220 :    [ cols=\"^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^\",options=\"header \" , ]     by theorems  [ one ] and [ equiv ] we know that @xmath73 is @xmath513-regular .",
    "conjecturally , @xmath73 is given by the system of recurrences @xmath514 in principle this could be verified by our method , but we have not yet done so .",
    "let @xmath43 be a @xmath0-automatic sequence .",
    "then the following sequences are also @xmath0-automatic :    * @xmath515 if there is a square beginning at position @xmath6 ; @xmath148 otherwise * @xmath516",
    "if there is a square centered at position @xmath6 ; @xmath148 otherwise * @xmath517 if there is an overlap beginning at position @xmath6 ; @xmath148 otherwise * @xmath518 if there is a palindrome beginning at position @xmath6 ; @xmath148 otherwise * @xmath519 if there is a palindrome centered at position @xmath6 ; @xmath148 otherwise    brown , rampersad , shallit , and vasiga proved results ( a)(c ) for the special case of the thue - morse sequence .",
    "let @xmath7 and @xmath520 be @xmath0-automatic sequences",
    ". then the following are @xmath521-regular :    * the number of distinct square factors in @xmath7 of length @xmath1 ; * the number of squares in @xmath7 beginning at ( centered at , ending at ) position @xmath1 ; * the length of the longest square in @xmath7 beginning at ( centered at , ending at ) position @xmath1 ; * the number of palindromes in @xmath7 beginning at ( centered at , ending at ) position @xmath1 ; * the length of the longest palindrome in @xmath7 beginning at ( centered at , ending at ) position @xmath1 ; * the length of the longest fractional power in @xmath7 beginning at ( ending at ) position @xmath1 ; * the number of distinct recurrent factors in @xmath7 of length @xmath1 ; * the number of factors of length @xmath1 that occur in @xmath7 but not in @xmath520 . * the number of factors of length @xmath1 that occur in both @xmath7 and @xmath520 .",
    "[ nine ]    brown , rampersad , shallit , and vasiga proved results ( b)(c ) for the special case of the thue - morse sequence .",
    "we now turn to some other measures that have received much attention .",
    "the recurrence function @xmath522 of an infinite word @xmath523 is the smallest integer @xmath319 such that every factor of length @xmath319 of @xmath7 contains as a factor every factor of length @xmath1 .",
    "said otherwise , it is the size of the smallest `` window '' one can slide along @xmath7 and always contain all length-@xmath1 factors .    if @xmath523 is @xmath0-automatic , then @xmath524 is @xmath525-regular .",
    "we translate the predicate `` @xmath526 '' , as follows :    @xmath526    iff    there exists @xmath77 , @xmath48 such that @xmath508 $ ] appears nowhere in @xmath527 $ ]    iff    there exists @xmath77 , @xmath48 such that for all integers @xmath13 with @xmath528 we have @xmath529 \\not= { \\bf x}[j .. j+n-1]$ ]    iff    there exists @xmath77 , @xmath48 , such that for all integers @xmath13 with @xmath528 there exists @xmath329 , @xmath530 such that @xmath531 \\not= { \\bf x}[j+m]$ ] .",
    "now for any fixed @xmath1 , the number of positive integers @xmath319 for which @xmath526 is equal to @xmath532 .",
    "hence @xmath533 is @xmath521-regular .",
    "another measure is called `` appearance '' ,  10.10 .",
    "the appearance function @xmath534 is the smallest integer @xmath319 such that every factor of length @xmath1 appears in a prefix of length @xmath319 of @xmath7 .",
    "the following result can be proved in an analogous manner to the previous one .    if @xmath523 is @xmath0-automatic , then @xmath535 is @xmath492-regular .",
    "next , we consider a measure due to garel @xcite .",
    "the separator length @xmath536 is the length of the smallest factor that begins at position @xmath1 of @xmath7 and does not occur previously .",
    "if @xmath523 is @xmath0-automatic , then @xmath537 is @xmath492-regular .",
    "the predicate `` @xmath538 '' is the same as saying that for every @xmath539 the word of length @xmath6 beginning at position @xmath1 of @xmath7 occurs previously in @xmath7 , which is the same as saying for all @xmath540 , there exists @xmath541 such that @xmath542 = { \\bf x}[j .. j+i-1]$ ] .",
    "now look at the pairs @xmath543 satisfying this , with @xmath1 positive .",
    "for each @xmath1 there are exactly @xmath544 different @xmath319 s that work .",
    "garel @xcite proved this for the case of a fixed point of a uniform circular morphism ; our proof works for the more general case of an arbitrary @xmath0-automatic sequence .",
    "carpi and dalonzo have introduced a measure they called repetitivity index .",
    "this measure @xmath545 is the minimum distance between two consecutive occurrences of the same length-@xmath1 factor in @xmath7 .",
    "but `` @xmath546 '' is the same as saying for all @xmath547 with @xmath548 , the equality @xmath5 = { \\bf x}[j .. j+n-1]$ ] implies that @xmath549 .",
    "hence we get    if @xmath7 is @xmath0-automatic , then its repetitivity index is @xmath492-regular .    for our final application , frid and zamboni",
    "introduced the notion of `` automatic permutation '' .",
    "this is a permutation of @xmath16 based on a @xmath0-automatic sequence @xmath7 , as follows : we say @xmath550 if the infinite word @xmath551 $ ] is lexicographically less than the word @xmath552 $ ] .",
    "the _ permutation complexity _",
    "@xmath553 is the map that sends @xmath1 to the number of distinct finite permutations of length @xmath1 induced by @xmath7 @xcite .",
    "the permutation complexity of a @xmath0-automatic sequence is @xmath492-regular .",
    "first , we need to see that for @xmath0-automatic sequences the predicate  the shift of @xmath7 beginning at position @xmath6 is lexicographically less than the shift beginning at position @xmath47 \" is @xmath0-automatic .    to see this , given positions @xmath6 and @xmath47",
    ", we verify that there is some index @xmath319 such that @xmath554 = a[j+l]$ ] for all @xmath555 , and also that",
    "@xmath556 < a[j+t]$ ] .    next , we need to see that given @xmath557 we need to see that the predicate `` the length-@xmath1 permutation induced by the shifts starting at position @xmath6 coincides with that starting at @xmath47 '' is automatic .    to do this we verify that for all indices @xmath13 with @xmath558 , the relation in the previous paragraph holds between @xmath559 and @xmath560 in the same way as it holds for @xmath561 and @xmath562 .    in the final step ,",
    "we enumerate the number of indices @xmath6 for which the permutation at position @xmath6 of length @xmath1 does not match the one occurring at any previous index .",
    "this is just the number of distinct permutations of length @xmath1 .    as a corollary",
    ", we recover the result of widmer @xcite that the permutation complexity of the thue - morse word is @xmath513-regular . in principle his description could be mechanically verified .",
    "yet another application of our method allows us to obtain linear bounds on many quantities associated with automatic sequences . as a first example",
    ", we recover an old result of cobham @xcite on `` subword '' complexity .",
    "the number of distinct factors of length @xmath1 of an automatic sequence is @xmath563 .",
    "let @xmath7 be a @xmath0-automatic sequence . by theorem  [ logic ]",
    "we know that the base-@xmath0 encoding @xmath503 of @xmath564 is a regular language .",
    "suppose that the factor complexity of @xmath7 is not @xmath563 .",
    "then for every @xmath80 there exists some pair @xmath565 such that the length of the canonical encoding of @xmath566 is longer than that of @xmath1 by at least @xmath80 digits .",
    "so in @xmath503 there is some word of the form @xmath567 , where @xmath568 denotes the canonical encoding of @xmath140 in base @xmath0 and @xmath569 is how we join separate components to form a word .",
    "since the length of @xmath570 is very much longer than that of @xmath29 , we can apply the pumping lemma to this word , where we only pump in the portion of @xmath570 that is longer than @xmath29 .",
    "hence when we pump , we only add @xmath506 s to the first component , and so its value remains unchanged . in this way by pumping we obtain infinitely many values @xmath571 such that @xmath572 . in other words , there are infinitely many distinct factors of length @xmath1 , which is clearly absurd .",
    "the contradiction proves the result .    in a similar manner",
    "we can prove that all the quantities in theorem  [ nine ] are either linearly bounded , or unbounded .",
    "all our results transfer , _ mutatis mutandis _ , to the setting of other numeration systems where addition can be performed on numbers using a transducer that processes numbers starting with the least significant digit .",
    "a ( generalized ) numeration system is given by an increasing sequence of integers @xmath573 such that @xmath574 and @xmath575 exists and is finite .",
    "then the canonical @xmath576-representation of @xmath1 ( with least significant digit first ) , which is denoted by @xmath577 , is the unique finite word @xmath33 over the alphabet @xmath578 not ending with @xmath148 and satisfying @xmath579\\,u_i\\ \\text { and } \\",
    "\\forall t\\in\\{0,\\ldots,|w|-1\\},\\ \\sum_{i=0}^t w[i]\\,u_i < u_{t+1}.$ ] the notion of @xmath0-automatic sequence extends naturally to this context : an infinite sequence * x * is said to be @xmath576-automatic if it is computable by a finite automaton taking as input the @xmath576-representation @xmath577 of @xmath1 , and having @xmath580 $ ] as the output associated with the last state encountered .    a numeration system @xmath576 is called _ linear _ if @xmath576 satisfies a linear recurrence relation over @xmath581 .",
    "a pisot system is a linear numeration system @xmath576 whose characteristic polynomial is the minimal polynomial of a pisot number . recall that a pisot number is an algebraic integer greater than 1 , all of whose conjugates have moduli less than 1 . for example , all integer base numeration systems and the fibonacci numeration system are pisot systems .",
    "frougny and solomyak proved that addition is @xmath576-recognizable within all pisot systems @xmath576 , i.e. , it can be performed by a finite letter - to - letter transducer reading @xmath576-representations with least significant digit first .",
    "bruyre and hansel then proved the following logical characterization of @xmath576-automatic sequences for pisot systems : a sequence is @xmath576-automatic if and only if it is @xmath576-definable , i.e. , it is expressible as a predicate of @xmath582 , where @xmath583 is the smallest @xmath584 occurring in @xmath577 with a nonzero coefficient .",
    "therefore , if @xmath576 is a pisot system , any combinatorial property of @xmath576-automatic words that can be described by a predicate of @xmath582 is decidable .",
    "the notion of @xmath126-regular sequences extends to pisot numeration systems : an infinite sequence @xmath523 is said to be _",
    "@xmath585-regular _ if the series @xmath586 ( n)_u$ ] is an @xmath106-recognizable series .",
    "thus we obtain    [ the : fibonacci ] let @xmath576 be a pisot numeration system and let @xmath523 be any @xmath576-automatic word .",
    "the following sequences are @xmath576-automatic :    * @xmath587 if there is a square beginning at ( centered at , ending at ) position @xmath1 of @xmath7 , @xmath148 otherwise ; * @xmath588 if there is a palindrome beginning at ( centered at , ending at ) position @xmath1 of @xmath7 , @xmath148 otherwise ; * @xmath589 if there is an unbordered factor beginning at ( centered at , ending at ) position @xmath1 of @xmath7 , @xmath148 otherwise",
    ".    the following sequences are @xmath590-regular :    * the number of distinct square factors beginning at ( centered at , ending at ) position @xmath1 of @xmath7 ; * the number of distinct palindromic factors beginning at ( centered at , ending at ) position @xmath1 of @xmath7 , @xmath148 otherwise ; * the number of distinct unbordered factors beginning at ( centered at , ending at ) position @xmath1 of @xmath7 , @xmath148 otherwise .",
    "berstel showed that the cardinality of the set of unnormalized fibonacci representations is fibonacci - regular @xcite , a result also obtained ( but not published ) by the third author about the same time .",
    "in analogy with theorem  [ ns ] we have    the number of unnormalized representations of @xmath1 in a pisot numeration system @xmath576 is @xmath590-regular .",
    "it may be worth noting that the explicit constructions of automata we have given also imply bounds on the smallest example of ( or counterexample to ) the properties we consider .",
    "the bounds are essentially given by a tower of exponents whose height is related to the number of alternating quantifiers . for example ,    suppose @xmath7 and @xmath520 are @xmath0-automatic sequences generated by automata with at most @xmath454 states .",
    "if the set of factors of @xmath7 differs from the set of factors of @xmath520 , then there exists a factor of length at most @xmath591 that occurs in one word but not the other .",
    "we also note that a question left open in , regarding the description of the lexicographically least word in the orbit closure of the rudin - shapiro sequence , was recently solved by currie @xcite .",
    "finally , in a recent paper @xcite , the third author shows that additional properties of automatic sequences are deducible by expanding on the techniques in this paper .",
    "for example , the critical exponent is computable .",
    "we thank jean - paul allouche for his helpful comments .",
    "a.  frid .",
    "infinite permutations vs. infinite words . in p.",
    "ambroz , s.  holub , and z.  maskov , editors , _ words 2011 , 8th international conference_. elect .",
    "sci . , 2011 .",
    "available at http://arxiv.org/abs/1108.3616v1 .      c.  frougny and b.  solomyak . on representation of integers in linear numeration systems . in m.",
    "pollicott and k.  schmidt , editors , _ ergodic theory of @xmath592 actions ( warwick , 19931994 ) _ , vol .",
    "228 of _ london mathematical society lecture note series _ , pp . 345368 .",
    "cambridge university press , 1996 .",
    "v.  halava , t.  harju , t.  krki , and m.  rigo . on the periodicity of morphic words . in _ developments in language theory",
    "2010 _ , vol .",
    "6224 of _ lecture notes in computer science _ , pp . 209217 .",
    "springer - verlag , 2010 .",
    "j.  shallit .",
    "the critical exponent is computable for automatic sequences . in p.",
    "ambroz , s.  holub , and z.  maskov , editors , _ words 2011 , 8th international conference_. elect .",
    "sci . , 2011 .",
    "available at http://arxiv.org/abs/1104.2303v2 ."
  ],
  "abstract_text": [
    "<S> we show that various aspects of @xmath0-automatic sequences  such as having an unbordered factor of length @xmath1  are both decidable and effectively enumerable . as a consequence it follows that many related sequences are either @xmath0-automatic or @xmath0-regular . </S>",
    "<S> these include many sequences previously studied in the literature , such as the recurrence function , the appearance function , and the repetitivity index . </S>",
    "<S> we also give some new characterizations of the class of @xmath0-regular sequences . </S>",
    "<S> many results extend to other sequences defined in terms of pisot numeration systems .    </S>",
    "<S> [ theorem]open problem </S>"
  ]
}