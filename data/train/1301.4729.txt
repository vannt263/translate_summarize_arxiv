{
  "article_text": [
    "the amplify and forward ( af ) relay technique is useful in wireless systems for cost - effective throughput enhancement and coverage extension .",
    "it has attracted many research works recently .",
    "the optimization of the mimo ( multiple - input multiple - output ) af relay system has been well studied ( see the tutorial paper @xcite and the reference there in ) . the optimal relay precoding matrix was established in @xcite for a two - hop mimo relay system and the result was later extended to multi - hop mimo relay system in @xcite , where the optimal source and relay precoding matrices are shown to diagonalize the source - relay - destination channel .",
    "it was shown in @xcite that this diagonalization property also holds for power minimization of mimo af relay system under qos constraints .",
    "however , the power minimization problem is still difficult to solve due to its non - convex nature@xcite .",
    "a low complexity algorithm is proposed in @xcite to closely approximate the solution of this non - convex problem for the two - hop case .",
    "the source and relay power allocation problem of the multicarrier two - hop af relay system was studied in @xcite .",
    "all of the above works focus on the case with a single relay at each hop . in @xcite , the power minimization under qos constraints",
    "was addressed for a two - hop mimo relay system with multiple relays .",
    "there are also some works on the optimization of multiuser mimo af relay systems .",
    "for example , the multiuser mimo mac ( multiaccess channel ) af relay networks are addressed in @xcite , while the mimo bc ( broadcast channel ) af relay networks are investigated in @xcite . since the optimal structure of the source and relay precoding matrices is still unknown for multi - user mimo af relay networks , most of the algorithms in @xcite are based on standard optimization methods such as geometric programming @xcite and logarithmic barrier method @xcite . for mac / bc af relay networks with single - antenna source / destination nodes , two dualities with respect to a total network power constraint and per - hop power constraint",
    "have been established in @xcite .",
    "the results were later generalized to two - hop mimo mac / bc af relay networks @xcite and multi - hop mimo af relay systems @xcite . in some cases ,",
    "the duality can be used to simplify the network optimization problem , e.g. , some applications of the duality can be found in @xcite .    in this paper",
    ", we consider a generalized multi - hop mimo af relay network called the _ b - mac af relay network _ , which has multiple sources , multiple destinations and arbitrarily number of relays .",
    "the b - mac af relay network topology includes almost all the existing af relay networks as special cases and the optimization of such general network has not been addressed in the literature .",
    "we derive structural properties of the optimization problem ( _ duality _ and _ polite water - filling ( pwf ) _ ) and exploit the duality and pwf structure to design efficient source and relay precoding algorithms for general b - mac af relay networks . for the special case of the single - hop _ b - mac interference network _",
    "( b - mac ifn ) , the duality and pwf results have been established in @xcite . however , due to the key difference in topology ( single - hop versus multi - hop ) , there are various technical challenges and we can not extend the existing results and algorithms trivially from @xcite . specifically , due to the multi - hop topology , the achievable rate is a complicated function of the input covariance and relay precoding matrices .",
    "this makes both the proof of dualities and the optimization of b - mac af relay networks much more challenging than the previous works with simpler network topology .",
    "furthermore , the optimization constraints in the multi - hop b - mac af relay network is more complicated than that in b - mac ifn . for example , the _ per - hop power constraint _ and _ per - relay power constraint _ are two practically important constraints that only occur in the multi - hop network topology .",
    "we propose several new techniques to solve these challenges .",
    "the main contributions are listed below .    *",
    "* structural properties ( duality ) of mimo af relay network optimization : * we show that the achievable regions of a b - mac af relay network and its dual are the same under _ single network linear constraint _",
    "( type i duality ) or _ per - hop linear constraint _",
    "( type ii duality ) .",
    "we also derive explicit _ dual transformations _ to calculate the dual input covariance and relay precoding matrices .",
    "it is difficult to use the brute force computation approach in @xcite to prove the duality for general b - mac af relay networks .",
    "we propose two new techniques , namely the _ network equivalence _ and the _ network dual scaling _",
    "technique , to prove the type i and type ii dualities .",
    "the proof is not only simpler but also reveals more insight on the duality structure .",
    "the duality and the network equivalence results are useful for mimo precoder optimization in b - mac af relay networks .",
    "first , they are used in section [ sub : pwf_structure ] to derive the pwf structure of the optimal input covariance matrices , which can be exploited to design efficient input covariance optimization algorithm as illustrated in section [ sub : polite - water - filling - based ] .",
    "second , the duality is used in section [ sub : algmacbc ] and [ sub : algorithm - for - multi - hop ] to simplify the optimization of relay precoding matrices in bc af relay networks .",
    "* * efficient mimo precoder optimization algorithm for af relay networks : * based on the duality structure established above , we propose efficient algorithms for mimo precoder optimization in general mimo af relay networks .",
    "since the duality is only established for single network / per - hop linear constraint , we can not directly exploit the duality structure to handle general power constraints such as per - relay power constraint . to solve this problem",
    ", we propose a unified optimization framework to find a stationary point for an important class of b - mac af relay network optimization problems .",
    "in such a framework , we only need to design a primal algorithm to find a stationary point for the _ unconstrained _ inner loop problem of maximizing the lagrangian . using the network equivalence and duality results",
    ", we then show that at a stationary point of the inner loop problem , the input covariances have the pwf structure , which is a generalization of the pwf structure in b - mac ifn @xcite to the b - mac af relay network .",
    "finally , we propose several efficient primal algorithms based on duality and pwf structure for two - hop , three - hop , and multi - hop af relay networks .",
    "the proposed algorithms have significant advantages w.r.t .",
    "conventional step - size based iterative algorithms ( such as the gradient ascent method @xcite and the logarithmic barrier algorithms in @xcite ) in terms of complexity and convergence speed .",
    "it can also be used to solve a more general class of problems than the existing af relay network optimization algorithms in @xcite .",
    "the rest of the paper is organized as follows .",
    "section [ sec : system model ] describes the system model , the achievable scheme and the preliminary results on rate duality for b - mac ifn .",
    "section [ sec : duality - results ] presents the main results on the two types of dualities for multi - hop b - mac af relay networks . in section [ sec : applications - on - network ] , the duality is applied to study the non - convex optimization of b - mac af relay networks . a unified optimization framework together with several primal algorithms",
    "are proposed to find a stationary point for an important class of b - mac af relay network optimization problems .",
    "the performance of the proposed algorithms is verified by simulation in section [ sec : simulation - results ] .",
    "section [ sec : conlusion ] concludes .",
    "a _ b - mac af relay network _ is a general multi - hop af relay network with multiple sources ( transmitters ) , multiple destinations ( receivers ) and @xmath0 relay clusters as illustrated in fig .",
    "[ fig : b - mac_relay ] .",
    "each relay cluster can have multiple relays .",
    "each node can have multiple antennas .",
    "we follow the widely used orthogonal assumption @xcite :    [ asm : ifhop]due to propagation loss and proper channel reuse , the node in the @xmath1 cluster only receive the signals from the @xmath2 cluster , where the sources and destinations are considered as the @xmath3 and @xmath4 cluster respectively .",
    "we consider @xmath5 data links between the sources and destinations .",
    "each source can have independent data for different destinations , and each destination may want independent data from different sources . assume the    sources are labeled by elements in @xmath6 and the destinations are labeled by elements in @xmath7 .",
    "define @xmath8 ( @xmath9 ) as the label of the source ( destination ) of the @xmath10 data link .",
    "the numbers of antennas at @xmath8 and @xmath9 are @xmath11 and @xmath12 respectively .",
    "the total number of antennas at the @xmath1 relay cluster is @xmath13 .",
    "an example of b - mac af relay network is illustrated in fig .",
    "[ fig : b - mac_relay ] .",
    "there are 2 sources , 2 destinations , and 3 data links , of which @xmath14 , @xmath15 , @xmath16 , @xmath17 , @xmath18 , and @xmath19 .",
    "the figure also illustrates how to properly allocate sub - channels to achieve the orthogonality among different hops . in fig .",
    "[ fig : b - mac_relay ] , we assume that due to path loss , the aggregate interference from the nodes which are @xmath20 or more hops away from the receiver is negligible .",
    "hence we can avoid interference among the transmissions of different hops by dividing the whole bandwidth into @xmath21 orthogonal sub - channels and allocating different sub - channels to adjacent clusters .    for convenience",
    ", we use link based notation for signals . denote @xmath22 the channel matrix between source @xmath8 and the first relay cluster , @xmath23 the overall channel matrix between the @xmath1 and @xmath24 relay cluster , and @xmath25 the channel matrix between the @xmath26 relay cluster and destination @xmath9 .",
    "let @xmath27 denote the transmit signal of link @xmath28    and assume it is a circularly symmetric complex gaussian ( cscg ) vector with covariance @xmath29 .",
    "let @xmath30 denote the overall cscg noise vector at the @xmath1 relay cluster with covariance @xmath31 .",
    "then    the composite received signal at the first relay cluster is @xmath32 .",
    "the @xmath33 relay in the @xmath1 cluster applies linear transformation @xmath34 to the received signal and the resulting composite transmit signal from the @xmath1 relay cluster is @xmath35 , where @xmath36\\in\\mathbb{c}^{l_{q}\\times l_{q}}$ ] is the composite relay precoding matrix , @xmath37 is the number of relays in the @xmath1 relay cluster , and @xmath38 is the composite received signal at the @xmath1 relay cluster . for convenience ,",
    "define @xmath39    then    using induction , it can be shown that the received signal at @xmath9 is    @xmath40    where @xmath41 is the cscg noise vector at @xmath9 with covariance @xmath42 .",
    "as an example , the equivalent channel model for the b - mac af relay network in fig .",
    "[ fig : b - mac_relay ] is illustrated in the lower sub - figure .",
    "we consider a centralized optimization scheme in which a central node computes all the input covariance and relay precoding matrices and then transmits them to the source and relay nodes .",
    "[ asm : csi]the central node has the knowledge of the global channel state information ( csi ) @xmath43 s",
    "@xmath44 s and @xmath45 s .    in two - hop af relay systems , both the source - relay and relay - destination channels can be estimated directly at the destination node by transmitting pilot signals @xcite . however , acquiring global csi in multi - user multi - hop af relay networks is difficult and requires further study . in this paper ,",
    "our main focus is to understand the first order optimization problem and solution properties in multi - user multi - hop af networks .",
    "an interesting future work is to study efficient decentralized solution which does not require global csi knowledge .",
    "the centralized solution in this paper provides the basis for studying the decentralized solutions .    for fixed relay precoding matrix @xmath46 s",
    ", the source nodes and destinations see an equivalent channel in ( [ eq : recvsignal ] ) , which is essentially a b - mac ifn studied in @xcite .",
    "therefore , we can adopt the same set of transmit / receive schemes as in @xcite .",
    "[ asm : txrxscheme]@xmath47    1 .",
    "the transmit signal is cscg .",
    "each signal is decoded by no more than one destination and can be cancelled at this destination for the decoding of other signals .",
    "the interference among the source - destination pairs can be specified by some binary coupling matrix @xmath48 .",
    "that is , @xmath49 , after ( possible ) interference cancellation , the interference from @xmath50 to @xmath51 is given by @xmath52 , where @xmath53 is the @xmath54 element of @xmath55 . because @xmath56 , each interference is either completely cancelled or treated as noise .",
    "the set of allowed transmit / receive schemes includes most interference management techniques as special cases , such as spatial interference reduction through beamforming , dirty paper coding ( dpc ) @xcite at sources and successive interference cancellation ( sic ) at destinations @xcite .",
    "for example , in the b - mac af relay network in fig .",
    "[ fig : b - mac_relay ] , suppose dpc is used at @xmath57 with @xmath58 encoded after @xmath59 , and sic is used at @xmath60 with @xmath61 decoded after @xmath59",
    ". then @xmath62 , @xmath63 , @xmath64 and @xmath65 are 1 and all other elements of @xmath55 are 0 .    for given input covariance matrices @xmath66 and relay precoding matrices @xmath67 , the covariance matrix of the transmit signal at the @xmath1 relay cluster is @xmath68 the interference - plus - noise covariance at @xmath9 is @xmath69 where @xmath70 and @xmath71 the achievable rate of the @xmath10 data link is @xcite @xmath72 on which the achievable regions in this paper are based .",
    "we consider two types of linear constraints : define the _ single network linear constraint _ as @xmath73 where @xmath74 and @xmath75 are positive semidefinite ; the _ _ _ per - hop linear constraint _ is defined as @xmath76    the above linear constraints are more general than the sum / individual power constraints considered in @xcite .",
    "the per - hop linear constraint is more relevant to practical systems . however , single network linear constraint is also important in practice because it can be used to handle the more general multiple linear constraints using lagrange multiplier method as will be shown in section [ sec : applications - on - network ] .",
    "[ dual of a b - mac af relay network][def : dualnetdef ] the dual of a b - mac af relay network is obtained by the following operations .",
    "1 ) reverse the transmission directions , i.e. , in the dual network , @xmath9 s become the sources , @xmath8 s become the destinations , and the transmit signal of @xmath9 travels through the @xmath26 relay cluster , the @xmath77 relay cluster , ... , the @xmath78 relay cluster , and finally reaches the destination @xmath79 2 ) replace all the channel matrices by their conjugate transposes , i.e. , the channel matrix between source @xmath9 and the @xmath26 relay cluster is @xmath80 , the channel matrix between the @xmath81 relay cluster and the @xmath1 relay cluster is @xmath82 , and the channel matrix between the @xmath78 relay cluster and destination @xmath8 is @xmath83 .",
    "3 ) in the dual network , the covariance of the noise at the @xmath1 relay cluster is set as @xmath75 and the covariance of the noise at the destination @xmath8 is set as @xmath74 , where @xmath75 s and @xmath74 s are the linear constraint matrices in ( [ eq : defsnlc ] ) of the original network .",
    "4 ) the coupling matrix for the dual network is set as the transpose of that for the original network , i.e. , @xmath84 .    as an example , the dual of the b - mac af relay network in fig .",
    "[ fig : b - mac_relay ] is illustrated in fig .",
    "[ fig : b - mac_relay_dual ] .",
    "we use the notation @xmath85 to denote the terms in the dual network . given input covariance matrices @xmath86 at the sources and relay precoding matrices @xmath87 at the relays , the covariance matrix of the transmit signal at the @xmath1 relay cluster is @xmath88 where @xmath89 the interference - plus - noise covariance at @xmath8 is @xmath90 where @xmath91 .",
    "hence , the achievable rate of the @xmath10 data link in the dual network is @xcite @xmath92 similarly , in the dual network , the two types of linear constraints are defined as @xmath93 @xmath94      the proof of the duality results in this paper relies on the rate duality for b - mac ifn @xcite , which is a special case of the b - mac af relay network when @xmath95 .",
    "let @xmath96,{\\textstyle \\sum_{l=1}^{l}}\\textrm{tr}\\left(\\mathbf{\\sigma}_{l}\\hat{\\mathbf{w}}_{l}\\right)\\leq p_{t},\\left[\\mathbf{w}_{l}\\right]\\right),\\label{eq : net - color - linear - constraint}\\ ] ] denote a b - mac ifn where the channel matrix between @xmath97 and @xmath9 is @xmath98 ; the input covariance satisfies @xmath99 ; the noise covariance at @xmath9 is @xmath100 . for fixed coupling matrix @xmath55 ,",
    "the interference - plus - noise covariance and the rate of link @xmath101 is given by @xmath102 and @xmath103 respectively . by definition , the dual network or _",
    "reverse links _",
    "is @xmath104,{\\textstyle \\sum_{l=1}^{l}}\\textrm{tr}\\left(\\hat{\\mathbf{\\sigma}}_{l}\\mathbf{w}_{l}\\right)\\leq p_{t},\\left[\\hat{\\mathbf{w}}_{l}\\right]\\right).\\label{eq : net - forward - color - dual}\\ ] ] the interference - plus - noise covariance and the rate of reverse link @xmath101 is given by @xmath105 and @xmath106 respectively .    the key of the rate duality is a _ covariance transformation _",
    "@xcite defined as follows .",
    "[ covariance transformation for b - mac ifn][def : the - covariance - transformation ] the covariance transformation of the input covariance @xmath107 for a b - mac ifn with parameters @xmath108,\\left[\\mathbf{w}_{l}\\right],\\left[\\hat{\\mathbf{w}}_{l}\\right]\\right\\ } $ ] as in ( [ eq : net - color - linear - constraint ] ) is defined by 4 steps .",
    "* step * 1 : decompose the signal of each link @xmath101 to @xmath109 streams as @xmath110 where @xmath111 is a transmit vector with @xmath112 and @xmath113 s are the transmit powers .",
    "* step * 2 : @xmath114 , compute the mmse - sic receive vector as @xcite @xmath115 where @xmath116 is chosen such that @xmath117 .",
    "calculate the sinr @xmath118 as a function of @xmath119 @xcite .",
    "* step * 3 : in the reverse links , use @xmath120 as transmit vectors and @xmath121 as receive vectors .",
    "apply the sinr duality @xcite to obtain the reverse transmit powers @xmath122^{t}$ ] : @xmath123 where @xmath124 and the @xmath125 row and @xmath126 column of @xmath127 is @xmath128 @xmath129 is a diagonal matrix with the @xmath130 diagonal element given by     @xmath131 @xmath132^{t}$ ] with @xmath133 .",
    "* step * 4 : the _ _ covariance transformation _ _ from @xmath107 to @xmath134 is     @xmath135    we restate the rate duality in @xcite as follows .",
    "[ rate duality for b - mac ifn][thm : linear - color - dual ] for any @xmath107 satisfying @xmath99 and achieving a rate point @xmath136 in the network ( [ eq : net - color - linear - constraint ] ) , its covariance transformation @xmath137 achieves a rate point @xmath138 in the dual network ( [ eq : net - forward - color - dual ] ) and satisfies @xmath139 .",
    "thus , the achievable regions    in the forward and reverse links are the same under a single linear constraint .",
    "in this section , we establish two types of duality for multi - hop b - mac af relay network respectively under single network linear constraint and per - hop linear constraint .      the type i duality can be established using the following _ network equivalence _ result .",
    "[ network equivalence][thm : network - equivalence]fixing the relay precoding matrices @xmath140 , the b - mac af relay network in section [ sub : b - mac - af - relay ] under constraint ( [ eq : defsnlc ] ) is equivalent to the following b - mac ifn @xmath141,{\\textstyle \\sum_{l=1}^{l}}\\textrm{tr}\\left(\\mathbf{\\sigma}_{l}\\hat{\\mathbf{w}}_{l}^{'}\\right)\\leq p_{t}-p_{c},\\left[\\mathbf{w}_{l}^{'}\\right]\\right),\\label{eq : equibmac}\\ ] ] where @xmath142 is defined in ( [ eq : ehlk ] ) , @xmath143 is defined in ( [ eq : wlp ] ) , and @xmath144 similarly , fixing the dual relay precoding matrices @xmath145 , the dual b - mac af relay network in definition [ def : dualnetdef ] under constraint ( [ eq : defdualsnlc ] ) is equivalent to the dual network of ( [ eq : equibmac ] ) given by @xmath146,{\\textstyle \\sum_{l=1}^{l}}\\textrm{tr}\\left(\\hat{\\mathbf{\\sigma}}_{l}\\mathbf{w}_{l}^{'}\\right)\\leq p_{t}-p_{c},\\left[\\hat{\\mathbf{w}}_{l}^{'}\\right]\\right).\\label{eq : dual_equibmac}\\ ] ]    please refer to appendix [ sub : proof - of - theoremne ] for the proof .",
    "define the _ type i dual transformation _ as follows .",
    "[ type i dual transformation][def : typeitf ] for any input covariance and relay precoding matrices @xmath147 , let @xmath134 be the covariance transformation of @xmath107 in definition [ def : the - covariance - transformation ] with parameters @xmath148,\\left[\\mathbf{w}_{l}^{'}\\right],\\left[\\hat{\\mathbf{w}}_{l}^{'}\\right]\\right\\ } $ ] .",
    "then @xmath134 and @xmath149 is called the _",
    "type i dual transformation _ of @xmath147 .",
    "then it follows from theorem [ thm : linear - color - dual ] and [ thm : network - equivalence ] that the following theorem holds .",
    "[ type i duality][thm : typeiduality]for any input covariance and relay precoding matrices @xmath147 satisfying @xmath150 and achieving a rate point @xmath136 in a b - mac af relay network , its type i dual transformation @xmath151 achieves a rate point @xmath138 in the dual network and satisfy @xmath152 .",
    "thus , the achievable regions in a b - mac af relay network under constraint ( [ eq : defsnlc ] ) and that in the dual network under constraint ( [ eq : defdualsnlc ] ) are the same .      type ii duality can be proved from type i duality using the conception of _ network dual scaling_.    [ scaled dual network]a scaled dual network with scaling vector @xmath153^{t}$ ] , where @xmath154 and @xmath155 , is obtained by scaling the covariance of the noise vectors in the dual network defined in section [ sub : the - dual - network ] as follows : the covariance of the noise at the @xmath1 relay cluster is scaled to be @xmath156 , and the covariance of the noise at the destination @xmath8 is scaled to be @xmath157 . furthermore , the relay precoding matrices is given by @xmath145 .",
    "the following corollary follows immediately from theorem [ thm : typeiduality ] .",
    "[ duality for scaled dual network][cor : scalednet ] for any input covariance and relay precoding matrices @xmath147 achieving a rate point @xmath136 in a b - mac af relay network , let @xmath158 be the covariance transformation of @xmath107 obtained by definition [ def : the - covariance - transformation ] with parameters @xmath148,\\left[\\mathbf{w}_{l}^{'}\\right],\\left[\\hat{\\mathbf{w}}_{l}^{'}\\left(\\mathbf{d}\\right)\\right]\\right\\ } $ ] , where @xmath159 then @xmath158 and @xmath145 achieves a rate point @xmath138 in the scaled dual network with scaling vector @xmath160 and satisfy the constraint @xmath161 where @xmath162    another theorem is needed to prove the type ii duality .",
    "obtain @xmath121 , @xmath120 , @xmath127 and @xmath163 using ( [ eq : decomsig ] ) , ( [ eq : mmserev1 g ] ) , ( [ eq : faig ] ) and ( [ eq : dg ] ) in definition [ def : the - covariance - transformation ] with parameters @xmath148,\\left[\\mathbf{w}_{l}^{'}\\right],\\left[\\hat{\\mathbf{w}}_{l}^{'}\\right]\\right\\ } $ ] .",
    "define @xmath164 where @xmath165^{t}$ ] and @xmath114 , @xmath166 @xmath167^{t}$ ] and @xmath114 , @xmath168 define @xmath169 whose @xmath170 element is @xmath171    [ network dual scaling][thm : network - dual - scaling]consider the following eigensystem @xmath172 where @xmath173 is the dominant eigenvector and @xmath174 is the maximum eigenvalue of @xmath175 .",
    "then @xmath174 and @xmath173 must be strictly positive .",
    "let @xmath176 $ ] be the dominant eigenvector of @xmath175 with the last component scaled to one .",
    "then in the scaled dual network with scaling vector @xmath177 , @xmath178 defined in corollary [ cor : scalednet ] and @xmath145 satisfies @xmath179    the proof is given in appendix [ sub : proof - of - theorem_nds ] .",
    "define the _ type ii dual transformation _ as follows .",
    "[ type ii dual transformation]for any input covariance and relay precoding matrices @xmath180 , let @xmath181 be the covariance transformation of @xmath107 in definition [ def : the - covariance - transformation ] with parameters @xmath148,\\left[\\mathbf{w}_{l}^{'}\\right],\\left[\\hat{\\mathbf{w}}_{l}^{'}\\left(\\mathbf{\\tilde{d}}\\right)\\right]\\right\\ } $ ] , where @xmath176 $ ] is the dominant eigenvector of the eigensystem in ( [ eq : keyeigensys ] )",
    ". then @xmath134 and the dual relay precoding matrices @xmath182 , where @xmath183 , @xmath184 , is called the _ type ii dual transformation _ of @xmath180 .",
    "for the same input covariance @xmath181 , the rate point in the scaled dual network with scaling vector @xmath177 and relay precoding matrices @xmath185 is equal to that in the original dual network with relay precoding matrices @xmath186 .",
    "furthermore , it follows from ( [ eq : indlconsdualtx ] ) that the type ii dual transformation @xmath187 satisfies ( [ eq : defdualilc ] ) . combining the above and corollary [ cor : scalednet ] ,",
    "the following theorem is proved .",
    "[ type ii duality][thm : typeiiduality]for any input covariance and relay precoding matrices @xmath180 satisfying @xmath188 @xmath189 , and achieving a rate point @xmath136 in the b - mac af relay network defined in section [ sub : b - mac - af - relay ] , its type ii dual transformation @xmath187 achieves a rate point @xmath138 in the dual network and satisfy @xmath190 @xmath191 .",
    "thus , the achievable regions in a b - mac af relay network under constraint ( [ eq : defilc ] ) and that in the dual network under constraint ( [ eq : defdualilc ] ) are the same .    [ generality of type i / ii duality][rem : generality - of - typei_ii]the previous duality results for various special cases are compared to illustrate the generality of the type i / ii duality . in @xcite and @xcite ,",
    "the duality was established respectively for multi - hop mac / bc af relay networks with single - antenna source / destination nodes and two - hop mimo mac / bc af relay networks .",
    "however , the approach in @xcite can not be easily extended to the general b - mac af relay network . * * the duality for multi - hop mimo af relay system was established in @xcite .",
    "although the proof can be extended to multi - user af relay networks by using block diagonal precoding / receiving matrices and the notion of independent streams , the duality in [ 3 ] can not cover the duality in this paper as elaborated below .",
    "\\1 ) the b - mac af relay network is not captured by the system model in @xcite . in @xcite , there are @xmath192 independent data streams in one transmission .",
    "similar to the coupling matrix defined in assumption [ asm : txrxscheme ] , we can use a binary _ inter - stream coupling matrix _",
    "@xmath193 to specify the interference among the data streams . in @xcite",
    ", @xmath194 can only have two forms : a ) if linear transceivers are used at the source and destination nodes , all the diagonal elements of @xmath194 are zero , and all the off - diagonal elements of @xmath194 are one ; b ) if non - linear transceivers are used , @xmath194 is a triangular matrix .",
    "however , for general b - mac af relay networks , if we decompose the equivalent mimo links into independent data streams , the inter - stream coupling matrix @xmath194 can be any binary matrix with zero diagonal elements .",
    "\\2 ) explicit dual transformations are not part of @xcite for the multi - user case with general inter - stream coupling matrix @xmath194 .",
    "the dual transformation between the dpc - based and sic - based mimo af relay systems in @xcite can not be generalized to b - mac af relay networks because the matrix `` @xmath55 '' in ( 14 ) of @xcite is no longer upper - triangle .    furthermore",
    ", the above special cases consider power constraints only . by using the techniques of _ network equivalence _ and _ network dual scaling _ , we are able to establish the dualities and explicit dual transformations for b - mac af relay networks under more general linear constraints .",
    "the duality proof based on these new techniques is not only simpler but also reveals more insight on the duality structure that can be exploited to design mimo precoder optimization algorithms as shown in the next section .",
    "we propose an unified optimization framework to find a stationary point for a class of af relay network optimization problems based on the local lagrange dual method ( ldm ) @xcite , where the _ primal algorithm _ only finds a stationary point for the inner loop problem of maximizing the lagrangian .",
    "the duality is first used to characterize the pwf structure of the input covariance matrices at a stationary point .",
    "then the duality and pwf are exploited to design efficient primal algorithm for general _ b - mac _ af relay networks and structured primal algorithms for _ bc _ af relay network .",
    "a general optimization problem in a b - mac af relay network can be expressed as @xmath195 where @xmath196 and @xmath197 are real valued functions of @xmath180 . in this paper",
    ", we consider a class of problems whose lagrangian can be written in the following form @xmath198 where @xmath199_{n=1, ... ,n}$ ] are lagrange multipliers , @xmath200 are positive semidefinite , @xmath201 are positive definite , and @xmath202 . the lagrangian of many important optimization problems can be written in the form of ( [ eq : lag ] ) .",
    "two typical problems are listed below .",
    "p1 : maximize the weighted sum - rate under multiple linear constraints : @xmath203 where @xmath204 , @xmath205 s and @xmath206 s are positive semidefinite and @xmath207 .",
    "p2 : minimize a single linear cost under individual rate constraints : @xmath208 where @xmath209 is the rate constraint for the @xmath10 data link .",
    "[ per - relay power constraint]the multiple linear constraints in p1 include the per - relay power constraint as special cases .",
    "let @xmath37 denote the number of relays in the @xmath1 relay cluster , and let @xmath210 denote the number of antennas at the @xmath33 relay of the @xmath1 relay cluster .",
    "then the power constraint @xmath211 for the @xmath33 relay in the @xmath1 relay cluster can be expressed in the form of the general multiple linear constraints in p1 as @xmath212 by setting @xmath213 , @xmath214 , @xmath215 , and @xmath216 $ ] , where @xmath217 is an @xmath218 identity matrix and @xmath219 is an @xmath220 zero matrix .",
    "it is well known that the problems in ( [ eq : p1 ] ) and ( [ eq : p2 ] ) are usually non - convex problems with non - zero duality gap .",
    "hence , the standard lagrange dual method ( ldm ) @xcite can not be used to solve these problems . in @xcite",
    ", we proposed a _ local ldm _ to find a stationary point for a non - convex problem .",
    "we apply the local ldm to obtain the following algorithm for problem ( [ eq : generalpf ] ) .",
    "_ algorithm lldm _",
    "( for finding a stationary point of problem ( [ eq : generalpf ] ) ) :    * * initialization * * : choose initial @xmath221 such that @xmath222 .",
    "let @xmath223 .",
    "* * step 1 * * ( primal update in the inner loop ) : for fixed @xmath224 , find a stationary point @xmath225 of @xmath226 using some primal algorithm with initial point is randomly generated .",
    "] @xmath227 .    * * step 2 * * ( dual update in the outer loop ) : update @xmath228 as @xmath229 where @xmath230 is the step size , and @xmath231 is the optimal solution of the following quadratic programming problem :     @xmath232 where @xmath233^{t}$ ] with @xmath234 , and @xmath235 is positive definite .    * return to step 1 until convergence . *",
    "@xmath236 is obtained by the well known bfgs update as follows @xcite @xmath237 @xmath238 the initial @xmath239 , where @xmath240 is the smallest positive integer such that @xmath241 , and @xmath242 $ ] is the optimal solution of the problem @xmath243 .",
    "set @xmath244 , where @xmath245 is an integer which is initialized as @xmath246 and is incremented until one of the following conditions is satisfied : 1 ) @xmath247 .",
    "2 ) @xmath248 , where @xmath249 is a small positive integer , e.g. , we let @xmath250 in the simulations .",
    "3 ) @xmath251 , where @xmath252 is defined as the _ _ residual error _ _ after the @xmath253 iteration .",
    "finally , @xmath254 is given by @xmath255 where @xmath256 , @xmath257 and are set as @xmath258 in the simulations .",
    "algorithm lldm converges to a stationary point of problem ( [ eq : generalpf ] ) under mild conditions @xcite . in the subsequent sections ,",
    "we first characterize the pwf structure at a stationary point of problem ( [ eq : mainpro ] )",
    ". then we design several efficient primal algorithms based on the pwf and duality .      at any stationary point of problem ( [ eq : mainpro ] ) with fixed relay precoding matrices @xmath140 , the input covariance matrices @xmath107 must satisfy a pwf structure as stated in the following corollary .",
    "[ pwf for fixed relay precoding][cor : pwf_mlc ] let @xmath259 be a stationary point of problem ( [ eq : mainpro ] ) with fixed @xmath140 , i.e. , @xmath259 satisfies the following kkt conditions @xmath260 then the type i dual transformation of @xmath261 is @xmath262 , where @xmath263 with @xmath264 obtain the interference - plus - noise covariance matrices @xmath265 s from ( [ eq : whitemg ] ) using @xmath261 and the dual ones @xmath266 s from ( [ eq : whitemg-1 ] ) using @xmath267 . for each @xmath101 , create an equivalent channel : @xmath268 .",
    "perform the thin svd @xmath269 , where @xmath270 , and @xmath271 .",
    "then , @xmath259 must have a polite water - filling structure , i.e. , @xmath272 furthermore , @xmath273 also possesses the polite water - filling structure , i.e. , @xmath274 on the other hand , if certain @xmath107 has the above polite water - filling structure for a given @xmath140 , it must be a stationary point of problem ( [ eq : mainpro ] ) for this fixed @xmath140 .",
    "corollary [ cor : pwf_mlc ] follows straightforward from the pwf results for b - mac ifn in theorem 3 of @xcite and the network equivalence result in theorem [ thm : network - equivalence ] . the detailed proof is omitted due to limited space .    in some cases , better",
    "algorithms can be designed by considering the following _ dual network problem_.    [ dual network problem]the _ dual network problem _ of ( [ eq : mainpro ] ) is defined as @xmath275    [ equivalence of problem ( [ eq : mainpro ] ) and its dual][thm : dualnetpro ] for any stationary point @xmath276 of dual network problem ( [ eq : mainpro_dual ] ) , its type i dual transformation @xmath277 must also be a stationary point of problem ( [ eq : mainpro ] )",
    ".    please refer to appendix [ sub : proof - of - theoremdualpro ] for the proof .",
    "we present several primal algorithms for two - hop b - mac af relay networks . in this case , the relay precoding matrices is @xmath278 $ ] , where @xmath279 is the relay precoding matrix at the @xmath33 relay , @xmath280 is the number of antennas at the @xmath33 relay , and @xmath281 is the number of relays .      the gradient ascent ( ga ) algorithm with the step size determined by armijo rule @xcite can be used to find a stationary point of problem ( [ eq : mainpro ] ) as summarized in table [ tab : alggp ] . in algorithm",
    "ga , the gradient update for source node is performed over the precoding matrices @xmath282 s , where @xmath283 . for convenience , we group the gradients over @xmath284 as a block diagonal matrix @xmath285 $ ] .",
    "then the gradients required in algorithm ga are given by @xcite @xmath286 @xmath287\\circ\\nabla_{\\mathbf{f}}l_{\\lambda}\\left(\\mathbf{\\sigma},\\mathbf{f}\\right),\\label{eq : gradf}\\ ] ] where @xmath288 ; the notation @xmath289 denotes the pointwise product of two matrices ; @xmath290 is an @xmath291 matrix of which all the elements are ones ; and @xmath292 is given by @xmath293 where @xmath294 @xmath295 , and @xmath296 .",
    ".[tab : alggp]algorithm ga ( gradient ascent method for finding a stationary point of problem ( [ eq : mainpro ] ) ) [ cols= \" < \" , ]      consider sum rate maximization under multiple linear constraints ( i.e. , problem ( [ eq : p1 ] ) with @xmath297 ) in a two - hop bc af relay network applying dpc .",
    "we apply the duality and corollary [ cor : pwf_mlc ] to design a structured primal algorithm to find a stationary point of the inner loop problem ( [ eq : mainpro ] ) for this special case .",
    "note that in this case , @xmath298 , @xmath299 are the same , and @xmath200 are the same . for convenience ,",
    "let @xmath300,\\mathbf{w}_{\\textrm{b}}^{\\textrm{r}},\\left[\\mathbf{w}_{\\textrm{b}}^{l}\\right],\\mathbf{\\hat{w}}_{\\textrm{b}},\\mathbf{\\hat{w}}_{\\textrm{b}}^{\\textrm{r}}\\right),\\label{eq : bcrelay}\\ ] ] denote a two - hop bc af relay network where the channel matrix between source and relay is @xmath301 , the channel matrix between relay and the @xmath10 destination is @xmath302 , the covariance of the noise at the relay is @xmath303 , the covariance of the noise at the @xmath10 destination is @xmath304 , and the constraint matrices in lagrangian ( [ eq : lag ] ) is @xmath305 , @xmath306 .",
    "the dual network of ( [ eq : bcrelay ] ) is @xmath307,\\mathbf{h}_{\\textrm{m}},\\mathbf{w}_{\\textrm{m}}^{\\textrm{r}},\\mathbf{w}_{\\textrm{m}},\\left[\\mathbf{\\hat{w}}_{\\textrm{m}}^{l}\\right],\\mathbf{\\hat{w}}_{\\textrm{m}}^{\\textrm{r}}\\right),\\label{eq : macrelay}\\ ] ] which is a two - hop mac af relay network where the channel matrix between the @xmath10 source and relay is @xmath308 , the channel matrix between relay and the destination is @xmath309 , the covariance of the noise at the relay is @xmath310 , the covariance of the noise at the @xmath10 destination is @xmath311 , and the constraint matrices in lagrangian ( [ eq : lag ] ) is @xmath312 , @xmath313 . by theorem [ thm :",
    "dualnetpro ] , problem ( [ eq : mainpro ] ) for the bc relay network ( [ eq : bcrelay ] ) can be equivalently solved by solving the dual network problem ( [ eq : mainpro_dual ] ) , whose objective function , in this special case , is given by @xmath314 where @xmath315 .    by exploiting the specific structure of @xmath316 , we propose an improved algorithm over pwf .",
    "_ algorithm pwfi _ :    * * initialization * * : choose proper initial @xmath187 such that @xmath317 .",
    "* step * 1 : for fixed @xmath318 and @xmath319 , problem ( [ eq : mainpro_dual ] ) reduces to the single - user optimization problem : @xmath320 where @xmath321 , @xmath322 , and @xmath323 .",
    "applying corollary [ cor : pwf_mlc ] to the single - user optimization problem in ( [ eq : maxlagl ] ) , the optimal solution is given by @xmath324 where @xmath325 and @xmath326 are obtained by performing the thin svd @xmath327 .",
    "update each @xmath328 for once using ( [ eq : gwfsolution ] ) when fixing @xmath318 and @xmath319 .    * * step 2 * * : for fixed @xmath329 , @xmath318 is updated by solving @xmath330 , which is equivalent to the following problem @xmath331 where @xmath332 , @xmath333 and @xmath334 .",
    "define @xmath335 .",
    "perform the svd @xmath336 and the eigenvalue decomposition @xmath337 .",
    "let @xmath338 denote the @xmath339 largest singular values of @xmath340 with descending order and @xmath341 denote the semi - unitary matrix formed by the singular vectors corresponding to @xmath342 s .",
    "let @xmath343 denote the @xmath339 largest eigenvalues of @xmath344 with descending order and @xmath345 denote the semi - unitary matrix formed by the eigenvectors corresponding to @xmath346 s .",
    "then the optimal @xmath347 is given by @xcite @xmath348 where @xmath349 with @xmath350 given by @xmath351^{+}.\\ ] ]    * return to step 1 until convergence .",
    "*    since the objective @xmath352 is upper bounded and is increased after each update , algorithm pwfi must converge to a fixed point @xmath353 .",
    "it can be shown that the fixed point @xmath353 must be a stationary point of the dual network problem ( [ eq : mainpro_dual ] ) .",
    "then by theorem [ thm : dualnetpro ] , the corresponding type i dual transformation @xmath277 is a stationary point of problem ( [ eq : mainpro ] ) in the bc relay network ( [ eq : bcrelay ] ) .",
    "algorithm ga / pwf can be easily extended to solve problem ( [ eq : mainpro ] ) for b - mac af relay networks with more than two hops .",
    "the only difference is that the gradient update of the relay precoding matrices is generalized to multi - hop case as @xmath354 where the gradient @xmath355 can be calculated similar to the one in ( [ eq : gradf ] ) .",
    "the duality can be used to simplify the the sum rate maximization under multiple linear constraints for a three - hop bc relay network .",
    "we design _",
    "algorithm pwf3 _ to find a stationary point of the inner - loop problem ( [ eq : mainpro ] ) for this special case , where @xmath356 , @xmath357 and @xmath358 .",
    "algorithm pwf3 switches the optimization between the original network and the dual network so that at each time , we only need to consider a two - hop network optimization problem solved in section [ sub : algmacbc ] .",
    "_ _ algorithm pwf__3 :    * * initialization * * : choose proper initial @xmath359 such that @xmath360 .",
    "* * step 1 * * : for fixed @xmath361 , the inner loop problem reduces to problem ( [ eq : mainpro ] ) in the two - hop bc af relay network ( [ eq : bcrelay ] ) with @xmath362 , @xmath363 , @xmath364 , @xmath365 , @xmath366 and @xmath367 . obtain the input covariance and relay precoding matrices @xmath368 for the dual two - hop mac af relay network ( [ eq : macrelay ] ) by the type i dual transformation of @xmath369 applied to network ( [ eq : bcrelay ] ) .",
    "update each @xmath370 for once using ( [ eq : gwfsolution ] ) when fixing @xmath371 and @xmath372 . then update @xmath371 using ( [ eq : updatefhed ] ) for fixed @xmath373 . finally , obtain the updated @xmath369 by the type i dual transformation of @xmath374 applied to network ( [ eq : macrelay ] ) .    * * step 2 * * : obtain @xmath375 by the type i dual transformation of @xmath180 .    *",
    "* step 3 * * : for fixed @xmath376 , update @xmath377 by improving the objective value of the dual network problem ( [ eq : mainpro_dual ] ) , which reduces to problem ( [ eq : mainpro ] ) in the two - hop mac af relay network ( [ eq : macrelay ] ) with @xmath378 , @xmath379 , @xmath380 , @xmath381 , @xmath382 , and @xmath383 . treating @xmath377 as the input covariance and relay precoding matrices in network ( [ eq : macrelay ] ) , update @xmath377 using a single iteration of algorithm pwfi applied to network ( [ eq : macrelay ] ) .    * * step 4 * * : obtain @xmath180 by the type i dual transformation of @xmath375 .    * return to step 1 until convergence . *    using theorem [ thm : typeiduality ]",
    ", it can be shown that algorithm pwf3 monotonically increases the objective after each iteration and converges to a stationary point of problem ( [ eq : mainpro ] ) .",
    "[ rem : comppwfifc]for the special case of b - mac ifn , the duality and pwf have been established in @xcite . however , we can not extend the existing results and algorithms trivially from @xcite .",
    "we proposed new techniques , namely the network equivalence technique in theorem [ thm : network - equivalence ] , and the network dual scaling technique in theorem [ thm : network - dual - scaling ] , to generalize the duality and pwf to b - mac af relay networks .",
    "the proof of theorem [ thm : network - dual - scaling ] is non - trivial .",
    "the algorithm design also relies on the new network equivalence result .",
    "moreover , theorem [ thm : dualnetpro ] ( equivalence of problem ( [ eq : mainpro ] ) and its dual ) is non - trivial and can not be re - derived from our previous results in @xcite . based on theorem [ thm : dualnetpro ] , we proposed structured primal algorithms ( pwfi and pwf3 ) which are entirely different from the single - hop pwf algorithms in @xcite .",
    "block fading channel is assumed and each channel matrix has zero - mean i.i.d .",
    "gaussian entries with unit variance .",
    "the simulation results in all figures are averaged over 100 random channel realizations .",
    "the parameters of problem ( [ eq : mainpro ] ) are set as @xmath384 . for accuracy comparison ,",
    "define the _ convergence error _ as the sum of the norms of the gradients over @xmath140 and all @xmath282 s .",
    "convergence comparison for a two - hop mac af relay network , width=302 ]    convergence comparison for a two - hop mac af relay network , width=302 ]    we first demonstrate the advantages of algorithm pwf over ga described in section [ sub : baseline - algorithm-(gradient ] .",
    "consider the b - mac af relay network in fig .",
    "[ fig : b - mac_relay ] with @xmath298 ( two - hop ) , @xmath385 relay , and @xmath386 , @xmath387 antennas at each node . in fig .",
    "[ fig : twohop_bmac_af ] , we plot the average objective value and the convergence error versus the number of iterations .",
    "it can be observed that pwf has faster convergence speed than ga .",
    "it also achieves a higher objective value .",
    "the complexity order per iteration of pwf and ga is similar .",
    "however , the overall complexity of pwf is lower because it avoids the linear search for the gradient update of @xmath107 , and requires less iterations to achieve the same accuracy .    in fig .",
    "[ fig : twohop_mac_af ] , we compare the convergence of algorithm ga , pwf and pwfi for a two - hop mac relay network with @xmath388 sources , @xmath385 relay and @xmath389 , @xmath387 , @xmath390 antennas at each node .",
    "the results show that pwfi has the fastest convergence speed .",
    "pwfi also has the lowest complexity because it avoids the linear search in the gradient update .",
    "finally , we verify the convergence of algorithm pwf3 for a three - hop bc relay network with @xmath391 relay at each relay cluster , @xmath388 destinations and @xmath392 , @xmath393 , @xmath394 antennas at each node . fig .",
    "[ fig : threehop_bc_af ] plots the average objective value and _ objective error _ , defined as the gap ( in logarithmic scale ) from the stationary point that the algorithm converges to , versus the number of iterations .",
    "algorithm pwf3 quickly converges to a stationary point of problem ( [ eq : mainpro ] ) with high accuracy .",
    "average sum - rate / cpu time versus power constraint at relay for a two - hop bc af relay network , width=302,height=253 ]    average sum - rate / cpu time versus power constraint at relay for a two - hop bc af relay network , width=302 ]      average sum power / cpu time versus individual rate constraint for a two - hop mac af relay network , width=302 ]    average sum power / cpu time versus individual rate constraint for a two - hop mac af relay network , width=302 ]    in fig .",
    "[ fig : threehop_bc_af ] and [ fig : twohop_bc_lldm ] , we consider problem ( [ eq : p1 ] ) with @xmath297 ( i.e. , sum - rate maximization ) and illustrate the advantages of the proposed local ldm with duality - based primal algorithms ( i.e. , algorithm pwf or pwfi ) .",
    "the following baseline algorithms are compared .",
    "* baseline 1 ( algorithm 3 in @xcite ) : algorithm 3 in @xcite is based on logarithmic barrier method @xcite and is designed for sum - rate maximization under power constraints in two - hop bc relay networks . * baseline 2 ( logarithmic barrier algorithm ) : this is an extension of the algorithm 3 in @xcite to b - mac af relay networks using the logarithmic barrier method @xcite . *",
    "baseline 3 : local ldm with ga as the primal algorithm .",
    "we first evaluate the performance in a two - hop bc relay network with @xmath385 relay , @xmath388 destinations and @xmath392 , @xmath387 , @xmath394 antennas at each node .",
    "assume a sum power constraint at the source : @xmath395 , and a power constraint at the relay : @xmath396 . in fig .",
    "[ fig : twohop_bc_lldm ] , we plot the average sum - rate , and the cpu time required to achieve the same accuracy , versus the power constraint at relay @xmath397 .",
    "all algorithms achieve similar sum - rate .",
    "however , lldm with both pwf and pwfi clearly outperform the algorithm 3 in @xcite in terms of cpu time .    in fig .",
    "[ fig : twohop_bmac_af_ldm ] , we evaluate the sum - rate and cpu time performance in the b - mac af relay network in fig .",
    "[ fig : twohop_bmac_af ] with @xmath298 ( two - hop ) , @xmath398 relays , @xmath399 antennas at each relay , and @xmath386 antennas at each source / destination node .",
    "consider individual power constraints at each node : @xmath400 , @xmath401 , @xmath402\\right)\\leq p_{r}$ ] and @xmath403\\right)\\leq p_{r}$ ] .",
    "all algorithms achieve similar sum - rate .",
    "however , lldm with pwf requires the least cpu time .    in fig .",
    "[ fig : twohop_mac_af_qos ] , we consider problem ( [ eq : p2 ] ) with @xmath404 ( i.e. , sum power minimization ) , and @xmath405 for a two - hop mac relay network with @xmath406 sources , @xmath385 relay and @xmath389 , @xmath387 , @xmath390 antennas at each node .",
    "the proposed lldm with pwf is compared to baseline 3 and baseline 4 : algorithm 9 in @xcite ( joint search based on logarithmic barrier method ) .",
    "we plot the average sum power and the cpu time versus the individual rate constraint ( @xmath407 ) .",
    "all algorithms achieve similar sum power .",
    "however , lldm with pwf requires the least cpu time .",
    "we show that the achievable regions of a multi - hop mimo b - mac af relay network and its dual are the same under _ single network linear constraint _ or _ per - hop linear constraint_. two dual transformations are provided to calculate the dual input covariance and relay precoding matrices .",
    "these results include the dualities in @xcite as special cases .",
    "furthermore , our proof is simpler and reveals more structural property of the duality .",
    "based on the established duality structure , we propose efficient algorithms for mimo precoder optimization in b - mac af relay networks .",
    "first , a unified optimization framework is proposed based on the _ local lagrange dual method _ in @xcite so that we only need to focus on designing a primal algorithm to find a stationary point of the unconstrained inner loop problem .",
    "using duality , we characterize the polite water - filling ( pwf ) structure of the input covariance matrices at a stationary point of the inner loop problem .",
    "then , the duality and pwf are exploited to design efficient primal algorithms .",
    "the proposed local ldm with duality - based primal algorithms has lower computation cost and faster convergence speed than the conventional step - size based iterative algorithms .",
    "[ [ proof - of - theorem - thmnetwork - equivalence - subproof - of - theoremne ] ] proof of theorem [ thm : network - equivalence ] [ sub : proof - of - theoremne ] ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    it follows from @xmath408 that @xmath409 .",
    "hence the equivalent channel of the dual network is @xmath410 . by ( [ eq : whitemg-1 ] )",
    ", the covariance of the equivalent noise of dual link @xmath101 is @xmath411 .",
    "note that @xmath412 hence , the linear constraint in ( [ eq : defdualsnlc ] ) can be expressed as @xmath413 .",
    "the above proves the equivalence between the dual b - mac af relay network under constraint ( [ eq : defdualsnlc ] ) and the b - mac ifn in ( [ eq : dual_equibmac ] ) .",
    "the equivalence between the b - mac af relay network under constraint ( [ eq : defsnlc ] ) and the b - mac ifn in ( [ eq : equibmac ] ) can be proved similarly .",
    "[ [ subproof - of - theorem_ndsproof - of - theorem - thmnetwork - dual - scaling ] ] [ sub : proof - of - theorem_nds]proof of theorem [ thm : network - dual - scaling ] ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    recall that @xmath414 , @xmath415 , @xmath127 and @xmath163 are obtained using ( [ eq : decomsig ] ) , ( [ eq : mmserev1 g ] ) , ( [ eq : faig ] ) and ( [ eq : dg ] ) in definition [ def : the - covariance - transformation ] with parameters @xmath148,\\left[\\mathbf{w}_{l}^{'}\\right],\\left[\\hat{\\mathbf{w}}_{l}^{'}\\right]\\right\\ } $ ] .",
    "since @xmath158 is the covariance transformation of @xmath107 obtained by definition [ def : the - covariance - transformation ] with parameters @xmath148,\\left[\\mathbf{w}_{l}^{'}\\right],\\left[\\hat{\\mathbf{w}}_{l}^{'}\\left(\\mathbf{d}\\right)\\right]\\right\\ } $ ] , using the fact that @xmath414 , @xmath415 , @xmath127 and @xmath163 only depends on @xmath107 and @xmath148,\\left[\\mathbf{w}_{l}^{'}\\right]\\right\\ } $ ] , we have @xmath416 where @xmath417 is given by @xmath418 and @xmath419 s are defined in ( [ eq : defnqhead ] ) .",
    "note that @xmath420 where ( [ eq : indscale1]-a ) follows from ( [ eq : defnq ] ) and ( [ eq : qbar ] ) , and ( [ eq : indscale1]-b ) follows from the definition of @xmath421 s in ( [ eq : defaq ] ) .",
    "hence the first linear constraint in ( [ eq : indlconsdualtx ] ) can be expressed as @xmath422 similarly , @xmath423 , @xmath424 where ( [ eq : indscaleq ] ) follows from ( [ eq : defaq ] ) and ( [ eq : defbq ] ) , and thus the other linear constraints in ( [ eq : indlconsdualtx ] ) can be expressed as @xmath425    now replace @xmath426 s in ( [ eq : indscale1ina ] ) and ( [ eq : indscaleqina ] ) with @xmath427 s , we obtain another set of equations @xmath428 it can be verified that the equations in ( [ eq : lamdequ ] ) forms the eigensystem @xmath429 in ( [ eq : keyeigensys ] ) , where @xmath430 is defined in ( [ eq : defa ] ) , @xmath431^{t}$ ] . note that @xmath432 due to nonsingularity of @xmath42 s and @xmath74 s . furthermore , since @xmath31 s and @xmath75 s are assumed to be non - singular and @xmath433 , we have @xmath434 . using these facts ,",
    "the following lemma can be proved .",
    "[ lem : propertya]the following is true for @xmath175 defined in ( [ eq : defa ] ) .",
    "1 ) @xmath435 and @xmath436 .",
    "2 ) for any @xmath437 and @xmath160 satisfying @xmath429 , if any element of @xmath160 is zero , then @xmath438 .",
    "it follows from lemma [ lem : propertya ] and the perronfrobenius theorem ( * ? ? ?",
    "* chp . 8) that the maximum eigenvalue @xmath174 and the associated dominant eigenvector @xmath173 of @xmath175 satisfies @xmath439 and @xmath440 .",
    "then we can always obtain a scaled eigenvector @xmath441^{t}$ ] that satisfies @xmath442 . on the other hand",
    ", it follows from ( [ eq : snlcfixd ] ) that @xmath174 is equal to 1 , which indicates that @xmath178 and @xmath443 satisfies ( [ eq : indlconsdualtx ] ) .      by corollary [ cor : pwf_mlc ]",
    ", @xmath259 satisfies the pwf structure for fixed @xmath444 and the kkt condition in ( [ eq : kktsigma ] ) with @xmath445 . to prove that @xmath446 is a stationary point , we only need to further show that @xmath446 satisfies @xmath447 since @xmath276 is a stationary point of the dual problem ( [ eq : mainpro_dual ] )",
    ", we have @xmath448 . in the following",
    ", we prove that @xmath449 , from which ( [ eq : kktf ] ) follows immediately .    note that for fixed @xmath450 and @xmath451 , problem ( [ eq : mainpro ] ) and ( [ eq : mainpro_dual ] ) can be equivalent to the inner loop problem and its dual for a two - hop b - mac af relay network .",
    "hence , without loss of generality , we only need to consider the two - hop case ( i.e. , @xmath298 ) and prove that @xmath452 . using ( [ eq : sigmhead1 ] ) in corollary [ cor : pwf_mlc ] and the expression of @xmath453 in ( [ eq : gf ] ) , it can be shown that @xmath454 where @xmath455 and @xmath456 .",
    "similar , @xmath457 it follows from ( [ eq : pwf_mgl ] ) and ( [ eq : pwf_mlc_dual ] ) in corollary [ cor : pwf_mlc ] that @xmath458 combining ( [ eq : gf1]-[eq : keyeqgfequ ] ) and @xmath459 , we have @xmath452 .",
    "this completes the proof .",
    "s.  a. jafar , k.  s. gomadam , and c.  huang , `` duality and rate optimization for multiple access and broadcast channels with amplify - and - forward relays , '' _ ieee trans .",
    "theory , _ , vol .",
    "53 , no .  10 , pp .",
    "3350 3370 , oct .",
    "2007 .",
    "a.  liu , y.  liu , h.  xiang , and w.  luo , `` duality , polite water - filling , and optimization for mimo b - mac interference networks and itree networks , '' _ submitted to ieee trans .",
    "info . theory _",
    "2010 ; revised oct .",
    "[ online ] .",
    "available : http://arxiv.org/abs/1004.2484          a.  liu , y.  liu , h.  xiang , and w.  luo , `` mimo b - mac interference network optimization under rate constraints by polite water - filling and duality , '' _ ieee trans .",
    "signal processing _ , vol .",
    "59 , no .  1",
    "263 276 , jan .",
    "2011 .",
    "a.  liu , v.  k.  n. lau , and y.  liu , `` local dual method for optimization of parallel mimo b - mac interference networks under multiple linear constraints , '' _ submitted to ieee trans .",
    "signal processing _",
    "2011 ; revised apr . 2012 .",
    "[ online ] .",
    "available : http://www.ee.ust.hk/~eeknlau/hkust-office-homepage/publications.html"
  ],
  "abstract_text": [
    "<S> we consider a generalized multi - hop mimo amplify - and - forward ( af ) relay network with multiple sources / destinations and arbitrarily number of relays . </S>",
    "<S> we establish two dualities and the corresponding _ dual transformations _ between such a network and its dual , respectively under single network linear constraint and per - hop linear constraint . </S>",
    "<S> the result is a generalization of the previous dualities under different special cases and is proved using new techniques which reveal more insight on the duality structure that can be exploited to optimize mimo precoders . </S>",
    "<S> a unified optimization framework is proposed to find a stationary point for an important class of non - convex optimization problems of af relay networks based on a _ local lagrange dual method _ </S>",
    "<S> , where the _ primal algorithm _ only finds a stationary point for the inner loop problem of maximizing the lagrangian w.r.t . </S>",
    "<S> the primal variables . </S>",
    "<S> the input covariance matrices are shown to satisfy a _ polite water - filling structure _ at a stationary point of the inner loop problem . </S>",
    "<S> the duality and polite water - filling are exploited to design fast primal algorithms . </S>",
    "<S> compared to the existing algorithms , the proposed optimization framework with duality - based primal algorithms can be used to solve more general problems with lower computation cost .    </S>",
    "<S> multi - hop mimo networks , amplify and forward , relay , duality , mimo precoder optimization </S>"
  ]
}