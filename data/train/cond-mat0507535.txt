{
  "article_text": [
    "models in complex networks science aim to reproduce some common empirical statistical features observed across many different real systems , from the internet to society @xcite .",
    "many of those models are able to recreate prominent recurrent attributes , such as the small - world property and scale - free degree distributions with characteristic exponents between @xmath1 and @xmath2 as measured for networks in the real world .",
    "other characteristics , such as the presence , the shape , and the intensity of correlations , are also unavoidable in models intending to help us to understand how these complex systems self - organize and evolve .    the first reference to correlations in networks appearing in the literature is the clustering coefficient @xcite , which refers correlations among three vertices .",
    "the clustering is a measure of transitivity which quantifies the likelihood that two neighbors of a vertex are neighbors themselves .",
    "then , it is a measure of the number of triangles present in a graph .",
    "in addition to the empirical evidence that the vast majority of real networks display a high density of triangles , the concept of clustering is also relevant due to the fact that triangles are together with edges the most common building blocks taking part in more complex but elementary recurring subgraphs , the so - called motifs @xcite .",
    "it has been argued that networks large - scale topological organization is closely related to their local motifs structure @xcite so that these subgraphs could be related to the functionality of the network and can be fundamental in determining its community structure @xcite .",
    "all these mean that a correct quantification and modeling of the clustering properties of networks is a matter of great importance .",
    "however , most modeling efforts beyond the degree distribution have focused in the reproduction of two point correlations patterns , typified by the average nearest neighbors degree @xcite , so that clustering is just obtained as a byproduct . in most synthetic networks",
    ", it vanishes in the thermodynamic limit , but , as to many other respects , scale - free networks with divergent second moment stand as a special case .",
    "the decay of their clustering with the increase of the network size is so slow that relatively large networks with an appreciable high cohesiveness can be obtained @xcite .",
    "nevertheless , it remains to be an indirect effect and no control over its intensity or shape is practicable .",
    "therefore , an independent modeling of clustering is required and a few growing linear preferential attachment mechanism have been suggested . one of the proposed models @xcite reproduces a large clustering coefficient by adding nodes which connect to the two extremities of a randomly chosen network edge , thus forming a triangle .",
    "the resulting network has the power - law degree distribution of the barabsi - albert model @xmath3 , with @xmath4 , and since each new vertex induces the creation of at least one triangle , the model generate networks with finite clustering coefficient .",
    "a generalization on this model @xcite which allows to tune the average degree to @xmath5 , with @xmath6 an even integer , considers new nodes connected to the ends of @xmath7 randomly selected edges .",
    "two vertices and three vertices correlations can be calculated analytically through a rate equation formalism .",
    "the clustering spectrum is here finite in the infinite size limit and scales as @xmath8 .",
    "those models do not allow much freedom in the form of the resulting clustering coefficient , neither in the ensuing degree distribution , so that , although a valuable first approach , they constitute a timid attempt as clustering generators . in this paper",
    ", we make headway by introducing a generator of random networks where both the degree - dependent clustering coefficient and the degree distribution are tunable . after a brief review of several clustering measures in section",
    "ii , the algorithm is presented in section iii . in section iv",
    ", we check the validity of the algorithm using numerical simulations .",
    "section v is devoted to the theoretical explanation of the constraints that degree - degree correlations impose in the clustering .",
    "we find that assortativity allows higher levels of clustering , whereas disassortativity imposes tighter bounds . as a particular case",
    ", we analyze this effect for the class of scale - free networks .",
    "we end the section by examining some empirical networks , finding a good agreement with our calculations .",
    "finally , conclusions are drawn in section vi .",
    "several alternative definitions have been proposed over time to quantify clustering in networks .",
    "the simplest measure is defined as @xcite @xmath9 this scalar quantity does not give much information about local properties of different vertices because it just counts the overall number of triangles regardless of how these triangles are placed among the different vertices of the network .    the clustering coefficient , first introduced by watts and strogatz @xcite ,",
    "provides instead local information and is calculated as @xmath10 where @xmath11 is the number of triangles passing through vertex @xmath12 and @xmath13 is its degree .",
    "the average of the local clustering coefficients over the set of vertices of the network , @xmath14 , is usually known in the literature as the clustering coefficient .",
    "watts and strogatz were also the first in pointing out that real networks display a level of clustering typically much larger than in a classical random network of comparable size , @xmath15 , with @xmath16 the average degree and @xmath17 the number of nodes in the network . although @xmath14 and @xmath18 are sometimes taken as equivalent , they may be very different , even though both measures are defined in the interval @xmath19 $ ] .    with the definition of @xmath20 we have gone to the other extreme of the spectrum from a global to a purely local perspective so that we have highly detailed information .",
    "one can adopt a compromise between the global property defined by @xmath14 , or @xmath18 , and the full local information given by @xmath20 by defining an average of @xmath20 over the set of vertices of a given degree class @xcite , that is , @xmath21 where @xmath22 is the number of vertices of degree @xmath0 and @xmath23 is the set of such vertices .",
    "the corresponding scalar measure is called the mean clustering coefficient and can be computed on the basis of the degree distribution @xmath24 as @xmath25 which must not be confused with the clustering coefficient @xmath26 .",
    "in fact , we have implicitly assumed that @xmath27 whereas in the definition of @xmath14 we only consider an average over the set of vertices with degree @xmath28 .",
    "this fact explains the difference between both measures .    in the case of uncorrelated networks",
    ", @xmath29 is independent of @xmath0 .",
    "furthermore , all the measures collapse and reduce to @xmath14 @xcite .",
    "@xmath30 therefore , a functional dependence of @xmath29 on the degree can be attributed to the presence of correlations .",
    "indeed , it has been observed that @xmath29 exhibits a power - law behavior @xmath31 ( typically @xmath32 ) for several real scale - free networks .",
    "hence , the degree dependent clustering coefficient has been proposed as a measure of hierarchical organization and modularity in complex networks @xcite .",
    "recently , a new local clustering coefficient has been proposed , which filters out the bias that degree - degree correlations can induce on that measure @xcite @xmath33 where @xmath34 is the maximum number of edges that can be drawn among the @xmath35 neighbors of vertex @xmath12 .",
    "this new measure does not strongly depend on the vertex degree , remaining constant or decreasing logarithmically with the increase of @xmath0 when computed for several real networks .",
    "in this paper , we develop and test a new algorithm that , in the same philosophy of the classical configuration model ( cm ) , generates networks with a given degree distribution and a preassigned degree dependent clustering coefficient @xmath29 , as defined in eq .",
    "( [ c(k ) ] ) .",
    "the cm has been one of the most successful algorithms proposed for network formation @xcite .",
    "the relevance of the algorithm relies on its ability to generate random networks with a preassigned degree sequence taken from a given degree distribution at the user s discretion while maximizing the network s randomness at all other respects .",
    "the algorithm became relevant as soon as more real networks were analyzed and proved to strongly deviate from the _ supposed _ poisson degree distribution predicted by the classical model of erds and rnyi @xcite .",
    "ever since , the cm has been extensively used as a null model in contraposition to real networks with the same degree distribution .",
    "one of the well - known properties of the cm is that clustering vanishes in the limit of very large networks ( see eq .",
    "( [ eq:32 ] ) ) and , thus , it clearly deviates from real networks , for which clustering is always present . in general",
    ", a high level of clustering may change the percolation properties of the network , alter its resilience in front of removal of its constituents , or affect the dynamics that take place on top of them .",
    "since such processes inextricably entangle topology and functionality , it would be very interesting to have at one s disposal an algorithm that generates clustered networks in a controlled way so that one can check which is the real effect of transitivity on its topological and dynamical properties .    with this purpose",
    ", we introduce an undirected unweighted static model where the total number of nodes in the network , @xmath17 , remains constant , as in the case of the cm .",
    "the algorithm comprises three different parts : 1 ) assignment of a degree to each node and assignment of a number of triangles to each degree class according to the expected distributions .",
    "2 ) closure of triangles and 3 ) closure of the remaining free stubs . in",
    "what follows , we give a detailed description of the algorithm . + * 1 ) degree and clustering from expected distributions *    * an _ a priori _ degree sequence is chosen according to a given distribution @xmath24 , so that each vertex is awarded an _ a priori _ number of connections in the form of a certain number of stubs . * an _ a priori _ clustering coefficient @xmath29 is also fixed , so that each class of nodes of degree @xmath0 is assigned an _ a priori _ number of triangles .. for very large degrees , it may happen that this number is smaller than one . to overcome this problem",
    ", one can determine @xmath36 by allocating a number of triangles , @xmath37 , to each vertex @xmath12 using , for instance , the binomial distribution @xmath38 with @xmath39 and @xmath40 .",
    "then , the number of triangles @xmath37 are summed up for each class .",
    "once each class has been assigned a total number of triangles , individual vertices forget the initially ascribed @xmath37 . ]",
    "note that the number of triangles is fixed for the whole class and not for the particular vertices of the class .",
    "this is a key point of the algorithm because fixing the number of triangles to each single vertex would impose a number of constraints that would make nearly impossible to close the network . *",
    "all nodes begin with a number of @xmath41 associated edges and all degree classes begin with a number of @xmath41 associated triangles .    *",
    "2 ) triangle formation * + first some preliminary remarks .",
    "both stubs and edges can be selected to form a triangle .",
    "stubs are half links associated to one node , and edges are entire links associated to two nodes , and thus have double probability with respect to stubs to be selected to participate in a triangle .",
    "let us define the set of eligible components ( ec ) as the set of free stubs and edges associated to nodes belonging to degree classes with a number of triangles below its expected value ( unsatisfied classes ) .",
    "stubs and edges of nodes in satisfied classes should not be in the set of ec .",
    "edges of nodes which can not form more triangles ( with only edges as components and neighbors without stubs ) should not be in the set of ec .",
    "stubs and edges of nodes with only one component should not be in the set of ec .",
    "notice that the set of ec changes dynamically as triangles are formed .",
    "the algorithm then proceeds by choosing three different nodes and forming a triangle among them whenever it is possible and it did not exist previously .",
    "the selection of the nodes is performed hierarchically as follows .",
    "* for the first node , a degree class @xmath42 among the ones with unsatisfied number of expected triangles is chosen with a certain probability distribution , @xmath43 , not necessarily uniform ( the specific form for this function and the motivation to introduce it will be discussed at the end of the section and a theoretical explanation is given in section [ theoretical ] ) .",
    "then , the node is selected through a component which is chosen with uniform probability within the subset of eligible components in the class , ec@xmath44 .",
    "a second different component of the same node is selected . *",
    "if the two chosen components are edges , and the second and the third nodes at the end of the edges still have free stubs , the triangle is formed by merging one free stub of the second node and one free stub of the third node ( see fig .",
    "[ figd1 ] ) . *",
    "if one component is a stub and the other an edge , a third node is necessary .",
    "first , a new component is selected for the second node at the end of the edge .",
    "if it is an edge , the triangle is formed by merging one free stub of the first node and one free stub of the third node .",
    "if it is a stub , then a third node is chosen in the same way as the first one under the condition that it has two free stubs .",
    "the triangle is then formed by merging these two free stubs with the ones of the first and second nodes ( see fig .",
    "[ figd2 ] ) .",
    "* it may happen that the two components of the first node are stubs .",
    "then , a new node is selected in the same way as the first one under the condition of having at least one free stub , and a second component is also chosen for this second node .",
    "if both components of the second node are stubs , a third node with two free stubs is selected and the triangle is closed . if one component of the second node is a stub and another an edge , the node at the end of the edge will be the third node and the triangle is formed linking stubs between the first and the second node and the first and the third node ( see fig .",
    "[ figd3 ] ) .",
    "* after each triangle is formed , all dynamic quantities are updated : linked stubs are converted into edges and the corresponding number of new triangles is added to all involved degree classes .",
    "it is worth to mention that not only one more triangle is computed for the classes of the nodes forming the triangle , but the degree classes of simultaneous neighbors of pairs of those nodes may also be affected if those pairs were not previously connected .",
    "the set ec is also updated , removing components of nodes in new satisfied classes as well as nodes with only one component or nodes which can not form more triangles .",
    "* this process is repeated until all classes are satisfied or there are no more components in the eligible set .    *",
    "3 ) closure of the network * + the final step consists in the closure of the network by applying the classical configuration model to the remainder stubs .",
    "pairs of these stubs are selected uniformly at random and the corresponding vertices are connected by an undirected edge .",
    "+ in this way , the algorithm is able to reproduce networks with a given degree distribution , @xmath24 , and a given clustering coefficient , @xmath29 , as long as the assortativity that is , positive degree - degree correlations is high enough to avoid constraining @xmath29 .",
    "this is by no means a deficiency of the algorithm but an universal structural constraint imposed by the degree - degree correlation pattern of the network . in general , with the maximum assortativity one can reproduce any desired level of clustering , whereas disassortative networks have instead a bounded clustering coefficient .",
    "a theoretical explanation is given in section v.    in our algorithm , the level of assortativity is controlled by the probability by which the degree class is chosen previously to the selection of the node .",
    "this can be done in a number of different ways . in our case",
    ", we tune the assortativity by choosing a proper form for the probability @xmath43 .",
    "for instance , an uniparametric function modeling different assortativity levels is given by @xmath45 , where @xmath46 is the number of triangles remaining to be formed in the degree class @xmath0 in a given iteration .",
    "the value of @xmath47 typically ranges in the interval @xmath19 $ ] , generating more assortative networks as @xmath47 approaches @xmath41 .",
    "to check the feasibility and reliability of the algorithm , we have performed extensive numerical simulations , generating networks with different types of degree distributions and different levels of clustering .",
    "the chosen forms for the degree distribuion are poisson , exponential , and scale - free .",
    "the degree dependent clustering coefficient is chosen to be @xmath48 .",
    "the numerical prefactor is set to @xmath49 and the exponent takes values @xmath50 , @xmath51 , and @xmath52 .",
    "the size of the generated networks is @xmath53 and each curve is an average over three different realizations .",
    "simulation results are shown in figs .",
    "[ fig6 ] , [ fig7 ] , and [ fig8 ] , which correspond to poisson and exponential degree distribution with average degree @xmath4 , and scale - free degree distributions with exponent @xmath54 , respectively .",
    "as it can be seen , the degree dependent clustering coefficient is well reproduced in all cases just by decreasing the value of @xmath47 if necessary ( the values of @xmath47 used in each simulation are specified in the caption of the corresponding figure ) . the standard procedure",
    "we follow is to start with @xmath55 and to check whether the tail of @xmath29 is well reproduced .",
    "if not , we decrease its value until the entire curve fits the expected shape .",
    "[ p_k ] shows the degree distributions generated by the algorithm for the simulations of the previous figures , confirming that , indeed , the generated degree distributions match the expected ones .",
    "as we advanced in the previous section , degree - degree correlations constraint the maximum level of clustering a network can reach .",
    "a naive explanation for this is that , if the neighbors of a given node have all of them a small degree , the number of connected neighbors ( and hence , the clustering of such node ) will be bounded .",
    "this is the main idea behind the new measure of clustering introduced in @xcite .",
    "however , we can make a step forward and quantify analytically this effect .",
    "to do so , we need to define new quantities which take into account the properties of vertices that belong to the same triangle .",
    "let us define the multiplicity of an edge , @xmath56 , as the number of triangles in which the edge connecting vertices @xmath12 and @xmath57 participates .",
    "this quantity is the analog to the number of triangles attached to a vertex , @xmath37 .",
    "these two quantities are related through the trivial identity @xmath58 which is valid for any network configuration .",
    "the matrix @xmath59 is the adjacency matrix , giving the value @xmath60 if there is an edge between vertices @xmath12 and @xmath57 and @xmath41 otherwise .",
    "it is possible to find a relation between multiplicity , degree distributions and clustering .",
    "summing the above equation for all vertices of a given degree class we get @xmath61 now , there are some key relations which can be used @xmath62 where @xmath63 is the average multiplicity of the edges connecting the classes @xmath0 and @xmath64 , and @xmath65 is the number of edges between those degree classes . finally , taking into account eq .",
    "( [ c(k ) ] ) and the fact that the joint degree distribution satisfies @xmath66 , we obtain the following closure condition for the network @xmath67 let us emphasize that this equation is , in fact , an identity fulfilled by any network and , thus , it is , for instance , at the same level as the degree detailed balance condition derived in @xcite .",
    "these identities are important because , given their universal nature , they can be used to derive properties of networks regardless their specific details . as an example , in @xcite we used the detailed balance condition to prove the divergence of the maximum eigenvalue of the connectivity matrix that rules the epidemic spreading in scale - free networks , which , in turn , implies the absence of epidemic threshold in this type of networks .",
    "the multiplicity matrix is , _ per se _ , a very interesting object that gives a more detailed description on how triangles are shared by vertices of different degrees . in principle , @xmath63 does not factorize and , therefore , non trivial correlations can be found . the global average multiplicity of the network , @xmath68 , can be computed as @xmath69 values of @xmath68 close to zero mean that there are no triangles .",
    "when @xmath70 , triangles are mostly disjoint and their number can be approximated as @xmath71 , and , when @xmath72 , triangles jam into the edges , that is , many triangles share common edges .    we are now equipped with the necessary tools to analyze the interplay between degree - degree correlations and clustering .",
    "the key point is to realize that the multiplicity matrix satisfies the inequality @xmath73 which comes from the fact that the degrees of the nodes at the ends of an edge determine the maximum number of triangles this edge can hold . multiplying this inequality by @xmath74 and summing over @xmath64",
    "we get @xmath75 where we have used the identity eq .",
    "( [ db ] ) .",
    "this inequality , in turn , can be rewritten as @xmath76 notice that @xmath77 is always in the interval @xmath19 $ ] and , therefore , @xmath29 is always bounded by a function smaller ( or equal ) than @xmath60 . in the limit of very large values of @xmath0 , eq .",
    "( [ inequality ] ) reads @xmath78 where @xmath79 is the average nearest neighbors degree of a vertex with degree @xmath0 .",
    "the superscript @xmath80 ( of reduced ) refers to the fact that it is evaluated only up to @xmath0 and , therefore , @xmath81 . for strongly assortative networks",
    "@xmath82 , so that @xmath83 and there is no restriction in the decay of @xmath29 . in the opposite case of disassortative networks , the sum term in the right hand side of eq .",
    "( [ inequality ] ) may be fairly large and then the clustering coefficient will have to decay accordingly .    in fig.[fig1 ]",
    "we show this effect by changing the level of clustering while keeping the degree - degree correlations unchanged by fixing the value of @xmath47 to @xmath55",
    ". as it can be seen , lower levels of clustering are better reproduced .",
    "however , the clustering collapses to a limiting curve when the expected value crosses it .",
    "that is , any function @xmath29 is possible whenever it is defined below a limiting curve which is a function of the degree correlation pattern of the network .",
    "another way to see the same effect is shown in fig .",
    "[ fig2 ] . in this case",
    "we keep the expected clustering while changing the assortativity of the network by tuning the parameter @xmath47 .",
    "as it can be seen , as correlations become more and more assortative ( decreasing values of @xmath47 ) the expected clustering can be further reproduced .",
    "we would like to point out that the function @xmath77 is just an upper bound for the clustering coefficient .",
    "the actual bound will probably be even smaller due to the fact that we have only considered the restriction over one edge and the degrees of the corresponding vertices .",
    "a more accurate estimation would involve more than one edge and the corresponding vertices attached to them @xcite .",
    "scale - free networks belong to a special class of networks which deserve a separate discussion .",
    "indeed , it has been shown that , when the exponent of the degree distribution lies in the interval @xmath84 $ ] and its domain extends beyond values that scale as @xmath85 , disassortative correlations are unavoidable for high degrees @xcite .",
    "almost all real scale - free networks fulfill these conditions and , hence , it is important to analyze how these negative correlations constraint the behavior of the clustering coefficient .",
    "let us assume a power law decay of the average nearest neighbors degree of the form @xmath86 .",
    "one can prove that this function diverges in the limit of very large networks as @xmath87 , where @xmath88 is the maximum degree of the network @xcite .",
    "then , the prefactor @xmath89 must scale in the same way which , in turn , implies that the reduced average nearest neighbors degree behaves as @xmath90 then , from eq .",
    "( [ inequality_approx ] ) the exponent of the degree dependent clustering coefficient , @xmath91 , must verify the following inequality @xmath92 just as an example , in the case of the internet at the autonomous system level @xcite , the reported values for these three exponents ( @xmath93 , @xmath94 , and @xmath95 ) satisfy this inequality close to the limit ( @xmath96 ) .",
    "the interplay between degree correlations and clustering can also be observed in real networks .",
    "we have measured the functions @xmath77 and @xmath29 for several empirical data sets , finding that the inequality eq .",
    "( [ inequality ] ) is always satisfied .",
    "the analyzed networks are the internet at the autonomous system level ( as ) @xcite , the protein interaction network of the yeast _ s. cerevisiae _ ( pin ) @xcite , an intra - university e - mail network @xcite , the web of trust of pgp @xcite , the network of coauthorships among academics @xcite , and the world trade web ( wtw ) of trade relationships among countries @xcite .    in fig .",
    "[ inequality2 ] we plot the clustering coefficient @xmath29 as a function of @xmath77 .",
    "each dot in these figures correspond to a different degree class .",
    "as clearly seen , in all cases the empirical measures lie below the diagonal line , which indicates that the inequality eq .",
    "( [ inequality ] ) is always preserved . in fig .",
    "[ constraint_realnets ] we show the ratio @xmath97 .",
    "the rate of variation of this fraction is small and , thus , the degree dependent clustering coefficient can be computed as @xmath98 , where @xmath99 is a slowly varying function of @xmath0 that , in many cases , can be fitted by a logarithmic function .",
    "we have introduced and tested a new algorithm that generates _ ad hoc _ clustered networks with given degree distribution and degree dependent clustering coefficient",
    ". this algorithm will be useful for analyzing , in a controlled way , the role that clustering has on many dynamical processes that take place on top of networks .",
    "we have also introduced a new formalism which backs our algorithm and allows to quantify clustering in a more rigorous manner . in particular , an universal closure condition for networks is found to relate the degree dependent clustering coefficient , degree - degree correlations and the number of triangles passing through edges connecting vertices of different degree classes . using this relation ,",
    "we have found how the correlation pattern of the network constraints the function @xmath29 . in particular ,",
    "assortative networks are allowed to have high levels of clustering whereas disassortative ones are more limited .",
    "overall , we hope that a more accurate shaping of synthetic networks will improve our understanding of real ones . at this respect , we believe our algorithm will be useful for the community working on complex networks science .",
    "we acknowledge a. vespignani , r. pastor - satorras and a. arenas for valuable suggestions . this work has been partially supported by dges of the spanish government ,",
    "fis2004 - 05923-co2 - 02 , and ec - fet open project cosin ist-2001 - 33555 .",
    "m. b. acknowledges financial support from the mcyt ( spain ) through its ramn y cajal program ."
  ],
  "abstract_text": [
    "<S> we present a generator of random networks where both the degree - dependent clustering coefficient and the degree distribution are tunable . </S>",
    "<S> following the same philosophy as in the configuration model , the degree distribution and the clustering coefficient for each class of nodes of degree @xmath0 are fixed _ </S>",
    "<S> ad hoc _ and _ a priori_. the algorithm generates corresponding topologies by applying first a closure of triangles and secondly the classical closure of remaining free stubs . </S>",
    "<S> the procedure unveils an universal relation among clustering and degree - degree correlations for all networks , where the level of assortativity establishes an upper limit to the level of clustering . </S>",
    "<S> maximum assortativity ensures no restriction on the decay of the clustering coefficient whereas disassortativity sets a stronger constraint on its behavior . </S>",
    "<S> correlation measures in real networks are seen to observe this structural bound . </S>"
  ]
}