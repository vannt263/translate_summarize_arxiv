{
  "article_text": [
    "over the coming decades , the uk energy market faces significant challenges as it strives to meet its climate change targets .",
    "low carbon and renewable generation will need to play a more dominant role in our future electricity supply market .",
    "however , renewable energy is intermittent and its availability is driven by uncontrollable elements , such as wind speed and solar intensity .",
    "other options , such as nuclear power and carbon capture and storage , are generally considered to be less flexible than traditional thermal plants .",
    "the problems are clear .",
    "the unreliability of renewable supply means that there will always be a need for a quick - reacting back - up , in order to ensure that demand is met . on the other hand , at off - peak demand times",
    ", supply may be curtailed ( often at a high cost ) if the system is not flexible enough to respond .    on the demand side , despite improved energy efficiency measures , we can expect to see an overall increase in consumption as the electrification of transport and heating become more commonplace @xcite . if all environmental targets are met on time , then national grid s gone green scenario predicts a 12.6@xmath3 increase in great britain s peak demand by 2035 , from 2013 levels @xcite .",
    "in addition , future demand profiles are likely to look very different from today .",
    "electric heat pumps , for example , will create a marked seasonal peaking of demand during the colder , winter months . electric vehicle charging and new smart technologies , on the other hand , could distort our daily demand patterns",
    ".    electricity storage is one potential option for improving the flexibility and reliability of our electricity system .",
    "it could offer services such as peak - shaving , frequency response , reactive power regulation and the provision of reserve . in the uk",
    ", large - scale electricity storage currently comes only in the form of pumped hydro power plants , which are implemented largely to meet early evening winter peak demands between 4 pm and 8 pm @xcite .",
    "their main sources of revenue are through providing the balancing services , short - term operating reserve ( stor ) and fast reserve , which are funded by national grid .",
    "the stores then replenish their supply during the night , when electricity prices are at their lowest @xcite .",
    "much research has been dedicated to analyzing storage viability .",
    "some papers focus on the benefits which a store could bring to the electricity system if operated in a socially optimal way ( see , for example , @xcite ) . typically , the approach of these papers is to solve the unit dispatch problem i.e. to select a suitable configuration of generators ( including storage ) to run at each time , in order to ensure that demand is met ( or that demand is met with a certain high probability ) .",
    "an advantage of this method is that it can incorporate the interactions between all assets of the energy system into a single optimization problem , allowing a comparison between the actions of storage against its competing options .",
    "a drawback , however , is that the system optimum does not necessarily coincide with each individual firm s optimal strategy . in many cases , it is not even clear that each firm would make a profit under these solutions",
    ". therefore , the whole - system approach is generally better suited to questions where the store is not privately owned , but instead owned and operated by a central controller , such as the system operator .",
    "other papers focus on the profits available to a store which faces stochastic or probabilistic prices .",
    "some of these papers restrict the behaviour of the store to a pre - defined set of operating strategies ( e.g. @xcite ) .",
    "another approach is to implement dynamic programming techniques ( e.g. @xcite ) .",
    "a drawback of this latter approach , however , is that it tends to be computationally heavy and requires information about prices over the entire time horizon over which we wish to optimize .",
    "additionally , such methods do not give much scope for mathematical insight into the dynamics of the solutions .",
    "in this paper , we present a method to determine the maximum profit available to an electricity store which is operating in the wholesale electricity market .",
    "we assume that the store can predict an electricity price function @xmath4\\to\\re$ ] ( or alternatively , a cost function ) where @xmath0 $ ] is the period of time over which we wish to optimize .",
    "however , the method only ever uses price information over a smaller time interval , thus reducing the required prediction horizon and the amount of computation needed .",
    "it is worth commenting here that the prediction of future prices in this way is not an unreasonable assumption , since most electricity today is traded through `` over - the - counter '' bilateral contracts , which are agreed ahead of operating time .",
    "our method is derived from standard calculus of variations techniques and is intended as an extension to @xcite .",
    "our work differs from @xcite in several respects .",
    "firstly , we present our model in a continuous time setting , rather than the discrete setting employed in @xcite .",
    "even if prices are declared at discrete time intervals , in accordance with our current market system , our approach allows for the input of piecewise constant prices but with continuous variation in the operation of the store .",
    "secondly , @xcite allows only for convex cost functions , whereas here we allow for much more general operating costs and , in particular , we remove the convexity assumption .",
    "this is realistic : in general , there is little reason to believe that the cost of running a motor , for example , is a convex function of the output power .",
    "moreover , there may be cost jumps involved in switching on a new motor if additional power is required .",
    "although these more general conditions do not guarantee the existence of solutions , we prove that optimal operating strategies of the form given in proposition  [ prop : ps ] exist if and only if the associated algorithm does not terminate early .",
    "finally , we allow the inclusion of additional operating constraints . if these constraints can be expressed as bounds on the instantaneous power output ( e.g. in the case of enforced periods of closure for maintenance ) , then they can easily be incorporated into the main result ( proposition  [ prop : ps ] ) and the optimal strategy can be determined using the algorithm of section  [ sec : alg ] .",
    "this method reduces the optimization problem to a set of smaller problems which are localized in time . for other constraints , however , this localization in time is not guaranteed . in section  [ sec : switching ] , we demonstrate this issue and propose a method for handling an additional condition if the store must wait for a fixed amount of time ( called the minimum switching time ) whenever it wishes to change its mode of operation between the charging and the discharging mode .",
    "the structure of the paper is as follows : over the remainder of this section , we introduce our storage model and its associated costs . in section 2 , we present the main result , which characterizes the optimal strategies via a reference price function . in section 3",
    ", we present an algorithm which determines both the optimal strategy and the reference price for the basic case where the store is only constrained by its power ratings and its capacity constraints .",
    "we prove that an optimal strategy exists in this case only if the algorithm does not terminate early .",
    "section  [ sec : constraints ] contains a discussion of a simple storage model and in section  [ sec : switching ] we investigate the inclusion of a minimum switching time constraint . in section 5 ,",
    "we present and discuss some illustrative results .",
    "finally , the conclusions of the paper are summarized in section 6 .",
    "we use a simple technology - agnostic model for storage , which incorporates a number of key features , both physical and economic . to allow for multiple applications",
    ", we define all quantities in a general setting . towards the end of the paper , in section  [ sec : constraints ]",
    ", we present a concrete ( and technically relevant ) example .",
    "let @xmath0 $ ] be the interval of time over which we want to optimize the actions of the store , for some @xmath5 .",
    "at each time @xmath1,$ ] we denote by @xmath6 the set of admissible power outputs associated with the store at that time .",
    "the operator of the store may then choose an _ operating strategy _",
    "@xmath7\\to\\re$ ] which allocates , at each time @xmath8 the amount of power @xmath9 that is to enter the store ( using the convention that if @xmath10 then the store discharges @xmath11 units of power at time @xmath12 ) . allowing the power constraint set @xmath13 to vary with time in this way means that we may incorporate constraints such as planned periods of closure or transmission congestion into the model .",
    "a planned closure over a time period @xmath14,$ ] for example , corresponds to the power constraint set @xmath15 for all @xmath16 the amount of stored energy , or the _ level of the store _ , which results from the strategy @xmath17 at time @xmath12 is denoted @xmath18(t)$ ] and evolves according to the differential equation @xmath19(t)=-\\alpha\\ell[q](t)+q(t).\\end{aligned}\\ ] ] here , @xmath20 is the leakage rate , which is introduced to reflect the self - discharge which occurs due to imperfect sealing or porous casing .",
    "given an initial condition @xmath18(0)=\\ell_0,$ ] the level of the store at each time @xmath1 $ ] is thus given by @xmath21(t)=e^{-\\alpha t}\\ell_0+e^{-\\alpha t}\\int_0^te^{\\alpha s}q(s)ds.\\end{aligned}\\ ] ]    we will only consider strategies @xmath7\\to\\re$ ] which are piecewise continuous functions of time .",
    "this is a physically reasonable assumption , since any strategy which has an accumulation point of discontinuities or a non - jump discontinuity would be hard to achieve by any piece of equipment .",
    "throughout the remainder of this paper , we denote by @xmath22 the space of piecewise continuous functions @xmath23 for any subset @xmath24    the _ capacity constraints _ of the store are characterized by two functions @xmath25\\to\\re,$ ] so that any strategy @xmath7\\to u$ ] is constrained by the inequalities @xmath26(t)\\leq e^+(t ) \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\forall t\\in[0,t].\\end{aligned}\\ ] ] we assume that the initial and terminal levels of the store are pre - specified , so that @xmath27 note that , if not specified , then the terminal condition is in fact implicit since any optimal strategy @xmath28 should satisfy that @xmath29(t)=e^-(t).$ ] we also assume , without loss of generality , that @xmath30 for all @xmath1 $ ] ( otherwise @xmath31 could be adjusted so that this is true , without changing the set of admissible strategies ) .    the set of possible levels of the store , at each time , is represented by the _",
    "admissible energy domain _ @xmath32\\times\\re,$ ] which is the set of all pairs @xmath33\\times[e^-(t),e^+(t)].$ ] often , one may choose to replace the capacity constraints @xmath34 and @xmath35 with constants , so that @xmath36 is the physical size of the store and @xmath37 is the minimum technically feasible level of the store ( which may be strictly positive , for example in the case of compressed air energy storage , where a cushion of air needs to be maintained in the store at all times in order to provide sufficient pressure to instigate discharging ) .",
    "we have chosen here to represent @xmath31 in this more general form , to allow the store to participate in multiple markets .",
    "for example , if a store decides to participate in a balancing mechanism reserve contract , it may be required by national grid to make supply available over certain agreed periods .",
    "thus , at these contracted times the store will have less capacity available for use in the wholesale market .",
    "in addition to the capacity and power constraints outlined above , the operation of a store may be restricted by further factors , such as warm - up times , ramping constraints and minimum switching times between modes of operation .",
    "we denote the collection of additional constraints associated with the store by @xmath38 the only condition on these constraints is that they must be entirely expressible as functions of the power output function @xmath39 a maximum ramp - up rate @xmath40 on the charge side , for example , may be written as inequalities @xmath41 \\ \\textnormal{such that } \\",
    "q(t)>0.\\ ] ] we do not allow for constraints of this kind in section  [ sec : nocon ] .",
    "however , the impact of a non - empty set @xmath42 is discussed in section  [ sec : constraints ] . the total cost incurred by the store , given an operating strategy @xmath43",
    "is denoted @xmath44\\in\\re.$ ] here , @xmath45 is a functional which maps @xmath46 into @xmath47 this can incorporate factors such running costs , warming - up costs and costs of storing , as well as the cost of purchasing power and the payments ( counted as negative cost ) received for providing power .",
    "the aim of this paper is to identify those operating strategies @xmath17 which minimize the total cost @xmath44,$ ] whilst adhering to all of the physical constraints outlined above .",
    "if the store is profitable to run , then the minimal cost should , of course , be negative .",
    "[ defn : storage ] we say that @xmath7\\to\\re$ ] is an admissible strategy if @xmath17 is piecewise continuous and satisfies the following properties :    1 .   for each @xmath1,$",
    "] we have @xmath48 and @xmath18(t)\\in[e^-(t),e^+(t)].$ ] 2 .",
    "if @xmath49 then the strategy @xmath17 satisfies each of the constraints in @xmath38    we denote by @xmath50 the set of all admissible strategies and say that @xmath51 is an _ optimal strategy _ if @xmath52\\leq c[q ] \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\forall q\\in x.    \\end{aligned}\\ ] ]",
    "the following proposition provides a characterization of optimal strategies in terms of a `` reference price '' function @xmath53 we introduce the _ indicator functional _ @xmath54 which is defined by the property that @xmath55 $ ] takes the value 0 if and only if @xmath17 satisfies each of the constraints in @xmath38    [ prop : ps ] suppose there exists a constant @xmath56 a piecewise differentiable function @xmath57\\to\\re$ ] and a strategy @xmath51 with the following properties :    a.   the strategy @xmath28 is a minimizer of @xmath58-\\int_0^te^{\\alpha t}\\mu^*(t ) q(t)dt+\\rho^*s[q]\\end{aligned}\\ ] ] over all piecewise continuous functions @xmath7\\to\\re$ ] such that @xmath48 for all @xmath1.$ ] b.   if @xmath59 is differentiable at @xmath1,$ ] then the following complementary slackness conditions are satisfied : @xmath60(t)<e^+(t),\\label{eq : mucond1}\\\\ { \\frac{d{\\mu^*}}{dt}}(t)\\geq 0 \\ & \\ \\ \\ \\textnormal{if } \\ \\ell[q]^*(t)=e^+(t),\\label{eq : mucond2}\\\\ { \\frac{d{\\mu^*}}{dt}}(t)\\leq 0 \\ & \\ \\ \\ \\textnormal{if } \\ \\ell[q^*](t)=e^-(t).\\label{eq : mucond3}\\end{aligned}\\ ] ] c.   if @xmath59 is not differentiable at @xmath1,$ ] then the following `` jump '' complementary slackness conditions are satisfied : @xmath61(t)<e^+(t),\\label{eq : mucond1'}\\\\ \\mu^*(t^+)-\\mu^*(t^-)\\geq 0 \\ & \\ \\ \\ \\textnormal{if } \\ \\ell[q^*](t)=e^+(t),\\label{eq : mucond2'}\\\\ \\mu^*(t^+)-\\mu^*(t^-)\\leq 0 \\ & \\ \\ \\ \\textnormal{if } \\ \\ell[q^*](t)=e^-(t)\\label{eq : mucond3'},\\end{aligned}\\ ] ] where @xmath62 and @xmath63 are the left and right limits respectively of @xmath59 at @xmath64    then @xmath28 is an optimal strategy .",
    "let @xmath65 and let @xmath66 be a partition such that @xmath67=[0,t]$ ] and @xmath68 are continuous and @xmath59 is differentiable over each @xmath69 notice that ( [ elldefn ] ) can be equivalently written as @xmath70(t)=e^{\\alpha t}q(t ) \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\forall t\\in[0,t].\\ ] ] hence , ( [ eq : propmax ] ) implies @xmath71&-c[q]\\leq\\int_0^te^{\\alpha t}\\mu^*(t)\\big(q^*(t)-q(t)\\big)dt+\\rho^*\\big(\\underbrace{s[q^*]-s[q]}_{=0}\\big)\\\\ & \\stackrel{(\\ref{elldefn})}{=}\\sum_{i=1}^n\\int_{a_i}^{a_{i+1}}\\mu^*(t)\\left\\{\\frac{d}{dt}\\big(e^{\\alpha t}\\ell[q^*](t)-e^{\\alpha t}\\ell[q](t)\\big)\\right\\}dt\\\\ & = \\sum_{i=1}^n\\big[e^{\\alpha a_{i+1}}\\mu^*(a_{i+1}^-)\\left(\\ell[q^*](a_{i+1})-\\ell[q](a_{i+1})\\right)-e^{\\alpha a_i}\\mu^*(a_i^+)\\left(\\ell[q^*](a_i)-\\ell[q](a_i)\\right)\\big]\\\\ & \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\   \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\   -\\sum_{i=1}^n\\int_{a_i}^{a_{i+1}}e^{\\alpha t}{\\frac{d{\\mu^*}}{dt}}(t)\\left(\\ell[q^*](t)-\\ell[q](t)\\right)dt\\\\ & = \\sum_{i=2}^ne^{\\alpha a_i}\\left(\\mu^*(a_i^-)-\\mu^*(a_i^+)\\right)\\left(\\ell[q^*](a_i)-\\ell[q](a_i)\\right)\\\\ & \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\   \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\   -\\sum_{i=1}^n\\int_{a_i}^{b_i}e^{\\alpha ( t)}{\\frac{d{\\mu^*}}{dt}}(t)\\left(\\ell[q^*](t)-\\ell[q](t)\\right)dt\\end{aligned}\\ ] ] where we have used the fact that , since @xmath17 and @xmath28 are admissible , then @xmath72=s[q]=0.$ ] the second equality follows from integration by parts and final equality results from a rearrangement of the first sum on the previous line , together with the condition that @xmath18(0)=\\ell[q^*](0)=e^-(0)$ ] and @xmath18(t)=\\ell[q^*](t)=e^-(t)$ ] if @xmath73 applying the complementary slackness conditions ( [ eq : mucond1])-([eq : mucond3 ] ) to the final equality above , we obtain @xmath74-c[q]\\leq 0.$ ]    the reference price @xmath59 provides a reference cost per unit of power .",
    "roughly , if the cost per unit of power for operating the store is lower than the reference price , then this indicates the store should charge at that time ( and similarly for discharging ) .",
    "it is worth mentioning here that exactly the same result follows if we apply the karush - kuhn - tucker ( kkt ) conditions to the capacity constraints of the original minimization problem  ( [ minprob ] ) . by following such an approach ,",
    "one instead looks for minimizers of the relaxed functional @xmath75-\\int_0^t\\big(\\lambda_1(t)\\left(\\ell[q](t)-e^-(t)\\right)+\\lambda_2(t)\\left(e^+(t)-\\ell[q](t)\\right)\\big)dt+\\rho^*s[q]\\end{aligned}\\ ] ] over all piecewise - continuous @xmath7\\to\\re$ ] such that @xmath48 for all @xmath1,$ ] where @xmath76\\to\\re$ ] are piecewise - continuous functions which satisfy the complementary slackness conditions @xmath77(t)-e^-(t)\\right)=\\lambda_2(t)\\left(e^+(t)-\\ell[q](t)\\right)=0 \\ \\ \\ \\ \\ \\ \\ \\forall t\\in[0,t].\\ ] ] the relation between the two approaches is that the reference price function @xmath59 in proposition  [ prop : ps ] can be expressed as an integral of the kkt functions : @xmath78 and , in particular , @xmath79    the following lemma shows that , in certain cases , we should expect the determination of minimizers @xmath28 to reduce to a sequence of smaller minimization problems which are localized in time .",
    "[ lemma : constraints][localization of the minimization problem ] let @xmath80\\to\\re$ ] be the admissible domain , @xmath81 be the set of admissible power outputs at each time @xmath1 $ ] and let @xmath45 be a cost functional of the form @xmath82=\\int_0^tl(t , q(t ) ) \\ dt   \\end{aligned}\\ ] ] for some running cost function @xmath83 where @xmath84 is the set of time ",
    "power pairs @xmath85\\times\\re$ ] such that @xmath86 for each @xmath1,$ ] let @xmath87 and @xmath88 assume that there exists an optimal strategy which satisfies the conditions of proposition  [ prop : ps ] and suppose that the optimal level of the store at some time @xmath89 $ ] is known to be @xmath90 with @xmath91 for any @xmath92,$ ] let @xmath93 solve the minimization problem @xmath94 over all piecewise continuous @xmath95\\to\\re$ ] such that @xmath48 for all @xmath1 $ ] and such that the end conditions @xmath18(\\sigma)=\\ell_i(\\sigma)$ ] and @xmath18(\\sigma_0)=\\ell$ ] hold .",
    "if there exists a time @xmath96 such that @xmath97(t_0)=\\ell_j(t_0),$ ] with @xmath98 then there exists an optimal strategy @xmath51 which coincides exactly with @xmath93 over the interval @xmath99    assume first that @xmath100 so that @xmath97(t_0)=\\ell_2(t_0)$ ] and @xmath97(\\sigma)=\\ell_1(\\sigma).$ ] let @xmath51 be an optimal strategy , let @xmath93 satisfy the hypotheses above and suppose that the claim of the lemma is not true",
    ". then @xmath29(\\sigma)>\\ell_1(\\sigma)$ ] ( since otherwise we could replace @xmath28 with @xmath93 over @xmath101 $ ] to either reduce the total cost or keep the cost the same ) .",
    "thus there must exist at least one interval @xmath102 with @xmath103 such that @xmath29(a)-\\ell[q_{\\sigma}](a)=\\ell[q^*](b)-\\ell[q_{\\sigma}](b)=0 $ ] and @xmath29(t)\\neq\\ell[q_{\\sigma}](t)$ ] for all @xmath104 however , this implies that both @xmath28 and @xmath93 must be minimizers of @xmath105 over all admissible @xmath106\\to u$ ] such that @xmath18(a)=\\ell[q^*](a)$ ] and @xmath18(b)=\\ell[q^*](b).$ ] in particular , we may adapt @xmath28 if necessary so that @xmath107 for all @xmath108 repeating this argument for all such intervals @xmath109 completes the proof that the optimal strategy can be chosen to coincide with @xmath93 over @xmath99 a similar argument holds for the case where @xmath110    the significance of the above lemma is that @xmath93 depends only on knowledge of a previous time @xmath111 when the store is either full or empty , and on the action of the cost functional over the time interval @xmath112.$ ] in particular , starting at time 0 , one sets @xmath113 and finds a time @xmath114 $ ] such that the minimizer @xmath93 of ( [ eq : lemmamin ] ) hits the upper capacity constraint at some time in @xmath115 the optimal strategy @xmath51 can thus be chosen to coincide with @xmath93 over the interval @xmath116.$ ] we then set @xmath117 and @xmath118 and repeat the process . continuing in this way , we eventually construct a global optimizer @xmath119",
    "we assume in this section that the only constraints faced by the store are its capacity and power constraints ( i.e. @xmath120 ) . for simplicity of notation , we assume from now on that there is a fixed set of power constraints @xmath121 such that @xmath122 for all @xmath1.$ ] all of the results extend naturally to the more general case where @xmath123 is allowed to vary with time .",
    "we present an algorithm to determine @xmath124 and consequently the optimal strategy @xmath125 for the class of functionals @xmath45 which take the form  ( [ c ] ) for some @xmath126\\times u\\to\\re$ ] with @xmath127 for all @xmath1.$ ] we assume that , for each @xmath1,$ ] the map @xmath128 is piecewise differentiable and that the associated partial derivative @xmath129 has a continuous inverse at almost every @xmath130 this class of functionals contains costs which depend only on the time @xmath12 and the power output of the store at that time .",
    "the piecewise differentiability assumption allows for jumps in the cost .",
    "these jumps may relate to the cost of switching on an additional motor in order to provide a higher power output , for example .",
    "proposition  [ prop : ps ] states that , if we can find the appropriate reference price function @xmath124 then the optimal strategy @xmath51 solves @xmath131\\leq\\l[q,\\mu^ * ] \\ \\ \\ \\ \\ \\ \\forall \\ q:[0,t]\\to u,\\end{aligned}\\ ] ] where for any functions @xmath132\\to\\re,$ ] we define the relaxed functional @xmath133=\\int_0^t\\big(l(t , q(t))-{e^{\\alpha t}}\\mu(t)q(t)\\big ) \\",
    "dt.\\end{aligned}\\ ] ] the regularity assumptions on @xmath134  @xmath17 and @xmath135 imply that ( [ argmin ] ) reduces to a minimization problem which is pointwise in time . specifically , for almost all @xmath1,$ ] we search for @xmath136 which solves @xmath137    our algorithm is a generalization of that provided in @xcite .",
    "an important result is proposition  [ prop : algpot2 ] , which states that if the algorithm does not terminate early , then it does indeed provide an optimal strategy @xmath119 in particular , in the special case that the cost functional @xmath45 is strictly convex , then there exists a unique optimal strategy , and this coincides exactly with @xmath119      by proposition  [ prop : ps ] , we aim to find a piecewise differentiable @xmath57\\to\\re$ ] such that the optimal strategy @xmath51 solves ( [ argmin ] ) .",
    "moreover , @xmath59 should be constant over intervals of time where the level of the store is away from the capacity constraints .",
    "this motivates the following construction :    given @xmath1 $ ] and @xmath138 we want to define a quantity @xmath139 as a solution of @xmath140 if we know that @xmath141 over some connected interval @xmath14,$ ] then we hope that @xmath142 for all @xmath16 care needs to be taken , however , because there may be multiple minimizers associated with @xmath143 with this in mind , we denote by @xmath144 the set of @xmath145 which admit multiple minimizers in ( [ algmin1 ] ) .",
    "note that , if @xmath146 is assumed to be strictly convex in its second argument , then minimizers of ( [ eq : propmax ] ) are of course unique , implying that each @xmath147    [ lemma : xinc ] for each @xmath148\\times\\re,$ ] let @xmath149 be any solution of ( [ algmin1 ] )",
    ". then , at each @xmath1,$ ] the mapping @xmath150 is monotone increasing and piecewise continuous .",
    "moreover , the set @xmath151 is finite and discontinuities in @xmath152 occur only at points in @xmath153    let @xmath1 $ ] and suppose that the map @xmath150 is not monotone increasing .",
    "then , there exists @xmath154 such that @xmath155 but then , @xmath156 the first inequality follows from the definition of @xmath157 and @xmath158 as solutions to ( [ algmin1 ] ) , and the second inequality follows from the supposition .",
    "however , the above contradicts the definition of @xmath159 and we conclude that the map @xmath160 is monotone increasing at all @xmath161.$ ]    the piecewise continuity of the map @xmath150 follows immediately from the regularity assumptions on @xmath162 precisely , if for almost all @xmath138 the minimizers @xmath149 lie away from discontinuities of @xmath134 then they must satisfy that @xmath163 the continuous invertibility assumption on the partial derivative of @xmath146 therefore implies the piecewise continuity of the map @xmath164 if , on the other hand , there is a non - degenerate subset @xmath165 such that if @xmath166 then @xmath149 lies at a discontinuity of @xmath134 then the above monotonicity property and the piecewise continuity of @xmath146 imply that the map @xmath150 must be piecewise constant over @xmath167 in either case , the map @xmath150 is piecewise continuous .    finally , we prove the finiteness of the set @xmath168 by supposing that the opposite is true . to this end , let @xmath169 be an infinite set such that , for each @xmath170 there are two distinct local solutions @xmath171 to ( [ algmin1 ] ) , where @xmath172 denotes the boundary of the set @xmath173 let @xmath174 be such that there exists a sequence @xmath175 in @xmath176 with @xmath177 and set @xmath178 and @xmath179 assume without loss of generality that @xmath180 is satisfied at @xmath181 where @xmath182 denotes the partial derivative of @xmath146 with respect to the second argument , and that @xmath183 and @xmath184 lie away from any discontinuity of @xmath162 setting @xmath185 and @xmath186 we obtain @xmath187 and similarly , @xmath188 hence , if @xmath189 and @xmath190 are both global minimizers solving ( [ algmin1 ] ) but @xmath191 then there exists @xmath192 such that @xmath193 for all @xmath194 in particular , @xmath195 and @xmath196 can not both be minimizers for @xmath194 this contradicts the assumption that there exists such a set @xmath197    the definitions which follow will be employed in the algorithm , and are written under the assumption that there exists a pair @xmath198 which satisfies the complementary slackness conditions of proposition  [ prop : ps ] .",
    "condition  ( [ eq : mucond1 ] ) motivates the following definition .    for any choice of @xmath199 and @xmath200,$ ]",
    "we say a piecewise continuous function @xmath201\\rightarrow u$ ] is @xmath202admissible if @xmath203 over @xmath204 $ ] and if , for each @xmath1,$ ] @xmath205 is a solution of @xmath206 in particular , the mapping @xmath207 coincides with @xmath208 over @xmath209,$ ] for some choice of map @xmath210 which solves ( [ algmin1 ] ) at each @xmath1.$ ]    note that , in general , a @xmath202admissible strategy @xmath211 is not admissible : for a general choice of @xmath212 one of the capacity constraints is likely to be broken at some time in @xmath213.$ ] the idea of the algorithm is to piece together @xmath202admissible strategies in order to construct the optimal strategy @xmath214 the reference price @xmath59 attains the appropriate value of @xmath145 over intervals of time when @xmath59 is constant in the special case that one can find a @xmath215admissible strategy which is also admissible ,",
    "then of course we are done , since we may set @xmath216 such a strategy satisfies condition  ( [ eq : mucond1 ] ) at every @xmath1.$ ]    the key feature of the algorithm is thus to determine : ( i ) the intervals of time over which @xmath59 is constant and ( ii ) the value that @xmath59 attains over these intervals .",
    "intuitively , we expect the store to completely fill whenever costs are sufficiently low .",
    "the store will then wait for costs to rise before fully discharging .",
    "correspondingly , the reference price should increase over this waiting period , from @xmath217 say to @xmath218 .",
    "if we did not allow for this increase in reference price , then the associated strategy would cause the store to begin discharging too soon and to empty too much , thus breaking the lower capacity constraint in order to take advantage of the low costs .",
    "this behaviour is an indication that @xmath217 is the correct choice of reference price over the charging period .",
    "this motivates the following characterization of strategies .",
    "[ fnset ] let @xmath200,$ ]  @xmath199 and @xmath219.$ ] we characterize each @xmath202admissible @xmath201\\to u$ ] according to sets @xmath220 and @xmath221 as follows :    a.   we write @xmath222 if there exists @xmath223 and @xmath224 such that @xmath225(t)&=e^-(t ) \\qquad \\textnormal{and } \\qquad   m+\\ell[x](t+\\varepsilon)<e^-(t+\\varepsilon)\\end{aligned}\\ ] ] for all @xmath226 with @xmath227(t')\\leq e^+(t ' ) \\qquad \\forall t'\\in(\\tau , t ) .",
    "\\end{aligned}\\ ] ] + in other words , if the level of the store at time @xmath228 is @xmath229 and if the store adopts the strategy @xmath211 over @xmath213,$ ] then the first violation of a capacity constraint occurs at the lower bound of @xmath230 we write @xmath231.$ ] b.   similarly , we write @xmath232 if there exists @xmath223 and @xmath224 such that condition  ( [ defncond ] ) holds and @xmath225(t)&=e^+(t ) \\qquad \\textnormal{and } \\qquad   m+\\ell[x](t+\\varepsilon)>e^+(t+\\varepsilon)\\end{aligned}\\ ] ] for all @xmath233 in other words , if the level of the store at time @xmath228 is @xmath229 and if the store adopts the strategy @xmath211 over @xmath213,$ ] then the first violation of a capacity constraint occurs at the upper bound of @xmath230 we write @xmath231.$ ] c.   we say @xmath234 if there exists a @xmath202admissible @xmath235 similarly , @xmath236 if there exists a @xmath202admissible @xmath237    lemma  [ lemma : xinc ] implies that @xmath238 and @xmath239 are each connected subintervals of @xmath176 which satisfy @xmath240\\times[0,m ] .",
    "\\end{aligned}\\ ] ] in particular , the interiors of the two sets are disjoint : @xmath241\\times[0,m ] .",
    "\\end{aligned}\\ ] ]      we are now in a position to outline the algorithm . to this",
    "end , fix @xmath242 and suppose that @xmath59 and @xmath28 are known over @xmath204.$ ] we assume without loss of generality that @xmath243(\\tau)\\in\\{e^-(\\tau),e^+(\\tau)\\}$ ] ( otherwise , move @xmath228 backwards until this is satisfied ) .",
    "the algorithm will identify an @xmath192 and two increasing sequences of times @xmath244,@xmath245 such that @xmath246 for each @xmath247 and such that @xmath248 whenever @xmath249 the reference price @xmath59 is only allowed to jump in value at times of the form @xmath250 or @xmath251 we may assume without loss of generality that @xmath252 for some @xmath253 ( otherwise , again , move @xmath228 backwards until this is true ) . recall from definition  [ fnset ] that @xmath254 $ ] is the time at which a strategy @xmath211 first breaks a capacity constraint , given that @xmath255 +   + * step 1 : * if there exists @xmath199 and a @xmath256admissible @xmath211 such that @xmath257 then set @xmath258 set @xmath259 for all @xmath260 $ ] and define the restriction of @xmath28 to @xmath261 $ ] to be @xmath262 * the algorithm is complete . *",
    "if there is no @xmath145 satisfying these conditions , proceed to step 2 . +",
    "* step 2 : * set @xmath263 there are three cases . for each case",
    ", we define the pair @xmath198 restricted to an interval @xmath264\\subset(\\tau_k , t].$ ]    * if @xmath265 choose a @xmath256admissible @xmath211 such that @xmath266(\\sigma_k)=e^+(\\sigma_k)$ ] for some @xmath267),$ ] and select the latest such @xmath268 set @xmath259 for all @xmath269 $ ] and define the restriction of @xmath28 to @xmath264 $ ] to coincide with @xmath262 if @xmath270 proceed to step 3 ; if @xmath271 proceed to step 4 . *",
    "if @xmath272 choose a @xmath256admissible @xmath211 such that @xmath266(\\sigma_k)=e^-(\\sigma_k)$ ] for some @xmath267),$ ] and select the latest such @xmath268 set @xmath259 for all @xmath269 $ ] and define the restriction of @xmath28 to @xmath264 $ ] to coincide with @xmath262 if @xmath270 proceed to step 3 ; if @xmath271 proceed to step 4 .",
    "* if @xmath273 choose a @xmath256admissible @xmath211 such that either @xmath266(\\sigma_k)=e^+(\\sigma_k)$ ] or @xmath266(\\sigma_k)=e^-(\\sigma_k)$ ] for some @xmath267),$ ] and select the latest such @xmath268 set @xmath259 for all @xmath269 $ ] and define the restriction of @xmath28 to @xmath264 $ ] to coincide with @xmath262 if @xmath270 proceed to step 3 ; if @xmath271 proceed to step 4 .    * step 3 : * let @xmath274 be the first time in @xmath275 $ ] such that , on relabeling @xmath274 as @xmath276 and @xmath266(\\tau_{k+1})$ ] as @xmath229 and on determining the new associated @xmath277 from steps 1 and 2 , we have @xmath278 relabel @xmath274 as @xmath276 and return to step 1 .",
    "if there is no such @xmath279 then we have found all intervals @xmath280 over which @xmath281 proceed to step 4 .",
    "+ * step 4 : * over each interval @xmath282,$ ] corresponding to the times found in the steps above , and for each @xmath283,$ ] define @xmath284(\\sigma_i)=e^+(\\sigma_i)\\\\                   \\frac{d}{dt } e^-(t)+\\alpha e^-(t ) & & \\textnormal{if } \\",
    "\\ell[q](\\sigma_i)=e^-(\\sigma_i ) .",
    "\\end{array } \\right .",
    "\\end{aligned}\\ ] ] * the algorithm is complete * if , for each each @xmath285 there exists a piecewise differentiable @xmath286 such that the following conditions hold :    * @xmath287 is a minimizer of @xmath288 over all @xmath289 * if @xmath29(\\sigma_i)=e^+(\\sigma_i),$ ] then @xmath290 is non - decreasing over @xmath291 and satisfies that @xmath292 and @xmath293 * if @xmath29(\\sigma_i)=e^-(\\sigma_i),$ ] then @xmath59 is non - increasing over @xmath282 $ ] and satisfies that @xmath294 and @xmath295    if these conditions do not hold , the algorithm ends here and yields no solution @xmath119 + * end of algorithm * + the above algorithm implicitly reduces the original optimization problem to a series of new optimization problems which are localized in time . at each time",
    "@xmath296 one only needs to look ahead to a time @xmath297 to know how to operate the store over @xmath298 where @xmath297 is defined as @xmath254 $ ] for the appropriate choice of @xmath211 and @xmath299 from step 2 of the algorithm ( or as the the minimum value of @xmath254 $ ] whenever there there is a choice of @xmath211 ) .",
    "hence , whilst we originally assumed knowledge of the entire price function @xmath4\\to[0,\\infty),$ ] in practice we may not need so much information .",
    "the following result states that , provided the algorithm does not terminate early , then it does indeed give an optimal strategy @xmath119 proposition  [ prop : algpot2 ] then states the converse : if there is an optimal strategy , which satisfies the conditions of proposition  [ prop : ps ] , then the algorithm will find it ( in other words , the algorithm will not terminate early ) .",
    "[ prop : algopt ] if the above algorithm yields a strategy @xmath300\\to u,$ ] then @xmath28 is an optimal strategy .",
    "let @xmath198 be the pair which is determined through the algorithm and let @xmath244 and @xmath301 be the associated sequences of time , so that @xmath59 is constant over each interval @xmath302 assume that the conditions of proposition  [ prop : ps ] are satisfied up until time @xmath303 at each @xmath285 we have @xmath304(\\tau_i))\\leq\\mu^*(\\tau_i^+)\\leq\\inf\\lambda'(\\tau_i,\\ell[q^*](\\tau_i)).\\end{aligned}\\ ] ] if the conditions of step 1 are satisfied at @xmath296 then @xmath28 is clearly admissible and satisfies the properties of the proposition .",
    "hence , @xmath28 is optimal and the algorithm is complete .",
    "assume therefore that the conditions of step 1 do not hold at @xmath276 so that @xmath305 it is clear that the strategy defined by the algorithm is admissible , and it remains to check that conditions ( [ eq : mucond1])-([eq : mucond3 ] ) are satisfied by @xmath53    to this end , note that , the algorithm ensures that the conditions are satisfied over the intervals @xmath306 and @xmath307,$ ] and it remains to check that the conditions hold at @xmath268 suppose first that case a ) of step 2 is satisfied at time @xmath296 so that @xmath29(\\sigma_k)=e^+(\\sigma_k).$ ] then , by construction , we have @xmath308 thus , if @xmath309 then , together with ( [ lambdamu ] ) , this implies @xmath310 and condition ( [ eq : mucond2 ] ) is satisfied at @xmath268 if , on the other hand , @xmath311 then the construction of @xmath59 through the algorithm immediately implies that @xmath312 similarly , if case b ) of step 2 holds at @xmath296 then @xmath29(\\sigma_k)=e^-(\\sigma_k)$ ] and @xmath313 thus , if @xmath309 then , together with ( [ lambdamu ] ) , this implies @xmath314 and condition ( [ eq : mucond3 ] ) is satisfied at @xmath268 if , on the other hand , @xmath311 then the construction of @xmath59 through the algorithm immediately implies that @xmath315 finally , if case c ) holds at @xmath316 then the above two cases together imply that the conditions of proposition  [ prop : ps ] are satisfied .",
    "[ prop : algpot2 ] if the algorithm terminates early , then there is no pair @xmath198 which satisfies the conditions of proposition  [ prop : ps ] .",
    "let @xmath198 be a pair generated by the algorithm .",
    "( if the algorithm terminates early , at a time @xmath317 say , then @xmath59 and @xmath28 are both considered as functions over the domain @xmath318.$ ] ) let @xmath319 and @xmath320 be the sequences of time generated by the algorithm , so that @xmath59 is constant over each @xmath321 we write @xmath322(\\tau_k)$ ] and assume that each interval @xmath306 is maximal in the sense that if @xmath323 is a strictly larger interval , then @xmath59 is not constant over this interval .",
    "suppose also that there is a pair @xmath324 which satisfies the conditions of proposition  [ prop : ps ] .",
    "analogously , let @xmath325 and @xmath326 be increasing sequences which define the end - times of all maximal intervals @xmath327 over which @xmath135 is constant .",
    "we write @xmath328(t_k)$ ] and @xmath329 we make the following additional assumptions on the pair @xmath324 : suppose there is a pair of times @xmath330 $ ] such that @xmath331 and @xmath18(t)\\in\\{e^-(t),e^+(t)\\}$ ] for each @xmath332 if there exists a pair @xmath333 such that ( i ) the conditions of proposition  [ prop : ps ] are satisfied , ( ii ) @xmath334(\\tau)=\\ell[q](\\tau)$ ] and @xmath334(\\tau')=\\ell[q](\\tau'),$ ] and ( iii ) @xmath335 for all @xmath336 then we assume that @xmath324 agrees with @xmath333 over the larger interval @xmath337 in other words , we always take @xmath135 to be constant whenever there is the choice .    throughout this proof , we will use the notation @xmath338 if the set of @xmath339admissible functions coincides exactly with the set of @xmath340admissible functions over the interval @xmath341 this assumption is only required to handle the degenerate cases where @xmath17 is identically zero over @xmath341 in these cases , there may be a choice of values to assign to @xmath342 each of which would result in the same @xmath343admissible @xmath17 over @xmath341 we introduce the ordering @xmath344 if @xmath345 and @xmath346    the proof consists of proving that the following statements are true at each @xmath253 :    1 .",
    "@xmath347 and @xmath17 is @xmath343admissible over the interval @xmath341 2 .",
    "there exists @xmath348 such that @xmath349 3 .   if @xmath348 and @xmath350 then @xmath351 and @xmath18(t_k)=\\ell[q](\\sigma_k).$ ]    the first statement is required to prove statement 2 , and implies that the algorithm determines the correct value of @xmath135 over each interval",
    "together , statements 2 and 3 then complete the proof , since they imply that the algorithm uncovers all intervals @xmath327 over which @xmath135 is constant .",
    "moreover , statement 3 implies that the strategy uncovered by the algorithm agrees with @xmath28 at the end point of each of these intervals .",
    "hence , in between each @xmath277 and @xmath279 the strategies @xmath17 and @xmath28 necessarily lie on the capacity constraints and so must coincide .",
    "in particular , the existence of the pair @xmath324 implies that the algorithm does not terminate early but instead generates a pair @xmath198 which are defined over @xmath0.$ ]    _ proof of statement 1 : _ let @xmath352 it is clear from the definition of @xmath343admissibility and from the requirement that @xmath17 must be a minimizer of ( [ minptwise ] ) , that @xmath17 must be @xmath343admissible over the interval @xmath327 .",
    "we need to show that @xmath353    recall that the maps @xmath150 of lemma  [ lemma : xinc ] are piecewise continuous and monotone increasing at each time @xmath1.$ ] these maps are constructed in such a way that one can always find a suitable @xmath354 to coincide with @xmath17 over @xmath341 thus , the monotonicity of @xmath210 with respect to its second argument implies the relations : @xmath355 suppose now that @xmath356 if @xmath357(s_k)=e^+(s_k),$ ] then this immediately implies that @xmath358 since , otherwise , the continuity and monotonicity of @xmath210 would imply the existence of @xmath359 such that @xmath360 and a @xmath361admissible @xmath362 such that @xmath363(t)\\geq e^+(t)$ ] for all @xmath364,$ ] with strict inequality at @xmath365 this would imply that @xmath366 which contradicts ( [ beta1 ] ) .",
    "if , on the other hand , @xmath357(s_k)=e^-(s_k),$ ] then proposition  [ prop : ps ] requires that @xmath367 if @xmath135 is constant over an interval @xmath368,$ ] then the monotonicity property of lemma  [ lemma : xinc ] implies that the lower capacity constraint will be broken by @xmath43 and no admissible solution will be found .",
    "if @xmath135 is not constant over any such interval , then proposition  [ prop : ps ] requires that @xmath369 for all @xmath370 by the monotonicity of @xmath371 this is only possible if @xmath372 at some @xmath373 or if @xmath374 since otherwise the fact that @xmath375 implies that @xmath17 will break the lower capacity constraint .",
    "however , this contradicts condition  ( [ eq : mucond3 ] ) of the proposition .",
    "hence , we must have @xmath358 or @xmath376 if @xmath377 then similar arguments as above arrive at analogous contradictions to proposition  [ prop : ps ] and",
    "we conclude that we must therefore have @xmath378 this completes the proof of statement 1 .",
    "_ proof of statement 2 : _ suppose first that @xmath379 but that there is no @xmath348 such that @xmath380 then , statement 1 implies that @xmath381 and that @xmath17 must coincide with some @xmath382admissible @xmath211 over @xmath383 however , since @xmath228 does not coincide with any @xmath384 the conditions of steps 1 and 2 of the algorithm do not hold at time @xmath385 if @xmath386 then proposition  [ prop : ps ] implies that @xmath387 and @xmath18(s_k)=e^-(s_k)$ ] ( since the conditions of step 2 do not hold ) . thus , proposition  [ prop : ps ] implies that either ( i ) @xmath388 and @xmath389 or ( ii ) @xmath390 and @xmath391 for all @xmath392.$ ] in case ( i ) , the monotonicity property of lemma  [ lemma : xinc ] implies that @xmath17 breaks the lower capacity constraint . in case ( ii ) , since @xmath211 breaks the lower capacity constraint , we must have that @xmath393 for all @xmath394 in some interval @xmath395.$ ] however , since we require that @xmath396 for all @xmath397 this means that we must have @xmath398 for all @xmath394 in some subset @xmath399 this contradicts the conditions of proposition  [ prop : ps ] , and we conclude that there exists @xmath348 such that @xmath380 the same result follows from similar arguments if @xmath400 this completes the proof of statement 2 .",
    "_ proof of statement 3 : _ let @xmath401 first notice that the proof of statement 2 yielded a contradiction when we assumed that @xmath17 coincided with a @xmath343admissible @xmath402 such that @xmath387 and @xmath18(s_k)=e^-(s_k).$ ] since statement 1 implies that @xmath17 must coincide with some @xmath343admissible @xmath211 over @xmath403 it follows that , if @xmath386 then either @xmath404 or @xmath18(s_k)=e^+(s_k).$ ] similarly , if @xmath405 then either @xmath404 or @xmath18(s_k)=e^-(s_k).$ ] the assumption that the intervals @xmath327 are maximal thus implies that @xmath406 coincides with @xmath407 and that @xmath18(s_k)=\\ell[q^*](\\sigma_j),$ ] provided that @xmath407 is independent of any choices made at steps 1 or 2 of the algorithm .",
    "this independence is not immediately clear since the general assumptions on the cost function @xmath146 mean that there may be more than one choice of @xmath408admissible strategy .    to prove the independence of @xmath407 from the choice of strategy made in the algorithm at steps 1 or 2 ,",
    "suppose that there are two @xmath408admissible strategies @xmath409 and @xmath410 which satisfy the conditions of step 1 or 2 of the algorithm .",
    "let @xmath411 denote the time @xmath407 if strategy @xmath412 is chosen at time @xmath228 and assume without loss of generality that @xmath413 the monotonicity property of lemma  [ lemma : xinc ] makes it immediately clear that , if we choose @xmath409 then the algorithm will select @xmath414 for all @xmath415 hence , @xmath59 is constant over @xmath416 in particular , if there are several choices of strategy to choose at time @xmath316 and if @xmath417 is the latest time @xmath407 associated with any of the choices , then the assumption that each interval @xmath418 is maximal implies that @xmath419 regardless of the strategy chosen .",
    "this completes the proof of statement 3 .",
    "we introduce here a simple but practically relevant model of a store , which operates purely within a single wholesale market .",
    "the set of admissible powers @xmath123 is taken to be of the form @xmath420,$ ] with @xmath421 the store is assumed to have a fixed maximum energy capacity @xmath422 so that the admissible domain satisfies @xmath423 and @xmath424 for all @xmath425 we further assume that we require the store to be empty at both the start and end times , so that @xmath426 the cost functional @xmath45 is defined by @xmath427=\\int_0^tw(q(t))p(t)q(t),}\\end{aligned}\\ ] ] where @xmath428 is the price for one unit of power at time @xmath64 here , @xmath429 is a piecewise continuous function which acts as a weighting to the cost of buying and selling electricity , and should satisfy that @xmath430",
    "if @xmath431 and @xmath432 if @xmath433 more intuitively , @xmath434 can be thought of as the result of inefficiencies during the charging and discharging processes of the store : in order to fill the store at a rate @xmath435 at time @xmath8 the storage operator would actually need to purchase a greater amount of electricity , since power is lost during the charging process .",
    "similarly , whenever an amount @xmath435 is discharged from the store , a lesser amount is actually available to sell on the market . for simplicity , we assume that @xmath434 takes on two values @xmath436 and @xmath437,$ ] so that @xmath438 in the special case where there are no additional operating constraints ( i.e. @xmath439 , this cost functional is convex and thus an optimal strategy exists",
    ". proposition  [ prop : algpot2 ] states moreover that an optimal strategy can be determined via the algorithm of section  [ sec : alg ] .",
    "some simple results are immediately available , as stated in the following lemma .",
    "define the parameters of a store as above and let the cost functional @xmath45 be given by ( [ eq : cexample ] ) .",
    "assume that @xmath440 for all @xmath1 $ ] and let @xmath441 be the required levels of stored energy at times @xmath442 and @xmath443 respectively .",
    "the following properties hold :    1 .   if @xmath444 and @xmath445 then there is no non - zero strategy @xmath65 which yields a positive profit .",
    "the minimum cost , over all admissible strategies , is a decreasing function of @xmath446 and @xmath447 it is an increasing function of @xmath448 and @xmath449    if @xmath65 is not the zero function , and if @xmath450 is constant for all @xmath1,$ ] then @xmath75= p\\int_0^tw(q(t))q(t ) \\",
    "dt\\geq p\\int_0^tq(t ) \\ dt = p\\left(\\ell_t-\\ell_0\\right)+\\alpha\\int_0^t\\ell[q](t ) \\ dt \\geq 0.\\end{aligned}\\ ] ] this proves statement 1 . to prove statement 2 ,",
    "let @xmath28 be the optimal strategy associated with the parameters @xmath451 and write @xmath452.$ ] it is easy to see that @xmath28 is also admissible with respect to the parameters @xmath453 for any @xmath454 and any @xmath455 with @xmath456  @xmath457 and @xmath458 thus , if @xmath459 is defined by @xmath460 whenever @xmath461 and @xmath462 whenever @xmath463 then @xmath464 this proves the required growth conditions of the minimum cost with respect to @xmath465 and @xmath466 to complete the proof , let @xmath467 and denote by @xmath468(t)$ ] the level of stored energy at time @xmath12 associated with the strategy @xmath17 and the leakage rate @xmath469 set @xmath470 whenever @xmath471 or @xmath472(t)<m.$ ] for all other @xmath1,$ ] set @xmath473 then @xmath362 is admissible with respect to the new parameter vector @xmath474 hence , @xmath475=c[q']+\\int_0^tw(q(t))p(t)\\left(q^*(t)-q'(t)\\right ) \\",
    "dt\\geq c[q']\\geq v(\\theta')\\end{aligned}\\ ] ] and the minimum cost function is increasing with respect to the leakage rate @xmath476      throughout this section , we employ the notation @xmath477 and @xmath478 to mean @xmath479 and @xmath480 respectively for any @xmath481 we investigate the impact of introducing a non - empty set of additional constraints @xmath42 to the simple storage model introduced above . in this",
    "setting , lemma  [ lemma : constraints ] no longer holds in general .",
    "it is therefore not clear that there will exist a method with similar time - localization properties as the algorithm of section  [ sec : alg ] .",
    "we demonstrate this problem explicitly in this section .",
    "in particular , we impose a minimum switching time constraint @xmath482 on the simple storage model introduced above .",
    "this is the minimum amount of time for which the store must be idle when switching between the charging and discharging modes of operation .",
    "hence the additional constraint set @xmath42 consists of the requirement that any power output @xmath17 must satisfy that @xmath483 \\",
    "\\textnormal{and } \\",
    "s\\in(t-\\tau , t+\\tau)\\cap[0,t].\\end{aligned}\\ ] ] the minimization problem of proposition  [ prop : ps ] is difficult to solve in its current form , but we may rewrite the problem by adapting the lagrangian @xmath484 of ( [ relaxed ] ) to incorporate the minimum switching time constraint as follows : @xmath485:=\\underbrace{\\int_0^t\\big(w(q(t))p(t)-e^{\\alpha t}\\mu(t)\\big)q(t ) \\",
    "dt}_{{=\\mathcal l[q,\\mu]}}-\\int_0^t\\int_t^{(t+\\tau)^-}\\lambda(t , s)q(s)q(t ) \\ ds   \\ dt\\ ] ] for all piecewise continuous @xmath132\\to u$ ] and @xmath486 ^ 2\\to[0,\\infty].$ ] in order to apply proposition  [ prop : ps ] , we need to reduce @xmath487 into a form which is compatible with ( [ eq : propmax ] ) . to do this , we carefully choose @xmath145 to depend on @xmath17 and @xmath135 as follows : for a given @xmath342 let @xmath488\\to u$ ] solve @xmath489 since the efficiency function @xmath434 takes the simple form ( [ w ] ) , it is clear that @xmath490 takes a value in @xmath491 whenever @xmath492 and @xmath493 at @xmath1.$ ] in these cases @xmath490 is uniquely defined .",
    "if one of these relations is an equality instead , however , then @xmath490 may take any value in @xmath173 hence , there may be multiple solutions associated with @xmath494 let now @xmath145 minimize @xmath495 over all @xmath486 ^ 2\\to[0,\\infty]$ ] such that ( i ) @xmath496 whenever @xmath497 and ( ii ) the inequality @xmath498 holds for all @xmath1.$ ] we write @xmath499    the significance of the above construction is that an optimal strategy can now be found by searching for minimizers of @xmath500 specifically , if a strategy @xmath28 satisfies that @xmath501\\leq\\lambda[q,\\mu^*,\\lambda^*]\\end{aligned}\\ ] ] for all piecewise continuous @xmath7\\to u,$ ] and if ( i ) @xmath502 satisfies the conditions  ( [ eq : mucond1])([eq : mucond3 ] ) , ( ii ) @xmath503 is of the form @xmath504 and ( iii ) @xmath28 is admissible , then @xmath28 is an optimal strategy . to see this ,",
    "choose @xmath505 large enough that the relation @xmath506 holds .",
    "it is clear from the assumption that @xmath28 is admissible that @xmath72=0 $ ] and it follows from ( [ lambdamin ] ) that @xmath28 minimizes @xmath507+\\rho^*s[q]$ ] over all admissible @xmath73 assumption  ( [ rho ] ) moreover implies that @xmath28 minimizes @xmath507+\\rho^*s[q]$ ] over all piecewise continuous @xmath7\\to u$ ] because , for any non - admissible @xmath43 we have @xmath508+\\rho^*\\underbrace{s[q]}_{=1}&\\geq\\mathcal l[q,\\mu^*]-\\int_0^t\\int_t^{(t+\\tau)^-}\\lambda^*(t , s)q(s)q(t ) \\ ds \\",
    "dt=\\mathcal l[q^*,\\mu^*]+\\rho^ * \\underbrace{s[q^*]}_{=0}.                                                                                                                                                                                                                                                                                                                                                                                                                                           \\end{aligned}\\ ] ] thus , proposition  [ prop : ps ] implies that @xmath28 is optimal",
    ".    condition ( iii ) of the above argument requires that the minimizer @xmath28 of ( [ lambdamin ] ) is admissible , in order for @xmath28 to be an optimal strategy . as in the algorithm of section",
    "[ sec : alg ] , a suitable choice of @xmath59 will ensure that the capacity constraints are satisfied , whilst the power rating constraints are immediately absorbed into the minimization problem  ( [ lambdamin ] ) .",
    "the following lemma ensures that , as long as a minimizer @xmath28 exists , then we may select @xmath28 so that the switching time constraints are also satisfied .    [ lemma : lambda ] let @xmath509\\to\\re$ ] be piecewise differentiable and let @xmath145 be of the form @xmath510 for some minimizer @xmath511 of ( [ eq : qmu ] ) .",
    "let @xmath512 be the set of piecewise continuous @xmath300\\to u$ ] such that @xmath513\\leq \\lambda[q,\\mu,\\lambda]$ ] for all piecewise continuous @xmath7\\to u.$ ] if @xmath514 then there exists @xmath515 which satisfies the switching time constraints  ( [ gamma ] ) .",
    "suppose the claim is not true .",
    "then there exists @xmath516 $ ] such that @xmath517 and @xmath518 thus @xmath519 note that @xmath520(t):=\\frac{\\delta \\lambda}{\\delta q(t)}[q,\\mu,\\lambda]=w(q((t))p(t)-e^{\\alpha t}\\mu(t)-\\int_{(t-\\tau)^+}^{(t+\\tau)^-}\\lambda(t , s)q(s ) \\ ds ,   \\end{aligned}\\ ] ] where @xmath521 denotes the functional derivative of @xmath487 with respect to @xmath435 .",
    "in particular , the term @xmath522 only influences the value of @xmath28 at times @xmath12 and @xmath523 the condition that @xmath145 minimizes ( [ lambdamin ] ) subject to the constraint ( [ lambdamin2 ] ) implies that @xmath524(t)=0 $ ] or @xmath524(s)=0.$ ] in particular , we may always choose a @xmath28 so that @xmath525 or @xmath526    an interpretation of the role of @xmath503 in the minimization problem  ( [ lambdamin ] ) is that the function acts to adjust @xmath527 to a new strategy which satisfies the switching time constraints .",
    "it does this by finding all pairs of times @xmath528 such that @xmath529 and @xmath530 and adjusting @xmath531 or @xmath532 to 0 .",
    "the condition that @xmath533 whenever @xmath534 ensures @xmath527 is only adjusted at times when the minimum switching time constraint  ( [ gamma ] ) is broken . choosing @xmath503 to minimize ( [ lambdamin ] ) subject to the constraint  ( [ lambdamin2 ] )",
    "ensures that @xmath503 makes these adjustments in such a way that , if @xmath535 is the absolute change in instantaneous cost from the original strategy @xmath527 at time @xmath8 then the accumulation of these cost changes @xmath536 is minimal .",
    "thus , an equivalent and generally easier method for determining the optimal strategy @xmath125 given @xmath124 is to find a suitable subset of times @xmath14 $ ] and set @xmath525 if @xmath537 and @xmath538 if @xmath1\\setminus i.$ ] the subset @xmath539 should be chosen to minimize the associated absolute cost change integral @xmath540    if @xmath59 is given , then the minimization problem  ( [ lambdamin ] ) is much easier to solve than ( [ eq : propmax ] ) .",
    "the main task in determining an optimal strategy @xmath125 therefore , is to choose the correct reference price function @xmath53 as alluded to at the beginning of section  [ sec : constraints ] , this is a more difficult task now that the set of additional constraints @xmath42 is non - empty . to illustrate the complexity of the problem ,",
    "consider the following scenario :    let the power ratings and capacity constraints of the store be given by @xmath541 and @xmath542 and let the minimum switching time of the store be @xmath543 assume that there is no leakage and the store is perfectly efficient so that @xmath544 and @xmath545 suppose that @xmath546 and that the price of electricity @xmath547 is a function of time given by @xmath548 for all @xmath549 and for each @xmath550 where the values @xmath551 satisfy @xmath552",
    "suppose further that @xmath553 it is not difficult to see that the optimal strategy @xmath28 satisfies @xmath554 if @xmath555 $ ] and @xmath556 if @xmath557,$ ] with @xmath525 elsewhere .",
    "the corresponding reference price @xmath59 satisfies @xmath558 if @xmath559 and @xmath560 otherwise .",
    "however , the correct choice of @xmath561 here relies on knowing the correct choice of @xmath562 unlike in the algorithm of section  [ sec : alg ] , the constant sections of the reference price function can not be determined independently . to see this",
    ", we simply remark that , if we had guessed at a constant reference price function @xmath563 then we would arrive at the corresponding solution @xmath564 with @xmath565 if @xmath566 $ ] and @xmath567 otherwise .",
    "this strategy never reaches the upper or lower capacity constraint after the initial time , and so there is no chance to update our reference price function in accordance with proposition  [ prop : ps ] .",
    "even though our guess @xmath568 is correct over the time interval @xmath569 it is only possible to know this when considering the value that @xmath59 attains over the time interval @xmath570.$ ]    this issue prevents the methods of section  [ sec : alg ] from working here .",
    "however , as long as the store is required to perform at least one full charge and discharge cycle then the determination of a suitable @xmath59 still reduces to a localized problem thanks to lemma  [ lemma : constraints ] .",
    "finally , we remark that , if @xmath59 is a reference price function and if @xmath571 is the associated strategy , constructed via the minimization  ( [ lambdamin ] ) , then it can easily be shown that at each time @xmath1,$ ] the level of the store @xmath572 $ ] is increasing in @xmath53 whilst the algorithm of section  [ sec : alg ] no longer works in this more complicated setting , we can still use this monotonicity in order to reduce the choice of @xmath59 at each time to a suitable range , using similar arguments as in the case with no additional constraints .",
    "the following graphs plot the optimal strategies for a store which follows the model set out in section  [ sec : constraints ] , with @xmath573 and @xmath574 we take @xmath575  @xmath576 and vary @xmath577 as labeled below .",
    "the bottom two figures plot the level of the store @xmath29(t)$ ] at each time @xmath12 , assuming that the optimal strategy @xmath28 is followed .",
    "the top figures both plot the price of electricity @xmath4\\to[0,\\infty)$ ] which the store faces in making its operating decision . here , we have chosen hourly prices from the first 230 hours of n2ex s day - ahead auction in november 2013 .",
    "( bottom left ) and @xmath578 ( bottom right).,width=566,height=226 ]    an immediate observation is that the store cycles more frequently as its efficiency @xmath577 increases .",
    "less energy is lost during operation at higher efficiencies and the store is able to earn revenues over a larger proportion of elapsed time .",
    "we highlight here that , although the price of electricity follows a reasonably periodic pattern ( with periods of roughly a day in length ) , it does not follow that the level of the store is the same at the start and end of each day ( see , for example , @xcite for a proof of the potential non - periodicity of solutions in a periodic setting ) .",
    "this underlies an important motivation for choosing this method over a dynamic programming approach .",
    "using a dynamic programming method , one works backwards in time and evaluates , at each @xmath1,$ ] the value function @xmath579 where the minimization is subject to the constraints @xmath580 however , this requires information about all prices over the time @xmath0.$ ] if @xmath443 is large ( say , @xmath581 years , the average life of a pumped hydro store ) , then the number of calculations becomes infeasible .",
    "one option is to split @xmath0 $ ] into a union of smaller disjoint intervals @xmath582,$ ] for some @xmath583 and to find the optimal strategy over each of these smaller intervals .",
    "however , this requires setting an end - state for each interval , which may not be known . a reasonable guess in the above examples would be to assume that the store is empty at some off - peak time during each night but , as seen , such an assumption would lead to a sub - optimal solution . using our approach of section  [ sec : alg ]",
    ", the algorithm has the property that it implicitly reduces our problem to a series of new optimization problems , which are localized in time .",
    "we have presented a method for determining the operating strategy for a store to maximize its arbitrage profits .",
    "our setting allows for leakage , inefficiencies and general operating costs which are functions of the power output .",
    "this setting also allows for time - varying constraints on the power output of the store .",
    "a significant benefit associated with this method is the implicit localization in time of the solution .",
    "moreover , we have shown that there only exists an optimal strategy of the form of proposition  [ prop : ps ] if the algorithm does not terminate early . as an extension",
    ", we have discussed the inclusion of more general operating constraints and proposed a method for determining optimal strategies in the presence of minimum switching time constraints .",
    "we believe that the theory put forward in this paper serves as a good starting point for evaluating the profits available to a store .",
    "the assumption that prices can be predicted over suitable periods of time is a good approximation to the situation where a store trades through bilateral contracts , or through an auctioning market .",
    "a next step would be to consider the store as a larger player , whose actions have an impact on the price of electricity , and it is believed that the approaches given in this paper can be extended to this new setting .",
    "this work is made possible by the images ( integrated market - fit affordable grid - scale energy storage ) research group .",
    "the authors would like to thank the other members of the group for their suggestions and insight .",
    "particular thanks go to monica giulietti , jihong wang , xing luo , andrew pimm and seamus garvey .",
    "the authors would also like to thank stan zachary , james cruise and richard gibbens for their many helpful discussions related to this topic .",
    "m.  aunedi , n.  brandon , d.  jackravut , d.  predrag , d.  pujianto , r.  sansom , g.  strbac , a.  sturt , f.  teng , v.  yufit : _ strategic assessment of the role and value of energy storage systems in the uk low carbon energy future - report for carbon trust , _ 2012        _ study of compressed air energy storage with grid and photovoltaic energy generation , draft final report - for arizona public service company , _",
    "arizona research institute for solar energy ( aztise ) , 2010"
  ],
  "abstract_text": [
    "<S> we characterize profit - maximizing operating strategies , over some time horizon @xmath0,$ ] for an energy store which is trading in an arbitrage market . </S>",
    "<S> our theory allows for leakage , operating inefficiencies , operating constraints and general cost functions . in the special case where the operating cost of a store depends only on its instantaneous power output ( or input ) , we present an algorithm to determine the optimal strategies . </S>",
    "<S> a key feature is that this algorithm is localized in time , in the sense that the action of the store at a time @xmath1 $ ] only requires information about electricity prices over some subinterval of time @xmath2\\subset[t , t].$ ] to introduce more complex storage models , we discuss methods for an example which includes minimum switching times between modes of operation . </S>"
  ]
}