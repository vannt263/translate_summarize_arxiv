{
  "article_text": [
    "if a disc around a central object is sufficiently massive , its own self - gravity may play an important role in its evolution through the growth of the gravitational instability @xcite .",
    "an infinitesimally thin disc is susceptible to the growth of an axisymmetric gravitational instability if the @xmath2 parameter @xcite @xmath3 where @xmath4 is the sound speed in the disc , @xmath5 is the local epicyclic frequency ( equal to the angular velocity , @xmath6 , in a keplerian disc ) , @xmath7 is the gravitational constant , and @xmath8 is the disc surface density . global , non - axisymmetric perturbations can , however , grow for @xmath2 values greater than @xmath9 , with simulations suggesting that the stability criteria in global discs is @xmath10 @xcite .",
    "it is now , however , quite well understood that the @xmath2 parameter alone does not determine the ultimate evolution of a self - gravitating accretion disc .",
    "the evolution is determined by both the value of @xmath2 and by the rate at which the disc is able to lose energy @xcite .",
    "the current picture is that for long cooling times , the disc will settle into a state of marginal stability @xcite in which the instability acts to transport angular momentum outwards , allowing mass to accrete onto the central object @xcite . for short cooling times , however , the disc may become sufficiently unstable to fragment and form bound objects @xcite .",
    "this has been suggested as a mechanism for forming gas giant planets in discs around young stars @xcite or stars in discs around supermassive black holes @xcite .    two - dimensional",
    ", shearing sheet simulations @xcite , using a specific heat ratio of @xmath11 , indicated that the boundary between fragmentation and a quasi - steady , self - gravitating state occurred at a cooling time of @xmath12 @xcite found a similar result using three - dimensional smoothed particle hydrodynamics ( sph ) simulations .",
    "as already mentioned , in a quasi - steady state the gravitational instability acts to transport angular momentum outwards . in many instances",
    "it is appropriate to assume that angular momentum transport is driven by disc viscosity which @xcite suggest has the form @xmath13 where @xmath14 is the disc scaleheight .",
    "this form , however , assumes that the viscosity depends only on local disc properties .",
    "given that disc self - gravity is inherently global , such a form is not necessarily suitable for characterising angular transport in self - gravitating discs .",
    "however , if @xmath15 and if the disc mass is less than about half that of the central star , a local approximation appears to be a suitable representation @xcite .",
    "since a quasi - steady state is one in which the cooling is balanced by an effective viscous heating , one can relate the viscosity to the cooling time through @xcite @xmath16 where @xmath17 is the specific heat ratio . using different values of @xmath17",
    ", @xcite showed that rather than the fragmentation boundary depending on the cooling time , @xmath18 , it depends on the stresses in the disc , as represented by @xmath19 . in agreement with @xcite",
    "their results indicate that self - gravitating discs can maintain a quasi - steady state if @xmath20 and will fragment if the required stress exceeds @xmath21 .",
    "@xcite used analytic calculations and three - dimensional numerical simulations to investigate further the energy balance in self - gravitating discs and found that the perturbation amplitude , @xmath22 , is related to the cooling time through @xmath23 where @xmath24 . using two - dimensional shearing - sheet simulations",
    ", @xcite showed , similarly , that @xmath25 .",
    "the basic picture that has therefore been developed is that a self - gravitating accretion disc will settle into a quasi - steady state in which cooling is balanced by heating driven by the gravitational instability .",
    "in such a state , the perturbation amplitudes will depend on the cooling rate ( or , equivalently , on the level of stress in the disc ) and if these perturbations are sufficiently large , they become non - linear , the disc is unable to maintain a quasi - steady state and instead fragments into bound objects .",
    "what makes this general picture attractive is that there is reasonable agreement across a wide - range of different types of simulations including two - dimensional shearing sheet simulations @xcite , three - dimensional grid - based simulations @xcite , and three - dimensional sph simulations @xcite .",
    "recent work @xcite has , however , shown that three - dimensional sph simulations that fix @xmath26 , do not converge to a well - defined fragmentation boundary as resolution is increased .",
    "their highest resolution simulations suggested that fragmetation could occur for cooling time @xmath27 .",
    "given that the jeans mass of a typical fragment is well - resolved in an sph simulation even for quite modest resolutions @xcite , this result is quite surprising .",
    "there have been a number of attempts to understand this result .",
    "@xcite suggest that numerical viscosity may influence disc thermodynamics more than originally thought and hence that simulations may require higher resolutions than indicated by earlier calculations .",
    "@xcite use two - dimensional grid - based simulations to show that the lack of convergence could be related to edge effects in simulations with very smooth initial conditions .",
    "there is also some suggestion that disc fragmentation may have a stochastic nature @xcite .",
    "@xcite considered convergence in three - dimensional , grid - based , self - gravitating disc simulations .",
    "this work , however , did nt directly address convergence of the fragmentation boundary , but instead considered convergence of the properties of a quasi - steady , self - gravitating disc .",
    "their results were consistent with fragmentation requiring @xmath21 , but could nt really make any strong statements about convergence of the fragmentation boundary .",
    "@xcite , extended the work of @xcite to consider simulations with radiative cooling and found that the properties of these discs did not converge in the outer , optically - thin regions .",
    "one of their conclusions was that there may be issues with convergence in regions where the optical depth is of order unity .",
    "it has , however , been suggested @xcite that the lack of convergence of the fragmentation boundary in the @xcite simulations was simply a consequence of the manner in which the cooling was implemented .",
    "@xcite suggest that it may be related to the known problem - in many sph implementations - of an unphysical discontinuity in the thermal energy ( pressure ) at contact discontinuities @xcite which , if not corrected for , could lead to regions with enhanced cooling .",
    "@xcite suggested that this could be solved by using a form of the cooling that smooths across each sph particle s neighbour sphere . in their simulations ,",
    "fragmentation occurred only for cooling times @xmath28 but they could not claim convergence as their highest resolution simulations fragmented for a slightly longer cooling time than the value towards which the others appeared to be converging .",
    "@xcite have recently extended this convergence work to consider how it is affected by artificial viscosity in both sph simulations and in fargo grid - based simulations .",
    "they consider various artificial viscosity parameters and settle on the values that maximise the value of @xmath26 for which fragmentation can occur . in a quasi - steady state",
    "the disc is in thermal equilibrium with the imposed cooling balanced by heating from both the instability and from artificial viscosity .",
    "ideally , the artificial heating should be minimised .",
    "the perturbation amplitudes should depend on the strength of the instability @xcite , therefore choosing artificial viscosity parameters that maximise the value of @xmath26 at which fragmentation can occur should minimise the level of artificial heating .",
    "there are , however , a few issues with this that will be discussed in more detail in a later section . artificial viscosity is typically introduced so as to resolve shocks . in sph , however , the artificial viscosity operates even in the absence of shocks , producing an artificial dissipation that should , ideally , be minimised . the way in which the instability heats the disc is through dissipation at shocks and",
    "so varying the viscosity parameters can reduce the artificial dissipation , but can also have an impact on the shock heating .",
    "given that @xcite suggest that the lack of convergence seen in @xcite could be due to an unphysical structure in the shock regions , changing the shock structure could exacerbate this problem . additionally , in fargo , the artificial viscosity only operates at shocks and does nt produce any kinematic viscosity , so should nt introduce any artificial heating .",
    "any artificial diffusion in fargo should occur at the grid scale and therefore should nt depend on the artificial viscosity parameters .    in this paper",
    "we extend the work of @xcite to show that their suggested cooling formalism does indeed appear to lead to convergence of the fragmentation boundary and that , consistent with earlier work , fragmentation requires @xmath29 for @xmath30 .",
    "we then extend this to consider how this results depends on the artificial viscosity in sph to establish if the values suggested by @xcite are indeed optimal .",
    "we also discuss their results obtained using fargo . in section 2",
    "we briefly describe smoothed particle hydrodynamics ( sph ) . in section 3",
    "we consider the sph results unsing the cooling formalism suggested by @xcite . in section 4",
    "we address the results @xcite obtained using fargo and in section 5 we discuss these results and conclude .",
    "sph is a lagrangian hydrodynamic formalism in which a fluid , or gas , is represented by pseudo - particles ( see e.g. , @xcite ) .",
    "each particle is assigned a a mass ( @xmath31 ) , position ( @xmath32 ) , velocity ( @xmath33 ) and internal energy per unit mass ( @xmath34 ) .",
    "there are many descriptions of sph ( e.g. , @xcite ) , so we wo nt repeat the details here . basically , fluid / gas density is calculated via interpolation across the mass distribution .",
    "pressure is determined via an equation of state .",
    "gravitational forces can either be calculated by direct summation , or - more commonly - using a tree code @xcite .",
    "the momentum and energy equations are in a form suitable for this langrangian formalism and so the particles velocities are updated using the gravitational and pressure forces on each particle , the positions are updated using the velocity of each particle , and the internal energy changes via @xmath35 work , viscous dissipation and cooling .      to investigate the evolution of self - gravitating discs , a cooling time , @xmath36 , of the of the following form",
    "is typically used @xcite : @xmath37 this is typically added to the energy equation by assuming that the thermal energy of each particle , @xmath38 , decays with an e - folding time given by @xmath36 .",
    "hence , the energy equation becomes , @xmath39 where the sum is over all the neighbours , @xmath40 , of particle @xmath41 , @xmath42 is the velocity difference between particle @xmath40 and particle @xmath41 , @xmath43 is the smoothing kernel used to interpolate across the neighbours of particle @xmath41 , and @xmath44 is the smoothing length that defines the volume of the neighbour sphere . as already mentioned , the unsmoothed - or individual particle - internal energy has an unphysical discontinuity at the contact discontinuity behind shock waves @xcite .",
    "consequently , @xcite suggested that the cooling be distributed across the neighbour sphere .",
    "their suggestion was that the standard cooling term implementation @xmath45 should be replaced with @xmath46 their suggestion was that the upper of the two equations in equation ( [ eq : smoothcool2 ] ) would be applied to particle @xmath41 , while the lower of the two equations would be applied to the neighbours @xmath40 of particle @xmath41 .",
    "this would ensure that the cooling rate associated with particle @xmath41 would be @xmath47 in regions without discontinuities this will be the same as the cooling rate given by equation ( [ eq : basic_cool ] ) @xcite . at the discontinuities in the shock regions ,",
    "equation ( [ eq : totalcoolj ] ) will use the physically correct interpolated value for the internal energy and will ensure that the unphysical jump in thermal energy at the contact discontinuity does not artificially enhance the cooling in that region .",
    "the results presented in @xcite using the cooling form shown in equation ( [ eq : smoothcool2 ] ) suggested that the simulations were converging towards a fragmentation boundary between @xmath48 and @xmath49 .",
    "their highest resolution simulation ( 10 million particles ) , however , fragmented between @xmath50 and @xmath51 and hence they could not claim convergence .",
    "their highest resolution simulation was , however , only a ring of 4 million particles that would have had the same resolution as a full 10 million particle simulation .",
    "strictly speaking , it was nt exactly the same conditions as the other lower - resolution simulations . here",
    ", we present results from a single 10 million particle run using the cooling form presented in equation ( [ eq : smoothcool2 ] ) and that indicates that a stronger constraint on the convergence of the fragmentation boundary .      in sph",
    ", the artificial viscosity has two main roles ; to prevent particle interpenetration and to resolve shock waves .",
    "the viscosity can consequently be thought of as having a shear component and a bulk component @xcite , with the bulk component acting very like a von neumann - richtmeyer viscosity used to resolve shocks in many grid - based codes .",
    "a way in which to introduce viscosity in sph , and what is used in all the simulations presented here , is to use the following to determine the viscosity term between particles @xmath40 and @xmath41 ; @xmath52 the terms @xmath53 and @xmath54 are the average sound speed and density for particles @xmath40 and @xmath41 .",
    "the terms @xmath42 and @xmath55 are @xmath56 and @xmath57 respectively .",
    "the coefficients @xmath58 and @xmath59 determine the strength of the two viscosity terms and the term @xmath60 is given by @xmath61 where @xmath62 is a softening term that prevents the denominator in equation ( [ eq : mu ] ) from ever being zero .",
    "it should be clear that equation ( [ eq : visc ] ) only operates when particles are converging and hence will prevent interpenetration and resolve shocks .",
    "however , this form of the viscosity does not distinguish between converging flows and shear flows and hence this viscosity can also transport angular momentum and can , therefore , heat the system in the absence of shocks @xcite .",
    "the viscosity coefficients typically satisfy @xmath63 and commonly used values , in self - gravitating disc simulations , are @xmath64 and @xmath65 .",
    "one reason for using @xmath63 is that it ensures that the first term in equation ( [ eq : visc ] ) dominates when the convergence is slow , while the second term dominates when convergence is rapid .",
    "the @xmath59 term is essentially necessary so as to handle high mach - number shocks @xcite .",
    "consequently , most studies @xcite only consider the @xmath58 term when determining the dissipation due to artificial viscosity in shear flows .",
    "optimally the @xmath58 value should be set so as to minimise artificial dissipation while still preventing particle interpenetration .",
    "@xcite point out that the dissipation associated with the @xmath59 term is not actually negligible but is about a factor of @xmath66 smaller than that associated with the @xmath58 term when @xmath64 and @xmath65 .",
    "they , therefore , conclude that one should optimise in terms of both @xmath58 and @xmath59 and conclude that the optimal values are @xmath64 , @xmath67 .",
    "this was largely based on simulations that maximised the value of @xmath26 - which determines the cooling time - for which fragmentation could occur .",
    "maximising the cooling time at which fragmentation occurs , suggests that one has minimised the amount of artificial dissipation and so is an attractive strategy to adopt .",
    "however , as we ll discuss in more detail later , this may not necessarily be the case and so , here , we investigate how these values of @xmath58 and @xmath59 influence the fragmentation boundary when using the modified cooling form proposed by @xcite .",
    "all of the sph simulations presented here have the same basic setup as those presented by @xcite .",
    "they have a central star with mass @xmath68 surrounded by a disc extending from @xmath69 to @xmath70 , with a mass of @xmath71 , an initial surface density profile of @xmath72 , and with an initial minimum @xmath2 parameter of @xmath2 = 2 .",
    "we impose a cooling of the form described by equation ( [ eq : tcool ] ) , but that is either implemented as in @xcite - which we call basic cooling - or in the modified manner suggested by @xcite - which we call smoothed cooling .",
    "we consider various resolutions , ranging from 250000 particles to 10 million particles . in all our simulations",
    "we take @xmath64 , but consider both @xmath65 and @xmath67 .",
    "in the work of @xcite they considered full simulations using 250000 , 500000 , and 2 million particles , but represented a 10 million particle simulation using a simulation with 4 million particles with a mass of @xmath73 and that extended from @xmath74 to @xmath70 .",
    "these parameters were chosen so as to have the same properties , in that region , as a full 10 million particle simulation . in @xcite the 500000 and 2 million particle simulations fragmented at between @xmath48 and @xmath49 and appeared to be converging .",
    "the pseudo-10 million particle simulation , however , fragmented between @xmath50 and @xmath51 and hence they could not claim convergence .",
    "we have since managed to complete a full 10 million particle simulation with @xmath50 which , after 6.5 outer rotation periods , shows no signs of fragmentation .",
    "the state of the simulation at this time ( 5120 code units or 815 orbits at @xmath75 ) is shown in fig .",
    "[ fig:10million ] .",
    "there is clearly lots of spiral structure , but no evidence of fragmentation .",
    "we also include a table with the results from the simulations of @xcite together with this new result using 10 million particles .",
    ".list of the simulations using smoothed cooling.[tab : sims ] [ cols=\"^,^,^,^\",options=\"header \" , ]     table [ tab : sims2 ] shows the results of the smoothed cooling simulations using @xmath67 .",
    "[ fig : fragbound_bsph2 ] compares the results using @xmath76 ( triangles ) with those obtained using @xmath67 ( squares ) .",
    "the symbols are located at the average of the maximum @xmath26 for which fragmentation occured and the minimum for which it did nt .",
    "the short lines indicate the range between these two values .",
    "although there is a difference , the results are very similar .",
    "there is no indication that @xmath77 increases by 50% when @xmath67 , compared to that obtained when @xmath65 .",
    "given that previous analysis @xcite indicates that @xmath67 should produce more artificial dissipation than @xmath65 , it is a little surprising that @xmath77 is nt smaller when using @xmath67 than when using @xmath65 .",
    "it is possible that using @xmath67 does reduce some of the random noise associated with sph , but it is also clear ( from fig .",
    "[ fig:500k_comparison ] ) that it also changes the shock structure in the disc .",
    "maybe it is not that surprising that the results differ slightly .",
    "these results are , however , not consistent with the suggestion @xcite that - even for large particle numbers - artificial dissipation provides @xmath78% of the heating when @xmath65 .     ( squares ) and with @xmath65 ( triangles ) .",
    "the symbols are located at the average of the maximum @xmath26 for which fragmentation occured and the minimum for which it did nt , while the lines indicates the range between these two values . ]",
    "in addition to considering how self - gravitating discs evolve in sph simulations , @xcite have extended this to consider grid - based simulations of self - gravitation accretion discs .",
    "they use the fargo code and show too that the fragmentation boundary does not converge as resolution increases . in this work , they also vary the artificial viscosity parameter so as to maximise the cooling time at which fragmentation occurs .",
    "there are , however , some issues with how they have implemented these fargo simulations .    as with sph ,",
    "grid - based methods such as fargo @xcite require a form of artificial viscosity to handle shocks .",
    "this is a direct consequence of godunov s theorem @xcite : any numerical scheme that is better than first - order accurate will introduce unphysical oscillations in the flow near shocks . since almost all numerical methods for gas dynamics aim for at least second - order accuracy , a special recipe is needed around discontinuities in the flow .",
    "finite - difference methods like zeus @xcite and fargo employ a van - neumann - richtmeyer type of artificial viscous pressure , which , when considering an axisymmetric disc , takes the form : @xmath79 where @xmath8 denotes the surface density , @xmath80 the radial velocity and @xmath81 is the artificial viscosity parameter , which has dimensions of length . the reduced artificial viscosity parameter @xmath82 , where @xmath83 is the grid spacing , determines over how many grid points shocks will be smeared out . in this view , of course , only values of @xmath84 larger than unity make sense , and the standard value in fargo is @xmath85 . choosing a nonlinear viscous pressure as artificial viscosity results in the correct entropy jump across shocks and the correct shock propagation velocity @xcite .",
    "the form of artificial viscosity given in equation ( [ eqartvisc ] ) has two important properties : it acts only when the flow is compressed , and it acts , for @xmath84 of order unity , only on length scales of the order of the grid scale .",
    "this latter property implies that if the value of @xmath84 makes a difference in the outcome of a simulation , the flow _ must _ be under resolved .",
    "we illustrate the effect of artificial viscosity on two one - dimensional ( axisymmetric ) problems below , one linear and one non - linear .",
    "for the first problem , we take an equilibrium inviscid keplerian disc , extending from @xmath86 to @xmath87 , with @xmath88 at @xmath89 , and add a radial velocity perturbation @xmath90 note that this is a velocity perturbation equal to @xmath91 % of the sound speed . therefore ,",
    "no shocks form in this problem , which means that entropy should be materially conserved . for simplicity , we take the surface density to be constant initially , and choose the pressure so that the initial state has constant entropy ( @xmath92 , where we take the ratio of specific heats @xmath93 ) , which means that in an ideal world , the quantity @xmath94 should remain constant . no numerical method is ideal , of course , and there are two sources of changes in @xmath95 : one is due to the finite size of the grid cells , which , unless a special entropy - conserving integration scheme is adopted , will lead to spurious changes in @xmath95 , and the other is artificial viscosity , which directly changes the entropy through the viscous heating term .",
    "the results after integrating to @xmath96 are displayed in figure [ fig : fargolinear ] for three different grid sizes @xmath97 , with corresponding resolutions @xmath98 . the initial gaussian pulse in velocity",
    "is resolved by @xmath99 cells for @xmath100 , @xmath101 cells for @xmath102 and @xmath103 cells for @xmath104 . as the artificial viscosity",
    "is increased , the maximum change in @xmath95 increases due to viscous heating , as expected .",
    "the increase in entropy at @xmath105 is due to the grid only . at the lowest resolution ,",
    "the effects of the grid and the artificial viscosity are of similar magnitude .",
    "fargo , like most grid - based methods , is second order accurate .",
    "this means that after a fixed number of time steps , errors should decrease as @xmath106 as the grid is refined .",
    "since the number of time steps required to reach @xmath96 is proportional to @xmath97 , we expect the errors due to the grid at @xmath96 to decrease as @xmath83 , which is exactly what is observed in figure [ fig : fargolinear ] .",
    "as the resolution is increased , the differences between runs with @xmath105 and @xmath107 decrease . for all resolutions except @xmath100 , taking @xmath107 makes no difference compared to @xmath105 . in other words , for @xmath102 and @xmath104 , heating due to artificial viscosity",
    "is completely negligible for @xmath107 . only for @xmath100",
    "does artificial viscosity make a difference , but this is to be expected , since the extent of the initial pulse comparable to the grid scale , which means it will feel the artificial viscosity .",
    "therefore , as expected , artificial viscosity plays no role in heating a smooth flow , unless it is not resolved .      as a second test problem",
    ", we set up a nonlinear wave characterised by initial conditions @xmath108 in the same inviscid equilibrium keplerian disc as above .",
    "the initial pressure is set again such that the initial state is isentropic .",
    "the solution develops a shock that leads to an increase in entropy .",
    "the correct increase in @xmath95 was measured from a simulation using a riemann solver @xcite at @xmath104 .",
    "the results obtained with fargo are displayed in figure [ fig : fargononlinearq ] .",
    "it is immediately clear that simulations with @xmath109 strongly underestimate the change in entropy .",
    "this is again not surprising , since artificial viscosity is _ necessary _ in this case because of the presence of an entropy - generating shock .",
    "similar to sph , choosing the artificial viscosity parameter too high leads to unphysical , artificial heating : choosing @xmath110 leads to too much viscous heating for @xmath100 , but at high enough resolution a plateau emerges giving roughly the same amount of entropy generation independent of @xmath84 .    in figure [ fig : fargononlinearn ]",
    "we look at the same problem but now as a function of resolution .",
    "simulations with @xmath111 systematically underestimate the entropy production , independent of resolution .",
    "the situation is most severe for @xmath105 and @xmath112 , which do not even show convincing signs of convergence with resolution .",
    "simulations with @xmath113 do seem to converge , but to a level that depends on @xmath84 .",
    "for the largest values of @xmath84 , the entropy increase converges to a value very close to the correct one , but at the price of overestimating the entropy increase at low resolution . the standard value @xmath85 seems to be a good compromise .",
    "it is not completely straightforward to translate the above results to two dimensions . in this case ,",
    "an extra source of error comes from dimensional splitting , the effects of which are not entirely clear especially if the fargo algorithm is used @xcite .",
    "moreover , shocks are no longer necessarily aligned with the grid , which in all likeliness changes the dissipation properties of the grid . however , a few general statements can be made .",
    "the optimum value of @xmath84 is larger than unity .",
    "for example , @xmath85 gives artificial viscosity that leads to a good estimate of entropy production in shocks ( figure [ fig : fargononlinearq ] ) , while its effect on _ resolved _ smooth flow is negligible ( figure [ fig : fargolinear ] ) .",
    "values of @xmath114 do not give the correct amount of shock heating , and can therefore not be expected to give physical results . note that the optimum value chosen by @xcite , @xmath112 , underestimates the entropy increase in a shock by a factor of 3 ( see figure [ fig : fargononlinearn ] ) .",
    "this will have serious consequences for the simulation results if heating is due to shock dissipation , which is the case for self - gravitating discs .",
    "if the amount of artificial viscosity makes a difference in the results , the flow is under resolved .",
    "this can be due to shocks , in which case there the flow can in fact not be resolved , or due to unresolved smooth flow . in the latter case , reducing the amount of artificial viscosity will in general not lead to a much better solution , since errors due to the finite size of the grid cells are likely to be as large as the error introduced by artificial viscosity , precisely because the flow is unresolved ( figure [ fig : fargolinear ] ) .",
    "moreover , reducing the amount of artificial viscosity can only be safely done when it is absolutely certain that no shocks are present in the problem , which , for self - gravitating discs , we know is not the case .    keeping the artificial parameter fixed at @xmath85 ,",
    "there are still several avenues for investigating the problem of convergence in grid - based simulations .",
    "a direct comparison between 2d global and local simulations @xcite , which do not appear to show convergence @xcite , is definitely warranted .",
    "care must be taken in global simulations to avoid initial transients @xcite .",
    "it may be that the lack of convergence in grid - based simulations is the result of the two - dimensional approximation , even though smoothing of the gravitational potential does not seem to make much of a difference @xcite .",
    "it may also be that the inviscid problem is ill - posed , and that a finite amount of ( navier - stokes ) viscosity is needed to reach convergence .",
    "artificial viscosity is a necessary feature in numerical simulations in order to make the code behave in a reasonable way at the smallest resolvable scale , which is the scale of the grid in grid - based codes , and the smoothing length in sph . without artificial viscosity , particle interpenetration would make the outcome of any sph simulation useless .",
    "the use of a grid introduces its own associated viscosity , which acts on the smallest resolvable scale ( the grid scale ) and may or may not behave like a real viscosity .",
    "this is why simulations of turbulence often employ an additional physical navier - stokes viscosity to make sure that energy dissipation on the smallest scales is well - behaved and physical ( see e.g. fromang , papaloizou , lesur , & heinemann 2007 ) .",
    "in addition , both sph and grid - based codes like fargo need artificial viscosity to handle shocks correctly",
    ".    it should be clear from the discussion in sections [ sec : results ] and [ sec : fargo ] that care should be taken when trying to adjust the amount of artificial viscosity for a particular problem , both in grid - based codes and sph .",
    "when the level of artificial viscosity makes a difference in the simulation outcome , this means that features close to the smallest resolvable scale ( either the grid scale or the smoothing length ) play an important role .",
    "artificial viscosity is a way of converting bulk motion on these small scales into heat .",
    "this can be unphysical , if the underlying flow is smooth , or physical , in the case of shocks .",
    "of course , one would always like to reduce the amount of artificial viscosity as much as possible .",
    "however , reducing the amount of artificial viscosity below the level required to handle shocks correctly , e.g. taking @xmath114 in fargo , can only be done if it is known that no shocks will occur in the problem . and",
    "even then , the results in section [ sec : fargo ] indicate that for smooth flow dissipation is dominated by the grid rather than artificial viscosity , so that changing @xmath84 will not make a difference in the simulation outcome .    the only way to do a better job for smooth flow in a grid - based simulation is to increase the resolution . in sph , there are more artificial viscosity parameters to play with , and it may be slightly less clear to what extent the choices for @xmath58 and @xmath59 are free . since there is no dissipation due to a grid , it is likely that the level of artificial viscosity matters more compared to grid - based codes .",
    "typically sph simulations use @xmath63 .",
    "this is so that the linear term dominates when particles are converging slowly , and the quadratic term dominates when the particles are converging fast enough that shocks are likely to form . using @xmath115 , as suggested by @xcite , effectively means that the quadratic term is likely to always dominate and , hence , is likely to change the properties of the simulation itself .    in the case where shocks are present , the situation is more complicated , since the numerical method will always smear shocks over a few grid cells , for a grid - based code , or a few smoothing lengths for sph .",
    "increasing the resolution therefore keeps reducing the size of shocks , which means that ever smaller scales are present in the problem .",
    "these smallest scales can interact in non - trivial ways with larger scale structures ( clumps , waves ) , and it may not be immediately clear whether convergence can be reached and at what resolution .",
    "recently , @xcite have suggested that , in three - dimensional sph simulations of self - gravitating accretion disc with @xmath0-cooling , the cooling time ( @xmath26 ) at which fragmentation occurs does not converge as resolution is increased .",
    "they ve extended this work @xcite to suggest that with typical artificial viscosity parameters , the fragmentation boundary is converging towards a critical cooling time of @xmath116 .",
    "they go on to argue , however , that adjusting the artificial viscosity parameters ( so as to maximise the critical cooling time , @xmath77 ) suggests that , with an appropriate choice of the artificial viscosity parameters , the simulations actually converge towards @xmath117 .",
    "@xcite then continue this by considering the evolution of self - gravitating disc using the grid - based code fargo . here",
    "they also vary the artificial visocsity parameter so as to maximise the critical cooling time and show that these simulations also do nt converge as resolution increases .",
    "it has been suggested @xcite that the non - convergence seen in @xcite was simply a consequence of the manner in which cooling was implemented .",
    "we ve extended the work of @xcite here to show that by implementing what they call smoothed cooling , fragmentation requires @xmath29 for all resolutions considered ( from 250000 particles to 10 million particles ) .",
    "this is more consistent with other work @xcite and also makes physical sense given that the jeans mass is well resolved in most of the disc for simulations with 500000 particles or more , and that artificial viscosity should be providing less than 10% of the heating in such simulations , so should nt be significantly influencing the fragmentation boundary . furthermore",
    ", if fragmentation can occur for @xmath118 this suggests that a clump can contract and become bound even though the timescale over which it is losing energy is significantly greater than the orbital period , which is likely to determine the timescale over which we d expact the clump to heat .",
    "we also consider how the alternative artifical viscosity values suggested by @xcite influence the results when using smoothed cooling .",
    "we find that the results are consistent with those obtained using the original artificial viscosity parameters . rather than increasing the critical cooling time , @xmath77 , by 50% @xcite",
    ", fragmentation still requires @xmath29 , for all particle numbers considerd .",
    "if this change to the artificial viscosity parameters was reducing the level of artificial heating ( as suggested by @xcite ) then we d expect the results to be independent of the implementation of the cooling .",
    "that they are nt suggests that changing these parameters is influencing the simulations in some numerical way , rather than simply changing the level of artificial heating - especially as the expectation is that the changes made by @xcite should have increased , rather than reduced , the level of artificial heating .",
    "this is also consistent with the significant difference between the spiral shock structure in the disc with @xmath67 when compared to simulations with @xmath65 .",
    "what was quite attractive about the @xcite work was that they obtained very similar results when using the grid - based fargo code .",
    "however , here , they also varied the artificial viscosity parameter so as to minimise the level artificial viscosity .",
    "as discussed earlier , however , the artificial viscosity in fargo only acts on converging flows and so should not produce any artificial ( non - shock related ) heating .",
    "additionally , in order to produce good estimates of entropy production at shocks requires that , as discussed earlier , the optimal value for the artificial viscosity in fargo be larger than unity .",
    "@xcite claim that the optimal value is @xmath119 , much smaller than would be regarded as suitable for such a simulation .",
    "admittedly , even their simulations with @xmath120 did not show signs of convergence , but this could be related to unsuitable initial conditions @xcite or the possibility of stochasticity @xcite and should be investigated further .",
    "essentially , the sph simulations presented here show that if one implements the cooling so as to remove the unphysical discontinuity at the contact discontinuity behind shocks @xcite we appear to get convergence as the resolution increases , and the fragmentation boundary that we determine is consistent with earlier work ( fragmentation occuring for cooling times between @xmath48 and @xmath50 for @xmath30 ) .",
    "although , we havent investigated @xcite s fargo results in as much detail , it seems clear that what they regard as the optimal value for the artificial viscosity parameter ( @xmath119 ) is well below what would be regarded as acceptable for such simulations .",
    "this might suggest that their fargo results suffer from additional numerical issues . with the exception of the possibility of stochastic fragmentation @xcite",
    "we therefore conclude that there is no real evidence that fragmentation can occur in self - gravitating discs with long cooling times and that the likely fragmentation boundary is similar to that suggested by earlier work @xcite .",
    "consequently , this implies that - as suggested by earlier studies @xcite - gas giant planet formation via disc fragmentation is unlikely in the inner regions ( @xmath1 au ) of protostellar discs .",
    "all simulations presented in this work were carried out using high performance computing funded by the scottish universities physics alliance ( supa ) .",
    "wkmr and dhf gratefully acknowledge support from stfc grant st / j001422/1 .",
    "pja ackowledges support from nasa s astrophysics theory and origins of solar systems programs through grants nnx11ae12 g and nnx13ai58 g .",
    "durisen r. , boss a.p . , mayer l. , nelson a.f . , quinn t. , rice w.k.m . , 2007 , in reipurth b. , jewitt d. , keil k. , eds , protostars and planets v , gravitational instabilities in gaseous protoplanetary disks and implications for giant planet formation , university of arizona press                  kuiper g. , 1951 , in hynek j.a . ,",
    ", proceedings of a topical symposium , c commemorating the 50th anniversary of the yerkes observatory and half a century of progress in astrophysics , mcgraw - hill , new york , p. 357"
  ],
  "abstract_text": [
    "<S> recently it has been suggested that the fragmentation boundary in smoothed particle hydrodynamic ( sph ) and fargo simulations of self - gravitating accretion discs with @xmath0 cooling do not converge as resolution is increased . </S>",
    "<S> furthermore , this recent work suggests that by carefully optimising the artificial viscosity parameters in these codes it can be shown that fragmentation may occur for much longer cooling times than earlier work suggests . </S>",
    "<S> if correct , this result is intriguing as it suggests that gas giant planets could form , via direct gravitational collapse , reasonably close to their parent stars . </S>",
    "<S> this result is , however , slightly surprising and there have been a number of recent studies suggesting that the result is likely an indication of a numerical problem with the simulations . </S>",
    "<S> one suggestion , in particular , is that the sph results are influenced by the manner in which the cooling is implemented . </S>",
    "<S> we extend this work here and show that if the cooling is implemented in a manner that removes a known numerical artefact in the shock regions , the fragmentation boundary converges to a value consistent with earlier work and that fragmentation is unlikely for the long cooling times suggested by this recent work . </S>",
    "<S> we also investigate the optimisation of the artificial viscosity parameters and show that the values that appear optimal are likely introducing numerical problems in both the sph and fargo simulations . </S>",
    "<S> we therefore conclude that earlier predictions for the cooling times required for fragmentation are likely correct and that , as suggested by this earlier work , fragmentation can not occur in the inner parts ( @xmath1 au ) of typical protostellar discs .    </S>",
    "<S> [ firstpage ]    accretion , accretion discs - gravitation - instabilities - stars ; formation - stars ; </S>"
  ]
}