{
  "article_text": [
    "peculiar velocities are deviations from the uniform expansion of the universe . in the gravitational instability model ,",
    "they are generated by the inhomogeneities in the matter distribution .",
    "most determinations of the peculiar velocities are based on surveys of individual galaxies .",
    "early measurements by rubin et al ( 1976 ) found peculiar flows of amplitudes @xmath2700 km / sec . using the  fundamental plane \" ( fp ) relation ( dressler",
    "et al 1987 , djorgovski & davis 1987 ) suggested that elliptical galaxies within @xmath3mpc were streaming at @xmath4 km / sec with respect to the cmb ( lynden - bell 1988 ) .",
    "mathewson et al ( 1992 ) used the tully - fisher ( 1977 - tf ) relation and found that this flow of amplitude 600 km / sec does not converge until scales much larger than @xmath5 mpc , a result that was in agreement with a later analysis by willick ( 1999 ) . using the brightest galaxy as a distance indicator for a sample of 119 rich clusters , lauer & postman ( 1994 - lp ) measured a bulk flow of @xmath2700 km / sec on a scale of @xmath2150@xmath6mpc , but a re - analysis of these data by hudson & ebeling ( 1997 ) taking into account the correlation between the luminosity of brightest galaxy and that of its host cluster found a reduced bulk flow pointing in a different direction . using the fp relation for early - type galaxies in 56 clusters hudson et al ( 1999 ) found a similar bulk flow as lp and on a comparable scale , but in a different direction .",
    "a sample of 24 snia showed no evidence of significant bulk flows out to @xmath7 mpc ( riess et al 1997 ) , and a similar conclusion was reached with a tf - based study of spiral galaxies by courteau et al ( 2000 ) .",
    "kocevski & ebeling ( 2006 ) analyzed the contribution to the peculiar velocity of the local group due to structures beyond the great attractor and found that the dipole anisotropy of the all - sky , x - ray - selected cluster sample compiled there suggested that most of the flow was due to overdensities at @xmath8mpc .",
    "watkins et al ( 2009 ) developed a method to suppress the sampling noise in the various galaxy surveys and showed that all the data ( except for the lp sample ) agreed with substantial motion on a scale of @xmath9mpc . in a follow - up study feldman",
    "et al ( 2009 ) estimated the source of the flow to be at an effective distance larger than 200@xmath6mpc ; they suggested that the absence of shear is consistent with the attractor being at infinity , as proposed in kashlinsky et al ( 2008 , hereafter kabke1 ) .    cosmic microwave background ( cmb ) temperature fluctuations in the direction of clusters of galaxies provide an alternative method to measure peculiar velocities .",
    "the scattering of the microwave photons by the hot x - ray emitting gas inside clusters induces secondary anisotropies ( sunyaev & zeldovich 1970 , 1972 ) that are redshift independent and , if the noise is isolated , can be used to probe the velocity field to much higher redshifts than with galaxies .",
    "the sunyaev - zeldovich ( sz ) effect has two components : thermal ( tsz ) , due to thermal motions of electrons in the potential wells of clusters and kinematic ( ksz ) due to motion of the cluster as a whole with respect to the isotropic cmb rest frame ( see review by birkinshaw 1999 ) . however , such measurements for individual clusters are dominated by large errors . on all - sky cmb maps ,",
    "the bulk flow motion of clusters of galaxies can be obtained by using large all - sky cluster samples and evaluating the cmb dipole at cluster locations ( kashlinsky & atrio - barandela , 2000 - hereafter kab ) .",
    "we have applied the kab method using the largest - at that time - sample of galaxy clusters in conjunction with the 3-yr wmap data and have uncovered a large scale flow of amplitude @xmath10km / s extending to at least @xmath11 mpc ( kashlinsky et al 2008 , 2009a - kabke1,2 ) . that analysis has now been extended to a still larger and deeper sample of over 1,000 clusters and 5-yr wmap data ( kashlinsky et al 2009b - hereafter kaeek ) .",
    "the kaeek analysis confirms the kabke1,2 results and shows that the flow remains coherent and extends to at least twice the distance probed in kabke1,2 .",
    "a larger cluster sample enabled kaeek to bin the signal by cluster x - ray luminosity ( @xmath12 ) .",
    "the dipoles evaluated for binned subsamples increase systematically with increasing @xmath12-threshold , as expected if the signal is produced from the ksz effect by all clusters participating in the same motion , a correlation that would not exist if the signal was produced by a rare excursion from noise or primary cmb .",
    "upcoming data from both the long integration wmap data and the planck mission will bring more accurate cmb maps .",
    "planck data will be particularly important because of its wider frequency coverage , finer angular resolution and lower instrument noise .",
    "it is imperative to identify the prospects and limitations of the applications of the current kab methodology to these future datasets .",
    "also , alternative methods can test the existence of a large scale flow ( see itoh , yahada & takata , 2009 ; zhang , 2010 ) .",
    "in this paper we present a detailed analysis of the uncertainties affecting the measured bulk flow providing the necessary details to support the kaeek results . in sec .",
    "2 we briefly summarize our method followed by a summary of data and dipole analysis . in sec",
    "3 we present a theoretical derivation of the error bars , showing when they become dominated by cosmic variance of the cosmological cmb residual that remains in the maps after filtering .",
    "it is demonstrated that for the cmb sky of _ our _ universe and an isotropic all - sky cluster catalog the errors in the kabke / kaeek dipole measurements are @xmath13k per dipole component .",
    "_ given the filtering scheme adopted in our studies _ , these errors can not be reduced much in cmb data with lower instrument noise .",
    "rather the strategy of further increasing the signal - to - noise in the measured dipole value must be through increasing the number of clusters . particularly important would be to increase the number of observed clusters at the bright end of the cluster luminosity function , where the much larger cluster optical depth , @xmath14 , compensates for the decrease in the abundance of such clusters ( kaeek ) . in sec 4",
    "we discuss different methods to estimate error bars describing their various biases .",
    "5 addresses the overall statistical significance of the measurement .",
    "given that the measured dipole increases with the x - ray luminosity threshold , the signal found in kabke1,2 and kaeek can not arise in primary cmb , but tsz dipole contributions can potentially provide confusion to the measurement .",
    "section 6 discusses such possible systematic effects due to tsz and we show there that all are of negligible amplitude and none could have generated the measured signal . finally , in sec .",
    "7 we present our conclussions .",
    "if a cluster at angular position @xmath15 has the line - of - sight velocity @xmath16 with respect to the cmb , the sz cmb fluctuation at frequency @xmath17 at this position will be @xmath18 , with @xmath19=@xmath20 and @xmath21=@xmath22 , being @xmath23 the angle between the cluster peculiar velocity @xmath24 and the line of sight .",
    "here @xmath25 to @xmath26 and @xmath27 if the thermodynamic cmb temperature is measured over the range of frequencies probed by the wmap data , @xmath14 is the projected optical depth due to compton scattering , @xmath28 is the cluster electron temperature and @xmath29=511 kev .",
    "when averaged over many isotropically distributed clusters moving with a significant bulk flow with respect to the cmb , the kinematic term generates a dipole contribution that could dominate , enabling a measurement the bulk motion @xmath30 of the cluster sample .",
    "thus , kab suggested measuring the dipole component of @xmath31 at @xmath32 cluster locations on the cmb sky .",
    "we denote by @xmath33 the monopole and three dipole components evaluated over some locations in the sky and follow the same conventions as in kabke1,2 and kaeek : @xmath34 and @xmath35 with @xmath36 and @xmath37 are the direction cosines of a vector with angular coordinates @xmath38 .",
    "brackets represent averages taken over the cluster population of our catalog .",
    "the definition of monopole and dipole above follows the convention used in the healpix * remove_dipole * routine .",
    "the dipole power is defined as @xmath39 , where @xmath40 are the three dipole components . with our normalization",
    ", @xmath41 is such that a coherent motion at velocity @xmath30 would lead to @xmath42 , where @xmath43k is the present - day cmb temperature . for reference , @xmath44k .",
    "when the dipole is computed at the position of @xmath32 clusters , it will have contributions from 1 ) the instrument noise , 2 ) the tsz component , 3 ) the primary cosmological cmb fluctuation component from the last - scattering surface , and 4 ) the various foreground contributions at wmap frequencies .",
    "the latter can be significant at the k and ka wmap channels , so we restricted our analyses to the wmap channels q , v and w which have negligible foreground contributions .",
    "for @xmath45 the dipole of the observed @xmath46 becomes @xmath47 prior to any analysis , the cmb dipole due to our motion with respect to the isotropic cmb frame is removed from the data .",
    "the ksz effect measures velocities with respect to the cmb frame which also is taken to be the frame of the universal expansion .",
    "this does not change when all - sky dipole or any other @xmath48-pole moments are subtracted in the all - sky maps .",
    "this dipole subtraction removes our peculiar velocity , @xmath49 , contributions down to @xmath50 $ ] contributions to the quadrupole . to check that the latter does not contribute to the measurement",
    ", we also ran the pipeline subtracting the all - sky quadrupole from the original maps and detected only negligible differences in the final results .",
    "as shown in kab , in this way the ksz term can be isolated in eq .",
    "[ eq : dipole ] .",
    "the process that enabled us to isolate the ksz term is described in detail in kabke1,2 . briefly :    \\(a ) an all - sky catalog of x - ray selected galaxy clusters was constructed using available x - ray data extending to @xmath51 .",
    "\\(b ) as indicated , we only used wmap q , v and w bands , where the foreground contamination is smallest .",
    "we applied the 3- and 5-yr version of the kp0 mask to remove those pixels where galactic or point source contributions dominate .",
    "next , to prevent any power leakage from the dipole generated by our peculiar velocity , it was removed from the pixels that survived the mask .",
    "furthermore , kaeek explicitly removed dipole _ and _ quadrupole from the original maps and demonstrated that the quadrupole did not contribute to the results .",
    "this removes @xmath49 down to @xmath52 $ ] contribution to the octupole .",
    "\\(c ) the cosmological cmb component was removed from the wmap data using a wiener - type filter , constructed using the @xmath53cdm model that best fit the data .",
    "it was constructed in order to minimize the difference @xmath54 .",
    "next , filtered maps were constructed using all multipoles with @xmath55 and keeping the same phases as in the original maps . modes with @xmath56 were not included to avoid any possible contributions that could be introduced by the alignment of those low order multipoles and also because those modes would potentially be the most affected by any hypothetical power leakage .",
    "\\(d ) the wiener filter is constructed ( and is different ) for each da channel because the beam and the noise are different .",
    "this prevents inconsistencies and systematic errors that could have been generated if a common filter was applied to the eight channels of different noise and resolution .",
    "\\(e ) in the filtered maps , the monopole and dipole are computed exclusively at the cluster positions , using healpix * remove_dipole * routine ascribing to each cluster a given circular aperture .",
    "due to the variations of the galactic absorbing column density and rosat observing strategy , cluster selection function and x - ray properties may vary across the sky introducing possible systematics . in kabke1,2",
    "we used the measured x - ray extent of each cluster , @xmath57 and computed the dipole for different apertures , in multiples of @xmath57 and , to avoid being dominated by a few very extended nearby clusters like coma , we introduced a cut so the final extent of any cluster was always smaller than 30. there we computed core radii directly from the data and from an @xmath58 relation .",
    "analyses using both sets gave consistent results , consistent with the x - ray systematic effects not affecting our results significantly .",
    "more important , variations in the final aperture were already tiny in the kabke1,2 analysis and kaeek used altogether a fixed aperture were the mean monopole vanishes .",
    "the kaeek results are consistent with the previous ( kabke1,2 ) measurements . fixing the same aperture for all clusters simplifies the statistical analysis and this is the approach taken in this article .",
    "\\(f ) we compute the monopole and dipole for different angular apertures . at small apertures ( @xmath59 ) ,",
    "clusters show a clear tsz decrement , but the amplitude of the signal falls off with increasing angular aperture .",
    "the final dipole is computed at the aperture where the mean monopole of the clusters vanishes .",
    "this ensures that the tsz contribution to the measured dipole is negligible and does not confuse the ksz component .",
    "\\(g ) our final result is a dipole measured in units of thermodynamic cmb temperature . to translate the three measured dipoles into three velocity components , we need to determine the average cluster optical depth to the cmb photons , @xmath60 , on the filtered maps .",
    "since filtering reduces the intrinsic cmb contribution , it also modifies its optical depth , @xmath14 . in kabke1,2",
    "we introduced a calibration factor @xmath61 that gave the ksz dipole in @xmath62k of a bulk motion of amplitude @xmath63 .",
    "the calibration factor depends both on the filter and on the cluster profile . in kabke1,2 and kaeek it was estimated using a @xmath64 model and the angular x - ray extent of the cluster .",
    "we defer to sec .  5 a discussion on the statistical significance of our measurements .",
    "we emphasize that in the filtered maps we measure monopole and dipole simultaneously .",
    "the monopole is dominated by the tsz component and its amplitude sets an upper limit on @xmath65 ( see eq .  [",
    "eq : dipole ] ) , the tsz dipole due to an inhomogeneous cluster distribution on the sky .",
    "we found a dipole at cluster positions with a high confidence level and we obtained this dipole at the ( fixed ) cluster aperture _ when the tsz monopole component was zero_. since the tsz component from the clusters vanishes , only a contribution from the ksz component , due to large - scale bulk motion of the cluster sample , remains .",
    "the main current uncertainty in our method is the calibration , currently parameterized with the @xmath61 quantity , which generally is a matrix . at present",
    ", we do not have enough information on the tsz profile of the clusters in our catalog to increase the accuracy of our calibration .",
    "sec . 8 of kabke2 discusses the issues and points out that we may be _ overestimating _ the velocity amplitude in the current cluster catalog by @xmath66 .",
    "however , this question is significant only insofar as the precise amplitude of the flow velocity in km / sec is concerned .",
    "planck , with its large frequency coverage , will allow the measurement of individual profiles for an important fraction of clusters in our catalog and should enable us determine the calibration coefficients more accurately .",
    "the kab method to measure bulk flows using clusters of galaxies as tracers of the velocity field requires the intrinsic cmb component to be removed from the data . to this end",
    "we have designed a filter which minimizes @xmath67 . as we show below this filter",
    "removes the primary cmb anisotropies down to the fundamental limit imposed by the cosmic variance . in fourier space",
    "this filter is expressed as @xmath68 where @xmath69 is the power measured in each differencing assembly ( da ) corrected for the mask sky area , and @xmath70 is the power spectrum of the theoretical model that best fits the data , convolved with the antenna beam @xmath71 of each da .",
    "although this filter removes much of the intrinsic primary cmb contributions , it leaves a residual cmb component since the theoretical model does not reproduce perfectly the data measured at our location .",
    "this residual will be common to all frequencies and , since it is correlated between the various da s , it limits the accuracy down to which the primary cmb can be removed in the kab method .",
    "because of the cosmic variance , the power of the cmb sky at our location @xmath72 differs from the theoretical model @xmath73 and so a residual cmb signal from primary anisotropies is left in the filtered maps . to estimate the contribution of noise and the cmb residual to the total power on these maps , let @xmath74 be the temperature anisotropy of the filtered maps expanded in spherical harmonics @xmath75 .",
    "the variance of any filtered map is : @xmath76 as indicated , @xmath77 contains the cosmological cmb signal and noise , @xmath78 .",
    "the power spectrum at our location differs from the underlying power spectrum by a random variable of zero mean and ( cosmic ) variance @xmath79 , where @xmath80 is the fraction of the sky covered by the data ( abbot & wise 1984 ) .",
    "then , due to cosmic variance , @xmath81 .",
    "the above limits on @xmath82 bound the range of @xmath83 , eq .",
    "( [ sigmafil ] ) , to : @xmath84= \\sigma_{cv , fil}^2+\\sigma_{n , fil}^2(t_{\\rm obs } ) \\label{sigmafil2}\\ ] ] in this last expression , the variance of the filtered map depends on two components : the residual cmb left due to cosmic variance @xmath85 and the noise @xmath86 , that is not removed by the filter .",
    "the latter component integrates down with increasing observing time @xmath87 as @xmath88 and becomes progressively less important in wmap data with longer integration time .",
    "we denote by @xmath89 and let @xmath90 be the cumulative variance of the residual map . with these definitions ,",
    "the total variance of the filtered map is @xmath91 . for healpix maps with @xmath92",
    "the maximal multipole is @xmath93 ( gorski et al 2005 ) . in figure  [ fig1 ]",
    "we plot this cumulative contribution of each multipole @xmath48 , @xmath94 , to the total rms of the map .",
    "the solid lines represent the mean and rms @xmath94 of filtered maps of 4,000 realizations of the q1 da ; the shaded area represents the dispersion of those realizations , the dot - dashed line is the same quantity but for the filtered q1 wmap 5-year data .",
    "the lower dashed lines represent @xmath85 , the residual cmb component , and upper dashed line , the total variance of the map [ eq  ( [ sigmafil2 ] ) ] .",
    "the dot - dashed line also contains any contributions from foreground emissions ; the fact that it lies so close to the to the region expected from simulating cmb sky implies that foreground emission contributions to @xmath83 are small .",
    "figure  [ fig1 ] clearly shows that for multipoles below @xmath95 the cumulative variance of the 5-year wmap maps @xmath96 is dominated by the residual primary cmb signal from the cosmic variance , even though the total variance of the filtered maps is dominated by noise . for the q1 wmap channel ,",
    "the mean variance of our simulations was @xmath97k)@xmath98 out of which @xmath99k)@xmath98 come from the residual primary cmb signal .",
    "finally , figure  [ fig1 ] indicates that our filter removes the intrinsic cmb down to the fundamental limit imposed by cosmic variance . in this sense",
    "the filter is close to optimal , since it minimizes the errors contributed to our measurements by primary cmb . in principle",
    ", one can define a more aggressive filter that , together with the intrinsic cmb , also removes the noise leaving only the sz signal .",
    "but filtering is not a unitary operation and does not preserve power .",
    "such a filter would then remove an important fraction of the sz component and would probably reduce the overall s / n . in general , a different filter would give different dipole ( measured in units of temperature ) and would require a different calibration .",
    "discussion of filtering schemes that maximize the s / n ratio and minimize the systematic error on the calibration will be given elsewhere .",
    "here we consider how the two components present in the filtered maps , i.e. 1 ) residual primary cmb and 2 ) instrument noise , contribute to the uncertainty in the measurement of bulk flows .",
    "in kabke1,2 we adopted two methods to estimate the uncertainties : ( i ) evaluating monopole and dipole on the filtered maps outside cluster locations and ( ii ) using the same cluster template on simulated maps .",
    "both methods are different but complementary .",
    "errors estimated using method i include any contribution originated by foreground residuals and cmb masking while in method ii we account for the inhomogeneity of the cluster distribution on the sky .",
    "it is important to emphasize that the filtered maps have no _ intrinsic monopole or dipole _ by construction .",
    "since we measure these two moments from a small fraction of the sky , our limited sampling generates an error due to ( random ) distribution of these quantities around their mean zero value .",
    "the sampling variances of @xmath100 and @xmath101 are @xmath102 , @xmath103 , where @xmath104 is the number of independent data points .",
    "direct computation shows that : @xmath105 in this expression , @xmath106 are the direction cosines of clusters .",
    "if clusters were homogeneously distributed on the sky then @xmath107 and one should recover the dipole errors of @xmath108 .",
    "thus the error on the monopole serves as a consistency check in any such computation .",
    "3 discussed the two components of the variance of the filtered map .",
    "as before , @xmath109 and @xmath110 represent the contribution to the total variance due to the residual cmb component and the noise , respectively . when we estimate error bars by placing random clusters on the real filtered maps outside clusters ( method i ) or the real clusters on simulated filtered data ( method ii ) , @xmath111 clusters occupy @xmath112 in @xmath113 differencing assemblies .",
    "as the residual cmb signal is correlated from map to map , it will decrease only as the number of clusters increases , but the noise term will decrease much faster since it is uncorrelated from map to map and pixel to pixel and integrates down with @xmath113 and the integration time . then , the resulting sampling variance will be @xmath114 as expected from eq . [",
    "eq : sqrt3 ] , for an homogeneous cluster catalog the variance in each dipole component is three times larger than on the monopole since three quantities are derived from the same data set . from figure  [ fig1 ]",
    "we obtain that @xmath115k and @xmath116k . when clusters are not homogeneously distributed in the sky ,",
    "the basis of direction cosines is no longer orthogonal and error bars need to be estimated numerically .",
    "the results presented in figure  [ fig1 ] together with eq .",
    "( [ sigma_mon ] ) indicate that method ii will give slightly larger error bars .",
    "if monopole and dipole are evaluated at cluster positions on _ simulated _ maps then @xmath85 and @xmath86 in eq .",
    "( [ sigma_mon ] ) will be close to the average cmb residual and noise of the simulated maps .",
    "as figure  [ fig1 ] indicates , they are larger than the filtered data ( shown by a dot - dashed line ) corresponding to the cmb realization representing our universe .",
    "the latter , however , is the only cmb sky relevant for the true error analysis in this measurement .",
    "this fact was already noticed in kabke2 where such comparison was made and the errors were found to be 10 - 15% larger if using method ii .    to avoid this bias ,",
    "we introduce method iia : error bars are computed from random realizations of the _ power spectrum of the filtered maps_. in figure  [ fig2 ] we plot the histograms of the monopole and dipole components of 4,000 simulations of 1000 clusters with constant angular size of 30@xmath117 with both method i ( random clusters located outside the mask on the real data ) and method iia ( the cluster template is fixed and the sky is simulated ; the spectrum are gaussian realizations of the measured power of the filtered maps ) . from left to",
    "right we display the histogram of the monopole and @xmath118 components of the dipole .",
    "the rms deviations , given to the left and right of each plot , correspond to method i and method iia , respectively .",
    "solid lines represent the histograms in method i and dashed lines in method iia .",
    "we find that , to good accuracy , the distribution of the monopole and dipoles is gaussian with zero mean .",
    "more importantly , we see no systematic differences between both methods . then",
    ", neither foreground residuals nor cluster inhomogeneities have a significant contribution to the estimated error bars .",
    "instead the errors are dominated by the sampling / cosmic variance when measuring the monopole and dipole from a limited fraction of the sky .    to test the validity of eq .",
    "( [ sigma_mon ] ) we carried out another 4,000 simulations with different number of clusters : @xmath119100 , 180 , 320 , 570 and 1000 in accordance with table 1 of kaeek .",
    "in method i , we placed @xmath111 clusters at random on the sky . to be fully consistent with how cluster samples are selected from the data , the smaller samples are subsets chosen randomly from the full sample . in figure  [ fig3 ]",
    "we plot the rms deviation of the monopole ( open triangles ) and the three dipole components .",
    "filled circles , diamonds and solid triangles correspond to the @xmath118 dipole components .",
    "solid lines connect the results when clusters are assigned radii of 30@xmath117 , while dashed lines correspond to results with 20@xmath117 clusters and follow the same ordering as the solid lines .",
    "the figure shows that @xmath120 with great accuracy",
    ". as expected , the errors are larger when the cluster size is smaller because of the different numbers of pixels entering the instrument noise contribution in eq .",
    "( [ sigmafil2 ] ) . in figure",
    "[ fig3 ] , the differences between the dipole components come from differences in sky coverage .",
    "the @xmath121 and @xmath122 components , that are in the plane of the galaxy , are determined with progressively less accuracy since the cmb data in the galactic plane is dominated by foreground emission . still the difference from the uncertainty of the @xmath123-component is small ( @xmath124 ) particularly for the better measured @xmath122-component of the dipole .",
    "we can use eq .",
    "( [ sigma_mon ] ) to estimate how accurately we measure any dipole component compared to the monopole . in figure",
    "[ fig4]a we plot @xmath125 , the ratio of the rms deviation of dipole components to the rms of the monopole of the 4,000 simulations generated using method i , as described above . filled circles , diamonds and triangles correspond to the ratio of the @xmath118 rms deviation of the dipole to that of the monopole , respectively . in figure",
    "[ fig4]b we plot the same magnitudes for method iia .",
    "the dotted line represents @xmath126 that corresponds ( in eq  [ sigma_mon ] ) when clusters are homogeneously distributed in the sky .",
    "figure  [ fig4]a clearly indicates that when clusters are chosen randomly on the sky , the error on the x - component is larger than on y or z and the scaling with the number of clusters was very close to @xmath127 , as seen also in figure  [ fig3 ] . in figure",
    "[ fig4]b the behavior is very similar : the error on the x - component is largest . in this case , and since in method iia the cluster template is fixed , the scaling is not as exactly @xmath128 , reflecting the inhomogeneities present in the cluster distribution .",
    "however , these deviations are not very significant .    to study the effect of cluster inhomogeneities potentially present in studies based on other catalogs , we carry a different analysis .",
    "in fig  [ fig4]c we excise clusters from the kaeek catalog as a function of galactic latitude .",
    "we plot @xmath129 evaluated over the cluster distribution when all clusters with @xmath130 are removed .",
    "thick and thin solid and dashed lines correspond to the @xmath131 components , respectively .",
    "the dotted line is @xmath132 , that would correspond to a cluster catalog that samples the sky homogeneously .",
    "since the mask removes the data in the galactic plane , for @xmath133 there is little deviation from the kaeek errors . for much larger values of @xmath134 , the error on the @xmath121 and @xmath122 components increases while the error on the @xmath123 component approaches that of the monopole .",
    "then , eq  ( [ sigma_mon ] ) permits to write the error bars as @xmath135k , i.e. , the expected accuracy for each of the components would be only 12 and 5% worse that for an all sky survey , compared with that of the monopole , while the @xmath123 component would be 12% better since the galaxy removes the region of the sky where there is no contribution to it .    comparing the different panels in figure  [ fig4 ]",
    ", we see that @xmath136 may be smaller than the value estimated from the geometry of the catalog as is evident when comparing this ratio for @xmath137 in figure  [ fig4]b with figure  [ fig4]c .",
    "however , while in ( c ) the ratio of the errors is computed from the cluster geometry , in ( b ) they are estimated from simulations whereby in method iia we use simulations of the power spectrum of the filtered cmb data .",
    "since monopole and dipole are sensitive to different parity multipoles ( even vs odd ) , the slightly lower value of the dipole components with respect to the monopole is reflecting a power asymmetry between odd and even multipoles in the filtered map .",
    "so , on average the monopole is larger than in a random sky and the dipole is smaller .",
    "this effect introduces an extra variance and enhances the differences between fig  [ fig4]a and b.    when this paper was being completed , keisler ( 2009 ) replicated the analysis of kabke1,2 compiling his own x - ray cluster catalog using publicly available data .",
    "analogously to kaeek and this study , he noticed that the errors on wmap 3-year data were already dominated by the residual cmb and not by the noise .",
    "he confirmed the measured central dipole values of kabke2 , but claimed significantly larger errors than kaeek , particularly for the @xmath122-component .",
    "( we note again that if the kabke1,2 dipole originated from primary cmb and/or noise , its magnitude should display _ no correlation _ with the cluster luminosity threshold that was demonstrated to exist in kaeek ) .",
    "specifically , in the final configuration his catalog contained @xmath138 clusters and his claimed errors were @xmath139k .",
    "those errors are larger than those quoted in kaeek . a small increment ( of order of 10 - 15% )",
    "can be accounted for by his treatment of the errors using simulations of the cmb sky around the theoretical @xmath53cdm model and thereby pumping up the cosmic variance component ( see fig .",
    "[ fig1 ] ) , as well as anisotropies in his catalog .",
    "keisler ( 2009 ) uses a catalog without recomputing cluster properties from x - ray data , a procedure done in kocevski & ebeling ( 2006 ) .",
    "that dataset is then less complete , especially at low latitudes , but that in itself can account only for a small increase in the errors .",
    "however , keisler ( 2009 ) claims an increase in errors by a factor of @xmath140 compared to kabke2",
    ". clearly , the effect of residual cmb correlations between the @xmath141 wmap channels can at most increase the kabke1,2 errors by a factor of @xmath142 .",
    "( in reality , because the instrument noise is also present , the errors on individual dipole components in table 2 of kabke would be increased for 3-year wmap data by a factor of @xmath143 to become @xmath144k at the largest redshift bin . ) a larger increase , as we have demonstrated above , can not happen .",
    "in our computations we do not reproduce keisler ( 2009 ) errors with proper analytical and numerical procedures , even using his methodology .",
    "interestingly , we recover the magnitude of his claimed errors if one important aspect of the kabke processing is omitted .",
    "when working on simulated data such as in method ii , care must be taken to replicate all the details of the data analysis done in kabke1,2 .",
    "the filter must be constructed using the theoretical model and the simulated data . since only modes with @xmath55",
    "are used to generate the filtered map , by construction it has zero monopole and dipole .",
    "but this map covers the full sky and is not yet the correct model for the data .",
    "one needs to remove the monopole and dipole outside the galactic mask , as is done with the filtered data in our processing .",
    "the full map has zero monopole and dipole , but _ the fraction of the sky outside the mask does not_. to test this effect we carry out two sets of 4,000 simulations s1 and s2 , starting with the same initial seed and using method ii . in s1 simulations we removed monopole and dipole _ outside _ the galactic mask ; in s2 we did not . in figure  [ fig5 ]",
    "we show the histograms with the distribution ( from left to right ) of the monopole and the ( x , y , z ) components of the dipole .",
    "the solid and dashed line shows the results for the s1 and s2 simulations , respectively .",
    "the labels on the left ( right ) give the rms deviation for s1 ( s2 ) .",
    "the differences can be easily explained : if the monopole and dipole are not subtracted the measured monopole and dipole at cluster locations are not different from zero simply because we are sampling the signal over a very small fraction of the sky .",
    "rather they are not zero because we are measuring the monopole and dipole present on the fraction of the sky outside the mask .",
    "we checked that when in the s1 simulations we add the variance of the monopole / dipole subtracted outside the mask and the variance of the monopole / dipole computed at cluster positions , we obtain exactly the variance measured in the s2 simulations .",
    "for instance , the variances on @xmath145 outside the mask are @xmath146k@xmath147 .",
    "the variances on the monopole / dipoles measured at the location of 1000 clusters of our catalog are @xmath148k@xmath147 ; if added with the previous variances , the monopole / dipoles error bar increase by ( 46,36,41,5)% , respectively . as expected we see that , since the @xmath123 axis is perpendicular to the galactic plane , the error bars are boosted preferentially in the @xmath121 and @xmath122 directions .",
    "this explains that in s2 simulations the error in the monopole @xmath149 - as well as @xmath150 - is larger than @xmath151 .",
    "only in the case of the faulty s2 processing do we recover the magnitude of errors found by keisler .",
    "we can not claim that this step was necessarily overlooked by him but we do find this coincidence puzzling especially when considering the deviation of his ratios of @xmath152 and @xmath153 from the ( analytically ) explained ratios ( fig .",
    "4 ) and fig . 1 .",
    "because of the correlations in the final filtered maps between the eight wmap da s , the s / n of the dark flow measurement is smaller than suggested in table 2 of kabke2 for individual dipole components , although not fatally so .",
    "this was corrected in kaeek , where it was also demonstrated that the dipole correlates strongly with the cluster x - ray luminosity @xmath12 , as it should if the dipole signal originated from the ksz effect and not from the primary cmb .",
    "the minimal s / n of the dark flow measurement is , of course , given by the single da map processing .",
    "fig . 8 of kabke2 , which plots the mean cmb temperature decrement over cluster pixels versus the cosine of the angle between the cluster and the apex of the motion , shows that kabke1,2 already detect the dipole at cluster positions at the @xmath154 level in _ each _ of the eight das .",
    "the overall s / n can not then be lower than this floor level .",
    "kaeek further increase this significance and measure the motion to a much larger scale .",
    "the systematic uncertainties in our calibration procedure do not yet allow us to quantify the properties of the flow better , but we hope to accomplish this task in the coming years .    in the kaeek catalog ,",
    "the error on the @xmath122 component is only 5% larger than what it would be for a homogeneous cluster catalog .",
    "future versions of the catalog will include clusters at higher redshifts that will help to probe the velocity field on even larger scales .",
    "a great effort is devoted to produce a spatially homogeneous and flux limited sample .",
    "if the `` dark flow '' is but a large scale flow that affects all the scales out to the horizon , one could argue that the signal is uniform on the entire sky and would be unaffected by anisotropies on the cluster distribution in alternative catalogs , but this is not so , as fig .",
    "[ fig4 ] indicates : incompleteness and asymmetries increase the error bars and could make some cluster catalogs insensitive to the flow .",
    "the original evidence in favor of the measurement being real were three ( kabke1,2 ) : _ ( a ) the motion was found at cluster positions , ( b ) it was persistent when the number of clusters increased from @xmath155 to @xmath156 , ( c ) the dipole ksz signal was measured when the tsz monopole vanished . _",
    "since the thermal and kinematic components are both generated by the x - ray gas , it was thought that a measurement of the ksz effect could be obtained only when enough frequency coverage allowed to remove the thermal contribution , because of their different frequency dependence .",
    "however , in atrio - barandela et al ( 2008 - hereafter akke ) we showed - for the first time - that cluster gas distribution follows an nfw profile ( navarro , frenk & white 1996 ) .",
    "then , cluster temperature falls with radius and , by adding the contribution from the cluster outskirts , the kinematic component dominates over the thermal in the kab method ( kabke2 ) .",
    "if clusters were isothermal , the thermal sz signal dipole due to the inhomogeneous distribution of the sky could be large enough to make the ksz effect undetectable at wmap frequencies .    in kaeek we provided further evidence in support of the cluster bulk flow being a real effect .",
    "the cluster catalog used there was large enough to allow the analysis to be carried out in luminosity bins .",
    "the ksz signal is @xmath157 .",
    "since @xmath14 is proportional to the cluster electron density , it correlates with x - ray luminosity . if the velocity does not correlate with cluster luminosity , for example if the flow is homogeneous across the cluster sample , we would expect the dipole evaluated at different cluster subsamples to be larger for the more luminous clusters . in kaeek",
    "we were able to carry out such test by decomposing the sample in luminosity bins and the analysis conclusively showed that _",
    "( d ) the measured dipole correlates with x - ray luminosity _ , strengthening the evidence against a possible undiagnosed systematic effect .",
    "in kaeek it was shown that clusters with the highest luminosity dominate the s / n of the measured flow . to quantify the level of statistical significance there",
    ", we generate 10,000 dipole components drawn from a gaussian distribution with zero mean and rms the measured error of each component as shown in table 1 of kaeek .",
    "the significance is then the percentage of simulated values that deviate from zero less than the measurement .",
    "for instance , when we consider the measured dipoles for @xmath158erg / sec clusters with @xmath159 we measured @xmath160k .",
    "if the dipoles @xmath161 are gaussian - distributed random variables , the amplitude of the flow for these clusters is detected at the 99.95% level consistent with our simulations ( in method i we find just 2 realizations out of 4,000 with such parameters ) .",
    "for some other configurations in table 1 of kaeek the confidence level would be even higher .",
    "foreground contributions , by their non - gaussian nature , can in principle alter the above percentiles , but the fact that our universe lies so close to the lines in fig . 1 generated from pure primary cmb",
    ", implies that foreground emissions contributions are small in our calculations .",
    "we do not necessarily advocate the above levels to be highly precise , but this discussion clearly shows that we recover a very statistically significant dipole . while the dipole components are less significant in lower @xmath12-bins , presumably because of the lower @xmath14 s for these clusters , the @xmath162 component is always negative and @xmath163 almost always positive in all three @xmath12-bins , while the @xmath164 component oscillates and is the least accurately measured component . in this case",
    ", the possibility that @xmath164 is zero can be rejected at more than 95% and @xmath165 at the 99% confidence level . due to the changing sign ,",
    "the measurements of the lower @xmath12 bins reduces the significance of the detection of @xmath164 and we can not claim any measurement but the other two components are still significant at more than 95% .",
    "finally , these probabilities would become even higher if one folds in the directional coincidence of the recovered dipole to that measured by watkins et al ( 2009 ) from galaxy surveys data on smaller scales , @xmath166 mpc .",
    "the only possible systematic effect that could mimic our measurements would have to be present exclusively at cluster positions , produce zero monopole and also give a dipole which increases with increasing @xmath12 .",
    "such systematics can not come from primary cmb , and would have to originate from contributions by the sz components , which depend on @xmath12 in the appropriate manner . since in kaeek we showed that the measured dipole correlates with the x - ray luminosity threshold , it is important to discuss possible @xmath12-dependent contributions even if only to rule them out because of their negligible magnitudes .",
    "given that we evaluate the dipole at the aperture where the monopole vanishes , there are three ways that could potentially confuse the measurement : 1 ) systematic effects that could fold the doppler - shifting due to the local motion into the tsz contributions , 2 ) cross - talk effects between the tsz monopole and dipole terms in sparse / small samples ( watkins & feldman 1995 ) ; and 3 ) inner motions of the intracluster medium ( icm ) as opposed to the coherent flow of the entire cluster sample .",
    "we discuss all three of these contributions below and demonstrate that they are negligible . before we go into the rest of the section , we emphasize again that the dipole at cluster positions is measured at zero monopole .",
    "that monopole vanishes within the noise with 1-@xmath167 uncertainty of @xmath168k or amplitudes significantly below @xmath169k for @xmath170 ; the actual numbers are given in table 1 of kaeek .",
    "the first two of these contributions come from the tsz component , while the latter would arise from the ksz effect .",
    "thermal and kinematic sz dipoles will differ in one very important aspect : their frequency dependence .",
    "wmap measures only in the rayleigh - jeans part of the spectrum and for the q , v and w bands the change in amplitude is about @xmath171 , too small to be distinguished ( see kabke2 for a discussion ) .",
    "a tsz induced dipole will change sign in the wien part of the spectrum , while a ksz dipole will preserve it .",
    "the latter will be different from zero at 217ghz , the zero crossing frequency of the thermal component .",
    "although we show below that the tsz induced contributions to the dipole are very small , planck with its large frequency coverage covering both sides of 217 ghz will be definitive in this respect .",
    "the intrinsic cmb dipole due to the motion of the sun is over two orders of magnitude larger than the measured cluster dipole .",
    "this motion is known to be @xmath172km / s in the direction @xmath173 , close to the direction @xmath174 of the local group with respect to the same reference frame ( kogut et al , 1993 ) and is not far within the errors from the direction measured in kaeek : @xmath175 .",
    "an undiagnosed systematic effect , present in the time ordered data or in our pipeline that affect preferentially the tsz signal , could fold the motion of the sun into our measurement .",
    "for example , a residual of the cmb all - sky dipole @xmath176 coupled to the thermal sz effect would correlate with x - ray luminosity and would satisfy the same properties ( a - d ) as the ksz effect , except its frequency dependence .",
    "the amplitude of such undiagnosed systematic dipole will be bound by @xmath177 . in akke",
    "we showed that the tsz amplitude of clusters in unfiltered maps is of the order of @xmath178k and this amplitude is reduced a factor of @xmath179 due to filtering ( kabke2 ) .",
    "then , any possible systematic effect that correlates with cluster luminosity will be @xmath180k , more than 2 orders of magnitude smaller than the measured effect .",
    "since clusters are not randomly distributed on the sky , the tsz signal will give rise to a non - trivial dipole signature that , in principle , may confuse the ksz dipole .",
    "the tsz dipole for a random cluster distribution is given by @xmath181 decreasing with increasing @xmath32 .",
    "this decrease could be altered if clusters are not distributed randomly and there may be some cross - talk between the monopole and dipole terms especially for small / sparse samples ( watkins & feldman 1995 ) . as discussed in kabke2 ,",
    "the dipole from the tsz component varies with the cluster sub - sample , contrary to measurements , and also has negligible amplitude because it is bound from above by the remaining monopole amplitude of @xmath182k measured at the final aperture ( see table 1 of kaeek ) .    in order to assess that there is no cross - talk between the remaining monopole and dipole which may confuse the measured ksz dipole , we proceed in the same manner as in kabke2 ( see fig 6 there ) repeating the following experiment : 1 ) the tsz and ksz components from the catalog clusters were modeled using cluster parameters derived for our current catalog . to exaggerate the effect of the cross - talk from the tsz component , the latter was normalized to @xmath183k , a value significantly larger than the monopoles in table 1 of kaeek at which the final dipole was measured ; the results for even larger monopoles",
    "were also computed and can be scaled as described below .",
    "for the ksz component each cluster was given a bulk velocity , @xmath30 , in the direction specified in table 1 of kaeek , whose amplitude varied from 0 to 2,000 km / sec in 21 increments of 100 km / sec .",
    "the resultant cmb map was then filtered and the cmb dipole , @xmath184 , over the cluster pixels computed for each value of @xmath30 .",
    "2 ) at the second stage we randomized cluster positions with @xmath185 uniformly distributed on celestial sphere over the _ full _",
    "sky for a net of 500 realizations for each value of @xmath30 .",
    "this random catalog keeps the same cluster parameters , but the cluster distribution now occupies the full sky ( there is now no mask ) and on average does not have the same levels of anisotropy as the original catalog .",
    "we then assigned each cluster the same bulk flow and computed the resultant cmb dipole , @xmath186 , for each realization .",
    "the final @xmath186 were averaged and their standard deviation evaluated .",
    "[ fig6 ] shows the comparison between the two dipoles for each value of @xmath30 for the most sparse sub - samples from table 1 of kaeek .",
    "we also made the computations at tsz monopole values still larger than above ( see upper left panel for one such example ) .",
    "the overall contribution from the tsz component to the dipole is @xmath187 , so in the absence of cross - talk effects the amplitude of the scatter in the simulated dipoles is made of two components : 1 ) remaining tsz @xmath187 and 2 ) genuine ksz dipole with amplitude @xmath188 to within the calibration .",
    "one can see that there is no significant offset in the cmb dipole produced by either the mask or the cluster true sky distribution .",
    "the two sets of dipole coefficients are both linearly proportional to @xmath30 and to each other ; in the absence of any bulk motion we recover to a good accuracy the small value of the tsz dipole marked with filled circles . as discussed in kabke2 ,",
    "since the bulk flow motion is fixed in direction and the cluster distribution is random , one expects the calibration parameterized by @xmath61 to be different from one realization to the next , e.g. in some realizations certain clusters may be more heavily concentrated in a plane perpendicular to the bulk flow motion and the measured @xmath61 would be smaller . in our case ,",
    "the mean @xmath61 differs by @xmath124 suggesting that our catalog cluster distribution is close to the mean cluster distribution in the simulations .",
    "this difference in the overall normalization would only affect our translation of the dipole in @xmath62k into @xmath30 in km / sec , but we note again the systematic bias in the calibration resulting from our current catalog modeling clusters as isothermal @xmath64-model systems rather than the nfw profiles required by our observations ( akke , kabke2 ) .",
    "we have no progress to report on this issue beyond discussion in sec .",
    "8 of kabke2 and this paper does not address the measured velocity amplitude stemming from calibration ; this work is in progress and will be addressed after the recalibration of our catalog has been successfully completed",
    ".      the intra - cluster medium ( icm ) may not be at rest in the cluster potential wells as a result of mergers during cluster formation process . in principle , our measurement and interpretation then may be affected by turbulent motions that give rise to a ksz effect that would be larger for the more massive clusters . however , since the motions are randomly oriented with respect to the line of sight , they will not produce a significant effect . in order , to reach the value comparable to @xmath189 km / sec , a typical cluster in our sub - sample of @xmath32 would need to have thermal motions of @xmath190 , over an order of magnitude larger than the velocity dispersion of coma - type clusters . rather these motions will enter the overall dispersion budget ( noise , gravitational instability and this component ) around the coherent bulk flow component shown in fig . 2 of kaeek .",
    "we have analyzed the statistical significance of the results presented in kaeek .",
    "we have identified the main contributions to the error budget : noise and the residual cmb contribution .",
    "while the instrument noise was important in wmap 1-year data , it was much less so in the 3- and 5-year data . with our filtering scheme , there remains a residual contribution due to cosmic variance , which correlates at different frequencies and decreases only as the number of clusters increases .",
    "we have discussed methods to compute the errors and presented analytical discussion to estimate the various contributions to the final error budget .",
    "measuring dipoles with a fixed template over simulated skies increases the error bar in two respects : clusters do not sample the sky homogeneously and different maps will have different cmb residuals . since the measured cmb sky in our universe has less power than the average @xmath53cdm realization , this",
    "also can boost the errors , but by only @xmath210 - 15% .",
    "also , the inhomogeneities on the cluster distribution make the error on the various dipole components different . for the @xmath122 component",
    "the increment is about 5% compared to the ideal case .",
    "we have argued that a proper method to compute error bars would be to perform random simulations of the measured power of the filtered maps corresponding to the cmb sky of our universe .",
    "however , we found that the difference with taking random clusters outside the mask , but using real data , was insignificant .",
    "we have discussed the evidence supporting the existence of the dark flow . independently , different groups using galaxies as tracers of the density or velocity field are showing the amplitude and direction of the local flow that are consistent , albeit at a much smaller scale , with the dark flow motion ( kocevski & ebeling 2006 , watkins et al 2009 , feldman et al and 2009 , lavaux et al 2009 ) .",
    "this analysis with the forthcoming planck data will provide an important consistency check . with a scanning strategy different from wmap and with better frequency coverage",
    ", it will permit us to characterize still better any possible undiagnosed systematic .",
    "the 217 ghz band with @xmath191 resolution will be specially useful since it will allow to measure the ksz signal from central parts of the clusters in our catalog uncontaminated by the thermal component .",
    "this work was supported by nasa adp grants nng04g089 g and 09-adp09 - 0050 .",
    "fab acknowledges financial support from the spanish ministerio de educacin y ciencia ( grant fis2009 - 07238 ) and the junta de castilla y len ( grant gr-234 ) ."
  ],
  "abstract_text": [
    "<S> we analyze the uncertainties and possible systematics associated with the  dark flow \" measurements using the cumulative sunyaev - zeldovich effect combined with all - sky catalogs of clusters of galaxies . </S>",
    "<S> filtering of all - sky cosmic microwave background ( cmb ) maps is required to remove the intrinsic cosmological signal down to the limit imposed by cosmic variance . </S>",
    "<S> contributions to the errors come from the remaining cosmological signal , that integrates down with the number of clusters , and the instrumental noise , that scales with the number of pixels ; the latter decreases with integration time and is subdominant for the wilkinson microwave anisotropy probe 5-year data . </S>",
    "<S> it is proven both analytically and numerically that the errors for 5-year wmap data are @xmath0k per dipole component . </S>",
    "<S> the relevant components of the bulk flow velocity are measured with a high statistical significance of up to @xmath1 for the brighter cluster samples . </S>",
    "<S> we discuss different methods to compute error bars and demonstrate that they have biases that would over predict the errors , as is the case in a recent reanalysis of our earlier results . </S>",
    "<S> if the signal is caused by systematic effects present in the data , such systematics must have a dipole pattern , correlate with cluster x - ray luminosity and be present only at cluster positions . </S>",
    "<S> only contributions from the sunyaev - zeldovich effect could provide such contaminants via several potential effects . </S>",
    "<S> we discuss such candidates apart from the bulk - motion of the cluster samples and demonstrate that their contributions to our measurements are negligible . </S>",
    "<S> application of our methods and database to the upcoming planck maps , with their large frequency coverage , and in particular , the 217ghz channel , will eliminate any such contributions and determine better the amplitude , coherence and scale of the flow .    </S>",
    "<S> epsf    # 1#2 = .45 = .45 </S>"
  ]
}