{
  "article_text": [
    "the topic of decomposing a graph into a given collection of edge - disjoint subgraphs has a long history .",
    "indeed , in 1892 , walecki  @xcite proved that every complete graph of odd order has a decomposition into edge - disjoint hamilton cycles . in a sequence of four papers , we provide a unified approach towards proving three long - standing graph decomposition conjectures for all sufficiently large graphs .      vizing s theorem states that for any graph  @xmath3 of maximum degree @xmath13 , its edge - chromatic number @xmath14 is either @xmath13 or @xmath15",
    "however , the problem of determining the precise value of @xmath16 for an arbitrary graph @xmath3 is np - complete  @xcite .",
    "thus , it is of interest to determine classes of graphs @xmath3 that attain the ( trivial ) lower bound  @xmath13  much of the recent book  @xcite is devoted to the subject . if @xmath3 is a regular graph then @xmath17 precisely when @xmath3 has a @xmath12-factorization : a _ @xmath12-factorization _ of a graph  @xmath3 consists of a set of edge - disjoint perfect matchings covering all edges of  @xmath3 .",
    "the @xmath12-factorization conjecture states that every regular graph of sufficiently high degree has a @xmath12-factorization .",
    "it was first stated explicitly by chetwynd and hilton  @xcite ( who also proved partial results ) . however , they state that according to dirac , it was already discussed in the 1950s .",
    "we prove the @xmath12-factorization conjecture for sufficiently large graphs .",
    "[ 1factthm ] there exists an @xmath18 such that the following holds .",
    "let @xmath19 be such that @xmath20 is even and @xmath1 .",
    "then every @xmath2-regular graph @xmath3 on @xmath0 vertices has a @xmath12-factorization .",
    "equivalently , @xmath4 .",
    "the bound on the minimum degree in theorem  [ 1factthm ] is best possible .",
    "in fact , a smaller degree bound does not even ensure a single perfect matching . to see this ,",
    "suppose first that @xmath21 .",
    "consider the graph which is the disjoint union of two cliques of order @xmath22 ( which is odd ) . if @xmath23 , consider the graph obtained from the disjoint union of cliques of orders @xmath24 and @xmath25 ( both odd ) by deleting a hamilton cycle in the larger clique .",
    "perkovic and reed  @xcite proved an approximate version of theorem  [ 1factthm ] ( they assumed that @xmath26 ) .",
    "recently , this was generalized by vaughan  @xcite to multigraphs of bounded multiplicity , thereby proving an approximate version of a ` multigraph @xmath12-factorization conjecture ' which was raised by plantholt and tipnis  @xcite . further related results and problems are discussed in the recent monograph  @xcite .",
    "a _ hamilton decomposition _ of a graph  @xmath3 consists of a set of edge - disjoint hamilton cycles covering all the edges of  @xmath3 .",
    "a natural extension of this to regular graphs @xmath3 of odd degree is to ask for a decomposition into hamilton cycles and one perfect matching ( i.e.  one perfect matching @xmath27 in @xmath3 together with a hamilton decomposition of @xmath28 ) .",
    "nash - williams  @xcite raised the problem of finding a hamilton decomposition in an even - regular graph of sufficiently large degree .",
    "the following result completely solves this problem for large graphs .",
    "[ hcdthm ] there exists an @xmath18 such that the following holds .",
    "let @xmath19 be such that @xmath29 and @xmath5 .",
    "then every @xmath2-regular graph @xmath3 on @xmath0 vertices has a decomposition into hamilton cycles and at most one perfect matching .",
    "the bound on the degree in theorem  [ hcdthm ] is best possible ( see proposition  3.1 in  @xcite for a proof of this ) .",
    "note that theorem  [ hcdthm ] does not quite imply theorem  [ 1factthm ] , as the degree threshold in the former result is slightly higher .",
    "previous results include the following : nash - williams  @xcite showed that the degree bound in theorem  [ hcdthm ] ensures a single hamilton cycle .",
    "jackson  @xcite showed that one can ensure close to @xmath30 edge - disjoint hamilton cycles .",
    "more recently , christofides , khn and osthus  @xcite obtained an approximate decomposition under the assumption that @xmath31 .",
    "finally , under the same assumption , khn and osthus  @xcite obtained an exact decomposition ( as a consequence of the main result in  @xcite on hamilton decompositions of robustly expanding graphs ) .",
    "dirac s theorem is best possible in the sense that one can not lower the minimum degree condition .",
    "remarkably though , the conclusion can be strengthened considerably : nash - williams  @xcite proved that every graph @xmath3 on @xmath0 vertices with minimum degree @xmath32 contains @xmath33 edge - disjoint hamilton cycles .",
    "nash - williams  @xcite raised the question of finding the best possible bound on the number of edge - disjoint hamilton cycles in a dirac graph .",
    "this question is answered by corollary  [ nwmindegcor ] below .",
    "in fact , we answer a more general form of this question : what is the number of edge - disjoint hamilton cycles one can guarantee in a graph @xmath3 of minimum degree  @xmath9 ?",
    "let @xmath34 be the largest degree of an even - regular spanning subgraph of @xmath3 .",
    "then let @xmath35 clearly , in general we can not guarantee more than @xmath36 edge - disjoint hamilton cycles in a graph of order @xmath0 and minimum degree @xmath9 .",
    "the next result shows that this bound is best possible ( if @xmath37 , then @xmath38 ) .",
    "[ nwmindeg ] there exists an @xmath18 such that the following holds .",
    "suppose that @xmath3 is a graph on @xmath39 vertices with minimum degree @xmath6 .",
    "then @xmath3 contains at least @xmath40 edge - disjoint hamilton cycles .",
    "khn , lapinskas and osthus  @xcite proved theorem  [ nwmindeg ] in the case when @xmath3 is not close to one of the extremal graphs for dirac s theorem . an approximate version of theorem  [ nwmindeg ] for @xmath41 was obtained earlier by christofides , khn and osthus  @xcite .",
    "hartke and seacrest  @xcite gave a simpler argument with improved error bounds .",
    "the following consequence of theorem  [ nwmindeg ] answers the original question of nash - williams .",
    "[ nwmindegcor ] there exists an @xmath18 such that the following holds .",
    "suppose that @xmath3 is a graph on @xmath39 vertices with minimum degree @xmath6 .",
    "then @xmath3 contains at least @xmath42 edge - disjoint hamilton cycles .",
    "see  @xcite for an explanation as to why corollary  [ nwmindegcor ] follows from theorem  [ nwmindeg ] and for a construction showing the bound on the number of edge - disjoint hamilton cycles in corollary  [ nwmindegcor ] is best possible ( the construction is also described in section  [ sec : sketch1 ] ) .",
    "for all three of our main results , we split the argument according to the structure of the graph @xmath3 under consideration :    1 .",
    "@xmath3 is close to the complete balanced bipartite graph @xmath43 ; 2 .",
    "@xmath3 is close to the union of two disjoint copies of a clique @xmath44 ; 3 .",
    "@xmath3 is a ` robust expander ' .    roughly speaking",
    ", @xmath3 is a robust expander if for every set @xmath45 of vertices , its neighbourhood is at least a little larger than @xmath46 , even if we delete a small proportion of the edges of @xmath3 .",
    "the main result of  @xcite states that every dense regular robust expander has a hamilton decomposition .",
    "this immediately implies theorems  [ 1factthm ] and  [ hcdthm ] in case  ( iii ) . for theorem  [ nwmindeg ] , case ( iii )",
    "is proved in  @xcite using a more involved argument , but also based on the main result of  @xcite .",
    "case  ( ii ) is proved in  @xcite .",
    "the current paper is devoted to the proof of case  ( i ) . in",
    "@xcite we derive theorems  [ 1factthm ] ,  [ hcdthm ] and  [ nwmindeg ] from the structural results covering cases ( i)(iii ) .    the arguments in the current paper for case  ( i ) as well as those in  @xcite for case  ( ii ) make use of an ` approximate ' decomposition result proved in  @xcite .",
    "in both case  ( i ) and case  ( ii ) we use the main lemma from  @xcite ( the ` robust decomposition lemma ' ) when transforming this approximate decomposition into an exact one .      as mentioned above",
    ", the focus of this paper is to prove theorems  [ 1factthm ] ,  [ hcdthm ] and  [ nwmindeg ] when our graph is _ close _ to the complete balanced bipartite graph @xmath43 .",
    "more precisely , we say that a graph @xmath3 on @xmath0 vertices is _",
    "@xmath47-bipartite _ if there is a partition @xmath48 of @xmath49 which satisfies the following :    * @xmath50 ; * @xmath51    the following result implies theorems  [ 1factthm ] and [ hcdthm ] in the case when our given graph is close to @xmath43 .    [ 1factbip ] there are @xmath52 and @xmath53 such that the following holds .",
    "suppose that @xmath54 and @xmath2 is even and suppose that @xmath3 is a @xmath2-regular graph on @xmath55 vertices which is @xmath56-bipartite .",
    "then @xmath3 has a hamilton decomposition .",
    "the next result implies theorem  [ nwmindeg ] in the case when our graph is close to @xmath43 .",
    "[ nwmindegbip ] for each @xmath57 there are @xmath52 and @xmath53 such that the following holds .",
    "suppose that @xmath58 is an @xmath56-bipartite graph on @xmath55 vertices with @xmath59 .",
    "suppose that @xmath58 has a @xmath2-regular spanning subgraph @xmath3 such that @xmath60 and @xmath2 is even .",
    "then @xmath58 contains @xmath61 edge - disjoint hamilton cycles .",
    "note that theorem  [ 1factbip ] implies that the degree bound in theorems  [ 1factthm ] and  [ hcdthm ] is not tight in the almost bipartite case ( indeed , the extremal graph is close to being the union of two cliques ) . on the other hand ,",
    "the extremal construction for corollary  [ nwmindegcor ] is close to bipartite ( see section  [ sec : sketch1 ] for a description ) .",
    "so it turns out that the bound on the number of edge - disjoint hamilton cycles in corollary  [ nwmindegcor ] is best possible in the almost bipartite case but not when the graph is close to the union of two cliques .",
    "in section  [ sec : sketch ] we give an outline of the proofs of theorems  [ 1factbip ] and  [ nwmindegbip ] .",
    "the results from sections  [ eliminating ] and  [ findbes ] are used in both the proofs of theorems  [ 1factbip ] and  [ nwmindegbip ] . in sections  [ sec : spec ] and",
    "[ sec : robust ] we build up machinery for the proof of theorem  [ 1factbip ] .",
    "we then prove theorem  [ nwmindegbip ] in section  [ sec : proof1 ] and theorem  [ 1factbip ] in section  [ sec : proof2 ] .",
    "unless stated otherwise , all the graphs and digraphs considered in this paper are simple and do not contain loops .",
    "so in a digraph @xmath3 , we allow up to two edges between any two vertices ; at most one edge in each direction . given a graph or digraph @xmath3 , we write @xmath49 for its vertex set , @xmath62 for its edge set , @xmath63 for the number of its edges and @xmath64 for the number of its vertices .",
    "suppose that @xmath3 is an undirected graph .",
    "we write @xmath65 for the minimum degree of @xmath3 and @xmath66 for its maximum degree . given a vertex @xmath67 of @xmath3 and a set @xmath68",
    ", we write @xmath69 for the number of neighbours of @xmath67 in @xmath3 which lie in  @xmath70 . given @xmath71 , we write @xmath72 for the set of all those edges of @xmath3 which have both endvertices in @xmath70 and @xmath73 for the set of all those edges of @xmath3 which have one endvertex in @xmath70 and its other endvertex in @xmath74",
    ". we also call the edges in @xmath73 _ @xmath75-edges _ of @xmath3",
    ". we let @xmath76 and @xmath77 .",
    "we denote by @xmath78 $ ] the subgraph of @xmath3 with vertex set @xmath70 and edge set @xmath72 . if @xmath79 , we denote by @xmath80 $ ] the bipartite subgraph of @xmath3 with vertex classes @xmath70 and @xmath74 and edge set @xmath73 . if @xmath81 we define @xmath80:=g[a]$ ] .",
    "we often omit the index @xmath3 if the graph @xmath3 is clear from the context .",
    "a spanning subgraph @xmath82 of @xmath3 is an _",
    "@xmath83-factor _ of @xmath3 if every vertex has degree @xmath83 in @xmath82 .",
    "given a vertex set @xmath84 and two multigraphs @xmath3 and @xmath82 with @xmath85 , we write @xmath86 for the multigraph whose vertex set is @xmath87 and in which the multiplicity of @xmath88 in @xmath86 is the sum of the multiplicities of @xmath88 in @xmath3 and in  @xmath82 ( for all @xmath89 ) .",
    "we say that a graph @xmath3 has a _ decomposition _ into @xmath90 if @xmath91 and the @xmath92 are pairwise edge - disjoint .",
    "if @xmath3 and @xmath82 are simple graphs , we write @xmath93 for the ( simple ) graph whose vertex set is @xmath87 and whose edge set is @xmath94 .",
    "similarly , @xmath95 denotes the graph whose vertex set is @xmath96 and whose edge set is @xmath97 .",
    "we write @xmath98 for the subgraph of @xmath3 which is obtained from @xmath3 by deleting all the edges in @xmath97 . given @xmath68 , we write @xmath99 for the graph obtained from @xmath3 by deleting all vertices in  @xmath70 .    a _ path system _ is a graph @xmath100 which is the union of vertex - disjoint paths ( some of them might be trivial ) .",
    "we say that @xmath101 is a _ path in q _ if @xmath101 is a component of @xmath100 and , abusing the notation , sometimes write @xmath102 for this .",
    "if @xmath3 is a digraph , we write @xmath88 for an edge directed from @xmath103 to @xmath104 .",
    "a digraph @xmath3 is an _ oriented graph _ if there are no @xmath105 such that @xmath106 . unless stated otherwise , when we refer to paths and cycles in digraphs , we mean directed paths and cycles , i.e.  the edges on these paths / cycles are oriented consistently . if @xmath103 is a vertex of a digraph @xmath3 , then @xmath107 denotes the _ outneighbourhood _ of @xmath103 , i.e.  the set of all those vertices @xmath104 for which @xmath108 .",
    "similarly , @xmath109 denotes the _ inneighbourhood _ of @xmath103 , i.e.  the set of all those vertices @xmath104 for which @xmath110 .",
    "the _ outdegree _ of @xmath103 is @xmath111 and the _ indegree _ of @xmath103 is @xmath112 .",
    "we write @xmath65 and @xmath66 for the minimum and maximum degrees of the underlying simple undirected graph of @xmath3 respectively .    for a digraph @xmath3 , whenever @xmath71 with @xmath79 , we denote by @xmath80 $ ] the bipartite subdigraph of @xmath3 with vertex classes @xmath70 and @xmath74 whose edges are all the edges of @xmath3 directed from @xmath70 to  @xmath74 , and let @xmath113 denote the number of edges in @xmath80 $ ] .",
    "we define @xmath114)$ ] to be the minimum degree of the underlying undirected graph of @xmath80 $ ] and define @xmath115)$ ] to be the maximum degree of the underlying undirected graph of @xmath80 $ ] .",
    "a spanning subdigraph @xmath82 of @xmath3 is an _",
    "@xmath83-factor _ of @xmath3 if the outdegree and the indegree of every vertex of @xmath82 is  @xmath83 .",
    "if @xmath101 is a path and @xmath116 , we write @xmath117 for the subpath of @xmath101 whose endvertices are @xmath103 and @xmath104 .",
    "we define @xmath117 similarly if @xmath101 is a directed path and @xmath103 precedes @xmath104 on  @xmath101 .    in order to simplify the presentation , we omit floors and ceilings and treat large numbers as integers whenever this does not affect the argument .",
    "the constants in the hierarchies used to state our results have to be chosen from right to left .",
    "more precisely , if we claim that a result holds whenever @xmath118 ( where @xmath0 is the order of the graph or digraph ) , then this means that there are non - decreasing functions @xmath119\\to ( 0,1]$ ] , @xmath120\\to ( 0,1]$ ] and @xmath121\\to ( 0,1]$ ] such that the result holds for all @xmath122 and all @xmath123 with @xmath124 , @xmath125 and @xmath126 .",
    "we will not calculate these functions explicitly .",
    "hierarchies with more constants are defined in a similar way .",
    "we will write @xmath127 as shorthand for @xmath128 .",
    "if @xmath129 is an undirected bipartite graph with vertex classes @xmath70 and @xmath74 , then the _ density _ of @xmath3 is defined as @xmath130 for any @xmath131 , we say that @xmath3 is _ @xmath47-regular _ if for any @xmath132 and @xmath133 with @xmath134 and @xmath135 we have @xmath136 .",
    "we say that @xmath3 is _ @xmath137-regular _ if it is @xmath47-regular and has density @xmath138 for some @xmath139 .",
    "we say that @xmath3 is _ @xmath140$]-superregular _ if it is @xmath47-regular and @xmath141 for every @xmath142 and @xmath143 for every @xmath144 .",
    "@xmath3 is _",
    "@xmath145$]-superregular _ if it is _",
    "@xmath146$]-superregular _ for some @xmath147 .",
    "given disjoint vertex sets @xmath148 and @xmath149 in a digraph @xmath3 , recall that @xmath150 $ ] denotes the bipartite subdigraph of @xmath3 whose vertex classes are @xmath148 and @xmath149 and whose edges are all the edges of @xmath3 directed from @xmath148 to @xmath149 .",
    "we often view @xmath150 $ ] as an undirected bipartite graph .",
    "in particular , we say @xmath150 $ ] is _",
    "@xmath47-regular _ , _ @xmath151-regular _ , @xmath140$]-superregular or @xmath152$]-superregular if this holds when @xmath150 $ ] is viewed as an undirected graph .",
    "we often use the following simple proposition which follows easily from the definition of ( super-)regularity .",
    "we omit the proof , a similar argument can be found e.g.  in  @xcite .",
    "[ superslice ] suppose that @xmath153 .",
    "let @xmath3 be a bipartite graph with vertex classes @xmath70 and @xmath74 of size @xmath154 .",
    "suppose that @xmath155 is obtained from @xmath3 by removing at most @xmath156 vertices from each vertex class and at most @xmath156 edges incident to each vertex from @xmath3 .",
    "if @xmath3 is @xmath140$]-superregular then @xmath155 is @xmath157$]-superregular .",
    "we will also use the following simple fact .",
    "[ simplefact ] let @xmath131 .",
    "suppose that @xmath3 is a bipartite graph with vertex classes of size @xmath0 such that @xmath158 .",
    "then @xmath3 is @xmath159$]-superregular .",
    "we will often use the following chernoff - hoeffding bound for binomial and hypergeometric distributions ( see e.g.  ) . recall that the binomial random variable with parameters @xmath160 is the sum of @xmath0 independent bernoulli variables , each taking value @xmath12 with probability @xmath161 or @xmath162 with probability @xmath163 .",
    "the hypergeometric random variable @xmath148 with parameters @xmath164 is defined as follows .",
    "we let @xmath165 be a set of size @xmath0 , fix @xmath166 of size @xmath167 , pick a uniformly random @xmath168 of size @xmath169 , then define @xmath170 .",
    "note that @xmath171 .",
    "[ chernoff ] suppose @xmath148 has binomial or hypergeometric distribution and @xmath172",
    ". then @xmath173 .",
    "note that , unlike in theorem  [ 1factbip ] , in theorem  [ nwmindegbip ] we do not require a complete decomposition of our graph @xmath58 into edge - disjoint hamilton cycles . therefore , the proof of theorem  [ 1factbip ] is considerably more involved than the proof of theorem  [ nwmindegbip ] .",
    "moreover , the ideas in the proof of theorem  [ nwmindegbip ] are all used in the proof of theorem  [ 1factbip ] too .",
    "let @xmath58 be a graph on @xmath0 vertices with @xmath174 which is close to the balanced bipartite graph @xmath175 .",
    "further , suppose that @xmath3 is a @xmath2-regular spanning subgraph of @xmath58 as in theorem  [ nwmindegbip ] .",
    "then there is a partition @xmath70 , @xmath74 of @xmath176 such that @xmath70 and @xmath74 are of roughly equal size and most edges in @xmath58 go between @xmath70 and @xmath74 .",
    "our ultimate aim is to construct @xmath61 edge - disjoint hamilton cycles in @xmath58 .",
    "suppose first that , in the graph @xmath58 , both @xmath70 and @xmath74 are independent sets of equal size .",
    "so @xmath58 is an almost complete balanced bipartite graph . in this case ,",
    "the densest spanning even - regular subgraph @xmath3 of @xmath58 is also almost complete bipartite .",
    "this means that one can extend existing techniques ( developed e.g. in @xcite ) to find an approximate hamilton decomposition .",
    "this is achieved in @xcite and is more than enough to prove theorem  [ nwmindegbip ] in this case .",
    "( we state the main result from @xcite as lemma  [ almostthm ] in the current paper . )",
    "the real difficulties arise when    * @xmath58 is unbalanced ; * @xmath58 has vertices having high degree in both @xmath70 and @xmath74 ( these are called exceptional vertices ) .    to illustrate ( i ) , consider the following example due to babai ( which is the extremal construction for corollary  [ nwmindegcor ] ) .",
    "consider the graph @xmath58 on @xmath177 vertices consisting of one vertex class @xmath70 of size @xmath178 containing a perfect matching and no other edges , one empty vertex class @xmath74 of size @xmath179 , and all possible edges between @xmath70 and @xmath74 .",
    "thus the minimum degree of @xmath58 is @xmath180 .",
    "then one can use tutte s factor theorem to show that the largest even - regular spanning subgraph @xmath3 of @xmath58 has degree @xmath181 . note that to prove theorem  [ nwmindegbip ] in this case , each of the @xmath182 hamilton cycles we find must contain exactly two of the @xmath183 edges in @xmath70 . in this way , we can ` balance out ' the difference in the vertex class sizes .",
    "more generally we will construct our hamilton cycles in two steps . in the first step",
    ", we find a path system @xmath184 which balances out the vertex class sizes ( so in the above example , @xmath184 would contain two edges in @xmath70 )",
    ". then we extend @xmath184 into a hamilton cycle using only @xmath75-edges in @xmath58 .",
    "it turns out that the first step is the difficult one .",
    "it is easy to see that a path system @xmath184 will balance out the sizes of @xmath70 and @xmath74 ( in the sense that the number of uncovered vertices in @xmath70 and @xmath74 is the same ) if and only if @xmath185 note that any hamilton cycle also satisfies this identity .",
    "so we need to find a set of @xmath61 path systems @xmath184 satisfying ( where @xmath2 is the degree of @xmath3 ) .",
    "this is achieved ( amongst other things ) in sections  [ sec : slice ] and  [ sec : global ] .    as indicated above",
    ", our aim is to use lemma  [ almostthm ] in order to extend each such @xmath184 into a hamilton cycle . to apply lemma  [ almostthm ] we also need to extend the balancing path systems @xmath184 into ` balanced exceptional ( path ) systems ' which contain all the exceptional vertices from ( ii )",
    "this is achieved in section  [ besconstruct ] .",
    "lemma  [ almostthm ] also assumes that the path systems are ` localized ' with respect to a given subpartition of @xmath186 ( i.e.  they are induced by a small number of partition classes ) .",
    "section  [ partition ] prepares the ground for this .",
    "finding the balanced exceptional systems is extremely difficult if @xmath3 contains edges between the set @xmath187 of exceptional vertices in @xmath70 and the set @xmath188 of exceptional vertices in @xmath74 .",
    "so in a preliminary step , we find and remove a small number of edge - disjoint hamilton cycles covering all @xmath189-edges in section  [ eliminating ] .",
    "we put all these steps together in section  [ sec : proof1 ] .",
    "( sections  [ sec : spec ] , [ sec : robust ] and  [ sec : proof2 ] are only relevant for the proof of theorem  [ 1factbip ] . )",
    "the main result of this paper is theorem  [ 1factbip ] .",
    "suppose that @xmath3 is a @xmath2-regular graph satisfying the conditions of that theorem .",
    "using the approach of the previous subsection , one can obtain an approximate decomposition of @xmath3 , i.e.  a set of edge - disjoint hamilton cycles covering almost all edges of  @xmath3 .",
    "however , one does not have any control over the ` leftover ' graph  @xmath82 , which makes a complete decomposition seem infeasible .",
    "this problem was overcome in  @xcite by introducing the concept of a ` robustly decomposable graph '  @xmath190 .",
    "roughly speaking , this is a sparse regular graph with the following property : given _ any _ very sparse regular graph  @xmath82 with @xmath191 which is edge - disjoint from @xmath190 , one can guarantee that @xmath192 has a hamilton decomposition .",
    "this leads to the following strategy to obtain a decomposition of @xmath3 :    * find a ( sparse ) robustly decomposable graph  @xmath190 in @xmath3 and let @xmath155 denote the leftover ; * find an approximate hamilton decomposition of @xmath155 and let @xmath82 denote the ( very sparse ) leftover ; * find a hamilton decomposition of  @xmath192 .",
    "it is of course far from obvious that such a graph @xmath190 exists . by assumption",
    "our graph @xmath3 can be partitioned into two classes @xmath70 and @xmath74 of almost equal size such that almost all the edges in @xmath3 go between @xmath70 and @xmath74 .",
    "if both @xmath70 and @xmath74 are independent sets of equal size then the ` robust decomposition lemma ' of  @xcite guarantees our desired subgraph @xmath190 of @xmath3 .",
    "of course , in general our graph @xmath3 will contain edges in @xmath70 and @xmath74 .",
    "our aim is therefore to replace such edges with ` fictive edges ' between @xmath70 and @xmath74 , so that we can apply the robust decomposition lemma ( which is introduced in section  [ sec : robust ] ) .",
    "more precisely , similarly as in the proof of theorem  [ nwmindegbip ] , we construct a collection of localized balanced exceptional systems . together",
    "these path systems contain all the edges in @xmath78 $ ] and @xmath193 $ ] .",
    "again , each balanced exceptional system balances out the sizes of @xmath70 and @xmath74 and covers the exceptional vertices in @xmath3 ( i.e.  those vertices having high degree into both @xmath70 and @xmath74 ) .    by replacing edges of the balanced exceptional systems with fictive edges , we obtain from @xmath3 an auxiliary ( multi)graph @xmath194 which only contains edges between @xmath70 and @xmath74 and which does not contain the exceptional vertices of @xmath3",
    "this will allow us to apply the robust decomposition lemma .",
    "in particular this ensures that each hamilton cycle obtained in @xmath194 contains a collection of fictive edges corresponding to a single balanced exceptional system ( the set - up of the robust decomposition lemma does allow for this ) .",
    "each such hamilton cycle in @xmath194 then corresponds to a hamilton cycle in @xmath3 .",
    "we now give an example of how we introduce fictive edges .",
    "let @xmath154 be an integer so that @xmath195 is even . set @xmath196 and @xmath197 .",
    "define the graph @xmath3 as follows : let @xmath70 and @xmath74 be disjoint vertex sets of size @xmath154 .",
    "let @xmath198 be a partition of @xmath70 and @xmath199 be a partition of @xmath74 such that @xmath200 .",
    "add all edges between @xmath70 and @xmath74 .",
    "add a matching @xmath201 covering precisely the vertices of @xmath202 and add a matching @xmath203 covering precisely the vertices of @xmath204 . finally add a vertex @xmath67 which sends an edge to every vertex in @xmath205 .",
    "so @xmath3 is @xmath206-regular ( and @xmath67 would be regarded as a exceptional vertex ) .",
    "now pair up each edge @xmath207 with the edge @xmath208 .",
    "write @xmath209 and @xmath210 for each @xmath211 .",
    "let @xmath212 and @xmath213 and write @xmath214 for all @xmath215 . obtain @xmath194 from @xmath3 by deleting @xmath67 together with the edges in @xmath216 and by adding the following fictive edges : add @xmath217 for each @xmath218 and add @xmath219 for each @xmath220 .",
    "then @xmath194 is a balanced bipartite @xmath206-regular multigraph containing only edges between @xmath70 and @xmath74 .",
    "first , note that any hamilton cycle @xmath221 in @xmath194 that contains precisely one fictive edge @xmath217 for some @xmath222 corresponds to a hamilton cycle @xmath223 in @xmath3 , where we replace the fictive edge @xmath217 with @xmath224 and @xmath225 .",
    "next , consider any hamilton cycle @xmath221 in @xmath194 that contains precisely three fictive edges ; @xmath217 for some @xmath222 together with @xmath226 and @xmath227 for some @xmath228 .",
    "further suppose @xmath221 traverses the vertices @xmath229 in this order .",
    "then @xmath221 corresponds to a hamilton cycle @xmath223 in @xmath3 , where we replace the fictive edges with @xmath230 and @xmath231 ( see figure  [ fig : bridges ] ) . here the path system @xmath184 formed by the edges @xmath232 and @xmath231 is an example of a balanced exceptional system .",
    "the above ideas are formalized in section  [ sec : spec ] .     into finding a hamilton cycle in the balanced bipartite graph @xmath194 ]    we can now summarize the steps leading to proof of theorem  [ 1factbip ] . in section  [ eliminating ] , we find and remove a set of edge - disjoint hamilton cycles covering all edges in @xmath234 $ ] .",
    "we can then find the localized balanced exceptional systems in section  [ findbes ] .",
    "after this , we need to extend and combine them into certain path systems and factors ( which contain fictive edges ) in section  [ sec : spec ] , before we can use them as an ` input ' for the robust decomposition lemma in  section  [ sec : robust ] . finally , all these steps are combined in section  [ sec : proof2 ] to prove theorem  [ 1factbip ] .",
    "suppose that @xmath3 is a @xmath2-regular graph as in theorem  [ 1factbip ] .",
    "the purpose of this section is to prove corollary  [ covera0b02c ] . roughly speaking , given @xmath235 ,",
    "this corollary states that one can delete a small number of edge - disjoint hamilton cycles from @xmath3 to obtain a spanning subgraph @xmath155 of @xmath3 and a partition @xmath236 of @xmath49 such that ( amongst others ) the following properties hold :    * almost all edges of @xmath155 join @xmath237 to @xmath238 ; * @xmath239 is divisible by @xmath240 ; * every vertex in @xmath70 has almost all its neighbours in @xmath238 and every vertex in @xmath74 has almost all its neighbours in @xmath237 ; * @xmath241 is small and there are no edges between @xmath187 and @xmath188 in @xmath155 .",
    "we will call @xmath242 a framework .",
    "( the formal definition of a framework is stated before lemma  [ covera0b02 ] . )",
    "both @xmath70 and @xmath74 will then be split into @xmath240 clusters of equal size .",
    "our assumption that @xmath3 is @xmath56-bipartite easily implies that there is such a partition @xmath236 which satisfies all these properties apart from the property that there are no edges between @xmath187 and @xmath188 .",
    "so the main part of this section shows that we can cover the collection of all edges between @xmath187 and @xmath188 by a small number of edge - disjoint hamilton cycles .    since corollary  [ covera0b02c ] will also be used in the proof of theorem  [ nwmindegbip ] , instead of working with regular graphs we need to consider so - called balanced graphs .",
    "we also need to find the above hamilton cycles in the graph @xmath243 rather than in @xmath3 itself ( in the proof of theorem  [ 1factbip ] we will take @xmath58 to be equal to  @xmath3 ) .",
    "more precisely , suppose that @xmath3 is a graph and that @xmath244 , @xmath245 is a partition of @xmath49 , where @xmath246 , @xmath247 and @xmath236 are disjoint .",
    "then we say that @xmath3 is _ @xmath2-balanced ( with respect to @xmath248 ) _ if    * @xmath249 ; * all vertices in @xmath250 have degree exactly @xmath2",
    ".    proposition  [ edge_number ] below implies that whenever @xmath236 is a partition of the vertex set of a @xmath2-regular graph @xmath82 , then @xmath82 is @xmath2-balanced with respect to @xmath248 .",
    "moreover , note that if @xmath3 is @xmath251-balanced with respect to @xmath248 and @xmath82 is a spanning subgraph of @xmath3 which is @xmath252-balanced with respect to @xmath248 , then @xmath98 is @xmath253-balanced with respect to @xmath248 .",
    "furthermore , a graph @xmath3 is @xmath2-balanced with respect to @xmath248 if and only if @xmath3 is @xmath2-balanced with respect to @xmath254 .",
    "[ edge_number ] let @xmath82 be a graph and let @xmath244 , @xmath245 be a partition of @xmath255 .",
    "suppose that @xmath187 , @xmath70 is a partition of @xmath244 and that @xmath188 , @xmath74 is a partition of @xmath245 such that @xmath239 .",
    "suppose that @xmath256 for every @xmath257 and @xmath258 for every @xmath259 .",
    "then @xmath260    note that @xmath261 moreover , @xmath262 and @xmath263 therefore @xmath264 as desired .",
    "the following observation states that balancedness is preserved under suitable modifications of the partition .    [ keepbalance ] let @xmath82 be @xmath2-balanced with respect to @xmath248 .",
    "suppose that @xmath265 is a partition of @xmath250 .",
    "then @xmath82 is @xmath2-balanced with respect to @xmath266 .",
    "observe that the general result follows if we can show that @xmath82 is @xmath2-balanced with respect to @xmath266 , where @xmath267 , @xmath268 and @xmath269 .",
    "( b2 ) is trivially satisfied in this case , so we only need to check ( b1 ) for the new partition . for this , let @xmath270 and @xmath271 .",
    "now note that ( b1 ) for the original partition implies that @xmath272 thus ( b1 ) holds for the new partition .",
    "suppose that @xmath3 is a graph and @xmath273 is a partition of @xmath49 .",
    "for every vertex @xmath274 we call @xmath275 the _ internal degree of  @xmath67 _ in  @xmath3 .",
    "similarly , for every vertex @xmath276 we call @xmath277 the _ internal degree of  @xmath67 _ in  @xmath3 .",
    "given a graph @xmath58 and a spanning subgraph @xmath3 of @xmath58 , we say that @xmath278 is an _",
    "@xmath279-weak framework _ if the following holds , where @xmath280 , @xmath281 and @xmath282 :    * @xmath236 forms a partition of @xmath283 ; * @xmath3 is @xmath2-balanced with respect to @xmath248 ; * @xmath284 ; * @xmath239 is divisible by @xmath240 .",
    "moreover , @xmath285 , where @xmath286 and @xmath287 ; * all vertices in @xmath288 have internal degree at most @xmath289 in @xmath58 ; * any vertex @xmath67 has internal degree at most @xmath290 in @xmath3 .    throughout the paper , when referring to internal degrees without mentioning the partition , we always mean with respect to the partition @xmath244 , @xmath245 , where @xmath246 and @xmath247 .",
    "moreover , @xmath291 and @xmath292 will always denote @xmath293 and @xmath294 .",
    "we say that @xmath278 is an _ @xmath279-pre - framework _ if it satisfies ( wf1)(wf5 ) .",
    "the following observation states that pre - frameworks are preserved if we remove suitable balanced subgraphs .    [ wfpreserve ]",
    "let @xmath295 and @xmath296 .",
    "let @xmath278 be an @xmath297-pre framework .",
    "suppose that @xmath82 is a @xmath252-regular spanning subgraph of @xmath58 such that @xmath95 is @xmath252-balanced with respect to @xmath248 .",
    "let @xmath298 and @xmath299 .",
    "then @xmath300 is an @xmath301-pre framework .",
    "note that all required properties except possibly ( wf2 ) are not affected by removing edges . but @xmath155 satisfies ( wf2 ) since @xmath95 is @xmath252-balanced with respect to @xmath248 .",
    "[ bip_decomp ] let @xmath302 and let @xmath303 .",
    "suppose that @xmath58 is a graph on @xmath0 vertices which is @xmath47-bipartite and that @xmath3 is a @xmath2-regular spanning subgraph of @xmath58 .",
    "then there is a partition @xmath236 of @xmath283 so that @xmath278 is an @xmath304-weak framework .",
    "let @xmath305 be a partition of @xmath176 which is guaranteed by the assumption that @xmath58 is @xmath47-bipartite .",
    "let @xmath45 be the set of all those vertices @xmath306 with @xmath307 together with all those vertices @xmath308 with @xmath309 .",
    "since @xmath58 is @xmath47-bipartite , it follows that @xmath310 .",
    "given a partition @xmath311 of @xmath176 , we say that @xmath312 is _ bad for @xmath311 _ if @xmath313 and similarly that @xmath314 is _ bad for @xmath311 _ if @xmath315 .",
    "suppose that there is a vertex @xmath316 which is bad for @xmath317 , @xmath318",
    ". then we move @xmath67 into the class which does not currently contain @xmath67 to obtain a new partition @xmath319 , @xmath320 .",
    "we do not change the set @xmath45 . if there is a vertex @xmath321 which is bad for @xmath319 , @xmath320 , then again we move it into the other class .",
    "we repeat this process . after each step , the number of edges in @xmath3 between the two classes increases , so this process has to terminate with some partition @xmath244 , @xmath245 such that @xmath322 and @xmath323 .",
    "clearly , no vertex in @xmath45 is now bad for @xmath244 , @xmath245 .",
    "also , for any @xmath324 we have @xmath325 similarly , @xmath326 for all @xmath327 .",
    "altogether this implies that no vertex is bad for @xmath244 , @xmath245 and thus ( wf6 ) holds . also note that @xmath328 .",
    "so @xmath329 this implies  ( wf3 ) .    without loss of generality",
    "we may assume that @xmath330 .",
    "let @xmath331 denote the set of all those vertices @xmath274 for which @xmath332 .",
    "define @xmath333 similarly .",
    "we will choose sets @xmath334 and @xmath335 and sets @xmath336 and @xmath337 such that @xmath239 is divisible by @xmath240 and so that @xmath338 and @xmath339 are partitions of @xmath244 and @xmath245 respectively .",
    "we obtain such sets by moving at most @xmath340 vertices from @xmath341 to @xmath331 and at most @xmath340 vertices from @xmath342 to @xmath343 .",
    "the choice of @xmath236 is such that ( wf1 ) and ( wf5 ) hold .",
    "further , since @xmath239 , proposition  [ edge_number ] implies  ( wf2 ) .    in order to verify ( wf4 ) , it remains to show that @xmath344 .",
    "but ( [ eq : dva ] ) together with its analogue for the vertices in @xmath345 implies that @xmath346 .",
    "thus @xmath347 .",
    "moreover , ( wf2 ) , ( [ abedge ] ) and our assumption that @xmath303 together imply that @xmath348 so altogether , we have @xmath349 thus ( wf4 ) holds .    throughout this and the next section , we will often use the following result , which is a simple consequence of vizing s theorem and was first observed by mcdiarmid and independently by de werra ( see e.g.  @xcite ) .",
    "[ basic_matching_dec ] let @xmath82 be a graph with maximum degree at most @xmath350 then @xmath351 can be decomposed into @xmath15 edge - disjoint matchings @xmath352 such that @xmath353 for all @xmath354 .",
    "our next goal is to cover the edges of @xmath355 $ ] by edge - disjoint hamilton cycles . to do this",
    ", we will first decompose @xmath355 $ ] into a collection of matchings .",
    "we will then extend each such matching into a system of vertex - disjoint paths such that altogether these paths cover every vertex in @xmath355 $ ] , each path has its endvertices in @xmath356 and the path system is @xmath357-balanced .",
    "since our path system will only contain a small number of nontrivial paths , we can then extend the path system into a hamilton cycle ( see lemma  [ extendpaths ] ) .",
    "we will call the path systems we are working with @xmath189-path systems .",
    "more precisely , an _ @xmath189-path system ( with respect to @xmath248 ) _ is a path system @xmath100 satisfying the following properties :    * every vertex in @xmath241 is an internal vertex of a path in @xmath100 .",
    "* @xmath356 contains the endpoints of each path in @xmath100 but no internal vertex of a path in @xmath100 .    the following observation ( which motivates the use of the word ` balanced ' )",
    "will often be helpful .",
    "[ balpathcheck ] let @xmath358 be a partition of a vertex set @xmath84 .",
    "then an @xmath189-path system @xmath100 with @xmath359 is @xmath357-balanced with respect to @xmath248 if and only if the number of vertices in @xmath70 which are endpoints of nontrivial paths in @xmath100 equals the number of vertices in @xmath74 which are endpoints of nontrivial paths in  @xmath100 .",
    "note that by definition any @xmath189-path system satisfies ( b2 ) , so we only need to consider ( b1 ) .",
    "let @xmath360 be the number of vertices in @xmath70 which are endpoints of nontrivial paths in @xmath100 and define @xmath361 similarly .",
    "let @xmath286 , @xmath287 , @xmath362 and @xmath363 .",
    "since @xmath364 for all @xmath365 and since every vertex in @xmath70 is either an endpoint of a nontrivial path in @xmath100 or has degree zero in  @xmath100 , we have @xmath366 so @xmath367 , and similarly @xmath368 . therefore , @xmath369 if and only if @xmath370 if and only if @xmath100 satisfies  ( b1 ) , as desired .",
    "the next observation shows that if we have a suitable path system satisfying ( b1 ) , we can extend it into a path system which also satisfies ( b2 ) .",
    "[ balpathextend ] let @xmath371 .",
    "let @xmath3 be a graph on @xmath0 vertices such that there is a partition @xmath273 of @xmath49 which satisfies the following properties :    * @xmath246 , @xmath247 and @xmath358 are disjoint ; * @xmath239 and @xmath372 , where @xmath286 and @xmath287 ; * if @xmath365 then @xmath373 and if @xmath269 then @xmath374 .",
    "let @xmath375 be a path system consisting of at most @xmath376 nontrivial paths such that @xmath288 contains no internal vertex of a path in @xmath377 and @xmath378 .",
    "then @xmath3 contains a @xmath357-balanced @xmath189-path system @xmath100 ( with respect to @xmath248 ) which extends  @xmath377 and consists of at most @xmath379 nontrivial paths .",
    "furthermore , @xmath380 consists of @xmath381- and @xmath382-edges only .",
    "since @xmath288 contains no internal vertex of a path in @xmath377 and since @xmath377 contains at most @xmath376 nontrivial paths , it follows that at most @xmath379 vertices in @xmath288 lie on nontrivial paths in @xmath377 .",
    "we will now extend @xmath377 into an @xmath189-path system @xmath100 consisting of at most @xmath383 nontrivial paths as follows :    * for every vertex @xmath365 , we join @xmath67 to @xmath384 vertices in @xmath74 ; * for every vertex @xmath269 , we join @xmath67 to @xmath384 vertices in @xmath70 .    condition  ( iii ) and the fact that at most @xmath385 vertices in @xmath356 lie on nontrivial paths in @xmath377 together ensure that we can extend @xmath377 in such a way that the endvertices in @xmath356 are distinct for different paths in @xmath100 .",
    "note that @xmath386",
    ". therefore , @xmath100 is @xmath357-balanced with respect to @xmath248 .",
    "the next lemma constructs a small number of @xmath357-balanced @xmath189-path systems covering the edges of @xmath387 $ ] .",
    "each of these path systems will later be extended into a hamilton cycle .",
    "[ covera0b01 ] let @xmath388 .",
    "let @xmath58 be a graph on @xmath0 vertices and let @xmath3 be a spanning subgraph of @xmath58 .",
    "suppose that @xmath278 is an @xmath279-weak framework with @xmath389 and @xmath390 .",
    "then for some @xmath391 the graph @xmath3 contains @xmath392 edge - disjoint @xmath357-balanced @xmath189-path systems @xmath393 which satisfy the following properties :    * together @xmath394 cover all edges in @xmath387 $ ] ; * for each @xmath395 , @xmath396 contains at most @xmath397 nontrivial paths ; * for each @xmath395 , @xmath396 does not contain any edge from @xmath80 $ ] .",
    "( wf4 ) implies that @xmath398 .",
    "thus , by proposition  [ basic_matching_dec ] , there exists a collection @xmath399 of @xmath392 edge - disjoint matchings in @xmath234 $ ] that together cover all the edges in @xmath234 $ ] , where @xmath400 .",
    "we may assume that @xmath401 ( the case when @xmath402 follows analogously ) .",
    "we will use edges in @xmath403 $ ] to extend each @xmath404 into a @xmath357-balanced @xmath189-path system .",
    "( wf2 ) implies that @xmath405 . since @xmath406 for",
    "all @xmath407 by ( wf2 ) , ( wf5 ) and ( wf6 ) imply that @xmath408 ) \\leq d/2 $ ] .",
    "thus proposition  [ basic_matching_dec ] implies that @xmath409)$ ] can be decomposed into @xmath410 edge - disjoint matchings @xmath411 such that @xmath412 for all @xmath413 .",
    "notice that at least @xmath414 of the matchings @xmath415",
    "are such that @xmath416 .",
    "indeed , otherwise we have that @xmath417 a contradiction .",
    "( the last inequality follows since @xmath418 . ) in particular , this implies that @xmath403 $ ] contains @xmath392 edge - disjoint matchings @xmath419 that each consist of precisely @xmath420 edges .    for each @xmath395 , set @xmath421 .",
    "so for each @xmath422 , @xmath423 is a path system consisting of at most @xmath424 nontrivial paths such that @xmath288 contains no internal vertex of a path in @xmath423 and @xmath425 .",
    "suppose for some @xmath426 we have already found a collection @xmath427 of @xmath83 edge - disjoint @xmath357-balanced @xmath189-path systems which satisfy the following properties for each @xmath428 :    * @xmath396 contains at most @xmath429 nontrivial paths ; * @xmath430 ; * @xmath396 and @xmath431 are edge - disjoint for each @xmath432 such that @xmath433 ; * @xmath396 contains no edge from @xmath80 $ ] .",
    "( note that ( @xmath434)@xmath435(@xmath9)@xmath435 are vacuously true . )",
    "let @xmath155 denote the spanning subgraph of @xmath3 obtained from @xmath3 by deleting the edges lying in @xmath436 .",
    "( wf2 ) , ( wf4 ) and ( wf6 ) imply that , if @xmath365 , @xmath437 and if @xmath269 then @xmath438 .",
    "thus lemma  [ balpathextend ] implies that @xmath155 contains a @xmath357-balanced @xmath189-path system @xmath439 that satisfies ( @xmath434)@xmath440(@xmath9)@xmath440 .",
    "so we can proceed in this way in order to obtain edge - disjoint @xmath357-balanced @xmath189-path systems @xmath393 in @xmath3 such that ( @xmath434)@xmath441(@xmath9)@xmath441 hold for each @xmath395 .",
    "note that ( i)(iii ) follow immediately from these conditions , as desired .",
    "the next lemma ( corollary  5.4 in  @xcite ) allows us to extend a @xmath357-balanced path system into a hamilton cycle .",
    "corollary  5.4 concerns so - called ` @xmath442-balanced'-path systems rather than @xmath357-balanced @xmath189-path systems .",
    "but the latter satisfies the requirements of the former by proposition  [ balpathcheck ] .    [ 3conlem ]",
    "let @xmath443 let @xmath58 be a graph and suppose that @xmath358 is a partition of @xmath176 such that @xmath444 .",
    "let @xmath82 be a bipartite subgraph of @xmath58 with vertex classes @xmath70 and @xmath74 such that @xmath445 . suppose that @xmath100 is a @xmath357-balanced @xmath189-path system with respect to @xmath248 in @xmath58 which consists of at most @xmath289 nontrivial paths .",
    "then @xmath58 contains a hamilton cycle @xmath223 which satisfies the following properties :    * @xmath446 ; * @xmath447 consists of edges from @xmath82 .",
    "now we can apply lemma  [ 3conlem ] to extend a @xmath357-balanced @xmath189-path system in a pre - framework into a hamilton cycle .",
    "[ extendpaths ] let @xmath448 .",
    "let @xmath58 be a graph on @xmath0 vertices and let @xmath3 be a spanning subgraph of @xmath58 .",
    "suppose that @xmath278 is an @xmath279-pre - framework , i.e.  it satisfies ( wf1)(wf5 ) .",
    "suppose also that @xmath449 .",
    "let @xmath100 be a @xmath357-balanced @xmath189-path system with respect to @xmath248 in @xmath3 which consists of at most @xmath289 nontrivial paths .",
    "then @xmath58 contains a hamilton cycle @xmath223 which satisfies the following properties :    * @xmath450 ; * @xmath451 consists of @xmath75-edges ; * @xmath452 is @xmath357-balanced with respect to @xmath248 .",
    "note that ( wf4 ) , ( wf5 ) and our assumption that @xmath453 together imply that every vertex @xmath454 satisfies @xmath455 similarly , @xmath456 for all @xmath457 .",
    "thus , @xmath458 ) \\geq ( 1/2+\\alpha /2)|a|$ ] .",
    "applying lemma  [ 3conlem ] with @xmath459 $ ] playing the role of @xmath82 , we obtain a hamilton cycle @xmath223 in @xmath58 that satisfies ( i ) and ( ii ) . to verify ( iii ) , note that ( ii ) and the 2-balancedness of @xmath100 together imply that @xmath460 since every vertex @xmath257 satisfies @xmath461 , ( iii ) holds .",
    "we now combine lemmas  [ covera0b01 ] and  [ extendpaths ] to find a collection of edge - disjoint hamilton cycles covering all the edges in @xmath387 $ ] .",
    "[ covera0b0 ] let @xmath388 and let @xmath462 .",
    "let @xmath58 be a graph on @xmath0 vertices and let @xmath3 be a spanning subgraph of @xmath58 .",
    "suppose that @xmath278 is an @xmath279-weak framework with @xmath389 .",
    "then for some @xmath391 the graph @xmath58 contains edge - disjoint hamilton cycles @xmath463 which satisfy the following properties :    * together @xmath463 cover all edges in @xmath387 $ ] ; * @xmath464 is @xmath465-balanced with respect to @xmath248 .",
    "apply lemma  [ covera0b01 ] to obtain a collection of @xmath400 edge - disjoint @xmath357-balanced @xmath189-path systems @xmath393 in @xmath3 which satisfy lemma  [ covera0b01](i)(iii ) .",
    "we will extend each @xmath396 to a hamilton cycle @xmath466 .",
    "suppose that for some @xmath467 we have found a collection @xmath468 of @xmath83 edge - disjoint hamilton cycles in @xmath58 such that the following holds for each @xmath469 :    * @xmath470 ; * @xmath471 consists of @xmath75-edges ; * @xmath472 is @xmath357-balanced with respect to @xmath248 .",
    "( note that ( @xmath434)@xmath435(@xmath473)@xmath435 are vacuously true . )",
    "let @xmath474 ( where @xmath475 ) .",
    "so @xmath476 is @xmath477-regular .",
    "further , since @xmath478 is @xmath357-balanced for each @xmath428 , @xmath479 is @xmath477-balanced .",
    "let @xmath480 and @xmath481 . since @xmath278 is an @xmath279-pre - framework , proposition  [ wfpreserve ] implies that @xmath482 is an @xmath483-pre - framework .",
    "moreover , @xmath484 .",
    "lemma  [ covera0b01](iii ) and ( @xmath485)@xmath486(@xmath485)@xmath487 together imply that @xmath439 lies in @xmath488 .",
    "therefore , lemma  [ extendpaths ] implies that @xmath489 contains a hamilton cycle @xmath490 which satisfies ( @xmath434)@xmath440(@xmath473)@xmath440 .",
    "so we can proceed in this way in order to obtain @xmath392 edge - disjoint hamilton cycles @xmath491 in @xmath58 such that for each @xmath492 , ( @xmath434)@xmath441(@xmath473)@xmath441 hold .",
    "note that this implies that ( ii ) is satisfied .",
    "further , the choice of @xmath493 ensures that ( i ) holds .    given a graph @xmath3",
    ", we say that @xmath494 is an _",
    "@xmath279-framework _ if the following holds , where @xmath280 , @xmath281 and @xmath495 :    * @xmath236 forms a partition of @xmath49 ; * @xmath3 is @xmath2-balanced with respect to @xmath248 ; * @xmath496 ; * @xmath239 is divisible by @xmath240 .",
    "moreover , @xmath497 and @xmath285 , where @xmath286 and @xmath287 ; * all vertices in @xmath288 have internal degree at most @xmath498 in @xmath3 ; * @xmath499)=0 $ ] ; * all vertices @xmath500 have internal degree at most @xmath501 in @xmath3 .",
    "note that the main differences to a weak framework are ( fr6 ) and the fact that a weak framework involves an additional graph @xmath58 .",
    "in particular ( fr1)(fr4 ) imply ( wf1)(wf4 ) .",
    "suppose that @xmath502 , @xmath503 and that @xmath504 divides @xmath240 . then note that every @xmath279-framework is also an @xmath505-framework .",
    "[ covera0b02 ] let @xmath506 and let @xmath507 .",
    "let @xmath58 be a graph on @xmath0 vertices and let @xmath3 be a spanning subgraph of @xmath58 .",
    "suppose that @xmath278 is an @xmath279-weak framework .",
    "suppose also that @xmath508 and @xmath509 .",
    "then the following properties hold :    * there is an @xmath510-framework @xmath242 such that @xmath155 is a spanning subgraph of @xmath3 with @xmath511 ; * there is a set of @xmath512 edge - disjoint hamilton cycles in @xmath513 containing all edges of @xmath514 .",
    "in particular , if @xmath2 is even then @xmath515 is even .",
    "lemma  [ covera0b0 ] implies that there exists some @xmath516 such that @xmath58 contains a spanning subgraph @xmath82 satisfying the following properties :    * @xmath82 is @xmath465-regular ; * @xmath82 contains all the edges in @xmath234 $ ] ; * @xmath517 is @xmath465-balanced with respect to @xmath518 ; * @xmath82 has a decomposition into @xmath392 edge - disjoint hamilton cycles .",
    "set @xmath299 .",
    "then @xmath242 is an @xmath510-framework where @xmath519 . indeed , since @xmath278 is an @xmath520-weak framework , ( fr1 ) and ( fr3)(fr5 ) follow from ( wf1 ) and ( wf3)(wf5 ) . further , ( fr2 ) follows from ( wf2 ) and ( c ) while ( fr6 ) follows from ( b ) .",
    "( wf6 ) implies that all vertices @xmath521 have internal degree at most @xmath522 in @xmath3 .",
    "thus all vertices @xmath523 have internal degree at most @xmath524 in @xmath155 .",
    "so ( fr7 ) is satisfied .",
    "hence , ( i ) is satisfied .",
    "note that by definition of @xmath155 , @xmath82 contains all edges of @xmath514 .",
    "so since @xmath525 ,",
    "( d ) implies ( ii ) .",
    "the following result follows immediately from lemmas  [ bip_decomp ] and  [ covera0b02 ] .",
    "[ covera0b02c ] let @xmath526 and let @xmath507 .",
    "suppose that @xmath58 is an @xmath47-bipartite graph on @xmath0 vertices with @xmath508 .",
    "suppose that @xmath3 is a @xmath2-regular spanning subgraph of @xmath58 .",
    "then the following properties hold :    * there is an @xmath527-framework @xmath242 such that @xmath155 is a spanning subgraph of @xmath3 , @xmath528 and such that @xmath58 satisfies ( wf5 ) ( with respect to the partition @xmath236 ) ; * there is a set of @xmath529 edge - disjoint hamilton cycles in @xmath513 containing all edges of @xmath514 . in particular ,",
    "if @xmath2 is even then @xmath515 is even .",
    "the purpose of this section is to prove corollary  [ bescor ] which , given a framework @xmath494 , guarantees a set @xmath530 of edge - disjoint hamilton cycles and a set @xmath531 of suitable edge - disjoint @xmath357-balanced @xmath189-path systems such that the graph @xmath194 obtained from @xmath3 by deleting the edges in all these hamilton cycles and path systems is bipartite with vertex classes @xmath244 and @xmath245 and @xmath241 is isolated in @xmath194 . each of the path systems in @xmath531 will later be extended into a hamilton cycle by adding suitable edges between @xmath70 and  @xmath74 . the path systems in @xmath531 will need to be ` localized ' with respect to a given partition .",
    "we prepare the ground for this in the next subsection .    throughout this section ,",
    "given sets @xmath532 we often write @xmath533 , @xmath534 , @xmath535 and @xmath536 for @xmath537 , @xmath538 , @xmath539 and @xmath540 respectively .",
    "let @xmath541 and @xmath542 .",
    "a _ @xmath543-partition _ of a set @xmath84 of vertices is a partition of @xmath84 into sets @xmath544 and @xmath545 such that @xmath546 for all @xmath547 and @xmath548 .",
    "we often write @xmath549 for @xmath241 and think of the vertices in @xmath549 as ` exceptional vertices ' .",
    "the sets @xmath550 and @xmath551 are called _ clusters _ of the @xmath552-partition and @xmath187 , @xmath188 are called _",
    "exceptional sets_. unless stated otherwise , when considering a @xmath543-partition @xmath553 we denote the elements of @xmath553 by @xmath544 and @xmath545 as above .",
    "further , we will often write @xmath70 for @xmath554 and @xmath74 for @xmath555",
    ".    suppose that @xmath494 is an @xmath279-framework with @xmath556 and that @xmath557 .",
    "we say that @xmath558 is a _",
    "@xmath559-partition for @xmath3 _ if @xmath558 satisfies the following properties :    * @xmath558 is a @xmath543-partition of @xmath49 such that the exceptional sets @xmath187 and @xmath188 in the partition @xmath558 are the same as the sets @xmath187 , @xmath188 which are part of the framework @xmath494 . in particular , @xmath560 ; * @xmath561 for all @xmath562 and @xmath500 ; * @xmath563 for all @xmath564 ; * @xmath565 for all @xmath562 ; * @xmath566 for all @xmath562 ; * @xmath567 for all @xmath568 ;    and the analogous assertions hold if we replace @xmath70 by @xmath74 ( as well as @xmath569 by @xmath570 etc . ) in ( p2)(p5 ) .",
    "our first aim is to show that for every framework we can find such a partition with suitable parameters ( see lemma  [ part ] ) . to do this",
    ", we need the following lemma .",
    "[ lma : partition2 ] suppose that @xmath571 , that @xmath572 , that @xmath573 and that @xmath574 .",
    "let @xmath3 and @xmath58 be graphs on @xmath0 vertices with @xmath283 .",
    "suppose that there is a vertex partition of @xmath49 into @xmath575 with the following properties :    * @xmath576 .",
    "* @xmath577 ) \\ge \\eps",
    "n$ ] or @xmath578 ) \\le",
    "* for each @xmath579 we either have @xmath580 for all @xmath581 or @xmath582 for all @xmath583 .",
    "then there exists a partition of @xmath584 into @xmath240 parts @xmath585 satisfying the following properties :    * @xmath586 for all @xmath587 . *",
    "@xmath588 for all @xmath521 and all @xmath589 . * @xmath590 for all @xmath591 .",
    "* @xmath592 for all @xmath593 .",
    "* @xmath594 for all @xmath587 and @xmath579 . * @xmath595 for all @xmath596 and all @xmath589 .",
    "consider an equipartition @xmath597 of @xmath584 which is chosen uniformly at random .",
    "so ( i ) holds by definition .",
    "note that for a given vertex @xmath521 , @xmath598 has the hypergeometric distribution with mean @xmath599 .",
    "so if @xmath600 , proposition  [ chernoff ] implies that @xmath601 thus we deduce that for all @xmath521 and all @xmath587 , @xmath602 similarly , @xmath603 so with probability at least 3/4 , both ( ii ) and ( vi ) are satisfied .",
    "we now consider ( iii ) and ( iv ) .",
    "fix @xmath604 . if @xmath605 , let @xmath606 .",
    "if @xmath607 , let @xmath608 . for an edge @xmath609)$",
    "] , let @xmath610 denote the event that @xmath611 .",
    "so if @xmath612 and @xmath605 , then @xmath613 similarly , if @xmath614 and @xmath615 are disjoint ( that is , @xmath614 and @xmath615 have no common endpoint ) and @xmath605 , then @xmath616 by ( [ prf ] ) , if @xmath617 , we also have @xmath618 if @xmath612 and @xmath607 , then @xmath619 so if @xmath607 , similarly to ( [ ff ] ) we also obtain @xmath620 for disjoint @xmath614 and @xmath615 and we obtain the same bound as in ( [ exx ] ) on @xmath621 ( recall that @xmath622 in this case ) .",
    "note that if @xmath623 then @xmath624 )    \\stackrel{(\\ref{exx})}{\\le } \\frac{3e_g(u)}{k^2 }   \\cdot 2\\delta ( g[u ] )       \\le e_g(u )   \\delta ( g[u]).\\end{aligned}\\ ] ] similarly , if @xmath625 then @xmath626).\\end{aligned}\\ ] ] let @xmath627)$ ] . in both cases , from chebyshev s inequality , it follows that @xmath628 suppose that @xmath629 )",
    "\\le \\eps n$ ] . if we also have have @xmath630 , then @xmath631 . if @xmath632 , then @xmath633",
    ".    if we do not have @xmath629 )",
    "\\le \\eps n$ ] , then our assumptions imply that @xmath634 ) \\ge",
    "\\eps n$ ] .",
    "so @xmath578 ) \\le",
    "n \\le \\eps e_g(g[u])$ ] with room to spare .",
    "this in turn means that @xmath635 .",
    "so in all cases , we have @xmath636 now note that by ( [ exx ] ) we have @xmath637 so ( [ eqn : preu ] ) and  ( [ devex ] ) together imply that for fixed @xmath638 the bound in ( iii ) fails with probability at most @xmath639 .",
    "the analogue holds for the bound in  ( iv ) . by summing over all possible values of @xmath604",
    ", we have that  ( iii ) and  ( iv ) hold with probability at least @xmath640 .",
    "a similar argument shows that for all @xmath587 and @xmath579 , we have @xmath641 indeed , fix @xmath587 , @xmath579 and let @xmath642 . for an edge",
    "@xmath643 $ ] , let @xmath610 denote the event that @xmath644 .",
    "then @xmath645 and so @xmath646 .",
    "the remainder of the argument proceeds as in the previous case ( with slightly simpler calculations ) .",
    "so ( v ) holds with probability at least 3/4 , by summing over all possible values of @xmath587 and @xmath579 again .",
    "so with positive probability , the partition satisfies all requirements .",
    "[ part ] let @xmath647 .",
    "suppose that @xmath494 is an @xmath279-framework with @xmath556 and @xmath648 .",
    "suppose that @xmath58 is a graph with @xmath649 .",
    "then there exists a partition @xmath650 of @xmath49 so that    * @xmath558 is a @xmath559-partition for @xmath3 . *",
    "@xmath651 and @xmath652 for all @xmath562 and @xmath500 .    in order to find the required partitions @xmath550 of @xmath70 and @xmath551 of @xmath74 we will apply lemma  [ lma : partition2 ] twice , as follows . in the first application we let @xmath653 @xmath654 , @xmath655 and @xmath656 .",
    "note that @xmath578 ) \\le",
    "\\eps ' n $ ] by ( fr5 ) and @xmath657 for all @xmath581 and @xmath658 by ( fr4 ) . moreover , ( fr4 ) and ( fr7 ) together imply that @xmath659 for each @xmath660 .",
    "thus we can apply lemma  [ lma : partition2 ] with @xmath661 playing the role of @xmath47 to obtain a partition @xmath585 of @xmath584 .",
    "we let @xmath662 for all @xmath663 then the @xmath569 satisfy ( p2)(p5 ) and @xmath664 further , lemma  [ lma : partition2](vi ) implies that @xmath665 for all @xmath562 and @xmath500 .    for the second application of lemma  [ lma : partition2 ]",
    "we let @xmath666 @xmath667 , @xmath668 and @xmath669 for all @xmath670 . as before ,",
    "@xmath578 ) \\le   \\eps ' n $ ] by ( fr5 ) and @xmath671 for all @xmath581 and @xmath658 by ( fr4 ) . moreover , ( fr4 ) and ( fr7 ) together imply that @xmath659 for all @xmath670 and each @xmath672 .",
    "thus we can apply lemma  [ lma : partition2 ] with @xmath661 playing the role of @xmath47 to obtain a partition @xmath585 of @xmath584 .",
    "let @xmath673 for all @xmath674 then the @xmath570 satisfy ( p2)(p5 ) with @xmath70 replaced by  @xmath74 , @xmath569 replaced by @xmath570 , and so on . moreover ,",
    "for all @xmath675 , @xmath676 i.e.  ( p6 ) holds .",
    "since clearly ( p1 ) holds as well , @xmath544 and @xmath545 together form a @xmath559-partition for @xmath3 .",
    "further , lemma  [ lma : partition2](vi ) implies that @xmath677 for all @xmath562 and @xmath500 .",
    "the next lemma gives a decomposition of @xmath403 $ ] and @xmath678 $ ] into suitable smaller edge - disjoint subgraphs @xmath679 and @xmath680 .",
    "we say that the graphs @xmath679 and @xmath680 guaranteed by lemma  [ rnd_slice ] are _ localized slices _ of  @xmath3 .",
    "note that the order of the indices @xmath681 and @xmath682 matters here , i.e.  @xmath683 . also , we allow @xmath684 .",
    "[ rnd_slice ] let @xmath647 .",
    "suppose that @xmath494 is an @xmath279-framework with @xmath556 and @xmath303 .",
    "let @xmath544 and @xmath545 be a @xmath559-partition for @xmath3",
    ". then for all @xmath685 there are graphs @xmath679 and @xmath680 with the following properties :    1 .",
    "@xmath679 is a spanning subgraph of @xmath686\\cup g[a_i , a_j]\\cup g[a_0]$ ] ; 2 .",
    "the sets @xmath687 over all @xmath685 form a partition of the edges of @xmath403 $ ] ; 3 .",
    "@xmath688 for all @xmath568 ; 4 .",
    "@xmath689 for all @xmath568 ; 5 .",
    "@xmath690 for all @xmath568 ; 6 .   for all @xmath568 and",
    "all @xmath691 we have @xmath692 .",
    "the analogous assertions hold if we replace @xmath70 by @xmath74 , @xmath569 by @xmath570 , and so on .    in order to construct the graphs @xmath693 we perform the following procedure :    * initially each @xmath679 is an empty graph with vertex set @xmath694 .",
    "* for all @xmath562 choose a random partition @xmath695 into @xmath240 sets @xmath696 of equal size and let @xmath697 .",
    "( if @xmath695 is not divisible by @xmath240 , first distribute up to @xmath698 edges arbitrarily among the @xmath696 to achieve divisibility . ) * for all @xmath589 , we add all the edges in @xmath699 to @xmath700 .",
    "* for all @xmath701 with @xmath702 , half of the edges in @xmath703 are added to @xmath679 and the other half is added to @xmath704 ( the choice of the edges is arbitrary ) . *",
    "the edges in @xmath705 $ ] are distributed equally amongst the @xmath706 .",
    "( so @xmath707 . )",
    "clearly , the above procedure ensures that properties  ( i ) and ( ii ) hold .",
    "( p5 ) implies ( iv ) and ( p3 ) and ( p4 ) imply ( v ) .",
    "consider any @xmath365 . to prove ( vi ) , note that we may assume that @xmath708 .",
    "let @xmath709 .",
    "note that ( p2 ) implies that @xmath710 and note that @xmath711 .",
    "so the chernoff - hoeffding bound for the hypergeometric distribution in proposition  [ chernoff ] implies that @xmath712 since @xmath713 , a union bound implies the desired result .",
    "finally , observe that for any @xmath714 , we have @xmath715 so ( iii ) follows from",
    "( iv ) ,  ( v ) and the fact that @xmath707 .",
    "note that the construction implies that if @xmath702 , then @xmath693 will contain edges between @xmath187 and @xmath569 but not between @xmath187 and @xmath716 .",
    "however , this additional information is not needed in the subsequent argument .",
    "suppose that @xmath494 is an @xmath279-framework .",
    "recall that @xmath717 , @xmath718 and @xmath719 .",
    "since @xmath3 is @xmath2-balanced by  ( fr2 ) , we have @xmath720 so there are an integer @xmath721 and a constant @xmath722 such that @xmath723 the aim of this subsection is to prove lemma  [ matchingdec ] , which guarantees a decomposition of each localized slice @xmath679 into path systems ( which will be extended into @xmath189-path systems in section  [ besconstruct ] ) and a sparse ( but not too sparse ) leftover graph @xmath724 .",
    "the following two results will be used in the proof of lemma  [ matchingdec ] .",
    "[ simple ] let @xmath725 so that @xmath726 .",
    "suppose that @xmath3 is a graph on @xmath0 vertices such that @xmath727 and @xmath728 .",
    "then @xmath3 contains a spanning subgraph @xmath82 such that @xmath729 and @xmath730 .",
    "let @xmath731 be a spanning subgraph of @xmath3 such that    * @xmath732 ; * @xmath733 .",
    "to see that such a graph @xmath731 exists , consider a random subgraph of @xmath3 obtained by including each edge of @xmath3 with probability @xmath734 . then @xmath735 and @xmath736 . thus applying proposition  [ chernoff",
    "] we have that , with high probability , @xmath731 is as desired .",
    "define @xmath82 to be a spanning subgraph of @xmath3 such that @xmath737 and @xmath729 .",
    "then @xmath738 , as required .",
    "[ splittrick ] suppose that @xmath3 is a graph such that @xmath739 where @xmath740 is even .",
    "suppose @xmath741 is a partition of @xmath49 such that @xmath742 for all @xmath454 and @xmath743 ) \\leq d/2 - 1 $ ] .",
    "then @xmath3 has a decomposition into @xmath61 edge - disjoint path systems @xmath744 such that the following conditions hold :    * for each @xmath745 , any internal vertex on a path in @xmath746 lies in @xmath187 ; * @xmath747 for all @xmath748 .    let @xmath749 be a maximal spanning subgraph of @xmath3 under the constraints that @xmath705 \\subseteq g_1 $ ] and @xmath750 . note that @xmath705\\cup g[a ] \\subseteq g_1 $ ] . set @xmath751 .",
    "so @xmath752 only contains @xmath753-edges .",
    "further , since @xmath739 , the maximality of @xmath749 implies that @xmath754 .",
    "define an auxiliary graph @xmath155 , obtained from @xmath749 as follows : write @xmath755 .",
    "add a new vertex set @xmath756 to @xmath749 .",
    "for each @xmath757 and @xmath454 , we add an edge between @xmath758 and @xmath103 if and only if @xmath759 is an edge in @xmath752 .",
    "thus @xmath760 $ ] is isomorphic to @xmath749 and @xmath761 $ ] is isomorphic to @xmath752 . by construction and since @xmath762 for all @xmath454 , we have that @xmath763 . hence , proposition  [ basic_matching_dec ] implies that @xmath764 can be decomposed into @xmath61 edge - disjoint matchings @xmath765 such that @xmath766 for all @xmath748 .    by identifying each vertex @xmath767 with the corresponding vertex @xmath768 ,",
    "@xmath765 correspond to edge - disjoint subgraphs @xmath769 of @xmath3 such that    * @xmath769 together cover all the edges in @xmath3 ; * @xmath747 for all @xmath748 .",
    "note that @xmath770 for each @xmath771 .",
    "thus @xmath772 for each @xmath454 and @xmath773 for each @xmath774 .",
    "this implies that any cycle in @xmath746 must lie in @xmath705 $ ] .",
    "however , @xmath423 is a matching and @xmath775\\cup g'[a_0,a'_0]$ ] contains no edges .",
    "therefore , @xmath746 contains no cycle , and so @xmath746 is a path system such that any internal vertex on a path in @xmath746 lies in @xmath187 . hence @xmath744 satisfy ( i ) and ( ii ) .",
    "[ matchingdec ] let @xmath776 .",
    "suppose that @xmath494 is an @xmath279-framework with @xmath556 and @xmath303 .",
    "let @xmath544 and @xmath545 be a @xmath559-partition for @xmath3 .",
    "let @xmath679 be a localized slice of @xmath3 as guaranteed by lemma  [ rnd_slice ] .",
    "define @xmath777 and @xmath778 as in  ( [ aqc ] ) .",
    "suppose that @xmath779 .",
    "if @xmath780 , set @xmath781 to be the largest integer which is at most @xmath782 and is divisible by @xmath783 .",
    "otherwise , set @xmath784 .",
    "define @xmath785 and @xmath786 then @xmath679 has a decomposition into @xmath787 edge - disjoint path systems @xmath788 and a spanning subgraph @xmath724 with the following properties :    * for each @xmath789 , any internal vertex on a path in @xmath790 lies in @xmath187 ; * @xmath791 and @xmath792 ; * @xmath793 for every @xmath794 ; * @xmath795 .",
    "the analogous assertion ( with @xmath796 replaced by @xmath797 and @xmath187 replaced by @xmath188 ) holds for each localized slice  @xmath680 of  @xmath3 .",
    "furthermore , @xmath798 .",
    "note that  ( [ aqc ] ) and ( fr3 ) together imply that @xmath799 and so @xmath800 .",
    "thus  ( iii ) will follow from  ( ii ) .",
    "so it remains to prove  ( i ) , ( ii ) and  ( iv ) .",
    "we split the proof into three cases .    * case 1 .",
    "@xmath801 *    ( fr2 ) and ( fr4 ) imply that @xmath802 .",
    "so @xmath803 .",
    "thus @xmath804 .",
    "set @xmath805 and @xmath806 .",
    "therefore , ( iv ) is satisfied as @xmath807 .",
    "further , ( i ) and ( ii ) are vacuous ( i.e. we set each @xmath790 to be the empty graph on @xmath49 ) .    note that @xmath808 since otherwise @xmath809 and therefore ( fr2 ) implies that @xmath810 , a contradiction .",
    "hence , @xmath811 .",
    "* case 2 . * @xmath812 and @xmath813    since @xmath814 in this case , we set @xmath806 and each @xmath790 to be the empty graph on @xmath49 .",
    "then as in case  1 , ( i ) , ( ii ) and ( iv ) are satisfied with respect to @xmath815 .",
    "further , clearly @xmath798 .    note that @xmath809 since otherwise @xmath808 and thus @xmath816 by ( fr2 ) , a contradiction to the case assumptions .",
    "since @xmath817 by ( fr2 ) , lemma  [ rnd_slice](iii ) implies that @xmath818 similarly , lemma  [ rnd_slice](iii ) implies that @xmath819 therefore , ( [ gambound ] ) implies that there exists a constant @xmath820 such that @xmath821 since @xmath822 , ( [ gambound ] ) implies that @xmath823 .",
    "further , since @xmath824 , ( [ gamup ] ) implies that @xmath825 .    note that ( fr5 ) , ( fr7 ) and lemma  [ rnd_slice](vi ) imply that @xmath826 thus lemma  [ simple ] implies that @xmath706 contains a spanning subgraph @xmath82 such that @xmath827 and @xmath828 where the last inequality follows since @xmath829 and @xmath830 . setting @xmath831 implies that ( iv ) is satisfied .",
    "our next task is to decompose @xmath82 into @xmath787 edge - disjoint path systems so that ( i ) and ( ii ) are satisfied .",
    "note that ( [ boundup ] ) implies that @xmath832 further , ( fr4 ) implies that @xmath833 ) \\leq |a_0| \\leq \\eps",
    "n < t-1 $ ] and ( fr5 ) implies that @xmath834 for all @xmath454 . since @xmath835",
    ", lemma  [ splittrick ] implies that @xmath82 has a decomposition into @xmath787 edge - disjoint path systems @xmath788 satisfying ( i ) and so that @xmath836 for all @xmath837 .",
    "in particular , ( ii ) is satisfied .",
    "* case 3 . * @xmath838    by definition of @xmath839 and @xmath840 , we have that @xmath798 .",
    "notice that since @xmath812 and @xmath841 , certainly @xmath842 .",
    "therefore , lemma  [ rnd_slice](iii ) implies that @xmath843 note that @xmath844 .",
    "further , ( [ aqc ] ) and ( [ gambound2 ] ) imply that @xmath845 similarly , lemma  [ rnd_slice](iii ) implies that @xmath846 by ( [ gambound3 ] ) there exists a constant @xmath820 such that @xmath847 note that ( [ gambound3 ] ) implies that @xmath848 and ( [ gambound4 ] ) implies that @xmath825 .",
    "moreover , as in case  2 , ( fr5 ) , ( fr7 ) and lemma  [ rnd_slice](vi ) together show that @xmath849 thus ( as in case  2 again ) , lemma  [ simple ] implies that @xmath706 contains a spanning subgraph @xmath82 such that @xmath850 and @xmath851 setting @xmath831 implies that ( iv ) is satisfied .",
    "next we decompose @xmath82 into @xmath787 edge - disjoint path systems so that ( i ) and ( ii ) are satisfied .",
    "note that ( [ boundup1 ] ) implies that @xmath832 further , ( fr4 ) implies that @xmath833 ) \\leq",
    "|a_0| \\leq \\eps",
    "n < t-1 $ ] and ( fr5 ) implies that @xmath834 for all @xmath454 . since @xmath852",
    ", lemma  [ splittrick ] implies that @xmath82 has a decomposition into @xmath787 edge - disjoint path systems @xmath788 satisfying ( i ) and ( ii ) .",
    "an identical argument implies that ( i ) , ( ii ) and ( iv ) are satisfied with respect to @xmath815 also .",
    "let @xmath853 be the union of the graphs @xmath724 guaranteed by lemma  [ matchingdec ] over all @xmath854 .",
    "define @xmath855 similarly .",
    "the next lemma gives a decomposition of both @xmath853 and @xmath855 into suitable path systems .",
    "properties  ( iii ) and  ( iv ) of the lemma guarantee that one can pair up each such path system @xmath856 with a different path system @xmath857 such that @xmath858 is @xmath357-balanced ( in particular @xmath859 ) .",
    "this property will then enable us to apply lemma  [ extendpaths ] to extend @xmath860 into a hamilton cycle using only edges between @xmath244 and @xmath245 .",
    "[ g - glob ] let @xmath776 .",
    "suppose that @xmath494 is an @xmath279-framework with @xmath556 and such that @xmath303 and @xmath2 is even .",
    "let @xmath544 and @xmath545 be a @xmath559-partition for @xmath3 .",
    "let @xmath853 be the union of the graphs @xmath724 guaranteed by lemma  [ matchingdec ] over all @xmath854 .",
    "define @xmath855 similarly .",
    "suppose that @xmath861 .",
    "then the following properties hold :    * there is an integer @xmath862 and a real number @xmath863 so that @xmath864 and @xmath865 .",
    "* @xmath866 .",
    "* let @xmath867 .",
    "then @xmath853 has a decomposition into @xmath868 path systems , each containing @xmath869 edges , and @xmath870 path systems , each containing @xmath871 edges .",
    "moreover , each of these @xmath872 path systems  @xmath100 satisfies @xmath873 for all @xmath874 .",
    "* @xmath855 has a decomposition into @xmath868 path systems , each containing @xmath875 edges , and @xmath870 path systems , each containing @xmath876 edges .",
    "moreover , each of these @xmath872 path systems  @xmath100 satisfies @xmath873 for all @xmath877 . *",
    "each of the path systems guaranteed in  ( iii ) and  ( iv ) contains at most @xmath878 edges .",
    "note that in lemma  [ g - glob ] and several later statements the parameter @xmath879 is implicitly defined by the application of lemma  [ matchingdec ] which constructs the graphs @xmath853 and @xmath855 .",
    "let @xmath781 and @xmath787 be as defined in lemma  [ matchingdec ] .",
    "our first task is to show that ( i ) is satisfied .",
    "if @xmath880 then @xmath881 $ ] and @xmath882 $ ] .",
    "further , @xmath808 in this case since otherwise ( fr4 ) implies that @xmath809 and so ( fr2 ) yields that @xmath883 , a contradiction .",
    "therefore , ( fr2 ) implies that @xmath884    if @xmath885 and @xmath813 then @xmath882 $ ] .",
    "further , @xmath886 is obtained from @xmath403 $ ] by removing @xmath887 edge - disjoint path systems , each of which contains precisely @xmath420 edges .",
    "thus ( fr2 ) implies that @xmath888    finally , consider the case when @xmath889 .",
    "then @xmath886 is obtained from @xmath403 $ ] by removing @xmath890 edge - disjoint path systems , each of which contain exactly @xmath891 edges , and by removing @xmath892 edge - disjoint path systems , each of which contain exactly @xmath893 edges .",
    "similarly , @xmath894 is obtained from @xmath678 $ ] by removing @xmath890 edge - disjoint path systems , each of which contain exactly @xmath895 edges , and by removing @xmath892 edge - disjoint path systems , each of which contain exactly @xmath896 edges .",
    "so ( fr2 ) implies that @xmath897 therefore , in every case , @xmath898 define the integer @xmath862 and @xmath899 by @xmath864 .",
    "then  ( [ abk ] ) implies that @xmath865 .",
    "this proves ( i ) . to prove ( ii ) , note that lemma  [ matchingdec](iv ) implies that @xmath900 and similarly @xmath901 .",
    "note that ( fr5 ) implies that @xmath902 for all @xmath454 and @xmath903 ) \\leq",
    "|a_0| \\leq \\eps n < k-1 $ ] .",
    "thus lemma  [ splittrick ] together with ( i ) implies that ( iii ) is satisfied .",
    "( iv ) follows from lemma  [ splittrick ] analogously .",
    "( fr3 ) implies that @xmath904 and @xmath905",
    ". therefore , each path system from ( iii ) and ( iv ) contains at most @xmath906 edges .",
    "so ( v ) is satisfied .",
    "we say that a path system @xmath907 $ ] is _",
    "@xmath908-localized _ if    * @xmath909 ) \\cup e(g[a_i , a_j])\\cup e(g[a_0])$ ] ; * any internal vertex on a path in @xmath101 lies in @xmath187 .",
    "we introduce an analogous notion of _",
    "@xmath910-localized _ for path systems @xmath911 $ ] .",
    "the following result is a straightforward consequence of lemmas  [ rnd_slice ] , [ matchingdec ] and [ g - glob ] .",
    "it gives a decomposition of @xmath403 \\cup g[b']$ ] into pairs of paths systems so that most of these are localized and so that each pair can be extended into a hamilton cycle by adding @xmath912-edges .",
    "[ finalcor ] let @xmath776 .",
    "suppose that @xmath494 is an @xmath279-framework with @xmath556 and such that @xmath303 and @xmath2 is even .",
    "let @xmath544 and @xmath545 be a @xmath559-partition for @xmath3 .",
    "let @xmath913 and @xmath914 .",
    "suppose that @xmath915 .",
    "then there are @xmath916 sets @xmath917 , one for each @xmath918 , such that each @xmath917 consists of @xmath919 pairs of path systems and satisfies the following properties :    * let @xmath920 be a pair of path systems which forms an element of @xmath917 .",
    "then * * @xmath101 is an @xmath921-localized path system and @xmath922 is an @xmath923-localized path system ; * * @xmath924 ; * * @xmath925 . * the @xmath926 path systems in the pairs belonging to @xmath917 are all pairwise edge - disjoint .",
    "* let @xmath927 denote the spanning subgraph of @xmath3 whose edge set is the union of all the path systems in the pairs belonging to @xmath917 . then the @xmath916 graphs @xmath927 are edge - disjoint .",
    "further , each @xmath774 satisfies @xmath928 while each @xmath929 satisfies @xmath930 .",
    "* let @xmath931 be the subgraph of @xmath403 \\cup g[b']$ ] obtained by removing all edges contained in @xmath927 for all @xmath932",
    ". then @xmath933 .",
    "moreover , @xmath931 has a decomposition into @xmath872 pairs of path systems @xmath934 so that * * @xmath935 $ ] and @xmath936 $ ] for all @xmath937 ; * * @xmath938 for all @xmath874 and @xmath939 for all @xmath877 ; * * @xmath940 for all @xmath937 ; * * @xmath941 for all @xmath937 .",
    "apply lemma  [ rnd_slice ] to obtain localized slices @xmath693 and @xmath942 ( for all @xmath943 ) .",
    "let @xmath944 and let @xmath781 be as defined in lemma  [ matchingdec ] .",
    "since @xmath945 we have @xmath946 .",
    "for all @xmath947 , let @xmath948 be the set of @xmath787 path systems in @xmath949 guaranteed by lemma  [ matchingdec ] .",
    "we call the @xmath781 path systems in @xmath948 of size @xmath950 _ large _ and the others _",
    "small_. we define @xmath951 as well as large and small path systems in @xmath951 analogously ( for all @xmath952 ) .",
    "we now construct the sets @xmath917 as follows : for all @xmath953 , consider a random partition of the set of all large path systems in @xmath948 into @xmath783 sets of equal size @xmath954 and assign ( all the path systems in ) each of these sets to one of the @xmath917 with @xmath955 .",
    "similarly , randomly partition the set of small path systems in @xmath948 into @xmath783 sets , each containing @xmath956 path systems .",
    "assign each of these @xmath783 sets to one of the @xmath917 with @xmath955 .",
    "proceed similarly for each @xmath951 in order to assign each of its path systems randomly to some @xmath917 . then to each @xmath917 we have assigned exactly @xmath954 large path systems from both @xmath948 and @xmath951 .",
    "pair these off arbitrarily .",
    "similarly , pair off the small path systems assigned to @xmath917 arbitrarily . clearly , the sets @xmath917 obtained in this way satisfy ( a ) and ( b ) .",
    "we now verify ( c ) . by construction ,",
    "the @xmath916 graphs @xmath927 are edge - disjoint .",
    "so consider any vertex @xmath957 and write @xmath958 .",
    "note that @xmath959 by lemma  [ rnd_slice](vi ) .",
    "let @xmath960 be the spanning subgraph of @xmath3 whose edge set is the union of all the path systems in @xmath948",
    ". then lemma  [ matchingdec](iv ) implies that @xmath961 so a chernoff - hoeffding estimate for the hypergeometric distribution ( proposition  [ chernoff ] ) implies that @xmath962 ( note that we only need to apply the chernoff - hoeffding bound if @xmath963 say , as ( c ) is vacuous otherwise . )",
    "it remains to check condition  ( d ) .",
    "first note that @xmath964 since @xmath965 .",
    "thus we can apply lemma  [ g - glob ] to obtain a decomposition of both @xmath966 and @xmath967 into path systems . since @xmath968 , ( d ) is an immediate consequence of lemma  [ g - glob](ii)(v ) .",
    "the localized path systems obtained from corollary  [ finalcor ] do not yet cover all of the exceptional vertices .",
    "this is achieved via the following lemma : we extend the path systems to achieve this additional property , while maintaining the property of being balanced .",
    "more precisely , let @xmath969 be a @xmath543-partition of a set @xmath84 of @xmath0 vertices .",
    "given @xmath970 and @xmath971 , an _",
    "@xmath972-balanced exceptional system with respect to @xmath558 and parameter  @xmath973 _ is a path system @xmath184 with @xmath974 such that the following conditions hold :    *",
    "every vertex in @xmath241 is an internal vertex of a path in  @xmath184 .",
    "every vertex @xmath975 satisfies @xmath976 . *",
    "every edge of @xmath977 $ ] is either an @xmath978-edge or a @xmath979-edge . *",
    "the edges in @xmath184 cover precisely the same number of vertices in @xmath70 as in @xmath74 .",
    "* @xmath980 .    to shorten the notation",
    ", we will often refer to @xmath184 as an _",
    "@xmath981-bes_. if @xmath84 is the vertex set of a graph @xmath3 and @xmath982 , we also say that @xmath184 is an _ @xmath981-bes in  @xmath3_. note that ( bes2 ) implies that an @xmath981-bes does not contain edges between @xmath70 and @xmath74 .",
    "furthermore , an @xmath972-bes is also , for example , an @xmath983-bes .",
    "we will sometimes omit the indices @xmath984 and just refer to a balanced exceptional system ( or a bes for short ) .",
    "we will sometimes also omit the partition @xmath558 , if it is clear from the context .",
    "( bes1 ) implies that each balanced exceptional system is an @xmath189-path system as defined before proposition  [ balpathcheck ] .",
    "( however , the converse is not true since , for example , a 2-balanced @xmath189-path system need not satisfy  ( bes4 ) . )",
    "so ( bes3 ) and proposition  [ balpathcheck ] imply that each balanced exceptional system is also @xmath357-balanced .",
    "we now extend each set @xmath917 obtained from corollary  [ finalcor ] into a set @xmath985 of @xmath986-bes .",
    "[ balmatchextend ] let @xmath987 .",
    "suppose that @xmath494 is an @xmath279-framework with @xmath556 and such that @xmath303 and @xmath2 is even .",
    "let @xmath988 be a @xmath559-partition for @xmath3 .",
    "suppose that @xmath989 .",
    "let @xmath917 be the sets returned by corollary  [ finalcor ] .",
    "then for all @xmath970 there is a set @xmath985 which satisfies the following properties :    * @xmath985 consists of @xmath919 edge - disjoint @xmath986-bes in @xmath3 with respect to @xmath558 and with parameter @xmath973 . * for each of the @xmath919 pairs of path systems @xmath990 , there is a unique @xmath991 which contains all the edges in @xmath992 .",
    "moreover , all edges in @xmath993 lie in @xmath994\\cup g[b_0,a_{i_1}]$ ] .",
    "* whenever @xmath995 , @xmath996 and @xmath997 , then @xmath184 and @xmath998 are edge - disjoint .",
    "we let @xmath999 denote the union of the sets @xmath985 over all @xmath970 .",
    "we will construct the sets @xmath985 greedily by extending each pair of path systems @xmath990 in turn into an @xmath986-bes containing @xmath992 .",
    "for this , consider some arbitrary ordering of the @xmath916 @xmath1000-tuples @xmath986 .",
    "suppose that we have already constructed the sets @xmath1001 for all @xmath1002 preceding @xmath986 so that ( i)(iii ) are satisfied .",
    "so our aim now is to construct @xmath1003 .",
    "consider an enumeration @xmath1004 of the pairs of path systems in @xmath917 .",
    "suppose that for some @xmath1005 we have already constructed edge - disjoint @xmath986-bes @xmath1006 , so that for each @xmath1007 the following conditions hold :    * @xmath1008 contains the edges in @xmath1009 ; * all edges in @xmath1010 lie in @xmath994\\cup g[b_0,a_{i_1}]$ ] ; * @xmath1008 is edge - disjoint from all the balanced exceptional systems in @xmath1011 , where the union is over all @xmath1002 preceding @xmath986",
    ".    we will now construct @xmath1012 .",
    "for this , we need to add suitable edges to @xmath1013 to ensure that all vertices of @xmath250 have degree two . we start with @xmath187 .",
    "recall that @xmath717 and write @xmath1014 .",
    "let @xmath155 denote the subgraph of @xmath1015 $ ] obtained by removing all the edges lying in @xmath1006 as well as all those edges lying in the balanced exceptional systems belonging to @xmath1011 ( where as before the union is over all @xmath1002 preceding @xmath986 ) .",
    "we will choose the new edges incident to @xmath187 in @xmath184 inside @xmath1016 $ ] .",
    "suppose we have already found suitable edges for @xmath1017 and let @xmath1018 be the set of all these edges .",
    "we will first show that the degree of @xmath1019 inside @xmath1016 $ ] is still large .",
    "let @xmath1020 .",
    "consider any @xmath1002 preceding @xmath986 .",
    "let @xmath1021 denote the union of the @xmath919 balanced exceptional systems belonging to @xmath1001 .",
    "thus @xmath1022 .",
    "however , corollary  [ finalcor](c ) implies that @xmath1023 .",
    "so altogether , when constructing ( the balanced exceptional systems in ) @xmath1001 , we have added at most @xmath1024 new edges at @xmath1019 , and all these edges join @xmath1019 to vertices in @xmath1025 . similarly , when constructing @xmath1006 , we have added at most @xmath1024 new edges at @xmath1019 .",
    "since the number of @xmath1000-tuples @xmath1002 with @xmath1026 is @xmath1027 , it follows that @xmath1028 also , ( p2 ) with @xmath70 replaced by  @xmath74 implies that @xmath1029 where here we use ( fr2 ) and ( fr6 ) .",
    "so altogether , we have @xmath1030 let @xmath1031 be the set of vertices in @xmath1032 not covered by the edges of @xmath1033 . note that @xmath1034 since @xmath1035 by ( fr4 ) and @xmath1036 by corollary  [ finalcor](a)(iii ) .",
    "so @xmath1037 . we can add up to two of these edges to  @xmath184 in order to ensure that @xmath1019 has degree two in  @xmath184 .",
    "this completes the construction of the edges of @xmath184 incident to @xmath187 .",
    "the edges incident to @xmath188 are found similarly .",
    "let @xmath184 be the graph on @xmath1038 whose edge set is constructed in this way . by construction ,",
    "@xmath184 satisfies ( bes1 ) and ( bes2 ) since @xmath1039 and @xmath1040 are @xmath921-localized and @xmath923-localized respectively .",
    "we now verify ( bes3 ) . as mentioned before the statement of the lemma , ( bes1 ) implies that @xmath184 is an @xmath189-path system ( as defined before proposition  [ balpathcheck ] ) .",
    "moreover , corollary  [ finalcor](a)(ii ) implies that @xmath1041 is a path system which satisfies ( b1 ) in the definition of @xmath357-balanced .",
    "since @xmath184 was obtained by adding only @xmath912-edges , ( b1 ) is preserved in @xmath184 . since by construction @xmath184 satisfies ( b2 ) , it follows that @xmath184 is @xmath357-balanced .",
    "so proposition  [ balpathcheck ] implies ( bes3 ) .",
    "finally , we verify ( bes4 ) . for this ,",
    "note that corollary  [ finalcor](a)(iii ) implies that @xmath1042 .",
    "moreover , the number of edges added to @xmath1013 when constructing @xmath184 is at most @xmath1043 , which is at most @xmath429 by ( fr4 ) . thus @xmath1044 .",
    "we now find a set of edge - disjoint hamilton cycles covering the edges of the ` leftover ' graph obtained from @xmath1045 $ ] by deleting all those edges lying in balanced exceptional systems belonging to @xmath999 .",
    "[ lem : hcglob ] let @xmath987 .",
    "suppose that @xmath494 is an @xmath279-framework with @xmath556 and such that @xmath303 and @xmath2 is even .",
    "let @xmath988 be a @xmath559-partition for @xmath3 .",
    "suppose that @xmath989 .",
    "let @xmath999 be as defined after lemma  [ balmatchextend ] and let @xmath1046 be the union of all the balanced exceptional systems lying in @xmath999 .",
    "let @xmath1047 , let @xmath914 and let @xmath934 be as in corollary  [ finalcor](d ) .",
    "* the graph @xmath1048 $ ] can be decomposed into @xmath872 @xmath189-path systems @xmath1049 which are @xmath357-balanced and satisfy the following properties : * * @xmath396 contains all edges of @xmath1050 ; * * @xmath1049 are pairwise edge - disjoint ; * * @xmath1051 .",
    "* let @xmath1049 be as in  ( a ) .",
    "suppose that @xmath58 is a graph on @xmath49 such that @xmath1052 , @xmath1053 and such that @xmath58 satisfies ( wf5 ) with respect to @xmath661 .",
    "then there are edge - disjoint hamilton cycles @xmath1054 in @xmath1055 such that @xmath470 and @xmath1056 is @xmath357-balanced for each @xmath1057 .",
    "we first prove ( a ) .",
    "the argument is similar to that of lemma  [ g - glob ] . roughly speaking",
    ", we will extend each @xmath1058 into a path system @xmath1059 by adding suitable @xmath381-edges which ensure that every vertex in @xmath187 has degree exactly two in @xmath1059 .",
    "similarly , we will extend each @xmath1060 into @xmath1061 by adding suitable @xmath382-edges .",
    "we will ensure that no vertex is an endvertex of both an edge in @xmath1062 and an edge in @xmath1061 and take @xmath396 to be the union of these two path systems .",
    "we first construct all the @xmath1059 .",
    "* claim  1 . *    to prove claim  1 , let @xmath931 be as defined in corollary  [ finalcor](d ) . thus @xmath1063=q_{1,a}\\cup \\dots \\cup q_{k , a}$ ] . on the other hand",
    ", lemma  [ balmatchextend](ii ) implies that @xmath1064=g_{glob}[a']$ ] .",
    "hence , @xmath1065=g_{glob}[a']=q_{1,a}\\cup \\dots \\cup q_{k , a}.\\ ] ] similarly , @xmath1066=g_{glob}[b']=q_{1,b}\\cup",
    "\\dots \\cup q_{k , b}$ ] .",
    "moreover , @xmath1067\\cup g^*[b']$ ] . consider any vertex @xmath774 .",
    "let @xmath1068 denote the degree of @xmath103 in @xmath1069 .",
    "so @xmath1070 by  ( [ eq : g*a ] ) .",
    "let @xmath1071 then @xmath1072 where the final equality follows from ( fr2 ) . recall that @xmath999 consists of @xmath1073 edge - disjoint balanced exceptional systems . since @xmath103 has two neighbours in each of these balanced exceptional systems , the degree of @xmath103 in @xmath1074 is @xmath1075 .",
    "altogether this implies that @xmath1076 note that this is precisely the total number of edges at @xmath103 which we need to add to @xmath1077 in order to obtain @xmath1078 as in claim  1 .",
    "we can now construct the path systems @xmath1062 . for each @xmath774 , let @xmath1079 .",
    "so @xmath1080 for all @xmath1057 .",
    "recall that @xmath286 and consider an ordering @xmath1081 of the vertices in @xmath187 .",
    "let @xmath1082 $ ] .",
    "assume that for some @xmath1083 , we have already found a decomposition of @xmath1084 into edge - disjoint path systems @xmath1085 satisfying the following properties ( for all @xmath1057 ) :    * no vertex is an endvertex of both an edge in @xmath1086 and an edge in @xmath1060 ; * @xmath1087 has degree @xmath1088 in @xmath1086 for all @xmath1089 and all other vertices have degree at most one in @xmath1086 .",
    "we call this assertion @xmath1090",
    ". we will show that @xmath1091 holds ( i.e.  the above assertion also holds with @xmath682 replaced by @xmath1092 ) .",
    "this in turn implies claim  1 if we let @xmath1093 for all @xmath1057 .    to prove @xmath1091 , consider the following bipartite auxiliary graph @xmath1094 .",
    "the vertex classes of @xmath1094 are @xmath1095 and @xmath1096 , where @xmath1096 is a multiset whose elements are chosen from @xmath1097 .",
    "each @xmath1060 is included exactly @xmath1098 times in @xmath1096 .",
    "note that @xmath1099 since @xmath1100)=0 $ ] by ( fr6 ) .",
    "altogether this implies that @xmath1101 the final inequality follows from ( [ dbx ] ) since @xmath1102 ) \\le 3k/2\\ ] ] by corollary  [ finalcor](d ) .",
    "we include an edge in @xmath1094 between @xmath1103 and @xmath1104 if @xmath67 is not an endvertex of an edge in @xmath1105 .    * claim  2 . *",
    "_ @xmath1094 has a perfect matching @xmath1106 . _",
    "given the perfect matching guaranteed by the claim , we construct @xmath1107 from @xmath1086 as follows : the edges of @xmath1107 incident to @xmath1108 are precisely the edges @xmath1109 where @xmath1110 is an edge of @xmath1106 ( note that there are up to two of these ) . thus claim  2 implies that @xmath1091 holds .",
    "( indeed , ( i@xmath1111)(ii@xmath1111 ) are immediate from the definition of  @xmath1094 . )    to prove claim  2 , consider any vertex @xmath1103 .",
    "since @xmath1112 , the number of path systems @xmath1060 containing an edge at @xmath67 is at most @xmath1113 .",
    "the number of indices @xmath681 for which @xmath1086 contains an edge at @xmath67 is at most @xmath1114 .",
    "since each path system @xmath1060 occurs at most twice in the multiset @xmath1096 , it follows that the degree of @xmath67 in @xmath1094 is at least @xmath1115 .",
    "moreover , @xmath1116 ( say ) by ( fr5 ) . also",
    ", @xmath1117 by ( fr4 ) .",
    "so @xmath67 has degree at least @xmath1118 in @xmath1094 .",
    "now consider any path system @xmath1104 .",
    "recall that @xmath1119 ( say ) , where the first inequality follows from corollary  [ finalcor](d)(iv@xmath1111 ) .",
    "moreover , @xmath1120 , where the second inequality follows from ( fr4 ) .",
    "thus the degree of @xmath1060 in @xmath1094 is at least @xmath1121 altogether this implies that @xmath1094 has a perfect matching @xmath1106 , as required .",
    "this completes the construction of @xmath1078 .",
    "next we construct @xmath1122 using the same approach .",
    "* claim  3 . *",
    "the proof of claim  3 is similar to that of claim  1 .",
    "the only difference is that when constructing @xmath1061 , we need to avoid the endvertices of all the edges in @xmath1062 ( not just the edges in @xmath1058 ) .",
    "however , @xmath1123 , so this does not affect the calculations significantly .",
    "we now take @xmath1124 for all @xmath1057 .",
    "then the @xmath396 are pairwise edge - disjoint and @xmath1125 by corollary  [ finalcor](d)(iv@xmath1111 ) and ( fr4 ) .",
    "moreover , corollary  [ finalcor](d)(iii@xmath1111 ) implies that @xmath1126 thus each @xmath396 is a 2-balanced @xmath189-path system .",
    "further , @xmath1049 form a decomposition of @xmath1127\\cup g^*[a_0,b]\\cup g^*[b']\\cup g^*[b_0,a]=g^*-g^*[a , b].\\ ] ] ( the last equality follows since @xmath1100)=0 $ ] by ( fr6 ) . ) this completes the proof of  ( a ) .    to prove ( b ) , note that @xmath278 is an @xmath1128-pre - framework , i.e.  it satisfies ( wf1)(wf5 ) . indeed , recall that ( fr1)(fr4 ) imply ( wf1)(wf4 ) and that ( wf5 ) holds by assumption .",
    "so we can apply lemma  [ extendpaths ] ( with @xmath1129 playing the role of @xmath100 ) to extend @xmath1129 into a hamilton cycle @xmath1130 .",
    "moreover , lemma  [ extendpaths](iii ) implies that @xmath1131 is @xmath357-balanced , as required .",
    "( lemma  [ extendpaths](ii ) guarantees that @xmath1130 is edge - disjoint from @xmath1132 and @xmath1074 . )",
    "let @xmath1133 and @xmath1134 .",
    "proposition  [ wfpreserve ] ( with @xmath1130 playing the role of @xmath82 ) implies that @xmath1135 is an @xmath1136-pre - framework .",
    "so we can now apply lemma  [ extendpaths ] to @xmath1135 to extend @xmath1137 into a hamilton cycle @xmath1138 , where @xmath1139 is also @xmath357-balanced",
    ".    we can continue this way to find @xmath1140 . indeed , suppose that we have found @xmath1141 for @xmath1142 .",
    "then we can still apply lemma  [ extendpaths ] since @xmath1143 .",
    "moreover , @xmath1144 is @xmath357-balanced for all @xmath1145 , so @xmath1146 is @xmath1147-balanced .",
    "this in turn means that proposition  [ wfpreserve ] ( applied with @xmath1148 playing the role of @xmath82 ) implies that after removing @xmath1141 , we still have an @xmath1149-pre - framework and can find @xmath1150 .",
    "we can now put everything together to find a set of localized balanced exceptional systems and a set of hamilton cycles which altogether cover all edges of @xmath3 outside @xmath80 $ ] .",
    "the localized balanced exceptional systems will be extended to hamilton cycles later on .",
    "[ bescor ] let @xmath987 .",
    "suppose that @xmath494 is an @xmath279-framework with @xmath556 and such that @xmath303 and @xmath2 is even .",
    "let @xmath988 be a @xmath559-partition for @xmath3 .",
    "suppose that @xmath989 and let @xmath914 .",
    "suppose that @xmath58 is a graph on @xmath49 such that @xmath1052 , @xmath1053 and such that @xmath58 satisfies ( wf5 ) with respect to @xmath1151 .",
    "then there are @xmath872 edge - disjoint hamilton cycles @xmath1054 in @xmath58 and for all @xmath970 there is a set @xmath985 such that the following properties are satisfied :    * @xmath985 consists of @xmath919 @xmath986-bes in @xmath3 with respect to @xmath558 and with parameter @xmath973 which are edge - disjoint from each other and from @xmath1152 .",
    "* whenever @xmath995 , @xmath996 and @xmath997 , then @xmath184 and @xmath998 are edge - disjoint . * given any @xmath1153 and @xmath407 , the two edges incident to @xmath67 in @xmath466 lie in @xmath3 .",
    "* let @xmath1154 be the subgraph of @xmath3 obtained by deleting the edges of all the @xmath466 and all the balanced exceptional systems in @xmath985 ( for all @xmath970 ) .",
    "then @xmath1154 is bipartite with vertex classes @xmath244 , @xmath245 and @xmath1155 is an isolated set in @xmath1154 .",
    "this follows immediately from lemmas  [ balmatchextend ] and  [ lem : hcglob](b ) .",
    "indeed , clearly  ( i)(iii ) are satisfied . to check  ( iv ) , note that @xmath1154 is obtained from the graph @xmath194 defined in lemma  [ lem : hcglob ] by deleting all the edges of the hamilton cycles @xmath466 .",
    "but lemma  [ lem : hcglob ] implies that the @xmath466 together cover all the edges in @xmath1048 $ ] .",
    "thus this implies that @xmath1154 is bipartite with vertex classes @xmath244 , @xmath245 and @xmath549 is an isolated set in @xmath1154 .",
    "as discussed in the proof sketch , the proof of theorem  [ 1factbip ] proceeds as follows .",
    "first we find an approximate decomposition of the given graph @xmath3 and finally we find a decomposition of the ( sparse ) leftover from the approximate decomposition ( with the aid of a ` robustly decomposable ' graph we removed earlier ) .",
    "both the approximate decomposition as well as the actual decomposition steps assume that we work with a bipartite graph on @xmath288 ( with @xmath239 ) .",
    "so in both steps , we would need @xmath250 to be empty , which we clearly can not assume . on the other hand , in both steps",
    ", one can specify ` balanced exceptional path systems ' ( beps ) in @xmath3 with the following crucial property : one can replace each beps with a path system beps@xmath1156 so that    * beps@xmath1156 is bipartite with vertex classes @xmath70 and @xmath74 ; * a hamilton cycle @xmath221 in @xmath1157 + { \\rm beps}^*$ ] which contains beps@xmath1156 corresponds to a hamilton cycle @xmath223 in @xmath3 which contains beps ( see section  [ besstar ] ) .",
    "each beps will contain one of the balanced exceptional sequences bes constructed in section  [ findbes ] .",
    "beps@xmath1156 will then be obtained by replacing the edges in bes by suitable ` fictive ' edges ( i.e.  which are not necessarily contained in @xmath3 ) .",
    "so , roughly speaking , this allows us to work with @xmath194 rather than @xmath3 in the two steps",
    ". a convenient way of specifying and handling these balanced exceptional path systems is to combine them into ` balanced exceptional factors ' bf ( see section  [ sec : beps ] for the definition ) .",
    "one complication is that the ` robust decomposition lemma ' ( lemma  [ rdeclemma ] ) we use from  @xcite deals with digraphs rather than undirected graphs .",
    "so to be able to apply it , we need a suitable orientation of the edges of @xmath3 and so we will actually consider directed path systems beps@xmath1158 instead of beps@xmath1156 above ( whereas the path systems beps are undirected ) .",
    "the formulation of the robust decomposition lemma is quite general and rather than guaranteeing ( @xmath1159 ) directly , it assumes the existence of certain directed ` special paths systems ' sps which are combined into ` special factors ' sf .",
    "these are introduced in section  [ sec : sf ] .",
    "each of the hamilton cycles produced by the lemma then contains exactly one of these special path systems .",
    "so to apply the lemma , it suffices to check separately that each beps@xmath1158 satisfies the conditions required of a special path system and that it also satisfies ( @xmath1159 ) .",
    "suppose that @xmath184 is a balanced exceptional system in a graph  @xmath3 with respect to a @xmath552-partition @xmath1161 of @xmath49 .",
    "we will now use @xmath184 to define an auxiliary matching @xmath1160 .",
    "every edge of @xmath1160 will have one endvertex in @xmath70 and its other endvertex in @xmath74 .",
    "we will regard @xmath1160 as being edge - disjoint from the original graph  @xmath3 .",
    "so even if both @xmath1160 and @xmath3 have an edge between the same pair of endvertices , we will regard these as different edges .",
    "the edges of such a @xmath1160 will be called _",
    "fictive edges_. proposition  [ ces - h](ii ) below shows that a hamilton cycle in @xmath1162 + j^*$ ] containing all edges of @xmath1160 in a suitable order will correspond to a hamilton cycle in  @xmath3 which contains  @xmath184 .",
    "so when finding our hamilton cycles , this property will enable us to ignore all the vertices in @xmath1163 and to consider a bipartite ( multi-)graph between @xmath70 and @xmath74 instead .",
    "we construct @xmath1164 in two steps .",
    "first we will construct a matching @xmath1165 on @xmath288 and then @xmath1166 since each maximal path in @xmath184 has endpoints in @xmath288 and internal vertices in @xmath549 by ( bes1 ) , a balanced exceptional system @xmath184 naturally induces a matching @xmath1165 on @xmath288 .",
    "more precisely , if @xmath1167 are the non - trivial paths in  @xmath184 and @xmath1168 are the endpoints of @xmath746 , then we define @xmath1169 .",
    "thus @xmath1165 is a matching by  ( bes1 ) and @xmath1170 .",
    "moreover , @xmath1165 and @xmath1171 cover exactly the same vertices in @xmath70 .",
    "similarly , they cover exactly the same vertices in @xmath74 .",
    "so ( bes3 ) implies that @xmath1172)=e(j^*_{ab}[b])$ ] .",
    "we can write @xmath1173)=\\{x_1x_2 , \\dots , x_{2s-1}x_{2s}\\}$ ] , @xmath1174)=\\{y_1y_2 , \\dots , y_{2s-1}y_{2s}\\}$ ] and @xmath1175)=\\{x_{2s+1}y_{2s+1 } , \\dots , x_{s'}y_{s'}\\}$ ] , where @xmath1176 and @xmath1177 .",
    "define @xmath1178 .",
    "note that @xmath1179 .",
    "all edges of @xmath1160 are called _ fictive edges_.    as mentioned before , we regard @xmath1160 as being edge - disjoint from the original graph  @xmath3 .",
    "suppose that @xmath101 is an orientation of a subpath of ( the multigraph ) @xmath1162+j^*$ ] .",
    "we say that @xmath101 is _ consistent with @xmath1164 _ if @xmath101 contains all the edges of @xmath1164 and @xmath101 traverses the vertices @xmath1180 in this order .",
    "( this ordering will be crucial for the vertices @xmath1181 , but it is also convenient to have an ordering involving all vertices of  @xmath1160 . ) similarly , we say that a cycle @xmath2 in @xmath1162+j^*$ ] is _ consistent with @xmath1164 _ if @xmath2 contains all the edges of @xmath1164 and there exists some orientation of @xmath2 which traverses the vertices @xmath1180 in this order .",
    "the next result shows that if @xmath184 is a balanced exceptional system and @xmath223 is a hamilton cycle on @xmath288 which is consistent with @xmath1160 , then the graph obtained from @xmath223 by replacing @xmath1160 with @xmath184 is a hamilton cycle on @xmath49 which contains  @xmath184 , see figure  [ fig3 ] . when choosing our hamilton cycles , this property will enable us ignore all the vertices in @xmath549 and edges in @xmath70 and @xmath74 and to consider the ( almost complete ) bipartite graph with vertex classes @xmath70 and @xmath74 instead .    [ ces - h ]",
    "let @xmath1161 be a @xmath543-partition of a vertex set @xmath84 .",
    "let @xmath3 be a graph on @xmath84 and let @xmath184 be a balanced exceptional system with respect to  @xmath558 .",
    "* assume that @xmath101 is an orientation of a subpath of @xmath1162 + j^*$ ] such that @xmath101 is consistent with  @xmath1166 then the graph obtained from @xmath1182 by ignoring the orientations of the edges is a path on @xmath1183 whose endvertices are the same as those of  @xmath101 .",
    "* if @xmath982 and @xmath2 is a hamilton cycle of @xmath1162 + j^*$ ] which is consistent with  @xmath1184 then @xmath1185 is a hamilton cycle of @xmath3 .",
    "we first prove  ( i ) .",
    "let @xmath1186 ) = e(j^*_{ab}[b])$ ] and @xmath1187 ( where the @xmath1188 and @xmath1189 are as in the definition of @xmath1160 ) .",
    "so @xmath1190 , where @xmath1191 .",
    "let @xmath1192 denote the path obtained from @xmath1193 by reversing its direction .",
    "( so @xmath1194 traverses the vertices @xmath1195 in this order . ) first note @xmath1196 is a path on @xmath1197 .",
    "moreover , the underlying undirected graph of @xmath922 is precisely @xmath1198\\cup j^*_{ab}[b])=p - j^*+j^*_{ab}.\\ ] ] in particular , @xmath922 contains @xmath1165 .",
    "now recall that if @xmath1199 is an edge in @xmath1165 , then the vertices @xmath1200 and @xmath1201 are the endpoints of some path @xmath1202 in @xmath184 ( where the internal vertices on @xmath1202 lie in @xmath549 ) .",
    "clearly , @xmath1203 is also a path .",
    "repeating this step for every edge @xmath1199 of @xmath1165 gives a path @xmath1204 on @xmath1205 .",
    "moreover , @xmath1206 .",
    "this completes the proof of  ( i ) .",
    "\\(ii ) now follows immediately from  ( i ) .      as mentioned earlier , in order to apply lemma  [ rdeclemma ] , we first need to prove the existence of certain ` special path systems ' .",
    "these are defined below .",
    "suppose that @xmath1207 is a @xmath552-partition of a vertex set  @xmath84 and @xmath1208 .",
    "we say that @xmath1209 is a _ @xmath1210-partition of  @xmath84 _ if @xmath1211 is obtained from @xmath1212 by partitioning @xmath569 into @xmath1213 sets @xmath1214 of size  @xmath1215 for all @xmath1216 and partitioning @xmath570 into @xmath1213 sets @xmath1217 of size  @xmath1215 for all @xmath1216 .",
    "( so @xmath1218 consists of the exceptional sets @xmath187 , @xmath188 , the @xmath1219 clusters @xmath1220 and the @xmath1219 clusters @xmath1221 . )",
    "unless stated otherwise , whenever considering a @xmath1210-partition @xmath1209 of a vertex set @xmath84 we use the above notation to denote the elements of @xmath553 and @xmath1222 .",
    "let @xmath1209 be a @xmath1223-partition of  @xmath84 .",
    "consider a spanning cycle @xmath1224 on the clusters of @xmath1212 .",
    "given an integer @xmath614 dividing @xmath240 , the _ canonical interval partition _",
    "@xmath1225 of @xmath223 into @xmath614 intervals consists of the intervals @xmath1226 for all @xmath1227 .",
    "( here @xmath1228 . )",
    "suppose that @xmath3 is a digraph on  @xmath1229 and @xmath1230 .",
    "let @xmath1231 be an interval in  @xmath1225 .",
    "a _ special path system @xmath1232 of style  @xmath1233 in  @xmath3 spanning the interval @xmath1234 _ consists of precisely @xmath1215 ( non - trivial ) vertex - disjoint directed paths @xmath1235 such that the following conditions hold :    * every @xmath790 has its initial vertex in @xmath1236 and its final vertex in @xmath1237 .",
    "* @xmath1232 contains a matching @xmath1238 such that all the edges in @xmath1238 avoid the endclusters @xmath716 and @xmath1239 of @xmath1234 and such that @xmath1240 . *",
    "the vertex set of @xmath1232 is @xmath1241 .",
    "the edges in @xmath1238 are called _ fictive edges of _ @xmath1232 .",
    "let @xmath1242 be the canonical interval partition of @xmath223 into @xmath614 intervals .",
    "a _ special factor @xmath1243 with parameters @xmath1244 in @xmath3 ( with respect to @xmath223 , @xmath1222 ) _ is a @xmath12-regular digraph on @xmath1229 which is the union of @xmath1245 digraphs @xmath1246 ( one for all @xmath1247 and @xmath1230 ) such that each @xmath1246 is a special path system of style @xmath1233 in @xmath3 which spans  @xmath1248 .",
    "we write @xmath1249 for the union of the sets @xmath1250 over all @xmath1247 and @xmath1230 and call the edges in @xmath1249 _ fictive edges of @xmath1243_.    we will always view fictive edges as being distinct from each other and from the edges in other digraphs .",
    "so if we say that special factors @xmath1251 are pairwise edge - disjoint from each other and from some digraph @xmath100 on @xmath1229 , then this means that @xmath100 and all the @xmath1252 are pairwise edge - disjoint , but for example there could be an edge from @xmath103 to @xmath104 in @xmath100 as well as in @xmath1253 for several indices @xmath1254 .",
    "but these are the only instances of multiedges that we allow , i.e.  if there is more than one edge from @xmath103 to @xmath104 , then all but at most one of these edges are fictive edges .",
    "we now define balanced exceptional path systems beps .",
    "it will turn out that they ( or rather their bipartite directed versions beps@xmath1158 involving fictive edges ) will satisfy the conditions of the special path systems defined above .",
    "moreover , ( bipartite ) hamilton cycles containing beps@xmath1158 correspond to hamilton cycles in the ` original ' graph @xmath3 ( see proposition  [ prop : cepsbiparite ] ) .",
    "let @xmath1209 be a @xmath1223-partition of a vertex set @xmath84 .",
    "suppose that @xmath1255 and @xmath1230 .",
    "consider a spanning cycle @xmath1224 on the clusters of @xmath1212 .",
    "let @xmath1225 be the canonical interval partition of @xmath223 into  @xmath614 intervals of equal size .",
    "suppose that @xmath3 is an oriented bipartite graph with vertex classes @xmath70 and @xmath74 .",
    "suppose that @xmath1256 is an interval in  @xmath1225 .",
    "a _ balanced exceptional path system @xmath1257 of style  @xmath1233 for @xmath3 spanning @xmath1234 _ consists of precisely @xmath1215 ( non - trivial ) vertex - disjoint undirected paths @xmath1235 such that the following conditions hold :    1 .",
    "every @xmath790 has one endvertex in @xmath1236 and its other endvertex in @xmath1237 .",
    "2 .   @xmath1258 $ ] is a balanced exceptional system with respect to  @xmath558 such that @xmath1259 contains all edges of  @xmath184 and so that the edge set of @xmath184 is disjoint from @xmath1236 and @xmath1237 .",
    "let @xmath1260 be the path obtained by orienting @xmath1259 towards its endvertex in @xmath1237 and let @xmath1261 be the orientation of @xmath184 obtained in this way .",
    "moreover , let @xmath1262 be obtained from @xmath1160 by orienting every edge in @xmath1160 towards its endvertex in @xmath74 .",
    "then @xmath1263 is a directed path from @xmath1236 to @xmath1237 which is consistent with @xmath1160 .",
    "the vertex set of @xmath1257 is @xmath1264 .",
    "4 .   for each @xmath1265 , define @xmath1266 similarly as @xmath1260 .",
    "then @xmath1267 for every @xmath1268 .",
    "let @xmath1269 be the path system consisting of @xmath1270 .",
    "then @xmath1269 is a special path system of style @xmath1233 in @xmath3 which spans the interval  @xmath1234 and such that @xmath1271 .",
    "let @xmath1242 be the canonical interval partition of @xmath223 into @xmath614 intervals .",
    "a _ balanced exceptional factor @xmath1272 with parameters @xmath1244 for @xmath3 ( with respect to @xmath223 , @xmath1222 ) _ is the union of @xmath1245 undirected graphs @xmath1273 ( one for all @xmath1247 and @xmath1230 ) such that each @xmath1273 is a balanced exceptional path system of style @xmath1233 for @xmath3 which spans  @xmath1248 .",
    "we write @xmath1274 for the union of @xmath1275 over all @xmath1247 and @xmath1230 .",
    "note that @xmath1274 is a special factor with parameters @xmath1244 in @xmath3 ( with respect to @xmath223 , @xmath1222 ) such that @xmath1276 is the union of @xmath1277 over all @xmath1247 and @xmath1230 , where @xmath1278 $ ] is the balanced exceptional system contained in @xmath1273 ( see condition ( beps2 ) ) .",
    "in particular , @xmath1274 is a @xmath12-regular digraph on @xmath1229 while @xmath1272 is an undirected graph on @xmath84 with @xmath1279    given a balanced exceptional path system @xmath1257 , let @xmath184 be as in ( beps2 ) and let @xmath1280 .",
    "so @xmath1281 consists of @xmath1282 as well as @xmath1283 .",
    "the following is an immediate consequence of ( beps2 ) and proposition  [ ces - h ] .",
    "[ prop : cepsbiparite ] let @xmath1284 be a @xmath1285-partition of a vertex set @xmath84 .",
    "suppose that @xmath3 is a graph on  @xmath1229 , that @xmath1286 is an orientation of @xmath80 $ ] and that @xmath1257 is a balanced exceptional path system for  @xmath1286 .",
    "let @xmath184 be as in ( beps2 ) .",
    "let @xmath223 be a hamilton cycle of @xmath1287 which contains @xmath1281 .",
    "then @xmath1288 is a hamilton cycle of @xmath1289 .",
    "note that @xmath1290 .",
    "moreover , ( beps2 ) implies that @xmath223 contains all edges of @xmath1160 and is consistent with @xmath1160 .",
    "so the proposition follows from proposition  [ ces - h](ii ) applied with @xmath1289 playing the role of  @xmath3 .",
    "the following definition of a ` scheme ' captures the ` non - exceptional ' part of the graphs we are working with .",
    "for example , this will be the structure within which we find the edges needed to extend a balanced exceptional system into a balanced exceptional path system .",
    "given an oriented graph @xmath3 and partitions @xmath553 and @xmath1218 of a vertex set @xmath84 , we call @xmath1291 a _ @xmath1292$]-scheme _ if the following properties hold :    * @xmath1293 is a @xmath1294-partition of @xmath84 .",
    "moreover , @xmath1295 .",
    "* every edge of @xmath3 has one endvertex in @xmath70 and its other endvertex in  @xmath74 . *",
    "@xmath1296 $ ] and @xmath1297 $ ] are @xmath1298$]-superregular for all @xmath1299 and all @xmath1300 .",
    "further , @xmath1301 $ ] and @xmath1302 $ ] are @xmath1298$]-superregular for all @xmath1303 .",
    "* @xmath1304 for all distinct @xmath1305 , all @xmath589 and all @xmath1306 .",
    "similarly , @xmath1307 for all distinct @xmath1308 , all @xmath589 and all @xmath1306 .",
    "if @xmath1309 ( and so @xmath1310 ) , then ( sch@xmath1311 ) just says that @xmath1212 is a @xmath552-partition of @xmath49 .",
    "the next lemma allows us to extend a suitable balanced exceptional system into a balanced exceptional path system .",
    "given @xmath1230 , we say that an @xmath1312-bes @xmath184 has _",
    "style @xmath1233 ( with respect to the @xmath1294-partition @xmath1293 ) _ if all the edges of @xmath184 have their endvertices in @xmath1313 .",
    "[ lma : bipartite : ceps ] suppose that @xmath1314 , that @xmath1315 and @xmath1316 .",
    "let @xmath1317 be a @xmath1318$]-scheme with @xmath1319 .",
    "consider a spanning cycle @xmath1224 on the clusters of @xmath1212 and let @xmath1320 be an interval on  @xmath223 of length at least  @xmath1321 .",
    "let @xmath184 be an @xmath1312-bes of style @xmath1230 with parameter @xmath973 ( with respect to @xmath1284 ) , for some @xmath1322 .",
    "then there exists a balanced exceptional path system of style @xmath1233 for @xmath3 which spans the interval @xmath1234 and contains all edges in  @xmath184 .    for each @xmath1323 , let @xmath1324 denote the number of vertices in @xmath1325 which are incident to edges of  @xmath184 .",
    "we only consider the case when @xmath1326 , @xmath1327 , @xmath1328 and @xmath1329 are distinct and @xmath1330 for each @xmath1331 , as the other cases can be proved by similar arguments .",
    "clearly @xmath1332 by ( bes4 ) . for every vertex @xmath454",
    ", we define @xmath1333 to be the cluster @xmath1334 such that @xmath569 contains @xmath103 .",
    "similarly , for every @xmath1335 , we define @xmath1336 to be the cluster @xmath1337 such that @xmath570 contains  @xmath104 .",
    "let @xmath1338 be the edges of @xmath1160 , with @xmath1176 and @xmath1177 for all @xmath1339 .",
    "( recall that the ordering of these edges is fixed in the definition of @xmath1160 . )",
    "thus @xmath1340 . moreover , our assumption that @xmath1316 implies that @xmath1341 ( say ) .",
    "together with ( sch@xmath1342 ) this in turn ensures that for every @xmath1343 , we can pick vertices @xmath1344 and @xmath1345 such that @xmath1346 , @xmath1347 and @xmath1348 are ( directed ) edges in @xmath3 and such that all the @xmath1349 vertices @xmath1350 ( for @xmath1351 ) are distinct from each other . let @xmath1352 be the path @xmath1353 .",
    "thus @xmath1352 is a directed path from @xmath74 to @xmath70 in @xmath1354 which is consistent with  @xmath1160 .",
    "( here @xmath1262 is obtained from @xmath1160 by orienting every edge towards  @xmath74 . ) note that @xmath1355 for all @xmath1331 .",
    "( this follows from our assumption that @xmath1326 , @xmath1327 , @xmath1328 and @xmath1329 are distinct . )",
    "moreover , @xmath1356 for all @xmath1357 .    pick a vertex @xmath1358 in @xmath1236 so that @xmath1359 is an edge of @xmath3 .",
    "find a path @xmath1360 from @xmath1361 to @xmath1237 in @xmath3 such that the vertex set of @xmath1360 consists of @xmath1361 and precisely one vertex in each @xmath1362 for all @xmath1363 and one vertex in each @xmath1364 for all @xmath1365 and no other vertices .",
    "( sch@xmath1342 ) ensures that this can be done greedily .",
    "define @xmath1366 to be the concatenation of @xmath1367 , @xmath1368 and @xmath1360 .",
    "note that @xmath1366 is a directed path from @xmath1236 to @xmath1237 in @xmath1354 which is consistent with @xmath1160 .",
    "moreover , @xmath1369 , @xmath1370 while @xmath1371 ( sch@xmath1342 ) ensures that for each @xmath1331 , there exist @xmath1372 ( directed ) paths @xmath1373 in @xmath3 such that    * @xmath1374 is a path from @xmath1236 to @xmath1237 for each @xmath1375 and @xmath1331 ; * each @xmath1374 contains precisely one vertex in @xmath1362 for each @xmath1376 , one vertex in @xmath1364 for each @xmath1377 and no other vertices ; * @xmath1378 are vertex - disjoint .",
    "let @xmath100 be the union of @xmath1366 and all the @xmath1374 over all @xmath1331 and @xmath1379 .",
    "thus @xmath100 is a path system consisting of @xmath1380 vertex - disjoint directed paths from @xmath1236 to @xmath1237 .",
    "moreover , @xmath1381 consists of precisely @xmath1382 vertices in @xmath1362 for every @xmath1383 and precisely @xmath1384 vertices in @xmath1364 for every @xmath1385 .",
    "set @xmath1386 and @xmath1387 for all @xmath587 .",
    "note that , for all @xmath1388 , latexmath:[\\[\\label{eq : sizeaih }    since @xmath1316 .",
    "similarly , @xmath1390 for all @xmath1391 . pick a new constant @xmath661 such that @xmath1392 . then",
    "( sch@xmath1393 ) and ( [ eq : sizeaih ] ) together with proposition  [ superslice ] imply that @xmath1394 $ ] is still @xmath1395$]-superregular and so we can find a perfect matching in @xmath1396 $ ] for all @xmath1397 . similarly , we can find a perfect matching in @xmath1398 $ ] for all @xmath1397 .",
    "the union @xmath377 of all these matchings forms @xmath1399 vertex - disjoint directed paths .",
    "let @xmath1259 be the undirected graph obtained from @xmath1400 by ignoring the directions of all the edges .",
    "proposition  [ ces - h](i ) implies that @xmath1259 is a path on @xmath1401 with the same endvertices as @xmath1366 .",
    "consider the path system obtained from @xmath1402 by ignoring the directions of the edges on all the paths .",
    "let @xmath1257 be the union of this path system and @xmath1259 .",
    "then @xmath1257 is a balanced exceptional path system for @xmath3 , as required .",
    "the next lemma shows that we can obtain many edge - disjoint balanced exceptional factors by extending balanced exceptional systems with suitable properties .",
    "[ lma : ef - bipartite ] suppose that @xmath1403 , that @xmath1404 , that @xmath1405 , that @xmath1316 and @xmath1406 .",
    "let @xmath1317 be a @xmath1318$]-scheme with @xmath1319 .",
    "consider a spanning cycle @xmath1224 on the clusters of @xmath1212 .",
    "suppose that there exists a set @xmath1407 of @xmath1408 edge - disjoint balanced exceptional systems with parameter @xmath973 such that    * for all @xmath1409 and all @xmath1410 , @xmath1407 contains precisely @xmath778 @xmath986-bes of style @xmath1233 ( with respect to @xmath1284 ) for which @xmath1411 .",
    "then there exist @xmath778 edge - disjoint balanced exceptional factors with parameters  @xmath1244 for @xmath3 ( with respect to @xmath223 , @xmath1222 ) covering all edges in  @xmath1412 .",
    "recall that the canonical interval partition @xmath1225 of @xmath223 into @xmath614 intervals consists of the intervals @xmath1413 for all @xmath1227 .",
    "so the condition on  @xmath1407 ensures that for each interval @xmath1414 and each @xmath1230 , the set @xmath1407 contains precisely @xmath778 balanced exceptional systems of style @xmath1233 whose edges are only incident to vertices in @xmath549 and vertices belonging to clusters in the interior of @xmath1234 .",
    "we will use lemma  [ lma : bipartite : ceps ] to extend each such balanced exceptional system into a balanced exceptional path system of style @xmath1233 spanning  @xmath1234 .",
    "55*proof of lemma  [ lma : ef - bipartite ] .",
    "* choose a new constant @xmath661 with @xmath1415 .",
    "let @xmath1416 be a partition of @xmath1407 such that for all @xmath1417 , @xmath1410 and @xmath1409 , the set @xmath1418 contains precisely one @xmath986-bes of style @xmath1233 with @xmath1411 .",
    "thus each @xmath1418 consists of @xmath1245 balanced exceptional systems . for each @xmath1417 in turn",
    ", we will choose a balanced exceptional factor @xmath1419 with parameters @xmath1244 for @xmath3 such that @xmath1420 and @xmath1421 are edge - disjoint for all @xmath1422 and @xmath1420 contains all edges of the balanced exceptional systems in @xmath1418 .",
    "assume that we have already constructed @xmath1423 .",
    "in order to construct @xmath1420 , we will choose the @xmath1245 balanced exceptional path systems forming @xmath1420 one by one , such that each of these balanced exceptional path systems is edge - disjoint from @xmath1424 and contains precisely one of the balanced exceptional systems in @xmath1418 .",
    "suppose that we have already chosen some of these balanced exceptional path systems and that next we wish to choose a balanced exceptional path system of style @xmath1233 which spans the interval @xmath1414 of @xmath223 and contains @xmath1425 .",
    "let @xmath155 be the oriented graph obtained from @xmath3 by deleting all the edges in the balanced path systems already chosen for @xmath1420 as well as deleting all the edges in @xmath1424 .",
    "recall from ( sch1@xmath1111 ) that @xmath1295 .",
    "thus @xmath1426 by  . together with proposition  [ superslice",
    "] this implies that @xmath1427 is still a @xmath1428$]-scheme .",
    "( here we use that @xmath1429 and @xmath1415 . )",
    "so we can apply lemma  [ lma : bipartite : ceps ] with @xmath661 playing the role of @xmath47 to obtain a balanced exceptional path system of style @xmath1233 for @xmath155 ( and thus for @xmath3 ) which spans @xmath1234 and contains all edges of @xmath184 .",
    "this completes the proof of the lemma .",
    "the robust decomposition lemma ( corollary  [ rdeccor ] ) allows us to transform an approximate hamilton decomposition into an exact one . as discussed in section  [ sec : sketch ] , it will only be used in the proof of theorem  [ 1factbip ] ( and not in the proof of theorem  [ nwmindegbip ] ) . in the next subsection",
    ", we introduce the necessary concepts .",
    "in particular , corollary  [ rdeccor ] relies on the existence of a so - called bi - universal walk .",
    "the ( proof of the ) robust decomposition lemma then uses edges guaranteed by this universal walk to ` balance out ' edges of the graph @xmath82 when constructing the hamilton decomposition of @xmath1430 .",
    "let @xmath1431 be a digraph whose vertices are @xmath1432 and suppose that @xmath1433 is a hamilton cycle of @xmath1431 .",
    "( later on the vertices of @xmath1431 will be clusters .",
    "so we denote them by capital letters . )",
    "a _ chord sequence @xmath1434 _ from @xmath1435 to @xmath1436 in @xmath1431 is an ordered sequence of edges of the form @xmath1437 where @xmath1438 , @xmath1439 and the edge @xmath1440 belongs to @xmath1431 for each @xmath794 .",
    "if @xmath684 then we consider the empty set to be a chord sequence from @xmath1435 to @xmath1436 . without loss of generality , we may assume that @xmath1434 does not contain any edges of @xmath223 .",
    "( indeed , suppose that @xmath1440 is an edge of @xmath223 .",
    "then @xmath1441 and so we can obtain a chord sequence from @xmath1435 to @xmath1436 with fewer edges . ) for example , if @xmath1442 , then the edge @xmath1443 is a chord sequence from @xmath1435 to @xmath1444 .",
    "the crucial property of chord sequences is that they satisfy a ` local balance ' condition .",
    "suppose that @xmath1445 is obtained by concatenating several chord sequences @xmath1446 where @xmath1447 .",
    "then for every @xmath1435 , the number of edges of @xmath1445 leaving @xmath1448 equals the number of edges entering @xmath1435 .",
    "we will not use this property explicitly , but it underlies the proofs of e.g.  lemma  [ rdeclemma ] and appears implicitly e.g.  in  ( bu3 ) below .",
    "a closed walk @xmath584 in @xmath1431 is a _ bi - universal walk for @xmath223 with parameter @xmath1449 _ if the following conditions hold :    * the edge set of @xmath584 has a partition into @xmath1450 and @xmath1451 . for every @xmath1452",
    "there is a chord sequence @xmath1453 from @xmath1435 to @xmath1444 such that @xmath1451 contains all edges of all these chord sequences for even @xmath681 ( counted with multiplicities ) and @xmath1450 contains all edges of these chord sequences for odd @xmath681 .",
    "all remaining edges of @xmath584 lie on @xmath223 . *",
    "each @xmath1453 consists of at most @xmath1454 edges . *",
    "@xmath1451 enters every cluster @xmath1435 exactly @xmath1455 times and it leaves every cluster @xmath1435 exactly @xmath1455 times .",
    "the same assertion holds for @xmath1450 .",
    "note that condition  ( bu1 ) means that if an edge @xmath1456 occurs in total 5 times ( say ) in @xmath1457 then it occurs precisely 5 times in @xmath584 .",
    "we will identify each occurrence of @xmath1458 in @xmath1457 with a ( different ) occurrence of @xmath1458 in @xmath584 .",
    "note that the edges of @xmath1459 are allowed to appear in a different order within @xmath584 .",
    "[ lem : univwalk ] let @xmath1431 be a digraph with vertices @xmath1432 where @xmath1460 is even .",
    "suppose that @xmath1433 is a hamilton cycle of @xmath1431 and that @xmath1442 for every @xmath1452 .",
    "let @xmath1461 be an even integer .",
    "let @xmath1462 denote the multiset obtained from @xmath1463 copies of @xmath1464 by adding @xmath1442 for every @xmath1452 .",
    "then the edges in @xmath1462 can be ordered so that the resulting sequence forms a bi - universal walk for @xmath223 with parameter  @xmath1449 .    in the remainder of the paper , we will also write @xmath1462 for the bi - universal walk guaranteed by lemma  [ lem : univwalk ] .",
    "let us first show that the edges in @xmath1462 can be ordered so that the resulting sequence forms a closed walk in  @xmath1431 . to see this , consider the multidigraph @xmath584 obtained from @xmath1462 by deleting one copy of  @xmath1464 .",
    "then @xmath584 is @xmath1465-regular and thus has a decomposition into 1-factors .",
    "we order the edges of @xmath1462 as follows : we first traverse all cycles of the 1-factor decomposition of @xmath584 which contain the cluster @xmath1466 .",
    "next , we traverse the edge @xmath1467 of @xmath223 .",
    "next we traverse all those cycles of the 1-factor decomposition which contain @xmath1468 and which have not been traversed so far .",
    "next we traverse the edge @xmath1469 of @xmath223 and so on until we reach @xmath1466 again .",
    "recall that , for each @xmath1452 , the edge @xmath1443 is a chord sequence from @xmath1435 to @xmath1444 .",
    "thus we can take @xmath1470 .",
    "then @xmath1462 satisfies ( bu1)(bu3 ) .",
    "indeed , ( bu2 ) is clearly satisfied .",
    "partition one of the copies of @xmath1464 in @xmath1462 into @xmath1471 and @xmath1472 where @xmath1473 and @xmath1474 .",
    "note that the union of @xmath1471 together with all @xmath1459 for even @xmath681 is a @xmath12-factor in @xmath1431 .",
    "add @xmath1475 of the remaining copies of @xmath1464 to this @xmath12-factor to obtain @xmath1451 .",
    "define @xmath1450 to be @xmath1476 .",
    "by construction of @xmath1451 and @xmath1450 , ( bu1 ) and ( bu3 ) are satisfied .",
    "the aim of this subsection is to state the robust decomposition lemma ( lemma  [ rdeclemma ] , proved in  @xcite ) and derive corollary  [ rdeccor ] , which we shall use later on .",
    "the robust decomposition lemma guarantees the existence of a ` robustly decomposable ' digraph @xmath1477 within a ` bi - setup ' .",
    "roughly speaking , a bi - setup is a digraph @xmath3 together with its ` reduced digraph ' @xmath1431 , which contains a hamilton cycle @xmath223 and a universal walk @xmath584 . in our application ,",
    "@xmath80 $ ] will play the role of @xmath3 and @xmath1431 will be the complete bipartite digraph . to define a bi - setup formally ,",
    "we first need to define certain ` refinements ' of partitions .    given a digraph @xmath3 and a partition @xmath558 of @xmath49 into @xmath872 clusters @xmath1432 of equal size",
    ", we say that a partition @xmath1218 of @xmath49 is an _",
    "@xmath1449-refinement of @xmath558 _ if @xmath1218 is obtained by splitting each @xmath1435 into @xmath1449 subclusters of equal size .",
    "( so @xmath1218 consists of @xmath1478 clusters . )",
    "@xmath1218 is an _",
    "@xmath47-uniform @xmath1449-refinement _ of @xmath558 if it is an @xmath1449-refinement of @xmath558 which satisfies the following condition : whenever @xmath103 is a vertex of @xmath3 , @xmath84 is a cluster in @xmath558 and @xmath1479 then @xmath1480 for each cluster @xmath1481 with @xmath1482 .",
    "the inneighbourhoods of the vertices of @xmath3 satisfy an analogous condition .",
    "we will use the following lemma from  @xcite .",
    "[ randompartition ] suppose that @xmath1483 and that @xmath1484 .",
    "suppose that @xmath3 is a digraph and that @xmath558 is a partition of @xmath49 into @xmath872 clusters of size @xmath154 .",
    "then there exists an @xmath47-uniform @xmath1485-refinement of @xmath558 .",
    "moreover , any @xmath47-uniform @xmath1485-refinement @xmath1218 of @xmath558 automatically satisfies the following condition :    * suppose that @xmath84 , @xmath1486 are clusters in @xmath558 and @xmath1487 are clusters in @xmath1218 with @xmath1482 and @xmath1488 .",
    "if @xmath1489 $ ] is @xmath1490$]-superregular for some @xmath1491 then @xmath1492 $ ] is @xmath1493$]-superregular .",
    "we will also need the following definition from  @xcite , which describes the structure within which the robust decomposition lemma finds the robustly decomposable graph .",
    "@xmath1494 is called an _ @xmath1495-bi - setup _ if the following properties are satisfied :    * @xmath3 and @xmath1431 are digraphs .",
    "@xmath1212 is a partition of @xmath49 into @xmath872 clusters of size @xmath154 where @xmath872 is even .",
    "the vertex set of @xmath1431 consists of these clusters . *",
    "for every edge @xmath1496 of @xmath1431 , the corresponding pair @xmath1489 $ ] is @xmath151-regular .",
    "* @xmath1497 is a hamilton cycle of @xmath1431 and for every edge @xmath1498 of @xmath223 the corresponding pair @xmath1499 $ ] is @xmath152$]-superregular .",
    "* @xmath584 is a bi - universal walk for @xmath223 in @xmath1431 with parameter  @xmath1449 and @xmath1218 is an @xmath47-uniform @xmath1449-refinement of @xmath558 .",
    "* let @xmath1500 denote the clusters in @xmath1218 which are contained in @xmath1436 ( for each @xmath1501 ) .",
    "then @xmath1502 is a closed walk on the clusters in @xmath1218 which is obtained from @xmath584 as follows : when @xmath584 visits @xmath1436 for the @xmath291th time , we let @xmath1502 visit the subcluster @xmath1503 ( for all @xmath1504 ) . * for every edge @xmath1505 of @xmath1502 the corresponding pair @xmath1506 $ ] is @xmath152$]-superregular .    in  @xcite , in a bi - setup , the digraph @xmath3 could also contain an exceptional set , but since we are only using the definition in the case when there is no such exceptional set , we have only stated it in this special case .",
    "suppose that @xmath1507 is a @xmath1292$]-scheme and that @xmath1508 is a spanning cycle on the clusters of @xmath1212 .",
    "let @xmath1509 .",
    "suppose that @xmath1510 with @xmath1461 .",
    "let @xmath1511 be an @xmath47-uniform @xmath1449-refinement of @xmath1512 ( which exists by lemma  [ randompartition ] ) .",
    "let @xmath1513 be the directed cycle obtained from @xmath223 in which the edge @xmath1514 is oriented towards @xmath1515 and so on .",
    "let @xmath1516 be the complete bipartite digraph whose vertex classes are @xmath1517 and @xmath1518 .",
    "let @xmath1462 be a bi - universal walk for @xmath223 with parameter @xmath1449 as defined in lemma  [ lem : univwalk ] .",
    "let @xmath1519 be the closed walk obtained from @xmath1462 as described in  ( st5 ) .",
    "we will call @xmath1520 the _ bi - setup associated to  @xmath1507_. the following lemma shows that it is indeed a bi - setup .    [",
    "lem : bisetup ] suppose that @xmath1521 with @xmath1461 , @xmath1522 and @xmath1523 .",
    "suppose that @xmath1507 is a @xmath1292$]-scheme and that @xmath1508 is a spanning cycle on the clusters of @xmath1212 .",
    "then @xmath1520 is an @xmath1524-bi - setup .",
    "clearly , @xmath1525 satisfies  ( st1 ) .",
    "( sch@xmath1393 ) implies that ( st2 ) and  ( st3 ) hold .",
    "lemma  [ lem : univwalk ] implies  ( st4 ) .",
    "( st5 ) follows from the definition of @xmath1519 .",
    "finally , ( st6 ) follows from ( sch3@xmath1111 ) and lemma  [ randompartition ] since @xmath1526 is an @xmath47-uniform @xmath1449-refinement of  @xmath1512 .",
    "we now state the robust decomposition lemma from  @xcite .",
    "this guarantees the existence of a ` robustly decomposable ' digraph @xmath1477 , whose crucial property is that @xmath1527 has a hamilton decomposition for any sparse bipartite regular digraph  @xmath82 which is edge - disjoint from @xmath1477 .",
    "@xmath1477 consists of digraphs @xmath1528 ( the ` chord absorber ' ) and @xmath1529 ( the ` parity extended cycle switcher ' ) together with some special factors .",
    "@xmath1477 is constructed in two steps : given a suitable set @xmath1530 of special factors , the lemma first ` constructs ' @xmath1528 and then , given another suitable set @xmath1531 of special factors , the lemma ` constructs ' @xmath1529 .",
    "the reason for having two separate steps is that in  @xcite , it is not clear how to construct @xmath1528 after constructing @xmath1531 ( rather than before ) , as the removal of @xmath1531 from the digraph under consideration affects its properties considerably .    [",
    "rdeclemma ] suppose that @xmath1532 where @xmath1533 is even and that @xmath1534 .",
    "let @xmath1535 and suppose that @xmath1536 .",
    "suppose that @xmath1494 is an @xmath1495-bi - setup and @xmath1433 .",
    "suppose that @xmath1537 is a @xmath1538-refinement of @xmath558 and that @xmath1539 are edge - disjoint special factors with parameters @xmath1540 with respect to @xmath223 , @xmath1537 in @xmath3 .",
    "let @xmath1541 .",
    "then there exists a digraph @xmath1528 for which the following holds :    * @xmath1528 is an @xmath1542-regular spanning subdigraph of @xmath3 which is edge - disjoint from @xmath1530 .",
    "* suppose that @xmath1543 are special factors with parameters @xmath1544 with respect to @xmath223 , @xmath558 in @xmath3 which are edge - disjoint from each other and from @xmath1545 .",
    "let @xmath1546 .",
    "then there exists a digraph @xmath1529 for which the following holds : * * @xmath1529 is a @xmath1547-regular spanning subdigraph of @xmath3 which is edge - disjoint from @xmath1548 . *",
    "* let @xmath1549 be the set consisting of all the @xmath1550 special path systems contained in @xmath1551 .",
    "let @xmath1552 denote the union of all @xmath1435 over all even @xmath1452 and define @xmath1553 similarly .",
    "suppose that @xmath82 is an @xmath83-regular bipartite digraph on @xmath49 with vertex classes @xmath1552 and",
    "@xmath1553 which is edge - disjoint from @xmath1554",
    ". then @xmath1555 has a decomposition into @xmath1550 edge - disjoint hamilton cycles @xmath1556 .",
    "moreover , @xmath466 contains one of the special path systems from @xmath1549 , for each @xmath1557 .",
    "recall from section  [ sec : sf ] that we always view fictive edges in special factors as being distinct from each other and from the edges in other graphs .",
    "so for example , saying that @xmath1528 and @xmath1530 are edge - disjoint in lemma  [ rdeclemma ] still allows for a fictive edge @xmath88 in @xmath1530 to occur in @xmath1528 as well ( but @xmath1528 will avoid all non - fictive edges in @xmath1530 ) .    we will use the following ` undirected ' consequence of lemma  [ rdeclemma ] .",
    "[ rdeccor ] suppose that @xmath1558 where @xmath1533 is even and that @xmath1559 .",
    "let @xmath1560 and suppose that @xmath1561 .",
    "suppose that @xmath1562 is a @xmath1292$]-scheme and let @xmath155 denote the underlying undirected graph of @xmath1286 .",
    "let @xmath1508 be a spanning cycle on the clusters in @xmath558 .",
    "suppose that @xmath1563 are edge - disjoint balanced exceptional factors with parameters @xmath1244 for @xmath1286 ( with respect to @xmath223 , @xmath1222 ) .",
    "let @xmath1564 .",
    "then there exists a graph @xmath1565 for which the following holds :    * @xmath1565 is a @xmath1566-regular spanning subgraph of @xmath155 which is edge - disjoint from @xmath1567 .",
    "* suppose that @xmath1568 are balanced exceptional factors with parameters @xmath1544 for @xmath1286 ( with respect to @xmath223 , @xmath553 ) which are edge - disjoint from each other and from @xmath1569 .",
    "let @xmath1570 .",
    "then there exists a graph @xmath1571 for which the following holds : * * @xmath1571 is a @xmath1572-regular spanning subgraph of @xmath155 which is edge - disjoint from @xmath1573 . *",
    "* let @xmath1574 be the set consisting of all the @xmath1550 balanced exceptional path systems contained in @xmath1575 .",
    "suppose that @xmath82 is a @xmath477-regular bipartite graph on @xmath1576 with vertex classes @xmath1577 and @xmath1578 which is edge - disjoint from @xmath1579 .",
    "then @xmath1580 has a decomposition into @xmath1550 edge - disjoint hamilton cycles @xmath1556 .",
    "moreover , @xmath466 contains one of the balanced exceptional path systems from @xmath1574 , for each @xmath1557 .",
    "we remark that we write @xmath1581 for the clusters in @xmath558 .",
    "note that the vertex set of each of @xmath1582 , @xmath1583 , @xmath190 includes @xmath549 while that of @xmath1286 , @xmath1565 , @xmath1571 , @xmath82 does not . here",
    "@xmath1163 , where @xmath187 and @xmath188 are the exceptional sets of @xmath558 .",
    "choose new constants @xmath661 and @xmath1584 such that @xmath1585 and @xmath1586 .",
    "consider the bi - setup @xmath1587 associated to @xmath1562 .",
    "by lemma  [ lem : bisetup ] , @xmath1588 is an @xmath1524-bi - setup and thus also an @xmath1589-bi - setup .",
    "let @xmath1590 be as defined in section  [ sec : beps ] .",
    "recall from there that , for each @xmath1591 , @xmath1590 is a special factor with parameters @xmath1244 with respect to @xmath223 , @xmath1222 in @xmath1286 such that @xmath1592 consists of all the edges in the @xmath1160 for all the @xmath1245 balanced exceptional systems @xmath184 contained in @xmath1593 .",
    "thus we can apply lemma  [ rdeclemma ] to @xmath1588 with @xmath1594 , @xmath1245 , @xmath661 playing the roles of @xmath872 , @xmath778 , @xmath47 in order to obtain a spanning subdigraph @xmath1528 of @xmath1286 which satisfies lemma  [ rdeclemma](i ) .",
    "hence the underlying undirected graph @xmath1565 of @xmath1528 satisfies corollary  [ rdeccor](i ) . indeed , to check that @xmath1565 and @xmath1567 are edge - disjoint , by lemma  [ rdeclemma](i ) it suffices to check that @xmath1565 avoids all edges in all the balanced exceptional systems @xmath184 contained in @xmath1593 ( for all @xmath1591 ) .",
    "but this follows since @xmath1595 consists only of @xmath75-edges by ( sch2@xmath1111 ) and since no balanced exceptional system contains an @xmath75-edge by  ( bes2 ) .",
    "now let @xmath1568 be balanced exceptional factors as described in corollary  [ rdeccor](ii ) .",
    "similarly as before , for each @xmath1596 , @xmath1597 is a special factor with parameters @xmath1544 with respect to @xmath223 , @xmath553 in @xmath1286 such that @xmath1598 consists of all the edges in the @xmath1160 over all the @xmath1599 balanced exceptional systems @xmath184 contained in @xmath1600 .",
    "thus we can apply lemma  [ rdeclemma ] to obtain a spanning subdigraph @xmath1529 of @xmath1286 which satisfies lemma  [ rdeclemma](ii)(a ) and  ( ii)(b ) .",
    "hence the underlying undirected graph @xmath1571 of @xmath1529 satisfies corollary  [ rdeccor](ii)(a ) .",
    "it remains to check that corollary  [ rdeccor](ii)(b ) holds too .",
    "thus let @xmath82 be as described in corollary  [ rdeccor](ii)(b ) .",
    "let @xmath1601 be an @xmath83-regular orientation of @xmath82 .",
    "( to see that such an orientation exists , apply petersen s theorem to obtain a decomposition of @xmath82 into @xmath357-factors and then orient each @xmath357-factor to obtain a ( directed ) @xmath12-factor . )",
    "let @xmath1602 be the union of the @xmath1590 over all @xmath1591 and let @xmath1603 be the union of the @xmath1597 over all @xmath1596 .",
    "then lemma  [ rdeclemma](ii)(b ) implies that @xmath1604 has a decomposition into @xmath1550 edge - disjoint ( directed ) hamilton cycles @xmath1605 such that each @xmath1606 contains @xmath1607 for some balanced exceptional path system @xmath1608 from @xmath1574 .",
    "let @xmath466 be the undirected graph obtained from @xmath1609 by ignoring the directions of all the edges .",
    "then proposition  [ prop : cepsbiparite ] ( applied with @xmath155 playing the role of @xmath3 ) implies that @xmath1556 is a decomposition of @xmath1610 into edge - disjoint hamilton cycles .",
    "the proof of theorem  [ nwmindegbip ] is similar to that of theorem  [ 1factbip ] except that we do not need to apply the robust decomposition lemma in the proof of theorem  [ nwmindegbip ] . for both results",
    ", we will need an approximate decomposition result ( lemma  [ almostthm ] ) , which is stated below and proved as lemma  3.2 in  @xcite .",
    "the lemma extends a suitable set of balanced exceptional systems into a set of edge - disjoint hamilton cycles covering most edges of an almost complete and almost balanced bipartite graph .",
    "[ almostthm ] suppose that @xmath1611 and @xmath1612 , where @xmath1613 and @xmath240 is even .",
    "suppose that @xmath3 is a graph on @xmath0 vertices and @xmath1212 is a @xmath1614-partition of @xmath1615 furthermore , suppose that the following conditions hold :    * @xmath1616 and @xmath1617 for all @xmath1618 , @xmath1112 and @xmath1619 .",
    "* there is a set @xmath1620 which consists of at most @xmath1621 edge - disjoint balanced exceptional systems with parameter @xmath973 in  @xmath3 .",
    "* @xmath1620 has a partition into @xmath916 sets @xmath1622 ( one for all @xmath1623 ) such that each @xmath1624 consists of precisely @xmath1625 @xmath972-bes with respect to  @xmath558 . *",
    "each @xmath1626 is incident with an edge in @xmath184 for at most @xmath1627 @xmath1628",
    ".    then @xmath3 contains @xmath1629 edge - disjoint hamilton cycles such that each of these hamilton cycles contains some @xmath1630 .    to prove theorem  [ nwmindegbip ]",
    ", we find a framework via corollary  [ covera0b02c ]",
    ". then we choose suitable balanced exceptional systems using corollary  [ bescor ] .",
    "finally , we extend these into hamilton cycles using lemma  [ almostthm ] .    55*proof of theorem  [ nwmindegbip ] .",
    "* * step 1 : choosing the constants and a framework . * by making @xmath434 smaller if necessary , we may assume that @xmath1631 .",
    "define new constants such that @xmath1632 where @xmath1633 and @xmath240 is even .",
    "let @xmath3 , @xmath58 and @xmath2 be as in theorem  [ nwmindegbip ] .",
    "apply corollary  [ covera0b02c ] with @xmath56 , @xmath973 playing the role of @xmath47 , @xmath1634 to find a set @xmath1635 of at most @xmath1636 edge - disjoint hamilton cycles in @xmath58 so that the graph @xmath749 obtained from @xmath3 by deleting all the edges in these hamilton cycles forms part of an @xmath1637-framework @xmath1638 with @xmath1639 .",
    "moreover , @xmath58 satisfies  ( wf5 ) with respect to @xmath1151 and @xmath1640 and that @xmath1641 is even ( since @xmath2 is even ) .",
    "let @xmath1642 be the graph obtained from @xmath58 by deleting all those edges lying on hamilton cycles in @xmath1635 .",
    "then @xmath1643 let @xmath1644 by changing @xmath1645 slightly , we may assume that @xmath915 .",
    "* step 2 : choosing a @xmath552-partition @xmath558 . *",
    "apply lemma  [ part ] to @xmath1638 with @xmath1642 , @xmath973 playing the roles of @xmath58 , @xmath47 in order to obtain partitions @xmath1646 and @xmath1647 of @xmath70 and @xmath74 into sets of size @xmath154 such that together with @xmath187 and @xmath188 the sets @xmath569 and @xmath570 form a @xmath1648-partition @xmath558 for @xmath749 .",
    "note that by lemma  [ part](ii ) and since @xmath58 satisfies ( wf5 ) , for all @xmath454 and @xmath1649 , we have @xmath1650 similarly , @xmath1651 for all @xmath1652 and @xmath1216 .",
    "* step 3 : choosing balanced exceptional systems for the almost decomposition . *",
    "apply corollary  [ bescor ] to the @xmath1637-framework @xmath1638 with @xmath1642 , @xmath749 , @xmath973 , @xmath1653 , @xmath1641 playing the roles of @xmath58 , @xmath3 , @xmath47 , @xmath973 , @xmath2 .",
    "let @xmath1654 be the union of the sets @xmath1655 guaranteed by corollary  [ bescor ] .",
    "so @xmath1654 consists of @xmath1656 edge - disjoint balanced exceptional systems with parameter @xmath1653 in @xmath749 ( with respect to  @xmath1212 ) .",
    "let @xmath1657 denote the set of @xmath1658 hamilton cycles guaranteed by corollary  [ bescor ] .",
    "let @xmath1659 be the subgraph obtained from @xmath1642 by deleting all the hamilton cycles in  @xmath1657 .",
    "note that @xmath1660 * step 4 : finding the remaining hamilton cycles .",
    "* our next aim is to apply lemma  [ almostthm ] with @xmath1659 , @xmath1654 , @xmath661 playing the roles of @xmath3 , @xmath531 , @xmath973 .",
    "clearly , condition  ( c ) of lemma  [ almostthm ] is satisfied . in order to see",
    "that condition ( a ) is satisfied , let @xmath1661 and note that for all @xmath1662 we have @xmath1663 similarly @xmath1664 for all @xmath1665 .    to check condition  ( b ) , note that @xmath1666 thus condition  ( b ) of lemma  [ almostthm ] holds with @xmath1667 playing the role of @xmath1668 .",
    "since the edges in @xmath1654 lie in @xmath749 and @xmath1638 is an @xmath1637-framework , ( fr5 ) implies that each @xmath1626 is incident with an edge in @xmath184 for at most @xmath1669 @xmath1670 .",
    "( recall that in a balanced exceptional system there are no edges between @xmath70 and @xmath74 . )",
    "so condition  ( d ) of lemma  [ almostthm ] holds with @xmath1151 playing the role of @xmath1671 .",
    "so we can indeed apply lemma  [ almostthm ] to obtain a collection @xmath1672 of @xmath1673 edge - disjoint hamilton cycles in @xmath1659 which cover all edges of @xmath1674 .",
    "then @xmath1675 is a set of edge - disjoint hamilton cycles in  @xmath58 of size @xmath1676 as required .",
    "as mentioned earlier , the proof of theorem  [ 1factbip ] is similar to that of theorem  [ nwmindegbip ] except that we will also need to apply the robust decomposition lemma .",
    "this means steps 24 and step 8 in the proof of theorem  [ 1factbip ] do not appear in the proof of theorem  [ nwmindegbip ] .",
    "steps 24 prepare the ground for the application of the robust decomposition lemma and in step  8 we apply it to cover the leftover from the approximate decomposition step with hamilton cycles . steps 57 contain the approximate decomposition step , using lemma  [ almostthm ] .    in our proof of theorem  [ 1factbip",
    "] it will be convenient to work with an undirected version of the schemes introduced in section  [ sec : findbf ] . given a graph @xmath3 and partitions @xmath553 and @xmath1218 of a vertex set @xmath84 , we call @xmath1291 a _ @xmath1677-scheme _ if the following properties hold :    * @xmath1293 is a @xmath1294-partition of @xmath84 .",
    "moreover , @xmath1295 .",
    "* every edge of @xmath3 joins some vertex in @xmath70 to some vertex in  @xmath74 . *",
    "@xmath1678 and @xmath1679 for all @xmath1112 , @xmath1618 , @xmath1680 and @xmath1681 .",
    "[ lem : dirscheme ] suppose that @xmath1314 and @xmath1315 .",
    "let @xmath1317 be a @xmath1682-scheme with @xmath1683 .",
    "then there exists an orientation @xmath1286 of @xmath3 such that @xmath1684 is a @xmath1685$]-scheme .",
    "randomly orient every edge in @xmath3 to obtain an oriented graph @xmath1286 .",
    "( so given any edge @xmath88 in @xmath3 with probability @xmath1686 , @xmath1687 and with probability @xmath1686 , @xmath1688 . ) ( sch@xmath1311 ) and ( sch@xmath1689 ) follow immediately from ( sch@xmath12 ) and ( sch@xmath357 ) .",
    "note that fact  [ simplefact ] and ( sch@xmath1690 ) imply that @xmath1296 $ ] is @xmath1691$]-superregular with density at least @xmath1692 , for all @xmath1693 and @xmath1694 . using this ,",
    "( sch@xmath1393 ) follows easily from the large deviation bound in proposition  [ chernoff ] .",
    "( sch@xmath1342 ) follows from proposition  [ chernoff ] in a similar way .",
    "* step 1 : choosing the constants and a framework . *",
    "define new constants such that @xmath1695 where @xmath1696 and both @xmath1697 , @xmath1698 are even .",
    "note that we can choose the constants such that @xmath1699    let @xmath3 and @xmath2 be as in theorem  [ 1factbip ] . by applying dirac s theorem to remove a suitable number of edge - disjoint hamilton cycles if necessary",
    ", we may assume that @xmath1700 .",
    "apply corollary  [ covera0b02c ] with @xmath3 , @xmath56 , @xmath1701 , @xmath1671 , @xmath1697 playing the roles of @xmath58 , @xmath47 , @xmath1702 , @xmath661 , @xmath240 to find a set @xmath1635 of at most @xmath1636 edge - disjoint hamilton cycles in @xmath3 so that the graph @xmath749 obtained from @xmath3 by deleting all the edges in these hamilton cycles forms part of an @xmath1703-framework @xmath1638 , where latexmath:[\\[\\label{d1eq }      let @xmath1708 note that ( fr4 ) implies @xmath1709 .",
    "moreover , @xmath1710 further , by changing @xmath1711 slightly , we may assume that @xmath1712 .",
    "since @xmath1713 this implies that @xmath1714 . finally , note that @xmath1715    * step 2 : choosing a @xmath1716-partition @xmath1717 . * we now prepare the ground for the construction of the robustly decomposable graph @xmath190 , which we will obtain via the robust decomposition lemma ( corollary  [ rdeccor ] ) in step  4 .    recall that @xmath1638 is an @xmath1707-framework .",
    "apply lemma  [ part ] with @xmath749 , @xmath1641 , @xmath1718 , @xmath1701 playing the roles of @xmath3 , @xmath2 , @xmath240 , @xmath47 to obtain partitions @xmath1719 of @xmath70 and @xmath1720 of @xmath74 into sets of size @xmath1721 such that together with @xmath187 and @xmath188 all these sets @xmath1722 and @xmath1723 form a @xmath1724-partition @xmath1725 for @xmath749 .",
    "note that @xmath1726 by ( fr4 ) .",
    "for all @xmath1727 and all @xmath1230 , let @xmath1728 .",
    "( so this is just a relabeling of the sets @xmath1722 . )",
    "define @xmath1364 similarly and let @xmath1729 and @xmath1730 .",
    "let @xmath1731 denote the corresponding @xmath1732-partition of @xmath49 .",
    "thus @xmath1733 is a @xmath1734-partition of @xmath49 , as defined in section  [ sec : sf ]",
    ".    let @xmath1735 $ ] .",
    "we claim that @xmath1736 is a @xmath1737-scheme . indeed , clearly  ( sch1 ) and  ( sch2 ) hold . to verify ( sch3 ) , recall that that @xmath1638 is an @xmath1706-framework and so by ( fr5 ) for all @xmath457 we have @xmath1738 and similarly @xmath1739 for all @xmath1740 . since @xmath1741 , this implies  ( sch3 ) .",
    "* step 3 : balanced exceptional systems for the robustly decomposable graph . * in order to apply corollary  [ rdeccor ] , we first need to construct suitable balanced exceptional systems .",
    "apply corollary  [ bescor ] to the @xmath1707-framework @xmath1638 with @xmath749 , @xmath1718 , @xmath1725 , @xmath1701 playing the roles of @xmath58 , @xmath240 , @xmath558 , @xmath47 in order to obtain a set @xmath531 of @xmath1742 edge - disjoint balanced exceptional systems in @xmath749 with parameter @xmath973 such that for all @xmath1743 the set @xmath531 contains precisely @xmath1744 @xmath1002-bes with respect to the partition @xmath1725 .",
    "( note that @xmath58 in corollary  [ bescor ] satisfies ( wf5 ) since @xmath749 satisfies ( fr5 ) . )",
    "so @xmath531 is the union of all the sets @xmath1745 returned by corollary  [ bescor ] .",
    "( note that we will not use all the balanced exceptional systems in  @xmath531 and we do not need to consider the hamilton cycles guaranteed by this result .",
    "so we do not need the full strength of corollary  [ bescor ] at this point . )      * in total @xmath1746 contains @xmath1748 balanced exceptional systems .",
    "for each @xmath1227 and each @xmath1410 , @xmath1746 contains precisely @xmath1749 @xmath986-bes of style @xmath1233 ( with respect to the @xmath1734-partition @xmath1733 ) such that @xmath1750 . *",
    "in total @xmath1747 contains @xmath1751 balanced exceptional systems . for each @xmath1752",
    ", @xmath1747 contains precisely @xmath1753 @xmath986-bes ( with respect to the partition @xmath1754 ) with @xmath1755 .",
    "( recall that we defined in section  [ sec : findbf ] when an @xmath986-bes has style @xmath1233 with respect to a @xmath1734-partition @xmath1733 . ) to see that it is possible to choose @xmath1746 and @xmath1747 , split @xmath531 into two sets @xmath1756 and @xmath1757 such that both @xmath1756 and @xmath1757 contain at least @xmath1758 @xmath1002-bes with respect to  @xmath1725 , for all @xmath1743 .",
    "note that there are @xmath1759 choices of 4-tuples @xmath986 with @xmath1750 .",
    "moreover , for each such 4-tuple @xmath986 and each @xmath1230 there is one 4-tuple @xmath1002 with @xmath1743 and such that any @xmath1002-bes with respect to  @xmath1725 is an @xmath986-bes of style @xmath1233 with respect to @xmath1733 . together with the fact that @xmath1760 this implies that we can choose a set @xmath1761 satisfying  ( a )",
    ".    similarly , there are @xmath1762 choices of 4-tuples @xmath986 with @xmath1755 . moreover , for each such 4-tuple @xmath986 there are @xmath1763 distinct 4-tuples @xmath1002 with @xmath1743 and such that any @xmath1002-bes with respect to  @xmath1725 is an @xmath986-bes with respect to @xmath1754 . together with the fact that @xmath1764 this implies that we can choose a set @xmath1765 satisfying  ( b ) .",
    "* step 4 : finding the robustly decomposable graph . * recall that @xmath1766 is a @xmath1737-scheme .",
    "apply proposition  [ lem : dirscheme ] with @xmath752 , @xmath1754 , @xmath1725 , @xmath504 , @xmath1767 , @xmath661 playing the roles of @xmath3 , @xmath558 , @xmath1218 , @xmath240 , @xmath154 , @xmath47 to obtain an orientation @xmath1768 of @xmath752 such that @xmath1769 is a @xmath1770$]-scheme .",
    "let @xmath1771 be a spanning cycle on the clusters in @xmath1754 .",
    "our next aim is to use lemma  [ lma : ef - bipartite ] in order to extend the balanced exceptional systems in @xmath1746 into @xmath1749 edge - disjoint balanced exceptional factors with parameters @xmath1244 for @xmath1768 ( with respect to @xmath223 , @xmath1772 ) . for this , note that the condition on @xmath1773 in lemma  [ lma : ef - bipartite ] with @xmath1749 playing the role of @xmath778 is satisfied by  ( a ) .",
    "moreover , @xmath1774 .",
    "thus we can indeed apply lemma  [ lma : ef - bipartite ] to @xmath1769 with @xmath1773 , @xmath1775 , @xmath504 , @xmath1749 playing the roles of @xmath531 , @xmath47 , @xmath240 , @xmath778 in order to obtain @xmath1749 edge - disjoint balanced exceptional factors @xmath1776 with parameters @xmath1244 for @xmath1768 ( with respect to @xmath223 , @xmath1772 ) such that together these balanced exceptional factors cover all edges in @xmath1777 .",
    "let @xmath1778 .",
    "note that @xmath1779 since @xmath1780 and @xmath1781 is divisible by @xmath1697 and thus @xmath1767 is divisible by @xmath1782 ( since @xmath1783 by our assumption ) .",
    "furthermore , @xmath1784 .",
    "thus we can apply corollary  [ rdeccor ] to the @xmath1785$]-scheme @xmath1769 with @xmath504 , @xmath1786 , @xmath1698 playing the roles of @xmath240 , @xmath47 , @xmath1449 to obtain a spanning subgraph @xmath1565 of @xmath752 as described there .",
    "( note that @xmath752 equals the graph @xmath155 defined in corollary  [ rdeccor ] . ) in particular , @xmath1565 is @xmath1566-regular and edge - disjoint from @xmath1787 .",
    "let @xmath1788 be the graph obtained from @xmath752 by deleting all the edges of @xmath1789 .",
    "thus @xmath1788 is obtained from @xmath752 by deleting at most @xmath1790 edges at every vertex in @xmath1791 .",
    "let @xmath1792 be the orientation of @xmath1788 in which every edge is oriented in the same way as in @xmath1768 .",
    "then proposition  [ superslice ] implies that @xmath1793 is still a @xmath1794$]-scheme .",
    "moreover , @xmath1795 together with  ( b ) this ensures that we can apply lemma  [ lma : ef - bipartite ] to @xmath1796 with @xmath1754 , @xmath1797 , @xmath504 , @xmath12 , @xmath1599 , @xmath1753 playing the roles of @xmath558 , @xmath531 , @xmath240 , @xmath1213 , @xmath614 , @xmath778 in order to obtain @xmath1753 edge - disjoint balanced exceptional factors @xmath1798 with parameters @xmath1544 for @xmath1792 ( with respect to @xmath223 , @xmath1799 ) such that together these balanced exceptional factors cover all edges in @xmath1800 .",
    "let @xmath1801 .",
    "let @xmath1803 .",
    "note that by  ( [ efdeg ] ) all the vertices in @xmath1804 have the same degree @xmath1805 in @xmath190 .",
    "so @xmath1806 moreover ,  ( [ efdeg ] ) also implies that all the vertices in @xmath356 have the same degree @xmath1807 in @xmath190 , where @xmath1808 .",
    "so @xmath1809    * step 5 : choosing a @xmath1810-partition @xmath1811 . * we now prepare the ground for the approximate decomposition step ( i.e.  to apply lemma  [ almostthm ] ) . for this",
    ", we need to work with a finer partition of @xmath288 than the previous one ( this will ensure that the leftover from the approximate decomposition step is sufficiently sparse compared to @xmath190 ) .",
    "let @xmath1812 ( where @xmath749 was defined in step  1 ) and note that @xmath1813 so @xmath1814 ( note that @xmath1815 is even since @xmath1641 and @xmath1816 are even . )",
    "so @xmath1817 is @xmath1815-balanced with respect to @xmath248 by proposition  [ edge_number ] .",
    "together with the fact that @xmath1638 is an @xmath1703-framework , this implies that @xmath1818 satisfies conditions ( wf1)(wf5 ) in the definition of an @xmath1819-weak framework .",
    "however , some vertices in @xmath241 might violate condition  ( wf6 ) .",
    "( but every vertex in @xmath356 will still satisfy  ( wf6 ) with room to spare . )",
    "so we need to modify the partition of @xmath1163 to obtain a new weak framework .",
    "consider a partition @xmath1820 of @xmath241 which maximizes the number of edges in @xmath1817 between @xmath1821 and @xmath1822 .",
    "then @xmath1823 for all @xmath1824 since otherwise @xmath1825 would be a better partition of @xmath241 . similarly @xmath1826 for all @xmath1827 . thus ( wf6 ) holds in @xmath1817 ( with respect to the partition @xmath1828 and @xmath1829 ) .",
    "moreover , proposition  [ keepbalance ] implies that @xmath1817 is still @xmath1815-balanced with respect to @xmath1830 .",
    "furthermore , with ( fr3 ) and ( fr4 ) applied to @xmath749 , we obtain @xmath1831 and similarly @xmath1832 .",
    "finally , every vertex in @xmath356 has internal degree at most @xmath1833 in @xmath1817 ( with respect to the partition @xmath1828 and @xmath1829 ) .",
    "altogether this implies that @xmath1834 is an @xmath1835-weak framework and thus also an @xmath1836-weak framework .    without loss of generality",
    "we may assume that @xmath1837 .",
    "apply lemma  [ covera0b02 ] to the @xmath1836-weak framework @xmath1834 to find a set @xmath1838 of @xmath1839 edge - disjoint hamilton cycles in @xmath1817 so that the graph @xmath1840 obtained from @xmath1817 by deleting all the edges of these hamilton cycles forms part of an @xmath1841-framework @xmath1842 , where @xmath1843 since @xmath1815 is even , @xmath1844 is even .",
    "further , @xmath1845      now apply lemma  [ part ] to @xmath1842 with @xmath1844 , @xmath1697 , @xmath973 playing the roles of @xmath2 , @xmath240 , @xmath47 in order to obtain partitions @xmath1849 and @xmath1850 of @xmath70 and @xmath74 into sets of size @xmath1851 such that together with @xmath1852 and @xmath1853 the sets @xmath569 and @xmath570 form a @xmath1854-partition @xmath1811 for @xmath1840 .",
    "( note that the previous partition of @xmath70 and @xmath74 plays no role in the subsequent argument , so denoting the clusters in  @xmath1811 by @xmath569 and @xmath570 again will cause no notational conflicts . )    * step 6 : balanced exceptional systems for the approximate decomposition . * in order to apply lemma  [ almostthm ] , we first need to construct suitable balanced exceptional systems .",
    "apply corollary  [ bescor ] to the @xmath1841-framework @xmath1842 with @xmath1840 , @xmath973 , @xmath1653 , @xmath1855 , @xmath1697 , @xmath1844 , @xmath1811 playing the roles of @xmath58 , @xmath47 , @xmath973 , @xmath1645 , @xmath240 , @xmath2 , @xmath558 .",
    "( note that since we are letting @xmath1840 play the role of @xmath58 , condition ( wf5 ) in the corollary immediately follows from ( fr5 ) . )",
    "let @xmath1654 be the union of the sets @xmath1655 guaranteed by corollary  [ bescor ] .",
    "so @xmath1654 consists of @xmath1856 edge - disjoint balanced exceptional systems with parameter @xmath1653 in @xmath1840 ( with respect to @xmath1811 ) .",
    "let @xmath1672 denote the set of hamilton cycles guaranteed by corollary  [ bescor ] .",
    "so @xmath1857 .",
    "let @xmath1858 be the subgraph obtained from @xmath1840 by deleting all those edges lying in the hamilton cycles from  @xmath1672 .",
    "set @xmath1859 .",
    "so @xmath1860 ( note that @xmath1861 ) let @xmath1862 denote the subgraph of @xmath1858 obtained by deleting all those edges lying in the balanced exceptional systems from @xmath1654 .",
    "thus @xmath1863 , where @xmath1154 is as defined in corollary  [ bescor](iv ) .",
    "in particular , @xmath549 is an isolated set in @xmath1862 and @xmath1862 is bipartite with vertex classes @xmath1828 and @xmath1829 ( and thus also bipartite with vertex classes @xmath1864 and @xmath1865 ) .",
    "consider any vertex @xmath1866 .",
    "then @xmath67 has degree @xmath1844 in @xmath1840 , degree two in each hamilton cycle from @xmath1672 , degree two in each balanced exceptional system from @xmath1654 and degree zero in  @xmath1862 .",
    "thus @xmath1867 and so @xmath1868    * step 7 : approximate hamilton cycle decomposition . *",
    "our next aim is to apply lemma  [ almostthm ] with @xmath1858 , @xmath1811 , @xmath1697 , @xmath1869 , @xmath1654 , @xmath661 playing the roles of @xmath3 , @xmath558 , @xmath240 , @xmath154 , @xmath531 , @xmath973 .",
    "clearly , condition  ( c ) of lemma  [ almostthm ] is satisfied . in order to see",
    "that condition ( a ) is satisfied , let @xmath1870 and note that @xmath1871 recall that every vertex @xmath1665 satisfies @xmath1872 moreover , @xmath1873 where the last inequality holds since @xmath1874 is an @xmath1875-framework ( c.f",
    ".  conditions ( fr4 ) and ( fr5 ) ) .",
    "together with the fact that @xmath1811 is a @xmath1854-partition for @xmath1840 ( c.f . condition ( p2 ) ) , this implies that @xmath1876 recall that @xmath1858 is obtained from @xmath1840 by deleting all those edges lying in the hamilton cycles in @xmath1672 and that @xmath1877 altogether this implies that @xmath1878 .",
    "similarly one can show that @xmath1879 for all @xmath1662 .",
    "so condition  ( a ) of lemma  [ almostthm ] holds .      since",
    "the edges in @xmath1654 lie in @xmath1840 and @xmath1874 is an @xmath1841-framework , ( fr5 ) implies that each @xmath1626 is incident with an edge in @xmath184 for at most @xmath1669 of the @xmath1670 .",
    "( recall that in a balanced exceptional system there are no edges between @xmath70 and @xmath74 . )",
    "so condition  ( d ) of lemma  [ almostthm ] holds with @xmath1151 playing the role of @xmath1671 .",
    "* step 8 : decomposing the leftover and the robustly decomposable graph . *",
    "finally , we can apply the ` robust decomposition property ' of @xmath190 guaranteed by corollary  [ rdeccor ] to obtain a hamilton decomposition of the leftover from the previous step together with @xmath190 .    to achieve this ,",
    "let @xmath731 denote the subgraph of @xmath1858 obtained by deleting all those edges lying in the hamilton cycles from  @xmath1883 .",
    "thus  ( [ degrees6 ] ) and  ( [ eq : d5 ] ) imply that every vertex in @xmath549 is isolated in @xmath731 while every vertex @xmath259 has degree @xmath1884 in  @xmath731 ( the last equality follows from  ( [ eq : d5 ] ) ) .",
    "moreover , @xmath1885 $ ] and @xmath1886 $ ] contain no edges .",
    "( this holds since @xmath731 is a spanning subgraph of @xmath1887 and since we have already seen that @xmath1862 is bipartite with vertex classes @xmath244 and @xmath245 . )",
    "now let @xmath1888 $ ] .",
    "then corollary  [ rdeccor](ii)(b ) implies that @xmath1889 has a hamilton decomposition .",
    "let @xmath1890 denote the set of hamilton cycles thus obtained .",
    "note that @xmath1891 is a spanning subgraph of @xmath3 which contains all edges of @xmath3 which were not covered by @xmath1892 .",
    "so @xmath1893 is a hamilton decomposition of @xmath3 .",
    "i. holyer , the np - completeness of edge - colouring , _ siam journ .",
    "comp . _ * 10 * ( 1981 ) , 718720 .",
    "b. jackson , edge - disjoint hamilton cycles in regular graphs of large degree , _ j. london math . soc .",
    "_ * 19 * ( 1979 ) , 1316 .",
    "c.st.j.a .",
    "nash - williams , hamiltonian lines in graphs whose vertices have sufficiently large valencies , in _ combinatorial theory and its applications , iii ( proc .",
    "balatonfred , 1969 ) _ , north - holland , amsterdam ( 1970 ) , 813819 .",
    "c.st.j.a .",
    "nash - williams , edge - disjoint hamiltonian circuits in graphs with vertices of large valency , in _ studies in pure mathematics ( presented to richard rado ) _ , academic press , london ( 1971 ) , 157183 ."
  ],
  "abstract_text": [
    "<S> in a sequence of four papers , we prove the following results ( via a unified approach ) for all sufficiently large @xmath0 :    * suppose that @xmath0 is even and @xmath1 . </S>",
    "<S> then every @xmath2-regular graph @xmath3 on @xmath0 vertices has a decomposition into perfect matchings . </S>",
    "<S> equivalently , @xmath4 . * </S>",
    "<S> suppose that @xmath5 . </S>",
    "<S> then every @xmath2-regular graph @xmath3 on @xmath0 vertices has a decomposition into hamilton cycles and at most one perfect matching . * </S>",
    "<S> suppose that @xmath3 is a graph on @xmath0 vertices with minimum degree @xmath6 . </S>",
    "<S> then @xmath3 contains at least @xmath7 edge - disjoint hamilton cycles . here </S>",
    "<S> @xmath8 denotes the degree of the largest even - regular spanning subgraph one can guarantee in a graph on @xmath0 vertices with minimum degree  @xmath9 .    according to dirac , </S>",
    "<S> ( i ) was first raised in the 1950s . </S>",
    "<S> ( ii ) and the special case @xmath10 of ( iii ) answer questions of nash - williams from 1970 . </S>",
    "<S> all of the above bounds are best possible . in the current paper , we prove the above results for the case when @xmath3 is close to a complete balanced bipartite graph .    </S>",
    "<S> *  *    # 1&#2     = by -4 1= 1 < @xmath11 to    i(i_1,i_2,i_3,i_4 )    [ section ] [ firstthm]theorem [ firstthm]proposition [ firstthm]fact [ firstthm]lemma [ firstthm]corollary [ firstthm]problem [ firstthm]definition [ firstthm]conjecture [ firstthm]claim [ firstthm]remark </S>"
  ]
}