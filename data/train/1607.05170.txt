{
  "article_text": [
    "in this work we layout the ngs modes processing for laser tomography ao systems .",
    "we start by addressing the common tilt mode ( isoplanatic ) considering different control strategies from the eso - suggested double stage , double integrators with lead filters and linear - quadratic - gaussian ( lqg ) controllers under two distinct operating scenarios : in stand - alone mode or in tandem with the telescope s image stabilisation controller averaging tip / tilt signals from three ngs off - axis .",
    "we then move on to handle the anisoplanatic tilt .",
    "three models are presented : + _ i ) _ tilt - tomography using a combination of tilt and high - altitude quadratic modes that produce pure tilt through cone projected ray - tracing through the wave - front profiles @xcite ; + _ ii ) _ a spatio - angular mmse tilt estimation anywhere in the field that is more general .",
    "+ _ iii ) _ the ( straightforward ) generalisation to dynamic controllers using near - markovian time - progression models from @xcite .",
    "these controllers will be used for the harmoni ngs modes @xcite .",
    "we will model the ao loop as independent transfer - function mode - per - mode ignoring any eventual cross - spectrum recurring to the customarily - used laplace - transformed transforms and variables @xmath1 with @xmath2 $ ] the temporal frequency vector .",
    "for the cases where the discrete z - transform needs be used we assume @xmath3 .",
    "the open - loop transfer function is assembled as follows @xcite @xmath4 where the tilt correction is provided jointly by the e - elt s m4 and m5 mirrors whose transfer functions are @xcite @xmath5\\ ] ] and @xmath6\\ ] ] we have opted for low temporally filtering the off - load to m5 using a low - pass filter @xmath7 , which we take to be a order-1 filter @xcite .    in case",
    "the controller @xmath8 is the double - integrator+lead filter @xcite @xmath9 with @xmath10 the lead filter parameters to be optimised @xcite .    for the lqg case the synthesis is done in discrete - time leading to @xcite @xmath11^{-1 } { \\mathcal{k}_{\\infty}}\\lambda_{p } { \\mathcal{a}_\\mathsf{tur}}{\\mathcal{h}_{\\infty}},\\ ] ] where @xmath12 with @xmath13 the solution of the discrete algebraic riccati equation@xcite and @xmath14 the compound matrices of discrete - time state - space model and @xmath15 the delay in integer multiples of the sampling interval @xmath16 .",
    "one other option is considered below , namely eso s double - stage controller [ 9911 - 39 ] , this conference @xcite .",
    "we assume a straight zernike - to - slopes static model ( i.e. no temporal averaging as done elsewhere @xcite ) ; the modal matrix @xmath17 translates modal coefficients of tt modes into average slopes over the illuminated sub - region of each sub - aperture with @xmath18 where @xmath19 for full - aperture tt - wfs and can easily be generalised when more sub - apertures are present in the sh - wfs .",
    "we have simulated tilt - removed random draws from the residual tomographic psds across the field simulated with fast - f @xcite for multiple wavelengths .",
    "we consider sh - wfs with 1 , 2 , 4 , 10 and 20 sub - apertures ( linear ) .",
    "figure [ fig : noisecurves ] shows the noise curves fitted to the simulated ones for all the lo - wfs cases considered  with photon - noise only for the time being .",
    "these curves are in good agreement with standard expressions ( in angle rms units ) @xmath20\\ ] ] where @xmath21 is the effective spot size of the sub - aperture and snr is the signal - to - noise ratio of a single sub - aperture , when the field - dependent strehl - ratio ( sr ) and psf fwhm across the field are taken into account . however , these curves have a major advantage : non - linear effects like saturation at low flux levels and aliasing causing the roll - off at high - fluxes are taken into account .",
    "the behaviour far from these extremes is , as expected , @xmath22     noise curves comparing the model in this section to fast - f computed noise levels as a function of the pde ( photon - detection equivalent ) for full - pupil sh ( 1x1 ) to 20x20 sh operating in h - band .",
    "saturation occurs on low - flux with increasing number of sub - apertures .",
    "aliasing is seen on the high - end flux cases due to aliasing .",
    ", scaledwidth=120.0% ]",
    "we consider stationary and non - stationary sources of tilt .",
    "the former are depicted in fig .",
    "[ fig : psdttatmwindload ] where the temporal psd of both the turbulent tilt modes causing image jitter and wind - buffeting on the telescope structure cause image motion .",
    "power - spectral densities for the atmosphere - induced and wind - induced image jitter .",
    "the latter was simulated with wind face on aligned with the main axis are depicted ( eso internal report ) . for the meadian seeing conditions simulated ( see below fig .",
    "9 for the cn2 profiles ) we get @xmath23 20 mas rms and @xmath23270 mas rms input disturbances respectively.,scaledwidth=58.0% ]    we further consider the non - stationary tilt from m1 - 3 off - loading to m4 causing a transient signal of about 400 mas rms roughly every 5 min ( baseline ) represented in fig [ fig : transient ] .",
    "transient signal affecting m4 every 5 minutes .",
    ", scaledwidth=58.0% ]      isoplanatic tilt will be corrected at the telescope level by up to three off - axis tilt sensors guiding on faint stars not vignetting the instrument s field .",
    "we are currently evaluating two scenarios    1 .",
    "* sequential handover * , where the instrument tilt signal alone drives m4/m5 after a transitioning period from the telescope over to the instrument 2 .",
    "* cascaded handover * , where the off - axis tilt signals from the telescope and the on - axis ( or closer in ) instrument tilt are mingled to drive m4/m5    although we do not cover the transitioning period in this work , we note the approach outlined in raynaud et al @xcite      we consider four control strategies broadly cited in the literature @xcite    1 .",
    "double - stage composed of two single integrators and off - load loops 2 .",
    "optimised gain double integrator with lead filter 3 .",
    "lqg with i ) ar1 and ii ) ar2 temporal evolution models    the last three are coupled to a order-1 temporal filter with a 10hz cut - off frequency ( subject to optimisation not done here although possible@xcite ) that low - pass filters tilt signals to m5 and assigns its complement to m4 .",
    "figure [ fig : hdiagram ] provides a block - diagram for integrator - based and lqg controllers .",
    "general block diagram for tt control .",
    "the low - pass filter is subject to optimisation in terms of its cut - off frequency and model order.,scaledwidth=80.0% ]    for the double - stage controller , a different off - loading strategy is obtained with two single integrators as is shown in fig .",
    "[ fig : doublestagediagram ] , but with an overall low - frequency rejection typical of a double - integrator i.e. 20db / decade .",
    "double - stage block diagram for tt control where crt1 and crt2 are integrators of the kind @xmath24 .",
    "the electric signal off from m4 consists in positioning sensors outputs.,scaledwidth=58.0% ]      the rejection transfer function is gathered as @xmath25 and @xmath26 where @xmath27 .",
    "figure [ fig : controllerrtfntf ] summarises the results thus far , depicting the rejection and noise transfer functions . in table",
    "[ tab : comparisoncontrollers ] numerical results are provided .",
    "controller s rejection and noise transfer functions.,scaledwidth=58.0% ]    .[tab : comparisoncontrollers ] residuals in nm rms , noise propagation coefficients and stability margins . [ cols=\"^,^,^,^,^,^ \" , ]      when dealing with non - stationary signals as the transient caused by off - loading m1 - 3-accumulated errors over to m4 , transfer function analysis can no longer be applied .",
    "we thus run the transient through the controllers using time - domain simulations  fig . [",
    "fig : transienthandling ] . note all the controllers but the double - stage keep the residual to within @xmath236mas whereas the latter , on account of its limited temporal bandwidth presents a spike of roughly 3 times as much , i.e. @xmath2318mas .     transient handling by the different controllers .",
    "the double - integrator+lead and the lqgs all keep the residual within @xmath28 6 mas rms whereas the double - stage , on account of its limited closed - loop bandwidth achieves an intolerable 18 mas peak value.,title=\"fig:\",scaledwidth=50.0% ] transient handling by the different controllers .",
    "the double - integrator+lead and the lqgs all keep the residual within @xmath28 6 mas rms whereas the double - stage , on account of its limited closed - loop bandwidth achieves an intolerable 18 mas peak value.,title=\"fig:\",scaledwidth=50.0% ]      although we have processed various input signals with vibration peaks following @xcite we defer to a later stage the full results when spectra from the e - elt becomes available @xcite .",
    "in cascaded handover , m4&m5 are driven jointly by the telescope and instrument s tilt signals .",
    "we foresee three options    1 .",
    "lowfs signals are processed and filtered with a custom - filter and dispatched directly to m4 and m5 following the low - pass / high - pass strategy presented above .",
    "the overall open - loop transfer function becomes @xmath29h_{m4 } + \\\\",
    "\\left[-\\gamma + \\left[-\\gamma h_{c4 } + ( 1-\\gamma)h_{ctr }        ( 1-h_{low})\\right]h_{m4}\\right]h_{c5}h_{m5 } + \\\\   ( 1-\\gamma)h_{ctr}h_{low}h_{m5 }   \\end{array } \\right\\}\\ ] ] where @xmath30 $ ] is a user - defined parameter that balances the relative weight on the instrument lowfs with respect to the telescope off - axis tilt signals 2 .",
    "instrument tilt is added in series to telescope tilt and later filtered by the double - stage @xmath31 h_{dac } h_{lag } \\left ( h_{c4}h_{m4 } + h_{c5}h_{m5 } + h_{c4}h_{m4 } h_{c5}h_{m5 } \\right)\\ ] ] 3 .",
    "instrument tilt is affected solely to m4 , the double stage taking charge of off - loading it to m5 as is goes @xmath32 h_{dac } h_{lag } \\left ( h_{c4}h_{m4 } + h_{c5}h_{m5 } + h_{c4}h_{m4 } h_{c5}h_{m5 } \\right)\\ ] ]    conveniently depicted in fig [ fig : cascadedhandover ] .",
    "a joint optimisation of @xmath33 and the integrator gains ( both for the two single integrators in the double - stage and the one for the instrument controller ) has not been conducted .",
    "results may therefore be different from the ones depicted in fig [ fig : cascadedhandover ] ; however in a cascaded handover the double - stage bandwidth will always limit the overall bandwidth of the controller .",
    "( top : ) three options tested for the cascaded handover scenario .",
    "( bottom : ) the corresponding rejection transfer functions when the instrument tilt controller is an optimised - gain double - integrator+lead - filter ( blue - left , case 1 ) , whereas cases 2 and 3 ( respectively green and magenta ) used a single optimised - gain integrator .",
    "all cases with @xmath33 = 1/2 .",
    "red - dashed curves for the double - integrator in stand - alone mode for comparison.,title=\"fig:\",scaledwidth=32.0% ] ( top : ) three options tested for the cascaded handover scenario .",
    "( bottom : ) the corresponding rejection transfer functions when the instrument tilt controller is an optimised - gain double - integrator+lead - filter ( blue - left , case 1 ) , whereas cases 2 and 3 ( respectively green and magenta ) used a single optimised - gain integrator . all cases with @xmath33 = 1/2 .",
    "red - dashed curves for the double - integrator in stand - alone mode for comparison.,title=\"fig:\",scaledwidth=29.0% ]   ( top : ) three options tested for the cascaded handover scenario .",
    "( bottom : ) the corresponding rejection transfer functions when the instrument tilt controller is an optimised - gain double - integrator+lead - filter ( blue - left , case 1 ) , whereas cases 2 and 3 ( respectively green and magenta ) used a single optimised - gain integrator .",
    "all cases with @xmath33 = 1/2 .",
    "red - dashed curves for the double - integrator in stand - alone mode for comparison.,title=\"fig:\",scaledwidth=28.0% ]     ( top : ) three options tested for the cascaded handover scenario .",
    "( bottom : ) the corresponding rejection transfer functions when the instrument tilt controller is an optimised - gain double - integrator+lead - filter ( blue - left , case 1 ) , whereas cases 2 and 3 ( respectively green and magenta ) used a single optimised - gain integrator . all cases with @xmath33 = 1/2 .",
    "red - dashed curves for the double - integrator in stand - alone mode for comparison.,scaledwidth=60.0% ]",
    "the ngs modes in laser - tomography ao are defined as the null modes of the high - order lgs measurement space , i.e. , modes that produce average slope @xmath34 0 , but that due to the lgs tilt indetermination , can not be measured by the latter . in other words , the null space can be thought of as the combination of all the modes that have non - null projection onto the angle - of - arrival ( = not just zernike tip and tilt but also higher order zernike modes ) .      to estimate the tilt in the science direction of interest we consider the following options    1 .",
    "tilt tomography with spatio - angular reconstruction @xcite + since for ltao only pupil - plane tilt is required ( no fitting on multiple dms ) we use a simplified measurement model involving the pupil - plane turbulence only @xmath35 the _ minimum mean square error _ ( mmse ) tilt estimate assuming @xmath36 and @xmath37 are zero - mean and jointly gaussian is seamlessly found to be , for the @xmath38-science directions of interest @xcite @xmath39 where @xmath40 stands for mathematical expectation of @xmath41 conditioned to @xmath42 . since in general @xmath43 , eq .",
    "( [ eq : mmse_theor_moao ] ) follows from @xmath44 .",
    "matrices @xmath45 and @xmath46 are spatio - angular covariance matrices that relate the tilt on direction @xmath47 to that on direction @xmath48 .",
    "these matrices are computed using formulae in @xcite integrated in the simulator oomao @xcite , provided knowledge of the @xmath49 atmospheric profile is passed as input .",
    "figure [ fig:35layermediancn2profile ] depicts the 35-layer @xmath49 profile from eso s site testing campaigns with a seeing of @xmath50 ( for a @xmath51 ) and @xmath52 .",
    "+    35-layer median @xmath49 profile;,scaledwidth=58.0% ] + under the spatio - angular approach , it is also possible to compute @xmath53 , i.e. , temporally predict the tt ahead in time by adjusting the angles over which the correlations are computed @xcite .",
    "@xmath54 2 .",
    "isoplanatic tilt correction ( glao - like ) which consists in averaging the tilt measurements obtained across the field @xmath55 3 .",
    "tilt tomography using virtual dms over two layers @xcite @xmath56 where we used the measurement model",
    "@xmath57 where @xmath17 is an aperture - plane phase - to - gradient matrix representing the sh - wfs and @xmath58 a ray - tracing operator from atmospheric layers to the pupil - plane . +",
    "this reconstructor is a noise - weighted reconstructor . in case of equally noisy measurements",
    "it boils down to the simple averaging ( glao - like ) case .      for the mmse case , the standard performance assessment formulae apply .",
    "starting from @xmath59 with @xmath60 we get    @xmath61    for stars of equal magnitude , the virtual dms tomography boils down to the glao - like reconstructor as it is straightforward to show for diagonal noise covariance matrices of equal entries .",
    "simulations have shown that in open loop the spatio - angular reconstructor is superior specially for large off - axis distances . in what follows",
    "we will always use it and leave a more complete comparison for later work .",
    "figure [ fig : err_fcn_nsubap_fcn_nzern ] depicts the tomographic error as a function of the number of zernike modes estimated from measurements out of lowfs from 1x1 to 20x20 sub - apertures .",
    "as expected , for on - axis observations the least number of sub - apertures is preferred whereas for off - axis the optimum seems to be a 10x10 sub - aperture shwfs with 20 + zernike modes estimated .",
    "we understand this as a trade - off between the noise propagation ( more sub - apertures means more noise ) and the pure tomographic error ( exploiting correlations of tilt with higher - order modes is beneficial ) .",
    "tomographic error as a function of the number of zernike modes estimated from measurements , scaledwidth=100.0% ]      we splat the the errors as tomographic , noise and temporal under the assumption that they are independent @xcite @xmath62 where @xmath63 is computed as in eq .",
    "( ) and @xmath64 with the horizontal elements of the loop - filtered noise covariance matrix populated with @xmath65 with @xmath66 from eq .",
    "( [ eq : ntf ] ) .",
    "the temporal error @xmath67 where @xmath68 is gathered for different controller options from eq .",
    "( [ eq : rtf ] ) .",
    "in this section we investigate the residual jitter as a function of the field and the photon flux .",
    "we have used the lqg+ar2 shown previously which provided the least isoplanatic tilt residual  see table [ tab : comparisoncontrollers ] .",
    "figure shows the residual jitter with one or two tt measurements in the field ( symmetric around the origin , same flux on both ) .",
    "we obtain a 1.2 masrms jitter for @xmath69 pde / aperture/@xmath70 on axis with 1 sh and only a small improvement with 2 sh .    on the opposite end , residual jitter of roughly 5.5masrms for 10 pde / aperture/@xmath70 1 arcmin off - axis which lowers to 5masrms in case 2",
    "tt stars are used .",
    "( top - panel ) left : residual jitter ( atm+wind - shake on 1 axis ) as a function of the pde / aperture / frame using a single - aperture sh - wfs probing a 35-layer eso atmospheric profile with @xmath71= 50 m at angles [ 0 , 15 , 30 , 60 ] arcsec .",
    "red : optimised double integrator+lead filter , black : lqg . left : same data plotted as a function of the off - axis - distance for different noise levels as a function of the pde rangin from 10 to @xmath69 .",
    "( bottom - panel ) : same as top - panel with a second tt for secondary guiding.,title=\"fig:\",scaledwidth=45.0% ] ( top - panel ) left : residual jitter ( atm+wind - shake on 1 axis ) as a function of the pde / aperture / frame using a single - aperture sh - wfs probing a 35-layer eso atmospheric profile with @xmath71= 50 m at angles [ 0 , 15 , 30 , 60 ] arcsec .",
    "red : optimised double integrator+lead filter , black : lqg . left : same data plotted as a function of the off - axis - distance for different noise levels as a function of the pde rangin from 10 to @xmath69 .",
    "( bottom - panel ) : same as top - panel with a second tt for secondary guiding.,title=\"fig:\",scaledwidth=45.0% ]    ( top - panel ) left : residual jitter ( atm+wind - shake on 1 axis ) as a function of the pde / aperture / frame using a single - aperture sh - wfs probing a 35-layer eso atmospheric profile with @xmath71= 50 m at angles [ 0 , 15 , 30 , 60 ] arcsec .",
    "red : optimised double integrator+lead filter , black : lqg . left : same data plotted as a function of the off - axis - distance for different noise levels as a function of the pde rangin from 10 to @xmath69 .",
    "( bottom - panel ) : same as top - panel with a second tt for secondary guiding.,title=\"fig:\",scaledwidth=45.0% ] ( top - panel ) left : residual jitter ( atm+wind - shake on 1 axis ) as a function of the pde / aperture / frame using a single - aperture sh - wfs probing a 35-layer eso atmospheric profile with @xmath71= 50 m at angles [ 0 , 15 , 30 , 60 ] arcsec .",
    "red : optimised double integrator+lead filter , black : lqg . left : same data plotted as a function of the off - axis - distance for different noise levels as a function of the pde rangin from 10 to @xmath69 .",
    "( bottom - panel ) : same as top - panel with a second tt for secondary guiding.,title=\"fig:\",scaledwidth=45.0% ]    with these values we could compute sky - coverage estimates at the galactic pole considering a wide - band tilt measurement from i- to k - band in a field of 1arcmin radius  as is shown in fig .",
    "[ fig : skycoverage ] as a function of the h - band magnitude@xcite .",
    "sky - coverage estimates at the galactic pole .",
    ", scaledwidth=80.0% ]",
    "our simulations of isoplanatic tilt control for the harmoni project show that lqg controllers in stand - alone mode ( i.e. sequential handover ) ensuring a 40db / dec at low - frequencies with 500hz temporal frame - rate ensure the least residual whilst being stable even in the presence of non - stationary transients affecting the system every 5 minutes .",
    "work on the cascaded handover mode where the instrument and telescope s tt controllers work in tandem needs further parameter optimisation , although it seems to us a less promising path at this time .",
    "* the use of secondary guiding improves the use of 1 single tilt measurement in the field only slightly ( less than 10% ) * use of single - aperture sh for tilt measurement is best in the centre of the field whereas a 10x10 sh seems a better option when using a start farther off - axis up to 1 arcmin radius * the spatio - angular tilt tomography controller ensures least residuals when compared to a glao - like reconstructor averaging the tilt in the field or to the virtual - dm reconstructor used in mcao      the research leading to these results received the support of the a*midex project ( no .",
    "anr-11-idex-0001 - 02 ) funded by the  investissements davenir  french government program , managed by the french national research agency ( anr ) .",
    "correia , c. , vran , j .-",
    "p . , herriot , g. , ellerbroek , b. , wang , l. , and gilles , l. , `` increased sky coverage with optimal correction of tilt and tilt - anisoplanatism modes in laser - guide - star multiconjugate adaptive optics , '' _ j. opt .",
    "* 30 * , 604615 ( apr 2013 ) .",
    "correia , c.  m. , jackson , k. , vran , j .-",
    "andersen , d. , lardire , o. , and bradley , c. , `` spatio - angular minimum - variance tomographic controller for multi - object adaptive - optics systems , '' _ appl .",
    "opt . _  * 54 * , 52815290 ( jun 2015 ) .",
    "thatte , n.  a. and the harmoni  consortium , `` the e - elt first light spectrograph harmoni : capabilities and modes , '' in [ _ proc . of the spie _",
    "] , _ ground - based and airborne instrumentation for astronomy _  * 9908 * , 990871 , spie ( 2016 ) .",
    "babak  sedghi , michael  muller , m.  d. , `` analysing the impact of vibrations on e - elt primary segmented mirror , '' in [ _ proc . of the spie _",
    "] , _ modeling , systems engineering , and project management for astronomy _  * 9911 * , 991139 , spie ( 2016 ) .",
    "correia , c. , vran , j .- p . , herriot , g. , ellerbroek , b. , wang , l. , and gilles , l. , `` advanced control of low order modes in laser guide star multi - conjugate adaptive optics systems , '' in [ _ proc . of the spie _",
    "] , 84471s84471s12 ( 2012 ) .",
    "correia , c. , raynaud , h .- f . ,",
    "kulcsr , c. , and conan , j .- m .",
    ", `` on the optimal reconstruction and control of adaptive optical systems with mirror dynamics , ''",
    "* 27 * , 333349 ( feb .",
    "2010 ) .",
    "neichel , b. , fusco , t. , and conan , j .-",
    ", `` tomographic reconstruction for wide - field adaptive optics systems : fourier domain analysis and fundamental limitations , ''",
    "* 26*(1 ) , 219235 ( 2009 ) .",
    "henri - francois g. raynaud remy  juvenal , caroline  kulcsar , c.  p. , `` the control switching adapter : a practical way to ensure bumpless switching between controllers while ao loop is engaged , '' in [ _ proc .",
    "of the spie _ ] , _ adaptive optics systems _   * 9909 * , 9909193 , spie ( 2016 ) .",
    "correia , c. , jackson , k. , vran , j .-",
    "p . , andersen , d. , lardire , o. , and bradley , c. , `` static and predictive tomographic reconstruction for wide - field multi - object adaptive optics systems , '' _ j. opt .",
    "* 31 * , 101113 ( jan 2014 ) ."
  ],
  "abstract_text": [
    "<S> sky - coverage in laser - assisted ao observations largely depends on the system s capability to guide on the faintest natural guide - stars possible . here </S>",
    "<S> we give an up - to - date status of our natural guide - star processing tailored to the european - elt s visible and near - infrared ( 0.47 to 2.45 @xmath0 ) integral field spectrograph  harmoni .    </S>",
    "<S> we tour the processing of both the isoplanatic and anisoplanatic tilt modes using the spatio - angular approach whereby the wavefront is estimated directly in the pupil plane avoiding a cumbersome explicit layered estimation on the 35-layer profiles we re currently using .    taking the case of harmoni </S>",
    "<S> , we cover the choice of wave - front sensors , the number and field location of guide - stars , the optimised algorithms to beat down angular anisoplanatism and the performance obtained with different temporal controllers under split high - order / low - order tomography or joint tomography . </S>",
    "<S> we consider both atmospheric and far greater telescope wind buffeting disturbances . </S>",
    "<S> in addition we provide the sky - coverage estimates thus obtained . </S>"
  ]
}