{
  "article_text": [
    "this paper presents a unified mathematical framework for probabilistic inference with statistical models , such as graphical models .",
    "our approach is summarized as follows :    * ( a ) statistical models are algebraic varieties .",
    "*    * ( b ) every algebraic variety can be tropicalized . *    * ( c ) tropicalized statistical models are fundamental for parametric inference . *    by a _ statistical model _ we mean a family of joint probability distributions for a collection of discrete random variables @xmath0 .",
    "thesis ( a ) states that many families of interest can be characterized by polynomials in the joint probabilities @xmath1 .",
    "the emerging field of algebraic statistics @xcite offers algorithms for this polynomial representation .",
    "_ tropicalization _ means replacing the arithmetic operations @xmath2 by the operations @xmath3 .",
    "this process captures the essence of what happens when the joint probabilities @xmath4 are replaced by their logarithms .",
    "the tropicalization of an algebraic variety is a piecewise - linear set which enjoys many features familiar from algebraic geometry @xcite . in particular ,",
    "the tropicalization of a statistical model is a piecewise - linear set in the space with logarithmic coordinates @xmath5 .",
    "thesis ( c ) states that tropical algebraic geometry of statistical models is fundamental in analyzing the behavior of inference algorithms under the variation of model parameters . by _ inference",
    "_ we mean the evaluation of one or more coordinates of a single point on the algebraic variety , in either @xmath2 or @xmath3 arithmetic .",
    "this is the standard notion of inference used for graphical models in statistical learning theory @xcite , but it differs from other ( more classical ) notions of inference in mathematical statistics . by _ parametric inference _ we mean the analysis of the dependence of inference on parameters .    to give a more concrete discussion of parametric inference it is useful to focus",
    "on directed graphical models .",
    "a _ directed graphical model _ ( or _ bayesian network _ ) is a finite directed acyclic graph @xmath6 with two kinds of vertices , _ observed variables _ @xmath0 and _ hidden variables _",
    "@xmath7 , where each edge is labeled by a transition matrix whose entries are linear forms in some parameters .",
    "the rules of discrete probability express the observed probabilities @xmath8 as polynomials of degree @xmath9 in the parameters , where @xmath9 is the number of edges of @xmath6 .",
    "the polynomials parametrize the graphical model as an algebraic variety .",
    "the two standard types of inference questions for graphical models are :    1 .   the calculation of _ marginal probabilities _ : @xmath10 2 .",
    "the calculation of _ maximum a posteriori ( map ) _ log probabilities : @xmath11    where the @xmath12 range over all the possible assignments for the hidden random variables @xmath13 .",
    "together , these two primitives can be used to effectively solve a range of other inference problems , including the calculation of conditional probabilities and other quantities of interest .",
    "the key to inference in graphical models is the _ sum - product algorithm _",
    "@xcite ( also known as the _ generalized distributive law _",
    "this polynomial - time algorithm is used , both in ordinary arithmetic @xmath2 and in tropical arithmetic @xmath3 , to _ efficiently _ solve problems 1 and 2 . for more background on the sum - product algorithm , and for connections to message passing and the junction tree algorithm",
    "see @xcite .",
    "although the sum - product algorithm provides efficient solutions to the basic inference problems 1 and 2 , it only applies to one coordinate @xmath8 of one distribution at a time .",
    "what we are interested in are the _ parametric _ versions of the inference problems .",
    "they can be phrased as follows :    1 .",
    "find all parameters for a model which result in the same values for all @xmath14 .",
    "2 .   given observations @xmath15 and hidden data @xmath16 , identify all parameters such that @xmath17 is the most likely explanation for the observations @xmath18 .    as we will see , the following _ modeling _ questions are fundamentally related to problems 3 and 4 :    1 .",
    "which ( parameter independent ) relations on the probabilities @xmath8 does the model imply ? 2 .",
    "describe the tropicalization of the variety corresponding to a graphical model .    problem 5 asks for the ideal of _ polynomial invariants _ of a statistical model @xcite .",
    "invariants have been investigated in phylogenetics @xcite where they can help to identify good trees for aligned dna sequences .",
    "the primary goal of our study is to give a practical answer to question 4 for graphical models .",
    "our main algorithmic result is an efficient procedure for parametric inference that can be viewed as a polytopal analog of the sum - product algorithm .",
    "the efficiency is based on the complexity estimates for newton polytopes which we derive in section 4 .",
    "the resulting _ polytope propagation algorithm _ is applied to problems in biological sequence analysis in the companion paper @xcite .",
    "the mathematics to be developed in sections 3 and 4 is of independent interest .",
    "it also furnishes new tools for parametric inference ( problems 3 and 4 ) and parametric modeling ( problems 5 and 6 ) which are applicable to a wide range of statistical problems .",
    "we demonstrate this by analyzing the hidden markov model ( hmm ) and the general markov model on a binary tree , in sections 2 and 5 respectively .",
    "a graphical model is an algebraic variety which is presented as the image of a highly structured polynomial map @xmath19 . here",
    "@xmath20 is the space whose coordinates are the model parameters @xmath21 and @xmath22 is the space whose coordinates @xmath23 are the joint probabilities for the observed random variables . in applications ,",
    "the integer @xmath24 is much larger than the integer @xmath25 , in fact ; it is so large that one can only look at one coordinate @xmath26 at a time .",
    "each coordinate @xmath27 of the map @xmath28 is a polynomial function in @xmath21 .",
    "the efficient evaluation of these functions relies on the sum - product algorithm .",
    "here we study the ( parametric ) inference and modeling problems in the familiar context of the _ hidden markov model _ ( hmm ) .",
    "a discrete hmm has @xmath29 observed states @xmath30 taking on @xmath31 possible values , and @xmath29 hidden states @xmath32 taking on @xmath33 possible values .",
    "the hmm can be characterized by the following conditional independence statements for @xmath34 : @xmath35 we consider the homogeneous model with uniform initial distribution , where all transitions @xmath36 are given by the same @xmath37-matrix @xmath38 and all transitions @xmath39 are given by the same @xmath40-matrix @xmath41 . throughout our discussion we disregard for simplicity the usual probabilistic hypothesis that @xmath42 and @xmath43 are non - negative and all row sums are @xmath44 .    [ hmmprop ] the hidden markov model is the image of a map @xmath45 , where @xmath46 and each coordinate of @xmath28 is a bi - homogeneous polynomial of degree @xmath47 in @xmath42 and degree @xmath29 in @xmath43 .",
    "problem 3 is to compute the fibers of the map @xmath28 . in statistics ,",
    "this is called _",
    "parameter identification_. we use the term _ coordinate polynomials _ for the polynomials @xmath48 that are coordinates of the map @xmath28 .",
    "our running example in this section is the case @xmath49 with binary random variables @xmath50",
    ". the graph of this model is drawn in figure [ fig : hmm ] .",
    "the shaded nodes are the observed random variables .        here",
    "the parameter space is @xmath51 with coordinates @xmath52 , and it maps to @xmath51 with coordinates @xmath53 .",
    "the map @xmath54 is given by @xmath55 the hidden markov model ( i.e. the image of @xmath28 ) is the zero set of the quartic polynomial @xmath56 this polynomial was found by a _",
    "grbner basis _ computation .",
    "see the discussion on _ implicitization _ in @xcite",
    ".    in general , the polynomial functions on @xmath57 which vanish on the image of @xmath28 are the called _ invariants of the model_. they form a prime ideal @xmath58 . in our example",
    ", @xmath58 is generated by the quartic polynomial above .",
    "problem 5 is to compute generators of the ideal @xmath58 . when @xmath59 and @xmath25 are small , this can be done using grbner bases , and in some cases it is possible to characterize @xmath58 based on the structure of the model ( see , for example , conjecture [ luckydeterminants ] ) , but in general problem 5 is hard and the ideal @xmath58 may remain unknown .",
    "here is where tropical geometry comes in .",
    "the _ tropicalization _ of our map @xmath28 is the map @xmath60 defined by replacing products by sums and sums by minima in the formula for @xmath28 . in our example @xmath61",
    ", the tropicalization is the piecewise - linear map @xmath62 with @xmath63 this minimum is attained by the most likely hidden data @xmath64 , given the observations @xmath65 and given the parameters @xmath66 and @xmath67 . the sequence @xmath64 is known as the _ viterbi sequence _ in the hmm literature @xcite .",
    "it solves problem 2 in the introduction .",
    "the key observation , which we discuss in more detail in section 4 , is that the set of parameters @xmath68 which select the viterbi sequence @xmath69 is the normal cone at a vertex of the newton polytope of the polynomial @xmath70 .",
    "this polytope is @xmath71-dimensional , it has @xmath72 vertices , and its normal fan represents the solution to problem 4 in the introduction when @xmath73 is fixed .",
    "we can also consider an extension of problem 4 where @xmath73 ranges over all possible observations .",
    "the solution is given by the newton polytope of the map @xmath28 .",
    "in our example , this is a @xmath74-dimensional polytope with @xmath75 vertices , @xmath76 edges , @xmath77 two - faces , @xmath78 three - faces and @xmath79 facets , namely , the minkowski sum of eight copies of the earlier @xmath71-dimensional polytope for @xmath80 . for a concrete numerical example , fix the parameters @xmath81 and @xmath82 .",
    "we find : @xmath83 the set of all parameters @xmath84 leading to the same conclusions as @xmath85 is the cone defined by @xmath86 our solution to the parametric inference problem with respect to all observations simultaneously consists of @xmath75 such cones .",
    "the _ tropical hmm _ is the union of the images of these cones under the piecewise - linear map @xmath87 .",
    "this image is a piecewise - linear set of dimension @xmath88 .",
    "the cone which contains the chosen parameters @xmath89 mapped to a @xmath88-dimensional cone in the tropical hmm ( it spans the hyperplane @xmath90 ) but most of the other @xmath91 cones are mapped to lower - dimensional cones by the map @xmath92 .",
    "the question how the number @xmath75 grows as the length @xmath29 increases will be addressed in corollary 10 .",
    "we have seen that a graphical model is the image of a polynomial map @xmath28 from the space of parameters to the space of joint probability distributions on the observed random variables .",
    "furthermore , we have seen that the tropicalization of @xmath28 arises naturally in solving problem 4 . in this section",
    "we study the geometry of tropicalization in the more general setting where @xmath93 is an arbitrary polynomial map . in statistical applications , it is usually the case that each coordinate @xmath48 of the map @xmath28 is a polynomial with positive coefficients . if this holds then the polynomial map @xmath28 is called _",
    "positive_. we say that @xmath28 is _ surjectively positive _ if , in addition , @xmath28 maps the positive orthant surjectively onto the positive points in the image , in symbols , @xmath94 the set of all polynomial functions which vanish on the image of @xmath28 is a prime ideal @xmath58 in the polynomial ring @xmath95 $ ] .",
    "the closure of the image of @xmath28 is the variety of the prime ideal @xmath58 .    in tropical geometry",
    ", we replace the variety of @xmath58 by a piecewise - linear set as follows .",
    "the _ tropical variety _",
    "@xmath96 is the set of all weight vectors @xmath97 such that the initial ideal @xmath98 contains no monomial @xcite .",
    "following @xcite , we define the _ positive tropical variety _ @xmath99 as the set of all weight vectors @xmath97 such that the initial ideal @xmath98 contains no polynomial with only positive coefficients .",
    "the tropical variety @xmath96 is a _",
    "polyhedral fan _ in @xmath22 , and @xmath99 is a _",
    "polyhedral subcomplex _ of @xmath96 .",
    "this means that @xmath96 is a finite union of closed convex polyhedral cones that fit together nicely , and @xmath99 is the union of a subset of these cones .",
    "the _ tropicalization _ of the polynomial map @xmath28 is the piecewise - linear map @xmath100 defined by replacing products by sums and sums by minima in the evaluation of @xmath28 .",
    "we say that @xmath92 is a _ tropical morphism_. examples of tropical morphisms appear in the displayed formulas ( [ maxformula ] ) , ( [ formula1 ] ) , ( [ formula2 ] ) , ( [ formula3 ] ) , ( [ tropicaltreemap ] ) and ( [ treemapexample3 ] ) .",
    "the following theorem describes the geometry of this situation .",
    "we define the _ newton polytope _ of a polynomial map @xmath101 as the minkowski sum in @xmath102 of the newton polytopes of its coordinates @xmath103 . for basics on newton polytopes and",
    "their normal fans see @xcite .",
    "[ hmmmain ] the tropical morphism @xmath92 is linear on each cone in the normal fan of the newton polytope of @xmath28 .",
    "its image is a fan contained in @xmath96 .",
    "if @xmath28 is positive then @xmath104 is a subset of @xmath99 , but it is generally not a polyhedral subcomplex . if @xmath28 is surjectively positive then @xmath105 .",
    "let @xmath106 denote the newton polytope of the polynomial @xmath107 .",
    "by definition , @xmath106 is the convex hull in @xmath102 of all non - negative lattice points @xmath108 such that the monomial @xmath109 appears with non - zero coefficient in @xmath110 .",
    "the piecewise - linear concave function @xmath111 is the _ support function _ of the polytope @xmath106 .",
    "this means that @xmath112 is the minimum value attained on @xmath106 by the linear functional @xmath113 .",
    "in particular , the function @xmath114 is linear on each cone in the normal fan of @xmath106 .",
    "the newton polytope of the map @xmath28 is the minkowski sum @xmath115 .",
    "the normal fan of @xmath116 is the common refinement of the normal fans of @xmath117 .",
    "this shows that the function @xmath118 is linear on each cone of the normal fan of the newton polytope of @xmath28 .",
    "since @xmath92 is continuous , the image of @xmath92 is a closed polyhedral fan in @xmath22 .    consider any vector @xmath119 .",
    "we must show that @xmath120 lies in @xmath96 , and if @xmath28 is positive then @xmath120 lies in @xmath99 .",
    "let @xmath121 be any polynomial in the ideal @xmath58 .",
    "if we substitute @xmath122 into @xmath123 then we get zero . consequently",
    ", if we substitute the initial forms @xmath124 into the initial form @xmath125 then the result is zero .",
    "see equation ( 11.2 ) on page 100 in @xcite .",
    "this implies that @xmath125 is not a monomial .",
    "moreover , if @xmath28 is positive then @xmath121 must have two terms whose coefficients have opposite signs .",
    "this implies the desired conclusion .",
    "the following example shows that @xmath126 need not be a subcomplex of @xmath99 .",
    "if @xmath28 is assumed to be surjectively positive , then it follows from ( * ? ? ?",
    "* proposition 2.5 ) that @xmath127 .",
    "let @xmath128 , @xmath129 and consider the linear map @xmath130 then @xmath131 is the principal ideal generated by the linear form @xmath132 , and @xmath96 is essentially the normal fan of a tetrahedron .",
    "we identify @xmath96 with the complete graph @xmath133 .",
    "the six edges of @xmath133 are labeled with six monomial - free initial ideals of @xmath58 , namely , @xmath134 the first two of these six initial ideals contain a polynomial with positive coefficients . hence the positive tropical variety @xmath99 is the four - cycle in @xmath133 formed by the remaining four edges .",
    "the tropicalization of the linear map @xmath28 is the tropical morphism @xmath135 the image of @xmath92 is the set of all vectors @xmath136 with @xmath137 .",
    "each vector @xmath136 with @xmath138 has the initial ideal @xmath139 , so it lies on a particular edge of @xmath133 .",
    "but the same edge also accounts for all vectors @xmath136 with @xmath140 ,",
    "none of which is in the image of @xmath92 .",
    "thus @xmath141 is a closed segment which covers only half of the edge of @xmath133 indexed by @xmath142 .",
    "here it is easy to replace @xmath28 by a parameterization @xmath143 which is surjectively positive , for instance , @xmath144 @xmath145 we have @xmath146 but now the tropical morphism @xmath147 maps onto the entire four - cycle @xmath99 .    in the rest of this section",
    "we examine theorem [ hmmmain ] for a small but important graphical model , namely , the _ naive bayes model with two features _ @xcite .",
    "there are two observed random variables @xmath148 and @xmath149 dependent on one hidden binary random variable @xmath150 .",
    "the two observed variables take @xmath33 and @xmath31 possible values respectively .",
    "the parameterization @xmath28 of this model is the map @xmath151 given by @xmath152 thus the model consists of all @xmath40-matrices @xmath153 of the form @xmath154 where @xmath155 is a @xmath156-matrix and @xmath157 is a @xmath158-matrix , i.e. , the model consists of precisely the @xmath40-matrices of rank @xmath159 .",
    "[ threebythree ] the parameterization @xmath28 of the naive bayes model with two features is surjectively positive .",
    "the ideal @xmath58 is generated by the @xmath160-subdeterminants of the @xmath40-matrix @xmath161 .",
    "the map @xmath28 being positive means that if @xmath162 is any positive matrix of rank @xmath163 then @xmath42 and @xmath43 can be chosen to be positive .",
    "this is a known result in linear algebra ( see e.g.  @xcite ) .",
    "the same statement is false for rank @xmath164 , i.e. , the parameterization of the naive bayes model with three or more features is not surjectively positive .",
    "a well - known result in commutative algebra states that the @xmath165-minors of a @xmath40-matrix generate a prime ideal .",
    "the variety of this ideal is the set of @xmath40-matrices of rank @xmath166 .",
    "this our ideal @xmath58 for @xmath167 .",
    "the objects of theorem [ hmmmain ] have been studied in @xcite and @xcite .",
    "the tropical variety @xmath96 is the set of @xmath40-matrices of _ tropical rank _",
    "@xmath159 , and the tropical variety @xmath168 is the set of @xmath40-matrices of _ barvinok rank _ @xmath159 .",
    "develin @xcite determines the combinatorics and topology of these spaces when @xmath169 .",
    "he shows that @xmath170 is shellable but @xmath171 can have torsion in its integral homology groups .",
    "the newton polytope of the map @xmath28 is an interesting combinatorial object , namely , it is the @xmath172-dimensional zonotope associated with the complete bipartite graph @xmath173 .",
    "the newton polytope of each coordinate @xmath174 is a line segment , and the zonotope is their minkowski sum .",
    "the normal fan is the hyperplane arrangement @xmath175 .",
    "its maximal cones correspond to the acyclic orientations of the complete bipartite graph @xmath173 .",
    "west @xcite showed that the number of facets of such a cone can be any integer between @xmath176 and @xmath177 .",
    "the total number of cones equals @xmath178 , where @xmath179 is the stirling number of the second kind . here",
    ", the tropical morphism @xmath92 is given by @xmath180 the map @xmath181 is piecewise - linear with respect to the hyperplane arrangement .",
    "recent work of federico ardilla ( in preparation ) gives a complete classification of all fibers of @xmath92 .",
    "-0.3 cm    -determinant . ]",
    "-1.2 cm    let @xmath182 , so the two observed random variables are ternary .",
    "the prime ideal is @xmath183 the tropical variety @xmath96 is the fan over a two - dimensional polyhedral complex consisting of six triangles and nine quadrangles .",
    "this complex is the @xmath163-skeleton of the product of two triangles , labeled as in figure 2a",
    ". this complex is shellable .",
    "the positive tropical variety @xmath99 is the subcomplex consisting of the nine quadrangles shown in figure 2b .",
    "note that @xmath99 is a torus .",
    "the newton polytope of @xmath28 is a five - dimensional zonotope with @xmath184 vertices , one for each acyclic orientation of the complete bipartite graph @xmath185 .",
    "the map @xmath92 is linear on each of the @xmath184 cones in the corresponding hyperplane arrangement , but it is rank - deficient on @xmath186 of the cones .",
    "the remaining @xmath187 cones are mapped onto the @xmath188 quadrangles of the torus @xmath99 .",
    "thus the general fiber of @xmath92 involves @xmath189 cones .",
    "of these , eight cones have @xmath74 facets , eight cones have @xmath190 facets , and two cones have @xmath188 facets .",
    "consider a graphical model with @xmath9 edges and @xmath29 observed random variables @xmath30 each taking @xmath31 values .",
    "such a model is given by a positive polynomial map @xmath191 .",
    "each coordinate @xmath192 of @xmath28 is a polynomial of degree @xmath193 in the model parameters @xmath21 . in this section",
    "we discuss the statistical meaning and the computational complexity of the mathematical objects introduced in the previous section .",
    "we write @xmath194 for the negative logarithms of the model parameters .",
    "consider any of the @xmath59 possible observations @xmath18 .",
    "the quantity @xmath195 is the probability of making this particular observation , i.e.  it is @xmath196 .",
    "the quantity @xmath197 is the negative logarithm of the conditional probability @xmath198 where @xmath199 maximizes @xmath200 for the parameters @xmath201 . clearly , the function @xmath202 is piecewise - linear and concave on the logarithmic parameter space .",
    "the domains of linearity of the function @xmath203 are the cones in the normal fan of the newton polytope of @xmath192 .",
    "each maximal cone @xmath204 is indexed by the hidden data @xmath199 that maximizes @xmath205 for any of the parameters @xmath206 .",
    "the hidden data @xmath199 which arise in this manner , for some choice of logarithmic parameters @xmath207 , are called the possible _ explanations _ of the observation @xmath18 .",
    "for instance , for the hidden markov model of section 2 , the explanations are the viterbi sequences .",
    "let us now vary the observations .",
    "each logarithmic parameter vector @xmath208 defines an _ inference function _ @xmath209 from the set of observations to the set of explanations . for the hmm",
    ", each inference function @xmath210 takes an observed sequence @xmath211 to the corresponding viterbi sequence @xmath199 .",
    "there are @xmath212 such functions , but most of these are * not * inference functions .",
    "for instance , consider the binary hmm of length three .",
    "there are @xmath213 boolean functions @xmath214 , but , as we have seen at the end of section 2 , only @xmath75 of these are inference functions for the hmm .    the inference functions @xmath209 of a graphical model @xmath28 are in bijection with the vertices of the newton polytope of the map @xmath28 .",
    "the explanations @xmath215 for a fixed observation @xmath18 in a graphical model are in bijection with the vertices of the newton polytope of the polynomial @xmath192 .    in applications of graphical models ,",
    "the number @xmath25 of parameters and the number @xmath31 of values of the observed random variables is small and fixed , but the number @xmath29 of observed random variables is large .",
    "recall that the model is the image of the map @xmath191 .",
    "hence the dimension of the model remains fixed but the dimension of its ambient space grows exponentially in @xmath29 .",
    "it is therefore algorithmically infeasible to compute the full tropical variety @xmath96 .",
    "what we can do efficiently , however , is to compute the newton polytopes of the @xmath192 , or even the newton polytope of @xmath28 .",
    "this allows us to glean information about the tropical variety from the domains of linearity of its `` coordinate functions '' @xmath203 .",
    "our next goal is to derive an upper bound on the number of vertices of the newton polytopes .",
    "[ smallpolytopebound ] consider graphical models @xmath28 whose number of parameters @xmath25 is fixed and whose number @xmath29 of observed random variables and number of edges @xmath9 varies .",
    "( typically , @xmath9 is a linear function of @xmath29 ) .",
    "then the number of vertices of the newton polytope @xmath216 of @xmath48 is bounded above by @xmath217    for many important families of graphical models , the number @xmath9 of edges is bounded by a linear function in terms of the number @xmath29 of observed nodes , and in those cases we can replace @xmath9 by @xmath29 . hence , for any given observation @xmath211 , the number of explanations grows polynomially in @xmath29 .",
    "for instance , in the hidden markov model of section 2 we have @xmath218 , and a similar relationship holds in the tree model of section 5 .",
    "[ hmmcomplexity ] for any fixed observation in the homogeneous hmm , the number of explanations is at most @xmath219 . if all random variables are binary then the upper bound @xmath220 holds .",
    "the proof of theorem [ smallpolytopebound ] and corollary [ hmmcomplexity ] are derived from the following classical result on lattice polytopes due to andrews @xcite .",
    "the necessary observation is that the newton polytope of @xmath48 is contained in the cube @xmath221^d$ ] , and the volume of this cube equals @xmath222 .",
    "( andrews @xcite ) for every fixed integer @xmath25 there exists a constant @xmath223 such that the number of vertices of any lattice polytope @xmath162 in @xmath102 is bounded above by @xmath224 .",
    "the newton polytope of the map @xmath28 was defined as the minkowski sum of the @xmath59 smaller newton polytopes in theorem [ smallpolytopebound ] . from this",
    "we infer the following naive bound on its number of vertices .",
    "the number of inference functions of a graphical model is at most @xmath225 , hence this number scales at most singly exponentially in the complexity @xmath226 of the graphical model .    consider the homogeneous hmm on binary random variables .",
    "each inference function is a boolean function @xmath227 , but not conversely .",
    "the number of all boolean functions is @xmath228 , which grows doubly exponentially in @xmath29 .",
    "however , the number of inference functions is at most @xmath229 .    in practical applications of graphical models",
    ", it may be infeasible to compute all ( singly - exponentially many ) inference functions .",
    "nonetheless , we believe that important insight can be gained by computing and classifying the newton polytopes of graphical models @xmath28 on few random variables",
    ". such a study would be the polyhedral analogue to the algebraic classification of @xcite .",
    "on the other hand , for a fixed observation @xmath211 , the size of the newton polytope of @xmath192 grows polynomially with the size of the graphical model , and therefore there is hope that the polytopes can be computed efficiently .",
    "despite the fact that the newton polytope of @xmath230 has polynomially many vertices in the size of the graphical model , the number of terms in @xmath230 grows exponentially .",
    "this is a potential problem because the computation of the newton polytope requires inspecting these terms .",
    "the following result states that , in fact , the convex hull computations scales with the running time of the sum - product algorithm , which for many models of interest scales polynomially with the size of the graphical model .",
    "[ polyprop ] the newton polytopes of the polynomials @xmath48 can be computed recursively using the decomposition of @xmath48 according to the sum - product algorithm .",
    "taken together , theorem 7 and proposition 11 say that * polytope propagation is an efficient algorithm for parametric inference with graphical models*. this statement is thesis ( c ) in our companion paper @xcite . in that paper , the sum - product algorithm and the polytope propagation algorithm are explained and analyzed in more detail .",
    "we also demonstrate the practicality of our mathematical theory by explicitly computing ( and statistically interpreting ) various high - dimensional newton polytopes for graphical models that arise in biological sequence analysis .",
    "we conclude by illustrating the concepts we have developed in the context of tree markov models . these are directed graphical models where the graph is a directed tree @xmath231 with observed random variables @xmath30 at the leaves .",
    "the naive bayes model in section 3 is the special case where @xmath232 .",
    "each edge @xmath193 has a different transition matrix @xmath233 $ ] .",
    "we consider the general model in allman and rhodes @xcite , which means that the @xmath234 are arbitrary distinct @xmath235-matrices . in most applications ,",
    "the transition matrices are from a special model family ( e.g. in phylogenetics these may be jukes - cantor model or the hasegawa - kishino - yano model ) .",
    "as before , we relax the hypothesis that transition probabilities are non - negative and sum to @xmath44 .",
    "hence the @xmath236 are distinct unknowns .",
    "for simplicity we shall further assume that the tree @xmath231 is binary .",
    "[ treeobservation ] the general markov model for the binary tree @xmath231 is the image of a map @xmath237 , where each coordinate of @xmath28 is a multilinear polynomial in the unknowns @xmath238 , @xmath193 edge of @xmath239 .",
    "if we denote an edge between nodes @xmath240 and @xmath241 by @xmath242 and @xmath243 is the tree @xmath231 without the leaves , then the coordinate of the multilinear map @xmath28 indexed by an observed sequence @xmath244 can be written as follows : @xmath245 here @xmath246 ranges over all colorations @xmath247 of the nodes such that @xmath248 for all leaves @xmath241 .",
    "our running example in this section is the binary tree in figure [ fig : tree ] with binary random variables @xmath249 .     leaves . ]",
    "-0.4 cm    in this example , the coordinates of the multilinear map @xmath250 are given by the formula @xmath251 the prime ideal @xmath58 of polynomial invariants is generated by the @xmath160-subdeterminants of the matrix @xmath252 thus this particular model is the @xmath253 instance of the determinantal variety in proposition [ threebythree ] .",
    "we generalize the determinantal presentation in this example by proposing the following explicit solution to problem 5 for arbitrary binary trees @xmath231 .",
    "every edge of @xmath231 induces a _ split _ of the set of leaves @xmath254 , corresponding to the two connected components of the tree obtained by removing that edge . the unrooted tree underlying @xmath231 is uniquely determined by the set of these splits .",
    "[ luckydeterminants ] the ideal @xmath58 of phylogenetic invariants of the general markov model for any binary tree @xmath231 on binary random variables is generated by the @xmath160-determinants of all two - dimensional matrices obtained by _ flattening _ the @xmath255-table @xmath256 according to the splits induced by the edges of @xmath231 .",
    "we need to explain the meaning of the word `` flattening '' .",
    "if @xmath257 is any split of the set @xmath258 then this refers to the @xmath259-matrix whose rows and columns are indexed by functions @xmath260 and @xmath261 respectively , and whose entries are the @xmath262 probabilities @xmath8 .",
    "in december 2003 , allman and rhodes announced a proof of the set - theoretic version of our conjecture [ luckydeterminants ] .",
    "what this means algebraically is that @xmath58 equals the radical of the ideal generated by the aforementioned @xmath160-determinants . in light of this progress",
    ", we wish to offer also the following tropical version of conjecture [ luckydeterminants ] .",
    "it would be very nice to show that proposition [ threebythree ] extends to this situation .",
    "however , none of the remaining discussion in this section depends on these conjectures .",
    "[ luckytropical ] the map @xmath28 is surjectively positive for @xmath263 . the tropical variety ( resp .",
    "the positive tropical variety ) of the prime ideal @xmath58 coincides with the set of all @xmath264-tables @xmath265 whose flattenings along the splits of the tree @xmath231 have tropical rank ( resp .",
    "barvinok rank ) at most @xmath163 .",
    "the sum - product algorithm is used in practice to evaluate the polynomial ( [ treemap ] ) .",
    "its running time is linear in @xmath29 , despite the fact that the number @xmath266 of terms in ( [ treemap ] ) grows exponentially .",
    "this reduction in complexity is achieved by recursively grouping subsums .",
    "for instance , ( [ treemapexample ] ) becomes    @xmath267    the rule to remember is this : polynomials are evaluated recursively as sums of products of smaller polynomials .",
    "this is the solution to problem 1 . for details on the tree case",
    "see @xcite .",
    "problem 2 is known in phylogeny as the _ joint ancestral reconstruction _",
    "problem , which asks for the maximum a posteriori ancestral assignments @xmath268 given the observations @xmath269 at the leaves .",
    "an efficient method for solving this problem appears in @xcite .",
    "this method is nothing but the sum - product algorithm with ordinary arithmetic @xmath270 replaced by tropical arithmetic @xmath271 .",
    "the @xmath211-coordinate of the tropicalization @xmath272 of the map ( [ treemap ] ) is @xmath273 this expression can be evaluated efficiently by the same scheme as before .",
    "the rule now is this : piecewise - linear concave functions are evaluated recursively as minima of sums of smaller such functions . a simple example illustrating this rule is the tropicalization of ( [ treemapexample2 ] ) : @xmath274 where @xmath275 and similarly for @xmath276 .",
    "we saw in section 4 that the number of vertices of the newton polytopes of the coordinate polynomials @xmath48 is critical for efficient parametric inference .",
    "that number grows polynomially in @xmath29 if the number of parameters is fixed ( thanks to theorem [ smallpolytopebound ] ) but it may grow exponentially if the number of parameters is not bounded . for the general markov model on a tree @xmath231 , the growth will be exponential unless we restrict the number of parameters .",
    "this can be done , for instance , by considering the _ homogeneous tree model _ where the transition matrices along all edges are identical : @xmath277 using theorem [ smallpolytopebound ] , we obtain the following result analogous to corollary [ hmmcomplexity ] .",
    "the number of vertices of the newton polytope of any coordinate @xmath48 in the homogeneous tree model is bounded above by @xmath278 times a constant depending only on @xmath31 .    for tree models which are used in applications , such as phylogenetics ,",
    "the number of parameters is likely to be reduced even further . in such cases ,",
    "the parametric joint ancestral reconstruction problem can be solved efficiently using the polytope propagation algorithm techniques in proposition [ polyprop ] .",
    "the algebraic representation for graphical models with hidden variables leads naturally to an interpretation of a parameterized model as a point on an algebraic variety .",
    "marginal probabilities are coordinates of points on the variety .",
    "varieties can be tropicalized , and the statistical meaning is that the map probabilities ( calculated with logarithms of the parameters ) can be interpreted as coordinates of points on the positive part of the tropical variety . hence",
    ", the tropical model is fundamental for understanding map probabilities .",
    "although we have not addressed it in this paper , the logarithms of the marginal probabilities are coordinates of points on the _ amoeba _ @xcite of the model .",
    "amoebas are likely to be important for understanding the geometry of maximum likelihood estimation .",
    "the sum - product algorithm for graphical models is an efficient method for evaluating the coordinate polynomials of a graphical model .",
    "this algorithm works in exactly the same way for classical arithmetic @xmath270 and for tropical arithmetic @xmath279 .",
    "this means that the same method is used to evaluate coordinates of points on the variety and of points on the tropical variety .",
    "an explanation for an observation @xmath18 is a vertex of the newton polytope of @xmath192 .",
    "thus , the parametric inference problem is solved by finding the normal fans of the newton polytopes of the coordinate polynomials . for many important applications ,",
    "the number of vertices of the polytopes is polynomial in the size of the graphical model .",
    "the polytope propagation algorithm , which is a geometric analog of the sum - product algorithm , finds the newton polytopes , and is efficient when the sum - product algorithm is fast and the number of vertices on the newton polytopes is small .",
    "an inference function for a graphical model is a function from the set of observations to the set of explanations which maximizes the a posteriori probabilities with respect to some choice of parameters .",
    "inference functions correspond to vertices of the newton polytope of the map @xmath28 .",
    "this polytope is much larger than the newton polytope of a single coordinate @xmath48 , so it can only be computed for small graphical models , but it has the advantage that it encodes the entire piecewise - linear geometry of the model .    in a companion paper @xcite",
    ", we show that polytope propagation is practical and useful in the important application of biological sequence analysis . in particular , existing parametric alignment methods @xcite",
    "can be viewed as special cases of parametric inference for pair hidden markov models .",
    "the computation of the newton polytopes is also useful for bayesian computations , where we have priors on the parameters and it is of interest to integrate over the maximal cones in the normal fan of the newton polytope @xcite .",
    "lior pachter was supported in part by a grant from the nih ( r01-hg02362 - 02 ) .",
    "bernd sturmfels was supported by a hewlett packard visiting research professorship 2003/2004 at msri berkeley and in part by the nsf ( dms-0200729 ) .",
    "we are grateful to komei fukuda , michael joswig and kristian ranestad for their help in obtaining the computational results reported in section 2 .",
    "26 g.  andrews : a lower bound for the volume of strictly convex bodies with many boundary points , trans .",
    "106 ( 1963 ) 270273 .",
    "e.  allman and j.  rhodes : phylogenetic invariants for the general markov model of sequence mutation , mathematical biosciences , 186 ( 2003 ) 113144 .",
    "s. aji and r. j. mceliece : the generalized distributive law , ieee transactions on information theory 46 ( 2000 ) 325343 .",
    "p. baldi and s. brunak : bioinformatics . the machine learning approach . a bradford book . the mit press .",
    "cambridge , massachusetts 1998 .",
    "j. cavender and j. felsenstein : invariants of phylogenies in a simple case with discrete states , journal of classification 4 ( 1987 ) 5771",
    ". j.  cohen and u.  rothblum : nonnegative ranks , decompositions , and factorizations of nonnegative matrices , linear algebra appl . 190 ( 1993 )",
    "david cox , donal oshea and john little : ideals , varieties and algorithms , springer undergraduate texts in mathematics , 1996 .",
    "m. develin , f. santos and b. sturmfels : on the tropical rank of a matrix , preprint , http://front.math.ucdavis.edu/math.co/0312114 .",
    "m. develin : the space of @xmath24 points on a tree with @xmath29 leaves , preprint . .",
    "r. durbin , s. eddy , a. krogh and g. mitchison : biological sequence analysis ( probabilistic models of proteins and nucleic acids ) , cambridge university press , 1998 .",
    "d. fernndez - baca , t. sepplinen and g. slutzki : parametric multiple sequence alignment and phylogeny construction , in combinatorial pattern matching , lecture notes in computer science ( r. giancarlo and d. sankoff eds . ) , vol .",
    "1848 , 2000 , 6882 .",
    "garcia , m. stillman and b. sturmfels : algebraic geometry of bayesian networks , journal of symbolic computation , to appear , http://front.math.ucdavis.edu/math.ag/0301255 .",
    "d. gusfield , k. balasubramanian , and d. naor : parametric optimization of sequence alignment , algorithmica 12 ( 1994 ) 312326 .",
    "f. kschischang , b. frey , and h. a. loeliger : factor graphs and the sum - product algorithm , ieee trans .",
    "theory 47 , feb 2001 , 498519 .",
    "jordan and y. weiss : graphical models : probabilistic inference , in _ handbook of brain theory and neural networks , 2nd edition _ , m. arbib ( ed . ) , cambridge , ma , mit press , 2002",
    ". t. pupko , i. peer , r. shamir , and d. graur : a fast algorithm for joint reconstruction of ancestral amino acid sequences , molecular biology and evolution 17 ( 2000 ) 890896 .",
    "j. richter - gebert , b. sturmfels , and t. theobald : first steps in tropical geometry , in idempotent mathematics and mathematical physics ( eds .",
    "litvinov and v.p .",
    "maslov ) , american mathematical society , 2004 , preprint posted at http://front.math.ucdavis.edu/math.ag/0306366 .",
    "l. pachter and b. sturmfels : parametric inference for biological sequence analysis , companion paper , submitted .",
    "g.  pistone , e.  riccomagno , and h.p .",
    "wynn : algebraic statistics : computational commutative algebra in statistics , chapman and hall , boca raton , florida , 2001 .",
    "l. r.  rabiner : a tutorial in hidden markov models and selected applications in speech recognition , proc . of the ieee , 77 ( 1989 ) 257286 .",
    "d.  speyer and l.  williams : the tropical totally positive grassmannian , preprint , http://front.math.ucdavis.edu/math.co/0312297 . b. sturmfels : grbner bases and convex polytopes , university lecture series , vol . 8 , american mathematical society , 1996 . o.  viro : what is an amoeba",
    "?  notices of the american math .",
    "society 49 ( 2002 ) 916917 .",
    "m. waterman , m. eggert and e. lander : parametric sequence comparisons , proc . natl . acad .",
    "usa 89 ( 1992 ) 60906093 .",
    "d. west : acyclic orientations of complete bipartite graphs , discrete math .  138 ( 1995 ) 393396 ."
  ],
  "abstract_text": [
    "<S> this paper presents a unified mathematical framework for inference in graphical models , building on the observation that graphical models are algebraic varieties . from this geometric viewpoint , </S>",
    "<S> observations generated from a model are coordinates of a point in the variety , and the sum - product algorithm is an efficient tool for evaluating specific coordinates . </S>",
    "<S> the question addressed here is how the solutions to various inference problems depend on the model parameters . </S>",
    "<S> the proposed answer is expressed in terms of tropical algebraic geometry . </S>",
    "<S> a key role is played by the newton polytope of a statistical model . </S>",
    "<S> our results are applied to the hidden markov model and to the general markov model on a binary tree . </S>"
  ]
}