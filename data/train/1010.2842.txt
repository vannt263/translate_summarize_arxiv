{
  "article_text": [
    "quantitative genetics aims to explain and describe the response of a heritable trait to selection , but in the classical approach , dispensing with the genetic details that account for that heritability ( lande 1979 ; turelli 1988 ; lynch and walsh 1998 ) . yet ,",
    "population genetics tells us that such responses can not be predicted without knowing those genetic details ( turelli 1988 ; barton and turelli 1987 ; b \" urger 2000 ) .",
    "paradoxically , we can indeed make such predictions from empirical measurements of traits , but only by assuming that the genetic variance ( the variance of the trait caused by genetic differences ) is fixed : changes in variance due to selection have been hard to predict ( e.g. hill 1982 ; zhang and hill 2010 ) .    directional selection ( ds )",
    "will usually allow a quick response at the cost of the depletion of genetic variance , which will ultimately be due to mutation around a unique optimal genotype ( b \" urger 2000 , ch iv ) . however , most traits are thought to be under some kind of stabilizing selection ( ss ) , in which case the genetic variance will be reduced by fixing any one of the many genotypes that match the optimal value ( wright 1935a ; bulmer1972 ; barton 1986 ) . in order to understand the full stochastic model , that is a polygenic trait under ss , mutation and drift the goal of this article we first summarize the theory for infinite populations ( wright 1935a 1935b ; barton 1986 ) , where random fluctuations are absent , and evolution is deterministic .    for simplicity , we assume that each gene has only two alternative states ( termed _ alleles _ ) . when mutation ( @xmath0 ) is much weaker than the selection ( @xmath1 ) on each allele",
    ", the trait mean converges to the optimum , because any genetic locus can be almost fixed for either allele ( i.e. , allele frequencies are close to 0 or 1 ) . thus , there will be many stable equilibria for the whole set of loci , at which any genotype that matches the optimum is near fixation - there are degenerate genetic states for a trait mean matching the optimum . assuming that there are enough genes ( @xmath21 ) , the genetic variance is then roughly @xmath3 ( barton and turelli 1987 ) .",
    "when this variance is much greater than the maximum that can be contributed by any one locus ( barton 1986 ) , its increase due to a substitution at any one locus is much smaller than the existing variance , as we expect to be the case for a trait that is influenced by many genes . in this regime , there are many sub - optimal stable equilibria , for which the genotype that is close to fixation does not quite match the optimum .",
    "for example , if the optimum is at zero , then with 100 loci , there are @xmath4 equilibria that match this precisely , but asymmetrical equilibria with 49 @xmath5-@xmath5 and 51 @xmath5+@xmath5 loci may also be stable . however , selection adjusts the frequencies of rare alleles with these asymmetrical combinations , such that the mean is still very close to the optimum , but the genetic variance is substantially higher , and the mean fitness is lower as a consequence ( barton 1986 ) .",
    "imagine that the population is initially at an @xmath5optimal@xmath5 equilibrium , which maximizes mean fitness .",
    "if the optimum now shifts , the population will stay near fixation for the original genotype , and so the genetic variance will inflate as allele frequencies adjust to keep the mean near the optimum . at some point ,",
    "the equilibrium becomes unstable , one or more loci substitute , and the genetic variance drops abruptly .",
    "if all alleles have the same effect , as assumed so far , then variance will inflate at many loci , and so may become very high ( fig .",
    "[ fig : deterministcexample ] ) .",
    "however , with unequal effects , the loci with smallest effect will substitute first , and the overall fluctuation will be much smaller .     towards @xmath6 acting on an additive trait , with @xmath7 loci of effect @xmath8=1 ; the mutation rate is @xmath0=0.002 per locus , which maintains a genetic variance of @xmath9 . the optimum",
    "then shifts abruptly to @xmath10 , and the mean responds almost immediately ( top , middle ) . the variance increases abruptly ( top right ) as , the allele frequencies at all the @xmath5-@xmath5 loci increase substantially ( a , lower left region ) .",
    "however , this new state is unstable , and slight variations in the initial conditions cause some loci to shift down , and some to shift up . as a result , the genetic variance returns to its original value .",
    "the lower row shows snapshots of allele frequencies at times ( d ) 0 , ( e ) 800 and ( f ) 3000 generations . ]",
    "if the trait mean lags far behind the current optimum , we would expect to see erratic trajectories in an infinite population because of the following two points :    1 .",
    "very rare alleles will increase , and will sweep through at an unpredictable time that depends on their initial frequency .",
    "the various and phenotypically equivalent combinations of alleles are reorganized when the phenotypic optimum takes a new value , transiently inflating the variance , as explained above .",
    "we envisage three factors that smooth potentially erratic phenotypic paths .",
    "first , if the effects of alleles vary across loci , there is the opportunity to make smaller steps as the optimum changes , which alleviates pronounced and coincident changes in allele frequencies , and diminishes the excess variance as the phenotypic optimum moves .",
    "second , if we average over all the possible genetic combinations that match the phenotypic optimum , then we expect that the speed and direction of the response to a change in optimum will be more regular .",
    "third , if the population is finite , random drift will on the one hand homogenize the initial distribution of allele frequencies , alleviating point _ i _ above , and on the other , facilitate transitions between @xmath5adaptive peaks@xmath5 , alleviating point _ ii _",
    ", so that the population can evolve without being trapped at local equilibria , as in wright s ( 1931b ) @xmath5shifting balance@xmath5 . also , note that under drift , plus weak mutation , allele frequencies @xmath11 are distributed as @xmath12^{-1}$ ] , a special case in which the genetic variance stays constant under ds ( since with this distribution , the increased variance due to rare alleles that become common is baalnced by the loss of variance from common alleles that become rare ) . here , rare alleles replenish variance at the same rate as common alleles are fixed .",
    "measurable quantitative genetic variables are not sufficient to predict response to selection : the dynamics of the trait mean and of the genetic variance under selection depend on allele frequencies .",
    "we can use moments instead , but their dynamics depend on higher moments , and we end up requiring as many variables as allele frequencies ( barton and turelli 1987 ; b \" urger 1991 1993 2000 ; turelli and barton 1994 ) . in part , this problem arises from _ i _ and _ ii _ above .",
    "surprisingly , including a third evolutionary process , random genetic drift , allows us to employ a different mathematical toolbox ( from physics statistical mechanics , sm ) to make reliable predictions .",
    "although we can no longer predict a single trajectory in detail , we can instead predict expectations over the ensemble of trajectories .",
    "thus , we will focus on the second and third factors mentioned above , namely the averaging over allele frequencies that is caused by random genetic drift .",
    "the need to specify the detailed genetic state is avoided by the development of an analogy between sm and population genetics ( pr \" ugel - bennet and shapiro 1994 ; 1997 ; rattray 1995 ; pr \" ugel - bennet 1997 ; rogers and prgel - bennett 2000 ) . in these works ,",
    "information entropy ( shannon , 1948 ) was maximized under the assumption that any initial state was a priori equally likely .",
    "however , this choice of prior is not based on population genetics : we know that states are not equiprobable under random genetic drift , because in a finite population , fluctuations bias the neutral distribution towards the boundaries .",
    "further work developed this idea in detail , tailoring an entropy measure that ensures that the equilibrium distribution matches the stationary solution to the diffusion equation ( barton and de vladar 2009 , barton and coe 2009 ) .",
    "this allows us to collapse an arbitrary number of degrees of freedom that can not be accurately known ( e.g. allele or genotype frequencies , central moments , cumulants , etc . ) into a few variables , which approximate the whole stochastic system .",
    "the theory is built in two stages .",
    "first , we observe that a measure of _ entropy _ is maximized at equilibrium , subject to constraints on the expectations of the macroscopic variables ( barton 1989 ; aita et al 2004 2005 ; sella and hirsch 2005 ; barton and de vladar 2009 ) .",
    "( alternatively , we can define a @xmath5free fitness@xmath5 as the entropy divided by population size , plus the mean fitness , which is maximized at equilibrium under selection and drift ; this is analogous to free energy in thermodynamics ( iwasa 1988 , barton and coe 2009 ) ) .",
    "although entropy is a concept alien to population genetics , it summarizes two fundamental aspects of the equilibrium distribution . on the one hand , it measures the degree of divergence of the distribution of the allele frequencies from a neutral base distribution .",
    "on the other hand , the entropy couples two sets of variables , the _ microscopic _ that in this case we take to be the allele frequencies , and the _ macroscopic _ that are the expectations of quantitative variables .    generally speaking , the sm approach takes advantage of genetic drift in two ways . to start with",
    ", drift is expected to spread the trajectories relaxing the problem of trapping at local fitness optima , just as envisaged by wright ( 1932 ) . to follow , instead of calculating the values of metric characters themselves ",
    "these are stochastic variables it makes predictions for their expectations .",
    "although we are free to apply any kind of selection , it is crucial that it act only on the chosen macroscopic variables .",
    "that is , we can not assume that selection will act on specific genotypes , because then , selection could favour arbitrary and improbable macroscopic states : the maximum entropy ansatz would be contradicted , and would inevitably fail to give accurate predictions .",
    "for example , if we force the population to a specific set of allele frequencies , @xmath13 , then under directional selection @xmath14 there would be sudden jumps at times @xmath15 @xmath16 , as alleles reach high frequency .",
    "the distribution of allele frequencies like any statistical distribution is formally a function of a set of parameters . in population genetics",
    ", it typically depends on the selection coefficients , mutation rate , and population size , and the distribution of macroscopics can be calculated from these , using the diffusion approximation .",
    "this averaging over the microscopic variables has the fortunate consequence that the distribution of macroscopics , as well as their rates of evolution , do not explicitly depend on the allele frequencies , although their distribution is in fact estimated implicitly by maximizing the entropy .",
    "this averaging is not straightforward under stabilizing selection , because there is epistasis for fitness , which fully couples the distribution of allele frequencies .",
    "however , the calculations can be greatly simplified because under the central limit theorem , the distribution of the macroscopic variables , conditioned on a particular value of the trait mean , will be approximately gaussian .",
    "this will allow us to eliminate any explicit dependence on the allele frequencies , and gives workable expressions for the expectations .    .",
    "second , we make a quasi - equilibrium approximation , which assumes that even during periods of change , the distribution of allele frequencies adopts a shape that takes the form of an equilibrium distribution , whose parameters are chosen so that the distribution matches the current macroscopic variables .    in this framework",
    ", we can describe the state of the population by two complementary sets of variables : the expectations of the chosen macroscopics @xmath17 , and the corresponding selective forces on these macroscopics .",
    "this is precisely analogous the complementary set of variables ( forces and variables of state ) in statistical mechanics . rather than working with the rates of evolution of the macroscopic variables",
    ", we can calculate the rates of change of the evolutionary forces .",
    "consequently , we can find the expectations of the quantitative variables at any time , and thus know their evolutionary trajectory .",
    "if parameters change sufficiently slowly , the ensemble will be close to an equilibrium distribution , as with reversible changes to a physical system .",
    "when parameters change quickly , however , nothing ensures that the distribution will be close to some stationary distribution .",
    "thus , the present work aims in part to verify this assumption , by comparing the results with numerical simulations .",
    "the mathematical details of this method are explained in detail by barton and de vladar ( 2009 ) .",
    "a crucial advantage of the sm method is that it avoids the recursion to higher moments ( or cumulants ) of the traits , where higher order terms must be neglected arbitrarily ( barton and turelli 1987 1990 ; b \" urger 1991 1993 2000 ; turelli and barton 1994 ; rattray and shapiro 2001 ) : the key is the choice of an appropriate set of macroscopics , which is determined by the set of traits hat determine fitness .    previously , we have successfully applied these ideas to the much simpler case of ds on a polygenic trait subject to mutation and drift ( barton and de vladar 2009 ) . there , our predictions are accurate for many loci of arbitrary effects . however , under ds solving the problem for a trait with @xmath18 loci amounts essentially to solving the problem for a single locus , since there is no coupling between loci .",
    "thus it is to some extent , a trivial case . -",
    "though not entirely so , because maximum entropy still drastically collapses the degrees of freedom from the full allele frequency distribution to only two , the trait mean , and the log - heterozygosity ( eq . [ eq : geneticvariability ] ) .",
    "a more demanding situation , and of deep biologically relevance , is ss , which is the main focus of our present work .",
    "we will study whether the sm method applies to the challenging case of ss , mutation , and drift .",
    "in particular , we will develop the details using gaussian ss as a model .",
    "we analyze sharp changes in the optimum , a steadily moving optimum , and changes in selection on the genetic variance .",
    "we assume throughout that recombination is fast relative to selection , mutation and drift , so that we can assume linkage equilibrium , and describe the population by its allele frequencies .",
    "we also assume that populations size is not small , so that we can use the diffusion approximation .",
    "the fitness of an individual with trait @xmath19 is given by @xmath20 = -\\frac{\\mathit{s}}{2}\\left(z - z_o\\right ) ^2 $ ] , which penalizes deviations from the optimum @xmath21 , since the extremes are unfit .",
    "notice that this expression can be written as @xmath22@xmath23 .",
    "the first term suggests that individuals that deviate from the mean of the population have less fitness .",
    "the second term is the deviation of the trait mean from the optimum .",
    "the mean log fitness is thus @xmath24 } \\sim   \\log \\left[\\bar{w}\\right]\\simeq -\\frac{\\mathit{s}}{2}\\nu -\\frac{\\mathit{s}}{2}\\left(\\bar{z}-z_{\\text{opt}}\\right ) ^2 $ ] .",
    "here we neglect terms @xmath25 , and the third term above averages to zero . for further convenience ,",
    "we expand the quadratic term , and express it as @xmath26=\\sigma \\nu + \\beta \\bar{z}-\\lambda \\bar{z}^2 $ ] + const .",
    "this is essentially the same , but where selection is acting @xmath5independently@xmath5 over three quantitative variables : selection ( of strength @xmath27 ) against the genetic variance , @xmath28 ; a directional term of strength @xmath29 ( @xmath30 ) regressing the mean trait @xmath31 to the optimum , and selection against deviations from the actual mean ( of strength @xmath32 ) .",
    "most works consider that @xmath33 , but here this constraint will be relaxed and allow @xmath27 and @xmath32 to differ , in order to improve the quasi equilibrium approximations , as will become clear later .",
    "we can think of examples , such as sexual selection or resource exploitation , where the individuals that deviate too much from the population s current mean value are unlikely to leave offspring , or selection might act directly on heterozygotes ( and hence directly on @xmath28 ) .",
    "of course , in some of these cases , selection might be frequency - dependent , in which case we will not have a stationary distribution that is of potential form , and the following analyses might not hold .",
    "however , we will keep these issues aside and concentrate on the simpler case of frequency independent selection , but allowing selection on the variance and on the deviation of the trait mean ( factors @xmath27 and @xmath32 , respectively ) to differ .",
    "+ we will assume that selection is weak relative to recombination , so that linkage equilibrium holds . then , if the population is moderately large , the evolution of the frequency @xmath34 of a beneficial allele at each locus can be described by @xmath35}{\\partial p}-\\mu ( 2p-1)+\\zeta _ d\\ ] ] where @xmath0 is the mutation rate ( assumed to be reversible and equal in both directions ) , and @xmath36 is the stochastic term due to drift , modelled as a gaussian of mean zero and variance @xmath37 where @xmath38 , and @xmath39 is the effective size of the population .",
    "notice that @xmath40 depends on @xmath41 and so couples the dynamics at all loci , something that does not occur under ds .",
    "in other words , fitness is essentially epistatic .    at equilibrium , this process has the joint distribution of allele frequencies , @xmath42 ( wright 1931 ; kimura 1965 ; crow and kimura 1970 , pp .",
    "442 ) : @xmath43}{\\mathbb{z } \\prod _ { i=1}^n p_iq_i}\\ ] ] which is identical to the more familiar expression @xmath44 but arranged in a different way . the quantity @xmath45 normalizes the distribution .",
    "( from now on , we will use bold characters to denote vectors , and script capitals to denote matrices ) . as explained before ( barton 1989 ; barton and de vladar 2009 ; barton and coe 2009 ) , we describe the effects of mutation by a potential function @xmath46 , which is essentially the log of the geometric mean heterozygosity : @xmath47\\ ] ]",
    "thus we have a set of macroscopic variables @xmath48 that is associated with the parameters ( forces ) = @xmath49 , @xmath32 , @xmath27 , @xmath50 .",
    "both together completely determine the distribution of allele frequencies . at first sight",
    "it might seem that specifying both @xmath31 and @xmath41 is redundant .",
    "however , the latter introduces epistasis to the fitness function , making it non - multiplicative . but also",
    ", since it is their expectations that constrain the entropy , both terms are necessary to couple the microscopic and macroscopic variables , and thus to determine the expectations of the mean and the variance of the trait .",
    "so far , we made no assumptions about the trait .",
    "the set of variables just defined , , depend arbitrarily on the allele frequencies .",
    "we will assume now some elementary properties .",
    "each trait is composed of a pair of alleles ( thus we are assuming diploids ) that contribute additively , each with an effect @xmath51 .",
    "the labels _ x _ denote different alleles ( _ _ x__=0,1 ) . under this model , the trait , its mean , and its variance in the population are respectively @xmath52    defined this way , the trait is in the range of @xmath53 , and the genetic variance is in @xmath54 , with @xmath55 . if we assume that all loci have equal effects @xmath8 , then @xmath56 , and @xmath57 .",
    "without loss of generality , we will assume @xmath8=1 .",
    "we can always include @xmath58 by scaling @xmath59 and @xmath60 .    along this article",
    ", we assume that mutation ( @xmath0 ) is weaker than selection ( @xmath1 ) on each allele , that is @xmath61 .",
    "but at the same time , since we require that the standing genetic variance is grater than the variance due to a substitution , we will work in the regime of @xmath62 ( barton 1986 ) , which ensures that there are many stable genetic equilibria .",
    "in our previous work , we explained in detail how the distribution in eq .",
    "( [ eq : distributionallelefrequencies ] ) can be derived by maximizing a particular entropy measure ( barton and de vladar 2009 ) . in population genetics ,",
    "this uncertainty measures the possible states in which a population can be .",
    "it is a functional of the distribution of allele frequencies @xmath63 ( ) .",
    "we need to employ an information entropy measure which is defined relative to the distribution under drift alone ( barton and de vladar 2009 ; barton and coe 2009 ) .",
    "that is , in the absence of any other evolutionary factor , random drift would drive the evolution of the population towards the distribution@xmath64 , which is a u - shaped distribution ( wright 1931 ) .",
    "in fact , @xmath65 is not properly a distribution because it can not be normalized .",
    "nevertheless , under drift alone @xmath65 is the solution to the diffusion equation ( kimura 1962 ) , and we will set entropy so that with a base distribution @xmath65 , it gives the correct stationary distribution with mutation and selection .",
    "accordingly , we defined the entropy as @xmath66    when _ s _ is maximized with respect to @xmath63 we get that @xmath67 .",
    "although @xmath65 will diverge when _ _",
    "pq__@xmath680 , imposing constraints on _ s _ will ensure that this is not a problem .",
    "this particular entropy measure was postulated to ensure that the distribution of allele frequencies corresponds to the one obtained by the diffusion methods , i.e. eq . ( [ eq : distributionallelefrequencies ] ) .",
    "however , the probability distribution is changed in the presence of , say , mutation and/or selection .",
    "thus , entropy changes under any other factor that affects the evolution of a character or of fitness , like selection or mutation , because these increase or decrease the uncertainty of the outcomes , biasing the distribution @xmath63 . to include these effects , we require that the distribution of allele frequencies must have specific values for the expectations @xmath69@xmath70",
    ". this is introduced in the form of constraints to the entropy maximization problem , and thus we introduce a lagrange multiplier @xmath71 for each constraint @xmath72 .",
    "thus , we need to maximize the following functional ( on @xmath63 ) : @xmath73 here the third term ensures normalization of the distribution .",
    "this leads exactly to the distribution of allele frequencies in eq .",
    "( [ eq : distributionallelefrequencies ] ) , and thus the lagrange multipliers are the forces ( selective coefficients , and mutation rate ) .",
    "the normalization condition is : @xmath74 \\phi ( \\pmb{p})d^n\\pmb{p } , \\ ] ] where we renamed the multiplier @xmath75@xmath76 .",
    "this quantity is a function of the parameters @xmath77 and it is analogous to the _ partition function _ in statistical physics .",
    "it plays a fundamental role , because it allows direct calculation of the macroscopics , as well as their covariances , since log[@xmath45 ] is a generating function : @xmath79=2n\\langle \\pmb{a}\\rangle $ ] , and @xmath80=4n^2\\mathcal{c } $ ] , where @xmath81 is the covariance matrix of the macroscopics .",
    "these expectations and covariances are with respect to the distribution @xmath63 , that is across possible states of a population , or alternatively with respect to an ensemble of populations , and must not be confused with the means and variances of a trait within a population .",
    "the technical effort focuses on a workable calculation for @xmath45 , which will lead to expressions for the rates of change of the and the @xmath82 .",
    "in general , any vector of quantitative variables , in our case @xmath83 , that is a function of the allele frequencies will have an expectation ( macroscopic ) that evolves as @xmath84 where @xmath85 is a generalized matrix of genetic covariances , and the rate of random drift ; @xmath86 and @xmath87 .",
    "these formulas can be derived straightforwardly in several ways .",
    "the most compelling for a biologist is to use wright s ( 1937 ) formula , via the diffusion equation ( ewens 1979 , pp .",
    "136 - 137 ) , or from the fokker - planck equation ( for eq .",
    "[ eq : wright - fishermodel ] ; gardiner 2004 , ch . 5 ) .",
    "neither , @xmath85 , nor @xmath88 ( defined above ) assume additive or equal effects .",
    "however to obtain specific expressions we need to make some assumptions .",
    "we will now assume additivity , for which we get @xmath89 and @xmath90    these expressions are valid also under unequal effects .",
    "( the unfamiliar macroscopics involved , namely @xmath91 and _ h _ are specified in appendix 1 ) .",
    "note that the sm method provides a way of directly calculating the expectations of these quantities , as well as of the higher moments of the trait : they follow from mathematical manipulations of the generating function @xmath45 ( barton and de vladar 2009 ) .",
    "this is one of the most important improvements from the sm method with respect to other moments or cumulant methods where these higher order moments have to be computed _ ab initio _ using their particular differential equations , and approximated using specific models , like the gaussian or house of cards models ( barton and turelli 1989 ) , perturbation analysis ( rattray and shapiro 2001 ) , and/or simply by truncating the equations at a convenient level ( barton and turelli 1987 ; b \" urger 1991 1993 2000 ; turelli and barton 1994 ; rogers and pr \" ugel - bennett 2000 ) . + under the quasi - equilibrium approximation , we assume that at every time point there is a set of variables @xmath92 ( for short , @xmath93 ) which would give the observed @xmath69@xmath70 at a steady state , so that @xmath94 ; then @xmath95 .",
    "thus , the matrix @xmath85 in eq .",
    "( [ eq : globalrateofchange ] ) is approximated by its equilibrium expression , but evaluated at @xmath93 , denoted @xmath96 .",
    "then , substituting into eq .",
    "( [ eq : globalrateofchange ] ) , we get that @xmath97 .",
    "since the matrix @xmath96 depends only on the @xmath93 , and the latter are calculated at every time point following the assumption of maximum entropy ( see barton and de vladar 2009 for more details on the implementations ) , we are able to make predictions for the long term response to selection of the expected trait mean and of the expected genetic variance .",
    "the function @xmath45 ( eq . [ eq : defpartitionfunction ] ) is a multidimensional integral over the frequencies at the @xmath18 loci .",
    "these integrals are coupled , because the function @xmath41 is not separable into additive terms .",
    "thus , in this section we will focus on an approximation for @xmath45 . to begin with , we recall that wright s formula ( 1937 ; eq .",
    "39 ) implies that we can always express @xmath98 as @xmath99 , where @xmath100\\left(p_iq_i\\right)^{4n\\!\\mu-1 } $ ] is the distribution of the system free of selection over the trait mean .",
    "thus we include the effects of drift , mutation ( @xmath0 ) , and also of selection on the genetic variance ( @xmath27 ) ; these are all additive terms . because @xmath101 ( when normalized ) is a product of per - locus distributions , the central limit theorem indicates that with many loci , @xmath101 will converge to a gaussian ( appendix 1 ) .",
    "furthermore , the contribution of each locus is typically bimodal , where each peak is close to the borders .",
    "hence , we have @xmath102 adaptive peaks , which correspond to all the combinations of @xmath5+@xmath5/@xmath5-@xmath5 alleles . in order to gain accuracy ,",
    "we expand as a gaussian not the whole distribution @xmath101 , but rather the distribution around each of the adaptive peaks , by dividing the range of each allele frequency into two regions . under equal effects , there can be _",
    "m _ and _ n - m _ loci near 0 and 1 , respectively , weighted by a binomial term ( appendix 1 ) .",
    "each peak will be characterized by its expected mean trait values and variances .",
    "because of the symmetry under equal effects , at each peak the contribution to the expected mean of each allele is equivalent in magnitude , @xmath103 , and of opposite sign for the @xmath5+@xmath5 and @xmath5-@xmath5 peaks ( the trait mean is an odd function of the allele frequencies ) .",
    "thus , for a given combination ( _ m ,",
    "n - m _ ) the expected trait mean results in @xmath104 .",
    "similarly , the variance contributed by each peak is , per locus , @xmath105 , so that for a combination ( _ m , n - m _ ) results in @xmath106 ( the variance being an even function of the allele frequencies ) . in the same way",
    ", we may include the expectation of other quantities ( @xmath28,_u _ , etc .",
    ", altogether denoted by ) along with their variances and covariances . defining @xmath107 , the covariance matrix of at a given peak with configuration ( _ m , n - m _ ) , we approximate @xmath101 as a multivariate gaussian , namely :    @xmath108\\ ] ]    where _ k _ is the number of variables included in the gaussian approximation ; in practice , we employed _ _",
    "k__=5 variables , namely those required to compute @xmath85 , which are = @xmath109@xmath110@xmath111 .",
    "@xmath112 is the normalization constant of this gaussian approximation , which for equal effects is @xmath112 = @xmath113 , which in turn is the generating function for @xmath18 independent single loci at an adaptive peak ( appendix 2 ) : @xmath114(p   q)^{4n\\!\\mu-1}dp .\\ ] ]    after making this approximation , we need to multiply the resulting gaussian distribution by the effects of selection , as specified by the mean fitness @xmath115 $ ] , and integrate on @xmath31 , in order to get @xmath45 .",
    "appendix 1 indicates the details and the intermediate steps in the derivation ( which we work out for unequal effects , when the complexity of the calculation allows it ) . in short",
    "we find that the generating function is @xmath116 \\times \\sum _ { m=0}^n \\left ( \\begin{array}{c }   n \\\\",
    "m \\end{array } \\right)\\exp\\left[-\\frac{4 m n}{1 + 4n\\!\\lambda n v_o}\\left(n\\!\\beta -2 n\\!\\lambda ( n-2m)m_o\\right)\\right]\\ ] ]",
    "the expectations of the macroscopics follow from the derivatives of log[@xmath45 ] w.r.t .",
    "the parameters as explained above , all of which can be written explicitly ( see appendix 1 ) . in practice because @xmath18 is large , the binomial terms @xmath117 are computed by approximating them by a gaussian , and the binomial sum by an integral , thus : @xmath118 f_{(m ) } dm\\ ] ] which allows computations that can be handled numerically ( appendix 1 ) . in the following sections , we study the accuracy of our approximations .",
    "exact analysis of the distribution of allele frequencies is in theory possible using a diffusion equation approach ( crow and kimura 1970 , ch .",
    "7 ) . but for many coupled loci , as in this case of ss , the time - dependent analytic solution is unknown , and its numerical calculation is not feasible short of monte carlo methods that would amount to simulation of the original problem .",
    "thus , the possibilities to check our method are reduced to either simulating allele frequencies , or to employ individual based simulations .",
    "we take the first approach , that is to draw multiple realizations of eq .",
    "( [ eq : wright - fishermodel ] ) , each giving a stochastic path of the allele frequencies , employing in our purposes an euler scheme with time step @xmath119t=0.01 , and drawing deviates from a gaussian with variance @xmath120 for the stochastic term modeling genetic drift ( e.g. higham 2001 ) . from these paths",
    ", we compute the trait mean and its genetic variance .",
    "then , we can average over multiple realizations in order to estimate the expectations of these variables .",
    "we ignore linkage disequilibrium , but know that this is negligible for recombination rates _",
    "@xmath121 @xmath1 ( b \" urger 2000 , ch .",
    "thus we work entirely from the diffusion approximation to the evolution of allele frequencies , assuming that selection is weak ( @xmath1 @xmath122 _ r_,1 ) .",
    "our statistical mechanical approach assumes that evolution starts from an initial equilibrium ; it does not allow arbitrary initial distributions that would give arbitrary outcomes .",
    "therefore , for a fair comparison , we need to start the numerical realizations also from an equilibrium , drawing an initial set of allele frequencies from the theoretical marginal distribution . because the joint distribution of allele frequencies and the product of the marginals are not the same , we still allow the process to relax to the stationary state for a few thousands of generations ( typically , @xmath123 ) , until numerically we obtain that @xmath124 .",
    "only then we allow selection to change . from this moment ,",
    "when evolution proceeds , we average and record the values to compare them later with the sm estimate .",
    "+ in order to perform this comparison , we perform a significance test .",
    "the null hypothesis @xmath125 is that the numerical calculations are not significantly different from the sm expectations .",
    "thus to support our theory , we would like to accept @xmath125 . because the numerical expectations are averages over many realizations , these are normally distributed .",
    "from the sm theory we know the expectation and the variance of the macroscopics that we want to test , namely , the trait mean and the genetic variance .",
    "summing - up , we know the expected values and the variance and thus , ideally the residuals should be normally distributed .",
    "hence , a _",
    "z_-test for the goodness of fit is enough for our purposes ( cox and hinkley 1974 , ch .",
    "z-__statistic is @xmath126 , where @xmath127 are the averages over the simulations , @xmath128 is a short - hand notation for @xmath129 ( the expectation of _ a _ evaluated at the local forces at time @xmath130 ) , _ t _ is the total number of time points , and _ df = t_-1 are the degrees of freedom .",
    "we arbitrarily set the significance level to 99@xmath131 .",
    "in addition , we also compare the maximum observed deviation , @xmath132 with the standard deviation from the sm at that same time point . respectively , these two statistics quantify for the sm approximation the _ accuracy _ ( that is , how close are the predictions to the true value ) , and the _ precision _ ( that is , how much the observations deviate from its expected value ) . in turn",
    "these two measures give us a grip to judge whether our approximation deviates significantly from the @xmath5true@xmath5 values ( from the simulations ) , and also whether significant deviations are biologically meaningful .",
    "as we will see in some examples , some systematic and statistically significant deviations may occur .",
    "the most radical test of our approximation is when selection changes abruptly .",
    "for example , a sudden shift of the optimum would trigger a quick response of the trait , and a major reconfiguration of the genetic states .",
    "the prediction of the change of the trait mean and of the genetic variance is thus not a trivial task . in turn , our approximation allows us to estimate the change of their expectations , which gives a rather robust prediction of their evolutionary course .",
    "figures [ fig : optimumabruptchange5loci ] and [ fig : optimumabruptchange100loci ] present two examples of this situation .",
    "we compare this response with intensive simulations of the wright - fisher model ( eq . [ eq : wright - fishermodel ] ) , for two distinct numbers of loci : five and a hundred .",
    "the response of the mean is quicker for traits with more loci . in this case of equal effects , the reason is clear : the expectations of the trait mean and the genetic variance are @xmath5extensive@xmath5 , meaning that their values are proportional to the number of loci , @xmath18 .",
    "the expectations are not strictly linear with @xmath18 , but it is nevertheless a positive dependence .",
    "thus , traits composed of a larger number of loci have larger genetic variance , and therefore respond faster to selection .",
    "this is expected from the formula from the stochastic house of cards model ( shoc ; b \" urger 2000 , pp .",
    "2.8 ) that predicts that the expected genetic variance will be @xmath133 ( in this case , we set the effect to @xmath8=1 ) . thus increasing the number of loci , increases the genetic variance . the precision of our approximation does not seem to depend critically on @xmath18 , except for a very low number of loci ( @xmath18 between 3 and 5 , depending on the parameters , results not shown ) , where the gaussian approximation fails .",
    "yet , the predictions of the macroscopics are in very good agreement with the numerical expectations , even for @xmath18 as low as 5 .    in these examples",
    ", we find that the expected genetic variance remains practically unchanged , even though @xmath28 fluctuates wildly in any one realization . in fact , in the two cases in figs .",
    "[ fig : optimumabruptchange5loci ] and [ fig : optimumabruptchange100loci ] , @xmath134 is variable , but achieves at most an increase of 1@xmath131 .",
    "this makes it not only hard but to some extent pointless to aim for an accurate numerical or more critically empirical estimation of @xmath134 ( fowler and whitlock 2002 ) , in part because we would need an unrealistic number of observations .",
    "the variance of a set of independent ( numerical or empirical ) measurements of @xmath28 is of comparable magnitude to the mean range of response of such measurements , so any change in @xmath28 will be obfuscated by the effects of drift .",
    "+ however , the nearly constant patterns of the expectations of @xmath28 should not be confused with a constancy of @xmath28 itself .",
    "the latter will of course fluctuate around its expectation because of genetic drift .",
    "accordingly , we evaluated the deviations from the expectations by computing var(@xmath28 ) ( which follows from the derivative @xmath135\\right/\\partial 4n\\!\\sigma^2 $ ] , an element of the matrix @xmath88 ) , and from it , the root mean square deviation ( rmsd ) .",
    "the rmsd shows the range in which the individual paths are most likely to occur .",
    "these bounds are also shown in the figures 3 and 4 , exposing the fact that the effects of drift are big compared to the change in the expectations , but still in a narrow percentile range of the actual standing variation .",
    "this indicates that in practice @xmath28 can be considered constant .",
    "such small changes in the genetic variance and its expectation justify the classical approaches like the breeder s equation , which relies on constant heritabilities for long term predictions ( lande 1979 ) . for these kind of situations ,",
    "a complicated mathematical machinery like the one introduced here seems unjustified .",
    "nevertheless , we can still apply our calculations in order to compute other aspects that do nt arise naturally from the classical theory .",
    "for example , we can easily estimate the expected variance of the set of measurements alluded above ( fowler and whitlock 2002 ) .",
    "this not only gives a rule of thumb of when to expect genetic variance to remain constant , but also provides a way to falsify the sm approach . with increasing numbers of loci ( a )",
    "the range of change of @xmath28 becomes smaller ( there is larger mutational load ) , and ( b ) the range of fluctuation ( i.e. the standard error ) increases .",
    "thus , we are even less able to detect changes in the expectations . + these calculations give some insight into why @xmath134 hardly varies in response to selection . as figs .",
    "[ fig : optimumabruptchange5loci ] and [ fig : optimumabruptchange100loci ] suggest , drift would be the main driving force for the changes in genetic variance .",
    "why is nt the change in @xmath134 more pronounced ? + thinking in terms of the distribution of allele frequencies ( fig .",
    "[ fig : marginaldistributions ] , showing the marginal distribution at one locus ) , we find that the distribution is bimodal .",
    "the positions of the adaptive peaks determine the genetic variance , which depends only weakly on their height .",
    "the relative height of these peaks , on the other hand , determine the value of the trait mean , but depend weakly on their position .",
    "thus , because these two quantities ( @xmath31 and @xmath28 ) are practically uncoupled , it is possible to select over them more or less independently .",
    "selection on the trait mean will cause multiple jumps among the peaks ( barton 1986 ) .",
    "but the position of the peaks remain unchanged , because they are equidistant to the saddle , which is situated at an intermediate frequency @xmath136=1/2 ( this is because there is no dominance ) . consequently , because the genetic variance is symmetric w.r.t the allele frequencies , few @xmath5-@xmath5 alleles with frequency _ p _ ( and thus @xmath5+@xmath5 alleles with frequency .",
    "1-_p _ ) result in as much variance as numerous @xmath5-@xmath5 alleles with frequency 1-_p _ ( and @xmath5+@xmath5 alleles of frequency _ p _ ) .",
    "so , although the alleles are jumping from one peak to the other , their frequencies change always from",
    "_ p _ to 1-_p _ ( or vice - versa ) , affecting the proportions of @xmath5+@xmath5/@xmath5-@xmath5 alleles at each peak , and thus the trait , but without affecting the genetic variance .",
    "however , the intermediate frequencies are transiently populated by the jumping alleles , so a slight increase in the genetic variance should be observed .",
    "this change , as a matter of fact is predicted by the sm but it is generally only a few percent of the standard error , and often too small to be detected .",
    "notice however , that the force related to the genetic variance ( that is , @xmath137 ) shows a small change .",
    "but the scale is so narrow that it can practically be considered constant .",
    "this is of course supported by the shoc expectation of the genetic variance , eq .",
    "( [ eq : geneticvariancehoc ] ) , where the expectation of the genetic variance does not depend on @xmath138 .",
    "= -2.5 to@xmath139=2.5 , see panel c ) .",
    "the trait consists of @xmath18=5 loci of equal effect .",
    "expectations ( black dashed lines ) of ( a ) a polygenic trait and ( b ) its genetic variance .",
    "the gray regions cover @xmath140 the standard error ( root mean squared deviation of the variance of the macroscopics ) .",
    "the change in the genetic variance is at most of 4.85@xmath131 of the initial value , while its standard error is 20.5@xmath131 .",
    "the gray solid lines are averages of the numerical realizations ( with population size of @xmath141 ; 1000 replicas were employed ) .",
    "the goodness of fit ( one tail chi - square with 51 degrees of freedom ) accepts the null hypothesis ( the simulation points are random samples of the sm distributions ) in both cases : ( a ) @xmath142 ; the maximum deviation is 12.19@xmath131 of the standard error ( 0.47 ) ; ( b ) @xmath143 ; the maximum deviation is 18.27@xmath131 of the standard error ( 0.31 ) .",
    "( c - f ) evolution of the local forces . notice the short range of change on ( d - f ) , these forces remain practically constant .",
    "@xmath144=-1.0 , @xmath137=-15 and @xmath145=0.3 .",
    "]     = @xmath14010 , that is about 5@xmath131 of the total range ; see panel c ) .",
    "the trait consists of @xmath18=100 loci of equal effect .",
    "expectations ( black dashed lines ) of ( a ) a polygenic trait and ( b ) its genetic variance .",
    "the gray regions cover @xmath140 the standard error ( root mean squared deviation of the variance of the macroscopics ) .",
    "the change in the genetic variance is at most of 0.4@xmath131 of the initial value , while its standard error is 10.3@xmath131 .",
    "the gray solid lines are averages of the numerical realizations ( with @xmath141 ; 500 replicas were employed ) .",
    "the goodness of fit ( 151 degrees of freedom ) accepts the null hypothesis in both cases : ( a ) @xmath146 ; the maximum deviation is 26.5@xmath131 of the standard error ( 0.50 ) ; ( b ) @xmath147 ; the maximum deviation is 22.19@xmath131 of the standard error ( 1.41 ) .",
    "( c - f ) evolution of the local forces .",
    "notice the short range of change on ( d - f ) , these forces remain practically constant .",
    "@xmath144=-1.0 , @xmath137=-4 and @xmath148=0.5 . otherwise as in fig .",
    "[ fig : optimumabruptchange5loci ] . ]",
    "= -3.0 ) resulting in pronounced changes in the expectation of the trait mean but with weak changes ( even a relatively constant value ) of the expectation of the genetic variance .",
    "solid line : @xmath139=2.5 , @xmath149 . dashed line : @xmath139=0 , @xmath150 .",
    "dotted line : @xmath151=-2.5 , @xmath152 .",
    "( b ) changing the intensity of selection over the genetic variance modulates the position of the adaptive peaks ( other things being equal , @xmath139=2.5 ) resulting in pronounced changes in the expectation of the genetic variance , but with weak changes on the expectation of the trait mean",
    ". dotted line : n@xmath27=0 , @xmath153 .",
    "short - dashed line : n@xmath27=-1.0 , @xmath154 .",
    "large - dashed line : n@xmath27=-4.0 , @xmath155 .",
    "solid line : : n@xmath27= -10.0 , @xmath156 . in all cases",
    "n@xmath0=0.5 , n@xmath32=-1.0 , and the trait is composed of 20 loci of equal effects . ]      as suggested by comparing figs .",
    "[ fig : optimumabruptchange5loci ] and [ fig : optimumabruptchange100loci ] , with 5 and 100 loci , respectively , the amount of standing genetic variation is proportional to the number of loci @xmath18 .",
    "this insinuates that traits composed of more loci should adapt quicker to ecological changes .",
    "but , is there any relationship between these rates of adaptation and the number of loci ? as a matter of fact , if we measure time relative to the expected number of mutations ( that is 2@xmath18 @xmath0__t _ _ ) the time to reach an equilibrium are comparable for different number of loci . in this time scale , we find that the genetic variance is slowed down , but it also reaches higher levels for traits composed of larger numbers of loci ( fig . [",
    "fig : deterministcexample ] in the electronic supplementary material , esm 1 ) . in the limit of infinite loci , we would have ( 1 ) constant genetic variance , but ( 2 ) its value would diverge , leading to  instant adaptation .",
    "a solution to this paradoxical limit , comes from rescaling the effects of the alleles with the number of loci ( bulmer 1980 , turelli and barton 1990 ) .",
    "thus in making @xmath157 , the genetic variance is regularized : as the number of loci increases , its rate of change go to zero , and it converges to a constant value , that is , the infinitesimal model ( bulmer 1980 ) .",
    "these circumstances are depicted in fig . 2 of the esm 1 .",
    "another example that was alluded in the introduction and which is of general interest is when the optimum is steadily shifting its position ( b \" urger 2005 ; waxman 2005 ; kopp and hermisson 2007 ; sato and waxman 2008 ; kopp and hermisson , 2009 ) .",
    "figure [ fig : movingoptimum100locishortrange ] presents a comparable situation to that of fig .",
    "[ fig : optimumabruptchange100loci ] , but where the optimum is moving slowly .",
    "again , we do not detect major changes in @xmath134 . here ,",
    "the trait is being selected in a range that is much less than its total range of response ( @xmath140__n , n__=100 in this case , while the optimum shifts in a comparably short range , between @xmath1405 ) . however , if we consider a larger range , comparable to @xmath18 ( depicted in fig .",
    "[ fig : movingoptimum20loci ] ) , then at the extremes we force fixation of some alleles , and the variance changes significantly .",
    "notice that during evolution , the range of change of the effective selective values ( what we termed forces ) can change notably ( fig .",
    "[ fig : movingoptimum20loci ] ) .",
    "but if we compare to other scenarios ( e.g. fig .",
    "[ fig : movingoptimum100locishortrange ] ) , the forces can be virtually constant . + despite the previous examples , the polygenic dynamics when the optimum is steadily moving can be very complicated , because as the optimum shifts the allelic combinations that match the optimum continuously change with dramatic microscopic modifications ( kopp and hermisson 2007 2009 ) .",
    "the result is that the path of @xmath28 is erratic in the deterministic case , because the alleles at different loci keep sweeping and their frequency changing , inflating and deflating the genetic variance in an almost chaotic fashion .",
    "this is all smoothed out when drift is present and we average over an ensemble .",
    "thus , a more serious test for our theory would be to consider situations where there is considerable chance that the dynamics get stuck in local minima .",
    "= @xmath15810 , see panel c , dotted line ) at a rate of @xmath159 units per generation .",
    "the trait consists of @xmath18=100 loci of equal effect .",
    "expectations ( black dashed lines ) of ( a ) a polygenic trait and ( b ) its genetic variance .",
    "the gray regions cover @xmath140 the standard error ( root mean squared deviation of the variance of the macroscopics ) .",
    "the gray solid lines are averages of the numerical realizations ( with@xmath141 ; 500 replicas were employed ) .",
    "the goodness of fit ( 151 degrees of freedom ) rejects the null hypothesis for the trait mean , and accepts it for the genetic variance : ( a ) @xmath160 ; however , the maximum deviation is 37.31@xmath131 of the standard error ( 0.50 ) ; ( b ) @xmath161 ; the maximum deviation is15.94@xmath131 of the standard error ( 1.41 ) .",
    "( c - f ) evolution of the local forces . notice the short range of change on ( d - f ) , these forces remain practically constant . @xmath144 = -1 , @xmath137 = -4 , @xmath145 = 0.5 .",
    "otherwise as in fig .",
    "[ fig : optimumabruptchange5loci ] . ]",
    "= @xmath14048 , 60@xmath131 of the total range ; see panel c , dotted line ) at a rate of @xmath159 units per generation .",
    "the trait consists of @xmath18=20 loci of equal effect .",
    "expectations ( black dashed lines ) of ( a ) a polygenic trait and ( b ) its genetic variance .",
    "the gray regions cover @xmath140 the standard error ( root mean squared deviation of the variance of the macroscopics ) .",
    "the gray solid lines are averages of the numerical realizations ( with @xmath141 ; 500 replicas were employed ) .",
    "the goodness of fit ( 101 degrees of freedom ) rejects the null hypothesis for the trait mean , and accepts it for the genetic variance : ( a ) @xmath162 ; the maximum deviation is 171@xmath131 of the standard error ( 0.36 ) ; ( b ) @xmath163 ; the maximum deviation is 41@xmath131 of the standard error ( 0.69 ) .",
    "( c - f ) evolution of the local forces . notice the short range of change on ( d - f ) , these forces remain practically constant .",
    "@xmath144 = -2 , @xmath137 = -2 , @xmath145 = 0.5 .",
    "otherwise as in fig .",
    "[ fig : optimumabruptchange5loci ] . ]      in part , whether our predictions make biological sense , is a matter of time scale . in the first examples , genetic drift eliminated genetic variance at a similar rate to its production by mutation .",
    "thus , the rate of change of @xmath134 was very small .",
    "we can obtain a different picture if the genetic variance is forced to change along with , or instead of , selecting over the trait . under stabilizing selection , the mean fitness",
    "is determined by two variance measures : the genetic variance , and the squared deviation of the trait mean w.r.t . the optimum .",
    "both of them are under selection with strengths @xmath137 and @xmath144 , respectively . the canonical way to represent stabilizing selection ( lynch and lande 1993 ) will assume that @xmath164 .",
    "we relax this constraint , and allow selection to act independently over @xmath28 and over the deviation from the optimum . at the moment , we focus on the first alternative .",
    "+ the scenario that we study , is that when a population is initially under selection - mutation - drift equilibrium where selection acts over a quantitative trait , but with little strength on the variance .",
    "suddenly , selection against the variance increases , and the optimum changes sign .",
    "this implies a radical reconfiguration of the adaptive landscape . in this case",
    ", will the sm approximation be accurate ?",
    "an example of this scenario is demonstrated in fig .",
    "[ fig : selectiongeneticvariance ] .",
    "we find that there is a good agreement with the simulations . +",
    "as explained above , selection over the trait mean and over the genetic variance are practically uncoupled .",
    "thus if the optimum moves without affecting the strength of selection , the trait mean can freely evolve without significant changes on the genetic variance ( figs .",
    "[ fig : optimumabruptchange5loci ] , [ fig : optimumabruptchange100loci ] , [ fig : movingoptimum100locishortrange ] ) . however , we have now studied a more general situation when both forces , the optimum and the selection strength , change .",
    "figure [ fig : selectiongeneticvariance ] shows that the pattern of change of the force @xmath165 is similar to the one in fig . [ fig : optimumabruptchange100loci ] where a similar situation was studied , except that the genetic variance did not change .",
    "this suggest that even in this case ( fig .",
    "[ fig : selectiongeneticvariance ] ) where both selection and the optimum shift , the evolution of the genetic variance and of the trait mean are uncoupled .",
    "this is unexpected because , unlike the previous example , the adaptive peaks are being relocated .",
    "this rearrangement of the microscopic space , which originally was nearly peaked close to 1/2 but which suddenly became bi - modal , partitioned the occurring alleles closer to the borders of fixation these configurations that diminish the genetic variance .",
    "simultaneously , a high frequency of @xmath5+@xmath5 alleles was produced , and at another locus a high frequency of @xmath5-@xmath5 alleles , in such proportions that maintain low genetic variance , while allowing the trait mean evolve to increase to its new optimum value .",
    "+ under the quasi - equilibrium approximation , the shoc formula ( eq .",
    "[ eq : geneticvariancehoc ] ) would hold for any time if we would substitute @xmath145 and @xmath137 for the effective forces @xmath166 and @xmath167 .",
    "thus the expectation of the genetic variance would only change if any of these change .",
    "if the optimum value is displaced without significantly changing @xmath166 or @xmath167 , there would be no reason to expect a change in @xmath168 .",
    "a marginal issue here , is whether the predictions from eq .",
    "( [ eq : geneticvariancehoc ] ) are in agreement with the sm expectations .",
    "for example , for the initial state depicted in fig .",
    "[ fig : selectiongeneticvariance ] , the numerical averages ( from the wright - fisher simulations ) for the genetic variance give @xmath16931.13 @xmath140 1.65 , the shoc gives @xmath168 = 30.00 , whilst the sm gives @xmath170 = 31.08 @xmath1401.5 . for the end equilibrium , we have @xmath16914.08@xmath1401.36 , and the models give @xmath168 = 10.00 , whilst @xmath170 = 14.12@xmath1401.21",
    ". there seems to be a decent agreement between both predictions .",
    "however , the agreement between the shoc and the sm expectations does diverge as @xmath1710 ( data not shown ) .",
    "= @xmath14010 , see panel c ) , and simultaneously , selection against the genetic variance is increased from @xmath137=-1 to @xmath137=-5 .",
    "the trait consists of @xmath18=100 loci of equal effect .",
    "expectations ( black dashed lines ) of ( a ) a polygenic trait and ( b ) its genetic variance .",
    "the gray regions cover @xmath140 the standard error ( root mean squared deviation of the variance of the macroscopics ) .",
    "the change in the genetic variance is at most of 0.4@xmath131 of the initial value , while its standard error is 10.3@xmath131 .",
    "the gray solid lines are averages of the numerical realizations ( with @xmath141 ; 500 replicas were employed ) .",
    "the goodness of fit ( 151 degrees of freedom ) accepts the null hypothesis for the trait mean , but rejects it for the genetic variance : ( a ) @xmath172 ; the maximum deviation is 17.19@xmath131 of the standard error ( 0.50 ) ; ( b ) @xmath173 ; the maximum deviation is 39.77@xmath131 of the standard error ( 1.37 ) .",
    "( c - f ) evolution of the local forces . notice the short range of change on ( d - f ) , these forces remain practically constant .",
    "@xmath144 = -1 , @xmath145 = 0.3 . otherwise as in fig .",
    "[ fig : optimumabruptchange5loci ] . ]      quantitative traits , and the genetic variance , under stabilizing selection can also evolve by other means than selecting over the variance , and changing the position of the optimum .",
    "the statistical mechanics allows @xmath31 and @xmath28 to vary by changes in @xmath144 . recalling that this parameter penalizes the deviations of the trait mean from the optimum ,",
    "varying it should not affect the value of @xmath31 .",
    "in fact , if we keep the optimum at a fixed place , and say , we reduce @xmath144 , the @xmath138 and @xmath134 remain almost unchanged .",
    "instead , there is an increase in the standard deviation of @xmath31 .",
    "thus this parameter @xmath144 determines how much @xmath31 deviates from its the expected values .",
    "surprisingly , the marginal distribution of allele frequencies remains practically unchanged . despite",
    "that an adaptive peak is not the same as the marginal distribution of an allele , the mean and variance at each adaptive peak do not depend on @xmath144 ( see appendix 2 ) , thus altering its value will not affect the positioning and relative heights of the adaptive peaks .",
    "however , @xmath144 would make the distribution more or less concentrated at such peaks .",
    "thus although the expectations remain the same , populations with larger @xmath144 would show population means and variances more scattered than other population ( or states ) where @xmath144 is smaller ( for numerical examples , see figs . 4 and 5 of the esm 1 ) .",
    "+ another way in which populations can evolve , is by changing the mutation rate .",
    "an increase ( decrease ) in the number of mutants will inflate ( deflate ) de expected genetic variance , but will not affect the trait mean s expectation .",
    "however , if the mutation rate approaches the @xmath174 , the sm method is inaccurate ( this will be discussed in more detail in  4.7 ) .    at such point ,",
    "the borders of the distribution ( i.e. _ _ p__=0,1 ) become absorbing , leading to a failure of the local equilibrium dynamics ( figs . 6 and 7 of the esm 1 ) .",
    "close to the boundaries , two effects are present : ( 1 ) drift is much more powerful than selection in fixating alleles , and ( 2 ) , mutation does not produce enough alleles to keep the distribution away from fixation . towards the center of the distribution",
    ", selection is more effective than drift in maintaining polymorphisms .",
    "the rate at which each process occurs have different time scales : fixation towards at the borders happen very fast , whereas diffusion away from the borders is much slower .",
    "the local equilibrium dynamics can not cope with both time scales at the same time , and the sm approximation fails ( barton and de vladar 2009 ) .      .",
    "in our previous paper , where we dealt with directional selection ( barton and de vladar 2009 ) , the sm framework had to be modified for low mutation rates ( @xmath1751/4 ) . at these low mutation rates , there is a major qualitative change in the distribution of allele frequencies , since the fixation states suddenly become absorbing .",
    "this is also true in the present case of stabilizing selection .",
    "thus , when mutation rates are close to this critical point@xmath145=1/4 , the local equilibrium underestimates the rates of change ( e.g. the genetic variance ) , and the accuracy of our predictions is lost . in the esm 1 ( sect .",
    "5 ) , we show two examples , with the optimum abruptly increased and for a moving optimum , where the predictions deviate significantly . + when @xmath1751/4 the macroscopics that characterize the system change , in what is called a phase transition . in this case ,",
    "the genetic heterozygosity _ u _ , has to be dropped , and the dynamics of the other macroscopics must be computed from the jump processes ( using a master equation , instead of diffusion ; barton and de vladar 2009 ) .",
    "this works well for directional selection , but would lead to a different set of equations for the local variables and for the macroscopics compared with the high mutational input case . nevertheless , the philosophy is the same : to maximize entropy under the constraint of the appropriate macroscopics , and approximate the dynamics using the local equilibrium ansatz .",
    "we also found that when selection on the genetic variance is very strong , 4@xmath176@xmath1771 , we also lose accuracy . in the esm 1",
    ", we illustrate this situation for abrupt changes and gradual moves in the optimum trait value .",
    "the reason for the failure seems to be that when the valleys between the adaptive peaks are deep , the microscopic distribution approaches a stationary distribution very slowly , so that our central assumption that @xmath63 is nearly stationary , fails .",
    "again , a jump process seems to be a more accurate model than diffusion , which we are eager to apply for stabilizing selection .",
    "we will come back to these explanations later .",
    "the quasi - equilibrium assumption will hold when the changes in the microscopic states are faster than the macroscopic changes .",
    "because of the complexity of the adaptive landscape , a given macroscopic state can stand at different adaptive peaks .",
    "although these peaks may be indistinguishable from the macroscopic point of view , they will have an effect on the rates of change of the latter .",
    "because the transitions among different adaptive peaks may in general happen at different rates , then the final macroscopic state  after a peak shift  will depend on the particular microscopic configuration at the time of the jump .",
    "this is remarkable , because the stationary distribution is unique , and is determined solely by @xmath82 .",
    "an immediate implication is that the trajectory that the macroscopics take during evolution , depends on their previous history .",
    "that is , the dynamics show hysteresis .",
    "thus , even when the microscopic variables are averaged out , there can be memory in the macroscopic dynamics .",
    "+ in fact , we find that , out of equilibrium , a particular value of @xmath138 does not always correspond to a unique value of @xmath134 , which is the signature of hysteresis .",
    "figure [ fig : hysteresis]a shows an example where a trait evolves starting at the point _ a _ , following an optimum that increases towards the point _ b. _",
    "after equilibrium has been reached , the optimum then moves back to the original value _ a _ ; the other parameters are left unchanged .",
    "the trajectories in the space @xmath178 are _ not _ the same for the forward and backwards processes .",
    "although the predictions and the simulations do not agree ( clearly , we are in the range where the adaptive peaks are well separated ) , both , the actual model and the sm approximation show an equivalent qualitative response . in fig .",
    "[ fig : hysteresis]b the optimum moves slowly ( as in fig .",
    "[ fig : movingoptimum100locishortrange ] ) and afterwards , moves back to its original point . because the optimum follows the same trajectory forward and backwards , the amount of hysteresis lower . finally , in fig .",
    "[ fig : hysteresis]c both the optimum and selection against the genetic variance change abruptly ( as in fig .",
    "[ fig : selectiongeneticvariance ] ) , and after equilibrium is attained , they abruptly change back to their original values .",
    "the rates of change of @xmath69@xmath31@xmath70 and @xmath134 have different time scales , and hysteresis is enormous .",
    "+ the puzzling issue here is , why after averaging over the microstates , do the trajectories of the expectations show hysteresis ?",
    "the question seems be difficult to answer in detailed , mechanistic terms .",
    "but , we can understand it from the macroscopic phenomenology .",
    "as we showed and discussed above , the trait mean and the genetic variance can evolve more or less independently . depending on the strength of the selection coefficients , which are the directional component towards the optimum -@xmath179- and the strength of selection again the genetic variance -@xmath137- , the response will be quicker for one component or for the other ( depending which one is effectively bigger ) .",
    "thus the macroscopic that changes faster in one direction , will be also the one that changes faster in the other direction .",
    "for example , in fig ( 9a ) the optimum shifts .",
    "the standing genetic variance initially increases as the rare mutants become frequent and the trait mean increases .",
    "eventually , this variance is rapidly consumed as the trait mean slows down relaxing to equilibrium .",
    "if we now consider the reverse process , shifting the optimum back to its original position , the story for the variance will be exactly the same : initial mutants will increase their representation , and the genetic variance increases .",
    "but although the genetic variance is taking the same path , the trait mean takes a mirror path : before it was characterized by a period of quick increase , followed by a slow increase .",
    "now it takes a quick decrease followed by a slow decrease .",
    "the main question that we have addressed in this work is whether the sm approximation is valid in the challenging case of stabilizing selection . in general",
    ", the maximum entropy distribution has been shown to match that of the exact model ( the diffusion equation ) at equilibrium , and it is straightforward to determine which macroscopics are in principle relevant for evolutionary change ( appendix 2 in barton and de vladar 2009 ) .",
    "this extension of our previous methodology has been applied to an important and classical theme in population and quantitative genetics : understanding the factors that generate quantitative variation and its evolution . in the introduction",
    ", we posed the problem which refers to the difficulties that appear in estimating the change of a complex trait .",
    "we also proposed three ways around to these complications , namely unequal allelic effects , averaging over the different deterministic paths , and genetic drift .",
    "we have taken only the last two , for clarity , and assume equal effects to give a worst case scenario where microscopic irregularities are enhanced .",
    "in fact , an extension of the sm method to unequal effects involves a slightly different version of the generating function and per - locus equations ( see appendixes 1 - 2 ) .",
    "the approximations follow from the application of the central limit theorem , which does _ not _ require the same distribution at all loci , only independence between these loci ( see appendix 1 ) .",
    "+ we have been able to predict long term changes of the expectations of the mean and variance of a trait , in the extreme situations when selection either changes abruptly , or gradually due to a moving optimum . in each case the expected trait mean follows radically different paths , yet the expected genetic variance stays roughly constant . unless there are changes in the selection against the genetic variance , its expectation seldom changes appreciably .",
    "therefore , classical approaches of quantitative genetics , like the breeder s equation ( lande 1979 ; falconer 1981 , ch .",
    "20 ) , where the constancy of the additive genetic variance is assumed , seem to describe fairly well the evolution of the trait mean , since the fluctuations due to drift do not seem to affect critically this constancy of the expected genetic variance .",
    "+ in our studies of the dynamics , the effective forces other than selection towards the optimum ( @xmath179 ) are weak .",
    "this reflects the general principle that selection on a polygenic trait is much more effective on the mean trait than on the variance , by a factor equal to the number of loci . in turn",
    ", this is exposed by the local variables , which remain very similar to the actual forces , i.e. @xmath180 , and @xmath181 , and may be related to several factors",
    ". first , if the range in which the optimum is changing is narrow ( compared with the whole range of response of the trait , @xmath140@xmath18 , as most traits seem to be ) , the alleles are unlikely to fix . even if they have frequencies close to the borders ( e.g. if selection against the variance is strong ) , the variability that is generated by mutation is not reduced through fixation ( because we assume @xmath1821/4 ) .",
    "second , because mutations are frequent , the jumps between peaks provide a mechanism for the change of allele frequencies at an appreciable rate .",
    "this is a mechanism which essentially , maintains the genetic variance .",
    "thus , selection on the trait mean can act without affecting the mechanisms that maintain variance .",
    "selection can bias the rates between the peaks in one or the other direction , affecting the trait mean .",
    "but again , this does not affect the heterozygosity of the population .",
    "this allows the character to be displaced without changing the genetic variance .",
    "+ however , if we select the trait over a wide range , say starting and ending at extreme trait values , we would force fixation of some of the alleles and observe a reduction in the genetic variance toward the extremes , but with a transient inflation in - between .",
    "in this case , most mutants appearing in the initial environment are rare , and therefore the variance is small . when selection changes , these mutants become beneficial , and therefore their frequency increases ( as has been experimentally documented , see hoffmann and meril \" a 1999 ) .",
    "eventually , when we approach the other extreme , the @xmath5good@xmath5 alleles fix , reducing the variance , as shown in fig .",
    "[ fig : movingoptimum20loci ] .",
    "+ although we have shown that the sm approximation works well in a range of situations , it fails is when the adaptive peaks are well separated ( that is when @xmath1751/4 and/or selection against the genetic variance is strong , @xmath183@xmath1211 ; see fig .",
    "[ fig : marginaldistributions ] b ) . when the distribution becomes peaked close to or at the boundaries , the alleles quickly approach fixation . in this case",
    "some of the mutants close to an adaptive peak are forced to jump to a beneficial peak .",
    "this process seems to be much quicker than the diffusion times , and therefore the sm predicts a slower response of the genetic variance .",
    "the predictions for the trait mean , however , remain accurate .",
    "but if the population remains in a regime where there is significant intermediate frequency , the sm method works well .    to summarize , in the light of our theory",
    ", we attribute the constancy of the genetic variance to three factors . first , weak selection on the genetic variance .",
    "the effective forces on the genetic variance show weak changes , because although the new beneficial phenotypes require a reconfiguration of the genetic states , these can be attained by changing only the proportion of alleles at different loci which are at the different adaptive peaks , rather than a shift on the position of these peaks .",
    "second , the presence of genetic drift . here",
    ", we should also note that although the expectations smoothly change , an individual trajectory will nevertheless fluctuate abruptly .",
    "the bounds presented in the above figures indicate the range of these fluctuations . in some occasions , even when the changes in the trait mean or genetic variance are large",
    ", these bounds tend to be quite narrow .",
    "therefore even in individual experiments we would expect a regular ( i.e. not erratic ) pattern of change in the trait mean and genetic variance ( seen in reality , e.g. barton and keightley 2002 , fig .",
    "third , the number of loci composing a trait increases the genetic load , and thus diminishes the rate of change of the expectations of the genetic variance ( assuming that selection is on the trait mean ) .",
    "although this effect is notable in the expectations ( figs .",
    "[ fig : optimumabruptchange5loci ] and [ fig : optimumabruptchange100loci ] ) , it seems to be less critical than the above two , as indicated in our theoretical experiments where selection on the genetic variance induces notable changes ( fig .",
    "[ fig : selectiongeneticvariance ] ) .",
    "the above results are in sharp contrast to a @xmath5general@xmath5 situation where changes in the genetic variance are not smooth .",
    "the implication is that drift is a mechanism that regularizes the course taken by an ensemble of populations through the rugged fitness landscape .",
    "thus , averaging over these drift effects helps us to understand the evolution of quantitative traits . yet",
    ", there is no microscopic hysteresis in our results .",
    "we found , curiously , that hysteresis is present in the macroscopic trajectories .",
    "this phenomenon results from the combination of two factors .",
    "the first is that the genetic variance and the trait mean can evolve independently , each with their own characteristic time scale .",
    "the second is that the trajectory of the expectation of the genetic variance is symmetric in time , while that of the trait mean is antisymmetric , meaning that in the backwards dynamics , the trajectory is a mirror image of the forward dynamics .",
    "together , these two factors show not only that genetic systems have memory , but that to @xmath5degrade@xmath5 such memory , selection in the contrary direction might be required .",
    "otherwise , the system may get stuck into local optima , especially for low mutation rates , where hysteresis is expected to be enhanced .",
    "this last statement is so far hypothesis , which needs to be verified with further analyses .",
    "our approximation is a step forward in the understanding of the evolution of polygenic traits : it allows us to unravel features using only a few macroscopic measures .",
    "still , traits rarely evolve independently from others . in this sense , there are two plausible extensions to our present work .",
    "the first is the explicit coevolution of two or more traits . as in the univariate case ,",
    "the rate of change of a trait is proportional to the genetic covariances , which are subsumed in the @xmath184-matrix ( lande 1979 ) .",
    "the natural question is then how quickly can this matrix respond to selection , mutation , and drift ( steppan et al 2002 ; blows 2007 ) .",
    "our method can address this question ; it is straightforward to formulate the problem by defining a vector of traits @xmath69@xmath70 .",
    "this would then define a multivariate trait version of the matrices @xmath85 and @xmath88 , from which we can in principle forecast the evolutionary dynamics responding to simultaneous selection over the different traits .",
    "a related problem that we envision is that of pleiotropic effects .",
    "changes in the value of a trait are often accompanied by a change in the fitness of the individual , not only because of its direct effects , but also because many other traits are indirectly being affected ( turelli 1985 ; barton 1990 ; wagner et al 2008 ) . in this situation",
    ", the net effect of the mutations tends to be deleterious .",
    "this phenomenon can be quantified by a variable that accounts for all these pleiotropic factors through their net effects on fitness ( turelli 1985 ; barton 1990 ; keightley and hill 1990 ; kondrashov and turelli 1992 ; gavrilets and de jong 1993 ; orr 2000 ) .",
    "+ population genetics still faces the challenge of explaining interactions among different factors that have uncertain consequences for the evolutionary process . the sm method , although relying on a moderately complicated mathematical machinery , allows us to systematize several of these factors and to study their effects in a relatively easy way .",
    "it is an ideal companion to diffusion methods , and although developed in part as an analogy with sm in physics ( barton and de vladar 2009 ; barton and coe 2009 ) , it has the same ultimate goals as population and quantitative genetics : to inquire on the factors that produce and maintain variability in genetically complex traits .",
    "following wright ( 1937 ) , we can partition the distribution of allele frequencies , and thus the integrand of @xmath45 , into the elements of @xmath185 that are associated with the trait mean , and associate those elements which are not , namely : @xmath186\\exp[2n\\!\\sigma",
    "\\nu   + 2n\\!\\mu u]\\phi   d^n\\pmb{p}\\text {   } .\\ ] ]    now , notice that the second exponential term is separable as a product over loci : exp[2 @xmath187 + 2 @xmath145 _ u _ ] @xmath65 = @xmath188 if the allele frequencies are not too close to fixation , then the last product ( properly normalized ) can be approximated by a multivariate gaussian distribution , centered on the expectation of a given set of macroscopics .",
    "we choose these to be : @xmath31 , @xmath28 , @xmath189 , @xmath190 and @xmath191 which are defined by      these are required to compute the matrices @xmath85 and @xmath88 .",
    "the variances and crossed moments follow directly .",
    "+ before applying the gaussian approximation , it is convenient to partition the distribution of each locus around each adaptive peak .",
    "for instance , calling @xmath193 the density around the peak @xmath5+@xmath5 peak ( close to _ _",
    "p__=1 ) , and similarly @xmath194 for the @xmath5-@xmath5 peak ( close to _ _",
    "p__=0 ) , where @xmath195 is their normalization constant ( see below ) , then the product over loci can be expressed as a binomial sum over the pair of peaks of each locus @xmath196    the index @xmath197 runs in the all the combinations of loci at each peak .",
    "for example all loci at the @xmath5-@xmath5 peak wold give @xmath197=@xmath1091,2,@xmath198,@xmath18 @xmath111 , and its complement would be @xmath199 , an empty set . if loci 1,2,4,5 are in the - peak and the rest in the + peak , then @xmath197=@xmath1091,2,4,5@xmath111 and @xmath200 .",
    "thus @xmath201 contains all these possible permutations .",
    "now we apply the gaussian approximation ( central limit theorem ) to the product @xmath202 , which leads to @xmath203 , \\ ] ] and here , the vector = @xmath204 , @xmath205 is its column transpose , and @xmath206 is its covariance matrix ( its determinant denoted by @xmath207 ) .",
    "the subscript @xmath197 indicates that the expectations and covariances are with respect to the distribution at the adaptive peak of the particular configuration @xmath197 , and which is free of selection over the trait .",
    "the normalization constant is : @xmath208    we employed the additive property of the functions @xmath31 , @xmath28 and _ u _ , to separate the integrals , so that the @xmath209 s are characteristic functions of _ per - locus _ systems subject to mutation , drift and selection acting over the genetic variance , and therefore depend on the variables @xmath137 and @xmath145 only : @xmath210    ( @xmath211 is the gamma function , and @xmath212 is the regularized confluential hypergeometric function ; abramowitz @xmath213 stegun 1972 , ch . 13 ) .",
    "the other statistics for the adaptive peaks are analyzed in appendix 2 .",
    "now , introducing eq .",
    "( [ eq : gaussianapproxtotheadditivepart ] ) into eq .",
    "( [ eq : splittedpartitionfunction ] ) : @xmath214\\times \\exp\\left[-\\frac{1}{2}\\left(\\pmb{a}-\\langle \\pmb{a}\\rangle _ { \\bbbk } \\right)\\cdot \\mathit{c}_{\\bbbk } ^{-1}\\cdot \\left(\\pmb{a}-\\langle \\pmb{a}\\rangle _ { \\bbbk } \\right)^t\\right]d\\pmb{a } ~.\\ ] ]    in this integral we should consider a finite range of integration running from the two extremes of each macroscopic , @xmath215 to @xmath216 .",
    "but for many loci , the density is concentrated near the expectations , thus performing the integral in the whole range is a good approximation .",
    "this of course is true as long as the expectations are far enough from the borders ( see esm 1 ) . here",
    "all the variables except @xmath31 integrate to 1 , and we get @xmath217/\\sqrt{q_{\\bbbk } } ~,\\ ] ] where @xmath218      the expression ( [ eq : partitionfunctionunequaleffects ] ) is not easy to deal with because the sum is performed over a vast number of terms ( all the possible combinations , which amount to @xmath102 ) .",
    "one way to make progress is assuming equal effects . in this case , the sum becomes a binomial ( see for example in eq .",
    "[ eq : binomialpeaks ] that the sum will directly be a binomial sum ) .",
    "many of the combinations are equivalent , because all that matters is the number of loci in one peak , or in the other .",
    "each combination is weighted by the binomial term , denoted by @xmath221 .",
    "a number _ m _ of loci standing in a peak contribute to the expected mean by @xmath222 , where @xmath103 is the expected trait mean of a single locus .",
    "the other peak will house _",
    "n - m _ loci .",
    "however , the mean @xmath103 at the two peaks have equal value but opposite signs ( by convention we take the value at the @xmath5+@xmath5 peak ) , thus its net contribution to the expectation of the trait mean is @xmath223 .",
    "adding the contribution of both adaptive peak with a configuration of ( _ n - m , m _ ) , the expectation of the mean is thus @xmath224 . the expected variance , however , is invariant with respect to the @xmath5+@xmath5/@xmath5-@xmath5 peaks .",
    "it only depends on the deviation with respect to the mean value at a peak , which for both peaks is the same , to which each locus contributes by @xmath105 .",
    "the @xmath5+@xmath5 peak contributes by _ m _ and the @xmath5-@xmath5 peak by _",
    "_ overall , the total variance is @xmath225 .",
    "( [ eq : partitionfunctionunequaleffects ] ) simplifies , for equal effects , to : @xmath226 .\\ ] ]    although it is feasible to work with this expression it is convenient to approximate the binomial term as a gaussian . since the exponential factor of the sum is also of quadratic order on _ m _ , we can obtain a closed expression for the whole sum . thus approximating",
    "@xmath227 $ ] , we find that eq .",
    "( [ eq : partitionfunctionbinomialequaleffects ] ) becomes @xmath228\\times \\exp\\left[\\frac{2}{q } \\left(n\\!\\beta^2 n v_o - n\\!\\beta ( n-2 m ) m_o - n\\!\\lambda ( n-2 m ) ^2m_o^2\\right)\\right ] .\\ ] ]        although it is tempting to employ the last equation to calculate the macroscopics , this in most cases it will lead to substantial errors .",
    "the correct method is to compute the derivatives from eq .",
    "( [ eq : partitionfunctionequaleffectsgaussian ] ) and then perform the gaussian approximation over the sums of such result .    the expectations for the macroscopic variables above ,",
    "are expressed in terms of the contributions by the different permutations of the loci around each adaptive peak , which we expressed as a gaussian function .",
    "these contributions are also described with a statistical mechanical approximation , but for a polygenic system where selection acts only over the genetic variance , and where mutation and drift affect the population s genetic structure .",
    "this system has its own generating function , given by eqns .",
    "( [ eq : additiveparitionfunction ] ) and ( [ eq : perlocuspfclosedform ] ) , from which the expectations and covariances are calculated .",
    "the first two expectations that we require for the full system of stabilizing selection are those of the trait mean and its variance at the adaptive peaks , that is @xmath219 and @xmath232 , which are given by : @xmath233 where @xmath234 is an indicator function , which gives 1 if the locus m belongs to @xmath235 and 0 otherwise .",
    "the variance is @xmath236 @xmath237    similarly , other quantities can be computed from the eqns .",
    "( [ eq : additiveparitionfunction ] ) and ( [ eq : perlocuspfclosedform ] by direct integration or by taking derivatives w.r.t .",
    "@xmath238 , to obtain the expectation of the genetic variance for a given configuration across the peaks , or w.r.t .",
    "@xmath239 to obtain the expectation of the genetic variability , @xmath46 . and similarly , the second derivatives to compute the variances and covariances .",
    "with this method we can obtain the expressions for all the macroscopic variables needed to compute the dynamics of the fully coupled polygenic system . under the assumption of equal effects , all the adaptive peaks are equivalent .",
    "thus the product of the per - locus generating functions ( eq.[eq : additiveparitionfunction ] ) reduces to @xmath240 and consequently all the macroscopic variables simplify . under equal effects ,",
    "( [ eq : traitmeanuneqeffectsnoselection ] ) and ( [ eq : squaredtraitmeanuneqeffectsnoselection ] ) become @xmath241        the function @xmath245 is the polygamma function ( kth derivative of the log - gamma function ) , and this as well as the derivatives of the hypergeometric functions lack a closed form , and are special functions themselves . fortunately , in most cases these are readily implemented in numerical packages .",
    "see however abramowitz and stegun ( 1972 , chs . 6 and 13 ) for their definitions in integral or series forms , and their properties .",
    "other terms of higher order like the variances and covariances follow similarly .",
    "however , they involve complicated and long polynomial forms on the hypergeometrics , and writing them down is not particularly useful .",
    "however , all the calculations performed in this research are implemented in a mathematica ( v7.0 ) package supplied in the esm 2 , which includes a brief tutorial ( esm 3 ) ."
  ],
  "abstract_text": [
    "<S> evolution ; quantitative genetics ; statistical mechanics ; entropy ; epistasis ; genetic variance , shifting balance . by exploiting an analogy between population genetics and statistical mechanics , we study the evolution of a polygenic trait under stabilizing selection , mutation , and genetic drift . </S>",
    "<S> this requires us to track only four macroscopic variables , instead of the distribution of all the allele frequencies that influence the trait . </S>",
    "<S> these macroscopic variables are the expectations of : the trait mean and its square , the genetic variance , and of a measure of heterozygosity , and are derived from a generating function that is in turn derived by maximizing an entropy measure . </S>",
    "<S> these four macroscopics are enough to accurately describe the dynamics of the trait mean and of its genetic variance ( and in principle of any other quantity ) . unlike previous approaches that were based on an infinite series of moments or cumulants , which had to be truncated arbitrarily , our calculations provide a well - defined approximation procedure . </S>",
    "<S> we apply the framework to abrupt and gradual changes in the optimum , as well as to changes in the strength of stabilizing selection . </S>",
    "<S> our approximations are surprisingly accurate , even for systems with as few as 5 loci . </S>",
    "<S> we find that when the effects of drift are included , the expected genetic variance is hardly altered by directional selection , even though it fluctuates in any particular instance . </S>",
    "<S> we also find hysteresis , showing that even after averaging over the microscopic variables , the macroscopic trajectories retain a memory of the underlying genetic states .    </S>",
    "<S> [ firstpage ] </S>"
  ]
}