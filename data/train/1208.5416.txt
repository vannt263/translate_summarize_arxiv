{
  "article_text": [
    "in this paper , we develop an algorithm for applying fourier integral operators associated with canonical graphs using wave packets .",
    "to arrive at such an algorithm , we construct a universal oscillatory integral representation of the kernels of these fourier integral operators by introducing singularity resolving diffeomorphisms where caustics occur .",
    "the universal representation is of the form such that the algorithm based on the dyadic parabolic decomposition of phase space previously developed by the authors applies @xcite .",
    "we refer to @xcite for related computational methods aiming at the evaluation of the action of fourier integral operators .",
    "the algorithm comprises a geometrical component , bringing the local representations in universal form , and a wave packet component which yields the application of the local operators . here",
    ", we develop the geometrical component , which consists of the following steps .",
    "first we determine the location of caustics on the canonical relation of the fourier integral operator .",
    "for each point on a caustic we determine the associated specific rank deficiency and construct an appropriate diffeomorphism , resolving the caustic in open neighborhoods of this point .",
    "we determine the ( local ) phase function of the composition of the fourier integral operator and the inverse of the diffeomorphism in terms of universal coordinates and detect the largest set on which it is defined .",
    "we evaluate the preimage of this set on the canonical relation .",
    "we continue this procedure until the caustic is covered with overlapping sets , associated with diffeomorphisms for the corresponding rank deficiencies .",
    "then we repeat the steps for each caustic and arrive at a collection of open sets covering the canonical relation .    in the special case of fourier integral operators corresponding to parametrices of evolution equations , for isotropic media ,",
    "an alternative approach for obtaining solutions in the vicinity of caustics , based on a re - decomposition strategy following a multi - product representation of the propagator , has been proposed previously @xcite . unlike multi - product representations",
    ", our construction does not involve a subdivision of the evolution parameter and yields a single - step computation .",
    "moreover , it is valid for the general class of fourier integral operators associated with canonical graphs , allowing for anisotropy .",
    "the complexity of the algorithm for general fourier integral operators as compared to the non - caustic case arises from switching , in the sets covering a small neighborhood of the caustics , from a global to a local algorithm using a pseudodifferential partition of unity .    as an application we present the computation of a parametrix of the wave equation in a heterogeneous , isotropic setting for long - time stepping in the presence of caustics .",
    "projection @xmath0 of a slice @xmath1 of the canonical relation @xmath2 associated with a half - wave equation in the vicinity of a caustic ( red solid line , the blue dashed lines indicate the neighborhood of the singularity ) caused by a low velocity lens .",
    "the white solid lines are connected to a regular grid in @xmath3 by bi - characteristics .",
    "the black dot indicates the center of an open neighborhood of conjugate points @xmath4 for which the projection onto standard microlocal focal coordinates @xmath5 is not diffeomorphic . ]",
    "we briefly discuss the ( co)frame of curvelets and wave packets @xcite .",
    "let @xmath6 and consider its fourier transform , @xmath7 \\ , { \\mathrm{d}}x$ ] .",
    "one begins with an overlapping covering of the positive @xmath8 axis ( @xmath9 ) by boxes of the form @xmath10",
    "\\times       \\left[-\\frac{{l''_{k}}}{2 } ,              \\frac{{l''_{k}}}{2}\\right]^{n-1 } , \\ ] ] where the centers @xmath11 , as well as the side lengths @xmath12 and @xmath13 , satisfy the parabolic scaling condition @xmath14 next , for each @xmath15 , let @xmath16 vary over a set of @xmath17 uniformly distributed unit vectors .",
    "let @xmath18 denote a choice of rotation matrix which maps @xmath16 to @xmath19 , and @xmath20 in the ( co-)frame construction , one encounters two sequences of smooth functions on @xmath21 , @xmath22 and @xmath23 , each supported in @xmath24 , so that they form a co - partition of unity , @xmath25 and satisfy the estimates @xmath26 one then forms @xmath27 with @xmath28 , satisfying the estimates @xmath29                  |\\psi_{\\nu , k}(x)| \\end{array } \\right\\ }            \\le c_n 2^{k ( n+1)/4 } \\ , ( \\ ,         2^k |\\langle\\nu , x\\rangle| + 2^{k/2 } \\| x \\| \\,)^{-n}.\\ ] ] to obtain a ( co)frame , one introduces the integer lattice : @xmath30 , the dilation matrix @xmath31 and points @xmath32 .",
    "the frame elements ( @xmath15 ) are then defined in the fourier domain as @xmath33 , \\ ;       \\gamma = ( m,\\nu , k ) , $ ] and similarly for @xmath34 . the function @xmath35 is referred to as a wave packet .",
    "one obtains the transform pair @xmath36",
    "we consider fourier integral operators , @xmath37 , associated with canonical graphs .",
    "we allow the formation of caustics .",
    "let @xmath38 be local coordinates on the canonical relation , @xmath2 say , of @xmath37 , and @xmath39 a corresponding generating function : if , at a point on @xmath2 , @xmath40 are linearly independent and @xmath41 vanishes , then @xmath42 are coordinates on @xmath2 nearby , @xmath43 , and one can parameterize @xmath2 as @xmath44 , where @xmath45 locally on @xmath2 ( cf .",
    "@xcite , thm 21.2.18 ) .",
    "the fact that a ( possibly empty ) set @xmath46 exists follows from the canonical graph property , i.e. that @xmath47 are local coordinates and @xmath48 linearly independent . then @xmath49 the coordinates are standardly defined on ( overlapping ) open sets @xmath50 in @xmath2 , that is , @xmath51 is defined as a diffeomorphism on @xmath50 ; let @xmath52 .",
    "the corresponding partition of unity is written as @xmath53 in local coordinates , we introduce @xmath54 then @xmath55 with @xmath56\\     \\varphi_{\\gamma}(x)\\     \\mathrm{d } x \\mathrm{d}\\xi_{j_i } .\\ ] ] the amplitude @xmath57 is complex and accounts for the kmah index .",
    "we let @xmath58 denote the stationary point set ( in @xmath59 ) of @xmath60 .",
    "the amplitude can be identified with a half - density on @xmath2 .",
    "one defines the @xmath61-form @xmath62 on @xmath58 , @xmath63 in the above , we choose @xmath64 as local coordinates on @xmath2 , while @xmath65",
    ". then we get @xmath66 @xmath67 is identified with @xmath68 .",
    "the corresponding half - density equals @xmath69 .",
    "densities on a submanifold of the cotangent bundle are associated with the determinant bundle of the cotangent bundle .",
    "let @xmath70 denote the leading order homogeneous part of @xmath71 .",
    "the principal symbol of the fourier integral operator then defines a half - density , @xmath72 .",
    "that is , for a change of local coordinates , if the transformation rule for forms of maximal degree is the multiplication by a jacobian @xmath73 , then the transformation rule for a half - density is the multiplication by @xmath74 . in our case , of canonical graphs ,",
    "we can dispose of the description in terms of half - densities and restrict to zero - density amplitudes on @xmath2 .      the typical case of a fourier integral operator associated with a canonical graph",
    "is the parametrix for an evolution equation @xcite , @xmath75 u(t , x ) = 0 , \\quad u(t_0,x ) = { \\varphi_\\gamma}(x)\\ ] ] on a domain @xmath76 and a time interval @xmath77 $ ] , where @xmath78 is a pseudodifferential operator with symbol in @xmath79 ; we let @xmath80 denote the principal symbol of @xmath81 .    for every @xmath82",
    ", the integral curves @xmath83 of @xmath84 with initial conditions @xmath85 and @xmath86 define the transformation , @xmath87 , from @xmath88 to @xmath47 , which generates the canonical relation of the parameterix of , for a given time @xmath89 ; that is , @xmath90 .",
    "the perturbations of @xmath47 with respect to initial conditions @xmath88 are collected in a propagator matrix , @xmath91 which is the solution to the @xmath92 system of differential equations @xmath93 known as the hamilton - jacobi equations , supplemented with the initial conditions @xcite @xmath94 away from caustics the generating function of @xmath2 is @xmath95 ( @xmath96 ) , which satisfies @xmath97 upon substituting @xmath98 denoting the backward solution to with initial time @xmath99 , evaluated at @xmath100 .",
    "the leading - order amplitude follows to be @xmath101 reflecting that @xmath102 is homogeneous of degree @xmath103 in @xmath104 .    in the vicinity of caustics",
    ", we need to choose different coordinates .",
    "admissible coordinates are directly related to the possible rank deficiency of @xmath105 : one determines the null space of the matrix @xmath105 and rotates the coordinates such that the null space is spanned by the columns indexed by the set @xmath106 .",
    "then @xmath38 form local coordinates on the canonical relation @xmath2 , as in the previous subsection , and @xmath50 is given by the set for which the columns indexed by @xmath106 span the null space of @xmath105 .",
    "illustration of canonical relations @xmath87 ( top ) and @xmath107 ( bottom ) of operators @xmath37 and @xmath108 associated with a half - wave equation : ( bi-)characteristics (  rays  ) in @xmath109 for initial conditions @xmath110 and @xmath111 , respectively , for evolution through a low velocity lens ( see section [ sec : example ] ) .",
    "the black circles on the left indicate the conjugate points corresponding to the initial conditions . ]",
    "we consider the matrix @xmath112 for given @xmath113 at @xmath114 and @xmath115 and determine its rank .",
    "suppose it does not have full rank at this point .",
    "we construct a diffeomorphism which removes this rank deficiency in a neighborhood of @xmath116 , where @xmath117 .    to be specific , we rotate coordinates , such that @xmath118 ( upon normalization ) .",
    "let us assume that the row associated with the coordinate @xmath119 generates the rank deficiency .",
    "( there could be more than one row / coordinate . )",
    "we then introduce the diffeomorphism , @xmath120 to preserve the symplectic form , we map @xmath121 yielding a canonical transformation @xmath122 .",
    "we note that @xmath123 .    the canonical transformation , @xmath124 , associated with @xmath125 is given by @xmath126 we introduce the pull back , @xmath127 .",
    "the diffeomorphism @xmath128 can be written in the form of an invertible fourier integral operator with unit amplitude and canonical relation given as the graph of @xmath129 . to see this",
    ", we write @xmath130 , @xmath131 .",
    "that is , @xmath132 and @xmath133 .",
    "the diffeomorphisms @xmath128 and @xmath125 define the fourier integral operators with oscillatory integral kernels , @xmath134 the generating functions are @xmath135 respectively .",
    "the canonical relations are the graphs of @xmath129 and @xmath136 , and are given by @xmath137 the hessians yield a unit amplitude : @xmath138    substituting the particular diffeomorphism , we obtain : @xmath139    the corresponding propagator matrices are hence given by given by @xmath140 which are easily verified to be symplectic matrices . in the more general case , each coordinate @xmath141 generating a rank deficiency yields additional non - zero entry pairs @xmath142 , @xmath143 , @xmath144 , @xmath145 , and @xmath146 , @xmath147 in the above propagator matrices .",
    "it follows that the composition @xmath148 generates the graph of a canonical transformation , @xmath149 say , which can be parametrized by @xmath150 locally on an open neighborhood of @xmath151 .",
    "we denote the corresponding generating function by @xmath152 . we can compose @xmath37 with @xmath125 as fourier integral operators : @xmath153 . the canonical relation of @xmath108 is the graph of @xmath154 . in summary :    @xmath155_{q:\\,c_q}\\ar@{->}[rr]^{f:\\,\\chi } & & ( y,\\eta ) \\\\ & \\qquad\\qquad&\\\\ ( \\tilde x,\\tilde\\xi)\\ar@{->}[uurr]_{\\check f = f q^{-1}:\\,\\check\\chi }   \\ar@/_/[uu]_{q^{-1}:\\,c_{q^{-1 } } } & &   } \\ ] ] for each given type of rank deficiency ( here , in @xmath119 ) and each @xmath156 within this class , there is an open set @xmath157 on which the coordinates @xmath158 are valid .",
    "these sets form an open cover , and we obtain a family of diffeomorphisms parametrized by @xmath156 ; there exists a locally finite subcover , and we only need a discrete set to resolve the rank deficiencies everywhere .     caustic surfaces @xmath159 ( dark gray ) and @xmath160 ( light gray ) of @xmath2 and @xmath161 corresponding to propagation through a low velocity lens ( cf . section [ sec : example ] ) : the singular regions of @xmath2 and @xmath162 do not intersect . ]",
    "we index these by @xmath163 and construct a set of diffeomorphisms , @xmath164 , which resolve locally the rank deficiency leading to coordinates @xmath38 .",
    "we write @xmath165 we write @xmath166 for the image of @xmath50 under the diffeomorphism on the level of lagrangians . let the matrix @xmath167 in the above be nonsingular on the open set @xmath168 , and introduce @xmath169 .",
    "this set corresponds with a set @xmath170 .",
    "we subpartition @xmath171 .",
    "the corresponding partition of unity now reads @xmath172 then @xmath173 with @xmath174\\     \\varphi_{\\gamma}(x )      \\mathrm{d } x \\mathrm{d}\\xi_{j_i } .\\ ] ] inserting the diffeomorphisms , we obtain @xmath175\\     \\widehat{q_{ij}^ * \\varphi_{\\gamma}}(\\tilde{\\xi})\\     \\mathrm{d}\\tilde{\\xi } .\\ ] ]     iso - amplitude surface of the partition functions @xmath176 , @xmath177 , associated with @xmath178 ( left ) : the joint admissible set @xmath179 comprises the exterior of the two sheets .",
    "iso - amplitude surface of @xmath180 for @xmath181 and @xmath182 ( @xmath183 ) ( right ) : the admissible set @xmath184 contains the region on the back of the sheet .",
    "bottom : boundaries @xmath185 , @xmath177 ( dashed curves ) and",
    "@xmath186 , @xmath183 ( solid curves ) of the admissible domains : clearly , the joint admissible set @xmath187 covers @xmath2 . ]",
    "the amplitude @xmath188 and phase function @xmath189 are obtained by composing @xmath190 with @xmath191 as fourier integral operators and changing phase variables .",
    "it is possible to treat this composition from a semi - group point of view .",
    "then , to leading order , we get @xmath192 where @xmath193 in which @xmath194 moreover , @xmath195 can be obtained as follows . if @xmath196 is the propagator matrix of the perturbations of @xmath87 , then the propagator matrix of the perturbations of @xmath197 is given by : @xmath198 . then @xmath199 where @xmath200 is obtained as the determinant of the upper - left sub - block of @xmath201 . to accommodate a common notation , we set @xmath202 ( @xmath203 ) if @xmath96 and write @xmath204 . in the further analysis , we omit the subscripts @xmath205 and @xmath206 where appropriate .",
    "illustration of joint partition of unity for the partition functions and sets in fig .",
    "[ fig : iso_win_x_xi ] for @xmath207 fixed : slice of @xmath208 ( left ) , the admissible set @xmath209 and the associated partition function @xmath210 ( center ) , and the partition function @xmath211 for @xmath184 realizing the partition of unity with @xmath208 . ]      to numerically evaluate in reasonable time , we will use separated ( in @xmath109 and @xmath212 ) representations of @xmath213 and @xmath214 @xcite .",
    "such representations can be obtained by restricting the integration over @xmath212 to domains following a dyadic parabolic decomposition . here , these will be given by the boxes @xmath215 following the re - decomposition of @xmath216 into wave packets @xmath217 , @xmath218 .",
    "the key novelty is constructing a separated representation of the partition functions .",
    "consider our oscillatory integral in @xmath219 including the cutoff @xmath220 .",
    "@xmath220 is homogeneous of degree zero in @xmath221 and is a classical smooth symbol ( of order @xmath103 ) .",
    "we `` subdivide '' the integration over @xmath212 .",
    "a possible procedure involves obtaining a ( low - rank ) separated representation of @xmath222 on the support of each relevant box in @xmath221 @xcite , @xmath223 ( basically , this can be obtained using spherical harmonics in view of the fact that the @xmath221 is implicitly limited to an annulus . )",
    "one can view this also as windowing the directions of @xmath221 into subsets ( cones ) using @xmath224 and then constructing @xmath225 according to the smallest admissible set in @xmath109 for the @xmath226-range of directions .",
    "the oscillatory integral becomes    @xmath227 \\ ,        \\check\\gamma_2^{\\beta}(\\tilde{\\xi } ) \\",
    ",     |\\hat{\\chi}_{\\nu , k}(\\tilde{\\xi})|^2 \\ ,            \\widehat{q^ * \\varphi_{\\gamma}}(\\tilde \\xi )     \\mathrm{d}\\tilde{\\xi } .\\ ] ]",
    "one can view @xmath228 as a subdivision of the box @xmath24 .",
    "we know that @xmath229 as @xmath230 since the cone of directions in @xmath24 shrinks as @xmath231 .",
    "hence , for large @xmath232 this does not involve any action .",
    "the procedure allows a subdivision for coarse scales , as long as the scaling is not affected for large @xmath232 . if the subdivision is too `` coarse '' then parts of the integration will be lost .",
    "illustration of admissible sets and expansion functions @xmath233 in with @xmath234 ( top row ) and @xmath235 ( bottom rows ) for the partition functions in fig .",
    "[ fig : iso_win_x_xi ] . left column : for the partition functions @xmath236",
    ", @xmath177 .",
    "centre column : for the partition functions @xmath237 , @xmath183 .",
    "right column : the joint admissible sets induced by the partition of unity for the expansion functions plotted in the left and centre columns . ]",
    "illustration of diffeomorphism @xmath128 , @xmath125 and re - decomposition for a wave packet @xmath238 at frequency scale @xmath239 .",
    "top row : @xmath238 ( left ) and pull - back @xmath240 ( right ) . rows 2 to 4 : re - decompositions @xmath241 of @xmath240 using @xmath242 , @xmath243 , and @xmath244 boxes @xmath245 , respectively ( right column ) , and the corresponding image @xmath246 under the action of @xmath125 ( left column ) . an insufficient number of boxes alters the amplitudes and the minimum phase property of wave packets . increasing the number of boxes yields satisfactory results in an open neighborhood of @xmath156 . ]",
    "we describe an algorithm for applying fourier integral operators in the above constructed universal oscillatory integral representation .",
    "the global hierarchy of operations is given by the following steps :    1 .",
    "_ preparation step .",
    "_ preparation of universal oscillatory integral representation .",
    "1 .   determination of open sets with local coordinates @xmath106 , @xmath247 on canonical relation @xmath2 , inducing @xmath248 2 .",
    "construction of cut - off functions @xmath249 for the locally singularity resolving diffeomorphisms @xmath248 3 .",
    "construction of separated representation for @xmath249 2 .",
    "_ evaluation of diffeomorphisms @xmath250 .",
    "_ evaluation of actions of @xmath251 . _",
    "step 3 requires the evaluation of the action of fourier integral operators associated with canonical graphs in microlocal standard focal coordinates .",
    "the choice of discretization and algorithm for step 3 induces how computations in step 1 and 2 are to be organized .",
    "here , we perform computations in the almost symmetric wave packet transform domain . we make use of the  box - algorithm  computation of the action of fourier integral operators associated with canonical graphs in microlocal standard focal coordinates @xmath252 @xcite .",
    "the box algorithm is based on the discretization and approximation , to accuracy @xmath253 , of the action of @xmath254 on a wave packet @xmath255 , @xmath256 the procedure relies on truncated taylor series expansions of @xmath214 and @xmath257 near the microlocal support of @xmath258 , along the @xmath259 axis and in the @xmath260 directions perpendicular to the radial @xmath261 direction . here , @xmath262 is the backwards - solution @xmath263 and @xmath264 and @xmath265 are functions realizing , on @xmath245 , a separated tensor - product representation of the slowly oscillating kernel appearing in the second - order expansion term of @xmath266 , @xmath267 b_{\\tilde\\nu , k}(\\tilde\\xi )                 \\approx \\sum_{r=1}^r \\alpha_{\\tilde\\nu , k}^{(r)}(y ) \\hat\\vartheta_{\\tilde\\nu , k}^{(r)}(\\tilde\\xi)\\ ] ] constructed from prolate spheroidal wave functions @xcite .",
    "the number @xmath268 of expansion terms is controlled by the prescribed accuracy @xmath269 of the tensor product representation . for a detailed description of the box - algorithm and its implementation",
    ", we refer to @xcite .    based on this tensor product representation ,",
    "it is possible to group computations and to evaluate the action of @xmath254 in step 3 for all data wave packets of the same frequency box @xmath245 at once instead of for each @xmath270 individually .",
    "consequently , steps 1 and 2 will also be organized in terms of frequency boxes @xmath245 .",
    "we write @xmath271 for the data portion corresponding to a frequency box @xmath245 . starting from data @xmath272 ,",
    "each of the following steps are repeated for any frequency box @xmath24 of interest .",
    "we begin with determining the sets @xmath50 for the box @xmath24 . to this end",
    ", we compute the integral curves @xmath273 and their perturbations with respect to initial conditions @xmath88 and monitor the null space of the matrix @xmath274 following section [ sec : prop ] .",
    "for parametrices of evolution equations , this involves solving the system and evaluating the propagator matrices @xmath275 by solving system .",
    "we evaluate the system of differential equations in fermi ( or ray - centered ) coordinates , in which the potential rank deficiencies of the upper left subblock @xmath276 appear explicitly as zero entries in the corresponding row(s ) and column(s ) @xcite .",
    "the submanifolds @xmath277 on which @xmath105 is singular separate and define the sets @xmath50 .",
    "these computations on @xmath278 are performed by discretizing the set of orientations @xmath279 covering the frequency box @xmath24 with resolution @xmath280 and the set in @xmath3 for which @xmath281 has non - zero energy with resolution @xmath282 .",
    "then , for each set @xmath50 , we detect @xmath283 ( and consequently @xmath284 ) in a similar way , as the set on which the upper left sub - block @xmath285 of @xmath286 has full rank . here",
    "@xmath287 is given by .",
    "the operators @xmath248 are chosen such that @xmath288 overlappingly cover the set of singularities . for fixed @xmath289 ,",
    "this induces a discrete set @xmath290 .",
    "we then proceed with the construction of the partition of unity . since the partition functions enter the computation as pseudodifferential cutoffs in the construction of the amplitude ( cf . ) , requiring the backwards solutions @xmath291 ( compare ( [ equ : d2s1][equ : amp0 ] ) ) , we perform our numerical construction in coordinates @xmath292 .",
    "we obtain @xmath293 upon substituting @xmath294 implied by the canonical relation @xmath295 . for the construction of the partition functions",
    "@xmath296 , we choose double - exponential cutoffs of the form @xmath297 mimicking a @xmath298 cutoff , with appropriate normalization and truncated to precision @xmath269 . here",
    "@xmath299 is a function measuring the distance of the point @xmath292 from the boundary @xmath300 of the set @xmath301 .",
    "the partition of unity is then formed by weighting @xmath302 on the overlaps of the sets @xmath301 such that @xmath303 .    finally , we construct the separated representations of @xmath296 ( cf . ) in @xmath292 coordinates by windowing the directions of @xmath212 into subsets using @xmath304 , realizing a subdivision into @xmath221 cones .",
    "this subdivision is performed for each frequency box @xmath245 .",
    "we evaluate each of the operators @xmath248 in the fourier domain .",
    "this choice is guided by the property @xmath305 of the discrete almost symmetric wave packet transform @xcite , which enables the fast evaluation of the fourier transform of the data at a set of frequency points @xmath306 limited to the box @xmath24 .",
    "we obtain @xmath250 at once for all @xmath238 belonging to the frequency box @xmath24 by evaluation of their adjoint unequally spaced fft @xcite , @xmath307 , at points @xmath308 , @xmath309\\ ] ] in preparation for the evaluation of @xmath310 , we compute the discrete almost symmetric wave packet transform of the pullback @xmath311 , yielding its wave packet coefficients @xmath312 .      at this stage , we are ready to evaluate the action @xmath313 ( cp . ) by evaluation of @xmath314 using the box algorithm ( cf . ) .",
    "note that numerically significant coefficients @xmath315 of the pull - back @xmath311 are contained in a small set of boxes @xmath245 neighboring the direction @xmath316 .",
    "we further subdivide each of these boxes according to the separated representation of @xmath296 .",
    "then , we apply the box algorithm to each subdivision , indexed by triples @xmath317 , @xmath318 . here",
    ", the taylor series expansion of the generating function @xmath214 is constructed about the central @xmath212 direction within the support of @xmath319 , accounting for the induced subdivision of the box @xmath245 .",
    "note that sub - dividing into @xmath212 cones results in a reduction of the range of @xmath212 orientations in each element @xmath317 of the subdivision , as compared to the @xmath221 range contained in @xmath245 .",
    "this reduces the number @xmath268 of expansion terms in and effectively counter - balances the increase by a factor @xmath320 , evoked by the separated representation of @xmath296 , of the number of times the box - algorithm has to be applied .",
    "the operators @xmath190 for which @xmath321 , @xmath322 say , are directly associated with the canonical relation @xmath278 and involve only computations on @xmath278 . in the algorithm",
    ", we reflect this physical hierarchy of the operators @xmath190 in the construction of the partition of unity .",
    "first , we construct a partition of unity for these hierarchically higher operators .",
    "then , we construct a joint partition of the remaining operators on the sets which are not covered by the sets for which @xmath321 .      starting from a single box @xmath24 and applying @xmath248 to @xmath281 , re - decomposition of @xmath311 results in a set of boxes @xmath245 yielding numerically non - zero contribution to the solution .",
    "the number of boxes entering the computation is directly proportional to the computational cost of the algorithm . in applications",
    ", we therefore aim at keeping this number small and consider only a subset of boxes , yielding the most significant contributions .",
    "we choose this subset such that on an open neighborhood of @xmath156 @xmath323 to precision @xmath324",
    ". we can estimate the energy loss induced by the restriction to subsets of @xmath245 and re - normalize the solution .",
    "we illustrate the impact of choices of subsets containing different numbers of boxes on the numerical accuracy of the diffeomorphic identity in fig .",
    "[ fig : recdec ] .",
    "furthermore , the re - decomposition of @xmath311 yields in general , under the action of @xmath191 , @xmath104-values outside the set @xmath24 , @xmath325 .",
    "we monitor @xmath326 and do not consider their contribution in our computation if @xmath327 is below the threshold @xmath269 .",
    "the free parameters of the procedure are summarized in table [ tab : param ] .",
    ".[tab : param]table of user defined parameters .",
    "[ cols= \" < , < \" , ]      illustration of operator action on a wave packet @xmath238 at frequency scale @xmath239 : contribution of operators @xmath328 ( @xmath177 ) associated with @xmath178 ( top left ) , contribution of operator @xmath190 ( @xmath183 ) with diffeomorphism parameters @xmath329 , resolving the singularity in the tip of the caustic ( top right ) , and joint action of @xmath328 and @xmath190 ( bottom left ) .",
    "time domain finite difference reference ( bottom right ) . in the operator computation",
    ", we consider 9 boxes @xmath245 and a separated representation with @xmath234 term . ]",
    "left column : joint contribution of the operators @xmath328 and @xmath190 acting on a wave packets @xmath238 at frequency scale @xmath330 ( compare fig .",
    "[ fig:3wp0 ] ( bottom left ) for a wave packet at frequency scale @xmath239 ) .",
    "center column : time domain finite difference reference .",
    "right column : the equivalent to the left column when using a separated representation with @xmath331 terms ( note that for computational reasons , only @xmath332 box @xmath245 has been used in the numerical evaluation of @xmath328 and @xmath190 with @xmath331 terms ) . ]",
    "we numerically illustrate our algorithm for the evaluation of the action of fourier integral operators associated with evolution equations .",
    "we consider wave evolution under the half - wave equation , that is , the initial value problem with symbol @xmath333 in @xmath334 dimensions . here",
    "@xmath335 stands for the medium velocity .",
    "we choose a heterogeneous velocity model @xmath336 containing a low velocity lens , with parameters @xmath337 , @xmath338 , @xmath339 , and @xmath340 . as the initial data , we choose horizontal wave packets at frequency scale @xmath239 and @xmath330 , respectively , in the vicinity of the point @xmath341 .",
    "we set @xmath342 and fix the evolution time to @xmath343 . with this choice of parameters ,",
    "most of the energy of the solution is concentrated near a cusp - type caustic .",
    "we illustrate the induced sets @xmath50 and the joint partition of unity @xmath344 in fig .",
    "[ fig : iso_win_x_xi ] and [ fig : fwin_x_xi ] .",
    "we partition the lagrangian @xmath2 into three sets @xmath50 , @xmath345 .",
    "the sets @xmath346 are separated by the caustic . for these sets , we can choose coordinates @xmath5 , hence @xmath347 .",
    "the set @xmath348 contains the caustic . for illustration purposes , in the factorization @xmath190 of @xmath328 for @xmath348",
    ", we choose to compute the operator @xmath349 , which resolves the singularity in an open neighborhood of the point indicated by a black dot on the lagrangian plotted in fig .",
    "[ fig : lagrangian ] .",
    "this neighborhood contains the cusp of the caustic .",
    "furthermore , we limit our separated representation to one term , @xmath234 ( for the corresponding admissible sets and partition functions , see fig .",
    "[ fig : f_c_fwin_x_cc ] ( left column ) ) .",
    "we restrict the computation of @xmath190 for the initial data at frequency scale @xmath239 ( @xmath330 ) to @xmath244 ( @xmath350 ) boxes @xmath245 neighboring the @xmath16 direction , respectively .      in fig .",
    "[ fig:3wp0 ] , we plot the contributions of the different components in the factorization of the propagator acting on a single horizontal wave packet at frequency scale @xmath239 , and compare to a time domain finite difference computation .",
    "the support of the wave packet within the joint admissible set of the chosen factorization is mostly covered by the set @xmath184 , such that most of its energy is contributed by the operator @xmath190 , for which @xmath351 .",
    "we observe that in the joint admissible set , our algorithm has effectively removed the singularity .",
    "we note that the phase of the operator computation matches the phase of the finite difference reference .",
    "this includes the kmah index , which is best observed for operator @xmath352 , which exclusively contributes to the region beyond the caustic ( cf .",
    "[ fig:3wp0 ] , top left ) .",
    "furthermore , note that the amplitude obtained by our algorithm is slightly weaker than the true amplitude .",
    "this is consistent with the observations and discussion following fig .",
    "[ fig : recdec ] and results from the energy leakage induced by restricting the number of boxes in the re - decomposition step following the application of @xmath128 . we can compensate and re - normalize the amplitude by monitoring the energy loss resulting from the restriction ( in fig .",
    "[ fig:3wp0 ] , we have not re - normalized the amplitudes ) .",
    "finally , we note that our algorithm yields the correct result in an open neighborhood in the vicinity of the tip of the caustic , for which we have designed the operator @xmath190 . in consistency with this fact ,",
    "it is ineffective for yielding the image of the entire wave packet which , at this low frequency scale , has support extending beyond the admissible set of the operator factors we compute .",
    "these observations are further illustrated in fig .",
    "[ fig:4wp4 ] ( left column ) , where we plot the contributions of the different components in the factorization of the propagator acting on horizontal wave packets , at higher frequency scale @xmath330 , centered at @xmath353 different locations in the vicinity of the caustic tip . results of a time domain finite difference reference computation are plotted in fig .",
    "[ fig:4wp4 ] ( center column ) . with these initial data ,",
    "we explore the open neighborhood about the point for which the operator composition with @xmath248 resolves the singularity . indeed , at this frequency scale",
    ", we can obtain the image of an entire wave packet with only one operator factor @xmath190 ( cf .",
    "[ fig:4wp4 ] ( second row ) ) . for the wave packet located slightly further above the tip of the caustic ( top row ) , we observe a phase artifact in the region of overlap of @xmath354 and @xmath184 , which can be explained as follows : the restriction of the separated representation for @xmath328 to one term only induces that the computation of the geometry ( bi - characteristics ) for the entire box @xmath24 is exclusively based on one single direction @xmath16 .",
    "this results in inaccuracies in regions close to the caustics where slight perturbations in @xmath104 yield large variations in @xmath109 . furthermore ,",
    "as discussed above , wave packets exploring the regions beyond the tip of the caustics eventually start to leave the admissible set for @xmath190 ( third and bottom line ) .",
    "we note that both for removing the phase artifact of @xmath328 close to the caustic , and for enlarging the admissible set , it is necessary to increase the number of terms @xmath355 in the separated representation ( compare fig .",
    "[ fig : f_c_fwin_x_cc ] ) .",
    "this is illustrated in fig .",
    "[ fig:4wp4 ] ( right column ) , where the joint contributions of operators @xmath328 and @xmath190 with @xmath331 terms in the separated representation are plotted . here",
    ", the expansion functions @xmath304 are constructed as as cones in @xmath212 with a squared cosine cutoff window . for practical reasons and illustration purpose ,",
    "only one single frequency box @xmath245 has been used in the computation ( cf .",
    "[ fig : recdec ] ) . while this restriction to only one frequency box affects the amplitudes and the phases in the tails of the wave packet , the separated representation remains nonetheless effective in resolving the issues observed above : the admissible set is extended beyond the caustic and the inaccuracies in the regions of overlap of sets @xmath50 and @xmath184 as well as in the regions close to the caustics are considerably reduced .",
    "we developed an algorithm for the evaluation of the action of fourier integral operators through their factorization into operators with a universal oscillatory integral representation , enabled by the construction of appropriately chosen diffeomorphisms .",
    "the algorithm comprises a preparatory geometrical step in which open sets are detected on the canonical relation for which specific focal coordinates are admissible .",
    "this covering with open sets induces a pseudodifferential partition of unity .",
    "then , for each term of this partition , we apply a factorization of the associated operators using diffeomorphisms reflecting the rank deficiency and resolving the singularity in the set .",
    "this factorization admits a parametrization of the canonical graph in universal @xmath252 coordinate pairs and enables the application of our previously developed box algorithm , following the dyadic parabolic decomposition of phase space , for numerical computations .",
    "hence , our algorithm enables the discrete wave packet based computation of the action of fourier integral operators globally , including in the vicinity of caustics .",
    "this wave packet description is valid on the entire canonical relation .",
    "it can now enter procedures aiming at the iterative refinement of approximate solutions , and drive the construction of weak solutions via volterra kernels @xcite .",
    "an alternative approach for obtaining solutions in the vicinity of caustics has been proposed previously @xcite for the special case of fourier integral operators corresponding to parametrices of evolution equations for isotropic media .",
    "it consist in a re - decomposition strategy following a multi - product representation of the propagator . here",
    ", we avoid the re - decompositions and operator compositions following the discretization of the evolution parameter , reminiscent of a stepping procedure . what is more , our construction is not restricted to parametrices of evolution equations , but is valid for the general class of fourier integral operators associated with canonical graphs , allowing for anisotropy .",
    "the cost of the algorithm resides in the construction and application of the separated representation of the pseudodifferential partition of unity .",
    "de  hoop , s.f .",
    "holman , h.f .",
    "smith , and g.  uhlmann .",
    "regularity and multi - scale discretization of the solution construction of hyperbolic evolution equations with limited smoothness .",
    ", 33:330353 , 2012 ."
  ],
  "abstract_text": [
    "<S> we develop an algorithm for the computation of general fourier integral operators associated with canonical graphs . </S>",
    "<S> the algorithm is based on dyadic parabolic decomposition using wave packets and enables the discrete approximate evaluation of the action of such operators on data in the presence of caustics . </S>",
    "<S> the procedure consists in the construction of a universal operator representation through the introduction of locally singularity - resolving diffeomorphisms , enabling the application of wave packet driven computation , and in the construction of the associated pseudo - differential joint - partition of unity on the canonical graphs . </S>",
    "<S> we apply the method to a parametrix of the wave equation in the vicinity of a cusp singularity . </S>"
  ]
}