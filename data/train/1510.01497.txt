{
  "article_text": [
    "as we retire more and more synchronous machines and replace them with renewable sources interfaced with power electronic devices , the stability of the power grid is jeopardized , which has been recognized as one of the prime concerns by transmission system operators @xcite .",
    "both in transmission grids as well as in microgrids , low inertia levels together with variable renewable generation lead to large frequency swings .",
    "not only are low levels of inertia troublesome , but particularly spatially heterogeneous and time - varying inertia profiles can lead to destabilizing effects , as shown in an interesting two - area case study @xcite . it is not surprising that rotational inertia has been recognized as a key ancillary service for power system stability , and a plethora of mechanisms have been proposed for the emulation of virtual ( or synthetic ) inertia @xcite through a variety of devices ( ranging from wind turbine control @xcite over flywheels to batteries @xcite ) .",
    "also inertia monitoring @xcite and markets have been suggested @xcite . in this article",
    ", we pursue the questions raised in @xcite regarding the detrimental effects of spatially heterogeneous inertia profiles , and how they can be alleviated by virtual inertia emulation throughout the grid .",
    "in particular , we are interested in the allocation problem `` where to optimally place the inertia '' ?    the problem of inertia allocation has been hinted at before @xcite , but we are aware only of the study @xcite explicitly addressing the problem . in @xcite , the grid is modeled by the linearized swing equations , and eigenvalue damping ratios as well as transient overshoots ( estimated from the system modes ) are chosen as optimization criteria for placing virtual inertia and damping .",
    "the resulting problem is non - convex , but a sequence of approximations led to some insightful results .    in comparison",
    "to @xcite , we focus on network coherency as an alternative performance metric , that is , the amplification of stochastic or impulsive disturbances via a quadratic performance index measured by the @xmath1 norm @xcite . as performance index ,",
    "we choose a classic coherency criterion penalizing angular differences and frequency excursions , which has recently been popularized for consensus and synchronization studies @xcite as well as in power system analysis and control @xcite .",
    "we feel that this @xmath1 performance metric is not only more tractable than spectral metrics , but it is also very meaningful for the problem at hand : it measures the effect of stochastic fluctuations ( caused by loads and/or variable renewable generation ) as well as impulsive events ( such as faults or deterministic frequency errors caused by markets ) and quantifies their amplification by a coherency index directly related to frequency volatility .",
    "finally , in comparison to @xcite , the damping or droop coefficients are not decision variables in our problem setup , since these are determined by the system physics ( in case of damping ) , the outcome of primary reserve markets ( in case of primary control ) , or scheduled according to cost coefficients , ratings , or grid - code requirements @xcite .",
    "the contributions of this paper are as follows .",
    "we provide a comprehensive modeling and analysis framework for the inertia placement problem in power grids to optimize an @xmath0 coherency index subject to capacity and budget constraints .",
    "the optimal inertia placement problem is characteristically non - convex , yet we are able to provide explicit upper and lower bounds on the performance index .",
    "additionally , we show that the problem admits an elegant and strictly convex reformulation for a performance index reflecting the effort of primary control which is often advocated as a remedy to low - inertia stability issues . in this case , the optimal inertia placement problem reduces to a standard resource allocation problem , where the cost of each resource is proportional to the ratio of expected disturbance over inertia .",
    "a similar simplification of the problem is obtained under some reasonable assumptions on the ratio between the disturbance and the damping coefficient at every node . for the case of a two - area network ,",
    "a closed - form global allocation is derived , and a series of observations are discussed .",
    "furthermore , we develop a computational approach based on a gradient formula that allows us to find a locally optimal solution for large networks and arbitrary parameters .",
    "we show how the combinatorial problem of allocating a limited number of inertia - emulating units can be also incorporated into this numerical method via a sparsity - promoting approach .",
    "finally , any system norm such as @xmath1 assumes that the location of the disturbance ( or a distribution thereof ) is known .",
    "while empirical fault distributions are usually known based on historical data , the truly problematic faults in power grids are rare events that are poorly captured by any disturbance distribution . to safeguard against such faults",
    ", we also present a robust formulation of the inertia allocation problem in which we optimize the @xmath0 norm with respect to the worst possible disturbance .",
    "a detailed three - region network has been adopted as case study for the presentation of the proposed method .",
    "the numerical results are also illustrated via time - domain simulations , that demonstrate how an optimization - based allocation exhibits superior performance ( in different performance metrics ) compared to heuristic placements , and , perhaps surprisingly , the optimal allocation also uses less effort to emulate inertia .    from the methodological point of view",
    ", this paper extends the @xmath1 performance analysis of second - order consensus systems to non - uniform damping , inertia , and input matrices ( disturbance location ) .",
    "this technical contribution is essential for the application that we are considering , as these parameters dictate the optimal inertia allocation in an intertwined way .",
    "the remainder of this section introduces some notation .",
    "section [ section : problem formulation ] motivates our system model and the coherency performance index .",
    "section [ section : optimal inertia allocation ] presents numerical inertia allocation algorithms for general networks and provides explicit results for certain instances of cost functions and problem scenarios .",
    "section [ section : case study ] presents a case study on a three - region network accompanied with time - domain simulations and a spectral analysis .",
    "finally , section [ section : conclusions ] concludes the paper .",
    "[ [ notation ] ] notation + + + + + + + +    we denote the @xmath2-dimensional vectors of all ones and zeros by @xmath3 and @xmath4 .",
    "given an index set @xmath5 with cardinality @xmath6 and a real - valued array @xmath7 , we denote by @xmath8 the vector obtained by stacking the scalars @xmath9 and by @xmath10 the associated diagonal matrix .",
    "the vector @xmath11 is the @xmath12-th vector of the canonical basis for @xmath13 .",
    "consider a power network modeled by a graph with nodes ( buses ) @xmath14 and edges ( transmission lines ) @xmath15 .",
    "we consider a small - signal version of a network - reduced power system model @xcite , where passive loads are eliminated via kron reduction @xcite , and the network is reduced to the sources @xmath16  @xmath17 with dynamics @xmath18 where @xmath19 and @xmath20 refer to the power input and electrical power output , respectively .",
    "if bus @xmath12 is a synchronous machine , then describes the electromechanical swing dynamics for the generator rotor angle @xmath21 @xcite , @xmath22 is the generator s rotational inertia , and @xmath23 accounts for frequency damping or primary speed droop control ( neglecting ramping limits ) .",
    "if bus  @xmath12 connects to a renewable or battery source interfaced with a power electronics inverter operated in grid - forming mode @xcite , then @xmath21 is the voltage phase angle , @xmath23 is the droop control coefficient , and @xmath22 accounts for power measurement time constant @xcite , a control gain @xcite , or arises from virtual inertia emulation through a dedicated controlled device  @xcite .",
    "finally , the dynamics may also arise from frequency - dependent or actively controlled frequency - responsive loads  @xcite .",
    "in general , each bus @xmath12 will host an ensemble of these devices , and the quantities @xmath24 and @xmath25 are lumped parametrizations of their aggregate behavior .    under the assumptions of constant voltage magnitudes , purely inductive lines , and a small signal approximation , the electrical power output at the terminals",
    "is given by @xcite @xmath26 where @xmath27 is the susceptance between nodes @xmath28 .",
    "the state space representation of the system ( [ eq : basic])-([eq : elec ] ) is then @xmath29= \\left [ \\setlength\\arraycolsep{1.5pt}\\begin{array}{cc } { 0 } & i \\\\ -{m}^{-1}l & -{m}^{-1}{d}\\\\ \\end{array } \\right]\\left [ \\setlength\\arraycolsep{1.5pt}\\begin{array}{cc } \\theta\\\\ \\omega\\\\ \\end{array } \\right ] + \\left [ \\setlength\\arraycolsep{1.5pt}\\begin{array}{cc } 0\\\\ { m}^{-1}\\\\ \\end{array } \\right ] { { p_\\text{in}}}\\,,\\ ] ] where @xmath30 and @xmath31 are the diagonal matrices of inertial and damping / droop coefficients , and @xmath32 is the network laplacian ( or susceptance ) matrix with off - diagonal elements @xmath33 and diagonals @xmath34 .",
    "the states @xmath35 are the stacked vectors of angles and frequencies and @xmath36 is the net power input  all of which are deviation variables from nominal values .",
    "we consider the linear power system model driven by the inputs @xmath19 accounting either for faults or non - zero initial values ( modeled as impulses ) or for random fluctuations in renewables and loads .",
    "we are interested in the energy expended in returning to the steady - state configuration , expressed as a quadratic cost of the angle differences and frequency displacements : @xmath37 here , @xmath38 are positive scalars and we assume that the nonnegative scalars @xmath39 induce a connected graph  not necessarily identical with the power grid itself .",
    "we denote by @xmath40 the matrix @xmath41 , and by @xmath42 the laplacian matrix of the graph induced by the @xmath43 . in this compact notation",
    ", @xmath44 would be an example of local error penalization @xcite , while @xmath45 penalizes global errors .    aside from consensus and synchronization studies",
    "@xcite the coherency metric has recently also been also used in power system analysis and control @xcite . following the interpretation proposed in @xcite ,",
    "the above metric can represent a generalized energy in synchronous machines .",
    "indeed , for @xmath46 ( where @xmath47 are the power line conductances ) and @xmath48 , the metric accounts for the heat losses in the grid lines and the mechanical energy losses in the generators .    adopting the state representation introduced in , the performance metric can be rewritten as the time - integral @xmath49 of the performance output @xmath50 } _ { = c } \\left [ \\setlength\\arraycolsep{1.5pt}\\begin{array}{cc }   \\theta \\\\",
    "\\omega   \\end{array}\\right ] \\ , .\\ ] ]    in order to model the localization of the disturbances in the grid , we parametrize the input @xmath51 as @xmath52 where @xmath53 is assumed to be known from historical data amongst other sources .",
    "we therefore obtain the state space model @xmath54 in the following , we refer to the input / output map , as @xmath55 . if the inputs @xmath56 are dirac impulses , then measures the squared @xmath0 norm @xmath57 of the system @xcite .",
    "there is a number of interpretations of the @xmath0 norm @xmath57 of a power system @xcite .",
    "the relevant ones in our context are :    1 .",
    "the squared @xmath0 norm of @xmath58 measures the energy amplification , i.e. , the sum of @xmath59 norms of the outputs @xmath60 , for unit impulses at all inputs @xmath61 : @xmath62 these impulses are of strength @xmath63 for each node @xmath64 and can model faults or initial conditions .",
    "2 .   the squared @xmath0 norm of @xmath58 quantifies the steady - state total variance of the output for a system subjected to unit variance stochastic white noise inputs @xmath65 @xmath66 where @xmath67 denotes the expectation .",
    "the white noise inputs can model stochastic fluctuations of renewable generation or loads .",
    "the matrix @xmath68 quantifies the probability of occurrence of such fluctuations at each node @xmath12 .",
    "in general , the @xmath1 norm of a linear system can be calculated efficiently by solving a linear lyapunov equation . in our case",
    "an additional linear constraint is needed to account for the marginally stable and undetectable mode @xmath69^\\mathsf{t}$ ] corresponding to an absolute angle reference for the grid .    *",
    "( @xmath0 norm via observability gramian ) * [ lemma : observability gramian ] for the state - space system @xmath70 defined above , we have that @xmath71 where the observability gramian @xmath72 is uniquely defined by the following lyapunov equation and an additional constraint via @xmath69^\\mathsf{t}$ ] : @xmath73    following the typical derivation of the @xmath74 norm for state - space systems @xcite , we have @xmath75 , where @xmath76 is the observability gramian @xmath77 . note from",
    "that the mode @xmath69^\\mathsf{t}$ ] associated with the marginally stable eigenvalue of @xmath78 is not detectable , i.e. , it holds that @xmath79 for all @xmath80 . because the remaining eigenvalues of @xmath78 are stable , the indefinite integral exists .",
    "next , we show that @xmath76 is a solution for both and . by taking the derivative of @xmath81 with respect to @xmath82 , and then by integrating from @xmath83 to @xmath84 , we obtain @xmath85_0^{\\infty}.\\ ] ] using the fact that @xmath86 , we conclude that @xmath87_0^{\\infty } = -c^\\mathsf{t } c$ ] and therefore holds for @xmath76 .",
    "the fact that @xmath76 satisfies can be verified by inspection , as @xmath88    it remains to show that the @xmath76 is the unique solution of and . to this end , note that @xmath89 and the rank  nullity theorem imply that the kernel of @xmath90 is given by a vector @xmath91 .",
    "it can be verified that @xmath92 holds for @xmath93^{\\mathsf{t}}$ ] , and it directly follows that all solutions of are parametrized by @xmath94 for @xmath95 . finally , holds if @xmath96 . in combination with @xmath97",
    "this implies @xmath98 . with this choice of @xmath99",
    ", @xmath100 equals the positive semidefinite matrix @xmath76 .",
    "we assume that each node @xmath101 has a nonzero   inertial coefficient @xmath102 and we are interested in optimally allocating additional virtual inertia in order to minimize the @xmath0 norm , subject to upper bounds @xmath103 at each bus ( accounting for the available capacity or installation space ) and a total budget constraint @xmath104 ( accounting for the total cost of the inertia - emulating devices ) .",
    "this problem statement is summarized as    [ eq : minop1 ] @xmath105    where @xmath70 are the matrices of the input - output system - .",
    "observe the bilinear nature of the lyapunov constraint featuring products of @xmath78 and @xmath100 , and recall from that the decision variables @xmath24 appear as @xmath106 in @xmath78 .",
    "hence , the problem is non - convex and typically also large - scale .    in the following",
    ", we will provide general lower and upper bounds , a simplified formulation under certain parametric assumptions , a detailed analysis of a two - area power system , and a numerical method determine locally optimal solutions in the fully general case .      *",
    "( performance bounds ) * [ theorem : bounds on performance index ] consider the power system model - , the squared @xmath1 norm , and the optimal inertia allocation problem",
    ". then the objective satisfies @xmath107 where @xmath108 , @xmath109 , @xmath110 , and @xmath111 .",
    "let us express the observability gramian @xmath100 as the block matrix @xmath112 with this notation , the squared @xmath0 norm , @xmath113 reads as @xmath114 where we used the ring commutativity of the trace and the fact that @xmath115 and @xmath116 are diagonal and therefore commute",
    ".    the constraint can be expanded as @xmath117 a + a^{\\mathsf{t } } \\left[\\begin{matrix } x_1 & x_0 \\\\",
    "{ x_0}^{\\mathsf{t } } & x_2 \\\\",
    "\\end{matrix}\\right ] +   \\left[\\begin{matrix }   n & 0 \\\\ 0 &   s\\\\ \\end{matrix}\\right ] = 0.\\ ] ] by right - multiplying the ( 1,1 ) equation of by the moore - penrose pseudo - inverse @xmath118 of the laplacian @xmath119 , we obtain @xmath120 by the constraint we have that @xmath121p = \\left[{\\mathbbold{0}_{n}}^{\\mathsf{t } } ~ { \\mathbbold{0}_{n}}^{\\mathsf{t}}\\right]$ ] which implies @xmath122 .",
    "this fact together with the identity @xmath123 , implies that @xmath124 .",
    "then , by using the ring commutativity of the trace , and its invariance with respect to transposition of the argument , we obtain @xmath125 on the other hand , equation ( 2,2 ) of implies that @xmath126 similarly as before we left - multiply by @xmath116 , use trace properties and the commutativity of @xmath116 and @xmath127 , and obtain @xmath128 thus , and together deliver @xmath129 from ( [ eq : tracenew ] ) we obtain the relations @xmath130 which can be further bounded as @xmath131 the structural similarity of and allows us to state upper and lower bounds by rewriting as in .",
    "notice that in the bounds proposed in theorem  [ theorem : bounds on performance index ] , the network topology described by the laplacian @xmath119 enters only as a constant factor , and is decoupled from the decision variables @xmath24 .",
    "moreover , in the case @xmath132 ( short - range error penalty on angles differences ) , this offset term becomes just a function of the grid size : @xmath133 .",
    "theorem  [ theorem : bounds on performance index ] ( and its proof ) sheds some light on the nature of the optimization problem that we are considering , and in particular on the role played by the mutual relation between disturbance strengths @xmath134 , damping coefficients @xmath25 , their ratios @xmath135 , frequency penalty weights @xmath38 , and the decision variables @xmath24 .",
    "these insights are further developed in the next section .      in this section",
    ", we consider some special choices of the performance metric and some assumptions on the system parameters , which are practically relevant and yield simplified versions of the general optimization problem , enabling in most cases the derivation of closed - form solutions .",
    "we first consider the performance index corresponding to the effort of primary control . as a remedy to mitigate low - inertia frequency stability issues ,",
    "additional fast - ramping primary control is often put forward @xcite .",
    "the primary control effort can be accounted for by the integral quadratic cost @xmath136 hence , the effort of primary control mimics the @xmath1 performance where the performance matrices in are chosen as @xmath137 and @xmath138 .",
    "this intuitive cost functions allows an insightful simplification of the optimization problem .    *",
    "( primary control effort minimization ) * [ theorem : performance index for primary control cost ] consider the power system model - , the squared @xmath1 norm , and the optimal inertia allocation problem .",
    "for a performance output characterizing the cost of primary control : @xmath139 and @xmath137 , the optimization problem can be equivalently restated as the convex problem    [ eq : primarycontrol]@xmath140    where , we recall , @xmath134 describes the strength of the disturbance at node @xmath12 .",
    "with @xmath137 and @xmath141 , the lyapunov equation together with the constraint is solved explicitly by @xmath142 the performance metric as derived in therefore becomes @xmath143 this concludes the proof .",
    "the equivalent convex formulation yields the following important insights .",
    "first and foremost , the optimal solution to is unique ( as long as at least one @xmath134 is greater than zero ) and also independent of the network topology and the line susceptances .",
    "it depends solely on the location and strength of the disturbance as encoded in the coefficients @xmath134 .",
    "for example , if the disturbance is concentrated at a particular node @xmath12 with @xmath144 and @xmath145 for @xmath146 , then the optimal solution is to allocate the maximal inertia at node @xmath12 : @xmath147 . if the capacity constraint is relaxed , the optimal inertia allocation is proportional to the square root of the disturbance  @xmath148 .",
    "we now consider a different assumption that also allows to derive a similar simplified analysis in other notable cases .    *",
    "( uniform disturbance - damping ratio ) * [ ass : uniform disturbance - damping ratio ] the ratio @xmath149 is constant for all @xmath64 .",
    "notice that the droop coefficients @xmath150 are often scheduled proportionally to the rating of a power source , to guarantee fair power sharing @xcite .",
    "meanwhile , it is reasonable to expect that the disturbances due to variable renewable fluctuations scale proportionally to the size of the renewable power source .",
    "hence , assumption [ ass : uniform disturbance - damping ratio ] can be justified in many practical cases , including of course the case where both damping coefficient and disturbances are uniform across the grid . aside from that , assumption [ ass : uniform disturbance - damping ratio ] may be of general interest since it is common in many studies with a _ spatially invariant _ setting @xcite . under this assumption , we have the following result .",
    "* ( optimal allocation with uniform disturbance - damping ratio ) * [ theorem : properties of general performance index ] consider the power system model - , the squared @xmath1 norm , and the optimal inertia allocation problem .",
    "let assumption  [ ass : uniform disturbance - damping ratio ] hold .",
    "then the optimization problem can be equivalently restated as the convex problem    [ eq : uniformratio]@xmath151    where we recall that @xmath152 is the penalty coefficient for the frequency deviation at node @xmath12 .    from assumption [",
    "ass : uniform disturbance - damping ratio ] , let @xmath153 be constant for all @xmath64 . then we can rewrite as @xmath154 this is equal , up to the scaling factor @xmath155 , to the left hand side of .",
    "we therefore have @xmath156 which is equivalent , up to multiplicative factors and constant offsets , to the cost of the optimization problem .    again , as in theorem [ theorem : performance index for primary control cost ] , theorem [ theorem : properties of general performance index ] reduces the original optimization problem to a simple convex problem for which the optimal inertia allocation is _ independent _ of the network topology , and in most cases can be derived as a closed form expression of the problem parameters .",
    "while this conclusion can also be drawn from physical intuition , it clearly shows that cost function needs to be chosen insightfully .    under assumption",
    "[ ass : uniform disturbance - damping ratio ] , we can also identify an interesting special case .",
    "assume that the frequency penalty @xmath40 is chosen proportional to inertial coefficients , @xmath157 for some @xmath158 : @xmath159 this choice corresponds to penalizing the change in kinetic energy  a reasonable and standard penalty in power systems .",
    "we have the subsequent result , that follows directly by evaluating for this specific choice of @xmath160 ( which also includes the case where no frequency penalty is considered , i.e. @xmath161 , and therefore only angle differences are penalized ) .    *",
    "( kinetic energy penalization with uniform disturbance - damping ratio ) * let assumption  [ ass : uniform disturbance - damping ratio ] hold , and let the penalty on the frequency deviations be proportional to the allocated inertia , that is , @xmath162 .",
    "then the performance metric @xmath163 is independent of the inertia allocation , and assumes the form @xmath164 where @xmath153 , for all @xmath64 , is the uniform disturbance - damping ratio .      in this subsection ,",
    "we focus on a two - area power grid as in @xcite to obtain some insight on the nature of this optimization problem .",
    "we also highlight the role of the ratios @xmath165 , which play a prominent role in assumption  [ ass : uniform disturbance - damping ratio ] and the bounds .    in the case of a two - area system , it is possible to derive an analytical solution @xmath166 of the lyapunov equation , as a closed form function of the vector of inertia allocations @xmath24 .",
    "we thus obtain an explicit expression for the cost as @xmath167 where in the two - area case @xmath168 reduces to a rational function of polynomials of orders 4 in the numerator and the denominator , in terms of inertial coefficients @xmath169 .",
    "as the explicit expression is more convoluted than insightful , we will not show it here , but only report the following statements which can be verified by a simple but cumbersome analysis of the rational function @xmath168 :    1 .",
    "the problem admits a unique minimizer .",
    "2 .   for sufficiently large bounds",
    "@xmath103 , the budget constraint becomes active , that is , the optimizers satisfy @xmath170 . in this case",
    ", @xmath171 can be eliminated , and can be reduced to a scalar problem .",
    "3 .   in the absence of capacity constraints and for identical @xmath135 ratios and frequency penalties @xmath38",
    ", the optimal inertial coefficients are identical @xmath172 ( as predicted by theorem [ theorem : properties of general performance index ] ) . if @xmath173 , then @xmath174 ( see the example in figure  [ fig:2nodetrace ] , where we eliminated @xmath175 ) .",
    "4 .   for sufficiently uniform @xmath165 ratios , the problem is strongly convex .",
    "we observe that the cost function @xmath168 is fairly flat over the feasible set ( see figure  [ fig:2nodetrace ] ) .",
    "5 .   for strongly dissimilar @xmath165 ratios ,",
    "we observe a less flat cost function . if the disturbance affects only one node , for example , @xmath176 and @xmath177 , strong convexity is lost .",
    "ratios for the two - area case.,width=326 ]     + , with non - identical damping coefficients @xmath150 , with disturbances inputs varying from @xmath178 = [ 0,1]$ ] to @xmath178 = [ 1,0]$],title=\"fig : \" ] +    from the above facts , we conclude that the input scaling factors @xmath134 play a fundamental role in the determination of the optimal inertia allocation . to obtain a more complete picture ,",
    "we linearly vary the disturbance input matrices from @xmath178 = [ 0,1]$ ] to @xmath178 = [ 1,0]$ ] , that is , from a disturbance localized at node 2 to a disturbance localized at node 1 .",
    "the resulting optimizers are displayed in figure  [ fig_simb ] showing that inertia is allocated dominantly at the site of the disturbance , which is in line with previous case studies @xcite .",
    "notice also that depending on the value of the budget @xmath179 , the capacity constraints @xmath103 , and the @xmath165 ratios , the budget constraint may be active or not .",
    "thus , perhaps surprisingly , sometimes not all inertia resources are allocated .",
    "overall , the two - area case paints a surprisingly complex picture .      in subsections [ subsec : analytic closed - form results ] and",
    "[ subsec : two - area ] , we considered a subset of scenarios and cost functions that allowed the derivation of tractable reformulations and solutions of the inertia allocation problem . in this section",
    ", we consider the optimization problem in its full generality .",
    "similarly as in section  [ subsec : two - area ] and in , we denote by @xmath166 the solution to the lyapunov equation  , and we express the cost function @xmath180 as a function @xmath168 of the vector of inertia allocations .    in the following ,",
    "we derive an efficient algorithm for the computation of the explicit gradient @xmath181 of @xmath168 in . in general ,",
    "most computational approaches can be sped up tremendously if an explicit gradient is available . in our case ,",
    "an additional significant benefit of having a gradient @xmath181 of @xmath168 is that the large - scale set of nonlinear ( in the decision variables ) lyapunov equations can be eliminated and included into the gradient information . in the following , we provide an algorithm that achieves so , using the routine @xmath182 , which returns the matrix @xmath100 that solves @xmath183 together with @xmath184 .",
    "@xmath185 \\smallskip $ ] @xmath186 \\smallskip $ ] @xmath187    * ( gradient computation ) * [ theorem : gradient computation ] consider the objective function , where @xmath166 is a function of @xmath188 via the lyapunov equation .",
    "the objective function is differentiable for @xmath189 , and its gradient at @xmath188 is given by algorithm [ algorithm ] .",
    "the proof of theorem [ theorem : gradient computation ] is partially inspired by @xcite and relies on a perturbation analysis of the lyapunov equation combined with taylor and power series expansions .    in order to compute the gradient of at @xmath190 , we make use of the relation @xmath191 where @xmath192 is the directional derivative of @xmath193 in the direction @xmath194 , defined as @xmath195 whenever this limit exists . from",
    "we have that @xmath196 where @xmath100 is a solution of the lyapunov equation @xmath197 and where by @xmath198 we denote the system matrix defined in , evaluated at @xmath199 .",
    "the matrices @xmath198 and @xmath200 viewed as functions of scalar @xmath201 can thus be expanded in a taylor series around @xmath202 as @xmath203 with coefficients @xmath204 and @xmath205 , @xmath206 . to compute the coefficients of the taylor expansion in ,",
    "we recall the scalar series expansion of @xmath207 around @xmath208 : @xmath209 using the shorthand @xmath210 , we therefore have @xmath211    accordingly , the solution to the lyapunov equation can be expanded in a power series as @xmath212 and therefore the lyapunov equation becomes @xmath213 where we dropped the subscript @xmath214 for readability . by collecting terms associated with powers of @xmath201 , we obtain two lyapunov equations determining @xmath215 and @xmath216 :    [ lyap0 ] @xmath217 @xmath218    by the same reasoning as used for equation , the first lyapunov equation is feasible with a positive semidefinite @xmath215 satisfying @xmath219 . the second lyapunov equation is feasible by analogous arguments . finally ,",
    "by using together with and , we obtain @xmath220 where @xmath221 and @xmath222 from , it follows that @xmath223 as defined in , thereby implicitly establishing differentiability of @xmath224 .",
    "this concludes the proof , as the algorithm computes each component of the gradient @xmath181 by using the relation with the special choice of @xmath225 for @xmath64 .      in this subsection ,",
    "we focus on the planning problem of optimally allocating virtual inertia when economic reasons suggest that only a limited number of virtual inertia devices should be deployed ( rather than at every grid bus ) . since this problem is generally combinatorial , we solve a modified optimal allocation problem , where an additional @xmath226-regularization penalty is imposed , in order to promote a sparse solution @xcite .    the regularized optimal inertia allocation problem is then    [ eq : sparmin ] @xmath227    where @xmath228 trades off the sparsity penalty and the original objective function .    as in the allocations",
    "@xmath24 are lower bounded by a positive @xmath229 , the objective can be rewritten as : @xmath230 observe that the regularization term in the cost is linear and differentiable .",
    "thus , problem fits well into our gradient computation algorithm , and a solution can be determined within the fold of algorithm [ algorithm ] by incorporating the penalty term .",
    "likewise , our analytic results in section [ subsec : analytic closed - form results ] can be re - derived for the cost function .",
    "we highlight the utility of the performance - sparsity trade - off in section [ section : case study ] .",
    "thus far we have assumed knowledge of the disturbance strengths encoded in the matrix @xmath53 . while empirical disturbance distributions from historical data are generally available to system operators , the truly problematic and devastating faults in power systems are rare events that are poorly predicted by any ( empirical ) distribution .",
    "given this inherent uncertainty , it is desirable to obtain an inertia allocation profile which is optimal even in presence of the most detrimental disturbance .",
    "this problem fits into the domain of robust optimization or a zero - sum game between the power system operator and the adversarial disturbance .",
    "the robust inertia allocation problem can then be formulated as the min - max optimization problem    [ eq : genminprobfb]@xmath231    where @xmath232 = @xmath233 and where @xmath234 is convex hull of the set of possible disturbances with a non - empty interior . as a special instance , consider @xmath235 where we normalized the disturbances by @xmath236 .",
    "recall from , that the objective @xmath232 is linear in @xmath237 , and we can write it as @xmath238 , where @xmath239 for @xmath64 . hence , by strong duality , we can rewrite the inner maximization problem    @xmath240    as the equivalent dual minimization problem    @xmath241    where @xmath155 and @xmath242 are the dual variables associated with the constraints .",
    "the min - max problem is then equivalentto :    [ eq : genminprobfb-2]@xmath243    the minimization problem has a convex objective and constraints , barring .",
    "however , we already have the gradient of the individual elements , @xmath244 which can be computed from algorithm  [ algorithm ] as @xmath245 by substituting @xmath246 and @xmath247 for @xmath248 .",
    "the availability of the gradient of this set of non - linear equality constraints considerably speeds up the computation of the minimizer .    by direct inspection or computation",
    "( see section [ section : case study ] ) we observe that the robust optimal allocation profile tends to make the cost indifferent with respect to the location of the disturbance , as is customary for similar classes of min - max ( adversarial ) optimization problems .    for the special case of _ primary control effort minimization _ as in theorem [ theorem : performance index for primary control cost ] , the min - max problem simplifies to    [ eq : genminprobfb-3]@xmath249    in this case , the robust optimal allocation profile tends to make the inertia allocations @xmath24 equal for all @xmath12 s , inducing a _ valley - filling _ strategy that allocates the entire inertia budget and prioritizes buses with lowest inertia first .",
    "in this section , we investigate a 12-bus case study illustrated in figure  [ fig_sim ] .",
    "the system parameters are based on a modified two - area system from ( * ? ? ?",
    "* example 12.6 ) with an additional third area , as introduced in @xcite .",
    "after kron reduction of the passive load buses , we obtain a system of 9 buses , corresponding to the nodes where inertia can be allocated . + we investigate this example computationally using algorithm  [ algorithm ] to drive standard gradient - based optimization routines , while highlighting parallels to our analytic results .",
    "we analyze different parametric scenarios and compare the inertia allocation and the performance of the proposed numerical optimization ( which is a locally optimal solution ) with two plausible heuristics that one may deduce from the conclusions in @xcite and the special cases discussed following theorem [ theorem : performance index for primary control cost ] : namely the uniform allocation of the available budget , in the absence of capacity constraints , that is , @xmath250 ; or the allocation of the maximum inertia allowed by the bus capacity constraints in the absence of a budget constraint , that is , @xmath251 ( which we set as @xmath252 ) .",
    "[ [ uniform - disturbance ] ] uniform disturbance + + + + + + + + + + + + + + + + + + +    we first assume that the disturbance affects all nodes identically , @xmath253 . in figure",
    "[ fig : grid1 ] we consider the case where there are only capacity constraints at each bus , and we compare the different allocations vis -  - vis : the initial inertia @xmath254 , a locally optimal solution @xmath255 , and the maximum inertia allocation @xmath256 .",
    "figure  [ fig : grid2 ] compares the results in the case where there is only a budget constraint on the total allocation .",
    "we compare the initial inertia @xmath254 , the locally optimal allocation @xmath255 , and the uniform placement @xmath257 .",
    "[ [ localized - disturbance ] ] localized disturbance + + + + + + + + + + + + + + + + + + + + +    we then consider the scenario where a localized disturbance affects a particular node , in this example , node 4 with @xmath258 . as in figures  [ fig : grid1 ] and [ fig : grid2 ] , a comparison of the different inertial allocations and the performance values is presented in figures  [ fig : grid3 ] and [ fig : grid4 ] for the cases of capacity and budget constraints .                             for ( a ) uniform disturbance , ( b ) localized disturbance at node 4 with capacity constraints .",
    "0% performance loss corresponds to the optimal allocation , 100% performance loss corresponds to no additional inertia allocation . ]",
    "we draw the following conclusions from the above test cases  some of which are perhaps surprising and counterintuitive .    1 .",
    "first , our locally optimal solution achieves the best performance among the different heuristics in all scenarios .",
    "2 .   in the case of uniform disturbances with only capacity constraints on the individual buses ( figure  [ fig : grid1 ] ) , the optimal solution does not correspond to allocating the maximum possible inertia at every bus .",
    "3 .   in the case of uniform disturbances with only the total budget constraint ( figure  [ fig : grid2 ] ) ,",
    "the optimal solution is remarkably different from the uniform allocation of inertia at the different nodes .",
    "4 .   in case of uniform disturbances ,",
    "the performance improvement with respect to the initial allocation and the different heuristics is modest .",
    "this confirms the intuition developed for the two - area case ( section  [ subsec : two - area ] ) regarding the flatness of the cost function .",
    "5 .   in stark contrast is the case of a localized disturbance , where adding inertia dominantly to disturbed node is an optimal choice in comparison to heuristic placements .",
    "the latter is also in line with the results presented for the two - area case and the closed - form results in theorem  [ theorem : performance index for primary control cost ] .",
    "6 .   in the case of a localized disturbance ,",
    "adding inertia to all undisturbed nodes may be detrimental for the performance , even for the same ( maximal ) allocation of inertia at the disturbed node , as shown in figure  [ fig : grid3 ] .",
    "the optimal robust allocation approach proposed in section  [ subsection : robustness ] is investigated in figures  [ fig : robust1 ] and [ fig : robust2 ] .",
    "these figures depict the optimal inertia profiles which are robust to disturbance location and furthermore have a significantly lower worst - case cost compared to the heuristics .",
    "the sparsity - promoting approach proposed in section  [ subsection : l1_norm ] is examined in figure  [ fig : gridn ] . for a uniform disturbance without a sparsity penalty ,",
    "inertia is allocated at all nine buses of the network . for @xmath259 an allocation at only seven buses is optimal with hardly a 1.3% degradation in performance . for sparser allocations ,",
    "the trade - off with performance becomes more relevant .",
    "the sparsity effect is significantly pronounced for localized disturbances .",
    "the optimal solution for @xmath260 for a localized disturbance at node 4 , requires allocating inertia at buses ( 4 , 6 ) .",
    "however , for @xmath261 , we observe an allocation of inertia only at bus 4 does not affect the performance significantly , while being preferable from an economic perspective .",
    "figure  [ fig : grid7 ] shows the time domain responses to a localized impulse at node 4 , modeling a post - fault condition .",
    "subfigure ( a ) ( respectively , ( b ) ) show that the optimal inertia allocation according to the proposed @xmath74 performance criteria is also superior in terms of peak ( overshoot ) for angle differences ( respectively , frequencies ) .",
    "subfigure ( c ) displays the frequency response at node 5 of the system .",
    "note from the scale of this plot that the deviations as potentially insignificant .",
    "similar comments apply to other signals which are not displayed here .",
    "finally subfigure ( d ) shows the control effort @xmath262 expended by the virtual inertia emulation at the disturbed bus .",
    "perhaps surprisingly , observe that the optimal allocation @xmath263 requires the least control effort .",
    "figure  [ fig : grid8 ] plots the eigenvalue spectrum for different inertia profiles .",
    "the case of no additional allocation , @xmath264 , marginally outperforms with respect to both the best damping asymptote ( most damped nonzero eigenvalues ) as well as the best damping ratio ( narrowest cone ) . as apparent from the time - domain plots in figure  [ fig : grid7 ]",
    ", this case also leads to the worst time - domain performance ( with respect to overshoots ) compared to the optimal allocation @xmath255 , which has slightly poorer damping asymptote and ratio .",
    "these observations reveal that the spectrum holds only partial information , and advocate the use of the @xmath1-norm as opposed to spectral performance metrics ( as in @xcite ) .",
    "we considered the problem of placing virtual inertia in power grids based on an @xmath0 norm performance metric reflecting network coherency .",
    "this formulation gives rise to a large - scale and non - convex optimization program .",
    "for certain cost functions , problem instances , and in the low - dimensional two - area case , we could derive closed - form solutions yielding some , possibly surprising insights .",
    "next , we developed a computational approach based on an explicit gradient formulation and validated our results on a three - area network .",
    "suitable time - domain simulations demonstrated the efficacy of our locally optimal inertia allocations over intuitive heuristics .",
    "we also examined the problem of allocating a finite number of virtual inertia units via a sparsity - promoting regularization .",
    "all of our results showcased that the optimal inertia allocation is strongly dependent on the location of disturbance .",
    "our computational and analytic results are well aligned and suggest insightful strategies for the optimal allocation of virtual inertia .",
    "we envision that these results will find application in stabilizing low - inertia grids through strategically placed virtual inertia units . as part of our future work",
    ", we consider the extension to more detailed system models and specifications as well as a comparison with the results in @xcite .",
    "the authors wish to thank mihailo jovanovic , andreas ulbig , theodor borsche , dominic gross , and ulrich mnz for their comments on the problem setup and analysis methods ."
  ],
  "abstract_text": [
    "<S> a major transition in the operation of electric power grids is the replacement of synchronous machines by distributed generation connected via power electronic converters . the accompanying `` loss of rotational inertia '' and the fluctuations by renewable sources jeopardize the system stability , as testified by the ever - growing number of frequency incidents . as a remedy , </S>",
    "<S> numerous studies demonstrate how virtual inertia can be emulated through various devices , but few of them address the question of `` where '' to place this inertia . </S>",
    "<S> it is however strongly believed that the placement of virtual inertia hugely impacts system efficiency , as demonstrated by recent case studies . in this article </S>",
    "<S> , we carry out a comprehensive analysis in an attempt to address the optimal inertia placement problem . </S>",
    "<S> we consider a linear network - reduced power system model along with an @xmath0 performance metric accounting for the network coherency . </S>",
    "<S> the optimal inertia placement problem turns out to be non - convex , yet we provide a set of closed - form global optimality results for particular problem instances as well as a computational approach resulting in locally optimal solutions . </S>",
    "<S> further , we also consider the robust inertia allocation problem , wherein the optimization is carried out accounting for the worst - case disturbance location . </S>",
    "<S> we illustrate our results with a three - region power grid case study and compare our locally optimal solution with different placement heuristics in terms of different performance metrics . </S>"
  ]
}