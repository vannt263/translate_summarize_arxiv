{
  "article_text": [
    "cold dark matter models with a cosmological constant ( @xmath0cdm ) are successful in explaining a wide array of kinematic and structural properties of the observed universe .",
    "a critical test of the @xmath0cdm model is how well it predicts the abundance of dark matter haloes , which serve as hosts for observable clusters , groups , and galaxies .",
    "simulations that resolve haloes out to high redshift can be used to model the evolution of the numbers of observable high redshift objects , their progenitors , and their evolved descendants .",
    "lyman break galaxies , for example , observed at redshifts out to z @xmath4 4 ( e.g.  steidel et al .",
    "1996 ) are likely progenitors of groups or clusters ( governato et al .",
    "1998 ; governato et al .",
    "2001 ) , and we are able to model their numbers over their entire observable lifespan",
    ". many objects , however , lie outside the realm that can presently be simulated because their number densities , masses , or redshifts are too extreme . for example , to model a reasonably sized sample of the hosts of the highest redshift ( z @xmath4 6 ) quasi - stellar objects ( qsos ) , whose number density has been measured by the sloan digital sky survey ( fan et al .",
    "2001 ) , would require a simulation with volume roughly as large as the observable universe with ( so far ) prohibitively high particle numbers .",
    "simulations of adequate resolution and volume could be used , in principle , to estimate the host masses of such rare qsos , or to estimate cosmological parameters after assuming host masses , by matching predicted and observed number densities . however , with much less computational effort , by modeling smaller cosmological volumes at higher redshift , we are able to test analytic mass functions in the same regime of rare density enhancements . generally , rare density peaks correspond to high values of m / m@xmath6 , where m@xmath6 is the ` characteristic ' mass of a typical collapsing halo at that epoch ( to be discussed later ) . by modeling haloes over a wide range of m / m@xmath6 , we can constrain analytic mass functions for ranges of redshift and mass that have not yet been simulated .",
    "this is possible because analytic mass functions are generally derived from assumptions of how linear density fluctuations lead to halo collapse , and thereby have no explicit redshift dependence .",
    "high redshift qso hosts , galaxy progenitors , and perhaps even the first generation of stars are all examples of high @xmath7 objects whose mass functions can presently only be calculated analytically .    press & schechter ( p - s , 1974 ) developed an analytical framework that predicts the number and formation epoch of dark matter haloes . in p -",
    "s theory , as the universe evolves , linear density fluctuations grow gravitationally until they reach a critical spherical overdensity , at which time non - linear gravitational collapse is assumed to occur .",
    "cosmological numerical simulations have shown the p - s framework to be approximately correct , but p - s theory consistently underpredicts the number of high mass haloes and overestimates the number of haloes less than about @xmath8 ( e.g.  efstathiou et al .",
    "1988 ; gross et al .  1998 ; governato et al .  1999 ; jenkins et al .",
    "2001 ; white 2002 ) even when merging of dark matter haloes is included in predictions ( bond et al .",
    "1991 ; bower 1991 ; lacey & cole 1993 ; gardner 2001 ) , though the high mass end fits well if the finite size of haloes is taken into account ( yano , nagashima , & gouda 1996 ; nagashima 2001 ) .",
    "ellipsoidal halo collapse models ( e.g.  monaco 1997ab ; lee & shandarin 1998 ; sheth , mo , & tormen 2001 ) yield much more robust predictions than the conventional spherical collapse models , and are in excellent agreement with empirical fits by sheth & tormen ( 1999 ) .",
    "monaco et al .",
    "( 2001 ) , using the semi - analytic code pinocchio , which uses a perturbative approach , show that the dark matter halo distribution can be accurately predicted at much lower computational cost , on a point - by - point basis , from a numerical realization of an initial density field .",
    "jenkins et al .  ( 2001 ) utilize a large set of simulations of a range of volumes and cosmologies ( jenkins et al .",
    "1998 ; governato et al .",
    "1999 ; evrard et al .",
    "2002 ) to test the sheth & tormen ( s - t ) mass function over more than four orders of magnitude in mass , and out to a redshift of 5 , finding good agreement with the s - t function down to their resolution limit of @xmath9 , except for an overprediction by the s - t function for haloes at rare density enhancements . in this study",
    ", we probe previously untested regimes of the mass function by simulating a volume that resolves haloes down to the scale of @xmath10 dwarfs , in a cosmological environment , allowing us to sample the mass function back to z@xmath415 .",
    "our paper is outlined as follows : in section 2 , we describe our simulations and numerical techniques ; in section 3 , we review the analytic theory ; then we discuss our results and compare with previous work in section 4 ; we conclude with a discussion of the implications of our work .",
    "our cosmology is the presently favored @xmath0cdm with @xmath11 and @xmath12 .",
    "we use the parallel tree gravity solver pkdgrav ( stadel 2001 ) to simulate @xmath13 ( 432@xmath14 ) dark matter particles from a starting redshift , z@xmath15 , of 69 .",
    "we then resimulate the same volume but with z@xmath16139 , and evolve this volume to z@xmath177 ; which allows us to consider results at higher redshift than with the z@xmath1669 run . in order to simulate the highest possible mass resolution",
    ", we employ a volume of 50 @xmath1mpc on a side .",
    "our particle mass is @xmath18 allowing us to resolve haloes down to less than @xmath19 with 75 particles .",
    "our force resolution is 5 @xmath1kpc .",
    "we use a cell opening angle of @xmath20 0.8 at low redshift , and @xmath20 0.7 at z @xmath21 2 . in section 4.2 , we discuss tests that confirm that our choices of initial redshift , softening , and high redshift opening angle are adequate ( see table 1 ) .",
    "we use a `` multistepping '' approach , where particles in the highest density regions undergo 16,000 timesteps .",
    "timesteps were constrained to @xmath22 , where @xmath23 is the softening length and @xmath24 is the magnitude of the acceleration of a given particle .",
    "we normalize the density power spectrum of our initial conditions such that @xmath25 , the rms density fluctuation of spheres of 8 @xmath1mpc extrapolated to redshift of zero is 1.0 , consistent with both the cluster abundance ( see e.g.  eke , cole , & frenk 1996 and references therein ) and the cobe normalization ( e.g.  ratra et al .",
    "to set our initial conditions , we use the bardeen et al .",
    "( 1986 ) transfer function with @xmath26 , where @xmath27 is the hubble constant in units of 100 @xmath28 .      in order to identify haloes in our simulation , we use both the _ friends - of - friends _ ( fof ) algorithm ( davis et al .  1985 ) , and the _ spherical overdensity _",
    "( so ) algorithm ( lacey & cole 1994 ) .",
    "the fof halo finder uses a `` linking length '' , _ ll _ , to link together all neighboring particles with spacing closer than _ ll _ as members of a halo .",
    "so identifies haloes by identifying spherical regions with the expected spherical overdensities of virialized haloes . for our so haloes , we first use skid ( stadel 2001 ) to identify all bound haloes , including those that are subhaloes within larger haloes .",
    "next , we grow a sphere outward from each skid center until it just contains the virialized overdensity",
    ". finally , we iterate by growing spheres outward from all neighboring skid haloes until we have identified the center of mass for each so halo . for our so criterion",
    ", we use the virial overdensity predicted by the spherical collapse tophat model of eke , cole , & frenk ( 1996 ) . in a @xmath0cdm universe , the virial overdensity , in units of critical density , declines from an asymptotic value of 178 as cosmic time increases and @xmath29 drops below 1 ; for redshift of zero , the @xmath0cdm overdensity _",
    "@xmath30 _ is 100 ( kitayama & suto 1996 ) .",
    "we exclude haloes that contain less than 64 particles , which is conservative , as it is more than the estimated 20 or 30 particles needed for a robust halo identification based on resolution tests ( jenkins et al .",
    "2001 ; governato et al .",
    "1999 ) .",
    "we utilize the fof algorithm for the bulk of our analyses since it is reasonably robust and computationally efficient .",
    "our fof _ ll _ choice is 0.2 for all redshifts ( except when matching @xmath31 from previous studies ) ; this approach has been shown to be sound for a range of cosmologies by jenkins et al .",
    "( 2001 ) , although the evolution of _ @xmath30 _ in the spherical collapse tophat model implies that @xmath31 should range from @xmath320.164 at z@xmath170 to @xmath320.2 at high redshift in @xmath0cdm cosmology ( lacey & cole 1994 ; eke , cole , & frenk 1996 ; jenkins et al .",
    "2001 ) . to test the sensitivity of the mass function to halo selection criteria",
    ", we apply both fof @xmath320.164 and so to our data at various redshifts , discussed in section 4.1 .",
    "analytic p - s formalism yields the following ( see jenkins et al .  2001 , whose notation we adopt in this section , and references therein for further discussion , which we summarize here ) : @xmath33,\\ ] ] where @xmath34 is the threshold spherical linear overdensity above which a region will collapse .",
    "@xmath34 depends only weakly on the cosmological parameters and redshift ( e.g.  more , heavens , & peacock 1986 ; jenkins et al .",
    "2001 ) , and @xmath35 for @xmath36 . in our analysis",
    ", we assume that @xmath35 at all redshifts .",
    "@xmath37 is the variance of the linear density field , smoothed with a spherical top - hat filter enclosing mass @xmath38 , and is calculated from the linear density power spectrum @xmath39 , extrapolated to @xmath40 : @xmath41 where @xmath42 is the fourier - space top - hat filter , and @xmath43 is the growth factor of linear perturbations normalized to unity at z@xmath170 ( peeble 1993 ) . in the p - s formalism ,",
    "all mass is contained in haloes : @xmath44 the mass function @xmath45 can be related to the number density , @xmath46 , of haloes with mass less than @xmath38 : @xmath47 where @xmath48 is the mean density of the universe at that time .",
    "the s - t model is a modification to the p - s model based on empirical fits to simulations ( sheth & tormen 1999 ) , has been shown to reproduce simulation results substantially better than p - s ( e.g.  jenkins et al .",
    "2001 ; white 2002 ) , and is theoretically justified in that it matches p - s formalism derived with ellipsoidal halo collapse models ( sheth , mo , & tormen 2001 ) : @xmath49 { \\delta_c\\over\\sigma}\\exp\\bigg[-{a\\delta_c^2\\over2\\sigma^2}\\bigg],\\ ] ] where a=0.3222 , @xmath50 and @xmath51 .",
    "jenkins et al .  ( 2001 ) offer an empirical fit using high resolution simulations of a range of cosmologies .",
    "their fit is constructed in the @xmath52 plane , which has the advantage of being invariant with redshift : @xmath53.\\ ] ] the jenkins et al .",
    "function adjusts for an overprediction by the s - t function for the rare objects at large @xmath54 , and is calibrated for the range @xmath55 , which corresponds to masses down to approximately 3@xmath56 at present epoch , and includes haloes out to z@xmath175 , with fof fixed at @xmath320.2 .",
    "in each of these analytic functions , virialized haloes have a characteristic mass ,",
    "_ @xmath8(z ) _ : @xmath57 and @xmath58 .",
    "@xmath43 evolves as @xmath59 in an @xmath36 universe , and more slowly in a @xmath0cdm universe .",
    "@xmath60 decreases slowly with increasing mass , which leads to the steep redshift dependence of @xmath8(z ) , shown in fig . 1 for the @xmath0cdm universe , and results in a broad mass spectrum of collapsed objects",
    ". an important test of analytic mass functions is the accuracy of their predictions at high values of @xmath7 and @xmath61 . at low redshift",
    ", high @xmath7 haloes would have unrealistically large masses , but at high redshift the steep evolution of @xmath8 puts high @xmath7 objects well into the realm of simulations .",
    "furthermore , the evolution of halo masses that correspond to high @xmath2 density enhancements means that rare haloes are most easily simulated at high redshift ( fig .",
    "1 ) . our simulations model the mass function of haloes lying at up to 4@xmath2 density fluctuations .",
    "2 , we compare the analytic version of the p - s , the s - t , and the jenkins et al .  mass function with our simulation results at several redshifts .",
    "the s - t function provides the best fit to our simulation with excellent agreement at all masses and redshifts except for our highest redshift outputs .",
    "the p - s function overpredicts substantially everywhere except at the low and high mass extremes . and",
    "the jenkins et al .  mass function fits much of our data well at z@xmath170 , but diverges from our simulation results once well below the limit of its empirical fit of @xmath62 , which corresponds to @xmath63 with @xmath64 .",
    "note that @xmath65 is sensitive to @xmath25 , so for a @xmath66 @xmath0cdm model , which was used in many of the simulations that were part of the jenkins et al .",
    "fit , @xmath62 would correspond to only @xmath67 .",
    "[ fig : nsubm ]    in fig .",
    "3 , we show the evolution of the mass function over all of our redshifts compared to its s - t predicted evolution .",
    "the s - t function provides an excellent fit to our data , except at very high redshifts , where it significantly overpredicts the halo abundance . at all redshifts up to z@xmath1710 ,",
    "the difference is @xmath68 for each of our well sampled mass bins .",
    "however , the s - t function begins to overpredict the number of haloes increasingly with redshift for z@xmath6910 , up to @xmath70% by z@xmath1715 .",
    "the simulation mass functions appear to be generally steeper than the s - t function , especially at high redshifts . in fig .",
    "4 , we show the evolution of the mass function over all of our redshifts as a function of @xmath7 .",
    "this highlights the remarkable accuracy of the s - t mass function over more than 10 decades of @xmath7 .",
    "[ fig : tilediff ]    [ fig : tilemstar ]    in fig . 5 , we plot the mass function for all of our outputs in the @xmath71 plane .",
    "large values of @xmath54 correspond to rare haloes of high redshift and/or high mass , while small values of @xmath54 describe haloes of low mass and redshift combinations . in fig .",
    "6 , we compare our simulated mass function with the s - t prediction , by plotting the residuals over our entire range .",
    "we limit plotted data to bins with poisson errors of less than 20% .",
    "remarkably , the s - t function fits our simulated mass function to better than 10@xmath5 over the range of -1.7 @xmath72 0.5 .",
    "we are unaware of any previous studies that probe the mass function down to such low values of @xmath54 in a cosmological environment .",
    "the s - t function appears to significantly overpredict haloes for @xmath73 0.5 .",
    "this is the same overprediction seen in the number density for @xmath74 in figs . 3 and 4 .",
    "the large apparent scatter of the mass function for ln@xmath75 0.5 is due to larger poisson errors in this range . for large ln@xmath76",
    ", we estimate the uncertainty in the mass function due to cosmic variance by estimating the contribution of linear fluctuations on the scale of the box size .",
    "cosmic variance can have large effects on results since it has the potential to increase or decrease the mass function in multiple mass bins simultaneously , and cosmic variance is difficult to quantify without a large set of simulated volumes . in our estimation",
    ", we use a second order taylor expansion of @xmath77 , ignoring the first order term since we have imposed the average density of our simulation to be @xmath78 . the resulting estimate for the uncertainty in the mass function due to cosmic variance",
    "is @xmath79 , which we evaluate numerically . in our well sampled , low redshift mass bins ,",
    "@xmath80 is negligible . for our highest redshift results ,",
    "@xmath80 is smaller than our poisson error limit of 20@xmath5 for figures 6 and 7 , even for our highest mass bins .",
    "however , @xmath80 approaches our poisson error limit of 20@xmath5 for our @xmath8114.5 output . for our @xmath8110 and @xmath8112 outputs ,",
    "@xmath80 is less than 10@xmath5 in bins where poisson errors are less than 10@xmath5 , which is the case for most of our bins at that redshift .",
    "thus , while cosmic variance is a significant source of error where the mass function is steepest , it is unlikely to entirely account for our discrepancy with the s - t function .",
    "we note that several of our @xmath82 points lie roughly 3@xmath2 above the mean ; this is actually just one mass bin plotted repeatedly at different redshifts , and so is not entirely surprising . by careful examination of ranges of ln@xmath76 where outputs of different redshifts overlap , we verify that the magnitude of the s - t overprediction at high values of ln@xmath76 is consistent with being a function purely of ln@xmath76 rather than redshift , a natural consequence of the fact that the mass function is self similar in time ( e.g.  efstathiou et al .  1988 ; lacey & cole 1994 ; jenkins et al .",
    "jenkins et al .",
    "( 2001 ) also find an overprediction by the s - t function for @xmath83 , which with their larger simulation volumes , corresponded primarily to objects of z@xmath842 and of much higher mass .",
    "additionally , jenkins et al .",
    "find the mass function to be invariant with redshift within their own results . in fig .",
    "7 , we compare a subset of our data with the jenkins et al",
    ".  `` universal '' mass function .",
    "we note that when extrapolated to @xmath85 , well below its empirical fit range of @xmath55 , the jenkins et al .",
    "function diverges from our results , reflecting the fact that it is of a form not ideally suited for extrapolation .",
    "where our data overlap ( @xmath86 ) , we find generally good agreement , although we have @xmath87 fewer haloes and a somewhat steeper mass function at @xmath88 . over the range of -1.4 @xmath89 0.75 , the jenkins et al .",
    "mass function matches our data to within @xmath90 .",
    "we consider the possibility that this difference between our data and the jenkins et al .",
    "fit could be due to differences in the effective slope of the power spectrum , n@xmath91 , where @xmath92 . applying a simple power law to eqn .",
    "2 yields @xmath93 , which can be reparameterized as @xmath94 ( jenkins et al .",
    "8 shows the @xmath95 parameter space that our results cover .",
    "our data generally has a steeper @xmath96 than jenkins et al .",
    ", though there is some overlap , especially at lower redshifts .",
    "since the slope of the linear power spectrum is invariant with redshift for a given @xmath97 , n@xmath98 is constant for a given mass , meaning that for our lowest mass haloes we sample nearly all of our @xmath99 at an n@xmath100 .",
    "if we consider @xmath101 , where the power spectrum begins to go nonlinear , then we find that our results differ significantly from the jenkins et al .",
    "function only where @xmath96 at the nonlinear scale is steepest .",
    "in particular , the disagreement is worst at z@xmath10210 where @xmath101 exceeds their maximum value of -2.26 .",
    "thus , there is a possibility that our steeper values of n@xmath91 results in an @xmath99 with a slightly different shape , which might account for the difference with prior results , but a larger set of simulations with still steeper @xmath96 would be needed to clearly show any such dependence .",
    "[ fig : stbig ]    [ fig : stdiff ]    [ fig : jenkdiff ]    [ fig : neff ]    since no mass function that we have considered is accurate for the entire range of our data , we consider the possibility of an empirical adjustment to the s - t function .",
    "we insert a crude multiplicative factor to the s - t function as follows , with @xmath34 @xmath17 1.686 and fof @xmath320.2 ( fig .",
    "6 ) : @xmath103 ^ 5)]\\bigg],\\ ] ] valid over the range of -1.7 @xmath72 0.9 .",
    "the resulting function is virtually identical to the s - t function for all @xmath104 . at higher values of @xmath54 , this function declines relative to the s - t function , reflecting an underabundance of haloes that becomes greater with increasing @xmath54 . for -1.7",
    "@xmath105 0.5 , eqn .",
    "9 matches our data to better than 10@xmath5 for well - sampled bins , while for 0.5 @xmath105 0.9 , where poisson errors are larger , our data is matched to roughly 20@xmath5 .",
    "we must caution that though eqn .",
    "9 is a good fit to our data , it differs from the s - t function in the regime where poisson and cosmic errors are highest , and where our results are most prone to potential numerical errors because of the steepness of the mass function .",
    "our results are more robust in the low @xmath54 regime .",
    "note that in the eqn .",
    "9 fit , not all mass belongs to a halo , so eqn .",
    "3 is not valid .",
    "other authors have noted the advantages and disadvantages of the fof and so algorithms ( see jenkins et al .",
    "2001 and references therein ) .",
    "the fof method has the advantage that it can identify haloes of any shape as long as their minimum local number density is at least roughly @xmath106 , and fof is generally computationally cheaper than so .",
    "however , fof can sometimes spuriously link together haloes that lie close together within a filament ( see e.g.  governato et al .",
    "1997 ) . in fig .",
    "9 , we compare fof mass functions of our simulation with the corresponding so mass functions for a range of redshifts .",
    "note that the vertical axes are somewhat arbitrary for the z@xmath1710 and z@xmath1715 outputs as these were made from the z@xmath107 version of the simulation which had a somewhat suppressed mass function , which we discuss in section 4.2 .",
    "the halo finders have excellent agreement at low redshifts , with differences of @xmath68 over the range where the mass function is well sampled .",
    "differences in the high mass bins are due to a combination of different mass calculations for individual selected clusters as well as offset mass bins .",
    "the steep dropoff in the so mass function for low masses is due to a our exclusion of skid haloes of less than 64 particles as potential so centers . at high redshifts , fof",
    "@xmath320.2 produces a substantially higher mass function than fof @xmath320.164 or so , which are similar to each other , implying sensitivity to @xmath31 for large @xmath54 , probably because the mass function is steep there , and thus sensitive to halo selection criteria . to verify that the discrepancy of fof @xmath320.2 with so is not due simply to our choice of using skid haloes as our initial so centers",
    ", we have included a high redshift ( z@xmath1710 ) so mass function which uses fof haloes as initial so centers ; our choice of centers from which to grow our so spheres has no effect on the so mass function .",
    "a visual inspection in which halo members are `` marked '' , reveals that at high redshift , fof @xmath320.2 links together some neighboring haloes connected by filaments , but fof also identifies some individual haloes ( often of highly elongated shape ) that are missed by so , so neither algorithm is ideal .",
    "the overprediction of the s - t function for rare objects worsens somewhat if we use so derived mass functions .",
    "using a linking length that varies with redshift in an attempt to match the varying overdensity of virialized haloes , would have little effect on our mass function , since at low redshift the mass function is insensitive to @xmath31 , and at high redshift @xmath1081 , implying @xmath320.2 ( davis et al .",
    "1985 ; lacel & cole 1994 ) .",
    "however , had we sampled large @xmath54 at low redshift , adjusting @xmath31 to match virial overdensity would likely have a significant effect .",
    "[ fig : sofof ]      we check that the disagreement of s - t which appears at high redshift is not a result of delayed halo collapse due to numerical errors that can be caused by too large of a gravitational softening length .",
    "we make additional checks addressing potential numerical errors caused by mapping particles with zeldovich displacements ( zeldovich 1970 ) onto a particle grid ; an insufficiently high starting redshift could delay collapse of the first haloes ( e.g.  jenkins et al .",
    "2001 ) . if initial conditions are set with some regions having overdensities high enough to already be in the non - linear regime , then the linear zeldovich mapping can not account for shell - crossing wherein mass piles up as it flows toward overdensities .",
    "the effects of either of these error sources , if present , should have evolved away by lower redshifts , since the tiny fraction of matter that is in haloes at such high redshifts is soon incorporated into clusters or large groups .",
    "[ cols=\"<,<,<,<,<,<,<,<\",options=\"header \" , ]     table 1 lists our test runs , each of which consists of an identical 432@xmath14 particle volume with identical random waves , and is evolved to z@xmath177 .",
    "10 shows the mass function for z@xmath47 - 15 for our low softening test run , started from z@xmath1669 , and plotted relative to the s - t function along with our z@xmath1669 , 5 @xmath1kpc data .",
    "halving the softening to 2.5 @xmath1kpc has no effect on the mass function .",
    "11 shows the mass function for z@xmath47 - 15 for our initial redshift test runs , all with 5 @xmath1kpc softening . lowering the initial redshift to 39",
    "substantially reduces the number of high redshift haloes , so we did not evolve the z@xmath1639 run to z@xmath10910 .",
    "the z@xmath16139 run matches the z@xmath16279 run , indicating convergence , but the z@xmath1669 run has a reduced mass function relative to the z@xmath16139 run at redshifts z@xmath6912 .",
    "by z@xmath177 , however , the z@xmath16139 and z@xmath1669 mass functions have converged , showing that evolving the simulation over an expansion factor of @xmath410 from initial conditions is sufficient for mass function measurements .",
    "we consequently derive our low redshift ( z@xmath1097 ) results throughout this paper from the z@xmath1669 , 5 @xmath1kpc simulation , and utilize the z@xmath16139 run for our z@xmath1027 results .",
    "we make an additional test of z@xmath1027 cell opening angle , which is used to determine how accurately long range gravitational forces are to be approximated .",
    "if the cell opening angle is too large , then artificial net forces will be incurred upon particles , which could cause `` spurious '' haloes to form .",
    "this effect is most likely to occur at high redshifts when gravitational perturbations are small and force errors are fractionally larger . decreasing the opening angle from @xmath110=0.7 to @xmath110=0.5 , for our z@xmath16139 case , had no appreciable effect on the mass function for z@xmath1027 .",
    "we test that the number of replicas used for our periodic boundaries , n@xmath1111 , is adequate . with z@xmath16139 ,",
    "increasing n@xmath112 from 1 to 2 has no effect on the mass function .",
    "additionally , to test that our box size is adequate , we have verified that our z@xmath170 mass function agrees with the mass function from larger , lower resolution volumes where they overlap ( not included in table 1 ) .",
    "[ fig : soft ]    [ fig : z0 ]",
    "our results extend to lower masses and higher redshifts than the original empirical fit of the s - t mass function .",
    "the range of masses and redshifts over which the s - t mass function remains valid is quite remarkable , and though it does begin to break down at redshift @xmath69 10 in our results , no other function matches its range and accuracy .",
    "it is not well understood why the mass function can be described so well by solely @xmath60 .",
    "lacey & cole 1994 , in simulations with scale free power spectra , found evidence that the mass function depends on n@xmath91 as well as @xmath2 , though they tested a wider range in n@xmath91 than in more recent cdm simulations .",
    "the generally good agreement of our data with previous work at much shallower n@xmath91 implies that any such dependence is weak , though it may be manifested in our results where we differ from the s - t function . as n@xmath91 approaches -3",
    ", the growth of m@xmath6 with time diverges , so any dependence of f(@xmath2 ) on n@xmath91 is most likely to occur near that regime .",
    "simulations with finer mass resolution will be able to test yet steeper values of n@xmath91 .",
    "based on the apparent trend of the s - t function to overpredict halo numbers for objects of greater rarity , we expect that the overprediction of the s - t function may continue to worsen when even higher values of @xmath54 , or equivalently , when more extreme values of @xmath7 and redshift , are analyzed",
    ". theoretical work that focuses on halo collapse in this high @xmath54 range is needed to produce more robust predictions .    because the form of the mass function for low mass , low redshift haloes closely resembles a power law , we are cautiously optimistic that the s - t mass function will continue to provide a good match to simulation data as lower values of @xmath54",
    "are modeled , though this extrapolation will likely breakdown where n@xmath91 approaches -3 .",
    "simulations that model higher particle numbers ( leading to higher redshifts ) , are needed to extend the known range of the mass function of dark matter haloes .",
    "the accuracy of the s - t function for low mass haloes out to high redshifts has important implications for a number of astrophysical problems .",
    "evolution of the mass and luminosity functions down to dwarf scales permits comparison with surveys , providing important cosmological tests , and allows calculations of merger histories and star formation histories of galaxies , groups , and clusters .",
    "our results verify that the s - t function is accurate over the entire evolutionary range ( for which progenitors or descendants are observable ) of lyman break galaxies and groups of galaxies . assuming a weak dependence on n@xmath91 , the redshift invariance of the mass function implies that extrapolation of mass functions should be reliable for combinations of masses and redshifts that can not presently be simulated , as long as only values of @xmath54 that have been verified by simulation are considered .",
    "the number densities of low mass ( @xmath113 ) haloes at high redshift ( z @xmath114 10 ) , needed for studies of reionization , or galaxy formation ( e.g.  haiman 2002 ) , should be well described by the s - t function since although they lie below our mass range , they are within our range of simulated @xmath54 . for such extrapolation to be accurate down to indefinitely small masses ,",
    "all mass would have to be in dark matter haloes of some mass or else low mass haloes would be overpredicted .",
    "extrapolation of mass functions to large values of @xmath54 that have yet to be verified by simulations , however , are likely to be significantly in error , as suggested by the trend of increasing overprediction by the s - t function for high values of @xmath54 . though our results only reach @xmath44@xmath2 density peaks , there is a trend for the s - t function to increasingly overpredict the mass function for increasing @xmath2 beginning at @xmath43@xmath2 .",
    "the discrepancy with the s - t function for rare objects has significant implications for studies that make use of such rare objects as a cosmological probe .",
    "for example , the number density of high redshift ( z @xmath4 6 ) qsos , which are thought to be hosted by haloes at 5@xmath2 peaks in the fluctuation field ( haiman & loeb 2001 ; fan et al .",
    "2001 ) , are likely to be overpredicted by at least a factor of 50@xmath5 .",
    "some uncertainty is also introduced for studies employing the abundance of the highest redshift clusters to probe cosmological parameters ( e.g.  robinson , gawiser , & silk 2000 and references therein ) .      in summary ,",
    "we have utilized high resolution simulations to derive the mass function of dark matter haloes over an extended range in both mass and redshift over previous work .",
    "we find that the s - t mass function holds up exceptionally over more than 10 orders of magnitude of @xmath7 . for",
    "-1.7 @xmath105 0.5 , the s - t mass function is an excellent fit to our data , but begins to overpredict haloes for ln@xmath115 0.5 , or @xmath7",
    "@xmath116 10@xmath117 in our volume , reaching a @xmath11450@xmath5 discrepancy by ln@xmath118 0.9 , corresponding to @xmath7 @xmath114 10@xmath119 at z@xmath415 in our volume .",
    "we offer an empirical adjustment for the high ln@xmath120 portion of the s - t mass function .",
    "our results confirm the redshift invariance of the mass function .",
    "we graciously thank the referee , adrian jenkins , for extremely helpful suggestions for improvements to this paper .",
    "this work was supported , in part by nasa training grant ngt5 - 126 .",
    "our simulations were performed on the origin 2000 at ncsa and nasa ames , the ibm sp4 at the arctic region supercomputing center ( arsc ) , and the nasa goddard hp / compaq sc 45 .",
    "we thank chance reschke for dedicated support of our computing resources , much of which were graciously donated by intel ."
  ],
  "abstract_text": [
    "<S> we use a high resolution @xmath0cdm numerical simulation to calculate the mass function of dark matter haloes down to the scale of dwarf galaxies , back to a redshift of fifteen , in a 50 @xmath1mpc volume containing 80 million particles . </S>",
    "<S> our low redshift results allow us to probe low @xmath2 density fluctuations significantly beyond the range of previous cosmological simulations . </S>",
    "<S> the sheth and tormen mass function provides an excellent match to all of our data except for redshifts of ten and higher , where it overpredicts halo numbers increasingly with redshift , reaching roughly 50 percent for the @xmath3 haloes sampled at redshift 15 . </S>",
    "<S> our results confirm previous findings that the simulated halo mass function can be described solely by the variance of the mass distribution , and thus has no explicit redshift dependence . </S>",
    "<S> we provide an empirical fit to our data that corrects for the overprediction of extremely rare objects by the sheth and tormen mass function . </S>",
    "<S> this overprediction has implications for studies that use the number densities of similarly rare objects as cosmological probes . </S>",
    "<S> for example , the number density of high redshift ( z @xmath4 6 ) qsos , which are thought to be hosted by haloes at 5@xmath2 peaks in the fluctuation field , are likely to be overpredicted by at least a factor of 50@xmath5 . </S>",
    "<S> we test the sensitivity of our results to force accuracy , starting redshift , and halo finding algorithm .    </S>",
    "<S> [ firstpage ]    galaxies : haloes  galaxies : formation  galaxies : clustering  cosmology : theory  cosmology : dark matter </S>"
  ]
}