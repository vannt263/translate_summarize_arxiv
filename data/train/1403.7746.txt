{
  "article_text": [
    "music information retrieval ( mir ) is a hot research topic last years @xcite , @xcite , with quite a successful solving of such problems as automatic song identification through query - by - example , also using mobile devices @xcite , @xcite , and finding music works through query - by - humming @xcite . still , one of the unattainable goals of mir research is automatic score extraction from audio recordings , which is especially difficult for polyphonic data @xcite , @xcite .",
    "multi - pitch tracking combined with assignment of the extracted notes to particular voices ( instruments ) is a way to approach score extraction . therefore ,",
    "identification of instruments can be used to assign each note in a polyphonic and polytimbral sound to the appropriate instrument . however , the recognition of all playing instruments from recordings in polyphonic environment is still a challenging and unsolved task , related to multi - label classification of audio data representing a mixture of sounds .    in our work ,",
    "the target is to recognize all instruments playing in the analysed audio segment .",
    "no initial segmentation nor providing external pitch is required .",
    "the instruments identification is performed on short sound frames , without multi - pitch tracking . in our previous works",
    ", we were using sets ( which we called batteries ) of binary classifiers to solve the multi - label problem @xcite , @xcite of identification of instruments in polyphonic environment .",
    "random forests @xcite and ferns @xcite , @xcite were applied as classification tools .",
    "recently , we have shown that random ferns are a good replacement for random forests in music annotation tasks , as this technique offers similar accuracy while being much more computationally efficient @xcite . in this paper",
    "we propose a generalized version of random ferns , which can natively perform multi - label classification .",
    "using real musical recording data , we will show that our approach outperforms a battery of binary random ferns classifiers in every respect : in terms of accuracy , model size and prediction speed .",
    "the difficulty level of automatic instrument recognition in audio data depends on the polyphony level , and on the preprocessing performed . for single isolated",
    "sounds the instrument identification can even reach 100% for a few classes , but it decreases to about 40% for 30 or more classes @xcite ) . for polyphonic input even labelling of ground truth data is difficult , so mixes and single sounds are commonly applied to facilitate the research on polyphonic audio data .",
    "the identification of instruments in polyphony is often supported with external provision of pitch data , but automatic multi - pitch tracking problem is addressed too @xcite .",
    "another simplified approach aims at the identification of a predominant instrument @xcite .",
    "multi - target identification of multiple instruments is performed as well , although this research is done on various sets of data , so the results can not be directly compared .",
    "this section presents a general view of the state of the art in this area , shows classification methods applied , and sketches the broad range of approaches used in this research .",
    "the simplest polyphonic research case is instrument identification in duets ( 2 instruments ) @xcite , @xcite , @xcite , and the most complex one for symphonies , with high polyphony level ( i.e. high number of instrument sounds played together ) . in all cases",
    "the sound waves of instruments overlap , and so harmonic spectral components ( partials ) do , to a certain  sometimes large  extent .",
    "one of the approaches consists in omitting overlapped partials @xcite , resulting in about 60% accuracy using gaussian mixture models for duets from 5-instrument set .",
    "another interesting approach to multiple - instrument recognition is presented in @xcite ; their approach was inspired by non - negative matrix factorization , with an explicit sparsity control .",
    "audio data are usually parametrized before further processing in the classification procedure , and pure data representing amplitude changes of a complex audio wave are rarely used . preprocessing consists in calculation of parameters describing audio signal , or ( more often ) spectral features . still",
    ", direct spectrum / template matching can be also for instrument identification , without feature extraction @xcite , @xcite .",
    "this approach can result in good accuracy ; in @xcite , 88% was obtained for the polyphony of 3 instruments : flute , violin and piano , supported with integrating musical context into the system .",
    "the accuracy of instrument identification usually drops with increasing polyphony level and number of instruments considered in the recognition procedure . in @xcite , 84.1% was obtained for duets , 77.6% for trios , and 72.3% for quartets , using lda ( linear discriminant analysis ) based approach .",
    "in @xcite , lda yielded 60% average precision for instrument pairs ( 300 pairs , 25 instruments ) , and much a higher recall of 86100% .",
    "other techniques used in multiple instrument identification include svm ( support vector machine ) , decision trees , and k - nearest neighbour classifiers @xcite , @xcite .",
    "for the polyphony of up to four jazz instruments , the average accuracy of 53% was obtained in @xcite , whereas @xcite obtained 46% recall and 56% precision for the polyphony of up to 4 notes for 6 instruments , based on spectral clustering , and pca ( principal component analysis ) .",
    "the research in @xcite aimed at sound separation , which is also performed as an intermediate step in automatic music transcription , and then each separated sound can be independently labelled .",
    "semi - automatic music transcription is addressed in @xcite through shift - variant non - negative matrix deconvolution ( svnmd ) and k - means clustering ; the accuracy dropped below 40% for 5 instruments , analysed in form of mixes .",
    "the data we use originate from various recordings , all recorded at 44.1khz/16-bit , or converted to this format .",
    "testing is also performed on recordings , not on mixes .",
    "this was possible because we used recordings especially prepared for research purposes , the original tracks for each instruments were available , and thus ground truth labeling was facilitated . both training and testing data were used as mono input , although some of them were originally recorded in mono or stereo format .",
    "in the case of stereo data , mixes of the left and right channel ( i.e. the average value of samples in both channels ) were taken .",
    "sound parametrization was performed as a preprocessing in our research , for 40-ms frames .",
    "spectrum was calculated first , using fourier transform with hamming window , and various spectral features were extracted .",
    "no pitch tracking was performed nor required as preprocessing .",
    "both training and testing data were labelled with the instrument or instruments playing in a given segment . in the testing phase , the identification of instruments is performed on frame by frame basis , for consequent 40-ms frames , with 10 ms hop size ( 75% overlap ) .",
    "the feature vector consists of parameters describing properties of a 40-ms audio frame , and differences of the same parameters but calculated between for a 30 ms sub - frame starting from the beginning of the frame and a 30 ms sub - frame with 10 ms offset .",
    "the features we used are mainly mpeg-7 low - level audio descriptors , are often used in audio research @xcite , and other features applied in instrument recognition research .",
    "the following 91 parameters constitute our feature set @xcite , @xcite :    * _ audio spectrum flatness _ , _ _",
    "flat__@xmath0__flat__@xmath1  features parameter describing the flatness property of the power spectrum within a frequency bin for selected bins ; we used 25 out of 32 frequency bands ; * _ audio spectrum centroid _  the power weighted average of the frequency bins in the power spectrum , with coefficients scaled to an octave scale anchored at 1 khz @xcite ; * _ audio spectrum spread _  rms ( root mean square ) of the deviation of the log frequency power spectrum wrt . _",
    "audio spectrum centroid _ @xcite ; * _ energy _  energy of the spectrum , in log scale ; * _ mfcc _  13 mel frequency cepstral coefficients . the cepstrum was calculated as the logarithm of the magnitude of the spectral coefficients , and then transformed to the mel scale , reflecting properties of the human perception of frequency .",
    "24 mel filters were applied , and the results were transformed to 12 coefficients , and the logarithm of the energy was taken as @xmath2 coefficient ( 0-order coefficient of mfcc ) @xcite ; * _ zero crossing rate _",
    ", where zero - crossing is a point where the sign of the sound wave in time domain changes ; * _ roll off _  the frequency below which an experimentally chosen percentage ( 85% ) of the accumulated magnitudes of the spectrum is concentrated ; parameter originating from speech recognition , applied to distinguish between voiced and unvoiced speech ; * _ nonmpeg7 - audio spectrum centroid _  a linear scale version of _ audio spectrum centroid _ ; * _ nonmpeg7 - audio spectrum spread _  a linear scale version of _ audio spectrum spread _ ; * changes ( differences ) of the above features for a 30 ms sub - frame of the given 40 ms frame ( starting from the beginning of this frame ) and the next 30 ms sub - frame ( starting with 10 ms offset ) ; * _ flux _  the sum of squared differences between the magnitudes of the dft points calculated for the starting and ending 30 ms sub - frames within the main 40 ms frame ; this feature works on spectrum directly , not on its parameters .      in our experiments we focused on wind instruments , typically used in jazz music .",
    "training data for clarinet , trombone , and trumpet were taken from three repositories of single , isolated sounds of musical instruments : mcgill university master samples ( mums ) @xcite , the university of iowa musical instrument samples ( iowa ) @xcite , and rwc musical instrument sound database @xcite .",
    "since so sousaphone sounds were available in these sets , we additionally used sousaphone sounds recorded by r. rudnicki@xcite .",
    "training data were in mono format in rwc data and for sousaphone , and in stereo for the rest of the data .",
    "training was performed on single sounds and mixes .",
    "our classifiers were trained to work on larger instrument sets , so additionally sounds of 5 other instruments were used in the training .",
    "these were instruments also typical for jazz recordings : double bass , piano , tuba , saxophone , and harmonica .",
    "rwc , iowa and mums repositories were used to collect these sounds .",
    "the testing data were taken from the following jazz band stereo recordings by r. rudnicki @xcite , @xcite :    * _ mandeville _ by paul motian , * _ washington post march _ by john philip sousa , arranged by matthew postle , * _ stars and stripes forever _ by john philip sousa , semi - arranged by matthew postle  movement no . 2 and movement no .",
    "these recordings contain pieces played by clarinet , trombone , trumpet , and sousaphone , which are our target instruments .",
    "in the previous works , we have been solving the multi - label problem of recognising instruments with the standard binary relevance approach .",
    "namely , we were building a battery of binary models , each capable of detecting the presence or absence of a single instrument ; for prediction , we were applying all the models to the sample and combining their predictions .    unfortunately , this approach is not computationally effective , ignores the information about instrument - instrument interactions and requires sub - sampling of the training data to make balanced training sets for each battery member .",
    "thus , we attempted to modify the random ferns classifier used in our methodology to natively support multi - label classification .",
    "random ferns classifier is an ensemble of @xmath3 ferns , simple base classifiers equivalent to a constrained decision tree .",
    "namely , the depth of a fern ( @xmath4 ) is fixed and the splitting criteria on a given tree level are identical .",
    "this way , a fern has @xmath5 leaves and directs object @xmath6 into a leaf number @xmath7 , where @xmath8 is an indicator variable for a result of the @xmath9-th splitting criterion . we are using the rferns implementation of random ferns @xcite which generates splitting criteria entirely at random , i.e. randomly selects both a feature on which the split will be done and the threshold value .",
    "also , rferns builds a bagging ensemble of ferns , i.e. each fern , say @xmath10-th , is not directly build not on a whole set of objects but on a _ bag _",
    "@xmath11 , a multiset of training objects created by random sampling with replacement the same number of objects as in the original training set .",
    "the leaves of ferns are populated with _ scores _",
    "@xmath12 , indicating the confidence of a fern @xmath10 that an object @xmath6 falling into a certain leaf @xmath13 belongs to the class @xmath14 .",
    "the scores are generated based on a training dataset @xmath15 , and are defined as @xmath16 where @xmath17 is a multiset of training objects from a bag in the same leaf as a given object and @xmath18 is a multiset of training objects from a bag that belong to a class @xmath14 .",
    "@xmath19 denotes a set of true classes of an object @xmath6 , and is assumed to always contain a single element in a many - classes case ; @xmath20 is the number of all classes .",
    "the prediction of the whole ensemble for an object @xmath6 is @xmath21    our proposed generalisation of random ferns for multi - label classification is based on the observation that while the fern structures are not optimised to a given problem , the same set of @xmath22 functions can serve all classes rather than being re - created for each one of them . in the battery classification , we create virtual _ not - class _ classes to get a baseline score value used to decide whether class of a certain score value should be reported as present or absent . with multi - class random ferns , however , we can incorporate this idea as a normalisation of scores so that the sign of their value will become meaningful indicator of a class presence .",
    "we call such normalised scores _ score quotients _ @xmath23 , and define them as @xmath24 the prediction of the whole ensemble for an object @xmath6 naturally becomes @xmath25",
    "when preparing training data , we start with single isolated sounds of each target instrument . after removing starting and ending silence @xcite , each file representing the whole single",
    "sound is normalized so that the rms value equals one .",
    "then , we create the training set of sounds by mixing random 40 ms frames extracted from the recordings of 1 to 4 randomly chosen instruments ; the mixing is done with random weights and the result is normalized again to get the rms value equal to one .",
    "finally , we convert the sound into a vector of features by applying previously described sound descriptors .",
    "the multi - label decision for such an object is a set of instruments which sounds were used to create the mix .",
    "we have repeated this procedure 100 000 times to prepare our training set .",
    "this set is used directly to generate the model with the multi - label random ferns approach . when creating the battery of random ferns , we are splitting this data into a set of binary problems .",
    "each is devoted to one instrument and contains 3000 positive examples where this instrument contributed to the mix and 3000 negative when it was absent .    in both cases",
    ", we used @xmath26 ferns and scanned depths @xmath27 .",
    "as the random ferns is a stochastic algorithm , we have replicated training and testing procedure 10 times .",
    "both models are tested on a true jazz recordings described in section  [ sec : adata ] and their predictions assessed with respect to the annotation performed by an expert .",
    "the accuracy was assessed via precision and recall scores ; these measures were weighted by the rms of a given frame , in order to diminish the impact of softer frames which can not be reasonably identified as their loudness approaches the noise level .",
    "our true positive score @xmath28 for an instrument @xmath9 is a sum of rms of frames which are both annotated and classified as @xmath9 .",
    "precision is calculated by dividing @xmath28 by the sum of rms of frames which are classified as @xmath9 ; respectively , recall is calculated by dividing @xmath28 by the sum of rms of frames which are annotated as @xmath9 .    as a general accuracy measure we have used f - score , defined as a harmonic mean of such generalised precision and recall .",
    "the results of accuracy analysis are presented in a figure  [ fig : overall ] .",
    "one can see that for fern depth larger than 7 the multi - label ferns archived both significantly better precision and recall that the battery classifier ; obviously this also corresponds to a higher f - score .",
    "the precision of both methods seems to stabilise for larger depth , while the recall and so f - score of multi - class ferns raise steadily and may be likely further improved .",
    "the variation of the results is also substantially smaller for multi - class ferns , showing that the output of this approach is more stable and thus more predictable .",
    "table  [ tab : details ] collects the sizes of created models and the speed with which they managed to predict the investigated jazz pieces .",
    "one can see that the utilisation of multi - label ferns results in a substantially greater prediction speed , on average 7 times better than this achieved by the battery of binary ferns .",
    "the difference between model sizes is less pronounced , with the battery actually producing a smaller model for fern depths 5 and 7 and only about 2 times larger for fern depth 12 .",
    "there is a negative correlation between the achieved f - score and both prediction speed and model size , though , with the fern depth controlling the speed - quality trade - off .",
    "however , this way an user may use this parameter to flexibly adjust the model to the constraints of the intended implementation .",
    ".comparison of model size and prediction speed for a random ferns battery and multi - label random ferns .",
    "the speed is expressed as the total playing time of all investigated jazz recordings divided by the cpu time required to classify them .",
    "[ tab : details ] [ cols=\"^,^,^,^,^ \" , ]",
    "in this paper we introduce multi - label random ferns as a tool for automatic identification of musical instruments in polyphonic recordings of a jazz band .",
    "the comparison of performance of multi - label random ferns and sets of binary ferns shows that the proposed multi - label ferns outperform the sets of binary ferns in every respect .",
    "multi - label ferns are much faster , achieve higher f - score , and the model size increase with increasing complexity also compares favorably with the set of binary random ferns .",
    "therefore , we conclude that multi - label random ferns can be recommended as a classification tools in many applications , not only for instrument identification , and this technique can also be applied on resource - sensitive devices , e.g. mobile devices .      this project was partially supported by the research center of pjiit , supported by the ministry of science and higher education in poland , and the polish national science centre , grant 2011/01/n / st6/07035 .",
    "computations were performed at the icm uw , grant g48 - 6 .",
    "bosch , j.j . ,",
    "janer , j. , fuhrmann , f. , herrera , p. : a comparison of sound segregation techniques for predominant instrument recognition in musical audio signals in : 13th international society for music information retrieval conference ( ismir ) , 559564 ( 2012 )      cont , a. , dubnov , s. , wessel , d. : realtime multiple - pitch and multiple - instrument recognition for music signals using sparse non - negativity constraints . in : proc .",
    "digital audio effects ( dafx-07 ) , 8592 ( 2007 )    eggink , j. , brown , g.j : application of missing feature theory to the recognition of musical instruments in polyphonic audio . in : 4th international conference on music information retrieval ismir ( 2003 )",
    "goto , m. , hashiguchi , h. , nishimura , t. , oka , r. : rwc music database : music genre database and musical instrument sound database .",
    "in : 4th international conference on music information retrieval ismir , 229230 ( 2003 )    heittola , t. , klapuri , a. , virtanen , a. : musical instrument recognition in polyphonic audio using source - filter model for sound separation . in : proc .",
    "society for music information retrieval conf .",
    "( ismir 2009 ) ( 2009 )    herrera - boyer , p. , klapuri , a. , davy , m. : automatic classification of pitched musical instrument sounds . in : klapuri , a. , davy , m. ( eds . ) signal processing methods for music transcription .",
    "springer science+business media llc ( 2006 )      jiang , w. , wieczorkowska , a. , ras , z.w . : music instrument estimation in polyphonic sound based on short - term spectrum match . in : hassanien ,",
    "abraham , a. , herrera , f. ( eds . ) : foundations of computational intelligence vol .",
    "approximate reasoning .",
    "studies in computational intelligence vol .",
    "202 , 259 - 273 , springer ( 2009 )      kitahara , t. , goto , m. , komatani , k. , ogata , t. , okuno , h.g . :",
    "instrument identification in polyphonic music : feature weighting to minimize influence of sound overlaps .",
    "eurasip j. appl . signal process .",
    "2007 , 1 - 15 ( 2007 )    kubera , e. , kursa , m.b . ,",
    "rudnicki , w.r . ,",
    "rudnicki , r. , wieczorkowska , a.a . : all that jazz in the random forest . in : kryszkiewicz , m. , rybiski , h. , skowron , a. , ra , z.w .",
    "( eds . ) : ismis 2011 .",
    "lnai , vol . 6804 , pp .",
    "springer , heidelberg ( 2011 )                                    wieczorkowska , a.a . , kursa , m.b : a comparison of random forests and ferns on recognition of instruments in jazz recordings . in : chen , l. , felfernig , a. , liu , j. , ra , z.w ( eds . ) : ismis 2012 .",
    "lnai , vol . 7661 , pp .",
    "springer , heidelberg ( 2012 )      kirchhoff , h. , dixon , s. , klapuri , a. : multi - template shift - variant non - negative matrix deconvolution for semi - automatic music transcription . in : 13th international society for music information retrieval conference ( ismir ) , 415420 ( 2012 )"
  ],
  "abstract_text": [
    "<S> in this paper we introduce multi - label ferns , and apply this technique for automatic classification of musical instruments in audio recordings . </S>",
    "<S> we compare the performance of our proposed method to a set of binary random ferns , using jazz recordings as input data . </S>",
    "<S> our main result is obtaining much faster classification and higher f - score . </S>",
    "<S> we also achieve substantial reduction of the model size . </S>"
  ]
}