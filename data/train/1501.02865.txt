{
  "article_text": [
    "the calculation of an evolution unitary operator @xmath5}$ ] , where @xmath0 is an interaction hamiltonian in the interaction picture , is a generic problem encountered in quantum field theory , quantum optics or condensed matter physics , to name a few . of considerable interest are single and mainly multimode boson hamiltonians describing the interaction between two and more boson field modes .",
    "the hamiltonian @xmath0 is a hermitian operator and can be written as @xmath6 , where @xmath7 and the bar denotes complex conjugation .",
    "the operator @xmath2 is a function of one or more boson creation and annihilation operators @xmath8 and @xmath9 , respectively , satisfying the weyl - heisenberg algebra @xmath10=\\d_{ij}{\\mathop{{\\mathrm{id}}}\\nolimits}$ ] .",
    "the index @xmath11 denotes the @xmath11-th boson mode and @xmath12 is an identity operator ( not necessarily represented by a finite - dimensional identity matrix ) commuting with @xmath8 and @xmath9 . because the hamiltonian is often a sum of two or more non - commuting terms , the problem of finding an explicit form of @xmath13 is not a straightforward one .",
    "the standard way of solving it is to use perturbation theory by expanding @xmath13 as the dyson series  @xcite .",
    "it can also can be converted to the problem of factorization of the operator exponential function known as the bch formula ( after baker - campbell - hausdorff )  @xcite .",
    "strictly speaking , it is the zassenhaus formula  @xcite that provides an explicit way of factorizing operator or matrix exponentials but it is not the only , see  @xcite .",
    "this extensive topic is also reviewed in  @xcite and more recently in  @xcite .    by setting @xmath14",
    "we will restrict our attention to the evolution operator @xmath15}.\\ ] ] from all the existing approaches to evaluate eq .",
    "( [ eq : generalevolutionop ] ) , the taylor series expansion around @xmath16 happens to be ( most likely ) the least sophisticated attempt to compute the exponential .",
    "but if no _ simple _ factorization theorem exists ( for example when @xmath2 and @xmath17 commute ) and other methods fail or are equally inefficient , it may be the only available option . as a matter of fact",
    ", short - time evolution is often studied by calculating the first few terms of a taylor expansion . however , for longer times the exponential growth in @xmath18 of the number of summands @xmath19 quickly makes such a calculation intractable ( note that we do not claim that all methods to evaluate @xmath13 are exponential in time ) .",
    "the situation could have been saved by the following procedure .",
    "the expression @xmath19 can be brought to _",
    "normal _ form , where all creation operators @xmath9 , forming @xmath2 and @xmath17 , are to the left of all annihilation operators @xmath8 .",
    "we will denote the corresponding operation by @xmath20 .",
    "the main advantage of normally ordered operators lies in an easy calculation of their action on many states of interest , in particular , the eigenvector of  @xmath21 ( a coherent state @xmath22 with the minkowski vacuum as its special case ) .",
    "however , in general it is not easy to find the normal form .",
    "as an example , take a boson word ( also called product , string or monomial ) @xmath23 .",
    "the action of @xmath20 results in @xmath24={{a^\\dg}}^3a^3 + 6{{a^\\dg}}^2a^2 + 6{{a^\\dg}}a.\\ ] ] a straightforward , but not recommendable , way to obtain  ( [ eq : orderedexample ] ) is to commute through the forest of operators .",
    "eventually , one can use shortcuts in the form of derived commutation rules to make the process less painful  @xcite .",
    "a better way is to take advantage of a clever differential representation of the aforementioned algebra  @xcite @xmath25 where the bar denotes complex conjugation .",
    "then the above calculation can be done in a blink of an eye ( the celebrated fock - bargmann representation is another option  @xcite ) but this is the exception rather than the rule . in the case of @xmath26 $ ] , the commutation relations , the differential operator representation  ( [ eq : heisrep ] ) or any other technique , such as wick s theorem  @xcite , would lead to the right answer for but it may be difficult to obtain a general form for an arbitrary @xmath2 and @xmath18 or the computational complexity of the @xmath20 operator can be insurmountable .",
    "the problem of boson normal ordering has a long history and a number of techniques were developed  @xcite .",
    "certain special cases of @xmath26 $ ] were previously studied resulting in elegant combinatorial formulas .",
    "but the general treatment for multimode boson operators is missing and the calculation of evolution operators generated by such hamiltonians is the main goal of this paper .    the idea behind our technique is to study @xmath19 , and consequently the expansion of eq .",
    "( [ eq : generalevolutionop ] ) , in the weak sense , that is , by acting on a state of interest .",
    "after all , this is the situation most often encountered when solving physical problems  the state is usually a vacuum state @xmath27 ( or a ground state defined in general by @xmath28 ) and one is interested either in the vacuum expectation value of an operator or a unitary evolution of the state it acts on .",
    "so our method lacks the generality of the factorization theorems for eq .",
    "( [ eq : generalevolutionop ] ) as a standalone operator  @xcite or of the formulas developed to normal order certain special cases of @xmath29 . however , the virtue of our technique is that it enables us to analytically calculate @xmath30 for an _ arbitrary _ multimode boson monomial @xmath2 , where @xmath31 defined above as @xmath28 or any state from the semi - infinite or finite tower of states generated by the repeated action of @xmath17 on @xmath27 . in this work",
    "we will focus on the vacuum state as it the most often encountered scenario . equally importantly , the calculation will be shown to be tractable since it can be executed with polynomial - time complexity @xmath32 if @xmath17 or @xmath2 is a monomial of the length @xmath33 .",
    "the method does not depend on a particular algebraic structure of @xmath2 apart from the one inherited from @xmath34 satisfying the weyl - heisenberg algebra .",
    "our approach is combinatorial .",
    "we will show that there exists a common structure called a generalized dyck path , which is a subject of study in analytic combinatorics , computer science and stochastic processes , among others  @xcite .",
    "this insight will lead us directly to a recursive summing formula allowing to analytically calculate eq .",
    "( [ eq : generalopsumweak ] ) without the need for normal ordering .",
    "the most important consequence is that it can be used to efficiently find ( in polynomial time ) an analytical expression for the expanded evolution operator  ( [ eq : generalevolutionop ] ) @xmath35 for any choice of @xmath36 and @xmath37 where again @xmath31 or a tower of states generated by @xmath17 acting on @xmath27 .",
    "multiboson hamiltonians studied in this paper were often identified as _ quasi - exactly solvable _",
    "@xcite with a close relation to the boson realizations of polynomial algebras  @xcite . among the applicable physical scenarios , bose - einstein condensates and nonlinear optical systems",
    "are the most prominent .",
    "quasi - exactly solvable models have been extensively studied  @xcite and the difference compared to exactly solvable models is that the spectrum problem of such a hamiltonian can not be formulated as the usual eigenvalue problem in matrix algebra .",
    "however , there exists an invariant subspace of functions that are mapped to themselves and so it can be `` decoupled '' from the rest of an otherwise infinite - dimensional matrix hamiltonian .",
    "this finite subspace can subsequently be analytically diagonalized and part of the spectrum is recovered .",
    "generalized dyck paths are introduced in sec .",
    "[ sec : dyckcount ] and some of their combinatorial properties are summarized . in sec .",
    "[ sec : dyckbosons ] we link dyck paths to the action of boson words , show that all monomials behave as ladder operators and uncover a large class of sums of multimode boson monomials that behave as ladder operators as well .",
    "this enables us to derive our main result in sec .",
    "[ sec : dyckeval ] : the evaluation of eq .",
    "( [ eq : generalopsumweak ] ) for monomials and their sums . in sec .",
    "[ sec : complex ] we discuss the computational complexity of our approach .",
    "we illustrate the evaluation on several examples of boson operators  @xmath2 and compute eq .",
    "( [ eq : generalopsumweak ] ) for low values of @xmath18 ( to be able to verify the results by hand ) and for some very high values of @xmath18 ( to show the speed - up offered by our method ) .",
    "we also show that the fast evaluation of eq .",
    "( [ eq : generalopsumweak ] ) leads to an efficient calculation of a boson evolution operator for previously hard - to - reach values of the coupling constant  @xmath3 if calculated by a series expansion .",
    "our final example is the evolution operator for the three - photon degenerate process whose taylor expansion is known to diverge for any value of the coupling constant .",
    "yet our approach is still useful for the calculation of an analytically continued unitary operator using the pad approximation proposed in  @xcite .",
    "let s introduce an integer lattice path known as a dyck path and some of its properties  @xcite .",
    "the lattice for dyck paths is the set of all integer points @xmath38 .",
    "a dyck path @xmath39 is a path starting at @xmath40 and ending at @xmath41 , such that the only allowed steps ( also called segments or letters in this paper ) are @xmath42 and @xmath43 , that is , going to the nearest integer point northeast or southeast .",
    "the constraint on a dyck path is that it never falls below the @xmath44 axis , but it may touch it at any number of integer points between @xmath45  and  @xmath18 .",
    "a more general dyck path @xmath46 starts at @xmath40 but is allowed to end at any point @xmath47 following the same constraint .",
    "finally , what we will call a generalized dyck path @xmath48 is a lattice path starting at @xmath49 and ending at @xmath50 , where @xmath51 , and as before , the path is constrained to the positive quadrant including the @xmath44 axis",
    ". the value of @xmath52 can be any non - negative integer but the value of @xmath53 depends on @xmath18 and @xmath52 . assuming @xmath52 even , if @xmath18 is even ( odd ) then only even ( odd ) values of @xmath53 are possible .",
    "for @xmath52 odd , if @xmath18 is even ( odd ) then only odd ( even ) values of @xmath53 are possible .",
    "two examples of a generalized dyck path are in fig .",
    "[ fig : dyckexamples ] .",
    "note that @xmath54 and from now on whenever we say a dyck path we will mean a generalized dyck path and @xmath43  @xcite .",
    "this is not the kind of generalization considered in this paper . ] .",
    "( b ) more general dyck path @xmath55 and ( c ) the generalized dyck path @xmath56 .",
    "dyck paths are often described as mountain ranges .",
    "]    a dyck path is unambiguously defined by its starting point @xmath52 and a set of instructions called a dyck word that leads the path through the lattice .",
    "it is a string of the segments @xmath57 and @xmath58 whose length is @xmath18 and our convention will be to read the string from the right .",
    "the highest dyck path @xmath59 is defined by the ( highest ) dyck word , where all the @xmath57 segments are on the right : @xmath60 then , all dyck paths for the fixed parameters @xmath61 and @xmath53 lie `` between '' the highest dyck path and the @xmath44 axis .",
    "equivalently , the lowest dyck path @xmath62 is defined such that there is no other dyck path between this path and the @xmath44 axis for the chosen set of parameters .",
    "it is generated by the lowest dyck word @xmath63 any dyck path with the given parameters @xmath64 contains the same number of @xmath57 and @xmath58 segments .    the number of dyck paths @xmath65 is famously counted by the catalan number @xmath66 @xmath67 catalan numbers are ubiquitous in computer science and discrete mathematics  @xcite and this makes dyck paths a well studied object appearing in many reincarnations  @xcite .",
    "one of them is bertrand s ballot problem and by virtue of this insight one finds  @xcite the number of dyck paths @xmath48 to be @xmath68 where the binomial coefficient is defined to be zero whenever the `` denominator '' is negative .",
    "dyck paths of length @xmath69 starting at @xmath70 and ending at @xmath71 are depicted . ]    as an illustration we plotted all dyck paths @xmath72 in fig .",
    "[ fig : alldycks ] for which the expression from eq .",
    "( [ eq : mostgeneraldyckcounting ] ) simplifies to @xmath73 note that if @xmath74 in ( [ eq : mostgeneraldyckcounting ] ) , all the dyck paths @xmath75 are confined to a rectangle whose two corners are touching the positive @xmath44 and @xmath76 axes and @xmath77 is a binomial number .",
    "this is nothing else than a binomial walk on the pascal triangle ( rectangle ) experimentally realized by the galton board .",
    "let @xmath2 be a general multimode boson operator such that there exists @xmath4 satisfying  @xmath28 .",
    "so we may call @xmath27 a vacuum or ground state .",
    "the object of our study is the expression @xmath78 that can be considered as a hypothetical hamiltonian ) is recovered by putting a minus to all products with an odd number of @xmath2 s .",
    "the appearance of the plus sign is irrelevant for the presented method . ] .",
    "the operator @xmath17 acts repeatedly on the ground state and generates a finite or eventually semi - infinite tower of states : @xmath79 , where @xmath80 and @xmath81 is , in general , an unnormalized state .",
    "the first crucial question is under what conditions the adjoint operator @xmath2 behaves as an annihilation operator :    [ eq : ladderops ] @xmath82    we adopted the convention that the states with no tildes are normalized and so the coefficients @xmath83 and @xmath84 are determined by this condition .",
    "the second crucial point we have to address in order for our method to work is that our approach hinges on the ability to analytically sum over the product @xmath85 later derived in sec .",
    "[ sec : dyckeval ] and used in eqs .",
    "( [ eq : mainsum1 ] ) and  ( [ eq : mainsum2 ] ) ( appearing as @xmath86 ) .",
    "first , we will show that @xmath87 can be obtained even without knowing the normalization of @xmath88 ( note that we are not interested in @xmath83 and @xmath89 but only in their product ) . finding the normalization may not only be rather laborious for a generic boson expression @xmath2 and all @xmath90 but we even can not guarantee the existence of a closed , or even simple , form .",
    "so assume for a moment that @xmath91 behave as proper ladder operators as in ( [ eq : ladderops ] )",
    ". then we may write @xmath92 but this clearly does not depend on whether @xmath93 is normalized or not .",
    "it holds that @xmath94 , where @xmath95 and @xmath96 is the normalization of @xmath97 .",
    "hence we get the sought product @xmath85 from the unnormalized ladder states for all @xmath90 @xmath98 greatly simplifying its derivation .",
    "let s now uncover a large class of the boson expressions @xmath91 that behaves as ladder operators .",
    "remarkably , we will show that this is equivalent to the condition that the product @xmath85 is an integer and therefore leads to the announced speed - up derived in sec .",
    "[ sec : dyckeval ] .",
    "a normally ordered monomial of the length @xmath33 is the expression @xmath99 we define a normal _ disjoint monomial of the same order _ as any normally ordered monomial that is created by taking the creation and annihilation exponents @xmath100 and @xmath101 and ( independently ) permuting them such that no mode with a nonzero exponent in @xmath102 is present in the newly created one .",
    "the definition seems restrictive but the opposite is true .",
    "it allows for a large number of multimode boson expressions that we will appreciate in the example after the following statement .",
    "let @xmath2 be a sum of disjoint multimode boson monomials of the same order and @xmath27 a vacuum state such that @xmath28 .",
    "then the operator @xmath103 is proportional to an identity map for all ladder states @xmath104 , that is , @xmath105 .",
    "moreover , the constant of proportionality @xmath106 is an integer .",
    "note that a vacuum ( or ground state ) is in general not unique . a given operator @xmath2 can annihilate several distinct vacui .",
    "the boson expressions @xmath2 can now be constructed in a great variety .",
    "the trivial example is every monomial @xmath107 ( arbitrarily ordered ) . to illustrate the definition we further restrict to normal monomials @xmath102 but later we will comment on",
    "differently ordered alternatives .",
    "if we fix the monomial order @xmath33 then the first nontrivial example is @xmath108 for any @xmath109 .",
    "the disjoint monomials of the same order are all @xmath110 , where @xmath111 and so the boson expression @xmath2 can be any sum @xmath112 another example is @xmath113 .",
    "a sum of disjoint multimode boson monomials of the same order can be , for instance , @xmath114    to prove the proposition we will need an auxiliary lemma .    let @xmath115 and @xmath116 be boson multimode monomials such that @xmath116 is an arbitrarily reordered version of @xmath115 . then @xmath117 where @xmath118 is a multivariate polynomial with the variables being the @xmath11-th mode boson numbers @xmath119 for @xmath120 .",
    "any monomial @xmath115 ( normal ordered or not ) can always be recast to the form of @xmath116 resulting in eq .",
    "( [ eq : m1m2 ] ) .",
    "then , all summands of the ( non - unique ) polynomial @xmath118 must contain an equal number of creation and annihilation operators for all modes involved in @xmath115 and @xmath116 .",
    "if it was not the case then the lemma assumption about @xmath115 and @xmath116 would be violated .",
    "the polynomial @xmath118 can be put ( by normal ordering ) to a form containing only the expressions @xmath121 and every such building block can be rewritten as a sum of powers of @xmath122 .",
    "we will be concerned with the sums of normally ordered disjoint multimode boson monomials denoted @xmath2 and @xmath17 and their corresponding products @xmath103 and @xmath123 .",
    "each monomial in @xmath103 has a reordered counterpart with the same number of creation and annihilation operators in @xmath123 .",
    "according to the previous lemma , this implies @xmath124 where @xmath125 is a multivariate polynomial with the variables being the boson number operators @xmath122 .",
    "furthermore , using the distributivity of the commutator and the crucial fact that @xmath126 and its adjoint @xmath17 are disjoint ( @xmath127 is a disjoint multi - index , see the examples in eqs .",
    "( [ eq : disjointsum1 ] ) and ( [ eq : disjointsum2 ] ) ) , we may write @xmath128 where @xmath129=f(n_i)$ ] .",
    "this is the only surviving term in commutator  eq .",
    "( [ eq : aadg ] ) . to use this fact ,",
    "we write    [ eq : commutantis1 ] @xmath130    where in the second summand of the third row we used the following consequence of the boson commutation rule : @xmath131 so we `` propagated '' the polynomial @xmath125 to the right side of @xmath132 converting it to another polynomial @xmath133 , where only the boson number operators appear as variables .",
    "recall that @xmath17 is a sum of disjoint monomials and so all but one @xmath134 commutes and the one that does not commute switches the side according to the rules  eqs .",
    "( [ eq : ncommuting ] ) in the same way for all @xmath134 .",
    "this results in @xmath135 implying @xmath136 .",
    "we continue by writing    [ eq : commutantis2 ] @xmath137    until we arrive at @xmath138{\\mathop{|\\mathrm{vac}\\rangle}\\nolimits }    = q_{p-1}\\widetilde\\psi^{(p-1)},\\ ] ] where we used @xmath139 and the fact that only the number coefficients of @xmath140 survive the encounter with @xmath27 generating @xmath141 .",
    "the @xmath2 expressions are normally ordered but we might have equally used antinormally ordered monomials  @xcite or arbitrarily ordered ones and prove the proposition for them . it would lead to an ever larger class of operators satisfying the proposition .",
    "the class of operators uncovered in the proposition is certainly not the most general class of boson expressions with this kind of ladder - like behavior . yet , among this class , the monomials represent a huge variety of hypothetical hamiltonians and so we will mainly focus on them .",
    "[ exa : splitter ] as our first example , consider @xmath142 .",
    "the ground state is @xmath143 since @xmath144 for all @xmath145 and @xmath17 ( acting repeatedly on @xmath146 ) generates a finite tower of states @xmath88 for @xmath147 .",
    "the corresponding hamiltonian @xmath148 is incidentally an important one .",
    "it represents one of the generators of the @xmath149 algebra describing the action of a quantum - optical beam - splitter and the fact that the ground state is somewhat non - unique turns out to be important too .",
    "the @xmath150 states generated by @xmath151 carry the @xmath152-th representation of @xmath149  @xcite .",
    "the claims from the theorem are manifestly satisfied following the standard properties of the boson operators  @xcite    [ eq : bosonsteps ] @xmath153    [ exa : contrived ] the next example will be @xmath2 in the form of the following disjoint sum : @xmath154 assume the ground state of @xmath2 to be @xmath155 .",
    "we find @xmath156 we can go on and derive a general expression for @xmath83 and @xmath89 .",
    "since the state on the right of the previous equation is normalized , the @xmath157 contains a square root and @xmath83 could be quite difficult to find ( and unnecessary since we need @xmath87 in the end ) .",
    "so in the next , morally similar , example we derive it using our insight from eq .",
    "( [ eq : ladderopsunnormalized ] ) .",
    "[ exa : calculable ] let @xmath158 and @xmath159 .",
    "we find @xmath160 by matching the coefficients of the corresponding basis vectors , the calculation @xmath161 reveals the constant of proportionality .",
    "we can verify it by a direct calculation for @xmath162 : @xmath163    convinced about the validity of the proposition we can set out to show its main application .",
    "the sum @xmath164 contains @xmath165 summands but when acting on @xmath4 , some of them become zero . what is the exact condition for a general summand of @xmath164 to survive its encounter with the ground state ? to find out , we write @xmath166 where @xmath167 at least one half of all the products on the rhs of eq .",
    "( [ eq : expsummand ] ) vanishes upon acting on @xmath4 because the number of @xmath2 operators outnumber their conjugates .",
    "this is a necessary but not sufficient condition to eliminate all the products that do not contribute .",
    "for example , if there is just one @xmath2 operator that is , however , the first one to encounter @xmath4 , the whole summand disappears . a general product in eq .",
    "( [ eq : expsummand ] ) is a bosonic word of the length @xmath18 according to @xmath168 @xmath169 from the way it acts on @xmath4 it can be seen that the word yields zero if and only if the number @xmath170 of annihilation operators @xmath2 on the @xmath171-st position is greater than the number @xmath172 of _ all _ creation operators @xmath17 to its right valid for _ any _ @xmath173 .",
    "but this is precisely the defining property of a dyck path @xmath174 .",
    "we associate the step operators with the lattice steps    [ eq : bijection ] @xmath175    and a bosonic word is nothing else than a dyck word of instructions of how a dyck path is generated . indeed , the constraint on a dyck path to remain confined in the positive quadrant is equivalent to the condition for a bosonic word ( product ) in eq .",
    "( [ eq : expsummand ] ) to be nonzero .",
    "the converse is true as well because of the way the annihilation operator acts on a ground state and so we have a bijection between the set of dyck paths @xmath174 of cardinality @xmath176 and the number of products on the rhs of @xmath177 where    @xmath178    the first line is extracted from the definition of @xmath179 ( the length of the boson word ) and the second line is the difference between the number of @xmath2 and @xmath17 determining the @xmath76 component of the end point of the corresponding dyck path .",
    "note the lower limit of the outer sum in eq .",
    "( [ eq : expfinalexpansion ] ) .",
    "it removes the words with a number of annihilation operators greater than the number of creation operators .",
    "they do not correspond to any dyck path .",
    "we may associate the @xmath90-th horizontal line of the integer lattice with the state @xmath88 .",
    "the @xmath44 axis is then the ground state @xmath4 . with this insight in hand ,",
    "we generalize the above construction for an arbitrary starting state @xmath180 , where we set @xmath181 : @xmath182 note that @xmath52 can be greater than @xmath18 in which case the lower limit of the outer sum is zero .",
    "to illustrate our technique , we will study in this paper the ground state case @xmath70 corresponding to eq .",
    "( [ eq : expfinalexpansion ] ) . the analysis for an arbitrary ladder state @xmath180 can be easily generalized following the approach developed in the next section .      in this section we present our main result . for that purpose",
    "we introduce a different kind of dyck path description equivalent to a dyck word  @xmath183 .",
    "previously we introduced the highest and lowest dyck paths , @xmath59 and @xmath62 , respectively .",
    "they are illustrated in  fig .",
    "[ fig : maxmindyck ] for @xmath184 and @xmath185 .",
    "the letter @xmath186 denotes the _ ascending _ path segment lying between the @xmath187-st and @xmath11-th horizontal line of the lattice .",
    "similarly , @xmath188 denotes the _ descending _ segment connecting the @xmath11-th and @xmath187-st horizontal lattice line . at this point",
    ", we treat @xmath189 as letters of a different ( somewhat less economical ) kind of dyck word we will label  @xmath190 which is , nonetheless , equivalent to the usual dyck word @xmath183 . a dyck word",
    "@xmath190 is , like @xmath183 , read from the right and we write down the highest dyck path @xmath191 from fig .",
    "[ fig : maxmindyck ]  ( a ) as an example : @xmath192     and @xmath70 .",
    "two different colors distinguish the ascending ( black ) and descending ( red ) sections of the paths .",
    "the letters @xmath186 and @xmath188 form a dyck word and their role is explained in sec .",
    "[ sec : dyckeval ] . ]",
    "dyck paths are continuous and so two consecutive segments of _ any _ dyck path must be one of these four pairs ( recall the right - to - left convention ) : @xmath193 it follows that if we have the highest dyck path , where all @xmath194 are on the right , and there is a need to swap the leftmost letter @xmath186 with the rightmost letter @xmath188 such that the new word represents a dyck path , the general rule is very simple : @xmath195 valid for all admissible @xmath11 . only then the new word satisfies the conditions in  ( [ eq : generaldycksegments ] ) no matter what letter precedes @xmath188 or follows @xmath186 on the lhs of  ( [ eq : therule ] ) .    the rule can be immediately put to work by introducing a way of how to generate all dyck paths @xmath48 .",
    "we `` descend '' from the highest dyck path @xmath59 to the lowest dyck path @xmath196 by systematically swapping the highest ascending and descending segments @xmath186 and @xmath188 and generating all dyck paths ending at @xmath50 such that no dyck path is left behind .",
    "the rule is rather straightforward so let s illustrate it on the example @xmath197 depicted in fig .",
    "[ fig : maxmindyck ]  ( a ) .",
    "the first step is to swap the leftmost @xmath57 letter of the highest dyck word @xmath198 with all the @xmath58 letters to its left except for the leftmost one .",
    "this generates the following set of words ( the swapped letters are in bold to emphasize the transformation ) : @xmath199 looking at the generated dyck path in fig .",
    "[ fig : maxmindyck ]  ( a ) we observe that all dyck paths reaching the level  @xmath200 were obtained . following the swap rule eq .",
    "( [ eq : therule ] ) , the same operation using the dyck path representation given by the @xmath190 word reads @xmath201 recall that in  ( [ eq : firstiter2 ] ) we do exactly the same operation as in  ( [ eq : firstiter ] ) , just with some more information attached to the letters of the dyck word  @xmath190 .",
    "a similar method can be used to generate all dyck paths @xmath174 by starting from @xmath202 .    in the next step",
    "we would have swapped two @xmath57 s and let both gradually propagate to the last allowed word .",
    "but already in this case the resulting words get complicated and so we need to simplify our strategy . before we do",
    "so it is perhaps time to reveal the reason why . in the crucial step that follows ,",
    "we associate the letters @xmath186 and @xmath188 of all dyck paths , generated according to the rule eq .",
    "( [ eq : therule ] ) , with the scalar coefficients given by eqs .",
    "( [ eq : ladderops ] )    [ eq : symbol2real ] @xmath203    resulting in @xmath204 the number @xmath44 is the result of a transformation we call _ evaluation _ of a dyck path @xmath190 .",
    "we already linked boson words eq .",
    "( [ eq : bosonicword ] ) with dyck words @xmath183 via bijection  ( [ eq : bijection ] ) . because @xmath190 is equivalent to @xmath183 , we automatically linked boson words with dyck words @xmath190 .",
    "but here we go further thanks to the fact that @xmath190 carries much more information .",
    "it allows not only to properly count the boson words but also to relate the result of their action on a vacuum state @xmath4 via the assignment in eqs .",
    "( [ eq : symbol2real ] ) .",
    "now it is clear what our goal is : we collect all @xmath190 s , evaluate them and sum them",
    ". this will be equivalent to the action of a sum of all bosonic monomials with the total number of @xmath18 operators @xmath2 and @xmath17 acting on @xmath4 , whose difference between the number of creation and annihilation operators is @xmath53 as a consequence of eqs .",
    "( [ eq : symbol2real ] ) and  ( [ eq : bijection ] )",
    ". the operations  ( [ eq : symbol2real ] ) and ( [ eq : typechange ] ) are peculiar since we effectively changed the variable s type from a symbol and word to a real number .",
    "the number @xmath44 is not , in general , unique since the scalars @xmath205 commute and it may happen that two different dyck words @xmath190 lead to the same @xmath44 .",
    "but this does not bother us since @xmath44 will not be used to identify a dyck path .    in order to execute the transformation",
    "( [ eq : typechange ] ) it is critical to be able to list all dyck paths .",
    "here comes the power of eq .",
    "( [ eq : therule ] ) .",
    "it informs us that the set of indices @xmath11 of every dyck path @xmath190 is identical for the ascending ( @xmath186 ) and descending ( @xmath188 ) sections )  the indices are the same for @xmath206 s and @xmath33 s but they are not ordered in a particularly lucid way . ] . hence to systematically list all dyck paths @xmath174 as the offspring of the highest dyck path we may only focus on the ascending or descending sections of @xmath190 . but it is very easy to list ascending segments only . every dyck path @xmath174 contains the following ascending segments : @xmath207 ( see the properties of dyck paths discussed in sec .  [",
    "sec : dyckcount ] ) .",
    "as follows from the first row of  ( [ eq : generaldycksegments ] ) , the difference of indices of two consecutive ascending segments must be one ( @xmath208 ) .",
    "this is the greatest possible difference because if two ascending segments @xmath186 and @xmath194 are separated by several descending segments @xmath209 it follows from the second and third line of  ( [ eq : generaldycksegments ] ) that @xmath210 .",
    "we just rephrased a simple fact easily seen by inspecting any dyck path ( see figs .",
    "[ fig : dyckexamples ] ,  [ fig : alldycks ] and  [ fig : maxmindyck ] ) .",
    "now we know how to generate all ascending sections of a dyck path @xmath174 and we can directly substitute @xmath211 for @xmath186 as dictated by eq .",
    "( [ eq : symbol2reala ] ) and move on to evaluating the whole dyck path .",
    "let s start with a special case to make the exposition easy to follow .",
    "the product representing the ascending portion of the highest dyck path @xmath212 is @xmath213 .",
    "the lowest dyck path corresponds to @xmath214 .",
    "we can visualize the products obtained from the ascending segments of all dyck paths in a different kind of diagram in fig .",
    "[ fig : dyckstairs ]  ( a ) reflecting the example @xmath197 in fig .",
    "[ fig : maxmindyck ]  ( a ) .",
    "the solid stair path is the highest product and the dotted line is the lowest one .",
    "any product from the `` wedge '' between the two extremal cases comes from an allowed dyck path iff the indices for any consecutive pair @xmath215 of a product satisfy @xmath216 using the fact that ( i ) the number of ascending segments is equal to the number of descending segments ( and so the number of @xmath217 products evaluating the ascending sections is equal to the number of @xmath218 products ) and ( ii ) their indices are identical as a consequence of  ( [ eq : therule ] ) , the sum over all evaluated dyck paths reads @xmath219\\bigg]\\bigg].\\ ] ] we will see in examples  [ exa : k2and3and5and100 ] ,  [ exa:2modesqueez ] and  [ exa:3modescubic ] and further in sec .  [ sec : complex ] that this @xmath220-multiple recursive sum can be explicitly evaluated ( and very fast for large @xmath220 for that matter ) .",
    "note that the sum s upper bound does not change : @xmath221 but for obvious reasons we had to introduce distinct dummy indices .",
    "moreover , the number of sums in the recursive formula is also @xmath222 .",
    "so indeed , the outermost sum is not a sum at all since @xmath223 as visualized by the overlapping segment of the solid and dotted line in fig .",
    "[ fig : dyckstairs ]  ( a ) .",
    "perhaps it is time for an example .",
    "axes count the number of ascending segments . the solid stair - like path and the dotted line on the left represent the evaluated ascending sections of the highest dyck path @xmath224 and lowest dyck path @xmath225 , respectively , that are depicted in fig .  [ fig : maxmindyck ]  ( a ) .",
    "in the middle plot we capture the same situation for @xmath226 from fig .",
    "[ fig : maxmindyck ]  ( b ) . in the right plot we reordered the evaluated ascending segments of the lowest dyck path as suggested by the ascending evaluated product for @xmath227 in eq .",
    "( [ eq : lodykereordered ] ) . ]    [ exa : explicitrecursion ] let @xmath228 and this case can be illustrated on a staircase diagram like the one in fig .",
    "[ fig : dyckstairs ]  ( a ) . in the present case",
    "the diagram ends with the stair where @xmath229 lies .",
    "we can recreate eq .",
    "( [ eq : mainsum1 ] ) from `` inside '' by following the condition  ( [ eq : allowedindices ] ) for @xmath215 and the items ( i ) and ( ii ) above",
    ". therefore , the innermost sum reads @xmath230 ( see the horizontal column in fig .  [",
    "fig : dyckstairs ]  ( a ) between @xmath157 on the dotted line and @xmath229 on the stair ) .",
    "the sum is multiplied by the components of the preceding column ( @xmath231 ) but it depends on @xmath220 ( as  ( [ eq : allowedindices ] ) dictates ) how many summands of the innermost sum are allowed to be multiplied  for @xmath232",
    "the previous sum goes from 1 up to @xmath233 : @xmath234 moving to the next level , only two values ( @xmath235 and @xmath236 ) are possible . hence by repeating the exact same rules , the third inner sum reads @xmath237 together with @xmath238 obtained from the second and third line of  ( [ eq : explicitrecursionk8firstiter ] ) by multiplying by @xmath235 .",
    "finally , the last sum ( not being a sum since the only possibility is @xmath235 ) terminates the recursion : @xmath239 by revising the number of summands ( equal to 14 ) , which counts the number of dyck paths @xmath65 , we may verify that it agrees with eq .",
    "( [ eq : catalan ] ) for @xmath228 .",
    "as already mentioned , the strategy to list all possible dyck paths @xmath174  is  similar to the case @xmath240 .",
    "starting from the highest dyck path we swap our way to the lowest dyck path .",
    "instead of doing it explicitly and encountering confusing expressions like those in eqs .",
    "( [ eq : firstiter ] ) and  ( [ eq : firstiter2 ] ) , we better use the rule eq .",
    "( [ eq : therule ] ) .",
    "but this time the situation seems to be more complicated . the descending section of any dyck path is shorter than the ascending one whenever @xmath241 .",
    "so how do we know what @xmath186 and @xmath188 belong to the same dyck path to properly evaluate the path according to eq .",
    "( [ eq : typechange ] ) ? because @xmath174 is confined to the positive quadrant",
    ", the descending section of the lowest dyck path @xmath242 contains @xmath243 of @xmath244 segments @xmath245 whose evaluation ( following eq .",
    "( [ eq : typechange ] ) ) equals the product @xmath246 the highest dyck path @xmath247 is always of the form @xmath248 and the number of @xmath188 segments correctly coincides with  ( [ eq : lodyke ] ) .",
    "when  ( [ eq : hidyke ] ) is evaluated , we get the expression @xmath249 as previously described , to generate all dyck paths we apply the rule eq .",
    "( [ eq : therule ] ) on the highest dyck path eq .",
    "( [ eq : hidyke ] ) and end up with the lowest one ( eq .  ( [ eq : lodyke ] ) ) .",
    "but the rule in eq .",
    "( [ eq : therule ] ) treats the ascending and descending segments ( more precisely , the indices of their letters @xmath186 and @xmath188 ) in the same way .",
    "so it treats the indices of @xmath250 and @xmath251 in the same way as well . as a consequence , only the underbraced portion of the ascending segment product taken from eq .",
    "( [ eq : hidevaluated ] ) @xmath252 will change as we descend to the lowest dyck path .",
    "after the lowest dyck path is evaluated , its value must necessarily be equal to the product @xmath253 the @xmath254 product denoted ( i ) is the evaluated descending section , product ( ii ) corresponds to the part of the ascending section whose number @xmath243 must be equal to product ( i ) and product ( iii ) is the rest of the evaluated ascending section .",
    "we can pictorially see what is happening in figs .",
    "[ fig : dyckstairs ]  ( @xmath255 ) and  ( @xmath256 ) on the example of @xmath226 from fig .",
    "[ fig : maxmindyck ]  ( b ) .",
    "the solid and dotted staircase in the middle plot is the evaluated ascending segment of the highest and lowest dyck path as can be directly deduced from fig .",
    "[ fig : maxmindyck ]  ( b ) using eq .",
    "( [ eq : symbol2reala ] ) . similarly to @xmath65 exemplified in the left panel , all allowed evaluated ascending sections lie between the two extremal cases .",
    "an ascending section is allowed iff the indices satisfy @xmath257 for any consecutive pair @xmath215 of a product .",
    "it is , however , extremely advantageous to reorder the lowest evaluated section according to the prescription derived in eq .",
    "( [ eq : lodykereordered ] ) .",
    "then we are able to see the product of ( ii ) and ( iii ) from eq .",
    "( [ eq : lodykereordered ] ) in the right panel of fig .",
    "[ fig : dyckstairs ] as the dotted path .",
    "more importantly , all products contain expression ( iii ) and so it can be factored out . in the example",
    ", this happens to be @xmath258 because @xmath259 .",
    "the reason we underwent this laborious transformation to @xmath260 can also be understood as a consequence of @xmath250 being scalars and therefore commuting .",
    "then , in the right panel , the allowed evaluated ascending sections are suitably reordered allowed sections from the middle panel . ] is to find out the summing formula over all evaluated dyck paths @xmath174 . with the help of eq .",
    "( [ eq : lodykereordered ] ) and following the strategy leading to eq .",
    "( [ eq : mainsum1 ] ) we are able to read off the summing formula from fig .  [ fig : dyckstairs ]  ( @xmath256 ) : @xmath261\\bigg]\\bigg ]      \\bigg).\\ ] ] eq .",
    "( [ eq : mainsum2 ] ) is a modification of eq .",
    "( [ eq : mainsum1 ] ) in a transparent way : the total number of sums is @xmath262  this is where the solid and dotted paths in fig .",
    "[ fig : maxmindyck ]  ( @xmath256 ) do not overlap .",
    "the overall multiplicative constant is the overlapping portion of the diagram where the values of @xmath250 and @xmath251 are fixed .",
    "the upper bounds in  ( [ eq : mainsum2 ] ) have again the same value @xmath263 .",
    "( [ eq : mainsum1 ] ) and ( [ eq : mainsum2 ] ) can be used to calculate eq .",
    "( [ eq : expfinalexpansion ] ) .",
    "this is where the true power of our method is exposed : summing over all evaluated dyck paths is greatly facilitated whenever the action of @xmath2 and @xmath17 in eqs .",
    "( [ eq : ladderops ] ) is sufficiently `` nice '' . but",
    "polynomials are always summable ( via bernoulli s formula ) and so the iterative sums in eqs .",
    "( [ eq : mainsum1 ] ) and ( [ eq : mainsum2 ] ) are all closed expressions .    to compare our algorithm with other analytical approaches it is fair to say that for a very special case of @xmath264 the expression @xmath265 $ ] can be used for the same task .",
    "the methods to normal order the expression were developed in  @xcite .",
    "a different kind of combinatorial insight was used by the authors ( more in the spirit of  @xcite ) with the help of generalized stirling numbers .",
    "the results were subsequently used for the calculation of the expectation value @xmath266 for a coherent state @xmath22 . from the conceptual point of view , normally ordered expressions are satisfactory since they are essentially closed and hold in the strong sense , that is , without acting on any state .",
    "but that may be actually a mild disadvantage because it still has to act on a state and the resulting formula can become further complicated .",
    "what is even perhaps less clear is the computational complexity of how effectively it can be evaluated for @xmath267 in actual calculations .",
    "but irrespective of that , here we aim at multiboson operators @xmath2 and @xmath17 ( constituting physically interesting hamiltonians ) , where to the author s best knowledge , analytical results are essentially non - existent .",
    "this will be further used to evaluate the action of the isometry eq .",
    "( [ eq : generalevolutionop ] ) expanded as a taylor series to high order in @xmath18 .",
    "the only ( partial ) exception seems to be  @xcite where , however , two boson modes are coupled such that @xmath268=1 $ ] .",
    "this is not the behavior of ordinary bosons considered here and in quantum field theory or quantum optics .",
    "let s analyze the complexity of calculating eqs .",
    "( [ eq : mainsum1 ] ) and ( [ eq : mainsum2 ] ) for the boson operator @xmath2 being a product of @xmath33 creation and annihilation operators .",
    "this will give us an idea of how tractable our method is .",
    "we will focus on  ( [ eq : mainsum1 ] ) as the worst case scenario and denote the sums upper bounds @xmath269 . from the general action of a boson creation and annihilation operator in eqs .",
    "( [ eq : bosonsteps ] ) we find that @xmath270 is a polynomial of order @xmath33 ( written symbolically ) .",
    "then the innermost sum of  ( [ eq : mainsum1 ] ) @xmath271 is a polynomial of order @xmath272 and so the cost of calculating the sum is @xmath273 . to evaluate the following sum , the polynomial @xmath274",
    "is multiplied by @xmath275 and this is again a polynomial of order @xmath33 : @xmath276 .",
    "the polynomial is summed over @xmath277 but only to @xmath278 . in eq .",
    "( [ eq : mainsum1 ] ) it is the lower bound that changes by one so it is the same number of operations .",
    "the whole recursive formula can then be symbolically depicted as follows @xmath279 we first find the order of the resulting polynomial . from the rhs of ( [ eq : symbpolys ] ) we deduce that the polynomial after the last iteration @xmath280 is of order @xmath281 ( recall that since @xmath240 , @xmath18 is always even ) . for the complexity estimation",
    "we observe that the @xmath11-th recursive sum on the lhs of  ( [ eq : symbpolys ] ) is a sum over @xmath282 summands and a polynomial of order @xmath283 .",
    "henceforth @xmath284 and so the recursive calculation roughly scales as @xmath285 .",
    "this is the main advantage of our method .",
    "it provides a tremendous ( exponential ) speed - up for calculating @xmath286 .",
    "there are @xmath165 summands after expanding @xmath287 and so their number grows exponentially with @xmath18 .",
    "this is prohibitively slow to compute even for a small @xmath18 and it is perhaps obvious that a similar obstacle remains even after we take into account the truncated sum in eq .",
    "( [ eq : expfinalexpansion ] ) . in more detail",
    ", one finds @xmath288 where the stirling formula for the factorial can be used to get the asymptotic estimate of the rhs .",
    "this is the most favorable case since for @xmath289 the number of summands in eq .",
    "( [ eq : expfinalexpansiongeneral ] ) is always bigger for fixed @xmath18 and @xmath53 . by setting @xmath290",
    "we get the worst - case scenario where the growth is simply @xmath291 since none of the summands from @xmath164 acting on a state @xmath292 will vanish ( see the outer sum of eq .",
    "( [ eq : expfinalexpansiongeneral ] ) ) .",
    "the largest number of dyck paths in the worst case scenario happens when @xmath293 for @xmath18 even as long as @xmath294 . in this case",
    "( [ eq : mostgeneraldyckcounting ] ) tells us that the number of dyck paths is @xmath295 .",
    "the dyck paths are then confined to a diamond - like shape illustrated in fig .",
    "[ fig : pathstairs ]  ( a ) for @xmath296 .",
    "are confined to the diamond on the left where the ascending segments of the highest and lowest ( dotted ) dyck path are evaluated by @xmath250 . in panel",
    "( b ) we see the corresponding staircase diagram to illustrate the complexity of calculating @xmath297 in the worst case scenario that occurs for a given @xmath18 when @xmath293 and @xmath294 ( @xmath18 even ) .",
    "here we set @xmath290 . ]    in fig .",
    "[ fig : pathstairs ]  ( b ) we see in the corresponding staircase diagram that unlike the diagram in fig .",
    "[ fig : dyckstairs ]  ( a ) , the ascending segments are not approaching .",
    "consequently , the number of recursive sums ( @xmath298 in  ( [ eq : firstrecursion ] ) in this case ) in each step is constant . following the estimate as in eq .",
    "( [ eq : symbpolys ] ) we arrive at @xmath299 we see that the calculation is nearly as effective as for in  ( [ eq : polycomplexity ] ) .",
    "let s go back to the @xmath70 case as that will be our source of examples to come .",
    "the number of sets of dyck paths with the same value of @xmath53 grows linearly with @xmath18 in the expression @xmath164 . because we have just shown that the sum over these `` @xmath53-sets '' in eq .",
    "( [ eq : mainsum1 ] ) goes as @xmath285 , the calculation of ( [ eq : expfinalexpansion ] ) becomes tractable .",
    "but this also means that the calculation of @xmath300}\\psi^{(0)}\\simeq\\sum_{k=0}^k{r^k\\over k!}(a^\\dg - a\\big)^k\\psi^{(0)}\\ ] ] is polynomial in @xmath301 ( @xmath146 is the minkowski vacuum @xmath302 ) .",
    "the number of summands in  ( [ eq : generalevolutionopexpanded ] ) grows linearly with @xmath301 but as will be discussed in example  [ exa : k2and3and5and100 ] for @xmath303 , even this can be significantly reduced .",
    "let s demonstrate the power of eqs .",
    "( [ eq : mainsum1 ] ) and  ( [ eq : mainsum2 ] ) .",
    "[ exa : k2and3and5and100 ] as a generic single - mode example we will calculate @xmath304 , where @xmath305 , for several values of @xmath18 .    1 .   in this case only two possibilities exist : @xmath185 .",
    "for @xmath240 the number summands @xmath220 in eq .",
    "( [ eq : mainsum1 ] ) equals @xmath306 and so there is nothing to sum  only the outermost sum survives .",
    "but this is not a sum at all as previously discussed because there is only one dyck path @xmath307 .",
    "it remains to calculate @xmath254 and @xmath157 with the help of eqs .",
    "( [ eq : bosonsteps ] ) .",
    "hence , by denoting @xmath308 we get from eqs .",
    "( [ eq : ladderops ] ) @xmath309 and so @xmath310 .",
    "+ for @xmath71 the situation is similar . the number of sums in eq .",
    "( [ eq : mainsum2 ] ) is @xmath311 so only the overall factor @xmath312 is present . from eq .",
    "( [ eq : exak2coefs ] ) we get @xmath313 .",
    "the final answer is @xmath314 this can be readily confirmed by directly calculating @xmath315 .",
    "2 .   for @xmath316",
    "there are two dyck paths @xmath317 .",
    "let s evaluate this case only .",
    "the number of summands in eq .",
    "( [ eq : mainsum2 ] ) is now one ( @xmath318 ) and its upper bound is @xmath319 . but to start showing the potential of the dyck path approach for general @xmath18 we will not set @xmath320 yet .",
    "instead , we calculate @xmath321 and take the liberty of setting @xmath320 in the evaluated sum after we write the final answer given by eq .",
    "( [ eq : mainsum2 ] ) : @xmath322 this is the first step to achieve a closed expression even for a large @xmath18 to be used in the next two examples",
    ". the calculation again agrees with the @xmath323 coefficient of @xmath324 3 .   here",
    "we will illustrate the appearance of one nested sum in eq .",
    "( [ eq : mainsum2 ] ) for @xmath316 coming from @xmath325 . the recursive summation results in @xmath326 where now we set @xmath327 the final answer for @xmath316 is therefore @xmath328 .",
    "this can be verified by hand but it is already rather lengthy .",
    "4 .   to show the strength of our method we calculate @xmath329 for @xmath240 . the number of dyck paths given by eq .",
    "( [ eq : catalan ] ) is @xmath330 the brute - force calculation is out of the question on today s computers .",
    "+ using our approach we see that eq .",
    "( [ eq : mainsum1 ] ) contains 50 recursive sums .",
    "it takes roughly 20 seconds to obtain an analytical result in mathematica on a single - core average laptop .",
    "the result ( the equivalent of ( [ eq : resultexamplek5 ] ) ) is a polynomial of order 200 whose printout would take 24 a4  pages .",
    "the order coincides with the derivation below eq .",
    "( [ eq : symbpolys ] ) for @xmath331 ( note @xmath332 ) . given the recursive character of eq .",
    "( [ eq : mainsum1 ] ) , the code used to generate the result is a one - liner . to calculate the complete expression @xmath333 we , of course , have to calculate the remaining cases for the rest of the @xmath53 s ( @xmath334 ) given by eq .",
    "( [ eq : mainsum2 ] ) .",
    "the number of recursions is @xmath262 but these recursions are already contained in the largest calculation for @xmath240 .",
    "the only thing that differs for each @xmath53 is the sums upper bound .",
    "recall that we calculate the sum for an arbitrary upper bound @xmath335 , where @xmath336 , and plug the value @xmath337 after the calculation .",
    "so we only need to save all  @xmath220 intermediate nested sums calculated for @xmath240 , plug @xmath338 for the rest of @xmath53 and multiply it by the overall factor @xmath339 as required by eq .",
    "( [ eq : mainsum2 ] ) .",
    "indeed , the first nested sum in the @xmath303 calculation is precisely eq .",
    "( [ eq : resultexamplek5 ] ) , where instead of @xmath340 we have @xmath341",
    ". so all the remaining @xmath53 operations are computationally for free ! 5 .",
    "this case is to verify the cubic complexity scaling ( for a fixed @xmath33 ) derived in eq .",
    "( [ eq : polycomplexity ] ) for the recursive sum eq .",
    "( [ eq : mainsum1 ] ) .",
    "it takes some 240 seconds to obtain an analytical result in mathematica .",
    "this is indeed expected : @xmath342 .",
    "the result is a polynomial of order 400 whose printout fits 105 a4 pages .    even without using the computational shortcut for @xmath241 described in the @xmath303 case",
    ", we already got rid of the exponential time complexity by summing over all dyck paths @xmath174 .",
    "the cubic boson expression from the previous examples can be thought as a hamiltonian generating a unitary evolution operator , see example  [ exa : decoup ] for the exact formulation .",
    "but the following unitary is even more important : the two - mode squeezing operator .",
    "its factorization is a routine procedure and so we can compare it with our approach .",
    "[ exa:2modesqueez ] let s investigate @xmath343\\psi^{(0)}$ ] , where @xmath146 is a ground state coinciding with the minkowski vacuum @xmath302 annihilated by @xmath8 .",
    "we will compare the closed form of the amplitude coefficients provided by @xmath344{\\mathop{|0\\rangle}\\nolimits}={1\\over\\cosh{r}}\\sum_{n=0}^\\infty\\tanh^{n}{r}{\\mathop{|n\\rangle}\\nolimits}_{1}{\\mathop{|n\\rangle}\\nolimits}_{2}\\ ] ] with @xmath345 coming from  eq .",
    "( [ eq : generalevolutionopexpanded ] ) .",
    "the calculation reduces to @xmath346 for @xmath347 . using the methods developed in this paper we can afford to set @xmath301 very high and study the evolution for any fixed value of @xmath3 for which @xmath13 converges . from eq .",
    "( [ eq : bosonsteps ] ) we find @xmath348 by setting @xmath349 in eqs .",
    "( [ eq : ladderops ] ) .",
    "it is perhaps clear that for any @xmath18 , the admissible values of @xmath53 tell us to what state @xmath350 we calculate the amplitude contribution .",
    "so , for example , whenever @xmath240 , the contribution goes to the vacuum amplitude @xmath302 , the @xmath316 contributions go to @xmath351 etc . , up to @xmath352 since we know that @xmath353 if @xmath18 is even ( if it is odd we offset @xmath53 by one , see sec .  [",
    "sec : dyckcount ] ) .",
    "if we set @xmath354 , all 200 calculations @xmath355 take roughly 250 seconds to complete _ without _ using further optimization described in the @xmath303 case of example  [ exa : k2and3and5and100 ] . as a matter of fact",
    ", the result of the @xmath18-th expansion summand could have been used to speed up the calculation in all the exponents that followed . neither",
    "this optimization was implemented . just for comparison , considering only the highest contribution ( @xmath356 ) to the vacuum amplitude ( @xmath240 ) , they come from the immense number @xmath357 of dyck paths , according to  eq .",
    "( [ eq : catalan ] ) .",
    "if the evolution operator @xmath13 was evaluated using its taylor expansion , it would be necessary to assume @xmath358 as only a few first expansion coefficients are possible to manage . not in our case . for @xmath354 and",
    "a very high is a relative notion especially because @xmath37 .",
    "nevertheless , compared to what has been possible so far for the taylor expansion , it is indeed high and following our performance analysis in sec .",
    "[ sec : complex ] , we can now calculate any finite value just by sufficiently increasing the taylor expansion . from a physical point of view",
    "it is also high .",
    "if translated to the quantum optical scenario , where @xmath3 is a squeezing parameter , then the squeezing value @xmath359 corresponds to the noise reduction @xmath360 .",
    "this is roughly current state - of - the - art in optical experiments  @xcite .",
    "if we use a special - relativistic comparison based on the local isomorphism @xmath361  @xcite , then @xmath362 is the rapidity corresponding approximately to @xmath363 of the speed of light .",
    "] value of the coupling constant @xmath359 , we get very good agreement with @xmath364 up to @xmath365 : @xmath366 the lower coefficients starting with @xmath367 are essentially indistinguishable from the ones given by the analytical expression . by comparing the taylor expansion of the analytical coefficients @xmath368 with @xmath369",
    "we indeed see the perfect match . also recall that the calculation of eq .",
    "( [ eq : twomodesqueeztaylor ] ) is perturbative but analytical and the value of the coupling constant @xmath3 is inserted after the calculation .",
    "so the expansion is not needed to be recalculated for every numerical value of @xmath3 .",
    "[ exa:3modescubic ] the evolution operator @xmath370}\\ ] ] is supposed to describe the three - photon degenerate parametric amplifier .",
    "some time ago it attracted a lot of attention by an observation made in  @xcite that the vacuum expectation value does not converge for @xmath371 .",
    "the situation was clarified by braunstein and mclachlan  @xcite who uncovered the immediate reason for divergence and used an analytic continuation method based on pad approximants  @xcite showing convergence for a finite interval of @xmath3 .",
    "it is possible that the cause of the bad behavior of @xmath183 is the lack of a self - adjoint extension on the domain of interest of the hamiltonian @xmath372 as this is a subtle issue for unbounded operators .",
    "but to the author s knowledge this problem has not been clarified yet .",
    "what is clear is that the taylor series is essentially useless but even here our method can be used . following the footsteps of  @xcite we converted the taylor expansion coefficients of @xmath373 ( @xmath146 is the minkowski vacuum @xmath302 and ( [ eq : exak2coefs ] )",
    "was used in the calculation and the difference in the minus sign was taken into account as well ) to the pad polynomial @xmath374 $ ] and arrived at an identical result .",
    "see fig .",
    "[ fig : cubic ] and compare it with fig .",
    "2(a ) in  @xcite .",
    "} $ ] is plotted as a function of the coupling constant .",
    "it coincides with the result of  @xcite showing that our method can be useful even for the evolution operators whose taylor series diverges . ]",
    "[ exa : decoup ] for our final example of the developed method i invite the reader to study  @xcite , where a recently developed model of a unitary black hole evaporation based on the trilinear boson hamiltonian @xmath375 is investigated .",
    "similarly to the expression in eq .",
    "( [ eq : cubic ] ) the unitary operator @xmath376}$ ] is not known to be easily factorizable but unlike the cubic evolution operator it exhibits no problems when it comes to the convergence of its taylor series .",
    "in this work , we introduced a method of evaluating evolution operators for the interaction picture hamiltonians of the form @xmath1 , where @xmath2 is a multimode boson monomial and an extensive class of sums of boson monomials and @xmath3 is a coupling constant .",
    "the calculation of the evolution operator @xmath377}$ ] is in general a difficult problem . even though a factorization is always possible , for example , by virtue of the zassenhaus formula or other decoupling techniques , a simple factorization into a small number of products is available only if the operators @xmath2 and @xmath17 satisfy favorable algebraic properties , such as vanishing commutators .",
    "if this is not satisfied , it may happen that there is no simple method left and the remaining techniques at our disposal are computationally demanding .",
    "the taylor expansion in @xmath3 with its subsequent action on a state of interest @xmath146 ( most often a ground state of @xmath2 defined as @xmath144 ) is certainly not the most efficient method as the number of summands increases exponentially with the expansion order .",
    "the method developed here overcomes this problem and allows us to analytically calculate the action of the evolution operator @xmath13 to a very high order of its taylor expansion and previously hardly accessible values of the coupling constant .",
    "this is possible due to an insight that a combinatorial structure known as a dyck path can be related to the action of boson monomials on a ground state @xmath4 .",
    "it helps us to dramatically reduce the complexity of analytically calculating @xmath378 from @xmath379 to @xmath32 for all multimode boson monomials @xmath2 of the length @xmath33 and any ground state @xmath146 .",
    "the boson expression is therefore not required to satisfy any special algebraic property except for the fact that they behave as ladder operators : @xmath380 .",
    "the state @xmath88 is any state from the tower of states generated by the repeated action of @xmath17 on a ground state .",
    "the result is applicable for @xmath13 acting on a ground state but the technique is equally efficient for all @xmath88 .",
    "the speed - up is possible due to the existence of a summing recursive formula that can be explicitly evaluated for all such @xmath2 and @xmath17 forming @xmath287 .",
    "consequently , the complexity of calculating the evolution operator @xmath381 is polynomial - time as well .",
    "all boson evolution operators ( their taylor expansions ) are expressed in terms of @xmath2 and @xmath17 and we believe that our technique could be relevant for computational purposes in condensed matter , quantum field theory , quantum optics and other branches of quantum physics .",
    "we illustrated the method on a non - trivial example of @xmath2 and also verified it in the case of a two - mode squeezed operator , where a simple factorization procedure is well known and the degenerate cubic hamiltonian , whose taylor series is known to diverge for any value of the coupling constant @xmath3 and has to be analytically continued using , for instance , the pad approximants ."
  ],
  "abstract_text": [
    "<S> a time evolution operator in the interaction picture is given by exponentiating an interaction hamiltonian @xmath0 . </S>",
    "<S> important examples of hamiltonians , often encountered in quantum optics , condensed matter and high energy physics , are of a general form @xmath1 , where @xmath2 is a multimode boson operator and @xmath3 is the coupling constant . if no simple factorization formula for the evolution operator exists , the calculation of the evolution operator is a notoriously difficult problem . in this case </S>",
    "<S> the only available option may be to taylor expand the operator in @xmath3 and act on a state of interest @xmath4 . </S>",
    "<S> but this brute - force method quickly hits the complexity barrier since the number of evaluated expressions increases exponentially . </S>",
    "<S> we relate a combinatorial structure called dyck paths to the action of a boson word ( monomial ) and a large class of monomial sums on a quantum state  @xmath4 . </S>",
    "<S> this allows us to cross the exponential gap and make the problem of a boson unitary operator evaluation computationally tractable by achieving polynomial - time complexity for an extensive family of physically interesting multimode hamiltonians . </S>",
    "<S> we further test our method on a cubic boson hamiltonian whose taylor series is known to diverge for all nonzero values of the coupling constant and an analytic continuation via a pad approximant must be performed . </S>"
  ]
}