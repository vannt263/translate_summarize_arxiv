{
  "article_text": [
    "with the advent of increasingly accurate force - fields and powerful computers , molecular dynamics ( md ) simulations have become an ubiquitous tool for studying the static and dynamic properties of systems across disciplines .",
    "however , most realistic systems of interest are characterized by deep , multiple free energy basins separated by high barriers .",
    "the timescales associated with escaping such barriers can be formidably high compared to what is accessible with straightforward md even with the most powerful computing resources . thus in order to accurately characterize such landscapes with atomistic simulations , a large number of enhanced sampling schemes have become popular , starting with the pioneering works of torrie , valleau , bennett and others @xcite .",
    "many of these schemes involve probing the probability distribution along selected low - dimensional collective variables ( cvs ) , either through a static pre - existing bias or through a bias constructed on - the - fly , that enhances the sampling of hard to access but important regions in the configuration space .",
    "the quality , reliability , and usefulness of the sampled distribution is in the end deeply dependent on the quality of the chosen cv .",
    "specifically , one key assumption inherent in several enhanced sampling methods is that of time - scale separation @xcite : for efficient and accurate sampling , the chosen cv should encode all the relevant slow dynamics in the system , and any dynamics not captured by the cv should be relatively fast . for most practical applications ,",
    "there are a large number of possible cvs that could be chosen , and it is not at all obvious how to construct the best low - dimensional cv or cvs for biasing from these various possible options .",
    "success in enhanced sampling simulations has traditionally relied on an apt use of physical intuition to construct such low dimensional cvs .",
    "identification of good low dimensional cvs is in fact useful not just for enhanced sampling simulations such as umbrella sampling and metadynamics but also for distributed computing techniques like markov state models ( msm ) @xcite , allowing one to significantly improve the quality and reliability of the constructed kinetic models .",
    "last but not the least , having an optimal low dimensional cv can also help in the building of brownian dynamics type models @xcite . indeed , given the importance of this problem , there exists a range of methods that have been proposed to solve it @xcite .    in this communication ,",
    "we report a new and computationally efficient algorithm for designing good low - dimensional slow cvs .",
    "we suggest that the best cv is one with the maximum separation of timescales between visible slow and hidden fast processes @xcite , or the maximum spectral gap .",
    "the method is named spectral gap optimization of order parameters ( sgoop ) .",
    "note that in this work henceforth we refer to the best cv in the singular , without loss of any generality in the treatment .",
    "the notion of such a timescale separation is at the core of not just enhanced sampling methods but also coarse - grained , multiscale and projection operator methods @xcite .",
    "our algorithm involves learning the best linear or non - linear combination of given candidate cvs , as quantified by a maximum path entropy @xcite estimate of the spectral gap for the dynamics of that cv .",
    "the input to the algorithm is any available information about the static and dynamic properties of the system , accumulated through ( i ) a biased simulation performed along a sub - optimal trial cv , possibly ( but not necessarily ) complemented by ( ii ) short bursts of unbiased md runs , or ( iii ) by knowledge of experimental observables .",
    "any type of biased simulation could be used in ( i ) , as long as it allows projecting the stationary probability density estimate on generic cvs without having to repeat the simulation .",
    "metadynamics @xcite provides this functionality in a straightforward manner and hence it is our method of choice here . given this information we use the principle of maximum caliber @xcite to set up an unbiased master equation for the dynamics of various trial cvs . through a simple post - processing optimization procedure",
    "we then find the cv with the maximal spectral gap of the associated transfer matrix .",
    "for instance , this optimization can be performed through a simulated annealing approach that maximizes the spectral gap by performing a robust global search in the space of trial cvs .         through three practical examples ,",
    "we show how our post - processing procedure can lead to better choices of cvs , and to several orders of magnitude improvement in the convergence of the free energy calculated through the popular enhanced sampling technique metadynamics .",
    "furthermore , the algorithm is generally applicable irrespective of the number of stable basins .",
    "our algorithm essentially provides the much needed ability to extract useful information about relevant cvs even from unsuccessful metadynamics runs .",
    "in addition to use in free energy sampling methods , the optimized cv can then also be used in other methods that provide kinetic rate constants@xcite .",
    "we expect this algorithm to be of widespread use in designing cvs for biasing during enhanced sampling simulations , making the process significantly more automatic and far less reliant on human intuition .",
    "let us consider a molecular system with @xmath0 atoms at temperature @xmath1 .",
    "we assume there exists a large number @xmath2 of available order parameters with @xmath3 , collectively referred to as @xmath4 , such that the dynamics in this @xmath5dimensional space is markovian .",
    "these could be inter - molecular distances @xcite , torsional angles , solvation states , nucleus size / shape @xcite , bond order parameters @xcite etc .",
    "the identification of such order parameters poses another complicated problem , but as routinely done in other methods aimed at optimizing cvs @xcite , we assume such order parameters are _ a priori _ known .",
    "there are several available biasing techniques that can sample the probability distribution of the space @xmath4 , and even calculate the rate constants for escape from stable states in this space @xcite .",
    "all of these techniques are feasible only for a very small number of cvs whose number is much smaller than @xmath2 - typically one to three .",
    "these are the order parameters whose fluctuations are deemed to be most important for the system or process being studied , and by building a fixed or time - dependent bias of these cvs , one should be able to determine the true unbiased probability distribution of the full space @xmath4 . but",
    "how does one decide what is an optimal low - dimensional subset or combination of the available order parameters ?",
    "this dimensionality reduction is of central importance to methods such as umbrella sampling , metadynamics and others , the answer to which decides the speed of convergence of the biased simulation , or if it it will even ever converge within practically useful simulation times .",
    "the key idea in the current work is to perform enhanced sampling ( _ e.g. _ metadynamics ) with a choice of trial cvs , complemented by information gathered from short bursts of unbiased md simulations and experimental observables when available , to iteratively improve the cvs . the maximum caliber framework @xcite , which is a dynamical generalization of the hugely popular maximum entropy framework @xcite , provides a method for accomplishing this .",
    "we start by choosing a trial cv given by @xmath6 , where @xmath7 maps the space @xmath8 onto a lower dimensional space .",
    "the space along this trial cv @xmath6 is then discretized in grids labeled @xmath9 .",
    "this cv could be multi - dimensional , with @xmath9 then indexing the multidimensional grids .",
    "let @xmath10 denote the instantaneous probability of the system being found in grid @xmath9 .",
    "for the sake of clarity , we assume that @xmath7 is a linear combination of @xmath11 , i.e. @xmath12 . the treatment developed here applies to non - linear combinations as well which we show in the examples .",
    "then , for a fixed @xmath13 , we write a master equation : @xmath14 where @xmath15 is the rate of transition from grid @xmath9 to @xmath16 per unit time .",
    "the matrix @xmath17 is the entirety of all these rates .",
    "if the dynamics of @xmath6 is markovian , then the matrix @xmath18 of transition probabilities is given for small @xmath13 by @xmath19 should not depend on the value of @xmath13 used in eq .",
    "[ eq : master ] .",
    "this provides a self - consistency check of whether or not the cv so generated is markovian . in the maximum caliber approach one uses all available stationary state and dynamical information to construct probabilities of micropaths .",
    "instead of defining the entropy as a function of microstate probabilities as in information theory and statistical thermodynamics @xcite , one now defines an entropy @xmath20 as a functional of the probabilities of micropaths , which is essentially a path integral .",
    "for the markovian process of eq.[eq : master ] @xcite : @xmath21 path ensemble averages of time - dependent quantities @xmath22 can now be calculated as follows @xcite , where the subscripts @xmath23,@xmath24 denote grid indices : @xmath25 the path entropy of eq .",
    "[ eq : caliber ] incremented by quantities accounting for constraints placed by our knowledge of observables @xmath26 , and some other constraints such as detailed balance , is collectively called caliber @xcite .",
    "maximizing the caliber is then equivalent to being least non - committal about missing dynamic and static information , with the end result being that one obtains a relation between the grid - to - grid rates and the stationary probabilities as follows : @xmath27 here @xmath28 runs over the number of available dynamical pieces of information , and @xmath29 is the lagrange multiplier for the associated constraint . as a special case , consider when the only observable at hand is the mean number of transitions in observation interval @xmath30 over the @xmath31 grid @xcite along a trial cv . in this case , the above equation takes a particularly simple and useful form : @xmath32 our method then involves calculating for various trial cvs the spectral gap of the transition probability matrix * k * , which for @xmath33 is @xmath34 and satisfies normalization @xmath35 .",
    "let @xmath36 denote the set of eigenvalues of * k * , with @xmath37 .",
    "the spectral gap is then defined as @xmath38 , where @xmath39 is the number of barriers apparent from the free energy estimate projected on the cv at hand , that are higher than a user - defined threshold ( typically @xmath40 ) . estimating the lagrange multiplier is computationally expensive ,",
    "so a first estimate for maximizing the spectral gap is performed using eq .",
    "[ eq : onlyentire ] where the lagrange multiplier @xmath41 need not be computed . also note that in the limit of small @xmath13 , the matrix @xmath42 will be diagonally dominated @xcite , and to estimate the spectral gap one needs only an accurate estimate of relative local free energies .",
    "more static or dynamical information @xcite simply introduces additional lagrange multipliers and can be treated through eq .",
    "[ eq : localdynamics ] . this can be done if the intention is to calculate an accurate kinetic model with correct estimates of the dominant eigenvalues and not just the spectral gap .      1 .",
    "perform metadynamics along a trial cv @xmath43 to get a crude estimate of the stationary density .",
    "2 .   as post - processing ,",
    "perform optimization in the space of mixing coefficients @xmath44 to identify the cv with the maximal spectral gap .",
    "the reweighting functionality @xcite of metadynamics allows projection of free energy estimates on different cvs with minimal computational effort , and is used to calculate the * k * matrix through eq .",
    "[ eq : onlyentire ] .",
    "we elaborate on the optimization procedure details in the next section ( illustrative examples ) .",
    "the optimization procedure gives the best cv as the one with highest spectral gap , given the information at hand .",
    "as in any maximum entropy framework @xcite , the better the quality of this information , the more accurate will be the spectral gap .",
    "but even with very poor quality information , as we show in the examples , the algorithm still leads to significant improvements in the cv .",
    "furthermore , whether or not the cv is markovian can also be checked by repeating step 2 for different time intervals @xmath13 of observation and determining if the spectral gap is independent of the value of @xmath13 .",
    "the first illustrative example for sgoop is a model 2-state potential introduced by de leon and berne @xcite . to sample this landscape at temperature @xmath45 , we perform metadynamics with path cvs , a class of widely used cvs that can capture non - local and non - linear fluctuations ( see @xcite for details ) .",
    "path cvs require specification of a series of milestones between two points in configuration space , where the milestones can be described in terms of generic order parameters .",
    "fluctuations in the system can then be enhanced in the direction along and perpendicular to these milestones , leading to efficient exploration of the space . in fig .",
    "[ db ] ( a ) we show the 2-d potential along with several possible path cvs imposed on it . we first perform a short trial metadynamics run biasing the y - coordinate . by post - processing this , we generate the spectral gaps for various paths using eq .",
    "[ eq : onlyentire ] ( fig .",
    "[ db ] ( b ) ) . by comparing fig .",
    "[ db](a ) against fig .",
    "[ db](b ) , it is clear how the path with maximum spectral gap is the minimum energy pathway passing through the saddle point . in this case",
    "while this result could have simply been obtained through nudged elastic band type calculations @xcite - the point is to use this example to develop intuition for the method .",
    "also note that moving around the best path to others that are a bit distant from it , does not lead to much change in the spectral gap .",
    "this is consistent with the observation that in several enhanced sampling methods such as metadynamics or umbrella sampling @xcite , the cv need not be precisely the true reaction coordinate , as long as it has a sufficient overlap with it @xcite .",
    "now we move to a more complex system , which has also been considered as a test case for new enhanced sampling methods @xcite in order to establish their usefulness .",
    "this is the 5-residue peptide @xmath46 in vacuum ( see fig .",
    "[ ala3 ] ( a ) ) , where there are six possibly relevant dihedral torsion angles . here",
    "we ask the question : what is the best possible 1-d linear combination of these six dihedrals that we could bias but still maximally enhance exploration of the 6-d space comprising all the dihedrals ?              in this problem , for periodicity related numerical reasons , we bias a reference cosine defined by cos(@xmath47 ) , where @xmath48 is one of the six dihedral angles , and @xmath49 is some reference value whose optimal choice we do not know _ a priori_. through our algorithm we then seek to identify :    1 .   the best choice of mixing coefficients @xmath50 to use in trial cv @xmath51 , where we keep the euclidean norm of @xmath52=1 , and for any angle @xmath48 the prime denotes the transformation @xmath53",
    "2 .   the best choice of @xmath49 , kept same for all 6 dihedrals .",
    "we start with the trial cv where all members of @xmath50 are the same subject to euclidean norm of @xmath54=1 , and an arbitrary choice of @xmath55 radians is taken .",
    "a short metadynamics run is performed biasing this trial cv .",
    "see supplemental information ( si ) for details of the metadynamics and md parameters @xcite , and fig .",
    "[ traj ] ( a ) for the metadynamics trajectory used for spectral gap optimization . based on the free energy estimate generated from this run",
    ", a simulated annealing procedure is performed in the space @xmath54 for various @xmath49 values .",
    "starting from the spectral gap estimated using eq .",
    "[ eq : onlyentire ] for the trial cv , this involves executing metropolis moves in the @xmath54 space with an attempt to find the global maxima of the spectral gap . in fig .",
    "[ ala3 ] ( b - d ) respectively , we show how the spectral gap is increased by the simulated annealing procedure , and the corresponding best estimate of @xmath56 .",
    "the algorithm suggests the minimal role of the angles @xmath57 as can be seen through their relatively low weights @xcite ( fig .",
    "[ ala3 ] ( c ) ) . the spectrum of eigenvalues for dynamics projected on the trial ( magenta ) and optimized ( blue ) cvs , along with respective spectral gaps",
    "is provided in fig .",
    "[ ala3](d ) .",
    "[ traj ] ( a - b ) show the metadynamics trajectories for the three dihedral angles @xmath58 with the trial and the optimized cvs respectively .",
    "a very pronounced improvement in the quality of sampling can be seen .",
    "[ fes ] ( a - c ) shows the rate of convergence of the error of the estimated free energy @xcite with respect to reference values from other approaches @xcite , through metadynamics runs performed with each of the trial and optimized cvs respectively .",
    "the error metric is the same as in @xcite , and is calculated for all points within 25 kj of the global minimum in the respective 1-d free energy .",
    "the behavior is robust with respect to the choice of this threshold value .",
    "as can be seen , the optimized cv , even though it was obtained on the basis of a very poorly converged and short ( 20 ns ) metadynamics run , leads to several orders of magnitudes improvement in the rate at which the free energies converge .",
    "interestingly , iterating the algorithm with the improved 1-d cv did not lead to much improvement in the sampling , reflecting that the optimized coefficients @xmath54 are close to the best that can be achieved with a 1-d cv for this problem .      to conclude , we have introduced a new approach named sgoop ( spectral gap optimization of order parameters ) for improving the choice of low - dimensional cvs for biasing in enhanced sampling in complex systems .",
    "this is accomplished through the use of maximum caliber based spectral gap estimates .",
    "the algorithm is iterative in spirit , and attempts to learn how to improve cvs based on available stationary and dynamic data .",
    "we also provide several proof - of - concept practical examples to establish the potential usefulness of the method . for model",
    "2-d potentials the algorithm was shown to yield the minimum energy pathway .",
    "for a small peptide , we found very significant improvement in determining the best 1-d collective variable from six possible functions with no _ ad hoc _ or _ intuition based _ tuning .",
    "future work will use this algorithm to treat a range of problems , especially involving protein - ligand unbinding .",
    "for instance , the displacement of water molecules and protein flexibility are often slowly varying order parameters in unbinding @xcite , but do we really need to bias one or both of these for the purpose of sampling ? another issue to be considered in future work is can we use these optimized cvs to obtain reliable dynamical information from metadynamics @xcite , including the very important off - rate for ligand unbinding @xcite .    one central limitation of this algorithm is having to specify possibly a large number of order parameters that may be important .",
    "but for many physical problems one does have a sense of which order parameters could be at work , and this is where we expect this algorithm to be of tremendous use .",
    "another obvious limitation is with systems devoid of a time scale separation @xcite - for example , in glassy systems where there is an effectively continuous spectrum of eigenvalues with no discernible time scale separation .",
    "however , the dynamics of many complex and real - world molecular systems does thankfully show a time scale separation between few relevant slow modes and remaining fast ones @xcite , and we expect our algorithm to be of help in unraveling the thermodynamics and dynamics in such systems .",
    "we would like to thank purushottam dixit for helpful discussions regarding caliber , omar valsson for providing system set - up and reference free energies for the peptide , and jed brown for originally suggesting a spectral gap approach .",
    "this work was supported by grants from the national institutes of health [ nih - gm4330 ] and the extreme science and engineering discovery environment ( xsede ) [ tg - mca08x002 ] .",
    "57ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]",
    " + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) voter af ( 1997 ) hyperdynamics : accelerated molecular dynamics of infrequent events .",
    "@noop * * ,   ( ) @noop * * ,   ( ) @noop * * , ( ) @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1103/physrevb.87.094304 [ * * , ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * , ( ) @noop * * ,   ( ) @noop * * , ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1021/ct500040r [ * * , ( ) ] @noop * * ,   ( ) @noop ( ,  ) @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase    10.1103/revmodphys.85.1115 [ * * ,   ( ) ] link:\\doibase 10.1021/jp504920s [ ( ) , 10.1021/jp504920s ] @noop ( ) @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1103/physrevlett.111.230602 [ * * ,   ( ) ] link:\\doibase 10.1073/pnas.1516652112 [ ( ) , 10.1073/pnas.1516652112 ] @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop ( ) @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1103/physrevlett.113.090601 [ * * ,   ( ) ] @noop ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( )"
  ],
  "abstract_text": [
    "<S> in modern day simulations of many - body systems much of the computational complexity is shifted to the identification of slowly changing molecular order parameters called collective variables ( cv ) or reaction coordinates . </S>",
    "<S> a vast array of enhanced sampling methods are based on the identification and biasing of these low - dimensional order parameters , whose fluctuations are important in driving rare events of interest . here </S>",
    "<S> describe a new algorithm for finding optimal low - dimensional collective variables for use in enhanced sampling biasing methods like umbrella sampling , metadynamics and related methods , when limited prior static and dynamic information is known about the system , and a much larger set of candidate cvs is specified . </S>",
    "<S> the algorithm involves estimating the best combination of these candidate cvs , as quantified by a maximum path entropy estimate of the spectral gap for dynamics viewed as a function of that cv . through multiple practical examples , </S>",
    "<S> we show how this post - processing procedure can lead to optimization of cv and several orders of magnitude improvement in the convergence of the free energy calculated through metadynamics , essentially giving the ability to extract useful information even from unsuccessful metadynamics runs . </S>"
  ]
}