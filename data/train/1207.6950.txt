{
  "article_text": [
    "in recent years ecologists have devoted significant attention to the problem of estimating the geographic distribution of a species of interest from records of where it has been found in the past .",
    "there are many motivations for solving this problem , including planning wildlife management actions , monitoring endangered or invasive species , and understanding species response to different habitats .",
    "a great variety of experimental designs and statistical methods exist for tackling this problem , and can be found in the literature on resource - selection functions [ @xcite ] , case - augmented designs [ @xcite ] and site occupancy modeling [ @xcite ] .",
    "ecologists have proposed many statistical methods for modeling such data , including the inhomogeneous poisson process ( ipp ) model [ @xcite ] , maximum entropy ( maxent ) modeling of species distributions [ @xcite , phillips , anderson and schapire ( @xcite ) , @xcite ] and the logistic regression model along with its various generalizations such as gam , mars and boosted regression trees [ @xcite ] .",
    "see @xcite for discussion and comparison of these and other methods in common use .    in recent years",
    "several articles have emerged detailing connections between the three modeling methods above .",
    "each method takes as its input a presence - only data set along with a set of background points consisting of a regular grid or random sample of locations in some geographic region of interest .",
    "@xcite showed that logistic regression estimates converge to the ipp estimate when the size of the presence - only data set is fixed and the background sample grows infinitely large .",
    "@xcite additionally described a variety of models for presence - only and other data sets whose likelihoods may all be derived from the ipp likelihood .",
    "@xcite further explore the connection between maxent and the ipp , taking up the important issue of how we might check the ipps modeling assumptions .    our primary aim in writing this paper is to provide additional clarity to this topic , recapitulating and deriving the results in a unified framework and extending them in several directions .",
    "we view all three major methods as solutions to the same parametric density estimation problem .",
    "modeling of species distributions is simplest and most convincing when the observations of species presence are collected systematically . in a typical design ,",
    "a surveyor visits a one - square - kilometer patch of land for one hour and records how many specimens she discovers in that interval .",
    "the records of unsuccessful surveys are called absence records , a mild misnomer since ecologists recognize that specimens could be present but go undetected . a data set reflecting presence or absence of a species in each sampling unit",
    "is called presence  absence data .",
    "unfortunately , dedicated surveys recording sampling effort are expensive , especially for rare or elusive species . for many species of interest ,",
    "the only data available are museum or herbarium records of locations where a specimen was found and reported , for instance , by a motorist or hiker . typically these presence - only records are collected haphazardly and frequently suffer from unknown sampling bias such as that illustrated in figure [ figrealkoala ] .",
    "the clustering of koala sightings near roads and cities probably has more to do with the behavior of people than of koalas .        in recent years",
    "many such presence - only data sets have become available electronically , and geographic information systems ( gis ) enable ecologists to remotely measure a variety of geographic covariates without having to visit the actual locations of the observations . as a result",
    ", presence - only data has become a popular object of study in ecology [ @xcite ] .",
    "before we can sensibly decide how to model presence - only data , we must address the issue of what it is we are modeling in the first place .",
    "how should we think of `` species occurrence , ''",
    "the scientific phenomenon nominally under study ?",
    "this issue arises with presence - only and presence  absence data alike .",
    "figure [ figwillowtit ] is a typical `` heat - map '' output of a study of the willow tit in switzerland using count data [ @xcite ] .",
    "the map reveals which locations are more or less favored by the species ( in this case , high elevation and moderate forest cover appear to be the bird s habitat of choice ) .",
    "the legend tells us that the color of a region reflects the local probability of `` occurrence . ''",
    "but precisely what event has this probability ? reading the paper , we discover that occurrence means that there is at least one willow tit present on a survey path through a 1 km@xmath01 km quadrat of land . in this case , the authors analyze a presence  absence data set using a hierarchical model that explicitly accounts for the possibility that a bird was present but not detected at the time of the survey .    because the survey path length varies across sampling units , the authors use it in their model as a predictor of presence probability .",
    "it is not specified which value of this predictor is used in generating the heat map , which makes the map difficult to interpret .    even if we could interpret the heat map as the probability of a bird being present anywhere in the quadrat ( not just along a path of unspecified length ) , this probability would still be larger in a 2 km@xmath02 km sampling unit and smaller in a 100  m@xmath0100 m one .",
    "therefore , the very definition of `` occurrence probability '' in a presence  absence study depends crucially on the specific sampling scheme used to collect the presence  absence data .",
    "consequently , interpreting the legend of such a heat map can only make sense in the context of a specific quadrat size , namely , whatever size was used in the study .",
    "we would recommend that this information always be displayed alongside the plot to avoid conveying the false impression ( suggested by a heat map ) that occurrence probability is an intrinsic property of the land , when it is really an extrinsic property .",
    "though the choice of quadrat size used to define occurrence probability is ecologically arbitrary , it can in principle yield estimates with meaningful interpretations .",
    "by contrast , estimating occurrence probability in a presence - only study is a murkier proposition .",
    "any method purporting to do so without reference to quadrat size would be predicting the same occurrence probability within a large or small quadrat , which can not make sense .",
    "since occurrence probability is only meaningful with reference to a specific quadrat size , it is a somewhat awkward quantity to model in a presence - only study . in this context",
    "it is more natural to estimate an occurrence _ rate _ or intensity : that is , a quantity with units of inverse area ( e.g. , 1@xmath1km@xmath2 ) corresponding to the expected number of specimens _ per unit area_. under some simple stochastic models for species occurrence , including the poisson process model considered here , specifying the occurrence rate is equivalent to specifying occurrence probability simultaneously for all quadrat sizes .    unfortunately , a presence - only data set only affords us direct knowledge of the expected number of specimen _ sightings _ per unit area . the absolute sightings rate is reflected in the number of records in our data set , but , at best , this rate is only proportional to the occurrence rate discussed above , which typically is the real estimand of interest .",
    "we must assume that our sightings only constitute a small fraction of the species population over our study region , possibly with repeated sightings of the same specimen .",
    "without other data or assumptions we would have no way of knowing what this constant of proportionality might be .",
    "in other words , the absolute _ sightings _ rate is observable but usually not of direct interest , while the absolute _ occurrence _ rate is interesting but not observable without another source of information . using presence - only data alone",
    ", we can at best hope to estimate a relative , not absolute , occurrence rate . even assuming that the sightings and occurrence rates are proportional is optimistic , since it rules out sampling bias like that in figure [ figrealkoala ] , an issue we take up again in section [ subsecobserverbias ] .",
    "we now introduce notation we will use for the remainder of the article .",
    "we begin with some geographic domain of interest @xmath3 , typically a bounded subset of @xmath4 .",
    "if the time of an observation is an important variable , we might alternatively take @xmath5 , so that our observations have both space and time coordinates . associated with each geographic location @xmath6 is a vector @xmath7 of measured features .    our presence - only data set consists of @xmath8 locations of sightings @xmath9 for @xmath10 , accompanied by @xmath11 `` background '' observations @xmath12 for @xmath13 ( typically a regular grid or uniformly random sample from @xmath3 ) .",
    "finally , let @xmath14 be the features for observation @xmath15 , and @xmath16 be a 0/1 indicator that @xmath15 is a presence sample . our treatment of these data as random or fixed will vary throughout the article .",
    "the rest of the paper is organized as follows . in section  [ secipp ]",
    "we define the log - linear inhomogeneous poisson process ( ipp ) model and its application to presence - only data , with special focus on interpreting its parameters and their maximum likelihood estimates .",
    "in particular , the estimate of the intercept @xmath17 reflects nothing more than the total number of presence samples and , as such , is typically not of scientific relevance for the reasons discussed in section [ subsecoccrate ] .",
    "in fact , ipp model estimation amounts to parametric density estimation in an exponential family model , followed by multiplication of the fitted density by @xmath8 .",
    "the density thus obtained reflects the relative rate of sightings as a function of geographic coordinates @xmath18 .",
    "@xcite showed that many methods in species distribution modeling can be motivated by the ipp model .",
    "we review these connections and generalize them for several illuminating examples . in section [ secmaxent ]",
    "we consider a particularly important example , showing that the popular maxent method of @xcite follows immediately from partially maximizing the ipp log - likelihood with respect to @xmath17 , a result which is explored further in @xcite .",
    "hence , given any set of presence and background points , the maxent and ipp methods obtain identical estimates for the slope @xmath19 and for the density .    in section [ seclogreg ]",
    "we discuss so - called `` naive '' logistic regression and its connections to the ipp model .",
    "we derive its likelihood as a conditional form of the ipp likelihood , but show that if the log - linear model is misspecified this convergence may not occur until the background sample is quite large .",
    "the need for a large background sample is due not only to variance , but also to bias that persists until the proportion @xmath20 becomes negligibly small .",
    "we show , however , that if we upweight all the background samples by large weight @xmath21 , we can use logistic regression to recover the ipp estimate @xmath19 precisely with any finite presence and background sample .",
    "this procedure , which we call `` infinitely weighted logistic regression , '' is a device for using glm software to maximize the ipp log - likelihood .",
    "section [ secdiscussion ] recapitulates the relationships and contains discussion .",
    "the ipp is a simple model for a random set of points @xmath22 falling in some domain @xmath3 .",
    "both the number and locations of points are random .",
    "it can be defined by its intensity function @xmath23 which indexes the likelihood that a point falls at or near @xmath18 . for @xmath24 ,",
    "write @xmath25 and assume @xmath26 .",
    "there are two main ways to formally characterize an ipp with intensity @xmath27 .",
    "one simple definition is that the total number of points is a poisson random variable with mean @xmath28 and , conditionally on the number of points , their locations are independent and identically distributed with density @xmath29 .",
    "that is , an ipp is an i.i.d .",
    "sample from @xmath30 whose size is itself random . as a `` conditional ipp '' ; this is exactly an i.i.d .",
    "sample of size @xmath8 from the density @xmath31 . ]",
    "alternatively , we can think of an ipp as a continuous limit of an independent poisson count model for ever - finer discretizations of @xmath3 .",
    "if @xmath32 , the number of points falling in set @xmath33 , then @xmath34 with @xmath35 and @xmath36 independent for disjoint sets @xmath33 and @xmath37 . for more on the ipp and other point process models , see @xcite or @xcite .    in the case of a finite discrete domain @xmath38 , the ipp model reduces to a discrete poisson model , with @xmath39 . in this sense ,",
    "the ipp model may be seen as a limit of finer and finer discretizations of @xmath3 .",
    "we discuss this connection further in section [ subsecllmconnect ] .",
    "@xcite proposed modeling species sightings @xmath40 as arising from an ipp whose intensity is log - linear in the features @xmath7 : @xmath41 the formal linearity assumption is less restrictive than it seems , since our features @xmath7 could include polynomial terms , interactions , splines or other basis expansions , which substantially broaden the space of possible @xmath42 .    interpreting the ipp as an i.i.d .",
    "sample with random size , we see that @xmath17 and @xmath43 play very different roles . since @xmath17 only multiplies @xmath42 by a constant",
    ", it has no effect on @xmath44 .",
    "the `` slope '' parameters @xmath43 completely determine @xmath30 , while @xmath17 scales the intensity up or down to determine the expected sample size @xmath28 .      in the context of logistic regression",
    ", it can be more natural to think of the @xmath45 as a sample of points in `` feature space '' [ i.e. , the range of @xmath7 ] rather than as the features corresponding to a sample in the geographic domain @xmath3 .",
    "there is no real distinction between these two viewpoints , so long as we adjust for the fact that some values of @xmath47 are more common in @xmath3 than others .",
    "let @xmath48 and @xmath49",
    ". then if the set @xmath22 is an ipp with intensity @xmath50 , the corresponding set @xmath51 is an ipp with intensity @xmath52 and , conditionally on @xmath8 , their distribution is @xmath53 . for more detailed discussion",
    "see @xcite and @xcite .",
    "the score equations for the log - linear ipp are simple and enlightening .",
    "the ipp log - likelihood in terms of the presence samples is @xmath54 differentiating with respect to @xmath17 , we obtain the score equation @xmath55 that is , whatever @xmath19 is , @xmath56 plays the role of a `` normalizing '' constant guaranteeing that @xmath42 integrates to @xmath8 , the number of total presence records .",
    "hence , if @xmath8 is not of scientific interest , then neither is @xmath56 .",
    "solving for @xmath17 in ( [ eqnippscorealpha ] ) and ignoring constants , we obtain the partially maximized log - likelihood @xmath57 which is the same log - likelihood we would obtain by conditioning on @xmath8 and treating the @xmath12 as a random sample with density @xmath58 .",
    "finally , differentiating ( [ eqnintcondlik ] ) with respect to @xmath43 and dividing by @xmath8 gives the remaining score equations : @xmath59 solving ( [ eqnbetascore ] ) amounts to finding @xmath43 for which the expectation of @xmath7 under @xmath60 matches the empirical mean over the presence samples .",
    "hence , maximum likelihood for a log - linear ipp may be thought of as an algorithm with two discrete steps :    1 .",
    "estimate the density @xmath30 : find @xmath19 for which @xmath61 matches the empirical means of the presence sample @xmath45 .",
    "2 .   multiply @xmath62 by @xmath8 : find @xmath56 for which @xmath63 .    unless @xmath8 is meaningful , then , the ipp is essentially density estimation . in our view , it is rare that @xmath8 merits much scientific interest , but there are important cases where it might .",
    "for instance , if we are comparing multiple species , study areas or periods of study , and if we believe that sampling effort is comparable across the different studies , then comparing the @xmath8 from each data set may teach us something .",
    "note , however , that in each of these cases our inference target can be viewed as a relative intensity _ across _ the different data sets .",
    "if we wish to make such comparisons , the right approach may simply be to expand the survey area @xmath3 to include multiple regions or time periods and add region identity or species identity as a feature , then perform a combined analysis .",
    "@xmath8 for the combined analysis ( the total number of sightings across all the different data sets ) would then typically not be of much interest .",
    "when we can not evaluate the integrals in equations ( [ eqnipploglikint])([eqnbetascore ] ) analytically , we replace them with numerical integrals based on the background samples .",
    "hence , ( [ eqnipploglikint ] ) becomes @xmath64 where @xmath65 represents the total area of the region .",
    "the background points may be either a uniform sample from @xmath3 or a regular grid .",
    "quadrature weights may also be assigned to the background points to approximate the integral with a weighted sum , instead of the unweighted sum represented above .",
    "we could repeat the derivation of section [ subsecmaxlikeipp ] to obtain the criteria @xmath66 throughout , we will refer to ( [ eqnipploglik ] ) as the numerical ipp log - likelihood to distinguish it from ( [ eqnipploglikint ] ) . in practice , fitting the ipp means solving ( [ eqnippscorenumerical ] ) for some background sample .",
    "if the background @xmath12 comprise a regular grid , we can discretize @xmath3 into @xmath11 pixels @xmath67 , each of roughly the same size @xmath68 and centered at @xmath12 .",
    "if @xmath7 is continuous , then @xmath69 the ipp model implies that the counts @xmath70 arise independently via @xmath71 hence , the approximate log - likelihood is @xmath72\\\\[-8pt ] & & { } - \\sum_{i : y_i=0}\\log n(a_i)!.\\nonumber\\end{aligned}\\ ] ] let @xmath73 contain the presence samples in pixel @xmath15 .",
    "then @xmath74 hence , the only difference between ( [ eqnipploglik ] ) and ( [ eqnllmloglik ] ) is that in the latter we also discretize the location of each presence sample to match its nearest background point .",
    "@xcite proposed using this approximation to fit the ipp model using poisson glm software , and @xcite show how to generalize it to other point - process models including generalized additive models .",
    "this device provides a simple means of accessing the modeling flexibility of glm methods at a cost of some loss of data , since it effectively replaces the covariate vector @xmath45 for each presence sample with that of its nearest background sample .",
    "@xcite discuss the bias incurred by the discretization , showing in particular that it vanishes in the small - pixel limit .",
    "they also propose a strategy for improving the bias , which splits pixels into subpixels whose covariates are closer to constant .    as we will see later , this discretization is not really necessary . in section [ seclogreg ]",
    "we propose a different procedure , infinitely weighted logistic regression , that also allows us to fit an ipp model using glm software but produces exactly the same estimates we would obtain by maximizing ( [ eqnipploglik ] ) on the original presence and background data .",
    "sampling bias poses a serious challenge to valid inference in presence - only studies .",
    "scientifically , we are interested in the _ occurrence process _ consisting of all specimens of the species of interest . however , our data set consists of what we might call the _ sightings process _ , consisting only of the occurrences observed and reported by people .    we can model the sightings process as an occurrence process",
    "thinned _ by incomplete observation , as proposed by @xcite and @xcite .",
    "that is , suppose that specimens occur with intensity @xmath75 , but that most occurrences go unobserved .",
    "each occurrence is observed with probability @xmath76 , which may depend on features of the geographic location @xmath18 ( e.g. , proximity to the road network ) .",
    "if detection is independent across occurrences , then the observation process is an ipp with intensity @xmath77 the trouble is that our presence - only data set only directly reflects @xmath27 , the intensity of sightings , and not @xmath78 .",
    "optimistically , we might assume that @xmath79 is constant ( no sampling bias ) .",
    "in that case , by estimating @xmath42 we are also estimating @xmath75 up to an unknown constant of proportionality @xmath79 , so @xmath80 but @xmath81 . even in this optimistic scenario",
    "we can only estimate relative , not absolute , occurrence intensities . @xcite",
    "also elaborate the same point in the context of logistic regression models .",
    "slightly less optimistically , we might assume that @xmath79 is an unknown function of  @xmath18 , but that @xmath79 and @xmath78 are known to depend on @xmath18 through two disjoint feature sets .",
    "for instance , we could model @xmath78 and @xmath79 as log - linear in features @xmath82 and @xmath83 , respectively : @xmath84 then the sightings process follows the log - linear model @xmath85 with @xmath86 , @xmath87 and @xmath88 .",
    "note that @xmath89 and @xmath90 are the quantities of primary scientific interest , whereas @xmath17 and @xmath43 are the parameters governing the process we actually observe .",
    "nevertheless , @xmath90 is still identifiable from the data because @xmath43 is . ) and @xmath91 is correlated with the missing variables , even regression adjustment will not remove all bias . in perverse situations",
    "it could even make the situation worse . ]    as @xmath92 , our estimate @xmath93 converges to the true value of @xmath90 , the slope coefficients of @xmath78 .",
    "however , @xmath56 will converge not to @xmath89 but rather to @xmath94 . without knowing @xmath95",
    ", we have no way of estimating @xmath89 . by the same token ,",
    "if some features appear both in @xmath91 and @xmath96or if @xmath91 and @xmath96 are not linearly independent  the model is unidentifiable .    to be concrete , suppose koala occurrence is known to depend only on elevation ( @xmath91 ) , and that sampling bias is known to depend only on proximity to roads  ( @xmath96 ) .",
    "then , despite the obvious sampling bias in figure [ figrealkoala ] , we could still estimate what elevations koalas tend to frequent , by making the correct adjustments for road proximity .",
    "by contrast , we could not estimate from presence - only data alone whether koalas tend to avoid roads , since that is confounded by sampling bias .",
    "whether or not @xmath79 is constant , our estimate for @xmath86 carries no real information about @xmath89 unless we have independent knowledge of @xmath95 .",
    "indeed , we have already seen that the only role @xmath56 plays in estimation is to make @xmath27 integrate to @xmath8 .",
    "the distinction between @xmath43 and @xmath90 may be very important for some problems , but for the remainder of this article we focus on estimation of @xmath43 , the slope parameters of the process we get to observe .",
    "another popular approach to modeling presence - only data , which we will see is equivalent to the ipp , is the maxent method proposed by @xcite .",
    "the authors begin by assuming that the presence samples @xmath40 are a random sample from some probability distribution @xmath97 , called the species distribution .",
    "the authors adopt the view , inspired by information theory , that our estimate @xmath98 should have large entropy @xmath99 .",
    "large @xmath100 means roughly that @xmath101 is close to the uniform density @xmath102 , the species distribution we would observe if the species were indifferent to all geographic features .",
    "the idea is that @xmath98 should be `` nearly geographically uniform , '' subject to constraints that make it resemble the observed data .",
    "@xcite propose to choose the @xmath101 which maximizes @xmath100 subject to the constraint that the expectation of the features @xmath7 under @xmath98 matches the sample mean of those features , that is , @xmath103 they show that this criterion is equivalent to maximizing the likelihood of the parametric exponential family density : @xmath104 this is exactly the form of @xmath30 for our log - linear ipp , and its log - likelihood is exactly the partially maximized log - likelihood @xmath105 , the log - likelihood for an ipp conditioned on @xmath8 . the constraint ( [ eqnmeanconstr ] ) is precisely the score criterion ( [ eqnbetascore ] ) for @xmath43 in an ipp , so the maxent @xmath19 is the same as the ipp @xmath19 .",
    "this result may also be found in appendix a of @xcite .",
    "the popular software package maxent implements a method slightly more complex than the one originally proposed in 2004 .",
    "first , it automatically generates a large basis expansion of the original features into many derived features : quadratic terms , interactions , step functions and hinge functions of the original features .",
    "then , it fits a model by optimizing an @xmath106-regularized version of the conditional ipp likelihood ( [ eqnintcondlik ] ) : @xmath107 the regularization parameters @xmath108 are chosen automatically according to rules based on an empirical study of various presence - only data sets [ @xcite ]",
    ". and @xmath43 to denote what we call @xmath43 and @xmath109 , respectively . ]    mathematically , the basis expansion increases the dimension of @xmath7 but changes nothing else .",
    "moreover , the @xmath106 regularization scheme does not constitute an essential difference with the other methods considered here .",
    "one could ( and often should ) regularize @xmath43 when fitting an ipp model as well , especially if @xmath7 contains many features resulting from a large basis expansion .",
    "penalizing the maxent log - likelihood does not change the equivalence between the two models , so long as @xmath17 is left unpenalized .",
    "if we add a penalty term @xmath110 to the ipp log - likelihood ( [ eqnipploglikint ] ) , we still obtain ( [ eqnippscorealpha ] ) after differentiating with respect to @xmath17 .",
    "then , partially maximizing @xmath111 gives us @xmath112 , the penalized maxent log - likelihood .",
    "this equivalence depends on our not penalizing @xmath17 in ( [ eqnipploglikint ] ) .",
    "this argument generalizes immediately to a generic penalized likelihood method with any parametric form for @xmath113 .",
    "we have established the following general proposition :    [ propippequivcipp ] given some parametric family of real - valued functions @xmath114 with penalty function @xmath115 , consider the penalized log - likelihood @xmath116 for an ipp with intensity @xmath117 , @xmath118 and the penalized log - likelihood @xmath119 for a sample with density @xmath120 : @xmath121 then @xmath122 maximizes @xmath119 iff @xmath123 maximize @xmath116 for some @xmath17 . the same applies if we replace the integrals in ( [ eqngenipp])([eqngencipp ] ) with sums over the background sample .",
    "partially maximize @xmath116 over @xmath17 as in ( [ eqnintcondlik ] ) to obtain @xmath119 .",
    "thus , we see that , while maxent and the ipp appear to be different models with different motivations , they result in the exact same density estimate @xmath124 . in terms of the two - step algorithm we derived in section [ subsecmaxlikeipp ] ,",
    "maxent is identical to step 1 , but it skips step 2 .",
    "the ipp fit @xmath125 is @xmath8 times the maxent fit @xmath98 .",
    "another ostensibly different model for presence - only data is so - called `` naive '' logistic regression , which casts presence - only modeling as a problem of classifying points as presence ( @xmath126 ) or background ( @xmath127 ) on the basis of their features .",
    "the logistic regression model treats @xmath8 , @xmath11 and the @xmath45 as fixed and the @xmath16 as random with @xmath128    superficially , this approach may appear ad hoc and unmotivated compared to ipp or maxent . nevertheless , it has enjoyed some popularity , in part because logistic regression is an extremely mature method in statistics , enjoying myriad well - understood and already - implemented extensions such as gam , mars , lasso , boosted regression trees and more .",
    "logistic regression modeling of presence - only data has often been motivated by analogy to logistic regression for presence  absence data .",
    "since it is not known whether the species is present at or near the background examples , these are sometimes referred to as `` pseudo - absences , '' and the supposed naivete of the method is that it appears to treat background samples as actual absences .",
    "for instance , @xcite introduced latent variables coding `` true '' presence or absence and proposed fitting this model via the em algorithm .",
    "this interpretation raises once again the troublesome question of what it would mean for one of our randomly sampled background points to be a `` true presence . ''",
    "need there be a specimen sitting directly on the location , or is it enough for it to be within 100 m ? 1 km ?",
    "fortunately , we can sidestep these concerns , since connections between the logistic regression and ipp models yield a more straightforward interpretation .",
    "suppose the background data are a uniform random sample , and the presence data arise from a log - linear ipp .",
    "then if we condition on @xmath8 , the @xmath12 are a mixture of two i.i.d .",
    "samples , one from density @xmath129 and the other from density @xmath102 . by bayes rule , for a random index @xmath15 , @xmath130 with @xmath131 .",
    "since @xmath132 depends only on @xmath14 , we could just as well condition on @xmath45 instead , giving ( [ eqnlogreg ] ) .",
    "therefore , if the log - linear ipp model is correct , it implies the individual @xmath133 follow a logistic regression with the same slope parameters @xmath43 .",
    "are technically not conditionally independent ( if we knew the other @xmath134 labels , we would know the last as well ) .",
    "this is always true in case - control studies , but it is typically ignored since the dependence is weak for large samples . ]",
    "thus , given any finite sample of presence and background points , if we believe in the ipp model , then we could either maximize the numerical ipp likelihood or the logistic regression likelihood , and in either case we would be estimating the same population parameter @xmath43 .",
    "this does not guarantee we will obtain the same estimates @xmath19 in any given finite sample , but if the model is correct , then either method gives a consistent estimator of @xmath43 .",
    "note that if we change the marginal class ratio @xmath20 by some factor @xmath135 , the only effect will be to multiply the odds of @xmath136 given @xmath45 by the same factor , that is , add @xmath137 to @xmath138 and leave @xmath43 unchanged . hence , under correct specification , @xmath139 regardless of the limiting ratio @xmath20 .",
    "now , suppose that @xmath42 is not really log - linear in our features @xmath47 .",
    "then , the fitted slopes @xmath19 for logistic regression and the numerical ipp will not converge to the same limiting @xmath43 if @xmath8 and @xmath11 grow large together .",
    "in fact , the limiting logistic regression parameters depend on the limiting ratio of @xmath20 [ @xcite ] .    to gain some intuition for why this is so , suppose we have a single covariate @xmath47 , with @xmath140",
    ". then the derivation of ( [ eqnbayes1])([eqnbayes2 ] ) gives @xmath141 with @xmath138 as before . in the large - sample limit , then , our estimation problem amounts to finding @xmath142 for which @xmath143 in the population from which we are sampling .",
    "now , since changing @xmath20 only adds a vertical shift to the right - hand side of ( [ eqnlogistapprox ] ) , it may seem rather counterintuitive that this should have any impact on the _ slope _",
    "@xmath19 of our approximation on the left - hand side .    to understand why",
    ", we must come to grips with the sense in which we make the approximation in ( [ eqnlogistapprox ] ) .",
    "the logistic regression log - likelihood is @xmath144 its first derivatives with respect to @xmath138 and @xmath43 can be written in terms of the fitted conditional probabilities @xmath145 : @xmath146 if we define @xmath147 , then @xmath142 maximize the likelihood if and only if @xmath148 and @xmath149 .",
    "the crucial point is that the residuals of our approximation , @xmath150 , are measured on the probability scale , and not the log - odds scale .",
    "the black and red curves in the left panel of figure [ figwarping ] show the conditional log - odds @xmath151 for our misspecified model with two different values of @xmath138 , 0 and @xmath152 , respectively . on the log - odds scale ,",
    "one is no steeper than the other .",
    "but when we look at the same two curves on the conditional probability scale ( right panel ) , now the red looks steeper than the black .",
    "this is due to a `` ceiling '' effect for the black curve : in the region where the log - odds @xmath153 is changing fast , the probability @xmath154 has already saturated at 1 .",
    "the actual estimates of @xmath155 and @xmath19 depend on the background density of @xmath47 as well as @xmath20 ; see section [ subsecsimstudy ] for a full simulation .    as @xcite",
    "prove , this ceiling effect vanishes in the limit where @xmath156 ; in that case @xmath157 , @xmath158 , and the logistic regression and ipp estimates are identical .",
    "hence , there is no difference when the background sample grows so large that it dwarfs the presence records in the population from which we are sampling .",
    "@xcite considers a similar framework , called the case - augmented design , and proves a similar equivalency to the ipp as @xmath159 .",
    "if we modify the logistic regression procedure a bit , we can resolve the discrepancy in the previous section and recover the same @xmath19 that we would estimate with an ipp using the same presence and background samples .",
    "we can remove the ceiling effect of the previous section if we add case weights to the samples @xmath160 for some large number @xmath161 .",
    "we then obtain the weighted log - likelihood @xmath162 \\\\ & = & \\sum_{i : y_i=1}\\eta+\\beta'x_i - \\sum_{i}w^{1-y_i}\\log \\bigl(1+e^{\\eta+\\beta'x_i } \\bigr).\\end{aligned}\\ ] ]    let @xmath110 be any convex penalty , and suppose @xmath163 has a unique maximizer @xmath164 . then if @xmath165 maximize @xmath166 for weight @xmath161 , @xmath167    reparameterizing ( [ eqnwlrloglik ] ) with @xmath168 and ignoring constants , we obtain @xmath169\\\\[-8pt ] & & { } - \\sum_{i : y_i=1}\\log\\biggl(1 + \\frac{|{\\mathcal{d}}|}{wn_0}e^{\\alpha+\\beta ' x_i } \\biggr).\\nonumber\\end{aligned}\\ ] ] fixing @xmath170 and taking @xmath171",
    ", each term in the second sum converges to @xmath172 while the third sum converges to 0 .",
    "hence , ignoring constants , ( [ eqnwlrsub ] ) converges to the numerical ipp log - likelihood ( [ eqnipploglik ] ) , and this convergence occurs uniformly on compact subsets of the parameter space .",
    "now , both @xmath173 and @xmath163 are concave , and the latter is strictly concave by assumption ; hence , the maximizer of the first converges to the maximizer of the second .    from the above",
    ", we see that iwlr is not really a new statistical method , but rather a technical device for optimizing the ipp / maxent log - likelihood using already - implemented glm software .",
    "although technically @xmath174 for any finite @xmath161 ( hence the name `` infinitely weighted '' ) , in practice , we only need @xmath161 large enough that the approximation of @xmath175 to @xmath176 is good near @xmath177 .    essentially ,",
    "if @xmath178 for each @xmath15 ( say , all are less than 0.001 ) , then the taylor approximation should be good .",
    "we can assess this easily if we observe that @xmath179 when all of the above are small .",
    "to rephrase , then , if @xmath180 from the logistic regression is less than 0.001 or so , it seems to us that @xmath161 should be sufficiently large . if not , we can set @xmath181 and check that the fitted @xmath182 are now small enough .",
    "if any uncertainty remains whether @xmath161 is large enough , one can always increase it by ( say ) another factor of 100 and check that the estimates do not change appreciably .",
    "one interpretation of the results we have just reviewed is that in the context of presence - only data , logistic regression solves the same parametric density estimation problem as maxent and the ipp do .",
    "moreover , our infinitely weighted logistic regression yields an identical estimate of the density .    using logistic regression for density estimation",
    "has been proposed before .",
    "for example , @xcite discuss it as a means for turning an unsupervised density estimation problem into a supervised classification problem .",
    "their proposal uses a different weighting scheme ( assigning half the total weight to the presence samples ) which , unlike infinitely weighted logistic regression , does not give exactly the ipp solution .",
    "we have seen that both infinitely weighted logistic regression ( a.k.a .",
    "numerical ipp ) and unweighted logistic regression estimate the same @xmath43 parameter of the same log - linear ipp model , and when the background sample is much larger than the presence sample the estimates @xmath19 are close to each other .",
    "however , the infinitely weighted logistic regression estimate can converge much faster to the large - background - sample limit if the linear model is misspecified , as we illustrate here with a simulation study .",
    "consider a geographic region with a single covariate @xmath47 whose background density is @xmath183 . now , suppose a species follows our log - linear ipp model with slope @xmath43 , so that @xmath184",
    ". then the density of presence samples in feature space is @xmath185 .",
    "suppose our species is in fact a mixture of two subspecies , one of which comprises 95% of the population and prefers @xmath47 large , while the remaining 5% prefer @xmath47 small .",
    "if each subspecies follows our model with coefficients 1.5 and @xmath186 , respectively , then @xmath187 which no longer follows the log - linear model . @xmath188 and @xmath189 are depicted in the upper panel of figure [ figsimapprox ] as the dashed and solid black lines .",
    "the black line in the left panel shows @xmath190 , the relative intensity as a function of the covariate @xmath47 . in the left panel",
    "all the curves have been normalized so that @xmath191 .    . ]",
    "if we fit an infinitely - weighted logistic regression ( or , equivalently , a log - linear ipp ) to a large presence and background sample , our fitted @xmath192 will tend to @xmath193 .",
    "we have plotted the corresponding large - sample estimates @xmath194 and @xmath195 as blue lines in the respective panels of figure [ figsimapprox ] .",
    "if , alternatively , we fit an unweighted logistic regression to the same data set with large @xmath196 , the estimate @xmath197 will tend to roughly 1.04 .",
    "the resulting large - sample estimates @xmath198 and @xmath199 are plotted in red .",
    "if we fit an unweighted logistic regression to a large sample with a different ratio @xmath20 , we would get a different estimate , which would tend toward the ipp estimate of 1.325 if and only if this ratio tended to 0 . by the same token , when @xmath8 and @xmath11 are fixed",
    ", the ratio between them can play a significant role in determining the estimated @xmath43 .",
    "in contrast , the iwlr / ipp estimate tends to 1.325 in large samples no matter what the ratio @xmath20 .",
    "estimates for simulation study with @xmath200 and varying @xmath11 .",
    "unweighted logistic regression may require a very large background sample before convergence when the model is misspecified . ]",
    "the left panel of figure [ figwtdunwtdbox ] illustrates this with a simulation study of the example just discussed .",
    "we first generate a single presence sample of size @xmath200 from this species , then generate 20 sets of @xmath11 background samples from @xmath201 for each of a range of values @xmath11 ranging from @xmath202 to @xmath203 .",
    "for each background sample , we fit both an `` infinitely '' weighted ( @xmath204 ) and unweighted logistic regression to the combination of presence and background points .",
    "for relatively large sizes of background sample , there is very little sampling variability , but the logistic regression estimates carry a large bias that depends greatly on the size of the background sample .",
    "the limiting @xmath19 , to which both methods would converge given an infinite background sample , is depicted with a horizontal line .    in the right panel",
    ", we repeat this study with a presence sample from @xmath205 , the correctly - specified model with the same mean as our misspecified model .",
    "now the situation is very different ; no matter what the mix of presence and background samples , the log - odds are truly linear with slope @xmath206 .",
    "consequently , @xmath207 as @xmath159 and @xmath208 , regardless of the limiting ratio @xmath20 .    since the choice of background sample size is primarily a matter of convenience , it is preferable to use an estimator that depends on it as little as possible .",
    "when the linear model is misspecified ( which is nearly always the case ) , we recommend the infinitely weighted logistic regression over unweighted logistic regression for this reason .",
    "we emphasize here that although iwlr resolves the issue of bias that we discussed in section [ subsecmisspec ] , using iwlr does _ not _ guarantee that we will obtain a good estimate for small @xmath11 .",
    "the smaller @xmath11 is , the larger the variance of our estimate , so a larger background set is always better unless computational constraints apply .",
    "what is more , the variability in our estimate due to the background sample is not reflected in the default standard error outputs from glm software  only the variability due to the presence records is .",
    "because@xmath209 for large @xmath161 , its hessian will also converge to the hessian of the ipp .",
    "even if our background sample was extremely large , the standard error estimates for any of the models we have discussed are based on asymptotic normal approximations that hold when the log - linear model is correctly specified .",
    "resampling methods such as the bootstrap are more generally reliable , but even the bootstrap will depend crucially on the assumption that presence records ( and in the case of logistic regression , background records ) are _ independent _ observations . in terms of the ipp model ,",
    "this assumption rules out spatial clustering of presence records .",
    "@xcite provide evidence that this assumption may not hold for presence - only data .",
    "therefore , model - based estimates of standard error should be viewed with suspicion no matter what method we choose .",
    "we have discussed several closely related models for a single presence - only sample . in this section",
    "we collect them all in one place and review their relationships :    the `` mother '' model , from which the others can be derived , is the inhomogeneous poisson process ( ipp ) , whose log - likelihood is @xmath210 in practice , ( [ eqnrevipp ] ) is approximated numerically via @xmath211 fitting this model amounts to solving for the density @xmath212 for which the expected features @xmath213 match the empirical mean @xmath214 , then multiplying that density by @xmath8 .",
    "conditioning on @xmath8 , we obtain the exponential family density model @xmath215 , resulting in the log - likelihood @xmath216 or its numerical counterpart .",
    "this is the log - likelihood maximized by maxent , and it corresponds exactly to the log - likelihood ( [ eqnrevipp ] ) partially maximized with respect to @xmath17 .",
    "hence , both procedures give exactly the same estimates of @xmath43 and @xmath101 .",
    "the logistic regression log - likelihood is @xmath217 when the log - linear ipp model is correctly specified , this model is as well ( aside from the fact that the @xmath133 are only approximately independent ) , with the same true @xmath43 as in the ipp model .",
    "however , in finite samples the estimates for @xmath43 given by maximizing ( [ eqnrevlogreg ] ) instead of ( [ eqnrevippnum ] ) may be substantially different .",
    "we can resolve this difference by upweighting all the background points by @xmath21 , obtaining weighted log - likelihood @xmath218 in the limit where @xmath171 , we recover exactly the same @xmath19 as we would by maximizing ( [ eqnrevippnum ] ) .",
    "another means for approximating the ipp log - likelihood with a glm log - likelihood is the berman and turner method , which simply discretizes geographic space into pixels and assigns each presence point to a bin belonging to its nearest background point : @xmath219 this discretization of presence features is unnecessary given that we can exactly fit the ipp likelihood using the infinitely weighted approach of ( [ eqnrevwlr ] ) .",
    "logistic regression is one of the most widely applied methods in statistics . for decades ,",
    "applied statisticians have been developing , studying and using variations on logistic regression to solve classification problems in statistics .",
    "r packages exist for fitting generalized additive models ( gams ) , boosted regression trees , mars and every manner of tailored regularization schemes [ see , e.g. , @xcite ] .",
    "all of these methods are well understood within the context of logistic regression .",
    "we believe that the most important practical implication of the finite - sample equivalence between the ipp model and infinitely weighted logistic regression is that all of these methods can now be equally well understood and easily applied within the context of the ipp model .",
    "for instance , we can fit an ipp / maxent version of boosted regression trees with the following single line of r :    .... boosted.ipp < - gbm(y~. , family=``bernoulli , '' data = dat , weights=1e3^(1-y ) ) . ....    for an ipp / maxent version of lasso , ridge , or the elastic net : . to avoid issues , set ` glmnet.control(pmin=1.0e-8 , ` ` fdev=0 ) ` in your r session , and keep in mind this renormalization when setting the lagrange parameter @xmath27 . ]    .... lasso.ipp < - glmnet(dat.x , dat.y , family=``binomial , '' weights=1e3^(1-y ) ) . ....    for an ipp gam :    .... gam.ipp < - gam(y~s(x1)+x2 , family = binomial , data = dat , weights=1e3^(1-y ) ) . ....    this added flexibility promises to provide a powerful tool to modelers of presence - only data .",
    "regardless of which of the various related likelihoods we choose , there remains the issue of model selection . with the use of geographic information systems",
    ", ecologists often have access to a large number of predictor variables and may wish to winnow the field before modeling to avoid overfitting .",
    "conversely , if some continuous variables are known to be important predictors , assuming a linear effect on the log - intensity may be too restrictive , and we may wish to expand the basis using splines , interactions , wavelets , etc . in either case , regularization may be called for .    though it would be impossible to give a full treatment here of the many important considerations governing model selection",
    ", we note that these choices need not be governed by which likelihood we take as our starting point . in particular , the large set of derived features and @xmath106 regularization used by maxent software can just as well be applied to the ipp model or , for that matter , to logistic regression . using the infinitely weighted logistic regression method",
    ", we can implement the exact loss function used by the maxent with software for penalized glms .",
    "the authors are grateful to jane elith for helpful discussions and suggestions .",
    "we were also very fortunate to have had very thorough and thoughtful reviewers ; the current manuscript has benefited greatly from their attention ."
  ],
  "abstract_text": [
    "<S> statistical modeling of presence - only data has attracted much recent attention in the ecological literature , leading to a proliferation of methods , including the inhomogeneous poisson process ( ipp ) model , maximum entropy ( maxent ) modeling of species distributions and logistic regression models . </S>",
    "<S> several recent articles have shown the close relationships between these methods . </S>",
    "<S> we explain why the ipp intensity function is a more natural object of inference in presence - only studies than occurrence probability ( which is only defined with reference to quadrat size ) , and why presence - only data only allows estimation of relative , and not absolute intensity of species occurrence .    </S>",
    "<S> all three of the above techniques amount to parametric density estimation under the same exponential family model ( in the case of the ipp , the fitted density is multiplied by the number of presence records to obtain a fitted intensity ) . </S>",
    "<S> we show that ipp and maxent give the exact same estimate for this density , but logistic regression in general yields a different estimate in finite samples . when the model is misspecified  as it practically always is  logistic regression and the ipp may have substantially different asymptotic limits with large data sets . </S>",
    "<S> we propose `` infinitely weighted logistic regression , '' which is exactly equivalent to the ipp in finite samples . </S>",
    "<S> consequently , many already - implemented methods extending logistic regression can also extend the maxent and ipp models in directly analogous ways using this technique . </S>"
  ]
}