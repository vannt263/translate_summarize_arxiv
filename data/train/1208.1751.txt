{
  "article_text": [
    "given a nonlinear control system , a state - constraint set and a target set ( e.g. a neighborhood of an attracting orbit or an equilibrium point ) , the constrained controlled region of attraction ( roa ) is the set of all initial states that can be steered with an admissible control to the target set without leaving the state - constraint set .",
    "the target set can be required to be reached at a given time or at any time before a given time .",
    "the problem of computing the roa ( and variations thereof ) lies at the heart of viability theory  ( see , e.g. ,  @xcite ) and goes by many other names , e.g. , the reach - avoid or target - hitting problem   ( see , e.g. , @xcite ) ; the roa itself is sometimes referred to as the backward reachable set  @xcite or capture basin  @xcite .",
    "there are many variations on the roa computation problem addressed in this paper as well as a large number of related problems .",
    "for instance , one could consider asymptotic convergence instead of finite - time formulation and / or inner approximations instead of outer approximations . among the related problems we can name the computation of ( forward ) reachable sets and maximum / minimum ( robust ) controlled invariant sets .",
    "most of these variations are amenable to our approach , sometimes with different quality of the results obtained ; see the conclusion for a more detailed discussion .",
    "we show that the computation of the roa boils down to solving an infinite - dimensional linear programming ( lp ) problem in the cone of nonnegative borel measures .",
    "the formulation is genuinely primal in the sense that we optimize directly over controlled trajectories modeled with occupation measures @xcite .    in turn , in the case of polynomial dynamics , semialgebraic state - constraint , input - constraint and target sets , this infinite - dimensional lp can be solved approximately by a classical hierarchy of finite - dimensional convex linear matrix inequality ( lmi ) relaxations .",
    "the dual infinite - dimensional lp on nonnegative continuous functions and its lmi relaxations on polynomial sum - of - squares provide explicitly an asymptotically converging sequence of nested semialgebraic outer approximations of the roa .",
    "the benefits of our occupation measure approach are overall the convexity of the problem of finding the roa , and the availability of publicly available software to implement and solve the hierarchy of lmi relaxations .",
    "most of the existing literature on roa computation follows zubov s approach @xcite and uses a dual lyapunov certificate ; see @xcite , the survey @xcite , section 3.4 in @xcite , and more recently @xcite and @xcite and the references therein .",
    "these approaches either enforce convexity with conservative lmi conditions ( whose conservatism is difficult if not impossible to evaluate systematically ) or they rely on nonconvex bilinear matrix inequalities ( bmis ) , with all their inherent numerical difficulties . in contrast , we show in this paper that the problem of computing the roa has actually a convex infinite - dimensional lp formulation , and that this lp can be solved with a hierarchy of convex finite - dimensional lmis with asymptotically vanishing conservatism .",
    "we believe that our approach is closer in spirit to set - oriented approaches @xcite , level - set and hamilton - jacobi approaches @xcite or transfer operator approaches @xcite , even though we do not discretize with respect to time and/or space . in our approach , we model a measure with a finite number of its moments , which can be interpreted as a frequency - domain discretization ( by analogy with fourier coefficients which are moments with respect to the unit circle ) .",
    "another way to evaluate the contribution of our paper is to compare it with the recent works @xcite which deal with polynomial approximations of semialgebraic sets . in these references , the sets to be approximated are given a priori ( as a polynomial sublevel set , or as a feasibility region of a polynomial matrix inequality ) .",
    "in contrast , in the current paper the set to be approximated ( namely the roa of a nonlinear dynamical system ) is not known in advance , and our contribution can be understood as an application and extension of the techniques of references @xcite to sets defined implicitly by differential equations .",
    "for the special case of linear systems , the range of computational tools and theoretical results is wider ; see , e.g. , @xcite .",
    "nevertheless , even for this simple class of systems , the problem of roa computation is notoriously hard , at least in a controlled setting where , after time - discretization , polyhedral projections are required  @xcite .",
    "the use of occupation measures and related concepts has a long history in the fields of markov decision processes and stochastic control ; see , e.g. , @xcite .",
    "applications to deterministic control problems were , to the best of our knowledge , first systematically treated in  @xcite and enjoyed a resurgence of interest in the last decade ; see , e.g. , @xcite and references therein .",
    "however , to the best of our knowledge , this is the first time these methods are applied to region of attraction computation .",
    "our primary focus in this paper is the computation of the constrained finite - time controlled region of attraction of a given set .",
    "this problem is formally stated in section  [ sec : problemstatement ] and solved using occupation measures in section  [ sec : primal ] ; the occupation measures themselves are introduced in section  [ sec : occupmeas ] .",
    "a dual problem on the space of continuous functions is discussed in section  [ sec : dual ] .",
    "the hierarchy of finite - dimensional lmi relaxations of the infinite dimensional lp is described in section  [ sec : lmi ] .",
    "convergence results are presented in section  [ sec : convresults ] .",
    "an extension to the free final time case is described in section  [ sec : infinitetime ] .",
    "numerical examples are presented in section  [ sec : numeex ] , and we conclude in section  [ sec : conclusion ] .",
    "a reader interested only in the finite - dimensional relaxations providing the converging sequence of outer approximations can consult directly the dual infinite - dimensional lp  ( [ vlp ] ) , its finite - dimensional lmi approximations  ( [ dlmi ] ) and the resulting outer approximations in section  [ sec : convresults ] with convergence proven in theorem  [ thm : convset ] .    [ [ notation - and - preliminaries ] ] notation and preliminaries",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + +    throughout the paper the symbol @xmath0}$ ] denotes the set of consecutive integers @xmath1 .",
    "the symbol @xmath2 $ ] denotes the ring of polynomials in variables given by the argument .",
    "the difference of two sets @xmath3 and @xmath4 is denoted by @xmath5 .",
    "all sets are automatically assumed borel measurable ; in particular if we write `` for all sets '' , we mean `` for all borel measurable sets '' . by a measure @xmath6 defined on a set @xmath7",
    ", we understand a signed borel measure , i.e. , a ( not necessarily nonnegative ) mapping from subsets of @xmath8 to real numbers satisfying @xmath9 and @xmath10 for every countable pairwise disjoint collection of sets @xmath11 .",
    "the space of ( signed ) measures on a set @xmath8 is denoted by @xmath12 and the space of continuous functions is denoted by @xmath13 ; the dual space of all linear functionals on @xmath13 is denoted by @xmath14 .",
    "the symbols @xmath15 ( resp .",
    "@xmath16 ) then denote the spaces of all continuous ( resp .",
    "continuously differentiable ) functions taking values in @xmath17 .",
    "any measure @xmath18 can be viewed as an element of @xmath14 via the duality pairing induced by integration of functions in @xmath13 with respect to  @xmath6 : @xmath19 in addition , we use the following notation :    * @xmath20 denotes the indicator function of a set @xmath3 , i.e. , a function equal to @xmath21 on @xmath3 and @xmath22 elsewhere ; * @xmath23 denotes the lebesgue measure on @xmath24 , i.e. , @xmath25 is the standard @xmath26-dimensional volume of a set @xmath27 ; * @xmath28 denotes the support of a measure @xmath6 , that is , the set of all points @xmath29 such that @xmath30 for every open neighborhood @xmath3 of @xmath29 ; by construction this set is closed .",
    "consider the control system @xmath31,\\ ] ] with the state @xmath32 , the control input @xmath33 and a terminal time @xmath34 .",
    "each entry of the vector field @xmath35 is assumed to be polynomial and [ sec : dual ] hold with any lipschitz @xmath35 ; the assumption of @xmath35 being polynomial and the constraint sets semialgebraic is required only for finite - dimensional relaxations of section  [ sec : lmi ] .",
    "] , i.e. , @xmath36 $ ] , @xmath37}$ ] .",
    "the state and the control input are subject to the basic semialgebraic constraints @xmath38}\\},\\ , t\\in [ 0,t ] , \\\\",
    "u(t ) \\in u : = \\ !",
    "{ \\mathbb r}^m : { g^u_i}(u ) \\geq 0 , i\\in\\mathbb{z}_{[1,n_u]}\\ } , \\ , t\\in [ 0,t],\\\\ \\end{array}\\ ] ] with @xmath39 $ ] and @xmath40 $ ]",
    "; the terminal state @xmath41 is constrained to lie in the basic semialgebraic set @xmath42}\\ } \\subset x,\\ ] ] with @xmath43 $ ] .",
    "[ as : compact ] the sets @xmath8 , @xmath44 and @xmath45 are compact .",
    "a measurable control function @xmath46\\to \\mathbb{r}^m$ ] is called admissible if @xmath47 for all @xmath48 $ ] . the set of all admissible control functions",
    "is denoted by @xmath49 .",
    "the set of all admissible trajectories starting from the initial condition @xmath50 generated by admissible control functions is then @xmath51\\big\\ } , \\end{aligned}\\ ] ] where @xmath52 is required to be absolutely continuous .",
    "here , a.e .",
    "stands for `` almost everywhere '' with respect to the lebesgue measure on @xmath53 $ ] .",
    "the constrained controlled region of attraction ( roa ) is then defined as @xmath54 in words , the roa is the set of all initial conditions for which there exists an admissible trajectory , i.e. , the set of all initial conditions that can be steered to the target set in an admissible way .",
    "the set @xmath55 is bounded ( by assumption  [ as : compact ] ) and unique .",
    "in the sequel we pose the problem of computing the roa as an infinite - dimensional linear program ( lp ) and show how the solution to this lp can be approximated with asymptotically vanishing conservatism by a sequence of solutions to linear matrix inequality ( lmi ) problems .",
    "in this section we introduce the concept of occupation measures and discuss its connection to trajectories of the control system  ( [ sys ] ) .      given an initial condition @xmath50 and an admissible trajectory @xmath56 with its corresponding control @xmath57 , which we assume to be a measurable function of @xmath50 , we define the _ occupation measure _ @xmath58 by @xmath59 for all @xmath60\\times x\\times u$ ] . for any such triplet of sets ,",
    "the quantity @xmath61 is equal to the amount of time out of @xmath62 $ ] spent by the state and control trajectory @xmath63 in @xmath64 .",
    "the occupation measure has the following important property : for any measurable function @xmath65 the equality @xmath66\\times x\\times u}\\hspace{-1.1cm}g(t , x , u)\\,d\\mu(t , x , u \\!\\mid\\ !",
    "x_0)\\ ] ] holds .",
    "therefore , loosely speaking , the occupation measure @xmath67 encodes all information about the trajectory of the state and control input @xmath63 .",
    "define further the linear operator @xmath68\\times x)\\to c([0,t]\\times x\\times u)$ ] by @xmath69 and its adjoint operator @xmath70\\times x\\times u)'\\to c^1([0,t]\\times x)'$ ] by the adjoint relation @xmath71\\times x \\times u}\\hspace{-2em } \\mathcal{l}v(t , x , u)\\ , d\\nu(t , x , u)\\ ] ] for all @xmath72\\times x \\times u)=c([0,t]\\times x \\times u)'$ ] and @xmath73\\times x)$ ] .",
    "given a test function @xmath74\\times x)$ ] , it follows from  ( [ eq : occprop ] ) that @xmath75\\times x\\times u}\\hspace{-2.5em } \\mathcal{l}v(t , x , u)\\,d\\mu(t , x , u\\!\\mid\\ ! x_0)\\nonumber \\\\ & \\ : = \\ :",
    "v(0,x_0 ) \\:+\\ : \\langle \\mathcal{l}'\\mu(\\cdot\\!\\mid\\ ! x_0),v \\rangle,\\end{aligned}\\ ] ] where we have used the adjoint relation in the last equality .    the adjoint operator @xmath76 is sometimes expressed symbolically as @xmath77 where the derivatives of measures are understood in the weak sense , or in the sense of distributions ( i.e. , via their action on suitable test functions ) , and the change of sign comes from the integration by parts formula . for more details the interested reader is referred to any textbook on functional analysis and partial differential equation , e.g. , @xcite .",
    "the concept of weak derivatives of measures is not essential for the remainder of the paper and only highlights the important connections of our approach to pde literature .",
    "-1 now consider that the initial state is not a single point but that its distribution in space is modeled by an _",
    "_ initial measure _ _ can be thought of as the probability distribution of @xmath50 although we do not require that its mass be normalized to one . ]",
    "@xmath78 , and that for each initial state @xmath79 there exists an admissible trajectory @xmath80 with an admissible control function @xmath81",
    ". then we can define the average occupation measure @xmath82\\times x \\times u)$ ] by @xmath83 and the _ final measure",
    "_ @xmath84 by @xmath85 the average occupation occupation measure @xmath6 measures the average time spent by the state and control trajectories in subsets of @xmath86 , where the averaging is over the distribution of the initial state given by the initial measure @xmath87 ; the final measure @xmath88 represents the distribution of the state at the final time @xmath89 after it has been transported along system trajectories from the initial distribution @xmath87 .",
    "it follows by integrating ( [ eq : basic ] ) with respect to @xmath87 that @xmath90\\times x\\times u}\\hspace{-2em}\\mathcal{l}v(t , x , u ) \\,d\\mu(t , x , u),\\end{aligned}\\ ] ] or more concisely @xmath91\\times x),\\ ] ] which is a linear equation linking the nonnegative measures @xmath88 , @xmath87 and @xmath6 . denoting @xmath92 the dirac measure at a point @xmath93 and @xmath94 the product of measures , we can write @xmath95 then , eq .  ( [ test ] ) can be rewritten equivalently using the adjoint relation as @xmath96\\times x),\\ ] ] and since this equation is required to hold for all test functions @xmath97 , we obtain the linear operator equation @xmath98 this equation is classical in fluid mechanics and statistical physics , where @xmath76 is usually written using distributional derivatives of measures as remarked above ; then the equation is referred to as liouville s partial differential equation .",
    "each family of admissible trajectories starting from a given initial distribution @xmath78 satisfies liouville s equation  ( [ eq : liouville ] ) .",
    "the converse may not hold in general although for the computation of the roa the two formulations can be considered equivalent , at least from a practical viewpoint .",
    "let us briefly elaborate more on this subtle point now .",
    "the control system @xmath99 , @xmath47 , can be viewed as a differential inclusion @xmath100 it turns out that in general the measures satisfying the liouville s equation  ( [ eq : liouville ] ) are not in a one - to - one correspondence with the trajectories of  ( [ eq : incl1 ] ) but rather with the trajectories of the _ convexified inclusion _ @xmath101 where @xmath102 denotes the convex hull is closed for every @xmath93 since @xmath35 is continuous and @xmath44 compact ; therefore there is no need for a closure in  ( [ eq : incl2 ] ) . ] .",
    "indeed , we show in lemma  [ lem : corr ] in appendix  a that any triplet of measures satisfying liouville s equation  ( [ eq : liouville ] ) is generated by a family of trajectories of the convexified inclusion  ( [ eq : incl2 ] ) . here , given a family;\\mathbb{r}^n)$ ] which is supported on the absolutely continuous solutions to  ( [ eq : incl2 ] ) .",
    "note that there may be more than one trajectory corresponding to a single initial condition since the inclusion  ( [ eq : incl2 ] ) may admit multiple solutions .",
    "] of admissible trajectories of the convexified inclusion  ( [ eq : incl2 ] ) starting from an initial distribution @xmath87 , the occupation and final measures are defined in a complete analogy via ( [ eq : ocmeas ] ) and ( [ eq : finmeas ] ) , but now there are only the time and space arguments in the occupation measure , not the control argument .",
    "let us denote the set of absolutely continuous admissible trajectories of  ( [ eq : incl2 ] ) by @xmath103\\}.\\end{aligned}\\ ] ] then we define the relaxed region of attraction as @xmath104 clearly @xmath105 and the inclusion can be strict ; see appendix  c for concrete examples .",
    "however , by the filippov - wa@xmath106ewski relaxation theorem ( * ? ?",
    "* theorem  10.4.4 , corollary  10.4.5 ) , the trajectories of the original inclusion  ( [ eq : incl1 ] ) are dense ( w.r.t .",
    "the metric of uniform convergence of absolutely continuous functions of time ) in the set of trajectories of the convexified inclusion  ( [ eq : incl2 ] ) .",
    "this implies that the relaxed region of attraction @xmath107 corresponds to the region of attraction of the original system but with infinitesimally dilated constraint sets @xmath8 and @xmath45 ; see appendix  b for more details .",
    "therefore , we argue that there is little difference between the two roas from a practical point of view .",
    "nevertheless , because of this subtle distinction we make the following standing assumption in the remaining part of the paper .",
    "[ relaxed ] control system ( [ sys ] ) is such that @xmath108 .",
    "-1 in other words , the volume of the classical roa @xmath55 is assumed to be equal to the volume of the relaxed roa @xmath107 . obviously , this is satisfied if @xmath109 , but otherwise these sets may differ by a set of zero lebesgue measure .",
    "any of the following conditions on control system ( [ sys ] ) is _ sufficient _ for assumption [ relaxed ] to hold :    * @xmath110 with @xmath111 convex for all @xmath112 , * @xmath113 , @xmath114 with @xmath44 convex , * uncontrolled dynamics @xmath115 ,    as well as all controllability assumptions allowing the application of the constrained filippov - wa@xmath106ewski theorem ; see , e.g. , ( * ? ? ?",
    "* corollary 3.2 ) and the discussion around assumption i in  @xcite .",
    "the problem of computing roa @xmath55 can be reformulated as follows : @xmath116\\times x\\times u \\\\ & & & \\mathrm{spt}\\:\\mu_0 \\subset x , \\:\\ : \\mathrm{spt}\\:\\mu_t \\subset x_t , \\end{array}\\ ] ] where are @xmath35 , @xmath8 , @xmath45 , @xmath44 are given data and the supremum is over a vector of nonnegative measures @xmath117\\times x\\times u)\\times m(x)\\times m(x_t)$ ] .",
    "problem ( [ qlp ] ) is an infinite - dimensional optimization problem on the cone of nonnegative measures .",
    "the rationale behind problem  ( [ qlp ] ) is as follows .",
    "the first constraint is the liouville s equation  ( [ eq : liouville ] ) which , along with the nonnegativity constraints , ensures that any triplet of measures @xmath118 feasible in  ( [ qlp ] ) corresponds to an initial , an occupation and a terminal measure generated by trajectories of the controlled ode  ( [ sys ] ) ( or more precisely of the convexified differential inclusion  ( [ eq : incl2 ] ) ) .",
    "the support constraint on the occupation measure @xmath6 ensures that these trajectories satisfy the state and control constraints ; the support constraint on @xmath88 ensures that the trajectories end in the target set . maximizing the volume of the support of the initial measure then yields an initial measure with the support equal to the roa up to a set of zero volume )",
    "can differ from the roa on the set of zero volume , the outer approximations obtained in section  [ sec : convresults ] are valid `` everywhere '' , not `` almost everywhere '' . ]",
    "( in view of assumption  [ relaxed ] )",
    ". this discussion is summarized in the following lemma .",
    "[ lem : qlp ] the optimal value of problem  ( [ qlp ] ) is equal to the volume of the roa @xmath55 , that is , @xmath119 .    by definition of the roa , for any initial condition @xmath120",
    "there is an admissible trajectory in @xmath121 .",
    "therefore for any initial measure @xmath87 with @xmath122 there exist an occupation measure @xmath6 and a final measure @xmath88 such that the constraints of problem  ( [ qlp ] ) are satisfied .",
    "thus , @xmath123 , where the equality follows from assumption  [ relaxed ] .",
    "-1 now we show that @xmath124 . for contradiction , suppose that a triplet of measures @xmath118 is feasible in  ( [ qlp ] ) and that @xmath125 . from lemma  [ lem : corr ] in appendix  a there is a family of admissible trajectories of the inclusion  ( [ eq : incl2 ] ) starting from @xmath87 generating the @xmath126-marginal of the occupation measure @xmath6 and the final measure @xmath88",
    ". however , this is a contradiction since no trajectory starting from @xmath127 can be admissible .",
    "thus , @xmath128 and so @xmath129 .",
    "consequently , @xmath130 .",
    "the key idea behind the presented approach consists in replacing the direct maximization of the support of the initial measure @xmath87 by the maximization of the integral below the density of @xmath87 ( w.r.t . the lebesgue measure ) subject to the constraint that the density be below one .",
    "this procedure is equivalent to maximizing the mass is defined as @xmath131 .",
    "] of @xmath87 under the constraint that @xmath87 is dominated by the lebesgue measure .",
    "this leads to the following infinite - dimensional lp : @xmath132\\times x\\times u\\\\ & & & \\mathrm{spt}\\:\\mu_0 \\subset x , \\:\\:\\mathrm{spt}\\:\\mu_t \\subset x_t , \\end{array}\\ ] ] where the supremum is over a vector of nonnegative measures @xmath117\\times x\\times u)\\times m(x)\\times m(x_t)$ ] . in problem ( [ rlp ] )",
    "the constraint @xmath133 means that @xmath134 for all sets @xmath27 .",
    "note how the objective functions differ in problems ( [ qlp ] ) and ( [ rlp ] ) .",
    "the following theorem is then almost immediate .",
    "[ thm:1 ] the optimal value of the infinite - dimensional lp problem ( [ rlp ] ) is equal to the volume of the roa @xmath55 , that is , @xmath135 .",
    "moreover , the supremum is attained with the @xmath87-component of the optimal solution equal to the restriction of the lebesgue measure to the roa @xmath55 .",
    "since the constraint set of problem ( [ rlp ] ) is tighter than that of problem ( [ qlp ] ) , by lemma  [ lem : qlp ] we have that @xmath136 for any feasible @xmath87 . from the constraint @xmath137",
    "we get @xmath138 for any feasible @xmath87",
    ". therefore @xmath139 . but",
    "by definition of the roa @xmath55 , the restriction of the lebesgue measure to @xmath55 is feasible in  ( [ rlp ] ) , and so @xmath140 .",
    "consequently @xmath141 .",
    "now we reformulate problem  ( [ rlp ] ) to an equivalent form more convenient for dualization and subsequent theoretical analysis . to this end , let us define the complementary measure ( a slack variable ) @xmath142 such that the inequality @xmath143 in  ( [ rlp ] ) can be written equivalently as the constraints @xmath144 , @xmath145 , @xmath146",
    ". then problem  ( [ rlp ] ) is equivalent to the infinite - dimensional primal lp @xmath147\\times x\\times u\\\\ & & & \\mathrm{spt}\\:\\mu_0 \\subset x , \\:\\:\\mathrm{spt}\\:\\mu_t \\subset x_t\\\\ & & & \\mathrm{spt}\\ : \\hat{\\mu}_0 \\subset x. \\end{array}\\ ] ]",
    "in this section we derive a linear program dual to ( [ rrlp ] ) ( and hence to  ( [ rlp ] ) ) on the space of continuous functions .",
    "a certain super - level set of one of the functions feasible in the dual lp will provide an outer approximation to the roa @xmath55 .    consider the infinite - dimensional lp problem @xmath148\\times x\\times u \\\\ & & &   \\hspace{-0.5em}w(x ) \\ge v(0,x ) + 1 , \\:\\ : & \\hspace{-1em}\\forall\\ , x \\in x \\\\ & & &   \\hspace{-0.5em}v(t , x ) \\geq 0 , \\:\\ : & \\hspace{-1em}\\forall\\ , x \\in x_t\\\\ & & &   \\hspace{-0.5em}w(x ) \\geq 0 , \\:\\ : & \\hspace{-1em}\\forall\\ , x \\in x , \\end{array}\\ ] ] where the infimum is over @xmath149\\times x)\\times c(x)$ ] .",
    "the dual has the following interpretation : the constraint @xmath150 forces @xmath97 to decrease along trajectories and hence necessarily @xmath151 on @xmath55 because of the constraint @xmath152 on @xmath45 .",
    "consequently , @xmath153 on @xmath55 .",
    "this instrumental observation is formalized in the following lemma .",
    "[ lem : v0 ] let @xmath154 be a pair of function feasible in  ( [ vlp ] ) .",
    "then @xmath155 on @xmath55 and @xmath156 on @xmath55 .",
    "by definition of @xmath55 , given any @xmath120 there exists @xmath157 such that @xmath158 , @xmath47 for all @xmath159 $ ] and @xmath160 .",
    "therefore , since @xmath161 on @xmath45 and @xmath150 on @xmath53\\times x\\times u$ ] , @xmath162 where the last inequality follows from the second constraint of  ( [ vlp ] ) .",
    "next , we have the following salient result :    [ thm : nogap ] there is no duality gap between the primal infinite - dimensional lp problems ( [ rlp ] ) and ( [ rrlp ] ) and the infinite - dimensional dual lp problem ( [ vlp ] ) in the sense that @xmath163 .    to streamline the exposition ,",
    "let @xmath164\\times x\\times u)\\times c(x)\\times c(x_t)\\times c(x),\\\\ { \\mathcal m } & : = m([0,t]\\times x\\times u)\\times m(x)\\times m(x_t)\\times m(x),\\end{aligned}\\ ] ] and let @xmath165 and @xmath166 denote the positive cones of @xmath167 and @xmath168 respectively . note that the cone @xmath166 of nonnegative measures of @xmath169 can be identified with the topological dual of the cone @xmath165 of nonnegative continuous functions of @xmath170 .",
    "the cone @xmath166 is equipped with the weak- * topology ; see ( * ? ? ?",
    "* section 5.10 ) .",
    "then , the lp problem ( [ rrlp ] ) can be rewritten as @xmath171 where the infimum is over the vector @xmath172 , the linear operator @xmath173\\times x ) ' \\times m(x)$ ] is defined by @xmath174 the right hand side of the equality constraint in  ( [ plp ] ) is the vector of measures @xmath175\\times x)\\times m(x),$ ] the vector function in the objective is @xmath176 , so the objective function itself is @xmath177 the lp problem ( [ plp ] ) can be interpreted as a dual to the lp problem @xmath178 where the infimum is over @xmath179\\times x)\\times c(x)$ ] , and the linear operator @xmath180\\times x)\\times c(x ) \\to { \\mathcal c}$ ] is defined by @xmath181 and satisfies the adjoint relation @xmath182 .",
    "the lp problem ( [ dlp ] ) is exactly the lp problem ( [ vlp ] ) .    to conclude the proof we use an argument similar to that of ( *",
    "* section c.4 ) . from (",
    "* theorem 3.10 ) there is no duality gap between lps ( [ plp ] ) and ( [ dlp ] ) if the supremum @xmath183 is finite and the set @xmath184 is closed in the weak- * topology of @xmath185 . the fact that @xmath183 is finite follows readily from the constraint @xmath186 , @xmath187 , and from compactness of @xmath8 . to prove closedness",
    ", we first remark that @xmath188 is weakly- * continuous\\times x)'\\times m(x)$ ] is induced by the standard topologies on @xmath189 and @xmath190  the topology of uniform convergence of the function and its derivative on @xmath189 and the topology of uniform convergence on @xmath190 . ] since @xmath191 for all @xmath192\\times x)\\times c(x)$ ] .",
    "then we consider a sequence @xmath193 and we want to show that its accumulation point @xmath194 belongs to @xmath195 , where @xmath196\\times x ) ' \\times m(x)$ ] and @xmath197 . to this end , consider first the test function @xmath198 which gives @xmath199 ; since the measures are nonnegative , this implies that the sequences of measures @xmath200 , @xmath201 and @xmath202 are bounded .",
    "next , taking the test function @xmath203 gives @xmath204 ; this implies that the sequence @xmath205 is bounded as well .",
    "thus , from the weak- * compactness of the unit ball ( alaoglu s theorem ( * ? ? ?",
    "* section 5.10 , theorem  1 ) ) there is a subsequence @xmath206 that converges to an element @xmath207 so that @xmath208 by continuity of @xmath209 .",
    "note that , by theorem  [ thm:1 ] , the supremum in the primal lps  ( [ rlp ] ) and ( [ rrlp ] ) is attained ( by the restriction of the lebesgue measure to @xmath55 ) . in contrast , the infimum in the dual lp ( [ vlp ] ) is not attained in @xmath210\\times x)\\times c(x)$ ] , but there exists a sequence of feasible solutions to  ( [ vlp ] ) whose @xmath211-component converges to the discontinuous indicator @xmath212 as we show next .",
    "before we state our convergence results , we recall the following types of convergence of a sequence of functions @xmath213 to a function @xmath214 on a compact set @xmath24 . as @xmath215 , the functions @xmath216 converge to @xmath211 :    * in @xmath217 norm if @xmath218 , * in lebesgue measure if @xmath219 , * almost everywhere if @xmath220 , @xmath221 , such that @xmath222 pointwise on @xmath223 , * almost uniformly if @xmath224 , @xmath225 , such that @xmath226 uniformly on @xmath223 .",
    "we also recall that convergence in @xmath217 norm implies convergence in lebesgue measure and that almost uniform convergence implies convergence almost everywhere ( see ( * ? ? ?",
    "* theorems 2.5.2 and 2.5.3 ) )",
    ". therefore we will state our results in terms of the stronger notions of @xmath217 norm and almost uniform convergence .",
    "[ thm:2 ] there is a sequence of feasible solutions to the dual lp ( [ vlp ] ) such that its @xmath211-component converges from above to @xmath212 in @xmath217 norm and almost uniformly .    by theorem  [ thm:1 ] , the optimal solution to the primal is attained by the restriction of the lebesgue measure to @xmath55 .",
    "consequently , @xmath227 by theorem  [ thm : nogap ] , there is no duality gap ( @xmath228 ) , and therefore there exists a sequence @xmath229\\times x)\\times c(x)$ ] feasible in  ( [ vlp ] ) such that @xmath230 from lemma [ lem : v0 ] we have @xmath231 on @xmath55 and since @xmath232 on  @xmath8 by the fourth constraint of  ( [ vlp ] ) , we have @xmath233 on  @xmath8 for all @xmath234 .",
    "thus , subtracting  ( [ eq : thm2_1 ] ) from  ( [ eq : thm2_2 ] ) gives @xmath235 where the integrand is nonnegative .",
    "hence @xmath216 converges to @xmath212 in @xmath217 norm . from (",
    "* theorems 2.5.2 and 2.5.3 ) there exists a subsequence converging almost uniformly .",
    "in this section we show how the infinite - dimensional lp problem  ( [ rrlp ] ) can be approximated by a hierarchy of lmi problems with the approximation error vanishing as the relaxation order tends to infinity .",
    "the dual lmi problem is a sum - of - squares ( sos ) problem and yields a converging sequence of outer approximations to the roa .    the measures in equation  ( [ test ] ) ( or ( [ eq : liouville ] ) )",
    "are fully determined by their values on a family of functions whose span is dense in @xmath210\\times x)$ ] .",
    "hence , since all sets are assumed compact , the family of test functions in  ( [ test ] ) can be restricted to any polynomial basis ( since polynomials are dense in the space of continuous functions on compact sets equipped with the supremum norm ) .",
    "the basis of our choice is the set of all monomials .",
    "this basis is convenient for subsequent exposition and is employed by existing software ( e.g. , @xcite ) .",
    "nevertheless , another polynomial basis may be more appropriate from a numerical point of view ( see the conclusion for a discussion ) .",
    "let @xmath236 $ ] denote the vector space of real multivariate polynomials of total degree less than or equal to @xmath234 .",
    "each polynomial @xmath237 $ ] can be expressed in the monomial basis as @xmath238 where @xmath239 runs over the multi - indices ( vectors of nonnegative integers ) such that @xmath240 .",
    "a polynomial @xmath241 is identified with its vector of coefficients @xmath242 whose entries are indexed by @xmath239 . given a vector of real numbers @xmath243 indexed by @xmath239 , we define the linear functional @xmath244\\to { \\mathbb r}$ ] such that @xmath245 where the prime denotes transposition .",
    "when entries of @xmath246 are moments of a measure @xmath6 , i.e. , @xmath247 the linear functional models the integration of a polynomial with respect to @xmath6 , i.e. , @xmath248 when this linear functional acts on the square of a polynomial @xmath249 of degree @xmath234 , it becomes a quadratic form in the polynomial coefficients space , and we denote by @xmath250 and call the _ moment matrix _ of order @xmath234 the matrix of this quadratic form , which is symmetric and linear in @xmath246 : @xmath251 finally , given a polynomial @xmath252 $ ] we define the _ localizing matrix _ @xmath253 by the equality @xmath254 the matrix @xmath253 is also symmetric and linear in @xmath246 . for a detailed exposition and examples of moment and localizing matrices see  ( * ? ? ?",
    "* section 3.2.1 ) .",
    "let @xmath246 , @xmath255 , @xmath256 and @xmath257 respectively denote the sequences of moments of measures @xmath6 , @xmath87 , @xmath88 and @xmath258 such that the constraints in problem ( [ rrlp ] ) are satisfied .",
    "then it follows that these sequences satisfy an infinite - dimensional linear system of equations corresponding to the equality constraints of problem  ( [ rrlp ] ) written explicitly as @xmath259\\times x \\times u } \\hspace{-2em}\\mathcal{l}v(t , x , u)\\ , d\\mu(t , x , u )   = 0,\\end{aligned}\\ ] ] @xmath260 for the particular choice of test functions @xmath261 and @xmath262 for all @xmath263 and @xmath264 , let us denote by @xmath265 the finite - dimensional truncation of this system obtained by considering only the test functions of total degree less than or equal to @xmath266 .",
    "let further @xmath267 where @xmath268 denotes the degree of a polynomial .",
    "the primal lmi relaxation of order @xmath234 then reads @xmath269}\\\\ & & & \\hspace{0em } m_{k-1}(t(t\\!-\\!t),y ) \\succeq 0 , &   \\hspace{0em}m_{k-{d_u}_i}(g^u_i , y ) \\succeq 0 , & i\\in\\mathbb{z}_{[1,n_u ] } \\\\ & & & \\hspace{0em } m_k(y_0 ) \\succeq 0 , & \\hspace{0em } m_{k-{d_x}_i}({g^x_i},y_0 ) \\succeq 0 , & i\\in\\mathbb{z}_{[1,n_x ] } \\\\ & & & \\hspace{0em } m_k(y_t ) \\succeq 0 , & \\hspace{0em } m_{k-{d_t}_i}({g^{x_t}_i},y_t ) \\succeq 0 , & i\\in\\mathbb{z}_{[1,n_t]}\\\\ & & & \\hspace{0em } m_k(\\hat{y}_0 ) \\succeq 0 , & \\hspace{0em } m_{k-{d_x}_i}({g^x_i},\\hat{y}_0 ) \\succeq 0 , & i\\in\\mathbb{z}_{[1,n_x ] } ,   \\end{array}\\ ] ] where the notation @xmath270 stands for positive semidefinite and the minimum is over sequences @xmath271 truncated to degree @xmath266 .",
    "the objective function is the first element ( i.e. , the mass ) of the truncated moment sequence @xmath255 corresponding to the initial measure ; the equality constraint captures the two equality constraints of problem  ( [ rrlp ] ) evaluated on monomials of degree up to @xmath266 ; and the lmi constraints involving the moment and localizing matrices capture the nonnegativity and support constraints on the measures , respectively .",
    "note that both the equality constraint and the lmi constraints are necessarily satisfied by the moment sequence of any vector of measures feasible in ( [ rrlp ] ) .",
    "the constraint set of  ( [ plmi ] ) is therefore looser than that of ( [ rrlp ] ) ; however , the discrepancy between the two constraint sets monotonically vanishes as the relaxation order @xmath234 tends to infinity ( see corollary  [ cor : pdconv ] below ) .",
    "problem ( [ plmi ] ) is a semidefinite program ( sdp ) , where a linear function is minimized subject to convex lmi constraints , or equivalently a finite - dimensional lp in the cone of positive semidefinite matrices .    without loss of generality",
    "we make the following standard assumption for the reminder of this section .",
    "[ compact ] one of the polynomials defining the sets @xmath8 , @xmath44 respectively @xmath45 , is equal to @xmath272 , @xmath273 respectively @xmath274 for some constants @xmath275 , @xmath276 respectively @xmath277 .",
    "assumption [ compact ] is without loss of generality since the sets @xmath8 , @xmath44 and @xmath45 are bounded , and therefore redundant ball constraints of the form @xmath278 , @xmath279 and @xmath280 can always be added to the description of the sets @xmath8 , @xmath44 and @xmath45 for sufficiently large @xmath281 , @xmath282 and  @xmath283 .",
    "-1 the dual to the sdp problem ( [ plmi ] ) is given by @xmath284 where @xmath285 is the vector of the moments of the lebesgue measure over @xmath8 indexed in the same basis in which the polynomial @xmath286 with coefficients @xmath211 is expressed .",
    "the minimum is over polynomials @xmath287 $ ] and @xmath288 $ ] , and polynomial sum - of - squares @xmath289 , @xmath290 , @xmath291}$ ] , @xmath292 , @xmath293}$ ] , @xmath294 , @xmath295 , @xmath296 , @xmath297 , @xmath298 , @xmath299 , @xmath300}$ ] of appropriate degrees .",
    "the constraints that polynomials are sum - of - squares can be written explicitly as lmi constraints  ( see , e.g. , @xcite ) , and the objective is linear in the coefficients of the polynomial @xmath286 ; therefore problem  ( [ dlmi ] ) can be formulated as an sdp .",
    "[ lem : nogaprelax ] there is no duality gap between primal lmi problem ( [ plmi ] ) and dual lmi problem ( [ dlmi ] ) , i.e. , @xmath301 .",
    "see appendix  d.",
    "in this section we show how the dual lmi problem  ( [ dlmi ] ) gives rise to a sequence of outer approximations to the roa @xmath55 with a guaranteed convergence .",
    "in addition , we prove the convergence of the primal and dual optimal values @xmath302 and @xmath303 to the volume of the roa , and the convergence of the @xmath211-component of an optimal solution to the dual lmi problem  ( [ dlmi ] ) to the indicator function of the roa @xmath212 .",
    "let the polynomials @xmath304 , each of total degree at most @xmath266 , denote an optimal solution to the problem @xmath305 order dual sdp approximation  ( [ dlmi ] ) and let @xmath306 and @xmath307 denote their running minima .",
    "then , in view of lemma  [ lem : v0 ] and the fact that any feasible solution to ( [ dlmi ] ) is feasible in ( [ vlp ] ) , the sets @xmath308 and @xmath309 provide outer approximations to the roa ; in fact , the inclusions @xmath310 hold for all @xmath311 .",
    "our first convergence result proves the convergence of @xmath216 and @xmath312 to the indicator function of the roa @xmath212 .",
    "[ thm : dualconvfun ] let @xmath313 $ ] denote the @xmath211-component of an optimal solution to the dual lmi problem ( [ dlmi ] ) and let @xmath314",
    ". then @xmath216 converges from above to @xmath212 in @xmath217 norm and @xmath312 converges from above to @xmath212 in @xmath217 norm and almost uniformly .    from lemma  [ lem : v0 ] and",
    "theorem  [ thm:2 ] , for every @xmath315 there exists a @xmath316\\times x)\\times c(x)$ ] feasible in  ( [ vlp ] ) such that @xmath317 and @xmath318 .",
    "set @xmath319 since @xmath97 is feasible in ( [ vlp ] ) , we have @xmath320 , and @xmath321 . since also @xmath322 , it follows that @xmath323 is _ strictly _ feasible in  ( [ vlp ] ) with a margin at least @xmath324 .",
    "since @xmath53\\times x$ ] and @xmath8 are compact , there exist polynomials @xmath325 and @xmath326 of a sufficiently high degree such that @xmath327\\times x}\\limits|\\tilde{v } - \\hat{v}| < \\epsilon$ ] , @xmath327\\times x\\times u}\\limits |\\mathcal{l}\\tilde{v } - \\mathcal{l}\\hat{v}| < \\epsilon$ ] and @xmath328 .",
    "the pair of polynomials @xmath329 is therefore _",
    "strictly _ feasible in  ( [ vlp ] ) and as a result , under assumption  [ compact ] , feasible in  ( [ dlmi ] ) for a sufficiently large relaxation order @xmath234 ( this follows from the classical positivstellensatz by putinar ; see , e.g. , @xcite or @xcite ) , and moreover @xmath330 .",
    "consequently , @xmath331 , and so @xmath332 .",
    "therefore @xmath333 where @xmath334 < \\infty$ ] is a constant .",
    "this proves the first statement since @xmath324 was arbitrary .",
    "the second statement immediately follows since given a sequence @xmath335 in @xmath336 norm , there exists a subsequence @xmath337 that converges almost uniformly to @xmath212 by ( * ? ? ?",
    "* theorems 2.5.2 and 2.5.3 ) and clearly @xmath338 .",
    "the following corollary follows immediately from theorem  [ thm : dualconvfun ] .",
    "[ cor : pdconv ] the sequence of infima of lmi problems  ( [ dlmi ] ) converges monotonically from above to the supremum of the infinite - dimensional lp problem  ( [ vlp ] ) , i.e. , @xmath339 and @xmath340 .",
    "similarly , the sequence of maxima of lmi problems ( [ plmi ] ) converges monotonically from above to the maximum of the infinite - dimensional lp problem ( [ rlp ] ) , i.e. , @xmath341 and @xmath342 .",
    "monotone convergence of the dual optima @xmath303 follows immediately from theorem  [ thm : dualconvfun ] and from the fact that the higher the relaxation order @xmath234 , the looser the constraint set of the minimization problem  ( [ dlmi ] ) . to prove convergence of the primal maxima observe that from weak sdp duality we have @xmath343 and from theorems  [ thm : dualconvfun ] and  [ thm : nogap ] it follows that @xmath344 .",
    "in addition , clearly @xmath345 and @xmath346 since the higher the relaxation order @xmath234 , the tighter the constraint set of the maximization problem  ( [ plmi ] ) .",
    "therefore @xmath347 monotonically from above .",
    "theorem  [ thm : dualconvfun ] establishes a functional convergence of @xmath216 to @xmath212 and corollary  [ cor : pdconv ] a convergence of the primal and dual optima @xmath302 and @xmath303 to the volume of the roa @xmath348 .",
    "finally , the following theorem establishes a set - wise convergence of the sets  ( [ eq : x0k ] ) and  ( [ eq : barx0k ] ) to the roa @xmath55 .",
    "[ thm : convset ] let @xmath349\\times { \\mathbb r}_{2k}[x]$ ] denote a solution to the dual lmi problem ( [ dlmi ] ) .",
    "then the sets @xmath350 and @xmath351 defined in  ( [ eq : x0k ] ) and ( [ eq : barx0k ] ) converge to the roa @xmath55 from the outside such that @xmath352 and @xmath353 moreover the convergence of @xmath351 is monotonous , i.e. , @xmath354 whenever @xmath355 .",
    "the inclusion @xmath356 follows from lemma  [ lem : v0 ] since any solution to ( [ dlmi ] ) is feasible in ( [ vlp ] ) and since @xmath357 .",
    "the latter fact also proves the monotonicity of the sequence @xmath351 .",
    "next , from lemma  [ lem : v0 ] we have @xmath233 and therefore , since @xmath358 on @xmath8 , we have @xmath359 on @xmath8 . in addition , from theorem  [ thm : dualconvfun ] we have @xmath335 in @xmath217 norm on @xmath8 ; therefore @xmath360 but since @xmath361 we must have @xmath362 and the theorem follows .",
    "in this section we outline a straightforward extension of our approach to the problem of reaching the target set @xmath45 at _ any _ time before @xmath363 ( and not necessarily staying in @xmath45 afterwards ) .",
    "it turns out that the set of all initial states @xmath50 from which it is possible to reach @xmath45 at a time @xmath364 can be obtained as the support of an optimal solution @xmath365 to the problem @xmath366\\times x\\times u\\\\ & & \\mathrm{spt}\\:\\mu_0 \\subset x , \\:\\:\\mathrm{spt}\\:\\mu_t \\subset [ 0,t]\\times x_t , \\end{array}\\ ] ] where the supremum is over a vector of nonnegative measures @xmath117\\times x\\times u)\\times m(x)\\times m([0,t]\\times x_t)$ ] .",
    "note that the only difference to problem  ( [ rlp ] ) is in the support constraints of the final measure @xmath88 .",
    "the dual to this problem reads as @xmath367\\times x\\times u \\\\ & & w(x ) \\ge v(0,x ) + 1 , \\:\\ : & \\!\\!\\forall\\ , x \\in x \\\\ & & v(t , x ) \\geq 0 , \\:\\ : & \\!\\!\\forall\\ , ( t , x ) \\in [ 0,t ] \\times x_t\\\\ & & w(x ) \\geq 0 , \\:\\ : & \\!\\!\\forall\\ , x \\in x. \\end{array}\\ ] ] the only difference to problem  ( [ vlp ] ) is in the third constraint which now requires that @xmath368 is nonnegative on @xmath45 for _ all _ @xmath369 $ ] .",
    "all results from the previous sections hold with proofs being almost verbatim copies .",
    "in this section we present five examples of increasing complexity to illustrate our approach : a univariate uncontrolled cubic system , the van der pol oscillator , a double integrator , the brockett integrator and an acrobot . for numerical implementation",
    ", one can either use gloptipoly  3  @xcite to formulate the primal problem on measures and then extract the dual solution provided by a primal - dual sdp solver or formulate directly the dual sos problem using , e.g. , yalmip  @xcite or sostools  @xcite . as an sdp solver we used sedumi  @xcite for the first three examples and mosek for the last two examples . for computational purposes",
    "the problem data should be scaled such that the constraint sets are contained in , e.g. , unit boxes or unit balls ; in particular the time interval @xmath53 $ ] should be scaled to @xmath370 $ ] by multiplying the vector field @xmath35 by @xmath89 .",
    "computational aspects are further discussed in the conclusion .",
    "whenever the approximations @xmath350 defined in  ( [ eq : x0k ] ) are monotonous ( which is not guaranteed ) we report these approximations ( since then they are equal to the monotonous version @xmath351 defined in  ( [ eq : barx0k ] ) ) ; otherwise we report @xmath351 .",
    "consider the system given by @xmath371 the constraint set @xmath372 $ ] , the final time @xmath373 and the target set @xmath374 $ ] .",
    "the roa can in this case be determined analytically as @xmath375 $ ] .",
    "polynomial approximations to the roa for degrees @xmath376 are shown in figure  [ fig:1 ] . as expected the functional convergence of the polynomials to the discontinuous indicator function",
    "is rather slow ; however , the set - wise convergence of the approximations @xmath350 ( where @xmath377 ) is very fast as shown in table  [ tab:1 ] . note that the volume error is not monotonically decreasing  indeed what is guaranteed to decrease is the integral of the approximating polynomial @xmath286 , not the volume of @xmath350 . taking the monotonically decreasing approximations @xmath351 defined in  ( [ eq : barx0k ] ) would prevent the volume increase .",
    "numerically , a better behavior is expected when using alternative polynomial bases ( e.g. , chebyshev polynomials ) instead of the monomials ; see the conclusion for a discussion .    .univariate cubic dynamics ",
    "relative volume error of the outer approximation to the roa @xmath375 $ ] as a function of the approximating polynomial degree . [ cols=\"^,^,^,^,^\",options=\"header \" , ]",
    "the main contributions of this paper can be summarized as follows :    * contrary to most of the existing systems control literature , we propose a convex formulation for the problem of computing the controlled region of attraction ; * our approach is constructive in the sense that we rely on standard hierarchies of finite - dimensional lmi relaxations whose convergence can be guaranteed theoretically and for which public - domain interfaces and solvers are available ; * we deal with polynomial dynamics and semialgebraic input and state constraints , therefore covering a broad class of nonlinear control systems ; * additional properties ( e.g. , convexity ) of the approximations can be enforced by additional constraints on the approximating polynomial @xmath378 ( e.g. , hessian being negative definite ) . *",
    "the approach is extremely simple to use  the outer approximations are the outcome of a single semidefinite program with _ no additional data _ required besides the problem description .",
    "the problem of computing the ( forward ) reachable set , i.e. the set of all states that can be reached from a given set of initial conditions under input and state constraints , can be addressed with the same techniques  the problem can be formulated as roa computation using a time - reversal argument .",
    "similar ideas can also be used to characterize and compute outer approximations of the maximum controlled invariant set ( both for discrete and continuous time ) ; this is a work in progress .",
    "the hierarchy of lmi relaxations described in this paper generates a sequence of nested outer approximations of the roa , but it is also possible , using a similar approach , to compute valid inner approximations .",
    "results for uncontrolled systems will be reported elsewhere .",
    "the extension to the controlled case is far more involved ( both theoretically and computationally ) and is a subject of future research .",
    "furthermore , there is a straightforward extension to piecewise polynomial dynamics defined over a semialgebraic partition of the state and input spaces ",
    "one measure is then defined for each region of the partition .",
    "our approach should also allow for extensions to stochastic systems ( either discrete - time controlled markov processes or controlled sdes ) and/or uncertain systems .",
    "since it is based on ( an extension of ) lasserre s hierarchy of lmi relaxations ( originally proposed for static polynomial optimization @xcite ) , our approach scales similarly as lasserre s approach .",
    "namely , the number of moments ( variables in the lmi relaxation ) grows as @xmath379 when the problem dimension @xmath380 is kept constant and the relaxation order @xmath377 varies , and grows as @xmath381 when @xmath234 is kept constant and @xmath380 varies .",
    "therefore , at present , the approach is limited to systems of moderate size ( say , @xmath382 ) unless one is willing to compromise the accuracy of the approximations by taking a small relaxation order @xmath234 .",
    "however , given the rapid progress of computing and optimization , the authors expect the approach to scale to larger dimensions in the future .",
    "one possible direction is sparsity exploitation ; indeed , the recently released mosek sdp solver seems to have far superior performance to sedumi on our problem class , most likely due to more sophisticated sparsity exploitation .",
    "another direction is parallelization ; for instance , parallel interior point solvers ( e.g. , sdpara  @xcite ) should allow the approach to scale to larger dimensions .",
    "alternative algorithms to standard primal - dual interior - point methods , such as first - order methods , are also worth considering .",
    "this is currently investigated by the authors .",
    "numerical examples indicate that the choice of monomials as a dense basis for the set of continuous functions on compact sets , while mathematically appropriate ( and notationally convenient ) , is not always satisfactory in terms of convergence and quality of the approximations due to numerical ill - conditioning of this basis .",
    "however , this is not peculiar to roa computation problems  a similar behavior was already observed when computing the volume ( and moments ) of semialgebraic sets in  @xcite . to achieve better performance ,",
    "we recommend the use of alternative polynomial bases such as chebyshev polynomials ; see  ( * ? ? ?",
    "* section  4 ) for more details .",
    "in this appendix we state and prove the correspondence between the liouville pde on measures ( [ eq : liouville ] ) and the convexified differential inclusion ( [ eq : incl2 ] ) .",
    "we will need the notion of a stochastic kernel .",
    "let @xmath383 and @xmath384 be two borel sets ( in two euclidean spaces of not necessarily the same dimension ) .",
    "the object @xmath385 is called a stochastic kernel on @xmath383 given @xmath384 if , first , @xmath386 is a probability measure on @xmath383 for every fixed @xmath387 , and , second , if @xmath388 is a measurable function on @xmath384 for every fixed @xmath389 .",
    "let also @xmath390 denote the @xmath126-marginal of the occupation measure @xmath6 defined through  ( [ eq : ocmeas ] ) , that is , @xmath391,\\ : b\\subset x.\\ ] ]    [ lem : corr ] -1 let @xmath118 be a triplet of measures satisfying the liouville equation  ( [ eq : liouville ] ) such that @xmath392 , @xmath393\\times x \\times u$ ] and @xmath394 .",
    "then there exists a family of absolutely continuous admissible trajectories of  ( [ eq : incl2 ] ) starting from @xmath87 ( i.e. , trajectories in @xmath395 ) such that the occupation measure and the terminal measure generated by this family of trajectories are equal to @xmath396 and @xmath88 , respectively .    since the occupation measure @xmath6",
    "is defined on a euclidean space which is polish and therefore souslin , it can be , in view of ( * ? ? ?",
    "* corollary 10.4.13 ) , disintegrated as @xmath397 where @xmath398 is a stochastic kernel on @xmath44 given @xmath53\\times x$ ] .",
    "then we can rewrite equation  ( [ test ] ) as @xmath399\\times x}\\int_u \\frac{\\partial v}{\\partial t } + \\mathrm{grad}\\,v\\cdot f(t , x , u)\\,d\\nu(u\\!\\mid\\ ! t , x)\\,d\\bar{\\mu}(t , x)\\\\ \\nonumber & = \\int_{[0,t]\\times x }   \\frac{\\partial v}{\\partial t } + \\mathrm{grad}\\,v\\cdot\\big[\\int_u f(t , x , u)\\,d\\nu(u\\!\\mid\\ ! t , x)\\big]\\,d\\bar{\\mu}(t , x)\\\\ & =   \\int_{[0,t]\\times x }   \\frac{\\partial v}{\\partial t } + \\mathrm{grad}\\,v\\cdot\\bar{f}(t , x)\\,d\\bar{\\mu}(t , x),\\end{aligned}\\ ] ] where @xmath400 therefore we will study the trajectories of the differential equation @xmath401 in the remainder of the proof we show that the measures @xmath88 and @xmath396 are generated by a family of absolutely continuous trajectories of this differential equation ( which is clearly a subset of trajectories of the convexified inclusion  ( [ eq : incl2 ] ) ) starting from @xmath87 .",
    "note that the vector field @xmath402 is only known to be measurable follows by first observing that for @xmath403 we have @xmath404 , which is a product of measurable functions , and then by approximating an arbitrary measurable @xmath405 by simple functions ( i.e. , sums of indicator functions ) .",
    "this is a standard measure theoretic argument ; details are omitted for brevity .",
    "] , so this equation may not admit a unique solution .",
    "observe that the @xmath93-marginal of @xmath6 ( and hence of @xmath396 ) is equal to the lebesgue measure restricted to @xmath53 $ ] scaled by @xmath406 ( = @xmath407 ) . indeed , plugging @xmath408 , @xmath409 , in ( [ test ] ) , we obtain @xmath410 ; taking @xmath411 gives @xmath412 and @xmath413 gives @xmath414 , which is nothing but the lebesgue moments on @xmath53 $ ] scaled by @xmath412 . therefore , using  ( * ? ? ?",
    "* theorem  6.4 ) , we can disintegrate @xmath396 as @xmath415 where @xmath416 is a stochastic kernel on @xmath8 given @xmath93 scaled by @xmath417 and @xmath418 is the standard lebesgue measure on @xmath53 $ ] .",
    "the kernel @xmath419 can be thought of as the distribution and @xmath420 this kernel ( or a version thereof ) coincides with @xmath87 and @xmath88 , respectively ; hence there is no ambiguity in notation .",
    "note also that the kernel @xmath419 , @xmath48 $ ] , is defined uniquely up to a subset of @xmath53 $ ] of lebesgue measure zero ; by a `` version '' we then mean a particular choice of the kernel . ] of the state at time @xmath93 .",
    "the kernel @xmath419 is defined uniquely @xmath418-almost everywhere , and we will show that there is a version such that the function @xmath421 is absolutely continuous for all @xmath422 and such that the continuity equation @xmath423 with the initial condition @xmath87 is satisfied almost everywhere w.r.t . the lebesgue measure on @xmath53 $ ] .",
    "fix @xmath422 and define the test function @xmath424 , where @xmath425)$ ] . then from equation  ( [ eq : testapp ] ) @xmath426\\times x}\\hspace{-1em } \\frac{\\partial ( \\psi w)}{\\partial t } + \\mathrm{grad}(\\psi w)\\cdot\\bar{f}(t , x)\\,d\\bar{\\mu}(t , x)\\\\ & =   \\int_0^t\\ ! \\int_x",
    "\\dot{\\psi}(t)w(x ) + \\psi(t)\\mathrm{grad}\\,w(x)\\cdot\\bar{f}(t , x)\\,d\\mu_t(x)dt\\\\ & = \\int_0^t\\big [ \\dot{\\psi}\\int_x w\\,d\\mu_t + \\psi\\int_x \\mathrm{grad}\\,w\\cdot\\bar{f}\\,d\\mu_t\\big ] dt,\\end{aligned}\\ ] ] which can be seen as an equation of the form @xmath427),\\ ] ] where @xmath428 , @xmath429 and @xmath430 are constants and @xmath431 is an unknown function .",
    "one solution is clearly @xmath432 .",
    "now we show that @xmath433 also solves the equation . indeed , since from  ( [ eq :",
    "testapp ] ) with @xmath97 replaced by @xmath211 we have @xmath434 , integration by parts gives @xmath435 so @xmath436 indeed solves equation  ( [ eq : lemmaaux ] ) .",
    "now we prove that this solution is unique .",
    "since @xmath437 is a solution we have @xmath438 and subtracting this from  ( [ eq : lemmaaux ] ) we get @xmath439\\,dt\\quad \\forall\\ : \\psi\\in c^1([0,t]),\\ ] ] or equivalently @xmath440\\,dt\\quad \\forall\\ : \\phi\\in c([0,t]).\\ ] ] since @xmath441)$ ] is dense in @xmath442)$ ] , this implies @xmath443 @xmath418-almost everywhere .",
    "consequently , since @xmath444 is separable , @xmath445 @xmath418-almost everywhere .",
    "the right - hand side of this equality is an absolutely continuous function of time for each @xmath422 and the left - hand side is a bounded positive linear functional on @xmath13 for all @xmath48 $ ] . by continuity of the right - hand - side of  ( [ eq : appaaux ] ) with respect to time , this right - hand side is a bounded positive linear functional on @xmath444 for all @xmath369 $ ] and therefore can be uniquely extended to a bounded positive linear functional on @xmath13 ( since @xmath189 is dense in @xmath190 ) .",
    "therefore , for all @xmath48 $ ] the right - hand side has a representing measure  ( * ? ? ?",
    "* theorem 2.14 ) and hence there is a version of @xmath419 such that the equality  ( [ eq : appaaux ] ) holds for _ all _ @xmath48 $ ] . with this version of @xmath419",
    "the function @xmath446 is absolutely continuous and @xmath419 solves the continuity equation  ( [ eq : cont ] ) .",
    "to finish the proof , we use ( * ? ? ?",
    "* theorem  3.2 ) which asserts the existence of a nonnegative measure @xmath447 on @xmath441;\\mathbb{r}^n)$ ] which corresponds to a family of absolutely continuous solutions to ode  ( [ eq : oderel ] ) whose projection at each time @xmath369 $ ] coincides with @xmath419 .",
    "more precisely , there is a nonnegative measure @xmath448;\\mathbb{r}^n))$ ] supported on a family of absolutely continuous solutions to ode  ( [ eq : oderel ] ) such that for all measurable @xmath449 @xmath450;\\,\\mathbb{r}^n)}\\hspace{-1.5em}w(x(t))\\,d\\sigma(x(\\cdot))\\quad \\forall\\ : t\\in [ 0,t].\\ ] ] using @xmath451 , it follows from  ( [ eq : mudisint ] ) that @xmath452\\times x}i_a(t)i_b(x)\\,d\\bar{\\mu}(t , x)=\\int_0^t i_a(t)\\int_x i_b(x ) \\,d\\mu_t(x)\\ , dt.\\ ] ] therefore , using ( [ eq : contmeas ] ) with @xmath453 and fubini s theorem  ( * ? ? ? * theorem 8.8 ) , we get @xmath454;\\,\\mathbb{r}^n)}\\int_0^t i_{a\\times b}(t , x(t))\\,dt\\ , d\\sigma(x(\\cdot)),\\ ] ] and so the occupation measure of the family of trajectories coincides with @xmath396 . clearly , the initial and the final measures of this family coincide with @xmath87 and @xmath88 as well . as a result @xmath447-almost",
    "all trajectories of this family are admissible . the proof is completed by discarding the null - set of trajectories that are not admissible , which does not change the measure @xmath447 and the generated measures @xmath396 , @xmath87 , @xmath88 .",
    "in this appendix we elaborate further on the discussion from section  [ sec : relaxed ] on the connection between the classical roa and the relaxed roa .",
    "let us recall the definition of the classical roa @xmath455 where @xmath456\\big\\}\\end{aligned}\\ ] ] and @xmath52 is required to be absolutely continuous .",
    "similarly , recall the definition of the relaxed  roa @xmath457 where @xmath458\\big\\}\\end{aligned}\\ ] ] with @xmath52 absolutely continuous . obviously , it holds @xmath459 and the question is whether this inclusion is strict or not",
    ".    denote @xmath460 and define the dilated constraint sets @xmath461 where @xmath462 denotes the minkowski sum of two sets .",
    "accordingly , the dilated roa and the dilated relaxed roa are @xmath463 where @xmath464\\big\\},\\\\ \\bar{\\mathcal x}^\\epsilon(x_0 )   & : =   \\big\\{x(\\cdot)\\::\\:\\dot{x}(t)\\in \\mathrm{conv}\\:f(t , x(t),u)\\:\\text{a.e.},\\ : x(0)=x_0 , x(t)\\in x_t^\\epsilon,\\ : x(t)\\in x^\\epsilon\\ : \\forall t\\in [ 0,t]\\big\\}.\\end{aligned}\\ ] ]    since the constraint sets are compact and the vector field @xmath35 lipschitz , it follows from the equivalence between the trajectories of the convexified inclusion  ( [ eq : incl2 ] ) and solutions to the liouville equation  ( [ eq : liouville ] ) , stated in lemma  [ lem : corr ] of appendix  a , and from filippov - wa@xmath106ewski s relaxation theorem ( see , e.g. ,",
    "@xcite ) that @xmath465 in contrast , for all @xmath466 it holds @xmath467    in general inclusion ( [ inclusion ] ) is strict .",
    "however , we argue that for most practical purposes the relaxed roa @xmath107 and the true roa @xmath55 are the same .",
    "indeed , for any @xmath468 there exists a sequence of admissible control functions @xmath469 such that @xmath470 } \\mathrm{dist}_{x}(x_k(t ) ) \\to 0\\quad \\mathrm{and}\\quad \\mathrm{dist}_{x_t}(x_k(t ) ) \\to 0\\ ] ] as @xmath215 , where @xmath471 denotes the solution to the ode  ( [ sys ] ) corresponding to the control function @xmath469 , and @xmath472 denotes the distance to a set @xmath3 .",
    "in this appendix we describe two contrived examples of control systems ( [ sys ] ) for which the relaxed roa @xmath107 is strictly larger than the classical roa @xmath55 ; see appendix  b for definitions .",
    "let @xmath473 , @xmath474 , @xmath475 for , e.g. , @xmath476 . obviously there is no admissible trajectory in @xmath477 , whereas there is a feasible triplet of measures satisfying  ( [ eq : liouville ] ) given by @xmath478 , @xmath479 and @xmath480 } \\otimes\\delta_0\\otimes \\frac{1}{2}(\\delta_{-1}+ \\delta_{+1})$ ] , where @xmath481}$ ] denotes the restriction of the lebesgue measure to @xmath370 $ ] . therefore in this case @xmath482 ,",
    "but @xmath108 .",
    "assumption  [ relaxed ] is therefore satisfied .",
    "note that the relaxed solution corresponds to an infinitely fast chattering of the control input between @xmath483 and @xmath484 which can be arbitrarily closely approximated by chattering solutions of finite speed ; the singleton constraint set @xmath8 , however , renders such solutions infeasible .",
    "another example for which the gap ( e.g. , in volume ) between @xmath107 and @xmath55 can be as large as desired is the following .",
    "consider @xmath485 with @xmath486\\times\\{0\\ } ) \\cup b_1(c_2 ) \\subset { \\mathbb r}^2\\ ] ] with the centers @xmath487 and @xmath488 and a given radius @xmath489 .",
    "the input and terminal constraints are @xmath490 and @xmath491 .",
    "that is , the constraint set consist of two balls ( one of radius @xmath492 and the other of radius  @xmath21 ) connected by a line ; the target set is the ball of radius  1 .",
    "then @xmath493 is strictly smaller than @xmath494 , and @xmath495 , whereas @xmath496 .",
    "assumption  [ relaxed ] is therefore not satisfied for @xmath489 . in this example",
    ", regular solutions starting in the left ball can not transverse the line to the right ball ; this is , by contrast , possible for the relaxed solutions using an infinitely fast chattering .",
    "in this appendix we prove theorem  [ lem : nogaprelax ] . in order to prove the theorem we rewrite primal lmi problem ( [ plmi ] ) in a vectorized form as follows @xmath497 where @xmath498'$ ] and @xmath499 is a direct product of cones of positive semidefinite matrices of appropriate dimensions , here corresponding to the moment matrix and localizing matrix constraints .",
    "the notation @xmath500 means that vector @xmath501 contains entries of positive semidefinite moment and localizing matrices , and by construction matrix @xmath502 has full column rank ( since a moment matrix is zero if and only if the corresponding moment vector is zero )",
    ". dual lmi problem ( [ dlmi ] ) then becomes @xmath503 and we want to prove that @xmath504 .",
    "the following instrumental result is a minor extension of a classical lemma of the alternatives for primal lmi ( [ primal ] ) and dual lmi ( [ dual ] ) .",
    "the notation @xmath505 stands for the interior of @xmath499 .",
    "[ lem : alternative ] if matrix @xmath502 has full column rank , exactly one of these statements is true :    * there exists @xmath506 and @xmath507 such that @xmath508 * there exists @xmath509 such that @xmath510 , @xmath511 and @xmath512 .",
    "_ proof of lemma [ lem : alternative ] : _ a classical lemma of alternatives states that if matrix @xmath513 has full column rank , then either there exists @xmath507 such that @xmath514 or there exists @xmath515 such that @xmath516 and @xmath517 , but not both , see e.g. ( * ? ? ?",
    "* lemma 2 ) for a standard proof based on the geometric form of the hahn - banach separation theorem .",
    "our proof then follows from restricting this lemma of alternatives to the null - space of matrix @xmath518 .",
    "more explicitly , there exists @xmath506 and @xmath519 such that @xmath508 if and only if @xmath519 is such that @xmath520 with @xmath521 , @xmath522 for @xmath523 a full - rank matrix such that @xmath524 .",
    "matrix @xmath513 has full column rank since it is the restriction of the full column rank matrix @xmath502 to the null - space of @xmath518 .",
    "@xmath525    _ proof of theorem [ lem : nogaprelax ] : _ first notice that the feasibility set of lmi problem ( [ primal ] ) is nonempty and bounded .",
    "indeed , a triplet of zero measures is a trivial feasible point for  ( [ rlp ] ) and hence @xmath526 is feasible in  ( [ rrlp ] ) ; consequently a concatenation of truncated moment sequences corresponding to the quadruplet of measures @xmath526 is feasible in  ( [ primal ] ) for each relaxation order @xmath234 .",
    "boundedness of the even components of each moment vector follows from the structure of the localizing matrices corresponding to the functions from assumption  [ compact ] and from the fact that the masses ( zero - th moments ) of the measures are bounded because of the constraint @xmath144 and because @xmath363 .",
    "boundedness of the whole moment vectors then follows since the even moments appear on the diagonal of the positive semidefinite moment matrices .    to complete the proof ,",
    "we follow ( * ? ? ?",
    "* theorem 4 ) and show that boundedness of the feasibility set of lmi problem ( [ primal ] ) implies existence of an interior point for lmi problem ( [ dual ] ) , and then from standard sdp duality it follows readily that @xmath163 since @xmath527 has a full column rank ; see , e.g. , ( * ? ? ? * theorem 5 ) and references therein .",
    "let @xmath515 denote a point in the feasibility set of lmi problem ( [ primal ] ) , i.e. a vector satisfying @xmath528 and @xmath529 .",
    "suppose that there is no interior point for lmi problem ( [ dual ] ) , i.e. there is no @xmath506 and @xmath530 such that @xmath531 .",
    "then from lemma [ lem : alternative ] there exists @xmath509 such that @xmath510 , @xmath511 and @xmath512 .",
    "it follows that there exists a ray @xmath532 , @xmath533 of feasible points for lmi problem ( [ primal ] ) , hence implying that the feasibility set is not bounded .",
    "the authors would like to thank mathieu claeys and jean - bernard lasserre for helpful discussions , masakazu kojima for valuable insights into computational aspects and the anonymous referees for useful comments .",
    "l. ambrosio .",
    "transport equation and cauchy problem for non - smooth vector fields . in l. ambrosio",
    "( eds . ) , calculus of variations and nonlinear partial differential equations .",
    "lecture notes in mathematics , vol .",
    "1927 , springer - verlag , berlin , 2008 .",
    "m. dellnitz , g. froyland , o. junge .",
    "the algorithms behind gaio  set oriented numerical methods for dynamical systems . in b. fiedler ( ed . ) , ergodic theory , analysis , and efficient simulation of dynamical systems , springer - verlag , berlin , 2001 .",
    "e. g. gilbert and k. t. tan .",
    "linear systems with state and control constraints : the theory and application of maximal output admissible sets .",
    "ieee transactions on automatic control , 36 : 1008 - 1020 , 1991 .",
    "d. henrion , j. b. lasserre , and j. lfberg .",
    "gloptipoly 3 : moments , optimization and semidefinite programming .",
    "optimization methods and software , 24:761779 , 2009 .",
    "http://homepages.laas.fr / henrion / software / gloptipoly/."
  ],
  "abstract_text": [
    "<S> we address the long - standing problem of computing the region of attraction ( roa ) of a target set ( e.g. , a neighborhood of an equilibrium point ) of a controlled nonlinear system with polynomial dynamics and semialgebraic state and input constraints . </S>",
    "<S> we show that the roa can be computed by solving an infinite - dimensional convex linear programming ( lp ) problem over the space of measures . in turn </S>",
    "<S> , this problem can be solved approximately via a classical converging hierarchy of convex finite - dimensional linear matrix inequalities ( lmis ) . </S>",
    "<S> our approach is genuinely primal in the sense that convexity of the problem of computing the roa is an outcome of optimizing directly over system trajectories . </S>",
    "<S> the dual infinite - dimensional lp on nonnegative continuous functions ( approximated by polynomial sum - of - squares ) allows us to generate a hierarchy of semialgebraic outer approximations of the roa at the price of solving a sequence of lmi problems with asymptotically vanishing conservatism . </S>",
    "<S> this sharply contrasts with the existing literature which follows an exclusively dual lyapunov approach yielding either nonconvex bilinear matrix inequalities or conservative lmi conditions . </S>",
    "<S> the approach is simple and readily applicable as the outer approximations are the outcome of a single semidefinite program with no additional data required besides the problem description .    </S>",
    "<S> region of attraction , polynomial control systems , occupation measures , linear matrix inequalities ( lmis ) , convex optimization , viability theory , reachable set , capture basin . </S>"
  ]
}