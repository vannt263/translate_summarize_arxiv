{
  "article_text": [
    "the idea for this paper came from a talk of michelle kendall at the portobello conference 2015 , see @xcite .",
    "basically , she postulated , that the biological information is essentially encoded in the collection of distances between the mrca of two taxa and the root .",
    "if the trees were ultrametric , we could equivalently just collect the distances between all pairs of taxa .",
    "that leads to our rationale :    instead of trees we compare the induced metric spaces .",
    "this approach is feasible since by the work of buneman @xcite , see also @xcite for the unweighted case , we can identify tree - induced metrics among all metrics by the famous four point conditions .",
    "in fact , this rationale must have been behind the invention of the @xmath1 and @xmath2 path difference distances @xcite already .",
    "below we invent also an @xmath3 version of that metrics , too .    for ( compact ) metric spaces",
    "there is the well - known gromov - hausdorff distance @xmath4 where the infimum is taken over all isometric embeddings of @xmath5 into a common metric space , and @xmath6 is the hausdorff metric on the compacts of that space .    by our rationale",
    ", this definition induces a metric on the space of all weighted trees .",
    "but , we can not distinguish trees which yield isomorphic metric spaces , i.e. with permuted labels . since our aim is to compare trees with the same taxon sets we have to adapt the metric ( [ eq : gromov ] ) to our situation .",
    "that makes the definition more complicated ( see section 2 ) since we have to match the leaf labels , but the idea of embeddings remains .",
    "fortunately , our metric becomes efficiently computable only this way .",
    "simply , we must substitute the hausdorff metric in ( [ eq : gromov ] ) .",
    "since there are several reasonable candidates for that , we derive even three different metrics . in all these cases ,",
    "the value of the metric is the solution of a linear or quadratic program .",
    "clearly , our approach is more general and abstract than other definitions of phylogenetic metrics to be discussed soon .",
    "those are using much more the internal structure of trees .",
    "usually , more abstract approaches have more potential to generalise and to adapt to special situations .",
    "still , this has to be worked out in the present situation .    for mathematical reasons ,",
    "it is very convenient to include also semimetrics on the taxon set in the definition .",
    "this situation may occur in phylogeny if we do not resolve the topology by all singleton splits , see for instance @xcite .",
    "what about other phylogenetic metrics ? the simplest one ,",
    "though not the oldest one , seems to be the robinson - foulds distance @xcite . that one is easy and efficiently to compute in linear time @xcite or even in sublinear approximation @xcite .",
    "but , it has no much power in discriminating trees , since a lot of trees with similar biological meaning have distance equal to the diameter of the unweighted tree space .",
    "much nearer to biology seems to be a variant of the robinson - foulds distance , the weighted matching distance .",
    "it captures similarity of splits which entails a lot of biology and is still computable in subcubic time @xcite .",
    "a quite natural , biology adapted way of capturing tree similarity is provided by the tree rearrangement metrics .",
    "there are different basic transformations giving rise to the nni - distance @xcite , spr - distance and tbr - distance .",
    "unfortunately , computation of those distances is np - hard and only feasible for small trees @xcite .",
    "some fixed parameter approach to compute the ( rooted ) spr , e.g , was done in @xcite .",
    "even more at the heart of evolution is the maximum parsimony distance @xcite .",
    "still it is np - hard to compute that distance , even over binary unweigthed phylogenetic trees @xcite .    a good alternative to the tree",
    "rearrangement metrics is the quartet distance @xcite .",
    "it is much more biologically plausible than the robinson - foulds distance and also efficiently computable @xcite .    for weighted phylogenetic trees",
    "there is the euclidean type ( geodesic ) distance on tree space introduced by @xcite .",
    "the crucial observation was that in a natural way tree space is a category zero ( @xmath7 ) space ( or space of nonpositive curvature ) introduced by gromov .",
    "essentially this property implies uniqueness of geodesics .",
    "it was an open problem for some years how to compute the geodesic distance on tree space efficiently .",
    "yet , by @xcite we have a polynomial time algorithm now .",
    "the @xmath7 idea was used again in @xcite to develop metrics for ultrametric spaces . again",
    ", efficient computation of the geodesics is possible for at least one of the metrics . as observed in that work , different , but natural , parametrisations may yield different geodesics .",
    "recently , @xcite returned back to the idea of @xcite , @xcite and @xcite in application to weighted rooted trees , considering all distances of mrcas of pairs of taxa to the root",
    ". she also proposes to weight different mrcas by their depth respective the root .",
    "that idea may be similar to the weighted matching distance @xcite .",
    "a good review about recent developments in polynomial time computable metrics on unweighted phylogenetic trees is contained in @xcite .",
    "there also complete ` java ` implementations are provided . for simplicity",
    ", we implemented our metrics in ` r ` first .    after having this short overview over this situation",
    ", we would like to introduce the notion of a _",
    "biocomputable _ metric .",
    "that should be a metric on phylogenetic tree space which is computable in polynomial time and which is able to capture biological similarity .",
    "preferably , it should be also defined for weighted phylogenetic trees .",
    "so , let s see how gromovs idea of joint embeddings helps to reach that goal ",
    "for a set @xmath0 denote by @xmath8 the set of all semimetrics on @xmath0 , i.e. all @xmath9 such that for all @xmath10 @xmath11 , @xmath12 and @xmath13 .",
    "frequently , we describe such a semimetrics in an equivalent fashion by @xmath14 where @xmath15 .",
    "accordingly , @xmath16 denote the set of all metrics on @xmath0 .",
    "further , let @xmath17 denote the set of all finite semimetric spaces . isometries @xmath18 preserve the semimetrics , i.e. for all @xmath19 @xmath20 .",
    "frequently we need identical copies of our taxon set @xmath0 . under slight abuse of notation , we will denote them @xmath21 and @xmath22 .",
    "let @xmath0 be a finite set .",
    "then we define three functions @xmath23 on @xmath24 by    @xmath25    where the infimum is taken over all @xmath26 and all isometries @xmath27 , @xmath28 .",
    "@xmath29 is nearest to the gromov - hausdorff distance , which we should implement via @xmath30 on the other hand , we think that the @xmath1-like metric @xmath31 is kind of natural for trees . the euclidean geometry which is the basis of @xmath32 might be good for having unique geodesics .",
    "this feature is very convenient and at the heart of the proposals of @xcite and @xcite .",
    "let us simplify the optimisation problems present in the definitions of @xmath33 a bit .",
    "in fact , it is enough to have just one model space @xmath34 . for @xmath35",
    "define the space @xmath36 of their extensions @xmath37 further , @xmath38 denotes the usual @xmath39norm on @xmath40 .",
    "[ lem : dibyextensionxx ] for @xmath41 @xmath42    note that @xmath43 holds trivially .    on the other side , for @xmath44 and isometries @xmath45",
    ", @xmath46 define @xmath47 by @xmath48 for all @xmath19 .",
    "now @xmath49 implies @xmath50 .",
    "the @xmath51 in ( [ eq : dibyextensionxx ] ) follows now from @xmath52    observe that the previous lemma is at the heart of the computation of the distances since that amounts just to the minimization of a convex function over the convex set @xmath36 .",
    "[ lem : di * ] for @xmath41 there exists a @xmath53 such that @xmath54    clearly , the sublevel sets of the convex function @xmath38 are compact on the convex space @xmath36 . thus there must exist a minimal point of that function .",
    "[ th : metrics ] @xmath33 , @xmath41 are complete metrics on @xmath8 .",
    "symmetry is clear .    if @xmath55 choose @xmath56 according to the previous lemma . obviously , we obtain @xmath57 for all @xmath58 .",
    "the triangle inequality implies for all @xmath19 @xmath59 such that @xmath60 .",
    "now let there be @xmath61 and @xmath62 arbitrary .",
    "using again the above lemma we choose @xmath63 extending @xmath64 and @xmath65 extending @xmath66 such that @xmath67 then we find , following @xcite or lemma [ lem : biextension ] , some @xmath68 extending both @xmath69 : @xmath70 we see now @xmath71    completeness will be proved later in lemma [ lem : complete ] .    as already said in the introduction , we are mainly interested in metrics on tree space .",
    "let @xmath72 be a weighted connected graph , i.e. @xmath73 and @xmath74 .",
    "the we define the induced semimetric on @xmath75 by @xmath76 as usual , @xmath77 is here the length of the path @xmath78 . for unweighted graphs",
    "@xmath79 we choose @xmath80 for all @xmath81 .",
    "so let the tree space @xmath82 be the set of all weighted unrooted generalised phylogenetic @xmath0-trees .",
    "a weighted unrooted generalised phylogenetic @xmath0-tree is a quadruple @xmath83 , where @xmath84 is a ( not necessarily injective ) map such that @xmath79 is the minimal tree containing @xmath85 and @xmath86 is a weight function .",
    "phylogenetic @xmath0-trees without weights are included by given all edges after contraction a weight of 1 and by requiring @xmath87 to be injective .",
    "the corresponding subspace will be denoted @xmath88 .",
    "the set of binary ( bifurcating ) phylogenetic @xmath0-trees is denoted @xmath89 .",
    "now we define for @xmath90 under abuse of notation @xmath91 where @xmath92 is induced by the tree @xmath93 and @xmath94 by @xmath95 via ( [ eq : dqg ] ) .",
    "again , all three are metrics on tree space .",
    "this can be seen from the following result , provided in essence by @xcite .",
    "[ lem:4point ] for @xmath96 there exists an unrooted generalised phylogenetic @xmath97tree @xmath98 with @xmath99 if and only if for for all @xmath100 the four point condition @xmath101 is fulfilled .    identifying points @xmath19 with @xmath102 we can assume that @xmath103 is a metric .",
    "that ( [ eq:4point ] ) is necessary and sufficient now for the existence of @xmath104 was shown in @xcite .",
    "the splits of @xmath104 are identified by situations where in ( [ eq:4point ] ) strict inequality holds .",
    "minimality of the vertex set of @xmath104 ( according to definition ) implies that different edges in @xmath104 induce different splits .",
    "the weight of the edge corresponding to a split by ( [ eq:4point ] ) computes directly from the difference of the right and the left hand side in ( [ eq:4point ] ) .",
    "thus @xmath98 is uniquely determined .",
    "let us compute some example .",
    "[ ex:1 ] we want to compare for @xmath105 the two unweigthed @xmath97trees @xmath106 \\node ( a ) at ( 0,4 ) [ rectangle , rounded corners , draw = black ] { $ a$ } ; \\node ( b ) at ( 0,0 ) [ rectangle , rounded corners , draw = black ] { $ b$ } ; \\node ( c ) at ( 2,2 )   { $ \\bullet$ } ; \\node ( d ) at ( 4,2 )   { $ \\bullet$ } ; \\node ( e ) at ( 6,0 ) [ rectangle , rounded corners , draw = black ] { $ c$ } ; \\node ( f ) at ( 6,4 ) [ rectangle , rounded corners , draw = black ] { $ d$ } ; \\draw[very thick ] ( a ) to ( c ) ; \\draw[very thick ] ( b ) to ( c ) ; \\draw[very thick ] ( c ) to ( d ) ; \\draw[very thick ] ( d ) to ( e ) ; \\draw[very thick ] ( d ) to ( f ) ; \\end{tikzpicture } \\qquad \\mbox{and}\\qquad \\tau'=\\begin{tikzpicture}[xscale=0.5,yscale=0.2 , baseline = 10 ] \\node ( a ) at ( 0,4 ) [ rectangle , rounded corners , draw = black ] { $ a$ } ; \\node ( b ) at ( 0,0 ) [ rectangle , rounded corners , draw = black ] { $ c$ } ; \\node ( c ) at ( 2,2 )   { $ \\bullet$ } ; \\node ( d ) at ( 4,2 )   { $ \\bullet$ } ; \\node ( e ) at ( 6,0 ) [ rectangle , rounded corners , draw = black ] { $ b$ } ; \\node ( f ) at ( 6,4 ) [ rectangle , rounded corners , draw = black ] { $ d$ } ; \\draw[very thick ] ( a ) to ( c ) ; \\draw[very thick ] ( b ) to ( c ) ; \\draw[very thick ] ( c ) to ( d ) ; \\draw[very thick ] ( d ) to ( e ) ; \\draw[very thick ] ( d ) to ( f ) ; \\end{tikzpicture}\\ ] ] with corresponding distances @xmath64 .",
    "we want to derive possible extensions of @xmath64 by verifying that for some @xmath107 the graph distances on the weighted graph @xmath108 \\node ( a ) at ( 3,6 ) [ rectangle , rounded corners , draw = black ] { $ a$ } ; \\node ( b ) at ( 3,4 ) [ rectangle , rounded corners , draw = black ] { $ b$ } ; \\node ( e ) at ( 0,5 )   { $ \\bullet$ } ; \\node ( f ) at ( 0,1 )   { $ \\bullet$ } ; \\node ( c ) at ( 3,2 ) [ rectangle , rounded corners , draw = black ] { $ c$ } ; \\node ( d ) at ( 3,0 ) [ rectangle , rounded corners , draw = black ] { $ d$ } ; \\draw[very thick ] ( e ) to ( a ) ; \\draw[very thick ] ( e ) to ( b ) ; \\draw[very thick ] ( f ) to ( c ) ; \\draw[very thick ] ( f ) to ( d ) ; \\draw[very thick ] ( e ) to ( f ) ; \\node ( as ) at ( 8,6 ) [ rectangle , rounded corners , draw = black ] { $ a'$ } ; \\node ( cs ) at ( 8,4 ) [ rectangle , rounded corners , draw = black ] { $ c'$ } ; \\node ( es ) at ( 11,5 )   { $ \\bullet$ } ; \\node ( fs ) at ( 11,1 )   { $ \\bullet$ } ; \\node ( bs ) at ( 8,2 ) [ rectangle , rounded corners , draw = black ] { $ b'$ } ; \\node ( ds ) at ( 8,0 ) [ rectangle , rounded corners , draw = black ] { $ d'$ } ; \\draw[very thick ] ( es ) to ( as ) ; \\draw[very thick ] ( es ) to ( cs ) ; \\draw[very thick ] ( fs ) to ( bs ) ; \\draw[very thick ] ( fs ) to ( ds ) ; \\draw[very thick ] ( es ) to ( fs ) ; \\draw[dotted , thick ] ( a ) to ( as ) ; \\draw[dotted , thick ] ( b ) to ( bs ) ; \\draw[dotted , thick ] ( c ) to ( cs ) ; \\draw[dotted , thick ] ( d ) to ( ds ) ; \\node [ above ] at ( 5.5,6 ) { $ \\delta_a$ } ; \\node [ above ] at ( 6.5,3.5 ) { $ \\delta_c$ } ; \\node [ above ] at ( 4.5,3.5 ) { $ \\delta_b$ } ; \\node [ above ] at ( 5.5,0 ) { $ \\delta_d$ } ; \\end{tikzpicture}\\ ] ] reproduce both @xmath103 and @xmath94 . one obvious choice is @xmath109 , i.e. @xmath108 \\node ( b ) at ( 3,4 ) [ rectangle , rounded corners , draw = black ] { $ b$ } ; \\node ( e ) at ( 0,5 )   { $ \\bullet$ } ; \\node ( f ) at ( 0,1 )   { $ \\bullet$ } ; \\node ( c ) at ( 3,2 ) [ rectangle , rounded corners , draw = black ] { $ c$ } ; \\node ( aas ) at ( 5.5,6 ) [ rectangle , rounded corners , draw = black ] { $ a = a'$ } ; \\node ( cs ) at ( 8,4 ) [ rectangle , rounded corners , draw = black ] { $ c'$ } ; \\node ( es ) at ( 11,5 )   { $ \\bullet$ } ; \\node ( fs ) at ( 11,1 )   { $ \\bullet$ } ; \\node ( bs ) at ( 8,2 ) [ rectangle , rounded corners , draw = black ] { $ b'$ } ; \\node ( dds ) at ( 5.5,0 ) [ rectangle , rounded corners , draw = black ] { $ d = d'$ } ; \\draw[very thick ] ( e ) to ( aas ) ; \\draw[very thick ] ( e ) to ( b ) ; \\draw[very thick ] ( f ) to ( c ) ; \\draw[very thick ] ( f ) to ( dds ) ; \\draw[very thick ] ( e ) to ( f ) ; \\draw[very thick ] ( es ) to ( aas ) ; \\draw[very thick ] ( es ) to ( cs ) ; \\draw[very thick ] ( fs ) to ( bs ) ; \\draw[very thick ] ( fs ) to ( dds ) ; \\draw[very thick ] ( es ) to ( fs ) ; \\draw[dotted , thick ] ( b ) to ( bs ) ; \\draw[dotted , thick ] ( c ) to ( cs ) ; \\node [ above ] at ( 6.5,3.5 ) { $ 1 $ } ; \\node [ above ] at ( 4.5,3.5 ) { $ 1 $ } ; \\end{tikzpicture}\\ ] ] is consistent . obviously , we embedded now both @xmath104 and @xmath110 into the metric space of the graph @xmath111 .",
    "we see @xmath112 , @xmath113 and @xmath114 .",
    "in fact equality holds , but this we can prove only later in example [ ex:2 ] .",
    "additionally , we obtain    [ lem : algebra ] for @xmath115 , @xmath41 , and @xmath116 , @xmath117 , the following are true :",
    "1 .   @xmath118 .",
    "2 .   @xmath119 .",
    "3 .   @xmath120 .",
    "the first relation follows from @xmath121 .",
    "the second relation follows from @xmath122 for all @xmath123 and @xmath124 .",
    "the third relation is just a consequence of the first two .",
    "clearly ,    @xmath31 and @xmath29 can be computed solving a linear program . for the computation of @xmath32 a quadratic program",
    "has to be solved .",
    "this follows immediately from lemma [ lem : dibyextensionxx ] .",
    "so , we are sure that we can compute the distance in a computing time polynomially bounded in @xmath125 @xcite . in the nave way",
    ", the linear ( quadratic ) program has the @xmath126 variables @xmath127 and @xmath128 restrictions coming essentially from the triangle inequalities in triangles of the form @xmath129 or similar .",
    "but we can do the computation more efficiently .",
    "the essential observation is that the objective function depends on the unknown values @xmath130 only .",
    "the reformulation of the constraints is provided by the following theorem .",
    "it will be proved later in section [ sec : metrext ] .",
    "[ th : quadrin ] let @xmath35 and @xmath131 be given .",
    "then there exists a @xmath50 with @xmath132 if and only if for all @xmath133 the following inequalities are fulfilled : @xmath134{rcl }      \\delta_x+\\delta_y&\\ge&{\\left\\lvert\\rho(x , y)-\\rho'(x , y)\\right\\rvert}\\\\      { \\left\\lvert\\delta_x-\\delta_y\\right\\rvert}&\\le&\\rho(x , y)+\\rho'(x , y )    \\end{array}\\label{eq : quadr}\\ ] ]    thus we have just @xmath135 variables @xmath136 and @xmath137 constraints for each rectangle @xmath138 in the optimisation problems ( [ eq : dibyextensionxx ] ) .",
    "formally , @xmath139 solves the program @xmath140{*4c }      { \\left\\lvert\\delta\\right\\rvert}_i&\\to&\\min\\qquad\\mbox{under}\\\\[1ex ] \\delta_x&\\ge&0&x\\in x\\\\      \\delta_x+\\delta_y&\\ge&{\\left\\lvert\\rho(x , y)-\\rho'(x ,",
    "y)\\right\\rvert}&x\\ne y\\in x\\\\      { \\left\\lvert\\delta_x-\\delta_y\\right\\rvert}&\\le&\\rho(x , y)+\\rho'(x , y)&x\\ne y\\in x\\\\    \\end{array}\\ ] ]    [ ex:2 ] let us continue example [ ex:1 ] .",
    "since @xmath141 , we see from the upper parts of ( [ eq : quadr ] ) @xmath142 consequently , @xmath143 we already saw that we can realise this minimum .",
    "the calculation of @xmath144 was already done , @xmath145 is immediate .",
    "it is very interesting that the upper bounds on the differences are not used in the calculation .",
    "in fact , we could not observe any situation where they had to be used to determine the minimum .",
    "this can be seen also from the numerical results in section [ sec : numeric ] , especially figure [ fig : gleich ] .",
    "but , we are still lacking a proof that we may omit these constraints safely .",
    "this leads us to the definition of further distances @xmath146 as solution of @xmath147{*4c }      { \\left\\lvert\\delta\\right\\rvert}_i&\\to&\\min\\qquad\\qquad\\mbox{\\textrm{under}}\\\\ \\delta_x&\\ge&0&x\\in x\\\\      \\delta_x+\\delta_y&\\ge&{\\left\\lvert\\rho(x , y)-\\rho'(x , y)\\right\\rvert}&x\\ne y\\in x    \\end{array}\\ ] ] with the obvious extension to tree space .",
    "[ lem : tildemetrics ] @xmath148 are metrics on @xmath8 and @xmath82 , too .",
    "observe that exacly like for the problem ( [ eq : min1 ] ) , also the minimum of ( [ eq : min2 ] ) is attained .",
    "symmetry of the definition is clear .",
    "further , @xmath149 if and only if @xmath150 is feasible for the problem ( [ eq : min1 ] ) .",
    "that means @xmath151 for all @xmath152 and @xmath60 .    for the proof of the triangle inequality choose optimal solutions @xmath153 of ( [ eq : min2 ] ) and @xmath154 of the version of ( [ eq : min2 ] ) for @xmath66 .",
    "we see for @xmath155 that @xmath156 such @xmath157 is feasible for the version of ( [ eq : min2 ] ) for @xmath158 .",
    "we obtain @xmath159 this completes the proof .",
    "interestingly , there is a striking similarity between the feasible set of ( [ eq : min2 ] ) and the tight span of a distance matrix introduced in @xcite .",
    "yet , @xmath160 is not a semimetric in general and we do not see a deeper connection at the moment .",
    "first we compare our metrics to the pathwise difference metrics . recall that those are defined by @xcite @xmath161    interestingly",
    ", it seems that @xmath162 was not used before .",
    "may be , we can immediately explain this .",
    "again we abbreviate @xmath125 .",
    "[ th : pdcomp ] for @xmath163 it holds @xmath134{*9c }   d_1(\\tau_1,\\tau_2 )   & \\ge&d_2(\\tau_1,\\tau_2)&\\ge & d_\\infty(\\tau_1,\\tau_2)&\\ge&\\frac1{\\sqrt",
    "n } d_2(\\tau_1,\\tau_2)&\\ge&\\frac1{n } d_1(\\tau_1,\\tau_2)\\\\   \\tilde d_1(\\tau_1,\\tau_2 )   & \\ge&\\tilde d_2(\\tau_1,\\tau_2)&\\ge & \\tilde d_\\infty(\\tau_1,\\tau_2)&\\ge&\\frac1{\\sqrt n}\\tilde   d_2(\\tau_1,\\tau_2)&\\ge&\\frac1{n } \\tilde d_1(\\tau_1,\\tau_2)\\\\     \\end{array}\\ ] ]    @xmath134{*7c }    \\frac n2 d^{pd}_1(\\tau_1,\\tau_2 )   & \\ge&d_1(\\tau_1,\\tau_2)&\\ge&\\tilde d_1(\\tau_1,\\tau_2)&\\ge&\\frac1{n-1 } d^{pd}_1(\\tau_1,\\tau_2)\\\\",
    "\\frac{\\sqrt n}2 d^{pd}_2(\\tau_1,\\tau_2 )   & \\ge&d_2(\\tau_1,\\tau_2)&\\ge&\\tilde d_2(\\tau_1,\\tau_2)&\\ge&\\sqrt{\\frac2{n-1 } } d^{pd}_2(\\tau_1,\\tau_2)\\\\ & & d_\\infty ( \\tau_1,\\tau_2)&=&\\tilde d_\\infty(\\tau_1,\\tau_2)&=&\\frac12 d^{pd}_\\infty(\\tau_1,\\tau_2 )    \\end{array}\\ ] ]    the first relations are well - known for @xmath38 and translate directly .    for the second relation we use the first inequality in ( [ eq : quadr ] ) .",
    "this gives us for all @xmath133 @xmath164 summing up the first or the second inequalities for all @xmath152 gives the estimates for @xmath165 .",
    "the @xmath51-estimate for @xmath166 follows by taking the maximum of the third inequality over all @xmath152 . on the other hand , setting @xmath167 @xmath168 , ( [ eq : quadr ] ) is clearly fulfilled and we obtain also the @xmath43-estimate .",
    "the first estimates yield the rest of the second estimates and complete the proof .    by the same arguments as in lemma [ lem : di * ] , both ( [ eq : min1 ] ) and ( [ eq : min2 ] ) possess minimal points @xmath169 . as a corollary of the last theorem we find a useful upper bound for the elements of these vectors :    [ lem : upperbound ] in the minimisation problems ( [ eq : min1 ] ) or ( [ eq : min2 ] ) , we may restrict minimisation to @xmath170 which fulfil additionally @xmath171 e.g. , the minimisation problems @xmath172{*4c }      { \\left\\lvert\\delta\\right\\rvert}_i&\\to&\\min\\qquad\\mbox{\\textrm{under}}\\\\[1ex ] 0\\le \\delta_x&\\le&2d_\\infty(\\rho,\\rho')&x\\in x\\\\      \\delta_x+\\delta_y&\\ge&{\\left\\lvert\\rho(x , y)-\\rho'(x , y)\\right\\rvert}&x\\ne y\\in x\\\\      { \\left\\lvert\\delta_x-\\delta_y\\right\\rvert}&\\le&\\rho(x , y)+\\rho'(x , y)&x\\ne y\\in x\\\\    \\end{array}\\ ] ] and @xmath173{*4c }      { \\left\\lvert\\delta\\right\\rvert}_i&\\to&\\min\\qquad\\mbox{\\textrm{under}}\\\\[1ex ] 0\\le \\delta_x&\\le&2d_\\infty(\\rho,\\rho')&x\\in x\\\\      \\delta_x+\\delta_y&\\ge&{\\left\\lvert\\rho(x , y)-\\rho'(x , y)\\right\\rvert}&x\\ne y\\in x    \\end{array}\\ ] ] yield again @xmath139 and @xmath146 as minimal values , respectively .",
    "define @xmath174 by @xmath175 . by the above relation ,",
    "@xmath174 is again in the feasible set of ( [ eq : min1 ] ) and ( [ eq : min2 ] ) respectively .",
    "further , @xmath176 completes the proof .",
    "[ lem : complete ] @xmath8 and @xmath82 are complete in each @xmath33 , @xmath41 .    clearly , @xmath8 is complete w.r.t .",
    "since all metrics on @xmath8 are equivalent by theorem [ th : pdcomp ] , the same should be true for @xmath33 .",
    "on @xmath82 we have to observe additionally , that @xmath82 is closed since both sides of the four point conditions ( [ eq:4point ] ) depend continuously on the metric",
    ". then lemma [ lem:4point ] implies completeness of @xmath82 .    to show that the new metrics are biologically meaningful ,",
    "we show that they do nt change much under an nni ( nearest neighbour interchange ) operations .",
    "such an operation is given by @xmath178 \\node ( a ) at ( 0,4 ) [ rectangle , draw = black ] { $ a$ } ; \\node ( b ) at ( 0,0 ) [ rectangle , draw = black ] { $ b$ } ; \\node ( c ) at ( 2,2 )   { $ \\bullet$ } ; \\node ( d ) at ( 4,2 )   { $ \\bullet$ } ; \\node ( e ) at ( 6,0 ) [ rectangle , draw = black ] { $ c$ } ; \\node ( f ) at ( 6,4 ) [ rectangle , draw = black ] { $ d$ } ; \\draw[very thick ] ( a ) to ( c ) ; \\draw[very thick ] ( b ) to ( c ) ; \\draw[very thick ] ( c ) to ( d ) ; \\draw[very thick ] ( d ) to ( e ) ; \\draw[very thick ] ( d ) to ( f ) ; \\end{tikzpicture}\\qquad\\longmapsto\\qquad \\begin{tikzpicture}[xscale=0.5,yscale=0.2 , baseline = 10 ] \\node ( a ) at ( 0,4 ) [ rectangle , draw = black ] { $ a$ } ; \\node ( b ) at ( 0,0 ) [ rectangle , draw = black ] { $ c$ } ; \\node ( c ) at ( 2,2 )   { $ \\bullet$ } ; \\node ( d ) at ( 4,2 )   { $ \\bullet$ } ; \\node ( e ) at ( 6,0 ) [ rectangle , draw = black ] { $ b$ } ; \\node ( f ) at ( 6,4 ) [ rectangle , draw = black ] { $ d$ } ; \\draw[very thick ] ( a ) to ( c ) ; \\draw[very thick ] ( b ) to ( c ) ; \\draw[very thick ] ( c ) to ( d ) ; \\draw[very thick ] ( d ) to ( e ) ; \\draw[very thick ] ( d ) to ( f ) ; \\end{tikzpicture}\\ ] ] or @xmath178 \\node ( a ) at ( 0,4 ) [ rectangle , draw = black ] { $ a$ } ; \\node ( b ) at ( 0,0 ) [ rectangle , draw = black ] { $ b$ } ; \\node ( c ) at ( 2,2 )   { $ \\bullet$ } ; \\node ( d ) at ( 4,2 )   { $ \\bullet$ } ; \\node ( e ) at ( 6,0 ) [ rectangle , draw = black ] { $ c$ } ; \\node ( f ) at ( 6,4 ) [ rectangle , draw = black ] { $ d$ } ; \\draw[very thick ] ( a ) to ( c ) ; \\draw[very thick ] ( b ) to ( c ) ; \\draw[very thick ] ( c ) to ( d ) ; \\draw[very thick ] ( d ) to ( e ) ; \\draw[very thick ] ( d ) to ( f ) ; \\end{tikzpicture}\\qquad\\longmapsto\\qquad \\begin{tikzpicture}[xscale=0.5,yscale=0.2 , baseline = 10 ] \\node ( a ) at ( 0,4 ) [ rectangle , draw = black ] { $ a$ } ; \\node ( b ) at ( 0,0 ) [ rectangle , draw = black ] { $ d$ } ; \\node ( c ) at ( 2,2 )   { $ \\bullet$ } ; \\node ( d ) at ( 4,2 )   { $ \\bullet$ } ; \\node ( e ) at ( 6,0 ) [ rectangle , draw = black ] { $ c$ } ; \\node ( f ) at ( 6,4 ) [ rectangle , draw = black ] { $ b$ } ; \\draw[very thick ] ( a ) to ( c ) ; \\draw[very thick ] ( b ) to ( c ) ; \\draw[very thick ] ( c ) to ( d ) ; \\draw[very thick ] ( d ) to ( e ) ; \\draw[very thick ] ( d ) to ( f ) ; \\end{tikzpicture}\\ ] ] where @xmath179 denote different subtrees .",
    "the minimal number of nni operations to reach @xmath180 from @xmath181 is the nni - distance @xmath182 @xcite .",
    "consider @xmath183 which are away by one nni operation .",
    "then @xmath134{*5c }   d_1(\\tau,\\tau')&\\le & n\\\\ d_2(\\tau,\\tau')&\\le&\\sqrt n\\\\ d_\\infty ( \\tau,\\tau')&=&1    \\end{array}\\ ] ] especially , @xmath184    let be @xmath185 \\node ( a ) at ( 0,4 ) [ rectangle , draw = black ] { $ a$ } ; \\node ( b ) at ( 0,0 ) [ rectangle , draw = black ] { $ b$ } ; \\node ( c ) at ( 2,2 )   { $ \\bullet$ } ; \\node ( d ) at ( 4,2 )   { $ \\bullet$ } ; \\node ( e ) at ( 6,0 ) [ rectangle , draw = black ] { $ c$ } ; \\node ( f ) at ( 6,4 ) [ rectangle , draw = black ] { $ d$ } ; \\draw[very thick ] ( a ) to ( c ) ; \\draw[very thick ] ( b ) to ( c ) ; \\draw[very thick ] ( c ) to ( d ) ; \\draw[very thick ] ( d ) to ( e ) ; \\draw[very thick ] ( d ) to ( f ) ; \\end{tikzpicture } $ ] and @xmath186 \\node ( a ) at ( 0,4 ) [ rectangle , draw = black ] { $ a$ } ; \\node ( b ) at ( 0,0 ) [ rectangle , draw = black ] { $ c$ } ; \\node ( c ) at ( 2,2 )   { $ \\bullet$ } ; \\node ( d ) at ( 4,2 )   { $ \\bullet$ } ; \\node ( e ) at ( 6,0 ) [ rectangle , draw = black ] { $ b$ } ; \\node ( f ) at ( 6,4 ) [ rectangle , draw = black ] { $ d$ } ; \\draw[very thick ] ( a ) to ( c ) ; \\draw[very thick ] ( b ) to ( c ) ; \\draw[very thick ] ( c ) to ( d ) ; \\draw[very thick ] ( d ) to ( e ) ; \\draw[very thick ] ( d ) to ( f ) ; \\end{tikzpicture } $ ] where @xmath179 are the four subtrees of @xmath187 corresponding to a four - partition of @xmath0",
    ".    then we observe the following structure of the matrix @xmath188 , @xmath189 : @xmath190 or more precisely @xmath191{cl }        1&x\\in a\\cup d , y\\in b\\cup c\\\\        1&y\\in a\\cup d , x\\in b\\cup c\\\\ 0&\\mbox{otherwise }      \\end{array } \\right.\\ ] ]    the estimates are now immediate from theorem [ th : pdcomp ] .",
    "similar estimates could be done for the spr - metrics . by @xcite",
    "this has natural implications to the tbr - metrics , too .",
    "further we see that the size of the @xmath192neighbourhood of a tree @xmath181 in the @xmath193metric is at least @xmath194 .",
    "how large are those bounds compared to the diameter of the space @xmath195 ?",
    "we have some crude estimates :    [ lem : upperdiameter ] for all @xmath196 it holds @xmath134{*5c }   d_1(\\tau_1,\\tau_2)&\\le & n\\cdot\\frac{n-2}2\\\\",
    "d_2(\\tau_1,\\tau_2)&\\le&\\sqrt n\\cdot\\frac{n-2}2\\\\ d_\\infty ( \\tau_1,\\tau_2)&\\le & \\frac{n-2}2    \\end{array}\\ ] ]    @xmath197 follows immediately from @xmath198 which holds since all paths in @xmath199 have at least one and at most @xmath200 edges .",
    "theorem [ th : pdcomp ] implies the other two inequalities and the estimate on the nni - metric are immediate consequences of its definition .",
    "now we want to show that there are trees such that the distance between them is of the same order in @xmath135 .",
    "[ lem : cater ] let us be given @xmath201 for some @xmath202 , @xmath203 , @xmath204 .",
    "suppose @xmath104 is the unrooted caterpillar tree with cherries @xmath205 and @xmath206 : @xmath207 \\node ( 1 ) at ( 0,2 ) [ rectangle , rounded corners , draw = black ] { $ 1 $ } ; \\node ( 2 ) at ( 0,0 ) [ rectangle , rounded corners , draw = black ] { $ 2 $ } ; \\node ( 12s ) at ( 1,1 )   { $ \\bullet$ } ; \\node ( 3 ) at ( 2,2 ) [ rectangle , rounded corners , draw = black ] { $ 3 $ } ; \\node ( 3s ) at ( 2,1 )   { $ \\bullet$ } ; \\node ( 4 ) at ( 3,0 ) [ rectangle , rounded corners , draw = black ] { $ 4 $ } ; \\node ( 4s ) at ( 3,1 )   { $ \\bullet$ } ; \\node ( 5 ) at ( 4,2 ) [ rectangle , rounded corners , draw = black ] { $ 5 $ } ; \\node ( 5s ) at ( 4,1 )   { $ \\bullet$ } ; \\node ( cdots ) at ( 5,1 )   { $ \\cdots$ } ; \\node ( 4m-2 ) at ( 6,0 ) [ rectangle , rounded corners , draw = black ] { $ 4m-2 $ } ; \\node ( 4m-2s ) at ( 6,1 )   { $ \\bullet$ } ; \\node ( 4m-1 ) at ( 7,2 ) [ rectangle , rounded corners , draw = black ] { $ 4m-1 $ } ; \\node ( 4m-1s ) at ( 7,1 )   { $ \\bullet$ } ; \\node ( 4ms ) at ( 8,1 )   { $ \\bullet$ } ; \\node ( 4 m ) at ( 9,0 ) [ rectangle , rounded corners , draw = black ] { $ 4m$ } ; \\node ( 4m+1 ) at ( 9,2 ) [ rectangle , rounded corners , draw = black ] { $ 4m+1 $ } ; \\draw[very thick ] ( 1 ) to ( 12s ) ; \\draw[very thick ] ( 2 ) to ( 12s ) ; \\draw[very thick ] ( 3 ) to ( 3s ) ; \\draw[very thick ] ( 4 ) to ( 4s ) ; \\draw[very thick ] ( 5 ) to ( 5s ) ; \\draw[very thick ] ( 5s ) to ( cdots ) ; \\draw[very thick ] ( cdots ) to ( 4m-2s ) ; \\draw[very thick ] ( 4m-2 ) to ( 4m-2s ) ; \\draw[very thick ] ( 4m-1 ) to ( 4m-1s ) ; \\draw[very thick ] ( 4 m ) to ( 4ms ) ; \\draw[very thick ] ( 4m+1 ) to ( 4ms ) ; \\draw[very thick ] ( 12s ) to ( 3s ) ; \\draw[very thick ] ( 3s ) to ( 4s ) ; \\draw[very thick ] ( 4s ) to ( 5s ) ; \\draw[very thick ] ( 4m-2s ) to ( 4m-1s ) ; \\draw[very thick ] ( 4m-1s ) to ( 4ms ) ; \\end{tikzpicture}\\ ] ] and @xmath110 is obtained from @xmath104 by reversing the order of the even labels , i.e. @xmath208 is interchanged with @xmath209 for @xmath210 : @xmath211 \\node ( 1 ) at ( 0,2 ) [ rectangle , rounded corners , draw = black ] { $ 1 $ } ; \\node ( 2 ) at ( 0,0 ) [ rectangle , rounded corners , draw = black ] { $ 4m$ } ; \\node ( 12s ) at ( 1,1 )   { $ \\bullet$ } ; \\node ( 3 ) at ( 2,2 ) [ rectangle , rounded corners , draw = black ] { $ 3 $ } ; \\node ( 3s ) at ( 2,1 )   { $ \\bullet$ } ; \\node ( 4 ) at ( 3,0 ) [ rectangle , rounded corners , draw = black ] { $ 4m-2 $ } ; \\node ( 4s ) at ( 3,1 )   { $ \\bullet$ } ; \\node ( 5 ) at ( 4,2 ) [ rectangle , rounded corners , draw = black ] { $ 5 $ } ; \\node ( 5s ) at ( 4,1 )   { $ \\bullet$ } ; \\node ( cdots ) at ( 5,1 )   { $ \\cdots$ } ; \\node ( 4m-2 ) at ( 6,0 ) [ rectangle , rounded corners , draw = black ] { $ 4 $ } ; \\node ( 4m-2s ) at ( 6,1 )   { $ \\bullet$ } ; \\node ( 4m-1 ) at ( 7,2 ) [ rectangle , rounded corners , draw = black ] { $ 4m-1 $ } ; \\node ( 4m-1s ) at ( 7,1 )   { $ \\bullet$ } ; \\node ( 4ms ) at ( 8,1 )   { $ \\bullet$ } ; \\node ( 4 m ) at ( 9,0 ) [ rectangle , rounded corners , draw = black ] { $ 2 $ } ; \\node ( 4m+1 ) at ( 9,2 ) [ rectangle , rounded corners , draw = black ] { $ 4m+1 $ } ; \\draw[very thick ] ( 1 ) to ( 12s ) ; \\draw[very thick ] ( 2 ) to ( 12s ) ; \\draw[very thick ] ( 3 ) to ( 3s ) ; \\draw[very thick ] ( 4 ) to ( 4s ) ; \\draw[very thick ] ( 5 ) to ( 5s ) ; \\draw[very thick ] ( 5s ) to ( cdots ) ; \\draw[very thick ] ( cdots ) to ( 4m-2s ) ; \\draw[very thick ] ( 4m-2 ) to ( 4m-2s ) ; \\draw[very thick ] ( 4m-1 ) to ( 4m-1s ) ; \\draw[very thick ] ( 4 m ) to ( 4ms ) ; \\draw[very thick ] ( 4m+1 ) to ( 4ms ) ; \\draw[very thick ] ( 12s ) to ( 3s ) ; \\draw[very thick ] ( 3s ) to ( 4s ) ; \\draw[very thick ] ( 4s ) to ( 5s ) ; \\draw[very thick ] ( 4m-2s ) to ( 4m-1s ) ; \\draw[very thick ] ( 4m-1s ) to ( 4ms ) ; \\end{tikzpicture}\\ ] ]    then @xmath134{*5c }   d_1(\\tau,\\tau')&\\ge & \\tilde d_1(\\tau,\\tau')&\\ge&4m^2 - 4m+2\\\\ d_2(\\tau',\\tau')&\\ge & \\tilde d_2(\\tau,\\tau')&\\ge&\\sqrt{\\frac{16}3m^3 - 8m^2+\\frac{32}3m-6}\\\\ & & d_\\infty ( \\tau,\\tau')&= & 2m-1    \\end{array}\\ ] ]    it is easy to see that for @xmath212 @xmath213{cl }          j&i=1,2,\\quad j\\le 4m\\\\ 4m&i=1,2,\\quad j=4m+1\\\\ 4m+1-i&3\\le i,\\quad j=4m,4m+1\\\\ j - i+2&\\mbox{otherwise }        \\end{array } \\right.\\ ] ] first , the formula for @xmath214 follows immediately from theorem [ th : pdcomp ] .",
    "continuing , we obtain from ( [ eq : min2 ] ) the following constraints @xmath134{*3c }      \\delta_1+\\delta_2&\\ge&4m-2\\\\ \\delta_3+\\delta_4&\\ge & 4m-8\\\\ \\delta_5+\\delta_6&\\ge&4m-12\\\\ & \\vdots&\\\\ \\delta_{2m-1}+\\delta_{2m}&\\ge&0\\\\ & \\vdots&\\\\ \\delta_{4m-3}+\\delta_{4m-2}&\\ge&4m-8\\\\ \\delta_{4m-1}+\\delta_{4m}&\\ge&4m-4    \\end{array}\\ ] ] summing up this constraints directly gives the lower bound for @xmath215 .",
    "now @xmath216 gives us @xmath134{*3c }      \\delta_1 ^ 2+\\delta_2 ^ 2&\\ge&2(2m-1)^2\\\\ \\delta_3 ^",
    "2+\\delta_4 ^ 2&\\ge & 2(2m-4)^2\\\\ \\delta_5 ^ 2+\\delta_6 ^ 2&\\ge&2(2m-6)^2\\\\ & \\vdots&\\\\ \\delta_{2m-1}^2+\\delta_{2m}^2&\\ge&0\\\\ & \\vdots&\\\\",
    "\\delta_{4m-3}^2+\\delta_{4m-2}^2&\\ge&2(2m-4)^2\\\\ \\delta_{4m-1}^2+\\delta_{4m}^2&\\ge&8(m-1)^2    \\end{array}\\ ] ] again summing up this yields the lower bound for @xmath217 .    using the results from the next section and computation similar to the second next section",
    "we could derive the same order of magnitude of @xmath33 for general @xmath135 .",
    "from lemma [ lem : algebra ] we obtain for `` small '' semimetrics @xmath218 immediately that @xmath219 notably , we can even sharpen this estimate :    [ lem : localtilde ] for all @xmath220 there is a @xmath221 such that for @xmath218 with @xmath222 @xmath223    for @xmath224 the condition @xmath220 just means that the labeling is injective .",
    "thus it is weaker than to say that @xmath104 is an inner point of some orthant of tree space as considered in @xcite , meaning the tree is binary and all edge lengths are positive .",
    "further , this result is another proof that the @xmath148 are really metrics , see lemma [ lem : tildemetrics ] .    in the following ,",
    "let @xmath225 denote the zero semimetric on @xmath0 .    by lemma [ lem : upperbound ] , we may add the constraints @xmath226 to ( [ eq : min1 ] ) and ( [ eq : min2 ] ) to get problems ( [ eq : min1b ] ) and ( [ eq : min2b ] ) , respectively .",
    "now it is easy to derive that for @xmath227 and @xmath35 , @xmath222 , the constraints @xmath228 are automatically fulfilled . removing them yields problem ( [ eq : min2b ] ) .",
    "[ ex : weights1tree ] so it is interesting to ask for @xmath229 for a very simple @xmath104 , we choose @xmath230 \\node ( a ) at ( 0,1 ) [ rectangle , draw = black ] { $ a$ } ; \\node ( b ) at ( 2,1 ) [ rectangle , draw = black ] { $ b$ } ; \\draw[very thick ] ( a ) to ( b ) ; \\node at ( 1,1 ) [ above ] { $ l$ } ; \\end{tikzpicture}$ ] where @xmath231 is a split of @xmath0 and @xmath232 is the length of this split .",
    "we see that the constraints from ( [ eq : min2 ] ) turn into @xmath134{*4c }   \\delta_x&\\ge&0&x\\in x\\\\      \\delta_x+\\delta_y&\\ge&l&x \\in a , y\\in b    \\end{array}\\ ] ] now ( [ eq : min2 ] ) is symmetric under permutations of @xmath233 and under permutations of @xmath234 .",
    "thus we may simply assume that @xmath235{*3c }      a&x\\in a\\\\ b&x\\in b    \\end{array } \\right.\\ ] ] for some @xmath236 with @xmath237 .    for computing @xmath238 , we find @xmath239 the later function of @xmath240 has minimum @xmath241 .",
    "similarly we find for @xmath242 @xmath243 now the minimum is @xmath244 .",
    "summarisingly , we observe that different splits of a tree get different weights .",
    "moreover , we see that the minimal points @xmath245 fulfil _ all _ contraints in ( [ eq : min1 ] ) .",
    "this shows @xmath246 .",
    "further , the same computations are valid if we compute @xmath247 with @xmath248 replacing @xmath232 : @xmath249    [ ex : ll ] we want to compute @xmath250 for @xmath251 \\node ( a ) at ( 0,1 ) [ rectangle , draw = black ] { $ a$ } ; \\node ( b ) at ( 2,1 ) [ rectangle , draw = black ] { $ b$ } ; \\node ( c ) at ( 4,1 ) [ rectangle , draw = black ] { $ c$ } ; \\draw[very thick ] ( a ) to ( b ) ; \\draw[very thick ] ( b ) to ( c ) ; \\node at ( 1,1 ) [ above ] { $ l$ } ; \\node at ( 3,1 ) [ above ] { $ l'$ } ; \\end{tikzpicture}\\ ] ] this tree is the essence of two trees with same shape but differing in the lengths of two edges .",
    "again , symmetry gives us to consider only @xmath235{*3c }      a&x\\in a\\\\ b&x\\in b\\\\ c&x\\in c    \\end{array } \\right.\\ ] ] for some @xmath252 which fulfil now @xmath253{*3c }      a+b&\\ge&l\\\\ b+c&\\ge & l'\\\\ a+c&\\ge & l+l '    \\end{array}\\ ] ] which gives us a linear or quadratic program in @xmath254 .    for computing @xmath238",
    ", we want @xmath255 on this set . we know",
    ", that this minimum is achieved in a corner of the feasible set .",
    "but , we see easily that not all inequalties in ( [ eq : abc ] ) could be equalities unless @xmath256 .",
    "thus at least one of @xmath257 must be zero and we obtaine the minimal value as @xmath258 a distinction of cases whether @xmath259 and @xmath260 gives us in any case one of the value as minimum .",
    "thus in any case , @xmath261 is a linear combination of @xmath232 and @xmath262 , i.e. some weighted @xmath263 distance .",
    "the computation of @xmath242 would mean solving the quadratic program @xmath264 for this problem , we only know that the solution is the projection of the null vector onto the affine hyperspace determined by some _",
    "face _ of the feasible set .",
    "this projection is linear in @xmath232 and @xmath262 .",
    "this means that @xmath242 is the minimum of several quadratic functions in @xmath265 .",
    "since the algebra is rather tedious we stop here now with the indication that this minimum is just a single quadratic function similar to the linear case before . a numerical test for several cardinalities and random lengths",
    "@xmath265 provided in figure [ fig : notquadratic ] shows that the parallelogramm equality is fulfilled in all considered situations .",
    "thus the local geometry seems to be euclidean .",
    "this was our original expectation when we introduced @xmath32 .",
    "but even if this would be true in general , we are already asured by the previous example that we do not to compute the geodesic metric from @xcite .",
    "for any @xmath266-tree @xmath104 let @xmath267 denote the restriction to @xmath268 . observe that for @xmath269 in general @xmath270 .",
    "let @xmath271 and @xmath272 . then for @xmath41 @xmath134{*3c }      d_i(\\tau,\\tau')&\\ge & d_i(\\tau|_x,\\tau'|_x)\\\\      \\tilde d_i(\\tau,\\tau')&\\ge & \\tilde d_i(\\tau|_x,\\tau'|_x )    \\end{array}\\ ] ]    this follows immediately from the same inequalities for semimetrics on @xmath266 . then , restricting @xmath273 from lemma [ lem : di * ] to @xmath274 yields an element of @xmath275 .",
    "moreover , @xmath276 for @xmath277 completes the calculation .",
    "this result naturally holds for many other phylogenetic metrics : for the pathwise difference , nni- , spr- , tbr- and maximum parsimony metrics , for example . for the tree rearrangement metrics is was shown in ( * ? ? ?",
    "* lemma 2.2 ) .",
    "the different metrics were implemented by ` r ` @xcite programs . for solving linear and quadratic programs the ` glpkapi ` library @xcite and ` quadprog ` library @xcite",
    "were used , respectively .",
    "the corresponding ` r`-script can be downloaded from the website @xcite .",
    "some testing showed best performance in terms of computing time for the dual simplex algorithm in the @xmath1-case . the computing time for obtaining",
    "the distance between random trees of size 100 was around 0.3s which is quite reasonable , see figure [ fig : times ] .",
    "it also compares with the computing time of the geodesic distance .",
    "the random trees were generated by the function ` rtree ` of the ` r ` library ` phangorn ` @xcite .",
    "we also compared @xmath33 and @xmath148 with several other phylogenetic metrics , essentially the pathwise difference , the geodesic distance and the robinson - foulds metric , for @xmath278 leaves .",
    "for the computation of the geodesic ( bhv- ) metric the ` r`-package ` distory ` @xcite was used .",
    "the results are presented in figure [ fig : distcont ] .",
    "numerially , we could observe @xmath246 in all cases , seee figure [ fig : gleich ] at the end of the paper .",
    "a remarkable correlation between the different gromov - type and the pathwise difference metrics can be observed .",
    "there is not much correlation to the geodesic distance .",
    "may be , the different weigths on the internal edges ( see example [ ex : weights1tree ] ) are responsible for that .",
    "similar pictures are found for unweighted trees , see figure [ fig : distdiscr ] .",
    "interestingly , @xmath279 turns out to integer - valued now , see the same figure .",
    "that is quite a bit surprising since the matrix corresponding to the linear program ( [ eq : min2 ] ) is not totally unimodular in the sense of @xcite , it contains the @xmath280 submatrix @xmath281 with determinant @xmath282 .",
    "random caterpillars are interesting in their own , the results are presented in figure [ fig : distcaterpillar ] .",
    "we observe that we obtain a much larger maximum of 28 for @xmath31 ( over the sample ) than from random trees . in comparison ,",
    "the lower bound from lemma [ lem : cater ] would be much smaller : @xmath283 .",
    "what have we achieved ?",
    "we constructed at least two new biocomputable metrics for comparing unrooted , but possibly weighted , phylogenetic trees .",
    "we think this approach is valuable and could generalise well .",
    "one direction is the extension to rooted trees .",
    "we should then just measure the distance of the induced metrics on @xmath284 .",
    "another generalisation could be phylogenetic networks .",
    "outside phylogeny , there should be applications to other kinds of finite labeled metric spaces . at the moment , we are only aware of the papers of f.memoli , e.g. @xcite , which deals with @xmath285type gromov - hausdorff metrics .    in general , we follow @xcite in arguing that there is no universal metric for phylogenetic trees which suits perfectly for all purposes .",
    "we think that every application has its own choice , and we added a further choice to this portfolio . yet",
    ", we should discuss further properties of phylogenetic metrics to guide the users .",
    "monotony as considered in section [ sec : monoton ] is a , yet trivial , beginning in this direction .",
    "here we want to discuss some important results of the present paper and possible extensions only .",
    "it looks interesting to extend the metric to tree shapes , with allowing the labels to be permuted .",
    "still that metric differs from the gromov - hausdorff metric since we allow only matching of the labels in contrast to the weaker version in ( [ eq : gromovhere ] ) .",
    "for the gromov - hausdorff distance it is shown in @xcite that it is again np - hard to compute it .",
    "we expect the same for the permutation approach .",
    "one important topic which raised up already in @xcite is the question how to _ weight _ the edges of the trees .",
    "we obtained natural weights from our approach in example [ ex : weights1tree ] . if those weights do not fit the intention of the applicant , it is easy to shorten or lengthen the edges of the trees and obtain other metric spaces which could be easily compared .",
    "there is also the possibility to weight the labels , for instance to account for uneven sampling .",
    "then we could adjust to this by weighting the @xmath38 norms which leads again to similar computations .",
    "note that we met already such a weighted approach in the computations in the examples [ ex : weights1tree ] and [ ex : ll ] .",
    "further , also a kantorovich - wasserstein approach similar to @xcite might be feasible if the weights of the leaves differ between the trees . in summary ,",
    "our approach is natural but can be well adjusted to the needs of applications .",
    "we showed several properties of the new metrics including compatibility with the nni - metric , a lot of estimates with the pathwise difference metrics , local properties related to the lower bound metrics @xmath148 , and monotony .",
    "of course , there are many more questions in this context .",
    "especially we would like to sharpen the estimates .",
    "we do not know much about the @xmath192neighbourhoods on @xmath89 , e.g. whether there are islands in the sense of @xcite .",
    "there are a lot of connections with the quartet , spr-,tbr- , maximum parsimony , weighted matching and bhv - metrics to explore , too .",
    "numerical comparison was done for the ` r`-implemented distances only .",
    "we expect the diameter between two unweighted @xmath0-trees to be realised by caterpillar trees .",
    "the simulation result in figure [ fig : distcaterpillar ] points into this direction .",
    "a more sharp estimate than provided in lemma [ lem : upperdiameter ] and lemma [ lem : cater ] would be quite interesting , too .",
    "it is still not clear whether and why @xmath31 or @xmath238 takes integers values only on @xmath89 .",
    "the geometry induced by the euclidean type metrics @xmath286 should be further explored , too .",
    "it should be interesting to prove it is locally euclidean and to find out how the geodesics look like .",
    "possibly , the geodesic distance with respect to @xmath32 is even another metric .",
    "most interesting we find the question whether @xmath246 .",
    "provable equality could save some computing time , at least .",
    "for the time until this problem is solved , we just know there are new animals in the zoo of phylogenetic distances  but not , how many .    [ [ acknowledgements ] ] acknowledgements + + + + + + + + + + + + + + + +    first of all , i have to thank mareike fischer for introducing me to the world of phylogenetic distances .",
    "she helped also a lot for getting a clear notation .",
    "second , i m very grateful to jrgen eichhorn who unconsciously draw my attention to metrics between metric spaces .",
    "third , i d like to thank michelle kendall for her inspiring talk at the portobello conference 2015 and additional discussion later .",
    "fourth , i thank mike steel for many interesting discussions , useful hints , his kind hospitality during my stay in christchurch 2010 , and for the organisation of the amazing 2015 workshop in kaikoura with an inspiring and open atmosphere .",
    "further , andrew francis , alexander gavryushkin , stefan grnewald , marc hellmuth and giulio dalla riva gave useful hints and inspiration in many discussions .",
    "99    b. l. allen and m. steel , subtree transfer operations and their induced metrics on evolutionary trees , ann . comb . * 5*:115 , 2001    l.j .",
    "billera , s.p .",
    "holmes , and k. vogtmann , geometry of the space of phylogenetic trees , adv .",
    "appl . math .",
    ", * 27 * ( 4 ) : 733 - 767 , 2001 . d. bogdanowicz and k. giaro , matching split distance for unrooted binary phylogenetic trees , ieee / acm transactions on computational biology and bioinformatics * 9*(1):150 - 160 , 2012 d. bogdanowicz , k. giaro , and b. wrbel , treecmp : comparison of trees in polynomial time , evol . bioinform .",
    "online * 8 * : 475487 , 2012 .",
    "m.l . bonet and k. st.john . on the complexity of uspr distance .",
    "ieee / acm trans . comp .",
    ". bioinf . *",
    "7*(3 ) : 572-576 , 2010 g.s .",
    "brodal , r. fagerberg , and c.n.s .",
    "pedersen , computing the quartet distance between evolutionary trees on time @xmath287 , proceedings of the 12th international symposium on algorithms and computation ( isaac ) .",
    "springer verlag , lecture notes in computer science , vol .",
    "2223 , pp . 731737 , 2001 p.",
    "buneman , the recovery of trees from measures of dissimilarity . in d.g .",
    "kendall and p. tautu , eds . , mathematics the the archeological and historical sciences , pages 387395 .",
    "edinburgh university press , 1971 p. buneman , a note on the metric properties of trees , j. comb .",
    ", * 17*(1 ) : 48 - 50 , 1974 j. cristina , gromov - hausdorff convergence of metric spaces , preprint , helsinki 2008 + ` http://www.helsinki.fi/  cristina / pdfs / gromovhausdorff.pdf ` b. dasgupta , x. he , t. jiang , m. li , j. tromp , and l. zhang , on distances between phylogenetic trees , proc .",
    "eighth acm / siam symp .",
    "discrete algorithms ( soda 97 ) , pp . 427436 , 1997 a. gavryushkin and a. drummond , the space of ultrametric phylogenetic trees , preprint 2014 ` arxiv:1410.3544v1 ` w.h.e .",
    "day , optimal algorithms for comparing trees with labeled leaves , j. class .",
    "2(1):7 - 28 , 1985 .",
    "e. deza and m.m .",
    "deza , encyclopedia of distances , springer 2009 a.w.m .",
    "dress , trees , tight extensions of metric spaces , and the cohomological dimension of certain groups : a note on combinatorial properties of metric spaces , adv . math . * 53*(3 ) : 321 - 402 , 1984 g. f. estabrook , f.r .",
    "mcmorris , and c.a .",
    "meacham , comparison of undirected phylogenetic trees based on subtrees of four evolutionary units , syst .",
    "zool . * 34*(2):193 - 200 , 1985 m. fischer and s. kelk , on the maximum parsimony distance between phylogenetic trees . in press at ann",
    "( preliminary version : ` arxiv : 1402.1553 ) `    a. gunoche , b. leclerc , v. makarenkov , on the extension of a partial metric to a tree metric , discr . math . * 276 * : 229 - 248 , 2004 .",
    "hoffman , j. kruskal , introduction to integral boundary points of convex polyhedra , in m. jnger et al .",
    "( eds . ) , 50 years of integer programming , 1958 - 2008 , springer berlin 2010 , pp .",
    "4950 n. karmarkar , a new polynomial - time algorithm for linear programming .",
    "4*(4 ) : 373395,1984 . s. kelk and m. fischer , on the complexity of computing mp distance between binary phylogenetic trees , `",
    "arxiv:1412.4076 ` m. kendall , a new metric for the comparison of phylogenetic trees , talk at the new zealand phylogenetic conference , portobello , 2015 y. lin , v. rajan , and b.m.e .",
    "moret , a metric for phylogenetic trees based on matching , ieee / acm trans .",
    ". bioinf . *",
    "9*(4 ) : 1014 - 1022 , 2012 f. mmoli , on the use of gromov - hausdorff distances for shape comparison .",
    "symposium on point based graphics 2007 , prague , september 2007 .",
    "m. owen and j. provan , a fast algorithm for computing geodesic distances in tree space , ieee / acm trans .",
    "* 8*(1):2 -13 , 2011 , ` arxiv:0907.3942 ` p.m. pardalos and h. wolkowicz(eds . ) , quadratic assignment and related problems , dimacs series in discrete mathematics and theoretical computer science , 16 .",
    "american mathematical society , providence , ri , 1994 .",
    "papers from the workshop held at rutgers university , new brunswick , new jersey , may 2021 , 1993    n.d .",
    "pattengale , e.j .",
    "gottlieb , b.m .",
    "moret , efficiently computing the robinson - foulds metric , j. comput .",
    "* 14*(6):724 - 735 , 2007 .",
    "d. penny and m.d .",
    "hendy , the use of tree comparison metrics , syst .",
    "* 34 * ( 1 ) : 75 - 82 , 1985 d.f .",
    "robinson , comparison of labeled trees with valency three , j. comb .",
    "11*:105 - 119(1971 )    d.f .",
    "robinson and l.r .",
    "foulds , comparison of weighted labelled trees , in combinatorial mathematics vi , lecture notes in mathematics 748 , springer , berlin , 1979 , pp .",
    "robinson and l.r .",
    "foulds , comparison of phylogenetic trees , math .",
    "biosciences , * 53 * : 131 - 147 , 1981 m.a . steel and d.",
    "penny , distributions of tree comparison metrics  some new results , syst .",
    "biol.*42*(2 ) : 126 - 141 , 1993    c. whidden , r.g .",
    "beiko , and n. zeh .",
    "fixed - parameter and approximation algorithms for maximum agreement forests of multifurcating trees . to appear in algorithmica , 2015 , ` arxiv:1305.0512 ` w.t .",
    "williams and h.t .",
    "clifford , on the comparison of two classifications of the same set of elements , taxon * 20 * : 519 - 522 , 1971 k.a .",
    "zaretskii , constructing a tree on the basis of a set of distances between the hanging vertices .",
    "( in russian ) uspekhi mat .",
    "20*(6 ) : 9092 , 1965 .",
    "r core team , r : a language and environment for statistical computing , r foundation for statistical computing , vienna , austria .",
    "url ` http://www.r-project.org/ ` , 2015 k.p .",
    "schliep , phangorn : phylogenetic analysis in r , bioinformatics * 27*(4 ) : 592 - 593 , 2011 b.a . turlach ( r port by andreas weingessel ) ,",
    "quadprog : functions to solve quadratic programming problems , r package version 1.5 - 5 , ` http://cran.r-project.org/package=quadprog ` , 2013 g. gelius - dietrich , glpkapi : r interface to c api of glpk , r package version 1.3.0 , ` http://cran.r-project.org/package=glpkapi ` , 2015 j. chakerian and s. holmes , distory : distance between phylogenetic histories , r package version 1.4.2 , ` http://cran.r-project.org/package=distory ` , 2013 v. liebscher , `",
    "r ` file for figures in the present paper , 2015 + ` http://www.math-inf.uni-greifswald.de/ ` + ` images / liebscher / libraries / phylodist.zip `",
    "several times we met the problem whether a partial dissimilarity on @xmath0 , i.e. a map @xmath74 , @xmath288 has an extension to a metric on @xmath0 .",
    "this seems to be a well - known problem , one folklore solution i found in @xcite :        although this presents a complete solution of the extension problem we want to sharpen this criterion for improved applicability .",
    "still the next result should be folklore but i could not find it in literature . if @xmath292 is a cycle in a graph @xmath293 we call any pair @xmath294 , @xmath295 a chord of @xmath296 . a cycle @xmath296 without chord",
    "is called minimal cycle .",
    "[ th : metextmin ] if the graph @xmath289 is simple and connected , then @xmath74 extends to a metric on @xmath0 if and only if for all minimal cycles @xmath296 of @xmath111 and all edges @xmath297 in @xmath296 @xmath298      non - minimality of @xmath296 implies that there is a chord @xmath302 of @xmath296 .",
    "since @xmath301 is minimal , we know @xmath303 and @xmath304 substituting the first inequality into the rhs of the second one yields @xmath305 this is ( [ eq : boundedgelength ] ) .",
    "this contradiction completes the proof .",
    "we are using theorem [ th : metextmin ] below on @xmath274 with @xmath306 .",
    "the minimal cycles in @xmath307 are either triangles in @xmath0 , triangles in @xmath308 or rectangles @xmath138 .",
    "for the two former , ( [ eq : boundedgelength ] ) is equivalent to the triangle inequalities for @xmath64 . for the latter , ( [ eq : boundedgelength ] ) is the same as ( [ eq : quadr ] ) .",
    "now we apply the theorem to the graph @xmath316 with @xmath317{cl } d_1(u , v)&u , v\\in x\\cup y\\\\ d_2(u , v)&u , v\\in y\\cup z \\end{array}\\right .",
    "$ ] . since both @xmath318 and @xmath319",
    "are cliques in this graph , the only minimal cycles are triangles . for them ( [ eq : boundedgelength ] ) is fulfilled by definition of @xmath320 ."
  ],
  "abstract_text": [
    "<S> we present a new class of metrics for unrooted phylogenetic @xmath0-trees derived from the gromov - hausdorff distance for ( compact ) metric spaces . </S>",
    "<S> these metrics can be efficiently computed by linear or quadratic programming . </S>",
    "<S> they are robust under nni - operations , too . </S>",
    "<S> the local behavior of the metrics shows that they are different from any formerly introduced metrics . the performance of the metrics is briefly analised on random weighted and unweighted trees as well as random caterpillars . </S>"
  ]
}