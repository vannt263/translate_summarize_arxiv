{
  "article_text": [
    "the two  point correlation function of galaxies became one of the most popular statistical tools in astronomy and cosmology .",
    "if the current paradigm , where the initial gaussian fluctuations grew by gravitational instability , is correct , the two  point correlation function of galaxies is directly related to the initial mass power spectrum . while the role of the two  point correlation function is central , estimators for extracting it from a set of spatial points are confusingly abundant in the literature .",
    "we have collected the nine most important forms used in the area of mathematics and astronomy .",
    "the difference between them lies mainly in their respective method of edge correction .",
    "the multitude of choices might appear confusing to the practicing observational astronomer .",
    "the reason is partly due to the lack of a clear criterion to distinguish between the estimators .",
    "for instance one estimator could have smaller variance under certain circumstances , but it could have a bias . therefore , _ before _ doing any numerical experiments , we agreed upon the method of ranking the different estimators .",
    "the cumulative probability distribution of the measured value lying within a certain tolerance of the `` true '' value is going beyond the concepts of bias or variance , and even takes into account any non  gaussian behavior of the statistics .",
    "this is the mathematical formulation of the simple idea that an estimator which is more likely to give values closer to the truth is better . after the above criterion was agreed , the plan to elucidate the confusion was clear .",
    "collect the different forms of estimators ( next section ) , perform a numerical experiment in several subsamples of a large simulation (  3 ) , determining the cumulative probability of measuring values close to the true one , thereby ranking the different estimators (  4 ) .",
    "astrophysical studies favor estimators based on counting pairs , while most of the mathematical research is focused on geometric edge correction ( second subsection ) .",
    "the following subsections collect nine of the most successful and widespread recipes from both genres .",
    "following @xcite ( hereafter ss ) , let us define the pair  counts with a function @xmath1 symmetric in its arguments @xmath2    the summation runs over coordinates of points in the data set @xmath3 and points in the set @xmath4 of randomly distributed points , respectively .",
    "letter _ considers the two point correlation function , for which the appropriate definition is @xmath5 $ ] , where @xmath6 is the separation of the two points , and [ _ condition _ ] equals @xmath7 when _ condition _ holds , @xmath8 otherwise .",
    "@xmath9 and @xmath10 are defined analogously , with @xmath11 and @xmath12 taken entirely from the data and random samples , under the restriction that @xmath13 .",
    "let us introduce the normalized counts @xmath14 , @xmath15 , @xmath16 , with @xmath17 and @xmath18 being the total number of data and random points in the survey volume .",
    "with the above preparation the pairwise estimators used in what follows are the natural estimator @xmath19 , and the estimators due to @xcite @xmath20 , @xcite @xmath21 , @xcite @xmath22 , and @xcite ( hereafter ls ) @xmath23 : @xmath24 note that hewett s estimator could be rendered equivalent with the ls estimator if the original asymmetric definition of @xmath25 is symmetrized ; the version we use is the one consistent with the notation laid out above . in the case of an angular survey , an optimal weighting scheme can be adapted to any of the above estimators ( e.g. , @xcite ) .",
    "this is inversely proportional to the errors expected at a particular pair separation , essentially equivalent to the @xcite weight .",
    "alternative estimates of the two  point correlation function from @xmath17 data points @xmath26 inside a sample window @xmath27 may be written in the form @xmath28 @xmath29 is the volume of the sample window and the sum is restricted to pairs of different points @xmath30 . for a suitably chosen weight function",
    "@xmath31 these edge corrected estimators are approximately unbiased .",
    "such weights are the @xcite ",
    "@xcite weight @xmath32 , the @xcite ",
    "@xcite weight @xmath33 , and the @xcite weight @xmath34 .",
    "@xmath35 where @xmath36 is the fraction of the surface area of the sphere @xmath37 with radius @xmath38 around @xmath39 inside @xmath27 , the set ",
    "covariance @xmath40 is the volume of the intersection of the original sample @xmath27 with the set @xmath41 shifted by @xmath42 , and @xmath43 is the isotropized set  covariance .",
    "we will consider the estimators @xmath44 , @xmath45 , and @xmath46 based on these weights .",
    "a detailed description of these estimators may be found in @xcite and @xcite .",
    "the minus or reduced sample estimator , employing no weighting scheme at all , may be obtained by looking only at the @xmath47 points @xmath48 which are further than @xmath49 from the boundaries of @xmath27 : @xmath50 estimators of this type are used by @xcite .",
    "it can be shown that the natural estimator @xmath19 is the monte ",
    "carlo version of the ohser estimator @xmath51 .",
    "similarly , the geometric counterparts of the ls and hamilton estimator may be constructed @xcite .",
    "this allowed us to cross - check our programs .",
    "focusing on improved number density estimation , @xcite arrived also at the geometrical version of the hamilton estimator .",
    "to compare these estimators for typical cosmological situations we use the cluster catalogue generated from the @xmath52cdm hubble  volume simulation @xcite . in order to investigate the effects of shape , clustering , and the amount of random data used",
    ", we have always varied one parameter at a time , starting from a fiducial sample .",
    "rectangular subsamples were extracted exhausting the full simulation cube : the fiducial cubic subsamples * c * , slices * s * , pencil beams * p * , and cubic samples with cutout holes * h * , all with approximately the same volume and with approximately 430 clusters each .",
    "cutout holes around bright stars , etc . arise naturally in all realistic surveys .",
    "the pattern of holes used for this study was directly mapped from a @xmath53 patch of the edsgc survey to one of the faces of the simulation sub  cube .",
    "then the holes were continued across the subsample , parallel with the sides corresponding to a distant observer approximation .",
    "the physical size of the holes roughly corresponded to a redshift survey at a depth of about @xmath54 .",
    "all these point sets are `` fully sampled '' and may be considered as volume limited samples .",
    "in addition , poisson samples * n * , i.e.   without clustering , were generated .",
    "all calculations employed @xmath55k random points for the pairwise estimators , unless otherwise noted .",
    "this was sufficient for all indicators to converge .",
    "the calculations were repeated for sample * c * with @xmath56k and @xmath57k random points , denoted with * r1 * and * r10 * , respectively , to investigate the speed of convergence of the different estimators with respect to the random point density .",
    "the parameters for the samples are summarized in table  [ table : samples ] .",
    "the two  point correlation function @xmath58 extracted from all clusters inside the @xmath59 cube provided our reference or `` true value '' . since the simulation was carried out with periodic boundary conditions , the cluster distribution is also periodic , therefore the torus boundary correction is exact @xcite .",
    "the nine estimators defined above for the two  point correlation function were determined from each of the @xmath60 subsamples . for a given radial bin @xmath49 we computed the deviation @xmath61 of the estimated two  point correlation function @xmath62 from the reference @xmath63 .",
    "the empirical distribution of these deviations provides an objective basis for the comparison of the utility of the estimators .",
    "the large number of samples enabled the numerical estimation of the probability @xmath64 that the deviation @xmath65 is smaller than a tolerance @xmath66 .",
    "the larger this probability , the more likely that the estimator will be within the predetermined range from one sample . in general",
    "it could happen that the rank of two estimators reverses as the tolerance varies , but as will be shown in the next section , this is quite atypical .",
    "this procedure is more general than considering only bias and variance , which yields only a full description if the above distribution is the integral of a gaussian .",
    "note that a small bias is negligible for practical purposes if the variance dominates the distribution of the deviations .",
    "it is worthwhile to note that gaussian assumption yields a surprisingly good description of the deviations @xmath67 . for estimators of the closely related product density ,",
    "asymptotic gaussianity of the deviations was proven by @xcite .",
    "[ fig : distribution ] shows the distribution @xmath68 for the samples described in table  [ table : samples ] .",
    "three typical scales are displayed to illustrate the general behavior .",
    "the principal conclusions to be drawn are the following : + _ small scales ( @xmath69 ) : _ the effect of any boundary correction scheme becomes negligible , and as expected , all the estimators exhibit nearly identical behavior .",
    "the same is true for the samples * s * , * p * , * n * , and * h * not shown",
    ". however , some of the estimators are more sensitive to the density of random points , especially the hamilton estimator , followed by the davis  peebles estimator .",
    "they show stronger deviations for the * r1 * and * r10 * samples due to the poor sampling of the @xmath25 term ( see also @xcite ) .",
    "this effect persists on large scales as well .    _ intermediate scales ( @xmath70 ) : _ similar to the small scales .",
    "the minus estimator shows stronger deviation becoming even more pronounced for the * s * , * p * , and * h * samples , since the effective remaining volume decreases .",
    "_ large scales ( @xmath71 ) : _ edge corrections are becoming important , and the estimators exhibit clear differences in their distributions of the deviations for the samples * c * , and * n*. for a given probability , the minus estimator shows the largest deviations , followed by the natural , fiksel and ohser estimators .",
    "significantly smaller deviations are obtained for the davis ",
    "peebles and hewett estimators , and yet smaller for the rivolo estimator . finally , the hamilton and ls estimator display the smallest deviations and thus the best edge correction .",
    "the two latter distributions nearly overlap .",
    "the above conclusions are robust and only weakly influenced by the presence of cutout holes , as seen from the * h * sample .",
    "the geometry of the subsamples has a non  trivial effect on the distributions .",
    "while the deviations are increased in the * s * and * p * samples , the differences between the estimators are reduced in the * s * , becoming negligible in the * p * samples . in both cases ,",
    "the minus estimator is not usable any more , since the @xmath47 equal zero , whereas the fiksel estimator is biased for such geometries on large scales ( this is implicitly shown in the work of @xcite ) .",
    "following @xcite the variance of the ls estimator may be calculated for a poisson process : @xmath72 with @xmath73 .",
    "the @xmath74 calculated for the considered samples is also shown in fig .",
    "[ fig : distribution ] to illustrate how much discreteness effects contribute to the distribution of the deviations . for our choice of sample parameters ,",
    "the discreteness contribution , i.e.   the deviation of a corresponding poisson sample , is always within a factor of few of other important contributions to the variance , such as finite volume and edge effects .",
    "in general , the ratio of discreteness effects to the full variance depends in a complicated non  linear fashion on the number of clusters in the sample , the shape of the survey , integrals over the two  point correlation function and its square , and the three and four  point correlation functions ( see @xcite for the exact calculation ) .",
    "varying the side length of the cubic samples from @xmath54 , @xmath75 , @xmath76 to @xmath77 we explored the influence of the size of the sample on the discreteness effects .",
    "still , the rank order of the estimators stayed invariant .",
    "for a sample with 222,052 clusters extracted from the virgo hubble volume simulation a reference two  point correlation function was determined . within over 500 subsamples",
    "several estimators for the two  point correlation function were employed , and the results compared with the reference value . on small scales all the estimators are comparable . on large scales",
    "the ls and the hamilton estimator significantly outperform the rest , showing the smallest deviations for a given cumulative probability .",
    "while the two estimators yield almost identical results for infinite number of random points , the hamilton estimator is considerably more sensitive to the number of random points employed than the ls version . from a practical point of view",
    "the ls estimator is thus preferable .",
    "the rest of the estimators can be divided into three categories : the first runner ",
    "ups are the estimators from rivolo , davis  peebles and hewett , but already with a significantly increased variance .",
    "even larger deviations are present for the natural , fiksel , and ohser recipes .",
    "the minus estimator has the largest deviation . although it was shown that for special point processes both the ls and hamilton estimator are biased @xcite , the present numerical experiment demonstrates that this is irrelevant for the realistic galaxy and cluster point processes , as the bias has an insignificant effect on the distribution of deviations .",
    "@xcite did not recommend one estimator for all cases .",
    "in contrast , through our extensive numerical treatment the ls estimator emerges as a clear recommendation .",
    "the above considerations apply to volume limited samples . when the correlation function is estimated directly from a flux limited sample with an appropriate minimum variance pair weighting ( @xcite )",
    ", the hamilton estimator has the advantage of being independent of the the normalization of the selection function .",
    "the differences between the estimators become smaller for the slice and insignificant for the pencil beam samples . at first sight",
    "this is counter intuitive : the difference between the estimators is largely due to edge corrections , and less compact surveys obviously have more edges . for the large scale",
    "considered , * s * and * p * become essentially two and one  dimensional and the weight @xmath78 is equal for most of the pairs separated by @xmath49 . since the geometric estimators are approximately unbiased they employ mainly the same weight @xmath79 on large scales , and consequently show the same distribution of deviations .",
    "this argument also applies to the pair estimators , since they may be written in terms of these weights @xcite .",
    "all the above numerical investigations are intimately related to the problem of calculating the expected errors on estimators for correlation functions . to include all contributions , such as edge , discreteness , and finite volume effects , the method by @xcite , @xcite , @xcite",
    ", @xcite has to be extended for the two point correlation function .",
    "such a calculation was performed by @xcite , ( see also @xcite , @xcite and @xcite for approximations ) and should be used for ab initio error calculations .",
    "it is worth to mention , that one of the most widely used method in the literature , `` bootstrap '' , is based on a misunderstanding of the concept . for bootstrap in spatial statistics ,",
    "sample takes the role of one point in the original bootstrap procedure .",
    "this means that replicas of the original surveys would be needed to fulfill the promise of the bootstrap method . choosing _ points _",
    "( i.e. individual galaxies , clusters , etc . )",
    "randomly from one sample , as usually done , yields a variance with no obvious relation to the variance sought ( see also @xcite ) .",
    "the role of the random samples is to represent the shape of the survey in a monte ",
    "carlo fashion .",
    "a practical alternative is to put a fine grid on the survey and calculate the quantities @xmath80 , and @xmath81 , where @xmath3 now represents bin  counts and @xmath82 the indicator function taking the value one for pixels inside the survey , and zero otherwise . according to ss ,",
    "all the above estimators have an analogous `` grid '' version ( see also @xcite ) which can be obtained formally by the substitution @xmath83 . in practice grid estimators",
    "can be more efficient than pair counts , and except for a slight perturbation of the pair separation bins , they both yield almost identical results for scales larger than a few pixel size .    the usual way of estimating the power spectrum , using a folding with the fourier transform of the sample geometry is equivalent to the grid version of the ls estimator",
    ". hence , such a power spectrum analysis extracts the same amount of information from the data as the analysis with the two  point correlation function using the grid version of the ls estimator .",
    "the results are only displayed with respect to a different basis .",
    "similarly , karhunen  love ( kl ) modes form another set of basis functions @xcite .",
    "the uncorrelated power spectrum @xcite and the kl modes are the methods of choice for cosmological parameter estimation .",
    "the kl modes allow for a well  defined cut  off , and therefore reduce the computational needs in a maximum likelihood analysis",
    ". however , geometrical features of the galaxy and cluster distribution directly show up in two  point correlation function and may be interpreted easily .",
    "each bin of the two  point correlation function contains direct information on pairs separated by a certain distance , an intuitively simple concept more suitable to study and control ( expected or unexpected ) systematics ( geometry , luminosity , galaxy properties , biases ) than any other representation . in this sense",
    "the correlation function is a tool complementary to the power spectrum .",
    "we are grateful to the virgo supercomputing consortium + http://star-www.dur.ac.uk/$^\\sim$frazerp/virgo/virgo.html[http://star-www.dur.ac.uk/$^\\sim$frazerp/virgo/virgo.html ] , who made the hubble volume simulation data available for our project .",
    "the simulation was performed on the t3e at the computing centre of the max - planck society in garching .",
    "we would like to thank simon white and the referee andrew hamilton for useful suggestions and discussions .",
    "mk would like to thank claus beisbart and dietrich stoyan for interesting and helpful discussions .",
    "is was supported by the pparc rolling grant for extragalactic astronomy and cosmology at durham while there .",
    "mk acknowledges support from the _ sonderforschungsbereich fr astroteilchenphysik sfb  375 der dfg_. as has been supported by nsf ast9802980 and nasa ltsa nag653503 .",
    "j.  m.  colberg , s.  m.  d.  white , t.  j.  macfarland , a.  jenkins , c.  s.  frenk , f.  r.  pearce , a.  e.  evrard , h.  m.  p.  couchman , g.  efstathiou , j.  a.  peacock , and p.  a.  thomas .",
    "1998 , in wide field surveys in cosmology , 14th iap meeting in paris , eds .",
    "s.  colombi and y.  mellier ( chteau de blois : editions frontires ) , 247 .                                                            .",
    "the description of the samples .",
    "@xmath84 , and @xmath85 are the side  lengths of the rectangular samples , @xmath60 is the number of samples exhausting the periodic cube with 222,052 clusters in total , @xmath86 the mean number of clusters inside the samples , and @xmath18 the number of random points used .",
    "[ table : samples ] [ cols= \" < , > , > , > , > , > , > \" , ]"
  ],
  "abstract_text": [
    "<S> nine of the most important estimators known for the two  point correlation function are compared using a predetermined , rigorous criterion . </S>",
    "<S> the indicators were extracted from over 500 subsamples of the virgo hubble volume simulation cluster catalog . </S>",
    "<S> the `` real '' correlation function was determined from the full survey in a @xmath0 periodic cube . </S>",
    "<S> the estimators were ranked by the cumulative probability of returning a value within a certain tolerance of the real correlation function . </S>",
    "<S> this criterion takes into account bias and variance , and it is independent of the possibly non  gaussian nature of the error statistics . as a result for astrophysical applications </S>",
    "<S> a clear recommendation has emerged : the @xcite estimator , in its original or grid version @xcite , are preferred in comparison to the other indicators examined , with a performance almost indistinguishable from the @xcite estimator . </S>"
  ]
}