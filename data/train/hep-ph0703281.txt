{
  "article_text": [
    "in the past , as at present , the central goal of high energy physics is to explore new ranges of energies of interactions .",
    "these new ranges of energies either facilitate the discovery of new particles and interactions or validate the standard model of elementary interactions , as understood today , by extending them to an even broader range of energies ( distances ) than currently available .",
    "the new generation of experiments at the nearly completed large hadron collider ( lhc ) in geneva will be ready soon to take data .    for the proper interpretation of expected new data , an effort in understanding known physics is needed .",
    "in particular , it might be that the signatures of the new physics will have to be deciphered from the background of dominant processes expected from the standard model .    in the case of hadron colliders , description of the standard model processes",
    "is rather complicated ; the colliding hadron beams are not the elementary fields of the standard model but bounded states of quarks and gluons .",
    "even worse , in the low energy limit quantum chromodynamics ( qcd ) looses predictive power and does not control the relations between the hadron wave function and elementary fields representing quarks and gluons .",
    "it is necessary , albeit highly nontrivial , to combine a phenomenological description of low energy strong interaction phenomena with the rigorous perturbative qcd predictions at high energies .",
    "a multitude of techniques have been developed to merge low energy aspects of strong interaction with the high energy calculations from perturbative qcd . in this work",
    "we concentrate on the methodology based on the so - called parton distribution functions ( pdf ) and parton shower monte carlo ( psmc ) .",
    "special attention will be payed to technical aspects , in particular to precision testing of the numerical tools .",
    "we believe that this is very important for the future efforts in minimizing overall systematic errors of the qcd prediction in which psmcs are used .    in this work",
    "we shall concentrate on the question of the evolution equation of the pdf in the monte carlo ( mc ) form .",
    "such an evolution equation for the initial state hadron describes how the pdf responds to an increase of the dimensional , large energy scale @xmath6 , set by the hard process probing the pdf .",
    "the formula for the integrated cross section , which combines the hard process with the matrix element , has been proved within perturbative qcd in a form of the so called _ factorization theorems _ , see for instance refs .",
    "these theorems have been proven starting directly from the feynman diagrams , integrated over the phase space and convoluted with the nonperturbative parton wave function in a hadron .",
    "the evolution equation of the pdf can also be formulated using renormalization group and operator product expansion @xcite .",
    "however , for the real - life practice of the present and future hardon - hadron and hadron - electron collider experiments , one needs a more refined ( exclusive ) picture of the multiparton production , the simplest one being the so called parton shower , governed by perturbative qcd . in principle",
    ", it should reproduce the evolution of pdfs , after integrating it over the lorentz invariant phase space .",
    "if the above is conveniently implemented in the form of the parton shower monte carlo event generator , see for example @xcite , with the inclusion of the parton hadronization process  a very useful feature for the collider experiments .",
    "in the construction of such a psmc the evolution equation of the pdf is used as a guide for defining distributions of the partons emitted from a single energetic hadron ( the initiatial parton in the shower ) directly from the feyman diagrams .",
    "unfortunately it is too difficult . ] .",
    "having in mind the above context , this work has several aims .",
    "the principal aim is to use once again the evolution equation of the pdf in order to model the multiparton parton shower initiated by the single parton located inside the single hadron of the collider beam .",
    "we shall insist that , as in the factorization theorems , this modelling has to be _ universal _ , that is independent from showering of the other hadron beam , spectator partons , and the type of the _ hard process _ of the parton - parton scattering at the large energy scale @xmath7 .",
    "another aim is to define and maintain a clear prescription relating variables in the evolution of the pdf with the four - momenta in the psmc .",
    "we keep in mind that such a psmc will be a _ building block _ to be used for two beams production in hadron collider of the forthcomming paper @xcite .",
    "] , hence the upper limit of the multiparton phase space ( related to @xmath7 ) should allow for smooth coverage of the entire phase space , without any gaps and overlaps .",
    "there is also an important technical problem to be addressed : the off - shell parton entering the hard process has to have predefined energy and flavour matching preferences of the hard process ; hence , a markovian mc ( which is a natural mc implementation of the psmc ) can not be used to model the initial state psmc . however , instead of using the so called _ backward evolution _",
    "@xcite , our choice will be to employ the technique of the _ constrained _ mc ( referred to as cmc technique ) ; that is to generate the multiparton distribution with the restriction on the value of the parton energy and type of the parton .",
    "two distinct versions of this relatively new technique were proposed and tested in refs .",
    "@xcite for the dglap  @xcite evolution in the leading - logarithmic ( ll ) approximation .",
    "the aim of this work is to extend the most promising variant of the above cmc technique to a wider class of evolution kernels , beyond dglap , towards evolution models of the ccfm class  @xcite ; maintaining at the same time the explicit mapping of the evolution variables into four - momenta .",
    "the other important longer term goal is to facilitate the inclusion of the complete nlo corrections by means of the clearer / cleaner modelling of the psmc , as compared with the existing combined nlo and psmc calculations  @xcite .",
    "this will be achieved , for example , by means of better coverage of the phase space in the basic parton shower mc .",
    "the outline of the paper is the following : in section 2 we shall formulate the general formalism of the evolution equations and their solutions in a form suitable for the cmc technique . in section 3",
    "we discuss two particular types of the kernels and related sudakov form - factors .",
    "in section 4 we outline the cmc algorithm for the pure gluonstrahlung segments . in section 5",
    "we shall introduce in the cmc quark gluon transitions . in section 6 results of precision numerical tests of our cmc implementation",
    "will be reported . for testing cmc implementations we shall use auxiliary markovian mc programs which are described and tested in separate papers @xcite .",
    "finally , we summarize the main results ; some technical details will be included in the appendices .",
    "in the following we shall formulate the mathematical framework for the evolution equation and its solutions in a form suitable for the construction of the cmc algorithm in the latter part of the paper .",
    "the generic evolution equation covering several types of evolution reads @xmath8 it describes the evolution of the parton distribution function @xmath9 , where @xmath10 is fraction of the hadron momentum carried by the parton and @xmath11 is the type ( flavour ) of the parton .",
    "the variable @xmath12 is traditionally called an _ evolution time _ and it represents the ( large ) energy scale @xmath6 at which the pdf is probed using a hard scattering process .",
    "the ll dglap case @xcite is covered by eq .",
    "( [ eq : genevoleq ] ) with the following identification @xmath13 where @xmath14 is the standard ll dglap kernel and the factor 2 is related to our definition of the evolution variable @xmath15 .    in the compact operator ( matrix )",
    "notation eq .",
    "( [ eq : genevoleq ] ) reads @xmath16 given a known @xmath17 , the formal solution at any later `` time '' @xmath18 is provided by the time ordered exponential @xmath19 the _ time - ordered exponential _ evolution operator reads . ]",
    "@xmath20 for the sake of completeness , let us write the explicit definition transforms @xmath21 into @xmath10 obeying @xmath22 .",
    "this is due to 4-momentum conservation .",
    "] of the multiplication operation as used and defined in eqs .",
    "( [ eq : op - evoleq]-[eq : torder ] ) : @xmath23 we shall often be dealing with the case of the kernel split into parts , for example : @xmath24 in such a case the solution of eq .",
    "( [ eq : timex ] ) can be reorganized as follows , extends until the formula s end . the use of eq .",
    "( [ eq : clarity ] ) is understood to be adjusted accordingly . ]",
    "@xmath25   { \\bf g}_{{\\bf k}^b}(t_{1},t_{0})\\ ; { \\bf d}(t_0 ) \\\\ & = { \\bf g}_{{\\bf k}^b}(t , t_0)\\ ; { \\bf d}(t_0 ) + \\sum_{n=1}^\\infty   \\left[\\prod_{i=1}^n \\int_{t_{i-1}}^{t}dt_i\\right ]   { \\bf g}_{{\\bf k}^b}(t , t_{n})\\ ;    \\left[\\prod_{i=1}^n      { \\bf k}^a(t_{i})\\ ;      { \\bf g}_{{\\bf k}^b}(t_{i},t_{i-1 } )   \\right ] { \\bf d}(t_0 ) , \\end{split}\\ ] ] where @xmath26 and @xmath27 is the evolution operator of eq .",
    "( [ eq : torder ] ) of the evolution with the kernel @xmath28 . formal proof of eq .  ( [ eq : timex2 ] ) is given in ref",
    ".  @xcite .    in the following we are going to nest eq .",
    "( [ eq : timex2 ] ) twice .",
    "first , we employ it in order to isolate gluonstrahlung and flavour - changing parts of the evolution , exploiting the following split of the kernel @xmath29 in this case @xmath27 represents pure gluonstrahlung and is diagonal in the flavour index . in the standard integro - tensorial notation eq .",
    "( [ eq : timex2 ] ) looks as follows : @xmath30\\ ;     g_{ff}(k^b;t , t_n , x , x_n)\\ ; \\\\ \\times &     \\bigg [ \\prod_{i=1}^n       { \\euscript{k}}^a_{f_if_{i-1}}(t_i , x_i , x'_i)\\ ;       g_{f_{i-1}f_{i-1}}(k^b;t_i , t_{i-1},x'_i , x_{i-1 } ) \\bigg]\\ ;        d_{f_0}(t_0,x_0 ) , \\end{split}\\ ] ] where @xmath31 . in the above and the following equations we adopt the following notation : @xmath32 and @xmath33 similarly , @xmath34 .",
    "the chain of integration variables and flavour indices is depicted schematically in fig .  [",
    "fig : hierarchx ] .",
    "next , eq .  ( [ eq : timex2 ] ) is used in order to resum the virtual ir - divergent part @xmath35 of the gluonstrahlung kernel @xmath36 @xmath37 where @xmath38 is finite ir cut - off , not necessarily infinitesimal . in order to resum ( exponentiate ) the virtual part @xmath35 of the kernel the following version of eq .",
    "( [ eq : timex2 ] ) is employed @xmath39   { \\bf g}_{{\\bf k}^v}(t_{1},t_{0 } ) .",
    "\\end{split}\\ ] ] since @xmath40 is diagonal in @xmath10 , @xmath41 and in the flavour index , and also because of @xmath42 we obtain immediately @xmath43 \\\\&\\times     e^{-\\phi_f(t_b , t_n|x ) }     \\bigg[\\prod_{i=1}^n           { \\euscript{k}}^r_{ff } ( t_i , x_i , x_{i-1 } )            e^{-\\phi_{f}(t_i , t_{i-1}|x_{i-1 } ) } \\bigg ]     \\delta_{x = x_n } ,    \\end{split}\\ ] ] where @xmath44 , @xmath45 and @xmath46 .",
    "the above result can also be obtained by iterating the evolution equation for @xmath47 with the boundary condition @xmath48 , see for instance ref .",
    "@xcite .",
    "the algebra resulting from ( [ eq : timex2 ] ) is quite general and does not rely on any particular form of the kernel .",
    "for example , in the above calculations we did not have to invoke the energy sum rules , or any other specific restrictions on the overall normalization embodied usually in the virtual corrections . also , we did not define yet the relation between the evolution variables @xmath49 and @xmath50 and parton four - momenta .",
    "this will be done in the following section .",
    "before we specify details of the evolution kernels used in this work , let us discuss the relation between the evolution variables @xmath51 , @xmath52 and the emitted parton four - momenta @xmath53 in the corresponding parton shower mc .    in the proofs of the factorization",
    "theorems @xcite and its practical realizations like in ref .",
    "@xcite , typically within @xmath54 scheme , one projects the four - momenta of the ( off - shell ) partons into the 1-dimensional variable of the evolution , typically the dimensionless lightcone variable @xmath10 .",
    "the so - called factorization scale @xmath55 measuring the size of the available parton emission phase space is usually set by the kinematics of the hard process .",
    "the underlying qcd differential distribution ( the qcd matrix element times the phase space ) is reduced to a chain of parton splittings with the @xmath10 variable of the pdf being the fraction of the initial hadron energy @xmath56 carried by the parton entering the hard process .",
    "the variable @xmath57 defines the boundary ( maximum value ) for many ordered variables @xmath49 .",
    "the variable @xmath15 may be related directly to one of the phase space parameters ( virtuality , transverse momentum , angle ) or the abstract dimensional scale variable @xmath58 resulting from the formal procedure of cancelling ir singularities in the dimensional regularization method . in the classical construction of the parton shower mc",
    ", one must invert the above mapping of the phase space variables into the evolution variables ; that is to construct parton four - momenta out of @xmath49 and @xmath50 and to reconstruct fully differential parton distributions in terms of these four - momenta .",
    "obviously this procedure is not unique and requires some guidance from the detailed knowledge of the structure of the ir singularities of the original qcd matrix element .       in this work",
    "we shall construct the cmc algorithm for two new types of generalized kernels , in addition to the ones of ll dglap of eq .",
    "( [ eq : dglap - kernel ] ) for which examples of cmc were already constructed in refs .",
    "@xcite and @xcite .",
    "the new kernels are based on the following generic form @xmath59 where @xmath60 is the standard ll kernel ( dglap ) and @xmath15-dependence enters into it only through the ir regulator @xmath61 .",
    "the new kernel types correspond to different choices of the argument of the strong coupling constant and to different forms of the @xmath61 regulator .",
    "the two new types of the regulator @xmath61 used in this work are depicted on the @xmath62 plane in fig .",
    "[ fig : x - u - plane ] and will be defined in the following section .",
    "the other important departure from dglap is the strong coupling constant @xmath63 which now may depend on all evolution variables .",
    "we shall consider the strong coupling constant @xmath64 depending on @xmath65 or on the transverse momentum @xmath66 defined below . before we define the evolution kernel in a detail , we have to elaborate first the mapping of the evolution variables into four - momenta .      the essential decision in the construction of the parton shower mc concerns the choice of a kinematics variable in the solutions of the evolution equations  ( [ eq : solux ] ) and ( [ eq : evolsolug ] )",
    "; this choice is in one - to - one correspondence with the evolution time variable @xmath49 and the limiting value @xmath15 .",
    "we choose to associate @xmath15 with the rapidity ( angle ) of the emitted parton , following the well known arguments on the colour coherence exposed in many papers , see for instance refs .",
    "@xcite and further references therein .",
    "we define the lightcone variables @xmath67 and normalize the parton momenta with respect to the energy @xmath56 of the initial massless hadron , see fig .",
    "[ fig : kine - evol ] , @xmath68 these relations hold in the rest frame of the hard process system ( hrs ) with the @xmath69-axis along the momentum of initial state hadron @xmath70 .    in particular , for the parton initiating a parton cascade , we have @xmath71 this parton has negligible transverse momentum will be distributed according to a gaussian profile with the width of @xmath72 . ] , @xmath73 . in the hrs",
    "each on - shell @xmath74-th _ emitted particle _ will take away a part of the lightcone variable @xmath75 the above is not enough to define @xmath76 .",
    "for this we need to define at least @xmath77 or the rapidity @xmath78 .",
    "once the azimuthal angle @xmath79 is added , we can complete the mapping from the evolution variables to the 4-momentum of the @xmath74-th emitted parton @xmath80 .    if we associate the evolution time @xmath49 with the rapidity @xmath81 then the following relation @xmath82 valid for @xmath83 , provides the transverse momentum and thus @xmath84 .",
    "we can also eliminate @xmath85 with the help of the following conventional relation which defines the evolution time @xmath15 @xmath86 note that this relation translates into @xmath87 in the general evolution equation of eq .",
    "( [ eq : genevoleq ] ) .",
    "we observe that evolution time @xmath49 and rapidity @xmath81 are related by a linear transformation of the following explicit form : @xmath88 the above relation is the main result of this section .    summarizing",
    ", the mapping of @xmath49 and @xmath50 into 4-momenta @xmath89 , can be written now in an explicit manner : @xmath90    last but not least , we have to define also the phase space limits , @xmath91 and @xmath92 .",
    "one has to be very careful at this step .",
    "the maximum evolution time @xmath93 ( minimum rapidity @xmath94 ) is set by the requirement that all emitted partons are confined to the forward hemisphere , @xmath95 , or equivalently @xmath96 .",
    "this implies @xmath97    the minimum evolution time is determined by the phase space opening point for the first emission , due to minimum transverse momentum @xmath98 : @xmath99 this leads to @xmath100 and therefore to @xmath101 this automatically determines the maximum rapidity @xmath102 altogether @xmath103    let us remark that the naive assignment @xmath104 , without the factor of 2 , would lead , because of eq .",
    "( [ eq : dwojka ] ) , to a partial coverage of the forward hemisphere only , @xmath105 . on the other hand , this factor of 2 may look justified ; the absolute kinematic range of the transverse momentum is @xmath106 , where @xmath107 results from the relation @xmath108 and energy conservation @xmath109 . the reader may notice that this limit is a factor of 2 higher than in the familiar inequality @xmath110 resulting from the 4-momentum conservation operating in both hemispheres simultaneously , i.e. on @xmath111 and @xmath112 .",
    "however , our limit is valid , including the factor of 2 , for a single hemisphere separated from any `` activity '' on the other side !",
    "finally , we illustrate the real emission phase space in fig .",
    "[ fig : sudak0](a ) using the rapidity variable @xmath113 and the log of transverse momentum @xmath66 . directions of the lightcone variables @xmath114 are also indicated . in this figure",
    "we indicate , as black numbered points , momenta of three example emitted partons .",
    "available phase space is limited from below by @xmath98 , while in the direction @xmath115 the boundary is controlled by the total available @xmath116 , which is diminished by the factor @xmath117 at @xmath74-the step ( setting for simplicity @xmath118 ) .",
    "the minimum rapidity @xmath119 limits the emission phase space from the right hand side .",
    "the triangle and trapezoids show integration domains of the consecutive form - factors @xmath120 in eq .",
    "( [ eq : evolsolug ] ) , see also section [ sec : formfactor ] and appendix  [ append : splane ] .    the above mapping of the evolution variables into four - momenta , with the minimum @xmath66 and built - in angular ordering , is identical to the one used in refs .",
    "@xcite , up to the following redefinition of the evolution time : @xmath121 . for the redefined @xmath122 we have @xmath123 and consequently @xmath124 , with @xmath125 .",
    "once the phase - space parametrization is explained , we may define our choices for the evolution kernels , introduced so far only in the generic form in eq .",
    "( [ eq : generic - kernel ] ) .",
    "the kernels to be used in the cmc in this work will be of three kinds .",
    "the main difference between them is in the choice of the variable used as an argument of the coupling constant @xmath64 .",
    "the appearance of the landau pole in @xmath64 will limit the choice of the ir cut - off in the multigluon phase space .",
    "let us define first the gluonstrahlung kernel @xmath126 , where @xmath127 is flavour type , @xmath128 , in all three cases .",
    "the strong coupling constant will be always taken in the ll approximation @xmath129    _ case ( a ) _ : the standard dglap ll of ref .",
    "@xcite , which is used here as a reference case : @xmath130 where @xmath131 is infinitesimally small and @xmath65 .",
    "_ case ( b ) _ : the argument in @xmath64 is @xmath132 ; such a choice was already advocated in the early work of ref .  @xcite . for the ir",
    "cut - off we use @xmath133 , where @xmath134 .",
    "it can not be infinitesimally small , however , it becomes very small at large @xmath15 . using @xmath65",
    "we define @xmath135    _ case ( c ) _ : the coupling constant @xmath64 depends on the transverse momentum @xmath136 , while for an ir cut - off we choose @xmath137 .",
    "the kernel reads : @xmath138    for the ( b ) and ( c ) cases the choice of @xmath139 for the ir cut - off must be such that we avoid the landau pole in  the insertion of the @xmath140 factor to the argument of the coupling constant resums higher order effects in the bremsstrahlung parts of the evolution @xcite . in the non - diagonal ,",
    "flavour - changing , elements of the kernel , there is no need for this kind of resummation .",
    "we can , therefore , use @xmath141 . on the other hand , although quark gluon transition kernel elements have neither ir divergence nor a landau pole , it makes sense to keep the restriction @xmath142 , because the cut - out part of the phase space is ( will be ) already populated by the @xmath66 distribution of the primordial parton .      for the evolution with any type of kernel",
    "the momentum sum rule @xmath143 is imposed , the same as in the reference dglap case .",
    "this sum rule determines unambiguously the virtual part of the kernel for all cases ( a  c ) @xmath144 it should be stressed , that in case ( c ) @xmath145 includes implicitly @xmath146 , as visualized in fig .",
    "[ fig : x - u - plane](b ) . the following sudakov form - factor results immediately : @xmath147 where @xmath148 and @xmath149 .",
    "the @xmath150 is constructed using the ir - singular , non - singular and flavour - changing parts of the dglap ( ll ) kernel according to the following decomposition @xmath151 \\theta_{u - x>\\delta(u)}.\\ ] ] for the list of the coefficients @xmath152 and the functions @xmath153 see appendix of ref .",
    "@xcite .",
    "we also need to define the generalized kernels beyond the case of bremsstrahlung , that is for the quark gluon transitions .",
    "one of the possible extensions , valid for all three cases @xmath154 , reads @xmath155 where @xmath64 in the flavour changing elements has no @xmath69- or @xmath66-dependence and the ir cut - off @xmath156 is the same as in the bremsstrahlung case .",
    "the sudakov form - factors resulting from the above kernels are split into three corresponding parts : @xmath157 in case ( c ) we get three genuinely @xmath41-dependent components @xmath158 where @xmath159 , @xmath160 and function @xmath161 is defined in appendix  [ append : trapez ] in terms of log functions .",
    "the integration domains for the consecutive form - factors of the above type are also shown in a pictorially way in fig .",
    "[ fig : sudak0 ] , using the well known logarithmic sudakov plane .    in case",
    "( b ) the @xmath41 dependence disappears due to the fact that both @xmath162 and @xmath163 depend on @xmath41 exclusively through @xmath65 : @xmath164 in other words , setting @xmath165 brings us from case ( c ) to the case ( b ) .",
    "the reason behind the seemingly at hoc three - fold split of @xmath166 is practical . in the mc",
    "the form - factor has to be calculated event - per - event .",
    "one - dimensional integration for each mc event is acceptable  it does not slow down mc generation noticeably . here , the most singular part of @xmath167 is calculable analytically . in @xmath168",
    "we are able to integrate analytically over @xmath15 and the integration over @xmath69 is done numerically while in @xmath169 we can integrate analytically over @xmath69 and the integration over @xmath15 is has to be done numerically ( see also appendix [ append : mapping ] ) .",
    "altogether , we are thus able to avoid 2-dimensional numerical integration for each mc event ( or use of look - up tables and interpolation for fast evaluation of the sudakov form - factors for each mc event ) .    finally , the form - factors for the simplest dglap ll case read as follows : @xmath170 where @xmath171 .    at present , in the mc implementation , we use for cases ( b ) and ( c ) , a slightly different form of the quark gluon changing kernels elements : @xmath172 that is",
    ", we use the same arguments of @xmath64 as for gluonstrahlung",
    ". we will refer to them as cases ( b ) and ( c ) .",
    "this is done mainly to facilitate numerical comparisons with our markovian mcs .",
    "one can easily go back from cases ( b ) and ( c ) to ( b ) and ( c ) with an extra ( well behaving ) mc weight , if needed .",
    "the corresponding form - factor @xmath173 gets properly redefined in cases ( b ) and ( c ) , of course .",
    "let us discuss the case of pure gluonstrahlung first .",
    "we will focus our attention on the following integral , being part of eq .  ( [ eq : evolsolug ] ) @xmath174 e^{-\\sum_{n=1}^{n+1}\\phi_{f_{i-1}}(t_i , t_{i-1}|x_{i-1 } ) } \\delta_{x = x_n}.    \\end{split}\\ ] ] it describes the emission of @xmath175 gluons .",
    "the following `` aliasing '' of variables is used : @xmath44 , @xmath45 and @xmath46 . the integrand is well approximated by the product of the ir singularities in terms of variables @xmath176 @xmath177 hence , switching from variables @xmath50 to @xmath178 or @xmath179 is almost mandatory and the multigluon distribution with the @xmath180-function constraining the total energy of emitted gluons takes the following symmetric form : @xmath181 constructing the mc program / algorithm for the multidimensional distribution featuring such a @xmath180-function is a hard technical problem and it is the problem of constructing a constrained monte carlo ( cmc ) .    it should be kept in mind , that it is possible , as shown in ref .",
    "@xcite , to generate the above distribution in @xmath10-space without such a @xmath180-function , provided @xmath182 is convoluted with the power - like function @xmath183 .",
    "such a solution was labeled as cmc class ii , while the cmc of this paper was already referred to in ref .",
    "@xcite as cmc class i.    in ref .",
    "@xcite the first cmc algorithm of the class i was found and tested for dglap kernel , that is for our case ( a ) .",
    "this algorithm is based on the observation that for the product of steeply rising functions , proportional to @xmath184 , the @xmath180-function constraint is effectively resolved by a single ( let s say ) @xmath185 , while all _ other _",
    "@xmath178 , can be considered as unconstrained .",
    "we shall extend the cmc class i solution to more complicated kernels , that is of our type ( b ) and ( c ) .",
    "the main complication with respect to case ( a ) is due to a more complicated singular @xmath186-dependence ( or @xmath69-dependence ) entering through the coupling constant @xmath64 , and even more important , through form - factors .",
    "in addition , our new cmcs will not only generalize the solutions of ref .",
    "@xcite , but will be described in such a way that any future extension to other types of evolution kernels will be rather easy . in the following sub - sections we shall present the details of our generalized solutions .",
    "as already indicated , we intend to introduce the formulation of the cmc algorithm which covers three types of kernels ( a  c ) , and also that further extensions are possible and easy . at first , let us consider the following generic expression including the sum of constrained multidimensional integrals @xmath187     \\delta_{\\psi(v)=\\sum_{j=1}^n \\psi(v_j ) } \\bigg\\}.\\ ] ] the following properties will be assumed : ( a )  the function @xmath188 , used to change integration variables , must be monotonous ; its derivative must remain non - negative , @xmath189 , for all @xmath190 .",
    "( b )  the positioning of the ir term . ] @xmath191 at @xmath192 is a convention . in practical mc realization",
    "it represents a no - emission event . ] .",
    "let us stress that in the @xmath193-space we are free to place the position @xmath194 of the ir part of spectrum @xmath195 anywhere outside the @xmath196 interval ; we have opted for @xmath197 ( c )  the variable @xmath198 controlling the overall normalization will be specified only later ; it will be adjusted to get convenient normalization , ( d )  the true upper integration limit of @xmath199 is below @xmath193 and is in fact uniquely determined by the @xmath180-function of the constraint .    in the following examples ,",
    "the variable @xmath199 will be defined as @xmath200 or @xmath201 , while the function @xmath188 will be typically rather simple ; @xmath202 or @xmath203 .",
    "assuming @xmath204 , we can define a mapping ( and its inverse ) which removes @xmath205 from the integrand : @xmath206 our master formula transforms then as follows : @xmath207     \\delta_{\\psi(v)=\\sum_{j=1}^n \\psi(r^{-1}(r_j ) ) } \\bigg\\}.\\ ] ] the function @xmath208 is usually a very steeply growing function of @xmath209 , hence the constraint is effectively resolved by a single @xmath210 , the biggest one .",
    "let us exploit this fact in order to replace the complicated constraint with the simpler one is equal the biggest @xmath211 among @xmath212 .",
    "] @xmath213 .",
    "this is done in three steps .",
    "_ step one : _ introduce a new auxiliary integration variable @xmath214 countered by a @xmath180-function : @xmath215     \\delta_{\\psi(v)=\\sum_{j=1}^n \\psi(r^{-1}(r_j ) ) }     \\delta_{r(v)=x+\\max_j r_j}. \\end{split}\\ ] ] _ step two : _ change the variables @xmath216 : @xmath217     \\delta_{\\psi(v)=\\sum_{j=1}^n \\psi(r^{-1}(r'_j - x ) ) }     \\delta_{r(v)=\\max_j r'_j}. \\end{split}\\ ] ] from now on we have to watch out for the condition @xmath218 explicitly , because we shall get @xmath219 . ]",
    ". _ step three : _ eliminate the old constraint by integrating over @xmath214 @xmath220     \\delta_{r(v)=\\max_j r'_j}\\ ; \\mathfrak{j},\\ ] ] where @xmath221 is found by means of solving numerically ( iterative method ) the original constraint for @xmath214 .",
    "the jacobian factor @xmath222 is defined as follows @xmath223 in the above factor the @xmath11-th term satisfying @xmath224 dominates the sum in the denominator ; consequently @xmath225 .",
    "this form , valid in the limit only , we keep explicitly in the integrand , while the remaining part of @xmath222 is incorporated in a complicated but mild monte carlo weight : @xmath226     \\delta_{\\max_j r'_j = r(v)}\\ ; w^\\#,\\ ] ] where the mc weight is @xmath227    last but not least , we isolate cleanly a part of the integrand normalized properly to 1 with the help of the integration variable @xmath228 and the poisson distribution @xmath229 : @xmath230     \\frac{\\delta_{\\max_j \\xi_j}=1}{n}\\ ;     w^\\#(\\xi),\\ ] ] the nice thing is that @xmath231 , obtained by neglecting @xmath232 , is known analytically @xmath233 and is normalized to 1 : @xmath234 the above convenient unitary normalization is achieved by means of identifying @xmath198 with the upper limit of @xmath193 , see also below for particular realizations . in the implementation of quark gluon transitions using foam  @xcite ( see section  [ sec : completeqg ] ) one introduces the integration variable @xmath235 and the above equation transforms into @xmath236    the mc procedure of generating the variables @xmath193 , @xmath175 and @xmath237 obeying the constraint is the following :    * generate @xmath193 according to @xmath231 times whatever the other function of @xmath193 in the monte carlo problem , for that purpose use the variable @xmath238 . *",
    "if @xmath239 then set @xmath192 and @xmath240 ( no - emission event ) .",
    "* otherwise @xmath241 is translated into @xmath193 ( @xmath190 ) and @xmath242 is generated according to @xmath243 . *",
    "generate the variables @xmath244 , except one of them : @xmath245 , where @xmath246 is chosen randomly with the uniform probability . * the variables @xmath247 are now translated into @xmath248 and the transcendental equation defining the shift @xmath249",
    "is solved numerically .",
    "* once @xmath249 is known , then all @xmath250 are calculated .",
    "* the mc weight @xmath232 is evaluated ; the check on @xmath251 can be done earlier .",
    "the above algorithm generates weighted mc events @xmath252 exactly according to the resumed series of the integrands defining @xmath253 .      in case ( a ) of the dglap kernel , discussed in ref .",
    "@xcite , the @xmath15-ordering in the integrals of eq .",
    "( [ eq : u - brems ] ) can be easily traded for a @xmath254 factor , while @xmath205 in the previous section includes un - ordered integrals @xmath255 over the entire available range for each @xmath49 . however , even in this simple case one has to be careful if one aims not only at the numerical evaluation of the pdf , but also at the proper simulation of the entire mc events @xmath256 .",
    "the cmc class i algorithm of ref .",
    "@xcite ( dglap ) is formulated in terms of @xmath125 ; the point is that at the end of the mc algorithm one has to calculate @xmath50 using a well defined ordering of @xmath179 , which is exactly the same as in the sequence of the ( originally ) un - ordered @xmath49 . in practice , in the end of the mc generation , one has to order @xmath49 and @xmath179 _ simultaneously _ before calculating @xmath257 .",
    "this is because the original integrand is symmetric with respect to interchange of the pairs of variables @xmath258 and not with respect to interchanging @xmath259 or @xmath260 done independently .",
    "this property we will call the _ pairwise _ permutation symmetry .    in our most general case ( c ) , the integrand is not _ pairwise _",
    "symmetric , mainly due to nontrivial @xmath50-dependency in the form - factor , see eq .",
    "( [ eq : u - brems ] ) . in this case",
    ", the strategy is such that we introduce a simplified integrand , with the simplified form - factor and simplified kernel @xmath261 ( the ir - singular part of the kernel ) , such that the simplified integrand does feature the _ pairwise _ permutation symmetry .",
    "the above simplifications are immediately and exactly compensated by means of the mc weight @xmath262 , which absorbs all possible _ pairwise _ non - symmetry .",
    "let us translate what has been said above into rigorous algebra .",
    "we start from a more sophisticated variant of our generic multi - integral ( [ eq : dgener0 ] ) , covering all cases ( a  c ) and possibly other similar cases , but this time including explicitly ordered @xmath15-integrations : @xmath263     w^{\\mathbbm{p}}({\\bf t},{\\bf v})\\ ;     \\delta_{\\psi(v)=\\sum_{j=1}^n \\psi(v_j ) } \\bigg\\ } , \\end{split}\\ ] ] where @xmath264 .",
    "the bold - face variable @xmath265 denotes the entire vector @xmath266 and similar convention is used for the definition of the vector @xmath267 .    in order",
    "to get rid of the @xmath15-ordering in the basic mc algorithm we proceed carefully step by step as follows :    1 .",
    "we introduce formally _ pairwise _ symmetrization , i.e. we sum up over all permutations @xmath268 of the pairs of the variables @xmath269 , compensating by means of the @xmath254 factor : @xmath270    \\theta_{t^{{\\mathfrak{p}}}_n >",
    "t^{{\\mathfrak{p}}}_{n-1 } > ... > t^{{\\mathfrak{p}}}_{1}}\\ ;    w^{\\mathbbm{p}}({\\bf t}^{{\\mathfrak{p}}},{\\bf v}^{{\\mathfrak{p}}}).\\ ] ] 2 .",
    "the part of the integrand in the brackets is now perfectly _ pairwise _ symmetric and the permutation @xmath268 can be undone in this part : @xmath271 \\sum_{{\\mathfrak{p } } }    \\theta_{t^{{\\mathfrak{p}}}_n > t^{{\\mathfrak{p}}}_{n-1 } > ... > t^{{\\mathfrak{p}}}_{1}}\\ ;    w^{\\mathbbm{p}}({\\bf t}^{{\\mathfrak{p}}},{\\bf v}^{{\\mathfrak{p}}}).\\ ] ] 3 .",
    "the sum over permutations @xmath272 can be dropped out because only one permutation contributes at a given point @xmath273 .",
    "this particular permutation we denote by @xmath274 , obtaining : @xmath275     \\delta_{\\psi(v)=\\sum_{j=1}^n \\psi(v_j)}\\ ;     w^{\\mathbbm{p}}({\\bf t}^{{\\mathfrak{p}}_{\\bf t}},{\\bf v}^{{\\mathfrak{p}}_{\\bf t } } ) \\bigg\\}. \\end{split}\\ ] ] 4 .   in the basic mc",
    "the weight @xmath262 is temporarily neglected and @xmath49 are generated unordered .",
    "the permutation @xmath274 is then read from the ordering in @xmath276 .",
    "it is then used to construct the sequence of @xmath50 out of @xmath199 and to calculate @xmath262 .    in order to finally bring eq .",
    "( [ eq : dgener1 ] ) into the standardized form of eq .",
    "( [ eq : dgener0 ] ) we interchange the order of integration over @xmath49 and @xmath199 @xmath277 the additional change of variables @xmath278 allows to map , for every value of @xmath199 , uniformly distributed @xmath279 into @xmath49 .",
    "for a particular realization see appendix  [ append : mapping ] .",
    "luckily , @xmath280 can be inverted analytically , i.e. @xmath281 is available as an analytical formula , for all cases ( a  c ) .",
    "let us start with the particular realization of the above cmc for the easiest case of the dglap kernel , type ( a ) .",
    "such a cmc was exposed in detail already in ref .",
    "@xcite . here",
    "it serves as a reference case and a warm - up example .",
    "we recall the pure bremsstrahlung evolution operator of eq .",
    "( [ eq : evolsolug ] ) in a form adopted for further manipulations : @xmath283 \\\\&\\times     e^{-\\phi_f(t_b , t_n ) }     \\bigg[\\prod_{i=1}^n           \\frac{x_i}{x_{i-1 } }          { \\euscript{k}}^r_{ff } ( t_i , x_i , x_{i-1 } )            e^{-\\phi_{f}(t_i , t_{i-1 } ) } \\bigg ]     \\delta_{x = x_n } ,    \\end{split}\\ ] ] where we have dropped the non - existing dependence on @xmath50 in the form - factor @xmath284 .",
    "hence , one may exploit the relation @xmath285 .",
    "after identification of terms and change of integration variables @xmath286 a simplified expression is obtained : @xmath287     \\delta_{x = u\\prod_{j=1}^n z_j}.    \\end{split}\\ ] ] in the next step , the simplified kernel is introduced @xmath288 once @xmath193 is defined , we are ready to deduce our kernel @xmath205 and constraint function @xmath188 from @xmath289     \\frac{1}{x}\\delta_{\\ln ( x / u ) = \\sum_{j=1}^n \\ln(1-\\exp(v_j))}\\ ;     w_1^{\\bar{{\\mathbbm{p } } } } , \\end{split}\\ ] ] where @xmath290 by means of comparison of the above expressions with eq .",
    "( [ eq : generic2 ] ) , see also eqs . (",
    "[ eq : cum - var],[eq : dgener2 ] ) , one can identify the components : @xmath291 the expression for the basic form - factor can be identified also : @xmath292 the relation @xmath293 is valid for @xmath190 only .",
    "the variable @xmath198 represents the upper boundary of @xmath293 , hence or fixed @xmath10 and maximal @xmath165 we obtain @xmath294 . with all the above elements at hand",
    ", we are able to complete the following standardized , accordingly to conventions of eq .",
    "( [ eq : dgener2 ] ) , formula @xmath295     \\frac{\\delta_{\\max_j \\xi_j=1}}{n}\\ ;     w^\\#(\\mathbf{\\xi})\\ ;     w^{\\mathbbm{p}}({\\bf t}^{{\\mathfrak{p}}_{\\bf t}},{\\bf v}^{{\\mathfrak{p}}_{\\bf t } } )     \\bigg\\}. \\end{split}\\ ] ] where @xmath296 and the second weight @xmath232 is fully determined from eq .",
    "( [ eq : w - hash ] ) , supplemented with @xmath188 and @xmath205 of eq .",
    "( [ eq : kv - a ] ) .    in the cmc ,",
    "we usually integrate over @xmath41 for fixed @xmath10 , hence the following formula is relevant @xmath297     \\frac{\\delta_{\\max_j \\xi_j=1}}{n}\\ ;     w^\\#(\\mathbf{\\xi})\\ ;     w^{\\mathbbm{p}}({\\bf t}^{{\\mathfrak{p}}_{\\bf t}},{\\bf v}^{{\\mathfrak{p}}_{\\bf t } } )     \\bigg\\}. \\end{split}\\ ] ] where . ]",
    "due to relation @xmath299 , the point @xmath192 ( ir boundary ) translates into @xmath300 . with all elements needed in eq .",
    "( [ eq : dgener2 ] ) at hand , we are ready to reconstruct from our generic formulation the complete cmc class i algorithm of ref .",
    "@xcite , at least for pure bremsstrahlung .",
    "this case is to some extent similar to the previous dglap case .",
    "we shall , therefore , concentrate on the differences .",
    "the starting point is now @xmath302 \\\\&\\times     e^{-\\phi_f(t_b , t_n|1 ) }     \\bigg[\\prod_{i=1}^n           \\frac{x_i}{x_{i-1 } }          { \\euscript{k}}^r_{ff } ( t_i , x_i , x_{i-1 } )            e^{-\\phi_{f}(t_i , t_{i-1}|1 ) } \\bigg ]     \\delta_{x = x_n } ,    \\end{split}\\ ] ] where one may again combine form - factors into a single one : @xmath303 .",
    "now , in terms of @xmath304 the simplified expression reads @xmath305     \\delta_{x = u\\prod_{j=1}^n z_j }    \\bigg\\}.    \\end{split}\\ ] ] simplification of the kernel goes as follows : @xmath306 where @xmath307 so far we have followed closely the dglap case , except of the more complicated ir cut - off and the extra factor in the argument of @xmath64 .",
    "the choice of the variable @xmath193 is the same , hence also the function @xmath188 remains unchanged : @xmath308     \\delta_{\\ln(1-e^v ) = \\sum_{j=1}^n \\ln(1-e^{v_j})}\\ ;     w_1^{\\bar{{\\mathbbm{p } } } }     \\bigg\\ } , \\end{split}\\ ] ] where @xmath309 while comparing the above expressions with eq .",
    "( [ eq : generic2 ] ) we immediately identify the following components : @xmath310 in principle , the evaluation of @xmath205 requires a change of the integration order used in the form - factor integral , see also appendix  [ append : mapping ] , @xmath311 in practice , it is slightly easier to calculate @xmath312 with the @xmath15-integration external , and then obtain @xmath205 by differentiation : @xmath313 and @xmath314 the functions @xmath161 and @xmath315 are given in appendices  [ append : trapez ] and [ append : mapping ] .",
    "the rest of the algebra is almost the same as in the case of dglap : @xmath316     \\frac{\\delta_{\\max_j \\xi_j=1}}{n}\\ ;     w^\\#(\\mathbf{\\xi})\\ ;     w^{\\mathbbm{p}}({\\bf t}^{{\\mathfrak{p}}_{\\bf t}},{\\bf v}^{{\\mathfrak{p}}_{\\bf t } } )     \\bigg\\}. \\end{split}\\ ] ] the variable @xmath294 and the weights @xmath232 and @xmath262 are defined in the same way as discussed already in the case ( a ) of dglap .",
    "one has to remember only that @xmath199 enters into @xmath317 .",
    "the final integral form coincides with that for dglap , see eq .",
    "( [ eq : gintega ] ) .",
    "the important differences are in the definitions of the components , in particular , the function @xmath318 is more complicated here .",
    "for this case we are dealing with the most general implementation of the generic solution defined in eq .",
    "( [ eq : evolsolug ] ) : @xmath320     e^{-\\sum_{j=0}^n\\phi_f(t_j , t_{j-1}|x_{j-1 } ) }     \\delta_{x = x_n } ,    \\end{split}\\ ] ] where we are aliasing the following variables : @xmath321 , @xmath322 , @xmath323 and @xmath324 .",
    "the kernel is again more complicated than the one used in the two previous sub - sections @xmath325 with the help of the following transformation of the integration variables @xmath326 we obtain @xmath327     e^{-\\sum_{j=0}^n\\phi_f(t_j , t_{j-1}|x_{j-1 } ) }     \\delta_{x - u=\\sum_{j=1}^n y_j}.    \\end{split}\\ ] ] the simplification for the kernels and form - factor , to be compensated later on by the mc weight , reads as follows : @xmath328 where @xmath329 is that of eq .",
    "( [ eq : phic ] ) . with the above definitions we obtain @xmath330     \\delta_{\\exp(v ) = \\sum_{j=1}^n \\exp(v_j)}\\ ;     w^{\\bar{{\\mathbbm{p } } } }     \\bigg\\ } , \\end{split}\\ ] ] where @xmath331 and @xmath332 the factor @xmath333 is compensating for the deliberate use of @xmath334 in the weight @xmath335 , with the aim of ensuring @xmath336 .",
    "since the simplified kernel @xmath261 is the same as in the previous case ( b ) , the standardized kernel and form - factor are also the same : @xmath337 moreover , the upper phase space boundary is also the same @xmath294 , hence @xmath338 the standardized formula for the mc reads as follows @xmath339     \\frac{\\delta_{\\max_j \\xi_j=1}}{n}\\ ;     w^\\#(\\mathbf{\\xi})\\ ;     w^{\\mathbbm{p}}({\\bf t}^{{\\mathfrak{p}}_{\\bf t}},{\\bf v}^{{\\mathfrak{p}}_{\\bf t } } )     \\bigg\\}. \\end{split}\\ ] ] the final integral , defining the distribution to be implemented in the cmc , takes the following form : @xmath340     \\frac{\\delta_{\\max_j \\xi_j=1}}{n}\\ ;     w^\\#(\\mathbf{\\xi})\\ ;     w^{\\mathbbm{p}}({\\bf t}^{{\\mathfrak{p}}_{\\bf t}},{\\bf v}^{{\\mathfrak{p}}_{\\bf t } } )     \\bigg\\ } , \\end{split}\\ ] ] where . ]",
    "the weight @xmath232 is evaluated according to eq .",
    "( [ eq : w - hash ] ) .",
    "all important differences with the previous cases ( a ) and ( b ) are hidden in the definitions / constructions of the components of the above formula .",
    "the only explicit difference is in the presence of the factor @xmath333 .      .",
    "for three types of the evolution kernel @xmath342 , @xmath154 list of components in the generic eq .",
    "( [ eq : dgener2 ] ) for cmc .",
    "variable @xmath294 is always the same . [",
    "cols=\"^,^,^,^,^,^,^,^,^\",options=\"header \" , ]     before we extend our cmc to the complete evolution with quark gluon transitions , let us summarize the case of pure bremsstrahlung",
    ". as we have seen , all three cases of the kernels ( a  c ) are compatible with the generic formula of eq .",
    "( [ eq : dgener2 ] ) , provided we identify ( define ) properly all components there .",
    "these components are collected and compared in table [ tab : components ] for all three cases ( a  c ) .",
    "the appearance , in case c , of the extra factor @xmath333 should be kept in mind .",
    "@xmath350    they are defined in the following way in @xmath351 reminds us of the type of the parton type @xmath352 used implicitly in the distribution . ]",
    "@xmath353     \\frac{\\delta_{\\max_j \\xi_j}=1}{n } , \\\\ &    \\int\\limits_0 ^ 1du\\ ; \\int_{g(t_b , t_a ) } dg \\equiv 1 . \\end{split}\\ ] ] as in case of @xmath351 , the weight @xmath354 depend on the @xmath15 range ( in the above definition @xmath355 , @xmath356 is used ) . for each occurence of @xmath349 and @xmath357 in ( [ eq : q - g - foam ] ) ,",
    "different @xmath15 range is used , as is seen from the context .",
    "we additionally mark the difference for the later use .    for our three example kernels",
    "we have @xmath358 the summation over the number of quark gluon transitions @xmath175 is also mapped into one of the foam variables , after truncation to a finite @xmath359 .",
    "in fact , the precision level of @xmath360 is achieved for @xmath361 , see numerical results below . following the prescription of ref .",
    "@xcite the sum @xmath362 can be reduced just to a single term . also , as in ref .",
    "@xcite , the additional mapping to the @xmath363 variables is done in order to compensate partly for the @xmath15-dependence of @xmath364 in the @xmath365 kernels .",
    "the purpose of this mapping is to boost slightly the efficiency of foam .",
    "foam generates all @xmath366 variables ( including @xmath175 ) according to the integrand of eq .",
    "( [ eq : q - g - foam ] ) , omitting from it the following mc weight @xmath367 let us stress , that the calculation of this weight can be completed only after gluons are generated for all @xmath368 bremsstrahlung segments first . also , as in ref .",
    "@xcite , foam treats distributions as continuous in @xmath369-variables , ignoring @xmath180-like structure in @xmath370 , corresponding to the no - emission case .",
    "this is very important and powerful method .",
    "the @xmath180-like no - emission terms are replaced by the integrals over finite intervals in @xmath369 , exactly as in eq .",
    "( [ eq;uintegral ] ) .    with all the above formalism at hand",
    ", we can formulate our cmc algorithm similarly as in the general ll dglap case :    * generate super - level variables @xmath175 , @xmath49 @xmath371 and @xmath50 with the help of the general - purpose mc tool foam according to eq .",
    "( [ eq : q - g - foam ] ) , and neglecting @xmath372 .",
    "the parton types @xmath373 are determined from @xmath374 according to prescription of ref",
    ".  @xcite . * in the above , the number of flavour transitions ( @xmath375 and @xmath376 ) is limited to @xmath377 , aiming at the precision of @xmath378 .",
    "* for each @xmath74-th pure gluon bremsstrahlung segment the emissions variables are generated using the dedicated bremsstrahlung cmc of section  [ sec : gluonstrahlung ] , according to eq .",
    "( [ eq : ginteg ] ) .",
    "the weights @xmath379 are calculated . *",
    "generated mc events are weighted with @xmath372 .",
    "they are optionally turned into weight=1 events using the conventional rejection method . *",
    "the four - momenta @xmath84 and @xmath380 are reconstructed out of evolution variables and azimuthal angles .",
    "the above algorithm is already implemented in the form of a program in c++ and tested using upgraded version of the markovian mc of refs .",
    "@xcite and @xcite .",
    "the numerical results are documented in the following section .",
    "most of the numerical tests proving that the new cmcs of this paper work correctly were done by means of comparison with the updated version of the markovian mc program mmc @xcite , which is a descendant of that described in refs .",
    "@xcite . the version of mmc used below implements exactly the same type evolution with exactly the same kernels and boundary conditions .",
    "we can therefore expect numerical agreement of cmc and mmc to within statistical mc error , which will be of the order of @xmath0 , for about @xmath381 mc events ( and for about @xmath382 different values of @xmath10 in a single mc run ) .",
    "we start , however , with the simple tests in which we verify the correctness of the mapping of the evolution variables into four - momenta . in fig .",
    "[ fig : cmiktrap ] the distribution of rapidity and @xmath383 of the emitted gluons is shown .",
    "sharp cut - offs corresponding to the minimum rapidity @xmath384 ( maximum @xmath15 ) and minimum @xmath385  gev are clearly visible in the plot .",
    "note that this plot shows the same triangular area of the logarithmic sudakov plane as in fig .",
    "[ fig : sudak0](a ) , but now populated with the mc events .",
    "we examine results of the evolution from the initial energy scale @xmath386 gev up to final energy scale of @xmath387  tev , using exactly the same initial quark and gluon distributions in a proton at the @xmath388  gev scale as in ref .",
    "@xcite ( they were also used in ref .",
    "@xcite ) .    in fig .",
    "[ fig : cmcifdlnxg ] the distributions of gluons at @xmath387  tev are shown , while in fig .",
    "[ fig : cmcifdlnxq ] the corresponding results for quarks , @xmath389 , are exposed , also at the same high energy scale @xmath387tev .",
    "numerical results are provided for the evolution type ( c ) ( see section [ sec : kernels ] ) , that is for @xmath319 and the evolution time being identical with the rapidity of the emitted particle . in these two figures",
    "we compare the gluon and quark distributions obtained from the current cmc program and from the updated mmc program @xcite .",
    "the principal numerical results from both programs , marked as `` total '' in the upper plot of both figures , are indistinguishable .",
    "we therefore plot their ratio in the lower plot of both figures .",
    "the parton distributions from the cmc and mmc programs _ agree perfectly _ , within the statistical errors of @xmath390 in the entire range of @xmath10 . in the same plots we include individual contributions from a fixed number of the quark gluon transitions @xmath377 , and their ratios .",
    "again very good agreement between cmc and mmc results is seen , which affect total result at the @xmath391 level can be traced back to well understood inefficiencies of foam at higher dimensions . ] .",
    "it should be stressed that the mmc program has been tested numerically at the same @xmath390 precision level for all types of the kernels ( a  c ) by comparison with the semi - analytical ( non - mc ) program apcheb  @xcite .",
    "in addition , for the dglap case , mmc was also successfully compared with another non - mc program qcdnum16  @xcite .",
    "these dedicated tests of mmc using non - mc programs will be published separately in the forthcoming paper  @xcite .    additionally , in figs .  [ fig : cmcifexclg ] and [ fig : cmcifexclq ] , we show comparisons of selected ( semi-)exclusive distributions from cmc and mmc , i.e. we have chosen for the test the distributions of the consecutive evolution time variables @xmath392 , the energy fractions @xmath50 and the total parton emission multiplicity from both cmc and mmc .",
    "the above distributions resulting from separate cmc and mmc runs are interposed  no visible difference is seen within the resolution of the plots .",
    "the above plots are for a final parton being a gluon in fig .",
    "[ fig : cmcifexclg ] and a quark in fig .",
    "[ fig : cmcifexclq ] . in these plots",
    "one is testing a nontrivial aspect of the cmc algorithm related to removing and restoring the @xmath15-ordering described in section [ sec : torder ] .",
    "in fact , any departure from the _ pairwise _ ordering procedure described in section [ sec : torder ] would ruin the agreement of cmc and mmc seen in figs .",
    "[ fig : cmcifexclg ] and [ fig : cmcifexclq ] ! the weight distribution from cmc is also shown in the lower part of these figures .",
    "all the above tests were done for the most interesting case of cmc with the kernel ( c ) .",
    "what about numerical tests for cases ( a ) and ( b ) ?",
    "in ref.@xcite numerical agreement within @xmath390 statistical error between cmc and mmc for the ll dglap case ( a ) was already documented .",
    "while preparing this work , we have compared cmc and mmc for case ( b ) , @xmath393 , obtaining equally good numerical agreement .",
    "the corresponding plots look quite similar to these in fig .",
    "[ fig : cmcifdlnxg ] and fig .",
    "[ fig : cmcifdlnxq ] .",
    "we have generalized the constrained monte carlo algorithm of ref .",
    "@xcite from dglap to two other more complicated types of the evolution equations , one of them fully compatible with the ccfm evolution equation @xcite .",
    "the above extentions of the cmc algorithm are implemented in the computer program cmc , tested by comparisons it with the markovian mc , which also solves exactly the same evolution equations .",
    "let us point out that the most complicated version ( c ) of the evolution equation elaborated in this work follows closely the ccfm model as formulated in @xcite ( except for the temporarily omitted non - sudakov form - factors ) .",
    "its markovian mc implementation smallx was worked out in refs .",
    "@xcite , and later on exploited in the construction of the cascade mc of ref .",
    "@xcite , which is based on the backward evolution algorithm @xcite .",
    "our cmc program was tested against our own markovian mc , see previous section .",
    "however , it would be interesting to compare it also with the above smallx and cascade programs .",
    "we hope this will be done in the near future .    since the cmc program of this work will be used as a building block in the mc event generator for the drell  yan type processes and deep inelastic lepton - hadron scattering , the explicit mapping of the evolution variables into four - momenta of the emitted particles is also defined , implemented and tested .",
    "the evolution time is mapped into the rapidity variable ( angular ordering ) .",
    "a sharp cut - off is imposed on the @xmath66 and rapidity of the emitted particle .",
    "the sharp cut - off in the rapidity will be useful when combining two cmcs for two colliding initial state hadrons , with neither gaps nor overlaps in the emission phase space .",
    "the cmc algorithm was worked out in detail and tested for three types of the evolution kernels and the phase  space limits .",
    "it was purposely defined / described in such a way that it can be easily generalized to other types of the evolution kernels . in the following works it will be used as a component in the mc modelling of the initial state parton shower for showering of a single hadron in a more complete mc project for lhc .    *",
    "acknowledgments * + we would like to thank k. golec - biernat for the useful help and discussions .",
    "we acknowledge the warm hospitality of the cern physics department , where part of this work was done .",
    "* appendix *",
    "the simplest component function in the sudakov formactor in cases ( b ) and ( c ) of @xmath69-dependent @xmath64 reads as follows @xmath395 + { { \\bar{t}}}_\\lambda\\ } , \\label{eq : rho}\\ ] ] where @xmath139 defines the ir cut - off . here and in the following , we follow certain notation rules allowing us to write the above and similar functions in a compact way :    1",
    ".   for all variables like @xmath15 , @xmath355 and @xmath396 bar over them means @xmath397 , @xmath398 , @xmath399 , etc . , where @xmath400 is that in eq .",
    "( [ eq : alpha ] ) , i.e. the position of the landau pole .",
    "2 .   occasionally we shall omit the explicit dependence on @xmath401 , that is we always understand @xmath402 .",
    "we always understand that @xmath403 when @xmath404 .      the following similar integral , with the same integrand , but slightly different triangular integration area , depicted in fig .",
    "[ fig : sudak - rho1 ]  ( b ) , can be expressed using the same function @xmath394 : @xmath405      the other basic ir - singular component function in the sudakov form - factor reads @xmath406 the corresponding integration area is the trapezoid depicted in fig .",
    "[ fig : sudak - rho2 ]  ( a ) .",
    "the above calculation result is obvious if one notices that the trapezoid is the difference of two overlapping triangles .",
    "similarly , the following integral with the trapezoid integration area of fig .  [ fig : sudak - rho2 ]  ( a ) is again expressed in terms of the functions already defined above @xmath407}_2(v_x,{{\\bar{t}}}_a,{{\\bar{t}}}_b;{{\\bar{t}_\\lambda } } )   & = \\int^{{{\\bar{t}}}_b}_{{{\\bar{t}}}_a } d { { \\bar{t}}}\\int^{v_x } d v       \\frac{\\theta_{{{\\bar{t}}}+ v > \\bar",
    "t_{\\lambda}}}{{{\\bar{t}}}+ v } \\\\ &   = \\theta_{{{\\bar{t}}}_b>{{\\bar{t}}}_a } \\{\\varrho({{\\bar{t}}}_a+v_x;{{\\bar{t}_\\lambda } } ) -\\varrho({{\\bar{t}}}_b+v_x;{{\\bar{t}_\\lambda}})\\ } = \\varrho_2({{\\bar{t}}}_a+v_x,{{\\bar{t}}}_b+v_x;{{\\bar{t}_\\lambda } } ) . \\label{eq : rho2d } \\end{split}\\ ] ]",
    "let us stress that keeping @xmath408 in the basic function @xmath394 of eq .",
    "( [ eq : rho ] ) is essential for validity of the evaluation of all the following related functions and integrals .",
    "let us evaluate now the following integral , which is similar to @xmath161 , except that we insert into the integrand the additional function @xmath409 : @xmath410}_2(v_x,{{\\bar{t}}}_a,{{\\bar{t}}}_b;{{\\bar{t}_\\lambda } } )     = \\int^{{{\\bar{t}}}_b}_{{{\\bar{t}}}_a } d { { \\bar{t}}}\\int^{v_x } d v \\ ;      \\frac{\\theta_{{{\\bar{t}}}+ v > \\bar t_{\\lambda}}}{{{\\bar{t}}}+ v } f(v,{{\\bar{t } } } ) .",
    "\\label{eq : rho2f}\\ ] ] of course , for @xmath411 we recover @xmath161",
    ". however , even in this case the following evaluation of @xmath412}_2 $ ] will be interesting , because we shall swap the integration order and introduce variable mapping , exactly the same as we have used for finding out @xmath205 and eliminating @xmath205 through the additional mapping @xmath413 .",
    "such a swapping integration order is also used for evaluation of the non - ir part of the bremsstrahlung integral and flavour changing contributions , where we have @xmath414 , hence the inner integration over @xmath415 can be done analytically and the outer one over @xmath193 is done numerically .    in a general case , after swapping the integration order @xmath410}_2(v_x,{{\\bar{t}}}_a,{{\\bar{t}}}_b;{{\\bar{t}_\\lambda}})= \\int\\limits_{{{\\bar{t}}}_{\\lambda } - { { \\bar{t}}}_b}^{v_x } dv   \\bigg\\ {     \\theta_{v_x < { { \\bar{t}}}_{\\lambda } - { { \\bar{t}}}_a }        \\int\\limits_{{{\\bar{t}}}_{\\lambda } - v_x}^{{{\\bar{t}}}_b } d{{\\bar{t}}}\\ ; \\frac{1}{{{\\bar{t}}}+ v }   + \\theta_{v_x > { { \\bar{t}}}_{\\lambda } - { { \\bar{t}}}_a }        \\int\\limits_{{{\\bar{t}}}_a}^{{{\\bar{t}}}_b }                d{{\\bar{t}}}\\ ; \\frac{1}{{{\\bar{t}}}+ v } \\bigg\\ } f ( v , { { \\bar{t}}})\\ ] ] the integration is split into two parts , first for the triangle and second for the rectangle integration area , see fig .",
    "[ fig : sudak - rho2f ] for illustration .",
    "the above change of the integration order was also exploited by the authors of herwig mc  @xcite .",
    "the internal integral can be transformed using the identities : @xmath416}_2(v_x,{{\\bar{t}}}_a,{{\\bar{t}}}_b ) = \\partial_{v_x}\\varrho^{[1]}_2(v_x,{{\\bar{t}}}_a,{{\\bar{t}}}_b;{{\\bar{t}_\\lambda } } ) \\\\&~~~~~~~~~~~ = \\theta_{v_x>{{\\bar{t}}}_{\\lambda}-{{\\bar{t}}}_a }     [ \\varrho'({{\\bar{t}}}_b+v_x)-\\varrho'({{\\bar{t}}}_a+v_x ) ] + \\theta_{v_x<{{\\bar{t}}}_{\\lambda}-{{\\bar{t}}}_a }      \\varrho'({{\\bar{t}}}_b+v_x ) , \\end{split}\\ ] ] to the following convenient form @xmath417}_2(v_x,{{\\bar{t}}}_a,{{\\bar{t}}}_b;{{\\bar{t}_\\lambda } } ) & = \\int\\limits_{{{\\bar{t}}}_{\\lambda } - { { \\bar{t}}}_b}^{v_x } dv\\ ; \\varrho'^{[1]}_2(v,{{\\bar{t}}}_a,{{\\bar{t}}}_b ) \\int\\limits_0 ^ 1       d\\left(\\frac{\\ln({{\\bar{t}}}+v)}{\\varrho'^{[1]}_2(v,{{\\bar{t}}}_a,{{\\bar{t}}}_b ) } \\right ) f ( v , { { \\bar{t } } } ) \\\\ & = \\varrho'^{[1]}_2(v_x,{{\\bar{t}}}_a,{{\\bar{t}}}_b )    \\int\\limits_0 ^ 1 d\\xi(v )   \\int\\limits_0 ^ 1 d\\sigma(v,{{\\bar{t}}})\\ ; f ( v , { { \\bar{t } } } ) , \\end{split}\\ ] ] where @xmath418}_2(v,{{\\bar{t}}}_a,{{\\bar{t}}}_b)}{\\varrho^{[1]}_2(v_x,{{\\bar{t}}}_a,{{\\bar{t}}}_b)},\\quad \\sigma(v,{{\\bar{t } } } ) = \\frac{\\ln({{\\bar{t}}}+v)}{\\varrho'^{[1]}_2(v,{{\\bar{t}}}_a,{{\\bar{t}}}_b)}.\\ ] ] the above mapping is used in the bremsstrahlung cmc in cases ( b ) and ( c ) . in this context one also needs to perform the inverse mapping @xmath419 , which requires numerical inversion of @xmath420}_2(v,{{\\bar{t}}}_a,{{\\bar{t}}}_b)$ ] as a function of @xmath193 .",
    "once @xmath193 is known , the second inverse mapping @xmath421 is easily implemented , as it can be formulated in a fully analytical form .",
    "as already indicated , a very similar variant of the above integration order is used in the evaluation of the non - ir and flavour - changing parts of the sudakov form - factor .",
    "finally , let us relate the phase space @xmath193 and @xmath15 used in the calculation of the form - factor above with the sudakov plane in @xmath422 and the rapidity @xmath113 .",
    "this is done in the pictorial way in fig .",
    "[ fig : sudak0 ] , where we depict a situation with three emission , underlining the trapezoid integration domain for the sudakov function @xmath423 .",
    "this is show on the right hand side of the figure , as the trapezoid marked by @xmath424 , in the plane of @xmath15 and @xmath193 . on the left hand side of this figure ,",
    "the corresponding trapezoid is seen in the plane of @xmath422 and rapidity @xmath113 .",
    "let us remind the reader that in the case ( c ) we define @xmath425 and the rapidities @xmath81 are related to the evolution times @xmath49 with the simple linear transformation of eq .",
    "( [ eq : dwojka ] ) in sec .",
    "[ sec : kinema ] .",
    "j.  c. collins , d.  e. soper , and g.  sterman , _ nucl .",
    "b250 * ( 1985 ) 199 . g.  t. bodwin , _ phys .",
    "* d31 * ( 1985 ) 2616 .",
    "r.  ellis , w.  stirling , and b.  webber , _ qcd and collider physics_. cambridge university press , 1996 .",
    "t.  sjostrand _ et al .",
    "_ , _ comput .",
    "commun . _ * 135 * ( 2001 ) 238259 , http://www.arxiv.org/abs/hep-ph/0010017[hep-ph/0010017 ]",
    ". g.  corcella _ et al .",
    "_ , _ jhep _ * 01 * ( 2001 ) 010 , http://www.arxiv.org/abs/hep-ph/0011363[hep-ph/0011363 ] . s.  jadach _ et al .",
    "_ , in preparation .",
    "t.  sjostrand , _ phys .",
    "lett . _ * b157 * ( 1985 ) 321 .",
    "s.  jadach and m.  skrzypek , _ comput .",
    "commun . _ * 175 * ( 2006 ) 511527 , http://www.arxiv.org/abs/hep-ph/0504263[hep-ph/0504263 ] . s.  jadach and m.  skrzypek , _ acta phys .",
    "polon . _ * b36 * ( 2005 ) 29793022 , http://www.arxiv.org/abs/hep-ph/0504205[hep-ph/0504205 ] .",
    "s.  jadach and m.  skrzypek , report cern - ph - th/2005 - 146 , ifjpan - v-05 - 09 , _ contribution to the hera  lhc workshop , cern  desy , 20042005 , http://www.desy.de/@xmath426heralhc/_ , http://www.arxiv.org/abs/hep-ph/0509178[hep-ph/0509178 ] .",
    "lipatov , _ sov .",
    "phys . _ * 20 * ( 1975 ) 95 ; + v.n .",
    "gribov and l.n .",
    "lipatov , _ sov .",
    "phys . _ * 15 * ( 1972 ) 438 ; + g. altarelli and g. parisi , _ nucl .",
    "_ * 126 * ( 1977 ) 298 ; + yu .",
    "l. dokshitzer , _ sov .",
    "* 46 * ( 1977 ) 64 .",
    "s.  frixione and b.  r. webber , _ jhep _ * 06 * ( 2002 ) 029 , http://www.arxiv.org/abs/hep-ph/0204244[hep-ph/0204244 ] . s.  frixione and b.  r. webber , http://www.arxiv.org/abs/hep-ph/0601192[hep-ph/0601192 ] .",
    "s.  jadach _ et al .",
    "_ , in preparation .",
    "s.  jadach , m.  skrzypek , and z.  was , http://www.arxiv.org/abs/hep-ph/0701174[hep-ph/0701174 ] .",
    "k.  golec - biernat , s.  jadach , w.  placzek , and m.  skrzypek , _ acta phys .",
    "polon . _ * b37 * ( 2006 ) 17851832 , http://www.arxiv.org/abs/hep-ph/0603031[hep-ph/0603031 ] .",
    "j.  c. collins and d.  e. soper , _ nucl .",
    "* b193 * ( 1981 ) 381 .",
    "g.  curci , w.  furmanski , and r.  petronzio , _ nucl .",
    "phys . _ * b175 * ( 1980 ) 27 .",
    "a.  h. mueller , _ phys .",
    "_ * b104 * ( 1981 ) 161164 .",
    "s.  catani , b.  r. webber , and g.  marchesini , _ nucl .",
    "* b349 * ( 1991 ) 635654 .",
    "y.  dokshitzer , v.  khoze , a.  mueller , and s.  troyan , _ basics of perturbative qcd_. editions frontieres , 1991 .",
    "g.  marchesini and b.  r. webber , _ nucl .",
    "_ * b349 * ( 1991 ) 617634 .",
    "g.  marchesini and b.  r. webber , _ nucl .",
    "* b349 * ( 1991 ) 617634 .",
    "g.  marchesini , _ nucl .",
    "* b445 * ( 1995 ) 4980 , http://www.arxiv.org/abs/hep-ph/9412327[hep-ph/9412327 ] .",
    "d.  amati , a.  bassetto , m.  ciafaloni , g.  marchesini , and g.  veneziano , _ nucl .",
    "phys . _ * b173 * ( 1980 ) 429 .",
    "s.  jadach , _ comput .",
    "* 152 * ( 2003 ) 55100 , http://www.arxiv.org/abs/physics/0203033[physics/0203033 ] .",
    "s.  jadach and m.  skrzypek , _ acta phys .",
    "* b35 * ( 2004 ) 745756 , http://www.arxiv.org/abs/hep-ph/0312355[hep-ph/0312355 ] .",
    "k.  golec - biernat , the fortran code to be obtained from the author , unpublished ."
  ],
  "abstract_text": [
    "<S> with the imminent start of lhc experiments , development of phenomenological tools , and in particular the monte carlo programs and algorithms , becomes urgent . </S>",
    "<S> a new algorithm for the generation of a parton shower initiated by the single initial hadron beam is presented . </S>",
    "<S> the new algorithm is of the class of the so called `` constrained mc '' type algorithm ( an alternative to the backward evolution mc algorithm ) , in which the energy and the type of the parton at the end of the parton shower are constrained ( predefined ) . </S>",
    "<S> the complete kinematics configurations with explicitly constructed four momenta are generated and tested . </S>",
    "<S> evolution time is identical with rapidity and minimum transverse momentum is used as an infrared cut - off . </S>",
    "<S> all terms of the leading - logarithmic approximation in the dglap evolution are properly accounted for . </S>",
    "<S> in addition , the essential improvements towards the so - called ccfm / bfkl models are also properly implemented . </S>",
    "<S> the resulting parton distributions are cross - checked up to the @xmath0 precision level with the help of a multitude of comparisons with other mc and non - mc programs . </S>",
    "<S> we regard these tests as an important asset to be exploited at the time when the presented mc will enter as a building block in a larger mc program for @xmath1 production process at lhc .    </S>",
    "<S> * ifjpan - iv-2007 - 3 + cern - ph - th/2007 - 059 *    * constrained mc for qcd evolution + with rapidity ordering and minimum kt@xmath2 *    * s.  jadach@xmath3 , w.  paczek@xmath4 , m.  skrzypek@xmath3 * , + * p.  stephens@xmath5 * and * z.  was@xmath3 *     +   +    _ submitted to computer physics communications _    * ifjpan - iv-2007 - 3 + cern - ph - th/2007 - 059 + march  2007 *    @xmath2this work is partly supported by the eu grant mtkd - ct-2004 - 510126 in partnership with the cern physics department and by the polish ministry of scientific research and information technology grant no 620/e-77/6.pr ue / die 188/2005 - 2008 . </S>"
  ]
}