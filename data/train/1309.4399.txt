{
  "article_text": [
    "in this section we shortly review the theoretical background of the chopped random basis ( crab ) method in the context of our current work , and furthermore describe the optimization procedures and the numerical results .",
    "the crab method designs the control @xmath7 by correcting an initial guess @xmath84 with an optimized continuous function  @xmath85 , following  .",
    "we use here a simple constant initial guess  . following  @xcite ,",
    "the correcting function  @xmath85 is expanded into a fourier - like basis function , @xmath86 where @xmath87 denotes a number of basis expansion having @xmath87-randomized discrete frequencies .",
    "it is noteworthy to state that the range of frequencies  @xmath88 directly corresponds to the real bandwidth of the apparatus .",
    "therefore , we can pre - set in advance the frequency range for numerical optimization to meet the experimental limitations , e.g. the amplifier s or arbitrary waveform generator s working bandwidth .",
    "the additional function @xmath89 , is used to impose the control boundary such that   at the initial time  @xmath90 , and the final time  @xmath31 . here",
    ", we choose the bounding function  , where  @xmath91 .",
    "using this function we can also qualitatively vary the rising and falling times of the microwave control by adjusting the even - numbered parameter @xmath92 .",
    "our optimization objective is to find the set of crab parameters  , which minimizes the figure of merit ,  , where the quantity @xmath93 is the fidelity of the final state @xmath32 , against the desired state @xmath33 .",
    "a dimensionless parameter  @xmath94 is incorporated in the figure of merit to limit the control amplitude during optimization .",
    "we employ the direct search simplex ( nelder - mead ) algorithm to find the optimal crab parameters .",
    "the numerical optimization is initiated by setting some parameters obtained from the experimental preparations and apparatus calibrations : the measured larmor transition @xmath42 , the maximum control amplitude  , and the crab frequency range . the control time is fixed ( the same as the desired rotation time ) to be faster than the extrapolated rotation time if the rwa would be valid , e.g. for the spin   we have  , where  @xmath95 is the extrapolated rabi frequency ( see figure 1c ) . however , the time in our case is limited by the minimum time of the theoretically proposed optimal _ bang - bang _ control ,  , where the control @xmath7 takes only a constant value of @xmath96 for a certain time interval @xcite .      1 .   perform the parallel simplex search algorithm with an @xmath97 number of random initial values of the crab parameters for @xmath98 small positive real numbers of  @xmath99 , and @xmath100 positive small integers @xmath101 , typically @xmath102 and @xmath103 .",
    "obtain from step 1 @xmath104 sets of crab parameters , than construct @xmath104 numbers of control pulses @xmath105 .",
    "3 .   investigate the numerical values of @xmath106 and @xmath107 for each pulse , and pick the best one out of @xmath104 pulses which satisfies @xmath108 and @xmath109 .",
    "the preset quantities @xmath110 and @xmath111 are the numerical infidelity and the maximum control amplitude , respectively .",
    "if the best pulse can not be obtained , return to step 1 with different values of @xmath99 and increase @xmath112    the actual numerical calculations were carried out on the bwgrid cluster where we utilized its multi - nodes multi - cores ( 8 cores per node ) computational features to run the parallel nelder - mead searches that corresponds to various experimental parameters and random initial values . to find a single parallel sample in one - core , i. e. one set of crab optimized parameters , the typical computational time required to meet",
    "the experimentally acceptable fidelity is approximately less than 30 minutes .",
    "this allows one to perform a single optimization run in just a decent commercial personal computer .",
    "hence , it is feasible in the future to apply our numerical crab optimization in standard close - loop control system involving directly the control apparatuses . for both cases of @xmath113rotation and @xmath114rotation",
    "we set the parameters as the following : @xmath115 , @xmath116 , @xmath117  mhz , and @xmath118 mhz .",
    "we present the best obtained crab parameters for each rotation in table [ tabledata ] , while the corresponding mw pulses are shown in figure [ crap_pulseshape ] .",
    ".the optimal crab parameters obtained via the nelder - mead simplex algorithm for @xmath1- and @xmath119-rotations .",
    "the corresponding mw - crab pulses are shown in fig .",
    "[ crap_pulseshape ] . [ cols=\"^,^,^,^,^,^ \" , ]"
  ],
  "abstract_text": [
    "<S> ultra fast and accurate quantum operations are required in many modern scientific areas - for instance quantum information , quantum metrology and magnetometry . </S>",
    "<S> however the accuracy is limited if the rabi frequency is comparable with the transition frequency due to the breakdown of the rotating wave approximation ( rwa ) . here </S>",
    "<S> we report the experimental implementation of a method based on optimal control theory , which does not suffer these restrictions . </S>",
    "<S> we realized the most commonly used single qubit rotations - the hadamard ( @xmath0 pulse ) and not ( @xmath1 pulse ) gates with fidelity ( @xmath2 and @xmath3 ) , in an excellent agreement with the theoretical predictions ( @xmath4 and @xmath5 ) . </S>",
    "<S> moreover , we demonstrate magnetic resonance experiments both in the rotating and lab frames in this strong driving regime and we can deliberately `` switch '' between these two frames . since our technique is general , it could find a wide application in magnetic resonance , quantum computing , quantum optics and broadband magnetometry .    the ability to manipulate spins very fast allows to increase the number of qubit operations before detrimental effects of decoherence </S>",
    "<S> take place , and it may further increase the bandwidth of spin based magnetometers . </S>",
    "<S> optimal control theory @xcite provides powerful tools to work in this regime by finding the optimal way to transform the system from the initial to the desired state with a high fidelity . here </S>",
    "<S> we demonstrate precisely controlled ultra - fast ( beyond rwa ) single electron spin gates using specially designed microwave fields , without resorting to the standard rwa condition . to achieve this </S>",
    "<S> we employ optimal control namely the chopped random basis  ( crab ) quantum optimization algorithm  @xcite . </S>",
    "<S> it is used to numerically design and optimize our microwave control ( see supplementary information for more details ) . </S>",
    "<S> our current algorithm uses a simple derivative - free direct search method to perform a multivariable function optimization  @xcite , and hence offers enhanced computational flexibility such as parallel numerical calculations .    </S>",
    "<S> here we implement this method using the electron spin associated with a single nitrogen - vacancy center ( nv ) in diamond as a test system . </S>",
    "<S> nv shows remarkable physical properties : optical spin initialization and readout of a single center at room temperature  @xcite , coherent spin control via microwaves ( mw )  @xcite , and a coherence time of several milliseconds  @xcite . </S>",
    "<S> this system is very promising as a nano - scale ultra sensitive magnetometer  @xcite and solid state qubit  @xcite . </S>",
    "<S> strongly driven dynamics of nv using conventional pulses has been also reported  @xcite , where fast flipping of the nv s electron spin has been demonstrated .    </S>",
    "<S> the nv consists of a substitutional nitrogen atom and an adjacent vacancy with a triplet ground state ( @xmath6 ) and a strong optical transition , enabling the detection of single centers . </S>",
    "<S> its fluorescence depends on the electron spin state , allowing one to perform coherent single spin control  @xcite . </S>",
    "<S> the hamiltonian of the nv s ground state in the presence of mw control  @xmath7 can be written as : @xmath8 where @xmath9  ghz is the nv s electron zero - field splitting ( zfs ) , @xmath10 and @xmath11 are the @xmath12 and @xmath13 components of the electron spin operator and @xmath14 is the zeeman splitting due to a constant magnetic field  @xmath15 along the nv axis ( @xmath13 axis ) with @xmath16 the electron gyromagnetic ratio and @xmath17 the bohr magneton  @xcite . </S>",
    "<S> for the description of our experiments the hamiltonian has to be written in the lab frame since the control amplitude is comparable to the larmor frequency of the spin  ( where ) , i.e. the counter - propagating term of the control can not be neglected  @xcite . to fulfill this condition beyond the rwa and to approximate a two - level spin system  of  </S>",
    "<S> , we apply a magnetic field @xmath18  g ( @xmath19  mt ) and set the working transition frequency @xmath20  mhz ( fig .  </S>",
    "<S> [ pulsesequences]a ) . </S>",
    "<S> @xmath15 is aligned along the nv crystal axis in order to suppress mixing between the @xmath21 and @xmath22 states .     </S>",
    "<S> states of the nv center as a function of the applied static magnetic field @xmath15 . </S>",
    "<S> @xmath20  mhz is the frequency of the transition we used in our experiments . </S>",
    "<S> ( b ) schematic representation of the pulse sequences for the density matrix tomography . at the beginning </S>",
    "<S> we apply a laser pulse to polarize the nv in @xmath23 and at the end again to read out the state of the electron spin . </S>",
    "<S> this is followed by the optimized @xmath1 pulse ( crab-@xmath1 , top ) and @xmath0 ( crab-@xmath0,bottom ) pulses . </S>",
    "<S> the tomography is performed by applying @xmath0 pulses along the @xmath12 and @xmath24 axis of the rotating frame . </S>",
    "<S> ( c ) rabi frequency as a function of the amplitude of the awg signal . </S>",
    "<S> the circles denote the region where harmonic behavior is observed as shown in the lower right inset . </S>",
    "<S> the red line is a linear fit , its dashed part shows the region where the spin dynamics is anharmonic . </S>",
    "<S> the upper left inset shows a typical signal in this region . </S>",
    "<S> we chose a mw amplitude which corresponds to a rabi frequency of @xmath25  mhz . ]    </S>",
    "<S> we begin by measuring rabi oscillations at different mw amplitudes and observe the spin dynamics ( fig .  </S>",
    "<S> [ pulsesequences]c ) . </S>",
    "<S> when the driving field @xmath26 the system is in the rwa regime and a nice harmonic signal is obtained ( figure  [ pulsesequences]c , lower right inset ) . </S>",
    "<S> however , when @xmath27 the signal becomes anharmonic as shown in fig .  </S>",
    "<S> [ pulsesequences]c ( upper left inset ) and the precise control over the spin rotations is not trivial . </S>",
    "<S> moreover , often the spin is not flipped within certain time as it can be seen from the upper left inset of fig .  </S>",
    "<S> [ pulsesequences]c , where the normalized fluorescence does not go to zero and the @xmath28 state is not reached . </S>",
    "<S> + to perform a desired transformation of the spin state @xmath29 , which follows the schrdinger equation , ( assuming  @xmath30=1 ) , we optimally engineer the time dependence of the control @xmath7 , such that at the final time @xmath31 the state fidelity between the final spin state @xmath32 and the target @xmath33 is maximized ( see also the supplementary information ) . the fidelity @xmath34 is defined as  @xcite : @xmath35 with @xmath36 and @xmath37 being respectively the target state and the state expected after the crab pulse . </S>",
    "<S> + here we used crab controls to implement the two most important single - qubit rotations : flipping the qubit ( not - gate , @xmath1 pulse ) and creating a superposition between the qubit states ( hadamard gate , @xmath0 ) . </S>",
    "<S> the latter requires an additional rotation around the @xmath13 axis by @xmath38 , which leads to phase change , irrelevant for a quantum algorithm @xcite . </S>",
    "<S> the experimental realization of these rotations is shown schematically in fig .  </S>",
    "<S> [ pulsesequences](b ) while fig .  </S>",
    "<S> [ blochspheres ] shows the calculated trajectory of the spin during the crab-@xmath1 pulse </S>",
    "<S> .     pulse . </S>",
    "<S> the initial state is @xmath39 ( red dashed arrow ) and the target state is @xmath40 ( red solid arrow ) . </S>",
    "<S> ( right ) after the crab-@xmath0 the spin magnetization lays in the @xmath41 plane of the lab frame , parallel to the @xmath12 axis </S>",
    "<S> . then it rotates around the @xmath13 axis with an angular velocity @xmath42 ( larmor frequency ) , acquiring a phase @xmath43 . ]    </S>",
    "<S> we set the pulse lengths @xmath44  ns and @xmath45ns , shorter than @xmath46ns and @xmath47 , where @xmath25  mhz is the extrapolated rabi frequency , see fig .  </S>",
    "<S> [ pulsesequences ] . </S>",
    "<S> it is important to note that the latter can not be used for qubit rotations due to the breakdown of the rwa ( see fig .  </S>",
    "<S> [ pulsesequences ] ) . </S>",
    "<S> the shortest possible pulse length for the @xmath1 pulse is given by the bang - bang condition @xmath48  ns  @xcite . </S>",
    "<S> we are not able to reach this value due to the limited bandwidth and gain curve of the amplifier ( see also supplementary information ) .    </S>",
    "<S> we performed a density matrix tomography in order to determine the quality of the optimized pulses . </S>",
    "<S> both off - diagonal elements have been measured by applying a low power ( @xmath49 mhz ) @xmath0 pulse along the @xmath12 and @xmath24 axis of the rotating frame , followed by a laser pulse for read out ( see fig .  [ </S>",
    "<S> pulsesequences]b ) . to measure the diagonal elements </S>",
    "<S> the mw pulses have been omitted . </S>",
    "<S> after the crab-@xmath1 pulse the theoretically expected and the experimentally measured density matrices are : @xmath50 after the crab-@xmath0 pulse we expect : @xmath51 this is the state of the system expected directly after the mw pulse . however , due to limited time resolution of our apparatus , the measurement can be performed only after some dead time . </S>",
    "<S> we set this time to @xmath52  ns during which the spin rotates in the @xmath41 plane in the lab frame and acquires a phase @xmath53 ( see fig .  </S>",
    "<S> [ blochspheres ] , right ) . </S>",
    "<S> the density matrix after @xmath54 is then : @xmath55 from the tomography we obtain : @xmath56 the expected fidelities of the crab pulses are @xmath57 and @xmath58 , whilst from the experiment we obtain @xmath59 and @xmath60 . </S>",
    "<S> we find an excellent agreement between the theoretical prediction and the experimental result . </S>",
    "<S> the theoretical values are lower than 1 due to the constrains set on the pulse duration . </S>",
    "<S> if the pulse length is increased , much higher numerical fidelities can be achieved @xcite . </S>",
    "<S> the deviation from the prediction can be explained by distortion of the pulse shape , mainly due to the limited bandwidth of the mw amplifier and measurement error ( see supplementary information ) . </S>",
    "<S> + the pulses we have developed in this study are important not only for quantum information processing , but also for most of the pulsed nuclear magnetic resonance ( nmr ) and electron spin resonance ( esr ) experiments . </S>",
    "<S> although they were not specifically designed as gates , only to transfer the spin from @xmath61 to some desired state , they are also very robust and can be used for magnetic resonance as we show below . </S>",
    "<S> one of the most important nmr ( and esr ) pulse sequences consists of a single @xmath0 pulse , where the spin magnetization is rotated from the @xmath13-axis to the @xmath41 plane in the rotating frame . </S>",
    "<S> the spins then precess and can be detected by the nmr detector thus giving a free induction decay ( fid ) signal . </S>",
    "<S> the fourier transform of the latter is the spectrum of the sample  @xcite . </S>",
    "<S> this experiment has been already implemented using nv and can be applied for detecting dc magnetic fields  @xcite . </S>",
    "<S> here , we show that we can perform it both in the lab and in the rotating frame by using both crab and conventional rectangular pulses . </S>",
    "<S> the main difference here compared to previously reported studies , e.g. @xcite , is that we can perform these experiments beyond the rwa .     pulses . </S>",
    "<S> the inset shows the first 160 ns of the signal ( markers ) and the calculated fidelity with respect to the @xmath62 state ( red solid line , see also text)(b ) a combination of a crab-@xmath0 pulse and a low power @xmath0 pulse , where he phase of the latter is fixed for all values of @xmath63 ( blue curve ) and adjusted as @xmath43 ( red markers ) , see also the main text . </S>",
    "<S> the oscillations with @xmath64 2 mhz come from a weakly coupled @xmath65c . </S>",
    "<S> ( c ) fid measured by using low power mw pulses ( within rwa ) , where the phase of the second @xmath0 pulse is not in phase with the first pulse ( blue markers ) . if both pulses are kept in phase then the experiment is performed in the rotating frame ( red markers ) . </S>",
    "<S> the solid lines are fits to the data . </S>",
    "<S> the decay time here is shorter than in the above experiments because the sample is different.,scaledwidth=45.0% ]    all sequences begin with a laser pulse for polarizing the nv ( fig .  </S>",
    "<S> [ fids]a ) </S>",
    "<S> . then we apply a crab-@xmath0 pulse , which aligns the spin magnetization along the @xmath12 axis of the lab frame . after a free evolution time </S>",
    "<S> @xmath63 we apply another crab-@xmath0 pulse to rotate the spin back to the @xmath13 axis and we then read out the spin state . </S>",
    "<S> the signal oscillates with the larmor frequency @xmath42 ( fig .  </S>",
    "<S> [ fids]a , see also fig .  </S>",
    "<S> [ blochspheres ] , right ) . here </S>",
    "<S> we measure the signal in the laboratory frame . </S>",
    "<S> now , if we replace the second crab-@xmath0 pulse with a low power rectangular @xmath0 pulse ( here @xmath66  mhz and @xmath67  mhz ) and keep its phase fixed for all @xmath63 ( equivalent to having the @xmath68 parallel to @xmath24 ) , again the fid signal oscillates with @xmath42 ( fig .  </S>",
    "<S> [ fids]b , blue curve ) . </S>",
    "<S> however , if we set the phase of the second pulse to @xmath43 , we can `` follow '' </S>",
    "<S> the magnetization in the equatorial plane of the bloch sphere ( fig .  </S>",
    "<S> [ blochspheres ] , right ) and the measurement is performed in the rotating frame and the oscillations at @xmath42 disappear ( fig .  </S>",
    "<S> [ fids]b , red markers ) . </S>",
    "<S> + the same experiment can be performed using two rectangular pulses with low mw amplitude ( within the rwa ) where again the phase of the second pulse is kept constant . in this case </S>",
    "<S> the experiment is run in the laboratory frame and the fid again oscillates with the larmor frequency ( fig .  </S>",
    "<S> [ fids ] c , blue markers ) . </S>",
    "<S> if the phase of the mw is not the same for different @xmath63 , then we obtain the typical fid in the rotating frame as shown in fig .  </S>",
    "<S> [ fids]c ( red markers ) . </S>",
    "<S> thus we can on demand `` switch '' between the lab and rotating frames by using ultra - fast ( beyond rwa ) or conventional ( lower power ) pulses . </S>",
    "<S> using this method in principle any oscillation of the spin signal can be `` followed '' , while effectively canceling other unwanted frequencies . in the supplementary information </S>",
    "<S> we demonstrate this technique when the excitation is not in resonance . </S>",
    "<S> +    mhz and the extrapolated rabi frequency @xmath25  mhz ) , as shown in the three insets . </S>",
    "<S> ( b ) crab - hahn echo pulse sequence . </S>",
    "<S> ( c ) hahn echo signal obtained with rectangular pulses in rwa when the first mw pulse is not kept in phase with the last two pulses ( blue curve ) the signal again oscillates with ( in this case ) @xmath69  mhz . the same experiment , here all pulses are kept in phase ( red markers ) . </S>",
    "<S> the solid red line is a gaussian fit to the data . </S>",
    "<S> ( d ) hahn echo pulse sequence with rectangular pulses where the phase @xmath70 of the pulses is properly adjusted . ]    </S>",
    "<S> another important sequence is the hahn echo  @xcite , which has found wide application in nmr and esr . </S>",
    "<S> it is the basis of all dynamical decoupling techniques since all static inhomogeneous shifts ( and fluctuations on the time scale of the coherence time @xmath71 ) are effectively canceled out  @xcite . </S>",
    "<S> it has been implemented with nv  @xcite and also for nv based ac magnetometry  @xcite . </S>",
    "<S> the hahn echo pulse sequence is depicted in fig .  </S>",
    "<S> [ hahnecho]b . after a crab-@xmath0 pulse and a free evolution time @xmath72 </S>",
    "<S> a crab-@xmath1 pulse is applied . after a time @xmath63 </S>",
    "<S> the spin state is rotated to the @xmath13 axis by a crab-@xmath0 pulse and then it is read out by a laser pulse . the spin signal oscillates with the larmor frequency of the nv transition ( in this case @xmath73  mhz ) as shown in fig .  </S>",
    "<S> [ hahnecho]a since the experiment is performed in the lab frame . </S>",
    "<S> if we use rectangular pulses in the rotating frame we obtain the envelope of the echo without the oscillations at @xmath42 ( fig .  </S>",
    "<S> [ hahnecho]c , red markers ) . </S>",
    "<S> however , we can again `` switch '' to the lab frame by adjusting the phase @xmath70 of the last mw pulse ( fig .  </S>",
    "<S> [ hahnecho]c , blue curve ) . </S>",
    "<S> esr experiments in the lab frame with low power mw pulses have been already reported  @xcite , but the `` switching '' between the two frames in the strong driving regime has not been yet demonstrated . </S>",
    "<S> our method presented here allows us to obtain full control over the phase of a spin system and can be implemented with any other pulse sequences . </S>",
    "<S> + in summary , we have developed a novel technique based on optimal control for precise spin qubit rotations in the ultra fast driving regime where standard pulses are not applicable . </S>",
    "<S> we design our qubit gates by using the quantum optimization algorithm crab and find an excellent agreement with the experimental implementation . </S>",
    "<S> moreover , we show that the pulses developed here can be used for basic magnetic resonance experiments also in the case when the rotating frame approximation breaks down . </S>",
    "<S> additionally we demonstrate on demand `` switching '' between the rotating and the lab frame , using both crab and conventional ( low power ) pulses . </S>",
    "<S> this provides a precise control over the spin evolution and can be easily transferred to any other two level system , e.g. trapped atoms , trapped ions or superconducting qubits . </S>",
    "<S> our results can find wide application in quantum computation and broadband magnetometry . </S>",
    "<S> +    we thank florian dolde for the experimental support . </S>",
    "<S> this work is supported by eu strep project diamant , siqs , diadems , dfg ( spp 1601/1 , sfb tr21 ) and bmbf ( quorep ) . </S>",
    "<S> numerical optimization were performed on the bwgrid ( http://www.bw-grid.de ) .    </S>",
    "<S> 29 natexlab#1#1bibnamefont # 1#1bibfnamefont # 1#1citenamefont # 1#1url # 1`#1`urlprefix[2]#2 [ 2][]#2    , , , * * , ( ) .    </S>",
    "<S> , , , , , * * , ( ) .    , , , * * , ( ) .    </S>",
    "<S> , , , * * , ( ) .    , , , , , , * * , ( ) .    , , , , , * * , ( ) .    , , , , , , , , , , , * * , ( ) .    , , , , , , , , , * * , ( ) .    , , , , , , , , , , , * * , ( ) .    , , , , , , , , , , * * , ( ) .    , , , , , * * , ( ) .    , , , , , , , , , , * * , ( ) .    , * * , ( ) .    , , , , , * * , ( ) .    , * * , ( ) .    , _ _ ( , ) .    , </S>",
    "<S> _ _ ( , , ) .    , </S>",
    "<S> * * , ( ) .    </S>",
    "<S> , , , , , , * * , ( ) .    , </S>",
    "<S> _ _ ( , ) .    , </S>",
    "<S> _ _ ( , ) .    , , , , , , * * , ( ) .    , , , , , , , , , , </S>",
    "<S> , * * , ( ) .    , , , * * , ( ) .    , , , , * * , ( ) .    , , , , , , * * , ( ) .    , * * , ( ) .    , , , , * * , ( ) .    , , , , , </S>",
    "<S> * * , ( ) .    * precise ultra fast single qubit control using designed quantum gates + * jochen scheuer@xmath74 , xi kong@xmath75 , ressa s. said@xmath76 , jeson chen@xmath77 , andrea kurz@xmath74 , luca marseglia@xmath74 , jiangfeng du@xmath78 , philip r. hemmer@xmath77 , simone montangero@xmath76 , tommaso calarco@xmath76 , boris naydenov@xmath74 and fedor jelezko@xmath74 @xmath79institut fr quantenoptik , albert - einstein - allee 11 , universitt ulm , 89069 ulm , germany + @xmath80department of modern physics , university of science and technology of china , hefei , anhui 230026 , china + @xmath81institut fr quanteninformationsverarbeitung , albert - einstein - allee 11 , universitt ulm , 89069 ulm , germany + @xmath82electrical and computer engineering , texas a&m university , college station , tx 77843 , usa </S>"
  ]
}