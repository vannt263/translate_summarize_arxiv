{
  "article_text": [
    "the structure of amorphous semiconductors is believed to be well represented by the continuous random network ( crn ) model introduced by zachariasen more than sixty years ago  @xcite . as a result",
    ", the generation of high quality crns has been the subject of investigation for many years .",
    "the first crns were built by hand , see for instance the work of polk  @xcite .",
    "nowadays , the generation of crns is mostly carried out on computers .",
    "the first computer - generated networks , which date back to the sixties and seventies , typically contain a few hundred particles . more advanced algorithms and faster computers have increased the size of the networks that can be handled to a few thousand atoms , with simulation cells of up to . as the simulation cells increase in size , actual devices",
    "have decreased in size .",
    "for example , the thickness of solar cells based on amorphous silicon has already decreased to ; and because in - plane periodicity after approximately  is expected to be a good approximation of the macroscopic lateral size , a reasonable solar cell model would require a simulation cell of , containing approximately 45,000 atoms .",
    "this is only one order of magnitude larger than currently feasible . for other electronic devices ,",
    "lithography on technology is expected to be reached in the coming decade .    in this work ,",
    "we present a computational approach to generating large crns , and discuss the properties of high quality networks containing up to 20,000 particles .",
    "this achievement shows that the generation of device - size atomic configuration networks is within reach .",
    "we begin by describing the algorithm of wooten , winer , and weaire ( www ) , which has been the basis of the best crns generated to date .",
    "we then move on to describe a number of improvements made to the original www algorithm by barkema and mousseau in 1999  @xcite .",
    "these improvements accelerate the relaxation by two orders of magnitude or more .",
    "both the original and the improved www algorithm , however , scale poorly with system size , since the computational effort per attempted local atomic rearrangement increases linearly with system size . in this work ,",
    "we introduce local force and energy evaluations and improve the scaling of computation time with system size @xmath0 significantly , namely to a constant per attempted move plus @xmath1@xmath2 per accepted move .",
    "we also demonstrate how parallel processing can be used to realize an additional speedup , with parallel efficiencies of over 50% .",
    "the significance of these improvements is demonstrated by generating 10,000-atom and 20,000-atom crns .",
    "we then discuss the structural and electronic properties of these models and conclude with an outlook on future research , aiming towards the generation of device - size atomic networks .",
    "in 1985 , wooten , winer , and weaire presented an algorithm for the generation of four - fold coordinated crns  @xcite . in their approach ,",
    "a configuration consists of the coordinates of @xmath0 atoms and a list of the @xmath3 bonds between them .",
    "the structural evolution consists of a sequence of bond transpositions as illustrated in fig .",
    "[ fig : wwwmove ] .",
    "diagram depicting the www bond transposition .",
    "four atoms a , b , c , and d are selected following the geometry shown left ; two bonds , ab and cd , are then broken and atoms a and d are reassigned to c and b , respectively , creating two new bonds , ac and bd shown right.,width=226 ]    within the original www approach , the generation of a crn starts with a cubic diamond structure which is randomized by a large number of such bond transpositions .",
    "after randomization , the network is relaxed through a sequence of bond transpositions , accepted with the metropolis acceptance probability  @xcite : @xmath4,\\ ] ] where @xmath5 is the boltzmann constant , @xmath6 is the temperature , and @xmath7 and @xmath8 are the total quenched energies of the system before and after the proposed bond transposition .    with an explicit list of neighbors , it is possible to use a simple interaction such as the keating potential  @xcite to calculate energy and forces : @xmath9 where @xmath10 and @xmath11 are the bond - stretching and bond - bending force constants , and @xmath12   is the si - si strain - free equilibrium bond length in the diamond structure .",
    "usual values are @xmath13 ev @xmath14 and @xmath15 .    with the approach described above wooten and weaire generated a 216-atom model with an angular distribution as low as 10.9 degrees  @xcite .",
    "a decade later , using the same approach but more computing power , djordjevi , thorpe , and wooten produced two large 4096-atom networks of even better quality , with a bond - angle distribution of 11.02 degrees for configurations without four - membered rings and 10.51 degrees when these rings are allowed  @xcite .",
    "the www algorithm in its original form is capable of producing high quality amorphous networks containing of the order of a thousand atoms ; it is not well suited to generate much larger networks .",
    "this is mostly due to the fact that for each proposed bond transposition , about one hundred energy and force calculations are required , each scaling as @xmath1@xmath2 with system size @xmath0 .",
    "these @xmath1@xmath2 operations are the bottleneck of the algorithm .    in 1999 ,",
    "barkema and mousseau ( bm ) presented a number of modifications to the original www algorithm , partially aimed at resolving these poor scaling properties  @xcite .",
    "their modifications are summarized below :    1 .",
    "starting point for the relaxation in this case is a truly random configuration whereby the atoms are placed at random locations in a periodic box at the crystalline density .",
    "this guarantees that the resulting network is not contaminated by some memory of the crystalline state .",
    "2 .   after a bond transposition in the original www approach ,",
    "the structure is always completely quenched , i.e. , all the atomic coordinates are fully relaxed .",
    "after the quench , the bond transposition is either accepted or rejected based on the metropolis probability .",
    "in contrast , bm determines a threshold energy before quenching . during",
    "the quench the final quenched energy is continuously estimated .",
    "relaxation is stopped when it becomes clear that the threshold energy can not be reached so that the bond transposition will eventually have to be rejected .",
    "this leads to a large reduction in the number of force evaluations associated with rejected bond transpositions .",
    "a local relaxation procedure is used whenever possible . immediately after a bond transposition",
    ", only a small cluster of atoms in the model experiences a significant force .",
    "this cluster consists of the atoms directly involved in the bond transposition ( marked a , b , c , and d in fig .",
    "[ fig : wwwmove ] ) and of nearby atoms , typically up to the fourth neighbor shell of the four transposition atoms .",
    "the number of atoms in such a cluster is about 150 .",
    "it therefore suffices to calculate the force _ locally _",
    "( i.e. ,  only for the 150 or so atoms inside the cluster ) rather than _ globally _ ( i.e. , for all the atoms in the model ) .",
    "+ calculating the force on a cluster of atoms is an @xmath1(1 ) operation , which means that it is independent of the total system size .",
    "local force calculations are therefore much cheaper than global @xmath1@xmath2 force calculations . by using a local relaxation scheme we can increase the efficiency of the algorithm significantly . still , to make the final accept / reject decision on the proposed move , the total keating energy of the system has to be calculated , which is again an @xmath1@xmath2 operation . in practice",
    ", a switch must be made from local to global relaxation , usually after about ten local relaxation steps .",
    "the zero temperature case is treated specifically .    using the improved www algorithm ,",
    "barkema and mousseau generated two 1000-atom models with bond angle deviations as low as 9.20 degrees  @xcite .",
    "furthermore , using the same algorithm they generated a 4096-atom model with an angular deviation of 9.89 degrees .",
    "all models show structural and electronic properties in excellent agreement with experiments .",
    "while the improved www algorithm can successfully generate networks containing several thousand particles , it does not deal well with systems of 10,000 particles or more .",
    "each attempted bond transposition still requires one or more @xmath1@xmath2 energy evaluations . in this section",
    ", we present an algorithm for attempting bond transpositions that is completely local , i.e. ,  free of @xmath1@xmath2 operations for unsuccessful bond transpositions .",
    "to exploit the local nature of the bond transpositions , we need to introduce the concept of local energy : we assign to each atom @xmath16 an energy @xmath17 such that with @xmath18 the keating energy of the system given by eq .",
    "( [ eq : keating ] ) .",
    "one way to achieve this is to divide the energy due to two - body interactions equally between the two participating atoms and to assign the energy of three - body interactions to the central atom of the corresponding triple .",
    "thus , we obtain : @xmath19.\\end{aligned}\\ ] ] here , the constants @xmath10 , @xmath11 , and @xmath20 are defined as in eq .",
    "( [ eq : keating ] ) ; @xmath21 represents the vector pointing in the direction of the @xmath22-th bond away from atom @xmath16 .",
    "the energy @xmath23 of a cluster @xmath24 of atoms can now be calculated using : @xmath25    the force on the atoms inside the cluster is obtained from the derivative of the keating energy with respect to the atomic coordinates .",
    "care has to be taken for atoms on the edge of the cluster since these atoms also interact with atoms outside the cluster : due to the two- and three - body terms in the keating potential , all atoms interact with their first and second nearest neighbors ; for atoms located on the edge of the cluster , some of these neighbors are outside the cluster .",
    "starting point is a random configuration generated using the method described in ref .  .",
    "this guarantees that the resulting configurations are not contaminated by some memory of the crystalline state .",
    "assuming that the total keating energy of the initial configuration is known and equals @xmath18 , www moves can be attempted locally as follows :    1 .",
    "a threshold energy @xmath26 is determined by using the equation : @xmath27 where @xmath28 is a random number uniformly drawn from the interval @xmath29 .",
    "the move is accepted if the attempted bond transposition leads to a configurational energy below the threshold energy ; otherwise it is rejected .",
    "the four atoms involved in the attempted bond transposition and all atoms up to the fourth neighbor shells of these four atoms are grouped into a cluster .",
    "such a cluster contains about 150 atoms .",
    "a list is constructed of all the bonds that contribute to the force on the atoms inside the cluster . as was explained above ,",
    "some of these bonds involve atoms outside the cluster .",
    "for each bond we store the labels of the two atoms constituting the bond , the @xmath30 , @xmath31 , and @xmath32 components of the bond vector ( taking care of the periodic boundary conditions ) , and the square of the bond length .",
    "we then calculate the cluster energy @xmath23 using eq .",
    "( [ eq : clusterenergy ] ) . in the calculation of the cluster energy most bonds",
    "are encountered more than once . to increase efficiency ,",
    "a bond ( i.e. , its set of three components ) is calculated only once during an energy or force evaluation ; once a bond has been calculated it is time - stamped with an integer flag and the bond information is stored .",
    "later references to the same bond are then retrieved from memory .",
    "+ we also store the energy of the atoms that remain outside the cluster : .",
    "we then perform the bond transposition to obtain the geometry shown in the right frame of fig .",
    "[ fig : wwwmove ] .",
    "the system is relaxed locally , i.e. , only atoms inside the cluster are allowed to move . at each relaxation step",
    "we use eq .",
    "( [ eq : clusterenergy ] ) to calculate the energy of the cluster @xmath23 and the atomic forces , again making sure each bond is calculated only once , and perform structural relaxation as in the original and improved www algorithms . at each relaxation",
    "step the total energy of the system is equal to .",
    "local relaxation is continued until the energy has converged or until it becomes clear that the threshold energy can not be reached .    in the local relaxation procedure above , the computational effort per attempted bond transposition does not grow with the system size .",
    "local relaxation alone , however , is not sufficient and we also have to relax globally to relieve any strain that may have built up between atoms on the edge of a cluster and non - cluster atoms . for clusters extending up to the fourth neighbor shell around the atoms directly involved in the bond transposition we find that global relaxation can lower the configurational energy typically by less than .",
    "we therefore switch from local to global relaxation when , during local relaxation , the energy comes to within of the threshold energy . in most cases",
    ", this leads to the move being accepted .",
    "we have developed a parallel version of our algorithm with the aim of harnessing the tremendous power of parallel computers .",
    "the parallel algorithm is in bulk synchronous parallel ( bsp ) style  @xcite with alternating phases of computation and communication , separated by a synchronization of all the processors .",
    "the parallel algorithm has two main parts , local relaxation and global relaxation .",
    "the local relaxation is done in parallel by letting every processor try a sequence of randomly chosen bond transpositions , until one of the processors finds an acceptable transposition .",
    "the processors work independently but synchronize at regular intervals to communicate their success or failure to the others .",
    "if more than one processor succeeds , an arbitrary bond transposition is chosen as the winner .",
    "this approach requires the replication of all the atomic data .",
    "fortunately , the memory storage needed is limited to an array of @xmath33 atomic coordinates and a few other arrays of size @xmath0 , which usually can be stored on every processor .",
    "( the www algorithm and its variants are demanding in cpu time , but not in memory requirements . ) furthermore , this approach also requires refreshing the atomic data when the positions change , causing communication between the processors .",
    "this only happens after a bond transposition is accepted , which is a relatively rare event ( of the order of once every thousand attempts ) . for these reasons ,",
    "we choose to replicate the data instead of distributing them , and develop a parallel local relaxation algorithm based on replicated data .",
    "it is crucial to choose a suitable time interval between successive synchronizations .",
    "if this interval is too short , the time of the synchronization itself will become dominant , or fluctuations in the amount of work of the different processors will become visible ; in longer intervals such fluctuations are averaged out and have less impact .",
    "if the interval is too long , it becomes likely that one ( or more ) accepted moves are found in every time interval .",
    "part of the work in a successful time interval is wasted , because the processor that finds an accepted move waits until the others have finished their ( useless ) computations .",
    "thus a high success rate means that much time is wasted . from the point of view of parallel efficiency",
    ", the ideal situation occurs when most time intervals fail to produce a successful bond transposition . on average ,",
    "little cpu time is then wasted .",
    "a processor decides to synchronize based on the total number of relaxation iterations performed during all its bond transposition attempts .",
    "each iteration requires of the order of @xmath34 floating point operations ( flops ) . simply counting the number of attempts",
    "would not give a good indication of the total amount of work performed by a processor , since the number of iterations per attempt may vary , depending for instance on the observed energy decrease .",
    "thus , a processor synchronizes after every @xmath35 iterations .",
    "we determined the parameter @xmath35 empirically , and found on our machine , a cray t3e , that values in the range @xmath35=10200 give the best performance on @xmath36 processors ; for higher numbers of processors this range becomes smaller and the choice of @xmath35 becomes critical . for @xmath37 , we used @xmath38 .",
    "the bsp cost model  @xcite can be helpful in choosing @xmath35 .",
    "for instance , the bsp parameter @xmath39 , representing the synchronization time of the parallel computer , can be used to find a lower bound for @xmath35 .",
    "the global relaxation is done in parallel by partitioning the simulation cell over the @xmath40 processors of the parallel computer and letting every processor compute the energies @xmath17 , forces , and displacements for the atoms in its own part of the cell .",
    "in contrast to the local relaxation , it is now justified to have all the processors participate in one relaxation : the amount of work , @xmath41@xmath2 , in an iteration is much more than in the case of the local relaxation .",
    "in fact , processors are even obliged to participate , because there is no other useful work to do : most likely the global relaxation succeeds and provides the starting point for the remainder of the computation .",
    "communication arises in the global relaxation because processors need data from other processors concerning atoms that lie near inter - processor boundaries .",
    "thus at the end of an iteration , a processor has to communicate the changes in the positions of its boundary atoms ( i.e. , atoms within two bonds from an atom on another processor ) .",
    "also , some atoms may move to another processor . to reduce the size of the boundary region , we use three types of partitioning  @xcite : standard cubic ( sc ) , which splits the simulation cell into @xmath42 subcubes ; body - centred cubic ( bcc ) , which splits the cell into @xmath43 truncated octahedra centred at the lattice sites of the bcc lattice ; and face - centred cubic ( fcc ) , which splits the cell into @xmath44 rhombic dodecahedra centred at the lattice sites of the fcc lattice . the new bcc and fcc partitionings generate about 10% less communication than the commonly used sc partitioning . with these three partitionings",
    ", we can choose from a wide range of processor numbers @xmath40 , and in particular we can employ every parallel computer where @xmath40 is a power of two .",
    "we have implemented the parallel algorithm using the bsplib communications library  @xcite on a cray t3e . in the local relaxation",
    ", we have achieved a speedup of 18.6 on 32 processors , corresponding to an efficiency of 58% .",
    "the efficiency loss is due both to the fluctuations in work load per local iteration ( caused by small differences in the numbers of cluster atoms ) and to waiting time at the end of successful time intervals . at the optimum value of @xmath35 ,",
    "both effects are significant .",
    "losses due to the synchronizations themselves are negligible , as one synchronization takes less than 1% of the time of a local iteration .",
    "the replication time was found to be the same as the time of 14 local iterations , but overall this time is negligible since data only need to be replicated after a successful attempt .",
    "in the global relaxation , we have achieved a speedup of 19.3 on 32 processors for the 20,000-atom model , corresponding to an efficiency of 60% , see  @xcite for more details . here",
    ", the efficiency loss is mainly due to redundant computations for boundary regions , and communication of data for boundary atoms .",
    "the total speedup of our parallel version depends on the mixture of local and global relaxations needed .",
    "this mixture is influenced by a variety of parameters such as the temperature @xmath6 in the metropolis acceptance criterion  ( [ eq : metropolis ] ) and the expected reduction due to the global relaxation . in our simulations ,",
    "the amounts of cpu time spent on local relaxation and on global relaxation were nearly equal .",
    "using the scalable www algorithm we have generated one 10,000-atom amorphous silicon network and one 20,000-atom network . in this section , we discuss the structural and electronic properties of these networks . in table",
    "[ tab : properties ] , we compare our configurations relaxed with the keating potential with those of djordjevi , thorpe , and wooten  @xcite and with models generated by barkema and mousseau using the improved www algorithm  @xcite .",
    "we also provide irreducible ring statistics .    [ cols=\"^,<,<,<,<,<,<,<\",options=\"header \" , ]     the properties of the networks after relaxation with the ( modified ) sw potential are reported in table  [ tab : mswproperties ] . for all configurations ,",
    "the bond angle distribution widens and the density decreases .",
    "[ fig : rdf ] shows the rdf for the 10,000-atom and 20,000-atom models compared to the experimental rdf obtained by laaziri _",
    "et al . _ on annealed _",
    "a_-si samples prepared by ion bombardment  @xcite .",
    "agreement is excellent .",
    "however , configurations differing widely in topology can easily produce similar rdfs .",
    "agreement with the experimental rdf must therefore be regarded as a minimum demand on a high quality crn .",
    "radial distribution function for the 10,000-atom model ( top ) and the 20,000-atom model ( bottom ) after relaxation with the modified stillinger - weber potential ( solid line ) .",
    "the dashed line shows the experimental result from ref .  ; distances are in .,title=\"fig:\",width=302 ]   radial distribution function for the 10,000-atom model ( top ) and the 20,000-atom model ( bottom ) after relaxation with the modified stillinger - weber potential ( solid line ) .",
    "the dashed line shows the experimental result from ref .  ; distances are in .,title=\"fig:\",width=302 ]    a more stringent criterion that can be used to evaluate the quality of a model is the coordination number of the atoms . using the minimum of the rdf beween the first and second neighbor peak as the nearest neighbor cut - off distance and after relaxation with the modified stillinger - weber potential , we observe that the 10,000-atom and 20,000-atom model develop 0.9% and 0.2% of coordination defects , respectively .    while structural averages provide good insight into the overall quality of a model , they do not say much regarding local environments . it is therefore also important to look at the electronic properties of our models : even small densities of highly strained geometries or defects will be picked up as states in the gap of the electronic density of states ( edos ) . in fig .",
    "[ fig : edos ] we show the edos of the 10,000-atom and 20,000-atom models .",
    "the _ fireball _ local - basis ab - initio code  @xcite was used to obtain the edos .",
    "a remarkable feature of the state densities shown here is the absence of states in the gap , leading to a perfect gap of for both models .",
    "we have presented here a scalable version of the www algorithm which allows for local atomic rearrangements to be tried using only @xmath1(1 ) operations .",
    "we have developed an efficient parallel version which achieves good load balance and limits communication .",
    "the scalable performance of the algorithm has been demonstrated by generating one 10,000-atom and one 20,000-atom model .",
    "structural and electronic properties of these models are excellent and they compare well to experiments .    these high - quality models have the long term goal of accurately modeling devices such as solar cells . at this point , using periodic - boundary conditions in the two extended directions , we are able to simulate _ a_-si films with thinkness of about .",
    "once such atomic configurations become available , the role of various structural and electronic defects can be studied .",
    "we thank dave drabold for communicating to us the edos of the 10,000-atom and 20,000-atom models ."
  ],
  "abstract_text": [
    "<S> the atomic structure of amorphous materials is believed to be well described by the continuous random network model . </S>",
    "<S> we present an algorithm for the generation of large , high - quality continuous random networks . </S>",
    "<S> the algorithm is a variation of the _ sillium _ approach introduced by wooten , winer , and weaire . by employing local relaxation techniques , local atomic rearrangements </S>",
    "<S> can be tried that scale almost independently of system size . </S>",
    "<S> this scaling property of the algorithm paves the way for the generation of realistic device - size atomic networks . </S>"
  ]
}