{
  "article_text": [
    "smooth - particle hydrodynamics ( sph ) is a lagrangian method for modelling fluid dynamics , pioneered by @xcite and @xcite . instead of discretising the fluid quantities , such as density , velocity , and temperature , on a fixed grid as in eulerian methods ,",
    "the fluid is represented by a discrete set of moving particles acting as interpolation points . due to its lagrangian nature , sph models regions of higher density with higher resolution with the ability to simulate large dynamic ranges .",
    "this makes it particularly useful in astrophysics , where it is used to model galaxy and star formation , stellar collisions , and accretion discs .",
    "the core of sph is the kernel estimator : the fluid density is _ estimated _ from the masses @xmath1 and positions @xmath2 of the particles via to denote a local _ estimate _  in many sph - related publications the distinction between actual and estimated quantities is not clearly made , confusing the discussion . ]",
    "@xmath3 where @xmath4 is the kernel function and @xmath5 the sph smoothing length for @xmath6 . ] for the @xmath7th particle .",
    "similar estimates @xmath8 for the value of any field @xmath9 can be obtained from its discretised values @xmath10 . by applying these estimators to the fluid equations governing mass , momentum and energy , discrete equations for the sph particle positions @xmath2 and other properties ( such as internal energy @xmath11 ) can be obtained .",
    "together with an appropriate time integration method , these constitute a concrete sph scheme .",
    "unfortunately , this process is not unique and since its inception the sph method has undergone many refinements such as individual particle smoothing lengths and viscosities , as well as many alternative derivations of the sph equations , leading to a plethora of sph methods .",
    "while formally these various schemes differ only in their error terms , their conservation and stability properties can be quite different .",
    "this has lead to the unfortunate situation that the shortcomings of a few such implementations are often blamed on the general sph concept per se .",
    "however , @xcite have pointed out that sph equations derived from a variational principle are not only unique , but also conservative .",
    "such sph equations are most simply obtained as the euler - lagrange equations derived from an sph lagrangian @xmath12 representing the lagrangian of the fluid system .",
    "once @xmath12 is chosen , the sph equations follow uniquely ( see appendix  [ app : pressure ] for a typical example ) . complementing these with a symplectic integrator , such as the standard leap - frog , results in a sph scheme which by construction conserves the total mass , momentum , angular momentum , energy , and entropy .",
    "the conservation of entropy means that sph is _ dissipation - less _ , as demonstrated in fig .",
    "[ fig : sound_wave ] . in real fluids , however , entropy increases in shocks , where particle collisions randomise their velocities generating heat and entropy .",
    "this basic collisional mechanism is inherent to all fluids ( except for dust and collisionless plasma , which therefore may not be considered fluids ) and prevents the flow from becoming multi - valued . in sph",
    "_ artificial _ viscosity is needed to dissipate local velocity differences and convert them into heat , which generates entropy and prevents inter - penetration of sph particles and thus a multi - valued flow .",
    "since the artificial viscosity required for this goal is usually much stronger than the actual physical viscosity , it also causes unphysical dissipation away from shocks .",
    "while it may be possible for certain simulations to select the magnitude of the viscosity to minimise such undesired dissipation , in general the adverse effect of artificial viscosity is unknown prior to any simulation and , possibly , even afterwards .",
    "for example , when simulating the effect of a perturbing massive body on a pulsating star , it may be very difficult to distinguish this effect from that induced by artificial viscosity .",
    "another example is the case of a differentially rotating disc , where artificial viscosity causes spurious angular momentum transport .",
    "since viscosity is a dissipative process , the corresponding sph equations can not be derived from a variational principle , and we are back to ad - hoc methods for deriving them .",
    "most sph simulations to date still use a rather simple artificial viscosity , which effectively amounts to modelling a viscous fluid and quickly damps away any oscillations , such as sound waves or stellar pulsations , and impedes shear flows .",
    "while suggestions have been made to _ reduce _ such unwanted dissipation , our goal here is to _ eliminate _ it . to this end",
    "we introduce a novel method of controlling the amount of artificial viscosity , such that away from shocks the modelled flow is virtually inviscid .",
    "section  [ sec : av ] describes sph artificial viscosity and previous efforts to reduce its adverse effects , while our new method is outlined in section  [ sec : av : novel ] .",
    "the ability of the new scheme to reduce artificial viscosity but also to capture shocks is demonstrated in sections  [ sec : test : suppress ] and [ sec : test : shock ] , respectively .",
    "finally , section  [ sec : summ ] concludes our study .",
    "the traditional form of artificial viscosity ( e.g. * ? ? ? * ) adds the following terms to the momentum and energy equations , allowing the conversion of kinetic energy into heat .",
    "@xmath13    with the average kernel @xmath14 here , @xmath15 and @xmath16 , while @xmath5 is the individual adaptive smoothing length of each sph particle ( for details on how @xmath5 is adapted see appendix  [ sec : adapt ] ) .",
    "the artificial viscosity term is given by @xcite @xmath17 with @xmath18 ( @xmath19/2 $ ] and likewise for the average sound speed @xmath20 and estimated density @xmath21 ) . since @xmath22 for receding particle pairs ,",
    "artificial viscosity does not affect expanding flows .",
    "this functional form of sph artificial viscosity may seem rather ad - hoc , but it is reasonably well motivated and emerged as the most useful one amongst several methods @xcite .",
    "moreover , it is equivalent to the form of dissipation implicit in riemann solvers @xcite .    by expanding density and velocity in a taylor series around @xmath2 , it is straightforward to show that these terms correspond to both a shear and a bulk viscosity .",
    "more quantitatively , if one assumes that , other than in equation  ( [ eq : pi ] ) , artificial viscosity acts between approaching and receding neighbours and that @xmath23 , the corresponding shear and bulk viscosity coefficients are ( e.g. * ? ? ?",
    "* ) @xmath24 and @xmath25 , respectively , where the factor @xmath26 is of order unity and depends on the functional form of the kernel .",
    "this implies that artificial viscosity decreases with increasing resolution ( smaller @xmath27 ) .",
    "thus , a straightforward though expensive way to reduce unwanted dissipation is to increase the resolution .",
    "in fact , one motivation for reducing artificial viscosity is to avoid this purely numerical necessity for high resolution .",
    "most sph applications to date use the above treatment with @xmath28 .",
    "the widely used code gadget-2 @xcite employs a fixed @xmath29 chosen at the start of the simulation ( though @xcite , @xcite , have implemented into gadget-2 the improved method described in  [ sec : av : mm ] below ) .",
    "clearly , in complex situations , where strong and weak shocks are present as well as converging flows , any choice for @xmath29 is unsatisfactory , leading to bad treatment of strong shocks , over - damping of converging flows , or both .",
    "the purpose of artificial viscosity is to allow for entropy generation across shocks and to stop particle interpenetration . to this end",
    ", only bulk viscosity is required , but the inherent shear viscosity is unnecessary .",
    "what is worse , this shear viscosity may seriously compromise simulations of shear flows , such as in a differentially rotating gas disc . in an effort to reduce the resulting artificial angular momentum dissipation",
    ", @xcite proposed to multiply @xmath30 with a reduction factor @xmath31 with @xmath32 ( with velocity divergence and curl estimated using the sph kernel estimator ) .",
    "this term diminishes the effect of artificial viscosity whenever the vorticity dominates the convergence .",
    "however , this method only reduces ( but does not eliminate ) unwanted dissipation in the presence of a rotating shear flow .",
    "standard sph artificial viscosity acts whenever the flow of the fluid converges , even if only weakly .",
    "for example , when a pulsating star contracts artificial viscosity damps its pulsation .",
    "exactly the same happens to ordinary sound waves : standard sph viscosity damps them , as demonstrated in fig .",
    "[ fig : damp_sound ] , the faster the shorter the wave length ( because these are more poorly resolved ) .    with this in mind",
    ", @xcite proposed to adapt the strength of artificial viscosity to the local convergence of the flow . to this end , they introduced the concept of individual adaptive viscosities @xmath33 for each particle , replaced @xmath29 in equation  ( [ eq : pi ] ) by @xmath34 , and set @xmath35 .",
    "the individual viscosities are adapted according to the differential equation @xmath36 with the velocity - based source term @xmath37 and the decay time ) accounts for the difference in the definition of the smoothing length @xmath27 between us and @xcite . ]",
    "@xmath38 here , @xmath39 constitutes a lower limit for the artificial viscosity such that @xmath40 for non - convergent flows . for a convergent flow , on the other hand , @xmath33 grows above that value , guaranteeing the proper treatment of shocks . in the post - shock region ,",
    "the flow is no longer convergent and @xmath33 decays back to @xmath41 on the time scale @xmath42 ( typically @xmath43 ) .",
    "this method reduces the artificial viscosity away from shocks by an order of magnitude compared to standard sph and gives equally accurate post and pre - shock solutions @xcite .",
    "more recently , @xcite proposed to alter the adaption equation ( [ eq : davdt ] ) to ) but multiplying the source term ( [ eq : s : mm ] ) by @xmath44 , which is what @xcite actually did.]@xmath45 with @xmath46 , while @xcite advocated @xmath47 .",
    "the effect of this alteration is first to prevent @xmath33 to exceed @xmath48 and second to increase @xmath49 for small @xmath33 , which ensures a faster viscosity growth , resulting in somewhat better treatment of shocks @xcite .",
    "this method may also be combined with the balsara switch by applying the reduction factor ( [ eq : balsara ] ) either to @xmath30 @xcite or to @xmath50 @xcite .",
    "the scheme of equations ( [ eq : s : mm ] ) , ( [ eq : tau ] ) and ( [ eq : davdt : alt ] ) with @xmath39 , @xmath47 and @xmath51 is the current state of the art for sph and is implemented in the codes phantom ( by daniel price ) and vine @xcite . in sections [ sec :",
    "test : suppress ] and [ sec : test : shock ] , we will frequently compare our novel scheme ( to be described below ) with this method and refer to it as the ` m&m method ' or the ` @xcite version of the m&m method ' as opposed to the ` original m&m method ' , which uses equation ( [ eq : davdt ] ) instead of ( [ eq : davdt : alt ] ) .",
    "the m&m method certainly constitutes a large improvement over standard sph , but low - viscosity flows , typical for many astrophysical fluids , are still inadequately modelled . after studying this and related methods in detail , we identify the following problems .",
    "first , any @xmath52 results in unwanted dissipation , for example of sound waves ( see fig .  [ fig : damp_sound ] ) or stellar pulsations ( see  [ sec : test : poly ] ) , yet the m&m method requires @xmath53 . this necessity has been established by numerous tests ( most notably of * ? ? ?",
    "* ) and is understood to originate from the requirement to ` maintain order amongst the particles away from shocks ' @xcite .",
    "second , there is a delay between the peak in the viscosity @xmath29 and the shock front ( see fig .",
    "[ fig : source ] ) : the particle viscosities are still rising when the shock arrives .",
    "one reason for this lag is that integrating the differential equation  ( [ eq : davdt : alt ] ) increases @xmath33 too slowly : the asymptotic value @xmath54 is hardly ever reached before the shock arrives ( and @xmath50 decreases ) .",
    "third , the source term ( [ eq : s : mm ] ) does not distinguish between pre- and post - shock regions : for a symmetrically smoothed shock it peaks at the exact shock position ( in practice the peak occurs one particle separation in front of the shock , * ? ? ?",
    "* see also fig .",
    "[ fig : source ] ) .",
    "however , immediately behind the shock ( or more precisely the minimum of @xmath55 ) , the ( smoothed ) flow is still converging and hence @xmath29 continues to increase without need .",
    "a further problem is the inability of the source term ( [ eq : s : mm ] ) to distinguish between velocity discontinuities and convergent flows .",
    "finally , in strong shear flows the estimation of the velocity divergence @xmath55 , needed in ( [ eq : s : mm ] ) , often suffers from substantial errors ( see appendix  [ app : divv : fail ] for the reason ) , driving artificial viscosity without need .",
    "this especially compromises simulations of differentially rotating discs even when using the balsara switch .",
    "our aim is a method which overcomes all the issues identified in  [ sec : mm : crit ] above and in particular gives @xmath56 away from shocks . to this end",
    ", we introduce a new shock indicator in  [ sec : av : a ] , a novel technique for adapting @xmath33 in  [ sec : av : new ] , and a method to suppress false compression detections due to the presence of strong shear in  [ sec : shear ] .",
    "we need a shock indicator which not only distinguishes shocks from convergent flows , but , unlike @xmath55 , also discriminates between pre- and post - shock regions .",
    "this requires ( at least ) a second - order derivative of the flow velocity and we found the total time derivative of the velocity divergence , @xmath57 , to be most useful . as is evident from differentiating the continuity equation , @xmath58 @xmath59 indicates an non - linear density increase and a steepening of the flow convergence , as is typical for any pre - shock region .",
    "conversely , in the post - shock region @xmath60 .",
    "this suggests to consider only negative values and , in analogy with equation ( [ eq : s : mm ] ) , we define the new shock indicator @xmath61 here , @xmath62 is a limiter , detailed in  [ sec : shear ] below , aimed at suppressing false detections of compressive flows in multi - dimensional flows .      instead of increasing @xmath33 by integrating a differential equation , we set @xmath33 directly to an appropriate local value @xmath63 whenever this exceeds the current value for @xmath33 . after extensive experimenting",
    ", we settled on the following simple functional form @xmath64 with the signal velocity . ] @xmath65 at the moment of passing through a shock ( more precisely through a maximum of the flow convergence ) , @xmath66 and hence @xmath67 return to zero and whenever @xmath68 we let @xmath33 decay according to @xmath69 we use @xmath70 rather than @xmath71 in the decay time @xmath42 for internal consistency ( this is of little practical relevance as @xmath72 in the post - shock region ) .",
    "we use @xmath73 , such that the viscosity decays twice as slowly as in previous methods , avoiding some occasional minor post - shock ringing not present in methods with @xmath74 .",
    "however , the traditional @xmath51 also gives satisfactory results for most of our test problems .",
    "as explained in detail in appendix  [ app : divv : fail ] , in multi - dimensional flows strong shear induces false detections of @xmath55 with the standard sph estimator even in the absence of particle disorder ( noise ) . as shown in appendix  [ app : divv : good ] , these errors can be reduced by first estimating the velocity gradient matrix @xmath75 and then obtaining @xmath55 as its trace ( we employ a similar method to estimate @xmath76 , see appendices  [ app : divv : dot ] ) .",
    "unfortunately , even with this improved method false detections for @xmath55 ( and @xmath76 ) remain , for example in the situation of a differentially rotating disc .",
    "these still induce artificial viscosity , which may be significant in particular if @xmath77 is small compared to the shear .",
    "the limiter @xmath62 in equation  ( [ eq : a ] ) is aimed at suppressing such false detections by @xmath78 whenever the shear is much stronger than the convergence _ and _ no shock is present .",
    "having obtained the velocity gradient matrix @xmath79 , the shear is easily obtained as its traceless symmetric part @xmath80 ( with @xmath81 the number of spatial dimensions ) , while the presence of a shock is indicated by @xmath82 since near a shock @xmath83 for all particles .",
    "after some experimenting , we found the following functional form for the limiter suitable @xmath84 this functional form is similar to the balsara limiter ( [ eq : balsara ] ) in that it compares the flow convergence to a measure of the traceless part of the velocity gradient ( the shear or the vorticity ) .    alternatively ,",
    "if one can be sure that no strong shear flows occur during the simulation , one may use the standard sph estimator for @xmath55 and estimate @xmath76 from its change over the last time step .",
    "however , the limiter is still desirable and one may use @xmath85 instead of @xmath86 in equation  ( [ eq : xi ] ) .",
    "we do not use this simplified version in the tests presented below , but our experiments indicate that such a method would pass all our tests except those of ",
    "[ sec : test : disc ] and  [ sec : test : shear ] , both involving strong shear .",
    "before considering 2d and 3d test problems , we now assess the behaviour of our novel scheme , as well as that of the m&m method , in simple yet typical situations .",
    "first , consider a sound wave of velocity amplitude @xmath87 and wave number @xmath88 as example of a well - resolved weakly convergent flow . in this case ,",
    "@xmath89 and @xmath90 at their respective maxima .",
    "since @xmath91 we have @xmath92 , while for the m&m method the asymptotic value @xmath93 . in the limit @xmath94 of a well - resolved wave , @xmath95 faster than @xmath96 , such that even with @xmath97 the m&m method would be more viscous than our new scheme .",
    "[ fig : damp_sound ] shows 1d sound - wave sph runs , demonstrating that our new scheme behaves quasi - inviscid in this situation .",
    "following @xcite , we may also consider a simple homologous flow @xmath98 with @xmath99 , which approximates certain astrophysical problems involving collapse and does not require artificial dissipation .",
    "for this situation @xmath100 but @xmath101 ( a direct consequence of the ability of @xmath76 to distinguish shocks from convergent flows ) , such that our new scheme remains inviscid , while the m&m method does not even for @xmath97 .",
    "next , consider a strong shock with velocity discontinuity @xmath102 .",
    "assuming that it is smoothed over one kernel width , we find maximum amplitudes of @xmath103 and @xmath104 ( the exact values depend on the shock conditions and the functional form of the smoothing kernel ) .",
    "since @xmath105 , our new scheme gives @xmath106 , while the asymptotic value ( [ eq : a : asym ] ) for the m&m method also approaches @xmath48 .    while 3d simulations of strong shocks are presented in ",
    "[ sec : test : shock : strong ] , fig .  [ fig : source ] presents weak ram - shock simulations with @xmath107 ( top ) and @xmath108 ( bottom ) for our new scheme , the m&m method , and standard sph . in both regimes",
    "the peak in , respectively , @xmath67 and @xmath109 is one particle farther in front of the shock with our new method than with the m&m method , which reflects the superiority of @xmath66 over @xmath110 to detect an incoming shock .",
    "this , combined with setting the viscosity parameter directly to the required value , results in the peak in @xmath29 to occur two particle separations _ before _ the shock for our new method , while for the m&m method it peaks a similar length _ behind _ the shock .    with our new method , the viscous deceleration ( bottom panels in fig .",
    "[ fig : source ] ) sets in about three particle separations before the weak and the strong shock , yielding good shock capturing properties in both cases .",
    "the m&m method , on the other hand , decelerates the flow much earlier for a weak shock than for a strong shock and results in significant over - damping of weak shocks ( which also pertains to density and internal energy  not shown in fig .",
    "[ fig : source ] ) , while our method smoothes both shocks over four particle separations ( top panels in fig .",
    "[ fig : source ] ) , the optimal sph resolution in 1d . note that standard sph is hopeless : it over - smoothes the strong shock and is completely incapable of dealing with the weak shock .",
    "the main point of our method is the absence of artificial viscosity away from shocks .",
    "hence , if @xmath74 was indeed required to maintain particle order , as previously argued in context of the m&m method , our method should fail in this regard .",
    "noise in sph can emerge from shocks or carelessly generated initial conditions .",
    "let us first consider the time evolution of noisy initial conditions , generated by adding random displacements to particle positions representing noise - free hydrostatic equilibrium ( the vertices of a face - centred - cubic grid , i.e.  densest - sphere packing ) .",
    "we consider two cases with the displacements in each dimension drawn from a normal distribution with rms amplitude equal to the nearest - neighbour distance or a tenth of it , respectively .",
    "the time evolution of such noisy initial conditions can be distinguished by monitoring @xmath111 there are three possible scenarios .",
    "either the particles settle back close to the original grid ( @xmath112 approaches its grid value @xmath113 ) , form a glass ( @xmath112 approaches a finite value @xmath114 ) , or form dense clumps ( ` clumping instability ' , @xmath115 ) .",
    "[ fig : noise ] plots the evolution of @xmath112 for @xmath116 sph neighbours ( see also appendix  [ sec : adapt ] ) when @xmath117 .",
    "clumping only occurs when @xmath118 , while for any viscous scheme tested the particles settle back onto the grid or form a glass with roughly similar time evolutions .",
    "post - shock noise occurs because the shock - induced compression disrupts the original particle order , but other than in the above test the viscosity is already switched on . in fig .",
    "[ fig : sod : noise ] , we plot the amplitudes of the velocity and density noise in 3d simulations of the standard @xcite shock tube test ( see also  [ sec : sod ] ) .",
    "the three methods have similar levels of density noise , but standard sph is less noisy in the velocities , which is not surprising given its stronger viscosity . however , between the two viscosity suppressing schemes there is little difference , even though @xmath97 for our method . similar results obtain for other shock tests and we conclude that our method is no worse than m&m s for maintaining particle order .",
    "we now present some tests of low - mach - number flows , where previous methods give too much unwanted dissipation .",
    "the steepening of sound waves is a simple example demonstrating the importance of distinguishing between converging flows and shocks . as the wave propagates , adiabatic density and pressure oscillations result in variations of the sound speed , such that the density peak of the wave travels faster than the trough , eventually trying to overtake it and forming a shock .    in our test , a 1d sound wave with a velocity amplitude @xmath119 of the sound speed is used ( ideal gas with @xmath120 ) .",
    "[ fig:1d_sound ] compares the velocity field at the moment of wave steepening for various sph schemes , each using 100 particles , with a high - resolution grid simulation .",
    "the new method resolves the shock better than the m&m scheme , let alone standard sph .    in fig .",
    "[ fig:1d_sound ] , we also show results from gph ( godunov - type particle hydrodynamics , * ? ? ?",
    "* ) , which differs from sph by using the pressure @xmath121 , found by solving the riemann problem between particle neighbours , in the momentum and energy equations and avoids the need for explicit artificial viscosity .",
    "this substitution does not affect the energy or momentum conservation @xcite , and indeed we find that both are well conserved .",
    "while the first - order gph scheme is comparable to standard sph and also to an eulerian godunov grid code using the same riemann solver without interpolation ( not shown ) , the second - order gph scheme resolves the discontinuity almost as well as our novel method .",
    "similar to sound - wave steepening , this test requires good treatment of convergent flows and weak shocks .",
    "the initial conditions are uniform pressure and density and a continuous flow velocity @xmath122 as there is no analytical solution , we compare the results to a high - resolution grid - code simulation .",
    "we run tests for @xmath123 and @xmath124 as shown in the top and bottom panels of fig .",
    "[ fig : converging ] .",
    "while the m&m switch certainly improves upon standard sph , it still over - smoothes the velocity profile as the viscosity is increased before a shock has formed .",
    "this is particularly evident in the velocity profile of the @xmath124 case ( bottom ) near @xmath125 .",
    "the new switch keeps the viscosity low , in the @xmath124 case an order of magnitude lower than the m&m method .",
    "in fact , the agreement between our method and the high - resolution grid code is as good as one can possibly expect at the given resolution , in particular the velocity plateau and density amplitude around @xmath125 in the @xmath124 case ( bottom ) are correctly modelled .      in this test ,",
    "a gaseous ring orbits a central point mass , neglecting the self - gravity of the gas .",
    "initially , the ring is in equilibrium : pressure forces , attraction by the point mass , and centrifugal forces balance each other .",
    "the keplerian differential rotation implies that the flow is shearing and any viscosity causes the ring to spread @xcite .",
    "this is indeed what @xcite found in sph simulations without pressure forces .",
    "@xcite also found an instability to develop from the inner edge , which quickly breaks up the ring .",
    "they argue convincingly that this is the viscous instability @xcite , which causes eccentric orbits at the inner edge of the ring to become more eccentric due to the viscous deceleration peaking at apo - centre .",
    "@xcite performed sph simulations of the same problem but including pressure forces .",
    "they find a similar break - up of the ring after only few rotations and blame it on an inadequacy of the sph scheme itself .",
    "we strongly suspect that @xcite encountered a form of the clumping instability , which appears to be particularly strong in 2d simulations of strong shear flows ( though it may have been a dynamical instability inherent to gaseous keplerian rings , e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "this numerical instability grows on a local hydrodynamical time and may therefore be suppressed by choosing the sound speed @xmath71 much lower than the rotation speed @xmath126 .",
    "indeed , @xcite and @xcite , who repeated these and similar experiments with a very low sound speed , found no such numerical instabilities .",
    "a detailed investigation of these issues is clearly beyond the scope of our study and we merely compare our new scheme to previous methods for pressure forces with @xmath127 when the viscous instability should strike after few rotations depending on the strength of the artificial viscosity .    in our test , @xmath128 for the central point mass , while the gas ring has gaussian surface density centred on @xmath129 with width ( standard deviation ) @xmath130 represented by @xmath131 particles initially placed according to the method of @xcite .",
    "this implies an orbital period of @xmath132 and velocity of @xmath133 at the ring centre .",
    "we choose a sound speed of @xmath134 to ensure that any dynamical instabilities of inviscid rings become important only after many periods .",
    "figure [ fig : ring ] shows the particle distributions at various times for different sph schemes . only with our new method ,",
    "the rings stay in their initial equilibrium configuration over at least five periods , while for the other methods , the inner parts of the ring soon become disordered leading to a catastrophic break - up after a few periods .",
    "it is noteworthy that this failure occurs despite the balsara switch , which was designed specifically for applications like this .",
    "note that without the viscosity limiter @xmath135 of equation  ( [ eq : xi ] ) , our novel method fails , precisely because of shear causing false detections of flow compression ( as highlighted in ",
    "[ sec : shear ] and appendix  [ app : divv ] ) .",
    "we also run similar tests with the central point mass replaced by a mass distribution ( plummer sphere or kuzmin disc ) with gravitational potential @xmath136 with @xmath137 , such that the rotation curve of the disc also contains a rising part , similar to the situation in galactic discs .",
    "the outcome of these simulations ( not shown ) is essentially identical to that for the pure keplerian rings : only our new method with viscosity limiter does not fall prey to the viscous instability .",
    "the pulsations of a polytropic sphere are a good test for the adverse effects of artificial dissipation @xcite .",
    "we set up a polytropic sphere of @xmath138 particles and induce oscillations in its fundamental mode ( e.g. * ? ? ?",
    "* ) with relative amplitude of @xmath139 in radius and a period of @xmath140 .    in the absence of viscosity",
    "we expect the radial oscillations to continue with the initial amplitude and period over many oscillations .",
    "however , as with any numerical method some small amount of numerical dissipation may appear .",
    "nonetheless , such effects should be small compared to the dissipation caused by artificial viscosity . since the size of the radial perturbations increases with radius , we expect the oscillations to be small at the centre of the polytrope and therefore our new method to keep the viscosity low there .",
    "however , at the edge the size of the oscillations is more significant , and we may see an increase in viscosity at this point .    in order to track the oscillations , we monitor in fig .",
    "[ fig : polyosc ] the time evolution of the virial ratio @xmath141 where @xmath142 , @xmath143 , and @xmath4 , are the kinetic , internal , and the gravitational energies , respectively . at maximum contraction",
    "the virial ratio is at its peak and at maximum expansion the virial ratio is lowest . with no artificial viscosity ( solid curves in fig .",
    "[ fig : polyosc ] ) the wave remains at constant amplitude barring a slight initial drop .",
    "the period averaged over 25 oscillations is @xmath144 , only slightly larger than the expected value .",
    "the reason for this discrepancy is most likely the unavoidable deviation of the ( finite - resolution ) sph model from a perfect polytropic sphere .",
    "this deviation also means that our sph model is not exhibiting a pure eigenmode , but in addition contains some higher - order modes at low amplitudes , resulting in some beating between them .    the m&m method results in a slow but continuous decay of the oscillations , though the period is hardly affected .",
    "this damping can be blamed largely on the finite @xmath41 ( standard sph damps the oscillation ten times faster ) .",
    "conversely , our new method , hardly damps the oscillations at all , because @xmath29 is kept very small ( except for the outermost layers where @xmath29 is still below the m&m values ) .",
    "we also run simulations where the oscillating polytropic sphere is on a circular orbit 20 times the radius of the sphere around a point mass 100 times that of the sphere ( corresponding to a period of 56 time units ) . with this choice ,",
    "the tidal radius is approximately four times the radius of the gas sphere , implying that tides are strong but not catastrophic .",
    "since the orbital accelerations are much larger than those due to the polytropic oscillations , this is a tough test for any numerical scheme . in particular",
    ", eulerian methods should have severe problems ( this does exclude using co - rotating coordinates , which do not allow for tidal evolution of the orbit and are unavailable for eccentric orbits ) .",
    "the time evolution of the virial ratio and the viscosity parameter @xmath29 are shown in fig .  [",
    "fig : polypoint ] for the same viscosity schemes as for the isolated case in fig .",
    "[ fig : polyosc ] .",
    "first note that the undamped simulations ( solid curves ) behave differently from the isolated case , exhibiting variations and a slight decay , both of which are most likely caused by the tidal field .",
    "as to be expected for any lagrangian scheme , both sph methods perform very similar to the isolated case , because neither @xmath55 nor @xmath76 are affected by the orbital acceleration .",
    "in this section , we subject our method to situations where artificial viscosity is required , mainly high - mach number shocks , and our aim is to demonstrate that it performs at least as well as the m&m method .      the @xcite shock tube test is a standard test for any shock capturing method and consists of an initial discontinuity in pressure and density leading to the production of a rarefaction wave , contact discontinuity and shock wave , which forms from the steepening of a subsonic wave .",
    "the whole system is subsonic with a maximum mach number of @xmath145 in the pre - shock region .",
    "we perform the test in 3d at a resolution of 200 particle layers in the high - density region .",
    "the density , energy , velocity , and viscosity for standard sph as well as the m&m and our method are shown in fig .",
    "[ fig : sod ] . as for the 1d ram test ( see fig  [ fig : source ] ) , our new method switches on viscosity already in the pre - shock region peaking about one smoothing length before the actual shock front ( which travels to the right in fig .",
    "[ fig : sod ] ) , whereas the m&m switch turns on viscosity later , lagging our method by about four particle separations . as a consequence ,",
    "the transition of the fluid values across the shock front is slightly smoother with our method than with the m&m method .",
    "note that the irregularities around the contact discontinuity at @xmath146 common to all schemes tested are not related to artificial viscosity ( the irregularities in @xmath29 at that point could be removed by choosing non - zero initial @xmath29 at the initial discontinuity ) ; they can be alleviated by artificial conductivity @xcite .      in  [ sec",
    ": av : behaviour ] and fig .",
    "[ fig : source ] we already demonstrated that our new method is superior to the m&m scheme in resolving ` subsonic shocks ' ( velocity discontinuities smaller than the sound speed ) and comparable in resolving shocks of mach number @xmath147 . here , we extend this comparison to high mach numbers .",
    "[ fig:1dram50 ] shows the result for the 1d ram test with @xmath148 . the @xcite version of the m&m method , which uses equation  ( [ eq : davdt : alt ] ) with @xmath47 , is implemented in some contemporary sph codes , and has been used in our tests so far , fails this test : @xmath29 remains too low and as a consequence the velocity discontinuity is not correctly smoothed and some post - shock ringing occurs .",
    "to give credit to @xcite , we also tested their original method and find it to work well ( stars in fig .",
    "[ fig:1dram50 ] ) .",
    "our new method works about as well as the original m&m scheme , with @xmath29 reaching the same level , though our scheme detects the coming shock much earlier : @xmath29 is ahead of the original m&m method by about four particle separations .    whilst the main role of artificial viscosity is to resolve shocks by transferring entropy ,",
    "a secondary but vital role is to prevent particle penetration , which requires strong viscosity in high mach number shocks .",
    "@xcite performed many tests to determine the value of the parameters @xmath29 and @xmath149 needed to prevent particle penetration in ram shock tests of various mach numbers . for particles arranged in face - centred - cubic or cubic grids , bate found that appropriate values for the viscosity parameters can prevent particle penetration for shocks up to @xmath150 .",
    "most sph practitioners opt for a value of @xmath151 @xcite .    to determine the correct value of @xmath149 required for the new scheme , we perform high - resolution 3d runs of ram shocks with @xmath152 and various values for @xmath153 .",
    "we smooth the initial velocity discontinuity , as suggested by @xcite , to provide the method with a situation realistic for sph , such as would have arisen for a shock forming from continuous initial conditions .    for different values of @xmath153 with our viscosity scheme and the two variants of the m&m switch , we plot in fig .",
    "[ fig:3dram ] the @xmath154 and @xmath155 positions ( for all values of @xmath156 ) of particles near the shock front at a late time .",
    "the colour coding distinguishes particles which at that time should be up- ( red ) or downstream ( green ) .",
    "our scheme prevents particle penetration with @xmath157 ( for @xmath23 there is one layer of overlap ) .",
    "the original m&m scheme with the standard choice @xmath151 also avoids particle penetration , but not the @xcite version , again a consequence of too little viscosity .",
    "this test combines a shock with a perpendicular shear and presents a difficult test for any sph scheme .",
    "we use periodic boundary conditions and start from a face - centred cubic grid and velocities @xmath158 in fig .",
    "[ fig : shear : shock ] , we present results for various sph simulations as well as a grid - code run for @xmath159 .",
    "the m&m method produces a large viscosity due to the shear - induced errors in @xmath55 , leading to spurious results .",
    "using the balsara limiter with either m&m or standard sph gives in much better results , though the shock is clearly over - smoothed .",
    "the new scheme is able to limit the viscosity to the correct level , allowing good capturing of the shock and retaining particle order in the post - shock region .",
    "note that this is a difficult test for any sph implementation : without viscosity reduction ( as in standard sph ) the shear flow is strongly damped , while viscosity reduction schemes ( m&m as well as ours ) suffer from the problem of shear - induced errors .",
    "these potentially result in too much viscosity and over - smoothing of the shock .",
    "our limiter was able to control this problem , but for yet larger ratios @xmath160 of shear to shock amplitude this problem becomes too difficult for any sph implementation .      in this test",
    "the inward gravitational pull of a gas cloud exceeds its outward pressure force causing the cloud to collapse under its own self - gravity .",
    "the initial conditions consist of a gas sphere with density profile @xcite @xmath161 for @xmath162 and @xmath163 for @xmath164 .",
    "initially the gas is at rest and has constant specific internal energy @xmath165 , which corresponds to a virial ratio @xmath166 .",
    "the initial gravitational inward pull is the same at each radius , while the pressure forces decline outwards , leading to collapse and , as a consequence , formation of a shock , which steepens and evolves into a strong shock propagating outwards as more incoming material joins the jam . even though the problem is initially spherically symmetric , the sph realisation of initial conditions can not be exactly spherically symmetric and",
    "the system may well evolve away from sphericity , for instance driven by dynamical instabilities .",
    "we use a unit system such that @xmath167 and represent the cloud by 100280 sph particles , initially placed on a face - centred - cubic grid which is then radially stretched to match the density .",
    "[ fig : evrard ] compares the simulation results for our method , the original m&m method , and a 1d calculation by @xcite using the piece - wise parabolic method ( ppm ) .    at early times",
    "( @xmath168 , left column ) the results from all three methods match very well , but the m&m scheme already shows a large viscosity . at later times a shock forms ( at @xmath169 by @xmath170 ) , which moves outwards until it reaches the end of the sphere , when a significant fraction of the gas still has outwards velocities ( by @xmath171 ) .",
    "the most obvious difference between the two sph schemes is the amount of ( artificial ) dissipation : the m&m method is much more viscous , resulting in significant over - smoothing of the shock front by @xmath170 accompanied by unphysical pre - shock heating as visible in the entropy ( @xmath172 ) profile .",
    "our new scheme agrees better with the 1d calculation , in particular in the inner ( post - shock ) regions .",
    "note that with our new method @xmath29 peaks well before the shock arrives ( at @xmath173 ) , while for the m&m method the peak in @xmath29 appears actually slightly after the shock .",
    "we found this a valuable test as early versions of our scheme tended to be far too viscous , while our final version passes this test ahead of the m&m switch .",
    "standard sph ( not shown in the figure ) shows similar results , though the shock at @xmath170 appears less smoothed than with the m&m method but more smoothed than with the new scheme .",
    "any hydrodynamical numerical method requires some form of artificial viscosity in order to resolve shocks ( in grid methods , artificial viscosity is implicit in the riemann solver , * ? ? ?",
    "* ) . in grid codes , such as @xcite ,",
    "interpolation methods are employed to effectively suppress artificial viscosity away from shocks .",
    "most sph simulations to this date hardly use such precautions and , as a consequence , adiabatic oscillations and shear - flows are damped . note",
    "that this affects state - of - the - art simulations of , e.g.  galaxy formation , which usually only employ @xcite s ( @xcite ) rather inefficient method to reduce some adverse effects of artificial viscosity on rotation discs .",
    "the method of @xcite , which reduces the default amount of artificial viscosity by an order of magnitude compared to standard sph practice , has only recently been recognised as advantageous . in this method ,",
    "explained in detail in ",
    "[ sec : av : mm ] , individual artificial viscosities @xmath33 are adapted by integrating a differential equation . though constituting a major improvement",
    ", this method remains unsatisfactory , because it still damps adiabatic oscillations and over - smoothes weak shocks , as we argued in ",
    "[ sec : av : novel ] and demonstrated in  [ sec : test : suppress ] .    in  [ sec",
    ": av : novel ] , we present a novel method , which improves upon that of @xcite in four important ways .    *",
    "we set @xmath97 enabling @xmath56 away from shocks and effectively modelling the fluid as inviscid .",
    "* we use @xmath174 rather than @xmath83 as shock indicator .",
    "this distinguishes pre - shock from post - shock regions ( where @xmath60 but @xmath83 ) and discriminates much better between converging flows and weak shocks .",
    "* we set @xmath33 directly to an appropriate local value @xmath67 , instead of growing it by integrating a differential equation .",
    "* we use an improved estimator for @xmath55 and @xmath76 and employ a limiter to avoid viscosity driven by shear - induced errors .",
    "together these novelties result in a significantly improved artificial viscosity method , in particular the viscosity is increased to an appropriate level well before an incoming shock .",
    "the implementation details , i.e.the precise way of setting @xmath67 from @xmath76 and the exact form of the limiter , may well be subject to improvements . any reader who considers modifying these details is advised to consider the behaviour of the resulting method for a test suite comprising noise suppression as well as shear and strong shocks , for example the tests of figures  [ fig : noise ] , [ fig : ring ] , and [ fig : shear : shock ] .    for static equilibria @xmath175 and @xmath176 , and our new shock indicator ( as well as the m&m shock indicator )",
    "are only triggered by velocity noise .",
    "as long as particle order is maintained , such noise triggers only negligible amounts of viscosity , unlike the situation with the m&m method , whose minimum viscosity @xmath39 is often sufficient to affect the simulations ( as demonstrated in ",
    "[ sec : test : suppress ] ) . nonetheless , the noise - induced viscosity is sufficient to suppress particle disorder , as demonstrated in  [ sec : av : amin ] .    for dynamic equilibria @xmath175 ( and @xmath177 ) but @xmath178 .",
    "however , in multi - dimensional flows strong shear induces false detections of @xmath55 ( and @xmath76 ) , even with best possible particle order , for reasons explained in appendix  [ app : divv : fail ] . in simulations of differentially rotating discs",
    ", this problem strongly affects the m&m method ( even when using the balsara switch ) .",
    "we avoid this problem by applying a limiter ( see  [ sec : shear ] ) as well as using improved estimators for @xmath55 and @xmath76 , see appendix  [ app : divv : good ] for details .",
    "( alternatively , if no strong shear flows are present , the standard estimators should suffice , though still in conjunction with a limiter using @xmath179 as a proxy for the shear amplitude . )",
    "these improved estimators also provide the full velocity and acceleration gradient matrices for each particle ( and increase the computational costs by @xmath180 ) .",
    "the knowledge of the velocity gradient matrix @xmath181 and its traceless symmetric part , the shear @xmath182 , is also useful for implementing physical viscosity @xmath183\\ ] ] ( with @xmath184 and @xmath185 the shear and bulk viscosity coefficients ) in sph .    in sections",
    "[ sec : av : amin ] , [ sec : test : suppress ] , and [ sec : test : shock ] , we demonstrate convincingly that our technique successfully deals with the following four situations .    * shocks * : :    are resolved at least as well , if not better , than with any previous    technique ; * adiabatic oscillations * , : :    such as sound waves or stellar pulsations , remain undamped over many    periods , which was not possible with any previous sph implementation ; * strong shear flows * , : :    such as in accretion discs , are modelled virtually inviscid , while    shearing shocks are well resolved without being over - smoothed ; * particle disorder * : :    is suppressed at least as well as with the m&m method .    in particular , in the regime of convergent flows and weak shocks our new method is far superior to any previous scheme , which all required a significant increase in resolution just to suppress adverse effects of artificial viscosity .      research in theoretical astrophysics at leicester is supported by a stfc rolling grant .",
    "we thank all members of the leicester theoretical astrophysics group , in particular graham wynn and justin read , for helpful discussions , seung - hoon cha for contributing the gph data to fig .",
    "[ fig:1d_sound ] , matthias steinmetz for providing the ppm data of the evrard test for fig .",
    "[ fig : evrard ] , and the anonymous referee for helpful comments and enhanced scrutiny .",
    "d. , 1995 , journal of computational physics , 121 , 357    m. , 1995 , phd thesis , university of cambridge , uk    a. , stamatellos d. , whitworth a.  p. , 2009",
    ", , 395 , 2373    s .- h .",
    ", 2002 , phd thesis , cardiff university , uk    s .- h . , whitworth a.  p. , 2003",
    ", , 340 , 73    j.  p. , 1980",
    ", theory of stellar pulsation .",
    "princeton university press , princeton , nj , usa    w. , 2002 , journal of computational physics , 179 , 27    k. , vazza f. , brunetti g. , tormen g. , 2005 , , 364 , 753    a.  e. , 1988 , , 235 , 911    r.  a. , monaghan j.  j. , 1977 , , 181 , 375    r.  a. , monaghan j.  j. , 1983 , , 204 , 715    p. , narayan r. , 1985 , , 213 , 7p    y. , inutsuka s .- i .",
    ", 2002 , , 569 , 501    l.  b. , 1977 , , 82 , 1013    d. , pringle j.  e. , 1974 , , 168 , 603    y.  e. , postnov k.  a. , prokhorov m.  e. , 1994 , , 266 , 583    s.  t. , murray j.  r. , monaghan j.  j. , 1996 , publications of the astronomical society of australia , 13 , 66    z. , wickramasinghe d. , bicknell g.  v. , 1993 , , 264 , 691    j.  j. , 1992 , , 30 , 543    j.  j. , 1997 , journal of computational physics , 136 , 298    j.  j. , 2006 , , 365 , 199    j.  j. , lattanzio j.  c. , 1985 , , 149 , 135    j.  p. , monaghan j.  j. , 1997 , journal of computational physics , 136 , 41    j.  c.  b. , pringle j.  e. , 1984 , , 208 , 721    j.  c.  b. , pringle j.  e. , 1985 , , 213 , 799    d.  j. , 2004 , phd thesis , university of cambridge , uk    d.  j. , 2008 , journal of computational physics , 227 , 10040    s. , davies m.  b. , thielemann f .- k .",
    ", piran t. , 2000 , , 360 , 171    g.  a. , 1978 , journal of computational physics , 27 , 1    v. , 2005 , , 364 , 1105    v. , hernquist l. , 2002 , mnras , 333 , 649    m. , mller e. , 1993 , , 268 , 391    r. , 2002 , , 385 , 337    m. , nelson a.  f. , naab t. , burkert a. , 2009 , , 184 , 298",
    "for completeness , we give here a brief description of our sph method , which is largely similar to previous methods , but may differ in some details .",
    "let @xmath81 denote the number of spatial dimensions , then we adapt the individual smoothing lengths @xmath5 such that @xmath186 with @xmath187 a global constant , defined in terms of the number @xmath188 of neighbours , the mass @xmath189 of each sph particle , and the volume @xmath190 of the unit sphere .",
    "in this work , we use @xmath191 and 40 for @xmath192 and 3 dimensions , respectively . inserting the density estimator ( [ eq : est : rho ] ) , we find @xmath193 where we have re - written the sph kernel as @xmath194 with the dimensionless function @xmath195 . for this work , we employ the usual cubic spline kernel @xcite @xmath196        2(1-r)^3     & 1/2<r<1 , \\\\[0.5ex ]        0            & \\mathrm{otherwise}.      \\end{array}\\right.\\ ] ] at each time step , the @xmath5 are adjusted by performing one newton - raphson step in @xmath197-@xmath198 space , i.e.@xmath199 with a factor of order unity @xmath200 where @xmath201 and @xmath202 .",
    "this method converges extremely well , except when @xmath5 was much too small . in this case , faster convergence can be achieved by subtracting the self - contribution ( which does not depend on @xmath5 ) .",
    "thus , whenever @xmath203 we use instead of ( [ eq : h : adapt ] ) @xmath204 the time derivatives @xmath205 are obtained by demanding @xmath206 : @xmath207      we use sph equations of motion derived from the simple sph lagrangian @xmath208 . together with the relation in the lagrangian with @xmath209 and consider the entropy function @xmath210 to be constant @xcite . ]",
    "@xmath211 , this gives @xmath212 where the factors @xmath213 and @xmath214 ( equation [ eq : f ] ) arise from the fact that the derivatives @xmath215 have to be taken at fixed @xmath216 .",
    "the work done by these pressure forces has to be balanced by @xmath217      for the artificial viscosity drag and heating we actually use @xmath218 with @xmath219 , where @xmath220 while the parameter @xmath221 has the meaning of @xmath153 for traditional sph .",
    "note that equations ( [ eq : dv : av ] ) and ( [ eq : dv ] ) differ only by @xmath222 .",
    "the difference between equations ( [ eq : du : av ] ) and ( [ eq : du ] ) is more pronounced since , similarly to equation ( [ eq : udot ] ) , we do not symmetrise the contributions w.r.t .  @xmath7 and @xmath223 .",
    "our scheme employs a kick - drift - kick leap - frog time integrator , which is second - order accurate . with this scheme ,",
    "a full ( global ) time step of size @xmath224 consists of the following sub - steps ( ` @xmath225 ' means ` is replaced by ' ) .",
    "* initial kick * : :    compute @xmath226 and @xmath11 at    half step @xmath227          \\tilde{u}_i & = & u_i + \\tfrac{1}{2}\\,\\delta          t\\,\\dot{u}_i .",
    "\\end{array}\\ ] ] * full drift * : :    advance @xmath228 and @xmath2 by a full    step : @xmath229 * prediction * : :    predict @xmath226 , @xmath11 , and    @xmath5 at full step : @xmath230 * sweep 0 * : :    compute @xmath231 and @xmath213    ( equations [ eq : mh ] and [ eq : f ] ) . * adapt * : :    adjust @xmath5 ( equation [ eq : h : adapt ] or    [ eq : h : adapt : better ] ) . * sweep 1 * : :    compute @xmath232 , @xmath213 , and    @xmath205 ( eqs .",
    "[ eq : mh ] , [ eq : f ] , and [ eq : hdot ] ) as well    as @xmath233 ,    @xmath234 ,    and @xmath235 ( eqs .",
    "[ eq : divv : new ] , [ eq : dtdivv ] , and [ eq : r ] ,    using @xmath236 and    @xmath55 from    the previous time step ) . * between sweeps * : :    obtain @xmath237 and @xmath238 from    @xmath232 and @xmath11 via the equation of    state , and adapt @xmath33 via ( using eqs .",
    "[ eq : tau ] and    [ eq : a : loc ] ) @xmath239 * sweep 2 * : :    compute @xmath240 ( eqs .",
    "[ eq : vdot ] and    [ eq : dv : av ] plus gravitational forces ) and @xmath241    ( eqs .",
    "[ eq : udot ] and [ eq :",
    "du : av ] plus external heating or cooling ) . * final kick * : :    set @xmath226 and @xmath11 at full    step : @xmath242          u_i      & = & \\tilde{u}_i + \\tfrac{1}{2}\\,\\delta t\\,\\dot{u}_i .",
    "\\end{array}\\ ] ]    in the initial kick and prediction steps , the time derivatives are known from the previous time step ( in case of the very first time step , they need to be precomputed ) .",
    "note that the quantities predicted in ( [ eq : pred ] ) enter the final @xmath226 and @xmath11 only indirectly via the computation of the time derivatives .",
    "we use an oct - tree , generated just before sweep 0 , to find all interacting particle pairs , which are then remembered in an interaction list , whereby allowing for the fact that @xmath5 may grow slightly during adjustment ( just after sweep 0 ) . utilising this interaction list in sweeps 1 and 2",
    "is much faster than further tree walks .",
    "the same oct - tree is also used in computing gravitational forces , as outlined by @xcite .",
    "our scheme can also be implemented with adaptive individual time steps organised in a hierarchical block - step scheme , though we have not used this in the tests presented in this study .",
    "our constraint that @xmath231 be constant ( see  [ sec : adapt ] ) implies @xmath243 . together with the continuity equation @xmath244 and equation  ( [ eq : hdot ] ) this yields the simple velocity - divergence estimate @xmath245 while this estimate satisfies the continuity equation for the sph density estimate @xmath232 , it is not necessarily accurate . to see this ,",
    "consider the matrix ( @xmath246 denotes the outer or dyadic vector product ) @xmath247 with @xmath248 some weighting factor . assuming a smooth velocity field , we may replace @xmath249 in equation  ( [ eq : d ] ) with its taylor expansion @xmath250 , where @xmath251 is the gradient of @xmath252 at position @xmath2 , and obtain @xmath253 with the symmetric matrix @xmath254 comparing ( [ eq : d ] ) and ( [ eq : t ] ) to the simple estimator ( [ eq : divv : std ] )",
    ", we see that the latter corresponds to ( conveniently dropping the index @xmath7 ) @xmath255 and the weights @xmath256 .",
    "if we split @xmath181 into its isotropic part ( divergence ) , the symmetric traceless part @xmath182 ( shear ) , and the antisymmetric part @xmath257 ( vorticity ) , @xmath258 and insert it into  ( [ eq : dvt ] ) , we find for the simple estimator ( [ eq : divv : std ] ) @xmath259 where @xmath260 denotes the anisotropic ( traceless ) part of @xmath261 .",
    "thus , the simple estimator  ( [ eq : divv : std ] ) contains an @xmath262 error term , which originates from anisotropy of @xmath261 in conjunction with velocity shear ( owing to the symmetry of @xmath261 the vorticity is harmless ) . for perfectly symmetric particle distributions @xmath263 , but in general @xmath264 such that in the presence of strong shear even a small residual @xmath260 results in a failure of the simple estimator ( [ eq : divv : std ] ) .",
    "this typically happens in differentially rotating discs , where ( i ) the velocity field is divergent - free but contains shear and ( ii ) even in the absence of noise @xmath264 owing to the shearing particle distribution .      from equation  ( [ eq : dvt ] ) , we can also estimate @xmath265 which allows an improved divergence estimator @xmath266 in order to assess the error of this estimator , let us expand the flow to second order , replacing equation  ( [ eq : dvt ] ) with ( dropping the index @xmath7 and using suffix instead of matrix notation ) @xmath267 with the symmetric tensor @xmath268 . inserting this into  ( [ eq : v : est ] )",
    "we find @xmath269 thus , while this estimator avoids an @xmath262 error , we still have an @xmath270 error term ( since @xmath271 is one order higher in @xmath27 than @xmath261 ) .",
    "we can _ reduce _ the @xmath270 error by a careful choice of the weights @xmath248 .",
    "if , for instance , @xmath272 then @xmath273 to leading order in the _ continuum limit _ by virtue of the isotropy of the kernel .",
    "this limit , which is commonly used to assess sph estimators , replaces @xmath274 with @xmath275 under the assumption of a smooth density without particle noise , which causes the @xmath262 error term in the simple @xmath55 estimator , vanishes . ] .",
    "as these conditions are hardly ever truly satisfied , we can only reduce but not eliminate the @xmath270 error term  as we do not even try to avoid the @xmath276 error ( hidden in ` h.o.t . '",
    "above ) , such a reduction should be okay in most cases .",
    "we can estimate @xmath76 either from the change in the estimated @xmath55 over the last time step or as the trace of @xmath277 , the total time derivative of @xmath181 . since ( with @xmath278 the gradient of the acceleration ) @xmath279 ( a good exercise for your undergraduate students ) , we can estimate @xmath280 here , the estimate @xmath281 is obtained from the accelerations at the previous time step in a way analogous to estimating @xmath282 , in particular we need to compute the matrix @xmath283 and its inverse only once . the lowest - order error in this estimate",
    "again is @xmath284 , such that reducing @xmath285 by careful choice of the weights remains a good idea .",
    "note that , by virtue of equation  ( [ eq : vdot = a - v^2 ] ) , we could estimate @xmath76 also as @xmath286 with the acceleration divergence @xmath287 estimated using the standard divergence estimator , in the hope that its @xmath262 error term is small since the acceleration is hardly sheared ."
  ],
  "abstract_text": [
    "<S> in smooth - particle hydrodynamics ( sph ) , artificial viscosity is necessary for the correct treatment of shocks , but often generates unwanted dissipation away from shocks . </S>",
    "<S> we present a novel method of controlling the amount of artificial viscosity , which uses the total time derivative of the velocity divergence as shock indicator and aims at completely eliminating viscosity away from shocks . </S>",
    "<S> we subject the new scheme to numerous tests and find that the method works at least as well as any previous technique in the strong - shock regime , but becomes virtually inviscid away from shocks , while still maintaining particle order . in particular sound waves or oscillations of gas spheres </S>",
    "<S> are hardly damped over many periods .    </S>",
    "<S> [ firstpage ]    hydrodynamics  methods : numerical  methods : @xmath0-body simulations </S>"
  ]
}