{
  "article_text": [
    "a prevalent view in molecular systems biology is that the noise in cellular reaction networks , arising intrinsically from low copy numbers of macromolecules , can have a substantial impact on function @xcite .",
    "two frequently used models for simulating stochastic reaction - diffusion systems are the reaction - diffusion master equation ( rdme ) @xcite and the smoluchowski model @xcite , which we will refer to as the mesoscopic and microscopic models , respectively . in the rdme",
    "the computational domain is divided into voxels .",
    "diffusion is simulated as discrete jumps between adjacent vertices in the mesh .",
    "reactions can occur locally when reactants are present in the same voxel .",
    "the rdme is attractive from a computational perspective ; it is the logical extension of spatially homogenous simulations based on the gillespie algorithm @xcite , and keeps track of the location of molecules only up to the resolution of the mesh , hence allowing for coarse - graining .",
    "publicly available software packages for mesoscopic simulations based on the rdme include mesord @xcite , smartcell @xcite and urdme @xcite .    on a finer modeling level ,",
    "the smoluchowski model treats diffusion and reaction in continuous space , with molecules explicitly represented as spheres with a certain interaction radius .",
    "as such , it is an example of a model commonly referred to as particle - tracking .",
    "software based on the smoluchowski model are smoldyn @xcite , mcell @xcite and green s function reaction dynamics ( gfrd ) @xcite .",
    "smoldyn and mcell both discretize time whereas gfrd is continuous in time , making it more accurate at fine scales .",
    "a well known property of the mesoscopic model is that it converges to the classical reaction - diffusion partial differential equation in the macroscopic limit . for a system approaching the microscopic regime ,",
    "it is tempting to think of the rdme as a better and better approximation to the smoluchowski model for finer and finer mesh resolutions .",
    "this picture is misleading , as in fact , it has been shown that as the size of the voxels in an infinite 3d domain decreases , all bimolecular reactions are eventually lost in the mesoscopic model @xcite .",
    "recent work using gfrd has demonstrated that fast , microscopic rebinding events can substantially affect the macroscopic properties of a biochemical signal cascade when reactions are highly diffusion limited @xcite . to accurately simulate such systems",
    "requires a fine spatial resolution . on these scales",
    ", the conventional rdme may be too inaccurate to capture even the qualitative behavior predicted by the microscopic model @xcite .",
    "the fact that the conventional mesoscopic model becomes inaccurate as we approach the microscopic level is not surprising , as we are moving out of the domain of validity for which it was derived .",
    "however it can pose a real practical problem , as it is hard to know _ a priori _ if a simulation with the rdme will yield useful or misleading results .",
    "this is especially true for biochemical models with multiscale properties , which are frequently encountered in molecular biology .",
    "simply resorting to e.g. gfrd whenever in doubt is currently not feasible in general due to the high computational cost for systems with many particles . a natural approach to remedy",
    "this problem is to try to extend the domain of validity of the rdme as the mesh size tends to zero .",
    "isaacson @xcite suggests that one way of doing this would be to let the association rate constants depend explicitly on the meshsize .",
    "recently , approaches to make such corrections to the rdme have been proposed @xcite .    in this paper",
    "we show , by a simple argument , that below a certain critical size of the mesh it will be impossible to make the rdme consistent with the smoluchowski model by local modifications to the bimolecular rates .",
    "our result is valid for finite domains in 2d and 3d , and for mesh - dependent mesoscopic association rates . for a simple model problem we derive the correct mesoscopic association rates in 2d and 3d and compute the critical size of the mesh , and show that it can be considerably larger than the interaction radii of the molecules . in this light",
    "we review and discuss recent work in which the rdme has been modified in different ways in order to better agree with the microscale model for very small voxel sizes .",
    "in the mesoscopic model , the computational domain is divided into non - overlapping voxels .",
    "the state of the system is the discrete number of molecules of each biochemical species in each voxel in the mesh . inside voxels ,",
    "the molecules react according to a pre - specified set of rules . in a small time interval @xmath2",
    ", a bimolecular reaction @xmath3 , for example , occurs with probability @xmath4 , where @xmath5 is the mesoscopic rate constant for the reaction , @xmath6 and @xmath7 are the copy numbers of @xmath8 and @xmath9 in that voxel , and @xmath10 is the volume of the voxel .",
    "diffusion is modeled as jumps between adjacent voxels . for a cartesian mesh with mesh spacing @xmath11 , the rate for a diffusive jump",
    "is given by @xmath12 , where @xmath13 is the diffusion constant .",
    "the time evolution of the whole system is described as a continuous - time discrete - space markov process and the probability density function ( pdf ) of the system evolves according to the rdme @xcite . solving for the pdf directly is impossible in general due to the extremely large statespace , but realizations of the process can be generated efficiently using kinetic monte carlo methodology @xcite .      in the smoluchowski model two molecules @xmath8 and @xmath9",
    "are assumed to move by brownian motion with diffusion constants @xmath14 and @xmath15 , and react with a certain probability at a distance determined by the sum of their reaction radii , @xmath16 and @xmath17 . for two molecules @xmath8 and @xmath9 , the probability of a bimolecular reaction is governed by the smoluchowski equation . given that the molecules start at positions @xmath18 and @xmath19 at time @xmath20 , the equation for the pdf @xmath21 of the new relative position @xmath22 ( in a spherical coordinate system @xmath23 ) , is given by @xmath24 with initial condition @xmath25 and boundary conditions @xmath26 where @xmath27 , @xmath28 and @xmath29 is the microscopic association rate .",
    "it can be shown that a weighted mean of the positions given by @xmath30 will be normally distributed @xcite , and by sampling a new @xmath31 and @xmath32 we obtain the new positions of the molecules at some time @xmath33 .",
    "an efficient method for simulating systems of molecules is the green s function reaction dynamics ( gfrd ) @xcite method . in gfrd",
    "a system of molecules is decomposed into pairs of molecules by choosing a time step such that any given molecule is unlikely to react with more than one other molecule during that time step .",
    "this reduces the full problem to solving the smoluchowski equation for pairs of molecules .",
    "recent work has demonstrated that the rdme breaks down in the limit of infinitesimal voxels .",
    "isaacson @xcite shows that the probability for the occurrence of bimolecular reactions vanishes with decreasing voxel size for molecules on a lattice in an infinite 3d domain .",
    "the study is restricted to the case where the mesoscopic reaction rates are not dependent on the size of the voxels . here",
    "we present a new and intuitive way to understand the degeneration of the mesoscopic model in finite domains in 2d and 3d , and with mesoscopic reaction rates that may or may not depend explicitly on the mesh .",
    "our analysis will also provide additional insight into why and when this breakdown occurs .    to see why the rdme model can not work for very small voxels ,",
    "it is illustrative to consider the simple process of bimolecular association @xmath34 in 3d , the diffusion - controlled mesoscopic reaction rate @xmath5 is often taken to be @xmath35 this expression will hereafter be referred to as the conventional mesoscopic rate constant .",
    "it is valid for large enough voxels , and in 2d no analogous expression is well - defined .",
    "consider the reaction and , in a cartesian coordinate system , let a molecule of @xmath8 be stationary in some voxel @xmath36 , i.e. @xmath37 , and let @xmath9 diffuse with diffusion constant @xmath15 in a square or cube with side length @xmath38 and with periodic boundary conditions .",
    "let @xmath39 be the average time until the two molecules react in the discretized , mesoscopic model , let @xmath40 denote the average time for a diffusive jump and let @xmath41 be the mesoscopic reaction rate .",
    "once the @xmath9 molecule is in the voxel @xmath36 , the two molecules will react with probability @xmath42 , or the @xmath9 molecule diffuses away one voxel .",
    "thus the two molecules will be on average @xmath43 times in the same voxel before they react .",
    "let @xmath44 denote the average time until the two molecules are in the same voxel for the first time .",
    "the average time for an event ( reaction or diffusion ) given that the two molecules are in the same voxel is @xmath45 , and thus the average time for the @xmath9 molecule to diffuse away one voxel and then back is @xmath46 , where @xmath47 is the average time until the @xmath9 molecule reaches @xmath36 given that it starts one voxel away .",
    "this will be repeated on average @xmath48 times until the molecules react .",
    "we can now write @xmath39 as @xmath49 where @xmath50 .",
    "the following theorem was proven in @xcite .",
    "assume that the molecule @xmath9 has a uniformly distributed random starting position @xmath51 on the lattice , @xmath51 not equal to @xmath52 , and that the molecules can move to nearest neighbors only ( as in the rdme ) .",
    "then as @xmath53 , the following holds : @xmath54 where @xmath55 is the average number of steps until @xmath56 for the first time , @xmath57 is the average number of steps until @xmath56 given that @xmath8 and @xmath9 start one voxel apart and @xmath58 is the number of voxels in the domain .",
    "[ theoremnsteps ]    let @xmath44 be the time until @xmath8 and @xmath9 are in the same voxel for the first time .",
    "then @xmath59 where @xmath11 is the voxel size .",
    "[ cor1 ]    this follows immediately from theorem [ theoremnsteps ] and the fact that @xmath60 , where @xmath61 and @xmath62 is the dimension .    from corollary [ cor1 ] and",
    "equation we conclude that for a sufficiently small voxel size in the discrete space model , we will have @xmath63 ( where @xmath64 is the average time until the molecules react in the microscopic model ) , _ for any choice _ of the mesoscopic rate constant , since @xmath65 for all @xmath66 .",
    "eventually , as @xmath67 , no bimolecular reactions will occur since molecules can only react when they are in the same voxel and @xmath68 , hence @xmath69 .",
    "note that the reason for this effect is not that the diffusion process is inaccurately described at these length scales .",
    "the problem lies in the assumptions that molecules can react only after having diffused to the same voxel .      due to the potential computational advantages of using the rdme over the microscopic model",
    ", it is natural to try to correct the rdme to agree better with the smoluchowski model for fine lattice spacings .",
    "the most obvious approach is to try to adjust the mesoscopic association rate constants in the rdme , making them dependent on the discretization .",
    "this would preserve the local nature of the reactions , and hence the low computational cost of the conventional rdme .",
    "one immediate consequence of the analysis in the previous section , however , is that below a certain mesh size @xmath70 no such local correction can make the mesoscopic mean association rate between two molecules agree with the microscopic model .",
    "in fact , for a given domain and model , this happens precisely when @xmath71 .",
    "this is illustrated in fig .",
    "[ fig : fig1 ] for the case of a square with side length @xmath72 and a cubic domain with side length @xmath73 , with @xmath74 .",
    "if this critical mesh size always occurred for @xmath75 , the problem would be less of a practical issue since the conventional rdme model makes little sense for mesh sizes smaller than the sum of the interaction radii of the molecules .",
    "however , in our example @xmath70 occurs for @xmath76 ( 3d ) and @xmath77 ( 2d ) .",
    "as long as @xmath78 , that is @xmath79 , it is theoretically possible to modify the association rate , i.e. derive a discretization - dependent reaction propensity @xmath80 that will give the same mean association time as the microscopic model . clearly , to be able to give the correct binding times for as large a regime as possible , the modified reaction constant should have the property @xmath81 for @xmath82 .",
    "while our analysis does not preclude the possibility to better match the mean association time by increasing @xmath13 and thus decreasing @xmath44 , this would make the effective diffusion too fast and thus introduce another source of error .",
    ". for @xmath83 , no local correction to the conventional mesoscopic reaction rates exists for the simple problem of diffusion to a target",
    ". ]    fig .",
    "[ fig : hline ] shows a schematic representation of the rdme s behavior as a function of the meshsize . for @xmath84 ,",
    "the rdme makes little sense and we can not expect the model to work in this regime . for @xmath85 the conventional mesoscopic rate constants will work well , but for @xmath86 the rdme will become increasingly inaccurate .",
    "for @xmath87 it is possible to derive mesh and problem dependent reaction rates that make the rdme agree better with the microscopic model .",
    "the precise locations of the critical values @xmath88 , @xmath89 and @xmath70 are model , geometry and discretization dependent",
    ".    in @xcite isaacson expands the analytical solutions of the rdme and the smoluchowski equation for the simple model problem @xmath90 in a series and computes the three leading terms in @xmath11 .",
    "he shows that the two first terms will converge to the same value as @xmath11 tends to zero , but that the difference between the third term will diverge .",
    "there is an @xmath11 that minimizes the difference between the first terms of the expansion .",
    "this does not strictly prove that , for sufficiently small @xmath11 , the error between the solutions increases as @xmath11 decreases , and the result is valid in an unbounded domain , but it still illustrates that for some @xmath86 the reaction rates will need to be modified to make the mesoscopic model accurate . as we have shown here , however , one will eventually reach @xmath70 and the difference between the models will inevitably increase .",
    "recently , two different corrections to @xmath5 have been proposed @xcite . in the 3d case with a cubic domain and a uniform , cartesian discretization , erban and chapman",
    "@xcite consider the simple model problem @xmath91 , @xmath92 .",
    "they derive a mesh - dependent rate expression by matching the true steady - state distribution ( which can be obtained analytically for this simple problem ) to the distribution obtained using a meshsize @xmath11 .",
    "they arrive at the following expression ( in 3d ) @xmath93 they also find a critical mesh size @xmath94 under which no further correction can be made to @xmath5 , where @xmath95 is a unitless constant valid for @xmath96 .",
    "@xmath97 makes the denominator in zero and hence @xmath98 as @xmath99 . below that critical value of @xmath11",
    ", the mesoscopic association reaction is defined to @xmath100 , i.e. association occurs as soon as the molecules are in the same voxel .",
    "thus @xmath101 satisfies the basic requirements of our analysis : the existence of a critical meshsize and the correct limiting behavior as the meshsize tends to that critical value . substituting @xmath5 for the conventional expression and taking @xmath102 we obtain @xmath103 .",
    "note that the propensity function was obtained without any comparison to the microscopic model .",
    "fange et al .",
    "pursue a similar idea in @xcite .",
    "they study the problem @xmath104 , and derive mesoscopic reaction rates such that the equilibration time of the system matches the equilibration time in the smoluchowski model .",
    "they carry out this analysis in 2d and 3d on a disk and a sphere and obtain @xmath105\\ } \\ , \\text{(2d ) } \\end{aligned}\\ ] ] where @xmath106 , @xmath107 is the radius of a disk with area @xmath108 in 2d and a sphere with volume @xmath109 in 3d , @xmath110 in 3d and @xmath111 in 2d .",
    "these expressions do not predict a critical mesh size , but has the property @xmath112 in both 2d and 3d .    based on our analysis",
    "we easily obtain another correction in both 2d and 3d .",
    "equation suggest that we choose @xmath113 to be @xmath114 in order to have @xmath115 . for @xmath11",
    "sufficiently small we get @xmath116 } & ( 2d)\\\\ \\frac{1+(l / h)^3}{\\tau_{\\mathrm{micro}}-1.5164l^3/(6dh ) } & ( 3d ) \\end{array}\\right .",
    "\\label{eq : ourcorr}\\end{aligned}\\ ] ] from these expressions we obtain @xmath117 ( 2d ) ( where @xmath64 has been approximated by the analytical expressions for a disk derived in @xcite ) and @xmath118 ( 3d ) ( with @xmath64 approximated by @xmath119 ) in good agreement with the simulations in fig",
    "the corrections obtained by erban and chapman do not coincide with the corrections obtained by fange et al .",
    ", illustrating how the corrections are dependent on the ansatz used to derive them . on the other hand ,",
    "our corrections given by agree well with erban and chapmans in 3d and predict a similar @xmath70 . as can be seen in fig .",
    "[ fig : qa ] , our corrections match the mean association time well in 2d ( a ) and all corrections give better results than the conventional expression @xmath5 in 3d ( b ) .",
    "interestingly , fange et al .",
    "find experimentally for their example that they can not match the smoluchowski model in ( * ? ? ?",
    "3 ) perfectly using the conventional rdme with the local corrections @xmath120 even for @xmath121 .",
    "instead they modify the lattice model to allow for reactions between molecules in immediate neighboring voxels . in doing",
    "so they match the models all the way down to @xmath122 .",
    "our analysis explains why the local corrections alone were not sufficient , and their results demonstrate the possibility of better agreement with the microscopic model by a generalization of the conventional rdme to allow for neighbor - interactions .    in this paper we have studied the behavior of the rdme for a simple but illustrative model problem : irreversible bimolecular association in the perfectly absorbing limit . for a finite but large @xmath29 (",
    "if the system is less diffusion - limited ) , @xmath70 would shift to the left towards @xmath123 in fig .",
    "[ fig : fig1 ] .",
    "however , for a reversible reaction microscopic reversibility must hold and if @xmath29 is finite then the mesoscopic dissociation rate will be larger than the microscopic dissociation rate for some @xmath79 .",
    "the @xmath70 that we obtain here in the irreversible case will thus be a lower bound for the reversible case . in conclusion , the conventional rdme can not be made consistent with the smoluschowski model since there will always be a meshsize for which no local correction to the reaction rate can give the correct mean association time . above @xmath70 local corrections",
    "can extend the domain where the rdme works well .",
    "however , the corrections will inevitably be model and geometry dependent .",
    "we acknowledge funding from the swedish research council , the royal swedish academy of sciences foa09h-63 , foa09h-64 , u.s doe award de - fg02 - 04er25621 and institute for collaborative biotechnologies grant daad19 - 03-d-0004 ."
  ],
  "abstract_text": [
    "<S> stochastic modeling of reaction - diffusion kinetics has emerged as a powerful theoretical tool in the study of biochemical reaction networks . </S>",
    "<S> two frequently employed models are the particle - tracking smoluchowski framework and the on - lattice reaction - diffusion master equation ( rdme ) framework . </S>",
    "<S> as the mesh size goes from coarse to fine , the rdme initially becomes more accurate . </S>",
    "<S> however , recent developments have shown that it will become increasingly inaccurate compared to the smoluchowski model as the lattice spacing becomes very fine . in this paper </S>",
    "<S> we give a new , general and simple argument for why the rdme breaks down . </S>",
    "<S> our analysis reveals a hard limit on the voxel size for which no local rdme can agree with the smoluchowski model .     _ </S>",
    "<S> @xmath0division of scientific computing , department of information technology + uppsala university , p.  o.  box 337 , se-75105 uppsala , sweden + email : stefan.hellander@it.uu.se + @xmath1department of computer science , + university of california , santa barbara , ca 93106 - 5070 santa barbara , usa . + </S>",
    "<S> email : andreash@cs.ucsb.edu , petzold@cs.ucsb.edu + [ 3pt ] _ </S>"
  ]
}