{
  "article_text": [
    "this paper unites three distinct lines of research that have appeared over the past 40 years . in what was chronologically the first",
    ", asmus schmidt developed a theory of gaussian complex continued fractions based on _ farey circles and triangles _ analogous to the farey subdivision of the real line @xcite . in the second , graham , lagarias , mallows , wilks and",
    "yan laid much of the algebraic groundwork for the study of apollonian circle packings and super - packings @xcite . in the third , romik studied a dynamical system on the tree of pythagorean triples which is conjugate to a euclidean algorithm related to the gauss map for real continued fractions @xcite .    in this work , we define a dynamical system on the complex plane which can be viewed in at least three distinct ways : as a `` reflective '' version of gaussian complex continued fractions ; as a system of reduction on the descartes quadruples of all apollonian circle packings ; or as a dynamical system on the tree of lorentz quadruples , i.e. solutions to @xmath0 . restricted to the real line , it produces a reflective continued fraction algorithm and euclidean algorithm .",
    "our work fits into a long line of work on the number theoretical aspects of apollonian circle packings .",
    "one of the first papers on this subject was @xcite , paving the way for many subsequent works on the arithmetic of such packings .",
    "indeed , many of the results in these subsequent works started as conjectures in @xcite ( see @xcite and @xcite for a summary of these results ) . by and large , the arithmetic questions inspired by the work of graham et .",
    "al . have been of the following nature .",
    "first , one observes that certain apollonian circle packings are _ integral _ , meaning their curvatures ( inverse radii ) are all integral .",
    "consider the set of integer curvatures ( counted with or without multiplicity ) appearing in such a fixed primitive integral apollonian packing .",
    "what can one say about this set of integers : how many primes of bounded size are there , can one describe the integers using local conditions alone , and what should these local conditions be , if so ?    while the question of rational approximation of complex numbers is quite different in flavor than the number theoretic questions just described , it turns out both questions hang on studying the same symmetry group . in the study of integer",
    "curvatures this is the apollonian group , which lives naturally inside the super - apollonian group of @xcite , which , in turn , describes the collection of all integral apollonian circle packings simultaneously .",
    "however , the super - apollonian group can be realized as an index @xmath1 subgroup of the extended bianchi group @xmath2)\\rtimes\\langle{\\mathfrak{c}}\\rangle$ ] .",
    "this bianchi group , analogous to @xmath3 , is the natural setting in which to study gaussian complex continued fraction expansions .",
    "as an indication of this phenomenon , the farey circles and triangles of schmidt ( see figure [ fig : ns1 ] ) , when iterated , actually produce an apollonian super - packing as illustrated in @xcite or figure [ fig : gaussianpacking5 ] .",
    "the super - apollonian continued fraction expansion we describe in this paper was , however , initially inspired by a process described by romik in @xcite . in that paper ,",
    "romik used the group generated by @xmath4 to create a dynamical system on the positive quadrant of the unit circle .",
    "this is a subgroup of the orthogonal group @xmath5 where @xmath6 , and any point @xmath7 on the unit circle corresponds to the solution @xmath8 of the equation @xmath9 , or the pythagorean equation .",
    "indeed , the dynamical system romik constructed acts naturally to walk to the root of a tree of primitive integer pythagorean triples as depicted in figure [ fig : pyth - tree ] .",
    "[ @xmath10 [ @xmath11 , edge label= node[midway , below ] @xmath12 [ @xmath13,edge label = node[midway , left ] @xmath12 ] [ @xmath14,edge label = node[midway , left ]",
    "@xmath15 [ @xmath16,edge label = node[midway , left ] @xmath17 ] [ @xmath18 , edge label = node[midway , left ] @xmath19 [ @xmath20,edge label = node[midway , left ] @xmath12 ] [ @xmath22,edge label = node[midway , left ] @xmath15 [ @xmath23,edge label = node[midway , left ] @xmath17 ] [ @xmath24 , edge label = node[midway , below ] @xmath25 [ @xmath26,edge label = node[midway , left ] @xmath12 ] [ @xmath27,edge label = node[midway , left ] @xmath15 [ @xmath28,edge label = node[midway , left ] @xmath29 ] ]    the fact that pythagorean triples form a tree has been observed many times ; see @xcite .",
    "given any primitive pythagorean triple @xmath30 , which corresponds to the rational point @xmath31 on the unit circle , romik s dynamical system allows one to quickly determine the finite word in @xmath32 which describes the path in the tree from @xmath33 to @xmath30 .",
    "it also associates an _ infinite _ word or expansion in @xmath32 to any irrational point on the first quadrant of the unit circle , and this gives a type of continued fraction expansion .",
    "we refer the reader to @xcite for further details on this beautiful work .",
    "the present paper can be thought of as a version of romik s work in four dimensions .",
    "as we discuss below , apollonian packings are naturally connected to primitive _",
    "lorentz quadruples _ , or coprime quadruples of integers satisfying @xmath34 in this higher dimensional setting , a number of new difficulties arise : for example , the analog of the ternary pythagorean tree above is no longer a tree , and there is not a unique path from any given vertex to the root ( see figure  [ fig : lor - graph ] for a picture of the graph ) .",
    "we will now briefly describe the idea behind super - apollonian continued fractions .",
    "an apollonian packing is obtained by starting with four pairwise tangent circles , and repeatedly inscribing into every region bounded by three existing pairwise tangent circles the unique circle which is tangent to all three .",
    "the number theoretical interest in these packings comes from the fact that if the starting four circles all have integer curvature ( i.e. the reciprocal of each of the radii is an integer ) , then all of the circles in the packing have integer curvature .",
    "this process is depicted in figure  [ pack ] .",
    "these packings have a symmetry which can be described both algebraically and geometrically .",
    "the algebraic interpretation stems from descartes theorem from 1643 , that if four pairwise circles have curvatures @xmath35 , then @xmath36 ; the symmetries of the packing are symmetries of this quadratic form . on the other hand , geometrically , one can embed the apollonian circle packing in the complex plane and describe the symmetries as mbius transformations .",
    "while the curvatures of circles in any one primitive integral apollonian packing give only a thin subset of all primitive integer solutions to @xmath37 , one can use the geometric interpretation of the algebraic symmetry to choose a natural extension to the super - apollonian group of @xcite .",
    "the super - apollonian group acts on descartes quadruples .",
    "the orbit of one descartes quadruple under this larger group will now include all primitive integral apollonian circle packings , nested one inside another densely in the complex plane ; see figure [ fig : gaussianpacking5 ] . to approximate a complex number @xmath38",
    ", we approach @xmath39 with a sequence of descartes quadruples of circles , in the sense that the tangency points of the quadruples ( all of which are rational ) approach @xmath39 .",
    "the sequence of quadruples is generated by repeated applications of generators of the super - apollonian group , so that the continued fraction expansion is a word in the generators .",
    "figure  [ approxpiei ] depicts this process when approximating the number @xmath40 .",
    "in contrast to the real or pythagorean case , since the super - apollonian group is not free , the cayley graph is not a tree , and there are multiple approximation sequences for a given @xmath38 ; a natural choice is given by the normal form of graham , lagarias , mallows , wilks and yan @xcite .",
    "the apollonian super - packing of figure [ fig : gaussianpacking5 ] is the same fractal subdivision of @xmath41 used in the gaussian continued fraction algorithm of schmidt .",
    "however , schmidt s setup involves a different choice of group and generators to navigate the subdivision .",
    "we develop a dynamical system , based on the super - apollonian group , which acts on the plane to generate the continued fraction algorithm ; define an invertible extension to an action on hyperbolic geodesics ; and find an invariant measure .",
    "this process closely follows the development of schmidt s system by schmidt and nakada , as detailed in an appendix .",
    "having described these dynamical systems , we go on to analyse some statistics of the continued fraction expansion .",
    "we also include an analysis of the restriction of the super - apollonian dynamics to the real line , where we recover `` reflective '' real continued fractions . finally , in part to emphasize the variability in possible systems , we briefly consider another dynamical system with the goal of organizing lorentz quadruples by arithmetic complexity .    in future work",
    ", we plan to provide a proof of ergodicity for our continued fraction algorithm , and to develop parallel theories for other imaginary quadratic fields such as @xmath42 .",
    "the paper proceeds as follows .",
    "section [ sec : back ] contains background information on classical continued fractions , lorentz and descartes quadruples , the apollonian and super - apollonian groups and their geometric interpretation as mbius transformations of the complex plane .",
    "this section includes a discussion of graham , lagarias , mallows , wilks and yan s swap normal form and the associated spanning tree of the cayley graph of the super - apollonian group .",
    "section [ sec : dyn ] defines a dynamical system associated to this choice of spanning tree .",
    "first a pair of dynamical systems on the complex plane are described , which compute a gaussian continued fraction expansion of a complex number .",
    "we describe an invertible extension and invariant measure . in section [ sec : lor - des ] , the closely related dynamical systems of lorentz and descartes quadruples are described .",
    "these systems travel to the root along the the swap normal and invert normal form spanning trees .",
    "we relate these to the reduction algorithm for descartes quadruples of graham , lagarias , mallows , wilks and yan . in section [ sec : app ] , we give some consequences of the conjectural ergodicity of the systems , and compare to experimental data .",
    "we plan to demonstrate ergodicity in a follow - up paper . in section [ sec : real ] , we restrict this system to the real line , and recover a `` reflective '' variation on the classical continued fraction algorithm . in section [ sec : lor ] , we briefly consider an alternate dynamical system which respects the arithmetic complexity of lorentz quadruples .",
    "finally , in an appendix , we review the gaussian continued fraction algorithm of schmidt and nakada , and its explicit connection to our work .      figures and experimental data were created with sage mathematics software @xcite and mathematica @xcite .",
    "we would like to thank dan romik for writing the paper that inspired this work , and for several helpful conversations .",
    "we also thank jayadev athreya for his helpful comments and suggestions .",
    "we begin with a brief overview of simple continued fractions on the real line , described from the perspective and in the language we plan to use for complex continued fractions in the remainder of this paper .",
    "the purpose is to provide an explicit analogy for much of what follows .    over the integers ,",
    "the euclidean algorithm is the iteration of the division algorithm , which , for @xmath43 , returns @xmath44 so that @xmath45 , @xmath46 . replacing the pair @xmath47 with @xmath48 , we repeat .",
    "we can illustrate this as @xmath49 , e.g. @xmath50 the transformation taking @xmath47 to @xmath48 can be written in terms of matrices as @xmath51 if @xmath52 , @xmath53 are coprime , the euclidean algorithm terminates at @xmath54 .",
    "we can word backwards from @xmath54 to recover @xmath47 , e.g. @xmath55 the euclidean algorithm gives rise to a map on rationals @xmath56 ( say with @xmath57 coprime ) , and the algorithm produces expressions such as @xmath58 we can extend this map to the interval @xmath59 , i.e. the gauss map @xmath60 mapping @xmath61 to the fractional part of @xmath62 , which is defined piecewise by mbius transformations @xmath63 the effect of this is an infinite continued fraction @xmath64=a_0+\\frac{1}{a_1+\\frac{1}{a_2+\\dots } } , \\",
    "a_0=\\lfloor x\\rfloor , \\",
    "a_n=\\left\\lfloor\\frac{1}{t^{n-1}(x - a_0)}\\right\\rfloor,\\ ] ] and a sequence of convergents @xmath65 to @xmath66 : @xmath67 for irrational @xmath61 , @xmath68 is the left shift map on @xmath69 , @xmath70)=[0;a_2,a_3,\\ldots]$ ] .",
    "the gauss map is @xmath71-to-1 , but we can find an invertible extension @xmath72 defined on pairs @xmath73 , @xmath74 the pairs @xmath75 can be identified with oriented geodesics in the hyperbolic plane , realized as the upper half plane above the real line . specifically , the points @xmath76 and @xmath66 are the past and future points on the ideal boundary in the upper half - plane model .",
    "the extension @xmath72 acts piecewise by isometries , @xmath77 .",
    "( the space of geodesics @xmath78 corresponds to gauss reduced indefinite binary quadratic forms . )",
    "the space of geodesics carries an isometry invariant measure @xmath79 coming from hyperbolic area or haar measure on @xmath80 , which restricts to a @xmath72-invariant measure on @xmath78 since @xmath72 is defined piecewise by isometries . pushing this measure forward to the second coordinate gives the @xmath68-invariant gauss measure @xmath81 on @xmath59 , which is ergodic : @xmath82 for more on continued fractions , see @xcite ( basic properties ) , @xcite ( diophantine approximation ) , @xcite ( ergodicity ) , @xcite ( connection to the geodesic flow and hyperbolic dynamics ) . for an excellent exposition of this view of the gauss measure ,",
    "see @xcite .",
    "we consider the lorentz @xmath83form @xmath84 and the solutions to @xmath85 are called _",
    "lorentz quadruples_. consider the following matrices : @xmath86 @xmath87 @xmath88 @xmath89 we create these matrices by conjugating @xmath90 by all eight possible diagonal matrices with diagonals @xmath91 .",
    "each of the eight resulting matrices is an involution , and preserves @xmath92 in the sense that @xmath93 for the gram matrix @xmath94 of @xmath92 .",
    "we create a cayley graph , @xmath95 , whose vertices are the elements of the group generated by the @xmath96 and where two vertices @xmath97 and @xmath98 are joined by an edge exactly when @xmath99 is one of the @xmath96 . if one takes a quotient of this cayley graph by considering the action of the @xmath96 on lorentz quadruples , one obtains figure [ fig : lor - graph ] .",
    "\\(r ) at ( 0 , 0 ) @xmath100 ; ( r3 ) at ( 0 , 3 ) @xmath101 ; ( r4 ) at ( 3,0 ) @xmath102 ; ( r1 t ) at ( 0,-3 ) @xmath103 ; ( r2 t ) at ( -3,0 ) @xmath104 ; ( r13 ) at ( -3 , 3 ) @xmath105 ; ( r23 ) at ( -2,5 ) @xmath106 ; ( r43 ) at ( 0,6 ) @xmath107 ; ( r1t3 ) at ( 2,5.5 ) @xmath108 ; ( r2t3 ) at ( 2.5,4.5 ) @xmath109 ; ( r3t3 ) at ( 3,3 ) @xmath110 ; ( r14 ) at ( 6,0 ) @xmath111 ; ( r24 ) at ( 5.3,.9 ) @xmath112 ; ( r34 ) at ( 4.5,1.6 ) @xmath113 ; ( r1t4 ) at ( 4,-2 ) @xmath114 ; ( r2t4 ) at ( 5.3,-.9 ) @xmath115 ; ( r4t4 ) at ( 4.5,-1.6 ) @xmath116 ; ( r11 t ) at ( 1.7,-5.4 ) @xmath117 ; ( r2t1 t ) at ( -1.7,-5.4 ) @xmath118 ; ( r3t1 t ) at ( 3,-4.4 ) @xmath119 ; ( r4t1 t ) at ( -3,-4.4 ) @xmath120 ; ( r22 t ) at ( -5.7,0 ) @xmath121 ; ( r1t2 t ) at ( -5.7,1.7 ) @xmath122 ; ( r3t2 t ) at ( -5.7,-1.7 ) @xmath119 ;    \\(r )  ( r3 ) node [ color = black , midway , right , fill = white ] @xmath123 ; ( r ) ",
    "( r4 ) node [ midway , above , fill = white ] @xmath124 ; ( r )  ( r1 t ) node [ color = black , midway , right , fill = white ] @xmath125 ; ( r )  ( r2 t ) node [ midway , above ,",
    "fill = white ] @xmath126 ; ( r3 ) ",
    "( r13 ) node [ midway , below , fill = white ] @xmath127 ; ( r3 )  ( r23 ) node [ midway , below , ] @xmath128 ; ( r2 t )  ( r23 ) node [ very near end , left , ] @xmath129 ; ( r3 )  ( r43 ) node [ midway , left , fill = white ] @xmath124 ; ( r3 )  ( r1t3 )",
    "node [ color = black , midway , left ] @xmath125 ; ( r1 t ) .. controls + ( right:4.1 cm ) and + ( right:4.1 cm ) .. ( r1t3 ) node [ color = black , near end , right ] @xmath123 ; ( r3 )  ( r2t3 ) node [ midway , above ] @xmath126 ; ( r2 t )  ( r2t3 )",
    "node [ very near start , left ] @xmath123 ; ( r3 ) ",
    "( r3t3 ) node [ midway , below , fill = white ] @xmath130 ; ( r4 )  ( r14 )",
    "node [ near end , above ] @xmath127 ; ( r4 ) ",
    "( r24 ) node [ midway , right ] @xmath128 ; ( r4 )  ( r34 ) node [ midway , right ] @xmath123 ; ( r4 )  ( r1t4 )",
    "node [ midway , left ] @xmath125 ; ( r4 )  ( r2t4 ) node [ midway , right ] @xmath126 ; ( r4 )  ( r4t4 ) node [ midway , right ] @xmath129 ; ( r1 t )  ( r1t4 ) node [ midway , above ] @xmath124 ; ( r1 t )  ( r11 t ) node [ midway , above ] @xmath127 ; ( r1 t ) ",
    "( r2t1 t ) node [ midway , above ] @xmath126 ; ( r1 t ) ",
    "( r3t1 t ) node [ midway , above ] @xmath130 ; ( r1 t ) ",
    "( r4t1 t ) node [ midway , above ] @xmath129 ; ( r2 t ) ",
    "( r22 t ) node [ midway , below ] @xmath128 ; ( r2 t )  ( r1t2 t ) node [ very near end , below ] @xmath125 ; ( r2 t ) ",
    "( r3t2 t ) node [ midway , below ] @xmath130 ; ( r2 t ) .. controls + ( down:2.1 cm ) and + ( down:1.7 cm ) .. ( r2t4 ) node [ very near start , below ] @xmath124 ;    \\(r ) edge [ in=150,out=120,loop , above ] node @xmath127 ( r ) ( r ) edge [ in=30,out=60,loop , above ] node @xmath128 ( r ) ( r ) edge [ in=-60,out=-30,loop , below ] node @xmath130 ( r ) ( r ) edge [ in=-120,out=-150,loop , below ] node @xmath129 ( r ) ( r3 ) edge [ in=-120,out=-150,loop , left ] node @xmath129 ( r3 ) ( r4 ) edge [ loop above ] node @xmath130 ( r4 ) ( r1 t ) edge [ in=30,out=60,loop , right ] node @xmath128 ( r1 t ) ( r2 t ) edge [ in=135,out=105 , loop , above ] node @xmath127 ( r2 t ) ;    the form @xmath92 is equivalent to the descartes form @xmath131 by the relationship @xmath132 where @xmath133 note that @xmath134 .",
    "the descartes form has gram matrix @xmath135 and is central to the study of apollonian circle packings .",
    "the solutions to the descartes form @xmath136 are called _",
    "descartes quadruples_. if one considers the matrices above under the change of variables @xmath137 one obtains the _ super - apollonian group _",
    "@xmath138 of @xcite , whose generators are ( in order corresponding to the @xmath139 above ) : @xmath140 @xmath141 @xmath142 @xmath143 the group @xmath144 preserves @xmath145 in the sense that @xmath146 for all @xmath147 .",
    "the corresponding cayley graph @xmath148 is isomorphic to @xmath95 .",
    "one presentation of the super - apollonian group is ( * ? ? ?",
    "* section 6 ) @xmath149 it is a right - angled hyperbolic reflection group generated by involutions @xmath150 , @xmath151 .",
    "the group @xmath152 is of index @xmath1 in the full orthogonal group of @xmath145 ( * ? ? ?",
    "* theorem 7.1 ) .",
    "the motivation for studying @xmath144 came from the study of apollonian circle packings ; in this section we describe this geometry .",
    "we consider circles in @xmath153 identified with @xmath154 , having projective equation @xmath155 \\in { \\mathbb{p}}^1({\\mathbb{c } } ) , \\ ac - b\\bar{b}=-1.\\ ] ] such a circle is said to have _ curvature _ @xmath52 ( inverse of the radius in @xmath156 $ ] ) , _ co - curvature _ @xmath157 ( curvature of the circle in @xmath158 $ ] ) , and _ curvature - center _ @xmath53 ( center times curvature ) .",
    "we denote it by a four - dimensional real vector @xmath159 , where @xmath160 .",
    "these are known as acc coordinates ( _ augmented curvature - center coordinates _ ) @xcite .",
    "when @xmath161 , the zero set in @xmath156 $ ] is a line and @xmath53 becomes a unit normal vector .",
    "four circles @xmath162 as row vectors of a @xmath163 matrix @xmath164 in acc coordinates are said to be in _ descartes configuration _ if @xmath165 it is a theorem of graham , lagarias , mallows , wilks and yan that circles are in _ descartes configuration _ according to this algebraic condition if and only if , as circles , they are all mutually tangent with disjoint interiors , where sign of the curvature indicates orientation ( hence interior ) ( * ? ? ?",
    "* theorem 3.3 ) and ( * ? ? ?",
    "* theorem 3.2 ) .",
    "this is nicely explained by interpreting the descartes form as a bilinear pairing on circles which measure angle of intersection or hyperbolic distance ; see for example @xcite .",
    "since it preserves @xmath145 , the super - apollonian group @xmath144 acts on descartes quadruples , in the form of such @xmath166 matrices , from the left .",
    "there is a nice interpretation of this action geometrically @xcite .",
    "for such a configuration of circles , there is a dual descartes quadruple consisting of circles passing orthogonally through the first quadruple , sharing the same set of tangency points ( figure [ fig : swap - invert ] ) .",
    "then @xmath150 acts as what we call a  swap \" replacing @xmath162 with its inversion in the dual circle orthogonal to the other three , and @xmath167 fixes @xmath162 while replacing the other three circles with their inversions in @xmath162 ( we refer to the action of @xmath167 as simply an `` inversion '' ) .",
    "see figure [ fig : swap - invert ] .",
    "there are two `` natural '' ways of uniquely writing elements of @xmath168 given the commutation relations in the group ( i.e. two natural spanning trees for the cayley graph of @xmath168 with respect to the given generators ) , and we will be working with both of them . these were first defined in @xcite .",
    "[ def : normalforms ] a word @xmath169 in the super - apollonian generators is in swap normal form if @xmath170 and if whenever @xmath171 and @xmath172 , then @xmath173 ; i.e. the `` swaps '' are pushed as far left as possible ( equivalently the `` inversions '' are as far right as possible ) .",
    "a word @xmath169 in the super - apollonian generators is in invert normal form if @xmath170 and if whenever @xmath174 and @xmath175 , then @xmath173 ; i.e. the `` inversions '' are pushed as far left as possible ( equivalently the `` swaps '' are as far right as possible ) .",
    "the swap ( invert ) normal form of an element of the super - apollonian group is unique @xcite . in the cayley graph @xmath176 , travelling a path of length @xmath177 to the origin , one can read off labels as @xmath178 where @xmath179 is the distal edge and @xmath97 the proximal ( to the origin ) .",
    "this gives a word @xmath180 associated to the path .",
    "define the subgraph @xmath181 of @xmath176 to be the union of all paths to the origin labelled by swap normal form words .",
    "this is called the _ swap down tree_.    the reason for the terminology `` swap down tree '' is that , as one travels toward the origin in @xmath176 along the swap down tree , if one has a choice of @xmath182 followed by @xmath150 or @xmath150 followed by @xmath182 ( both two - move sequences having the same endpoint closer to the origin ) , one must choose the latter , which is to say , one must swap before inverting .",
    "the following proposition asserts that besides being a spanning tree , it is minimal in a certain way .",
    "[ prop : swapdowntree ] the swap down tree @xmath181 is a spanning tree of @xmath176 , and , from any vertex , the path to the origin along the tree is of minimal length among paths to the origin in @xmath176 .",
    "every word can be put into a unique normal form , without increasing its length , by cancelling any double letters and moving each @xmath151 as far to the right as possible using the commutativity relations ( * ? ? ? * proof of theorem 6.1 ) .",
    "therefore there is a unique path to the origin in @xmath181 from any vertex of @xmath176 .",
    "we may conclude that @xmath181 is connected , is a tree , and spans @xmath176 .",
    "minimality follows from the observation that changing to swap normal form never increases length .",
    "there are exactly analogous statements for the corresponding _ invert down tree_.      the group @xmath2)$ ] acts on the extended complex plane @xmath183 by the mbius action @xmath184 this action can be extended to include complex conjugation , @xmath185 giving rise to the group @xmath186 = { \\operatorname{pgl}}_2({\\mathbb{z}}[i ] ) \\rtimes\\langle \\mathfrak{c}\\rangle$ ] of mbius transformations , the _ extended bianchi group _ , a maximal discrete subgroup of @xmath187 .",
    "the group @xmath186 $ ] acts on the collection of circles of @xmath188 ( recall that lines are circles through @xmath71 ) . in",
    "what follows , we will identify @xmath188 with @xmath154 when convenient .",
    "the orbit of the circle @xmath189 under @xmath190)$ ] is a dense collection of nested circles called a _",
    "schmidt arrangement _ , denoted @xmath191 .",
    "an image is shown in figure [ fig : gaussianpacking5 ] . for more on schmidt arrangements ,",
    "see @xcite .    to describe our dynamical system ,",
    "we choose a particular descartes quadruple @xmath192 , and its dual @xmath193 , whose circles are the rows of @xmath194 in acc coordinates ( see figure [ fig : basequad ] ) , respectively .",
    "we call these the dual base quadruples .",
    "the terminology refers to the fact that @xmath193 consists of the unique descartes quadruple orthogonal to @xmath192 and having the same intersection points ( and vice versa ) . in particular , the `` swaps '' of @xmath193",
    "are the `` inversions '' of @xmath192 and vice versa .",
    "other choices of base quadruple would of course be possible , but the choice here coincides with a natural subset of the schmidt arrangement and has particularly simple tangency points .",
    "we embed the super - apollonian group into @xmath195 using a form of the _ exceptional isomorphism _ @xmath196 .",
    "to do so , we map each element of @xmath138 to the mbius transformation which acts the same way on @xmath192 .",
    "the mbius transformations corresponding to the super - apollonian generators are @xmath197 @xmath198 ( the @xmath199 are inversions in the circles of @xmath193 and the @xmath200 are inversions in the circles of @xmath192 ) .",
    "let @xmath201 denote the mbius group generated by these generators ; it is isomorphic to @xmath202 . considering the poincar extension of the mbius action to the upper - half - space model of hyperbolic space",
    ", one sees that @xmath201 is the finite covolume kleinian group generated by reflections in the sides of a right - angled ideal octahedron whose faces lie on the geodesic planes defined by the circles of @xmath192 and @xmath193 .",
    "the orbit of the super - apollonian group on a particular descartes quadruple is known as an apollonian super - packing @xcite . for this choice of base quadruple , as a collection of circles , the corresponding apollonian super - packing coincides with the schmidt arrangement of @xmath191 @xcite .",
    "this orbit gives a sequence of partitions @xmath203 of the plane into triangles and circles , each refining the last ( see figure [ fig : gaussianpacking5 ] ) .",
    "the regions of the partition @xmath203 are indexed by the swap normal form words of length @xmath177 in the super - apollonian generators ; see figure [ fig : length2partition ] . a word @xmath204 refines @xmath205 if and only if @xmath206 is an initial segment of @xmath207 ( right initial , speaking about @xmath202 ) .",
    "this will allow us to coordinatize the plane by infinite words in swap normal form .",
    "the coordinates of a point will be produced by a dynamical system described below .",
    "\\times[0,1]$ ] generated by @xmath144 swap normal form words of length @xmath208 acting on @xmath192 .",
    "the resulting image consists of a subcollection of the circles of the schmidt arrangement @xmath191 , which , as word length increases , will eventually include any circle of @xmath191.,width=384 ]    if @xmath169 , @xmath209 is a word in the super - apollonian generators and @xmath210 , then in terms of the mbius transformations the circles of @xmath211 are @xmath212 where @xmath213 are the circles of @xmath192 . the swap normal form for @xmath168 passes to words in the mbius generators , * reversing order as just noted*. compare the following definition to definition [ def : normalforms ] , noting the order reversal",
    "a word @xmath214 in the super - apollonian mbius generators is in swap normal form if @xmath215 and if whenever @xmath216 and @xmath217 , then @xmath173 ; i.e. the `` swaps '' are pushed as far right as possible ( equivalently the `` inversions '' as far left as possible ) .",
    "a word @xmath214 is in _ invert normal form _ if @xmath215 and if whenever @xmath218 and @xmath219 , then @xmath173 ; i.e. `` inversions '' are as far right as possible .",
    "finally , we note that @xmath220 , where @xmath221 is the isometry of the octahedron switching opposite faces , the mbius version of the `` duality operator '' @xmath222 from @xcite .",
    "this defines an involution on super - apollonian words in swap normal form , namely taking the transpose ( or reversing order and conjugating by @xmath223 ) @xmath224 on the level of mbius transformations , @xmath225 .",
    "see @xcite , @xcite for more information .",
    "we now define a pair of dynamical systems on @xmath154 associated to the base quadruples @xmath192 and @xmath193 .",
    "let @xmath226 , @xmath227 , be the open circular and closed triangular regions of the plane coming from the base quadruple @xmath192 ( @xmath228 and @xmath229 defined similarly , see figure [ fig : basequad ] ) , and define @xmath230 in words , if the point @xmath39 is in one of the four closed triangular regions , we swap and if @xmath39 is in one of the open circular regions , we invert in that circle .",
    "each of @xmath231 and @xmath232 has six fixed points , the points of tangency @xmath233 .",
    "( 1/2,0)circle(1/2 ) ; ( 1/2,0)node@xmath234 ; ( 1/2,1)circle(1/2 ) ; ( 1/2,1)node@xmath235 ; ( 0,-1)(0,2 ) ; ( 3/2,1/2)node@xmath236 ; ( 1,-1)(1,2 ) ; ( -1/2,1/2)node@xmath237 ;    ( 1/2,-1)node@xmath238 ; ( 1/2,2)node@xmath239 ; ( 1/8,1/2)node@xmath240 ; ( 7/8,1/2)node@xmath241 ;    ( -.1,0)node@xmath242 ; ( 1.1,0)node@xmath243 ; ( -.1,1)node@xmath244 ; ( 1.2,1)node@xmath245 ;    ( 0,1/2)circle(1/2 ) ; ( 0,1/2)node@xmath246 ; ( 1,1/2)circle(1/2 ) ; ( 1,1/2)node@xmath247 ; ( -1,0)(2,0 ) ; ( 1/2,-1/2)node@xmath248 ; ( -1,1)(2,1 ) ; ( 1/2,3/2)node@xmath249 ;    ( 1/2,7/8)node@xmath250 ; ( 1/2,1/8)node@xmath251 ; ( 2,1/2)node@xmath252 ; ( -1,1/2)node@xmath253 ;    ( 0,-.1)node@xmath242 ; ( 1,-.1)node@xmath243 ; ( 0,1.1)node@xmath244 ; ( 1,1.1)node@xmath245 ;    [ finiteterminate ] under the dynamical systems @xmath231 and @xmath232 , every gaussian rational @xmath254 reaches one of the fixed points in finite time .",
    "the fixed point reached is determined by the `` parity '' of the numerator and denominator of @xmath255 , i.e. one of the six equivalence classes under the equivalence relation @xmath256    recall that @xmath186 = { \\operatorname{pgl}}_2({\\mathbb{z}}[i ] ) \\rtimes\\langle \\mathfrak{c}\\rangle$ ] .",
    "the group @xmath201 is the kernel of the surjective map @xmath257)\\rtimes\\langle\\mathfrak{c}\\rangle\\to { \\operatorname{pgl}}_2({\\mathbb{z}}[i]/(2))\\ ] ] since @xmath201 is in the kernel and both are of index @xmath1 in @xmath186 $ ] ( we have @xmath258:\\gamma]=48 $ ] comparing fundamental domains and @xmath259/(2))|=48 $ ] by direct computation ) .",
    "hence @xmath201 preserves parity , e.g. @xmath260 termination in finite time follows from the following version(s ) of the euclidean algorithm in @xmath261 $ ] .",
    "`` homogenizing '' @xmath231 and @xmath232 gives dynamical systems on pairs @xmath262\\times{\\mathbb{z}}[i]$ ] that terminate when @xmath263 , i.e. act on pairs via complex conjugation and the matrices implied in the definitions of the @xmath199 , @xmath200 .",
    "for instance , @xmath264 we ll consider the case of @xmath232 , noting that the proof for @xmath231 is nearly identical : @xmath265 the inequalities defining the regions @xmath226 , @xmath227 show that @xmath266 is reduced whenever @xmath267 , @xmath268 , @xmath269 , or @xmath270 is applied .",
    "for example , when applying @xmath267 , the fact that @xmath271 is in the triangle @xmath272 ( or the circle @xmath235 ) shows that @xmath266 is reduced when applying @xmath267 , as follows : @xmath273 note that the inequalities above define @xmath235 , but since @xmath250 is contained in @xmath235 they hold true for @xmath250 as well .",
    "similarly , application of @xmath274 and @xmath275 both reduce @xmath276 . applying @xmath277 maps @xmath253 onto @xmath278 ( from which one of @xmath276 , @xmath266 will be reduced as just discussed ) . finally , @xmath279 maps @xmath248 onto one of the other seven regions .",
    "hence the algorithm terminates .",
    "iteration of the map @xmath232 or @xmath231 with input @xmath39 produces a word @xmath280 in the mbius generators @xmath281 , where @xmath282 is defined by @xmath283 .",
    "we take the word to be finite for @xmath284 , ending when a fixed point is reached .",
    "an example of this process is shown in figure [ fig : approx ] .",
    "using @xmath232 gives the normal form word @xmath285 .",
    "]    the collection @xmath286 of length @xmath177 super - apollonian words in swap normal form partitions the plane into a collection of @xmath287 triangles and circles , which we call farey circles and triangles following schmidt @xcite .",
    "specifically , we associate to each word in @xmath286 an open circular or closed triangular region , the notation being @xmath288 for @xmath289 with @xmath290 ( circular ) or @xmath199 ( triangular ) . this definition is set up so that the words of length one correspond to the eight regions of the base quadruple .",
    "[ thm : z - mfz ] a word @xmath291 produced by iteration by @xmath232 ( respectively @xmath231 ) on @xmath292 is in swap ( respectively invert ) normal form .",
    "furthermore ,    1 .   if @xmath39 is rational , then @xmath293 for @xmath294 matching @xmath39 in parity as described in theorem  [ finiteterminate ] .",
    "if @xmath39 is not rational , then @xmath295 is an infinite word with the property that @xmath296    this gives a bijection @xmath297 , under which @xmath232 ( respectively @xmath231 ) can be considered to act on words , and this action is via the left - shift , @xmath298 .    that @xmath295 is in swap normal form is clear ; the only circular region in @xmath299 is @xmath226 .",
    "two farey sets are either disjoint or one is contained in the other : if @xmath300 is a ( left ) initial segment of @xmath301 , which we denote @xmath302 , then @xmath303 . for @xmath304 , the infinite swap normal form word @xmath305 produced by iterating @xmath232 determines @xmath39 since @xmath306 . for rational points ,",
    "to determine @xmath39 , we need both the finite word and the parity of the rational : then @xmath307 , where @xmath53 is the element of @xmath308 of the specified parity .    from now on",
    ", we consistently use the variables @xmath39 , @xmath295 for the @xmath309 coordinate system , and @xmath310 , @xmath311 for the @xmath312 coordinate system , since we will be using both codings simultaneously .",
    "the purpose of this section and the next is to relate the super - apollonian continued fraction algorithm to classical statements of diophantine approximation . in this section ,",
    "we give the first value of the lagrange spectrum for complex approximation by gaussian rationls . with this as a point for comparison , in the second section we describe the goodness of the approximations obtained by the algorithm .",
    "the `` good '' rational approximations to an irrational @xmath314 @xmath315 are determined by the collection of horoballs @xmath316 through which the geodesic @xmath317 passes ( or through which any geodesic @xmath318 eventually passes ) . over @xmath313 ,",
    "the smallest value of @xmath164 with the property that every irrational @xmath39 has infinitely many rational approximations satisfying the above inequality was determined by ford in @xcite . here",
    "we give a short proof of this fact using the geometry of the ideal octahedron .",
    "every @xmath319 has infinitely many rational approximations @xmath320 such that @xmath321 the constant @xmath322 is the smallest possible , as witnessed by @xmath323 .    the value of @xmath164 for which the horoballs with parameter @xmath164 based at the ideal vertices @xmath324 cover the boundary of the fundamental octahedron is easily found to be @xmath322 ( one need only cover the face with vertices @xmath325 , see figure  [ fig : face ] ) .",
    "hence as we follow the geodesic @xmath317 through the tesselation by octahedra , at least one of the six vertices of each octahedron satisfies the above inequality with @xmath326 , one or two as it enters and one or two as it exits ( some of which may coincide ) .",
    "this gives the smallest value of @xmath164 for which the inequality above has infinitely many solutions for all irrational @xmath39 , noting the the geodesic from @xmath327 to @xmath328 passes orthogonally through the `` centers '' of the opposite faces of the octahedra through which it passes .",
    "the sequence of octahedra we consider in our continued fraction algorithm are not necessarily along the geodesic path , but we do capture all rationals with @xmath329 with @xmath330 as detailed in the next section .",
    "( 0,0.577)circle(0.577 ) ; ( 1,0.577)circle(0.577 ) ; ( -1,0.866)(2,0.866 ) ; ( 0,0)(0,2 ) ; ( 1,0)(1,2 ) ;",
    "( 1,0)arc(0:180:0.5 ) ; ( 0,-0.15)node@xmath331 ; ( 1,-0.15)node@xmath54 ; ( 0.5,1.3)node@xmath332 ;      to any complex number we associate six sequences of gaussian rational approximations by following the inverse orbit of the six points of tangency of our base quadruples @xmath193 , @xmath192 .",
    "namely , if @xmath333 in the two codings , then the convergents @xmath334 , @xmath335 are given by @xmath336 with the property that @xmath337 for all @xmath338 and @xmath339 , @xmath304 .    the following theorem is equivalent to a statement about approximation by schmidt s continued fractions , given as theorem 2.5 in @xcite .",
    "in particular , the approximations given by schmidt s algorithm and the super - apollonian algorithm coincide . in @xcite , it is stated without proof ; here we provide a proof .    if @xmath271 is such that @xmath340 then @xmath271 is a convergent to @xmath341 ( with respect to both @xmath231 and @xmath232 ) .",
    "moreover , the constant @xmath164 is the largest possible .",
    "note that the apollonian super - packings associated to the root quadruples @xmath193 , @xmath192 , are invariant under the action of @xmath190)\\rtimes\\langle{\\mathfrak{c}}\\rangle$ ] .",
    "consider the quadruple where @xmath271 first appears as a convergent to @xmath341 , and let @xmath342)$ ] take this quadruple to the base quadruple ( say @xmath192 ) with @xmath271 mapping to infinity and infinity mapping to @xmath343 .",
    "for any value of @xmath164 , the disk of radius @xmath344 centered at @xmath271 gets mapped by @xmath345 to the exterior of the disk of radius @xmath346 centered at @xmath343 : @xmath347 consider the ways in which @xmath271 can first appear as a convergent to @xmath341 in the sequence of partitions of the plane .",
    "* we might invert into a circle containing @xmath341 .",
    "in particular , then , @xmath271 is in the interior of the circle of inversion ( since it is its first appearance as a convergent ) . in this case , by the discussion in section [ sec : dyn - p1 ] , all @xmath39 inside the circle also include this inversion in their expansion",
    ". therefore , all @xmath39 inside the circle will have @xmath271 as a convergent .",
    "our goal is to show that the circle of radius @xmath348 around @xmath271 is contained in the circle of inversion .",
    "+ under @xmath345 above ( perhaps after applying some binary tetrahedral symmetry of the base quadruple ) , the circles @xmath312 , @xmath309 , get mapped to @xmath349 , @xmath350 as in the figures below , with @xmath351 lying in the triangle inside @xmath350 as shown .",
    "the exterior of a disk of radius one centered at @xmath343 does not meet the interior of @xmath350 , hence , applying @xmath352 , the disk of radius @xmath348 centered at @xmath271 does not meet @xmath309 . therefore @xmath271 is a convergent to any @xmath39 with @xmath353 .",
    "+    * we might swap into a triangle containing @xmath341 producing @xmath271 as a point of tangency on an edge of this triangle . in the image , @xmath341 is in the quadrangle with sides formed by @xmath354 ; this is the union of two triangles .",
    "the dotted circles in the figures indicate the two possible swaps associated to the initial creation of @xmath271 as a convergent . in this case",
    ", any @xmath39 in the indicated quadrangle will have @xmath271 as a convergent .",
    "we aim to show that a circle of radius @xmath344 around @xmath271 is contained in this region .",
    "+ under @xmath345 above ( perhaps after applying some binary tetrahedral symmetry of the base quadruple ) , the circles @xmath312 , @xmath309 , @xmath164 , @xmath223 , and @xmath355 are mapped to @xmath349 , @xmath350 @xmath356 , @xmath357 and @xmath358 , the three circles tangent to @xmath271 are mapped to the lines in the second picture , with @xmath351 lying in the intersection of the disks defined by @xmath350 and @xmath358 .",
    "the exterior of any circle of radius @xmath359 centered inside @xmath358 avoids the interiors of @xmath349 , @xmath350 , @xmath356 , and @xmath357 . applying @xmath352 shows that the disk of radius @xmath344 around @xmath271 does not meet @xmath312 , @xmath309 , @xmath164 , or @xmath223 , so that @xmath271 is a convergent to any @xmath39 with @xmath329 .",
    "+        in this section , we derive an invertible extension @xmath68 of @xmath232 , with the property that @xmath360 extends @xmath231 , along with an invariant measure for @xmath68 .",
    "this is done with a goal of eventually producing an ergodic measure preserving system , as is done both in @xcite and @xcite . for this purpose ,",
    "let @xmath361 denote hyperbolic 3-space , having boundary @xmath362 ( e.g. the poincar upper half space model ) .    the space of oriented geodesics in @xmath361 , identified with pairs in @xmath363 , where @xmath364 denotes the diagonal , carries an isometry invariant measure @xmath365 we restrict this measure to geodesics in the set @xmath366 consisting of geodesics between disjoint @xmath312 and @xmath309 regions of the base quadruples ( see figure [ fig : basequad ] ) . in what follows we use",
    "@xmath312 coordinates for @xmath310 in the first coordinate and @xmath309 coordinates for @xmath39 in the second coordinate .",
    "define @xmath367 by @xmath368 where @xmath295 is the mbius transformation corresponding to @xmath39 as described in theorem  [ thm : z - mfz ] .",
    "equivalently , @xmath369 in other words , @xmath68 is applying @xmath232 diagonally depending on the second coordinate . in terms of the shifts on pairs",
    "@xmath370 corresponding to @xmath371 , we have @xmath372 see figure [ fig : invext ] for a visualization of the invertible extension .",
    ", labelled in sequence ( with @xmath373 and @xmath374 indicating the orientation ) . at right ,",
    "100 iterations of @xmath68 , with rainbow coloration indicating time . in both pictures ,",
    "the geodesic planes of the base quadruple and its dual are shown.,title=\"fig:\",width=288 ] , labelled in sequence ( with @xmath373 and @xmath374 indicating the orientation ) . at right ,",
    "100 iterations of @xmath68 , with rainbow coloration indicating time . in both pictures ,",
    "the geodesic planes of the base quadruple and its dual are shown.,title=\"fig:\",width=288 ]    define the following regions ( see figure [ fig : manyregions ] ) : @xmath375    here @xmath376 consists of the @xmath309 regions not intersecting @xmath228 , and so on .",
    "[ measurethm ] the function @xmath377 is a measure - preserving bijection .",
    "consequently , the push - forward of this measure onto the first or second coordinate gives invariant measures @xmath378 and @xmath379 for @xmath231 and @xmath232 .",
    "specifically , we have @xmath380 and @xmath381    see figure [ fig : planar_density ] for a graph of the invariant density @xmath382 .",
    ", @xmath383 .",
    "bottom , left to right : regions @xmath384 , @xmath383 . shown red@xmath385blue with subdivisions . ]",
    "note that @xmath386 , which is readily seen in figure [ fig : manyregions ] .",
    "since @xmath387 we immediately get that @xmath68 is a bijection .",
    "as @xmath68 is a bijection defined piecewise by isometries , it preserves the measure described above .",
    "theorem  [ measurethm ] defines the functions @xmath388 and @xmath382 implicitly .",
    "we now compute what they are explicitly , starting with @xmath382 . computing the relevant integrals in theorem  [ measurethm ]",
    "gives @xmath389 times hyperbolic area on the triangular regions @xmath227 : @xmath390 and on the circular regions @xmath226 we have @xmath391 where @xmath392",
    "furthermore , we have the relationship @xmath393 where @xmath394 is rotation by @xmath395 around @xmath396 and @xmath397 is the isometry switching opposite faces of the octahedron ( the duality operator [ mfd ] ) .",
    "the measures @xmath378 , @xmath379 have @xmath398 symmetry on each of the @xmath228 , @xmath229 , @xmath226 , @xmath227 .",
    "for instance the isometries permuting @xmath325 on @xmath238 , @xmath248 preserve the measure ( generators shown for a transposition and three - cycle ) @xmath399 the measures also have @xmath400 symmetry on @xmath41 , permuting the pairs @xmath401 , @xmath402 ( transpositions @xmath403 shown ) @xmath404 the total measure assigned to each of the @xmath228 , @xmath229 , @xmath226 , @xmath227 , is @xmath405 , so to normalize @xmath378 , @xmath379 , we divide by @xmath406 .",
    "all of the above should be compared with nakada s extension of schmidt s system , described in an appendix .",
    ", the invariant density for @xmath232.,width=480 ]    the following lemmas compare the measures of some farey circles and triangles via the involutions @xmath407 and @xmath408 , simplifying computations in section 5 .",
    "for use in the proofs , we note the equality of regions @xmath409 where @xmath397 is as in ( [ mfd ] ) .",
    "[ lem : measurecompare1 ] for @xmath300 in swap normal form , and @xmath301 in invert normal form , there are equalities of measure @xmath410    consider the case where @xmath411 so that @xmath412 and @xmath413 ( all other cases are analogous ) and let @xmath414 be the invariant form on the space of geodesics .",
    "recall @xmath225 from ( [ mfd ] ) .",
    "we have @xmath415 while @xmath416 here we are using the fact that @xmath414 is the invariant form and the relations in ( [ regionequality ] ) .    [",
    "lem : measurecompare2 ] for @xmath300 in swap normal form , and @xmath301 in invert normal form , there are equalities of measure @xmath417    consider the case where @xmath411 so that @xmath412 and @xmath418 ( all other cases are analogous ) and let @xmath414 be the invariant form on the space of geodesics . then @xmath419 while @xmath420 here we are using the fact that @xmath414 is the invariant form and the relations in ( [ regionequality ] ) .",
    "the dynamical systems introduced in the previous section can be translated to ones on lorentz and descartes quadruples . in this section ,",
    "we explore these systems as well as how they interact with individual apollonian packings .      in analogy",
    "to romik @xcite , we now define a dynamical system on integer lorentz quadruples @xmath421 with @xmath422 which decreases the value of @xmath52 and terminates at one of the six quadruples @xmath423    define the following dynamical system on @xmath424 : @xmath425    iteration of @xmath426 produces a word @xmath427 defined by @xmath428 .",
    "[ thm : tl ] the word @xmath429 produced by iteration of @xmath426 on a primitive integer lorentz quadruple @xmath430 is in swap normal form and satisfies @xmath431 where @xmath432 is one of the following _ simplest lorentz quadruples _ : @xmath433 under iteration of @xmath426 .",
    "see figure [ fig : lor - graph ] .",
    "the map is well defined unless @xmath434 for all choices of signs . in this case",
    "@xmath435 , which is impossible given @xmath436 .",
    "note that the map preserves @xmath437 , so it is well - defined on @xmath438 , the primitive integral lorentz quadruples of @xmath164 .",
    "therefore , it suffices to verify the following : @xmath439 we do this by constructing an explicit intertwining map demonstrating that @xmath440 and @xmath441 are conjugate .",
    "then the result will follow from theorem [ thm : z - mfz ] .    in analogy to work of romik on pythagorean triples ,",
    "it is possible to scale this system to act on a sphere .",
    "scaling so that @xmath442 ( @xmath443 , @xmath444 , @xmath445 ) ( call this projection @xmath446 ) , we get a system on the sphere @xmath447        the regions defined on the sphere ( figure [ fig : idealtet ] ) are given by the intersection of the sphere with the hyper - ideal tetrahedron defined by the linear inequalities @xmath448 in the klein projective model of hyperbolic space , and the cases of @xmath449 are reflections in those geodesic planes and the planes of the dual tetrahedron .",
    "the systems @xmath450 and @xmath451 are conjugate , moving between the projective and the upper half - space models of hyperbolic space .",
    "specifically , after stereographic projection @xmath452 , rotating ( @xmath453 ) , scaling ( @xmath454 ) , shifting ( @xmath455 ) , and switching two circles ( @xmath456 ) , we obtain an intertwining map @xmath457 under the composition @xmath458 ,",
    "one can associate a lorentz quadruple @xmath430 with the complex point @xmath459 where @xmath446 is the scaling projection from above , the correspondence between fixed points being @xmath460 then , @xmath461 and the conditions defining the cases of @xmath426 and @xmath232 correspond . therefore , @xmath462 .    to summarize the above : the following diagram commutes , @xmath463 is invertible , and there is a unique primitive representative in @xmath464 for rational @xmath465 .",
    "@xmath466^{t_l } \\ar[d]_{\\pi } & c",
    "\\ar[d]^{\\pi}\\\\ s^2 \\ar[r]^{t_{sph } } \\ar[d]_{\\phi } & s^2 \\ar[d]^{\\phi}\\\\ { \\mathbb{p}}^1({\\mathbb{c } } ) \\ar[r]^{t_b } & { \\mathbb{p}}^1({\\mathbb{c}})\\\\ } \\ ] ]      under the change of variables of section [ sec : quads ] , the dynamical system of the last section becomes a dynamical system on primitive integer descartes quadruples .",
    "define the following : @xmath467    iteration of @xmath468 produces a word @xmath469 defined by @xmath470 .    the word @xmath429 produced by iteration of @xmath468 on a primitive integer descartes quadruple @xmath430 is in swap normal form and satisfies @xmath471 where @xmath472 is some permutation of the entries of the vector .",
    "in other words , any primitive integral descartes quadruple @xmath430 eventually reaches one of the so - called _ simplest descartes quadruples _",
    "@xmath473 under iteration of @xmath468 .",
    "the proof is immediate from the previous sections , using conjugation by @xmath474 defined in ( [ jmatrix ] ) .",
    "we now state an analogous system conjugate to @xmath231 .",
    "the proof is similar .",
    "define @xmath475    iteration of @xmath476 produces a word @xmath469 defined by @xmath477 .    the word @xmath429 produced by iteration of @xmath476 on a primitive integer descartes quadruple @xmath430 is in invert normal form and satisfies @xmath471 where @xmath472 is some permutation of the entries of the vector .",
    "in other words , any primitive integral descartes quadruple @xmath430 eventually reaches one of the so - called _ simplest descartes quadruples _",
    "@xmath473 under iteration of @xmath476 .",
    "the apollonian circle packist will be interested to consider how the dynamical systems interact with individual apollonian circle packings .",
    "each apollonian circle packing has a root quadruple , i.e. the largest four pairwise tangent circles in the packing .",
    "the main result of this section is to show that the invert normal form word @xmath469 produced by the dynamical system @xmath476 is such that the longest substring @xmath478 consisting only of swaps will end with the root quadruple of the packing containing the initial quadruple . in other words ,",
    "the dynamical system @xmath476 , or equivalently @xmath231 , moves any quadruple to the root of its apollonian circle packing , then inverts , then moves to the root , then inverts , etc .",
    "[ thm : acp - only - dyn ] the dynamical system @xmath476 moves a quadruple to the root of its packing via swaps before inverting .    in particular , while it remains in a single apollonian circle packing , the dynamical system @xmath476 agrees with the reduction algorithm for descartes quadruples of ( * ? ? ?",
    "* section 3 ) , until the last step ( when graham , lagarias , mallows , wilks and yan reorder the quadruple ) .",
    "the proof requires several lemmas . a descartes quadruple",
    "@xmath430 is a root quadruple of the apollonian packing in which it resides if @xmath479 , and @xmath480 .",
    "furthermore , it exists if the packing is integral , and is unique ( * ? ? ?",
    "* section 3 ) .",
    "[ fliptoroot ] let @xmath481 be a descartes quadruple such that the @xmath244-th coordinate is not maximal in the quadruple .",
    "let @xmath482 .",
    "then @xmath483 is a root quadruple of the packing in which it resides , possibly after re - ordering the coordinates .",
    "we have @xmath484 @xmath485 we prove the lemma for the case @xmath486 and note that the other cases are identical .",
    "we have @xmath487 since @xmath66 is not maximal among @xmath488 , we have that the first coordinate of @xmath489 is @xmath490 ( if @xmath66 is negative , @xmath491 is a sum of positive numbers and hence it is positive ; if @xmath66 is nonnegative , it is enough to argue that the first coordinate of @xmath489 is at least @xmath66 ) . hence @xmath492 .",
    "without loss of generality , assume @xmath493 , so that @xmath494 in order to show that the above is a root quadruple , we need only to show that @xmath495 using descartes theorem , and the fact that @xmath310 is maximal , we have that @xmath496 so the expression in ( [ rootcheck ] ) can be rewritten as @xmath497 if @xmath498 , then this is clearly nonnegative and we are done .",
    ". then the circle corresponding to @xmath76 in the descartes quadruple @xmath481 contains the one of curvature @xmath39 , and so the circle of curvature @xmath39 has smaller radius and hence larger curvature than the one of curvature @xmath76 .",
    "thus @xmath500 and the expression in ( [ rootcheck ] ) is nonnegative as desired .",
    "[ roottoroot ] let @xmath430 be a root quadruple of some packing .",
    "then @xmath501 is a root quadruple of another packing , after re - ordering , for any @xmath502 .",
    "we consider the case where @xmath503 and note that the other cases are identical .",
    "we have @xmath504 , and @xmath505 .",
    "we compute @xmath506 since @xmath430 is a root quadruple , and hence @xmath507 is also a root quadruple after reordering .",
    "the system @xmath508 generates a word satisfying @xmath509 where @xmath510 is a simplest descartes quadruple . in this word , swaps are as far left as possible and inversions as far right as possible .",
    "therefore if the leftmost inversion @xmath151 occurs at some position @xmath511 , i.e. @xmath512 , it is because it is followed by @xmath150 , or because it occurs as the last letter ( @xmath513 ) , or else because it is followed by another inversion @xmath182 .",
    "we assume that the leftmost inversion is @xmath514 , and will show that @xmath515 is a root quadruple .",
    "the theorem will follow .    in the first case , @xmath516 ,",
    "where the @xmath244-th coordinate is not maximal ( since it is a result of @xmath150 in the application of @xmath468 ) .",
    "therefore , by the first lemma , @xmath430 is a root quadruple .    in the second case",
    ", @xmath430 is created by an inversion from a simplest descartes quadruple , which is , in particular , a root quadruple .",
    "but it is not an inversion in a circle of curvature @xmath242 , since that would not change the descartes quadruple .",
    "therefore the second lemma applies .    in the third case , @xmath517 , where @xmath518 .",
    "then , by induction ( with the previous two cases as base cases and the second lemma as an inductive step ) , @xmath515 is a base quadruple .",
    "( since @xmath518 , we know the @xmath244-th circle is not the largest in @xmath519 . )",
    "what can one say about the chain of swaps and inversions that are used in the rational approximation of a typical point under iteration ?",
    "first , we consider the question as a limiting question on finite expansions . in the second section ,",
    "we consider the question for all expansions . finally , we provide some numerical data .",
    "we consider the behavior of the expansions of rational points ( those points with finite expansion ) .",
    "we use a measure of the _ height _ of a rational point .",
    "for example , in the case of lorentz quadruples , we may define the set of points of height @xmath520 to be @xmath521 we then consider @xmath522 to be a discrete probability space with uniform probability measure . under this measure",
    ", we can ask about the distribution of the @xmath177-th digit in the expansion , as @xmath523 . in this section , we prove the following theorem .",
    "write @xmath524 for the letter produced by applying @xmath525 to @xmath526 .",
    "let @xmath527 be the normalized uniform area measure on the sphere .",
    "[ digit : exp ] under the uniform probability measure for @xmath522 , the distribution of @xmath177-th digit in the expansion of a random lorentz quadruple @xmath528 , converges to the distribution of @xmath529 under the measure @xmath530 , where @xmath531 is the constant function @xmath243 and @xmath532 is the the transfer operator of @xmath525 . in particular",
    ", the distributions of the @xmath243st and @xmath533nd digits converge to the distribution of @xmath529 under the measures @xmath534 respectively .",
    "( the sum is over all choices of sign combinations . )    for example , the probabilities of possible first digits approach the proportional areas of the circular and triangular regions on the sphere in figure [ fig : idealtet ] .",
    "these are , respectively , the probability the first digit is an inversion , @xmath535 ( the integrand is the pushforward of surface area on the sphere to the plane under stereographic projection ) ; and the probability it is a swap , @xmath536    note that the same result applies , via application of the change of coordinates @xmath474 , to descartes quadruples chosen uniformly among those whose sum of curvatures is less than @xmath520 .",
    "it is also worth remarking that this sort of result is limited in the sense that a slightly different way of measuring height , say the maximum of the curvatures is less than @xmath520 , may potentially lead to different probabilities .",
    "the transfer operator @xmath537 arising from the transformation @xmath525 is defined in the following way : for @xmath538 , we have @xmath539 where @xmath540 is the inverse of the jacobian of @xmath449 .    by definition , the transfer operator is given by @xmath541 therefore the second part of the theorem follows from the first .",
    "the result follows if we show that for a given region @xmath542 in @xmath543 , @xmath544 this would show that the random vector @xmath545 converges in distribution to @xmath546 .",
    "therefore , the transformation @xmath547 has distribution @xmath548 .",
    "it suffices to consider regions @xmath542 on the unit sphere given by @xmath549 we let @xmath550 be the three dimensional region given by @xmath551 now @xmath552 which proves .",
    "the results in this section depend on the conjectural ergodicity of the systems @xmath553 and @xmath554 constructed in the previous section .",
    "these systems are similar to the system constructed by schmidt in @xcite , which is ergodic ( the main result of schmidt s @xcite ) .",
    "similarly , romik constructs a measure - preserving system on the first quadrant of the unit circle in @xcite which he proves to be ergodic . in both romik s and schmidt s",
    "work , ergodicity is then applied to provide information about the expansions of a typical point .",
    "while we leave the proof of ergodicity to a subsequent paper , we state it as a conjecture here .",
    "[ con : ergodicity ] the systems @xmath553 and @xmath554 are ergodic",
    ".    then standard theorems of ergodic theory would imply that for almost all @xmath292 , @xmath555 with @xmath463 an indicator function for various farey circles and triangles ( and similarly with @xmath232 in place of @xmath231 ) .",
    "in particular , by judicious choice of an indicator function , we can compute the frequencies of certain chains of swaps and inversions occurring in the typical expansion of a point .",
    "the frequency of two swaps in a row @xmath556 , i\\neq j\\}$ ] , as well as the frequency of two inversions in a row @xmath557 , i\\neq j\\}$ ] is @xmath558 .",
    "the frequency of three swaps ( or inversions ) in a row , @xmath559 , i\\neq j , j\\neq k\\}$ ] , is @xmath560 .",
    "with reference to figure [ fig : length2partition ] , there are twelve triangular regions corresponding to two swaps in a row .",
    "the total measure of these triangular regions , as a proportion of the total measure of the plane , is the frequency we wish to compute .",
    "as noted in section  [ sec : inv ] , the total area with respect to @xmath378 or @xmath379 of all eight farey circles and triangles ( the entire plane ) is @xmath406 .",
    "the area of a region with respect to @xmath378 and @xmath379 is exactly hyperbolic area multiplied by a factor of @xmath389 .",
    "the hyperbolic area of a euclidean disk of radius @xmath561 in the upper half - plane whose center has @xmath76-coordinate @xmath562 is @xmath563 where @xmath564 . the hyperbolic area of a translate ( in the @xmath76 direction by @xmath338 ) of the ideal triangle with vertices @xmath565 is @xmath566 note : this is @xmath567 where @xmath568 is as in lemma  3.3 from @xcite .    putting this together",
    ", we have that the frequency of two swaps in a row is @xmath569 the frequency of three swaps in a row is @xmath570 and so on .",
    "we may use lemmas [ lem : measurecompare1 ] and [ lem : measurecompare2 ] to translate integrals over farey circles to integrals over farey triangles , and vice versa .",
    "in particular , the frequency of @xmath177 swaps will equal the frequency of @xmath177 inversions .      the frequency in the expansion of almost every @xmath571 of a string of alternating swaps or inversions of length @xmath177 , @xmath572 is @xmath573 , where @xmath574 is as in ( [ jint ] ) .",
    "these are probabilities associated to a string of only swaps or only inversions having a common fixed point .",
    "consider the probability that one of the vertices is fixed for _ exactly _ @xmath177 iterations by a string of only swaps or only inversions , i.e. the frequency of strings @xmath575 where @xmath576 on the left and @xmath577 on the right .",
    "this frequency is ( cf .",
    "* theorem 5.3a ) ) @xmath578 in particular , the conjectured values for length 1 , 2 and 3 schmidt strings are @xmath579 respectively .",
    "we ran two experiments . in the first",
    ", we generated all lorentz quadruples with @xmath580 and computed the frequencies of certain substrings , as well as the frequencies of the first several digits .",
    "the former are shown in table [ table : freqs ] .",
    "the frequency of swaps and inversions in the first and second digits are shown in table [ table : bydigit - freqs ] .",
    "these results are to be compared to section [ sec : stats1 ] .    in the second",
    ", we approximated the frequencies in a random expansion as follows : we selected 100 points uniformly at random from the @xmath581\\times[0,1]$ ] square and computed the first 100 letters of the expansion iterating @xmath231 or @xmath232 , and tabulated the frequency of certain substrings .",
    "these results are to be compared to section [ sec : stats2 ] .",
    ".experimental results for frequencies of random expansions .",
    "the column _ exp 1 _ refers to the frequencies from bounded lorentz quadruples ; while _ exp 2 _ refers to the frequences from random point expansions .",
    "the column _ conjecture _ refers to the conjectured value for random point expansions ( compare to _ exp 2 _ ) .",
    "the column _ unif freq _ refers to the frequency expected if words were uniformly random . [ cols=\"<,<,<,<,<\",options=\"header \" , ]",
    "in this section , we consider the action of @xmath231 and @xmath232 on the real line , thus obtaining a version of the euclidean algorithm . on @xmath582 , @xmath231 and @xmath232 agree , the map being @xmath583\\\\ { \\mathfrak{b}}(x)=\\frac{x}{2x-1}&x\\in b=[0,1]\\\\ { \\mathfrak{c}}(x)=2-x&x\\in c=[1,\\infty]\\\\ \\end{array } \\right .. \\ ] ] the mbius transformations @xmath584 are reflections in the sides of the ideal hyperbolic triangle with vertices @xmath325 , generating a group @xmath585 isomorphic to the free product @xmath586 .",
    "the fixed points of @xmath587 are @xmath325 and iteration of @xmath587 takes rationals to one of the fixed points in finite time , depending on the parity of the numerator and denominator , preserving parity as @xmath585 is the kernel of the map @xmath588 ( index @xmath589 ) .",
    "see the next subsection for a proof that orbits are finite on rationals .",
    "iteration of @xmath587 with input @xmath66 produces a word @xmath590 in @xmath591 , @xmath592 , such that @xmath215 .",
    "we take the word to be finite if @xmath66 is rational .",
    "we obtain rational approximations to @xmath66 by following the inverse orbit of @xmath325 : @xmath593 which include the usual convergents from simple continued fractions .",
    "the convergents can be constructed starting from @xmath594 , according as @xmath66 is positive or negative , and taking mediants , moving through the farey tree .",
    "applying @xmath595 , @xmath510 , or @xmath596 updates the first , second , or third position by taking the mediant @xmath597 of the other two entries .",
    "for example for a random number @xmath598 the first 20 convergents are ( mediants in red , see figure [ fig : triapprox ] ) @xmath599    . ]",
    "the map @xmath600 , @xmath601 , extending @xmath587 in second coordinate , is a bijection on the space of geodesics @xmath602 where there is an isometry invariant measure @xmath603 . pushing forward to the second coordinate gives the _ infinite _ @xmath587-invariant measure @xmath604 this dynamical system is clearly a cross - section of billiards in the ideal hyperbolic triangle : the bi - infinite word @xmath605 in @xmath591 corresponding to a geodesic @xmath75 records the sequence of collisions with the walls .",
    "the return time , say for a geodesic @xmath606\\times[1,\\infty]$ ] , is given by @xmath607 the return time is integrable with respect to @xmath608 , for instance @xmath609 since this triangle reflection group has finite covolume , the system @xmath610 is ergodic , implying ergodicity of @xmath611      by homogenizing @xmath587 above , we get a dynamical system on pairs of integers @xmath612 which halts when @xmath613 or one of @xmath614 , @xmath615 is zero .",
    "@xmath616 the @xmath53 step reduces @xmath266 , the @xmath157 step reduces @xmath276 , and after applying @xmath52 , one of either @xmath53 or @xmath157 follows .",
    "hence the algorithm terminates . if @xmath617 then the non - zero entry of the output is @xmath618 , and working backwards allows us to write the gcd as a linear combination of @xmath614 and @xmath615 ( using only the coefficients @xmath619 and @xmath533 at each step ) .      in this section",
    ", we make some remarks relating the triangle reflection group to a `` dual apollonian group '' on the line and conjugate this group to act on pythagorean triples ( obtaining a system on the circle conjugate to @xmath611 ) .",
    "here is a lower dimensional version of descartes theorem on curvatues .",
    "consider three real numbers , @xmath620 ( one of which may be @xmath71 , ordered as on a circle ) .",
    "the inverses of the lengths of the interals they define ( infinite length if one endpoints is @xmath71 , negative length if the interval contains @xmath71 ) satisfy @xmath621 . in analogy with the dual apollonian group @xmath622 , we can define a group acting on ordered triples of mutually tangent oriented intervals as `` inversions '' in the equivalent of acc coordinates using indefinite binary quadratic forms . if @xmath623 then the zero set of @xmath624 , @xmath625 , defines an oriented interval with curvature @xmath52 , co - curvature @xmath157 , and curvature - center @xmath53 ( if @xmath161 , then @xmath53 is @xmath626 depending on orientation ) .",
    "three forms @xmath627 ( considered as geodesics of the upper half - plane model of @xmath628 ) are in `` triangular '' configuration if they define an ideal hyperbolic triangle with proper orientation .",
    "the analogous group has generators @xmath629 each defining an inversion in the given interval .",
    "the group generated by @xmath630 preserves the quadratic form @xmath631 , i.e. @xmath632 three intervals / forms / geodesics @xmath542 are in triangular configuration if they satisfy @xmath633 the group @xmath585 is then a geometric realization of this group with respect to the base triple representing the ideal hyperbolic triangle with vertices @xmath242 , @xmath243 , @xmath71 ( rows in @xmath634 coordinates ) @xmath635    the form @xmath211 is rationally equivalent to the `` pythagorean '' diagonal form .",
    "for instance @xmath636 conjugating @xmath312 , @xmath309 , @xmath164 by @xmath474 gives @xmath637 we can define a dynamical system on triples of integers @xmath30 such that @xmath638 , @xmath422 which reduces the value of @xmath52 and terminates at one of @xmath639 , @xmath640 , where @xmath540 is the gcd of @xmath52 , @xmath53 , and @xmath157 : @xmath641 dividing by @xmath642 , we obtain a sytem on the circle @xmath643 , conjugate to @xmath587 @xmath644      romik s action on pythagorean triples also gives a dynamical system on the real line with an ergodic invariant measure and another variation on the euclidean algorithm @xcite .",
    "for example , romik s euclidean algorithm in section 3.2 of @xcite is a dynamical system on nonnegative pairs of integers @xmath645 with @xmath646 where @xmath647 for the sake of comparison , here is the greatest common divisor of @xmath648 and @xmath649 in the system described in section [ oureucalso ] : @xmath650 while romik s algorithm runs more quickly as follows : @xmath651",
    "in contrast to the approach taken so far , it may be desirable to prioritize the feature that the dynamical system moves to the root by travelling to the arithmetically simplest among the adjacent lorentz quadruples .",
    "this leads to a different dynamical system .",
    "we say a lorentz quadruple @xmath430 is normalized if @xmath652 .",
    "we can normalize a quadruple by changing signs of its entries and reordering entries .",
    "order the normalized lorentz quadruples lexicographically , so that the first , or least , is @xmath653",
    ". we will refer to the position of the quadruples in this ordering as their _ height _ ; quadruples with the same normalization have the same height .",
    "the height of a possibly non - normalized lorentz quadruple is the height of its normalization .",
    "the purpose of this section is to construct a dynamical system on quadruples which travels to the root by passing at each step to the adjacent quadruple of least height .",
    "the paths to the origin according to this system form a tree . writing quadruples in normalized form ,",
    "one obtains a tree organizing quaduples by height which is shown in figure [ fig : dropdownlorentztree ] .",
    "@xmath654 \\ar[ruu ] \\ar[r ] & 17 , 12 , 9 , 8 \\ ; ( 5 ) \\\\   & & & 13 , 12 , 4 , 3 \\ ; ( 5)\\\\   & & & 15 , 11 , 10 , 2\\ ; ( 5 ) \\\\   & & 7 , 6 , 3 , 2 \\ar[ru ] \\ar[ruu ] \\ar[r ] \\ar[rd ] \\ar[rdd ] &   19 , 15 , 10 , 6\\ ; ( 5)\\\\   & & & 21 , 16 , 11 , 8 \\ ; ( 5 ) \\\\   & & & 25 , 16 , 15 , 12 \\ ; ( 4 )   \\\\   & & & 17 , 12 , 12 , 1 \\ ; ( 4)\\\\                  1 , 1 , 0 , 0 \\ar[r ] & 3 , 2 , 2 , 1 \\ar[ruuuuuuu ] \\ar[ruuuu ] \\ar[r ] \\ar[rddd ] & 9 , 7 , 4 , 4 \\ar[ru ] \\ar[r ] \\ar[rd ] \\ar[rdd ] & 19 , 17 , 6 , 6 \\ ; ( 4)\\\\                                    & & & 25 , 20 , 12 , 9 \\ ; ( 5 ) \\\\                                    & & &   33 , 20 , 20 , 17 \\ ; ( 3)\\\\   & & 11 , 7 , 6 , 6 \\ar[r ] \\ar[rd ] \\ar[rdd ] & 27 , 23 , 10 , 10\\ ; ( 4 ) \\\\   & & & 29 , 24 , 12 , 11\\ ; ( 5)\\\\   & & & 41 , 24 , 24 , 23\\ ; ( 3)\\\\          } \\ ] ]    let @xmath655 represent the lorentz quadruples @xmath430 that satisfy @xmath656 .",
    "we define a dynamical system on @xmath657 .",
    "write @xmath658 , @xmath659 , @xmath660 and @xmath661 .",
    "define @xmath662 observe that @xmath663 , i.e. @xmath664 for any lorentz quadruple .",
    "define the seven matrices : @xmath665 @xmath666 @xmath667 the dynamical system generates a word @xmath668 from left - to - right in the @xmath669 , since if @xmath670 , then @xmath671 for exactly one @xmath244 ( it is not possible that @xmath672 ) .",
    "in other words exactly one of the @xmath669 undoes @xmath673 .",
    "explicitly , we let @xmath669 be @xmath674    we give @xmath675 the structure of a graph as follows : let two quadruples @xmath676 and @xmath677 be joined by an edge whenever @xmath677 is obtained by @xmath678 , followed by taking absolute values .    [ thm : dropdown ] for any @xmath679 , @xmath680 for some integer @xmath177 , and some @xmath681 . then",
    "the word @xmath682 generated by @xmath673 satisfies @xmath683 . furthermore",
    ", the path @xmath684 to @xmath432 on @xmath657 is of minimal length in the graph @xmath675 . finally , the path is the same as the path obtained by always travelling to the adjacent quadruple of smallest height .",
    "[ lemma : dropdown ] label @xmath685 according to direction of decrease of height",
    ". then    1 .",
    "all edges are directed .",
    "[ item : origin ] the _ origin _ vertices @xmath686 have no outward directed edges , 3 .",
    "[ item : allout ] aside from the origins , every vertex has at least one outward directed edge , 4 .   [",
    "item : cycles ] the only minimal cycles in the graph are squares , and 5 .   [",
    "item : square ] any square is isomorphic to @xmath687 \\ar[d ] & \\bullet \\ar[d ] \\\\",
    "\\bullet \\ar[r ] & \\bullet   \\\\                  } \\ ] ]    of the adjacent quadruples ,",
    "the smallest is that with first entry @xmath688 .",
    "we have @xmath689 if and only if @xmath690 .",
    "however , since @xmath691 , and we are assuming @xmath692 , this would entail @xmath693 , which can only occur if at least two of @xmath694 are zero .",
    "hence , in the primitive case , this only occurs when the vertex is an origin .",
    "therefore the origins have no outward directed edges , but every other vertex does have an outward directed edge .",
    "an edge is undirected if and only if the quadruples are the same up to reordering the non - negative quantities @xmath694 .",
    "the adjacent quadruples have largest entry @xmath695",
    ". therefore an undirected edge can occur only if @xmath696 for some choice of signs .",
    "but since @xmath697 , this is only possible with at most one negative sign .",
    "if @xmath698 , we are in the case of the root , as above . otherwise , if @xmath699 , an undirected edge implies that @xmath700 , and the two quadruples are the same , including ordering , hence the same vertex",
    "this shows that the graph has no undirected edges .",
    "observe that @xmath675 is by definition a union of images of the cayley graph @xmath95 under graph homomorphism .",
    "in particular , the presentation of the super - apollonian group implies that the only minimal cycles in @xmath95 are squares .",
    "so the minimal cycles in @xmath675 consist of images of squares .    up to permuting the second through fourth coordinates , or changing their signs , the homomorphic images of a square in @xmath95 is always labelled with first coordinates as follows , where edges are labelled with differences in the direction shown : @xmath701 \\ar@{<-}_{a - b+c+d}[d ] & 3a - 2b + 2c \\ar@{<-}^{a - b+c+d}[d ] \\\\",
    "a \\ar@{->}_{a - b+c - d}[r ] & 2a - b + c - d \\\\                  } \\ ] ] since in a square of @xmath95 the edge labels are non - zero , the direction of the edges is determined by these values , and it is evident that parallel edges must be directed in the same way , from which the assertion about directions on squares follows .",
    "finally , the non - existence of triangles in @xmath675 follows from the diagram above , since such a triangle must be a homomorphic image of a square , and the edge labellings demonstrate that if one side of the square collapses , the opposite side also collapses .    by items and of lemma",
    "[ lemma : dropdown ] , and the well - ordering principle for heights , we know that from any quadruple there is a path to the origin which respects the direction of the graph .",
    "the path of greatest decrease is unique since there is a unique adjacent quadruple of least height .",
    "this last fact arises as follows : suppose @xmath702 for some other choice of signs .",
    "then one of @xmath694 is zero .",
    "if two entries are zero , we are at the root .",
    "if one entry is zero , comparing matrices @xmath139 shows that the two quadruples are equal , so there is just one quadruple of least height .",
    "therefore the graph formed of fastest - dropping paths consists of three trees , which together span the graph .",
    "it remains to show minimality of the path lengths .",
    "compare the path of greatest descent to the image of the swap normal form path .",
    "both descend the origin , and both respect the direction of the graph ( as observed in the proof of theorem [ thm : tl ] ) .",
    "the moves that take one path to the other consist of square crossings ( by lemma [ lemma : dropdown ] ) .",
    "let the weight of a path be given by the sum of @xmath243 for each edge traversed respecting the graph direction , and @xmath619 for each edge traversed against the graph direction .",
    "then square crossings preserve weight , by lemma [ lemma : dropdown ] , so both paths have equal weight .",
    "since both paths respect graph direction , this implies they are of the same length .",
    "here we give a quick summary of asmus schmidt s continued fraction algorithm @xcite , its ergodic theory @xcite , and further results of hitoshi nakada concerning these @xcite , @xcite , @xcite .",
    "we also explicitly relate schmidt s system to ours .",
    "note that @xmath705 where @xmath706 is the order three elliptic element @xmath707 and that @xmath708 for the mbius transformations @xmath709 induced by @xmath710 ( here @xmath596 is complex conjugation ) .    in @xcite schmidt uses infinite words in these letters to represent complex numbers as infinite products @xmath711 in two different ways .",
    "let @xmath712 .",
    "we have _ regular chains _ @xmath713 representing @xmath39 in the upper half - plane @xmath714 ( the model circle ) and _ dually regular chains _",
    "@xmath715 representing @xmath716 ( the model triangle ) .",
    "the model circle is a disjoint union of four triangles and three circles , and the model triangle is a disjoint union of three triangles and one circle ( pictured in figure [ fig : ns1 ] ) :        ( -4,0)(4,0 ) ; ( -1,1)circle(1 ) ; ( 1,1)circle(1 ) ; ( -4,2)(4,2 ) ; ( 8,0)arc(0:180:1 ) ; ( 7,2)circle(1 ) ; ( 6,0)(6,4 ) ; ( 8,0)(8,4 ) ; ( 0,.25)node@xmath719 ; ( 3,1)node@xmath720 ; ( -3,1)node@xmath721 ; ( 0,3)node@xmath722 ; ( -1,1)node@xmath723 ; ( 1,1)node@xmath724 ; ( 0,1.75)node@xmath725 ;                        @xmath743 ( which are the orbits of @xmath744 under the partial products @xmath745 ) . in (",
    "* theorem 2.5 ) a quality of approximation is given : if @xmath746 , then @xmath271 is a convergent to @xmath39 .",
    "the shift map @xmath68 on @xmath747 maps @xmath748 to itself via mbius transformations , specifically ( mapping @xmath749 onto @xmath714 and @xmath750 onto @xmath751 ) @xmath752 the shift @xmath753 is shown to be ergodic ( ( * ? ? ?",
    "* theorem 5.1 ) ) with respect to the following probability measure @xmath754 where @xmath755 by inducing to @xmath756 schmidt gives `` faster '' convergents @xmath757 and a sequence of exponents @xmath758 ( @xmath243 for @xmath759 , @xmath164 , and the return time @xmath511 for @xmath760 ) .",
    "he then gives results analogous to those of simple continued fractions via the pointwise ergodic theorem , including the arithmetic and geometric mean of the exponents which exist for almost every @xmath39 ( ( * ? ? ?",
    "* theorem 5.3 ) ) : @xmath761 in @xcite , nakada constructs an invertible extension of @xmath68 on a space of geodesics in two copies of three - dimensional hyperbolic space . in one copy we take geodesics from @xmath762 to @xmath763 and in the other the geodesics from @xmath764 to @xmath765 where the overline indicates complex conjugation . the regions are pictured in figure [ fig : sn2 ] .",
    "the extension acts as schmidt s @xmath68 depending on the second coordinate .",
    "nakada does nt provide a second proof of ergodicity , but quotes schmidt s result .",
    "also in @xcite , results about the the density of gaussian rationals @xmath271 that appear as convergents and satisfy @xmath766 are obtained .",
    "for instance according to ( * ? ? ?",
    "* theorem 7.3 ) , for almost every @xmath767 and @xmath768 , it holds that @xmath769 in ( * ? ? ? * main theorem ) nakada describes the rate of convergence of schmidt s convergents .",
    "namely for almost every @xmath39 , @xmath770 for reference , the relationship between the super - apollonian mbius generators @xmath771 and schmidt s @xmath772 are @xmath773 @xmath774    20 h.l .",
    "price , _ the pythagorean tree : a new species _ ( 2008 ) , https://arxiv.org/abs/0809.4324 .",
    "b. berggren , _ pytagoreiska trianglar _ , tidskrift for elementar matematik , fysik och kemi * 17 * ( 1934 ) , 129139 .",
    "barning , _ on pythagorean and quasi - pythagorean triangles and a generation process with the help of unimodular matrices _ , math .",
    "centrum amsterdam afd .",
    "zuivere wisk . * zw-011 * ( 1963 ) , 37 pp .",
    "p. billingsley , _ ergodic theory and information _ , j. wiley , 1965 . m. einsiedler and t. ward , _ ergodic theory with a view towards number theorey _ , _ graduate texts in mathematics _ * 259 * ( springer - verlag london limited 2011 ) .",
    "ford , _ on the closness of approach of complex rational fractions to a complex irrational number _ , trans .",
    "* 27 * ( 1925 ) , 146154 .",
    "e.  fuchs , _ counting problems in apollonian packings _ , bull .",
    "* 50 * ( 2013 ) , 229266 .",
    "graham , j.c .",
    "lagarias , c.l .",
    "mallows , a.r .",
    "wilks , c.h .",
    "yan , _ apollonian circle packings : number theory _ , journal of number theory * 100 * ( 2003 ) , 145 .",
    "graham , j.c .",
    "lagarias , c.l .",
    "mallows , a.r .",
    "wilks , c.h .",
    "yan , _ apollonian circle packings : geometry and group theory i. the apollonian group _ , discrete comput . geom .",
    "* 34 * ( 2005 ) , no .",
    "4 , 547585 . r.l .",
    "graham , j.c .",
    "lagarias , c.l .",
    "mallows , a.r .",
    "wilks , c.h .",
    "yan , _ apollonian circle packings : geometry and group theory ii .",
    "super - apollonian group and integral packings _ , discrete comput",
    ". geom . * 35 * ( 2006 ) , no .",
    "1 , 136 . j.c .",
    "lagarias , c.l .",
    "mallows , a.r .",
    "wilks , _ beyond the descartes circle theorem _ , amer . math .",
    "monthly * 109 * ( 2002 ) , no .",
    "4 , 338361 . a.  hall , _ genealogy of pythagorean triads _",
    "* 54 * ( 1970 ) , 377379 .",
    "kanga , _ the family tree of pythagorean triples _ , bull .",
    "inst . math .",
    "* 26 * ( 1990 ) , no . 1 - 2 , 1517 .",
    "m.  keane , _ a continued fraction titbit . _ , symposium in honor of benoit mandelbrot ( curaao , 1995 ) , fractals 3 ( 1995 ) , no .",
    "4 , 641650 .",
    "khinchin , _ continued fractions _ , 1997 , dover .",
    "a.  kontorovich , _ from apollonius to zaremba : local - global phenomena in thin orbits _ , bull .",
    "* 50 * ( 2013 ) , 187228 .",
    "j.  kocik , _ a theorem on circle configurations _ ( 2007 ) , https://arxiv.org/abs/0706.0372",
    ". h. nakada , _ on ergodic theory of a. schmidt s complex continued fractions over gaussian field _ , mh . math . * 105 * ( 1988 ) , 131150 .",
    "h. nakada , _ the metrical theory of complex continued fractions _ , acta arith .",
    "56 ( 1990 ) , no .",
    "4 , 279289 .",
    "h. nakada , _ on metrical theory of diophantine approximation over imaginary quadratic field _ , acta arith .",
    "51 ( 1988 ) , no .",
    "4 , 399403 .",
    "d. romik , _ the dynamics of pythagorean triples _ , trans .",
    "soc . * 360 * ( 2008 ) , 60456064 .",
    "sagemath , the sage mathematics software system ( version 7.3 ) , the sage developers , 2016 , http://www.sagemath.org .",
    "schmidt , _ diophantine approximation of complex numbers _ , acta math . * 134 * ( 1975 ) , 185 .",
    "schmidt , _ ergodic theory for complex continued fractions _ , mh . math . * 93 * ( 1985 ) , 3962 .",
    "schmidt , _ farey triangles and farey quadrangles in the complex plane _ , math .",
    "scand . , * 21 * ( 1967 ) , 241295 .",
    "schmidt , _ diophantine approximation in the field @xmath775 _ , journal of number theory * 131 * ( 2011 ) , 19832012 . w. schmidt , _ diophantine approximation _ , lecture notes in mathematics no",
    ". 785 , 1996 , springer - verlag .",
    "stange , _ visualizing the arithmetic of imaginary quadratic fields _ , int . math .",
    "res . not .",
    "stange , _ the apollonian structure of bianchi groups _",
    ", to appear in trans .",
    ", http://arxiv.org/abs/1505.03121 .",
    "vulakh , _ diophantine approximation on bianchi groups _ ,",
    "j. number theory * 54 * ( 1995 ) , 7380 .",
    "wolfram research , inc .",
    ", mathematica , version 10.0 , champaign , il ( 2014 ) ."
  ],
  "abstract_text": [
    "<S> we examine a pair of dynamical systems on the plane induced by a pair of spanning trees in the cayley graph of the super - apollonian group of graham , lagarias , mallows , wilks and yan . </S>",
    "<S> the dynamical systems compute gaussian rational approximations to complex numbers and are `` reflective '' versions of the complex continued fractions of a. l. schmidt . </S>",
    "<S> they also describe a reduction algorithm for lorentz quadruples , in analogy to work of romik on pythagorean triples . for these dynamical systems </S>",
    "<S> , we produce an invertible extension and an invariant measure , which we conjecture is ergodic . </S>",
    "<S> we consider some statistics of the related continued fraction expansions , and we also examine the restriction of these systems to the real line , which gives a reflective version of the usual continued fraction algorithm . </S>",
    "<S> finally , we briefly consider an alternate setup corresponding to a tree of lorentz quadruples ordered by arithmetic complexity . </S>"
  ]
}