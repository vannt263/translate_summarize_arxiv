{
  "article_text": [
    "the first announcements of successful binary black hole simulations @xcite marked an important break - through in numerical relativity and triggered a burst of activity in the field .",
    "while most current simulations adopt some variation of the bssn formulation @xcite together with what have become  standard coordinates \" ( namely 1+log slicing @xcite and the  gamma - driver \" condition @xcite ) , different implementations differ in many details .",
    "most current , three - dimensional numerical relativity codes share one feature , though , namely cartesian coordinates .",
    "while cartesian coordinates have many desirable properties , there are applications , for example gravitational collapse and supernova calculations , for which spherical polar coordinates would be better suited .",
    "implementing a numerical relativity code in spherical polar coordinates poses several challenges .",
    "the first challenge lies in the equations themselves .",
    "the original version of the bssn formulation , for example , explicitly assumes cartesian coordinates ( by assuming that the determinant of the conformally related metric be one ) .",
    "this issue has been resolved by brown @xcite , who introduced a covariant formulation of the bssn equations that is well - suited for curvilinear coordinate systems ( compare @xcite ) .",
    "another challenge is introduced by the coordinate singularities at the origin and the axis , which introduce singular terms into the equations .",
    "although the regularity of the metric ensures that , analytically , these terms cancel exactly , this is not necessarily the case in numerical applications , and special care has to be taken in order to avoid numerical instabilities .",
    "several methods have been proposed to enforce regularity in curvilinear coordinates .",
    "one possible approach is to rely on a specific gauge , e.g.  polar - areal gauge  @xcite , together with a suitable choice of the dynamical variables .",
    "numerous different such methods have been implemented in spherical symmetry ( see , e.g. , @xcite for an overview ) ; examples in axisymmetry include @xcite .",
    "this approach has some clear limitations .",
    "it is not obvious how to generalize these methods to relax the assumption of axisymmetry ; moreover the restriction of the gauge freedom prevents adoption of the  standard gauge \" that proved to be successful in evolutions with the bssn formulation .",
    "an alternative method is to apply a regularization procedure , by which both the appropriate parity regularity conditions and local flatness are enforced in order to achieve the desired regularity of the evolution equations ( see @xcite for examples ) .",
    "typically , these schemes involve the introduction of auxiliary variables as well as finding evolution equations for these variables .",
    "the resulting schemes are quite cumbersome , which may explain why , to the best of our knowledge , no such scheme has been implemented without any symmetry assumptions .    in",
    "yet an alternative approach , cordero - carrin _ et.al .",
    "_ @xcite recently adopted a partially implicit runge - kutta ( pirk ) method ( see also @xcite ) to evolve the hyperbolic , wave - like equations in the fully constrained formulation of the einstein equations ( see @xcite ) .",
    "essentially , pirk methods evolve regular terms in the evolution equations explicitly , and then use these updated values to evolve singular terms implicitly ( see @xcite and section [ sec : pirk ] below for details ) . following this success , montero & cordero - carrin @xcite , assuming spherical symmetry ,",
    "applied a second - order pirk method to the full set of the bssn einstein equations in curvilinear coordinates , and produced the first successful numerical simulations of vacuum and non - vacuum spacetimes using the covariant bssn formulation in spherical coordinates without the need for a regularization algorithm at the origin ( or without performing a spherical reduction of the equations , compare @xcite ) .    in this paper",
    "we present a new numerical code that solves the bssn equations in three - dimensional spherical polar coordinates without any symmetry assumptions .",
    "the code uses a second - order pirk method to integrate the evolution equations in time .",
    "this approach has the additional advantage that it imposes no restriction on the gauge choice .",
    "we consider a number of test cases to demonstrate that it is possible to obtain stable and robust evolutions of axisymmetric and non - axisymmetric spacetimes without any special treatment at the origin or the axis .    the paper is organized as follows . in section [ basic_equations ]",
    "we present the basic equations ; we will review the covariant formulation of the bssn equations , and will then specialize to spherical polar coordinates . in section [ sec : numerics ]",
    "we will briefly review pirk methods and will then describe other specifics of our numerical implementation .",
    "in section [ sec : numerical_examples ] we present numerical examples , namely weak gravitational waves , `` hydro - without - hydro '' simulations of static and rotating relativistic stars , and single black holes . finally we summarize and discuss our findings in section [ sec : discussion ] .",
    "we also include two appendices ; in appendix [ appendixa ] we describe an analytical form of the flat metric in spherical polar coordinates that provides a useful test of the numerical implementation of curvature quantities , while in appendix [ appendixb ] we list the specific source terms for our pirk method applied to the bssn equations .",
    "throughout this paper we use geometrized units in which @xmath0 .",
    "indices @xmath1 denote spacetime indices , while @xmath2 represent spatial indices .",
    "we adopt brown s covariant form @xcite of the bssn formulation @xcite . in particular , we write the conformally related spatial metric @xmath3 as @xmath4 where @xmath5 is the physical spatial metric , and @xmath6 a conformal factor . in the original bssn formulation the determinant @xmath7 of the conformally related metric is fixed to unity , which completely determines the conformal factor .",
    "this approach is suitable when cartesian coordinates are used , but not in more general coordinate systems .",
    "we will pose a different condition on @xmath7 below , but note already that @xmath8 the advantage of this approach is that all quantities in this formalism may be treated as tensors of weight zero ( see also @xcite ) .",
    "we also denote @xmath9 as the conformally rescaled extrinsic curvature .",
    "slightly departing from brown s approach we assume this quantity to be trace - free , while brown allows @xmath10 to have a non - zero trace . in the above expression @xmath11",
    "is the physical extrinsic curvature and @xmath12 its trace .    introducing a background connection @xmath13 ( compare @xcite ) we now define @xmath14 which",
    ", unlike the two connections themselves , transform as a tensor field .",
    "we also define the trace of these variables as @xmath15 it is not necessary for the background connection to be associated with any metric . in section [ sec : implementation ] below we will specialize to applications in spherical polar coordinates and hence will assume that the @xmath13 are associated with the flat metric in spherical polar coordinates .",
    "this assumption affects the equations in the remainder of this section in only one way , namely , we will assume that the riemann tensor associated with the connection @xmath13 vanishes , as is appropriate when the background metric is flat .",
    "finally , we define the connection vector @xmath16 as a new set of independent variables that are equal to the @xmath17 when the constraint @xmath18 holds .",
    "the vector @xmath16 plays the role of the  conformal connection functions \" @xmath19 in the original bssn formulation , but , unlike the @xmath19 , the @xmath16 transform as a rank-1 tensor of weight zero ( compare exercise 11.3 in @xcite ) . in the following",
    "we will evolve the variables @xmath16 as independent variables , satisfying their own evolution equation .    in order to determine the conformal factor @xmath20 we specify the time evolution of the determinant of the conformal metric . in this paper",
    "we adopt brown s  lagrangian \" choice @xmath21 defining @xmath22 where @xmath23 denotes the lie derivative along the shift vector @xmath24 , we then obtain the following set of evolution equations    [ evolution ] @xmath25^{\\rm tf } \\\\",
    "\\part_n \\phi & = & \\frac{1}{6 } \\bar d_k \\beta^i - \\frac{1}{6 } \\alpha k \\\\ \\part_n k & = & \\frac{\\alpha}{3 } k^2 + \\alpha \\bar a_{ij } \\bar a^{ij } % \\nonumber \\\\   - e^{- 4 \\phi }   ( \\bar d^2 \\alpha + 2 \\bar d^i \\alpha \\bar d_i \\phi ) \\nonumber \\\\ & & + 4 \\pi \\alpha ( \\rho + s ) \\\\",
    "\\part_n \\bar \\lambda^i & = & \\bar \\gamma^{jk } \\dflat_j \\dflat_k \\beta^i   + \\frac{2}{3 } \\delta \\gamma^i \\bar d_j \\beta^j + \\frac{1}{3 } \\bar d^i \\bar d_j \\beta^j \\nonumber \\\\ &   & - 2 \\bar a^{jk } ( \\delta^i{}_j \\partial_k \\alpha - 6 \\alpha \\delta^i{}_j \\partial_k \\phi - \\alpha \\delta \\gamma^i_{jk } ) \\nonumber \\\\ & & - \\frac{4}{3 } \\alpha \\bar \\gamma^{ij } \\partial_j k - 16 \\pi \\alpha \\bar \\gamma^{ij } s_j.\\end{aligned}\\ ] ]    ( compare equations ( 21 ) in @xcite ) . in the above equations , @xmath26 is the lapse function",
    ", @xmath27 denotes a covariant derivative that is built from the background connection @xmath13 ( and hence , in our implementation , associated with the flat metric @xmath28 in spherical polar coordinates ) and the superscript @xmath29 denotes the trace - free part .",
    "the matter sources @xmath30 , @xmath31 , @xmath32 and @xmath33 denote the density , momentum density , stress , and the trace of the stress as observed by a normal observer , respectively , and are defined by    @xmath34    here @xmath35 is the normal one - form on a spatial slice , and @xmath36 is the stress - energy tensor .",
    "we compute the ricci tensor @xmath37 associated with @xmath3 from @xmath38 in all of the above expressions we have omitted terms that include the riemann tensor @xmath39 associated with the connection @xmath13 , since these terms vanish for our case of a flat background .",
    "the hamiltonian constraint takes the form @xmath40 while the momentum constraints can be written as @xmath41 ( see equations ( 16 ) and ( 17 ) in @xcite ) .",
    "we note that when @xmath42 and @xmath43 , which is suitable for cartesian coordinates , the above equations reduce to the traditional bssn equations . in the following ,",
    "however , we will evaluate these equations in spherical polar coordinates .",
    "before the above equations can be integrated , we have to specify coordinate conditions for the lapse @xmath26 and the shift @xmath24 . unless noted otherwise we will adopt a ",
    "non - advective \" version of what has become the  standard gauge \" in numerical relativity .",
    "specifically , we use the  1+log \" condition for the lapse @xcite in the form @xmath44 and the  gamma - driver \" condition for the shift @xcite in the form    [ gammadriver ] @xmath45    ( compare @xcite ) . these ( or similar ) conditions play a key role in the  moving - puncture \" approach to handling black hole singularities in numerical simulations .",
    "we now focus on spherical polar coordinates , and will assume that the @xmath13 are associated with the flat metric in spherical polar coordinates @xmath46 , @xmath47 , and @xmath48 , @xmath49 accordingly , the only non - vanishing components of the background connection are @xmath50    when implementing the above equations in spherical polar coordinates , care has to be taken that coordinate singularities do not spoil the numerical simulation .",
    "these singularities appear both at the origin , where @xmath51 , and on the axis where @xmath52 .",
    "even for a simple scalar wave , appearances of inverse factors of @xmath46 and @xmath53 in the laplace operator can pose a challenge for a numerical implementation . in section [ sec : numerics ] below we discuss a pirk method ( see also @xcite ) that handles these singularities very effectively .",
    "an additional challenge in general relativity is that these inverse factors of @xmath46 and @xmath54 appear through the dynamical variables themselves .",
    "components of the spatial metric , for example , scale with powers of @xmath46 and @xmath54 , the inverse metric then scales with inverse powers of these quantities , and numerical error affecting these terms may easily spoil the numerical evolution .",
    "it is therefore important to treat these appearances of @xmath46 and @xmath54 analytically .",
    "we therefore factor out suitable powers of @xmath46 and @xmath54 from components of all tensorial objects . and",
    "@xmath55 are absorbed in the unit vectors . ]",
    "we start by writing the conformally related metric @xmath3 as the sum of the flat background metric @xmath28 and a correction @xmath56 ( which is not assumed to be small ) , @xmath57 the flat metric @xmath28 is given by eq .",
    "( [ flatmetric ] ) , and we write the correction @xmath56 in the form @xmath58 we similarly rescale the extrinsic curvature @xmath10 as @xmath59 and the connection vector @xmath16 as @xmath60 we treat the shift @xmath24 and @xmath61 similarly , and finally rewrite the evolution equations ( [ evolution ] ) for the coefficients @xmath62 , @xmath63 and @xmath64 etc",
    ".    we can compute the connection coefficients ( [ deltagamma ] ) from @xmath65 since @xmath66 we can compute the derivatives of the spatial metric @xmath67 in terms of the coefficients @xmath62 .",
    "direct calculation using the flat connection ( [ flatconnection ] ) yields @xmath68 the ( flat ) covariant derivative of the connection vector @xmath16 can similarly be expressed in terms of the @xmath64 as @xmath69 \\dflat_\\theta \\bar \\lambda^\\theta & = & \\displaystyle \\frac{1}{r } \\left (       \\partial_\\theta \\lambda^\\theta + \\lambda^r \\right ) \\\\[3 mm ] \\dflat_\\phi \\bar \\lambda^\\theta & = & \\displaystyle \\frac{1}{r } \\left (       \\partial_\\phi \\lambda^\\theta - \\cos \\theta \\lambda^\\phi \\right )   \\\\ \\\\[3 mm ] \\dflat_r \\bar \\lambda^\\phi & = & \\displaystyle \\frac{1}{r \\sin \\theta }",
    "\\partial_r \\lambda^\\phi   \\\\[3 mm ] \\dflat_\\theta \\bar \\lambda^\\phi & = & \\displaystyle \\frac{1}{r\\sin\\theta }        \\partial_\\theta \\lambda^\\phi   \\\\[3 mm ] \\dflat_\\phi \\bar \\lambda^\\phi & = & \\displaystyle \\frac{1}{r \\sin\\theta } \\left (       \\partial_\\phi \\lambda^\\phi + \\sin \\theta \\lambda^r + \\cos \\theta \\lambda^\\theta \\right )   \\end{array}\\ ] ] using the above expressions , we can compute the ricci tensor ( [ ricci ] ) as follows . in the first term on the right - hand side of ( [ ricci ] )",
    "we write the second covariant derivative of @xmath3 as a sum of first partial derivatives of the quantities @xmath70 and ( flat ) connection terms multiplying the @xmath70 , @xmath71 we then insert the expressions ( [ metric_derivs ] ) into the first term on the right - hand side and evaluate all derivatives explicitly , so that these terms can be written in terms of second partial derivatives of the coefficients @xmath62 .",
    "once this step has been completed , we add those remaining terms for which the flat background connection ( [ flatconnection ] ) is nonzero .",
    "the resulting equations are rather cumbersome , and it is easy to introduce typos in the numerical code .",
    "the numerical examples of section [ sec : numerical_examples ] are excellent tests of the code . in appendix [ appendixa ]",
    "we describe another analytical test that we have found very useful to check our implementation of curvature quantities .    as a final comment we note that the condition ( [ dgammadt ] ) determines the time evolution of the determinant @xmath7 of the conformally related metric , but not its initial value .",
    "the latter can be chosen freely in this scheme , in particular it does not need to be chosen equal to that of the background metric @xmath72 ( unlike in the original bssn formulation ) .",
    "for some of our numerical simulations , however , in particular for the rotating star simulations of section [ sec : rot_star ] , we found that rescaling the conformally related metric so that its determinant becomes @xmath73 improved the stability of the simulation , so that it required a smaller coefficient @xmath74 in the kreiss - oliger dissipation term ( [ ko ] ) below .",
    "the origin of the numerical instabilities in curvilinear coordinate systems are related to the presence of stiff source terms in the equations , e.g.  factors of @xmath75 or @xmath76 that become arbitrary large close to the origin or the axis . in the following",
    "we will refer to these terms as `` singular terms '' .",
    "pirk methods evolve all other , i.e.  regular , terms in the evolution equations explicitly , and then use these updated values to evolve the singular terms implicitly .",
    "this strategy implies that the computational costs of pirk methods are comparable to those of explicit methods .",
    "the resulting numerical scheme does not need any analytical or numerical inversion , but is able to provide stable evolutions due to its partially implicit component .",
    "we refer to  @xcite for a detailed derivation of pirk methods ( up to third order ) , and limit our discussion here to a simple description of the second - order pirk method that is implemented in our code .",
    "consider a system of partial differential equations    u_t = _ 1 ( u , v ) , + v_t = _ 2 ( u ) + _ 3 ( u , v ) , [ e : system ]    where @xmath77 , @xmath78 and @xmath79 are general non - linear differential operators .",
    "we will denote the corresponding discretized operators by @xmath80 , @xmath81 and @xmath82 , respectively .",
    "we will further assume that @xmath80 and @xmath82 contain only regular terms , and hence will update these terms explicitly , whereas the @xmath81 operator contains the singular terms and will therefore be treated partially implicitly .",
    "note that @xmath81 is assumed to depend on @xmath83 only . in the case of the bssn equations this holds for almost all variables ;",
    "the one exception can be treated as discussed in the paragraph below equation ( [ l3lambda ] ) in appendix [ appendixb ] , where we provide the exact form of the source terms .    in our second - order pirk scheme",
    "we update the variables @xmath83 and @xmath84 from an old timestep @xmath85 to a new timestep @xmath86 in two stages . in each of these two stages ,",
    "we first evolve the variable @xmath83 explicitly , and then evolve the variable @xmath84 taking into account the updated values of @xmath83 for the evaluation of the singular @xmath81 operator . for the system of equations ( [ e : system ] ) , the first stage    u^(1 ) = u^n + t l_1 ( u^n , v^n ) , + v^(1 ) = v^n + t ,",
    "is followed by the second stage    u^n+1 = , + v^n+1 = v^n + .    in the first stage ,",
    "@xmath83 is evolved explicitly ; the updated value @xmath87 is used in the evaluation of the @xmath81 operator for the computation of @xmath88 . in the second stage , @xmath83",
    "is again evolved explicitly , and the updated value @xmath89 is used in the evaluation of the @xmath81 operator for the computation of the updated values @xmath90 .    our pirk method is stable as long as the timestep is limited by a courant condition ; see eq .",
    "( [ courant ] ) below .",
    "we include all singular terms appearing in the sources of the equations in the @xmath81 operator .",
    "firstly , the conformal metric components , @xmath62 , the conformal factor , @xmath48 , the lapse function , @xmath26 , and the shift vector , @xmath24 , are evolved explicitly ( as @xmath83 is evolved in the previous pirk scheme ) ; secondly , the traceless part of the extrinsic curvature , @xmath63 , and the trace of the extrinsic curvature , @xmath91 , are evolved partially implicitly , using updated values of @xmath26 , @xmath24 , @xmath48 and @xmath62 ; then , the @xmath92 are evolved partially implicitly , using the updated values of @xmath26 , @xmath24 , @xmath48 , @xmath62 , @xmath63 and @xmath91 .",
    "finally , @xmath61 is evolved partially implicitly , using the updated values of the previous quantities .",
    "lie derivative terms and matter source terms are always included in the explicitly treated parts . in appendix  [ appendixb ] , we give the exact form of the source terms included in each operator .",
    "we adopt a centered , fourth - order finite differencing representation of most spatial derivatives . for each grid point",
    ", the finite - differencing stencil therefore involves the two nearest neighbors in each direction ( see fig .",
    "[ fig1 ] ) .",
    "an exception from our fourth - order differencing are advective derivatives along the shift , for which we use a second - order ( one - sided ) upwind scheme . because of the second - order time evolution , and the second - order advective terms",
    ", our scheme is overall second - order accurate , even though for some cases with vanishing shift we have found that the error appears to be dominated by the fourth - order terms .    .",
    "grid points , marked by the crosses , are placed at the center of grid cells , so that no grid point ends up at the center ( @xmath93 ) or on the axes ( @xmath52 or @xmath94 ) .",
    "our interior grid , bordered by solid lines in the figure , covers the region @xmath95 and @xmath96 ( as well as @xmath97 ) . as suggested by the two highlighted stencils ,",
    "our fourth - order differencing scheme requires two levels of ghost zones outside of the interior grid , indicated by the dotted lines.,width=326 ]    we adopt a cell - centered grid , as shown schematically in fig .",
    "specifically , we divide the physical domain covered by our grid , @xmath98 , @xmath99 and @xmath100 into @xmath101 cells with uniform coordinate size @xmath102 because of our fourth - order finite differencing scheme we need to pad the interior grid with two layers of ghost zones . except at the outer boundary",
    ", each ghost zone corresponds to some other zone in the interior of the grid ( with some other value of @xmath47 and @xmath48 ) , so that these ghosts zones can be filled by copying the corresponding values from interior grid points .    as a concrete example , consider a grid point with angular coordinates @xmath47 and @xmath48 , say , in the innermost radial zone ( highlighted by a ( blue ) filled circle in fig .  [ fig1 ] ) . evaluating the partial derivative with respect to @xmath46 at this point",
    "requires two grid points that , formally , have negative radii .",
    "we can fill these two required ghost points by finding the corresponding points in the interior of the grid , which have angular coordinates @xmath103 and @xmath104 .",
    "similarly , evaluating a derivative with respect to @xmath47 for a point with angular coordinates @xmath105 next to the axis ( see the ( red ) filled square in fig .",
    "[ fig1 ] ) requires ghost points that can be filled by finding the corresponding grid points with azimuthal angle @xmath104 in the interior of the grid .",
    ".parity conditions for components of vectors and tensors as implemented in our coordinate - based code . components of vectors and tensors have to be multiplied with the corresponding sign when they are copied into ghost zones at the center or the axis . [ cols=\"^,^,^,^\",options=\"header \" , ]     for scalar functions the corresponding function values can be copied immediately , but for components of vectors or tensors , expressed in spherical polar coordinates , a possible relative sign has to be taken into account .",
    "essentially , this occurs because , in spherical polar coordinates , the unit vectors may point into the opposite physical direction when we identify a ghost zone with an interior point , i.e.  when we go from @xmath105 to @xmath106 or @xmath107 .",
    "we list these relative sign changes , as implemented in our coordinate - based code , in table [ tab1 ] .",
    "we also require two sets of two ghost zones for @xmath48 , which can be filled directly using periodicity .    at the outer boundary",
    "we also require two ghost zones , as suggested by the ( red ) squared stencil in fig .",
    "we impose a sommerfeld boundary condition , which is an approximate implementation of an outgoing wave boundary condition , to fill these ghost zones . in our coordinate - based code",
    "we implement this condition by tracing an outgoing radial characteristic from each of the outer boundary grid points back to the previous time level .",
    "we then interpolate the corresponding function to the intersection of that characteristic and the previous time level , and copy that interpolated value , multiplied by a suitable fall - off in @xmath46 , into the boundary grid point .",
    "we assume a fall - off with @xmath108 for all metric variables ( i.e.  @xmath62 , @xmath63 , @xmath48 and @xmath91 ) as well as the lapse @xmath26 , but a @xmath109 fall - off for the shift @xmath24 as well as @xmath64 .",
    "the pirk method of section [ sec : pirk ] is stable as long as the time step @xmath110 is limited by a courant - friedrichs - lewy condition . in order to evaluate this condition we first find the smallest coordinate distance @xmath111 between any two grid - points in our cell - centered , spherical polar grid .",
    "this minimum distance is approximately @xmath112 we then set @xmath113 where we have chosen a courant factor @xmath114 for all simulations in this paper .",
    "it is a well - known disadvantage of spherical polar coordinates that the accumulation of gridpoints in the vicinity of the origin leads to a very severe limit on the timestep .",
    "we will discuss this issue in greater detail in section [ sec : discussion ] .",
    "we use kreiss - oliger  @xcite dissipation to suppress the appearance of high frequency noise at late times . specifically , we add a term of the form @xmath115 to the right hand side of the evolution equation for each dynamical variable @xmath116 . here",
    "@xmath74 is a dimensionless coefficient which we have chosen between 0 ( for some of our short - time evolutions ) and 0.001 for the rotating neutron star simulation in sect .",
    "[ sec : rot_star ] .",
    "as a first test of our codes we consider small - amplitude gravitational waves on a flat minkowski background . following teukolsky @xcite we construct an analytical , linear solution for quadrupolar ( @xmath117 ) waves from a function @xmath118 where the constant @xmath119 is related to the amplitude of the wave and @xmath120 to its wavelength ( see also section 9.1 in @xcite ) .",
    "we set @xmath121 , by which all length scales become dimensionless .",
    "we will consider axisymmetric ( @xmath122 ) and non - axisymmetric ( @xmath123 ) modes separately .",
    "for an axisymmetric @xmath122 small - amplitude gravitational wave at different instances of time . for this simulation",
    "we used a grid of size @xmath124 and imposed the outer boundary at @xmath125 .",
    "we show data as a function of @xmath46 in the ( arbitrary ) direction @xmath126 and @xmath127 .",
    "differences between the numerical results ( marked by crosses ) and the analytical solution ( solid lines ) are smaller than the width of the lines in this graph.,width=326 ]     as a function of time for a small - amplitude , axisymmetric gravitational wave .",
    "we show results for simulations with a grid of size @xmath128 , for @xmath129 , @xmath130 and @xmath131 , with the outer boundary imposed at @xmath132 . at these early times",
    ", the error appears to be dominated by the fourth - order differencing of the spatial derivatives.,width=326 ]    we first consider axisymmetric @xmath122 waves .",
    "since these solutions are independent of the coordinate @xmath48 , we may choose @xmath133 as small as possible ( which is @xmath134 in our code ) without loss of accuracy .",
    "we also choose a small amplitude of @xmath135 , so that deviations from the analytic solution , which is accurate only to linear order in @xmath119 , are dominated by our finite - difference error , and not by terms that are higher - order in @xmath119 .",
    "in the following we show results for a numerical grid with @xmath128 grid points , where @xmath129 , @xmath130 or @xmath131 , and imposing the outer boundary at @xmath132 . for these simulations we used the 1+log lapse condition ( [ 1+log ] ) , but chose a vanishing shift @xmath136 instead of the gamma - driver condition ( [ gammadriver ] ) .    in fig .",
    "[ fig2 ] we show snapshots of the metric function @xmath137 at different instances of time for our highest - resolution simulation with @xmath138 . for each time",
    ", we include the numerical results as crosses , as well as the analytical solution as a solid line .",
    "the differences between the numerical results and analytical solution are well below the resolution limit of this graph , so that the two can not be distinguished in this figure .    in fig .",
    "[ fig3 ] we show a convergence test for these waves . specifically , we compute the @xmath139-norm of the difference between the analytical solution @xmath137 and the analytical solution",
    ", @xmath140 is the coordinate volume of the numerical grid . in fig .",
    "[ fig3 ] we show these norms as a function of time for @xmath129 , @xmath130 and @xmath131 .",
    "the norms are rescaled with a factor @xmath141 ; the convergence of the resulting error curves indicates that , at these early times , the error is dominated by the fourth - order differencing of the spatial derivatives . in spherical polar coordinates , the courant condition ( [ courant ] ) limits the time step to such small values that the second - order errors associated with our pirk method are smaller than the fourth - order error of our spatial derivatives ( for vanishing shift ) .       for a non - axisymmetric @xmath123 small - amplitude gravitational wave at different instances of time . for this simulation we used a grid of size @xmath142 and imposed the outer boundary at @xmath143",
    "; we show data as a function of @xmath46 in the direction @xmath144 and @xmath145 .",
    "numerical results are marked by the crosses , while the analytical solution is shown as the solid line.,width=326 ]    non - axisymmetric gravitational waves represent a rare example of an analytical , time - dependent , three - dimensional , albeit weak - field solution to the einstein equations . clearly , this solution represents a stringent test for our code .    in fig .",
    "[ fig4 ] we show results for an @xmath123 wave , again for an amplitude @xmath135 . as in fig .",
    "[ fig2 ] , we graph solutions for @xmath137 as functions of @xmath46 at different instances of time . again , our numerical solution ( marked by crosses ) can hardly be distinguished from the analytical solution ( shown as solid lines ) .      as a test of strong - field , but",
    "regular solutions we consider spacetimes containing relativistic stars . in general , this requires evolving the stellar matter self - consistently with the gravitational fields , for example by solving the equations of relativistic hydrodynamics . since this is beyond the scope of this paper , we here adopt the `` hydro - without - hydro '' approach suggested by @xcite . in this approach , which can also be described as an `` inverse - cowling approximation ''",
    ", we leave the matter sources fixed , and evolve only the gravitational fields . in this way",
    ", it is possible to assess the stability of a spacetime evolution code , and its capability of accurately evolving strong but regular gravitational fields in spacetimes with static matter , without having to worry about the hydrodynamical evolution .",
    "these simulations serve as both a testbed and a preliminary step towards fully relativistic hydrodynamical simulations of stars . in this section",
    "we consider static and uniformaly rotating stars separately .",
    "we first consider non - rotating relativistic stars , described by the tolman - oppenheimer - volkoff ( tov ) solution @xcite .",
    "we focus on a polytropic tov star with polytropic index @xmath146 , and with a gravitational mass of about 85% of the maximum - allowed mass . for this model ,",
    "the central density is about 40% of that of the maximum mass model .",
    "we evolved this star with the 1+log slicing condition for the lapse ( [ 1+log ] ) , but kept the shift fixed to zero . because the spacetime is spherically symmetric",
    ", we could choose both @xmath147 and @xmath133 as small as possible ( @xmath148 ) without loss of accuracy .",
    "even for very modest grid resolutions in the radial direction ( e.g.  @xmath149 , with the outer boundary imposed at four times the stellar radius ) , we found that the gravitational fields settle down into an equilibrium that is similar to the initial data .",
    "after this initial transition , which is caused by the finite - difference error , the stellar surface as well as the outer boundaries ( see @xcite ) , the solution remains stable .       and the lapse @xmath26 for a rapidly rotating star ( see text for details ) .",
    "we show both functions both at the initial time , and at a late time @xmath150 .",
    "we also show both functions along rays in two different directions , one very close to the equator , the other pointing close to the pole .",
    "both profiles remain very similar to their initial data throughout the evolution.,width=326 ]    the evolution of the spacetime of a rapidly rotating relativistic star is a more demanding test than the previous one , as it breaks spherical symmetry and instead involves axisymmetric non - vacuum initial data in the strong gravity regime .",
    "the initial data used for this test are the numerical solution of a stationary and axisymmetric equilibrium model of a rapidly and uniformly rotating relativistic star  @xcite , which is computed using the lorene code @xcite .",
    "we consider a uniformly rotating star with the same @xmath146 polytropic equation of state as the non - rotating model of sect .",
    "[ sec : tov ] .",
    "our particular model has the same central rest - mass density as that non - rotating model , but rotates at @xmath151 of the allowed mass - shedding limit ( for a star of that central density ) ; expressed in terms of the gravitational mass @xmath152 , the corresponding spin period is approximately 157 @xmath152 .",
    "the ratio of the polar to equatorial coordinate radii for this model is @xmath153 . for this simulation",
    "we adopted both the 1+log condition for the lapse ( [ 1+log ] ) and the gamma - driver condition for the shift ( [ gammadriver ] ) .",
    "for this test we adopted a grid of size @xmath154 , and imposed the outer boundary at @xmath155 , which equals four times the equatorial radius . in fig .",
    "[ fig5 ] we show the initial and late - time profiles of the conformal exponent @xmath48 and the lapse @xmath26 , both in a direction close to the equator and close to the axis .",
    "evidently , both functions remain very close to their initial values throughout the evolution , as they should .      in this section we present results for two different simulations involving schwarzschild black holes . in section [ sec : trumpet ] we evolve a schwarzschild black hole in a ",
    "trumpet \" geometry @xcite , which , in the limit of infinite resolution , is a time - independent solution to the einstein equations given our slicing conditions ( [ 1+log ] ) . in section [ sec : wormhole ] we adopt wormhole initial data and follow the coordinate transition to a trumpet geometry .      , and its initial value @xmath156 , as a function of time . for these simulations we used a grid of size @xmath157 for @xmath129 , 2 , 4 and 8 , and imposed the outer boundary at @xmath158 .",
    "we rescale all differences with @xmath159 , so that the convergence of these lines demonstrates second - order convergence.,width=326 ]    maximally sliced trumpet data @xcite represent a time - independent slicing of the schwarzschild spacetime that satisfies our slicing condition ( [ 1+log ] ) .",
    "the solution can be expressed analytically in isotropic coordinates , albeit only in parametrized form @xcite . in this section",
    "we adopt these trumpet data as initial data , so that , in the continuum limit , the solution should remain independent of time .    for trumpet data the conformal factor diverges at @xmath93 .",
    "while , on our cell - centered grid , functions are never evaluated directly at the origin , derivatives in the neighborhood of the singularity at the origin are clearly affected by the singular behavior of the conformal factor . however , the great virtue of the  moving - puncture \" gauge conditions ( [ 1+log ] ) and ( [ gammadriver ] ) is that these errors only affect the neighborhood of the puncture , and do not spoil the evolution globally @xcite . in the following",
    "we will demonstrate these properties in our code using spherical polar coordinates .    for the simulations presented in this section we adopted a numerical grid of size size @xmath157 for @xmath129 , 2 , 4 and 8 , with the outer boundary imposed at @xmath158 .    in fig .",
    "[ fig6 ] we show results for the maximum of the radial component @xmath160 of the shift vector as a function of time . specifically , we show the difference between these maximum values @xmath161 and their initial values @xmath162 .",
    "since our trumpet data represent a time - independent solution to the einstein equations and our slicing and gauge conditions ( [ 1+log ] ) and ( [ gammadriver ] ) , these differences should converge to zero as the grid resolution is increased . in fig .",
    "[ fig6 ] we multiply the differences with @xmath159 ; the convergence of the resulting lines therefore demonstrates second - order convergence of the simulation .",
    "apparently the error in these simulations is dominated by the second - order advective terms .",
    "we also note that the outer boundary introduces error terms that depend on both the grid resolution and the location of the outer boundary .",
    "since the latter does not decrease when we increase the grid resolution , the code converges more slowly in regions that have come into causal contact with the outer boundary .",
    "we therefore include in fig .",
    "[ fig6 ] only sufficiently early times , before the location of the shift s maximum is affected by the outer boundary .      , the lapse function @xmath26 , and the shift @xmath163 , showing the coordinate transition from wormhole initial data to time - independent trumpet data .",
    "the ( blue ) long - dashed lines represent the initial data at @xmath164 , the ( red ) dashed lines show our numerical results at time @xmath165 , and the ( black ) solid lines show the analytical trumpet solution @xcite .",
    "the initial data appear double - valued because we graph this functions as a function of the areal radius @xmath166 ( see text for details ) . for these simulations we adopted a grid size @xmath167 with the outer boundary imposed at @xmath168 .",
    "( in these graphs we did not include the innermost two grid points , which are affected by the singular behavior of the puncture.),width=326 ]     as a function of time .",
    "we show results for different grid sizes @xmath169 for @xmath129 , 2 , 4 and 8 , with the outer boundary imposed at @xmath170 . after a brief transition from the initial data @xmath171 , the shift settles down into a new equilibrium .",
    "for relatively coarse grid resolutions the shift experiences a slow drift , but this drift disappears as the grid resolution is increased.,width=326 ]    ) at time @xmath172 . as in fig .",
    "[ fig8 ] we show results for grid sizes @xmath169 for @xmath129 , 2 , 4 and 8 , with the outer boundary imposed at @xmath170 .",
    "all results are rescaled with @xmath159 ; the convergence of the resulting lines demonstrates second - order convergence of our code.,width=326 ]    we now turn to evolutions of wormhole initial data , representing a horizontal slice through the penrose diagram of a schwarzschild black hole .",
    "for these data , the conformal factor is given by @xmath173 the conformally related metric is flat , @xmath174 , and the extrinsic curvature vanishes , @xmath175 .",
    "instead of choosing the killing lapse and killing shift , which would leave these data time - independent , we choose , at @xmath164 , a ",
    "pre - collapsed \" lapse @xcite @xmath176 and a vanishing shift , @xmath177 .",
    "we then evolve the lapse and the shift with the 1+log condition ( [ 1+log ] ) and the gamma - driver condition ( [ gammadriver ] ) .    since these initial data do not represent a time - independent solution to the einstein equations together with our gauge conditions , we observe a non - trivial time evolution that represents a coordinate evolution .",
    "for the  non - advective \" 1+log condition ( [ 1+log ] ) , this coordinate transition results in the maximally sliced trumpet geometry of section [ sec : wormhole ] @xcite . in fig .",
    "[ fig7 ] we show this coordinate transition for the conformal exponent @xmath48 , the lapse @xmath26 and the shift @xmath160 .",
    "we note that some care has to be taken when the numerical and analytical results are compared .",
    "the analytical solution of @xcite assumes @xmath174 .",
    "we also choose @xmath174 in our initial data , but this relation is not necessarily maintained during the time evolution , so that the numerical and analytical solutions may be represented in different spatial coordinate systems ( but on the same spatial slice ) . in order to compare the two solutions we therefore graph all quantities as a function of the gauge - invariant areal radius @xmath166 .",
    "since for wormhole data each value of @xmath178 corresponds to two values of the isotropic radius @xmath46 , the initial data in fig .",
    "[ fig7 ] appear double - valued . for these comparisons with the analytical solution we also graph the orthonormal component of the shift @xmath163 rather than",
    "the coordinate component @xmath160 itself .",
    "[ fig7 ] clearly shows the coordinate transition from wormhole initial data to the trumpet equilibrium solution .    in fig .",
    "[ fig8 ] we show the maximum of the radial shift @xmath160 as a function of time . after a brief period of a coordinate transition",
    "the shift settles down into a new equilibrium .",
    "we show results for grid sizes @xmath169 for @xmath129 , 2 , 4 and 8 , with the outer boundary imposed at @xmath170 .",
    "the graph shows that differences between the different results decrease rapidly as the grid resolution is increased .",
    "for our coarser grid resolutions the shift still experiences a slow drift after the initial transition , but this drift decreases as the grid resolution is increased .    finally , in fig .",
    "[ fig9 ] , we show profiles of the violations of the hamiltonian constraint ( [ ham ] ) at time @xmath179 . in this graph",
    "all results are rescaled with @xmath159 ; the convergence of the resulting lines demonstrates that the numerical error in these simulations is again dominated by the second - order implementations of the advective shift terms , and possibly the time evolution .",
    "in this paper we demonstrate that a pirk method can be used to solve the einstein equations in spherical polar coordinates without any need for any regularization at the origin or on the axis .",
    "specifically , we integrate a covariant version of the bssn equations in three spatial dimensions without any symmetry assumptions . to the best of our knowledge ,",
    "these calculations represent the first successful three - dimensional numerical relativity simulations using spherical polar coordinates .",
    "we consider several test cases to assess the stability , accuracy and convergence of the code , namely weak - field ",
    "teukolsky \" gravitational waves ,  hydro - without - hydro \" simulations of static and rotating relativistic stars , and single black holes .",
    "spherical polar coordinates have several advantages and disadvantages over cartesian coordinates . at least in single - grid calculations ,",
    "spherical polar coordinates allow for a more effective allocation of the numerical grid points for applications that involve one center of mass , for example gravitational collapse of single stars or supernovae .",
    "this is true even for uniform grids , which we adopt in this paper , but curvilinear coordinate systems also facilitate the use of non - uniform grids ( e.g.  a logarithmic radial coordinate ) to achieve a high resolution near the origin while keeping the outer boundary sufficiently far .",
    "spherical polar coordinates have another strong advantage over cartesian coordinates . in simulations of supernovae or gravitational collapse , for example , the shape of the stellar objects is not well represented by cartesian grids .",
    "this mismatch between the symmetry of the object and the grid creates direction - dependent numerical errors , which are observed to trigger @xmath180 modes that grow in time . since spherical polar coordinates mimic the symmetry of collapsing stars more accurately , we expect that this problem can at least be reduced with these coordinates .",
    "however , spherical polar coordinates also have disadvantages .",
    "one of these disadvantages is of practical nature : the equations in spherical polar coordinates include many more terms than those in cartesian coordinates , which makes the numerical implementation more cumbersome and error prone .",
    "spherical polar coordinates also introduce coordinate singularities that traditionally have created many numerical problems ; but these problems can be avoided when using a pirk method .",
    "perhaps the most severe disadvantage of spherical polar coordinates is caused by the courant limitation on the time step .",
    "as shown in eq .",
    "( [ courant ] ) , the close proximity of grid points close to the origin limits the size of the time steps @xmath110 to increasingly small values as the resolution is increased . in three - dimensional simulations",
    ", @xmath110 decreases approximately with the product @xmath181 .",
    "this is a severe disadvantage compared to cartesian coordinates where typically @xmath182 .",
    "however , this problem is not unique to numerical relativity , and instead is well - known from dynamical simulations in spherical polar coordinates in any field .",
    "accordingly , several different approaches to either solving or reducing this problem have been suggested .",
    "one possible approach is to reduce the grid resolution in the angular directions , @xmath147 and @xmath133 , close to the origin .",
    "however , for many applications the angular dependence of the solution may be independent of the radius , so that this approach might severely limit the accuracy of the results . it may also be possible to replace the pirk method in a sphere around the origin with a completely implicit scheme , so that the time step there is no longer limited by the courant condition ( [ courant ] ) .",
    "similar implicit / explicit ( imex ) `` split - by - region '' schemes have been suggested , for example , in @xcite in the context of spectral schemes .",
    "finally , the  yin - yang \" method suggested in @xcite mitigates the restrictions imposed by the courant condition ( [ courant ] ) as follows .",
    "note that the smallest physical distance between grid points , which in turn limits the time step @xmath110 , occurs next to the axis . in the yin - yang method ,",
    "the unit sphere is therefore covered by two different grids that are rotated by an angle of 90 degrees with respect to each other .",
    "each one covers only a region around its equator , thereby avoiding the most severe limitation on the time step next to the axis , but combined both grids cover the entire unit sphere .    despite the small time step ,",
    "however , we have been able to complete all simulations presented in this paper even with a serial code  in fact , some of our simulations were performed on a laptop computer .",
    "twb and icc gratefully acknowledge support from the alexander - von - humboldt foundation , twb would also like to thank the max - planck - institut fr astrophysik for its hospitality .",
    "this work was supported in part by the deutsche forschungsgemeinschaft ( dfg ) through its transregional center sfb / tr7 `` gravitational wave astronomy '' , and by nsf grant phy-1063240 to bowdoin college .",
    "in spherical polar coordinates , in particular in the absence of any symmetry assumptions , the numerical implementation of curvature quantities involves a significant number of terms that can easily introduce mistakes ( see section [ sec : implementation ] ) .",
    "one way of testing this part of the numerical code is to compare with known analytical solutions , for example for the schwarzschild metric .",
    "however , most analytical solutions feature symmetries ( e.g.  spherical symmetry for schwarzschild ) that simplify the problem in the spherical polar coordinates of our code . as a consequence ,",
    "many terms vanish identically for these solutions , so that not all terms in the code are tested . in this appendix",
    "we describe a simple test that is also analytical , but is neither spherically nor axially symmetric , and hence a very stringent test .    starting with the flat metric in cartesian",
    "coordinates we introduce a coordinate transformation of each coordinate @xmath183 that only depends on that coordinate itself ; the resulting metric then takes the form @xmath184 where @xmath185 , @xmath186 and @xmath187 are arbitrary functions . transforming this metric into spherical polar coordinates leads to a metric for which , in general , all coefficients are non - zero and depend on the coordinates in potentially complicated ways",
    ".    in cartesian coordinates , the only non - vanishing christoffel symbols are @xmath188 where the prime denotes a derivative with respect to the argument .",
    "given that the @xmath189 transform like tensors , we can obtain the corresponding coefficients in spherical polar coordinates with a simple coordinate transformation . for sufficiently general functions @xmath185 , @xmath186 and @xmath187 ,",
    "all 18 components of @xmath190 in spherical polar coordinates will be non - zero .",
    "this yields analytical expressions for the connection coefficients ( [ connection ] ) that can then be compared with numerical results .",
    ", for the flat metric ( [ flat_metric ] ) with functions ( [ flat_functions ] ) , evaluated using grid sizes @xmath191 for @xmath129 , 2 , 4 and 8 .",
    "all values are rescaled with @xmath141 , so that the convergence of these results indicates fourth - order convergence of our implementation.,width=326 ]    similarly , the connection functions are given by @xmath192 in cartesian coordinates , and can be transformed into spherical polar coordinates with a simple coordinate transformation .",
    "finally , all components of the ricci tensor in spherical polar coordinates should converge to zero , since the metric ( [ flat_metric ] ) is still flat . in fig .",
    "[ fig10 ] we show numerical examples for @xmath193 all components of @xmath37 are non - zero , but converge to zero as the grid resolution is increased . in the graph",
    "we rescale all results with @xmath141 , so that the convergence of the resulting quantities indicates fourth - order convergence of our implementation of the ricci tensor , as expected .",
    "we evolve the evolution eqs .",
    "( [ evolution ] ) , ( [ 1+log])-([gammadriver ] ) using a second - order pirk method . in this appendix",
    "we provide details on how we split the right - hand sides of these equations into the explicit and partially implicit operators .",
    "we start each time step by evolving the conformal metric components , @xmath62 , the conformal factor @xmath48 , the lapse function , @xmath26 , and the shift vector , @xmath24 , explicitly , i.e. , all the source terms of the evolution equations of these variables are included in the @xmath80 operator of the second - order pirk method .",
    "we then evolve the traceless part of the extrinsic curvature , @xmath63 , and the trace of the extrinsic curvature , @xmath91 , partially implicitly . more specifically , the corresponding @xmath81 and @xmath82 operators associated with the evolution equations for @xmath63 and @xmath91 in terms of the original bssn variable @xmath10 , related to @xmath63 through eq .  ( [ acap ] ) , are @xmath194^{\\rm tf } , \\label{l2a } \\\\          l_{3(\\bar a_{ij } ) } & = - \\frac{2}{3 } \\bar a_{ij } \\bar d_k \\beta^k - 2 \\alpha \\bar a_{ik } \\bar a^k { } _ j   + \\alpha \\bar a_{ij } k , \\\\",
    "l_{2(k ) } & = - e^{- 4 \\phi }   ( \\bar d^2 \\alpha + 2 \\bar d^i          \\alpha \\bar d_i \\phi ) + \\alpha \\bar a_{ij } \\bar a^{ij } , \\\\",
    "l_{3(k ) } & =   \\frac{\\alpha}{3 } k^2.\\end{aligned}\\ ] ] the @xmath92 are evolved partially implicitly , using the updated values of @xmath26 , @xmath24 , @xmath48 , @xmath62 , @xmath63 and @xmath91 . in terms of the original bssn variable @xmath16 , related to @xmath92 through eq .",
    "( [ lambda ] ) , the operators are @xmath195 we note that the evaluation of the ricci tensor @xmath37 in eq .",
    "( [ l2a ] ) requires updated values of @xmath196 before they become available .",
    "it is possible to either replace these updated values with old values , or to update the @xmath196 provisionally in a purely explicit step , use these values in eq .",
    "( [ l2a ] ) , but then overwrite these values after the @xmath196 are updated partially implicitly .",
    "we have used the latter approach in the simulations presented in this paper .",
    "finally , the @xmath61 are evolved partially implicitly , using the updated values of the previous quantities , @xmath197 matter source terms and lie derivative terms are always included in the explicitly treated parts ."
  ],
  "abstract_text": [
    "<S> in the absence of symmetry assumptions most numerical relativity simulations adopt cartesian coordinates . while cartesian coordinates have some desirable properties , spherical polar coordinates appear better suited for certain applications , including gravitational collapse and supernova simulations . </S>",
    "<S> development of numerical relativity codes in spherical polar coordinates has been hampered by the need to handle the coordinate singularities at the origin and on the axis , for example by careful regularization of the appropriate variables . </S>",
    "<S> assuming spherical symmetry and adopting a covariant version of the bssn equations , montero and cordero - carrin recently demonstrated that such a regularization is not necessary when a partially implicit runge - kutta ( pirk ) method is used for the time evolution of the gravitational fields . here </S>",
    "<S> we report on an implementation of the bssn equations in spherical polar coordinates without any symmetry assumptions . using a pirk method </S>",
    "<S> we obtain stable simulations in three spatial dimensions without the need to regularize the origin or the axis . </S>",
    "<S> we perform and discuss a number of tests to assess the stability , accuracy and convergence of the code , namely weak gravitational waves ,  hydro - without - hydro \" evolutions of spherical and rotating relativistic stars in equilibrium , and single black holes . </S>"
  ]
}