{
  "article_text": [
    "multiple analyses of observed gamma rays  @xcite provide growing evidence for the existence of inter - galactic magnetic fields ( for reviews see @xcite ) .",
    "the existence of such magnetic fields poses new questions for cosmology and probably also for particle physics  @xcite .",
    "in addition , a primordial magnetic field can play an important role during structure formation in the universe and could help us understand the ubiquity of magnetic fields in astrophysical bodies .",
    "a critical challenge at this stage is to sharpen observational techniques so that we can better observe and measure inter - galactic magnetic fields . of the various probes of inter - galactic magnetic fields ,",
    "blazar - induced gamma ray cascades hold certain key advantages .",
    "the gamma ray cascades originate in the voids in the large - scale structure and are mostly immune to complications of a noisy environment .",
    "the cascade develops in a relatively small spatial volume and hence is a local probe of the magnetic field in the voids .",
    "this is distinct from other methods , such as the faraday rotation of the cosmic microwave background polarization , that probe an integrated measure of the magnetic field .",
    "gamma ray cascades are also highly sensitive probes and can trace very weak cosmological magnetic fields .",
    "in this paper we study the effect of stochastic inter - galactic magnetic fields on blazar induced gamma ray halos and some results overlap with those of refs .",
    "the cascade process is complicated and all analyses use some simplifying assumptions .",
    "for example , the analysis in ref .",
    "@xcite only considered non - stochastic magnetic field configurations .",
    "other simplification schemes , such as the `` large spherical observer '' method employed in ref .",
    "@xcite , transport arrival directions of gamma rays for distant observers to a single earth - bound observer .",
    "this technique is certainly useful to study spectral properties of the cascade , but there is a danger that it loses or shuffles the spatial information of gamma ray arrival directions that is crucial for morphological studies .",
    "our focus is on the effect of stochastic magnetic fields that are statistically isotropic and with or without helicity .",
    "so we carefully analyse the spatial information of the gamma rays that is useful for deducing properties of the magnetic field but , for the present , we only include an approximate description of the cascade development .",
    "an important helpful concept that we develop in this paper is that of the `` pp surface '' ( see sec .",
    "[ sec : morph ] ) .",
    "this spatial surface holds the key to halo morphology and many of the features that we see in our simulations can be understood in terms of the shape of the pp surface and its intersection with the blazar jet .",
    "we have applied a refined version of the q - statistics first proposed in ref .",
    "@xcite to study the morphology of halos .",
    "our results show that this statistic can successfully extract the helicity of the magnetic field .",
    "our simulations also reveal that the plot of @xmath0 , where @xmath1 is a variable that will be explained below , has an additional bump .",
    "we are able to show that this bump is a genuine feature of the q - statistic and explain it in terms of properties of the pp surface in sec .",
    "[ sec : bump ] .",
    "thus this extra feature of @xmath0 may become an observational tool in future .",
    "we give some background information in sec .",
    "[ background ] , discuss our simulation techniques in sec .",
    "[ sec : morph ] , discuss features of the halo in sec .",
    "[ halofeatures ] , present results with non - stochastic fields in sec .",
    "[ qanalytical ] and with stochastic fields in sec .",
    "[ qstochastic ] .",
    "as mentioned above , we discuss the bump feature in @xmath0 in sec .",
    "[ sec : bump ] .",
    "we summarize our conclusions in sec .",
    "[ conclusions ] .",
    "our stochastic magnetic field generation scheme is described in appendix  [ bgeneration ] .",
    "tev photons from blazars induced electromagnetic cascades through pair production with the extragalactic background light , @xmath2 in the presence of a magnetic field , the charged leptons follow spiral paths as they propagate and lose energy due to inverse compton scattering with the cosmic microwave background ( cmb ) photons .",
    "the up - scattered cmb photons have gamma ray energies and produce extended halos around the direction of the blazar . in this section",
    "we briefly discuss the formation of the halo under simplifying assumptions .",
    "consider a blazar located at the origin of our coordinate system described by the unit basis vectors @xmath3 .",
    "we choose @xmath4 so that earth is located at @xmath5 where @xmath6 is the comoving distance to the source , d_s=_0^z_sdz . to perform the integral ,",
    "we have used @xmath7 , @xmath8 , @xmath9 as found in ref .",
    "@xcite and we have also assumed that @xmath10 and used natural units so that @xmath11 .",
    "for all the simulations in this paper we will choose @xmath12 .",
    "the blazar will typically emit photons in a collimated jet which we approximate to be a conical region with half - opening angle @xmath13 .",
    "the energy @xmath14 of these photons must lie above some threshold of about a tev if they are to produce an electron - positron pair from interaction with the extragalactic background light ( ebl ) .",
    "due to the opacity of the ebl , the tev photons will travel a mean free path ( mfp ) determined by the pair production cross section @xmath15 and the number density of the ebl photons @xmath16 , d_0= _",
    "^-1(80 ) ( ) , we have assumed that @xmath17 to approximate the mfp in the final equality  @xcite .",
    "following @xcite we will set @xmath18 as this dimensionless constant is estimated to lie in the range of @xmath19 .",
    "the comoving distance from the source to the pair production event is given by @xmath20 .",
    "the redshift of the produced lepton pairs will depend on the relative position of the leptons to the source .",
    "since @xmath21 , we make the approximation @xmath22 and we can write , [ tevcomfp ] d^c_0(80 ) ( )",
    ".    the energy of each of the produced leptons will be @xmath23 .",
    "these leptons are expected to travel a distance @xmath24 before losing most of their energy through inverse compton ( ic ) cooling which occurs by upscattering cmb photons .",
    "the cooling distance is d_e= ( 31 ) ( ) ( ) ^4 [ eq : de ] where @xmath25 is the thomson scattering cross section and @xmath26 is the cmb energy density .",
    "note that we can assume the whole cascade development happens around redshift @xmath27 as @xmath28 . at that redshift ,",
    "the average energy of a cmb photon is e_cmb ( 610 ^ -4)(1+z _ ) , which implies that , from energy conservation , the upscattered photons will have energy [ igamogamenergy ] e_=e_cmb(77 ) ( ) ^2 . as the lepton propagates , it upscatters @xmath29 photons , and produces a gamma ray cascade in the 1 - 100  gev range if the initial gamma ray had an energy of a few tev",
    ". clearly not every photon upscattered by the leptons will reach earth .",
    "those that do must come from a set of events that satisfy a set of three constraints given in ref .",
    "@xcite that we now describe .    after pair production",
    ", the lepton s initial velocity will be almost parallel to the momentum of the parent photon with a negligible deviation of order the inverse lorentz boost factor @xmath30 .",
    "their subsequent trajectory will be determined by the magnetic field @xmath31 through the lorentz force .",
    "if the magnetic field is incoherent on length scales smaller than the cooling distance @xmath32 , the lepton trajectories will be diffusive and this situation is much harder to analyze .",
    "so we focus on magnetic fields that are coherent on scales that are much larger than @xmath24 .",
    "then the lepton trajectories are bent in an effectively constant magnetic field and follow a helical trajectory with gyroradius r_l = r_l0 |_| ,   r_l0= , which depends on the lepton s perpendicular velocity to @xmath33 , _",
    "i.e. _ @xmath34 .",
    "the quantity @xmath35 is useful as it denotes the distance the lepton must travel in order to perform a full revolution .",
    "the value of @xmath36 is a function of the redshift as it depends on @xmath37 . for magnetic fields frozen in the plasma , the field strength redshifts as @xmath38 where @xmath39 is the magnetic field magnitude today . with r_l0 3.5   ( ) ( ) ^-1()^-2 , we can evaluate the ratio 0.0106   ( ) ^-1()()^-2 [ bending ] which determines the angular deflection of the leptons .     before scattering off an ebl photon and pair producing leptons .",
    "the lepton trajectories are bent due to the local magnetic field over a very short distance compared to the distance to the source , @xmath6 , and are shown in the insets .",
    "( the insets show huge bending whereas we have only considered magnetic fields that give small bending . )",
    "inverse - compton scattering of a lepton and cmb photons results in a cascade of gev energy gamma rays arriving at earth from the direction of the pair production .",
    "[ sketch taken from @xcite.],scaledwidth=50.0% ]    as depicted in fig .",
    "[ halocreation ] , let us introduce the following angles : @xmath40 is the arrival angle of the gev photon with respect to the source location , @xmath41 represents the angle between the upscattered photon and the tev photon , @xmath42 is the angle subtended by the tev photon s momentum , @xmath43 the vector from the source to earth , and finally @xmath44 is the azimuthal angle in which the whole ( planar ) scattering process take place .",
    "we also introduce the polar vectors @xmath45 and @xmath46 , in the @xmath47 plane .",
    "it is important to emphasize that the whole process occurs in a plane to a good approximation because @xmath48 and the length of the lepton trajectory can be ignored .",
    "then there are only 3 points that are relevant ( the source , the pair production point , and the observer ) and they always lie in a plane .",
    "applying the sine formula to the triangle in fig .",
    "[ halocreation ] we get our first constraint    [ const1 ] d_s ( ) = d_0 ( ) . where @xmath49 is the distance traveled by the tev photon and is a random variable drawn from a distribution that depends on the mfp @xmath50 in eq .",
    "( [ tevcomfp ] ) .",
    "this is discussed in detail in sec .",
    "[ sec : morph ] .    the bending angle @xmath41 is related to the distance traveled by the lepton through the local magnetic field which we write as @xmath51 .",
    "we also decompose the lepton s initial velocity at time @xmath52 , @xmath53 , where @xmath54 . at some later time @xmath55",
    "the velocity is [ leptonvel ] ( t)=v_||_||+v_(t)_v_(t)(__|| ) , here we introduced the angular frequency of the orbital motion @xmath56 and the @xmath57 sign refers to the positron ( electron ) trajectory .",
    "a cmb photon upscattered at time @xmath58 will be directed along the lepton s trajectory and so the deflection angle of figure [ halocreation ] can be expressed as @xmath59 .",
    "( [ leptonvel ] ) we can derive the second constraint , [ const2 ] 1-()=(1-((0))^2)(1-(t_ic / r_l0 ) ) .",
    "the time of inverse compton scattering @xmath58 is a stochastic variable .",
    "given its value and the magnetic field direction , the constraints determine the bending angle , @xmath41 .",
    "a single propagating lepton will be able to upscatter cmb photons towards earth only at certain times when the lepton s momentum is directed towards earth .",
    "photons upscattered at other times will not reach earth and we can safely ignore them .",
    "the number of photons upscattered by a lepton is very large ( @xmath60 ) , with mean deviation angles between the photons @xmath61 ( see eq .",
    "( [ bending ] ) ) .",
    "this angle is large enough that we only expect @xmath62 of the cascade photons from any lepton to reach earth .",
    "this allows us to adopt the strategy that we first select a value of @xmath58 from an exponential probability distribution as described in sec .",
    "[ sec : morph ] and then solve the constraint equations to find all tev gamma rays from the blazar that upscatter cmb photons that reach earth . for different values of @xmath58 , different tev gamma rays from the blazar will lead to observed photons . in this way",
    ", we will be able to track the photons that arrive on earth and not waste computational effort on those that go elsewhere .",
    "the third and final constraint is that the cascade gamma ray lies in the plane specified by @xmath63 .",
    "this requires that the lorentz force in the azimuthal @xmath63 direction vanishes between the time of pair production and ic scattering .",
    "namely the @xmath44 component of the impulse must vanish , j_== ( e_0^t_ic dt  ( t ) ) = 0 . the impulse can be simplified by pulling out the assumed constant magnetic field of the integral and defining _ = _ 0^t_ic dt  ( t ) .",
    "the geometrical setup of fig .",
    "[ halocreation ] forces @xmath64 to bisect the angle @xmath41 and therefore its unit vector can be written as _ =",
    "( /2- ) -(/2- ) . decomposing @xmath33 as = b_+b_+b_z allows us to write [ const3 ] _",
    "= -b_(/2-)-b_z(/2-)=0 .    to summarize this section , eqs .",
    "( [ const1 ] ) , ( [ const2 ] ) and ( [ const3 ] ) are the constraints that need to be satisfied by the variables @xmath65 given a magnetic field realization and initial velocity of the tev gamma ray ( both of which depend on @xmath65 ) , the source - observer distance ( @xmath6 ) , the distance to pair production ( @xmath49 ) , and the photon upscattering time ( @xmath58 ) .",
    "for events that satisfy the constraints in eqs .",
    "( [ const1 ] ) , ( [ const2 ] ) and ( [ const3 ] ) , an observer on earth will receive flux at a polar angle of @xmath40 from the line of sight ( los ) to the blazar and at an azimuthal angle @xmath44 .",
    "it is possible to solve for these angles analytically in certain regimes for specific magnetic fields @xmath66 while using the mfps of the particles : @xmath67 as given by eq .",
    "( [ eq : de ] ) and @xmath50 as given in eq .",
    "( [ tevcomfp ] ) @xcite",
    ". we will refer to these values as `` canonical '' propagating distances ( pds ) , in contrast to the `` stochastic '' pds we will use later .",
    "numerical methods are required when considering more general @xmath68 and when including the stochasticity in the pds of the initial gamma ray and pair produced leptons .",
    "note that @xmath24 , @xmath50 depend on the energy @xmath69 of the final gamma ray reaching earth .",
    "therefore , in the analysis with canonical pds , once we specify @xmath68 we can expect to find a 1 dimensional curve @xmath70 , @xmath71 by solving the constraints .",
    "the analysis with the canonical pds is helpful because it gives an idea of the overall shape that the extended emission will ressemble even when we include stochasticity .",
    "for the case of stochastic pd the constraint equations are solved with @xmath72 drawn from the probability density function p[d_e ] = e^-d_e / d_e [ cticdist ] and similarly the distance @xmath49 traversed by a tev gamma ray is drawn from p[d_0 ] = e^-d_0/d^c_0 .",
    "[ xdist ]    we will solve the constraint equations in a variety of magnetic field backgrounds , starting with simple analytic configurations for illustration purposes , and then move on to the more realistic case of stochastic , isotropic magnetic fields . our procedure to generate stochastic , isotropic magnetic fields is described in appendix  [ bgeneration ] .    turning to the energy distribution of gamma rays in our simulations , we assume a power law for the blazar spectrum @xcite and follow ref .",
    "@xcite by choosing a spectral index of @xmath73 that is characteristic of the tev sources .",
    "this yields a spectrum given by , ~()^-2.5 .",
    "we can use the relation between @xmath14 and @xmath69 to turn the blazar spectrum into one for the observed photons    ~()^-1.75 .",
    "[ dnde ]    our simulation algorithm proceeds in the following steps .",
    "first we draw an observed energy , @xmath69 , from the distribution in eq .",
    "( [ dnde ] ) .",
    "the drawn value of @xmath69 determines the energy of the high energy photon , @xmath14 , from eq .",
    "( [ igamogamenergy ] ) . with the values of @xmath69 and @xmath14",
    "we can find @xmath50 and @xmath24 from eqs .",
    "( [ tevcomfp ] ) and ( [ eq : de ] ) , then use eqs .",
    "( [ cticdist ] ) and ( [ xdist ] ) to draw values of @xmath74 and @xmath49 .",
    "now we try to solve the constraint equations ( [ const1 ] ) , ( [ const2 ] ) and ( [ const3 ] ) .",
    "if a solution does not exist we go back to the first step and draw an observed energy @xmath69 .",
    "if a solution does exist , it gives the coordinates @xmath65 of an event on earth at energy @xmath69 that satisfies all the constraints .",
    "we repeat the entire process until 1000 solutions are found . for a jet source ,",
    "we only retain the events whose initial tev photon lie within the jet .",
    "these small number of events give us the observed halo that will be shown in our plots .",
    "+ to start we consider a source that radiates tev photons isotropically in two different magnetic field backgrounds .",
    "the first background , [ constantb ] * b * = b_0(()- ( ) ) , with @xmath75 , is a uniform magnetic field pointing at an angle @xmath76 from the line of sight .",
    "the second background is a maximally helical field [ helb ] * b * = b_0((2x/ ) + ( 2x/ ) ) .",
    "here @xmath77 is the coherence length of the helical field .",
    "we will take @xmath78 , @xmath79 and @xmath80 as the prototypical values and eventually vary them one at a time to see their effect on the halo morphology .",
    "next we solve the constraint equations with the canonical pds and determine the arrival directions @xmath40 , @xmath44 for several different energies , @xmath69 , for an isotropically emitting source . with canonical pds , the events lie on a one dimensional curve shown in fig .",
    "[ haloexample ] in black .",
    "the corresponding simulations with stochastic pds results in the distribution of points in fig .",
    "[ haloexample ] .",
    "the points at lower energies are located further away from the source direction as is to be expected since the tev gamma ray travels further at low energies before pair producing leptons ( eq .  ( [ tevcomfp ] ) ) and",
    "leptons at low energies bend more before up - scattering cmb photons ( eq .  ( [ bending ] ) ) .",
    "looking closely at fig .",
    "[ haloexample ] , the drawn points are triangular ; upright triangles are gamma rays that originate from electrons and inverted triangles are those that originate from positrons .",
    "the distinction is made clearer in fig .",
    "[ haloexample2 ] where red ( black ) points originate from positron ( electron ) processes .",
    "if the source was taken to be a jet , gamma rays predominantly from one of the two leptons will be observed .    ) and ( [ helb ] ) @xcite .",
    "the colors denote the energy of the observed gamma ray.,title=\"fig:\",scaledwidth=45.0% ] ) and ( [ helb ] ) @xcite .",
    "the colors denote the energy of the observed gamma ray.,title=\"fig:\",scaledwidth=45.0% ]     but now red ( black ) points originate from inverse compton scattering due to positrons ( electrons ) .",
    "if the source was taken to emit along a jet , most of the observed gamma rays would originate from either positron or electron processes but not both.,title=\"fig:\",scaledwidth=45.0% ]   but now red ( black ) points originate from inverse compton scattering due to positrons ( electrons ) .",
    "if the source was taken to emit along a jet , most of the observed gamma rays would originate from either positron or electron processes but not both.,title=\"fig:\",scaledwidth=45.0% ]    the constraint equations are quite complicated to solve but there is a helpful visualization .",
    "first consider the third constraint equation , eq .",
    "( [ const3 ] ) , and note that @xmath81 and @xmath82 are also functions of @xmath40 , @xmath41 and @xmath44 .",
    "so eq .  ( [ const3 ] ) provides one functional relation between these variables that only depends on the magnetic field background .",
    "hence the magnetic field defines a two - dimensional surface in space .",
    "we will call this the `` pair production surface '' or the `` pp surface '' since only lepton pair production at this surface can send gev gamma rays to the observer . in fig .",
    "[ fluxsources ] we show the pp surface for the magnetic fields of eqs .",
    "( [ constantb ] ) and ( [ helb ] ) . on these plots",
    "we also show the pair production locations , `` pp locations '' , that resulted in the halos of fig .",
    "[ haloexample ] .",
    "note that a gamma ray from the source will propagate a certain distance , @xmath49 and then pair produce .",
    "so the pair production points also lie on a sphere of radius @xmath49 .",
    "this is partly enforced by the law of sines in eq .",
    "( [ const1 ] ) , which gives a relation between @xmath41 and @xmath40 .",
    "the intersection of this sphere and the pp surface define a one - dimensional curve in space ; cmb photons that are inverse compton scattered along the one - dimensional curve can propagate to earth .",
    "however , not all points on this one - dimensional curve will satisfy the final constraint .",
    "namely , eq .  ( [ const2 ] ) , picks out a limited set of points on the one - dimensional curve and these give the trajectories of the gamma rays that are observed .",
    "the pp surface can be found analytically for simple cases .",
    "for instance , the constraint in eq .",
    "( [ const3 ] ) with the helical magnetic field from eq .",
    "( [ helb ] ) , which has @xmath83 , reduces to , b_(/2-)=0 , with b_==(2z/+ ) .",
    "as @xmath84 has only one solution at @xmath85 in the physical range @xmath86 $ ] , @xmath87 $ ] , the surface is mainly determined by @xmath88 which translates to , = - .",
    "[ analyticpp ] this equation describes a spiral structure as seen in figure [ fluxsources ] .",
    "until now , we have been assuming that the source emits photons isotropically .",
    "below , we will also consider the case when the source emits photon in a collimated jet . in that case , there is a fourth constraint restricting the relevant part of the pp surface to where it intersects the jet , and it is quite possible that there is no solution .",
    "we ignore such cases as they are observationally irrelevant .",
    "in following figures we will show pp locations , even if they do not lie within the jet . only those pp locations that lie within the jet",
    "will lead to observed gamma rays .    )",
    "( top ) and the maximally helical magnetic field of eq .",
    "( [ helb ] ) ( bottom ) .",
    "the source is located at the orange star ; the observer is at @xmath89 .",
    "the blue points are the events that give rise to the halos shown in figs .",
    "[ haloexample ] . , title=\"fig:\",scaledwidth=45.0% ] )",
    "( top ) and the maximally helical magnetic field of eq .",
    "( [ helb ] ) ( bottom ) .",
    "the source is located at the orange star ; the observer is at @xmath89 .",
    "the blue points are the events that give rise to the halos shown in figs .",
    "[ haloexample ] . ,",
    "title=\"fig:\",scaledwidth=45.0% ]    fig .",
    "[ fluxsourcesjet ] presents an example in which the source has a jet with half - opening angle @xmath90 and the magnetic field is given by eq .",
    "( [ helb ] ) .",
    "the jet direction is chosen so that the earth lies within the cone of the jet and the blazar can be seen directly .",
    "the top plots in both figures shows that the jet picks out a small region of the pp surface , and the bottom plots show the resulting halo .    ) with @xmath91 g , @xmath80.,title=\"fig:\",scaledwidth=45.0% ] ) with @xmath91 g , @xmath80.,title=\"fig:\",scaledwidth=45.0% ]    ) and with the same setup as in fig .",
    "[ fluxsourcesjet ] but with @xmath39 reduced to @xmath92 . compared to fig .",
    "[ fluxsourcesjet ] , we see that the high energy gamma rays ( blue points ) are more clustered and so the halo size is smaller at fixed energy .",
    "however , the reduced field strength also causes lower energy gamma rays to come into the field of view , and the overall halo size does not change due to a reduced @xmath39 .",
    ", title=\"fig:\",scaledwidth=45.0% ] ) and with the same setup as in fig .",
    "[ fluxsourcesjet ] but with @xmath39 reduced to @xmath92 .",
    "compared to fig .",
    "[ fluxsourcesjet ] , we see that the high energy gamma rays ( blue points ) are more clustered and so the halo size is smaller at fixed energy .",
    "however , the reduced field strength also causes lower energy gamma rays to come into the field of view , and the overall halo size does not change due to a reduced @xmath39 . ,",
    "in this section we discuss the structure of the halo as the parameters @xmath39 , @xmath77 and the sign of the helicity of the maximally helical magnetic field in eq .",
    "( [ helb ] ) are varied .",
    "the concept of the pp surface will be a useful tool for this discussion as it allows us to clearly see how the magnetic field dictates the halo s shape .",
    "the magnetic field strength directly affects the amount of bending of the lepton trajectories since the gyroradius @xmath93 .",
    "therefore a weak magnetic field will require that the initial tev gamma ray is already propagating nearly towards earth . thus reducing @xmath39",
    "will shrink the size of the halo at any given gamma ray energy , although lower energy gamma rays may now enter the field of view .",
    "this can be seen in fig .",
    "[ halo_b_reduced ] which was created using @xmath94 and @xmath95 .",
    "the plot looks almost identical to fig .",
    "[ fluxsourcesjet ] , which was created using @xmath79 , except that the extent of the halo in the @xmath96 and @xmath97 directions , for photons of the same energy , has shrunk by a factor of @xmath98 .",
    "if one does not track the photon s energy , the effect of a change in @xmath39 is not easily seen through the morphology of the halos as their shapes and sizes are determined by the intersection of the jet and the pp surface .",
    "we show a few example of this interplay in the sketch of fig .",
    "[ haloshapecartoon ] .",
    "it is then possible to learn valuable information about the inter - galactic magnetic field in the region of the pp locations by observing the halo s shape . in a real situation",
    ", we can not observe the full halo shape as it will be contaminated by background photons coming from other sources .",
    "however , we can still extract certain useful halo information since the background is expected to be stochastically isotropic and certainly not parity odd .    as can be seen from eq .",
    "( [ tevcomfp ] ) , the mfp @xmath50 of the tev photons are of the order of @xmath99 mpc . any magnetic field with coherence length much larger than @xmath50 will appear constant in space . on the other hand , for @xmath100 , the halo will be produced from a rapidly varying part of the pp surface and will be more scattered .",
    "the helicity of the magnetic field in eq .",
    "( [ helb ] ) can be flipped by changing @xmath101 .",
    "a flip in the helicity simply leads to a parity inversion of the pp surface and the halo spiral also changes handedness .",
    "however , to get more statistics , we will investigate both helicities using independent simulations in sec .",
    "[ qanalytical ] .",
    "one of the main goals of this work is to determine if the helicity of the inter - galactic magnetic field can be deduced from the shape of the blazar halos .",
    "as we have seen , under certain conditions , a helical inter - galactic magnetic field can produce a clear spiral - like structure in a gamma ray halo .",
    "hence it is important to develop a statistical technique that is sensitive to this structure .",
    "a statistic , called @xmath102 , was developed in ref .",
    "@xcite , and was applied to the _ diffuse _ gamma ray background observed by the fermi telescope in refs .",
    "a non - zero value of @xmath102 was observed with high confidence in comparison to monte carlo simulations that assume no inter - galactic magnetic field .",
    "one can see from the halo plots above , _",
    "e.g. _ fig .",
    "[ haloexample ] , that the arrival direction of high energy photons tend to be closer to the blazar line - of - sight than those for lower energy photons .",
    "this is mainly due to the smaller magnetic bending at higher energies .",
    "hence different locations of the pp surface are sampled by photons of different energies and the observed gamma rays can carry an imprint of any curvature or twist of the pp surface .",
    "more precisely , the work of ref .",
    "@xcite showed that a left ( right ) handed helical magnetic field will create left ( right ) handed spiral patterns in the observed photons .",
    ") points out of the plane of the page as denoted by the arrow tip .",
    "the left sketch shows a situation where @xmath103 since @xmath104 ; similarly the sketch of the blazar on the right shows a @xmath105 situation .",
    ", scaledwidth=35.0% ]    below we briefly review the idea behind a slightly modified version of the q statistic proposed in ref .  @xcite .",
    "we will apply the statistics on regions surrounding an observed blazar whose angular position will be denoted by the unit vector @xmath106 .",
    "we consider a disk of radius @xmath1 centered on the location of the source and consider the set of photons within this disk .",
    "these photons are binned according to their energies into non - overlapping bins @xmath107 .",
    "we use @xmath108 to denote the number of photons in bin @xmath109 within the disk of radius @xmath1 .",
    "we then perform the sum , @xmath110 where @xmath111 is the unit vector denoting the arrival direction of photon @xmath112 in bin @xmath113 ; @xmath114 is the unit vector obtained by projecting @xmath115 on to the xy - plane : @xmath116 .",
    "the original q statistic in ref .",
    "@xcite was defined without the heaviside function ( @xmath117 ) in eq .",
    "( [ qdefn ] ) .",
    "we find that the @xmath117 factor improves the resolution of q. without the @xmath117 factor , the q - statistic is determined by the cross product of the _ average _ arrival direction of the photons ( in two energy bins ) within a radius @xmath1 of the source . because of the electron - positron symmetry , photons tend to arrive on either side of the source ( see fig .",
    "[ haloexample2 ] ) , and the average arrival direction tends to be near the origin . introducing the @xmath117 factor ensures that for every high energy photon selected , we only average the low energy photons that arrive on the same side with respect to the source .",
    "then there is a larger contribution to the value of @xmath102 .",
    "essentially the @xmath117 term limits the sum to gamma rays within the electron ( or the positron ) branch of the halo ( see fig .",
    "[ haloexample2 ] ) .",
    "we illustrate the @xmath118statistic in fig .",
    "[ qidea ] .    .",
    "this simulation did not include any stochasticity in the mean free path of the tev @xmath119-ray or the pair produced leptons , as such the energy of the photons are in one - one correspondence with their propagation distance .",
    "the surrounding magnetic field is given by eq .",
    "( [ helb ] ) with @xmath120 and @xmath95.,scaledwidth=45.0% ]    .",
    "the curves start at @xmath121 because there are insufficient photons within that distance.,scaledwidth=48.0% ]    in the presence of background gamma rays in addition to the blazar gamma rays , we expect @xmath0 to start near @xmath122 at @xmath123 , grow to a peak value near @xmath124 , where @xmath125 is the angular radius of the halo , and finally come back down towards @xmath122 at large @xmath1 where the signal becomes background dominated .",
    "however in mock maps with no background , the value of @xmath102 should asymptotically flatten out to its maximal value attained at @xmath125 , and its value will be negative ( positive ) for right ( left ) handed magnetic fields .",
    "we can see this behavior in fig .",
    "[ nostoqexample ] where we simulate the halo without any stochasticity and with the magnetic field of eq .",
    "( [ helb ] ) .    to showcase the q - statistic in this paper we will separate the gamma rays in three energy bins : @xmath126 all numbers in gev .",
    "the clean result of fig .  [ nostoqexample ] will get noisy once we include stochastic magnetic fields and stochastic pds . indeed , a randomly generated magnetic field can sometimes create halos whose q - statistics suggest the wrong helicity .",
    "it is therefore important to average over many realizations of the magnetic field and the jet orientation .",
    "each realization will simulate a blazar with a jet of half - opening angle @xmath127 and having earth in its los .",
    "the jet is also constrained to generate a halo with at least 3 events in order for the statistics to be applied ; this condition is generally automatically satisfied if earth is in the jet s los and the root mean squared magnetic field strength satisfies @xmath128 g .",
    "larger values of @xmath39 create too much bending and very few , if any , upscattered photons reach earth from seen blazars .",
    "jets pointing further away from the los might still yield observable photons but we would not be able to identify these blazars .",
    "this bending is also the reason for the empty regions around the axis of the pp surface seen in fig .",
    "[ fluxsourcesjet ] . the empty region gets larger for larger @xmath39",
    ".    we will consider magnetic fields of the form , [ rmfonemode_notappen ] * b*(*x*)=_*k*k * b*(*k*,f_,b_)e^i * k * with the set @xmath129 consisting of @xmath130 vectors which have magnitude @xmath131 and whose directions are approximatively uniformly spread over the unit sphere .",
    "half of the fourier coefficients @xmath132 are drawn from their respective distribution as outlined in appendix  [ bgeneration ] , while the other half are set by the requirement @xmath133 , necessary for obtaining a real value for the magnetic field . the value of @xmath134 controls the handedness of the field , namely @xmath135 corresponds to a maximally right - handed ( left - handed ) helical field .",
    "finally @xmath136 determines the root mean square of @xmath137 .    in fig .",
    "[ nostoq ] we compute the q - statistics for 100 realizations of halos created with canonical pds and with a random magnetic field created using the parameters [ param1_sim ] b_rms&=&210 ^ -15 ,  k_mag=0.01/ , + f_&=&+1 ,  2n^2 + 2=27 , where @xmath130 is the number of directions of the @xmath138 vector in eq .",
    "( [ rmfonemode_notappen ] ) . in fig .",
    "[ nostoq2 ] we plot the average of @xmath102 over all the realizations , denoted @xmath139 , for the same runs as in fig .  [ nostoq ] and for the three gamma ray energy bin combinations . by doing so",
    ", we have in mind of averaging the q - statistics obtained from small regions around multiple observed blazars .",
    "the plot also shows the standard error in @xmath139 which is given by the standard deviation of @xmath0 divided by the square root of the number of realizations in the monte carlo simulations . the standard error follows from the central limit theorem and is the error in using the sample mean to estimate the population mean .",
    "however , it assumes that the samples , monte carlo simulations in our case , from which values of @xmath0 are drawn are independent and identically distributed .",
    "this is certainly true in our setup but may not be true for actual observations in which the same photons might contribute to the @xmath0 calculated for blazars that are close to each other .",
    "in addition , there will be variation in the distance to observed blazars and other source characteristics .",
    "we plan to take some of these factors into account in a follow - up analysis .     versus @xmath1 for 100",
    "monte carlo runs when the stochastic magnetic fields are generated using the parameters shown in eq .",
    "( [ param1_sim ] ) with @xmath140 and canonical pds .",
    "the mean @xmath139 is shown by the orange curve .",
    ", scaledwidth=50.0% ]     of fig .",
    "[ nostoq ] for stochastic magnetic fields and canonical pds .",
    "the width of the error band is given by the standard error _ i.e. _ standard deviation of the 100 monte carlo @xmath0 values divided by the square root of the sample size ( 100 ) .",
    ", scaledwidth=50.0% ]     versus @xmath1 for @xmath141 ( red , solid ) , @xmath142 ( black , dashed ) and @xmath143 ( blue , dotted ) for the three energy bin combinations : @xmath144 ( top row ) , @xmath145 ( middle row ) and @xmath146 ( bottom row ) where the bins are defined in eq .",
    "( [ energybins ] ) .",
    "the other parameters for the stochastic magnetic fields are given in eq .",
    "( [ param1_sim ] ) ; the pds are also stochastic as described in sec .",
    "[ sec : morph ] .",
    "the bands denote standard error of @xmath147 .",
    ", scaledwidth=50.0% ]     versus @xmath1 for @xmath148 simulations with @xmath149 ( green , dotted ) , @xmath150 ( blue , solid ) , and @xmath151 ( orange , dashed ) and @xmath152 , @xmath153 .",
    ", scaledwidth=50.0% ]    it is very clear from fig .",
    "[ nostoq2 ] that @xmath154 is a good measure of the magnetic field helicity when we assume canonical pds .",
    "the next step is to see if @xmath155 remains a useful discriminant of magnetic helicity , even after we include stochasticity in both the magnetic field and the pds .",
    "we have plotted @xmath139 versus @xmath1 for 1000 monte carlo simulations for @xmath156 ( fig .",
    "[ unib_q_100_hel1 ] ) .",
    "the plots show a clear correlation between @xmath157 and the helicity of the magnetic field .",
    "it is also reassuring that the @xmath140 plot is the mirror image of the @xmath158 curve , just as we would expect due to parity reflection .",
    "next we examine the dependence of @xmath139 on magnetic field parameters . in fig .",
    "[ q_hel1_bvar_5em15_em15 ] we plot @xmath139 for several different magnetic field strengths and for fixed helicity @xmath152 .",
    "we see that increasing the magnetic field strength leads to an increasing amplitude of @xmath147 for _ all _ energy combinations .",
    "the increase is due to the magnitude of @xmath159 which becomes larger as the bending allows @xmath160 , @xmath161 to point further apart .",
    "the effect of changing the magnetic field coherence scale is shown in fig .",
    "[ q_hel1_kvar ] where the magnetic field strength and other parameters are fixed and only @xmath131 is varied . the magnetic field with larger coherence length gives a larger signal , but there is a turning point as extremely large coherence scale fields will behave like uniform fields .",
    "the signal for smaller correlation length is washed out but the suppression depends on the energy combination .",
    "this is to be expected from the analysis of ref .",
    "@xcite since @xmath147 with a certain energy combination is sensitive to the magnetic helicity power spectrum at a definite coherence scale that is determined by the combination of energies . to probe magnetic fields on small length scales ,",
    "it is necessary to consider gamma rays whose energies are close together @xcite .",
    "thus the energy bins also have to be smaller and this means that the statistics is poorer .",
    "the above results are from 1000 realizations in the monte carlo simulations .",
    "each run gives a certain asymptotic value @xmath162 .",
    "the 1000 values of @xmath162 for different magnetic field helicities and for different energy combinations are plotted in histograms in fig .",
    "[ qhisto_3hist ] .",
    "non - vanishing helicity causes the distribution of @xmath162 to skew in a direction that is in correspondence with the sign of the helicity .     versus @xmath1 for @xmath148 simulations with @xmath153 ( solid , blue ) , @xmath163 ( orange , dashed ) , @xmath164 ( green , dotted ) with @xmath165 and @xmath140 . ,",
    "the q - statistic is essentially a measure of the differential rotation found in the arrival direction of photons of different energies .",
    "q will be negative ( positive ) if the rotation is right ( left)-handed as is depicted in fig .",
    "[ qidea ] .",
    "the results of our monte carlo simulations , for example in fig .",
    "[ unib_q_100_hel1 ] , show that @xmath147 has a bump at small @xmath1 . here",
    "we provide an explanation of this small @xmath1 bump .",
    "magnetic field and canonical pds .",
    "the lower the energy of the observed photon , the further away is the pp location from the source .",
    ", scaledwidth=45.0% ]     magnetic field and stochastic pds .",
    "( the corresponding halo is shown in fig .",
    "[ bumpskymap ] . )",
    "the color coding is the same as in fig .",
    "[ 3dnosto ] .",
    "now the low energy observed photons have pp locations that are spread out in the direction of the los and some of these photons ( red dots ) originate closer to the source than the high energy pp locations ( blue dots ) . , scaledwidth=45.0% ]    first note that the small @xmath1 bump does not appear in fig .",
    "[ nostoq2 ] that was produced by assuming canonical , not stochastic , pds .",
    "therefore the appearance of the bumps must be tied to the stochasticity of the pds .",
    "when the pds take their canonical values , low energy gamma rays arise from interactions on a region of the pp surface that is far from the source , whereas high energy gamma rays arise closer to the source .",
    "hence the pp locations are distributed in a natural progression , from close to the source to further away from the source , as the energy of the photons is decreased .",
    "this can be seen in fig .",
    "[ 3dnosto ] . on the other hand , when the pds are stochastic",
    ", the low energy photons can arise from close to the source and also from far away as seen in fig .",
    "[ bump3d ] .",
    "the ones that come from close to the source are also closer to the los due to the geometry of the jet and are observed at smaller values of @xmath1 .",
    "these low energy photons bend more than the high energy photons and can have pp locations that are higher up along the los than the high energy photons .",
    "hence they measure the twist of the pp surface as one traverses the pp surface from low positions along the los to high positions ( instead of the usual direction of traversal from high to low ) .",
    "if @xmath1 is large , then the @xmath102 statistics takes into account all the low energy photons and these are predominantly far away from the source .",
    "so at large @xmath1 , the sign of the @xmath102 statistics is the same as that in the case of canonical pds .",
    "thus @xmath0 changes sign once @xmath1 is large enough so that the mean position of the pp locations of the low energy photons is below that of the high energy photons .",
    "this effect results in a halo of the form seen in fig .",
    "[ bumpskymap ] and translates into a bump in @xmath0 at small values of @xmath1 and with a sign that is opposite to that of the asymptotic value of @xmath102 .    ) but with @xmath158 .",
    "the q - statistics is sensitive to half the halo , as depicted by the red shading . considering the remaining photons in the dark - shaded region , the red triangle and the purple square show the mean arrival directions of the low energy and high energy gamma rays within a disk of small @xmath1 in the upper diagram and of large @xmath1 in the lower diagram . comparing to fig .",
    "[ qidea ] , we find @xmath103 for small @xmath1 and @xmath105 at large @xmath1 , implying a bump in the @xmath0 plot at small @xmath1 .",
    "the color coding is the same as in fig .",
    "[ 3dnosto ] .",
    ", scaledwidth=45.0% ]",
    "we have studied the effect of stochastic inter - galactic magnetic fields on the morphology of gamma ray halos .",
    "the dependence of the morphology on the magnetic field strength , the coherence length , and the helicity were investigated .",
    "most importantly , we have provided an understanding of the structure of the halo in geometrical terms , as arising due to the `` pp surface '' as determined by the magnetic field . in simple cases , the pp surface can be found analytically ( for example , eq .  ( [ analyticpp ] ) ) .    to analyze the halo morphology ,",
    "we have proposed a sharper version of the q - statistic in eq .",
    "( [ qdefn ] ) and applied it to simulated halos .",
    "our key finding is that @xmath102 is a powerful diagnostic of the magnetic helicity ( fig .",
    "[ unib_q_100_hel1 ] ) , field strength ( fig .  [ q_hel1_bvar_5em15_em15 ] ) and coherence scale ( fig .",
    "[ q_hel1_kvar ] ) . based on the analytical work of ref .",
    "@xcite , we expect the sensitivity of @xmath102 to the coherence scale to depend crucially on the energies of the gamma rays that are used .",
    "it would be interesting to quantitatively examine how the sensitivity of @xmath102 to the coherence scale can be improved with a choice of energy bins .",
    "in addition , our monte carlo simulations have revealed a bump in @xmath139 at small values of @xmath1 ( see fig .",
    "[ unib_q_100_hel1 ] ) . we have understood and explained this feature in terms of the pp surface in sec .",
    "[ sec : bump ] .",
    "this new feature may become useful in the analysis of real data in the future .",
    "our present study is limited in a few ways that we plan to overcome in future work .",
    "first , we have not included any background gamma rays .",
    "these will introduce noise in the evaluation of @xmath147 and the error bars will increase .",
    "we have also limited ourselves to stochastic isotropic magnetic fields but with only one @xmath166mode .",
    "this is useful at this stage as it allows us to diagnose the effects of changing the coherence scale . in future",
    ", we plan to include a spectrum of the magnetic field as motivated by current observations @xcite . in future",
    "we also plan to incorporate the full development of the electromagnetic cascade into our numerical code , perhaps along the lines of ref .",
    "@xcite or @xcite .",
    "once we have understood individual blazar halos , we will apply our techniques to the diffuse gamma ray background which is expected to contain halos due to unseen blazars as well as those due to identified blazars .",
    "we thank andrew long for comments .",
    "tv is supported by the u.s .",
    "department of energy , office of high energy physics , under award no .",
    "de - sc0013605 at asu .",
    "to generate helical magnetic fields , we first decompose the magnetic field @xmath137 in circularly polarized modes with basis vectors @xmath167 that are divergence - free eigenfunctions of the laplace operator ^(*k*)=*e*^(*k*)^i * k * ^i * k * . the triad of unit vectors , @xmath168 , is constructed as _ 1 ,   * e*_2 ,   * e*_3= where @xmath169 is any chosen unit vector such that @xmath170 .",
    "hence any magnetic field can be decomposed as , @xmath172,\\end{aligned}\\ ] ] with the condition that b^(*k*)=-b^(-*k * ) [ realb ] to ensure that @xmath137 is real .",
    "the divergence - free condition , @xmath173 , is automatically satisfied in this procedure .",
    "we are interested in generating random magnetic fields with given energy ( @xmath174 ) and helical ( @xmath175 ) power spectra .",
    "the relations between the modes @xmath176 and the power spectra are given by [ averagebsquare ] |*b*(*x*)|^2 = e_b(k ) d ( k ) and [ adotb ] ( * x*)(*x * ) = h_b(k ) d ( k ) .",
    "the ratio of @xmath177 and @xmath178 will be written in terms of a function @xmath179 as @xcite , h_b(k)=f_h(k)e_b(k ) , [ defnfh ] and the `` realizability condition '' leads to the restriction -1f_h(k ) 1 the field is non - helical if @xmath180 , maximally right - handed if @xmath140 , and maximally left - handed if @xmath158 .        in this paper",
    "we focus on stochastic magnetic fields that are _ isotropic _ but have power on a single length scale @xmath185 and that have either @xmath186 or @xmath187 .",
    "this corresponds to a delta function distribution for @xmath174 and vanishing or maximal helicity of either sign . to ensure that the magnetic fields are stochastically isotropic",
    ", we choose @xmath188 vectors @xmath189 ( @xmath190 ) that discretize half of the two - sphere of directions in @xmath191space , @xmath192 with @xmath193 for @xmath194 , and @xmath195    once we have @xmath138 and @xmath176 as described above , we compute ( * k*)= b^+*k*^++b^- * k*^- for every @xmath196 .",
    "we also find @xmath197 using the reality condition ( -*k * ) = * b*^*(*k * ) .",
    "finally we obtain the random magnetic field , [ rmfonemode ] * b*(*x)=_*k*k * b*(*k*)e^i * k * where @xmath129 is the set of vectors @xmath198 for @xmath199 . *      a.  neronov and i.  vovk , science * 328 * , 73 ( 2010 ) doi:10.1126/science.1184192 [ arxiv:1006.3504 [ astro-ph.he ] ] . s.  ando and a.  kusenko , astrophys .  j.   * 722 * , l39 ( 2010 ) doi:10.1088/2041 - 8205/722/1/l39 [ arxiv:1005.1924 [ astro-ph.he ] ] .",
    "w.  essey , s.  ando and a.  kusenko , astropart .",
    "* 35 * , 135 ( 2011 )",
    "doi:10.1016/j.astropartphys.2011.06.010 [ arxiv:1012.5313 [ astro-ph.he ] ] . h.  tashiro , w.  chen , f.  ferrer and t.  vachaspati , mon .  not .",
    "* 445 * , no .",
    "1 , l41 ( 2014 ) doi:10.1093/mnrasl / slu134 [ arxiv:1310.4826 [ astro-ph.co ] ] . w.  chen , b.  d.  chowdhury , f.  ferrer , h.  tashiro and t.  vachaspati , mon .  not .",
    "450 * , no . 4 , 3371 ( 2015 ) doi:10.1093/mnras / stv308",
    "[ arxiv:1412.3171 [ astro-ph.co ] ] . w.  chen , j.  h.  buckley and f.  ferrer , phys .",
    "lett .   * 115 * , 211103 ( 2015 ) doi:10.1103/physrevlett.115.211103 [ arxiv:1410.7717 [ astro-ph.he ] ] . j.  d.  finke , l.  c.  reyes , m.  georganopoulos , k.  reynolds , m.  ajello , s.  j.  fegan and k.  mccann , astrophys .",
    "j.   * 814 * , no . 1 , 20 ( 2015 ) doi:10.1088/0004 - 637x/814/1/20 [ arxiv:1510.02485 [ astro-ph.he ] ] .",
    "a.  brandenburg and k.  subramanian , phys .",
    "rept .   * 417 * , 1 ( 2005 ) doi:10.1016/j.physrep.2005.06.005 [ astro - ph/0405052 ] .",
    "a.  elyiv , a.  neronov and d.  v.  semikoz , phys .",
    "d * 80 * , 023010 ( 2009 ) doi:10.1103/physrevd.80.023010 [ arxiv:0903.3649 [ astro-ph.co ] ] .",
    "a.  j.  long and t.  vachaspati , jcap * 1509 * , no . 09 , 065 ( 2015 ) doi:10.1088/1475 - 7516/2015/09/065 [ arxiv:1505.07846 [ astro-ph.co ] ] .",
    "t.  fitoussi , r.  belmont , j.  malzac , a.  marcowith , j.  cohen - tanugi and p.  jean , doi:10.1093/mnras / stw3365 arxiv:1701.00654 [ astro-ph.he ] .",
    "h.  tashiro and t.  vachaspati , phys .",
    "d * 87 * , no .",
    "12 , 123527 ( 2013 ) doi:10.1103/physrevd.87.123527 [ arxiv:1305.0181 [ astro-ph.co ] ] ."
  ],
  "abstract_text": [
    "<S> inter - galactic magnetic fields can imprint their structure on the morphology of blazar - induced gamma ray halos . </S>",
    "<S> we show that the halo morphology arises through the interplay of the source s jet and a two - dimensional surface dictated by the magnetic field . through extensive numerical simulations , </S>",
    "<S> we generate mock halos created by stochastic magnetic fields with and without helicity , and study the dependence of the halo features on the properties of the magnetic field . </S>",
    "<S> we propose a sharper version of the q - statistics and demonstrate its sensitivity to the magnetic field strength , the coherence scale , and the handedness of the helicity . </S>",
    "<S> we also identify and explain a new feature of the q - statistics that can further enhance its power . </S>"
  ]
}