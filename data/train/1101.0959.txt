{
  "article_text": [
    "influenza a continues to evade eradication resulting in ongoing economic and human cost .",
    "yearly epidemics are responsible for 36,000 deaths on average in the united states .",
    "three times in the past century global pandemics , including the infamous spanish influenza of 1918 , resulted in catastrophic mortality rates [ @xcite ] .",
    "influenza epidemiologists believe a future influenza pandemic is an imminent threat [ @xcite ] .",
    "nearly 400 documented transfers [ @xcite ] of the highly virulent and potentially pandemic [ @xcite ] h5n1 strain of avian flu to humans in addition to the recent development of h1n1 swine flu [ @xcite ] bolster the threat .",
    "the increasingly relevant necessity of preventing future influenza pandemics requires a clear understanding of the evolutionary mechanisms of influenza as it is the key to vaccine development [ @xcite ] .",
    "influenza a is a negative single - stranded rna virus composed of 8 segments that total approximately 13 kb in length and encode 11 proteins .",
    "the three largest segments encode polymerases pb1 , pb1-f2 , pb2 and pa all of which are involved in rna transcription and replication .",
    "the next three segments code for the two surface glycoproteins haemagglutinin ( ha ) and neuraminidase ( na ) as well as the nucleoprotein ( np ) .",
    "the two smallest segments encode the matrix proteins m1 and m2 and the nonstructural proteins ns1 and ns2 [ @xcite , @xcite ] . influenza",
    "a research typically focuses on the epitope - rich ha and na segments because they exhibit strong evolutionary selective pressure due to their direct interaction with the host immune system and are the primary determinants of the antigenic variation of influenza [ @xcite ] .",
    "the 16 ha and 9 na glycoproteins found in the avian reservoir , referred to as h1 to h16 and n1 to n9 , respectively , characterize and name the subtypes of influenza a [ @xcite ] .",
    "the evolutionary history of influenza a involves the interaction of a number of mechanisms including mutation and reassortment .",
    "approximately one random sequence mutation every replication cycle combined with the selective pressure on the surface glycoproteins results in an accumulation of point mutations on the ha and na segments termed antigenic drift .",
    "the influenza genome also evolves through reassortment in which two subtypes coinfect a single host cell and exchange segments .",
    "this exchange of genetic material can lead to an antigenic shift or the creation of a new , potentially lethal , subtype .",
    "reassortment between a virus in the avian reservoir and human influenza a resulted in the subtypes responsible for the asian and hong kong influenza pandemics [ @xcite ] and the current swine flu pandemic derives from a triple reassortment event [ @xcite ] .",
    "as critically important events in influenza evolution occur at the genome - level , complete genome analysis yields scientific insight that single segments can not afford .",
    "for example , @xcite clarify a perplexing question in the evolutionary dynamics of ha by considering the varying histories of each segment . analyzing 156 complete h3n2 viruses over a five - year time span from 1999 to 2004 , @xcite ( @xcite )",
    "discover that while the fujian - variant ha segment has been co - circulating since at least 2000 , the variant only rises to dominance in 2002 after other segments within the influenza genome reassort and provide a synergistic background .",
    "this important reassortment event is only understood by studying the influenza genome in its entirety .",
    "a more recent study by @xcite emphasizes the importance of incorporating model parameter uncertainty in drawing conclusions about influenza evolution through a bayesian analysis of a truly massive dataset . @xcite",
    "compile 687 h3n2 influenza a full genomes sampled from new york over a twelve - year period .",
    "@xcite address a host of biologically and clinically relevant questions including : ( 1 ) are reassortment events coincident with shifts in ha antigenicity ?",
    "( 2 ) do certain segments maintain greater genetic diversity ?",
    "( 3 ) are the genetic histories of certain segments correlated ?",
    "however , due to a dearth of bayesian massive data techniques , computational constraints force @xcite to partition the data by stratifying on segment , using the data inefficiently , and drawing ad hoc conclusions about potential correlation .",
    "this current study rectifies the stratified analyses by fully capitalizing on the hierarchical nature of the influenza data and making formal inference after modeling the complete data in a single bayesian analysis .      despite optimized algorithms for missing data integration [ @xcite ] ,",
    "phylogenetic analysis of dna sequences is lengthy and computationally intensive .",
    "massive data measure in the gigabyte to terabyte range [ @xcite ] and are increasingly common [ @xcite , @xcite ] .",
    "this pervasiveness is particularly poignant in bayesian models with missing data and especially in bayesian models for stochastic processes where the dimensionality of the missing data can far outweigh the observed data .",
    "such is the case in the evolutionary reconstruction of @xcite .    one strategy pertinent to massive data inference is stratification [ @xcite , @xcite ] , often undesirable because it comes shackled with the host of difficulties arising from subgroup analysis [ @xcite , @xcite ] .",
    "this identifies the direction that @xcite originally follow as they treat each of the eight segments independently .",
    "shared computer memory and communication latency between computers limit hopes for considering a proper hierarchical model across segments simultaneously through which to share information and learn about segment - to - segment correlation . even on state - of - the - art equipment",
    ", simulating sufficient realizations from posterior distributions conditional only on the data from a single segment , or what we refer to as `` stratified distributions , '' still compels one to devote weeks of computing time per segment .",
    "this huge computational investment raises a critical point regarding a massive dataset with hierarchical structure .",
    "often researchers perform preliminary analysis stratified by the exchangeable identifiers in the data simply because the statistical tools and computational resources exist for the stratified analysis . in attempting to fit the full hierarchical analysis ,",
    "the ability to reuse the results from these suboptimal analyses represents a major savings in terms of time and resources and may even be the only feasible option .    to this end , we examine the dynamic iteratively reweighting mcmc algorithm ( dyirma ) [ @xcite , @xcite ] .",
    "dyirma is based on the meta - analysis technique of using summary statistics from independent studies to infer a single hierarchical model [ @xcite , @xcite ] . instead of summary statistics",
    ", however , dyirma combines realizations from independent distributions using importance sampling and markov chain monte carlo ( mcmc ) in an iterative process .",
    "importantly , we can adopt dyirma to reuse realizations from preliminary stratified analyses . this desire to not waste intermediate realizations from the stratified analyses",
    "is particularly relevant in our influenza example because the realizations themselves require massive computing resources to generate .",
    "we further extend the insight of @xcite who combine intermediate realizations from two uncorrelated distributions .",
    "our extension is necessary to accommodate correlated sequence data sampled over a span of thirteen years and allows us to entertain a much richer collection of hierarchical models motivated by the science at hand .",
    "our scientific aim in this study is to create a joint hierarchical model that addresses the questions raised by @xcite regarding the evolutionary history of influenza a. to this end , the hierarchical model must account for an unknown correlation structure between segments and allow for a flexible time - course in the model response , for which we exploit gibbs variable selection ( gvs ) [ @xcite , @xcite ] to estimate a nonparametric response . the influenza a example illustrates that dyirma is a particularly flexible and valuable approach that reuses realizations via reweighting from computationally expensive distributions in a hierarchical framework .",
    "this widely applicable technique can be used to jointly model other independently generated , but in truth correlated , massive datasets .    as a preview",
    ", the paper continues as follows : section [ sec : stratified ] describes the generation of realizations from the stratified analyses , section [ sec : sampling ] introduces the basic framework used to estimate genealogies .",
    "section [ sec : recycle ] relates the machinery necessary to combine these realizations to estimate the joint hierarchical model along with computational concerns .",
    "section [ sec : model ] reviews the hierarchical model proposed , prior distributions , mcmc sampling concerns , and various modeling extensions .",
    "sections [ sec : theresults ] and [ sec : discuss ] present results and conclude with a discussion .",
    "rambaut et  al . ( @xcite )",
    "compile aligned sequence data for coding regions of each of the eight segments of the influenza a genome from the influenza genome sequencing project ncbi database [ @xcite ] .",
    "these alignments contain all 687 h3n2 influenza a genomes available over the 12 influenza seasons between 1993 and 2005 .",
    "season 2002 yields no sequences as it was predominantly an h1n1 season . from these data ,",
    "@xcite are most interested in estimating and formally comparing the times to most recent common ancestor ( tmrca ) of all the sequences sampled within each season for each segment .",
    "tmrca can be thought of as a measure of genetic diversity because evolutionarily distant present - day sequences converge to a genealogy with longer branch lengths and consequently a larger tmrca . to keep computation manageable ,",
    "@xcite are forced to partition these data into independent blocks by segment . as the virus evolves through time , samples from different seasons are highly interrelated through their shared history .",
    "standard phylogenetic software packages account for this correlation . on the other hand , joint models across segments",
    "are less developed [ @xcite ] .",
    "consequently , initial analyses consider the segments independently , clouding conclusions about segment  segment interactions important to influenza a evolution .",
    "rambaut s et  al .",
    "( @xcite ) analyses provide samples from the intermediate distributions of tmrcas given sequences from each individual segment .",
    "we are interested in the interaction of the evolutionary dynamics of influenza a segments over time and we use as our starting point realizations from these analyses stratified on segment .",
    "we let @xmath0 be the tmrca for segment @xmath1 and season @xmath2 and @xmath3 the sequence data for segment @xmath1 . from each of the stratified analyses , we tabulate samples @xmath4 or @xmath5 for all @xmath6 where @xmath7 indexes the mcmc sample",
    ", @xmath8 is the total number of mcmc samples , @xmath9 indexes the segment , and @xmath10 indexes the season .",
    "next , let @xmath11 be the matrix constructed from @xmath12 columns @xmath13 or @xmath14 rows @xmath15 , where @xmath13 is an @xmath16 vector with all samples of tmrca at iteration @xmath17 for season @xmath2 and @xmath15 is a @xmath18 vector for segment @xmath1 with all samples of tmrca at iteration @xmath17 for all @xmath12 seasons .",
    "these @xmath8 matrices @xmath11 are the intermediate samples from the stratified distributions provided by @xcite that we propose to recycle into a hierarchical model .",
    "to describe the construction of this stratified distribution , we first introduce some nomenclature . in brief , let @xmath19 be the genealogy composed of a bifurcating acyclic graph ( commonly called a topology ) that describes the relatedness of a set of sequences and a vector of edge weights for the edges in this topology .",
    "edges reflect the passage of time between bifurcation events and are also called branch lengths .",
    "estimates of @xmath20 different tmrca , @xmath21 , embed in @xmath19 because @xmath22 where @xmath23 is a deterministic mapping@xmath24 .",
    "here , @xmath21 represents a @xmath25 vector containing the tmrcas of interest and we use this general vector as the starting point before building up to @xmath26 .    in order to describe @xmath23 , a brief introduction to the coalescent process",
    "is warranted [ @xcite ] . in the isochronous case , there are @xmath27 sequences sampled at the same time @xmath28 where @xmath29 represents the present - day .",
    "formation of a genealogy begins by randomly selecting two lineages at time @xmath30 , @xmath31 where @xmath32 indexes the coalescent event and @xmath33 is the total number of coalescent events .",
    "proceeding back in time , the inter - coalescent time between the @xmath32th and @xmath34th event is @xmath35 where @xmath36 are independent exponential random variables .",
    "let @xmath37 be the set of all @xmath27 taxa ; then the @xmath38 independent intercoalescent intervals yield an estimate @xmath39 , the tmrca of set @xmath37 . since each inter - coalescent interval is distributed as an exponential , the summation is a convolution of exponential distributions [ @xcite ] .",
    "we can estimate @xmath40 for any subset of taxa .",
    "let @xmath41 be a subset of the taxa , @xmath42 represent the first event in this subset which for the isochronous case occurs at @xmath43 , and @xmath44 the last so that @xmath45",
    ". then @xmath46 is calculated similarly by identifying @xmath47 , the subtree formed within @xmath19 from the tips at @xmath28 and proceeding back in time to the last coalescent event occurring at @xmath48 for all taxa in @xmath49 .",
    "we then calculate @xmath50 .",
    "finally , as a nomenclature device , let @xmath51 be the set of all times of coalescent events identified in @xmath49 , @xmath52 , and let @xmath53 be the complement .",
    "then the genealogy can be decomposed into two disjoint sets of coalescent times as @xmath54 , a device that will prove useful in section [ sec : reweigh ] .",
    "one particularly interesting subset @xmath55 arises in the case of heterochronous data , namely @xmath56 or tmrca for all sequences sampled in a given season @xmath2 . because we have influenza a sequences sampled over time , our data are commonly called `` heterochronous . ''",
    "we know the exact date of sampling for the influenza a sequences and can extend the coalescent to reflect this additional information . elaborating on the description of the coalescent process above",
    ", the heterochronous case has two events of interest , coalescent and sampling , both of which can occur at multiple times .",
    "if there are @xmath57 sampling times , there are now a total of @xmath58 intervals , so in the heterochronous case , @xmath59 .",
    "let @xmath60 represent the times of coalescent or sampling events where @xmath28 is the most recent chronological sample and as before , the inter - event intervals are @xmath35 .",
    "for @xmath55 identify the earliest event @xmath42 and the last event @xmath44 and again we have @xmath61 .",
    "we can now fully describe the intermediate realizations available from @xcite . recall that our research goals require we extract estimates of @xmath62 for a specific influenza season @xmath2 where @xmath10 indexes the @xmath12 distinct seasons from a @xmath63 for segment @xmath9 .",
    "we accomplish this by allowing the subset @xmath64 to be the set of all taxa for a given influenza season @xmath2 .",
    "then @xmath65 is the summary statistic of interest for segment @xmath1 and season @xmath2 .",
    "finally , let @xmath66 contain all estimates of tmrca for a given segment and let @xmath67 be all estimates of tmrca for a given year .",
    "refer to figure [ fig : tree ] for a simple example .     and",
    "extends back into the past until @xmath68 or the @xmath69 for all five sequences . inferred ancestral nodes between the samples are represented by circles .",
    "the black circle is the most recent common ancestor for both of the sequences sampled in the 1993 influenza season .",
    "we calculate @xmath70 by isolating the relevant branches , represented here by the purple subtree , and summing the inter - coalescent intervals , @xmath71 .",
    "similarly , the gray circle is the most recent common ancestor of all three sequences sampled in the 1994 influenza season and @xmath72 . ]",
    "although we have outlined how to generate our summary statistics of interest given a genealogy , further description is necessary regarding sampling from the distribution of the unknown genealogy @xmath63 conditional on the data @xmath3 for segment @xmath1 .",
    "this posterior distribution can be represented as @xmath73 where @xmath74 is the likelihood of the sequence data given the genealogy and other phylogenetic parameters @xmath75 that model sequence change over time and @xmath76 , @xmath77 , and @xmath78 are the prior distributions for the genealogy and phylogenetic parameters .",
    "the above decomposition specifies a marginal prior distribution on @xmath63 because @xmath79 .",
    "we take note of this marginal distribution because we wish to ultimately replace @xmath80 by a joint prior distribution @xmath81 in our hierarchical model . from @xcite",
    ", @xmath82 derives from a semiparametric relaxation of the coalescent process parameterized in terms of time - varying effective population size vector @xmath83 that follows a piecewise constant multiple - changepoint - process hyperprior distribution [ drummond et  al .",
    "( @xcite , @xcite ) ] .",
    "effective population size is meant to reflect amount of genetic diversity rather than census count [ @xcite ] and can be thought of as the average number of unique individuals that actually contribute genes to subsequent generations .",
    "investigators generate samples from @xmath84 using mcmc in the bayesian software beast [ drummond et  al .",
    "( @xcite , @xcite ) ] for each segment independently .    due to the prominence the prior distribution @xmath82 plays in the iterative reweighting scheme , it is outlined in some detail as follows , where we drop the subscript @xmath1 for clarity .",
    "recall that @xmath85 are the times of events going into the past and @xmath86 are the inter - coalescent intervals .",
    "let @xmath87 be the number of lineages that exist in @xmath19 during a given inter - coalescent interval .",
    "we want to generate a sequence of effective population sizes of length @xmath88 where @xmath89 indexed by @xmath90 with time similarly partitioned into @xmath91 .",
    "essentially , we want to partition @xmath92 into @xmath88 groups @xmath93 where @xmath94 is constant between @xmath95 and @xmath96 . in the heterochronous case ,",
    "the number of lineages can increase ( for a sampling event ) or decrease ( for a coalescent event ) so there are two events of interest that can change the number of lineages .",
    "these events are distinguished by the indicator function @xmath97 which indicates that @xmath32 is a coalescent event .",
    "@xcite specify the following heterochronous semiparametric coalescent prior distribution ( again , ignoring dependence on @xmath1 for clarity ) : @xmath98 where the function @xmath99 maps from the larger number of @xmath38 events to the @xmath88 groups , or in other words @xmath100 if @xmath30 is between @xmath101 and @xmath96 . finally , to complete the of the prior distribution , the first effective population size follows a scale - invariant prior distribution , @xmath102 [ @xcite ] and the remaining @xmath103 effective population sizes are distributed as exponential with scale parameter equal to the previous effective population size , @xmath104 @xmath105 .",
    "we make no claims about the appropriateness of this prior distribution choice .",
    "however , since the mean and variance of this prior distribution on @xmath106 grow with @xmath107 and lead to some difficulty later , we point out that @xcite provide a stable alternative with the joint skyride prior distribution on @xmath108 .",
    "now we have a foundation for understanding how genealogies are sampled and summarized using @xmath62 and what realizations from the intermediate distributions of the stratified analyses we have available .",
    "we wish to point out the benefits of the hierarchical model whose estimation we describe in the next section .",
    "these benefits include shrinkage estimators , a framework for statistical inference that accounts for correlation between strata , and models based on all available data .",
    "we now delve into how these independently generated estimates are combined into a joint statistical model reusing the preliminary realizations .",
    "in addition to the stratified realizations , the process of reweighting the stratified analysis samples of @xmath109 to generate the joint hierarchical posterior distribution through dyirma requires @xmath82 and the ability to evaluate the marginal prior distribution @xmath110 .",
    "we first present the dyirma machinery and then comment on how we extend it to accommodate this dataset .",
    "we save computational concerns regarding the calculation of @xmath110 for section  [ sec : compute ] .",
    "recall that we employ the following decomposition of genealogy @xmath111 which allows us to relate the summary statistic @xmath109 to @xmath63 as @xmath112 the symbol @xmath113 identifies the stratified analyses and for notational consistency can be viewed as the forthcoming hierarchical model parameters , @xmath114 fixed at an arbitrary value .",
    "the subscript @xmath51 is dropped in the following equations to simplify notation .",
    "we have intermediate realizations of the multivariate vector of @xmath115 under the individual models generated during the initial stratified analysis .",
    "we combine these realizations into a single joint posterior distribution conditional on all of the sequence data , @xmath116 where @xmath117 and @xmath118 , by preferentially weighting samples that have a high likelihood under the hierarchical model relative to the probability of the prior distribution in the individual models .",
    "we make the following assumptions of conditional independence , namely that given @xmath21 the sequence data are independent of the parameters in the hierarchical model , or @xmath119 .",
    "we also assume that given the hierarchical parameters , the tmrcas @xmath109 , which we treat as exchangeable units , are independent or in other words we assume @xmath120 . given these assumptions",
    ", we can then use the following relationship : @xmath121 therefore we reuse all available @xmath8 realizations from @xmath122 by identifying the following importance weights which are calculated for every sample of the stratified distributions : @xmath123 the numerator of the weights , @xmath124 , is the conditional density under the hierarchical model .",
    "these hierarchical parameters are updated during each round of gibbs sampling requiring recalculation of the weights for each iteration .",
    "the proposal density , @xmath125 , is conditional on the parameters in the stratified analyses . as the variance of the estimate in ( [ eq : ira ] ) relies on the proposal density , some thought should be given toward selecting an appropriate prior distribution during individual analysis .",
    "generally it is desirable to have a proposal density with heavier tails than the numerator of the weights [ @xcite ] .    as shown by @xcite and relying on the concept of importance sampling [ @xcite ]",
    ", we can solve for the conditional distribution of the @xmath109 s under the hierarchical model , which is specified as the following : @xmath126 where @xmath127 and @xmath128 is a degenerate distribution at @xmath15 .",
    "the weighted stratified realizations are sampled during each round of gibbs updates to generate samples from the hierarchical posterior distributions of @xmath109 conditional on the current values of the parameters in the hierarchical model , @xmath129 . these samples in turn",
    "are then used to update the parameters in the hierarchical model from @xmath130 to @xmath131 which completes another iteration of sampling and contributes the last remaining piece of machinery necessary to jointly model our intermediate realizations from stratified analyses .",
    "we now describe in detail the strategy we employed to calculate @xmath110 which is necessary for the calculation of weights .",
    "we include this description because for many scientifically interesting choices of the mapping @xmath23 , such as jointly modeling tmrcas , @xmath110 remains intractable in analytic form .",
    "fortunately , standard machinery already exists to draw simulants from this distribution , namely the mcmc sampler exploited to generate the stratified samples .",
    "a single additional run of this sampler without data provides all ingredients necessary to tackle the seemingly computationally intractable joint inference .",
    "each partitioned dataset assumes identical prior distributions so a single simulation of @xmath110 suffices for the reweighting of all the stratified distributions .    two successful approaches to estimating marginal distributions frommcmc samples are multivariate kernel density [ @xcite , @xcite ] and importance weighted marginal density estimation ( iwmde ) [ @xcite ] .",
    "iwmde proceeds by identifying a weighting function and sampling from a weighted ratio of the likelihood at a given value of the marginal of interest ( here @xmath132 ) and realizations of the full joint distribution .",
    "the weighting function ideally has a similar shape to the unknown conditional marginal density , a catch-22 circumvented with multivariate kernel density estimation . as a consequence of the strictly nonnegative support of @xmath109 we control for potential boundary effects during kernel density estimation by using a gamma kernel [ @xcite ] that removes the boundary effect and has the best mean integrated squared error among all nonnegative densities . for computational ease , we select the bandwidth using a multivariate adapted scott s rule - of - thumb in which the bandwidth for the @xmath133th variable , @xmath134 , is @xmath135 [ @xcite ] where @xmath136 is the univariate sample standard deviation and bandwidths are allowed to vary for each univariate kernel resulting in a multiplicative kernel [ @xcite ] .",
    "the importance of selecting an appropriate prior distribution in a bayesian framework is a topic of considerable depth [ @xcite , @xcite ] .",
    "even the less contentious tactic of selecting a noninformative prior distribution by placing a uniform distribution over the parameter space can prove to be subjective [ @xcite , @xcite ] .",
    "in the case where the likelihood function overwhelms the prior distribution , a potentially informative uniform prior distribution is rendered noninformative and specification of the prior distribution is deceptively unimportant .",
    "when @xcite specify a multiple changepoint prior distribution , the effective population sizes , @xmath137 , were further constrained to lie between 0 and 120,000 .",
    "this truncated prior distribution is well outside of the desired range of the values of @xmath109 , a fact that is inconsequential when sampling from the distribution conditional on the data .",
    "however , this creates difficulties for evaluating the prior distribution at the realized values of the distribution conditional on the stratified data as they mostly lie well outside the region of the kernel density estimate .",
    "luckily , when the maximum population size is constrained to be lower than 120,000 and coverage extends to the region of interest the kde of the prior distribution reveals a relatively flat density surface .    .",
    "we want the value of the prior density used during stratified analyses for the intermediate realizations sampled in the range illustrated in gray dot and black line .",
    "we have a kde constructed with coverage from realizations of the prior distribution we generated in the range in black line .",
    "the gray dot region , or the region of interest the kde is forced to extrapolate , expands as the maximum allowable @xmath92 , @xmath138 , increases . the density with",
    "@xmath139120,000 approaches the flat line illustrated with the perhaps more reasonable @xmath140 . ]    as the maximum is gradually increased to 120,000 , this surface decreases in the value of the density but remains relatively flat .",
    "this is illustrated in figure [ fig : kde ] , which shows a representative ( @xmath141 ) prior density predicted by kde conditional on the mean of the other parameters for different maximum allowable @xmath137 sizes along with realizations from the prior distribution .",
    "the range of the values for the realizations from the prior distribution we wish to evaluate are indicated in the lower range of the density and the realizations used to predict the kde are in the upper range . taken together , this indicates the region the kde is forced to extrapolate . as the addition of a constant value on the log scale does not affect the weights , a constant density equivalent to some arbitrary @xmath142 can be selected . for computational ease",
    "it is desirable for @xmath142 to be similar in range to the density under the joint hierarchical model .",
    "our methods enable us to conceive of a model that tests a greater range of hypotheses than those based on a single stratum .",
    "we revisit each of the statements of @xcite aimed at understanding the evolutionary history of influenza a with the advantages afforded by a hierarchical framework .",
    "we construct our model out of three basic elements .",
    "the first modeling element identifies seasons with a significant change in tmrca from the previous year using gvs on the timepoints .",
    "a  significant increase in tmrca between timepoints suggests a reassortment event , whereas a significant decrease suggests a selective sweep .",
    "the second element introduces fixed segment effects that test whether certain segments have a higher tmrca and therefore greater genetic diversity than others across time . finally , we address correlation between the segments by exploring constrained variance matrices . to recycle random samples generated under existing stratified analyses ,",
    "we implement an additional dyirma step during each round of gibbs sampling of the joint model parameters .",
    "we first build up to the biologically motivated mean structure of the model containing gvs and fixed segment effects with an independent variance matrix and then introduce extensions for modeling the variance structure .      at the most basic biological level",
    ", we must identify significant changes in tmrca between influenza seasons and test if these correspond with shifts in ha antigenicity .",
    "we accomplish this with gvs as parameterized by @xcite where the outcomes of the regression are the tmrcas and season effects represent potential predictors . note that this analysis would not be possible using a single segment as there would be insufficient degrees of freedom .",
    "the goal of bayesian stochastic search variable selection is to identify the underlying generative model @xmath143 from the set of all possible models @xmath8 .",
    "if @xmath144 is the total number of possible predictors in the regression model , the model space has dimension @xmath145 , an arduous dimension from which to draw inference .",
    "@xcite bypass this task by introducing indicator variables , @xmath146 , that identify the potential predictors of the outcome variable .",
    "to clarify , if the @xmath2th predictor has a marked effect on the outcome , the posterior probability that the corresponding indicator variable is one , @xmath147 , is high . on the other hand , if the @xmath2th predictor is not critical , the posterior probability that the corresponding indicator variable is zero , @xmath148 , is high .",
    "this implies that estimates of @xmath149 clarify which timepoints correspond to significant changes in tmrca .    in order to proceed , we must introduce some additional nomenclature .",
    "let @xmath150 be the @xmath151 additive design matrix for all seasons where we remove the intercept in order to avoid overparameterization .",
    "in other words , @xmath152 is a row vector where the first @xmath153 entries are 1 and the remaining @xmath154 are 0 s .",
    "then @xmath155 is made of @xmath14 identical rows of @xmath152 and stacking the @xmath12 matrices of @xmath156 generates @xmath150 .",
    "let @xmath157 equal the diagonal matrix @xmath158 and @xmath159 be the unknown season effect sizes .",
    "the flexible gvs - induced mean time - course for mrcas for all segments at season @xmath2 becomes @xmath160 and is identical for all segments @xmath1 .",
    "we select the following conjugate , independent , and noninformative priors distributions : @xmath161 and @xmath162 where @xmath163 , and @xmath164 are hyperprior constants .",
    "estimation of @xmath149 addresses questions about the evolution of influenza data over time and clarify whether shifts in ha antigenicity correlate with significant changes in tmrca .      modeling the segment effect highlights the importance of jointly modeling the influenza genome in concert in order to draw meaningful inference about similarities and differences in their evolutionary histories .",
    "segment effects identify consistent differences in tmrca over time and can test the hypothesis that np has higher genetic diversity than ha .",
    "we also garner indirect information regarding the unresolved physical location of segments within the influenza a genome because we can resolve the correlation between segments and highly correlated segment histories are consistent with close proximity .",
    "multidimensional scaling ( mds ) suggests a relationship with decreasing intensity among the following three groupings : ( 1 ) \\{ha , m1@xmath1652 } , ( 2 ) \\{ns1@xmath1652 , np } , and ( 3 ) \\{pa , pb1 , pb2 } [ @xcite ] .",
    "the na segment is not grouped with any other segments .",
    "let @xmath166 be unknown segment effects .",
    "then we model @xmath167 where in its most general form @xmath168 is assumed to be an @xmath169 unstructured ( uns ) covariance matrix .",
    "conjugate prior distributions for this portion of the model are @xmath170 for all @xmath1 and @xmath171 where @xmath172 , and @xmath173 are hyperprior constants and @xmath174 is the inverse of the hyperprior constant @xmath175 scaling matrix .",
    "when combined with the prior distributions above , drawing realizations from the conditional posterior distributions for @xmath176 , and @xmath157 helps address questions about segment effects , significant timepoints , and segment correlation simultaneously .",
    "we now specify how to draw mcmc samples from the complete model .",
    "let @xmath177 contain the unknown parameters of the hierarchical model , of which we wish to draw inference . recall that we specify the conditional distribution for @xmath109 in ( [ eq : dyirmacond ] ) , which shows how we obtain realizations from @xmath178 by reweighting samples from @xmath179 .",
    "therefore to estimate the parameters from this complete model using gibbs sampling , we use dyirma during each gibbs cycle over @xmath180 .",
    "we have stated the denominator of the weights previously as the predictions from the kde of the stratified prior distributions that do not depend on @xmath114 and hence are constant during mcmc sampling . the numerator is updated at each iteration of mcmc and is simply the density of the vector of tmrcas given the parameters in the hierarchical model , a straightforward way to determine multivariate normal . at this stage",
    "we are replacing the standard coalescent prior distribution with a normal prior distribution , a trade - off that yields straightforward interpretability as it allows us to directly test @xcite hypotheses , in addition to a simple computational implementation . for details on the other update steps for @xmath181 and a schematic of sampling",
    "refer to the supplementary material [ @xcite ] .        to identify segments with similar evolutionary histories , several constraints to @xmath168 may provide more effective estimates .",
    "we explore an independent ( ind ) parameterization , such that @xmath182 , with marginal variance @xmath183 unknown that implies the evolutionary history of segments is not correlated .",
    "this specification allows inference to focus on the segment effects and has the additional advantage of substantially decreasing the number of inferred parameters . also informative",
    "is compound symmetry ( cs ) which gives a general estimate of correlation between segments and provides a model nested within uns to test for similar levels of correlation between segments .",
    "cs implies that the evolutionary histories of all segments are correlated with the same strength .",
    "finally , autoregressive first order ( ar1 ) and tridiagonal ( tri ) structures with an estimable ordering of the segments directly identifies which segments have similar evolutionary histories .",
    "the motivation for nonexchangeable structures relies on the reasoning that segments with similar evolutionary histories have higher correlation than those with dissimilar histories .    for the cs model ,",
    "we modify the gibbs sampling by replacing the step for @xmath168 with a metropolis  hastings step .",
    "let @xmath184 where @xmath185 is the segment correlation and assume prior distributions @xmath186 and @xmath187 where @xmath188 , and @xmath189 are hyperprior constants .",
    "refer to the supplementary material [ @xcite ] for further details on this modification to sampling .",
    "segments are not exchangeable in the tri and ar1 parameterizations of the covariance matrix . in ar1 ,",
    "nearest - neighbor segments in the covariance matrix have higher correlation than those further apart . in tri ,",
    "the structure is more restrictive with segments more than one neighbor away from each other having no correlation . as the ordering of the segments @xmath1 is not known and of paramount scientific interest , we estimate the labeling or ordering of the segments within the covariance matrix by parameterizing a permutation vector @xmath190 where @xmath191 indexes the different possible permutations .",
    "sampling @xmath190 requires an additional metropolis ",
    "hastings step .",
    "we propose @xmath192 by randomly swapping two positions in the current permutation @xmath190 .",
    "we accept this proposal with probability @xmath193 where @xmath194 is @xmath195 assuming all permutations occur with equal probability , the terms @xmath196 and @xmath197 cancel .",
    "we proceed with caution when drawing inference due to label switching [ @xcite ] . instead of focusing inference on the permutation itself , we concentrate on the posterior probability that a given pair of segments are nearest neighbors , suggesting these segments have similar evolutionary histories .",
    "our reasoning is that because only nearest neighbors are correlated , segments with similar evolutionary histories have a high posterior probability of adjacent positions within the permutation vector conditional on the correlation @xmath185 being positive . this model that includes estimation of @xmath190 ( tri - p )",
    "clarifies which evolutionary histories of segments are strongly correlated , which in turn has implications regarding structural interaction .",
    "rambaut et al . ( @xcite ) have run stratified analyses for each of the eight influenza segments .",
    "each analysis required an exhausting 23 weeks on high - end computers to approximate the stratified distributions @xmath84 via mcmc .",
    "each mcmc chain runs for @xmath198 iterations and subsampling every @xmath199 iterations yields @xmath200 approximately independent samples from these stratified distributions .",
    "we recycle these precomputed random samples to fit our hierarchical model that corrects for the stratification using the bayesian machinery described in sections [ sec : genomic ] and  [ sec : recycle ] .",
    "in particular , we implemented the dyirma gibbs sampling scheme in cross - platform java .",
    "we simulate three independent mcmc chains for each hierarchical model for @xmath201 iterations with 10% burn - in and a 10-fold thinning .",
    "each chain takes only approximately five hours to run on a mid - end desktop computer , representing a compelling and efficient alternative to fitting a joint hierarchical model starting from the sequence data .",
    "we assess the combined chains from three independent chains via several convergence criteria including trace plots , histograms , geweke s convergence diagnostic [ @xcite ] , and rhat [ @xcite ] .",
    "table [ tab : tmrca ] presents mean time - course estimates for the across - segments independent ( ind ) and tridiagonal with permutation ( tri - p ) models .",
    "an additional subscript of ind or tri - p clarifies the model for the parameter estimate .",
    "the additive parameterization of the design matrix results in parameter estimates that reflect an increase or decrease from the previous season .",
    "table [ tab : tmrca ] therefore reports both the relative posterior conditional mean of @xmath202 , @xmath203 , that reflects the relative change in tmrca ( from the previous season ) and , what we term , the absolute posterior conditional mean or posterior conditional mean of the segment effect average added to the cumulative posterior mean of @xmath202 , @xmath204 where @xmath205 .",
    "additionally , we report the posterior mean estimates for @xmath149 that reflect the posterior probability that @xmath202 is included in the model .",
    "@ld1.6d2.6d1.2@ & & & + * year * & & & + & & + 1994 & 0.143 & 0.166 & 2.24 + 1995 & 0.113 & 0.110 & 2.35 + 1996 & 0.00667 & 0.00327 & 2.35 + @xmath206 & 0.00115 & 0.0104 & 2.34 + @xmath207 & 0.0748 & -0.0665 & 2.30 + 1999 & 0.0207 & -0.0128 & 2.28 + 2000 & 0.0133 & -0.00605 & 2.27 + 2002 & 0.207 & -0.242 & 2.03 + 2003 & 1.00 & 3.02 & 5.05 + @xmath208 & 0.00852 & 0.00538 & 5.05 + @xmath209 & 1.00 & -3.86 & 1.20 + & & + 1994 & 0.0500 & 0.0568 & 2.11 + 1995 & 0.0356 & 0.0326 & 2.14 + 1996 & 0.00593 & 0.00235 & 2.14 + @xmath206 & 0.00556 & 0.00122 & 2.14 + @xmath207 & 0.00100 & -0.00511 & 2.14 + 1999 & 0.00815 & -0.00346 & 2.13 + 2000 & 0.00852 & -0.00268 & 2.13 + 2002 & 0.0437 & -0.0456 & 2.09 + 2003 & 1.00 & 2.89 & 4.96 + @xmath208 & 0.0159 & 0.0118 & 4.98 + @xmath209 & 1.00 & -3.79 & 1.18 +    looking first at the ind model , an indicator estimate of 1 at season 2003 suggests that there exists a significant difference between the average segment time to mrca , @xmath40 , at influenza season 2002 and that of 2003 because the posterior probability that the inclusion of a regression parameter captures this difference approaches 1 .",
    "this decisive support of a significant jump in @xmath40 suggests an infusion of genetic diversity and is consistent with a _",
    "reassortment event_. similarly , the posterior probability for the indicator representing the shift between seasons 2004 and 2005 also approaches 1 .",
    "however , in this instance , as the negative sign of the estimate for @xmath210 reflects , this suggests a decrease in genetic diversity which is consistent with a _ selective sweep_.    looking more closely at the ind model , the 2003 shift corresponds to an increase in @xmath40 with a posterior mean regression parameter estimate of @xmath211 and 95% bayesian credible interval ( bci ) @xmath212 .",
    "the 2005 shift suggests a @xmath213 @xmath214 decrease in @xmath40 and is concomitant with the fu02-ca04 ha antigenic shift .",
    "no other indicators have posterior probabilities greater than 0.95 .",
    "similarly , the tri - p model furnishes strong support for including seasons 2003 ( @xmath215 ) and 2005 ( @xmath216 ) and shows the similar pattern of jump in @xmath40 of @xmath217 @xmath218 followed by decrease of @xmath219 @xmath220 .",
    "the increase in genetic diversity at season 2003 followed by a decrease at 2005 clearly identify themselves in the third column of table [ tab : tmrca ] that shows that the posterior conditional segment means for the seasons between 1994 and 2002 as around 2 but jumps to nearly 5 in seasons 2003 and 2004 before undergoing a decline in 2005 and decreasing to around 1.2 .",
    "figure [ fig : fitted ] reiterates this finding . in general , the tri - p indicator probabilities are closer to 0 or 1 than in the ind model .",
    "for example , the posterior probability of the season 2002 shift @xmath221 is less than that for the ind model @xmath222 .",
    "one explanation for the differences between the two models is that the parameter estimate standard errors are generally reduced for the tri - p model .    2 , and ns1@xmath1652 ) of h3n2 influenza a listed from largest to smallest .",
    "samples from the hierarchical posterior distributions are from the tridiagonal with permutations ( tri - p ) model .",
    "twelve seasons are depicted with season 2001 missing due to an h1n1 dominant season .",
    "segment distributions are staggered for clarity .",
    "the y - axis represents tmrca and ha antigenicity ( be93 , wu95 , sy97 , fu02 , and ca04 ) is indicated across the top .",
    "hierarchical posterior distributions exhibit shrinkage toward the mean relative to the stratified . ]",
    "there exists a wide number of covariance structures that are biologically interesting to explore within our framework .",
    "specifically , we also consider the unstructured ( uns ) and first order autoregressive with permutation ( ar1-p ) models . although we observe a similar pattern of increase and decrease in tmrca in 2003 and 2005 , these models that allow a high level of correlation between the segments lose identifiability of the indicator variables across time , presumably because the variation present in the observations is used to model the correlation instead of the mean structure .",
    "combined with the fact that inference focuses on the mean structure , we continue to exclusively discuss results for sparse covariance matrices such as those used in the ind and tri - p models .    summarizing the posterior probability of a model that contains",
    "all of the antigenic shifts addresses our question regarding whether ha shifts are concomitant with significant changes in _",
    "t_. antigenic shifts occur at 1997 ( be93-wu95 ) , 1998 ( wu95-sy97 ) , 2004 ( sy97-fu02 ) , and 2005 ( fu02-ca04 ) and these seasons are superscripted in table [ tab : tmrca ] .",
    "we refer to these seasons from now on as shifts 1 , 2 , 3 , and 4 , respectively , and use these shift numbers as subscripts on a given model @xmath8 to clarify which model variables are included . for example",
    ", @xmath223 describes a model where both the first and third antigenic shifts are included @xmath224 and @xmath225 . as we have already noted , the posterior probability that the fu02-ca04 shift in 2005 is included in both the ind and tri - p models approaches 1 .",
    "however , the posterior probability of this being the only antigenic shift selected is also large because @xmath226 and @xmath227 .",
    "the posterior probability of a model with all four antigenic shifts , @xmath228 , approaches zero for both tri - p and ind .",
    "this strongly suggests that ha antigenic shifts are not strictly concomitant with significant changes in tmrca from the previous season after correcting for the correlation structure of the segments .",
    "@xcite are unable to correct for the correlation structure across segments .",
    "given the limited time series data available relative to the number of antigenic shifts , more data would certainly enhance the understanding of the relationship between reassortment events , selective sweeps , and ha antigenic shifts .",
    "310pt@ld1.2d2.9@ & & + & + pb2 & 2.51 & ( 1.30 ,   3.40 ) + pb1 & 2.65 & ( 1.42 ,  3.49 ) + pa & 2.11 & ( 0.888 ,  2.96 ) + @xmath229 & 1.37 & ( 0.161 ,  2.17 ) + @xmath230 & 2.53 & ( 1.30 ,  3.36 ) + na & 2.21 & ( 1.01 ,  3.02 ) + m1@xmath1652 & 1.39 & ( 0.244 ,  2.19 ) + ns1@xmath1652 & 1.78 & ( 0.585 ,  2.62 ) + & + pb2 & 2.35 & ( 1.24 ,  3.17 ) + pb1 & 2.52 & ( 1.29 ,  3.37 ) + pa & 2.08 & ( 1.03 ,  2.91 ) + @xmath229 & 1.54 & ( 0.381 ,  2.47 ) + @xmath230 & 2.46 & ( 1.25 ,  3.28 ) + na & 2.20 & ( 1.04 ,  3.04 ) + m1@xmath1652 & 1.37 & ( 0.168 ,  2.44 ) + ns1@xmath1652 & 1.88 & ( 0.770 ,  2.79 ) +    to more thoroughly unravel the evolutionary history of influenza a , we need to address the relative level of evolutionary diversity between segments . to this end",
    "we include segment - specific effects whose posterior estimates we summarize in table [ tab : fixed ] for both the ind and the tri - p models .",
    "we report both the posterior mean and the 95% bcis with the range of the tri - p intervals generally slightly reduced from the ind , perhaps indicative of the tri - p being a more appropriate covariance structure with which to model the correlated parameters of the different segments .",
    "pb1 returns the highest posterior mean estimates of @xmath40 which at season 1993 for ind is @xmath231 ( 1.30 , 3.40 ) and for tri - p is @xmath232 @xmath233 .",
    "ha and m1@xmath1652 yield the lowest posterior means of @xmath40 which , also given at season 1993 , are @xmath234 @xmath235 and @xmath236 @xmath237 respectively for ind and @xmath238 @xmath239 and @xmath240 @xmath241 respectively for tri - p .",
    "this implies that genetic diversity is maintained longer in pb1 than ha and m1@xmath1652 with the difference between these segments for @xmath40 on the order of an entire year .",
    "we go further than @xcite who simply observe the differences in the @xmath40 of different segments of influenza a by formally testing whether certain segments maintain greater diversity than others .",
    "one relationship of particular interest , explored but not formally tested by @xcite , is the comparison between np and ha , superscripted in table [ tab : fixed ] . when assuming equal prior probability of both outcomes ( 0.5 each ) , the bayes factors ( bf ) of whether the @xmath40 of np is greater than ha are 179 for the ind model and 16.1 for tri - p .",
    "this means that the posterior probability of np being greater than ha in the ind model is 0.994 and 0.941 in the tri - p , providing strong support for the hypothesis that np maintains greater genetic diversity than ha .    finally , we approach teasing out the correlation between segments by estimating the posterior distribution of all possible segment order permutation within the tridiagonal covariance matrix in the tri - p model .",
    "the three groupings of \\{ha , m1@xmath1652 } , \\{np , ns1@xmath1652 } , and \\{pa , pb1 , pb2 } originally posited by @xcite arise from ad hoc multidimensional scaling results . for notational convenience , we now refer to these segments by number and place them in alphabetical order as 1 ( ha ) , 2 ( m1@xmath1652 ) , 3 ( na ) , 4 ( ns1@xmath1652 ) , 5 ( np ) , 6 ( pa ) , 7 ( pb1 ) , and 8 ( pb2 ) .",
    "this notational device means that we refer to a model with both the \\{ha , m1@xmath1652 } and \\{pa , pb1 , pb2 } grouping as @xmath242 .",
    "note that there is no implied ordering of the remaining unlisted segments so that @xmath243 and @xmath244 , say , have some overlapping groupings .",
    "there are seven pairs of neighbors possible in the tridiagonal matrix because the two segments occupying the corners of the diagonal of the covariance matrix are restricted to having a single neighbor and the middle six segments can each have two neighbors .",
    "we are interested specifically in positive correlation between segments as we want to clarify which segments have similar evolutionary histories . with this purview ,",
    "we focus on results conditional on the correlation @xmath185 being greater than 0.2 ; this provision occurs with approximately 0.593 posterior probability , but eases interpretation . in general",
    ", we assume there are two segments @xmath1 and @xmath245 where @xmath246 , and @xmath247 which are selected as neighbors .",
    "we summarize the posterior probability of models in which two segments are neighbors for our subset of interest , @xmath248 , in table [ tab : permute ] .",
    "the posterior probability of the strongly hypothesized \\{ha , m1@xmath1652 } group is very high , @xmath249 .",
    "the posterior probability of the \\{pb1 , pb2 } pairing is also high , @xmath250 .",
    "previously unidentified as a potential pairing is \\{np , pb2 } , @xmath251 as well as \\{np , pa } , @xmath252 which implies that the np segment might be just as strongly aligned with the \\{pa , pb1 , pb2 } grouping as with ns1@xmath1652 because the posterior probability of the \\{np , ns1@xmath1652 } grouping is similar , @xmath253 .",
    "@lcd1.7d1.7d1.3d1.4d1.3ll@ & & & & & & & & + * pb2 * &  & 0.493^\\{78 } & 0.297^\\{68 } & 0.181 & 0.378 & 0.123 & 0.185 & 0.165 + * pb1 * & & & 0.284^\\{67 } & 0.151 & 0.257 & 0.313 & 0.0990 & 0.160 + * pa * & & & & 0.192 & 0.313 & 0.230 & 0.173 & 0.290 + * ha * & & & & & 0.0620 & 0.154 & 0.768@xmath254 & 0.157 + * np * & & & & & & 0.345 & 0.0880 & 0.335@xmath255 + * na * & & & & & & & 0.222 & 0.283 + * m1@xmath2562 * & & & & & & & & 0.304 + * ns1@xmath2562 * & & & & & & & & +    again , we formally test these hypothetical groupings against the null hypothesis that all permutations of the tridiagonal covariance matrix are equally likely and summarize the results in table [ tab : bf ] .",
    "we make these calculations unconditional on the correlation @xmath185 .",
    "notice in column 2 of table [ tab : bf ] , the posterior probability of grouping \\{ha , m1@xmath1652 } is 0.624 and has a prior probability of 0.0357 leading to a significant bf of 17.5 .",
    "again , \\{np , ns1@xmath1652 } has a weaker bf of 8.50 lending some doubt to the hypothesis that these two segments have similar evolutionary histories .",
    "finally , the posterior probability that all three pairings are found is 0.0741 which , given all models are thought a priori to have equal probability , has a prior probability of 0.000600 .",
    "this leads to a very decisive bf of 124 which strongly supports rambaut s et  al .",
    "( @xcite ) hypothesized groupings of segments .",
    "@ld2.4d1.4d2.4d3.6@ & & & & + posterior odds & 0.624 & 0.304 & 0.195 & 0.0741 + prior odds & 0.0357 & 0.0357 & 0.0179 & 0.000600 + bayes factor & 17.5 & 8.50 & 10.9 & 124 +        we have already demonstrated the ease with which bf can be assigned to competing joint hierarchical analysis models once we have recycled the realizations from stratified analyses into a single statistical framework . however , an additional advantage is that this hierarchical posterior distribution demonstrates shrinkage toward the mean when compared against the stratified results , leading to more sensible segment - specific estimates .",
    "figure [ fig : fitted ] displays the marginal hierarchical posterior distributions superimposed on the stratified results for all eight segments over time . in figure",
    "[ fig : fitted ] we demonstrate that overall the direction of shrinkage estimates from the stratified mean ( black ) to the hierarchical mean ( color ) draws toward the grand mean for that time .",
    "shrinkage toward the mean especially tempers outliers , a phenomenon illustrated in figure [ fig : box ] . focusing on 1993 ,",
    "this season emits positive outliers in pb1 and na .",
    "season 1997 has positive outliers in pb2 and pb1 and 2004 yields a negative outlier in ha and a positive outlier in np . in 1993 ,",
    "coverage drastically shifts down for pb1 and na as well as shifts up for m1@xmath1652 and ns1@xmath1652 . in season 1997",
    ", coverage greatly decreases and shifts downward for the outlier pb2 and in season 2004 , coverage shifts up for ha and shifts down for np .",
    "figure [ fig : fitted ] also illustrates further advantages of this technique , including the reduced credible intervals for the hierarchical distribution relative to the stratified . finally ,",
    "especially apparent in this figure is a cautionary reminder of the wide variability present in the inappropriately independent , stratified results .",
    "for example in 1993 , the stratified estimate uncertainty of pb1 spans around 3 years whereas that for pb2 spans around 0.5 .",
    "these differences in variability mitigate when basing conclusions on the point estimates of the stratified results .",
    "therefore the advantages of reusing the stratified analyses in a joint model lie not only in the ability to assign across - segment bfs and the incorporation of highly desirable shrinkage estimators that lead to improved estimation [ @xcite ] , but also in enhanced modeling capabilities that more accurately represent the variability in the segments .",
    "increasing dataset sizes are engulfing the scientific community [ @xcite ] demanding novel approaches to statistical analysis . while the introduction of gpu programming to the statistical community promises solutions in the near - future [ @xcite ] , the daunting task of analyzing these massive datasets is currently made realistic by partitioning them into smaller , more tractable sizes .",
    "this stratification , while facilitating fast estimation , results in overparameterization and ignores the correlation between parameters across strata . additionally , stratification fails to profit from the massive amounts of data available because parameters are estimated from siloed strata , removed from the implicit context that motivated the initial data collection .",
    "ideally , given no computational constraints , related and exchangeable groups are represented by a hierarchical model .",
    "this framework efficiently pools information across groups while accounting for the correlation between them .",
    "this single unified model also makes it easy to draw dataset - wide inference . finally , hierarchical models lead to improved estimators due to shrinkage toward the mean ; this well - known phenomenon is termed stein s paradox [ @xcite ] .",
    "perhaps a more familiar approach to constructing this full hierarchical model is sequential monte carlo ( smc ) [ @xcite ] .",
    "@xcite , @xcite , and @xcite use particle filtering as a smc solution to the massive data problem , building up the posterior distribution of the complete data by incrementally introducing a small number of data into the posterior distribution using importance sampling [ @xcite ] .",
    "this form of smc is highly effective for linearly organized data such as time series observations but is inappropriate for data divided into exchangeable groups .",
    "further , particle filters do not completely recycle the preliminary analyses .    our methods in this paper",
    "create a new strategy , combining the advantages of stratification , namely speed , with the statistical framework of hierarchical modeling .",
    "any hypothesis addressed in the subpar stratified model can be reused , benefiting from assigned measures of statistical certainty .",
    "our methods capitalize on the intermediate realizations from stratified analyses , recycling them into the hierarchical model by reweighting via importance sampling . from the standpoint of the evolutionary history of influenza",
    "a , @xcite are ambitious in their goal of understanding individual segments within the larger context of the complete genome .",
    "our methods enable us to revisit @xcite s conclusions with the insight afforded by a hierarchical statistical framework .",
    "we find that for these data , the tri - p model is quite sufficient for our re - examination of the biological questions .",
    "however , in some circumstances it may be necessary to allow for some small degree of correlation between segments that are not nearest neighbors .",
    "one way to accommodate this correlation is by assigning a prior inverse - wishart distribution to @xmath168 .",
    "our approach is to center the inverse - wishart distribution on the structured covariance matrix [ as in @xcite ] .",
    "the degrees of freedom of the inverse - wishart provide a tuning parameter .",
    "as the degrees of freedom go to infinity the extra correlation goes to zero and we recover our original model .",
    "the use of this model requires that we replace the gibbs sampling step for @xmath168 with a metropolis ",
    "hastings step , and so adds some computational burden .",
    "the applications of reusing , recycling , and reweighting are limited only by the biological questions of interest .",
    "this flexible framework has far - reaching value into areas such as resequencing and phylogeography [ @xcite ] , in other words , situations where computational complexity forces data partitioning , preventing the more appropriate hierarchical model . from an applied statistician s perspective , this technique delivers a much needed strategy for analyzing massive datasets .",
    "we are thankful to robert weiss for modeling discussion and suggestions and to eddie holmes and andrew rambaut for generously providing the results from their analyses and feedback .",
    "interested readers may request the source - code for this project from j. a. tom .",
    "allison , d. b. , visscher , p. m. , rosa , g. j. m. and amos , c. i. ( 2009 ) . statistical genetics and statistical genomics : where biology , epistemology , statistics , and computation collide .",
    "statist . data anal . _ * 53 * 15311534 .    anderson , c. ( 2008 ) .",
    "the end of theory : the data deluge makes the scientific method obsolete .",
    "_ wired _ * 16*. available at http://wired.com/science/discoveries/magazine/16-07/pb_theory[http://wired.com/science/discoveries/magazine/]http://wired.com/science/discoveries/magazine/16-07/pb_theory[16-07/pb_theory ] .",
    "boscardin , w. j. and zhang , x. ( 2004 ) . modeling the covariance and correlation matrix of repeated measures . in _ applied bayesian modeling and causal inference from incomplete data perspectives _",
    "( a. gelman , ed . ) 215226 .",
    "wiley , chichester .",
    "cressie , n. , olsen , a. and cook , d. ( 1997 ) .",
    "massive data sets : problems and possibilities , with application to environmental monitoring . in _",
    "massive data sets : proceedings of a workshop _ 115119 . national academy press , washington , dc .",
    "doucet , a. , de  freitas , n. and gordon , n. ( 2001 ) .",
    "an introduction to sequential monte carlo methods . in _",
    "sequential monte carlo methods in practice _ ( a. doucet , n. de  freitas and n. gordon , eds . ) 313 .",
    "springer , new york .",
    "drummond , a. j. , nicholls , g. k. , rodrigo , a. g. and solomon , w. ( 2002 ) .",
    "estimating mutation parameters , population history and genealogy simultaneously from temporally spaced sequence data .",
    "_ genetics _ * 161 * 13071320 .",
    "geweke , j. ( 1992 ) . evaluating the accuracy of sampling - based approaches to calculating posterior moments . in _",
    "bayesian statistics , vol . 4 _ ( j. m. bernado , j. o. berger , a. p. dawid and a. f. m. smith , eds .",
    ") 169193 .",
    "oxford univ . press , new york .",
    "ghedin , e. , sengamalay , n. a. , shumway , m. , zaborsky , j. , feldblyum , t. , subbu , v. , spiro , d. j. , sitz , j. , koo , h. , bolotov , p. , dernovoy , d. , tatusova , t. , bao , y. , st george , k. , taylor , j. , lipman , d. j. , fraser , c. m. , taubenberger , j. k. and salzberg , s. l. ( 2005 ) .",
    "large - scale sequencing of human influenza reveals the dynamic nature of viral genome evolution .",
    "_ nature _ * 427 * 11621166 .",
    "holmes , e. c. , ghedin , e. , miller , n. , taylor , j. , bao , y. , st george , k. , grenfell , b. t. , salzberg , s. l. , fraser , c. m. , lipman , d. j. and taubenberger , j. k. ( 2005 ) .",
    "whole - genome analysis of human influenza a virus reveals multiple persistent lineages and reassortment among recent h3n2 viruses . _ plos biology _ * 3 * 15791589 .",
    "lambert , d. ( 2003 ) .",
    "what use is statistics for massive data ? in _ lecture notes ",
    "monograph series , crossing boundaries : statistical essays in honor of jack hall _ ( j. e. kolassa and d. oakes , eds . ) 217228 .",
    "ims , beachwood , oh .      liang , l. j. , weiss , r. e. , redelings , b. and suchard , m. a. ( 2009 ) .",
    "improving phylogenetic analyses by incorporating additional information from genetic sequence databases .",
    "_ bioinformatics _ * 25 * 25302536 .",
    "rubin , d. b. ( 1988 ) . using the sir algorithm to simulate posterior distributions . in _",
    "bayesian statistics 3 _ ( j. m. bernardo , m. h. degroot , d. v. lindley and a. f. m. smith , eds . ) 395402 .",
    "oxford univ . press .",
    "smith , g. j. d. , vijaykrishna , d. , bahl , j. , lycett , s. j. , worobey , m. , pybus , o. g. , ma , s. k. , cheung , c. l. , raghwani , j. , bhatt , s. , peiris , j. s. m. , guan , y. and rambaut , a. ( 2009 ) .",
    "origins and evolutionary genomics of the 2009 swine - origin h1n1 influenza a epidemic .",
    "_ nature _ * 459 * 11221125 .",
    "suchard , m. a. , wang , q. , chan , c. , frelinger , j. , cron , a. and west , m. ( 2010 ) .",
    "understanding gpu programming for statistical computation : studies in massively parallel massive mixtures . _",
    "j. comput . graph .",
    "_ * 19 * 419438 .",
    "tom , j. a. , sinsheimer , j. s. and suchard , m. a. ( 2010 ) .",
    "supplement to `` reuse , recycle , reweigh : combating influenza through efficient sequential bayesian computation for massive data . ''",
    "doi : http://dx.doi.org/10.1214/10-aoas349supp[10.1214/10-aoas349supp ] .",
    "warn , d. e. , thompson , s. g. and spiegelhalter , d. j. ( 2002 ) .",
    "bayesian random effects meta - analysis of trials with binary outcomes : methods for the absolute risk difference and relative risk scales .",
    "_ * 21 * 16011623 ."
  ],
  "abstract_text": [
    "<S> massive datasets in the gigabyte and terabyte range combined with the availability of increasingly sophisticated statistical tools yield analyses at the boundary of what is computationally feasible . compromising in the face of this computational burden by partitioning the dataset into more tractable sizes results in stratified analyses , removed from the context that justified the initial data collection . in a bayesian framework , these stratified analyses generate intermediate realizations , often compared using point estimates that fail to account for the variability within and correlation between the distributions these realizations approximate . </S>",
    "<S> however , although the initial concession to stratify generally precludes the more sensible analysis using a single joint hierarchical model , we can circumvent this outcome and capitalize on the intermediate realizations by extending the dynamic iterative reweighting mcmc algorithm . in doing so , we reuse the available realizations by reweighting them with importance weights , recycling them into a now tractable joint hierarchical model . </S>",
    "<S> we apply this technique to intermediate realizations generated from stratified analyses of 687 influenza a genomes spanning 13 years allowing us to revisit hypotheses regarding the evolutionary history of influenza within a hierarchical statistical framework .    ,    . </S>"
  ]
}