{
  "article_text": [
    "building on impressive progress in control @xcite , measurement @xcite , and coherence @xcite , experimental quantum information science is addressing increasingly complex challenges , such as quantum error correction ( qec ) @xcite and quantum simulation @xcite .",
    "these applications frequently call for measurements of multi - qubit properties , which can be qualitatively different from one - qubit measurements .",
    "crucially , measurements of correlations , rather than complete state information , require a more refined concept of non - demolition .",
    "strong single - qubit measurements project the system into a one - dimensional and trivial subspace , and non - demolition is guaranteed if repeated measurements agree .",
    "this is only a necessary , but not sufficient , condition for measurements of correlations , which must project the system into a multi - dimensional subspace while maintaining coherence within that subspace ",
    "an idea with no one - qubit analog .",
    "these measurements must be accomplished such that we learn only the desired information and no more .",
    "great care is required to engineer this intricate interaction of a complex and delicate quantum system with the noisy and dissipative outside world .    in principle , these measurements can be constructed from a set of primitives consisting of one - qubit measurements and a universal set of one- and two - qubit gates . in practice ,",
    "building up these circuits is not as simple as stringing these primitives together ; decoherence and residual interactions play an increasingly important role .",
    "residual interactions are of particular concern as they lead to correlated and coherent errors , can scale badly as additional qubits are added , and are potentially catastrophic for quantum error correction @xcite .",
    "these challenges raise two questions : how do we design hardware and software to directly implement multi - qubit measurements while addressing these concerns , and how do we reasonably characterize these measurements given different requirements ?",
    "non - demolition multi - qubit measurements have been implemented in a variety of architectures .",
    "impressively , measurements of three- and four - qubit properties have been demonstrated in superconducting and ionic systems @xcite .",
    "quantification of these measurements has generally consisted of measurements of simple eigenstates of the intended measurement operator .",
    "characterization of a multi - qubit measurement process , including the back - action , has been reported for @xmath0 measurements in two - qubit systems , via conditioned process tomography in superconducting qubits experiments @xcite .",
    "generally , the precise implementation of measurements within larger quantum systems is an important direction for further study .",
    "superconducting qubits , our chosen platform , have strong electromagnetic interactions which lead to fast and high - fidelity control and single - qubit measurement .",
    "however , without care in engineering their environment , these same interactions can make these qubits vulnerable to crosstalk and decoherence @xcite . among other adverse effects , this crosstalk is also likely to pollute measurements ( and through back - action , the system ) with extraneous information .    with these issues in mind ,",
    "in this work we demonstrate a novel 3d cqed architecture which exhibits direct qubit - qubit couplings significantly smaller than the qubit linewidths .",
    "instead , interactions among our highly coherent and simple qubits are mediated by a common superconducting cavity .",
    "we use these interactions to engineer measurements of multi - qubit properties via an ancilla qubit , adapting a proposal by nigg and girvin @xcite .",
    "we demonstrate this protocol with a 3 + 1 qubit system by performing all seven non - trivial three - qubit subset - parity measurements , @xmath1 , excluding @xmath2 .",
    "this set is of particular interest : when combined with single - qubit rotations , it generates the measurements of all possible product operators , which include those needed for stabilizer - based quantum error correction @xcite .",
    "no single number fully characterizes a measurement , and the need for more sophisticated assessment is amplified for larger systems as they admit richer phenomena .",
    "accordingly , we characterize each demonstrated measurement with three experiments and discuss several figures of merit . first , we perform an analysis similar to the measurement of computational states and report the assignment fidelity .",
    "second , we introduce and employ a novel form of quantum detector tomography @xcite to fully extract the positive operator valued measure ( povm ) @xcite that describes the realized detector .",
    "we do several analyses based on these results , introducing two fidelity measures and a complementary measure we call the specificity .",
    "third , we consider the back - action induced by the measurement and reconstruct the measurement process maps using conditioned process tomography .",
    "we further introduce two analogous fidelity measures for the measurement process .",
    "additionally , many error mechanisms , such as relaxation , leave a distinctive signature , and we also report results heralded by an additional measurement confirming success .",
    "this may prove to be a useful feature , as heralded - success gates can be efficiently used for universal quantum computation @xcite .",
    "our system is centered around a high - q superconducting cavity ( hereafter the  cavity \" and with resonance frequency @xmath3 ) , which is used mechanically as the isolating package for our module and quantum - mechanically as an ancillary pointer state .",
    "four 3d transmons ( with @xmath4 transition frequencies @xmath5 ) couple to this cavity , with qubit - cavity dispersive interaction rates @xmath6 and qubit - qubit longitudinal interaction rates @xmath7 . the simplified undriven hamiltonian is given by     the experimental sample consists of a central @xmath8 stub resonator @xcite , machined out of 6061 aluminum , with a lifetime of 72 @xmath9s , consistent with our expectation of the limitation due to surface losses .",
    "four sapphire chips enter the cavity radially , each of which supports a 3d transmon and a quasi - planar coaxial @xmath10 resonator @xcite , patterned in the same lithographic step .",
    "all four @xmath10 resonators have undercoupled input ports for fast individual qubit control .",
    "one resonator has a low - q ( @xmath11 ) output port which leads to a josephson parametric converter @xcite .",
    "this enables high - fidelity ( @xmath12 ) readout of the directly coupled qubit , which we designate as the ancilla .",
    "the other three qubits are designated as the register , and their associated three resonators are unused . all qubits share essentially identical capacitive geometry , but differing josephson energies space the qubits by roughly 400 mhz .",
    "this results in dispersive shifts @xmath13 mhz and @xmath14 generally on the order of 1 khz .",
    "further hamiltonian and coherence details are in the supplement .",
    "the cavity has an undercoupled input port , used for conditional and unconditional displacements , and a diagnostic output ( which is also undercoupled and is not depicted ) .",
    "( a ) and ( b ) depict top- and side - view schematics , respectively . not to scale .",
    "( c ) false color top - view of the physical device with outlines for clarity .",
    ", width=326 ]        @xmath15    where we truncate the bosonic modes of the transmons to the two lowest energy levels .",
    "a more comprehensive hamiltonian is given in the supplement .",
    "our device , depicted and described in fig .",
    "[ fig:2d_cartoon ] , provides simultaneously strong qubit - cavity interactions and weak qubit - qubit interactions with @xmath16 .",
    "this architecture also admits independent drive and readout channels , leading to minimal classical cross - talk in both control and measurement . in this work",
    "we utilize the readout channel ( hereafter the  readout resonator \" ) of only one qubit which serves as the ancilla .",
    "the other three qubits we collectively refer to as the register .",
    "our protocol uses the qubit - cavity interactions to map a property of the register state ( e.g. @xmath17 or @xmath18 ) onto the ancilla via manipulation of the cavity state .    in the following ,",
    "we provide a general overview of our three - step protocol . for more details",
    "[ fig : ziz_msmt ] .",
    "first , the cavity mode is displaced from the vacuum .",
    "it then acquires phase conditionally on the qubit states due to the dispersive interaction .",
    "this evolution is qualitatively akin to a continuous and parallel cphase interaction .",
    "as the cavity accumulates phase , we build the measurement operator qubit - by - qubit by using pairs of @xmath19 gates , analogous to a hahn echo .",
    "if we want an @xmath20 in the measurement operator for a given qubit , i.e. not measuring it , we can perform a  full echo \" decoupling sequence and completely average out the phase contribution of a particular qubit unconditionally ( qubit 2 in fig .",
    "[ fig : ziz_msmt ] ) . on the other hand ,",
    "if we want a @xmath21 in the measurement operator for a given qubit , then we want it to contribute a specific conditional phase angle to the cavity state .",
    "we may either allow the natural dispersive evolution to achieve this target conditional phase ( qubit 1 in fig .",
    "[ fig : ziz_msmt ] ) or precisely tune this contribution by applying a `` partial echo '' sequence ( qubit 3 in fig .",
    "[ fig : ziz_msmt ] ) .    in that manner , measuring a qubit , or not , can be chosen by the timing of echoing gates .",
    "when all of the register qubits being measured give equal phase contributions , the phase of the cavity is a natural meter for the number of excitations in the measured subspace .",
    "this equalization can be considered as a stroboscopic erasure of which - path information , resulting in entanglement between a selected multi - qubit property of the register and the phase of the cavity .",
    "the meter can go beyond excitation counting to map other operators ; for example , if the accumulated phase per qubit is @xmath22 , the cavity state measures register parity regardless of the size of the register .    in the second step ( fig .",
    "[ fig : ziz_msmt]b ) , the ancilla qubit samples whether or not the cavity has acquired some chosen phase .",
    "an unselective displacement shifts one of the cavity states to the vacuum , converting phase information into photon number - state information .",
    "a spectrally narrow pulse then excites the ancilla if and only if there are zero photons in the cavity .",
    "these first two steps are a natural multi - qubit extension of the ideas used in the qcmap gate @xcite . with the chosen property of the register now imprinted onto the ancilla state",
    ", we could measure the ancilla directly , but if we hope for the measurement to be non - destructive we must first disentangle the cavity . in the last step ( fig .",
    "[ fig : ziz_msmt]c ) , we remove this residual entanglement , unconditionally resetting the cavity to the vacuum , by essentially inverting ( or  echoing \" ) the unitary dynamics of the first step .",
    "finally , we use this composite gate to enact a multi - qubit measurement by interrogating the readout cavity , which is sensitive only to the ancilla state .",
    "we optionally append an additional manipulation and measurement to verify that the cavity has been reset to the vacuum ( fig .",
    "[ fig : ziz_msmt]d ) .",
    "this condition is not achieved when we have experienced errors due to qubit or cavity relaxation , as well as certain effects from higher order terms in the hamiltonian .",
    "with these measurements manufactured , we turn to the problem of describing them quantitatively . this endeavor does not have a one - size - fits - all resolution : different applications have differing needs , requiring experiments and analyses of differing complexity .",
    "accordingly , we attempt to anticipate many potential desiderata , and perform several analyses on the results of three separate experiments .",
    "the first two experiments examine the detector alone , neglecting back - action on the input state , and the third goes on to examine the measurement process entirely .",
    "the first and simplest analysis provides a partial characterization of the detector .    1 .",
    "assignment fidelity : how much desired information are we getting ?",
    "we expand on this with a full characterization of the detector and extract several figures of merit .    1 .",
    "quantum detector tomography : what is the povm that describes our detector",
    "? what are we actually learning ? 2 .",
    "specificity : what is the maximal measurement contrast along _ any _ axis ? and a complementary question : how close is this maximal axis to the desired axis ? 3 .",
    "detector fidelity : how close is our povm to the desired measurement ?",
    "we additionally may care a great deal about the back - action of the measurement , a consideration crucial for stabilizer - based qec .",
    "for this , we perform a third experiment to characterize the measurement process and extract pertinent figures of merit based on the quantum instrument formalism @xcite .",
    "1 .   measurement process tomography : what makes the detector click _ and _ what happens to the state after measurement",
    "quantum instrument fidelity : how close are the measurement processes , inclusive of back - action , to the desired measurement ?",
    "as the quantum instrument encompasses the detector , a discrepancy between the quantum instrument and detector fidelities provides an assessment of the undesired back - action on the system .    in order to extract the detector and quantum instrument fidelities",
    ", we describe our measurements as channels that introduce the detector as a classical state in an additional hilbert space .",
    "we provide more details on this interpretation as these quantities are introduced .",
    "this treatment allows us to appropriate commonly - used figures of merit for quantum processes and apply them to measurements .",
    "following the reasoning in gilchrist et al .",
    "@xcite , for each analysis we report the two sets of measures : first , the _ j - fidelity _ , which is derived directly from the channel jamiokowski matrix , and second , the _ s - fidelity _ , which is a conservative measure based on the worst - case input state . the j - fidelities are similar to measures given in @xcite .",
    "we provide the ranges for all of these results in the main text and tables of the full results in the supplement .",
    "in addition to the fidelities , we also provide the analogous j- and s - distances , the latter of which is commonly called the diamond distance @xcite .      a simple way to define",
    "the performance of a binary measurement is to assume the model , i.e. how sensitive is our measurement to the desired quantity ( e.g. @xmath23 ) ? to answer this , we prepare states of known ideal measurement outcome , measure , and fit to find the correlation between the state preparation and experimental outcomes .",
    "this yields a contrast and an offset , which can also be interpreted to tell how often we get the expected result . as an example , for a simple @xmath21 measurement of a qubit , it is common to prepare the computational ( @xmath24 and @xmath25 ) states and to report how often the measurement outcomes agree with the state preparation .",
    "this is often referred to as assignment fidelity .",
    "the extension to multi - qubit subset - parity measurements typically involves preparations of @xmath26 computational states , e.g. @xcite .",
    "we show the results for our measurements with a similar but slightly more illustrative experiment in fig .",
    "[ fig : trirabi ] .",
    "we prepare a larger number of states than required , but the result is essentially the same as we fit the data to our expected correlation .",
    "we find contrasts well over @xmath27 for most of our measurements , and in some cases approach the limit set by our ancilla readout , showing that our detectors are highly sensitive to the operator we expected .",
    "assignment fidelity is a useful diagnostic tool as it is quickly measured and has a simple interpretation , however it provides limited information . as an exaggerated example , if you expected a @xmath21-sensitive detector , this present analysis would give identical results if used to examine either a random number generator or a perfect @xmath19-sensitive detector .",
    "errors like the latter , if undiscovered , would result in misleading , skewed state estimation , but are correctable with unitary control",
    ". a simple noisy reduction of contrast has neither of these properties .",
    "demonstration of parity measurement outcomes .",
    "for all seven non - trivial three - qubit subset parity operators we show ancilla excitation probabilities as a function of initial register state . in each subfigure",
    "the three axes specify the initial state of each register qubit , parameterized by rotation angle about the @xmath19 axis after initialization in the ground state .",
    "we depict three plane - cuts through that parameter space .",
    "the color scale indicates the probability to find the ancilla in the excited state .",
    "the top figure ( a ) shows measurement operator zzz .",
    "the second row ( b)-(d ) shows two - qubit parity measurements .",
    "it is easily seen that the outcome is independent of the preparation of one qubit .",
    "the third row ( e)-(g ) shows single - qubit measurements , reflecting sensitivity to only one preparation axis .",
    "we extract assignment fidelities from these data of @xmath28 that improve to @xmath29 with post - selection on a success herald .",
    ", width=326 ]      more generally we may ask of a binary - outcome detector : for what inputs does it `` click ? '' in quantum mechanics we describe these detector - outcome probability distributions with the povm formalism .",
    "the measurement is represented as a set of operators @xmath30 with the probability of measurement outcome @xmath31 equal to @xmath32 $ ] given an input state @xmath33 .",
    "as povms are complete , we may fully describe a binary povm with one operator , @xmath34 .    to characterize the detector more rigorously ,",
    "we prepare a complete or over - complete set of known input states and record the measurement outcome distribution , or  click \" probability .",
    "we reconstruct @xmath35 from these data with a linear inversion .",
    "this procedure is called quantum detector tomography @xcite .",
    "it is essentially identical to traditional state tomography , differing only in the prior assumptions : rather than assuming we know the measurement operator , as we do in state tomography , we assume knowledge of the input state . this knowledge is imperfect , but we note that our ground state preparation is better than @xmath36 , and our one - qubit gate errors are less than @xmath37 as determined from randomized benchmarking @xcite .",
    "our implementation of detector tomography is the first that we know of outside of photonic experiments for system dimensions greater than two , and the first we know of at all in superconducting systems .",
    "we also note that a weaker , diagonal form of detector tomography that assumes sensitivity only to @xmath20 and @xmath21 correlations , akin to our assignment fidelity analysis , is often implicitly used to correct for measurement errors in state tomography @xcite .",
    "for the seven demonstrated measurements @xmath38 , @xmath18 , @xmath23 , @xmath39 , @xmath40 , @xmath41 , @xmath42 we reconstruct the relevant measurement operators , which are ideally projectors onto a subspace of definite measurement outcome .",
    "several examples are shown in fig .",
    "[ fig : povms ] , and we see that the results are close to the expected operators",
    ". we can also distill this full measurement operator into more easily interpretable figures of merit .",
    "what is the maximum information our measurement gains about _ any _ quantity ? or from another point of view : is our detector infidelity due to noise and simple lack of contrast , or is it because our detector is measuring the wrong quantity ?",
    "furthermore , is our detector biased  given a completely mixed input state , is one measurement outcome more likely than another ?",
    "this analysis is general to all strong binary measurements , but here we assume for simplicity that the ideal measurement is of a target pauli operator , @xmath43 .",
    "we express @xmath35 in the pauli basis ( which fully spans the space of @xmath44-qubit observables ) as in fig .",
    "[ fig : povms ] , leading to a vector of pauli coefficients .",
    "one dimension will correspond to the identity axis , one to the desired operator , and the rest to the various other pauli operators .",
    "we can then find a new basis which rotates this vector space , leaving the identity and @xmath43 axes invariant , such that only one other non - zero coefficient in the measurement vector remains .",
    "this additional coefficient @xmath45 corresponds to an orthogonal rotated pauli @xmath46 ,    @xmath47    the coefficients of this expansion are easily interpreted : a deviation of @xmath48 from the ideal value of @xmath49 describes the bias of the detector , @xmath50 represents the maximum possible gain of information about the quantity we wish to measure , and @xmath51 represents the magnitude of the potential _ undesired _ information gain . note that @xmath35 must be a positive matrix , which yields constraints on @xmath52 and @xmath53 relative to the bias term @xmath48 , e.g. a detector that always clicks can not yield useful information .",
    "the infidelity corresponding to measuring along the wrong axis can be considered as analogous to coherent errors for standard processes , since a unitary rotation of the system prior to measurement would remove it .",
    "this formulation leads naturally to a description in terms of angles between vectors , and we can quantify how well we are measuring along the correct axis with an angle for the `` specificity '' of the measurement , @xmath54 .",
    "we find our measurements to be within @xmath55 of the target operator , indicating that our measurements are not yielding significant information about unwanted quantities .",
    "in addition , we see that our detectors have very little bias .    returning to the initial question of maximal information gain",
    ", we recast eq .",
    "[ eq : povm_specificity ] as @xmath56 where the operator @xmath57 is defined as the axis where the measurement gains the most information .",
    "the coefficient @xmath58 directly quantifies the total information gain along this axis .",
    "as might be expected from our small @xmath59 , we find @xmath60 for our measurements .",
    "generally , how similar are two detectors ?",
    "we extend this standard povm formalism by describing the detector as a quantum channel @xcite .",
    "this detector channel takes a quantum state of the register @xmath61 as input and yields a diagonal density operator @xmath62 with entries that represent the detector outcome probabilities ,    @xmath63 { \\left|i\\right>\\left < i\\right|}_d.\\ ] ]    the output state of the detector @xmath62 is represented as a density operator but should be understood as a container for a purely classical probability distribution .",
    "it represents the recorded measurement outcome , _ not _ the state of our physical ancilla transmon .",
    "the detector channel @xmath64 is a completely - positive trace - preserving map which can be described with non - square kraus operators .",
    "the channels relevant to the present experiment act on an eight - dimensional ( three - qubit ) register and yield a two - dimensional ( binary - outcome ) classical detector state .",
    "we compare the experimental detector channels to the ideal processes with two figures of merit .",
    "we start with the j - fidelity ,    @xmath65    where @xmath66 is the jamiokowski matrix representing the process @xmath67 and @xmath68 . for our measurements",
    ", we calculate detector j - fidelities between @xmath69 , which improve to @xmath70 with post - selection on the success herald . this error detection is efficient as the fraction of experiments discarded is similar to the improvement in fidelity .",
    "these measurements approach the limit set by our ancilla readout , @xmath12 .",
    "the detector j - fidelity can be similar to assignment fidelity , but is more general .",
    "it is applicable to measurements with more than two outcomes and allows for comparison of less than full - contrast operators .",
    "unlike some comparable figures of merit , detector j - fidelity does not require renormalization of the povm operators , which may discard information .    for standard non - measurement processes ,",
    "the worst - case performance is often more important than the j - fidelity , and accordingly we also report the s - fidelity @xcite .",
    "this measure provides a conservative bound on the detector performance , including any possible degradation when the measurement is applied to a subspace within a larger , entangled quantum system . this s - fidelity applied to the detector process",
    "is given by    @xmath71    where @xmath72 represents a joint pure state @xmath73 of the register and an ancillary , potentially entangled space , e.g. the rest of a quantum computer .",
    "we emphasize that the states resulting from the process and compared on the right hand side are states of the detector and ancillary space . in the special case of two - outcome povms",
    ", we believe the state that reveals the worst - case performance will always be separable , indicating that @xmath74 is inherently stable . in the supplemental material",
    "we give a proof of this in the case of the two - outcome detector s-_distance _ , and we have numerical evidence suggesting that the two - outcome detector s-_fidelity _ has the same property .",
    "we stress that the minimization is still useful as it yields the worst - case performance .",
    "additionally , it can be easily shown that the @xmath74 reduces to a minimization of the ( square of the ) _ classical _ fidelity of the probability distribution of the detector outcomes .",
    "the minimization over input states is performed using a semidefinite programming package in matlab @xcite . with this measure , the seven detector fidelities we report are between @xmath75 , which improve to @xmath76 with post - selection on the success herald .",
    "we see that for our realized detectors the j - fidelities are @xmath77 better than the worst - case performance .",
    "we have now characterized the behavior of the detector , but what happens to the input state after a measurement result is recorded ?",
    "what is the back - action of registering a `` click '' or no `` click '' ?",
    "quantum error correction , for example , demands that the measurements must be highly quantum non - demolition in the sense of a von neumann measurement .",
    "when an ancilla measurement indicates an outcome , e.g. that the register has positive @xmath23 , the quantum process performed is ideally a projector on to the specified subspace .",
    "one method of analysis is to describe this process by two trace - non - preserving maps on the register hilbert space , @xmath78 .",
    "we quantify these maps by performing outcome - dependent quantum process tomography , which has been previously demonstrated for two - qubit measurements @xcite .",
    "this reconstruction begins by preparing a complete set of initial register states . for each initial state",
    "we perform our measurement , record the outcomes , and perform state tomography conditioned on those outcomes .",
    "we employ a maximum likelihood estimation ( mle ) for each state tomogram , then weight the outcome states by the probability that each measurement outcome was observed .",
    "this subtlety leads to individually trace - non - preserving maps . to extract the process",
    ", we then perform an additional mle relating the input states to both sets of output states , constraining the full measurement channel to be positive and trace - preserving .",
    "it would be preferable to perform a single mle , rather than two , but this problem is computationally imposing in the three - qubit case .",
    "the sequential approach has the additional benefit of allowing us to recalibrate drifts in our tomographic measurement operator throughout the several hours of data acquisition .    the reconstructed conditioned maps for the @xmath17 operator are partially shown in fig .",
    "[ fig : qpt ] . ideal measurements of generalized pauli operators have four real elements in the @xmath79 matrix representation .",
    "each of these has amplitude @xmath80 , with positive diagonal elements and off - diagonal elements which change sign between the two outcomes .",
    "we find good qualitative agreement between this and our experimental data with a small decrease in contrast , indicating that the back - action is close to the ideal von neumann projections .",
    "three - qubit conditioned quantum process tomography . experimental quantum process tomography ( qpt ) results for ( a ) even and ( b ) odd outcome process maps for the three - parity measurement , @xmath17 .",
    "we express our process tomography in the pauli basis where the conditioned processes can be described using @xmath79 matrix notation : @xmath81 where @xmath82 are the three - qubit generalized pauli operators . here",
    "we show only the corners of these process matrices , all other parts are visually indistinguishable from noise .",
    "data on the full reconstruction , including of the other six measurement operators , are given in the supplement .",
    "the ideal even and odd outcome processes are projectors @xmath83 , and the corresponding @xmath79 matrices have a simple form consisting of only four real components in the generalized pauli basis , and this ideal form is overlaid with wireframe bars .",
    "note that we plot only the real components as all experimental imaginary components are visually indistinguishable from noise .",
    "we calculate the j - fidelity ( as defined in section [ section : f_qi ] ) for this operator to be @xmath84 .",
    ", width=335 ]      how can we compare the performance of our experimentally - reconstructed measurement process to the ideal measurement ?",
    "we answer this question by representing the full measurement process as a quantum instrument @xcite , an approach that parallels our previous treatment of povms as channels and shares many of its advantageous properties .",
    "a quantum instrument describes a single channel that takes in a quantum state of the system and outputs both a quantum state of the system as well as a detector - outcome state .",
    "this detector - outcome state is the same as in eq .",
    "[ eq : detector_process ] and signals the conditioned back - action induced on the system input state . for a two - outcome measurement , the quantum instrument can be written as    @xmath85    where @xmath61 refers to the input state in the register space , @xmath86 refer to diagonal states in the detector subspace @xmath87 , and @xmath88 are projectors in the register space onto orthogonal measurement outcomes .",
    "similar to our previous analysis of the detectors ( without back - action ) , we derive fidelity measures for these quantum instrument channels .",
    "the j - fidelities for quantum instrument channels follow from eq .",
    "[ eq : fid_j_det ] with the appropriate quantum instrument maps and are calculated between @xmath89 .",
    "these improve to @xmath90 with post - selection on the success herald .",
    "we also report the s - fidelity for these channels ,    @xmath91    following the same notational caveats as eq .",
    "[ eq : stab_fid ] .    for our experimental results ,",
    "we calculate @xmath92 of @xmath93 , which increase to @xmath94 with post - selection on the success herald .",
    "we see that the worst - case performance is as much as @xmath95 worse than the j - fidelity measure .",
    "note that for the success - heralded data , we include the requisite selective rotation and measurement in the definition of the process , which exposes the register to another 1.5 @xmath9s of decoherence , though we do employ a hahn echo on all qubits in the register .",
    "this check could be made significantly faster with an additional , dedicated qubit with a large dispersive shift .",
    "we have shown that the implemented multi - qubit measurements behave as intended : they are highly specific to the desired operator and have detector fidelities that approach the bound set by our single - qubit measurements . additionally , we see that the back - action of the measurement is indeed close to the ideal , but unsurprisingly it is worse than our measurement contrast .",
    "the performance demonstrated here is limited by several effects .",
    "the largest source of infidelity for both the detectors and processes is cavity photon loss , which can be greatly reduced by moving to high - purity etched aluminum .",
    "this is known to give a factor of 10 - 20 improvement in quality factor in similar systems @xcite , and in similar samples has also increased qubit relaxation times @xcite .",
    "the second - largest imperfection in the process performance is the dephasing of one of the register qubits , which displayed a significant low - frequency beat in ramsey experiments during this experimental run .",
    "both detector and process suffer from the low @xmath96 of only 20 @xmath9s for the ancilla , which is limited by the purcell effect and which may be improved with a purcell filter @xcite .",
    "the next - largest imperfections for the detector performance are the relaxation rates of the register qubits .",
    "additional significant sources of error are the finite cavity anharmonicity and the difficulty in doing photon - number unconditional @xmath19 gates when photons are present .",
    "these two effects , as well as other coherent errors , may be circumvented by engineering a sequence via optimal control techniques @xcite , which is feasible for small modules that have weak interactions with their environment .",
    "the process j - fidelities we obtained are consistent with numerical simulations @xcite that include all known error sources .",
    "we are unable to directly compare our results to preexisting results in the field , but the most related experimental work @xcite and theoretical work @xcite cite fidelity measures that are similar to our quantum instrument j - fidelity ( or its square root ) .",
    "we reiterate that our quantum instrument j - fidelities are as much as @xmath95 higher than our quantum instrument s - fidelities . in many cases",
    "the worst - case performance is of greater importance , as in fault - tolerance considerations .",
    "indeed , we believe that it may be interesting to incorporate @xmath92 , or the analogous quantum instrument diamond distance , into threshold calculations , since it directly provides a conservative performance estimate of the operation central to stabilizer - based error correction . as a more `` compiled '' operation , the full measurement may be more sensitive to non - idealities than concatenated fidelity estimates of smaller one- and two - qubit operations .",
    "a more traditional @xmath17 measurement would consist of three cnot gates and a single - qubit measurement of an ancilla .",
    "measures derived from the quantum instrument not only take the performance of those simple operations into account , but also account for negative effects due to decoherence and residual interactions among the rest of the qubits .",
    "this includes the duration of the ancilla measurement , which by itself often has unintended and detrimental effects on other qubits in some systems .",
    "though this analysis requires reconstruction of the process , it may not be overly burdensome for several - qubit stabilizers if compressed sensing techniques are employed @xcite .",
    "we have demonstrated a versatile quantum gate ideally suited to our highly coherent 3d cqed architecture and used it to enact high - fidelity and specific multi - qubit measurements .",
    "it is possible to realize strong interactions between fixed - tuned qubits in this system , despite having low direct couplings , and there are clear pathways to further improved performance .",
    "as quantum systems continue to grow in complexity , it will be crucial to build systems with low cross - talk and residual interactions like the one demonstrated here .",
    "we have also presented several new approaches to analyze and characterize measurements , including two new conservative measures to quantify the fidelity of detectors and measurement processes .",
    "complex measurements within larger systems will become increasingly important , and the figures of merit introduced in this work may prove to be useful tools to benchmark their performance .",
    "we acknowledge reinier heeres and philip reinhold for helpful discussions and software assistance .",
    "we acknowledge katrina sliwa , anirudh narla , and michael hatridge for providing our jpc and advising on its installation and use .",
    "we acknowledge wolfgang pfaff and victor albert for helpful discussions .",
    "facilities use was supported by the yale seas cleanroom , yinqe and nsf mrsec dmr-1119826 .",
    "this research was supported by the army research office under grant no .",
    "w911nf-14 - 1 - 0011 and by office for naval research under grant no .",
    "fa9550 - 14 - 1 - 0052 .",
    "c.  a.  acknowledges support from the nsf graduate research fellowship under grant no .",
    "s.  m.  g.  acknowledges additional support from the nsf under grant no .",
    "m.  s.  acknowledges additional support from the alfred kordelin foundation .",
    "s.  e.  n.  acknowledges support from the swiss nsf .    * supplementary material *",
    "we give a more comprehensive hamiltonian in eq .",
    "[ eq : fullh ] .",
    "we label the ancilla either directly by name or abbreviated as qubit a , and we refer to the register qubits as qubits b , c , or d. the experimentally found values , presented in fig . [",
    "fig : fullh_fig ] , are generally within @xmath95 of values predicted from simulation in ansys hfss and black box quantization @xcite .",
    "@xmath97    the qubit frequencies were identified via ramsey oscillations , and the cavity frequency was found by displacement , waiting , and a second opposing displacement with varying phase .",
    "the periodicity of the probability of the cavity having zero photons then is an interferometric indicator of the detuning . repeating this experiment at various displacement amplitudes yields both the kerr @xmath98 and the bare frequency @xmath3 .",
    "the frequencies , @xmath99 shifts , and @xmath100 shifts are defined in the main text .",
    "register qubit @xmath79 shifts are found by performing the cavity resonance frequency experiment with and without a qubit excited . repeating this with initial coherent states with different average photon populations yields the number - state dependent dispersive shift ( or qubit - state dependent kerr ) @xmath101 as the slope and @xmath79 as the y - intercept .",
    "the @xmath79 of the ancilla to the storage cavity is found via qubit state revivals in the presence of cavity photons , and a series of these experiments over initial coherent states with different average photon populations also yields @xmath101 .",
    "these experiments are described more fully in the supplement of @xcite .",
    "we measure the direct qubit - qubit coupling @xmath100 for all six pairs of qubits . in order to find this",
    ", we use a version of a ramsey experiment where the delay time is fixed and we vary the final @xmath102 phase to extract damped , phase - shifted oscillations .",
    "we perform a pair of these experiments on qubit @xmath31 with qubit @xmath103 either initialized in the ground state or the excited state .",
    "we extract the relative phase shift between these two experiments .",
    "we perform a series of these paired experiments for different ramsey delays and fit the data to a line .",
    "the slope is @xmath100 .",
    "we show the results of these experiments in fig .",
    "[ fig : zetas ] .",
    "we note that five of the six couplings are on the order of 1 khz , and the largest @xmath100 of 22 khz is between the the ancilla and a register qubit , the two qubits that have the smallest detuning ( and largest @xmath79 ) to the storage cavity .",
    "we note that the ancilla - register direct couplings are largely unimportant .",
    "as the ancilla state is known at the end of the experiment , the interaction results in deterministic and known phase shifts .",
    "[ fig : zetas ] , extracted phase vs. time from ramsey experiments.,title=\"fig:\",width=336 ]    the next higher levels of the transmons were probed directly with two - tone spectroscopy to find @xmath104 .",
    "note that as we only use direct readout of the ancilla , measurements of the register qubits ( e.g. spectroscopy and coherence measurements ) are done via a cascaded and non - qnd mapping .",
    "the state of those qubits are probed via a spectrally narrow conditional cavity displacement , followed by using the ancilla to check if the cavity has been displaced from the vacuum .",
    "this yields single - shot measurement fidelities of the register qubits on the order of 0.80 .",
    "our anharmonicities are on the order of 200mhz , limiting us to timescales for single - qubit operations of roughly 10 ns .",
    "the anharmonicity of the cavity , @xmath98 for kerr , is a limiting factor in our algorithm , as it is not reversed under echo .",
    "this results in residual photons and dephasing between register states entangled with different photons numbers .",
    "the number - dependent dispersive shift @xmath105 , though a sixth - order term ( in the expansion of the cosine josephson energy ) , is on the same scale as @xmath98 .",
    "it results in similar non - idealities as @xmath98 .",
    "all other higher - order terms do not have a significant effect on this experiment .",
    "note that the hamiltonian of the readout resonator has not been included , however it shares a dispersive shift with the ancillary qubit of roughly 5 mhz , found spectroscopically .",
    "the readout cavity does have a small dispersive ` cross kerr ' shift directly with the high - q cavity of 24 khz , much smaller than the readout decay rate of 2 mhz .",
    "the cross kerr was measured via stark shift .",
    "we estimate dispersive shifts with the register qubits on the order of 100 hz or lower based on additional stark - shift measurements .",
    "these effects may be mediated by the unused planar resonators , which are detuned approximately 50 , 350 , and 360 mhz from the readout resonator .",
    "[ fig : fullh_fig ] , title=\"fig:\",width=336 ]",
    "we characterize qubit coherence with three time constants : free energy decay @xmath96 , ramsey oscillation decay @xmath106 , and hahn ( single ) echo decay @xmath107 . in general",
    "we use @xmath107 as the relevant coherence time as our algorithm naturally performs several spin echos , and we add echo pulses in steps where they do not occur naturally ( e.g. during ancilla measurement and during the optional error detection rotation ) .",
    "all times are given in microseconds .",
    "[ cols=\"<,^,^,^\",options=\"header \" , ]",
    "we calculate the stable diamond norm of the difference of a pair of arbitrary 2-outcome povm channels and construct the the optimal discrimination input state",
    ". we will show that optimal discrimination does not require an ancilla entangled with the system on which the povms act .",
    "this means for povm channels the stabilized ( including ancilla ) and unstabilized ( no ancilla ) diamond norm are equal . as a preparation we first define a few concepts and introduce a necessary lemma .    *",
    "( povm channel ) * for a @xmath108-outcome , @xmath26-dimensional povm , @xmath109 where @xmath110 and @xmath111 , define the quantum - to - classical channel , @xmath112 where @xmath113 are the pointer states of the detector .",
    "note that @xmath114 has input dimension @xmath26 and output dimension @xmath108 .    *",
    "( diamond norm ) * for two channels @xmath115 and @xmath116 having the same input / output space , define the diamond norm @xmath117 where @xmath118is the trace norm ( nuclear norm ) , and s denotes the system @xmath115 and @xmath116 act on and a denotes an ancilla potentially entangled with s. note that due to convexity of both the trace norm and the space of density matrices @xmath119 , the maximizer is always pure , @xmath120 .      * ( unstable trace norm ) * for two channels @xmath115 and @xmath116 having the same input / output space , define the worst - case trace norm @xmath121 due to convexity of both the trace norm and the space of density matrices @xmath122 , the maximizer is always pure , @xmath123 .",
    "[ lem : nuclear - norm - maxim]let @xmath124 and @xmath125 be arbitrary complex @xmath126 matrices and let @xmath127 be unitary with same dimension . using the singular value decomposition , @xmath128 , @xmath129 , where @xmath130 / @xmath131 have decreasing diagonal elements ,",
    "then @xmath132 where @xmath133 stands for the @xmath31-th largest singular value of matrix @xmath134 .",
    "the equality holds when @xmath135 .",
    "the trace norm is unitarily invariant , i.e. @xmath136 . so we have @xmath137 where the important inequality used above is due to theorem iv.2.5 of r. bhatia s _ matrix analysis _ @xcite .",
    "it is easy to check that when @xmath138 , i.e. @xmath139 .      * ( diamond norm of 2-outcome povm channels ) * for two povm channels @xmath115 and @xmath116 corresponding to @xmath140 and @xmath141 , the diamond norm * * @xmath142 the optimal input state is a product state @xmath143 , where @xmath144 is the eigenvector of @xmath145 corresponding to the eigenvalue with the largest absolute value .",
    "this is to say , for maximal distinguishability , the ancilla is not required and that @xmath146    let @xmath147 where @xmath148 and @xmath149 .",
    "we then have @xmath150}\\ket{\\mu}\\bra{\\mu}\\otimes\\ket{e_{i}}_{a}\\bra{e_{j}}\\\\   & = & \\sum_{ij}\\sqrt{p_{i}p_{j}}\\sum_{\\mu}\\bra j(m_{\\mu}-n_{\\mu})\\ket i\\ket{\\mu}\\bra{\\mu}\\otimes\\ket{e_{i}}_{a}\\bra{e_{j}}\\\\   & = & \\left[\\begin{array}{cc } \\sum_{ij}\\sqrt{p_{i}p_{j}}\\bra j(m_{1}-n_{1})\\ket i\\ket{e_{i}}_{a}\\bra{e_{j } } & \\mathbf{0}_{d\\times d}\\\\ \\mathbf{0}_{d\\times d } & \\sum_{ij}\\sqrt{p_{i}p_{j}}\\bra j(m_{2}-n_{2})\\ket i\\ket{e_{i}}_{a}\\bra{e_{j } } \\end{array}\\right].\\end{aligned}\\ ] ] since @xmath151 and @xmath152 , we have @xmath153 and @xmath154 therefore @xmath155 where we defined @xmath156 and diagonalized @xmath157 , @xmath158 with @xmath159 .    using lemma [ lem : nuclear - norm - maxim ] twice we have @xmath160 where @xmath161 denote @xmath162 in descending order and we also used the fact that singular values are the absolute values of eigenvalues @xmath163 .",
    "the weight sum @xmath164 achieves maximum when we put all the weight on the largest element @xmath165 , i.e. @xmath166 and @xmath167 .",
    "therefore @xmath168 and @xmath169 it is simple to verify that the equality is indeed achievable when we pick @xmath170 where @xmath171 is the eigenvector of @xmath145 corresponding to the eigenvalue with largest absolute value @xmath165 .",
    "59ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]  + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty link:\\doibase 10.1038/nature13171 [ * * ,   ( ) ] http://arxiv.org/pdf/1604.00032v1.pdf [ ( ) ] link:\\doibase    10.1103/physrevlett.108.147701 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevlett.100.200502 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevlett.107.240501 [ * * ,   ( ) ] \\doibase doi:10.1038/ncomms7896 [ * * ( ) ,  doi:10.1038/ncomms7896 ] link:\\doibase",
    "10.1109/sfcs.1994.365700 [ _ _ ]  ( ,  )  pp",
    ".   http://arxiv.org/abs/quant-ph/9705052 [ ( ) ] link:\\doibase    10.1016/s0003 - 4916(02)00018 - 0 [ * * ,   ( ) ] http://arxiv.org/abs/1508.01388v1 [ ( ) ] link:\\doibase 0.1038/nature14270 [ * * ,   ( ) ] http://arxiv.org/abs/1602.04768 [ ( ) ] link:\\doibase 10.1126/science.273.5278.1073 [ * * ,   ( ) ]",
    "link:\\doibase 10.1103/physreva.65.010101 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevlett.96.050504 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.89.032316 [ * * ,   ( ) ] \\doibase    doi:10.1038/npjqi.2015.5 [ * * ( ) ,  doi:10.1038/npjqi.2015.5 ] https://arxiv.org/abs/1512.06069 [ ( ) ] http://arxiv.org/abs/1605.01351 [ ( ) ] link:\\doibase 10.1126/science.1253742 [ * * ,   ( ) ] link:\\doibase 10.1038/nature09801 [ * * ,   ( ) ] link:\\doibase 10.1038/ncomms5015 [ * * ( ) ,  10.1038/ncomms5015 ] link:\\doibase 10.1103/physrevlett.112.070502 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.109.240504 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.92.174507 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.110.243604 [ * * ,   ( ) ] link:\\doibase    10.1038/nphys1133 [ * * ,   ( ) ] @noop _ _ ,   ed .",
    "( ,  ,  ) link:\\doibase 10.1038/35051009 [ * * ,   ( ) ] http://arxiv.org/abs/quant-ph/0703264 [ * * ,   ( ) ] http://arxiv.org/abs/quant-ph/0402171 [ ( ) ] http://arxiv.org/abs/1508.05882 [ ( ) ] http://arxiv.org/pdf/1604.06514v1 [ ( ) ] link:\\doibase 10.1038/nature05461 [ * * ,   ( ) ] link:\\doibase    10.1126/science.1243289 [ * * ,   ( ) ] http://arxiv.org/pdf/1106.1445v7.pdf [ ( ) ] \\doibase    http://dx.doi.org/10.1063/1.526000 [ * * ,   ( ) ] http://projecteuclid.org/euclid.cmp/1103842336 [ * * , ( ) ] link:\\doibase    10.1103/physreva.71.062310 [ * * ,   ( ) ] link:\\doibase    10.1103/physreva.90.032302 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.88.022127 [ * * ,   ( ) ] http://www.turpion.org/php/full/infoft.phtml?journal_id=rm&paper_id=2155 [ * * ,   ( ) ] link:\\doibase    10.1038/nphoton.2012.107 [ * * ,   ( ) ] link:\\doibase    10.1103/physreva.77.012307 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.81.062325 [ * * ,   ( ) ] @noop `` , ''   ( ) ( ,  )  pp .   @noop   ( ) , link:\\doibase 10.1016/j.jmr.2004.11.004 [ * * ,   ( ) ] \\doibase    http://qutip.org/ [ * * ( ) , http://qutip.org/ ] link:\\doibase 10.1103/physrevlett.105.150401 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevlett.108.240502 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.92.035442 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.109.240504 [ * * ,   ( ) ] link:\\doibase    10.1126/science.aaa2085 [ * * ,   ( ) ] link:\\doibase    10.1126/science.aaf2941 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.110.120501 [ * * ,   ( ) ] http://arxiv.org/pdf/1603.00943v1.pdf [ ( ) ] ,   @noop _ _ ( ,  , )"
  ],
  "abstract_text": [
    "<S> there are two general requirements to harness the computational power of quantum mechanics : the ability to manipulate the evolution of an isolated system and the ability to faithfully extract information from it . </S>",
    "<S> quantum error correction and simulation often make a more exacting demand : the ability to perform non - destructive measurements of specific correlations within that system . </S>",
    "<S> we realize such measurements by employing a protocol adapted from [ s.  nigg and s.  m.  girvin , phys .  </S>",
    "<S> rev .  </S>",
    "<S> lett .  * 110 * , 243604 ( 2013 ) ] , enabling real - time selection of arbitrary register - wide pauli operators . </S>",
    "<S> our implementation consists of a simple circuit quantum electrodynamics ( cqed ) module of four highly - coherent 3d transmon qubits , collectively coupled to a high - q superconducting microwave cavity . as a demonstration </S>",
    "<S> , we enact all seven nontrivial subset - parity measurements on our three - qubit register . for each we fully characterize the realized measurement by analyzing the detector ( observable operators ) via quantum detector tomography and by analyzing the quantum back - action via conditioned process tomography . no single quantity </S>",
    "<S> completely encapsulates the performance of a measurement , and standard figures of merit have not yet emerged . </S>",
    "<S> accordingly , we consider several new fidelity measures for both the detector and the complete measurement process . </S>",
    "<S> we measure all of these quantities and report high fidelities , indicating that we are measuring the desired quantities precisely and that the measurements are highly non - demolition . </S>",
    "<S> we further show that both results are improved significantly by an additional error - heralding measurement . </S>",
    "<S> the analyses presented here form a useful basis for the future characterization and validation of quantum measurements , anticipating the demands of emerging quantum technologies . </S>"
  ]
}