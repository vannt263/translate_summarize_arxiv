{
  "article_text": [
    "a dimer configuration on a graph @xmath0 is a choice of a family of edges of @xmath0 , called dimers , such that each vertex of @xmath0 is adjacent to exactly one dimer .",
    "assigning weights to the edges of @xmath0 allows to define a probability measure on the set of dimer configurations .",
    "the study of this measure has undergone spectacular advances in the past few years ( see in particular @xcite ) but one of the fundamental results on which these rely dates back from the early 60 s .",
    "back then , p. w. kasteleyn @xcite showed that the partition function of the dimer model on a planar graph is equal to the pfaffian of a signed - adjacency matrix , the signs being determined by an orientation of the edges of @xmath0 called a kasteleyn orientation . for the square lattice on the torus",
    ", kasteleyn showed that the partition function can be written as a linear combination of 4 pfaffians , corresponding to the 4 ( equivalence classes of ) kasteleyn orientations on such a graph . in the general case of a graph embedded in an orientable surface of genus @xmath3",
    ", there are exactly @xmath4 equivalence classes of such orientations , and kasteleyn stated that the partition function can be written as a linear combination of @xmath4 pfaffians @xcite .",
    "a combinatorial proof of this fact for all oriented surfaces was first obtained much later by galluccio - loebl @xcite and tesler @xcite , independently .",
    "( see also @xcite . )",
    "the number of equivalence classes of kasteleyn orientations on a graph @xmath0 embedded in @xmath5 is also equal to the number of equivalence classes of spin structures on @xmath1 .",
    "an explicit construction relating a spin structure on a surface with a kasteleyn orientation on a graph with dimer configuration was suggested in @xcite . in @xcite , n. reshetikhin and the author investigated further the relation between kasteleyn orientations and spin structures ( see theorem  [ thm : corr ] and corollary  [ cor : corr ] below ) .",
    "we also used this relation together with the identification of spin structures with quadratic forms to give a purely geometric proof of the pfaffian formula for closed oriented surfaces .",
    "our final formula can be roughly expressed as follows : given a graph @xmath0 embedded in a closed oriented surface @xmath1 of genus @xmath3 , the partition function of the dimer model on @xmath0 is given by @xmath6 where @xmath7 denotes the set of equivalence classes of spin structures on @xmath1 , @xmath8 is the arf invariant of the spin structure @xmath9 , and @xmath10 is the signed - adjacency matrix given by the kasteleyn orientation corresponding to @xmath9 .",
    "( see theorem  [ thm : pf ] below for the precise statement . )",
    "this formula obviously does not hold for graphs embedded in non - orientable surfaces , as neither spin structures nor kasteleyn orientations make sense in this setting . and",
    "yet , the dimer model on such graphs has been the focus of some research , leading to pfaffian - type formulae in several special cases .",
    "( see e.g. @xcite where the authors study square lattices in the mbius band and the klein bottle . )",
    "the purpose of the present paper is to extend our geometric approach of the dimer model to any graph embedded in ( possibly ) non - orientable surfaces .",
    "the main idea is to replace spin structures by @xmath2 structures on @xmath1 , and to find a natural correspondence between these @xmath2 structures and some orientations on @xmath11 ( that we also call kasteleyn orientations )  see theorem  [ thm : n - corr ] and corollary  [ cor : n - corr ] .",
    "we then make use of the identification of @xmath2 structures on @xmath1 with quadratic enhancements of the intersection form on @xmath12 to obtain the pfaffian formula . it can be expressed as follows : given a graph @xmath0 embedded in a closed possibly non - orientable surface @xmath1 , @xmath13 where @xmath14",
    ", @xmath15 denotes the set of equivalence classes of @xmath2 structures on @xmath1 , @xmath16 is the brown invariant of the @xmath2 structure @xmath17 , and @xmath18 is the matrix given by the kasteleyn orientation corresponding to @xmath17 .",
    "( see theorem  [ thm : pf - n ] below . )",
    "this formula is mostly interesting from a theoretical point of view , but does not seem very convenient for computational purposes . to this end , we obtain the following more usable result .",
    "let @xmath0 be a graph embedded in a closed possibly non - orientable surface @xmath1 such that @xmath19 consists of open 2-discs .",
    "recall that such a surface is of the form @xmath20 , @xmath21 or @xmath22 , where @xmath20 denotes the orientable surface of genus @xmath3 and @xmath23 the klein bottle .",
    "let @xmath24 be a set of simple closed curves on @xmath1 , transverse to @xmath0 , whose classes form a basis of @xmath25 .",
    "if @xmath26 , fix two disjoint simple closed curves @xmath27 on @xmath1 , transverse to @xmath0 , disjoint from the @xmath28 s , whose classes form a basis of @xmath29 in @xmath30 .",
    "let @xmath31 be some well - chosen kasteleyn orientation on @xmath11 ( see theorems  [ thm : pf ] and [ thm : pf-n ] ) , and for any @xmath32 , let @xmath33 denote the orientation obtained from @xmath31 as follows : invert the orientation @xmath31 on the edge @xmath34 of @xmath0 each time @xmath34 intersects @xmath28 with @xmath35 . finally ,",
    "if @xmath26 , let @xmath36 be obtained by inverting @xmath33 on @xmath34 each time the edge @xmath34 intersects @xmath37 .",
    "the partition function of the dimer model on @xmath38 is given by @xmath39 if @xmath40 or @xmath21 , and by @xmath41 if @xmath26 , where @xmath42 is the ( complex - valued ) weighted - adjacency matrix associated to the orientation @xmath33 .",
    "it should be mentioned that tesler s combinatorial method @xcite is also valid for graphs in non - orientable surfaces . moreover",
    ", his approach yields an algorithm of the same complexity as ours , as both require the computation of @xmath43 pfaffians of dimension the number of vertices of @xmath38 . however , tesler s final result consists of an algorithmic way to compute the partition function , but not in a closed formula as the one obtained here .",
    "let us conclude this introduction with one last remark .",
    "it is well known that the partition function of the ising model on a graph @xmath44 can be expressed as the partition function of the dimer model on another graph embedded in the same surface @xmath5 .",
    "therefore , our results could be used to compute the partition function of the ising model on graphs in non - orientable surfaces .",
    "( see @xcite for an attempt to solve this problem using transfer matrices . )",
    "however , we do not address this question in the present article .",
    "the paper is organized as follows . in section  [ sec : dimers ] , we introduce the dimer model and review kasteleyn s theory . for didactical reasons ,",
    "we devote section  [ sec : orientable ] to the orientable case : we first recall the main ideas of @xcite , then present a greatly simplified correspondence between spin structures and kasteleyn orientations .",
    "we also prove both versions of the pfaffian formula stated above , in the orientable case .",
    "our hope is that the reader will benefit from this warm up case before moving on to the core of the paper , which lies in sections  [ sec : kast - n ] to [ sec : pf - n ] .",
    "there , we first extend the definition of a kasteleyn orientation to graphs embedded in non - orientable surfaces ( section  [ sec : kast - n ] ) , then show that these correspond naturally to @xmath2 structures on the surface ( section  [ sec : pin ] ) , and eventually prove the pfaffian formulae ( section  [ sec : pf - n ] ) .",
    "let @xmath38 be a finite connected graph .",
    "a _ dimer configuration _ ( or _ perfect matching _ ) on @xmath0 is a choice of edges of @xmath0 , called _",
    "dimers _ , such that each vertex of @xmath0 is adjacent to exactly one of these edges .",
    "we shall denote by @xmath45 the set of dimer configurations on @xmath0 .",
    "an _ edge weight system _ on @xmath0 is a positive real - valued function @xmath46 on the set of edges of @xmath0 .",
    "such a system defines a probability distribution on @xmath45 by @xmath47 where @xmath48 and @xmath49 this probabilistic measure is the _ gibbs measure _ for the dimer model on the graph @xmath0 with weight system @xmath46 , and @xmath50 is the associated _",
    "partition function_.    given a fixed edge - weighted graph @xmath0 , the aim is to compute the associated partition function .",
    "note that if @xmath46 is everywhere equal to one , this amounts to computing the number of dimer configurations on @xmath0 .",
    "kasteleyn s method is based on the following beautifully simple computation .",
    "if there exists a dimer configuration , then the number of vertices of @xmath0 is even .",
    "enumerate them by @xmath51 , and fix an orientation @xmath31 of the edges of @xmath0 .",
    "let @xmath52 denote the associated weighted skew - adjacency matrix ; this is the @xmath53 skew - symmetric matrix whose coefficients are given by @xmath54 where the sum is on all edges @xmath34 in @xmath38 between the vertices @xmath55 and @xmath56 , and @xmath57 recall that the pfaffian of a skew - symmetric matrix @xmath58 of size @xmath59 is given by @xmath60\\in\\pi}(-1)^\\sigma a_{\\sigma(1)\\sigma(2)}\\cdots a_{\\sigma(2n-1)\\sigma(2n)},\\ ] ] where the sum is on the set @xmath61 of matchings of @xmath62 , @xmath63 is a permutation of @xmath62 representing the matching @xmath64 $ ] , and @xmath65 denotes the signature of @xmath63 . in the case of @xmath66 , a matching of @xmath62 contributes to the pfaffian if and only if it is realized by a dimer configuration on @xmath0 , and this contribution is @xmath67 .",
    "more precisely , @xmath68 where the sign @xmath69 can be computed as follows : if the dimer configuration @xmath70 is given by edges @xmath71 matching vertices @xmath72 and @xmath73 for @xmath74 , let @xmath63 denote the permutation sending @xmath75 to @xmath76 , and set @xmath77 the problem of expressing @xmath50 as a pfaffian now boils down to finding an orientation @xmath31 of the edges of @xmath0 such that @xmath69 does not depend on @xmath70 .    obviously , any dimer configuration @xmath70 can be considered as a cellular 1-chain @xmath78 such that @xmath79 , the sum being on all vertices of @xmath0 .",
    "hence , given any two dimer configurations @xmath80 , their sum @xmath81 is a 1-cycle .",
    "the connected components of this 1-cycle are disjoint simple loops of even length ; let us denote them by @xmath82 .",
    "an easy computation shows that @xmath83 where @xmath84 denotes the number of edges of @xmath85 where a fixed orientation of @xmath85 differs from @xmath31 .",
    "( since @xmath85 has even length , the parity of this number is independent of the orientation of @xmath85 . ) therefore , we are now left with the problem of finding an orientation @xmath31 of @xmath0 such that , for any cycle @xmath86 of even length such that @xmath87 admits a dimer configuration , @xmath88 is odd .",
    "such an orientation was called _",
    "admissible _ by kasteleyn ; nowadays , the term of _ pfaffian orientation _ is commonly used . by the discussion above , if @xmath31 is a pfaffian orientation , then @xmath89 .",
    "kasteleyn s early triumph was to prove that every planar graph admits a pfaffian orientation .",
    "more precisely , let @xmath0 be a graph embedded in the plane .",
    "each face @xmath90 of @xmath91 inherits the ( say , counterclockwise ) orientation of @xmath92 , so @xmath93 can be oriented as the boundary of the oriented face @xmath90 .",
    "given @xmath91 , there exists an orientation @xmath31 of @xmath0 such that , for each face @xmath90 of @xmath91 , @xmath94 is odd .",
    "furthermore , such an orientation is pfaffian .",
    "an amazing consequence of this result is that it enables to compute the partition function of the dimer model on a planar graph in polynomial time .",
    "there is no hope to extend this result to the general case .",
    "indeed , some graphs ( such as the complete bipartite graph @xmath95 ) do not admit a pfaffian orientation .",
    "more generally , enumerating the dimer configurations on a graph is a @xmath96-complete problem @xcite .",
    "it turns out that kasteleyn s method does extend to surfaces , but one needs to compute many pfaffians .",
    "this is the aim of the following section .",
    "in @xcite , n. reshetikhin and the author derived a pfaffian formula for graphs embedded in closed orientable surfaces .",
    "however , the central argument  that is , the correspondence between kasteleyn orientations and spin structures  was quite intricate . also , the pfaffian formula did not appear to be very convenient to use in practice . in this section",
    ", we shall present a more transparent correspondence and recall the other main steps of the proof .",
    "we shall also give another version of the pfaffian formula , more suitable for computational purposes ( see theorem  [ thm : pf ] ) .",
    "as stated in the introduction , our hope is that the reader will benefit from this warm up case before moving on to the more involved case presented in sections  [ sec : kast - n ] to [ sec : pf - n ] .      throughout this section",
    ", @xmath1 will denote a closed connected surface endowed with an orientation that will be pictured counterclockwise . by a _ surface graph _",
    ", we mean a graph @xmath0 embedded in @xmath1 as the 1-skeleton of a cellular decomposition @xmath97 of @xmath1 .",
    "this simply means that the complement of @xmath0 in @xmath1 consists of open 2-discs .",
    "we shall use the same notation @xmath97 for the surface graph and the cell complex realizing it . note that any finite connected graph can be realized as a surface graph .",
    "an orientation @xmath31 of the 1-cells of a surface graph @xmath97 is called a _",
    "kasteleyn orientation on @xmath97 _ if , for each 2-cell @xmath90 of @xmath97 , the following condition holds : the number @xmath94 of edges in @xmath93 where @xmath31 disagrees with the orientation on @xmath93 induced by the counterclockwise orientation on @xmath90 , is odd . given a kasteleyn orientation on @xmath97 , there is an obvious way to obtain another one : pick a vertex of @xmath97 and flip the orientation of all the edges adjacent to it .",
    "two kasteleyn orientations are said to be _ equivalent _ if they can be related by such moves .",
    "let us denote by @xmath98 the set of equivalence classes of kasteleyn orientations on @xmath97 .",
    "[ prop : kast ] a surface graph @xmath97 admits a kasteleyn orientation if and only if @xmath97 has an even number of vertices . in this case , the set @xmath98 is an @xmath99-torsor , that is , it admits a freely transitive action of the group @xmath99 .",
    "the proof can be found either in ( * ? ? ?",
    "* section 4 ) , or in section  [ sec : kast - n ] of the present paper where the more general theorem  [ thm : kast - n ] is proved .",
    "this proposition implies that , if @xmath97 has an even number of vertices , then it admits exactly @xmath4 equivalence classes of kasteleyn orientations , where @xmath3 is the genus of @xmath1 .",
    "it actually also implies the following .",
    "a surface graph of genus @xmath3 with an even number @xmath100 of vertices admits exactly @xmath101 kasteleyn orientations .    by proposition  [ prop :",
    "kast ] , it is sufficient to prove that , given any orientation @xmath102 , the number of orientations equivalent to @xmath102 is equal to @xmath103 .",
    "let @xmath104 denote the set of subsets of the vertices of @xmath97 , and let @xmath105 be given by @xmath106 , the orientation obtained from @xmath102 by changing the orientation around all vertices of @xmath107 .",
    "the map @xmath108 is obviously surjective .",
    "using the fact that @xmath97 is connected , one easily checks that @xmath109 if and only if @xmath110 or @xmath107 and @xmath111 form a partition of @xmath112 .",
    "hence , @xmath108 is two to one , proving the claim .",
    "let us now recall several general facts about spin structures on a compact oriented surface @xmath1 , referring to ( * ? ? ?",
    "* section 5.2 ) for details .",
    "we assume throughout that @xmath1 is endowed with a fixed riemannian metric .",
    "first of all , it is well known that the set @xmath7 of equivalence classes of spin structures on @xmath1 is an @xmath99-torsor .",
    "also , any spin structure can be described by a vector field on @xmath1 with isolated zeroes of even index ; conversely , any such vector field defines a spin structure .",
    "finally , a theorem of d. johnson @xcite asserts the existence of an @xmath99-equivariant bijection from @xmath7 onto the set @xmath113 of quadratic forms on @xmath12 .",
    "( recall that such a form is a map @xmath114 such that @xmath115 for all @xmath116 , where @xmath117 denotes the intersection form .",
    "the set @xmath113 is clearly an @xmath99-torsor . )",
    "more explicitly , given a spin structure @xmath118 and a vector field @xmath119 representing it , then the associated quadratic form @xmath120 is defined as follows .",
    "represent a class @xmath121 by a collection of disjoint oriented regular simple closed curves @xmath122 in @xmath1 avoiding the zeroes of the vector field @xmath119 , and set @xmath123 where @xmath124 denotes the winding number of the vector field @xmath119 with respect to the tangential vector field along @xmath85 .",
    "now , the game consists in trying to encode combinatorially a spin structure on a surface @xmath1 , or equivalently , a vector field on @xmath1 with isolated zeroes of even index .",
    "let us begin by fixing a cellular decomposition @xmath97 of @xmath1 .",
    "@xmath125 to construct a ( unit length ) vector field along the 0-skeleton @xmath112 , we just need to specify one tangent direction at each vertex of @xmath97 .",
    "such an information is given by a dimer configuration @xmath70 on @xmath126 : at each vertex , point in the direction of the adjacent dimer .",
    "@xmath125 this vector field along @xmath112 extends to a unit vector field on @xmath126 , but not uniquely . roughly speaking",
    ", it extends in two different natural ways along each edge of @xmath126 , depending on the sense of rotation of the resulting vector field .",
    "we shall encode this choice by an orientation @xmath31 of the edges of @xmath126 , together with the following convention : moving along an oriented edge , the tangent vector first rotates counterclockwise until it points in the direction of the edge , then rotates clockwise until it points backwards , and finally rotates counterclockwise until it coincides with the tangent vector at the end vertex .",
    "this is illustrated in figure  [ fig : vector ] .",
    "2.5pt at 220 165 at 75 60 at 395 190    @xmath125 each face of @xmath97 being homeomorphic to a 2-disc , the unit vector field defined along @xmath126 naturally extends to a vector field @xmath127 on @xmath97 , with one isolated zero in the interior of each face .",
    "recall that in order for this vector field to define a spin structure , each zero needs to be of even index .",
    "the following lemma implies that this is the case if and only if @xmath31 is a kasteleyn orientation .",
    "[ lemma : index ] for each face @xmath90 of @xmath97 , the index of the zero of @xmath127 in @xmath90 has the parity of @xmath128 .    by definition ,",
    "the index of this zero is equal to @xmath129 , the winding number of the vector field @xmath127 along @xmath93 ( with respect to a constant vector field along @xmath90 ) .",
    "if @xmath130 is obtained from @xmath31 by changing the orientation along one edge @xmath34 of @xmath93 , then @xmath131 is equal to the winding number of the vector field obtained as follows : first move along @xmath34 in one direction as described in figure  [ fig : vector ] , and then back along @xmath34 in the opposite direction using again the construction of figure  [ fig : vector ] .",
    "using the fact that the vector field is determined at vertices by a dimer configuration , one easily checks that this winding number is equal to @xmath132 . since the right - hand side of the equation @xmath133 also changes when replacing @xmath31 by @xmath130 , it may be assumed that @xmath134 . in this case ,",
    "@xmath31 orients each edge of @xmath93 counterclockwise around @xmath90 , and the resulting vector field is isotopic to the vector field pointing outwards along @xmath93 .",
    "the winding number of this vector field along @xmath93 being equal to @xmath135 , the equality is proved .    hence , a dimer configuration @xmath70 on @xmath126 and a kasteleyn orientation @xmath31 on @xmath97 determine a spin structure on @xmath1 , i.e : a quadratic form @xmath136 .",
    "it can be computed as follows .",
    "[ lemma : quadratic ] the quadratic form @xmath136 is characterized by the following property : if @xmath86 is an oriented simple closed curve on @xmath126 , then @xmath137)=n^k(c)+\\ell_d(c)+1\\pmod{2},\\ ] ] where @xmath138 denotes the number of vertices in @xmath86 such that the adjacent dimer of @xmath70 points out to the left of @xmath86 .    since @xmath139 , any element in @xmath12 can be represented by a 1-cycle in @xmath126 .",
    "the map @xmath140 being a quadratic form , its value on such a cycle is determined by its value on simple closed curves in @xmath126 .",
    "let @xmath86 be such a curve",
    ". by construction , @xmath141)$ ] is equal to @xmath142 , so we are left with the proof that @xmath143 . by the argument given at the beginning of the proof of lemma [ lemma : index ] , the parity of @xmath144 changes when @xmath31 is inverted along one edge of @xmath86 . since the same obviously holds for @xmath145 , it may be assumed that @xmath146 .",
    "furthermore , the parity of @xmath144 also changes when a dimer pointing out to the left of @xmath86 is replaced by a dimer either on @xmath86 , or pointing out to the right of @xmath86 .",
    "hence , it may be assumed that @xmath147 as well .",
    "but in this case , @xmath148 is isotopic to the vector field pointing constantly to the right of @xmath86 , so @xmath149 .",
    "this proves the lemma .",
    "we can now state our correspondence theorem .",
    "it is a straightforward consequence of lemma  [ lemma : quadratic ] ( the same way  in @xcite  proposition 1 and corollary 2 follow from theorem 3 ) .",
    "[ thm : corr ]",
    "let @xmath97 be a cellular decomposition of an oriented closed surface @xmath1 .",
    "then , any dimer configuration @xmath150 induces an @xmath99-equivariant bijection @xmath151\\mapsto q_d^k\\ ] ] from the set of equivalence classes of kasteleyn orientations on @xmath97 to the set of equivalence classes of spin structures on @xmath1 .",
    "furthermore , given another dimer configuration @xmath152 , @xmath153 is obtained from @xmath154 by action of the poincar dual to @xmath155\\in h_1({\\sigma};{\\mathbb z}_2)$ ] .    as stated above",
    ", the correspondence depends on the choice of @xmath150 .",
    "this can be remedied as follows .",
    "let @xmath156 denote a family of closed curves in @xmath1 , transverse to @xmath126 , whose classes form a basis of @xmath12 . given any @xmath150 , let @xmath157 be given by @xmath158)=\\alpha_i\\cdot d$ ] for @xmath159",
    ". finally , let @xmath160 be defined by @xmath161 .",
    "[ cor : corr ] let @xmath97 be a cellular decomposition of an oriented closed surface @xmath1 such that @xmath126 admits a dimer configuration @xmath70 .",
    "then , the map @xmath162\\mapsto q_\\mathcal{b}^k\\ ] ] is an @xmath99-equivariant bijection which does not depend on @xmath70 .",
    "this map is obviously an @xmath99-equivariant bijection , as it is obtained from @xmath154 via translation by @xmath163 .",
    "furthermore , given @xmath164 , @xmath165)=\\alpha_i\\cdot(d+d')=[\\alpha_i]\\cdot[d+d'].\\ ] ] in other words , @xmath166 is equal to @xmath155^*$ ] , the poincar dual to @xmath155 $ ] .",
    "since @xmath167^*$ ] , it follows that @xmath168 does not depend on @xmath70 .",
    "this whole paragraph shows that kasteleyn orientations should be understood as `` discrete spin structures '' on surfaces .",
    "this terminology is already present in the literature : according to mercat @xcite , a discrete spin structure on @xmath97 is a double cover @xmath169 whose restriction to @xmath170 is the non - trivial double cover , for any face @xmath90 of @xmath97 . as mercat points out ,",
    "such a cover is encoded by the homomorphism @xmath171 which maps a 1-cycle @xmath172 to @xmath173 if and only if @xmath86 lifts to a cycle @xmath174 in @xmath175 .",
    "the correspondence with our point of view is straightforward : given a kasteleyn orientation @xmath176 , the associated @xmath177 is simply given by @xmath178 .",
    "the aim of the previous paragraph was to give a natural correspondence between kasteleyn orientations and spin structures .",
    "but as a direct consequence of lemma  [ lemma : quadratic ] , we also obtain immediately the following non - trivial combinatorial result .",
    "[ prop : quadratic ] let @xmath31 be a kasteleyn orientation on @xmath97 , and @xmath70 be a dimer configuration on @xmath126 .",
    "given a homology class @xmath121 , represent it by oriented simple closed curves @xmath122 in @xmath126 .",
    "then , the equality @xmath179 determines a well - defined quadratic form @xmath180 .",
    "we shall now use this combinatorial information , together with the results and notation of section  [ sec : dimers ] , to derive our pfaffian formula .",
    "let @xmath0 be a finite connected graph endowed with an edge weight system @xmath46 .",
    "if @xmath0 does not admit any dimer configuration , then the partition function @xmath50 is obviously zero .",
    "so , let us assume that @xmath0 admits a dimer configuration @xmath181 .",
    "enumerate the vertices of @xmath0 by @xmath51 and embed @xmath0 in a closed orientable surface @xmath1 of genus @xmath3 as the 1-skeleton of a cellular decomposition @xmath97 of @xmath1 .    since @xmath0 has an even number of vertices , the set @xmath98 is an @xmath99-torsor .",
    "for any kasteleyn orientation @xmath31 , the pfaffian of the associated weighted skew - adjacency matrix satisfies @xmath182 where the @xmath85 s are the connected components of the cycle @xmath183 .",
    "note that given any vertex of @xmath85 , the adjacent dimer of @xmath181 lies on @xmath85 , so that @xmath184 .",
    "since the cycles @xmath85 are disjoint , proposition  [ prop : quadratic ] gives @xmath185).\\ ] ] therefore , every element @xmath186 $ ] of @xmath98 induces a linear equation @xmath187 where @xmath188=\\alpha}\\mathrm{w}(d)$ ] , the sum being over all @xmath189 such that @xmath190=\\alpha$ ] .",
    "it is an easy exercise to solve this linear system of @xmath4 equations with @xmath4 unknowns , and to obtain the following formula for @xmath191 .",
    "( see ( * ? ? ?",
    "* theorem 5 ) for details . )",
    "[ thm : pf ] let @xmath0 be a graph embedded in a closed oriented surface @xmath1 of genus @xmath3 such that @xmath19 consists of open 2-discs .",
    "then , the partition function of the dimer model on @xmath38 is given by the formula @xmath192\\in{\\mathcal k}(x)}(-1)^{{\\mbox{arf}}(q^{k}_{d_0})}{\\varepsilon}^k(d_0){\\mbox{pf}}(a^{k}),\\ ] ] where the sum is taken over all equivalence classes of kasteleyn orientations , and @xmath193 denotes the arf invariant of the quadratic form @xmath194 .",
    "furthermore , the sign @xmath195 does not depend on @xmath181 .",
    "note that for a fixed @xmath181 , and for any element of @xmath98 , one can always choose a kasteleyn orientation in this equivalence class such that @xmath196 . by theorem  [ thm : corr ] , this leads to the formula stated in the introduction : @xmath6 where @xmath10 is the matrix @xmath66 for any kasteleyn orientation @xmath31 such that @xmath197 and @xmath196 .",
    "this formula is reminiscent of ( * ? ? ?",
    "* equation 6.9 ) , drawing a strong analogy between the dimer model on @xmath0 and the bosonic quantum field theory on the compact riemann surface @xmath1 .",
    "however , as it stands here , it is not very convenient for computational purposes .",
    "indeed , it seems to require the choice of a dimer configuration @xmath181 , which is often in practice very hard  if not impossible  to find .",
    "also , the computation of each quadratic form can be very tedious .",
    "nevertheless , we shall now show that this formula can actually be used in a very efficient way to compute the partition function @xmath50 .",
    "let @xmath156 be a set of simple closed curves on @xmath1 , transverse to @xmath0 , whose classes form a basis of @xmath30 .",
    "fix a kasteleyn orientation @xmath31 on @xmath11 which satisfies the following property : for any @xmath198 , let @xmath85 denote the oriented 1-cycle in @xmath0 having @xmath28 to its immediate left , and meeting every vertex of @xmath0 adjacent to @xmath28 on this side .",
    "we require @xmath84 to be odd for each @xmath55 .",
    "( there are in fact two possible choices for @xmath85 , corresponding to the two sides of @xmath28 , but the parity condition above does not depend on which one is chosen . ) finally , for any @xmath32 , let @xmath33 denote the kasteleyn orientation obtained from @xmath31 as follows : invert the orientation @xmath31 on the edge @xmath34 of @xmath0 each time @xmath34 intersects @xmath28 with @xmath35 .",
    "[ thm : pf ] let @xmath0 be a graph embedded in a closed oriented surface @xmath1 of genus @xmath3 such that @xmath19 consists of open 2-discs , and fix a set of simple closed curves @xmath24 on @xmath1 , transverse to @xmath0 , whose classes form a basis of @xmath30",
    ". then , the partition function of the dimer model on @xmath38 is given by the formula @xmath199 where @xmath33 are the kasteleyn orientations described above .",
    "if @xmath0 does not admit any dimer configuration , then equation ( [ equ : pf ] ) implies that @xmath200 for all @xmath201 , and our equality holds .",
    "therefore , it may be assumed that there exists a @xmath189 . in particular",
    ", @xmath0 has an even number of vertices , so @xmath98 is an @xmath202-torsor by proposition  [ prop : kast ] .",
    "the set @xmath203 is constructed to contain one element in each equivalence class of kasteleyn orientations , so theorem  [ thm : pf ] gives the equality @xmath204 by ( * ? ? ?",
    "* lemma 1 ) , @xmath205),\\ ] ] where the poincar dual @xmath206^*$ ] of @xmath206\\in{h_1(\\sigma;{\\mathbb z}_2)}$ ] is required to satisfy @xmath207^*=q^{k_{\\epsilon}}_d$ ] . by theorem  [ thm : corr",
    "] , this is equivalent to @xmath208^*=k_{\\epsilon}$ ] .",
    "the very definition of @xmath33 implies that @xmath209 represents the right homology class . on the other hand ,",
    "one easily checks the equality @xmath210 we thus obtain that the coefficient in @xmath211 corresponding to @xmath201 is equal to @xmath212)+\\delta_{\\epsilon}\\cdot d}=(-1)^{q^k_\\mathcal{b}([\\delta_{\\epsilon } ] ) } = ( -1)^{q^k_\\mathcal{b}(\\sum_i{\\epsilon}_i[\\alpha_i])},\\ ] ] using the notation of corollary  [ cor : corr ] .",
    "since @xmath213 is a quadratic form , @xmath214)= \\sum_i{\\epsilon}_i q^k_\\mathcal{b}([\\alpha_i])+\\sum_{i < j}{\\epsilon}_i{\\epsilon}_j\\alpha_i\\cdot\\alpha_j.\\ ] ] therefore , it remains to check that @xmath215)$ ] vanishes for all @xmath55 .",
    "to do so , consider the oriented closed curve @xmath85 in @xmath0 having @xmath28 to its immediate left , and meeting every vertex of @xmath0 adjacent to @xmath28 on this side . obviously , @xmath85 and @xmath28 are homologous , and by construction , @xmath216",
    "therefore , @xmath217)=q^k_\\mathcal{b}([c_i])=n^k(c_i)+\\ell_d(c_i)+\\alpha_i\\cdot d+1=n^k(c_i)+1.\\ ] ] we have chosen @xmath31 precisely so that this number is even for every @xmath55 .",
    "we shall now generalize the methods and results of section  [ sec : orientable ] to the case of graphs embedded in ( possibly ) non - orientable closed surfaces .",
    "once again , all the concepts will be presented in an intrinsic way , allowing us to give geometrical proofs with no combinatorial argument .",
    "let us begin with the generalization of the notion of kasteleyn orientation . throughout this section",
    ", @xmath1 will designate a possibly non - orientable closed connected surface , x a cellular decomposition of @xmath1 , and @xmath0 its 1-skeleton .",
    "the definition of a kasteleyn orientation on @xmath97 given in section  [ sub : kast ] does not make sense in the present setting , as the faces of @xmath97 are not oriented .",
    "we will hence work in the orientation cover of @xmath1 , that is , the 2-fold cover @xmath218 determined by the first stiefel - whitney class @xmath219 of @xmath1 .",
    "we shall denote by @xmath220 the cellular decomposition of the orientable surface @xmath221 induced by @xmath97 and @xmath222 .",
    "the extension of the notion of a kasteleyn orientation requires a labelling of the vertices of @xmath220 with signs , which is a little tedious to define intrinsically .",
    "following our general approach , we will now state this intrinsic definition , but the reader impatient to work with examples should replace this paragraph with remark  [ rem : kast ] .",
    "let us fix a 1-cocycle @xmath223 which represents @xmath224 .",
    "this consists simply in a decomposition of the edges of @xmath0 into 0-edges and 1-edges , such that the local orientation of @xmath1 is preserved along a 1-cycle if and only if this cycle contains an even number of 1-edges .",
    "the choice of such an @xmath225 determines a labelling of the vertices of @xmath220 with signs @xmath226 s such that each vertex of @xmath97 is covered by two vertices with opposite signs , and @xmath227 if and only if the two endpoints of a lift of @xmath34 have the same label .",
    "note that this labelling is uniquely determined by @xmath225 up to a global swap of all the signs .",
    "it induces an orientation on @xmath220 : simply paste together a local orientation ( say , counterclockwise ) near the vertices labelled @xmath228 and the opposite ( clockwise ) local orientation near the vertices labelled @xmath229 .",
    "any orientation @xmath31 of the edges of @xmath97 lifts to an orientation @xmath230 of the edges of @xmath220 .",
    "given a face @xmath90 of @xmath97 , and a lift @xmath231 , consider the number @xmath232 where @xmath233 is oriented as the boundary of the oriented face @xmath231 .",
    "( as before , @xmath234 denotes the number of edges in @xmath233 where @xmath235 disagrees with the orientation of @xmath233 . )",
    "using the fact that @xmath93 contains an even number of 1-edges , one easily checks that the parity of @xmath236 does not depend on the choice of the lift @xmath231 of @xmath90 .",
    "for the same reason , the parity of @xmath236 is unchanged if one swaps all the signs of the vertices of @xmath220 , as this also reverses the orientation of @xmath220 .",
    "therefore , the parity @xmath237 of the number @xmath236 only depends on @xmath31 , @xmath90 and @xmath225 . by analogy with the orientable case",
    ", we shall call it the _ kasteleyn curvature of @xmath31 at @xmath90_. an orientation @xmath31 is a _ kasteleyn orientation on @xmath238 _ if it has zero curvature .    as usual",
    ", we shall say that two orientations are _ equivalent _ if they can be obtained from each other by flipping the edge orientations around a set of vertices .",
    "if @xmath31 is kasteleyn , and @xmath130 is equivalent to @xmath31 , then @xmath130 is obviously kasteleyn",
    ". we shall denote by @xmath239 the set of equivalence classes of kasteleyn orientation on @xmath238 .",
    "recall that a surface @xmath1 is orientable if and only if @xmath224 vanishes . in this case",
    ", @xmath240 provides a natural choice , and a kasteleyn orientation on @xmath241 is simply a kasteleyn orientation on @xmath97 as defined in section  [ sub : kast ] .",
    "therefore , @xmath242 is nothing but @xmath98 .",
    "once again , sections  [ sec : kast - n ] to [ sec : pf - n ] should be understood as a generalization of the previous one , which corresponds to the case @xmath240 .",
    "[ rem : kast ] when working with examples , it is often convenient to represent the surface @xmath1 as a planar polygon @xmath243 with some pairs of sides identified , and to draw @xmath0 in @xmath243 intersecting @xmath244 transversally .",
    "such a representation of @xmath97 induces a natural cocycle @xmath223 representing the first stiefel - whitney class of @xmath1 : let us call a side of @xmath244 a _",
    "1-side _ if the corresponding identification does not preserve the orientation of @xmath243 . for an edge @xmath34 of @xmath0",
    ", simply define @xmath245 to be the parity of the intersection number of @xmath34 with all the 1-sides of @xmath243 .    for this @xmath225 , it is easy to check whether a given orientation @xmath31 of @xmath0 is kasteleyn or not : take one counterclockwise - oriented copy of @xmath246 with vertices labelled @xmath228 , one clockwise - oriented copy of @xmath246 with vertices labelled @xmath229 , glue these two polygons along their 1-sides according to the prescribed identifications , and make the remaining side identifications in each copy of @xmath243 .",
    "the result is the oriented surface @xmath220 , where one can compute the kasteleyn curvature .",
    "let us illustrate this on an example .",
    "let @xmath243 denote the model of the klein bottle @xmath247 given by a hexagone with sides identified according to the word @xmath248 .",
    "note that the 1-sides are exactly the four sides of @xmath244 corresponding to the letters @xmath249 and @xmath250 .",
    "now , consider the square lattice @xmath0 embedded in @xmath243 as illustrated in figure  [ fig : klein ] , and let @xmath97 denote the induced cellular decomposition of @xmath251 .",
    "the graph @xmath0 admits exactly six edges @xmath34 with @xmath252 .",
    "these are the six edges crossing the 1-sides of @xmath244 .",
    "one easily checks that the orientation of the edges of @xmath0 given by the arrows in figure  [ fig : klein ] is a kasteleyn orientation on @xmath238 .",
    "2.5pt at 330 420 at 114 420 at 465 220 at -30 220 at 330 10 at 114 10      the main result of this section is the following generalization of proposition  [ prop : kast ] .",
    "[ thm : kast - n ] there exists a kasteleyn orientation on @xmath238 if and only if @xmath97 has an even number of vertices . in this case",
    ", @xmath239 is an @xmath99-torsor .",
    "the proof of the first part will rely on the following result .",
    "[ lemma : parity ] given any orientation @xmath31 of @xmath0 and any @xmath223 representing @xmath224 , the sum @xmath253 has the same parity as the number of vertices of @xmath0 .    throughout this demonstration ,",
    "all integers and equalities are to be considered modulo 2 .",
    "let @xmath100 ( resp .",
    "@xmath254 ) denote the number of vertices ( resp .",
    "0-edges , 1-edges , faces ) in @xmath238 . given a face @xmath231 of @xmath220 ,",
    "let @xmath255 be the number of clockwise - oriented edges in @xmath233 joining two vertices labelled @xmath228 .",
    "similarly , let @xmath256 be the number of counterclockwise - oriented edges in @xmath233 joining two vertices labelled @xmath229 .",
    "finally , let @xmath257 be the number of 1-edges in @xmath93 oriented in a fixed direction around @xmath90 .",
    "( since @xmath93 has an even number of 1-edges , this number is independent of the choice of this direction . )",
    "fixing a lift @xmath231 of each face @xmath90 of @xmath97 , we can compute @xmath258 each 0-edge contributes exactly 1 in the first sum of the right - hand side , which is therefore equal to @xmath259 .",
    "it remains to check that the second sum is equal to @xmath260 , as it implies @xmath261 first note that @xmath262 is independent of @xmath31 : indeed , reversing @xmath31 along an edge changes the contribution to @xmath107 of both adjacent faces .",
    "hence , it can be assumed that @xmath31 is the orientation given by a global numbering of the vertices of @xmath97 .",
    "furthermore , one easily checks that @xmath107 remains constant when an edge @xmath34 is added that subdivides a face @xmath90 of @xmath97 in two .",
    "( note that @xmath245 is determined by @xmath263 for @xmath264 . )",
    "therefore , we can assume that @xmath97 is a triangulation of @xmath5 .",
    "but for a triangular face @xmath90 , and with @xmath31 as above , the cup product @xmath265 satisfies @xmath266 summing over all faces , and using the fact that @xmath267 , we obtain the equality @xmath268 which concludes the proof .    given any orientation @xmath31 of @xmath0 , let @xmath269 be its kasteleyn curvature .",
    "@xmath31 is kasteleyn if and only if @xmath270 , in which case the number of vertices @xmath100 of @xmath0 is even by lemma [ lemma : parity ] .",
    "conversely , if @xmath100 is even , then @xmath271 by the same lemma .",
    "this implies that @xmath272 is a coboundary , that is , there exists a @xmath273 such that @xmath274 .",
    "consider now the orientation @xmath275 which coincides with @xmath31 on an edge @xmath34 if and only if @xmath276",
    ". given any face @xmath90 of @xmath97 , we have the following equality modulo 2 : @xmath277 since @xmath274 , it follows that @xmath278 , that is , @xmath275 is a kasteleyn orientation .",
    "let us now prove the second statement , assuming that @xmath239 is non - empty .",
    "the action of an element @xmath279\\in{h^1(\\sigma;{\\mathbb z}_2)}=h^1(x;{\\mathbb z}_2)$ ] on @xmath186\\in{\\mathcal k}(x,\\omega)$ ] is defined by @xmath186+[\\phi]=[k^\\phi]$ ] , with @xmath275 as above . since @xmath280 is a cocycle ,",
    "the equation displayed above shows that @xmath275 is kasteleyn if and only if @xmath31 is .",
    "note also that @xmath275 is equivalent to @xmath31 if and only if @xmath280 is a coboundary .",
    "therefore , this action of @xmath202 on @xmath239 is well - defined , and free .",
    "finally , given two kasteleyn orientations @xmath31 and @xmath130 , let @xmath280 denote the 1-cochain taking value @xmath281 on an edge @xmath34 if and only if @xmath31 and @xmath130 agree on @xmath34 . obviously , @xmath282 , and @xmath280 is a cocycle by the identity displayed above .",
    "therefore , the action is freely transitive .    by the proof of lemma  [ lemma : parity ]",
    ", the ultimate reason for the existence of a kasteleyn orientation on @xmath97 is the vanishing of the cohomology class @xmath283 in @xmath284 .",
    "this is nothing but the obstruction to the existence of a @xmath2 structure on the manifold @xmath1 .",
    "the proof of this theorem actually provides us with an algorithm to construct all equivalence classes of kasteleyn orientations on a given surface graph @xmath238 with an even number of vertices .",
    "start with any orientation @xmath102 of @xmath0 , and compute its kasteleyn curvature @xmath285 , for example , using remark [ rem : kast ] .    by lemma  [ lemma : parity ] ,",
    "@xmath286 for an even number of faces .",
    "pick two of them , join their interior with a curve @xmath287 in @xmath1 intersecting @xmath0 transversally , and invert the orientation of an edge of @xmath0 each time it crosses @xmath287 .",
    "the kasteleyn curvature of the resulting orientation vanishes at these two faces , and remains unchanged elsewhere .",
    "this inductively leads to a kasteleyn orientation @xmath31 .    to construct the other kasteleyn orientations ,",
    "consider a family of closed curves @xmath288 intersecting @xmath0 transversally , and representing a basis of @xmath30 . for any subset @xmath289 , let @xmath290 denote the orientation obtained from @xmath31 by inverting the orientation of an edge of @xmath0 each time it crosses some @xmath28 with @xmath291 .",
    "these @xmath290 represent all equivalence classes of kasteleyn orientations on @xmath238 .",
    "the definition of a kasteleyn orientation depends on the choice of the cocycle @xmath225 representing the first stiefel - whitney class of @xmath1 .",
    "however , two such choices can be naturally related as follows .",
    "[ prop : omega ] given @xmath292 representing the first stiefel - whitney class @xmath224 , there is an @xmath202-equivariant bijection @xmath293 which satisfies the relations @xmath294 and @xmath295 .",
    "let @xmath296 be two representatives of @xmath224 .",
    "since @xmath225 and @xmath297 are cohomologous , they can be obtained from one another by flipping all @xmath281 s and @xmath135 s around the vertices in some set @xmath107 . to prove the proposition , it is enough to check that flipping around one vertex @xmath298 induces an @xmath202-equivariant map @xmath299 such that @xmath300 and @xmath301 for any two vertices @xmath302 .",
    "indeed , we can then define @xmath303 as the composition ( in any order ) of all the @xmath304 s with @xmath305 .",
    "let @xmath304 be defined by @xmath306)=[k']$ ] , where @xmath130 agrees with @xmath31 on an edge @xmath34 unless @xmath307 and @xmath252 .",
    "it is easy but tedious to check that if @xmath31 is kasteleyn on @xmath238 , then @xmath130 is kasteleyn on @xmath308 . on the other hand , it is then obvious that @xmath304 is a well - defined equivariant map .",
    "the identity @xmath301 is also immediate .",
    "finally , @xmath309 maps @xmath186 $ ] to the class of @xmath310 , the orientation obtained from @xmath31 by flipping the orientations of all the edges adjacent to @xmath298 .",
    "hence , @xmath310 and @xmath31 are equivalent , so @xmath309 is the identity .",
    "we shall now informally review several general facts about @xmath2 structures , which are the natural generalization of spin structures to non - orientable manifolds .",
    "we refer to @xcite for details and proofs .",
    "recall that @xmath312 is a topological group which is a double cover of the orthogonal group @xmath313 .",
    "@xmath314 structure _ on an n - dimensional riemannian manifold @xmath315 is a @xmath2 structure on its frame bundle @xmath316 , that is , a principal @xmath312-bundle @xmath317 together with a 2-fold covering map @xmath318 which restricts to @xmath319 on each fiber .",
    "the obstruction to putting a @xmath2 structure on @xmath315 is @xmath320 . if this class vanishes , then the set @xmath321 of equivalence classes of @xmath2 structures on @xmath315 is an @xmath322-torsor .",
    "the following special case of ( * ? ? ?",
    "* lemma 1.7 ) will be essential for our purpose : there is an @xmath322-equivariant bijection between @xmath321 and the set of equivalence classes of spin structures on @xmath323 , where @xmath9 denotes the tangent bundle of @xmath315 and @xmath324 the determinant line bundle .",
    "( note that @xmath324 is simply the line bundle corresponding to the orientation cover @xmath325 viewed as a principal @xmath326-bundle . )",
    "the 2-dimensional case is particularly easy to deal with .",
    "first of all , any compact surface @xmath1 admits a @xmath2 structure , as @xmath327 and @xmath328 are both equal to the euler characteristic of @xmath1 modulo 2 .",
    "hence , the set @xmath329 is an @xmath202-torsor .",
    "furthermore , a spin structure on @xmath323 is nothing but a trivialisation of this bundle .",
    "let @xmath330 denote the determinant line bundle , and let @xmath331 be the tangent bundle of its total space . by the following commutative diagram of bundles , @xmath332 \\ar[d]_p & e(\\xi\\oplus\\lambda ) \\ar[d]^{\\xi\\oplus\\lambda}\\\\ e(\\lambda )",
    "\\ar[r]^\\lambda & { \\sigma}}\\ ] ] @xmath333 is the restriction of the tangent bundle of @xmath334 to @xmath1 .",
    "( here , @xmath1 embeds in @xmath334 as the 0-section of @xmath335 . ) therefore , a @xmath2 structure on a surface @xmath1 is a trivialisation over @xmath1 of the vector bundle @xmath336 .",
    "finally , johnson s theorem @xcite generalizes to non - orientable surfaces as follows .",
    "( again , we refer to @xcite for a proof . ) a function @xmath337 is called a _ quadratic enhancement _ of the intersection form if @xmath338 for all @xmath339 , where @xmath117 denotes the intersection form , and @xmath340 the inclusion homomorphism .",
    "one easily checks that the set @xmath341 of such quadratic enhancements admits a freely transitive action of @xmath342 given by @xmath343 . the statement generalizing johnson s theorem is the following : there is an @xmath202-equivariant bijection @xmath344 .",
    "more explicitely , consider an element of @xmath329 , that is , a trivialisation of the tangent bundle @xmath331 over @xmath1 .",
    "then , the corresponding quadratic enhancement @xmath337 is determined by its value on the class of an embedded circle @xmath86 in @xmath1 ; this value is obtained as follows .",
    "let @xmath345 denote the restriction of @xmath346 to @xmath347 .",
    "obviously , the @xmath2 structure induces a trivialisation @xmath348 of @xmath345 .",
    "note also that @xmath349 , where @xmath350 denotes the normal bundle .",
    "pick @xmath351 , and orient these three line bundles at @xmath352 so that the induced orientation on @xmath345 agrees with the one given by @xmath348 .",
    "now , the orientation of @xmath353 determines a trivialisation @xmath63 of this line bundle .",
    "pick a framing @xmath354 of @xmath355 such that @xmath356 is homotopic to @xmath348 . then , @xmath357)$ ] is given by the class modulo 4 of @xmath358 , where @xmath359 denotes the number of right half twists that @xmath360 makes with respect to @xmath354 in a complete traverse of @xmath86 .",
    "let us try to encode combinatorially a @xmath2 structure on a surface @xmath1 , that is , a trivialisation of @xmath336 over @xmath1 .",
    "first note that , if @xmath361 denotes the involution of the orientation cover of @xmath1 , then @xmath334 can be expressed as the quotient of @xmath362 by the action of @xmath363 .",
    "therefore , a @xmath2 structure on @xmath1 is equivalent to a trivialisation of @xmath364 , invariant under the action of @xmath365 .",
    "this is what we will encode .",
    "fix a cellular decomposition @xmath97 of @xmath1 and a representative @xmath223 of @xmath224 .",
    "as mentioned in section  [ sec : kast - n ] , @xmath225 determines a labelling of the vertices of @xmath220 with signs , such that @xmath227 if and only if the two endpoints of a lift of @xmath34 have the same label .",
    "this in turn induces an orientation on @xmath220 .",
    "@xmath125 to construct a framing of @xmath364 over @xmath366 , fix a dimer configuration @xmath70 on @xmath126 .",
    "this lifts to a dimer configuration @xmath367 on @xmath368 which determines a ( unit length ) vector field @xmath369 along vertices of @xmath370 .",
    "it can be completed by a vector field @xmath371 , so that @xmath372 is a positive orthonormal basis of @xmath373 and @xmath374 is a negative orthonormal basis of @xmath375 .",
    "setting @xmath376 gives a framing @xmath377 of @xmath364 over @xmath366 , which is clearly invariant under the action of @xmath378 .",
    "2.5pt at 315 60 at 120 35 at 535 130 at 135 100 at 525 80 at 100 140 at 100 370 at 135 325 at 525 300 at 110 270 at 193 292 at 162 395    @xmath125 to extend this framing to the 1-skeleton of @xmath370 , fix an orientation @xmath31 of the edges of @xmath126 .",
    "if @xmath34 denotes a 0-edge oriented from a vertex @xmath352 to a vertex @xmath379 , then the framing along the lift @xmath380 between @xmath381 and @xmath382 is defined as follows . moving along @xmath380 ,",
    "first make a right - hand rotation of the framing around the axis @xmath383 until @xmath369 points in the direction of the edge ; then make a left - handed half twist around @xmath383 so that @xmath369 points backward ; finally , make a right - hand rotation around @xmath383 until @xmath369 coincides with @xmath384 .",
    "this construction is illustrated in figure  [ fig:0-edge ] .",
    "if @xmath34 denotes a 1-edge oriented from @xmath352 to @xmath379 , then the framing along @xmath380 between @xmath381 and @xmath385 is defined as follows .",
    "first make a right - hand rotation around the axis @xmath383 until @xmath369 points in the direction of the edge ; then make a right - handed half twist around @xmath371 ; finally , make a left - hand rotation around @xmath383 until @xmath369 coincides with @xmath386 .",
    "this is illustrated in figure  [ fig:1-edge ] .",
    "2.5pt at 380 40 at 170 95 at 590 36 at 127 62 at 634 62 at 80 115 at 80 305 at 135 230 at 625 260 at 125 295 at 70 225 at 150 335    @xmath125 given a cocycle @xmath225 , a dimer configuration @xmath70 on @xmath126 and an orientation @xmath31 of the edges of @xmath126 , we now have a well - defined framing @xmath387 of @xmath364 over @xmath368 , invariant under the action of @xmath378 , which we wish to extend to the whole of @xmath220 .",
    "let @xmath231 be a face of @xmath370 , and let us fix a constant framing of @xmath388 over @xmath231 .",
    "then , the restriction of @xmath348 to @xmath233 defines a loop @xmath389 in @xmath390 .",
    "the framing @xmath348 extends to @xmath231 if and only if the homotopy class @xmath391 $ ] is trivial in @xmath392 .",
    "we shall simply denote by @xmath393 $ ] this class in @xmath394 .",
    "[ prop : curvature ] given any face @xmath90 of @xmath97 and any lift @xmath395 of @xmath90 in @xmath370 , @xmath396 $ ] is equal to the kasteleyn curvature @xmath237 .",
    "hence , @xmath348 extends to @xmath370 if and only if @xmath31 is a kasteleyn orientation .    given a face @xmath90 of @xmath97 , recall that @xmath397 where @xmath231 is any lift of @xmath90 .",
    "first observe that @xmath393 $ ] changes when @xmath31 is inverted on one edge of @xmath93 .",
    "since the same obviously holds for @xmath398 , it may be assumed that all edges in @xmath233 are oriented counterclockwise , except those joining two vertices labelled with @xmath229 .",
    "( in this case , we shall say that @xmath233 is well - oriented . )",
    "it remains to check that @xmath393=1 $ ] whenever @xmath93 is well - oriented .",
    "let us prove this by induction on @xmath399 , the number of edges in @xmath233 .",
    "a face @xmath90 with @xmath400 boundary edges is well - oriented if and only if these edges do not have the same orientation .",
    "if they do have the same orientation , then the framing obviously extends to the whole of @xmath231 , so that @xmath393=0 $ ] . by the observation above",
    ", it follows that @xmath393=1 $ ] if @xmath93 is well - oriented .",
    "the case @xmath401 can be checked by direct inspection .",
    "consider now a face @xmath231 with @xmath402 boundary edges .",
    "using one more time the observation above , we have @xmath403= \\left[\\begin{array}{c}\\includegraphics[height=0.3in]{c6.eps}\\end{array}\\right]= \\left[\\begin{array}{c}\\includegraphics[height=0.3in]{c7.eps}\\end{array}\\right]= \\left[\\begin{array}{c}\\includegraphics[height=0.3in]{c8.eps}\\end{array}\\right]+ \\left[\\begin{array}{c}\\includegraphics[height=0.3in]{c9.eps}\\end{array}\\right]= \\left[\\begin{array}{c}\\includegraphics[height=0.3in]{c8.eps}\\end{array}\\right]+ \\left[\\begin{array}{c}\\includegraphics[height=0.3in]{c10.eps}\\end{array}\\right]+1,\\ ] ] where the orientation of the new edge is chosen so that the resulting triangle is well - oriented . by induction , @xmath393=1 + 1 + 1=1 $ ] , and we are done .    therefore , a dimer configuration @xmath70 on @xmath126 and a kasteleyn orientation @xmath31 on @xmath238 determine a @xmath2 structure on @xmath1 , that is , a quadratic enhancement that we shall denote by @xmath404 .",
    "it is characterized by the following property .",
    "[ prop : quad - en ] let @xmath86 be an oriented simple closed curve on @xmath126 .",
    "then , @xmath405)=2(n^k(c)+\\ell^\\omega_d(c)+1)+\\omega(d\\cap c)-\\omega(c\\setminus d)\\pmod{4},\\ ] ] where @xmath406 denotes the number of vertices @xmath352 in @xmath86 such that the following condition holds : @xmath407 induces a local orientation at @xmath408 which lifts to the positive orientation of @xmath409 at @xmath410 ( or equivalently , to the negative one at @xmath411 ) .",
    "let @xmath387 denote the framing of @xmath364 over a lift @xmath412 of @xmath86 , as constructed above .",
    "let @xmath354 be a trivialisation of @xmath413 such that @xmath348 is homotopic to @xmath356 , where @xmath63 denotes the trivialisation of @xmath414 given by the orientation of @xmath412 .",
    "then , @xmath415)$ ] is equal to the class modulo 4 of @xmath416 , where @xmath417 denotes the number of right half twists that @xmath418 makes with respect to @xmath354 in a complete traverse of @xmath174 .",
    "hence , we are left with the proof of the equality @xmath419 note that this equation makes sense for any orientation @xmath31 of the edges of @xmath126 , not only for kasteleyn orientations ; we shall prove it for every orientation .",
    "note also that if @xmath348 and @xmath420 denote two framings over @xmath412 , then they define a loop in @xmath390 , and the difference @xmath421 is equal to twice the class of this loop in @xmath392 . in particular ,",
    "if @xmath102 is obtained by reversing the orientation @xmath31 on one edge of @xmath86 , and @xmath422 denote the induced framings over @xmath412 , then @xmath423 by the observation at the beginning of the proof of proposition  [ prop : curvature ] . hence , @xmath424 changes by @xmath425 when @xmath31 is inverted along one edge of @xmath86 .",
    "since the same obviously holds for the right - hand side of @xmath426 , it may be assumed that @xmath146 .",
    "furthermore , @xmath424 also changes by @xmath425 when a dimer of @xmath427 pointing out to the left of @xmath174 at a vertex @xmath410 ( resp . to the right of @xmath174 at a vertex @xmath411 ) is replaced by a dimer pointing out to the right of @xmath174 ( resp . to the left ) .",
    "this follows from the following computation , which makes use of proposition  [ prop : curvature ] : @xmath428{d1.eps}\\end{array}\\right)- h_{s_0'}\\left(\\begin{array}{c}\\includegraphics[width=0.5in]{d2.eps}\\end{array}\\right)= 2\\left[\\begin{array}{c}\\includegraphics[width=0.5in]{d3.eps}\\end{array}\\right]= 2\\ , c^k\\left(\\begin{array}{c}\\includegraphics[width=0.5in]{d4.eps}\\end{array}\\right)=2.\\ ] ] since the same holds for the right - hand side of @xmath426 , it may be assumed that @xmath429 .",
    "similar arguments allow us to assume that no dimer of @xmath70 lies in @xmath86 , so that @xmath430 and @xmath431 .",
    "hence , it may be assumed that @xmath31 agrees everywhere with the orientation on @xmath86 , and that the dimer of @xmath70 adjacent to a vertex @xmath351 always lies outside @xmath86 , so that the local orientation at @xmath351 induced by @xmath407 lifts to the negative orientation at @xmath410 ( and the positive one at @xmath411 ) .",
    "but in this case , the framing constructed in figure  [ fig:0-edge ] along the 0-edges is homotopic to a constant framing .",
    "also , the framing constructed in figure  [ fig:1-edge ] along the 1-edges is homotopic to a framing of the form @xmath356 , with @xmath354 making one right half twist along each",
    "1-edge . therefore , @xmath432 , and the proposition is proved .",
    "we can now state our correspondence theorem , which generalizes theorem  [ thm : corr ] to the ( possibly ) non - orientable case .",
    "[ thm : n - corr ] let @xmath97 be a cellular decomposition of a closed surface @xmath1 , and let @xmath223 be a representative of the first stiefel - whitney class @xmath224 .",
    "then , any dimer configuration @xmath150 induces an @xmath99-equivariant bijection @xmath433\\mapsto q_d^{k,\\omega}\\ ] ] from the set of equivalence classes of kasteleyn orientations on @xmath238 to the set of equivalence classes of @xmath314 structures on @xmath1 .",
    "furthermore , given another dimer configuration @xmath152 , @xmath434 is obtained from @xmath435 by action of the poincar dual to @xmath155\\in h_1({\\sigma};{\\mathbb z}_2)$ ] .",
    "finally , given another representative @xmath297 of @xmath224 , the following diagram is commutative , @xmath436^{\\varphi_{\\omega'\\omega } } \\ar[dr]_{\\psi^\\omega_d } & & { \\mathcal k}(x,\\omega ' ) \\ar[dl]^{\\psi^{\\omega'}_d } \\\\ & \\mathrm{pin}^-({\\sigma } ) } \\\\\\ ] ] where @xmath303 is the equivariant bijection defined in proposition  [ prop : omega ] .    given fixed @xmath223 and @xmath150 , the construction above associates to each kasteleyn orientation @xmath31 on @xmath238 a quadratic enhancement @xmath437 which is determined by the equality in proposition  [ prop : quad - en ] .",
    "therefore , we only need to check our statements for the evaluation of these quadratic enhancements on the homology class of simple closed curves in @xmath126 .    if @xmath130 is equivalent to @xmath31 , then @xmath438 for any oriented simple closed curve @xmath86 in @xmath126 .",
    "therefore , @xmath439 is equal to @xmath440 and we have a well - defined map @xmath441 .",
    "furthermore , if @xmath275 is the orientation obtained from @xmath31 by action of a cocycle @xmath273  recall the proof of theorem  [ thm : kast - n ] ",
    "then @xmath442 . hence , @xmath443 $ ] , so @xmath435 is @xmath202-equivariant .",
    "now , let @xmath80 be two dimer configurations on @xmath126 , and consider the associated quadratic enhancements @xmath440 and @xmath444 .",
    "for an oriented simple closed curve @xmath86 in @xmath126 , proposition  [ prop : quad - en ] leads to the equality @xmath445)\\equiv 2(\\ell^\\omega_{d'}(c)+\\ell^\\omega_d(c)+\\omega(c\\cap(d+d')))\\pmod{4},\\ ] ] where @xmath81 denotes the disjoint simple cycles obtained by adding @xmath446 .",
    "using the definition of @xmath406 , one checks that @xmath447 therefore , @xmath448^\\ast$ ] , showing the second claim .",
    "let us finally prove the equality @xmath449 . by construction of @xmath303 ,",
    "one only needs to check the following : given a kasteleyn orientation @xmath31 on @xmath238 , an oriented simple closed curve @xmath86 in @xmath126 , and a vertex @xmath351 , we have the equality @xmath450)=q^{k',\\omega'}_d([c])$ ] , where @xmath297 is obtained from @xmath225 by changing the @xmath281 s and @xmath135 s labelling all edges adjacent to @xmath352 , and @xmath130 is obtained from @xmath31 by inverting the orientation of all the edges @xmath34 adjacent to @xmath352 such that @xmath252 . by proposition  [ prop : quad - en ] , the difference @xmath451)-q^{k',\\omega'}_d([c])\\in{\\mathbb z}_4 $ ] is given by @xmath452 the first term above is equal to @xmath453 , where @xmath454 denote the two edges of @xmath86 adjacent to @xmath352 .",
    "if neither @xmath455 nor @xmath456 is a dimer of @xmath70 , then @xmath457 each of these terms is equal to @xmath458 , so the sum is zero modulo 4 . on the other hand , if one of these edges ( say , @xmath455 ) is a dimer of @xmath70 , then @xmath459 each of these terms is equal to @xmath135 , so the difference is zero .",
    "as stated above , the correspondence depends on the choice of @xmath150 .",
    "this can be remedied as follows .",
    "let @xmath156 denote a family of closed curves in @xmath1 , transverse to @xmath126 , whose classes form a basis of @xmath12 . given any @xmath150 , let @xmath157 be given by @xmath158)=\\alpha_i\\cdot d$ ] .",
    "finally , define @xmath460 by the equality @xmath461 .",
    "[ cor : n - corr ] let @xmath97 be a cellular decomposition of a closed surface @xmath1 such that @xmath126 admits a dimer configuration @xmath70 , and let @xmath223 be a representative of the first stiefel - whitney class @xmath224 .",
    "then , the map @xmath462\\mapsto q_\\mathcal{b}^{k,\\omega}\\ ] ] is an @xmath99-equivariant bijection which does not depend on @xmath70 .",
    "furthermore , given another representative @xmath297 of @xmath224 , we have the equality @xmath463 .",
    "the demonstration of corollary  [ cor : corr ] extends verbatim .",
    "we shall now use the previous section to derive the pfaffian formula in the general case of a graph embedded in a possibly non - orientable surface .    let @xmath0 be a finite connected graph endowed with an edge weight system @xmath46 . if @xmath0 does not admit any dimer configuration , then the partition function vanishes .",
    "let us therefore assume that @xmath0 admits a dimer configuration @xmath181 .",
    "enumerate the vertices of @xmath0 by @xmath51 and embed @xmath0 in a closed surface @xmath1 as the 1-skeleton of a cellular decomposition @xmath97 of @xmath1 .",
    "finally , let us fix an @xmath223 representing the first stiefel - whitney class of @xmath1 .",
    "since @xmath0 has an even number of vertices , theorem  [ thm : kast - n ] ensures that the set @xmath239 is an @xmath99-torsor . in particular , there exists a kasteleyn orientation @xmath31 on @xmath238 .",
    "we define an associated skew - symmetric matrix @xmath464 as follows : its coefficients are given by @xmath465 where the sum is on all edges @xmath34 in @xmath38 between the vertices @xmath56 and @xmath466 , and @xmath467 ( resp .",
    "@xmath468 ) if @xmath34 is oriented by @xmath31 from @xmath56 to @xmath466 ( resp . from @xmath466 to @xmath56 ) . in short ,",
    "it is exactly the matrix defined by kasteleyn , but with all weights of the 1-edges multiplied by @xmath469 .",
    "given a dimer configuration @xmath70 , we shall simply denote by @xmath470 the sum @xmath471 .",
    "recall also the notation @xmath472 introduced in ( [ equ : eps ] ) .    finally , recall that any quadratic enhancement @xmath473 of a non - singular bilinear form on a @xmath394-vector space @xmath100 has a well - defined _ brown invariant _",
    "@xmath474 ( see e.g.  @xcite ) .",
    "it is given by the equality @xmath475    [ thm : pf - n ] the partition function of the dimer model on @xmath38 is given by the formula @xmath476\\in{\\mathcal k}(x,\\omega ) } \\exp(i\\pi/4)^{\\beta(q^{k,\\omega}_{d_0})}{\\varepsilon}^k(d_0){\\mbox{pf}}(a^{k,\\omega}),\\ ] ] where @xmath14 and @xmath477 denotes the brown invariant of the quadratic enhancement @xmath194 .",
    "furthermore , each term of this sum depends only on the class of @xmath31 in @xmath239 , but neither on the choice of a representative of this class , nor on the choice of @xmath181 .    given any kasteleyn orientation @xmath31 of @xmath0",
    ", we have @xmath478 where the @xmath479 s are the disjoint cycles forming @xmath480 . at any vertex of @xmath479 ,",
    "the adjacent dimer of @xmath181 lies on @xmath479 , so @xmath481 .",
    "since the cycles @xmath479 are disjoint , proposition  [ prop : quad - en ] gives @xmath482 ) = -q^{k,\\omega}_{d_0}([d+d_0]).\\ ] ] therefore , every element @xmath186 $ ] of @xmath239 induces a linear equation @xmath483 where @xmath188=\\alpha}\\mathrm{w}(d)$ ] , the sum being over all @xmath189 such that @xmath190=\\alpha$ ] .",
    "one can solve this linear system of @xmath484 equations with @xmath484 unknowns as in ( * ? ? ?",
    "* theorem 5 ) , obtaining @xmath485}i^{q^{k,\\omega}_{d_0}(\\alpha)}{\\varepsilon}^{k}(d_0)i^{-\\omega(d_0)}{\\mbox{pf}}(a^{k,\\omega}).\\ ] ] the final formula for @xmath50 is now obtained by summing over all @xmath486 , and using the definition of the brown invariant .    if @xmath31 and @xmath130 are equivalent kasteleyn orientations , then @xmath487 .",
    "in particular , these two quadratic enhancements have the same brown invariant . on the other hand , @xmath488 and @xmath489 , where @xmath490 is the number of vertices of @xmath38 around which the orientation was flipped .",
    "therefore , the term corresponding to @xmath186 $ ] in the statement of the theorem does not depend on the choice of the representative in the equivalence class @xmath186 $ ] .",
    "let us finally check that the coefficient @xmath491 does not depend on @xmath181 . let @xmath70 be another dimer configuration on @xmath38 . by ( * ? ? ?",
    "* lemma 3.7 ) ( where the sign needs to be corrected ) , and by the second part of theorem  [ thm : n - corr ] , @xmath492).\\ ] ] on the other hand , we know by the beginning of the proof that @xmath493)}\\ ] ] this concludes the proof of the theorem",
    ".    note that for any fixed @xmath181 , one can always find an @xmath225 such that @xmath494 .",
    "furthermore , for any equivalence classe in @xmath239 , one can choose its representative @xmath31 to satisfy @xmath196 .",
    "this leads to the formula stated in the introduction : @xmath13 where @xmath18 is @xmath464 for any kasteleyn orientation @xmath31 on @xmath238 such that @xmath495 and @xmath196 .",
    "of course , the right - hand side of the equality in theorem  [ thm : pf - n ] does not depend on the choice of @xmath225 representing @xmath224 , as the left - hand side does not . using the last part of theorem  [ thm : n - corr ]",
    ", one can make this statement a little more precise .",
    "given any two choices @xmath292 , let @xmath496 be the equivariant bijection of proposition  [ prop : omega ] .",
    "then , the summand corresponding to @xmath186 $ ] in the pfaffian formula given by @xmath225 is equal to the summand corresponding to @xmath497)$ ] in the pfaffian formula given by @xmath297 .      if @xmath498 is odd , then @xmath1 is the connected sum of an orientable surface @xmath20 of genus @xmath499 with a projective plane @xmath500 . a matrix of the modulo 2 intersection form is given by @xmath501 .",
    "let @xmath503 be a set of simple closed curves on @xmath1 , transverse to @xmath0 , whose classes form a basis of @xmath25 . if @xmath1 has odd ( resp . even ) euler characteristic , we also fix one simple closed curve @xmath37 ( resp .",
    "two disjoint simple closed curves @xmath27 ) on @xmath1 , transverse to @xmath0 , disjoint from the @xmath504 s , whose class forms a basis of @xmath505 ( resp .",
    "@xmath29 ) in @xmath30 . define @xmath223 by @xmath506 .",
    "it clearly represents the first stiefel - whitney class of @xmath1 .",
    "fix a kasteleyn orientation @xmath31 on @xmath238 so that @xmath507 is odd for each @xmath508 , where @xmath509 is an oriented closed curve in @xmath0 associated to @xmath287 as follows .",
    "let @xmath510 denote the surface graph @xmath511 cut along @xmath512 , and endow @xmath513 with the counterclockwise orientation .",
    "for @xmath514 , @xmath509 is the oriented 1-cycle in @xmath515 having @xmath504 to its immediate left , meeting every vertex of @xmath516 adjacent to @xmath504 on this side .",
    "( moving @xmath517 if needed , it may be assumed that @xmath509 is disjoint from @xmath512 so that @xmath509 is a 1-cycle in @xmath518 . ) for @xmath519 , @xmath509 is the oriented 1-cycle in @xmath0 given by one edge @xmath34 of @xmath0 intersecting @xmath517 once , together with the oriented curve in @xmath518 joining the two endpoints of @xmath34 in @xmath518 and having @xmath517 to its immediate left in @xmath513 .",
    "( if @xmath498 is even , it may be assumed that @xmath520 is disjoint from @xmath521 for @xmath522 . )    for any @xmath32 , let @xmath523 denote the kasteleyn orientation obtained from @xmath31 by inverting the orientation @xmath31 on the edge @xmath34 of @xmath0 each time @xmath34 intersects @xmath504 with @xmath524 .",
    "finally , if @xmath1 has even euler characteristic , let @xmath36 be obtained by inverting @xmath33 on @xmath34 each time the edge @xmath34 intersects @xmath37 .",
    "[ thm : pf-n ] let @xmath0 be a graph embedded in a closed non - orientable surface @xmath1 such that @xmath19 consists of open 2-discs . then",
    ", the partition function of the dimer model on @xmath38 is given by @xmath525 if @xmath526 , and by @xmath527 if @xmath26 .",
    "if @xmath0 does not admit any dimer configuration , then all pfaffians vanish by ( [ equ : pf ] ) and our equalities hold .",
    "therefore , it may be assumed that there exists a @xmath189 . in particular",
    ", @xmath0 has an even number of vertices , so @xmath239 is an @xmath202-torsor by theorem  [ thm : kast - n ] . for @xmath528 ( resp .",
    "@xmath529 ) , let @xmath530 be obtained from @xmath33 by inverting the orientation of an edge each time it intersects @xmath37 with @xmath531 ( resp . and",
    "@xmath532 with @xmath533 ) .",
    "the set @xmath534 clearly contains one element in each equivalence class of kasteleyn orientations . setting @xmath535 and dropping the superscript @xmath225 s , theorem  [ thm : pf - n ] implies @xmath536 by ( * ? ? ?",
    "* lemma 3.7 ) , @xmath537),\\ ] ] where @xmath538\\in{h_1(\\sigma;{\\mathbb z}_2)}$ ] is determined by the fact that its poincar dual @xmath538^*$ ] satisfies @xmath539^*=q^{k_{{\\epsilon},\\eta}}_d$ ] . by theorem  [ thm : n - corr ] , this is equivalent to requiring that @xmath540^*=k_{{\\epsilon},\\eta}$ ] .",
    "the definition of @xmath530 implies that @xmath541 represents the right homology class .",
    "using the equality @xmath542 and the notation of corollary  [ cor : n - corr ] , we obtain that the coefficient in @xmath543 corresponding to @xmath544 is equal to @xmath545)-4\\delta_{{\\epsilon},\\eta}\\cdot d}=(-i)^{q^k_\\mathcal{b}([\\delta_{{\\epsilon},\\eta}])}.\\ ] ] since @xmath213 is a quadratic enhancement , and given the assumptions on the intersections of the cycles of @xmath546 , it follows @xmath547)= \\sum_j{\\epsilon}_j q^k_\\mathcal{b}([\\alpha_j])+2\\sum_{j < k}{\\epsilon}_j{\\epsilon}_k\\alpha_j\\cdot\\alpha_k+ \\sum_\\ell\\eta_\\ell q^k_\\mathcal{b}([\\beta_\\ell]).\\ ] ] we have chosen @xmath31 precisely so that @xmath548)=0 $ ] and @xmath549)=-1 $ ] . indeed , for @xmath514 , @xmath509 is constructed to satisfy @xmath550 and @xmath227 for any edge @xmath34 of @xmath509 . therefore",
    ", the four terms of the sum @xmath551)=q^k_\\mathcal{b}([c_\\gamma])=2(n^k(c_\\gamma)+1)+2(\\ell^\\omega_d(c_\\gamma)+d\\cdot\\gamma ) + \\omega(d\\cap c_\\gamma)-\\omega(c_\\gamma\\setminus d)\\ ] ] vanish .",
    "similarly , for @xmath519 , @xmath509 is constructed to satisfy @xmath552 , where @xmath553 is the edge @xmath34 of @xmath509 crossing @xmath287 is occupied by a dimer of @xmath70 , and @xmath281 otherwise . since @xmath554 and @xmath507 is odd , it follows that @xmath555)=q^k_\\mathcal{b}([c_\\gamma])$ ] is equal to @xmath468 as claimed .",
    "hence , we have the equality @xmath556 in the case of odd euler characteristic , @xmath557 is nothing but the complex conjugate of @xmath558 .",
    "therefore , @xmath559 the case of even euler characteristic is obtained similarly , using the fact that @xmath560 ( resp .",
    "@xmath561 ) is the complex conjugate of @xmath562 ( resp .",
    "@xmath563 ) .      recall the graph @xmath0 embedded in the klein bottle as illustrated in figure  [ fig : klein ] . with the notation introduced above",
    ", the cycles @xmath37 and @xmath532 can be chosen to be the sides @xmath249 and @xmath250 .",
    "furthermore , we can pick the oriented 1-cycles @xmath564 and @xmath565 as illustrated in figure  [ fig : klein2 ] .",
    "if @xmath31 denotes the kasteleyn orientation given in figure  [ fig : klein ] , then both @xmath566 and @xmath567 are odd as required .",
    "therefore , theorem  [ thm : pf-n ] gives @xmath568 where @xmath130 is obtained from @xmath31 by inverting the orientation of the three edges of @xmath0 that cross @xmath37 .",
    "note that @xmath0 is a bipartite graph , as illustrated in figure  [ fig : klein2 ] .",
    "therefore , the pfaffians can be computed by @xmath569 where @xmath315 is a square matrix of size @xmath466 . in our case , we need to compute the determinant of two square matrices of size @xmath570 ( with @xmath571 non - zero coefficients each ) .",
    "eventually , the number of dimer configurations on the graph @xmath0 is equal to @xmath572 as a point of comparison , the @xmath573-square lattice embedded in the torus ( that is , the graph @xmath38 above , but with the boundary identification @xmath248 replaced by @xmath574 ) has 9922 dimer configurations .",
    "finally , the planar @xmath573-square lattice ( that is , the graph @xmath38 without the edges meeting the boundary of the hexagone ) admits 1183 dimer configurations .",
    "we are grateful to nicolai reshetikhin for suggesting this problem , and for useful discussions .",
    "we also thank sebastian baader , mathieu baillif and giovanni felder .",
    "finally , we thankfully acknowledge the hospitality of the university of aarhus , the louisiana state university baton rouge , and the indiana university bloomington , where parts of this paper were done .",
    "n. dolbilin , yu .",
    "zinovyev , a. mishchenko , m. shtanko and m. shtogrin , homological properties of two - dimensional coverings of lattices on surfaces .",
    "( russian ) funktsional .",
    "i prilozhen .",
    "* 30 * , ( 1996 ) 1933 ; translation in funct .",
    "* 30 * , ( 1996 ) 163173 .",
    "r. kirby and l. taylor , @xmath575 structures on low - dimensional manifolds .",
    "geometry of low - dimensional manifolds , 2 ( durham , 1989 ) , 177242 , london math . soc .",
    "lecture note ser .",
    ", 151 , cambridge univ .",
    "press , cambridge , 1990 ."
  ],
  "abstract_text": [
    "<S> the main result of this paper is a pfaffian formula for the partition function of the dimer model on any graph @xmath0 embedded in a closed , possibly non - orientable surface @xmath1 . </S>",
    "<S> this formula is suitable for computational purposes , and it is obtained using purely geometrical methods . the key step in the proof consists of a correspondence between some orientations on @xmath0 and the set of @xmath2 structures on @xmath1 . </S>",
    "<S> this generalizes ( and simplifies ) the results of a previous paper @xcite . </S>"
  ]
}