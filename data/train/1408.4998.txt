{
  "article_text": [
    "let @xmath1 be a finite index subgroup of @xmath2 , let @xmath3 be a character of @xmath1 with kernel of finite index in  @xmath1 , and let @xmath4 , @xmath5 be the spaces of modular forms , respectively cusp forms for  @xmath1 of weight  @xmath6 and nebentypus @xmath3 .",
    "let @xmath7 be a double coset of @xmath1 inside the commensurator @xmath8 , that is , @xmath9 and the number of right cosets @xmath10 is finite .",
    "we denote by @xmath11 $ ] the associated operator acting on modular forms . in this paper , we give a simple formula for the trace @xmath12 , s_k(\\g,\\chi)+m_k(\\g,\\chi))\\ ; : = \\ ; \\tr([\\ss ] , s_k(\\g,\\chi))\\+\\tr([\\ss ] , m_k(\\g,\\chi))\\;,\\ ] ] under the assumption @xmath13 .",
    "we also assume throughout the paper that @xmath1 , @xmath7 , and @xmath3 are invariant under conjugation by an element @xmath14 with @xmath15 and @xmath16 ( assumption  [ ass3 ] ) , which is needed to avoid the appearance of the trace on the space of anti - holomorphic cusp forms in the trace formulas .",
    "the proof is entirely algebraic , and it is based on the fact that the trace above is the trace of a universal hecke operator acting on the space of ( vector ) period polynomials associated to @xmath5 . for the full modular group , a method for computing algebraically the trace of this hecke operator",
    "was introduced by don zagier more than 20 years ago  @xcite .",
    "together we finalized and sharpened this approach in  @xcite , and in this paper i show that it works in general , using the theory of period polynomials for finite index subgroups developed together with viceniu paol in  @xcite .",
    "zagier s approach can be interpreted as a tool for computing the trace of double coset operators on the parabolic cohomology group @xmath17 for a large class of @xmath18-modules  @xmath19 , as explained in section [ s2 ] .",
    "our results are obtained by taking  @xmath19 to be the module induced from the @xmath1-module  @xmath20 , twisted by @xmath3 , and using the eichler - shimura isomorphism combined with the shapiro lemma , which are reviewed in section [ s2.0 ] .",
    "one could also apply this method to the module @xmath21 , for a representation @xmath22 , to obtain a trace formula for vector valued modular forms , but for simplicity we restrict ourselves to classical modular forms .",
    "the resulting trace formula on @xmath23 is very simple , and , once found , it can be verified to hold for any fuchsian subgroup of the first kind of  @xmath24 and any double coset @xmath25 . indeed , by computing the trace on the eisenstein subspace",
    ", we derive from it a trace formula on the cuspidal subspace as well , which can then be verified by comparison with existing trace formulas in the literature ( see the remark following theorem  [ tf ] ) .",
    "one conclusion can be drawn from the present work that may be useful in higher rank investigations .",
    "as shown in the proof of proposition [ l2.1 ] , the period polynomial space on which we compute the trace is hecke isomorphic with the cohomology with compact support @xmath26 , where @xmath27 is the local system on the compactification @xmath28 associated with the @xmath1-module @xmath29 , with @xmath30 .",
    "this suggests that the most natural object on which to approach the trace formula for other groups is the compactly supported cohomology , which entangles toghether both cuspidal and noncuspidal automorphic forms .    in the remainder of the introduction , we state the trace formula for a general fuchsian subgroup",
    ", we give the proof for congruence subgroups , and then we specialize it to the congruence subgroup @xmath31 to obtain explicit trace formulas in terms of class numbers . as an application ,",
    "we show that the formula for @xmath32 for @xmath33 odd proves a conjecture of cohen @xcite , recently proved by different methods by mertens @xcite .",
    "we end with a comparison of the present work with the existing literature .",
    "although the proof given in this paper applies to finite index subgroups of @xmath18 , the trace formulas we obtain hold in greater generality , so we start in a more general setting .",
    "let @xmath1 be a fuchsian subgroup of the first kind , namely a discrete , finite covolume subgroup of  @xmath24 , and let @xmath25 be a double coset . if @xmath3 is a character of @xmath1 with kernel of finite index , the action of the double coset operator @xmath11 $ ] on @xmath4 is defined using a multiplicative function @xmath34 on the semigroup generated by  @xmath1 and  @xmath7 inside  @xmath35 , such that @xmath36 , namely [ chi ] ( )=^-1()( ) , ,  .",
    "a modular form @xmath37 satisfies @xmath38 , and the double coset @xmath7 defines an operator  @xmath11 $ ] on @xmath4 by [ hecke ] f|[]=_\\ ^k-1 (  ) f|_k  , where @xmath39 , and we write @xmath40 throughout the paper .",
    "we illustrate the definition with two examples.(i ) double coset operators on @xmath41 : @xmath42 , the trivial character of  @xmath1 , and  @xmath34 is constant on primitive double cosets  @xmath43 contained in  @xmath7 ; ( ii ) hecke operators on modular forms for @xmath44 : @xmath3 is a character modulo @xmath45 viewed as a character of @xmath31 by @xmath46 , [ delta ] = _ n:=\\{m_2 ( ) :  = n ,  n|c_ ,  ( a_ , n)=1 } , and @xmath47 for @xmath48 .    to state the trace formula",
    ", we set @xmath49 for any subset @xmath50 of @xmath51 . for a @xmath52-conjugacy class @xmath53 with representative",
    "@xmath54 we denote by @xmath55 the discriminant of the quadratic form associated to @xmath56 , and by @xmath57 the ( possibly infinite ) cardinality of the stabilizer of @xmath56 under conjugation by @xmath52 .",
    "we define the conjugacy class invariant @xmath58 where @xmath59 is the area of a fundamental domain for @xmath1 with respect to the standard hyperbolic metric , @xmath60 denotes the identity matrix ( which we often simply denote by 1 ) , and we use the convention that @xmath61 .",
    "more explicitly , it was shown by oesterl ( * ? ? ?",
    "* proof of theorem 2 ) that any @xmath62 with @xmath63 and @xmath64 falls in one of the following cases : @xmath65 is parabolic fixing a cusp of  @xmath1 ; @xmath65 is hyperbolic with the same fixed points as those of a hyperbolic matrix in @xmath1 ; or @xmath65 is hyperbolic fixing two cusps",
    ". it immediately follows that @xmath66 if @xmath56 falls in the first two cases , and @xmath67 in the last case .",
    "let @xmath68 be the gegenbauer polynomial defined by the power series expansion [",
    "gegen](1-tx + nx^2)^-1= _",
    "w0 p_w(t , n)x^w .",
    "it enters the trace formula because the trace of @xmath69 acting on the symmetric power @xmath70 of the standard representation is @xmath71 .",
    "[ tf ] let @xmath1 be a finite index subgroup of @xmath18 , @xmath6 an integer , @xmath3 a character of @xmath1 with kernel of finite index in @xmath1 , and @xmath7 a double coset of @xmath1 such that @xmath13 . under assumption [ ass3 ] and assuming @xmath72 if @xmath73 , we have [ tff ]    ( [ ] , m_k(,)+ s_k ( , ) ) = _ p_k-2(m _ , m_)(m _ ) _ ( ) + + _ k,2_,*1 * _ \\ (  ) ,    where the sum is over @xmath52-conjugacy classes @xmath74 in @xmath75 with representative @xmath76 .",
    "the symbol @xmath77 is 1 if @xmath78 and 0 otherwise .",
    "we state the theorem under the assumptions used in the proof , but the same formula holds for any fuchsian subgroup of the first kind @xmath1 and any double coset @xmath25 satisfying assumption  [ ass3 ] , with the term on the second line multiplied by 2 if @xmath1 has no cusps . , m_{2-k}(\\g,\\chi)+ s_{2-k}(\\g,\\chi))$ ] for all @xmath6 , with @xmath79 the adjoint of @xmath7 , as shown by shimura @xcite . ]",
    "when @xmath1 has no cusps , formula   contains only elliptic and scalar conjugacy classes , and it is easily seen to agree with formulas available in the literature @xcite . when @xmath1 contains parabolic elements , in theorem  [ tss ] we derive _ from _   a trace formula on the cuspidal subspace alone , which could then be verified by comparison with the literature .",
    "for example , for @xmath80 and @xmath81 , only elliptic and scalar conjugacy classes contribute to  , and the formula agrees with the dimension formula for spaces of modular forms given in  @xcite , and derived using the riemann - roch theorem . in a joint project with zagier , we are hoping to give a direct proof of   for arbitrary  @xmath1 , using the action of hecke operators on the parabolic cohomology of  @xmath1 , rather than of  @xmath18 as in this paper .    in section [ seceis ]",
    "we also compute the trace on the eisenstein subspace for a fuchsian subgroup of the first kind , and we compare it with the sum over hyperbolic conjugacy classes in .",
    "we thus obtain a trace formula on the cuspidal subspace as well .",
    "to state it , let @xmath82 and @xmath83 be the stabilizers of a cusp @xmath84 of @xmath1 .",
    "let @xmath85 be a set of representatives for the @xmath1-equivalence classes of cusps and define the subset @xmath86 where @xmath87 denotes the sign of the eigenvalues of a parabolic or hyperbolic matrix @xmath88 .",
    "[ tss ] let @xmath1 be a fuchsian subgroup of the first kind with cusps , and let @xmath25 be a double coset .",
    "then the trace formula is equivalent to [ tfs2 ]    ( [ ] , s_k(,))= _ p_k-2(m _ , m _ ) ( m _ ) _",
    "( ) + - _ c ( , ) _ _\\_/_ ( )^k (  ) + _ k,2_,*1 * _ \\ (  ) ,    where @xmath89 are the eigenvalues of @xmath90 , and for @xmath91 with @xmath92 we let @xmath93 be the unique positive number such that @xmath94 . for @xmath95 . ]    in particular , this formula holds under the assumptions of theorem [ tf ] .    the sum over conjugacy classes",
    "@xmath74 with @xmath96 in   contains scalar classes only , by the definition of @xmath97 , so it equals @xmath98 where the sum is over @xmath99 with @xmath100 and @xmath101 if @xmath73 .",
    "the sum over cusps in can be written more explicitly as follows .",
    "fix a scaling matrix @xmath102 for the cusp @xmath84 , namely @xmath103 and @xmath104 for @xmath105 we set @xmath106 and [ 1.8 ] _ , ^(a , d):= _ c ( , ) _",
    "_\\_(a , d)/_()^k (  ) .",
    "we show in theorem  [ t5.1 ] that @xmath107 is symmetric in @xmath108 , and we can rewrite the sum over cusps @xmath84 in   as follows [ 1.7]_a , d>0(a , d)^k-1_,^(a , d).it is the function @xmath107 that can be easily computed for specific groups .    by remark [ r2 ] ,",
    "we can scale  @xmath7 so that the sum over @xmath108 in   is over _ integers _ @xmath105 with @xmath109 , for some  @xmath110 .",
    "note that both sides of  ,   are additive under taking union of double cosets , so one may assume without loss of generality that @xmath7 consists of matrices with a fixed determinant .",
    "what we prove in this paper is an equivalent version of theorem [ tf ] in which the sum is over @xmath18-conjugacy classes @xmath74 in @xmath111 , and we set for such a class @xmath112 for @xmath1 a finite index subgroup of @xmath18 , let @xmath113_\\g$ ] denote the @xmath1-conjugacy class in @xmath111 of a matrix @xmath114 .",
    "the set @xmath115 is finite if and only if @xmath116 is finite , and assuming this to be the case we denote @xmath117 $ ] .",
    "we have that @xmath118_{\\g_1})=\\e_\\g([\\pm m]_{\\g})/i_\\g(m)$ ] , and @xmath113_{\\g_1}$ ] breaks into a number equal to @xmath119/ i_\\g(m)$ ] of @xmath52-conjugacy classes .",
    "since @xmath34 is constant on @xmath1-conjugacy classes in @xmath7 , we obtain that theorem [ tf ] can also be stated as follows .",
    "[ t2 ] under the assumptions of theorem [ tf ] we have [ tf2 ]    ( [ ] , m_k(,)+ s_k(,))= _ p_k-2(m _ , m_)_,^(m _ )",
    "( ) + + _ k,2_,*1 * _ \\ (  )    where the sum is over @xmath120-conjugacy classes @xmath121 with representative @xmath122 , and [ 1.10 ] _ , ^(m ) : = _",
    "( 1)^k(ama^-1 ) , where the choice of signs is irrelevant if @xmath123 , while if @xmath124 at most one choice of signs is possible in each term implies that if @xmath124 then @xmath125 . see the remark following lemma  [ l1 ] . ] .    by the paragraph",
    "preceding the theorem , the trace formulas and are equivalent if @xmath18 is replaced by any fuchsian subgroup of the first kind containing the identity , and @xmath1 is a finite index subgroup .",
    "the functions @xmath126 , @xmath127 in , also depend on the parity of @xmath128 , but for simplicity we omit the dependence from the notation .",
    "the function @xmath127 is constant on @xmath18-conjugacy classes , and @xmath129 , so the product @xmath130 only depends on the conjugacy class @xmath74 and not on the representative @xmath56 chosen .",
    "because of , an equivalent formulation for all the trace formulas in this paper can be given as generating series in the weight , generalizing previous results obtained for congruence subgroups of small levels .",
    "for example , the formula in the first version of theorem [ t2 ] is equivalent to the following identity .",
    "let @xmath131 , m_k(\\g,\\chi)+s_k(\\g,\\chi ) ) $ ] , for @xmath132 and @xmath34 as in the first version of theorem [ t2 ] .",
    "if @xmath133 we have the formal power series identity @xmath134 where the sum is over @xmath1-conjugacy class @xmath135 with representatives @xmath136 .",
    "if @xmath73 the same formula holds , with the fraction replaced by @xmath137      since the proof of theorem [ t2 ] is very short , and it is the main new contribution of the present article , we give it next .",
    "it generalizes the proof for the modular group given together with zagier in @xcite ( in preparation ) , and it is based on the existence of a hecke operator acting on period polynomials that satisfies three algebraic properties which we now state .    henceforth we restrict ourselves to a finite index subgroup @xmath1 of @xmath18 . since @xmath138 , we can assume , without loss of generality , that the double coset  @xmath7 is contained in the semigroup  @xmath139 of  @xmath140 integral matrices of positive determinant .",
    "let @xmath141 be the matrices of determinant  @xmath33 , and let @xmath142 $ ] , the @xmath143-vector space generated by elements of @xmath144 , on which @xmath145 $ ] acts on both sides .",
    "let @xmath146 be a system of representatives for the coset space @xmath147 which fix the cusp infinity and let @xmath148 .",
    "let @xmath149 and @xmath150 be two generators of @xmath120 , and let @xmath151 , an element of order 3 in @xmath120 .",
    "it was shown by choie and zagier @xcite that the action of hecke operators on period polynomials associated with modular forms for @xmath18 is given by any element @xmath152 satisfying @xmath153 more generally , in section [ s2 ] we show that such elements @xmath154 act on a period subspace of any  @xmath18-module  @xmath19 , and their action corresponds to the action of double coset operators on the parabolic cohomology @xmath17 .",
    "for the purpose of proving the trace formula for the modular group , in @xcite zagier introduced elements @xmath155 satisfying and also @xmath156 in the joint work @xcite , we give a short proof that there exist @xmath154 satisfying , . moreover we show that any such operator @xmath157 has the key property @xmath158 which explains the definition of the invariant @xmath159 .",
    "the proof of is the most difficult and technical part in this approach to the trace formula . in order to keep this paper",
    "self - contained , we give an explicit operator @xmath154 satisfying - in appendix  [ app1 ] ( joint with zagier ) , while in  @xcite we will give a more conceptual proof that all operators satisfying  , also satisfy  .    together with paol , we showed in @xcite that operators @xmath154 satisfying give the action of double coset operators on period polynomials associated to @xmath160 for arbitrary congruence subgroups @xmath1 ( for @xmath31 and hecke operators of index coprime with the level this was also shown by diamantis  @xcite ) . in section [ s2.0 ]",
    "we extend this theory to include modular forms with nebentypus .",
    "for @xmath161 , let @xmath162 be the @xmath1-module of polynomials of degree at most @xmath163 with action @xmath164 .",
    "the shapiro lemma gives an isomorphism of parabolic cohomology groups @xmath165 where @xmath166 is the submodule of the induced module @xmath167 on which @xmath168 acts identically ( see section [ s2.0 ] for an explicit description ) .",
    "the space  @xmath166 is a @xmath169$]-module , and we define the space of _ period polynomials _ as [ 1.6 ] w_w^ , : = ( 1+s , v_w^ , ) ( 1+u+u^2,v_w^ , ) .",
    "the parabolic cohomology group @xmath170 is the quotient of @xmath171 by the subspace of _ coboundary polynomials _ , as explained in section [ s2 ] ( also in ( * ? ? ?",
    "2 ) when @xmath81 ) , and we use the period polynomial space to compute the trace of hecke operators on parabolic cohomology .    any double coset @xmath172 such that @xmath13 determines an operation of elements @xmath173 on @xmath174 , denoted by  @xmath175 , which is compatible with the action of  @xmath120 . by linearity",
    ", it extends to an action of elements in @xmath176 on @xmath166 .",
    "an operator @xmath154 satisfying   preserves the space  @xmath171 , acting by @xmath177 , and corresponds to the action of the double coset operator  @xmath11 $ ] on @xmath170 ( proposition [ p2.1 ] ) .",
    "let @xmath154 be any element satisfying , , , and let @xmath161 be an integer .",
    "the proof of the trace formula can be summarized as follows : @xmath178 , s_{w+2}(\\g,\\chi)+ m_{w+2}(\\g,\\chi))&=\\tr(w_w^{\\g,\\chi } |_\\ss \\wt_n ) & \\ \\text { by \\eqref{z1}\\ ; } \\\\",
    "\\tr(w_w^{\\g,\\chi } |_\\ss \\wt_n)&= \\tr(v_w^{\\g,\\chi } |_\\ss \\wt_n ) + \\dd_{w,0}\\dd_{\\chi,{\\bf 1}}\\sum_{\\ss\\in\\g\\backslash\\ss } \\wc(\\ss )     & \\",
    "\\text { by \\eqref{z23}\\ ; } \\\\",
    "\\tr(v_w^{\\g,\\chi } |_\\ss \\wt_n)&=   \\sum_{\\x\\subset{\\overline{\\m}}_n } \\tr(v_w^{\\g,\\chi}|_\\ss m_\\x)\\ ; \\e(\\x )    & \\",
    "\\text { by \\eqref{z4}.}\\nonumber\\end{aligned}\\ ] ]    the first equality holds for any @xmath154 satisfying  , as a consequence of the eichler - shimura isomorphism and the fact that the trace of @xmath11 $ ] on the eisenstein subspace is the same as the trace of @xmath154 acting by @xmath177 on the space of coboundary polynomials ( see proposition  [ l2.1 ] ) .    by , the element @xmath154 maps the subspaces @xmath179 and @xmath180 of @xmath166 into each other , and these two spaces generate @xmath166 if @xmath181 ( lemma [ l5 ] ) .",
    "since [ 1.9](t , ab)=(t , a+b)whenever @xmath182 is a linear transformation mapping the subspaces @xmath183 of an ambient space into each other , the second equality immediately follows , taking into account . the case @xmath184 is considered in   [ sect2 ] .",
    "the third equality follows from property , since @xmath185 only depends on the @xmath18-conjugacy class @xmath74 , and not on the representative @xmath186 chosen .",
    "the trace of @xmath187 acting by @xmath188 on @xmath189 is @xmath71 , and more generally we show in lemma [ l1 ] that @xmath190 leading to the trace formula in the second version of theorem  [ t2 ] .",
    "it is remarkable that the mere existence of an element @xmath154 satisfying - is the key for a short proof of the trace formula for hecke operators , for all weights @xmath191 and all congruence subgroups .",
    "for example , to finish the proof of a dimension formula for spaces of modular forms , it is enough to check that the following element satisfies  - : @xmath192      the second version of theorem  [ t2 ] is more convenient than the first for obtaining explicit trace formulas for congruence subgroups in terms of class numbers .",
    "the class numbers appear naturally in terms of the invariants @xmath159 , and we first extend both the usual and the kronecker - hurwitz class numbers to all integers .",
    "since @xmath193 only depends on the @xmath18-equivalence class of the quadratic form associated to a @xmath18-conjugacy class @xmath74 , the correspondence between conjugacy classes of matrices and @xmath18-equivalence classes of quadratic forms gives for all @xmath194 and for @xmath195 : @xmath196 where @xmath197 is the content of the quadratic form associated to any representative @xmath56 of @xmath74 as in   below , and @xmath198 is the kronecker - hurwitz class number for @xmath199 , as extended by zagier to all  @xmath194 in  @xcite .",
    "we recall that if @xmath200 , @xmath198 is the the number of @xmath18-equivalence classes of positive definite binary quadratic forms of discriminant @xmath201 , the forms with a stabilizer of order 2 or 3 in @xmath18 being counted with multiplicity @xmath202 or @xmath203 ; @xmath204 ; and if @xmath205 , @xmath198 is @xmath206 if @xmath207 with @xmath208 , and it is 0 if @xmath201 is not a perfect square .",
    "similarly , let @xmath209 be the number of _ primitive _ quadratic forms of discriminant @xmath205 , and set @xmath210 where @xmath211 is the number of units of the quadratic order of discriminant  @xmath194 .",
    "we extend the definition to all @xmath194 by setting @xmath212 , @xmath213 if @xmath214 is an integer , and @xmath215 if @xmath194 is not a negative discriminant or a square .",
    "this extension of @xmath216 is compatible to that of @xmath198 , in the sense that for all @xmath194 we have [ inv ] h(-d)=_d^2|d h_0 ( ) , h_0(-d)= _ d^2| d h ( ) ( d ) , where the prime on the summation sign indicates that for @xmath217 only the term for @xmath218 is included , and we make the convention that @xmath219 and @xmath220 .",
    "it follows that for all @xmath221 and for @xmath195 we have [ 13.0 ] _",
    "( ) =    -2 h_0(d / u^2 ) & ( ) 0 + -h_0(d / u^2 ) & = 0    , and with the convention that @xmath219 this formula also holds for @xmath217 and @xmath222 .",
    "the class numbers enter the trace formula under the following assumption on the function  @xmath127 in the second version of theorem  [ t2 ] .",
    "the assumption is natural since this function is constant on @xmath18-conjugacy classes in @xmath139 , and it is satisfied for the double cosets giving the action of the usual hecke and atkin - lehner operators for  @xmath223 , as we will see shortly .",
    "let [ cont ] g_m=(c , d - a ,- b ) m = abcd be the content of the quadratic form associated to the matrix @xmath65 .    [ h ] if @xmath1 is a congruence subgroup of level @xmath45 , then the function @xmath224 only depends on the conjugacy class invariants @xmath225 , @xmath226 , and @xmath227 , namely there is an arithmetic function @xmath228 such that @xmath229    moebius inversion gives a function @xmath230 such that [ ass2 ] b _ , ^(u , t , n)=_d|u c _ , ^(d , t , n ) , c _ , ^(u , t , n)=_d|u b _ ,",
    "^(u / d , t , n)(d),where we assume @xmath231 in both formulas . note that the functions @xmath232 are only defined on triples @xmath233 with @xmath231 , @xmath234 , and they scale by @xmath235 when @xmath236 is replaced by @xmath237 .    under this assumption and assuming also @xmath172 , the sum over @xmath18-conjugacy classes [ 1.17]:= _ _",
    "n p_k-2(m _ ,",
    "n ) _ , ^(m _ ) ( ) in the right hand side of becomes in and are restricted to @xmath234 . ]",
    "[ 1.1 ] & = _ t/\\{1 } p_k-2 ( t , n)_u|nc _ , ^(u , t , n ) _ ( ) + & = -_t p_k-2 ( t , n ) _ u|nh()c _ , ^(u , t , n ) .    in the second equality we used , and the fact that @xmath238 scales by @xmath235 when @xmath236 is replaced by  @xmath237 , just like @xmath239 .",
    "similarly using the extended class numbers @xmath216 from   we have    [ 1.2 ] & = _ t/\\{1 } p_k-2 ( t , n)_u^2|t^2 - 4n b _ ,",
    "^((n , u),t , n ) _ ( ) + & = -_t p_k-2 ( t , n ) _ uh_0()b _ ,",
    "^((n , u),t , n ) ,    with the prime summation sign defined as in .",
    "note that if we restrict the sum over @xmath74 in to elliptic conjugacy classes , the range of summation in @xmath236 in the last terms of and becomes @xmath240 .",
    "equating the coefficients of @xmath239 in the last terms in   and   yields an inversion formula between arithmetic functions satisfying   and  , which can also be checked directly .",
    "the case @xmath241 of the trace formula reduces to the kronecker - hurwitz class number formula , which we take for granted in this paper .",
    "indeed , for @xmath241 , @xmath242 , @xmath243 , and @xmath244 , the left side of vanishes , and using the trace formula becomes the kronecker - hurwitz class number relation : @xmath245 taking  @xmath7 to be any @xmath18-double coset instead of @xmath246 , the case @xmath241 , @xmath242 of the trace formula   reduces to the following identity [ kh ] _ ( ) = -|_1\\| , with the sum over @xmath120-conjugacy classes in @xmath75 .",
    "this is an immediate consequence of the standard kronecker - hurwitz relation ( the case @xmath244 ) , as we show in ",
    "[ sect2 ] , and we use it there to prove the case @xmath241 of the trace formula for an arbitrary  @xmath1 .    in the remainder of the introduction , we specialize @xmath223 .",
    "let  @xmath6 , @xmath3 a character modulo @xmath45 with @xmath72 , and let @xmath247 be the double coset of the usual hecke operator acting on @xmath248 , given in . changing notation @xmath249 , we have [ 6 ] _",
    "n , ( m)= _ ( a_ama^-1 ) .",
    "this function was computed by oesterl @xcite ( see lemma [ l9 ] below ) .",
    "in particular  @xmath250 satisfies assumption  [ h ] , namely for @xmath251 we have , setting @xmath252 , @xmath253 , and @xmath254 : @xmath255 where @xmath256 , satisfies @xmath257 , so does @xmath258 for every @xmath259 , because of the assumption @xmath231 , @xmath234 . ] and @xmath260 is the index of @xmath31 in @xmath18 , equal to @xmath261 .",
    "notice that @xmath262 is multiplicative in @xmath45 , so its moebius inverse [ 16 ] c_n,(u , t , n):=_d|u b_n,(u / d , t , n)(d ) is also multiplicative , and it can be easily computed numerically . as in we obtain the following trace formula , where the function @xmath263 is given by and it is computed in  [ sec5.1 ] .",
    "[ t1 ] let @xmath264 and @xmath6 be integers , and @xmath3 a character mod @xmath45 with @xmath72 . with the function @xmath265 defined above",
    ", we have for all @xmath266 : @xmath267 where @xmath268 , and @xmath269 where @xmath270 is the residue class modulo @xmath271 such that @xmath272 , @xmath273 is the conductor of @xmath3 , and @xmath274 denotes euler s function .",
    "the terms for @xmath275 can be explicitly computed by the remark following theorem [ tss ] : they are nonzero only when @xmath33 is a square , when they contribute @xmath276 .",
    "this trace formula was also obtained by oesterl by analytic means @xcite , with the sum over @xmath277 written as in , in terms of @xmath278 and the class numbers @xmath216 .    since @xmath279 ,",
    "the following formulas , obtained from and , hold for all @xmath3 ( both sides are 0 if @xmath280 ) : @xmath281 with the extra term @xmath282 on the right hand sides if @xmath241 and @xmath283 , and the prime summation sign having the same meaning as in .",
    "we give a similar formula for the trace of @xmath284 on @xmath285 , with @xmath286 the atkin - lehner operator for an exact divisor @xmath287 of @xmath45 .",
    "the functions @xmath288 , @xmath289 in , are computed in ",
    "[ sec5.2 ] , and setting @xmath290 in , with @xmath291 the trivial character mod @xmath45 , we obtain the following trace formula .",
    "[ t1.1 ] let @xmath292 with @xmath293 and @xmath6 even , @xmath30 .",
    "for _ all _ @xmath266 we have @xmath294 where is the same as the function @xmath295 in theorem [ t1 ] for @xmath81 . ]",
    "@xmath296    the terms for @xmath297 in the summation above are present only if @xmath298 , @xmath33 is a square , and @xmath299 , when they contribute @xmath300 .",
    "the function @xmath301 is explicitly computed in lemma [ l4 ] , where we show that [ 1.23 ] c_n(u , t , n)= |s_n(t , n)|c_n(u , t^2 - 4n),with @xmath302 , and @xmath303 an explicit multiplicative function in @xmath304 .",
    "for example , when @xmath45 is square - free , we have @xmath305 independent of @xmath194 .",
    "the formulas in theorems [ t1 ] and [ t1.1 ] have been verified numerically for a large range of the parameters .      to illustrate the explicit nature of theorem [ t1.1 ]",
    ", we consider the case @xmath306 and @xmath33 odd .",
    "the set @xmath307 in is nonempty only when @xmath308 is even and @xmath309 , when its cardinality is 2 . using and an easily verified class number relation , and @xmath310 , then @xmath311 , where @xmath312 is the quadratic residue symbol , and",
    "the last term is present only if @xmath313 . ]",
    "the formula in theorem [ t1.1 ] gives , for @xmath33 odd and @xmath6 even : @xmath314 denoting by @xmath315 the right hand side , we recover a conjecture of cohen @xcite , recently proved by mertens @xcite , which asserts that @xmath316 .",
    "for @xmath241 the space @xmath317 is trivial , and this formula reduces to class number relations similar to the kronecker - hurwitz formula .",
    "other such relations can be obtained from theorem [ t1.1 ] taking small values for @xmath45 .",
    "the trace formula for hecke operators on spaces of cusp forms for fuchsian groups has a long history , starting with the celebrated papers of eichler  @xcite and selberg  @xcite . except for eichler",
    "s original approach , which uses the arithmetic of quaternion algebras , most proofs use selberg s method of realizing the hecke operators as integral operators against an automorphic kernel , and then computing the trace analitically , as the integral of the kernel over the diagonal  @xcite . a proof based on the theory of period polynomials",
    "was given by zagier for the modular group  @xcite .",
    "the existing approaches lead to trace formulas on the cuspidal subspace alone , in which the different types of conjugacy classes need separate treatments  @xcite .",
    "by contrast , in our proof all conjugacy classes are treated on equal footing , and the trace formula on @xmath318 , which is obtained directly , contains no parabolic conjugacy classes .",
    "the only technical difficulty in our approach is the algebraic , group theoretical property of the hecke operators on period polynomials .",
    "the case @xmath241 presents special difficulties in the analytic approach , due to the lack of absolute convergence of the automorphic kernel function ; in our approach , for any congruence subgroup this case reduces to the kronecker - hurwitz class number relation   for the modular group .    for the congruence subgroup @xmath0 ,",
    "previous formulas are stated in terms of the class numbers counting _ primitive _ quadratic forms of a given discriminant @xcite , and , with the exception of oesterl s thesis , the index of the hecke operators is assumed coprime with the level .",
    "we obtain simple formulas both in terms of the usual and the kronecker - hurwitz class numbers , which count all forms , and we make no restrictions on the index of the hecke and atkin - lehner operators .",
    "one could easily obtain from our results explicit trace formulas on other congruence subgroups if needed .",
    "our approach for proving the trace formula is related to the theory of modular symbols .",
    "the hecke operators on period polynomials satisfying property are adjoints of the hecke operators on modular symbols introduced by merel  @xcite . by poincar duality",
    ", our approach may be interpreted as computing the trace of hecke operators on the space of modular symbols .",
    "this paper originates in a work in progress with zagier @xcite , in which we give an elementary proof of the eichler - selberg trace formula for the modular group by means of the special hecke operator acting on the space of period polynomials that i also use in this paper .",
    "i thank don zagier for introducing me to this idea , and for sharing generously his ideas and insights .",
    "i also thank viceniu paol for many illuminating discussions on the subject of period polynomials and modular symbols .",
    "part of this work was completed during several visits at the max planck institute for mathematics in bonn , whose support i gratefully acknowledge .",
    "this work was partly supported by the european community grant pirg05-ga-2009 - 248569 and by the cncs - uefiscdi grant pn - ii - ru - te-2011 - 3 - 0259 .",
    "let @xmath19 be a @xmath18-module , with @xmath2 . we show that the action of double coset operators on the parabolic cohomology group @xmath17 corresponds to the action of any element @xmath154 satisfying property on a _ period subspace _",
    "@xmath319 of @xmath19 . under mild assumptions on @xmath19",
    ", we then use an operator @xmath154 satisfying properties - to give a trace formula for the action of  @xmath154 on the period subspace ( theorem [ tcoh ] ) .      to define the action of double coset operators on cohomology ,",
    "let us consider more generally a group @xmath1 and a right @xmath1-module @xmath19 , which is assumed to be a vector space over @xmath320 .",
    "let @xmath7 be a double coset of @xmath1 contained in the commensurator of @xmath1 inside a larger ambient group , so that the number of right cosets @xmath321 is finite .",
    "assume that elements in @xmath7 act on @xmath19 in a way compatible with the action of @xmath1 , that is [ comp ] p|(gm)=(p|g)|m , p|(mg)=(p|m)|g , p , g , m.one could also assume from the beginning that @xmath19 is a module for the semigroup generated by @xmath1 and @xmath7 inside the commensurator of @xmath1 , but it is later convenient to assume that elements @xmath322 annihilate @xmath19see the remark following proposition  [ p2.1 ] .",
    "fix representatives @xmath323 for cosets @xmath324 , and for @xmath325 , let @xmath326 be the unique element such that @xmath327 . if @xmath328 is a cocycle , namely @xmath329 , we define [ 131 ] |[]()= _ k\\ ( _ k)| m_k .then @xmath330 $ ] is a cocycle , whose cohomology class is independent of the choice of representatives  @xmath331 .",
    "if @xmath1 is a subgroup of @xmath24 and @xmath332 is a parabolic cocycle ( that is @xmath333 for all parabolic elements @xmath334 ) , so is @xmath330 $ ] , which defines an action of @xmath11 $ ] on the parabolic cohomology group @xmath335  @xcite .",
    "[ r1 ] if @xmath1 contains an element @xmath336 in the center with @xmath337 ( e.g. , @xmath338 for @xmath1 a subgroup of @xmath24 ) , let @xmath339 be the subspace of @xmath336-invariants in @xmath19 .",
    "for any cocycle @xmath328 and @xmath340 we have @xmath341 , so @xmath342 is a coboundary . therefore @xmath343 is a cocycle in the same class as @xmath332 , which takes values in the module @xmath344 , and the map @xmath345\\mapsto [ \\phi']\\;,\\ ] ] is an isomorphism .",
    "the same is true for parabolic cohomology , if @xmath1 is a subgroup of @xmath24 .",
    "therefore we can restrict without loss of generality to modules on which @xmath336 acts identically ,      for the remainder of this section , let @xmath19 be a right @xmath18-module on which  @xmath168 acts identically , and let @xmath346 be a double coset of @xmath18 whose elements act on @xmath19 by an action denoted @xmath347 , in a way compatible with the action of @xmath18 as in .",
    "it is convenient to extend this action to elements of @xmath139 , by having @xmath322 annihilate  @xmath19 ; the extended action still satisfies the compatibility condition for @xmath187 . by linearity",
    "we also have an action of elements of @xmath348 $ ] on @xmath19 .",
    "any parabolic cocycle @xmath349 can be modified by a coboundary so that @xmath350 , and then the element @xmath351 belongs to the subspace @xmath352 called _ the period subspace _ , by analogy to the case when @xmath353 , the space of polynomials of degree @xmath354 , when the elements of @xmath319 are period polynomials .",
    "conversely , if @xmath355 , the map @xmath356 with @xmath357 , @xmath358 extends to a parabolic cocycle via @xmath359 .",
    "this gives an exact sequence [ es ] 0 h_p^1(_1 , ) 0 , where @xmath360 is called the _ coboundary subspace_.    [ p2.1 ] assume the double coset @xmath361 is contained in @xmath246 .",
    "then any element @xmath155 satisfying   preserves the space  @xmath319 , and its action on @xmath319 corresponds to the action of @xmath362 $ ] on @xmath17 via the map in , namely the cocycles @xmath363 $ ] and @xmath364 are in the same cohomology class , for any @xmath365 .",
    "the assumptions that @xmath366 and that elements @xmath367 annihilate  @xmath19 could be avoided if we replace condition   by @xmath368\\ ] ] for some @xmath369 $ ] , where @xmath370 with  @xmath331 any representative of the coset  @xmath371 fixing  @xmath372 .",
    "the statement of the proposition would then be true without the assumptions , but with @xmath154 replaced by @xmath373 .",
    "we prefer the formulation given above to emphasize that the universal operator @xmath154 acts on all modules , with the action depending on the double coset chosen .",
    "we use the following easy lemma , which we state in greater generality than needed here .",
    "let @xmath374 be a group with generators @xmath375 , let @xmath376 be a right @xmath374-module viewed also as a @xmath377 $ ] module , and let @xmath378 be a cocycle . then for each @xmath379 there exist @xmath380 $ ] such that in the group algebra @xmath377 $ ] we have @xmath381 , and for any such @xmath382 we have @xmath383    both the existence of @xmath382 as above and the relation follow by induction on the length of @xmath384 as a product in the generators @xmath385 .",
    "indeed we have @xmath386 , and @xmath387 .",
    "let @xmath331 be representatives for the cosets @xmath388 which fix @xmath372 , and which define the element @xmath389 in .",
    "we use these representatives to define the action of @xmath362 $ ] on @xmath274 in , recalling that elements @xmath390 annihilate @xmath19 .",
    "let @xmath391 with @xmath350 .",
    "writing @xmath392 , we have @xmath393 , so @xmath394 , and shows that @xmath395(t)=0 $ ] . therefore it remains to show that @xmath395(s)=\\varphi(s)| \\wt_n \\;,$ ] if @xmath154 satisfies  , which would show in particular that @xmath154 preserves @xmath319 .",
    "let @xmath396 satisfying , with @xmath397 $ ] .",
    "relation implies @xmath398 where @xmath399 .",
    "we have therefore @xmath400 , and the lemma applied to the group @xmath18 with generators @xmath401 , @xmath182 and to the cocycle @xmath274 with @xmath350 gives @xmath402(s ) \\;,\\ ] ] where we used and the fact that elements @xmath390 act trivially on @xmath19 .",
    "the coboundary subspace @xmath403 in is also preserved by @xmath154 . indeed , if @xmath404 , by we have [ 2.3 ] p|(1-s)|_n = p| t_n^|(1-s ) and since @xmath405 we also have @xmath406 .",
    "assuming that the space of  @xmath18-invariants in  @xmath19 is trivial , we have a bijection [ ed ] : = \\{p : p|1-t=0 } , pp|(1-s ) , and we have shown that @xmath407 .",
    "this trace is computed in theorem  [ p6.1 ] for the module of polynomials associated to congruence subgroups .    by proposition [ p2.1 ] and the previous paragraph , for any @xmath154 satisfying   the exact sequence",
    "gives [ 2.5]([_1 ] , h_p^1(_1 , ) ) + ( | _ n ) = ( | _ n ) . therefore computing the trace of @xmath362 $ ] on the parabolic cohomology has been reduced to computing the trace of @xmath154 on the period subspace .",
    "the latter trace is computed in the next theorem , using an operator @xmath154 satisfying - .    [ tcoh ] assume that the @xmath18-module @xmath19 satisfies [ ass1]=(1+s)+(1+u+u^2 ) .let @xmath366 be a double coset whose elements act on @xmath19 in a manner compatible with the action of  @xmath18 as in  , and let @xmath155 be any element satisfying  .",
    "we have @xmath408 where the sum is over @xmath120-conjugacy classes @xmath74 in @xmath409 with representatives @xmath410 .",
    "let @xmath155 be an element satisfying - .",
    "property implies that  @xmath154 maps the spaces @xmath179 and @xmath180 into each other , and since these two spaces generate  @xmath19 by  , we obtain by : @xmath411 which is a more abstract version of the last two equations in  .",
    "we show in the next lemma that assumption is satisfied if @xmath19 admits a non - degenerate , @xmath18-invariant pairing , and the space of @xmath18-invariants @xmath412 is trivial . in  [ sect2 ] we will also compute the trace on @xmath319 in a case when the space @xmath412 is one dimensional , and the space generated by @xmath179 and @xmath180 has codimension 1 in @xmath19 .",
    "[ l2.2 ] let @xmath19 be a @xmath18-module admitting a @xmath18-invariant , nondegenerate bilinear pairing .",
    "then the orthogonal complement of @xmath413 is @xmath414    let @xmath415 , @xmath416 and let @xmath417 be their orthogonal complements with respect to the pairing .",
    "since @xmath19 is a complex vector space , we have decompositions @xmath418 and @xmath419 , @xmath420 . from the @xmath18-invariance of the pairing",
    ", we have @xmath421 , @xmath422 , and from the nondegeneracy we conclude @xmath423 , @xmath424 .",
    "therefore @xmath425 since @xmath401 and @xmath426 generate @xmath18 .",
    "we now specialize the @xmath18-module of the last section to be the submodule @xmath166 of the induced module @xmath427 on which @xmath168 acts trivially , where @xmath428 is a finite index subgroup .",
    "its period subspace is the space of period polynomials associated with the space of cusp forms @xmath429 , and we apply the eichler - shimura isomorphism and the shapiro lemma to relate the trace of hecke operators on the space of period polynomials with the trace on @xmath430 .",
    "let @xmath1 be a finite index subgroup of @xmath18 , and @xmath3 a character of @xmath1 whose kernel has finite index in @xmath1 .",
    "for @xmath431 , we view the space @xmath432 of complex polynomials of degree @xmath354 as @xmath1-module by [ 2.1 ] p|_:= ( ^-1 ) p|_-w , pv_w , , and we denote it by @xmath162 to indicate this action .",
    "let @xmath433 be a double coset such that @xmath434 , and @xmath7 is a disjoint finite union of right cosets . using a function @xmath34 as in",
    ", we define an operation of elements @xmath435 on @xmath162 by @xmath436 and this operation is obviously compatible as in   with the action of @xmath1 .",
    "therefore we have an operator  @xmath11 $ ] acting on @xmath437 as in  .    in order to state the eichler - shimura isomorphism ,",
    "let @xmath438 be the space of anti - holomorphic cusp forms @xmath439 , where the bar denotes complex conjugation .",
    "functions @xmath440 are anti - holomorphic on the upper half plane , and satisfy @xmath441 for @xmath325 , where @xmath442 the operator @xmath11 $ ] acts on @xmath438 as in  , with the action @xmath443 replaced by @xmath444 .",
    "[ eichler - shimura ] we have a hecke - equivariant isomorphism @xmath445 given by @xmath446+[\\vp_g^c]$ ] with the parabolic cocycles @xmath447 , @xmath448 defined by @xmath449 where @xmath450 is a fixed point .",
    "the proof is given by shimura in ( * ? ? ?",
    "* sec .  8) , with the difference that here @xmath1 acts on the right on @xmath162 instead of on the left in loc .",
    "shimura defines the action of the hecke operator @xmath11 $ ] using a character @xmath3 of the semigroup generated by @xmath1 and @xmath79 inside @xmath35 , where @xmath79 is the adjoint of  @xmath7 .",
    "our function  @xmath34 is related to such a @xmath3 by @xmath451 for @xmath48 .    in order to conclude from the eichler - shimura isomorphism that [ es ] ( [ ] , h_p^1 ( , v_w^))= 2 ( [ ] , s_w+2 ( , ) ) , we need to make the extra assumption mentioned in the introduction :    [ ass3 ] there exists @xmath452 with @xmath15 and @xmath16 , such that @xmath453    for example , if @xmath223 we can take @xmath454 . under the assumption above , we have an isomorphism @xmath455 with inverse @xmath456 , @xmath457 .",
    "this isomorphism is easily checked to be hecke equivariant , by assumption [ ass3 ] , and follows . without this assumption ,",
    "all the results of this paper still hold , but with @xmath458 , s_k(\\g,\\chi))+\\tr([\\ss ] , s_k^c(\\g,\\chi))]$ ] in place of @xmath459 , s_k(\\g,\\chi))$ ] .",
    "the shapiro lemma gives a hecke equivariant isomorphism between the cohomology groups @xmath460 and @xmath461 , and we now describe it more explicitly .",
    "we identify the induced module @xmath167 with the space of functions @xmath462 such that @xmath463 on which  @xmath464 acts by @xmath465 . since  @xmath432 is a @xmath18-module as well , we have an isomorphism of  @xmath18-modules @xmath466 where the action of  @xmath464 on the right is by @xmath467 .",
    "the isomorphism takes @xmath468 to @xmath469 , given by @xmath470 .    by remark [ r1 ]",
    ", the cohomology group @xmath471 does not change upon replacing @xmath472 by its subspace @xmath473 on which @xmath168 acts trivially , namely : @xmath474 the shapiro lemma then gives an isomorphism [ shap ] h_p^1(_1 , v_w^,)h_p^1(,v_w^ ) , given by @xmath475\\mapsto [ \\vp']$ ] , where @xmath476 .",
    "this isomorphism is hecke equivariant , with the action of hecke operators on the left defined in the next section .    if @xmath81 , the trivial character of @xmath1 , in @xcite we defined the space @xmath477 as those functions @xmath478 with @xmath479 for all cosets @xmath480 .",
    "we could also view the space @xmath166 as a subspace of @xmath481 with @xmath482 , a finite index subgroup of @xmath1 , but the present definition is more flexible .      in order to transfer the operator @xmath11 $ ] from @xmath461 to an operator on @xmath483 , we make the following assumption on the double coset @xmath7 : [ eq_star ] , or equivalently @xmath484 .",
    "this assumption is satisfied by the double cosets giving the usual hecke and atkin - lehner operators for the congruence subgroups @xmath485 and @xmath31 .",
    "it is related to , but weaker than , the notion of compatible hecke pairs in @xcite .    under assumption",
    ", we define an action of elements @xmath187 on @xmath166 , which for @xmath42 is the same as in ( * ? ? ?",
    "5 ) : @xmath486 by and , the definition does not depend on the decomposition @xmath487 .",
    "this is not a proper action of the semigroup @xmath139 , but it is compatible with the action of @xmath18 as in .",
    "let @xmath488 .",
    "using the action , the operator @xmath362 $ ] acts on @xmath483 as in , and this corresponds to the action of @xmath11 $ ] on @xmath461 via the shapiro isomorphism  .",
    "note that @xmath489 if @xmath490 , so the assumption in section [ s2 ] is satisfied .",
    "the period subspace defined in section [ s2 ] is then the space of period polynomials @xmath491 introduced in , and the exact sequence relates it with the parabolic cohomology group @xmath483 . assuming @xmath172 , proposition [ p2.1 ] shows that the action of the hecke operator associated with @xmath362 $ ] on @xmath483 corresponds to the action of any operator @xmath154 satisfying on @xmath491 . from  , the eichler - shimura isomorphism , and the shapiro lemma",
    "we conclude that for any @xmath154 satisfying we have [ 8 ] ( w_w^ , |__n)=2 ( [ ] , s_w+2(,))+ ( c_w^ , |__n ) , where @xmath492 is the coboundary subspace .",
    "the action of the operator @xmath154 on @xmath171 corresponds to the action of @xmath11 $ ] on @xmath5 with @xmath493 , as shown in @xcite .",
    "namely , for @xmath494 , its period polynomial @xmath495 is given by @xmath496 and we have @xmath497}=\\rho_f|_{\\ss } \\wt_n$ ] .",
    "under assumption  [ ass3 ] for @xmath454 , we have an action of @xmath498 on @xmath166 , given by @xmath499 . the involution @xmath498 preserves the space @xmath171 , and a polynomial @xmath500 decomposes as @xmath501 with @xmath502 .",
    "we have the following version of the eichler - shimura isomorphism ( * ? ? ?",
    "* thm . 2.1 ) @xmath503 and this isomorphism is hecke equivariant .",
    "this gives another proof of .",
    "[ l2.1 ] let @xmath504 be a finite index subgroup , @xmath505 an integer , @xmath3 a character of @xmath1 with kernel of finite index in @xmath1 , and @xmath172 a double coset satisfying  . under assumption  [ ass3 ]",
    "we have @xmath506 , m_k(\\g,\\chi)+ s_k(\\g,\\chi))\\;,\\ ] ] for any @xmath507 satisfying .    by it",
    "is enough to show that @xmath508 , e_k(\\g,\\chi))$ ] , where @xmath509 is the eisenstein subspace .",
    "this is proved in theorem [ p6.1 ] , by computing explicitly both traces .    a more conceptual proof is provided by the theory of modular symbols of ash and stevens .",
    "the space @xmath171 is isomorphic with the space of modular symbols @xmath510 defined in ( * ? ? ?",
    "4 ) , with the action of @xmath1 on @xmath162 given by , and the isomorphism is compatible with the action of hecke operators on both sides . by",
    "4.2 ) , we have a hecke equivariant isomorphism @xmath511 , with the compact cohomology group defined at the end of the introduction .",
    "therefore @xmath171 is isomorphic to @xmath512 as hecke modules , and since the latter space is hecke isomorphic with @xmath318 by a version of the eichler - shimura isomorphism , the conclusion follows .",
    "we keep the assumptions and notation of the previous section , namely @xmath1 is a finite index subgroup of @xmath18 , @xmath513 is character with kernel of finite index in @xmath1 , @xmath7 is a double coset of @xmath1 satisfying , and @xmath34 is a function on @xmath7 which satisfies .    for the proof of the trace formula sketched in we need two easy lemmas .",
    "[ l5 ] @xmath514 for all @xmath161 we have @xmath515 where @xmath516 , and @xmath517 .",
    "@xmath518 when @xmath519 and @xmath81 , let @xmath520 be the constant polynomial with @xmath521 for all @xmath522 .",
    "for @xmath523 we have @xmath524 for some @xmath525 where [ 4.1 ] _ , ( m)= _ ( m_a ) , where we write as usually @xmath526 with @xmath527 , @xmath528 .",
    "\\(a ) we apply lemma [ l2.2 ] .",
    "the pairing @xmath529 on @xmath432 is @xmath24-invariant , and we define a pairing on @xmath473 by @xmath530 } \\sum_{a\\in \\g\\backslash\\g_1 } { \\,\\langle\\,}p(a ) , { \\overline{q(a ) } } { \\,\\rangle\\,}\\;.\\ ] ] it is clear that the definition is independent of the system of representatives chosen in the summation , and this pairing is nondegenerate and @xmath18-invariant .    the space of @xmath18-invariants in @xmath166 is trivial if @xmath531 , and it is one dimensional spanned by the element @xmath532 defined in ( b ) if @xmath519 and @xmath81 .",
    "we conclude from lemma [ l2.2 ] that @xmath179 and @xmath180 generate @xmath166 in the former case , while in the latter they generate a codimension 1 subspace in @xmath533 .",
    "since they are both subspaces of @xmath534 , which has codimension 1 in @xmath533 as well , the proof of part ( a ) is finished .",
    "\\(b ) since @xmath535 , we have @xmath536 , for some @xmath537 . applying the operator @xmath538 to both sides of this equation",
    ", we obtain @xmath539=\\sum_a p_0|_\\ss m(a).\\ ] ] from the definition of the action @xmath175 we obtain @xmath540 as claimed .",
    "[ l1]assume that @xmath72 if @xmath123 . for any @xmath187",
    "we have @xmath541 where @xmath542    if @xmath73 the signs can be chosen arbitrarily .",
    "if @xmath124 , assumption implies that @xmath65 and @xmath543 can not both belong to @xmath7 , so in each term at most one choice of signs is possible .",
    "let @xmath544 be a system of representatives for @xmath545 .",
    "we have a decomposition @xmath546 where @xmath547 is the space of @xmath174 with @xmath548 if @xmath549 . if @xmath550 , then @xmath65 maps @xmath551 into @xmath552 ; if @xmath553 , there are unique @xmath554 , @xmath555 such that @xmath556 ( the sign can be assumed @xmath557 if @xmath123 ) , and @xmath558 it follows that the space @xmath551 contributes to the trace only if @xmath559 , that is @xmath560 , and its contribution is @xmath561 the conclusion follows from the fact that the last trace is @xmath562 .      when @xmath563 , the proof is given in , where in the first line we use proposition [ l2.1 ] , in the second lemma [ l5 ] , and in the third lemma [ l1 ] .",
    "assume @xmath564 .",
    "the case @xmath242 reduces to formula , which follows from the kronecker - hurwitz formula , which is the case @xmath244 .",
    "indeed it is enough to prove for @xmath565 , and denoting by @xmath566 its left hand side , we have from the decomposition @xmath567 and the case @xmath244 that @xmath568 satisfies @xmath569 .",
    "since @xmath570=|\\g_1\\backslash\\xi_n|$ ] also satisfies this relation , and @xmath571 for @xmath33 prime , it follows by induction that @xmath572 .    by property   and",
    "lemma  [ l5 ] ( b ) , the second equality in becomes @xmath573 where @xmath157 satisfies - , and we have to show that the sum on the right gives the extra contribution on the second line of .",
    "since both sides of are additive under taking union of double cosets , without loss of generality we can assume that @xmath574 for some @xmath575 .",
    "by  , @xmath34 is constant on @xmath7 , and gives @xmath576 } |\\{a\\in \\g\\backslash\\g_1 \\;:\\ ;   ma^{-1}\\in \\g_1\\ss    \\}|\\;,\\ ] ] which vanishes if @xmath577 and equals @xmath578 for @xmath579 . denoting by @xmath580 the cardinality of the set @xmath581",
    ", we obtain that [ 12 ]    _ m c(m ) _ , ( m)&= _ , (  ) _ ( ) + & = -( ) e_( ) ,    where the first equality follows from and the second from the kronecker - hurwitz formula  ,    set @xmath582 for @xmath374 either @xmath1 of @xmath18 .",
    "the condition @xmath583 can be written as @xmath584 , so @xmath585 $ ] . since @xmath574 and @xmath586 , by ( * ? ? ?",
    "* prop.3.1 ) we have @xmath587 , \\quad |\\g_1\\backslash \\g_1\\ss|=[\\g : \\g \\cap   \\g_1^\\ss]\\;,\\ ] ] so the condition @xmath588 is equivalent to @xmath589 .",
    "we get @xmath590 } \\cdot e_\\g(\\ss)=     \\frac{[\\g_1:\\g_1^\\ss]}{[\\g_1:\\g]}\\cdot [ \\g_1^\\ss:\\g^\\ss]=     [ \\g:\\g^\\ss]=|\\g\\backslash\\ss|,\\ ] ] and shows that the extra contribution in   when @xmath591 is @xmath592 .      to show that the trace formula on the cuspidal subspace in theorem  [ tss ] is equivalent to  , let @xmath593 be the sum in   over the conjugacy classes @xmath135 with  @xmath594 . only the hyperbolic classes @xmath74 with representatives @xmath136 fixing two ( distinct ) cusps of @xmath1",
    "contribute to the sum , and @xmath67 for these classes @xcite .",
    "let @xmath595 be a system of representatives for the aforementioned conjugacy classes that have eigenvalues @xmath108 or @xmath596 .",
    "since @xmath597 , we obtain ( recall @xmath598 is the sign of the eigenvalues of @xmath90 ) : @xmath599 , e_k(\\g,\\chi))-\\sum_{a , d>0}\\min(a , d)^{k-1}\\phi_{\\g,\\ss}^\\chi(a , d)+    \\delta_{k,2}\\delta_{\\chi,{\\bf 1}}\\!\\ ! \\sum_{\\ss\\in\\g\\backslash\\ss}\\!\\ ! \\wc(\\ss)\\ ; ,    \\end{aligned}\\ ] ] where the second equality follows from part ( b ) , and the third from part ( a ) of theorem [ t5.1 ] , using also the symmetry of @xmath126 . using the form given in   of the sum over cusps in , the equivalence of the two trace formulas in theorems  [ tf ] and  [ tss ] is now clear .",
    "in the first part of this section we take @xmath1 to be fuchsian subgroup of the first kind and we compute the trace of the double coset operator @xmath11 $ ] given by on the eisenstein subspace @xmath600 . here",
    "@xmath7 is any double coset contained in the commensurator of @xmath1 inside @xmath51 .",
    "we relate the result with the sum over conjugacy classes @xmath74 with @xmath594 in the trace formula in theorem [ t2 ] .",
    "this was used in the last section to show that theorem  [ t2 ] is equivalent to theorem  [ tss ] , for an arbitrary @xmath1 .    in  [ sec4 ] we take @xmath1 to be a finite index subgroup of @xmath18 and @xmath172 a double coset satisfying  .",
    "we show that the trace of @xmath11 $ ] on the eisenstein subspace is the same as the trace of an operator  @xmath154 satisfying , and acting by  @xmath177 on the space of coboundary polynomials .",
    "we start by introducing some notation and terminology related to the cusps . for a parabolic or hyperbolic matrix @xmath601 ,",
    "we denote by @xmath602 the sign of the eigenvalues of @xmath90 . for @xmath84 a cusp of @xmath1",
    ", we let @xmath603 be the stabilizer of @xmath84 in @xmath1 .",
    "thus @xmath604 if @xmath73 , and @xmath605 if @xmath133 , for a generator @xmath606 , with @xmath607 if @xmath608 .",
    "let @xmath609 be a scaling matrix for the cusp @xmath84 , namely @xmath610 , and [ 5.0 ] c__c_^-1= ( _  ) 1101 .",
    "we assume that scaling matrices for equivalent cusps satisfy @xmath611 .    for @xmath612 ( the commensurator of @xmath1 ) , there exists @xmath613 such that @xmath614 , and since @xmath615 is a parabolic element fixing @xmath616 , we have that @xmath617 is also a cusp of @xmath1 , and [ 5.2 ] _^n ^-1=_^m , for some @xmath618 . as @xmath619 we have [ 5.31 ] c_c_^-1=b0d_(),for some @xmath620 , and therefore @xmath621 raising the previous relation to the power @xmath622 and using we obtain that the ratio [ 5.4 ] = mn is a positive rational number .",
    "[ r2 ] for fixed @xmath84 , the constants @xmath623 , @xmath624 only depend on the coset @xmath625 since @xmath626 .",
    "moreover @xmath623 , @xmath624 are invariant under the map @xmath627 , for  @xmath325 .",
    "it follows that by scaling the double coset @xmath7 we can assume that @xmath628 for all cusps @xmath84 and @xmath48 .      for an eisenstein series @xmath629 , the constant term @xmath630 of @xmath631 at the cusp @xmath84",
    "is defined as the constant term of the fourier expansion of @xmath632 : @xmath633 from we have @xmath634 , so @xmath630 vanishes unless @xmath635",
    ". therefore we define @xmath636 which is @xmath1-invariant , and we let @xmath637 be sets of representatives for @xmath1-equivalence classes of cusps in @xmath638 , respectively in @xmath639 . when @xmath81 , the trivial character , we have @xmath640 if @xmath128 is even , while @xmath641 is the set of regular cusps if @xmath128 is odd and @xmath124 .",
    "since @xmath642 is a scaling matrix for @xmath643 for @xmath325 , it follows that @xmath644 .",
    "identifying the vector space @xmath645 with the space of maps @xmath646 , we have an injective map [ 5.9 ] e_k(,)^|c(,)|,ea_e .",
    "this map is a bijection , unless @xmath241 and @xmath647 , when @xmath648 and we have an exact sequence [ 5.10 ] 0e_2 ( ) ^|c()| 0 .",
    "we can now compute the constant terms of @xmath649 $ ] , for @xmath650 a double coset . for a cusp @xmath651 and @xmath629 we have by @xmath652|_k c_\\aa^{-1}= \\sum_{\\ss \\in \\g\\backslash\\ss } \\det\\ss^{k-1 } \\wc(\\ss ) e|_k\\ss c_a^{-1}\\;.\\ ] ] replacing @xmath653 from in the previous relation , and taking @xmath654 we obtain [ 5.5 ] a_0(e|[]|_k c_^-1)=_\\ a_0(e|_kc_^-1 ) (  ) .      using the previous formula ,",
    "we compute @xmath459 , e_k(\\g,\\chi))$ ] in the next theorem .",
    "first we prove a lemma interesting in its own right , which is needed for the case @xmath241 , @xmath81 , and whose proof will be used in the proof of the theorem .",
    "[ l5.1 ] let @xmath1 be a fuchsian group of the first kind , and let @xmath650 be a double coset .",
    "then @xmath655 independent of the cusp @xmath84 of @xmath1 , where @xmath656 .",
    "for each @xmath657 , let @xmath658 .",
    "each coset @xmath625 contains a representative @xmath659 with @xmath660 , where @xmath661 is the fixed representative in @xmath85 of the equivalence class of cusps @xmath662 , and if @xmath663 is another such representative we have @xmath664 .",
    "a similar reasoning applies to right cosets , so we have the disjoint decompositions ( with a slight abuse of notation ) [ 5.14]\\=_c ( ) _ \\_ , /=_c ( ) _ /_ . for @xmath105 , let [ 5.20 ] _",
    "(a , d)=\\{_ : c_c_^-1 = (  ) a*0d } = _ ^+(a , d)_^-(a , d ) , where @xmath665 consist of those @xmath666 having @xmath667 .",
    "the first decomposition gives [ 5.11]_\\ = _ a , d>0 a _",
    "c()1d |_\\_(a , d)| .",
    "the set @xmath668 is left invariant by  @xmath669 and right invariant by  @xmath670 , and we show that [ 5.15 ] 1d| _ \\_(a , d)|= 1(a , d )    remark  [ r2 ] that @xmath671 .",
    "we also assume for simplicity that @xmath672 , the other case being similar .",
    "we have @xmath673 , and multiplying @xmath674 on the left by @xmath675 and on the right by @xmath676 changes @xmath677 .",
    "therefore a set of representatives for @xmath678 is @xmath679 while a set of representatives for @xmath680 , respectively @xmath681 , is the same set , with the range for @xmath682 replaced by @xmath683 , respectively @xmath684 , proving  .",
    "using  , formula becomes @xmath685 by the second decomposition in .",
    "since the numbers of left and right cosets in a double coset are equal for a fuchsian group of the first kind , the claim follows .",
    "[ t5.1 ] @xmath514 for a cusp @xmath84 of @xmath1 , let @xmath686 be the stabilizer of @xmath84 in @xmath7 .",
    "then [ 5.8 ] ( [ ] , e_k ( , ) ) = _ a , d>0 a^k-1_,^(a , d)-_k,2_,*1 * _ \\ (  ) , where for @xmath105 we set @xmath687 and [ 5.6 ] _ , ^(a , d)= _ c ( , ) _",
    "_\\_(a , d)/_()^k (  ) , with @xmath93 the smallest positive generator of the lattice @xmath688 ( which is well defined since @xmath92 by ) .",
    "@xmath689 the function @xmath690 is symmetric in @xmath108 and for @xmath691 we have [ 5.7 ] _ , ^(a , d)= _ h_,(a , d)()^k()where @xmath595 is a system of representatives for the hyperbolic @xmath1-conjugacy classes @xmath135 that fix cusps of @xmath1 , and that have eigenvalues @xmath108 or @xmath692 .",
    "\\(a ) by , the action of @xmath11 $ ] on eisenstein series corresponds to an action on @xmath693 given by [ 5.13]p| [ ] ( )=_\\ p (  ) (  ) , ^|c(,)| .if @xmath563 , the isomorphism gives [ 5.16 ] ( [ ] , e_k(,))= ( [ ] , ^|c(,)|)=_c ( , ) _",
    "_\\_ (  ) .",
    "if @xmath241 and @xmath81 , let @xmath694 such that @xmath695 for all @xmath696 .",
    "we claim that @xmath697= p_0 \\cdot \\!\\ !",
    "\\sum_{\\ss\\in\\g\\backslash\\ss}\\!\\ ! \\wc(\\ss)\\ ; ; \\ ] ] indeed , we can assume without loss of generality that @xmath698 is a primitive double coset , so @xmath34 is constant on @xmath7 and by we obtain that @xmath699(\\aa)$ ] is given by the left hand side of the identity in lemma [ l5.1 ] , multiplied by @xmath700 .",
    "the exact sequence then gives @xmath12 , e_k(\\g,\\chi))=\\tr([\\ss ] , \\c^{|c(\\g,\\chi)| } ) -\\!\\ !",
    "\\wc(\\ss ) \\;.\\ ] ]    to prove , we rewrite as @xmath459 , \\c^{|c(\\g,\\chi)|})=\\sum_{a , d>0 } a^{k-1}\\psi_{\\g,\\ss}^\\chi(a , d)$ ] , with [ 5.12 ] _ , ^(a , d)= _ c ( , ) _",
    "_\\_(a , d)()^k (  ) , with @xmath701 defined in . since @xmath702 is invariant under @xmath703 and @xmath704 , for @xmath705 and @xmath706 , and @xmath701 is also left and right invariant under multiplication by @xmath670 , it is enough to show that @xmath707 which was proved in more generality in .",
    "we conclude that @xmath708 , proving  .",
    "\\(b ) that @xmath126 is symmetric follows from , since the right hand side , which we denote @xmath709 , is obviously symmetric in @xmath108 .",
    "each @xmath710 fixes two cusps , and exactly one of them , denoted @xmath84 , satisfies @xmath711 . when @xmath73 we can assume @xmath712 , and denoting by @xmath713 either @xmath714 ( defined in ) if @xmath73 , or @xmath715 if @xmath716 , we have @xmath717 where @xmath718 denotes the conjugation action of @xmath670 on @xmath713 , and the sum is over any system of representatives for the orbits of this action .",
    "the set @xmath713 is invariant under left and right multiplication by the group @xmath719 generated by @xmath720 .",
    "changing variables @xmath721 for @xmath722 in the sum over @xmath90 , on one hand leaves the sum invariant , and on the other hand scales the sum by @xmath723 . therefore the inner sum vanishes , unless @xmath724 for @xmath725 , that is unless @xmath706 .    assuming therefore @xmath706 , we have to show that @xmath709 equals the term corresponding to the cusp  @xmath84 in  .",
    "this follows from @xmath726 whose proof is similar to the proof of .",
    "now let @xmath1 be a finite index subgroup of @xmath18 , @xmath172 a double coset satisfying , @xmath3 a character of @xmath1 and @xmath34 a function on @xmath7 satisfying .",
    "let @xmath6 and set @xmath30 .",
    "we give a direct proof that @xmath727 , e_k(\\g,\\chi))\\;,\\ ] ] for any @xmath155 satisfying , by computing the left hand side and showing it agrees with the trace on the eisenstein subspace in theorem  [ t5.1 ] .",
    "the equality of the two traces follows also by comparison with the theory of modular symbols of ash and stevens @xcite , as shown in the proof of proposition  [ l2.1 ] , but for completeness we give a direct proof here .",
    "the computation is of interest in its own right , as it is equivalent via poincar duality with computing the trace of hecke operators on modular symbols for @xmath1 , which has not been done in this generality before .    in section [ s2 ]",
    "we showed in greater generality that we have a surjective map @xmath728 which is hecke equivariant as in .",
    "this map is bijective if the space of @xmath18-invariants in @xmath166 is trivial , namely if @xmath729 . in this case",
    "we conclude from that @xmath730 while the case @xmath731 is discussed in the proof of theorem [ p6.1 ] .    for @xmath732 , we have @xmath733 , and the constants @xmath734 satisfy @xmath735 for @xmath325 , @xmath736 .",
    "let @xmath737 be a system of representatives for _ the cusp space _",
    "@xmath738 , which is in bijection with a set of representatives @xmath85 for @xmath1-equivalence classes of cusps of @xmath1 by @xmath739 .",
    "it follows that the dimension of @xmath740 equals the cardinality of the set [ 39 ] r(,)=\\{cr ( ) : ( ct^jc^-1)=^w ct^jc^-1 \\{1 } } , which is in bijection with the subset @xmath741 defined before theorem [ tss ] .",
    "note that when @xmath3 is trivial , @xmath716 and @xmath163 is odd , this is the set of regular cups , namely those @xmath742 with @xmath743 for all @xmath744 .",
    "let @xmath745 and @xmath746 .",
    "for @xmath747 , let @xmath748 be the smallest positive integer such that @xmath749 .",
    "that is , @xmath748 is the width of the cusp @xmath750 if @xmath751 , or it is half the width if @xmath124 and @xmath752 .",
    "[ p6.1]@xmath514 assume @xmath172 satifies , and @xmath155 satisfies . with the above notation we have [ te](c_w^,| _ _ n)= _ d^k-1_,^(a , d ) -_k,2_,*1 * _ \\ (  ) where [ 42 ] _ , ^(a , d)=_cr ( , ) _",
    "( 1)^w(cm c^-1 ) .",
    "@xmath518 the function @xmath690 defined above is the same as in and we have @xmath727 , e_k(\\g,\\chi))\\;.\\ ] ]    \\(a ) to compute the trace in the right side of , we choose a basis of @xmath740 indexed by the set @xmath753 defined in .",
    "namely , for @xmath747 , let @xmath754 such that @xmath755 , if @xmath756 , which defines @xmath757 uniquely .",
    "with respect to this basis , we obtain @xmath758 we have @xmath759 , unless @xmath760 for some @xmath761 , @xmath762 , when @xmath763 , and we conclude    [ 4.11 ] ( d_w^,| _ t_n^)= _ d^k-1 _ cr(,)1d _ ( 1)^w ( ct^im c^-1 ) , where @xmath764 for each @xmath747 we denote by @xmath765 the terms following the sum over @xmath750 in the right hand side . to show that the inner two sums equal @xmath766 , we show that @xmath767 equals the term in   corresponding to a fixed  @xmath750 .",
    "fixing @xmath750 , we write @xmath768 , and denote @xmath769 . since the range of summation for @xmath770 is @xmath771 , replacing the range by @xmath772 scales @xmath773 by @xmath774 . replacing each @xmath65 by @xmath775 in the inner sum in leaves the summand and the range unchanged ,",
    "so we can now reduce the range to @xmath776 , scaling @xmath773 by @xmath777 .",
    "since summing over @xmath778 with @xmath776 is the same as summing over @xmath779 we obtain : @xmath780 let @xmath781 ( if @xmath133 the union in parantheses is disjoint , by assumption ) .",
    "a system of representatives for the elements @xmath65 contributing to the last sum are exactly @xmath782 , with @xmath783 in a system of representatives for @xmath784 and @xmath785 , and they are all distinct in @xmath786 by property .",
    "we obtain [ 4.12 ] _",
    "c(a , d)=_mt^\\_c(a , d)/t^ ( 1)^k ( c m c^-1),where the choice of signs is made in each term such that @xmath787 .",
    "the last sum is the same as the inner sum in   for a fixed  @xmath750 , which proves formula when @xmath563 .",
    "assume @xmath788 .",
    "let @xmath789 be the constant polynomial @xmath790 for @xmath522 , where we view elements of @xmath533 and of its subspaces as functions from @xmath791 to @xmath792 .",
    "we have an exact sequence @xmath793 we assume the set of representatives @xmath794 for @xmath738 contains the identity matrix @xmath60 . using the exact sequence , a basis of @xmath795 consists of @xmath796 . for a fixed @xmath742 with @xmath797",
    "we have @xmath798 where @xmath799 , @xmath800 .",
    "it follows that @xmath801 where in the last line we assumed without loss of generality that @xmath698 , so that @xmath34 is constant on @xmath7 .",
    "we claim that each set in the last sum contains only one element . for @xmath802",
    "we have @xmath803 with @xmath464 , @xmath804 , and by property the coset @xmath805 does not depend on the decomposition .",
    "again by property applied to both @xmath7 and @xmath806 , the condition @xmath807 is equivalent with @xmath808 , so @xmath809 , which determines @xmath742 uniquely .",
    "it follows that the last sum equals @xmath810 .",
    "\\(b ) we have a bijection @xmath811 given by @xmath812 , and as scaling matrix we can take @xmath813 in .",
    "we also have a bijection @xmath814 given by @xmath815 , where the sign can be chosen positive if @xmath123 , and only one choice is possible if @xmath133 ( since @xmath816 by ) .",
    "we conclude that the right hand sides of and are equal term by term , and the equality of the two traces follows from the symmetry of @xmath126 proved in theorem [ t5.1 ] ( b ) .",
    "we now compute the functions @xmath127 , @xmath126 in , to prove the theorems stated in the introduction for @xmath31 .",
    "we use the formula for @xmath126 given in . in  [ sec5.1 ] we consider the usual hecke operators for  @xmath817 , while in  [ sec5.2 ] we consider a composition of hecke and atkin - lehner operators on @xmath285 .      in this section , we take @xmath818 , @xmath819 as in , and @xmath3 , @xmath34 defined there . if @xmath72 , we have @xmath820 , defined in .",
    "the function @xmath821 satisfies assumption  [ h ] , and it was computed explicitly by oesterl  ( * ? ? ?",
    "* eq.(35 ) ) . for completeness",
    "we reproduce the proof in the next lemma .",
    "recall that for @xmath231 , @xmath234 , in the introduction we have defined the set @xmath822 the assumptions on @xmath277 ensure that the class modulo @xmath45 of an integer @xmath823 satisfying the congruence mod @xmath824 is indeed well - defined .",
    "[ l9]for @xmath825 , let @xmath826 , and @xmath827 where @xmath374 is the content of the quadratic form @xmath828 $ ] .",
    "then @xmath829    for @xmath830 , we have @xmath831 , where @xmath823 satisfies @xmath832 the condition @xmath833 is equivalent to @xmath834 and @xmath835 , so we have @xmath836 , where we set @xmath827 .",
    "moreover , @xmath823 satisfies @xmath837 , that is @xmath838 which determines its class mod @xmath45 uniquely depending only on the point @xmath839 , namely on the coset of @xmath840 in @xmath841 .",
    "set @xmath842 .",
    "we have therefore a well - defined map @xmath843 we show that @xmath844 independent of @xmath836 , which would prove the claim .",
    "let @xmath845 such that its reduction mod @xmath45 belongs to @xmath846 .",
    "we have @xmath847 if and only if the corresponding point @xmath839 is a solution of the system .",
    "therefore it is enough to count the solutions @xmath848 of the system  .",
    "since @xmath849 we have @xmath850 recall that @xmath851 , so @xmath852 .",
    "since @xmath853 , it follows that @xmath854 ( othwerwise there exists a prime power @xmath855 and @xmath856 such that @xmath857 , @xmath858 , which would imply @xmath859 , a contradiction ) .",
    "therefore we have @xmath860 as well , and setting @xmath861 , @xmath862 , @xmath863 , @xmath864 , @xmath865 , we have that @xmath866 these conditions imply that the system , which becomes @xmath867 has a unique solution @xmath868 .",
    "this solution lifts to @xmath869 solutions in @xmath870 of the system , finishing the proof .    to compute the function @xmath871 in",
    ", we use the formula in theorem  [ p6.1 ] .",
    "[ ta2 ] let @xmath6 , and @xmath3 a character modulo @xmath264 of conductor @xmath872 such that @xmath72 .",
    "if @xmath873 we have @xmath874 where @xmath270 is the unique solution mod @xmath875 of @xmath876 , @xmath877 .",
    "since @xmath123 , formula gives @xmath878 we choose the set of representatives @xmath794 for @xmath738 to consist of matrices @xmath879 with @xmath880 , and @xmath236 running through a set @xmath881 with @xmath882 .",
    "the condition @xmath883 whenever @xmath884 is the same as @xmath885 if @xmath886 , namely if @xmath887",
    ". this can happen if and only if @xmath3 has conductor @xmath888 , hence @xmath753 consists of those @xmath742 as above with @xmath889 .",
    "the width of the cusp @xmath890 is @xmath891 .",
    "let @xmath892 for a fixed @xmath893 as above , and set @xmath778 with @xmath682 well - defined @xmath894 where @xmath895 . by , the condition @xmath896 for some @xmath897 is equivalent to : @xmath898 and with @xmath835 .",
    "therefore @xmath899 , @xmath900 , which determines @xmath823 uniquely modulo @xmath901 , thus it determines @xmath902 uniquely since @xmath903 .",
    "we also have @xmath904 and since @xmath905 , there are @xmath384 solutions @xmath906 of the congruence @xmath907 , independent of @xmath908 .",
    "we conclude [ 31 ] _",
    "n,(a , d)=_n = rs ( ) |_r| with @xmath270 , @xmath882 , and @xmath909 in the summation range .",
    "let @xmath223 and for @xmath910 with @xmath293 consider the double coset @xmath911 , where @xmath912 with @xmath913 .",
    "the coset space @xmath914 consists of one element @xmath915 , and the atkin - lehner involution @xmath286 on @xmath41 is given by @xmath916 $ ] with @xmath30 .",
    "we let @xmath266 be arbitrary and consider the composition of hecke and atkin - lehner operators @xmath917 $ ] .",
    "we have @xmath918 the double coset @xmath919 is characterized by the same conditions , except that @xmath920 is replaced by @xmath921 . if @xmath922 , the last two conditions are empty , so the double cosets @xmath923 , @xmath924 commute , but that is not the case when @xmath925 , when the operators @xmath926 , @xmath286 do not commute .",
    "if @xmath925 the double coset @xmath919 does not satisfy property , so it is important that we choose to work with @xmath927 .",
    "[ l8 ] the double coset @xmath927 satisfies property .",
    "let @xmath928 .",
    "we have to show that if @xmath929 and @xmath930 such that @xmath931 , then we have @xmath932 .",
    "indeed , we have @xmath933 and @xmath934 and since @xmath935 , @xmath920 , we conclude that @xmath936 , so @xmath932 .    for @xmath223 and @xmath937 , assuming @xmath6 is even we have [ 6.5]_,(m)=_n,(m):=\\{a_0(n)\\_1 : ama^-1_n_}. in the next lemma we show that @xmath938 satisfies assumption  [ h ] , and we compute it explicitly in terms of @xmath939 given by , for @xmath291 the trivial character modulo @xmath940 .",
    "[ l6 ] for @xmath941 , set @xmath826 , and let @xmath374 be the content of the associated quadratic form @xmath942 .",
    "then the coefficient @xmath943 defined above is 0 if @xmath944 and for @xmath945 it is given by @xmath946 where @xmath947 is computed in lemma [ l9 ] .",
    "the coefficients @xmath948 are computed explicitly in lemma  [ l4 ] .",
    "let @xmath949 . by and we have @xmath950 assuming from now on @xmath951 ( otherwise the previous set is empty ) , let @xmath952 , and @xmath953 .",
    "the coset of @xmath384 in @xmath791 is identified with the point @xmath954 . by",
    ", the conditions @xmath955 , @xmath956 are equivalent to @xmath957 since @xmath958 , the condition @xmath959 implies @xmath960 .",
    "conversely , if @xmath961 it follows that @xmath962 divides all entries of @xmath963 , so @xmath964 .",
    "therefore the condition @xmath959 is equivalent to @xmath960 .",
    "since @xmath965 , the chinese remainder theorem gives @xmath966 with @xmath967 given by for the trivial character @xmath968 mod @xmath940 , and @xmath969 equals 0 if @xmath970 , while @xmath969 denotes the number of solutions @xmath971 of the system if @xmath960 . as @xmath972",
    ", we have @xmath960 if and only if @xmath973 , and in this case the system has exactly one solution .",
    "we conclude @xmath974 by and the formula for @xmath947 in lemma [ l9 ] and , this finishes the proof .",
    "[ l4 ] for any @xmath264 and for @xmath975 we have @xmath976 where @xmath977 , and the coefficients @xmath303 , defined for @xmath978 , are multiplicative in @xmath304 , namely @xmath979 if @xmath980 with @xmath962 prime and @xmath981 we have @xmath982 and setting @xmath983 ( with @xmath984 if @xmath217 ) , for @xmath985 we have : if @xmath962 is odd then @xmath986 where @xmath987 denotes the legendre symbol , while if @xmath988 then @xmath989 where @xmath990 is the quadratic character mod 4 .    if @xmath991 , then @xmath992 for all @xmath231 , so the constants @xmath301 are all 0 .",
    "since @xmath993 , we can write @xmath994 for some function @xmath303 . the function @xmath303 is multiplicative in @xmath45 , as @xmath995 and @xmath996 are multiplicative , and , by , if @xmath980 it equals @xmath997 with the second term in the numerator missing if @xmath998 .",
    "the cardinality of the set @xmath999 is straightforward to compute , leading to the formulas above .",
    "to finish the proof of theorem [ t1.1 ] , we compute the function @xmath1000 in theorem  [ p6.1 ] .    [ ta1 ] we have @xmath1001 unless @xmath1002 and @xmath1003 , when @xmath1004    let @xmath895 and set @xmath1005 .",
    "we have [ 6.8 ] _",
    "n,(a , d)=1 g _ cr ( ) # \\{b : cm_b c^-1_n_}.the previous set is empty unless @xmath1006 and @xmath1003 , which we assume throughout the proof .",
    "writing @xmath1007 with @xmath1008 square - free , it follows that @xmath1009 .",
    "we let @xmath737 be the set of representatives for the cusp space @xmath738 chosen in the proof of proposition [ ta2 ] .",
    "namely , @xmath794 consists of @xmath879 with @xmath1010 , and @xmath1011 running through a set @xmath1012 with @xmath1013 , where @xmath1014 .",
    "the width of the cups @xmath890 is @xmath1015 .",
    "let @xmath1016 .",
    "the condition @xmath1017 is equivalent to @xmath1018 let @xmath1019 , @xmath1020 , with @xmath1021 , @xmath1022 .",
    "the two congruences above become @xmath1023 and the first two have a solution with @xmath1024 , @xmath1025 if and only if @xmath1026 and @xmath1027 , @xmath1028 , @xmath1029 .",
    "the third gives @xmath1030 , so @xmath1031 since @xmath1009 , it follows that @xmath1032 and @xmath1033 , so @xmath1034 and @xmath1035 .",
    "we conclude @xmath1036 where @xmath1037 and the sum is over @xmath1027 , @xmath1028 , @xmath1029 .",
    "we used that the cardinality of the set in is independent of @xmath1038 , and @xmath1039 .",
    "since @xmath1040 is fixed in the set above and @xmath1041 , we have to count the number of @xmath1042 with @xmath1043 fixed and @xmath1044 , where @xmath1045 satisfies @xmath1046 . letting @xmath1047 with @xmath1048 and @xmath1049",
    ", the number of such @xmath1042 is @xmath1050 using that @xmath1051 has the same prime factors as @xmath287 . inserting this cardinality into the formula for @xmath1052 above yields the claim .",
    "for completeness , we give an explicit element @xmath152 satisfying the properties  , , in the introduction .",
    "this in fact shows that _ any _ element satisfying , also satisfies , since we show in @xcite that an element @xmath152 satisfying  ,   is uniquely defined modulo the set @xmath1053 whose elements do not affect property .",
    "this element was found in collaboration with zagier , and a more conceptual proof that any element satisfying   and   also satisfies   will be given in the joint paper  @xcite .",
    "let @xmath1054 be an integer . we show that the following @xmath507 satisfies , , ( matrices with noninteger entries should be removed from the sum ) [ 81 ] _",
    "n c(m ) m+ _ ab0d + 00 + ( x - s x s)+[y+ z - u^2 ( y+z ) u ] where @xmath1055 and @xmath1056 consists of a specific set of representatives for the elliptic @xmath18-conjugacy classes in @xmath1057 .",
    "to define it , we let @xmath1058 be the closure of a fundamental domain for @xmath1059 . for an elliptic @xmath1060 we denote by @xmath1061 $ ] the associated quadratic form and by @xmath1062 the unique fixed point of @xmath65 in @xmath1063 , which satisfies @xmath1064 . we define @xmath1056 to be the set of @xmath523 such that @xmath942 is positive definite and @xmath1065 , and",
    "if @xmath1066 we impose the following conditions to ensure @xmath1056 contains exactly one representative from each conjugacy class : @xmath1067      clearly the operator @xmath154 satisfies property for any @xmath1068 , by the reduction theory of binary quadratic forms .",
    "the terms @xmath1069 are chosen so that @xmath154 satisfies as follows @xmath1070 where some inequalities in @xmath1071 between parantheses as above stand for @xmath1072 , with the range of summation given by those inequalities .",
    "these elements were found numerically , using ` magma `  @xcite .    in @xcite",
    "we show that any operator satisfying and also satisfies  , as a consequence of the kronecker - hurwitz formula .",
    "therefore it remains to show that  @xmath154 satisfies  , and we first simplify formula  , making use of cancellations among the terms .",
    "the term @xmath1073 is given by @xmath1074 where we denote by @xmath1075 , @xmath1076 , and @xmath750 , the first , second , and third sum respectively , which consist of matrices @xmath1077 with fixed point having @xmath1078 , @xmath1079 , and @xmath1080 respectively .",
    "the prime in the sum @xmath750 indicates that matrices with @xmath1081 , @xmath1082 have coefficient 1/2 , matrices with @xmath1083 have coefficient 1/3 , and matrices with @xmath1084 have coefficient -1/12 ( this latter convention will be used to include the term with coefficient 1/6 in the sum ) .",
    "we have : @xmath1085 let @xmath1086 , respectively @xmath1087 be the parts of @xmath1088 for which @xmath1089 , respectively @xmath1090 ; let @xmath1091 , @xmath1092 the parts of @xmath1093 for which @xmath1094 , respectively @xmath1095 ; let @xmath1096 , @xmath1097 be the parts of @xmath1075 for which @xmath1098 , respectively @xmath1099 ; finally let @xmath1100 , @xmath1101 be the parts of @xmath1076 for which @xmath1094 , respectively @xmath1095 .",
    "we have @xmath1102 and the boundary terms in @xmath1101 and @xmath1092 can be combined to yield @xmath1103 the second sum in can be absorbed in the sum @xmath1104 as the boundary term for which @xmath1105 , and becomes : @xmath1106      let @xmath1107 consist of the matrices in having noninteger coefficients : @xmath1108 where the term involving @xmath1109 contains the terms with @xmath218 or @xmath1110 in the first equation . since @xmath1111 , the element @xmath1112 clearly satifies property .",
    "we will write @xmath1113 , where @xmath1075 , respectively @xmath1114 satisfy the first , respectively the second relation in , which would show that @xmath154 satisfies . from and the formula for @xmath1107 above , we have @xmath1115 @xmath1116 and since @xmath1114 has only terms with negative coefficients , it is an easy check that @xmath1117(1+u+u^2)\\ ] ] where the double prime indicates that the terms with @xmath1081 and @xmath1118 are to be counted with coefficient 1/2 in the sum .",
    "9999 a. ash , g. stevens , _ modular forms in characteristic @xmath287 and special values of their l - functions_. duke math .",
    "j. 53 ( 1986 ) , 849868 bosma , w. , cannon , a. , and playoust , c. , _ the magma algebra system .",
    "i. the user language .",
    "_ j. symbolic comput . , 24 ( 1997 ) , 235265 . y.j . choie and d. zagier ,",
    "_ rational period functions for psl(2,z ) .",
    "_ contemporary math . 143 ( 1993 ) , 89108 h. cohen , _ sums involving the values at negative integers of l - functions of quadratic characters _",
    "( 1975 ) , 271285 n. diamantis , _ hecke operators and derivatives of l - functions _ , comp .",
    "3954 m. eichler , _ ber die darstellbarkeit von modulformen durch thetareihen _ , j. reine angew . math . 195",
    "( 1955 ) , 156171 h. haberland , _ perioden von modulformen einer variablen und gruppenkohomologie , i _ , math .",
    "nachr . 112",
    "( 1983 ) , 245282 h. hijikata , _ explicit formula of the traces of hecke operators for @xmath31 _ , j. math .",
    "japan 26 , no.1 ( 1974 ) , 5682 l. merel , _ universal fourier expansions of modular forms_. on artin s conjecture for odd 2-dimensional representations , springer ( 1994 ) , 5994 m.h .",
    "mertens , _ mock modular forms and class number relations .",
    "_ research in the math .",
    "sciences 1:6 ( 2014 ) j. oesterl , _ sur la trace des oprateurs de hecke _ , thse de troisime cycle , universit paris - sud , orsay ( 1977 ) v. paol , a.a .",
    "popa , _ modular forms and period polynomials .",
    "_ proc . lond .",
    "soc . 107/4 ( 2013 ) ,",
    "713743 a.a .",
    "popa , d. zagier , _ a simple proof of the eichler - selberg trace formula _ , in preparation h. saito , _ on eichler s trace formula _",
    ", j. math .",
    "japan vol .",
    "24 ( 2 ) , 1972 a. selberg , _ harmonic analysis and discontinuous groups in weakly symmetric riemannian spaces with applications to dirichlet series _ , j. indian math .",
    "20 ( 1956 ) , 4787 g. shimura , _ introduction to the arithmetic theory of automorphic functions _ , princeton u. press ( 1971 ) g. shimura , _ on the trace formula for hecke operators_. acta math .",
    ", vol . 132",
    "( 1974 ) , 245281 n .- p .",
    "skoruppa , d. zagier , _",
    "jacobi forms and a certain space of modular forms . _ inv . math .",
    "94 ( 1988 ) , 113146 d. zagier , _ hecke operators and periods of modular forms .",
    "_ israel math .",
    "vol . 3 ( 1990 ) , 321336 d. zagier , _ periods of modular forms , traces of hecke operators , and multiple zeta values .",
    "_ research into automorphic forms and @xmath1122-functions ( kyoto , 1992 ) .",
    "srikaisekikenkysho kkyroku 843 ( 1993 ) , 162170"
  ],
  "abstract_text": [
    "<S> we give a new , simple proof of the trace formula for hecke operators on modular forms for finite index subgroups of the modular group . </S>",
    "<S> the proof uses algebraic properties of certain universal hecke operators acting on period polynomials of modular forms , and it generalizes an approach first proposed by zagier for the modular group . </S>",
    "<S> this approach leads to a simple formula for the trace on the space of cusp forms plus the trace on the space of modular forms . </S>",
    "<S> specialized to the congruence subgroup @xmath0 , it gives explicit formulas for the trace of hecke and atkin - lehner operators , which hold without any coprimality assumption on the index of the operators . </S>"
  ]
}