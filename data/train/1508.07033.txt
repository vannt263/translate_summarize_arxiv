{
  "article_text": [
    "the atom - centered point charge ( pc ) model of molecular electrostatics has been a mainstay of biomolecular simulations for decades.@xcite while chemically intuitive and straightforward in technical implementation , this model does not provide a sufficiently detailed description of the anisotropic features of the molecular electrostatic potential ( mep ) , such as lone pairs , @xmath0-systems , and @xmath1-holes , etc .",
    "which are mostly governed by higher - order multipole terms.@xcite these anisotropic effects , however , can be described within the pc approximation by moving beyond the atom - centered paradigm , i.e. by adding non - atom centered pcs / extended points.@xcite although increasing the number of pcs per atom improves the quality of the electrostatic model , it also can exacerbate well - known ill - conditioning and redundancy problems@xcite of the pc fitting procedures , leading to numerically unstable solutions.@xcite    these numerical instabilities are usually related to a large variation of the pc values for atoms in the interior of the molecule , so - called buried atom effect.@xcite the buried atom ( usually methyl and methylene carbons ) charges can dramatically change due to trivial changes in the pc fitting problem ( the probe grid sampling , spatial orientation of the molecule , etc . ) , and/or have inconsistent values across very similar molecules or even conformers of the same molecule.@xcite as the inclusion of non - atom centered pcs into the model produces even more buried centers , it should also increase the numerical instabilities of the pc fitting problem .",
    "in fact , these numerical problems are rooted in the mathematical nature of the pc derivation  the least squares ( ls ) fitting to the reference mep:@xcite @xmath2 @xmath3 @xmath4 where the ls sum @xmath5 is the subject of minimization and the solution satisfies normal equations:@xcite @xmath6 here , the elements of the ls matrix @xmath7 correspond to the inverse distance @xmath8 between the pc @xmath9 and the grid point @xmath10 ; @xmath11 is @xmath12-dimensional vector of the reference values of mep ; @xmath13 is @xmath14-dimensional vector of the pc values ; @xmath15 is the gradient of the function @xmath5 at the origin ( @xmath16 ) ; @xmath17 is the hessian matrix of ls sum @xmath5 .",
    "while the ill - conditioning is common to many ls fitting problems,@xcite numerical difficulties associated with pc fitting are further compounded by commonly used total charge constraint using lagrange multiplier.@xcite    one of the most widely used techniques to alleviate the numerical instabilities of pc fitting is to add artificial restraints to the pc values of the buried atoms.@xcite although this method can be extended to models with off - center pcs / extended points , one may wonder if it would be possible to overcome these difficulties in a more elegant way , based on better physical understanding of the problem .",
    "for instance , an important insight can be gleaned from the eigendecomposition of the ls sum hessian matrix ( eq . [ eq : hessian ] ) : @xmath18 indeed , the ill - conditioned nature of the ls matrix @xmath7 can be related to the significant differences in the eigenvalues @xmath19 , i.e. the ls sum curvatures along the directions defined by the eigenvectors @xmath20.@xcite because of the 23 order of magnitude variation of the @xmath19 values , different sets of pcs can produce essentially the same mep , as these solutions have the same positions along the high - curvature directions , although the positions along the low - curvature directions could be quite different.@xcite importantly , the eigenvectors with the largest curvatures usually correspond to the total charge and dipole moment components of the molecule , while the lower - curvature eigenvectors do not seem to be associated with particular multipole moments.@xcite    however , the exact physical origin of the correspondence between the large curvature eigenvectors and the first terms of the multipole expansion is unclear , along with the nature of the low - curvature eigenvectors .",
    "particularly , it is not clear if the presence of the low - curvature modes of the @xmath17 matrix and thus the ill - conditioning of the ls problem is solely because of the nature of the pc fitting problem , or due to some numerical factors , e.g. an incomplete sampling of the reference mep grid .    to address these questions",
    ", we here revisit the pc fitting problem from the first principles .",
    "while the atom - centered pc model traces back to the intuitive chemical concept of the atomic charge , we consider a general pc model as a case of the inverse problem , where one seeks to recover the source charge distribution from its effect , i.e. electrostatic potential distribution .",
    "based on the properties of the coulomb law , we construct a best - case electrostatic model for which the inverse problem can be solved exactly , both in the continuous case , as well as in the case of a discrete ( non - atom centered ) pc approximation .    using this model",
    ", we investigate the nature of the eigenvectors @xmath20 and their eigenvalues @xmath19 , and dissect the factors responsible for the ill - conditioning of the ls fitting problem , and discuss how these insights can be used to improve and simplify the existing pc derivation procedures .",
    "a problem where given an effect ( in this case the mep @xmath21 ) defined in the region @xmath22 , its cause ( a charge distribution @xmath23 ) defined in the region @xmath24 needs to be determined belongs to a general class of inverse problems and can be described by the fredholm integral equation of the first kind:@xcite @xmath25 where kernel @xmath26 specifies the evolution of the cause @xmath27 into the effect @xmath28 , that in this case corresponds to the coulomb law : @xmath29    the integral equation can also be represented as an operator equation : @xmath30 where @xmath31 is a linear operator defined on space @xmath32 of square integrable functions , and takes values in space @xmath33 ; @xmath34 is adjoint of @xmath35 .",
    "this equation can be solved exactly if and only if @xmath36 . however ,",
    "in general it is not the case , so a function @xmath23 that minimizes the residual norm @xmath37 is considered as the ls solution and thus satisfies the normal equation:@xcite @xmath38    this ls solution can be obtained as the linear combination of the basis vectors @xmath39 : @xcite @xmath40 where @xmath41 is the moore - penrose inverse , @xmath42 is a singular value , @xmath43 and @xmath44 are left and right singular vectors , respectively and the inner product @xmath45 is defined as @xmath46    the orthogonal bases @xmath47 and @xmath48 also form the eigenbases of @xmath49 and @xmath50 with eigenvalues @xmath51 : @xmath52 @xmath53    to obtain a numerical solution to the integral equation ( eq . [ eq : integral ] ) , the regions over which the mep and charge distribution are defined are sampled using a numerical quadrature . given @xmath14 quadrature nodes over the charge distribution and @xmath12 nodes over the mep region the integral equation is transformed into a system of @xmath12 linear equations : @xmath54 where the @xmath55 matrix @xmath56 is identical to the ls matrix @xmath7 from eq .",
    "[ eq : chi2 ] and contains the kernel elements @xmath57 , as this matrix originates from the kernel @xmath26 in the integral equation ( eq . [ eq : integral ] ) .",
    "it will be further referred to as @xmath56 in order to highlight its mathematical origin .",
    "then , the pc value at the node @xmath9 is the product of the charge density @xmath58 and the quadrature weight @xmath59 : @xmath60    since the number of the reference values @xmath12 is usually larger than the number of the unknown pc values @xmath14 , the system of linear equations is overdetermined . then",
    ", a solution that minimizes the ls sum @xmath61 ( eq . [ eq : chi2 ] ) and satisfies normal equations ( eq .",
    "[ eq : normal ] ) is considered as the numerical solution to the integral equation ( eq . [ eq : integral ] ) .",
    "this solution can be obtained using singular value decomposition ( svd ) of matrix @xmath56 : @xcite @xmath62 where @xmath41 is the moore - penrose pseudoinverse ; @xmath42 are singular values of matrix @xmath56 ; vectors @xmath63 and @xmath20 are left and right singular vectors . if the rank @xmath64 of matrix @xmath56 is less than the dimension of @xmath13 ( @xmath65 ) , then the matrix @xmath56 is rank deficient .",
    "similarly to the continuous case ( eqs .",
    "[ eq : k*k]-[eq : kk * ] ) , the orthogonal bases @xmath66 and @xmath67 form eigenbases for @xmath68 and @xmath69 : @xmath70 @xmath71 where @xmath69 is also a hessian matrix ( eq . [ eq : kappa ] ) and @xmath51 is identical to its eigenvalue @xmath19 , which is the @xmath5 curvature along the direction @xmath20:@xcite @xmath72    in many ls problems , pc fitting included , the singular values vary in a wide range , revealing the underlying ill - conditioning.@xcite as a singular value @xmath42 is a denominator in the ls solution ( eq . [ eq : svd ] ) , the smaller the singular value , the larger the effect of the corresponding singular vector @xmath20 on the ls solution .",
    "thus , even small variations along @xmath20 with small singular value lead to a significant variations of the ls solution , although these variations do not lead to significant change in the quality of the fit @xmath5.@xcite to understand the origins of the ill - conditioning in pc fitting , we next consider a system for which the inverse electrostatic problem can be analytically solved .",
    "schematic representations of the probe @xmath73 and charged @xmath74 spheres in the continuous ( a ) and discrete ( b ) forms .",
    "operators @xmath35 ( eq . [ eq : k ] ) and matrix @xmath75 are represented schematically . ]",
    "the coulomb kernel ( eq . [ eq : kernel ] ) can be conveniently expanded in terms of spherical harmonics so the source @xmath76 and the observation @xmath77 coordinates are separated but share the same origin:@xcite @xmath78 where @xmath79 denotes the unit vector defined by the polar @xmath80 and azimuthal @xmath81 angles ; @xmath82 is the smaller and @xmath83 is the larger of @xmath64 and @xmath84 ; @xmath85 are orthogonal real - value spherical harmonics:@xcite @xmath86 where @xmath87 is the differential of the solid angle .",
    "then , in the region beyond the divergence sphere where the charge density vanishes , the mep can be expanded in a multipole series:@xcite @xmath88 where a molecular multipole moment @xmath89 is given by @xmath90    the form of the kernel expansion ( eq.[eq : expansion ] ) suggests that if the radii @xmath91 and @xmath92 are fixed , the kernel @xmath93 can uniquely map a charge density over a spherical surface @xmath74 to the corresponding potential @xmath94 on a sphere @xmath73 and vice versa .",
    "thus , for a probe sphere @xmath73 with the radius @xmath95 greater than the radius of divergence sphere , the mep can be reproduced exactly by a sphere @xmath74 with surface charge density @xmath96 such that the multipole moments of the sphere @xmath97 are equivalent to the multipole moments of the molecule @xmath89 : @xmath98 where multipole moments of the sphere are : @xmath99    in this case , the original integral eq .",
    "[ eq : integral ] is transformed into a surface integral equation : @xmath100 or , equivalently , in an operator form @xmath101 where @xmath102 is a compact infinite - rank operator ( fig .",
    "[ fig : twospheres]a ) : @xmath103 where subscripts @xmath74 and @xmath73 denote the spheres , on which the corresponding spherical harmonics are defined ; the projection @xmath104 is the inner product on the @xmath105 space : @xmath106 and for each degree @xmath107 there is a singular value @xmath108 in the form of the distance - dependent factor from the mep expansion ( eq . [ eq : expansion ] ) : @xmath109    accordingly , the spherical harmonics @xmath110 and @xmath111 are left and right singular vectors and thus the eigenfunctions of the operators @xmath49 and @xmath50 , while the squares of the singular values @xmath108 are their eigenvalues ( eqs .",
    "[ eq : k*k]-[eq : kk * ] ) . since the singular values @xmath108 and",
    "spherical harmonics @xmath111 and @xmath110 form a singular system of the operator @xmath35 , the solution to integral equation ( eq . [ eq : surface ] ) can be expressed as : @xmath112    according to the multipole expansion ( eq . [ eq : mexp ] ) , the inner product @xmath113 depends on the radius @xmath95 of the probe sphere and the multipole moments of the molecule : @xmath114    the dependence on the radius @xmath95 cancels out , so the charge density depends only on the radius @xmath115 of the sphere @xmath74 and the molecular multipole moments : @xmath116 and the charged sphere @xmath74 exactly reproduces the mep @xmath94 .",
    "we can construct an approximate discrete analog of the two - sphere model ( eqs .",
    "[ eq : surface]-[eq : sigma ] , fig .",
    "[ fig : twospheres ] ) using a quadrature that exactly integrates spherical harmonics @xmath85 over a sphere up to a given @xmath107 ( eqs . [ eq : sigmay ] and [ eq : phiy ] ) , e.g. the widely used@xcite lebedev quadrature,@xcite that defines @xmath14 quadrature nodes ( table i in the supplementary material@xcite ) with predetermined angular coordinates @xmath117 , @xmath118 , and integration weights @xmath59 : @xmath119 then , given the surface charge density @xmath120 the corresponding point charge is : @xmath121    due to the orthogonality of the spherical harmonics @xmath85 ( eq . [ eq : ortho ] ) , the @xmath14-node lebedev quadrature that exactly integrates spherical harmonics over the sphere @xmath74 up to @xmath122 @xmath123 defines an orthonormal basis : @xmath124 where the @xmath125 vectors have @xmath126 elements defined as : @xmath127 similarly , the probe sphere @xmath73 can be represented by a @xmath12-node lebedev grid that integrates spherical harmonics up to @xmath128 and defines an orthogonal basis @xmath129 of dimension @xmath130 .    in this discrete representation , the operator @xmath35 ( eq . [ eq : k ] ) then becomes a @xmath131 matrix @xmath75:@xcite @xmath132 where the elements of @xmath75 , @xmath133 , and @xmath134 are : @xmath135    since usually the probe grid has more points than the source grid , i.e. @xmath136 , the matrix equation ( eq . [ eq : ktilde ] ) is a ls problem ( eq . [",
    "eq : chi2 ] ) that can be solved using svd of the matrix @xmath75 ( eq . [ eq : svd ] ) , giving a discrete analog of eq .",
    "[ eq : sigma ] : @xmath137 where @xmath138 and @xmath125 are left and right singular vectors , and the corresponding singular values @xmath108 are the same as in the continuous case ( eq . [ eq : mu ] ) .",
    "since we use the lebedev quadrature , the dot product @xmath139 corresponds to exact numerical integration and gives a result identical with the continuous case ( eq . [ eq : phiy ] ) : @xmath140 so the solution to eq .",
    "[ eq : ktilde ] depends only on the radius @xmath115 and the multipole moments @xmath89 : @xmath141    the corresponding pc values @xmath142 can be obtained using the quadrature weights @xmath143 : @xmath144 or , in a vector form : @xmath145 where @xmath146 is the vector of the quadrature weights for the sphere @xmath74 .",
    "therefore , we can use lebedev grid that shares the origin with a molecule to construct an analytical pc model that exactly reproduces molecular multipole values up to the degree @xmath147 .    from this model",
    ", we can see that the ill - conditioning of the pc fitting due to the decay of the singular values is intrinsic to the inverse electrostatic problem , as the singular values @xmath108 decrease with increasing @xmath107 ( eq . [ eq : mu ] ) . indeed , the higher the multipole moment , the smaller its contribution to the overall electrostatic potential . also , this contribution gets smaller as we move the probe further away from the source , and the singular values get smaller with the increasing radius of the probe sphere @xmath95 , or decreasing radius of the source sphere @xmath115 .",
    "the ill - conditioning problems become even more severe as we switch from modeling the mep using the lebedev quadrature , which is the best suited to reproduce the molecular multipoles , to an irregular atom - centered quadrature , as shown on a numerical example below .",
    "cross - section representations of the quadratures used for two - sphere model ( a ) ( @xmath148 , @xmath149 and @xmath150 , @xmath151 for spheres @xmath74 and @xmath73 , respectively ) as compared with the traditional atom - centered model ( b ) .",
    "green circles correspond to the point charges ; blue circles correspond to the reference grid points ]",
    "first , we consider an electrostatic pc model of a methanol molecule with pcs placed at the nodes of the lebedev quadrature over the sphere @xmath74 ( @xmath152 au ) ( fig . [",
    "fig : models]a ) . in this case , the pc values can be obtained analytically from the reference multipole moments ( eq . [ eq : analytical ] ) or by numerical fitting to the reference mep over the probe sphere @xmath73 ( @xmath153 au , @xmath150 , @xmath151 ) : @xmath154 where the pc value can be found as @xmath155 and the maximum rank @xmath64 is the number @xmath14 of quadrature nodes / pcs over the sphere @xmath74 .",
    "the quality of the fit is measured using the root mean square deviation ( rmsd ) calculated over the @xmath12 nodes of the probe grid :    @xmath156    naturally , the analytical pc values from eq .",
    "[ eq : analytical ] exactly reproduce the molecular multipole moments up to the degree @xmath147 defined by the quadrature ( table [ tab : multipoles ] ) . for each degree @xmath107",
    "there are @xmath157 values of order @xmath158 , so overall @xmath159 multipole moments are reproduced , which matches the dimension @xmath160 of the corresponding basis @xmath161 ( eq . [ eq : ybasis ] ) .",
    "as the dimension @xmath160 increases , more multipole moments are reproduced and the rmsd rapidly approaches zero ( fig . 4 in the supplementary material@xcite ) .",
    "since the dimension @xmath160 does not match the number of quadrature nodes @xmath14 ( table i in the supplementary material@xcite),@xcite we can obtain numerical solutions with eq .",
    "[ eq : numerical ] that are equivalent to the analytical results ( eq . [ eq : analytical ] ) by setting the rank @xmath64 to the dimension of the grid , @xmath162 ( table [ tab : multipoles]).@xcite     normalized singular values @xmath163 obtained using the exact analytical expression eq .",
    "[ eq : mu ] ( green circles ) as compared with the numerical values obtained from svd of the ls matrix for the two - sphere model ( red stars ) and for atom - centered model ( black circles ) .",
    "lebedev quadratures with @xmath148 , @xmath149 and @xmath150 , @xmath151 were used for the charged @xmath74 ( @xmath152 au ) and probe @xmath73 ( @xmath153 au ) spheres , respectively . ]    as the first @xmath160 multipole moments @xmath89 are reproduced by the pc model , the first @xmath160 numerical singular values @xmath42 exactly match the radius - dependent part ( eq . [ eq : mu ] ) from the inverse distance expansion ( fig .",
    "[ fig : singulars ] ) , and the corresponding right singular vectors @xmath164 match the basis @xmath161 ( fig . [ fig : bases ] ) : @xmath165    if we do not restrict the rank @xmath64 to the dimension of the grid @xmath160 , numerical svd of the ls matrix @xmath75 ( eq . [ eq : numerical ] ) produces @xmath14 singular vectors / values .",
    "while this slightly improves the rmsd ( table [ tab : multipoles ] ) , the additional @xmath166 singular vectors can not be described analytically ( fig .",
    "[ fig : bases ] ) , as they go beyond the dimension @xmath160 of the corresponding basis @xmath161",
    ". however , in the fortuitous case of the quadrature with @xmath148 and @xmath149 , the remaining @xmath167 vectors resemble the basis vectors @xmath168 and @xmath169 , so the corresponding quadrupole moments @xmath170 and @xmath171 are accurately reproduced , although the exact numerical integration of the spherical harmonics @xmath172 and @xmath173 is not provided by the 6-node lebedev grid .",
    "now , we can use the insights from the best - case scenario spherical pc model based on the lebedev quadrature ( fig .",
    "[ fig : models]a ) to understand the traditional pc fitting problem with atom - centered charges and the probe grid that follows the solvent - accessible surface ( vdw grid , fig .",
    "[ fig : models]b ) . from the point of view of the inverse electrostatic model ,",
    "the atom - centered pc fitting corresponds to a numerical solution using an irregular and suboptimal integration grid to represent the source charge distribution .",
    "this problem can be treated by svd of the ls matrix @xmath56 : @xmath174 where the maximum value of rank @xmath64 is the number of atoms in the molecule , i.e. @xmath175 in the case of methanol .",
    "we can see that even in this case the singular vector @xmath176 with the largest singular value @xmath177 corresponds the total charge ( fig .",
    "[ fig : bases ] ) , which is reproduced with only a slight slight numerical deviation ( @xmath178 ) , a consequence of the molecular charge density spillover beyond the solvent - accessible surface defining the vdw grid.@xcite    although the other singular vectors do not exactly match the corresponding spherical harmonics , the @xmath179@xmath180 vectors can be roughly related to the three components of the dipole moment ( fig .",
    "[ fig : bases ] ) , and the corresponding singular values are commensurate with the singular value @xmath108 ( @xmath181 ) obtained for the lebedev grid model ( fig . [ fig : singulars ] ) .",
    "the remaining singular values @xmath182 and @xmath183 are significantly distorted from the singular value @xmath108 ( @xmath184 ) , so the components of the quadrupole moment are not reproduced as precisely as the the dipole moment components ( table [ tab : multipoles ] ) .    among all singular vectors",
    "@xmath185 , the singular vector @xmath186 with the lowest singular value @xmath183 , which is 100 times smaller than @xmath177 , is dominated by the contribution from the methyl carbon atom ( fig .",
    "[ fig : bases ] ) . since such small singular values",
    "cause numerical instabilities of the ls solution , once can use a regularization technique such as truncated svd ( tsvd ) that reduces the rank @xmath64 by removing the lowest-@xmath42 vector(s ) from the svd expansion.@xcite removal of @xmath186 that decreases the rank to @xmath187 leads to dramatic change in the methyl group charges  the carbon atom charge in particular , which drops from @xmath188 to @xmath189 . yet , these changes lead only to marginal changes in the the multipole moment and rmsd values , a typical example of the buried atom effect ( tables [ tab : multipoles ] , [ tab : atomic_charges ] ) .",
    "this suggests a natural way to impose a restraint on the buried atom charges without introducing a restraining function into the ls sum @xmath5 , an addition that can negatively affect the electrostatic properties of the pc model.@xcite    further removal of the singular vectors @xmath190 and @xmath186 ( i.e. @xmath191 ) leads to severe deterioration of the ls solution , as the corresponding multipole moment strongly deviate from the reference values and the rmsd significantly increases ( tables [ tab : multipoles ] , [ tab : atomic_charges ] ) .",
    "thus , it appears that the tsvd approach should be applied only to the singular vectors that strongly depend on the buried atoms , an important point that will be discussed in detail elsewhere .",
    "commonly used pc fitting approaches also modify the ls sum ( eq . [ eq : chi2 ] ) by adding a lagrange multiplier @xmath192 in order to constrain the total charge to the correct value:@xcite @xmath193 which increases the dimension of the hessian matrix @xmath194 in the normal equation ( eq . [ eq : normal ] ) : @xmath195 where @xmath196 is an all - ones column - vector .    however , as we have seen , both in the case of the idealized lebedev grid and the less - than - ideal atom - centered pc models , the hessian eigenvector with the largest curvature corresponds to the total charge ( fig .",
    "[ fig : bases ] and also ref .",
    "thus , in the case of the two - sphere pc fitting , the total charge is reproduced exactly ( @xmath197 ) , while in the atom - centered pc model the total charge only slightly deviates from the exact value due the close proximity of the vdw grid and slight distortion of the total - charge vector @xmath176 from its analytical analog @xmath198 ( @xmath199 for methanol , table [ tab : multipoles ] ) .    [ cols=\"^,^,^,^,^,^,^,^,^,^,^,^,^\",options=\"header \" , ]     addition of the lagrange multiplier leads to an extra eigenvector @xmath200 that appears in the eigenbasis of the hessian matrix ( table viii in the supplementary material@xcite ) .",
    "the curvature along this vector is the smallest in the magnitude ( @xmath201 ) and the vector itself primarily depends on the lagrange multiplier @xmath192 , with only marginal contribution from the pc values . at the same time , remaining eigenvectors @xmath202 preserve the structure of the original eigenbasis , with negligible contribution from the lagrange multiplier @xmath192 ( table viii in the supplementary material@xcite ) .",
    "thus , application of the the total charge constraint in addition to already strong restraint ( imposed by the eigenvector @xmath176 ) appears to be redundant .",
    "moreover , addition of the lagrange multiplier aggravates the rank deficiency of already ill - conditioned ls problem.@xcite    alternatively , the total charge can be constrained by incorporating condition on the proper total charge directly into the ls sum,@xcite by eliminating one of the charges and setting it to : @xmath203 where @xmath147 is the index of the eliminated charge .",
    "this reduces the dimension of the ls problem by one : @xmath204 ^ 2\\ ] ] and modifies the elements of the hessian matrix : @xmath205    although the solution obtained with this approach is numerically equivalent to the solution with lagrange multiplier , regardless which atom has been eliminated ( elimination , @xmath206 in tables [ tab : multipoles ] and [ tab : atomic_charges ] ) , the structure of the right singular vectors becomes disrupted , ( fig . 8 in the supplementary material@xcite ) which prevents the application of the truncated svd to improve the numerical stability of the solution .    given that even for the atom - centered pc / vdw probe model the total charge value deviates only very slightly from the reference value , it should be possible to correct for this deviation without exacerbating the numerical instabilities of the ls problem , e.g. using the total charge vector @xmath176 . to do that , we convert the svd solution ( eq . [ eq : numerical2 ] ) to a system of linear equations : @xmath207 @xmath208 then",
    ", we replace @xmath176 in @xmath209 by an all - ones vector @xmath196 , and set the corresponding coefficient @xmath210 in @xmath211 to the exact value of the molecular total charge @xmath212 : @xmath213 where @xmath214 @xmath215    this approach does not introduce any redundant constraints , preserves the electrostatic properties of the unconstrained solution , and results only in to minor changes in the pc values ( svd , @xmath206 in tables [ tab : multipoles ] and [ tab : atomic_charges ] ) and is compatible with truncated svd .",
    "also , the error in the total charge value is small enough and can be corrected by simply distributing the @xmath216 error correction across the atomic charges ; this trivial total charge correction gives result nearly identical to eq .",
    "[ eq : svdq0corr1 ] ( trivial , @xmath206 in tables [ tab : multipoles ] and [ tab : atomic_charges ] ) .",
    "to understand the origins of the ill - conditioning of the least - squares ( ls ) point charge ( pc ) fitting problem , we revisited the pc representation of the molecular electrostatic potential ( mep ) from the first principles , as an example of the inverse problem .",
    "based on the properties of the coulomb potential that can be expanded in terms of spherical harmonics , we introduce a model where the mep of a molecule is exactly reproduced by a charged sphere that has the same multipole moments @xmath217 as the molecule . using lebedev quadrature this continuous model is converted into a discrete pc model , where the pc values are evaluated analytically from the multipole moments @xmath217 up to the maximum value determined by the quadrature .    in this context , the traditional atom - centered pc model can be viewed as an irregular numerical quadrature , poorly suited to reproduce the multipolar expansion of the mep . as such",
    ", this quadrature only allows integration of the monopole and , approximately , dipole terms .",
    "the corresponding large - curvature  or ` stiff'@xcite  hessian eigenvectors @xmath20 can still be related to the corresponding multipoles @xmath217 . this explains previously observed correspondence between the highest - curvature hessian eigenvectors and the total charge and the dipole moment components;@xcite this correspondence quickly breaks down for the higher multipole moments .",
    "this consideration then reveals the origins of the ill - conditioning of the pc fitting due to the presence of low - curvature  or ` sloppy'@xcite ",
    "vectors @xmath20 .",
    "the intrinsic ill - conditioning arises even in the case of the ideal spherical model : since the higher - rank multipole moments @xmath217 have smaller contribution to the mep , the singular values @xmath108 decay as @xmath107 increases .",
    "the ill - conditioning is further exacerbated in the numerical treatment of the lebedev grid model because the number of pcs does not match the dimension of the basis formed by lebedev quadrature .",
    "the remaining singular values / curvatures are even lower in magnitude and do not correspond to particular multipole moments @xmath217 .",
    "the same rank - deficiency problems apply to the atom - centered pc grids .",
    "however , in that case most of the eigenvectors do not have a direct correspondence to the multipole moments , which leads to even wider spread - out of the singular values / curvatures .",
    "these insights can suggest several ways to alleviate the ill - conditioning of the problem .",
    "for instance , the buried atom problem can be addressed by truncating the sloppy singular vectors with dominant contribution from these atom , instead of introducing additional restraining functions@xcite that can negatively affect the overall electrostatic properties of the molecule.@xcite also , slight deviations of the total charge of the fitted pc solution can be fixed by adjusting the stiff total - charge vector @xmath176 and the corresponding coordinate @xmath212 , rather than introducing a lagrange multiplier that increases the rank - deficiency of the hessian matrix.@xcite    the results presented here can help further application of the pc model in biomolecular simulations . although the force fields using point charges may not be as accurate as the force fields that explicitly include multipoles and/or polarization effects , the simplicity and computational efficiency of the pc model has ensured its continued survival.@xcite in fact , representation of multipoles using the lebedev grid pc model can provide an alternative to the multipole moment expansion;@xcite it also can be used to extend recently proposed distributed charge model.@xcite",
    "mep and multipole moments were calculated at the b3lyp / aug - cc - pvdz level@xcite as implemented in q - chem package.@xcite for atom - centered pc fitting the reference mep was generated as the cubic grid with linear density 2.8 points /  , followed by the removal of the points outside of 1.0 - 2.0 van der waals radii range around each atom ( vdw grid ) . for the two - sphere pc model the lebedev quadrature rules were used as implemented in pyquante package .",
    "@xcite charge fitting procedures were implemented in the in - house developed _ fftoolbox _",
    "python library.@xcite svd was performed using _ numpy _",
    "library.@xcite spherical harmonics were accessed from _ scipy _",
    "library.@xcite    q.k.t . is a recipient of the national science foundation ( nsf ) career award che-1255641 , and marquette university way - klinger young scholar award .",
    "m.v.i . is a recipient of bournique memorial fellowship ( marquette university ) .",
    "this work used the high - performance computing cluster pere at marquette university funded by nsf awards oci-0923037 and cbet-0521602 , and the extreme science and engineering discovery environment ( xsede ) supported by nsf grant aci-1053575 .",
    "67ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]",
    " + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty link:\\doibase 10.1002/jcc.540020312 [ * * , ( ) ] link:\\doibase 10.1002/jcc.540050204 [ * * , ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1080/00268970500187910 [ * * , ( ) ] @noop * * , ( ) @noop * * ,   ( ) link:\\doibase 10.1021/ct401049q [ * * ,   ( ) ] link:\\doibase 10.1021/ct4010307 [ * * ,   ( ) ] link:\\doibase 10.1021/ct501138c [ * * ,   ( ) ] link:\\doibase 10.1021/acs.jpcb.5b00689 [ * * ,   ( ) ] link:\\doibase 10.1021/acs.jpcb.5b00602 [ * * ,   ( ) ] link:\\doibase    10.1021/acs.jctc.5b00255 [ * * ,   ( ) ] link:\\doibase 10.1021/acs.jctc.5b00503 [ * * , ( ) ] link:\\doibase 10.1039/c3cp54829e [ * * ,   ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1021/jp311851r [ * * ,   ( ) ] link:\\doibase    10.1016/j.cplett.2014.01.001 [ * * ,   ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1021/ct500803r [ * * ,   ( ) ] link:\\doibase 10.1021/ct700046j [ * * ,   ( ) ] @noop * * ( ) link:\\doibase 10.1002/jcc.540130512 [ * * , ( ) ] link:\\doibase 10.1002/jcc.540140711 [ * * , ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) @noop _ _ ,  series in automatic computation  ( ,  , )  p.   @noop _ _  ( , ,  ) @noop * * ,   ( ) link:\\doibase    10.1063/1.4923066 [ * * ,   ( ) ] link:\\doibase 10.1002/jcc.540110404 [ * * ,   ( ) ] @noop * * ,   ( ) link:\\doibase    10.1002/jcc.23208 [ * * ,   ( ) ] link:\\doibase 10.1021/jp409568h [ * * ,   ( ) ] link:\\doibase 10.1021/acs.jpca.5b00218 [ * * ,   ( ) ] @noop _ _ ( ,  ,  ) link:\\doibase 10.1021/jp0143138 [ * * ,   ( ) ] link:\\doibase 10.1088/1742 - 6596/73/1/012001 [ * * ,   ( ) ] @noop _ _ ,  ed .",
    "( ,  ,  ) link:\\doibase 10.1103/physreve.68.021904 [ * * ,   ( ) ] @noop _ _",
    "( ,  ,  ) @noop _ _ ,  ed .",
    "( ,  ) @noop link:\\doibase 10.1063/1.3689445 [ * * ,   ( ) ] link:\\doibase 10.1021/ct200930x [ * * ,   ( ) ] link:\\doibase 10.1063/1.4802773 [ * * ,   ( ) ] @noop * * ,   ( ) @noop link:\\doibase 10.1098/rspa.2009.0104 [ * * , ( ) ] @noop * * ,   ( ) link:\\doibase 10.1006/jath.1995.1119 [ * * , ( ) ] @noop @noop * * ,   ( ) link:\\doibase 10.1063/1.4907404 [ * * , ( ) ] link:\\doibase 10.1103/physrevb.37.785 [ * * ,   ( ) ] link:\\doibase 10.1063/1.464913 [ * * ,   ( ) ] link:\\doibase 10.1021/j100096a001 [ * * , ( ) ] \\doibase http://dx.doi.org/10.1063/1.456153 [ * * ,   ( ) ] @noop * * ,   ( ) @noop `` , ''   ( ) @noop `` , ''   ( ) @noop `` , ''   ( ) link:\\doibase 10.1109/mcse.2011.37 [ * * , ( ) ] @noop `` , ''   ( )"
  ],
  "abstract_text": [
    "<S> atom - centered point charge model of the molecular electrostatics  a major workhorse of the atomistic biomolecular simulations  is usually parameterized by least - squares ( ls ) fitting of the point charge values to a reference electrostatic potential , a procedure that suffers from numerical instabilities due to the ill - conditioned nature of the ls problem . to reveal the origins of this ill - conditioning , we start with a general treatment of the point charge fitting problem as an inverse problem , and construct an analytical model with the point charges spherically arranged according to lebedev quadrature which is naturally suited for the inverse electrostatic problem . </S>",
    "<S> this analytical model is contrasted to the atom - centered point - charge model that can be viewed as an irregular quadrature poorly suited for the problem . </S>",
    "<S> this analysis shows that the numerical problems of the point charge fitting are due to the decay of the curvatures corresponding to the eigenvectors of ls sum hessian matrix . in part , this ill - conditioning is intrinsic to the problem and related to decreasing electrostatic contribution of the higher multipole moments , that are , in the case of lebedev grid model , directly associated with the hessian eigenvectors . </S>",
    "<S> for the atom - centered model , this association breaks down beyond the first few eigenvectors related to the high - curvature monopole and dipole terms ; this leads to even wider spread - out of the hessian curvature values . using these insights , it is possible to alleviate the ill - conditioning of the ls point - charge fitting without introducing external restraints and/or constraints . </S>",
    "<S> also , as the analytical lebedev grid pc model proposed here can reproduce multipole moments up to a given rank , it may provide a promising alternative to including explicit multipole terms in a force field . </S>"
  ]
}