{
  "article_text": [
    "in regression scenarios where the data have a time series structure , there is often parameter instability with respect to time @xcite .",
    "a popular strategy to account for such dynamic patterns is to employ regime switching where parameters vary in time , taking on finitely many values , controlled by an unobservable markov chain .",
    "such models are referred to as markov - switching or regime - switching regression models , following the seminal papers by @xcite and @xcite .",
    "a basic markov - switching regression model involves a time series @xmath0 and an associated sequence of covariates @xmath1 ( including the possibility of @xmath2 ) , with the relation between @xmath3 and @xmath4 specified as    @xmath5    where typically @xmath6 and @xmath7 is the state at time @xmath8 of an unobservable @xmath9-state markov chain . in other words , the functional form of the relation between @xmath3 and @xmath4 and",
    "the residual variance change over time according to state switches of an underlying markov chain , i.e.  each state corresponds to a regime with different stochastic dynamics .",
    "the markov chain induces serial dependence , typically such that the states are persistent in the sense that regimes are active for longer periods of time , on average , than they would be if an independent mixture model was used to select among regimes .",
    "the classic example is an economic time series where the effect of an explanatory variable may differ between times of high and low economic growth @xcite .",
    "the simple model given in ( [ simplemodel ] ) can be ( and has been ) modified in various ways , for example allowing for multiple covariates or for general error distributions from the generalized linear model ( glm ) framework .",
    "an example for the latter is the markov - switching poisson regression model discussed in @xcite .",
    "however , in the existing literature the relationship between the target variable and the covariates is commonly specified in parametric form and usually assumed to be linear , with little investigation , if any , into the absolute or relative goodness of fit .",
    "the aim of the present work is to provide effective and accessible methods for a nonparametric estimation of the functional form of the predictor .",
    "these build on a ) the strengths of the hidden markov model ( hmm ) machinery @xcite , in particular the forward algorithm , which allows for a simple and fast evaluation of the likelihood of a markov - switching regression model ( parametric or nonparametric ) , and b ) the general advantages of penalized b - splines , i.e.  p - splines @xcite , which we employ to obtain almost arbitrarily flexible functional estimators of the relationship between target variable and covariate(s ) .",
    "model fitting is done via a numerical maximum penalized likelihood estimation , using either generalized cross - validation or an information criterion approach to select smoothing parameters that control the balance between goodness - of - fit and smoothness .",
    "since parametric polynomial models are included as limiting cases for very large smoothing parameters , such a procedure also comprises the possibility to effectively reduce the functional effects to their parametric limiting cases , so that the conventional parametric markov - switching regression models effectively are nested special cases of our more flexible models .",
    "our approach is by no means limited to models of the form given in ( [ simplemodel ] ) .",
    "in fact , the flexibility of the hmm machinery allows for the consideration of models from a much bigger class , which we term _ markov - switching generalized additive models _",
    "( ms - gams ) .",
    "these are simply generalized additive models ( gams ) with an additional time component , where the predictor  including additive smooth functions of covariates , parametric terms and error terms  is subject to regime changes controlled by an underlying markov chain , analogously to ( [ simplemodel ] ) .",
    "while the methods do not necessitate a restriction to additive structures , we believe these to be most relevant in practice and hence have decided to focus on these models in the present work .",
    "our work is closely related to that of @xcite .",
    "those authors , however , confine their consideration to the case of only one covariate and the identity link function .",
    "furthermore , we note that our approach is similar in spirit to that proposed in @xcite , where the aim is to nonparametrically estimate the densities of the state - dependent distributions of an hmm .",
    "the paper is structured as follows . in section [ msgams ]",
    ", we formulate general markov - switching regression models , describe how to efficiently evaluate their likelihood , and develop the spline - based nonparametric estimation of the functional form of the predictor .",
    "the performance of the suggested approach is then investigated in three simulation experiments in section [ simul ] . in section [ appl ] , we apply the approach to spanish energy price data to demonstrate its feasibility and potential .",
    "we conclude in section [ discuss ] .",
    "we begin by formulating a markov - switching regression model with arbitrary form of the predictor , encompassing both parametric and nonparametric specifications .",
    "let @xmath0 denote the target variable of interest ( a time series ) , and let @xmath10 denote the associated values of the @xmath11-th covariate considered , where @xmath12 .",
    "we summarize the covariate values at time @xmath8 in the vector @xmath13 .",
    "further let @xmath14 denote the states of an underlying unobservable @xmath9-state markov chain @xmath15 .",
    "finally , we assume that conditional on @xmath16 , @xmath4 follows some distribution from the exponential family and is independent of all other states , covariates and observations .",
    "we write    @xmath17    where @xmath18 is some link function , typically the canonical link function associated with the exponential family distribution considered .",
    "that is , the expectation of @xmath4 is linked to the covariate vector @xmath19 via the predictor function @xmath20 , which maps the covariate vector to @xmath21 , when the underlying markov chain is in state @xmath22 , i.e.  @xmath23 .",
    "essentially there is one regression model for each state @xmath22 , @xmath24 . in the following ,",
    "we use the shorthand @xmath25 .    to fully specify the conditional distribution of @xmath4 ,",
    "additional parameters may be required , depending on the error distribution considered .",
    "for example , if @xmath4 is conditionally poisson distributed , then ( [ expform ] ) fully specifies the state - dependent distribution ( e.g.  with @xmath26 ) , whereas if @xmath4 is normally distributed ( in which case @xmath18 usually is the identity link ) , then the variance of the error needs to be specified , and would typically be assumed to also depend on the current state of the markov chain .",
    "we use the notation @xmath27 to denote such additional time - dependent parameters ( typically dispersion parameters ) , and denote the conditional density of @xmath4 , given @xmath16 , as @xmath28 .",
    "the simplest and probably most popular such model assumes a conditional normal distribution for @xmath4 , a linear form of the predictor and a state - dependent error variance , leading to the model    @xmath29    where @xmath30 ( cf .",
    "@xcite ; @xcite ) .    assuming homogeneity of the markov chain  which can easily be relaxed if desired  we summarize the probabilities of transitions between the different states in the @xmath31 transition probability matrix ( t.p.m . ) @xmath32 , where @xmath33 , @xmath34 .",
    "the initial state probabilities are summarized in the row vector @xmath35 , where @xmath36 , @xmath24 .",
    "it is usually convenient to assume @xmath35 to be the stationary distribution , which , if it exists , is the solution to @xmath37 subject to @xmath38 .",
    "a markov - switching regression model , with conditional density @xmath39 and underlying markov chain characterized by @xmath40 , can be regarded as an hmm with additional dependence structure ( here in the form of covariate influence ) ; see @xcite .",
    "this opens up the way for exploiting the efficient and flexible hmm machinery .",
    "most importantly , irrespective of the type of exponential family distribution considered , an extremely efficient recursion can be applied in order to evaluate the likelihood of a markov - switching regression model , namely the so - called forward algorithm . to see this ,",
    "consider the vectors of forward variables , defined as the row vectors    @xmath41    here @xmath11 is used as a generic symbol for a ( joint ) density .",
    "then the following recursive scheme can be applied :    @xmath42    where @xmath43 the recursion ( [ forw ] ) follows immediately from @xmath44 which in turn can be derived in a straightforward manner using the model s dependence structure ( for example analogously to the proof of proposition 2 in @xcite ) .",
    "the likelihood can thus be written as a matrix product :    @xmath45    where @xmath46 is a column vector of ones , and where @xmath47 is a vector comprising all model parameters .",
    "the computational cost of evaluating ( [ lik ] ) is linear in the number of observations , @xmath48 , such that a numerical maximization of the likelihood is feasible in most cases , even for very large @xmath48 and moderate numbers of states @xmath9 .",
    "notably , the likelihood form given in ( [ lik ] ) applies for any form of the conditional density @xmath39 . in particular , it can be used to estimate simple markov - switching regression models , e.g.  with linear predictors , or in fact with any glm - type structure within states .",
    "here we are concerned with a nonparametric estimation of the functional relationship between @xmath4 and @xmath19 . to achieve this",
    ", we consider a gam - type framework @xcite , with the predictor comprising additive smooth state - dependent functions of the covariates :    @xmath49    we simply have one gam associated with each state of the markov chain . to achieve a flexible estimation of the functional form",
    ", we express each of the functions @xmath50 , @xmath24 , @xmath12 , as a finite linear combination of a high number of basis functions , @xmath51 :    @xmath52    note that different sets of basis functions can be applied to represent the different functions , but to keep the notation simple we here consider a common set of basis functions for all @xmath50 .",
    "a common choice for the basis is to use b - splines , which form a numerically stable , convenient basis for the space of polynomial splines , i.e.  piecewise polynomials that are fused together smoothly at the interval boundaries ; see @xcite and @xcite for more details .",
    "we use cubic b - splines , in ascending order in the basis used in ( [ lincom ] ) .",
    "the number of b - splines considered , @xmath53 , determines the flexibility of the functional form , as an increasing number of basis functions allows for an increasing curvature of the function being modeled . instead of trying to select an optimal number of basis elements",
    ", we follow @xcite and modify the likelihood by including a difference penalty on coefficients of adjacent b - splines .",
    "the number of basis b - splines , @xmath53 , then simply needs to be sufficiently large in order to yield high flexibility for the functional estimates .",
    "once this threshold is reached , a further increase in the number of basis elements no longer changes the fit to the data due to the impact of the penalty . considering second - order differences",
    " which leads to an approximation of the integrated squared curvature of the function estimate @xcite  leads to the difference penalty @xmath54 , where @xmath55 are smoothing parameters and where @xmath56 .",
    "we then modify the ( log-)likelihood of the ms - gam  specified by @xmath39 in combination with ( [ lincom ] ) and underlying markov chain characterized by @xmath40  by including the above difference penalty , one for each of the smooth functions appearing in the state - dependent predictors :    @xmath57    the maximum penalized likelihood estimate then reflects a compromise between goodness - of - fit and smoothness , where an increase in the smoothing parameters leads to an increased emphasis being put on smoothness .",
    "we discuss the choice of the smoothing parameters in more detail in the subsequent section . as @xmath58 ,",
    "the corresponding penalty dominates the log - likelihood , leading to a sequence of estimated coefficients @xmath59 that are on a straight line .",
    "thus , we obtain the common linear predictors , as given in ( [ linpred ] ) , as a limiting case .",
    "similarly , we can obtain parametric functions with arbitrary polynomial order @xmath60 as limiting cases by considering @xmath61-th order differences in the penalty .",
    "the common parametric regression models thus are essentially nested within the class of nonparametric models that we consider .",
    "one can of course obtain these nested special cases more directly , by simply specifying parametric rather than nonparametric forms for the predictor . on the other hand",
    ", it can clearly be advantageous not to constrain the functional form in any way _ a priori _ , though still allowing for the possibility of obtaining constrained parametric cases as a result of a data - driven choice of the smoothing parameters .",
    "standard gams and even glms are also nested in the considered class of models ( @xmath62 ) , but this observation is clearly less relevant , since powerful software is already available for these special cases .      for given smoothing parameters , all model parameters  including the parameters determining the markov chain , any dispersion parameters , the coefficients @xmath63 used in the linear combinations of b - splines and any other parameters required to specify the predictor  can be estimated simultaneously by numerically maximizing the penalized log - likelihood given in ( [ penlik ] ) .",
    "for each function @xmath50 , @xmath24 , @xmath12 , one of the coefficients needs to be fixed to render the model identifiable , such that the intercept controls the height of the predictor function . a convenient strategy to achieve this is to first standardize each sequence of covariates @xmath10",
    ", @xmath12 , shifting all values by the sequence s mean and dividing the shifted values by the sequence s standard deviation , and second consider an odd number of b - spline basis functions @xmath53 with @xmath64 fixed .",
    "the numerical maximization is carried out subject to well - known technical issues arising in all optimization problems , including parameter constraints and local maxima of the likelihood .",
    "the latter can be either easy to deal with or a challenging problem , depending on the complexity of the model considered .",
    "uncertainty quantification , on both the estimates of parametric parts of the model and on the function estimates , can be performed based on the approximate covariance matrix available as the inverse of the observed fisher information or using a parametric bootstrap @xcite .",
    "the latter avoids relying on asymptotics , which is particularly problematic when the number of b - spline basis functions increases with the sample size . from the bootstrap samples , we can obtain pointwise as well as simultaneous confidence intervals for the estimated regression functions .",
    "pointwise confidence intervals are simply given via appropriate quantiles obtained from the bootstrap replications .",
    "simultaneous confidence bands are obtained by scaling the pointwise confidence intervals until they contain a pre - specified fraction of all bootstrapped curves completely @xcite .",
    "for the closely related class of parametric hmms , identifiability holds under fairly weak conditions , which in practice will usually be satisfied , namely that the t.p.m .",
    "of the unobserved markov chain has full rank and that the state - specific distributions are distinct @xcite .",
    "this result transfers to the more general class of ms - gams if , additionally , the state - specific gams are identifiable",
    ". conditions for the latter are simply the same as in any standard gam and in particular the nonparametric functions have to be centered around zero .",
    "furthermore , in order to guarantee estimability of a smooth function on a given domain , it is necessary that the covariate values cover that domain sufficiently well . in practice ,",
    "i.e.  when dealing with finite sample sizes , parameter estimation will be difficult if the level of correlation , as induced by the unobserved markov chain , is low , and also if the state - specific gams are similar .",
    "the stronger the correlation in the state process , the clearer becomes the pattern and hence the easier it is for the model to allocate observations to states .",
    "similarly , the estimation performance will be best , in terms of numerical stability , if the state - specific gams are clearly distinct .",
    "( see also the simulation experiments in section [ simul ] below . )      in section  [ estim ] , we described how to fit an ms - gam to data for a _ given _ smoothing parameter vector . to choose adequate smoothing parameters in a data - driven way , generalized cross - validation can be applied .",
    "a leave - one - out cross - validation will typically be computationally infeasible . instead ,",
    "for a given time series to be analyzed , we generate @xmath65 random partitions such that in each partition a high percentage of the observations , e.g.  90% , form the calibration sample , while the remaining observations constitute the validation sample . for each of the @xmath65 partitions and any @xmath66 , the model",
    "is then calibrated by estimating the parameters using only the calibration sample ( treating the data points from the validation sample as missing data , which is straightforward using the hmm forward algorithm ; see @xcite ) .",
    "subsequently , proper scoring rules @xcite can be used on the validation sample to assess the model for the given @xmath67 and the corresponding calibrated model . for computational convenience ,",
    "we consider the log - likelihood of the validation sample , under the model fitted in the calibration stage , as the score of interest ( now treating the data points from the calibration sample as missing data ) . from some pre - specified grid @xmath68",
    ", we then select the @xmath67 that yields the highest mean score over the @xmath65 cross - validation samples .",
    "the number of samples @xmath65 needs to be high enough to give meaningful scores ( i.e.  such that the scores give a clear pattern rather than noise only ; from our experience , @xmath65 should not be smaller than 10 ) , but must not be too high to allow for the approach to be computationally feasible .    an alternative , less computer - intensive approach for selecting the smoothing parameters is based on the akaike information criterion ( aic ) , calculating , for each smoothing parameter vector from the grid considered , the following aic - type statistic : @xmath69 here @xmath70 is the unpenalized likelihood under the given model ( fitted via penalized maximum likelihood ) , and @xmath71 denotes the effective degrees of freedom , defined as the trace of the product of the fisher information matrix for the unpenalized likelihood and the inverse fisher information matrix for the penalized likelihood @xcite . using the effective degrees of freedom accounts for the effective dimensionality reduction of the parameter space resulting from the penalization . from all smoothing parameter vectors considered",
    ", the one with the smallest @xmath72 value is chosen .",
    "_ scenario i. _ we first consider a relatively simple scenario , with a poisson - distributed target variable , a 2-state markov chain selecting the regimes and only one covariate : @xmath73 where @xmath74 the functional forms chosen for @xmath75 and @xmath76 are displayed by the dashed curves in figure [ fig1 ] ; both functions go through the origin .",
    "we further set @xmath77 and @xmath78 all covariate values were drawn independently from a uniform distribution on @xmath79 $ ] .",
    "we ran 200 simulations , in each run generating @xmath80 observations from the model described .",
    "an ms - gam , with poisson - distributed response and log - link , was then fitted via numerical maximum penalized likelihood estimation , as described in section [ estim ] above , using the optimizer ` nlm ` in r. we set @xmath81 , hence using 15 b - spline basis densities in the representation of each functional estimate .",
    "we implemented both generalized cross - validation and the aic - based approach for choosing the smoothing parameter vector from a grid @xmath82 , where @xmath83 .",
    "we considered @xmath84 folds in the cross - validation .",
    "for both approaches , we estimated the mean integrated squared error ( mise ) for the two functional estimators , as follows : @xmath85 for @xmath86 , where @xmath87 is the functional estimate of @xmath88 obtained in simulation run @xmath89 . using cross - validation , we obtained @xmath90 and @xmath91 , while using the aic - type criterion we obtained the slightly better values @xmath92 and @xmath93 . in the following , we report the results obtained using the aic - based approach .",
    "and @xmath76 used in _",
    "scenario i _",
    "( dashed lines ) and their estimates obtained in 200 simulation runs ( green and red lines for states 1 and 2 , respectively).,scaledwidth=76.0% ]    the sample mean estimates of the transition probabilities @xmath94 and @xmath95 were obtained as @xmath96 ( monte carlo standard deviation of estimates : @xmath97 ) and @xmath98 ( @xmath99 ) , respectively .",
    "the estimated functions @xmath100 and @xmath101 from all 200 simulation runs are visualized in figure [ fig1 ] .",
    "the functions have been shifted so that they go through the origin .",
    "all fits are fairly reasonable .",
    "the sample mean estimates of the predictor value for @xmath102 were obtained as @xmath103 ( @xmath104 ) and @xmath105 ( @xmath106 ) for states 1 and 2 , respectively .",
    "+ _ scenario ii .",
    "_ the second simulation experiment we conducted is slightly more involved , with a normally distributed target variable , an underlying 2-state markov chain and now two covariates : @xmath107 where @xmath108 the functional forms we chose for @xmath109 , @xmath110 , @xmath111 and @xmath112 are displayed in figure [ fig2 ] ; again all functions go through the origin .",
    "we further set @xmath113 , @xmath114 , @xmath115 , @xmath116 and @xmath117 the covariate values were drawn independently from a uniform distribution on @xmath79 $ ] . in each of 200 simulation runs , @xmath118 observations were generated .",
    "for the choice of the smoothing parameter vector , we considered the grid @xmath119 , where @xmath120 .",
    "the aic - based smoothing parameter selection led to mise estimates that overall were marginally lower than their counterparts obtained when using cross - validation ( @xmath121 compared to @xmath122 , averaged over all four functions being estimated ) , so again in the following we report the results obtained based on the aic - type criterion .",
    "the ( true ) function @xmath110 is in fact a straight line , and , notably , the associated smoothing parameter was chosen as @xmath123 , hence as the maximum possible value from the grid considered , in 129 out of the 200 cases , whereas for example for the function @xmath112 , which has a moderate curvature , the value @xmath123 was not chosen even once as the smoothing parameter .",
    ", @xmath110 , @xmath111 and @xmath112 used in _ scenario ii _ ( dashed lines ) and their estimates obtained in 200 simulation runs ( red and green lines for states 1 and 2 , respectively ; @xmath109 and @xmath110 , which describe the state - dependent effect of the covariate @xmath124 on the predictor , and corresponding estimates are displayed in the left panel ; @xmath111 and @xmath112 , which describe the state - dependent effect of the covariate @xmath125 on the predictor , and corresponding estimates are displayed in the right panel).,scaledwidth=100.0% ]    in this experiment , the sample mean estimates of the transition probabilities @xmath94 and @xmath95 were obtained as @xmath126 ( monte carlo standard deviation of estimates : @xmath127 ) and @xmath128 ( @xmath129 ) , respectively .",
    "the estimated functions @xmath130 , @xmath131 , @xmath132 and @xmath133 from all 200 simulation runs are displayed in figure [ fig2 ] .",
    "again all have been shifted so that they go through the origin .",
    "the sample mean estimates of the predictor value for @xmath134 were @xmath135 ( @xmath136 ) and @xmath137 ( @xmath138 ) for states 1 and 2 , respectively .",
    "the sample mean estimates of the state - dependent error variances , @xmath139 and @xmath140 , were obtained as @xmath141 ( @xmath142 ) and @xmath143 ( @xmath144 ) , respectively .",
    "again the results are very encouraging , with not a single simulation run leading to a complete failure in terms of capturing the overall pattern .",
    "+ _ scenario iii .",
    "_ the estimator behavior both in _ scenario i _ and in _ scenario ii _ is encouraging , and demonstrates that inference in ms - gams is clearly practicable in these two settings , both of which may occur in similar form in real data",
    ". however , as discussed in section [ estim ] , in some circumstances , parameter identification in finite samples can be difficult , especially if the level of correlation as induced by the markov chain is low . to illustrate this , we re - ran _",
    "scenario i _ , using the exact same configuration as described above except that we changed @xmath145 to @xmath146 in other words , compared to _",
    "scenario i _ , there is substantially less autocorrelation in the series that are generated .",
    "figure [ fig3 ] displays the estimated functions @xmath100 and @xmath101 in this slightly modified scenario . due to the fairly low level of autocorrelation ,",
    "the estimator performance is substantially worse than in _",
    "scenario i _ , and in several simulation runs the model failed to capture the overall pattern , by allocating pairs @xmath147 with high values of the covariate @xmath3 to the wrong state of the markov chain .",
    "the deterioration in the estimator performance is also reflected by higher standard errors : the sample mean estimates of the transition probabilities @xmath94 and @xmath95 were obtained as @xmath148 ( monte carlo standard deviation of estimates : @xmath149 ) and @xmath150 ( @xmath151 ) , respectively , and the sample mean estimates of the predictor value for @xmath102 were obtained as @xmath152 ( @xmath153 ) and @xmath154 ( @xmath155 ) for states 1 and 2 , respectively .",
    "and @xmath76 used in _ scenario iii _ ( dashed lines ) and their estimates obtained in 200 simulation runs ( green and red lines for states 1 and 2 , respectively).,scaledwidth=76.0% ]",
    "we analyze the data collected on the daily price of energy in spain between 2002 and 2008 .",
    "the data , 1784 observations in total , are available in the r package ` mswm ` @xcite .",
    "we consider the relationship over time between the price of energy @xmath156 and the euro / dollar exchange rate @xmath157 .",
    "the stochastic volatility of financial time series makes the assumption of a fixed relationship between these two variables over time questionable , and it seems natural to consider a markov - switching regime model .",
    "it is also probable that their relationship within a regime is non - linear with unknown functional form , thereby motivating the use of flexible nonparametric predictor functions . here",
    ", our aim is to illustrate the potential benefits of considering flexible ms - gams rather than gams or parametric markov - switching models when analyzing time series regression data .    to this end , we consider four different models . as benchmark models , we considered two parametric models with state - dependent linear predictor @xmath158 , with one ( lin ) and two states ( ms - lin ) , respectively , assuming the response variable @xmath156 to be normally distributed . additionally , we considered two nonparametric models as introduced in section [ nonp ] , with one state ( hence a basic gam ) and two states ( ms - gam ) , respectively .",
    "in these two models , we assumed @xmath156 to be gamma - distributed , applying the log link function to meet the range restriction for the ( positive ) mean .",
    "figure [ fig : real_models ] shows the fitted curves for each model . for each one - state model",
    "( gam and lin ) , the mean curve passes through a region with no data ( for values of @xmath157 around @xmath159 ) .",
    "this results in response residuals with clear systematic deviation .",
    "it is failings such as this which demonstrate the need for regime - switching models .",
    "models were formally compared using one - step - ahead forecast evaluation , by means of the sum of the log - likelihoods of observations @xmath160 under the models fitted to all preceding observations , @xmath161 , considering @xmath162 ( such that models are fitted to a reasonable number of observations ) .",
    "we obtained the following log - likelihood scores for each model : @xmath163 for lin , @xmath164 for gam , @xmath165 for ms - lin and @xmath166 for ms - gam .",
    "thus , in terms of out - of - sample forecasts , the ms - gam performed much better than any other model considered .",
    "both two - state models performed much better than the single - state models , however the inflexibility of the ms - lin model resulted in a poorer performance than that of its nonparametric counterpart , as clear non - linear features in the regression data are ignored .",
    "for the ms - gam , the transition probabilities were estimated to be @xmath167 ( standard error : @xmath168 ) and @xmath169 ( @xmath170 ) . the estimated high persistence within states",
    "gives evidence that identifiability problems such as those encountered in _ scenario iii _ in the simulation experiments did not occur here .",
    "figure [ fig : real_tsseries ] gives the estimated regime sequence from the ms - gam and ms - lin models obtained using the viterbi algorithm .",
    "both sequences are similar , with one state relating to occasions where price is more variable and generally higher .",
    "however , the ms - lin model does tend to predict more changes of regime than the ms - gam , which may be a result of its inflexibility .",
    "we have exploited the strengths of the hmm machinery and of penalized b - splines to develop a flexible new class of models , ms - gams , which show promise as a useful tool in time series regression analysis .",
    "a key strength of the inferential approach is ease of implementation , in particular the ease with which the code , once written for any ms - gam , can be modified to allow for various model formulations .",
    "this makes interactive searches for an optimal model among a suite of candidate formulations practically feasible .",
    "model selection , although not explored in detail in the current work , can be performed along the lines of @xcite using cross - validated likelihood , or can be based on aic - type criteria such as the one we considered for smoothing parameter selection . for",
    "more complex model formulations , local maxima of the likelihood can become a challenging problem . in this",
    "regard , estimation via the em algorithm , as suggested in @xcite for a smaller class of models , could potentially be more robust ( cf .",
    "@xcite ) , but is technically more challenging , not as straightforward to generalize and hence less user - friendly @xcite .",
    "in the example application to energy price data , the ms - gam clearly outperformed the other models considered , as it accommodates both the need for regime change over time and the need to capture non - linear relationships within a regime .",
    "however , even the very flexible ms - gam has some shortcomings . in particular",
    ", it is apparent from the plots , but also from the estimates of the transition probabilities , which indicated a very high persistence of regimes , that the regime - switching model addresses long - term dynamics , but fails to capture the short - term ( day - to - day ) variations within each regime . in this regard",
    ", it would be interesting to explore models that incorporate regime switching ( for capturing long - term dynamics induced by persistent market states ) but for example also autoregressive error terms within states ( for capturing short - term fluctuations ) .",
    "furthermore , the plots motivate a distributional regression approach , where not only the mean but also variance and potentially other parameters are modeled as functions of the covariates considered . in particular , it is conceptually straightforward to use the suggested type of estimation algorithm also for markov - switching generalized additive models for location , shape and scale ( gamlss ; @xcite ) .",
    "there are various other ways to modify or extend the approach , in a relatively straightforward manner , in order to enlarge the class of models that can be considered .",
    "first , it is of course straightforward to consider semiparametric versions of the model , where some of the functional effects are modeled nonparametrically and others parametrically . especially for complex models , with high numbers of states and/or high numbers of covariates considered",
    ", this can improve numerical stability and decrease the computational burden associated with the smoothing parameter selection .",
    "the consideration of interaction terms in the predictor is possible via the use of tensor products of univariate basis functions .",
    "the likelihood - based approach also allows for the consideration of more involved dependence structures ( e.g.  semi - markov state processes ; @xcite ) .",
    "finally , in case of multiple time series , random effects can be incorporated into a joint model ."
  ],
  "abstract_text": [
    "<S> we consider markov - switching regression models , i.e.  models for time series regression analyses where the functional relationship between covariates and response is subject to regime switching controlled by an unobservable markov chain . </S>",
    "<S> building on the powerful hidden markov model machinery and the methods for penalized b - splines routinely used in regression analyses , we develop a framework for nonparametrically estimating the functional form of the effect of the covariates in such a regression model , assuming an additive structure of the predictor . </S>",
    "<S> the resulting class of markov - switching generalized additive models is immensely flexible , and contains as special cases the common parametric markov - switching regression models and also generalized additive and generalized linear models . </S>",
    "<S> the feasibility of the suggested maximum penalized likelihood approach is demonstrated by simulation and further illustrated by modelling how energy price in spain depends on the euro / dollar exchange rate .    </S>",
    "<S> 1.4    * keywords : * p - splines ; hidden markov model ; penalized likelihood ; time series regression </S>"
  ]
}