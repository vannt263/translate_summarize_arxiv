{
  "article_text": [
    "the simulation of dynamical quantities in one - dimensional ( 1d ) quantum many - body systems still poses a major challenge for theoretical condensed matter physics , particularly at finite temperature . from an experimentalist s perspective",
    ", there is high demand for such calculations for a variety of reasons : ( i ) experimental measurements hardly allow to study solely ground - state physics as thermal fluctuations can not be eliminated altogether .",
    "thus for a direct comparison with experimental data , it is essential to include temperature in the theoretical modeling .",
    "( ii ) technical advances have nowadays drastically enhanced the precision of neutron scattering and electron resonance spectroscopy , which for example allows the measurement of dynamic observables such as momentum - resolved excitation spectra in effective 1d materials with very high resolution.@xcite ( iii ) thermal fluctuations can cause new phenomena , which are not captured by the ground - state physics of the system .",
    "two examples are the sudden emergence of a single spinon dispersion ( `` villain mode '' ) in xxz - like spin - chain materials,@xcite or the existence of quantum critical phases in various strongly correlated materials.@xcite    which numerical tools can be employed to simulate such dynamic observables in a 1d quantum system ?",
    "at zero temperature , the density matrix renormalization group ( dmrg ) is the most successful exact numerical method for describing quantum many - body systems regarding their static and dynamic ground - state properties.@xcite dmrg based algorithms have also been successfully extended to treat systems at finite temperature , yet the computational efficiency of such approaches is still limited .",
    "exact diagonalization ( ed ) or quantum monte carlo ( qmc)@xcite can only be considered as complementary approaches rather than proper alternatives to dmrg , since the applicability of ed is restricted by small system sizes , and that of qmc by the need for performing an ill - defined analytic continuation , and often also by the occurrence of a sign problem . thus , the simulation of experimentally relevant quantities such as dynamic response functions represents a highly demanding and difficult task for finite - temperature numerics .    whereas early dmrg approaches for computing finite - temperature response functions for a 1d quantum system",
    "have been based on the transfer matrix renormalization group ( tmrg),@xcite today the most popular method builds on the purification of the density matrix in the matrix - product - state ( mps ) formalism.@xcite the response functions can then be calculated with high precision by using tdmrg in the real - time realm , and a subsequent fourier transform also allows the computation of spectral functions.@xcite purification can also be combined with a chebyshev expansion technique to determine finite - temperature spectral functions directly in frequency space.@xcite although these methods have been successfully applied to a number of experimental setups , the accessible time scale ( or maximal chebyshev expansion order ) and hence the spectral resolution is limited , as the propagation of excitations during the dynamic evolution yields a linear growth of entanglement , leading to an exponential increase in the required numerical resources . in addition , the encoding of mixed states inevitably requires doubling the size of the hilbert space and introduces additional entanglement between the physical state and its environment , which limits the efficiency of purification simulations towards low temperatures .    an alternative way to compute finite - temperature quantities",
    "was recently presented by white in ref .",
    "[ ] . instead of purifying the density matrix , an ensemble of pure states",
    "is introduced that are constructed to resemble the typical state of a quantum system at finite temperature .",
    "it has been shown that these so - called minimally entangled typical thermal states ( metts ) excellently represent the thermal properties of the system of interest .",
    "at the same time , they can efficiently be represented in the mps formalism as their entanglement is very low .",
    "@xcite the metts approach was originally only used to compute static quantities of spin - chains@xcite and fermions .",
    "@xcite in the meantime , it has also been applied to simulate finite - temperature quenches@xcite and response functions.@xcite    the numerical effort for constructing a single metts is comparable to ground - state dmrg , since metts avoids the explicit computation of the density matrix .",
    "since metts calculations are also easily parallelized , it has originally been considered to be a more efficient finite - temperature formulation than purification .",
    "more recently , ref .",
    "[ ] showed in a detailed study that this claim can not generally be supported , because the additional statistical error source introduced by the sampling increases computational costs , especially at high temperatures .",
    "nevertheless , metts still offers much potential towards the simulations of low - temperature properties of complex models , as long as one does not insist on reducing the statistical error to be as small as the truncation error .    to bring out the full potential of metts for the calculation of dynamic quantities ,",
    "this work addresses a severe constraint of the current formulation of the algorithm : the ensemble states can not be chosen such that they respect inherent _ symmetries _ of the system and at the same time minimize autocorrelation effects .",
    "this drastically increases the numerical resources necessary for computing the real - time evolution of the ensemble states , as the mps have not been decomposed into symmetry blocks by means of the symmetry - induced selection rules .",
    "@xcite to remedy this problem , we introduce an intuitive and easily implementable extension of white s approach : starting from a metts sample of states that are not symmetry eigenstates , we generate a sample of symmetry eigenstates , called symetts .",
    "these states allow both simple abelian and more complex non - abelian symmetries to be exploited in the computation of dynamic quantities .    as an experimentally relevant application of symetts",
    ", we study temperature effects on the @xmath3 magnetization plateau of a generalized diamond chain model , which has been derived as a microscopic model for the natural mineral azurite @xmath4.@xcite this material has attracted much attention due to the discovery of a plateau at @xmath3 in the magnetization curve at low temperatures.@xcite via real - time evolution of symetts ensembles , it is possible to obtain highly resolved excitation spectra in the @xmath3 plateau phase for various temperatures .",
    "we observe a crossing of monomer and dimer branches with increasing magnetic field , which intuitively explains the effects of finite temperature on the magnetization in the plateau phase .    the paper is organized as follows . in sec .",
    "[ sec : metts ] we briefly review the original metts algorithm and the necessity of choosing a symmetry - breaking collapse routine to generate the ensemble . sec .",
    "[ sec : symetts ] introduces a metts formulation based on symmetry eigenstates for models with both abelian and non - abelian symmetries .",
    "[ sec : results1 ] summarizes benchmark calculations for static and dynamic observables for the spin-@xmath5 xxz chain . in sec .",
    "[ sec : azurite ] symetts is employed to study an experimentally relevant microscopic model for the natural mineral azurite .",
    "a technical discussion on the combination of symetts with a chebyshev expansion to directly calculate dynamic correlators in frequency space is relegated to appendix [ sec : chemetts ] .",
    "the computational efficiency of symetts in the context azurite is assessed in appendix [ app : cputime ] .",
    "first of all , we review the construction of a metts sample to approximate a thermal expectation value @xmath6 for a general chain model with @xmath7 sites . to this end , the trace of a thermal expectation value @xmath8 $ ] is expanded in terms of an orthonormal basis @xmath9 of classical product states ( cps ) of the form @xmath10 .",
    "each such state has an entanglement entropy of exactly zero .",
    "thus these states represent a natural choice for a basis at infinite temperature , where the system should behave classically .",
    "in addition , their entanglement growth under imaginary - time evolution remains comparatively low , hence the designation `` minimally entangled '' states .",
    "the expectation value of @xmath11 can be written as @xmath12 with the partition function @xmath13 =    \\sum_{{{\\ensuremath\\boldsymbol{\\sigma } } } } p_{{{\\ensuremath\\boldsymbol{\\sigma } } } }   $ ] .",
    "the normalized states @xmath14 represent a set of metts with corresponding probabilities @xmath15 , defined as @xmath16 by sampling the metts @xmath17 according to the probability distribution @xmath18 , the calculation of a thermal expectation value can be reformulated into taking the plain average of @xmath19 .    to obtain a metts sample @xmath20 with the correct probability distribution , a markov chain of cps @xmath21",
    "is generated .",
    "this is done in a way that obeys detailed balance , which guarantees reproducing the probability distribution @xmath18 .",
    "the sampling algorithm can be set up sequentially . to this end , one starts from an arbitrary cps @xmath21 and conducts what is called a _ thermal step _ : +    a single metts @xmath17 is generated by evolving the cps in imaginary time and normalizing it .",
    "a measurement of all local degrees of freedom is performed by projecting ( or collapsing ) @xmath22 into a new cps @xmath23 with probability @xmath24 .",
    "the transition probabilities obey detailed balance @xmath25 by construction .",
    "+    the thermal step is then repeated with the newly generated cps to generate a metts ( see fig .",
    "[ fig : metts_alg ] for illustration ) . by construction",
    ", the correct distribution is recovered as a fixed point of this procedure . to eliminate any artificial bias caused by the choice of the initial random cps ,",
    "the first few thermal steps are neglected in the calculation of any static observable @xmath26 or dynamic response function @xmath27 .",
    "see sec .",
    "[ sec : dyn ] . ]    by making good choices for the local measurements ( see sec .  [",
    "sec : ergo ] ) , the sample size @xmath28 can be chosen surprisingly small to obtain accurate results [ @xmath29@xmath30 .    at this point ,",
    "a comment on accuracy is in order .",
    "it was recently pointed out by ref .",
    "[ ] that the purification approach drastically outperforms metts , because for fixed total computation time it reaches more accurate results , where the accuracy was judged by comparing to quasi - exact calculations . however , this should not be a surprise , since the metts sampling introduces an additional statistical error source , which generally scales as @xmath31 .",
    "obviously , this prevents a perfect convergence of metts results towards exact data and limits the efficiency at very high temperatures in comparison to a non - statistical method . nevertheless , we believe that metts offers much potential towards the simulations of low - temperature properties of complex models , as long as one does not insist on pushing the statistical error towards the order of the truncation error .      generating a new cps @xmath21 by collapsing",
    "a metts represents the most crucial step of the sampling algorithms , as a bad choice of measurement basis leads to a drastically increased autocorrelation time .",
    "@xcite    let us assume that the local hilbert space of each site @xmath32 in our chain model is represented by an orthonormal basis @xmath33 of size @xmath34 , @xmath35 .",
    "the projective measurement @xmath36 can be efficiently carried out site by site by making use of the well - defined orthogonality relations for a mps , typically starting at one end of the chain ( in our case site 1 ) . to this end , the @xmath34 transition probabilities @xmath37 are calculated by introducing the projectors @xmath38 .",
    "then one of the @xmath34 states is chosen with probability @xmath39 by rolling a dice .",
    "the state is collapsed by the application of the projector @xmath40 , and the orthonormal center of the mps is shifted to the next site , where the collapse process is repeated .    in principle , the orthonormal basis @xmath33 on each site @xmath32 can be chosen arbitrarily .",
    "nevertheless , there are good and bad choices with respect to the sampling efficiency .",
    "we illustrate this for the example of the spin-@xmath5 xxz heisenberg chain , @xmath41 + h \\sum_j^n \\hat{s}_{j}^z \\ , \\ ] ] for the isotropic case @xmath42 , @xmath43 and @xmath44 .",
    "this model features a non - abelian su@xmath45 symmetry , which can be reduced to an abelian u(1 ) symmetry , e.g. , by considering the total magnetization @xmath46 as a good quantum number . at first sight ,",
    "the eigenstates of the spin operator @xmath47 resemble a natural choice for the orthonormal basis set @xmath33 , since this choice allows the encoding of the projectors in the form of diagonal operators .",
    "moreover , all resulting cps are eigenstates of @xmath48 .",
    "therefore , it is possible to directly implement the abelian u(1 ) symmetry in the mps representation resulting in a massive reduction of computational effort .",
    "however , a collapse routine based on measurements along the @xmath49 axis only ( `` @xmath49 collapse '' ) leads to a serious problem with ergodicity , as already extensively discussed in ref .",
    "subsequently generated cps are strongly correlated and thus the autocorrelation times are very long , so that the bias arising from the initial random cps can not be removed in a few thermal steps .",
    "additionally , cps generated from subsequent thermal steps always have the same total magnetization @xmath46 since the @xmath49 collapse conserves this quantity .",
    "it is therefore impossible to cover different @xmath46 sectors with the sampling algorithm described above , as one is always stuck in the symmetry sector of the initially chosen cps .",
    "this issue can be resolved by randomly choosing a different local basis for each site of the chain ( `` random collapse '' ) .",
    "alternatively , it has been shown that alternating in subsequent thermal steps between two basis sets that are maximally mixed relative to each other , e.g. , the eigenstates of @xmath50 and @xmath51 , also restores ergodicity and covers multiple symmetry sectors of the sample ( `` maximally mixed collapse '' ) .",
    "heisenberg chain with @xmath52 spins for @xmath53 .",
    "details on the setup of the imaginary - time evolution can be found in sec .",
    "[ sec : results1 ] .",
    "starting from an ensemble of 100 randomly generated cps , we conduct ten thermal steps with each state and measure the ensemble average of the total energy in each step .",
    "the different basis choices for the cps collapse become apparent in the autocorrelation times .",
    "whereas measuring along the @xmath49 axis only ( squares ) leads to strong autocorrelations that prevent the energy to converge towards the exact value ( black lines ) , randomly chosen measurement bases ( circles ) result in short autocorrelation times of a few thermal steps.@xcite ]    we illustrate the failure of the @xmath49 collapse routine by starting from an ensemble of randomly generated cps and then conducting 10 thermal steps with each state of the ensemble for three different values of @xmath54 .",
    "after each step , we measure the ensemble average of the total energy , which is displayed in fig .  [",
    "fig : szvsrand ] . for comparison",
    ", we also calculate the same quantity using the random collapse routine .",
    "when choosing a random basis for each cps collapse ( circles ) , the total energy of the ensemble is already well converged towards the exact value after a few thermal steps , because autocorrelations between subsequent cps are practically absent .",
    "in contrast , when measuring along the @xmath49 axis only ( squares ) , the total energy is nowhere near its exact value , even after 10 thermal steps .",
    "we have discussed the causes of this behavior above : first of all , one can identify strong correlations between subsequent cps during the application of the @xmath49 collapse resulting in an increase of autocorrelation time .",
    "in addition , each cps remains in its initial symmetry sector .",
    "if the different symmetry sectors are not distributed according to the correct probability distribution at a specific value @xmath54 ( which is very unlikely starting from a random set ) , the ensemble can not capture the correct behavior of the system , as the sample is biased towards specific sectors .",
    "this explains why the average energy is not only converging slowly towards the exact value , but rather seems to saturate at a significantly higher value .",
    "thus , a symmetry conserving collapse routine that is based on measurements in a fixed local basis is clearly impracticable .",
    "if we want to retain the ergodicity of the metts sample , we are left to choose between the random or the maximally mixed collapse routine .",
    "this comes at a price , as the ensemble states can not be chosen such that they conserve inherent symmetries of the system , because both collapse routines clearly require symmetry - breaking measurements .",
    "however , the efficient treatment of symmetries is often essential for calculating especially dynamic properties of complex models , such as 1d systems and 2d lattice models with experimental relevance . since the current metts setup does not allow abelian or non - abelian symmetries to be exploited ,",
    "it is not suitable for accessing dynamic observables of such complex systems .    in the following ,",
    "we show how to resolve this fundamental issue by a simple extension of the sampling algorithm that will enable us to systematically build a metts ensemble based on symmetry eigenstates .",
    "the matrix - product - state framework allows for a straightforward incorporation of symmetries of the model hamiltonian.@xcite generally speaking , the symmetry - induced selection rules cause a large number of matrix elements to be exactly zero , thus bringing the hamiltonian into a block - diagonal structure and subdividing tensors into well - defined symmetry sectors . keeping only the non - zero elements , we can achieve tremendous improvement in speed and accuracy in numerical simulations by the inclusion of symmetries . in the context of non - abelian symmetries , the non - zero data blocks are not independent of each other and can be further compressed using the clebsch - gordan algebra for multiplet spaces .",
    "here we refrain from discussing this topic at length and refer to ref .",
    "[ ] for a detailed review on the treatment of symmetries in tensor network applications .    following the notation of ref .",
    "[ ] , we label the state space in terms of the symmetry eigenbasis @xmath55 , where the quantum labels @xmath56 denotes the irreducible representation of the symmetry group @xmath57 of the hamiltonian @xmath58 . every symmetry generator",
    "@xmath59 satisfies @xmath60=0 $ ] .",
    "hence , all states in a given hilbert space corresponding to a certain @xmath56-label are combined into a symmetry block @xmath56 .",
    "the label @xmath61 identifies a particular multiplet within the specific symmetry block @xmath56 .",
    "the internal multiplet label @xmath62 resolves the internal structure of the corresponding multiplet . in the context of abelian symmetries",
    "the clebsch - gordan structure becomes trivial , hence the @xmath62 labels take the role of @xmath56 labels .",
    "note that this notation can be easily generalized to the treatment of multiple symmetries.@xcite    to further clarify the notation , we consider the example of the isotropic heisenberg chain in eq .",
    "( [ eq : xxx_h ] ) , which features a su@xmath45 symmetry , @xmath63 .",
    "we make the usual choice of basis in which the @xmath49 component of the spin operator , @xmath64 is diagonal and label a general spin multiplet by @xmath65",
    ". the spin multiplet label can take the values @xmath66 , while the internal multiplet label , corresponding to the @xmath49 component of the spin , is restricted to @xmath67 .",
    "now consider a typical mps scenario , where the wave function @xmath68 in the local picture of site @xmath32 can be represented as latexmath:[\\[\\label{eq : mps }    in the presence of symmetries , the physical state space at site @xmath32 as well as the left and right orthonormal basis states can be written as @xmath70 , @xmath71 , @xmath72 .",
    "hence , symmetry labels can be introduced naturally in the mps representation . in particular , every leg or bond in the usual diagrammatic depiction of a mps can be assigned a multiplet label , here @xmath73 and @xmath74 , e.g. , @xmath75}_{qq '' }   =   \\parbox[h][0.1\\linewidth][c]{0.20\\linewidth } {          \\includegraphics[width=\\linewidth]{eq_sps.pdf } } , \\ ] ]      in order to work with a symmetry conserving metts ensemble , we reformulate eqs .",
    "( [ eq : expt ] ) and ( [ eq : defmetts ] ) in terms of symmetry eigenstates before introducing an efficient sampling routine ( see sec .  [",
    "sec : sampling ] ) . in place of the cps we introduce a set of symmetry product states ( sps ) @xmath76 , that can be considered as symmetrized counterparts of the cps .",
    "a sps is a mps with ( multiplet ) bond dimension one , where each bond represents a single , unique symmetry block @xmath77 , and that block contains just a single multiplet ( @xmath78 ) .",
    "thus the sps can be fully characterized by a set of @xmath7 quantum labels @xmath79 , one label @xmath77 per site / bond @xmath32 labeling the corresponding symmetry sector .",
    "the overall symmetry sector of each sps @xmath76 is fully determined by the @xmath56-label of the last bond , @xmath80 .",
    "the simplest example of a sps for the su(2 ) symmetric heisenberg chain is to combine pairs of neighboring spins to singlets @xmath81 for spin-@xmath5 systems , the quantum labels @xmath82 correspond to a sequence of @xmath83 for odd and even bonds , respectively , with a total spin @xmath84 , as illustrated in fig .",
    "[ fig : sps](a ) .",
    "although the ( multiplet ) dimension on each bond remains one for a non - abelian sps , it is no longer a pure product state in the classical sense as the internal multiplet structures can introduce non - trivial entanglement between neighboring sites .",
    "the same formalism also applies for abelian sps . reducing su(2 ) to an abelian u(1 ) symmetry in the heisenberg model , e.g. , by choosing an anisotropy @xmath85 in eq .",
    "( [ eq : xxx_h ] ) or adding a finite magnetic field in the @xmath49 direction , and choosing the total spin @xmath46 as conserved quantity , a typical sps takes the form of latexmath:[\\[\\label{eq : sps_u1 }    in this case , the quantum label @xmath77 represents the sum of all @xmath87-contributions for sites @xmath88 , i.e. , @xmath89 as shown in fig .",
    "[ fig : sps](b ) .",
    "hence , the total magnetization @xmath46 of the sps is given by the last label @xmath80 .",
    "in the abelian case , a sps can be understood as a direct product of local symmetry eigenstates of each site , and hence is always represented by a mps of bond dimension one , much like a classical product state .    ) and ( b ) in eq .",
    "( [ eq : sps_u1 ] ) . ]",
    "analogously to the cps basis set @xmath9 , a full set of sps @xmath90 represents a complete orthonormal basis taking into account all possible symmetry sectors of the system .",
    "thus , we can proceed as above and expand the trace of a thermal expectation value @xmath8 $ ] in terms of the symmetry product states @xmath76 : @xmath91 the normalized states @xmath92 now represent a set of symmetric metts ( symetts ) with probabilities @xmath93 defined in analogy to eq .",
    "( [ eq : defmetts ] ) ,    [ eq : defsymetts ] @xmath94    the thermal expectation value @xmath6 is now estimated by sampling symetts @xmath92 according to the probability distribution @xmath95 .",
    "however , we still have to establish how to sample a set of symetts @xmath96 according to the correct probability distribution @xmath95 , in a way that ensures ergodicity .",
    "we illustrated in sec .",
    "[ sec : ergo ] for the spin-@xmath5 heisenberg chain that a collapse routine purely based on measurements along the @xmath49 axis , conserving the u@xmath97 symmetry , fails to capture the correct thermal properties of the model .",
    "this is due to strong autocorrelation effects and the fact that the symmetry sectors initially are distributed randomly instead of according to the correct probability distribution @xmath95 . from this discussion",
    ", we can learn that the symetts sample has to be generated from sps that already capture the correct distribution of symmetry sectors . that this can already be achieved using a maximally mixed collapse procedure and treating the @xmath98 basis as an effective @xmath49 basis .",
    "this is possible due to the presence of the su@xmath45 symmetry in the isotropic model which is effectively reduced to u(1 ) by this implicit switch of bases .",
    "note that this is not possible in absence of su(2 ) , e.g. , in the anisotropic xxz model or in the presence of a magnetic field .",
    "hence this trick can not be used to exploit the full symmetry of the respective model . ]",
    "this can be achieved by starting from a typical thermal state , which already incorporates all the necessary thermal information . to this end",
    ", we extend the metts sampling algorithm . after the conduction of a thermal step with a non - symmetric cps @xmath21 and metts @xmath99 using a random or maximally mixed collapse [ c.f  ( i ) and ( ii ) in sec .",
    "[ sec : metts ] ] , we employ an additional _ symmetrization step _ : +    using a symmetry - conserving collapse routine ( described below ) , we collapse @xmath99 to a sps @xmath76 with probability @xmath100 .",
    "each collapse generates a sps according to the correct probability distribution @xmath95 ( thus belonging to one of the relevant symmetry sectors at a given temperature ) , as long as the non - symmetric metts has been sampled according to @xmath18 .",
    "the resulting sps @xmath101 can easily be converted into an mps with explicit encoded symmetry sectors,@xcite which is then evolved in imaginary time and normalized to generate the symetts @xmath102 .",
    "+    the combination of thermal and symmetrization step is then repeated with the newly generated cps @xmath23 to create a full symetts sample @xmath103 , which represents the basis for calculating static or dynamic observables at finite temperature ( see fig .",
    "[ fig : symetts_alg ] for an illustration ) .",
    "thus we ensure that all computed symetts are minimally autocorrelated , as each of them is generated from a different non - symmetric metts .",
    "see sec .",
    "[ sec : dyn ] . ]    by maximizing the ergodicity of the sample , we face additional computational cost , as we have to generate a full non - symmetric metts sample @xmath104 as well . in principle , it is possible to reduce the number of non - symmetric metts by generating a larger number of sps from each @xmath99 by repeating the symmetrization step multiple times .",
    "however , this may introduce artificial correlations between different sps generated from the same non - symmetric metts .",
    "for this reason , we present the symetts algorithm using a formulation that maximizes ergodicity .",
    "this limits the applicability of symetts in terms of calculating static observables . in these cases",
    ", we would have to work harder than with regular metts .",
    "however , when calculating _ dynamic _ quantities , generating the symetts sample accounts for only a factor @xmath105 or less of the total computation time .",
    "hence , our algorithm ensures that the full potential of symetts towards dynamic applications is guaranteed and no ergodicity problems arise .      in this section ,",
    "we illustrate step ( iii ) of the symetts sampling for the example of the isotropic spin-@xmath5 heisenberg chain ( [ eq : xxx_h ] ) .    in context of u@xmath97",
    ", the collapse routine employed in step ( iii ) simply corresponds to the @xmath49 collapse discussed in sec .",
    "[ sec : ergo ] , i.e. , measuring along the @xmath49 axis only .",
    "the resulting sps take the form of direct products of local symmetry eigenstate @xmath106 and are automatically distributed according to the correct probability @xmath95 .",
    "however , to exploit the full su@xmath45 symmetry of the model , the collapse routine has to be adapted in order to generate a sps ensemble @xmath90 of su(2 ) eigenstates . for a single sps ,",
    "this is achieved by using a non - symmetric metts @xmath99 and sequentially collapsing it into the different eigensectors of the total spin operator @xmath107 .    to this end , we gradually build @xmath107 starting from the left end of the chain . at the first site , the total spin is always @xmath5 as we only consider a single spin , hence after constructing @xmath108 no projection is required and the orthonormal center of @xmath99 can be shifted to the second site . here , we generate the total spin operator of first and second site according to @xmath109 with @xmath110 and the subscript `` @xmath111 '' indicating that we consider the total spin of the left part of the chain up to the second site . diagonalizing this operator",
    ", we obtain the two spin sectors @xmath112 corresponding to the singlet and triplet configuration , and the projectors @xmath113 .",
    "we project the second bond of @xmath14 ( and also @xmath114 ) either into singlet or triplet configuration according to the transition probabilities @xmath115 and shift the orthonormal center of @xmath99 to the next site .",
    "this procedure is repeated sequentially for every site @xmath32 of the system .",
    "each time , we construct the spin operator for the left and the local part of the chain according to @xmath116 where @xmath117 denotes the total spin squared of all sites to the left of ( and excluding ) site @xmath32 .",
    "after diagonalization , the transition probabilities are calculated and @xmath14 is projected at bond @xmath32 into a single spin sector .",
    "just as for the initially considered example , the operator @xmath118 always contains only two spin sectors , namely , @xmath119 .",
    "hence , diagonalization and projections can be carried out very efficiently .    in the end , one obtains a su@xmath45 symmetric sps @xmath76 with probability @xmath100 .",
    "states of this type are the initial point for setting up the su(2 ) symmetric mps framework.@xcite",
    "in this section , we present some benchmark results for our symetts approach applied to both static and dynamic observables of the xxz heisenberg model with @xmath52 spins in the isotropic ( @xmath43 , xxx model ) and the free fermion limit ( @xmath120 , xx model ) . as truncation criterion",
    ", we choose to keep all singular values above @xmath121 during the process of imaginary - time evolution , which is carried out using standard tdmrg tools with a second order trotter decomposition and a time - step @xmath122 .",
    "for the subsequent real - time evolution we adapt only the truncation criterion to @xmath123 .",
    "all quantities are expressed in terms of the coupling @xmath42 .    .",
    "panels ( a - d ) in the upper row display the thermal energy of each symmetry sector entering the symetts sample for @xmath54 ranging between @xmath124 and @xmath125 ; dashed lines indicate the overall ensemble average @xmath126 determined by symetts .",
    "moreover , a comparison to benchmark calculation based on metts ( dotted lines ) and purification ( solid lines ) is provided .",
    "panels ( e - h ) in the second row show @xmath127 , in order to zoom into an energy window of order of the temperature around @xmath126 . panels ( i - l ) in the last row illustrates the subsample size @xmath128 of different symmetry sectors for a fixed total sampling size @xmath129 . ]",
    "first , we discuss some static symetts calculations for the total energy of the isotropic heisenberg chain ( [ eq : xxx_h ] ) with and without finite magnetic field .",
    "the data below conclusively show that the slightly modified metts algorithm above is able to obtain results of similar accuracy as the non - symmetric metts sampling at equal sample size @xmath28 .",
    "of course , this is to be expected since symetts essentially generates the ensemble states analogously to the original algorithm .",
    "nevertheless , this exercise helps to understand the importance of using sample states which are correctly distributed over the relevant symmetry sectors .    to illustrate the method in more detail , fig .",
    "[ fig : hb_n50u1hz1_m500 ] shows u(1)-symetts results resolving the different symmetry sectors entering into the calculation of the thermal energy for four different inverse temperatures .",
    "the upper row displays the average energy of each subsample of states characterized by fixed @xmath130 . in the middle row",
    ", we zoom into a window of order of the temperature around the average energy of the sample . the resulting values for @xmath126 determined by symetts [ eq .  ( [ eq : expt_sps ] ) ]",
    "are benchmarked against metts calculations [ eq .  ( [ eq : expt ] ) ] and quasi - exact purification data .",
    "the thermal average of all symetts subsamples leads to highly accurate results for @xmath126 .    for large @xmath54",
    ", the lowest energy is obtained by the @xmath131 sector , which corresponds to the ground state symmetry sector of the system .",
    "depending on the temperature , the energy of the neighboring sectors increases more or less steeply . at high temperatures , thermal fluctuations",
    "become clearly visible in the thermal energies of the different symmetry sectors . accordingly",
    ", the number of relevant symmetry sectors obtained from the symetts sampling step ( ii ) is closely related to the temperature .",
    "thermal fluctuations drive the sample states into more `` excited '' symmetry sectors at high temperatures : the maximum symmetry sector occurring in the @xmath132 simulation corresponds to @xmath133 , whereas we find a maximum of @xmath134 for @xmath135 as the system relaxes more towards the ground state .",
    "this behavior is also illustrated by the bottom row of fig .",
    "[ fig : hb_n50u1hz1_m500 ] , which shows the subsample size @xmath128 of each symmetry sector for a fixed total sample size @xmath136 .",
    "again we observe , that the distribution of symmetry sectors is broad at high temperatures and becomes narrow for large values of @xmath54 .    , using the same layout as fig .",
    "[ fig : hb_n50u1hz1_m500 ] . ]    figure [ fig : hb_n50su2 ] presents results for the thermal energy of the isotropic heisenberg chain ( [ eq : xxx_h ] ) at zero magnetic field , where we can exploit the non - abelian su(2 ) symmetry of the model .",
    "the layout of the panels and the parameters are chosen in accordance with those in fig .  [ fig : hb_n50u1hz1_m500 ] above . instead of",
    "@xmath130 sectors , the symetts are now categorized in terms of the total spin @xmath137 of each su(2 ) multiplet in the sample . again",
    ", the upper and middle rows display the average energy of each subsample corresponding to a fixed @xmath137 .",
    "the resulting values for @xmath126 determined by symetts [ eq .  ( [ eq : expt_sps ] ) ]",
    "are benchmarked against metts calculations [ eq .",
    "( [ eq : expt ] ) ] and quasi - exact purification data",
    ". we find that the overall ensemble average of all symetts subsamples gives a good approximation of the thermal energy of the state also for the non - abelian sampling routine .    as for the abelian case ,",
    "the distribution of different multiplets shown in the last row becomes more narrow towards lower temperatures .",
    "whereas the majority of states at @xmath135 belong to the multiplets @xmath138 , these sectors deplete for higher temperatures and the maximum moves towards @xmath139 for @xmath132 .",
    "whereas symetts does not offer any significant computational advantage over the original formulation for computing static observables , its potential is enormous for the calculation of dynamic quantities , such as response functions of the form @xmath140 for such problems , generating the ensemble states represents only a negligible part of the total computational costs .",
    "most computational effort has to be put into the real - time evolution of each state in the sample , as the linearly growing entanglement requires an exponential increase of the bond dimension of the mps towards longer time scales .",
    "here symetts offers a great advantage over the existing metts approach , since the symmetry implementation strongly increases the numerical efficiency during the real - time evolution .",
    "in addition , the overhead cost of generating both a symmetric and non - symmetric sample in the symetts sampling ( see sec .  [",
    "sec : sampling ] ) can be ignored in almost every case , as it only accounts for a very small fraction [ @xmath105 ] of the total computational time .",
    "the achievable efficiency gains are completely analogous to the exploitation of symmetries in other mps applications , such as ground state dmrg , tdmrg or itebd . for example , the direct implementation of the abelian u(1 ) symmetries in spin models can already speed up calculations by about a factor of up to @xmath142.@xcite^,^ ] even larger benefits can be achieved when studying models with multiple abelian or non - abelian symmetries .    to simulate a response function using real - time evolution , we follow ref .  [ ] and compute for every symetts @xmath143 in our sample the expectation value @xmath144 \\hat{b }   [ e^{-i\\hat{h}t }   \\hat{c } |\\phi_{{{\\ensuremath\\boldsymbol{q } } } } \\rangle]\\ ] ] by carrying out two independent real - time evolutions , @xmath145 and @xmath146 using standard tdmrg .",
    "equation [ eq : resp_metts ] can be evaluated at any intermediate time - step @xmath147 by calculating the overlap for the operator @xmath148 , as illustrated in fig .",
    "[ fig : symetts_dyn ] . in the end , we take the sample average to obtain a result for the finite - temperature response function .    in principle , there are other options for calculating the real - time evolution of response functions.@xcite in this work , we restricted ourselves to the scheme outlined above , as it requires only two tdmrg simulations per sample state to access all intermediate time - steps up to the maximally reached timescale @xmath149 .    instead of studying real - time response functions ,",
    "here we consider their fourier transforms , i.e. , spectral functions .",
    "more particularly , we focus on dynamic spin structure factors @xmath150 , which are the fourier transform of dynamical spin correlation functions .",
    "these quantities are of particular experimental relevance , as they can be directly accessed by inelastic neutron scattering experiment . for a benchmark ,",
    "we compute the dynamic spin structure factor of the xxz heisenberg model with open boundaries : @xmath151    to this end , we define the spin - wave operator @xmath152 and evaluate @xmath153 via eq .",
    "( [ eq : resp_metts ] ) for a number of intermediate points up to some maximum time @xmath149 .",
    "then , we perform a fourier transform to frequency space , including a gaussian broadening @xmath154 $ ] in the integral in eq .",
    "( [ eq : dssf_xx ] ) to remove artificial oscillations , which are caused by the finite cut - off of the real - time evolution.@xcite this means that the exact spectral features are convolved with a gaussian @xmath155 $ ] , with a frequency resolution @xmath156 . in some cases ,",
    "linear prediction can be used to avoid the artificial broadening and extract more spectral information from the time series.@xcite however , we found that linear prediction is not reliable in our study of the generalized diamond chain ( see sec .",
    "[ sec : az_dssf ] ) .",
    "hence , we refrain from employing linear prediction in this work .    in a first study , we employ our u(1)-symetts approach to extract the dynamic spin structure factor in the limit of @xmath120 . in this case",
    ", the xxz model can be solved exactly by mapping the system by a jordan - wigner transformation to non - interacting spinless fermions.@xcite this allows us to exactly evaluate the spin correlation functions @xmath157 for arbitrary times and obtain the dynamic spin structure factor by fourier transformation for direct comparison to the symetts data .",
    "ensemble states .",
    "panel ( a ) illustrates the time evolution of individual symetts ( thin lines ) at @xmath132 used to calculate @xmath158 by taking the ensemble average ( thick red line ) .",
    "( b ) displays the symetts ensemble average for various inverse temperatures , which is then used to compute the dynamic spin structure factor in frequency space .",
    "panels ( c ) and ( d ) show the frequency data obtained from fourier transform for @xmath159 and @xmath160 .",
    "for all considered inverse temperatures , we find excellent agreement with the exact result ( dashed lines ) . ]     and ( b ) @xmath161 of the isotropic heisenberg chain using @xmath162 ensemble states . for all considered inverse temperatures , we find very good agreement with data obtained from matrix - product purification ( dashed lines ) . ]    fig .",
    "[ fig : hb_xx_dssf_tdmrg](a ) displays the real - time evolution of @xmath158 for @xmath132 up to @xmath163 , with the thin lines corresponding to individual realization of particular symetts states and the thick red line denoting the ensemble average .",
    "the sample averages are collected for different temperatures in fig .  [",
    "fig : hb_xx_dssf_tdmrg](b ) . after the real - time evolution",
    ", we perform a fourier transform to obtain the dynamic spin structure factor as a function of frequency , as shown in figs .",
    "[ fig : hb_xx_dssf_tdmrg](c , d ) for @xmath164 and @xmath165 .",
    "we find excellent agreement with exact results ( dashed lines ) .",
    "a prerequisite for agreement of this quality is that the statistical sampling error , and hence the temperature , is sufficiently small ; for the sample size of @xmath162 used in fig .",
    "[ fig : hb_xx_dssf_tdmrg ] the relative error , defined as @xmath166 ^ 2    } } { \\sqrt{\\int { \\rm d } \\omega s_{\\rm exact}(k,\\omega)^2 } } , \\ ] ] varies between @xmath167 for @xmath132 and @xmath168 for @xmath135 .",
    "we note that the error is approximately proportional to the temperature , which indicates that the dominant contribution is given by the statistical error of the ensemble , which scales as @xmath169 .",
    "next , we consider an isotropic coupling @xmath43 , which allows us to compute @xmath170 using su(2)-symetts , since the xxz hamiltonian ( [ eq : xxx_h ] ) features the full spin symmetry in this case",
    ". figures [ fig : hb_xxx_dssf_tdmrg](a ) and [ fig : hb_xxx_dssf_d](b ) show the results for @xmath171 in time and frequency space , respectively , in comparison to purification calculations using the same truncation criterion ( black dashed lines ) .",
    "the maximum time @xmath149 varies for different temperatures , since we stopped the symetts calculations when a threshold of 1000 states was exceeded by the bond dimension @xmath172 , which was determined adaptively by keeping all singular values @xmath173 ( see fig .",
    "[ fig : hb_xxx_dssf_d ] and upper panel of table [ tabled ] for values of @xmath149 ) .",
    "again , we find excellent agreement for the considered temperature range .",
    "in this context , we briefly discuss the intriguing question whether symetts can reach longer time scales than purification in certain limits . to this end , we study the growth of entanglement during the real - time evolution , which manifests itself in the growing bond dimension of both the average symetts as well as the purified density matrix . figures [ fig : hb_xxx_dssf_d](a ) and [ fig : hb_xxx_dssf_d](b ) present su(2 ) data for the average maximum multiplet bond dimension @xmath174 and the corresponding states space dimension @xmath175 , respectively . we find that an average symetts requires significantly less numerical resources at @xmath176 . for such low temperatures , symetts certainly allows to access longer time scales than purification when fixing the numerically feasible bond dimension to an upper cutoff .",
    "note that due to the presence of the statistical error , this does not imply that symetts is generally more accurate than purification when fixing the total computation time and judging accuracy by comparing to quasi - exact calculations , as done in ref .",
    "however , if one does not insist to push the statistical error towards the order of the truncation error , and moreover takes into account parallelizability , symetts offers much potential towards the dynamical description of low - dimensional systems at low temperature .",
    "this is already illustrated by the calculations in this sections , demonstrating that it is possible to extract the dynamic structure factor with high accuracy using a sample size of only a few hundred states .     and ( b ) the corresponding bond dimension @xmath175 of su(2)-symetts during the calculation of @xmath177 ( solid lines ) in comparison to the purified density matrix ( dashed lines ) . in both cases , we keep all singular values @xmath173 during real - time evolution . for @xmath178",
    "we include a backwards time - evolution of the auxiliary bonds of the purified density matrix , as this leads to a reduction of the entanglement growth.@xcite ( c ) average bond dimension @xmath175 of u(1)-symetts sample during the calculation of @xmath179 for comparison . ]    on the other hand , symetts is limited to small @xmath149 at high temperatures . particularly at @xmath132 ,",
    "a single su(2)-symetts on average requires larger bond dimensions @xmath175 than the purified density matrix !",
    "this can be attributed to the intrinsic structure of the su(2 ) symmetry product states .",
    "although their multiplet dimension @xmath180 is strictly unity at infinite temperature , the sps already contain some entanglement due to the presence of non - trivial multiplet sectors with internal structure , which lead to a state space dimension @xmath181 . because of thermal fluctuations ,",
    "these `` excited '' multiplet sectors appear more frequently at high temperatures , which is illustrated by the comparison @xmath174 and @xmath175 of the corresponding sps samples in the lower panel of table [ tabled ] for different temperatures . with these non - trivial multiplets being present in the sps ,",
    "the subsequent imaginary- and real - time evolution obviously also induces more entanglement .",
    "this explains why @xmath175 of a su(2)-symetts exceeds the bond dimension necessary to represent the purified density matrix already before starting the real - time evolution at @xmath132 [ c.f  fig .",
    "[ fig : hb_xxx_dssf_d](b ) ] .",
    "this issue is not present in the context of u(1)-symetts , where the sps does not contain any intrinsic entanglement at infinite temperature and thus can still be considered as a classical product state .",
    "thus , the initial @xmath175 is strictly smaller than the bond dimension of the purified density matrix for all temperatures , as shown infig .",
    "[ fig : hb_xxx_dssf_d](c ) .",
    "moreover , the increase of @xmath175 at high and intermediate temperatures is slightly less severe than in the su(2 ) calculations .",
    "we conclude from this analysis that it is possible for symetts to exploit both abelian and non - abelian symmetries . in combination with tdmrg , it represents a valuable alternative to computing spectral functions , particularly for low temperatures .",
    "in addition , we find that abelian symetts have favorable entanglement properties over their non - abelian counterparts at high temperatures .",
    "hence , one should refrain from exploiting non - abelian symetts in these cases and switch to u(1)-symetts or matrix - product purification .    .upper",
    "panel : maximum time @xmath149 reached in the simulations shown in figs .  [",
    "fig : hb_xxx_dssf_tdmrg ] and [ fig : hb_xxx_dssf_d ] .",
    "lower panel : average multiplet bond dimension @xmath174 and corresponding average and maximum bond dimension for su(2 ) and u(1 ) symmetry product states for various temperatures . [ cols=\">,^,^,^,^\",options=\"header \" , ]     we point out that the metts algorithm in principle can also exploit time - translational invariance in order to reformulate the response function in terms of @xmath182 , which effectively doubles the maximum reachable time scale @xmath149.@xcite ideally , the time - evolution is then carried out in the heisenberg picture by evolving @xmath183 and @xmath184 directly in terms of matrix - product - operators ( mpo),@xcite so that it still requires only two tdmrg simulations to access all intermediate time - steps .",
    "we note that working in the heisenberg picture is generally considered to be suboptimal for matrix product purification.@xcite however , it seems more appealing for the metts framework as one could carry out the real - time evolution only once for the mpo and compute the response function by calculating the overlap of the time - evolved mpo and the metts sample . thus the time - evolved mpo could be recycled for arbitrary temperatures . in general",
    ", this would imply that the maximum reachable time scale is set by the real - time evolution of the operators . in the pure - state formulation , @xmath149",
    "would then be temperature independent , as temperature only enters through the calculation of the overlaps with the metts sample .",
    "naturally , this idea enormously profits from the inclusion of symmetries into the metts language presented here , but is beyond the scope of this paper and will be discussed elsewhere .",
    "finally , we remark that we have also explored the possibility of combining symetts with a chebyshev expansion to directly compute spectra in frequency space",
    ". however , this approach is computationally more expensive due to technical reasons and therefore not recommendable ( see appendix [ sec : chemetts ] for details ) .",
    "in the following , we demonstrate the efficiency of symetts by studying a more complicated spin - chain model of direct experimental relevance .",
    "we focus on the natural mineral azurite @xmath4 , which has attracted much attention due to the discovery of a plateau at @xmath3 in the magnetization curve at low temperatures.@xcite some authors proposed that the magnetic properties of this material are well described by a spin-@xmath5 diamond chain formed by the copper atoms with purely antiferromagnetic exchange couplings.@xcite others suggested a dominant ferromagnetic coupling@xcite and the importance of interchain coupling,@xcite yet none of them were able to derive a microscopic model for azurite that is able to fully characterize its complex magnetic properties .    employing a combination of first - principle methods , exact diagonalization , and dmrg , ref .",
    "[ ] recently derived a full three - dimensional model which can be mapped to an effective one - dimensional system , namely a generalized diamond chain model with purely antiferromagnetic couplings , illustrated in fig .",
    "[ fig : azurite_plateau](a ) .",
    "one third of the cu spins ( dark blue balls ) forms weakly coupled monomers ( dashed horizontal lines ) , whereas the other two thirds ( light blue balls ) form strongly coupled dimer singlets ( heavy vertical lines ) .",
    "the dominant energy scale is determined by the dimer - dimer coupling @xmath185 .",
    "in addition , there are nearest- and third - nearest neighbor dimer - monomer exchange @xmath186 and @xmath187 as well as the monomer - monomer coupling @xmath188 .",
    "more precisely , the full hamiltonian of the generalized diamond chain is defined as @xmath189 \\nonumber \\\\    & &   -   g \\mu_b h \\sum_{j=1}^{n/3 } \\big [ \\hat{s}^z_{d1,j } + \\hat{s}^z_{d2,j } + \\hat{s}^z_{m , j } \\big],\\end{aligned}\\ ] ] with external magnetic field @xmath190 , bohr magneton @xmath191 and gyromagnetic ration @xmath192.@xcite @xmath7 labels the total number of cu spins in the system , the number of unit cells is therefore given by @xmath193 .",
    "note that this model features a u@xmath97 symmetry for finite values of @xmath190 , which we exploit in our symetts calculations .",
    "the value of the couplings has been determined by dft calculations and small refinements using experimental data , leading to @xmath194 based on this system , the authors of ref .",
    "[ ] managed to derive a full microscopic picture for azurite , that is able to explain a wide number of experimental results .",
    "additional support for the validity of this model is given by ref .",
    "[ ] , which explores further aspects such as magnetocaloric properties and excitation spectrum .",
    "although refs .  [ ] and [ ] also present some selected results for the dynamic spin structure factor using dynamical dmrg ( ddmrg ) , their resolution in the energy @xmath195 and the momentum transfer @xmath196 is limited , since ddmrg is numerically expensive and requires separate calculations for each @xmath195 . moreover ,",
    "their results are restricted to zero temperature .",
    "we will now illustrate the power of symetts by calculating the excitation spectra in the plateau phase and analyze the influence of magnetic field and temperature on the excitation branches .     and @xmath188 .",
    "one unit cell of the system is highlighted by the gray area .",
    "( b ) dependence of the magnetization on an external magnetic field @xmath190 , which we calculated by employing dmrg and symetts at zero and finite temperature , respectively . in all calculations ,",
    "we keep every singular value larger than the truncation threshold @xmath197 and use a sample size of @xmath198 . for a system of @xmath199 spins in total ,",
    "the emergence of the @xmath3 plateau can be observed for fields in the range of @xmath200 . at finite temperatures ,",
    "the plateau is washed out and the magnetization curve becomes a linear function of @xmath190 .",
    "the vertical dashed lines indicate the parameter choices for our dynamical symetts calculations in sec .",
    "[ sec : az_dssf ] . ]",
    "the most striking feature of azurite is the plateau at @xmath3 in the magnetization curve as a function of a magnetic field applied along the @xmath201 axis of the crystal lattice.@xcite this property can be nicely captured by the generalized diamond chain model , as already demonstrated in ref .",
    "[ ] by employing a direct comparison of the magnetization obtained from ground - state dmrg calculations with experimental data . performing dmrg on an open chain with @xmath199 spins ,",
    "we obtain the magnetization plateau at @xmath202 shown in fig .",
    "[ fig : azurite_plateau](b ) ( black line ) . for better comparison ,",
    "we use experimental units in the rest of this section .",
    "we find that the plateau phase is bounded by a lower and upper critical field , @xmath203 and @xmath204 .",
    "note that the small intermediate steps for @xmath205 and @xmath206 are artifacts caused by finite - size effects of the chain .",
    "the plateau can be explained by a very intuitive argument.@xcite the dominant dimer - dimer exchange coupling @xmath185 forces the dimer spins into a singlet state , whereas the monomer spins are only weakly coupled by @xmath188 .",
    "therefore , the monomer spins polarize first for a finite magnetic field , whereas the dimers remain in the singlet state for a considerable interval of @xmath190 . only at large fields @xmath207 ,",
    "the dimers are arranged in a polarized state .",
    "thus only @xmath3 of the total spins is aligned in direction of the field at intermediate fields strengths @xmath200 , leading to the emergence of the @xmath3 magnetization plateau .    introducing thermal fluctuations by employing symetts",
    ", we observe that the plateau is gradually washed out with increasing temperature . at high temperatures ,",
    "the quantum mechanical properties of the system are almost erased and the magnetization curve becomes a linear function of the magnetic field .",
    "we note that in the plateau phase , the effect of temperature on the magnetization depends strongly on the specific field strength . for values of @xmath190",
    "significantly smaller than @xmath125  t the magnetization strongly decreases with increasing temperatures . in this case",
    ", we expect the change in magnetization to be predominantly caused by the monomers , which have to vacate their fully polarized state . on the other hand",
    ", the monomers can not contribute to the thermal increase of the total magnetization for @xmath208  t as they are already fully polarized on the plateau . here",
    "the thermal fluctuations should predominantly excite the dimers by breaking up their singlet structure .",
    "we expect this to be reflected in the excitation spectra on the plateau .",
    "we study these next by means of the transverse dynamic spin structure factor , for the three values @xmath209  t indicated by the vertical dashed lines in fig .",
    "[ fig : azurite_plateau](b ) .",
    "we employ u(1)-symetts to compute the transverse dynamic spin structure factor of the generalized diamond chain model , which can directly be measured by neutron scattering experiments .",
    "following ref .",
    "[ ] , the dynamic spin structure factor is defined as @xmath210.\\ ] ] note that it is important to use the precise positions @xmath211 of the cu spins in azurite@xcite and the experimentally chosen momentum direction in order to make the data comparable to the experiment in ref .",
    "we perform all calculations for an open chain of @xmath199 spins , which allows an accurate resolution of the momentum transfer @xmath196 along the chain direction . for each @xmath196 , we average over a symetts sample of 300 states exploiting the u@xmath97 symmetry of the model . in comparison to non - symmetric metts , u(1)-symetts yields",
    "a reduction of cpu time by a factor between 4 and 10 for the parameters considered here ( see appendix [ app : cputime ] for a more detailed assessment ) . using a second - order trotter decomposition",
    ", we set the time step @xmath212 and truncation error @xmath213 in the imaginary- and real - time evolution , respectively .",
    "we stop the real - time evolution at @xmath214 and checked that calculations are not impaired by finite - size reflections on this time scale .",
    "this setup leads to a maximum bond dimension @xmath215 at @xmath149 for all the time - evolved symetts considered . to minimize finite - time effects",
    ", we here use a gaussian broadening to perform the fourier transform , leading to a frequency resolution @xmath216 mev . as an alternative route",
    ", we had also tested linear prediction , but found that for this model its results were very sensitive to changes of the regularization parameter and the statistical window on the given time scale . therefore while in principle , after significant further fine tuning , linear prediction may allow a systematic extrapolation to longer time scales to enhance spectral resolution , we did not further pursue this route .",
    "our results are displayed in fig .",
    "[ fig : dssf_az ] .",
    "each column indicates a different magnetic field strength @xmath209  t and each row corresponds to a different temperature @xmath217  k.    let us first note that fig .",
    "[ fig : dssf_az](a ) at zero temperature and @xmath218  t nicely reproduces all features of the ddmrg data used in ref .",
    "[ ] for a direct comparison with the experiment in ref .",
    "we observe a gapped system with a low - energy band dispersing along @xmath196 , corresponding to the monomer excitations , and a dimer branch at higher energies , whose dispersion is weakened by the competition of @xmath186 and @xmath185.@xcite the spectral weight in both branches is mainly distributed around @xmath219 .",
    "moreover , we find an additional excitation branch at @xmath220  mev with only small spectral weight and almost no dispersion . in the experiment ,",
    "this branch is shifted towards higher energies ( by @xmath221 mev).@xcite    increasing the magnetic field has an effect on the position of both the monomer and dimer band ( but not on their dispersion ) , which can be understood easily in an intuitive picture . as discussed in sec .",
    "[ sec : plateau_az ] , the monomers are fully polarized in the entire plateau phase . hence , exciting a monomer spin becomes increasingly expensive for larger magnetic fields , because a spin - flip is penalized by the additional zeeman energy . comparing the position of the monomer branch in figs .",
    "[ fig : dssf_az](a ) and [ fig : dssf_az](c ) , the shift towards higher energies at @xmath222 t is fully captured by the change in the zeeman term @xmath223  mev .",
    "the magnetic field has the reversed effect on the dimer band , which is shifted to lower energies . again",
    "the effect can be understood using the same line of arguments . exciting a dimer singlet results in the break off of the singlet structure , allowing the dimer spins to polarize in the direction of @xmath190 . at larger field strength ,",
    "each excited dimer spin is therefore rewarded by a factor of @xmath224 from the zeeman term .",
    "this fully accounts for the shift of the dimer branch to lower energies in figs .",
    "[ fig : dssf_az](a ) and [ fig : dssf_az](c ) . at @xmath225 t",
    ", the system is approximately probed in the middle of the plateau phase ( c.f .",
    "[ fig : azurite_plateau ] ) . at this point ,",
    "the band gap reaches a maximum , @xmath226  mev , as the monomer branch has already moved to rather high energies while the dimer band is about to cross it , as illustrated in fig .",
    "[ fig : dssf_az](b ) .",
    "based on this discussion , we can confirm the very distinct effects of temperature on the different points at the @xmath3 plateau and put the arguments given in sec .",
    "[ sec : plateau_az ] on solid ground . for regions of the plateau where the magnetization decreases at finite temperature , thermal fluctuations",
    "primarily excite the monomers as this is energetically favorable . on the other hand , the thermal increase of the magnetization for larger magnetic fields observed in fig .",
    "[ fig : azurite_plateau](b ) can be understood in terms of the lowering of the dimer excitation energy due to the additional rewards in zeemann energy , which has the opposite effect on the monomer band .",
    "[ fig : dssf_az](d - i ) displays the evolution of the spin excitations at finite temperature .",
    "the thermal broadening effects are strongly visible at @xmath218 and @xmath227 t , where the low energy bands are strongly smeared out even at intermediate temperatures .",
    "this is expected from the comparatively small band - gap at @xmath202 and fig .",
    "[ fig : azurite_plateau](b ) , which shows strong effects of temperature on the magnetization in this regime .",
    "in contrast , thermal fluctuations have a much weaker effect at @xmath225  t , where the band gap is maximal .",
    "indeed , comparing figs .",
    "[ fig : dssf_az](b ) and [ fig : dssf_az](e ) , we see almost no difference in the distribution of the spectral weight . only fig .",
    "[ fig : dssf_az](h ) shows some thermal broadening , yet no new features arise in the spectrum .",
    "again , this is in good agreement with the robustness of the magnetization for finite temperature in the middle of the plateau , as illustrated in fig .  [",
    "fig : dssf_az](b ) .",
    "these features become even more prominent when studying cross sections of fig .",
    "[ fig : dssf_az ] , i.e. , the spin excitations for a specific momentum value .",
    "these are displayed in fig .",
    "[ fig : dssf_az_cross ] for @xmath228 .",
    "again , we observe that the large peaks indicating the monomer and dimer branches are already washed out at intermediate temperatures at the edges of the plateau phase [ fig .  [",
    "fig : dssf_az_cross](a ) and [ fig : dssf_az_cross](c ) ] .",
    "in both cases , thermal fluctuations strongly redistribute spectral weight in - between the two excitation peaks .",
    "in contrast , the height of the combined monomer and dimer excitation peaks in the middle of the plateau phase is significantly reduced only at high temperatures [ fig .  [",
    "fig : dssf_az_cross](b ) ] .",
    "to conclude , our finite - temperature study of the spectra of the generalized diamond chain model for azurite fits in nicely with previous work@xcite and provides new insight in the plateau phase .",
    "we observe a crossing of the monomer and dimer branches with increasing magnetic field , which can very intuitively explain the effects of finite temperature on the plateau phase .",
    "testing these features in neutron scattering experiments would provide additional information on the validity of the microscopic model for azurite . such a study would be particularly enlightening in the context of the results provided by ref .",
    "[ ] , which showed discrepancies of using an isotropic spin model to describe azurite in the regime of @xmath205 , i.e. , for fields below the plateau phase .",
    "in this work , we have introduced an intuitive and easily implemented extension of the minimally entangled typical thermal state approach of ref .",
    "[ ] , which allowed us to generate a metts sample of symmetry eigenstates .",
    "we explicitly showed how to construct such a symetts ensemble exploiting both the abelian u@xmath97 and non - abelian su@xmath45 symmetry of spin-@xmath5 heisenberg chains , without introducing strong autocorrelation effects in between the ensemble states .    whereas symetts does not improve the numerical efficiency when calculating static observables as compared to metts , the benefits of using symmetries come fully to the fore when calculating more complex dynamic quantities such as response functions . here",
    ", most computational effort has to be put into the real - time evolution of each state in the sample and the gains of explicitly exploiting symmetries in the mps simulations is enormous .",
    "we checked the validity of our approach for the dynamic spin structure factors of the xx and xxx heisenberg chains and found that symetts in principle is able to reach longer time scales than purification at low temperatures .",
    "moreover , we applied symetts to study the finite - temperature excitation spectra of a generalized diamond chain model for the natural mineral azurite @xmath4 .",
    "focusing on the plateau phase of the system , we found very distinct effects of temperature on the different points at the @xmath3 plateau , which are caused by the zeeman term shifting the dimer and monomer branches in opposite directions .",
    "our results fit in nicely with previous work@xcite and provide new insight in the plateau phase .",
    "interesting questions for future work involve the treatment of fermionic systems , where the symmetric ensemble states could be formulated in terms of a combination of @xmath229 and @xmath230 symmetries or their abelian counterparts .",
    "for example , symetts could be employed to study finite - temperature density profiles in interacting quantum - point contacts.@xcite in this context , it would be particularly interesting to further explore the possibility of combining a real - time evolution to an mpo with local support in the heisenberg picture , as briefly described at the end of sec .  [",
    "sec : dyn ] . in principle",
    ", this would simplify combining metts with the concept of time - translational invariance@xcite to double the maximum reachable time scale and could be a generally more efficient approach for finite - temperature response functions at low temperatures .    finally we note as an outlook that the symetts algorithm may also be entirely based within symmetry eigenstates , in that the non - symmetric sampling as described in this paper is fully replaced by metropolis sampling . based on the weights @xmath231 above , necessarily , this must also include a proposal distribution to switch to neighboring symmetry sectors . to minimize rejection probability , this random walk towards neighboring symmetry sectors can be chosen temperature dependent . by definition ,",
    "the metropolis sampling also guarantees detailed balance . and",
    ", by rejecting certain higher - energy states , this may lead to reduced spread and hence enhanced convergence of computed observables . in this formulation",
    ", symetts would also provide benefits for the calculation of static properties and might allow the finite - temperature treatment of 2d clusters .",
    "we thank f.  schwarz and m.  stoudenmire for insightful discussions .",
    "this research was supported by the deutsche forschungsgemeinschaft through the excellence cluster `` nanosystems initiative munich '' , sfb / tr  12 , sfb  631 and we4819/1 - 1 , we4819/2 - 1 ( aw ) .",
    "bb also acknowledges financial support from the bacatec grant 15 [ 2014 - 2 ] .",
    "chebyshev expansion techniques have been successfully established as an alternative approach for the computation of spectral functions in the context of kernel polynomial methods.@xcite more recently , ref .",
    "[ ] introduced the chebyshev expansion in the mps formalism ( chemps ) to determine spectral properties at zero temperature .",
    "based on this work , chemps has been applied to determine signatures of the majorana fermion in the interacting kitaev model,@xcite in the context of the interacting resonating level model,@xcite and as impurity solver for single- and two - band dmft calculations in combination with linear prediction.@xcite in addition , chemps has been expanded towards finite - temperature calculations using a liouvillian in a matrix - product purification framework.@xcite    the question as to whether chemps is the most efficient method for computing spectral functions using mps methods can not be generally considered settled , as there is no one - to - one correspondence of chemps in its most efficient setup to real - time evolution . nevertheless , the claim of ref .",
    "[ ] that chemps is significantly less expensive than tdmrg to obtain the same spectral information can no longer be supported.@xcite we have not conducted a systematic comparison of both approaches , but in our experience chemps and tdmrg require similar computational effort when aiming for the same spectral resolution and employing an equal truncation criterion at zero temperature .",
    "chemps , though , offers a significant advantage over tdmrg as it allows better control over the broadening procedure of the spectral data.@xcite    in this context , it is worthwhile to explore the compatibility of symetts and chemps . to this end , we start with the fourier transform of the response function in eq .",
    "( [ eq : response ] ) @xmath232 to compute the response function in this form , we follow ref .  [ ] and expand both @xmath233-functions in terms of orthogonal chebyshev polynomials of the first kind @xmath234 and @xmath235 before integrating over the frequency index @xmath236 for every symetts @xmath143 in our sample .",
    "this `` double '' chebyshev expansion involves chebyshev moments of the type @xmath237 , where @xmath238 represents the hamiltonian with a rescaled spectrum @xmath239 $ ] to ensure the convergence of the chebyshev recursion .",
    "this is usually achieved by using a linear rescaling with the parameters @xmath240 @xmath241    , @xmath242 , @xmath243 , @xmath244 and @xmath162 .",
    "for all considered inverse temperatures , we find excellent agreement with the exact result .",
    "however , note that the required numerical resources clearly exceed those used in fig .",
    "[ fig : hb_xx_dssf_tdmrg ] , where tdmrg was employed for a system with twice as many spins ! ]    the moments @xmath245 are determined by calculating a first set of chebyshev vectors up to the desired expansion order @xmath246 via the recursion relation @xmath247 and keeping it in storage .",
    "then , we iteratively obtain a second set of vectors @xmath248 using a different starting vector @xmath249 . for each @xmath248 , we compute the overlap @xmath250 for @xmath251 .    the sample average of the chebyshev moments is then used to compute the finite - temperature response function in frequency space .    to this end",
    ", we work with a finite broadening @xmath252 instead of the usual kernel approach for @xmath253 to remove the artificial `` gibbs '' oscillations caused by finite expansion order from the spectral data.@xcite note that the broadening has to be performed for the @xmath233-function containing the external frequency index only as @xmath254 is integrated out to obtain the final result . the finite - temperature response function in eq .",
    "( [ eq : metts_che ] ) then takes the form @xmath255 with @xmath256 and @xmath257 given by@xcite @xmath258 in principle , this approach represents an alternative to the combination of tdmrg plus fourier transform , which we have applied in the main part of this work .",
    "we illustrate this in fig .",
    "[ fig : hb_xx_dssf_chemetts ] , where we used u(1)-symetts and a double chebyshev expansion to compute the dynamic spin structure factor of the xx model showing excellent agreement with exact calculations ( dashed lines )",
    ". however , the chebyshev approach in the metts formalism involves significantly higher computational costs than the real - time evolution , since , in contrast to @xmath202 chemps , ( i ) the full set of chebyhsev vectors @xmath259 has to be stored throughout the entire calculation , and ( ii ) the number of moments increases from @xmath246 to @xmath260 , also squaring the number of mps overlaps to be calculated .",
    "therefore , we conclude that the combination of chemps and metts is not a competitive alternative to real - time evolution for calculating spectra at finite temperature , since the advantage of the more controlled broadening procedure does not outweigh the drastically enhanced numerical costs involved in the double chebyshev expansion . +",
    "here we assess the numerical performance of symetts and the existing metts approach on an explicit example .",
    "we focus on the average cumulative cpu time @xmath261 required to carry out the real - time evolution of one ensemble state up to @xmath262 when determining the dynamic spin structure factor @xmath263 of azurite in eq .",
    "( [ eq : dssf_az ] ) . for simplicity ,",
    "we choose the same model parameters as in fig .  [",
    "fig : dssf_az_cross](a ) , namely @xmath199 , @xmath218 t , and @xmath264 , and in figs .",
    "[ fig : tcpu](a , b ) display the resulting average cumulative cpu times for the two temperatures @xmath265 k. using the tdmrg setup described in sec .",
    "[ sec : az_dssf ] , each calculation was performed on a single core xeon e5 - 2670v2 ( 2.50 ghz ) machine with 4 gb memory .     as a function of @xmath266 , when carrying out the real - time evolution to determine the dynamic spin structure factor @xmath263 of azurite in eq .",
    "( [ eq : dssf_az ] ) using the parameters @xmath199 , @xmath218 t , and @xmath264 .",
    "( c , d ) show the average computation time of a _ single _ time step @xmath267 as a function of @xmath175 .",
    "we note that the ensemble states have a @xmath268 at both temperatures after the initial imaginary - time evolution .",
    "the dashed lines in fig .",
    "[ fig : tcpu](d ) are guide to the eye illustrating the @xmath269 scaling of the cpu time for larger bond dimensions .",
    "the employed tdmrg setup is described in sec .",
    "[ sec : az_dssf ] . ]",
    "the explicit implementation of the u(1 ) symmetry in the symetts ensemble states clearly enhances the numerical efficiency , resulting in an average reduction of cpu time by a factor of 4 for @xmath270 k in comparison to a non - symmetric metts sample [ c.f .",
    "[ fig : tcpu](a ) ] .",
    "the efficiency gain increases to a factor of almost 10 for @xmath271 k in fig .",
    "[ fig : tcpu](b ) , since states with a larger bond dimension profit even more from the exploitation of the spin symmetry .",
    "this is illustrated in fig .",
    "[ fig : tcpu](c , d ) , where we show the average computation time of a _ single _ time step @xmath267 as a function of the average maximum bond dimension @xmath175 .",
    "the additional imaginary - time evolution necessary for the generation of the symetts requires on average only 25 and 12 seconds for @xmath265 k , respectively .",
    "thus , the overhead costs of the generating the symetts sample are clearly negligible compared to the total computation time .",
    "in addition to benefits in terms of memory requirement , symetts enables us to reduce the cpu time necessary to compute the dynamic spin structure factor for various momenta and magnetic fields presented in fig .",
    "[ fig : dssf_az ] from @xmath272 to @xmath273 hours .",
    "consequently , when running @xmath274 cpus in parallel , symetts generates this data in roughly one week , whereas the same calculation would require almost three months in the original metts formulation .",
    "note that the factor of 10 gained in numerical efficiency by implementing the u(1 ) spin symmetry in simple spin - chain models has also been reported in ref .",
    "[ ] and [ ] in the context of itebd and tdmrg , respectively .",
    "even larger benefits can be achieved when studying models with multiple abelian or non - abelian symmetries .",
    "66ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]",
    " + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty link:\\doibase    10.1103/physrevlett.93.087202 [ * * ,   ( ) ] @noop ( ) link:\\doibase 10.1038/nmat1327 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.100.117202 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevb.84.184419 [ * * ,   ( ) ] link:\\doibase 10.1063/1.4752094 [ * * , ( ) ] link:\\doibase 10.1016/0378 - 4363(75)90101 - 1 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.28.3873 [ * * , ( ) ] link:\\doibase 10.1103/physrevb.79.214408 [ * * ,   ( ) ] http://books.google.de/books?id=ih_e05n5tzqc[__ ]  ( ,  ) link:\\doibase 10.1103/physrevlett.69.2863 [ * * ,   ( ) ] link:\\doibase 10.1016/j.aop.2010.09.012 [ * * ,   ( ) ] link:\\doibase 10.1143/ptp.58.1377 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.26.5033 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.43.5950 [ * * ,   ( ) ] link:\\doibase 10.1143/jpsj.64.3598 [ * * ,   ( ) ] http://stacks.iop.org/0953-8984/8/i=40/a=003 [ * * ,   ( ) ] link:\\doibase 10.1143/jpsj.66.2221 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.56.5061 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.93.207204 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.93.076401 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.77.134437 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.79.245101 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.108.227206 [ * * ,   ( ) ] @noop   link:\\doibase    10.1103/physrevlett.111.137205 [ * * ,   ( ) ] http://stacks.iop.org/1367-2630/15/i=7/a=073010 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.90.060406 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.83.195115 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.102.190601 [ * * ,   ( ) ] http://stacks.iop.org/1367-2630/12/i=5/a=055026 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.87.245130 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.113.187203 [ * * , ( ) ] @noop   http://stacks.iop.org/0295-5075/57/i=6/a=852 [ * * ,   ( ) ] link:\\doibase 10.1016/j.aop.2012.07.009 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.86.195114 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.88.115147 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevlett.106.217201 [ * * ,   ( ) ] http://stacks.iop.org/0953-8984/23/i=16/a=164211 [ * * ,   ( ) ] \\doibase    http://dx.doi.org/10.1016/s0921-4526(02)02034-3 [ * * , ( ) ] link:\\doibase 10.1103/physrevlett.94.227201 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.97.089701 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.75.174437 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.77.054405 [ * * ,   ( ) ] http://stacks.iop.org/0953-8984/21/i=39/a=392201 [ * * ,   ( ) ] http://dx.doi.org/10.1140/epjb/e2012-30289-5 [ * * , ( ) ] link:\\doibase 10.1103/physrevb.89.174427 [ * * ,   ( ) ] \\doibase http://dx.doi.org/10.1016/j.jmmm.2014.11.082 [ * * ,   ( ) ] @noop   link:\\doibase 10.1103/physrevb.52.4319 [ * * ,   ( ) ] \\doibase    10.1002/(sici)1521 - 3951(199807)208:1<221::aid - pssb221>3.3.co;2 - 5 [ * * ,   ( ) ] http://stacks.iop.org/1367-2630/15/i=8/a=083031 [ * * ,   ( ) ] link:\\doibase 10.1088/1367 - 2630/16/7/073007 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.97.089702 [ * * ,   ( ) ] link:\\doibase 10.1143/jpsj.72.2464 [ * * ,   ( ) ] link:\\doibase 10.1524/zkri.1972.135.5 - 6.416 [ * * ,   ( ) ] http://dx.doi.org/10.1038/nature12421 [ * * ,   ( ) ] link:\\doibase 10.1103/revmodphys.78.275 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.88.161103 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.90.165112 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevb.90.045144 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.90.115124 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.91.115144 [ * * ,   ( ) ]"
  ],
  "abstract_text": [
    "<S> we extend white s minimally entangled typically thermal states approach ( metts ) to allow abelian and non - ablian symmetries to be exploited when computing finite - temperature response functions in one - dimensional ( 1d ) quantum systems . </S>",
    "<S> our approach , called symetts , starts from a metts sample of states that are not symmetry eigenstates , and generates from each a symmetry eigenstate . </S>",
    "<S> these symmetry states are then used to calculate dynamic response functions . </S>",
    "<S> symetts is ideally suited to determine the low - temperature spectra of 1d quantum systems with high resolution . </S>",
    "<S> we employ this method to study a generalized diamond chain model for the natural mineral azurite cu@xmath0(co@xmath1(oh@xmath2 , which features a plateau at @xmath3 in the magnetization curve at low temperatures . </S>",
    "<S> our calculations provide new insight into the effects of temperature on magnetization and excitation spectra in the plateau phase , which can be fully understood in terms of the microscopic model . </S>"
  ]
}