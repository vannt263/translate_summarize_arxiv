{
  "article_text": [
    "density functional theory ( dft ) with the single - particle kohn - sham ( ks ) scheme is presently the most widely used method for electronic structure calculations in both solid state physics and quantum chemistry.@xcite its success is mainly due to a unique balance between accuracy and efficiency which makes it possible to handle systems containing hundreds of atoms on a single cpu with almost chemical accuracy .    at the fundamental level",
    "the only approximation of dft is the exchange - correlation functional which contains the non - trivial parts of the kinetic and electron - electron interaction energies .",
    "however , given an exchange - correlation functional one is still left with the non - trivial numerical task of solving the kohn - sham equations .",
    "the main challenge comes from the very rapid oscillations of the valence electrons in the vicinity of the atom cores that makes it very costly to represent this part of the wavefunctions numerically . in most modern dft codes",
    "the problem is circumvented by the use of pseudopotentials.@xcite the pseudopotential approximation is in principle uncontrolled and is in general subject to transferability errors .",
    "an alternative method is the projector augmented wave ( paw ) method invented by blchl@xcite .",
    "an appealing feature of the paw method is that it becomes exact if sufficiently many projector functions are used . in another limit",
    "the paw method becomes equivalent to the ultra - soft pseudopotentials introduced by vanderbilt@xcite .",
    "the representation of the kohn - sham wavefunctions is a central aspect of the numerics of dft .",
    "high accuracy is achieved by using system independent basis sets such as plane waves@xcite , wavelets@xcite or real - space grids@xcite , which can be systematically expanded to achieve convergence .",
    "less accurate but computationally more manageable methods expand the wavefunction in terms of a system - dependent localized basis consisting of e.g. gaussians@xcite or numerical atomic orbitals@xcite .",
    "such basis sets can not be systematically enlarged in a simple way , and consequently any calculated quantity will be subject to basis set errors . for this reason",
    "the former methods are often used to obtain binding energies where accuracy is crucial , while the latter are useful for structural properties which are typically less sensitive to the quality of the wavefunctions .    in this paper",
    "we discuss the implementation of a localized atomic basis set in the paw formalism and present results for molecular atomization energies , bulk properties , and structural relaxations .",
    "the localized basis set , which we shall refer to as the lcao basis , is similar to that of the well - known siesta pseudopotential code@xcite , but here it is implemented in our recently developed multigrid paw code gpaw@xcite .",
    "a unique feature of the resulting scheme is the possibility of using two different but complementary basis sets : on the one hand wavefunctions can be represented on a real - space grid which in principle facilitates an exact representation , and on the other hand the wavefunctions can be represented in the efficient lcao basis .",
    "this allows the user to switch seamlessly between the two representations at any point of a calculation . as a particularly powerful application of this `` double - basis '' feature ,",
    "we demonstrate how accurate structural relaxations can be performed by first relaxing with the atomic basis set and then switching to the grid for the last part . also adsorption energies , which are typically not very good in lcao , can be obtained on the grid at the end of a relaxation .        while lcao pseudopotential codes as well as plane - wave / grid paw codes already exist and",
    "have been discussed extensively in the literature,@xcite the combination of lcao and paw is new . compared to the popular siesta method , which is based on norm - conserving pseudopotentials , the advantage of the present scheme ( apart from the `` double basis '' feature ) is that paw works with coarser grids to represent the density and effective potentials . as an example , fig .",
    "[ hghpawcomparison ] shows the atomic orbitals of iron calculated with the norm - conserving hartwigsen - goedecker - hutter ( hgh ) pseudopotentials@xcite as well as with paw .",
    "clearly the @xmath0 wavefunction is much smoother in paw .",
    "this is essential for larger systems where operations on the grid , i.e.  solving the poisson equation , evaluating the density , and calculating the potential matrix elements , become computationally demanding .",
    "in this section we give a brief review of the paw formalism . for simplicity",
    "we restrict the equations to the case of spin - paired , finite systems , but the generalizations to magnetic and periodic systems are straightforward . for a more comprehensive presentation",
    "we refer to ref .  .",
    "the paw method is based on a linear transformation @xmath1 which maps some computationally convenient `` pseudo '' or `` smooth '' wavefunctions @xmath2 to the physically relevant `` all - electron '' wavefunctions @xmath3 : @xmath4 where @xmath5 is a quantum state label , consisting of a band index and possibly a spin and @xmath6-vector index .",
    "the transformation is chosen as @xmath7 , i.e.the identity operator plus an additive contribution centered around each atom , which differs based on the species of atom .    the atomic contribution for atom @xmath8",
    "is determined by choosing a set of smooth functions @xmath9 , called pseudo partial waves , and requiring the transformation to map those onto the atomic valence orbitals @xmath10 of that atom , called all - electron partial waves .",
    "this effectively allows the all - electron behaviour to be incorporated by the smooth pseudo wave functions . since the all - electron wave functions are smooth sufficiently far from the atoms , we may require the pseudo partial waves to match the all - electron ones outside a certain cutoff radius , such that @xmath11 for @xmath12",
    "this localizes the atomic contribution @xmath13 to the _ augmentation sphere _ @xmath14 .",
    "finally a set of localized _ projectors _",
    "@xmath15 is chosen as a dual basis to the pseudo partial waves .",
    "we further want the partial wave - projector basis to be complete within the augmentation sphere , in the sense that any pseudo wave function should be expressible in terms of pseudo partial waves , and therefore require @xmath16 the transformation @xmath1 is then defined by @xmath17 which allows the all - electron kohn - sham wavefunction @xmath18 to be recovered from a pseudo wave function through @xmath19 we emphasize that the all - electron wave functions are never evaluated explicitly , but all - electron values of observables are calculated through manipulations which rely only on coarse grids or one - dimensional radial grids . using using eqs . and",
    ", the all - electron expectation value for any semi - local operator @xmath20 due to the valence states can be written @xmath21 inside the augmentation spheres the partial wave expansion is ideally complete , so the first and third terms will cancel and leave only the all - electron contribution . outside",
    "the augmentation spheres the pseudo partial waves are identical to the all - electron ones , so the two atomic terms cancel .",
    "the atomic matrix elements of @xmath20 in the second and third terms can be pre - evaluated for the isolated atom on high - resolution radial grids , so operations on smooth quantities , like @xmath22 and @xmath23 , are the only ones performed during actual calculations .",
    "it is convenient to define the _ atomic density matrices _",
    "@xmath24 since these completely describe the dependence of the atomic terms in eq .   on the pseudo wave functions .",
    "the expectation value can then be written @xmath25 although the paw method is an exact implementation of density functional theory , some approximations are needed for realistic calculations .",
    "the frozen - core approximation assumes that the core states are localized within the augmentation spheres and that they are not modified by the chemical environment and hence taken from atomic reference calculations .",
    "the non - completeness of the basis , or equivalently the finite grid - spacing , will introduce an error in the evaluation of the ps contribution @xmath26 in .",
    "finally , the number of partial waves and projector functions is obviously finite .",
    "this means that the completeness conditions of eq .",
    "we have required are not strictly fulfilled .",
    "this approximation can be controlled directly by increasing the number of partial waves and projectors .",
    "the electron density @xmath27 is the expectation value of the real - space projection operator and , by eq .",
    ", takes the form @xmath28,\\end{aligned}\\ ] ] where @xmath29 here we have separated out the all - electron core density @xmath30 and the pseudo core density @xmath31 , where the latter can be chosen as any smooth continuation of @xmath30 inside the augmentation spheres , since it will cancel out in eq .  .",
    "we omit conjugation of the partial waves since these can be chosen as real functions without loss of generality .      in order to avoid dealing with the cumbersome nuclear point charges , and to compensate for the lack of norm - conservation , we introduce smooth localized _ compensation charges _",
    "@xmath32 on each atom , which are added to @xmath33 and @xmath34 , thus keeping the total charge neutral .",
    "this yields a total charge density that can be expressed as @xmath35,\\end{aligned}\\ ] ] in terms of the neutral charge densities @xmath36 where @xmath37 is the central nuclear point charge .",
    "the compensation charges are chosen to be localized functions around each atom of the form @xmath38 where @xmath39 are fixed gaussians , and @xmath40 are spherical harmonics .",
    "we use @xmath41 as a composite index for angular and magnetic quantum numbers .",
    "the expansion coefficients @xmath42 are determined in terms of @xmath43 by requiring the compensation charges to cancel all the multipole moments of each augmentation region up to some order , generally @xmath44 .",
    "the charges will therefore dynamically adapt to the surroundings of the atom . for more details",
    "we refer to the original work by blchl@xcite .",
    "the total energy can also be separated into smooth and atom - centered contributions @xmath45 where @xmath46 , \\label{etilde}\\\\    e^a & = \\sum_{ij } d_{ji}^a { \\langle \\phi^{a}_i|-\\tfrac{1}{2 }      \\nabla^2|\\phi^{a}_j \\rangle } + t_{{\\mathrm}{core}}^a    { \\nonumber}\\\\      & + \\frac12 \\iint \\frac{\\rho^a({\\bm{\\mathrm{r } } } ) \\rho^a({\\bm{\\mathrm{r}}}')}{|{\\bm{\\mathrm{r } } } - { \\bm{\\mathrm{r}}}'| }    { \\ , { \\mathrm d { \\bm{\\mathrm{r}}}}}{\\ , { \\mathrm d { \\bm{\\mathrm{r } } } } } ' + e_{xc}[n^a ] , \\\\    { \\tilde}e^a & = \\sum_{ij } d_{ji}^a { \\langle { \\tilde}\\phi^a_i|-\\tfrac{1}{2 }      \\nabla^2|{\\tilde}\\phi^a_j \\rangle }     + { \\tilde}t_{{\\mathrm}{core}}^a + \\int { \\tilde}n^a({\\bm{\\mathrm{r } } } ) \\bar v^a(r ) { \\ , { \\mathrm d { \\bm{\\mathrm{r}}}}}{\\nonumber}\\\\    & + \\frac12 \\iint \\frac{{\\tilde}\\rho^a(\\mathbf{r } )      { \\tilde}\\rho^a(\\mathbf{r'})}{|\\mathbf{r } - \\mathbf{r'}| } { \\ , { \\mathrm d { \\bm{\\mathrm{r}}}}}{\\ , { \\mathrm d { \\bm{\\mathrm{r } } } } } '    + e_{xc}[{\\tilde}n^a].\\end{aligned}\\ ] ] the terms @xmath47 and @xmath48 are the kinetic energy contributions from the frozen core states , while @xmath49 is an arbitrary potential , vanishing for @xmath50 .",
    "this potential is generally chosen to make the atomic potential smooth , while its contribution to the total energy vanishes if the partial wave expansion is complete.@xcite    @xmath51 is the exchange - correlation functional , which must be local or semilocal as per eq .   for the above expressions to be correct .",
    "while the functional is non - linear , it remains true that @xmath52    = e_{{\\mathrm}{xc}}[{\\tilde}n ]     + \\sum_a\\left (      e_{{\\mathrm}{xc}}[n^a ]   - e_{{\\mathrm}{xc}}[{\\tilde}n^a ]      \\right),\\end{aligned}\\ ] ] because of the functional s semilocality : the energy contribution from @xmath33 around every point inside the augmentation sphere is exactly cancelled by that of @xmath34 , since @xmath33 and @xmath34 are exactly identical here , leaving only the contribution @xmath53 $ ] . outside the augmentation region",
    ", a similar argument applies to @xmath54 and @xmath33 , leaving only the energy contribution from @xmath33 which is here equal to the all - electron density .      in generic operator form , the hamiltonian corresponding to the total energy from eq .",
    "is @xmath55 where @xmath56 + \\bar v + v_{{\\mathrm}{xc}}[{\\tilde}n]$ ] is the local effective potential , containing the hartree , the arbitrary localized and the xc potentials , and where @xmath57 are the _ atomic hamiltonians _ containing the atom - centered contributions from the augmentation spheres .",
    "since the all - electron wave functions @xmath58 must be orthonormal , the pseudo wave functions @xmath26 must obey @xmath59 where we have defined the _ overlap operator _ @xmath60 the atomic contributions @xmath61 are constant for a given element .    given the hamiltonian and orthogonality condition , a variational problem can be derived for the pseudo wave functions .",
    "this problem is equivalent to the generalized kohn - sham eigenvalue problem @xmath62 which can then be solved self - consistently with available techniques .",
    "we now introduce a set of basis functions @xmath63 which are fixed , strictly localized atomic orbital - like functions represented numerically , following the approach by sankey and niklewski@xcite .",
    "we furthermore consider the pseudo wave functions @xmath2 to be linear combinations of the new basis functions @xmath64 where the coefficients @xmath65 are variational parameters .",
    "it proves useful to define the density matrix @xmath66 the pseudo density can be evaluated from the density matrix through @xmath67 ahead of a calculation , we evaluate the matrices @xmath68 which are used to evaluate most of the quantities of the previous sections in matrix form .",
    "the atomic density matrices from eq .",
    "become @xmath69 and the kinetic energy contribution in the first term of eq .",
    "is @xmath70 we can then define the hamiltonian matrix elements by taking the derivative of the total energy @xmath71 with respect to the density matrix elements , which eventually results in the discretized hamiltonian @xmath72 where @xmath73 the overlap operator of eq .",
    "has the matrix representation @xmath74 so orthogonality of the wave functions is now expressed by @xmath75 this is incorporated by defining a quantity @xmath76 to be variationally minimized with respect to the coefficients , specifically @xmath77 setting the derivative of @xmath76 with respect to @xmath65 equal to 0 , one obtains the generalized eigenvalue equation @xmath78 which can be solved for the coefficients @xmath65 and energies @xmath79 when the hamiltonian @xmath80 and the overlap matrix @xmath81 are known .",
    "the basis functions @xmath63 in eq",
    ".   are atom - centered orbitals written as products of numerical radial functions and spherical harmonics : @xmath82 in order to make the hamiltonian and overlap matrices sparse in the basis - set representation , we use strictly localized radial functions , i.e.  orbitals that are identically zero beyond a given radius , as proposed by sankey and niklewski @xcite and successfully implemented in the siesta method @xcite .",
    "the first ( single - zeta ) basis orbitals @xmath83 are obtained for each valence state by solving the radial all - electron kohn - sham equations for the isolated atom in the presence of a confining potential with a certain cutoff .",
    "if the confining potential is chosen to be smooth , the basis functions similarly become smooth .",
    "we use the same confining potential as proposed in ref .. the smooth basis functions are then obtained using @xmath84 .",
    "the result of the procedure is illustrated in fig .",
    "[ fig : basisgeneration ] .    the cutoff radius is selected in a systematic way by specifying the energy shift @xmath85 of the confined orbital compared to the free - atom orbital . in this approach small values of @xmath85 will correspond to long - ranged basis orbitals@xcite .        to improve the radial flexibility , extra basis functions with the same angular momentum",
    "@xmath86 ( multiple - zeta ) are constructed for each valence state using the split - valence technique@xcite .",
    "the extra function is constructed by matching a polynomial to the tail of the atomic orbital , where the matching radius is determined by requiring the norm of the part of the atomic orbital outside that radius to have a certain value .",
    "finally , polarization functions ( basis functions with @xmath86 quantum number corresponding to the lowest unoccupied angular momentum ) can be added in order to improve the angular flexibility of the basis .",
    "there are several approaches to generate these orbitals , such as perturbing the occupied eigenstate with the highest @xmath86 quantum number with an electric field using first order perturbation theory ( like in ref . ) or using the appropriate unoccupied orbitals . as a first implementation we use a gaussian - like function of the form @xmath87 for the radial part , where @xmath86 corresponds to the lowest unoccupied angular momentum .",
    "this produces reasonable polarization functions as demonstrated by the results presented in a following section .",
    "a generator program is included in the gpaw code and it can produce basis sets for virtually any elements in the periodic table . through our experiences with generating and using different basis sets , we have reached the following set of default parameters : we usually work with a dzp basis . the energy shift for the atomic orbital is taken as 0.1 ev , and the tail - norm is 0.16 ( in agreement with siesta@xcite ) .",
    "the width of the gaussian used for the polarization function is 1/4 of the cut - off radius of the first zeta basis function .",
    "further information can be found in the documentation for the basis set generator . at this point",
    "we have not yet systematically optimized the basis set parameters , although we expect to do so by means of an automatic procedure .",
    "the force on some atom @xmath8 is defined as the negative derivative of the total energy of the system with respect to the position of that atom , @xmath88 the derivative is to be taken with the constraints that selfconsistency and orthonormality according to must be obeyed .",
    "this implies that the calculated force will correspond to the small - displacement limit of the finite - difference energy gradient one would obtain by performing two separate energy calculations , where atom @xmath8 is slightly displaced in one of them .",
    "the expression for the force is obtained by using the chain rule on the total energy of eq .  .",
    "the primary complication compared to the grid - based paw force formula , eq .",
    "( 50 ) from ref .  , is that the basis functions move with the atoms , introducing extra terms in the derivative .",
    "the complete formula for the force on atom @xmath8 is @xmath89 \\rho_{\\nu\\mu }    { \\nonumber}\\\\ \\quad &    -\\int { \\tilde}v({\\bm{\\mathrm{r } } } ) { \\frac{{\\mathrm d}{\\tilde}n_c^a(|{\\bm{\\mathrm{r } } } - { \\bm{\\mathrm{r}}}^a|)}{{\\mathrm d}{\\bm{\\mathrm{r}}}^a } } { \\ , { \\mathrm d { \\bm{\\mathrm{r}}}}}-\\int { \\tilde}n({\\bm{\\mathrm{r } } } ) { \\frac{{\\mathrm d}\\bar v^a(|{\\bm{\\mathrm{r } } } - { \\bm{\\mathrm{r}}}^a|)}{{\\mathrm d}{\\bm{\\mathrm{r}}}^a } } { \\ , { \\mathrm d { \\bm{\\mathrm{r}}}}}{\\nonumber}\\\\ \\quad &    - \\int { \\tilde}v_h({\\bm{\\mathrm{r } } } ) \\sum_l q_l^a { \\frac{{\\mathrm d}{\\tilde}g_l^a({\\bm{\\mathrm{r } } } - { \\bm{\\mathrm{r}}}^a)}{{\\mathrm d}{\\bm{\\mathrm{r}}}^a } } { \\ , { \\mathrm d { \\bm{\\mathrm{r } } } } } ,    \\label{forces}\\end{aligned}\\ ] ] where @xmath90 the notation @xmath91 denotes that summation should be performed only over those basis functions that reside on atom @xmath8 .",
    "eq .   is derived in appendix [ appendixforces ] .",
    "the last three terms are basis set independent , and inherited from the grid - based implementation .",
    "the lcao code is implemented in gpaw , a real - space paw code . for the details of the real - space implementation we refer to the original paper@xcite . in this code",
    "the density , effective potential and wave functions are evaluated on real - space grids .    in lcao the matrix elements of the kinetic and overlap operators @xmath92 , @xmath93 and @xmath94 in eqs .",
    "- are efficiently calculated in fourier space based on analytical expressions@xcite . for each pair of different basis orbitals ( i.e.  independently of the atomic positions )",
    ", the overlap can be represented in the form of radial functions and spherical harmonics .",
    "these functions are stored as splines which can in turn be evaluated for a multitude of different atomic separations .",
    "the two - center integrals are thus calculated once for a given atomic configuration ahead of the self - consistency loop .",
    "this is equivalent to the siesta approach@xcite .",
    "the matrix elements of the effective potential @xmath95 are still calculated numerically on the three dimensional real - space grid , since the density is also evaluated on this grid@xcite .    because of the reduced degrees of freedom of a basis calculation compared to a grid - based calculation , the hamiltonian from eq .",
    "is directly diagonalized in the space of the basis functions according to eq .  .",
    "this considerably lowers the number of required iterations to reach selfconsistency , compared to the iterative minimization schemes used in grid - based calculations .    for each step in the selfconsistency loop ,",
    "the hartree potential @xmath96 is calculated by solving the poisson equation @xmath97 in real space using existing multigrid methods , such as the gauss - seidel and jacobi methods .",
    "a solver based on the fast fourier transform is also available in the gpaw code .",
    "the calculations are parallelized over k - points , spins and real - space domains like in the grid - based case@xcite .",
    "we further distribute the orbital - by - orbital matrices such as @xmath80 and @xmath98 , and use scalapack for operations on these , notably the diagonalization of eq .  .",
    "quantities such as the density @xmath33 and effective potential @xmath99 are still stored on 3d grids .",
    "matrix elements like @xmath95 in eq .  , and",
    "the pseudo density given by eq .  , can therefore be calculated by loops over grid points .",
    "since each basis function is nonzero only in a small part of space , we only store the values of a given function within its bounding sphere .",
    "each function value inside the bounding sphere is calculated as the product of radial and angular parts vz .",
    "eq .  , where the radial part is represented by a spline , and the spherical harmonic evaluated in cartesian form , i.e.  as a polynomial .",
    "the same method is used to evaluate derivatives in force calculations , although this involves the derivatives of these quantities aside from just their function values .",
    "we initially compile a data structure to keep track of which functions are nonzero for each grid point .",
    "when looping over the grid , we maintain a list of indices @xmath100 for the currently nonzero functions by adding or removing , as appropriate , those functions whose bounding spheres we intersect .",
    "the locations of these bounding spheres are likewise precompiled into lists for efficient processing .",
    "the memory overhead due to this method is still much smaller than the storage requirements for the actual function values .",
    "in this section we calculate common quantities using the localized basis set on different systems .",
    "the results are compared to the complete basis set limit , i.e.  a well converged grid calculation .",
    "note that this comparison can be done in a very systematic way since the calculations on the grid share the same approximations and mostly the same implementation as the calculations performed with the localized basis .",
    "all the results presented in this section have been obtained using paw setups from the extensive gpaw library , freely available online@xcite .      in order to assess the accuracy of the lcao implementation for small molecules , the pbe@xcite atomization energies for the g2 - 1 data - set@xcite are considered .",
    "the atomic coordinates are taken from mp2(full)/6 - 31g(d ) optimized geometries . the error with respect to the grid results",
    "is shown in fig .",
    "[ fig : g2data ] for different basis sets .",
    "this error is defined as @xmath101 the reference grid results are well converged calculations in very good agreement with the vasp@xcite and gaussian@xcite codes .",
    "the figure shows that enlarging the basis set , i.e.  including more orbitals per valence electron , systematically improves the results towards the grid energies .",
    "it must be noted that some differences with respect to the grid atomization energies still remain , even in the case of large basis sets .",
    "this is mainly due to the two following reasons .",
    "firstly , the basis functions are generated from spin - paired calculations and hence they do not explicitly account for possible spin - polarized orbitals .",
    "this is in practice accounted for by using larger basis - sets in order to include more degrees of freedom in the shape of the wavefunctions . secondly , isolated atoms are difficult to treat because of their long ranged orbitals .",
    "actual basis functions are , in fact , obtained from atomic calculations with an artificial confining potential thus resulting in more confined orbitals .",
    "the equilibrium bulk properties have been calculated for several crystals featuring different electronic structures : simple metals ( li , na , al ) , semiconductors ( alp , si , sic ) , ionic solids ( nacl , lif , mgo ) transition metals ( fe , cu , pt ) as well as one insulator ( c ) . the results are shown in fig .",
    "[ fig : bulk ] .",
    "for comparison with grid - based calculations , the bar plots show the deviations from grid - based results for each basis set , while the precise numbers are shown in each of the corresponding tables .",
    "all the calculations were performed with the solids in their lowest energy crystal structure , using the pbe functional for exchange and correlation@xcite .",
    "the quantities were computed using the relaxed structures obtained with the default , unoptimized basis sets .",
    "the calculations were generally spin - paired , i.e.  non - magnetic , with the exception of fe and the atomic calculations used to get cohesive energies .",
    "[ fig : subfig1 ]    [ cols= \" < , < , < , < , < , < \" , ]     the overall agreement with the real - space grid is excellent : about 0.5% mean absolute error in the computation of lattice constants , 4% in cohesive energies and 5 - 8% for bulk moduli using dzp basis sets .",
    "notice that in many cases remarkably good results can be obtained even with a small szp basis , particularly for lattice constants .",
    "this shows that structure optimizations with the lcao code are likely to yield very accurate geometries .",
    "this is probably due to the fact that calculations of equilibrium structures only involve energy differences between very similar structures , i.e. not with respect to isolated atoms , thus leading to larger error cancellations .    with dzp the primary source of error in cohesive",
    "energy comes from the free - atom calculation , where the confinement of each orbital raises the energy levels by around 0.1 ev .",
    "thus , atomic energies are systematically overestimated , leading to stronger binding .",
    "this error can be controlled by using larger basis set cutoffs , i.e.  choosing smaller orbital energy shifts during basis generation .",
    "lcao calculations tend to reproduce geometries of grid - based calculations very accurately . in structure optimizations ,",
    "the lcao code can therefore be used to provide a high - quality initial guess for a grid - based structure optimization .",
    "while it is trivial to reuse a geometry obtained in one code for a more accurate optimization in another , our approach is practical because the two representations share the exact same framework .",
    "thus the procedure is seamless as well as numerically consistent , in the sense that most of the operations are carried out using the same approximations , finite - difference stencils and so on . with quasi - newton methods ,",
    "the estimate of the hessian matrix generated during the lcao optimization can be reused as well . for most non - trivial systems , an lcao calculation is between 25 and 30 times faster than a grid calculation , making the cost of the lcao optimization negligible .",
    "[ fig : combinedrelaxation ] shows a performance comparison when reusing the positions and hessian from a lcao - based structure optimization for a grid - based one , using the default basis set .",
    "the system is a 38-atom truncated octahedral gold cluster with co adsorbed , with the initial and final geometries shown in the inset .",
    "a purely grid - based optimization takes 223 cpu hours while a purely lcao - based one , requiring roughly the same number of steps , takes 8.4 cpu hours .",
    "a further grid - based optimization takes 45 cpu hours , for a total speedup factor of 4 .",
    "the value of an initial lcao optimization is of course higher if the initial guess is worse . for systems where",
    "a large fraction of the time is spent close to the converged geometry , the speedup may not be as significant .",
    "the energy reference corresponds to the separate cluster and molecule at optimized geometries  the total energy difference between an lcao and a grid calculation is otherwise around 30 ev .",
    "it is therefore important to choose an optimization algorithm which will handle such a shift well .",
    "the present plots use the l - bfgs algorithm@xcite ( limited memory broyden - fletcher - goldfarb - shanno ) from the atomic simulation environment.@xcite",
    "we have described the implementation of a localized basis in the grid based paw code gpaw , and tested the method on a variety of molecules and solids .",
    "the results for atomization energies , cohesive energies , lattice parameters and bulk moduli were shown to converge towards the grid results as the size of the lcao basis was increased .",
    "structural properties were found to be particularly accurate with the lcao basis .",
    "it has been demonstrated how the lcao basis can be used to produce accurate initial guesses ( both for the electron wavefunctions , atomic structure , and hessian matrix ) for subsequent grid - based calculations to increase efficiency of high - accuracy grid calculations .",
    "the combination of the grid - based and lcao methods in one code provides a flexible , simple and smooth way to switch between the two representations .",
    "furthermore the paw formalism itself presents significant advantages : it is an all - electron method , which eliminates pseudopotential errors , and it allows the use of coarser grids than norm - conserving pseudopotentials , which increases efficiency .",
    "finally , the lcao method enables gpaw to perform calculations involving green s function , which intrinsically need a basis set with finite support .",
    "current developments along these lines include electron transport calculations , electron - phonon coupling and stm simulations .",
    "the authors acknowledge support from the danish center for scientific computing through grant hdw-1103 - 06 .",
    "the center for atomic - scale materials design is sponsored by the lundbeck foundation .",
    "the force on atom @xmath8 is found by taking the derivative of the total energy with respect to the atomic position @xmath102 .",
    "we shall use the chain rule on eq .",
    ", taking @xmath103 , @xmath43 , @xmath33 , @xmath104 , @xmath92 and @xmath105 to be _ separate variables _ for the purposes of partial derivatives : @xmath106 where @xmath107 . the remaining quantities in the energy expression pertain to isolated atoms , and thus do not depend on atomic positions .",
    "the first term of eq .",
    "is @xmath108 where we have used eqs .   and in the first step , and eq .",
    "in the second . when the atoms are displaced ( infinitesimally ) , the coefficients must change to accommodate the orthogonality criterion .",
    "this can be incorporated by requiring the derivatives of each side of eq .   to be equal , implying the relationship @xmath109",
    "inserting this into eq .   yields @xmath110 where we have introduced the matrix @xmath111 the equivalence of these forms follows from eq .. the overlap matrix elements @xmath98 depend on @xmath102 through the two - center integrals @xmath93 and @xmath112 .",
    "the derivative of a two - center integral can be nonzero only if exactly one of the two involved atoms is @xmath8 , and for nonzero derivatives , the sign changes if the indices are swapped . taking these issues into account , eq .",
    "is split into those three terms in eq .",
    "@xmath113 which contain @xmath114 .    in the second term in eq .",
    ", we take the @xmath115-dependent derivative for fixed @xmath116 , which by eq .",
    "evaluates to @xmath117 again most of the two - center integral derivatives are zero .",
    "a complete reduction yields the two terms in eq .   which depend on the @xmath118 vectors .",
    ", the third term of eq . is @xmath119 \\rho_{\\nu\\mu } { \\nonumber}\\\\    & \\quad + \\int { \\tilde}v({\\bm{\\mathrm{r } } } ) { \\frac{\\partial { \\tilde}n_c^a(|{\\bm{\\mathrm{r } } } - { \\bm{\\mathrm{r}}}^a|)}{\\partial { \\bm{\\mathrm{r}}}^a } } { \\ , { \\mathrm d { \\bm{\\mathrm{r}}}}}.\\end{aligned}\\ ] ] the sum over @xmath100 can be restricted to @xmath91 .",
    "consider the fourth term of eq . .",
    "aside from @xmath33 and @xmath115 , which are considered fixed as per the chain rule , the pseudo charge density @xmath104 depends only on the locations of the compensation charge expansion functions @xmath120 which move rigidly with the atom , so @xmath121 the kinetic term from eq .",
    "is @xmath122 and can also be restricted to @xmath91 . finally , the contribution from the local potential @xmath123 is simply @xmath124 by now we have considered all position - dependent variables in the energy expression , and have obtained expressions for all terms present in eq .  ."
  ],
  "abstract_text": [
    "<S> we present an implementation of localized atomic orbital basis sets in the projector augmented wave ( paw ) formalism within the density functional theory ( dft ) . </S>",
    "<S> the implementation in the real - space gpaw code provides a complementary basis set to the accurate but computationally more demanding grid representation . </S>",
    "<S> the possibility to switch seamlessly between the two representations implies that simulations employing the local basis can be fine tuned at the end of the calculation by switching to the grid , thereby combining the strength of the two representations for optimal performance . </S>",
    "<S> the implementation is tested by calculating atomization energies and equilibrium bulk properties of a variety of molecules and solids , comparing to the grid results . </S>",
    "<S> finally , it is demonstrated how a grid - quality structure optimization can be performed with significantly reduced computational effort by switching between the grid and basis representations . </S>"
  ]
}