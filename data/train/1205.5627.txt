{
  "article_text": [
    "the notion of heat kernel has a long history .",
    "the oldest and the best - known heat kernel is the gauss  weierstrass function @xmath0 where @xmath1 and @xmath2 , which is a fundamental solution of the heat equation @xmath3 where @xmath4 is the laplace operator in @xmath5 . a more general parabolic equation @xmath6 , where @xmath7 is a uniformly elliptic operator with measurable coefficients @xmath8 , has also a positive fundamental solution @xmath9 , and the latter admits the gaussian bounds@xmath10 where the sign @xmath11 means that both @xmath12 and @xmath13 are true , but the positive constants @xmath14 and @xmath15 may be different for upper and lower bounds . the estimate  ( [ gaussian ] ) was proved by aronson @xcite using the parabolic harnack inequality of moser @xcite .",
    "the next chapter in the history of heat kernels was opened in differential geometry .",
    "consider the heat equation ( [ heat ] ) on a riemannian manifold  @xmath16 , where @xmath4 is now the laplace ",
    "beltrami operator on @xmath16 .",
    "the heat kernel @xmath9 is defined as the minimal positive fundamental solution of  ( [ heat ] ) , which always exists and is a smooth nonnegative function of @xmath17 ; cf .",
    "the question of estimating the heat kernel on riemannian manifolds was addressed by many authors ( see , e.g. , @xcite ) .",
    "apart from obvious analytic and geometric motivation , a strong interest to heat kernel estimates persists in stochastic analysis because the heat kernel coincides with the transition density of brownian motion on @xmath16 generated by the laplace  beltrami operator .",
    "one of the most powerful estimates of heat kernels was proved by li and yau  @xcite : if @xmath16 is a complete riemannian manifold of nonnegative ricci curvature , then@xmath18 where @xmath19 is the geodesic distance on @xmath16 , and @xmath20 is the riemannian volume of the geodesic ball @xmath21 .",
    "similar estimates were obtained by gushchin with coauthors @xcite for certain unbounded domains in @xmath5 with the neumann boundary condition .",
    "an interesting question is what minimal geometric assumptions imply  ( [ liyau ] ) .",
    "the upper bound in ( [ liyau ] ) is know to be equivalent to a certain _ faber  krahn_-type inequality ( see section [ secef ] ) .",
    "the geometric background of the lower bound in ( [ liyau ] ) is more complicated and is closely related to the harnack inequalities .",
    "in fact , the full estimate ( [ liyau ] ) is equivalent , on one hand , to the parabolic harnack inequality of moser ( see @xcite ) , and , on the other hand , to the conjunction of the volume doubling property and the poincar inequality ( see @xcite ) . for a more detailed account of heat kernel bounds on manifolds",
    "we refer the reader to the books and surveys  @xcite .",
    "new dimensions in the history of heat kernels were literally discovered in analysis on fractals .",
    "fractals are typically subsets of @xmath5 with certain self - similarity properties , like the sierpinski gasket ( @xmath22 ) or the sierpinski carpet ( @xmath23 ) .",
    "one makes a fractal into a metric measure space by choosing appropriately a metric @xmath24 ( e.g. , the extrinsic metric from the ambient  @xmath5 ) and a  measure  @xmath25 ( usually the hausdorff measure ) .",
    "the next crucial step is introduction of a strongly local regular _ dirichlet form _ on a fractal , that is , an analogy of the dirichlet integral @xmath26 on manifolds , which is equivalent to construction of brownian motion on the fractal in question ; cf . @xcite .",
    "this step is highly nontrivial and its implementation depends on a particular class of fractals . on @xmath27",
    "brownian motion was constructed by goldstein  @xcite and kusuoka @xcite , on @xmath23 , by barlow and bass @xcite .",
    "kigami @xcite introduced a  class of _ post - critically finite _ ( p.c.f . )",
    "fractals , containing @xmath27 , and constructed the dirichlet form on such a fractal as a scaled limit of the discrete dirichlet forms on the graph approximations .",
    "a strongly local regular dirichlet form canonically leads to the notion of the heat semigroup and the heat kernel , where the latter can be defined either as the integral kernel of the heat semigroup or as the transition density of brownian motion .",
    "surprisingly enough , the dirichlet forms on many families of fractals admit continuous heat kernels that satisfy the _ sub - gaussian _ estimates@xmath28 where @xmath29 and @xmath30 are two parameters that come from the geometric properties of the underlying fractal . estimate ( [ subgauss ] ) was proved by barlow and perkins @xcite on @xmath27 , by kumagai @xcite on nested fractals , by fitzsimmons , hambly and kumagai @xcite on affine nested fractals and by barlow and bass on @xmath23 @xcite and on generalized sierpinski carpets @xcite ( see also @xcite ) .",
    "in fact , @xmath31 is the hausdorff dimension of the space , while @xmath32 is a new quantity that is called the _ walk dimension _ and that can be characterized either in terms of the exit time of brownian motion from balls or as the critical exponent of a family of besov function spaces on the fractal ( cf .",
    "@xcite).=-1      the purpose of this paper is to find convenient equivalent conditions for sub - gaussian estimates of the heat kernels on abstract metric measure spaces .",
    "let @xmath33 be a locally compact separable metric space , @xmath25  be a radon measure on @xmath16 with full support and @xmath34 be a strongly local regular dirichlet form on @xmath16 ( see section [ secbasic ] for the details ) .",
    "we are interested in the conditions that ensure the existence of the heat kernel @xmath35 as a measurable or continuous function of @xmath36 , and the estimates of the following type@xmath37 where @xmath38 and @xmath39 , @xmath40 are some nonnegative increasing functions on @xmath41 .",
    "for example , ( [ liyau ] ) has the form ( [ rfi ] ) with @xmath42 and @xmath43 , while ( [ subgauss ] ) has the form ( [ rfi ] ) with @xmath44 and @xmath45 [ assuming that means that the ratio of both sides is bounded between two positive constants . ]",
    "@xmath46 , which , in fact , follows from ( [ subgauss ] ) ] .    to describe the results of the paper ,",
    "let us introduce some hypotheses .",
    "first , we assume that the metric space @xmath33 is unbounded and that all metric balls are precompact is a complete metric spaces .",
    "the following partial converse is also true : if @xmath47 is complete and the volume doubling property ( [ vd ] ) holds , then all balls are precompact . however , since we do not always assume ( [ vd ] ) , we make an independent assumption of precompactness of the balls . ]",
    "( although these assumptions are needed only for a part of the results ) . next ,",
    "define the following conditions :    @xmath48 the volume doubling property ( [ vd ] ) : there is a constant @xmath15 such that    @xmath49    for all @xmath50 and @xmath51 ;    @xmath48 the elliptic harnack inequality ( [ h ] ) : there is a constant @xmath15 such that , for any nonnegative harmonic function @xmath52 in any ball @xmath53 ,    @xmath54    where @xmath55 and @xmath56 are the essential supremum and infimum , respectively , ( see section [ secharnack ] for more details ) ;    @xmath48 the estimate of the mean exit time ( [ ef ] ) ,    @xmath57    where @xmath58 is the first exist time from ball @xmath59 of the associated diffusion process , started at the center @xmath60 , and @xmath61 is a given function with a certain regularity ( see section [ secef ] for more details ) .",
    "a typical example is @xmath62 for some constant @xmath30 .    the conditions @xmath63 are known to be true on p.c.f",
    ". fractals ( see @xcite ) as well as on generalized sierpinski carpets ( see @xcite ) so that our results apply to such fractals .",
    "another situation where @xmath64 are satisfied is the setting of _ resistance forms _ introduced by kigami  @xcite .",
    "a resistance form is a specific dirichlet form that corresponds to a  strongly recurrent brownian motion .",
    "kigami showed that , in the setting of resistance forms on self - similar sets , ( [ vd ] ) alone implies ( [ h ] ) and ( [ ef ] ) with @xmath65 , for a suitable choice of a distance function .",
    "examples with more general functions @xmath61 appear in @xcite and @xcite .",
    "let us emphasize in this connection that our results do not depend on the recurrence or transience hypotheses and apply to both cases , which partly explains the complexity of the proofs .",
    "a transient case occurs , for example , for some generalized sierpinski carpets .",
    "another point worth mentioning is that we do not assume specific properties of the metric @xmath24 such as being geodesic ; the latter is quite a common assumption in the fractal literature .",
    "this level of generality enables applications to resistance forms where the distance function is usually the resistance metric that is not geodesic .    our first main result , which is stated in theorem [ tmain ] and which , in fact , is a combination of theorems [ tg=>fk ] , [ tdue ] , [ tholder ] , [ tnle ] , says the following : if the hypotheses @xmath66 are satisfied , then the heat kernel @xmath67 exists , is hlder continuous in @xmath36 and satisfies the following upper estimate :    @xmath68    where @xmath69 and @xmath70 and the _ near - diagonal _ lower estimate    @xmath71    where @xmath72 is a small enough constant .",
    "furthermore , assuming that ( [ vd ] ) holds a priori , we have the equivalence ] where @xmath73 stands for the _ parabolic _ harnack inequality for caloric functions .",
    "hence , we see that the `` difference '' between @xmath74 and ( [ h ] ) is the condition ( [ ef ] ) , that in particular provides a necessary space / time scaling for @xmath74 . ]",
    "@xmath75 ( theorem [ tconv ] ) .",
    "for example , if @xmath62 for some @xmath30 , then @xmath44 and @xmath76 .",
    "hence , ( [ ue ] ) and ( [ nle ] ) become as follows:@xmath77 and@xmath78 it is desirable to have a lower bound of @xmath9 for all @xmath36 that would match the upper bound ( [ subu ] ) .",
    "however , such a lower bound fails in general .",
    "the reason for that is the lack of _ chaining properties _ of the distance function , where by chaining properties we loosely mean a possibility to connect any two points @xmath79 by a chain of balls of controllable radii so that the number of balls in this chain is also under control .",
    "more precisely , this property can be stated in terms of the modified distance @xmath80 where @xmath81 is a  parameter . the exact definition of @xmath82 is given in section [ secde ] , where it is also shown that @xmath83 where @xmath84 is the smallest number of balls in a chain of balls of radii @xmath85 connecting @xmath60 and @xmath86 .",
    "as @xmath87 goes to @xmath88 , @xmath80 increases and can go to @xmath89 or even become equal to @xmath89 . if the distance function @xmath24 is geodesic then @xmath90 , which corresponds to the best possible chaining property .",
    "in general , the rate of growth of @xmath80 as @xmath91 can be regarded as a quantitative description of the chaining properties of  @xmath24 . for this part of our work",
    ", we assume that@xmath92 which allows to define a function @xmath93 from the identity@xmath94 our second main result states the following : if ( [ ad ] ) and @xmath95 are satisfied , then@xmath96 where @xmath97 ( theorem [ ttwo ] ) . for example , the above hypotheses and , hence , the estimates ( [ twoe ] ) and ( [ twohk ] ) hold on connected p.c.f .",
    "fractals endowed with resistance distance , where one has @xmath46 and @xmath98 for some constant @xmath31 . the estimate ( [ twohk ] ) on p.c.f .",
    "fractals was first proved by hambly and kumagai @xcite .",
    "in fact , we use the argument from @xcite to verify our hypotheses ( see remark [ exhk ] ) .",
    "note that the dependence on @xmath17 in the estimates ( [ twoe ] ) and ( [ twohk ] ) in very implicit and is hidden in @xmath99 .",
    "one can loosely interpret the use of this function in ( [ twoe ] ) and ( [ twohk ] ) as follows . in order to find a most probable path for brownian motion to go from @xmath60 to @xmath86 in time @xmath100 ,",
    "one determines the optimal size @xmath97 of balls and then the optimal chain of balls of radii  @xmath85 connecting @xmath60 and @xmath86 , and this chain provides an optimal route between  @xmath60 and  @xmath86 .",
    "this phenomenon was discovered by hambly and kumagai in the setting of p.c.f .",
    "fractals , where they used instead of balls the construction cells of the fractal .",
    "as it follows from our results , this phenomenon is generic and independent of self - similar structures .    if the distance function satisfies the _ chain condition _",
    "@xmath101 , which is stronger than ( [ ad ] ) , then one can replace in ( [ twoe ] ) @xmath82 by @xmath24 and obtain ( [ rfi ] ) ( corollary [ cortwo ] ) .",
    "in fact , in this case we have the equivalence @xmath102 ( corollary [ corunbound ] ) .    in the setting of random walks on infinite graphs , the equivalence ( [ 3 + 2 ] )",
    "was proved by the authors in @xcite .",
    "of course , in this case all the conditions have to be adjusted to the discrete setting .    for the sake of applications ( cf . , e.g , @xcite ) , it is desirable to replace the probabilistic condition ( [ ef ] ) in all the above results by an analytic condition , namely , by a certain estimate of the capacity between two concentric balls",
    "this type of result requires different techniques and will be treated elsewhere .      in section  [ sechh ]",
    "we revise the basic properties of the heat semigroups and heat kernels and prove the criterion for the existence of the heat kernel in terms of local ultracontractivity of the heat semigroup ( theorem [ tptom ] ) .    in section [ secaux ]",
    "we prove two preparatory results :    @xmath103 where ( [ fk ] ) stands for a certain _ faber  krahn inequality _ , which provides a lower bound for the bottom eigenvalue in any bounded open set @xmath104 via its measure ( theorem [ tg=>fk ] ) .",
    "in turn ,  ( [ fk ] ) implies the local ultracontractivity of the heat semigroup , which by theorem  [ tptom ] ensures the existence of the heat kernel .",
    "@xmath105 implies the following estimate of the tail of the exit time from balls:@xmath106 ( theorem [ tef ] ) .    in section [ secdue ]",
    "we prove the upper estimate of the heat kernel , more precisely , the implication@xmath107 ( theorem [ tdue ] ) . the main difficulty lies already in the proof of the diagonal upper bound    @xmath108    using ( [ fk ] ) , we obtain first some diagonal upper bound for the dirichlet heat kernels in balls , and then use kigami s iteration argument and ( [ psi2 ] ) to pass to ( [ due ] ) .",
    "the latter argument is borrowed from @xcite .",
    "the full upper estimate ( [ ue ] ) follows from ( [ due ] ) and ( [ psi2 ] ) .    in section [ seclow ]",
    "we prove the lower bounds of the heat kernel .",
    "the diagonal lower bound    @xmath109    follows directly from ( [ psi2 ] ) ( lemma [ lemdle ] ) . to obtain the near diagonal lower estimate ( [ nle ] ) ,",
    "one estimates from above the difference @xmath110 where @xmath86 is close to @xmath60 , which requires the following two ingredients :    the oscillation inequalities that are consequences of the elliptic harnack inequality ( [ h ] ) ( lemma [ lemosc ] and proposition [ posc ] ) ;    the upper estimate of the time derivative @xmath111 ( corollary [ cdtpt ] ) .",
    "combining them with ( [ ue ] ) , one obtains an upper bound for ( [ di ] ) , which together with ( [ dle ] ) yields ( [ nle ] ) ( theorem [ tnle ] ) .",
    "the same method gives also the hlder continuity of the heat kernel ( theorem  [ tholder ] ) .    in section [ sectwo ]",
    "we prove two - sided estimates ( [ twoe ] ) and ( [ twohk ] ) ( theorem  [ ttwo ] ) .",
    "for the upper bound , we basically repeat the proof of ( [ ue ] ) by tracing the use of the distance function @xmath24 and replacing it by @xmath82 .",
    "the lower bound for large @xmath112 is obtained from ( [ nle ] ) by a standard chaining argument using the semigroup property of the heat kernel and the chaining property of the distance function .    in section [ secconv ]",
    "we prove the converse theorem [ tconv ] , which essentially consists of the equivalence ( [ eq ] ) .",
    "we use the letters @xmath113 etc . to denote positive constant",
    "whose value is unimportant and can change at each occurrence .",
    "note that the value of such constants in the conclusions depend on the values of the constants in the hypotheses ( and , perhaps , on some other explicit parameters ) . in this sense , all our results are quantitative .",
    "the relation @xmath114 means that @xmath115 for some positive constant  @xmath15 and for a specified range of the arguments of functions @xmath116 and @xmath117 .",
    "the relation @xmath118 means that both inequalities @xmath119 and @xmath120 hold but possibly with different values of constants @xmath121 that are involved in the expressions  @xmath116 and/or @xmath117 .",
    "[ sechh ]      throughout the paper , we assume that @xmath47 is a  locally compact separable metric space , and @xmath25 is a radon measure on @xmath16 with full support . as usual , denote by @xmath122 where @xmath123 $ ] the lebesgue function space with respect measure @xmath25 , and by @xmath124 the norm in @xmath125 . the inner product in @xmath126 is denoted by @xmath127 .",
    "all functions on @xmath16 are supposed to be real valued .",
    "denote by @xmath128 the space of all continuous functions on @xmath16 with compact supports , equipped with the @xmath129-norm .",
    "let @xmath130 be dirichlet form in @xmath126 .",
    "this means that @xmath131 is a dense subspace of @xmath126 , and @xmath132 is a bilinear , nonnegative definite , closed is called closed if @xmath131 is a hilbert space with respect to the following inner product : @xmath133 ] form defined for functions @xmath134 , which satisfies , in addition , the markovian property .",
    ", then also the function @xmath135 belongs to @xmath131 and @xmath136 . ] the dirichlet form @xmath34 is called _ regular _ if @xmath137 is dense both in @xmath131 and in @xmath138 .",
    "the dirichlet form is called _ strongly local _ if @xmath139 for all functions @xmath134 such that @xmath117 has a compact support and @xmath140 in a neighborhood of @xmath141 . in this paper , we assume by default that @xmath34 is a regular , strongly local dirichlet form . a general theory of dirichlet forms can be found in @xcite .",
    "let @xmath142 be the generator of @xmath143 ; that is , @xmath142 is a self - adjoint nonnegative definite operator in @xmath126 with the domain @xmath144 that is a dense subset of @xmath131 and such that , for all @xmath145 and @xmath146@xmath147 the associated _ heat semigroup _",
    "@xmath148 is a family of bounded self - adjoint operators in @xmath149 .",
    "the markovian properties allow the extension of @xmath150 to a bounded operator in @xmath122 , with the norm @xmath151 , for any @xmath152 $ ] .",
    "denote by @xmath153 the class of all borel functions on @xmath16 , by @xmath154 the class of bounded borel functions , by @xmath155 the class of nonnegative borel functions and by @xmath156 the class of borel functions that belong to @xmath122 .",
    "by @xcite , theorem 7.2.1 , for any local dirichlet form , there exists a diffusion process @xmath157 with the initial point @xmath60 outside some properly exceptional set is called properly exceptional if it is borel , @xmath158 and@xmath159 for all @xmath160 ( see @xcite , page 134 and theorem 4.1.1 on page 137 ) . ]",
    "@xmath161 , which is associated with the heat semigroup @xmath162 as follows : for any @xmath163 , @xmath164,@xmath165 consider the family of operators @xmath166 defined by@xmath167 for all functions @xmath168 ( if @xmath169 has a finite lifetime , then @xmath116 is to be extended by @xmath88 at the cemetery ) .",
    "the function @xmath170 is a bounded borel function on @xmath171 .",
    "[ remdoweneedthisextension ? ] it is convenient to extend it to all @xmath50 by setting@xmath172 so that @xmath173 can be considered as an operator in @xmath174 . obviously , @xmath175",
    "if @xmath176 and @xmath177 . moreover , the family @xmath178 satisfies the semigroup identity @xmath179 indeed , if @xmath180 , then we have by the markov property , for any @xmath168,@xmath181 where we have used that @xmath182 with @xmath183-probability @xmath184 . if @xmath185 , then we have again@xmath186 because the both sides are @xmath88 .    by considering increasing sequences of bounded functions ,",
    "one extends the definition of @xmath187 to all @xmath188 so that the defining identities ( [ ptex ] ) and ( [ ptex0 ] ) remain valid also for @xmath189 [ allowing value @xmath190 for @xmath170 ] . for a signed function @xmath192 ,",
    "define @xmath187 by@xmath193 provided at least one of the functions @xmath194 , @xmath195 is finite .",
    "obviously , identities ( [ ptex ] ) , ( [ ptex0 ] ) are satisfied for such functions as well .",
    "if follows from the comparison of ( [ ee ] ) and ( [ ptex ] ) that , for all @xmath196 , @xmath197 it particular , @xmath187 is finite almost everywhere .",
    "the set of the above assumptions will be referred to as the _ basic hypotheses _ , and they are assumed by default in all parts of this paper . sometimes we need also the following property .    the dirichlet form @xmath130 is called _ conservative _ ( or _ stochastically complete _ ) if @xmath198 for all @xmath1 .",
    "let @xmath16 be a connected riemannian manifold , @xmath24 be the geodesic distance on @xmath16 , @xmath25 be the riemannian volume .",
    "define the sobolev space@xmath199 where @xmath200 is the riemannian gradient of @xmath116 understood in the weak sense .",
    "for all @xmath201 , one defines the energy form@xmath202 let @xmath131 be the closure of @xmath203 in @xmath204 .",
    "then @xmath130 is a regular strongly local dirichlet form in @xmath126 .",
    "[ remexamplesofdirichletformonfractals ]      [ defhk ] the _ heat kernel _ ( or the _ transition density _ ) of the transition semigroup @xmath205 is a function @xmath9 defined for all @xmath1 and @xmath206 , where @xmath207 is a properly exceptional set containing @xmath208 , and such that the following properties are satisfied :    for any @xmath1 , the function @xmath9 is measurable jointly in @xmath36 ;    for all @xmath189 , @xmath1 and @xmath209,@xmath210    for all @xmath1 and @xmath211 , @xmath212    for all @xmath213 and @xmath211,@xmath214 the set @xmath215 is called the domain of the heat kernel .",
    "let us extend @xmath9 to all @xmath79 by setting @xmath216 if @xmath60 or @xmath86 is outside  @xmath215 .",
    "then ( [ sym ] ) and ( [ semi ] ) hold for all @xmath79 , and the domain of integration in ( [ pt = pt ] ) and ( [ semi ] ) can be extended to @xmath16 . the existence of the heat kernel allows us to extend the definition of @xmath187 to all measurable functions  @xmath116 by choosing a borel measurable version of  @xmath116 and noticing that the integral  ( [ pt = pt ] ) does not change if function @xmath116 is changed on a set of measure  @xmath88 .",
    "it follows from ( [ ee ] ) and ( [ pt = pt ] ) that , for any @xmath217 , @xmath218 for all @xmath1 and @xmath25-a.a .",
    "@xmath50 . a measurable function @xmath9 that satisfies  ( [ ept ] )",
    "is called the heat kernel of the semigroup @xmath150 .",
    "it is well known that the heat kernel of @xmath150 satisfies ( [ sym ] ) and ( [ semi ] ) although for _ almost _ all @xmath79 ( see @xcite , section  3.3 ) .",
    "hence , the relation between the heat kernels of @xmath173 and @xmath150 is as follows : the former is defined as a pointwise function of @xmath36 , while the latter is defined almost everywhere , and the former is a pointwise realization of the latter , where the defining identities ( [ pt = pt ] ) , ( [ sym ] ) , ( [ ept ] ) must be satisfied pointwise . in this paper",
    "the heat kernel is understood exclusively in the sense of definition  [ defhk ] .",
    "the existence of the heat kernel is not obvious at all and will be given a special treatment .",
    "those who are interested in the settings where the pointwise existence of the heat kernel is known otherwise , can skip the rest of this section and go to section [ secaux ] .",
    "[ lemuniq]let @xmath219 be the heat kernel of @xmath173 .",
    "the function @xmath220 belongs to @xmath221 for all @xmath1 and @xmath50 .",
    "for all @xmath1 , @xmath79 , we have @xmath222 and @xmath223 consequently , @xmath224 .    if @xmath225 is another heat kernel , then @xmath226 in the common part of their domains .",
    "\\(a ) set @xmath227 and observe that , by ( [ sym ] ) and ( [ semi]),@xmath228 for all @xmath1 and @xmath211 . since @xmath229 is a borel function , we obtain that @xmath220 is borel .",
    "the latter is true also if @xmath230 since in this case @xmath231 . setting in ( [ t2 ] ) @xmath232",
    ", we obtain@xmath233 whence @xmath234 .",
    "\\(b ) by ( [ ptex ] ) , ( [ ptex0 ] ) we have @xmath235 for all @xmath1 , @xmath50 provided @xmath236 . setting @xmath237 _ { -}$ ] , we obtain@xmath238 _ { -}\\,d\\mu=-\\int _ { m } [ p_{t } ( x,\\cdot ) ] _ { -}^{2}\\,d\\mu,\\ ] ] whence it follows that @xmath239 _",
    "{ -}=0 $ ] a.e . ,",
    "that is , @xmath240 a.e . on @xmath16 .",
    "it follows from ( [ t2 ] ) that , for all @xmath79,@xmath241 inequality ( [ int1 ] ) is trivial if @xmath230 , and if @xmath209 then it follows from@xmath242",
    "\\(c ) let @xmath215 be the intersection of the domains of @xmath219 and @xmath225 . for all @xmath189 and @xmath1 , @xmath209 ,",
    "we have    @xmath243 applying this identity to function @xmath244 where @xmath245 , and using ( [ t2 ] ) , we obtain@xmath246 similarly , we have@xmath247 whence @xmath248 .    following @xcite , page 67 , a sequence @xmath249 of subsets of @xmath16",
    "will be called a _ regular nest _ if :    each @xmath250 is closed ;    @xmath251 for all @xmath252 ;    @xmath253 as @xmath254 ( see @xcite for the definition of capacity ) ;    measure @xmath255 has full support in @xmath250 ( in the induced topology of @xmath250 ) .    [ defn ] a set @xmath256 is called _ truly exceptional _ if :    @xmath207 is properly exceptional ;    @xmath257 ;    there is a regular nest @xmath258 in @xmath16 such that @xmath259 and that the function @xmath260 is continuous for all @xmath261 , @xmath1 , and @xmath262 .    the conditions under which a truly exceptional set exists , will be discussed later on .",
    "let us mention some important consequences of the existence of such a set .",
    "[ lempt < fi]let @xmath207 be a truly exceptional set . if , for some @xmath263 , , and for an upper semicontinuous function @xmath264 $ ] , the inequality@xmath265 holds for @xmath25-a.a .",
    "@xmath50 , then it is true for all @xmath266 .",
    "similarly , if @xmath267 is a lower semicontinuous function and@xmath268 holds for @xmath25-a.a .",
    "@xmath50 , then it is true for all @xmath266 .",
    "this proof is essentially the same as in @xcite , theorem 2.1.2(ii ) .",
    "assume that @xmath269 for some @xmath270 .",
    "by definition [ defn ] , @xmath271 belongs to one of the sets @xmath250 .",
    "since @xmath272 is continuous and , hence , @xmath273 is lower semicontinuous , the condition @xmath274 implies that @xmath275 for all @xmath60 in some open neighborhood @xmath276 of @xmath271 in @xmath250 . since measure",
    "@xmath25 has full support in @xmath250 , we have @xmath277 so that @xmath278 in a set of positive measure , that contradicts the hypothesis .",
    "the second claim follows from the first one with @xmath279 .",
    "denote by @xmath280 the @xmath25-essential supremum of a function @xmath116 on a set @xmath281 , and by @xmath282the @xmath25-essential infimum .",
    "[ cesup = sup1]let @xmath207 be a truly exceptional set .",
    "then , for any @xmath263 , @xmath1 , and an open set @xmath283,@xmath284    function@xmath285 is upper semicontinuous . since @xmath286 for @xmath25-a.a .",
    "@xmath50 , we conclude by lemma [ lempt < fi ] that this inequality is true for all @xmath287 , whence@xmath288 the opposite inequality follows trivially from the definition of the essential supremum .",
    "the second identity in ( [ esi ] ) follows from the first one by changing @xmath116 to  @xmath289 .",
    "note that if @xmath9 is the heat kernel with domain @xmath290 , then we have by ( [ semi ] ) that , for all @xmath291 , @xmath292,@xmath293 where @xmath294 .",
    "hence , if @xmath207 is truly exceptional , then the claims of lemma  [ lempt < fi ] and corollary [ cesup = sup1 ] apply to function @xmath9 in place of @xmath295 , with any fixed @xmath245 .",
    "[ lembgk ] let @xmath296 be the heat kernel with the domain @xmath290 such that @xmath207 is a truly exceptional set .",
    "let @xmath297 $ ] be an upper semicontinuous function and @xmath298 be a lower semicontinuous function .",
    "if , for some fixed @xmath1 , the following inequality : @xmath299 holds for @xmath300-almost all @xmath211 , then ( [ pta ] ) holds for all @xmath211 .",
    "this lemma is a generalization of @xcite , lemma 2.2 , and the proof follows the argument in @xcite .",
    "proof of lemma [ lembgk ] consider the set@xmath301 if @xmath302 then applying lemma [ lempt < fi ] to the function @xmath303 , we obtain that  ( [ pta ] ) holds for all @xmath209 .",
    "now fix @xmath209 .",
    "since by fubini s theorem @xmath304 ,  ( [ pta ] ) holds for @xmath25-a.a .",
    "@xmath305 . applying lemma  [ lempt < fi ] to the function @xmath220",
    ", we conclude that  ( [ pta ] ) holds for all @xmath245 .",
    "[ cesup = sup]under the hypotheses of lemma [ lembgk ] , if @xmath306 are two open subsets of @xmath16 then@xmath307 and@xmath308    this follows from lemma [ lembgk ] with functions @xmath309 and@xmath310    in conclusion of this section , let us state a result that ensures the existence of the heat kernel outside a truly exceptional set .",
    "[ tbbck ] assume that there is a positive left - continuous function @xmath311 such that for all @xmath312 and @xmath1,@xmath313 then the transition semigroup @xmath173 possesses the heat kernel @xmath9 with domain @xmath290 for some truly exceptional set @xmath207 , and @xmath314 for all @xmath211 and @xmath1 .",
    "if the semigroup @xmath162 satisfies ( [ ultra ] ) , then it is called _ ultracontractive _ ( cf .",
    "it was proved in @xcite that the ultracontractivity implies the existence of a function @xmath67 that satisfies all the requirements of definition  [ defhk ] except for the joint measurability in @xmath36 .",
    "let us prove the latter so that @xmath9 is indeed the heat kernel in our strict sense .",
    "given that @xmath9 satisfies conditions ( 2)(4 ) of definition  [ defhk ] , we see that the statement of lemma  [ lemuniq ] remains true because the proof of that lemma does not use the joint measurability .",
    "in particular , for any @xmath1 , @xmath209 , the function @xmath220 is in @xmath126 .",
    "also , the mapping @xmath315 is weakly measurable as a mapping from @xmath215 to @xmath126 because for any @xmath316 , the function @xmath317 is measurable . since @xmath318 is separable , by pettis s measurability theorem ( see @xcite , chapter v , section 4 ) the mapping @xmath319 is strongly measurable in @xmath320 .",
    "it follows that the function@xmath321 is jointly measurable in @xmath211 as the composition of two strongly measurable mappings @xmath322 and a continuous mapping @xmath323 .",
    "any open subset @xmath324 of @xmath16 can be considered as a metric measure space @xmath325 .",
    "let us identify @xmath326 as a subspace in @xmath126 by extending functions outside  @xmath324 by  @xmath88 .",
    "define  @xmath327 as the closure of @xmath328 in @xmath131 so that @xmath327 is a  subspace of both @xmath329 and @xmath330 .",
    "then @xmath331 is a regular strongly local dirichlet form in @xmath330 , which is called the restriction of @xmath34 to @xmath324 .",
    "let  @xmath332 be the generator of the form @xmath333 and @xmath334 , @xmath335 , be the _ restricted _ heat semigroup .",
    "define the _ first exit time _ from @xmath324 by@xmath336 the diffusion process associated with the restricted dirichlet form , can be canonically obtained from @xmath337 by killing the latter outside @xmath324 , that is , by restricting the life time of @xmath169 by @xmath338 ( see @xcite ) .",
    "it follows that the transition operator @xmath339 of the killed diffusion is given by@xmath340 for all @xmath341 .",
    "then @xmath342 is defined for @xmath116 from other function classes in the same way as @xmath173 .",
    "also , extend @xmath343 to all @xmath344 by setting it to be @xmath88 if @xmath345 .",
    "we say that the semigroup @xmath150 is _ locally ultracontractive _ if the restricted heat semigroup @xmath346 is ultracontractive for any metric ball @xmath347 of @xmath33 .",
    "[ tptom]let the semigroup @xmath150 be locally ultracontractive .",
    "then the following is true .",
    "there exists a properly exceptional set @xmath256 such that , for any open subset @xmath104 , the semigroup @xmath348 possesses the heat kernel @xmath349 with the domain @xmath350 .",
    "if @xmath351 are open subsets of @xmath16 , then @xmath352 for all @xmath1 , @xmath353 .    if @xmath354 is an increasing sequence of open subsets of @xmath16 and @xmath355 , then @xmath356 as @xmath357 for all @xmath1 , @xmath358",
    ".    set @xmath290 .",
    "let @xmath359 $ ] be an upper semi - continuous function such that , for some open set @xmath360 and for some @xmath1,@xmath361 for almost all @xmath362 .",
    "then ( [ ptfi ] ) holds for all @xmath358 .    for simplicity of notation ,",
    "set @xmath363 to be @xmath88 for all @xmath36 outside @xmath324 ( which , however , does not mean the extension of the domain of @xmath364 ) .",
    "proof of theorem [ tptom ] ( a ) since the metric space @xmath33 is separable , there is a countable family of balls that form a base .",
    "let @xmath365 be the family of all finite unions of such balls so that @xmath366 is countable and any open set @xmath104 can be represented as an increasing union of sets of @xmath366 .",
    "since any set @xmath367 is contained in a metric ball , the semigroup @xmath368 is dominated by  @xmath346 and , hence , is ultracontractive . by theorem [ tbbck ] , there is a truly exceptional set @xmath369 such that the @xmath370 has the heat kernel @xmath371 in the domain @xmath372 . since the family @xmath366 is countable , the set@xmath373 is properly exceptional .",
    "let us first show that if @xmath374 , @xmath375 are the sets from @xmath366 and @xmath376 , then @xmath377 it follows from ( [ ptom ] ) that , for any @xmath378,@xmath379 that is,@xmath380 setting here @xmath381 where @xmath382 , we obtain@xmath383 setting in ( [ om12 ] ) @xmath384 , we obtain@xmath385 combining the above two lines gives ( [ pt12 ] ) .",
    "let @xmath324 be any open subset of @xmath16 and @xmath386 be an increasing sequence of sets from @xmath366 such that @xmath387 .",
    "let us set@xmath388 this limit exists ( finite or infinite ) by the monotonicity of the sequence @xmath389 .",
    "it follows from ( [ ptom ] ) that , for any @xmath341,@xmath390 by the monotone convergence theorem , we obtain@xmath391 for all @xmath1 and @xmath392 . comparing the above two lines , we obtain@xmath393 the symmetry of @xmath363 is obvious from ( [ ptomlim ] ) , and the semigroup property of @xmath364 follows from that of @xmath394 by the monotone convergence theorem . note that @xmath395 does not depend on the choice of @xmath396 by the uniqueness of the heat kernel ( lemma [ lemuniq ] ) .",
    "\\(b ) for two arbitrary open sets @xmath397 let @xmath398 and @xmath399 be increasing sequences of sets from @xmath366 that exhaust @xmath400 and @xmath401 , respectively . set @xmath402 so that @xmath403 and @xmath401 is the increasing union of sets @xmath404 ( see figure [ pic6 ] ) .",
    "then @xmath405 and , hence , @xmath406 , which implies as @xmath254 that @xmath407 .    .",
    "]    \\(c ) let @xmath408 be an increasing sequence of open sets whose union is  @xmath324 .",
    "let @xmath409 be an increasing sequence of sets from @xmath366 that exhausts  @xmath410 .",
    "as in the previous argument , we can replace @xmath411 by @xmath412 so that @xmath413 .",
    "rename @xmath414 back to @xmath411 , and assume in the sequel that @xmath415 .",
    "similarly , replace @xmath416 by @xmath417 and assume in the sequel that @xmath418 .",
    "arguing by induction , we redefine the double sequence @xmath419 in the way that it is monotone increasing not only in @xmath420 but also in @xmath421",
    ". then we claim that @xmath422 indeed , if @xmath423 then @xmath424 for some @xmath421 and , hence , @xmath425 for some @xmath420 , which implies @xmath426 for @xmath427 .",
    "finally , we have @xmath428 and@xmath429 whence it follows that@xmath430    \\(d ) let @xmath431 be subset of @xmath324 .",
    "then the semigroup @xmath368 is ultracontractive and possesses the heat kernel @xmath371 with the domain @xmath432 where @xmath433 is a  truly exceptional set as in part ( a ) .",
    "note that @xmath434 .",
    "since @xmath435 in @xmath436 , we obtain by hypothesis that @xmath437 for almost all @xmath438 . by lemma [ lembgk ] , we conclude that this inequality is true for all @xmath439 .",
    "exhausting @xmath324 be a sequence of subsets @xmath431 and using ( [ ptomlim ] ) , we obtain ( [ ptfi ] ) .",
    "a priori we assume here only the basic hypotheses . all necessary additional assumptions are explicitly stated .",
    "the main result of this section is theorem [ tg=>fk ] .",
    "given an open set @xmath104 , define the green operator @xmath440 first for all @xmath341 by@xmath441 for all @xmath180 , where we admit infinite values of the integral . if @xmath116 @xmath442 and @xmath443 then @xmath444 is also defined by @xmath445    we have , for any open @xmath104 and all @xmath446,@xmath447 for any @xmath448 . in particular,@xmath449    indeed , integrating ( [ ptom ] ) in @xmath100 , we obtain@xmath450 obviously , ( [ gtau ] ) follows from ( [ gom ] ) for @xmath451 .",
    "denote by @xmath452 the bottom of the spectrum of @xmath332 in @xmath453 , that is,@xmath454 for any open set @xmath104 , we will consider the _ mean exit time _",
    "@xmath455 from @xmath324 as a function of @xmath456 .",
    "also , set@xmath457    [ lg1 - 1]if @xmath458 then @xmath440 is a bounded operator on @xmath459 and it uniquely extends to each of the spaces @xmath460 , @xmath461 , @xmath462 , with the following norm estimates:@xmath463 \\label{g1 - 1 } \\vert g^{\\omega}\\vert_{l^{1}\\rightarrow l^{1}}&\\leq&\\widetilde { e } ( \\omega ) , \\\\[-1pt ] \\label{g2 - 2 } \\vert g^{\\omega}\\vert_{l^{2}\\rightarrow l^{2}}&\\leq&\\widetilde { e } ( \\omega ) .\\end{aligned}\\ ] ] moreover , @xmath464 and @xmath440 is the inverse in @xmath330 to the operator @xmath332 .",
    "it follows from ( [ gtau ] ) that@xmath465 which implies that for any @xmath466 , @xmath467 hence , @xmath440 can be considered as a bounded operator in @xmath468 with the norm estimate ( [ gi - i ] ) .",
    "estimate ( [ g1 - 1 ] ) follows from ( [ gi - i ] ) by duality . indeed , for any two functions @xmath469 , we have@xmath470 which follows from ( [ gdef ] ) and the symmetry of @xmath471 .",
    "by linearity , ( [ gfh ] ) extends to all @xmath472 .",
    "then , for any @xmath473 , we have@xmath474 & = & \\sup_{h\\in\\mathcal{b}_{b } ( \\omega ) \\setminus \\ { 0\\ } } \\frac{\\int_{\\omega}fg^{\\omega}h\\,d\\mu}{\\vert h\\vert _ { \\infty } } \\\\[-1pt ] & \\leq&\\sup_{h\\in\\mathcal{b}_{b } ( \\omega ) \\setminus \\ { 0\\ } } \\frac{\\vert g^{\\omega}h\\vert_{\\infty}\\vert f\\vert _ { 1}}{\\vert h\\vert_{\\infty } } \\\\[-1pt ] & \\leq&\\widetilde{e } ( \\omega ) \\vert f\\vert_{1},\\end{aligned}\\ ] ] whence it follows that @xmath440 uniquely extends to a bounded operator in @xmath475 with the norm estimate ( [ g1 - 1 ] ) .    the estimate ( [ g2 - 2 ] ) [ as well as a similar estimate for @xmath476 for any @xmath477 follows from ( [ gi - i ] ) and ( [ g1 - 1 ] ) by the riesz ",
    "thorin interpolation theorem .    to prove ( [ lamin < ] ) , let us consider the following `` cut - down '' version of the green operator:@xmath478 where @xmath479 .",
    "the same argument as above shows that @xmath480 can be considered as an operator in @xmath481 with the same norm bound@xmath482 on the other hand , using the spectral resolution @xmath483 of the generator  @xmath484 , we obtain , for any @xmath473,@xmath485\\\\[-8pt ] & = & \\int_{0}^{\\infty}\\varphi_{t } ( \\lambda ) \\,de_{\\lambda}f \\nonumber\\\\ & = & \\varphi_{t } ( \\mathcal{l}^{\\omega } ) f,\\nonumber\\end{aligned}\\ ] ] where@xmath486 since @xmath487 is a bounded function on @xmath488 , the operator @xmath489 is a  bounded operator in @xmath481 . by the spectral mapping theorem , we obtain@xmath490 on the other hand , since @xmath491 is decreasing in @xmath492,@xmath493 whence@xmath494 by letting @xmath495 and observing that @xmath496 , we obtain@xmath497 which in particular means that @xmath498 .",
    "consequently , the operator @xmath332 has a bounded inverse . passing in ( [ fit ] ) to the limit as @xmath495",
    ", we obtain @xmath499 .",
    "let @xmath324 be an open subset of  @xmath16 .",
    "we say that a function @xmath500 is _ harmonic _ in @xmath324 if@xmath501    [ lemg - g]let @xmath324 be an open subset of @xmath16 such that @xmath502 , and let @xmath276 be an open subset of @xmath324 .    for any @xmath503 ,",
    "the function @xmath444 is harmonic in @xmath276.[remdoweneeda ? ]    for any @xmath504 , the function @xmath505 is harmonic in @xmath276 .",
    "if @xmath506 then @xmath507 is defined as the extension of @xmath508 to @xmath324 by setting it to be equal to @xmath88 in @xmath509 .",
    "proof of lemma [ lemg - g ] ( a ) set @xmath510 . to prove that @xmath52 is harmonic in  @xmath276 , we need to show that @xmath511 , for any @xmath512 .",
    "since by lemma  [ lg1 - 1 ] @xmath513 , we have @xmath514 .",
    "therefore , by the definition of @xmath515,@xmath516    \\(b ) set @xmath517 .",
    "any function @xmath512 can be considered as an element of @xmath518 by setting it to be @xmath88 in @xmath509 .",
    "then both @xmath52 and @xmath519 are in  @xmath327 whence@xmath520    denote by @xmath521 the open metric ball of radius @xmath51 centered at a point @xmath50 , and set@xmath522 that @xmath25 has full support implies @xmath523 whenever @xmath51 .",
    "whenever we use the function @xmath524 , we always assume that @xmath525 for example , this condition is automatically satisfied if all balls are precompact . however , we do not assume precompactness of all balls unless otherwise explicitly stated .",
    "we say that the _ elliptic harnack inequality _ ( [ condh ] ) holds on  @xmath16 , if there exist constants @xmath526 and @xmath527 such that , for any ball  @xmath59 in @xmath16 and for any function @xmath500 that is nonnegative and harmonic  @xmath528 ,    @xmath529    we say that the _ volume doubling _ property ( [ vd ] ) holds if there exists a constant @xmath15 such that , for all @xmath50 and @xmath51[condvd ]    @xmath530    it is known that ( [ vd ] ) implies that , for all @xmath79 and @xmath531 , @xmath532 for some @xmath29 ( see @xcite ) .",
    "assume that @xmath533 hold .",
    "let @xmath534 be an open subset of  @xmath16 such that @xmath535 and let @xmath536 be a ball contained in @xmath324 .",
    "[ lgom ] for any nonnegative function @xmath537 , [ remdoweneeda?copy1]@xmath538    [ lemgb - gb]for and any nonnegative function @xmath539,@xmath540    \\(a ) since identity ( [ gom < e ] ) survives monotone increasing limits of sequences of functions @xmath541 , it suffices to prove ( [ gom < e ] ) for any nonnegative function @xmath542 .",
    "then , by lemma [ lemg - g ] , the function @xmath543 is harmonic in @xmath544 . since @xmath545",
    ", we can use the harnack inequality ( [ condh ] ) in ball @xmath347 , which yields@xmath546    \\(b ) assume first that @xmath547 . by lemma [ lemg - g ] ,",
    "the function @xmath548 is harmonic in @xmath59 . since @xmath549 , applying for this function argument ( [ fi1 ] ) , we obtain ( [ gbb ] ) .",
    "an arbitrary nonnegative function @xmath550 can be represented as a sum in @xmath551@xmath552 where @xmath553 . applying ( [ gbb ] ) to each @xmath554 and summing up , we obtain ( [ gbb ] ) for @xmath541 .",
    "a classical theorem of faber and krahn says that for any bounded open set @xmath555 , @xmath556 where @xmath347 is a ball in @xmath5 of the same volume as @xmath534 . if the radius of @xmath347 is @xmath557 , then",
    "@xmath558 where @xmath14 is a positive constant depending only on @xmath420 , which implies that @xmath559 cf .",
    "we refer to lower estimates of @xmath452 via a function of @xmath560 as _ faber ",
    "krahn inequalities_. a more general type of a faber ",
    "krahn inequality holds on a complete @xmath420-dimensional riemannian manifold @xmath16 of nonnegative ricci curvature : for any bounded open set @xmath561 and for any ball @xmath347 of radius @xmath557 containing  @xmath534,[condfk0]@xmath562 where @xmath563 and @xmath564 ( see @xcite ) .",
    "note that ( [ fkrn ] ) follows from  ( [ fkrel ] ) ( apart from the sharp value of the constant @xmath14 ) because in @xmath5 we have @xmath565 .",
    "it was proved in @xcite that , on any complete riemannian manifold , @xmath566 where ( _ ue _ ) is here the upper bound of the heat kernel in the li ",
    "yau estimate ( [ liyau ] ) . in section [ secdue ]",
    "we will derive a general upper bound ( [ uee ] ) from a  set of hypotheses containing a suitable version of ( [ fkrel ] ) . in this section",
    ", we will deduce a faber ",
    "krahn inequality from the main hypotheses .",
    "we fix from now on a function @xmath567 that is a continuous increasing bijection of @xmath568 onto itself , such that , for all @xmath569,@xmath570 for some constants @xmath571 , @xmath526 . in the sequel",
    "we will use the inverse function @xmath572 .",
    "it follows from ( [ fb ] ) that@xmath573 for all @xmath574 .",
    "we say that the faber ",
    "krahn inequality ( [ fk ] ) holds if , for any ball @xmath347 in @xmath16 of radius @xmath557 and any open set @xmath575,[condfk ]    @xmath576    with some positive constants @xmath577 .",
    "we say that the mean exit time estimate ( [ ef ] ) holds if , for all @xmath180 and @xmath51,[condef ]    @xmath578    with some constant @xmath526 .",
    "we denote by @xmath579 and @xmath580 the upper and lower bounds of @xmath581 in  ( [ eff ] ) , respectively .",
    "[ tg=>fk]the hypotheses @xmath582 imply ( [ fk ] ) .",
    "we have by ( [ lamin < ] ) and ( [ gtau ] ) @xmath583 it will be convenient to rename @xmath584 to @xmath585 and let the original ball @xmath347 be @xmath586 and @xmath587 .",
    "fix a point @xmath344 so that @xmath588 , consider a numerical sequence @xmath589 , @xmath590 where @xmath591 is the parameter from ( [ condh ] ) , and the balls @xmath592 .",
    "we have@xmath593 where @xmath420 is to be chosen ( see figure [ pic3 ] ) , whence@xmath594    . ]    setting @xmath595 and using @xmath596 , we obtain , by lemma  [ lemgb - gb],@xmath597 also , by ( [ gom1]),@xmath598 hence , collecting together the previous lines , we obtain@xmath599 choose any @xmath600 so that @xmath601 . using ( [ fb ] ) ,",
    "( [ va ] ) and the monotonicity of @xmath602 , we obtain@xmath603 now choose @xmath420 from the condition @xmath604 and set @xmath605 .",
    "we obtain then@xmath606\\\\[-8pt ] & \\leq&cf ( r ) \\biggl ( \\frac{v ( r ) } { v ( r ) } \\biggr ) ^{\\nu}+cf ( r ) .\\nonumber\\end{aligned}\\ ] ] using again ( [ va ] ) , ( [ fb ] ) and @xmath607 , we obtain @xmath608 which implies that the second term in ( [ esupg2 ] ) can be absorbed by the first one , thus giving @xmath609 since the point @xmath344 was arbitrary , covering @xmath324 by a countable family of balls like @xmath610 , we obtain @xmath611 which together with ( [ lag ] ) finishes the proof .",
    "our main result in this section is theorem [ tef ] saying that the condition ( [ eff ] ) implies a certain upper bound for the tail @xmath612 of the exit time from balls .",
    "the results of this type go back to barlow @xcite , theorem  3.11 . here",
    "we give a self - contained proof in the present setting , which is based on the ideas of @xcite .",
    "an alternative analytic approach can be found in @xcite .",
    "for any open set @xmath104 , set@xmath613    [ lttail]for any open @xmath104 such that @xmath614 , we have , for all @xmath1 and @xmath615,@xmath616    denote @xmath617 , and observe that@xmath618 where @xmath619 is the time shift of trajectories . using the markov property , we obtain , for any @xmath448,@xmath620 whence @xmath621 ( see figure [ pic7 ] ) ,    . ]    and ( [ px < ] ) follows .    [ le<1-e]assume that the condition ( [ eff ] ) is satisfied",
    ". then there are constants @xmath622 such that , for all @xmath180 , @xmath623 , and @xmath624,@xmath625    denoting @xmath626 and using lemma [ lttail ] , we have , for any , @xmath627 the condition ( [ eff ] ) implies that@xmath628 whence@xmath629 using these two estimates of @xmath630 , we obtain@xmath631 setting @xmath632 and choosing @xmath633 , we obtain@xmath634 if also @xmath635 , then we obtain ( [ exe ] ) .",
    "clearly , the former condition will be satisfied provided@xmath636 which finishes the proof .",
    "[ pf < exp]assume that the condition ( [ eff ] ) is satisfied .",
    "then there exists constant @xmath637 such that , for all precompact balls @xmath638 with @xmath180 and for all @xmath639,@xmath640 where @xmath572 .",
    "rename the center @xmath60 of the ball to @xmath641 so that the letter @xmath60 will be used to denote a variable point .",
    "fix some @xmath531 to be specified later , and set @xmath642 $ ] .",
    "set also @xmath643 , @xmath644 and@xmath645 where @xmath646 .",
    "note that all @xmath647 are bounded by @xmath184 .",
    "choose @xmath648 where @xmath85 is the constant from lemma [ le<1-e ] , and let @xmath649 be a point in @xmath650 for which @xmath651 fix @xmath652 , observe that @xmath653 and consider the following function in @xmath654:@xmath655 where @xmath656 ( see figure [ pic4 ] ) . since the ball @xmath657 is precompact , we have @xmath658 ( while for noncompact balls the exit point could have been at the cemetery ) .     and @xmath659",
    "]    let us show that , for all @xmath660,@xmath661 indeed , we have by the strong markov property@xmath662 which proves ( [ u < uu ] ) .",
    "it follows from ( [ u < uu ] ) that@xmath663 whence@xmath664 by lemma [ le<1-e ] , if @xmath665 then @xmath666 .",
    "therefore , under hypothesis ( [ lar ] ) , we have@xmath667 whence it follows by iteration that@xmath668 where in the last inequality we have used that @xmath669 and @xmath670 .",
    "condition ( [ lar ] ) can be satisfied by choosing @xmath671 this value of @xmath557 is legitimate only if @xmath672 , that is , if@xmath673 if ( [ r > ] ) is not fulfilled , then ( [ ex0 ] ) is trivially satisfied by choosing the constant @xmath15 large enough . assuming that ( [ r > ] ) is satisfied and defining @xmath557 by  ( [ n= ] ) we obtain from ( [ n ] ) that@xmath674 whence ( [ ex0 ] ) follows .",
    "[ tef]assume that ( [ ef ] ) holds .",
    "then , for any precompact ball  @xmath638 with @xmath180 and for any @xmath1 , @xmath675 where @xmath637 is the constant from lemma [ pf < exp ] and @xmath676    changing the variable @xmath557 in ( [ fidef ] ) , we obtain the following equivalent definitions of @xmath677 : @xmath678 where @xmath572 .    proof of theorem [ tef ] denoting @xmath626 and using lem - ma  [ pf < exp ] , we obtain that , for any @xmath639,@xmath679 taking the supremum in @xmath492 and using ( [ fidef2 ] ) , we obtain ( [ psi ] ) .",
    "[ remfi ] it is clear from ( [ fidef ] ) that function @xmath680 is increasing in @xmath584 and decreasing in @xmath100 . also , we have , for any constants @xmath681,@xmath682 in particular , it follows that @xmath683 where@xmath684 hence , ( [ psi ] ) can be written also in the form@xmath685    clearly , @xmath686 .",
    "let us show that @xmath687 for all @xmath688 .",
    "since@xmath689 we see from ( [ fidef1 ] ) that @xmath690 .",
    "it follows from ( [ fb ] ) and @xmath30 that @xmath691 given @xmath688 , choose @xmath557 so big that @xmath692 [ such @xmath557 exists by the second condition in ( [ frr ] ) ] .",
    "then@xmath693 in order to prove that @xmath694 , it suffices to show that@xmath695 indeed , if @xmath557 is sufficiently small , then by the first condition in ( [ frr ] ) , @xmath696 whence @xmath697 .",
    "another useful property of function @xmath40 is the inequality[remdoweuseit?]@xmath698 indeed , we have for any @xmath51 @xmath699 whence ( [ fi2s ] ) follows by taking @xmath129 in @xmath557 .",
    "if @xmath61 is differentiable then the supremum in ( [ fidef1 ] ) is attained at the value of @xmath557 that solves the equation@xmath700 for example , @xmath62 then we obtain @xmath701 whence @xmath702 and@xmath703 consequently , ( [ psi ] ) becomes@xmath704    [ exf120 ] consider the following example of function @xmath705:@xmath706 where @xmath707 .",
    "it is easy to see that ( [ fb ] ) is satisfied with @xmath708 and @xmath709 .",
    "similarly to the previous example , one obtains that@xmath710 so that ( [ psi ] ) becomes@xmath711    [ lemtifi]the function @xmath712 satisfies the following inequality:@xmath713 for all @xmath714",
    ".    by ( [ fidef ] ) , we have , for any @xmath51,@xmath715 we claim that there exists @xmath51 such that@xmath716 indeed , the function @xmath717 is continuous on @xmath718 , tends to @xmath88 as @xmath719 and to @xmath89 as @xmath720 so that @xmath717 takes all positive values , whence the claim follows . with the value of @xmath557 as in ( [ rt ] ) , we have @xmath721 if @xmath722 then using the left - hand side inequality of ( [ fb ] ) , we obtain@xmath723 which together with ( [ rt ] ) yields @xmath724 substituting into ( [ lati ] ) , we obtain@xmath725 similarly , it @xmath726 then using the right - hand side inequality in ( [ fb ] ) we obtain@xmath727 whence it follows that @xmath728    [ cef]under the hypotheses of theorem [ tef ] , we have , for any @xmath180 , @xmath623 , @xmath1 , @xmath729    indeed , if @xmath730 , then ( [ ptau ] ) follows from theorem [ tef ] , lemma  [ lemtifi ] and ( [ fb ] ) .",
    "if @xmath731 , then ( [ ptau ] ) is trivial .",
    "the following result will be used in the proof of theorem [ tdue ] below .",
    "[ pdirhk ] let @xmath276 be an open subset of @xmath16 , and assume that , for any nonempty open set @xmath732,@xmath733 for some positive constants @xmath734 .",
    "then the semigroup @xmath735 is ultracontractive with the following estimate:@xmath736 for any @xmath737 .",
    "the next theorem provides pointwise upper bounds for the heat kernel .",
    "[ tdue][tue]if the conditions @xmath738 are satisfied and all balls are precompact then the heat kernel exists with the domain @xmath739 for some properly exceptional set @xmath207 , and satisfies the upper bound[condue ]    @xmath740    for all @xmath1 and @xmath741 , where @xmath572 and @xmath677 is defined by ( [ fidef ] ) .",
    "as it follows from theorem [ tg=>fk ] , the hypotheses @xmath742 here can be replaced by @xmath743 . also , using ( [ fifi ] ) , one can write ( [ uee ] ) in the form@xmath744 as it was stated in the .    a version of theorem [ tdue ] was proved by kigami @xcite under additional assumptions that the heat kernel is a priori continuous and ultracontractive , and using instead of ( [ fk ] ) a local nash inequality . in the case",
    "@xmath62 , another version of theorem [ tdue ] was proved in @xcite , where the upper bound ( [ uee ] ) was understood for _ almost all _ @xmath36 .",
    "the proof below uses a combination of techniques from @xcite and @xcite .",
    "if function @xmath61 is given by ( [ f120 ] ) as in example [ exf120 ] , then @xmath40 is given by ( [ fi120 ] ) and ( [ uee ] ) becomes@xmath745 where @xmath746 .",
    "proof of theorem [ tdue ] the hypothesis ( [ fk ] ) can be stated as follows : for any ball @xmath536 where @xmath50 and @xmath51 , and for any nonempty open set @xmath747 , we have @xmath748 where@xmath749 and @xmath750 are positive constants .",
    "hence , ( [ fk ] ) implies by proposition [ pdirhk ] that@xmath751 in particular , the semigroup @xmath752 is ultracontractive and @xmath162 is locally ultracontractive . by theorem [ tptom ] ,",
    "there exists a properly exceptional set @xmath256 ( containing @xmath208 ) such that , for any open subset @xmath104 , the semigroup @xmath348 possesses the heat kernel @xmath363 with the domain @xmath753 .",
    "fix this set @xmath207 for what follows . by theorem [ tbbck ] , ( [ ab ] ) and ( [ bultra ] )",
    "imply the following estimate : @xmath754 for any ball @xmath347 of radius @xmath557 , and for all @xmath1 , @xmath755 .",
    "our next step is to prove the on - diagonal estimate    @xmath756    for all @xmath160 and @xmath1 . to understand the difficulties ,",
    "let us first consider a particular case when the volume function satisfies the following estimate : @xmath757 for all @xmath50 and @xmath623 , where @xmath758 is the exponent in ( [ fk ] ) [ e.g. , ( [ vf ] ) holds , if @xmath759 , @xmath760 and @xmath761 . in this case ,",
    "the value @xmath762 in  ( [ fk ] ) cancels our , and we obtain @xmath763 hence , by proposition [ pdirhk ] , the semigroup @xmath764 is ultracontractive , and by theorem  [ tbbck ] we obtain the estimate@xmath765 for all @xmath160 and @xmath1 .",
    "observing that@xmath766 we see that ( [ t1nu ] ) is equivalent to ( [ due ] ) .",
    "although this argument works only under restriction ( [ vf ] ) , it has an advantage that it can be localized as follows . assuming that ( [ vf ] ) is satisfied for all @xmath767 with some fixed constant @xmath768 ,  ( [ fkc ] ) is satisfied for all open sets @xmath324 with a bounded value of  @xmath769 , and  ( [ eff ] ) is satisfied for all balls with a bounded value of the radius , one can prove in the same way that ( [ t1nu ] ) is true for @xmath770 for some @xmath771 .",
    "the proof below does not allow such a localization in the general case.=-1    in the general case , without the hypotheses ( [ vf ] ) , the heat semigroup  @xmath162 is not necessarily ultracontractive , which requires other tools for obtaining  ( [ due ] ) . in the case of riemannian manifolds , one can obtain  ( [ due ] ) from  ( [ fk ] ) using a certain mean value inequality ( see @xcite ) but this method heavily relies on a specific property of the distance function that , which is not available in our generality .",
    "we will use kigami s iteration argument that allows us to obtain ( [ due ] ) from ( [ ptb ] ) using , in addition , the hypothesis  ( [ eff ] ) .",
    "this argument is presented in an abstract form in  @xcite , lemma 5.6 , that says the following .",
    "assume that the following two conditions are satisfied :    for any ball @xmath536,@xmath772 where function @xmath773 satisfies certain conditions should be monotone decreasing in @xmath100 and should satisfy the following doubling condition : if @xmath774 and @xmath775 , then @xmath776 for some constant @xmath777 .",
    "this is obviously satisfied for the function @xmath778 given by ( [ psidef ] ) . ] ;    for all @xmath180 , @xmath1 , and @xmath779,@xmath780 where @xmath81 is a sufficiently small where @xmath777 is the constant from the conditions for @xmath778 . ]",
    "constant and @xmath541 is a positive increasing function on @xmath781 such that@xmath782    then the heat kernel on @xmath16 satisfies the estimate@xmath783 obviously , ( [ ptb ] ) implies ( [ psit ] ) with the function @xmath784 by corollary [ cef ] , ( [ eff ] ) implies ( [ ptau ] ) , which means that ( [ pxtau ] ) is satisfied provided @xmath785 for a sufficiently large constant @xmath15 ; hence , the function  @xmath786 can be chosen as follows : @xmath787 which clearly satisfies ( [ intfi ] ) [ indeed , by ( [ rb ] ) , we have @xmath788 for all @xmath789 , whence ( [ intfi ] ) follows ] .    by ( [ ptxx ] )",
    ", we obtain@xmath790 where we have also used ( [ rb ] ) and ( [ va ] ) . by theorem [ tptom](d ) , we can replace here @xmath791 by @xmath792 outside @xmath207 , whence ( [ due ] ) follows .",
    "now we prove the full upper estimate ( [ uee ] ) .",
    "fix two disjoint open subsets  @xmath793 of @xmath16 and use the following inequality proved in @xcite , lemma 2.1 : for all functions @xmath794,@xmath795\\\\[-9pt ] & & { } + \\bigl(\\mathbb { e}_{\\cdot}\\bigl(\\mathbf{1}_{\\{\\tau_{v}\\leq t/2\\}}\\mathcal{p}_{t-\\tau_{v}}g(x_{\\tau _ { v}})\\bigr),f\\bigr)\\nonumber\\end{aligned}\\ ] ] ( see figure [ pic5 ] ) .    ) . ]",
    "assume in addition that @xmath796 and @xmath797 .",
    "then , under the condition @xmath798 , we have@xmath799 almost surely , where@xmath800 here we have used that @xmath801 almost surely , which is due to the fact that @xmath337 is a diffusion and the set @xmath207 is properly exceptional .",
    "it follows  that@xmath802 estimating similarly the second term in ( [ ptfgb ] ) , we obtain from ( [ ptfgb])@xmath803 & & \\qquad\\leq s\\vert f\\vert _ { 1}\\int_{u}\\mathbb{p}_{x}\\biggl ( \\tau_{u}\\leq\\frac{t}{2}\\biggr ) g ( x ) \\,d\\mu ( x)\\\\[-2pt ] & & \\qquad\\quad { } + s\\vert g\\vert_{1}\\int_{v}\\mathbb{p}_{y}\\biggl ( \\tau _ { v}\\leq \\frac{t}{2}\\biggr ) f ( y ) \\,d\\mu ( y ) .\\end{aligned}\\ ] ] by @xcite , lemma 3.4 , we conclude that , for @xmath804-a.a .",
    "@xmath805 and @xmath806 , @xmath807 a slightly different inequality ( i.e. , also enough for our purposes ) was proved in  @xcite . for the case of heat kernels on riemannian manifolds , ( [ p < pb2 ] )",
    "was proved in @xcite , lemma 3.3 .    by theorem [ tef ] , we have@xmath808 for all @xmath160 and @xmath809 .",
    "let @xmath810 then , for any @xmath811 , we obtain by ( [ psi1])@xmath812 using a similar estimate for @xmath813 , we obtain from ( [ p < pb2 ] ) that , for @xmath25-a.a .",
    "@xmath814 and @xmath813,@xmath815 since the right - hand side here is a constant in @xmath36 , we conclude by theorem  [ tptom](d ) that ( [ ptro ] ) holds for all @xmath816 and @xmath817 .",
    "now fix two distinct points @xmath741 , set @xmath818 and observe that the balls @xmath819 and @xmath820 are disjoint .",
    "since @xmath814 and @xmath813 , we conclude that ( [ ptro ] ) is satisfied for these points @xmath36 with the above value of @xmath584 .",
    "let us estimate the quantity @xmath821 defined by ( [ s ] ) .",
    "using the semigroup property and ( [ due ] ) , we obtain , for all @xmath822,@xmath823 observe that by ( [ va ] ) , for all @xmath824,@xmath825 applying this for @xmath826 and @xmath827 so that @xmath828 and @xmath829 , and substituting to the above estimate of @xmath830 we obtain@xmath831 using that @xmath832 $ ] as well as ( [ rb ] ) and ( [ va ] ) , we obtain @xmath833 which together with ( [ ptro ] ) yields @xmath834 on the other hand , we have by ( [ fidef2 ] ) @xmath835 where we have chosen @xmath836 . using the elementary estimate@xmath837 and its consequence@xmath838 we obtain@xmath839 whence@xmath840 choosing @xmath841 small enough and substituting this estimate to ( [ pts ] ) , we obtain  ( [ uee ] ) .",
    "[ rembdd]it is desirable to have a localized version of theorem [ tdue ] when the hypotheses are assumed for balls of bounded radii and the conclusions are proved for a bounded range of time . as was already mentioned in the proof , kigami s",
    "argument requires the ultracontractivity of @xmath842 for _ all _ balls , and ( [ eff ] ) should also be satisfied for all balls , because , loosely speaking , one deals with the estimate of @xmath843 for an exhausting sequence of balls @xmath844 ( see @xcite or @xcite ) . as we will see in section [ secrvd ] , the hypotheses @xmath845 for all balls imply that the space @xmath33 is unbounded .",
    "note that all other arguments used in this paper do admit localization .",
    "the harnack inequality ( [ condh ] ) is a standing assumption in this subsection .",
    "the main result is proposition [ posc ] that is heavily based on the oscillation inequality of lemma [ lemosc ] .",
    "the latter is considered as a standard consequence of ( [ condh ] ) , but we still provide a full proof to emphasize the use of the precompactness of balls .",
    "[ lemh]let @xmath347 be a precompact ball of radius @xmath557 in @xmath16 . if @xmath846 is harmonic in @xmath347 , and if @xmath847 in @xmath347 for some real constant @xmath841 , then@xmath848 where @xmath15 and @xmath849 are the same constants as in ( [ condh ] ) .",
    "let @xmath850 be a cutoff function of @xmath347 in @xmath16 , that is , @xmath851 and @xmath852 in an open neighborhood of @xmath853 .",
    "the function @xmath854 belongs to @xmath131 and is equal to @xmath855 in @xmath347 .",
    "let us show that @xmath519 is harmonic in @xmath347 .",
    "indeed , for any @xmath856 , we have@xmath857 because @xmath858 by the harmonicity of @xmath52 in @xmath347 , and @xmath859 by the strong locality as @xmath852 in a neighborhood of @xmath860 . applying ( [ condh ] ) to @xmath519",
    ", we obtain ( [ h - a ] ) .    for any function @xmath116 on any set @xmath861 , define the essential oscillation of @xmath116 in @xmath821 by@xmath862 the following statement",
    "is well known for functions in @xmath5 ( see , e.g. , @xcite and  @xcite , lemma 2.3.2 ) .",
    "[ lemosc]there exists @xmath863 such that , for any precompact ball @xmath864 , for any nonnegative harmonic function @xmath52 in @xmath59 , and any @xmath865,@xmath866 where @xmath867 is a positive constant that depends on the constants in ( [ condh ] ) .",
    "fix @xmath50 , and write for simplicity @xmath868",
    ". consider first the case when @xmath869 [ where @xmath849 is a parameter from ( [ condh ] ) ] and set@xmath870 and@xmath871 clearly , @xmath872 . by lemma [ lemh ] , we have@xmath873 that is,@xmath874 similarly , applying lemma [ lemh ] to function @xmath875 , we obtain@xmath876 whence@xmath877 adding up the two inequalities yields@xmath878 whence@xmath879 that is,@xmath880 where @xmath881 . for an arbitrary @xmath882 ,",
    "find a nonnegative integer @xmath421 such that @xmath883 iterating ( [ der ] ) , we obtain@xmath884 note that the constant @xmath15 in ( [ esiu ] ) can be assumed to be big enough , say @xmath885 .",
    "then @xmath886 and ( [ eosc ] ) follows from the previous line with @xmath887 .",
    "[ posc]let @xmath324 be an open subset of @xmath16 such that @xmath502 . fix a function @xmath888 and set @xmath510 .",
    "then , for any precompact ball @xmath889 and all @xmath890$],@xmath891 where @xmath867 is the same constant as in lemma [ lemosc ] and@xmath892    write for simplicity @xmath893 . let us first prove that if @xmath236 , then @xmath894 by lemma [ lg1 - 1 ] , we have for the function @xmath895 that@xmath896 the function @xmath897 is harmonic in @xmath898 by lemma [ lemg - g ] and nonnegative by theorem [ tptom](b ) . by lemma [ lemosc ] , we obtain@xmath899 since @xmath900 , ( [ osc+ ] ) follows by adding up the two previous lines .",
    "for a signed function @xmath116 , write @xmath901 and set@xmath902 then @xmath903 and @xmath904 are nonnegative and @xmath905 , whence it follows that@xmath906 applying ( [ osc+ ] ) separately to @xmath903 and @xmath907 and adding up the inequalities , we obtain  ( [ oscu ] ) .      in this section",
    ", we assume only the basic hypotheses .",
    "if @xmath217 , then , for any @xmath1 , the function @xmath908 is in @xmath909 and satisfies the heat equation@xmath910 where @xmath911 is the strong derivative in @xmath912 of the mapping @xmath913 ; cf .",
    "@xcite and  @xcite , section 4.3 .",
    "the argument in the next lemma is well known in the context of the semigroup theory ( see @xcite ) , and we reproduce it here for the sake of completeness .    for any @xmath914 and all @xmath915 , we have@xmath916 where @xmath917 .",
    "let @xmath918 be spectral resolution in @xmath126 of the operator  @xmath142 .",
    "then we have@xmath919 whence@xmath920 since @xmath921 we obtain@xmath922 which was to be proved",
    ".    in the rest of this section , assume that @xmath9 is the heat kernel with domain  @xmath215 .",
    "[ cdtptl2]for any @xmath1 and @xmath245 , the function @xmath923 is strongly differentiable in @xmath318 and , for all @xmath292,@xmath924    setting @xmath925 for some @xmath81 and using ( [ ptpt ] ) , we obtain that the function@xmath926 satisfies ( [ dudt ] ) , that is,@xmath927 renaming @xmath928 by @xmath100 and @xmath929 by @xmath930 , we finish the proof .",
    "set@xmath931 where the strong derivative @xmath932 is taken with respect to the first variable @xmath60 .",
    "hence , for any @xmath245 and @xmath1 , @xmath933 is an @xmath481-function of @xmath60 .",
    "[ lemqtpt]for all @xmath292 and @xmath245 , we have@xmath934    indeed , we have by ( [ ptpt])@xmath935 since @xmath936 is a bounded operator in @xmath481 , it commutes with the operator @xmath932 of strong derivation . applying the latter to the both sides of the above identity , we obtain  ( [ p ] ) .",
    "[ cdtpt]for all @xmath1 , @xmath245 and @xmath25-a.a .",
    "@xmath209 , @xmath937    by lemma [ lemqtpt ] , we have , for all @xmath245 and @xmath25-a.a .",
    "@xmath209,@xmath938 whence by corollary [ cdtptl2 ] , @xmath939 for any @xmath940 . choosing @xmath941 , we finish the proof of ( [ dtpt ] ) .",
    "it follows easily from the identity@xmath942 that the function @xmath943 is differentiable for all fixed @xmath211 and@xmath944 arguing as in the previous proof , we obtain@xmath945 for all @xmath1 and @xmath211 .",
    "however , for applications we need estimate ( [ dtpt ] ) for the strong derivative @xmath946 rather than for the partial derivative @xmath947 .",
    "[ lemgu]if @xmath324 is an open subset of @xmath16 and if @xmath948 , then , for all @xmath1 and @xmath824 , the function @xmath949 satisfies in @xmath950 the equation@xmath951    by lemma [ lg1 - 1 ] , the green operator @xmath440 is a bounded operator in @xmath330 , and @xmath440 is the inverse operator to @xmath332 .",
    "since the function @xmath952 satisfies the equation @xmath953 , applying @xmath440 proves the claim .      in this subsection",
    "we use the hypotheses @xmath582 .",
    "as it follows from theorem [ tg=>fk ] and proposition [ pdirhk ] , under these hypotheses the heat semigroup @xmath764 is locally ultracontractive .",
    "hence , by theorem  [ tptom ] , for any open set @xmath104 , the heat kernel @xmath364 exists with the domain @xmath350 where @xmath954 is a fixed properly exceptional set ; cf .",
    "the beginning of the proof of theorem [ tdue ] .",
    "[ lemoscpb]let the hypotheses @xmath582 be satisfied , and let @xmath324 be an open subset of @xmath16 .",
    "fix @xmath1 , @xmath955 and set @xmath956 where @xmath32 is the exponent from ( [ fb ] ) , and @xmath867 is the constant from lemma [ lemosc ] .",
    "fix also a point @xmath957 and assume that the ball @xmath958 is precompact , and its closure is contained in @xmath324 .",
    "then@xmath959 where @xmath960 and @xmath15 depends on the constants in @xmath579 and ( [ fb ] ) .    by construction in the proof of theorem [ tptom ] ,",
    "the heat kernel  @xmath364 is obtained as a monotone increasing limit of @xmath394 as @xmath254 where @xmath961 is an exhaustion of @xmath324 by sets @xmath962 that are finite union of balls from a countable base and the convergence is pointwise in @xmath350 .",
    "suppose for a  moment that we have proved ( [ oscpb ] ) for @xmath962 instead of @xmath324 , that is,@xmath963\\\\[-8pt ] & & \\qquad \\leq\\inf_{y\\in b ( x,\\rho ) \\setminus \\mathcal{n}}p_{t}^{u_{n } } ( x , y ) + c\\biggl ( \\frac{\\rho}{\\mathcal { r } ( t ) } \\biggr ) ^{\\theta}\\sup_{y\\in b ( x , r ) \\setminus\\mathcal{n}}p_{t/2}^{u_{n } } ( y , y)\\nonumber\\end{aligned}\\ ] ] [ note that if @xmath420 is large enough , then @xmath964 . replacing on the right - hand side of ( [ ptun ] ) @xmath394 by a larger value @xmath364 and letting @xmath254 on the left - hand side , we obtain ( [ oscpb ] ) .    to prove ( [ ptun ] ) , rename for simplicity @xmath962 into @xmath276 and recall that , by construction in the proof of theorem [ tptom ] , the domain of @xmath371 is @xmath432 where  @xmath433 is a truly exceptional set in @xmath276 , that is contained in @xmath207 .",
    "it follows from corollary [ cesup = sup1 ] , that , for any @xmath965 @xmath966 and a similar identity for @xmath967 and @xmath56 .",
    "hence , it suffices to prove that@xmath968 where@xmath969 set@xmath970 where @xmath932 is the strong derivative in @xmath971 with respect to the variable  @xmath86 . applying corollary [ cdtpt ] to the heat kernel @xmath371",
    ", we obtain , for @xmath25-a.a .",
    "@xmath972,@xmath973 by lemma [ lemgu ] , we have @xmath974 . since for all @xmath975@xmath976 and @xmath882",
    ", we obtain by proposition [ posc ] and @xmath977 that@xmath978 since @xmath979 , we have by ( [ fb])@xmath980 whence it follows that@xmath981 note that this inequality is true for any @xmath557 such that @xmath982 and @xmath983 . choosing @xmath984 , we obtain ( [ oscpb ] ) .",
    "[ tholder]let the hypotheses @xmath985 be satisfied .",
    "then , for any open set @xmath986 , the heat kernel @xmath363 is hlder continuous in @xmath60 and @xmath86 in @xmath350 .",
    "fix @xmath392 , @xmath1 , and choose @xmath987 so small that @xmath988 where @xmath989 is defined by ( [ r= ] ) .",
    "using theorem [ tdue ] , ( [ vd ] ) , and ( [ fb ] ) , we obtain that , for any @xmath990,@xmath991 where we have used that @xmath992 .",
    "therefore , by lemma [ lemoscpb],@xmath993 in particular , if @xmath994 is close enough to @xmath60 , then we have@xmath995 which means that @xmath996 is hlder continuous in @xmath350 .    [ corholder]let the hypotheses @xmath997 be satisfied , and let @xmath638 be a precompact ball , such that @xmath160 . then for all @xmath998 and @xmath100 , such that @xmath999 and for all @xmath1000 , the following estimate holds : @xmath1001    set @xmath1002 . then the condition @xmath1003 from the previous proof is satisfied because @xmath1004 by ( [ r= ] ) and ( [ tror ] )",
    ". hence ,  ( [ pt - pt ] ) follows from ( [ oscptom ] ) .",
    "[ lemdle]assume that @xmath1005 are satisfied",
    ". then there exists @xmath81 such that , for all precompact balls @xmath638 with @xmath160 and for all @xmath1006,@xmath1007    choose @xmath557 from the condition @xmath1008 which implies @xmath1009 and , hence , @xmath1010 .",
    "hence , it suffices to prove that@xmath1011 setting @xmath536 , we have by ( [ ptom])@xmath1012 by corollary [ cef ] , we obtain@xmath1013 whence it follows that , for small enough @xmath1014,@xmath1015 therefore,@xmath1016 where we have used that @xmath1017 . finally , using ( [ rb ] ) and",
    "( [ va ] ) we obtain ( [ pb > ] ) .",
    "[ tnle]assume that the hypotheses @xmath997 are satisfied , and all metric balls in @xmath47 are precompact",
    ". then there exist  @xmath1018 such that[condlle]@xmath1019 for all @xmath623 , @xmath1006 and @xmath1020 , provided @xmath1021 ( see figure [ pic9 ] ) .",
    "consequently , the following    . ]",
    "inequality:[condnle ]    @xmath1022    holds for all @xmath1 and @xmath741 satisfying ( [ dd ] ) .",
    "obviously , ( [ nle ] ) follows from ( [ lle ] ) by letting @xmath1023 , so that it suffices to prove ( [ lle ] ) .",
    "let @xmath998 and @xmath100 be such that@xmath1024 where @xmath1025 is the constant from lemma [ lemdle ] , and @xmath1026 is to be defined below .",
    "then the hypotheses of lemma [ lemdle ] and corollary [ corholder ] are satisfied .",
    "writing for simplicity @xmath626 , we obtain by ( [ lle ] ) and ( [ pt - pt ] ) that , for any @xmath1027,@xmath1028 choosing @xmath1029 sufficiently small , we obtain ( [ lle ] ) .",
    "combining theorems [ tue ] , [ tholder ] and [ tnle ] , we obtain the main result :    [ tmain]if the hypotheses @xmath1030 are satisfied and all metric balls are precompact , then the heat kernel exists , is hlder continuous in @xmath36 , and satisfies ( [ uee ] ) and ( [ nle ] ) .    under the hypotheses of theorem [ tmain ] , assume that the volume function @xmath524 satisfies the uniform estimate@xmath1031 with some @xmath29 , and function @xmath705 be as follows : @xmath1032 where @xmath1033.[remwhysuchexampleexists ? ] then @xmath1034 and the heat kernel satisfies the estimate@xmath1035 it follows that @xmath1036 for any @xmath32 from the interval @xmath1037 .",
    "let us verify that the following upper bound fails:@xmath1038 where @xmath746 .",
    "indeed , by ( [ nle ] ) we have@xmath1022 provided @xmath1039 . assuming that @xmath1040 and setting @xmath1041 we obtain with a prescribed distance @xmath1042 can be guaranteed , provided the space @xmath1043 is connected . ] @xmath1044 while it follows from ( [ ptupbad ] ) that@xmath1045 since @xmath1046 , the exponent of @xmath100 under the exponential is negative so that the right - hand side of ( [ pupab ] ) becomes as @xmath1047 much smaller than that of  ( [ plowab ] ) , which is a contradiction .    another way to see a contradiction is to observe that ( [ ptupbad ] ) implies ( [ eff ] ) with function @xmath1048 ( cf .",
    "@xcite ) , which is incompatible with ( [ eff ] ) with function ( [ f12 ] ) [ although this argument requires the conservativeness of @xmath1049 .",
    "the conclusion is that in general ( [ pupbad ] ) does not imply ( [ ptupbad ] ) . for comparison ,",
    "let us note that if @xmath1050 and the underlying space is a riemannian manifold , then ( [ pupbad ] ) does imply ( [ ptupbad ] ) ; cf .",
    "we say that a sequence @xmath1051 of points in @xmath1052 is an @xmath85-_chain _ between points @xmath79 if@xmath1053    one can view an @xmath85-chain as a sequence of _ chained _ balls @xmath1054 of radii  @xmath85 , that connect @xmath60 and  @xmath86 ; that is , the center of @xmath1055 is @xmath60 , the center of @xmath1056 is  @xmath86 , and the center of @xmath1057 is contained in @xmath1058 for any @xmath1059    -chain connecting @xmath60 and @xmath86 . ]    ( see figure  [ pic8 ] ) .",
    "for any @xmath81 and all @xmath79 , define@xmath1060 where the infimum is taken over all @xmath85-chains @xmath1061 between @xmath36 with arbitrary  @xmath1062 .",
    "it is obvious that @xmath80 is a decreasing left - continuous function of @xmath85 and @xmath1063 furthermore , @xmath1064 it is clear that @xmath82 is an extended metric in the sense that @xmath82 satisfies all the axioms of a metric except for finiteness .",
    "if an @xmath85-chain exists for any two points @xmath36 , then @xmath1065 , and hence @xmath82 is a true metric .",
    "[ lemn]if @xmath1066 for some @xmath79 and @xmath81 , then there exists an @xmath1067-chain @xmath1051 between @xmath36 such that @xmath1068    here stands for the least integer upper bound of the argument .",
    "it follows from ( [ dedef ] ) by the triangle inequality that always @xmath1069 hence , denoting by @xmath84 the minimal value of @xmath1062 for which there exists an @xmath85 chain @xmath1070 between @xmath60 and @xmath86 , we obtain@xmath1071 the number @xmath84 can be also viewed as the minimal number in a  sequence of chained balls of radii @xmath85 connecting @xmath60 and @xmath86 .    proof of lemma [ lemn ] if @xmath1072 , then also @xmath1073 , and hence @xmath1074 is an @xmath85-chain with @xmath1075 .",
    "assume @xmath1076 , and let @xmath1077 be a  @xmath85-chain between @xmath36 , such that@xmath1078 which exists by hypothesis .",
    "set @xmath1079 . then ( [ xixi+1 ] ) implies@xmath1080 whence@xmath1081 if @xmath1082 , then @xmath1083 and @xmath1084 , whence it follows that@xmath1085 hence , there is an index @xmath1086 such that both @xmath1087 and @xmath1088 are smaller than @xmath1089 .",
    "this implies that @xmath1090 so that by removing the point @xmath1091 from the chain we still have an @xmath85-chain . continuing this way , we finally obtain an @xmath85-chain satisfying  ( [ n < ] ) .",
    "if @xmath1092 , then it follows from  ( [ de > ] ) and ( [ fb ] ) that@xmath1093 in this section , we make an additional assumption that , for all @xmath1094,@xmath1095 in particular , ( [ fe ] ) implies the finiteness of @xmath1096 for all @xmath81 .",
    "define the function @xmath1097 as follows:@xmath1098 if @xmath232 , then @xmath1099 . if @xmath1100 , then it follows from ( [ fe ] ) and ( [ fei ] ) that @xmath1101 .",
    "[ lemfe]if ( [ fe ] ) is satisfied , then the function @xmath1102 satisfies the identity@xmath1103 for all distinct @xmath79 and @xmath1 .    since the function @xmath1104 is continuous and @xmath80 is left - continuous in @xmath85 , we have @xmath1105 assume from the contrary that @xmath1106 and note that , for any @xmath1107 , we have by definition of @xmath85 that@xmath1108 on the other hand , @xmath1109 and @xmath1110 hence,@xmath1111 which contradicts ( [ eps ] ) .",
    "[ ttwo]let all metric balls be precompact .",
    "let the hypotheses @xmath1112 and ( [ fe ] ) be satisfied , and let @xmath93 be the function from ( [ epsdef ] ) .",
    "then , for all @xmath741 and @xmath1113 , we have @xmath1114 where @xmath1115 and @xmath1116 for the upper bound in ( [ two ] ) while @xmath1117 is a  small enough positive constant for the lower bound .    the proof of theorem [ ttwo ] is preceded by a lemma .",
    "[ lemdee]for all distinct @xmath79 and @xmath1 , we have@xmath1118 where @xmath1119 .",
    "let us first show that , for all @xmath81 and some @xmath1120 , @xmath1121 by ( [ fidef1 ] ) , we have , for all @xmath51,@xmath1122 choosing @xmath1123 we obtain the right - hand side inequality in ( [ fif ] )",
    ". by ( [ fidef1 ] ) , the left - hand side inequality in ( [ fif ] ) is equivalent to@xmath1124 that is , to@xmath1125 if @xmath1126 , then this is trivially satisfied provided @xmath1127 .",
    "if @xmath1128 , then by ( [ fb ] ) we have@xmath1129 which proves the previous inequality and , hence , ( [ fif ] ) .    putting in ( [ fif ] ) @xmath1130 and using @xmath1131 , which is true by lemma [ lemfe ] , we obtain@xmath1132 whence ( [ df ] ) follows .    proof of theorem [ ttwo ] if @xmath232 , then @xmath1133 , and ( [ two ] ) follows from theorems [ tue ] and [ tnle ] .",
    "assume in the sequel that @xmath1092 .",
    "let us first prove the lower bound in ( [ two ] ) , that is,@xmath1134 by theorem [ tnle ] , we have    @xmath1022    provided @xmath1135 for some @xmath72 .",
    "set @xmath1136 where @xmath1137 will be chosen later .    consider first the case @xmath1138 . by ( [ df ] ) ,",
    "we have@xmath1139 applying ( [ tfi ] ) with @xmath1140 , we obtain@xmath1141 whence by ( [ rb])@xmath1142 provided @xmath1117 is small enough .",
    "since @xmath1143 , we see that the condition  ( [ detr ] ) is satisfied and , hence , ( [ twol ] ) follows from ( [ nle ] ) .",
    "assume now that @xmath1144 .",
    "by lemma [ lemn ] , there is an @xmath85-chain @xmath1145 connecting @xmath60 and @xmath86 and such that@xmath1146 by ( [ semi ] ) , we have@xmath1147\\\\[-8pt ] & \\geq&\\int_{b_{1}}\\cdots\\int_{b_{n-1}}p_{{t / n } } ( z_{0},z_{1})p_{{t / n}}(z_{1},z_{2})\\cdots\\nonumber\\\\ & & \\hspace*{54.8pt}{}\\times   p_{{t / n}}(z_{n-1},z_{n})\\,dz_{1}\\cdots dz_{n-1},\\nonumber\\end{aligned}\\ ] ] where @xmath1148 , @xmath1149 , @xmath1150 .",
    "we will estimate @xmath1151 from below by means of ( [ nle ] ) .",
    "for that , we need to verify the condition@xmath1152 by ( [ te ] ) , we have @xmath1153 it follows from ( [ tze ] ) and ( [ ne ] ) that@xmath1154 whence by ( [ rb ] ) @xmath1155 clearly , if @xmath1117 is small enough , then@xmath1156 since in ( [ chain ] ) @xmath1157 and @xmath1158 , it follows from ( [ ee ] ) that@xmath1159 hence , by ( [ nle ] ) and ( [ va]),@xmath1160 therefore , ( [ chain ] ) implies@xmath1161\\\\[-8pt ] & \\geq&\\frac{\\exp ( -cn ) } { v ( x,\\mathcal{r } ( t ) ) } \\nonumber\\\\ & \\geq&\\frac{\\exp ( -c({d_{\\varepsilon } ( x , y ) } ) /{\\varepsilon } ) } { v ( x,\\mathcal{r } ( t ) ) } .\\nonumber\\end{aligned}\\ ] ] by lemma [ lemdee ] , we have@xmath1162 substituting into ( [ 4 ] ) , we obtain ( [ twol ] ) .",
    "to prove the upper bound in ( [ two ] ) , we basically repeat the proof of theorem  [ tue ] with @xmath24 being replaced by @xmath82 for an appropriate @xmath85 . fix some @xmath81 and",
    "denote by @xmath1163 the ball in the metric @xmath82 .",
    "it follows from ( [ eps > ] ) that @xmath1164 which allows to modify lemma [ pf < exp ] as follows : for all @xmath1165 and @xmath623@xmath1166 provided the values of parameters @xmath557 and @xmath492 satisfy the conditions@xmath1167 indeed , ( [ rr ] ) is analogous to estimate ( [ n ] ) from the proof of lemma [ pf < exp ] for @xmath24-balls , which was proved using @xmath1168 . to repeat the proof for the metric @xmath82 , we need the precompactness of @xmath82-balls , that follows from ( [ de > ] ) , and the condition ( [ eff ] ) for @xmath82-balls of radii @xmath1169 , that follows from ( [ b = b ] ) , provided @xmath1170 .    consequently , the statement of theorem [ tef ] is modified as follows : for all @xmath180 and @xmath714 , @xmath1171 where @xmath1172 indeed , arguing as in ( [ 3a ] ) and using ( [ rr ] ) we obtain that , under the assumptions of ( [ rl]),@xmath1173 setting here @xmath1174 yields@xmath1175 finally , minimizing the right - hand side of ( [ g ] ) in @xmath1176 , we obtain ( [ pg ] ) .",
    "let us show that if @xmath1177 then@xmath1178 we have@xmath1179 whereas@xmath1180 it follows that@xmath1181 which proves ( [ p ] ) .",
    "hence , we can rewrite ( [ pg ] ) in the form @xmath1182 provided the relation ( [ te2 ] ) between @xmath1183 is satisfied .    as in the last part of the proof of theorem [ tue ] , we apply ( [ pg1 ] ) with @xmath1184 for fixed @xmath1020 .",
    "note that in ( [ vrr ] ) @xmath1185 can be replaced by a larger value @xmath1186 .",
    "the rest of the argument goes through unchanged , and we obtain @xmath1187 provided @xmath1188 by ( [ te ] ) , condition ( [ 18 ] ) can be satisfied by setting @xmath1189 .",
    "[ ctwo]under the hypotheses of theorem [ ttwo ] , we have @xmath1190 where @xmath1115 and @xmath1117 is a large enough constant for the upper bound and a small enough positive constant for the lower bound",
    ".    the lower bound in ( [ twod ] ) follows from ( [ 4 ] ) , while the upper bound follows from ( [ ptupe ] ) and @xmath1191 provided @xmath1117 is chosen large enough to ensure @xmath1192 where @xmath14 is the constant from ( [ ptupe ] ) .",
    "estimate ( [ twon ] ) follows then from ( [ nede ] ) .",
    "[ exhk]a good example to illustrate theorem [ ttwo ] and corollary  [ ctwo ] is the class of post critically finite ( p.c.f . )",
    "fractals , where the heat kernel estimate ( [ twon ] ) was proved by hambly and kumagai @xcite . without going into the details of @xcite , let us mention that @xmath19 is the resistance metric on such a fractal @xmath16 , and @xmath25 is the hausdorff measure of @xmath16 of dimension @xmath1193 .",
    "one has in this setting @xmath1194 , in particular ,  ( [ vd ] ) is satisfied .",
    "hambly and kumagai proved that ( [ eff ] ) is satisfied with @xmath1195 where @xmath1196 ; cf .",
    "@xcite , theorem 3.8 . condition ( [ fe ] ) follows from the estimate@xmath1197 proved in @xcite , lemma 3.3 , with @xmath1198 , as ( [ ne < ] ) implies that@xmath1199 the harnack inequality  ( [ condh ] ) on p.c.f .",
    "fractals was proved by kigami  @xcite .",
    "hence , corollary  [ ctwo ] applies and gives on unbounded p.c.f .",
    "fractals estimate  ( [ twon ] ) . the same estimate was proved in  @xcite , theorem 1.1 , for bounded p.c.f .",
    "fractals using a different method .    note that ( [ vd ] ) implies ( [ ne < ] ) with @xmath1200 [ where @xmath31 comes from ( [ va ] ) ] , provided all balls in @xmath16 are connected . indeed , ( [ vd ] ) implies by the classical ball covering argument that any ball of radius @xmath557 can be covered by at most  @xmath1201 balls of radii @xmath1202 .",
    "consequently , any point @xmath1203 can be connected to @xmath60 by a chain of @xmath85-balls containing at most @xmath1201 balls .",
    "taking @xmath1204 we obtain ( [ ne < ] ) with @xmath1200 .",
    "therefore , hypothesis  ( [ fe ] ) is satisfied automatically for @xmath62 with @xmath1205 .",
    "estimate ( [ twon ] ) means that the diffusion process goes from @xmath60 to @xmath86 in time  @xmath100 in the following way .",
    "the process first `` computes '' the value ) is satisfied with @xmath1206 , we obtain from  ( [ te ] ) @xmath1207 whence@xmath1208 and@xmath1209\\end{aligned}\\ ] ] ] of @xmath85 as a  function of @xmath17 , then `` detects '' a shortest chain of @xmath85-balls connecting @xmath60 and @xmath86 and finally goes along that chain ( see figure [ pic10 ] ) .",
    "-balls for two distinct values of @xmath1210 provide different routes for the diffusion from @xmath60 to @xmath86 for two distinct values of time @xmath100 . ]    this phenomenon was first observed by hambly and kumagai on p.c.f .",
    "fractals , but it seems to be generic . hence , to obtain matching upper and lower bounds , one needs , in addition to the usual hypotheses , also the information encoded in the function @xmath84 , namely , the graph distance between  @xmath60 and @xmath86 on any @xmath85-net approximation of @xmath16 .",
    "the statement of theorem [ ttwo ] can be simplified if the metric space @xmath33 possesses an additional property as follows .",
    "we say that a metric space @xmath33 satisfies the _ chain condition _ if there exists a constant @xmath1211 such that , for any positive integer  @xmath420 and for all @xmath79 , there is a sequence @xmath1212 of points in @xmath16 such that @xmath1213 , @xmath1214 and@xmath1215    for example , any geodesic metric satisfies the chain condition .",
    "[ lemde]if @xmath33 satisfies the chain condition , then @xmath101 for any @xmath81 .",
    "indeed , fix @xmath81 and two distinct points @xmath79 , and choose @xmath420 so big that @xmath1216 .",
    "let @xmath1217 be a sequence from the chain condition .",
    "then it is also an @xmath85-chain , whence@xmath1218 which was to be proved .",
    "[ cortwo]let the metric space @xmath33 satisfy the chain condition , and let all metric balls be precompact . if the hypotheses @xmath1219 are satisfied , then , for all @xmath741 and @xmath1 , @xmath1220 where @xmath40 is defined by ( [ fidef1 ] ) .",
    "since by lemma [ lemde ] @xmath101 , condition ( [ fe ] ) is obviously satisfied . since @xmath1221 , we can replace in ( [ two ] ) @xmath82 by @xmath24 , which together with  ( [ fifi ] ) yields ( [ twosided ] ) .",
    "[ remnle ] @xmath1222obviously , estimate ( [ twosided ] ) ( should it be true ) implies  ( [ uee ] ) .",
    "we claim that ( [ twosided ] ) implies also ( [ nle ] ) ; moreover , the parameter @xmath1029 in  ( [ nle ] ) can be chosen to be arbitrarily large , say @xmath1223 .",
    "indeed , we need to show that if@xmath1224 where @xmath1029 is a ( large ) given constant , then@xmath1225 which amounts to@xmath1226 where we have renamed @xmath1227 to @xmath1029 .",
    "indeed , by ( [ fidef1 ] ) we have@xmath1228 so that ( [ txi ] ) is equivalent to@xmath1229 if @xmath1230 , then by ( [ rb])@xmath1231 if the ratio @xmath1232 is large enough then , using @xmath1233 , we obtain that @xmath1234 whence ( [ t / xi ] ) follows .",
    "if @xmath1232 is bounded by a constant , say @xmath1235 ( which includes also the case @xmath1236 ) , then by ( [ rb])@xmath1237 whence ( [ txi ] ) follows again .",
    "we assume only basic hypotheses in this subsection .",
    "moreover , we use neither the locality of @xmath1238 nor the existence of the process @xmath337 .",
    "we state and prove some basic properties of the dirichlet problem in the abstract setting , that will be used in the proof of theorem  [ tconv ] .",
    "fix an open set @xmath104 such that @xmath1239 , and consider the following weak dirichlet problem in @xmath324 : given a function @xmath1240 , find a function @xmath1241 such that@xmath1242 where the second condition is a weak boundary condition and means that @xmath1243 .",
    "[ lemdir1 ] for any @xmath1240 , problem ( [ d ] ) has a unique solution @xmath52 .",
    "if @xmath52 solves ( [ d ] ) and @xmath1244 is another function such that @xmath1245 @xmath1246 then @xmath1247 .",
    "moreover , the identity @xmath1248 holds if and only if @xmath1249 .",
    "\\(a ) the condition @xmath1250 implies that@xmath1251 for all @xmath1252 .",
    "hence , @xmath327 is a hilbert space also with respect to the inner product @xmath1253 .",
    "the harmonicity of @xmath52 in ( [ d ] ) means that @xmath1254 equivalently , this means for the function @xmath1255 that@xmath1256 since @xmath1257 , the functional @xmath1258 is a bounded linear functional in @xmath327 , and equation ( [ vfi ] ) has a unique solution @xmath1259 by the riesz representation theorem .",
    "then @xmath1260 is a unique solution of  ( [ d ] ) .",
    "\\(b ) setting @xmath1261 and noticing that @xmath1262 , we obtain using ( [ ufi])@xmath1263 hence , @xmath1247 , and the equality is attained when @xmath1264 , that is , when @xmath1265 .    in what follows ,",
    "denote by @xmath584 the resolvent operator of ( [ d ] ) , that is , @xmath1266 .",
    "obviously , @xmath584 is a linear operator in @xmath131 . since by lemma [ lemdir1 ] @xmath1267",
    ", we see that the norm of the operator @xmath584 in @xmath131 is bounded by @xmath184 .",
    "[ lemdir2 ] if @xmath119 , then @xmath1268 .",
    "in particular , if @xmath236 , then @xmath1269 .    if @xmath1270 , then also @xmath1271 .",
    "if @xmath1272 is an increasing sequence from @xmath131 and @xmath1273 as @xmath254 , then @xmath1274 a.e . in @xmath324 as @xmath254",
    "\\(a ) the function @xmath1275 is harmonic in @xmath347 and satisfies the boundary condition @xmath1276 @xmath1277 . by @xcite , lemma 4.4 , the latter condition implies @xmath1278 . substituting @xmath1279 into ( [ ufi ] )",
    ", we obtain @xmath1280 . on the other hand , by @xcite ,",
    "lemma 4.3 , @xmath1281 , whence it follows that @xmath1282 and , hence , @xmath1283 .",
    "consequently , @xmath1276 and @xmath1284 .",
    "\\(b ) set @xmath1266 and @xmath1285 so that @xmath1286 and @xmath1287 .",
    "setting @xmath1288 and @xmath1289 , we see that @xmath1290 , @xmath1291 and @xmath1292 . by  @xcite ,",
    "lemma 4.4 , we conclude that @xmath1293 . on the other hand , we have @xmath1294 whence @xmath1295 .",
    "it follows that @xmath1296 . by lemma  [ lemdir1 ]",
    "we conclude that @xmath1297 . since the opposite inequality is true by the definition of a dirichlet form , we see that @xmath1298 .",
    "it follows from lemma [ lemdir1 ] that @xmath1299 , which implies @xmath1300 .",
    "\\(c ) since @xmath584 is a bounded operator in @xmath131 , we see that @xmath1301 as @xmath1302 .",
    "it follows that also @xmath1303 .",
    "then there is a subsequence of @xmath1304 that converges to @xmath1305 almost everywhere in @xmath324 . finally , since the sequence @xmath1306 is monotone increasing , the entire sequence @xmath1306 also converges to  @xmath1305 almost everywhere in @xmath324 .",
    "the next lemma states useful consequences of the main hypotheses and motivates the statement of theorem [ tconv ] below .",
    "it is also used in the proof of corollary [ corue ] .",
    "[ lemconv]let all metric balls be precompact",
    ". then the following implications are true :    ( [ condh ] ) implies that the metric space @xmath33 is connected ;    ( [ eff ] ) implies that the dirichlet form @xmath130 is conservative ;    ( [ eff ] ) implies that @xmath1307 .",
    "\\(a ) assume that @xmath33 is disconnected , and let @xmath324 be a nonempty open subset of @xmath16 such that @xmath1308 is also nonempty and open .",
    "there is a big enough ball @xmath1309 such that the intersections of @xmath1310 both with @xmath324 and @xmath1308 are nonempty , where @xmath849 is the parameter from ( [ condh ] ) .",
    "since @xmath1311 is a compact set , there is a cutoff function @xmath52 of @xmath1311 in @xmath324 ; that is , @xmath1312 and @xmath1313 in a neighborhood of @xmath1311 .",
    "obviously , @xmath1314 in @xmath1308 .",
    "we claim that @xmath52 is harmonic in @xmath347 .",
    "indeed , for every function @xmath1315 , we have @xmath1316 and@xmath1317 since @xmath1318 and , hence , @xmath1313 in a neighborhood of @xmath1319 , we obtain by the strong locality of @xmath1320 that @xmath1321 .",
    "since @xmath1322 and @xmath1323 in @xmath1308 , it follows that @xmath1324 .",
    "hence @xmath511 and @xmath52 is a nonnegative harmonic function in @xmath347 .",
    "however , the function @xmath52 does not satisfy ( [ condh ] ) because @xmath52 takes in @xmath1310 the values @xmath184 and @xmath88 .",
    "\\(b ) by corollary [ cef ] , ( [ eff ] ) implies that@xmath1325 for any @xmath180 , @xmath623 , @xmath1 .",
    "using this estimate and ( [ ptom ] ) , we obtain@xmath1326 as @xmath1023 , we see that @xmath1327 , which proves the stochastic completeness .",
    "\\(c ) if @xmath1328 then @xmath1329 so that the exit time from @xmath1330 is  @xmath89 and @xmath579 fails .      in the next statement , we use weaker versions of ( [ uee ] ) and ( [ nle ] ) that will be denoted by @xmath1331 and @xmath1332 .",
    "namely , in each of these conditions we assume that the heat kernel exists as a measurable integral kernel of the heat semigroup @xmath162 and satisfies the estimates ( [ uee ] ) and ( [ nle ] ) for all @xmath1 and for _ almost _ all @xmath79 .",
    "note that unlike the conditions ( [ uee ] ) and ( [ nle ] ) , their weak versions do not use the diffusion process @xmath1333 .",
    "[ tconv]assume that all metric balls are precompact and@xmath1307",
    ". then the following sets of conditions are equivalent :    @xmath1334 ;    @xmath1335 , and the heat kernel is hlder continuous outside a properly exceptional set ;    @xmath1336 .",
    "note that , by lemma [ lemconv ] , ( i ) implies that @xmath1307 .",
    "however , neither of conditions ( ii ) or ( iii ) implies that @xmath16 is unbounded because ( ii ) is satisfied on any compact riemannian manifold .",
    "proof of theorem [ tconv ] the implication @xmath1337 is contained in theorem [ tmain ] , and the implication @xmath1338 is trivial . in what follows",
    "we prove the implication @xmath1339 .    assuming ( iii ) ,",
    "let us first show that @xmath16 is connected .",
    "indeed , let @xmath16 split into a disjoint union of two nonempty open sets @xmath1340 and @xmath401 . by the continuity of the paths of @xmath1333",
    ", we have @xmath1341 for all @xmath1 and @xmath1342 , @xmath1343 , whereas by ( [ nle ] ) we have @xmath1344 whenever @xmath1345 .",
    "this contradictions proves the connectedness of @xmath16 . by @xcite ,",
    "corollary 5.3 ,  ( [ vd ] ) , the connectedness , and the unboundedness of @xmath16 imply the _ reverse volume doubling _ ( [ rvd ] ) ; that is , the following inequality holds:[condrvd ]    @xmath1346    which holds for all @xmath50 , @xmath569 , with some positive constants @xmath1347 . by  @xcite ,",
    "theorem 2.2 and section 6.4 ( see also @xcite ) , @xmath1348 imply @xmath579 . ) is essential for @xmath1349 ( see @xcite , theorem 2.2 ) .",
    "in fact , it was shown in @xcite and @xcite that @xmath1350 imply also @xmath580 provided the dirichlet form is conservative . in our setting the conservativeness of the dirichlet form can also be proved but a direct proof of @xmath1351 is shorter . ]",
    "let us now prove @xmath1351 , that is , @xmath1352 for all @xmath160 and @xmath623 , where @xmath207 is a properly exceptional set .",
    "it suffices to prove that there is a constant @xmath1353 such that , for any ball @xmath1354,@xmath1355 indeed , the function@xmath1356 is quasi - continuous by @xcite , theorem 4.2.3.[remcheckthisinfot ] by @xcite , proposition 6.1 , if @xmath1357 for almost all @xmath344 , where @xmath841 is a constant and @xmath324 is an open set , then @xmath1358 for all @xmath1359 where @xmath207 is a properly exceptional set .",
    "hence ,  ( [ pbb ] ) implies that@xmath1360 for some properly exceptional set @xmath1361 . taking the union of such sets @xmath1362 where @xmath347 varies over a countable family @xmath821 of all balls with rational radii and whose centers form a dense subset of @xmath16",
    ", we obtain a properly exceptional set @xmath207 such that ( [ pfn ] ) holds for any ball @xmath1363 . approximating any ball @xmath347 from inside by balls of the family @xmath821",
    ", we obtain ( [ pfn ] ) for all balls , which implies ( [ pf ] ) .",
    "now let us prove ( [ pbb ] ) . by the comparison principle of @xcite , proposition  4.7",
    "( see also @xcite , lemma 4.18 ) , we have , for any nonnegative function @xmath1364 , @xmath1365}{\\mathop{\\operatorname{esup}}}_{y\\in b\\setminus({1/2})b}p_{s}f ( y)\\ ] ] for almost all @xmath1366 .",
    "let @xmath1367 be a small positive constant to be specified below , and set @xmath1368 .",
    "it follows from @xmath1332 and ( [ va ] ) that@xmath1369 provided @xmath1006 .",
    "the initial value of @xmath85 is given by the condition @xmath1332 but we are going to further reduce this value of @xmath85 in the course of the proof .",
    "assume that @xmath100 varies in the following interval:@xmath1370 the left - hand side inequality in ( [ tr ] ) implies by ( [ fb ] ) that @xmath1371 chose @xmath1367 from the identity@xmath1372 so that ( [ rt ] ) implies@xmath1373 integrating ( [ infp ] ) over @xmath1374 and using ( [ vd ] ) and ( [ zeta ] ) , we obtain@xmath1375\\\\[-8pt ] & \\geq&c\\zeta^{\\alpha } \\nonumber\\\\ & = & c^{\\prime}\\varepsilon^{\\alpha/\\beta}\\nonumber\\end{aligned}\\ ] ] for almost all @xmath1376",
    ". on the other hand , for almost all @xmath1377 , we have by @xmath1378 and lemma [ lemtifi ] @xmath1379 where we have used that @xmath1380 and @xmath1381 . using ( [ va ] ) and  ( [ fb ] ) we obtain@xmath1382 finally , it follows from ( [ tr ] ) and @xmath1383 that @xmath1384 whence@xmath1385 for almost all @xmath1377 . combining ( [ eqs-2 ] ) , ( [ eqs-4 ] ) and ( [ eqs-3 ] ) , we obtain , for almost all @xmath1386,@xmath1387}{\\mathop{\\operatorname{esup}}}_{b\\setminus k}p_{s}f \\\\ & \\geq&c^{\\prime}\\varepsilon^{\\alpha/\\beta}-c\\biggl ( \\frac { 1}{\\varepsilon } \\biggr ) ^{\\alpha/\\beta}\\exp\\biggl ( -c\\biggl ( \\frac{1}{\\varepsilon } \\biggr ) ^{{1}/({\\beta^{\\prime}-1})}\\biggr ) \\\\ & \\geq&\\frac{1}{2}c{^{\\prime}}\\varepsilon^{\\alpha/\\beta},\\end{aligned}\\ ] ] provided @xmath85 is chosen small enough .",
    "the path @xmath1388 is a continuous path in @xmath1389 and , hence , can be integrated in @xmath100 .",
    "it follows from the previous inequality that@xmath1390 which finishes the proof of @xmath1351 .",
    "we are left to prove that @xmath1391 . by @xcite , theorem 3.1 ( see also @xcite and @xcite , theorem 5.3 ) , @xmath1392 imply the _ parabolic _ harnack inequality for bounded caloric function and , hence , the harnack inequality ( [ condh ] ) for bounded harmonic functions ( note that this result uses the precompactness of the balls ) .",
    "we still have to obtain ( [ condh ] ) for all nonnegative harmonic functions .",
    "note that by @xcite , theorem 2.1 , @xmath1393 in particular , for any ball @xmath347 , we have @xmath1394 . given a function @xmath500 that is nonnegative and harmonic in a ball @xmath1309 , set @xmath1395 for any @xmath262 , and denote by @xmath1396 the solution of the dirichlet problem@xmath1397 cf .",
    "section [ secharm ] . since @xmath1398",
    ", we have also @xmath1399 . since the sequence  @xmath1400 increases and @xmath1401 ( cf .",
    "@xcite , theorem 1.4.2 ) , it follows by lemma  [ lemdir2 ] that @xmath1402 almost everywhere in @xmath347 .",
    "each function @xmath1396 is bounded and , hence , satisfies the harnack inequality in @xmath347 , that is,@xmath1403 replacing in the right - hand side @xmath1396 by a larger function @xmath52 and passing to the limit in the left - hand side as @xmath254 , we obtain the same inequality for  @xmath52 , which was to be proved .",
    "[ corue]assume that all metric balls are precompact , @xmath1404 , and the dirichlet form @xmath1320 is conservative .",
    "then the following sets of conditions are equivalent :    @xmath1405 ;    @xmath1406 .    in the view of theorem [ tconv ]",
    ", it suffices to prove that @xmath1407 . by lemma [ lemconv ] ,",
    "( [ condh ] ) implies the connectedness of @xmath16 . by @xcite , corollary  5.3 ,",
    "@xmath1408 provided @xmath16 is connected and unbounded , which is the case now .",
    "by @xcite , theorem 2.2 , the conservativeness and @xmath1409 imply ( [ eff ] ) .",
    "many equivalent conditions for @xmath1410 were proved in @xcite under the standing assumptions @xmath1411 and the conservativeness of @xmath1412 .",
    "of course , each of these conditions can replace @xmath1378 in the statement of corollary [ corue ] .",
    "[ corunbound]assume that all metric balls are precompact , @xmath1307 , and @xmath33 satisfies the chain condition .",
    "then the following two sets of conditions are equivalent :    @xmath1030 ;    the heat kernel exists and satisfies the two - sided estimate ( [ twosided ] ) .    the implication @xmath1413 is contained in corollary [ cortwo ] .",
    "let us prove the implication @xmath1414 .",
    "estimate ( [ twosided ] ) implies ( [ uee ] ) as well as  ( [ nle ] ) with any value of @xmath1029 , in particular , @xmath1223 ; cf .",
    "remark [ remnle ] .",
    "by @xcite , lemma 4.1 , ( [ nle ] ) with @xmath1223 implies ( [ vd ] ) .",
    "finally , by theorem [ tconv ] , we obtain @xmath1415 .",
    "we briefly list the lettered conditions used in this paper with references to the appropriate places in the main body .",
    "@xmath1416 ( section [ secharnack ] ) ;    @xmath1417 ( section [ secharnack ] ) ;    @xmath1418 ( section [ secef ] ) ;    @xmath1419 ( section [ secef ] ) ;    @xmath1420 ( section [ secdue ] ) ;    @xmath1421 provided @xmath1422 ( section [ seclow ] ) ;    @xmath1423 ( section [ secrvd ] ) .",
    "the authors thank martin barlow , jiaxin hu , jun kigami , takashi kumagai and alexander teplyaev for valuable conversations on the topics of this paper .",
    "the authors are grateful to the unnamed referees for careful reading of the manuscript and for the useful remarks ."
  ],
  "abstract_text": [
    "<S> we prove equivalent conditions for two - sided sub - gaussian estimates of heat kernels on metric measure spaces .    and    .    </S>"
  ]
}