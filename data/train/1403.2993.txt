{
  "article_text": [
    "ground - based gamma - ray astronomy exploits the air shower produced by the interaction of a primary gamma ray in the earth s atmosphere . for gamma - rays of approximately @xmath0 ev ( vhe ) few air - shower particles",
    "reach ground level",
    ". however , sufficiently high - energy secondary particles will emit cherenkov radiation , resulting in illumination of a @xmath110@xmath2 m@xmath3 patch of ground for a few nanoseconds . the imaging atmospheric cherenkov technique ( iact )",
    "is based on the observation of this emission by a number of large reflecting telescopes , placed within the light pool with a typical spacing of @xmath1100  m. the cherenkov light is focussed onto ultra - fast , but typically rather coarsely pixelated , cameras , resulting in roughly elliptical images of the shower emission in multiple telescopes .",
    "@xcite is an array of four such 100m@xmath3 reflecting telescopes , at 1800 m altitude in the khomas highlands of namibia , each with a 960 pixel camera viewing a 5@xmath4 diameter patch of sky .",
    "the process of reconstruction / estimation of the properties of the primary photon ( direction and energy ) , and the rejection of events likely to belong to the background of hadronic showers , makes use of image information from each telescope .",
    "traditionally this event reconstruction is performed using the _ hillas _ parameters of the camera images  @xcite , derived after an image cleaning step ( described in @xcite ) .",
    "the hillas parameters are the moments of the camera image which , given the approximately elliptical nature of typical camera images , already capture much of the available image information . in the most commonly used stereoscopic reconstruction method",
    "the major axes of images are calculated in a common camera reference frame and the intersection points of all axes found . a weighted average ( based on image amplitude and the angle between the axes )",
    "is then taken of all crossing points to provide an estimate of the arrival direction of the primary gamma - ray .",
    "a similar procedure involving the intersections of the directions between the image centroid and the optical axis is then performed in a common plane perpendicular to the pointing direction , to determine the shower impact point on the ground .    although relatively good angular resolution ( @xmath10.1@xmath4 with h.e.s.s . )",
    "can be reached with such a reconstruction procedure  @xcite , significant additional information can be extracted from the recorded images in a typical event , resulting in improved performance .",
    "additionally a simultaneous fit procedure between all telescopes can help to ensure a consistent result is found between all telescopes , rather than the independent analysis used in hillas reconstruction .",
    "an image template fitting procedure was pioneered for the cat telescope @xcite @xcite and re - implemented and improved upon for h.e.s.s .",
    "these methods begin with the creation of a semi - analytical model of air - shower development and iact response , and use this model to generate the expected shower image for a given set of shower parameters ( primary energy and direction , and also impact distance of the shower from the telescope ) .",
    "the template library can then be compared to the images recorded in a given event , and , by means of a multi - dimensional fit procedure , the best - fit shower parameters determined .",
    "an alternative method of shower fitting has also been developed for use with h.e.s.s .",
    "data , fitting the pixel intensities of the camera image with the expectation from a simpler analytical 3 dimensional gaussian air shower model ( 3d model ) @xcite .",
    "one of the major problems with the _ model _ and 3d model analyses is the difficulty of describing the air shower behaviour at high energies ( @xmath510tev ) . above 10tev",
    "a large number of particles reach ground level , resulting in large fluctuations which are difficult to reproduce with the aforementioned approaches .",
    "this difficultly in reproducing energetic air showers results in poor event reconstruction above 10tev , typically leading to a rapid drop in effective collection area . with these approaches",
    "it is also difficult to account for instrumental effects , such as the optical point spread function of the telescopes or the limited readout window of the camera , so approximations of these effects must be made . inevitably , making these kind of assumptions will limit the quality of the model fit , reducing the accuracy of the analysis .    one way to solve these problems with high energy events",
    "is to instead produce templates by the use of detailed monte carlo ( mc ) based air shower simulations .",
    "such an approach requires no analytical approximations to be made within the air shower simulation , and therefore takes better into account the large fluctuations arising from particles reaching ground level .",
    "additionally , a more accurate optics and electronics simulation can be performed on the simulated cherenkov photons , resulting a more realistic representation of the telescope behaviour .",
    "the mc approach is a robust and general image template generation method , not requiring any adaptation to the model for different telescope types , instead existing monte carlo telescope configurations can be adapted to produce templates .    below",
    "we present an attempt to improve the accuracy of the template generation , by the use of a more accurate monte carlo simulation based air shower model , combined with a ray - tracing telescope simulation and demonstrate the resultant improvement in the performance of the analysis .",
    "in contrast to the semi - analytical model of shower development used in @xcite & @xcite to generate image templates , we use instead the corsika/_sim_telarray _",
    "chain @xcite to perform a monte carlo air shower simulation , followed by ray - tracing of the telescope optics and simulation of the instrument electronics . the use of this very detailed and computing intensive simulation chain has several major benefits over the , faster , semi - analytical approach .",
    "firstly , the corsika air shower simulation is a well proven code , which has been shown to be consistent with the results of multiple experiments , in combination with the _ sim_telarray _ telescope simulation it has been shown to accurately reproduce results from h.e.s.s .. the use of a complete air shower simulation also allows the effects of the geomagnetic field on the air shower to be incorporated , which proves difficult in analytical models .",
    "finally the simulation of the electronics chain using _",
    "sim_telarray _ allows instrumental effects , such as trigger biases and readout window length ( very important in the case of h.e.s.s . ) to be naturally accounted for .",
    "there are , however , some drawbacks to the mc approach , firstly , in order to fill the same parameter space of templates , a significantly larger computing time is required , due to the cpu intensive nature of mc simulations .",
    "also , with such a random approach the edges of the parameters space are naturally sparsely populated , making the fitting of unusual events more difficult .",
    "this issue of phase space coverage was most apparent close to the array trigger threshold , where an extremely large number of event simulations were required in order to reproduce the relatively few up - fluctuations that trigger the array .",
    "full mc simulation of a number of air showers ( 300,000  600 depending on the primary gamma - ray energy ) were performed for a given event parameter set and traced through the simulation of the optics . any photons reaching the focal plane in an event that triggers the camera were then given a weight in order to account for a number of instrumental effects and efficiencies ( e.g. mirror reflectivity , quantum efficiency , integration time window ) , such that they represent a number of detected photoelectrons ( p.e . ) .",
    "the average image for a given set of shower parameters was then saved in the form of a finely binned histogram , containing the expected image in a ` perfect ' camera .",
    "these histograms were then oversampled with the camera pixel size , producing lookup tables for the expected image amplitude at all pixel positions within the camera ( see figure  [ fig - templates ] ) .",
    "this procedure was repeated at points in a four - dimensional parameter space ( described below ) to produce a comprehensive library of image templates .    * 8 zenith angles ( 0 - 65@xmath4 ) * 2 azimuth angles * 17 energies ( 0.08 - 100tev)/@xmath6 * 25 impact distances ( 0 - 1000 m )    additionally events were binned in a number of bins of x@xmath7 , of width 25 g@xmath8 spread around the expected x@xmath9 for a shower of that energy . in total",
    "such a scheme should produce over 100,000 image templates , however in practice the number was somewhat smaller ( less than half this total ) , as templates with insufficient cherenkov photon statistics were discarded . a multidimensional linear interpolation algorithm",
    "was then used to interpolate between these templates , allowing an expected image template to be produced for any shower parameters within the above ranges .",
    "an additional parameter ignored here is the position of the gamma - ray source within the camera field of view , which could be important due to the broadening of the telescopes optical point spread function ( psf ) with distance from the camera centre .",
    "however for h.e.s.s .",
    ", with its davies - cotton optics @xcite , the psf does not degrade significantly across the field of view , so events simulated on axis are sufficient in most cases .",
    "once the full set of templates for the range of possible shower parameters has been created , they must then be compared with the observed image and a fit performed to find the shower parameters that best fit the observed event .",
    "the comparison between the expected and measured images is made using the likelihood function developed in @xcite .",
    "this likelihood of a signal @xmath10 given an expectation of @xmath11 consists of a convolution of the poisson distribution of each individual photoelectron @xmath12 , with the resolution of the photosensor .",
    "where the resolution of the photosensor is represented by a gaussian of width @xmath13 , where @xmath14 is the width of the pedestal ( charge distribution from night sky background light and electronic noise ) and @xmath15 is the width of the single photoelectron distribution ( @xmath160.5 in h.e.s.s . ) .",
    "@xmath17    the log - likelihood for that pixel is then defined such that it is distributed similarly to a @xmath18 distribution .",
    "@xmath19    in cases of large signal expectation ( @xmath20 ) the poissonian signal fluctuations can be replaced by a gaussian , eliminating the need to perform the sum over all photoelectrons .",
    "@xmath21    more detailed derivations of equations [ eqn - like ] & [ eqn - likegaus ] can be found in @xcite .    it should be noted that when calculating the likelihood that two different gain channels are used within the h.e.s.s",
    "the high gain channel covering the range of @xmath10 - 150 p.e . and the low gain channel used above .",
    "these two channels have different levels of electronic noise and hence different pedestal widths ( around 0.2 p.e . for low gain and 1 p.e . for high gain @xcite",
    ") these pedestal values are broadened further during observations by the presence of night sky background light . however , in practice the contribution of the pedestal to the low gain channel ( used for large signals ) is small , only having an effect in pixels where the high gain channel is unavailable .",
    "once this per pixel likelihood function has been defined it can be simply summed over all significant pixels , selected based on the two level tail cut described in @xcite , with two additional rows of pixels added around the image edge , and summed over all telescopes passing selection cuts to find an event likelihood for a given set of shower parameters .",
    "this event likelihood must then be minimised in a 6-dimensional fit over direction , impact point , @xmath22 and primary energy . in order to simplify the reconstruction of @xmath22",
    "it is first reconstructed using a geometrical approach , assuming depth of maximum corresponds to the brightest point in the image ( calculated by taking the average position of the brightest 3 camera pixels ) .",
    "the minimisation can then be performed over a modification factor to the estimated @xmath22 , greatly reducing the time taken for the fit procedure .",
    "fitting is performed using the widely - used minuit @xcite package , providing a fast and reliable minimisation .",
    "the algorithm finds a function minimum in the majority of cases , typically taking around 500 function calls to reach the minimum , with a computation time of @xmath10.2 - 0.5 seconds .",
    "with such a high dimensionality , using an appropriate seed position for the fit is crucial to avoid getting trapped in a local minimum .",
    "multiple hillas - style reconstructions using different image cleaning values are used to generate possible fit seed positions , in addition to a the axis reconstructed using the _ disp _ method @xcite .",
    "several steps are then made using a simple steepest descent algorithm from each seed position to allow the fit to approach the closest minimum and the position with the highest likelihood used to seed the minuit fit .",
    "figure [ fig - likesurf ] shows a 2 dimensional projection of the likelihood surface in the camera plane .",
    "this example event demonstrates the smoothness and well defined minimum of the likelihood surface . in this case",
    "the migrad algorithm is able to find the minimum point in this function at a more accurate position than the hillas - based reconstruction .      in order to create a useful goodness of fit statistic",
    "it is necessary to know the average behaviour of the likelihood function , so that a comparison to the resultant log - likelihood of the fit can be made .",
    "the average log - likelihood for a given @xmath11 , @xmath23 and @xmath15 can be calculated as below :    @xmath24    again in the case of large signals this formula can be greatly simplified to its gaussian limit .",
    "@xmath25    more detailed derivations of equations [ eqn - likeav ] & [ eqn - likeavgaus ] can be found in @xcite .",
    "as equation [ eqn - likeav ] contains an integral with no analytical solution it would be expensive to compute this value on the fly , instead it is preferable to compute this value before the analysis , storing the values in lookup tables as the difference from the gaussian expectation .",
    "this average behaviour can then be compared with the fit result to produce a goodness - of - fit statistic ( @xmath26 ) .",
    "@xmath27 } { \\sqrt { 2 \\times   \\rm{ndf } } } \\ ] ]    this value is constructed such that if all pixels behave like independent random variables the resultant distribution should be gaussian in form and centred at 0 .",
    "however , figure [ gdist ] shows that this is not the case , with a long tail of high g values being seen at high energies and small impact distance .",
    "this tail originates from high - energy showers at small impact distance , where visible sub - structure within the shower produces correlated fluctuations in multiple pixels .",
    "it should also be noted that the peak of the g distribution is affected by the level of night sky background ( nsb ) .",
    ".image selection and background rejection cuts for the three h.e.s.s .",
    "cut configurations compared in this paper .",
    "[ cols=\"^,^,^,^\",options=\"header \" , ]",
    "the previous section has made detailed comparisons of the impact reconstruction method with a _",
    "hillas parameter _ based method showing large improvements in sensitivity , however some comparison to the similar _ model _ analysis must also be made .",
    "however , it must be noted that the simulations used in the impact results and those in the _ model _ results were produced with different simulation chains and there may be some systematic differences between the results of the two chains ( typically at the 5% level in total cherenkov yield @xcite ) .",
    "figure [ fig - modelcomp ] shows a comparison between the angular resolution of the impact analysis and the _ model _",
    "analysis for standard cuts in both analyses .",
    "it can be seen in this plot that at low energies the angular resolution of the impact reconstruction is similar to that of the _ model _ analysis .",
    "this similarity is expected due to the good description of the air shower by the semi - analytical model at low energies and the relative similarity of the fit procedure . however , at higher energies the angular resolution of the impact reconstruction is somewhat improved over that of _ model _ , due to difficultly of reproducing the behaviour of air showers with the semi - analytical model .",
    "this improvement can also be seen in the post - cuts effective area at high energies , with the rapid drop - off in effective area demonstrating the difficultly of the _ model _ analysis to reconstruct events at high energies , where no such problem exists for impact . above 10tev h.e.s.s .",
    "observations are typically in the statistics limited regime , such an improvement in high energy effective area should linearly translate into an improvement in sensitivity .",
    "we have demonstrated a high performance likelihood - based reconstruction method for the h.e.s.s . telescope , based on expected image templates generated from monte carlo air shower simulations .",
    "this technique has been proven to be extremely successful , reconstructing events with significantly more accuracy than the standard reconstruction algorithm .",
    "some improvement has also been demonstrated over the _ model _ reconstruction , especially at the highest energies where semi - analytical modelling of the air shower becomes difficult .",
    "use of the impact reconstruction is able to provide an sensitivity improvement of around a factor of 2 in observation time over traditional _",
    "hillas - based _",
    "reconstruction for point source observations .",
    "additionally the improvement in angular resolution offers more detailed imaging of extended sources .",
    "although some performance improvements have been shown over the existing , semi - analytical model based approach to template generation , the major advantage of production via mc simulation is the robustness of this approach against changes in telescope hardware .",
    "for example the h.e.s.s .",
    "observatory has recently commissioned a fifth 26 m diameter telescope ( ct5 ) at the centre of the array , which requires the production of a new set of image templates .",
    "in order to generate these new templates one can simply re - run the template generation step using the ct5 simulation configuration , whereas using a model based approach the model must be changed to accurately reflect the new hardware .",
    "this robustness will be especially important for the next generation of cherenkov telescopes , such as the cherenkov telescope array , which plan to use multiple telescope types within the same array .",
    "additionally , this template generation mechanism can in principle be implemented to allow reconstruction of any particle type . in the case of protons the large shower to shower fluctuations present may make this difficult , however for other particles such as electrons or iron nuclei it may be possible to reconstruct and separate events using this method .",
    "we thank prof . c stegmann , spokesperson for the h.e.s.s .",
    "collaboration and prof g. fontaine , chairperson of the collaboration board , for allowing us to use data from the h.e.s.s .",
    "array in this publication .",
    "we would like to thank dr .",
    "v. marandon and dr .",
    "k. bernlhr for technical assistance in the implementation of the analysis .",
    "finally we would like to thank the h.e.s.s .",
    "collaboration for useful discussion of the analysis procedure ."
  ],
  "abstract_text": [
    "<S> we present a high - performance event reconstruction algorithm : an image pixel - wise fit for atmospheric cherenkov telescopes ( impact ) . </S>",
    "<S> the reconstruction algorithm is based around the likelihood fitting of camera pixel amplitudes to an expected image template . </S>",
    "<S> a maximum likelihood fit is performed to find the best - fit shower parameters . </S>",
    "<S> a related reconstruction algorithm has already been shown to provide significant improvements over traditional reconstruction for both the cat and h.e.s.s . </S>",
    "<S> experiments . </S>",
    "<S> we demonstrate a significant improvement to the template generation step of the procedure , by the use of a full monte carlo air shower simulation in combination with a ray - tracing optics simulation to more accurately model the expected camera images . </S>",
    "<S> this reconstruction step is combined with an mva - based background rejection .    </S>",
    "<S> examples are shown of the performance of the impact analysis on both simulated and measured ( from a strong vhe source ) gamma - ray data from the h.e.s.s . </S>",
    "<S> array , demonstrating an improvement in sensitivity of more than a factor two in observation time over traditional image moments - fitting methods , with comparable performance to previous likelihood fitting analyses . </S>",
    "<S> impact is a particularly promising approach for future large arrays such as the cherenkov telescope array ( cta ) due to its improved high - energy performance and suitability for arrays of mixed telescope types .    </S>",
    "<S> gamma - ray astronomy ; iact ; analysis technique ; cherenkov technique </S>"
  ]
}