{
  "article_text": [
    "power transfer ( wpt ) via radio - frequency radiation has a long history that is nowadays attracting more and more attention .",
    "rf radiation has indeed become a viable source for energy harvesting with clear applications in wireless sensor networks ( wsn ) and internet of things ( iot ) @xcite .",
    "the major challenge facing far - field wireless power designers is to find ways to increase the dc power level at the output of the rectenna without increasing the transmit power , and for devices located tens to hundreds of meters away from the transmitter .",
    "to that end , the vast majority of the technical efforts in the literature have been devoted to the design of efficient rectennas , a.o .",
    "a rectenna harvests ambient electromagnetic energy , then rectifies and filters it ( using a diode and a low pass filter ) . the recovered dc power then either powers a low power device directly , or is stored in a super capacitor for higher power low duty - cycle operation .",
    "interestingly , the overall rf - to - dc conversion efficiency of the rectenna is not only a function of its design but also of its input waveform .",
    "however , the waveform design has received less attention @xcite . in @xcite",
    ", a multisine signal excitation is shown through analysis , simulations and measurements to enhance the dc power and rf - to - dc conversion efficiency over a single sinewave signal . in @xcite , various input waveforms ( ofdm , white noise , chaotic )",
    "are considered and experiments show that waveforms with high peak to average power ratio ( papr ) increase rf - to - dc conversion efficiency .",
    "even though those papers provide some useful insights into the impact of waveform design onto wpt performance , there are many limitations in the wpt waveform design literature : 1 ) there has not been any formal tool to design and optimize waveforms for wpt so far , 2 ) multipath fading ( well known in wireless communications ) has been ignored despite its tremendous impact on the received waveform at the input of the rectenna , 3 ) the channel state information ( csi ) is assumed unknown to the transmitter , 4 ) the transmitter is commonly equipped with a single antenna and 5 ) a single rectenna is considered .    in this paper",
    "we address the important problem of waveform design for wpt and tackle all the aforementioned limitations .",
    "we focus on multisine waveforms due to their tractability and usefulness in wireless communication systems .",
    "the contributions of the paper are summarized as follows .",
    "first , we introduce a simple and tractable analytical model of the rectenna non - linearity through the second and higher order terms in the taylor expansion of the diode characteristics .",
    "comparison is made with a linear model , first introduced in @xcite and nowadays popular in simultaneous wireless information and power transfer ( swipt ) , e.g. @xcite and subsequent works , that only accounts for the second order term .",
    "second , assuming perfect csi at the transmitter ( csit ) can be attained and making use of the rectenna model , we design multi - antenna multisine wpt waveform for transmission over a multipath channel .",
    "we formulate an optimization problem to adaptively change the waveform weights as a function of the csi so as to maximize the rectenna output dc current .",
    "the global optimal phases of the multisine waveform weights are obtained in closed form while the amplitudes ( not guaranteed to be global optimal ) result from a non - convex posynomial maximization problem subject to a power constraint .",
    "third , the use of a linear or non - linear model of the rectenna is shown to lead to very different wpt system design .",
    "while the linear model favours a narrowband power allocation ( over a single frequency ) , the non - linear model favours a wideband power allocation ( over multiple frequencies ) .",
    "fourth , the waveform design is generalized to multi - rectenna wpt and to account for papr constraints . the design results from a signomial maximization problem .",
    "fifth , scaling laws of the harvested energy with various waveforms are analytically derived as a function of the number of sinewaves @xmath0 , the number of transmit antennas @xmath1 and the progagation conditions . we show for instance that in frequency - flat and frequency - selective channels and for a fixed transmit power constraint , the dc current at the output of the rectifier theoretically increases linearly with @xmath0 if the non - linear model is used for waveform design .",
    "interestingly , while such a scaling law is achievable in frequency - flat channels without csit , it is achievable in frequency - selective channels only in the presence of csit . on the other hand , with a design based on the linear model , the dc current increases at most logarithmically with @xmath0 .",
    "the results also motivate the usefulness of transmitting multisine waveforms and acquiring csit in wpt , especially in frequency - selective channels .",
    "sixth , the waveforms designed for wpt , adaptive to the csi and accounting for the rectifier non - linearity , are shown through realistic circuit evaluations to provide significant gains over state - of - the - art waveforms and over those optimized based on the linear model of the rectifier .",
    "moreover , while the non - linear model is validated by circuit simulations , the linear model is shown to be inaccurate and unable to predict correctly the multisine waveform performance .    as a main takeaway observation ,",
    "the results highlight the importance of modeling and accounting for the non - linearity of the rectenna in any design and evaluations of system involving wireless power .",
    "_ organization : _ section [ system_model ] introduces the system model and section [ section_eh ] models the rectenna . section [ section_waveform ] tackles the waveform optimization for a single and multiple rectennas , with and without papr constraints .",
    "section [ section_scaling_law ] analytically derives the scaling laws of the harvested energy .",
    "section [ simulations ] evaluates the performance and section [ conclusions ] concludes the work .    _",
    "notations : _ bold lower and upper case letters stand for vectors and matrices respectively .",
    "a symbol not in bold font represents a scalar .",
    "@xmath2 and @xmath3 refer to the norm and frobenius norm of a vector and matrix , respectively .",
    "@xmath4 is the expectation / averaging operator .",
    "@xmath5 , @xmath6 and @xmath7 refer to the conjugate , transpose and conjugate transpose of a matrix , respectively . @xmath8 and",
    "@xmath9 refer to the @xmath10 vector with entries equal to @xmath11 and @xmath12 , respectively .",
    "@xmath13 refers to the largest eigenvalue of a matrix .",
    "@xmath14 is in base @xmath15 .",
    "@xmath16 is the cardinality of set @xmath17 .",
    "@xmath18 means approximately equal as @xmath0 grows large .",
    "consider a transmitter with @xmath1 antennas and @xmath0 sinewaves whose transmit signal at time @xmath19 on antenna @xmath20 is given by @xmath21 with @xmath22 where @xmath23 and @xmath24 refer to the amplitude and phase of the @xmath25 sinewave at frequency @xmath26 on transmit antenna @xmath20 , respectively .",
    "we assume for simplicity that the frequencies are evenly spaced , i.e.  @xmath27 with @xmath28 the frequency spacing .",
    "the magnitudes and phases of the sinewaves can be collected into matrices @xmath29 and @xmath30 .",
    "the @xmath31 entry of @xmath29 and @xmath30 write as @xmath23 and @xmath24 , respectively .",
    "the @xmath32 column of @xmath29 is denoted as @xmath33 .",
    "the transmitter is subject to a transmit power constraint @xmath34 .",
    "stacking up all transmit signals , we can write the transmit signal vector as @xmath35 where @xmath36^t$ ] and @xmath37 should not be confused with @xmath26 . ] .",
    "the multi - antenna transmitted sinewaves propagate through a multipath channel , characterized by @xmath38 paths whose delay , amplitude , phase and direction of departure ( chosen with respect to the array axis ) are respectively denoted as @xmath39 , @xmath40 , @xmath41 and @xmath42 , @xmath43 .",
    "we assume transmit antennas are closely located so that @xmath39 , @xmath40 and @xmath41 are the same for all transmit antennas ( assumption of a narrowband balanced array ) @xcite . denoting @xmath44 with @xmath45 the phase shift between the @xmath32 transmit antenna and the first one where @xmath46 is the inter - element spacing , @xmath47 the wavelength of the @xmath25 sinewave . ] , the signal transmitted by antenna @xmath20 and received at the single - antenna receiver after multipath propagation can be written as @xmath48 where the amplitude @xmath49 and the phase @xmath50 are such that @xmath51 with @xmath52 the frequency response of the channel of antenna @xmath20 at @xmath26 .",
    "the vector channel is defined as @xmath53 $ ] .",
    "the total received signal comprises the sum of over all transmit antennas , namely @xmath54 where @xmath55 .",
    "we derive a simple and tractable model of the rectenna circuit and express the output dc current as a function of the waveform parameters .",
    "the model relies on several assumptions made to make the model tractable and be able to optimize the waveforms .",
    "performance evaluations will be conducted in section [ simulations ] using a more accurate circuit simulator .",
    "assume a rectenna whose input impedance @xmath56 is connected to a receiving antenna as in fig [ antenna_model ] .",
    "the signal @xmath57 impinging on the antenna has an average power @xmath58 .",
    "following @xcite , the antenna is assumed lossless and modeled as an equivalent voltage source @xmath59 in series with an impedance @xmath60 , as illustrated in fig [ antenna_model ] .    with perfect matching ( @xmath61 ) ,",
    "the received power @xmath62 is completely transferred to the rectenna s input impedance such that @xmath63 where @xmath64 is the rectifier s input voltage . under perfect",
    "matching , @xmath64 is half of @xmath59 and both can be related to the received signal @xmath57 as @xmath65 and @xmath66 , such that @xmath67 .",
    "we also assume that the antenna noise is too small to be harvested so as no antenna noise term is added and @xmath64 is delivered as such to the rectifier .",
    "a rectifier is always made of a non - linear device ( e.g.  diode ) followed by a low pass filter ( lpf ) with load @xcite .",
    "a simplified rectifier circuit is illustrated in fig [ antenna_model ] .",
    "we assume that its input impedance has been perfectly matched to the antenna impedance .",
    "the current @xmath68 flowing through an ideal diode ( neglecting its series resistance ) relates to the voltage drop across the diode @xmath69 as @xmath70 where @xmath71 is the reverse bias saturation current , @xmath72 is the thermal voltage , @xmath73 is the ideality factor ( assumed equal to @xmath74 ) . in order to express the non - linearity of the diode ,",
    "we take a taylor expansion of the exponential function around a fixed operating voltage drop @xmath75 such that the diode current can be equivalently written as @xmath76 where @xmath77 and @xmath78 , @xmath79 .",
    "the taylor series expansion model is a small signal model that is valid only for the non - linear operation region of the diode .",
    "if the input voltage amplitude becomes large , the diode will be driven into the large signal operation region where the diode behaviour is dominated by the diode series resistance and the i - v relationship is linear @xcite .    as such , it is not easy to infer from the exact dependencies of the diode current on the waveform parameters since both @xmath64 and @xmath80 will depend and fluctuate over time as a function of the waveform . nevertheless , assuming a steady - state response ,",
    "an ideal rectifier would deliver a constant ( over time ) output voltage @xmath81 whose level would depend on the peaks of the input voltage @xmath64 @xcite . as a consequence , the output current delivered to the load @xmath82 would also be constant . in this ideal rectifier , since @xmath81 is a constant ( we drop the time dependency ) , a suitable choice of the operating voltage drop @xmath83 would be @xmath84 since @xmath85 . under such assumptions , can simply be written as @xmath86 which makes the dependency between the diode current @xmath68 , the received waveform @xmath57 and therefore the transmitted waveforms @xmath87 much more explicit",
    ".    the problem at hand will be the design of @xmath87 such that the output dc current is maximized . under the ideal rectifier assumption ,",
    "the current delivered to the load in a steady - state response is constant and given by @xmath88 , i.e. the average over time of the current flowing through the diode . in order to make the optimization tractable",
    ", we truncate the taylor expansion to the @xmath89 order .",
    "we consider two models : a non - linear model that truncates the taylor expansion to the @xmath89 order but retains the fundamental non - linear behaviour of the diode and a linear model that truncates to the second order term and ignores the non - linearity .",
    "after truncation , the output dc current approximates as @xmath90    @xmath91,\\\\ y(t)^3&=\\frac{1}{4}\\sum_{n_0,n_1,n_2}x_{n_0}x_{n_1}x_{n_2}\\left[\\cos(w^{+++}t+\\delta^{+++})+\\cos(w^{++-}t+\\delta^{++-})+\\cos(w^{+-+}t+\\delta^{+-+})+\\cos(w^{+--}t+\\delta^{+--})\\right],\\label{yt_3}\\\\ y(t)^4&=\\frac{1}{8}\\sum_{{\\genfrac{}{}{0pt}{}{n_0,n_1,}{n_2,n_3}}}x_{n_0}x_{n_1}x_{n_2}x_{n_3}\\left[\\cos(w^{++++}t+\\delta^{++++})+\\cos(w^{++--}t+\\delta^{++--})+\\cos(w^{+++-}t+\\delta^{+++-})+\\cos(w^{++-+}t+\\delta^{++-+})\\right.\\nonumber\\\\ & \\hspace{2cm}\\left.+\\cos(w^{+-++}t+\\delta^{+-++})+\\cos(w^{+---}t+\\delta^{+---})+\\cos(w^{+-+-}t+\\delta^{+-+-})+\\cos(w^{+--+}t+\\delta^{+--+})\\right].\\label{yt_4}\\end{aligned}\\ ] ]    applying to involves the computation of @xmath92 , illustrated in , and for @xmath93 . in order to simplify the notations",
    ", makes use of @xmath94 and @xmath95 to denote @xmath96 and @xmath97 , respectively .",
    "hence the sign of @xmath98 and @xmath99 is reflected as a superscript .",
    "similarly , @xmath100 and @xmath101",
    ". in and , we use the same convention , e.g.  @xmath102 , @xmath103 , etc . averaging over time",
    ", we get an approximation of the dc component of the current at the output of the rectifier ( and the low - pass filter ) with a multisine excitation over a multipath channel as @xmath104 with @xmath105 , @xmath106 and @xmath107 detailed in , and , respectively ( at the top of next page ) .",
    "there is no odd ( first , third , fifth , etc ) order terms since @xmath108 for @xmath109 odd . in and ,",
    "only terms with an equal number of @xmath110 and @xmath111 lead to a dc component in and following the assumption on evenly spaced frequencies .",
    "we note that the second order term is linear , with the dc power being the sum of the power harvested on each frequency . on the other hand , even terms with @xmath112 such as and are responsible for the non - linear behaviour of the diode since they are function of terms expressed as the product of contributions from different frequencies .",
    "@xmath113=\\frac{1}{2}\\left[\\sum_{n=0}^{n-1 } \\left|\\mathbf{h}_n\\mathbf{w}_{n } \\right|^2\\right]=\\frac{1}{2}\\left[\\sum_{n=0}^{n-1 } \\sum_{m_0,m_1 } s_{n , m_0}s_{n , m_1}a_{n , m_0}a_{n , m_1}\\cos\\left(\\psi_{n , m_0}-\\psi_{n , m_1}\\right)\\right],\\label{y_dc_2_2}\\\\ \\mathcal{e}\\left\\{y(t)^4\\right\\}&=\\frac{3}{8}\\left[\\sum_{{\\genfrac{}{}{0pt}{}{n_0,n_1,n_2,n_3}{n_0+n_1=n_2+n_3}}}x_{n_0}x_{n_1}x_{n_2}x_{n_3}\\cos(\\delta_{n_0}+\\delta_{n_1}-\\delta_{n_2}-\\delta_{n_3})\\right]=\\frac{3}{8}\\re\\left\\{\\sum_{{\\genfrac{}{}{0pt}{}{n_0,n_1,n_2,n_3}{n_0+n_1=n_2+n_3}}}\\mathbf{h}_{n_0}\\mathbf{w}_{n_0}\\mathbf{h}_{n_1}\\mathbf{w}_{n_1}\\left(\\mathbf{h}_{n_2}\\mathbf{w}_{n_2}\\right)^*\\left(\\mathbf{h}_{n_3}\\mathbf{w}_{n_3}\\right)^*\\right\\},\\label{y_dc_4_1b}\\\\ & = \\frac{3}{8}\\left[\\sum_{{\\genfrac{}{}{0pt}{}{n_0,n_1,n_2,n_3}{n_0+n_1=n_2+n_3}}}\\sum_{{\\genfrac{}{}{0pt}{}{m_0,m_1,}{m_2,m_3}}}\\bigg[\\prod_{j=0}^3s_{n_j , m_j}a_{n_j , m_j}\\bigg]\\cos(\\psi_{n_0,m_0}+\\psi_{n_1,m_1}-\\psi_{n_2,m_2}-\\psi_{n_3,m_3})\\right].\\label{y_dc_4_3}\\\\ \\mathcal{e}\\left\\{y(t)^6\\right\\}&=\\frac{5}{16}\\re\\left\\{\\sum_{{\\genfrac{}{}{0pt}{}{n_0,n_1,n_2,n_3,n_4,n_5}{n_0+n_1+n_2=n_3+n_4+n_5}}}\\mathbf{h}_{n_0}\\mathbf{w}_{n_0}\\mathbf{h}_{n_1}\\mathbf{w}_{n_1}\\mathbf{h}_{n_2}\\mathbf{w}_{n_2}\\left(\\mathbf{h}_{n_3}\\mathbf{w}_{n_3}\\right)^*\\left(\\mathbf{h}_{n_4}\\mathbf{w}_{n_4}\\right)^*\\left(\\mathbf{h}_{n_5}\\mathbf{w}_{n_5}\\right)^*\\right\\},\\label{y_dc_6_0}\\\\ & = \\frac{5}{16}\\left[\\sum_{{\\genfrac{}{}{0pt}{}{n_0,n_1,n_2,n_3,n_4,n_5}{n_0+n_1+n_2=n_3+n_4+n_5}}}\\sum_{{\\genfrac{}{}{0pt}{}{m_0,m_1,m_2,}{m_3,m_4,m_5}}}\\bigg[\\prod_{j=0}^5 s_{n_j , m_j}a_{n_j , m_j}\\bigg]\\cos(\\psi_{n_0,m_0}+\\psi_{n_1,m_1}+\\psi_{n_2,m_2}-\\psi_{n_3,m_3}-\\psi_{n_4,m_4}-\\psi_{n_5,m_5})\\right].\\label{y_dc_6_1}\\end{aligned}\\ ] ]      the linear model was first introduced a few decades ago in @xcite and recently became popular in the swipt literature @xcite .",
    "it could be argued that if @xmath57 is very small ( i.e.  for a very low input power ) , the high order ( @xmath114 ) terms would not contribute much to @xmath82 .",
    "hence , the linear model truncates the taylor expansion to the second order @xmath115 such that @xmath116 .",
    "it therefore completely omits the non - linearity behavior of the rectifier .",
    "the linear model is motivated by its simplicity rather than its accuracy .",
    "its accuracy is actually questionable in the rf literature with experiments demonstrating that the non - linearity is an essential property of the rectenna and that a second order truncation of the taylor expansion does not accurately model the rectification behavior of the diode @xcite . nevertheless , the loss incurred by using a linear vs a non - linear model in the wpt waveform and system design has never been addressed so far .    in the next section , we derive tools to design waveforms under the assumption of a linear and non - linear model .",
    "assuming the csi ( in the form of frequency response @xmath117 ) is known to the transmitter , we aim at finding the optimal set of amplitudes and phases @xmath118 that maximizes @xmath82 , i.e.@xmath119 from the previous section , we however note that the rectifier characteristics @xmath120 are functions of @xmath83 . since we chose @xmath121 in the taylor expansion , @xmath122 are therefore a function of the output dc current . making this dependence explicit ,",
    "we can write @xmath82 from as @xmath123 soving problem with @xmath82 given in may seem challenging because of the occurence of @xmath82 on both sides of the equality in . denoting @xmath124 and @xmath125 , we write equivalently as @xmath126 interestingly",
    ", this leads to an expression where the r.h.s of is independent of @xmath83 ( and @xmath82 ) since @xmath127 , with @xmath109 even and @xmath128 .",
    "the l.h.s of is on the other hand a monotonic increasing function of @xmath82 .",
    "hence the maximization of @xmath82 is equivalent to maximizing the r.h.s of , which is equivalent to maximizing the quantity @xmath129 since @xmath71 is a constant . in",
    ", we define @xmath130 with a slight abuse of notation . assuming @xmath131 , a diode ideality factor @xmath132 and @xmath133 , typical values of those parameters for second and fourth order are given by @xmath134 and @xmath135 ( and will be used as such in any evaluation in the sequel ) .",
    "hence , @xmath136 is equivalent to @xmath137 and problem can equivalently be written as @xmath138      with the linear model , problem is equivalent to @xmath139\\leq p.\\ ] ] the solution simply consists in performing a matched beamformer on a single sinewave , namely the one corresponding to the strongest channel @xmath140 . hence , @xmath141 we denote solution as the adaptive single sinewave ( ass ) strategy .",
    "with such a linear model , a single - sine waveform is favoured over a multisine waveform .",
    "such a strategy has also appeared in the swipt literature with ofdm transmission , e.g.  @xcite .    for the extreme case where the channel is perfectly flat magnitude - wise , i.e.  @xmath142 @xmath143 , ass is not the only solution to problem .",
    "allocating power uniformly over any non - empty subset @xmath17 of the @xmath0 sinewaves , i.e.   @xmath144 leads to the same objective value .",
    "if the channel is not perfectly flat , ass would be the unique solution to problem .",
    "to get some insights into the necessity to account for the non - linear terms ( e.g. @xmath145,@xmath146 ) and into the impact of multipath on the waveform design , let us consider a toy example with the simplest multisine : @xmath147 , @xmath148 .",
    "we also assume @xmath149 . for readibility",
    ", we drop the antenna index and assume real frequency domain channel @xmath150 .",
    "since @xmath151 , let us choose @xmath152 so that @xmath153 ( and all @xmath154 ) in and @xmath155 . since for @xmath147 , indices @xmath156 ,",
    "@xmath157 , @xmath158 , @xmath159 in can take either value 0 or 1 , we can easily identify cases for which @xmath160 and then write from @xmath161\\label{diode_model_2_n2_1 } \\ ] ] where @xmath162 and @xmath163 .",
    "from , we note that @xmath164 is a function of the term @xmath165 , whose maximization subject to the sum power constraint @xmath166 would lead to the ass strategy , i.e.  allocate all the power to sinewave 1 if @xmath167 and to sinewave 0 otherwise .",
    "however the presence of the term @xmath168 suggests that such a single - sinewave strategy is in general sub - optimal for the maximization of @xmath169 . in problem with @xmath147 and @xmath148 , we note that equality @xmath170 is satisfied at optimality and we write the lagrangian as @xmath171 differentiating w.r.t .",
    "@xmath172 , @xmath173 , @xmath174 and equating to 0 , we find three valid stationary points @xmath175 ( such that @xmath176 and @xmath177 ) given by @xmath178 , @xmath179 and @xmath180 where @xmath181 for given @xmath182 , @xmath183 , the global optimum strategy is given by one of those three stationary points .",
    "the maximum achievable @xmath184 .",
    "the first two points correspond to the ass strategy , allocating transmit power to sinewave 0 and 1 , respectively .",
    "fig [ lagrangian_n2 ] illustrates @xmath169 as a function of @xmath183 for @xmath185 with three strategies : single - sinewave transmission ( i.e.  @xmath186 and @xmath187 ) and the optimal transmission leading to @xmath188 .",
    "the contours of @xmath169 as a function of @xmath189 and @xmath190 are also illustrated for @xmath185 and @xmath191 .",
    "we note that the ass strategy is optimal if @xmath182 is sufficiently larger than @xmath183 or inversely . however ,",
    "when the channel is frequency flat , i.e.  @xmath192 , the optimal strategy would allocate power to the two sinewaves and the ass strategy is suboptimal .     as a function of @xmath183 and contours of @xmath169 as a function of @xmath189 and @xmath190 .",
    "the straight line refers to the power constraint and the circle to the optimal power allocation strategy .",
    "]    the results , though based on a very simple scenario , highlight that depending on the csi , the transmission waveform should be adapted if we aim at maximizing the output dc power .",
    "moreover , it also shows the benefits of allocating power over multiple sinewaves for some channel states , which is in sharp contrast with the ass strategy originating from the linear model . more generally , looking at",
    ", the ass strategy would unlikely be a right strategy if we account for the non - linearity of the diode , due to the presence of @xmath194 in the fourth order term .",
    "it should be noted that rf experiments in @xcite have shown the benefits of allocating power uniformly across multiple sinewaves .",
    "the above discussion highlights theoretically the benefits of allocating power over multiple sinewaves for some channel states and therefore backs up the experimental results . on the other hand ,",
    "the linear model motivates the use of a single sinewave ( ass ) for all channel states , and therefore contradicts the rf experiment results .",
    "deriving a formal algorithm that can generate optimized waveforms for any multipath configuration and any @xmath0 , @xmath1 , @xmath195 so as to maximize the dc output current is a non - trivial problem that is discussed in the next section .",
    "we aim at deriving a waveform design strategy that is general enough to cope with any taylor expansion order @xmath195 but the derived algorithm works for any @xmath195 . ] .",
    "the optimal phases @xmath30 can be obtained first in closed form and the optimal amplitudes @xmath29 can then be computed numerically .",
    "to maximize @xmath196 , we should guaranteee all @xmath197 to be equal to 1 in , and .",
    "this can be satisfied by choosing @xmath198 @xmath155 ( and therefore @xmath199 @xmath143 ) , which implies from to choose the optimal sinewave phases as @xmath200 @xmath201 is obtained by collecting @xmath202 @xmath155 into matrix .",
    "with such a phase choice , all sinewaves in are in - phase at the rectenna input .",
    "moreover , @xmath198 and @xmath203 such that @xmath204 is simply obtained from with all @xmath197 replaced by 1 in , and .",
    "recall from @xcite that a monomial is defined as the function @xmath205 where @xmath206 and @xmath207 .",
    "a sum of @xmath208 monomials is called a posynomial and can be written as @xmath209 with @xmath210 where @xmath211 . as we can see from , and , @xmath204 is a posynomial , and so it is for any order @xmath195 in the taylor expansion .",
    "the higher the order , the larger the number of terms in the posynomial .",
    "the optimization problem becomes @xmath212 subject to @xmath213 .",
    "it therefore consists in maximizing a posynomial subject to a power constraint ( which itself is written as a posynomial ) .",
    "this problem is not a standard geometric program ( gp ) but it can be transformed to an equivalent problem by introducing an auxiliary variable @xmath214 @xmath215    this is known as a reverse geometric program due to the minimization of a posynomial subject to upper and lower bounds inequality constraints @xcite . note that @xmath216 is equivalent to @xmath217 .",
    "however @xmath218 is not a posynomial , therefore preventing the use of standard gp tools .",
    "the idea is to lower bound @xmath204 by a monomial @xmath219 , i.e.  upper bound @xmath218 by the monomial @xmath220 ( since the inverse of a monomial is still a monomial ) @xcite .",
    "let @xmath221 be the monomial terms in the posynomial @xmath222 .",
    "the choice of the lower bound relies on the fact that an arithmetic mean ( am ) is greater or equal to the geometric mean ( gm ) .",
    "hence , @xmath223 , where @xmath224 and @xmath225 . since @xmath226 we can replace ( in a conservative way ) inequality @xmath217 by @xmath227 . for a given choice of @xmath228 , problem",
    "- is now replaced by the standard gp @xmath229 that can be solved using existing software , e.g.  cvx @xcite .",
    "note that the tightness of the upper bound heavily depends on the choice of @xmath228 .",
    "following @xcite , an iterative procedure can be used to tighten the bound , where at each iteration the standard gp - is solved for an updated set of @xmath228 . assuming a feasible set of magnitude @xmath230 at iteration @xmath231 , compute at iteration @xmath109 @xmath232 @xmath233 and solve problem - to obtain @xmath234 .",
    "repeat the iterations till convergence .",
    "algorithm [ algthm_opt ] summarizes the procedure .",
    "* initialize * : @xmath235 , @xmath201 in , @xmath29 , @xmath236 [ algthm_opt_step_initialize ] @xmath237 , @xmath238 @xmath239 , @xmath240 [ algthm_opt_step_gamma ] @xmath241 [ algthm_opt_step_opt ] @xmath242    note that the successive approximation method used in the algorithm 1 is also known as a sequential convex optimization or inner approximation method @xcite .",
    "it can not guarantee to converge to the global solution of the original problem , but only to yield a point fulfilling the kkt conditions @xcite .",
    "however , it has been shown in @xcite by simulation that such an iterative algorithm often converges to the global optimum .",
    "non - linearity is obviously meaningful only for @xmath243 . for @xmath244 , both linear and non - linear designs boil down to the simple matched beamformer @xmath245 .      when @xmath246 , previous section derives a general methodology to design waveform weights jointly across space and frequency .",
    "it is worth wondering whether we can decouple the design of the spatial and frequency domain weights without impacting performance .",
    "the optimal phases in are those of a matched beamformer .",
    "looking at , and , the optimum weight vector @xmath247 that maximizes the @xmath248 , @xmath145 and @xmath146 order terms is actually a matched beamformer of the form @xmath249 such that , from , @xmath250 .",
    "hence , with , the multi - antenna multi - sine wpt weight optimization is converted into an effective single antenna multi - sine wpt optimization with the effective channel gain on frequency @xmath73 given by @xmath251 and the amplitude of the @xmath25 sinewave given by @xmath252 ( subject to @xmath253 ) .",
    "the optimum magnitude @xmath252 in can now be obtained by using the posynomial maximization methodology of section [ nonlinear_design_subsection ] .",
    "namely , plugging into , and , we get .",
    "@xmath254 , \\mathcal{e}\\left\\{y(t)^4\\right\\}=\\frac{3}{8}\\left[\\sum_{{\\genfrac{}{}{0pt}{}{n_0,n_1,n_2,n_3}{n_0+n_1=n_2+n_3}}}\\bigg[\\prod_{j=0}^3s_{n_j}\\left\\|\\mathbf{h}_{n_j}\\right\\|\\bigg]\\right ] , \\mathcal{e}\\left\\{y(t)^6\\right\\}=\\frac{5}{16}\\left[\\sum_{{\\genfrac{}{}{0pt}{}{n_0,n_1,n_2,n_3,n_4,n_5}{n_0+n_1+n_2=n_3+n_4+n_5}}}\\bigg[\\prod_{j=0}^5 s_{n_j}\\left\\|\\mathbf{h}_{n_j}\\right\\|\\bigg]\\right]\\label{y_dc_w_3}\\end{aligned}\\ ] ]    @xmath255 is now only a function of the @xmath0-dimensional vector @xmath256 $ ] . following the posynomial maximization methodology , we can write @xmath257 , apply the am - gm inequality and write the standard gp problem @xmath258 algorithm [ algthm_opt_simple ] summarizes the design methodology with spatial and frequency domain decoupling .    * initialize * : @xmath235 , @xmath247 in , @xmath259 , @xmath236 [ algthm_opt_step_initialize_simple ] @xmath237 , @xmath260 @xmath261 , @xmath240 [ algthm_opt_step_gamma_simple ] @xmath262 [ algthm_opt_step_opt_simple ] @xmath263    such an approach would lead to the same performance as the joint space - frequency design of algorithm [ algthm_opt ] but would significantly reduce the computational complexity since only a @xmath0-dimensional vector @xmath259 is to be optimized numerically , compared to the @xmath264 matrix @xmath29 of algorithm [ algthm_opt ] .",
    "in practice , it may be useful to constrain the papr of the transmitted waveform in order to increase the efficiency of the power amplifier .",
    "from , the papr on antenna @xmath20 can be defined as @xmath265 .",
    "the papr constraint on antenna @xmath20 writes as @xmath266 .",
    "problem is now subject to an extra constraint @xmath267 in the sequel , we will assume the use of the phase @xmath201 in and optimize the amplitude @xmath29 .    by oversampling the transmit signals at @xmath268 for @xmath269 with @xmath270 and @xmath271 the oversampling factor ,",
    "the papr constraint can be rewritten as @xmath272 , @xmath273 for sufficiently large @xmath271 . assuming the phase @xmath201 in , we can write @xmath274 the quantity @xmath275 is not a posynomial anymore as some of the coefficients @xmath276 are negative .",
    "@xmath275 is now written as a signomial , i.e.  the sum of monomials whose coefficients @xmath276 can be either positive or negative , @xmath277 where @xmath278 and @xmath279 with @xmath280 .",
    "let us write the signomial @xmath281 .",
    "we therefore have the inequality @xmath282 or equivalently @xmath283 .",
    "this is a standard sign inequality but the quotient of posynomials is not a posynomial . writing the denominator as a sum of monomials , @xmath284",
    ", we can perform a single condensation and replace the original inequality by the following inequality @xmath285 with @xmath286 and @xmath287 . for a given choice of @xmath288 and assuming @xmath201 , the optimization problem - is now replaced by the standard gp @xmath289 problem - can now be solved at each iteration of an iterative procedure where @xmath288 are updated .",
    "the whole optimization procedure is summarized in algorithm [ algthm_opt_papr ] .",
    "* initialize * : @xmath235 , @xmath201 in , @xmath29 , @xmath236 [ algthm_opt_papr_step_initialize ] @xmath237 , @xmath238 @xmath239 , @xmath240 [ algthm_opt_papr_step_gamma ] @xmath290 , @xmath291 , @xmath292 , @xmath293 [ algthm_opt_papr_step_gamma_papr ] @xmath294 [ algthm_opt_step_opt ]",
    "@xmath242    note that for @xmath246 , decoupling the space and frequency domains ( similarly to section [ decoupling ] ) would lead to a suboptimal design compared to the joint space - frequency design of algorithm [ algthm_opt_papr ] in the presence of papr constraints .",
    "consider now the extension to @xmath295 rectennas .",
    "those rectennas could either belong to a single user ( i.e.  point - to - point mimo wpt ) or spread across multiple users ( i.e.  mu - miso wpt ) . in this multiple rectenna setup ,",
    "the energy harvested by a given rectenna @xmath296 in general depends on the energy harvested by the other rectennas @xmath297 , @xmath298 .",
    "indeed , a given waveform may be suitable for a given rectenna but found inefficient for another rectenna .",
    "hence , there exists a trade - off between the energy harvested by the different rectennas .",
    "the energy region @xmath299 formulates this trade - off by expressing the set of all rectenna harvested energy @xmath300 that are simultaneously achievable .",
    "the boundary of the energy region can be derived by considering a weighted sum of dc component at each user where weights @xmath301 , @xmath302 , account for the multi - rectenna fairness .",
    "the optimization problem now consists in finding the optimal set of amplitudes and phases ( across frequencies ) that maximizes the weighted sum of dc components @xmath303 , i.e.@xmath304    from section [ system_model ] , after adding the index @xmath305 to any user specific variable , we define @xmath306 and @xmath307 with @xmath308 the frequency response of the channel of rectenna @xmath305 on transmit antenna @xmath20 at @xmath26 .      the ass strategy is generalized as @xmath309\\leq p\\ ] ] with @xmath310^t$ ] and @xmath311 .",
    "the solution consists in transmitting on a single sinewave @xmath312 and along the dominant right singular vector of @xmath313 .",
    "hence , @xmath314 where @xmath315 is the dominant right singular vector of @xmath316 .",
    "solution naturally boils down to for @xmath317 .",
    "unfortunately , guaranteeing @xmath318 @xmath319 is not possible ( @xmath320 constraints and @xmath321 variables only ) .",
    "hence , for a given choice of phase matrix @xmath322 , some cosine functions in , and are positive while others are negative .",
    "@xmath323 is now a signomial since some of the coefficients @xmath276 are negative .",
    "similarly to the single rectenna scenario , we can convert the maximization problem into a minimization by introducing the auxiliary variable @xmath214 .",
    "the problem writes as - with replaced by @xmath324 .",
    "condition @xmath325 can be replaced by @xmath326 where @xmath327 , @xmath328 and @xmath329 are the monomial terms in the posynomial @xmath330 . for a given choice of @xmath331",
    ", we now get the standard gp @xmath332 similarly to the single rectenna optimization , problem - can now be solved at each iteration of an iterative procedure where @xmath331 are updated . note that problem - boils down to problem - if @xmath333 .",
    "the whole optimization procedure is summarized in algorithm [ algthm_opt_mu ] .",
    "* initialize * : @xmath235 , @xmath334 , @xmath29 , @xmath335 [ algthm_opt_mu_step_initialize ] @xmath237 , @xmath238 @xmath336 , @xmath337 [ algthm_opt_mu_step_gamma ]",
    "@xmath338 [ algthm_opt_mu_step_opt ] @xmath339    we note that the optimum phases for the single rectenna scenario in and the linear model optimization in are those of a dominant eigenmode transmission ( boiling down to a simple transmit matched filter for the single rectenna case ) @xcite .",
    "motivated by this observation , a good choice for the phase @xmath334 in algorithm [ algthm_opt_mu ] ( even though there is no claim of optimality ) consists in choosing the @xmath340 entries of @xmath334 as @xmath341 where @xmath342 is the @xmath32 entry of the dominant right singular vector @xmath315 , @xmath155 .",
    "the proposed waveform design relies on csi ( in the form of frequency response @xmath117 ) knowledge at the transmitter .",
    "inspired by communication systems in a tdd mode , we could envision a wpt architecture equipped with a pilot transmission ( on the uplink ) phase and a channel estimator at the power base station . alternatively , approaches relying on csi feedback , along the lines of e.g.  @xcite , could be exploited .",
    "note that since the linear and nonlinear models give very different waveform strategies ( the first one favouring a single sinewave while the second one favouring multiple sinewaves ) , the csi feedback / estimation mechanisms and requirements depend on the adopted model .",
    "we may be tempted to think that the design requires knowledge of the rectifier characteristics since the parameters @xmath122 are function of @xmath71 and @xmath72 .",
    "however , @xmath71 is just a mutiplicative factor affecting all terms equally in @xmath169 and therefore has no impact of the design of the waveform .",
    "@xmath72 appears in the denominator of @xmath122 through the term @xmath343 .",
    "however @xmath72 is a constant irrespective of the rectifier design .",
    "hence the waveform design at the transmitter does not require any feedback of information about the rectifier characteristics .",
    "in order to further motivate the usefulness of multisine waveform optimization and in order to get some insight into the fundamental limits of wpt , we want to quantify how @xmath169 and @xmath344 scale as a function of @xmath0 , @xmath1 and @xmath295 . for simplicity",
    "we truncate the taylor expansion to the fourth order and therefore consider the metric @xmath345 .",
    "the scaling laws also draw insights into the usefulness of csit for wpt .",
    "we consider frequency - flat and frequency - selective channels .",
    "we assume that the complex channel gains @xmath346 are modeled as independent circularly symmetric complex gaussian random variables .",
    "@xmath40 are therefore independent rayleigh distributed such that @xmath347 with @xmath348 .",
    "the impulse responses have a constant average received power normalized to 1 such that @xmath349 .",
    "we first assume a single transmit antenna ( and drop the antenna index ) and a single rectenna ( @xmath317 ) and consider a frequency flat channel with @xmath350 and @xmath351 @xmath143 .",
    "this is met when the bandwidth of the multisine waveform @xmath352 is much smaller than the channel coherence bandwidth .    making use of , , and",
    ", it is clear that choosing @xmath353 is optimal for any @xmath354 and @xmath355 .",
    "recalling the power constraint @xmath356 , we can then write @xmath357 where @xmath358 finding a closed form solution of the optimal @xmath29 is challenging . we can lower bound @xmath359 as @xmath360 .",
    "subject to the power constraint , the lower bound is maximized by allocating power uniformly across sinewaves , i.e.  @xmath361 such that @xmath362 .",
    "we will denote as up this non - adaptive waveform strategy characterized by @xmath362 and @xmath363 .",
    "up is suboptimal for @xmath364 and optimal for @xmath147 ( as already found in section [ lagrangian_n2 ] when @xmath365 ) , for which the inequality is replaced by an equality .",
    "nevertheless for @xmath364 , up almost reaches the optimum obtained with algorithm [ algthm_opt ] , as confirmed in section [ simulations ] .",
    "the value of @xmath169 with the up strategy , simply denoted as @xmath366 , can be thought of as a lower bound on @xmath367 ( with optimal amplitude and phase strategy ) in frequency - flat channels .",
    "plugging @xmath361 @xmath143 into , we get @xmath368 since that there are @xmath369 terms in the sum of .    in frequency - flat channels , @xmath370 .",
    "taking the expectation over @xmath354 , @xmath371 is written as @xmath372 since @xmath373 and @xmath374 by making use of the moments of an exponential distribution ( @xmath375 ) .",
    "equations and suggest that @xmath366 and @xmath376 ( and therefore @xmath367 ) linearly increase with @xmath0 in frequency - flat channels .",
    "this is remarkable as it is achieved with a fixed waveform ( non - adaptive to the csi ) and therefore without csi feedback .",
    "we also note that the linear increase originates from the non - linearity of the rectifier as it only appears in the fourth order term . on the contrary ,",
    "the transmission with a single sinewave ( @xmath244 ) or with the ass strategy would perform significantly worse with @xmath377 and @xmath378 .",
    "the multisine waveform with uniform power allocation would achieve a relative gain over a single - sinewave strategy on a frequency - flat channel that linearly increases with @xmath0 .",
    "this gain highlights the potential of optimizing multisine waveforms and modeling the non - linearity of the rectifier .",
    "let us now look at multiple transmit antennas ( @xmath379 ) . since the channel is frequency flat , @xmath380 , @xmath143 .",
    "let us assume a simple strategy ( denoted as upmf ) consisting in performing uniform power ( up ) allocation in the frequency domain and matched beamforming ( mf ) in the spatial domain .",
    "we therefore write @xmath381 , @xmath143 . making use of similar steps as in ,",
    "the harvested energy @xmath169 writes as @xmath382 after averaging over the channel distribution and making use of the moments of a @xmath383 random variable , we get @xmath384 the upmf strategy enables an increase of @xmath385 proportionally to @xmath386 and would rely on csit knowledge to perform spatial matched beamforming . while @xmath1 has an impact on both the second order and fourth order term , @xmath0 only appears in the fourth order term .",
    "scaling law highlights that any increase of @xmath387 by a factor 2 requires either increasing the number of sinewaves ( @xmath0 ) by a factor 2 for a fixed number of transmit antennas ( @xmath1 ) or increase the number of transmit antennas by a factor @xmath388 for a fixed number of sinewaves .",
    "let us now look at the presence of multiple rectennas ( @xmath389 ) and focus on @xmath390 and @xmath148 for simplicity .",
    "assuming the channels to each rectenna are identically distributed , the use of the up strategy leads to an average harvested energy at rectenna @xmath305 , @xmath391 , that scales as .",
    "hence the sum energy @xmath392 linearly increases with @xmath0 and @xmath295 . in frequency - flat channels with @xmath295 rectennas ,",
    "the energy region @xmath299 with up strategy is a hypercube with each rectenna s harvested energy scaling linearly with @xmath0 , i.e.  the same quantity of energy as if it was alone in the system . therefore adding more rectennas comes for free and does not compromise each rectenna s performance .",
    "it may appear from and that taking @xmath0 to infinity would imply the harvested energy reaches infinity .",
    "the assumption behind the scaling law derivation is that the diode operates in the non - linear region , as discussed in section [ rectifier_subsection ] .",
    "if @xmath0 grows too large , the waveform peaks will ultimately have a very high amplitude and the diode will be forced into the linear region of operation , making the taylor series expansion model and the scaling laws no longer applicable .",
    "we assume a frequency selective channel with @xmath393 and frequencies @xmath26 far apart from each other such that the frequency domain circularly symmetric complex gaussian random channel gains @xmath117 fade independently ( phase and amplitude - wise ) across frequencies and antennas .",
    "let us first consider @xmath148 and a waveform not adaptive to the csi whose set of amplitude and phase is given by @xmath29 and @xmath30 .",
    "we write @xmath394+\\frac{3k_4}{8}r_{ant}^2 \\\\ \\left[\\sum_{n=0}^{n-1}x_n^4 + 2\\sum_{{\\genfrac{}{}{0pt}{}{n_0,n_1}{n_0\\neq n_1}}}x_{n_0}^2 x_{n_1}^2 + r \\right]$ ] where @xmath395 contains all the remaining terms in the sum expansion .",
    "those terms are such that @xmath396 .",
    "we can compute the expectation of @xmath196 over @xmath397 .",
    "we note that @xmath398 because for any fixed phase of the waveform , quantities @xmath399 in @xmath395 would be uniformly distributed over @xmath400 ( since the phase of @xmath401 is uniformly distributed over @xmath400 ) such that @xmath402 .",
    "moreover , @xmath403 and @xmath404 . recalling the power constraint @xmath405 , we can write @xmath406\\left[\\sum_{n_1}s_{n_1}^2\\right]=8p^2 $ ] , therefore leading to @xmath407 this highlights that in the presence of frequency - selective rayleigh fading channels ( with @xmath393 ) , @xmath385 is independent of @xmath0 and the waveform design , i.e.  any fixed multisine waveform would achieve the same @xmath385 .",
    "in the absence of csit , transmitting over a single sinewave ( @xmath244 ) is enough in frequency - selective channels . in the presence of multiple rectennas ,",
    "the sum energy writes as @xmath408 .",
    "let us consider the same frequency - selective channel but now assume an adaptive waveform , namely the ass strategy ( still with @xmath148 ) , allocating all transmit power to the sinewave corresponding to the strongest channel gain .",
    "we compute the expectation of @xmath169 over @xmath397 as @xmath409 where @xmath410 .",
    "since @xmath411 , the pdf of @xmath412 simply is @xmath413 .",
    "using @xcite , @xmath414 and @xmath415 with @xmath416,\\\\ s_n&=n \\left[\\sum_{k=0}^{n-1}(-1)^{k+n-1}\\small{\\left(\\begin{array}{c}n-1 \\\\ k\\end{array}\\right)}\\frac{1}{\\left(n - k\\right)^3}\\right]\\end{aligned}\\ ] ] and we simply obtain @xmath417 after some calculations , it can be shown that @xmath418 with @xmath419 the euler - mascheroni constant and @xmath420 scales as @xmath421 .",
    "similarly , after some calculations , we can show that @xmath422 where @xmath423 is the stieltjes constant .",
    "this shows that @xmath424 and @xmath425 .",
    "we can now write @xmath426 thanks to the frequency selectivity , the ass strategy enables an increase of the second order and fourth order terms proportionally to @xmath427 and @xmath428 , respectively .",
    "looking now at the upmf strategy @xmath429 ( for @xmath430 ) , we can write @xmath431 where @xmath432 .    we can now lower and upper bound . a lower bound",
    "is obtained by noting that @xmath433 , @xmath434 .",
    "equality holds when @xmath435 due to the independence between channel gains in the frequency domain .",
    "since @xmath436 , we can compute @xmath437 .",
    "the lower bound is simply obtained from @xmath438 .",
    "noting @xmath439 , we also obtain the upper bound by writing @xmath440 . noting that @xmath441 ( @xmath442 ) , both lower and upper bounds have the same scaling law for @xmath443 growing large such that @xmath444 this is the same scaling law as in frequency flat channels .",
    "for @xmath148 , if the fourth order term is dominant or if @xmath0 is large enough , the upmf strategy , upmf should not be confused with up .",
    "upmf is an adaptive waveform that relies on csit knowledge to match the channel phases on each sinewave while up is a non - adaptive waveform with null phases .",
    "] clearly outperforms the ass strategy ( i.e.  linear versus log squared increase in @xmath0 ) .",
    "on the other hand , if the second order term is dominant , the ass strategy outperforms the upmf strategy .",
    "table [ scaling_law_summary ] summarizes the scaling laws for adaptive ( based on csit ) and non - adaptive ( no csit ) waveforms in frequency - flat and frequency - selective channels .",
    "we note again that for @xmath148 a linear increase with @xmath0 is achievable without csit in frequency - flat channels , while the same increase would require csit knowledge in frequency - selective channels .",
    "we also note that a linear model - based design leads to significantly lower scaling laws than the non - linear model - based design for frequency - flat and frequency - selective channels .",
    "this really highlights the importance of modeling higher order terms in the taylor expansion .    [ cols=\"<,<,<,<\",options=\"header \" , ]     [ scaling_law_summary ]      the previous scaling laws highlight the benefits of a large - scale multisine multi - antenna architecture .",
    "this is reminiscent of massive mimo in communication .",
    "the large dimension enables to significantly simplify the waveform design .",
    "the spatial matched beamformer , @xmath445 ( with @xmath253 ) , would induce channel hardening on sinewave @xmath73 such that by the law of large number @xmath446 and @xmath447 where @xmath359 is defined in .",
    "@xmath169 can now be maximized by using the optimal power allocation for frequency - flat channels .",
    "the suboptimal up would be a good alternative .",
    "this leads to a very low complexity waveform design for large - scale wpt .",
    "we consider two types of performance evaluations , the first one is based on the simplified non - linear model introduced in section [ section_eh ] , while the second one relies on an actual and accurate modelling of the rectenna in pspice .",
    "the first type of evaluations consists in displaying @xmath169 averaged over many channel realizations for various waveforms . to that end",
    ", we assume a fourth order taylor expansion and therefore consider the following metric @xmath345 with @xmath134 , @xmath135 and @xmath60 .    we first consider a single rectenna scenario where the wireless channel is omitted , i.e.  @xmath448 and @xmath449 ( representing a frequency flat channel ) and a single transmit antenna .",
    "the received power , i.e.  input power to the rectenna , is fixed to -20dbm .",
    "fig [ z_dc_nochannel_opt_up ] ( top ) confirms that in a frequency flat channel , @xmath169 with up is close to that achieved by opt , obtained from algorithm [ algthm_opt ] .",
    "fig [ z_dc_nochannel_opt_up ] ( middle ) investigates the impact of papr constraint on @xmath169 with the optimized waveform for @xmath450 using algorithm [ algthm_opt_papr ] .",
    "fig [ z_dc_nochannel_opt_up ] ( bottom ) illustrates the corresponding shape of the waveform amplitudes @xmath252 across frequencies for various papr constraints @xmath451 .",
    "as @xmath451 decreases , the allocation of power decreases on the side frequencies and concentrates more on the center frequencies . for large @xmath451",
    ", the optimized waveform never exactly reaches the up waveform .",
    "center frequencies get slightly larger magnitudes , which explains a slight increase in @xmath169 of opt over up in fig [ z_dc_nochannel_opt_up ] ( top ) .     as a function of @xmath0 ( top ) and papr constraint @xmath451 for @xmath450 ( middle ) .",
    "wpt waveform amplitude as a function of @xmath451 for @xmath450 ( bottom ) .",
    "no wireless channel is assumed , i.e.  @xmath448 and @xmath449 , and @xmath148 . ]",
    "we now evaluate the performance of wpt waveforms in a single rectenna scenario representative of a wifi - like environment at a center frequency of 5.18ghz with a 36dbm transmit power , isotropic transmit antennas ( i.e.  eirp of 36dbm for @xmath148 ) , 2dbi receive antenna gain and 58db path loss in a large open space environment with a nlos channel power delay profile with 18 taps obtained from model b @xcite .",
    "taps are modeled as i.i.d .",
    "circularly symmetric complex gaussian random variables , each with an average power @xmath452 .",
    "the multipath response is normalized such that @xmath453 . with one transmit antenna",
    ", this leads to an average received power of -20dbm ( @xmath454 ) .",
    "equivalently , this system model can be viewed as a transmission over the aforementioned normalized multipath channel with an average transmit power fixed to -20dbm .",
    "the frequency gap is fixed as @xmath28 with @xmath455 and @xmath456mhz .",
    "the @xmath0 sinewaves are centered around 5.18ghz .    in fig [ freq_response_channel1",
    "] , we illustrate the effect of frequency selectivity on the shape of the transmit waveform obtained using algorithm [ algthm_opt ] .",
    "fig [ freq_response_channel1 ] ( top ) illustrates the frequency response of one realization of the multipath channel over 1mhz and 10 mhz bandwidth .",
    "fig [ freq_response_channel1 ] ( bottom ) displays the magnitude of the waveform optimized for @xmath457 ( algorithm [ algthm_opt ] ) over such a channel realization .",
    "interestingly , the optimized waveform has a tendency to allocate more power to frequencies exhibiting larger channel gains .",
    "this is reminiscent of the water - filling power allocation strategy in communication .",
    "this observation also suggests a suboptimal low complexity waveform design that would allocate power proportionally to the channel strength . for comparison , recall that the ass waveform , motivated by the linear model , would allocate all power to the frequency corresponding to the strongest channel gain .    ) for 1 mhz and 10 mhz bandwidths . ]",
    "we now evaluate the performance gain of the adaptive optimized ( opt ) waveform ( algorithm [ algthm_opt ] ) versus three baselines : a non - adaptive waveform not relying on csit and two adaptive waveforms relying on csit but not requiring the optimization of section [ section_waveform ] . from the scaling law analysis ,",
    "a suitable choice of non - adaptive waveform for single antenna wpt is up .",
    "we therefore choose the non - adaptive baseline waveform as @xmath458 and @xmath459 @xmath155 .",
    "motivated by the observations made in fig [ freq_response_channel1 ] , the first adaptive baseline waveform is chosen as a matched filter ( mf ) allocating power to all sinewaves but proportionally to the channel strength , i.e.  @xmath460 and @xmath461 with @xmath462 a constant to guarantee the power constraint .",
    "hence the difference between the optimized waveform and the one based on mf lies in a different choice of amplitudes .",
    "the second adaptive baseline waveform is the ass , designed according to the linear model .",
    "fig [ z_dc_results_1mhz ] and [ z_dc_results_10mhz ] display @xmath169 averaged over many channel realizations as a function of @xmath463 for two bandwidths @xmath464 and @xmath465 , respectively .",
    "we make the following observations .",
    "first , for small bandwidth ( @xmath466mhz ) , the up non - adaptive waveform performs pretty well in the presence of a single transmit antenna ( @xmath148 ) , confirming that for channels with little frequency selectivity , csi feedback is not needed . on the other hand , for larger bandwidth ( @xmath467mhz ) , the non - adaptive waveform is clearly outperformed by the adaptive waveforms , therefore highlighting the usefulness of csi feedback in wpt even with a single transmit antenna .",
    "second , for small bandwidth , the ass waveform is significantly outperformed by the up waveform for @xmath148 , despite the fact it requires csi knowledge at the transmitter . for larger bandwidth ,",
    "the ass waveform benefits from the channel frequency selectivity to get close performance to opt for small @xmath0 .",
    "as @xmath0 increases , the ass waveform is however clearly outperformed by the adaptive mf and opt waveforms .",
    "this highlights the inaccuracy of the linear model in characterizing the rectifier and the inefficiency of the linear model - based design .",
    "the inefficiency is particularly severe as @xmath0 increases irrespectively of the bandwidth .",
    "these observations confirm the predictions made from the scaling laws in table [ scaling_law_summary ] .",
    "third , opt outperforms all waveforms in all configurations .",
    "fourth , mf is a good alternative to opt , at least with small bandwidth , and does not require any optimization . for larger bandwidth , opt shows a non - negligible gain over mf as @xmath0 increases .     as a function of @xmath463 with @xmath466mhz . ]     as a function of @xmath463 with @xmath467mhz . ]",
    "fig [ average_z_dc_n16_m1 ] further analyzes the sensitivity of @xmath169 to the bandwidth for a fixed number of sinewaves @xmath457 and various waveforms .",
    "waveforms relying on uniform power allocation such as non - adaptive up and adaptive upmf experience some loss as the bandwidth increases and the channel becomes more frequency selective . on the other hand , adaptive opt and adaptive ss benefit from the frequency selectivity by favouring the strongest sinewave(s ) . in @xcite , experiments show that waveforms with high peak to average power ratio ( papr ) increase rf - to - dc conversion efficiency .",
    "the conclusion was drawn for various waveforms ( ofdm , white noise , chaotic ) that were not designed or optimized for wpt . following this observation",
    ", we investigate whether designing waveforms so as to maximize the papr at the input of the rectenna , after the wireless channel , is a suitable approach .",
    "the adaptive waveform max papr in fig [ average_z_dc_n16_m1 ] is designed following this philosophy .",
    "it uses the same phases as opt but inverts the channel such that at the input to the rectifier , the waveform appears as an in - phase multisine with uniform power allocation ( which is known to have the maximum papr of @xmath468 db ) .",
    "this is mathematically formulated by choosing @xmath469 where @xmath470 is a constant to satisfy the transmit power constraint .",
    "results show that this is a rather inefficient waveform design strategy .",
    "this originates from the relatively low magnitude of the waveform peaks due to the excessive amount of power wasted in inverting the wireless power to guarantee the maximum papr at the input of the rectenna .",
    "note also that non - adaptive up would lead to the highest transmit papr ( i.e. papr of the transmit waveform , before the wireless channel ) due the uniform allocation across 16 in - phase sinewaves .",
    "opt on the other hand has a transmit papr always lower than up despite providing higher @xmath169 .     on @xmath169 for @xmath457 and @xmath148 .",
    "]    fig [ z_dcvspapr_n16 ] further investigates the impact of papr on the performance of the optimized multisine waveforms .",
    "it considers the opt waveform with 16 sinewaves uniformly spread over 3 different bandwidths .",
    "@xmath169 is plotted against the papr of the transmit waveform for each realization of the multipath channel , along with some linear regression fit .",
    "it is noted that there is some positive correlation between @xmath169 and papr , especially for small bandwidths .",
    "as the bandwidth increases and the wireless channel becomes more frequency selective , the optimized waveform has a tendency to allocate less power to the weakest channels , therefore leading to lower papr .",
    "this explains why as the bandwidth increases , the correlation between dc current and papr reduces .",
    "versus transmit papr for @xmath457 and @xmath148 . ]     on @xmath169 for @xmath148 and 5 mhz bandwidth . ]",
    "fig [ average_z_dc_5mhz_scalinglaws ] reveals the performance of a large - scale multisine wpt using 4 suboptimal ( though low complexity ) waveforms ( up , ass , upmf and mf .",
    "this calls for future research on alternative optimization methods for large - scale waveforms . ] ) for @xmath148 and 5 mhz bandwidth .",
    "the linear model - based ass is significantly outperformed by the non - linear model - based design as @xmath0 grows large .",
    "the scaling laws for ass and upmf over frequency - selective ( fs ) channels in table [ scaling_law_summary ] are also displayed for comparison .",
    "the second type of evaluations is based on an accurate modeling of the rectenna in pspice in order to validate the waveform optimization and the rectenna non - linearity model . to that end ,",
    "the waveforms after the wireless channel have been used as inputs to the realistic rectenna of fig [ circuit ] designed for an input power of -20dbm .",
    "the circuit contains an l - matching network @xcite to guarantee a good matching between the rectifier and the antenna and to minimize the impedance mismatch due to variations in frequency and input power level of the input signal .",
    "the values of the capacitor @xmath471 and the inductor @xmath472 are optimized to match the antenna impedance to the average input impedance of the rectifier resulting from an input signal composed of 4 sinewaves and spread across @xmath467mhz . using ads harmonic balance simulation , the rectifier impedance",
    "is measured at the 4 sinewave frequencies during a few iterations , and conjugate matching is performed to match the antenna to the average rectifier impedance at each iteration until the impedance mismatch error is minimised .",
    "@xmath473 is set as the voltage source .",
    "taking the optimized waveform as an example , for a given channel realization , algorithm [ algthm_opt ] is used to derive the optimal waveform weights , which are then used to generate in matlab the waveform @xmath57 as in ( after the wireless channel ) .",
    "several periods of the signal are generated such that @xmath474 , with @xmath462 a positive integer chosen sufficiently large to make sure that the rectifier is in the steady - state response mode and @xmath475 the period of the waveform .",
    "quantity @xmath57 is stored and then fed into the pspice circuit simulator to generate the voltage source @xmath476 in fig [ circuit ] .",
    "the antenna and load impedances are set as @xmath477 and @xmath478 , respectively .",
    "the output capacitor is chosen as @xmath479pf for @xmath466mhz and @xmath480pf for @xmath467mhz so that the output dc power is maximized and the rate of charge and discharge of @xmath481 is maintained in proportion to the period of the waveform , i.e.  for evaluations with @xmath466mhz , @xmath482 is replaced by a 100pf capacitor in fig [ circuit ] .",
    "fig [ pdc_n_cout_10p_100p ] illustrates the increase of the harvested dc power as a function of @xmath0 for a single transmit antenna and assuming no wireless channel , i.e.  @xmath448 and @xmath449 ( representing a frequency flat channel ) .",
    "the harvested dc power is not a monotonically increasing function contrary to what was observed in fig [ z_dc_nochannel_opt_up ] with @xmath169 .",
    "this is explained by the fact that the rectenna has been optimized for 4 sinewaves . for @xmath467mhz and @xmath483 ,",
    "@xmath484pf was found appropriate . nevertheless , as @xmath0 increases , for a fixed @xmath485 , @xmath486 decreases , which affects the rate of charge and discharge of the output capacitor .",
    "this shows that @xmath481 ( but also the load and the matching network ) should ideally be adjusted as a function of @xmath0 .",
    "we indeed notice that for large @xmath0 , a larger capacitor of 100pf is better than 10pf .",
    "it is worth noting even if the rectenna design changes as a function of @xmath0 , beyond a certain @xmath0 , the peak of the voltage at the input of the diode would be higher than the diode breakdown voltage ( 2v for sms7630 ) , which would cause a sharp decrease in efficiency .     as a function of @xmath0 for @xmath467mhz .",
    "no wireless channel is assumed , i.e.  @xmath448 and @xmath449 , and @xmath148 . ]    in fig [ waveform_shape ] , considering the channel impulse response of fig [ freq_response_channel1 ] , we illustrate the time - domain evolution of the input and output voltages ( in the form of @xmath59 and @xmath80 ) for the opt and up waveforms ( with @xmath457 and @xmath467mhz ) .",
    "we also illustrate the effect of the output capacitance @xmath481 on the performance .",
    "large peaks in the input voltage occur with a periodicity @xmath487s .",
    "output voltage is not flat contrary to what is expected with an ideal rectifier ( as used in the non - linear model of section [ section_eh ] ) .",
    "this is due to the finite @xmath488 chosen in the simulated ( and optimized ) rectifier of fig [ circuit ] .",
    "we note that a larger @xmath481 leads to a smoother output voltage and a better discharging behaviour but a slower charging time and lower output peak voltages . a good value for @xmath481 results from a compromise between those conflicting mechanisms that explains why a finite @xmath481 is needed in practice .",
    "we also note that the opt waveform leads to a higher output voltage than that obtained with the up waveform .",
    "the harvested dc output power with @xmath489pf is given by @xmath490w and @xmath491w , for up and opt , respectively . with @xmath484pf ,",
    "the harvested dc output power is slightly higher and given by @xmath492w and @xmath493w , respectively .     and",
    "@xmath494 over the wireless channel of fig [ freq_response_channel1 ] with opt and up waveforms for @xmath457 , @xmath467 mhz and @xmath484pf,100pf . ]",
    "[ vin ]    fig [ pspice_results_1mhz ] and [ pspice_results_10mhz ] display the average harvested dc output power for @xmath495mhz and @xmath467mhz ( using the same channel realizations as those used in fig [ z_dc_results_1mhz ] and [ z_dc_results_10mhz ] ) , respectively .",
    "we make important observations .",
    "first , the results confirm the observations made in fig [ z_dc_results_1mhz ] and [ z_dc_results_10mhz ] and validate the rectenna non - linearity model is accurate enough to predict the rectifier output dc power using @xmath496 . ] and the waveform optimization .",
    "there is indeed a good match between the behavior predicted from the analytical nonlinear model and the one observed from the pspice simulations .",
    "second , they highlight the significant ( and increasing as @xmath443 grow ) gains achieved by the nonlinear model - based design over the linear model - based design .",
    "third , they highlight that the linear model does not characterize correctly the rectenna behavior , which leads to an inefficient multisine waveform design .",
    "indeed , if the linear model had accurately characterized the rectifier behavior , the ass waveform would have provided the highest average dc power over all other waveforms .",
    "it is clearly not the case .",
    "the behaviour observed from fig [ pspice_results_1mhz ] and [ pspice_results_10mhz ] can not be explained based on the linear model . in fig [ pspice_results_1mhz ] , with @xmath148 , ass ( requiring csit ) is even outperformed by non - adaptive up ( not requiring csit ) .",
    "results in fig [ pspice_results_1mhz ] and [ pspice_results_10mhz ] can also be viewed in terms of rf - to - dc conversion efficiency by dividing the harvested dc power by the average input power ( @xmath454 ) . for 10mhz and @xmath148 ,",
    "the rf - to - dc conversion efficiency of the opt waveform is 9% , 15% , 22% , 28% , 37% and 46% for @xmath497 and 32 , respectively .",
    "it is worth noting in fig [ pspice_results_1mhz ] and [ pspice_results_10mhz ] the effect of bandwidth on average dc power .",
    "the average dc power with a 10 mhz bandwidth is larger than that with a 1 mhz bandwidth .",
    "this comes from the increased channel frequency selectivity and the diode being turned on more often as @xmath486 increases .",
    "when @xmath244 , all waveforms obviously achieve the same performance .     with @xmath466mhz . ]     with @xmath467mhz . ]",
    "@xmath149 was used throughout the waveform design and @xmath169 evaluations .",
    "more investigations are needed to assess the usefulness of even higher order terms ( @xmath498 ) . in @xcite , it was claimed that @xmath149 is the minimum order required to characterize the nonlinear mechanisms of the diode .",
    "the paper looks at a wpt link optimization and derives a methodology to design and optimize multisine waveforms for wpt . assuming the csi is available to the transmitter , the waveforms result from a non - convex posynomial maximization problem and are shown through realistic simulations to provide significantly higher harvested dc power over various baseline waveforms under a fixed transmit power constraint .",
    "the results show the importance of accounting for the non - linearity of the rectifier in any design involving wireless power .",
    "the waveform design problem addressed in this paper assumes @xmath0 sinewaves with a uniform frequency spacing @xmath455 for a given spectrum bandwidth @xmath485 .",
    "a fundamental question arising from this work is , given a spectrum bandwidth @xmath485 , what is the best way to transmit power so as to maximize the output dc power ?",
    "this would help understanding how to make the best use of the rf spectrum for wpt .",
    "this problem has been investigated for several decades in wireless communication but is an uncharted area in wpt .",
    "the work highlights the usefulness of adaptive waveforms and csit .",
    "the fundamentals of csi acquisition / feedback in wpt remain largely unknown .",
    "some interesting ideas along this line have appeared in @xcite .",
    "however , the work relied on the linear model .",
    "it is unclear yet whether a similar approach can be used over the non - linear wireless power channel .",
    "the scaling laws and evaluations highlight the potentials of a promising architecture relying on large - scale multisine multi - antenna waveforms dedicated to wpt .",
    "this architecture would be to wireless power what massive mimo is to communication .",
    "more results along this line can be found in @xcite .",
    "the work also highlights the importance of understanding and modeling the wireless power channel and formulating a complete link optimization ( transmitter to rectenna ) in order to design an efficient wpt architecture .",
    "since wpt is the fundamental building block of various types of wireless powered systems ( e.g.  wpt , swipt , wpcn , backscatter communication ) , this motivates a bottom - up approach where any wireless powered system is based on a sound science - driven design of the underlying wpt .",
    "the waveform design and the rectifier non - linearity tackled in this paper therefore have direct consequences on the design of swipt , wpcn and backscatter communication .",
    "for instance , some preliminary results on swipt waveforms have been reported in @xcite , where it is shown that the superposition of multisine and ofdm waveforms enlarges the rate - energy region compared to an ofdm - only transmission .",
    "this originates from the non - linearity of the rectifier and the fact that the ofdm waveform , due to the randomness of the information , is less efficient than a ( deterministic ) multisine waveform to convert rf power to dc power .",
    "b. clerckx , e. bayguzina , d. yates , and p.d .",
    "mitcheson , `` waveform optimization for wireless power transfer with nonlinear energy harvester modeling , '' ieee iswcs 2015 , august 2015 , brussels , arxiv:1506.08879 .",
    "visser , r.j.m .",
    "vullers , `` rf energy harvesting and transport for wireless sensor network applications : principles and requirements , '' proceedings of the ieee , vol . 101 , no . 6 , june 2013 .",
    "m. pinuela , p. mitcheson and s. lucyszyn , `` ambient rf energy harvesting in urban and semi - urban environments , '' ieee trans . on microw .",
    "theory and techn .",
    ", vol 61 , no 7 , july 2013 .",
    "hagerty , f.b .",
    "helmbrecht , w.h .",
    "mccalpin , r. zane , and z.b .",
    "popovic , `` recycling ambient microwave energy with broad - band rectenna arrays , '' ieee trans .",
    "mtt , vol 52 , no 3 , march 2004 .",
    "trotter , j.d . griffin and g.d .",
    "durgin , `` power - optimized waveforms for improving the range and reliability of rfid systems , '' 2009 ieee international conference on rfid .",
    "s. boaventura and n. b. carvalho , `` maximizing dc power in energy harvesting circuits using multisine excitation , '' 2011 ieee mtt - s international microwave symposium digest ( mtt ) .",
    "a. collado and a. georgiadis , `` optimal waveforms for efficient wireless power transmission , '' ieee microwave and wireless components letters , vol .",
    "24 , no.5 , may 2014 .",
    "s. wetenkamp , `` comparison of single diode vs. dual diode detectors for microwave power detection , '' in ieee mtt - s int .",
    "symp . dig .",
    ", boston , ma , usa , 1983 , pp .",
    "361 - 363 .",
    "x. zhou , r. zhang and c. k. ho , `` wireless information and power transfer : architecture design and rate - energy tradeoff , '' ieee trans .",
    "on commun .",
    "4754 - 4767 , nov 2013 . b. clerckx and c. oestges , `` mimo wireless networks : channels , techniques and standards for multi - antenna , multi - user and multi - cell systems , '' academic press ( elsevier ) , oxford , uk , jan 2013 .",
    "curty , n. joehl , f. krummenacher , c. dehollain , and m.j .",
    "declercq , `` a model for @xmath499-power rectifier analysis and design , '' ieee trans . on circuits and systems - i ,",
    "12 , pp . 2771 - 2779 , dec . 2005 .",
    "a. boaventura , a. collado , n. b. carvalho , a. georgiadis , `` optimum behavior : wireless power transmission system design through behavioral models and efficient synthesis techniques '' , ieee microwave magazine , vol .",
    "26 - 35 , march / apr . 2013 .",
    "s. ladan and k. wu , `` nonlinear modeling and harmonic recycling of millimeter - wave rectifier circuit , '' ieee trans .",
    "mtt , vol .",
    "3 , march 2015 .",
    "k. huang and e , g. larsson , `` simultaneous information and power transfer for broadband wireless systems , '' ieee trans .",
    "5972 - 5986 , dec . 2013 .",
    "zawawi , j. park and b. clerckx , `` simultaneous wireless information and power transfer in a two - user ofdm interference channel , '' ieee iswcs 2015 , august 2015 , brussels .",
    "gradshteyn , i.m .",
    "ryzhik , `` table of integrals , series , and products , '' seventh edition , academic press , 2007 .",
    "m. chiang , `` geometric programming for communication systems , '' foundations and trends in communications and info .",
    "theory , 2005 .",
    "r.j . duffin and e.l .",
    "peterson , `` geometric programming with signomials , '' j. of optimization theory and applications , vol .",
    "11 , no . 1 , 1973 . c.s .",
    "beightler and d.t . philips , `` applied geometric programming , '' wiley , 1976 .",
    "marks and g.p .",
    "wright , `` a general inner approximation algorithm for nonconvex mathematical programs , '' operations research , vol .",
    "681 - 683 , 1978 .",
    "m. chiang , c.w .",
    "tan , d.p .",
    "palomar , d. oneill , and d. julian , `` power control by geometric programming , '' ieee trans . on wireless comm .",
    ", vol . 6 , no . 7 , pp .",
    "2640 - 2651 , july 2007 .",
    "j. xu and r. zhang , `` energy beamforming with one - bit feedback , '' ieee trans .",
    "proc . , vol .",
    "5370 - 5381 , oct .",
    "j. medbo , p. schramm , `` channel models for hiperlan/2 in different indoor scenarios , '' 3eri085b , etsi ep bran , march 1998 .",
    "y. huang and b. clerckx , `` waveform optimization for large - scale multi - antenna multi - sine wireless power transfer , '' ieee spawc 2016 , arxiv:1605.01191 .",
    "b. clerckx , `` waveform optimization for swipt with nonlinear energy harvester modeling , '' 20th international itg workshop on smart antennas ( wsa 2016 ) , march 2016 , munich , arxiv:1602.01061 ."
  ],
  "abstract_text": [
    "<S> far - field wireless power transfer ( wpt ) has attracted significant attention in recent years . despite the rapid progress </S>",
    "<S> , the emphasis of the research community in the last decade has remained largely concentrated on improving the design of energy harvester ( so - called rectenna ) and has left aside the effect of transmitter design . in this paper , we study the design of transmit waveform so as to enhance the dc power at the output of the rectenna . we derive a tractable model of the non - linearity of the rectenna and compare with a linear model conventionally used in the literature . </S>",
    "<S> we then use those models to design novel multisine waveforms that are adaptive to the channel state information ( csi ) . </S>",
    "<S> interestingly , while the linear model favours narrowband transmission with all the power allocated to a single frequency , the non - linear model favours a power allocation over multiple frequencies . through realistic simulations , </S>",
    "<S> waveforms designed based on the non - linear model are shown to provide significant gains ( in terms of harvested dc power ) over those designed based on the linear model and over non - adaptive waveforms . </S>",
    "<S> we also compute analytically the theoretical scaling laws of the harvested energy for various waveforms as a function of the number of sinewaves and transmit antennas . </S>",
    "<S> those scaling laws highlight the benefits of csi knowledge at the transmitter in wpt and of a wpt design based on a non - linear rectenna model over a linear model . </S>",
    "<S> results also motivate the study of a promising architecture relying on large - scale multisine multi - antenna waveforms for wpt . as a final note , </S>",
    "<S> results stress the importance of modeling and accounting for the non - linearity of the rectenna in any system design involving wireless power . </S>"
  ]
}