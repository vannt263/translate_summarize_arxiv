{
  "article_text": [
    "the two most important parameters for a track reconstruction with drift tubes are the time  distance ",
    "relation ( @xmath0relation ) to convert the measured times into spatial distances , and the resolution function as a weight for the track fit . in this article",
    "the determination of these parameters is described for the opera drift tubes .",
    "opera is a long - baseline neutrino oscillation experiment @xcite to search for the @xmath1 oscillation in the parameter region indicated by previous experiments @xcite .",
    "the main goal is to find @xmath2 appearance by direct detection of the @xmath3 from @xmath2 cc interactions .",
    "the opera detector consists of two massive lead - emulsion target sections followed by muon spectrometers .",
    "the task of the muon spectrometers , which consist of dipole magnets , rpcs and @xmath410000 aluminum drift tubes of 8 m length @xcite , is to clarify the signature of the muonic @xmath3 decay and to remove the background originating from charmed particles produced in @xmath5-neutrino interactions .",
    "it is a difficult task to obtain the parameters needed for the track reconstruction of the muons traversing the opera drift tubes due to the very poor statistics of cosmic muons at the gran sasso laboratory where the opera detector is located .",
    "the determination of these parameters can , however , be done outside the underground lab using an equivalent detector with higher track statistics at same conditions ( temperature , pressure , etc . ) .",
    "since the mean cosmic energy at the sea level ( @xmath6  gev ) is the same mean energy of the muons coming out from the tau lepton decay after the cc @xmath2 interaction in the target , a calibration setup was built and operated at hamburg .",
    "for this two 8  m long drift modules ( @xcite ) with an total overlap in horizontal position were used , while the resulting wire sag was compensated by bending the tubes accordingly .",
    "this article describes a calibration procedure to determine the @xmath0relation and the resolution function .",
    "furthermore a wire alignment procedure is described .",
    "track description using the hesse form and definition of the parameters in the used coordinate system . ]",
    "the pattern recognition fulfills two important functions . on the one hand it performs the preselection of hit candidates belonging to a track , on the other hand it delivers the start values for the track fit .",
    "we assume that a particle passing trough the detector ( straight track ) will produce @xmath7 hits with valid drift times @xmath8 within a defined time window .",
    "these times can be converted into distances @xmath9 between the track and the fired wire by using the @xmath0relation .",
    "this radius @xmath9 of a circle around the sense wire is an unsigned quantity and does not tell us on which side the particle passed the wire .",
    "the pattern recognition has to select the best sample of hit candidates , define the signs to resolve the right - left ambiguities and define the start angle and the start distance to the origin of the track . for the calibration this procedure has to be fast and efficient .",
    "normally a kalman filter technique @xcite is used .",
    "but if a sufficient number of events is available a more simple method described as follows fulfills the requirements above .",
    "it uses single straight tracks only . in case of more than one track per event ( multi tracks )",
    "the event is ignored .    for the track reconstruction with drift tubes the distance from the track to the wire",
    "is needed .",
    "thus it is convenient to describe the particle track with the hesse form @xmath10 here @xmath11 is the track distance of the closest approach to the origin and @xmath12 the angle between track and x - axis as defined in fig .",
    "[ picpattern ] . in this analysis",
    "we assume parallel wires , therefore a two dimensional track description is sufficient .",
    "the distance of closest approach to the anode wires @xmath13 is then calculated by @xmath14 the index @xmath15 describes the wire number @xmath15 with the coordinates @xmath16 and @xmath17 .",
    "example of the four tangents to the radii @xmath18 and @xmath19 .",
    "the tangent , minimizing eq .",
    "[ glchi1 ] , is the best description of the true track . ]    in the simplest pattern recognition scheme the two tubes with the maximum distance between each other in one event will be used ( fig .",
    "[ picpat2 ] ) . now",
    "four possibilities exist to fit tangents ( @xmath20 to @xmath21 ) to the radii @xmath18 and @xmath19 .",
    "the tangent minimizing the @xmath22 expression will be selected @xmath23 @xmath24 is the mean resolution , which is assumed to be the same for all tubes in the pattern recognition . for starting @xmath24",
    "is set to 1 .",
    "sign convention for the track description considering the cases _ a _ and _ b _ according to the particle track on the right or left side from the wire . ]    the minimal @xmath22 of the selected tangent has to be lower than a predefined maximal value ( for this calibration values between 100 and 500 were used ) . for higher values",
    "the whole event will be rejected .",
    "the origin of such events can be noise or cross talk . if a valid tangent is found , the start parameter @xmath25 and @xmath26 are now available for the track fit .",
    "the signs of the @xmath13 will be defined using the convention shown in fig .",
    "[ picpat3 ] .",
    "the normal vector @xmath27 is defined as @xmath28 the particle can pass the wire at two sides , denoted by @xmath29 and @xmath30 .",
    "eq . [ glhesse1 ] can be written as @xmath31 here @xmath32 and @xmath33 are the points of contact to the tangents .",
    "the distances @xmath13 follow this convention , the vector @xmath34 in eq .",
    "[ glskalar1 ] will be replaced by a vector pointing from the anode wire to the track @xmath35",
    "in this section a general track fit procedure will be described .",
    "it was originally developed and used in the argus experiment @xcite . a former description for the outer tracker system of the hera ",
    "b experiment can be found in @xcite .",
    "the distances @xmath36 from the pattern recognition denotes the distances calculated from the measured drift times . ]",
    "form a vector @xmath37 with the dimension @xmath7 .",
    "the measurement uncertainties @xmath38 for each used wire are collected in the resolution function , binned in time or space respectively .",
    "the squared values of this function are on the main diagonal of the @xmath39 covariance matrix @xmath40 . in the case of independent measurements only the main diagonal is filled .",
    "the track will be described by the @xmath7 dimensional vector @xmath41 . in general @xmath42",
    "is @xmath43 dimensional ( @xmath43 is the number of track parameters , in our case two ) .",
    "the parameter @xmath42 results from the fit of @xmath41 to @xmath37 . using the least square method ,",
    "the parameter @xmath42 minimizes the expression @xmath44^t { \\bf w } \\left[\\vec{d}_m-\\vec{d}_t(\\vec{q})\\right].\\label{chi2a}\\end{aligned}\\ ] ] the weight matrix @xmath45 is the inverse covariance matrix of the measured coordinates : @xmath46 assuming independent measurements equation [ chi2a ] can be written as : @xmath47 minimizing @xmath22 as a function of @xmath42 is equivalent to finding a solution to the system of equations @xmath48    in general these equations are non - linear because the track model @xmath49 is non - linear .",
    "however , in most of the cases it can be linearized and the equations can be solved iteratively .",
    "a linear track model is given by : @xmath50 here @xmath29 denotes the jakobi matrix .",
    "with this , eq . [ chi2a ] gives @xmath51 by differentiation one gets @xmath52_{\\mu } \\\\",
    "\\rightarrow \\frac{\\partial \\chi^2}{\\partial \\vec{q } } & = & -2{\\bf a}^t { \\bf w } \\left(\\vec{d}_{m}-{\\bf a}\\vec{q}-\\vec{b}\\right ) \\stackrel{def}{= } 0.\\end{aligned}\\ ] ] this yields the parameters @xmath53 with the found parameters one can solve the following equation system : @xmath54 from the general formula for error propagation ( @xcite ) @xmath55 and the replacements @xmath56 one receives the covariance matrix @xmath57 as already mentioned this method can be used for a non - linear track model if it can be linearized .",
    "a linearisation requires a starting value @xmath58 near the true solution . in this case",
    "one can describe the vector @xmath58 , which essentially contains the non - linearities , with the first order of the taylor expansion @xmath59 the jakobi matrix of @xmath41 for @xmath60 is defined as @xmath61 correspondingly @xmath62 ( see eq .",
    "[ linchi ] ) can be used in eq .",
    "[ glsys ] .",
    "this results @xmath63.\\label{glsys2}\\end{aligned}\\ ] ] the change of parameters @xmath64 results into a better approximation for the next iteration @xmath65 eq .",
    "[ glsys2 ] and [ parch ] define an iterative procedure . in the @xmath66th iteration , equation @xmath67.$}\\label{glsys3}\\end{aligned}\\ ] ]",
    "is solved for @xmath68 .",
    "the vector @xmath69 contains the fitted track distances for the track parameters of the next iteration and @xmath70 is the jakobi matrix of the track parameter for @xmath71 .",
    "@xmath68 then gives the new approximation of the parameters @xmath72 the end condition is reached when @xmath73 and @xmath74      in this section a minimal track fit with two parameters will be described in detail for the drift tube modules .",
    "the initial parameter @xmath75 for the track fit found by the pattern recognition is @xmath76 the jakobi matrix ( eq . [ gljakobim ] ) can be written as : @xmath77 @xmath78 contains the partial derivatives of @xmath13 ( see eq .",
    "[ glhesse2 ] ) with respect to @xmath11 ( @xmath79 ) and @xmath12 ( @xmath80 ) @xmath81 by substitution ( eq . [ glsys3 ] ) @xmath82 one receives @xmath83 @xmath84 is an @xmath85 matrix while @xmath86 and @xmath42 are two dimensional vectors . for independent measurements @xmath84 and",
    "@xmath86 can be calculated by @xmath87    { \\bf { \\cal y}}_{\\mu } & = & \\displaystyle\\sum\\limits_{i=1}^{n } \\frac{\\partial d_i}{\\partial q_{\\mu } } \\frac{1}{\\sigma_i^2 } ( d_{m , i } - d_{t , i}).\\label{glgy2 }    \\vspace{2em}\\end{aligned}\\ ] ] the calculation of the partial derivatives is done in eq .",
    "[ gljakobi ] .",
    "the subscripts @xmath5 and @xmath88 describe the elements of the parameter vector @xmath42 .",
    "calculating @xmath68 with eq .",
    "[ glfit2 ] gives the new iterated parameters @xmath89 this procedure ( eq . [ glfit2 ] ) will be repeated , until the end condition @xmath90 is fulfilled .",
    "probability distribution of @xmath22 ( left ) and the distribution of @xmath22 per degree of freedom ( right).,title=\"fig : \" ] probability distribution of @xmath22 ( left ) and the distribution of @xmath22 per degree of freedom ( right).,title=\"fig : \" ]    a quality check for the track fit is the distribution of the @xmath22 probability , shown in fig .",
    "[ picprob ] . on the left side events",
    "have been clustered with an under  estimated resolution whereas the resolution has been over  estimated for the events on the right side . except for the peak on the left side due to noise and cross talk ,",
    "this distribution is flat , since a uniform error distribution is expected .",
    "furthermore , the mean value of the @xmath22 distribution per degree of freedom , also shown in fig .",
    "[ picprob ] , should be around one if the track fit works correctly . in reality",
    "the mean value varies between 1 and 1.3 .    for the fit described here",
    "a @xmath91 was used .",
    "the procedure converges usually after three iterations . after that the signs of @xmath36 , determined by the pattern recognition , will be corrected (",
    "turned ) if they are opposite to the signs of @xmath92 .",
    "this procedure is repeated until no sign changes appear anymore ( solution of left / right ambiguity ) .",
    "such hits with random time signals , coming from noise or cross talk , are removed if the @xmath22 distribution is too large .",
    "the whole procedure is repeated , starting with the @xmath58 from the pattern recognition , until @xmath93 .",
    "after this it will be tested if still enough tubes @xmath7 are left over for the reconstruction ( @xmath94 ) . in this case , the vector @xmath95 of the last iteration contains the track parameter with the best track description . if not , the whole event is rejected .",
    "the calibration is the iterative determination of parameters like the @xmath0 relation and the resolution function @xmath96 .",
    "in addition the alignment of the wire positions is possible with this procedure and will be described .",
    "the calibration procedure is based on the concept of residuals @xmath97 , defined as difference of the fitted drift distance ( @xmath98 ) and the measured one ( @xmath99 ) @xmath100 the sign of @xmath99 is defined as sign of @xmath98 .",
    "the correlation of the drift time @xmath101 and the drift distance is given by the @xmath0relation using the drift velocity @xmath102 @xmath103 the iterative correction of the @xmath0relation is done by the difference @xmath104 , calculated from the residuals including the signs of the drift distances @xmath105 @xmath104 specifies , whether the measured drift distance is too low or too high .",
    "the signs used in the above equations are presented in fig .",
    "[ picvorz ] .",
    "the drift distance @xmath106 is defined negative , if the particle track passed the wire on the left side ( according to the defined coordinates ) and positive on the right side .",
    "the sign of the residuals , arising from the drift distances , follows the same convention if the distance of the fitted track is larger than the measured drift distance . in the other case ,",
    "the sign of the residuals is opposite to the drift distances .",
    "if @xmath107 , the @xmath0relation is increased in the given time bin for the next iteration , for @xmath108 it is decreased .",
    "normally the residuals are gaussian distributed . in the vicinity of the wire the influence of the primary ionisation statistics increases due to the cluster distribution , and",
    "the drift time distribution will be asymmetric to larger values and thus to larger drift distances . using eq .",
    "[ gldeldob ] , the distribution of @xmath104 will be asymmetric to the negative side",
    ". this effect will be stronger the closer the track passes the wire . since the difference in eq .",
    "[ glresid ] can not be smaller than the negative value of @xmath99 ( same sign as @xmath98 ) , this effect leads to a cut on the negative side in the @xmath104 distribution ( see chapter [ sec : fit ] ) .",
    "relation ( left ) . on the right side the distribution of the fitted distances are shown.[picdob2],title=\"fig : \" ] relation ( left ) . on the right side the distribution of the fitted distances are shown.[picdob2],title=\"fig : \" ]    the cut on @xmath104 distribution is exactly @xmath109 .",
    "thus the distribution is positive at the wire position . in all cases the maximal entries are at zero position .",
    "the mean value of @xmath104 corrects the @xmath0relation as follows @xmath110 with @xmath111 as mean value of the @xmath104 distribution .",
    "the iteration stops if the squared sum over all @xmath104 is not changing with further iterations .    for the start",
    ", the distance @xmath112 is obtained by integration of the drift time spectrum . in a first approximation a drift tube with a homogeneous distribution of track distances will be assumed . with @xmath113 tracks , passing the wire within the interval @xmath114 $ ]",
    ", @xmath115 @xmath116 is the number of tracks which hit the tube and @xmath117 is the tube radius .",
    "the drift velocity @xmath102 is given by @xmath118 by integration of the drift time spectrum @xmath119 and normalizing to the maximal tube radius one gets a first estimation of the @xmath0relation @xmath120 fig .",
    "[ picdob2 ] shows the correlations between the distances @xmath106 and the drift times @xmath101 .",
    "the mean values of the @xmath106 distributions of both branches form the @xmath0relation . for the calibration",
    "two versions of @xmath0relations are used .",
    "the description of the time binned version is a good approach for distances not too close to the wire .",
    "since the residua distribution near the wire is asymmetric as mentioned above , the @xmath0relation ( time binned ) is bend away from the actual wire position . this description is unrealistic , since the position zero is existing . to avoid this behavior ,",
    "a combination of time binned and space binned @xmath0relation is used , where the space binned relation is used for positions near the wire .",
    "thus the wire position is reached , but the drift times are always greater than zero . this behavior is realistic , since a drift time zero can not appear due to the cluster distribution even in the case if the wire is hit by a track . for describing , interpolating and smoothing the @xmath0relation cubic splines are used .",
    "if the method is working correctly , the distribution of the fitted distances is theoretically flat . in reality",
    "this distribution is a bit bended , but should be without spikes and gaps .      for the determination of the resolution function @xmath121 the rms value of the residual distribution @xmath122 will be used @xmath123 @xmath7 specifies the entries of each residual distribution for a given time bin @xmath124 and @xmath125 is the residual scale factor . since the residuals are calculated as the difference of measured and fitted track distances , they contain the uncertainties of the fitted track . to avoid underestimating the resolution a scale factor for correction is needed .",
    "the calculation of this factor will be described in the following @xcite .",
    "the resolution function is used to construct the covariance matrix @xmath126 which appears in the @xmath22 expression ( eq .",
    "[ chi2a ] ) .",
    "the expectation of the squared deviations of measured and fitted distances to the wires are the diagonal matrix elements @xmath127.\\end{aligned}\\ ] ] since per definition the true track ( parameter @xmath128 ) has no errors , the covariance matrix can be written as @xmath129 that means the covariance matrix elements are equal to the standard deviation of the true residual distribution . since the true track ( and the true residual distribution ) is unknown , it will be replaced by the parameter @xmath42 of the fitted track of the last iteration . the relation of the measured residuals to the covariance matrix is @xmath130 by linearisation @xmath131 the true residuals can be expressed by measurable values @xmath132\\ !",
    "= \\vec{\\epsilon } -\\ ! { \\bf a}(\\vec{q}_{true}- \\vec{q}).\\end{aligned}\\ ] ] by means of a general error propagation ( @xcite ) one gets @xmath133 this means , the reference trajectory @xmath41 is only known within the track parameter errors . if only the standard deviation of the measured residual distribution is used for the correction of the resolution function , it will be underestimated ( further information in @xcite ) .",
    "a convenient correction is done by the residual scale factor . with the requirement @xmath134\\end{aligned}\\ ] ] one gets the factor @xmath135 for the @xmath15th measured residual @xmath136 of the track .",
    "@xmath70 is the jakobi matrix ( eq . [ gljakobi ] ) and @xmath137 the covariance matrix of the track parameter vector @xmath42 ( eq . [ glfac ] ) .",
    "the field @xmath38 contains the calculated resolution ( eq . [ glresol ] ) for the given drift time bin of the last iteration .",
    "[ picfac ] shows the residual distribution , corrected with the scale factor . if the complete covariance matrix is unknown , a global correction factor can be used .",
    "assuming that all @xmath7 fired tubes have the same gaussian distributed error @xmath24 and the same mean squared measured residual @xmath138 , one gets @xmath139 with @xmath140 degrees of freedom ( 2 for a linear track model ) .",
    "each residual @xmath122 will be corrected by the factor and filled into histograms .",
    "the rms value of this distribution is the mean resolution @xmath141 .",
    "repetition for each time bin @xmath15 yields the resolution function @xmath142 dependent on the drift time .",
    "the weight requires a resolution for each individual wire distance @xmath143 and @xmath98 . for the interpolation and smoothing cubic splines",
    "thus resolution values for a finer binning are available .",
    "[ picaufl ] shows the resolution function and the splines .",
    "a quality factor of drift tubes is the mean resolution @xmath144 with @xmath38 as resolution of the @xmath15th of @xmath7 drift time bins ( e.g. 20  ns per bin ) .",
    "this definition takes into account , that distances with a better resolution have a higher weight in the track fit . using the mean resolution @xmath145 in the next iteration of the track fit , the mean errors of the track parameters are equal to the weighting of a variable resolution function @xmath96 @xcite .",
    "the resulting resolution function can be described by a theoretical model @xmath146 it consists of contributions from the primary ionisation statistics , from the diffusion and from a constant part @xmath147 ( uncertainties in wire position , time jitter in the electronics , time resolution , etc . ) .",
    "the diffusion , dependent on the field and the drift distance , is specified by @xmath143 .",
    "the parameter @xmath124 is the number of the triggered cluster , @xmath148 the number of primary ionisations per unit and @xmath149 the drift distance .",
    "the presented procedure can also be used for the calibration of the wire positions by replacing the track parameter vector @xmath42 with a vector @xmath150 describing the wire positions @xmath151 the track description is then given by @xmath152 the jakobi matrix can be written as @xmath153 with @xmath154 @xmath15 and @xmath124 denote the wire number .",
    "equation [ glsys3 ] can be written as @xmath155.\\label{gliterpw}\\end{aligned}\\ ] ] @xmath156 contains the wire shifting in the @xmath157 and @xmath158 direction .",
    "the calculation of @xmath156 is done by @xmath159 with the determination of @xmath84 and @xmath86 as in equations [ glfit1 ] , [ glgy1 ] and [ glgy2 ] by replacing @xmath42 with @xmath150 .",
    "the stop condition is the same as described by eq .",
    "[ gldchi2 ] . in this case",
    "@xmath160 should not change ( after 2 - 3 iterations ) . for a start parameter",
    "the theoretical wire positions are used .    in most cases ,",
    "e.g. for a narrow angle distribution , it is more sufficient to align only one wire coordinate ( perpendicular to the track axis ) .",
    "a simple way is an iterative procedure using the mean value of the residual distribution . for each iteration",
    "the wire position will be corrected by the deviation of this mean value from zero , attenuated by a scale factor of 0.3 to 0.5 .",
    "it is of advantage that not only tracks perpendicular to the wire deviation have to be used .",
    "tracks at angles around those also give good results and act as additional attenuation .",
    "this method is very stable , but without a scale factor the technique is not working and the wire correction starts to oscillate . furthermore",
    "this method only works for homogeneously irradiated drift tubes , for tubes at the edges the position correction is biased and should not be used .",
    "[ wirecal ] shows some plots of the wire positions before ( upper plots ) and after the correction ( lower plots ) . in the left plots the deviation of the wire position is shown , in the right plots",
    "the distribution of the deviation can be seen .",
    "the rms value gives the overall mean wire misalignment .",
    "the plotted results show the improvement of the accuracy of the wire position from 183  @xmath5 m down to 38  @xmath5 m after five iterations .        a flow diagram of the iterative calibration procedure to determine the @xmath0relation and the resolution function is presented in fig .",
    "[ picpap ] . for the first iteration a @xmath0relation from the integration of the tdc spectrum",
    "furthermore , the run time correction ( @xmath161 ) , not described in this article , can be extracted from the tdc spectra for each channel and used for the drift time calculations .",
    "for the first iteration a constant resolution function @xmath162 m is used in the pattern recognition and the track fit .",
    "the procedures of the pattern recognition and the track fit are described in detail in chapter [ sec : pat ] and [ sec : trackfit ] .",
    "after the iteration the resulting @xmath0relation is used as start parameter for the next iteration . this procedure will be repeated until the @xmath0relation will not change .",
    "the indicator is the sum of the squared differences of old and new @xmath0relation .",
    "now the procedure described above will be repeated using the resolution function .",
    "the convergation of the @xmath0relation and the resolution function appears after several iterations ( typically 10 ) . at the end",
    "a wire calibration can be done if necessary . in this case",
    ", the whole calibration has to be repeated , starting from the drift distance calculation ( see fig .",
    "[ picpap ] ) .",
    "after several iterations ( typically 5 ) , the wires are aligned ."
  ],
  "abstract_text": [
    "<S> a general reconstruction and calibration procedure for tracking and wire position determination of the opera drift tubes @xcite is presented . </S>",
    "<S> the mathematics of the pattern recognition and the track fit are explained .     </S>"
  ]
}