{
  "article_text": [
    "this paper is concerned with the numerical integration of hamiltonian systems of the form @xmath0 where @xmath1 with a non - singular skew - symmetric constant matrix @xmath2 and sufficiently differentiable hamiltonian @xmath3 .",
    "although the dimension @xmath4 of the system is even , in the case of hamiltonian systems , we do not assume this because the results are also applicable to poisson systems with constant poisson structure , where @xmath2 is not necessarily non - singular and @xmath4 need not be even .",
    "several geometric properties are known in classical mechanics .",
    "for example , the exact flow is energy - preserving in the sense that @xmath5 as well as being symplectic .",
    "numerical integrators exactly inheriting such properties are called geometric numerical integrators  @xcite , and the most remarkable advantage of adopting geometric numerical integrators is that they often give qualitatively correct numerical solutions over an extremely long period of time .",
    "although integrators inheriting such geometric properties as much as possible would be preferable , it is known to be impossible to construct methods inheriting both symplecticity and energy - preservation  @xcite .",
    "this is because if such methods exist the numerical flow coincides with the exact flow . in the last decades",
    ", methods inheriting one of these properties , i.e. symplectic methods and energy - preserving methods , have been developed .",
    "although both symplectic methods and energy - preserving methods have their own advantages , much more attention has been devoted to symplectic methods .",
    "one of the most remarkable advantages of symplectic methods is that they also nearly preserve the energy without any drift .",
    "it should also be noted that there is a symplectic condition for runge  kutta ( rk ) methods  @xcite : @xmath6 where @xmath7 is the stage number , and @xmath8 and @xmath9 are the coefficients of rk methods .",
    "this condition is not only sufficient but also necessary under a certain assumption .",
    "in fact , symplectic implicit rk methods exist whose typical examples are gauss methods .",
    "for more details , we refer the reader to  @xcite .    while symplectic methods are useful for most hamiltonian systems , it is sometimes mandatory to adopt energy - preserving methods .",
    "for example , errors in the hamiltonian obtained by symplectic methods can sometimes be fatal for chaotic dynamics .",
    "thus , it is strongly hoped that the study on energy - preserving methods reaches to the same maturity as symplectic methods .",
    "however , the study on energy - preserving methods is more challenging and , in fact , newer than that on symplectic methods .",
    "one reason is that no rk method is energy - preserving for general hamiltonian systems  @xcite .",
    "the projection method is a relatively simple method of constructing energy - preserving integrators .",
    "the idea is very simple , but the implementation and the construction of the projection is specific to individual problems .",
    "an even more serious disadvantage of projection - based integrators is that the long term behaviour usually deteriorates .",
    "compared with the projection method , the discrete gradient method , which was first proposed by gonzalez  @xcite ( see also mclachlan et al .",
    "@xcite ) , is rather a more sophisticated and systematic approach .    after some pioneering studies , substantial progress was made in the last decade . from a theoretical viewpoint , faou  hairer ",
    "pham  @xcite and chartier  faou ",
    "murua  @xcite revealed that there exist energy - preserving b - series integrators other than the exact flow by showing an energy - preserving condition .",
    "furthermore , concrete energy - preserving methods have also been developed , quispel ",
    "mclaren proposed the average vector field ( avf ) method  @xcite .",
    "this method is energy - preserving , a subclass of the discrete gradient method , a b - series method and of order two .",
    "a more recent interest is to find a high order energy - preserving method as an extension of the avf method .",
    "hairer proposed the avf collocation method  @xcite , and brugnano et al . proposed the hamiltonian boundary value method  @xcite .",
    "these methods are essentially the same methods , although the latter method has been developed mainly for polynomial hamiltonian systems .",
    "these methods are based on so called continuous stage rk ( csrk ) methods .",
    "it should be noted that roughly speaking the computational cost of the avf collocation method is almost the same as the same order gauss method .",
    "the main aim of this paper is to construct a more efficient energy - preserving method than exists at present . to achieve this aim",
    "we focus our attention on a matrix @xmath10 which characterizes csrk methods . in terms of @xmath10 ,",
    "we consider ( i ) an energy preserving condition , ( ii ) order conditions and ( iii ) criteria for parallel implementation using real arithmetic .",
    "we then put together these three perspectives to construct high order energy - preserving methods which can be computed in parallel .",
    "we then derive concrete integrators of up to order six .",
    "the paper is organized as follows . in",
    ", some existing energy - preserving methods are briefly reviewed with the introduction of csrk methods . in , an energy - preserving condition of csrk methods",
    "is discussed .",
    "in addition to the sufficient condition already given in @xcite , we show that the condition is also necessary under a small assumption .",
    "the condition is expressed in terms of the matrix @xmath10 . in",
    ", order conditions of energy - preserving csrk methods are characterized in terms of the matrix , where simplifying assumptions play an important role . in , parallel energy - preserving methods are constructed .",
    "we first consider a parallelizable condition of csrk methods , and then construct parallel energy - preserving methods .",
    "furthermore , we investigate fourth - order methods in detail .",
    "the derived fourth order methods can be implemented faster than the same order avf collocation method , but an actual error of our methods per each time step becomes bigger than that of the existing method . we therefore have to discuss to what extent our method is efficient . finally , concluding remarks are given in .",
    "in this section , we review some existing energy - preserving methods and continuous stage runge  kutta methods .",
    "the discrete gradient method proposed by gonzalez @xcite ( see also mclachlan et al .",
    "@xcite ) is a first systematic method for deriving energy - preserving integrators .",
    "the key idea of the method is to introduce a sophisticated approximation of the gradient .",
    "we first define a discrete gradient , a map @xmath11 , satisfying @xmath12 for any @xmath13 , and then define an integrator by @xmath14 where @xmath15 denotes the stepsize . here , the condition corresponding to the chain rule @xmath16 is called the discrete chain rule , and the condition requires the consistency . due to the discrete chain rule and skew - symmetry of the matrix @xmath2",
    ", the energy - preservation for the discrete gradient method can be easily verified : @xmath17 the discrete gradient is not generally unique and several approaches have been proposed . the average vector field ( avf ) gradient proposed by quispel  mclaren  @xcite @xmath18 is one of several possible approaches .",
    "in general , the avf method reads @xmath19 the avf method is a symmetric , second order and furthermore b - series method as will be shown later .",
    "after the proposition of the avf method , the avf method was extended to higher orders .",
    "hairer extended the avf method by slightly modifying the idea of the standard collocation methods  @xcite ( see also the hamiltonian boundary value method  @xcite ) . in this paper",
    ", we call the extended method the avf collocation method .",
    "as is the case with the standard collocation method which can be interpreted as a rk method , the avf collocation method can be interpreted as a continuous stage runge  kutta ( csrk ) method .",
    "let @xmath20 be a polynomial in @xmath21 and @xmath22 .",
    "assume that @xmath23 .",
    "we denote by @xmath7 the polynomial degree of @xmath20 in @xmath21 .",
    "let @xmath24 be defined by @xmath25 .",
    "we search for an @xmath7-degree polynomial @xmath26 ( @xmath27 $ ] ) and @xmath28 such that they satisfy @xmath29 a one - step method @xmath30 is called an @xmath7-degree continuous stage runge  kutta ( csrk ) method .",
    "a csrk method is said to be consistent if @xmath31 .",
    "csrk methods were originally due to butcher  @xcite ( see also  @xcite ) , where @xmath20 was not assumed to be a polynomial but to be bounded . in this paper , we focus on a polynomial @xmath20 because this restriction simplifies discussion below and more general functions do not seem to be of greater benefit to our aim than polynomial functions .    in the above definition , @xmath23 is assumed so that @xmath32 .",
    "@xmath26 can be seen as an approximation of @xmath33 , where @xmath34 .",
    "the final stage @xmath28 is also expressed by @xmath35 due to the relation @xmath25 . since in this paper we shall focus on @xmath20 which is polynomial of degree @xmath7 in @xmath21 and @xmath36 in @xmath22 , we often express @xmath20 as @xmath37 with a constant matrix @xmath38 .    in the case of the avf collocation method , the polynomial @xmath20",
    "is given by @xmath39 where @xmath40 and @xmath41 are distinct , real numbers .",
    "it was proved in  @xcite that the avf collocation method is energy - preserving for hamiltonian systems independently of the @xmath42 values .",
    "if the @xmath42 values are the zeros of the @xmath7-th shifted legendre polynomial , then the method has order @xmath43 .",
    "here lists concrete expressions of @xmath20 for @xmath44 : @xmath45 note that in the case of @xmath46 and @xmath47 , the corresponding csrk method coincides with the avf method .",
    "the following theorem ensures the unique solvability of csrk methods .",
    "suppose that @xmath48 satisfies a lipschitz condition @xmath49 with a constant @xmath50 . if @xmath51}\\int_0 ^ 1|a_{\\tau,\\zeta}|\\,{\\mathrm d}\\zeta } } , \\end{aligned}\\ ] ] there exists a unique solution of .",
    "this theorem can be proved in a similar way to the proof of the unique solvability of rk methods ( see , e.g.  @xcite ) as mentioned in  @xcite . for the convenience of the reader ,",
    "this proof is included below .",
    "first , we note that the function space of @xmath7-degree polynomials with the property @xmath32 can be identified with @xmath52 .",
    "we define a metric on @xmath52 by @xmath53 } \\| y_\\tau - \\overline{y}_\\tau \\|,\\end{aligned}\\ ] ] and consider the map @xmath54 then we estimate @xmath55 as follows : @xmath56 } \\left\\| \\int_0 ^ 1 a_{\\tau,\\zeta } \\paren*{f(y_\\zeta)-f(\\overline{y}_\\zeta)}\\,{\\mathrm d}\\zeta \\right\\| \\\\ & \\leq h\\max_{\\tau\\in[0,1 ] }   \\int_0 ^ 1 |a_{\\tau,\\zeta}| \\left\\| f(y_\\zeta)-f(\\overline{y}_\\zeta)\\right\\|\\,{\\mathrm d}\\zeta \\\\ & \\leq hl\\max_{\\tau\\in[0,1 ] }   \\int_0 ^ 1 |a_{\\tau,\\zeta}| \\left\\| y_\\zeta-\\overline{y}_\\zeta\\right\\|\\,{\\mathrm d}\\zeta \\\\ & \\leq hl \\paren*{\\max_{\\tau\\in[0,1 ] }   \\int_0 ^ 1 |a_{\\tau,\\zeta}|\\,{\\mathrm d}\\zeta } \\max_{\\zeta\\in[0,1 ] } \\left\\| y_\\zeta-\\overline{y}_\\zeta\\right\\| \\\\ & = hl \\paren*{\\max_{\\tau\\in[0,1 ] }   \\int_0 ^ 1 |a_{\\tau,\\zeta}|\\,{\\mathrm d}\\zeta } \\rho ( y_\\tau,\\overline{y}_\\tau ) .\\end{aligned}\\ ] ] if the stepsize @xmath15 satisfies @xmath57 }   \\int_0 ^ 1 |a_{\\tau,\\zeta}|\\,{\\mathrm d}\\zeta}<1 $ ] , the contraction mapping theorem ensures the existence and uniqueness of the fixed point of the map @xmath58 .",
    "as pointed out in @xcite , the numerical solution of a csrk method can be interpreted as a b - series .",
    "below we introduce some notation to be needed in the subsequent sections .",
    "see  @xcite for more details on b - series .",
    "let @xmath59 be the set of rooted trees @xmath60 ] ; \\useasboundingbox ( 0.1,0 ) ; \\end{tikztree } } , { \\begin{tikztree}[baseline ] \\tree[. { } [ .",
    "{ } ] [ . { } ] ] ; \\end{tikztree } } , { \\begin{tikztree}[baseline ] \\tree[. { } [ . { } [ . { } ] ] ] ; \\useasboundingbox ( 0.1,0 ) ; \\end{tikztree } } , { \\begin{tikztree}[baseline ] \\tree[. { } [ .",
    "{ } ] [ . { } ] [ . { } ] ] ; \\end{tikztree } } , { \\begin{tikztree}[baseline ] \\tree[. { } [ . { } ] [ . { } [ . { } ] ] ] ; \\end{tikztree } } , { \\begin{tikztree}[baseline ] \\tree[. { } [ . { } [ . { } ] [ . { } ] ] ] ; \\end{tikztree } } , { \\begin{tikztree}[baseline ] \\tree[. { } [ . { } [ . { } [ . { } ] ] ] ] ; \\useasboundingbox ( 0.1,0 ) ; \\end{tikztree } } , \\dots   \\}.\\end{aligned}\\ ] ] we denote by @xmath61 the number of vertices of a tree @xmath62 .",
    "a new tree obtained by connecting the roots of @xmath63 is denoted by @xmath64 $ ] .",
    "if some of @xmath65 equal to each other , we write @xmath66 $ ] , e.g. @xmath67 ] ; \\useasboundingbox ( 0.1,0 ) ; \\end{tikztree}},{\\begin{tikztree } \\tree[. { } [ . { } ] ] ; \\useasboundingbox ( 0.1,0 ) ; \\end{tikztree } } ] = [ { \\begin{tikztree } \\node { } ; \\useasboundingbox ( 0.1,0 ) ; \\end{tikztree } } , { \\begin{tikztree } \\tree[. { } [ . { } ] ] ; \\useasboundingbox ( 0.1,0 ) ; \\end{tikztree}}^2]$ ] .",
    "the symmetry coefficient @xmath68 is defined recursively by @xmath69 where @xmath66 $ ] .",
    "the elementary differential is a mapping @xmath70 , defined recursively by @xmath71 for a map @xmath72 , a formal series of the form @xmath73 is called a b - series .",
    "the exact time-@xmath15 flow of a differential equation @xmath74 can be expressed as @xmath75 , where the coefficients @xmath76 are given by @xmath77 as is the case with runge  kutta methods , every csrk method is a b - series integrator @xmath78 , where the coefficients @xmath58 , called the elementary weights , are given by @xmath79 , @xmath80 and @xmath81 here are the first four elementary weights : @xmath82 ] ; \\useasboundingbox ( 0.1,0 ) ; \\end{tikztree } } ) & = \\int_0 ^ 1 b_\\tau a_{\\tau,\\zeta } \\,{\\mathrm d}\\tau{\\mathrm d}\\zeta , \\\\",
    "\\phi ( { \\begin{tikztree}[baseline ] \\tree[. { } [ . { } ] [ . { } ] ] ; \\end{tikztree } } ) & = \\int_0 ^ 1 b_\\tau a_{\\tau,\\zeta } a_{\\tau,\\kappa } \\ , { \\mathrm d}\\tau{\\mathrm d}\\zeta{\\mathrm d}\\kappa , & \\qquad \\phi ( { \\begin{tikztree}[baseline ] \\tree[. { } [ . { } [ . { } ] ] ] ; \\useasboundingbox ( 0.1,0 ) ; \\end{tikztree } } ) & = \\int_0 ^ 1 b_\\tau a_{\\tau,\\zeta } a_{\\zeta,\\kappa } \\ , { \\mathrm d}\\tau{\\mathrm d}\\zeta{\\mathrm d}\\kappa.\\end{aligned}\\ ] ]    in addition to the set of trees @xmath59 , we define a set of forests @xmath83 and a set of free trees @xmath84 .",
    "the forest is an unordered finite collection of trees from @xmath59 : @xmath85 ] ; \\useasboundingbox ( 0.1,0 ) ; \\end{tikztree } } , { \\begin{tikztree } \\node { } ; \\useasboundingbox ( 0.1,0 ) ; \\end{tikztree}}{\\begin{tikztree } \\node { } ; \\useasboundingbox ( 0.1,0 ) ; \\end{tikztree}}{\\begin{tikztree } \\node { } ; \\useasboundingbox ( 0.1,0 ) ; \\end{tikztree } } , { \\begin{tikztree } \\node { } ; \\useasboundingbox ( 0.1,0 ) ; \\end{tikztree}}{\\begin{tikztree } \\tree[. { } [ . { } ] ] ; \\useasboundingbox ( 0.1,0 ) ; \\end{tikztree } } , { \\begin{tikztree}[baseline ] \\tree[. { } [ . { } ] [ . { } ] ] ; \\end{tikztree } } , { \\begin{tikztree}[baseline ] \\tree[. { } [ .",
    "{ } [ . { } ] ] ] ; \\useasboundingbox ( 0.1,0 ) ; \\end{tikztree } } , \\dots \\}.\\end{aligned}\\ ] ] an element of @xmath86 is written as @xmath87 ( @xmath88 ) , and the sum of the vertices are denoted by @xmath61 , e.g. @xmath89 ] ; \\useasboundingbox ( 0.1,0 ) ; \\end{tikztree}}^2| = |{\\begin{tikztree } \\node { } ; \\useasboundingbox ( 0.1,0 ) ; \\end{tikztree}}{\\begin{tikztree } \\tree[. { } [ . { } ] ] ; \\useasboundingbox ( 0.1,0 ) ; \\end{tikztree}}{\\begin{tikztree } \\tree[. { } [ .",
    "{ } ] ] ; \\useasboundingbox ( 0.1,0 ) ; \\end{tikztree}}|=5 $ ] . for @xmath90 , @xmath91 denote the forest consisting of the subtrees of @xmath62 , e.g. @xmath92 \\tree[. { } [ . { } ] [ . { } ] [ .",
    "{ } [ . { } ] ] ] ; \\end{tikztree } } ) = { \\begin{tikztree } \\node { } ; \\useasboundingbox ( 0.1,0 ) ; \\end{tikztree}}^2{\\begin{tikztree } \\tree[. { } [ . { } ] ] ; \\useasboundingbox ( 0.1,0 ) ; \\end{tikztree}}$ ] . for a forest @xmath87",
    ", we define a map @xmath93 by @xmath94 .",
    "next , we introduce the set of free trees @xmath84 .",
    "note that there is a group of trees whose elements have topologically the same shapes , e.g. the shapes of @xmath95 \\tree[. { } [ . { } ] [ . { } ] [ .",
    "{ } ] ] ] ; \\end{tikztree}}$ ] , @xmath95 \\tree[. { } [ . { } ] [ . { } [ . { } ] [ . { } ] ] ] ; \\end{tikztree}}$ ] , @xmath95 \\tree[. { } [ . { } [ . { } ] [ . { } [ . { } ] ] ]   ] ; \\end{tikztree}}$ ] and @xmath95 \\tree[. { } [ . { } [ . { }   [ . { } ] [ . { } ] ] ] ] ; \\end{tikztree}}$ ] are the same .",
    "we define the set @xmath84 by using the butcher product , for two trees @xmath96\\in{\\mathcal t}$ ] and @xmath97 , @xmath98 \\in { \\mathcal t}.\\end{aligned}\\ ] ] note that @xmath99 in general .",
    "a tree @xmath100 can be obtained by shifting the root of @xmath101 .",
    "multiple shift of root induces an equivalence .",
    "all trees in the same equivalent class has the same number of vertices , and have topologically the same shape .",
    "we call each equivalent tree a free tree and denote the set of free trees by @xmath102 . the canonical projection is denoted by @xmath103 .",
    "this map is not bijective , e.g. @xmath104 [ . { } ] ] ] ] ; \\end{tikzftree } } ) = \\ { { \\begin{tikztree}[baseline ] \\tree[. { } [ . { } ] [ . { } ] [ . { } [ . { } ] ] ] ; \\end{tikztree}},{\\begin{tikztree}[baseline ] \\tree[. { } [ .",
    "{ } ] [ . { } [ . { } ] [ . { } ] ] ] ; \\end{tikztree}},{\\begin{tikztree}[baseline ] \\tree[. { } [ . { } [ . { } ] [ . { } [ . { } ] ] ]   ] ; \\end{tikztree}},{\\begin{tikztree}[baseline ] \\tree[. { } [ . { } [ . { }   [ . { } ]",
    "[ . { } ] ] ] ] ; \\end{tikztree}}\\ } $ ] . for two equivalent trees @xmath105 and @xmath106",
    ", we define a distance @xmath107 by the minimum number of root shifts necessary to obtain @xmath105 from @xmath106 . for example , @xmath108 , @xmath109 and @xmath110 \\tree[. { } [ . { } [ . { } ] [ . { } [ . { } ] ] ]   ] ; \\end{tikztree}},{\\begin{tikztree}[baseline ] \\tree[. { } [ . { } [ . { }   [ . { } ] [ . { } ] ] ] ] ; \\end{tikztree } } ) = 3 $ ] .",
    "any free tree containing a member with a factorisation of the form @xmath111 is called superfluous tree .",
    "in order to construct efficient energy - preserving csrk methods , it is mandatory to characterize an energy - preserving condition for csrk methods .",
    "the sufficient condition was already given in @xcite .",
    "although one can proceed to the subsequent sections by using the condition , we also show that the sufficient condition is also necessary under a small assumption .",
    "the necessity indicates that it is almost impossible to find energy - preserving csrk methods outside the framework presented in this paper .",
    "[ suffcond ] a csrk method is energy - preserving , if the matrix @xmath10 in is symmetric , i.e. if @xmath112 is symmetric .    for readers convenience",
    ", we here show the proof of this theorem .",
    "if the matrix @xmath10 is symmetric , it can be diagonalized by an orthogonal matrix @xmath113 : @xmath114 , where @xmath115 is a diagonal matrix whose elements are given by @xmath116 .",
    "the partial derivative @xmath112 is expressed as @xmath117 where @xmath118^\\top$ ] and @xmath119 denotes the @xmath120-th component . by using these notation , we have @xmath121 the last equality follows from the skew - symmetry of @xmath2 .",
    "tang and sun have also provided essentially the same sufficient condition in a different manner  @xcite .",
    "the idea of proving the necessity is to use a necessary and sufficient condition of energy - preserving b - series methods shown by chartier et al .",
    "we will also use some lemmas which are motivated by celledoni et al .",
    ".    the necessary and sufficient condition of energy - preserving b - series methods is summarized in the following theorem .",
    "a b - series @xmath122 is energy - preserving if and only if @xmath123 where @xmath62 is a member of @xmath124 .    as corollaries , we get the following properties .",
    "[ th : bccond ] if a consistent b - series method is energy - preserving , then it follows that @xmath125 ) \\paren*{=\\int_0 ^ 1 b_\\tau c_\\tau^{k-1}\\,{\\mathrm d}\\tau } = \\frac{1}{k}\\qquad \\text{for all } k\\in\\mathbb{n}^+ ( : = \\ { 1,2,3,\\dots \\}).\\end{aligned}\\ ] ]    the idea of the proof is similar to that of theorem 2.2 in @xcite .",
    "this theorem is proved by considering a free tree such that @xmath126 vertices are connected to a common vertex , e.g. @xmath95 \\tree[. { } [ . { } ] [ . { } ] [ . { } ] [ . { } ] ] ; \\end{tikztree}}$ ] for @xmath127 .",
    "any free tree of this type has two equivalent trees : @xmath128 $ ] and @xmath129 $ ] .",
    "the symmetry coefficients are easily calculated to be @xmath130 and @xmath131 .",
    "note that @xmath132 and @xmath133)$ ] . substituting @xmath134 and @xmath135 into",
    ", we obtain the condition .",
    "if a consistent csrk method is energy - preserving , then it follows that @xmath136    the idea of the proof is similar to that of lemma 2.3 in @xcite .",
    "to prove this condition , we introduce double bush trees . as illustrated in the picture below",
    ", a double bush tree @xmath137 is a free tree having @xmath138 leaves on the left side and @xmath139 leaves on the right side ( this figure is an example with @xmath140 and @xmath141 ) .",
    "\\(l ) at ( 0 cm , 0 cm ) ; ( r ) at ( 1 cm , 0 cm ) ; ( l1 ) at ( -0.4 cm , -0.4 cm ) ; ( l2 ) at ( -0.4 cm , 0.4 cm ) ; ( r1 ) at ( 1.4 cm , -0.4 cm ) ; ( r2 ) at ( 1.5 cm , 0 cm ) ; ( r3 ) at ( 1.4 cm , 0.4 cm ) ; at ( l ) ; at ( r ) ; at ( l1 ) ; at ( l2 ) ; at ( r1 ) ; at ( r2 ) ; at ( r3 ) ; ( l )  ( r ) ; ( l1 ) ",
    "( l ) ; ( l2 )  ( l ) ; ( r1 )  ( r ) ; ( r2 )  ( r ) ; ( r3 )  ( r ) ;    it is clear that @xmath142 is superfluous , and @xmath143 .",
    "there are four distinct but equivalent rooted trees for @xmath137 : @xmath144]$ ] , @xmath145 $ ] , @xmath146{\\begin{tikztree } \\node { } ; \\useasboundingbox ( 0.1,0 ) ; \\end{tikztree}}^q]$ ] and @xmath147{\\begin{tikztree } \\node { } ; \\useasboundingbox ( 0.1,0 ) ; \\end{tikztree}}^{q-1}]]$ ] ( it is clear that @xmath148 ) . here",
    "are examples for @xmath149 : @xmath150      \\tikzstyle{every node}=[draw , circle , fill = black , inner sep=1pt , minimum size=2 mm ]      \\tree[. { } [ .",
    "{ } [ . { } ] [ . { } [",
    ". { } ] [ . { } ] [ . { } ] ] ]   ] ; \\end{tikzpicture } , \\quad t_2 = \\begin{tikzpicture}[grow'=up , sibling distance=0.16 cm , level distance=0.4 cm , baseline=-0.02 cm ,      edge from parent/.style={draw , edge from parent path={(\\tikzparentnode ) -- ( \\tikzchildnode ) } } ]      \\tikzstyle{every node}=[draw , circle , fill = black , inner sep=1pt , minimum size=2 mm ]      \\tree[. { } [ .",
    "{ } ] [ . { } ] [ . { } [ .",
    "{ } ] [ . { } ] [ . { } ] ] ] ; \\end{tikzpicture } , \\quad t_3 = \\begin{tikzpicture}[grow'=up , sibling distance=0.16 cm , level distance=0.4 cm , baseline=-0.02 cm ,      edge from parent/.style={draw , edge from parent path={(\\tikzparentnode ) -- ( \\tikzchildnode ) } } ]      \\tikzstyle{every node}=[draw , circle , fill = black , inner sep=1pt , minimum size=2 mm ]      \\tree[. { } [ .",
    "{ } ] [ . { } ] ] [ . { } ] [ . { } ] [ . { } ] ] ; \\end{tikzpicture } , \\quad t_4 =   \\begin{tikzpicture}[grow'=up , sibling distance=0.16 cm , level distance=0.4 cm , baseline=-0.02 cm ,      edge from parent/.style={draw , edge from parent path={(\\tikzparentnode ) -- ( \\tikzchildnode ) } } ]      \\tikzstyle{every node}=[draw , circle , fill = black , inner sep=1pt , minimum size=2 mm ]      \\tree[. { } [ .",
    "{ } [ . { } [ .",
    "{ } ] [ . { } ] ] [ . { } ] [ . { } ] ] ] ; \\end{tikzpicture}.\\end{aligned}\\ ] ] thus , it follows that @xmath151 ) = \\int_0 ^ 1 \\int_0 ^ 1 b_\\tau c_\\tau ^{p-1 } a_{\\tau,\\zeta } c_\\zeta ^{q } \\ , { \\mathrm d}\\tau { \\mathrm d}\\zeta , \\\\ & a(b_-(t_2 ) ) = a({\\begin{tikztree } \\node { } ; \\useasboundingbox ( 0.1,0 ) ; \\end{tikztree}})^p a([{\\begin{tikztree } \\node { } ; \\useasboundingbox ( 0.1,0 ) ; \\end{tikztree}}^q ] ) = \\frac{1}{q+1 } , \\\\ & a(b_-(t_3 ) ) = a({\\begin{tikztree } \\node { } ; \\useasboundingbox ( 0.1,0 ) ; \\end{tikztree}})^q a([{\\begin{tikztree } \\node { } ; \\useasboundingbox ( 0.1,0 ) ; \\end{tikztree}}^p ] ) = \\frac{1}{p+1 } , \\\\ & a(b_-(t_4 ) ) = a([{\\begin{tikztree } \\node { } ; \\useasboundingbox ( 0.1,0 ) ; \\end{tikztree}}^{q-1},[{\\begin{tikztree } \\node { } ; \\useasboundingbox ( 0.1,0 ) ; \\end{tikztree}}^p ] ] ) = \\int_0 ^ 1 \\int_0 ^ 1 b_\\tau c_\\tau ^{q-1 } a_{\\tau,\\zeta } c_\\zeta ^{p } \\ , { \\mathrm d}\\tau { \\mathrm d}\\zeta.\\end{aligned}\\ ] ] the second and third are due to . the symmetry coefficients are calculated to be @xmath152 substituting @xmath153 , @xmath135 and @xmath134 into , we obtain the condition .",
    "we consider an @xmath154 matrix @xmath155 defined by @xmath156 we now show the following theorem .    [ maintheorem ] if a consistent csrk method for which @xmath157 is of full rank @xmath7 is energy - preserving , then @xmath158 .",
    "we see by contradiction that the consistency and the full rank assumption indicate @xmath159 . under the assumption @xmath159",
    ", we can rewrite the condition as follows . using the integration - by - parts formula , we have @xmath160_0 ^ 1 { \\mathrm d}\\zeta - \\frac{1}{p } \\int_0 ^ 1 \\int_0 ^ 1 c_\\tau^p a_{\\tau,\\zeta}^\\prime c_\\zeta^q \\ ,   { \\mathrm d}\\tau{\\mathrm d}\\zeta \\qquad ( a_{\\tau,\\zeta } ^\\prime = \\frac{\\partial}{\\partial \\tau } a_{\\tau,\\zeta } ) \\\\ & = \\frac{1}{p } \\int _ 0 ^ 1 b_\\zeta c_\\zeta^q \\,{\\mathrm d}\\zeta - \\frac{1}{p } \\int_0 ^ 1 \\int_0 ^ 1 c_\\tau^p a_{\\tau,\\zeta}^\\prime c_\\zeta^q \\ , { \\mathrm d}\\tau{\\mathrm d}\\zeta \\\\ & =   \\frac{1}{p(q+1 ) } - \\frac{1}{p } \\int_0 ^ 1 \\int_0 ^ 1 c_\\tau^p a_{\\tau,\\zeta}^\\prime c_\\zeta^q \\ , { \\mathrm d}\\tau{\\mathrm d}\\zeta .\\end{aligned}\\ ] ] similarly , @xmath161 substituting these relations into the condition , we have @xmath162 note that @xmath163 m   \\begin{bmatrix } 1 \\\\ \\zeta \\\\ \\vdots \\\\ \\zeta^{s-1 } \\end{bmatrix } c_\\zeta^q\\end{aligned}\\ ] ] and @xmath164 m   \\begin{bmatrix } 1 \\\\ \\zeta \\\\ \\vdots \\\\ \\zeta^{s-1 } \\end{bmatrix } c_\\zeta^p \\,{\\mathrm d}\\tau{\\mathrm d}\\zeta \\\\ & = \\int_0 ^ 1 \\int_0 ^ 1 c_\\zeta^q [ 1,\\zeta , \\dots , \\zeta ^{s-1 } ] m   \\begin{bmatrix } 1 \\\\ \\tau \\\\ \\vdots \\\\ \\tau^{s-1 } \\end{bmatrix } c_\\tau^p \\,{\\mathrm d}\\tau{\\mathrm d}\\zeta \\\\ & = \\int_0 ^ 1 \\int_0 ^ 1 c_\\tau^p [ 1,\\tau , \\dots , \\tau ^{s-1 } ] m ^\\top \\begin{bmatrix } 1 \\\\ \\zeta \\\\ \\vdots \\\\ \\zeta^{s-1 } \\end{bmatrix } c_\\zeta^q \\,{\\mathrm d}\\tau{\\mathrm d}\\zeta.\\end{aligned}\\ ] ] therefore , we have @xmath165 \\,{\\mathrm d}\\tau } ( m - m^\\top ) \\paren*{\\int_0",
    "^ 1 c_\\zeta^q \\begin{bmatrix } 1 \\\\ \\zeta \\\\ \\vdots \\\\ \\zeta^{s-1 } \\end{bmatrix } \\,{\\mathrm d}\\zeta } = 0 , \\label{eq : pmp}\\end{aligned}\\ ] ] which is equivalent to @xmath166 since we assume that the matrix @xmath157 is of full rank @xmath7 , it follows that @xmath158 .",
    "[ rem : con ] let us discuss the assumption about the rank of @xmath157 .",
    "the technique of the proof of is motivated by the proof of the necessary condition of symplectic rk methods , especially theorem  7.10 in ( * ? ? ?",
    "* chapter vi ) , where a similar @xmath167 matrix characterizes the reducibility of rk methods .",
    "in contrast to rk methods , however , we believe that for any consistent csrk methods the rank of the matrix @xmath157 is always of full rank @xmath7 . this conjecture can be easily verified for monotonic @xmath168 or the case the function space spanned by @xmath169 is dense in @xmath170 , \\",
    "v(0)=0 \\}$ ] , but the conjecture for more general cases has not been proved .",
    "we leave the proof of this conjecture to our future work .",
    "in this section , we characterize order conditions of energy - preserving csrk methods in terms of the matrix @xmath10 , based on the simplifying assumptions @xmath171 and construct several families of energy - preserving methods .",
    "the order of a csrk method satisfying the simplifying assumption @xmath172 , @xmath173 and @xmath174 is at least @xmath175 .",
    "the following two theorems can further simplify the order conditions .    for any consistent csrk methods with the property @xmath158 ,",
    "the @xmath172 condition is satisfied for all @xmath176 .    for any csrk methods with the property @xmath158",
    ", it follows that@xmath177 .",
    "the consistency indicates that @xmath178 .",
    "hence , it follows that for any @xmath126 @xmath179_0 ^ 1 = \\frac{1}{k}.\\end{aligned}\\ ] ]    for any consistent csrk methods with the property @xmath158 , the @xmath180 condition is equivalent to the @xmath181 condition .",
    "we prove @xmath182 is equivalent to @xmath183    due to @xmath158 , it follows that @xmath184 . recall that we always assume that @xmath185 , and the consistency indicates @xmath186 .",
    "let @xmath187 so that @xmath188 and @xmath189 .",
    "we start with . by using the integration - by - parts formula ,",
    "we see that is equivalent to @xmath190_0 ^ 1 -\\int_0 ^ 1 \\tilde{a}_{\\tau,\\zeta } k c_\\zeta^{k-1 } b_\\zeta\\,{\\mathrm d}\\zeta = \\frac{c_\\tau^{k+1}}{k+1}.\\end{aligned}\\ ] ] here , we note that @xmath191_0 ^ 1 = \\tilde{a}_{\\tau,1}=\\tilde{a}_{1,\\tau}$ ] . by changing @xmath21 and @xmath22 each other ,",
    "we obtain @xmath192 differentiating the both sides with respect to @xmath22 leads to @xmath193 which is equivalent to .",
    "note that is equivalent to due to @xmath194 .    in the following subsections ,",
    "we characterize the order conditions of energy - preserving csrk methods in terms of the matrix @xmath10 .",
    "first , we consider the simplest case @xmath196 .",
    "[ th : order2k ] a csrk method is energy - preserving and of order at least @xmath197 if the symmetric matrix @xmath198 satisfies @xmath199 where all components of @xmath200 are zero except for the @xmath126-th component which is @xmath201 .",
    "we obtain @xmath195 by substituting @xmath202 into , and this indicates that @xmath203 .",
    "we consider an integrator satisfying the @xmath173 condition .",
    "since @xmath204 this coincides with @xmath205 for any @xmath21 if and only if @xmath206    for the condition , it is possible to choose @xmath207 . in this case , is equivalent to @xmath208 and thus @xmath10 can be written as @xmath209 , where @xmath210 is the hilbert matrix defined by @xmath211 . in this case , the csrk method coincides with the avf collocation method of order @xmath212 .",
    "it is also possible to derive energy - preserving integrators which do not satisfy @xmath195 .",
    "we here illustrate a derivation of 4-degree fourth order integrators .",
    "let @xmath214 and write @xmath215 .",
    "then @xmath24 and @xmath168 are expressed as @xmath216 if the @xmath217 assumption is satisfied , we have @xmath218 this relation indicates that the polynomial degree of @xmath168 is at most 2 , because the polynomial degree in @xmath21 of the left hand side is 4 .",
    "we write @xmath219 among several possibilities for which @xmath220 .",
    "it follows from that @xmath221 hence , if a symmetric matrix @xmath10 satisfies @xmath222 the method has order 4 . as an example , if we select @xmath223 , this characterization reduces to @xmath224 in this case , @xmath10 can be expressed with three free parameters @xmath225 , @xmath226 and @xmath227 : @xmath228 it seems that @xmath229 are the simplest choices , and in this case @xmath10 is calculated to be @xmath230    as illustrated above , energy - preserving integrators can be obtained even for the cases @xmath213 . however ,",
    "such cases require larger degrees , and thus are less practical than the cases @xmath195 .",
    "in this section , we construct new energy - preserving methods which can be implemented more efficiently than the avf collocation method . in the context of rk methods , it is known that the computational cost of solving implicit rk methods can be reduced if a rk matrix @xmath231 has only real , distinct eigenvalues ( see , e.g.  @xcite ) .",
    "the key of the construction of new integrators is to apply similar idea to csrk methods and put it together with the energy - preserving condition and order conditions .      in general , in order to proceed with a rk process",
    ", we have to solve a system of nonlinear equations of size @xmath232 per each time step . here",
    "we explain that if the matrix @xmath231 has only real , distinct eigenvalues , the computational costs can be reduced , especially in a parallel architecture .",
    "we consider solving an @xmath7-stage implicit rk method @xmath233 in order to compute the internal stages @xmath234 , we have to solve a system of nonlinear equations @xmath235 where @xmath236 denotes the kronecker product , @xmath237 is an identity matrix and @xmath238 the size of the system is @xmath232 .",
    "we usually apply the simplified newton method to solve the nonlinear system , and then obtain the iteration formula @xmath239 where @xmath240 denotes the jacobian matrix , i.e. @xmath241 for hamiltonian systems .",
    "below , we show that the linear system of size @xmath232 can be computed efficiently if the matrix @xmath231 has only real , distinct eigenvalues .",
    "if all eigenvalues of @xmath231 are real and distinct , there exists a matrix @xmath242 such that @xmath243 let @xmath244 and define @xmath245 by @xmath246 .",
    "then it follows that @xmath247 where the right hand side expresses a block diagonal matrix .",
    "therefore , the formula is translated into @xmath248 where @xmath249 is calculated based on the following relation @xmath250 the key point of this idea is that the linear system of size @xmath232 consists of @xmath7 linear systems of size @xmath4 .",
    "below we consider to what extent the computational cost is reduced . for both approaches ,",
    "we equally pay @xmath251 operations to compute @xmath240 .",
    "* standard iteration based on .",
    "+ we compute the @xmath252 factors of @xmath253 , where a small constant times @xmath254 operations are needed",
    ". then we solve iteratively until convergence , where @xmath255 operations are needed per each iteration .",
    "+ note that the cost of the lu factorisation can be further reduced by making use of complex conjugate eigenvalues pairs  @xcite .",
    "for example , the cost of the lu factorisation for the 2-stage gauss method can be reduced from @xmath256 to @xmath257 .",
    "* iteration based on .",
    "+ we compute the @xmath252 factors of @xmath258 , where only @xmath259 operations are needed .",
    "they can be reduced to @xmath260 in a parallel architecture .",
    "next we solve iteratively until convergence , where only @xmath261 operations are needed , and they can be further reduced to @xmath262 if parallelism is available . note that although we compute and additionally , the computational costs of these parts are just @xmath263 , and thus less important .",
    "we apply the concept of the previous subsection for rk methods with real eigenvalues to csrk methods .",
    "first , let us express @xmath26 in as @xmath264 where @xmath265 is defined by @xmath266 we regard as a system of nonlinear equations in terms of @xmath267 : @xmath268 here we merely evaluate at the nodes @xmath269 .",
    "as this was done for rk methods , the expression is further re - expressed in a form @xmath270 where @xmath271 since the derivation of @xmath157 with respect to @xmath272 becomes @xmath273 the application of the simplified newton method for solving gives the iteration formula @xmath274 where the matrix @xmath275 is defined by @xmath276 therefore , if the matrix @xmath277 of a csrk method has only real , distinct eigenvalues , the csrk method can be implemented efficiently .",
    "the following theorem indicates that one does not have to be concerned about the @xmath42 values when evaluating the eigenvalues of @xmath277 .",
    "[ th : eie ] the eigenvalues of the matrix @xmath277 defined in are independent of the @xmath42 values .",
    "we define a vandermonde matrix @xmath278 note that the matrix @xmath279 is non - singular , if the @xmath42 values are distinct .",
    "below , we show that @xmath280 is independent of the @xmath42 values .",
    "we express @xmath20 as @xmath281 where @xmath282 are polynomials in @xmath22 . since @xmath283 , the matrix @xmath277 is expressed as @xmath284 therefore , it follows that @xmath285 in the second equality , the relation @xmath286 is used .",
    "the expression of @xmath280 can be further simplified . since @xmath287 where the matrix @xmath10 is defined in",
    ", the component of @xmath280 can be written as @xmath288 hence , we have the following formula @xmath289    in the following subsections , we construct efficient fourth and sixth order energy - preserving integrators by making use of the idea presented in this subsection .        we derive fourth order energy - preserving integrators .",
    "since the only fourth order csrk method with degree two is the avf method , we set the degree of csrk methods to @xmath290 .",
    "we also assume that @xmath291 . according to ,",
    "a csrk method is of order four if the symmetric matrix @xmath10 satisfies @xmath292 with a parameter @xmath293 .",
    "when @xmath294 , @xmath10 is analytically calculated to be @xmath295 the characteristic polynomial of the matrix : @xmath296 is found to be @xmath297 it follows that @xmath298 has three real , distinct roots if @xmath299 calculating the range of @xmath225 is easy , and exactly the same evaluation was done by butcher ",
    "imran  @xcite in the context of symplectic methods .",
    "since the new method surely preserves the energy , one may expect a good long - time behaviour . as a criterion of the long - time behaviour",
    ", we here consider the conjugate - symplecticity  @xcite .    a one - step method @xmath300 of order @xmath138",
    "is said to be conjugate - symplectic up to order @xmath301 ( @xmath302 ) , if there exists such a change of coordinates @xmath303 that is @xmath304 close to the identity and @xmath305 satisfies @xmath306 the modified equation of such a method is hamiltonian up to the terms of size @xmath307 , and thus the behaviour of the method is like that of a symplectic integrator on intervals of length @xmath308 .",
    "see  ( * ? ? ?",
    "* chapter  vi.8 ) for more details .    in  @xcite",
    ", it is proved that the avf collocation method of order @xmath309 ( @xmath212 in general ) is conjugate - symplectic up to order @xmath310 ( @xmath311 ) , but not conjugate - symplectic up to a higher - order .",
    "it follows from theorem  5.11 in hairer ",
    "zbinden  @xcite that the new method ( of order @xmath309 ) is conjugate - symplectic up to order @xmath310 but not conjugate - symplectic up to a higher - order , independently of the choice of @xmath225 .",
    "therefore , one could expect that the new fourth - order method behaves like the fourth - order avf collocation method in terms of conjugate - symplecticity .",
    "although the computational cost in each time step of the derived integrators is reduced to about one - eighth ( or one - fourth if the avf collocation method is implemented by making use of complex conjugate eigenvalues pairs ) , the actual local truncation error of the new integrators is worse than the avf collocation method .",
    "therefore , we here carefully consider the efficiency of the proposed integrators by taking both truncation errors and computational costs into consideration .",
    "below , we denote @xmath312 by @xmath313",
    ".    shows coefficients of the elementary differentials with trees of order 5 for the b - series expansions of the exact solution , the two - degree fourth - order avf collocation method and the proposed method .",
    "it is estimated that when we use the same stepsize the error of the proposed method is approximately @xmath314 times bigger than that of the fourth - order avf collocation method .",
    "on the other hand , for large problems , the computation of the proposed method is 8 ( or 4 ) times faster than the avf collocation method per each time step .",
    "thus it is fair to compare the local errors of the avf collocation method with the stepsize @xmath315 and the proposed method with stepsize @xmath15 at @xmath316 so that the overall computational costs are almost the same .",
    "the former is denoted by @xmath317 and the latter by @xmath318 .",
    "then the ratio of the errors at @xmath316 is roughly estimated to be @xmath319 therefore , the proposed method is more efficient than the fourth - order avf collocation method ( in the sense that the above ratio is less than @xmath201 ) if @xmath320 note that if we consider the new method is only 4 times faster than the avf collocation method , this range of @xmath313 changes to @xmath321 and thus the proposed method is still efficient .",
    "we next consider the derivation of five - degree sixth order integrators . since it turned out that intended integrators can not be constructed with @xmath214 , we here set @xmath322 .",
    "we also assume that @xmath291 .",
    "a csrk method is of order at least six if the symmetric matrix @xmath10 satisfies @xmath323 with parameters @xmath324 .",
    "recall that in the derivation of the three - degree fourth order integrators , it was easy to evaluate eigenvalues of the matrix , because there is only one free parameter .",
    "however , we find it increasingly difficult to do a similar estimate for sixth order integrators : the application of the sturm theorem is too complicated due to three free parameters . here",
    ", we only show that there are choices of parameters such that the matrix has only real , distinct eigenvalues , by giving a concrete choice .",
    "it is difficult to express the matrix @xmath10 analytically in terms of the parameters @xmath225 , @xmath226 and @xmath227 .",
    "thus , instead of requiring all eigenvalues of to be real , we require real eigenvalues of @xmath325    we write @xmath326 let @xmath327 .",
    "it is possible to find a parametric solution to the problem @xmath328 in terms of @xmath329 , @xmath330 and @xmath331 .",
    "one way of doing this is explained in step 1 below . here",
    "are three steps that need to be carried out to find a real root solution to @xmath332",
    "we choose the following parameters @xmath333 where @xmath135 and @xmath334 are real or purely imaginary numbers , so that the first and second degree terms in @xmath335 are both 0 .",
    "it is found that @xmath336 where @xmath337 .",
    "this polynomial has three real roots for @xmath338 $ ] where the upper bound is the real zero of @xmath339 we choose the parameters @xmath135 and @xmath334 so that @xmath338 $ ] .",
    "a possible choice is @xmath340 .",
    "we add small perturbation to @xmath225 or @xmath226 or @xmath227 in the correct direction so that the two zero roots remain real .",
    "for example , reducing @xmath227 by @xmath341 gives the real roots @xmath342    although the five - degree sixth order integrator has been derived above , it is still difficult to give a necessary and sufficient condition for the parameters @xmath225 , @xmath226 and @xmath227 such that the matrix has only real eigenvalues .",
    "therefore , we here leave the discussion about the efficiency untouched .",
    "in this paper , we have shown the energy - preserving condition of csrk methods for hamiltonian systems , characterized the order conditions and parallelizable condition in terms of the matrix @xmath10 . as applications ,",
    "we have derived new fourth and sixth order integrators which can be implemented more efficiently than the standard method , i.e. the avf collocation method . in the derivation",
    ", the eigenvalues of the matrix @xmath277 played an important role .",
    "we note several directions for future work . from a theoretical viewpoint",
    ", it is hoped that the conjecture discussed in will be solved .",
    "considering other applications of the energy - preserving condition of csrk methods would be interesting .",
    "we are currently trying to give a more systematic approach to deriving higher order efficient energy - preserving integrators .",
    "the authors are grateful for various comments by anonymous referees .",
    "the first author was supported by the research fellowship of the japan society for the promotion of science for young scientists .",
    "the second author was supported by the marsden fund of new zealand .                                          , _ on the conservation of the symplectic structure in the numerical solution of hamiltonian systems ( in russian ) _ , in numerical solution of ordinary differential equations , keldysh institute of applied mathematics , ussr academy of sciences , moscow , 1988 , pp ."
  ],
  "abstract_text": [
    "<S> high order energy - preserving methods for hamiltonian systems are presented . for this aim , an energy - preserving condition of continuous stage runge  </S>",
    "<S> kutta methods is proved . </S>",
    "<S> order conditions are simplified and parallelizable conditions are also given . </S>",
    "<S> the computational cost of our high order methods is comparable to that of the average vector field method of order two .    </S>",
    "<S> energy - preservation , continuous stage runge  kutta methods , parallelism    65l05 , 65l06 , 65y05 </S>"
  ]
}