{
  "article_text": [
    "the inverse ising problem has been intensively studied in statistical physics and computational biology in the past few years  @xcite .",
    "such studies are of huge practical and theoretical relevance . on one hand , the advent of techniques for multi - electrode recording and microarray measurement produces high - throughput biological data  @xcite .",
    "unveiling the biological mechanism underlying these experimental data poses a challenging computational problem . in the inverse ising problem ,",
    "one tries to construct a statistical mechanics description of the original system directly from the data , and it provides a promising tool for dimensional reduction in modeling vast amounts of biological data  @xcite . on the other hand , for guaranteeing the reliability of the obtained description , it is also necessary to examine the reconstruction performance of the inverse algorithms numerically and/or analytically by utilizing artificial data that are generated from a variety of known ising spin models  @xcite .    in general ,",
    "the experimental data are described by @xmath0 independent samples @xmath1 in which @xmath2 is an @xmath3-dimensional vector with binary components ( @xmath4 ) and @xmath3 is the system size .",
    "the ising model provides the least structured model to match the statistics of the experimental data as @xmath5,\\ ] ] where @xmath6 denotes all distinct spin pairs and the partition function @xmath7 depends on @xmath3-dimensional fields and @xmath8-dimensional couplings .",
    "these fields and couplings are chosen to yield the same first and second moments ( magnetizations and pairwise correlations , respectively ) as those obtained from the experimental data .",
    "the inverse temperature @xmath9 is absorbed into the strength of fields and couplings .",
    "based on magnetizations and correlations , the inference of fields and couplings of the ising model is a computationally hard problem especially for large systems .",
    "however , one can resort to mean - field methods , such as naive mean - field ( nmf )  @xcite , thouless - anderson - palmer ( tap ) equation  @xcite , sessak - monasson ( sm ) expansion  @xcite , and bethe approximation ( ba )  @xcite , to get an approximate solution to the inverse problem with computationally feasible costs .",
    "previous investigations have mostly focused on the inference of the coupling vector , whereas the inference error of fields has been less analyzed .",
    "in fact , external fields represent intrinsically preferred directions of @xmath10 , which are also very important for understanding information processing in real neuronal networks  @xcite and gene interaction networks  @xcite and for predicting protein structures from sequence data  @xcite .",
    "therefore , an accurate estimation of external fields is also highly desirable .    to this end",
    ", we propose the adaptive thouless - anderson - palmer ( adatap ) approach for the inverse ising problem and establish the framework on the basis of gibbs free energy and gaussian approximation .",
    "surprisingly , adatap yields a very accurate estimation of external fields , although some other mean - field methods are more competitive in predicting couplings .",
    "we confirm the efficiency of adatap on three kinds of mean - field models : the sherrington - kirkpatrick ( sk ) model  @xcite , the hopfield  @xcite model and the random orthogonal model ( rom )  @xcite ; other existing mean - field inverse algorithms are also compared .",
    "the outline of this paper is as follows .",
    "the adaptive tap approach to the inverse ising problem with quenched random fields is derived in sec .",
    "[ sec_adatap ] . in sec .",
    "[ sec_sim ] , extensive numerical simulations are carried out to test the inference performance of adatap on hopfield model , sk model and rom . the comparison with other existing mean - field methods",
    "is also made and discussed .",
    "concluding remarks are given in sec .",
    "[ sec_sum ] .",
    "for the ising model defined in eq .",
    "( [ ising ] ) , we write the magnetization - dependent free energy ( also termed gibbs free energy ) as @xmath11 where the lagrange multiplier vector @xmath12 is introduced to fix magnetizations at all sites to their thermal expectation values , i.e. , @xmath13 .",
    "@xmath14 denotes the transpose of a vector @xmath15 .",
    "the notation @xmath16 stands for the extremum with respect to the corresponding parameters ( @xmath12 here ) .",
    "the exact evaluation of the partition function in eq .",
    "( [ gibbs ] ) is computationally difficult for a large system .",
    "however , one can resort to mean - field approximations .",
    "we adopt the following strategy .",
    "first , each coupling is multiplied by a real number @xmath17 $ ] , and the gibbs free energy can then be expressed by    [ gibbs02 ] @xmath18    where @xmath19 , and we have used gaussian statistics for the binary spins with expectation constraints , i.e. , @xmath20 which are enforced by a symmetric matrix @xmath21 . here , @xmath22 denotes the trace of a matrix @xmath23 . for simplicity",
    ", we assume @xmath21 is a diagonal matrix @xmath24 whose diagonal terms are determined via the extremization of the corresponding gibbs free energy . the gaussian approximation makes the computation of the partition function tractable .",
    "this scheme is also called the expectation consistence approximation  @xcite and was applied to derive the message - passing algorithm for the perceptron learning problem  @xcite .",
    "conventional plefka expansion  @xcite truncates the power series expansion of @xmath25 to second order in @xmath26 , but eq .",
    "( [ gibbs02a ] ) contains terms of all orders .",
    "note that the third term in eq .",
    "( [ gibbs02a ] ) is the gibbs free energy of non - interacting ising spins at fixed magnetizations and can be easily evaluated .",
    "the final expression for the gibbs free energy reads , @xmath27 where @xmath28 and @xmath21 follows the extremization condition of eq .",
    "( [ gibbs02c ] ) with @xmath29 , @xmath30 equilibrium values of magnetizations are determined by @xmath31 and the free energy @xmath32 .",
    "a quick calculation gives the self - consistent equation for @xmath33 , @xmath34,\\ ] ] which is exactly the adaptive tap equation first introduced in refs .",
    "@xcite for the ising model .",
    "( [ meq ] ) can also be derived under other mean - field approximations  @xcite .",
    "the third term inside the square bracket of eq .",
    "( [ meq ] ) forms the onsager correction term which requires no prior knowledge of the coupling statistics , playing an important role in inferring external fields .",
    "@xmath35 in eq .",
    "( [ meq ] ) is a function of @xmath36 determined by eq .",
    "( [ lambda ] ) .",
    "the fixed point of the self - consistent equation gives @xmath37 .",
    "we remark here that eq .",
    "( [ meq ] ) can be reduced to the normal tap equation obtained from a high - temperature expansion of the gibbs free energy  @xcite , i.e. , the third term inside the square bracket of eq .",
    "( [ meq ] ) becomes @xmath38 ( _ onsager reaction term _ ) through high - temperature expansion .    to obtain the inference equations for couplings , we use the identity @xmath39",
    "@xcite where @xmath40 is the hessian matrix of the gibbs free energy @xmath41 and @xmath42 is the connected correlation matrix whose entries are @xmath43 .",
    "@xmath44 is an identity matrix .",
    "magnetizations and correlations are already given by the experimental data in the inverse ising problem .",
    "finally , the inference equation reads @xmath45 for @xmath46 , where @xmath47^{2}$ ] which expresses how large the change of @xmath48 is given a small perturbation to @xmath49 and we define @xmath50 .",
    "the expression for @xmath51 is derived by using the sherman - morrison formula  @xcite .",
    "a small perturbation @xmath52 to @xmath49 will lead to a corresponding change of @xmath48 according to eq .  (",
    "[ lambda ] ) , which is described by the following equation : @xmath53_{ii}^{-1}=\\chi_{ii}-\\frac{\\delta\\lambda_{j}\\chi_{ij}^{2}}{1+\\delta\\lambda_{j}\\chi_{ij}}\\\\ = 1-(m_{i}+\\delta m_{i})^{2 } , % \\end{split}\\ ] ] where the sherman - morrison formula is used in the first equality and the notation @xmath54 means that only @xmath55-th diagonal term of matrix @xmath56 is non - zero and equal to @xmath52 . noting that both @xmath57 and @xmath52 are small",
    ", one can obtain @xmath58^{2}$ ] by using eq .",
    "( [ lambda ] ) once again .",
    "after couplings are reconstructed , external fields are inferred as @xmath59 to predict the coupling , we need to solve the adatap equation eq .",
    "( [ lambda ] ) .",
    "an iterative scheme is proposed as follows .",
    ": :    let @xmath60 and initialize    @xmath61 ,    @xmath62 for all    @xmath6 and @xmath63 respectively .",
    ": :    at @xmath64 , set @xmath65 ,    @xmath66 ,    @xmath67 .",
    "+    step 2.1 . ; ;      @xmath68 , update      @xmath69      where      @xmath70      for all @xmath63 .",
    "after update of each      @xmath71 ,      @xmath72 needs to be updated simultaneously      as      @xmath73      derived by using the sherman - morrison formula .",
    "step 2.2 ; ;      until @xmath74      for all @xmath63 , then assign      @xmath75 ,      @xmath76 and go to      * step 3*. otherwise , if @xmath77 , go to * step      2.1 * , else return un - converged .",
    ": :    @xmath78 , update    @xmath79    where    @xmath80^{2}$ ] ,    until @xmath81 for all    @xmath6 , then go to * step 4*. otherwise , if    @xmath82 , go to * step 2 * , else return    un - converged .",
    ": :    infer @xmath83 according to eq .",
    "( [ field ] ) for all    @xmath63 .    in step 2.1",
    ", the step size @xmath84 for updating @xmath85 can be derived by using eq .",
    "( [ lambda ] ) and the shermon - morrison formula , which gives @xmath86 . in the iterative scheme , we set the parameters @xmath87 , and @xmath88 . in practice , we find that both @xmath21 and @xmath89 in our simulations shown below converge in tens of steps when the temperature is not very low . the computational complexity of this iterative scheme is dominated by the inverse of the matrix ( e.g. , @xmath42 or @xmath90 ) , keeping the same order as that of other mean - field methods .",
    "to compare performances of different mean - field inverse algorithms , we define the inference error for couplings and fields , respectively , as    [ error ] @xmath91^{1/2},\\\\ \\delta_{h}&=\\left[\\frac{1}{n}\\sum_{i}(h_{i}^{*}-h_{i}^{{\\rm true}})^{2}\\right]^{1/2},\\end{aligned}\\ ] ]    where @xmath92 ( @xmath93 ) is the inferred coupling ( field ) and @xmath94 ( @xmath95 ) is the true one .",
    "we evaluate the inference performance of the adatap approach on three mean - field models with either gaussian distributed or bimodal distributed random fields . for the sk model ,",
    "each entry of the coupling matrix are independently drawn at random from a gaussian distribution with zero mean and variance @xmath96 . in the hopfield model",
    ", the coupling is constructed according to hebb s rule , i.e. , @xmath97 where @xmath98 random gaussian patterns @xmath99 are stored in the network .",
    "@xmath100 are independent gaussian random variables with zero mean and unit variance .",
    "we also test our method on rom whose coupling matrix is constructed as @xmath101 where @xmath102 is an orthogonal matrix chosen with the haar measure  @xcite . @xmath103 and @xmath104 follows a distribution @xmath105 .    .",
    "each data marker is the average over @xmath106 random realizations for which @xmath107 .",
    "( a ) results for the hopfield model with @xmath108 .",
    "( b ) results for rom with @xmath109 .",
    "( c ) results for the sk model .",
    ", title=\"fig:\",width=283 ] .05 cm .",
    "each data marker is the average over @xmath106 random realizations for which @xmath107 .",
    "( a ) results for the hopfield model with @xmath108 .",
    "( b ) results for rom with @xmath109 .",
    "( c ) results for the sk model .",
    ", title=\"fig:\",width=283].05 cm .",
    "each data marker is the average over @xmath106 random realizations for which @xmath107 .",
    "( a ) results for the hopfield model with @xmath108 .",
    "( b ) results for rom with @xmath109 .",
    "( c ) results for the sk model .",
    ", title=\"fig:\",width=283].05 cm    to collect the data of magnetizations and correlations , we use the exact enumeration on small - size systems of @xmath110 , which produces noise - free data for predicting the underlying parameters . in this case , @xmath111 .",
    "inference results of adatap on these three tested models are compared with those obtained by other mean - field methods . for comparison , we briefly describe the other four existing mean - field methods for the inverse ising problem .",
    "the couplings between spin @xmath63 and @xmath55 ( @xmath46 ) are inferred as follows :    [ mfeq01 ] @xmath112,\\end{aligned}\\ ] ]    where @xmath113 $ ] , @xmath114 , @xmath115 and @xmath116 .",
    "after couplings are inferred , fields can be predicted using the following equations :    [ mfeq02 ] @xmath117    where @xmath118 and @xmath119 .",
    "since sm expansion has large inference errors for predicting fields even when considering up to the third order in the small correlation expansion  @xcite , we would not show its field inference performances for the temperature range we consider .",
    "we first examine the inference performance of adatap on mean - field models , where quenched random fields are drawn independently at random from a gaussian distribution with zero mean and variance @xmath120 . as displayed in fig .",
    "[ perf ] ( a ) for the hopfield model , adatap shows slightly better performance than the tap approach in coupling constructions , whereas the sm expansion has the best performance at high temperatures and the ba has the best one at low temperatures .",
    "regarding field inference , adatap performs much better than other methods in the entire temperature range under consideration .",
    "however , if we incorporate an effective self - coupling ( diagonal weight ) @xmath121",
    "@xcite into the inference equation  ( [ nmfh ] ) , nmf with diagonal weights ( nmfdw ) will achieve the nearly same accuracy with adatap in predicting external fields , although adatap still gives a bit lower inference error .",
    "this also holds for the other two mean - field models .",
    "note that nmf without diagonal weights definitely gives a highest inference error among all mean - field methods compared here . as the temperature becomes sufficiently low",
    ", adatap ceases to converge within @xmath122 or @xmath123 , thus becoming unable to predict couplings and fields . to infer a model with quenched random fields , tap and ba",
    "will also have no solution at low enough temperatures .",
    "we also performed simulations with a larger @xmath120 ( e.g. , @xmath124 ) , and it is observed that the field inference performance deteriorates and adatap fails to converge at a higher temperature for some samples compared to the case with a smaller field variance .",
    "[ perf ] ( b ) shows inference results for rom with the random orthogonal coupling matrix .",
    "although adatap behaves slightly worse than tap for inferring couplings , it produces surprisingly accurate estimates of external fields in the entire temperature range in fig .",
    "[ perf ] ( b ) .",
    "note that the inference accuracy obtained by other mean - field methods ( except nmfdw ) can be further improved by at least one order of magnitude by using adatap when the random fields are gaussian distributed . for coupling inferences of the sk model ( see fig .",
    "[ perf ] ( c ) ) , the performance of adatap lies between those of nmf and tap , while the sm expansion gives a more accurate prediction than other methods at high temperatures .    .",
    "each data marker is the average over @xmath106 random realizations for which @xmath125 .",
    "( a ) results for the hopfield model with @xmath108 .",
    "( b ) results for rom with @xmath109 .",
    "( c ) results for the sk model .",
    ", title=\"fig:\",width=283 ] .05 cm .",
    "each data marker is the average over @xmath106 random realizations for which @xmath125 .",
    "( a ) results for the hopfield model with @xmath108 .",
    "( b ) results for rom with @xmath109 .",
    "( c ) results for the sk model .",
    ", title=\"fig:\",width=283].05 cm .",
    "each data marker is the average over @xmath106 random realizations for which @xmath125 .",
    "( a ) results for the hopfield model with @xmath108 .",
    "( b ) results for rom with @xmath109 .",
    "( c ) results for the sk model .",
    ", title=\"fig:\",width=283].05 cm    ) , compared with nmfdw and ba ( exact method on a tree model ) .",
    "each data marker is the average over @xmath126 random realizations .",
    ", width=283 ]    fortunately , the superiority of adatap for field inference is also true when the random field is bimodal distributed , i.e. , @xmath127 .",
    "its performance is shown in fig .",
    "[ perfb ] with @xmath128 .",
    "the improvement of the field prediction by adatap is evident in this case , even compared to nmfdw . in adatap , we still assume zero diagonal couplings , however , the third term inside the square bracket of eq .",
    "( [ meq ] ) provides an adaptive onsager correction to the nmf approximation , playing the same key role with diagonal couplings in inferring external fields . in this adaptive manner , lower inference error of fields and couplings is achieved compared to nmfdw .",
    "interestingly , adatap can even perform better than tap in predicting couplings for certain ranges of temperatures in this case .    ) , compared with those obtained by other existing mean - field methods .",
    "magnetizations and correlations used to infer fields and couplings are calculated through exact exhaustive enumeration on networks of size @xmath110 .",
    "each data marker is the average over @xmath106 random realizations .",
    "( a ) results for the gaussian distributed random fields with @xmath107 .",
    "( b ) results for the bimodal distributed random fields with @xmath125 .",
    ", title=\"fig:\",width=283 ] .05 cm ) , compared with those obtained by other existing mean - field methods .",
    "magnetizations and correlations used to infer fields and couplings are calculated through exact exhaustive enumeration on networks of size @xmath110 .",
    "each data marker is the average over @xmath106 random realizations .",
    "( a ) results for the gaussian distributed random fields with @xmath107 .",
    "( b ) results for the bimodal distributed random fields with @xmath125 . , title=\"fig:\",width=283].05 cm    all the models investigated so far are of the fully connected type . for examining the capability to deal with another extreme of sparsely connected networks ,",
    "the proposed scheme is also tested on a tree model .",
    "our proposed scheme performs better than other methods except ba which is exact on a tree and gives very accurate inference both on the couplings and fields . the result is shown in fig .  [ tree ] . a tree of size @xmath129",
    "is constructed , such that each node inside the tree has degree equal to @xmath130 , and to mimic an infinite bethe lattice , we generate the external fields for the boundary spins as @xmath131 , where @xmath55 is the only spin inside the tree connected to the boundary spin @xmath63 and the cavity field @xmath132 is randomly chosen from a population dynamics for an infinite bethe lattice  @xcite .",
    "couplings and fields ( @xmath83 for the boundary spins ) for the tree follow gaussian distributions @xmath133 and @xmath134 respectively .",
    "magnetizations and correlations are calculated by using susceptibility propagation algorithms  @xcite .",
    "however , in real applications , for example , a typical neuronal network of size around @xmath135 is not strongly diluted with an exact tree structure , therefore , our method is expected to still give good estimates of external fields .",
    "to confirm this point , we test adatap on a diluted sk model , where each non - zero gaussian distributed coupling is present with a predefined probability @xmath136 .",
    "the gaussian distribution has zero mean and variance @xmath137 with @xmath138 . as shown in fig .",
    "[ perfc ] , the adatap still performs better than other mean - field methods ( including nmfdw ) in field inference , which is much more evident when random fields are bimodal distributed .",
    "although adatap , tap , and the ba will have no solution in inferring mean - field models with quenched random fields at low temperatures , adatap does outperform other existing mean - field methods compared here to infer quenched random fields if it converges , as shown for a wide range of temperatures on the hopfield , random orthogonal and ( diluted ) sk models .",
    "we conclude that the power of adatap for inverse ising problems resides in its remarkable accuracy in predicting external fields , especially for the case where there is a single dominant state in phase space .",
    "in summary , we propose the adatap approach for inverse ising problems and show its striking performance for inferring external fields in mean - field models . as far as the field inference is concerned , adatap is rather satisfactory , compared to other mean - field methods .",
    "furthermore , an accurate inference of external fields in the ising model is able to provide us with insights into the mechanism underlying high - throughput data either coming from biological experiments or from large databases  @xcite . the proposed adatap approach for the inverse ising problem is expected to have applications in real data analyses ( e.g. , neural data , or sequences in the protein databases ) , in combination with other mean - field methods .",
    "we thank the referees for their helpful comments and suggestions .",
    "this work was partially supported by the jsps fellowship for foreign researchers ( grant no .",
    "@xmath139 ) ( hh ) and jsps kakenhi nos . @xmath140 and @xmath141 ( yk ) ."
  ],
  "abstract_text": [
    "<S> the adaptive thouless - anderson - palmer equation is derived for inverse ising problems in the presence of quenched random fields . </S>",
    "<S> we test the proposed scheme on sherrington - kirkpatrick , hopfield , and random orthogonal models and find that the adaptive thouless - anderson - palmer approach allows surprisingly accurate inference of quenched random fields whose distribution can be either gaussian or bimodal , compared with other existing mean - field methods . </S>"
  ]
}