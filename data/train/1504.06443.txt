{
  "article_text": [
    "numerical linear algebraic solvers for large matrices have strong needs among various applications with the current and next - generation supercomputers . nowadays scalapack@xcite is the _ de facto _ standard solver library for parallel computations but several routines give severe bottlenecks in the computational speed with current massively parallel architectures .",
    "novel solver libraries were proposed so as to overcome the bottlenecks .",
    "since the performance of numerical routines varies significantly with problems and architectures , the best performance is achieved , when one constructs an optimal hybrid among the libraries .",
    "the concept of hybrid solver is illustrated in fig .",
    "[ fig : concept ] .",
    "it is a numerical middleware and has a unique data interface to real applications .",
    "one can choose the optimal workflow for each problem without any programming effort .",
    "the present paper focuses on dense - matrix solvers for generalized eigenvalue problems ( geps ) in the form of @xmath2 with the given @xmath3 real - symmetric matrices of @xmath4 and @xmath5 .",
    "the matrix @xmath5 is positive definite .",
    "the eigenvalues @xmath6 and the eigenvectors @xmath7 will be calculated .",
    "the computational cost is @xmath8 or is proportional to @xmath9 .",
    "the present hybrid solvers are constructed among scalapack and the two newer libraries of elpa  @xcite , and eigenexa  @xcite .",
    "the elpa and eigenexa libraries are written in fortran and appeared in 2000 s for efficient massively parallel computations .",
    "the present paper is organized as follows ; section  [ sec - background ] explains the background from the electronic structure calculation .",
    "section  [ sec - workflow ] describes the mathematical foundation .",
    "sections  [ sec - benchmark ] and  [ sec - discussions ] are devoted to the benchmark results and discussions , respectively .",
    "the summary and future outlook will appear in sec .",
    "[ sec - summary ] .",
    "-type electronic wavefunction in an amorphous - like conjugated polymer ( poly-((9,9 ) dioctyl fluorine ) ) .",
    "the lower panel shows the atomic structure ( r@xmath10c@xmath11h@xmath12 ) @xcite .",
    "( b ) strong scaling plot by elses for one - hundred - million - atoms calculations on the k computer .",
    "@xcite the calculated materials are a nano - composite carbon solid ( the upper line ) and the amorphous - like conjugated polymer ( the lower line ) .",
    "the number of used processor nodes are from @xmath13 4,096 to 82,944 ( full nodes of the k computer ) .",
    "[ fig : graph - bench-100m - apf - nccs],width=226 ]",
    "the gep of eq .",
    "( [ eq - gev - eq ] ) gives the mathematical foundation of electronic structure calculations or quantum mechanical calculations of materials , in which an electron is treated as a quantum mechanical wave. the input matrix @xmath4 or @xmath5 of eq .",
    "( [ eq - gev - eq ] ) is called hamiltonian or the overlap matrices , respectively .",
    "an eigenvalue of @xmath6 is the energy of one electron and an eigenvector of @xmath7 specifies the wavefunction or the shape of an electronic wave. fig .",
    "[ fig : graph - bench-100m - apf - nccs](a ) shows an example of the wavefunction .",
    "the number of the required eigenvalues is , at least , on the order of the number of the electrons or the atoms in calculated materials .",
    "see the elpa paper  @xcite for a review , because elpa was developed under tight collaboration with electronic structure calculation society .    here , our motivation is explained .",
    "the present authors developed a large - scale quantum material simulator called elses @xcite .",
    "the theories are explained in refs .",
    "@xcite and the reference therein .",
    "the matrices are based on the real - space atomic - orbital representation and the matrix size @xmath14 is nearly proportional to the number of atoms @xmath15 ( @xmath16 ) .",
    "the simulations mainly use novel order-@xmath15 linear - algebraic methods in which the computational cost is order-@xmath15 ( @xmath17 ) or is proportional to the number of atoms @xmath15 .",
    "their mathematical foundation is sparse - matrix ( krylov - subspace ) solvers .",
    "efficient massively parallel computation is found in fig .",
    "[ fig : graph - bench-100m - apf - nccs ] , a strong scaling benchmark on the k computer @xcite with one hundred million atoms or one - hundred - nanometer scale materials .",
    "the simulated materials are a nano - composite carbon solid with @xmath18 or @xmath19 @xcite and an amorphous - like conjugated polymer with @xmath20 or @xmath21 @xcite .",
    "the present dense - matrix solvers are complementary methods to the order-@xmath15 calculations , because the order-@xmath15 calculation gives approximate solutions , while the dense - matrix solvers give numerically exact ones with a heavier ( @xmath8 ) computational cost .",
    "the use of the two methods will lead us to fruitful researches .",
    "the exact solutions are important , for example , when the system has many nearly degenerated eigen pairs and one would like to distinguish them .",
    "the exact solutions are important also as reference data for the development of fine approximate solvers .",
    "the matrices of @xmath4 and @xmath5 in the present benchmark appear on elses matrix library.  @xcite the library is the collection of the matrix data generated by elses for material simulations .",
    "the benchmark was carried out with the data files of nccs430080 , vcnt22500 vcnt90000 and vcnt1008000 for the matrix sizes of @xmath14=22,500 , @xmath14=90,000 , @xmath14=430,080 , @xmath14=1,008,000 , respectively .",
    "a large matrix data ( @xmath22 gb ) is uploaded as a set of split files for user s convenience .",
    "the physical origin of the matrices is explained briefly .",
    "the files in the present benchmark are carbon materials within modeled tight - binding - form theories based on _ ab initio _ calculations .",
    "the matrix of nccs430080 appears in our material research on a nano - composite carbon solid ( nccs ) @xcite .",
    "an sp - orbital form @xcite is used and the system contains @xmath23 atoms .",
    "the other files are generated for thermally vibrated single - wall carbon nanotubes ( vcnts ) within a supercell .",
    "an spd - orbital form @xcite is used and each system contains @xmath24 atoms .",
    "the vcnt systems were prepared , so as to generate matrices systematically in different size with similar eigenvalue distributions .",
    "we used these matrices for the investigation on @xmath25-electron materials with the present dense - matrix solver and the order-@xmath15 solver .",
    "a hybrid solver is constructed , when a routine is chosen for each subprocedure from scalapack , eigenexa and elpa .",
    "the code was developed as a general middleware that can be connected not only to elses but also to any real application software , as in fig .",
    "[ fig : concept ] . a mini - application was also developed and used in the present benchmark . in the benchmark",
    ", scalapack was used as a built - in library on each machine .",
    "eigenexa in the version 2.2a and elpa in the version 2014.06.001 were used .",
    "elpa and eigenexa call some scalapack routines .      the gep of eq .",
    "( [ eq - gev - eq ] ) can be written in a matrix form of @xmath26 where the matrix @xmath27 is diagonal and the matrix @xmath28 satisfies @xmath29 . in the solvers , the gep of eq .",
    "( [ eq - gev - eq ] ) is reduced to a standard eigenvalue problem ( sep ) of @xmath30 where the reduced matrix @xmath31 is real symmetric @xcite and the matrix of @xmath32 contain eigenvectors of @xmath31 .",
    "the reduction procedure can be achieved , when the cholesky factorization of @xmath5 gives the cholesky factor @xmath33 as an upper triangle matrix : @xmath34 the reduced matrix @xmath31 is defined by @xmath35 the eigenvectors of the gep , written as @xmath28 , are calculated from those of the sep by @xmath36 this procedure is usually called backward transformation .",
    "the gep solver is decomposed into the two subprocedures of ( a ) the solver of the sep in eq .",
    "( [ eq - sev - eq ] ) and ( b ) the reduction from the gep to the sep ( @xmath37 ) and the backward transformation ( @xmath38 ) .",
    "the subprocedures ( a ) and ( b ) are called sep solver and reducer , respectively , and require @xmath8 operations .",
    "figure  [ fig : eigentestdetailedflow ] summarizes the workflows of the possible hybrid solvers .",
    "a hybrid solver is constructed , when one choose the routines for ( a ) the sep solver and ( b ) the reducer , respectively .    for ( a ) the sep solver ,",
    "five routines are found in the base libraries ; one routine is a scalapack routine ( routine name in the code : pdsyevd ) that uses the conventional tridiagonalization algorithm .",
    "@xcite the elpa or eigenexa library contains a sep solver routine based on the tridiagonalization algorithm .",
    "the routine in elpa is called elpa1 ( routine name in the code : solve_evp_real ) in this paper , as in the original paper @xcite , and the one in eigenexa called eigen_s or eigs ( routine name in the code : eigen_s ) .",
    "elpa and eigenexa also contain the novel sep solvers based on the narrow - band reduction algorithms without the conventional tridiagonalization procedure .",
    "the solvers are called elpa2 ( routine name in the code : solve_evp_real_2stage ) for the elpa routine and eigen_sx or eigx ( routine name in the code : eigen_sx ) for the eigenexa routine in this paper .",
    "see the papers  @xcite for details .    for ( b ) the reducer ,",
    "three routines are found in the base libraries and are called scalapack style , elpa style , and eigenexa style reducers in this paper . in the scalapack style , the cholesky factorization , eq .",
    "( [ eq - chole - decmp ] ) is carried out and then the reduced matrix @xmath31 , defined in eq .",
    "( [ eq - a - atau ] ) , is generated by a recursive algorithm ( routine name pdsygst ) without explicit calculation of @xmath39 nor @xmath40 .",
    "details of the recursive algorithm are explained , for example in ref .",
    "@xcite . in the elpa style ,",
    "the cholesky factorization ( routine name : cholesky_real ) is carried out , as in the scalapack style , and the reduced matrix @xmath31 is generated by the explicit calculation of the inverse ( triangular ) matrix @xmath41 ( routine names : invert_trm_real ) and the explicit successive matrix multiplication of @xmath42 ( routine names : mult_at_b_real ) @xcite .",
    "from right , while a sample code in the elpa package uses the elpa routine ( mult_at_b_real ) .",
    "we ignore the difference , since the elapse time of the above procedure is not dominant . ] in the eigenexa style , the cholesky factorization is not used . instead",
    ", the sep for the matrix @xmath5 @xmath43 is solved by the sep solver ( eigen_sx ) , with the diagonal matrix of @xmath44 and the unitary matrix of @xmath45 .",
    "a reduced sep in the form of eq .",
    "( [ eq - sev - eq ] ) is obtained by @xmath46 because of @xmath47 and @xmath48 .",
    "equation ( [ eq - sev - eq - eigenexa ] ) is solved by the sep solver ( eigen_sx ) .    though the sep solver of eq .",
    "( [ eq - sev - eq ] ) requires a larger operation cost than the cholesky factorization ( see fig.1 of ref .",
    "@xcite , for example ) , the elapse time can not be estimated only from the operation costs among the modern supercomputers .",
    ".list of the workflows in the benchmark .",
    "the routine names for the sep solver and the reducer are shown for each workflow .",
    "abbreviations are shown within parentheses . [",
    "tab : workflows ] [ cols=\"^,^,^\",options=\"header \" , ]      the decomposition analysis of the elpa - style reducer is focused on , since the elpa - style reducer is fastest among the three libraries .",
    "figure  [ fig : combined_430080_k ] ( c ) shows the case on the k computer with @xmath14=430,080 .",
    "the elapse times of the subprocedures of the elpa - style reducer are plotted ; elpa(@xmath49) is the cholesky factorization of eq .",
    "( [ eq - chole - decmp ] ) , elpa(@xmath50) is the explicit calculation of the inversion @xmath51 of the cholesky factor @xmath33 , elpa(@xmath52) and elpa(@xmath53) are the successive matrix multiplication of eq .",
    "( [ eq - a - atau ] ) and elpa(@xmath54) is the backward transformation of eigenvectors by matrix multiplication of eq .",
    "( [ eq - backward - trans ] ) .",
    "the elapse times of the cholesky factorization in the scalapack style reducer is also plotted as scla(@xmath49) as a reference data .",
    "the same decomposition analysis is carried out also for other cases , as shown in fig .",
    "[ fig : reducerdetail ] .",
    "one can observe that the cholesky factorization of the elpa - style reducer does not scale and sometimes is slower than that of the scalapack reducer .",
    "in particular , the saturation of the elpa - style reducer is caused by that of the cholesky factorization in fig .",
    "[ fig : reducerdetail ] ( a)(b)(c ) .",
    "the above observation implies that the reducer can be a serious bottleneck in the next - generation ( exa - scale ) supercomputers , though not in the present benchmark .",
    "one possible strategy is the improvement on the cholesky factorization for better scalability and another is the development of a reducer without the cholesky factorization , as in the eigenexa - style reducer .",
    "= 90,000 and ( b ) @xmath14=22,500 , ( ii ) on fx10 with ( c ) @xmath14=90,000 and ( d ) @xmath14=22,500 , ( iii ) on altix with ( c ) @xmath14=90,000 and ( d ) @xmath14=22,500 .",
    "the ideal speedup in parallelism is drawn as a dashed gray line.,width=321 ]",
    "in summary , hybrid gep solvers were constructed between the three parallel dense - matrix solver libraries of scalapack , elpa and eigenexa .",
    "the benchmark was carried out with up to a million dimensional matrix on the k computer and other supercomputers . the hybrid solvers with elpa and eigenexa",
    "give better benchmark results than the conventional scalapack library .",
    "the code was developed as a middleware and a mini - application and will appear online .",
    "several issues are discussed . in particular",
    ", the decomposition analysis of the elapse time reveals a potential bottleneck part on next - generation ( exa - scale ) supercomputers , which indicates the guidance for future development of the algorithms and the codes .    as a future outlook",
    ", the present code for the hybrid solvers is planned to be extended by introducing the solvers with different mathematical foundations .",
    "a candidate is the parallel block jacobi solver @xcite .",
    "since the solver is applicable only to standard eigenvalue problems , the hybrid solver enables us to use the solver in generalized eigenvalue problems .",
    "the authors thank to toshiyuki imamura and takeshi fukaya in riken advanced institute of computational science ( aics ) for fruitful discussions on eigenexa .",
    "the authors also thank to yusaku yamamoto in the university of electro - communications on the parallel block jacobi solver .",
    "this research is partially supported by grant - in - aid for scientific research ( kakenhi nos .",
    "25104718 and 26400318 ) from the ministry of education , culture , sports , science and technology ( mext ) of japan .",
    "the k computer of riken was used in the research projects of hp140069 , hp140218 , hp150144 .",
    "the supercomputer oakleaf - fx of the university of tokyo was used in the research project of 14-na04 in joint usage / research center for interdisciplinary large - scale information infrastructures in japan , in the large - scale hpc challenge project , information technology center , the university of tokyo and initiative on promotion of supercomputing for young or women researchers , supercomputing division , information technology center , the university of tokyo .",
    "we also used the supercomputer sgi altix ice 8400ex at the institute for solid state physics of the university of tokyo and the supercomputers at the research center for computational science , okazaki .",
    "tisseur , f. and dongarra , j. : parallelizing the divide and conquer algorithm for the symmetric tridiagonal eigenvalue problem on distributed memory architectures , siam j. sci .",
    "20 , issue 6 , pp .",
    "2223-2236 ( 1999 ) .",
    "poulson , j. , v. d. geijn , r. and bennighof , j. : parallel algorithms for reducing the generalized hermitian - definite eigenvalue problem , flame working note # 56 , the university of texas at austin , department of computer science , tech .",
    "tr-11 - 05 ( 2011 ) .",
    "sears , m.p .",
    ", stanley , k. and henry , g. : application of a high performance parallel eigensolver to electronic structure calculations , in proceedings of the 1998 acm / ieee conference on supercomputing ( sc 98 ) , orlando , fl ( 1998 ) .",
    "takahashi , y. , hirota , y. and yamamoto , y. : performance of the block jacobi method for the symmetric eigenvalue problem on a modern massively parallel computer , in proceedings of algoritmy 2012 , pp .",
    "151160 ( 2012 ) ."
  ],
  "abstract_text": [
    "<S> optimally hybrid numerical solvers were constructed for massively parallel generalized eigenvalue problem ( gep ) . </S>",
    "<S> the strong scaling benchmark was carried out on the k computer and other supercomputers for electronic structure calculation problems in the matrix sizes of @xmath0 with upto @xmath1 cores . </S>",
    "<S> the procedure of gep is decomposed into the two subprocedures of the reducer to the standard eigenvalue problem ( sep ) and the solver of sep . </S>",
    "<S> a hybrid solver is constructed , when a routine is chosen for each subprocedure from the three parallel solver libraries of scalapack , elpa and eigenexa . </S>",
    "<S> the hybrid solvers with the two newer libraries , elpa and eigenexa , give better benchmark results than the conventional scalapack library . </S>",
    "<S> the detailed analysis on the results implies that the reducer can be a bottleneck in next - generation ( exa - scale ) supercomputers , which indicates the guidance for future research . </S>",
    "<S> the code was developed as a middleware and a mini - application and will appear online .    </S>",
    "<S> tuandcrest[d14t1001b@edu.tottori-u.ac.jp ]    tuandcrest [ ]    massively parallel numerical library , generalized eigenvalue problem , electronic structure calculation , elpa , eigenexa , the k computer , mini - application </S>"
  ]
}