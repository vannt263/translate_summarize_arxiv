{
  "article_text": [
    "our aim is to approximate the dynamics of a high - dimensional system by a small number of variables , which include those quantities that determine fitness .",
    "we approximate the real distribution of allele frequencies by the stationary distribution obtained by the maxent method with a small number of constraints and use it as an ansatz in the diffusion equation .",
    "this leads to effective dynamical forces @xmath74 that yield the correct dynamics for the observed quantities .",
    "the assumption that the population is perturbed only through the forces @xmath32 is crucial to the success of our approximation .",
    "if we could manipulate individual allele frequencies in an arbitrary way , then the long - term evolution would become essentially unpredictable : initially rare alleles could increase to cause arbitrary changes as they eventually rose to appreciable frequency ( @xcite , fig .",
    "the overall strategy of the dynamical maxent ( dynmaxent ) approximation is summarized in table  [ tab2 ] while the terminology from statistical physics and quantitative genetics is in table  [ tab_terminology ] .",
    "various approximate methods , discussed in our work , are summarized in table  [ tab3 ] .",
    ".summary of the dynmaxent approach in four steps.[tab2 ] [ cols=\"^,<\",options=\"header \" , ]      any set of forces , @xmath32 , will cause the population to evolve to a stationary distribution @xmath75 ; this is the distribution that maximises entropy subject to constraints on @xmath70 , the @xmath76 being the lagrange multipliers . now",
    ", suppose that the forces change abruptly , from @xmath77 to @xmath78 and no further information about the system is provided .",
    "the expected observables , @xmath70 , will evolve towards the new stationary distribution . at any time",
    ", there will be a set of forces @xmath74 that would produce the current @xmath70 if the population were stationary ; we expect that the @xmath74 will evolve from @xmath77 to @xmath78 , as the population evolves from one stationary state to the other .",
    "thus , we can describe the dynamics either by the change in @xmath70 , or equivalently , by the change in the @xmath74 .    under the diffusion approximation , the expectations change as : @xmath79 where @xmath80 ( eqs .",
    "13 , 14 of @xcite ; note that in their eq .",
    "13 , the expectation should be taken over the whole equation , not inside the derivatives as typed ) .",
    "the expectations that appear on the left - hand side of are not the same as the ones on the right , therefore the system is not closed .",
    "we now introduce the continuous dynamic maximum entropy approximation ( cont .",
    "dynmaxent ) , namely , that the @xmath81 , @xmath82 in the dynamically changing system are approximated by the values that they would have at the corresponding stationary state that generates the actual @xmath70 ; the stationary distribution coincides with the maxent distribution . if the population were at a stationary state under the forces @xmath74 , chosen to produce the current expectations @xmath70 , then there would be no change : @xmath83 where the @xmath84 denotes values at the stationary distribution .",
    "the approximation has a form @xmath85 which gives eqn .",
    "15 of @xcite : @xmath86 it may be more convenient to follow the rates of change in the @xmath74 , which can be written in terms of the covariance of fluctuations in the @xmath33 . using matrix notation : @xmath87 where @xmath88 with an initial condition @xmath89 and @xmath90 .",
    "the difference @xmath91 represents the change in evolutionary forces . since the matrices @xmath92 and @xmath93 depend only on the effective forces @xmath74 , as shown in appendix  [ apbc ] , the dynamical system for @xmath74 is closed .",
    "a detailed derivation of the dynmaxent method under more general conditions can be found in appendix  [ apderivation ] .",
    "intuitively , one may assume quasi - stationarity in , provided that the evolutionary forces @xmath35 change on a slower timescale than the time scales of selection ( @xmath94 ) , mutation ( @xmath95 ) and random drift ( @xmath66 ) .",
    "then , the adiabatic approximation in should be accurate not only for the predicted observables but also for the microscopic distribution . however",
    ", we will show that even when the evolutionary forces change abruptly , i.e. when @xmath91 is not small , the approximation remains accurate  even though there is no guarantee that the inferred microscopic distribution agrees with the correct one .",
    "the matrix @xmath96 can be seen as a generalization of the additive genetic covariance matrix , where the @xmath97 correspond to ( twice ) the marginal effects of the kth allele on the @xmath98 .",
    "the maximum entropy approximation consists in assuming that this matrix is approximately what one would obtain at equilibrium with the current @xmath70 .",
    "thus , is an extension to the `` breeder s equation '' @xcite which allows for quantities @xmath70 that can be any function of allele frequencies  not just trait means  and that allows for random fluctuations , mutational bias and non - additive selection .",
    "the dynmaxent method can be contrasted with the maximum caliber method , reviewed in @xcite .",
    "dynmaxent uses static observables to infer the correct stationary allele frequency distribution , but allows the lagrange multipliers to change in time in accordance with the known diffusion equation ensuring that the observables are correct at all times . on the other hand ,",
    "the maximum caliber method uses constraints on temporal characteristics to arrive at a distribution over the allele frequency paths with constant values of lagrange multipliers .",
    "dynmaxent is suitable for our problem since it only assumes knowledge of initial and changed evolutionary parameters and no further information on the properties of the allele frequency paths .",
    "when numbers of mutations are small ( i.e. @xmath0 , @xmath99 ) , we face a problem of diverging components in the continuous dynmaxent approximation due to a u - shaped allele frequency distribution ( for simplicity , we will consider a single locus ) .",
    "if @xmath100 this divergence is caused by diagonal elements of matrix @xmath96 that correspond to @xmath68 and @xmath69 , in particular @xmath101 for @xmath0 and @xmath102 for @xmath103 ( see appendix  [ apbc ] , [ apc ] for more detail )",
    ". therefore the continuous dynmaxent approximation fails completely in a regime of dynamic selection and mutation when @xmath0 or @xmath99 simply because the right hand side of the dynamical system is ill - defined .",
    "the breakdown of the continuous dynmaxent method , when number of mutations are small ( i.e. for small populations ) , is not a numerical problem but a fundamental limitation of the method itself .",
    "however , it can be avoided by considering a modified diffusion problem which does not aim to resolve all details of the allele frequency distribution close to the fixation and loss , but instead agrees with the original problem in terms of the probability that the allele frequency is extreme .",
    "we define the boundary layers as @xmath104 and @xmath105 $ ] for @xmath106 but finite .",
    "the value of the truncation parameter @xmath107 is discussed later but typically @xmath108 .",
    "we then replace the original diffusion equation with solution @xmath109 by a new system of partial differential equations with solution @xmath110 that agrees with the true dynamics in the following properties :    * the stationary distribution in the bulk is the same for both problems : @xmath111 for @xmath112 $ ] . *",
    "the stationary probabilities of extreme allele frequencies are the same for both problems : @xmath113 = \\int_0^\\ep \\psi(p , t=\\infty ) = \\int_0^\\ep \\psi_\\ep(p , t=\\infty)\\ ] ] and also @xmath114 = \\int_{1-\\ep}^1 \\psi(p , t=\\infty ) = \\int_{1-\\ep}^1 \\psi_\\ep(p , t=\\infty)\\ ] ] to the lowest order in @xmath107 .",
    "* as the truncation parameter goes to 0 , the problem converges to the original diffusion equation , i.e. it develops singularities at the boundaries : @xmath115    replacing the original diffusion equation by a set of coupled diffusion equations in different regions of the state space captures an important characteristic of the problem : the presence of multiple timescales in the allele frequency dynamics .",
    "when the system is perturbed from stationarity by a change in the lagrange multipliers ( selection , mutation , heterozygosity ) , for instance by a dramatic drop in mutation , the correct distribution very quickly adjusts to the form @xmath116 at the boundaries .",
    "only then does the mass in the interior slowly transfer to the vicinity of the fixed states to converge to the new stationary distribution .",
    "this results in a very fast dynamics of @xmath117 and @xmath118 , and a considerably slower dynamics of the trait mean and the mean heterozygosity .",
    "dynmaxent can capture these multiscale features only if it can incorporate a low and changing rate of mutation .",
    "the quick initial adjustment of the mutation rates is then naturally followed by a slow dynamics of the trait mean and heterozygosity , because the speed of the transfer of the mass between the fixed states is limited by the infrequent rate of mutation . similarly to other observables , the boundary masses can also be expressed as means of functions of allele frequency and thus treated as additional observables .",
    "the appropriate function is a characteristic function @xmath119}$ ] , where @xmath120 } =           \\begin{cases }              1 & p\\in [ a , b]\\,,\\\\              0 & \\text{else}\\ , .",
    "\\end{cases}\\ ] ] splitting the problem domain augments the degrees of freedom by @xmath121}\\rangle$ ] and @xmath122 } \\rangle$ ] , which control the boundary dynamics independently of the bulk dynamics , and the corresponding lagrange multipliers @xmath123 and @xmath124 . the values of @xmath125 and @xmath126 will be determined later .",
    "the general dynmaxent method , derived in appendix  [ apderivation ] and summarised below , provides a way to couple the boundary dynamics with the bulk dynamics to account for the multiscale features , and resolve the technical problems of the continuous method while keeping the same number of degrees of freedom as the continuous dynmaxent .",
    "we first split the allele frequency domain into the bulk part and the boundary part and define the diffusion equation separately in the three regions in appendix  [ apderivation ] .",
    "we couple the equations by a boundary flux that is consistent with the original diffusion equation , thus leading to the same probability mass at the boundaries as in the continuous dynmaxent method .",
    "the stationary distribution of the problem has the form @xmath127 with the normalization constant @xmath40 such that @xmath128 and the relative masses in the three regions are determined by constants @xmath125 and @xmath126 .",
    "the stationary distribution is not generally continuous at @xmath129 .",
    "however , it can still be obtained by maximising a relative entropy with a bounded base distribution @xmath130 complemented by the following constraints on @xmath70 and lagrange multipliers @xmath131 @xmath132 where instead of @xmath68 and @xmath69 that diverge at the boundaries we take their truncation to @xmath133 $ ] @xmath134 the two remaining parameters @xmath125 and @xmath126 are matched to satisfy conditions ( b ) , leading to @xmath135 this relationship ensures that the approximate stationary distribution has the same proportion of the mass at the boundaries to the stationary solution of the original diffusion .",
    "generalized to multiple loci , the maxent distribution has the form @xmath136 with @xmath40 such that @xmath137 .",
    "we remark that the reference distribution @xmath138 is the stationary distribution in the absence of selection and mutation .",
    "therefore , @xmath139 where @xmath140 is the state - dependent diffusion coefficient @xmath141    the diffusion equation in the split domain can be used to derive a new dynmaxent approximation for arbitrary mutation strengths .",
    "this is done similarly as in the continuous dynmaxent : using the ansatz and a quasi - stationarity assumption .",
    "the derivation , detailed in appendix  [ apderivation ] , leads to the same dynamics as the original method @xmath142 where is a closed dynamical system for @xmath74 .",
    "however , since constant prefactors in the stationary distribution depend on mutation rates , the matrix @xmath143 contains additional terms @xmath144 where the subtracted terms form a square matrix of the same dimension as @xmath145 .",
    "its leftmost columns , denoted by @xmath146 , represent a contribution to the terms @xmath147 .",
    "since the stationary distribution depends on the selection - related lagrange multipliers only through @xmath148 , similarly to the continuous dynmaxent method , all added terms are zero .",
    "in contrast , presence of the mutation - related lagrange multipliers in as the scaling factors results in additional terms added to @xmath149 and @xmath150 , forming the remaining two columns in .",
    "the components of the matrices @xmath151 and @xmath152 are functions of effective forces only , similar to the continuous dynmaxent approximation .",
    "the difference is that the expectations involve integrals through parts of the domain @xmath153 $ ] ( bulk part or boundary parts ) and thus the terms have to be evaluated numerically .",
    "in the following , we show the performance of the general dynmaxent method in the parameter regimes when the continuous dynmaxent is not applicable , because the dynamics become singular .",
    "these examples involve dynamic selection and mutation in the regime @xmath154 .",
    "performance of the dynmaxent approximation for different scenarios is compared to the discrete and continuous approximations in appendix  [ apcomp ] .",
    "here we consider a single locus under directional selection .",
    "as we show in appendix e , this also corresponds to the case of multiple loci with equal effects . despite its apparent simplicity",
    ", the system still contains @xmath66 degrees of freedom that capture the allele frequency distribution in a population of @xmath155 diploid individuals .",
    "the general dynmaxent approximation , based on a stationary maxent approximation , reduces the dynamics to a few degrees of freedom that correspond to the lagrange multipliers @xmath156 . for instance when @xmath157 the full dynamics in the @xmath66-dimensional space reduces to a 3-dimensional space @xmath158 .",
    "the general dynmaxent method is tested in the most challenging situation when the initially strong mutation suddenly changes to @xmath159 .",
    "the continuous dynmaxent method does not apply to this example due to two reasons .",
    "first , when effective mutation drops below @xmath160 or @xmath161 , the components of matrix @xmath162 diverge due to singularities of the stationary allele frequency distribution .",
    "second , even when the mutation rates are kept fixed at their terminal values ( @xmath163 , @xmath164 ) , resulting in a reduced dynamics , the continuous dynmaxent does not give correct dynamical predictions for small mutation rates . a closer look at the failures of the continuous dynmaxent method is in appendix  [ apc ] .    the general method ( with @xmath165 )",
    "gives a satisfactory estimate of the trait mean at the beginning of the adaptation process , shown in figure  [ fig_ex1f3 ] , while a quick drop in effective mutation , compensated by a change in the effective selection , results in a quick loss of polymorphism . when the equilibration of the effective mutation is too fast , the speed of the dynamics which are limited by effective mutation becomes slower than necessary and leads to underestimation of trait mean and @xmath166 .",
    "this can be observed over the medium timescale @xmath167 .    over long timescales ,",
    "the approximate dynamics accurately match the exact dynamics .",
    "when we employ an additional constraint on the mean heterozygosity , although no a priori selection is acting on it , we increase the number of degrees of freedom from three to four .",
    "while a general feature of variational approximations is that increase in the number of constraints leads to an improvement in the performance of the approximation , this particular choice yields a match that is almost indistinguishable in all four observables ( including the added @xmath168 ) , as shown in figure  [ fig_ex1f3 ] .    ,",
    "@xmath166 and @xmath169 , obtained by numerically solving the diffusion equation using a discretization of space and time where the explicit transition matrix is known , in blue dots and the general dynmaxent approximations in green color .",
    "we used @xmath170 and @xmath171 .",
    "the dashed green shows approximation with the three shown observables and the solid green uses an additional observable @xmath168 .",
    "( d ) changes in evolutionary forces that draw the system out of equilibrium include a rapid decrease in mutation , complemented by a change in selection strength .",
    "( e ) dynamics of lagrange multipliers in the general dynmaxent method when three constraints are employed : @xmath172 , @xmath166 and @xmath169 .",
    "( f ) dynamics of lagrange multipliers in the general dynmaxent method when four constraints are employed , including @xmath168 .",
    "[ fig_ex1f3 ] , scaledwidth=97.0% ]    the dynamics of lagrange multipliers in figure  [ fig_ex1f3 ] ( e - f ) demonstrates separation of timescales . an initial quick drop in mutation @xmath173 and subsequently @xmath174 to the vicinity of their steady states is compensated by the changes in @xmath175 ( and @xmath176 ) and followed by a slow relaxation of @xmath175 ( and @xmath176 ) to equilibrium once the mutation rates are barely changing .",
    "it is interesting that the dynamics of the effective forces differs significantly between cases ( e ) and ( f ) .",
    "here we consider that the population dynamics is driven not only by directional selection but also by selection on heterozygosity , i.e. overdominance .",
    "this yields stationary distributions that may have up to three modes : two modes represent peaks at the boundaries in the low mutation regime and an intermediate peak represents increased probability of heterozygous individuals .",
    "we consider an analogous example to example 1 but add initially strong selection on heterozygosity ( trimodal distribution of allele frequency ) that switches to a purely directional selection .    .",
    "( c - f ) the response of the observed quantities @xmath172 , @xmath168 , @xmath166 and @xmath169 .",
    "exact dynamics , obtained by numerically solving the diffusion equation using a discretization of space and time where the explicit transition matrix is known , are shown in blue dots , the general dynmaxent approximation is shown in green .",
    "we used @xmath170 and @xmath171 .",
    "[ fig_ex2f1 ] , scaledwidth=97.0% ]    figure  [ fig_ex2f1 ] shows an almost perfect agreement between the exact solution and the approximation despite the fact that the approximation is not built to capture rapid switches in the forces but , to the contrary , assumes that the forces change slowly .",
    "the effective forces do not capture the rapid change in the real forces on the system , but show a slow - fast relaxation to their new steady states . appendix  [ api ]",
    "shows a complementary simulation when the initial ( @xmath77 ) and terminal conditions ( @xmath78 ) are switched .",
    "the system follows a different trajectory in the direction @xmath177 and @xmath178 .    in all simulations , presented here ,",
    "we use @xmath179 ; such a threshold @xmath107 corresponds to an allele frequency of a single individual out of a population of size @xmath66 . in appendix",
    "[ apep ] , we provide additional simulations to show that there exists an optimal threshold @xmath180 , which minimizes the approximation error .",
    "moreover , we show that in the worst case scenario , where a strong change in selection is coincident with a low and changing mutation , the relative error of the approximation is on the order of 1 percent .      in the following example",
    ", we show the applicability of the dynmaxent approximation for the evolution of quantitative traits that depend on multiple loci with different effects .",
    "the state space of the system of @xmath5 independent loci contains essentially @xmath181 degrees of freedom since each locus is characterized by allele frequency distribution with @xmath66 degrees of freedom .",
    "the reduction of the dimensionality to three ( directional selection ) or four ( overdominance ) degrees of freedom thus offers an immense simplification of the problem where instead of tracking the full allele frequency distribution we are tracking just the dynamics of the lagrange multipliers @xmath182 , corresponding to the underlying constraints .",
    "how does the method perform for different distributions of effects ?",
    "a simple case , when all effects are the same ( @xmath183 ) , coincides with example 2 , since the dynamics become the same as for a single locus ( appendix  [ ape ] ) .",
    "we consider three distinct distributions of effects to demonstrate both the effect size distributions typically assumed , but also extreme examples .",
    "we chose a uniform distribution in @xmath184 $ ] , exponential distribution with mean 1 and a bimodal distribution with many loci of small effect and a few loci of large effect .",
    "we chose all distributions to have @xmath185 for an easier comparison .",
    "$ ] ; ( b ) exponential distribution with mean 1 ; and ( c ) deterministic effects where 95 of the loci have effects 0.01 while the remaining five loci have effects 19.81 . the distributions were chosen to have mean equal to one , to be comparable with single - locus simulations .",
    "the rapid decrease in mutation is complemented by a change in selection strength and by a change in the selection strength on heterozygosity as in example 2 .",
    "the true forces @xmath32 change at time @xmath186 and draw the system out of equilibrium .",
    "the response of the trait mean @xmath187 is shown in blue dots while the approximation is shown in green .",
    "the quality of the approximation for the remaining observables , @xmath168 , @xmath188 , and @xmath189 , can be found in appendix  [ ap_multi ] .",
    "exact dynamics , obtained by numerically solving the diffusion equation using a discretization of space and time where the explicit transition matrix is known , are shown in blue dots .",
    "the general dynmaxent approximation is shown in green .",
    "we used @xmath170 and @xmath171 .",
    "[ fig_ex3f3 ] , scaledwidth=97.0% ]    figure  [ fig_ex3f3 ] shows a comparison between the exact dynamics and the general dynmaxent approximation .",
    "all forces , including forward and backward mutation , were initially perturbed to a state where @xmath190 , the regime where the continuous approximation does not apply .",
    "when the distribution of effects was uniform or exponential , the approximation showed almost a perfect match with the true dynamics in all observed moments . intuitively , one expects that when the distribution of effects is strongly bimodal , with many small effects and a few large effects , the approximation will perform badly .",
    "this is because the large effect loci dominate the quick response of the system , while the small effect loci form a second wave of adaptation at a later time that is difficult to capture by the simple approximation schemes .",
    "figure  [ fig_ex3f3 ] shows these two timescales in the dynamics of lagrange multipliers .",
    "the approximation of the observables still gives a solid match , however , the second wave of adaptation due to small - scale efects is not perfectly accurate anymore .",
    "a central result in population genetics is that the stationary distribution of allele frequencies is the product of the neutral distribution , and the mean fitness raised to the power of population size : @xmath191 @xcite .",
    "this result can be interpreted via an optimisation principle : selection constrains the expected values of the traits that determine fitness , but the allele frequency distribution is distorted as little as possible by this constraint  the distortion being measured by ( minus ) the relative entropy .",
    "our approximation is to assume that this maxent principle holds even away from equilibrium , with the approximate distribution of allele frequencies having the stationary functional _ form _ at all times .",
    "this provides a variational ansatz for the diffusion equation and results in a set of dynamical equations for the parameters of the maxent distribution .",
    "this maximum entropy approximation can be justified in the limit of slowly changing conditions . yet , provided that mutation rates are above a critical threshold ( @xmath192 ) , it is remarkably accurate even in the worst case , when parameters change abruptly . even for a single locus , this approximation gives a substantial reduction in complexity : the whole distribution is described by a small number of dynamical variables that correspond directly to the forces of mutation and selection .",
    "the method extends directly to multiple loci , such that the joint distribution of allele frequencies can be approximated by a small number of variables .",
    "this paper extends the approximation to low mutation rates ( @xmath193 ) , where the original approximation breaks down completely .",
    "the problem is that when @xmath194 , populations are likely to be near fixation  that is , the distribution is concentrated near the borders .",
    "when mutation rates or population size change , the distribution near the boundaries changes immediately , whereas the distribution in the interior changes much more slowly .",
    "to see why this is so , think of the probability that a population carries one or a few copies of an allele . because the lifetime of such rare alleles is short , and is determined primarily by mutation and random reproduction",
    ", this probability changes rapidly with those processes , and in the short term , is independent of selection or of the total population size .",
    "in contrast , the distribution of polymorphic alleles in the interior changes slowly with changes in mutation rate , because it takes a long time for new mutations to reach high frequency , or for polymorphic alleles to be lost by drift .",
    "the maximum entropy approximation for the expectations of a set of traits , @xmath70 , extends the `` breeder s equation '' to include random fluctuations , mutation , and an arbitrary relation between selected traits and the underlying genotype .",
    "it takes the form @xmath195 , where @xmath196 is a generalisation of the additive genetic covariance , @xmath32 are the actual forces of selection and mutation , and @xmath74 are the effective forces that would yield same expectations @xmath70 .",
    "our extension is simply to modify @xmath197 by truncating the distribution of allele frequencies within a distance @xmath198 of the boundaries , thus suppressing its divergence for low mutation rates .",
    "the approximation is insensitive to the location of the truncation threshold , @xmath107 .",
    "we give examples of directional selection and dominance ; here , we assume additivity across loci , but @xcite show how the method applies to stabilising selection , which induces pairwise epistasis between loci .",
    "we emphasise that the approximation can be applied without detailed knowledge of individual loci : only the distribution of allelic effects is needed",
    ". the approximation can be also in principle generalized to traits with linkage disequilibrium .",
    "the constraints for such a case would also involve pairwise measures , for instance the correlations between loci .    like the maximum entropy approximation",
    ", the infinitesimal model ( @xcite , p.403 ) reduces the dimensionality of the dynamics by following trait values rather than individual alleles . however , these approaches are quite distinct .",
    "the infinitesimal model assumes that there are so many genes that the distribution of allele frequencies at each locus is hardly perturbed by selection ; thus , the genetic variance that segregates within families remains approximately constant .",
    "this is equivalent to assuming that @xmath199 on each allele is small @xcite .",
    "in contrast , the maximum entropy approximation can be applied to a single locus , with large @xmath199 , and predicts the change in genetic variance due to selection .",
    "the infinitesimal model is broader , in that it describes the effects of linkage disequilibrium  though because it assumes free recombination , these are only significant when selection on traits is strong ; see @xcite for an extension to allow linkage .",
    "however , if selection is weak enough that the population is at linkage equilibrium , the maximum entropy approximation will be more accurate than the infinitesimal model , because it accounts for the effects of selection on the genetic variances .",
    "of course , this does require knowledge of the distribution of effects of alleles , and their interactions .",
    "what are the possible applications of our results ?",
    "first , our results allow us to tractably predict the temporal evolution of interesting macroscopic observables , such as the trait mean or heterozygosity , even when these are determined by an arbitrary function of a single locus or multiple loci , under dynamically changing evolutionary forces .",
    "this is made possible by the drastic dimensionality reduction of the maximum entropy ansatz .",
    "the examples we presented here focused on exploring this `` forward prediction '' scenario in regimes where previously proposed approximation methods break down .",
    "the maximum entropy approximation predicts the evolution of the allele frequency distribution - yet almost always , we have only a single realisation of the evolution of any one locus",
    ". however , whole - genome sequencing gives us information about the frequencies of alleles at very large numbers of loci .",
    "if these can be treated as independent realisations of a process common to all loci ( or at least , all loci in a functional class ) , then we can apply our method .",
    "indeed , our assumptions are the same as those typically made in analysing the distribution of frequencies of synonymous versus non - synonymous variants : each allele is taken to have an additive effect on fitness , drawn from some specific distribution .",
    "usually , the distribution is assumed to be stationary . however , related species that have different effective population sizes ( e.g. @xcite ) , or newly formed sex chromosomes ( e.g. @xcite ) require a time - dependent analysis of the kind proposed here .",
    "second , our results have consequences for inference of evolutionary forces from genomic and phenotypic data .",
    "the success of the maximum entropy approximation suggests that the allele frequency distribution remains close to the stationary form , even when selection , mutation and population size are changing rapidly .",
    "this in turn suggests that it may be difficult to detect such changes from sequence data taken at a particular time point ; note that the moments of the allele frequency distribution correspond directly to the distribution of genealogies .",
    "this is consistent with the finding that unless selection is very strong ( @xmath200 ) , it has only weak effects on genealogical structure @xcite .",
    "however , there are several reasons why this conclusion may be too pessimistic . first , even when the maximum entropy approximation accurately predicts the expectations of the observables , the underlying distribution may not necessarily be close to the stationary form ( e.g. from @xcite , fig .",
    "second , when @xmath201 , sudden changes in population size and mutation rate cause immediate changes at the boundaries , so that the distribution deviates from the stationary form  which is the problem that we address here . indeed , it is relatively straightforward to detect strong population bottlenecks .",
    "third , specific events , such as the sweep to fixation of a single mutation , can be detected .",
    "however , such events occur even when the ensemble is at a stationary state , and so it may still be hard to find evidence for changing conditions . tests that use an out - group , or examine rates on a phylogeny ( e.g. @xcite ) can detect changes in selection , but require multiple species , and so are not covered by the arguments here .",
    "moreover , our argument from maximum entropy only applies to freely recombining loci : additional information may come from patterns along the genome , which depend on linkage disequilibria and on rates of recombination .",
    "lastly , if instead of data taken at a particular time point , we were provided with the temporal profile of changing observables @xmath202 , we could use our results to solve an inference problem and learn about the time courses of evolutionary forces @xmath203 .",
    "third , our results , together with previous relevant theoretical work , allow us to interpret the evolutionary process in information - theoretic terms .",
    "what is the meaning of entropy , beyond being simply a tool for approximation ? minus the relative entropy is the kullback - leibler distance , a measure of divergence from the neutral distribution .",
    "if we include mutation in the base distribution @xmath204 , then minus the relative entropy measures the degree to which selection concentrates populations around states of high fitness .",
    "following @xcite entropy changes can be seen as the information about its selective history that the population can transmit @xcite .",
    "arguably , concentration around fit states is a better measure of adaptation than the increase in mean fitness : though fitness differences determine the rate of adaptation , they do not measure the outcome .",
    "fitnesses may fluctuate , and absolute fitness must stay close to zero on average if populations are to persist .",
    "@xcite derive an intriguing relation between the gain in information ( equal to the reduction in entropy ) and the \" fitness flux ,  @xmath205 : @xmath206 \\ge - \\delta s \\quad \\text{where } \\quad \\phi = \\int_0^t \\sum_i \\beta_i \\delta p_i dt\\ ] ] ( corrects a factor 2 error in @xcite ) .",
    "this applies to a haploid population at linkage equilibrium , as assumed throughout this paper .",
    "selection may change arbitrarily over time , so that this relation gives a lower bound on the fitness flux , @xmath205 , that is required to achieve a given gain in information ( i.e. , reduction in entropy , @xmath207 ) . if selection changes slowly  as required for our maxent approximation to be accurate ",
    "then the inequality approaches an equality .",
    "the fitness flux can be separated into a component due to selection ( which must be positive and equal to the additive variance in fitness , @xmath208 ) , and the remaining components , due to mutation and drift . because forces other than selection are expected on average to act against adaptation , the latter component is negative , so that the additive variance in fitness should set a bound on the rate of information gain ( i.e. @xmath209 ) .",
    "our approximation states that even out of equilibrium , the distribution of allele frequencies minimises the information gain , subject to constraints on selected traits . by drastically reducing the dimensionality of the system , to cover only the expectations of selected quantities",
    ", we can simplify expressions for the total fitness flux and variance in fitness over the evolutionary trajectory , and may therefore be able to understand how these quantities limit the amount of information that can be accumulated by selection .",
    "the authors thank harold de vladar and richard kollr for helpful discussions .",
    "the research leading to these results has received funding from the european research council under the european union s seventh framework programme ( fp7/2007 - 2013 ) / erc grant agreement nr .",
    "250152 ( nb ) .",
    "this work was supported in part by human frontiers science program nr .",
    "rgp0065/2012 ( gt ) .",
    "the variational problem @xmath210 & = -\\int_{[0,1]^ { l } } \\psi(\\mathbf{p},t)\\log\\left [ \\frac{\\psi(\\mathbf{p},t)}{\\phi(\\mathbf{p})}\\right ] d\\mathbf{p }        \\end{aligned}\\ ] ] with @xmath211 subject to constraints @xmath212^l }   \\psi(\\mathbf p ) d\\mathbf p   = 1\\ , , \\quad \\int_{[0,1]^l }   \\mathbf a(p ) \\psi(\\mathbf p ) d\\mathbf p   = \\langle \\mathbf a \\rangle_\\text{obs}\\ , ,      \\end{aligned}\\ ] ] ( for example for directional selection and asymmetric mutation @xmath213 and @xmath214 ) can be solved by the method of lagrange multipliers , yielding an unconstrained maximization of a lagrangian @xmath215 & = s_h[\\psi ] - \\lambda\\left [ \\int_{[0,1]^l }   \\psi(\\mathbf p ) d\\mathbf p   -1\\right ]              - 2n \\sum_k   \\alpha_k \\left [ \\int_{[0,1]^l }   a _",
    "k\\psi(\\mathbf p ) d\\mathbf p                - \\langle \\mathbf a_k \\rangle_\\text{obs } \\right ]      \\end{aligned}\\ ] ] with multipliers @xmath216 and @xmath35 .",
    "the variational derivative of this function with respect to its argument @xmath217 is @xmath218 & =    \\int_{[0,1]^l }   \\delta \\psi \\left [ \\log \\frac{\\psi}{\\phi }           -1-\\lambda - 2n\\boldsymbol \\alpha \\cdot \\mathbf a \\right ] d\\mathbf p           \\end{aligned}\\ ] ] and leads to a solution @xmath219 where the normalization @xmath220 and the lagrange multipliers are such that observables are correctly matched .",
    "the distribution @xmath221 coincides with the stationary solution of the fokker - planck equation provided @xmath32 are the evolutionary forces ( selection , mutation ) and @xmath33 are the traits associated with the underlying processes .",
    "the evolutionary forces appear in the constrained optimization as lagrange multipliers @xmath76 .",
    "when @xmath223 and @xmath224 , the explicit form of matrix @xmath96 is @xmath225 since the expectation @xmath226^l } f(\\mathbf p ) \\bar \\psi ( \\mathbf p ) d\\mathbf p\\ ] ] is taken over the stationary distribution @xmath221 that depends on the effective parameters @xmath74 , the matrix @xmath92 is also a function of the effective evolutionary forces .",
    "the components of matrix @xmath92 may be calculated using special functions as in @xcite .",
    "similarly , the components of the matrix @xmath93 can be written as @xmath227 @xmath228 are functions of the microscopic allele frequencies and after averaging over the stationary distribution @xmath221 only the dependence on the effective forces @xmath74 remains .",
    "thus the right hand side of the vector equation is solely a function of effective evolutionary forces @xmath74 , forming a system of ordinary differential equations of dimension equal to the number of observables .",
    "as @xmath43 , @xmath44 become very small , the probability distribution becomes concentrated at the boundaries .",
    "the populations then switch between fixation for the favourable and deleterious alleles at a given locus and can be described by the fraction @xmath230 , @xmath231 , of populations fixed ( or nearly fixed ) for each allele @xmath232 the probability of fixation for the favourable allele is @xmath233 @xcite and the rates of substitutions of alleles by their counterparts , @xmath234 and @xmath235 , are @xmath236 hence , the exact dynamics in the regime of small mutation have a form : @xmath237    how does the standard maxent approximation compare , in the limit of low mutation rates ? we keep mutation rates fixed , and follow a single variable , @xmath238 ; we define the complementary variable @xmath175 as the selection that gives @xmath230 at stationarity . in the limit of low mutation rates : @xmath239 implying @xmath240 the same equilibrium formula is given by the ratio of substitution rates , @xmath241 . under the maxent approximation ,",
    "the rate of change is : @xmath242 moreover , in the limit of small mutation @xmath243 where the above expression has been obtained by computing contributions to the integrals separately for each of the boundaries @xmath244 $ ] and @xmath245 $ ] for @xmath246 and for @xmath247 .",
    "note that integration by parts has been used , resulting in the presence of the term @xmath248 in the denominator of .",
    "equation then becomes @xmath249 ( 4n\\!\\nu p-4n\\!\\mu q ) \\ , .",
    "\\end{aligned}\\ ] ] thus , the maxent approximation to the full distribution does not converge to the exact dynamics as mutation rates become small .",
    "nevertheless , the dynamics are approximated quite well , provided that selection is not too strong ( e.g. , @xmath250 ) .",
    "the maxent approximation greatly underestimates the rate of change at the margins , and gives no effect of selection at the exteme allele frequencies , see figure  [ fig_discrete ] , left ( all alphabetical figure citations refer to figures in the appendices ) .     discrete maxent approximation .",
    "( a ) the exact rate of change , obtained from the discrete model ( blue ) , compared with the maxent approximation ( green ) , in the limit of small @xmath251 ; @xmath252 ( bottom to top ) and @xmath170 .",
    "rates are scaled relative to the neutral mutation rate , assumed symmetric ( @xmath37 ) .",
    "( b ) dynamics following an abrupt switch from @xmath253 to the reverse . , scaledwidth=77.0% ]    however",
    ", the equilibria necessarily agree : the exact and the approximate rates of change are zero at the same point .",
    "the right plot in figure  [ fig_discrete ] shows the exact @xmath254 , and the maxent approximation ; these are close up to @xmath255 , but the solution becomes poor for @xmath256 ( upper pair of curves ) .",
    "the maxent solution is accurate for @xmath257 because @xmath230 remains within the interior ( @xmath258 ) , where the rate of change is approximated well .",
    "the log mean fitness will typically be a sum over moments of allele frequencies .",
    "for example , a selection gradient @xmath8 on a trait with mean @xmath259 will introduce a component where @xmath260 and @xmath261 ; model with dominance requires @xmath262 and @xmath263 and epistasis introduces mixed second order moments of the allele frequencies .",
    "thus , the matrix @xmath264 is an expectation over polynomial functions of allele frequencies , and is well - behaved .",
    "in contrast , the elements of @xmath264 that describe mutation diverge when @xmath0 or @xmath265 . to see this , consider a single locus for which @xmath266 , and the elements @xmath267 , @xmath268 , @xmath269 are @xmath270 , @xmath271 , @xmath272 .",
    "thus , @xmath267 diverges when @xmath273 , and @xmath269 diverges when @xmath274 .",
    "if we can assume that mutation rates are fixed , then we can avoid the difficulty either by fixing the mutation rates always at their actual values ( i.e. , @xmath275 , @xmath276 ) , or by choosing a reference distribution that includes mutation : @xmath277 , and dropping the observables @xmath68 , @xmath69 .",
    "these two approaches are equivalent since fixing the mutation rate leads to @xmath278 leading to the same dynamics for @xmath175 and @xmath176 as if the reference distribution included mutation .",
    "we first explore the continuous dynmaxent approximation for @xmath1 and compare its accuracy with @xmath0 .",
    "we study the worst - case scenario when a selection suddenly changes sharply from @xmath279 to @xmath280 ; this is by no means an adiabatic change .",
    "mutation equals @xmath281 where the first choice ( @xmath1 ) allows a full continuous dynmaxent approximation including constraints on @xmath117 and @xmath118 while the second and third choices require a fixed instantanous mutation rate and constraints on @xmath282 and @xmath283 dropped to keep the entries of the additive covariance matrix @xmath162 finite .",
    "figure  [ figc1 ] ( top row ) shows the predicted observables @xmath284 , @xmath285 and @xmath286 estimated by the continuous dynmaxent for each of the mutation rate alternatives compared with the exact solution , while keeping the heterozygosity fixed throughout the simulation ( not employing the constraint on @xmath287 ) .",
    "the method is accurate for @xmath288 ( where also the mutation changes dynamically ) but shows significant deviations from the true dynamics for @xmath289 .",
    "failure of the continuous dynmaxent approximation for strong selection .",
    "dynamical response to a fast change in selection @xmath290 to @xmath291 for symmetric mutation rates that are unperturbed and @xmath170 .",
    "each panel shows three simulations with mutation rates @xmath292 ( light - green to dark - green ) where the exact observables ( black ) are compared with the continuous dynmaxent approximation ( green , dashed ) .",
    "( a - c ) simulation with constraints @xmath293 , @xmath294 , @xmath283 when @xmath295 and a single constraint @xmath187 when @xmath296 .",
    "( d - f ) simulation with constraints @xmath21 , @xmath297 , @xmath294 , @xmath283 when @xmath295 and two constraints @xmath187 , @xmath297 when @xmath296.,scaledwidth=98.0% ]     we also show simulations ( d - f ) where the selection on heterozygosity @xmath9 is treated as a dynamical force , employing an additional constraint on @xmath297 .",
    "this increases the number of degrees of freedom in the approximate dynamics and affects the accuracy of the approximation .",
    "for instance , the decrease in performance for @xmath298 is partially caused by losing two degrees of freedom by fixing @xmath299 and @xmath300 .",
    "on the other hand , increase in accuracy in figure  [ figc1 ] ( bottom row ) is caused by introducing additional constraints on @xmath301 .",
    "this is visible both for @xmath302 where the number of lagrange multipliers was increased from three to four and for @xmath0 where the constraint on @xmath187 was complemented by the second constraint on a mean heterozygosity @xmath303 .",
    "figure  [ figc2 ] presents the dynamics of lagrange multipliers in the example in figure  [ figc1 ] where a sudden change in selection from @xmath279 to @xmath280 was applied to three systems , with different mutation rate @xmath304 . while in the superthreshold regime @xmath305",
    ", mutation is allowed to change in the continuous dynmaxent approximation , in the subthreshold regime @xmath306 it is fixed .",
    "effective coefficients @xmath74 of the continuous dynmaxent approximation for scenario of figure  [ figc1 ] . ( a ) @xmath307 , ( b ) @xmath308 , and ( c ) @xmath309",
    "are compared between the simulation without ( solid ) versus with ( dashed ) the heterozygosity as a degree of freedom .",
    "the population size is @xmath170 .",
    ", scaledwidth=98.0% ]    figure  [ figc2 ] suggests that increasing the number of constraints ; which increases the dimensionality of the problem , is associated with a slower convergence to a steady - state and a separation of timescales .",
    "this is visible both for @xmath302 ( left ) where the number of lagrange multipliers was increased from three to four and for @xmath0 where the constraint on @xmath187 was complemented by the second constraint on a mean heterozygosity @xmath303 .",
    "next , suppose that the scaled mutation rate is initially high enough that the stationary distribution is concentrated in the interior , but then abruptly falls below the threshold at which populations are typically near fixation : @xmath310 falls from 2 to 0.1 .",
    "( note that a fall in @xmath229 could also be due to a fall in population size rather than in mutation rate ) .",
    "we also assume that selection changes abruptly at the same time , i.e. , @xmath311 changes from @xmath312 to @xmath313 , in order to give the most challenging example : errors in estimating @xmath168 will be reflected in errors in the rate of change of the mean . immediately after the fall in scaled mutation rate , probability accumulates at the boundary and develops a boundary layer of a form @xmath314 that agrees with the stationary form , but polymorphism decays more slowly so the full distribution is not from the stationary class .",
    "the continuous dynmaxent fails to capture the true dynamics since the mutation rates have to be instantly adjusted to the terminal values .",
    "failure of continuous dynmaxent approximation for changing mutation @xmath0 and @xmath170 .",
    "( a ) changes in evolutionary forces that draw the system out of equilibrium include a rapid decrease in mutation , complemented by a change in selection strength .",
    "( b , d , e ) the response of the observed quantities @xmath172 , @xmath294 and @xmath283 .",
    "( c ) the initial and final stationary allele frequency distributions .",
    "( f ) the effective forces @xmath74.,scaledwidth=98.0% ]    figure  [ figc3 ] shows that three measures of diversity ( @xmath315 ) change rapidly , with @xmath316 falling most rapidly because they are more sensitive to the rapid changes near the boundary than @xmath168 . note that @xmath317 falls until @xmath318 , as probability accumulates close to @xmath45 (",
    "note the log scale on figure  [ figc3 ] ) , but then increases again more slowly , as favourable mutations substitute , transferring probability away from @xmath319 .",
    "the mean changes rapidly and substantially while heterozygosity is still high , but then changes more slowly after @xmath320 , when the genetic variance is low , and selection is limited by the influx of new mutations .    the changes in effective parameters @xmath74 are shown in figure  [ figc3 ] ( f ) . because we assume that the population is initially in its stationary state , these necessarily begin at their actual values ( @xmath321 , @xmath322 , @xmath323 ) .",
    "after the mutation rate decreases , the probability of being fixed increases rapidly , and therefore @xmath321 , @xmath324 fall quickly , approaching their new values by @xmath325 ; @xmath174 falls first , because the probability of being near @xmath45 increases faster than the probability of being near @xmath46 . over this time , @xmath326 changes even while the mean @xmath172 hardly changes , in order to compensate for changing @xmath229 , @xmath327 . at later times , when the effective mutation rates are constant and close to their actual ( low ) rates , @xmath328 increases as the mean changes .    fixing the effective mutation rates makes dynmaxent unable to capture transient properties of the adaptation process .",
    "the dynamics of the mean allele frequency follows @xmath329 where @xmath175 can be obtained at each time as a value that gives the current mean allele frequency given @xmath163 and @xmath330 .",
    "the effective directional selection can be further used to compute the change of observables , as displayed in figure  [ figc3 ] ( dashed blue ) .",
    "this continuous dynmaxent approximation fails to capture transient dynamics of the observed quantities but still converges to the correct state .",
    "if the exact dynamics are followed for a short time from the switch of the evolutionary forces and only then is the continuous dynmaxent approximation initialized , the approximation would more closely agree with the actual observables .",
    "this is because the real dynamics of the trait mean slows down in time as the system gets close to an equilibrium and therefore is better captured by an approximate process , whose speed of adaptation is limited by the small fixed mutation rate .",
    "we consider a directional selection acting on a single locus .",
    "the extension to multiple loci with different effects and overdominance is straightforward and discussed later .",
    "the failure of the continuous dynmaxent method , described in appendix  [ apd ] and [ apc ] requires a special treatment of the boundaries of the allele frequancy domain to avoid divergence of the method due to singularities in matrix @xmath162 .",
    "a naive resolution is to completely disregard the boundaries , and to simply truncate the allele frequency distribution .",
    "this ad hoc method , despite resolving problems with divergence of matrix @xmath162 , would not capture the dynamics at the boundaries very accurately , particularly in the small mutation regime .",
    "thus we approach the problem in a more pedantic way .",
    "first , we split the domain to the interior and the boundaries and propose a dynamical model that captures all essential processes .",
    "the new system depends on a truncation parameter @xmath107 , representing the width of the boundary layer .",
    "the stationary distribution of the system can still be represented as a solution of the variational problem with two additional constraints and lagrange multipliers , related to the boundary masses .",
    "the dynmaxent method can be derived for this expanded system .",
    "however , the resulting macroscopic dynamics of the effective forces involves inclusion of the coupling terms at @xmath331 which are microscopic quantities ; these are not in general accessible .",
    "therefore , we introduce an approximation that does not directly prescribe the probability fluxes but circumvents this by setting the total mass at the boundaries consistently with the continuous stationary distribution .",
    "this step is crucial for our approximation .",
    "the effect is that the expanded dynamics is brought back to a dimension where only the mutation and selection forces are followed .",
    "the derivation of the general dynmaxent approximation for a system where the stationary solution is a discontinuous function @xmath332 consists of the following steps :    * set up a piecewise - defined diffusion dynamics with the appropriate stationary solution .",
    "* use the stationary solution as an ansatz for a solution of the diffusion problem allowing only the lagrange multipliers to change in time . * derive dynamics of the means of observables from the above system and reduce it to a closed dynamical system for lagrange multipliers .",
    "\\(a ) diffusion equation can be written in the flux form @xmath333        \\end{aligned}\\ ] ] where the flux @xmath334 is defined as @xmath335 =                \\left [ \\mathcal{m}_i(p_i ) \\psi \\right ]              - \\frac{1}{2 }   \\frac{\\partial}{\\partial { p } } \\left [ \\mathcal{v}_i(p_i ) \\psi \\right]\\,.\\ ] ] we set up the dynamical system for @xmath336 separately in the three regions of the domain : @xmath337    =           \\begin{cases }              -\\frac{\\partial}{\\partial p } j_\\ep^1[\\psi_\\ep^1,p ]   & p\\in [ 0,\\ep)\\\\              -\\frac{\\partial}{\\partial p } j_\\ep^2[\\psi_\\ep^2,p ] & p\\in ( \\ep,1-\\ep)\\\\              -\\frac{\\partial}{\\partial p } j_\\ep^3[\\psi_\\ep^3,p ]   & p\\in ( 1-\\ep,1 ]          \\end{cases }      \\end{aligned}\\ ] ] where @xmath338 are the fluxes in the system with split domain @xmath339 =                \\left [ ( \\beta \\ep q -\\nu \\ep ) \\psi^1_\\ep \\right ]              - \\frac{1}{4n }   \\frac{\\partial}{\\partial { p } } \\left [ \\ep q \\psi^1_\\ep \\right ] \\\\",
    "j_\\ep^2[\\psi^2,p ] =               \\left [ ( \\beta pq -\\nu p + \\mu q ) \\psi^2_\\ep \\right ]              - \\frac{1}{4n }   \\frac{\\partial}{\\partial { p } } \\left [ pq \\psi^2_\\ep \\right ]",
    "\\\\              j_\\ep^3[\\psi^3,p ] =               \\left [ ( \\beta p\\ep + \\mu \\ep ) \\psi^3_\\ep \\right ]              - \\frac{1}{4n }   \\frac{\\partial}{\\partial { p } } \\left [ p \\ep \\psi^3_\\ep \\right ]           \\end{cases }      \\end{aligned}\\ ] ] and where the coupling between regions , which influences the probability of extreme allele frequencies , is set as @xmath340 & = &     0 \\label{j1}\\\\           j^3_\\ep[\\psi^3_\\ep,1 ] & = &   0 \\label{j2}\\\\          j^1_\\ep[\\psi^1_\\ep,\\ep ] & = & j^2_\\ep[\\psi^2_\\ep,\\ep ] =   j[\\psi,\\ep ] \\label{j3 } \\\\          j^2_\\ep[\\psi^2_\\ep,1-\\ep ] & = & j^3_\\ep[\\psi^3_\\ep,1-\\ep ] = j[\\psi,1-\\ep ] \\label{j4 }      \\end{aligned}\\ ] ] while the conditions - at @xmath341 ensure that the probability mass does not dissipate through the boundaries , the conditions at @xmath129 set the fluxes in accordance with the fluxes of the original continuous dynamics which are not explicitly known .",
    "this results in the same stationary solution in the bulk as in the original diffusion process .",
    "moreover , the probability masses at the boundaries will also agree with the standard problem since the fluxes are identical .",
    "the stationary solution , computed for @xmath342 as a solution of the problem @xmath343 = 0 $ ] , and analogously for subdomains @xmath344 and @xmath105 $ ] , has a form .",
    "moreover , setting the total mass at each subdomain equal to the corresponding mass of the stationary solution to leading order implies the choice of constant prefactors in .",
    "0.3 cm ( b ) the stationary distribution @xmath345 in depends on five parameters ( for directional selection ) , including @xmath125 and @xmath126 related to boundary masses .",
    "these parameters relate to a set of observables @xmath346 } , \\chi_{[1-\\ep,1 ] } ) $ ] as the corresponding lagrange multipliers @xmath347 .",
    "we derive the full dynmaxent method for this extended problem . only after the derivation of the full dynamics",
    "will we incorporate the relationship between @xmath348 and @xmath349 .",
    "we use an ansatz @xmath350 for the the solution of that expresses the non - stationary solution of the equation as a sum of a stationary distribution , with effective lagrange multipliers @xmath74 changing in time , and @xmath351 , representing the deviation from the stationary form .",
    "first we express the left - hand side of the using a chain rule : @xmath352 next we calculate each summand and for clarity drop the notation in the exponent of @xmath353 @xmath354 \\bar \\psi_\\ep\\ , ,      \\end{aligned}\\ ] ] where @xmath355 arises from differentiating @xmath40 , and @xmath356 from differentiating @xmath357 with respect to @xmath358 .",
    "this leads to @xmath359 \\frac{\\partial\\alpha^{\\ast}_k}{\\partial t }               + \\frac{\\partial \\delta}{\\partial t}\\ , .",
    "\\end{aligned}\\ ] ] next , we express the right - hand side of by artificially adding an expression @xmath360 $ ] .",
    "this term represents dynamics where the forces , applied to the system , equal the effective forces .",
    "due to stationarity the term equals zero .",
    "the reason for its inclusion is a cancellation of the diffusive part of the equation , that does not depend on @xmath32 .",
    "this leads to a simple outcome where each term contains the difference between the true and the effective force @xmath361 & = &           -\\frac{\\partial}{\\partial p } j_\\ep[\\bar \\psi_\\ep , p | \\boldsymbol \\alpha ]   +           \\frac{\\partial}{\\partial p } j_\\ep[\\bar \\psi_\\ep , p",
    "| \\boldsymbol \\alpha^\\ast ]",
    "\\\\          & = & -\\frac{\\partial}{\\partial p } \\left [ \\frac{\\sigma_\\ep ( p)}{2 }           \\sum_{k=1}^5 ( \\alpha_k - \\alpha^\\ast_k ) \\frac{\\partial a_k}{\\partial p } \\bar \\psi_\\ep \\right ]      \\end{aligned}\\ ] ] equation thus becomes @xmath362 \\frac{\\partial \\alpha^\\ast_k}{\\partial t }            + \\frac{\\partial \\delta}{\\partial t } =           \\nonumber\\\\          & & -\\frac{\\partial}{\\partial p } \\left [ \\frac{\\sigma_\\ep ( p)}{2 }           \\sum_{k=1}^5 ( \\alpha_k - \\alpha^\\ast_k ) \\frac{\\partial a_k}{\\partial p } \\bar \\psi_\\ep \\right ] -\\frac{\\partial j_\\ep [ \\delta , p]}{\\partial p }      \\end{aligned}\\ ] ] where the function @xmath363 in the bulk and @xmath364 and @xmath365 when @xmath366 and @xmath367 , respectively .",
    "0.3 cm ( c ) we then multiply the equation by @xmath368 and average through allele frequency distribution . the goal is to find effective forces @xmath74 such that the error terms vanish , i.e. the projection of the full dynamics to the space of macroscopic quantities @xmath33 is closed .",
    "since there are @xmath369 constraints and the same number of forces , such @xmath32 in principle exist and are unique .",
    "the most crucial implication is that the approximation of macroscopic quantities is forced to coincide with the exact values @xmath33 while the quasi - stationarity is valid .",
    "the equation becomes @xmath370 \\bar \\psi_\\ep dp    =           \\nonumber\\\\          & & - \\sum_{k=1}^5 \\int_0 ^ 1 a_j \\frac{\\partial}{\\partial p } \\left [ \\frac{\\sigma_\\ep ( p)}{2 }            ( \\alpha_k - \\alpha^\\ast_k ) \\frac{\\partial a_k}{\\partial p } \\bar \\psi_\\ep \\right ] dp      \\end{aligned}\\ ] ] next , we use integration by parts in the right - hand side of the equation .",
    "this introduces boundary terms , i.e. terms evaluated at @xmath371 coming from the integration by parts . we neglected these terms by assuming a rapid convergence to the stationary distribution and instantaneous adjustment of the fluxes at the boundaries of the subdomains to their stationary values .",
    "this stationarity assumption is adopted to avoid dependence of the approximation on the microscopic details of the distribution .",
    "this leads to to a relationship between the moment dynamics and dynamics of lagrange multipliers in the full model @xmath372 where @xmath373 and symmetric matrices @xmath374 and @xmath375 are obtained by averaging against the stationary @xmath107-dependent distribution @xmath376 } )               & \\text{cov}(\\bar z,\\chi_{[1-\\ep,1 ] } ) \\\\               & & & \\text{cov}(u_\\ep,\\chi_{[0,\\ep ] } ) & \\text{cov}(u_\\ep,\\chi_{[1-\\ep,1]})\\\\              & & & \\text{cov}(v_\\ep,\\chi_{[0,\\ep ] } ) & \\text{cov}(v_\\ep,\\chi_{[1-\\ep,1]})\\\\              \\ast&\\ast&\\ast&q(1-q)&-pq\\\\              \\ast&\\ast&\\ast&-pq&p(1-p )          \\end{array }          \\right ) \\label{bc5 }      \\end{aligned}\\ ] ] with @xmath377 and @xmath143 are defined as @xmath264 and @xmath378 but in the context of the truncated stationary distribution and constraints , and with @xmath379 denoting the symmetric terms .",
    "the boundary masses entering into matrix @xmath143 are defined as @xmath380 the matrix @xmath381 is padded by zeros because @xmath382}$ ] and @xmath383}$ ] vanish in the interior of the subdomains . by neglecting the boundary terms coming from the integration by parts in the above calculation we effectively limit the transfer of the mass between the bulk and the boundaries so that the boundary masses agree with the continuous stationary distribution .",
    "note that the stationary allele frequency distribution @xmath384 depends on the allele frequencies but also on the effective forces @xmath74 .",
    "therefore the matrices @xmath151 , @xmath152 , as well as matrices @xmath385 , @xmath386 , obtained by averaging over the microscopic states , are still functions of effective forces as in the continuous dynmaxent method [ apbc ] .",
    "however , because the averages require integration through the interior domain @xmath387 $ ] and separately through the boundaries @xmath388 $ ] and @xmath389 $ ] , the integrals can no longer be written using the special functions and have to be evaluated numerically .",
    "so far we have derived an extended dynamical system for the lagrange multipliers @xmath74 .",
    "one of the key questions is whether the dynamics converges to the target state @xmath32 .",
    "since the system has a form @xmath390 where @xmath391 ( note that the standard form of the ode has a negative sign in front of @xmath392 ) , convergence to the steady - state is captured by the sign of the eigenvalues of @xmath392 .",
    "when they are positive ( i.e. @xmath393 has negative eigenvalues ) , the target state is asymptotically stable .",
    "it is easy to see that both @xmath394 and @xmath395 are symmetric and positive semidefinite ( @xmath396 is a covariance matrix and @xmath397 can be written as a square ) and thus the matrix @xmath392 has non - negative eigenvalues .",
    "therefore the dynamics of lagrange multipliers should converge to the fixed point .",
    "this fixed point is precisely the target point @xmath32 unless some of the eigenvalues converge to zero  then the dynamics may get trapped at a different point of the phase space and are unable to continue all the way to the target state .",
    "moreover , because the dynamics of lagrange multipliers is five - dimensional while the dynamics of observables , driven by the @xmath264-matrix has only three degrees of freedom ( since the entries of @xmath394 , corresponding to @xmath398 , @xmath399 are zero ) , the method is in principle underdetermined .",
    "this essentially means that lagrange multipliers @xmath299 and @xmath125 and @xmath300 and @xmath400 may follow strange dynamics that together nevertheless lead to well - approximated observables .",
    "this is why in the next step we need to employ the constraints on @xmath125 and @xmath126 by slaving their dynamics with dynamics of mutation rates @xmath401 imposing these constraints leads to a reduced dynamics with only three degrees of freedom , @xmath402 and @xmath403 .",
    "the full dynamics can be reduced by disregarding the entries of @xmath394 that are identically equal to zero and considering only the submatrix @xmath404 .",
    "intuitively , one expects that the reduced dynamics will be identical to the dynamics governed by @xmath405 matrices @xmath404 and @xmath406 .",
    "however , we show that the @xmath378-matrix involves additional terms . to do that , we start by taking the first 3 equations from , leaving out the equations for the dynamics of @xmath126 and @xmath125 and by substituting @xmath126 and @xmath125 by the expressions of @xmath299 and @xmath300 from @xmath407           - \\sum_{k=2}^3 \\frac{1}{\\alpha^\\ast_k}\\frac{d\\alpha^\\ast_k}{dt }   \\psi [ a_{k+2}-\\langle a_{k+2 } \\rangle ] ]   + \\partial_t \\delta = \\\\          -\\partial_p \\left [ \\frac{\\sigma(p)}{2 } \\sum_{k=1}^3 \\left((\\alpha-\\alpha^\\ast)\\frac{\\partial a_k}{\\partial p } \\right ) \\right ] -           \\partial_pj[\\delta , p]\\ , .",
    "\\end{aligned}\\ ] ] we are left with a system of three ode s that involve terms from the dynamics of @xmath125 and @xmath126 ( the second sum on the left ) .",
    "we then substitute values of @xmath125 and @xmath126 from and obtain the correct @xmath378-matrix @xmath408 resulting in a reduced dynamics @xmath409 .",
    "note that despite the original intuition , the added terms in the second and third column must be present to reflect the dynamical character of the prefactors in the stationary distribution .",
    "the case with dominance is treated in an analogous way and results in matrices @xmath151 and @xmath152 of dimension 4 by 4 .",
    "an important question is whether dynamics described in the above system converge to the state @xmath410 .",
    "this is true for the dynamics of observables , driven by matrix @xmath404 , no matter the initial and target state , because of the symmetry and positive definiteness .",
    "this means that the approximation can in principle work , but it remains to be seen if the dynamics of lagrange multipliers also have good convergence properties .",
    "the matrix @xmath411 is no longer symmetric and thus @xmath412 is not necessarily positive definite .",
    "however , all our simulations suggest that the positive semidefiniteness holds and the only way how the approximation may fail to converge to the fixed point @xmath32 is when some of the eigenvalues go to zero . in such case the trajectory gets trapped at a different state . we have observed this behaviour for @xmath413 where one of the mutation rates approaches zero .",
    "evolution of quantitative traits depends on the following non - dimensional parameters : @xmath199 , @xmath229 and @xmath327 .",
    "the general dynmaxent approximation , as well as the piecewise - defined diffusion depends on an additional nondimensional parameter @xmath414 that influences the quality of the general dynmaxent approximation . as this parameter gets very small , the method approaches the continuous method without boundary layers . since in the limiting case",
    "matrix @xmath415 contains diverging components , the error of the general approximation should increase as @xmath414 gets smaller .",
    "similarly , the error will be large when @xmath416 .",
    "this is because the relationship , which assumed @xmath417 , no longer matches the boundary masses of the approximated stationary distribution with the correct stationary distribution .",
    "moreover , the boundary is too wide for @xmath416 to disentangle effects of selection and mutation .",
    "simulations in figure  [ ex_eps1 ] applied a sudden change in selection while the small mutation rates remained unperturbed .",
    "the figure shows that there exists an optimal value of the threshold @xmath414 that leads to the best approximation .",
    "this threshold seems to depend on the mutation rates @xmath418 but also weakly on the selection rate @xmath199 , which is consistent with a representation of @xmath419 as a mutation - dominated regime .",
    "the optimal threshold differs when considering error in the trait mean and in the mean heterozygosity .     on performance of the general dynmaxent method .",
    "the response to a fast change in selection @xmath420 to 1 ( or -2 to 2 ) has been compared with the approximated response of the system while keeping mutation fixed @xmath308 ( or 1/10 ) and no overdominance @xmath421 and @xmath170 .",
    "each panel shows all four combinations of parameter regimes , distinguished by color ( @xmath199 ) and filling ( @xmath43 ) . we used a method that constrains expectations of three observables , @xmath187 , @xmath294 and @xmath283 .",
    "panels also contain the error of the continuous dynmaxent method , plotted at @xmath422 , that was obtained by fixing effective mutation @xmath163 , @xmath164 .",
    "( a ) relative error of the trait mean ; ( b ) relative error of the mean heterozygosity .",
    "[ ex_eps1],scaledwidth=98.0% ]    it is useful to know how the general dynmaxent method performs for realistic examples given a sensible fixed choice of @xmath180 .",
    "we set @xmath423 , such that @xmath107 corresponds to a frequency of one in the total of @xmath66 individuals .",
    "we took the reference simulation in example 2 and varied strengths of the parameters @xmath199 , @xmath424 , @xmath425 one at a time .",
    "figure  [ ex_eps2 ] shows that the relative error in a trait mean is for most parameter settings within 1 percent .",
    "the worst case scenario is when selection gradient is strong and mutation drops rapidly to a small value .",
    "this is expected , since strong and rapid change in selection implies a large deviation from adiabatic regime , thus the quasi - stationarity assumption may fail .",
    "additionally , small mutation leads to a separation of timescales in the model that may be too complex to capture by a simple approximation .",
    "surprisingly , stronger selection on heterozygosity does not decrease the accuracy of the method , which is counterintuitive because large @xmath424 leads to more complex allele frequency distributions .     on performance of the general dynmaxent method .",
    "the reference simulation undergoes a fast change in selection @xmath426 , heterozygosity @xmath427 and mutation @xmath428 and @xmath170 .",
    "the three panels show dependence of the simulation error when the reference case parameters are changed one at a time .",
    "( a ) dependence on the strength of directional selection , changing from @xmath429 to @xmath199 ( plotted on a linear scale ) .",
    "( b ) dependence on the strength of selection for the heterozygous form , changing from @xmath424 to 0 ( plotted on a linear scale ) .",
    "( c ) dependence on the magnitude of mutation , changing from 0.5 to @xmath425 ( plotted on a logarithmic scale ) .",
    "[ ex_eps2],scaledwidth=98.0% ]",
    "we compare three available methods : the discrete approximation ( see appendix  [ apd ] ) , that captures response to a change in selection in the limit @xmath430 ; the continuous dynmaxent approximation ( see ) , valid for @xmath431 with a possibility to treat also small but static mutation ; and the general dynmaxent approximation ( see ) , that extends the validity to dynamic mutation of an arbitrary magnitude . note that dynamic lagrange multipliers may also represent changing population size , not just the evolutionary forces .",
    "comparison between discrete , continuous and general approximations .",
    "we show performance of the methods in two scenarios : ( a ) rapid change in selection @xmath420 to 1 with other parameters unperturbed @xmath432 , @xmath433 .",
    "( b ) rapid change in selection @xmath420 to 1 and mutation @xmath434 to @xmath435 , combined with a change in heterozygosity @xmath436 to 0 .",
    "the population size is @xmath170.,title=\"fig:\",scaledwidth=32.0% ]   comparison between discrete , continuous and general approximations .",
    "we show performance of the methods in two scenarios : ( a ) rapid change in selection @xmath420 to 1 with other parameters unperturbed @xmath432 , @xmath433 .",
    "( b ) rapid change in selection @xmath420 to 1 and mutation @xmath434 to @xmath435 , combined with a change in heterozygosity @xmath436 to 0 .",
    "the population size is @xmath170.,title=\"fig:\",scaledwidth=32.0% ]    figure  [ figcomp ] shows two scenarios : perturbation of the system through a change of selection ( panel a ) , and perturbation through changes in all evolutionary parameters ( b ) . in the case ( a ) the continuous dynmaxent method can be applied even in the case of small mutation @xmath0 by enforcing fixed mutation rate in time .",
    "but even then , the continuous method performs worse than the general method , which shows a relative error of the order of few percent . in comparison",
    ", the discrete approximation gives an accurate estimate when mutation drops below @xmath437 but due to its simplicity it does not capture unequal and dynamic mutation rates .",
    "the power of the general dynmaxent is demonstrated in figure  [ figcomp ] ( b ) for dynamic mutation .",
    "this situation can not be captured by the simple discrete approximation and the continuous dynmaxent , not valid for @xmath0 , shows divergence that is an inherent property of the matrix @xmath96 , approximating dynamics of observables . to show performance of the continuous method we included @xmath438 in the axis denoting accuracy of the approximation .",
    "figure  [ ex4fig1 ] compares the dynamics of the observables and lagrange multipliers for example 2 , where the initially tri - modal distribution loses polymorphism due to a decrease in the selection for heterozygous individuals and due to a simultaneous decrease in the mutation rate , and a reversed dynamics with the initial and final conditions switched .",
    "the dynamics are irreversible since switching the initial and final conditions leads to very different paths in the space of observables as well as in the space of the effective forces .",
    "the dynamics in the space of observables show a good agreement with the exact solution of the problem .",
    "the paths from the initial to the final state are relatively straight . on the contrary ,",
    "the dynamics of lagrange multipliers shows a complicated response of the system , that exhibits a separation of timescales and overshooting of the equilibrium levels ; for instance , the effective selection coefficient grows to a level @xmath439 before decreasing back to @xmath440 .",
    "have been complemented by dynamics with the initial state and the final state reversed .",
    "( a ) values of evolutionary forces for the reversed simulation .",
    "( b ) initial and final allele frequency distribution for the reversed simulation .",
    "( c , e ) the paths between the initial / final conditions ( circle / star ) displayed in the space of observables , together with the exact dynamics , showed in orange .",
    "we displayed the situation in two out of six possible pairs of coordinates .",
    "( d , f ) the dynamics , visualized in the space of corresponding lagrange multipliers .",
    "all figures show the forward trajectory ( example 2 ) in gray - dashed curve and dynamics with reversed initial and final state in black - dashed curve.,scaledwidth=98.0% ]",
    "a trait typically depends on many loci with different effects .",
    "if these effects are called @xmath11 , the simplest case is an additive trait @xmath441 .",
    "if linkage equilibrium is assumed the constraints can be written in terms of allele frequencies at the loci where each constraint is additive through loci ( @xmath442 ) with symmetric expressions in terms of @xmath443 . while the selection - related constraints depend on the distribution of effects @xmath444 linearly",
    ", the mutation - related constraints do not depend on it . if the effects of the @xmath445 loci on an additive trait are the same and @xmath446 then @xmath447 where @xmath448 is the matrix of genetic covariances for @xmath445 loci .",
    "this is true even in the approximation for small dynamic mutation since the boundary terms are also additive accross loci .",
    "a similar relationship holds for the covariance of fluctuations @xmath449 .",
    "therefore , the matrix defining the maxent dynamics of lagrange multipliers in case of @xmath445 loci with equal effects is identical to dynamics of lagrange multipliers in case of a single locus , i.e. @xmath450 . as a result , the trait mean @xmath451 , where @xmath452 represents the allele frequency in the single locus simulation with other parameters unchanged . on the other hand , the calculation of a trait mean for @xmath453 independent loci of equal effects @xmath446 using the continuous model gives @xmath454 showing that the relationship @xmath455 follows also from the model description .",
    "figure  [ fig_ex3f4 ] shows details on the quality of the general dynmaxent approximation in example 3 , where a linear trait , depending on 100 loci with different effects , evolves due to a combination of a directional selection and selection on heterozygosity , random drift and mutation .",
    "the changes in evolutionary forces are the same as in example 2 .",
    "$ ] ; ( b ) exponential distribution with mean 1 ; and ( c ) deterministic effects where 95 of the loci have effects 0.01 while the remaining five loci have effects 19.81 . the true forces @xmath32 change at time @xmath186 and draw the system out of equilibrium .",
    "the response of the observed quantities , @xmath168 , @xmath188 and @xmath189 , is shown in blue dots while the approximation is shown in green .",
    "the quality of the approximation for the trait mean @xmath187 is shown in figure  [ fig_ex3f3 ] .",
    "[ fig_ex3f4 ] , scaledwidth=98.0% ]                                                                                        , 2008 selective breeding analysed as a communication channel : channel capacity as a fundamental limit on adaptive complexity . in _ symbolic and numeric algorithms for scientific computing , 2008 .",
    "10th international symposium on _ , pp .",
    "514518 .",
    "zhou , q. , c.  e.  ellison , v.  b.  kaiser , a.  a.  alekseyenko , a.  a.  gorchakov _ et al .",
    "_ , 2013 the epigenome of evolving drosophila neosex chromosomes : dosage compensation and heterochromatin formation .",
    "plos biol .",
    "* 11 * : e1001711 ."
  ],
  "abstract_text": [
    "<S> selection , mutation and random drift affect the dynamics of allele frequencies and consequently of quantitative traits . </S>",
    "<S> while the macroscopic dynamics of quantitative traits can be measured , the underlying allele frequencies are typically unobserved . </S>",
    "<S> can we understand how the macroscopic observables evolve without following these microscopic processes ? </S>",
    "<S> the problem has previously been studied by analogy with statistical mechanics : the allele frequency distribution at each time is approximated by the stationary form , which maximises entropy . </S>",
    "<S> we explore the limitations of this method when mutation is small ( @xmath0 ) so that populations are typically close to fixation and we extend the theory in this regime to account for changes in mutation strength . </S>",
    "<S> we consider a single diallelic locus under either directional selection , or with over - dominance , and then generalise to multiple unlinked biallelic loci with unequal effects . </S>",
    "<S> we find that the maximum entropy approximation is remarkably accurate , even when mutation and selection change rapidly .    </S>",
    "<S> _ keywords : _ diffusion approximation , maximum entropy , quantitative genetics    most traits of interest have a complex genetic basis , depending on very many loci . </S>",
    "<S> quantitative genetics gives a sophisticated statistical description of the components of trait variance , which can predict the immediate change due to selection . </S>",
    "<S> the present abundance of genetic markers allows us to find some of the loci that affect traits , but such qtl typically account for only a small fraction of the genetic variance @xcite . while we may be able to predict breeding values , and estimate the distribution of effects , </S>",
    "<S> it does not seem possible - even in principle - to identify the individual alleles responsible for the bulk of heritable variance . </S>",
    "<S> thus , we can not hope to predict the evolution of quantitative traits by using a direct population genetic approach , based on the frequencies of each individual allele .    here , we develop a general method that allows us to closely approximate the evolution of quantitative traits , knowing only the distribution of allelic effects and mutation rates , but without requiring knowledge of individual allele frequencies . </S>",
    "<S> this can be seen as an extension of the classical infinitesimal model , to include arbitrary gene interactions and the effects of selection , mutation and drift on the genetic variance . </S>",
    "<S> it can also be viewed as a generalized version of the quasi - steady state assumption ( qssa ) that is often made in dynamical reaction systems @xcite to noisy systems described by pdes , where the dynamics are approximated using a quasi - stationary distribution assumption ( qsda ) ; here , we use the maximum entropy ( me ) principle to define that distribution .    in physics , </S>",
    "<S> the maximum entropy principle has a long history , starting with the seminal work of @xcite , who interpreted the boltzmann distribution of statistical physics as the most random distribution subject to a constraint on fixed average energy . in the recent decade </S>",
    "<S> , there has been a resurgence of interest in me , especially when applied to biophysics problems ranging from the statistics of neural spiking  @xcite , bird flocking  @xcite , protein structure  @xcite , and immunology  @xcite . </S>",
    "<S> these approaches have been generalized to describe temporal dynamics of high - dimensional systems , known collectively as `` maximum caliber '' or `` dynamical / kinetic maximum entropy '' models  @xcite where the entropy of distribution over temporal paths is maximized given constraints on dynamical variables . </S>",
    "<S> surprisingly , however , me distributions have not been used widely as a variational ansatz for cases discussed in this work , where the evolution equation for the distribution might be known a priori , e.g. , as is the case with the diffusion approximation in population genetics . in such a case </S>",
    "<S> the approach differs from the maximum caliber methods since it involves a combination of a static maximum entropy ansatz for the stationary microscopic distribution , with a quasi - stationary assumption in the diffusion / fokker - planck equation , which together extend the static maximum entropy inference to a dynamical approximation .    </S>",
    "<S> @xcite and @xcite introduced the maximum entropy approximation to the dynamics of polygenic systems , predicting the cumulants of the trait distribution under mutation , selection and drift ; their main motivation was to understand evolutionary algorithms , rather than natural populations . </S>",
    "<S> the same method was described independently in physics @xcite , and used to approximate cosmic ray fluxes @xcite .    </S>",
    "<S> however , neither of the two applications of maximum entropy was taken up in their respective fields . </S>",
    "<S> @xcite modified prgel - bennet , rattray & shapiro s method , so that it could be justified from population genetic principles . with this modification , it gives the stationary distribution exactly , and is accurate in the limit of slowly changing conditions . </S>",
    "<S> numerical calculations showed that it is remarkably accurate , even when selection or mutation change abruptly . </S>",
    "<S> however , the method is fully valid only when mutation is stronger than drift ( @xmath1 ) , so that populations are almost never fixed for one or other allele . yet , in nature mutation is typically weaker than drift ( @xmath0 ) , so that most sites are fixed ; in this case , vladar & barton s approximation only applies in cases where mutation or population size do not change through time .    </S>",
    "<S> we begin by summarising the stationary maximum entropy approximation and its extension to non - stationary problems . </S>",
    "<S> we then extend the maximum entropy approximation so that it applies over the full range of mutation rates , and test the accuracy of this approximation for directional selection and for balancing selection that favours heterozygotes . </S>",
    "<S> this extension is a combination of the continuous approach of @xcite with a special treatment of the dynamics at the boundaries . </S>",
    "<S> a similar approach , where the boundaries have to be treated differently , has been used in the semi - discrete , semi - continuous methods studied in reaction - diffusion systems @xcite , but also in traveling fitness waves , where the fluctuations can be introduced to the model using a cutoff function ( @xcite ) . </S>",
    "<S> we initially consider the distribution of allele frequencies at a single locus , and then extend to multiple loci with a distribution of effects . throughout </S>",
    "<S> , we assume that recombination is fast relative to other processes , so that the population is in linkage equilibrium , and can be described by its allele frequencies .      </S>",
    "<S> the dynamics of allele frequencies @xmath2 ( for biallelic loci ) can be described by a diffusion process using a deterministic forward kolmogorov equation    ( i.e. , the fokker - planck or the diffusion equation ) . </S>",
    "<S> the evolution of the joint probability density @xmath3 of allele frequencies satisfies : @xmath4          + \\frac{1}{2 } \\sum_{i=1}^ { l } \\frac{\\partial^2}{{\\partial p_i}^2 } \\left [ \\mathcal{v}_i(p_i ) \\psi \\right ] \\ </S>",
    "<S> , , \\label{fpe } \\ ] ] where the number of loci that contribute to the trait is @xmath5 .    </S>",
    "<S> the second term of equals @xmath6 and captures stochasticity of the allele frequencies arising from random sampling ; i.e. , the random drift . </S>",
    "<S> while in case of linkage disequilibrium this term would contain a double summation , reflecting correlations between loci , the off - diagonal terms vanish at linkage equilibrium . </S>",
    "<S> ( the factors of 2 in the brackets of arise because we assume a diploid population of n individuals ; the corresponding haploid model would be the same , apart from these factors ) .    </S>",
    "<S> the first term of captures deterministic changes of allele frequencies . </S>",
    "<S> we consider @xmath7 + \\mu q_i - \\nu p_i\\end{aligned}\\ ] ] where @xmath8 is the strength of directional selection , @xmath9 denotes a higher order correction that captures dominance , @xmath10 are the forward and backward mutation rates and @xmath11 , @xmath12 are the additive effects of the @xmath13-th locus on the traits under selection . </S>",
    "<S> @xmath14 can be written in a potential form @xmath15 where the potential @xmath16 , obtained by inverting this relationship , reflects effects of selection and mutation @xmath17 with quantities @xmath18 are defined as @xmath19 where @xmath20 and where @xmath11 and @xmath12 are the effects of loci on the traits @xmath21 and @xmath22 , respectively .    </S>",
    "<S> selection , captured by the mean fitness @xmath23 , may be an arbitrary function of the distribution of quantitative traits , which in turn may be an arbitrary function of the @xmath24 allele frequencies . </S>",
    "<S> the log mean fitness may be further decomposed into a sum in which the @xmath25 represent various selection coefficients and @xmath26 various selected traits . in case of dominance </S>",
    "<S> the terms associated to selection are @xmath27 where @xmath28 and @xmath29 . here </S>",
    "<S> we assume a weak selection , @xmath30 , such that @xmath31 .    </S>",
    "<S> the deterministic effects on allele frequency can be summarized into a vector of coefficients @xmath32 and a vector of complementary quantities @xmath33 . </S>",
    "<S> we study directional selection and dominance with non - symmetric mutation , and define @xmath32 , @xmath33 as @xmath34 in the forthcoming sections , we show that @xmath33 and @xmath35 can be understood as constraints and corresponding lagrange multipliers , respectively , of a particular variational problem .    for @xmath36 and @xmath37 </S>",
    "<S> this represents the simplest scenario of directional selection with symmetric mutation . </S>",
    "<S> directional selection of strength @xmath8 acts on a trait @xmath21 , assumed to be additive while selection of strength @xmath9 acts on heterozygosity @xmath22 . in this work </S>",
    "<S> we consider unequal effects @xmath11 on the trait but equal effects @xmath38 on @xmath22 . </S>",
    "<S> this can be easily extended to distribution of effects @xmath12 . </S>",
    "<S> a wide variety of other models can be treated in the same way . </S>",
    "<S> for example , @xcite study stabilising selection on an additive trait .    </S>",
    "<S> this diffusion process is known to be an accurate continuous - time approximation to a wide range of specific population genetic models @xcite ; moreover , it corresponds directly to the coalescent process that describes the ancestry of samples taken from the population @xcite . in order to represent the population in terms of allele frequencies </S>",
    "<S> , we must assume that linkage disequilibria are negligible , which will be accurate if recombination is sufficiently fast . </S>",
    "<S> for simplicity , we also assume two alleles per locus .    </S>",
    "<S> the stationary distribution of has the form @xcite @xmath39 where @xmath40 is a normalization constant , also called a partition function . </S>",
    "<S> this distribution falls to zero at the boundaries ( @xmath41 ) provided @xmath1 and @xmath42 . </S>",
    "<S> however , when mutation rates fall below this threshold , the distribution develops singularities at boundaries ( if @xmath43 or @xmath44 is small the singularity occurs at @xmath45 or @xmath46 , respectively ) , even though the density function is still integrable .      the stationary distribution can be derived from a variational maximum entropy ( maxent ) principle . </S>",
    "<S> the key assumption is that selection and mutation act only through a set of observable quantities , which can be arbitrary functions of allele frequencies , @xmath47 ; the strength of selection and mutation are given by the corresponding set of @xmath48 . </S>",
    "<S> together , these define the potential function @xmath16 .    </S>",
    "<S> we can define an entropy , relative to a reference measure @xmath49 : @xmath50 = -\\int_{[0,1]^ { l } } \\psi(\\mathbf{p},t)\\log\\left [ \\frac{\\psi(\\mathbf{p},t)}{\\phi(\\mathbf{p})}\\right ] d\\mathbf{p }            \\label{entropy}\\ ] ] which has a unique maximum @xmath51 at the reference distribution ; the entropy is ( minus ) the kullback - leibler divergence from @xmath49 . </S>",
    "<S> the key choice is to set the reference distribution as the neutral distribution of allele frequencies in the absence of mutation or selection : @xmath52 note that @xmath49 is not integrable ; however , it does give the neutral probability distribution given that the allele is not fixed , and yields the stationary distribution under mutation , selection and drift when we maximise @xmath53 subject to a normalization constraint and constraints @xmath54 . </S>",
    "<S> the latter condition enforces a constraint on the ensemble averages @xmath55 . </S>",
    "<S> these macroscopic quantities represent information that could in principle be observed . </S>",
    "<S> we refer to @xmath56 as observables even though this does not necessarily mean that their values over time are known . </S>",
    "<S> the constrained maximization of entropy is solved by a method of lagrange multipliers ; for details , see appendix  [ aplm ] . for the example in the constraints include :    * @xmath57^l }   \\psi(\\mathbf p ) d\\mathbf p   = 1 $ ]  normalization constraint , * @xmath58 with lagrange multiplier @xmath59 , * @xmath60 with lagrange multiplier @xmath61 , * @xmath62 with lagrange multiplier @xmath63 , * @xmath64 with lagrange multiplier @xmath65 </S>",
    "<S> .    the normalization condition sets the total probability of the allele frequency distribution to one and introduces the partition function @xmath40 as a constant multiplier in .    </S>",
    "<S> this variational principle recovers the stationary distribution of diffusion equation ; the @xmath66 times the mutation rates and selection coefficients can be thought of as the lagrange multipliers . </S>",
    "<S> @xcite introduced the same entropy measure , but used it in a slightly different way : he showed that the sum of the potential function and @xmath67 defines a free fitness that increases through time , just as in thermodynamics the free energy increases in time . </S>",
    "<S> further connections to thermodynamics have been studied by @xcite for a special case of very small mutation , where most of the alleles are fixed , and in @xcite , including the novel entropy term ( analogous to our @xmath68 , @xmath69 ) that involves effects of mutation .    </S>",
    "<S> note that @xmath33 and @xmath32 have a specific meaning both in quantitative genetics and in statistical physics . in quantitative genetics , @xmath33 characterises properties of a quantitative trait whose means can be observed ( @xmath70 ) and that evolves in response to the evolutionary forces @xmath32 . in statistical physics , </S>",
    "<S> @xmath33 and @xmath32 represent conjugate pairs of thermodynamic variables , which can be interpreted as the constraints and lagrange multipliers in the variational maxent problem , commonly encountered when microscopic states of the system are unobserved but its macroscopic features are known .    </S>",
    "<S> note that there is some flexibility in the choice of the reference distribution @xmath71 , where different choices may lead to the same stationary distribution . </S>",
    "<S> for instance , one may take the neutral distribution that involves mutation terms @xmath72 while omitting the constraints on @xmath68 and @xmath69 and assuming that @xmath73 are functions of time . </S>",
    "<S> this way , the reference distribution would be normalizable . </S>",
    "<S> since these approaches are equivalent , one can view the constraints on @xmath68 and @xmath69 as conditions that regularize the allele frequency distribution . </S>"
  ]
}