{
  "article_text": [
    "the study of gaseous disks is of fundamental importance to astrophysics .",
    "disks are ubiquitous ; essentially any gaseous orbital system which efficiently loses energy while conserving angular momentum will form a disk .",
    "the formation of planets takes place in a protoplanetary disk , which can influence the first few million years of the planets existence ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "these especially include  transition disks \" whose cavities may be signposts of planet formation ( e.g. * ? ? ?",
    "accretion disks around black holes ( in particular , x - ray binaries ) are the most robust means of a black hole s detection via electromagnetic waves ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "some stars are also thought to be surrounded by an accreting disk ( e.g. * ? ? ?",
    "accretion disks are also an important feature of cataclysmic variables ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ) , and they are thought to be the power source behind active galactic nuclei ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "current efforts to observe the horizon of sgr a * depend on an emitting disk of gas surrounding this supermassive black hole ( e.g. * ? ? ?",
    "circumbinary disks are among the most promising possibilities for electromagnetic counterparts of gravitational wave emission from merging black holes ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "? * ; * ? ? ?",
    "much of the same circumbinary physics applies to a newly - born binary star system , surrounded by a common protostellar disk ( e.g. * ? ? ?",
    "galaxies can be considered another important type of disk ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "even saturn s rings constitute a disk , though it is not composed of gas , but of icy solids ( e.g. * ? ? ?",
    "each particular instance of a disk in nature possesses its own specific physical ingredients .",
    "many disks are ionized and therefore magnetic fields are important to their evolution .",
    "protoplanetary disks are dusty and also subject to the gravitational influence of the planets being formed in the disk .",
    "black hole accretion disks can constitute very extreme environments where radiation hydrodynamics , weak sector couplings , and general relativity all come into play . in galaxies ,",
    "self - gravity is very important , as opposed to many other systems which can be approximated as orbiting a single point mass at the center .",
    "nevertheless , many of the same techniques can be applied to study the physics behind this wide range of systems , since the most important ingredients ( orbital and gas dynamics ) are common to all of them .",
    "arguably the most convenient experimental test - beds for disk dynamics are numerical calculations . the hydrodynamical equations governing gas dynamics and magnetohydrodynamics ( mhd ) have been integrated numerically using many approaches . in astrophysics ,",
    "the most commonly employed techniques are particle - based methods like smoothed particle hydrodynamics ( sph , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) , and grid - based high - resolution shock - capturing techniques @xcite , which use godunov - type schemes for hydrodynamic evolution and often employ adaptive mesh refinement ( amr , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) to resolve large dynamic ranges .",
    "recently , moving - mesh techniques @xcite and several new  meshless \" techniques @xcite have emerged as an attempt to merge the accuracy of the amr approach with the flow adaptivity of sph . moving mesh methods have already enjoyed remarkable success using an adaptive voronoi tessellation for the shape of the mesh zones . on the other hand ,",
    "none of these approaches are specifically tailored to the special challenges inherent in disks .",
    "disks are often highly supersonic ( mach number @xmath0 ) .",
    "standard godunov - type methods can stably evolve such supersonic flows , but this entails a diffusive upwind flux at every zone on every timestep .",
    "this means one often needs high resolution for accuracy , and even at low resolution it places strong constraints on the allowed timestep , which is limited by the courant condition .",
    "it may be difficult to resolve complicated , potentially turbulent flows if the gas is being diffusively passed from cell to cell at high mach number .",
    "several of the aforementioned techniques are designed to address this problem .",
    "sph and voronoi codes are designed to adapt to supersonic flows by moving with the flow , effectively subtracting off the supersonic orbital motion . on the other hand , many sph formulations require significant artificial viscosity , and some do not converge at first order ( though this is not as devastating a problem for some modern sph formulations , e.g. * ? ? ?",
    "* ; * ? ? ?",
    "the voronoi technique is designed to resolve such flaws , and in fact it has been suggested that the voronoi mesh may be ideal for studies of disk - planet interactions @xcite , but the choice of voronoi cells to describe the flow may be overkill , since the bulk orbital motion is very simple and is known before running the code .",
    "there is also inherent noise generated when voronoi cells shear past one another , as mesh faces can rotate rapidly @xcite .",
    "because of these complications , the voronoi moving - mesh technique may be better - suited to more general ( e.g. cosmological ) flows , where the large - scale bulk motion is not known at run - time . in disks ,",
    "angular momentum conservation is also of vital importance ; a method which does not precisely maintain this circular orbital motion over thousands of orbits may struggle to capture small perturbations to this motion @xcite .",
    "fortunately , because disks are so important , several codes have been written specifically to tackle disk dynamics .",
    "the most well - known and well - tested is almost certainly fargo @xcite .",
    "fargo is not just a code , but it is a general numerical technique , also called  orbital advection \" , which has also been implemented in other grid - based codes ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "fargo subtracts off the keplerian component of the flow , by shifting zones some integral amount each timestep to account for the advective motion .",
    "the residual advection with respect to the grid is accounted for by a standard godunov flux .",
    "a special version of fargo designed for 3d disks has also recently been written @xcite .",
    "another well - known code tailored to disks is the rodeo code @xcite .",
    "rodeo solves the hydrodynamical equations in a ( rigidly ) rotating frame , and uses a special integral form of the field equations which is tailored for stability .",
    "the large - scale orbital motion is subtracted , but there is still a nonzero shear flow with respect to the grid .",
    "one of the advantages to rodeo is that mesh refinement is possible ( this does not appear to be straightforward in the original fargo scheme , since the orbital advection technique appears to place restrictions on the topology of the grid ) .",
    "rodeo can therefore capture very accurate details in the vicinity of a planet , since its orbital motion is subtracted and the mesh can also be refined around the planet .",
    "there is also an efficient code called penguin @xcite .",
    "penguin is particularly efficient , as it has been optimized for use on graphics processors ( gpus ) .",
    "this is ideal for studies of disks , as many disk - related problems require evolving the system over many thousands of orbits , which is often prohibitively expensive .",
    "large parameter surveys are seldom undertaken for these reasons , but penguin makes such expensive problems much more manageable .    while these existing methods are reliable and have demonstrated themselves useful for evolving disks in many scenarios , it is worthwhile to consider another distinct numerical approach . in this work ,",
    "the code disco is presented , a moving - mesh technique similar to the numerical scheme of the moving - mesh codes arepo and tess . in the same spirit of fargo and rodeo , orbital motion",
    "is subtracted , but unlike rodeo the entire shear flow can be subtracted , and unlike the original fargo scheme , the topology of the numerical mesh is not restricted ( this last point is particularly important if one does not wish to excise the inner disk ) . the computational domain is decomposed into zones which are cylindrical wedges ( figure [ fig : gridimage ] ) .",
    "these zones are given an azimuthal velocity and are allowed to shear past one another smoothly .",
    "this azimuthal velocity can be chosen to have any value , with the choice of the local fluid velocity resulting in an azimuthally lagrangian scheme . because the mesh moves with the flow instead of passing the fluid from one zone to the next , advection errors resulting from orbital motion are significantly reduced and otherwise subtle features can be captured accurately while the flow orbits supersonically .",
    "disco has already been applied to many challenging problems in astrophysics , including gap opening and orbital evolution in protoplanetary disks @xcite and the evolution of circumbinary disks surrounding supermassive black hole binaries @xcite . in this work ,",
    "the numerical technique is described in detail ( section [ sec : numerics ] ) .",
    "this includes the recent addition of a constrained transport method for solving the equations of magnetohydrodynamics ( section [ sec : mhd ] ) . in section [ sec : tests ] , a series of numerical code tests is presented , to demonstrate the convergence and practicality of the code .",
    "results are summarized in section [ sec : discussion ] .",
    "disco is capable of evolving arbitrary hyperbolic partial differential equations in conservation - law form .",
    "its simplest mode solves euler s equations :    @xmath1    where @xmath2 is density , @xmath3 is velocity , @xmath4 is pressure , and @xmath5 is internal energy density .",
    "an adiabatic equation of state is typically employed :    @xmath6    where @xmath7 is the adiabatic index .",
    "additional terms such as viscosity , gravity , and magnetic fields will be included in later subsections . for now , the numerical formulation will be expressed in terms of these  bare \" equations .",
    "other forms , such as the special and general relativistic versions of these equations , will not be discussed here , but will be addressed in a future work .    because angular momentum conservation is so important to the orbital dynamics ,",
    "the momentum conservation law is evaluated in terms of the vertical , radial , and angular momentum :    @xmath8    where @xmath9 is the cylindrical radius , @xmath10 is the angular fluid velocity , and @xmath11 and @xmath12 are the radial and vertical components of velocity .",
    "the source terms on the right - hand side of the equation for radial momentum come from the evaluation of the tensor divergence in cylindrical coordinates .",
    "this reflects the fact that  radial momentum \" is not a conserved quantity .",
    "these terms can be interpreted as a centrifugal force , and an azimuthal pressure - balance term that comes out of the non - zero divergence of the @xmath13 vector .    finally , before discretizing these equations , the energy equation is modified to improve accuracy .",
    "define the quantity    @xmath14    where @xmath15 is some differentiable function of radius .",
    "it should be made clear that @xmath15 has nothing to do with the mesh motion described in the later sections ; it is defined in order to subtract off part of the kinetic energy from the field equations . for typical applications",
    ", @xmath15 will be the keplerian orbital velocity , but in principle it can be any analytically known differentiable function of radius , including @xmath16 .",
    "nothing in the disco algorithm depends sensitively on the choice of @xmath15 , but in practice subtracting off this large kinetic component of the energy can yield a substantial improvement to the stability and reliability of the numerical scheme , especially for high mach number flows .",
    "also , note that @xmath15 will not be subtracted from the angular momentum , so that coriolis terms do not appear in the momentum equations .",
    "subtracting @xmath15 from @xmath10 in the energy equation yields the following evolution equation ( where @xmath17 is the velocity with @xmath18 subtracted ) :    @xmath19    if @xmath20 is chosen , energy is not explicitly conserved in this formulation , due to the presence of this source term .    to summarize",
    ", the field equations can be expressed in the conservation - law form :    @xmath21    the conservation laws can be expressed in terms of the five primitive variables : @xmath22 now , the evolution equations can be compactly summarized by writing down the five conserved variables , @xmath23 the five corresponding fluxes , @xmath24 and the five source terms , @xmath25    now that these have been specified , the evolution of the system can be described in terms of the generic expression ( [ eqn : conslaw ] ) .",
    "equation ( [ eqn : conslaw ] ) will be discretized in the following subsection ( [ sec : integral ] ) .",
    "first , it is necessary to describe disco s mesh , and how it is constructed .",
    "similar to the formulation of the tess code @xcite , the numerical scheme can be completely specified , given the volumes of the zones , logical information specifying which zones are neighbors , and the areas of the  faces \" connecting neighboring zones .",
    "the zones are annular wedges with extents given in cylindrical coordinates by @xmath26 , @xmath27 and @xmath28 ( figure [ fig : faceimage ] ) .",
    "the faces with @xmath29 normal are the  front \" and  back \" of these zones ( yellow shaded area of figure [ fig : faceimage ] ) .",
    "the faces with @xmath13 or @xmath30 normal are defined as the overlap of the boundary of two neighboring zones ( blue shaded area of figure [ fig : faceimage ] ) .",
    "this means that zones can have more than two radial or vertical faces ( on average , zones typically have four of each ) .",
    "given neighboring annuli at radii @xmath31 and @xmath32 , first the zone at each of these radii intersecting the radial ray @xmath33 are found .",
    "these two zones are guaranteed to share a face .",
    "the geometry of the shared face is identified , and then the next face is found by advancing whichever of the two zones has a smaller @xmath34 associated with their front face . again",
    ", this new pair of zones must share a face .",
    "this procedure is repeated for @xmath35 faces , where @xmath36 is the number of zones in a given annulus labeled by the index @xmath37 .",
    "each step , a face is identified as the intersection of the boundary of the pair of zones .    faces normal to @xmath30 are constructed in an analogous way .",
    "disco is a finite - volume method . to discretize the system , ( [ eqn : conslaw ] )",
    "is integrated over the volume of a computational zone , using gauss law on the flux term :    @xmath38    now , at first , consider the case of no mesh motion , for which    @xmath39    and define @xmath40 to be the amount of a given conserved quantity in zone i at timestep n :    @xmath41    after performing an integral in time , it is then straightforward to write an evolution equation for the @xmath42 :    @xmath43    where the sum is over faces bounding zone @xmath44 .",
    "so far , no approximations have been made , so long as @xmath45 is interpreted as the time - averaged and face - averaged flux , and @xmath46 is interpreted as the volume - averaged and time - averaged source term .",
    "exact geometry is employed , so that for example @xmath47 is the exact volume of a cylindrical wedge :    @xmath48    where @xmath27 and @xmath28 are the azimuthal and vertical extent of the zone , and @xmath49 and @xmath50 are the outer and inner radii .",
    "some of the conserved quantities and source terms require the coordinate r. in this case , the radius is chosen to be the moment arm of the zone :    @xmath51    if the orbital motion of the grid is switched on , the integral form of these equations departs from ( [ eqn : evol1 ] ) , since the control volumes and their associated faces move through space . in this case",
    ", the generalization of equation ( [ eqn : fixedzone ] ) is given by the reynolds transport theorem as    @xmath52    where @xmath53 is the velocity of the boundary of the zone .",
    "this results in the following modification to equation ( [ eqn : evol1 ] ) :    @xmath54    in other words , the time evolution differs from a standard godunov - type method by making the substitution @xmath55 , where @xmath53 is the velocity of the face upon which the flux is evaluated , and now @xmath56 on the face needs to be determined in addition to @xmath57 . for disco s cylindrical mesh , the velocity @xmath53 is always normal to the face .",
    "the face velocities are zero for all radially and vertically oriented faces ; all mesh motion is azimuthal . the azimuthal velocity can be chosen in many ways .",
    "if desired , each azimuthal face can be moved independently , according to the average velocity of its adjacent zones .",
    "alternatively , some global analytical formula for @xmath58 can be prescribed , if one does not wish for the zones to have too much independence .",
    "the mesh velocity could also be set to @xmath59 , where @xmath15 is the analytical function described in the previous subsection .",
    "again , it is not necessary to force these two functions to be equal .",
    "so far , no numerical approximations have been made ; equation ( [ eqn : evolution ] ) is merely an integral form of ( [ eqn : conslaw ] ) .",
    "therefore , the numerical approximations are housed in the estimation of @xmath45 , the time - averaged and area - averaged flux through the face ( as well as @xmath60 and @xmath46 ) .",
    "these numerical approximations are detailed in the following two subsections .",
    "equation ( [ eqn : evolution ] ) requires a numerical estimate for @xmath61 , the time - averaged and area - averaged flux through face @xmath62 .",
    "the standard method for calculating such a flux in the godunov method is to use a riemann solver .",
    "a riemann solver takes as input a left and right state @xmath63 , @xmath64 and returns as output some estimate of the solution to the shock - tube problem given by piecewise - constant initial conditions :    @xmath65    a standard riemann solver takes this initial data and either computes the exact solution at a future time , or approximates it , returning the flux through the interface at @xmath66 :    @xmath67    in the moving - mesh case , a different output is desired .",
    "if the interface moves with velocity @xmath68 , then the flux should be evaluated along the characteristic @xmath69 : @xmath70 ( see figure [ fig : riemann ] ) .",
    "evaluating the riemann solution along a given characteristic ( @xmath71 instead of @xmath66 ) is straightforward .",
    "disco employs several different approximate riemann solvers .",
    "hlle and hllc @xcite are available for all flows , though hllc is necessary to preserve contact discontinuities to high precision @xcite . for mhd flows ,",
    "an hlld solver is implemented in disco , based on the solver of @xcite .",
    "analogous to hllc , the hlld solver is necessary for preserving magnetic discontinuities to high precision ( advection of a field loop can be solved to machine precision , but only if the hlld solver is employed ) .      in order to achieve second - order accuracy in space",
    ", primitive variables must be extrapolated from zone centers to faces to produce input to the riemann solver ( figure [ fig : plmimage ] ) :    @xmath72    where the @xmath73 are slopes which are estimated at the zone centers . in calculating these slopes",
    ", care must be taken as the primitive variables can not be assumed to represent differentiable functions . therefore , after estimating gradients of the primitive variables , a slope - limiter is applied to ensure stability in non - smooth regions of the flow .",
    "first , the azimuthal gradients are calculated .",
    "this is done by calculating left , right , and centered gradients in the zone :    @xmath74    where @xmath75 , and @xmath76 .",
    "the slope - limited azimuthal gradient is then given by    @xmath77    where @xmath78 is a slope - limiting parameter @xmath79 and the  minmod \" function is given by    @xmath80    next , the radial and vertical gradients are calculated . for brevity ,",
    "the formulas for the vertical gradients are omitted , as they are similar to the formulas for the radial gradients .",
    "first , the radial gradient at each radially - oriented face is estimated , using the extrapolated values from the azimuthal gradient :    @xmath81    @xmath82    where @xmath83 is the angular separation between the center of zone @xmath44 and the center of face @xmath62 .",
    "the zone - centered gradient is then estimated by performing an average over faces , weighted by face area :    @xmath84    this provides a radial gradient in each zone , which like the azimuthal gradient must be processed through a slope limiter for stability .",
    "this slope limiter is essentially the same as the one used in the azimuthal direction , but including all neighbors .",
    "the  centered \" slope has already been calculated above ; the final slope used is given by    @xmath85    formulas ( [ eqn : grad1])-([eqn : grad2 ] ) are then repeated for vertical gradients so that the gradient @xmath73 is fully determined in the zone . for most problems ,",
    "the slope - limiting parameter is chosen to be @xmath86",
    ".      equation ( [ eqn : evolution ] ) specifies how to advance from timestep @xmath87 to timestep @xmath88 , given the time - averaged values of @xmath57 and @xmath56 on the face .",
    "this is given by the riemann solver , which takes as input a left and right state , @xmath89 and @xmath90 .",
    "this left and right state are found by extrapolating from zone centers to face centers , using the slope - limited gradients given in section [ sec : plm ] .    at this point ,",
    "the system is completely specified , but the time - evolution operator , as expressed in equation ( [ eqn : evolution ] ) , is only first - order in time .",
    "it has the following form :    @xmath91    where @xmath92 is a time - evolution operator depending on the state of the system at timestep @xmath87 .",
    "to increase the order of accuracy of the code , a method - of - lines technique is employed , introducing the intermediate state @xmath93 :    @xmath94    this constitutes a second - order timestep which is consistent with a total variation diminishing scheme .",
    "the timestep @xmath95 is courant - limited ; that is ,    @xmath96    where @xmath97 is the shortest signal - crossing time of a zone :    @xmath98    note that moving the zones to cancel a supersonic orbital velocity ( @xmath99 ) can increase the allowed timestep by orders of magnitude . in the mhd case",
    "the sound speed in the above formula is replaced by the speed of fast magnetosonic waves .",
    "the courant condition ( [ eqn : courant ] ) is satisfied at each time - step by setting @xmath100 , where @xmath101 ( typically @xmath102 for hydrodynamical flows and @xmath103 for mhd ) .",
    "disco achieves efficient parallelization by subdividing the computational domain into annuli .",
    "define @xmath104 and @xmath105 to be the global radial and vertical dimensions of the computational grid .",
    "define the indices @xmath106 and @xmath107 which label the radial and vertical grid : @xmath108 and @xmath109 .",
    "the number of zones in the azimuthal dimension can vary with @xmath9 and @xmath110 : @xmath111 .",
    "typically @xmath112 is chosen at each radius so that the zones have a nearly @xmath113 aspect ratio . the domain is then subdivided in @xmath9 and @xmath110 so that each processor has a local resolution @xmath114 , @xmath115 ( figure [ fig : parallel ] ) .",
    "boundary data is shipped in the vertical and radial direction every timestep .",
    "it is also possible to subdivide the domain in azimuth , but such a subdivision adds significant complexity to the method .",
    "the official version of disco therefore only performs parallel subdivision of the domain radially and vertically ( in other words , @xmath116 ) .",
    "performance and scaling of disco on thousands of cpus is tested in section [ sec : scaling ] .      disks usually orbit around a central point mass , meaning gravitational source terms must enter the evolution equations .",
    "additionally , there may be orbiting satellites exerting a gravitational influence on the disk .",
    "these influences are accounted for by adding the following source terms to the energy and momentum equations :    @xmath117    @xmath118    where @xmath119 is the gravitational acceleration due to all point masses , labeled by @xmath120 :    @xmath121    @xmath122    here , @xmath87 and @xmath123 are optional smoothing parameters . typically in 2d calculations , @xmath124 and @xmath125 , where @xmath126 is a scale height .",
    "this is to mimic the averaging of the gravitational force over the disk scale height ( if there is a central body , typically @xmath127 for that body ) . in the code , all point masses ( e.g. stars , planets , black holes ) are simply called  planets \" , and treated identically in an algorithmic sense .",
    "the point masses can be given any prescribed motion @xmath128 , or be moved due to the gravitational influence of the gas .",
    "accretion onto these bodies is also possible using an additional source term in the continuity equation .",
    "this has been employed in studies of binary - disk interactions @xcite , but is not in disco s public version as there are many possible choices for such a term .",
    "a navier - stokes viscosity can be represented as a source term in the momentum equation ,    @xmath129    and a source term in the energy equation ,    @xmath130    where the viscous stress tensor @xmath131 will be defined below .",
    "the first term in the energy equation can be interpreted as work done by viscous forces ( inner product of force with velocity , @xmath132 ) and the second term expresses viscous heating .",
    "both of these source terms can be re - expressed as a viscous flux :    @xmath133    @xmath134    this is possible because viscosity is an internal body - force in the gas , and therefore conserves total momentum and energy . in the case that @xmath135 , the energy equation has a source term :    @xmath136    in cylindrical coordinates , the tensor divergence generates a more complicated expression for the fluxes , including a source term for radial momentum .",
    "the viscous stress tensor @xmath131 is proportional to the velocity gradients :    @xmath137    @xmath138 is a dimensionless order - unity constant which summarizes the relationship between bulk and shear viscosity . for most orbital flows ,",
    "the choice of @xmath138 is unimportant ( in fact , for most problems it will only be the value of @xmath139 that matters ) .",
    "the full derivation appears in the appendix ; the final values of the viscous flux and source terms are    @xmath140    @xmath141    where @xmath142 . in section [ sec : visctest ] , several test problems will be presented to empirically check that all of these terms are correct .",
    "note that the formula ( [ eqn : viscflux ] ) is expressed in terms of gradients of the primitive variables .",
    "the viscous flux is evaluated separately from the riemann solver .",
    "the primitive variables @xmath143 are extrapolated to the face to attain the quantities @xmath144 and @xmath145 , and these quantities and their slope - limited gradients @xmath73 are averaged between the left and right state , before using them to evaluate the viscous fluxes ( [ eqn : viscflux ] ) .",
    "similar to euler s equations , the field equations of mhd can also be expressed in conservation - law form :    @xmath146    rewriting the equations in a cylindrical basis , it is possible to express these as additions to the standard hydro variables :    @xmath147    where the @xmath148 are given by ( [ eqn : bareu ] ) , and    @xmath149    the mhd fluxes are similarly summarized as    @xmath150    and there is a new source term for radial momentum , given by magnetic tension , or  hoop stress \" :    @xmath151    mhd is a challenging set of field equations to integrate , because of subtle behaviors relating to the divergence constraint , @xmath152 ( e.g. * ? ? ? * ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "one way of framing the @xmath153 problem is in terms of the following thought experiment : consider a two - dimensional cartesian domain with a field loop advecting with a uniform velocity in the x direction .",
    "while @xmath154 is advected , there is no x - directed flux for the parallel component @xmath155 . instead , the advection of @xmath155 is accounted for by the rotational flux in the @xmath156 direction . @xmath157 but the divergence constraint implies @xmath158 so if @xmath153 is guaranteed to be zero by the numerical stencil which updates the magnetic field , then the rotational flux in y is identical to an advective flux in the x direction , so it makes no difference that @xmath159 is not explicitly advected in this sense",
    ".    however , if one can not guarantee that @xmath160 then something as simple as advecting a field loop can go wrong . @xmath159 and @xmath161 are numerically updated in a fundamentally different way , and this causes the loop to eventually destabilize .",
    "this becomes more of a problem the larger @xmath153 is allowed to grow .",
    "many techniques have been developed to stably evolve this system , the most successful of which is constrained transport ( ct , * ? ? ?",
    "however , ct is often difficult to implement on complicated grids , in particular moving meshes such as disco s ( though notably , @xcite employed ct on a 2d voronoi mesh , demonstrating that ct is possible even with complex geometries ) . as a result ,",
    "several methods have been developed which have less dependence on the mesh employed .",
    "one popular such technique is to modify the evolution equations so that the divergence constraint propagates and diffuses ( e.g. * ? ? ?",
    "such divergence - cleaning techniques are easy to implement , but it is difficult to test their effectiveness , because they do not guarantee machine - precision zero divergence for any stencil .",
    "even a small divergence error can cause inaccurate physics on long timescales .",
    "another issue with the formulation of @xcite is that it introduces an additional wavespeed into the system . in the standard formulation",
    ", this wavespeed must be the fastest velocity in the system , in order that these waves can keep up with divergence errors quickly enough to correct them .",
    "unfortunately for the moving mesh technique , this eliminates the time - step advantage , because this wave moves quickly with respect to the grid .",
    "alternate galilean - invariant formulations of these equations are possible ( e.g. * ? ? ?",
    "* ) , but these always require source terms which have derivatives , which undermines many of the advantages of the finite - volume formulation ( one principal advantage of finite volume methods is that they evolve the integral form of the equations , and as a result do not necessitate smooth solutions ) . in short , it may be more advantageous to prevent divergence errors from appearing in the first place .",
    "another method increasingly employed is the vector potential formulation @xcite .",
    "this , of course , has the advantage that divergence errors are never introduced , as b is defined as a curl .",
    "it is also a preferred method for nontrivial meshes , which can complicate implementations of ct .",
    "some vector potential formulations have been shown to be functionally equivalent to ct on uniform meshes @xcite .",
    "unfortunately , the vector potential formulation might also require a numerical derivative , in the operation @xmath162 , and therefore some formulations might assume that the vector potential is differentiable ( for example , this is generally the case if the vector potential is cell - centered ) .",
    "another disadvantage is that introducing a vector potential also introduces gauge modes . either these gauge modes are static , and accumulate on the grid , or they propagate at some velocity which must be introduced , and they can also limit the code s time - step , similar to dedner s method .",
    "the time - step advantage is big enough for the moving mesh that it is worth maintaining , if possible . of course , none of these disadvantages",
    "can be truly devastating for vector potential formulations , as any constrained transport scheme could be re - expressed as a vector potential scheme , by evolving @xmath163 on each edge of the mesh using the same electric fields , and calculating the magnetic flux through each face by integrating @xmath164 around a closed loop . in this case , the truncation error can be identical to a ct scheme .",
    "constrained transport techniques find ways of processing the mhd fluxes so that they do not introduce any divergence errors . in a sense ,",
    "the idea is somewhat analogous to conservative formulations , which evolve the system in such a way as to avoid conservation - law violations .",
    "the ct formulation of @xcite , the most commonly employed ct scheme , makes use of the natural topology of the mhd equations .",
    "faraday s law can be expressed as a conservation law , and it is straightforward to define conserved quantities in volumes , and fluxes through faces . on the other hand , @xmath165 is a _ conserved flux_. in other words , faraday s law is more naturally expressed in a lower - dimensional form , by integrating it over the area of a face :    @xmath166    this is a lower - dimensional analog to the finite - volume conservation law ( equation [ eqn : intcons ] ) .",
    "the magnetic flux @xmath167 is the analog of mass , and the electric field @xmath168 is the analog of mass flux ( the direction of the flow is perpendicular to the electric field , but the component of @xmath168 along the edge provides the magnitude of the flux ) .",
    "given a computed value of @xmath169 , one can generalize the integral equations derived in section [ sec : integral ] , to arrive at the  finite - area \" form of ( [ eqn : faraday ] ) :    @xmath170    the numerical scheme can be interpreted as a lower - dimensional analog of standard finite - volume methods , with @xmath167 playing the role of mass , and @xmath168 being the analog of mass flux ( see figure [ fig : eflux1 ] ) .",
    "because the fluxes @xmath167 are stored on faces , this requires some memory of the numerical mesh to persist from one time - step to the next . for convenience , each flux @xmath167 is stored on one of the zones which houses the face associated with this flux ( see figure [ fig : facedge1 ] ) . the 3d ct scheme used in disco",
    "is based on the method of @xcite , though the electric fields are not computed in exactly the same way .      the complete description of the time - evolution for the magnetic fluxes will appear in section [ sec : mhdtime ] .",
    "first , it is important to recognize that it will not be possible to calculate the magnetic field directly from the magnetic flux .",
    "this would require the operation @xmath171 , where @xmath172 is the area of the face .",
    "unfortunately , this area can be arbitrarily small , as faces can disappear or reappear during changes in the topology of the mesh .",
    "calculating the magnetic field by dividing a small flux by a small area can result in arbitrarily large errors ; small errors in the flux would lead to arbitrarily large errors in the field .",
    "therefore , in disco s numerical scheme the operation @xmath171 is never explicitly performed . instead",
    ", the fluxes on each face are used to determine a cell - centered average magnetic field , and this magnetic field is used to update the system .",
    "in fact , most of the timestep proceeds as a normal finite - volume scheme , treating the cell - centered magnetic fields as primitive variables ; they are interpolated to the faces along with the other variables , and used as input to riemann solvers .",
    "the only time the face - centered fluxes are needed is in the step just before converting from conserved to primitive variables , where the cell - centered magnetic fields are determined based on the face - centered fluxes . in this sense , one could interpret the update of the magnetic fields as a predictor - corrector scheme @xcite .    this operation ( from @xmath173 to @xmath174 )",
    "is performed by determining the total flux through each surface of the zone ; the flux is then assumed to vary linearly through the zone , so that    @xmath175    in other words , the cell - centered components of the magnetic field are    @xmath176    @xmath177    @xmath178    once these zone - centered fields are calculated , the conserved variables in the zone are converted to primitive variables , using the zone - centered magnetic fields just computed . the rest of the time - update proceeds using these fields as cell - centered primitive variables .      in section [ sec : getefields ] , it will be explained how the electric field is calculated on each edge . for",
    "now , it is assumed that this @xmath168 field is known , and the goal is to derive a rule to update the magnetic fluxes during a timestep .",
    "this starts with faraday s law :    @xmath179    following the same process which led to ( [ eqn : evolution ] ) , faraday s law is integrated over the surface of a face :    @xmath180    now , interpreting @xmath181 as the time - averaged electric field on edge @xmath182 , the time - update step can be expressed as :    @xmath183    this method of evolving face - centered fluxes does not conserve volume - integrated flux density , as some uniform - mesh ct techniques do ( e.g. * ? ? ?",
    "if the edges move with velocity @xmath53 , the generalization is :    @xmath184    this is also how mesh motion is accounted for by @xcite . just like equation ( [ eqn : evolution ] )",
    ", this is an exact expression , suitably interpreted .",
    "all of the numerical approximations will be housed in the calculation of @xmath185 and @xmath186 , the time - averaged electric and magnetic fields .",
    "these will be determined in the following section .",
    "any choice for the electric fields will preserve the divergence constraint , but it is important to make a well - motivated choice in order to provide an accurate and stable approximation to the underlying field equations . for example , @xcite showed that simply averaging the electric fields on four adjacent faces fails to produce an upwind scheme , and as a result this can give innacurate solutions .",
    "various remedies are proposed for this ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    ", the numerical scheme is not as susceptible to this upwinding issue , because the mesh motion typically keeps azimuthal faces within the riemann fan .",
    "however , it is still nontrivial to develop a stable scheme because of the complicated mesh structure . in practice ,",
    "a stable scheme was found by experimenting with different averaging procedures .",
    "the calculation of the electric fields will involve three steps : first , a definition of zone - specific edge - centered fields , secondly an identification of these electric fields with fluxes found in the riemann solver step , and finally an averaging process over several neighboring zones .",
    "indexing of the faces and edges in each zone is shown in figure [ fig : facedge1 ] .",
    "to calculate the electric field on these edges , note that this electric field gives the number of magnetic field lines being dragged across each edge per unit time .",
    "if one knows , for example , the flow of @xmath187 through a face with r - directed normal , then one implicitly knows the line integral of @xmath188 along a z - directed edge parallel to that face .",
    "these statements can be made more mathematically concrete . using the geometrical fact that the area element is given by the wedge product of two line elements @xmath189",
    ", the integrated flux of a magnetic field component @xmath190 through a face is given by    @xmath191    the combination @xmath192 can be related to the cross product @xmath193 :    @xmath194    given @xmath195 and the identities of the @xmath5 pseudotensor , one can arrive at the relation :    @xmath196    if one integrates this formula over a face , then divides by area , one attains    @xmath197    where brackets denote area - averaged fluxes .    therefore , the line - integrated electric field can be related to the area - integrated flux of magnetic field , which has already been calculated from the riemann solver . in other words , one can associate a line - averaged @xmath168 with an area - averaged flux . for each electric field component ,",
    "there are two areas to average over , corresponding to the two coordinate planes parallel to this edge .",
    "the electric field is set to the mean of these two area - averaged fluxes .",
    "these fields are not averaged with neighboring zones yet , as this will be done in the next step .",
    "specifically , for the vertical fields ,    @xmath198    where  front \" implies the face with greater value of @xmath199 . for the radial fields ,    @xmath200",
    "azimuthal electric fields will be treated separately , but will have the same essential forms :    @xmath201    this choice of electric field is designed for consistency of the numerical scheme , since the flux of field lines is consistent with the godunov fluxes calculated from the riemann solver .    after calculating these zone - specific edge - centered electric fields",
    ", an averaging process is performed between zones in order to acquire a well - posed electric field on each individual edge in the mesh .",
    "once zone - specific electric fields have been specified via equations ( [ eqn : begine ] ) - ( [ eqn : ende ] ) , an averaging process is performed , in order to ensure that electric fields on adjacent faces are consistent with one another . for example , as figure [ fig : avg1 ] shows , @xmath202 on zone @xmath44 should be identical to @xmath203 on zone @xmath204 . before the averaging process , these fields are not generally consistent with one another . after averaging ,",
    "the electric field is self - consistent and the mhd update stencil effectively spans a larger number of zones .    as figure",
    "[ fig : avg1 ] demonstrates , @xmath205 and @xmath206 of zone @xmath44 must be compatible with @xmath207 and @xmath208 of zone @xmath204 .",
    "this is accomplished via the substitution :    @xmath209    similarly , @xmath205 of zone @xmath37 must be compatible with the interpolated electric field of zone @xmath210 :    @xmath211    where @xmath212 for example is a weighted average of @xmath205 and @xmath207 interpolated to the position of @xmath213 or @xmath214 ( figure [ fig : avg1 ] ) .",
    "similarly , for the radial electric fields :    @xmath215    @xmath216 is not averaged with neighbors in this way .",
    "rather , the @xmath199 component of the electric field is not defined zone - wise , but on the intersection between four faces ( figure [ fig : avg2 ] ) . in this case",
    ",    @xmath217    note that on average each zone is in contact with @xmath218 azimuthal edge segments , and therefore @xmath219 is effectively averaged over more than four faces .      because the zones shear past one another",
    ", faces can disappear or emerge during the course of a timestep ( figure [ fig : flip ] ) .",
    "ordinarily , this might be a problem for the numerical method ; when a face disappears , where does its flux go ? when a face emerges , what sets its flux ?",
    "the way this scheme is designed , the numerical solution is not very sensitive to the answers to these questions , since the area of the face in question is very small in these circumstances , and the cell - centered magnetic field is an average over faces , weighted by face area .",
    "nonetheless , some flux must be specified .",
    "since the face is changing topology , its bounding edges must be very close together and therefore the electric and magnetic fields must be very similar ( this is guaranteed by the interpolation and averaging process ) . therefore , most of the time - dependence of the flux must come from the difference in the velocity @xmath53 at each edge :    @xmath220    in other words , during a topology flip the change in flux in the cell is assumed to be entirely due to the amount of flux overtaken by the edge . in this case , during the time update , there needs to be an adjustment in order to account for the fact that in the first part of the timestep , the face was giving up its flux to one zone , and in the last part of the timestep , it was taking flux from another zone .    note",
    "that because @xmath221 during a time - step where the topology flips , equation ( [ eqn : shortphi ] ) guarantees a sign change in @xmath167 during a topology change ; the point at which @xmath167 goes to zero signifies the topology flip .",
    "therefore , in figure [ fig : flip ] all flux lost before the sign change should be given to face 1 and all flux accumulated after this point should be taken from face 2 .",
    "algorithmically , all of this is simple to account for .",
    "first , a normal timestep is taken .",
    "then , after the timestep , if a face  flips \" , i.e. a face disappears from one zone and moves onto another zone , then the following corrections must be made to this face and the adjacent faces ( see figure [ fig : flip ] ) :",
    "@xmath222    this adjustment also guarantees that the magnetic divergence remains zero for the appropriate stencil .",
    "this method for tracking topology changes is different from @xcite , where flux is redistributed equally between neighboring faces .",
    "given the uniqueness of this numerical scheme , a wide range of tests is performed .",
    "many of these tests are  sanity checks \" , ensuring that all terms are correctly accounted for in the code . accuracy and convergence are also very important , and therefore several convergence tests are performed .",
    "additionally , several challenging tests relevant to astrophysics are performed , in order to demonstrate the code s robustness and usefulness for studying nontrivial astrophysical flows , including tests of disk - planet interactions , and mhd turbulence driven by the magnetorotational instability in an accretion flow .",
    "nearly all tests use an adiabatic index of @xmath223 , or an isothermal equation of state .",
    "the two exceptions are the mhd rotor test , which uses an adiabatic index of @xmath224 , and the supersonic keplerian spreading test , which uses a nearly isothermal adiabatic index @xmath225 . unless otherwise specified , all hydro calculations use the hllc riemann solver , and all mhd calculations use the hlld riemann solver .",
    "the slope - limiting parameter @xmath86 in all tests , and the cfl number is @xmath102 for all hydro tests , and @xmath103 for all mhd tests .",
    "this test demonstrates disco s ability to capture radially propagating shocks . for characteristics moving radially ,",
    "disco performs as a robust high - resolution shock - capturing code , even when the mesh motion is not utilized .",
    "the domain extends from @xmath226 , with uniform radial resolution .",
    "an adiabatic index of @xmath227 is employed . if @xmath228 , @xmath229 and @xmath230 .",
    "otherwise , @xmath231 and @xmath232 .",
    "initially the fluid is not moving : @xmath233 .",
    "this calculation is run until a time @xmath234 .    in figure",
    "[ fig : shocktube ] density , pressure , and velocity are plotted at this time , using a resolution of 128 radial zones .",
    "this is compared with a high - resolution calculation using a 1d code in cylindrical coordinates .",
    "qualitative agreement is illustrated in figure [ fig : shocktube ] .",
    "the isentropic pulse is a simple nonlinear test for convergence of any code .",
    "convergence is checked by measuring entropy conservation .",
    "the initial setup is as follows :    the domain extends from @xmath235 , with uniform radial resolution .",
    "density is given by    @xmath236    pressure is chosen to be isentropic :    @xmath237    and the fluid is initially stationary , @xmath233 .",
    "the pulse explodes outward ( figure [ fig : isentropic1 ] ) , and eventually forms a shock , but before the shock forms the equation @xmath238 continues to hold due to entropy conservation ( @xmath239 evolves as a conserved scalar , as long as the solution remains smooth ) .",
    "error is calculated by verifying entropy conservation at a time @xmath240 , before the shock has formed :    @xmath241    fast convergence is found for this problem ( figure [ fig : isentropic2 ] ) ; for resolutions lower than @xmath242 , convergence is faster than second order . at higher resolutions ,",
    "convergence is second order .",
    "this test is effectively 1d , as all motion is radial ; it can be run with arbitrarily low angular resolution .",
    "however , it can also be used as a multidimensional test problem , by offsetting the origin of the pulse .",
    "additional calculations with these initial conditions were run with an origin offset by @xmath243 ( this is the example shown in figure [ fig : isentropic1 ] ) .",
    "convergence is also second order in this offset example , when each zone is allowed to move independently ( figure [ fig : isentropic2 ] ) .",
    "this test helps to demonstrate convergence , and the effectiveness of the disco code at preservation of contact discontinuities .",
    "the grid has uniform radial resolution from @xmath244 .",
    "density is uniform with @xmath245 , and angular velocity is chosen as    @xmath246    pressure is chosen to balance centrifugal forces : @xmath247 .",
    "this results in the following pressure :    @xmath248    the vortex is trans - sonic ( maximum mach number of about 0.53 ) . in figure",
    "[ fig : vortex1 ] , a passive scalar is included to demonstrate the code s ability to maintain contact discontinuities and prevent artificial diffusion .",
    "when mesh motion is turned off , the contact discontinuity is smeared out . with",
    "mesh motion turned on , the contact discontinuity is maintained precisely .",
    "the first two panels use a low resolution of 64 zones . a calculation at a resolution of 256 radial zones",
    "is also included for comparison .",
    "error is calculated at @xmath249 using the density :    @xmath250    figure [ fig : vortex2 ] shows clear second - order convergence on this test .",
    "this is an important test , as most problems disco was designed to solve have a keplerian background flow .",
    "this stationary flow must be captured accurately if one wishes to study some subtle phenomenon which is a perturbation to this flow .",
    "the setup for this problem is as follows .",
    "zones are logarithmically spaced in the range @xmath251 .",
    "the density and pressure are uniform with @xmath245 , @xmath252 .",
    "velocity is keplerian : @xmath253 , @xmath254 .",
    "boundary conditions are fixed at these initial conditions .",
    "a point mass is inserted at @xmath255 so that centrifugal and gravitational forces are balanced .",
    "for this problem , the gravitational potential was not smoothed , since the point mass is not on the grid , and the keplerian flow is an exact solution .",
    "this results in a disk with a mach number of 7.7 at the outer boundary , and 24.5 at the inner boundary .    because this test is axisymmetric ( and therefore effectively 1d ) , it is not very important that the zones move with the flow",
    "however , for demonstration purposes a passive scalar has been added to the initial conditions : @xmath256 at @xmath257 .",
    "this passive scalar is plotted in figure [ fig : kepler1 ] at time @xmath258 , after the flow has had time to shear it into a spiral .",
    "error is computed identically to the vortex problem .",
    "this is computed at a time @xmath259 , after a half - orbit at the outer boundary , and about 16 orbits at the inner boundary .",
    "truncation error generates transient waves which propagate radially , bouncing between the two boundaries .",
    "the @xmath260 error is computed before these transient waves have fully dissipated .",
    "convergence is very close to second - order ( figure [ fig : kepler2 ] ) . for 512 radial zones ,",
    "the @xmath260 error is at the @xmath261 level .    because this problem is supersonic , most of the energy is kinetic , meaning that small relative errors in the energy density can lead to large errors in the pressure .",
    "for this reason , it is important to evolve the modified energy density , with @xmath15 chosen to be keplerian .",
    "tests in which @xmath15 was set to zero generated very large errors near the inner boundary",
    ".      flows unstable to kelvin helmholtz are traditionally tested on cartesian grids .",
    "however , kelvin - helmholtz instability can occur in a rotational flow , as shown by the following example .",
    "radial zones are uniformly distributed from @xmath262 .",
    "the background flow is given by a step function across @xmath263 :    if @xmath264 : @xmath265    otherwise , @xmath266    the perturbation is introduced in the radial velocity :    @xmath267    where @xmath268 and @xmath269 .",
    "figure [ fig : kh ] plots the density at time @xmath270 , showing that the instability is fully nonlinear at this time .",
    "the lower panels show the difference when mesh motion is turned on and off .",
    "sharper features are present in the version in which the mesh is moved , though care must be taken not to over - interpret how well these features are captured @xcite .        in order to test disco s implementation of viscosity",
    ", it is necessary to perform a noncircular viscosity test .",
    "this is so that every term in the viscous equations is used .",
    "fortunately , this is as simple as setting up a cartesian test problem and putting it on the cylindrical grid .",
    "of course , the cylindrical grid is not ideal for this test , but the purpose is to make sure all of the terms ( [ eqn : viscflux ] ) are implemented correctly , not to test accuracy or convergence .    in cartesian",
    "coordinates , if we one designs a flow with uniform density and pressure and with @xmath271 , the navier - stokes equations reduce to :    @xmath272    where @xmath273 is viscosity .",
    "this has the well - known green s function solution :    @xmath274    this solution is evolved using the following parameters : @xmath275 , @xmath276 , @xmath277 , @xmath278 , and @xmath279 .",
    "initial conditions are given by the solution at time t=0.5 and this is evolved until time @xmath280 .",
    "64 radial zones are uniformly distributed from @xmath281 .",
    "figure [ fig : cartflow ] plots the solution at this time as a function of the x coordinate ( @xmath282 ) of each zone .",
    "although the code is not designed for problems so misaligned with the grid , the analytic solution is recovered .",
    "additionally , the code was run with various terms in equations ( [ eqn : viscflux ] ) set to zero , to check the importance of each term .",
    "the test has also been run with various choices of @xmath15 , to test that the solution is independent of this choice .",
    "all terms are necessary to capture the solution to this level of accuracy . in other words",
    ", this test ensures that the viscosity is implemented correctly .",
    "a more complex viscosity test is attempted , relevant to accretion disks .",
    "a point mass is concentrated at @xmath283 and the domain extends from @xmath284 .",
    "orbital velocity is keplerian , @xmath254 , and pressure is set to a constant , @xmath285 .",
    "a uniform viscosity @xmath286 ensures an accretion flow given by @xmath287 ( and the initial conditions assume this radial velocity ) .",
    "the density is given by the following :    @xmath288    note that  surface density \" @xmath289 is replacing  density \" @xmath2 ; this is a cosmetic change which reflects the fact that the code is integrating 1d and 2d ( vertically integrated ) disk equations .",
    "the first two terms are steady - state solutions to the evolution equations for @xmath289 , but the final term is a density bump which should be smeared out by viscosity . in this test , a nearly isothermal equation of state is assumed ( @xmath290 ) , in order that viscous heating does not cause violations of the thin disk assumptions .",
    "this gives a disk orbiting at about mach 45 in the vicinity of @xmath291 .",
    "a very high mach number is chosen because very cold disks are assumed when deriving the 1d diffusion equation for the surface density :    @xmath292    similar to the previous test , analytic green s function solutions exist to this equation .",
    "however , it is also straightforward to write a 1d code to integrate this pde forward in time , to compare with disco s solution .",
    "for the initial conditions stated above for the surface density , a solution was obtained at t = 100 by integrating this pde .",
    "this is plotted in figure [ fig : spread ] , compared with disco s solution using 64 radial zones .",
    "the solutions do not match identically , but this is likely due to thin - disk assumptions made in deriving the 1d equation .",
    "errors are at the percent - level .",
    "it is important to be able to capture planet - disk interactions in an idealized context .",
    "this test explores the linear interaction between an earth - mass planet and a supersonic keplerian disk whose mach number is @xmath293 at the orbital radius .",
    "the initial conditions are not meant to mimic a protoplanetary disk , rather they are meant to produce an idealized environment in which it is easy to test the code .",
    "a small domain is used , with @xmath262 and the planet is located at radius @xmath294 .",
    "orbital velocity is keplerian ( @xmath254 ) , and surface density and pressure are uniform ( @xmath295 , @xmath296 ) .    here , to simplify the problem , an isothermal equation of state",
    "is employed :    @xmath297    with boundary conditions fixed at the initial conditions .",
    "so far , this is just a supersonic keplerian disk , similar to the test in section [ sec : kepler ] ( except with an isothermal equation of state ) .",
    "the only additional ingredient is a point mass orbiting at @xmath294 .",
    "the planet mass is given by the earth - to - sun mass ratio :    @xmath298    where @xmath299 is defined according to the thermal mass threshold for nonlinearity ( @xmath300 ) .",
    "the planet s gravity is given a smoothing length @xmath301 .",
    "the simplest analytic comparison is given by the spiral wave produced by the planet .",
    "it is straightforward to calculate the shape of this wave from linear theory ( e.g. * ? ? ?",
    "* ) :    @xmath302    the spiral wave is established in the first orbit ( @xmath303 ) .",
    "figure [ fig : planet1 ] shows the density after @xmath304 orbits , also plotting the analytical prediction ( [ eqn : spiral ] ) for the spiral .",
    "time - averaged torque density exerted by the planet is shown in figure [ fig : planet2 ] for various resolutions , showing convergence of the torque .",
    "the total torque is affected by the nearby boundaries , but it reaches its converged value with only @xmath305 radial zones .",
    "nonlinear propagation of the spiral wave is a much more subtle and difficult behavior to capture @xcite .",
    "this can be measured by the angular momentum flux ( amf ) emanating from the planet .",
    "this amf has two components , a gravitational component due to the excitation of the wave , and a  wave \" component due to the wave s propagation and dissipation .",
    "@xmath306    @xmath307    @xmath308    where @xmath309 is the background keplerian orbital frequency .",
    "@xcite produced semi - analytical formulas for wave propagation and dissipation , which were later generalized to a global disk @xcite .",
    "these scalings are plotted in figure [ fig : planet3 ] compared with the measured planetary amf for a planet with @xmath310 ( about three times earth s mass ) .",
    "convergence is harder to establish for this test than for the linear wave .",
    "@xmath242 zones ( @xmath311 per scale height ) are needed for reasonably accurate measurement of the amf .",
    "larger planets produce stronger shocks , which dissipate the angular momentum in the spiral wave , depositing torque in the disk , which causes an evacuation of an annulus in the vicinity of the planet s orbit .",
    "this low - density annulus is known as a  gap \" , and it is well - known that a jupiter - mass planet can open a gap in a disk with moderate viscosity .",
    "the scaling of gap depth with viscosity has been determined in several numerical studies @xcite :    @xmath312    where @xmath313 and    @xmath314    this scaling will be measured using the same setup as the previous test , but with @xmath315 ( jupiter - to - sun mass ratio ) . figure [ fig : jupiter1 ] shows the density at @xmath316 orbits with @xmath286 .",
    "figure [ fig : jupiter2 ] measures the gap depth as a function of time , and compares the steady - state gap depth with the prediction from empirical calculations and 1d models ( [ eqn:1ddepth ] ) .",
    "@xcite used this test as a means to build a working definition of  numerical viscosity \" in disco .",
    "the same test is performed with zero viscosity , and using a number of different numerical resolutions , and the gap depth was measured as a function of resolution .",
    "this was compared to the gap depth as a function of viscosity , to build a definition of  effective viscosity \" of the numerical scheme . in that study",
    ", it was found that    @xmath317      it will be important to test the accuracy and stability of the ct scheme described in section [ sec : mhd ] . many works testing numerical mhd studies look at the magnitude of div b for given test problems , as a guide to code performance .",
    "yet , the magnitude of div b can be small and still affect the long - term behavior of the solution .",
    "the approach taken here to diagnosing div b performance is to measure the indirect impact of the divergence on the final solution .",
    "for example , one can advect a field loop until @xmath153 errors produce inaccurate evolution",
    ". then one can demonstrate whether enforcing the div b constraint resolves the issue .",
    "this approach leads to a much greater confidence that attempts to eliminate magnetic monopoles are accomplishing something .",
    "the test which is typically most sensitive to div b errors is the advection of a magnetic field loop .",
    "a modified version of this test is presented here to test disco s ct algorithm in 2d . the initial setup ( in the domain @xmath318 )",
    "is given as follows :    @xmath319    the magnetic field is given by :    @xmath320    where @xmath321 is the distance from a point centered at @xmath322 , @xmath33 .",
    "@xmath323 sets the radius of the loop .",
    "this magnetic field loop has magnetic tension and pressure , which can be balanced with the following adjustment to the gas pressure :    @xmath324    however , this adjustment is largely unnecessary , as the magnetic field strength is very weak ( @xmath325 ) .",
    "stronger magnetic fields are possible to use , but they are less susceptible to numerical disruption , as magnetic tension and pressure provide restoring forces to the loop .    figure [ fig : floop ] shows the field loop after a single orbit advected using @xmath326 radial zones , using 12 different combinations of schemes ( with different options for the riemann solver , mesh motion , and ct ) .",
    "hlld shows a significant improvement over the other schemes , reducing the diffusion of the field loop .",
    "however , the loop is more susceptible to div b instability when using this less diffusive riemann solver .",
    "more diffusive methods mitigate immediate catastrophe by diffusing out div b errors , but they do not eliminate the problem . employing ct and hlld ,",
    "the loop is preserved to high precision , and with the mesh motion the advection is solved to machine precision ( ignoring errors in the pressure balance , which are small ) .",
    "testing the ct algorithm in 3d necessitates a 3d magnetic field configuration , with nonzero components of @xmath327 , @xmath328 and @xmath329 .",
    "the spinning 3d loop initially has field components @xmath155 and @xmath329 , and this loop rotates about the z - axis rigidly .",
    "initial conditions are specified as :    @xmath330    @xmath331    where @xmath321 is a radial coordinate in the x - z plane : @xmath332 @xmath333 and this magnetic field is chosen to be very weak :    @xmath334    figure [ fig : sploop ] shows the spinning 3d loop using only @xmath218 radial zones ( @xmath335 vertical zones ) after a single orbit .",
    "the upper panel uses a fixed mesh , while the lower panel uses a moving mesh .",
    "moving the mesh allows for accurate preservation of this loop .",
    "the  mhd flywheel \" test is a new test presented here which illustrates the numerical instability associated with div b errors .",
    "the setup involves a stationary orbital mhd configuration , in which centrifugal force is balanced by magnetic tension , and magnetic pressure is balanced by gas pressure :    @xmath336    @xmath337    this gives a stationary solution in 3d ( though this test is only performed in 2d ) .",
    "note that since velocity is parallel to @xmath165 , the total azimuthal flux of @xmath165 is zero , which makes this test succeptible to div b violations if ct is not employed .",
    "constants are chosen so that    @xmath338    @xmath339    in 2d , this stationary solution is stable , so the goal is to preserve the initial conditions as precisely as possible .",
    "figure [ fig : fly1 ] shows the solution at @xmath340 using high resolution ( @xmath341 ) and toggling ct on and off . while ct is turned off , div b errors cause a numerically unstable solution . implementing constrained transport",
    "eliminates these errors .",
    "this is shown quantitatively in figure [ fig : fly2 ] . here , errors in the solution are plotted .",
    "these are measured in both the density and the radial component of the magnetic field :    @xmath342    @xmath343    both errors are plotted in figure [ fig : fly2 ] , with ct turned off on the upper panel , and implemented in the lower panel . without controlling div b , it is clear that errors in @xmath327 grow exponentially from machine round - off .",
    "moreover , the growth rate appears to be proportional to the resolution , so that improving the resolution gives greater errors .",
    "finally , when these errors grow from machine round - off to be non - negligible contributions to the hydro evolution , they eventually affect the errors in density ( which would otherwise converge at second - order ) . by implementing constrained transport ,",
    "the errors in @xmath327 remain very small .      a commonly used setup which is useful for comparisons with other codes , this test puts an explosion into an initially uniform magnetic field , pushing the field lines sideways and generating a nontrivial shock structure .",
    "the computational domain extends from @xmath344 .",
    "density is uniform @xmath245 , and all velocities are initially zero .",
    "a magnetic field with strength @xmath345 is pointed along the @xmath346 diagonal ( though the direction of the field is irrelevant , as the computational domain is cylindrical ) .",
    "the pressure is set to @xmath347 everywhere except within @xmath348 , where @xmath349 .",
    "figure [ fig : bexp ] shows the explosion at time @xmath350 using @xmath351 radial zones ( roughly equivalent to a cartesian box with @xmath352 zones across ) .",
    "disco s performance on this test can be compared e.g. with figure 28 of @xcite , or figure 4 of @xcite .",
    "note that the origin is kept on the grid , despite the coordinate singularity at @xmath283 . in practice ,",
    "the numerical solution to this test did not significantly depend on whether ct was employed .",
    "this test is more challenging than the mhd explosion , and it tests the code s propagation of strong torsional alfvn waves .",
    "a rotational flow at the center winds up an initially uniform magnetic field :",
    "@xmath353    where @xmath354 is a tapering function :    @xmath355    density , pressure , and radial velocity are given by    @xmath356    and the magnetic field is uniform in the x direction :    @xmath357    another important point to note is that unlike the rest of these test problems , which have either used @xmath223 or an isothermal equation of state , this test uses a lower adiabatic index :    @xmath358    figure [ fig : rotor ] shows the pressure at @xmath359 , which can be compared with figure 2 of @xcite or figure 25 of @xcite .    again , the origin at @xmath283 is resolved , and like the mhd explosion , the solution did not depend significantly on whether ct was employed .      in order to test disco s performance on a 3d mhd test problem with nontrivial shocks",
    ", a 3d explosion test is performed .",
    "initial conditions are given by    @xmath360    @xmath361    all velocities are initially zero .",
    "figure [ fig : bx3d ] shows the 3d explosion at time @xmath350 .",
    "a second test was performed where the explosion is offset from the origin by an amount @xmath362 , in order to create a truly three - dimensional ( non - axisymmetric ) test ; this is plotted in the lower panel of figure [ fig : bx3d ] .",
    "this test is not performed in other studies , so there do not exist other examples to compare with , but the test demonstrates basic capturing of a 3d mhd shock structure , and that all geometric terms are correctly implemented , as the offset test has an equivalent solution to the centered test .",
    "additionally , this test shows that disco is capable of evolving shocks propagating along the coordinate axis , and shocks colliding with the coordinate singularity at @xmath283 , especially in the offset case , where the pressure jump is initiated across @xmath283 in the equatorial plane .",
    "one of the most important astrophysical applications of numerical mhd is the study of the magnetorotational instability ( mri * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "mri is thought to be the source of angular momentum transport ( and hence accretion ) in most astrophysical disks .",
    "growth of mri using disco will be studied using two test problems .",
    "first , linear growth is explored , by implementing the 3d mri test of @xcite .",
    "the set - up was described very clearly in that study , so the initial conditions will not be repeated here .",
    "the velocity field is seeded with white noise , and the magnetic field is chosen so that @xmath363 corresponds to the fastest - growing mri mode .",
    "figure [ fig : flock1 ] shows the azimuthal component of the magnetic field after eight orbits , to be compared with figure 5 of @xcite .",
    "coherent magnetic fields have grown from white noise initial perturbations .",
    "growth of the mri is shown in figure [ fig : flock2 ] , which plots the  radial magnetic energy \" , showing the exponential growth of the instability , compared with the growth rate found by @xcite ( see their figure 3 ) . at resolutions above @xmath364 , or @xmath365 zones per mri wavelength",
    ", the correct growth rate is recovered .",
    "capturing the correct linear growth rate of mri is an important benchmark for any 3d mhd code , but it should be recognized that linear growth does not constitute a complete mri test .",
    "the true test comes in the nonlinear , fully turbulent phase , when the statistical properties of the turbulence could be affected by the numerical scheme .",
    "the nonlinear mri test of @xcite is implemented here , to determine disco s performance on a 3d nonlinear turbulent magneto - rotational flow .",
    "the initial conditions used are given by their ",
    "zero net flux \" case .",
    "figure [ fig : stone1 ] shows a snapshot in time of the magnetic energy , to be compared with figure 1 of @xcite .",
    "figure [ fig : stone2 ] plots the quantities @xmath366 and @xmath367 , which are given by    @xmath368    @xmath369    where the average is taken over the entire domain . these can be compared with @xcite , figure 5 .",
    "finally , the magnetic  tilt angle \" is measured .",
    "this is defined as    @xmath370    @xcite showed that this tilt angle is robustly @xmath371 ( see their figure 11 and their table 3 ) . in the bottom panel of figure [ fig : stone2 ] , this tilt angle is plotted , showing consistency with this value .",
    "finally , a few tests are performed to determine disco s performance and scaling to large numbers of processors .",
    "the keplerian shear flow test ( section [ sec : kepler ] ) is performed in both 2d and 3d , on various numbers of processors , and with variable resolution . both",
    " strong scaling \" ( with fixed resolution ) and  weak scaling \" ( with fixed number of zones per process ) are measured in figure [ fig : scaling ] .",
    "calculations wer performed with 2.8 ghz intel xeon e5 - 2680v2 processors , using the 20-core  ivy - bridge \" nodes on nasa s pleiades supercomputer .",
    "disco s peak performance is @xmath372 zone updates per cpu second . in the range between a few nodes and up to thousands of cpus , typical performance is @xmath373 zone updates per cpu second .",
    "a latency is reached when there are as few as two radial zones per cpu in 2d ( or two radial and two vertical zones per cpu in 3d ) .",
    "a moving - mesh technique is presented for numerically integrating both hydro and mhd equations in 3d , with specific application to astrophysical disks , using a new constrained transport technique .",
    "the disco code has been made publicly available at ` https://github.com/duffell/disco ` under the gnu general public license .",
    "the numerical scheme has been detailed in this work , including a description of the novel constrained transport technique .",
    "the versatility of the scheme is shown by describing the implementation of many different systems of equations , including the  bare \" euler equations , viscous hydrodynamics , magnetohydrodynamics , and including additional terms due to the gravitational influence of orbiting bodies .",
    "many code tests have been performed , demonstrating disco s ability to integrate all of these different systems of equations .",
    "disco has no trouble accurately capturing shocks , whether they are aligned or misaligned with the orbital motion .",
    "disco excels at advecting contact discontinuities and mhd discontinuities with the orbital flow .",
    "disco also converges at second - order for smooth flows , and can evolve flows with very high mach number without accumulating significant errors .",
    "disco is ideal for studies of disk - satellite interactions , especially problems which involve a near - equal - mass binary , where both point masses must be resolved on the grid .",
    "it is also an accurate code for calculating mri , as demonstrated by code tests of both linear stability and nonlinear turbulence .    the constrained transport technique for maintaining zero divergence errors while updating the magnetic fields is unique and applicable to nontrivial and dynamic mesh topologies .",
    "stable , accurate evolution is possible with this ct method and , as demonstrated in several of the code tests , ct is necessary to prevent inaccurate or unstable evolution .",
    "certainty in the robustness of the ct method is assured by disco s accurate calculation of the magnetorotational instability , capturing both the linear growth rate and the nonlinear turbulent phase in quantitative comparisons with previous numerical studies .    in the future , it will also be possible to use disco to integrate the equations of general relativistic magnetohydrodynamics ( grmhd ) , for application to black hole accretion disks .",
    "self - gravity is another future improvement which is possible .",
    "both of these improvements will be presented in a future study .",
    "resources supporting this work were provided by the nasa high - end computing ( hec ) program through the nasa advanced supercomputing ( nas ) division at ames research center .",
    "some early exploratory calculations employed the savio computational cluster resource provided by the berkeley research computing program at the university of california , berkeley ( supported by the uc berkeley chancellor , vice chancellor of research , and office of the cio ) .",
    "i am grateful to andrew macfadyen , daniel dorazio , brian farris , jeffrey fung , andrei gruzinov , zoltan haiman , frederic masset , philip mocz , diego muoz , eliot quataert , stephan rosswog , geoff ryan , jim stone , and jonathan zrake for helpful comments and discussions .",
    "i would also like to thank the anonymous referee for the very helpful review .",
    "in section [ sec : visc_sec ] , viscous terms were added to euler s equations . here",
    "these terms are derived .",
    "the navier - stokes equation is given by the following :        the quantity @xmath138 is related to the ratio of bulk viscosity to shear viscosity . for pure shear flow , the value of @xmath138 should have no impact on the solution .",
    "initially , the value of @xmath377 is chosen , and will be re - introduced near the end of the derivation .",
    "additionally , for ease of presentation , the prefactor @xmath378 will be ignored ( set to unity ) until the last few steps .",
    "finally , this derivation will be carried out in 2d ( @xmath379 ) for simplicity , but the additional terms in the vertical dimension are straightforward to calculate .",
    "however , this result does not agree at face value with standard expressions in for viscous terms in cylindrical coordinates ( e.g. * ? ? ? * of the first edition ) .",
    "it is not enough to evaluate the different components of @xmath388 in cylindrical coordinates , since there are additional geometric terms which come from taking its divergence . if @xmath388 were a vector , its components would be sufficient , since one can use the divergence theorem to evaluate it .",
    "however , since @xmath375 is a tensor , additional terms appear .",
    "the appropriate goal , then , is to write @xmath375 in the following form :      this expression looks like the divergence of a vector plus a source term , and therefore @xmath390 can be manipulated as a vector ( treating the raised index as a vector index ) .",
    "it is important to point out that the presence of a source term here is inescapable , due to the fact that the geometry does not have a symmetry in the radial direction .",
    "there are several things to note about these expressions .",
    "first , they also do nt agree with standard formulas for viscosity in cylindrical coordinates @xcite .",
    "in particular , there are mixed derivative terms .",
    "this can be resolved by choosing a suitable value of @xmath138 .",
    "recall that @xmath138 is the coefficient of the divergence of velocity , which will be abbreviated as @xmath396 :                                          as expected , there is no source term for angular momentum .",
    "after re - introducing the coefficient @xmath378 , equations ( [ eqn : v1]-[eqn : v2 ] ) can be re - expressed as the terms given in ( [ eqn : viscflux ] ) and ( [ eqn : viscsrc ] ) ."
  ],
  "abstract_text": [
    "<S> this work presents the publicly available moving - mesh magnetohydrodynamics code disco . </S>",
    "<S> disco is efficient and accurate at evolving orbital fluid motion in two and three dimensions , especially at high mach number . </S>",
    "<S> disco employs a moving - mesh approach utilizing a dynamic cylindrical mesh that can shear azimuthally to follow the orbital motion of the gas . </S>",
    "<S> the moving mesh removes diffusive advection errors and allows for longer timesteps than a static grid . </S>",
    "<S> magnetohydrodynamics is implemented in disco using an hlld riemann solver and a novel constrained transport scheme which is compatible with the mesh motion . </S>",
    "<S> disco is tested against a wide variety of problems , which are designed to test its stability , accuracy and scalability . </S>",
    "<S> in addition , several magnetohydrodynamics tests are performed which demonstrate the accuracy and stability of the new constrained transport approach , including two tests of the magneto - rotational instability ( mri ) ; one testing the linear growth rate and the other following the instability into the fully turbulent regime . </S>"
  ]
}