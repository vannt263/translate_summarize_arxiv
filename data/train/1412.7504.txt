{
  "article_text": [
    "the goal of image registration is to place differing images of the same object ( e.g. mri scans ) into a shared coordinate system so that they may be compared .",
    "one common means of doing this is to deform one image until it matches the other .",
    "typical numerical schemes for implementing this task are particle methods , where particles are used as a finite dimensional representation of a diffeomorphism .",
    "if the particles are initialized on a regular grid of resolution @xmath2 , then the solutions can be @xmath3 accurate at best where @xmath4 is the dimension of the image domain . improving this order of accuracy is non - trivial because traditional higher - order numerical schemes are designed on fixed meshes ( e.g. higher order finite differences ) .    in this paper",
    ", we seek to improve this order of accuracy by considering a more sophisticated class of particles .",
    "we will find that by equipping the particles with jet - data , one can achieve registrations with higher orders of accuracy .",
    "one impact of the use of higher - order particles is that the improved accuracy per particle permits the use of fewer particles for a desired total accuracy . for sufficiently smooth initial data",
    ", this implies the storage requirements are improved as well .",
    "we will introduce the higher - order accurate image registration framework through the following steps :    1 .",
    "we will introduce the hierarchy of jet - particles .",
    "2 .   we will pose an image registration problem as an optimal control problem on an infinite dimensional space .",
    "3 .   we will pose a sequence of deformed problems which are easier to solve .",
    "4 .   we will reduce the deformed optimization problems to optimization problems involving computation of finite dimensional odes ( i.e. an infinite dimensional reduction ) .",
    "we will find necessary conditions for sequences of computed solutions to the deformed problems to converge to the solution of the original problem at a rate @xmath1 , where @xmath5 depends on the order of the jet - particles used .",
    "finally , we will display the results of numerical experiments comparing the use of zeroth , first , and second order jet - particles .",
    "in this section , we attempt a brief overview of the large deformation diffeomorphic metric mapping ( lddmm ) framework from its origins in the 1990s , to its recent marriage with geometric mechanics ( 2000s - present ) .",
    "the notion of seeking deformations for the sake of image registration goes back a long way , see @xcite and references therein .",
    "one of the first attempts was to consider diffeomorphisms of the form @xmath6 for some map @xmath7 .",
    "the map @xmath8 is often denoted a displacement field .",
    "when @xmath8 is `` small '' , @xmath9 is a diffeomorphism , but this can fail when @xmath8 is `` large '' ( * ? ? ?",
    "* chapter 7 ) .",
    "many algorithms outside the lddmm context employ a small deformation approach with a displacement field @xmath8 .",
    "the displacement can be represented for example with b - spline basis functions .",
    "particle methods , as considered in this paper , can loosely be interpreted as large deformation equivalents to representing the displacement @xmath8 with finite linear combinations of basis functions . in particular",
    ", the kernel @xmath10 can be thought of as taking the role of e.g. b - spline basis functions in small deformation approaches .",
    "the breakdown for large @xmath8 is a result of the fact that the space of diffeomorphisms is a nonlinear space .",
    "one of the early obstacles in diffeomorphic image registration entailed dealing with this nonlinearity . a key insight in getting a handle on the nonlinearity of the diffeomorphisms was to consider the linear space of vector fields . given a time - dependent vector field @xmath11 ,",
    "one can integrate it to obtain a diffeomorphism @xmath12 , which is called the _ flow of @xmath13 _ @xcite .",
    "this insight was used to obtain diffeomorphisms for imaging applications by posing an optimal control problem on the space of vector - fields , and then integrating the flow of the optimal vector field to obtain a diffeomorphism .",
    "the well - posedness of this approach was studied in @xcite , where the cost functional ( i.e. the norm ) was identified as a fundamental choice in ensuring well - posedness and controlling properties of the resulting diffeomorphisms . a particle method based upon @xcite",
    "was implemented for the purpose of medical imaging in @xcite .",
    "the completeness of the euler - lagrange equations in @xcite was studied thoroughly in @xcite , where the image data was allowed to be of a fairly general type ( i.e. any entity upon which diffeomorphisms act smoothly ) .",
    "the analytic safe - guards provided by @xcite and @xcite where then excercised in @xcite , where a number of examples were numerically investigated .",
    "following these early investigations , connections with geometric mechanics began to form .",
    "the cost functional chosen in @xcite was the @xmath14-norm of the vector - fields . coincidentally , this is the cost functional of the @xmath15-dimensional camassa - holm equation ( see @xcite and references therein ) . in 1-dimension ,",
    "the particle solutions in @xcite are identical to the peakon solutions discovered in @xcite , and the numerical scheme reduces to that of @xcite .",
    "the convergence of @xcite was proven using geometric techniques in @xcite in the one - dimensional case .",
    "the same proof was used in @xcite for arbitrary dimensions . as images appear as advected quantities",
    ", the use of momentum maps became a useful conceptual technique for geometers to understand the numerical scheme of @xcite .",
    "the identification of numerous mathematical terms in @xcite as momentum maps was performed in @xcite .",
    "the particle method implemented in @xcite allowed only for deformations that acted as `` local translations '' ( see figure [ fig : shots](a ) ) .",
    "motivated by a desire to create more general deformations @xcite introduced a hierarchy of particles which advect jet - data .",
    "we call the particles _ jet - particles _ in this paper .",
    "the first order jet - particles modify the jacobian matrix at the particle locations and allow for `` locally linear '' transformations such as local scalings and local rotations ( see figure [ fig : shots](b - e ) ) .",
    "second order jet - particles allow for deformations which are `` locally quadratic '' ( i.e. transformations with nontrivial hessians ( see figure [ fig : shots](f - h ) ) . the geometric and hierarchal structure of @xcite was investigated in @xcite where the lie groupoid structure of jet - particles was linked to the lie group structure of the diffeomorphism group , thus making the case for jet - particles as multi - scale representations of diffeomorphisms . independently ,",
    "an incompressible version of this idea was invented for the purpose of incompressible fluid modelling in @xcite .",
    "solutions to this fluid model were numerically computed in @xcite based upon the regularized euler fluid equations developed in @xcite and expressions for matrix - valued reproducing kernels derived in @xcite .",
    "the final section of @xcite provides formulas which illustrate how jet - particles in the @xmath0th level of the hierarchy yield deformations which are approximated by particles in the @xmath16th level of the hierarchy .",
    "the approximation being accurate to an order @xmath17 where @xmath18 is some measure of particle spacing .",
    "this approximation is more or less equivalent to the approximation of a partial differential operator by a finite differences , and it will serve as one of the main tools used in this paper in producing higher - order accurate numerical schemes .",
    "let @xmath19 be a manifold and let @xmath20 be a subspace of the vector - fields on @xmath19 equipped with an inner - product @xmath21 .",
    "let @xmath22 be the corresponding topological lie group to which @xmath23 integrates ( * ? ? ?",
    "* chapter 8) . to do image registration",
    ", we try to assemble a `` small '' diffeomorphism by minimizing a cost function on the space of curve in @xmath24 .",
    "the standard cost function takes a time - dependent diffeomorphism , @xmath12 , and outputs a real number .",
    "mathematically , the cost function is often taken to be a map @xmath25 : g_v ) \\to \\mathbb{r}$ ] given by @xmath26 : = \\frac{1}{2}\\int_{0}^{1 } \\ell(v(t ) ) dt + f ( \\varphi_1 ) , \\end{aligned}\\ ] ] where @xmath27 is the eulerian velocity field @xmath28 and @xmath29 is a `` control - cost '' .",
    "explicitly , @xmath30 is obtained from @xmath27 via the initial value problem @xmath31 one then obtains extremizers of @xmath32 by solving the euler - lagrange equations on @xmath24 .",
    "however , @xmath24 is a non - commutative group , and can be very difficult to work with .",
    "it is typical to express @xmath32 as a cost function on the vector - space @xmath23 and incorporate as a constraint .",
    "this means optimizing a cost function @xmath33 , v ) \\to \\mathbb{r}$ ] with respect to constrained variations .",
    "any extremizer , @xmath34 , of @xmath35 must necessarily satisfy a symmetry reduced form of the euler - lagrange equations , known as the euler - poincar equation .",
    "in essence , the euler - poincar equations are nothing but the euler - lagrange equations pulled to the space @xmath23 . for a generic @xmath29 ,",
    "the euler - poincar equations take the form @xmath36 we suggest @xcite for further information on the euler - poincar equations .",
    "equation is an evolution equation , which allows us to search over the space of initial conditions ( i.e. @xmath23 ) in place of optimizing over space of curves ( i.e. @xmath37;v)$ ] ) .",
    "explicitly , this is done by considering the map @xmath38;v)$ ] which sends each @xmath39 to the curve @xmath40;v)$ ] obtained by integrating with initial condition @xmath41 .",
    "we can then pre - compose @xmath35 with @xmath42 to produce the function @xmath43 the initial condition @xmath44 minimizes @xmath45 if and only the solution @xmath46 of minimizes @xmath35 .",
    "generally , solutions to are extremizers of @xmath35 , and one must appeal to higher - order variations in order to obtain sufficient conditions for an extremizer to be a minimizer . however , we will not pursue these matters in this article .",
    "particle methods are typically used to approximate a diffeomorphism in the following way .",
    "we usually compute all quantities with respect to an initial condition where all the particles lie on a grid / mesh and prove convergence as the mesh width , @xmath2 , tends to @xmath47 .",
    "however , it would be nice to have an order of accuracy as well .    _",
    "problem : can we solve for a minimizer of @xmath35 with a convergence rate of @xmath48 for some @xmath49 ? _    our strategy for tackling this problem is to approximate @xmath35 with a sequence of @xmath48-accurate curve energies @xmath50 for which we can compute the minimizers exactly up to time discretization ( i.e. the computed solutions have no spatial discretization error ) . more specifically , the mesh size will determine a continuous sequence of subgroups @xmath51 .",
    "we will approximate the matching functional @xmath52 , with a @xmath53-invariant functional @xmath54 such that for a fixed @xmath55 @xmath56 for some @xmath49 .",
    "we find the curve energies to be @xmath48 accurate as well , and this accuracy will transfer to the solutions for a sufficiently wide range of scenarios .",
    "in this section , we review subgroup reduction of a class of optimization problems using clebsch variables . in the hamiltonian context , clebsch variables are also called symplectic variables , and constitute a poisson map @xmath57 .",
    "this is useful when @xmath58 , since solutions to certain hamiltonian equations on @xmath59 can be derived by solving hamiltonian equations on @xmath60 first @xcite . the lagrangian version of this idea was further developed in the context of equations with hydrodynamic background in @xcite .",
    "it is this later perspective which we shall take in this paper , since problem setup is stated in lagrangian form .",
    "a more thorough overview of the role of reduction by symmetry in lddmm can be found in @xcite .",
    "let @xmath61 be a lie group and @xmath62 be a lie subgroup with lie algebras @xmath63 and @xmath64 respectively .",
    "we will denote the homogenous space of right cosets by @xmath65 , and we will denote the corresponding principal bundle projection by @xmath66 . note that @xmath61 naturally acts on @xmath67 through the formula @xmath68 .",
    "given this action , the corresponding ( left ) momentum map , @xmath69 , is defined by the condition @xmath70    let @xmath71 be the lagrangian and let @xmath72 .",
    "we wish to minimize the curve energy or `` action '' @xmath73 = \\int_0 ^ 1 { l(g(t),\\dot{g}(t ) ) dt } + f(g(1 ) ) \\label{eq : energy_1}\\end{aligned}\\ ] ] over the space of curves @xmath74 on the interval @xmath75 $ ] with @xmath76 .",
    "that is to say @xmath77 ; g ) \\to \\mathbb{r}$ ] where @xmath78;g)$ ] denotes the space of @xmath79 curves in @xmath61 originating from the identity .",
    "extremization of @xmath35 means taking a variation in @xmath80 ; g)$ ] , which is a variation of a curve with a fixed end - point at @xmath81 but _ not _ at @xmath82 .",
    "it is simple to show that any solution must satisfy the boundary value problem @xmath83 if the dimension of @xmath61 is large , integrating this equation can be troublesome .",
    "however , in the presence of a @xmath84-symmetry a reduction can be applied to reduce the problem to a boundary value problem on @xmath67 .    throughout this section",
    "we will assume that @xmath52 is @xmath84 invariant .",
    "as a result there exists a function @xmath85 defined by the condition @xmath86 more succinctly , @xmath87 .",
    "we will also assume that @xmath88 is @xmath61-invariant , and comes from a reduced lagrangian function @xmath89 .",
    "finally , we will assume that the legendre transformation , @xmath90 is invertible .",
    "the reduced hamiltonian @xmath91 is then given by @xmath92    [ thm : reduction ] let @xmath93 .",
    "if the curve @xmath94 satisfies @xmath95 then the curve @xmath96 obtained by integrating the initial value problem @xmath97 satisfies .",
    "moreover , all minimizers of must be of this form .",
    "we can replace @xmath35 with the ( equivalent ) curve energy @xmath98 ; \\mathfrak{g } ) \\to \\mathbb{r}$ ] given by @xmath99 = \\int_0 ^ 1 { \\ell(\\xi(t ) ) dt } + f(g(1 ) ) \\label{eq : energy_2}\\end{aligned}\\ ] ] where @xmath100 is implicitly obtained through the reconstruction equation @xmath101 which we view as a constraint .",
    "minimizers of @xmath102 are related to minimizers of @xmath35 through the reconstruction equation as well .",
    "we are now going to use the @xmath84 symmetry of to reduce the dimensionality of the problem .",
    "the @xmath84 invariance of @xmath52 implies the existence of a function @xmath103 such that @xmath104 .",
    "therefore , we may equivalently express @xmath102 as the energy functional @xmath99 = \\int_0 ^ 1 { \\ell ( \\xi(t ) ) dt } + f(q(1 ) ) \\label{eq : energy_3}\\end{aligned}\\ ] ] where @xmath105 is obtained through the reconstruction equation @xmath106 with the initial condition @xmath107 .",
    "again , the dynamic constraint @xmath108 makes this a constrained optimization problem .",
    "we may take the dual of this constrained optimization problem by using lagrange multipliers to get an equivalent unconstrained optimization problem @xcite . in our case",
    ", the dual problem is that of extremizing the ( unconstrained ) curve energy @xmath109 ; \\mathfrak{g } \\times t^*q ) \\to \\mathbb{r}$ ] given by @xmath110 = \\int_0 ^ 1 \\ell(\\xi(t ) ) + \\langle p(t ) , \\dot{q}(t ) -    \\xi(t ) \\cdot q(t ) \\rangle dt + f(q(1)).\\end{aligned}\\ ] ] using the definition of @xmath111 we can re - write this as @xmath110 = \\int_0 ^ 1 \\ell(\\xi ) + \\langle p , \\dot{q }   \\rangle - \\langle j(q , p ) ,    \\xi \\rangle dt + f(q(1)).\\end{aligned}\\ ] ] we find that stationarity with respect to arbitrary variations of @xmath112 implies @xmath113 we may view as a constraint which defines @xmath112 in terms of the @xmath114 s and @xmath115 s .",
    "explicitly , tell us @xmath116 we can substitute this into the previous curve energy to eliminate the variable @xmath112 and express @xmath117 solely in terms of @xmath115 and @xmath114 .",
    "we thus obtain the curve energy @xmath118 & = \\int_0 ^ 1 \\ell \\left ( \\frac{\\delta \\ell}{\\delta \\xi}^{-1 } ( j(q , p ) ) \\right ) + \\langle p , \\dot{q } \\rangle -    \\left\\langle j(q , p ) ,   \\frac{\\delta \\ell}{\\delta \\xi}^{-1 } ( j(q , p ) ) \\right\\rangle dt \\\\      & \\quad+ f(q(1)).\\end{aligned}\\ ] ] by observing @xmath119 we can write @xmath120 as @xmath121 & = \\int_0 ^ 1 \\langle p , \\dot{q } \\rangle - h(q , p ) dt + f(q(1 ) ) .",
    "\\label{eq : reduced_curve_energy}\\end{aligned}\\ ] ] by taking arbitrary variations of @xmath114 and @xmath115 , we find that extremization of @xmath120 yields the desired result .    as a corollary",
    ", we find that extremizers of @xmath35 in can be derived by finding the extremizers of @xmath120 in . as @xmath35 is a curve energy over @xmath122 and @xmath120",
    "is a curve energy over @xmath123 , we can see the computational significance of this result most clearly when the dimension of @xmath67 is small compared to @xmath61 ( e.g. finite compared to infinite ) .",
    "more specifically , theorem [ thm : reduction ] allows us to minimize curve energies using the following gradient descent algorithm .",
    "+    we say `` if neccessary '' in step 3 because computation of @xmath96 is not needed in the context of image registration .",
    "we will find that only @xmath124 is needed . in any case , if @xmath96 were to be computed , the resulting curve would minimize the original curve energy @xmath35 given in equation , and all the minimizers of the original problem are obtained in this way . again , the advantage of this method is that the bulk of the computation is performed on the lower dimensional space @xmath125 rather than @xmath122 .    in the next sections we will consider the case where @xmath61 is a diffeomorphism group , and @xmath84 is a subgroup such that @xmath126 is the ( finite - dimensional ) space of jet - particles .",
    "in order to invoke the findings of the previous section , we must find a way to characterize the space of jet - particles as a homogenous space ( i.e. a group modulo a subgroup ) .",
    "this is the content of proposition [ prop : jets_as_quotient ] , the main result in this section .",
    "let @xmath127 be a finite set of distinct points in @xmath19 .",
    "if @xmath8 is any @xmath0-differentiable map from a neighborhood of @xmath128 , the @xmath0-jet of @xmath8 is denoted @xmath129 . in coordinates , @xmath130 is represented by the coefficients of the @xmath0th order taylor expansions of @xmath8 about each of the points in @xmath128 .",
    "we call @xmath131 the `` @xmath0th order jet functor about @xmath128 '' .",
    "this is indeed a functor , and can be applied to any @xmath0-differentiable map from subsets of @xmath19 which contain @xmath128 , including real valued functions , diffeomorphisms , and curves supported on @xmath128 ( * ? ? ?",
    "* chapter iv ) .",
    "let @xmath132 and let @xmath133 denote the identity transformation on @xmath19 .",
    "we can consider the subgroup @xmath134 and the normal subgroups @xmath135    moreover , the lie algebra of @xmath136 is @xmath137 in other words , @xmath138 is the sub - algebra of @xmath139 consisting of vector fields with vanishing partial derivatives up to order @xmath0 at the points of @xmath128 .    [",
    "prop : jets_as_quotient ] the functor , @xmath140 , is the principal bundle projection from @xmath61 to @xmath141 .",
    "this is merely the definition of @xmath140 , and a more thorough description of this statement can be found in @xcite .",
    "nonetheless , we will attempt a skeletal proof here .    if @xmath142 for some @xmath143 then @xmath144",
    ". however , @xmath145 has absolutely no impact on the @xmath0th order taylor expansion because the taylor expansion of @xmath145 is trivial to @xmath0th order .",
    "thus @xmath146 and so @xmath147 is a well defined map on the coset space @xmath148 .",
    "conversely , for each element @xmath149 one can show that the inverse image @xmath150 is composed of a single @xmath136 orbit and no more .",
    "for example if @xmath128 consists of only two distinct points then @xmath151 where @xmath152 is the frame bundle of @xmath19 .",
    "@xmath153 is a ( finite dimensional ) lie group , and the functor @xmath140 restricted to @xmath154 is a group homomorphism .",
    "moreover @xmath155 is a normal subgroup of @xmath156 for all @xmath157 .",
    "the space @xmath148 is a ( finite - dimensional ) principal bundle with structure group @xmath158 .    for @xmath159",
    "this structure group is trivial . at @xmath160",
    "this structure group is identifiable with @xmath161 where @xmath162 .",
    "in this section , we describe the basic strategy for using jet - particles to get high order accuracy in solutions to lddmm problems posed on @xmath163 .",
    "the algorithm uses an @xmath48 approximation to the matching term which is @xmath164 invariant .",
    "we then invoke theorem [ thm : reduction ] to reduce the problem to a finite dimensional boundary problem on the space of @xmath0th order jet - particles @xmath148 .",
    "we solve this problem to obtain an approximation of the solution to the original problem .    as discussed in section  [ sec : jetparticles ]",
    ", a finite number of jet - particles in @xmath165 can approximate jet - particles in @xmath148 . in particular , zeroth order jet - particles can approximate any of the higher - order jet - particles in the hierarchy . while using low order particles",
    "may perform well in practical applications , they do not represent exact solutions to higher - order discretizations of the matching term .",
    "therefore , they can not represent the exact solutions to the approximated problem that we seek here .",
    "furthermore , using lower - order particles to represent higher - order jets can be numerically unstable as the approximation is in essence a finite difference approximation : the particles need to be very close and the momentum can be of very large magnitude .",
    "we will assume that the problem is defined on a reproducing kernel hilbert space ( rkhs ) , which we denote by @xmath166 where @xmath167 will denote the space of @xmath168 vector fields .",
    "we will denote the kernel of @xmath23 by @xmath169 ( * ? ? ? * chapter 9 ) , and we will assume @xmath23 satisfies the admissibility condition @xmath170 for a constant @xmath171 a positive integer @xmath172 and all @xmath173 .",
    "we will denote the topological group which integrates @xmath23 by @xmath24 .    to make precise what we mean",
    "by `` an @xmath48 approximation '' to a matching term , we will recall the `` big @xmath174 '' notation .",
    "let @xmath175 , and let @xmath176 depend on a parameter @xmath18 .",
    "we say that @xmath177 is an _",
    "@xmath48-approximation _ to @xmath52 if @xmath178 for all @xmath179 .",
    "moreover , @xmath48 will serve as a place - holder for an arbitrary function within the equivalence class of all functions of @xmath2 which vanish at a rate of @xmath180 or faster as @xmath181 . under this notation",
    ", @xmath177 is an @xmath48-approximation of @xmath52 if @xmath182 .    to illustrate how we may produce @xmath48-approximations to matching functions",
    "we will consider the following example .",
    "[ sec : example1 ]    let @xmath183)$ ] be two greyscale images with compact support .",
    "we can consider the matching functional @xmath184 given by @xmath185 as @xmath186 and @xmath187 each have compact support , the integral term can be restricted to a compact domain .",
    "we will continue to write our integrals as integrations over @xmath188 , but we will exploit this compactification when we need to .    consider the regular lattice @xmath189 whereupon , for sufficiently small @xmath18 , the @xmath190-integral can be approximated to order @xmath3 with a riemann sum @xmath191 while the order of the set @xmath192 is infinite , the sum over @xmath192 used to compute @xmath177 has only finitely many non - zero terms to consider because @xmath186 and @xmath187 have compact support .",
    "moreover , @xmath177 is @xmath193 invariant because it only depends on @xmath194 for @xmath195 .",
    "an @xmath196 approximation is given by @xmath197 \\\\     & \\qquad\\quad + \\frac{h^{d+2}}{12 } \\big [ \\left ( i_0(x ) - i_1(\\varphi(x ) ) \\right )     ( \\partial_{\\alpha}^2 i_0(x ) \\\\   & \\qquad\\quad\\   - \\partial_{\\beta \\gamma } i_1(\\varphi(x ) ) \\partial_\\alpha\\varphi^\\beta(x ) \\partial_\\alpha \\varphi^\\gamma(x )   - \\partial_{\\gamma } i_1(\\varphi(x ) ) \\partial_{\\alpha \\alpha } \\varphi^\\gamma(x ) ) \\big]\\ , \\end{aligned}\\ ] ] and we can observe that @xmath198 is @xmath199 invariant because @xmath200 only depends on the 2nd order taylor expansion of @xmath9 centered at each @xmath195 .    given a @xmath201-invariant @xmath48-approximation @xmath202 to the matching term @xmath52 , we may consider the alternative curve energy @xmath203 = \\frac{1}{2 } \\int_{0}^{1 } \\|v(t)\\|_v^2 + f_h ( \\varphi_1)\\ , \\end{aligned}\\ ] ] where @xmath27 is the eulerian velocity field @xmath204 . for a fixed curve @xmath12",
    ", we observe that @xmath50 is an @xmath48-approximation to @xmath35 .",
    "one might surmise that the extremizers of @xmath50 provide good approximations of the extremizers of @xmath35 .",
    "this is important because @xmath50 is @xmath201-invariant , and we can invoke theorem [ thm : reduction ] to solve for extremizers of @xmath50 , but we can not do this for @xmath35 . fortunately , for many choices of @xmath177 , there will be minimizers of @xmath50 that converge to those of @xmath35 as @xmath181 with a known convergence rate .",
    "[ thm : order ] let @xmath205 be @xmath206 with respect to the topology induced by @xmath23",
    ". is a smooth manifold and a topological lie group .",
    "for example the space of @xmath207 diffeomorphisms with @xmath208 sufficiently large .",
    "] let @xmath209 be @xmath206 and an @xmath48-approximation for @xmath52 with @xmath201 invariance , constructed as above .",
    "consider the curve energies @xmath210,v ) \\to \\mathbb{r}$ ] @xmath211 = \\frac{1}{2 } \\int_{0}^{1 } \\| v(t ) \\|_v dt + f ( \\varphi_1 ) \\\\",
    "e_h [ v(\\cdot ) ] = \\frac{1}{2 } \\int_{0}^{1 } \\| v(t ) \\|_v dt + f_h ( \\varphi_1)\\ .",
    "\\end{aligned}\\ ] ] where @xmath212 is the lie integration of @xmath11 .",
    "let @xmath213 minimize @xmath214 if the hessian at @xmath44 is bounded , positive definite , and non - degenerate at @xmath44 , and @xmath42 exhibits @xmath206 dependency upon the initial velocity field , then , for sufficiently small @xmath2 , there exist a minimizer @xmath215 of @xmath216 which is an @xmath48-approximations of @xmath213 in the @xmath23-norm .",
    "we will employ the following well - known result to approximate vector - fields in @xmath23 with finite linear combinations of the rkhs kernel @xmath10 .",
    "[ lem : dense ] assume @xmath23 satisfies the admissibility assumption .",
    "consider the subspace of vector - fields @xmath217 for @xmath218 .",
    "the set @xmath219 is dense in @xmath23 with respect to @xmath220 .",
    "let @xmath221 be a sequence such that @xmath222 .",
    "let @xmath173 be orthogonal to @xmath223 .",
    "thus @xmath224 for all @xmath225 .",
    "that is to say @xmath226 for all @xmath227 and all @xmath228 .",
    "however , any point @xmath229 is the limit of a sequence @xmath230 .",
    "since all members of @xmath23 are continuous , it must be the case that @xmath231 .",
    "a direct corollary is that @xmath232 is dense in @xmath23 since @xmath233 for any @xmath234 .",
    "lemma [ lem : dense ] will allow us to approximate our cost functional on @xmath23 .    by the morse lemma ( suitably generalized to hilbert manifolds @xcite )",
    ", there exists a smooth coordinate chart around @xmath213 , @xmath235 , such that @xmath236 and @xmath237 , where @xmath238 .",
    "define also @xmath239    note that @xmath240 for @xmath241 . by the assumption on @xmath42 , and since @xmath242 , we observe that @xmath243 is @xmath206 at @xmath44 .",
    "moreover , we know that @xmath244",
    ". we can discard the `` big o '' notation and write @xmath245 where @xmath246 is independent of @xmath2 and @xmath247 for @xmath248 .",
    "since @xmath249 is nondegenerate , there exists @xmath250 such that @xmath251 .",
    "therefore @xmath252 thus , for sufficiently small @xmath253 , @xmath254 with @xmath255 when @xmath256 . given such @xmath253 , choose @xmath2 sufficiently small so that @xmath257 in @xmath258 and so that there exists @xmath259 with @xmath260 ( we know such a @xmath261 exists by lemma [ lem : dense ] )",
    ". then @xmath262 and @xmath263 when @xmath256 .",
    "thus there exists a point inside the intersection of the @xmath264-ball of @xmath213 and @xmath265 where @xmath266 is strictly smaller than on the boundary of this intersection .",
    "since @xmath267 is finite dimensional , this implies the existence of a local minimizer @xmath268 of @xmath269 . by theorem  [ thm :",
    "reduction ] , @xmath270 is also a local minimizer of @xmath266 on @xmath258 .",
    "as @xmath271 , we can let @xmath272 , and the local minima @xmath270 will approach @xmath213 . in addition",
    ", @xmath273 is a local minimum for @xmath274 which must also approach @xmath213 .",
    "this proves convergence as @xmath181 .",
    "we now address the order of accuracy .",
    "as @xmath261 is a critical point of @xmath274 , we have that @xmath275 , where @xmath276 is the frecht derivative of @xmath274 .",
    "if we define @xmath277 then we observe @xmath278 moreover @xmath279 because @xmath213 is a critical point of @xmath280 .",
    "thus we observe @xmath281 we can observe that the hessian @xmath282 is related to the hessian @xmath283 via pre - composition by the bounded linear operator @xmath284 . thus @xmath282 is a bounded operator from @xmath258 into @xmath285 . by assumption , this hessian is non - degenerate , and thus invertible .",
    "thus we observe @xmath286^{-1 } \\cdot \\left ( d \\tilde{a}(\\tilde{v}_h^ * ) h^p + d \\tilde{b}(\\tilde{v}_h^*,h ) \\right)$ ] .",
    "in other words , @xmath287 .",
    "so there exists an @xmath288 function @xmath289 and a function @xmath290 such that @xmath291 where @xmath292 for @xmath248 .",
    "thus we find @xmath293    the assumption that the hessian of the curve energy be non - degenerate is generally difficult to check in practice .",
    "we can still invoke this theorem in specific examples because the minimizer of @xmath294 is @xmath295 , and the hessian is identical to the inner product on @xmath23 .",
    "we can view all relevant examples as perturbations of this curve energy , and use the continuity of the hessian operator to invoke theorem [ thm : order ] .",
    "setting @xmath296 , @xmath297 in algorithm 1 , we obtain the special case of algorithm 1 given by    step ( 1 ) concerns solving a system of hamiltonian equations on the space of @xmath0th order jet - particles . here",
    "the configuration is given by numbers @xmath298\\indices{^\\alpha_\\beta}$ ] where @xmath299 , @xmath300 is a multi - index on @xmath188 of degree less than or equal to @xmath0 , and @xmath301 where @xmath302 is the number of jet - particles .",
    "the hamiltonian can usually be computed in closed form if the green s kernel , @xmath10 , of the rkhs @xmath23 is known in closed form . for example",
    "if @xmath303 , we obtain traditional particles ( i.e. the multi - index @xmath300 is of degree @xmath47 ) and the momentum map is given by @xmath304 where @xmath305 , and where @xmath306 is a _ one - form density _ representation of the element of @xmath285 given by @xmath307 for all @xmath308 .",
    "the hamiltonian is then given by @xmath309 and hamilton s equations are @xmath310 the velocity field in step ( 2 ) is @xmath311 steps ( 3 ) and ( 4 ) are obtained through formulas of comparable complexity .",
    "for arbitrary @xmath0 , the relationship between the momenta @xmath312 and the velocity field @xmath313 invokes the multivariate fa di bruno formula , and so the algebra rises in complexity very quickly @xcite .",
    "in the case of @xmath314 , the hamiltonian is substantially more complex but still tractable ( see in appendix [ sec : eom ] ) .",
    "however , beyond @xmath314 , a symbolic algebra package is advised .",
    "the examples we will be considering in this paper concern the case where @xmath315 , and @xmath303 or @xmath316 . by theorem [ thm :",
    "order ] , we should be able to approximate minimizers of @xmath35 with @xmath317 and @xmath318 accuracy respectively in the @xmath23-norm .",
    "in this section we , will illustrate the deformations encoded by jet - particles of various orders and numerically verify the @xmath1 convergence rate of the matching functional approximation for @xmath319 .",
    "in addition , we will show that the second order approximation @xmath320 , @xmath314 allows matching of second order image features .",
    "we use simple examples to describe the different capabilities of higher order jet - particles over lower order jet - particles .",
    "we do this by illustrating structures that can not be matched with low numbers of regular zeroth order landmarks , but can still be matched successfully with first and second order jet - particles .",
    "these effects imply more precise matching of small scale features on larger images where more spatial derivatives can be leveraged . in all examples",
    ", the jet - particles will be positioned on regular grids in the image domains .",
    "we do not pursue approximations with @xmath321 due to the difficulties of taking very high order derivatives of images and kernel functions .",
    "in addition , code complexity rises rapidly as the order increases beyond 2 .",
    "the results are obtained using the _ jetflows _ code available at http://www.github.com/stefansommer/jetflows .",
    "the package include scripts for producing the figures displayed in this section .",
    "the implementation follows algorithm  2 .",
    "the flow equations that are given in explicit form in appendix  [ sec : eom ] and the adjoint equations that are given in explicit form in appendix  [ sec : adjoint ] are numerically integrated using scipy s odeint solver ( http://scipy.org ) .",
    "both equation systems require a series of tensor multiplications .",
    "the optimization is performed with a quasi - newton bfgs optimizer .",
    "the algorithm uses isotropic gaussian kernels .",
    "the images to be matched are pre - smoothed with a gaussian filter , and image derivatives are computed as analytic gradients of b - spline interpolations of the smoothed images .",
    "figure  [ fig : shots ] ( page  ) shows the deformations encoded by zeroth , first and second order jet - particles on initially square grids . note the locally affine deformations arising from the zeroth and first order jet - particles . up to rotation of the axes ,",
    "the three first order examples in the figure constitute a basis of the 4 dimensional space of first order jet - particles with fixed lower - order components .",
    "likewise , up to rotation , the three second order examples constitute a basis for the 6 dimensional space of second order jet - particles .",
    "we here illustrate and test the convergence rate of the matching functional approximations . in figure",
    "[ fig : simtest ] ( page ) , the approximations @xmath322 are compared for @xmath323 and varying grid sizes on three synthetic images supported on the unit square .",
    "the first two images ( a , b ) are generated by first and second order polynomials , respectively , while the last image ( c ) is generated by a trigonometric function .",
    "a truncated taylor expansion can therefore only approximate the image ( c ) .",
    "the second order approximation @xmath324 models @xmath52 locally with a second order polynomial , and it is thus expected that the error should vanish on the images ( a , b ) .",
    "as the mesh width @xmath2 decreases , we expect to observe @xmath325 convergence rate for the zeroth order approximation @xmath326 on all three images .",
    "likewise , we expect a convergence rate of @xmath318 for @xmath324 on image ( c ) .    in accordance with these expectations",
    ", we see the vanishing error for @xmath324 on ( a , b ) and decreasing error on ( c ) ( lower row , solid green lines ) .",
    "the non - monotonic convergence seen on ( c ) is a result of the polynomial approximation being integrated over a compact domain .",
    "the zeroth order approximation @xmath326 likewise decreases with @xmath327 convergence rate ( lower row , dashed blue lines ) .",
    "the convergence rate of @xmath324 on image ( c ) stabilizes at approximately @xmath328 until it decreases due to numerical errors introduced when the error approaches the machine precision .      with the following set of examples ,",
    "we wish to illustrate the effects of including second order information in the matching term approximation .",
    "we visualize this using simple test images . in all examples",
    ", we will employ the approximations @xmath320 for @xmath319 .",
    "in addition , we will match using only zeroth and first order information with a matching term that results from dropping the second order terms from @xmath324 .",
    "while this approximation does not arise naturally from a taylor expansion of @xmath52 , it allows visualization of the differences between including first and second order image information in the match .    in figure",
    "[ fig : barimages1 ] , a bar ( moving image ) is matched to a square ( fixed image ) .",
    "the figure shows how four jet - particles move from their positions on a grid in the fixed image ( a ) to positions in the moving image that contain features matching the fixed image up to the order of the approximation . for zeroth order ( b ) ,",
    "only pointwise intensity is matched and the jet - particles move vertically ( red crosses ) resulting in only a slight deformation . with first order matching ( c ) ,",
    "the jet - particles locally rotate the domain ( warp jacobian matrices shown with green boxes ) to account for the image gradient at the corners of the square .",
    "this produces a diamond - like shape . with second order ( d ) ,",
    "the corners are matched and the jet - particles move towards the corners of the moving image bar .",
    "the middle row shows the warped moving images enlarged .",
    "the second order match ( h ) is close to the fixed image ( a ) while both first and zeroth order fail to produce satisfying matches .",
    "figure  [ fig : barimages2 ] shows the result of matching images differing by an affine transformation with either one first order jet or multiple zeroth order jet - particles .",
    "while three zeroth order jet - particles can approximate a first order deformation in 2d , four particles are used to produce a symmetric picture .",
    "the warp jacobians deform the initially square green boxes displayed at the jet positions .",
    "the resulting warps in both cases approximate an affine transformation .    with translation only , including second order information in the match does not change the result as illustrated in figure  [ fig : translation ] where the match is performed on an image and a translated version of the image .",
    "we illustrate the effect of the increased order on real images by matching two mid - sagittal slices of 3d mri from the mgh10 dataset @xcite . in figure",
    "[ fig : slices ] , red boxes mark the ventricle area of the brain on which the matching is performed .",
    "we perform the match with 9 jet - particles ( 3 per axis ) , 16 jet - particles ( 4 per axis ) and 64 jet - particles ( 8 per axis ) and @xmath319 . with 9 second order jet - particles ( e ) , the moving image ( d )",
    "approaches the fixed ( b ) .",
    "a visually good match is obtained with 16 or more jet - particles . 9 and 16 zeroth order jet - particles are not sufficient to correctly encode the expansion of the ventricle . with 64 zeroth order jet - particles ,",
    "the transformed image is close to the results of the second order matches .",
    "a priori , the lddmm framework of image registration poses an optimization problem on the space of diffeomorphism . here",
    ", we introduced a family of discretized cost functions on a finite dimensional phase space that can be minimized numerically .",
    "the solutions of the discretized problem can be related to solutions of the full infinite - dimensional problem with @xmath1 accuracy , where @xmath2 is a grid spacing and @xmath0 is the order of approximation .",
    "we provided numerical examples of deformations parametrized by zeroth , first , and second order jet - particles , and we showed examples of the higher order convergence of the similarity measure .",
    "the higher - order similarity measure allows matching of higher order features , and we use this fact to register various shapes and images with low numbers of jet - particles .",
    "representing a @xmath168 image requires much less information than representing a @xmath329 image .",
    "heuristically , the impact of this for computation is that we may use different techniques to approximate and advect smooth images with a sparse set of parameters .",
    "the higher - order accuracy schemes here constitutes a particular example of using reduction by symmetry to remove redundant information , and specialize advection to the data at hand . in this case",
    ", we reduce the dimensionality from infinite to finite for a given discretization , and we specialize the discretization to @xmath206 images .    while the applicability of this specialization is limited to images of sufficient regularity , the bigger point of this article is the notion of tailoring discretizations to data .",
    "this approach is applicable for reducing the dimensionality of data beyond images . for example , accurate discretizations of curves with tangents , surfaces with tangent planes , and higher - order tensors can be derived with corresponding reduction in dimensionality .",
    "the present framework thus points to a general approach for higher - order accurate discretizations of general classes of matching problems .",
    "future work will constitute testing these areas of wider applicability .",
    "henry o. jacobs is supported by the european research council advanced grant 267382 fcca .",
    "stefan sommer is supported by the danish council for independent research with the project `` image based quantification of anatomical change '' .",
    "we would like to thank klas modin for summarizing the literature on analysis of the epdiff equation , especially in regards to smoothness of initial conditions .",
    "the equations of motion are expressible as hamiltonian equations with respect to a non - canonical poisson bracket .",
    "if we denote @xmath330 simply by @xmath114 and @xmath331 simply by @xmath115 then the hamiltonian is @xmath332    \\indices{_{\\beta}^{\\gamma } } \\partial_\\gamma k^{\\alpha \\beta } ( q_i -    q_j ) \\\\    & + p_{i \\alpha } [ \\mu^{(2)}_j ] \\indices{_\\beta^{\\gamma        \\delta } } \\partial_{\\delta \\gamma}k^{\\alpha \\beta } ( q_i - q_j ) -    \\frac{1}{2 } [ \\mu_i^{(1 ) } ] \\indices{_{\\alpha}^\\delta } [ \\mu_j^{(1 ) } ]    \\indices{_\\beta^\\gamma } \\partial_{\\delta \\gamma } k^{\\alpha      \\beta}(q_i -q_j ) \\\\    & + [ \\mu_i^{(1)}]\\indices{_\\alpha^\\epsilon } [ \\mu_j^{(2 ) } ]    \\indices{_\\beta^{\\gamma \\delta } } \\partial_{\\epsilon \\gamma \\delta }    k^{\\alpha \\beta } ( q_i - q_j ) \\\\    & + \\frac{1}{2 }    [ \\mu_i^{(2)}]\\indices{_\\alpha^{\\epsilon \\phi } } [ \\mu_j^{(2 ) } ]    \\indices{_\\beta^{\\gamma \\delta } } \\partial_{\\gamma \\delta \\epsilon      \\phi } k^{\\alpha \\beta } ( q_i - q_j ) \\end{aligned}\\ ] ] where @xmath333 .",
    "hamiton s equations are then given in short by @xmath334 more explicitly , equation is given by @xmath335 \\indices{_\\beta^\\gamma } \\partial_\\gamma k^{\\alpha      \\beta}(q_i - q_j ) + [ \\mu^{(2)}_j ]",
    "\\indices{_\\beta^{\\gamma        \\delta } } \\partial_{\\gamma \\delta } k^{\\alpha \\beta}(q_i - q_j)\\end{aligned}\\ ] ] equation is given by the sum @xmath336    where we define the six terms in this sum as @xmath337\\indices{_\\beta^\\gamma } -    p_{j\\delta}[\\mu_i^{(1)}]\\indices{_\\beta^\\gamma } ) \\partial_{\\gamma\\alpha}k^{\\delta\\beta}(q_i    - q_j ) \\\\",
    "t^{02}_{i\\alpha } = & - ( p_{i\\epsilon }    [ \\mu_j^{(2)}]\\indices{_\\beta^{\\gamma\\delta } } + p_{j\\epsilon }    [ \\mu_i^{(2 ) } ] \\indices{_\\beta^{\\gamma\\delta } }    ) \\partial_{\\gamma\\delta\\alpha}k^{\\epsilon\\beta}(q_i - q_j ) \\\\",
    "t^{12}_{i\\alpha } = & -([\\mu_i^{(1 ) } ] \\indices{_\\phi^\\epsilon }    [ \\mu_j^{(2)}]\\indices{_\\beta^{\\gamma\\delta } } -    [ \\mu_j^{(1)}]\\indices{_\\phi^\\epsilon } [ \\mu_i^{(2 ) } ]    \\indices{_\\beta^{\\gamma\\delta } } ) \\partial_{\\epsilon\\gamma\\delta\\alpha}k^{\\phi\\beta}(q_i    - q_j ) \\\\",
    "t^{11}_{i\\alpha } = & [ \\mu_i^{(1 ) } ] \\indices{_\\epsilon^\\delta }    [ \\mu_j^{(1)}]\\indices{_\\beta^\\gamma } \\partial_{\\delta\\gamma\\alpha }    k^{\\epsilon\\beta}(q_i - q_j ) \\\\",
    "t^{22}_{i\\alpha } = & -[\\mu_i^{(2)}]\\indices{_\\zeta^{\\epsilon\\phi } }    [ \\mu_j^{(2)}]\\indices{_\\beta^{\\gamma\\delta } } \\partial_{\\epsilon\\delta\\gamma\\phi\\alpha }    k^{\\zeta\\beta}(q_i - q_j)\\end{aligned}\\ ] ]    next , we calculate the quantities @xmath338 for @xmath339 of equation to be @xmath340\\indices{^\\alpha_\\beta } = &    p_{j,\\gamma } \\partial_\\beta k^{\\alpha \\gamma}(q_i - q_j ) -    [ \\mu_j^{(1)}]\\indices{_{\\delta}^{\\gamma } } \\partial_{\\beta \\gamma }    k^{\\alpha \\delta } ( q_i - q_j ) +    [ \\mu_j^{(2)}]\\indices{_{\\epsilon}^{\\gamma \\delta } } \\partial_{\\beta      \\gamma \\delta } k^{\\alpha      \\epsilon}(q_i - q_j ) \\\\    [ \\xi_i^{(2)}]\\indices{^\\alpha_{\\beta \\gamma } } = & p_{j      \\delta } \\partial_{\\beta \\gamma}k^{\\alpha \\delta}(q_i - q_j ) -    [ \\mu_j^{(1 ) } ]    \\indices{_\\delta^\\epsilon } \\partial_{\\epsilon\\beta\\gamma}k^{\\alpha\\delta}(q_i    -q_j ) + [ \\mu_j^{(2)}]\\indices{_\\epsilon^{\\phi\\delta}}\\partial_{\\beta\\gamma\\phi\\delta}k^{\\alpha\\epsilon}(q_i - q_j)\\end{aligned}\\ ] ] which allows us to compute @xmath341 in equation as @xmath342\\indices{_\\alpha^\\beta } = &   [ \\mu_i^{(1)}]\\indices{_\\alpha^\\gamma }   [ \\xi_i^{(1)}]\\indices{^\\beta_\\gamma } -   [ \\mu_i^{(1)}]\\indices{_\\gamma^\\beta }   [ \\xi_i^{(1)}]\\indices{^\\gamma_\\alpha } \\\\ &",
    "+ [ \\mu_i^{(2)}]\\indices{_\\alpha^{\\delta \\gamma } }    [ \\xi_i^{(2)}]\\indices{^\\beta_{\\delta \\gamma } }   - [ \\mu_i^{(2)}]\\indices{_\\delta^{\\beta \\gamma } }    [ \\xi_i^{(2)}]\\indices{^\\delta_{\\alpha \\gamma } }   - [ \\mu_i^{(2)}]\\indices{_\\delta^{\\gamma \\beta } }    [ \\xi_i^{(2)}]\\indices{^\\delta_{\\gamma \\alpha } } \\\\   [ \\dot{\\mu_i}^{(2)}]\\indices{_\\alpha^{\\beta \\gamma } } = & [ \\mu_i^{(2)}]\\indices{_\\alpha^{\\delta \\gamma } } [ \\xi_i^{(1)}]\\indices{^\\beta_\\delta } + [ \\mu_i^{(2)}]\\indices{_\\alpha^{\\beta \\delta } } [ \\xi_i^{(1)}]\\indices{^\\gamma_\\delta } - [ \\mu_i^{(2)}]\\indices{_\\delta^{\\beta \\gamma } } [ \\xi_i^{(1)}]\\indices{^\\delta_\\alpha}\\end{aligned}\\ ] ]      the action of @xmath112 on @xmath114 is given by @xmath344 .",
    "we set @xmath345 . we ve already calculated @xmath346 .",
    "we need only calculate @xmath347 and @xmath348 .",
    "componentwise we calculate these to be @xmath349\\indices{^\\alpha_\\beta } = &    [ \\xi^{(1)}]\\indices{^\\alpha_\\gamma } [ q^{(1)}]\\indices{^\\gamma_\\beta } \\\\    [ \\dot{q}^{(2)}]\\indices{^\\alpha_{\\beta \\gamma } } = &    [ \\xi^{(2)}]\\indices{^\\alpha_{\\delta \\epsilon } } \\cdot     [ q^{(1)}]\\indices{^\\delta_\\beta } \\cdot [ q^{(1)}]\\indices{^\\epsilon_\\gamma } +    [ \\xi^{(1)}]\\indices{^\\alpha_\\delta } \\cdot [ q^{(2 ) } ] \\indices{^\\delta_{\\beta       \\gamma } } \\end{aligned}\\ ] ]",
    "the first variation equations are equivalent to applying the tangent functor to our evolutions .",
    "we find the velocites : @xmath350 \\indices{_\\beta^\\gamma } \\partial_\\gamma k^{\\alpha \\beta}(q_i -q_j )    - [ \\mu_j^{(1)}]\\indices{_\\beta^\\gamma } \\partial_{\\gamma\\delta}k^{\\alpha\\beta}(q_i - q_j ) ( \\delta q_i^\\delta - \\delta q_j^\\delta ) \\\\    &",
    "+ [ \\delta \\mu_j^{(2)}]\\indices{_\\beta^{\\gamma\\delta } } \\partial_{\\gamma\\delta}k^{\\alpha\\beta}(q_i - q_j )    + [ \\mu_j^{(2)}]\\indices{_\\beta^{\\gamma\\delta } } \\partial_{\\gamma\\delta\\epsilon}k^{\\alpha\\beta}(q_i - q_j ) ( \\delta q_i^\\epsilon - \\delta q_j^\\epsilon)\\end{aligned}\\ ] ]    @xmath351\\indices{^\\alpha_\\beta } = & \\delta p_{j\\gamma } \\partial_\\beta k^{\\gamma\\alpha}(q_i - q_j )      + p_{j\\gamma } ( \\delta q_i^\\delta - \\delta q_j^\\delta ) \\partial_{\\delta\\beta}k^{\\alpha\\gamma}(q_i - q_j ) \\\\    & - [ \\delta \\mu_j^{(1)}]\\indices{_\\delta^\\gamma } \\partial_{\\beta\\gamma}k^{\\alpha\\delta}(q_i- q_j )     - [ \\mu_j^{(1)}]\\indices{_\\delta^\\gamma } ( \\delta q_i^\\epsilon -    \\delta    q_j^\\epsilon ) \\partial_{\\beta\\gamma\\epsilon}k^{\\alpha\\delta}(q_i - q_j )   \\\\    & + [ \\delta \\mu_j^{(2)}]\\indices{_\\phi^{\\gamma\\delta } } \\partial_{\\beta\\gamma\\delta}k^{\\alpha \\phi}(q_i - q_j )     + [ \\mu_j^{(2)}]\\indices{_\\phi^{\\gamma\\delta } } ( \\delta q_i^\\epsilon - \\delta q_j^\\epsilon ) \\partial_{\\beta\\gamma\\delta\\epsilon}k^{\\alpha\\phi}(q_i - q_j)\\end{aligned}\\ ] ]    @xmath352\\indices{^\\alpha_{\\beta\\gamma } } = &    \\delta p_{j\\delta } \\partial_{\\beta\\gamma } k^{\\alpha\\delta}(ij )     + p_{j\\epsilon } ( \\delta q_i^\\delta - \\delta q_j^\\delta ) \\partial_{\\beta\\gamma\\delta}k^{\\alpha\\epsilon}(ij ) \\\\    & - [ \\delta \\mu_j^{(1)}]\\indices{_\\epsilon^\\delta } \\partial_{\\beta\\gamma\\delta}k^{\\alpha\\epsilon}(ij )    -[\\mu_j^{(1)}]\\indices{_\\phi^\\delta } ( \\delta q_i^\\epsilon - \\delta q_j^\\epsilon ) \\partial_{\\beta\\gamma\\delta\\epsilon}k^{\\alpha\\phi}(ij ) \\\\    & + [ \\delta\\mu_j^{(2)}]\\indices{_\\phi^{\\delta\\epsilon } } \\partial_{\\beta\\gamma\\delta\\epsilon}k^{\\alpha\\phi}(ij )    + [ \\mu_j^{(2)}]\\indices{_\\lambda^{\\delta\\epsilon } }",
    "( \\delta q_i^\\phi - \\delta q_j^\\phi ) \\partial_{\\beta\\gamma\\delta\\epsilon\\phi } k^{\\alpha\\lambda}(ij)\\end{aligned}\\ ] ]    and the momenta : @xmath353    the first - variation equation for @xmath354 is @xmath355\\indices{_\\alpha^\\beta } = &    [ \\delta\\mu^{(1)}]\\indices{_\\alpha^\\gamma}[\\xi^{(1)}]\\indices{^\\beta_\\gamma }    +    [ \\mu^{(1)}]\\indices{_\\alpha^\\gamma}[\\delta\\xi^{(1)}]\\indices{^\\beta_\\gamma }    \\\\    & -[\\delta\\mu^{(1)}]\\indices{_\\gamma^\\beta}[\\xi^{(1)}]\\indices{^\\gamma_\\alpha }    -    [ \\mu^{(1)}]\\indices{_\\gamma^\\beta}[\\delta\\xi^{(1)}]\\indices{^\\gamma_\\alpha}\\\\    & + [ \\delta\\mu^{(2)}]\\indices{_\\alpha^{\\delta\\gamma}}[\\xi^{(2)}]\\indices{^\\beta_{\\delta\\gamma } }    +    [ \\mu^{(2)}]\\indices{_\\alpha^{\\delta\\gamma}}[\\delta\\xi^{(2)}]\\indices{^\\beta_{\\delta\\gamma } }    \\\\    & -[\\delta\\mu^{(2)}]\\indices{_\\delta^{\\beta\\gamma}}[\\xi^{(2)}]\\indices{^\\delta_{\\alpha\\gamma } }    -    [ \\mu^{(2)}]\\indices{_\\delta^{\\beta\\gamma}}[\\delta\\xi^{(2)}]\\indices{^\\delta_{\\alpha\\gamma } }    \\\\    & -[\\delta\\mu^{(2)}]\\indices{_\\delta^{\\gamma\\beta}}[\\xi^{(2)}]\\indices{^\\delta_{\\gamma\\alpha } }    -    [ \\mu^{(2)}]\\indices{_\\delta^{\\gamma\\beta}}[\\delta\\xi^{(2)}]\\indices{^\\delta_{\\gamma\\alpha}}\\end{aligned}\\ ] ] and finally @xmath356\\indices{_\\alpha^{\\beta\\gamma } } = &    [ \\delta\\mu^{(2)}]\\indices{_\\alpha^{\\delta\\gamma}}[\\xi^{(1)}]\\indices{^\\beta_\\delta }    +    [ \\mu^{(2)}]\\indices{_\\alpha^{\\delta\\gamma}}[\\delta\\xi^{(1)}]\\indices{^\\beta_\\delta }    \\\\    & + [ \\delta\\mu^{(2)}]\\indices{_\\alpha^{\\beta\\delta}}[\\xi^{(1)}]\\indices{^\\gamma_\\delta }    +    [ \\mu^{(2)}]\\indices{_\\alpha^{\\beta\\delta}}[\\delta\\xi^{(1)}]\\indices{^\\gamma_\\delta }    \\\\    & -[\\delta\\mu^{(2)}]\\indices{_\\delta^{\\beta\\gamma } }    [ \\xi^{(1)}]\\indices{^\\delta_\\alpha } - [ \\mu^{(2)}]\\indices{_\\delta^{\\beta\\gamma}}[\\delta\\xi^{(1)}]\\indices{^\\delta_\\alpha}\\end{aligned}\\ ] ] where the @xmath357 s are given by @xmath358    @xmath359\\indices{_\\beta^\\gamma } \\partial_{\\gamma\\alpha}k^{\\delta\\beta}(ij )    -p_{j\\delta } [ \\delta\\mu_i^{(1)}]\\indices{_\\beta^\\gamma } \\partial_{\\gamma\\alpha}k^{\\delta\\beta}(ij )    \\\\    & -p_{j\\delta}[\\mu_i^{(1)}]\\indices{_\\beta^\\gamma}(\\delta    q_i^\\epsilon - \\delta    q_j^\\epsilon ) \\partial_{\\epsilon\\gamma\\alpha}k^{\\delta\\beta}(ij ) \\\\    & + \\delta    p_{i\\delta}[\\mu_j^{(1)}]\\indices{_\\beta^\\gamma}\\partial_{\\gamma\\alpha}k^{\\delta\\beta}(ij )    + p_{i\\delta}[\\delta\\mu_j^{(1)}]\\indices{_\\beta^\\gamma}\\partial_{\\gamma\\alpha}k^{\\delta\\beta}(ij )    \\\\    & + p_{i\\delta}[\\mu_j^{(1)}]\\indices{_\\beta^\\gamma}(\\delta    q_i^\\epsilon - \\delta    q_j^\\epsilon ) \\partial_{\\epsilon\\gamma\\alpha}k^{\\delta\\beta}(ij ) \\\\\\end{aligned}\\ ] ]    @xmath360\\indices{_\\beta^{\\gamma\\delta } } \\partial_{\\gamma\\delta\\alpha } k^{\\epsilon\\beta}(ij ) -p_{i\\epsilon } [ \\delta\\mu_j^{(2)}]\\indices{_\\beta^{\\gamma\\delta } } \\partial_{\\gamma\\delta\\alpha } k^{\\epsilon\\beta}(ij ) \\\\ & -p_{i\\epsilon } [ \\mu_j^{(2)}]\\indices{_\\beta^{\\gamma\\delta } } ( \\delta q_i^\\phi - \\delta q_j^\\phi ) \\partial_{\\gamma\\delta\\phi\\alpha}k^{\\epsilon\\beta}(ij ) \\\\   & -\\delta p_{j\\epsilon } [ \\mu_i^{(2)}]\\indices{_\\beta^{\\gamma\\delta } } \\partial_{\\gamma\\delta\\alpha } k^{\\epsilon\\beta}(ij ) -p_{j\\epsilon } [ \\delta\\mu_i^{(2)}]\\indices{_\\beta^{\\gamma\\delta } } \\partial_{\\gamma\\delta\\alpha } k^{\\epsilon\\beta}(ij ) \\\\    & -p_{j\\epsilon } [ \\mu_i^{(2)}]\\indices{_\\beta^{\\gamma\\delta } } ( \\delta q_i^\\phi - \\delta q_j^\\phi ) \\partial_{\\gamma\\delta\\phi\\alpha}k^{\\epsilon\\beta}(ij ) \\\\\\end{aligned}\\ ] ]    @xmath361\\indices{_\\phi^\\epsilon } [ \\mu_j^{(2)}]\\indices{_\\beta^{\\gamma\\delta } } \\partial_{\\epsilon\\gamma\\delta\\alpha}k^{\\phi\\beta}(ij)\\\\    & -[\\mu_i^{(1)}]\\indices{_\\phi^\\epsilon }    [ \\delta\\mu_j^{(2)}]\\indices{_\\beta^{\\gamma\\delta } } \\partial_{\\epsilon\\gamma\\delta\\alpha}k^{\\phi\\beta}(ij)\\\\    & -[\\mu_i^{(1)}]\\indices{_\\phi^\\epsilon}[\\mu_j^{(2)}]\\indices{_\\beta^{\\gamma\\delta } }    ( \\delta q_i^\\zeta - \\delta    q_j^\\zeta ) \\partial_{\\zeta\\epsilon\\gamma\\delta\\alpha}k^{\\phi\\beta}(ij ) \\\\    & + [ \\delta \\mu_j^{(1)}]\\indices{_\\phi^\\epsilon } [ \\mu_i^{(2)}]\\indices{_\\beta^{\\gamma\\delta } } \\partial_{\\epsilon\\gamma\\delta\\alpha}k^{\\phi\\beta}(ij)\\\\    & + [ \\mu_j^{(1)}]\\indices{_\\phi^\\epsilon }    [ \\delta\\mu_i^{(2)}]\\indices{_\\beta^{\\gamma\\delta } } \\partial_{\\epsilon\\gamma\\delta\\alpha}k^{\\phi\\beta}(ij)\\\\    & + [ \\mu_j^{(1)}]\\indices{_\\phi^\\epsilon}[\\mu_i^{(2)}]\\indices{_\\beta^{\\gamma\\delta } }    ( \\delta q_i^\\zeta - \\delta    q_j^\\zeta ) \\partial_{\\zeta\\epsilon\\gamma\\delta\\alpha}k^{\\phi\\beta}(ij ) \\\\\\end{aligned}\\ ] ]    @xmath362\\indices{_\\epsilon^\\delta } [ \\mu_j^{(1)}]\\indices{_\\beta^\\gamma } + [ \\mu_i^{(1)}]\\indices{_\\epsilon^\\delta}[\\delta\\mu_j^{(1)}]\\indices{_\\beta^\\gamma } ) \\partial_{\\delta\\gamma\\alpha}k^{\\epsilon\\beta}(ij ) \\\\    & + [ \\mu_i^{(1)}]\\indices{_\\epsilon^\\delta }    [ \\mu_j^{(1)}]\\indices{_\\beta^\\gamma }",
    "( \\delta q_i^\\phi - \\delta    q_j^\\phi ) \\partial_{\\phi\\delta\\gamma\\alpha}k^{\\epsilon\\beta}(ij ) \\\\\\end{aligned}\\ ] ]    @xmath363\\indices{_\\zeta^{\\epsilon\\phi } } [ \\mu_j^{(2)}]\\indices{_\\beta^{\\gamma\\delta } } + [ \\mu_i^{(2)}]\\indices{_\\zeta^{\\epsilon\\phi } } [ \\delta\\mu_j^{(2)}]\\indices{_\\beta^{\\gamma\\delta } } ) \\partial_{\\epsilon\\delta\\gamma\\phi\\alpha}k^{\\zeta\\beta}(ij ) \\\\ & -[\\mu_i^{(2)}]\\indices{_\\zeta^{\\epsilon\\phi } } [ \\mu_j^{(2)}]\\indices{_\\beta^{\\gamma\\delta } } ( \\delta q_i^\\lambda - \\delta q_j^\\lambda ) \\partial_{\\lambda\\epsilon\\delta\\gamma\\phi\\alpha}k^{\\zeta\\beta}(ij)\\end{aligned}\\ ] ]    finally , we compute the variation equations for @xmath364 and @xmath365 to be @xmath366\\indices{^\\alpha_\\beta } = & [ \\delta    \\xi_i^{(1 ) } ] \\indices{^\\alpha_\\gamma }    [ q_i^{(1)}]\\indices{^\\gamma_\\beta } +    [ \\xi_i^{(1)}]\\indices{^\\alpha_\\gamma }    [ \\delta q_i^{(1)}]\\indices{^\\gamma_\\beta } \\\\",
    "\\delta [ \\dot{q}^{(2)}]\\indices{^\\alpha_{\\beta\\gamma } } = &    [ \\delta \\xi^{(2)}]\\indices{^\\alpha_{\\delta \\epsilon } } \\cdot     [ q^{(1)}]\\indices{^\\delta_\\beta } \\cdot    [ q^{(1)}]\\indices{^\\epsilon_\\gamma } +   [ \\xi^{(2)}]\\indices{^\\alpha_{\\delta \\epsilon } } \\cdot     [ \\delta q^{(1)}]\\indices{^\\delta_\\beta } \\cdot    [ q^{(1)}]\\indices{^\\epsilon_\\gamma } \\\\    & + [ \\xi^{(2)}]\\indices{^\\alpha_{\\delta \\epsilon } } \\cdot     [ q^{(1)}]\\indices{^\\delta_\\beta } \\cdot    [ \\delta q^{(1)}]\\indices{^\\epsilon_\\gamma } +     [ \\delta \\xi^{(1)}]\\indices{^\\alpha_\\delta } \\cdot [ q^{(2 ) } ] \\indices{^\\delta_{\\beta       \\gamma } } +    [ \\xi^{(1)}]\\indices{^\\alpha_\\delta } \\cdot [ \\delta q^{(2 ) } ] \\indices{^\\delta_{\\beta       \\gamma } } \\end{aligned}\\ ] ]",
    "given any ode @xmath367 on @xmath19 , we may consider the equations of motion for variations @xmath368 .",
    "in particular , @xmath369 is a linear operator over the point @xmath370 which has a dual operator .",
    "the adjoint equations are and ode on @xmath371 given by @xmath372 this is useful for us in the following way . given an integral curve , @xmath373 , and a variation in the initial condition , @xmath374 , we see that the quantity @xmath375 is constant when @xmath376 satisfies the first variation equation with initial condition @xmath374 and @xmath377 satisfies the adjoint equation . in our case",
    "we are able to compute the gradient of the energy with respect to varying an initial condition in this way .",
    "more explicitly , we should be able to express @xmath378 as a matrix @xmath379 so that the first variation equations are @xmath380 and the adjoint equations can be written as @xmath381 where @xmath382 is the covector associated to the @xmath383-th coordinate and @xmath384 is the coefficient for @xmath385 in the equation for @xmath386 . more specifically , the elements of @xmath387 is the partial derivative of @xmath388 with respect to @xmath389 .",
    "so we compute all these ( 36 ) quantities below .",
    "@xmath390^{\\alpha } } { \\partial   [ \\delta q^{(0)}_j]^{\\beta } } } } = &    \\left (    p_{k\\gamma } \\partial_{\\beta}k^{\\alpha\\gamma}(jk )     -[\\mu^{(1)}_k]\\indices{_\\delta^\\gamma } \\partial_{\\gamma\\beta}k^{\\alpha\\delta}(jk )    + [ \\mu^{(2)}_k]\\indices{_\\epsilon^{\\gamma\\delta } } \\partial_{\\gamma\\delta\\beta}k^{\\alpha\\epsilon}(jk )    \\right )    \\delta_i^j    \\\\ &    -p_{j\\gamma } \\partial_{\\beta}k^{\\alpha\\gamma}(ij )     + [ \\mu^{(1)}_j]\\indices{_\\delta^\\gamma } \\partial_{\\gamma\\beta}k^{\\alpha\\delta}(ij )    -[\\mu^{(2)}_j]\\indices{_\\epsilon^{\\gamma\\delta } } \\partial_{\\gamma\\delta\\beta}k^{\\alpha\\epsilon}(ij ) ,    \\\\    { \\ensuremath{\\frac { \\partial [ \\delta \\dot{q}_i^{(0)}]^\\alpha}{\\partial [ \\delta      q^{(1)}_j]\\indices{^\\beta_\\gamma } } } } = & 0    \\quad,\\quad    { \\ensuremath{\\frac { \\partial [ \\delta \\dot{q}_i^{(0)}]^\\alpha}{\\partial [ \\delta q^{(2)}]\\indices{^\\beta_{\\gamma\\delta } } } } } = 0 ,    \\\\    { \\ensuremath{\\frac { \\partial [ \\delta \\dot{q}_i^{(0)}]^\\alpha]}{\\partial [ \\delta p_j^{(0)}]_\\beta } } } = & k^{\\alpha\\beta}(ij )    \\quad,\\quad    { \\ensuremath{\\frac { \\partial [ \\delta      \\dot{q}_i^{(0)}]^\\alpha } { \\partial [ \\delta\\mu^{(1)}_j]\\indices{_\\beta^\\gamma } } } }    = -\\partial_\\gamma k^{\\alpha\\beta}(ij )    \\quad,\\quad    { \\ensuremath{\\frac { \\partial [ \\delta      \\dot{q}^{(0)}_i]^\\alpha}{\\partial [ \\delta\\mu_j^{(2)}]\\indices{_\\beta^{\\gamma\\delta } } } } }    = \\partial_{\\gamma\\delta}k^{\\alpha\\beta}(ij),\\end{aligned}\\ ] ]    @xmath391 \\indices{^\\alpha_\\beta}}{\\partial [ \\delta      q^{(0)}_j]\\indices{^\\gamma } } } } = & { \\ensuremath{\\frac { \\partial   [ \\delta \\xi_i^{(1 ) } ]      \\indices{^\\alpha_\\delta}}{\\partial [ \\delta q^{(0)}_j]^\\gamma } } } [ q_i^{(1)}]\\indices{^\\delta_\\beta }    \\quad,\\quad    { \\ensuremath{\\frac { \\partial [ \\delta \\dot{q}^{(1)}_i]\\indices{^\\alpha_\\beta}}{\\partial [ \\delta      q_j^{(1)}]\\indices{^\\gamma_\\delta } } } } =    [ \\xi_i^{(1)}]\\indices{^\\alpha_\\gamma }    \\delta^\\delta_\\beta \\delta_i^j ,    \\quad,\\quad    { \\ensuremath{\\frac { \\partial [ \\delta \\dot{q}^{(1)}_i ] \\indices{^\\alpha_\\beta}}{\\partial [ \\delta      q^{(2)}_j]\\indices{^\\gamma_{\\delta\\epsilon } } } } } = 0 ,    \\\\    { \\ensuremath{\\frac { \\partial [ \\delta \\dot{q}^{(1)}_i ] \\indices{^\\alpha_\\beta}}{\\partial [ \\delta      p_j^{(0)}]_\\gamma } } } = & { \\ensuremath{\\frac { \\partial [ \\delta\\xi_i^{(1 ) } ]      \\indices{^\\alpha_\\delta } } { \\partial   [ \\delta p^{(0)}_j]_\\gamma } } }    [ q_i^{(1)}]\\indices{^\\delta_\\beta }    \\quad,\\quad    { \\ensuremath{\\frac { \\partial [ \\delta \\dot{q}^{(1)}_i ] \\indices{^\\alpha_\\beta}}{\\partial [ \\delta      \\mu_j^{(1 ) } ] \\indices{_\\gamma^\\delta } } } } = { \\ensuremath{\\frac { \\partial [ \\delta\\xi_i^{(1 ) } ]      \\indices{^\\alpha_\\epsilon } } { \\partial   [ \\delta \\mu^{(1)}_j ] \\indices{_\\gamma^\\delta } } } }    [ q_i^{(1)}]\\indices{^\\epsilon_\\beta } ,    \\\\    { \\ensuremath{\\frac { \\partial [ \\delta \\dot{q}^{(1)}_i ] \\indices{^\\alpha_\\beta}}{\\partial [ \\delta      \\mu_j^{(2 ) } ] \\indices{_\\gamma^{\\delta\\epsilon } } } } } = & { \\ensuremath{\\frac { \\partial [ \\delta\\xi_i^{(1 ) } ]      \\indices{^\\alpha_\\phi } } { \\partial   [ \\delta \\mu^{(2)}_j ] \\indices{_\\gamma^{\\delta\\epsilon } } } } }    [ q_i^{(1)}]\\indices{^\\phi_\\beta},\\end{aligned}\\ ] ]    @xmath392\\indices{^\\alpha_{\\beta\\gamma}}}{\\partial [ \\delta      q_j^{(0)}]^\\delta } } } = & { \\ensuremath{\\frac { \\partial       [ \\delta\\xi_i^{(2)}]\\indices{^\\alpha_{\\phi\\epsilon}}}{\\partial [ \\delta      q_j^{(0)}]^\\delta } } } [ q_i^{(1)}]\\indices{^\\phi_\\beta }    [ q_i^{(1)}]\\indices{^\\epsilon_\\gamma } + { \\ensuremath{\\frac { \\partial       [ \\delta\\xi_i^{(1)}]\\indices{^\\alpha_\\epsilon}}{\\partial [ \\delta      q_j^{(0)}]^\\delta } } } [ q_i^{(2)}]\\indices{^\\epsilon_{\\beta\\gamma } } ,    \\\\    { \\ensuremath{\\frac { \\partial [ \\delta\\dot{q}_i^{(2)}]\\indices{^\\alpha_{\\beta\\gamma}}}{\\partial [ \\delta      q_j^{(1)}]\\indices{^\\delta_\\epsilon } } } }    = & ( [ \\xi_i^{(2)}]\\indices{^\\alpha_{\\delta\\phi } }    [ q_i^{(1)}]\\indices{^\\phi_\\gamma } \\delta^\\epsilon_\\beta +    [ \\xi_i^{(2)}]\\indices{^\\alpha_{\\phi\\delta } }    [ q_i^{(1)}]\\indices{^\\phi_\\beta } \\delta^\\epsilon_\\gamma)\\delta^j_i ,    \\\\    { \\ensuremath{\\frac { \\partial [ \\delta\\dot{q}_i^{(2)}]\\indices{^\\alpha_{\\beta\\gamma}}}{\\partial [ \\delta      q_j^{(2)}]\\indices{^\\delta_{\\epsilon\\phi } } } } } = &    [ \\xi_i^{(1)}]\\indices{^\\alpha_\\delta}\\delta^\\epsilon_\\beta    \\delta^\\phi_\\gamma \\delta^j_i ,    \\end{aligned}\\ ] ]    @xmath392\\indices{^\\alpha_{\\beta\\gamma}}}{\\partial [ \\delta      p_j^{(0)}]_\\delta } } } = & { \\ensuremath{\\frac { \\partial       [ \\delta\\xi_i^{(2)}]\\indices{^\\alpha_{\\phi\\epsilon}}}{\\partial [ \\delta p_j^{(1)}]\\indices{_\\delta } } } }    [ q_i^{(1)}]\\indices{^\\phi_\\beta } [ q_i^{(1)}]\\indices{^\\epsilon_\\gamma }    + { \\ensuremath{\\frac { \\partial [ \\delta \\xi_i^{(1)}]\\indices{^\\alpha_\\epsilon}}{\\partial [ \\delta      p_j^{(0)}]_\\delta } } } [ q_i^{(2)}]\\indices{^\\epsilon_{\\beta\\gamma } } ,    \\\\    { \\ensuremath{\\frac { \\partial [ \\delta\\dot{q}_i^{(2)}]\\indices{^\\alpha_{\\beta\\gamma}}}{\\partial [ \\delta      \\mu_j^{(1 ) } ] \\indices{_\\delta^\\epsilon } } } } = &    { \\ensuremath{\\frac { \\partial [ \\delta\\xi_i^{(2)}]\\indices{^\\alpha_{\\phi\\zeta}}}{\\partial [ \\delta\\mu_j^{(1)}]\\indices{_\\delta^\\epsilon } } } }    [ q_i^{(1)}]\\indices{^\\phi_\\beta } [ q_i^{(1)}]\\indices{^\\zeta_\\gamma }    + { \\ensuremath{\\frac { \\partial       [ \\delta\\xi_i^{(1)}]\\indices{^\\alpha_\\phi}}{\\partial [ \\delta\\mu_j^{(1)}]\\indices{_\\delta^\\epsilon } } } }    [ q^{(2)}_i]\\indices{^\\phi_{\\beta\\gamma } } ,    \\\\    { \\ensuremath{\\frac { \\partial [ \\delta\\dot{q}_i^{(2)}]\\indices{^\\alpha_{\\beta\\gamma}}}{\\partial [ \\delta      \\mu_j^{(2 ) } ] \\indices{_\\delta^{\\epsilon\\phi } } } } } = & { \\ensuremath{\\frac { \\partial   [ \\delta      \\xi_i^{(2)}]\\indices{^\\alpha_{\\zeta\\lambda}}}{\\partial       [ \\delta\\mu_j^{(2)}]\\indices{_\\delta^{\\epsilon\\phi } } } } }    [ q_i^{(1)}]\\indices{^\\zeta_\\beta }    [ q^{(1)}_i]\\indices{^\\lambda_\\gamma } + { \\ensuremath{\\frac { \\partial       [ \\delta\\xi_i^{(1)}]\\indices{^\\alpha_\\zeta}}{\\partial [ \\delta\\mu_j^{(2)}]\\indices{_\\delta^{\\epsilon\\phi } } } } } [ q_i^{(2)}]\\indices{^\\zeta_{\\beta\\gamma}},\\end{aligned}\\ ] ]    @xmath393_\\alpha}{\\partial [ \\delta q_j^{(0)}]^\\beta } } } = &    { \\ensuremath{\\frac { \\partial [ \\delta t^{00}_{i}]_\\alpha } { \\partial [ \\delta q_j^{(0)}]^\\beta } } } + { \\ensuremath{\\frac { \\partial [      \\delta t^{01}_{i}]_\\alpha } { \\partial [ \\delta q_j^{(0)}]^\\beta } } } + { \\ensuremath{\\frac { \\partial [      \\delta t^{11}_{i}]_\\alpha } { \\partial [ \\delta q_j^{(0)}]^\\beta } } } + { \\ensuremath{\\frac { \\partial [      \\delta t^{12}_{i}]_\\alpha } { \\partial [ \\delta q_j^{(0)}]^\\beta } } }   + { \\ensuremath{\\frac { \\partial [      \\delta t^{02}_{i}]_\\alpha } { \\partial [ \\delta q_j^{(0)}]^\\beta } } } + { \\ensuremath{\\frac { \\partial [      \\delta t^{22}_{i}]_\\alpha } { \\partial [ \\delta q_j^{(0)}]^\\beta } } } ,      \\\\      { \\ensuremath{\\frac { \\partial [ \\delta \\dot{p}^{(0)}_i]_\\alpha}{\\partial [ \\delta q_j^{(1 ) } ] \\indices{^\\beta_\\gamma } } } } = &   0       \\quad , \\quad      { \\ensuremath{\\frac { \\partial [ \\delta \\dot{p}^{(0)}_i]_\\alpha}{\\partial [ \\delta q_j^{(2 ) } ] \\indices{^\\beta_{\\gamma\\delta } } } } } = 0 ,      \\end{aligned}\\ ] ]    @xmath394_\\alpha}{\\partial [ \\delta p_j^{(0 ) } ]        \\indices{_\\beta } } } } = & { \\ensuremath{\\frac { \\partial [ \\delta        t_i^{00}]_\\alpha}{\\partial [ \\delta p_j^{(0)}]\\indices{_\\beta } } } } +        { \\ensuremath{\\frac { \\partial [ \\delta        t_i^{01}]_\\alpha}{\\partial [ \\delta p_j^{(0)}]\\indices{_\\beta } } } } +        { \\ensuremath{\\frac { \\partial [ \\delta        t_i^{02}]_\\alpha}{\\partial [ \\delta p_j^{(0)}]\\indices{_\\beta } } } } ,      \\\\      { \\ensuremath{\\frac { \\partial [ \\delta \\dot{p}^{(0)}_i]_\\alpha}{\\partial [ \\delta \\mu_j^{(1 ) } ]        \\indices{_\\beta^{\\gamma } } } } } = & { \\ensuremath{\\frac { \\partial [ \\delta        t_i^{01}]_\\alpha}{\\partial [ \\delta \\mu_j^{(1)}]\\indices{_\\beta^\\gamma } } } } + { \\ensuremath{\\frac { \\partial [ \\delta        t_i^{11}]_\\alpha}{\\partial [ \\delta \\mu_j^{(1)}]\\indices{_\\beta^\\gamma } } } } + { \\ensuremath{\\frac { \\partial [ \\delta        t_i^{12}]_\\alpha}{\\partial [ \\delta \\mu_j^{(1)}]\\indices{_\\beta^\\gamma } } } } ,      \\\\      { \\ensuremath{\\frac { \\partial [ \\delta \\dot{p}^{(0)}_i]_\\alpha}{\\partial [ \\delta \\mu_j^{(2 ) } ]        \\indices{_\\beta^{\\gamma\\delta } } } } } = & { \\ensuremath{\\frac { \\partial [ \\delta        t_i^{02}]_\\alpha}{\\partial [ \\delta \\mu_j^{(2)}]\\indices{_\\beta^{\\gamma\\delta } } } } } + { \\ensuremath{\\frac { \\partial [ \\delta        t_i^{12}]_\\alpha}{\\partial [ \\delta \\mu_j^{(2)}]\\indices{_\\beta^{\\gamma\\delta } } } } } + { \\ensuremath{\\frac { \\partial [ \\delta        t_i^{22}]_\\alpha}{\\partial [ \\delta \\mu_j^{(2)}]\\indices{_\\beta^{\\gamma\\delta}}}}},\\end{aligned}\\ ] ]    @xmath395\\indices{_\\alpha^\\beta}}{\\partial [ \\delta      q_j^{(0)}]^\\gamma } } } = & [ \\mu_i^{(1)}]\\indices{_\\alpha^\\delta }    { \\ensuremath{\\frac { \\partial   [ \\delta\\xi_i^{(1)}]\\indices{^\\beta_\\delta}}{\\partial   [ \\delta      q_j^{(0)}]^\\gamma } } } - [ \\mu_i^{(1)}]\\indices{_\\delta^\\beta } { \\ensuremath{\\frac { \\partial       [ \\delta \\xi_i^{(1 ) } ] \\indices{^\\delta_{\\alpha}}}{\\partial   [ \\delta      q_j^{(0)}]^\\gamma } } } \\\\    & + [ \\mu_i^{(2)}]\\indices{_\\alpha^{\\delta\\epsilon } }    { \\ensuremath{\\frac { \\partial [ \\delta\\xi_i^{(2)}]\\indices{^\\beta_{\\delta\\epsilon}}}{\\partial   [ \\delta      q_j^{(0)}]^\\gamma } } } -    [ \\mu_i^{(2)}]\\indices{_\\delta^{\\beta\\epsilon } } { \\ensuremath{\\frac { \\partial   [ \\delta      \\xi_i^{(2)}]\\indices{^\\delta_{\\alpha\\epsilon}}}{\\partial   [ \\delta      q_j^{(0)}]\\indices{^\\gamma } } } } -    [ \\mu_i^{(2)}]\\indices{_\\delta^{\\epsilon\\beta } } { \\ensuremath{\\frac { \\partial       [ \\delta\\xi_i^{(2)}]\\indices{^\\delta_{\\epsilon\\alpha}}}{\\partial   [ \\delta      q_j^{(0)}]^\\gamma } } } ,    \\\\    { \\ensuremath{\\frac { \\partial [ \\delta\\dot{\\mu}_i^{(1)}]\\indices{_\\alpha^\\beta}}{\\partial [ \\delta      q_j^{(1)}]^\\gamma } } } = & 0 ,    \\quad,\\quad    { \\ensuremath{\\frac { \\partial [ \\delta\\dot{\\mu}_i^{(1)}]\\indices{_\\alpha^\\beta}}{\\partial [ \\delta      q_j^{(2)}]^\\gamma } } } = 0 ,    \\end{aligned}\\ ] ]    @xmath396\\indices{_\\alpha^\\beta}}{\\partial [ \\delta      p_j^{(0)}]_\\gamma } } } = & [ \\mu_i^{(1)}]\\indices{_\\alpha^\\delta }    { \\ensuremath{\\frac { \\partial   [ \\delta\\xi_i^{(1)}]\\indices{^\\beta_\\delta}}{\\partial   [ \\delta      p_j^{(0)}]_\\gamma } } } - [ \\mu_i^{(1)}]\\indices{_\\delta^\\beta } { \\ensuremath{\\frac { \\partial       [ \\delta \\xi_i^{(1 ) } ] \\indices{^\\delta_{\\alpha}}}{\\partial   [ \\delta      p_j^{(0)}]_\\gamma } } } \\\\    & + [ \\mu_i^{(2)}]\\indices{_\\alpha^{\\delta\\epsilon } }    { \\ensuremath{\\frac { \\partial [ \\delta\\xi_i^{(2)}]\\indices{^\\beta_{\\delta\\epsilon}}}{\\partial   [ \\delta      p_j^{(0)}]_\\gamma } } } -    [ \\mu_i^{(2)}]\\indices{_\\delta^{\\beta\\epsilon } } { \\ensuremath{\\frac { \\partial   [ \\delta      \\xi_i^{(2)}]\\indices{^\\delta_{\\alpha\\epsilon}}}{\\partial   [ \\delta      p_j^{(0)}]\\indices{_\\gamma } } } } -    [ \\mu_i^{(2)}]\\indices{_\\delta^{\\epsilon\\beta } } { \\ensuremath{\\frac { \\partial       [ \\delta\\xi_i^{(2)}]\\indices{^\\delta_{\\epsilon\\alpha}}}{\\partial   [ \\delta      p_j^{(0)}]_\\gamma } } } ,     \\\\    { \\ensuremath{\\frac { \\partial [ \\delta \\dot{\\mu}_i^{(1)}]\\indices{_\\alpha^\\beta}}{\\partial       [ \\delta\\mu_j^{(1)}]\\indices{_\\gamma^\\delta } } } } = &    \\delta_i^j\\delta_\\alpha^\\gamma    [ \\xi_i^{(1)}]\\indices{^\\beta_\\delta } +    [ \\mu_i^{(1)}]\\indices{_\\alpha^\\epsilon } { \\ensuremath{\\frac { \\partial   [ \\delta      \\xi_i^{(1)}]\\indices{^\\beta_\\epsilon}}{\\partial       [ \\delta\\mu_j^{(1)}]\\indices{_\\gamma^\\delta } } } } -    \\delta_i^j \\delta_\\delta^\\beta    [ \\xi_i^{(1)}]\\indices{^\\gamma_\\alpha } -    [ \\mu_i^{(1)}]\\indices{_\\epsilon^\\beta }    { \\ensuremath{\\frac { \\partial [ \\delta\\xi_i^{(1)}]\\indices{^\\epsilon_\\alpha}}{\\partial [ \\delta\\mu_j^{(1)}]\\indices{_\\gamma^\\delta } } } }    \\\\    & + [ \\mu_i^{(2)}]\\indices{_\\alpha^{\\epsilon\\phi } }    { \\ensuremath{\\frac { \\partial [ \\delta\\xi_i^{(2)}]\\indices{^\\beta_{\\epsilon\\phi}}}{\\partial       [ \\delta\\mu_j^{(1)}]\\indices{_\\gamma^\\delta } } } } -    [ \\mu_i^{(2)}]\\indices{_\\phi^{\\beta\\epsilon } } { \\ensuremath{\\frac { \\partial       [ \\delta\\xi_i^{(2)}]\\indices{^\\phi_{\\alpha\\epsilon}}}{\\partial       [ \\delta\\mu_j^{(1)}]\\indices{_\\gamma^\\delta } } } } -    [ \\mu_i^{(2)}]\\indices{_\\phi^{\\epsilon\\beta } } { \\ensuremath{\\frac { \\partial       [ \\delta\\xi_i^{(2)}]\\indices{^\\phi_{\\epsilon\\alpha}}}{\\partial       [ \\delta\\mu_j^{(1)}]\\indices{_\\gamma^\\delta } } } } ,    \\\\    { \\ensuremath{\\frac { \\partial [ \\delta\\dot{\\mu}_i^{(1)}]\\indices{_\\alpha^\\beta}}{\\partial       [ \\delta\\mu_j^{(2)}]\\indices{_\\gamma^{\\delta\\epsilon } } } } } = &    [ \\mu_i^{(1)}]\\indices{_\\alpha^\\phi }    { \\ensuremath{\\frac { \\partial [ \\delta\\xi_i^{(1)}]\\indices{^\\beta_\\phi}}{\\partial       [ \\delta\\mu_j^{(2)}]\\indices{_\\gamma^{\\delta\\epsilon } } } } }    -[\\mu_i^{(1)}]\\indices{_\\phi^\\beta } { \\ensuremath{\\frac { \\partial   [ \\delta      \\xi_i^{(1)}]\\indices{^\\phi_\\alpha}}{\\partial   [ \\delta      \\mu_j^{(2)}]\\indices{_\\gamma^{\\delta\\epsilon } } } } } + \\delta_i^j    \\delta_\\alpha^\\gamma [ \\xi_i^{(2)}]\\indices{^\\beta_{\\delta\\epsilon } } , \\\\    & + [ \\mu_i^{(2)}]\\indices{_\\alpha^{\\phi\\lambda } } { \\ensuremath{\\frac { \\partial   [ \\delta      \\xi_i^{(2)}]\\indices{^\\beta_{\\phi\\lambda}}}{\\partial       [ \\delta\\mu_j^{(2)}]\\indices{_\\gamma^{\\delta\\epsilon } } } } } -    \\delta_i^j \\delta_\\delta^\\beta [ \\xi_i^{(2 ) } ]    \\indices{^\\gamma_{\\alpha\\epsilon } } \\\\    & -[\\mu_i^{(2)}]\\indices{_\\phi^{\\beta\\lambda } }    { \\ensuremath{\\frac { \\partial [ \\delta\\xi_i^{(2)}]\\indices{^\\phi_{\\alpha\\lambda}}}{\\partial [ \\delta\\mu_j^{(2)}]\\indices{_\\gamma^{\\delta\\epsilon } } } } }    - \\delta_i^j \\delta_\\epsilon^\\beta    [ \\xi_i^{(2)}]\\indices{^\\gamma_{\\delta\\lambda } } -    [ \\mu_i^{(2)}]\\indices{_\\phi^{\\lambda\\beta } }    { \\ensuremath{\\frac { \\partial [ \\delta\\xi_i^{(2)}]\\indices{^\\phi_{\\lambda\\alpha}}}{\\partial [ \\delta\\mu_j^{(2)}]\\indices{_\\gamma^{\\delta\\epsilon } } } } } , \\end{aligned}\\ ] ]    @xmath397\\indices{_\\alpha^{\\beta\\gamma}}}{\\partial   [ \\delta      q_j^{(0)}]^\\delta } } } = &    [ \\mu_i^{(2)}]\\indices{_\\alpha^{\\epsilon\\gamma } } { \\ensuremath{\\frac { \\partial   [ \\delta      \\xi_i^{(1)}]\\indices{^\\beta_\\epsilon}}{\\partial   [ \\delta q_j^{(0)}]^\\delta } } }    + [ \\mu_i^{(2)}]\\indices{_\\alpha^{\\beta\\epsilon } } { \\ensuremath{\\frac { \\partial       [ \\delta\\xi^{(1)}_i]\\indices{^\\gamma_\\epsilon}}{\\partial   [ \\delta      q^{(0)}_j]^\\delta } } } -    [ \\mu_i^{(2)}]\\indices{_\\epsilon^{\\beta\\gamma } } { \\ensuremath{\\frac { \\partial   [ \\delta      \\xi_i^{(1)}]\\indices{^\\epsilon_\\alpha}}{\\partial   [ \\delta      q_j^{(0)}]^\\delta } } }    \\\\    { \\ensuremath{\\frac { \\partial [ \\delta\\dot{\\mu}^{(2)}]\\indices{_\\alpha^{\\beta\\gamma}}}{\\partial       [ \\delta q^{(1)}]\\indices{^\\delta_\\epsilon } } } } = & 0    \\qquad    { \\ensuremath{\\frac { \\partial [ \\delta\\dot{\\mu}^{(2)}]\\indices{_\\alpha^{\\beta\\gamma}}}{\\partial       [ \\delta q^{(2)}]\\indices{^\\delta_{\\epsilon\\phi } } } } } = 0    \\end{aligned}\\ ] ]    @xmath397\\indices{_\\alpha^{\\beta\\gamma}}}{\\partial   [ \\delta      p_j^{(0)}]_\\delta } } } = &    [ \\mu_i^{(2)}]\\indices{_\\alpha^{\\epsilon\\gamma } } { \\ensuremath{\\frac { \\partial   [ \\delta      \\xi_i^{(1)}]\\indices{^\\beta_\\epsilon}}{\\partial   [ \\delta p_j^{(0)}]_\\delta } } }    + [ \\mu_i^{(2)}]\\indices{_\\alpha^{\\beta\\epsilon } } { \\ensuremath{\\frac { \\partial       [ \\delta\\xi^{(1)}_i]\\indices{^\\gamma_\\epsilon}}{\\partial   [ \\delta      p^{(0)}_j]_\\delta } } } -    [ \\mu_i^{(2)}]\\indices{_\\epsilon^{\\beta\\gamma } } { \\ensuremath{\\frac { \\partial   [ \\delta      \\xi_i^{(1)}]\\indices{^\\epsilon_\\alpha}}{\\partial   [ \\delta      p_j^{(0)}]_\\delta } } }    \\\\    { \\ensuremath{\\frac { \\partial   [ \\delta \\dot{\\mu}_i^{(2)}]\\indices{_\\alpha^{\\beta\\gamma}}}{\\partial   [ \\delta      \\mu_j^{(1 ) } ] \\indices{_\\delta^\\epsilon } } } } = &    [ \\mu_i^{(2)}]\\indices{_\\alpha^{\\phi\\gamma } } { \\ensuremath{\\frac { \\partial   [ \\delta      \\xi_i^{(1)}]\\indices{^\\beta_\\phi}}{\\partial   [ \\delta      \\mu_j^{(1)}]\\indices{_\\delta^\\epsilon } } } } +    [ \\mu_i^{(2)}]\\indices{_\\alpha^{\\beta\\phi } } { \\ensuremath{\\frac { \\partial   [ \\delta      \\xi_i^{(1)}]\\indices{^\\gamma_\\phi}}{\\partial       [ \\delta\\mu_j^{(1)}]\\indices{_\\delta^\\epsilon } } } } -    [ \\mu_i^{(2)}]\\indices{_\\phi^{\\beta\\gamma } } { \\ensuremath{\\frac { \\partial       [ \\delta\\xi_i^{(1 ) } ] \\indices{^\\phi_\\alpha}}{\\partial       [ \\delta\\mu_j^{(1)}]\\indices{_\\delta^\\epsilon } } } }    \\\\    { \\ensuremath{\\frac { \\partial   [ \\delta \\dot{\\mu}_i^{(2)}]\\indices{_\\alpha^{\\beta\\gamma}}}{\\partial   [ \\delta      \\mu_j^{(2 ) } ] \\indices{_\\delta^{\\epsilon\\phi } } } } } = &    \\delta^j_i \\delta^\\gamma_\\phi \\delta_\\alpha^\\delta    [ \\xi_i^{(1)}]\\indices{^\\beta_\\epsilon } +    [ \\mu_i^{(2)}]\\indices{_\\alpha^{\\lambda\\gamma } } { \\ensuremath{\\frac { \\partial       [ \\delta\\xi_i^{(1)}]\\indices{^\\beta_\\lambda}}{\\partial       [ \\delta\\mu_j^{(2)}]\\indices{_\\delta^{\\epsilon\\phi } } } } } + \\delta_i^j",
    "\\delta_\\alpha^\\delta \\delta_\\epsilon^\\beta    [ \\xi_i^{(1)}]\\indices{^\\gamma_\\phi } \\\\   & +    [ \\mu_i^{(2)}]\\indices{_\\alpha^{\\beta\\lambda } } { \\ensuremath{\\frac { \\partial       [ \\delta\\xi_i^{(1)}]\\indices{^\\gamma_\\lambda}}{\\partial       [ \\delta\\mu_j^{(2)}]\\indices{_\\delta^{\\epsilon\\phi } } } } } - \\delta_i^j    \\delta_\\epsilon^\\beta \\delta_\\phi^\\gamma    [ \\xi_i^{(1)}]\\indices{^\\delta_\\alpha } -    [ \\mu_i^{(2)}]\\indices{_\\lambda^{\\beta\\gamma } } { \\ensuremath{\\frac { \\partial       [ \\delta\\xi_i^{(1)}]\\indices{^\\lambda_\\alpha}}{\\partial   [ \\delta\\mu_j^{(2)}]\\indices{_\\delta^{\\epsilon\\phi}}}}}\\end{aligned}\\ ] ]    @xmath398_\\alpha}{\\partial [ \\delta q_j^{(0)}]^\\beta } } } = &    -p_{j\\gamma } p_{k\\delta } \\partial_{\\alpha\\beta}k^{\\gamma\\delta}(jk )    \\delta_j^i + p_{i\\gamma } p_{j\\delta } \\partial_{\\alpha\\beta}k^{\\gamma\\delta}(ij ) ,    \\\\    { \\ensuremath{\\frac { \\partial [ \\delta t_i^{01}]_\\alpha}{\\partial [ \\delta q_j^{(0)}]^\\beta } } } = &    \\delta_i^j(p_{j\\delta } [ \\mu_k^{(1 ) } ] \\indices{_\\epsilon^\\gamma } - p_{k\\delta }    [ \\mu_j^{(1)}]\\indices{_\\epsilon^\\gamma } ) \\partial_{\\alpha\\beta\\gamma}k^{\\delta\\epsilon}(jk)\\\\    & - ( p_{i\\delta } [ \\mu_j^{(1)}]\\indices{_\\epsilon^\\gamma } - p_{j\\delta }    [ \\mu_i^{(1)}]\\indices{_\\epsilon^\\gamma } ) \\partial_{\\beta\\gamma\\alpha}k^{\\delta\\epsilon}(ij )    \\\\    { \\ensuremath{\\frac { \\partial [ \\delta t_i^{02}]_\\alpha}{\\partial [ \\delta q_j^{(0)}]^\\beta } } } = &    ( p_{i\\epsilon } [ \\mu_j^{(2)}]\\indices{_\\phi^{\\gamma\\delta } } +    p_{j\\epsilon } [ \\mu_i^{(2 ) } ] \\indices{_\\phi^{\\gamma\\delta } }    ) \\partial_{\\gamma\\delta\\beta\\alpha}k^{\\epsilon\\phi}(ij ) \\\\    & - \\delta_i^j ( p_{j\\epsilon }    [ \\mu_k^{(2)}]\\indices{_\\phi^{\\gamma\\delta } } + p_{k\\epsilon }    [ \\mu_j^{(2)}]\\indices{_\\phi^{\\gamma\\delta } } ) \\partial_{\\gamma\\delta\\beta\\alpha}k^{\\epsilon\\phi}(jk )    \\\\    { \\ensuremath{\\frac { \\partial [ \\delta t_i^{12}]_\\alpha}{\\partial [ \\delta q_j^{(0)}]^\\beta } } } = &    \\delta^i_j ( [ \\mu_k^{(1)}]\\indices{_\\phi^\\epsilon } [ \\mu_j^{(2 ) } ]    \\indices{_\\lambda^{\\gamma\\delta } } -    [ \\mu_j^{(1)}]\\indices{_\\phi^\\epsilon } [ \\mu_k^{(2 ) } ]    \\indices{_\\lambda^{\\gamma\\delta } } ) \\partial_{\\beta\\epsilon\\gamma\\delta\\alpha}k^{\\phi\\lambda}(jk)\\\\    & - ( [ \\mu_j^{(1)}]\\indices{_\\phi^\\epsilon }    [ \\mu_i^{(2)}]\\indices{_\\lambda^{\\gamma\\delta } } -    [ \\mu_i^{(1)}]\\indices{_\\phi^\\epsilon }    [ \\mu_j^{(2)}]\\indices{_\\lambda^{\\gamma\\delta } }    ) \\partial_{\\beta\\epsilon\\gamma\\delta\\alpha } k^{\\phi\\lambda}(ij)\\\\      { \\ensuremath{\\frac { \\partial [ \\delta t_i^{11}]_\\alpha}{\\partial [ \\delta q_j^{(0)}]^\\beta } } } = &    \\delta_i^j [ \\mu_j^{(1)}]\\indices{_\\epsilon^\\delta }    [ \\mu_k^{(1)}]\\indices{_\\phi^\\gamma } \\partial_{\\beta\\gamma\\delta\\alpha }    k^{\\epsilon\\phi}(jk ) - [ \\mu_i^{(1)}]\\indices{_\\epsilon^\\delta }    [ \\mu_j^{(1)}]\\indices{_\\phi^\\gamma } \\partial_{\\beta\\delta\\gamma\\alpha}k^{\\epsilon\\phi}(ij)\\\\      { \\ensuremath{\\frac { \\partial [ \\delta t_i^{22}]_\\alpha}{\\partial [ \\delta q_j^{(0)}]^\\beta } } } = &    -\\delta_i^j [ \\mu_j^{(2)}]\\indices{_\\lambda^{\\epsilon\\phi } }    [ \\mu_k^{(2)}]\\indices{_\\zeta^{\\gamma\\delta } } \\partial_{\\beta\\epsilon\\delta\\gamma\\phi\\alpha}k^{\\lambda\\zeta}(jk )    + [ \\mu_i^{(2)}]\\indices{_\\lambda^{\\epsilon\\phi } }    [ \\mu_j^{(2)}]\\indices{_\\zeta^{\\gamma\\delta } } \\partial_{\\beta\\epsilon\\delta\\gamma\\phi\\alpha}k^{\\lambda\\zeta}(ij)\\end{aligned}\\ ] ]    @xmath399_\\beta } } } = &    -\\delta_i^j p_{k\\gamma } \\partial_\\alpha k^{\\beta\\gamma}(jk ) -    p_{i\\gamma } \\partial_{\\alpha } k^{\\gamma\\beta}(ij )    \\\\    { \\ensuremath{\\frac { \\partial   \\delta t^{01}_{i\\alpha}}{\\partial [ \\delta p_j^{(0)}]_\\beta } } } = &    - [ \\mu_i^{(1)}]\\indices{_\\delta^\\gamma } \\partial_{\\gamma\\alpha }    k^{\\beta\\delta}(ij ) + \\delta_i^j    [ \\mu_k^{(1)}]\\indices{_\\delta^\\gamma } \\partial_{\\gamma\\alpha}k^{\\beta\\delta}(jk )    \\\\    { \\ensuremath{\\frac { \\partial   \\delta t^{02}_{i\\alpha}}{\\partial [ \\delta p_j^{(0)}]_\\beta } } } = &   -    \\delta_i^j     [ \\mu_k^{(2)}]\\indices{_\\epsilon^{\\gamma\\delta } } \\partial_{\\gamma\\delta\\alpha }    k^{\\beta\\epsilon}(jk ) -    [ \\mu_i^{(2)}]\\indices{_\\epsilon^{\\gamma\\delta } } \\partial_{\\gamma\\delta\\alpha } k^{\\beta\\epsilon}(ij)\\end{aligned}\\ ] ]    @xmath400_\\alpha}{\\partial [ \\delta\\mu_j^{(1)}]\\indices{_\\beta^\\gamma } } } } = & -    \\delta_i^j p_{k\\delta } \\partial_{\\gamma\\alpha } k^{\\delta\\beta}(jk ) +    p_{i\\delta } \\partial_{\\gamma\\alpha } k^{\\delta\\beta}(ij )    \\\\    { \\ensuremath{\\frac { \\partial [ \\delta      t^{11}_i]_\\alpha}{\\partial [ \\delta\\mu_j^{(1)}]\\indices{_\\beta^\\gamma } } } } = &      ( \\delta_i^j      [ \\mu_k^{(1)}]\\indices{_\\epsilon^\\delta } \\partial_{\\gamma\\delta\\alpha}k^{\\beta\\epsilon}(jk )      + [ \\mu_i^{(1)}]\\indices{_\\epsilon^\\delta } \\partial_{\\delta\\gamma\\alpha}k^{\\epsilon\\beta}(ij )    \\\\    { \\ensuremath{\\frac { \\partial [ \\delta      t^{12}_i]_\\alpha}{\\partial [ \\delta\\mu_j^{(1)}]\\indices{_\\beta^\\gamma } } } } = &       -\\delta_i^j      [ \\mu_k^{(2)}]\\indices{_\\phi^{\\epsilon\\delta } } \\partial_{\\gamma\\epsilon\\delta\\alpha}k^{\\beta\\phi}(jk )      + [ \\mu_i^{(2)}]\\indices{_\\phi^{\\epsilon\\delta } } \\partial_{\\gamma\\epsilon\\delta\\alpha}k^{\\beta\\phi}(ij)\\end{aligned}\\ ] ]    @xmath401_\\alpha}{\\partial [ \\delta      \\mu_j^{(2)}]\\indices{_\\beta^{\\gamma\\delta } } } } } = &      -(\\delta_i^j      [ \\mu_k^{(2)}]\\indices{_\\epsilon^{\\gamma\\delta } } \\partial_{\\gamma\\delta\\alpha}k^{\\beta\\epsilon}(jk )      +      [ \\mu_i^{(2)}]\\indices{_\\epsilon^{\\gamma\\delta } } \\partial_{\\gamma\\delta\\alpha}k^{\\beta\\epsilon}(ij ) ) \\\\",
    "{ \\ensuremath{\\frac { \\partial [ \\delta t_i^{12}]_\\alpha}{\\partial [ \\delta      \\mu_j^{(2)}]\\indices{_\\beta^{\\gamma\\delta } } } } } = &    \\delta_i^j [ \\mu_k^{(1)}]\\indices{_\\phi^\\epsilon }    \\partial_{\\epsilon\\gamma\\delta\\alpha } k^{\\phi\\beta}(jk )    -    [ \\mu_i^{(1)}]\\indices{_\\phi^\\epsilon } \\partial_{\\epsilon\\gamma\\delta\\alpha } k^{\\phi\\beta}(ij ) \\\\    { \\ensuremath{\\frac { \\partial [ \\delta t_i^{22}]_\\alpha}{\\partial [ \\delta      \\mu_j^{(2)}]\\indices{_\\beta^{\\gamma\\delta } } } } } = & - \\delta_i^j    [ \\mu_k^{(2)}]\\indices{_\\zeta^{\\epsilon\\phi } }    \\partial_{\\gamma\\phi\\epsilon\\delta\\alpha } k^{\\beta\\zeta}(jk )    - [ \\mu_i^{(2)}]\\indices{_\\zeta^{\\epsilon\\phi } }    \\partial_{\\epsilon\\delta\\gamma\\phi\\alpha } k^{\\zeta\\beta}(ij)\\end{aligned}\\ ] ]    @xmath402\\indices{^\\alpha_\\beta}}{\\partial [ \\delta      q_j^{(0)}]^\\gamma } } } = &    \\left(p_{k\\delta } \\partial_{\\beta\\gamma}k^{\\alpha\\delta}(jk ) -    [ \\mu_k^{(1 ) } ]    \\indices{_\\epsilon^\\delta } \\partial_{\\beta\\gamma\\delta }    k^{\\alpha\\epsilon}(jk ) +    [ \\mu_k^{(2)}]\\indices{_\\phi^{\\epsilon\\delta } } \\partial_{\\beta\\gamma\\delta\\epsilon}k^{\\alpha\\phi}(jk )",
    "\\right ) \\delta^i_j    \\\\ &    -p_{j\\delta } \\partial_{\\beta\\gamma}k^{\\alpha\\delta}(ij ) +    [ \\mu_j^{(1 ) } ]    \\indices{_\\epsilon^\\delta } \\partial_{\\beta\\gamma\\delta }    k^{\\alpha\\epsilon}(ij ) -    [ \\mu_j^{(2)}]\\indices{_\\phi^{\\epsilon\\delta } } \\partial_{\\beta\\gamma\\delta\\epsilon}k^{\\alpha\\phi}(ij )    \\\\    { \\ensuremath{\\frac { \\partial   [ \\delta \\xi_i^{(1)}]\\indices{^\\alpha_\\beta}}{\\partial [ \\delta      q_j^{(1)}]\\indices{^\\gamma_\\delta } } } } = & 0 \\quad,\\quad    { \\ensuremath{\\frac { \\partial   [ \\delta \\xi_i^{(1)}]\\indices{^\\alpha_\\beta}}{\\partial [ \\delta      q_j^{(2)}]\\indices{^\\gamma_{\\delta\\epsilon } } } } } = 0 \\quad,\\quad    { \\ensuremath{\\frac { \\partial   [ \\delta \\xi_i^{(1)}]\\indices{^\\alpha_\\beta}}{\\partial [ \\delta      p_j^{(0)}]\\indices{_\\gamma } } } }    = \\partial_{\\beta}k^{\\gamma\\alpha}(ij ) \\\\      { \\ensuremath{\\frac { \\partial   [ \\delta \\xi_i^{(1)}]\\indices{^\\alpha_\\beta}}{\\partial [ \\delta      \\mu_j^{(1)}]\\indices{_\\gamma^\\delta } } } } = & - \\partial_{\\delta\\beta}k^{\\gamma\\alpha}(ij ) \\quad,\\quad      { \\ensuremath{\\frac { \\partial   [ \\delta \\xi_i^{(1)}]\\indices{^\\alpha_\\beta}}{\\partial [ \\delta \\mu_j^{(2)}]\\indices{_\\gamma^{\\delta\\epsilon } } } } } = \\partial_{\\epsilon\\delta\\beta}k^{\\gamma\\alpha}(ij)\\end{aligned}\\ ] ]    @xmath403\\indices{^\\alpha_{\\beta\\gamma}}}{\\partial        [ q_j^{(0)}]^\\delta } } } = &        \\left [       [ p_k^{(0)}]_\\epsilon \\partial_{\\beta\\gamma\\delta}k^{\\alpha\\epsilon}(jk )       -       [ \\mu_k^{(1)}]\\indices{_\\phi^\\epsilon}\\partial_{\\beta\\gamma\\delta\\epsilon}k^{\\alpha\\phi}(jk )       +       [ \\mu_k^{(2)}]\\indices{_\\lambda^{\\epsilon\\phi}}\\partial_{\\beta\\gamma\\delta\\epsilon\\phi}k^{\\alpha\\lambda}(jk )     \\right]\\delta^i_j     \\\\ &       - [ p_j^{(0)}]_\\epsilon \\partial_{\\beta\\gamma\\delta}k^{\\alpha\\epsilon}(ij )       +       [ \\mu_j^{(1)}]\\indices{_\\phi^\\epsilon}\\partial_{\\beta\\gamma\\delta\\epsilon}k^{\\alpha\\phi}(ij )       -       [ \\mu_j^{(2)}]\\indices{_\\lambda^{\\epsilon\\phi}}\\partial_{\\beta\\gamma\\delta\\epsilon\\phi}k^{\\alpha\\lambda}(ij ) ,     \\\\     { \\ensuremath{\\frac { \\partial [ \\xi_i^{(2)}]\\indices{^\\alpha_{\\beta\\gamma}}}{\\partial        [ q_j^{(1)}]\\indices{^\\delta_{\\epsilon } } } } } = & 0",
    "\\quad,\\quad     { \\ensuremath{\\frac { \\partial [ \\xi_i^{(2)}]\\indices{^\\alpha_{\\beta\\gamma}}}{\\partial        [ q_j^{(2)}]\\indices{^\\delta_{\\epsilon \\phi } } } } } = 0      \\quad,\\quad     { \\ensuremath{\\frac { \\partial [ \\xi_i^{(2)}]\\indices{^\\alpha_{\\beta\\gamma}}}{\\partial        [ p_j^{(0)}]\\indices{_\\delta } } } } = \\partial_{\\beta\\gamma}k^{\\alpha\\delta}(ij )     \\\\     { \\ensuremath{\\frac { \\partial [ \\xi_i^{(2)}]\\indices{^\\alpha_{\\beta\\gamma}}}{\\partial        [ \\mu_j^{(1)}]\\indices{_\\delta^{\\epsilon } } } } } = & -\\partial_{\\beta\\gamma\\epsilon}k^{\\alpha\\delta}(ij )     \\quad,\\quad     { \\ensuremath{\\frac { \\partial [ \\xi_i^{(2)}]\\indices{^\\alpha_{\\beta\\gamma}}}{\\partial        [ \\mu_j^{(2)}]\\indices{_\\delta^{\\epsilon\\phi } } } } } = \\partial_{\\beta\\gamma\\epsilon\\phi}k^{\\alpha\\delta}(ij)\\end{aligned}\\ ] ]    the adjoint equation are then given by @xmath404_\\alpha = & - [ \\lambda _ { q_j^{(0)}}]_\\beta { \\ensuremath{\\frac { \\partial         [ \\delta \\dot{q}_j^{(0)}]^\\beta } { \\partial    [ \\delta q_i^{(0)}]^\\alpha } } }     - [ \\lambda _ { q_j^{(1 ) } } ] \\indices{_\\beta^\\gamma }   { \\ensuremath{\\frac { \\partial         [ \\delta \\dot{q}_j^{(1 ) } ] \\indices{^\\beta_\\gamma } } { \\partial    [ \\delta q_i^{(0)}]^\\alpha } } }     - [ \\lambda _ { q_j^{(2 ) } } ] \\indices{_\\beta^{\\gamma\\delta } }   { \\ensuremath{\\frac { \\partial         [ \\delta \\dot{q}_j^{(2 ) } ] \\indices{^\\beta_{\\gamma\\delta } } } { \\partial    [       \\delta q_i^{(0)}]^\\alpha } } } \\\\      & - [ \\lambda _ { p_j^{(0 ) } } ] ^\\beta { \\ensuremath{\\frac { \\partial         [ \\delta \\dot{p}_j^{(0)}]_\\beta } { \\partial    [ \\delta q_i^{(0)}]^\\alpha } } }     - [ \\lambda _ { \\mu_j^{(1 ) } } ] \\indices{^\\beta_\\gamma }   { \\ensuremath{\\frac { \\partial         [ \\delta \\dot{\\mu}_j^{(1 ) } ] \\indices{_\\beta^\\gamma } } { \\partial    [ \\delta q_i^{(0)}]^\\alpha } } }     - [ \\lambda_{\\mu_j^{(2 ) } } ] \\indices{^\\beta_{\\gamma\\delta } }   { \\ensuremath{\\frac { \\partial         [ \\delta \\dot{\\mu}_j^{(2 ) } ] \\indices{_\\beta^{\\gamma\\delta } } } { \\partial    [ \\delta q_i^{(0)}]^\\alpha } } } \\end{aligned}\\ ] ]        m.  f. beg , m.  i. miller , a.  trouv , and l.  younes , _ computing large deformation metric mappings via geodesic flows of diffeomorphisms _ , international journal of computer vision * 61 * ( 2005 ) , no .  2 , 139157 .                      d  d holm and j  e marsden , _ momentum maps and measure - valued solutions ( peakons , filaments , and sheets ) for the epdiff equation _ , the breadth of symplectic and poisson geometry , progr . math . , vol . 232 , birkhuser boston , boston , ma , 2005 , pp .  203235 .",
    "mr 2103008 ( 2005g:37144 )          arno klein , jesper andersson , babak  a. ardekani , john ashburner , brian avants , ming - chang chiang , gary  e. christensen , d.  louis collins , james gee , pierre hellier , joo  hyun song , mark jenkinson , claude lepage , daniel rueckert , paul thompson , tom vercauteren , roger  p. woods , j.  john mann , and ramin  v. parsey , _ evaluation of 14 nonlinear deformation algorithms applied to human brain mri registration _ , neuroimage * 46 * ( 2009 ) , no .  3 , 786802 ( en ) ."
  ],
  "abstract_text": [
    "<S> we discretize a cost functional for image registration problems by deriving taylor expansions for the matching term . </S>",
    "<S> minima of the discretized cost functionals can be computed with no spatial discretization error , and the optimal solutions are equivalent to minimal energy curves in the space of @xmath0-jets . </S>",
    "<S> we show that the solutions convergence to optimal solutions of the original cost functional as the number of particles increases with a convergence rate of @xmath1 where @xmath2 is a resolution parameter . the effect of this approach over traditional particle methods is illustrated on synthetic examples and real images . </S>"
  ]
}