{
  "article_text": [
    "all graphs considered in this paper are finite , undirected , and have neither self - loops nor multiple edges .",
    "a _ graph homomorphism _ from a graph @xmath6 to a graph @xmath7 is a mapping @xmath8 that maps adjacent vertices of @xmath0 to adjacent vertices of @xmath1 , i.e. , @xmath9 whenever @xmath10 .",
    "the notion of a graph homomorphism is well studied in the literature due to its many practical and theoretical applications ; we refer to the textbook of hell and neetil  @xcite for a survey .",
    "we write @xmath11 to indicate the existence of a homomorphism from @xmath0 to @xmath1 .",
    "we call @xmath0 the _ guest graph _ and @xmath1 the _ host graph_. we denote the vertices of @xmath1 by @xmath12 and call them _ colors_. the reason for doing this is that graph homomorphisms generalize graph colorings : there exists a homomorphism from a graph @xmath0 to a complete graph on @xmath13 vertices if and only if @xmath0 is @xmath13-colorable",
    ". the problem of testing whether @xmath11 for two given graphs @xmath0 and @xmath1 is called the hom problem .",
    "if only the guest graph is part of the input and the host graph is _ fixed _ ,",
    "i.e. , not part of the input , then this problem is denoted as @xmath1-hom .",
    "the classical result in this area is the hell - neetil dichotomy theorem which states that @xmath1-hom is solvable in polynomial time if @xmath1 is bipartite , and np - complete otherwise  @xcite .",
    "we consider so - called _ locally constrained _ homomorphisms .",
    "the _ neighborhood _ of a vertex @xmath14 in a graph @xmath0 is denoted @xmath15 .",
    "if for every @xmath16 the restriction of @xmath17 to the neighborhood of @xmath14 , i.e. , the mapping @xmath18 , is injective , bijective , or surjective , then @xmath17 is said to be _ locally injective _ , _ locally bijective _ , or _ locally surjective _ , respectively . locally bijective homomorphisms are also called _",
    "graph coverings_. they originate from topological graph theory  @xcite and have applications in distributed computing  @xcite and in constructing highly transitive regular graphs  @xcite .",
    "locally injective homomorphisms are also called _ partial graph coverings_. they have applications in models of telecommunication  @xcite and in distance constrained labeling  @xcite .",
    "moreover , they are used as indicators of the existence of homomorphisms of derivative graphs  @xcite .",
    "locally surjective homomorphisms are also called _ color dominations _  @xcite . in addition",
    "they are known as _ role assignments _ due to their applications in social science  @xcite .",
    "just like locally bijective homomorphisms they also have applications in distributed computing  @xcite .",
    "if there exists a homomorphism from a graph @xmath0 to a graph @xmath1 that is locally bijective , locally injective , or locally surjective , respectively , then we write @xmath19 , @xmath20 , and @xmath21 , respectively .",
    "we denote the decision problems that are to test whether @xmath19 , @xmath20 , or @xmath21 for two given graphs @xmath0 and @xmath1 by lbhom , lihom and lshom , respectively .",
    "all three problems are known to be np - complete when both guest and host graphs are given as input ( see below for details ) , and attempts have been made to classify their computational complexity when only the guest graph belongs to the input and the host graph is fixed .",
    "the corresponding problems are denoted by @xmath1-lbhom , @xmath1-lihom , and @xmath1-lshom , respectively .",
    "the @xmath1-lshom problem is polynomial - time solvable either if @xmath1 has no edge or if @xmath1 is bipartite and has at least one connected component isomorphic to an edge ; in all other cases @xmath1-lshom is np - complete , even when the guest graph belongs to the class of bipartite graphs  @xcite .",
    "the complexity classification of @xmath1-lbhom and @xmath1-lihom is still open , although many partial results are known for both problems ; we refer to the papers  @xcite and to the survey by fiala and kratochvl  @xcite for both np - complete and polynomially solvable cases .    instead of fixing the host graph ,",
    "another natural restriction is to only take guest graphs from a special graph class .",
    "heggernes et al .",
    "@xcite proved that lbhom is graph isomorphism - complete when the guest graph is chordal , and polynomial - time solvable when the guest graph is interval .",
    "in contrast , lshom is np - complete when the guest graph is chordal and polynomial - time solvable when the guest graph is proper interval , whereas lihom is np - complete even for guest graphs that are proper interval  @xcite .",
    "it is also known that the problems lbhom and lshom are polynomial - time solvable when the guest graph is a tree  @xcite .    in this paper",
    "we focus on the following line of research .",
    "core _ of a graph @xmath0 is a subgraph @xmath22 of @xmath0 such that @xmath23 and there is no proper subgraph @xmath24 of @xmath22 with @xmath25 .",
    "it is known that the core of a graph is unique up to isomorphism  @xcite .",
    "dalmau , kolaitis and vardi  @xcite proved that the hom problem is polynomial - time solvable when the guest graph belongs to any fixed class of graphs whose cores have bounded treewidth .",
    "in particular , this result implies an earlier result that hom is polynomial - time solvable when the guest graph has bounded treewidth  @xcite .",
    "grohe  @xcite strengthened the result of dalmau et al .",
    "@xcite by proving that under a certain complexity assumption , namely @xmath26 $ ] , the hom problem can be solved in polynomial time if and only if this condition holds .",
    "it is a natural question whether the above results of dalmau et al .",
    "@xcite and grohe  @xcite remain true when we consider locally constrained homomorphisms instead of general homomorphisms .",
    "we can already conclude from known results that this is not the case for locally surjective homomorphisms . recall that @xmath1-lshom is np - complete even for bipartite guest graphs if @xmath1 contains at least one edge and is either non - bipartite or does not contain a connected component isomorphic to an edge  @xcite .",
    "the core of every bipartite graph with at least one edge is an edge , and consequently , has treewidth  1 .",
    "this means that bipartite graphs form a class of graphs whose cores have bounded treewidth . due to this negative answer , we pose the following ( weaker ) question instead :    _ are lbhom , lihom and lshom polynomial - time solvable when the guest graph belongs to a class of bounded treewidth ? _    this question",
    "is further motivated by two known results , namely that lbhom and lshom can both be solved in polynomial time if the guest graph is a tree , that is , has treewidth 1  @xcite .",
    "in section  [ s - npcom ] , we provide a negative answer to this question by showing that the problems lbhom , lshom and lihom are np - complete already in the restricted case where the guest graph has pathwidth at most @xmath2 , @xmath3 or @xmath4 , respectively .",
    "we also show that the three problems are np - complete even if both the guest graph and the host graph have maximum degree  @xmath5 .",
    "the latter result shows that locally constrained homomorphisms problems behave more like unconstrained homomorphisms on graphs of bounded degree than on graphs of bounded treewidth , as it is known that , for example , @xmath27-hom is np - complete on subcubic graphs  @xcite .    on the positive side , in section  [ s - pol ] , we show that all three problems can be solved in polynomial time if we bound the treewidth of the guest graph and at the same time bound the maximum degree of the guest graph or the host graph . because a graph class of bounded maximum degree has bounded treewidth if and only if it has bounded clique - width  @xcite , all three problems are also polynomial - time solvable when we bound the clique - width and the maximum degree of the guest graph . in section  [ s - pol ]",
    "we also show that lihom can be solved in polynomial time when the guest graph has treewidth  1 , which is best possible given the hardness result for lihom shown in section  [ s - npcom ] .    in section  [ s - con ] we state some relevant open problems .",
    "let @xmath0 be a graph .",
    "the _ degree _ of a vertex @xmath28 in @xmath0 is denoted by @xmath29 , and @xmath30 denotes the maximum degree of @xmath0 .",
    "let @xmath17 be a homomorphism from @xmath0 to a graph @xmath1 .",
    "moreover , let @xmath31 be an induced subgraph of @xmath0 , and let @xmath32 be a homomorphism from @xmath31 to @xmath1 .",
    "we say that @xmath17 _ extends _ ( or , equivalently , is an _ extension _ of ) @xmath32 if @xmath33 for every @xmath34 .    a _ tree decomposition _ of @xmath0 is a tree @xmath35 , where the elements of @xmath36 , called the _ nodes _ of @xmath37 , are subsets of @xmath38 such that the following three conditions are satisfied :    * for each vertex @xmath39",
    ", there is a node @xmath40 with @xmath41 , * for each edge @xmath10 , there is a node @xmath40 with @xmath42 , * for each vertex @xmath39 , the set of nodes @xmath43 induces a connected subtree of @xmath37 .",
    "the _ width _ of a tree decomposition @xmath37 is the size of a largest node @xmath44 minus  one .",
    "the _ treewidth _ of @xmath0 , denoted by @xmath45 , is the minimum width over all possible tree decompositions of @xmath0 .",
    "a _ path decomposition _ of @xmath0 is a tree decomposition @xmath37 of @xmath0 where @xmath37 is a path .",
    "the _ pathwidth _ of @xmath0 is the minimum width over all possible path decompositions of @xmath0 . by definition ,",
    "the pathwidth of @xmath0 is at least as high as its treewidth .",
    "a tree decomposition @xmath37 is _ nice _",
    "@xcite if @xmath37 is a binary tree , rooted in a root @xmath46 such that the nodes of @xmath37 belong to one of the following four types :    * a _ leaf node _",
    "@xmath44 is a leaf of @xmath37 , * an _ introduce node _",
    "@xmath44 has one child @xmath47 and @xmath48 for some vertex @xmath49 , * a _ forget node _",
    "@xmath44 has one child @xmath47 and @xmath50 for some vertex @xmath51 , * a _ join node _",
    "@xmath44 has two children @xmath52 satisfying @xmath53 .",
    "for the np - hardness results in theorem  [ t - np ] below we use a reduction from the 3-partition problem .",
    "this problem takes as input a multiset @xmath54 of @xmath55 integers , denoted in the sequel by @xmath56 , and a positive integer @xmath57 , such that @xmath58 for all @xmath59 and @xmath60 .",
    "the task is to determine whether @xmath54 can be partitioned into @xmath61 disjoint sets @xmath62 such that @xmath63 for all @xmath64 .",
    "note that the restrictions on the size of each element in @xmath54 implies that each set @xmath65 in the desired partition must contain exactly three elements , which is why such a partition @xmath62 is called a _",
    "@xmath5-partition _ of @xmath54 .",
    "the 3-partition problem is strongly np - complete  @xcite , i.e. , it remains np - complete even if the problem is encoded in unary .",
    "[ t - np ] the following three statements hold :    * lbhom is np - complete on input pairs @xmath66",
    "where @xmath0 has pathwidth at most  @xmath2 and @xmath1 has pathwidth at most  @xmath5 ; * lshom is np - complete on input pairs @xmath66 where @xmath0 has pathwidth at most  @xmath3 and @xmath1 has pathwidth at most  @xmath5 ; * lihom is np - complete on input pairs @xmath66 where @xmath0 has pathwidth at most @xmath4 and @xmath1 has pathwidth at most  @xmath4 .",
    "first note that all three problems are in np .",
    "we prove each statement separately starting with statement ( i ) .",
    "and @xmath1 that are constructed from a given instance @xmath67 of @xmath5-partition in the proof of statement ( i ) in theorem  [ t - np ] .",
    "see also figure  [ fig : detail ] for a more detailed illustration of the `` leftmost '' part of @xmath0 and the `` rightmost '' part of @xmath1 , including more labels . ]",
    "note that lbhom is in np .",
    "given an instance @xmath67 of 3-partition , we construct two graphs @xmath0 and @xmath1 as follows ; see figures  [ fig : reduction_bijective ] and  [ fig : detail ] for some helpful illustrations .",
    "the construction of @xmath0 starts by taking @xmath55 disjoint cycles @xmath68 of length @xmath57 , one for each element of @xmath54 . for each @xmath59 ,",
    "the vertices of @xmath69 are labeled @xmath70 and we add , for each @xmath71 , two new vertices @xmath72 and @xmath73 as well as two new edges @xmath74 and @xmath75 .",
    "we then add three new vertices @xmath76 , @xmath77 and @xmath78 .",
    "vertex @xmath76 is made adjacent to vertices @xmath79 and @xmath80 for every @xmath59 .",
    "finally , the vertex @xmath77 is made adjacent to every vertex @xmath72 that is not adjacent to @xmath76 , and the vertex @xmath78 is made adjacent to every vertex @xmath73 that is not adjacent to @xmath76 .",
    "this finishes the construction of @xmath0 .    to construct @xmath1 ,",
    "we take @xmath61 disjoint cycles @xmath81 of length @xmath57 , where the vertices of each cycle @xmath82 are labeled @xmath83 . for each @xmath64 and @xmath71",
    ", we add two vertices @xmath84 and @xmath85 and make both of them adjacent to @xmath86 .",
    "finally , we add a vertex @xmath87 and make it adjacent to each of the vertices @xmath84 and @xmath85 .",
    "this finishes the construction of @xmath1 .     and",
    "@xmath1 in figure  [ fig : reduction_bijective ] . ]",
    "we now show that there exists a locally bijective homomorphism from @xmath0 to @xmath1 if and only if @xmath67 is a yes - instance of 3-partition .",
    "let us first assume that there exists a locally bijective homomorphism @xmath17 from @xmath0 to @xmath1 .",
    "since @xmath17 is a degree - preserving mapping , we must have @xmath88 . moreover , since @xmath17 is locally bijective , the restriction of @xmath17 to @xmath89 is a bijection from @xmath89 to @xmath90 . again using the definition of a locally bijective mapping , this time considering the neighborhoods of the vertices in @xmath90",
    ", we deduce that there is a bijection from the set @xmath91 , i.e. , from the set of vertices in @xmath0 at distance @xmath4 from @xmath76 , to the set @xmath92 of vertices that are at distance @xmath4 from @xmath87 in @xmath1 . for every @xmath93",
    ", we define a set @xmath94 such that @xmath95 contains element @xmath96 if and only if @xmath97 .",
    "since @xmath17 is a bijection from @xmath98 to @xmath99 , the sets @xmath62 are disjoint ; moreover each element @xmath96 is contained in exactly one of them .",
    "observe that the subgraph of @xmath0 induced by @xmath98 is a disjoint union of @xmath55 paths of lengths @xmath100 , respectively , while the subgraph of @xmath1 induced by @xmath99 is a disjoint union of @xmath61 cycles of length @xmath57 each .",
    "the fact that @xmath17 is a homomorphism and therefore never maps adjacent vertices of @xmath0 to non - adjacent vertices in @xmath1 implies that @xmath63 for all @xmath64 .",
    "hence @xmath62 is a @xmath5-partition of @xmath54 .    for the reverse direction",
    ", suppose there exists a 3-partition @xmath62 of @xmath54 .",
    "we define a mapping @xmath17 as follows .",
    "we first set @xmath101 .",
    "let @xmath102 be any set of the 3-partition .",
    "we map the vertices of the cycles @xmath103 that are at distance @xmath4 from @xmath76 to the vertices of the cycle @xmath82 in the following way : @xmath104 for each @xmath105 , @xmath106 for each @xmath107 , and @xmath108 for each @xmath109 .",
    "the vertices of @xmath110 , @xmath111 and @xmath112 that are at distance more than @xmath4 from @xmath76 in @xmath0 are mapped to vertices of @xmath82 such that the vertices of @xmath110 , @xmath111 and @xmath112 appear in the same order as their images on @xmath82 . in particular ,",
    "we set @xmath104 for each @xmath113 ; the vertices of the cycles @xmath111 and @xmath112 that are at distance more than  @xmath4 from @xmath76 are mapped to vertices of @xmath82 analogously .",
    "after the vertices of the cycles @xmath68 have been mapped in the way described above , it remains to map the vertices @xmath72 and @xmath73 for each @xmath59 and @xmath71 .",
    "let @xmath114 be a pair of vertices in @xmath0 that are adjacent to @xmath76 , and let @xmath115 be the second common neighbor of @xmath72 and @xmath73 .",
    "suppose @xmath116 is the image of @xmath115 , i.e. , suppose that @xmath117",
    ". then we map @xmath72 and @xmath73 to @xmath118 and @xmath119 , respectively .",
    "we now consider the neighbors of @xmath77 and @xmath78 in @xmath0 . by construction ,",
    "the neighborhood of @xmath77 consists of the @xmath120 vertices in the set @xmath121 , while @xmath122 .",
    "observe that @xmath87 , the image of @xmath77 and @xmath78 , is adjacent to two sets of @xmath123 vertices : one of the form @xmath118 , the other of the form @xmath119 .",
    "hence , we need to map half the neighbors of @xmath77 to vertices of the form @xmath118 and half the neighbors of @xmath77 to vertices of the form @xmath119 in order to make @xmath17 a locally bijective homomorphism .",
    "the same should be done with the neighbors of @xmath78 . for every vertex @xmath116 in @xmath1",
    ", we do as follows . by construction , exactly three vertices of @xmath0 are mapped to @xmath116 , and exactly two of those vertices , say @xmath115 and @xmath124 , are at distance @xmath4 from @xmath77 in @xmath0 .",
    "we set @xmath125 and @xmath126 .",
    "we also set @xmath127 and @xmath128 .",
    "this completes the definition of the mapping @xmath17 .    since the mapping @xmath17 preserves adjacencies",
    ", it clearly is a homomorphism . in order to show that @xmath17 is locally bijective , we first observe that the degree of every vertex in @xmath0 is equal to the degree of its image in @xmath1 ; in particular , @xmath129 . from the above description of @xmath17",
    "we get a bijection between the vertices of @xmath90 and the vertices of @xmath130 for each @xmath131 . for every vertex @xmath72 that is adjacent to @xmath76 and @xmath115 in @xmath0 , its image @xmath118 is adjacent to the images @xmath87 of @xmath76 and @xmath116 of @xmath115 . for every vertex @xmath72 that is adjacent to @xmath77 ( respectively @xmath78 ) and @xmath115 in @xmath0 , its image @xmath118 or @xmath119 is adjacent to @xmath87 of @xmath77 ( respectively @xmath78 ) and @xmath116 of @xmath115 .",
    "hence the restriction of @xmath17 to @xmath132 is bijective for every @xmath59 and @xmath71 , and the same clearly holds for the restriction of @xmath17 to @xmath133 .",
    "the vertices of each cycle @xmath69 are mapped to the vertices of some cycle @xmath134 in such a way that the vertices and their images appear in the same order on the cycles .",
    "this , together with the fact that the image @xmath116 of every vertex @xmath115 is adjacent to the images @xmath118 and @xmath119 of the neighbors @xmath72 and @xmath73 of @xmath115 , shows that the restriction of @xmath17 to @xmath135 is bijective for every @xmath59 and @xmath71 .",
    "we conclude that @xmath17 is a locally bijective homomorphism from @xmath0 to @xmath1 .    in order to show",
    "that the pathwidth of @xmath0 is at most  @xmath2 , let us first consider the subgraph of @xmath0 depicted on the left - hand side of figure  [ fig : detail ] ; we denote this subgraph by @xmath136 , and we say that the cycle @xmath137 _ defines _ the subgraph @xmath136 .",
    "the graph @xmath138 that is obtained from @xmath136 by deleting vertices @xmath139 and edge @xmath140 is a caterpillar , i.e. , a tree in which there is a path containing all vertices of degree more than @xmath141 . since caterpillars are well - known to have pathwidth @xmath141 , graph @xmath138 has a path decomposition @xmath142 of width  @xmath141 .",
    "starting with @xmath142 , we can now obtain a path decomposition of the graph @xmath136 by simply adding vertices @xmath76 , @xmath77 , @xmath78 and @xmath143 to each node of @xmath142 ; this path decomposition has width  @xmath2 .",
    "every cycle @xmath69 in @xmath0 defines a subgraph @xmath144 of @xmath0 in the same way @xmath137 defines the subgraph @xmath136 .",
    "suppose we have constructed a path decomposition @xmath145 of width  @xmath2 of the subgraph @xmath144 for each @xmath59 in the way described above .",
    "since any two subgraphs @xmath144 and @xmath146 with @xmath147 have only the vertices @xmath139 in common , and these three vertices appear in all nodes of each of the path decompositions @xmath145 , we can arrange the @xmath55 path decompositions @xmath148 in such a way that we obtain a path decomposition @xmath149 of @xmath0 of width  @xmath2 .",
    "hence @xmath0 has pathwidth at most  @xmath2 .",
    "similar but easier arguments can be used to show that @xmath1 has pathwidth at most  @xmath5 .",
    "the np - hardness reduction for the locally bijective case can also be used to prove that lihom and lshom are np - hard for input pairs @xmath66 where @xmath0 has pathwidth at most  @xmath2 and @xmath1 has pathwidth at most",
    "this follows from the claim that @xmath19 if and only if @xmath21 if and only if @xmath20 for the gadget graphs @xmath0 and @xmath1 displayed in figure  [ fig : reduction_bijective ] .",
    "this claim can be seen as follows .",
    "first suppose that @xmath19 .",
    "then , by definition , @xmath21 and @xmath20 .",
    "now suppose that @xmath20 or @xmath21 .",
    "since it can easily be verified that @xmath150 we can use lemma  [ l - drm ] ( i ) or ( ii ) , respectively , to deduce that @xmath19 .",
    "however , we can strengthen the hardness results for the locally surjective and injective cases by reducing the pathwidth of the guest graph to be at most @xmath3 and  @xmath4 , respectively , and in the latter case we can simultaneously reduce the pathwidth of the host graph to be at most  @xmath4 , as claimed in statements ( ii ) and ( iii ) of theorem  [ t - np ] . in order to do so , we give the following alternative constructions below .     and @xmath151 that are constructed from a given instance @xmath67 of @xmath5-partition in the proof of statement ( ii ) in theorem  [ t - np ] . ]",
    "the alternative hardness construction for lshom is similar to but easier than the construction for lbhom ; see figure  [ fig : reduction_injective ] .",
    "let @xmath67 be an instance of @xmath5-partition .",
    "we construct a graph @xmath31 by taking @xmath55 disjoint cycles @xmath68 of length  @xmath57 , and labeling the vertices of each cycle @xmath69 with labels @xmath152 in the same way as we labeled the vertices of the cycles @xmath69 in the construction for lbhom ( see also figure  [ fig : detail ] ) .",
    "we then add two vertices @xmath76 and @xmath77 . for every @xmath59 ,",
    "we make @xmath76 adjacent to each of the vertices @xmath153 , and @xmath77 is made adjacent to each of the vertices @xmath154 .",
    "graph @xmath151 is obtained from the disjoint union of @xmath61 cycles @xmath155 of length @xmath57 by adding one universal vertex @xmath87 . using similar arguments as the ones used in the np - hardness proof of lbhom",
    ", it can be shown that there exists a locally surjective homomorphism @xmath17 from @xmath31 to @xmath151 if and only if @xmath67 is a yes - instance of @xmath5-partition .",
    "such a homomorphism @xmath32 maps @xmath76 and @xmath77 to @xmath87 , and maps the vertices of cycles @xmath68 to the vertices of cycles @xmath155 in exactly the same way as @xmath17 mapped these vertices in the np - hardness proof of lbhom .",
    "it is a routine exercise to show that @xmath31 has pathwidth at most  @xmath3 and that @xmath151 has pathwidth at most  @xmath5 .     and @xmath156 that are constructed from a given instance @xmath67 of @xmath5-partition in the proof of statement ( iii ) in theorem  [ t - np ] . ]",
    "the reduction for lihom is even easier ; see figure  [ fig : reduction_surjective ] .",
    "given an instance @xmath67 of @xmath5-partition , we create a graph @xmath157 by adding a universal vertex @xmath76 to the disjoint union of @xmath55 paths on @xmath100 vertices , respectively .",
    "graph @xmath156 is obtained from the disjoint union of @xmath61 paths on @xmath57 vertices by adding a universal vertex @xmath87 .",
    "it is easy to verify that there exists a locally injective homomorphism @xmath158 from @xmath157 to @xmath156 , mapping @xmath76 to @xmath87 and all other vertices of @xmath157 to the vertices of degree  @xmath4 or @xmath5 in @xmath156 , if and only if @xmath67 is a yes - instance of @xmath5-partition .",
    "the observation that both @xmath157 and @xmath156 have pathwidth  @xmath4 completes the proof of theorem  [ t - np ] .",
    "we now consider the case where we bound the maximum degree of @xmath0 instead of the treewidth of @xmath0 .",
    "we will combine some known results in order to show that bounding the maximum degree of @xmath0 does not yield tractability for any of our three problems lbhom , lihom and lshom .",
    "we first introduce some additional terminology .",
    "an _ equitable partition _ of a connected graph @xmath0 is a partition of its vertex set in blocks @xmath159 such that any vertex in @xmath160 has the same number @xmath161 of neighbors in @xmath162 .",
    "we call the matrix @xmath163 corresponding to the coarsest equitable partition of @xmath0 ( in which the blocks are ordered in some canonical way ; cf .",
    "@xcite ) the _ degree refinement matrix _ of @xmath0 , denoted as @xmath164 .",
    "we will use the following lemma ; a proof of the first statement in this lemma can be found in the paper of fiala and kratochvl  @xcite , whereas the second statement is due to kristiansen and telle  @xcite .",
    "[ l - drm ] let @xmath0 and @xmath1 be two graphs .",
    "then the following two statements hold :    * if @xmath20 and @xmath165 , then @xmath19 ; * if @xmath21 and @xmath165 , then @xmath19 .    kratochvl and kivnek",
    "@xcite showed that @xmath166-lbhom is np - complete , where @xmath166 denotes the complete graph on four vertices . since a graph @xmath0 allows a locally bijective homomorphism to @xmath166",
    "only if @xmath0 is @xmath5-regular , @xmath166-lbhom is np - complete on @xmath5-regular graphs .",
    "the degree refinement matrix of a @xmath5-regular graph is the @xmath167 matrix whose only entry is  @xmath5 .",
    "consequently , due to lemma  [ l - drm ] , @xmath166-lbhom is equivalent to @xmath166-lihom and to @xmath166-lshom on @xmath5-regular graphs .",
    "this yields the following result .",
    "[ t - degree ] the problems lbhom , lihom and lshom are np - complete on input pairs @xmath168 where @xmath0 has maximum degree  @xmath5 .",
    "theorem  [ t - degree ] is tight in the following sense .",
    "all three problems lbhom , lihom and lshom are polynomial - time solvable on input pairs @xmath66 where @xmath0 has maximum degree at most  @xmath4",
    ". moreover , the first two problems are also polynomial - time solvable on input graphs @xmath66 where only @xmath1 has maximum degree at most  @xmath4 .",
    "this does not hold for the lshom , as @xmath169-lshom is np - complete  @xcite .",
    "in section  [ s - npcom ] , we showed that lbhom , lihom and lshom are np - complete when either the treewidth or the maximum degree of the guest graph is bounded . in this section , we show that all three problems become polynomial - time solvable if we bound both the treewidth and the maximum degree of @xmath0 .",
    "for the problems lbhom and lihom , our polynomial - time result follows from reformulating these problems as constraint satisfaction problems and applying a result of dalmau et al .",
    "@xcite . in order to explain this , we need some additional terminology .",
    "a relational structure @xmath170 is a finite set @xmath54 , called the _ base set _ , together with a collection of relations @xmath171 .",
    "the arities of these relations determine the vocabulary of the structure .",
    "a homomorphism between two relational structures of the same vocabulary is a mapping between the base sets such that all the relations are preserved .",
    "fiala and kratochvl  @xcite observed that locally injective and locally bijective homomorphisms between graphs can be expressed as homomorphisms between relational structures as follows .",
    "a locally injective homomorphism @xmath172 can be expressed as a homomorphism between relational structures @xmath173 and @xmath174 , where the new binary relation @xmath175 consists of pairs of distinct vertices that have at least one common neighbor . since @xmath176 maps distinct neighbors of a vertex @xmath28 to distinct neighbors of @xmath177",
    ", we get that @xmath176 is a homomorphism of the associated relational structures . on the other hand ,",
    "if @xmath173 and @xmath174 are constructed from @xmath0 and @xmath1 as described above , and if @xmath176 is a homomorphism between them , then the relations @xmath178 and @xmath179 guarantee that no two vertices with a common neighbor in @xmath0 are mapped to the same target in @xmath1 . in other words , @xmath176 is a locally injective homomorphism between the graphs @xmath0 and @xmath1 . an analogous construction works for locally bijective homomorphisms . here , we need to express @xmath0 using two binary relations @xmath180 and @xmath178 as above , together with @xmath181 unary relations . a unary relation can be viewed as a set : here , the @xmath182-th set will consists of all vertices of degree  @xmath183 .",
    "these unary relations guarantee that degrees are preserved , and consequently that the associated graph homomorphisms are locally bijective .",
    "the _ gaifman graph _",
    "@xmath184 of a relational structure @xmath185 is the graph with vertex set @xmath54 , where any two distinct vertices @xmath14 and @xmath28 are joined by an edge if they are bound by some relation .",
    "formally @xmath186 if and only if for some relation @xmath187 of arity @xmath188 and @xmath189 it holds that @xmath190 .    as a direct consequence of a result of dalmau et al .",
    "@xcite , the existence of a homomorphism between two relational structures @xmath191 and @xmath192 can be decided in polynomial time if the treewidth of @xmath184 is bounded by a constant .",
    "this leads to theorem  [ thm : bounded ] below .",
    "[ thm : bounded ] the problems lbhom and lihom can be solved in polynomial time when @xmath0 has bounded treewidth and @xmath0 or @xmath1 has bounded maximum degree .",
    "first suppose that @xmath0 has bounded treewidth and bounded maximum degree .",
    "observe that for locally injective and locally bijective homomorphisms , the gaifman graph @xmath184 is isomorphic to @xmath193 , which is the graph arising from @xmath0 by adding an edge between any two vertices at distance  @xmath4 .",
    "it suffices to observe that @xmath194 , as we can transform any tree decomposition @xmath37 of @xmath0 of width @xmath45 into a desired tree decomposition of @xmath193 by adding to each node @xmath44 of @xmath37 all the neighbors of every vertex from @xmath44 .",
    "since @xmath195 implies that @xmath196 , the theorem also holds if we bound the maximum degree of @xmath1 instead of  @xmath0 .    to our knowledge ,",
    "locally surjective homomorphisms have not yet been expressed as homomorphisms between relational structures .",
    "hence , in the proof of theorem  [ t - bounded ] below , we present a polynomial - time algorithm for lshom when @xmath0 has bounded treewidth and bounded maximum degree .",
    "we first introduce some additional terminology .",
    "let @xmath17 be a locally surjective homomorphism from @xmath0 to @xmath1 .",
    "let @xmath39 and @xmath197 . if @xmath198 , i.e. , if @xmath17 maps vertex @xmath28 to color @xmath199 , then we say that @xmath199 is _ assigned _ to @xmath28 . by definition , for every vertex @xmath39",
    ", the set of colors that are assigned to the neighbors of @xmath28 in @xmath0 is exactly the neighborhood of @xmath200 in @xmath1 .",
    "now suppose we are given a homomorphism @xmath32 from an induced subgraph @xmath31 of @xmath0 to @xmath1 .",
    "for any vertex @xmath34 , we say that @xmath28 _ misses _ a color @xmath197 if @xmath201 , i.e. , if @xmath32 does not assign @xmath199 to any neighbor of @xmath28 in @xmath31 , but any locally surjective homomorphism @xmath17 from @xmath0 to @xmath1 that extends @xmath32 assigns @xmath199 to some neighbor of @xmath28 in  @xmath31 .",
    "let @xmath37 be a nice tree decomposition of @xmath0 rooted in @xmath46 .",
    "for every node @xmath40 , we define @xmath202 to be the subgraph of @xmath0 induced by the vertices of @xmath44 together with the vertices of all the nodes that are descendants of @xmath44 .",
    "in particular , we have @xmath203 .",
    "[ def : feasible ] let @xmath40 , and let @xmath204 and @xmath205 be two mappings .",
    "the pair @xmath206 is _ feasible _ for @xmath202 if there exists a homomorphism @xmath17 from @xmath202 to @xmath1 satisfying the following three conditions :    * @xmath207 for every @xmath41 ; * @xmath208 for every @xmath41 ; * @xmath209 for every @xmath210 .",
    "in other words , a pair @xmath206 consists of a coloring @xmath211 of the vertices of @xmath44 , together with a collection of sets @xmath212 , one for each @xmath41 , consisting of exactly those colors that @xmath28 misses . informally speaking",
    ", a pair @xmath206 is feasible for @xmath202 if there is a homomorphism @xmath213 such that @xmath17 `` agrees '' with the coloring @xmath211 on the set @xmath44 , and such that none of the vertices in @xmath214 misses any color .",
    "the idea is that if a pair @xmath206 is feasible , then such a homomorphism @xmath17 might have an extension @xmath215 that is a locally surjective homomorphism from @xmath0 to @xmath1 .",
    "after all , for any vertex @xmath41 that misses a color when considering @xmath17 , this color might be assigned by @xmath215 to a neighbor of @xmath28 in the set @xmath216 .",
    "we now prove a result for lshom similar to theorem  [ thm : bounded ] .",
    "[ t - bounded ] the problem lshom can be solved in polynomial time when @xmath0 has bounded treewidth and @xmath0 or @xmath1 has bounded maximum degree .",
    "let @xmath66 be an instance of lshom such that the treewidth of the guest graph @xmath0 is bounded . throughout the proof",
    ", we assume that the maximum degree of @xmath1 is bounded , and show that the problem can be solved in polynomial time under these restrictions . since @xmath217 implies that @xmath218 , our polynomial - time result applies also if we bound the maximum degree of @xmath0 instead of  @xmath1 .",
    "we may assume without loss of generality that both @xmath0 and @xmath1 are connected , as otherwise we just consider all pairs @xmath219 separately , where @xmath220 is a connected component of @xmath0 and @xmath221 is a connected component of @xmath1 . because @xmath0 has bounded treewidth , we can compute a tree decomposition of @xmath0 of width @xmath45 in linear time using bodlaender s algorithm  @xcite .",
    "we transform this tree decomposition into a nice tree decomposition @xmath37 of @xmath0 with width @xmath45 with at most @xmath222 nodes using the linear - time algorithm of kloks  @xcite .",
    "let @xmath46 be the root of @xmath37 and let @xmath223 .    for each node @xmath40 ,",
    "let @xmath224 be the set of all feasible pairs @xmath206 for @xmath202 .",
    "for every feasible pair @xmath225 and every @xmath41 , it holds that @xmath212 is a subset of @xmath226 . since @xmath227 and @xmath228 for every @xmath41 and every mapping @xmath204",
    ", this implies that @xmath229 for each @xmath40 .",
    "as we assumed that both @xmath13 and @xmath230 are bounded by a constant , the set @xmath224 is of polynomial size with respect to @xmath231 .",
    "the algorithm considers the nodes of @xmath37 in a bottom - up manner , starting with the leaves of @xmath37 and processing a node @xmath40 only after its children have been processed . for every node @xmath44",
    ", the algorithm computes the set @xmath224 in the way described below .",
    "we distinguish between four different cases .",
    "the correctness of each of the cases easily follows from the definition of a locally surjective homomorphism and definition  [ def : feasible ] .    1 .   _",
    "@xmath44 is a leaf node of @xmath37 .",
    "_ we consider all mappings @xmath204 .",
    "for each mapping @xmath211 , we check whether @xmath211 is a homomorphism from @xmath202 to @xmath1 . if not , then we discard @xmath211 , as it can not belong to a feasible pair due to condition ( i ) in definition  [ def : feasible ] . for each mapping",
    "@xmath211 that is not discarded , we compute the unique mapping @xmath232 satisfying @xmath233 for each @xmath41 , and we add the pair @xmath206 to @xmath224 .",
    "it follows from condition ( ii ) that the obtained set @xmath224 indeed contains all feasible pairs for @xmath202 .",
    "as there is no vertex in @xmath214 , every pair @xmath206 trivially satisfies condition ( iii ) .",
    "the computation of @xmath224 can be done in @xmath234 time in this case .",
    "@xmath44 is a forget node .",
    "_ let @xmath47 be the child of @xmath44 in @xmath37 , and let @xmath235 .",
    "observe that @xmath225 if and only if there exists a feasible pair @xmath236 such that @xmath237 and @xmath238 for every @xmath41 , and @xmath239 .",
    "hence we examine each @xmath236 and check whether @xmath239 is satisfied .",
    "if so , we first restrict @xmath240 on @xmath44 to get @xmath206 and then we insert the obtained feasible pair into @xmath224 .",
    "this procedure needs @xmath241 time in total .",
    "@xmath44 is an introduce node .",
    "let @xmath47 be the child of @xmath44 in @xmath37 , and let @xmath242 .",
    "observe that @xmath225 if and only if there exists a feasible pair @xmath236 such that , for every @xmath51 , it holds that @xmath237 , @xmath243 if @xmath10 , and @xmath238 if @xmath244 . hence , for each @xmath236 , we consider all @xmath231 mappings @xmath204 that extend @xmath245 . for each such extension @xmath211 , we test whether @xmath211 is a homomorphism from @xmath202 to @xmath1 by checking the adjacencies of @xmath246 in @xmath1 . if not , then we may safely discard @xmath211 due to condition ( i ) in definition  [ def : feasible ] .",
    "otherwise , we compute the unique mapping @xmath205 satisfying @xmath247 and we add the pair @xmath206 to @xmath224 ; due to condition ( ii ) , this pair @xmath206 is the unique feasible pair containing @xmath211 .",
    "computing the set @xmath224 takes at most @xmath248 time in total .",
    "@xmath44 is a join node .",
    "_ let @xmath47 and @xmath249 be the two children of @xmath44 in @xmath37 .",
    "observe that @xmath225 if and only if there exist feasible pairs @xmath250 and @xmath251 such that , for every @xmath41 , @xmath252 and @xmath253 .",
    "hence the algorithm considers every combination of @xmath250 with @xmath251 and if they agree on the first component @xmath211 , the other component @xmath232 is determined uniquely by taking the intersection of @xmath254 and @xmath255 for every @xmath41 .",
    "this procedure computes the set @xmath224 in @xmath256 time in total .",
    "finally , observe that a locally surjective homomorphism from @xmath0 to @xmath1 exists if and only if there exists a feasible pair @xmath206 for @xmath257 such that @xmath258 for all @xmath259 .",
    "since @xmath37 has at most @xmath222 nodes , we obtain a total running time of @xmath260 . as we assumed that both @xmath223 and @xmath230 are bounded by a constant",
    ", our algorithm runs in polynomial time .",
    "note that theorem  [ thm : bounded ] can be derived by solving lihom using a dynamic programming approach that strongly resembles the one for lshom described in the proof of theorem  [ t - bounded ] , together with the fact that @xmath66 is a yes - instance of lbhom if and only if it is a yes - instance for both lihom and lshom . in a dynamic programming algorithm for solving lihom , instead of keeping track of sets @xmath212 of colors that a vertex @xmath41 is missing , we keep track of sets @xmath261 of colors that have already been assigned to the neighbors of a vertex @xmath41 . this is because in a locally injective homomorphism from @xmath0 to @xmath1 , no color may be assigned to more than one neighbor of any vertex . in this way",
    "we can adjust definition  [ def : feasible ] in such a way that it works for locally injective instead of locally surjective homomorphisms .",
    "we omit further details , but we expect that a dynamic programming algorithm of this kind will have smaller hidden constants in the running time estimate than the more general method of dalmau et al .",
    "@xcite .",
    "we conclude this section with one more polynomial - time result .",
    "it is known that the problems lbhom and lshom are polynomial - time solvable when @xmath0 is a tree  @xcite , and consequently when @xmath0 has treewidth  @xmath141 .",
    "we claim that the same holds for the lihom problem .",
    "[ t - polytree ] the lihom problem can be solved in polynomial time when @xmath0 has treewidth  @xmath141 .",
    "let us first state some terminology and useful known results .",
    "the universal cover @xmath262 of a connected graph @xmath0 is the unique tree ( which may have an infinite number of vertices ) such that there is a locally bijective homomorphism from @xmath262 to @xmath0 .",
    "one way to define this mapping is as follows .",
    "consider all finite walks in @xmath0 that start from an arbitrary fixed vertex in @xmath0 and that do not traverse the same edge in two consecutive steps .",
    "each such walk will correspond to a vertex of @xmath262 .",
    "we let two vertices of @xmath262 be adjacent if and only if one can be obtained from the other by deleting the last vertex of the walk .",
    "then the mapping @xmath263 that maps every walk to its last vertex is a locally bijective homomorphism from @xmath262 to @xmath0  @xcite . it is also known that @xmath264 if and only if @xmath0 is a tree  @xcite . moreover , for any two graphs @xmath0 and @xmath1 , @xmath20 implies that @xmath265  @xcite .",
    "now let @xmath66 be an instance of lihom where @xmath0 has treewidth  @xmath141 .",
    "we assume , without loss of generality , that both @xmath0 and @xmath1 are connected .",
    "in particular , @xmath0 is a tree .",
    "we claim that @xmath20 if and only if @xmath265 . the forward implication follows from above . to show the backward implication , suppose that @xmath265 .",
    "then @xmath266 , because @xmath264 .",
    "let @xmath176 be a locally injective homomorphism from @xmath0 to @xmath267 . then , because @xmath266 and @xmath268 , we have @xmath20 .",
    "to explain this , consider the mapping @xmath269 defined by @xmath270 if and only if @xmath271 .",
    "notice that @xmath272 is a locally injective homomorphism from @xmath0 to @xmath1 .",
    "the desired result follows from this claim combined with the fact that we can check in polynomial time whether @xmath265 holds for two graphs @xmath0 and @xmath1  @xcite .",
    "theorem  [ t - polytree ] states that lihom can be solved in polynomial time when the guest graph has treewidth  1 , while theorem  [ t - np ] implies that the problem is np - complete when the guest graph has treewidth  2 .",
    "this shows that the bound on the pathwidth in the third statement of theorem  [ t - np ] is best possible .",
    "we leave it as an open problem to determine whether the bounds on the pathwidth in the other two statements of theorem  [ t - np ] can be reduced further .",
    "we conclude this paper with some remarks on the parameterized complexity of the problems lihom , lshom and lbhom .",
    "the hardness results in this paper show that all three problems are para - np - complete when parameterized by either the treewidth of @xmath0 or the maximum degree of @xmath0 .",
    "theorems  [ thm : bounded ] and  [ t - bounded ] show that the problems are in xp when parameterized jointly by the treewidth of @xmath0 and the maximum degree of @xmath0 .",
    "a natural question is whether the problems are fpt when parameterized by the treewidth of @xmath0 and the maximum degree of @xmath0 , i.e. , whether they can be solved in time @xmath273 for some function  @xmath176 that does not depend on the sizes of @xmath0 and @xmath1 .",
    "we would like to thank isolde adler for posing the research questions that we addressed in our paper and for helpful discussions .",
    "the fourth author also thanks jan arne telle for fruitful discussions ."
  ],
  "abstract_text": [
    "<S> a homomorphism from a graph @xmath0 to a graph @xmath1 is locally bijective , surjective , or injective if its restriction to the neighborhood of every vertex of @xmath0 is bijective , surjective , or injective , respectively . </S>",
    "<S> we prove that the problems of testing whether a given graph @xmath0 allows a homomorphism to a given graph @xmath1 that is locally bijective , surjective , or injective , respectively , are np - complete , even when @xmath0 has pathwidth at most @xmath2 , @xmath3 , or @xmath4 , respectively , or when both @xmath0 and @xmath1 have maximum degree  @xmath5 . </S>",
    "<S> we complement these hardness results by showing that the three problems are polynomial - time solvable if @xmath0 has bounded treewidth and in addition @xmath0 or @xmath1 has bounded maximum degree .    computational complexity ; locally constrained graph homomorphisms ; bounded treewidth ; bounded degree </S>"
  ]
}