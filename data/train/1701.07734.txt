{
  "article_text": [
    "a better understanding of turbulent unsteady flows is a necessary step towards a breakthrough in the design of modern aircraft and propulsive systems . due to the difficulty of predicting turbulence with complex geometry , the flow that develops in these engines remains difficult to predict . at this time",
    ", the most popular method to model the effect of turbulence is still the reynolds averaged navier - stokes ( rans ) approach .",
    "however there is some evidence that this formalism is not accurate enough , especially when a description of time - dependent turbulent flows is desired ( high incidence angle , laminar - to - turbulent transition , etc . )  @xcite . with the increase in computing power , large eddy simulation ( les ) applied to the navier - stokes equations",
    "emerges as a promising technique to improve both knowledge of complex physics and reliability of flow solver predictions  @xcite .",
    "it is still the most popular and mature approach to describe the behavior of turbulent flow in complex geometries ( _ e.g. _ aircraft and gas turbines ) .",
    "however , the resolution of the ns equations requires to add artificial dissipation to ensure numerical stability  @xcite .",
    "the consequence is an over - dissipation which affects the flow and limits the capability to transport flow patterns ( like turbulence ) on a long distance . in some specific cases , like aero - acoustic ( far - field noise )",
    ", ns can thus face some difficulties to predict the flow .    in this context",
    ", there is an increasing interest in the fluid dynamics community for emerging methods , based on the lattice boltzmann approach  @xcite .",
    "the lattice - boltzmann method ( lbm ) has already demonstrated its potential for complex geometries , thanks to immersed boundary conditions ( that allow the use of cartesian grids ) and low dissipation properties required for capturing the small acoustic pressure fluctuations @xcite .",
    "lbm also provides the advantage of an easy parallelization , making it well suited for high - performance computing @xcite .",
    "however , the most widely used lattice - boltzmann models still suffer from weaknesses like a lack of robustness for high mach number flows ( @xmath1 ) , a limitation to low compressible isothermal flows @xcite and the use of artificial boundary conditions ( dirichlet / neumann types can lead to the reflection of outgoing acoustic waves that have a significant influence on the flow field @xcite ) . while the use of artificial boundary conditions is also critical for ns methods ,",
    "it is more problematic for lbm due to the low dissipation of the method .",
    "a potential way to avoid unphysical acoustic reflections at the boundary is to use a `` sponge layer '' inside the computational domain , on which artificial dissipation ( by upwinding ) is introduced or physical viscosity is increased ( viscosity sponge zones ) .",
    "acoustic waves ( physical or not ) are thus damped in such a zone , which allows to eliminate or limit numerical reflections  @xcite .",
    "this solution has however important drawbacks .",
    "first the calibration of sponge layers is difficult , as a balance must be found between a brutal increase of the viscosity ( that will generate acoustic reflections ) and a too low dissipation that will not be effective .",
    "such sponge layers also have an impact on the computational cost , since a part of the domain is dedicated to slowly increasing the viscosity .",
    "last , some boundary conditions can not be treated with a sponge layer , for instance an inlet with turbulence injection .    for ns methods ,",
    "a successful approach is the use of non - reflective boundary conditions based on a treatment of the characteristic waves of the local flow @xcite .",
    "however , the extension of this approach to lbm is not straightforward given the difficulty to find a bridge between the lbm that describes the world at the mesoscopic level ( a population of particles ) and the ns world based on a macroscopic description of the flow .",
    "but some progress has recently been made on the adaptation of characteristic boundary conditions to the lbm formalism .",
    "izquierdo and fueyo  @xcite used a pressure antibounceback boundary condition  @xcite adapted to the multiple relaxation time ( mrt ) collision scheme  @xcite to impose the dirichlet density and velocity conditions given by the local one - dimensional inviscid ( lodi ) equations , which provided non - reflective outflow boundary conditions for one - dimensional waves .",
    "more recently , jung _",
    "et al . _",
    "@xcite extended the previous work to include the effects of transverse and viscous terms in the characteristic boundary conditions ( cbc ) and showed good performance for vortex outflow .",
    "meanwhile , heubes _",
    "et al . _",
    "@xcite adapted the solution given by a modified - thompson approach by imposing the corresponding equilibrium populations and schlaffer  @xcite assessed a modified zou / he boundary condition  @xcite .    still",
    ", previous researches are limited to low reynolds number applications while latt _",
    "_ showed that increasing the reynolds number can have drastic impact on the numerical stability of the lbm boundary condition  @xcite .",
    "even when the mrt collision is used , as in @xcite , the numerical stability of the characteristic boundary conditions has not been demonstrated .",
    "the aim of this study is thus to develop a numerically stable adaptation of the cbc to the lbm formalism taking advantage of the regularized collision scheme  @xcite , which has proved to be numerically stable at high reynolds number flows  @xcite , and the corresponding regularized boundary conditions  @xcite .",
    "different kinds of cbc will also be evaluated .",
    "this article is structured as follows .",
    "the first section describes the lbm framework .",
    "then , the second section presents three kinds of cbcs and three possible adaptations to the lbm formalism for 2d problems in the low compressible isothermal case . in the third section ,",
    "these models are assessed for simple cases : normal , oblique and spherical waves and a convected vortex at @xmath2 .",
    "finally , the method is assessed on a high reynolds number application : a naca0015 airfoil at @xmath3 .",
    "a description of the lattice - boltzmann method can be found in @xcite .",
    "the governing equations describe the evolution of the probability density of finding a set of particles with a given microscopic velocity at a given location :    @xmath4    for @xmath5 , where @xmath6 is a discrete set of @xmath7 velocities , @xmath8 is the discrete single particle distribution function corresponding to @xmath6 and @xmath9 is an operator representing the internal collisions of pairs of particles .",
    "macroscopic values such as density , @xmath10 , and the flow velocity , @xmath11 , can be deduced from the set of probability density functions @xmath8 , such as : @xmath12    some of the most popular choices for the set of velocities are d2q9 and d3q27 lattices , respectively 9 velocities in 2d and 27 velocities in 3d ( see fig .  [",
    "fig : d2q9d3q27 ] ) . for both of these lattices , the sound speed in lattice units ( normalized by the ratio between the spatial resolution and the time step @xmath13 )",
    "is given by @xmath14 @xcite .",
    ", scaledwidth=49.0% ]    the collision operator @xmath9 is usually modelled with the bhatnagar - gross - krook ( bgk ) approximation @xcite , which consists in a relaxation , with a relaxation time @xmath15 , of every population to the corresponding equilibrium probability density function @xmath16 : @xmath17.\\ ] ]    the equilibrium distribution function @xmath16 is a local function that only depends on density and velocity in the isothermal case .",
    "it can be computed thanks to a second order development of the maxwell - boltzmann equilibrium function @xcite : @xmath18,\\ ] ] where @xmath19 are the gaussian weights of the lattice .",
    "a chapman - enskog expansion , based on the assumption that @xmath20 is given by the sum of the equilibrium distribution plus a small perturbation @xmath21 @xmath22 can be applied to ( [ lbm equation ] ) in order to recover the exact navier - stokes equation for quasi - incompressible flows in the limit of long - wavelength @xcite . the pressure is thus given by @xmath23 and the kinematic viscosity is linked to the bgk relaxation parameter through @xmath24 the chapman ",
    "enskog expansion also relates the second order tensor @xmath25 defined as @xmath26 with the strain rate tensor @xmath27 through the relation @xmath28 in turn to the leading order @xmath29 can be approximated by @xmath30 where @xmath31 .",
    "the colon symbol stands for the double contraction operator and @xmath32 is the identity matrix .",
    "a regularization step consisting in the reconstruction of the off - equilibrium parts using ( [ eq_f1_pi1 ] ) and ( [ eq_pi1_f1 ] ) can improve the precision and the numerical stability of the single relaxation time bgk collision  @xcite .",
    "this model will be used in the next parts for high reynolds number flow simulations .",
    "the lbm flow solver used in this work is the palabos open - source library .",
    "the palabos library is a framework for general - purpose cfd with a kernel based on the lattice boltzmann method .",
    "the use of c++ code makes it easy to install and to run on every machine .",
    "it is thus possible to set up fluid flow simulations with relative ease and to extend the open - source library with new methods and models , which is of paramount importance for the implementation of new boundary conditions .",
    "the numerical scheme is divided in two steps :    * a collision step where the bgk model is applied : @xmath33,\\\\ ] ] with @xmath16 computed using the macroscopic values at time @xmath34 and @xmath20 can be regularized in order to increase numerical stability for high reynolds number flows . *",
    "a streaming step : @xmath35    the streaming step consists in an advection of each discrete population to the neighbor node located in the direction of the corresponding discrete velocity .",
    "since a boundary node has less neighbors than an internal node ( less than 9 neighbors in 2d or 27 neighbors in 3d ) , some populations are missing at the boundary after each iteration .",
    "these populations need to be reconstructed , which is the purpose of the implementation of boundary conditions in lbm . up to now",
    ", different methods can be used in palabos , such as regularized bc @xcite or zou / he bc @xcite to implement open boundaries . however , none of them can be used as they stand for an outflow boundary condition and the use of sponge zones is necessary to avoid non physical reflections .",
    "the next sections will aim at developing a more natural boundary condition that minimize acoustic reflections for an outflow boundary type , based on the characteristic boundary conditions ( cbc ) .",
    "one of the most popular methods in the ns community for subsonic non reflective outflow boundary conditions is the cbc method @xcite .",
    "the adaptation of the cbc to the lbm formalism is presented here for an isothermal flow , in lattice units ( normalized by @xmath36 and @xmath37 ) .",
    "acoustic waves thus propagate at the constant lattice sound speed @xmath38 . in the isothermal case ,",
    "pressure is defined as @xmath23 .",
    "three cbc methods will be introduced below : the local one - dimensional inviscid ( lodi ) approximation , a 2d extension of the lodi approximation including transverse waves and a last method called local - streamline lodi .",
    "let us consider a domain outlet located at @xmath39 , as descripted on fig .",
    "[ fig : cbc ] . a diagonalisation of the x - derivative terms in the navier - stokes equation allows to define five waves @xmath40 that propagate respectively at velocity @xmath41 , @xmath42 , @xmath42 , @xmath42 and @xmath43 , where @xmath42 is the x - component ( streamwise ) of the non - dimensional macroscopic velocity @xmath44 $ ] .",
    "these waves are represented on fig .",
    "[ fig : cbc ] on the inlet ( @xmath45 ) and outlet ( @xmath39 ) of a computational domain .    ) and an outlet plane ( @xmath39 ) for a subsonic flow @xcite in lattice units.[fig : cbc],scaledwidth=49.0% ]    at the outlet ( @xmath39 on fig .",
    "[ fig : cbc ] ) , @xmath46 , @xmath47 , @xmath48 and @xmath49 leave the computational domain and are obtained with the general expression of characteristic waves : @xmath50 @xmath51 @xmath52 @xmath53 let us notice that @xmath46 , the entropy wave , is null in the isothermal case.the @xmath54-derivative terms can be computed using the interior points by one - sided finite difference .",
    "the treatment of @xmath55 is different : since it comes from the outside , it can not be computed using the interior points .",
    "the perfectly non - reflecting case is obtained by fixing @xmath56 , which ensures eliminating the incoming wave . however ,",
    "this is known to be unstable because of lack of control of the outlet flow variables .",
    "a simple way to ensure well - posedness is to set @xmath57 where @xmath58 , @xmath59 is the target pressure at the outlet , @xmath60 is a constant , @xmath61 is the maximum mach number in the flow and @xmath62 is a characteristic size of the domain  @xcite .",
    "the time - derivative of the primitive variables can be computed in function of the wave amplitudes by examining a lodi problem : @xmath63=0,\\ ] ] @xmath64 @xmath65 @xmath66 @xmath67 in the isothermal case , ( [ lodirho ] ) and ( [ lodip ] ) are equivalent . finally , with a temporal discretization using an explicit second - order scheme , the physical values that must be imposed at the next time step in order to avoid acoustic reflections can be computed .",
    "this implementation will be referred to as the baseline lodi ( bl - lodi ) in the rest of the paper .",
    "the previous relations are perfectly non - reflecting for the only case of a pure 1d plane wave . for a non - normal wave ,",
    "the lodi approximation is not verified and a reflected wave , all the more important as the incidence increases , can appear . to take this phenomenon into account ,",
    "a possible solution is to add the influence of transverse waves in the lodi equations  @xcite : @xmath68 @xmath69 @xmath70 @xmath71 the transverse waves can be computed as follows : @xmath72,\\ ] ] @xmath73,\\ ] ] @xmath74,\\ ] ] @xmath75,\\ ] ] where @xmath76 $ ] and @xmath77 $ ] .",
    "the second transverse wave @xmath78 is not introduced here since it is null in the isothermal case , as well as @xmath46 .",
    "the non reflective outflow boundary condition needs now to be set as : @xmath79 with @xmath58 , @xmath80 should be equal to the mach number of the mean flow and @xmath81 is a desired steady value of @xmath82  @xcite . in the rest of the paper , this method will be named 2d - cbc in the perfectly non - reflecting case ( @xmath83 ) and 2d - cbc relaxed when a relaxation is done on @xmath55 .",
    "\\(a ) geometry - based frame @xmath84 + ( 30,0 ) .",
    "b ) local streamline based frame @xmath85.[fig : rtilde],title=\"fig:\",scaledwidth=29.5% ] + ( b ) local streamline - based frame @xmath86 + ( 30,0 ) .",
    "b ) local streamline based frame @xmath85.[fig : rtilde],title=\"fig:\",scaledwidth=27.0% ] +    another potential solution is to compute the lodi equation in the local streamline based frame @xmath86 ( fig .",
    "[ fig : rtilde ] )  @xcite . in order to compute the new characteristic waves",
    "@xmath87 , the non - dimensional velocity vector is projected into the new reference frame with the difficulty to compute @xmath88-derivative terms from the lattice discretization .",
    "a simple approximation is to set @xmath89 and thus to compute it by a first - order upwind scheme using the lattice discretization .",
    "this implementation of the cbc condition will be referred to as the local streamline lodi ( ls - lodi ) .",
    "the main difficulty in lbm is then to find a set of populations in order to impose the physical values obtained by the cbc theory and the correct associated gradients .",
    "the possible adaptations can be divided in two families : those preserving the known particle populations ( e.g. zou / he bc  @xcite ) and those replacing all particle populations ( e.g. regularized bc  @xcite ) .",
    "izquierdo and fueyo  @xcite and jung _ et al . _",
    "@xcite chose to modify the missing populations by adapting a pressure anti - bounceback boundary condition , which can be used as far as the mrt collision scheme is adopted  @xcite .",
    "et al . _",
    "@xcite decided to impose the cbc physical values thanks to the equilibrium populations , which is known to impose incorrect gradients at the boundary  @xcite .",
    "three possibilities are introduced below and will be further evaluated : a modified zou / he method and two declinations of the more stable regularized adaptation .    , @xmath90 and @xmath91 are missing.[fig : zouhe],scaledwidth=30.0% ]      let us consider an outflow boundary located at @xmath39 on a d2q9 lattice ( fig .",
    "[ fig : zouhe ] ) . after streaming ,",
    "three incoming populations are missing : @xmath92 , @xmath90 and @xmath91 .",
    "the zeroth and first - order hydrodynamic moments are : @xmath93 @xmath94 where @xmath95 and @xmath96 .",
    "these equations can be combined , by eliminating the missing populations ( @xmath97 ) , to obtain @xmath98 where @xmath10 and @xmath42 are still non - dimensional .",
    "thus , @xmath10 and @xmath42 are linked with relation ( [ relationrhou ] ) , which proves that it is impossible to impose both @xmath99 and @xmath100 at the boundary without modifying any of the known populations.the same relation can be obtained for every 1d , 2d or 3d lattice as far as there is only one level of velocity .",
    "this relation concerns every boundary condition of the first family ( those preserving the knwon populations ) and will be used later .",
    "let us note @xmath101 the corrected populations at the boundary .",
    "as proposed in  @xcite , the missing populations can be computed as follows : @xmath102 @xmath103 @xmath104    while every other populations are kept unchanged : @xmath105    with @xmath106 and where the equilibrium populations are computed with the physical values imposed at the boundary , @xmath99 and @xmath107 .",
    "as shown in  @xcite , corrections ( [ g1 ] ) , ( [ g2 ] ) and ( [ g3 ] ) then allow to impose the first - order moment at the boundary @xmath108 .",
    "however , density and velocity are still linked with ( [ relationrhou ] ) .",
    "this is not a problem for a dirichlet zou / he boundary condition where only one physical value ( either @xmath10 or @xmath11 ) is imposed and the other one is computed with ( [ relationrhou ] ) . on the contrary , for a non reflective outflow , both of them need to be imposed as the result given by the cbc method , so that the only condition set by the user is the value of a characteristic wave .",
    "it is then necessary to modify at least one known population .",
    "schlaffer suggests correcting every populations in order to impose the correct density  @xcite .",
    "the solution proposed here is to add a correction on the population associated to a null velocity only : @xmath109 which ensures the value of @xmath99 .",
    "this choice is motivated by the fact that this added correction will only affect the collision phase and will not be streamed into the computational domain .    to sum up this method , @xmath110 , @xmath111 , @xmath112 and @xmath113",
    "are computed with respectively ( [ g1 ] ) , ( [ g2 ] ) , ( [ g3 ] ) and ( [ g0 ] ) while other populations are kept unchanged after streaming : @xmath114    this method can be easily transposed on every 3d lattice ( except for high order lattices",
    "@xcite ) by using the general formula of the zou / he boundary conditions that can be found in  @xcite for the missing populations , and correction ( [ g0 ] ) to ensure the value of @xmath99 and consequently @xmath100 .",
    "the zou / he boundary condition provides the advantage of a very good precision in the definition of the boundary physical values .",
    "unfortunately , this solution suffers from lack of stability for large reynolds numbers .",
    "for example , it has been shown that zou / he boundary conditions become unstable at @xmath115 for a given resolution @xmath116 nodes per characteristic length in a 2d channel flow  @xcite .",
    "another possible adaptation is to use the regularized boundary condition in order to impose the physical values computed by the cbc theory .",
    "this solution is yet less accurate but well more stable , as shown by latt _",
    "_ @xcite .",
    "more details about the regularized method for boundary conditions can be found for example in @xcite .",
    "the purpose of this section is to explain how this particular boundary condition is used to impose @xmath99 and @xmath117 on a flat boundary .",
    "the leading order of the populations @xmath20 can be expressed ( see end of  ( [ eq_fi_ce ] ) and  ( [ eq_f1_pi1 ] ) ) as @xmath118 on a boundary node the density @xmath99 and velocity @xmath117 are imposed . therefore in order to be able to use this last equation one needs a way to compute @xmath25 .",
    "this is achieved by using the fact that @xmath119 is a symmetric tensor with respect to @xmath120 which means that @xmath121 , where @xmath122 at the leading order , this property leads to @xmath123 the known @xmath29 can be straightforwardly computed by the following formula @xmath124 with the last two equations , the set of @xmath29 is complete ( they are all known ) and can be used to compute @xmath25 through  ( [ eq_pi1_f1 ] ) . then using  ( [ eq_f1_pi1 ] ) one",
    "recomputes regularized @xmath29 populations and the total populations @xmath20 are computed with the relation  ( [ eq_f1_bc ] ) .",
    "this method is valid in both 2d and 3d and will be called regularized bounceback ( or regularized bb ) adaptation in the next sections .",
    "another possibility is to compute @xmath25 by a second order finite difference scheme thanks to ( [ pi1_grad ] ) and recompute @xmath125 using ( [ eq_f1_pi1 ] ) .",
    "this method will be called the regularized fd adaptation .",
    "the non reflecting outflow boundary condition using cbc theory for lbm can be summarized as follows , considering everything is known at ( non - dimensional ) time @xmath34 :    1 .",
    "computation of the physical values that must be imposed at @xmath126 to avoid non physical reflections by the cbc theory using either bl - lodi , cbc-2d or ls - lodi method .",
    "these values are stored to be used in the last step .",
    "2 .   collision step .",
    "streaming step : some populations are missing at the boundary . 4 .   correction of the set of populations at the boundary so that the physical values stored in the first step are imposed by using the zou / he adaptation the so - called regularized bounceback adaptation or the regularized fd adapatation .",
    "in this section , the cbc approach for lbm is assessed on simple 2d cases : a normal plane wave , a plane wave with different incidence angles , a spherical density wave and a convected vortex .",
    "the computational domain , a square of @xmath127 cells , is initiated with a gaussian plane wave as follows ( in lattice units ) @xmath128 @xmath129 @xmath130 with @xmath131 and @xmath132 in lattice units ( _ i.e. _ in number of cells ) .",
    "the reynolds number , computed with the horizontal non - dimensional initial velocity @xmath133 , the characteristic size of the box in number of voxels and the viscosity in lattice units , is equal to @xmath134 .",
    "the boundary conditions are : vertical periodicity , reflecting inlet on the left and perfectly non reflecting outflow on the right . for this pure 1d case",
    ", the choice of the cbc condition ( baseline , local streamline lodi or lodi with transverse terms ) has no effect on the absorption rate .",
    "moreover , all the three adaptations provide the same results at @xmath135 and no stability issues have been encountered with the zou / he adaptation for this test case .",
    "thus , the results presented below have been obtained with baseline lodi and zou / he adaptation .",
    "this test case has been chosen so that the reflection rate for every macroscopic value ( @xmath10 , @xmath42 and @xmath136 ) can be computed , since two pressure and axial velocity waves propagates at speed @xmath137 and @xmath138 and one transverse velocity wave propagates at speed @xmath42 .",
    "the computed density waves are represented on fig .",
    "[ fig : rho4_8bis ] at two different time steps : before reflection of the @xmath138 wave on the non - reflective outlet and shortly after reflection .     wave on the right boundary ( non - reflecting outflow).[fig : rho4_8bis ] ]    a very low reflected amplitude can be distinguished .",
    "the @xmath137 wave propagates to the left of the domain without encountering any boundary at the two observed time steps .",
    "it is only affected by viscous dissipation and is used as a reference amplitude in the computation of the reflection rates of density and axial velocity . for",
    "the transverse velocity wave , one can compute the reflection rate as the ratio between the reflected wave amplitude and the amplitude shortly before reflection .",
    "the obtained results are presented on table  [ table : reflectionrate_planewave ] .",
    ".reflection rates for the 2d normal plane wave .",
    "[ table : reflectionrate_planewave ] [ cols=\"^,^,^,^\",options=\"header \" , ]     as often with cbc , the treatment is more difficult for the pressure wave , but the results obtained here are in good agreement compared to what is found in the literature @xcite .",
    "it is noticed that @xmath139 is not correctly recovered at the outlet after reflection , as the boundary has been set as perfectly non - reflecting ( @xmath56 ) . in order to impose the correct boundary condition , a relaxation",
    "should be implemented , as in eq ( [ l1 ] ) . however , in that case , the reflection rate will increase as shown in  @xcite .      at @xmath140 ,",
    "the computational domain is at rest ( @xmath141 , @xmath142 ) except for an oblique line on which the density is set to @xmath143 in order to generate a plane wave with an incidence @xmath144 .",
    "the reflection coefficient is measured by computing the ratio of maximal amplitudes in density waves only , as this is the most critical hydrodynamic variable .",
    "the three implementations are tested for this case : bl - lodi , ls - lodi and cbc-2d in the perfectly non - reflecting case .",
    "again , the results obtained with the zou / he adaptation only will be presented here , as the same results at @xmath135 have been obtained with the regularized bb and regularized df adaptations .",
    "obliquewaveproblem ( 49,68)@xmath144 ( 53,56)@xmath61 ( 63,65)@xmath38 ( 65,35)@xmath145 ( 90,75 ) ( 5,20 ) ( 40,88)periodicity ( 40,5)periodicity    because of a spurious phenomenon appearing at high incidence angles , only angles below @xmath146could be computed . indeed",
    ", contrary to the previous normal wave test case , the incident wave can not be infinite in its transverse direction .",
    "then , spherical waves appear at each extremity of the oblique line initializing the wave , as shown on fig .  [",
    "fig : obliquewaveproblem ] .",
    "let us imagine a point @xmath61 located at a distance @xmath145 of one extremity and moving with the oblique plane wave at velocity @xmath38 .",
    "the spherical wave reaches @xmath61 after a time @xmath147 . the point @xmath61 reaches the non - reflective outlet boundary condition at a time @xmath148 .",
    "the condition for this point of the wave to reach the outlet before being distorted is : @xmath149 which means than only incidence angles below @xmath150 can be computed with such a test case .",
    "this problem is avoided in  @xcite by imposing an exact solution obtained on a larger computational domain until the desired wave reaches the boundary .",
    "the exact solution is then switched to the cbc condition . it has not been tested in this paper in order to avoid the eventual acoustic waves generated by a brutal change in the boundary condition .    the reflection coefficient of the density wave with respect to the incidence angle is represented on fig .",
    "[ fig : reflexion_incidence ] for bl - lodi , ls - lodi and cbc-2d .",
    "the results are compared with what is obtained for the same test case with the modified thompson method with a coefficient @xmath151 as introduced in  @xcite .    ]    as expected , for the baseline approach ( a ) , the reflection coefficient increases as the incidence angle increases . for the modified thompson approach ,",
    "the results are close to what can be found in  @xcite : the reflection rate slightly increases and reaches @xmath152 at @xmath153 of incidence . on the contrary , when the cbc method is extended with the effects of transverse waves as in  @xcite , the reflection rate decreases until @xmath154 and then begins to increase . in the case of a local streamline lodi implementation ,",
    "the coefficient remains stable at around @xmath155 of reflected wave .",
    "the computational domain , a square of @xmath156 cells is initiated with a gaussian density in order to generate a spherical wave , as follows : @xmath157 with @xmath158 , @xmath159 and @xmath160 nodes .",
    "the boundary conditions are periodic in the vertical direction , a cbc condition is set on the right boundary and a reflective boundary condition on the left ( located far enough to avoid its influence on the spherical wave at the studied time steps ) .",
    "four cases are computed : ( a ) baseline lodi , ( b ) cbc with transverse terms , ( c ) local streamline lodi and ( d ) reference case where the domain is enlarged in the horizontal direction so that the spherical wave is not affected by the boundary ( fig .",
    "[ fig : testcase_sphericalwave ] ) . as for the previous test cases , the lbm adaptation of the cbc condition had no impact on the results .",
    "testcase_sphericalwavebw.png ( 23,-0.5)600 ( -3,23)600 ( 42,48)1200 ( 22,34)300 ( 41,13)80 ( 88,19)@xmath161 ( 98,10)@xmath54    the local reflection coefficient for such a spherical wave can be computed by the following formula : @xmath162 where @xmath163 is the amplitude of the original density wave running towards the boundary condition , @xmath164 is the amplitude of the density wave after reflection at the outlet and @xmath165 is the amplitude of the density wave at the same lattice node compared to the reference case ( d ) ( no reflection ) .",
    "\\(a ) + , title=\"fig : \" ] + ( b ) + , title=\"fig : \" ] + ( c ) + , title=\"fig : \" ] +    a map of reflection rates after reflection at the outlet ( after 400 iterations ) is shown on fig .",
    "[ fig : density_22_r ] . for the baseline approach",
    ", one can see that the reflected wave becomes more important as the local incidence of the spherical waves increases , because the incident wave can be approximated as a local normal plane in the center of the outlet while , in the corners , the incidence becomes important ( up to @xmath166 ) .",
    "when adding transverse term without any relaxation as in  @xcite , the observation confirms the prospective behavior of the plane waves simulations : even if the reflection rate is consistently reduced for angles below @xmath153 , it reaches @xmath167 for the greatest observed angles . on the contrary ,",
    "the reflection rate remains constant with the local streamline lodi implementation .",
    "a 2d vortex is convected from left to right and exits the computational domain , a square of @xmath156 grid points .",
    "a particular attention must be paid to the initialization of the lamb - oseen vortex  @xcite which has to be adapted to the isothermal case in order to avoid spurious waves generated by the adaptation of a wrong initial density .",
    "the initial conditions , in lattice units , are imposed as follows :    @xmath168    @xmath169    @xmath170 ^{1/(\\gamma-1 ) } , \\label{rhovortex}\\ ] ]    where @xmath171 in lattice units , @xmath172 , @xmath173 nodes ( the vortex is initially centered on the box ) , @xmath174 nodes and @xmath175 . with the bgk collision operator with a single relaxation time",
    ", the simulated gas has the following constants  @xcite : @xmath176 @xmath177 where @xmath178 is the dimension of the problem .",
    "the specific heat capacity at constant volume @xmath179 appears instead of @xmath180 in ( [ rhovortex ] ) because of an error in the heat flux obtained in the navier - stokes equations after the chapman - enskog development for athermal lattices  @xcite .",
    "the reynolds number based on @xmath133 and the size of the computational domain is equal to 1000 and the regularized bgk scheme is chosen for the collision step .",
    "this convected vortex test case is a well known test for boundary conditions as it often reveals spurious distorsions at boundaries due to the presence of transverse terms in the navier - stokes equation  @xcite . as previously ,",
    "top and bottom boundary conditions are periodic , the left condition is a regularized inlet and four different cbc conditions will be evaluated at the right boundary:(a ) baseline lodi with @xmath181 , + ( b ) local streamline lodi with @xmath181 , + ( c ) cbc-2d with @xmath182 , + ( d ) cbc-2d relaxed including transverse terms with : @xmath183 where @xmath184 and @xmath185 . + for low reynolds numbers ( @xmath186 ) , simulations",
    " not shown here  provided the same results at @xmath135 . however , for @xmath187 , the zou / he adaptation was no more stable for this test case , contrary to both regularized methods .",
    "the results presented here have been obtained with the regularized bb adaptation .",
    "\\(a ) baseline lodi   ( b ) ls lodi  @xmath188   ( min=-0.285 , max=0.285 ) of the convected vortex leaving the computational domain at four time steps : 400 , 700 , 1000 and 1300 iterations .",
    "( a ) baseline lodi and ( b ) ls - lodi . a small part of the computational domain is represented .",
    "[ fig : covo_isov],title=\"fig:\",scaledwidth=20.0% ]   ( min=-0.285 , max=0.285 ) of the convected vortex leaving the computational domain at four time steps : 400 , 700 , 1000 and 1300 iterations .",
    "( a ) baseline lodi and ( b ) ls - lodi . a small part of the computational domain is represented .",
    "[ fig : covo_isov],title=\"fig:\",scaledwidth=20.0% ] +   ( min=-0.285 , max=0.285 ) of the convected vortex leaving the computational domain at four time steps : 400 , 700 , 1000 and 1300 iterations . ( a ) baseline lodi and ( b ) ls - lodi .",
    "a small part of the computational domain is represented .",
    "[ fig : covo_isov],title=\"fig:\",scaledwidth=20.0% ]   ( min=-0.285 , max=0.285 ) of the convected vortex leaving the computational domain at four time steps : 400 , 700 , 1000 and 1300 iterations . ( a ) baseline lodi and ( b ) ls - lodi .",
    "a small part of the computational domain is represented .",
    "[ fig : covo_isov],title=\"fig:\",scaledwidth=20.0% ] +   ( min=-0.285 , max=0.285 ) of the convected vortex leaving the computational domain at four time steps : 400 , 700 , 1000 and 1300 iterations . ( a )",
    "baseline lodi and ( b ) ls - lodi .",
    "a small part of the computational domain is represented .",
    "[ fig : covo_isov],title=\"fig:\",scaledwidth=20.0% ]   ( min=-0.285 , max=0.285 ) of the convected vortex leaving the computational domain at four time steps : 400 , 700 , 1000 and 1300 iterations . ( a ) baseline lodi and ( b ) ls - lodi .",
    "a small part of the computational domain is represented .",
    "[ fig : covo_isov],title=\"fig:\",scaledwidth=20.0% ] +   ( min=-0.285 , max=0.285 ) of the convected vortex leaving the computational domain at four time steps : 400 , 700 , 1000 and 1300 iterations .",
    "( a ) baseline lodi and ( b ) ls - lodi . a small part of the computational domain is represented .",
    "[ fig : covo_isov],title=\"fig:\",scaledwidth=20.0% ]   ( min=-0.285 , max=0.285 ) of the convected vortex leaving the computational domain at four time steps : 400 , 700 , 1000 and 1300 iterations . ( a ) baseline lodi and ( b ) ls - lodi .",
    "a small part of the computational domain is represented .",
    "[ fig : covo_isov],title=\"fig:\",scaledwidth=20.0% ] +    ( c ) cbc-2d  ( d ) cbc-2d relaxed    ( min=-0.285 , max=0.285 ) of the convected vortex leaving the computational domain at four time steps : 400 , 700 , 1000 and 1300 iterations .",
    "( c ) cbc-2d and ( d ) cbc-2d relaxed .",
    "a small part of the computational domain is represented .",
    "[ fig : covotransverse_isov],title=\"fig:\",scaledwidth=20.0% ]   ( min=-0.285 , max=0.285 ) of the convected vortex leaving the computational domain at four time steps : 400 , 700 , 1000 and 1300 iterations .",
    "( c ) cbc-2d and ( d ) cbc-2d relaxed .",
    "a small part of the computational domain is represented .",
    "[ fig : covotransverse_isov],title=\"fig:\",scaledwidth=20.0% ] +   ( min=-0.285 , max=0.285 ) of the convected vortex leaving the computational domain at four time steps : 400 , 700 , 1000 and 1300 iterations .",
    "( c ) cbc-2d and ( d ) cbc-2d relaxed .",
    "a small part of the computational domain is represented .",
    "[ fig : covotransverse_isov],title=\"fig:\",scaledwidth=20.0% ]   ( min=-0.285 , max=0.285 ) of the convected vortex leaving the computational domain at four time steps : 400 , 700 , 1000 and 1300 iterations .",
    "( c ) cbc-2d and ( d ) cbc-2d relaxed .",
    "a small part of the computational domain is represented .",
    "[ fig : covotransverse_isov],title=\"fig:\",scaledwidth=20.0% ] +   ( min=-0.285 , max=0.285 ) of the convected vortex leaving the computational domain at four time steps : 400 , 700 , 1000 and 1300 iterations . ( c )",
    "cbc-2d and ( d ) cbc-2d relaxed . a small part of the computational domain is represented .",
    "[ fig : covotransverse_isov],title=\"fig:\",scaledwidth=20.0% ]   ( min=-0.285 , max=0.285 ) of the convected vortex leaving the computational domain at four time steps : 400 , 700 , 1000 and 1300 iterations .",
    "( c ) cbc-2d and ( d ) cbc-2d relaxed . a small part of the computational domain is represented .",
    "[ fig : covotransverse_isov],title=\"fig:\",scaledwidth=20.0% ] +   ( min=-0.285 , max=0.285 ) of the convected vortex leaving the computational domain at four time steps : 400 , 700 , 1000 and 1300 iterations . ( c ) cbc-2d and ( d ) cbc-2d relaxed .",
    "a small part of the computational domain is represented .",
    "[ fig : covotransverse_isov],title=\"fig:\",scaledwidth=20.0% ]   ( min=-0.285 , max=0.285 ) of the convected vortex leaving the computational domain at four time steps : 400 , 700 , 1000 and 1300 iterations .",
    "( c ) cbc-2d and ( d ) cbc-2d relaxed .",
    "a small part of the computational domain is represented .",
    "[ fig : covotransverse_isov],title=\"fig:\",scaledwidth=20.0% ] +    fig.[fig : covo_isov ] and [ fig : covotransverse_isov ] show isovalues of non dimensional longitudinal velocity for the four studied cases .",
    "first , it can be noticed that , contrary to what was observed in the previous test cases , the use of local streamline boundary condition does not allow to reduce non physical reflections compared to baseline lodi .",
    "a possible explanation would be that , inside the vortex , local streamlines are nearly perpendicular to the direction of propagation of the local wave , whereas they were aligned in the case of a pure acoustic wave .",
    "the lodi equations are thus applied in a wrong frame which generates non physical reflections .",
    "results are slightly better for the bl - lodi for which the local frame is the good one for at least local normal waves .",
    "the addition of the transverse waves in the cbc-2d boundary allows the vortex to keep a correct shape at least until 1000 iterations .",
    "however , once the first half of the vortex has reached the outlet , it is distorted as in the bl - lodi case .",
    "the addition of relaxation coefficients allows the vortex to keep its shape at the last iteration , even if it is a bit distorted .",
    "it can be noticed that the configuration appears to be symmetric for boundaries ( a ) and ( c ) , which is not the case for ( b ) and ( d ) .",
    "indeed , with the ls - lodi , the streamlines used in the change of frame are not symmetric and in the last case , the density frame appears to be asymmetric which has an influence on @xmath55 through the relaxed pressure , and thus on the longitudinal velocity fields .",
    "an analysis of numerical stability of the previous convected vortex test case at different reynolds numbers and different grid resolutions has been carried out .",
    "it has been noticed that the cbc type ( bl - lodi , ls - lodi or cbc-2d ) had no impact on the stability as far as @xmath55 is not relaxed : the numerical stability comes from the lbm adaptation itself .",
    "[ fig : stability ] compares the stability of the zou / he adaptation and the regularized bb adaptation .",
    "as predicted from  @xcite , the classical regularized boundary condition is more stable than the zou / he adaptation .",
    "however , a huge resolution is still required in order to reach high reynolds numbers . on the contrary ,",
    "the regularized fd adaptation has shown to be unconditionnally numerically stable : in every configurations of the convected vortex test case , the first numerical instabilities came from the inside of the domain and not the cbc boundary condition .    ]",
    "the objective of this section is to demonstrate the robustness of the cbcs in a case relevant for high reynolds aerodynamics applications .",
    "the configuration is a naca0015 profile , in a 8@xmath189 domain ( with @xmath190  m the chord of the profile ) .",
    "the mach number is set to 0.04 and the reynolds number is set to @xmath3 .",
    "the lattice dimension is @xmath191  m , corresponding to a time step @xmath192  s. each simulation is run for 200 000 time steps , but only the last 100 000 time steps are kept for data post - processing .",
    "the simulations are performed on a @xmath193 points 2d grid , to ensure numerical stability and a proper resolution of the flow patterns with a les formalism .",
    "the sub grid scale model is the smagorinsky model , with a constant @xmath194 , associated with a regularized bgk collision scheme . in order to generate complex flow patterns ,",
    "the profile is inclined with an angle of @xmath195 , compared to the freestream velocity direction which is purely axial .",
    "three cbcs are tested : bl - lodi , ls - lodi and cbc-2d .",
    "the cbc solutions are compared with a reference solution obtained on 16  @xmath189 domain , fig .",
    "[ fig : naca1_prms_ref ] . in this reference case , vortices do not leave the extended computational domain at the observed time steps and the initial acoustic wave is evacuated thanks to a neumann outlet ( populations at the boundary are copied from the neighbor voxel ) associated with a 4c - wide viscosity sponge zone inside which the relaxation time is increased up to @xmath37 with a sinusoidal shape in order to smoothly increase the numerical dissipation . among cbc computations ,",
    "only the regularized fd adaptation has been sufficiently robust to achieve the simulations .    at this reynolds number",
    ", the real flow should be 3d in the vicinity of the profile and in the wake , due to the development of turbulent flow patterns .",
    "however , the present 2d approach is not able to reproduce such 3d effects . despite that",
    ", the trajectory of the vortices exhibits a chaotic behavior , as observed on the time - averaged flow field in fig .",
    "[ fig : naca1_prms_ref ] . the challenges with the present test case are to ensure that :    * the initial acoustic wave generated by the presence of the airfoil leaves the domain with minimum reflection , * the vortices generated by the boundary layer separation are correctly convected beyond the outlet plane with minimum spurious wave reflection .    : time - averaged flow field colored with the pressure fluctuation @xmath196 ( reference configuration , 16@xmath189 domain , only the left half of the domain is representeds ) . [ fig : naca1_prms_ref],scaledwidth=40.0% ]    the difficulty for such a test case lies in the chaotic nature of the flow , since the trajectory of the vortices is affected by small perturbations . because of this phenomenon , the visualization of error fields , computed as the difference between the reference solution and each tested cbc , would not be compellant since vortices are not superposed in each computation .",
    "a better choice is to plot the root mean square of the pressure field , defined as @xmath197 , to underline the behavior of each cbc during the whole computation as in fig .",
    "[ fig : naca1_prms_cbc ] .",
    "\\(a ) + : time - averaged flow field colored with the pressure fluctuation @xmath196 . ( a ) bl - lodi , ( b ) ls - lodi , ( c ) cbc-2d .",
    "[ fig : naca1_prms_cbc],title=\"fig:\",scaledwidth=40.0% ] + ( b ) + : time - averaged flow field colored with the pressure fluctuation @xmath196 .",
    "( a ) bl - lodi , ( b ) ls - lodi , ( c ) cbc-2d .",
    "[ fig : naca1_prms_cbc],title=\"fig:\",scaledwidth=40.0% ] + ( c ) + : time - averaged flow field colored with the pressure fluctuation @xmath196 .",
    "( a ) bl - lodi , ( b ) ls - lodi , ( c ) cbc-2d .",
    "[ fig : naca1_prms_cbc],title=\"fig:\",scaledwidth=40.0% ] +    it can be noticed that the baseline lodi approach ( a ) allows to evacuate the initial acoustic wave and the convected vortices with minimal reflection .",
    "the only differences with the reference @xmath196 field are the small perturbations observed at the outlet and a background noise which can be due to the reflection of the initial acoustic wave .",
    "the local streamline lodi approach ( b ) is less efficient : the background noise is more pronounced and the dissymetry observed in the previous academic test cases is still present , which increases pressure fluctuations at the outlet . in the cbc-2d case ( c ) , the map of pressure fluctuations seems more smooth and the vortices does not seem do produce spurious reflections .",
    "but the overall prms is increased in the whole domain , which can be due to a drift of the mean pressure because of the absence of relaxation in the boundary condition .    to quantify more the performance of the three cbc approaches , the time - averaged fluctuations of pressure @xmath196 and velocity @xmath198 , @xmath199",
    "are shown in fig .",
    "[ fig : naca2 ] at @xmath200=7.5 ( close to the outlet where the cbc is applied ) .",
    "all cbcs show a good ability to predict the mean flow as well as pressure and velocity fluctuations .",
    "this test case remains a challenge for cbcs since the pressure and velocity fluctuations outside the wake are four magnitude orders lower than the mean field value . in that regard ,",
    "all cbc methods predict pressure and velocity fluctuations of the same magnitude order than in the reference case .",
    "the cbc that provides the best results in term of accuracy for both pressure and velocity fluctuations is the bl - lodi approach .",
    "the ls - lodi gives satisfactory results outside the wake but it overestimates @xmath196 by a factor 2 in the wake ( at @xmath201=4 ) because of the dissymetry in the vortices reflections .",
    "the cbc-2d approach overestimates @xmath196 outside the wake by a factor 4 but it gives good results in the wake , similar to those obtain with the bl - lodi approach .",
    "similar conclusions can be drawn for axial and transverse velocity fluctuations , except that all methods predict the correct velocity fluctuations in the wake , including the ls - lodi approach .",
    "\\(a ) pressure fluctuation @xmath196 + : a ) pressure fluctuation @xmath196 , b ) axial velocity fluctuation @xmath198 and c ) transverse velocity fluctuation @xmath199 .",
    "[ fig : naca2],title=\"fig:\",scaledwidth=37.0% ] + ( b ) axial velocity fluctuation @xmath198 + : a ) pressure fluctuation @xmath196 , b ) axial velocity fluctuation @xmath198 and c ) transverse velocity fluctuation @xmath199 .",
    "[ fig : naca2],title=\"fig:\",scaledwidth=37.0% ] + ( c ) transverse velocity fluctuation @xmath199 + : a ) pressure fluctuation @xmath196 , b ) axial velocity fluctuation @xmath198 and c ) transverse velocity fluctuation @xmath199 .",
    "[ fig : naca2],title=\"fig:\",scaledwidth=37.0% ] +",
    "an implementation of a non reflective outflow boundary condition , which does not need additional absorbing layers nor extended domains , has been proposed for a lattice boltzmann solver .",
    "the methods presented here are based on the characteristic boundary conditions ( cbc ) with the classical lodi approach ( bl - lodi ) , its extension to transverse waves ( cbc-2d ) and the lodi approach in the local streamline based frame ( ls - lodi ) .",
    "three ways of computing missing populations in order to impose the cbc physical values have been introduced .",
    "the first one is based on the classical zou / he boundary condition , while the other ones are based on the more stable regularized boundary condition : the so - called `` regularized bb '' adaptation , where the off - equilibrium part of the stress tensor is evaluated thanks to a bounceback rule , and the `` regularized fd '' adaptation , where it is computed thanks to an upwind finite difference scheme .",
    "all these methods provided very good results in the test case of a normal plane wave , where computed reflection rates were about @xmath202 .",
    "testcases of a plane wave with incidence and a spherical wave showed that the reflection rate increases with the incidence angle for the bl - lodi adaptation . when adding the effect of transverse terms , the reflected wave is considerably reduced but begins to increase for incidence angles greater than @xmath154 .",
    "for these pure acoustic waves , the ls - lodi adaptation provided the best results since the reflection rate remained below @xmath152 whatever the incidence angle .",
    "however , this method is not adapted for a convected vortex , for which the cbc-2d adaptation with relaxation on density and transverse waves provided the best results and lead to only slight distortions of the velocity fields .",
    "as regards the numerical stability of the implemented cbc , the regularized adaptations have shown to be well more stable than the zou / he one . the regularized fd adaptation associated with a regularized bgk scheme allowed to run the naca0015 case at high reynolds number ( @xmath3 ) in 2d with n=400 cells per chord length , which was not possible with zou / he or regularized bb adaptations .",
    "thus , the use of the regularized fd adaptation is well advised for high reynolds computations .",
    "the authors are grateful to the calmip computing center of the federal university of toulouse ( project account number p1425 ) for providing all resources that have been used in this work .",
    "the authors would also thank j.f .",
    "boussuge from cerfacs for his help on post - processing and the discussion about the method .",
    "p.  g. tucker , j.  r. debonis , aerodynamics , computers and the environment , philosophical transactions of the royal society a : mathematical , physical and engineering sciences 372  ( 2022 ) ( 2014 ) 2013033120130331 .",
    "s.  mari , d.  ricot , p.  sagaut , comparison between lattice boltzmann method and navier - stokes high order schemes for computational aeroacoustics , journal of computational physics 228  ( 4 ) ( 2009 ) 1056  1070 .",
    "v.  heuveline , m.  j. krause , j.  latt , towards a hybrid parallelization of lattice boltzmann methods , computers & mathematics with applications 58  ( 5 ) ( 2009 ) 1071  1080 , mesoscopic methods in engineering and science .",
    "g.  lodato , p.  domingo , l.  vervisch , three - dimensional boundary conditions for direct and large - eddy simulation of compressible viscous flows , journal of computational physics 227  ( 10 ) ( 2008 ) 5105  5143 .",
    "d.  heubes , a.  bartel , m.  ehrhardt , characteristic boundary conditions in the lattice boltzmann method for fluid and gas dynamics , journal of computational and applied mathematics 262 ( 2014 ) 51  61 , selected papers from numdiff-13 .",
    "c.  s. yoo , h.  g. i m , characteristic boundary conditions for simulations of compressible reacting flows with multi - dimensional , viscous and reaction effects , combustion theory and modelling 11  ( 2 ) ( 2007 ) 259286 .",
    "p.  c. philippi , l.  a. hegele , l.  o.  e. dos santos , r.  surmas , from the continuous to the lattice boltzmann equation : the discretization problem and thermal models , physical review e 73  ( 5 ) ( 2006 ) 056702 .",
    "c.  s. yoo , h.  g. i m , characteristic boundary conditions for simulations of compressible reacting flows with multi - dimensional , viscous and reaction effects , combustion theory and modelling 11  ( 2 ) ( 2007 ) 259286 ."
  ],
  "abstract_text": [
    "<S> this paper reports the investigations done to adapt the characteristic boundary conditions ( cbc ) to the lattice - boltzmann formalism for high reynolds number applications . </S>",
    "<S> three cbc formalisms are implemented and tested in an open source lbm code : the baseline local one - dimension inviscid ( bl - lodi ) approach , its extension including the effects of the transverse terms ( cbc-2d ) and a local streamline approach in which the problem is reformulated in the incident wave framework ( ls - lodi ) . </S>",
    "<S> then all implementations of the cbc methods are tested for a variety of test cases , ranging from canonical problems ( such as 2d plane and spherical waves and 2d vortices ) to a 2d naca profile at high reynolds number ( @xmath0 ) , representative of aeronautic applications . </S>",
    "<S> the ls - lodi approach provides the best results for pure acoustics waves ( plane and spherical waves ) . </S>",
    "<S> however , it is not well suited to the outflow of a convected vortex for which the cbc-2d associated with a relaxation on density and transverse waves provides the best results . </S>",
    "<S> as regards numerical stability , a regularized adaptation is necessary to simulate high reynolds number flows . </S>",
    "<S> the so - called regularized fd ( finite difference ) adaptation , a modified regularized approach where the off - equilibrium part of the stress tensor is computed thanks to a finite difference scheme , is the only tested adaptation that can handle the high reynolds computation .    </S>",
    "<S> lattice boltzmann method , characteristic boundary conditions , lodi , high reynolds number flows </S>"
  ]
}