{
  "article_text": [
    "in recent years , networks have been widely used in modeling a variety of social , technological , and biological systems @xcite .",
    "one major application is modeling the spread of an epidemic on a social network ( e.g. , @xcite ) . in these models ,",
    "typically the network structure is assumed static , while the infection status of the nodes changes dynamically .    during an epidemic , people may tend to avoid social connections with infected individuals @xcite .",
    "this system can be considered an adaptive network , where the node dynamics affects the network topology , which then affects future changes in node status @xcite .",
    "epidemic spreading in adaptive network models with avoidance behavior has been studied previously @xcite , with avoidance frequently implemented via susceptible nodes rewiring their links away from infected neighbors and towards other non - infected nodes .",
    "changes in bifurcation structure have been observed , including the existence of bistable regimes with endemic and disease free states both stable .",
    "one of the most important features of a social network is community structure @xcite .",
    "the strength of the community structure can be quantified by using a modularity measure @xcite , which for a random network will be close to zero , and will be close to one for a strong community structure .",
    "studies of epidemics with community structure have focused mainly on static network geometries , including scale - free @xcite , small - world @xcite and random networks @xcite .",
    "it has been found that community structure can either decrease @xcite or increase @xcite infection prevalence , depending on details of the model .",
    "further , epidemics can synchronize across communities if there are sufficient connections between communities @xcite . in a dynamic but not adaptive example",
    ", communities of mobile agents were studied @xcite , and dynamic hopping of agents between communities was able to produce sustained infection in communities that were below the epidemic threshold if other communities were above threshold .",
    "adaptive networks with community structure have been studied only rarely . in @xcite",
    ", the authors considered an adaptive scale - free network with community structure in which neighbors of an infected node can move to other communities with a certain probability .",
    "infection levels were reduced compared to the case without adaptation , but the adaptation mechanism did not preserve the community structure as measured by modularity . in @xcite",
    ", the authors introduced a model very similar in structure to the one we will consider here .",
    "however , their focus was to study an adaptive epidemic system with two types of agents .",
    "they varied the within - type and cross - type link rewiring rates and infection rates and determined their effects on the size of the bistability region .",
    "for certain parameter choices the endemic steady state would have a community structure , but the resulting structure was not characterized in this study .    in this paper , we extend the adaptive susceptible - infected - susceptible ( sis ) model of @xcite to a network with two communities .",
    "in contrast to previous studies @xcite , we allow the communities to have different average degree .",
    "we define rewiring rules such that the community structure is preserved if links between susceptibles and infectives are uniformly distributed .",
    "we directly simulate the stochastic network system and derive a lower dimensional mean field , based on a moment closure approximation , that accurately predicts the bifurcation structure of the full system . in section [ sec : model ]",
    ", we define the model and introduce the mean field equations .",
    "results in the absence of adaptation are presented in subsection [ subsec : static ] . in subsection",
    "[ subsec : adaptive ] , we show the effects of adaptation on the bifurcation structure and on the network geometry .",
    "section [ sec : conclusions ] concludes .",
    "we study a susceptible - infective - susceptible ( sis ) model on an adaptive network having two communities .",
    "the communities are labeled a and b and consist of @xmath0 and @xmath1 nodes , respectively . here",
    "we use two probability parameters to generate an initial network with two communities by creating links .",
    "parameter @xmath3 $ ] determines the asymmetry in average degree of the communities , and @xmath4 $ ] determines the number of links between communities .",
    "links are created as follows . with probability",
    "@xmath5 we choose a node among the @xmath0 nodes in community a ( otherwise choosing a node in community b ) , and with probability @xmath6 its neighbor is chosen at random from the opposite community as the first node ( otherwise choosing from the same community ) .",
    "this process is repeated until a total of @xmath7 links are created .",
    "self links and multiple links are disallowed .",
    "then a fraction @xmath8 of the links are aa , @xmath9 are bb , and @xmath6 are ab",
    ". the average degrees in communities a and b are @xmath10k / n_a$ ] and @xmath11k / n_b$ ] , respectively .",
    "thus the communities are symmetric when @xmath12 .",
    "we will focus here on the case @xmath13 , so community a will have higher connectivity than b. the total number of cross links between communities is @xmath14 .",
    "we define node dynamics as in @xcite .",
    "a susceptible ( s ) node becomes infected with rate @xmath15 , where @xmath16 is the number of infected neighbors the node has and @xmath17 is the infection rate . an infected ( i ) node recovers with recovery rate @xmath18 .",
    "one of these rates can be eliminated by rescaling time , so it is sufficient to treat @xmath18 as fixed .",
    "we fix @xmath19 throughout the paper as in previous studies @xcite .",
    "network adaptation in the form of avoidance behavior is introduced by allowing susceptible - infected links to rewire with rate @xmath20 to susceptible - susceptible links , as in @xcite .",
    "however , the rewiring must be adjusted to retain the desired community structure .",
    "this is done by choosing the susceptible node s new neighbor from one or the other community with appropriate probabilities .",
    "an s node having an infected neighbor rewires to an s node in the same community as itself with probability @xmath21 if the s node is in community a and with probability @xmath22 if the s node is in community b. otherwise a neighbor in the other community is selected . in order to retain the community structure",
    ", we set @xmath23 and @xmath24 .",
    "this choice is made so that if randomly selected links rewire , then the flux from aa links to ab links , @xmath25 , equals the flux from ab links to aa links , @xmath26 , and likewise for balance of fluxes between bb and ab links .",
    "therefore , if si links occur at random anywhere in the network , this rewiring strategy will on average keep the community structure specified above by @xmath5 and @xmath6 .",
    "we simulate our model using gillespie s method @xcite for @xmath27 nodes and @xmath28 links @xcite .",
    "the initial condition is either the final state of a previous run or a random two - community network constructed as described above in which a fraction of the nodes have been randomly infected .    as in @xcite",
    ", we derive mean field equations for the evolution of the nodes and links .",
    "@xmath29 denotes the probability of nodes to be in state @xmath30 , where @xmath30 is susceptible in community a or b ( @xmath31 or @xmath32 ) or infected in a or b ( @xmath33 or @xmath34 ) .",
    "@xmath35 denotes the probability that a randomly selected link connects a node in state @xmath30 to a node in state @xmath36 .",
    "we obtain the following equations for the node dynamics : @xmath37 because nodes are neither created nor destroyed and do not change their community assignment , the equations for susceptibles in community a and b can be found from node conservation .",
    "the evolution of the links depends on three point terms . as in @xcite we use a moment closure assumption to close the system , assuming @xmath38 , where @xmath39 is the fraction of three point terms . after applying the moment closure ,",
    "the link equations are @xmath40 these mean field equations are a special case of the general mean field in @xcite for appropriate choices of their rewiring and infection parameters .",
    "since the total number of links is fixed , we have an 11 dimensional system in the adaptive network case by eliminating one of the link equations . on the other hand",
    ", we have a 9 dimensional system in the static network case because the numbers of aa , ab , and bb links are each fixed .",
    "these equations can be integrated with standard numerical integration methods .",
    "also , we tracked their steady states using a continuation package @xcite .",
    "we first consider the effect of having two communities with different average connectivities in a static network ( @xmath41 ) .",
    "we obtained the bifurcation structure ( figure [ fig : panelw0 ] ) as follows .",
    "we used the xppaut free software package @xcite to locate the stable and unstable equilibrium solutions of mean field equations . to obtain the steady states of the full system",
    ", we generated an initial random network with community structure in which @xmath42 of the nodes were infected . to locate the upper branch ( endemic state )",
    ", the system was run to steady state for a high infection rate @xmath17 , and @xmath17 was decreased gradually using the final state of each run as an initial state for the next run . for each @xmath17",
    ", we run the system up to @xmath43 time units and then averaged the steady state over @xmath44 samples where there are @xmath45 events between each sample . to locate the lower branch ( disease - free state )",
    ", we generated a random network with community structure in which @xmath46 of the nodes were infected .",
    "the system was simulated for @xmath43 time units , and five runs were done for each @xmath17 value .",
    "if the infected fraction went to zero in any of the five runs , the disease - free state was considered stable .",
    "as shown in figure [ fig : panelw0 ] , the mean field equations and the full system are in good agreement .    in a static network without community structure , the disease free state ( dfs ) loses stability at a critical infection rate @xmath47 where the system undergoes a transcritical bifurcation .",
    "this threshold infection rate depends on the average degree of the network @xcite .",
    "figure [ fig : panelw0]a superimposes the bifurcation diagrams of two single - community networks with different average degrees . the epidemic threshold for community a ( @xmath48 ) and community b ( @xmath49 ) are significantly different .",
    "when the two networks are loosely connected ( @xmath50 , figure [ fig : panelw0]b and blowup in figure [ fig : panelw0]d ) , the combined system has a single threshold infection rate , which is approximately @xmath51 and much lower than @xmath49 in the disconnected case .",
    "when the infection rate is between @xmath48 and @xmath49 , the fraction of infecteds in b is close to zero ( figure [ fig : panelw0]d ) and stochastic reintroduction of infection from a to b is observed .",
    "however , when the two communities are strongly connected ( @xmath52 , figure [ fig : panelw0]c ) , they behave similarly in that both communities have significant infection levels for the same parameter values .    ) as a function of infection rate @xmath17 for different fractions of cross links @xmath6 .",
    "black : community a ; gray : community b. solid curves : mean field solutions ( stable branches ) ; dashed curves : mean field solutions ( unstable branches ) ; circles : monte carlo simulations .",
    "average degrees @xmath53 and @xmath54 .",
    "the plots correspond to @xmath55 , @xmath56 , @xmath57 , @xmath58 and @xmath19 . in ( d ) , in order to obtain better statistics , we averaged over 100 network realizations , each of which is similar to ( b ) .",
    ", width=364 ]    although a system of two connected communities has an infection threshold at a single bifurcation point , we wish to distinguish between the cases in figure [ fig : panelw0]b , c , where significant infection spread occurs in the low degree community ( b ) if it has sufficient links to the high degree community ( a ) , while the infection in community b is very small if the number of cross links is low . to quantify this , we define effective threshold infection rates @xmath59 , @xmath60 for each community as follows . while sweeping the infection rate @xmath17 from higher to lower values , the first @xmath17 value at which the fraction of infecteds at the steady state is lower than @xmath61 is considered as the effective threshold infection rate for that community .",
    "figure [ fig : thresholdw0 ] shows the effective threshold infection rates versus cross link fraction @xmath6 . when @xmath62 , the effective thresholds in the two communities become noticeably different .    .",
    "black curve : community a ; gray curve : community b. the infection rate @xmath17 at which the fraction of infecteds is less than @xmath63 is considered as the effective threshold rate .",
    "@xmath55 , @xmath56 , @xmath57 , @xmath58 and @xmath19 .",
    ", width=288 ]      we now move to systems with nonzero rewiring rates .",
    "the bifurcation structure for the adaptive network case was determined as for static networks except for the following modification . in our model",
    ", network adaptation does not occur in the absence of infection .",
    "this means that the dfs of equations ( [ eq : nodea]-[eq : iaib ] ) is not isolated , because any disease free combination of aa , ab , and bb links is a steady state .",
    "because of the non - isolated fixed points , the stability of the disease free branch could not be determined using continuation packages .",
    "instead , we calculated numerically the eigenvalues of the jacobian evaluated at the dfs for the initial network geometry which is described by @xmath6 and @xmath5 .     for different fractions of cross links @xmath6 .",
    "black : community a ; gray : community b. solid curves : mean field solutions ( stable branches ) ; dashed curves : mean field solutions ( unstable branches ) ; circles : monte carlo simulations .",
    "average degrees @xmath64 and @xmath65 .",
    "the plots correspond to @xmath55 , @xmath56 , @xmath57 , @xmath58 , @xmath66 and @xmath19 .",
    "the simulations are done similarly as in figure [ fig : panelw0 ] , but here we run the system for @xmath67 time units in order to approach the endemic branch.,width=355 ]    in the absence of community structure ( @xmath68 ) , the dfs loses stability at a critical infection rate @xmath47 , where the unstable endemic branch and the stable disease free branch intersect at a transcritical bifurcation ( figure [ fig : panelw04]a ) .",
    "the epidemic threshold @xmath47 is inversely proportional to the average degree of the network and can be found analytically from the jacobian of the mean - field equations for a single network ( see appendix ) .    for a network having two loosely connected heterogenous communities ( @xmath69 )",
    ", @xmath47 is very close to that of a single network having the same average degree as community a ( figure [ fig : panelw04]a , b ) .",
    "this is expected because when the infection in community a starts to spread , a small value of @xmath6 will not be enough to stop infection spreading in community a. in contrast , for @xmath52 , @xmath47 is larger than that of a single network having the same average degree as community a. in this case , the connection is stronger and the infection starting to spread in community a can be suppressed by the connection to a community where no infection is observed . as we increase @xmath6 , the critical value of @xmath17 approaches that of a single network with average degree @xmath70 , which is the average degree in the entire system .    in an adaptive network without community structure , bistability can occur for a range of rewiring rates @xcite .",
    "we focus on the rewiring rate @xmath66 , for which the endemic branch loses stability at a critical infection rate where the system undergoes a saddle - node ( sn ) bifurcation .",
    "the location of this sn bifurcation depends on the average degree of the network .",
    "figure [ fig : panelw04]a superimposes the bifurcation diagrams of two single - community networks with different average degrees .    in our model , for a network having two strongly connected communities ( @xmath52 )",
    ", the endemic state loses stability at a sn bifurcation point .",
    "however , for the loosely connected case ( @xmath50 ) , the endemic branch loses stability at a hopf bifurcation ( hb ) point . as with the epidemic threshold ( transcritical bifurcation ) in static networks ,",
    "the location of the sn bifurcation and the hb in the adaptive network is governed primarily by the high degree community . however ,",
    "in contrast with the static case , small cross link fraction @xmath6 is not associated with low steady state infection levels in the low degree community .",
    "as will be seen later in this section , the state with high infection in one community and low in the other community is not a steady state due to the network adaptation .",
    "instead , infection levels are similar in both communities even if weakly connected .",
    "both communities continue to exhibit high infection levels as the number of cross links is further increased ( figure [ fig : panelw04]c ) .    by looking at the time series of the mean field equations",
    ", we observed a stable periodic solution for a very small range of @xmath17 values near the hb point .",
    "however , we do not see any periodic behavior in the full system due to the narrow range of @xmath17 values .    as the heterogeneity in the network increases by increasing @xmath5 , the hopf bifurcation point also increases .",
    "furthermore , the epidemic threshold decreases because of a much higher average degree in community a. this narrows the region where both disease free and endemic branches are stable .",
    "in particular , for @xmath71 , there is no @xmath17 value where both the endemic steady state and dfs are stable .",
    "for @xmath71 we observed periodic solutions with a very long period for @xmath17 values smaller than the hb point in both mean field and the full system .    ,",
    "@xmath56 , @xmath57 , @xmath50 , @xmath58 , @xmath66 , @xmath19 and @xmath72.,width=355 ]    to motivate the absence of the state seen in static networks with high infection in one community and low infection in the other , we consider a long time series starting initially with a network where @xmath50 and @xmath58 generated as described above . as seen in figure [ fig : timesd07 ] , the fraction of aa and bb type links change with time .",
    "the adaptation rules have been chosen so that if si links are distributed uniformly throughout the network , the community structure will be preserved . however , with high initial infection levels in a and low in b , there are more si links among the aa and ab links and fewer among the bb links .",
    "this leads to a net flux of link types from aa to ab to bb .",
    "( the fraction of ab links ( not shown ) remains relatively constant at low levels throughout . )",
    "eventually the average degree in the b community exceeds that in the a community and there is an incursion of infection from a to b. the flux of link types is then reversed , and the steady state network structure is similar ( but not identical ) to that expected from the community structure parameters @xmath73 .",
    "the infection persists at high levels in both communities at steady state .    we can estimate the time until infection incursion in the b community as follows . from equations ( [ eq :",
    "sasa],[eq : saia],[eq : iaia ] ) , the fraction of aa links @xmath74 evolves according to @xmath75.\\ ] ] since we are interested in the critical time when infection starts to spread in community b , we can assume @xmath76 and hence @xmath77 .",
    "thus @xmath78 where @xmath79 .",
    "since @xmath6 is close to zero , we can use the single mean field equations to approximate @xmath80 , the fraction of si links in community a ( see appendix a ) .",
    "we can then solve equation ( [ eq : mf_aa ] ) for the critical time @xmath81 for infection incursion if we know @xmath82 at that time .",
    "since we can predict the critical average degree for community b in order for the disease to spread , we can also find @xmath82 at that point .",
    "however , for the full system , the infection in community b starts to spread much earlier than the time found by using mean field equations because of the stochastic nature of our model .",
    "even so , we can solve the equation for @xmath83 as follows : @xmath84\\left[w(1-\\alpha)\\gamma\\right]^{-1}\\\\ \\ ] ] from which it can be shown that the critical time @xmath81 is proportional to @xmath85 . in figure",
    "[ fig : tvsf ] , we can see that the relationship @xmath86 holds for the full system .    .",
    "the critical time values are averaged over 5 runs except for @xmath87 . in each run , the time when the fraction of infecteds in community b exceeded @xmath88 is considered the critical time.,width=355 ]    when the system reaches steady state ( late time in figure [ fig : timesd07 ] ) , the network geometry does not return exactly to that expected from the community structure parameters @xmath89 because the si links are not uniformly distributed .",
    "this effect is most pronounced when the infection rate is below the critical infection rate for the low connectivity network , because then the si link distribution is the most nonuniform .",
    "figure [ fig : linksw04 ] shows the steady state community structure versus the infection rate .",
    "deviations from the community structure specified by @xmath89 increase as the infection rate approaches the hopf bifurcation point at @xmath90 .",
    "thus the steady state average degree observed in the two communities in the presence of an epidemic can be different than that expected in the absence of an epidemic .",
    "the adaptation has a homogenizing effect , bringing the degrees in the communities closer to each other .    for @xmath71 ,",
    "the behavior of the system is very interesting . in fig .",
    "[ fig : timesd09 ] , we started with similar initial conditions as for @xmath58 in fig .",
    "[ fig : timesd07 ] .",
    "the system behaved similarly for a long time , but once the infection level reached a high value in community b , it could not stay in that state , because a higher @xmath5 means a higher out flux rate from bb type links .",
    "the average degree in b started to decrease , causing infection to die out again in b. a periodic solution with a long period is observed for a range of @xmath17 values .    .",
    "curves : mean field steady states ; points : monte carlo steady state averages .",
    "black : fraction of aa type links ; gray : fraction of bb type links .",
    "( the fraction of ab links is less than @xmath91 . )",
    "@xmath55 , @xmath56 , @xmath57 , @xmath50 , @xmath58 , @xmath66 , @xmath19 .",
    "the data is from the simulations done in figure [ fig : panelw04 ] .",
    ", width=336 ]    , @xmath56 , @xmath57 , @xmath50 , @xmath71 , @xmath66 , @xmath19 and @xmath72.,width=355 ]",
    "we have studied epidemic spread in a network of two communities with different average degrees .",
    "cases with and without disease avoidance rewiring were considered .",
    "rewiring rules were chosen so that the community structure would be preserved if links between susceptibles and infectives occurred uniformly throughout the network .",
    "the steady state bifurcation structure was obtained for static and adaptive cases .",
    "a mean field theory based on a moment closure approximation accurately predicted the steady state infection levels and network structure observed in stochastic simulations of the full model .",
    "in the static network case , weakly connected communities displayed significantly different infection levels .",
    "low infection levels could persist in a subthreshold community weakly connected to a high degree , high infection community . increasing the number of connections between communities led to more similar behavior of the two communities .",
    "in contrast , communities in adaptive networks displayed similar infection levels even if weakly connected .",
    "steady states with high infection in one community and low in the other did not exist for the adaptive network case .",
    "the absence of steady states with significantly different infection levels was explained by considering network adaptation in the presence of nonuniformly distributed si links .",
    "if one community has few infectives , there is a net flux of links into that community until its degree is high enough to support the infection .",
    "we estimated the time until this infection incursion based on mean field arguments and found that the time increases as the number of cross links between communities decreases .",
    "we also observed changes in the steady state network geometry due to adaptation in the presence of infection .",
    "these changes were most significant near bifurcation points .",
    "the adaptation tended to bring the average degrees of the communities closer to each other .",
    "thus the adaptation promotes greater similarity between communities in both network structure and infection levels .",
    "the model presented in this paper is the first to include community structure in epidemic spread on an adaptive network .",
    "future work is needed to extend the model to more realistic scenarios .",
    "for example , the number of communities could be increased beyond two .",
    "we have observed that the convergence time to steady state can be very long for weakly coupled communities , so it is possible that an epidemic would not reach steady state during physically realistic time scales .",
    "thus the transient behavior should also be studied in more detail .",
    "identifying when communities become at risk for incursion of infection could be valuable in knowing when epidemic control measures are needed .",
    "another area for future extension is to change the rules for adaptation , such as cutting or temporarily deactivating links rather than rewiring them .",
    "this work was supported by the army research office , air force office of scientific research , and by award number r01gm090204 from the national institute of general medical sciences .",
    "the content is solely the responsibility of the authors and does not necessarily represent the official views of the national institute of general medical sciences or the national institutes of health .",
    "for a single community ( @xmath68 ) , the mean field equations are : @xmath92 at steady state , we obtain @xmath93    to find the endemic steady state , we first solve [ [ eq : single_i ] ] for @xmath94 , and substitute into [ [ eq : single_si ] ]",
    ". then we solve [ [ eq : single_si ] ] for @xmath95 in terms of @xmath96 .",
    "after substituting that into [ [ eq : single_ss ] ] , we obtain a quadratic equation in @xmath96 , @xmath97 , where @xmath98 the quadratic can be solved analytically for @xmath96 , and then @xmath94 and the other link variables can be computed ."
  ],
  "abstract_text": [
    "<S> when an epidemic spreads in a population , individuals may adaptively change the structure of their social contact network to reduce risk of infection . here </S>",
    "<S> we study the spread of an epidemic on an adaptive network with community structure . </S>",
    "<S> we model the effect of two communities with different average degrees . </S>",
    "<S> the disease model is susceptible - infected - susceptible ( sis ) , and adaptation is rewiring of links between susceptibles and infectives . </S>",
    "<S> the bifurcation structure is obtained , and a mean field model is developed that accurately predicts the steady state behavior of the system . we show that an epidemic can alter the community structure . </S>"
  ]
}