{
  "article_text": [
    "even after more than hundred years since its introduction , brownian motion has remained a fundamental cornerstone of classical physics  @xcite .",
    "simple brownian motion and its variants have found numerous applications not just in natural sciences such as physics , chemistry , biology etc . , but also in man made subjects such as finance , economics , queueing theory , search processes , and computer science amongst others ( for reviews on the subject see  @xcite ) .",
    "some of these applications led to the studies of the statistical properties of simple variants of brownian motion , generally referred to as ` constrained brownian motion ' , i.e , a free brownian motion conditioned to satisfy certain prescribed global constraints ( see below for examples ) .",
    "more generally , one would also like to study other stochastic processes ( thus going beyond the simple brownian motion ) in presence of one or more such global constraints .",
    "an interesting and challenging problem is to find simple and efficient algorithms that generate these constrained paths , for brownian motion and other stochastic processes , with the correct statistical weight .",
    "many of the concepts presented in this article through a physical presentation , can be found in the mathematical literature , for example in  @xcite .    as a simple example ,",
    "let us first start with a _ free _ brownian motion @xmath1 in one dimension , starting from the origin @xmath2 .",
    "the time evolution of @xmath1 is governed by the simple langevin equation @xmath3 where @xmath4 is a gaussian white noise with zero mean @xmath5 and the correlator , @xmath6 ( @xmath7 being the diffusion constant ) .",
    "it is easy to generate a trajectory of this process numerically , simply by simulating the time - discretized version of the langevin equation @xmath8 where the noise @xmath9 is a standard normally distributed random variable with zero mean and unit variance , drawn independently at each discrete time step .",
    "three globally constrained variants ( amongst others ) of this simple @xmath10-d brownian motion that have been widely studied in the literature are the so called ( i ) brownian bridge ( ii ) brownian excursion and ( iii ) brownian meander that we discuss next",
    ".    0.3 cm    _ brownian bridge : _ a brownian bridge @xmath11 in @xmath12 is a brownian motion , starting at @xmath13 , that is constrained to come back to its starting point at a final time @xmath14 , i.e. , @xmath15 ( see fig .",
    "( [ bridge.fig ] a ) ) . a generalised",
    "brownian bridge corresponds to those configurations of brownian motions that start at @xmath16 and end at @xmath17 ( with @xmath18 fixed , not necessarily the same as the starting position @xmath19 ) at time @xmath14 ( see fig .",
    "( [ bridge.fig]b ) ) .    , and",
    "returning to @xmath15 at time @xmath14 ( b ) two configurations of a generalised brownian bridge starting at @xmath16 and ending at the final position @xmath17 at time @xmath14 ( @xmath18 fixed , but not necessarily zero).,title=\"fig : \" ]   , and returning to @xmath15 at time @xmath14 ( b ) two configurations of a generalised brownian bridge starting at @xmath16 and ending at the final position @xmath17 at time @xmath14 ( @xmath18 fixed , but not necessarily zero).,title=\"fig : \" ]    0.3 cm    _ brownian excursion : _ a brownian excursion @xmath20 in @xmath12 is a brownian motion that starts at @xmath21 , ends at @xmath22 ( as in a bridge ) , but additionally is constrained to stay positive in between , i.e. , for all @xmath23 ( see fig .",
    "( [ excursion.fig ] a ) for a typical excursion configuration ) .",
    "0.3 cm    _ brownian meander : _ a brownian meander @xmath24 is a brownian motion in @xmath25 $ ] , that starts at @xmath26 , is constrained to stay positive in the interval @xmath27 $ ] , but its final position @xmath28 is free , i.e. , can be any positive number . for a typical meander configuration ,",
    "( [ excursion.fig]b ) .",
    "$ ] , that starts at @xmath21 , ends at @xmath22 , and stays positive in the whole interval @xmath27 $ ] and ( b ) a typical configuration ( schematic ) of a brownian meander in the time interval @xmath25 $ ] , that starts at @xmath26 , stays positive in the time period @xmath25 $ ] , but its final position @xmath28 can be any positive number.,title=\"fig : \" ]   $ ] , that starts at @xmath21 , ends at @xmath22 , and stays positive in the whole interval @xmath27 $ ] and ( b ) a typical configuration ( schematic ) of a brownian meander in the time interval @xmath25 $ ] , that starts at @xmath26 , stays positive in the time period @xmath25 $ ] , but its final position @xmath28 can be any positive number.,title=\"fig : \" ]    a natural question is : how does one generate a constrained path such as a bridge , excursion or a meander numerically with the correct statistical weight ? let us start with the example of a simple brownian bridge @xmath11 over @xmath25 $ ] with the constraint @xmath29 : how does one generate such a bridge ? a naive algorithm would be to generate all possible configurations of a free brownian motion over @xmath25 $ ] via the discretized langevin equation starting from the origin and retain only those that do return to the origin at @xmath14 .",
    "evidently , such a naive algorithm is too wasteful and would not lead to correct statistics for a finite number of samples . for the brownian",
    "bridge , there is a however simple way out .",
    "one first generates a free brownian path @xmath1 via starting from @xmath2 and from this path , one constructs a new path @xmath11 via the following simple construction @xmath30\\ , .",
    "\\label{bridge_alg.1}\\ ] ] by construction @xmath11 in satisfies the bridge condition @xmath29 .",
    "in addition , by computing the propagator for the constructed process @xmath11 , it is easy to show that indeed @xmath11 has the correct statistical weight of a brownian bridge .",
    "similarly , one can generate an excursion @xmath31 , satisfying @xmath32 and @xmath31 remaining positive in between , from a bridge configuration @xmath11 via the so called vervaat construction  @xcite which proceeds as follows .",
    "first , we construct a bridge @xmath11 from a free brownian path using .",
    "let @xmath33 denote the time at which the bridge @xmath11 achieves its minimum value say @xmath34 ( see fig .",
    "( [ vervaat_fig ] ) ) .",
    "we divide the full time interval @xmath25 $ ] into two subintervals @xmath35 $ ] and @xmath36 $ ] .",
    "next we take the portion of the bridge path @xmath11 in @xmath35 $ ] and slide it in the forward time direction by an interval @xmath14 [ as shown in fig .",
    "( [ vervaat_fig ] ) ] and paste it to the other side of the rest of @xmath11 in the second subinterval @xmath36 $ ] . due to the periodicity of the bridge ,",
    "the newly slided and pasted section of the bridge will join smoothly with the part over @xmath36 $ ] .",
    "next , we shift the origin to @xmath34 , and the resulting process over the new time - interval @xmath37 $ ] is an excursion over @xmath25 $ ] . in other words , from the bridge @xmath11 , we construct the excursion @xmath31 via the construction @xmath38\\ ,   \\label{excur_alg.1}\\ ] ] where by periodicity @xmath39 . by construction in , @xmath32 and @xmath40 for all @xmath23 .",
    "moreover , vervaat proved rigorously that the construction in indeed generates a brownian excursion with the correct statistical weight  @xcite .     with @xmath29 ( left side ) .",
    "the bridge achieves its minimum value @xmath34 at time @xmath33 ( shown by the dashed vertical line ) .",
    "divide the interval @xmath25 $ ] into two subintervals @xmath35 $ ] ( blue ) and @xmath36 $ ] ( red ) .",
    "slide the left ( blue ) subinterval in the forward time direction by an amount @xmath14 ( shown by the ( green ) arrow ) and join it to the right of the subinterval @xmath41 $ ] . now shift the @xmath42 axis so that @xmath34 denotes the new origin .",
    "this newly constructed cut and paste bridge configuration over @xmath43 $ ] is indeed an excursion @xmath31 over the time interval @xmath25 $ ] . ]",
    "another simpler way to generate a brownian excursion is to consider three independent brownian bridges @xmath44 , @xmath45 and @xmath46 and then construct a new process @xmath47 ^ 2 + [ x_{b,2}(t)]^2 + [ x_{b,3}(t)]^2}\\ , , \\label{excur_alg.2}\\ ] ] which just represents the radial part of a @xmath48-dimensional brownian bridge ( @xmath48-d bessel bridge ) .",
    "this new process can be rigorously shown to have the correct statistical weight of a one dimensional brownian excursion  @xcite .",
    "similarly , a brownian meander @xmath24 in one dimension , starting at @xmath26 and ending at @xmath49 can be generated from a @xmath48-dimensional bessel bridge by the following construction  @xcite @xmath50 ^ 2 + [ x_{b,2}(t)]^2 + [ x_{b,3}(t ) + \\frac{t}{t_f}\\ , x_f ] ^2 } \\ , .",
    "\\label{meander_alg.1}\\ ] ] for a nice review on the connection between bridges , excursions and meanders , see  @xcite and for recent applications of such constrained paths , see  @xcite .    these clever transformations connecting bridges , excursions and meanders to free brownian motion are , of course , very efficient to generate them numerically .",
    "however , these transformations rely on the specific properties of a free brownian motion and will , in general , not hold for a more general process such as a particle diffusing in an external potential . moreover",
    ", one may want to generate paths which are not simply bridges , excursions or meanders , but constrained in some other way .",
    "for example , in many applications in computer science , one needs to generate , say a brownian excursion @xmath31 over @xmath27 $ ] with a fixed area under the excursion @xmath51  @xcite .",
    "hence , it would be much more desirable to build a recipe to construct an effective langevin equation like which ( i ) will automatically take into account the global constraints and ( ii ) will hold for more general stochastic processes such as a particle diffusing in an external potential .",
    "once we have such a recipe for an effective langevin equation , it can subsequently be easily time - discretized leading to an efficient method to generate constrained paths .",
    "the purpose of this paper is to provide precisely such a recipe and demonstrate it with several examples .",
    "some of the results to be discussed in this paper were probably known , at least partially , in the probability literature but in a language perhaps not easily accessible to physicists .",
    "one of the purposes of this paper is to unveil the recipe for an effective langevin equation in a physicist friendly language .",
    "for a recent review on some aspects of constrained stochastic processes , namely , constraints on large deviations of a stochastic variable , see  @xcite .",
    "the rest of the paper is organized as follows : we first derive the effective langevin equation which satisfies the boundary constraint .",
    "we then illustrate the method on four analytically soluble cases , namely the brownian bridges , brownian meanders , brownian excursions and the ornstein - uhlenbeck process .",
    "we then show how this equation can be solved exactly numerically in the case of any landscape potential @xmath52 .",
    "from now on , we assume that the system is driven by a force @xmath53 and is subject to stochastic dynamics in the form of an overdamped langevin equation .    for the sake of simplicity ,",
    "we illustrate the method on a one - dimensional system , the generalization to higher dimensions or larger number of degrees of freedom being straightforward .",
    "we follow closely the presentation given in ref .",
    "@xcite .",
    "the over damped langevin equation reads    @xmath54    where @xmath55 is the position of the particle at time @xmath56 , driven by the force @xmath53 , @xmath57 is the friction coefficient , related to the diffusion constant @xmath7 through the einstein relation @xmath58 , where @xmath59 is the boltzmann constant and @xmath60 the temperature of the thermostat .",
    "in addition , @xmath4 is a gaussian white noise with moments given by    @xmath61    @xmath62    the probability distribution @xmath63 for the particle to be at point @xmath42 at time @xmath56 satisfies a fokker - planck equation @xcite    @xmath64    where @xmath65 is the inverse temperature .",
    "this equation is to be supplemented by the initial condition @xmath66 , where the particle is assumed to be at @xmath19 at time @xmath67 . to emphasize this initial condition",
    ", we will often use the notation @xmath68 .",
    "we now study the probability over all paths starting at @xmath69 at time @xmath70 and conditioned to end at a given point @xmath71 at time @xmath0 , to find the particle at point @xmath42 at time @xmath72 $ ] .",
    "this is the",
    "_ generalized bridge_. this probability can be written as @xmath73 where we use the notation @xmath74",
    "@xmath75    indeed , the probability for a path starting from @xmath76 and ending at @xmath77 to go through @xmath42 at time @xmath56 is the product of the probability @xmath78 to start at @xmath76 and to end at @xmath79 by the probability @xmath80 to start at @xmath79 and to end at @xmath77 .",
    "the equation satisfied by @xmath81 is the fokker - planck equation mentioned above ( [ eq : fp ] ) , whereas that for @xmath82 is the so - called reverse or adjoint fokker - planck equation @xcite given by    @xmath83    it can be easily checked that the conditional probability @xmath84 satisfies a new fokker - planck equation    @xmath85    comparing this equation with the initial fokker - planck ( [ eq : fp ] ) and langevin ( [ eq : langevin ] ) equations , one sees that it can be obtained from a langevin equation with an additional potential force    @xmath86    this equation has been originally obtained by doob @xcite in the probability literature and is known as the doob transform of the langevin equation ( [ eq : langevin ] ) .",
    "it was also presented in the physics literature in the context of barrier crossing @xcite .",
    "it provides a simple recipe to construct a _",
    "generalized bridge_. it generates brownian paths , starting at @xmath87 conditioned to end at @xmath88 , with unbiased statistics .",
    "it is the additional term @xmath89 in the langevin equation that guarantees that the trajectories starting at @xmath90 and ending at @xmath88 are statistically unbiased .",
    "note that this additional term is a priori time dependent , and thus the effective force which conditions the paths is space and time dependent . in the following",
    ", we will specialize to the case where the force @xmath91 is derived from a potential @xmath52 .",
    "the bridge equation becomes @xmath92    in that case , the fokker - planck equation can be recast into an imaginary time schrdinger equation @xcite , and the probability distribution function @xmath81 can be written as @xmath93 where the `` quantum hamiltonian '' @xmath94 is defined by @xmath95 and the potential @xmath96 by @xmath97    we denote by @xmath98 the matrix element of the euclidian schrdinger evolution operator    @xmath99    using eq.([eq : matrix ] ) for @xmath82 , one can write equation ( [ eq : bridge2 ] ) as    @xmath100    we see on the above form that when @xmath101 , the matrix element @xmath102 converges to @xmath103 , and it is this singular attractive potential which drives all the paths to @xmath18 at time @xmath14 .    note that for large time @xmath0 , @xmath102 is dominated by the ground state of @xmath94 , namely @xmath104    it is well known that the ground state wave function of @xmath94 is @xmath105 where @xmath106 is the normalization constant . indeed , it is easily checked that @xmath107 which implies that @xmath108 is an eigenstate of @xmath94 with ground state energy @xmath109 . inserting these relations in eq.([eq : bridge3 ] ) , one recovers , as expected , the original unconditioned langevin equation for large time @xmath14 .",
    "note that although relation ( [ gs ] ) holds only for a normalizable ground state wave function @xmath110 , it still yields the correct langevin equation ( [ eq : langevin ] ) for non - normalizable cases ( such as the free brownian motion @xmath52=0 , for which @xmath109 and @xmath111 where @xmath96 is the volume ) .    in order to build a representative sample of paths starting at @xmath90 and ending at @xmath112 one",
    "must simply solve equation ( [ eq : bridge2 ] ) for many different realizations of the random noise .",
    "only the initial boundary condition is to be imposed , as the singular term in the equation imposes the correct final boundary condition .",
    "an important point to note is that all the trajectories generated by this procedure are statistically independent .    at this stage",
    ", we see that all the difficulty lies in calculating either the green s function @xmath113 or the matrix element @xmath102 . in general ,",
    "this is not possible analytically except for a few special cases . in ref.@xcite , a short time approximation to compute @xmath102",
    "was presented , but in the following , we specialize on a few exactly analytically solvable cases .",
    "the simplest case is the case of a free particle in unrestricted space . in that case , the green s function @xmath113 can be easily computed and yields @xmath114 the corresponding conditioned langevin equation becomes @xmath115    this equation can be found in @xcite .",
    "it is completely universal as the drift term does not depend on the diffusion constant @xmath7 .",
    "we show in fig.([fig1 ] ) a set of 500 trajectories starting at @xmath116 at time @xmath70 and ending at @xmath117 at time @xmath118 , obtained for different noise histories .",
    "the time step used in the discretization is @xmath119 .",
    "all these trajectories are statistically independent .",
    "the thick black curve is the mean trajectory . as can be seen from eq.([free ] ) , it is a straight line .",
    "the brownian meander is a brownian path of a free particle in a half - space . in other words , the brownian particle can not penetrate in one of the half - planes . in 1d , if we define the half - space as @xmath120 , the particle can not go into the @xmath121 subspace . here",
    "the meander @xmath24 starts , say at the origin @xmath122 , ends at @xmath123 , while staying positive in @xmath27 $ ] .",
    "for the special case where both the initial and the final position tend to zero , the meander is called an excursion @xmath31 . these constrained",
    "brownian paths have been shown to be relevant to the anomalous diffusion of cold atoms in optical lattices @xcite .    in the case of a general meander ,",
    "the green s function @xmath113 is that of a particle restricted to a half space .",
    "this green s function is well known and can be calculated by using the method of images . in the case",
    "when the end point is fixed at @xmath18 at time @xmath14 we obtain @xmath124    if the end point @xmath18 at @xmath14 can be anywhere in the 1/2 plane @xmath125 , the green s function above has to be further integrated for @xmath126 $ ] to obtain @xmath127 where @xmath128 .",
    "the corresponding langevin equation for the meander then reads @xmath129    the case of a brownian excursion , where the extremity @xmath18 is fixed , is generated by the langevin equation @xmath130    taking @xmath131 , one obtains the effective langevin equation for an excursion @xmath132    this equation can be found in ref.@xcite .",
    "again , these two equations ( [ meander ] ) and ( [ excursion ] ) can be solved easily by discretizing time .",
    "we show in fig.([fig2 ] ) a set of 500 statistically independent meanders starting at @xmath133 at time @xmath70 and ending anywhere in the upper half plane at time @xmath118 .",
    "similarly , we show in fig.([fig3 ] ) a set of 500 statistically independent excursions starting at @xmath134 at time @xmath70 and ending at @xmath135 at time @xmath118 . in all cases ,",
    "the independent trajectories are obtained for different noise histories and time step @xmath119 .",
    "note that generating an excursion by eq .",
    "( [ excursion ] ) is evidently much simpler than generating it by the vervaat construction  @xcite discussed in the introduction .",
    "another solvable case is that of the harmonic oscillator @xmath136 . the unconditioned langevin equation is @xmath137 this is a so - called ornstein - uhlenbeck process @xcite .",
    "the matrix element @xmath102 associated to this potential can be computed easily and one obtains @xmath138 where @xmath139 and @xmath106 is a normalization constant .",
    "the associated conditioned langevin equation is thus @xmath140 which was obtained in @xcite .",
    "note that this equation is invariant when changing @xmath141 into @xmath142 and thus we have this surprising result that paths going up a barrier are statistically identical to those going down a barrier . to illustrate this apparent paradox",
    ", we show in fig.([fig4 ] ) a set of 500 trajectories starting at @xmath116 at time @xmath70 and ending at @xmath135 at time @xmath118 , obtained for different noise histories with @xmath119 .",
    "the simulation was performed at temperature @xmath143 with @xmath144 .",
    "there are very few cases which are analytically solvable and we thus now discuss the generic non - solvable case . in order to compute the central quantity @xmath102",
    ", we perform a spectral expansion @xcite @xmath145 where @xmath146 is the eigenstate of @xmath94 with eigenvalue @xmath147 @xmath148    note that although this spectral expansion is in principle valid only for normalizable eigenstates , it can easily be extended to the non - normalizable case by taking the limit of infinite volume .",
    "the bridge equation ( [ eq : bridge3 ] ) becomes @xmath149 where we have used @xmath150 .    in order to be able to solve this equation numerically ( by discretization for instance )",
    ", one has to compute the eigenstates @xmath146 and eigenvalues @xmath147 of the hamiltonian @xmath94 . in the case of low - dimensional system , this can be done very easily by diagonalizing the discretized hamiltonian @xmath94 which turns out to be a tridiagonal operator .",
    "we illustrate the above method on the example of barrier crossing in 1d ( quartic potential ) .",
    "@xmath151    this potential has two minima at @xmath152 , separated by a barrier of height 1/4 .",
    "note that @xmath153 is much steeper than @xmath52 and thus more confining around its minima . at low temperature , the potential @xmath154 has two minima at points close to @xmath155 and one minimum at @xmath156 .",
    "the ground state of the hamiltonian is @xmath157 .",
    "the hamiltonian is diagonalized by discretizing space and writing it in the form of a tridiagonal matrix .",
    "the diagonalization is performed using programs specific to tridiagonal matrices .",
    "all the examples were performed at low temperature @xmath158 , where the barrier height is equal to 5 in units of @xmath159 and the kramers relaxation time , given by the inverse of the smallest non - zero eigenvalue of @xmath94 , is equal to @xmath160 .    on fig.[fig88 ] , we present a long trajectory ( @xmath161 obtained by solving the unconditioned langevin eq.([eq : langevin ] ) for a particle starting at @xmath162 at time 0 .",
    "the general pattern is that of the particle staying in one of the wells for a long time , then crossing very rapidly into the other well and back and forth . if one is interested more precisely in the transition region , our method allows to perform the simulation of the rare crossing events between the two wells and generate a large sample of statistically independent paths in this transition region .    in fig.[fig8 ] , we show a set of 500 trajectories starting at @xmath116 at time @xmath70 and ending at @xmath117 at time @xmath163 , obtained for different noise histories with @xmath119 .        in fig.[fig9 ] , we show a longer trajectory starting at @xmath116 at time @xmath70 and ending at @xmath117 at time @xmath164 with @xmath119 .",
    "we have presented in this paper a novel method in physics to generate paths satisfying the langevin overdamped dynamics , starting from an initial point and conditioned to end at a given final point at a given time .",
    "one of the great advantages of this method is that trajectories are generated by a modified langevin equation and are all statistically independent . in this paper , we emphasized applications to analytically solvable models , such as bridges , meanders , excursions , ornstein - uehlenbeck processes , etc . in a forthcoming work , we will show how to generate paths with additional constraints , such as fixed area under the curve , fixed dissipation , etc .",
    "we thank the hospitality of the galileo galilei institute ( florence ) during the workshop ",
    "advances in nonequilibrium statistical mechanics : large deviations and long - range correlations , extreme value statistics , anomalous transport and long - range interactions \" ( may - june , 2014 ) , where this work was initiated .",
    "j. l. doob , bull .",
    "france * 85 * ( 1957 ) , 431 - 458 ; p. fitzsimmons , j. pitman and m. yor , seminar on stochastic processes : markovian bridges : construction , palm interpretation , and splicing ( 1992 ) 101 - 134 ."
  ],
  "abstract_text": [
    "<S> we propose a novel stochastic method to exactly generate brownian paths conditioned to start at an initial point and end at a given final point during a fixed time @xmath0 . </S>",
    "<S> these paths are weighted with a probability given by the overdamped langevin dynamics . </S>",
    "<S> we show how these paths can be exactly generated by a local stochastic differential equation . </S>",
    "<S> the method is illustrated on the generation of brownian bridges , brownian meanders , brownian excursions and constrained ornstein - uehlenbeck processes . </S>",
    "<S> in addition , we show how to solve this equation in the case of a general force acting on the particle . as an example </S>",
    "<S> , we show how to generate constrained path joining the two minima of a double - well . </S>",
    "<S> our method allows to generate statistically independent paths , and is computationally very efficient . </S>"
  ]
}