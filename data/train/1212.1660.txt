{
  "article_text": [
    "currently it is not known whether there exists a single closed billiard trajectory in every obtuse triangle ( see  @xcite for some progress in this direction and for further references ) . the situation with billiards in _",
    "rational _ polygons ( that is in polygons with angles which are rational multiples of @xmath1 ) is understood much better : trajectories of such billiards are related to geometry of certain compact flat surfaces with conical singularities , which are thoroughly studied starting with the landmark papers of h.  masur  @xcite and w.  veech  @xcite . in particular , it is known that a billiard in any rational polygon has infinitely many closed trajectories  @xcite , and furthermore the number of trajectories of length at most @xmath2 is bounded between @xmath3 and @xmath4 for some @xmath5 and for @xmath2 large enough , see @xcite and @xcite .    in the current paper",
    "we study families of right - angled billiards like the ones in figure  [ fig : family : of : rectangular : polygons ] .",
    "namely , we assume that the billiard table is a topological disk endowed with a flat metric , and that the boundary of the disk is piecewise geodesic such that the angle at every corner of the boundary is an integer multiple of @xmath6 .",
    "we consider families of polygons sharing the same interior corner angles @xmath7 .",
    "actually , it will be convenient to consider a slightly larger space @xmath8 of `` directional billiards '' distinguishing a billiard table @xmath9 and the same table turned by angle @xmath10 .",
    "the measure in the space @xmath11 is the product measure of lebesgue measure arising from the side lengths and the angular measure @xmath12 .",
    "( 0,0)(0,13 ) ( -171,-62)@xmath13 ( -27,-61)@xmath14 ( 18,-66)@xmath13 ( 164,11)@xmath14    we count the number of generalized diagonals of bounded length in such billiards ( that is , the number of trajectories of bounded length which start in some fixed corner @xmath13 and arrive to some fixed corner @xmath14 , see figure  [ fig : family : of : rectangular : polygons ] ) and the number of closed billiard trajectories of bounded length .",
    "note , that closed regular trajectories are never isolated in rational billiards : they always form bands of `` parallel '' closed trajectories of the same length , see figure  [ fig : family : of : rectangular : polygons ] .",
    "thus , when counting closed trajectories one actually counts the number of such bands . sometimes , it is natural to count the bands with a weight which registers the thickness of the band , see e.g. theorem  [ theorem : narea : weak : asymp ] at the end of  [ sec : subsec : introduction : beginning ] . by convention",
    "we always count _ non - oriented _ generalized diagonals and _ non - oriented _ closed billiard trajectories .    to give an idea of the general theorems stated in detail in  [ sec : configurations : counting ] and developed in ",
    "[ sec : siegel : veech ] , we present the following repersentative results .    [",
    "theorem : pi:2:general ] for any right - angled billiard @xmath9 outside of a zero measure set in any family @xmath15 the number @xmath16 of generalized diagonals of length at most @xmath2 joining a pair of fixed corners @xmath17 with angles @xmath6 has the following quadratic asymptotics as @xmath18 : @xmath19    theorem  [ theorem : pi:2:general ] is proved in   [ sec : subsec : sv : pocket ] , using the theorem proved by jon chaika in appendix  [ sec : chaika ] .    the fact that this asymptotics does not depend at all on the billiard table is at the first glance counterintuitive .",
    "what is even more surprising is that it is universal : it is the same not only for almost all billiard tables inside each family , but it does not vary even from one family to another ! in particular , though the shape of the two polygons of the same area in figure  [ fig : family : of : rectangular : polygons ] is quite different , the number of trajectories of length at most @xmath2 joining the right - angle corner @xmath13 to the right - angle corner @xmath14 is approximately the same in both cases , and is approximately the same as the number of trajectories of length at most @xmath2 joining two corners of the usual rectangular billiard of the same area when @xmath20 .",
    "the situation becomes more complicated when we consider other types of corners of the billiard .",
    "consider , for example , an @xmath21-shaped billiard table as on figure  [ fig : l : shaped : billiard ] .",
    "let @xmath22 be the right - angle corners of the @xmath21-shaped billiard , and let @xmath23 be the corner with the interior angle @xmath24 .",
    "( 0,0)(0,0 ) ( -64,-65)@xmath25 ( -64,-4)@xmath26 ( -16,-4)@xmath27 ( -16,-25)@xmath23 ( 46,-25)@xmath28 ( 46,-65)@xmath29    [ theorem : l : shaped : almost : all ] for almost any @xmath21-shaped billiard @xmath9 the number @xmath30 of generalized diagonals of length at most @xmath2 joining a fixed corner @xmath13 with angle @xmath6 and the corner @xmath23 with angle @xmath24 has the following quadratic asymptotics as @xmath18 : @xmath31    the proof of this theorem also relies in part on theorem  [ theorem : bikhoff : chaika ] proved by jon  chaika in appendix  [ sec : chaika ]",
    ".    the naive intuition does not help : the angle @xmath24 at the corner @xmath23 is _ three _ times larger than in the previous case , while the constant in the asymptotics for the number of generalized diagonals is _ four _ times larger than in the previous statement .",
    "currently we have no idea how to obtain this factor @xmath32 without using techniques of the teichmller geodesic flow , lyapunov exponents of the hodge bundle , and the computation of volumes of the moduli spaces of meromorphic quadratic differentials with at most simple poles on @xmath0 .",
    "theorem  [ theorem : l : shaped : almost : all ] is proved in  [ sec : subsec : sv : typei ] .    using recently developed technology",
    ", one can prove weak asymptotic formulas similar to theorem  [ theorem : pi:2:general ] and theorem  [ theorem : l : shaped : almost : all ] for individual billiard tables .",
    "in particular , the following holds :    [ theorem : l : shaped : precise ] suppose @xmath9 is an @xmath21-shaped billiard table as in figure  [ fig : l : shaped : billiard ] .",
    "let @xmath33 then ,    * if @xmath34 and @xmath35 are both rational , or if there exists a non - square integer @xmath36 such that @xmath37 and @xmath38 ( where @xmath39 is the galois conjugate of @xmath35 ) , then @xmath40 * for any other @xmath21-shaped billiard table , we have the `` weak asymptotic formulas '' @xmath41 and @xmath42 the meaning of the  weak asymptotic @xmath43 is defined in  [ sec : subsec : counting : theorems ] .    in the case ( i )",
    "the siegel ",
    "veech constants @xmath44 for rational values of parameters @xmath45 can be computed by the formula due to e.  gutkin and c.  judge  @xcite . for @xmath46 and @xmath47",
    "the constants @xmath44 are computed by m.  bainbridge , see ( * ? ? ?",
    "* theorem 1.5 and  14 ) .",
    "theorem  [ theorem : l : shaped : precise ] is a compilation of several different results . in case ( i ) , the polygon @xmath9 is a veech polygon , which gives rise to a teichmller curve , see  @xcite , @xcite .",
    "the existence of an asymptotic formula such as ( [ eq : bainbridge ] ) for such a situation was proved in the pioneering work of w.  veech @xcite .",
    "let @xmath48 the fact that weak asymptotic formulas such as those of part ( ii ) hold for any rational billiard table follows from  ( * ? ? ?",
    "* theorem  2.12 ) , which uses the general invariant measure classification theorem of  @xcite for the action of @xmath49 on moduli space .",
    "however , to evaluate the constant for an arbitrary @xmath21-shaped table , one also has to appeal to the explicit classification of @xmath50-invariant affine submanifolds in the moduli space of abelian differentials in genus @xmath51 due to , @xcite .",
    "we note that asymptotic counting formulas for individual billiards are associated with invariant measure classification theorems on the action of subgroups of @xmath50 on ( certain subsets of ) the moduli space .",
    "in particular , when a measure classification theorem for the action of the subgroup @xmath52 exists ( e.g. in the case of a teichmller curve ) , one can get a strong asymptotic formula .",
    "also , a measure classification theorem for the action of the subgroup @xmath49 leads to a weak asymptotic formula .    for other examples when a classification of invariant measures for the action of @xmath52 ( and thus strong asymptotic formulas )",
    "are known see @xcite , @xcite , @xcite , @xcite .",
    "all examples of individual billiard tables for which the ( strong ) quadratic asymptotics was known are , essentially , covered by several families of triangles depending on one integer parameter ; by several sporadic triangles beyond these families ; by a square with a specially located barrier ; and by a family of @xmath21-shaped tables with or without a wall for special values of parameters of the @xmath21-shaped table .",
    "in   [ sec : subsec : counting : theorems ] for each family @xmath53 of right - angled billiards we describe all geometric types of generalized diagonals and all closed billiard trajectories which can be found on a billiard @xmath9 outside of a zero measure set in @xmath53 . for such @xmath9 , and each such geometric type we prove ( strong ) quadratic asymptotics for the number of associated generalized diagonals ( or of bands of closed billiard trajectories ) , and explicitly evaluate the constant in the quadratic asymptotics .",
    "theorem  [ theorem : labyrinth ] below illustrates an application of the general theorem  [ theorem : invididual : billiards ] and of the general theorems  [ th : sv : i][th : sv : iv ] to billiards more complicated than the @xmath21-shaped ones , see figure  [ fig : b44:33 ] .    by @xmath54",
    "we denote the family of right - angled billiards with @xmath55 corners with angles @xmath56 ( endpoints of the walls ) ; @xmath57 corners with interior angles @xmath58 , and with the remaining @xmath59 corners with interior angles @xmath60 .    [",
    "theorem : labyrinth ] consider two distinct corners @xmath61 of a billiard @xmath9 in any family @xmath54 .",
    "assume that at least one of the interior angles @xmath62 and @xmath63 is different from @xmath60 ( i.e. @xmath64 are not simultaneously equal to @xmath65 ) .    for almost any @xmath9 ,",
    "any generalized diagonal @xmath66 joining @xmath13 to @xmath14 and non parallel to a side of @xmath9 never bounds a band of closed trajectories .",
    "no other generalized diagonal in @xmath9 has a segment parallel to any segment of @xmath66 . for almost any @xmath9 , the number @xmath16 of such generalized diagonals of length at most @xmath2 has the following asymptotics as @xmath67 : @xmath68 where the constant @xmath44 depends only on the angles @xmath62 and @xmath63 at @xmath13 and @xmath14 correspondingly ; its value is presented in the following table : @xmath69\\\\ \\hline \\cfrac{4\\pi}{2}&\\cfrac{9}{10 }    & \\cfrac{45}{64 }       & \\cfrac{9}{32}\\\\ [ -\\halfbls]\\\\ \\cfrac{3\\pi}{2}&\\cfrac{45}{64 }   & \\cfrac{16}{3\\pi^2 }   & \\cfrac{2}{\\pi^2}\\\\ [ -\\halfbls]\\\\ \\cfrac{\\pi}{2 } & \\cfrac{9}{32 }    & \\cfrac{2}{\\pi^2 }     & \\cfrac{1}{2\\pi^2 } \\end{array}\\ ] ]    note that the values of the constants do not depend neither on the numbers @xmath57 or @xmath55 of corners , nor on the particular shape of the billiard .",
    "the proof of this theorem also relies in part on theorem  [ theorem : bikhoff : chaika ] proved by jon  chaika in appendix  [ sec : chaika ] .",
    "we complete this section with an illustration of further counting problems where one can apply our techniques .",
    "let @xmath70 denote the number of bands of closed periodic billiard trajectories of length at most @xmath2 counted with a weight given by the normalized area of the band .",
    "more precisely , we count the area of overlapping domains of the band twice : the area of the band is naively measured as the area of the associated cylinder on the flat sphere , that is , the width of the band times the length of the closed trajectory , normalized by the area of the billiard table .",
    "having measured the area of the band , we divide it by the area of the billiard table to get the weight of the band .    [",
    "theorem : narea : weak : asymp ] for any billiard @xmath9 in any family @xmath11 of right - angled billiards the weighted number @xmath70 of bands of closed billiard trajectories of length at most @xmath2 satisfies the following weak asymptotics as @xmath18 : @xmath71 for almost any billiard @xmath9 in the same family , the asymptotics is , actually , exact : @xmath72    theorem  [ theorem : narea : weak : asymp ] is proved in   [ sec : point : weak ] , using jon chaika s theorem  [ theorem : bikhoff : chaika ] which is proved in appendix  [ sec : chaika ] .",
    "the constant in the corresponding counting function is directly related to the _ siegel  veech area constant _ for the corresponding stratum of meromorphic quadratic differentials on @xmath0 discussed in  [ sec : subsec : intro : volumes ] .      given a right - angled billiard @xmath9 in @xmath11",
    "we can glue a topological sphere from two superposed copies of @xmath9 identifying the boundaries of the two copies by isometries , see figure  [ fig : billiard : and : sphere ] . by construction the resulting topological sphere",
    "is endowed with a flat metric .",
    "note that the metric is regular on interior of the segments coming from the boundary of @xmath9 : one can unfold a neighborhood of any such point into a small regular flat domain",
    ".    however , the resulting flat metric has conical singularities with cone angles @xmath73 at the points coming from the vertices of @xmath9 . by construction",
    "the linear holonomy of the flat metric with isolated singularities belongs to the group @xmath74 : the parallel transport along a short path encircling a conical point @xmath14 brings a tangent vector @xmath75 either to itself or to @xmath76 depending on the parity of @xmath77 .",
    "it is known that a flat metric with isolated conical singularities and with holonomy in @xmath74 on a closed surface defines a complex structure and a meromorphic quadratic differential @xmath78 in this complex structure defined up to multiplication by a scalar @xmath79 . choosing a line direction @xmath80 at some point of the resulting flat sphere as a `` horizontal '' direction we fix the scalar @xmath79 . in an appropriate flat local coordinate @xmath81 outside of the conical points",
    "the resulting quadratic differential has the form @xmath82 .",
    "a conical singularity with a cone angle @xmath83 corresponds to a zero of the quadratic differential of degree @xmath84 , where a `` zero of degree @xmath85 '' is a simple pole .",
    "actually , the two structures are synonymous : a meromorphic quadratic differential @xmath78 with at most simple poles on a riemann surface defines a canonical flat metric with isolated conical singularities , with linear monodromy in @xmath74 and with a distinguished foliation by straight lines in the flat metric ( see the original papers  @xcite and  @xcite or surveys  @xcite and  @xcite ) .    by construction",
    "closed billiard trajectories in @xmath9 are in canonical one - to - two correspondence with closed regular geodesics on the associated flat sphere , and generalized diagonals on @xmath9 are in the natural one - to - two correspondence with the _ saddle connections _ on the associated flat sphere , see figure  [ fig : billiard : and : sphere ] .",
    "thus , the two counting problems are closely related .",
    "it is known by work of veech  @xcite and of eskin - masur  @xcite that almost all flat spheres in a given stratum @xmath86 satisfy a quadratic asymptotic formula for the number of saddle connections .",
    "however , we can not immediately translate this result to right - angled billiards .",
    "an elementary count shows that the space @xmath11 has _ real _",
    "dimension @xmath87 , while the associated stratum @xmath88 has _ complex _ dimension @xmath87 .",
    "thus , flat spheres constructed from right - angled billiards form a subset of measure zero , and `` almost all '' results for the strata are not applicable to families of billiards .",
    "this is the common difficulty of translating results valid for flat surfaces to billiards .    in our specific case",
    "we are lucky enough to get a subspace of flat spheres `` of billiard origin '' which is transversal to the unstable foliation of the teichmller flow ( see  [ sec : billiards : qd ] ) .",
    "this allows us to apply certain techniques of hyperbolic dynamics to obtain some ergodic results in slightly weaker form . as a corollary",
    "we obtain the desired information on quadratic asymptotics in the counting problems for almost all billiards .",
    "the corresponding ergodic technique is presented in  [ sec : ergodic ] .",
    "a key tool we use is theorem  [ theorem : bikhoff : chaika ] proved by jon chaika in appendix  [ sec : chaika ] .",
    "we start by solving the counting problems for quadratic differentials .",
    "the siegel  veech constant @xmath89 responsible for the exact quadratic asymptotics of the weighted number of bands of regular closed geodesics on almost any flat sphere in a given stratum @xmath90 of meromorphic quadratic differentials with at most simple poles on @xmath0 was recently computed in  @xcite , @xmath91 developing techniques elaborated in  @xcite for the strata of abelian differentials and using the further results from  @xcite and  @xcite on the _ principal boundary _ of the strata of quadratic differentials we express the siegel  veech constant @xmath89 in terms of the ratio of the volumes of appropriate strata , @xmath92 in this way we obtain a series of identities on the volumes of the strata of meromorphic quadratic differentials with at most simple poles in genus zero .",
    "the resulting identities recursively determine the volumes of all strata .",
    "this allows us to find the volumes of all strata of meromorphic quadratic differentials with at most simple poles in genus @xmath93 .",
    "define the function on integers @xmath57 greater than or equal to @xmath85 as @xmath94 for @xmath95 . here",
    "the double factorial @xmath96 is the product of all even ( respectively odd ) positive integers smaller than or equal to @xmath57 . by convention we set @xmath97 which implies that @xmath98    [ theorem : volume ] the volume of any stratum @xmath99 of meromorphic quadratic differentials with at most simple poles on @xmath0 ( i.e. @xmath100 for @xmath101 , and @xmath102 ) is equal to @xmath103 ( where all the zeroes and poles are `` named '' .",
    ")    this formula for the volume ( up to some normalization factor ) was conjectured by m.  kontsevich about ten years ago .",
    "it is much simpler then the formula for the volumes of the strata of abelian differentials found by a.  eskin and  @xcite . for the case of strata of quadratic differentials in higher genus",
    "no explicit formula for the volumes is currently known ( even though some calculations are possible using @xcite ) .",
    "the proof of theorem  [ theorem : volume ] , given in  [ sec : induction ] , consists in verifying that the expression   for the volume satisfies the combinatorial identities implied by   and  .",
    "part of this verification is performed in appendix  [ sec : appendix : identity ] .",
    "note that the convention that all zeroes and poles are `` named '' affects the normalization : we compute the volumes of the corresponding covers over strata with `` anonymous '' singularities .",
    "for example , the stratum @xmath104 of quadratic differentials with `` anonymous '' zeroes and poles is isomorphic to the stratum @xmath105 of holomorphic abelian differentials ; by convention the volume elements are chosen to be invariant under this isomorphism . however , by   we have @xmath106 which corresponds to @xmath107 ways to _ give names _ to five simple poles .",
    "similarly , @xmath108 this time there is an extra factor @xmath109 responsible for _ forgetting the names _ of the two zeroes of @xmath110 .",
    "one of the ways to compute the volumes of the strata of abelian or quadratic differentials ( actually , the only one before the current paper ) is to count _ square - tiled surfaces _ or _ pillowcase covers _ , see  @xcite , @xcite , @xcite , @xcite . in the current paper",
    "we follow an alternative method , and , thus , our result implies an explicit expression for the leading term of the function counting associated pillowcase covers , when the degree of the cover tends to infinity .",
    "namely , following  @xcite we define a _ pillowcase cover _ of degree @xmath111 as a ramified cover @xmath112 over the pillowcase orbifold @xmath113 ( as in figure  [ fig : square : pillow ] ) with ramification data given as follows .",
    "let @xmath114 be a partition and @xmath115 a partition of an even number into _ odd _ parts .",
    "viewed as a map to the sphere , @xmath1 has profile @xmath116 over @xmath117 and profile @xmath118 over the other three corners of @xmath119 .",
    "additionally , @xmath1 has profile @xmath120 over @xmath121 given points of @xmath119 and unramified elsewhere , where @xmath121 is the number of parts in @xmath114 .",
    "this ramification data determines the genus @xmath122 of @xmath123 by @xmath124 we consider only those ramification data for which @xmath125 in the above formula is equal to zero , @xmath126    denote by @xmath127 the number of inequivalent degree @xmath111 connected covers @xmath128 with ramification data @xmath129 .",
    "denote by @xmath130 the moduli space of quadratic differentials with singularity data @xmath131 and @xmath132 .",
    "condition   guarantees that @xmath133 is nonempty , and corresponds to genus zero .",
    "[ th : pillowcases : as : volume ] for any ramification data @xmath134 satisfying condition   the number @xmath127 of pillowcase covers of type @xmath129 admits the following limit : @xmath135 where @xmath136 is given by equation  .",
    "theorem  [ th : pillowcases : as : volume ] is proved in   [ subsec : lattice : square : tiled : pillowcase ] .",
    "we remark that the leading term in the asymptotics for number of pillowcase covers is the same as if we consider the pillowcase covers where all preimages of three corners of the pillow have ramification index @xmath51 , and all remaining ramification points project to the fourth corner of the pillow , see  @xcite .",
    "note that the more natural direct geometric approach to the counting of pillowcase covers leads to rather involved combinatorial problems .",
    "we present this alternative geometric approach in a separate paper  @xcite .",
    "there are several different combinatorial approaches to computing volumes of strata , based on counting ( pillowcase ) covers .",
    "many of them can be pushed to produce some complicated expressions for the volumes in theorem  [ theorem : volume ] .",
    "for an approach based on kontsevich solution to the witten conjecture @xcite see @xcite . for an approach similar to that of @xcite , which is vastly more complicated in the case of quadratic differentials ,",
    "see @xcite . however , we were not able to get the simple expressions ( [ eq : volume ] ) using any of these methods .",
    "in fact , our proof of theorem  [ theorem : volume ] is not purely combinatorial , but has analytic , geometrical and dynamical inputs ( and is motivated by consideration of lyapunov exponents ) .",
    "it thus remains a challenge to give a more direct proof of theorem  [ theorem : volume ] , in particular bypassing @xcite .",
    "the paper ( like caesar s gaul ) is composed of three parts .",
    "the reader interested only in the billiards may read only  [ sec : configurations : counting ] ( and optionally  [ sec : billiards : qd ] and  [ sec : ergodic ] ) .",
    "the ergodic theorem we use in  [ sec : ergodic ] is due to jon chaika , and is proved in appendix  [ sec : chaika ] .",
    "the part where we compute the volume of any stratum @xmath137 of meromorphic quadratic differentials with at most simple poles on @xmath0 and where we compute the _ siegel ",
    "veech constants _ for these strata is independent from the rest of the paper .",
    "it is presented in  [ sec : subsec : configurations ] ,   [ sec : subsec : coordiantes : in : stratum][sec : subsec : hat : homologous : saddle : connections ] and in   [ sec : siegel : veech][sec : induction ] ( with one verification in appendix  [ sec : appendix : identity ] ) . finally , appendix  [ sec : pillowcase : covers ] devoted to pillowcase covers is completely independent of the rest of the paper .",
    "the formula for the volume of the strata of quadratic differentials was guessed by m.  kontsevich more than a decade ago . at this time formula   related to lyapunov exponents was known experimentally .",
    "the siegel  veech constant   has especially simple form for the strata @xmath138 of quadratic differentials with a single zero and only simple poles on @xmath0 . comparing   and a version of   m.",
    "kontsevich obtained a conjectural formula for @xmath139 .",
    "motivated by the simplicity of the resulting expression as a function of @xmath140 he stated a guess that @xmath141 for any stratum in genus @xmath93 might be expressed as a product of the corresponding expressions for all @xmath142 .",
    "the authors are grateful to m.  kontsevich for the conjecture on the volumes and for collaboration in the work on lyapunov exponents essential for the current paper .",
    "part of this paper strongly relies on techniques developed in collaboration with h.  masur .",
    "we are grateful to him for his very important contribution .",
    "we thank c.  boissy for the list of configurations of omologous saddle connections in genus @xmath93 , elaborated specifically for our needs , and for his pictures of configurations .",
    "we thank p.  paule for the kind permission to use the `` multisum '' package , which was helpful in developing certain intuition with the combinatorial identity .",
    "we thank e.  goujard who carefully read the first version of this paper and provided us with a list of typos .",
    "the authors are happy to thank ihes , imj , iuf , mpim , and the universities of chicago , of illinois at urbana - champaign , of rennes  1 , and of paris  7 for hospitality during the preparation of this paper .",
    "we distinguish the following four ways of getting generalized diagonals in a right - angled billiard .",
    "they correspond to four types of configurations of saddle connections on a flat sphere defined by a meromorphic quadratic differential with simple poles , see  @xcite and  @xcite for general information on _ configurations of saddle connections _ and  @xcite for specific case of @xmath0 .",
    "* i. saddle connection joining distinct singularities . * in this situation ( see figure  [ fig : i : distinct : singularities ] ) we have a generalized diagonal joining a corner @xmath13 with the inner angle @xmath143 , where @xmath144 , to a distinct corner @xmath14 .",
    "( 0,0)(0,5 ) ( -49,-15)@xmath14 ( -86,-35)@xmath13 ( 50,-15)@xmath14 ( 63,-35)@xmath13    the induced flat metric on @xmath0 has an associated saddle connection of the same length joining the zero @xmath13 to the distinct zero ( or simple pole ) @xmath14 .    * ii",
    ". saddle connection joining a zero to itself .",
    "* this situation ( see figure  [ fig : ii : zero : to : itself ] ) can happen only when we have a corner @xmath13 with a corner angle @xmath143 with @xmath145 .",
    "in this case we can have a generalized diagonal joining the corner @xmath13 to itself such that it does not bound a band of closed regular trajectories .",
    "( 0,0)(0,5 ) ( -86,-35)@xmath13 ( 79,-35)@xmath13    for the induced flat metric on @xmath0 we get a corresponding saddle connection of the same length joining the zero @xmath13 to itself such that the total angle @xmath83 at the singularity @xmath13 is split by the separatrix loop into two sectors having the angles strictly greater than @xmath1 ( which is equivalent to the condition that generically such a saddle connection does not bound a cylinder filled with periodic geodesics ) .",
    "* iii . a `` pocket '' . * in this situation ( see figure  [ fig : iii : pocket ] ) we have a band of periodic trajectories .",
    "the boundary of the band is composed of two generalized diagonals .",
    "the first generalized diagonal joins a pair of corners @xmath13 , @xmath14 with inner angles @xmath6 .",
    "the length of this saddle connection is twice shorter than the length of periodic billiard trajectory in the band .",
    "the second generalized diagonal joins a corner @xmath13 with inner angle @xmath143 with @xmath144 to itself .",
    "the length of this saddle connection is the same as the length of periodic billiard trajectory in the band .",
    "( 0,0)(0,-13 ) ( -145,-93)@xmath13 ( -100,-21)@xmath146 ( -16,-93)@xmath14    ( 0,0)(-150,0 ) ( -70,-52)@xmath146 ( -18,-16)@xmath13 ( -18,-52)@xmath14    for the associated flat metric on @xmath0 we get a cylinder filled with closed regular trajectories",
    ". one of the boundary components of the cylinder degenerates to a saddle connection joining two simple poles @xmath13 , @xmath14 . clearly , this saddle connection is twice shorter than the length of the periodic trajectories .",
    "the other boundary component is a saddle connection joining the zero @xmath146 to itself .",
    "the total angle @xmath147 at the singularity @xmath146 is split by the separatrix loop into two sectors , such that the sector adjacent to the cylinder has angle @xmath1 .",
    "the length of this saddle connection is the same as the length of the periodic trajectories in the cylinder .    *",
    "a `` dumbbell '' . * in this last situation ( see figure  [ fig : iv : dumbbell ] ) we again have a band of periodic trajectories .",
    "the boundary of the band is again composed of two generalized diagonals , but this time the first generalized diagonal joins the corner @xmath13 with inner angle @xmath143 to itself , and the second generalized diagonal joins the distinct corner @xmath14 with inner angle @xmath148 to itself .",
    "both @xmath149 are greater than or equal to @xmath150 .",
    "the length of each of these two generalized diagonals is the same as the length of every periodic billiard trajectory in the band .",
    "( 0,0)(-25,10 ) ( -165,-65)@xmath13 ( -127,0)@xmath14 ( 33,-35)@xmath13 ( 62,-4)@xmath14    for the associated flat metric on @xmath0 we get a cylinder filled with closed regular trajectories . on each of the boundary components of the cylinder we have a saddle connection joining the zero @xmath13 ( correspondingly @xmath14 ) to itself .",
    "the length of each of the two saddle connections is the same as the length of the periodic trajectories in the cylinder .",
    "the following two propositions explain why we distinguish these four particular types of configurations ( see more details in   [ sec : subsec : hat : homologous : saddle : connections ] which discusses a homological interpretation of these statements ) .",
    "[ prop : only : four : types ] almost any flat surface @xmath151 in any stratum @xmath152 different from the pillowcase stratum @xmath153 does not have a single pair of parallel saddle connections different from the pairs involved in configurations of types @xmath154 .",
    "proposition  [ prop : only : four : types ] is proved in   [ sec : subsec : hat : homologous : saddle : connections ] .",
    "an analogous statement can be formulated for right - angled billiards .",
    "[ pr : no : other : for : billiards ] for almost any right - angled billiard in any family @xmath11 the following property holds .",
    "consider a pair of trajectories , where each trajectory is either a closed regular trajectory or a generalized diagonal .",
    "suppose that these trajectories are not parallel to any side of the polygon .",
    "if some segment of the first trajectory is parallel to some segment of the second trajectory , then both trajectories make part of one of configurations i  iv described in  [ sec : subsec : configurations ] .",
    "proposition  [ pr : no : other : for : billiards ] mimics proposition 7.4 in  @xcite ; it is proved in   [ sec : subsec : the : subspace : of : billiards ] .",
    "* configurations of saddle connections . * in addition to the type i  iv of a saddle connection , we may specify some extra combinatorial information , for example the indices ( `` names '' ) of all singularities involved . for saddle connections of type iv , where a cylinder is joining two spheres , we specify not only the zeroes @xmath13 and @xmath14 at the boundary components of the cylinder , but we also specify the subcollections @xmath155 and @xmath156 of numbered zeroes an poles which get to the first and to the second sphere correspondingly .",
    "we call this information the _ configuration _ of a saddle connection ( or the configuration of saddle connections , when there are several saddle connections involved as in types iii and iv ) . by convention ,",
    "the configuration of saddle connections includes its type .",
    "see also   [ sec : subsec : hat : homologous : saddle : connections ] for a homological interpretation of a configuration of saddle connections .",
    "* configuration of a generalized diagonal .",
    "* by the _ configuration _ of the generalized diagonal we mean the configuration of the associated saddle connections in @xmath0 described in  [ sec : subsec : intro : rab : qd ] .      by the notation",
    "@xmath157 we mean as customary , @xmath158 for technical reasons , we will need to consider `` weak asymptotic formulas '' @xmath159 which means @xmath160    the following theorem ( which is a special case of results of @xcite and @xcite ) establishes a strong asymptotic formula for almost all flat surfaces in a stratum . by convention",
    "we always count _ non - oriented _ saddle connections and _ non - oriented _ closed flat geodesics .    [",
    "theorem : sv : for : cp ] for almost any flat surface @xmath151 in any stratum @xmath86 of meromorphic quadratic differentials with at most simple poles on @xmath0 the number @xmath161 of occurrences of saddle connections of length at most @xmath2 and of fixed configuration @xmath162 , has quadratic asymptotics in @xmath2 : @xmath163 the constants @xmath164 are called siegel - veech constants .",
    "they depend only on the configuration @xmath162 and on @xmath165 .",
    "their values are given in ",
    "[ sec : siegel : veech ] .",
    "theorem  [ theorem : sv : for : cp ] is proved in  [ sec : subsec : reduction : to : ergodic : theory ] .",
    "note that theorem  [ theorem : sv : for : cp ] has no relation to billiards , it concerns only flat metrics on @xmath0 induced by meromorphic quadratic differentials with simple poles . in  [ sec : subsec : intro : rab : qd ] we described how a right - angled billiard table @xmath9 canonically determines a meromorphic quadratic differential on @xmath0 .",
    "however , since the image of the resulting map @xmath166 has measure @xmath93 in @xmath167 , results such as theorem  [ theorem : sv : for : cp ] do not immediately imply anything about right - angled billiards .",
    "nevertheless , we have the following :    [ theorem : sv : for : billiards ] for almost any billiard table @xmath9 in any family @xmath168 of right - angled billiards the number @xmath169 of occurrences of generalized diagonals of configuration @xmath162 and of length at most @xmath2 has quadratic asymptotics in @xmath2 : @xmath170 where the constants @xmath164 are the corresponding siegel ",
    "veech constants @xmath164 for the stratum @xmath88 in theorem  [ theorem : sv : for : cp ] .",
    "theorem  [ theorem : sv : for : billiards ] is proved in  [ sec : point : weak ] , using jon chaika s theorem  [ theorem : bikhoff : chaika ] which is proved in appendix  [ sec : chaika ] .",
    "the factor of @xmath171 in   is explained as follows .",
    "note that any generalized diagonal in the billiard table @xmath9 which is not parallel to one of the sides of @xmath9 canonically determines two symmetric saddle connections of the same type on the flat surface @xmath151 glued from the two copies of @xmath9 , where the symmetry is the antiholomorphic involution , see figure  [ fig : billiard : and : sphere ] .",
    "hence , @xmath172 note also , that by construction the area of @xmath151 is twice the area of the billiard table @xmath9 .",
    "note that our billiard table does not need to be necessarily embeddable into the plane , say , we can consider a helical right - angled billiard as in figure  [ fig : helical : billiard ] .",
    "more precisely , by a _",
    "right - angled billiard table _ we call a topological disc endowed with a flat metric having the following properties .",
    "the flat metric is allowed to have isolated cone - type singularities in the interior of the disc with cone angles of the form @xmath173 , with @xmath174 .",
    "the boundary of the disc is piecewise - geodesic in the flat metric , and the angles between the geodesic segments have the form @xmath63 , with @xmath175 .",
    "in fact , some version of theorem  [ theorem : sv : for : billiards ] holds for individual billiards :    [ theorem : invididual : billiards ] suppose @xmath9 is a billiard table from the family of right - angled billiards @xmath168 .",
    "furthermore , suppose @xmath9 is such that the flat surface @xmath151 glued from two copies of @xmath9 does not belong to any proper @xmath176-invariant affine submanifold of the stratum @xmath177 .",
    "then , for any choice i  iv of configuration @xmath162 , the weak asymptotic formula @xmath178 holds , where @xmath164 is the siegel  veech constant corresponding to the configuration @xmath162 in the stratum @xmath88 ( as in theorem  [ theorem : sv : for : cp ] ) .    the statement is an immediate corollary of theorem  2.12 in  @xcite .",
    "we note that a complete proof of theorem  2.12 in  @xcite involves the measure classification theorem of  @xcite and is well over 200 pages long , and only yields weak asymptotic formulas .",
    "the proof of theorem  [ theorem : sv : for : billiards ] is much shorter , and uses special features of right - angled billiards , namely proposition  [ prop : map : onto ] .",
    "however , theorem  [ theorem : sv : for : billiards ] is an almost everywhere statement , and does not imply any type of asymptotic formula for an individual billiard table .",
    "we also note that for most other families of billiards , almost - everywhere statements like theorem  [ theorem : sv : for : billiards ] are not available ( since the analogue of proposition  [ prop : map : onto ] fails . )",
    "in   [ sec : subsec : coordiantes : in : stratum ] we describe the cohomological coordinates in a stratum of quadratic differentials .",
    "we proceed in   [ sec : subsec : hat : homologous : saddle : connections ] with a reminder of the notions of _ omologous saddle connections _ and a _ configuration _ of omologous saddle connections .    in   [ sec : subsec : the : subspace : of : billiards ] we analyze the canonical embedding of the space of ( directional ) right - angled billiards @xmath11 into the corresponding space @xmath88 of meromorphic quadratic differentials on @xmath0 .",
    "namely , we prove in proposition  [ prop : map : onto ] that its image projects surjectively onto the unstable foliation of the teichmller geodesic flow , which allows us to apply certain ergodic techniques of hyperbolic dynamics not only to flat surfaces from @xmath88 but to billiards from @xmath11 .",
    "we complete   [ sec : billiards : qd ] with a proof of proposition  [ pr : no : other : for : billiards ] .",
    "consider a meromorphic quadratic differential @xmath179 having zeroes of arbitrary multiplicities but only simple poles on @xmath0 .",
    "let @xmath180 be its singular points ( zeros and simple poles ) .",
    "consider the minimal branched double covering @xmath181 such that the induced quadratic differential @xmath182 on the hyperelliptic surface @xmath183 is a square of an abelian differential @xmath184 .",
    "( 0,0)(0,0 ) ( -53,-101)@xmath185 ( -17,-88)@xmath186 ( 0,-58)@xmath187 ( 0,-118)@xmath188 ( 35,-65)@xmath189 ( 61,-59)@xmath190    ( 0,0)(0,0 ) ( -48,-223)@xmath28 ( -15,-213)@xmath29 ( 3,-206)@xmath13 ( 33,-194)@xmath191 ( 65,-184)@xmath192    the zeros @xmath193 of the resulting abelian differential @xmath194 correspond to the zeros of @xmath179 in the following way : every zero @xmath195 of @xmath179 of odd order is a ramification point of the covering , so it produces a single zero @xmath196 of @xmath194 ; every zero @xmath197 of @xmath179 of even order is a regular point of the covering , so it produces two zeros @xmath198 of @xmath194 .",
    "every simple pole of @xmath179 defines a branching point of the covering ; this point is a regular point of @xmath194 .",
    "consider the subspace @xmath199 of the relative homology of the cover with respect to the collection of zeroes @xmath200 of @xmath194 which is antiinvariant with respect to the induced action of the hyperelliptic involution .",
    "we are going to construct a basis in this subspace ( in complete analogy with a usual basis of absolute cycles for a hyperelliptic surface ) .",
    "we can always enumerate the singular points @xmath201 of @xmath179 in such a way that @xmath192 is a simple pole .",
    "chose now a simple oriented broken line @xmath202 on @xmath0 joining consecutively all the singular points of @xmath179 except the last one .",
    "for every arc @xmath203 $ ] of this broken line , @xmath204 , the difference of their two preimages defines a relative cycle in @xmath205 . by construction",
    "such a cycle is antiinvariant with respect to the hyperelliptic involution .",
    "it is immediate to see that the resulting collection of cycles forms a basis in @xmath206 .",
    "note that a preimage of a simple pole does not belong to the set @xmath207 .",
    "thus , a preimage of an arc @xmath203 $ ] having a simple pole as one of the endpoints does not define a cycle in @xmath208 .",
    "however , since a simple pole is always a branching point , the _ difference _ of the preimages of such arc is already a well - defined relative cycle in @xmath209",
    ".    let @xmath90 be the ambient stratum for the meromorphic quadratic differential @xmath210 .",
    "the subspace @xmath211 in the relative _ cohomology _ antiinvariant with respect to the natural involution defines local coordinates in the stratum .",
    "we follow the exposition in  @xcite introducing the notions of a _ rigid _ collection of saddle connections and of _ omologous _ saddle connections .",
    "consider a flat sphere @xmath151 corresponding to a meromorphic quadratic differential @xmath210 with at most simple poles .",
    "any saddle connection on the flat sphere @xmath151 persists under small deformations of @xmath151 inside @xmath212 .",
    "it might happen that any deformation of a given flat surface which shortens some specific saddle connection necessarily shortens some other saddle connections .",
    "we say that a collection @xmath213 of saddle connections is _ rigid _ if any sufficiently small deformation of the flat surface inside the stratum preserves the proportions @xmath214 of the lengths of all saddle connections in the collection .",
    "consider the canonical double cover @xmath215 over @xmath151 defined in   [ sec : subsec : coordiantes : in : stratum ] .",
    "given a saddle connection @xmath216 on @xmath151 choose an orientation of @xmath216 and let @xmath217 be its lifts to the double cover @xmath215 endowed with the orientation inherited from @xmath216 .",
    "if @xmath218=-[\\gamma'']$ ] as cycles in @xmath219 we let @xmath220:=[\\gamma']$ ] , otherwise we define @xmath220 $ ] as @xmath220:=[\\gamma']-[\\gamma'']$ ] .",
    "it immediately follows from the above definition that the cycle @xmath220 $ ] defined by a saddle connection @xmath216 is always _ primitive _ in @xmath221 and belongs to @xmath222 .",
    "following  @xcite we introduce the following    [ def : homologous ] the saddle connections @xmath223 on a flat surface @xmath151 defined by a quadratic differential @xmath78 are _ omologous _ if @xmath224=[\\hat\\gamma_2]$ ] in @xmath225 under an appropriate choice of orientations of @xmath226 .",
    "( the notion `` homologous in the relative homology with local coefficients defined by the canonical double cover induced by a quadratic differential '' is unbearably bulky , so we introduced an abbreviation `` omologous '' .",
    "we stress that the circumflex over the `` h '' is quite meaningful : as it is indicated in the definition , the corresponding cycles are homologous _ on the double cover_. )    note that since there is no canonical way to enumerate the preimages @xmath227 of a saddle connection @xmath216 on the double cover , the cycle @xmath220 $ ] is defined only up to a sign , even when we fix the orientation of @xmath216 .",
    "thus , @xmath228 is omologous to @xmath229 if and only if @xmath224=\\pm[\\hat\\gamma_2]$ ] .",
    "[ pr : rigid : configurations : hat : homologous ] let @xmath151 be a flat surface corresponding to a meromorphic quadratic differential @xmath78 with at most simple poles . a collection @xmath230 of saddle connections on @xmath151 is rigid if and only if all saddle connections @xmath231 are omologous .",
    "there is an obvious geometric test for deciding when saddle connections @xmath232 on a translation surface @xmath151 are homologous : it is sufficient to check whether @xmath233 is connected or not ( provided @xmath234 and @xmath235 are connected ) .",
    "it is slightly less obvious to check whether saddle connections @xmath236 on a flat surface @xmath151 with nontrivial linear holonomy are omologous or not .",
    "in particular , a pair of closed saddle connections might be homologous in the usual sense , but not omologous ; a pair of closed saddle connections might be omologous even if one of them represents a loop homologous to zero , and the other does not ; finally , a saddle connection joining a pair of _ distinct _ singularities might be omologous to a saddle connection joining a singularity to itself , or joining another pair of distinct singularities . the following statement provides a geometric criterion for deciding when two saddle connections are omologous .",
    "let @xmath151 be a flat surface corresponding to a meromorphic quadratic differential @xmath78 with at most simple poles .",
    "two saddle connections @xmath226 on @xmath151 are omologous if and only if they have no interior intersections and one of the connected components of the complement @xmath233 has trivial linear holonomy . moreover ,",
    "if such a component exists , it is unique .",
    "now everything is ready for the proof of proposition  [ prop : only : four : types ] .",
    "configurations i and ii involve a single saddle connection . using the above criterion it is immediate to check that all saddle connections involved in configurations iii and iv are omologous .",
    "thus , these configurations are rigid , and we can find them on almost every flat surface in the stratum .",
    "theorem  2.2 in  @xcite applies general results from  @xcite to classify all possible configurations of omologous saddle connections on @xmath0 , and shows that there are no such configurations different from types i  iv .    to complete the proof it remains to apply proposition  4 from  @xcite which claims that for almost every flat surface in any stratum , two saddle connections are parallel if and only if they are omologous .",
    "( this statement is proved following the lines of proposition 7.4 in  @xcite ; see also the analogous proof of proposition  [ pr : no : other : for : billiards ] in   [ sec : subsec : the : subspace : of : billiards ] below .",
    "consider now the map @xmath237 in the chosen coordinates in @xmath238 the image of a directional billiard @xmath9 is presented by a point @xmath239 the components of the projection of this vector to the @xmath240 are of the form @xmath241 depending on the parity of @xmath242 .",
    "thus , for @xmath10 different from an integer multiple of @xmath60 the composition map @xmath243 is a surjective map .",
    "we have proved    [ prop : map : onto ] consider the canonical local embedding @xmath244 for almost all directional billiards in @xmath245 the projection of the tangent space @xmath246 to the unstable subspace of the teichmller geodesic flow is a surjective map .",
    "we complete this section with a proof of proposition  [ pr : no : other : for : billiards ] .    by assumption",
    "we do not consider generalized diagonals and closed billiard trajectories parallel to the sides of the polygon .",
    "first note that without loss of generality we can consider only generalized diagonals : any closed regular trajectory makes part of a band which is bounded on both sides by a ( chain of ) generalized diagonals , see figure  [ fig : family : of : rectangular : polygons ] .",
    "let @xmath247 for @xmath248 . recall that @xmath249 are the independent coordinates in the space @xmath11 . unfolding the billiard along a generalized diagonal",
    "we see that every generalized diagonal ( non parallel to one of the sides of the polygon ) defines a relation @xmath250 where @xmath251 ; the sum in the numerator is taken over the vertical sides of the polygon ; the sum in the denominator is taken over the horizontal sides ; and all @xmath252 and @xmath253 are integers . since the second generalized diagonal has a segment going in the same direction @xmath10 , it also defines a relation @xmath254 where the sum in the numerator is taken over the vertical sides of the polygon ; the sum in the denominator is taken over the horizontal sides ; and all @xmath255 and @xmath256 are integers .",
    "each generalized diagonal determines a saddle connection @xmath216 on the corresponding flat sphere , which in turn defines a cycle @xmath257 .",
    "moreover , up to appropriate choice of signs of the basic vectors in the basis from   [ sec : subsec : coordiantes : in : stratum ] the cycle corresponding to the first generalized diagonal has the form @xmath258 and the the cycle corresponding to the second generalized diagonal has the form @xmath259 .",
    "assume that the two generalized diagonals do not make part of any of configurations i  iv . by the result of boissy  @xcite there are no configurations of omologous saddle connections on @xmath0 other than configurations i  iv .",
    "this implies that the corresponding saddle connections are not omologous , and , hence , the cycles @xmath260 and @xmath261 are not proportional .",
    "this implies that the relation @xmath262 is a nontrivial relation on coordinates @xmath263 .",
    "thus , the set , satisfying this condition , has measure zero . taking a union over the countable collection of possible conditions ( countable , because we have to consider all possible collections of integers @xmath264 ) we still get a set of measure zero .",
    "in this section , we derive formulas for the siegel  veech constant of each configuration of saddle connections .",
    "there are two kinds of formulas .",
    "the first kind expresses the siegel  veech constant as a ratio of volumes of strata , with explicit combinatorial coefficients .",
    "these formulas will be stated and proved in this section .",
    "the second kind of formula gives the siegel ",
    "veech constants as numbers ( depending only on the stratum and the configuration ) .",
    "they are proved by plugging the expression   from theorem  [ theorem : volume ] into the formula of the first kind .",
    "we also present these formulas here ; however , theorem  [ theorem : volume ] will only be proved in  [ sec : induction ] .",
    "for this reason we have attempted to separate the formulas which depend on theorem  [ theorem : volume ] from the formulas which do not .",
    "the results obtained in this section are based on techniques developed in the papers  @xcite , @xcite , and  @xcite written in collaboration with h.  masur .",
    "recall that for any flat surface @xmath151 in any stratum @xmath177 we have a canonical ramified double cover @xmath265 such that the induced quadratic differential on the riemann surface @xmath215 is a global square of a holomorphic abelian differential .",
    "we have seen in   [ sec : subsec : coordiantes : in : stratum ] that the subspace @xmath266 antiinvariant with respect to the induced action of the hyperelliptic involution on relative cohomology provides local coordinates in the corresponding stratum @xmath90 of quadratic differentials .",
    "we define a lattice in @xmath238 as the subset of those linear forms which take values in @xmath267 on @xmath268 .",
    "we define the volume element @xmath269 on @xmath177 as the linear volume element in the vector space @xmath270 normalized in such way that the fundamental domain of the above lattice has volume @xmath65 .",
    "we warn the reader that for @xmath271 this lattice is a proper sublattice of index @xmath272 of the lattice @xmath273 indeed , if a flat surface @xmath151 defines a lattice point for our choice of the lattice , then the holonomy vector along a saddle connection joining distinct singularities might be half - integer .",
    "( however , the holonomy vector along any _ closed _ saddle connection is still always integer . )",
    "the choice of one or another lattice is a matter of convention .",
    "our choice makes formulae relating enumeration of pillowcase covers to volumes simpler ; see appendix  [ sec : pillowcase : covers ] .",
    "another advantage of our choice is that the volumes of the strata @xmath138 and of the hyperelliptic components of the corresponding strata of abelian differentials are the same ( up to the factors responsible for the numbering of zeroes and of simple poles ) .",
    "[ con : area:1:2 ] similar to the case of abelian differentials we now choose a real hypersurface @xmath274 of flat surfaces of fixed area in the stratum @xmath177 .",
    "we abuse notation by denoting by @xmath274 the space of flat surfaces of area @xmath275 ( so that the canonical double cover has area @xmath65 ) .",
    "the volume element @xmath269 in the embodying space @xmath177 induces naturally a volume element @xmath276 on the hypersurface @xmath274 in the following way .",
    "there is a natural @xmath277-action on @xmath177 : having @xmath278 we associate to the flat surface @xmath279 the flat surface @xmath280 in particular , we can represent any @xmath281 as @xmath282 , where @xmath283 , and where @xmath284 belongs to the `` hyperboloid '' : @xmath285 .",
    "geometrically this means that the metric on @xmath151 is obtained from the metric on @xmath284 by rescaling with linear coefficient @xmath286 .",
    "in particular , vectors associated to saddle connections on @xmath284 are multiplied by @xmath286 to give vectors associated to corresponding saddle connections on @xmath151 .",
    "it means also that @xmath287 , since @xmath288 .",
    "we define the _ volume element _",
    "@xmath276 on the `` hyperboloid '' @xmath274 by disintegration of the volume element @xmath269 on @xmath177 : @xmath289 where @xmath290 using this volume element we define the total _ volume of the stratum _",
    "@xmath274 : @xmath291    for a subset @xmath292 we let @xmath293 denote the `` cone '' based on @xmath294 : @xmath295 our definition of the volume element on @xmath274 is consistent with the following normalization : @xmath296 where @xmath297 is the total volume of the `` cone '' @xmath298 measured by means of the volume element @xmath269 on @xmath177 defined above .",
    "there is an action of @xmath50 on the moduli space of quadratic differentials that preserves the stratification , and moreover , preserves (  @xcite ) the measures on @xmath299 and @xmath300 described above .",
    "recall that a quadratic differential @xmath78 determines ( and is determined by ) by an atlas of charts to @xmath301 whose transition maps are of the form @xmath302 .",
    "since @xmath50 acts on @xmath303 via linear maps on @xmath304 , given a quadratic differential @xmath78 and a matrix @xmath305 , define the quadratic differential @xmath306 via post - composition of charts with @xmath122 .",
    "this action generalizes the action of @xmath50 on the space of ( unit - area ) flat tori @xmath307 .",
    "note that @xmath50 preserves the area of the quadratic differential @xmath78 , and in particular it preserves the level surface @xmath274 .",
    "in this section we shall also consider the strata @xmath308 of flat surfaces @xmath279 where we mark a regular point on the surface .",
    "say , @xmath309 will denote the stratum of meromorphic quadratic differentials on @xmath0 with one zero of order @xmath51 , two zeroes of order @xmath65 denoted by @xmath310 , eight simple poles @xmath311 , and one additional marked point : `` zero of order @xmath93 '' .",
    "let @xmath312 be a set with multiplicities , where @xmath313 for @xmath314 , and @xmath315 .",
    "a stratum with a marked point @xmath316 has the natural structure of a fiber bundle over the corresponding stratum without marked points @xmath317 .",
    "this bundle has has the surface @xmath151 ( punctured at all singularities @xmath318 ) as a fiber over the `` point '' @xmath319 .",
    "clearly , the dimension of the `` universal curve '' @xmath320 satisfies @xmath321 by convention we _ always _ mark a point on a flat torus .",
    "we denote the corresponding stratum @xmath322 ; it has dimension two : @xmath323 .",
    "the natural measure on the stratum @xmath324 with marked points disintegrates into a product measure , where the measure @xmath325 along the fiber is proportional to the lebesgue measure on @xmath151 induced by the flat metric on @xmath151 , and the measure on the base @xmath326 is the natural measure @xmath276 on the corresponding stratum taken without marked points .    when the flat structure on @xmath151 is defined by a _",
    "differential the measure of the fiber @xmath151 is different from the measure of the analogous fiber @xmath151 with the flat structure defined by an _",
    "_ differential .",
    "namely , by convention  [ con : area:1:2 ] the area of the surface @xmath151 in terms of our flat metric defined by the quadratic differential is @xmath275 .",
    "note also , that a saddle connection @xmath216 joining a zero and a marked point and having half - integer linear holonomy @xmath327 defines an integer cycle @xmath328 .",
    "hence , our choice of the fundamental domain of the lattice in the relative cohomology @xmath329 described in   [ sec : subsec : notmalization ] implies that the component @xmath325 of the disintegrated measure along the fiber @xmath151 is @xmath330 i.e. @xmath32 times the standard lebesgue measure coming from the flat metric .",
    "this gives @xmath331 for the total measure of each fiber , which implies the following relation between the volumes of the strata : @xmath332 recall that @xmath333 , see  ; so this is coherent with formula   for the volume .",
    "it will be convenient to consider the strata @xmath334 , of closed flat surfaces @xmath151 having two components @xmath335 of prescribed types .",
    "such strata play especially important role in the context of the _ principal boundary _ discussed in   [ sec : subsec : principal : boundary ] . in the consideration below each of @xmath336 might contain an entry `` @xmath93 '' or not .",
    "in other words , the strata @xmath337 are allowed to have a marked point .    [",
    "conv : disconn : strata ] using notation @xmath338 for the strata @xmath339 of disconnected surfaces we assume that we keep track of how @xmath340 is partitioned into @xmath341 and @xmath342 .",
    "we shall need the expressions for the volume element and for the total volume of such strata .",
    "the corresponding expressions for the strata of abelian differentials were obtained in  6.2 pp .",
    "8182 in  @xcite .",
    "though the corresponding formula translates to the strata of quadratic differentials without any difficulties we present this simple calculation since it is very instructive in view of calculation of siegel  veech constants performed below .",
    "we write @xmath343 , where @xmath344 ; @xmath345 . then @xmath346 . let @xmath347 let @xmath348 ( correspondingly @xmath349 ) be the volume element on the stratum @xmath350 ( correspondingly @xmath351 ) .",
    "let @xmath352 ( correspondingly @xmath353 ) be the hypersurface volume element on the `` unit hyperboloid '' @xmath354 ( correspondingly @xmath355 ) .",
    "we have @xmath356 set @xmath357 then , @xmath358 where we have left the computation of the integral over the disk as an exercise .",
    "hence , applying   we get @xmath359    repeating literally the same arguments we obtain the corresponding formula for the volume elements : @xmath360      in this section we recall the strategy given in  @xcite to obtain the quadratic asymptotics in theorem  [ theorem : sv : for : cp ] .",
    "fix an unordered collection @xmath361 of integers @xmath362 , @xmath363 , satisfying @xmath364 , and let @xmath300 denote the stratum @xmath365 .",
    "note that every such stratum is nonempty and connected .",
    "let @xmath366 denote the canonical @xmath367-invariant measure on @xmath300 .",
    "fix a configuration @xmath162 as in ",
    "[ sec : subsec : configurations ] . to each saddle connection we associate a holonomy vector in the euclidean plane @xmath368 having the same length and the same line direction as the saddle connection . by convention the configuration iii",
    "is represented by the closed saddle connection joining a zero to itself ( the holonomy vector associated to the partner saddle connection joining two simple poles is parallel but twice shorter ) .",
    "since by convention the saddle connections are not oriented , the holonomy vector is defined up to a sign , so we actually consider a pair of opposite holonomy vectors @xmath369 .",
    "given a flat surface @xmath370 , let @xmath371 be the set of holonomy vectors of saddle connections whose configuration is @xmath162 .",
    "for any flat surface @xmath151 the set @xmath371 is a discrete subset of @xmath304 .",
    "we are interested in the asymptotics of the number @xmath372 of saddle connections of type @xmath162 on the flat surface @xmath151 of length at most @xmath2 .",
    "the weight @xmath275 in the above expression compensates the fact that each saddle connection is represented by two holonomy vectors @xmath80 .    in the remainder of  [",
    "sec : ergodic ] , the stratum @xmath299 and the configuration @xmath162 are fixed .",
    "we will often omit @xmath162 from the notation , and we will use the abbreviated notation @xmath78 for the flat surface @xmath279 .      given @xmath373 , define the _",
    "transform @xmath374 by    @xmath375    we have the _ siegel  veech formula _ ( @xcite , theorem 0.5 ) .",
    "there is a constant ( called the _ siegel ",
    "constant ) @xmath376 so that :    @xmath377    let @xmath378    @xmath379    let @xmath380 be ( a smoothed version of ) the indicator function of the trapezoid @xmath381 defined by the points @xmath382    note that the area of this trapezoid is @xmath383 .",
    "we then have , for @xmath384 , and any @xmath385 ( @xcite , lemma 3.4 ) :    @xmath386    ( see @xcite for the exact meaning of @xmath387 ) .",
    "heuristically , the integral measures the proportion of angles @xmath388 so that @xmath389 .",
    "the trapezoid @xmath390 has vertices at @xmath391 the range of ( inverse ) slopes is of size @xmath392 , and thus the length of the interval of @xmath388 s satisfying @xmath389 is also of size @xmath392 , if @xmath393 has length in between @xmath394 and @xmath395 , and zero otherwise .",
    "dividing by @xmath56 to get the proportion , we obtain ( [ eq : eskinmasur:3.4 ] ) . combining ( [ eq :",
    "siegel : veech ] ) and ( [ eq : eskinmasur:3.4 ] ) , we obtain @xmath396      the equation ( [ eq : circ : av ] ) reduces the problem of studying @xmath397 to that of studying the limiting behavior of @xmath398 assuming this limit exists , and is equal to @xmath399 , a geometric series calculation shows @xmath400 assuming further that lebesgue measure supported on the circles @xmath401 converges , as @xmath402 , to the absolutely continuous @xmath50-invariant measure @xmath366 on @xmath300 , we would have that @xmath403 , and then using ( [ eq : siegel : veech ] ) , we would obtain , since the area of the trapezoid is @xmath383 , @xmath404 in fact , this is the approach used in  @xcite .",
    "there , the key tool is a general ergodic theorem on @xmath50-actions , proved by a.  nevo  @xcite which shows @xmath405 for almost every @xmath406 .",
    "however , since the set of billiards has measure @xmath93 , this does not yield any information about them .",
    "we will instead use theorem  [ theorem : bikhoff : chaika ] to obtain our results .      in this section",
    "we present a strategy for evaluation siegel  veech constants .",
    "this strategy was successfully applied in  @xcite to compute all siegel  veech constants for all connected components of the strata of abelian differentials . in this section",
    "we present the general scheme elaborated in  @xcite and developed in  @xcite . in the further sections we adjust it to the concrete cases of configurations of saddle connections i ",
    "iv described in   [ sec : subsec : configurations ] .",
    "fix a stratum @xmath212 of meromorphic quadratic differentials on @xmath0 , where @xmath312 . consider a configuration @xmath162 of one of the types i  iv ( in the case of general strata in higher genus it would be any configuration of omologous saddle connections ) .",
    "we have seen in   [ sec : subsec : reduction : to : ergodic : theory ] that to each flat surface @xmath407 we can associate a discrete subset @xmath408 of holonomy vectors of saddle connections whose configuration is @xmath162 . by construction",
    "the set @xmath371 is centrally symmetric with respect to the origin . to any function @xmath380 with compact support on @xmath304 formula   associates its _ siegel  veech transform _",
    "@xmath409 defined on the stratum @xmath299 . by definition  , choosing the characteristic function @xmath410 of a closed disk of radius @xmath2 centered at the origin of @xmath304 as a function @xmath380 , we get as @xmath411 the counting function @xmath412 of the number of saddle connections of type @xmath162 and of length at most @xmath2 on the flat surface @xmath151 defined by  .    applying siegel ",
    "veech formula   we obtain @xmath413    by the results of a.  eskin and h.  masur  @xcite , for almost all flat surfaces @xmath151 in the stratum @xmath300 one has @xmath414 with the same constant @xmath415 as in  .",
    "formula   can be applied to @xmath416 for any value of @xmath2 . in particular , instead of taking large @xmath2 we can choose a very small @xmath417 . the corresponding function @xmath418 counts how many ( collections of ) @xmath419-short saddle connections ( closed geodesics ) of the type @xmath162 we can find on a flat surface @xmath420 .    consider a subset @xmath421 of surfaces of area @xmath275 having a saddle connection shorter than @xmath419 . consider a smaller subset @xmath422 of those surfaces of area @xmath275 in @xmath300 which have at least two distinct collections of omologous saddle connections of type @xmath162 and of length at most @xmath423 .",
    "finally , define @xmath424 as the complement @xmath425 .    for the flat surfaces @xmath151 outside of the subset @xmath426 there are no saddle connections of the type @xmath162 shorter than @xmath423 , so @xmath427 for such surfaces . for surfaces @xmath151 from the subset",
    "@xmath428 there is exactly one collection like this , so @xmath429 . finally , for the surfaces @xmath151 from the remaining subset @xmath430 one has @xmath431 .",
    "a ,  eskin and h.  masur have proved in  @xcite that though @xmath418 might be large on @xmath432 the measure of this subset is so small that @xmath433 and hence @xmath434 this latter volume is almost the same as the volume @xmath435 , namely , by  @xcite one has @xmath436 . taking into consideration that @xmath437 and applying siegel ",
    "veech formula   we get @xmath438 which implies the following formula for the siegel  veech constant @xmath415 : @xmath439    we complete this section by establishing an elementary relation between the siegel  veech constant @xmath415 used in  [ sec : ergodic ] and in  [ sec : subsec : principal : boundary ] and the siegel  veech constant @xmath164 used in  [ sec : configurations : counting ] . recall that counting function   @xmath440 counts the number of saddle connections of type @xmath162 of length at most @xmath2 on the flat surface @xmath441 . by convention  [ con : area:1:2 ]",
    "surfaces from @xmath300 have area @xmath275 .",
    "thus , applying the asymptotic formula   from theorem  [ theorem : sv : for : cp ] to the flat surface @xmath441 we get @xmath442 which implies that @xmath443      when saddle connections of configuration @xmath162 are contracted by a continuous deformation , the limiting flat surface decomposes into one or several connected components represented by nondegenerate flat surfaces @xmath444 .",
    "let the initial surface @xmath151 belong to a stratum @xmath212 , where @xmath445 is the set with multiplicities @xmath446 .",
    "let @xmath447 be the stratum ambient for @xmath448 .",
    "the stratum @xmath449 of disconnected flat surfaces @xmath450 is referred to as a _ principal boundary _ stratum of the stratum @xmath212 .",
    "the principal boundary of any connected component of any stratum of abelian differentials is described in  @xcite ; the principal boundaries of strata of quadratic differentials are described in  @xcite .",
    "the papers  @xcite , @xcite also present the inverse construction .",
    "consider any flat surface @xmath451 in the principal boundary of @xmath212 ; consider a vector @xmath452 such that @xmath453 .",
    "one can reconstruct a flat surface @xmath407 endowed with a collection of saddle connections of the type @xmath162 such that the linear holonomy along saddle connections is represented by @xmath454 , and such that degeneration of @xmath151 contracting the saddle connections in the collection gives the surface @xmath455 .",
    "when the configuration @xmath162 does not involve any cylinders , any flat surface @xmath456 and any holonomy vector @xmath75 define the surface @xmath457 , basically , up to some finite order ambiguity which can be explicitly computed .",
    "moreover , the measure in @xmath458 disintegrates as the measure in @xmath459 times the measure @xmath325 in the space of parameters of the deformation .",
    "the latter space can be viewed as a finite cover of the space of holonomy vectors @xmath80 , that is the quotient of the disk @xmath460 of radius @xmath423 over the central symmetry . as a result we get @xmath461 thus , in order to compute the constant @xmath415 by formula   it is sufficient to express the volume of @xmath462 in terms of the volumes @xmath463 , and to compute the explicit factor , responsible for the fixed finite number of flat surfaces @xmath464 which correspond to a fixed flat surface @xmath465 in the boundary stratum and to a fixed holonomy vector @xmath466 .",
    "the first problem is simple ; the answer to this problem is given in   [ sec : subsec : strata : of : disconnected : surfaces ] ; the second problem is solved for configurations i  iv in the remaining part of   [ sec : siegel : veech ] .",
    "the situation for configurations which involve a cylinder is slightly more complicated , but similar to the previous one . in both cases ,",
    "applying formula   and   we express the constant @xmath415 as @xmath467      consider a flat surface @xmath468 in a stratum of meromorphic quadratic differentials with at most simple poles on @xmath0 , possibly with a marked point .",
    "fix some zero , or a simple pole ( or the marked regular point ) @xmath13 .",
    "consider a vector @xmath469 , defined up to reversing the direction .",
    "assume that @xmath75 is much shorter than the shortest saddle connection on @xmath151 .",
    "the papers  @xcite and  @xcite describe how to perform a small deformation of the surface @xmath455 breaking up the chosen singularity @xmath13 of degree @xmath142 into two singularities @xmath470 of any two prescribed degrees @xmath471 and @xmath472 satisfying the relation @xmath473 , where @xmath474 .",
    "the deformation can be performed in such way that the holonomy vector of the resulting tiny saddle connection joining the newborn singularities @xmath475 is exactly @xmath454 .",
    "this deformation is described in details in sections 8.18.2 in  @xcite and in section 6.3 in  @xcite .",
    "when at least one of @xmath476 is even , the deformation is local : it does not change the metric outside of a small neighborhood of @xmath13 and it does not change the area of the flat surface .",
    "when both @xmath477 are odd the deformation involves some arbitrariness and involves some small change of the area of the flat surface . a discussion in the original papers  @xcite and  @xcite explains why both issues might be neglected in our calculations .",
    "the cone angles at the distinguished singularity is equal to @xmath478 .",
    "thus , there are @xmath479 geodesic rays in linear direction @xmath480 adjacent to @xmath13 .",
    "take a small disk @xmath481 of radius @xmath423 centered in the origin and consider its quotient @xmath460 over the action of central symmetry . letting the vector @xmath80 vary in @xmath460 and taking care of normalization   of the measure @xmath325 on @xmath460 we get a set of parameters of measure @xmath482 for this configuration the `` @xmath483 '' in   equals @xmath484 .",
    "( 0,0)(0,0 ) ( -4,-65)@xmath66    consider now a particular case , when one of the newborn singularities @xmath485 , say , @xmath486 is a simple pole . since @xmath487 , the singularities @xmath475 can not be simple poles simultaneously . making a slit along the short saddle connection joining @xmath488 to @xmath486 we create a surface @xmath489 with geodesic boundary .",
    "note that the cone angle at the singularity @xmath486 was @xmath1 .",
    "this means , that after opening up a slit , the point @xmath486 becomes a regular point of the boundary of @xmath489 , see figure  [ fig : breakin : up : a : zero ] .",
    "in other words , the boundary of @xmath489 corresponds to a single closed geodesic with linear holonomy @xmath80 .      in order to construct the subset",
    "@xmath458 corresponding to configuration ii , we need another surgery . given a flat surface @xmath490 in a stratum of meromorphic quadratic differentials with at most simple poles on @xmath0 , given a pair of singularities @xmath491 on @xmath455 and given a short vector @xmath492 , we construct a surface with two boundary components creating a pair of small holes adjacent to the chosen singularities @xmath491 .",
    "the surgery is performed in such way that the holes have geodesic boundary with linear holonomy @xmath80 .",
    "let @xmath493 be the degrees of singularities @xmath494 respectively .",
    "the corresponding cone angles are @xmath495 and @xmath496 .",
    "thus , there are @xmath497 geodesic rays in linear direction @xmath80 adjacent to @xmath498 and @xmath499 geodesic rays in linear direction @xmath80 adjacent to @xmath500 .",
    "the corresponding surgery is described in section 12.2 in  @xcite and in section 6.1 in  @xcite as the `` _ _ parallelogram construction _ _ '' .",
    "this is a nonlocal construction , so it is not canonical , and it changes slightly the area of the surface . up to this ambiguity (",
    "which can be neglected in our computations as explained in  @xcite and in  @xcite ) , given the data as above , there are @xmath501 ways to construct the described surface with boundary @xmath489 .",
    "take a small disk @xmath481 of radius @xmath423 centered in the origin and consider its quotient @xmath460 over the action of central symmetry .",
    "let the vector @xmath80 vary in @xmath460 .",
    "note that in the contrary to the previous case , the saddle connection is now _",
    "closed_. thus the measure along the fiber has the form @xmath502 and not the form   as before .",
    "this implies that for this configuration the set of parameters of deformation having holonomy vectors in @xmath460 has the measure @xmath503 for this configuration the `` @xmath483 '' in   equals @xmath504 .",
    "now we finally pass to explicit computation of the siegel ",
    "veech constants following the strategy described above .    throughout the rest of this section",
    "@xmath177 denotes any stratum of meromorphic quadratic differentials with at most simple poles on @xmath119 different from the stratum @xmath505 of pillowcases .",
    "[ th : sv : i ] for the configuration @xmath162 of saddle connections of type i , i.e. for saddle connections joining a fixed pair @xmath17 of distinct singularities of orders @xmath506 , the siegel  veech constant @xmath164 is expressed as follows : @xmath507 after plugging in theorem  [ theorem : volume ] , we get : @xmath508    the principal boundary @xmath459 for this particular configuration @xmath162 is obtained by collapsing the saddle connection joining singularities of degrees @xmath142 and @xmath256 .",
    "this operation merges two singularities to a single one of degree @xmath509 .",
    "thus , @xmath510 by   @xmath511 where the `` @xmath512 '' in formula   stands for the measure of the space of parameters of deformation corresponding to holonomy vectors in @xmath460 .",
    "this measure was computed in  .",
    "thus , we can rewrite   as @xmath513 applying   and   to the above expression we obtain  .",
    "we are ready to give a proof of theorem  [ theorem : l : shaped : almost : all ] ( based on   which would be proved in   [ sec : induction ] ) .",
    "let @xmath514 .",
    "let @xmath515 , @xmath516 .",
    "applying   we get @xmath517 . applying theorem  [ theorem : sv : for : billiards ] to the @xmath21-shaped billiard as in figure  [ fig : l : shaped : billiard ] we get the coefficient @xmath518 in the weak asymptotics of the number of generalized diagonals joining a fixed corner with angle @xmath6 with the corner with angle @xmath24 , and thus prove formula  [ eq : theorem : l : shaped : almost : all ] and theorem  [ theorem : l : shaped : almost : all ] .",
    "the configuration @xmath162 of type ii consists of a single separatrix loop emitted from a fixed zero @xmath13 of order @xmath142 such that the total angle @xmath519 at the singularity @xmath13 is split by the separatrix loop into two sectors having the angles @xmath520 and @xmath521 .",
    "we assume that @xmath522 , so we _ do not _ have any cylinders filled with periodic geodesics for this configuration .",
    "the angles satisfy the natural relation @xmath523 which implies , in particular , that @xmath524 .",
    "our saddle connection separates the original surface @xmath151 into two parts .",
    "let @xmath525 be the list of singularities ( zeroes and poles ) which belong to the first part and let @xmath526 be the list of singularities ( zeroes and poles ) which belong to the second part .",
    "this information is part of the configuration of this saddle connection .",
    "we assume that the initial surface @xmath151 does not have any marked points ; as usual we denote by @xmath527 the order of the singularity @xmath192 .",
    "the set with multiplicities @xmath528 representing the orders of all singularities ( zeroes and poles ) on @xmath151 can be obtained as a disjoint union of the following subsets : @xmath529    [ th : sv : ii ] the siegel  veech constant @xmath164 for this configuration is expressed as follows : @xmath530 after plugging in theorem  [ theorem : volume ] we get : @xmath531    let @xmath532 contracting a saddle connection of type ii and detaching the resulting singular flat surface into two components we get a disconnected flat surface @xmath533 , where @xmath465 .",
    "the stratum of disconnected surfaces @xmath534 is the principal boundary for configuration ii . by   @xmath535 by   we have @xmath536 note that by definition @xmath537 .",
    "hence @xmath538 the `` @xmath539 '' in formula   stands for the measure of the space of parameters of deformation corresponding to holonomy vectors in @xmath460 . for configuration @xmath162 of type ii",
    "this measure was computed in  .",
    "thus , we can rewrite   as @xmath540 applying   and   to the above expression we obtain  .",
    "consider a configuration @xmath162 of type iii where we have a single cylinder filled with closed regular geodesics , such that the cylinder is bounded by a saddle connection joining a fixed pair of simple poles @xmath541 on one side and by a separatrix loop emitted from a fixed zero @xmath13 of order @xmath542 on the other side .",
    "this information is considered to be part of the configuration . by convention",
    ", the affine holonomy associated to this configuration corresponds to the closed geodesic and _ not _ to the saddle connection joining the two simple poles .",
    "( such a saddle connection is twice as short as the closed geodesic . )",
    "the siegel  veech constant @xmath164 for this configuration is expressed as follows : @xmath543 after plugging in theorem  [ theorem : volume ] , we get @xmath544    let @xmath545 . consider a configuration of type iii with a short saddle connection @xmath216 joining a zero of degree @xmath142 to itself .",
    "contracting @xmath216 we get a flat surface @xmath455 in the principal boundary stratum @xmath534 .    to go backwards , we need to create a hole on @xmath455 with geodesic boundary having holonomy @xmath369 and attach a cylindrical `` pocket '' to this hole ; see the right picture in figure  [ fig : iii : pocket ] .",
    "the cone angle at the singularity @xmath13 of degree @xmath546 is @xmath547 .",
    "thus , having a surface @xmath468 and a vector @xmath548 there are @xmath142 rays in line direction @xmath549 adjacent to the singularity @xmath13 .",
    "note , however , that now a deformation involves not only the surface @xmath455 from the principal boundary and a holonomy vector @xmath80 , but also additional parameters describing the geometry of the `` pocket '' .",
    "geometrically , a `` pocket '' is equivalent to a flat cylinder endowed with a distinguished line direction and with a marked point on each of the boundary components .",
    "thus , in addition to the holonomy vector @xmath549 representing the waist curve , it is parameterized by the _",
    "@xmath550 of the cylinder and by the _ twist _",
    "@xmath551 of the cylinder , @xmath552 .",
    "parameters @xmath550 and @xmath551 record the information about the holonomy along a saddle connection joining the zero @xmath13 on one side of the cylinder to one of the simple poles , say , @xmath553 on the other side of the cylinder .",
    "the flat area of a `` pocket '' @xmath554 equals @xmath555 .",
    "the measure @xmath269 in @xmath556 disintegrates into the product measure @xmath557 on @xmath339 and the measure @xmath558 on the `` space of pockets '' @xmath559 , @xmath560 the parameter @xmath369 corresponds to the holonomy along a _ closed _ saddle connection , while the parameters @xmath561 correspond to holonomy along a saddle connection joining distinct singularities .",
    "hence , the resulting measure on the space of parameters defining a `` pocket '' is @xmath562    following convention  [ con : area:1:2 ] we denote by @xmath563 the hypersurface of pockets of area @xmath564 .",
    "let @xmath565 .",
    "we denote by @xmath566 the surface proportional to the initial one with the coefficient @xmath286 ; in particular , @xmath567 , see convention  [ con : area:1:2 ] .",
    "we use similar notations @xmath568 and @xmath569 for surfaces from @xmath339 and from @xmath559 correspondingly .",
    "we recall that the volume elements in the strata and the area elements on the corresponding `` unit hyperboloids '' are related as follows , see  : @xmath570    let @xmath490 .",
    "consider a surface @xmath568 , where @xmath571 ; it has area @xmath572 .",
    "define @xmath573 to be the set of pockets , such that performing an appropriate surgery to @xmath568 and pasting in a `` pocket '' from @xmath574 we get a surface @xmath575 . ignoring a negligible change of the area of the surface @xmath576 after creating a hole , we get the following two constraints .",
    "the first constraint imposes the bound on the area @xmath577 of a pocket @xmath578 , where @xmath579 : the total area of the compound surface @xmath151 should be at most @xmath275 , so @xmath580 .",
    "the second constraint imposes a bound on the the length of the waist curve of the cylinder : after rescaling proportionally the compound surface @xmath151 to let it have area @xmath564 we should get a waist curve of length at most @xmath423 .",
    "thus , the waist curve of the original cylinder should be at most @xmath581 .",
    "clearly , the set @xmath574 does not depend on the particular surface @xmath582 , but only on the parameters @xmath583 and @xmath423 .",
    "we have seen that there are @xmath142 rays in line direction @xmath549 adjacent to the singularity @xmath13 . using the above notations we can represent the volume of a cone in @xmath308 over @xmath584 ( see   for the definition of a _ cone _ ) as @xmath585    denote by @xmath586 the volume of the @xmath423-thin part of the `` unit hyperboloid '' in the space of `` pockets '' : @xmath587 from the definition of the subset",
    "@xmath574 it immediately follows that its volume is expressed by the following integral @xmath588 thus , we need to evaluate the following integral @xmath589    @xmath590    we first evaluate the volume @xmath591 of the corresponding cone .",
    "pockets belonging to this cone are described by the following conditions : @xmath592 hence @xmath593 where @xmath594 .",
    "it remains to apply  : @xmath595 and to note that @xmath596 .",
    "having found the expression @xmath597 we can rewrite the integral   as @xmath598 taking into consideration that @xmath599 we compute the above integrals and get @xmath600    it remains to note that @xmath601 see  , and that @xmath602 to get @xmath603 applying   and   to the above expression we obtain  .",
    "the rest of the discussion in  [ sec : subsec : sv : pocket ] also depends on theorem  [ theorem : volume ] .",
    "consider a slightly more general configuration : as before we consider a fixed pair of simple poles @xmath541 , but this time we do not specify which zero do we have at the base of the cylinder .",
    "clearly the corresponding siegel ",
    "veech constant @xmath604 is equal to the sum of the siegel ",
    "veech constants considered above over all zeroes @xmath13 on our surface @xmath151 : @xmath605 the following corollary follows immediately from the formula   above .    for any stratum of meromorphic quadratic differentials with at most simple poles and with no marked points on @xmath0 and for every fixed pair @xmath541 of simple poles ,",
    "the siegel  veech constant @xmath604 is equal to @xmath606    by assumption the stratum @xmath317 does not contain marked points .",
    "we can order @xmath142 in the reverse lexicographic order , so that @xmath607 are positive ( i.e. correspond to the zeroes ) and @xmath608 are equal to @xmath85 ( i.e. correspond to the simple poles ) .",
    "since we live on @xmath0 we have @xmath609 which is equivalent to @xmath610 .",
    "hence , @xmath611    note that theorem  [ theorem : pi:2:general ] counts the number of generalized diagonals joining two fixed corners of a right - angled billiard , while in the `` pocket '' configuration we count the number of closed flat geodesics on the induced cylinder , which are twice longer .",
    "rescaling , we get an extra factor 4 for the counting problem in this alternative normalization . applying theorem  [ theorem : sv : for : billiards ] , and taking into consideration the factor @xmath612 in formula   we get the answer @xmath613 plugging in expression   for @xmath614 we get formula  .      .",
    "[ sec : subsec : sv : dumbell ]    consider a configuration @xmath162 of type iv , where we have a single cylinder filled with closed regular geodesics , such that the cylinder is bounded by a separatrix loop on each side .",
    "we assume that the separatrix loop bounding the cylinder on one side is emitted from a fixed zero @xmath13 of order @xmath542 and that the separatrix loop bounding the cylinder on the other side is emitted from a fixed zero @xmath14 of order @xmath615 .",
    "such a cylinder separates the original surface @xmath151 in two parts ; let @xmath525 be the list of singularities ( zeroes and simple poles ) which get to the first part and @xmath616 be the list of singularities ( zeroes and simple poles ) which get to the second part . in particular , we have @xmath617 and @xmath618 .",
    "we assume that @xmath151 does not have any marked points . denoting as usual by @xmath527 the order of the singularity @xmath192 we can represent the sets with multiplicities @xmath619 as a disjoint union of the two subsets @xmath620",
    "this information is considered to be part of the configuration .",
    "[ th : sv : iv ] the siegel  veech constant @xmath164 for this configuration is expressed as follows : @xmath621 plugging in theorem  [ theorem : volume ] we get : @xmath622    the proof is completely analogous to computation of the siegel  veech constant for configuration iii .",
    "denote by @xmath341 the set with multiplicities obtained from @xmath623 by replacing the entry @xmath142 by @xmath624 .",
    "similarly , denote by @xmath342 the set with multiplicities obtained from @xmath625 by replacing the entry @xmath256 by @xmath626 .",
    "define @xmath627 . contracting the two saddle connections we get a disconnected flat surface @xmath455 in the principal boundary stratum @xmath339 .",
    "given a flat surface @xmath628 and a holonomy vector @xmath369 we have @xmath142 separatrix rays in direction @xmath80 adjacent to the point @xmath13 of @xmath455 and @xmath256 separatrix rays in direction @xmath80 adjacent to the point @xmath14 .",
    "following line - by - line the proof of   in the previous section we get an expression for @xmath629 completely analogous to  : the only adjustment consists in replacing the factor @xmath142 by the product @xmath630 : @xmath631 applying expression   from   [ sec : subsec : strata : of : disconnected : surfaces ] for @xmath462 and taking into consideration that @xmath632 we can rewrite the latter expression as @xmath633 applying   and   to the above expression we obtain  .",
    "consider an @xmath50-invariant manifold in a stratum of abelian differentials or a @xmath367-invariant manifold in a stratum of quadratic differentials .",
    "denote by @xmath635 the associated siegel ",
    "veech constant responsible for counting the maximal cylinders of closed geodesics and denote by @xmath636 the siegel  veech constant responsible for counting the cylinders of closed geodesics counted with weight @xmath637    in  @xcite ya .",
    "vorobets proved the following result :    for any connected component @xmath638 of any stratum of abelian differentials and for almost any flat surface @xmath639 the ratio of siegel  veech constants @xmath640 satisfies the following relation : @xmath641    note that a configuration of omologous saddle connections of @xmath0 involves at most one cylinder .",
    "the following proposition states the vorobets formula for individual configurations involving cylinders for strata of meromorphic quadratic differentials with simple poles on @xmath0 .",
    "[ pr : vorobets : constant ] for any stratum @xmath137 of meromorphic quadratic differentials with simple poles on @xmath0 and for any admissible configuration @xmath162 of saddle connections involving a cylinder the following equality holds : @xmath642    the proof consists in an elementary adjustment of the computation from the previous two sections .",
    "we will present the computation of @xmath643 for the `` pocket configuration '' ( configuration of type iii ) following the analogous computation in   [ sec : subsec : sv : pocket ] . the computation for the configuration of type iv is completely analogous and is omitted .",
    "this time we have to compute the integral of the ratio @xmath644 of the area @xmath645 of the cylinder over the total area @xmath646 of the entire surface .",
    "we integrate this expression over @xmath584 .",
    "note that this ratio is the same for proportional surfaces .",
    "thus we can integrate with respect to the corresponding cone @xmath647 : @xmath648 moreover , the ratio of the corresponding siegel  veech constants satisfies @xmath649 the denominator @xmath650 of the above ratio is given by  . to evaluate the integral in the numerator",
    "we modify   by multiplying the function inside the integral by an extra factor @xmath651 obtaining : @xmath652 taking into consideration that @xmath599 and evaluating the latter integral we obtain @xmath653 plugging   and   into expression   and recalling the definition @xmath654 we obtain @xmath655 which completes the proof of proposition  [ pr : vorobets : constant ] .",
    "proposition  [ pr : vorobets : constant ] immediately implies the following statement .",
    "[ cr : vorobets : formula ] for any stratum @xmath137 of meromorphic quadratic differentials with simple poles on @xmath0 the siegel  veech constant @xmath636 is expressed in terms of the siegel ",
    "veech constants of configurations as follows : @xmath656",
    "in this section , we prove theorem  [ theorem : volume ] .",
    "the approach taken here is somewhat indirect .",
    "the idea is to prove the formula theorem  [ theorem : volume ] for the volume by induction , using the formulas expressing siegel ",
    "veech constants in terms of the volumes .",
    "namely , by ( * ? ? ?",
    "* theorem  3 ) one has :    @xmath657    on the other hand , by the vorobets formula applied to @xmath0 ( see corollary  [ cr : vorobets : formula ] in   [ sec : subsec : carea ] ) one has @xmath658    in view of  [ sec : subsec : configurations ] , for @xmath0 there are exactly two configurations containing a cylinder : a `` pocket '' and a `` dumbbell '' .",
    "the formulas for the siegel ",
    "veech constants were given in ",
    "[ sec : siegel : veech ] .",
    "taking into consideration that @xmath659 , for any collection @xmath660 of integers in @xmath661 satisfying the relation @xmath662 we get the following identity : @xmath663 if we plug in the expressions ( [ eq : ratio : siegel : veech : constant : pocket ] ) and ( [ eq : ratio : siegel : veech : constant : dumbell ] ) into ( [ eq : carea : carea ] ) , we get a formula of the form : @xmath664 the formulas ( [ eq : recurrence : volumes ] ) clearly determine the volumes .",
    "thus , to prove theorem  [ theorem : volume ] , it is enough to show that the expressions for the volumes given by theorem  [ theorem : volume ] satisfy the recurrence relation ( [ eq : recurrence : volumes ] ) , or equivalently to prove the following :    [ theorem : carea : identity ] the explicit expressions ( [ eq : siegel : veech : constant : pocket ] ) and ( [ eq : siegel : veech : constant : dumbell ] ) for the siegel ",
    "veech constants satisfy the identity ( [ eq : carea : carea ] ) .",
    "the proof of the theorem  [ theorem : carea : identity ] is quite involved and is done in appendix  [ sec : appendix : identity ] .",
    "this completes the proof of theorem  [ theorem : volume ] .",
    "in this section we will prove theorem  [ theorem : sv : for : billiards ] .",
    "we modify appropriately the strategy from   [ sec : subsec : reduction : to : ergodic : theory ] to obtain the asymptotic formula ( [ eq : sv : for : billiards ] ) .",
    "the key tool is theorem  [ theorem : bikhoff : chaika ] proved by jon chaika in appendix  [ sec : chaika ] .      for @xmath665 ,",
    "define @xmath666 a similar calculation to ( [ eq : circ : av ] ) shows that , for @xmath380 the indicator function of the trapezoid @xmath381 , @xmath667 to study the convergence of the integral @xmath668 we switch the order of integration , to obtain @xmath669 let @xmath670 by theorem  [ theorem : bikhoff : chaika ] , we know that for almost every @xmath671 , and almost every @xmath672 , we have @xmath673 let us fix @xmath9 to be in this full measure set . to prove the convergence of @xmath674 we follow an argument from  @xcite .",
    "note that if @xmath409 were continuous and compactly supported , the dominated convergence theorem would yield the result .",
    "we will approximate @xmath409 by such functions .",
    "fix @xmath675 , let @xmath676 be a continuous function with @xmath677    here , @xmath678 denotes the length of the shortest saddle connection on @xmath78 .",
    "the function @xmath679 is a smoothed version of the indicator function of the compact part of the stratum @xmath300 .",
    "we introduce some more notation . given @xmath680 , define @xmath681 with this notation , our integral   is given by @xmath682 for any @xmath665 ,",
    "@xmath683    we follow  ( * ? ? ?",
    "* , proof of theorem 2.4 ) .",
    "fix @xmath684 .",
    "* theorem 5.1 ) shows there is a @xmath685 so that for all @xmath406    @xmath686    on the other hand , @xmath687 implies @xmath688 , so    @xmath689    thus , @xmath690    ( * ? ? ?",
    "* theorem 5.2 ) states that for @xmath691 , there is a @xmath692 so that for all @xmath693 ,    @xmath694    since @xmath695 is continuous and compactly supported , for any @xmath9 from the set of full measure to which theorem  [ theorem : bikhoff : chaika ] applies we get    @xmath696    so we have    @xmath697    and    @xmath698    combining ( [ eq : atliminf ] ) and ( [ eq : atlimsup ] ) and letting @xmath699 , we obtain our desired result .",
    "theorem  [ theorem : sv : for : billiards ] is proved .",
    "we complete this section with the proof of theorem  [ theorem : narea : weak : asymp ] from   [ sec : subsec : introduction : beginning ] .",
    "the proof is completely analogous to the proof of theorem  [ theorem : sv : for : billiards ] above ; we just have to carefully follow the normalization which is different from the previous case .    by  (",
    "* theorem  3 ) one has : @xmath700 the length of a closed trajectory in @xmath9 is the same as the length of the associated closed geodesic on the covering flat sphere @xmath151 . by definition , the area of the band of closed trajectories on @xmath9 is the same as the area of each of the maximal cylinders on @xmath0 .",
    "however , the flat area of @xmath151 is twice the area of @xmath9 .",
    "thus , the ratio @xmath701 is twice larger then the corresponding ratio @xmath702 taking into consideration that the bands of closed trajectories in the polygon @xmath9 are in the natural one - to - two correspondence with the maximal cylinders of closed regular geodesics on the covering flat sphere @xmath151 , see figure  [ fig : billiard : and : sphere ] , we get @xmath703 it remains to note that @xmath704 to conclude that the constant in the weak quadratic asymptotic   in theorem  [ theorem : narea : weak : asymp ] is one half of the siegel  veech constant @xmath705 from  .",
    "in this appendix , we prove theorem  [ theorem : carea : identity ] .",
    "let @xmath706 be the degrees of zeroes only .",
    "let the number @xmath57 of simple poles is expressed as @xmath707 .",
    "the total number @xmath708 of all singularities is , thus , expressed as @xmath709 .    for each choice of the zero in the `` pocket '' configuration",
    "there are @xmath710 ways to chose a pair of distinguished poles . for each partition of the set",
    "@xmath711 enumerating the zeroes into two nonempty subsets @xmath712 ( which makes part of the `` dumbbell '' configuration ) there are @xmath713 ways to partition the simple poles between two parts of the `` dumbbell '' . taking into consideration this counting and plugging in the explicit conjectural expressions   and   for the siegel ",
    "veech constants @xmath164 into   we observe that the right - hand - side of   can be read as @xmath714 \\\\ 2 \\\\ \\end{array}\\right ) \\right .",
    "\\ + \\\\ \\\\+\\",
    "\\sum_{1\\le i < j \\le m}(d_i+1)(d_j+1 ) \\sum_{\\substack { \\text{partitions of } \\{1, ... ,m\\}\\text { into}\\\\ \\{i_1,\\dots , i_{m_1}\\}\\sqcup \\{j_1,\\dots",
    ", j_{m_2}\\}\\\\ \\text{such that } i\\text { is in the first subset}\\\\ \\text { and } j\\text { is in the second subset } } }    \\frac{\\big(4+\\sum_{i=1}^m d_i\\big ) ! } { \\big(2+\\sum_{i=1}^{m_1 } d_i\\big ) !",
    "\\big(2+\\sum_{j=1}^{m_2 } d_j\\big ) ! } \\cdot     \\\\ \\\\ \\left . \\frac { \\big(2 - 3+\\sum_{i=1}^{m_1 } ( d_i+1)\\big ) ! \\big(2 - 3+\\sum_{j=1}^{m_2}(d_j+1)\\big ) ! } { \\big(\\sum_{i=1}^m ( d_i+1)\\big ) ! } \\right)\\,.\\end{gathered}\\ ] ]    multiplying both parts of the conjectural identity by the common factor @xmath715 moving the binomial coefficient @xmath716 \\\\ 2 \\\\ \\end{array}\\right)\\ ] ] coming from the `` pocket '' configuration to the left - hand - side of the identity and simplifying the resulting expressions we get the following conjectural identity :    @xmath717    this is the identity which we need to prove .    changing the order of the summation we can first sum over all possible partitions of the set of indices @xmath711 and having chosen the partition we consider all possible ways to select a distinguished element @xmath718 in the first subset and a distinguished element @xmath719 in the second subset .",
    "note , however , that we will see each of the elements of the above sum twice . thus , collecting the resulting sums we can rewrite the sum in the right - hand - side of the above expression as follows : @xmath720 hence , we can rewrite the right - hand - side in   as a sum over the ratios of binomial coefficients : @xmath721\\\\ 2+\\sum_{l=1}^{m_1 } d_{r_l } \\\\",
    "\\end{array}\\right ) } { \\left(\\begin{array}{c } \\sum_{i=1}^m ( d_i+1 ) \\\\ [ -\\halfbls]\\\\ \\sum_{l=1}^{m_1 } ( d_{r_l}+1 ) \\\\",
    "\\end{array}\\right ) } \\,.\\end{gathered}\\ ] ]    finally , omitting the conditions that the subsets of the partition are nonempty , we get two extra terms .",
    "it is immediate to verify that their sum is equal to @xmath722 and , thus , we can rewrite the needed conjectural identity   as follows : @xmath723\\\\ 2+\\sum_{l=1}^{m_1 } d_{r_l } \\\\",
    "\\end{array}\\right ) } { \\left(\\begin{array}{c } \\sum_{i=1}^m ( d_i+1 ) \\\\ [ -\\halfbls]\\\\ \\sum_{l=1}^{m_1 } ( d_{r_l}+1 ) \\\\",
    "\\end{array}\\right ) } \\,.\\end{gathered}\\ ] ]    we will show that ( [ eq : apr2012 ] ) is valid for any nonempty collection of nonnegative integers @xmath724 .",
    "let @xmath725 be the total number of entries @xmath140 in the set ( with multiplicities ) @xmath724 .",
    "the left - hand - side of conjectural identity   can be expressed as @xmath726    the right - hand - side can be represented in terms of @xmath725 as @xmath727    note now that the common factor is ( up to four missing factors ) is a multinomial coefficient and that the bottom line is a product of two `` complementary '' multinomial coefficients ( with two missing factors each ) .      to simplify the otherwise complicated factorials and terms",
    ", we introduce some notation : @xmath728 , and @xmath729 are all @xmath55-tuples .",
    "we will think of @xmath730 , and @xmath731 as variables .",
    "we write @xmath732 where @xmath733 are the standard basis vectors .",
    "let @xmath57 denote an integer .",
    "inner product : :    @xmath734    is the standard inner product . factorials : :    @xmath735 multinomial coefficients : :    @xmath736 deletion of variables : :    here , we can have @xmath737 :    @xmath738 powers : :    @xmath739    we redefine notations @xmath740 and @xmath55 denoting from now on by @xmath740 the original set @xmath724 with suppressed multiplicities . in other words , we define the new @xmath740 as the set of distinct entries of the original set @xmath724 .",
    "we also redefine @xmath55 denoting by @xmath55 the cardinality of the new set @xmath740 . applying manipulations performed in   [ sec : subsec : multinomial : coefficients ]",
    "we can rewrite the identity we need to prove in the following way : @xmath741\\\\ { \\mathbf{n}}\\end{array}\\right ) \\stackrel{?}{= } \\\\ \\stackrel{?}{= } \\sum_{{\\mathbf{k}}=0}^{{\\mathbf{n } } } \\cfrac{1}{\\big(1+({\\mathbf{d}}+{\\mathbf{1}})\\cdot { \\mathbf{k}}\\big)\\big(2+({\\mathbf{d}}+{\\mathbf{1}})\\cdot { \\mathbf{k}}\\big ) } \\,\\cdot \\left(\\begin{array}{c } 2+({\\mathbf{d}}+{\\mathbf{1}})\\cdot { \\mathbf{k}}\\\\ [ -\\halfbls]\\\\ { \\mathbf{k}}\\end{array}\\right)\\cdot \\\\ \\cdot\\ , \\cfrac{1}{\\big(1+({\\mathbf{d}}+{\\mathbf{1}})\\cdot ( { \\mathbf{n}}-{\\mathbf{k}})\\big)\\big(2+({\\mathbf{d}}+{\\mathbf{1}})({\\mathbf{n}}-{\\mathbf{k}})\\big ) } \\,\\cdot \\left(\\begin{array}{c } 2+({\\mathbf{d}}+{\\mathbf{1}})\\cdot ( { \\mathbf{n}}-{\\mathbf{k}})\\\\ [ -\\halfbls]\\\\ { \\mathbf{n}}-{\\mathbf{k}}\\end{array}\\right)\\,.\\end{gathered}\\ ] ]      we define @xmath742 and @xmath743    in terms of these generating functions , the conjectural identity to be proved becomes @xmath744      our main tools are the combinatorial identities developed by  @xcite .",
    "we recall formulas ( 31 ) and ( 32 ) of  @xcite , in our own notation . given @xmath745 , @xmath746 , define the _ mohanty coefficient _",
    "@xmath747 we have    [ mh][mohanty  @xcite , ( 31 ) and ( 32 ) ] with notation as above , we have @xmath748 where @xmath749    since we will use only one @xmath750 , namely @xmath751 , we will abbreviate the mohanty coefficient by defining @xmath752 .    in the rest of the appendix",
    "we prove :    [ theorem : id ] @xmath753 more precisely , @xmath754 where @xmath81 is as in mohanty s formula theorem  [ mh ] for @xmath752 , so @xmath755    to prove this formula , we will derive formulas for @xmath756 (  [ sec : f ] ) and @xmath757 (  [ sec : g ] ) , and show ( [ eq : id ] ) .      our first lemma is the formula for @xmath756 :    [ lemma : f ] @xmath758 where @xmath759    we expand the right hand side using mohanty s formula , and equalize the @xmath760 terms of the right hand and left hand sides .",
    "the right hand side expands , term - by - term , as :    @xmath761    @xmath762    @xmath763 the @xmath760 terms of each of the second and third expressions can be read off directly . for the first , we have :    @xmath764 observing that @xmath765 we can re - write this as    @xmath766 thus , our identity reduces to showing that :    @xmath767 is the sum of @xmath768 and @xmath769 multiplying through by @xmath770 our identity reduces to showing that @xmath771 equals @xmath772 moving the last term to the left hand side , and canceling the resulting @xmath773 , our identity reduces to : @xmath774 which is the basic identity for multinomial coefficients @xmath775 with @xmath776 .      our second main lemma is a formula for @xmath757 :    [ lemma : g ] @xmath777    before we prove this lemma , we prove theorem  [ theorem : id ] assuming it .",
    "we want to show ( [ eq : id ] ) assuming lemma  [ lemma : g ] ( and lemma  [ lemma : f ] ) , that is , we want to show @xmath778 expanding @xmath779 using @xmath758 we obtain @xmath780 expanding this expression for @xmath779 , expanding the second term in the ride - hand side of   and simplifying , we obtain three types of terms in the resulting expression for the right - hand side of  :    simple powers : :    @xmath781 single sums : :    @xmath782 double sum : :    @xmath783    expanding lemma  [ lemma : g ] in a similar fashion , we have the corresponding terms for @xmath784 :    simple powers : :    @xmath781 single sums : :    @xmath785 double sum : :    @xmath786    a quick inspection shows that the simple powers and single sums are equal . for the double sum , we need to combine the @xmath787 and @xmath788 terms in both sums ( note that the terms are identical in the @xmath789 expansion , but not in the @xmath757 expansion ) , and check their equality .",
    "the @xmath789 term is thus @xmath790 and the @xmath757 term is @xmath791 to check their equality , we reorganize and obtain : @xmath792 cancelling and cross - multiplying , this reduces to @xmath793 which is easily verified .",
    "recall that the @xmath760 term for @xmath757 is @xmath794 we observe @xmath795 and write @xmath796 using these , we rewrite the term ( [ eq : gterm ] ) as the product of three terms :    numerator : :    @xmath797 partial fractions : :    @xmath798 multinomial coefficient : :    @xmath799    we consider terms from this triple product in turn .      first , we consider the individual term @xmath801 keeping the @xmath802 term outside for now , and considering only the first part of the difference , we are interested in @xmath803 expanding @xmath804 we first consider @xmath805 now expanding @xmath806 , we have the terms @xmath807 and @xmath808 collecting all of these , we have @xmath809 next , we work with the factor @xmath810 these @xmath800 terms come with the factor of @xmath811 so we have that their total contribution is : @xmath812 summing over @xmath813 , we obtain , using mohanty s formula , @xmath814      we now expand the @xmath815-terms , keeping @xmath816 on the outside for now .",
    "that is , we consider @xmath817 as above , we first work with the term @xmath818 the @xmath819 term can be split up into individual terms , and as above , we have @xmath820 the @xmath821 term yields @xmath822 thus we have @xmath823 we are left with the term @xmath824 combining the above , and recalling the coefficient of @xmath816 , and summing over @xmath813 we have the total contribution of the @xmath815-terms : @xmath825      to conclude , we combine equations ( [ eq : ki ] ) and ( [ eq:32 ] ) to obtain @xmath826 collecting terms , we have @xmath827 finally , using @xmath828 we get @xmath829 substituting this into our expression for @xmath757 , we obtain as desired @xmath830",
    "in this appendix we describe the original approach to calculating the volume of the moduli space of abelian and quadratic differentials suggested by , m.  kontsevich , and the authors , and developed with success by a.  eskin and , see  @xcite .",
    "this approach was also used in  @xcite and  @xcite .",
    "the key idea is to translate the volume calculation into a counting problem for `` integer points '' , which geometrically correspond to _ square - tiled surfaces _ for the moduli spaces of abelian differentials and to _ pillowcase covers _ for the moduli spaces of quadratic differentials .    in  [ subsec : integer : points ] we show why volume calculation is equivalent to counting the lattice points . in ",
    "[ subsec : lattice : square : tiled : pillowcase ] we recall the definitions of the _ pillowcase orbifold _ and of the _ pillowcase cover _ and show that counting of lattice points is equivalent to the counting problem for pillowcase covers and prove theorem  [ th : pillowcases : as : volume ] .",
    "the volume of a stratum @xmath274 is defined by   as @xmath831 where @xmath297 is the total volume of the `` cone '' @xmath298 measured by means of the volume element @xmath269 on @xmath177 defined in   [ sec : subsec : notmalization ] .",
    "the total volume of the cone @xmath832 is the limit of the appropriately normalized riemann sums .",
    "the volume element @xmath269 is defined as a linear volume element in cohomological coordinates , normalized by certain specific lattice .",
    "chose a positive @xmath423 such that @xmath833 is integer , and consider a sublattice of the initial lattice of index @xmath834 partitioning every side of the initial lattice into @xmath833 pieces .",
    "the corresponding riemann sums count the number of points of the sublattices which get inside the cone .",
    "thus , by definition of the measure @xmath835 we get @xmath836    we assume that @xmath833 is integer .",
    "note that a flat surface @xmath151 represents a point of the @xmath423-lattice , if and only if the surface @xmath837 ( in the sense of definition  ) represents a point of the integer lattice . denoting by @xmath838 the set of flat surfaces in the stratum @xmath177 of area at most @xmath839 , and taking into consideration that @xmath840 we can rewrite the above relation as @xmath841      let @xmath842 be a lattice , and let @xmath843 be the associated torus .",
    "the quotient @xmath844 by the map @xmath845 is known as the _",
    "pillowcase orbifold_. it is a sphere with four @xmath846-orbifold points ( the corners of the pillowcase ) .",
    "the quadratic differential @xmath82 on @xmath847 descends to a quadratic differential on @xmath119 .",
    "viewed as a quadratic differential on the riemann sphere , @xmath82 has simple poles at corner points .",
    "when the lattice @xmath848 is the standard integer lattice @xmath267 , the flat torus @xmath847 is obtained by isometrically identifying the opposite sides of a unit square , and the pillowcase @xmath119 is obtained by isometrically identifying two squares with the side @xmath275 by the boundary , see figure  [ fig : pillowcase : cover ] .",
    "consider a connected ramified cover @xmath123 over @xmath119 of degree @xmath849 having ramification points only over the corners of the pillowcase .",
    "clearly , @xmath123 is tiled by @xmath850 squares of the size @xmath851 in such way that the squares do not superpose and the vertices are glued to the vertices .",
    "coloring the two squares of the pillowcase @xmath119 one in black and the other in white , we get a chessboard coloring of the square tiling of the the cover @xmath123 : the white squares are always glued to the black ones and vice versa .",
    "[ lm : pillowcase ] let @xmath151 be a flat surface in the stratum @xmath177 .",
    "the following properties are equivalent :    1 .",
    "the surface @xmath151 represents a lattice point in @xmath177 ; 2 .",
    "@xmath151 is a cover over @xmath119 ramified only over the corners of the pillow ; 3 .",
    "@xmath151 is tiled by black and white @xmath851 squares respecting the chessboard coloring .",
    "we have just proved that ( 2 ) implies ( 3 ) . to prove that ( 1 ) implies ( 2 ) we define the following map from @xmath151 to @xmath119 .",
    "fix a zero or a pole @xmath23 on @xmath151 . for",
    "any @xmath852 consider a path @xmath853 joining @xmath23 to @xmath49 having no self - intersections and having no zeroes or poles inside .",
    "the restriction of the quadratic differential @xmath78 to such @xmath853 admits a well - defined square root @xmath854 , which is a holomorphic form on the interior of @xmath216 .",
    "define @xmath855 of course , the path @xmath853 is not uniquely defined . however , since the flat surface @xmath151 represents a lattice point ( see the definition in   [ sec : subsec : notmalization ] ) , the difference of the integrals of @xmath194 over any two such paths @xmath856 and @xmath857 belongs to @xmath267 , so taking the quotient over the integer lattice and over @xmath858 we get a well - defined map . by definition of the pillowcase @xmath119 we have , @xmath859 .",
    "thus , we have defined a map @xmath860 .",
    "it follows from the definition of the map , that it is a ramified cover , and that all regular points of the flat surface @xmath151 are regular points of the cover .",
    "thus , all ramification points are located over the corners of the pillowcase .    a similar consideration shows that ( 3 ) implies ( 1 ) .",
    "let @xmath861 be the number of surfaces in the stratum @xmath177 tiled with at most @xmath849 black and @xmath849 white squares respecting the chessboard coloring .",
    "lemma  [ lm : pillowcase ] allows us to rewrite formula   as follows : @xmath862 taking into consideration   we get @xmath863    now everything is ready to prove theorem  [ th : pillowcases : as : volume ] .",
    "consider a cover of @xmath864 having ramification data @xmath129 , as in   [ sec : subsec : counting : pillowcase : covers ] .",
    "the condition  [ eq : condition : genus:0 ] ensures that such a cover is realizable , and that the genus of the cover is really zero . as the base sphere chose the pillowcase @xmath119 endowed with the quadratic differential @xmath865 .",
    "it has four simple poles at the corners of the pillow and no other singularities . pulling back @xmath82 via @xmath1",
    "gives a quadratic differential on the covering @xmath0 with zeros ( and possibly simple poles ) of multiplicities @xmath131 and @xmath866 and with no other singularities .",
    "thus , by construction the pillowcase cover @xmath867 belongs to @xmath868 .    by",
    "@xcite the leading term in the asymptotics for number of pillowcase covers is the same as if we consider the pillowcase covers ramified only over the corners of our pillow , in such way that all conical singularities of @xmath123 project to the same corner of the pillow , and all preimages of three other corners of the pillow @xmath119 are regular points of the metric .",
    "from now on we consider only such _ square - tiled _ pillowcase covers .",
    "since all preimages of three corners are regular points of the flat metric , they can be tiled with @xmath869 squares , or , equivalently , each pillowcase cover under consideration decomposes into two consecutive covers @xmath870 where @xmath871 is a cover of order @xmath32 of a pillowcase orbifold of size @xmath872 over the standard pillowcase .",
    "thus a pillowcase cover of degree @xmath111 with ramification data @xmath129 uniquely defines a square - tiled pillowcase cover of degree @xmath140 in @xmath868 .",
    "reciprocally , consider an arbitrary square - tiled surface @xmath151 as in lemma  [ lm : pillowcase ] above in the stratum @xmath868 , and let @xmath140 be the degree of the corresponding cover over @xmath119 .",
    "subdividing each square into four ; considering the underlying pillowcase as @xmath873 and postcomposing the initial cover @xmath874 with the cover @xmath875 we get a pillowcase cover with singularity pattern @xmath129 .",
    "this implies that @xmath876 taking into consideration that @xmath877 and applying   we complete the proof of theorem  [ th : pillowcases : as : volume ] .",
    "* notation . * as in  [ sec : subsec : introduction : beginning ] , let @xmath878 be the space of `` directional billiard tables '' , i.e. billiard tables with interior angles @xmath879 and a distinguished direction .",
    "we consider the space @xmath880 with the measure @xmath881 which is the product measure of the lebesgue measure arising from the side lengths and the angular measure @xmath12 .    as described in ",
    "[ sec : subsec : intro : rab : qd ] , given a billiard table @xmath671 one can glue together two copies of @xmath9 to obtain a sphere with a flat metric given by a quadratic differential , which we denote @xmath882 .",
    "thus , there is a canonical local embedding @xmath883 from @xmath880 to @xmath884 where @xmath86 is the stratum of quadratic differentials with zeros of order @xmath885 . using this map",
    ", we may view @xmath880 as a subset of @xmath299 .",
    "let @xmath886 denote the lebesgue ( or masur - veech ) measure on @xmath299 .",
    "let @xmath887 denote the subset of surfaces of flat area @xmath275 ( see convention  [ con : area:1:2 ] ) , let @xmath366 denote the restriction of @xmath835 to @xmath300 .",
    "let @xmath888 denote the intersection of @xmath889 with @xmath300 .",
    "we abuse notation by denoting the restriction of the measure @xmath881 to @xmath888 again by @xmath890 .",
    "we use the notation : @xmath891 we have the relation @xmath892    our strategy is to use a variation of an argument of margulis to obtain equidistribution of circles from exponential mixing of the teichmller geodesic flow ( that is , the @xmath893-action ) on @xmath300 .",
    "this is similar in spirit to ( * ? ? ?",
    "* section 3.6 ) .",
    "in particular , we prove the following theorem :    [ theorem : bikhoff : chaika ] suppose @xmath894 , @xmath380 is 1-lipschitz ( with respect to the euclidean metric induced by local coordinates on @xmath300 ) , @xmath895 and @xmath896 .",
    "then for @xmath897-almost every right angled billiard @xmath882 we have @xmath898      let @xmath899 be the @xmath423-thick part of the stratum , that is , the set of @xmath665 so that all saddle connections on @xmath78 have length at least @xmath423 .",
    "let @xmath900 denote the set of @xmath665 so that the @xmath893-trajectory of @xmath78 eventually ( after time @xmath2 ) spends at least half its life in @xmath901 .",
    "we now fix @xmath675 so that the previous theorem holds and we suppress the dependence on the now fixed @xmath423 .",
    "let @xmath140 be the riemannian distance on @xmath50 induced by the killing form .",
    "a crucial lemma estimates the correlation of @xmath380 with a translate of @xmath380 along a @xmath893-translate of the billiard manifold @xmath905 .",
    "[ theorem : stable ] given a fixed compact part @xmath921 there exists @xmath922 such that if @xmath78 and @xmath923 differ only along a stable manifold for @xmath893 ( that is , if they share the same horizontal foliation ) then @xmath924    consider the billiard manifold @xmath905 and thicken it by @xmath925 along the stable manifold for @xmath893 .",
    "we pick @xmath926 small enough so that the intersection of the resulting set @xmath927 with the support of @xmath380 has a local product structure ( as stable @xmath928 unstable @xmath928 flow ) with respect to the teichmller flow @xmath893 . by proposition",
    "[ prop : map : onto ] , @xmath929 . by corollary",
    "[ hm ] we have that @xmath930 so , by theorem  [ theorem : often : compact ] there exists @xmath931 such that @xmath932 now for each @xmath933 there exists @xmath934 on the same stable manifold which is distance at most @xmath926 away .",
    "it follows from theorem  [ theorem : stable ] that if @xmath551 is large enough and @xmath935 then @xmath936 by our assumption that @xmath380 is nice it follows that @xmath937 denote the operator norm of @xmath50 acting linearly on @xmath304 . by our assumption on @xmath927 and",
    "the fact that @xmath380 is 1-lipschitz it follows that @xmath938 where @xmath939 and @xmath940 .",
    "the proposition follows .",
    "[ small chunks ] let @xmath380 be nice . there exists a ( exponentially decaying ) function @xmath941 such that for any @xmath675 @xmath942 for @xmath897-almost every @xmath943 , @xmath915-almost every @xmath944      we prove theorem  [ theorem : bikhoff : chaika ] assuming proposition  [ small chunks ] . by proposition  [ small chunks ] , for every @xmath945 there exists a @xmath946 such that for any @xmath947 , @xmath948 and a set @xmath151 of @xmath897-measure @xmath949 we have that for each @xmath950 we get a set @xmath951 of @xmath915-measure @xmath949 such that for each @xmath952 we have @xmath953 it follows that for @xmath954 we have @xmath955 because @xmath380 is @xmath65-lipschitz if @xmath956 we have @xmath957 to see that equation [ small ] holds , for fixed @xmath958 we seek to cover all but @xmath959 of @xmath960 by arcs of size @xmath961 centered at @xmath962 .",
    "we do this by picking the first arc at random and in a clockwise direction going to the end of the arc , moving another @xmath963 and picking the closest @xmath388 clockwise from this point that is in @xmath964 , and repeating this process . by our assumption",
    "we skip over a set of measure at most @xmath66 , and the other error can come from missing a last arc at the end of the process .          to prove proposition [ small chunks ] , we estimate the @xmath965-norms of the integrals @xmath970 where we define @xmath971 below .",
    "we have @xmath972 ^ 2}f(g_nr_{x - y}g_{-n}q)f(q)\\ , dx\\ , dy\\ , d\\mu_{\\mathcal{b}}\\end{gathered}\\ ] ] now @xmath973 so the previous expression is @xmath974 ^ 2}f(h^{\\tau}_{e^{-2n}\\tan(x - y)}g_{\\sec(x - y)}h_{e^{2n}x - y}q)f(q)\\,dx\\ , dy\\ , d\\mu_{\\mathcal{b}}= \\ ] ] now let @xmath975 , so @xmath976 and since @xmath380 is @xmath65-lipschitz we can dominate the previous integral by @xmath977 ^ 2}f(h_{e^{2n}x - y}q)f(q)\\,dx\\ , dy\\ , d\\mu_{\\mathcal{b}}+e^{-n}\\leq   \\\\e^{-\\left(2+\\frac{c_2}{2}\\right)n}||f||_{\\infty}^2+c_1e^{-\\lambda ' \\frac { c_2}{2}n}+e^{-n}\\end{gathered}\\ ] ] the last inequality follows from splitting the integral up into the ranges @xmath978 and the complement . then estimate by the supremum on the first part and use proposition [ distributes ] on the second part .",
    "so , there exists @xmath945 such that @xmath979 now , by chebyshev s inequality , we have , for any @xmath980 , that @xmath981 since for any @xmath980 , we have that @xmath982 is summable in @xmath983 , the easy half of the borel - cantelli lemma implies that for @xmath984-almost every @xmath943 , the set of @xmath983 for which @xmath985 is finite . since @xmath114 was arbitrary , the proposition follows .",
    "note that it suffices to check for this convergence along discrete sequences since @xmath380 is @xmath65-lipschitz .",
    "a. zorich , flat surfaces . in collection",
    "`` frontiers in number theory , physics and geometry .",
    ": on random matrices , zeta functions and dynamical systems '' ; ecole de physique des houches , france , march 921 2003 , p. cartier ; b. julia ; p. moussa ; p. vanhove ( editors ) , springer - verlag , berlin , ( 2006 ) , 439586 ."
  ],
  "abstract_text": [
    "<S> we use the relation between the volumes of the strata of meromorphic quadratic differentials with at most simple poles on @xmath0 and counting functions of the number of ( bands of ) closed geodesics in associated flat metrics with singularities to prove a very explicit formula for the volume of each such stratum conjectured by m.  kontsevich a decade ago .    </S>",
    "<S> applying ergodic techniques to the teichmller geodesic flow we obtain quadratic asymptotics for the number of ( bands of ) closed trajectories and for the number of generalized diagonals in almost all right - angled billiards .    </S>"
  ]
}