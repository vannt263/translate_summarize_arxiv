{
  "article_text": [
    "in modern condensed matter research most interesting subjects are only subtle effects which can be investigated only by thorough and systematic studies of large numbers of samples .",
    "even though first investigations have to be done by hand , a lot of time can be saved with automated measurement setups .",
    "such automated systems are already widely used in large scale experiments , but most small laboratory experiments , even though computer controlled , do not allow for automated measurements .",
    "automation is present , to some extent , in order to facilitate measurements in that there frequently are possibilities to have the system execute a certain measurement automatically , but covering easily large parameter spaces is often not possible . commercially available",
    "complete measurement systems , on the other hand , seldom come with sophisticated control software without possibilities for programming long measurement sequences .",
    "of course such software systems are the result of expensive software development which is beyond the possibilities of an ordinary research laboratory . even though there are commercial programs available for some of the instruments that constitute an experimental setup ,",
    "the important part is the interplay between them .",
    "consequently most control software is written by the scientists themselves , who face the lack of time , money and manpower to develop extensive automation software .    in this paper",
    "we present an easy way of creating control software which offers possibilities of programming complex sequences and automatically executes them@xcite .",
    "this is shown to be achieved with moderate development effort using a common laboratory programming language .",
    "we will first present the different architecture approach needed to achieve this goal , after which the addition of automation is a small step .",
    "programs created for control of experiments need to perform several tasks .",
    "firstly , they have to be able to send control commands to the instruments and receive the measured data . secondly , these data are to be processed and displayed and eventually user input needs to be translated to control commands .",
    "various development platforms offer vast libraries of procedures to interface instruments , create user interfaces and perform complicated data processing . these help to reduce the workload associated with creating such software .",
    "labview@xcite , a development environment from national instrumentsfor creating programs ( called virtual instruments or shortly vis ) in its own graphical programming language `` g '' , is probably best known and most widely used for such applications .",
    "`` g '' offers all the flow control structures like loops and conditional branches found in any other programming language .",
    "moreover , any vi can easily be used in any other vi as a subvi .",
    "labview vis consist of a user interface ( ui ) and a block diagram ( bd ) containing the actual code .",
    "programming is done by modelling data flow , where graphical representations of functions and procedures are interconnected by lines , usually called wires .",
    "the designation vi stems from the similarity of such a program to an actual instrument , the ui obviously corresponding to the instrument s front panel and the bd to its internal wiring .",
    "a usual way of creating labview software for measurement control is by writing a main vi containing the ui and the logic for acting appropriately on the user input as well as processing , displaying and saving the data .",
    "communication with the instruments is performed by driver subvis which are regularly executed by the main vi .",
    "when such a driver vi is called to perform a query on an instrument it sends the necessary command to the instrument , waits some time for the instrument to prepare the answer and finally reads this response from the instrument .",
    "usually this process takes tens to hundreds of milliseconds . assuming the whole measurement setup consists of several instruments",
    ", the main vi may be organised in two different ways .",
    "either all driver vis are called sequentially , causing the time needed to collect all data to grow with the number of instruments .",
    "another apprach would be to call the driver vis in parallel , which is possible thanks to the inherently multithreading architecture of labview . in this case , however , all drivers would attempt to access the instruments at the same time . this would result in a `` traffic jam '' in case the instruments are connected to a single interface bus .",
    "some drivers would be forced to wait until the others have finished their writing to the bus . moreover , as some instruments take measurements less often than others , many operations on the bus would be unnecessary because no new data would be obtained .",
    "in this paper we present the use of independent driver vis , which we call handlers , running in parallel and communicating with a main vi by means offered by labview .",
    "this allows for a more efficient use of the interface bus employed to connect the instruments and results in a higher data acquisition rate .",
    "moreover , by employing a `` state machine '' ( sm ) architecture such programs become easier to extend in functionality , to maintain and most importantly allow for the control by a separate program and consequently automation .",
    "torque measurement setup overview , which was automated using the presented software .",
    "a cryostat is placed between the poles of an iron yoke magnet , which is freely rotatable .",
    "the torque sensor is inserted into the cryostat and connected to readout electronics .",
    "all instruments needed to control the experiment s state are connected to a personal computer.,width=302 ]    the programs presented here were developed to control and automatise a torque magnetometry apparatus which was built in our group@xcite .",
    "such a device is used to measure a sample s magnetic moment @xmath0 by the torque @xmath1 it experiences due to a magnetic field @xmath2 .",
    "it is well suited for investigation of anisotropic magnetic phenomena as found in most high temperature superconductors .",
    "torque magnetometry is complementary to most other magnetometry techniques in that it is only sensitive to the part @xmath3 of @xmath4 perpendicular to the applied field .",
    "a torque measurement is fast  one measurement taking a fraction of a second only  and due to the proportionality @xmath5 reaches high sensitivities for @xmath3 in high fields .",
    "our home made torque magnetometer system , shown schematically in fig .",
    "[ torquesetup ] , consists of a flow cryostat between the poles of an iron yoke magnet which is sitting on a rotatable support . the torque sensor with a sample mounted on it is inserted into the cryostat and connected to a lock - in amplifier ( lia ) for read out .",
    "details of the measurement principle are beyond the scope of this article and are described elsewhere @xcite .",
    "all devices needed to control and measure the system s state are connected to a windows pc via an ieee-488 general purpose interface bus ( gpib ) , rs-232 serial connections and indirectly via additional analog and digital input and output ports present in the lia instrument .",
    "the main parts are the eg&g model 7265 lia , a lakeshore drc 93a temperature controller , and the bruker bh-15 magnetic field controller .",
    "additional devices such as a pressure transducer with read out electronics for monitoring the exchange gas pressure in the cryostat or current sources and volt meters for specialized applications may also be connected via the gpib .",
    "the gpib is an interface bus which is widely used in scientific instruments .",
    "it features 8-bit parallel data transfer , handshaking and real - time response capabilities .",
    "architecture of the torque control software system .",
    "all vis ( torque.vi , dataserver.vi and the handler*.vis ) execute in parallel .",
    "commands are sent along the solid right pointing arrows and data propagates back along the dashed left pointing arrows . ]    the architecture of the newly developed control software is shown in fig .",
    "[ overview ] .",
    "each instrument connected to the system is represented by a vi counterpart called _",
    "all handlers are managed by the _ dataserver.vi",
    "_ vi which communicates with the _ torque.vi _ vi , which is the main application .",
    "all these vis run independently in parallel .",
    "this way each _",
    "handler.vi _ can be optimised to take best advantage of the instrument it is built for .",
    "this includes the waiting times needed for communication , an optimized data rate based on varying needs as well as the use of each instruments ability to signal special events via the gpib .",
    "since all _ handler.vis _ run in parallel , their individual write  wait  read cycles needed to talk to the instruments are interlaced , thus reducing the bus idle time .",
    "moreover each instrument is talked to only when necessary thus reducing the bus occupation while retaining data quality .",
    "this can be optimised particularly well by exploiting the service request ( srq ) functionality of the gpib .",
    "each instrument can signal a number of events to the gpib controller by asserting the special srq line .",
    "such events might be error conditions but can also be indicators of data availability . as an example the lakeshore temperature controller is programmed to assert the srq line whenever a new temperature reading is ready .",
    "as this occurs only every two seconds , the instrument is read only when really necessary instead of reading the same data several times per second .",
    "even instruments not offering such functionality can be optimised by reducing the rate at which the _",
    "is instructed to read the instrument .",
    "this enables the more crucial measurements to be read more often resulting in data taken at a higher rate and resulting in better quality .",
    "because the _",
    "_ are not called as subvis by the main vi a special means of communication needs to be established . here",
    "we present the use of _ queues _ for sending commands to the _ handler.vis _ and _ datasockets _ for receiving the measured data .",
    "a _ queue _ is a first  in  first  out style memory construct which is offered by labview .",
    "it may contain a fixed or unlimited number of string entries , in our case commands . by use of special subvis any vi can append commands to a _",
    "queue s _ end or retrieve the oldest commands .",
    "any read entry is automatically removed .",
    "_ queues _ are identified by a name , making access to them fairly easy . in most applications a given _ queue _ is read by only one vi whereas several vis may write to it .",
    "_ datasockets _ are memory constructs as well , identified by a unique name , but only contain the most recent datum .",
    "their data type can be freely chosen among the data types in labview .",
    "the _ datasockets _ used in our case are arrays of floating point numbers containing a _ handler.vis",
    "_ main data .",
    "the _ dataserver.vi _",
    "mentioned above serves as an intermediate vi which collects all the _ handler.vis _ data and puts all together in a separate _ datasocket _ which is then read by the _ torque.vi _ main vi .",
    "thus the main vi needs no knowledge about which data to obtain from which instrument .",
    "schematic illustration of the vi s basic structure .",
    "an all enclosing main loop executes infinitely .",
    "the logic inside consists of a command stack whose first element is divided into instruction and argument .",
    "the instruction is used as the selector value into a case structure containing the code for the individual instructions .",
    "this results in the command parsing functionality needed for the operation .",
    "internal data needed for the vi s execution is passed through each iteration and can be read and modified by each command case . ]    in order for the vis to be able to act accordingly on the possible commands they must be given some command parsing functionality .",
    "in fact such a command parser is every vi s core part : even the regular operations performed by the vis are put into commands which are executed repeatedly .",
    "essentially , all vis are designed as command driven state machines ( sm ) .",
    "the use of the sm paradigm in labview programs was already proposed at several occasions and given labview s capabilities this is not surprising .",
    "nevertheless , to our knowledge only few applications make use of this architecture .",
    "the basic idea is that by being executed , a program goes through various named states .",
    "the order in which these states are visited may be fixed and defined in advance or the state to follow might be determined based on the current state s result .",
    "the implementation in labview is fairly simple and schematically shown in fig .",
    "[ figparser ] .",
    "an infinitely running loop contains a case structure consisting of all the states .",
    "these states are identified by character strings and are therefore easily human readable .",
    "in contrast to other methods , where the identification is by numbers or special enumeration data types , this makes the structure easy to extend and maintain .",
    "additionally to these structures the vis contain a command stack and some internal data needed for execution . upon startup , when the command stack is empty , a default case ( state ) is executed .",
    "usually this is the `` getcommands '' case .",
    "this case contains the code needed to empty this vi s _ queue _ and a set of default commands which are put onto the command stack .",
    "when the main loop is iterated for the second time , the oldest command is removed from the stack , split into an instruction and optional arguments , whereupon this instruction is fed into the case structure selector , defining the case to be executed .",
    "this case may add more commands to the stack or simply perform a specific task .",
    "when the case is finished , the main loop iterates again , the next command is removed from the stack and so on . whenever the stack becomes empty , the default case `` getcommands '' is executed again and refills it .",
    "because the _",
    "_ are independent programs not having to rely on being called regularly by a master vi they can be used to carry out more complex tasks than just talking to the instruments . as an example",
    "_ handlerlakeshore.vi_ , the _",
    "handler.vi _ for the lakeshore temperature controller contains logic to control the temperature by software through control of the coolant flow in the cryostat .",
    "the flow controller is connected to a separate digital  to  analog converter ( dac ) , thus enabling the _ handlerlakeshore.vi _ to control it by sending commands to the dac s",
    "_ handler.vi _",
    "( _ handlerdac.vi_ ) .",
    "keeping track of the last few seconds of measured data , calculating their time trends and publishing it to the _ datasocket _ is coded into a command and performed by the _",
    "_ as well .",
    "as mentioned earlier , all vis are organized as state machines , even the main vi _ torque.vi_. as shown in fig .",
    "[ automation ] every user action ( button press , value change ) on its user interface ( ui ) is transformed into a command by the ui - handler which is then sent to and processed in the sm .",
    "the sm then sends appropriate commands to the _",
    "dataserver.vi _ and the _ handler.vis _ ( wide arrow ( 1 ) in fig .",
    "[ automation ] ) .",
    "these two parts ( ui - handler and sm ) are independently running components of _ torque.vi_. the communication between them is again ensured via _",
    "queues_. this enables other vis , such as the _ sequencer.vi _ shown in fig .",
    "[ automation ] to be used to control the sm in _ torque.vi _",
    "programmatically by sending these commands directly to the sm ( wide arrow ( 2 ) in fig .",
    "[ automation ] ) .",
    "all vis consist of a user interface ( ui ) and a block diagram ( bd ) .",
    "in contrast to all other vis the _",
    "torque.vis _ bd consists of the ui - handler part and the state machine ( sm ) itself , both running in parallel . in normal , interactive operation of the torque system ,",
    "user actions on the _ torque.vis _ ui are translated by the ui - handler into commands which are sent to the sm via a queue and then propagate on to the dataserver and handler vis ( wide arrow ( 1 ) ) .",
    "if an automated measurement is run , the _ sequencer.vis _",
    "sm retrieves commands from the text sequence on its ui , sends them via a queue to the _ torque.vis _",
    "sm from where they propagate on to the dataserver and handler vis ( wide arrow ( 2 ) ) .",
    "the _ torque.vis _",
    "sm sends confirmation messages back to the _",
    "sequencer.vi_. solid black arrows indicate direct access between the bd and the ui , whereas dotted arrows represent data transmission via _ queues _ and _ datasockets_. ]    when automatic measurements are required , a sequence text file is written containing the commands needed to accomplish these measurements which is then read by the _ sequencer.vi_. additionally to the commands of _",
    "torque.vis _ sm the _ sequencer.vi _ understands a set of flow control instructions such as `` if '' , `` while '' and `` for '' which are useful for creating short sequences for repetitive tasks , as well as the use of variables and their arithmetic manipulation and comparison .",
    "the _ sequencer.vi _",
    "parses through the sequence file by looking for known keywords  the commands .",
    "any strings which are not recognized as a keyword are treated as arguments to the preceding keyword .",
    "the string ` settemp 20 waittemp ` present in a sequence file would instruct the torque software to change the temperature to 20k and wait for the cryostat to stabilize at this temperature . in this example ` settemp ` and ` waittemp ` are keywords and ` 20 ` is the argument to the keyword ` settemp ` .",
    "such sequencing possibilities are already well known in control software of commercially available measurement equipment ( eg .",
    "squid magnetometers or the _ quantum design _ physical property measurement system@xcite ) .",
    "now such efficient and flexible data taking is also possible with our home made torque magnetometer .",
    "in order to demonstrate the possibilities of such an automatable measurement system we present some results of a systematic study@xcite of the so called lock - in transition in the high temperature superconductor la@xmath6sr@xmath7cuo@xmath8 .",
    "details about this effect can be obtained from various other sources and are not discussed here@xcite .",
    "most easily this effect is visible in angle dependent torque measurements and manifests itself as a deviation from an otherwise smooth behaviour .",
    "an example of such a measurement is shown in fig .",
    "[ torque1 ] , where the measured data points close to 90@xmath9 deviate from a theoretical curve@xcite which fits well to the remaining angle range .",
    "the same model can also be used to describe data taken as a function of magnetic field magnitude @xmath10 at a fixed angle .",
    "it is commonly accepted that in first approximation the magnetic moment @xmath11 of a superconductor is proportional to @xmath12 .",
    "angle dependent torque measurement ( circles ) of an underdoped crystal of la@xmath6sr@xmath7cuo@xmath8  with @xmath13 ( @xmath14 ) , performed at @xmath15 in a magnetic field @xmath16 .",
    "the solid line is a fit of a model derived by kogan@xcite .",
    "the deviation close to @xmath17 stems from the lock - in transition . ]    within our study we measured six la@xmath6sr@xmath7cuo@xmath8  single microcrystals with varying sr content @xmath18 and critical temperatures @xmath19varying from 17@xmath20 to 35@xmath20 .",
    "they were mounted on a highly sensitive torque sensor and cooled below @xmath19 .",
    "field dependent measurements ( @xmath21 at @xmath22 steps with increasing and decreasing field ) were taken at 60 field orientations ( @xmath23 with varying steps ) and at about ten temperatures below the critical temperature @xmath19 .",
    "we emphasize that such extensive measurements would hardly be possible without our software s automation possibilities .",
    "as each field scan takes about six minutes , without automation user interaction would be necessary at this interval during _ one week _ to collect all these data for one crystal .",
    "after writing the sequence and starting its execution , the measurement system , on the other hand , finishes such a measurement set within about _ three days _ with no need of intervention .",
    "the experiment is finished faster , because less time is lost between consecutive field scans and because the measurement is running day and night .    field dependent measurement @xmath24 of the same la@xmath6sr@xmath7cuo@xmath8  crystal as was used for the measurement in fig .",
    "[ torque1 ] .",
    "the angle of the magnetic field was fixed at @xmath25 and @xmath26 .",
    "the measurements are plotted as @xmath27 vs.  @xmath12 .",
    "the lines are guides to the eye to show the two linear regions i ( low field ) and ii ( high field ) . ]",
    "we present here only one dataset of a single crystal taken at one particular temperature .",
    "such a dataset consists of 60 field scans taken at various orientations .",
    "the two field scans shown in fig .  [ torque2 ] illustrate the deviations of field dependent data due to the lock - in transition .",
    "clearly visible are two regions ( i and ii ) where @xmath27 is proportional to @xmath12 .",
    "a comparison of these measurements to angle dependent measurements at similar conditions indicate that region i corresponds to the part where lock - in takes place , whereas data in region ii are well described by the theoretical curve in fig .",
    "[ torque1 ] . by analysing the whole data set it is now easy to investigate the evolution of these two regions as a function of angle @xmath28 .",
    "the result is shown in fig .",
    "[ torque3 ] , where the extents of the two regions , obtained from field dependent measurements , are plotted vs.  the angle @xmath28 .",
    "the horizontal line a indicates the cut of the measurement in fig .",
    "[ torque1 ] and the vertical lines b and c the measurements shown in fig .",
    "[ torque2 ] .",
    "the observed region , separating regions i and ii manifests the lock - in transition and can be understood in terms of a model proposed by feinberg and villard@xcite .",
    "summary of field dependent measurements performed on a la@xmath6sr@xmath7cuo@xmath8  single crystal at @xmath15 .",
    "only the extents of the linear regions such as shown in fig .",
    "[ torque2 ] as a function of field orientation @xmath28 are shown .",
    "the enhancement of the low - field region i close to the ab - plane ( @xmath17 ) is clearly visible .",
    "the horizontal line a indicates the position of the measurement shown in fig .",
    "[ torque1 ] . the vertical lines b and c indicate the position of the measurements shown in fig .  [ torque2 ] . ]",
    "this work was supported in part by the swiss national science foundation ."
  ],
  "abstract_text": [
    "<S> in order to simplify and optimize the operation of our home made torque magnetometer we created a new software system . the architecture is based on parallel , independently running instrument handlers communicating with a main control program . </S>",
    "<S> all programs are designed as command driven state machines which greatly simplifies their maintenance and expansion . moreover , as the main program may receive commands not only from the user interface , but also from other parallel running programs , an easy way of automation is achieved . a program working through a text file containing a sequence of commands and sending them to the main program suffices to automatically have the system conduct a complex set of measurements . in this paper </S>",
    "<S> we describe the system s architecture and its implementation in labview . </S>"
  ]
}