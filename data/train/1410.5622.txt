{
  "article_text": [
    "radiotherapy dose calculation , like many other simulations , relies on physical input data that comes from measurements or microscopic theories . in the case of dose calculations arising from electron beams , this input data includes the material properties  stopping powers , scattering cross sections , transport coefficients , etc.of different tissues which come from various databases and have various uncertainties .",
    "a natural question arises : what effect do these uncertainties have upon dose calculation ?",
    "to our knowledge , the influence of these uncertainties has never been studied in proper detail .",
    "sensitivities of dose calculation with respect to beam parameters ( such as shape and energy profile ) were considered in @xcite , however . we have reviewed some possible sources in a previous paper @xcite .",
    "as in that paper , the cross sections we use have been extracted from icru libraries @xcite .",
    "our purpose here is to make a first step toward a rigorous uncertainty quantification of dose computation results under uncertain input parameters .",
    "several methods of dose computation are available ; some are monte carlo - based codes , such as luka , mcnp , egsnrc , penelope , and geant , as well as their variants xvmc , vmc++ , and dpm ( cf .",
    "@xcite for a recent comparison ) .",
    "these have the advantage of outputting dose profiles which have close correspondence with experimental results .",
    "however , in order to use these models for determining uncertainties , statistical methods must be used ( due to the stochastic nature of the computation ) , potentially resulting in very large numbers of dose calculations .",
    "the computational effort required can therefore be quite large , and possibly impractical .",
    "alternative methods involve using deterministic methods involving partial differential equation models @xcite .",
    "these models have the advantage of being computationally efficient .",
    "we consider in this paper a somewhat simplified physical fokker - planck model , derived ( for instance ) in @xcite , describing electrons and involving only the stopping power and the first transport coefficient .",
    "we use this model to compute the sensitivities of the mean penetration depth ( more precisely the mean penetration depth with respect to the percentage depth dose ) with respect to the fully energy - dependent stopping power and transport coefficient .",
    "this is achieved via adjoint calculus , leveraging the deterministic nature of the partial differential model ; sensitivities are computed via only one additional solve of the boltzmann transport equation .",
    "thus , sensitivities can be obtained with significantly lower computational effort .",
    "the rest of this paper is organized as follows . in [ sec : fpeqn ] , the fokker - planck model we use for dose calculation is described , as well as the normalized average penetration depth . in [ sec : adjcalc ] , the main result is presented : namely , the development of the adjoint - based calculus needed for expressing the sensitivities .",
    "this results in analytic expressions for the sensitivities of the average penetration depth with respect to the stopping power and transport coefficient . equipped with this",
    ", we discuss the procedure for approximating the sensitivities via the method of moments in [ sec : pn ] .",
    "we then present computed sensitivities for incident beams of varying energy profiles in [ sec : results ] .",
    "finally , [ sec : discuss ] consists of concluding remarks and a discussion of future questions .",
    "the fokker - planck equation treated in this paper arises as an approximate model in the dose distribution calculation in radiotherapy @xcite . for a bounded domain @xmath1 , it is given by @xmath2 where @xmath3 is the number of electrons moving in time @xmath4 through the area @xmath5 in direction @xmath6 near @xmath7 with @xmath8 the angle between @xmath7 and the normal of @xmath9 @xmath10 is the stopping power ;",
    "@xmath11 is the transport coefficient , @xmath12 is the density of the medium , and @xmath13 is the laplace - beltrami operator .",
    "in addition to [ fweq ] , we impose the following conditions @xmath14 for an external source @xmath15 on the incoming boundary . for numerical implementations , the `` initial condition '' that there are no particles of infinite energy is replaced with a cutoff energy .",
    "we are now interested in certain properties of the dose @xmath16 in particular , we want to study the dependence of the normalized average penetration depth @xmath17 with respect to the stopping power and the transport coefficient . for notational simplicity , @xmath18 shall denote the total dose deposition throughout the remainder of this paper and @xmath19 the nonnormalized average penetration depth .",
    "the quantities @xmath20 , @xmath18 , and @xmath21 can be seen as functionals , mapping the energy dependent functions @xmath22 and @xmath23 to a scalar .",
    "the sensitivity of these quantities with respect to the data depends on the corresponding derivatives .",
    "we denote the frchet derivatives with respect to @xmath22 by @xmath24 , or @xmath25 , and use this notation for all functionals that appear in this paper . for every fixed @xmath22 , these objects are linear operators , acting on variations @xmath26 in the stopping power .",
    "we denote this by @xmath27,~~\\text{or } \\partial_s \\overline{x } \\big [ \\delta s \\big].\\end{aligned}\\ ] ] finally , the chain rule for frchet derivatives yields for the quantity that we are interested in : @xmath28_s = \\frac{\\overline{x}_s \\overline{d } - \\overline{x } \\overline{d}_s}{\\overline{d}^2}.\\end{aligned}\\ ] ] we use the same notation for the derivatives with respect to @xmath29 the same expressions then hold if @xmath22 is replaced by @xmath23 .    0.45     0.45",
    "in this section , we obtain analytic forms for @xmath30_t$ ] and @xmath30_s,$ ] which are , as previously mentioned , operators acting on variations in the material properties . as such , they have representations as functions in the energy variable .",
    "if we were instead to use a finite difference approximation , we would require @xmath31 dose calculations where @xmath32 is the number of discrete energies at which we have data for @xmath22 and @xmath29 additionally , inherent truncation errors in the finite difference approximation scheme tend to rise . as we shall see in this section ,",
    "adjoint methods give analytical expressions which require only a single additional solution of a fokker - planck equation for either the sensitivity with respect to @xmath22 or @xmath29    we first address the dependence of @xmath18 on @xmath22 and @xmath23 . operating on equation ( [ fweq ] ) in the homogeneous case with @xmath33 by @xmath34 , we obtain @xmath35 as the angular integral of the laplace - beltrami term over the sphere vanishes .",
    "if we assume that the incoming source is sufficiently forward peaked and the domain is large enough , we may assume that outgoing particles at the boundary are negligible .",
    "this means we then have that @xmath36 integrating with respect to @xmath37 we have @xmath38 for all @xmath39 . as the right hand side",
    "does not depend on @xmath22 or @xmath23 , we conclude that any dependence of the total dose on @xmath22 or @xmath23 would be negligible in the case of relatively focused incoming sources . hence ,",
    "@xmath28_s \\approx \\frac{\\overline{x}_s}{\\overline{d}},\\end{aligned}\\ ] ] and the main purpose of this paper is to calculate the derivatives of @xmath40    thus , we turn here to the first order sensitivities of the average penetration depth with respect to the parameters @xmath22 and @xmath23 , which are given by the derivatives of ( [ apd ] ) with respect to these quantities .",
    "we define the following lagrangian @xmath41 { { \\operatorname}{dx}}d{\\varepsilon}d\\omega\\\\      \\end{aligned}\\ ] ] where @xmath42 is the adjoint variable which solves @xmath43 then @xmath44.\\ ] ] now the sensitivities of @xmath45 with respect to @xmath22 and @xmath23 can be expressed via the partial derivative of the lagrangian with respect to these parameters . in both cases",
    ", @xmath42 will be the solution of [ eq : adjeqn ] with @xmath46 the gradient with respect to @xmath22 , evaluated in direction @xmath26 , then reads @xmath47 = \\iiint [ ( x\\psi -\\rho\\psi\\partial_{\\varepsilon}\\lambda){{\\operatorname}{dx}}d\\omega ] \\delta s d{\\varepsilon}.\\ ] ] the gradient with respect to @xmath23 , in direction @xmath48 is given by @xmath49 = \\iiint ( \\rho\\psi\\delta_\\omega\\lambda { { \\operatorname}{dx}}d\\omega)\\delta t d{\\varepsilon}.\\ ] ]",
    "as we are primarily concerned about the depth of dose penetration from incoming beams , we will consider [ fweq ] and [ eq : adjeqn ] for slab geometry . in this setting",
    ", the laplace - beltrami operator can be written as @xmath50 where @xmath51 $ ] is the cosine of the polar angle from the axis of the slab geometry , and equation ( [ fweq ] ) reads @xmath52 in order to reduce the dimension of the state space and develop efficient computational methods , it is common to use the method of moments in order to discretize the angular variable @xcite ; for this , we multiply [ eq : slabforw ] by the legendre polynomials in @xmath53 and integrate with respect to @xmath54 we define @xmath55 where @xmath56 is the @xmath57-th legendre polynomial . as the legendre polynomials are eigenfunctions of the one - dimensional laplace - beltrami operator , we have after integration by parts @xmath58 for @xmath59 .",
    "this process results , using the well - known recursion formula for the legendre polynomials , in a system of @xmath60 equations of the form @xmath61 where we set @xmath62 .",
    "the system is closed by the relation @xmath63 .",
    "this corresponds to a truncation of the expansion of the angular variable via a basis of legendre polynomials .",
    "the corresponding adjoint system is @xmath64 for @xmath65 , again with closure relation @xmath66 as noted in @xcite , an advantage of the @xmath0 approximation is that [ pnadj ] , with mark boundary conditions , is both the @xmath0 approximation of [ eq : adjeqn ] and the adjoint arising from differentiating the semi - discretization of the lagrangian , allowing for consistency in our discretization schemes for calculating @xmath67 and @xmath68      due to the non - linear nature of derivatives in ( [ senss ] ) and ( [ senst ] ) , we need to approximately reconstruct the state and adjoint variables @xmath69 and @xmath70 in order to properly evaluate the arising integrals .",
    "such a reconstruction can be obtained in a straightforward manner due to the linear structure of the @xmath0 expansion . as the expansion in the angular variable",
    "is assumed to be @xmath71 we multiply both sides by @xmath72 integrate , obtaining @xmath73 with @xmath74 the same reconstruction can be applied for the adjoint variable @xmath42 , too .",
    "equipped with the approximate reconstructed state and adjoints , we now turn to the approximation of [ senss ] and [ senst ] .",
    "we make use of the legendre polynomials being the eigenfunctions of the laplace - beltrami operator .",
    "the approximate sensitivity with respect to the transport coefficient , arising from the @xmath0 approximations , simplifies [ senst ] to @xmath75_{pn } & \\approx   \\iiint ( \\rho\\tilde\\psi_{pn}\\partial_\\mu ( 1-\\mu^2)\\partial_\\mu\\tilde\\lambda_{pn } { { \\operatorname}{dx}}d\\mu)[\\delta t ] d{\\varepsilon}\\\\      & = -\\iiint ( \\rho \\tilde\\psi_{pn}\\sum_{l=0}^n\\frac{2l+1}{2}l(l+1)p_l(\\mu)\\lambda^{(l)}d\\mu { { \\operatorname}{dx } } ) [ \\delta t ] d{\\varepsilon}\\\\      & = - \\iint ( \\rho \\sum_{l=0}^n\\frac{2l+1}{2}l(l+1)\\psi^{(l)}\\lambda^{(l ) } { { \\operatorname}{dx } } ) [ \\delta t ] d{\\varepsilon}.\\end{aligned}\\ ] ] we note that the integration with respect to @xmath53 was done analytically ; the remaining integrations can be carried out numerically .",
    "similarly , we approximate [ senss ] , using the reconstructions from the @xmath0 approximation , and simplify to obtain @xmath76_{pn } & \\approx \\iiint   ( x\\tilde\\psi_{pn } - \\rho\\tilde\\psi_{pn } \\tilde\\lambda_{pn } d\\mu { { \\operatorname}{dx } } ) [ \\delta s ] d{\\varepsilon}\\\\      & = \\iint   x\\psi^{(0 ) } - \\rho \\sum_{l=0}^n \\frac{2l+1}{2 } \\psi^{(l ) } \\partial_{\\varepsilon}\\lambda^{(l ) } { { \\operatorname}{dx}}[\\delta s ] d{\\varepsilon}.\\end{aligned}\\ ] ] evaluation of @xmath77 and the remaining integration is done numerically .",
    "in this section we present numerical results for our method . throughout",
    ", an explicit hll finite volume scheme @xcite was used in order to solve the @xmath78 systems for both @xmath42 and @xmath79 a maximum cutoff energy of 20.5 mev was used ",
    "it is assumed no particles are present with higher energy .",
    "a water phantom of length either 6 cm or 9 cm and density @xmath80 g/@xmath81 was used .",
    "dose calculations for beams of form @xmath82 for both @xmath83 and @xmath84 are shown , along with dose calculations using penelope @xcite , in [ fig : dosevalid ] .",
    "we see general agreement , with expected differences arising due to effects such as bremsstrahlung not being included in the fokker - planck model .",
    "0.45   approximation ( red ) and penelope ( blue ) along axis ( in cm ) , title=\"fig : \" ]    0.45   approximation ( red ) and penelope ( blue ) along axis ( in cm ) , title=\"fig : \" ]    the relative sensitivities for the normalized penetration depth , given by @xmath85_t\\bigg)_{rel}=\\frac{\\overline{{\\mathrm{x}}}_t}{\\overline{{\\mathrm{x}}}}t,\\qquad \\bigg(\\big[\\overline{{\\mathrm{x}}}_\\text{norm}\\big]_s\\bigg)_{rel}=\\frac{\\overline{{\\mathrm{x}}}_s}{\\overline{{\\mathrm{x}}}}s\\end{aligned}\\ ] ] for a 10 mev incoming beam are shown in [ fig:10mevsens ] . for verification , a finite differences approximation was generated .",
    "the resulting relative error in the @xmath22 sensitivity was @xmath86 and in the @xmath23 sensitivity was @xmath87 .",
    "0.45   with respect to @xmath22 and @xmath23 computed both via finite differences ( in red ) and via [ senss ] or [ senst ] ( in blue).,title=\"fig : \" ]    0.45   with respect to @xmath22 and @xmath23 computed both via finite differences ( in red ) and via [ senss ] or [ senst ] ( in blue).,title=\"fig : \" ]    we next compute sensitivities under more realistic conditions for the incoming beam .",
    "beams take the form @xmath88 where @xmath89 mev , @xmath90 and @xmath91 the length of the slab is 6 cm with the exception of the 16 mev beam , where 9 cm is used to account for a deeper beam penetration . in comparison to the sensitivities shown in [ fig:10mevsens ] , where there is a sharper cutoff , the effects of smearing in the energy profile of the beam are clear .",
    "we also see a clear increase in the relative sensitivity with respect to the transport coefficient as the beam energy decreases .",
    "the @xmath92 norm of the relative sensitivities for the various beams are shown in [ tab : varbeamdata ] .",
    "0.45   with respect to @xmath22 and @xmath23 for beams centered at 6 , 9 , 12 , and 16 mev.,title=\"fig : \" ]    0.45   with respect to @xmath22 and @xmath23 for beams centered at 6 , 9 , 12 , and 16 mev.,title=\"fig : \" ]    .",
    "summary of @xmath20 and @xmath21 and relative sensitivities for various beam energies . [ cols=\"^,^,^,^\",options=\"header \" , ]     ",
    "we see the sensitivity of the dose deposition can vary significantly in magnitude for beams of different energies .",
    "all sensitivities reach maximum magnitude in energies slightly below the centers of the beams energy profiles .",
    "however , the sensitivities are also significantly stretched for the higher energy beams .",
    "the sensitivities decrease relatively quickly once the maximum sensitivity has been reached , as fewer electrons at those energies are present in the system .",
    "thus , the influence of @xmath22 and @xmath23 are significantly lessened in those portions of the energy profile .",
    "this decrease at higher energies is more rapid for beams with particles of only one energy , as seen in [ fig:10mevsens ] , where only trace electrons are present above 10 mev . in all cases ,",
    "we see that the the dose penetration depth is significantly more sensitive to relative changes in the stopping power than relative changes in the transport coefficient .",
    "this sensitivity is often of an order of magnitude higher than @xmath93_s\\bigg)_{rel}$ ] at its maximum .",
    "the adjoint calculus associated with the fokker - planck model for dose calculation led to computationally efficient methods for computing sensitivities for the average dose penetration depth , a quantity of significant interest in radiotherapy .",
    "this involves only two solves of a fokker - planck equation , which can be done efficiently via the @xmath0 method .",
    "the sensitivities significantly vary according to both the energy profile of the incoming beam as well as its relative focus in angle . due to the efficiency of the computations , however , this does not pose a significant challenge , as sensitivities may be readily recomputed as new beams are investigated .",
    "however , in all cases , the stopping power was much greater significance in computing the penetration depth .",
    "we have so far only computed sensitivities for water phantoms in one dimension .",
    "it would be of interest to extend this method to both problems in higher dimensions and problems involving materials with higher / lower transport coefficients such as bone and air ( for computations of beams near the lung or throat ) .",
    "the adjoint calculus would be unchanged ; however moving to higher dimensions may require attention as the @xmath0 method may require higher numbers of moments for adequate dose computations .",
    "additionally , other quantities of interest ( such as practical range ) in the evaluation and planning of radiotherapy treatments may be studied .",
    "this would involve altering the adjoint system .",
    "finally , spatially inhomogeneous regions of the body would involve stopping powers and transport coefficients which are spatially dependent . considering this problem would lead to uncertainty quantification in the presence of uncertainties with respect to imaging and positioning of the source with respect to the patient .",
    "the work of barnard was supported in part by the austrian science fund ( fwf ) under grant sfb f32 ( sfb `` mathematical optimization and applications in biomedical sciences '' ) and in part by the german research foundation dfg under spp 1253 `` optimization with partial differential equations '' .      c.  berthon , m.  frank , c.  sarazin , r.  turpault , _ numerical methods for balance laws with space dependent flux : application to radiotherapy dose calculation _ , commun .",
    "1184 - 1210 ( 2011 ) .",
    "g.  c.  pomraning , _ the fokker - planck operator as an asymptotic limit _ , math .",
    "models methods appl .",
    ", 02 , 21 ( 1992 ) . , _",
    "penelope-2008 : a code system for monte carlo simulation of electron and photon transport _ ,",
    "oecd , 2009 .",
    "d.  sheikh - bagheri , and d.  rogers,_sensitivity of megavoltage photon beam monte carlo simulations to electron beam and other parameters _ , med .",
    "phys . , 29(3 ) , pp 379 - 390 ( 2002 ) ."
  ],
  "abstract_text": [
    "<S> in this paper we study the sensitivities of electron dose calculations with respect to the stopping power and the transport coefficients . </S>",
    "<S> we focus on the application to radiotherapy simulations . </S>",
    "<S> we use a fokker - planck approximation to the boltzmann transport equation . </S>",
    "<S> equations for the sensitivities are derived by the adjoint method . the fokker - planck equation and its adjoint </S>",
    "<S> are solved numerically in slab geometry using the spherical harmonics expansion ( @xmath0 ) and an hll finite volume method . </S>",
    "<S> our method is verified by comparison to finite difference approximations of the sensitivities . finally , we present numerical results of the sensitivities for the normalized average dose deposition depth with respect to the stopping power and transport coefficients , demonstrating the increasing relative sensitivities as beam energy decreases . </S>"
  ]
}