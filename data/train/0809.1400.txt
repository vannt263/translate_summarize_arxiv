{
  "article_text": [
    "data assimilation consists in estimating the state of a system combining two different sources of information via numerical methods : models , and observations .",
    "there is an increasing need for such methods in physical oceanography , as the monitoring of the ocean provides crucial information about climate changes @xcite , and the models , although very complex , need to be combined with the observations of ever increasing quality .",
    "notably , the amount of data available in oceanography has drastically increased in the last years with the use of satellites .",
    "this paper deals with data assimilation , focusing on a particular technique : nudging .",
    "the standard nudging algorithm consists in applying a newtonian recall of the state value towards its direct observation @xcite . from another point of view",
    ", the principle of nudging is to use observers of the luenberger , or extended kalman filter type for data assimilation @xcite .",
    "the model appears then as a weak constraint , and the nudging term forces the state variables to fit as well as possible the observations .",
    "this forcing term in the model dynamics has a tunable coefficient that represents the relaxation time scale .",
    "this coefficient is usually chosen by numerical experimentation so as to keep the nudging terms small in comparison with the state equations , and large enough to force the model to fit the observations .",
    "the nudging term can also be seen as a penalty term , which penalizes the system if the model is too far from the observations .",
    "the nudging method , or more generally observers , is a flexible assimilation technique , computationally much more economical than variational data assimilation methods @xcite .",
    "observers of the kalman filter type are designed to provide , for each time step , the optimal estimate ( i.e. of minimal error variance ) of the system state , by using only the previous estimates of the state and the last observations @xcite .",
    "these filters alternate propagation steps ( with the physical model ) and correction steps ( using the observations ) of the state and of its error statistics . in the case of a non - linear physical model",
    "the extended kalman filter only yields an approximation of the optimal estimate . as the oceanographic models have become very complex in the recent years",
    ", the high computing cost of the extended kalman filter can be prohibitive for data assimilation @xcite .",
    "the nudging techniques take advantage of the form of the kalman filter , alternating propagation and correction steps but the gain matrices ( or coefficients ) are often chosen to be constant , and their expression requires very few ( or no ) calculations @xcite .",
    "most kalman - type filters , or luenberger observers @xcite do not take into account the symmetries of the model .",
    "but the symmetries often contain useful geometrical information on the model that can help for the design and improve the performances .",
    "indeed , there has been recent work on observer design and symmetries for engineering problems when the model is of finite dimension and when there is a lie group acting on the state space @xcite .",
    "symmetries provide a helpful guide to design correction terms based on the very structure of the physical system . the only difference between the observer and model equations comes from the correction term .",
    "when this term is bound to preserve symmetries , the observer is called  invariant \" , or  symmetry - preserving \" .",
    "the result is that the estimations do not depend on arbitrary choices of units or coordinates , and the estimates share common physical properties with the system variables ( in the examples given in @xcite , estimated concentrations are automatically positive , estimated rotation matrices automatically belong to @xmath0 ) . in some cases",
    ", the error system even presents very nice properties ( autonomous error equation in @xcite ) .",
    "this paper is an extension to the infinite - dimensional case of the recent ideas on observer design and symmetries for systems described by ordinary differential equations ( ode ) @xcite , in the particular context of nudging for data assimilation in oceanography .",
    "the problem considered is the following : the ocean is described by a simplified shallow - water model .",
    "the sea surface height ( ssh ) is measured ( with noise ) everywhere by satellites .",
    "the goal is to estimate the height , and the ( not measured ) marine currents .",
    "the model considered is invariant by rotation and translation @xmath1-invariance ) . in the case of problems described by infinite dimensional partial differential equations ( pde ) , the design of observers based on the symmetries of the physical system is new to the authors knowledge .",
    "the main contribution of this paper is to derive a large class of observers based on the @xmath2-invariance for this estimation problem . at first",
    "we are only interested in the structure of the observers , and we do not check the validity of the estimation . then we pick a particular observer in this class .",
    "it has several remarkable properties as the design is based on physical considerations .",
    "the correction term does not depend on any non - trivial choice of coordinates .",
    "moreover , it is made of a smoothing term which ensures remarkable robustness to white noise .",
    "the correction term consists in fact in a convolution of the estimation error with a smooth isotropic kernel .",
    "the idea to derive systematical smoothing terms based on physical symmetries is standard in image processing , and was initiated by @xcite .",
    "one of the simplest method consists in a convolution with a smooth rotation - invariant kernel ( isotropic diffusion based on the heat equation ) .",
    "but in this paper we combine the smoothing term with a dynamical model to provide an estimation of physical quantities which are not directly measured , i.e. we build an observer .",
    "the second main contribution of the paper is to yield a proof of convergence of the estimation error to zero on a simplified shallow water model .",
    "the proof shows how to handle the convolution term via a fourier analysis .",
    "in fact we solve the following estimation problem : predicting the velocity in a water - tank using ( very ) noisy continuous measurements of the height everywhere at any time .",
    "thus this paper can be viewed as a counterpart in the observer field of the work on the controllability of a water tank , which was raised by @xcite .",
    "finally , a noticeable fact is that the observer depends on a small number of parameters , as the structure of the observer is imposed by the structure of the system .",
    "all these parameters admit a physical interpretation .",
    "so the observer gains are easy to tune , and the corresponding computing cost is quite low , contrarily to the extended kalman filter .",
    "this property is in fact characteristic of symmetry - preserving observers @xcite .",
    "the performances of the observer and the low computational cost have been numerically tested .",
    "the paper is organized as follows . in section 2",
    "we consider a bi - dimensional shallow water model , often used in geophysics for ocean or fluid flow modeling .",
    "we define a class of invariant observers in the case of ssh observations .",
    "then , we prove the convergence of the estimation error to zero on the first - order approximation of this system .",
    "indeed we assume that the fluid motion is described by linearized wave equations under shallow - water approximations . in section 3 ,",
    "we report the results of extensive numerical simulations on both the linearized ( and simplified ) and nonlinear shallow water models .",
    "we show the interest of invariant observers in these cases .",
    "these results are also compared with the standard nudging technique , which can be seen as a particular situation of our symmetry - preserving observers .",
    "we also show their remarkable robustness to gaussian white noise on the observations .",
    "finally , some conclusions and perspectives are given in section 4 .",
    "in this section we consider a simplified oceanic model .",
    "the state of the ocean is the ssh , and the horizontal speed of the marine currents .",
    "the choice of the orientation and the origin of the frame of @xmath3 used to express the horizontal coordinates @xmath4 is arbitrary : the physical problem is invariant by rotation and translation . indeed from a mathematical point of view the laplace operator",
    "@xmath5 is invariant by rotation and translation .",
    "the first term of any observer for this problem is automatically invariant by rotation and translation , as it is a copy of the equations of the physical system .",
    "there is no reason why the correction term should depend on any non - trivial choice of the orientation and origin of the frame .",
    "it would yield correction terms giving more importance to the values of the height measured in some arbitrary direction of @xmath3 . in the general case , without additional information on the model",
    ", it seems perfectly logical indeed to correct the observer isotropically .",
    "this constraint suggests interesting correction terms .",
    "the shallow water model ( or saint - venant s equations ) is a basic model , representing quite well the temporal evolution of geophysical flows .",
    "this model is usually considered for simple numerical experiments in oceanography , meteorology or hydrology @xcite .",
    "these equations are derived from a vertical integration of the three - dimensional fields , assuming the hydrostatic approximation , i.e. neglecting the vertical acceleration .",
    "we consider here the shallow water model of jiang et al @xcite . for deeper water ,",
    "this model can be adapted into a multi - layer model , each layer being described by a shallow water model , with some additional terms modeling stress and friction due to the other layers .",
    "the fluid is made of one layer of constant density @xmath6 and with varying thickness ( or height ) @xmath7 , covering a deeper layer of density @xmath8 .",
    "the domain is rectangular : @xmath9 and @xmath10 , where @xmath11 and @xmath12 are the cartesian coordinates corresponding to east and north respectively .",
    "let @xmath13 be the corresponding gradient operator : @xmath14 the equations write : @xmath15 where @xmath16 is the horizontal transport , with @xmath17 and @xmath18 pointing towards east and north respectively , @xmath19 is the coriolis parameter ( in the @xmath20-plane approximation ) , @xmath21 is the upward unit vector , and @xmath22 is the reduced gravity .",
    "the ocean is driven by a zonal wind stress @xmath23 modeled as a body force , and @xmath24 is known .",
    "finally , @xmath25 and @xmath26 represent friction and lateral viscosity .",
    "we assume that the physical system is observed by several satellites that provide measurements of the ssh @xmath7 for all @xmath27 . within the framework of data assimilation for geophysical fluids ,",
    "the goal is to estimate all the state variables @xmath28 and @xmath29 ( velocity of the marine streams , and ssh respectively ) at any point @xmath30 ^ 2 $ ] of the domain .",
    "we finally consider that all the other parameters are known .",
    "note that the state space is of infinite dimension .",
    "the unit vectors @xmath17 and @xmath18 are pointing east and north respectively .",
    "this choice is arbitrary , and the equations of fluid mechanics do not depend neither on the orientation nor on the origin of the frame in which the coordinates are expressed : they are invariant under the action of @xmath2 , the _ special euclidean _ group of isometries of the plane @xmath31 .",
    "let us prove this invariance .",
    "let @xmath32 be a horizontal rotation of angle @xmath33 .",
    "let @xmath34 be the origin of the new frame .",
    "let @xmath35 be the coordinates associated to the new frame @xmath36 . in this new frame ,",
    "the variables read @xmath37 and @xmath38 which implies @xmath39 .",
    "the equations in the new coordinates read the same with the notations @xmath40 and @xmath41 : @xmath42 the laplace and divergence operators are unchanged by the transformation as they are invariant by rotation ( although they are usually written in fixed coordinates , their value do not depend on the orientation of the chosen frame ) . note that the square domain @xmath43 ^ 2\\subset{{\\mathbb r}}^2 $ ] has to be replaced by the square @xmath44 .",
    "an observer for the system - ( nudging estimator ) systematically writes : @xmath45 with @xmath46 on the boudary of the domain , and where the correction terms vanish when the estimated height @xmath47 is equal to the observed height @xmath48 : @xmath49 no additionnal condition is required on @xmath50 and @xmath51 at this stage . they are functionals , and they can be for instance differential or integral operators of the space variables .",
    "the next step is to consider correction terms that respect the underlying physics of the system in the sense that they are invariant under the action of @xmath2 . indeed",
    "why the quality of the estimation should depend upon the choice of orientation and origin of the frame when the physical system under consideration does not at all ?",
    "let us search the correction terms in the large class of @xmath2-invariant differential and integral terms .",
    "we look for three types of invariant correction terms : scalar , differential , and integral .",
    "let us first focus on the former two .",
    "note that @xmath52 is a vector and @xmath51 a scalar .",
    "to find @xmath51 , we use the standard result ( see e.g. @xcite ) , which states that any @xmath2-invariant scalar differential operator writes @xmath53 , where @xmath54 is a polynomial and @xmath5 is the laplacian .    in our case",
    ", the coefficients of this polynomial can be invariant functions of the estimated state @xmath55 and measurement @xmath48 .",
    "note that @xmath56 is the unique vectorial function amongst these variables .",
    "the scalar variables @xmath48 and @xmath47 are @xmath2-invariant when transformed accordingly to .",
    "thus any scalar invariant function of @xmath57 must depend on @xmath56 only via an invariant function of @xmath56 , typically @xmath58 .",
    "indeed , using polar coordinates it is clear that it is the unique quantity that does not depend on the angle between @xmath56 and the ( arbitrary ) axis of the frame ( see e.g. @xcite for the construction of a complete set of scalar invariants ) .",
    "but since differential terms are allowed , and the gradient @xmath13 is a vectorial differential operator which rotates under the action of @xmath2 , one can get some rotation - invariant scalar terms from the scalar product between the gradient of invariant quantities , and the only vectorial function at our disposal @xmath56 . eventually , we get a complete family of scalar terms @xmath51 : @xmath59 where @xmath60 and @xmath61 are scalar polynomials in @xmath5 , and @xmath62 is an integral term defined below .",
    "more precisely , for @xmath63 , we have @xmath64 where @xmath65 and @xmath66 are smooth scalar functions such that @xmath67 for the vectorial correction term @xmath50 , we use the vectorial counterpart : @xmath68 where @xmath69 and @xmath70 are polynomials in @xmath5 , like @xmath60 and @xmath61 .",
    "let us now find the integral terms @xmath62 and @xmath71 that are invariant by rotation and translation .",
    "they can be expressed as a convolution between the previous invariant differential terms and a two - dimensional kernel @xmath72 .",
    "the previous terms being invariant by rotation , the value of the kernel should not depend on any particular direction , and so @xmath73 must be a function of the invariant @xmath74 ( isotropic gain ) .",
    "so if we let @xmath75 and @xmath76 be two real - valued kernels , the integral correction terms write : @xmath77_{(x-\\xi , y-\\zeta , t ) } ~   d\\xi d\\zeta , \\\\",
    "f_{h}(x , y , t ) & = & \\iint \\phi_{h}(\\xi^2+\\zeta^2 ) \\left[s_1(\\delta , h,|\\hat v|^2,\\hat h - h ) \\right .",
    "\\nonumber \\\\ & & \\quad + \\left .",
    "\\left(s_2(\\delta , h,|\\hat v|^2,\\hat h - h)\\right)\\cdot\\hat v\\right]_{(x-\\xi , y-\\zeta , t ) } ~   d\\xi d\\zeta,\\end{aligned}\\ ] ] where the polynomials @xmath78 and @xmath79 are defined like the @xmath80 s .",
    "the support of @xmath81 ( resp .",
    "@xmath82 ) is a subset of @xmath83 .",
    "its characteristic size defines a zone in which it is significant to correct the estimation with the measurements .",
    "the radial term @xmath74 makes the observer independent of any arbitrary choice of orientation ( invariance by rotation ) , and the use of a convolution makes the observer independent of the origin of the frame ( invariance by translation ) .",
    "the integral formulation is actually quite general : if @xmath75 and @xmath76 are set equal to dirac functions , one obtains the differential terms .",
    "such integral correction terms make the observer robust to noise .",
    "indeed if the kernels are smooth , the correction terms take into account the measurements , but are automatically smooth even if the measurements are not . the high frequencies in the signal",
    "are thus efficiently filtered .",
    "as it seems very difficult to study the convergence on the full non - linear system , we are going to simplify the system - in this section , and then linearize it around the equilibrium position @xmath84 and @xmath85 .",
    "in our experiments , the equilibrium is characterized by @xmath86 equal to a constant height , and @xmath87 .",
    "the observer gains are designed on this latter system , and then we prove at the end of this section that they ensure the strong asymptotic convergence of the error .    for reasons of clarity ,",
    "we first consider a simplified shallow water model ( saint - venant equations ) : @xmath88 in order to avoid the amplification of the measurement noise by a differentiation process , only the integral correction terms are kept : one sets @xmath89 , @xmath90 , and @xmath91 , and the kernels @xmath76 and @xmath75 are supposed to be smooth functions .",
    "thus the correction terms are smooth , and one can use the gradient of the output , as it is filtered .",
    "the symmetry - preserving observer - for the simplified system - writes : @xmath92 where @xmath93 and @xmath94 .",
    "[ [ remark ] ] remark : + + + + + + +    note that in the degenerate case where @xmath95 and @xmath96 ( @xmath97 and @xmath98 are positive scalars ) , we find the standard nudging terms : @xmath99 using exactly the same simplifications as @xcite which considers the control problem and motion planning of system - with boundary control , we study the first order approximation ( or linearized approximation ) of this system around the steady - state @xmath100 , where the equilibrium height @xmath86 is constant .",
    "we only consider small velocities @xmath101 and heights @xmath102 . note that these approximations are consistent with the numerical experiments of section [ num : sec ] , in which the ratio @xmath103 ( resp .",
    "@xmath104 ) to @xmath105 ( resp .",
    "@xmath86 ) is of the order of @xmath106 to @xmath107 .",
    "the linearized system is @xmath108 and the estimation errors , @xmath109 and @xmath110 , are solution of the following linear equations : @xmath111 eliminating @xmath112 and using @xmath113 yields a modified damped wave equation with external viscous damping : @xmath114 we now define the kernels @xmath115 and @xmath116 .",
    "we choose @xmath117 where @xmath118 and @xmath119 are smooth even functions . in order to respect the symmetries , both @xmath120 and @xmath121 must also be functions of @xmath122 .",
    "the following gaussians respect both conditions : @xmath123    [ thm1 ] if @xmath115 and @xmath116 are defined by ( [ gains : eq1 ] ) and ( [ gains : eq2 ] ) respectively with @xmath124 , then the first order approximation of the error system around the equilibrium @xmath125 given by is strongly asymptotically convergent . indeed if we consider the following hilbert space and norm : @xmath126 then , for every @xmath127 solution of , @xmath128    this result proves the strong and asymptotic convergence of the error @xmath127 towards @xmath129 , and then it also gives the same convergence for @xmath130 .",
    "we deduce that the observer - tends to the true state when time goes to infinity .",
    "note that although only the height is observed , all variables are corrected , and estimated .",
    "a dimensional analysis can yield a meaningful choice of the gains .",
    "the parameters @xmath131 , @xmath132 are expressed in @xmath133 .",
    "they define the size of the regions of influence of the kernels , i.e. the region around any point in which the measured values of @xmath48 are used to correct the estimation at the point . these value can be set experimentally using the data from the physical system . moreover ,",
    "concerning the tuning of @xmath134 and @xmath135 , one can use the following heuristics .",
    "the error system can be approximated by the following system , which corresponds to the case @xmath136 : @xmath137where @xmath138 , @xmath139 , as long as we impose @xmath140 .",
    "@xmath134 and @xmath135 can be chosen in order to control the characteristic pulsation @xmath141 , length @xmath142 , and damping coefficient @xmath143 of the approximated error equation .",
    "these quantities have an obvious physical meaning and can be set accordingly to the characteristics of the physical system under consideration .",
    "such heuristics provide a first reasonable tuning of the gains .",
    "[ [ remark-1 ] ] remark + + + + + +    in the following proof , we only use the decomposition of the gain functions given by the general formulation and , with some additional assumptions on @xmath118 and @xmath119 ( see end of section [ sec : proof ] ) . thus , many other kernel functions than those given in - lead to the same convergence result .      in this section , inspired by @xcite , we prove the strong convergence of the error system in the hilbert space @xmath144 .",
    "let @xmath145 . for simplicity reasons , we assume that @xmath146 .",
    "the error equation can be rewritten as a modified wave equation on a square domain with dirichlet boundary condition : @xmath147 ^ 2,\\\\ u & \\!\\!\\!=\\!\\!\\ ! & 0 & & \\text{on}\\ \\ { { \\mathbb r}}^+\\times\\partial\\omega,\\\\ u(0 ) & \\!\\!\\!=\\!\\!\\ ! & u_0 , \\ \\",
    "u_t(0)=u_1 & & \\text{in}\\ \\",
    "\\omega , \\end{array}\\ ] ] where @xmath148 represents the estimation error @xmath149 .",
    "the dirichlet boundary condition comes from the fact that we set @xmath150 on the boundary .",
    "we denote by @xmath151 the following orthonormal basis of @xmath152 , composed of eigenfunctions of the unbounded operator @xmath5 : @xmath153 as @xmath118 and @xmath119 are smooth functions ( @xmath154 for instance ) , we can consider their fourier series expansion .",
    "moreover , as @xmath118 and @xmath119 are even functions , their fourier coefficients are real .",
    "if we denote by @xmath155 and @xmath156 the fourier coefficients of @xmath118 and @xmath119 respectively , then the fourier coefficients of @xmath157 are @xmath158 .",
    "similarly , the fourier coefficients of @xmath116 are @xmath159 .",
    "as all these coefficients are real and positive , we denote them by @xmath160 for @xmath157 , and @xmath161 for @xmath116 . the only assumption that we need on @xmath118 and @xmath119 in the following proof is that @xmath162 and @xmath163 , @xmath164 .",
    "note that this condition is satisfied if @xmath118 and @xmath119 are defined in a such way that @xmath115 and @xmath116 are given by - .",
    "we now need the following intermediate result :    [ lem1 ] if @xmath165 and @xmath166 , then equation has a unique solution satisfying @xmath167 it is given by the series @xmath168 with either @xmath169 or @xmath170 moreover , the latter case appears at most for a finite number of indices , and @xmath171 .",
    "we rewrite equation as @xmath172 where @xmath173 and @xmath174 is the following unbounded linear operator on @xmath144 : @xmath175 from and , we deduce that @xmath176 are eigenvectors of @xmath177 associated to the eigenvalues @xmath178 , solutions of @xmath179 moreover , the family of eigenvectors @xmath180 forms a riesz basis of the hilbert space @xmath144 .",
    "the discriminant of is @xmath181",
    ". it can be positive for a finite number of indices only , since @xmath182 and @xmath183 when @xmath184 and @xmath185 go to infinity .",
    "we found a riesz basis of @xmath186 formed by eigenvectors of @xmath174 , the eigenvalues have no finite accumulation point and their real part are bounded .",
    "thus all assumptions of theorem 3.1 of @xcite are satisfied : the solution @xmath187 of is given by the series @xmath188 finally , the coefficients can be found using the fourier series of the initial condition .",
    "we have @xmath189 ^ 2 } u(0,x , y ) \\sin(px ) \\sin(qy)\\,dxdy,\\\\ b_{pq}&=&\\frac{4}{\\omega_{pq}\\pi^2}\\int_{[0,\\pi]^2 } \\left(u_t(0,x , y)+\\frac{g_{pq}^2}{2}u(0,x , y)\\right)\\sin(px)\\sin(qy)\\,dxdy.\\end{aligned}\\ ] ]    all we have to prove now is that the solution , which represents the estimation error , converges to 0 when time goes to infinity .",
    "recall that the coefficients @xmath190 are given by equation , except for a finite number of indices .",
    "define @xmath191 since @xmath165 and @xmath166 , parseval s theorem tells us that for any @xmath192 , there exists @xmath193 such that @xmath194 from and , there exists @xmath195 such that for any @xmath196 , @xmath197 finally , @xmath198 for any @xmath196 .",
    "we proved equation ( [ eq : thm ] ) , i.e. the strong convergence of the linearized error system .",
    "note that this proves the result for any kernel functions defined by and , provided all fourier coefficients @xmath199 are strictly positive .",
    "note also that for @xmath200 arbitrary large , from lemma [ lem1 ] , the truncated solution @xmath201 tends to @xmath129 exponentially in time .",
    "thus exponential convergence is expected in numerical experiments .",
    "in this section , we report the results of many numerical simulations on both the linearized and non - linear shallow water models , in order to illustrate the interest of such symmetry - preserving observers .",
    "the nonlinear observer is given by equations - , with gain functions @xmath116 and @xmath115 given by equations - .",
    "although the gain design has been done on the simplified linearized system , the gains are also implemented on the non - linear observer ( on the full non - linear shallow water model ) .",
    "we first consider a shallow water model , in a quasi - linear situation ( small velocities , and height close to the equilibrium height ) given by equations - .",
    "the corresponding observer is solution of equations - .",
    "the numerical experiments are performed on a square box , of dimension @xmath202 km@xmath203 km .",
    "the equilibrium height is @xmath204 m , and the equilibrium longitudinal and transversal velocities are @xmath205 .",
    "we consider a regular spatial discretization with @xmath206 gridpoints .",
    "the corresponding space step is @xmath207 km .",
    "the time step is half an hour ( 1800 seconds ) , and we have considered time periods of @xmath208 to @xmath209 months ( @xmath210 to @xmath211 time steps ) .    the reduced gravity is @xmath212 .",
    "the height varies between 497.7 and 501.9 m and the norm of the transversal velocity is within the interval @xmath213 .",
    "the approximations of the preceding section are valid since @xmath214 and @xmath215 .",
    "the variations of the height and velocities are indeed of the order of @xmath216 meters and @xmath217 respectively .",
    "this kind of linearized system with the typical values above is often considered in geophysical applications , under the tangent linear approximation , for the estimation of an increment ( instead of the solution itself ) @xcite .    concerning the tuning of the gains , we have considered the convolution kernels defined by equations - . recall that @xmath132 and @xmath131 represent the characteristic size of the gaussian kernel .",
    "we will always take @xmath218 .",
    "in most of the experiments below we have @xmath219 .",
    "unfortunately the weights @xmath135 and @xmath134 can not be chosen too large for numerical reasons , in order to avoid stability issues .",
    "so we always take @xmath220 .",
    "recall that heuristically the error equation can be approximated by the damped wave equation with @xmath221 and @xmath222 .",
    "the weights @xmath135 and @xmath134 have two different units , and physical meaning , and ( a priori ) there is no physical reason why they should have approximately the same magnitude . nevertheless , for the numerical values of @xmath135 considered in this paper , one can check that any value @xmath223 yields a fundamental frequency for the error system @xmath224 which is close to the natural frequency @xmath225 of the physical system - . from now on we will systematically set @xmath226 , which is acceptable from a physical point of view , also ensures the convergence of the observer , and is the largest value of @xmath134 which yields numerical stability .",
    "finally , a truncated convolution integral is used as an approximation of the complete convolution over the whole domain .",
    "the truncation radius is set equal to @xmath227 pixels in our experiments ( further than @xmath227 pixels away from its center the gaussian can be viewed as numerical noise ) .",
    "we consider two criteria for quantifying the quality of the estimation process : the convergence rate of the estimation error , and the estimation error when convergence is reached .",
    "the initialization of the observer is always @xmath228 in all the following results , the estimation error is the relative difference between the true solution ( @xmath48 and @xmath229 ) and the observer solution ( @xmath230 and @xmath231 ) : @xmath232 where @xmath233 is the standard @xmath234 norm on the considered domain . with the previously defined initialization of the observer ,",
    "the estimation error at initial time is @xmath235 , corresponding to a 100% error on the initial conditions .",
    "if we assume that the decrease rate is nearly constant in time , then the time evolution of the estimation error is given by : @xmath236 where @xmath237 and @xmath238 are the corresponding convergence rates .",
    "in all the numerical experiments that we have considered , the choice of the weighting coefficients @xmath135 and @xmath134 does not modify the residual estimation errors at convergence .",
    "one observes that the convergence rates are linearly proportional to @xmath135 ( and to @xmath239 ) , provided it is not too large .",
    "this is explained by formula as the fourier coefficients @xmath199 depend linearly on @xmath135 .",
    "we first assume that the observations are perfect , i.e. without any noise .",
    "figure [ fig : sv1 ] shows the estimation error ( in relative norm ) versus time ( number of time steps ) , for the three variables : height @xmath48 , longitudinal velocity @xmath240 and transversal velocity @xmath241 .",
    "the kernel coefficients are the following : @xmath242     and @xmath243 , and with a 100% error on the initial conditions , for the three variables : height @xmath48 , longitudinal velocity @xmath240 and transversal velocity @xmath241.,width=264 ]    this figure shows that the convergence speed is nearly constant in time , and equation @xmath244 is then valid . we can also deduce the corresponding convergence rates : @xmath245 another interesting point is that , although only the variable @xmath48 is observed , the velocity @xmath229 is also corrected , with a comparable convergence rate .",
    "this is predicted by the theory above , but it is nevertheless extremely noticeable , as in most data assimilation processes , only a few variables of the system are observed @xcite .",
    "this result shows ( at least in the linear case ) that all the variables are observable indeed .     and",
    "@xmath246 , for the three variables : height @xmath48 , longitudinal velocity @xmath240 and transversal velocity @xmath241.,width=264 ]    figure [ fig : sv2 ] shows the results of a similar experiment using different kernel coefficients ( @xmath246 , and still @xmath247 ) .",
    "the decrease rate is constant : @xmath248 , @xmath249 and @xmath250 .",
    "the ratio between the decrease rate and @xmath135 is almost preserved ( the decrease rate has been multiplied by @xmath251 to @xmath252 , and @xmath135 by @xmath209 ) , as explained by formula . from now on , we will only give the decrease rate corresponding to the following weight values : @xmath253    in both experiments , the estimation error at convergence has comparable ( small ) values : @xmath254 from a theoretical point of view , it should converge to @xmath129 .",
    "several reasons explain this difference with the theory .",
    "the numerical non - linear system considered is not exactly described by its first - order approximation .",
    "moreover the numerical schemes and numerical noise do not allow the observer solution to reach exactly the observed trajectory .",
    "note that the small oscillations in the decrease of the estimation error can be explained by the oscillatory behavior described by . numerically speaking",
    ", the fact that the model has nearly no diffusion ( no theoretical diffusion , and almost no numerical diffusion ) can also contribute to this oscillatory phenomena .",
    "finally , we compare our observer to the standard nudging algorithm , by choosing a large value for @xmath255 and @xmath256 .",
    "numerically we have set @xmath257 the decrease rate and estimation error at convergence are summarized in table [ tab : sv ] along with the previous results .",
    "the decrease rate of our observer is @xmath258 to @xmath259 times bigger . but",
    "assuming the solution @xmath260 is constant ( which is nearly true ) , the convolution with a gaussian kernel of size @xmath208 or with a dirac produces the same effect , with a @xmath261 factor ( as @xmath262 ) .",
    "numerically , the factor is a little bit smaller , as the solution is not constant .",
    "we also see that the estimation error at convergence is a little bit larger for @xmath263 large .",
    "numerically , the small difference can probably be explained by some numerical noise , which is smoothed by the convolution",
    ".    .decrease rate and value at convergence of the estimation error , for the three variables @xmath48 , @xmath240 and @xmath241 , for two different sizes of the gaussian kernel . [ cols=\"<,^,^ \" , ]     the estimation error in the case of noisy observations is nearly @xmath264 times larger than for perfect observations , both for @xmath219 and @xmath265 .",
    "this confirms the relative insensitivity of the observer with respect to the presence of observation noise , as the level of noise is @xmath266 , and the estimation errors are nearly @xmath267 for @xmath48 and @xmath268 to @xmath269 for the velocity . in this case ,",
    "the best results have been obtained for @xmath219 , improving the results of the nudging algorithm ( @xmath265 ) of @xmath270 to @xmath271 .",
    "these results clearly show the interest of a gaussian kernel applied to the correction term , in order to smooth the noisy observations ( or the numerical noise ) .    ) ; noisy observation at final time ( @xmath272 , with @xmath273 time steps ) ; identified height at final time ( @xmath274 ) ; true height at final time ( @xmath275).,width=491 ]    : identified longitudinal ( resp .",
    "transversal ) velocity at final time ( @xmath276 ) ; true longitudinal ( resp .",
    "transversal ) velocity at final time ( @xmath277).,width=491 ]    finally , figures [ fig : sw3 ] and [ fig : sw4 ] illustrate the identification process for both the height and velocity in the case of noisy observations , for @xmath278 ( second case of table [ tab : sw_bruit ] ) .",
    "we do not use any a priori information , as the initial guess is @xmath279 meters ( top left image of figure [ fig : sw3 ] ) , and @xmath280 .",
    "figure [ fig : sw3 ] shows on the top right the noisy observation @xmath281 of the height at the final time @xmath282 time steps .",
    "it should be compared to the bottom right image , showing the true height @xmath48 at the same time .",
    "the difference between these two images corresponds to the white gaussian noise @xmath283 .",
    "finally , the identified height ( i.e. the observer @xmath47 at final time @xmath284 ) is shown on the bottom left image of figure [ fig : sw3 ] .",
    "these images confirm both the very good identification of the height ( as previously seen in table [ tab : sw_bruit ] ) and the noise removal .",
    "figure [ fig : sw4 ] shows the identified and real components of the velocity .",
    "note that even if there are no observations of the velocity , the observer @xmath56 is very close to the real velocity @xmath229 at time @xmath284 .",
    "this is usually not the case in standard nudging techniques , where only observed variables are corrected @xcite .",
    "the main current ( correponding to the gulf stream , in the case of the north atlantic ocean ) is very well identified .",
    "this is extremely interesting , as in real geophysical applications , there are also almost no observations of the fluid velocity , although it has to be identified precisely @xcite . from table [",
    "tab : sw_bruit ] , we have previously seen that the error on the velocity is nearly @xmath285 in this case , which is quite high .",
    "but the main currents are very well identified , and this is a key - point for improving the quality of the forecasts . in most geophysical data assimilation problems ,",
    "the non - observed variables are only corrected thanks to model coupling , and it does not lead to such a nice identification @xcite .",
    "in this paper , we have defined a class of symmetry - preserving observers for a simplified and linearized shallow water model .",
    "we proved the convergence to zero of the error ( i.e. difference between the observer and real trajectories ) when time goes to infinity .",
    "many numerical simulations show the interest of such a choice of invariant gains .",
    "this paper gives insight in the field of non - linear observers for infinite dimensional systems , where very few methods are available .",
    "the observer provides better results than the standard nudging , even on the nonlinear system , as the error converges faster , the residual error is smaller , and the observer is much more robust to noise .",
    "the correction terms used in this paper are different from those of the usual extended kalman filter - type estimators ( no integral over space is performed ) .",
    "our observer has several advantages upon the extended kalman filter .",
    "first the computation cost is much smaller ( as long as the gaussian kernel is set equal to zero wherever its value is negligible , see section [ num : sec ] ) .",
    "this is important as in oceanographic data assimilation , the computation cost of the kalman filter can be prohibitive , as well as the cost of optimal nudging techniques @xcite .",
    "moreover the tuning of the gains of our observer is very easy as they depend on a very reduced number of parameters which have a physical meaning .",
    "it is precisely the use of the physical structure of the system which allows us to reduce the degrees of freedom in the gain design . finally , to the author",
    "s knowledge , there is no proof of convergence of the kalman filter for infinite dimensional non - linear systems .",
    "note that we also showed , both on theoretical and numerical points of view , that thanks to an appropriate choice of observer , it is possible to correct very well the non - observed variables with the observed ones , which is still a challenge in oceanography ( and more generally in geophysics ) @xcite .",
    "other types of correction terms could be used . in particular",
    "one could define the correction term in order to get the following linearized error equation instead of : @xmath286 indeed an additional structural damping would drastically change the spectrum .",
    "the use of such terms is generally prohibited by the presence of measurement noise , but the convolution product with a smooth kernel would allow us to use them .",
    "another direction for future work would be to make numerical experiments on back and forth nudging based on our observer . the observer can easily be adapted in reverse time indeed , with @xmath287 and @xmath115 unchanged ( see e.g. @xcite for details about this data assimilation method ) . finally , in this paper we only considered time and space continuous measurements .",
    "some experiments will also be carried out in the case of sparse observations , both in time and space . as",
    "a more general concluding remark , although this paper is only concerned with examples , it shows a systematical way to take advantage of the rotational invariance of the laplacian , and yields a method for the convergence analysis .",
    "this technique could be adapted to other estimation problems from physics and engineering , where the models are based on the wave equation or on the heat equation .",
    "this paper is supported by the cnrs .",
    "the authors would like to warmly thank all members of the lefe bfn project for useful discussions ."
  ],
  "abstract_text": [
    "<S> one of the important topics in oceanography is the prediction of ocean circulation . the goal of data assimilation is to combine the mathematical information provided by the modeling of ocean dynamics with observations of the ocean circulation , e.g. measurements of the sea surface height ( ssh ) . in this paper , we focus on a particular class of extended kalman filters as a data assimilation method : nudging techniques , in which a corrective feedback term is added to the model equations . </S>",
    "<S> we consider here a standard shallow water model , and we define an innovation term that takes into account the measurements and respects the symmetries of the physical model . </S>",
    "<S> we prove the convergence of the estimation error to zero on a linear approximation of the system . </S>",
    "<S> it boils down to estimating the fluid velocity in a water - tank system using only ssh measurements . </S>",
    "<S> the observer is very robust to noise and easy to tune . </S>",
    "<S> the general nonlinear case is illustrated by numerical experiments , and the results are compared with the standard nudging techniques .    </S>",
    "<S> [ [ keywords ] ] keywords : + + + + + + + + +    nudging , observer , symmetries , shallow water model , partial differential equation , estimation , data assimilation . </S>"
  ]
}