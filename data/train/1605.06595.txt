{
  "article_text": [
    "whole sky imagers are becoming popular amongst the research community for a variety of applications and domains , such as aviation , weather prediction , and solar energy .",
    "the resulting images are of higher resolution than what can be obtained from satellites , and the upwards pointing nature of the camera makes it easy to capture low - altitude clouds .",
    "they thus provide a useful complement to satellite images .",
    "our specific objective is to use such imagers in the analysis and prediction of signal attenuation due to clouds .",
    "ground - to - satellite or ground - to - air communication signals suffer from substantial attenuation in the atmosphere .",
    "rain , clouds , atmospheric particles , and water vapor along the signal path affect the quality in various ways@xcite .",
    "analysis and prediction of those effects thus require accurate information about cloud formations along the communication path . an efficient data acquisition technique is required to detect and track the various types of clouds .",
    "images captured with geo - stationary satellites are commonly used for this task .",
    "however those devices can only provide a limited spatial resolution .",
    "such an approach generally fails in countries like singapore , which has a small land mass , and where weather phenomenons are often very localized .",
    "furthermore the downwards pointing nature of satellite images is a significant disadvantage for the capture of lower cloud layers@xcite .",
    "several models of automatic whole sky imagers have been developed at the scripps institute of oceanography , university of california , san diego , with cloud detection in mind  @xcite .",
    "yankee environmental systems commercialize the _ tsi-880 _",
    ", which is used by many institutions @xcite .",
    "those imagers provide a good starting point for cloud analysis , but their design and fabrication is controlled by a company , making specialized adaptations hard or impossible . besides , those devices are expensive ( around 30,000 - 35,000  us$ for the _ tsi-880 _ ) and use very low resolution capturing devices",
    ". those limitations encouraged us to build our own .    in this paper , we propose a novel design of a whole sky imager called _ wahrsis _ ( wide angle high - resolution sky imaging system ) .",
    "it uses mostly off - the - shelf components which are available on the market for an overall price of around 2,500  us$. a simple overall design allows a home - made mounting of the various parts .",
    "the resulting images are of high resolution and can be used for various applications .",
    "the paper is organized as follows : section [ sec : design ] presents the overall design of the device , including the various components and imaging system .",
    "section [ sec : calibration ] describes the geometric and radiometric calibration of the camera .",
    "conclusions and future work are summarized in section [ sec : conclusions ] .",
    "figure [ fig : mechdesgn ] shows a drawing of _ wahrsis_. its main components are the following :    * the _ sun - blocker _ occludes the light coming directly from the sun and thus reduces the glare in the circumsolar region of the captured image .",
    "it is composed of a main arm , which is rotated around the outside of the box by a motor .",
    "a polystyrene ball is fixed on top of a stem , which is attached to the main arm via a second motor rotating along the other axis . *",
    "an _ arduino board _ controls the two motors of the sun blocker .",
    "the algorithm is briefly explained in the appendix [ append : motor ] . *",
    "a _ built - in laptop _ supervises the whole process .",
    "it controls the arduino board through a serial communication port and the camera through a _ usb _",
    "connection and the canon digital camera sdk .",
    "the captured images are stored on its hard drive and can be accessed via an internet connection . as an alternative , a workstation situated outside the box can also be used . *",
    "_ outer casing : _ a hermetically - sealed box prevents moisture and dirt from affecting the internal components .",
    "it contains a transparent dome at the top in which the fish - eye lens of the camera is positioned . * the _ camera and lens _ is discussed in more detail in section [ sec : camera ] below .",
    ", scaledwidth=35.0% ]    the device operates autonomously .",
    "however , some periodic manual maintenance interventions may be needed occasionally , for example to prevent the wear and tear of the motor gears .",
    "we have currently built one prototype of _ wahrsis _ , which we placed on the roof - top of our university building .",
    "we plan to position several models across different parts of singapore .",
    "table [ cost ] details all the components and their respective prices at the time of purchase @xcite .    .cost",
    "analysis for all the components of wahrsis [ cols=\"<,>\",options=\"header \" , ]      the imaging system of _ wahrsis _ consists of a _ canon eos rebel t3i _ ( a.k.a .  _ eos 600d _ ) camera body and a _ sigma 4.5 mm f2.8 ex dc hsm _ circular fisheye lens with a field of view of @xmath0 degrees .",
    "it captures images with a resolution of @xmath1 pixels . due to the lens design and sensor size ,",
    "the entire scene is captured within a circle with a diameter of approximately @xmath2 pixels ( see figure [ fig : wb ] ) .",
    "a custom program running on the built - in laptop uses the _ canon digital camera sdk _ to control the camera .",
    "images can be automatically captured at regular time intervals , and the camera settings can be adjusted as needed .",
    "the sensor of a typical digital camera absorbs near - infrared light quite effectively , so much that there is an infra - red blocking filter behind the lens .",
    "we had this filter physically removed and replaced by a piece of glass , which passes all wavelengths .",
    "the reasoning is that near - infrared light is less susceptible to attenuation due to haze@xcite , which is a common phenomenon in the atmosphere and especially around large cities .",
    "haze consists of small particles in suspension in the air .",
    "those have a scattering effect on the light whose incidence is modeled by rayleigh s law , meaning that the intensity of the scattered light @xmath3 , where @xmath4 is the intensity of the emitted light , and @xmath5 the wavelength of the light .",
    "we can thus reduce this effect by considering longer wavelengths , such as the ones in near - infrared .",
    "this model is however only valid for particles whose size is smaller than @xmath6 .",
    "most cloud consist of larger particles ; their resulting scattering effect obeys mie s law , which is wavelength - independent . for this reason",
    ", we expect our modified camera to provide us sharper images of cloud formations .",
    "the images captured by _ wahrsis _ are of high resolution and capture the full sky hemisphere .",
    "however , the scene appears distorted by the fish - eye lens , and the colors are not rendered correctly due to the alteration for near - infrared sensitivity .",
    "various calibration stages are thus required  .",
    "section [ sec : white_balancing ] discusses white balancing .",
    "section [ sec : geometrical_calib ] relates the geometric calibration due . finally , section [ sec : intensity ] details the vignetting correction .",
    "the camera of _ wahrsis _ is also sensitive to near - infrared light and thus sees beyond the visible spectrum .",
    "color calibration in the traditional sense is less meaningful for our camera , because it is sensitive to both visible and near - infrared light .",
    "however , white balancing is still necessary , as we will explain here .",
    "the sensitivity of the various channels depends on the bayer filter in front of the sensor .",
    "it is known that the red pixels show more near - infrared leakage than the blue or green ones .",
    "the automatic white balance settings were engineered for a non modified camera . as a result , images captured under an automatic white balance mode appear reddish , as shown in figure [ fig : auto ] .",
    "fortunately , our camera also provides a custom mode .",
    "it relies on a known white patch in the scene , for which the camera computes the incident light intensity quantization parameters to render this patch white in the captured picture . the resulting image after custom white balancing looks visually plausible ,",
    "as is shown in figure [ fig : custom ] .    without white balancing ,",
    "the red channel of our camera is prone to over - saturation and color clipping due to the additional near - infrared light reaching the sensor .",
    "the red channel of figure [ fig : auto ] contains 24.5% of clipped values ( i.e. where @xmath7 ) , whereas the same channel in figure [ fig : custom ] contains only 0.7% of them .",
    "this shows the importance of the custom white balancing , which manages to compensate quite well for the near - infrared alteration .      a geometric calibration of the capturing device needs to be performed in order to obtain a precise model of the distortion introduced by the imaging system , which in our case includes the fish - eye lens and the dome@xcite .",
    "this consists of determining the intrinsic parameters of the camera , which relates the pixel coordinates with their 3d correspondences in a camera coordinate system . on the other hand ,",
    "extrinsic parameters express the translations and rotations required to use other 3d world coordinate systems , such as the ones span by the checkerboard borders .",
    "intrinsic parameters give all the information needed to relate each pixel of a resulting image with the azimuth and elevation angles of the incident light ray and vice - versa , which is essential to be able to measure the physical extent of clouds .",
    "the modeling of a typical ( non - fisheye ) camera uses the pinhole model .",
    "however , this is not applicable to our case because of the very wide capturing angle .",
    "a schematic representation of the refraction of an incident ray in a fisheye lens is shown in figure [ fig : fig6 ] .",
    "most common approaches relate the incident angle ( @xmath8 ) with the radius on the image plane ( @xmath9 ) , assuming that the process is independent of the azimuth angle .",
    ", scaledwidth=40.0% ]    several theoretical models relating those two values exist :    * stereographic projection : @xmath10 * equidistance projection : @xmath11 * equisolid angle projection : @xmath12 * orthogonal projection : @xmath13 * perspective projection : @xmath14    fisheye lens manufacturers usually claim to obey one of those , but those equations can not be exactly matched in practice .",
    "however , they can be approximated by a polynomial due to the taylor series theory .",
    "some of the calibration techniques make use of this , as it easily allows a slight deviation from the projection equation .",
    "two polynomial functions can also be used to cope with possible radial and tangential distortions caused by the lens .",
    "most calibration techniques use a checker - board with a known pattern .",
    "shah et al.@xcite introduce a calibration method where such a polynomial is used .",
    "furthermore , they model radial and tangential distortions .",
    "the optical center of the camera has to be found using a low power laser beam , which is cumbersome in practice .",
    "bakstein et al.@xcite use a spherical retina model , but do not provide any extrinsic parameter estimation technique and use cylindrical patterns .",
    "sturm et al.@xcite introduce a very generic model , where a camera is described by the coordinates of a set of rays and a mapping between those and the image pixels .",
    "however the authors experienced difficulties with a fish - eye lens , especially on the side view .",
    "kannala et al.@xcite use polynomials to describe the calibration and the radial and tangential distortions , but they also assume that the positions of the pattern on the checker - board are known . finally , scaramuzza et al.@xcite provide an algorithm estimating both intrinsic camera parameters and the extrinsic parameters describing the positions of the checker - board .",
    "they provide a full _ matlab _ implementation of their method , making it the easiest to use .",
    "we have chosen to use this method and enhanced it for our needs .",
    "the calibration toolbox proposed by scaramuzza and al.@xcite takes as input a number of images containing a known checker - board pattern .",
    "the first step is corner detection , which is performed by the toolbox .",
    "user interaction is required when the automatic detection algorithm fails .",
    "those points are then used to find the parameters by a least - squares linear minimization , followed by a non - linear refinement with a maximum likelihood criterion .",
    "the toolbox uses a polynomial to model the ray refraction as well as a @xmath15 matrix transformation and a translation to cope with small axis misalignment and the digitizing process .",
    "the intrinsic parameters thus consist of both the coefficients of the polynomial as well as the values of the matrix and the translation parameters , which describe the position of the center of the image .",
    "figure [ fig : calibration_images ] shows a sample of the images we used for the calibration .",
    ", title=\"fig:\",scaledwidth=20.0% ] , title=\"fig:\",scaledwidth=20.0% ] , title=\"fig:\",scaledwidth=20.0% ] , title=\"fig:\",scaledwidth=20.0% ]    the toolbox also outputs the re - projection errors , i.e. the difference between the original point location computed during the corner detection and the one resulting from the estimated parameters .",
    "this is done on the same images as the ones used for the parameter estimation .",
    "however we noticed that the returned errors do not necessarily relate the quality of the calibration , as the re - projection sometimes looks more accurate than the corner detection or the user input in estimating the coordinates of a grid corner .",
    "furthermore we would like to estimate a general error which does not only rely on the location of the checker - boards in the images used for the fitting .",
    "we also observed that the choice of the input images has a significant influence on the output of the algorithm .",
    "we thus modified the calibration process in the following way : we randomly split our captured checker - board images into a training set of 10 images and a validation set of 6 images .",
    "we compute the parameters using the training set and the re - projection error using the validation set .",
    "we repeat this process 50 times with different randomized splits and finally consider the parameters leading to the smallest error on the validation set as the most accurate one . in this way",
    "we can reduce the uncertainty of the whole process .",
    "our fish - eye lens ( _ sigma 4.5 mm f2.8 ex dc hsm _ ) was designed by the manufacturer to follow the equisolid projection for visible light , but may be less accurate for the near - infrared spectrum .",
    "there is also a transparent dome on top of the camera lens , which may have an additional refracting effect on the incident rays .",
    "the toolbox models the calibration function as a polynomial and can thus incorporate these effects when fitting the coefficients .",
    "we have set the maximum degree of the polynomial to 4 , as advised by the authors of the toolbox .",
    "we indeed noticed a bigger re - projection error with smaller degrees .",
    "however when the maximum degree is set to a higher number , the values of the coefficients of the degrees higher than 4 are almost zero .",
    "figure [ fig : calibration_results ] shows the result of the resulting calibration compared to the various theoretical projection models .",
    "figure [ fig : diff_model_calib ] shows the distance in pixels between our estimated calibration parameters and the various projection models .",
    "we see that we reach a distance of more than 16 pixels for angles around 40 degrees .",
    "we also find that the maximum viewing angle of the whole device is 178.7 degrees , slightly less than hemispheric .",
    "figure [ fig : reprojection_error_bw ] shows the re - projection error for all the points of the grids in the validation set . a moving average with a window of 50 pixels",
    "is also shown .",
    "the average re - projection error for our model is 3.87 pixels .",
    "we can see a minor increase of the error with distance from the image center ( and thus the elevation angle of the incident ray ) .",
    ", scaledwidth=48.0% ]      the refractive index of lenses is wavelength - dependent .",
    "this means that light rays from different parts of the spectrum converge at different points on the sensor .",
    "chromatic aberration refers to the color distortions introduced to the image as a result this phenomenon .",
    "since the camera of _ wahrsis _ is sensitive to near - infrared , a larger part of the light spectrum is captured by the sensor , making the device more prone to this issue .",
    "figure [ fig : example_chrom_aberr ] shows chromatic aberration on an image captured by the camera .    ,",
    "scaledwidth=21.0% ]    the calibration process described in the previous section uses grayscale images . in order to obtain more accurate calibration functions ,",
    "we apply the same process on each of the red , green , and blue channels individually .",
    "as shown in figure [ fig : difference_rgb ] , we observe small differences in the resulting calibration functions , especially for the red channel .",
    "visually , the difference is quite striking , as can be seen in figure [ fig : proj ] .    ,",
    "scaledwidth=48.0% ]      vignetting refers to a darkening toward the corners of the image which is introduced during the capturing process .",
    "it has several origins .",
    "natural vignetting is due to the incident light rays reaching the camera sensors with varying angles .",
    "it is commonly modelled by the cosine fourth law .",
    "the camera of _ wahrsis _ is particularly prone to this effect due to its wide angle .",
    "optical vignetting describes the shading caused by the lens cylinder itself , blocking part of the off - axis incident light .",
    "this is aperture - dependant.@xcite    we use an integrating sphere to analyze this phenomenon .",
    "it consists of a large sphere , whose interior surface is made of a diffuse white reflective coating , resulting in a uniform light source over the whole surface .",
    "a led light source as well as the camera are placed inside .",
    "figure [ fig : sphere ] shows an image captured inside this sphere . notice the higher brightness at the center .",
    "this image has been taken with the biggest available aperture ( @xmath16 ) and constitutes the worst case with regards to vignetting .",
    "smaller aperture values will result in less significant distortions .",
    ", scaledwidth=45.0% ]    figure [ fig : pro_distance ] shows the luminance of the pixels inside the lens circle as a function of the distance from the image center .",
    "we normalize those values and then take their inverse .",
    "we fit a moving average and use this result as a radius dependent correction coefficient ( figure [ fig : coefficients ] ) .",
    "we repeat this process for each aperture setting .",
    "we have presented wahrsis , a new whole sky imager .",
    "its advantages are low cost and simple design .",
    "we described its components and the calibration of its imaging system .",
    "it provides high resolution images of the whole sky hemisphere , which can be useful for many various applications .",
    "in our future work we will use the resulting images for detailed cloud analysis .",
    "we plan to deploy several devices across the country to estimate cloud cover , cloud bottom altitude , cloud movement , etc .",
    "we will also investigate the effects of the near - infrared capabilities for these analyses in more detail .",
    "finally , we are working on an improved version of _ wahrsis _ with a better sunblocker design .",
    "in order to block the light coming directly from the sun , the sun blocker head should intersect the ray from the sun to the camera .",
    "we use the jean meeus algorithm@xcite to compute the azimuth and elevation angles of this ray , which we call @xmath17 and @xmath18 respectively .",
    "the algorithm has an error of @xmath19 degrees .",
    "the various lengths and angles required for the computations are shown in figure [ fig : sidetopwsi_sub ] .",
    "@xmath20 represents the length of the main arm .",
    "@xmath21 is the distance of the motor shift between the blocker and the arm .",
    "@xmath22 denotes the length of the stem under the blocker head .",
    "@xmath23 denotes the length between the camera center and the arm motor axis .",
    "the two unknowns are @xmath24 which measures the arm angle measured from the horizon and @xmath25 which measures the stem angle measured from the east direction .",
    "the following trigonometric equations are used :              the arm angle @xmath24 can range from @xmath31 to @xmath32 degrees , whereas the stem angle @xmath25 can range from @xmath33 to @xmath0 degrees .",
    "combinations of @xmath24 and @xmath25 with increments of @xmath34 are used to compute the related @xmath17 and @xmath18 sun ray angles values .",
    "the combination leading to the smallest difference between those values and the ones obtained by the jean meeus algorithm is used .    the research presented in this paper",
    "is funded by the defence science and technology agency ( dsta ) , singapore .",
    "the authors would also like to thank mr .",
    "ong kee wang ( ntu , singapore ) for building the initial design of wahrsis as a part of his final year project , and mr",
    ". alexandros fragkiadakis ( epfl , swizterland ) for his contributions in the camera calibration as part of an internship at adsc .",
    "kumar , l.  s. , lee , y.  h. , and ong , j.  t. , `` truncated gamma drop size distribution models for rain attenuation in singapore , '' _ antennas and propagation , ieee transactions on _  * 58*(4 ) , 13251335 ( 2010 ) .",
    "shields , j.  e. , karr , m.  e. , tooman , t.  p. , sowle , d.  h. , and moore , s.  t. , `` the whole sky imager  a year of progress , '' in [ _ 8th atmospheric radiation measurement ( arm ) science team meeting _ ] , 2327 ( 1998 ) .        souza - echer , m.  p. , pereira , e.  b. , bins , l.  s. , and andrade , m. a.  r. , `` a simple method for the assessment of the cloud cover state in high - latitude regions by a ground - based digital camera , '' _ journal of atmospheric & oceanic technology _  * 23*(3 ) , 437447 ( 2006 ) .",
    "shah , s. and aggarwal , j. , `` intrinsic parameter calibration procedure for a ( high - distortion ) fish - eye lens camera with distortion model and accuracy estimation , '' _ pattern recognition _  * 29*(11 ) , 17751788 ( 1996 ) .",
    "scaramuzza , d. , martinelli , a. , and siegwart , r. , `` a toolbox for easily calibrating omnidirectional cameras , '' in [ _ intelligent robots and systems ( iros ) , ieee / rsj international conference on _ ] , 56955701 , ieee ( 2006 ) ."
  ],
  "abstract_text": [
    "<S> cloud imaging using ground - based whole sky imagers is essential for a fine - grained understanding of the effects of cloud formations , which can be useful in many applications . </S>",
    "<S> some such imagers are available commercially , but their cost is relatively high , and their flexibility is limited . therefore , we built a new daytime whole sky imager ( wsi ) called wide angle high - resolution sky imaging system . </S>",
    "<S> the strengths of our new design are its simplicity , low manufacturing cost and high resolution . </S>",
    "<S> our imager captures the entire hemisphere in a single high - resolution picture via a digital camera using a fish - eye lens . </S>",
    "<S> the camera was modified to capture light across the visible as well as the near - infrared spectral ranges . </S>",
    "<S> this paper describes the design of the device as well as the geometric and radiometric calibration of the imaging system . </S>"
  ]
}