{
  "article_text": [
    "the fluctuating hydrodynamic description of binary mixtures of miscible fluids is well - known @xcite , and has been used successfully to study long - ranged non - equilibrium correlations in the fluctuations of concentration and temperature @xcite .",
    "much less is known about mixtures of more than two species ( multicomponent mixtures ) , both theoretically and experimentally , despite their ubiquity in nature and technological processes .",
    "part of the difficulty is in the increased complexity of the formulation of multispecies diffusion and the increased difficulty of obtaining analytical results , as well as the far greater complexity of experimentally measuring transport coefficients in multispecies mixtures .",
    "in fact , experimental efforts to characterize the thermo - physical properties of ternary mixtures are quite recent and rather incomplete @xcite .    at the same time , many interesting physical phenomena occur only in mixtures of more than two species .",
    "examples include diffusion - driven gravitational instabilities that only occur when there are at least two distinct diffusion coefficients @xcite , as well as reverse diffusion , in which one of the species in a mixture of more than two species diffuses in the direction opposite to its concentration gradient .",
    "another motivation for this work is to extend our models and numerical studies to chemically - reactive liquid mixtures @xcite ; interesting chemical reaction networks typically involve many more than two species .",
    "giant nonequilibrium thermal fluctuations @xcite are expected to exhibit qualitatively new phenomena in multispecies mixtures due to their coupling with phenomena such as diffusion- and buoyancy - driven instabilities . due to the difficulty in obtaining analytical results in multispecies mixtures , it is important to develop computational tools for modeling complex flows of multispecies mixtures . in previous work , we developed a fluctuating hydrodynamics finite - volume solver for ideal mixtures of ideal gases @xcite , and studied giant fluctuations , diffusion - driven instabilities , and reverse diffusion in gas mixtures . in practice , however , such phenomena are much more commonly observed and measured experimentally in non - ideal mixtures of liquids .",
    "it is therefore important to develop fluctuating hydrodynamics codes that take into account the large speed of sound ( small compressibility ) of liquids , as well as the non - ideal nature of most liquid solutions and mixtures .",
    "while thermal transport does of course play a role in liquid mixtures as well , it is often the case that experimental measurements are made isothermally or in the presence of steady temperature gradients , or that temperature and concentration fluctuations essentially decouple from each other @xcite . in this work",
    "we extend our work on isothermal low mach number fluctuating hydrodynamics for non - ideal binary mixtures of liquids @xcite to multispecies mixtures .",
    "transport in multispecies fluid mixtures is a topic of great fundamental and engineering importance , and has been studied in the field of nonequilibrium thermodynamics @xcite and chemical engineering @xcite for a long time . while the case of a binary fluid mixture is well - understood and the complete hydrodynamic equations are well - known , including thermal fluctuations @xcite , there are some inconsistencies in the literature regarding the treatment of multispecies diffusion . here",
    "we combine several sources together to obtain a formulation that is , to our knowledge , new , although all of the required pieces are known .",
    "in particular , our focus here is on formulating the equations in a way that : ( 1 ) fits the framework of nonequilibrium thermodynamics , notably , the generic framework @xcite ; ( 2 ) is amenable to computer simulations for large numbers of species ; ( 3 ) allows for straightforward inclusion of thermal fluctuations ; ( 4 ) includes all standard mass transport processes ( fickian diffusion , thermodiffusion , barodiffusion ) and applies to non - ideal mixtures of non - ideal fluids ; ( 5 ) expresses diffusive fluxes in a barycentric ( center of mass ) frame to allow seamless integration with the navier - stokes equations ; and ( 6 ) is based on the maxwell - stefan ( rather than fickian ) formulation of diffusion @xcite .",
    "these requirements inform our choice of the different elements of the formulation from different sources .",
    "our primary source is the recent monograph by kuiken @xcite , which contains a nearly complete formulation except for some confusion between ideal and non - ideal mixtures that we clarify later on .",
    "another primary source we rely on is the book of krishna and taylor @xcite .",
    "this book , like many other sources in chemical engineering , rely on separating one of the @xmath0 species as a special `` solvent '' species in order to eliminate the redundancy in the description .",
    "while this simplifies the analytical formulation to some extent , it breaks the inherent symmetry of the problem by singling out a species .",
    "this complicates the numerical implementation and does not work well when the reference species vanishes .",
    "following our prior work on mixtures of ideal gases @xcite , we rely on the monograph by giovangigli @xcite to develop a formulation that treats all species equally and deals with the redundancy by using linear algebra techniques , see also a recent mathematical analysis and generalization to non - ideal gas mixtures @xcite . here",
    "we amend this formulation to account for non - ideality of the mixture , based in large part on @xcite but now rewritten in terms of @xmath0 rather than @xmath1 variables . for thermodiffusion",
    "we rely on the formulation of kjelstrup _ et al . _",
    "summarized in the book @xcite , instead of that of kuiken , in order to be in agreement to the standard definition of soret and thermodiffusion coefficients for binary mixtures .",
    "thermal fluctuations are formulated by fitting the formulation into the generic framework , relying closely on the work of ottinger @xcite .    in the remained of this section",
    ", we will define some notation and introduce the low mach number formulation . in section",
    "we discuss the formulation of both the deterministic and stochastic mass fluxes . by combining the proposed formulation of the mass fluxes with the low mach number navier - stokes equations",
    "we obtain a description of the fluctuating hydrodynamics of quasi - incompressible mixtures of incompressible miscible liquids . in section ,",
    "we introduce and validate a discretization of the resulting system of equations using finite - volume methods that exactly enforces the low mach number quasi - incompressibility constraint @xcite .",
    "the method treats viscosity implicitly , allowing us to study flows over a broad range of reynolds numbers , including steady stokes flow . in section",
    ", we use our algorithms to numerically study the development of diffusion - driven gravitational instabilities in a ternary solution of sugar and salt in water .",
    "we find a favorable comparison between our numerical results and recent experimental measurements in a hele - shaw cell @xcite .",
    "we propose that shadowgraph measurements in a different geometry may yield additional information about the possible coupling between the nonlinear instability and the giant concentration fluctuations that develop due to the presence of sharp gradients at the fluid - fluid interface .",
    "our notation is based closely , though not entirely , on the work of kuiken .",
    "we avoid the use of molar quantities and instead rely on `` per molecule '' equivalents , and also prefer the term `` species '' over `` component '' .",
    "vectors ( both in the geometrical and in the linear algebra sense ) , matrices ( and tensors ) and operators are denoted with bold letters . a diagonal matrix whose diagonal is given by a vector is denoted by the corresponding capital letter , for example",
    ", @xmath2 implies @xmath3 .",
    "the vector of @xmath0 partial mass densities is @xmath4 , giving the total mass density @xmath5 .",
    "the partial number densities are denoted with @xmath6 , where @xmath7 is the molecular mass of species @xmath8 , with total number density @xmath9 .",
    "the mass fractions are denoted with @xmath10 , @xmath11 , while the number or mole fractions are denoted with @xmath12 , @xmath13 ; both the mass and number fractions must sum to unity , @xmath14 , where @xmath15 denotes a vector of ones .",
    "one can transform between mass and number fractions by @xmath16 where the mixture - averaged molecular mass is @xmath17 a useful formula that we will use later is the jacobian of transforming from mass to number fractions @xmath18 where @xmath19 .      the hydrodynamics of miscible mixtures of incompressible liquids can be described using low mach number equations , as explained in more detail in our prior works @xcite .",
    "the low mach number equations can be obtained by making the ansatz that the thermodynamic behavior of the system is captured by a reference pressure @xmath20 , with the additional pressure contribution @xmath21 capturing the mechanical behavior while not affecting the thermodynamics , where @xmath22 is the mach number .",
    "the reference pressure is determined from the condition of hydrostatic equilibrium in the absence of flow . in a gravitational field",
    ", the reference state is stratified and the reference pressure is in hydrostatic balance , @xmath23 , where @xmath24 is the gravitational acceleration ( see @xcite for details of the construction of these types of models ) . in this work",
    "we will assume that the reference pressure gradients are weak so that the thermodynamic properties of the system can be evaluated at a reference pressure @xmath25 that does not depend on space and time .",
    "we will focus here on systems for which the temperature @xmath26 is _ specified _ and not modeled explicitly .",
    "a constant - temperature model is appropriate , for example , if the system is in contact with an external heat reservoir and the thermal conductivity is sufficiently large to ensure a constant temperature ( e.g. , a constant temperature gradient ) is maintained , and the dufour effect is negligible . in the context of fluctuating hydrodynamics , one can often argue that temperature ( more precisely , energy ) fluctuations decouple from concentration fluctuations @xcite , and one can model mass and energy transport separately . it is possible to extend our low mach number formulation to include energy transport @xcite , as we will consider in future work .",
    "here we simply account for mass transport due to imposed fixed thermodynamic pressure and temperature gradients in the form of barodiffusion and soret mass fluxes , but do not model the evolution of the thermodynamic pressure and temperature explicitly .    in low mach number models",
    "the total mass density @xmath27 is a specified function of the local composition at the given reference pressure and temperature . here",
    "we consider mixtures of incompressible liquids that do not change density upon mixing . a straightforward multispecies generalization of the binary formulation we proposed in ref .",
    "@xcite is given in eq .",
    "( 2.1 ) in @xcite , and takes the form of an equation of state ( eos ) constraint @xmath28 where @xmath29 are the pure - component densites , which we will assume to be specified constants .",
    "we note that even if the specific eos ( [ eq : eos ] ) is not a very good approximation over the entire range of concentrations , it may nevertheless be a very good approximation over the range of concentrations of interest if the densities @xmath29 are adjusted accordingly . in this case , @xmath29 are to be interpreted not necessarily as pure component densities , since some of the components may not even exist as fluid phases at the reference pressure and temperature , but rather , as numerical parameters describing locally the dependence of the mass density on the composition at the specified reference pressure and temperature .",
    "the _ low mach number _ equations for the center of mass velocity @xmath30 , the mechanical component of the pressure @xmath31 , and the partial densities @xmath32 of a multispecies mixture of @xmath0 fluids can be written in conservation form as @xcite , @xmath33 where @xmath34 is the viscosity , @xmath35 is a symmetric gradient , and @xmath24 is the gravitational acceleration .",
    "note that the bulk viscosity terms have been absorbed into the pressure @xmath36 in the low mach formulation @xcite .",
    "thermal fluctuations are accounted for through the stochastic momentum flux @xmath37 , formally modeled as @xcite @xmath38 where @xmath39 is boltzmann s constant and @xmath40 is a standard white noise gaussian tensor field with uncorrelated components , @xmath41    here @xmath42 is a composite vector of diffusive deterministic , @xmath43 , and stochastic , @xmath44 , fluxes in the barycentric ( center of mass ) frame , where @xmath45 is the flux for species @xmath46 .",
    "we will use a compact matrix notation in which we can write the mass conservation equations without subscripts , @xmath47 the diffusive fluxes preserve mass conservation because they sum to zero ( @xmath48 in matrix notation ) , @xmath49 which ensures that the total mass density obeys the usual continuity equation @xmath50 differentiating the eos constraint ( [ eq : eos ] ) in time we get @xmath51 giving the velocity constraint ( [ eq : div_v_constraint ] ) . only if the diffusive fluxes vanish or all of the species have the same pure densities does one recover the more familiar incompressible flow limit @xmath52 @xcite .",
    "in this section , we develop a formulation of the diffusive fluxes in the barycentric frame for a non - ideal mixture , in a manner suitable for numerical modeling .",
    "nonequilibrium thermodynamics expresses the deterministic diffusive fluxes in terms of the thermodynamic driving force ( gradients of the chemical potential ) ; in short - hand matrix notation @xcite , @xmath53 where @xmath54 is the chemical potential of species @xmath8 , and @xmath55 denotes a gradient at constant temperature .",
    "it is important to note that we use chemical potential per unit mass @xcite , which differs from the more commonly used chemical potential per mole @xcite by a factor of @xmath56 , where @xmath57 is avogadro s number .",
    "the matrix of onsager coefficients @xmath58 is symmetric ( by onsager s reciprocity ) and positive - semidefinite ( to ensure dissipation , i.e. , positive entropy production ) , and has zero row and column sums ( to ensure mass conservation ( [ eq : sum_f_i ] ) ) , see ( [ eq : onsager_l ] ) for the explicit form .",
    "the vector of thermal diffusion ratios @xmath59 also sums to zero to ensure mass conservation ( [ eq : sum_f_i ] ) , see ( [ eq : xi_onsager ] ) for the explicit form .    in order to make ( [ eq : flux_onsager ] ) suitable for computation , we need to express the gradients of the chemical potential and the onsager matrix in terms of more readily - computable quantities .",
    "the gradient of chemical potential at constant temperature can be expressed in terms of the gradient of composition and pressure using the chain rule .",
    "@xmath60 we now explain how to relate @xmath61 , @xmath62 and @xmath58 to more familiar thermodynamic and transport quantities . this will allow us to express the deterministic component of @xmath63 as a function of the local gradients of composition , temperature and pressure ( see ( [ eq : diff_fluxes ] ) for the final result ) , and will provide us with a model for the stochastic mass fluxes ( see ( [ eq : species_eq ] ) for the final result ) .",
    "we use the specific ( per mass ) gibbs density @xmath64 as the thermodynamic potential , where @xmath65 is the specific internal energy density , @xmath66 the specific entropy density , and @xmath67 is the specific volume .",
    "the chemical potentials per unit mass are @xmath68 . for non - ideal mixtures",
    ", we can express chemical potentials as a sum of ideal and excess contributions , @xmath69 where @xmath70 is a reference chemical potential ( e.g. , pure liquid state at standard conditions ) , and @xmath71 is the activity coefficient of species @xmath8 ; for an ideal mixture @xmath72 . in the low mach number",
    "setting we consider here , the chemical potentials depends on pressure _ only _ through the reference state .",
    "this is always true for an ideal mixture , but may be assumed more generally so long as the activities only depend on composition and _ not _ on pressure .",
    "note that all thermodynamic functions are in principle only defined for valid compositions , @xmath73 , however , any analytical extension of these functions can be used to work with unconstrained derivatives instead of the more traditional constrained derivatives .",
    "the matrix of thermodynamic factors @xmath74 is defined via the _ unconstrained _ derivatives @xmath75 which we can write in component form as @xmath76 we note that the thermodynamic factors are incorrectly defined in the book by kuiken @xcite to have pressure @xmath77 in the denominator instead of @xmath78 ( the two are of course equal for ideal gases ) . using the matrix of thermodynamic factors",
    "we can express the contribution to the gradient of the chemical potentials in terms of gradients of composition , @xmath79 note that the constraint @xmath80 is automatically taken into account since @xmath81 and the component of the unconstrained derivatives normal to the constraint does not actually matter .    for nonideal ( dense ) gas mixtures it is possible to relate @xmath74 to the equation of state ,",
    "see @xcite for example calculations for a dense - gas eos .",
    "in order to model the thermodynamic factors as a function of composition in liquid mixtures , several different models have been defined and experimentally parameterized , such as the wilson , ntlr , or uniquac models , as described in more detail in appendix d of the book by krishna and taylor @xcite .",
    "these models are all based on the normalized excess gibbs energy density per particle @xmath82 . converting this to specific excess gibbs energy density ,",
    "we can write @xmath83 giving the thermodynamic factors in the form @xmath84 by converting the second - order derivatives with respect to @xmath10 to the more traditional derivatives with respect to @xmath12 by using the jacobian , we obtain the final relation @xmath85 where the symmetric matrix @xmath86 is the hessian of the excess free energy per particle .    in the neighborhood of a stable point ( far from phase separation ) , the total gibbs energy density is locally a convex function of composition . by also including the ideal contribution to the free energy",
    ", it is not hard to show that this implies the stability condition @xmath87 where one of the eigenvalues is always zero and the rest must be non - negative .",
    "the physically key quantity required to model the thermodynamics of non - ideal mixtures is @xmath88 , rather than the more traditional @xmath74 . to avoid a large departure from the literature",
    "we continue to use @xmath74 but we note that in our numerical codes the input is @xmath88 and @xmath74 is calculated from ( [ eq : gamma_f ] ) . if one tries to model @xmath74 directly , it is difficult to ensure the correct symmetry structure , which is obscured in @xmath74 but directly evident in @xmath88 .",
    "we therefore disagree with statements in the literature that it is more accurate to use models for activities ( first derivatives ) than to use models for the excess free energy and then take second derivatives .",
    "while the former may indeed be more accurate it may also lead to inconsistent thermodynamics ; for thermodynamic consistency one must model the excess free energy as a function of composition .      in order to compute ,",
    "we express the partial volumes @xmath89 by using a maxwell relation , @xmath90 where @xmath91 is the specific volume . for a mixture of incompressible liquids given by the eos",
    ", the above relates @xmath92 to the pure - component densities . instead of partial volumes",
    "we will use the volume fractions @xmath93 .",
    "in ideal gas mixtures @xmath94 , and in the low mach number setting @xmath95 ; note that @xmath96 .",
    "the thermodynamic driving forces for diffusion are the chemical potential gradients , @xmath97 .",
    "note however , that the definition of the thermodynamic force is not unique , as becomes evident when we consider the average local entropy production rate due to mass diffusion , @xmath98 where @xmath99 is the acceleration of the particles of species @xmath46 due to external fields ( e.g. , gravity or electric fields ) . because the fluxes add to zero",
    ", we can add an arbitrary vector @xmath100 to all of the chemical potential gradients without changing the entropy production rate .",
    "let us therefore write the entropy production rate as @xmath101 where the above defines the thermodynamic driving force @xmath102 for the diffusion of the @xmath8-th species .",
    "thermodynamic equilibrium corresponding to a vanishing of the entropy production rate , more specifically , to a vanishing of both the driving forces and the fluxes , @xmath103 and @xmath104 .",
    "the fluxes above are defined in the barycentric frame . in order to determine the appropriate value of @xmath100 ,",
    "let us consider transforming to a frame of reference that is moving with velocity @xmath105 relative to the center of mass of the mixture .",
    "this changes the fluxes to @xmath106 and changes the entropy production rate by @xmath107 .",
    "this implies that if we want to have galilean invariance of the entropy production rate , we should ensure that the driving forces sum to zero , @xmath108 .",
    "if we take a gradient at constant temperature of both sides of the gibbs - duhem relation , @xmath109 we get the relation @xmath110 which shows that @xmath108 implies @xmath111 in this work we will only consider gravity , for which all species accelerations are equal to the gravitational acceleration , @xmath112 .",
    "this leads us to define the diffusion driving force as @xcite @xmath113 note that kuiken @xcite puts pressure @xmath77 in the denominator of the barodiffusion term instead of @xmath78 , which leads to an inconsistency with the majority of the literature and the standard definition of the maxwell - stefan ( ms ) diffusion coefficients @xcite .",
    "note that each of the two terms in the driving force separately sums to zero , since @xmath114 and @xmath115      in order to compute the diffusive fluxes using , we need to relate the onsager matrix @xmath58 to the more familiar maxwell - stefan ( ms ) diffusion coefficients .",
    "the maxwell - stefan relations are obtained by equating the driving force to the frictional force on a species due to the difference in its velocity relative to other species , @xmath116 where @xmath117 is the mass - averaged velocity of species @xmath8 augmented by the thermodiffusion `` slip '' . here the symmetric matrix of ms _ binary _ diffusion coefficients @xmath118 has zero diagonal , @xmath119 , and the off - diagonal elements are positive ( there may be exceptions to this rule for ionic solutions @xcite ) diffusion coefficients that have a physical interpretation of suitably dimensionalized inverse friction coefficients between _ pairs _ of species .",
    "this positivity of @xmath118 ensures a positive entropy production , and thus consistency with the second law .",
    "it is observed that the ms diffusion coefficients show less variation with changes in composition than alternatives such as fickian diffusion coefficients @xcite .",
    "the off - diagonal elements of @xmath118 can therefore be interpolated as a function of composition relatively easily @xcite .",
    "the thermodiffusive fluxes are expressed in terms of the thermodiffusion coefficients @xmath120 . since only differences of @xmath121 s",
    "appear , there are only @xmath1 thermodiffusion coefficients ; in order to ensure that the mass fluxes sum to zero , @xmath122 , we require that @xmath123 .",
    "this gives the constraint @xmath124 which removes the redundancy in the specification of the thermodiffusion coefficients .",
    "we can write ( [ eq : d_sm - k ] ) in matrix form as @xmath125 where the symmetric matrix @xmath126 is defined via @xmath127 it is relatively straightforward to show that @xmath126 is positive semidefinite if @xmath128 for @xmath129 .",
    "here we introduced the vector of thermal diffusion ratios @xmath130 where @xmath131 by construction . in our algorithm ,",
    "the primary input are the ms diffusion coefficients @xmath118 and the thermodiffusion coefficients @xmath120 ; @xmath126 and @xmath132 are calculated from them .    by combining ( [ eq : d_def ] ) and",
    "( [ eq : d_def_ms ] ) , we obtain @xmath133 which now relates the deterministic diffusive fluxes @xmath43 with the gradients in composition , pressure and temperature . by solving the above linear system for @xmath43 subject to the condition @xmath134",
    ", we can obtain a formula for the fluxes in terms of gradients of @xmath12 , @xmath77 and @xmath135 . in order to carry out this computation we follow giovangigli @xcite , where linear algebra tools are developed to solve the linear system .",
    "let us introduce to @xcite . ] the symmetric positive - semidefinite _ diffusion matrix _",
    "@xmath136 as a pseudo - inverse of @xmath126 @xcite , see appendix [ sec : diffusionmatrix ] for more details , is arbitrarily chosen . ]",
    "@xmath137 where @xmath138 is an arbitrary constant , for example , the choice @xmath139 guards against roundoff errors .",
    "one can directly compute @xmath136 using the above formula , but we will discuss numerical alternatives in appendix [ sec : diffusionmatrix ] . while the ms diffusion coefficients are binary friction coefficients ,",
    "the matrix @xmath136 is a multispecies construct that takes into account the composition of the mixture .",
    "one can in fact start the formulation from the matrix @xmath136 , however , we prefer to use the more - standard ms coefficients as input and compute @xmath136 from them .",
    "the reason behind this choice is the belief that the ms diffusion coefficients change more slowly with composition and thus are easier to tabulate and interpolate , than would be @xmath136 .",
    "it can be shown @xcite that the solution of this linear system of equations ( [ eq : d_eq ] ) can be written in the fickian form @xmath140.\\label{eq : diff_fluxes}\\ ] ] this expression will be used in our numerical codes to compute the fluxes from the gradients in composition , pressure and temperature .",
    "we use gradients of number fractions ( composition ) rather than gradients of chemical potential since the later is numerically ill - behaved due to the logarithmic divergence of the chemical potentials for nearly vanishing species .",
    "it is , however , also possible to isolate the singularity of the chemical potentials and to use the gradient of the non - singular part of the chemical potentials directly , instead of using @xmath74 to convert to gradients of composition , as done in ref .",
    "observe that the fluxes automatically add up to zero , @xmath141 , since @xmath142 .",
    "note that the expression inside the brackets in ( [ eq : diff_fluxes ] ) adds to zero over all species , since @xmath143 and @xmath108 .",
    "it is important to preserve these `` sum to zero '' properties in spatial discretizations of fick s law , as we discuss in more detail in section [ sub : diffusionnumerics ] .      to formulate the stochastic mass flux ,",
    "let us first relate the diffusion matrix @xmath136 to the more familiar onsager matrix . by comparing the onsager and the maxwell - stefan expressions for the fluxes @xmath144 we can directly identify ( see ( 2.17 ) in @xcite ) @xmath145 which makes it clear that the onsager matrix is symmetric positive semidefinite ( spd ) since @xmath136 is spd .",
    "for the soret effect , we can identify @xmath59 and @xmath132 as rescaled versions of each other @xmath146    the fact @xmath58 is spd by construction is crucial for adding thermal fluctuations ( stochastic mass fluxes ) , since that requires the `` square root '' of the onsager matrix , notably , a matrix @xmath147 that satisfies @xmath148 where star denotes an adjoint ( transpose for real matrices or conjugate transpose for complex matrices ) @xcite .",
    "it is easy to see that @xmath149 meets this criterion , where @xmath150 ; for example , @xmath151 can be taken to the lower - triangular cholesky factor of @xmath136 . in fluctuating hydrodynamics",
    "we simply add a stochastic contribution to the mass flux of the form @xmath152 where @xmath153 denotes a collection of @xmath0 spatio - temporal white noise random fields ( note that only @xmath1 random fields are actually required since one of the eigenvalues of @xmath58 is zero ) , i.e. , a random gaussian field with correlations , @xmath154 observe that the stochastic fluxes sum to zero , @xmath155 because @xmath156 follows from @xmath157 .",
    "we are finally in a position to write the complete equation for the mass fractions ( [ eq : rho_part_eq ] ) , @xmath158\\right\\ } .\\label{eq : species_eq}\\ ] ] in appendix [ sec : ms_fluct ] we demonstrate that the stochastic mass fluxes can also be derived by following the maxwell - stefan construction and augmenting the dissipative frictional forces between pairs of species by corresponding ( langevin ) fluctuating forces .",
    "that formulation gives another physical interpretation to the stochastic mass fluxes , but is not as useful for computational purposes because the number of pairs of species ( and thus stochastic forces ) is much larger than the number of species , so in computations we use .",
    "important quantities that can be derived from the fluctuating equation ( [ eq : species_eq ] ) are the spectrum of the time correlation functions and the amplitude of the fluctuations at thermodynamic equilibrium , referred to as the dynamic and static structure factors , respectively .",
    "the matrix of equilibrium structure factors can be expressed either in terms of mass or mole fractions .",
    "here we define the matrix of static covariances in terms of the fluctuations in the mass fractions @xmath159 around the equilibrium concentrations @xmath10 .",
    "the dynamic structure factor matrix @xmath160 is defined as @xmath161 where @xmath46 and @xmath162 are two species ( including @xmath163 ) , @xmath164 is the wavevector , hat denotes a fourier transform , and star denotes a complex conjugate .",
    "the equal time covariance in fourier space is the static structure factor @xmath165 , @xmath166    the equilibrium static factors were computed for a ternary mixture in @xcite . in appendix [ sub : s_k ]",
    "we use to obtain the equilibrium static structure factor for a mixture with an arbitrary number of species , @xmath167^{-1}\\left(\\m w-\\v w\\v w^{t}\\right).\\label{eq : s_w}\\ ] ] if the stability condition ( [ eq : stability_cond ] ) is satisfied then @xmath168 will be symmetric positive semidefinite , as it must be since it is a covariance matrix .",
    "if the mixture is unstable then the above calculation is invalid because the fluctuations around the mean will not be small and linearized fluctuating hydrodynamics will not apply . in the low mach number setting , the structure factor for density",
    "in this section we give some details about our numerical algorithms , and then present some validation studies that verify the deterministic and stochastic order of accuracy of our schemes . in particular , we confirm that we can accurately model equilibrium and non - equilibrium concentration fluctuations in multispecies ternary mixtures . in section [ sec : instabilities ] we use the algorithms described here to model the development of instabilities during diffusive mixing in ternary mixtures .",
    "the numerical algorithms we use to solve the multispecies low mach number equations ( [ eq : momentum_eq],[eq : div_v_constraint],[eq : species_eq ] ) are closely based on the binary mixture algorithms described in detail in ref .",
    "in particular , the spatial discretization of the quasi - incompressible flow eos constraint ( [ eq : div_v_constraint ] ) and the velocity equation ( [ eq : momentum_eq ] ) , as well as the temporal integration algorithms , are identical to the binary case @xcite . some of the key features of the algorithms developed in refs .",
    "@xcite are :    1 .",
    "we employ a uniform staggered - grid finite - volume ( flux - based ) spatial discretization because of the ease of enforcing the constraint on the velocity divergence ( note that our compressible algorithm @xcite uses a collocated grid ) and incorporating thermal fluctuations @xcite .",
    "our spatial discretization strictly preserves mass and momentum conservation , as well as the equation of state ( eos ) constraint @xcite ( but see section [ sub : driftcorrection ] ) .",
    "3 .   by using the high - resolution bell - dawson - shubin ( bds ) scheme @xcite for mass advection we can robustly handle the case of no mass diffusion ( no dissipation in ( [ eq : species_eq ] ) ) .",
    "4 .   our temporal discretization uses a predictor - corrector integrator that treats all terms except momentum diffusion ( viscosity ) explicitly .",
    "we have developed two different temporal integrators , one for the _ inertial _ momentum equation ( [ eq : momentum_eq ] ) , and one for the viscous - dominated or _ overdamped _",
    "limit @xcite in which the velocity equation becomes the steady stokes equation @xcite .",
    "5 .   we treat viscosity implicitly without splitting the pressure update , relying on a recently - developed variable - coefficient multigrid - preconditioned stokes solver @xcite .",
    "this makes our algorithms efficient and accurate over a broad range of reynolds number , including the zero reynolds number limit , even in the presence of nontrivial boundary conditions .",
    "the key difference between binary mixtures @xcite and multispecies mixtures is the handling of the density equation and the computation of the diffusive and stochastic mass fluxes . in the binary case ,",
    "the conserved variables we use are @xmath170 and @xmath171 , with the corresponding primitive variables being @xmath170 and the mass fraction @xmath172 . in the multispecies case ,",
    "our conserved variables are the partial densities @xmath173 ; the total density @xmath5 is computed from those as needed .",
    "the corresponding primitive variables are @xmath170 and @xmath174 . in the binary case we expressed all of the diffusive fluxes in terms of gradients of mass fractions , but in the multispecies case we rely on the more traditional formulation in terms of gradients of number ( mole ) fractions , and we also include @xmath175 as primitive variables .",
    "further details on the computation of the multispecies diffusive and stochastic mass fluxes are given in section [ sub : diffusionnumerics ] .",
    "our low mach number algorithms are specifically designed to ensure that the evolution remains on the eos constraint , i.e. , that the partial densities or equivalently the density and the composition in each grid cell strictly satisfy ( [ eq : eos ] ) @xcite .",
    "nevertheless , due to roundoff error and finite solver tolerance in the fluid stokes solver , a slow drift off the eos constraint occurs over multiple time steps . to correct this",
    ", we occasionally need to project the state ( partial densities ) back onto the constraint @xcite .",
    "a similar projection onto the eos is required in the bds advection scheme for average states extrapolated to the faces of the grid @xcite .    for binary mixtures",
    ", we used a simple @xmath176 projection onto the eos . for mixtures of many species ,",
    "some of the species may be trace species or not present at all , and in this case it seems more appropriate to use a mass - fraction - weighted @xmath176 projection step . given a state @xmath177 that does not necessarily obey ( [ eq : eos ] ) , the weighted @xmath176 projection consists of correcting @xmath173 as follows , @xmath178 where the correction is @xmath179 which vanishes for species not present ( @xmath180 ) .",
    "when performing a global projection onto the eos one should additionally re - distribute the total change in the mass of species @xmath8 over all of the grid cells to ensure that the projection step does not change the total mass of any species @xcite .",
    "the computation of the diffusive deterministic and stochastic mass fluxes for binary mixtures is described in detail in ref .",
    "we follow a similar but slightly different procedure for multispecies mixtures , primarily guided by the desire to make the algorithm efficient for mixtures of many species .      the user input to our fluid dynamics code , i.e. , the _ mixture model _",
    ", is a specification of the required thermodynamic ( e.g. , non - ideality factors ) and transport properties ( e.g. , shear viscosity ) of the mixture as a function of state .",
    "the state of the mixture is described by the variables @xmath181 , or , equivalently , @xmath182 , where we recall that in our low mach number model the pressure and temperature are specified and not modeled explicitly , and the density is not an independent variable since it is determined from the eos constraint .",
    "therefore , the mixture model in our low mach code consists of specifying the thermodynamic and transport properties as a function of the composition @xmath10 .    in the multispecies case",
    ", the mixture model requires specifying binary maxwell - stefan diffusion coefficients for each pair of species , i.e. , the lower triangle of the matrix @xmath118 .",
    "additional input is the vector of thermodiffusion coefficients @xmath120 ( recall that only @xmath1 of these are independent since an arbitrary constant can be added to this vector ) , and the hessian of the excess free energy per particle @xmath88 .",
    "ms diffusion coefficients can be interpolated as a function of composition using vignes- or darken - type formulas @xcite , based on data obtained experimentally @xcite or from molecular dynamics simulations @xcite .",
    "the thermodynamics can be parametrized using wilson , ntlr , or uniquac models , and hessian matrices @xmath88 can be computed from the formulas presented in appendix d of the book by krishna and taylor @xcite , based on experimental or molecular dynamics data @xcite .",
    "we are not aware of any models for parameterizing the thermodiffusion coefficients as a function of composition in liquid mixtures .",
    "we note , however , that despite the availability of various mixture models , experimental efforts to obtain the parameters required in these models and compare various models are very recent .",
    "we are not aware of any mixture of more than two species for which there is reliable and reproducible data for the mass and thermal diffusion and thermodynamic coefficients even in the vicinity of a reference state , yet alone over a broad range of compositions .    from the mixture model input ,",
    "i.e. , @xmath183 , @xmath118 , @xmath120 and @xmath88 , we compute the following quantities .",
    "first , we obtain the matrix @xmath126 using , and then from @xmath126 we compute the diffusion matrix @xmath136 using , as discussed in more detail in appendix [ sec : diffusionmatrix ] .",
    "we also compute the matrix of thermodynamic factors @xmath74 using , as well as the vector of thermal diffusion ratios @xmath132 using .",
    "these computations provide all of the matrices and vectors required to compute the non - advective mass fluxes in .",
    "we remind the reader that the species volume fractions @xmath184 are easily computable for our model of a mixture of incompressible components , @xmath185 .",
    "the basic spatial discretization of the fluid equations and mass advection is unchanged from our previous work on binary mixtures @xcite and we do not discuss it further here . here",
    "we explain how we handle the diffusive and stochastic mass fluxes in the multispecies setting .",
    "the deterministic and stochastic mass fluxes are computed on the faces of the grid , and the divergence of the flux is computing using a conservative difference , in two dimensions @xmath186+\\delta",
    "y^{-1}\\left[\\v f_{i , j+\\myhalf}^{(y)}-\\v f_{i , j-\\myhalf}^{(y)}\\right],\\label{eq : discrete_diffusion}\\ ] ] where @xmath187 .",
    "our spatial discretization of the deterministic diffusive fluxes closely mimics the one described in section iv.a of @xcite , and is based on centered differences and centered averaging . in order to avoid division by zero in the absence of certain species in some parts of the domain , in each cell ( i.e. , for each cell center ) we modify the densities @xmath188 to be no - smaller than a small constant @xmath189 on the order of the roundoff tolerance ; this modification is only done for the purpose of the diffusive flux calculation .",
    "in each cell , we compute the primitive variables @xmath170 , @xmath10 and @xmath12 and then use the user - provided mixture model to compute @xmath74 ( if the mixture is non - ideal ) , @xmath136 , @xmath132 and @xmath184 .",
    "next , in each cell @xmath190 , we compute the matrices @xmath191 and @xmath74 and the vectors @xmath192 , and @xmath193 .",
    "then , we average ( interpolate ) these matrices and vectors to the faces of the grid using arithmetic averaging , for example , @xmath194 and compute gradients of composition , pressure , and temperature using centered differences , for example , @xmath195 note that the key property @xmath196 is preserved , for example , @xmath197 finally , we compute the deterministic fluxes using by a matrix - vector product , for example , @xmath198    note that the important properties of discussed in section [ sub : fickian ] are maintained by this discretization . to ensure mass conservation ,",
    "it is crucial that the mass fluxes for different species add up to zero , for example , it must be that @xmath199 on every @xmath200 face of the grid . in the continuum formulation",
    "this is true because @xmath201 ; it is not hard to show that the arithmetic averaging procedure used above preserves this property , @xmath202 since @xmath157 in each cell .",
    "similarly , the continuum properties @xmath143 , @xmath203 and @xmath204 are preserved discretely due to their linearity and the linearity of the averaging process .",
    "this shows the importance of the linearity of the interpolation from the cell centers to the cell faces .    upon spatial discretization",
    ", the stochastic fluxes acquire a prefactor of @xmath205 due to the delta function correlation of white - noise , where @xmath206 is the volume of a grid cell @xcite .",
    "this converts the spatio - temporal white - noise process @xmath207 into a collection of independent temporal white - noise processes @xmath208 , one process for each face of the grid , for example , @xmath209 in our code , we compute the onsager matrix @xmath58 in every cell and then compute @xmath147 by cholesky factorization ; an equally good alternative is to compute @xmath151 by cholesky factorization .",
    "we then use arithmetic averaging to compute face - centered cholesky factors @xmath147 .",
    "an alternative procedure , which is likely better at maintaining discrete fluctuation - dissipation balance @xcite but is the number of dimensions times more expensive , is to average @xmath58 to the faces , and then perform a cholesky factorization on each face of the grid .",
    "note , however , that achieving strict discrete fluctuation - dissipation balance requires expressing the fluxes in terms of the discrete gradients of the chemical potential , which is rather inconvenient and not numerically well - behaved . in this work we chose to work with gradients of number fractions and",
    "thus only achieve discrete fluctuation - dissipation balance approximately .",
    "in the deterministic setting , we have confirmed the second - order accuracy of our numerical method by repeating the lid - driven cavity test used in our previous work on binary mixtures @xcite .",
    "the essential difference is that the bubble being advected through a pure liquid of a first species in the lid - driven cavity is now composed of a mixture of two other species , making this a ternary mixture test .",
    "our numerical results show little to no difference between the ternary and binary mixture cases , and show second - order pointwise deterministic convergence for our low mach number scheme .",
    "in this section we focus on tests in the context of fluctuating hydrodynamics , in particular , we examine the matrix of dynamic structure factors @xmath160 defined in ( [ eq : s_k_w ] ) , for a ternary mixture .",
    "we use the computer algebra system maple to evaluate and and obtain explicit formulas to which we compare our numerical results below .",
    "we also examine @xmath210 , since , according to ( [ eq : s_rho ] ) , by examining the fluctuations in density we are examining the correlations among all pairs of species .",
    "one of the key quantities used to characterize the intensity of _ equilibrium _ thermal fluctuations is the static structure factor or static spectrum of the fluctuations .",
    "we perform these tests in the steady stokes regime since the velocity fluctuations decouple from density fluctuations at equilibrium ; the only purpose of the fluid solver at uniform equilibrium is to ensure that the density remains consistent with the composition .    in this equilibrium test",
    "we use a ternary mixture with stefan - maxwell diffusion matrix and non - ideality matrix @xmath211 in some arbitrary units in which @xmath212 .",
    "the molecular masses for the ternary mixture are @xmath213 , and the pure component densities are @xmath214 .",
    "the system is a two - dimensional periodic system at equilibrium with equilibrium densities @xmath215 . at these conditions",
    "the equilibrium density variance is @xmath216 where @xmath206 is the volume of a grid cell .",
    "we employ a square grid of @xmath217 cells with grid spacing @xmath218 for these investigations , with the thickness in the third direction set to give a large @xmath219 and thus ensure consistency with linearized fluctuating hydrodynamics .",
    "a total of @xmath220 time steps are skipped in the beginning to allow equilibration of the system , and statistics are then collected for an additional @xmath221 steps .    equilibrium static structure factors @xmath222 as a function of wavevector ( zero being at the center of the figures ) for a ternary mixture .",
    "the correct result , which is recovered in the limit @xmath223 , is @xmath224 independent of wavenumber .",
    "( left ) clear artifacts are seen at grid scales for @xmath225 , which is @xmath226 of the stability limit .",
    "( right ) the artifacts decrease by a factor of 8 as the time step is reduced in half . note that the statistical errors are now nearly comparable to the numerical error.,title=\"fig:\",scaledwidth=49.0%]equilibrium static structure factors @xmath222 as a function of wavevector ( zero being at the center of the figures ) for a ternary mixture .",
    "the correct result , which is recovered in the limit @xmath223 , is @xmath224 independent of wavenumber .",
    "( left ) clear artifacts are seen at grid scales for @xmath225 , which is @xmath226 of the stability limit .",
    "( right ) the artifacts decrease by a factor of 8 as the time step is reduced in half .",
    "note that the statistical errors are now nearly comparable to the numerical error.,title=\"fig:\",scaledwidth=49.0% ]    at equilibrium , the static structure factors are independent of the wavenumber due to the local nature of the correlations , @xmath227 since we include mass diffusion using an explicit temporal integrator , for finite time step sizes @xmath228 we expect to see some deviation from a flat spectrum at the largest wavenumbers ( i.e. , for @xmath229 ) @xcite . in fig .",
    "[ fig : s_k ] we show the spectrum of density fluctuations at equilibrium for two different time step sizes , a large time step size @xmath225 ( left panel ) , and a smaller time step size @xmath230 ( right panel ) . since the largest eigenvalue of the diffusion matrix is around @xmath231 , the largest stable time step size is @xmath232 . as seen in the figure , for @xmath225 , which is close to the stability limit , we see a significant enlargement of the fluctuations at the corners of the fourier grid ; when we reduce the time step by a factor of 2 we reduce the error by a factor of around 8 , consistent with the fact that the explicit midpoint method used in our overdamped algorithm @xcite is third - order accurate for static covariances @xcite .",
    "therefore , in the limit of sufficiently small time steps we will recover the correct flat spectrum , demonstrating that our equations and our numerical scheme obey a fluctuation - dissipation principle .    equilibrium dynamic structure factors @xmath160 for a ternary mixture , as a function of time for wavenumber @xmath233 .",
    "numerical results are shown with symbols and theoretical predictions are shown with solid lines of the same color as the corresponding symbols .",
    "( left ) @xmath234 for @xmath235 for @xmath129 .",
    "( right ) @xmath236 for several wavenumbers .",
    "note that at large times statistical noise begins to dominate the signal .",
    ", title=\"fig:\",scaledwidth=49.0%]equilibrium dynamic structure factors @xmath160 for a ternary mixture , as a function of time for wavenumber @xmath233 .",
    "numerical results are shown with symbols and theoretical predictions are shown with solid lines of the same color as the corresponding symbols .",
    "( left ) @xmath234 for @xmath235 for @xmath129 .",
    "( right ) @xmath236 for several wavenumbers .",
    "note that at large times statistical noise begins to dominate the signal .",
    ", title=\"fig:\",scaledwidth=49.0% ]    in the left panel of fig .",
    "[ fig : s_k_t ] we show numerical results for the dynamic structure factors @xmath234 for several @xmath129 for @xmath237 , where @xmath238 is the length of the square domain .",
    "note that the factors for @xmath163 are not statistically independent due to the constraint that mass fractions sum to unity , and are thus not shown . in the right panel of fig .",
    "[ fig : s_k_t ] we show numerical results for @xmath236 , given by , for several different wavenumbers @xmath233 .",
    "we compare the numerical results to the theoretical prediction , which is a sum of two exponentially - decaying functions .",
    "excellent agreement is seen between simulation and theory , demonstrating that our numerical method correctly reproduces both the statics and dynamics of the compositional fluctuations .",
    "fluctuations in systems out of equilibrium are known to be long - range correlated and significantly enhanced compared to equilibrium . in particular , in the presence of an imposed ( macroscopic ) concentration gradient , concentration fluctuations exhibit a characteristic power - law static structure factor @xmath239 @xcite . in section iv.c in ref .",
    "@xcite , we studied the long - ranged ( giant ) concentration fluctuations in a ternary mixture in the presence of a gradient imposed via the boundary conditions , and confirmed that our multispecies compressible algorithm correctly reproduced theoretical predictions ; here we repeat this test but for a mixture of three incompressible liquids .",
    "in order to simplify the theoretical calculations , see appendix b in ref .",
    "@xcite , we take the first two of the three species to be dynamically identical ( indistinguishable ) , and take the molecular masses to be equal , @xmath240 ( this makes mass and mole fractions identical ) . the stefan - maxwell diffusion matrix is taken to be @xmath241 and the mixture is assumed to be ideal , @xmath242 , and isothermal , @xmath243 . in order to focus our attention on the nonequilibrium fluctuations we set the stochastic mass flux to zero , @xmath244 ; this ensures that all concentration fluctuations come from the coupling to the velocity fluctuations via the gradient and eliminate the statistical errors coming from a finite background spectrum .",
    "the pure component densities are @xmath245 , giving an incompressible fluid , @xmath52 , consistent with the theoretical calculations .",
    "a weak concentration gradient is imposed by enforcing dirichlet ( reservoir @xcite ) boundary conditions for the mass fractions at the top and bottom boundaries , @xmath246 and @xmath247 .",
    "these values are chosen so that the deterministic diffusive flux of the first species vanishes at @xmath248 , @xmath249 , leading to a diffusion barrier for the first species , as in ref .",
    "@xcite .",
    "the computational grid has @xmath250 grid cells with grid spacing @xmath218 , with the thickness in the third direction set to give @xmath219 , and time step @xmath225 . in order to study the spectrum of the giant concentration fluctuations , we compute the fourier spectrum of the mass fractions",
    "averaged along the direction of the gradient ; this corresponds to @xmath251 and thus @xmath252 .",
    "a total of @xmath253 time steps are preformed at the beginning of the simulation to allow the system to equilibrate .",
    "statistics are then collected for @xmath254 steps .    in this nonequilibrium example the coupling to the velocity equation",
    "is crucial and is the cause of the giant fluctuations .",
    "the normal component of the velocity at the two physical boundaries follows from the eos and the diffusive fluxes through the boundary , see eq .",
    "( 15 ) in ref .",
    "for the tangential ( @xmath200 ) component of velocity we use either no - slip ( zero velocity ) or free - slip ( zero shear stress ) boundary conditions . in the limit of infinite schmidt number , @xmath255 , where @xmath256 is a typical mass diffusion coefficient , the overdamped equations apply and @xmath257 approaches a limit independent of the actual value of the schmidt number . for finite schmidt numbers",
    ", however , the actual value of the schmidt number affects the spectrum , see appendix b in ref .",
    "@xcite for the explicit formulas .",
    "static structure factors of the mass fractions averaged along the direction of the gradient , exhibiting giant @xmath239 fluctuations .",
    "( left ) cross - correlations for the overdamped equations .",
    "filled symbols are for no - slip boundary conditions for velocity , while empty ones are for free - slip boundaries . lines of the same color show the theoretical prediction in a `` bulk '' system ( no boundaries ) .",
    "( right ) spectrum of fluctuations of @xmath258 for several different values of the viscosity for the inertial equations .",
    "the overdamped theory is shown for comparison .",
    "for @xmath259 ( schmidt number @xmath260 ) a difference between the inertial and overdamped results is seen and reproduced well by the numerical scheme .",
    "for @xmath261 there is very little difference between overdamped and inertial , and the two algorithms produce similar results . for very large viscosities",
    ", however , one should use the overdamped integrator , as evidenced by the notable departure from the theory at large wavenumbers for @xmath262.,title=\"fig:\",scaledwidth=49.0%]static structure factors of the mass fractions averaged along the direction of the gradient , exhibiting giant @xmath239 fluctuations .",
    "( left ) cross - correlations for the overdamped equations .",
    "filled symbols are for no - slip boundary conditions for velocity , while empty ones are for free - slip boundaries . lines of the same color show the theoretical prediction in a `` bulk '' system ( no boundaries ) .",
    "( right ) spectrum of fluctuations of @xmath258 for several different values of the viscosity for the inertial equations .",
    "the overdamped theory is shown for comparison . for @xmath259 ( schmidt number @xmath260 ) a difference between the inertial and overdamped results",
    "is seen and reproduced well by the numerical scheme .",
    "for @xmath261 there is very little difference between overdamped and inertial , and the two algorithms produce similar results . for very large viscosities",
    ", however , one should use the overdamped integrator , as evidenced by the notable departure from the theory at large wavenumbers for @xmath262.,title=\"fig:\",scaledwidth=49.0% ]    for the overdamped integrator , the actual value of the viscosity does not matter beyond simply rescaling the amplitude of the fluctuations , since the velocity equation is a time - independent ( steady ) stokes equation in the viscous - dominated limit . in the left panel of fig .",
    "[ fig : s_k_giant ] we show numerical results for @xmath263 for @xmath129 , obtained using our _ overdamped _",
    "algorithm @xcite .",
    "excellent agreement with the theoretical prediction in appendix b in ref .",
    "@xcite is seen for wavenumbers larger than @xmath264 ; for small wavenumbers the confinement suppresses the giant fluctuations in a manner that depends on the specific boundary conditions imposed @xcite . in the right panel of fig .",
    "[ fig : s_k_giant ] we show @xmath265 for several values of the kinematic viscosity , as obtained using our _ inertial _",
    "algorithm @xcite .",
    "the implicit - midpoint ( crank - nicolson ) scheme used to treat viscosity in the inertial algorithm is unconditionally stable and allows an arbitrary time step size to be used .",
    "it is , however , well - known that this kind of scheme can produce unphysical results for very large viscous courant numbers due to fact it is not @xmath266-stable ( see discussion in appendix b in ref .",
    "this is seen in the results in the right panel of fig .",
    "[ fig : s_k_giant ] for the largest viscosity @xmath262 ( corresponding to viscous courant number @xmath267 ) at the larger wavenumbers .",
    "it is actually quite remarkable that we can use the inertial integrator with rather large time step sizes and get very good results over most of the wavenumbers of interest ; this is a property that stems from a specific fluctuation - dissipation balance in the implicit midpoint scheme @xcite .",
    "these results demonstrate that both our overdamped and inertial methods are able to reproduce the correct spectrum of the nonequilibrium concentration fluctuations .      in the giant fluctuation example shown in fig .",
    "[ fig : s_k_giant ] , the system was kept out of equilibrium by imposed concentrations on the boundaries , which is difficult to realize in experiments .",
    "instead , experiments that measure giant fluctuations in liquid mixtures typically rely on the soret effect to induce a concentration gradient via an imposed temperature gradient @xcite .",
    "a concentration gradient can also be induced via barodiffusion in the presence of large gravitational accelerations , as used in ultracentrifuges for the purposes of separation of macromolecules and isotopes @xcite .",
    "barodiffusion and thermodiffusion enter in the density equations ( [ eq : species_eq ] ) in the same manner , however , the key difference is that barodiffusion requires gravity which also enters via the buoyancy term in the velocity equation ( [ eq : momentum_eq],[eq : div_v_constraint ] ) .",
    "furthermore , the steady state gradient induced by barodiffusion is determined by equilibrium thermodynamics only and does not involve any kinetic transport coefficients .",
    "it is well known that there is no nonequilibrium enhancement of the fluctuations at steady state for a system in a gravitational field @xcite in the absence of external forcing ( see eq .",
    "( 28 ) in @xcite ) .",
    "this is because the system is still in thermodynamic equilibrium , despite the presence of spatial nonuniformity ( sedimentation ) .",
    "in particular , without doing any calculations we know that the equilibrium distribution of the fluctuations is the gibbs - boltzmann distribution , with a local free - energy functional that now includes a gravitational energy contribution . in this section we demonstrate that our low mach number approach captures this important distinction between ( ordinary ) equilibrium fluctuations in the presence of barodiffusion , and ( giant ) nonequilibrium fluctuations in the presence of thermodiffusion .",
    "we consider a solution of potasium salt and sucrose in water ( see section [ sec : instabilities ] for more details ) in an ultracentrifuge .",
    "the physical parameters of this ternary mixture are given in section [ sub : physicalparameters ] , and a brief theoretical analysis is given in appendix [ sec : sedimentation ] .",
    "we perform two dimensional simulations of a system of physical dimensions @xmath268 cm divided into @xmath269 finite - volume cells .",
    "periodic boundary conditions are used in the @xmath200 direction and impermeable no - slip boundaries are used in the @xmath270 direction .",
    "the average mass fractions over the domain are set to @xmath271 a total of @xmath272 time steps are performed at the beginning of the simulation to allow the system to equilibrate before statistics are collected for @xmath221 steps .    in order to induce a strong sedimentation in this mixture we need to increase the ratio @xmath273 by six orders of magnitude relative to its reference value on earth ( see ( [ eq : sediment_dilute ] ) ) . in actual experiments",
    "this would be accomplished by increasing the effective gravity ( i.e. , centrifugal acceleration ) in an ultracentrifuge ; however , increasing gravity by such a large factor makes the system of equations ( [ eq : momentum_eq],[eq : div_v_constraint],[eq : species_eq ] ) numerically too stiff for our semi - implicit temporal integrator .",
    "this is because buoyancy changes the time scale for relaxation of large - scale ( small wavenumber ) concentration fluctuations from the usual slow diffusive relaxation to a very fast non - diffusive relaxation @xcite .",
    "therefore , instead of increasing @xmath274 we artificially decrease @xmath39 by six orders of magnitude , and apply earth gravity @xmath275 along the negative @xmath270 direction . with these parameters",
    "our inertial temporal integrator is stable with time step size up to about @xmath276s ; the results reported below are for @xmath277s .",
    "comparison of fluctuations in the presence of a strong concentration gradient induced by baro and thermo diffusion .",
    "( left ) the steady - state vertical concentration profile @xmath278 and @xmath279 as a function of height .",
    "( right ) static structure factors of density averaged along the direction of the gradient , exhibiting giant @xmath239 fluctuations for gradients induced by thermodiffusion .",
    "by contrast , fluctuations in the system with strong sedimentation induced by barodiffusion exhibit a similar spectrum as those in a homogeneous bulk equilibrium system in the absence of gravity.,title=\"fig:\",scaledwidth=49.0%]comparison of fluctuations in the presence of a strong concentration gradient induced by baro and thermo diffusion .",
    "( left ) the steady - state vertical concentration profile @xmath278 and @xmath279 as a function of height .",
    "( right ) static structure factors of density averaged along the direction of the gradient , exhibiting giant @xmath239 fluctuations for gradients induced by thermodiffusion . by contrast , fluctuations in the system with strong sedimentation induced by barodiffusion exhibit a similar spectrum as those in a homogeneous bulk equilibrium system in the absence of gravity.,title=\"fig:\",scaledwidth=49.0% ]    for comparison , we use the same parameters but turn gravity off and induce a concentration gradient via thermodiffusion .",
    "specifically , we set the temperature at the bottom wall to @xmath280k and @xmath281k at the top wall , and set the thermodiffusion constants to the artifical values @xmath282 .",
    "these values ensure that the steady state vertical profiles of the mass fraction of salt and sugar are very similar between the barodiffusion and thermodiffusion simulations ( see ( [ eq : thermodiff_dilute ] ) ) , as shown in the left panel of fig .",
    "[ fig : s_k_baro ] . in the right panel of the figure",
    "we show the spectrum @xmath283 of the vertically - averaged density . for comparison , in addition to the cases of gradients induced by baro and thermo diffusion",
    ", we also show the spectrum for a spatially - uniform system at thermodynamic equilibrum , in the absence of gravity and at a constant temperature of 293k .",
    "we see that the spectrum for barodiffusion is very similar to that for uniform thermodynamic equilibrium , while the spectrum for thermodiffusion shows the @xmath284 power - law behavior as in fig .",
    "[ fig : s_k_giant ] .",
    "this demonstrates that our numerical code correctly reproduces equilibrium fluctuations even in the presence of strong sedimentation .",
    "in this section we use our numerical methods to study the development of diffusion - driven gravitational instabilities in ternary mixtures . in section iv.d in ref .",
    "@xcite we studied the development of a diffusion - driven rayleigh - taylor ( rt ) instability in a ternary gas mixture . here",
    "we simulate similar instabilities in a ternary mixture of incompressible liquids , using realistic parameters corresponding to recent experimental measurements , and study the effect of ( nonequilibrium ) thermal fluctuations on the development of the instabilities .",
    "our investigations are inspired by the body of work by anne de wit and collaborators on diffusion- and buyoancy - driven instabilities @xcite .",
    "in particular , in ref .",
    "@xcite a classification of these instabilities in a ternary mixture are proposed , and several of the instabilities are investigated experimentally . in the first part of this section",
    "we perform simulations of the experimental measurements of a mixed - mode instability ( mmi ) .",
    "in the second part we investigate diffusive layer convection ( dlc ) ( just as we did in section iv.d in ref .",
    "@xcite for gases ) , in a hypothetical shadowgraphy or light scattering experiment that could , in principle , be performed in the laboratory .",
    "we begin with a brief summary of the experimental setup of carballido - landeira _ et al . _",
    "@xcite for getting a diffusion - driven gravitational instability in a simple ternary mixture : a solution of salt in water on top of a solution of sugar in water .",
    "the concentrations of salt and sugar are small so that even though this is a ternary mixture in this very dilute limit one can think of salt and sugar diffusing in water without significant interaction .",
    "the key here is the difference in the diffusion coefficient between sugar ( a larger organic molecule diffusing slower ) and salt ( a smaller ion diffusing faster ) in water .",
    "both sugar and salt solutions have a density that grows with the concentration of the solute .    in the experiments ,",
    "one starts with an almost ( to within experimental controls ) flat and almost sharp interface between the two solutions . even if one starts in a stable configuration , with the denser solution on the bottom",
    ", the differential diffusion effects can create a local minimum in density below the contact line and a local maximum above the contact line .",
    "this leads to an unstable configuration and the development of dlc at symmetric distances above and below the contact line .",
    "if one starts with an unstable configuration of the denser solution on top , before the rt instability has time to develop and perturb the interface , differential diffusion effects can lead to the development of local extrema in the density above and below the contact line that are outside the range of the initial densities .",
    "the dynamics is then a combination of rt and dlc giving rise to a mixed mode instability ( mmi ) .",
    "the dlc leads to characteristic y shaped convective structures developing around the interface at the locations of the local adverse density gradients , which evolve around an interface that is slowly perturbed by the rt growth to a finite amplitude modulation . see section iii in ref .",
    "@xcite for more details , and the bottom row of panels in fig . 1 in ref .",
    "@xcite , as well as our numerical results in fig .",
    "[ fig : mmi_development ] , for an illustration of the development of the instability .",
    "we use cgs units in what follows ( centimeters for length , seconds for time , grams for mass ) . following the experiments of carballido - landeira _",
    ", we consider a ternary mixture of potassium salt ( kcl , species 1 , molar mass @xmath285 , denoted by a in @xcite ) , sugar ( sucrose , species 2 , molar mass @xmath286 , denoted by b in @xcite ) and water ( species 3 , molar mass @xmath287 ) , giving molecular masses @xmath288 .",
    "the initial configuration is salt solution on top of sugar solution . in ref .",
    "@xcite , it is assumed that the density dependence on the concentration can be captured by ( this is a good approximation for very dilute solutions ) @xmath289 where @xmath290 is the density of water , @xmath291 for kcl and @xmath292 for sucrose , and @xmath293 is the molar density of each component , related to the partial density via @xmath294 where @xmath295 is the molar mass . noting that we can write our eos ( [ eq : eos ] ) in the form @xmath296 and comparing ( [ eq : eos_1 ] ) and ( [ eq : eos_2 ] )",
    ", we get @xmath297 which gives us the eos parameters @xmath298 note that here these should not be thought of as pure component densities since the solubility of the solvents in water is finite , rather , they are simply parameters that enable us to match our model eos to the empirical density dependence in the dilute regime .    for the dilute solutions we consider here it is sufficient to assume that @xmath118 is constant for the range of compositions of interest , and the mixtures are essentially ideal , @xmath299 .",
    "we also assume isothermal conditions with the ambient temperature to @xmath300k , and assume constant viscosity @xmath301 .",
    "since the ternary mixture under consideration is what can be considered `` infinite dilution '' , we rely on the approximation proposed in ref .",
    "@xcite , @xmath302 where from table i in ref .",
    "@xcite we read the diffusion coefficient of low - dilution kcl in water as @xmath303 , and the diffusion coefficient of dilute sucrose in water as @xmath304 . here",
    "@xmath305 is the self - diffusion coefficient of pure water , @xmath306 , giving @xmath307 .    in the simulations reported below , we have neglected barodiffusion and assumed that the pressure is equal to the atmospheric pressure throughout the system .",
    "if barodiffusion were included we would obtain partial sedimentation in the final state of the mixing experiment ( where the system has completely mixed ) , as discussed in more detail in section [ sub : thermobaro ] and appendix [ sec : sedimentation ] . in the final steady state ,",
    "( [ eq : sediment_dilute ] ) suggests that the ratio of the mass fraction of sugar between the top and bottom of a cell of height @xmath308 will be @xmath309 which is indeed negligible and likely not experimentally measurable .      in this section",
    "we examine the mixed - mode instability illustrated in the bottom row of panels in fig . 1 in ref .",
    "the geometry of the system is a hele - shaw cell , i.e. , two parallel glass plates separated by a narrow gap , as illustrated in the left panel of fig .",
    "[ fig : mmi_setup ] . in our simulation",
    "we model a domain of length @xmath310 , with gravity @xmath275 along the negative @xmath270 direction .",
    "it is well - known that the flow averaged along the @xmath311 axes in a hele - shaw setup can be _ approximated _ with a two - dimensional darcy law ; this is used in the simulations reported in ref .",
    "here we do not rely on any approximations but rather model the actual three - dimensional structure of the flow in all directions .",
    "we divide our domain into @xmath312 cells , and impose periodic boundary conditions in the @xmath200 direction and no - slip walls in the @xmath311 direction . in the y direction , we impose a reservoir ( dirichlet ) boundary conditions for concentration to match the initial concentrations in the top and bottom half of the domain , and impose a free - slip boundary condition on velocity to model an open reservoir of salt solution on the top and sugar solution at the bottom of the domain .",
    "mmi setup leading to a quasi - two - dimensional instability illustrated in fig .",
    "[ fig : mmi_development ] .",
    "( right ) [ fig : dlc_setup]dlc setup leading to a three - dimensional instability illustrated in fig .",
    "[ fig : dlc].,title=\"fig:\",width=192 ] mmi setup leading to a quasi - two - dimensional instability illustrated in fig .",
    "[ fig : mmi_development ] .",
    "( right ) [ fig : dlc_setup]dlc setup leading to a three - dimensional instability illustrated in fig .",
    "[ fig : dlc].,title=\"fig:\",width=192 ]    note that the momentum diffusion time across a domain of length @xmath313 is @xmath314 .",
    "the experimental snapshots in fig . 1 of ref .",
    "@xcite indicate that this is comparable to the time it takes for the instability to fully develop .",
    "it is therefore not safe to rely on the overdamped approximation , so we use the inertial integrator described in ref .",
    "@xcite in our simulations .",
    "nevertheless the overdamped limit is a relatively good approximation in practice since the characteristic length scale of the @xmath315-shaped dlc fingers observed in the experiments is @xmath316 , corresponding to viscous diffusion time @xmath317 .",
    "we have compared numerical simulations using the overdamped and inertial integrators and found little difference .",
    "we simulate the development of the instability to @xmath318 with a fixed time step size of @xmath319 , which corresponds to @xmath320% of the stability limit dictated by our explicit treatment of mass diffusion .",
    "we use a centered discretization of advection ; in these well - resolved simulations little difference is observed between centered advection and the more sophisticated bds advection scheme @xcite summarized in ref .",
    "@xcite .",
    "the initial concentrations , denoted with superscript zero in what follows , on the top and bottom are determined from the dimensionless ratio reported in @xcite , @xmath321 specifically , we set the initial mass fractions of salt and sugar to @xmath322 and @xmath323 respectively , more precisely , @xmath324 which , from the eos gives a density difference of about 0.8% .",
    "similar results are observed for other values of the concentrations if the dimensionless ratio @xmath325 in is kept fixed , with the main difference being that lower concentrations lead to a slower development and growth of the instability .                in the experiments ,",
    "the initial interface between the two solutions is not , of course , perfectly flat . to model this effect ,",
    "it is common in the literature to add a small random perturbation to the initial conditions .",
    "assuming that the growth of the unstable modes is exponential in time , the time it will take for the instability to reach a certain point in its development ( e.g. , to first split the y - shaped fingers ) will depend on the amplitude of the initial perturbation .",
    "since the initial condition is not known to us and is impossible to measure experimentally to high accuracy , it is not possible to directly compare snapshots of the instability at `` the same point in time '' between simulations and experiments , or between simulations that use different initial perturbations .",
    "instead , we compare a simulation in which thermal fluctuations are accounted for with one in which thermal fluctuations are not accounted for , both starting from the _ same _ randomly perturbed initial interface .",
    "specifically , we randomly perturb the concentrations in the layer of cells just above the interface , setting the mass fractions to @xmath326 next to the interface , with @xmath327 being a uniformly distributed random number between @xmath328 and @xmath329 .",
    "as we explained above , a direct comparison between simulations and experiments is not possible",
    ". nevertheless , our numerical results shown in fig .",
    "[ fig : mmi_development ] are very similar , in both time development and visual appearance , to the experimental images shown in the bottom row of panels in fig . 1 in ref .",
    "here we use density @xmath170 as an indicator of the instability even though in actual light scattering or shadowgraph experiments it is the index of refraction rather than density that is observed ; both density and index of refraction are ( approximately ) linear combinations of the concentrations and should behave similarly .",
    "more detailed comparisons between simulations and experiments require a careful coordination of the two and will not be attempted here . instead , we focus our attention on examining the role ( if any ) played by the thermal fluctuations in the triggering and evolution of the instability .    comparing the left and right column of panels in fig . [",
    "fig : mmi_development ] shows only minor differences between the deterministic and the fluctuating hydrodynamics calculation .",
    "this indicates that the dynamics is dominated by the unstable growth of the initial perturbation , with thermal fluctuations adding a weak perturbation , which , though weak , does to some extent affect the details of the patterns formed at late times but not their generic features . by tuning the strength of the initial perturbation one can also tune the impact of the fluctuations on the dynamics ;",
    "after all , if one starts with a perfectly flat interface the instability will be triggered by thermal fluctuations only .",
    "nevertheless , we can conclude that once the instability develops sufficiently ( e.g. , the y - shaped fingers form ) , the dynamics becomes dominated by the deterministic growth of the unstable modes .",
    "this can be seen from the fact that stochastic simulations ( not shown ) starting from a perfectly flat interface develop the same features at long times as deterministic simulations with a random initial perturbation .    to get a more quantitative understanding of the development of the instability , in fig .",
    "[ fig : mmi - early ] we show the fourier spectrum of the density @xmath330 averaged along the @xmath270 and @xmath311 directions , which is a measure of the fluctuations of the diffusive `` interface . '' in these investigations we used a simulation box of size @xmath331 ( grid size @xmath332 cells ) , and set the initial mass fractions to be four times smaller ( note that this does not change the dimensionless number @xmath325 in ) , @xmath333 and @xmath334 , in order to slow down the development of the instability and allow ( giant ) nonequilibrium thermal fluctuations to develop .",
    "the remaining parameters were identical to those reported above .",
    "early time development of a mixed - mode instability instability in a hele - shaw cell .",
    "the spectrum @xmath335 of the density averaged along the vertical direction and the thickness of the sample is shown as a function of wavenumber , at several points in time .",
    "the same random initial perturbation is added to the initial condition ( black solid line ) in all simulations .",
    "a first simulation is deterministic , and clearly shows an unstable ( exponential ) growth for modes with @xmath336 , while larger wavenumbers decay in time . a second simulation accounts for nonequilibrium thermal fluctuations , and displays giant fluctuations in addition to the unstable growth .",
    "at late times nonlinearities trigger all modes to show a nontrivial spectrum , not affected significantly by the thermal fluctuations .",
    "note that the most unstable ( growing ) mode has wavelength of about @xmath337 mm which compares very favorably to the experimentally - reported 1.3 mm @xcite .",
    "a third simulation is in microgravity ( @xmath338 ) and shows a slow development of a stable @xmath284 giant fluctuation spectrum.,scaledwidth=75.0% ]    for a gravitationally - stable configuration , the spectrum of @xmath330 , called the static structure factor @xmath335 , exhibits a characteristic giant fluctuation @xmath284 power - law decay at large wavenumbers @xmath8 at long times @xcite , as illustrated in fig .",
    "[ fig : s_k_giant ] by showing @xmath335 for a simulation in which gravity is switched off . at small wavenumbers , gravity and confinement",
    "damp the amplitude and affect the dynamics of the giant fluctuations , as is well - understood for stable steady states @xcite .",
    "we emphasize that the thermal fluctuations in these investigations are completely dominated by the nonequilibrium ( giant ) fluctuations induced by the presence of large concentration gradients at the interface ; the equilibrium concentration fluctuations are many orders of magnitude weaker in comparison .",
    "this is seen by the fact that we observe identical results if we completely turn off the stochastic mass fluxes , and keep _ only _ the stochastic momentum flux ( velocity fluctuations ) .",
    "similarly , turning off the stochastic momentum flux but keeping the stochastic mass flux , in this particular setup , leads to very small fluctuations that are below the tolerance of our linear solvers .    to our knowledge",
    ", nonequilibrium fluctuations have not been examined in an unstable situation like the one we study here ; some studies have been carried out near the onset of the rayleigh - bernard thermal convection instability @xcite .",
    "it is important to emphasize that the very validity of fluctuating hydrodynamics has _ not _ been established for unstable flows ; one can justify linearized fluctuating hydrodynamics @xcite , but in a linearization the fluctuations do _ not _ affect the deterministic flow and thus can not trigger the instability .",
    "the results in fig . [ fig : mmi - early ] show that in the absence of thermal fluctuations , there is a clear band of wavenumbers @xmath336 whose amplitude grows in time due to the instability , while the remaining modes decay to zero rapidly .",
    "it is important to note that the most unstable wavelength of @xmath339 cm is very close to the experimentally reported value of @xmath340 cm @xcite .",
    "when thermal fluctuations are present , the same band of wavenumbers grows in a similar manner , but at the same time , larger wavenumbers show a nontrivial power - law spectrum .",
    "eventually , however , the unstable modes completely dominate the dynamics and there is essentially no difference between the simulations with and without thermal fluctuations ; to make a more precise quantitative statement multiple monte carlo simulations are required to perform ensemble averages and reduce the statistical error , as well as to eliminate the effects of the boundary conditions along the horizontal and vertical directions .",
    "note that at later times the fluid flow becomes chaotic and further information may be gained by also examining the spectrum of the fluid velocity and not just the vertical projection of the density ; we leave such detailed investigations for future studies .      in this section",
    "we use our algorithm to model a hypothetical experiment in which the gravity points in the direction perpendicular to the fluid - fluid interface and do the confining glass slips , as illustrated in the right panel of fig .",
    "[ fig : dlc_setup ] .",
    "this kind of geometry has already been used to experimentally investigate isothermal free diffusive mixing in a _ binary _",
    "liquid mixture @xcite in a _",
    "stable _ configuration . to our knowledge",
    ", similar experiments have not been performed for ternary mixtures , although it is feasible they could be if the initial configuration can be prepared with sufficient control .    to be specific ,",
    "we select the initial concentrations of the sugar and salt solutions to get a diffusive layer convection ( dlc ) instability ; all other parameters are the same as for the mmi setup summarized above .",
    "the dimensionless parameter used for fig .",
    "1(c ) in ref .",
    "@xcite is @xmath341 giving the required ratio of mass fractions , @xmath342 we set @xmath343 and @xmath344 , which gives an initial density of 1.014375 on the top and 1.018062 on the bottom , for a density difference of about -0.4% ( recall that the sign of the difference is opposite for dlc and mmi configurations ) .",
    "the dimensions of the domain in our simulations are @xmath345 , with periodic boundary conditions in @xmath200 and @xmath311 , and reservoir ( dirichlet ) boundary condition for concentration together with free - slip boundary condition on velocity in the @xmath270 direction .",
    "the grid is @xmath346 grid cells , and the time step size is fixed at @xmath347 , which corresponds to a maximum advective courant number of @xmath348 .",
    "we treat advection using the unlimited bilinear bds high - resolution scheme @xcite summarized in ref .",
    "the initial interface is now perfectly flat , so that the instability is triggered by the nonequilibrium ( giant ) thermal fluctuations .",
    "we focus our investigation here on the differences in the spectrum of the thermal fluctuations with ( unstable ) and without ( marginally stable ) gravity .",
    "note that experimental measurements of giant concentration fluctuations in microgravity are feasible and have been performed for binary liquid mixtures @xcite ; microgravity measurements on ternary mixtures are ongoing or in the planning stage @xcite .",
    "development of a fully three - dimensional diffusive layer convection ( dlc ) instability as a layer of less - dense salty water is placed on top of a horizontal layer of denser sweet water .",
    "the color plots show the vertically averaged density @xmath170 ( horizontal planes ) and planar slices of @xmath170 ( vertical planes ) .",
    "the left panels correspond to time @xmath349 since the initial contact between the miscible liquids , and the right panels correspond to @xmath350 .",
    "the top row of panels is for a flat initial interface driven unstable by thermal fluctuations in the presence of gravity , and the bottom row is in microgravity ( @xmath338).,title=\"fig:\",width=288 ] development of a fully three - dimensional diffusive layer convection ( dlc ) instability as a layer of less - dense salty water is placed on top of a horizontal layer of denser sweet water .",
    "the color plots show the vertically averaged density @xmath170 ( horizontal planes ) and planar slices of @xmath170 ( vertical planes ) .",
    "the left panels correspond to time @xmath349 since the initial contact between the miscible liquids , and the right panels correspond to @xmath350 .",
    "the top row of panels is for a flat initial interface driven unstable by thermal fluctuations in the presence of gravity , and the bottom row is in microgravity ( @xmath338).,title=\"fig:\",width=288 ]    development of a fully three - dimensional diffusive layer convection ( dlc ) instability as a layer of less - dense salty water is placed on top of a horizontal layer of denser sweet water .",
    "the color plots show the vertically averaged density @xmath170 ( horizontal planes ) and planar slices of @xmath170 ( vertical planes ) .",
    "the left panels correspond to time @xmath349 since the initial contact between the miscible liquids , and the right panels correspond to @xmath350 .",
    "the top row of panels is for a flat initial interface driven unstable by thermal fluctuations in the presence of gravity , and the bottom row is in microgravity ( @xmath338).,title=\"fig:\",width=288 ] development of a fully three - dimensional diffusive layer convection ( dlc ) instability as a layer of less - dense salty water is placed on top of a horizontal layer of denser sweet water .",
    "the color plots show the vertically averaged density @xmath170 ( horizontal planes ) and planar slices of @xmath170 ( vertical planes ) .",
    "the left panels correspond to time @xmath349 since the initial contact between the miscible liquids , and the right panels correspond to @xmath350 .",
    "the top row of panels is for a flat initial interface driven unstable by thermal fluctuations in the presence of gravity , and the bottom row is in microgravity ( @xmath338).,title=\"fig:\",width=288 ]    in this geometry , the interface between the two fluids can not be visualized , rather , one sees the average index of refraction ( a linear combination of the average concentrations ) along the thickness of the sample ( direction of the gradient and of gravity ) . in fig .",
    "[ fig : dlc ] we show color plots for the vertically - averaged density at two points in time , one as the instability is just beginning to dominate the dynamics , and the other as the instability has fully developed . in the presence of gravity , at early times",
    "there are pronounced giant thermal fluctuations in addition to the fluctuations coming from the growth of the unstable modes , which dominate the dynamics at late times similarly to the mmi case in fig .",
    "[ fig : mmi_development ] .",
    "the giant nonequilibrium fluctuations are more clearly visualized by considering stable free diffusive mixing in microgravity ( @xmath351 bottom panels ) .    in fig .",
    "[ fig : dlc_early ] , we show the radially - averaged power spectrum @xmath352 corresponding to the vertically - averaged density @xmath353 .",
    "behavior similar to the mmi instability shown in fig .",
    "[ fig : mmi_development ] is observed .",
    "the band of wavenumbers between @xmath354 is seen to grow in time , and the characteristic @xmath284 giant fluctuation spectrum is seen at large wavenumbers , especially clear in the results for microgravity .",
    "deterministic simulations ( not shown ) starting from a randomly - perturbed interface show similar unstable growth and are eventually indistinguishable from simulations in which the instability is triggered and enhanced by thermal fluctuations .    radially averaged spectrum @xmath335 of the vertically - averaged density shown in the four panels in fig .",
    "[ fig : dlc ] . in earth gravity ( @xmath355 )",
    ", the most unstable ( growing ) mode is seen to have a wavelength of about @xmath356 cm , but there is in fact a rather broad range of wavenumbers that are unstable . in microgravity ( @xmath338 )",
    "the deterministic state is stable but the fluctuations grow to be `` giant '' with a characteristic @xmath284 power spectrum.,scaledwidth=50.0% ]    we defer detailed studies of these phenomena for future work , in the hope that our work will stimulate careful experimental investigations that can directly be compared to our computer simulations . by adjusting the initial concentrations and the choice of the two solutes one can change the range of unstable wavenumbers and the time scale for the development of the instability ; this is best done by performing a linear stability analysis @xcite . it is feasible that for some choice of parameters a more substantial interaction between the spectrum at large wavenumbers , dominated by giant fluctuations , and the spectrum at small wavenumbers , dominated by the instability , will occur .",
    "if this is the case one may be able to observe a measurable influence of nonequilibrium concentration fluctuations on the development and grown of the instability , allowing us , for the first time , to experimentally access the validity of nonequilibrium _ nonlinear _ fluctuating hydrodynamics .",
    "we have developed a low mach number fluctuating hydrodynamics formulation of momentum and mass transport in non - ideal mixtures of incompressible liquids with given pure - component densities . in the present low mach number model energy transport",
    "is not modeled explicitly and the temperature is assumed constant in time .",
    "momentum transport is accounted for in a quasi - incompressible framework in which pressure is in mechanical ( hydrostatic ) equilibrium and fast sound waves are eliminated from the system of equations because density instantaneously follows the local composition .",
    "the thermodynamics of the mixture is described by the hessian of the normalized excess gibbs energy per particle .",
    "the transport properties are given by the shear viscosity , the maxwell - stefan diffusion coefficients , and the thermal diffusion coefficients or ratios , as a function of the composition of the mixture .",
    "we used our low mach number algorithm to study the development of gravitational instabilities during diffusive mixing in ternary mixtures .",
    "these mixed mode and diffusive convection instabilities are specific to mixtures of more than two species and occur because of an interaction between the familiar buoyancy - driven rayleigh - taylor instability with differential diffusion effects .",
    "our simulations of the mixed - mode instability closely mimic recent experiments @xcite performed in a hele - shaw setup , and we found good qualitative agreement between experimental and computational results .",
    "a more quantitative comparison is not possible at this stage and should be the subject of future work .",
    "a particularly challenging aspect is to experimentally control or measure the initial conditions with sufficient accuracy to be able to directly compare simulations to experiments .    because of the presence of sharp gradients at the interface between the two diffusively mixing solutions , giant concentration fluctuations develop in the form of power - law tails in the spectrum of the concentration fluctuations .",
    "these nonequilibrium fluctuations are much larger than equilibrium ones and have the potential to trigger and feed the instability and affect the growth of the unstable structures .",
    "it is important to observe that such a coupling of the fluctuations back to the macroscopic dynamics requires nonlinearity , and is not possible in linearized fluctuating hydrodynamics . while some nonlinear effects in fluctuating hydrodynamics have been verified to occur in real liquids , it is not clear whether our nonlinear fluctuating hydrodynamic simulations can account for the effect of the fluctuations on the evolution of the mean flow .",
    "in particular , the nonlinear fluctuating hydrodynamic equations are ill - posed and some regularization , implicit in our finite - volume discretization , is required to even give meaning to the equations @xcite .",
    "the conclusions of the simulations performed here is that fluctuations , despite being `` giant '' , are quickly overwhelmed by the deterministic growth of the unstable modes .",
    "this suggests that in actual experiments the development of the instability is primarily triggered by the imperfections in the initial condition or external fluctuations ( e.g. , vibrations ) .    in the hele - shaw geometry studied experimentally in @xcite , the no - slip boundaries strongly damp the velocity fluctuations and reduce the giant fluctuations .",
    "furthermore , the quasi - two dimensional geometry limits the possibilities for interactions between the fluctuations and the instability . for this reason , we also reported simulations of diffusive layer convection for a three - dimensional geometry , as used in existing experiments in binary mixtures . because giant fluctuations develop on a slow diffusive time scale for large and intermediate wavenumbers , it takes some time after the initial contact between the two fluids for the power - law spectrum to develop . at the same time , the unstable smaller wavenumbers have an exponentially - growing amplitude , so that the instability can develop much faster than the giant fluctuations . in our simulations we reduced the concentrations of solutes to make the density difference very small and",
    "thus slow down the unstable growth ; it remains to be seen what is possible and can be observed experimentally .",
    "an important challenge for experimental physicists is to devise ways to measure the thermophysical properties in multispecies mixtures @xcite .",
    "while our formulation can handle mixtures of arbitrary numbers of species with essentially complete physical fidelity , it is not possible to use our codes for realistic non - dilute mixtures because many of the parameters , notably the thermodynamic factors and the maxwell - stefan diffusion coefficients , are missing .",
    "we believe that it will be necessary to use computer simulations using the types of methods described here , together with monte carlo sampling of parameters , and potentially also molecular dynamics calculations @xcite , _ in addition _ to experimental measurement of observation functions , in order to obtain robust estimates of thermophysical parameters with a quantified uncertainty .",
    "the traditional approach of tabulating values with error bars , that has worked for binary mixtures , fails for multispecies mixtures due to proliferation of a larger number of parameters that are not all independent but are constrained by thermodynamic symmetries and stability conditions .    in future work",
    ", we will consider the inclusion of chemical reactions in our low mach number models .",
    "it is also possible to include thermal effects in our formulation by accounting for the effects of thermal expansion in the quasi - incompressibility constraint .",
    "two key difficulties are constructing a spatial discretization that ensures preservation of an appropriately generalized eos , as well as developing suitable temporal integrators that can handle the multitude of time scales that appear due the presence of slow mass , fast momentum , and intermediate energy diffusion , and , potentially , ultrafast chemical reactions .",
    "another challenge for future work on low mach number fluctuating hydrodynamics is to account for the effects of surface tension in mixtures of immiscible or partially miscible liquids . while some thermodynamically - consistent constructions of diffuse - interface models exist for ternary mixtures @xcite , we believe that much more work is required to formulate a complete multispecies system of equations in the presence of square - gradient terms in the free energy functional , even in the isothermal setting .",
    "we would like to thank anne de wit and jorge carballido landeira for numerous discussions regarding their experiments on gravitational instabilities in ternary mixtures .",
    "this material is based upon work supported by the u.s .",
    "department of energy office of science , office of advanced scientific computing research , applied mathematics program under award number de - sc0008271 and under contract no . de - ac02 - 05ch11231 .",
    "an essential complication with treating all species equally , is that the @xmath0 mass or mole fractions are not all independent but must sum to unity .",
    "for example , the equations ( [ eq : d_eq ] ) are not independent , and one must supplement them with the condition that the total mass flux is zero . similarly , the rows and columns of @xmath126 sum to zero , @xmath357 where @xmath15 denotes a vector of ones , and therefore @xmath126 is not invertible ; the range of @xmath126 are vectors that sum to zero . to deal with these complications ,",
    "let us now introduce the projection matrix @xcite @xmath358 which satisfies @xmath359 ; therefore , pre - multiplying a matrix by @xmath360 ensures that the matrix has a range consisting of vectors that sum to zero , and post - multiplying by @xmath360 ensures that the matrix has @xmath361 in its null - space .",
    "now , let us define a diffusion matrix as @xmath362^{-1}\\m q^{t},\\label{eq : chi_def}\\ ] ] where @xmath363 is an arbitrary constant , for example , @xmath139 ; an alternative equivalent formula is ( [ eq : lambda_to_chi ] ) .    here is a quick summary of some useful relations derived in @xcite :    1 .",
    "@xmath357 and @xmath126 is symmetric positive ( semi)definite ( spd ) on @xmath364 .",
    "2 .   @xmath365 and @xmath136 is spd on @xmath366 .",
    "@xmath136 and @xmath126 are generalized inverses of each other , @xmath367 and @xmath368 , more specifically , @xmath369 and @xmath370 .",
    "the spd matrices @xmath371 are inverses of each other , and @xmath372 on the subspace @xmath366 and @xmath373 on the subspace @xmath364 .    in order to numerically compute @xmath136 from @xmath126 , one could use a matrix inverse , as in ( [ eq : lambda_to_chi ] ) .",
    "this fails , however , when some of the species vanish since the matrix @xmath374 is not invertible ; this can be fixed by using a pseudoinverse , computed via the singular value decomposition ( svd ) of @xmath126 .",
    "however , both matrix inversion and svd involve @xmath375 operations and can be expensive for large numbers of species .",
    "an alternative is to use an iterative numerical procedure @xcite @xmath376\\m q\\m m^{-1}\\m q^{t},\\label{eq : chi_iterative}\\ ] ] where @xmath377 , and @xmath378 is a diagonal matrix with entries @xmath379 the sum converges rapidly so only a few terms in the sum are needed to compute @xmath380 without having to do matrix inverses , but the speed of convergence is hard to access _ a priori _ and in practice we set @xmath381 to a fixed integer such as @xmath382 or @xmath383 .",
    "it is important to note that , as proven in @xcite , the truncated sum to @xmath381 terms gives an approximation @xmath384 that is symmetric positive semi - definite , and satisfies the properties @xmath385 as it must .",
    "it is therefore perfectly consistent with thermodynamics to just approximate @xmath136 with @xmath380 .",
    "after all , since the maxwell - stefan diffusion coefficients are only known to at most two decimal places in practice , it makes little sense to invert @xmath126 exactly or compute its ( expensive ) svd . instead",
    ", @xmath380 for small @xmath381 is in practice an equally good approximation to the true diffusion matrix .",
    "barodiffusion is often neglected for liquid mixtures since its contribution to the diffusive fluxes is typically negligible compared to those due to compositional or temperature gradients , unless there are very large pressure gradients due to large accelerations , as in ultracentrifuges . nevertheless , including barodiffusion is crucial in order to obtain the correct equilibrium steady state of a mixture in the presence of gravity .",
    "this is a direct consequence of the fact that barodiffusion has thermodynamic origin . if barodiffusion is neglected , at thermodynamic equilibrium the mixture would mix uniformly even in the presence of gravity , reaching the state of maximal entropy",
    "however , physically , we know that heavier species will migrate toward the bottom , minimizing the free energy by balancing the gain in potential energy with the loss of entropy . here we show that once barodiffusion is accounted for the hydrodynamic equations correctly reproduce the statistical mechanics of systems in a gravitational field .    as a simple case in which we know the `` correct '' answer , let us focus on the case when the mixture is a dilute suspension of a number of solutes such as colloids or a macromolecule ( e.g. , solution of sugar in water ) . in the dilute limit",
    ", the different solutes do not affect each other , and we can , in fact , focus on one of the solutes only and consider a binary solution .",
    "let us take the first species to be the solute and the second species to be the solvent .",
    "for a dilute solution , @xmath386 , @xmath387 , @xmath388 , @xmath389 , giving @xmath390 and @xmath391 . note that hydrostatic equilibrium is built into the low mach number equations through the reference pressure , which satisfies @xmath392 , where @xmath393 is the height .",
    "thermodynamic equilibrium , i.e. , a vanishing of the chemical potential gradients , corresponds to a vanishing of the diffusion driving force for the solute , @xmath394 which directly gives the gravitational sedimentation profile of an ideal gas with molecular mass @xmath395 , @xmath396 where @xmath395 is the excess mass of the colloids over that of the fluid , @xmath397 the result is in agreement with the statistical - mechanical notion that the solute subsystem can be thought of as an ideal gas of particles subject to the archimedean gravity force @xmath398 .",
    "a similar calculation for the case of thermodiffusion gives @xmath399 which is similar in form but does not have an origin in equilibrium statistical mechanics .",
    "in this appendix , we show that thermal fluctuations can be directly added to the maxwell - stefan formulation in a manner that is intuitive and consistent with the one we presented here , derived from the principles of nonequilibrium thermodynamics .    in the maxwell - stefan description of diffusion ,",
    "one considers a frictional force between species @xmath46 and @xmath162 proportional to the difference in the particular velocities of the two species , with friction coefficient @xmath400 .",
    "it is natural to include thermal fluctuations in this description by including a fluctuating component to the frictional force with covariance proportional to @xmath401 , following the traditional langevin approach .",
    "this leads us to the ms equation with fluctuations , @xmath402,\\label{eq : d_sm - k - fluct}\\ ] ] where @xmath403 are space - time white - noise processes , one process per pair of species , for a total of @xmath404 random forces .",
    "from the above we may augment to account for fluctuations as @xmath405 where @xmath153 is a vector of @xmath404 independent white noise processes and @xmath406 is a matrix that can directly be read from . following the same linear algebra steps as before , we can solve for the fluxes to obtain the additional fluctuating contribution @xmath407 the covariance of this stochastic flux is @xmath408 it can be shown that @xmath409 , which shows that the covariance @xmath410 is proportional to the onsager matrix , and therefore the stochastic mass fluxes obtained from the fluctuating ms description are statistically identical to .",
    "this justifies the prefactor @xmath411 in the noise in ; one can also justify this factor based on kinetic theory considerations .    in this fluctuating ms description the stochastic mass flux is constructed explicitly without using cholesky factorization of the onsager matrix .",
    "that is , this construction gives a `` square root '' of the onsager matrix as an explicit construct , @xmath412 which is different from .",
    "note , however , that this formulation requires using @xmath404 random processes instead of only @xmath1 random processes required when is used ; this increase in the number of random numbers is typically not justified by the savings of a cholesky factorization .",
    "in this secton we compute the equilibrium static and dynamic structure factors for a mixture at equilibrium . in",
    "linearized fluctuating hydrodynamics the coupling between the mass ( concentration ) equations and the velocity equation disappears at equilibrium , and we can focus our attention on the mass equations .",
    "when is linearized around a uniform state at thermodynamic equilibrium , we can omit the advective term @xmath413 , and we can treat density as constant .    since we want to compute fluctuations in the mass fractions , we first convert to use gradients of mass fractions instead of gradients of mole fractions , by using the chain rule @xmath414 the symmetric hessian matrix @xmath415 can be related to @xmath416 using ( [ eq : gamma],[eq : gamma_f],[eq : dx_dw ] ) , @xmath417\\m w^{-1}.\\ ] ] we can therefore write the mass flux due to composition gradients in terms of mass fraction gradients as @xmath418 where @xmath419\\m w^{-1}.\\ ] ]    at thermodynamic equilibrium , the fluctuating diffusion equation ( [ eq : species_eq ] ) can be expressed entirely in terms of the fluctuations of mass fractions by using ( [ eq : f_comp_w ] ) , @xmath420 where @xmath421 . after taking a fourier transform ( [ eq : ou_w ] ) becomes a multi - dimensional orstein - uhlenbeck ( ou ) equation , one system of @xmath0 equations for each wavenumber .",
    "the dynamic structure factor is @xmath422    a standard result for ou processes @xcite states that at steady state the covariances satisfy the linear system of equations @xmath423 this equation needs to be supplemented by the conditions that the static structure factor @xmath424 is symmetric , and that the row and column sums of @xmath425 are zero because the mass fractions sum to one , @xmath426 this system of two equations for @xmath425 has a unique solution ; after some algebraic manipulations the solution can be written in the evidently symmetric form . for ideal mixtures @xmath242 and",
    "can be simplified to @xmath427 which matches the corresponding expression for a mixture of ideal gases @xcite .    in actual experiments , what can be measured through dynamic light scattering or shadowgraphy",
    "is the spectrum of refractive index @xmath428 .",
    "a related quantity is the density structure factor @xmath429 , which can easily be obtained from @xmath425 in the low mach setting as follows .",
    "first , observe that in the low mach number limit , density fluctuations do not include the contribution from pressure fluctuations ( sound peaks in the static structure factor ) , rather , they only include a contribution due to fluctuations in mass fractions ( central peak ) @xcite",
    ". physically this corresponds to observing density fluctuations at a longer time scale , i.e. , averaging over the fast pressure fluctuations on the sonic time scale . if we expand the eos constraint to account for small thermal fluctuations , @xmath430 and @xmath431 , we get @xmath432 giving the density fluctuations @xmath433 from this relation we can derive all properties of the density fluctuations , such as static and dynamic structure factors , from the corresponding values for the mass fractions .",
    "for example , the dynamic or static structure factor of density can be obtained from the corresponding result for the mass fractions via .",
    "valentina shevtsova , cecilia santos , vitaliy sechenyh , jean  claude legros , and aliaksandr mialdun . diffusion and soret in ternary mixtures .",
    "preparation of the dcmix2 experiment on the iss .",
    ", 25(5):275283 , 2014 .",
    "jorge carballido - landeira , philip  mj trevelyan , christophe almarcha , and anne de  wit . mixed - mode instability of a miscible interface due to coupling between rayleigh - taylor and double - diffusive convective modes . , 25(2):024107 , 2013 .",
    "andr bardow , ernesto kriesten , mihai  adrian voda , federico casanova , bernhard blmich , and wolfgang marquardt .",
    "prediction of multicomponent mutual diffusion in liquids : model discrimination using nmr data .",
    ", 278(1):2735 , 2009 .",
    "xin liu , ana martn - calvo , erin mcgarrity , sondre  k schnell , sofa calero , jean - marc simon , dick bedeaux , signe kjelstrup , andre bardow , and thijs  jh vlugt .",
    "fick diffusion coefficients in ternary liquid systems from equilibrium molecular dynamics simulations .",
    ", 51(30):1024710258 , 2012 .",
    "xin liu , sondre  k schnell , jean - marc simon , dick bedeaux , signe kjelstrup , andre bardow , and thijs  jh vlugt .",
    "correction to fick diffusion coefficients of liquid mixtures directly obtained from equilibrium molecular dynamics .",
    ", 116(20):60706070 , 2012 .",
    "sondre  k schnell , xin liu , jean - marc simon , andre bardow , dick bedeaux , thijs  jh vlugt , and signe kjelstrup . calculating thermodynamic properties from fluctuations at small scales . , 115(37):1091110918 , 2011 .",
    "giambattista giacomin , joel  l lebowitz , and errico presutti .",
    "deterministic and stochastic hydrodynamic equations arising from simple microscopic model systems . in _",
    "stochastic partial differential equations : six perspectives _ , number  64 in mathematical surveys and monographs , page 107 .",
    "american mathematical soc ."
  ],
  "abstract_text": [
    "<S> we develop a low mach number formulation of the hydrodynamic equations describing transport of mass and momentum in a multispecies mixture of incompressible miscible liquids at specified temperature and pressure that generalizes our prior work on ideal mixtures of ideal gases [ _ _ k . </S>",
    "<S> balakrishnan , a. l. garcia , a. donev and j. b. bell , phys . </S>",
    "<S> rev . </S>",
    "<S> e 89:013017 , 2014 _ _ ] and binary liquid mixtures [ _ _ a . </S>",
    "<S> donev , a. j. nonaka , y. sun , t. g. fai , a. l. garcia and j. b. bell , camcos , 9 - 1:47 - 105 , 2014 _ _ ] . in this formulation </S>",
    "<S> we combine and extend a number of existing descriptions of multispecies transport available in the literature . </S>",
    "<S> the formulation applies to non - ideal mixtures of arbitrary number of species , without the need to single out a `` solvent '' species , and includes contributions to the diffusive mass flux due to gradients of composition , temperature and pressure . momentum transport and advective mass transport are handled using a low mach number approach that eliminates fast sound waves ( pressure fluctuations ) from the full compressible system of equations and leads to a quasi - incompressible formulation . </S>",
    "<S> thermal fluctuations are included in our fluctuating hydrodynamics description following the principles of nonequilibrium thermodynamics . </S>",
    "<S> we extend the semi - implicit staggered - grid finite - volume numerical method developed in our prior work on binary liquid mixtures [ _ _ a . </S>",
    "<S> j. nonaka , y. sun , j. b. bell and a. donev , 2014 , arxiv:1410.2300 _ _ ] , and use it to study the development of giant nonequilibrium concentration fluctuations in a ternary mixture subjected to a steady concentration gradient . </S>",
    "<S> we also numerically study the development of diffusion - driven gravitational instabilities in a ternary mixture , and compare our numerical results to recent experimental measurements [ _ _ j . </S>",
    "<S> carballido - landeira , p. m.j . </S>",
    "<S> trevelyan , c. almarcha and a. de wit , physics of fluids , 25:024107 , 2013 _ _ ] in a hele - shaw cell . </S>",
    "<S> we find that giant nonequilibrium fluctuations can trigger the instability but are eventually dominated by the deterministic growth of the unstable mode , in both quasi two - dimensional ( hele - shaw ) , and fully three - dimensional geometries used in typical shadowgraph experiments .    </S>",
    "<S> # 1 # 1 # 1    # 1#1 # 1#1    # 1#1 # 1|#1|    # 1#1 # 1#1 </S>"
  ]
}