{
  "article_text": [
    "estimating 3d face shape from one or more 2d images is a longstanding problem in computer vision .",
    "it has a wide range of applications from pose - invariant face recognition @xcite to creation of 3d avatars from 2d images @xcite .",
    "one of the most successful approaches to this problem is to use a statistical model of 3d face shape @xcite .",
    "this transforms the problem of shape estimation to one of model fitting and provides a strong statistical prior to constrain the problem .",
    "the model fitting objective can be formulated in various ways , the most obvious being an analysis - by - synthesis approach in which appearance error is directly optimised @xcite . however , feature - based methods @xcite are in general more robust and lead to optimisation problems less prone to convergence on local minima . in this paper , we focus on fitting to edge features in images .",
    "image edges convey important information about a face .",
    "the occluding boundary provides direct information about 3d shape , for example a profile view reveals strong information about the shape of the nose .",
    "internal edges , caused by texture changes , high curvature or self occlusion , provide information about the position and shape of features such as lips , eyebrows and the nose .",
    "this information provides a cue for estimating 3d face shape from 2d images or , more generally , for fitting face models to images .    in section [ sec : prelim ]",
    "we introduce relevant background . in section",
    "[ sec : fitting ] we present a method for fitting to landmarks with known model correspondence .",
    "our key contribution is in section [ sec : hard ] where we present a novel , fully automatic algorithm for fitting to image edges with hard correspondence . by hard correspondence , we mean that an explicit correspondence is computed between projected model vertex and edge pixel . for comparison , in section [ sec : soft ]",
    "we describe our variant of previous methods @xcite that fit to edges using soft correspondence . by soft correspondence ,",
    "we mean that an energy term that captures many possible edge correspondences is minimised . finally , we compare the two approaches experimentally and others from the recent literature in section [ sec : exp ] .",
    "* landmark fitting *   2d landmarks have long been used as a way to initialize a morphable model fit  @xcite .",
    "breuer  et al .",
    "@xcite obtained this initialisation using a landmark detector providing a fully automatic system .",
    "more recently , landmarks have been shown to be sufficient for obtaining useful shape estimates in their own right  @xcite .",
    "furthermore , noisily detected landmarks can be filtered using a model  @xcite and automatic landmark detection can be integrated into a fitting algorithm  @xcite . in a similar manner to landmarks ,",
    "local features can be used to aid the fitting process  @xcite .",
    "* edge fitting *   an early example of using image edges for face model fitting is the active shape model ( asm ) @xcite where a 2d boundary model is aligned to image edges . in 3d , contours have been used directly for 3d face shape estimation @xcite and indirectly as a feature for fitting a 3dmm .",
    "the earliest work in this direction was due to moghaddam  et al .",
    "@xcite who fitted a 3dmm to silhouettes extracted from multiple views . from a theoretical standpoint , lthi  et al .",
    "@xcite explored to what degree face shape is constrained when contours are fixed .",
    "romdhani  et al .",
    "@xcite include an edge distance cost as part of a hybrid energy function .",
    "texture and outer ( silhouette ) contours are used in a similar way to lm - icp @xcite where correspondence between image edges and model contours is `` soft '' .",
    "this is achieved by applying a distance transform to an edge image .",
    "this provides a smoothly varying cost surface whose value at a pixel indicates the distance ( and its gradient , the direction ) to the closest edge .",
    "this idea was extended by amberg  et al .",
    "@xcite who use it in a multi - view setting and smooth the edge distance cost by averaging results with different parameters . in this way",
    ", the cost surface also encodes the saliency of an edge .",
    "keller  et al .",
    "@xcite showed that such approaches lead to a cost function that is neither continuous nor differentiable .",
    "this suggests the optimisation method must be carefully chosen .",
    "edge features have also been used in other ways .",
    "cashman and fitzgibbon @xcite learn a 3dmm from 2d images by fitting to silhouettes .",
    "zhu et al .",
    "@xcite present a method that can be seen as a hybrid of landmark and edge fitting .",
    "landmarks that define boundaries are allowed to slide over the 3d face surface during fitting . a recent alternative to optimisation - based approaches",
    "is to learn a regressor from extracted face contours to 3dmm shape parameters @xcite .",
    "fitting a 3dmm to a 2d image using only geometric features ( i.e. landmarks and edges ) is essentially a non - rigid alignment problem .",
    "surprisingly , the idea of employing an iterated closest point @xcite approach with hard edge correspondences ( in a similar manner to asm fitting ) has been discounted in the literature @xcite . in this paper , we pursue this idea and develop an iterative 3dmm fitting algorithm that is fully automatic , simple and efficient ( and we make our implementation available ] ) . instead of working in a transformed distance - to - edge space and treating correspondences as `` soft '' , we compute an explicit correspondence between model and image edges .",
    "this allows us to treat the model edge vertices as a landmark with known 2d position , for which optimal pose or shape estimates can be easily computed .",
    "* state of the art *   the most recent face shape estimation methods are able to obtain considerably higher quality results than the purely model - based approaches above .",
    "they do so by using pixel - wise shading or motion information to apply finescale refinement to an initial shape estimate . for example , suwajanakorn et al .",
    "@xcite use photo collections to build an average model of an individual which is then fitted to a video and finescale detail added by optical flow and shape - from - shading .",
    "cao et al .",
    "@xcite take a machine learning approach and train a regressor that predicts high resolution shape detail from local appearance .",
    "our aim in this paper is not to compete directly with these methods .",
    "rather , we seek to understand what quality of face reconstruction it is possible to obtain using solely sparse , geometric information . the output of our method may provide a better initialisation for state of the art refinement techniques or remove the need to have a person specific model .",
    "our approach is based on fitting a 3dmm to face images under the assumption of a scaled orthographic projection .",
    "hence , we begin by introducing scaled orthographic projection and 3dmms .",
    "the scaled orthographic , or weak perspective , projection model assumes that variation in depth over the object is small relative to the mean distance from camera to object . under this assumption ,",
    "the projected 2d position of a 3d point @xmath0^{\\textrm{t}}$ ] given by @xmath1 \\in \\mathbb{r}^2 $ ] does not depend on the distance of the point from the camera , but only on a uniform scale @xmath2 given by the ratio of the focal length of the camera and the mean distance from camera to object :    @xmath3 = s\\left [   \\begin{array}{ccc }   1 & 0 & 0 \\\\   0 & 1 & 0 \\end{array}\\right ]    { \\bf rv}+s{\\bf t}\\ ] ]    where the pose parameters @xmath4 , @xmath5 and @xmath6 are a rotation matrix , 2d translation and scale respectively .      a 3d morphable model is a deformable mesh whose shape is determined by the shape parameters @xmath7 .",
    "shape is described by a linear model learnt from data using principal components analysis ( pca ) .",
    "so , the shape of any face can be approximated as : @xmath8 where @xmath9 contains the @xmath10 principal components , @xmath11 is the mean shape and the vector @xmath12 contains the coordinates of the @xmath13 vertices , stacked to form a long vector : @xmath14^{\\textrm{t}}$ ] .",
    "hence , the @xmath15th vertex is given by : @xmath16^{\\textrm{t}}$ ] .",
    "for convenience , we denote the sub - matrix corresponding to the @xmath15th vertex as @xmath17 and the corresponding vertex in the mean face shape as @xmath18 , such that the @xmath15th vertex is given by : @xmath19 similarly , we define the row corresponding to the @xmath20 component of the @xmath15th vertex as @xmath21 ( similarly for @xmath22 and @xmath23 ) and define the @xmath20 component of the @xmath15th mean shape vertex as @xmath24 ( similarly for @xmath22 and @xmath23 ) .",
    "we begin by showing how to fit a morphable model to @xmath25 observed 2d positions @xmath26^{\\textrm{t}}$ ] ( @xmath27 ) arising from the projection of corresponding vertices in the morphable model .",
    "we discuss in section [ sec : hard ] how these correspondences are obtained in practice . without loss of generality , we assume that the @xmath15th 2d position corresponds to the @xmath15th vertex in the morphable model .",
    "the objective of fitting a morphable model to these observations is to obtain the shape and pose parameters that minimise the reprojection error , @xmath28 , between observed and predicted 2d positions : @xmath29 \\|^2.\\label{eqn : reprojerr}\\ ] ] the scale factor in front of the summation makes the magnitude of the error invariant to the number of landmarks .",
    "this problem is multilinear in the shape parameters and the sop transformation matrix .",
    "it is also nonlinearly constrained , since @xmath30 must be a valid rotation matrix .",
    "although minimising @xmath28 is a non - convex optimisation problem , a good initialisation can be obtained using alternating linear least squares and this estimate subsequently refined using nonlinear optimisation .",
    "this is the approach that we take .",
    "we make an initial estimate of @xmath30 , @xmath31 and @xmath2 using a simple extension of the pos algorithm @xcite .",
    "compared to pos , we additionally enforce that @xmath30 is a valid rotation matrix .",
    "we begin by solving an unconstrained system in a least squares sense .",
    "we stack two copies of the 3d points in homogeneous coordinates , such that @xmath32 $ ] and @xmath33 $ ] and form a long vector of the corresponding 2d points @xmath34^{\\textrm{t}}$ ] .",
    "we then solve for @xmath35 in @xmath36 using linear least squares .",
    "we define @xmath37 $ ] and @xmath38 $ ] .",
    "scale is given by @xmath39 and the translation vector by @xmath40^{\\textrm{t}}$ ] .",
    "we perform singular value decomposition on the matrix formed from @xmath41 and @xmath42 : @xmath43\\ ] ] the rotation matrix is given by @xmath44 .",
    "if @xmath45 then we negate the third row of @xmath46 and recompute @xmath30 .",
    "this guarantees that @xmath30 is a valid rotation matrix .",
    "this approach gives a good initial estimate which we subsequently refine with nonlinear optimization of @xmath28 with respect to @xmath30 , @xmath31 and @xmath2 .      with a fixed pose estimate , shape parameter estimation under scaled orthographic projection",
    "is a linear problem .",
    "the 2d position of the @xmath15th vertex as a function of the shape parameters is given by : @xmath47 hence , each observed vertex adds two equations to a linear system .",
    "concretely , for each image we form the matrix @xmath48 where @xmath49 and @xmath50 and vector @xmath51 where @xmath52 we solve @xmath53 in a least squares sense subject to an additional constraint to ensure plausibility of the solution .",
    "we follow brunton et al .",
    "@xcite and use a hyperbox constraint on the shape parameters .",
    "this avoids having to choose a regularisation weight but ensures that each parameter lies within @xmath54 standard deviations of the mean by introducing a linear inequality constraint on the shape parameters ( we use @xmath55 in our experiments ) .",
    "hence , the problem can be solved in closed form as an inequality constrained linear least squares problem .",
    "having alternated pose and shape estimation for a fixed number of iterations , finally we perform nonlinear optimisation of @xmath28 over @xmath56 , @xmath30 , @xmath31 and @xmath2 simultaneously .",
    "we represent @xmath30 in axis - angle space to ensure that it remains a valid rotation matrix and we retain the hyperbox constraint on @xmath56 .",
    "we minimise @xmath28 using the trust - region - reflective algorithm @xcite as implemented in the matlab lsqnonlin function .",
    "the method in section [ sec : fitting ] enables a 3dmm to be fitted to 2d landmark positions if the correspondence between landmarks and model vertices is known .",
    "edges , for example caused by occluding boundaries , do not have a fixed correspondence to model vertices . hence , fitting to edges requires shape and pose estimation to happen in conjunction with establishing correspondence between image and model edges .",
    "our proposed approach establishes these correspondences explicitly by finding the closest image edge to each model boundary vertex ( subject to additional filtering to remove unreliable matches ) .",
    "our method comprises the following steps :    1 .",
    "detect facial landmarks 2 .",
    "initialise shape and pose estimates by fitting to landmarks only 3 .",
    "improve initialisation using iterated closest edge fitting 4 .",
    "nonlinear optimisation of hybrid objective function containing landmark , edge and prior terms    we describe each of these steps in more detail in the rest of this section .",
    "we use landmarks both for initialisation and as part of our overall objective function as one cue for shape estimation .",
    "we apply a facial landmark detector that is suitable for operating on `` in the wild '' images .",
    "this provides approximate positions of facial landmarks for which we know the corresponding vertices in the morphable model .",
    "we use these landmark positions to make an initial estimate of the pose and shape parameters by running the method in section [ sec : fitting ] with only these corresponding landmark positions . note that any facial landmark detector can be used at this stage . in our experiments ,",
    "we show results with a recent landmark detection algorithm  @xcite that achieves state - of - the - art performance and for which code is provided by the authors . in our experimental evaluation",
    ", we include the results of fitting to landmarks only .",
    "we assume that a subset of pixels have been labelled as edges and stored as the set @xmath57 . in practice , we compute edges by applying the canny edge detector with a fixed threshold to the input image .    model contours are computed based on the pose and shape parameters as the occluding boundary of the 3d face .",
    "the set of occluding boundary vertices , @xmath58 , are defined as those lying on a mesh edge whose adjacent faces have a change of visibility .",
    "this definition encompasses both outer ( silhouette ) and inner ( self - occluding ) contours .",
    "since the viewing direction is aligned with the @xmath59-axis , this is tested simply by checking if the sign of the @xmath59-component of the triangle normal changes on either side of the edge .",
    "in addition , we check that potential edge vertices are not occluded by another part of the mesh ( using z - buffering ) and we ignore edges that lie on a mesh boundary since they introduce artificial edges . in this paper , we deal only with occluding contours ( both inner and outer ) .",
    "if texture contours were defined on the surface of the morphable model , it would be straightforward to include these in our approach .",
    "we define the objective function for edge fitting with hard correspondence as the sum of squared distances between each projected occluding boundary vertex and the closest edge pixel : @xmath60^t - \\textrm{\\bf sop}\\left[{\\bf p}_i{\\bm \\alpha}+\\bar{\\bf f}_i,{\\bf r},{\\bf t},s\\right ] \\|^2 .",
    "\\notag\\end{aligned}\\ ] ] note that the minimum operator is responsible for computing the hard correspondences .",
    "this objective is non - convex since the minimum of a set of convex functions is not convex @xcite .",
    "hence , we require a good initialisation to ensure convergence to a minimum close to the global optimum .",
    "fitting to landmarks only does not provide a sufficiently good initialisation .",
    "so , in the next subsection we describe a method for obtaining a good initial fit to edges , before incorporating the edge cost into a hybrid objective function in section [ sec : hybrid ] .",
    "we propose to refine the landmark - only fit with an initial fit to edges that works in an iterated closest point manner .",
    "that is , for each projected model contour vertex , we find the closest image edge pixel and we treat this as a known correspondence . in conjunction with the landmark correspondences , we again run the method in section [ sec : fitting ] .",
    "this leads to updated pose and shape parameters , and in turn to updated model edges and correspondences .",
    "we iterate this process for a fixed number of iterations .",
    "we refer to this process as iterated closest edge fitting ( icef ) and provide an illustration in figure [ fig : edgefit ] . on the left",
    "we show an input image with the initial landmark detection result . in the middle",
    "we show the initial shape and pose obtained by fitting only to landmarks . on the right",
    "we show image edge pixels in blue and projected model contours in green ( where nearest neighbour edge correspondence is considered reliable ) and in red ( where correspondence is considered unreliable ) .",
    "the green / blue correspondences are used for the next iteration of fitting .         finding the image edge pixel closest to a projected contour vertex",
    "can be done efficiently by storing the image edge pixels in a @xmath54d - tree .",
    "we filter the resulting correspondences using two commonly used heuristics .",
    "first , we remove @xmath61 of the matches for which the distance to the closest image edge pixel is largest .",
    "second , we remove matches for which the image distance divided by @xmath2 exceeds a threshold ( chosen as @xmath62 in our experiments ) .",
    "the division by scale factor @xmath2 makes this choice invariant to changes in image resolution .      under the assumption that the training data of the 3dmm forms a gaussian cloud in high dimensional space",
    ", then we expect that each of the shape parameters follows a normal distribution with zero mean and variance given by the eigenvalue , @xmath63 , associated with the corresponding principal component .",
    "we find that including a prior term that captures this assumption significantly improves performance over using the hyperbox constraint alone .",
    "the prior penalises deviation from the mean shape as follows : @xmath64      finally , we perform nonlinear optimisation of a hybrid objective function comprising landmark , edge and prior terms : @xmath65 where @xmath66 , @xmath67 and @xmath68 weight the contribution of each term to the overall energy .",
    "the landmark and edge terms are invariant to the number of landmarks and edge vertices which means we do not have to tune the weights for each image ( for example , for the results in table [ tab : quangtlandmarks ] we use fixed values of : @xmath69 , @xmath70 and @xmath71 ) .",
    "we retain the hyperbox constraint and so the hybrid objective is a constrained nonlinear least squares problem and we again optimise using the trust - region - reflective algorithm .    for efficiency and to avoid problems of continuity and differentiability of the edge cost function , we follow @xcite and keep occluding boundary vertices , @xmath72 , fixed for a number of iterations of the optimiser .",
    "after a number of iterations , we recompute the vertices lying on the occluding boundary and restart the optimiser .",
    "we compare our approach with a method based on optimising an edge cost function , in the same spirit as previous work @xcite .",
    "we follow the same approach as amberg  et al .",
    "@xcite to compute the edge cost function , however we further improve robustness by also integrating over scale .",
    "for our edge detector , we use gradient magnitude thresholding with non - maxima suppression . given a set of edge detector sensitivity thresholds @xmath73 and scales @xmath74 , we compute @xmath75 edge images , @xmath76 , @xmath77 , @xmath78 , using each pair of image scale and threshold values .",
    "we compute the euclidean distance transform , @xmath79 , @xmath77 , @xmath80 , for each edge image ( i.e. the value of each pixel in @xmath81 is the distance to the closest edge pixel in @xmath82 ) .",
    "finally , we compute the edge cost surface as : @xmath83 the parameter @xmath84 determines the influence range of an edge in an adaptive manner .",
    "amberg  et al .",
    "@xcite suggest a value for @xmath84 of 1/20th the expected size of the head in pixels .",
    "we compute this parameter automatically from the scale @xmath2 .",
    "an example of an edge cost surface is shown in figure [ fig : dt ] . to evaluate the edge cost ,",
    "we compute model contour vertices as in section [ sec : edgecost ] , project them into the image and interpolate the edge cost function using bilinear interpolation : @xmath85).\\ ] ]    as with the hard edge cost , we found that the best performance was achieved by also including the landmark and prior terms in a hybrid objective function .",
    "hence , we minimise : @xmath86 we again initialise by fitting to landmarks only using the method in section [ sec : landmarksonly ] , retain the hyperbox constraint and optimise using the trust - region - reflective algorithm .",
    "we use the same weights as for the hard correspondence method in our experiments .                   & & +    * method * & @xmath87 & @xmath88 & @xmath89 & @xmath90 & @xmath91 & @xmath92 & @xmath93 & @xmath94 & @xmath95 & * mean * + average face&3.35&3.35&3.35&3.35&3.35&3.35&3.35&3.35&3.35&3.35 + proposed ( landmarks only)&2.67&2.60&2.58&2.64&2.56&2.49&2.50&2.54&2.63&2.58 + aldrian and smith @xcite&2.64&2.60&2.55&2.54&*2.49*&2.42&2.43&2.44&2.54&2.52 + romdhani et al .",
    "@xcite ( soft)&2.65&2.59&2.58&2.61&2.59&2.50&2.50&2.46&2.51&2.55 + proposed ( icef)&2.38&2.40&2.51&*2.38*&2.52&2.45&2.43&2.38&2.3&2.42 + proposed ( hard)&*2.35*&*2.26*&*2.38*&2.40&2.51&*2.39*&*2.40*&*2.20*&*2.26*&*2.35 * +",
    "we present two sets of experimental results .",
    "first , we use synthetic images with known ground truth 3d shape in order to quantitatively evaluate our method and provide comparison to previous work .",
    "second , we use real images to provide qualitative evidence of the performance of our method in uncontrolled conditions . for the 3dmm in both sets of experiments",
    "we use the basel face model @xcite .",
    ".mean euclidean vertex distance ( mm ) with noisy landmarks [ cols=\"<,^,^,^,^,^,^ \" , ]",
    "we have presented a fully automatic algorithm for fitting a 3dmm to single images using hard edge correspondence and compared it to existing methods using soft correspondence . in 3d-3d alignment , the soft correspondence of lm - icp @xcite is demonstrably more robust than hard icp @xcite . however , in the context of 3d-2d nonrigid alignment , a soft edge cost function is neither continuous nor differentiable since contours appear , disappear , split and merge under parameter changes @xcite .",
    "this makes its optimisation challenging , unstable and highly dependent on careful choice of optimisation parameters .",
    "although our proposed algorithm relies on potentially brittle hard correspondences , solving for shape and pose separately requires only solution of a linear problem and , together , optimisation of a multilinear problem .",
    "this makes iterated closest edge fitting very fast and it provides an initialisation that allows the subsequent nonlinear optimisation to converge to a better optimum .",
    "we believe that this explains the improved performance over edge fitting with soft correspondence .",
    "there are many ways this work can be extended .",
    "first , we could explore other ways in which the notion of soft correspondence is formulated .",
    "for example , we could borrow from softposit @xcite or blind pnp @xcite which both estimate pose with unknown 3d-2d correspondence .",
    "second , we could incorporate any of the refinements to standard icp @xcite .",
    "third , we currently use only geometric information and do not fit texture .",
    "finally , we would like to extend the method to video using a model that captures expression variation and incorporating temporal smoothness constraints .",
    "huang , g.b .",
    ", ramesh , m. , berg , t. , learned - miller , e. : labeled faces in the wild : a database for studying face recognition in unconstrained environments .",
    "technical report 07 - 49 , university of massachusetts , amherst ( 2007 )"
  ],
  "abstract_text": [
    "<S> in this paper we explore the problem of fitting a 3d morphable model to single face images using only sparse geometric features ( edges and landmark points ) . </S>",
    "<S> previous approaches to this problem are based on nonlinear optimisation of an edge - derived cost that can be viewed as forming soft correspondences between model and image edges . </S>",
    "<S> we propose a novel approach , that explicitly computes hard correspondences . </S>",
    "<S> the resulting objective function is non - convex but we show that a good initialisation can be obtained efficiently using alternating linear least squares in a manner similar to the iterated closest point algorithm . </S>",
    "<S> we present experimental results on both synthetic and real images and show that our approach outperforms methods that use soft correspondence and other recent methods that rely solely on geometric features .    </S>"
  ]
}