{
  "article_text": [
    "the concept of statistical depth was introduced in order to overcome the lack of a canonical ordering in @xmath0 for @xmath3 , hence the absence of the related notions of quantile and distribution functions , ranks , and signs .",
    "the earliest and most popular depth concept is halfspace depth , the definition of which goes back to tukey @xcite .",
    "since then , many other concepts have been considered :  simplicial depth @xcite , majority depth ( @xcite and @xcite ) , projection depth ( @xcite , building on @xcite and @xcite , @xcite ) , mahalanobis depth ( @xcite , @xcite , @xcite ) , oja depth @xcite , zonoid depth ( @xcite and @xcite ) , spatial depth ( @xcite , @xcite , @xcite , @xcite ) , @xmath4  depth @xcite , among many others . an axiomatic approach , aiming at unifying all those concepts , was initiated by liu @xcite and zuo and serfling @xcite , who list four properties that are generally considered desirable for any statistical depth function , namely affine invariance , maximality at the center , linear monotonicity relative to the deepest points , and vanishing at infinity ( see section  [ sec : lzs ] for details ) .",
    "halfspace depth is the prototype of a depth concept satisfying the liu - zuo - serfling axioms for the family  @xmath5 of all absolutely continuous distributions on @xmath0 .",
    "an important feature of halfspace depth is the convexity of its contours , which thus satisfy the star - convexity requirement embodied in the linear monotonicity axiom .",
    "that feature is shared by most existing depth concepts and might be considered undesirable for distributions with non convex supports or level contours , and multimodal ones .",
    "proposals have been made , under the name of local depths , to deal with this , while retaining the spirit of the liu - zuo - serfling axioms : see @xcite , @xcite , @xcite , and @xcite who provide an in - depth discussion of those various attempts . in this paper , we take a totally different and more agnostic approach , on the model of the discussion by serfling in @xcite : if the ultimate purpose of statistical depth is to provide , for each distribution @xmath6 , a @xmath6-related ordering of  @xmath0 producing adequate concepts of quantile and distribution functions , ranks and signs , the relevance of a given depth function should be evaluated in terms of the relevance of the resulting ordering , and the quantiles , ranks and signs it produces .",
    "now , the concepts of quantiles , ranks and signs are well understood in two particular cases , essentially , that should serve as benchmarks .",
    "the first case is that of the family  @xmath7 of all distributions with nonvanishing lebesgue densities over convex support sets . here , the concepts of quantile and distribution functions , ranks , and signs are related to the  classical \" univariate ones .",
    "the second case is that of the family  @xmath8 of all full - rank elliptical distributions over  @xmath0 ( @xmath3 ) with radial densities over elliptical support sets . recall that the family  @xmath9 of elliptical distributions with given radial density  @xmath10 and distribution function @xmath11 is a parametric family indexed by a location parameter  @xmath12 and a scatter parameter @xmath13 ( a symmetric positive definite real matrix ) such that a random vector @xmath14 has distribution @xmath15 iff the residual @xmath16 , which results from transforming @xmath14 into isotropic position , has spherical distribution @xmath17",
    "further , this is equivalent to @xmath18 having the spherical uniform distribution @xmath19 on the unit ball @xmath20 in @xmath0 . by _",
    "spherical uniform _",
    ", we mean the distribution of a random vector @xmath21 , where @xmath22 is uniform on @xmath23 $ ] , @xmath24 is uniform on the unit sphere @xmath25 , and  @xmath22 and @xmath24 are mutually independent .",
    "there , spherical contours with  @xmath26-probability contents @xmath27 coincide with the halfspace depth contours , and provide a natural definition of @xmath27-quantile contours for @xmath28 , while @xmath29 , @xmath30 and @xmath31 play the roles of vector ranks , signs , and ranks , respectively ( @xcite ) : we call them spherical _ vector ranks _ , _ signs _ , and _",
    "ranks_. on the other hand , we call the inverse map @xmath32 of the vector rank map @xmath33 the _ vector quantile _ map . in both cases ,",
    "the relevance of ranks and signs , whether traditional or spherical , is related to their role as maximal invariants under groups of transformations minimally generating  @xmath7 or the family  @xmath34 of spherical distributions , of which distribution - freeness of  @xmath35 is just a by - product , as explained in @xcite .",
    "we argue that an adequate depth function , when restricted to those two particular cases , should lead to the same well - established concepts  classical quantiles , ranks and signs for @xmath7 , and spherical ones for  @xmath36hence should coincide with halfspace depth .",
    "now , a closer look at those two particular cases reveals that halfspace depth contours , in @xmath7 and @xmath36 , are the images , by the vector quantile map @xmath37 , of the hyperspheres  @xmath38 with radii  @xmath39 centered at the origin .",
    "the map @xmath37 is the gradient of a convex function and it transports the spherical uniform distribution @xmath19 on the unit ball @xmath40 of  @xmath0 into the univariate distribution @xmath41 or into the spherical distribution  @xmath42 of interest .    for the case of general distributions @xmath43 ,",
    "we proceed similarly , and define the map @xmath37 as a gradient of a convex function that transform the spherical uniform distribution  @xmath19 into the target distribution , namely if @xmath44 then @xmath45 .",
    "it follows by mccann s",
    "@xcite extension of brenier s celebrated polar factorization theorem  @xcite that , for any distribution @xmath43 on  @xmath0 , such a gradient @xmath37 exists , and is essentially unique .",
    "moreover , when  @xmath43 has finite moments of order two , that mapping @xmath37 is the monge - kantorovich optimal transport map that transfers the spherical uniform distribution  @xmath19 to @xmath43 , where optimality is the sense of minimizing the expected quadratic cost @xmath46 subject to @xmath44 and  @xmath47 .",
    "this suggests a new concept of statistical depth , which we call the _ monge - kantorovich ( or mk ) depth _",
    "@xmath48 , the contours of which are obtained as the images by @xmath37 of the hyperspheres with radius  @xmath49 $ ] . when restricted to @xmath7 or @xmath36 ,",
    "monge - kantorovich and halfspace depths coincide . under suitable regularity conditions due to caffarelli ( see @xcite , section  4.2.2 ) ,  @xmath37 is a homeomorphism , and its inverse @xmath50 is also the gradient of a convex function ; the monge - kantorovich depth contours are continuous and the corresponding depth regions are nested , so that monge - kantorovich depth indeed provides a center - outward ordering of  @xmath0 , namely , @xmath51 thus , our approach based on the theory of measure transportation allows us to define    a.   an _ mk vector quantile _",
    "map @xmath37 , and the associated _ mk quantile _ correspondence , which maps @xmath49 $ ] to @xmath52 , b.   an _ mk vector rank _ ( or _ mk signed rank _ ) function @xmath35 , which can be decomposed into an _ mk rank _",
    "function @xmath53 from @xmath0 to @xmath23 $ ] , with @xmath54 , and an _ mk sign _",
    "function  @xmath55 , mapping @xmath56 to @xmath57 .    to the best of our knowledge ,",
    "this is the first proposal of a depth concept based on the monge - kantorovich theory of measure transportation hence the first attempt to provide a measure - driven ordering of @xmath0 based on measure transportation theory .",
    "previous proposals have been made , however , of measure transportation - based vector quantile functions in ekeland , galichon and henry @xcite and galichon and henry @xcite ( with moment conditions ) and carlier , chernozhukov and galichon @xcite ( dropping moment conditions ) who also extended the notion to vector quantile regression , creating a vector analogue of koenker and basset s @xcite scalar quantile regression .",
    "more recently , decurninge @xcite proposed a new concept of multivariate @xmath4 moments based upon a similar notion .",
    "in these contributions , however , the focus is not statistical depth and the associated ranks and quantiles , and the leading case for the reference distribution is uniform on the unit hypercube in @xmath0 , as opposed to the spherical uniform distribution @xmath19 we adopt here as leading case , while pointing out that other reference distributions may be entertained , such as the standard gaussian distribution on @xmath0 or the uniform on the hypercube @xmath23^d$ ] as mentioned above .",
    "we then proceed to define the empirical notions corresponding to the concepts given above .",
    "we define the empirical mk vector quantiles and ranks as the essentially unique gradients @xmath58 and @xmath59 of a pair of convex functions solving the kantorovich dual problem for the monge optimal transport with quadratic costs . using the plug - in principle",
    ", we then define the empirical rank and sign maps as @xmath60 and @xmath61 and the empirical @xmath27-quantile sets and contours as @xmath62 and @xmath63 .",
    "we establish the uniform convergence of these quantities to their theoretical counterparts .",
    "we derive these results as a consequence of the uniform convergence of empirical transport ( vector quantile and rank ) maps @xmath64 and @xmath59 to their theoretical counterparts @xmath37 and @xmath35 on compact subsets of the domain s interior .",
    "this is the main theoretical result of the paper presented in theorem 3.1 .",
    "this result in turn is derived through an application of the extended continuous mapping theorem and a set of new theorems on stability of transport under deterministic perturbations of the source and target measures , given as theorems a.1 and a.2 in the appendix , which are new results of independent interest .",
    "application of the extended continuous mapping theorem allows to us then to replace the deterministic perturbations by stochastic perturbations of measures and obtain the stochastic uniform convergence of the empirical transport maps .",
    "let @xmath65 be some probability space . throughout",
    ", @xmath5 denotes a class of probability distributions over @xmath0unless otherwise specified , the class of all borel probability measures on @xmath0 .",
    "denote by @xmath66 the unit ball , and by @xmath67 the unit sphere , in @xmath0 .",
    "for  @xmath68 $ ] , @xmath69 is the ball , and @xmath70 the sphere , of radius @xmath27 .",
    "let  @xmath71 stand for the distribution of the random vector @xmath14 .",
    "the symbol @xmath72 will denote either the boundary of a set or the subdifferential , as will be clear from the context .",
    "following villani @xcite , we denote by  @xmath73 the _ image measure _ ( or _ push - forward _ ) of a measure @xmath74 by a measurable map  @xmath75 .",
    "explicitly , for any borel set @xmath76 , @xmath77 . for a borel subset @xmath78 of a vector space equipped with the norm @xmath79 and @xmath80 , let @xmath81 for two probability distributions @xmath43 and @xmath82 on a measurable space @xmath78 , define the bounded lipschitz metric as @xmath83 which metrizes the topology of weak convergence",
    ". throughout the paper , we let @xmath84 and @xmath85 be convex subsets of  @xmath0 with non - empty interiors .",
    "a _ convex _",
    "function @xmath86 on @xmath87 refers to a function @xmath88 for which @xmath89 for any @xmath90 such that @xmath91 and @xmath92 are finite and for any @xmath93 .",
    "such a function is continuous on the interior of the convex set dom @xmath94 , and differentiable lebesgue - almost everywhere in dom @xmath86 , by rademacher s theorem .",
    "write @xmath95 for the gradient of @xmath86 . for any function @xmath96 ,",
    "the _ conjugate _ @xmath97 of @xmath86 is defined for each @xmath98 by @xmath99.\\ ] ] the conjugate  @xmath100 of @xmath86 is a convex lower - semi - continuous function on @xmath101 . we shall call a _ conjugate pair of potentials _ over @xmath102 any pair of lower - semi - continuous convex functions @xmath103 that are conjugates of each other .",
    "the transpose of a matrix @xmath76 is denoted  @xmath104 .",
    "finally , we call _ weak order _ a complete reflexive and transitive binary relation . finally , recall the definition of hausdorff distance between two non - empty sets @xmath76 and @xmath105 in  @xmath0 : @xmath106      section  [ sec : mk ] introduces and motivates the concepts of statistical depth , vector quantiles and vector ranks based on optimal transport maps . section  [ sec : emp ] describes estimators of depth contours , quantiles and ranks , and proves consistency of these estimators .",
    "section  [ sec : comp ] describes computational characterizations .",
    "the appendix presents additional theoretical results and proofs .",
    "the notion of statistical depth serves to define a center - outward ordering of points in the support of a distribution on @xmath0 , for  @xmath3 . as such",
    ", it emulates the notion of quantile for distributions on the real line .",
    "we define it as a real - valued index on @xmath0 as follows .",
    "[ def : depth ] a depth function is an upper - semi - continuous mapping @xmath107 . in our context",
    "these functions will be indexed by a distribution  @xmath43 .",
    "the quantity @xmath108 is called the _ depth of _ @xmath109 _ relative to _ @xmath43 . for each @xmath110 , the _ depth ordering _",
    "@xmath111 _ associated with _",
    "@xmath112 is the weak order on @xmath0 defined , for  @xmath113 , by @xmath114 in which case @xmath115 is said to be _ deeper _ than @xmath116 relative to @xmath43 .",
    "the depth function thus defined allows graphical representations of the distribution  @xmath43 through depth contours , which are collections of points of equal depth relative to @xmath43 .",
    "[ def : rc ] let @xmath112 be a depth function relative to distribution @xmath43 on @xmath0 .",
    "the _ region of depth _",
    "@xmath1 is the upper contour set of level @xmath1 of @xmath112 , namely @xmath117 ; the _ contour of depth _",
    "@xmath1 is the boundary  @xmath118 .    by construction ,",
    "the depth regions are nested : @xmath119 hence , the depth ordering qualifies as a _",
    "center - outward ordering _ of points in @xmath0 relative to the center given by the set of the deepest points , @xmath120    it is often convenient to work with depth regions indexed by their probability content .",
    "[ def : rcq]for @xmath121 $ ] , the depth region with probability content at least @xmath27 is @xmath122 the corresponding contour region is the boundary @xmath123 .",
    "[ fig : tban ]        the four axioms proposed by liu @xcite and zuo and serfling @xcite to unify the diverse depth functions proposed in the literature are the following .    1 .",
    "( affine invariance ) @xmath124 for any @xmath125 , any full - rank @xmath126 matrix @xmath76 , and any  @xmath127 .",
    "( maximality at the center ) if @xmath128 is a center of symmetry for @xmath129 ( symmetry here can be either _ central _ , _ angular _ or _ halfspace _ symmetry ) , it is _ deepest _ , that is , @xmath130 .",
    "3 .   ( linear monotonicity relative to the deepest points )",
    "if @xmath130 , then @xmath131 for all @xmath132 $ ] and @xmath56 : depth is monotonically decreasing along any straight line running through a deepest point .",
    "4 .   ( vanishing at infinity )",
    "@xmath133 .",
    "the earliest and most popular depth function is _ halfspace depth _ proposed by tukey  @xcite :    [ def : half ] the halfspace depth  @xmath134 of a point @xmath135 with respect to the distribution @xmath136 of a random vector @xmath14 on @xmath0 is defined  as @xmath137.\\ ] ]    halfspace depth relative to any distribution with nonvanishing density on @xmath0 satisfies  ( a1)-(a4 ) .",
    "the appealing properties of halfspace depth are well known and well documented : see donoho and gasko @xcite , mosler @xcite , koshevoy @xcite , ghosh and chaudhuri @xcite , cuestas - albertos and nieto - reyes @xcite , hassairi and regaieg @xcite , to cite only a few .",
    "halfspace depth takes values in @xmath138 $ ] , and its contours are continuous and convex ; the corresponding regions are closed , convex , and nested as @xmath1 decreases . under very mild conditions ,",
    "halfspace depth moreover fully characterizes the distribution  @xmath43 . for somewhat less satisfactory features ,",
    "however , see dutta et al .",
    "an important feature of halfspace depth is the convexity of its contours , which implies that halfspace depth contours can not pick non convex features in the geometry of the underlying distribution , as illustrated in figure  1 .",
    "we shall propose below a new depth concept , the monge - kantorovich ( mk ) depth , that relinquishes the affine equivariance and star convexity of contours imposed by axioms  ( a1 ) and  ( a3 ) and recovers non convex features of the underlying distribution . as a preview of the concept , without going through any definition , we illustrate in figure 2 ( using the same banana - shaped distribution as in figure 1 ) the ability of the mk depth to capture non - convexities . in what follows , we characterize these abilities more formally .",
    "we shall emphasize that this notion comes in a package with new , interesting notions of vector ranks and quantiles , based on optimal transport , which reduce to classical notions in the univariate and multivariate spherical cases .",
    "the principle behind the notion of depth we define here is to map the depth regions and contours relative to a well - chosen reference distribution @xmath139 , into depth contours and regions relative to a distribution of interest @xmath43 on @xmath0 , using a well - chosen mapping .",
    "the mapping proposed here is the gradient of a convex function @xmath140 such that if @xmath141 has distribution @xmath139 , then @xmath142 has distribution @xmath43 , or , in terms of measures , @xmath143 .",
    "the gradient @xmath140 is said to to push @xmath139 forward to  @xmath43 , which is conventionally denoted by the push - forward notation , @xmath143 , which is defined in the notation section .",
    "the gradient of a convex function property is a generalization of monotonicity in the one - dimensional case .",
    "when @xmath139 and @xmath43 have finite second - order moments , these maps are the optimal monge - kantorovich transport maps from @xmath139 to @xmath43 for the quadratic cost , as explained below . in the unidimensional case , when @xmath139 is the standard uniform , the gradient / optimal transport map @xmath140 coincides with the classical quantile function .    [ fig : mkban ]        the following theorem , due to brenier @xcite and mccann @xcite , establishes existence of gradients of convex functions with the required properties .",
    "[ thm : polar ] let @xmath43 and @xmath139 be two distributions on @xmath0 .",
    "( 1 ) if @xmath139 is absolutely continuous with respect to the lebesgue measure on  @xmath144 , with support contained in a convex set @xmath87 , the following holds : there exists a convex function @xmath88 such that @xmath145 . the function @xmath95 exists and is unique , @xmath139-almost everywhere .",
    "( 2 ) if , in addition , @xmath43 is absolutely continuous on @xmath144 with support contained in a convex set @xmath101 , the following holds : there exists a convex function  @xmath146 such that @xmath147 .",
    "the function @xmath148 exists , is unique and equal to @xmath149 , @xmath43-almost everywhere .    if @xmath43 and @xmath139 have finite second moments , @xmath150 is @xmath139-almost everywhere equal to the _ optimal transport plan _ @xmath140 from @xmath139 to @xmath43 for quadratic cost : namely , the map @xmath151 solves the problem @xmath152 or , equivalently , @xmath153 this definition has a classical counterpart in the case of univariate distributions .",
    "when @xmath2 and @xmath139 is uniform on @xmath23 $ ] , the optimal transport @xmath154 is the classical quantile function for distribution  @xmath43 .",
    "we now state a fundamental duality result due to kantorovich and brenier , which we explicitly rely on in section  [ sec : emp ] .    [ dual ] suppose hypothesis ( 1 ) of theorem  [ thm : polar ] holds and @xmath43 and @xmath139 have finite second moments , then the function @xmath86 , or optimal potential , solves the optimization problem @xmath155 where the infimum is taken over the class of conjugate pairs of potentials @xmath156 over  @xmath157 .",
    "this problem is dual to the optimal transport problem ( [ eq : ot ] ) .",
    "moreover , under the hypotheses of theorem  [ dual ] , @xmath95 is the unique optimal transport map from  @xmath139 to  @xmath43 for quadratic cost , in the sense that any other optimal transport coincides with @xmath140 on a set of @xmath139-measure 1 ( see @xcite ) . under the hypotheses of theorem",
    "[ dual ] and hypothesis  ( 2 ) of theorem  [ thm : polar ] , @xmath148 is the unique optimal ( reverse ) transport map from @xmath43 to  @xmath139 for quadratic cost , in the sense that any other optimal transport coincides with @xmath158 on a set of @xmath43-measure one ( see @xcite ) .",
    "next we use theorem  [ thm : polar ] to define a natural notion of _ vector quantiles _ and _ vector ranks_.    [ def : mk ] let @xmath139 be an absolutely continuous reference distribution with support in a convex set @xmath159 , and let  @xmath43 be an arbitrary distribution with support in a convex set @xmath160 . let @xmath140 be the @xmath139-almost surely unique gradient of a convex function @xmath86 of theorem  [ thm : polar ] and let  @xmath100 be the conjugate of @xmath86 over @xmath102 .",
    "vector quantiles and ranks are defined as follows : @xmath161 ,   \\   \\ { u \\in { \\mathcal{u } } } ; \\quad { { \\rm r}}_p(y ) \\in",
    "\\arg \\sup_{u \\in { \\mathcal{u } } } [ y^\\top u - \\psi(u ) ] , \\ \\ { y \\in { { \\rm i}\\kern-0.18em{\\rm r}}^d}.\\ ] ]    thus we define the mk vector quantiles @xmath37 and ranks @xmath35 as any solutions of the optimization problems in the display above .",
    "our definition here does not impose any moment condition and ensures that the quantities are defined for every value of the argument in the appropriate domains . by the envelope theorem and rademacher s theorem ( @xcite ) , the maps @xmath37 and @xmath35",
    "essentially coincide with the gradients @xmath140 and @xmath158 of conjugate potentials @xmath86 and @xmath162 , namely @xmath163 where  a.e . \"",
    "abbreviates  almost everywhere with respect to the lebesgue measure \" .",
    "in the fact , the equality holds everywhere on certain domains under condition ( c ) stated below . under the conditions of theorem",
    "[ dual ] , the pair @xmath103 has the variational characterization given in  ( [ eq : kdual ] ) .    when requiring regularity of vector quantiles and ranks , we shall impose the following condition on the conjugate pair of optimal potentials @xmath164 over @xmath102",
    "* let @xmath84 and @xmath85 be closed , convex subsets of @xmath0 , and @xmath165 and @xmath166 be open , non - empty sets in @xmath0 .",
    "let @xmath167 and @xmath168 form a conjugate pair over  @xmath102 and possess gradients @xmath169 for all @xmath170 , and @xmath171 for all @xmath172 .",
    "the gradients @xmath173 and @xmath174 are homeomorphisms and  @xmath175 .    under condition ( c ) , we have : @xmath176 that is , vector ranks and quantiles are defined as gradients of conjugate potentials for each ( as opposed to almost every ) value in the indicated sets , and inverse functions of each other .",
    "sufficient conditions for condition ( c ) in the context of definition  [ def : mk ] are provided by caffarelli s regularity theory ( villani @xcite , theorem 4.14 ) .",
    "one set of sufficient conditions is as follows .",
    "[ prop : c ] suppose that @xmath43 and @xmath139 admit densities , which are of smoothness class @xmath177 for @xmath178 on convex , compact support sets @xmath179 and @xmath180 , and the densities are bounded away from zero and above uniformly on the support sets . then condition ( c ) is satisfied for the conjugate pair @xmath164 such that  @xmath181 and @xmath182    we now can give our _ main _ definition  that of multivariate notions of quantiles and ranks , through which a depth function will be inherited from the reference distribution  @xmath183 .",
    "[ def : mk ] let  @xmath139 be the spherical uniform distribution @xmath19 on a unit ball @xmath184 , and @xmath43 be an arbitrary distribution with support in a convex region @xmath160 .",
    "mk quantiles , ranks , signs and depth are defined as follows .    1 .",
    "the _ mk rank _ of @xmath185 is @xmath186 and the _ mk sign _ is  @xmath187 .",
    "the _ mk _ @xmath27-_quantile contour _ is the set @xmath52 and the _ mk depth region _ with probability content @xmath27 is @xmath188 .",
    "the _ mk depth _ of @xmath189 is the depth of @xmath190 under @xmath191 : @xmath192    the notion of depth proposed in definition  [ def : mk ] is based on an optimal transport map from the reference spherical uniform distribution @xmath183 to the distribution of interest  @xmath43 . under condition ( c ) , @xmath37 and @xmath35 are continuous and are mutual inverse maps , so that the mk @xmath27-quantile contours are continuously deformable into spheres and the mk depth regions with probability",
    "content @xmath27 are nested .    by choosing other reference distributions @xmath139 , such as the uniform distribution on a unit hypercube , or the standard gaussian distribution",
    ", we can give a more general definition of mk ranks , quantiles , and signs , which may be of interest .",
    "[ def : mk2]let @xmath139 be an absolutely continuous reference distribution with support contained in a convex region @xmath193 , and let @xmath194 be a norm on @xmath87 .",
    "let @xmath195 be an associated reference depth function and @xmath196 the associated @xmath27-quantile contour and @xmath197 the associated depth region with probability content @xmath27 .",
    "the mk quantiles , ranks , signs and depth are defined as follows .    1 .",
    "the _ mk rank _ of @xmath185 is @xmath186 and the _ mk sign _ is  @xmath187 .",
    "the _ mk _ @xmath27-_quantile _ is the set @xmath198 and the _ mk depth region _ with probability mass @xmath27 is @xmath199 .",
    "the _ mk depth _ of @xmath189 is the depth of @xmath190 under @xmath200 : @xmath201    of course , all the quantities thus defined depend on the choice of the reference distribution @xmath139 and the depth function @xmath200 .",
    "when the reference distribution  @xmath139 is spherical , it is natural to use tukey s depth function  @xmath202 to define the mk depth of @xmath189 relative to  @xmath43 as the halfspace depth of @xmath190 relative to the reference distribution  @xmath139 , namely @xmath203 the choice of halfspace depth may be less natural for non - spherical reference distributions .",
    "one example is where @xmath139 is the standard uniform distribution @xmath204^d$ ] on the unit cube @xmath23^d$ ] .",
    "then it seems natural to use the sup norm @xmath205 as the norm @xmath194 and the depth function @xmath206^d}(y ) = 1/2 - \\| y - \\mathbf{1}/2\\|_\\infty$ ] , where @xmath207 , in which case @xmath197 is a cube of diameter @xmath208 centered at @xmath209 . in this case , the mk depth is @xmath210^d}({{\\rm r}}_p(y)).\\ ] ]      here we consider in more detail the monge - kantorovich depth defined from a baseline spherical uniform distribution @xmath19 supported on the unit ball @xmath40 of @xmath0 . recall that this distribution is that of a random vector @xmath21 , where @xmath22 is uniform on @xmath23 $ ] , @xmath24 is uniform on the unit sphere  @xmath25 , and @xmath22 and @xmath24 are mutually independent .",
    "the spherical symmetry of distribution  @xmath19 produces halfspace depth contours that are concentric spheres , the deepest point being the origin .",
    "the radius @xmath211 of the ball @xmath212 is also its @xmath19-probability contents , that is ,  @xmath213 . letting @xmath214 , the halfspace depth with respect to @xmath19 of a point  @xmath215 , where  @xmath216 $ ] and @xmath217 , is @xmath218 &     d\\geq 2\\\\(1-\\tau ) /2 &",
    "d=1.\\end{array}\\right.\\ ] ] note that for @xmath2 , @xmath219 takes values @xmath220 and , in agreement with rotational symmetry of  @xmath19 , that depth does not depend on @xmath219 .    the principle behind the notion of depth we investigate further here is to map the depth regions and contours relative to the spherical uniform distribution @xmath19 , namely , the concentric spheres , into depth contours and regions relative to a distribution of interest  @xmath43 on  @xmath0 using the optimal transport plan from  @xmath19 to  @xmath43 . under the sufficient conditions for condition ( c ) provided in lemma  [ prop : c ] ( note that the conditions on @xmath139 are automatically satisfied in case @xmath183 ) , @xmath37 and @xmath35 are continuous and",
    "are inverse maps of each other , so that the mk depth contours are continuously deformable into spheres , the mk depth regions are nested , and regions and contours , when indexed by probability content , take the respective forms @xmath221.\\ ] ]      the halfspace depth of a point @xmath222 relative to a distribution @xmath43 over @xmath223 takes the very simple form @xmath224 where , by abuse of notation , @xmath43 stands for both distribution and distribution function .",
    "the nondecreasing map defined for each @xmath222 by @xmath225 is the derivative of a convex function and it transports distribution @xmath43 to @xmath226 , which is uniform on  @xmath227 $ ] , i.e. , @xmath228 .",
    "hence @xmath35 coincides with the mk vector rank of definition  [ def : mk ] .",
    "therefore , for each @xmath222 , @xmath229 and mk depth coincides with tukey depth in case of all distributions with nonvanishing densities on the real line .",
    "more generally ( still in the univariate case ) , denoting by @xmath230 and @xmath231 the distribution functions associated with two absolutely continuous distributions @xmath232 and  @xmath233 , the mapping @xmath234 , being monotone increasing , is also the optimal transport from @xmath232 to  @xmath233 . the same transformation has been studied , in a different context , by doksum  @xcite and doksum and sievers  @xcite ; see also the concept of convex ordering proposed by van zwet  @xcite .      as explained in the introduction",
    ", a @xmath1-dimensional random vector @xmath14 has elliptical distribution @xmath235 with location  @xmath236 , positive definite symmetric @xmath126 scatter matrix @xmath13 and radial density function @xmath10 ( radial distribution function @xmath11 ) if and only if , denoting by @xmath237 the symmetric root of @xmath13 , @xmath238 has spherical distribution @xmath239 ( hence  @xmath240 has density @xmath241 ) , which holds if and only if @xmath242 let @xmath243 , and note that the map @xmath244 is the gradient of  @xmath245 so that , from ( [ eq : ell ] ) , @xmath246 as definition  [ def : mk ] requires . that @xmath100 is convex follows from theorem 5.1 of @xcite by noting that @xmath100 is a composition of @xmath247 , a convex , non - decreasing map , and @xmath248 , a convex function by definition of the norm . as a consequence ,",
    "the mapping @xmath35 in ( [ eq : ell ] ) is the mk vector rank function associated with @xmath249 ; and , the mk depth contours ( with probability content @xmath27 ) of  @xmath43 are spheres with radii @xmath250 centered at the origin : @xmath251 these spheres are halfspace depth contours for @xmath43 .",
    "this is the precise sense in which mk depth reduces to halfspace for elliptical families .",
    "it should be noted above , that we treat location and scatter parameters as known , and transform @xmath14 to a vector @xmath28 in isotropic position .",
    "this transformation ensures basic invariance properties of the resulting depth , ranks , and quantiles with respect to affine transformations .",
    "when those parameters are unknown , they will have to be replaced with by affine - equivariant estimators , as in the usual definition of elliptical ranks and signs ( see , e.g . , @xcite ) in order to insure similar invariance properties for the empirical analogs . without the aforementioned transformation ,",
    "however , the invariance properties are not guaranteed , owing to the fact that composition of two gradients of convex functions is not necessarily the gradient of a convex function , unless the composition has a specific structure , as is the case above .",
    "having defined monge - kantorovich vector quantiles , ranks and depth relative to a distribution @xmath43 based on reference distribution @xmath139 on @xmath0 , we now turn to the estimation of these quantities .",
    "hereafter , we shall assume that condition ( c ) holds .",
    "then , the mk vector quantiles and ranks of definition  [ def : mk ] are @xmath252 for each @xmath170 and @xmath172 , respectively .",
    "we define @xmath253 as a collection of conjugate potentials @xmath254 on @xmath102 such that @xmath255 for some fixed point @xmath256 . under the conditions of theorem  [ dual ]",
    ", the potentials @xmath103 solve the dual problem @xmath257 constraining the conjugate pair to lie in @xmath253 is a normalization that ( without any loss of generality ) pins down the constant , so that @xmath164 are uniquely determined , as argued in the proof .",
    "we propose empirical versions of mk quantiles and ranks based on estimators @xmath258 of  @xmath43 .",
    "the typical case is when the reference measure @xmath139 is known .",
    "however , our theory allows us to handle the case where @xmath139 is itself unknown , and so it is estimated by some @xmath259 .",
    "this is indeed useful for at least two reasons .",
    "first , we may be interested in a classical problem of comparing one distribution @xmath43 to a reference distribution @xmath139 , both of which are known only up to a random sample available from each of them .",
    "second , we may be interested in discretizing @xmath139 for computational reasons , as we discuss in section  [ sec : comp ] , in which case the discretized @xmath139 is the estimator of @xmath139 .",
    "suppose that @xmath260 and @xmath261 are sequences of random measures on @xmath101 and @xmath87 , with finite total mass , that are consistent for @xmath43 and @xmath139 , in the sense that @xmath262 where @xmath263 denotes convergence in ( outer ) probability under probability measure  @xmath264 , see van der vaart and wellner @xcite .",
    "a basic example is where @xmath265 is the empirical distribution of a random sample @xmath266 drawn from @xmath43 and @xmath267 is the empirical distribution of a random sample @xmath268 drawn from @xmath139 .",
    "other , much more complicated examples , including smoothed empirical measures and data originating from dependent processes , satisfy sufficient conditions for ( [ empirical kr ] ) that we now give . in order to develop some examples",
    ", we introduce an ergodicity condition :    * let @xmath269 be a measurable subset of @xmath0 . a data stream @xmath270 , with @xmath271 for each @xmath272 and @xmath273 , is ergodic for the probability law @xmath274 on  @xmath269 if for each  @xmath275 such that @xmath276 , the law of large numbers holds :    @xmath277    the class of ergodic processes is extremely rich , including in particular the following cases :    * @xmath278 , where @xmath279 are independent , identically distributed random vectors with distribution @xmath274 ; * @xmath278 , where @xmath279 is stationary strongly mixing process with marginal distribution @xmath274 ; * @xmath280 , where @xmath279 is an irreducible and aperiodic markov chain with invariant distribution @xmath274 ; * @xmath281 , where @xmath282 is a deterministic sequence of points such that ( [ erg ] ) holds deterministically .    for a detailed motivation and discussion of the use of deterministic sequences such as , for example , the so - called _ low - discrepancy sequences",
    ": see , e.g. , chapter 9 and , more particularly , page 314 of @xcite .",
    "thus , if the data stream @xmath270 is ergodic for @xmath274 , we can estimate @xmath274 by the empirical and smoothed empirical measures @xmath283 where @xmath284 is the probability law of the standard @xmath1-dimensional gaussian vector , @xmath285 , and @xmath286 a semi - positive - definite matrix of bandwidths such that @xmath287 as  @xmath288 .",
    "note that @xmath289 may not integrate to 1 , since we are forcing it to have support in @xmath269 .",
    "[ ergodic ] suppose that @xmath274 is absolutely continuous with support in the compact set @xmath290 .",
    "if @xmath270 is ergodic for @xmath274 on @xmath269 , then @xmath291 thus , if @xmath292 and @xmath293 are absolutely continuous with support sets contained in compact sets @xmath101 and @xmath87 , and if @xmath294 is ergodic for @xmath295 on @xmath101 and  @xmath296 is ergodic for @xmath297 on @xmath87 , then @xmath298 or @xmath289 and @xmath299 or  @xmath300 obey condition ( [ empirical kr ] ) .    absolute continuity of @xmath274 in lemma  [ ergodic ] is invoked to show that the smoothed estimator @xmath289 is asymptotically non - defective .",
    "we base empirical versions of mk quantiles , ranks and depth on estimators @xmath265 for @xmath43 and @xmath267 for @xmath139 satisfying ( [ empirical kr ] ) .",
    "this includes cases where the reference measure @xmath139 is known , i.e. @xmath301 . recall assumption  ( c ) is maintained throughout this section .",
    "empirical vector quantile @xmath58 and vector rank @xmath302 are any pair of functions satisfying , for each  @xmath303 and @xmath98 , @xmath304 , \\quad \\hat { { \\rm r}}_n(y ) \\in",
    "\\arg \\sup_{u \\in { \\mathcal{u } } } [ y^\\top u - \\hat \\psi_n(u)],\\ ] ] where @xmath305 is such that @xmath306    we now state the main result of section [ sec : emp ] .    [ theorem : empirical ] suppose that the sets @xmath87 and @xmath101 are compact subsets of @xmath0 , and that the probability measures @xmath43 and  @xmath139 are absolutely continuous with respect to the lebesgue measure , with @xmath307 and @xmath308 .",
    "suppose that @xmath309 and @xmath310 are sequences of random measures on  @xmath101 and @xmath87 , with finite total mass , that are consistent for @xmath43 and @xmath139 in the sense of  ( [ empirical kr ] ) .",
    "suppose that condition ( c ) holds for the solution of ( [ kantorovich 2 ] ) for @xmath311 and  @xmath312 .",
    "then , as @xmath288 , for any closed set @xmath313 and any closed set @xmath314 , @xmath315 and @xmath316 where the suprema are taken over nonempty subsets",
    ".    the first result establishes the uniform consistency of empirical vector quantile and rank maps , hence also of empirical ranks and signs .",
    "the set @xmath317 with @xmath318 is the statistical depth contour with probability content @xmath27 .",
    "the second result , therefore , establishes consistency of the approximation @xmath319 to the theoretical depth region  @xmath317 .",
    "we work with the conditions of the previous theorem , but here , for the sake of simplicity , we first consider the lead case where @xmath139 is known , i.e. @xmath320 .    [ def : emk1]let  @xmath139 be an absolutely continuous reference distribution with support contained in a convex region @xmath193 , and let @xmath194 be a norm on @xmath87 .",
    "the mk empirical quantiles , ranks , signs and depth are defined as follows .    1 .   the _ mk empirical rank _ and _ sign _ of @xmath185 are @xmath321 and  @xmath322 .",
    "the _ mk empirical _ @xmath27-_quantile contour _ is the set @xmath323 and the _ mk empirical depth region _ with probability mass @xmath27 is @xmath324 .",
    "the _ mk empirical depth _ of @xmath189 is the depth of @xmath325 under @xmath200 : @xmath326    uniform convergence of empirical mk rank , signs and depth to their theoretical counterparts follows by an application of the extended continuous mapping theorem .    [ cor : ers ] work with the assumptions of theorem  [ theorem : empirical ] , and assume that @xmath327 is continuous on @xmath328 .",
    "as @xmath288 , for any closed set @xmath314 , @xmath329    uniform convergence of mk empirical @xmath27-quantile contours and mk empirical depth regions with probability content @xmath27 follows also through an application of the extended continuous mapping theorem .",
    "[ cor : eqd ] work with the assumptions of theorem  [ theorem : empirical ] .",
    "consider @xmath330 such that @xmath331 , then @xmath332    the main results are derived assuming we know the reference distribution @xmath139 and the associated depth function @xmath200 as well as depth regions @xmath333 and quantile contours  @xmath334 .",
    "there are cases where these will be approximated numerically or using data .",
    "the same definitions and results extend naturally where these quantities are replaced by uniformly consistent estimators @xmath335 , @xmath336 , and @xmath337 : @xmath338 where @xmath339 is any closed subset of @xmath328 .",
    "these high - level conditions hold trivially for the numerical approximations we use in section  [ sec : comp ] .",
    "they also hold , for example , for tukey s halfspace depth under regularity conditions .",
    "we will not discuss these conditions here .",
    "[ def : emk2]let @xmath139 be an absolutely continuous reference distribution with support contained in a convex and compact region  @xmath340 , and let  @xmath194 be a norm on  @xmath87 . given estimators  @xmath335 , @xmath336 and  @xmath337 satisfying ( [ depth ] ) , the mk empirical quantiles , ranks , signs and depth are defined as follows .    1 .",
    "the _ mk empirical rank and sign _ of @xmath185 are @xmath321 and  @xmath322 .",
    "the _ mk empirical _ @xmath27-_quantile contour _ is the set @xmath341 and the _ mk empirical depth region _ with probability mass @xmath27 is  @xmath342 .",
    "the _ mk empirical depth _ of @xmath189 is the depth of @xmath325 under  @xmath343 : @xmath344    [ cor : eqd2 ] work with conditions of the previous corollary and suppose that conditions ( [ depth ] ) hold .",
    "then the conclusions of corollary 3.1 hold and the conclusions of corollary 3.2 hold in the following form : @xmath345",
    "here we provide computational characterizations of the empirical quantiles , ranks , and depth regions for various cases of interest .",
    "suppose @xmath265 and @xmath267 satisfy caffarelli regularity conditions , so that @xmath346 and @xmath347 , with @xmath348 satisfying ( c ) .",
    "the mk empirical vector quantile maps @xmath58 and @xmath302 can then be computed with the algorithm of benamou and brenier @xcite .",
    "suppose now @xmath265 is a discrete estimator of @xmath43 and  @xmath267  an absolutely continuous distribution with convex compact support @xmath349 .",
    "let  @xmath265 be of the form @xmath350 for some integer @xmath351 , some nonnegative weights  @xmath352 such that @xmath353 , and @xmath354 .",
    "the leading example is when @xmath265 is the empirical distribution of a random sample @xmath266 drawn from @xmath43 .",
    "the mk empirical vector quantile map @xmath58 is then equal ( almost everywhere ) to the gradient of a convex map @xmath355 such that @xmath356 , i.e. , the @xmath267-almost surely unique map @xmath346 satisfying the following :    1 .",
    "@xmath357 , for lebesgue - almost all @xmath358 , 2 .",
    "@xmath359 , for each @xmath360 , 3 .",
    "@xmath355 is a convex function .",
    "the following characterization of @xmath355 specializes kantorovich duality to this discrete - continuous case ( see , e.g.,@xcite ) .",
    "there exist unique ( up to an additive constant ) weights @xmath361 such that @xmath362 satisfies conditions ( 1 ) , ( 2 ) and ( 3 ) .",
    "the function  @xmath363 is convex and minimized at @xmath364 .",
    "this lemma allows efficient computation of @xmath58 using a gradient algorithm proposed in @xcite .",
    "the map @xmath355 is piecewise affine and the empirical vector quantile @xmath58 is piecewise constant .",
    "the correspondence @xmath365 defined for each @xmath366 by @xmath367 maps @xmath368 into @xmath351 regions of a partition of @xmath87 , called a _",
    "power diagram_. the estimator @xmath302 of the mk vector rank can be computed according to formula ( [ eq : empirical q and r ] ) after computing the conjugate @xmath369 of @xmath370 via : @xmath371 the empirical depth , depth regions , and quantiles can be computed using the depth function , according to their theoretical definitions .      particularly amenable",
    "to computation is the case when both distribution estimators @xmath265 and @xmath267 are discrete with uniformly distributed mass on sets of points of the same cardinality .",
    "let @xmath372 for a set @xmath373 of points in @xmath0 and @xmath374 , for a set @xmath375 of points in @xmath0 .",
    "the restriction of the quantile map @xmath58 to @xmath376 is the bijection @xmath377 from @xmath376 onto @xmath378 and @xmath379 is its inverse .",
    "the solutions @xmath58 and @xmath302 can be computed with any optimal assignment algorithm .",
    "more generally , in the case of any two discrete estimators  @xmath265 and  @xmath267 , the problem of finding @xmath58 or @xmath302 is a linear programming problem .      whenever @xmath265 is finitely discrete , then the mk empirical depth regions and quantile contours are finite sets of points . for visualization purposes",
    "it may be helpful to transform them into nicer looking objects which are close to the original objects in terms of hausdorff distance . in the example below we used @xmath380-hulls to create approximations to the depth regions and took the boundaries of the set as a numerical approximation to the quantile contours .",
    "it may also be possible to use polygonization methods such as those in @xcite for @xmath381 and @xcite for @xmath382 .",
    "in the example illustrated in figure  2 , we use a discrete approximation @xmath267 to the spherical uniform reference distribution .",
    "figure  2 shows the mk empirical depth contours for the same banana - shaped distribution as in figure  1 . the specific construction to produce figure  2 is the following :",
    "@xmath265 is the empirical distribution of a random sample @xmath378 drawn from the banana - shaped distribution in @xmath383 , with @xmath384 ; @xmath267 is a discrete approximation to @xmath139 with mass @xmath385 on each of the points in @xmath376 .",
    "the latter is a collection of @xmath386 evenly spaced points on each of @xmath387 circles , of evenly spaced radii in @xmath388 $ ] .",
    "the sets @xmath378 and @xmath376 are matched optimally with the assignment algorithm of the _ adagio _ package in r. mk empirical depth regions are @xmath380-hulls of @xmath389 for @xmath390 values of @xmath391 ( see @xcite for a definition of @xmath380-hulls ) .",
    "the  @xmath380-hulls are computed using the _ alphahull _ package in  r , with  @xmath392 .",
    "the banana - shaped distribution considered is the distribution of the vector  @xmath393 , where  @xmath14 is uniform on  @xmath227 $ ] , @xmath394 is uniform on  @xmath395 $ ] , @xmath396 is uniform on @xmath23 $ ] , @xmath14 , @xmath396 and  @xmath394 are independent , and  @xmath397 .",
    "let @xmath84 and @xmath85 be convex , closed subsets of @xmath0 . a pair of convex potentials @xmath398 and @xmath399 is a conjugate pair over @xmath102 if , for each @xmath303 and @xmath98 , @xmath400 , \\quad \\psi^*(y ) = \\sup_{u \\in { \\mathcal{u } } } [ y^\\top u - \\psi(u)].\\ ] ]    in the sequel , we consider a fixed pair @xmath103 obeying the following condition .",
    "* let @xmath84 and @xmath85 be closed , convex subsets of @xmath0 , and @xmath165 and @xmath166 some open , non - empty sets in @xmath0 .",
    "let @xmath167 and @xmath168 form a conjugate pair over @xmath102 and possess gradients @xmath169 for all @xmath170 , and @xmath171 for all @xmath172 .",
    "the gradients @xmath173 and @xmath174 are homeomorphisms , and  @xmath175 .",
    "we also consider a sequence @xmath401 of conjugate potentials approaching @xmath103 .    *",
    "a sequence of conjugate potentials @xmath401 over @xmath102 , with @xmath402 , is such that : @xmath403 in @xmath404 pointwise in @xmath219 in a dense subset of @xmath87 and @xmath405 in @xmath404 pointwise in @xmath406 in a dense subset of @xmath101 , as @xmath288 .",
    "condition ( a ) is equivalent to requiring that either @xmath407 or @xmath408 converge pointwise over dense subsets .",
    "there is no loss of generality in stating that both converge .",
    "define the maps @xmath409 , \\quad { { \\rm r}}(y ) : = \\arg \\sup_{u \\in { \\mathcal{u } } } [ y^\\top u - \\psi(u)],\\ ] ] for each @xmath170 and @xmath172 . by the envelope theorem , @xmath410",
    "let us define , for each @xmath303 and @xmath98 , @xmath411 , \\quad { { \\rm r}}_n(y ) \\in",
    "\\arg \\sup_{u \\in { \\mathcal{u } } } [ y^\\top u - \\psi_n(u)].\\ ] ]    it is useful to note that @xmath412 where @xmath72 denotes the sub - differential of a convex function ; conversely , any pair of elements of @xmath413 and @xmath414 , respectively , could be taken as solutions to the problem ( [ define qn and rn ] ) ( by proposition 2.4 in villani @xcite ) . hence , the problem of convergence of @xmath415 and @xmath416 to  @xmath150 and @xmath417 is equivalent to the problem of convergence of subdifferentials .",
    "moreover , by rademacher s theorem , @xmath418 and  @xmath419 almost everywhere with respect to the lebesgue measure ( see , e.g. , @xcite ) , so the solutions to ( [ define qn and rn ] ) are unique almost everywhere on @xmath303 and  @xmath98 .",
    "[ lemma : ucg ] suppose that conditions  ( a ) and ( c ) hold .",
    "then , as @xmath288 , for any compact set @xmath420 and any compact set @xmath314 , @xmath421    this result appears to be new .",
    "it complements the result stated in lemma 5.4 in villani @xcite for the case @xmath422 .",
    "this result also trivially implies convergence in @xmath4 norms , @xmath423 : @xmath424 for probability laws @xmath139 on @xmath87 and @xmath43 on @xmath101 , whenever , for some @xmath425 , @xmath426 hence , the new result is stronger than available results on convergence in measure ( including @xmath4 convergence results ) in the optimal transport literature ( see , e.g. , villani  @xcite ) .",
    "the following example also shows that , in general , our result can not be strengthened to the uniform convergence over entire sets @xmath87 and @xmath101 .",
    "consider the sequence of potential maps @xmath427 \\mapsto { { \\rm i}\\kern-0.18em{\\rm r}}$ ] : @xmath428 then @xmath429 converges uniformly on @xmath23 $ ] to @xmath430 the latter potential has the gradient map  @xmath431 \\mapsto { \\mathcal{y}}_0 = [ 0,1]$ ] defined by @xmath432 .",
    "we have that @xmath433 for any compact subset @xmath339 of @xmath434 .",
    "however , the uniform convergence over the entire region @xmath23 $ ] fails , since @xmath435}|{{\\rm q}}_n(t ) - { { \\rm q}}(t)| \\geq 9 $ ] for all @xmath273 . therefore",
    ", the theorem can not be strengthened in general .",
    "we next consider the behavior of image sets of gradients defined as follows : @xmath436@xmath437 where @xmath313 and @xmath438 are compact sets , and the subsets @xmath76 and @xmath439 are understood to be non - empty .",
    "[ cor : csg ] under the conditions of the previous theorem , we have that @xmath440    [ cor : csg2 ] assume the conditions of the previous theorem . for any sequence of sets @xmath441 and @xmath442 such that  @xmath443 and @xmath444 for some sets @xmath76 and @xmath439 , we have @xmath445      we next consider the problem of convergence for potentials and transport ( vector quantile and rank ) maps arising from the kantorovich dual optimal transport problem .",
    "equip @xmath101 and @xmath87 with absolutely continuous probability measures @xmath43 and @xmath139 , respectively , and let @xmath446 we consider sequences of measures @xmath447 and @xmath448 approximating @xmath43 and @xmath139 :    * there are sequences of measures @xmath449 on @xmath101 and @xmath450 on @xmath87 , with finite total mass , that converge to @xmath43 and @xmath139 , respectively , in the topology of weak convergence : @xmath451    recall that we defined @xmath253 as a collection of conjugate potentials @xmath254 on  @xmath102 such that @xmath255 for some fixed point @xmath256 .",
    "let @xmath452 solve the kantorovich problem for the pair @xmath453 : @xmath454 also , let @xmath455 solve the kantorovich problem for the pair @xmath456 : @xmath457 it is known that solutions to these problems exist ; see , e.g. , villani @xcite .",
    "recall also that we imposed the normalization condition in the definition of @xmath253 to pin down the constants .",
    "[ theorem : uct ] suppose that the sets @xmath87 and @xmath101 are compact subsets of @xmath0 , and that the probability measures @xmath43 and @xmath139 are absolutely continuous with respect to the lebesgue measure , with @xmath307 and @xmath308 .",
    "suppose that condition ( w ) holds , and that condition ( c ) holds for a solution @xmath103 of ( [ kantorovich ] ) for the sets @xmath328 and @xmath458 defined as above .",
    "then the conclusions of theorem  [ lemma : ucg ] and corollary [ cor : csg ] and corollary [ cor : csg2 ] .",
    "[ lemma : resnick ] let @xmath78 and @xmath459 be complete separable metric spaces , with @xmath78 compact .",
    "suppose @xmath460 is continuous .",
    "then a sequence of functions @xmath461 converges to @xmath241 uniformly on  @xmath78 if and only if , for any convergent sequence @xmath462 in @xmath78 , we have that @xmath463 .    for the proof ,",
    "see , e.g. , rockafellar and wets @xcite .",
    "the proof also relies on the following convergence result , which is a consequence of theorem 7.17 in rockafellar and wets @xcite . for a point @xmath464 and a non - empty set @xmath76 in @xmath144 ,",
    "define @xmath465 .",
    "[ lemma : convex ] suppose that @xmath10 is a lower - semi - continuous convex function mapping @xmath0 to @xmath466 that attains a minimum on the set @xmath467 , where @xmath468 , and @xmath469 is a non - empty , open set in @xmath0 .",
    "let @xmath470 be a sequence of convex , lower - semi - continuous functions mapping @xmath0 to @xmath466 and such that @xmath471 pointwise in @xmath472 , where @xmath473 is a countable dense subset of @xmath0 .",
    "then any @xmath474 obeys @xmath475 and , in particular , if @xmath476 is a singleton @xmath477 , @xmath478 .",
    "we define the extension maps @xmath479 and @xmath480 mapping @xmath0 to @xmath481 @xmath482 by the convexity of @xmath407 and @xmath408 over convex , closed sets @xmath101 and @xmath87 , we have that the functions are proper upper - semi - continuous concave functions .",
    "define the extension maps  @xmath483 and @xmath484 mapping @xmath0 to @xmath481 analogously , by removing the index @xmath273 above .",
    "condition ( a ) assumes pointwise convergence of @xmath408 to @xmath162 on a dense subset of @xmath101 . by theorem 7.17 in rockafellar and wets @xcite , this implies the uniform convergence of @xmath408 to @xmath162 on any compact set @xmath485 that does not overlap with the boundary of the set @xmath486 .",
    "hence , for any sequence  @xmath487 such that @xmath488 , a compact subset of @xmath489 , and any @xmath490 , @xmath491 next , consider any @xmath492 , in which case , @xmath493 hence , @xmath494 where @xmath495 is a dense subset of @xmath0 .",
    "we apply lemma [ lemma : convex ] to conclude that @xmath496    take @xmath339 as any compact subset of @xmath489 .",
    "the above argument applies for every point  @xmath497 and every convergent sequence @xmath498 .",
    "therefore , since by assumption  ( c ) the map @xmath499 is continuous in @xmath500 , we conclude by the equivalence of the continuous and uniform convergence , lemma [ lemma : resnick ] , that @xmath501        by assumption , @xmath502 , and @xmath476 is convex and closed .",
    "let @xmath128 be an element of @xmath476 .",
    "we have that , for all @xmath503 with @xmath504 such that @xmath505 , @xmath506 where @xmath507 is convex and closed .",
    "fix an @xmath508 $ ] . by convexity of @xmath10 and @xmath509 and by theorem 7.17 in rockafellar and wets @xcite , the pointwise convergence of @xmath509 to @xmath10 on a dense subset of @xmath0 is equivalent to the uniform convergence of @xmath509 to @xmath10 on any compact set @xmath339 that does not overlap with  @xmath510 , i.e. @xmath511 .",
    "hence , @xmath512 uniformly on @xmath513 .",
    "this and ( [ g bound ] ) imply that eventually , i.e. for all @xmath514 , @xmath515 by convexity of @xmath509 , this implies that @xmath516 for all @xmath514 , which is to say that , for all @xmath514 , @xmath517 since @xmath518 can be set as small as desired , it follows that any @xmath519 is such that  @xmath520 .",
    "we have that @xmath522 where the first inequality holds by the triangle inequality , the second inequality holds by definition and by @xmath523 , and the last conclusion follows by corollary [ cor : csg ] and continuity of the map @xmath524 on @xmath500 .",
    "here we show that the set of conjugate pairs is compact in the topology of uniform convergence .",
    "first we notice that , for any pair  @xmath525 , @xmath526 with @xmath527 for @xmath528 , where we have used the fact that @xmath529 for some @xmath530 as well as compactness of @xmath101 and @xmath87 .",
    "the arzela - ascoli theorem implies that @xmath253 is relatively compact in the topology of the uniform convergence .",
    "we want to show compactness , namely that this set is also closed . for this",
    "we need to show that all uniformly convergent subsequences @xmath531 ( where @xmath532 ) have the limit point in this set : @xmath533 this is true , since uniform limits of convex functions are necessarily convex ( see @xcite ) , and since @xmath534 \\right ] \\\\",
    "& \\leq & \\limsup_{n \\in \\mathbb{n } ' } \\left [   \\sup_{y \\in { \\mathcal{y } } } [ u^\\top y - { \\varphi}^*(y ) ] + \\sup_{y \\in { \\mathcal{y } } } | { \\varphi}^*_n(y ) - { \\varphi}^*(y )",
    "|   \\right ]   =   \\sup_{y \\in { \\mathcal{y } } } [ u^\\top y - \\varphi^*(y)];\\end{aligned}\\ ] ] and @xmath534 \\right ] \\\\   & \\geq & \\liminf_{n \\in \\mathbb{n } ' } \\left [   \\sup_{y \\in { \\mathcal{y } } } [ u^\\top y - { \\varphi}^*(y ) ] - \\sup_{y \\in { \\mathcal{y } } } | { \\varphi}^*_n(y ) - { \\varphi}^*(y ) |   \\right ]   =   \\sup_{y \\in { \\mathcal{y } } } [ u^\\top y - \\varphi^*(y)].\\end{aligned}\\ ] ] analogously , @xmath535 $ ] .",
    "the claim here is that @xmath536 indeed , @xmath537 where the inequality holds by definition , and the convergence holds by @xmath538 where @xmath539 means @xmath540 , for some constant @xmath76 that does not depend on @xmath273 .",
    "moreover , by definition , @xmath541 but @xmath542      first , we observe that the solution pair @xmath103 to the limit kantorovich problem is unique on @xmath543 in the sense that any other solution @xmath254 agrees with @xmath103 on  @xmath543 . indeed , suppose that @xmath544 for some @xmath545 . by the uniform continuity of elements of @xmath253 and openness of @xmath328 , there exists a ball @xmath546 such that @xmath547 for all @xmath548 . by the normalization assumption @xmath549 , there does not exist a constant @xmath550 such that @xmath551 for all  @xmath170 , so this must imply that @xmath552 on a set @xmath553 of positive measure ( otherwise , if they disagree only on a set of measure zero , we would have @xmath554 for almost all  @xmath555 , which is a contradiction ) . however , the statement @xmath556 on a set  @xmath553 of positive lebesgue measure would contradict the fact that any solution @xmath86 or @xmath24 of the kantorovich problem must obey @xmath557 for each bounded continuous @xmath558 , i.e. that @xmath559 , established on p.72 in villani @xcite .",
    "analogous arguments apply to establish uniqueness of @xmath162 on the set @xmath458 .",
    "second , we can split @xmath560 into subsequences @xmath561 such that , for each @xmath562 , @xmath563 but by step 2 this means that @xmath564 it must be that each pair @xmath565 is the solution to the limit kantorovich problem , and by the uniqueness established above we have that @xmath566 by condition ( c ) we have that , for @xmath170 and @xmath172 : @xmath567 by ( [ unif ] ) and condition ( c ) we can invoke theorem  [ lemma : ucg ] to conclude that @xmath568 uniformly on compact subsets of @xmath328 and @xmath569 uniformly on compact subsets of  @xmath458 .",
    "the theorem , specialized to our context , reads as follows : let @xmath78 and @xmath570 be normed spaces and let @xmath571 .",
    "let @xmath572 be arbitrary subsets and @xmath573 be arbitrary maps  ( @xmath574 ) , such that for every sequence @xmath575 such that @xmath462 , along a subsequence , we have that @xmath576 , along the same subsequence .",
    "then , for arbitrary ( i.e. possibly non - measurable ) maps @xmath577 such that @xmath578 , we have that  @xmath579 .    in our case",
    "@xmath580 is a stochastic element of @xmath78 , viewed as an arbitrary map from @xmath581 to @xmath78 , and @xmath582 is a non - stochastic element of @xmath78 , where @xmath78 is the space of linear operators @xmath78 acting on the space of bounded lipschitz functions .",
    "this space can be equipped with the norm ( see notation section ) : @xmath583 moreover , @xmath578 with respect to this norm , i.e. @xmath584 then @xmath585 and @xmath586 are viewed as elements of the space@xmath587 of bounded functions mapping @xmath588 to @xmath589 , equipped with the supremum norm .",
    "the maps have the continuity property : if @xmath590 along a subsequence , then @xmath591 along the same subsequence , as established by theorem  [ lemma : ucg ] . hence conclude that @xmath592 .",
    "corollaries [ cor : ers ] and [ cor : eqd ] follow by theorem  [ theorem : empirical ] and the extended continuous mapping theorem ; and corollary [ cor : eqd2 ] follows by theorem  [ theorem : empirical ] , the extended continuous mapping theorem , and corollary  [ cor : csg2 ] .",
    "hallin , m. , paindaveine , d. , and iman , m. ( 2010 ) .",
    "multivariate quantiles and multiple - output regression quantiles : from @xmath594 optimization to halfspace depth ( with discussion ) , _ the annals of statistics _ * 38 * , 635-669 .",
    "politis , d. , romano , j. , and wolf , m. ( 1999 ) .",
    "weak convergence of dependent empirical measures with application to subsampling in function spaces , _ journal of statistical planning and inference _ * 79 * , 179 - 190 .",
    "tukey , j. w. ( 1975 ) .",
    "mathematics and the picturing of data , in _ proceedings of the international congress of mathematicians _",
    "( vancouver , b. c. , 1974 ) , vol . 2 ,",
    "montreal : canadian mathematical congress , pp .",
    "523-531 .",
    "van zwet , w.r .",
    "_ convex transformations of random variables_. mathematical centre tracts , amsterdam : mathematisch centrum .",
    "vardi , y. , and zhang , c .- h .",
    "the multivariate @xmath594-median and associated data depth , _ proceedings of the national academy of sciences _ * 97 * , 14231426 ."
  ],
  "abstract_text": [
    "<S> we propose new concepts of statistical depth , multivariate quantiles , vector quantiles and ranks , ranks , and signs , based on canonical transportation maps between a distribution of interest on @xmath0 and a reference distribution on the @xmath1-dimensional unit ball . </S>",
    "<S> the new depth concept , called _ monge - kantorovich depth _ </S>",
    "<S> , specializes to halfspace depth for @xmath2 and in the case of spherical distributions , but , for more general distributions , differs from the latter in the ability for its contours to account for non convex features of the distribution of interest . </S>",
    "<S> we propose empirical counterparts to the population versions of those monge - kantorovich depth contours , quantiles , ranks , signs , and vector quantiles and ranks , and show their consistency by establishing a uniform convergence property for empirical ( forward and reverse ) transport maps , which is the main theoretical result of this paper .     </S>"
  ]
}