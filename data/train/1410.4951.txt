{
  "article_text": [
    "monte carlo ( mc ) simulation is one of the most important numerical methods for solving statistical problems in fields such as chemistry , biology and physics . in condensed matter physics ,",
    "mc is extensively used to study the properties of many statistical models , phase transitions , and quantum many - body systems [ ] .",
    "often , besides the expectation values of certain physical quantities , one also needs the free energy of the system in thermal equilibrium .",
    "calculation of free energy is a difficult problem for traditional metropolis algorithm since partition function plays the role of the normalization constant in the thermal probability density distribution of an ensemble .    in the past three decades",
    ", various mc algorithms have been proposed to do the free energy calculation for statistical hamiltonians . for classical systems ,",
    "the frequently used methods are the histogram reweighting method [ ] , multiple histogram [ ] , transition matrix mc [ ] , entropic sampling [ ] , flat histogram method [ ] , and the wang - landau method [ ] .",
    "recently wang - landau method has been improved in different aspects [ , ] .",
    "all these methods have their respective advantages and disadvantages . for examples ,",
    "the histogram reweighting method produces the energy histogram @xmath1 at a given temperature @xmath2 and employs the reweighting method to recover the distribution at a different temperature . as is shown below , usually the canonical distribution @xmath3 is sharply peaked around @xmath4 which is @xmath5-dependent .",
    "thus the error of free energy becomes large when @xmath6 is large .",
    "for both the entropic sampling and the wang - landau method , the ensemble is created in the energy space instead of in the configuration space .",
    "this helps to obtain the density of states efficiently , but it is less convenient if one hopes to study other physical quantities in a single simulation , especially when these quantities are not simple functions of energy @xmath7 , such as the correlation function .    for quantum systems ,",
    "the calculation of free energy is also a pertinent but harder problem . in this regard ,",
    "the wang - landau algorithm has been combined with statistical series expansion method to calculate the free energy of quantum hamiltonians such as the heisenberg model [ ] .",
    "the idea of flat histogram has been applied to the diagrammatic mc method to improve the long imaginary - time results [ ] , and to calculate the grand potential of a cluster system with electron bath [ ] . however , considering that the flat - histogram method or wang - landau algorithm have not been implemented under the path integral(pi ) quantum monte carlo ( qmc ) methods such as the determinantal qmc [ ] and the continuous - time pi qmc method [ ] , which are based on the metropolis sampling in configuration space , it is still desirable to develop a free energy calculation method which can calculate free energy by the configuration space sampling .    it is the purpose of this paper to propose such a new mc algorithm that can calculate the free energy using the configuration - based sampling algorithm . the price that we have to pay is a sequential scan from low to high temperatures , or vice versa .",
    "we demonstrate the implementation of this algorithm using the ising model on square as well as on triangular lattice , for which the exact solutions are known .",
    "comparison with wang - landau method shows that both efficiency and accuracy of this method are satisfactory .",
    "the additional advantage of this method is that it is based on metropolis algorithm and hence in principle it can be extended to quantum systems within determinantal or path integral methods .",
    "in this part , we demonstrate the implementation of our method and analyse its features using the two dimensional ising model on a square lattice . for comparison purposes , here we use the equivalent hamiltonian of the two - state potts model @xmath8 here , @xmath9 is the spin degrees of freedom on site @xmath10 and it takes integer values from @xmath11 to @xmath12 .",
    "@xmath13 if @xmath14 and @xmath15 if @xmath16 .",
    "the summation is for pairs of nearest neighbour sites on a square lattice with @xmath17 geometry .",
    "this model has been studied extensively as a basic statistical model [ ] .",
    "its exact critical transition temperature is @xmath18 . in the following we use @xmath19 as the energy unit and",
    "set the boltzmann constant @xmath20 for convenience .",
    "one of the widely used mc algorithms for studying classical statistical models is the metropolis sampling in configuration space [ ] . in this algorithm ,",
    "one begins by choosing a random spin configuration @xmath21 ( here we use capital letter @xmath22 to denote the spin configuration of the whole lattice ) , and update the configuration @xmath23 according to a given proposal probability @xmath24 and an accepting probability @xmath25 .",
    "the transition probability @xmath26 must satisfy the detailed balance condition @xmath27 to guarantee that the resulting markovian chain has the target distribution @xmath28 in the equilibrium limit . for the thermodynamical calculation",
    ", we use the bolzmann distribution as our target distribution , @xmath29 @xmath30 is the partition function @xmath31 . here",
    "@xmath32 is the inverse temperature .",
    "after the markovian chain reaches equilibrium , sampling on this chain can produce the required statistical averages .    .",
    "( a ) from left to right , @xmath33 ; ( b ) from left to right , @xmath34 .",
    "inset of ( a ) : the peak position as function of @xmath5.,width=652,height=432 ]    however , the free energy @xmath35 can not be calculated directly , because the partition function @xmath30 is a normalization factor of the probability distribution @xmath36 and hence can not be treated as a statistical average . to calculate @xmath37 ,",
    "usually one either employs the concept of energy histogram [ ] within mc method , the maximum entropy method [ ] , or by numerical integration over the derivative of free energies [ ] . in the following , we propose a new method which combines the idea of energy histogram and the configuration - space sampling to calculate the free energy over full temperature range .    in the metropolis algorithm ,",
    "the energy probability distribution produced by the markovian chain is @xmath38 where @xmath39 is the degeneracy of energy level @xmath7 of the given hamiltonian .",
    "@xmath40 can be estimated approximately from the energy histogram of the markovian chain , that is , @xmath41 here @xmath42 is the number of spin configurations with energy @xmath7 and @xmath43 is the total number of sampled configurations in the markovian chain .",
    "the precision of the above estimation increases as @xmath43 increases . in the limit @xmath44 , we get @xmath45 , and hence @xmath46.\\ ] ] in principle , @xmath0 can be calculated from the values of @xmath39 and @xmath42 at any given energy @xmath7 . for a large variety of classical hamiltonians ,",
    "the ground state degeneracy @xmath47 is easy to obtain . for the ising model on square lattice , for an example , @xmath48 .",
    "@xmath0 is thus in principle obtainable from the ground state energy histogram @xmath49 .    in practice , however , the above simple scheme does not work at arbitrary @xmath5 because the energy distribution @xmath40 is sharply peaked at an energy @xmath50 ( or at many different @xmath7 s for some models ) which is an increasing function of @xmath5 . in fig.1 , we show @xmath51 for the ising model on the square lattice with @xmath52 , at different temperatures . here",
    "@xmath7 is the energy per site and @xmath53 .",
    "@xmath40 is plotted in logarithmic scale and it decays very fast away from the peak position . at high temperatures , @xmath40 is peaked at high energy and @xmath54 is so small that it is impossible to calculate it accurately from @xmath55 , because at high temperatures the latter is practically zero for finite @xmath43 .",
    "one way to overcome the above difficulty is to use eq.(3 ) at a different temperature @xmath56 , @xmath57 using the fact that @xmath39 is @xmath5-independent , the ratio of eq.(6 ) and eq.(3 ) gives @xmath58 which can be used to evaluate the ratio of partition function at @xmath5 and @xmath56 as @xmath59 this strategy works as long as for some energy @xmath7 , @xmath40 can be measured accurately both at @xmath5 and @xmath56 .",
    "it is the basis for the histogram reweighting method [ ] and the multiple histogram method [ ] to produce the free energy @xmath37 up to a constant factor .",
    "this constant factor can be further fixed by using the infinite temperature partition function @xmath60 [ ] or the integral of density of states @xmath61 ( ref .  ) , both of which are equal to the total number of configurations .    here",
    ", we will take a different strategy , which is based on eq.(3 ) at the same temperature but at a different energy @xmath62 , @xmath63 . from the ratio of it and eq.(3 )",
    "one obtains @xmath64 this means that the knowledge of @xmath39 can be transferred from one energy to all @xmath65 , where @xmath66 is the energy window in which @xmath67 is reasonably large . as shown in fig.1 , the center of this window increases with temperature @xmath5 .    for those hamiltonians where the ground state degeneracy @xmath68 is known , to obtain @xmath39 at higher energies , we need to increase @xmath5 from a small value in such small steps that the energy windows @xmath69 and @xmath70 of adjacent temperatures @xmath71 and @xmath72 have significant overlap .",
    "suppose one knows @xmath73 for a certain energy @xmath74 .",
    "one does the mc calculation at @xmath71 to produce the histogram @xmath67 for each @xmath75 . using the known @xmath73 value ,",
    "@xmath76 is obtained from eq.(5 ) and @xmath39 for each @xmath75 is obtained from eq.(9 ) . for the next temperature @xmath72 ,",
    "one calculate the histogram @xmath67 for each @xmath77 .",
    "we choose an energy @xmath78 . using @xmath79 value obtained in the @xmath71 calculation and @xmath80",
    ", @xmath81 is obtained from eq.(5 ) and @xmath39 for each @xmath77 is obtained from eq.(9 ) .",
    "this process goes on until the desired high temperature is reached . in this way ,",
    "@xmath39 for larger and larger energies and @xmath0 at successively higher temperatures can be obtained .",
    "we call this scheme the upward temperature scan",
    ".    one could also start from the high temperature limit @xmath82 , and employ the direct sampling without boltzmann factor to produce @xmath83 for energies @xmath84 . by decreasing @xmath5 from @xmath82 step by step",
    ", one could reach low @xmath5 and calculate @xmath0 for all temperatures .",
    "this scheme is called downward temperature scan .    in the implementation of the above algorithm ,",
    "an important technical issue is how to select the common energy point @xmath85 . in our calculation , we use the crossing energy @xmath86 , which is determined by @xmath87 .",
    "it is the energy where the @xmath40 curves of adjacent temperatures @xmath71 and @xmath72 crosses .",
    "the @xmath86 value chosen in this way has the largest value @xmath67 for both @xmath71 and @xmath72 , hence guarantees the optimal precision .",
    "after mc calculation at @xmath88 ( @xmath82 ) is carried out , the rest calculations are done at equal distance temperatures @xmath89 ( @xmath90 ) ( @xmath91 ) for upward ( downward ) @xmath5 scan . for the upward scan , we use @xmath92 and for downward scan , @xmath93 .",
    "we carefully control the interval @xmath94 to reach the optimal precision .",
    "a too large @xmath94 will lead to a small @xmath95 and relatively large error in @xmath96 .",
    "if @xmath94 is too small , the number of temperatures required in scan from @xmath2 to the final @xmath5 will increase .",
    "it leads to longer calculation time and larger accumulated error in the @xmath39 transfer .",
    "therefore , a suitable @xmath94 should be found by testing calculations .",
    "this issue is discussed in below ( see fig.6 ) .      in our benchmark calculation for the ising model on a square lattice",
    ", we use the cluster update scheme of wolff [ ] .",
    "it has a relatively high updating speed and weak critical slowing down near the critical temperature .",
    "the free energy calculation algorithm described above can also be used with local update algorithm without modification . in fig.1",
    ", we show the normalized energy probability distribution obtained from the markovian chain , for @xmath97 ( in fig.1(a ) ) and for relatively high temperatures @xmath98 ( in fig.1(b ) ) . here",
    "@xmath7 is the energy per site . at low @xmath5",
    ", @xmath99 has a peak at @xmath100 and its width broadens with increasing @xmath5 .",
    "while for @xmath98 , the peak position begins to increase with temperature and its width gets saturated .",
    "the peak position as a function of @xmath5 is shown in the inset of fig.1(a ) .",
    "it moves from @xmath101 at @xmath88 to @xmath102 in large @xmath5 limit .",
    "note that the sharp increase occurs near @xmath103 , close to the @xmath104 of order - disorder phase transition of this system in the thermodynamic limit [ ] .",
    "significant overlap in the peak energy windows for adjacent temperatures @xmath71 and @xmath72 is crucial for our algorithm to work . in this work , we use a uniform temperature mesh and choose @xmath105 such that the overlap of the peaks are large enough to guarantee the precision .    , calculated from present method with upward @xmath5 scan ( black dots ) and from the exact solution ( red line ) for ( a ) @xmath106 and ( b ) @xmath107 , respectively . both are obtained using @xmath108 .",
    "the dots and the line are indistinguishable in the present scale .",
    "inset : standard variance @xmath109 ( dots ) and the numerical error @xmath110 ( triangles ) of @xmath111 .",
    "@xmath109 is estimated from @xmath112 independent markov chains.,width=460,height=355 ]    in fig.2(a ) , the free energy per site obtained from the upward @xmath5 scan for @xmath106 is shown .",
    "it is compared with the exact result [ ] . except stated otherwise",
    ", we use @xmath108 samples to calculate @xmath37 for each temperature @xmath71 . with @xmath105 ,",
    "producing @xmath0 in the range @xmath113 , requires @xmath114 temperature values @xmath71 . in fig.2 ,",
    "our results are indistinguishable from the exact curve on the scale of the figure . in the inset , the standard variance @xmath115 is shown as functions of @xmath5 . for each temperature",
    ", @xmath109 is measured from @xmath112 independent data of @xmath37 , each of which is produced by @xmath116 sampling . the actual error @xmath117 has same order of magnitude as @xmath109 and it is always less than @xmath118 .",
    "both quantities are small in @xmath119 and increase linearly with temperature in @xmath120 .",
    "@xmath121 is close to the order - disorder transition occurring at @xmath122 in the thermodynamic limit .",
    "the linear increase of error with @xmath5 in the disordered phase is related to the constant relative standard variance @xmath123 of the partition function , as discussed in fig.3 below . for the highest temperature",
    "that we study @xmath124 , the actual error is smaller than @xmath125 .",
    "the relative error @xmath126 first increases with @xmath5 and then saturates to @xmath127 in @xmath98 .",
    "the same comparison is made for larger lattice size @xmath107 in fig.2(b ) .",
    "the results are similar to @xmath106 and the agreement between mc and the exact result is excellent .",
    "the main difference from the @xmath106 case is that the standard variance @xmath109 is larger than the actual error @xmath110 . as temperature increases ,",
    "an abrupt increase of @xmath109 and @xmath110 occurs at @xmath128 and the linear @xmath5 behavior occurs at @xmath129 .",
    "these features are same as @xmath106 case . for the relative error , a similar saturation in @xmath126",
    "is observed in high temperature to about @xmath130 .      in fig.3(a ) , we show @xmath37 per site as function of @xmath5 obtained from the downward @xmath5 scan method , for the same ising model on the square lattice . it is noted that the numerical error obtained from downward scan is of the same order as the upward scan in fig.2 .",
    "compared to fig.2 , the @xmath131 and @xmath132 have a sharp peak around @xmath133 , instead of a kink . in order to understand the linear @xmath5-dependence of the errors in fig.2 and its difference with fig.3(a ) , in fig.3(b ) , we show the relative standard variance of the partition function @xmath123 , which is related to the variance of @xmath37 by @xmath134 .",
    "it is seen that for the upward @xmath5 scan , @xmath135 surges at @xmath104 by one magnitude , from smaller than @xmath136 below @xmath104 to about @xmath137 above @xmath104 .",
    "further increasing temperature it does not change much . for the downward @xmath5 scan ,",
    "@xmath135 is small for @xmath138 and surges at @xmath104 to about @xmath137 .",
    "it stays at this value to @xmath88 . clearly , in both cases , the transfer error of @xmath39 from one @xmath7 to another is largest around @xmath104 . as shown in the inset of fig.1(a ) , the peak position in @xmath40 curve moves fastest near @xmath133 . for a uniform temperature mesh and constant peak width ,",
    "the overlap of @xmath40 is therefore smallest for @xmath71 and @xmath72 close to @xmath104 , leading to the largest accumulation of error in @xmath39 .",
    "such behavior of @xmath135 as a function of @xmath5 translates into the the linear behavior of @xmath139 for @xmath5 away from @xmath104 and the kink or the sharp peak for @xmath5 close to @xmath104 , as shown in the insets of fig.2 and fig.3(a ) .    ,",
    "calculated from the downward @xmath5 scan ( black dots ) and from the exact solution ( red line ) for @xmath107 square lattice .",
    "it is obtained using @xmath108 .",
    "the dots and the line are indistinguishable in the present scale .",
    "inset : the standard variance @xmath109 and the actual error @xmath110 as functions of @xmath5 .",
    "( b ) the relative standard variance @xmath140 of the partition function @xmath30 , obtained from the upward @xmath5 scan ( circles , right arrow ) and the downward @xmath5 scan ( squares , left arrow ) , respectively .",
    "they are estimated from @xmath112 independent markov chains.,width=576,height=451 ]      to show that our method works also for other systems , especially the frustrated system , we apply the downward temperature scan to the ising model on a triangular lattice .",
    "this system has been solved exactly [ ] .",
    "the frustration induces huge low energy degeneracy and makes this system particular interesting .    in our calculation",
    ", we consider a @xmath17 square lattice with the nearest neighbour coupling as well as the next nearest neighbour coupling in the @xmath141 direction .",
    "both couplings are antiferromagnetic .",
    "the hamiltonian is the same as eq.(1 ) , but with @xmath142 .",
    "open boundary condition is used . in fig.4(a ) , @xmath37 per site is shown as a function of @xmath5 . compared to the square lattice case , except for the similarity in the shape of curve , there are two important differences .",
    "one is that in the low temperature limit , @xmath143 approaches @xmath144 instead of @xmath145 as in the square lattice case .",
    "this shows that frustration increase the free energy of the spins .",
    "the second difference is that @xmath0 is more smooth and there is no transition point associated with a finite temperature phase transition .",
    "this is consistent with the fact that there is no finite temperature transition in the triangular lattice ising model [ ] . in the inset of fig.4(a ) , the variance of @xmath37 decreases smoothly as @xmath5 is lowered and increases sharply at very low temperatures .",
    "it remains to be elucidated whether this behavior is related to the singular ground state correlation of the ising model on a triangular lattice [ ] .    due to the difference in hamiltonian definition",
    ", it is difficult to compare our mc free energy @xmath0 with the exact result in ref .  .",
    "in fig.4(b ) , we show the entropy per site @xmath146 as functions of @xmath5 for various lattice size @xmath147 and @xmath148 .",
    "it is calculated from the energy @xmath149 and @xmath37 via @xmath150 . in the high temperature limit",
    ", @xmath151 approaches @xmath152 ( not shown ) .",
    "in the zero temperature limit , our results for system @xmath153 and @xmath154 from exact enumeration shows that @xmath155 , being consistent with the observed two fold degeneracy in the ground state . however , for a low but finite temperature , entropy increases with @xmath156 , as shown in fig.4(b ) . for @xmath52 , entropy approaches @xmath157 at @xmath158 , the lowest temperature that we study .",
    "this value is already very close to the exact @xmath159 in the thermodynamic limit [ ] . this supports the reliability of our calculation of free energy for this system .",
    "note that for a given @xmath156 , the error bar increases with lowering temperature decreases mainly due to the sharp increase of error in @xmath111 in downward t - scan . for a fixed temperature , the error bar decreases with increasing @xmath156 because of the @xmath160 factor , showing that our method is robust for large systems .",
    "triangular lattice as function of @xmath5 , calculated from downward @xmath5 scan .",
    "it is obtained using @xmath108 .",
    "inset : the standard variance @xmath109 as a function of @xmath5 .",
    "( b ) the entropy per site as function of @xmath5 from downward @xmath5 scan .",
    "the dashed line is the exact value @xmath161 [ ] .",
    ", width=556,height=441 ]",
    "and the numerical error @xmath110 of @xmath37 as functions of linear size of the lattice @xmath156 .",
    "inset : full width at half maximum of @xmath40 curve as a function of @xmath156 .",
    "other parameters are @xmath162 and @xmath108 .",
    "@xmath109 is estimated from @xmath112 independent markov chains.,width=624,height=432 ]     of @xmath37 at @xmath162 as functions of @xmath43 for various @xmath94 values .",
    "@xmath109 is estimated from @xmath112 independent markov chains for @xmath52 lattice .",
    "the solid lines lines are power law fit of @xmath163 with an average @xmath164 .",
    "the inset shows @xmath109 as functions of @xmath94 for different @xmath43 values.,width=403,height=288 ]    in this section , we discuss the calculation error of the free energy and compare it with the wang - landau s algorithm . to see the dependence of error on system size @xmath156 , sampling number @xmath43 , and the temperature mesh @xmath94",
    ", we take the data from upward @xmath5 scan for square lattice ising model with @xmath165 .",
    "first , we present the @xmath156-dependences of @xmath109 and @xmath110 in fig.5 .",
    "it is seen that for all the calculated size @xmath166 , @xmath109 and @xmath110 are on the same order , all smaller than @xmath167 .",
    "this shows that the efficiency of our algorithm does not deteriorate with increasing @xmath156 , at least for @xmath168 .",
    "the relative magnitude of @xmath109 and @xmath110 may vary for different @xmath156 s , but the actual error @xmath110 is always within @xmath118 . in the inset of fig.5 , we show the full width at half maximum of @xmath40 as a function of @xmath156 at @xmath124 . it is observed that the peak width scales as @xmath169 .",
    "this reminds us that for very large @xmath156 , the @xmath40 curves will be very sharp and we have to use a denser @xmath5-mesh . at @xmath107 and @xmath170 , however , the actual effective peak width is of the same order as the peak distance even in the worst case of vicinity of @xmath104 .",
    "therefore , we can still reach similar precision as for smaller systems .",
    "for even larger size , @xmath94 needs to be scaled as @xmath169 to maintain the balance of peak width and peak distance , and thus maintain the calculation precision .    in fig.6",
    ", we show the standard variance @xmath109 as functions of sampling number @xmath43 for various @xmath94 values .",
    "our results on @xmath52 square lattice shows that @xmath171 with the average @xmath172 , close to the expected @xmath173 from the central limit theorem . for fixed @xmath43",
    ", @xmath109 has a weak dependence on @xmath94 in the range @xmath174 . as shown in the inset of fig.6",
    ", @xmath109 is approximately a parabolic function of @xmath94 , with the minimum reached at a @xmath43-dependent @xmath94 . for all @xmath43 values we used , we find that the smallest error is reached at @xmath94 values around @xmath175 .",
    "we make quantitative comparison with wang and landau s results [ ] , although this method may not be the most accurate one of free energy calculation [ ] .",
    "we find that when scaled to the same @xmath43 values , our result of @xmath0 has an error about one magnitude larger than that in ref .. simple optimization of our method can reduced the error significantly , such as using denser t - mesh near @xmath104 and sparser one away @xmath104 , or using upward t - scan for @xmath176 and downward t - scan for @xmath138 .    unlike the wang - landau algorithm which generates random walks in energy space , our algorithm samples directly in the configuration space . as a result , this method could be fitted into certain mc simulation of quantum systems . in the pi qmc [ ] and the determinantal qmc [ ] methods ,",
    "the partition function of a given quantum hamiltonian is expressed by the summation over configurations of classical auxiliary fields .",
    "the proposed algorithm can then be used to calculate @xmath0 , using the same markovian chain as used for evaluating general expectation values .",
    "one example of the application of @xmath0 appears in the study of the mott metal - insulator transition [ ] in the half - filled hubbard model using the dynamical mean - field theory ( dmft ) [ ] , which is exact in infinite spatial dimensions .",
    "the transition from the fermi liquid state in small @xmath149 regime into the mott insulator in large @xmath149 regime was found to be a special second order phase transition at @xmath88 and a first order one at @xmath177 . to determine the actual transition line at @xmath177",
    ", one needs to compare the free energy of the two coexisting phases within the two spinodal lines . within dmft",
    ", this task is reduced to the evaluation of free energy of the effective anderson impurity model [ ] .",
    "this proves to be a difficult problem for qmc methods such as the hirsch - fye algorithm [ ] .",
    "recently , the grand potential of the cluster problem is calculated by wang - landau method combined with the continuous time qmc [ ] , and it is used to calculate the grand potential of lattice model within cluster dynamical mean - field theory .",
    "it is an interesting topic to apply our algorithm in various qmc methods to handle similar problems .",
    "work in this direction is under progress .",
    "we are grateful to the helpful discussions with prof .",
    "you - jin deng .",
    "this work is supported by 973 program of china ( 2012cb921704 ) , nsfc grant ( 11374362 ) , fundamental research funds for the central universities , and the research funds of renmin university of china ."
  ],
  "abstract_text": [
    "<S> we propose a new monte carlo algorithm for the free energy calculation based on configuration space sampling . </S>",
    "<S> upward or downward temperature scan can be used to produce @xmath0 . </S>",
    "<S> we implement this algorithm for ising model on square lattice and on triangular lattice . </S>",
    "<S> comparison with the exact free energy shows an excellent agreement . </S>",
    "<S> we analyse the properties of this algorithm and compare it with wang - landau algorithm which samples in energy space . </S>",
    "<S> this method is applicable to general classical statistical models . </S>",
    "<S> the possibility of extending it to quantum systems is discussed . </S>"
  ]
}