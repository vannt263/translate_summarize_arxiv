{
  "article_text": [
    "estimation of correlation functions from a set of points is a classical problem of spatial statistics .",
    "the two - point correlation functions are the most widely used , but there is an increasing interest in estimating higher order correlation functions as well .",
    "a new class of estimators was introduced in astrophysics @xcite which pertains to most methods currently applied to data sets of galaxy positions .",
    "we present the rigorous calculation of the variances of these new estimators for poisson and binomial point processes .",
    "it will be shown in the next sections that for these processes the estimators have smaller variance than any estimator previously used for the same statistics . while the results are completely general , they were motivated by future astrophysical applications , therefore all the examples will be taken from there .",
    "higher order correlation functions from galaxy catalogs are routinely estimated since the 70 s . with a new generation of galaxy catalogs coming on line in the next five years , understanding the estimators",
    "is an important and timely problem .",
    "a unique feature of spatial statistics is that errors of a measurement are often dominated by geometrical terms , like edge effects @xcite .",
    "thus ever since correlation functions were estimated , corrections for edge effects have played a central role .",
    "the estimators for correlation functions in the astrophysical literature is reviewed in @xcite , here we only quote a few selected additional references @xcite .",
    "it is generally accepted that the most efficient estimator for the two - point function is that of @xcite , or its relative @xcite .",
    "the new estimator can be approximated in the continuum limit ( achieved when the number density of data points @xmath2 ) as @xmath3 , where @xmath4 denotes ensemble average , and @xmath5 is the fluctuation of the continuous ( galaxy ) density field @xmath6 .",
    "it is defined as @xmath7 , thus @xmath8 .",
    "the monte carlo representation of this estimator is often written symbolically as @xmath9 , with @xmath10 , @xmath11 , and @xmath12 representing the respective pair counts .",
    "the important point is that the above estimator contains only the most necessary terms in the continuous limit , while all others , such as @xmath13 , have extra terms .",
    "these extra terms do not affect the ensemble average of the unbiased estimator , but increase the variance .",
    "the deceptively simple look of the second estimator in terms of @xmath14 and @xmath15 was the reason for its popularity .",
    "ripley @xcite has discussed extensively the variance of second order estimators for poisson and binomial point processes .",
    "he has shown , that the @xmath16term in the variance of the simple estimator , @xmath17 , is proportional to @xmath18 , the perimeter for a two dimensional domain .",
    "this implies that the effect is due to inadequate edge corrections , in agreement with hewett s @xcite suggestion .",
    "the subtraction of the appropriate @xmath11 terms is equivalent to an edge correction .",
    "the effect of the extra terms on the variance is even more pronounced for the higher order functions , since there will be a lot more terms arising through various combinatorial expressions .",
    "we proposed intuitively @xcite that the obvious generalization for higher order correlations is to create higher order equivalents of the estimator @xcite . with @xmath19",
    "this corresponds to @xmath20 . in symbolic notation",
    ", this estimator can be written as @xmath21 this corresponds to the monte - carlo approximation of the continuum limit of the @xmath22-point correlation function of _ fluctuations _ ; the exact meaning is discussed later .",
    "the most significant result is that the correlations of the fluctuations automatically correct for edge effects for poisson and binomial point processes .",
    "different approaches to edge effects exist ; for a review see @xcite .",
    "it remains to be seen whether these geometrically motivated estimators , or their generalization for higher order @xcite fare better than the @xcite estimator , or the related estimator introduced by @xcite .",
    "the main goal of this article is to rigorously derive the variance of the estimator for poisson and binomial processes .",
    "the next section presents the analytic calculation of the variance for arbitrary @xmath22 .",
    "section 3 compares the second order estimator with that of the related ripley s @xmath23 function .",
    "the last section summarizes the results .",
    "many interesting statistics , such as the @xmath22-point correlation functions and their fourier analogs , can be formulated as functions over @xmath22 points from the catalog .",
    "the covariance of a pair of such estimators will be calculated for poisson and binomial point processes .",
    "they correspond to the cases , where the number of detected objects is varied or fixed a priori .",
    "the general case , where correlations are non - negligible is left for future work .",
    "the following calculations heavily rely on the elegant formalism outlined in ripley @xcite , which can be consulted for details .",
    "let @xmath14 be a catalog of data points to be analyzed , and @xmath15 randomly generated over the same area , with averages @xmath24 , and @xmath6 respectively .",
    "the role of @xmath15 is to perform a monte carlo integration compensating for edge effects , therefore eventually the limit @xmath25 will be taken .",
    "@xmath24 on the other hand is assumed to be externally estimated with arbitrary precision .",
    "we also assume that the correlations in the point process are weak , i.e. we operate in the poisson limit .",
    "let us define symbolically an estimator @xmath26 , with @xmath27 for a function @xmath28 symmetric in its arguments @xmath29 with @xmath30 .",
    "for example for the two point correlation function @xmath31 $ ] , where @xmath32 is the distance between the two points , and @xmath33 $ ] equals @xmath34 when @xmath35 holds , @xmath36 otherwise .",
    "ensemble averages can be estimated via factorial moment measures , @xmath37 @xcite . in the poisson limit @xmath38 , where @xmath39 is the @xmath40 dimensional lebesgue measure .",
    "the general covariance of a pair of estimators is @xmath41 with @xmath42 , and @xmath43 throughout the paper we use the convention that @xmath44 is nonzero only for @xmath45 , and @xmath46 . here",
    "@xmath47 and @xmath48 denote two different functions , for instance corresponding to two radial bins .",
    "the expression simply describes the fact that out of the @xmath49 and @xmath50 different data points in @xmath14 we have an @xmath51-fold degeneracy , as well as a @xmath52-fold degeneracy in the random points drawn from @xmath15 .",
    "for each of these configurations the geometric phase - space @xmath53 is different , and we sum their contributions .",
    "the dependence of @xmath54 on @xmath55 , and @xmath22 is not noted for convenience , but they will be assumed throughout the paper .",
    "an estimator for the generalized @xmath22-point correlation function is @xmath56 where @xmath57 ( without subscript ) .",
    "this definition can be expressed as @xmath58 , where @xmath59 means normalization with @xmath60 respectively . in this symbolic @xmath22th power ,",
    "each factor is evaluated at a different point .",
    "simple calculation in the limit of zero correlations yields @xmath61 .",
    "the asymptotic covariance between two estimators of the above form for a poisson point process in the limit of @xmath62 is @xmath63    _ proof .",
    "_ according to eq .",
    "[ eq : cov ] the covariance can be written as @xmath64 in the interesting limit , where @xmath65 only @xmath66 survives . changing the order of summation yields @xmath67 with @xmath68 this latter can be identified as the coefficients of @xmath69 , therefore @xmath70 .",
    "this in turn proves the theorem noting that @xmath71 .",
    "this formula represents both variance and covariance depending on whether in the definition of @xmath72 the implicit indices @xmath73 and @xmath74 are equal or not .",
    "while in the poisson model the total number of points in the domain can vary , it is fixed in the binomial model .",
    "this latter case corresponds to surveys , that detect a certain number of galaxies , and use that to estimate the mean density as well . in a sense , this would be the conditional estimator of the correlations given the number of galaxies . the normalization of the estimator changes slightly : @xmath75 , where @xmath76 is the total number of objects in the survey , and @xmath77 is the @xmath51-th falling factorial .",
    "this renders the definition of the estimator for binomial process as @xmath78 where @xmath79 is the number of points in the auxiliary random process @xmath15 .    for a binomial process",
    "the factorial moment measure is @xmath80 , with @xmath81 , the volume of the survey .",
    "this fact enables the proof of the following theorem .",
    "the asymptotic covariance of two estimators for a binomial point process in the limit of @xmath82 is @xmath83    _ proof .",
    "_ first it is convenient to prove the following lemma    for all possible integer values of @xmath84 , and @xmath51 @xmath85 where the summation is over all possible values of @xmath86 and @xmath87 .",
    "_ it follows by induction over @xmath22 . for @xmath88",
    "it is true , since @xmath89 are the only possible values .",
    "thus @xmath90 for any @xmath76 and @xmath51 .",
    "assume it is true for a particular @xmath22 for any @xmath76 and @xmath51 .",
    "then for @xmath91 @xmath92 by introducing @xmath93 , @xmath94 , and @xmath95 this reads @xmath96 which is true by induction .    now to prove the theorem consider the equation for the covariance using the appropriate factorial moment measure for binomial point process .",
    "after @xmath82 @xmath97 applying the lemma for each @xmath51 separately , the theorem is proven .",
    "@xmath98    for @xmath99",
    "the theorem coincides with @xcite , taking into account that @xmath100 .",
    "for practical applications the function @xmath28 has to be specified . for instance",
    ", @xmath101 when the @xmath22-tuplet satisfies a certain geometry ( with a suitable bin width ) , and @xmath36 otherwise yields the total ( or disconnected ) @xmath22-point correlations of the fluctuations of the process .",
    "see @xcite for detailed discussion of possible choices for the function @xmath28 to render popular statistics for the distribution of galaxies , such as power spectra , cumulant correlators , etc . here",
    "we concentrate on the comparison with other second order estimators .",
    "the number of neighbors from a point within a distance of @xmath102 is defined as @xmath103 @xcite .",
    "a family of estimators denoted by @xmath104 was introduced @xcite with subtle differences in edge correction .",
    "it was found that ripley s @xmath1 has the smallest variance of all .",
    "similar conclusions were reached in a numerical setting motivated by potential astrophysical applications @xcite .",
    "the difference between these estimators and ours is twofold : first , the normalization is different , second , they estimate the moments of the full point process while @xmath105 deals with the moments of the _ fluctuations_. the former point is trivial , while the latter is crucial , as shown later . when @xmath106 is used to extract the ( differential ) two - point correlation function ,",
    "the connection with ripley s cumulative @xmath23 can be expressed as @xmath107 .",
    "note that in astrophysics the prevailing choice _ is _",
    "@xmath108 , and @xmath23 for the most part would be estimated for the purpose of eventually obtaining @xmath108 from it .",
    "nevertheless , in other disciplines , or perhaps even for certain aspects of astrophysics , @xmath23 could be more advantageous .",
    "next we show that @xmath106 has smaller variance than any of the @xmath109 . for a pair - estimator @xmath110 the variance for a poisson process",
    "can be expressed in a quite general fashion . using the notation of the previous section ,",
    "the variance is @xmath111 @xcite .",
    "ripley has derived an approximation of this formula for the `` naive '' estimator @xmath112 , @xmath113 , $ ] where @xmath73 is the area of the two - dimensional domain , and @xmath18 is its perimeter .    in order to compare the variance @xmath106 and @xmath114 ( @xmath0 up to normalization ) , we scale @xmath114 by @xmath115 @xmath116 the poisson terms in the number of pairs , @xmath117 , are identical , while the @xmath118 terms are missing from the variance of @xmath106 .",
    "the latter can be appreciable when @xmath24 is small for the estimator @xmath0 based on @xmath119 .",
    "the most clever estimators of @xmath23 , such as ripley s @xmath1 , suppress this term considerably , nevertheless it is always present .",
    "e.g. , the variance of @xmath1 for a poisson process is @xcite @xmath120 , $ ]    in general for any @xmath22 , all contributions @xmath121 ) , @xmath122 , exactly cancel for @xmath105 . since terms higher than @xmath123 are absent ,",
    "the asymptotic behavior of our estimator is optimal : the only possible improvement for poisson ( or binomial ) processes is perhaps to decrease the multiplicative factor .",
    "in fact @xmath1 suppresses the @xmath124 term at the expense of boosting the coefficient of @xmath125 compared to @xmath0 . in contrast , for @xmath106 no such boost is present according to equation  [ eq : varcompare ] , the coefficients of the poisson term are identical to that of the @xmath0 estimator .",
    "this suggests that the estimator @xmath105 is probably close to optimal for poisson ( and binomial ) processes .",
    "we conjecture that this is approximately true for many correlated point processes as well , although for extreme cases , such a line segment process , a small bias was noted by the numerical investigations of @xcite for both @xmath106 , and for other estimators related to the @xmath23 function .",
    "the intuitive meaning of the results for binomial process is clear from theorem 2 . :",
    "the variance of the estimators is @xmath126 , i.e. poisson in the number of @xmath22-tuplets , with multiplicative factors depending on the available geometric phase space . for the poisson process ,",
    "theorem 1 .",
    "is identical up to discreteness effects : it is inversely proportional to the probability density of finding @xmath22-points in the domain , @xmath127 .",
    "our approach to suppressing the offending non - poisson terms involves an auxiliary poisson process ( @xmath15 ) , for which the average density is assumed to be infinity @xmath62 .",
    "the limit is not possible in practice , therefore it is desirable to evaluate the speed of convergence . a calculation analogous to the proof of theorem 1 .",
    "shows that @xmath128 this generalization of theorem 1",
    ". clearly shows that for a finite auxiliary poisson process",
    "@xmath15 , there is indeed a term with @xmath129 , but suppressed by a large factor .",
    "for instance , the relative non - poisson correction is @xmath130 for @xmath131 , giving less than a percent contamination when the auxiliary process is more than fifty times the original process to be measured .",
    "this is fairly convenient , since , unlike for the original process , we have full control over the artificially introduced process . note that the above considerations assume exact knowledge of the average count @xmath24 , thus no conditioning on the number of points is assumed .    for a binomial process",
    "the argument is exactly analogous to the previous one , therefore we only outline it briefly . the variance for a general estimator",
    "@xmath119 is @xcite @xmath132 .",
    "this is to be compared with theorem 2 .",
    "@xmath133/s^2n(n-1)$ ] ( replacing @xmath81 with @xmath73 for two dimensions ) .",
    "again @xmath134 has to be considered because of the normalization .",
    "the first two terms in the previous equation will yield @xmath135 terms , while the variance of @xmath106 is again poisson in terms of the number of pairs .",
    "finally , the convergence properties are expected to be similar to the poisson process , although we have not performed the calculations .",
    "it is worth to emphasize again that , while both are two - point measures , @xmath108 and @xmath23 are slightly different objects . in astrophysics",
    "@xmath108 is the desired quantity , but in some cases @xmath23 might be more advantageous ; then ripley s @xmath1 is still the preferred estimator .",
    "clearly , these findings remain true for @xmath136 as well .",
    "in summary we have calculated the variance of a new class of estimators @xmath105 for the @xmath22-point correlation functions for poisson and binomial point processes .",
    "the results were compared with variances concerning a different class of estimators based on the @xmath23 function .",
    "the main difference is that @xmath105 estimates the @xmath22-point correlation function of the fluctuations of the point process , while @xmath104 estimate the ( cumulative ) moments of the full point process .",
    "this property apparently renders the edge effect correction in @xmath105 exact , leaving only the poissonian contribution to the variance in terms of @xmath22-tuplets , i.e. terms @xmath137 , or @xmath138 for poisson and binomial processes , respectively .",
    "all lower order terms , dominating for sparse processes , exactly cancel .",
    "this is not true for any of the estimators for @xmath23 , although the best ones achieve a significant suppression of the offending non - poisson terms at the price of boosting the constant factor multiplying the poisson terms with respect to @xmath0 , the naive estimator .",
    "the speed of convergence was calculated for the new estimator @xmath105 , which assumed an auxiliary poisson process @xmath15 , with the average @xmath62 .",
    "the leading order non - poisson term in the variance was found to be suppressed by a large factor @xmath139 , thus the convergence is controllable in practice when @xmath6 is finite .",
    "davis , m. , & peebles , p.j.e .",
    "1983 , , 267,465 daley , d.j .",
    ", & vere - jones , d. 1972 in _ stochastic point processes _ , ed .",
    "lewis , p.a.w .",
    "( new york : wiley ) doguwa , s.i .",
    "& upton , j.g .",
    "1989 biom .",
    "j. 31 , 563 hamilton , a.j.s .",
    "1993 , , 417 , 19 hanisch , h.k . , 1983 math",
    ".  operationsforsch .",
    "u.  statist .",
    "14 , 421 hewett , h.c .",
    "1982 , , 201 , 867 kerscher , m. 1998 , accepted ( astro - ph/9811300 ) landy , s.d . , & szalay , a. 1993 , , 412 , 64 ripley , b.d .",
    "1988 , statistical inference for spatial processes ( cambridge : cambridge univ . press ) stoyan , d. , stoyan , h. preprint 98 - 3 technische universitt bergakademie freiberg , 1998 szapudi , i. , szalay , a.s .",
    "1998 , , 494 , l41"
  ],
  "abstract_text": [
    "<S> we describe a set of new estimators for the n - point correlation functions of point processes . the variance of these estimators is calculated for the poisson and binomial cases . </S>",
    "<S> it is shown that the variance of the unbiased estimator converges to the continuum value much faster than with any previously used alternative , all terms with slower convergence exactly cancel . </S>",
    "<S> we compare our estimators with ripley s @xmath0 and @xmath1 . </S>"
  ]
}