{
  "article_text": [
    "rigorous studies of neural circuits in mammals could uncover motifs underlying information processing and neuropathies at the core of disease @xcite .",
    "traditionally these studies involved the painstaking manual tracing of individual neurons through microscopy data @xcite . in the modern connectomics field , this manual effort has been largely replaced by high - throughput pipelines responsible for automated segmentation and morphological reconstruction of neurons from nanometer - scale electron microscopy ( em ) @xcite .",
    "automation is critical for any large - scale investigation of neuron organization , as even a humble @xmath7 volume of tissue contains many petabytes of em data at the necessary resolution .    of course",
    ", reconstructing 3-dimensional models of neuron  skeletons \" is only a partial solution to the larger goal of constructing neuron connectivity maps .",
    "individual neurons are very densely packed but their connectivity is comparatively sparse , thus deriving connectivity is more complex than simply identifying the cell membranes of adjacent neurons . in recent years , several frameworks have been published that segment neurons with near - human accuracy @xcite .",
    "however , there has been substantially less success in identifying synapses  the junctions whereby neurons connect and communicate . in the context of a neural connectivity graph , this is equivalent to identifying nodes but ignoring the edges between them .",
    "synapses are inherently compositional , identifiable in em by a darkened cleft between adjacent neurons flanked by an asymmetric density of vesicles ( neurotransmitter - carrying organelles ) .",
    "accordingly , most previous approaches to synapse detection have used classifiers ( typically random forests ) with hand - crafted features to leverage this prior knowledge .",
    "early examples include the work of kreshuk _ et al .",
    "_ , which captured voxel geometry and texture @xcite ; and becker _ et al .",
    "_ , who extended this work to capture 3-dimensional contextual cues @xcite .",
    "although these approaches worked well on the datasets for which they were trained , they failed to generalize beyond the specific contrast and anisotropy ( @xmath8 nm ) of that dataset  @xcite .",
    "[ sec : introduction ]        in recent years , deep convolutional networks ( convnets ) have become a de facto standard for image classification @xcite and semantic segmentation @xcite . when provided with sufficient training data ,",
    "convnets typically outperform random forest and other classical machine learning approaches that are dependent on hand - crafted features .",
    "it is perhaps then unsurprising that the most accurate framework for synapse detection in previous literature is a convnet ( vesicle - cnn ) by roncal _",
    "et al . _ , which is trained to segment synapses directly from em data without any prior knowledge of clefts , vesicles and their compositionality @xcite .",
    "the authors also published a much faster yet less accurate random forest classifier ( vesicle - rf ) , which outperforms previous approaches by explicitly modeling properties of synaptic connections .",
    "the major issue with convnets ( including vesicle - cnn ) is that they are prohibitively slow .",
    "biologically meaningful volumes of neural tissue take months - to - years to image , thus a critical step toward the goals of connectomics is developing a computational pipeline that can process streaming data at microscope pace @xcite .",
    "the authors of vesicle - cnn reported a processing time of @xmath9hours per gb of em @xcite , i.e. , several orders - of - magnitude slower than the tb / hr pace of modern multi - beam electron microscopes .",
    "their lightweight vesicle - rf was both substantially faster yet less accurate , making it impractical for connectomics where reliable synapse identification is needed for detecting enrichment of neural motifs .",
    "in this study we present a new synapse detection framework that attempts to distill the advantages of both accurate convnets and faster knowledge - driven techniques . rather than training a deep convnet to segment synapses directly from em samples , we train much lighter networks to learn the marginal distributions of neuron membranes , intercellular clefts and synaptic vesicles .",
    "these features are then explicitly composed with simple rules that follow directly from prior biological knowledge .",
    "the resulting system ( see figure  [ fig : workflow ] ) is both faster and more accurate compared to state - of - the art@xmath10 speed - up and @xmath11% f1-score over the accurate vesicle - cnn and @xmath12 speed - up and @xmath13% f1-score over the faster yet less accurate vesicle - rf .",
    "we apply our system to reconstruct the first complete , directed connectome from the largest available anisotropic em dataset of mouse somatosensory cortex ( s1 @xcite ) .",
    "this @xmath14 gb reconstruction took just @xmath6hours on one multicore cpu , end - to - end from em to connectivity graphs .",
    "compare this to the previous largest @xmath15 gb reconstruction , which needed @xmath16weeks to segment neuron membranes ( on a farm of @xmath17 titan x gpus ) and a further @xmath18hours to identify synapses using vesicle - rf on a @xmath19core cpu cluster @xcite .",
    "in this section we describe our synapse detection system , which is both faster and more accurate than state - of - the - art and able to be run on a single multicore cpu server .",
    "this system is comprised of two main parts : ( 1 ) a bank of three lightweight convnets that can be deployed in parallel to segment membranes , clefts and synaptic vesicles ; and ( 2 ) a rules - based module that integrates these three feature maps to identify synapses .",
    "the intuition behind this approach is to constrain the space in which our convnets are optimized by leveraging prior biological knowledge on synapse compositionality , i.e. the network simply has less to learn .",
    "this both avoids the computational burden associated with the traditional  deeper is better \" convnet paradigm while empirically improving synapse detection accuracy across the @xmath14 gb s1 dataset .",
    "deep convnets of small kernels have become a de facto standard for image classification tasks , largely motivated by the success of alexnet @xcite and progressively deeper networks @xcite in the annual imagenet classification challenge @xcite .",
    "more recently convnets have been used to solve semantic segmentation tasks @xcite , which require assigning a class label or probability to each pixel of the output feature map .",
    "there have been several successful examples of convnets being applied successfully to segmentation of neuron membranes from em data @xcite . in the context of reconstructing connectivity graphs , this is akin to defining the set of nodes but not edges .    in our system , we deploy lightweight convnets to learn the marginal distributions of ( a ) neuron membranes , ( b ) intercellular clefts and ( c ) synaptic vesicles .",
    "our approach to segmenting neuron membranes is essentially equivalent to prior work in @xcite .",
    "the network is presented with @xmath20 em images at @xmath21 nm resolution and associated ground - truth segmentations , and learns to produce an output segmentation in the form of a spatial membrane probability map ( normalized to the integer range [ @xmath22 , @xmath23 ) .",
    "synaptic clefts are treated largely the same , focusing on the darkened regions between a subset of adjacent cellular membranes .",
    "our approach to vesicle detection is more unique .",
    "vesicles are organelles that store the various chemicals required for neurotransmission , and are located at the pre - synaptic partner of neuron connections .",
    "automatic detection of vesicles has previously been considered a difficult task  @xcite and has thus not been extensively studied . to our knowledge",
    "vesicle - rf was the first system to attempt to identify individual vesicles ( using a hand - crafted match filter ) to assist with synapse identification  @xcite .",
    "unlike their approach , we train a convnet to segment significant clusters of spatially co - located vesicles as a single feature ( cyan in figure  [ fig : block72 ] ) .",
    "in addition to allowing us to reconstruct directed connectivity by considering vesicle density in the pre- vs. post - synaptic partners , there is also a well - established correlation between this density and the strength of synaptic connections  @xcite ( akin to weights in an artificial neural net ) .",
    "each of our three marginal convnets adopts the same lightweight architecture ( herein maxoutnet , figure  [ fig : cnet ] ) that comprises of consecutive  convpool \" modules .",
    "each module consists of two parallel branches aggregated with a maxout function @xcite , where each branch is a convolution operation ( kernel size @xmath24 , 32 channels ) followed by a @xmath25 maxpool of stride 2 .",
    "the full network consists of three consecutive convpool modules followed by a final @xmath26 kernel to output the segmented feature map .",
    "there are a number of compounding factors that allow our system to execute orders - of - substantially faster than previous state - of - the - art .",
    "first is the lightweight nature of the maxoutnet architecture , which contains orders - of - magnitude fewer parameters than previous popular connectomics convnets ( i.e. , @xmath27 compared to unets @xmath28 @xcite ) .",
    "second is our minimally fully - convolutional implementation , inspired by fast algorithms of max - pooling fragments  @xcite .",
    "compared with naive patch - based methods of semantic segmentation ( i.e. , where the full convolutional field - of - view is reprocessed for every output pixel ) this method leads to a @xmath29fold reduction in redundant computations . finally is our multicore cpu - optimized implementation , which makes liberal use of simd instructions  @xcite and cilk - based job scheduling  @xcite to yield @xmath30% single - core utilization and @xmath31% multi - core scalability across our @xmath32core haswell processor .",
    "the aggregate impact of these optimizations is an @xmath33fold speed - up with respect to vesicle - cnn @xcite .",
    "it is worth noting that vesicle - cnn reports to be based on the n3 convnet architecture  @xcite but uses stride-1 instead of stride-2 pooling , which is largely responsible for the inflation of their network size .",
    "0.22     0.22           in recent years the convnet paradigm has been one of  deeper is better \" , with more complex problems being solved by increasing network depth and data volume  @xcite .",
    "this is also the vesicle - cnn approach to synapse detection @xcite , which segments synapses directly from em without explicitly capturing any prior biological knowledge .",
    "although this approach certainly has merit ( as reflected in state - of - the - art performance on imagenet and other image processing benchmarks  @xcite ) it does not extend well to problems where real - time performance is a hard constraint .",
    "connectomics is one such problem @xcite .",
    "if a biologically meaningful volume of neural tissue already takes months - to - years to image with modern multi - beam electron microscopy , we certainly do not wish to exacerbate this problem with post - processing that is orders - of - magnitude slower .",
    "further , producing ground - truth annotation for em data is done manually and is highly time - consuming , taking even expert neuro - scientists hundreds of hours .",
    "as a result , the volume of training data available is extremely limited and there is need to design algorithms which are resilient to this .",
    "this motivates our choice of shallow networks , to avoid overfitting associated with deep networks in data - constrained problems .    in our system , we leverage the explicit compositionality of synapses to greatly reduce the search space within which our convnets are optimized ( i.e. learning marginal versus joint distributions over features ) .",
    "this reduction in search space is explicitly captured by a lightweight network architecture , and thus able to be leveraged for substantial speed - up in synapse segmentation . to accomplish this , we take motivation from the concept of compositional hierarchies , wherein low - level features are explicitly composed to perform tasks such as object recognition  @xcite and scene parsing @xcite .",
    "it has been shown that in various recognition tasks , the use of hierarchies is more informative than non - hierarchical representations @xcite and yields improved performance and generalizability , especially in the presence of occlusion or clutter @xcite .",
    "such compositionality is also believed to be an intrinsic mechanism for object recognition in the visual cortex @xcite .",
    "a key shortcoming of traditional compositional models is the difficulty of hand - crafting feature hierarchies for the expansive domain of natural images , or building suitable models to learn these features in an unsupervised fashion .",
    "this is one of the key motivators behind recent deep learning trends , although convnets are likewise criticized for their absence of compositionality @xcite and feature intelligibility @xcite .",
    "instead , our approach distils the advantages of both domains . rather than capturing low - level features using gabor filters or sift features ,",
    "we take motivation from the work of ullman  _ et al . _ in natural image classification  @xcite and explicitly compose pictorial features . unlike previous work ,",
    "our pictorial features are not crops of the raw em but instead taken from the convnet - segmented features maps of membranes , clefts and vesicles . here , learning feature ( membranes , clefts and vesicles ) segmentation using convnets is easier than learning synapses because of two primary reasons(1 ) relative simplicity of features as compared to synapses ( 2 ) availability of significantly more ground truth for features ( for , the number of membrane pixels in an annotated em stack is a few orders of magnitude larger than the number of synaptic pixels due to the sparsity of neural connections ) .",
    "neuron membranes predicted by the convnet are further processed to segment individual neurons in the traditional manner  @xcite .",
    "specifically , we generate an over - segmentation of neurons using the popular watershed algorithm .",
    "these segments are then agglomerated using the neuroproof package by parag _",
    "et al . _ , which applies a pre - trained random forest classifier to determine which adjacent segments require merging  @xcite . in both cases we use custom implementations optimized for multicore cpu scalability  @xcite .",
    "an example output of this process is presented in figure  [ fig : cube ] for a small sub - volume of the s1 dataset .",
    "neuron segmentations are then composed with cleft and vesicle segmentations to filter putative synapse candidates .",
    "this involves applying the following rules :    1 .",
    "restrict candidates to membrane regions and discard intra - cellular predictions 2 .   constrain predictions to be within a certain maximum distance to vesicles .",
    "we are interested in finding active synapses typically marked by the presence of vesicles 3 .",
    "threshold ( binary ) synapse probabilities with an empirically tuned parameter .",
    "4 .   break large synapse predictions that cover many true and false synapses .",
    "this ensures each connected synapse candidate lies between a unique pair of neurons .",
    "this is important to find pre- and post - synaptic neurons for a synapse .",
    "connected component analysis and checks on minimum 2d/3d size and slice persistence ( similar to vesicle - rf ) .",
    "6 .   reject candidates that do not contain vesicles in one of the two neuron segments they connect .",
    "this additional check ensures that all the final synapse candidates are active and contain vesicles in close proximity , in one of the two adjoining segments .",
    "0.15     0.14     0.16     a few examples of synapses ( red ) detected using our system are presented in figure [ fig : neuronsac3 ] .",
    "the axon ( pre - synaptic partner , green ) and dendrite ( post - synaptic partner , blue ) are trivially identified from asymmetric vesicle density in our compositional model .",
    "extracting directionality from vesicle - rf / cnn or similar approaches would require additional layers of post - processing . as a result",
    ", our approach is the first to enable scalable inference of the the wiring diagram ( defined as a graph connecting pairs of pre- and post - synaptic neurons with an inter - cellular synapse ) without need for further processing or manual intervention .",
    "we chose to evaluate our system performance , both in terms of reconstruction accuracy and execution time , on the largest available connectomics dataset .",
    "specifically , the s1 dataset by kasthuri _",
    "is an anisotropic em volume of mouse somatosensory cortex imaged at @xmath34 nm resolution , containing an estimated @xmath35 synapses@xmath36 @xcite .",
    "this dataset is color - corrected and down - sampled to @xmath37 nm prior to processing .",
    "we compare our performance against the two state - of - the - art systems for synapse detection by roncal _",
    "et al . _  the highly accurate convnet - based vesicle - cnn and the faster but less accurate , random forest - based vesicle - rf  @xcite .",
    "we select two independent @xmath38 volumes of s1  for testing ( ac3 ) and training / validation ( ac4 ) .",
    "ground - truth annotations for these sub - volumes have been provided by expert neuroscientists  @xcite .",
    "various metrics of pixel - level accuracy have been presented for various image segmentation challenges  @xcite . however , in the connectomics scenario we are less interested in the pixel - level fidelity of synapse segmentation ( i.e. the metric used for training and evaluating convnets ) as long as we are correctly identifying the existence of a synaptic connection .",
    "this is convenient as it allows us to deploy far lighter networks without reducing the accuracy of the downstream connectivity graph .    for our benchmarking",
    "we consider the following metrics prescribed by iarpa for the microns project  @xcite and used widely within the connectomics community  @xcite :    1 .",
    "* synapse detection accuracy : * precision , recall and f1-score ( harmonic mean of precision of recall ) of identified synapses with respect to neuroscientist - annotated ground - truth .",
    "* wiring diagram accuracy : * evaluating neuron connectivity graphs is complicated by the fact that our and earlier systems are simultaneously identifying both nodes ( neuron segmentation ) and edges ( synapse identification ) . in order to evaluate the latter it is thus easier to consider the dual graph ( herein  line graph \" ) , where synapses are captured as nodes and neuron segments as edges .",
    "the correspondence between nodes in the inferred line graph with respect to ground - truth can then be easily determined by assigning matching labels to spatially overlapping synapses .",
    "further , both graphs are augmented to include all synapses present in the other to ensure an equal number of nodes",
    ".        -0.3 in [ fig : graph ]    .comparison of best operating points ( f1-score ) for our system compared to vesicle - rf and vesicle - cnn . [ cols=\"^,^,^,^,^\",options=\"header \" , ]     table  [ tab : perf ] presents the following for each phase of the synapse detection :    1 .",
    "* instruction count : * the number of instructions executed on the cpu 2 .",
    "* time : * the measured execution time 3 .",
    "* cpu count : * the average cpu utilization with respect to theoretical maximum throughput per thread ( maximum of 16 threads )    the performance of a connectomics system can only be truly assessed when deployed on the large - scale datasets made possible by recent advances in microscopy . moving beyond the ac3 sub - volume , we use our system to perform a reconstruction of the full 245 gb s1 dataset and compare to a time for vesicle - rn / cnn based on the authors reported findings  @xcite .",
    "our system took a total of 9.7 hours to reconstruct the full dataset , from em to connectivity graph .",
    "the majority of this time was spent by the convnets responsible for segmenting membranes , clefts and vesicles , with each network taking @xmath39 hours followed by @xmath40 hours of post - processing .",
    "if we ignore the time required for membrane segmentation ( as per the vesicle - rf study , where this step took 3 weeks on a farm of 27 titan x gpus  @xcite ) then our total processing time reduces to 8.1 hours for 245 gb .",
    "this is approximately @xmath4 times faster than vesicle - rf ( @xmath18hours@xmath41 gb ) and @xmath42 times faster than vesicle - cnn ( @xmath43hours@xmath44 gb , extrapolated from ac3 reconstruction time ) , both running on a @xmath1 core cpu cluster with @xmath45 tb ram .",
    "restating these results , even if one ignores the time required for membrane segmentation , detecting synapses in the full s1 volume would take approximately 1 week with vesicle - rf or 12 years with vesicle - cnn .",
    "as demonstrated in section  [ ss : accuracy ] , our system is more accurate and orders - of - magnitude faster than either approach .",
    "to our knowledge , the only previous attempt to reconstruct a non - trivial sub - volume of s1 was by roncal _ et al . _ using vesicle - rf .",
    "the authors reported that @xmath46 synaptic connections were detected in a @xmath47 volume of s1 , obtained by inscribing a @xmath48 cube ( @xmath15 gb of data ) within the down - sampled @xmath49 nm version of s1  @xcite .",
    "it is unclear how this result relates to the @xmath50 reported for the same volume and method in @xcite . applying our system , we identify @xmath51 synapses in @xmath52 , corresponding to non - black pixels in @xmath53 gb of non - corrupt em data extracted from @xmath54 gb of raw em .",
    "it is difficult to compare these results directly since the relationship between roncal s and our data remains unclear ",
    "s1 contains large regions of soma and blood vessels that do not contain any synapses .",
    "these results are equivalent to a synapse density estimate at @xmath55 synapses@xmath56 , which corresponds to @xmath57 synapses@xmath56 if we factor in the 78.1% recall of our method .",
    "these numbers agree with projections of s1 synapse density ranging from @xmath35 synapses@xmath56 @xcite .",
    "the remainder of this section demonstrates different spatial scales at which our automated reconstructions can be investigated .",
    "figure [ fig : neurites ] shows a reconstruction of select dendrites , axons and their synapses from s1 . while some axons synapsing to the dendrite ( blue ) span the entire volume , several of them are fragmented .",
    "this is due to split errors in the segmentation and emphasizes that synaptic - level reconstruction of em data goes hand - in - hand with neuron segmentation .",
    "the two should be used to iteratively refine one another in future attempts to accurately reconstruct larger - scale connectomes .",
    "to the best of our knowledge , such automated reconstructions of dendrites and their innervating axons have never been seen before ; generating similar visuals would require time - intensive manual annotation .    in figure",
    "[ fig : synapses ] we zoom out to inspect 9 neurite skeletons extracted from the s1 reconstruction .",
    "the 653 associated synapses detected by our system are overlaid in red , showing the overall density and spatial distribution . even without further data analysis",
    "this style of visualization can provide novel biological insight .",
    "consider figure [ fig:2 synapse ] , where we see an axon ( blue ) synapsing the same dendrite at two separate locations . since the axon is innervating the dendrite along the shaft and not a spine , it is likely to be an inhibitory axon .",
    "multiple redundant inhibitory connections are yet to be studied and have previously not been detected using automated methods ( discussions with jeff lichtman @xcite ) .",
    "this result highlights the power of automatic reconstruction in rapidly revealing insights into brain morphology .",
    "reconstructing large - scale maps of neural connectivity is a critical step toward understanding the structure and function of the brain .",
    "this is an overarching goal of the connectomics field , and although conceptually straightforward , there are unprecedented  big data \" issues that need to be overcome for investigating non - trivial tissue volumes  @xcite . with state - of - the - art multi - beam electron microscopes , a 1 @xmath58 volume ( comprising several petabytes of data )",
    "can be imaged within months and is thus an attainable goal .",
    "it is critical that the computational aspect of a connectomics pipeline operate at a similar pace in order to facilitate large - scale investigation of neuron morphology and connectivity .        mirroring recent trends in the wider computer vision community ,",
    "deep convnets have been adopted as a de facto standard for the complex image segmentation tasks required for connectomics  @xcite .",
    "good progress has been toward the segmentation and morphological reconstruction of neurons , with a recent study presenting a multicore cpu system capable of operating within the same order - of - magnitude as microscope - pace  @xcite .",
    "however , there has been relatively little success in large - scale identification of the synaptic connections between neurons , i.e. , the  edges \" in a connectivity graph .",
    "these features are more difficult to identify owing to both ( a ) their small size and complex compositionality , and ( b ) their comparative underrepresentation in manually - annotated data .",
    "the best existing convnet solution ( vesicle - cnn ) would take many years to reconstruct the 245 gb s1 dataset , and even a less accurate random forest classifier ( vesicle - rf ) takes more than a week  @xcite .    in this study",
    "we have presented the first practical solution to high - throughput synapse detection , closing the gap toward microscope - pace by two orders - of - magnitude .",
    "taking inspiration from previous research in compositional hierarchies  @xcite , our system is comprised of two stages : ( 1 ) a bank of lightweight cnns for segmenting  marginal \" features ( i.e. membranes , intercellular clefts and synaptic vesicles ) , and ( 2 ) a rules - based model that explicitly composes these features based on prior biological knowledge .",
    "this system yields an improvement of 5-to-7% compared to previous state - of - the - art , and we are interested to see whether this compositional convnet methodology can be applied to a broader class of image segmentation tasks .    similar to matveev et al.s pipeline  @xcite for reconstructing neuron morphology ( i.e.  nodes \" in a connectivity graph ) , we choose to optimize our implementation specifically for multicore cpu @xcite systems to remove the bottleneck of data communication rates .",
    "our implementation is @xmath59fold faster than vesicle - rf and @xmath33fold faster than vesicle - cnn , and we believe that this marks an important contribution toward the goal of a streaming connectomics pipeline for investigating the connectivity of biologically meaningful volumes of neural tissue ."
  ],
  "abstract_text": [
    "<S> connectomics is an emerging field in neuroscience that aims to reconstruct the @xmath0dimensional morphology of neurons from electron microscopy ( em ) images . </S>",
    "<S> recent studies have successfully demonstrated the use of convolutional neural networks ( convnets ) for segmenting cell membranes to individuate neurons . </S>",
    "<S> however , there has been comparatively little success in high - throughput identification of the intercellular synaptic connections required for deriving connectivity graphs .    in this study , we take a compositional approach to segmenting synapses , modeling them explicitly as an intercellular cleft co - located with an asymmetric vesicle density along a cell membrane . instead of requiring a deep network to learn all natural combinations of this compositionality , </S>",
    "<S> we train lighter networks to model the simpler marginal distributions of membranes , clefts and vesicles from just @xmath1 electron microscopy samples . </S>",
    "<S> these feature maps are then combined with simple rules - based heuristics derived from prior biological knowledge .    </S>",
    "<S> our approach to synapse detection is both more accurate than previous state - of - the - art ( @xmath2% higher recall and @xmath3% higher f1-score ) and yields a @xmath4-fold speed - up compared to the previous fastest implementations . </S>",
    "<S> we demonstrate by reconstructing the first complete , directed connectome from the largest available anisotropic microscopy dataset ( @xmath5 gb ) of mouse somatosensory cortex ( s1 ) in just @xmath6hours on a single shared - memory cpu system . </S>",
    "<S> we believe that this work marks an important step toward the goal of a microscope - pace streaming connectomics pipeline . </S>"
  ]
}