{
  "article_text": [
    "toric residues are fundamental invariants of sparse polynomial systems .",
    "they were first studied by cox @xcite who defined the residue of @xmath0 sections of an ample line bundle on a toric variety @xmath3 .",
    "the definition was extended by cattani , cox , and dickenstein to sections of @xmath0 arbitrary line bundles @xcite .",
    "there are numerous applications to sparse resultants and resultant or subresultant complexes @xcite , mixed hodge structures @xcite , and mirror symmetry @xcite .",
    "the related notion of global residue in the torus , a sum of grothendiek local residues , was studied by gelfond , khovanskii , and soprounov @xcite .",
    "cattani , cox and dickenstein @xcite showed that the global residue could always be computed as an instance of the toric residue .",
    "applications of the toric and global residue include gkz hypergeometric systems @xcite and computations on sparse polynomial systems such as counting the number of real roots and computing elementary symmetric functions on the roots @xcite .",
    "given @xmath0 arbitrary sparse laurent polynomials @xmath4 in @xmath1 affine variables , let @xmath5 be their corresponding newton polytopes .",
    "the minkowski sum @xmath6 determines a toric variety @xmath3 , and each @xmath7 corresponds to a semi - ample divisor class . in the homogeneous coordinate ring @xmath8 of @xmath3",
    "each @xmath9 can be homogenized to a polynomial @xmath10 of degree @xmath11 corresponding to the divisor class of @xmath7 . the toric residue @xmath12 is a linear function on homogeneous polynomials of a certain critical degree corresponding to the interior of @xmath13 which vanishes on the ideal of the @xmath10 .    in many cases of interest , for example when all of the @xmath7 are full dimensional , the ideal of the @xmath10 has codimension @xmath14 in the critical degree . hence knowing a single element of non - zero residue will allow a full computation of the residue map .",
    "more generally , we show in section  [ s : essential ] that there is an element of non - zero residue whenever the polytopes form an essential family .",
    "the goal of this paper is a general framework for the construction of specific elements whose residue we can compute .",
    "the construction depends only on the combinatorics and affine geometry of the polytopes @xmath7 .",
    "[ t : main1 ] let @xmath3 be a complete toric variety of dimension @xmath1 .",
    "fix @xmath0 semi - ample degrees @xmath15 on @xmath3 and let @xmath16 be their polytopes .",
    "let @xmath17 be a collection of partitions of the lattice points of the @xmath7 such that    1 .",
    "for any lattice point @xmath18 , at least one vertex of the minimal face of @xmath7 containing @xmath19 lies in @xmath20 , 2 .   for any permutation @xmath21 of @xmath22 :",
    "@xmath23    given a collection of laurent polynomials @xmath24 supported on @xmath16 @xmath25 define polynomials @xmath26 then @xmath27 is a laurent polynomial supported on @xmath28 .",
    "the toric residue @xmath29 of the corresponding homogeneous polynomial @xmath30 of critical degree for the homogenized @xmath31 is an integer that depends only on the combinatorics of the @xmath7 and the partitions of their lattice points .    using this theorem we are able to find an element of residue @xmath32 , i.e. find an appropriate collection of partitions , in two important cases .",
    "the first is when @xmath7 share a complete flag of faces .",
    "this will generalize earlier results of dandrea and khetan when all of the @xmath11 were ample degrees .",
    "the second application is a complete analysis when @xmath2 .",
    "we show that , except for one degenerate family of supports , we can always find a collection of partitions yielding an element of residue @xmath33 .",
    "the proof of the theorem makes use of some very elegant combinatorics . starting with a partition of the lattice points",
    "we will show that there are induced colorings of the faces of the polytope @xmath34 .",
    "moreover , the matrix will yield a canonical coloring of the facets of the barycentric refinement of @xmath13 .",
    "such a facet coloring will allow us to reduce the computation to that of the residue of a monomial with respect to a monomial ideal . by an earlier theorem of soprounov @xcite ,",
    "the residue is the _ combinatorial degree _ of the coloring which can be computed by counting the number of flags of certain colors .",
    "the paper is organized as follows .",
    "section  [ s : prelim ] provides the definitions of the toric residue and some basic properties .",
    "section  [ s : essential ] proves the existence of elements of non - zero residue if and only if the polytopes are essential .",
    "section  [ s : cdeg ] introduces facet colorings of polytopes and their connection to the toric residue of monomials . the residue for general polynomials",
    "is reduced to the monomial case via the global transformation law .",
    "section  [ s : partition ] and section  [ s : canoncolor ] discuss the relationships between partitions , colorings , and residue matrices used to complete the proof of theorem  [ t : main1 ] .",
    "section  [ s : locallyunmixed ] uses the previous results to give an explicit element of residue 1 when the polytopes @xmath7 share a complete flag of faces .",
    "section  [ s : dim2 ] is a complete analysis when @xmath3 is of dimension 2 .",
    "finally , section  [ s : conclusion ] discusses progress in dimensions three and higher .",
    "we begin by setting up the notation and reviewing some basic definitions and facts about toric varieties and toric residues . for details and proofs",
    "we refer the reader to @xcite .",
    "consider an @xmath1-dimensional complete toric variety @xmath3 determined by a rational complete fan @xmath35 .",
    "let @xmath36 denote the set of 1-dimensional cones ( rays ) of @xmath37 .",
    "each ray @xmath38 determines a @xmath39-invariant irreducible divisor @xmath40 on @xmath3 .",
    "as introduced by cox in @xcite the variety @xmath3 has the homogeneous coordinate ring @xmath41 $ ] graded by the chow group @xmath42 so that a monomial @xmath43 has degree @xmath44\\in a_{n-1}(x).\\ ] ] denote by @xmath45 the graded piece of @xmath8 consisting of all polynomials of degree @xmath46 .",
    "let @xmath47 be a representative of @xmath46 .",
    "it defines a continuous piecewise linear function @xmath48 on the support @xmath49 such that @xmath50 for all @xmath38 , where @xmath51 denotes the primitive generator of @xmath52 ( see ( * ? ? ?",
    "* section 3.3 ) ) .",
    "it also determines a convex polytope @xmath53 to every lattice point @xmath19 of @xmath54 we can assign a monomial @xmath55 in @xmath8 of degree @xmath56 : @xmath57 one can check that this map is a bijection . furthermore , given a laurent polynomial @xmath58 supported in @xmath54 its _ @xmath54-homogenization _ is the homogeneous polynomial @xmath59 notice that if @xmath60 is supported in the interior of @xmath54 then the @xmath54-homogenization is divisible by the product of all the variables @xmath61 , @xmath38 .",
    "it is easy to see that if @xmath62 and @xmath63 are linearly equivalent then @xmath64 is a linear function , and @xmath54 and @xmath65 are the same up to a translation .",
    "therefore , @xmath54-homogenization is independent of the choice of the representative @xmath62 of the divisor class @xmath56 . in",
    "what follows the _ polytope of @xmath56 _ will mean the polytope of any representative of @xmath56 and will be denoted by @xmath66 .",
    "recall the construction of the euler form @xmath67 from @xcite .",
    "let @xmath68 be a basis for @xmath69 and for every subset @xmath70 of size @xmath1 denote @xmath71 then the _ euler form _ on @xmath3 is the sum over all size @xmath1 subsets @xmath70 : @xmath72    now we recall the definition of the toric residue @xcite .",
    "consider @xmath0 homogeneous polynomials @xmath73 , for @xmath74 .",
    "their critical degree is defined to be @xmath75 then for every polynomial @xmath30 of degree @xmath76 consider a meromorphic @xmath1-form on @xmath3 : @xmath77 where @xmath67 is the euler form .",
    "we use @xmath78 to denote the list @xmath79 .",
    "suppose that the  @xmath10 do not vanish simultaneously on @xmath3 .",
    "then @xmath3 has an open cover @xmath80 by the @xmath0 sets @xmath81 and @xmath82 defines a ech cohomology class @xmath83\\in h^n(x,\\widehat\\omega_x^n)$ ] relative to the cover @xmath80 . here",
    "@xmath84 denotes the sheaf of zariski @xmath1-forms on @xmath3 .",
    "one can check that the class @xmath83 $ ] is alternating in the order of the @xmath10 and is zero if @xmath30 belongs to the ideal of @xmath31 .",
    "therefore , @xmath83 $ ] depends on the equivalence class of @xmath30 modulo the ideal @xmath85 . the _ toric residue map _",
    "@xmath86 is given by @xmath87)$ ] , where @xmath88 is the trace map on @xmath3 .",
    "when there is no danger of confusion we will write @xmath29 instead of @xmath89 .",
    "let @xmath3 be a complete @xmath1-dimensional toric variety defined by a complete fan @xmath37 in @xmath90 . recall that a @xmath39-cartier divisor @xmath62 on @xmath3 is called _ semi - ample _ if the corresponding line bundle @xmath91 is generated by global sections .",
    "equivalently , @xmath62 is semi - ample if and only if the corresponding piecewise linear function @xmath48 is convex ( * ? ? ?",
    "* section 3.4 ) . consider the ( generalized ) normal fan @xmath92 of the polytope @xmath54 of @xmath62 , i.e. a complete fan whose cones are @xmath93 for every face @xmath94 of @xmath54 .",
    "it follows that if @xmath62 is semi - ample then @xmath37 refines @xmath92 .",
    "indeed , by the convexity of @xmath48 for any maximal cone @xmath95 the restriction of @xmath48 to @xmath96 defines a a vertex @xmath19 of @xmath54 .",
    "then @xmath97 , @xmath98 .",
    "we will say that a degree @xmath99\\in a_{n-1}(x)$ ] is _ semi - ample _ if @xmath62 is semi - ample .    consider a collection of @xmath0 semi - ample degrees @xmath15 on @xmath3 .",
    "let @xmath16 be their polytopes ( defined up to translations ) and @xmath100 the normal fans of the polytopes . by above @xmath37 refines each @xmath101 and , thus , refines the minimal common refinement of the @xmath101 , which is the normal fan @xmath102 of the minkowski sum @xmath103 by ( * ?",
    "* chapter 5 , theorem 4.8 ) .",
    "now let @xmath104 be a birational morphism defined by a refinement @xmath105 .",
    "if @xmath62 is a @xmath39-cartier divisor on @xmath3 then the pull - back @xmath106 has the same piecewise linear function @xmath48 and the same polytope @xmath54 .",
    "it follows that @xmath107 is semi - ample on @xmath108 if @xmath56 is semi - ample on @xmath3 .",
    "also if @xmath78 is a homogeneous polynomial in @xmath45 and @xmath60 the corresponding laurent polynomial supported in @xmath66 then the pull - back @xmath109 is the @xmath66-homogenization of @xmath60 in the homogeneous coordinate ring @xmath110 of @xmath108 , and hence @xmath111 .",
    "next we will see how the toric residue @xmath112 behaves under the birational morphism @xmath104 .",
    "[ p : birational ] let @xmath3 be a complete @xmath1-dimensional toric variety defined by a complete fan @xmath37 .",
    "let @xmath104 be a birational morphism induced by a refinement @xmath105 .",
    "suppose @xmath15 are semi - ample degrees with polytopes @xmath16 and consider @xmath0 polynomials @xmath73 not vanishing simultaneously on @xmath3 .",
    "then the polynomials @xmath113 do not vanish simultaneously on @xmath108 .",
    "furthermore , let @xmath114 be any laurent polynomial supported in the interior of @xmath115 , and @xmath116 ( resp .",
    "@xmath117 ) be the @xmath13-homogenization of @xmath114 in @xmath8 ( resp .",
    "@xmath118 ) . then the homogeneous polynomials @xmath119 and @xmath120 are of critical degree for the @xmath10 and the @xmath121 , respectively , and satisfy @xmath122 here @xmath123 denotes the product of the homogeneous variables @xmath124 .",
    "first the sets @xmath125 form a covering of @xmath108 since it is the pull - back of the covering @xmath80 of @xmath3 . in particular ,",
    "the @xmath121 do not vanish simultaneously on @xmath108 .",
    "now let @xmath67 and @xmath126 be the euler forms on @xmath3 and @xmath108 , respectively .",
    "we have @xmath127 since both are rational extensions of the @xmath39-invariant regular @xmath1-form @xmath128 on the torus , where the @xmath129 are affine coordinates .",
    "therefore @xmath130 since @xmath131 both @xmath82 and @xmath132 have the same toric residue .",
    "the proposition follows .",
    "[ d : essential ] a collection of polytopes @xmath5 is said to be _ essential _ if for every @xmath133 the dimension of the polytope @xmath134 is at least @xmath135 . given a toric variety @xmath3 of dimension @xmath1 ,",
    "a collection of semi - ample degrees @xmath136 is called _ essential _ if the corresponding polytopes @xmath5 are essential .",
    "the goal of this section is to prove that the toric residue is not identically zero if and only if the degrees @xmath11 are essential .",
    "[ t : nonzero ] consider degrees @xmath136 on a complete toric variety @xmath3 .",
    "the toric residue with respect to polynomials @xmath137 , viewed as a rational function in the coefficients of the @xmath10 , is identically zero if and only if the @xmath11 are not essential . for essential @xmath11",
    "there is a polynomial @xmath30 of critical degree and homogeneous of degree @xmath14 in the coefficients of each @xmath10 such that @xmath138 .",
    "the first implication is that for the non - essential degrees the toric residue is identically 0 . by proposition  [ p : birational ] , we can refine @xmath3 to a simplicial variety without changing the toric residue .",
    "so assume @xmath3 is simplicial .",
    "in this case the toric residue @xmath29 is the sum of the grothendieck local residues of any @xmath139 with respect to the common zeros of the remaining @xmath10 ( * ? ? ? * theorem 0.4 ) .",
    "suppose there exists a proper subset @xmath140 such that @xmath141 has dimension less than @xmath135 .",
    "let @xmath142 be the toric variety corresponding to @xmath143 , and @xmath144 the morphism defined by the natural map of fans @xmath145 .",
    "the polynomial @xmath10 for @xmath146 is the pullback of a polynomial of semi - ample degree on @xmath142 with polytope @xmath7 .",
    "clearly , generic polynomials supported on the @xmath7 , @xmath146 , do not have a common zero on @xmath142 since @xmath147 .",
    "thus the corresponding @xmath148 do not have a common zero on @xmath3 for generic coefficients .",
    "extend @xmath140 to a subset of size @xmath1 , without loss of generality we take it to be @xmath149 . for generic coefficients",
    "@xmath150 do not have a common root .",
    "in particular there are no local residues in the sum .",
    "so for generic coefficients the toric residue is @xmath151 .",
    "since , @xmath12 is a rational function of the coefficients of the @xmath10 it must be identically zero .    for the converse ,",
    "the main tool is the following dual koszul complex of sheaves with respect to @xmath152 which appears in numerous places including @xcite , @xcite , and @xcite . given a subset @xmath153 let @xmath154 .",
    "we have an exact sequence of sheaves @xmath155 where as before @xmath76 is the critical degree for @xmath78 and @xmath156 .",
    "one can take the ech cohomology double complex and then pass to a spectral sequence .",
    "the @xmath157 terms of this spectral sequence are : @xmath158 because the @xmath11 are essential , a result of @xcite gives us : @xmath159 as a consequence there is a unique top differential @xmath160 which must be an isomorphism since the spectral sequence is exact . moreover , @xmath161 and @xmath162 is a quotient of @xmath163 .",
    "so we have an induced map @xmath164 which is the composition of the projection onto @xmath162 and the inverse of the isomorphism @xmath165 .",
    "we also have an isomorphism @xmath166 sending a local section @xmath167 to @xmath168 where @xmath67 is the euler form .",
    "finally there is the trace isomorphism @xmath169 .",
    "composing all of these maps we obtain a map @xmath170 .",
    "the maps are illustrated via the diagram below :    s _",
    "= e_1^n+1,0 & & & & & & + & & & & & & + e_n+1^n+1 , 0 & ^d_n+1 _ & h^n(x , ( -_0 ) ) & & h^n(x , ^n ) & ^_x & c.    we will prove that this composition is precisely the toric residue map . in that case if we started with a differential form @xmath171 such that @xmath172 , it would correspond to an element of @xmath173 which is mapped to an element @xmath174 .",
    "let @xmath30 be any element of @xmath163 lifting @xmath175 . from the above constructions it would follow that @xmath176 and the toric residue is not identically zero as desired .",
    "moreover , by a theorem of weyman ( * ? ? ?",
    "* chapter 3 , theorem 4.11 ) , the differential @xmath165 , and therefore the element @xmath30 above , can be lifted up to a ( non - unique ) map @xmath177 which is polynomial of degree @xmath14 in the coefficients of each @xmath10 .    to prove that the residue map coincides with the one constructed above we compute the cohomology terms using the ech resolutions given by the open cover @xmath81 .",
    "more generally , given @xmath178 define @xmath179 . in this way we have the @xmath180 terms of our spectral sequence    @xmath181 where @xmath182 denotes the complement of @xmath140 . in terms of the cover , given a polynomial @xmath183 we have @xmath184 the residue map is defined to be the trace of the cohomology class of this latter element ( after multiplying by the euler form ) .",
    "so it is enough to show that @xmath185 ) = [ h ] \\in e_{n+1}^{n+1,0}$ ] . to compute this differential we start with @xmath186 and map it via @xmath187 to @xmath188",
    "this can be lifted via the ech differential @xmath189 to an element of @xmath190 which is further mapped to @xmath191 and lifted to @xmath192 and so on . at the end",
    "we obtain an element of @xmath193 which is mapped via @xmath187 to @xmath194 .",
    "let @xmath195 be the basis of @xmath196 and @xmath197 .",
    "we have the following lemma .",
    "[ l : lift ] in the above mapping and lifting process , a valid choice for the element in @xmath198 is @xmath199 .",
    "the base case @xmath200 is our starting element . for the inductive step",
    "we need to show that @xmath201 .",
    "however , by the definitions of the koszul and ech morphisms it is easy to see that both of the above elements are : @xmath202 where @xmath203 .    therefore we get the element @xmath204 .",
    "the final koszul differential is multiplication by @xmath10 in each factor so we are left with @xmath205 which corresponds to the global section @xmath206 .",
    "so @xmath30 is a valid lifting of the image of the class of @xmath207 under @xmath165 completing the proof .",
    "the theorem from the previous section guaranteed the existence of an element of toric residue one but was completely nonconstructive .",
    "this section and the next one provide the framework for an explicit combinatorial construction of such elements . here",
    "we recall the definition of the facet coloring of a polytope and the relation between the combinatorial degree of a facet coloring and the toric residue for monomial ideals .",
    "we will also obtain the generalized global transformation law that allows us to reduce the computation of the toric residue for semi - ample degrees to the monomial case .",
    "consider an @xmath1-dimensional polytope @xmath13 in @xmath90 .",
    "we let @xmath208 denote the boundary of @xmath13 and @xmath209 the partially ordered set ( poset ) by inclusion of all proper faces of @xmath13 .",
    "we also let @xmath210}$ ] denote the set of all subsets of @xmath211=\\{0,\\dots , n\\}$ ]",
    ". it will be convenient for us to equip @xmath210}$ ] with the inverse partial order @xmath212 , i.e. @xmath213 if and only if @xmath214 for @xmath215}$ ] .",
    "a map of posets @xmath216},<)$ ] is called a _ coloring of @xmath13 into @xmath0 colors _ ( or simply _ coloring _ ) . the image @xmath217 is called the _ set of colors _ of a face @xmath218 .",
    "we will also say that _",
    "@xmath94 is colored by @xmath217_. a coloring is called _ simplicial _ if every face @xmath218 is colored by a non - empty proper subset of @xmath211 $ ] .    the poset @xmath219},<)$ ] can be identified with the poset of faces of the standard @xmath1-simplex : @xmath220 indeed , each non - empty proper subset @xmath221 $ ] defines the codimension @xmath222 face of @xmath223 : @xmath224 therefore , any simplicial coloring is , in fact , a map of posets @xmath225 .",
    "fix orientations of @xmath13 and @xmath223 . given a simplicial coloring @xmath226 consider a continuous piecewise linear map @xmath227 such that @xmath228 for any @xmath218 .",
    "one can show that such a map @xmath229 always exists and the topological degree @xmath230 does not depend on the choice of @xmath229 ( see @xcite ) .",
    "we call it the _ combinatorial degree _",
    "@xmath231 of the simplicial coloring @xmath226 .",
    "the combinatorial degree is alternating in the ordering of the elements of @xmath211 $ ] as every such ordering defines an orientation of the corresponding simplex @xmath223 .",
    "we have the following property of the combinatorial degree .",
    "let @xmath226 , @xmath232 be two simplicial colorings of @xmath13 .",
    "we say that @xmath232 _ refines _",
    "@xmath226 if @xmath233 for any @xmath218 .",
    "[ p : refinement]@xcite let @xmath226 , @xmath232 be two simplicial colorings of @xmath13 . if @xmath232 refines @xmath226 then @xmath234 .",
    "the combinatorial degree can be computed explicitly as a signed number of certain complete flags of faces of @xmath13 . to state the precise formula we will need the following definition .",
    "consider a complete flag @xmath78 of faces of @xmath13 @xmath235 for every @xmath236 choose a vector @xmath237 that begins at @xmath238 and points strictly inside @xmath239 .",
    "define the _ sign _ of the flag to be @xmath240 if @xmath68 gives a positive oriented frame for @xmath13 , and @xmath241 otherwise .",
    "it is easy to see that the sign is independent of the choice of the @xmath242 .",
    "[ t : flags ] let @xmath226 be a simplicial coloring of an @xmath1-dimensional polytope @xmath243 . fix any permutation @xmath21 on the elements of @xmath211 $ ] .",
    "then the combinatorial degree of @xmath226 equals the sign of @xmath21 times the number of complete flags @xmath244 counted with signs , such that for every @xmath245 the face @xmath246 is colored by @xmath247 .",
    "this is a particular case of @xcite , theorem 2.2",
    ".    in particular , this theorem says that the combinatorial degree is zero unless for every @xmath248 there is a facet in @xmath13 colored by @xmath249 , for every @xmath250 there is a codimension two face in @xmath13 colored by @xmath251 , and so on .",
    "one way to define a coloring @xmath252}$ ] is to give the colors to every facet of @xmath13 and then extend it by taking intersections , i.e. if @xmath253 for some facets @xmath254 then @xmath255 ( remember we have the reversed order in the target ) .",
    "the coloring obtained in this way is called a _",
    "facet coloring_. in the present paper we will only be interested in facet colorings .    next , let @xmath13 be a polytope in @xmath90",
    ". then one can consider the poset of all flags of faces of  @xmath13 ( chains in @xmath209 ) .",
    "the partial order is defined as follows : if @xmath256 and @xmath257 are two flags of faces of @xmath13 then @xmath258 if and only if @xmath259 is a subset of @xmath260 .",
    "this poset can be realized as the poset of faces of a simple polytope @xmath261 whose normal fan is the barycentric subdivision of the normal fan of @xmath13 .",
    "indeed , one can easily see that there is a 1 - 1 order preserving correspondence between codimension @xmath222 faces of @xmath261 and length @xmath222 flags of faces of @xmath13 .",
    "in particular , facets of @xmath261 correspond to flags of faces of length one , i.e. to faces of @xmath13 .",
    "later on we will be concerned with facet colorings not of the polytope @xmath13 itself , but the polytope @xmath261 associated with it . by the above , to define a facet coloring of @xmath261 we need to assign a non - empty proper subset of @xmath211 $ ] to every facet of @xmath261 , hence , to every face of @xmath13 .",
    "therefore , any map @xmath252}$ ] defines a facet coloring @xmath262}$ ] .",
    "( we should warn the reader , however , the map @xmath226 may not be a map of posets , in general . ) clearly , for every flag @xmath263 the union @xmath264 is the set of colors of the face of @xmath261 corresponding to this flag .",
    "we thus say that a _ flag @xmath263 is colored by @xmath264_. furthermore , @xmath265 is simplicial if and only if for any flag @xmath263 the union @xmath264 is proper .",
    "let @xmath3 be a projective toric variety of dimension @xmath1 defined by a lattice polytope @xmath13 , and let @xmath37 denote the normal fan of @xmath13 .",
    "consider a collection of @xmath0 ( monic ) monomials @xmath266 in the homogeneous coordinate ring @xmath41 $ ] of @xmath3 .",
    "assume that the product of the variables @xmath267 divides the product of the monomials @xmath268 .",
    "then the quotient @xmath269 has critical degree with respect to @xmath266 .    on the other hand ,",
    "since the variables @xmath61 correspond to the facet normals of @xmath13 , any collection of monomials @xmath270 with @xmath271 defines a facet coloring of  @xmath13 : @xmath272},\\quad c_z(q_\\rho)=\\{i\\in [ n+1]\\ , : \\ , x_\\rho|z_i\\},\\ ] ] where @xmath273 is the facet of @xmath13 whose inner normal generates @xmath52 .",
    "conversely , any facet coloring @xmath226 of @xmath13 defines a collection of squarefree monomials in @xmath8 whose product is divisible by the product of the variables : @xmath274 .",
    "if @xmath266 do not vanish simultaneously on @xmath3 then the corresponding coloring @xmath275 is simplicial . indeed , if @xmath275 is not simplicial then there is a vertex @xmath19 of @xmath13 which is colored by @xmath276 , i.e. @xmath277 for some facets @xmath278 , such that @xmath278 contains @xmath279 as one of its colors .",
    "but this implies that the corresponding point @xmath280 on @xmath3 lies on the irreducible divisors @xmath281 , where each @xmath282 is a component of the zero locus of @xmath283 on @xmath3 , a contradiction .",
    "the next theorem asserts that the combinatorial degree of @xmath275 equals the toric residue of the quotient @xmath269 .",
    "[ t : monomres]@xcite let @xmath3 be an @xmath1-dimensional projective toric variety defined by a lattice polytope @xmath13 .",
    "let @xmath266 be monomials in the homogeneous coordinate ring @xmath8 such that    1 .",
    "@xmath284 , 2 .",
    "@xmath266 do not vanish simultaneously on @xmath3 .",
    "then @xmath285 where @xmath275 is the simplicial coloring of @xmath13 defined by @xmath266 .      to reduce the computation of the toric residue for arbitrary polynomials to the case of monomials",
    "we will need the following generalized version of the global transformation law @xcite .",
    "[ t : gtl ] let @xmath286 and @xmath287 for @xmath288 .",
    "suppose @xmath289 where @xmath290 and @xmath291 are homogeneous of degree @xmath292 and @xmath293 respectively for some fixed degrees @xmath294 .",
    "assume that neither @xmath295 nor @xmath296 vanish simultaneously on  @xmath3 .",
    "let @xmath297 , @xmath298 , @xmath299 , and @xmath300 .",
    "then for any  @xmath301 , the polynomials @xmath302 and @xmath303 are of critical degree for @xmath78 and @xmath116 respectively , and @xmath304    for any @xmath301 the degree of @xmath302 is @xmath305 , which is the critical degree for @xmath31 . consider the @xmath0 homogeneous polynomials @xmath306 .",
    "according to the global transformation law ( theorem 0.1 , @xcite ) @xmath307 on the other hand , @xmath308 and @xmath303 has critical degree for @xmath309 .",
    "therefore , @xmath310 again by the global transformation law .",
    "the theorem follows .",
    "our reduction is then based on the following assertion .",
    "[ c : reduction ] let @xmath3 be an @xmath1-dimensional projective toric variety .",
    "let @xmath286 be homogeneous polynomials not vanishing simultaneously on @xmath3 .",
    "suppose @xmath311 and @xmath266 are squarefree monomials such that    1 .",
    "@xmath312 , 2 .",
    "@xmath313 for some @xmath314 , @xmath74 , 3 .",
    "@xmath266 do not vanish simultaneously on @xmath3 .",
    "then we have @xmath315 where @xmath275 is the simplicial facet coloring defined by @xmath266 .",
    "the first statement in ( [ e : reduction ] ) follows from theorem  [ t : gtl ] and the second statement follows from theorem  [ t : monomres ] .",
    "let @xmath13 be a lattice polytope in @xmath90 . consider any partition of the set of vertices of @xmath13 into @xmath0 disjoint ( possibly empty ) subsets : @xmath316 extend this partition to a partition of the set of lattice points of @xmath13 by adding to @xmath317 lattice points in the relative interior of faces containing a vertex from @xmath317 :",
    "@xmath318 any such extension ( [ e : indpart ] ) will be called an _ induced partition _ of @xmath319 defined by the _",
    "vertex partition _",
    "( [ e : vertpart ] ) .    now consider @xmath0 lattice polytopes @xmath16 in @xmath90 .",
    "for each polytope @xmath7 fix an ( ordered ) vertex partition @xmath320 we say that these partitions are _ compatible _ if for any permutation @xmath21 of @xmath276 @xmath321 where @xmath322 denotes the relative interior of @xmath13 .",
    "let @xmath16 be lattice polytopes in @xmath90 .",
    "then subsets @xmath323 , @xmath324 , form a _ partition matrix _ for @xmath16 if @xmath325 is a collection of induced partitions defined by a compatible collection of vertex partitions @xmath326    it is not hard to see that the compatibility condition on the @xmath327 ( [ e : compatibility ] ) implies the same condition on any induced partitions : @xmath328    [ ex : partition ] consider three polygons @xmath329 , @xmath330 and @xmath331 in figure  [ f : partition ] .",
    "we partition their lattice points in accordance with the labels : the set @xmath20 consists points of @xmath7 labeled with @xmath332 ( @xmath333 ) .    clearly these are induced partitions . to show that they are compatible it is enough to check that for any linear functional @xmath334 any three vertices @xmath335 , @xmath336 and @xmath337 that minimize @xmath338 on @xmath329 , @xmath330 and @xmath331 , respectively , will not have all different labels .",
    "let @xmath13 be a polytope in @xmath90 . recall that every vector @xmath338 in the dual space @xmath339 defines a face @xmath340 of @xmath13 on which @xmath338 restricted to @xmath13 attains its minimal value .",
    "let @xmath341 be a partition matrix for @xmath16 .",
    "define a map from @xmath339 to the set of @xmath342-matrices of dimension @xmath343 : @xmath344 where the value of @xmath345 at @xmath346 is the matrix @xmath347 whose @xmath348-th entry is @xmath349 the matrix @xmath347 is called the _ coloring matrix _ of @xmath338 .    informally speaking , the coloring matrix @xmath347 `` encodes '' the partitions of the lattice points of the @xmath7 restricted to the corresponding faces @xmath350 .",
    "the compatibility condition implies that for any non - zero @xmath338 the coloring matrix @xmath347 has permanent zero .",
    "indeed , if the permanent is non - zero then there exists a permutation @xmath21 of @xmath276 such that @xmath351 for all @xmath74 . by the definition of @xmath347",
    "this implies that for each @xmath279 there is a point @xmath352 in @xmath353 that lies on the face @xmath354 .",
    "but then the sum @xmath355 gives a point on the face @xmath340 of the minkowski sum @xmath356 , which contradicts the compatibility condition ( [ e : compatibility2 ] ) .",
    "the following statement is known as the frobenius - knig theorem ( it is also equivalent to hall s marriage theorem @xcite ) .",
    "[ t : f - k ] let @xmath357 be a @xmath342-matrix of dimension @xmath358 with zero permanent",
    ". then @xmath357 has a submatrix of zeroes of dimension @xmath359 for some positive @xmath360 such that @xmath361 .    by the above theorem for every non - zero @xmath338",
    "the @xmath343 matrix @xmath347 has a zero submatrix ( not unique , in general ) of dimension @xmath359 with @xmath362 .",
    "the rows ( resp .",
    "columns ) of the submatrix are indexed by a subset of @xmath276 which we denote by @xmath363 ( resp .",
    "@xmath364 ) .",
    "we thus have @xmath365 for all non - zero @xmath338 .    now consider a polytope @xmath13 whose normal fan @xmath37 is a common refinements of the normal fans of @xmath16 .",
    "clearly , @xmath347 is the same for all @xmath338 in the intersection of the cones of the @xmath354 .",
    "therefore , @xmath345 is constant on the cones of @xmath37 .",
    "since cones of @xmath37 correspond to faces of @xmath13 we arrive at the following definition .",
    "let @xmath341 be a partition matrix for @xmath16 .",
    "let @xmath13 be a polytope whose normal fan is a common refinements of the normal fans of @xmath16 . given a face @xmath94 of @xmath13 define its _ coloring matrix @xmath366 _ to be the coloring matrix of any @xmath367 , where @xmath368 is the cone of @xmath94 .",
    "we will need the following simple observation .",
    "let @xmath369 be faces of @xmath13 .",
    "then @xmath370      consider a projective @xmath1-dimensional toric variety @xmath3 defined by a projective fan @xmath37 .",
    "let @xmath15 be @xmath0 semi - ample degrees on @xmath3 and let @xmath16 be their polytopes .",
    "[ d : resmatrix ] consider a collection of @xmath0 homogeneous polynomials @xmath371 of degrees @xmath15 : @xmath372 given a partition matrix @xmath341 for @xmath16 define the _ residue matrix _ @xmath373 of @xmath78 to be the matrix whose entries are the homogeneous polynomials @xmath374    the determinant @xmath375 is a homogeneous polynomial of degree @xmath376 . since the @xmath11 are semi - ample , @xmath56 is also semi - ample and its polytope is the minkowski sum @xmath377 . as follows from the definition of homogeneous coordinates ( see ( [ e : homocoord ] ) ) a monomial @xmath55 of degree @xmath56 is divisible by all the variables if and only if the corresponding lattice point @xmath19 lies in the interior of the polytope of @xmath56",
    ". therefore , by the compatibility condition ( [ e : compatibility2 ] ) every monomial in @xmath375 is divisible by all the variables , and hence the quotient @xmath378 is a homogeneous polynomial of critical degree @xmath379 .",
    "[ p : resmatrix ] let @xmath15 be semi - ample degrees on @xmath3 with polytopes @xmath16 . fix a partition matrix @xmath341 for @xmath16 . for",
    "every coloring matrix @xmath380 , @xmath38 , make any choice of an @xmath359 zero submatrix with @xmath362 and let its rows and columns be indexed by subsets @xmath381 and @xmath382 of @xmath276 , respectively .",
    "define squarefree monomials @xmath383 then for any homogeneous polynomials @xmath31 of degrees @xmath15    1 .",
    "@xmath312 , 2 .",
    "@xmath313 for some @xmath314 , @xmath74 .",
    "moreover , @xmath291 can be chosen so that @xmath384 where @xmath373 is the residue matrix defined by the partition matrix @xmath341 .",
    "\\(1 ) for every @xmath38 the variable @xmath61 appears in the product @xmath268 with multiplicity @xmath385 and in @xmath386 with multiplicity @xmath387 since @xmath388 .",
    "\\(2 ) for every @xmath74 we have @xmath389 we need to show that every monomial @xmath390 is divisible by at least one of @xmath266 .",
    "since every monomial @xmath55 is divisible by a vertex monomial we can assume that @xmath19 is a vertex of @xmath7 .",
    "recall that in homogeneous coordinates @xmath391 where @xmath392 is a representative of @xmath11 ( see ( [ e : homocoord ] ) ) .",
    "therefore @xmath61 divides @xmath55 if and only if @xmath393 , where @xmath394 is the cone of @xmath101 corresponding to @xmath19 .",
    "the vertex @xmath19 is contained in @xmath20 for some @xmath288 .",
    "we show that @xmath395 divides @xmath390 .",
    "indeed , take any @xmath61 with @xmath396 containing @xmath332 . if @xmath397 then @xmath398 . from the definition of @xmath399 it follows that @xmath400 does not contain the vertex @xmath19 , i.e. @xmath393 and so @xmath401 by above .",
    "if @xmath402 then @xmath403 by the definition of @xmath404 .    the above argument shows that @xmath405 for some homogeneous polynomial @xmath291 . taking the determinant we obtain @xmath406 .",
    "now the last statement follows from part ( 1 ) .",
    "the above proposition shows that given a partition matrix @xmath341 , any choice of zero submatrices in @xmath399 , for @xmath38 , defines a collection of squarefree monomials @xmath311 and @xmath266 that satisfy the conditions ( 1 ) and ( 2 ) of corollary  [ c : reduction ] . if the facet coloring @xmath275 defined by the monomials @xmath266 is simplicial the condition ( 3 ) of corollary  [ c : reduction ] is satisfied and that would imply the result of theorem  [ t : main1 ] , namely that the residue of @xmath373 equals the combinatorial degree of @xmath275 .",
    "however , there are examples of @xmath16 when the condition ( 3 ) fails no matter how one chooses a partition matrix and zero submatrices . to avoid this obstruction we are going to change the variety @xmath3 by taking the barycentric refinement of its fan @xmath407 .",
    "this gives a birational morphism @xmath408 which allows us to transfer our construction to the variety @xmath409 ( see proposition  [ p : birational ] ) .",
    "the advantage of this is that for any partition matrix @xmath341 there is a canonical choice of a zero submatrix in every coloring matrix @xmath399 , for @xmath410 , which guarantees that the corresponding monomials @xmath411 do not vanish simultaneously on @xmath409 .",
    "let @xmath16 be @xmath0 lattice polytopes in @xmath90 and @xmath100 their normal fans .",
    "let @xmath13 be any polytope whose normal fan @xmath37 is a common refinement of the @xmath101 .",
    "given a partition matrix we will define a canonical facet coloring of a polytope @xmath261 whose normal fan @xmath412 is the barycentric refinement of @xmath37 .",
    "we will then prove that this coloring is simplicial .",
    "this will allow us to define monomials @xmath411 on the toric variety corresponding to @xmath261 that satisfy all the conditions of corollary  [ c : reduction ] and thus obtain our main result ( theorem  [ t : main1 ] ) .",
    "let @xmath341 be a partition matrix for polytopes @xmath16 and let the polytopes @xmath13 and @xmath261 be as above .",
    "as mentioned in section  [ s : facetcolor ] , to define a facet coloring of @xmath261 it suffices to assign a subset @xmath413 to every face @xmath94 of @xmath13 .",
    "we will start by describing all possible candidates for @xmath217 , so called admissible colorings of @xmath94 .",
    "let @xmath94 be a face of @xmath13 and @xmath366 its coloring matrix .",
    "a subset @xmath414 is called an _ admissible coloring of @xmath94 _ if @xmath366 contains an @xmath359 zero submatrix with @xmath362 whose columns are indexed by @xmath415 .",
    "it turns out that the set of admissible colorings of a face possesses very nice properties .",
    "first , for any flag of faces of @xmath13 we have the reversed inclusion of the corresponding sets of admissible colorings : @xmath416 where @xmath417 is the set of admissible colorings of @xmath418 . indeed , ( [ e : reverse ] ) implies that every zero submatrix in the coloring matrix of @xmath418 is also a zero submarix of the coloring matrix of @xmath419 .",
    "second , let @xmath366 be the coloring matrix of a face @xmath420 .",
    "( in what follows we will only use that @xmath366 is an @xmath343 matrix with @xmath342-entries and zero permanent . )",
    "denote by @xmath421 the set of all zero submatrices @xmath422 in @xmath366 of dimension @xmath359 such that @xmath362 .",
    "this set is non - empty by theorem  [ t : f - k ] .",
    "for @xmath423 we let @xmath424 ( resp .",
    "@xmath425 ) denote the subset in @xmath276 of indices of rows ( resp .",
    "columns ) of @xmath422 .",
    "we have the following lemma .",
    "[ l : lattice ] let @xmath426",
    ". then there is @xmath423 such that either @xmath427 or @xmath428 .",
    "let @xmath429 be the submatrix whose rows are indexed by @xmath430 and whose columns are indexed by @xmath431 .",
    "clearly @xmath429 is a zero submatrix .",
    "similarly , let @xmath432 be the zero submatrix with rows indexed by @xmath433 and columns indexed by @xmath434 .",
    "denote @xmath435 , @xmath436 , and @xmath437 . by the inclusion / exclusion formula @xmath438 .",
    "similarly , @xmath439 , where @xmath440 , @xmath441 , and @xmath442 . summing up these two equations we obtain @xmath443 therefore , either @xmath444 or @xmath445 . in other words , either @xmath429 or @xmath432 contains a zero submatrix @xmath422 with @xmath362 , as required .",
    "the above lemma means that if @xmath446 and @xmath447 are two admissible colorings of @xmath94 then either @xmath448 or @xmath449 is also an admissible coloring .",
    "as follows from the proof , a slightly stronger statement is true : if @xmath449 is not an admissible coloring then any single color can be removed from @xmath448 and the remaining set will still be an admissible coloring of  @xmath94 .",
    "[ l : canonical ] let @xmath421 be as above and consider the partially ordered by inclusion set @xmath450 let @xmath451 be the set of maximal elements , and @xmath452 the set of minimal elements of @xmath453 . then the subsets @xmath454 belong to @xmath453 and satisfy @xmath455 .    to prove @xmath456 we show that @xmath457 for any @xmath458 , @xmath459 .",
    "we proceed by induction .",
    "the case @xmath460 is trivial .",
    "assume @xmath461 and let @xmath462 .",
    "if @xmath463 we are done , otherwise @xmath464 by lemma  [ l : lattice ] .",
    "since @xmath465 is maximal we have @xmath466 , i.e. @xmath467 .",
    "similar arguments show that @xmath468 .    to show @xmath455 it is enough to notice that for any @xmath469 and any @xmath470 we have @xmath471 . indeed , either @xmath472 and so @xmath473 by minimality of @xmath415 , or @xmath474 and so @xmath475 by maximality of @xmath476",
    "the above lemma supplies us with two canonical coloring of a face @xmath94 :    let @xmath366 be the coloring matrix of a face @xmath420 and @xmath477 the set of all admissible colorings of @xmath94 .",
    "maximal ( minimal ) elements of @xmath477 are called _ maximal ( minimal ) colorings _ of @xmath94 .",
    "the union @xmath478 of minimal colorings is called the _ minimal canonical coloring _ of @xmath94 .",
    "the intersection @xmath217 of maximal colorings is called the _ maximal canonical coloring _ of @xmath94 .",
    "consider the three polygons @xmath329 , @xmath330 and @xmath331 from example  [ ex : partition ] .",
    "let @xmath94 be the horizontal edge of the minkowski sum @xmath479 .",
    "then it has the coloring matrix @xmath480.\\ ] ] we get @xmath481 and @xmath482 .",
    "next let @xmath483 be the edge of @xmath13 with @xmath484 slope .",
    "( it is the sum of the highest vertex of @xmath329 and the two edges of @xmath330 and @xmath331 of slope @xmath484 . )",
    "its coloring matrix is @xmath485.\\ ] ] this time we have @xmath486 and @xmath487 , @xmath488 .    to obtain less trivial example we need to consider the case @xmath489 .",
    "here is an example of a coloring matrix whose set of admissible colorings has more than one maximal ( and minimal ) element .",
    "@xmath490.\\ ] ] indeed , the set of admissible colorings is @xmath491 .",
    "therefore , @xmath492 and @xmath493 .",
    "according to the discussion in section  [ s : facetcolor ] the maps @xmath494 and @xmath495 defined above give rise to two facet coloring @xmath496 and @xmath265 of @xmath261 which we call the minimal and maximal canonical facet colorings of @xmath261 , respectively .",
    "it is easy to see that under @xmath265 no facet of @xmath261 gets all the colors .",
    "indeed , for any face @xmath420 its coloring matrix @xmath366 can not contain zero rows , thus every maximal coloring @xmath497 is a proper subset of @xmath276 .",
    "the next theorem shows that an even stronger statement is true : no face of @xmath261 gets all the colors .",
    "[ t : simplicial ] the maximal and minimal canonical facet colorings of @xmath261 are simplicial and have the same combinatorial degree .",
    "recall from section  [ s : facetcolor ] that to prove @xmath265 simplicial we need to show that for any maximal flag of faces of @xmath13 @xmath498 the union @xmath499 is a proper subset of @xmath276 .",
    "we will prove by induction that for any @xmath500 @xmath501 for some maximal coloring @xmath502 of @xmath503 .",
    "for @xmath504 this implies the statement of the theorem , since @xmath505 is a proper subset of @xmath276 .",
    "the base @xmath506 is clear since @xmath507 is the intersection of maximal elements of @xmath508 . for the inductive step assume that ( [ e : ih ] ) is true for some maximal @xmath509 . by ( [ e : reverse2 ] )",
    "@xmath510 , thus there exists a maximal element @xmath511 such that @xmath512",
    ". also @xmath513 , by definition .",
    "this together with ( [ e : ih ] ) gives @xmath514 as required .",
    "by lemma  [ l : canonical ] @xmath515 for any face @xmath420",
    ". therefore , @xmath496 is also simplicial .",
    "finally , @xmath516 follows from proposition  [ p : refinement ] .",
    "when the maximal canonical coloring of a face consists of a single element we can say more about admissible colorings of this face :    [ l : singlecolor ] suppose a face @xmath420 is maximally canonically colored by a single color @xmath517 .",
    "then this is the only admissible coloring of @xmath94 .",
    "moreover , any face containing @xmath94 is also singly canonically colored by @xmath249 while every subface of @xmath94 is canonically colored by a set containing @xmath222 .",
    "suppose @xmath518 , @xmath519 , are maximal colorings of @xmath94 such that @xmath520 , but @xmath521 . by the proof of lemma  [ l : canonical",
    "] @xmath522 is an admissible coloring of @xmath94 . by the remark after lemma  [ l : lattice ] @xmath94 can either be colored by @xmath523 or else by @xmath524 with any single color removed .",
    "the first is a coloring strictly larger than @xmath525 which is impossible since @xmath525 is maximal .",
    "the second is empty since @xmath524 is already a single color .",
    "both are contradictions .",
    "thus , the unique maximal coloring of @xmath94 is @xmath249 which is therefore the only admissible coloring .    if @xmath526 then @xmath527 by ( [ e : reverse2 ] ) and , hence , @xmath528 .",
    "if @xmath529 then @xmath249 is an admissible coloring of @xmath530 . but @xmath249 can be appended to any coloring of @xmath530 .",
    "thus @xmath222 is contained in every maximal coloring of @xmath530 , i.e. in the maximal canonical coloring of @xmath530 .",
    "we now turn back to residues and prove the result of theorem  [ t : main1 ] . as before @xmath3 is a complete @xmath1-dimensional toric variety defined by a fan @xmath37 and @xmath15 are semi - ample degrees with polytopes @xmath16 .",
    "we can assume that @xmath3 is projective and take @xmath13 to be the polytope of an ample divisor on @xmath3 ( if @xmath3 is not projective it can be dominated birationally by a projective toric variety .",
    "this will not affect the toric residue computation by proposition  [ p : birational ] . )",
    "we also let @xmath261 denote a polytope whose normal fan is the barycentric subdivision of @xmath37 .",
    "let @xmath341 be a partition matrix for @xmath16 . according to section  [ s : canonical ] @xmath341 produces a map @xmath252}$ ] which assigns to every proper face @xmath94 of @xmath13 its maximal canonical coloring @xmath217 .",
    "the induced canonical facet coloring @xmath265 of @xmath261 is simplicial by theorem  [ t : simplicial ] .",
    "the next theorem says that for any @xmath31 of degrees @xmath15 the determinant of the residue matrix @xmath373 ( see definition  [ d : resmatrix ] ) gives an element whose residue is the combinatorial degree of @xmath265 .",
    "let @xmath3 be a complete toric variety of dimension @xmath1 .",
    "let @xmath15 be semi - ample degrees and @xmath16 their polytopes .",
    "consider a partition matrix @xmath341 for @xmath16 .",
    "for any collection of homogeneous polynomials @xmath31 of degrees @xmath15 consider the corresponding residue matrix @xmath373 .",
    "then the residue of @xmath378 is equal to the combinatorial degree of the canonical facet coloring of @xmath261 : @xmath531    first notice that we can work on the variety @xmath409 defined by the polytope @xmath261 .",
    "indeed , let @xmath532 be the birational morphism defined by the barycentric refinement @xmath407 and @xmath533 the induced homomorphism of homogeneous coordinate rings .",
    "then each polynomial @xmath534 is of semi - ample degree @xmath535 and by proposition  [ p : birational ] @xmath536 where @xmath537 and @xmath538 , for @xmath539 .    since the degrees",
    "@xmath540 have the same polytopes",
    "@xmath7 we did not change the partition matrix and the pullback @xmath541 is the residue matrix @xmath542 for the @xmath543 .",
    "therefore we can apply proposition  [ p : resmatrix ] for the canonical facet coloring of @xmath261 to obtain squarefree monomials @xmath544 and @xmath411 in @xmath545 which satisfy    1 .",
    "@xmath546 , 2 .",
    "@xmath547 for some @xmath548 , @xmath74 , 3 .",
    "@xmath411 do not vanish simultaneously on @xmath409 , 4 .",
    "@xmath549 .",
    "( part ( 3 ) follows since the @xmath550 define the canonical facet coloring @xmath265 of @xmath261 which is simplicial according to theorem  [ t : simplicial ] . ) by corollary  [ c : reduction ] @xmath551 which completes the proof .",
    "in this section we consider the special case when the @xmath0 polytopes share a complete flag of faces .",
    "an essential family of degrees with such collection of polytopes is called locally unmixed .",
    "we show that for any family of locally unmixed degrees one can write an explicit partition matrix yielding an element of residue @xmath33 ( theorem  [ t : loc_unmixed ] ) .",
    "polytopes @xmath552 are said to _ share a complete flag _ if for each @xmath7 there is a complete flag of faces : @xmath553such that the sums of the corresponding entries @xmath554 form a complete flag of faces of @xmath555 : @xmath556    an immediate consequence of the above definition is that if @xmath140 is any non - empty subset of @xmath557 we can similarly define @xmath558 such that the @xmath559 also form a complete flag of faces of @xmath560 : @xmath561    let @xmath3 be a complete toric variety of dimension @xmath1 .",
    "an essential family of semi - ample degrees @xmath136 is said to be _ locally unmixed _ if the corresponding polytopes @xmath5 share a complete flag .",
    "note that the @xmath7 themselves may be only @xmath562 dimensional , although at least two of them must be @xmath1-dimensional since the family is essential .",
    "[ t : loc_unmixed ] let @xmath136 be locally unmixed degrees on @xmath3 .",
    "define partitions : @xmath563 this is a compatible collection of partitions and the corresponding residue matrix gives an element of residue @xmath32 for any homogeneous polynomials @xmath564 not vanishing simultaneously on @xmath3 .",
    "before we begin the proof let us illustrate the partition using the following 3-dimensional example .",
    "consider four 3-dimensional polytopes @xmath329 , @xmath330 , @xmath331 and @xmath565 as in figure  [ f : polytopes ] .",
    "they share a complete flag of faces .",
    "indeed , each of them has a face with inner normal @xmath566 and this face has an edge along the vector @xmath567 .",
    "then for each @xmath568 set @xmath569 consists of the vertex of the flag ( point marked as `` 0 '' ) , set @xmath570 consists of the other lattice points on the edge of the flag ( lattice points marked as `` 1 '' ) , set @xmath571 consists of the lattice points on the face of the flag , but not on the edge ( points marked as `` 2 '' ) , and the rest of the lattice points constitute @xmath572 ( points marked as `` 3 '' ) .",
    "@xmath573    we start with a simple lemma .    [",
    "l : sum ] let @xmath13 be a polytope of dimension @xmath1 and @xmath574 a polytope such that @xmath575 is also a polytope of dimension @xmath1 . for any facet @xmath576 of @xmath13",
    "there is a unique face @xmath483 of @xmath574 such that @xmath577 is a proper face ( in fact a facet ) of @xmath575 .",
    "hence , if @xmath578 is a point in the relative interior of @xmath576 and @xmath579 is not on the corresponding face @xmath483 of @xmath574 then @xmath580 is in the interior of @xmath581 .",
    "let @xmath90 be the affine span of @xmath13 .",
    "since @xmath575 is also @xmath1-dimensional , we must have @xmath582 and @xmath583 .",
    "for any facet @xmath576 of @xmath13 there is a unique linear functional ( up to scaling ) @xmath584 minimized on @xmath576 in @xmath13 .",
    "let @xmath483 be the unique maximal face of @xmath574 on which @xmath585 is minimized .",
    "the minkowski sum @xmath577 is the facet of @xmath575 on which @xmath585 is minimized and conversely any face of @xmath575 with @xmath576 a summand must minimize @xmath585 and so must be @xmath577 .    for the second statement ,",
    "note that @xmath576 is the only face of @xmath13 containing @xmath19 . by the first part",
    ", every face @xmath530 of @xmath574 such that @xmath586 is contained in a proper face of @xmath575 must have @xmath587 . as a consequence",
    "if @xmath588 is not on @xmath483 , hence not on any such @xmath530 , @xmath580 is not contained in any proper face of @xmath575 .",
    "the lattice point partitions @xmath20 are induced from the vertex partitions obtained from the same rule restricted to the vertices of the @xmath7 . to show that @xmath341 is a partition matrix",
    "we must show that : @xmath589 for any permutation @xmath21 of @xmath22 .",
    "we will show by induction that @xmath590 for @xmath591 .",
    "the case @xmath592 is our desired result .",
    "let @xmath593 .",
    "hence , the right hand side is @xmath594 , a polytope of dimension @xmath332 .",
    "the case @xmath595 is trivial . for the induction , we assume @xmath596    next",
    ", @xmath597 is a facet of @xmath598 ( the case @xmath592 requires that @xmath599 is actually @xmath1-dimensional ) , so we apply lemma  [ l : sum ] .",
    "any point in @xmath600 lies in the interior of @xmath597 , and any point in @xmath601 does not lie on the associated face @xmath602 of @xmath603 .",
    "therefore , by lemma  [ l : sum ] , any point in @xmath604 is in the ( relative ) interior of @xmath605 as desired .    to show that the combinatorial degree of the maximal canonical coloring of @xmath606 is @xmath33 we apply theorem  [ t : flags ] . recall that a face of codimension @xmath222 of @xmath606 is a flag of @xmath222 faces @xmath607 of @xmath13 .",
    "we show that there is only one complete flag of faces of @xmath606 colored @xmath608 , namely @xmath609 .    to do this we prove a few simple lemmas :    [ l : lem1 ] the maximal canonical coloring of the face @xmath610 for @xmath611 is @xmath612 .",
    "the polytope @xmath239 is the minkowski sum of @xmath613 , and each @xmath614 contains precisely all of the lattice points in @xmath615 for @xmath616 .",
    "thus , the corresponding coloring matrix for @xmath239 has all @xmath14 s in columns @xmath617 and all @xmath151 s in columns @xmath618 .",
    "it follows immediately that the only maximal coloring is @xmath612 , as desired .",
    "[ l : lem2 ] the maximal canonical coloring of any proper subface of @xmath239 other than @xmath619 contains some color @xmath222 with @xmath620 .",
    "let @xmath94 be a proper subface of @xmath239 .",
    "we decompose @xmath94 as the minkowski sum @xmath621 where each @xmath418 is a subface of @xmath622 . if @xmath592 and if @xmath94 were a counterexample to the lemma it would have to be colored just @xmath623 .",
    "the last column of its coloring matrix is @xmath151 .",
    "consequently @xmath418 contains no points of @xmath624 and so is entirely contained in @xmath625 .",
    "so we can reduce to the case @xmath611 and assume that each @xmath418 is a _ proper _ subface of @xmath622 .",
    "now assume @xmath626 .",
    "we show that we can take @xmath222 to be the smallest number such that for all @xmath279 , @xmath627 .",
    "if @xmath628 for some @xmath279 then as @xmath418 is a proper face of @xmath622 we must have @xmath629 .",
    "this is a facet of @xmath622 , so repeated applications of lemma  [ l : sum ] show that every other summand @xmath630 and so @xmath631 , a contradiction .",
    "therefore , @xmath632 .    by hypothesis , for some @xmath279 , @xmath633 but @xmath634 .",
    "in particular @xmath635 .",
    "if @xmath636 for some @xmath637 , then another application of lemma  [ l : sum ] shows that @xmath638 contains a point in the relative interior of @xmath639 and so must contain the entire face .",
    "but this would imply @xmath418 contains @xmath640 , a contradiction .",
    "therefore , in the coloring matrix of @xmath94 coming from @xmath341 , the entire column @xmath641 is 0 and so @xmath222 is part of the canonical maximal coloring of @xmath94 as desired .",
    "our desired result now follows by induction . by lemma  [ l : lem1 ] , @xmath642 is colored just @xmath623 and by lemma  [ l : lem2 ] it is the only such face of @xmath13 ( facet of @xmath606 ) .",
    "inductively , the face of @xmath606 given by the flag of faces @xmath643 in @xmath13 is colored @xmath644 . for the next step we must add a subface of @xmath239 to the flag with @xmath332 the only new color .",
    "but by lemma  [ l : lem1 ] and lemma  [ l : lem2 ] , the only such subface is @xmath619 .",
    "in this section we prove that matrices whose determinant have residue @xmath33 can be found for almost all essential , two - dimensional families of degrees .",
    "recall the definition of essential in definition  [ d : essential ] . in the special case @xmath2",
    ", essential means that no @xmath7 is zero dimensional , and while some or all of the @xmath7 may be one dimensional line segments , no two such are parallel line segments .",
    "we will show we can always find a residue matrix that gives an element of residue @xmath33 in all but one exceptional case .",
    "degrees @xmath645 are _ exceptional _ if for two of them , @xmath11 and @xmath646 , the corresponding polygons @xmath7 and @xmath647 are 1-dimensional , and the third @xmath648 is an ample divisor on the toric variety defined by @xmath649 .",
    "let @xmath645 be an essential , non exceptional family of degrees on a toric surface @xmath3 .",
    "there exists a partition matrix for the @xmath11 which yields an element of residue @xmath33 for every set of @xmath564 without a common root .",
    "note that the codimension 1 theorem for the critical degrees has been proved by cox and dickenstein @xcite when all @xmath11 are full dimensional .",
    "such a case , of course , will never be exceptional .",
    "it is , however possible for the critical degree to be of codimension 1 , in which case the residue map is an isomorphism , and still be exceptional .",
    "see example  [ ex : exbad ] below .",
    "let @xmath650 be the corresponding polygons and @xmath651 their minkowski sum .",
    "every edge @xmath652 of @xmath13 is the sum of edges from one or more of the @xmath7 and vertices from the others .",
    "label an edge by a subset of @xmath653 consisting of those polygons for which the summand of @xmath652 is an edge .",
    "now consider consecutive edges of @xmath13 .",
    "proceed until we have a sequence containing all three labels @xmath654 .",
    "take the smallest subsequence with this property .",
    "we then have the following cases :    1 .",
    "the sequence has length @xmath14 , so there is a single edge labeled @xmath655 .",
    "this will be the locally unmixed case .",
    "2 .   the sequence has length @xmath656 . up to relabeling and change of direction",
    "the sequence will be either : 1 .",
    "@xmath657 or 2 .",
    "+ such sequences will be called _ partially unmixed_. 3 .",
    "the sequence has length @xmath659 or more .",
    "all such sequences can be represented as + @xmath660{0.4}{1}}\\,,\\ , \\boxed{1}\\,,\\ ,   \\textcolor[gray]{0.4}{\\boxed{1}}\\ , , \\dots,\\ , \\textcolor[gray]{0.4}{\\boxed{1}}\\,,\\ , \\boxed{\\textcolor[gray]{0.4}{1}\\ , 2}$ ] .",
    "+ the numbers in gray may or may not occur .",
    "that is to say , the first term must contain label @xmath151 but may or may not contain @xmath14 .",
    "similarly for the final term must contain label @xmath656 and possibly also label @xmath14 .",
    "there is at least one term labeled just @xmath14 in the middle , but there may be others .",
    "altogether , sequences of this type will be called _",
    "generically mixed_.    case 1 : :    the three degrees share an edge , hence share a complete flag    consisting of this edge and either of the two vertices .",
    "so the    polygons are locally unmixed in the sense of the previous section .",
    "therefore , we know we can always find a partition yielding a residue    @xmath14 matrix .",
    "we illustrate the partition via the diagram in    figure  [ f : lup ] .",
    "+    +    each of the three figures represents one of the three polygons .",
    "the    edge @xmath661 on the bottom is shared by all three polygons .",
    "the white vertex in each @xmath7 is in partition set    @xmath569 hence marked as `` @xmath151 '' in the    diagram , the rest of the lattice points on @xmath661 are in    set @xmath570 , and finally any lattice points off of    @xmath661 are in set @xmath571 .",
    "hence the partition    matrix @xmath20 is exactly the one constructed in the    previous section . since the polygons are essential , at most one of    them is @xmath14-dimensional , thus two of them , say    @xmath329 and @xmath331 as shown , have at least one    point off the edge @xmath661 marked `` 2 '' .",
    "case 2a : :    the polygons are partitioned according to figure  [ f : case2a ] .",
    "+    +    there are two distinguished edges @xmath661 and    @xmath662 .",
    "polygons @xmath329 and @xmath330    share a complete flag along edge @xmath661 and are partitioned    accordingly into three sets @xmath569 ,    @xmath570 , and @xmath571 for    @xmath663 as shown .",
    "but , this time the third polygon    @xmath331 has only one point on @xmath661 represented    by the dotted line .",
    "this point is put into set @xmath664    and all other points of @xmath331 are put into set    @xmath665 . notice that in the third polygon    @xmath666 .",
    "also note that @xmath329 and    @xmath330 each have only one point ( marked `` 1 '' ) on the    dotted lines representing edges parallel to @xmath662 .    +    to see that this is a partition matrix we must show that the sum of    lattice points in @xmath569 , @xmath667 , and    @xmath668 with @xmath669 is in the interior of @xmath13 . from the diagram    this corresponds to taking three points marked `` 0 '' , `` 1 '' and `` 2 ''    respectively from three different polygons and showing they can not all",
    "lie on parallel edges with the same inner normal .",
    "if `` 0 '' and `` 1 ''    come from the first two polygons then their sum is in the interior of    the edge @xmath661 of the two - dimensional ( by essentiality )    sum of @xmath329 and @xmath330 . by definition",
    "however    a point marked `` 2 '' from @xmath331 is not on this edge .",
    "+    if instead `` 0 '' comes from the @xmath331 and `` 1 '' comes from    @xmath329 or @xmath330 the minkowski sum of these two    points is either the vertex lying only on edges @xmath661 and    @xmath662 or in the interior of @xmath661 . however ,    the points marked `` 2 '' from the third polygon @xmath329 or    @xmath330 are not on either of these two edges .",
    "+    for the combinatorial degree we apply lemma  [ l : singlecolor ] .",
    "this    shows that any face of @xmath13 ( facet of    @xmath606 ) maximally canonically colored by    @xmath670 must only be colored by @xmath670 .",
    "such a    face must have its coloring matrix with @xmath14 s only in the    first two columns .",
    "it is easy to see from the picture that this can    only happen for the bottom edge @xmath661 .",
    "it is also easy to    see that the two vertices of this edge are colored    @xmath671 and @xmath672 respectively . in    particular",
    "there is a unique complete flag colored    @xmath673 , as desired .",
    "case 2b : :    the difference between case 2a and case 2b is that @xmath330    now also contains an edge parallel to @xmath662 .",
    "one attempt    to account for this would be to use the same partition as in case 2a    above except all the lattice points in @xmath330 along the    edge @xmath662 are placed in @xmath674 .",
    "+    if this were a partition matrix , edge @xmath661 would remain    the only edge colored just @xmath675 and its vertices would    still be colored @xmath671 and @xmath672 .",
    "+    to check if this is a partition matrix , most of the arguments from the    previous case go through .",
    "if we take points marked `` 0 '' from    @xmath331 and `` 1 '' from @xmath329 or    @xmath330 , the sum is either the vertex between edge    @xmath661 and @xmath662 or in the interior of one of    these edges .",
    "taking `` 0 '' from @xmath330 and `` 1 '' from    @xmath329 again yields a point in the interior of edge    @xmath661 .",
    "however , if we take `` 0 '' from @xmath329    and `` 1 '' from @xmath330 there is a problem if there is some    edge other than @xmath661 passing through both these points .    but",
    "this can only happen if the edge @xmath676 of    @xmath329 directly before @xmath661 passes through the    endpoint of @xmath662 in @xmath330 , marked `` 1 '' as in    figure  [ f : case2b1 ] .",
    "+    +    in this case the partition fails , so we try to partition in a    different way , reversing the roles of @xmath661 and    @xmath662 as in figure  [ f : case2b2 ] .",
    "+    +    just as before this partition works as long as the next edge    @xmath677 of @xmath331 after @xmath662 does    not pass through the left endpoint of @xmath661 in    @xmath330 . if both of the above attempts fail , we have that    the edge @xmath676 of @xmath329 before    @xmath661 passes through the end point of @xmath662 in    @xmath330 , and the edge @xmath677 of @xmath331    after @xmath662 passes through the left endpoint of    @xmath661 in @xmath330 .",
    "+    in this final case , we show that we can find a partition matrix unless    we are in the exceptional case .",
    "first , assume that one of    @xmath329 or @xmath331 is actually two - dimensional .",
    "assume without loss of generality it is @xmath329 .",
    "take the    partition in figure  [ f : case2b3 ] .    +    +    once again , a sum of points marked `` 0 '' from @xmath329 and    `` 1 '' from @xmath330 must lie on the interior of    @xmath661 which contains no points marked `` 2 '' from    @xmath331 . if we take `` 0 '' from @xmath330 then all    the edges on which it lies are between @xmath661 and    @xmath676 .",
    "but since @xmath329 was assumed    two - dimensional , the only such edge that could pass through a point    marked `` 1 '' is @xmath661 itself .",
    "+    if we take `` 1 '' from @xmath331 we must lie on an edge of    @xmath331 on or before @xmath662 but on or after    @xmath677 . the edge @xmath662 passes only through    points marked `` 1 '' or `` 2 '' in @xmath329 and    @xmath330 .",
    "the next edge before @xmath662 is    @xmath661 which passes through only `` 0 '' and `` 1 '' in    @xmath329 and @xmath330 .",
    "furthermore all edges before    @xmath661 and on or after @xmath677 pass only through    `` 0 '' in @xmath330 and , since @xmath676 is before    @xmath677 , only through `` 0 '' in @xmath329 .",
    "in every    case we do not get three points from different partition sets from    three different polygons all lying on the same edge",
    ".    +    a similar argument with an analogous partition applies if    @xmath331 is two - dimensional .",
    "finally , if both    @xmath329 and @xmath331 are one - dimensional , the only    way the partition above can fail is if the edge @xmath676 ,    parallel to @xmath661 , which is known to go through a point    marked `` 2 '' in @xmath330 , also goes through a point marked    `` 0 '' . but this can only happen if this is the only other point of    @xmath330 and moreover the edge connecting this point to the    endpoint of @xmath661 is parallel to @xmath677 which    is also parallel to @xmath662 .",
    "in other words , we must have    @xmath330 have the same normal fan as the minkowski sum of the    two non - parallel segments that are @xmath329 and    @xmath331 .",
    "that is to say we are in the exceptional case .",
    "case 3 : :    the mixed case is somewhat easier and is partitioned as in    figure  [ f : mixed ] .",
    "+    +    there are now three edges @xmath661 , @xmath662 , and    @xmath676 .",
    "there may actually be several edges of    @xmath330 between @xmath662 and @xmath676 in    which case @xmath661 is the left most such edge .",
    "the edge    @xmath662 intersects @xmath330 in either a point or a    whole edge , marked as a dashed line in the diagram .",
    "all of the points    on this edge are placed in set @xmath678 .",
    "the edge    @xmath662 together with @xmath661 and all other edges    before @xmath676 intersects @xmath331 in a single    point , represented by the dotted lines , placed in partition set    @xmath664 hence also marked `` 0 '' in the diagram .",
    "the edge    @xmath676 together with @xmath661 and all other edges    before @xmath676 intersects @xmath329 in a single    point placed in set @xmath679 finally @xmath676    intersects @xmath330 in either a single point or a whole edge    marked by a dashed line and all of the points are in set    @xmath674 .",
    "all the points in @xmath330 on the edges    between @xmath662 and @xmath676 are also in set    @xmath674 .",
    "all other lattice points in each    @xmath7 is in partition set @xmath571 thus marked    as `` 2 '' .",
    "+    to show that this is a partition matrix we must take a point marked    `` 1 '' from @xmath329 or @xmath151 from @xmath331    ( otherwise we would have to take `` 2 '' from both ) . first if we took    both `` 0 '' from @xmath331 and `` 1 '' from @xmath329 ,    then their minkowski sum is on both @xmath662 and    @xmath676 .",
    "however any point marked `` 2 '' from    @xmath330 is on neither edge nor any edge in between .",
    "if we    took `` 0 '' from @xmath331 and `` 1 '' from @xmath330 ,    the minkowski sum is a point lying only on edges on or between    @xmath661 and @xmath676 .",
    "however , any point marked    `` 2 '' from @xmath329 is not on any of these edges .",
    "the case of    `` 1 '' from @xmath330 is similar .",
    "+    for combinatorial degree we note that the only edge colored just    @xmath675 is the edge @xmath661 . every other edge    either intersects a point marked `` 2 '' or , if it is one of the other    edges missing `` 2 '' , can be colored @xmath680 .",
    "the two    vertices of this edge are colored @xmath672 , and    @xmath681 respectively , completing the combinatorial    degree computation .",
    "to finish we show that an exceptional set of degrees _ never _ has a compatible vertex partition resulting in an element of residue one .",
    "[ p : exceptional ] let @xmath645 be an exceptional family of degrees on a two - dimensional toric variety @xmath3 . any compatible vertex partition yields a residue matrix with determinant zero .",
    "we can assume that the corresponding polygons @xmath329 and @xmath330 are one - dimensional and @xmath331 has the same normal fan as @xmath682 .",
    "therefore @xmath329 and @xmath330 each have two vertices which we denote by @xmath335 , @xmath336 and @xmath683 , @xmath684 , and @xmath331 has four vertices @xmath685 , @xmath686 , @xmath687 , @xmath688 . for each pair",
    "@xmath352 , @xmath689 there is a unique @xmath690 such that @xmath691 .",
    "now suppose we have a compatible vertex partition with associated partition matrix @xmath341 .",
    "if @xmath335 and @xmath336 are in the same partition set , by the above we know there do not exist @xmath689 , @xmath690 such that both @xmath692 and @xmath693 are in @xmath694 . hence , there are no non - zero terms in the expansion of the determinant of the induced residue matrix .",
    "if @xmath335 , @xmath336 , @xmath683 , @xmath684 all lie in two columns of the partition matrix , then again there is no possible compatible choice of @xmath690 in the complementary entry and the induced residue matrix will have determinant zero .",
    "therefore , up to relabeling we are left with only one choice of partition matrix of the form :    @xmath695    for compatibility each of @xmath696 can only contain a unique vertex @xmath690 .",
    "but this implies there is some vertex @xmath690 which can not lie in any of the @xmath696 , a contradiction .",
    "hence there are no non - trivial compatible partition matrices .",
    "in particular there is no partition yielding an element of residue one .",
    "this last result shows that while we know for essential degrees there must always exist a polynomial of residue one by theorem  [ t : nonzero ] , it can not always be obtained as the determinant of a matrix . on the flip side the method does work for all but one quite degenerate situation .",
    "we illustrate this by constructing residue matrices for some examples .",
    "consider the polynomials :    @xmath697    the newton polygons are shown in figure  [ f : dim2example1 ] with the lattice points labeled by their corresponding coefficients .",
    "this falls under case 3 of the previous theorem so applying the partition as in figure  [ f : partition ] yields the following residue matrix : @xmath698 the determinant is @xmath699 this is a polynomial supported on the interior of the minkowski sum @xmath700 .",
    "the homogenization up to critical degree has toric residue equal to 1 .",
    "consider the polynomials :    @xmath701    the corresponding newton polygons are shown in figure  [ f : dim2example2 ] .",
    "these polygons can be classified under case 2a of the above theorem . as such we get the following residue matrix : @xmath702",
    "the determinant is @xmath703 which is supported in the interior of @xmath700 ( consisting of two points ) .",
    "once again the homogenization up to critical degree yields the desired element of residue 1 .",
    "[ ex : exbad ]    let us now consider an exceptional system : @xmath704 the newton polygons consists of two line segments and their minkowski sum ( a square ) .",
    "since we are in the exceptional case the theorem does not apply .",
    "however , there is a unique interior point of the minkowski sum , so the critical degree is trivial .",
    "thus , there is a unique element of residue @xmath14 , namely the resultant itself which in this case is : @xmath705 by proposition  [ p : exceptional ] this polynomial is not expressible as the determinant of a residue matrix .",
    "given a collection of @xmath0 semi - ample divisors on a toric variety @xmath3 which do not have a common zero , there exists a toric residue map which is not identically zero if and only if the degrees of the divisors are essential .",
    "the goal of this work was to explicitly construct an element of residue one .",
    "we have shown how compatible partitions of the newton polytopes lead to matrices whose determinant is an element of critical degree with toric residue equal to a certain integer constant , namely the combinatorial degree of a canonical induced coloring . in the case",
    "the polytopes share a complete flag of faces and in almost every case in dimension 2 we have shown how to choose this partition to yield an element of residue exactly one .",
    "the most obvious open question is to find compatible partitions yielding elements of residue one in higher dimensions when the polytopes do not necessarily share a complete flag .",
    "we have computed a large number of examples in dimension three where the four polytopes are simplices . in every case",
    "we have found working partitions .",
    "of course there will be exceptional families , as in dimension two , where no such partitions exist .",
    "however , it is hoped that these will be relatively rare and perhaps nonexistent in the most important case when the polytopes are all full dimensional .",
    "this project was inspired by discussions with eduardo cattani and alicia dickenstein .",
    "we would like to especially thank david cox for his careful proofreading of the text and all of his advice and suggestions ."
  ],
  "abstract_text": [
    "<S> the toric residue is a map depending on @xmath0 divisors on a complete toric variety of dimension @xmath1 . </S>",
    "<S> it appears in a variety of contexts such as sparse polynomial systems , mirror symmetry , and gkz hypergeometric functions . in this paper </S>",
    "<S> we investigate the problem of finding an explicit element whose toric residue is equal to one . </S>",
    "<S> such an element is shown to exist if and only if the associated polytopes are essential . </S>",
    "<S> we reduce the problem to finding a collection of partitions of the lattice points in the polytopes satisfying a certain combinatorial property . </S>",
    "<S> we use this description to solve the problem when @xmath2 and for any @xmath1 when the polytopes of the divisors share a complete flag of faces . </S>",
    "<S> the latter generalizes earlier results when the divisors were all ample . </S>"
  ]
}