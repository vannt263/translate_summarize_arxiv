{
  "article_text": [
    "the directed last passage percolation ( dlpp ) problem can be formulated as follows : let @xmath0 be nonnegative independent random variables defined on the lattice @xmath1 , and define the last passage time from @xmath2 to @xmath3 by @xmath4 where @xmath5 denotes the set of up / right paths from @xmath2 to @xmath3 in @xmath1",
    ". of interest are the asymptotics of @xmath6 as @xmath7 , and their first order fluctuations .",
    "dlpp is an example of a stochastic growth model , and has many applications in mathematical and scientific contexts .",
    "for example , dlpp is equivalent to zero - temperature directed polymer growth in a random environment  an important model in statistical mechanics  @xcite .",
    "the model describes a hydrophilic polymer chain wafting in a water solution containing randomly placed hydrophobic molecules ( impurities ) that repel the individual monomers in the polymer chain .",
    "due to thermal fluctuations and the random positions of impurities , the shape of the polymer chain is best understood as a random object .",
    "the statistical mechanical model for a directed polymer assumes that the shape of the polymer can be described by a directed path @xmath8 , thus suppressing entanglement and u - turns .",
    "the presence , or strength , of an impurity at site @xmath9 is described by a random variable @xmath0 , and the energy of a path @xmath10 is given by @xmath11 where @xmath12 is the inverse temperature .",
    "the typical shape of a polymer is one that minimizes .",
    "of interest is the quenched polymer distribution on paths defined by @xmath13 where @xmath8 and the normalization factor @xmath14 is called the _ partition function _ , and is given by @xmath15 in the zero - temperature limit , i.e. , @xmath16 , the quenched polymer distribution concentrates around paths maximizing , and we formally have @xmath17 directed polymers are related to several other stochastic models for growing surfaces , such as directed invasion percolation , ballistic deposition , polynuclear growth , and low temperature ising models  @xcite .",
    "dlpp with independent and identically distributed ( _ i.i.d .",
    "_ ) exponential weights @xmath0 is equivalent to the totally asymmetric simple exclusion process ( tasep ) , which is an important stochastic interacting particle system  @xcite , and to randomly growing young diagrams  @xcite . briefly ,",
    "the dynamics of tasep involve a particle configuration on the lattice @xmath18 , evolving in time , with the dynamical rule that a particle jumps to the right after an exponential waiting time if the right neighboring site is empty .",
    "the correspondence between dlpp and tasep proceeds via the following stochastic corner growth model : partition @xmath19 into squares defined by the edges of the lattice @xmath20 .",
    "imagine that at time @xmath21 , all the squares in @xmath22 are colored white , while the remaining squares are colored black . for each @xmath23 , assign a passage time random variable @xmath0 to the square with @xmath9 on the northeast corner .",
    "the dynamic rule governing the growth process is the following : a white square at location @xmath9 is colored black exactly @xmath0 time units after both its south and west neighbors become black .",
    "the time until square @xmath3 is colored black is exactly @xmath24the last passage time from @xmath2 to @xmath3and the set of all black squares is a randomly growing young diagram .",
    "there is a one - to - one correspondence between tasep configurations , and configurations of black and white squares in the corner growth model .",
    "the idea is that when a white square is colored black , it corresponds to a particle jumping from a site @xmath25 to its necessarily vacant neighbor @xmath26 .",
    "the explicit correspondence is as follows : for every edge separating a white and black square , assign a value of 1 to vertical edges , and a value of 0 to horizontal edges .",
    "the tasep configuration corresponds exactly to reading these binary values sequentially from @xmath27 to @xmath28 .",
    "we give this correspondence more rigorously in section [ sec : formal - eq ] ( see figure [ fig : tasep ] ) .",
    "there are further applications of dlpp in queueing theory  @xcite , and the model is also related to greedy lattice animals  @xcite .",
    "one quantity of interest in dlpp is the time constant , @xmath29 , given by @xmath30 where @xmath31 .",
    "the exact form of @xmath29 is known for _ i.i.d .",
    "_  geometric weights  @xcite , and _ i.i.d . _",
    "exponential weights  @xcite , and is given by @xmath32 where @xmath33 and @xmath34 are the mean and variance , respectively , of the either geometric or exponential weights .",
    "for more general distributions , martin  @xcite showed that @xmath29 is continuous on @xmath22 and gave the following asymptotics at the boundary : @xmath35 in similar fashion to the longest increasing subsequence problem  @xcite , the fluctuations of @xmath6 for geometric and exponential weights are non - gaussian , and instead follow the tracy - widom distribution asymptotically  @xcite .",
    "it is an open problem to determine @xmath36 and the fluctuations of @xmath6 for weights other than geometric and exponential .",
    "we study the dlpp problem with independent weights @xmath0 that are either geometric or exponential , but not identically distributed . for exponential dlpp",
    ", we assume that @xmath0 is exponentially distributed with mean @xmath37 where @xmath38 , and we consider the aymptotics as @xmath39 .",
    "the setup is identical for geometric dlpp , except that the macroscopic inhomogeneity is in the parameter @xmath40 of the geometric distribution . for directed polymers , this models a macroscopic ( non - random ) inhomogeneity in the strength of impurities ;",
    "while for tasep , it corresponds to an inhomogeneity in the rate at which particles move to the right .",
    "our main result , presented in section [ sec : results ] , is a hamilton - jacobi equation for the continuum limit of this dlpp problem .    in the exponential case with continuous @xmath41 , rolla and",
    "teixeira  @xcite showed that @xmath29 has a variational interpretation .",
    "their result is in many ways analogous to the variational problem for the longest chain problem  @xcite that we exploited in our previous work  @xcite .",
    "macroscopic inhomogeneities have also been considered for tasep  @xcite , and for other similar growth models  @xcite .",
    "in particular , georgiou et al .",
    "@xcite proved a hydrodynamic limit for tasep with a spatially ( but not temporally ) inhomogeneous jump rate @xmath42 , which may admit discontinuities .",
    "their result gives the limiting density profile in terms of a variational problem , and they connected this to a conservation law in the special case that the rate @xmath43 is piecewise constant with one jump , i.e. , @xmath44 in the context of exponential dlpp , this would be equivalent to assuming that the macroscopic mean @xmath45 is given by @xmath46 for @xmath47 and @xmath48 otherwise .",
    "our main result , theorem [ thm : main ] , gives a hamilton - jacobi equation for the limiting time constant in dlpp when the macroscopic inhomogeneity @xmath41 is piecewise lipschitz . in the context of tasep , this allows for a discontinuous inhomogeneous jump rate which has a spatial _ and _ temporal dependence .",
    "let us mention the conventions used in this paper .",
    "we say @xmath49 is geometrically distributed with parameter @xmath40 if @xmath50 for @xmath51 and @xmath52 , so that we have @xmath53 we say that @xmath49 is exponentially distributed with mean @xmath54 if for @xmath55 we have @xmath56 and when @xmath57 we have @xmath58 with probability one . here we have @xmath59 in order to ensure that our results are applicable to both exponential and geometric dlpp , we parameterize these distributions instead by their mean @xmath33 . for the exponential distribution",
    "there is no change ; we have @xmath60 . for the geometric distribution",
    ", we have by that a geometric random variable with mean @xmath61 has parameter @xmath62 for both cases , the variance is of course a function of the mean ; in the exponential case we have @xmath63 , and in the geometric case we have @xmath64 .",
    "let us now present our main result .",
    "we consider the following two - sided dlpp model , similar to  @xcite .",
    "let @xmath0 be independent nonnegative random variables defined on the lattice @xmath65 , where @xmath66 .",
    "let @xmath67 denote the last passage time from @xmath68 to @xmath69 , where @xmath70 and @xmath71 .",
    "this is defined as follows : @xmath72 where @xmath73 denotes the set of up / right paths from @xmath3 to @xmath74 in @xmath65 .",
    "the macroscopic inhomogeneity is described by functions @xmath75 and @xmath76 , where @xmath77 .",
    "specifically , given a parameter @xmath78 we make the following assumption : @xmath79 the term @xmath33 corresponds to the macroscopic mean within the bulk @xmath80 , and the term @xmath81 corresponds to an additional source active only on the boundary @xmath82 .",
    "we also assume the weights @xmath0 are either all geometrically distributed , or all expontially distributed .",
    "we can construct the random variables @xmath0 on a common probability space as follows .",
    "let @xmath83 be _ i.i.d .",
    "_  exponential random variables with mean @xmath84 , where @xmath85 . in the exponential case",
    ", we can simply set @xmath86 this setup is similar to  @xcite . in the geometric case , we note that if @xmath87 is an exponential random variable with mean @xmath84 , then for any @xmath88 , @xmath89 is geometrically distributed with parameter @xmath90 . in order to obtain @xmath91",
    ", we need that @xmath92 which gives that @xmath93 .",
    "if @xmath94 , then we set @xmath95 .",
    "hence , let us set @xmath96 for @xmath97 and @xmath98 when @xmath99 .",
    "we make a similar definition for @xmath100 . setting @xmath101",
    "we see that @xmath0 are independent geometric random variables satisfying .    before stating the , somewhat technical , hypotheses on @xmath33 and @xmath81 , we need to introduce some notation .",
    "we say a curve @xmath102 in @xmath19 is continuous and strictly increasing if it can be parameterized in the form @xmath103 where @xmath104 is continuous and strictly increasing , and @xmath105 is an interval in @xmath106 .",
    "we make a similar definition for strictly decreasing .",
    "notice that a continuous strictly increasing ( resp .",
    "decreasing ) curve can also be parameterized in the form @xmath107 where @xmath108 is continuous and strictly increasing ( resp .",
    "decreasing ) .",
    "for simplicity , we will also use @xmath102 to denote the locus of points that lie on the curve @xmath102 .    let @xmath102 be a continuous strictly decreasing curve in @xmath109 ^ 2 $ ] with endpoints @xmath110 and @xmath111 , and let @xmath112 denote the bounded component of the complement of @xmath102 in @xmath22 .",
    "let @xmath113 be a locally finite non - intersecting collection of continuous strictly increasing curves .",
    "for each @xmath114 we assume one endpoint of @xmath115 is on @xmath116 and the other endpoint is at @xmath117 , i.e. , the curve is unbounded .",
    "the complement of @xmath118 in @xmath119 therefore consists of a family @xmath120 of connected components .",
    "each curve @xmath115 is on the boundary of exactly two components , which we may assume are labeled @xmath121 and @xmath122 .",
    "see figure [ fig : domain ] for an illustration of these quantities .     and @xmath115 .",
    "the function @xmath33 is assumed to be lipschitz with constant @xmath123 when restricted to any @xmath121 , and @xmath94 on @xmath124.,scaledwidth=60.0% ]    we place the following assumptions on @xmath33 and @xmath81 :    * the function @xmath125 is bounded and upper semicontinuous , @xmath126 , and there exists a constant @xmath123 such that for every @xmath127 , @xmath128 is lipschitz continuous with constant @xmath123 .",
    "* the source term @xmath76 is bounded and upper semicontinuous with a locally finite set of discontinuities .    throughout the paper we will regard @xmath81 as a function on @xmath22 by setting @xmath129 on @xmath80 .",
    "we also make the following technical assumption :    * for every @xmath127 and @xmath130 , there exists @xmath131 and @xmath132 such that for all @xmath133 we have @xmath134    our main result is the following continuum limit :    [ thm : main ] let @xmath75 satisfy ( f1 ) and ( f3 ) , and let @xmath76 satisfy ( f2 ) .",
    "suppose that the weights @xmath0 satisfy and are either all exponential , or all geometric random variables , constructed on a common probability space as above .",
    "in the exponential case , set @xmath135 , and in the geometric case , set @xmath64 .",
    "then with probability one we have @xmath136 where @xmath29 is the unique monotone viscosity solution of @xmath137 and @xmath138 .    here ,",
    "@xmath139 and @xmath140 denote the partial derivatives of @xmath29 , @xmath141 denotes the positive part of @xmath142 given by @xmath143 , and by monotone we mean that @xmath29 is monotone non - decreasing with respect to all variables .",
    "theorem [ thm : main ] is an extension of our previous work  @xcite , in which we proved a similar result for the longest chain problem .",
    "this result can be viewed as a type of stochastic homogenization  @xcite , where the effective hamiltonian is given in ( p ) .",
    "a similar stochastic homogenization result has been obtained recently for first passage percolation  @xcite , though in that case the exact form of the effective hamiltonian is unknown .",
    "the hamilton - jacobi equation ( p ) is also closely related to the conservation law for the hydrodynamic limit of tasep  @xcite , and in section [ sec : formal - eq ] we show a formal equivalence between the two continuum limits .",
    "we believe this new hamilton - jacobi equation will prove to be a useful tool for studying the dlpp problem , both theoretically and numerically . as an example , in section [ sec : max - curve ] we show how to combine the numerical solution of this hamilton - jacobi equation with dynamic programming to find the asymptotic shapes of optimal paths .",
    "we also believe that this work will provide a new perspective on the hydrodynamic limit of tasep , and may be useful for studying the corresponding conservation law .",
    "some remarks on the hypotheses ( f1 ) , ( f2 ) , and ( f3 ) are in order .",
    "first , the assumption that @xmath33 and @xmath81 are bounded in ( f1 ) and ( f2 ) is made for simplicity .",
    "it can be replaced by the assumption that @xmath33 and @xmath81 are bounded on compact sets , with minor changes to the proofs . recall that",
    "in the exponential case , we have @xmath144 , and in the geometric case , we have @xmath145 .",
    "thus , if @xmath33 satisfies ( f1 ) , ( f3 ) , then so will @xmath34 , though possibly with a larger lipschitz constant @xmath123 .",
    "since it is convenient for the analysis , we will often regard @xmath33 and @xmath34 as independent functions both satisfying ( f1 ) and ( f3 ) .",
    "we will only need to recall the relationship between @xmath33 and @xmath146 at a few key points .",
    "in particular , the uniqueness proof for ( p ) ( see section [ sec : comparison ] ) requires that @xmath33 and @xmath34 satisfy ( f3 ) simultaneously with the same choice of @xmath147 .",
    "this is of course always true , since @xmath146 is a monotone increasing function of @xmath33 in both the exponential and geometric cases .",
    "let us briefly comment on the significance of @xmath102 and @xmath124 .",
    "the correspondence between exponential dlpp and tasep ( described in detail in section [ sec : formal - eq ] ) implies that the initial macroscopic density @xmath148 for tasep is encoded into the curve @xmath102 .",
    "if @xmath102 and @xmath124 are not present , then we have tasep with the common step initial condition @xmath149 for @xmath150 and @xmath151 for @xmath152 .",
    "suppose now that @xmath102 and @xmath124 are present , and parameterize @xmath102 by @xmath153 where @xmath154 is continuous and strictly decreasing with @xmath155 and @xmath156 .",
    "let us assume additionally that @xmath154 is continuously differentiable .",
    "based on the correspondence between tasep and exponential dlpp , the initial density will be given by @xmath157 where for @xmath158 , @xmath159 is the unique @xmath160 satisfying @xmath161 .",
    "thus by choosing @xmath154 appropriately , one can obtain a large class of initial densities @xmath148 for tasep with this setup .",
    "the rest of the paper is organized as follows : in section [ sec : formal - eq ] we show formally that ( p ) is equivalent to the conservation law for the hydrodynamic limit of tasep  @xcite .",
    "the proof of theorem [ thm : main ] is given in section [ sec : conv ] after some preliminary results .",
    "in particular , in section [ sec : var ] we present and analyze a variational problem for ( p ) , and in section [ sec : comparison ] , we prove a comparison principle for ( p ) , which generalizes our previous work  @xcite . in section [ sec : num ] , we present a fast numerical scheme for computing the viscosity solution of ( p ) , and we present the results of various numerical simulations in section [ sec : sim ] .",
    "finally , in section [ sec : max - curve ] , we give an algorithm based on dynamic programming for finding the asymptotic shape of optimal dlpp paths , and in section [ sec : discussion ] we discuss possible directions for future work .",
    "we show here a formal equivalence between ( p ) and the hydrodynamic limit of tasep , given in  @xcite .",
    "tasep is an interacting stochastic particle system on @xmath18 with state space @xmath162 , whose elements , @xmath163 , represent particle configurations",
    ". if a particle is present at site @xmath164 , then @xmath165 , and if no particle is present , then @xmath166 .",
    "the process is exclusionary in the sense that at most one particle can occupy each site at a given time .",
    "the stochastic dynamics proceed as follows : a particle at site @xmath25 jumps to site @xmath26 after an exponential waiting time , provided the site @xmath26 is empty .",
    "the exponential waiting times are independent and begin at the exact moment the right neighboring site is vacated .",
    "these dynamics , along with an initial condition @xmath167 , generate the stochastic process @xmath168 .    in the standard tasep model ,",
    "the exponential waiting times are independent with rate @xmath169 . as in  @xcite",
    ", we allow the rates to have a macroscopic spatial ( and temporal ) dependence , i.e. , the rate at position @xmath170 and time @xmath171 is @xmath172 , where @xmath173 , and @xmath78 is a parameter that we will send to @xmath117 .",
    "a central object of study is the macroscopic density @xmath174 , which is the almost sure limit ( assuming it exists ) of the discrete densities as follows : @xmath175 georgiou et al .",
    "@xcite showed that for @xmath176 @xmath177 can be identified as the unique entropy solution of the scalar conservation law @xmath178 where @xmath148 denotes the initial macroscopic density .",
    "we are using @xmath179 for the spatial variable in to avoid confusion with the spatial variables in ( p ) . in",
    "what follows , we show formally that the conservation law is equivalent to ( p ) . for simplicity",
    ", we will ignore the initial condition @xmath148 and the boundary condition in ( p ) , and restrict ourselves to showing that the ( p ) and are equivalent in the bulk .",
    "we shall also assume that @xmath180 .",
    "consider now the exponential dlpp model with macroscopic mean @xmath181 , i.e. , @xmath182 .",
    "let @xmath6 denote the last passage time given by , and let us write @xmath183 for convenience .",
    "let @xmath29 be the unique monotone viscosity solution of ( p ) , and let us assume that @xmath184 and @xmath185 so that @xmath186 . of course ,",
    "the viscosity solution of a hamilton - jacobi equation is in general not @xmath187 ; the argument we give here is purely formal . by theorem [ thm : main ]",
    "we have @xmath188 we also note that ( p ) can be rearranged as follows : @xmath189    let us now describe in detail the correspondence between tasep and dlpp , which can also be found here  @xcite .",
    "we assign to a tasep configuration @xmath163 the site counter @xmath190 and the height function @xmath191 then we have @xmath192 , and @xmath193 . the height function @xmath194 is a stochastically growing interface , and is related to the corner growth model described in section [ sec : intro_ch4 ] . roughly speaking",
    ", the dynamical rule for the growth of @xmath194 is that when a particle jumps to the right ( from @xmath25 to @xmath26 ) , a valley @xmath195 turns into a mountain @xmath196 , and the height at site @xmath25 increases by @xmath197 .",
    "see figure [ fig : tasep ] for reference .",
    "the @xmath142 sub - level set of @xmath6and on the right we show the corresponding tasep height function @xmath194 obtained by rotating the boundary of @xmath198 by @xmath199 . ]",
    "let us now define the random set @xmath200 since @xmath6 is non - decreasing in both arguments , it implicitly defines its own height function , @xmath201 , which describes the boundary of @xmath198 as follows : @xmath202 the correspondence between tasep and dlpp is the identification @xmath203 in the sense of joint distributions .",
    "this connection is made rigorous by choosing appropriate boundary rates for dlpp here  @xcite .",
    "visually , the correspondence is obtained by rotating the boundary of @xmath198 by @xmath199 to obtain the height function @xmath194 ( see figure [ fig : tasep ] ) .",
    "the correspondence between tasep and dlpp says , at least formally , that @xmath204 by and , @xmath194 has a macroscopic continuum limit , @xmath205 , such that @xmath206 with probability one , where @xmath207 .",
    "it follows from that @xmath208 combining , , and we have that @xmath209 it follows from that @xmath210 this is in some sense the `` master equation '' relating the continuum limits of tasep and dlpp .",
    "let us illustrate how to use to derive the conservation law from ( p ) ; deriving ( p ) from follows in a similar fashion .",
    "differentiating in both @xmath211 and @xmath212 we have @xmath213 where @xmath214 and @xmath215 . adding and we have @xmath216 similarly , by rearranging and dividing by we have @xmath217 this equality",
    "can also be obtained by noting that the slope of the level set @xmath218 is given locally by the ratio of ones to zeros in the tasep configuration .    solving for @xmath177 in we have @xmath219 , which yields @xmath220 where we invoked the hamilton - jacobi equation ( p ) in the second equality above . since @xmath29 is strictly monotone increasing in both @xmath211 and @xmath212 ,",
    "there is a one - to - one correspondence between the coordinates @xmath221 and @xmath222 .",
    "let us write @xmath223 . since @xmath41 is the exponential mean , @xmath42 is the exponential rate for tasep . then combining with we have @xmath224 differentiating with respect to @xmath179 on both sides of and applying we have @xmath225 which is precisely the conservation law .",
    "furthermore , by combining and , we have the following hamilton - jacobi equation for @xmath205 : @xmath226    it seems to us that this formal computation could be made precise when @xmath177 and @xmath29 are indeed @xmath187 functions .",
    "this is the case , for example , when @xmath41 is constant . in the general case where @xmath177 and @xmath29 are not @xmath187",
    ", it may be possible to make this formal computation precise using the machinery of viscosity solutions , and we plan to investigate this in a future work .",
    "in this section we give a variational interpretation for @xmath29 and analyze its relevant properties .",
    "this variational problem first appeared in  @xcite , in a different form , for exponential dlpp with a continuous macroscopic rate @xmath41 , and is similar to the well - known variational problem for the longest chain problem  @xcite .",
    "let us first introduce some notation .",
    "we denote by @xmath227 the coordinatewise partial order on @xmath228 , i.e. , @xmath229 if and only if @xmath230 for all @xmath114 , where @xmath231 . we write @xmath232 if @xmath233 and @xmath234 , and we write @xmath235 if @xmath236 for all @xmath114 . for @xmath237 with @xmath233 , we will often use the following interval notation @xmath238 = \\big\\ { z \\in { \\mathbb{r}}^d \\ , : \\ , x \\leqq z \\leqq y\\big\\},\\ ] ] and @xmath239 = \\big\\ { z\\in { \\mathbb{r}}^d \\ , : \\ , x < z \\leq y \\big\\},\\ ] ] with similar definitions for @xmath240 and @xmath241 .    let @xmath242 denote the set of @xmath187 monotone curves , given by @xmath243 ; [ 0,\\infty)^2 )",
    "\\ , : \\ , \\gamma'(t )",
    "\\geqq 0 \\ \\text{for all } t \\in [ 0,1]\\big\\}.\\ ] ] we write @xmath244 to denote the components of @xmath245 . for @xmath246 ,",
    "let us define @xmath247 by @xmath248 and for @xmath249 we set @xmath250 notice that @xmath251 for any @xmath252 , hence @xmath253 is independent of the parametrization of @xmath245 .",
    "we finally define @xmath254 for @xmath255 .",
    "borrowing language from optimal control theory  @xcite , we will call @xmath256 the value function for this variational problem .",
    "we will often write @xmath257 and @xmath29 in place of @xmath258 and @xmath256 , respectively , when it is clear from the context what @xmath33 and @xmath146 are .",
    "notice that when @xmath259 with @xmath260 we have @xmath261 a similar formula holds when @xmath259 with @xmath262 , and in general we can write @xmath263 for @xmath259 .",
    "we also define @xmath264 for @xmath265 with @xmath233 . as before",
    ", we will often drop the subscripts on @xmath266 when convenient .",
    "similar to ",
    ", when @xmath267 with @xmath233 and @xmath268 , we can write @xmath269 with a similar formula holding when @xmath270 . in general , whenever @xmath233 but @xmath271 for some @xmath114 we can write @xmath272    the remainder of this section is organized as follows . in section [ sec : reg ] we prove that @xmath29 and @xmath273 are uniformly continuous , under assumptions on @xmath33 and @xmath146 that are similar to ( f1 ) and ( f3 ) , but slightly weaker",
    ". then in section [ sec : hjb ] , we show that @xmath274 is a viscosity solution of ( p ) , and prove a similar result for @xmath266 .",
    "this result , theorem [ thm : hjb ] in section [ sec : hjb ] , follows from classical optimal control theory  @xcite , and ( p ) is exactly the hamilton - jacobi - bellman equation for the variational ( optimal - control ) problem . for more information on hamilton - jacobi equations and optimal control ,",
    "we refer the reader to  @xcite .",
    "hlder or lipschitz regularity of the value function in optimal control theory is a standard classical result  @xcite .",
    "however , it is typically assumed that @xmath275 is uniformly continuous , which is not compatible with ( f1 ) .",
    "we show here that the specific form of @xmath276 allows us to show that @xmath277 and @xmath266 are uniformly continuous , provided the discontinuities in @xmath33 occur along monotone increasing curves .",
    "since it is useful later , we will slightly weaken the hypothesis ( f1 ) , and allow @xmath33 to be `` badly behaved '' within a narrow tube of the monotone curves @xmath115 . this weakened hypothesis",
    "is specifically designed so that the regularity result applies to inf- and sup - convolutions of functions satisfying ( f1 ) .",
    "inf- and sup - convolutions are commonly used for regularization in the theory of viscosity solutions  @xcite .",
    "the weakened hypothesis requires the following notation ; for @xmath278 define @xmath279 the weakened version of ( f1 ) is the following :    * the function @xmath125 is bounded and upper semicontinuous , @xmath280 , and there exists a constant @xmath123 such that for every @xmath127 , @xmath281 is lipschitz continuous with constant @xmath123 .",
    "we now give the regularity result for @xmath273 .",
    "[ thm : reg ] suppose that @xmath33 satisfies ( f1 * ) for @xmath282 , and suppose that @xmath283 is bounded and borel - measurable .",
    "then for every @xmath284 there exist a modulus of continuity @xmath285 , and a constant @xmath286 such that @xmath287 for all @xmath288 ^ 2 $ ] with @xmath289 .",
    "furthermore , @xmath285 depends only on @xmath290 and @xmath284 .",
    "let @xmath284 .",
    "we will prove the result for @xmath291 ; the case of @xmath292 is very similar .",
    "for simplicity of notation , let us set @xmath293 .",
    "notice that we can reduce the proof to the case where @xmath294 ^ 2 $ ] with @xmath233 .",
    "indeed , let @xmath294 ^ 2 $ ] and set @xmath295 .",
    "then we have @xmath296 and @xmath297 and @xmath298 .",
    "thus let us assume that @xmath233 .",
    "let @xmath131 and let @xmath249 such that @xmath299 , @xmath300 , and @xmath301 .",
    "define @xmath302 without loss of generality , we may assume that @xmath303 .",
    "define @xmath304.\\ ] ]    the proof is split into two steps now .",
    "we claim that @xmath305 .    to see this : first note that @xmath306 and @xmath307 .",
    "it follows that @xmath308 where the second line follows from hlder s inequality .",
    "we claim now that @xmath309 . to see this : suppose to the contrary that @xmath310 , which implies that @xmath311 . by the definition of @xmath312 we must have @xmath313 and @xmath314 for @xmath315 .",
    "this contradicts our assumption that @xmath316 .",
    "hence @xmath317 .",
    "now we have @xmath318 since @xmath319 on @xmath320 $ ] and @xmath321 we have @xmath322 where @xmath323 .",
    "if @xmath324 then the claim follows from .",
    "so suppose that @xmath311 .",
    "since @xmath325 and @xmath326 for @xmath327 , we have @xmath328 which establishes .",
    "we claim that @xmath329 where @xmath330 .",
    "notice that once is established , the proof is completed by combining with and sending @xmath331 .",
    "since the collection of curves @xmath332 is locally finite , we may assume that @xmath333 are the only tubular neighborhoods that have a non - empty intersection with @xmath334 ^ 2 $ ] .",
    "since @xmath115 is continuous and strictly increasing , we can parameterize the portion of @xmath115 that intersects @xmath334 ^ 2 $ ] as follows : @xmath335 where @xmath336 is continuous and strictly increasing , and @xmath337 is a closed interval in @xmath334 $ ] .",
    "similarly we can parameterize @xmath102 as @xmath338,\\ ] ] where @xmath339\\to[0,1]$ ] is continuous and strictly decreasing .",
    "note that the functions @xmath340 share a common modulus of continuity @xmath285 , by virtue of their compact domains .",
    "we also note that @xmath285 and @xmath341 depend only on @xmath342 , and @xmath284 .    to prove , first set @xmath343 .",
    "a simple computation shows that @xmath344 for any @xmath345 .",
    "a similar statement holds for @xmath102 and @xmath154 . for each @xmath346",
    ", we define @xmath347 } f_i , \\ \\",
    "\\text{and } \\",
    "\\ m_i^- = \\inf_{i_i\\cap[x_1,y_1 ] } f_i,\\ ] ] and @xmath348 similarly we set @xmath349\\cap[x_1,y_1 ] } f , \\ \\",
    "\\text{and } \\ \\",
    "m^- = \\inf_{[0,1]\\cap[x_1,y_1 ] } f,\\ ] ] @xmath350 and @xmath351    by the definition of @xmath352 and @xmath353 we have @xmath354 it follows from  , ( f1 * ) , and the fact that @xmath245 is monotone , that whenever @xmath355 we have either @xmath356 or @xmath357 for some @xmath358 .",
    "thus , invoking ( f1 * ) , we have latexmath:[\\[\\label{eq : good }    for all @xmath355 .    for any @xmath360",
    ", we have @xmath361 we have an identical estimate when @xmath362 is replaced by @xmath363 . combining with we have @xmath364 which establishes and completes the proof .",
    "[ cor : reg ] suppose that @xmath33 satisfies ( f1 * ) for @xmath282 , and suppose that @xmath146 is bounded and borel - measurable .",
    "then for every @xmath284 there exist a modulus of continuity @xmath285 , and a constant @xmath286 such that @xmath365 for all @xmath288 ^ 2 $ ] with @xmath366 . as in theorem",
    "[ thm : reg ] , @xmath285 depends only on @xmath290 and @xmath284 .",
    "the proof follows from theorem [ thm : reg ] by symmetry .",
    "[ rem : reg ] notice in theorem [ thm : reg ] that if @xmath367 then we have the estimate @xmath368 for all @xmath288 ^ 2 $ ] with @xmath369 . inspecting the proof of theorem [ thm : reg ] , we see that @xmath285 is the modulus of continuity of the curves @xmath342 as functions over both coordinate axes .",
    "thus , the regularity of @xmath273 is inherited from the regularity of the curves @xmath342 .",
    "for example , if the curves @xmath342 are hlder - continuous with exponent @xmath370 as functions over both coordinate axes , then we have that @xmath371\\times[z_2,r])$ ] for every @xmath284 and its hlder seminorm depends only on @xmath372 , @xmath373 , @xmath374 , and @xmath123 .",
    "the same remark holds for corollary [ cor : reg ] and .",
    "we now plan to use theorem [ thm : reg ] to prove a similar regularity result for @xmath277 .",
    "to do this , we relate @xmath273 and @xmath29 via the following dynamic programming principle :    [ prop : dpp ] suppose that @xmath33 satisfies ( f1 * ) for @xmath375 , @xmath81 satisfies ( f2 ) , and suppose that @xmath146 is bounded and borel - measurable .",
    "then for any @xmath376 we have @xmath377    notice that the boundary source @xmath81 is absent in the term @xmath266 in .",
    "this allows us to concentrate much of our analysis on @xmath266 , which involves only the macroscopic inhomogeneities in the bulk @xmath80 , and then extend our results to hold for @xmath277 via the dynamic programming principle .",
    "we first note that the maximum in is indeed attained , due to the continuity of @xmath277 restricted to @xmath82 and corollary [ cor : reg ] .    if @xmath378 , then in light of , and the fact that @xmath379 , the maximum in is attained at @xmath380 and the validity of is trivial .",
    "suppose now that @xmath381 and let @xmath382 denote the right hand side in , and set @xmath383 .",
    "we first show that @xmath384 .",
    "let @xmath131 and @xmath249 such that @xmath299 , @xmath300 and @xmath385 .",
    "let @xmath386 \\ , : \\gamma(t ) \\in \\partial { \\mathbb{r}}^2_+\\big\\}.\\ ] ] then we have @xmath387 .",
    "set @xmath388 and @xmath389 for @xmath390 $ ] .",
    "then we have @xmath391 sending @xmath331 we have @xmath384 .",
    "we now show that @xmath392 .",
    "let @xmath259 be a point at which the maximum is attained in and let @xmath131 .",
    "let @xmath393 with @xmath394 , @xmath395 such that @xmath396 .",
    "let @xmath397 $ ] such that @xmath398 and @xmath399 .",
    "let @xmath400 with @xmath401 , @xmath402 such that @xmath403 .",
    "we can stitch together @xmath404 and @xmath405 as follows @xmath406 then we have @xmath407 where we used the fact that @xmath408 for all @xmath142 , hence @xmath409 . sending @xmath331 we have @xmath392",
    "before continuing with the regularity result for @xmath277 , let us introduce a bit of notation .",
    "for @xmath410 , let @xmath411 $ ] denote the projection mapping @xmath228 onto the convex set @xmath412 $ ] .",
    "for @xmath413 , @xmath414 is given explicitly by @xmath415    [ cor : ureg ] suppose that @xmath33 satisfies ( f1 * ) for @xmath416 , @xmath81 satisfies ( f2 ) , and suppose that @xmath146 is bounded and borel - measurable .",
    "then for every @xmath284 there exists a modulus of continuity @xmath285 , and a constant @xmath417 such that @xmath418 for all @xmath294 ^ 2 $ ] . as in theorem",
    "[ thm : reg ] , @xmath285 depends only on @xmath290 and @xmath284 .",
    "let @xmath294 ^ 2 $ ] and set @xmath383 and @xmath419 .",
    "as in theorem [ thm : reg ] we may assume that @xmath233 .",
    "by proposition [ prop : dpp ] , there exists @xmath420 with @xmath421 such that @xmath422 set @xmath423 .",
    "then since @xmath424 and @xmath297 , we have by proposition [ prop : dpp ] that @xmath425 by subtracting from and recalling we have @xmath426 the proof is completed by applying theorem [ thm : reg ] and corollary [ cor : reg ] and noting that + @xmath427 .    of course ,",
    "remark [ rem : reg ] holds with obvious modifications for @xmath29 and .",
    "[ rem : discont ] the hypothesis that the curves @xmath115 are continuous and strictly increasing can not in general be weakened to continuous and non - decreasing .",
    "for example , consider the case where @xmath428 on @xmath429\\times[0,1]$ ] and @xmath430 on @xmath431 $ ] .",
    "then we have @xmath432,\\\\ x_1 + x_2 - 0.5 +",
    "2\\sqrt{(x_1 - 0.5)x_2},&\\text{if } x \\in [ 0.5,1]\\times[0,1 ] , \\end{cases}\\ ] ] which has a discontinuity along the vertical line @xmath433 , which would correspond to one of the curves @xmath115 on which @xmath33 is discontinuous .      in this section",
    "we show in theorem [ thm : hjb ] that @xmath274 is a viscosity solution of ( p ) .",
    "in fact , ( p ) is the hamilton - jacobi - bellman equation for the simple optimal control problem  @xcite defined by @xmath274 . for more information on the connection between hamilton - jacobi equations and optimal control problems , we refer the reader to  @xcite .",
    "let us pause momentarily to recall the definition of viscosity solution of @xmath434 where @xmath435 is open , @xmath436 is locally bounded with @xmath437 continuous for every @xmath438 , and @xmath439 is the unknown function .",
    "for more information on viscosity solutions of hamilton - jacobi equations , we refer the reader to  @xcite .",
    "we denote by @xmath440 ( resp .",
    "@xmath441 ) the set of upper semicontinuous ( resp .",
    "lower semicontinuous ) functions on @xmath442 . for @xmath443 ,",
    "the _ superdifferential _ of @xmath444 at @xmath438 , denoted @xmath445 , is the set of all @xmath446 satisfying @xmath447 similarly , the _ subdifferential _ of @xmath444 at @xmath448 , denoted @xmath449 , is the set of all @xmath446 satisfying @xmath450 equivalently , we may set @xmath451 and @xmath452    a _ viscosity subsolution _ of is a function @xmath453 satisfying @xmath454 similarly , a _ viscosity supersolution _ of is a function @xmath455 satisfying @xmath456    the functions @xmath457 and @xmath458 are the lower and upper semicontinuous envelopes of @xmath459 with respect to the spatial variable , respectively .",
    "we will often say @xmath444 is a viscosity solution of @xmath460 to indicate that @xmath444 is a viscosity subsolution ( resp .",
    "supersolution ) of .",
    "if @xmath444 is a viscosity subsolution and supersolution of , then we say that @xmath444 is a _ viscosity solution _ of .",
    "notice that viscosity solutions defined in this way are necessarily continuous .",
    "[ thm : hjb ] suppose that @xmath461 are borel - measurable and bounded .",
    "let @xmath462 and set @xmath463 for @xmath464 .",
    "if @xmath465 is continuous then @xmath465 satisfies @xmath466 in the viscosity sense .",
    "recall that @xmath467 , and @xmath468 .    the proof is based on a standard technique from optimal control theory for relating variational problems to hamilton - jacobi equations  @xcite .",
    "the proof is very similar to  ( * ? ? ?",
    "* theorem 2 ) .",
    "we will only sketch parts of the proof here .",
    "the proof is based on the following dynamic programming principle @xmath469 which holds for @xmath470 and @xmath471 small enough so that @xmath472 .",
    "the proof of is very similar to the proof of proposition [ prop : dpp ] .",
    "we now show that @xmath465 is a viscosity solution of .",
    "let @xmath470 and let @xmath473 . as in  @xcite , we can use the dynamic programing principle to obtain @xmath474 suppose now that @xmath475 .",
    "then we automatically have @xmath476 furthermore , it follows from that @xmath477 , so we are done .",
    "consider now @xmath478 .",
    "setting @xmath479 in we have @xmath480 it follows that @xmath481 . by a similar argument we have @xmath482 , and hence we have @xmath483",
    "this establishes that @xmath465 is a viscosity solution of @xmath484 now set @xmath485 in and simplify to find that @xmath486 therefore @xmath465 is a viscosity solution of @xmath487    let @xmath470 and let @xmath488 . utilizing the dynamic programing principle again we have @xmath489 if @xmath490",
    "then we immediately have @xmath491 if @xmath492",
    "then we have that @xmath493 it follows that the supremum in is attained at some @xmath494 . introducing a lagrange multiplier @xmath55 ,",
    "the necessary conditions for @xmath495 to be a maximizer of the constrained maximization problem are @xmath496 it follows that @xmath497 and @xmath495 is given by . substituting this into we find that @xmath498 and hence @xmath465 is a viscosity solution of @xmath499 which completes the proof .",
    "[ rem : hjb ] it follows from theorem [ thm : hjb ] that @xmath500 is a viscosity solution of ( p ) and satisfies @xmath501 in the viscosity sense .",
    "indeed , we can simply apply theorem [ thm : hjb ] with @xmath502 in place of @xmath33 and @xmath503 , in which case we have @xmath504 .",
    "we study here the general hamilton - jacobi equation @xmath505 here , @xmath506 , @xmath507 is continuous and monotone , @xmath508 is the hamiltonian , and @xmath509 is the unknown function . for simplicity of notation , we will set @xmath503 throughout much of this section . the case where @xmath510 follows by a simple translation argument .",
    "we place the following assumptions on @xmath459 :    * for every @xmath511 , the mapping @xmath512 is monotone non - decreasing .",
    "* there exists a modulus of continuity @xmath513 such that @xmath514 for all @xmath515 and @xmath516 .    the assumption ( h1 ) is clearly satisfied by ( p ) , and generalizes the comparison results in our previous work  @xcite , which was focused on the special case of @xmath517 . the assumption ( h2 )",
    "is standard in the theory of viscosity solutions  @xcite .",
    "we now give a comparison principle for hamiltonians @xmath459 satisfying ( h1 ) and ( h2 ) .",
    "[ thm : comp ] suppose that @xmath459 satisfies ( h1 ) and ( h2 ) .",
    "let @xmath518 be a viscosity solution of @xmath519 let @xmath520 be a monotone viscosity solution of @xmath521 where @xmath522 , and suppose that @xmath523 on @xmath524 .",
    "then @xmath523 on @xmath525 .",
    "the proof of theorem [ thm : comp ] is based on the auxiliary function technique , which is standard in the theory of viscosity solutions  @xcite , with modifications to incorporate the lack of compactness resulting from the unbounded domain @xmath525 .",
    "a standard technique for dealing with unbounded domains is to assume the hamiltonian @xmath459 is uniformly continuous in the gradient @xmath526 and modify the auxiliary function ( see , for example  ( * ? ? ?",
    "* theorem 3.5 ) ) .",
    "since ( p ) is not uniformly continuous in the gradient , we can not use this technique . in our previous work",
    "@xcite , we included an additional boundary condition at infinity to induce compactness .",
    "it turns out that this is not necessary , and in the proof of theorem [ thm : comp ] , we instead heavily exploit the structure of the hamiltonian , namely ( h1 ) , to produce the required compactness .",
    "since @xmath527 is monotone ( i.e. , non - decreasing ) , it is bounded below by @xmath528 . without loss of generality",
    "we may assume that @xmath529 .",
    "let @xmath530 and set @xmath531 .",
    "it follows from ( h1 ) that @xmath532 is a viscosity solution of .",
    "assume by way of contradiction that @xmath533 .",
    "let @xmath534 be a @xmath187 function satisfying @xmath535 for @xmath536 set @xmath537 , and choose @xmath42 large enough so that @xmath538 since @xmath539 is @xmath187 and @xmath540 , it is a standard application of the chain rule  @xcite to show that @xmath541 is a viscosity solution of @xmath542 since @xmath543 $ ] for all @xmath544 , we can apply ( h1 ) to to find that @xmath541 is a viscosity solution of .    for @xmath545",
    "we define @xmath546 and @xmath547 .",
    "since @xmath548 and @xmath549 , we have by that @xmath550 we have @xmath551 since @xmath552 is upper semicontinuous and @xmath553 , it follows from and that for every @xmath554 there exist @xmath555 such that @xmath556 and @xmath557 furthermore , by and we see that , upon passing to a subsequence if necessary , we have @xmath558 as @xmath559 for some @xmath560 .",
    "since @xmath561 is upper semicontinuous we have @xmath562 since @xmath563 for all @xmath564 we have that @xmath565 as @xmath559 and hence @xmath566 since @xmath567 on @xmath524 we must have @xmath568 , and therefore @xmath569 for @xmath564 large enough",
    ".    set @xmath570 . by",
    "we have that @xmath571 therefore we have @xmath572 subtracting the above inequalities and invoking ( h2 ) we have @xmath573 sending @xmath574 we arrive at a contradiction .",
    "therefore @xmath575 , and sending @xmath576 completes the proof .",
    "we now aim to extend this comparison principle to hamiltonians with discontinuous spatial dependence .",
    "the techniques we use here are a generalization of our previous work on the longest chain problem  @xcite .",
    "we make the following definitions .    given a function @xmath577 and @xmath578 , we define the @xmath579-_truncation _ of @xmath444 by @xmath580 , where @xmath414 is the projection mapping @xmath228 onto @xmath412 $ ] defined in .",
    "let @xmath444 be a viscosity solution of @xmath581 we say that @xmath444 is _ truncatable _ if for every @xmath582 , the @xmath579-truncation @xmath583 is a viscosity solution of .",
    "this notion of truncatability is in spirit the same as  ( * ? ? ?",
    "* definition 2.7 ) , though the exact definition is slightly different for notational convenience .",
    "we first show that the value function @xmath273 is truncatable .",
    "[ prop : utrunc ] suppose that @xmath461 are borel - measurable and bounded .",
    "let @xmath462 and define @xmath463 for @xmath464 .",
    "if @xmath465 is continuous then @xmath465 is a truncatable viscosity solution of @xmath584    it follows from theorem [ thm : hjb ] that @xmath465 is a viscosity solution of .",
    "we need only show that @xmath465 is truncatable .",
    "let @xmath582 , let @xmath585 denote the characteristic function of @xmath586 $ ] , and set @xmath587 . by the definition of @xmath588 and @xmath589 we have @xmath590 for any @xmath591 $ ] .",
    "let @xmath592 $ ] , @xmath593 , and let @xmath249 with @xmath594 , @xmath595 such that @xmath596 .",
    "let @xmath404 denote the portion of @xmath245 inside @xmath586 $ ] , let @xmath405 denote the remaining portion of @xmath245 , and reparametrize @xmath404 and @xmath405 so that @xmath597\\to{\\mathbb{r}}^2 $ ] . letting @xmath598",
    "$ ] we have @xmath599 since @xmath600 and @xmath601 $ ] , we also have @xmath602 .",
    "it follows that @xmath603 \\ , : \\ , y \\leqq x }",
    "v(y).\\ ] ] by continuity of @xmath465 , the supremum above is attained , and the maximizing argument of @xmath604 is exactly @xmath605the projection of @xmath606 onto @xmath412 $ ] .",
    "therefore we have @xmath607 .",
    "since @xmath606 is arbitrary , we see that @xmath608 , the @xmath579-truncation of @xmath465 .",
    "since @xmath609 is continuous , it follows from theorem [ thm : hjb ] that @xmath610 is a viscosity solution of @xmath611 since @xmath612 and @xmath613 is monotone decreasing , it follows that @xmath610 is viscosity subsolution of , which completes the proof .",
    "we now show that truncatability enjoys a useful @xmath614-stability property .",
    "[ prop : trunc ] let @xmath398 and for each @xmath615 suppose that @xmath616 is a truncatable viscosity solution of @xmath617 if @xmath618 locally uniformly , for some @xmath619 , then @xmath444 is a truncatable viscosity solution of @xmath620 where @xmath621    we should note that the @xmath622 operation defining @xmath623 is taken jointly as @xmath624 and @xmath625 .",
    "this is a standard operation in the theory of viscosity solutions ( see  ( * ? ? ?",
    "* section 6 ) ) , and it can be written more precisely for a function @xmath626 as @xmath627    it is a standard result ( see ( * ? ? ?",
    "* remark  6.3 ) ) that @xmath444 is a viscosity solution of . to see that @xmath444 is truncatable : fix @xmath582 , let @xmath583 be the @xmath579-truncation of @xmath444 , and let @xmath628 be the @xmath579-truncation of @xmath629 .",
    "since @xmath629 is truncatable , we have that @xmath628 is a viscosity solution of for every @xmath630 .",
    "furthermore , we have @xmath631 locally uniformly , and therefore @xmath583 is a viscosity solution of .",
    "thus @xmath444 is truncatable .",
    "we now relax ( h2 ) and allow @xmath459 to have discontinuous spatial dependence .",
    "given a set @xmath632 we assume @xmath459 satisfies    * there exists a modulus of continuity @xmath513 such that for all @xmath633 there exists @xmath634 and @xmath635 such that @xmath636 for all @xmath446 , @xmath637 , @xmath638 , and @xmath639 with @xmath640 .",
    "this hypothesis is similar to one used by deckelnick and elliott  @xcite to prove uniqueness of viscosity solutions to eikonal - type hamilton - jacobi equations with discontinuous spatial dependence .",
    "it is also a generalization of the cone condition used in our previous work  @xcite .",
    "if we assume the subsolution is truncatable , then we can prove the following comparison principle , which holds for hamiltonians @xmath459 with discontinuous spatial dependence .",
    "[ thm : comp - trunc ] suppose that @xmath459 satisfies ( h3)@xmath641 for some @xmath632 .",
    "let @xmath642 be a truncatable viscosity solution of and let @xmath643 be a monotone viscosity solution of .",
    "suppose that @xmath644 on @xmath645 .",
    "then @xmath523 on @xmath525 .",
    "the proof of theorem [ thm : comp - trunc ] is similar to ( * ? ? ?",
    "* theorem 2.8 ) , so we postpone it to the appendix .",
    "for the remainder of the section we set @xmath646 our aim now is to apply the comparison principles from theorems [ thm : comp ] and [ thm : comp - trunc ] to obtain a comparison principle , and a perturbation result , for the hamilton - jacobi equation ( p ) .",
    "first we need to show that ( h2 ) and ( h3)@xmath647 are satisfied by @xmath459 given in .",
    "[ prop : hcont ] suppose that @xmath461 , and let @xmath459 be given by . then for any @xmath648 @xmath649    let @xmath650 , and set @xmath651 so that @xmath652 suppose first that @xmath653 . since @xmath654 is convex , we have @xmath655 since @xmath656 we have @xmath657 therefore we have @xmath658 if @xmath659",
    "then we have @xmath660 , and hence holds .",
    "[ rem : h2 ] it follows from proposition [ prop : hcont ] that @xmath459 satisfies ( h2 ) if @xmath33 and @xmath34 are globally lipschitz continuous on @xmath80 .",
    "[ cor : comp ] suppose that @xmath33 and @xmath34 are non - negative and globally lipschitz continuous on @xmath80 .",
    "let @xmath661 be a viscosity solution of @xmath662 and let @xmath663 be a monotone viscosity solution of @xmath664 furthermore , suppose that @xmath665 then @xmath523 on @xmath82 implies @xmath523 on @xmath80 .",
    "we claim that @xmath666 in the viscosity sense . to see this ,",
    "let @xmath667 and let @xmath668 .",
    "then we have @xmath669 if @xmath670 , then we must have @xmath671 as desired .",
    "if @xmath672 , then by we have @xmath673 , and we have @xmath674 by virtue of the monotonicity of @xmath527 .",
    "let @xmath522 and set @xmath675 . by and we see that @xmath676 is a viscosity solution of @xmath677 by proposition [ prop : hcont ] and remark [ rem : h2 ] we see that ( h1 ) and ( h2 ) are satisfied",
    ". therefore we can apply theorem [ thm : comp ] to find that @xmath678 .",
    "sending @xmath679 completes the proof .",
    "recall that @xmath33 and @xmath34 are not independent functions in the dlpp problem , even though we have treated them as such for much of the analysis . from this point on",
    ", we will need to recall their relationship , as it is important for proving uniqueness in ( p ) . specifically",
    ", we need to assume that @xmath33 and @xmath34 satisfy ( f3 ) for the _ same _ choice of @xmath147 at each @xmath130 .",
    "when this holds , we say that @xmath33 and @xmath34 _ simultaneously _ satisfy ( f3 ) . since @xmath680 for exponential dlpp and @xmath681 for geometric dlpp , @xmath146 is always a monotone increasing function of @xmath33 , and hence @xmath33 and @xmath34 simultaneously satisfy ( f3 ) in both cases .",
    "we recall that @xmath124 , @xmath121 , @xmath115 , and ( f1)(f3 ) are defined in section [ sec : results ] , and that @xmath682 on @xmath124 .",
    "[ prop : hypo ] let @xmath33 and @xmath34 simultaneously satisfy ( f1 ) and ( f3 ) . then @xmath459 given by satisfies ( h3)@xmath641 with @xmath683 .",
    "let @xmath633 .",
    "if @xmath684 , then we can choose @xmath685 small enough so that @xmath686 .",
    "by proposition [ prop : hcont ] we see that any choice for @xmath687 will suffice since @xmath33 and @xmath34 are lipschitz with constant @xmath123 when restricted to @xmath121 .",
    "if @xmath688 for some @xmath114 , then let @xmath147 be as given in ( f3 ) .",
    "assume for now that @xmath689 , and set @xmath690 .",
    "let @xmath691 be less than half the value of @xmath692 from ( f3 ) , and then choose @xmath691 smaller , if necessary , so that @xmath693 has an empty intersection with @xmath102 and all other @xmath694 , and @xmath695 .",
    "let @xmath696 and @xmath697 denote the lipschitz extensions of @xmath128 and @xmath698 to @xmath699 , respectively , and make the same definitions for @xmath700 and @xmath701 .",
    "then ( f3 ) implies that @xmath702 and @xmath703 on @xmath704 .",
    "furthermore , since @xmath33 and @xmath34 are upper semicontinuous , we have @xmath705 and @xmath706 on @xmath704 .",
    "let @xmath637 , @xmath707 , @xmath708 , and @xmath639 with @xmath640 .",
    "if @xmath709 , then since @xmath115 is monotone , @xmath710 , and @xmath711 , we must have that @xmath712 .",
    "since @xmath696 and @xmath713 are lipschitz on @xmath714 , we can invoke proposition [ prop : hcont ] to show that ( h3)@xmath647 holds .",
    "now suppose that @xmath715 .",
    "if @xmath716 , then ( h3)@xmath647 holds as before , so assume that @xmath717 .",
    "let @xmath718 such that @xmath719 .",
    "then we have @xmath720 where we used the fact that @xmath702 on @xmath721 .",
    "we have an identical estimate for @xmath34 , and the proof is completed by invoking proposition [ prop : hcont ] .",
    "[ cor : comp - trunc ]",
    "let @xmath33 and @xmath34 simultaneously satisfy ( f1 ) and ( f3 ) .",
    "let @xmath722 be a truncatable viscosity solution of , let @xmath723 be a monotone viscosity solution of , and suppose that holds .",
    "then @xmath523 on @xmath724 implies @xmath644 on @xmath80 .",
    "the proof of corollary [ cor : comp - trunc ] is similar to corollary [ cor : comp ] .",
    "we now prove an important perturbation result . roughly speaking",
    ", it says that if we smooth out the macroscopic mean @xmath33 and variance @xmath146 ( i.e. , remove the discontinuities ) , then the resulting change in the value function @xmath273 is uniformly small .",
    "this result is used in the proof of our main result , theorem [ thm : main ] .",
    "the proof relies on the uniqueness of truncatable viscosity solutions of ( p ) ( theorem [ thm : comp - trunc ] and corollary [ cor : comp - trunc ] ) , and the result can then be used to prove a comparison principle for ( p ) without the truncatability assumption ( see theorem [ thm : final - comp ] ) .",
    "[ thm : perturbation ] let @xmath33 and @xmath34 satisfy and simultaneously satisfy ( f1 ) , ( f3 ) .",
    "let @xmath725 satisfy ( f1 * ) with @xmath726 .",
    "furthermore suppose that @xmath727 and @xmath728 for all @xmath667 .",
    "then for every @xmath462 we have @xmath729    for simplicity , let us set @xmath730 and @xmath731 for @xmath464 . since @xmath725 , we can apply theorem [ thm : reg ] with @xmath367 to find that @xmath732 is continuous on @xmath733",
    ". we can apply theorem [ thm : reg ] again with @xmath734 to show that for every @xmath735 , there exists @xmath736 and a modulus of continuity @xmath285 such that @xmath737\\times[z_2,r]$ ] .",
    "this approximate hlder estimate is sufficient to apply a slightly modified version of the arzel - ascoli theorem ( see , for instance ,  ( * ? ? ?",
    "* theorem 2 ) ) . therefore , by passing to a subsequence if necessary , there exists @xmath738 such that @xmath739 locally uniformly on @xmath733 . by proposition",
    "[ prop : utrunc ] , @xmath732 is a monotone truncatable viscosity solution of @xmath740 since @xmath739 locally uniformly and - hold , we can apply proposition [ prop : trunc ] , and classical results from the theory of viscosity solutions  @xcite , to find that @xmath527 is a monotone truncatable viscosity solution of @xmath741    we claim that @xmath742 on @xmath743 . to see this : let @xmath744 , hence @xmath745 for some @xmath114 . without loss of generality , assume that @xmath746 . then by and fatou s lemma we have @xmath747 where the last line follows from and the fact that @xmath33 is upper semicontinuous . by a similar argument with fatou s lemma",
    "we have @xmath748 notice that ( f1 ) implies that @xmath749 on @xmath121 for all @xmath114 and on @xmath124 .",
    "hence , all the points @xmath750 for which @xmath751 are contained in @xmath752 .",
    "since the curves @xmath115 are strictly increasing and @xmath102 is strictly decreasing , the curve @xmath753 for @xmath754 $ ] has a finite number of intersections with @xmath755 .",
    "it follows that @xmath756 and hence @xmath757 , which establishes the claim .    by proposition [ prop : hypo ] ,",
    "@xmath459 given by satisfies ( h3)@xmath641 for @xmath758 . by ( f1 * ) and we have @xmath759 for @xmath760 , and hence @xmath761 for @xmath762 .",
    "similarly , we have that @xmath763 for @xmath764 .",
    "it follows that @xmath765 on @xmath766 , and by applying a translated form of corollary [ cor : comp - trunc ] to find that @xmath765 on @xmath767 .",
    "[ rem : conv ] sequences generated by inf-  and sup - convolutions of @xmath33 and @xmath34 satisfy the hypotheses of theorem [ thm : perturbation ] . recall that the sup - convolution of @xmath768 is defined by @xmath769 and the inf - convolution by @xmath770 .",
    "[ cor : perturbation ] let @xmath33 and @xmath34 simultaneously satisfy ( f1 ) , ( f3 ) and , let @xmath725 satisfy ( f1 * ) with @xmath726 , and let @xmath81 satisfy ( f2 ) .",
    "if  hold for all @xmath667 then @xmath771    fix @xmath376 . by proposition [ prop : dpp ] we have @xmath772 and @xmath773 arguing by symmetry , it follows from theorem [ thm : perturbation ] that @xmath774.\\ ] ] it follows from and a similar argument as in theorem [ thm : perturbation ] that @xmath775 for any @xmath259 . by the arzel - ascoli theorem",
    "we find that @xmath776 \\cap \\partial { \\mathbb{r}}^2_+.\\ ] ] combining  , we have that @xmath777 .",
    "locally uniform convergence follows again from the arzel - ascoli theorem .",
    "[ thm : final - comp ] let @xmath33 and @xmath34 simultaneously satisfy ( f1 ) , ( f3 ) and , and let @xmath81 satisfy ( f2 ) .",
    "let @xmath722 be a viscosity solution of and let @xmath723 be a monotone viscosity solution of .",
    "then if @xmath778 on @xmath82 , where @xmath779 is given in the statement of theorem [ thm : main ] , then @xmath644 on @xmath80 .",
    "let @xmath780 and @xmath781 be the sup-  and inf - convolutions of @xmath33 and @xmath34 as defined in ( see remark [ rem : conv ] ) , respectively . to simplify notation ,",
    "let us write @xmath782 , @xmath783 , and @xmath784 .",
    "by definition we have @xmath785 , and by corollary [ cor : perturbation ] and remark [ rem : conv ] we have @xmath786 locally uniformly on @xmath22 as @xmath787 .",
    "since @xmath788 and @xmath789 we have that @xmath527 is a viscosity solution of @xmath790 by theorem [ thm : hjb ] , @xmath791 is a viscosity solution of @xmath792 furthermore , we have @xmath793 on @xmath82 where @xmath794 .",
    "since @xmath795 and @xmath796 are globally lipschitz we can apply corollary [ cor : comp ] to obtain @xmath797 .",
    "sending @xmath787 we have @xmath384 . by a similar argument",
    "we can prove that @xmath798 , which completes the proof .",
    "in this section we give the proof of our main result , theorem [ thm : main ] .",
    "we first have a preliminary convergence result on the interior @xmath799 , which we later adapt to account for the boundary source @xmath81 .",
    "for @xmath800 we define @xmath801 where @xmath802 and @xmath6 is defined in .",
    "[ lem : prelim - conv ] assume @xmath33 satisfies ( f1 ) and ( f3 ) .",
    "suppose that the weights @xmath0 satisfy and are either all exponential , or all geometric random variables , consructed as in section [ sec : results ] .",
    "in the exponential case , set @xmath135 , and in the geometric case , set @xmath64 .",
    "then for every @xmath803 we have @xmath804,\\ ] ] with probability one .",
    "let @xmath803 .",
    "let @xmath805 and @xmath795 be the sup-  and inf - convolutions of @xmath33 , defined in ( see remark [ rem : conv ] ) . in the exponential case , set @xmath806 and @xmath807 , and in the geometric case , set @xmath808 and @xmath809 . to simplify notation , let us also set @xmath810 , @xmath811 , and @xmath812 , and note that @xmath813 .",
    "notice that by the definition of @xmath146 , we have that holds for both the exponential and geometric cases",
    ". we can therefore invoke theorem [ thm : perturbation ] to find that @xmath814.\\ ] ]    let @xmath800 . in the exponential case , for @xmath23 let @xmath815 be independent and exponentially distributed with parameter @xmath816 , and let @xmath817 be independent and exponentially distributed with parameter @xmath818 . in the geometric case , for @xmath23 let @xmath815 be independent and geometrically distributed with parameter @xmath819 , and let @xmath817 be independent and geometrically distributed with parameter @xmath820 . in either case ,",
    "set @xmath821 @xmath822 and set @xmath823 we can define @xmath817 and @xmath815 on the same probability space as @xmath0 in such a way that @xmath824 for all @xmath23 with probability one .",
    "we therefore have @xmath825 with probability one",
    ". since @xmath826 and @xmath827 are continuous on @xmath22 , we can invoke theorem ( * ? ? ?",
    "* theorem 1 ) to find that @xmath828 with probability one , for fixed @xmath829 $ ] .",
    "we should note that ( * ? ? ?",
    "* theorem 1 ) as stated applies only to exponential dlpp .",
    "the proof for geometric dlpp ( with weights constructed as in section [ sec : results ] ) is very similar , with only minor modifications .",
    "it follows that for every @xmath615 we have @xmath830 with probability one .",
    "sending @xmath624 and recalling we have for every @xmath829 $ ] that @xmath831 uniform convergence follows from the fact that @xmath832 and @xmath833 are monotone decreasing and @xmath834 is uniformly continuous on @xmath835 $ ] ; the proof is similar to ( * ? ? ?",
    "* theorem 1 ) .    to incorporate the boundary source @xmath81",
    "we need the following lemma , which follows from the law of large numbers .",
    "[ lem : slln ] let @xmath836 be a sequence of _ i.i.d . _  exponential random variables with mean @xmath84 .",
    "let @xmath837 be bounded with a locally finite set of discontinuities , and let @xmath838 be non - decreasing with at most polynomial growth .",
    "then we have with probability one that @xmath839 where @xmath87 is a random variable with the exponential distribution with mean @xmath84 .    note",
    "that lemma [ lem : slln ] mimics the constructions of the weights @xmath0 given in section [ sec : results ]",
    ". when @xmath0 are exponential random variables , we have @xmath840 , and @xmath841 , and when @xmath0 are geometric random variables , @xmath842 and @xmath843 is defined according to the construction in section [ sec : results ] .    let @xmath363 be a positive integer .",
    "consider the partition of @xmath109 $ ] given by @xmath844 , where @xmath845 , and let @xmath846 .",
    "set @xmath847 } \\nu$ ] and @xmath848}\\nu$ ] .",
    "then we have that @xmath849 where the last inequality follows from the monotonicity of @xmath154 .",
    "fix @xmath25 and let @xmath850",
    ". then @xmath851 are _ i.i.d .",
    "_ , and the polynomial growth restriction on @xmath154 guarantees that the moments of @xmath852 are finite .",
    "we therefore have by the law of large numbers that @xmath853 with probability one as @xmath854 .",
    "similarly , we have @xmath855 with probability one as @xmath854 .",
    "it follows that @xmath856 with probability one as @xmath854 .",
    "since the above holds for every @xmath857 , we have from that @xmath858 with probability one . by the assumptions on @xmath154 and @xmath843 , @xmath859 is continuous except possibly at points of discontinuity of @xmath843 , which are locally finite .",
    "thus @xmath859 is riemann integrable , and taking @xmath860 we have @xmath861 with probability one .",
    "the proof of the analogous @xmath622 inequality is similar .",
    "we now have the proof of theorem [ thm : main ] .",
    "let @xmath259 , and suppose that @xmath260 . if @xmath862 , then @xmath863 with probability one as @xmath864 .",
    "if @xmath865 then we have @xmath866 it follows from lemma [ lem : slln ] and the construction of the weights @xmath0 in section [ sec : results ] that @xmath867 with probability one as @xmath864 .",
    "the case where @xmath262 and @xmath868 is similar . as in lemma",
    "[ lem : prelim - conv ] , we can use the fact that @xmath6 and @xmath779 are monotone non - decreasing , and @xmath779 is uniformly continuous , to show that we actually have @xmath869 locally uniformly on @xmath82 with probability one .",
    "let @xmath381 . from the definition of @xmath6 we have the following dynamic programming principle @xmath870 combining lemma [ lem : prelim - conv ] , proposition [ prop : dpp ] , and",
    ", we can pass to the limit in to obtain @xmath871 with probability one .",
    "as in lemma [ lem : prelim - conv ] , locally uniform convergence follows from the monotonicity of @xmath29 and @xmath872 , along with the uniform continuity given by theorem [ thm : reg ] .",
    "we present here a fast numerical scheme for computing the viscosity solution @xmath29 of ( p ) .",
    "the scheme is a minor modification of the scheme used in  @xcite . since information propagates along coordinate axes in the definition of the variational problem for @xmath29 , it is natural to consider using backward difference quotients to approximate ( p ) . letting @xmath873 denote the numerical solution on the grid @xmath874 of spacing @xmath654 , we have @xmath875 where @xmath876 and @xmath877 . given @xmath878 and @xmath879",
    ", we can solve for @xmath880 via the quadratic formula to obtain @xmath881 for @xmath882 .",
    "the choice of the positive root in reflects the monotonicity of the scheme , and ensures that it captures the viscosity solution of ( p ) . when @xmath883 or @xmath884 , we recall the boundary condition to obtain @xmath885 notice that when @xmath883 , if we set @xmath886 and @xmath887 in , then and are equivalent . in fact , even when @xmath888 , and are asymptotically equivalent as @xmath889 provided @xmath890 .",
    "the same observations hold when @xmath884 if we set @xmath891 .",
    "thus , to account for the boundary condition in ( p ) , we can simply set @xmath892 and compute @xmath873 via for all @xmath893 ^ 2 $ ] , for any @xmath284 . in summary",
    ", we propose the following numerical scheme for approximating viscosity solutions of ( p ) : @xmath894 note that we can visit the grid points in any sweeping pattern that visits @xmath895 and @xmath896 before @xmath9 , which reflects the cone of influence in the percolation problem .",
    "this scheme requires visiting each grid point exactly once and hence has linear complexity .    our first result guarantees that the simple boundary condition in ( s ) agrees with the boundary condition in ( p ) as @xmath889 .",
    "[ lem : discrete - bc ] let @xmath873 satisfy the scheme ( s ) and suppose that @xmath897 is bounded by @xmath341 for all @xmath898 . if @xmath899 then there exists a constant @xmath900 such that @xmath901    let us give the proof for @xmath883 .",
    "the case of @xmath884 is similar .",
    "define @xmath902 for @xmath903 it follows from the scheme ( s ) and a taylor expansion that @xmath904 iterating we have @xmath905 since @xmath906 we have @xmath907 noting the equivalence of and when @xmath908 , we can set @xmath908 in and iterate as before to obtain @xmath909 combining this with completes the proof .    [ thm : lip - conv ] suppose that @xmath33 and @xmath34 are non - negative , globally lipschitz continuous on @xmath22 and satisfy , and let @xmath81 satisfy ( f2 )",
    ". for @xmath910 let @xmath911 denote the extension of the numerical solution @xmath873 of ( s ) to @xmath22 .",
    "then we have @xmath912 where @xmath29 is the unique monotone viscosity solution of ( p ) .",
    "the proof follows the standard framework outlined by barles and souganidis  @xcite .",
    "this general theory guarantees convergence of any scheme that is monotone , stable , and consistent , provided the pde enjoys strong uniqueness  a comparison principle for semicontinuous sub- and supersolutions .",
    "corollary [ cor : comp ] is the required strong uniqueness result , and it is easy to see that the scheme is both monotone and consistent .",
    "indeed , for any @xmath913 we have @xmath914 as @xmath915 , which is the required consistency . to show monotonicity , let @xmath916 such that @xmath917 and @xmath523",
    ". then we have @xmath918 where the last line follows from the monotonicity of @xmath919 .    therefore , to complete the proof , we need to show that the scheme is stable , and that the boundary condition is satisfied .",
    "stability refers to a bound on @xmath920 , independent of @xmath654 . by lemma [ lem : discrete - bc ] , ( f2 ) , and the continuity of @xmath33 , we have that @xmath921 where @xmath922 , which verifies the boundary condition .",
    "stability follows from a comparison principle for ( s ) , and is similar to  ( * ? ? ?",
    "* lemma 3.3 ) .",
    "we give the argument here for completeness .",
    "let @xmath923 we claim that @xmath924 . to see this , suppose to the contrary that @xmath925 for some @xmath926 ^ 2 $ ] , @xmath284 .",
    "first note that @xmath927 for @xmath928",
    ". therefore , by , we have that @xmath929 on @xmath334 ^ 2\\cap \\partial { \\mathbb{r}}^2_+$ ] for @xmath654 small enough . therefore , there exists @xmath930 ^ 2 $ ] such that @xmath931 note that by the concavity of @xmath932 we have that @xmath933 it follows that @xmath934 by monotonicity of @xmath919 we therefore have @xmath935 this contradicts , hence @xmath936 .",
    "the proof is completed by invoking  ( * ? ? ?",
    "* theorem 2.1 ) .",
    "we now extend the numerical convergence result to @xmath33 @xmath34 satisfying ( f1 ) and ( f3 ) .",
    "[ cor : final - conv ] suppose that @xmath33 and @xmath34 simultaneously satisfy ( f1 ) , ( f3 ) and , and let @xmath81 satisfy ( f2 ) .",
    "define @xmath920 as in theorem [ thm : lip - conv ] .",
    "then we have @xmath937 where @xmath29 is the unique monotone viscosity solution of ( p ) .",
    "define @xmath938 and @xmath939 as in the proof of theorem [ thm : final - comp ] .",
    "by definition we have @xmath785 , and by corollary [ cor : perturbation ] and remark [ rem : conv ] we have @xmath786 locally uniformly on @xmath22 as @xmath787 .",
    "let @xmath940 and @xmath941 denote the numerical solutions defined by ( s ) for @xmath942 and @xmath943 , respectively , extended to @xmath22 as in theorem [ thm : lip - conv ] .",
    "since @xmath944 , and @xmath796 are lipschitz continuous and @xmath81 satisfies ( f2 ) , we can apply theorem [ thm : lip - conv ] to show that @xmath945 locally uniformly on @xmath22 as @xmath915 . since @xmath946 and @xmath947",
    ", we can make an argument , as in theorem [ thm : lip - conv ] , based on a comparison principle for ( s ) , to show that @xmath948 for all @xmath949 . the proof is completed by combining this with and the locally uniform convergence @xmath786 .",
    "we present here some numerical simulations comparing the numerical solutions of ( p ) , computed by ( s ) , to realizations of directed last passage percolation ( dlpp ) .",
    "we restrict our attention to the box @xmath109 ^ 2 $ ] for simplicity . for the case of exponential dlpp",
    ", we consider three macroscopic means , @xmath950 and @xmath951 given by @xmath952 @xmath953 and @xmath954 since the results are very similar for geometric dlpp , we consider only one macroscopic parameter @xmath40 given by @xmath955    figure [ fig : demo1 - 1 t ] compares the level sets of the numerical solutions of ( p ) with simulations of exponential / geometric dlpp on a @xmath956 grid .",
    "the smooth curves correspond to the level sets of the numerical solution of ( p ) while the rough curves correspond to the level sets of the last passage time from the dlpp simulation .",
    "figure [ fig : demo1 - 5 t ] shows the same comparison , except for dlpp simulations on a @xmath957 grid . in both cases , the numerical solutions of ( p ) were computed on a @xmath958 grid .",
    "to give an idea of the computational complexity , it takes approximately a quarter of a second to numerically solve the pde on this grid in matlab on an average laptop .",
    "we now propose an algorithm based on dynamic programming for finding maximizing curves , and we prove in theorem [ thm : max - curve ] and corollary [ cor : max - curve2 ] that the curve produced by our algorithm is approximately optimal for the variational problem defining @xmath29 .",
    "other approaches to finding maximizing curves , such as the method of characteristics  @xcite , or solving the euler - lagrange equations  @xcite , are not guaranteed to produce optimal curves , due to crossing characteristics , and the possibility of local minima .",
    "our method is related to the method of synthesis in optimal control theory for computing optimal controls from solutions of hamilton - jacobi - bellman equations  @xcite .",
    "our algorithm has a parameter @xmath593 and a starting point @xmath667 , and computes a curve @xmath959 with @xmath960 and @xmath961 that nearly maximizes @xmath962 .",
    "the algorithm works by starting at @xmath606 and tracing our way back to the origin by solving a series of dynamic programming problems .",
    "we set @xmath963 , and generate @xmath964 as follows : given we are at step @xmath965 , we use a dynamic programming principle ( similar to proposition [ prop : dpp ] ) to write @xmath966 } \\big\\ { u(y(s ) ) + w(y(s),x_k)\\big\\},\\ ] ] where @xmath967 .",
    "an application of hlder s inequality yields @xmath968 for any @xmath249 with @xmath969 and @xmath970 .",
    "when @xmath33 and @xmath146 are continuous , this upper bound can be attained ( in the limit as @xmath971 ) by the diagonal curve @xmath972 .",
    "thus we are justified in making the following approximation @xmath973 substituting into we find that @xmath974 } \\left\\ { u(y(s ) ) + 2\\sigma(x_k){\\varepsilon}\\sqrt{s(1-s ) } \\right\\}.\\ ] ] we then define @xmath975 where @xmath976 $ ] is the maximizing argument in and @xmath977 .",
    "the algorithm is terminated as soon as @xmath978 and we append the final terminal point @xmath979 . in",
    ", we set @xmath980 whenever @xmath981 .",
    "the algorithm is summarized in algorithm [ alg : max - curve ] .",
    "given a step size @xmath593 and @xmath982 , we generate @xmath964 as follows : + @xmath983 ; + @xmath979 ;    notice that the boundary source @xmath81 does not appear explicitly in algorithm [ alg : max - curve ] , though it does appear implicitly through the solution @xmath29 of ( p ) .",
    "each step of the algorithm moves a distance of at least @xmath984 in the direction @xmath985 or @xmath986 . if @xmath987 ^ 2 $ ]",
    ", then the algorithm will terminate in at most @xmath988 steps .",
    "furthermore , when @xmath33 and @xmath34 are lipschitz , we can show that the polygonal curve @xmath959 generated by algorithm [ alg : max - curve ] has energy within @xmath989 of the maximizing curve .",
    "this is summarized in the following result .",
    "[ thm : max - curve ] let @xmath284 , suppose that @xmath33 and @xmath34 are non - negative , globally lipschitz continuous on @xmath334 ^ 2 $ ] with constant @xmath990 , and suppose that @xmath81 satisfies ( f2 ) .",
    "let @xmath593 , @xmath991 ^ 2 $ ] , and let @xmath992 be the points generated by algorithm [ alg : max - curve ] .",
    "let @xmath993\\to [ 0,\\infty)^2 $ ] be the monotone polygonal curve passing through @xmath994 .",
    "then there exists a constant @xmath995 such that @xmath996    for convenience , we set @xmath383 , @xmath997 , and we extend @xmath33 , @xmath146 and @xmath29 to functions on @xmath19 by setting @xmath998 for @xmath999 . writing @xmath1000 and @xmath1001 for @xmath1002 , we can parameterize @xmath959 so that @xmath1003 for @xmath1004 and @xmath1005 .",
    "it follows that @xmath1006    an application of hlder s inequality gives @xmath1007 for @xmath1008 and any @xmath249 with @xmath969 and @xmath1009 . combining this with the dynamic programming principle we have @xmath1010 } \\left\\ { u(y(s ) ) + 2\\sigma(x_{k - j}){\\varepsilon}\\sqrt{s(1-s ) } ) \\right\\}+ 3c_{lip } { \\varepsilon}^2,\\ ] ] for all @xmath1011 . by the definition of @xmath1012 we have @xmath1013 for @xmath1005 . by iterating this inequality for @xmath1014",
    "we have @xmath1015    we have two cases now .",
    "suppose first that @xmath1016 .",
    "then @xmath1017 and by we have that @xmath1018 . combining this with we have @xmath1019 the proof is completed by noting that @xmath1020 .",
    "suppose now that @xmath1021",
    ". then holds for @xmath1022 and combining this with we have @xmath1023 since @xmath1024 we must have @xmath1025 .",
    "it follows that @xmath1026 inserting this into we see that @xmath1027    if @xmath33 and @xmath34 are not globally lipschitz continuous , then algorithm [ alg : max - curve ] is not guaranteed to yield optimal curves .",
    "however , it can be easily modified to give an algorithm that does .",
    "[ cor : max - curve2 ] suppose that @xmath33 and @xmath34 simultaneously satisfy ( f1 ) , ( f3 ) and , and let @xmath81 satisfy ( f2 ) .",
    "let @xmath795 and @xmath1028 be sequences of functions such that @xmath795 and @xmath796 are lipschitz with constant @xmath630 , @xmath788 , @xmath789 and @xmath1029 locally uniformly .",
    "let @xmath991 ^ 2 $ ] and let @xmath1030\\to [ 0,\\infty)^2 $ ] be the monotone polygonal curve generated by applying algorithm [ alg : max - curve ] to @xmath1031 and @xmath791 with @xmath1032 .",
    "then we have @xmath1033    let us set @xmath1034 , @xmath997 , @xmath1035 , and @xmath383 . by theorem [ thm : max - curve ] there exists a constant @xmath995 such that @xmath1036 it follows that @xmath1037    we now show some simulation results using algorithm [ alg : max - curve ] to compute approximately optimal curves for the exponential / geometric dlpp simulations presented in section [ sec : sim ] .",
    "figure [ fig : demo2 ] shows the curves generated by algorithm [ alg : max - curve ] along with optimal paths for @xmath1038 realizations of dlpp on a @xmath958 grid .",
    "we also show the level sets of the numerical solutions of ( p ) to give points of reference . in all cases , we used a step size of @xmath1039 and computed @xmath1040 in algorithm [ alg : max - curve ] by an exhaustive search with a grid size of @xmath1041 . with these choices of parameters ,",
    "algorithm [ alg : max - curve ] runs in approximately a quarter of a second , assuming the numerical solution @xmath29 is already available .",
    "note also that we implemented algorithm [ alg : max - curve ] exactly as written , even when @xmath33 and @xmath146 are discontinuous , and do not substitute continuous versions as in corollary [ cor : max - curve2 ] .    as in  @xcite",
    ", it is expected that the optimal paths for dlpp will asymptotically concentrate around optimal curves for the variational problem , and this is clearly reflected in the simulations in figure [ fig : demo2 ] .",
    "notice that for exponential dlpp with means @xmath1042 and geometric dlpp with parameter @xmath40 , there are multiple maximizing curves for any terminal point @xmath606 along the diagonal @xmath1043 .",
    "we see that some of the dlpp realizations concentrate around one optimal path , while the remaining realizations concentrate around the other .",
    "algorithm [ alg : max - curve ] will of course only find one of the maximizing curves , depending on the choice one makes when there are multiple maximizing arguments in the definition of @xmath1040 .",
    "we now show some simulations with a source term @xmath81 . here",
    "we consider exponential dlpp with mean @xmath84 on @xmath109\\times ( 0,1]$ ] and @xmath1044 on @xmath109\\times \\{0\\}$ ] .",
    "figure [ fig : sources_demo1 ] shows the optimal curve generated by algorithm [ alg : max - curve ] , along with the level sets of the numerical solution of ( p ) and the optimal paths from 10 realizations of exponential dlpp on a @xmath958 grid .",
    "although our assumptions only allow sources on the boundary @xmath82 , many of the results in the paper can be shown to hold for sources along horizontal or vertical lines in @xmath80 . the idea is to find the appropriate dynamic programming principle that plays the role of proposition [ prop : dpp ] , so that the effect of the weights in the bulk is separated from the source . in the case of a source along the line @xmath1045 for @xmath1046 , and assuming no boundary sources ,",
    "the dynamic programming principle would be @xmath1047 where @xmath383 , @xmath419 , @xmath33 and @xmath34 are , say , lipschitz on @xmath22 , and @xmath81 represents the source , which is nonzero only on the line @xmath1045 .",
    "we can then use this dynamic programming principle and its discrete version ( similar to ) in the proof of theorem [ thm : main ] .",
    "the one caveat is that @xmath29 is in general discontinuous along the line containing the source , though @xmath29 remains locally uniformly continuous on each of the components of @xmath80 obtained by removing the source line .",
    "thus , @xmath29 can only be identified via the variational problem , since we have not proven uniqueness of discontinuous viscosity solutions of ( p ) . however , our numerical results suggest that either uniqueness holds for ( p ) in some special cases where @xmath29 is discontinuous , or at the very least our numerical scheme for ( p ) selects the `` correct '' viscosity solution for the percolation problem .",
    "figure [ fig : sources_demo2 ] , [ fig : sources_demo3 ] , and [ fig : sources_demo4 ] show the optimal curve generated by algorithm [ alg : max - curve ] , along with dlpp simulations for sources on the horizontal lines @xmath1048 , @xmath1049 , and @xmath1050 , respectively .      finally , we consider the totally asymmetric simple exclusion process ( tasep ) with a slow bond rate at the origin .",
    "this model was originally introduced by janowsky and lebowitz  @xcite , and some partial results were obtained more recently by sepplinen @xcite .",
    "the process of interest is the usual tasep with exponential rates of @xmath1051 at all locations in @xmath18 except for the origin , which has a slower rate of @xmath1052 $ ] .",
    "one can think of this as modeling traffic flow on a road with a single toll both that every car must pass through .    through the correspondence with dlpp , the slow bond rate corresponds to a source on the diagonal @xmath1043 . in the context of our paper",
    ", we would have @xmath1053 notice that @xmath33 does not satisfy the assumptions of theorem [ thm : main ] , and we do not expect the continuum limit ( p ) to hold in this case .",
    "a quantity of interest is @xmath1054 which corresponds to the reciprocal of the maximum tasep current  @xcite .",
    "it is known that @xmath1055 and sepplinen  @xcite proved the following bounds : @xmath1056 it is an open problem to determine @xmath1057 for @xmath1058 . in particular ,",
    "one is interested in whether @xmath1059 for all @xmath1060 , or if there are some values of @xmath1061 close to @xmath1062 for which the inverse current @xmath1057 remains unchanged .    even though we do not expect our continuum limit hamilton - jacobi equation to hold for the slow bond rate problem , it is nevertheless interesting to see what our results would say about this open problem were they to hold .",
    "it is easy to see that @xmath1063 for @xmath1064 given by .",
    "indeed , one can see that the optimal curve in the variational problem must lie on the diagonal @xmath1043 , which gives the energy @xmath1065 .",
    "this would suggest that @xmath1066 notice that this violates the bounds in , which indicates that the hamilton - jacobi equation continuum limit ( theorem [ thm : main ] ) does _ not _ hold for sources along diagonal lines .",
    "it has recently come to our attention that the slow bond rate problem has been setteled by basu , sidoravicius , and sly  @xcite .",
    "they show that the inverse current is _ always _ affected when @xmath1067 , but do not give an explicit formula for @xmath1057 .",
    "in this work , we identified a hamilton - jacobi equation for the continuum limit of a macroscopic two - sided directed last passage percolation ( dlpp ) problem .",
    "we rigorously proved the continuum limit when the macroscopic rates are discontinuous .",
    "furthermore , we presented a numerical scheme for solving the hamilton - jacobi equation , and an algorithm for finding optimal curves based on a dynamic programming principle .",
    "below we make some remarks , discuss simple extensions of this work , and ideas for future work .    * * regularity of @xmath1068 : * there are many simple modifications of ( f1 ) under which one can prove theorem [ thm : main ] . for example , the existence of the set @xmath124 bounded by the strictly decreasing curve @xmath102 and @xmath82 on which @xmath430 is not necessary , and one can check that the proofs hold without this assumption .",
    "this would correspond to a tasep model with step initial condition .",
    "the curves @xmath115 on which @xmath33 and @xmath146 may admit discontinuities can all be chosen to be strictly decreasing instead of increasing , with appropriate modifications in the proofs .",
    "in fact , we can even allow the curves to switch from strictly increasing to strictly decreasing , provided the critical point is isolated , and we make an additional cone condition assumption at this point . however , the curves @xmath115 can not have any positive measure flat regions , as this can induce discontinuities in @xmath29 , as shown in remark [ rem : discont ] . *",
    "* discontinuous viscosity solutions : * the regularity assumption ( f1 ) was chosen to ensure that @xmath29 is locally uniformly continuous .",
    "this is essential for invoking the arzel - ascoli theorem in the proof of theorem [ thm : perturbation ] , and in the proof of the comparison principle for ( p ) ( theorem [ thm : comp - trunc ] ) .",
    "we believe that theorem [ thm : main ] holds under far more general assumptions on @xmath33 , allowing @xmath29 to be discontinuous .",
    "presently , we do not know how to prove this .",
    "the largest obstacle seems to be proving uniqueness of viscosity solutions of ( p ) when the solutions @xmath29 and the macroscopic weights @xmath33 are discontinuous .",
    "our numerical results seem to support this conjecture , as the numerical scheme is able to very accurately capture discontinuities in @xmath29 . *",
    "* hydrodynamic limit of tasep : * as we showed in section [ sec : formal - eq ] , the hamilton - jacobi equation ( p ) is formally equivalent to the conservation law governing the hydrodynamic limit of tasep  @xcite",
    ". it would be very interesting to make this connection rigorous .",
    "* * higher dimensions : * the main obstacle in generalizing the hamilton - jacobi equation ( p ) , and the results in this paper , to dimensions @xmath1069 , is the fact that the exact form of the time constant for _ i.i.d . _  random variables @xmath0 is unknown . if an exact form for the time constant @xmath29 were to be discovered for @xmath1069",
    ", then we anticipate no problems in generalizing the results in this paper to higher dimensions .",
    "we should note that although the exact form of @xmath29 is unknown for @xmath1069 , it is known that @xmath29 is continuous , 1-homogeneous , symmetric in all variables , and superadditive , under fairly broad assumptions on the distribution of @xmath0  @xcite .",
    "this is enough to show that @xmath29 is the viscosity solution of some hamilton - jacobi equation , but the explicit form of the equation is unknown .",
    "the author would like to thank jinho baik for suggesting the problem and for stimulating discussions .",
    "the author would also like to thank the anonymous referee whose comments and suggestions have greatly improved this manuscript .",
    "for completeness we give the proof of theorem [ thm : comp - trunc ] here .",
    "the proof is similar to ( * ? ? ?",
    "* theorem 2.8 ) .",
    "suppose that @xmath1070 let @xmath1071 where @xmath1072 since @xmath1073 , we have by hypothesis that @xmath523 on @xmath524 .",
    "therefore , since @xmath444 and @xmath527 are continuous we have @xmath1074 . by there exists @xmath1075",
    "such that @xmath1076 for @xmath1077 set @xmath1078 and @xmath1079 let @xmath583 denote the @xmath579-truncation of @xmath444 . by and we see that @xmath1080 by we have @xmath1081 , and hence @xmath1082",
    "let @xmath1083 and @xmath1084 be as given in ( h3)@xmath641 .",
    "choose @xmath1077 small enough , and @xmath1085 smaller if necessary , so that @xmath1086 . for @xmath554",
    "define @xmath1087    we claim that for @xmath564 large enough , there exists @xmath1088 such that @xmath1089 to see this , first substitute @xmath1090 into to find @xmath1091 for any @xmath511 such that @xmath1092 .",
    "since @xmath583 and @xmath527 are continuous , it follows from that @xmath1093 since @xmath583 is bounded , and @xmath527 is monotone , we have by that latexmath:[\\[\\label{eq : xy - close }    let @xmath516 such that @xmath1095 .",
    "set @xmath1096 and @xmath1097 , and define @xmath1098 a short calculation shows that @xmath1099 .",
    "since @xmath1100 we have @xmath1101 since @xmath527 is pareto - monotone and @xmath1102 we have by that @xmath1103 since @xmath1104 , we see from and that @xmath1105 furthermore , by we have @xmath1106 similarly we have @xmath1107 .",
    "since @xmath1108 we have @xmath1109 it follows from this and that for every @xmath545 there exists @xmath1110 such that @xmath1111 . by",
    "we may pass to a subsequence if necessary to find @xmath1112 such that @xmath558 as @xmath559 .",
    "then we have @xmath1113 combining this with we have @xmath1114 and @xmath1115 since @xmath1116 , it follows from the definition of @xmath374 that @xmath1117 .",
    "therefore , for @xmath545 large enough we have @xmath1088 , which establishes the claim .",
    "letting @xmath1118 we have by that @xmath1119 . by hypothesis",
    "we have @xmath1120 since @xmath444 is truncatable , @xmath583 is a viscosity solution of and therefore @xmath1121 subtracting from we have @xmath1122 let @xmath1123 and note that @xmath1124 where @xmath1125 by we have @xmath1126 .",
    "therefore , for @xmath564 large enough we have @xmath1127 and @xmath1128 .",
    "since @xmath1129 we can invoke ( h3)@xmath641 to find that @xmath1130 note that @xmath1131 combining this with and we have @xmath1132 sending @xmath559 yields a contradiction ."
  ],
  "abstract_text": [
    "<S> we prove that a directed last passage percolation model with discontinuous macroscopic ( non - random ) inhomogeneities has a continuum limit that corresponds to solving a hamilton - jacobi equation in the viscosity sense . </S>",
    "<S> this hamilton - jacobi equation is closely related to the conservation law for the hydrodynamic limit of the totally asymmetric simple exclusion process . </S>",
    "<S> we also prove convergence of a numerical scheme for the hamilton - jacobi equation and present an algorithm based on dynamic programming for finding the asymptotic shapes of maximal directed paths . </S>"
  ]
}