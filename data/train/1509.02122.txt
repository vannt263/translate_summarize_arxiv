{
  "article_text": [
    "image segmentation is a challenging task for which often times the use of suitable prior knowledge about the shape of the sought objects plays an important role . one interesting shape prior is convexity  @xcite . in natural images",
    ", it often occurs that there are multiple convex structures of the same or different classes present in one image , such as wheels or various fruit , as well as composite structures constructed from convex parts , such as bricks and floor tiles .",
    "biology similarly gives numerous examples of multiple convex structures .",
    "for example , many cell types are convex , such as bacteria , yeast , and more complicated cells densely packed into tissue .",
    "numerous subcellular structures , including nuclei and various types of vesicles , are also convex . despite the clear relevance of this situation to the task of image segmentation , respective priors have , to the best of our knowledge ,",
    "not yet been addressed in the literature .",
    "existing methods for segmenting multiple convex structures are specifically designed for certain shapes like ellipsoids or rods , as e.g.   @xcite .",
    "such methods do not enforce generic convexity , but instead employ priors of specific shapes that happen to be convex .",
    "furthermore , such methods commonly segment multiple structures sequentially , and neither the reconstruction of individual structures nor the resulting segmentation of multiple structures is globally optimal w.r.t .  the underlying objective .    beyond specific shape priors , there has been recent interest in generic convexity priors for binary image segmentation . _",
    "star convexity _ priors were introduced in  @xcite , where convexity is defined with respect to all rays emanating from a central , user - defined seed point .",
    "this approach was generalized to the case of geodesic star convexity by  @xcite , which defines convexity with regards to geodesic paths .",
    "truly convex objects were first handled by  @xcite .",
    "however , this approach is limited to a single foreground class , which must be explicitly modeled",
    ". the task of segmenting convex foreground objects without the requirement of user input or explicit modeling is studied in  @xcite .",
    "they propose a graphical model with triple - cliques that encode convexity constraints as 1 - 0 - 1 label sequences along straight lines in the image .",
    "this formulation captures the global nature of convexity .",
    "however , it implies that only one connected component of the foreground class can be present .",
    "furthermore , the complexity of the problem requires the use of approximate solvers which may lead to local minima .",
    "none of the above methods is able to segment many generic convex objects of multiple foreground classes , fully automatically , without the need for user - defined seed points .",
    "* contributions . * in this work we propose the first model and solver for pixel - level segmentation of many generic convex objects of multiple foreground classes .",
    "we introduce new models that include convexity constraints into _ multicut problems _ , which are ilp formulations of image decomposition problems .",
    "we consider two multicut problems , one equivalent to the correlation clustering problem  @xcite , another one equivalent to the potts model . for efficiency ,",
    "following the idea in  @xcite , we iteratively incorporate only the constraints that are violated per instance , and when no more violations occur , we are guaranteed the globally optimal solution . to the best of our knowledge ,",
    "our models are the first to handle many convex objects and multiple foreground classes .",
    "our models can be solved to global optimality in small yet practical cases .",
    "figure  [ fig : method ] gives an overview of the multicut problems as well as our proposed convexity constraints , as described in detail in sections  [ sec : basics ]  and  [ sec : method ] .",
    "given the pixel grid graph @xmath0 of an image , image segmentation tasks are often modeled as the problem of assigning , to each node @xmath1 , one label from a label set @xmath2 so as to minimize some objective function .",
    "a widely used objective function is the energy of a pairwise conditional random field .",
    "a particular instance of this type of objective is the well - known potts model .",
    "its pairwise terms are non - zero only for edges that connect nodes with different labels .",
    "a special case of the potts model is the _ correlation clustering _ or _ partitioning _ model  @xcite .",
    "the respective energy neglects unary terms , and the number of labels equals the number of nodes . in the following we describe two _ multicut problems_. the first one is equivalent to correlation clustering . the second one is equivalent to the potts model .",
    "we also discuss respective solvers as proposed in  @xcite .",
    "these multicut problems are ilps that form the basis of our contribution : in section  [ sec : method ] we take the set theoretic definition of convexity of the connected components of a segmentation , and directly translate it into inequality constraints that we add to the respective ilps .",
    "[ [ the - minimum - cost - multicut - problem . ] ] the minimum cost multicut problem . + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the minimum cost multicut problem  @xcite is equivalent to the correlation clustering problem .",
    "its feasible solutions are all _ decompositions _ of the graph @xmath3 .",
    "a decomposition of @xmath3 is a partition @xmath4 of @xmath5 such that , for every @xmath6 , the subgraph of @xmath3 induced by @xmath7 is connected .",
    "a subgraph of @xmath3 that is connected and induced by a node set @xmath8 is called a _ component _ of @xmath3 .",
    "any decomposition @xmath4 of @xmath3 is characterized by the subset of edges that straddle distinct components : @xmath9 .",
    "such a subset of edges is called a _ multicut _ of @xmath3 .",
    "there is exactly one multicut related to each decomposition of @xmath3 .",
    "the following theorem forms the basis of multicut problems :    the multicuts of @xmath3 are precisely the subsets @xmath10 for which every cycle @xmath11 in @xmath3 satisfies @xmath12 .",
    "[ theo:1 ]    this has been proven in  @xcite .",
    "we give the proof in the appendix . for a sketch ,",
    "see figure  [ fig : method]b .",
    "let @xmath13 be a 01-encoding of a multicut @xmath14 .",
    "it makes explicit , for any pair @xmath15 of neighboring nodes , whether @xmath16 and @xmath17 are in distinct components , namely iff @xmath18 .",
    "means that an edge is an element of the multicut . ]",
    "these _ edge labels _",
    "@xmath19 allow for an equivalent formulation of @xmath20 as linear inequality constraints  , which leads to the following definition :    [ def : multicut ] @xcite given a finite , simple , non - empty graph @xmath21 and a map @xmath22 ( that is , for any pair @xmath23 of neighboring nodes , a cost or reward @xmath24 for @xmath17 and @xmath25 being in distinct components ) , the instance of the _ minimum cost multicut problem _ ( mc ) with respect to @xmath3 and @xmath26 is the ilp @xmath27    constraints   are referred to as as _",
    "cycle constraints_. it is sufficient to consider only the _ chordless cycles _ of @xmath3  @xcite .",
    "[ [ the - minimum - cost - multicut - problem - with - node - labels . ] ] the minimum cost multicut problem with node labels .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we also consider a multicut problem that is equivalent to the potts model .",
    "this is a more constrained optimization problem in which every node assumes precisely one out of finitely many labels , and neighboring nodes are in the same component iff they have the same label :    [ def : multiway - cut ] given a finite , simple , non - empty graph @xmath21 , a map @xmath22 , a finite set @xmath28 and a map @xmath29 ( that is , for any node @xmath17 and any label @xmath30 , a cost or reward @xmath31 for @xmath17 being labeled @xmath30 ) , the instance of the _ minimum cost multicut problem with node labels _ ( mcn ) with respect to @xmath3 , @xmath32 , @xmath26 and @xmath33 is the ilp @xmath34    here , any feasible solution @xmath35 is constrained such that every node @xmath17 is assigned at least and at most one label , namely the unique @xmath36 such that @xmath37 , by and .",
    "it is also constrained such that , for any edge @xmath23 , @xmath38 if and only if @xmath17 and @xmath25 have distinct labels , by and .",
    "thus , @xmath39 is the characteristic function of a multicut of @xmath3 .",
    "it defines uniquely a decomposition of @xmath3 .",
    "[ [ solvers . ] ] solvers .",
    "+ + + + + + + + +    branch - and - cut algorithms for problem  [ def : multicut ] are proposed in  @xcite .",
    "they find globally optimal solutions in reasonable run - time in many practical cases by including constraints   per instance of the problem only in case they are violated .",
    "problem  [ def : multiway - cut ] is solved by  @xcite by transforming it into an equivalent minimum cost multicut problem on a modified graph .",
    "this transformation involves flipping the meaning of node label variables resulting in the so - called _ multiway cut problem_.",
    "this section provides the methodological contribution of our work . in section  [ subsec : method : convexity - constraints - for - multicut ] , we propose a model for image decomposition under the constraint that each component of the resulting partition has to be convex .",
    "we achieve this via additional inequality constraints that we include into the minimum cost multicut problem  [ def : multicut ] .",
    "furthermore , we propose a respective model with node labels . with this model",
    ", we can enforce for any pair of labels , @xmath40 , that a component of label @xmath41 does not contain any node labeled @xmath30 in its convex hull .",
    "this is more general than `` simply '' enforcing convexity of components .",
    "we achieve this , again , via inequality constraints that we include into the minimum cost multicut problem with node labels  [ def : multiway - cut ] . in section  [ subsec : method : optimization ] we propose a solver for the above optimization problems .",
    "let @xmath42 denote an arbitrary open path in @xmath43 .",
    "all components of an image decomposition @xmath4 are convex iff for any path @xmath44 that does not contain any edges in @xmath45 , the straight line between the end points of @xmath44 also does not contain any edges in @xmath45 .",
    "we discretize this set theoretic definition of convexity as follows : in a pixel grid graph with the usual embedding into the 2d plane , where pixels are voronoi regions of graph nodes ( cf .  fig .",
    "[ fig : method]a ) , a component is _ discrete convex _",
    "iff for every path @xmath44 that does not contain any edges in @xmath45 , the interior of the loop formed by @xmath44 and the straight line between its end points does not enclose any nodes of a distinct component .",
    "see figure  [ fig : straightlines ] for a sketch .",
    "we call the set of nodes enclosed by this loop the _ hull _ of @xmath44",
    ". let @xmath46 denote the path in @xmath3 that runs along the boundary of the discrete hull of @xmath44 and connects the first and the last node covered by @xmath44 ( cf .",
    "[ fig : straightlines ] ) .",
    "all components of an image partition are discrete convex iff @xmath47 for a sketch , see figure  [ fig : method]c .",
    "note that in general , the bresenham line  @xcite is different from @xmath46 , as sketched in figure  [ fig : straightlines ] .",
    "we propose to formulate as linear inequality constraints , which enables us to formulate the task of finding the optimal decomposition of @xmath3 into convex components as an ilp :    [ def : multicut - convex ] given a finite , simple , non - empty graph @xmath21 and a map @xmath22 , the instance of the _ minimum cost convex component multicut problem _ ( convex - mc ) with respect to @xmath3 and @xmath26 is the ilp @xmath48    we also refer to this model as _ correlation clustering with convexity constraints _ , to put it into well - known terminology .",
    "[ lemma:1 ] constraints   are equivalent to .    a proof of lemma  [ lemma:1 ] is given in the appendix .",
    "now we consider image decomposition with node labels , which is equivalent to the potts model ( cf .",
    "section  [ sec : basics ] ) .",
    "let @xmath49 denote the nodes covered by a path @xmath44 , and @xmath50 the nodes covered by the respective straight line @xmath46 but not by @xmath44 ( i.e. , all but the `` end points '' of @xmath46 ) .",
    "given an image decomposition with node labels @xmath51 , all components assigned to label @xmath41 are convex iff @xmath52 more generally , components assigned to label @xmath41 have in their convex hulls only nodes with labels from a subset of @xmath53 ( where @xmath54 ) iff @xmath55 this holds because   entails @xmath56 .",
    "constraints are a special case of , namely with @xmath57 .",
    "we propose to formulate   as linear inequality constraints and hence yield an ilp that models image decomposition , with node labels , into convex components :    [ def : multiway - cut - convex ] given a finite , simple , non - empty graph @xmath21 , a map @xmath22 , a finite set @xmath28 , a map @xmath29 , and a set @xmath58 for each @xmath59 with @xmath60 the instance of the _ minimum cost convex component multicut problem with node labels _ ( convex - mcn ) with respect to @xmath3 , @xmath32 , @xmath26 , @xmath33 , and @xmath61 is the ilp @xmath62    we also refer to this model as _ potts model with convexity constraints _ , to put it into well - known terminology .",
    "the proof of equivalence between the convexity constraints and works analogously to the proof of lemma  [ lemma:1 ] that we give in the appendix .",
    "similar to  @xcite we pursue a cutting plane approach in which violated cycle- and convexity constraints are separated and added incrementally .",
    "our algorithm starts by solving mc ( see def .",
    "[ def : multicut ] ) or mcn ( see def .",
    "[ def : multiway - cut ] ) with the method described in  @xcite .",
    "given the resulting image decomposition , we solve the separation problem w.r.t .",
    "convexity constraints as described below .",
    "however , solving an ilp with added convexity constraints can entail new violations of cycle constraints .",
    "hence we propose the algorithm defined in figure  [ fig : algorithm ] . upon termination ,",
    "the algorithm gives the globally optimal feasible solution . in practice",
    "we can , optionally , allow for ilps to be solved up to some relative gap of @xmath63 . in this case",
    "our algorithm gives a feasible solution whose energy is at most @xmath64 away from the global optimum , where @xmath64 is the gap obtained in the last iteration , i.e.  directly before termination .",
    "* separation of convexity constraints . * given an image decomposition , assuming a 2d pixel grid , we detect violated convexity constraints by scanning along sequences of nodes , @xmath65 , each defined by a start node @xmath66 and an offset @xmath67 , with @xmath68 co - prime . in case of the convex - mc problem  [ def : multicut - convex ] , convexity is violated iff two nodes @xmath69 along a sequence lie in the same component , and there exists a node @xmath70 in the sequence with @xmath71 such that @xmath70 lies in a different component . in case of the convex - mcn problem [ def : multiway - cut - convex ] , there is a violation of ( generalized ) convexity iff @xmath69 lie in the same component , labeled @xmath41 , and there exists a node @xmath70 with @xmath71 such that @xmath70 is labeled @xmath72 .",
    "the cardinality of the set of orientations of sequences , @xmath73 , is bounded by @xmath74 , where @xmath75 denotes the number of pixels in a 2d image .",
    "scanning for violations along a particular sequence can be done greedily .",
    "for each orientation , the union of the sets of sequences to consider covers the whole image .",
    "hence the computational complexity for processing one particular orientation is in @xmath76 .",
    "overall , the computational complexity of scanning for violations is bounded by @xmath77 .",
    "optionally , one may want to consider only a subset of orientations , @xmath78 .",
    "then the effort reduces to @xmath79 .",
    "[ subsec : method : paths ] given a pair of nodes @xmath80 that constitutes a violation of convexity , we need to find a respective path @xmath44 and straight line @xmath46 . as for a path @xmath44 from @xmath81 to @xmath82 through their component : in general there are many such paths . to form a constraint ,",
    "we pick just one such path .",
    "we explore two variants : in case of convex - mc ( see def .",
    "[ def : multicut - convex ] ) , a shortest path in terms of number of edges ; in case of convex - mcn ( see def .",
    "[ def : multiway - cut - convex ] ) , a cheapest path in terms of unaries of the label assigned to the component .",
    "dijkstra s algorithm yields an optimal path for either variant .",
    "we compute the straight line @xmath46 as follows : ( 1 ) determine the orientation of the loop formed by path p and the ( continuous ) straight line @xmath83 .",
    "( 2 ) infer the direction of the normal on the ( continuous ) straight line @xmath83 that points to the interior of this loop . without loss of generality , we assume that @xmath44 and the continuous straight line do not intersect . ( 3 ) greedily find the discrete shortest path with minimal distance of nodes to the continuous straight line , subject to the constraint that no node lies outside the loop .",
    "we present proof - of - concept results of our method on various photographs and biological images . for each exemplary image , in addition to the result of our method",
    ", we also show the respective result obtained without convexity constraints .",
    "finally , we provide a comparison to state of the art  @xcite on two exemplary images .",
    "we employ a four - connected grid graph in all experiments .",
    "if not noted otherwise , we check violations of convexity in 8 discrete directions , and set the stopping criterion for the ilp solver to 2% . this is not a hard stopping criterion , and hence smaller gaps are achieved per instance .",
    "table  [ tab : runtimes_energies ] lists the gaps , number of iterations , run - times , and energies obtained for each of the examples .",
    "[ results : subsec : proof - of - concept ]    [ cols=\"^,^,^,^,^,^ \" , ]     [ fig : boykov - bio ]    * potts model . * figure  [ fig:2labelpotts ] shows examples to which we apply two - label potts models enriched by convexity constraints on the foreground label by means of the convex - mcn problem  [ def : multiway - cut - convex ] .",
    "figure  [ fig:2labelpotts](a ) shows a biological image of ellipsoidal _ cell nuclei _ in the tissue of a nematode worm .",
    "the image shows four whole nuclei , and a fraction of a fifth one at the bottom .",
    "convexity constraints allow for a perfect segmentation of the nuclei .",
    "in contrast , a potts model without convexity constraints fails to split apart the nuclei , and yields holes within components .",
    "figure  [ fig:2labelpotts](d ) shows a biological image of polygonal cells in a fly wing .",
    "again , convexity constraints allow for a perfect segmentation of the nuclei , while a respective potts model without convexity constraints is not able to correctly split apart the cells .",
    "figure  [ fig:3labelpotts](a ) shows a photograph to which we apply a three - label potts model with convexity constraints on one foreground label .",
    "our method is able to accurately segment two convex foreground objects on top of a second , non - convex foreground label .",
    "results in figures  [ fig:2labelpotts ] and  [ fig:3labelpotts](c ) were achieved with `` simple '' convexity constraints as captured by  .",
    "an example for the more general constraints   is given in figure  [ fig:3labelpotts](d - f ) .",
    "here , we enforce components labeled `` apple '' to be convex as such , while we enforce components labeled `` orange '' to be convex only w.r.t .  the background . in other words ,",
    "we allow concavities in orange - labeled components as long as they are filled exclusively by apple - labeled nodes .",
    "consequently such concavities appear as desired .",
    "however , incorrect spurious apple components also appear within orange components .",
    "this result is interesting despite the fact that our model does not achieve a perfect segmentation , because it shows potential implications of the generalized constraints .",
    "* correlation clustering .",
    "* figure  [ fig : correlationclustering ] shows two exemplary results for correlation clustering enriched by convexity constraints by means of the convex - mc problem  [ def : multicut - convex ] . in both examples , densely packed objects , namely bricks in a stone wall and cells in a fly wing ,",
    "are nicely separated due to convexity constraints . at the same time , the space between these objects is tesselated into convex components . although these results might not be of direct use as segmentations of the respective objects , they may well serve as convex supervoxelizations to be used as input for further processing .",
    "[ results : subsec : boykov ]    [ [ comparison - to - state - of - the - art - on - two - exemplary - images . ] ] comparison to state - of - the - art on two exemplary images .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we compare our method to the state - of - the - art for segmentation with convexity constraints  @xcite .",
    "the method of gorelick et al .",
    "@xcite is able to handle only one convex structure of one foreground label , and we chose exemplary images accordingly ( figure  [ fig : boykovcomparison ] ) .",
    "we use the code provided by the authors .",
    "first we study a synthetic image ( figure  [ fig : boykovcomparison ] top ) .",
    "the method of  @xcite initializes via the graph cuts solution , yielding a hole in the foreground object . in the process of resolving this high energy configuration , the method breaks the outer boundary of the object and settles to a sub - optimal solution .",
    "in contrast , our method is able to obtain the globally optimal solution . on a second , biological image ( figure  [ fig : boykovcomparison ] bottom ) , we ran  @xcite with two different initializations , namely the standard graph cut solution , as well as a box that we manually placed around the sought structure .",
    "both initializations result in sub - optimal solutions , whereas our method is again able to obtain a globally optimal solution .",
    "however , we note that the method of  @xcite is considerably faster than ours .",
    "we proposed a new approach that introduces convexity constraints into two multicut problems that are equivalent to correlation clustering and the potts model , respectively .",
    "our approach handles convexity constraints for many connected components of multiple different classes , and additionally for pre - specified convexity relationships between objects of different classes .",
    "all concepts described in this paper extend in a straightforward way to 3d . in future work",
    "we will explore strategies for improving the run - time , e.g.  via warm - start of subsequent ilps , for the application to larger data .",
    "[ [ app:1 ] ] proof of theorem  [ theo:1 ] .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + +    first we show that every multicut satisfies @xmath84 for all cycles . given a decomposition and related multicut @xmath45 ,",
    "assume there exists a cycle @xmath85 with @xmath86 .",
    "then @xmath87 straddles distinct components because @xmath88 . on the other hand , the path @xmath89 connects @xmath16 and @xmath17 with edges that are not in @xmath45 , and",
    "hence @xmath16 and @xmath17 belong to the same component . by contradiction",
    ", this proves that @xmath84 for all cycles .",
    "second we show that every @xmath14 that satisfies @xmath90 for all cycles is a multicut of @xmath3 .",
    "given such a @xmath14 , we construct a decomposition @xmath4 and related multicut @xmath45 of @xmath3 as follows : @xmath91 there exists a path @xmath44 between @xmath16 and @xmath17 such that @xmath92 .",
    "now we show that @xmath93 .",
    "if @xmath94 , then @xmath95 , because there is a path between @xmath16 and @xmath17 such that @xmath92 , namely @xmath96 .",
    "if @xmath95 , assume @xmath97 .",
    "then , because @xmath95 , there exists a path between @xmath16 and @xmath17 such that @xmath92 .",
    "hence the cycle @xmath98 satisfies @xmath99 . by contradicting @xmath97",
    ", this proves that if @xmath95 , then @xmath94 .      given a path @xmath44 . in case",
    "@xmath100 it follows from @xmath101 that @xmath102 .",
    "case @xmath103 entails @xmath104 because @xmath105 .",
    "hence @xmath106 . and , @xmath107 because @xmath108",
    "so , @xmath109 @xmath110 ."
  ],
  "abstract_text": [
    "<S> segmenting an image into multiple components is a central task in computer vision . in many practical scenarios , prior knowledge about plausible components </S>",
    "<S> is available . </S>",
    "<S> incorporating such prior knowledge into models and algorithms for image segmentation is highly desirable , yet can be non - trivial . in this work , we introduce a new approach that allows , for the first time , to constrain some or all components of a segmentation to have convex shapes </S>",
    "<S> . specifically , we extend the minimum cost multicut problem by a class of constraints that enforce convexity . to solve instances of this apx - hard integer linear program to optimality , we separate the proposed constraints in the branch - and - cut loop of a state - of - the - art ilp solver . </S>",
    "<S> results on natural and biological images demonstrate the effectiveness of the approach as well as its advantage over the state - of - the - art heuristic . </S>"
  ]
}