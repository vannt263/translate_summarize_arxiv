{
  "article_text": [
    "this paper is concerned with the energy behaviour over long times of numerical methods for oscillatory differential equations with one or several constant high frequencies : @xmath0 where @xmath1 and the frequencies are @xmath2 and @xmath3 the coupling potential @xmath4 is smooth with derivatives bounded independently of  @xmath5 .",
    "the numerical long - time near - conservation of energy for such equations has already been studied before for various numerical integrators , which will be considered also here : for trigonometric integrators in @xcite and ( * ? ? ?",
    "* chapter xiii ) , for the strmer  verlet method in @xcite , for an implicit - explicit ( imex ) method in @xcite .",
    "most of these results concern the single - frequency case ( @xmath6 ) . a nontrivial extension to the multi - frequency case ( @xmath7 )",
    "is given in  @xcite .",
    "the proofs in those papers require numerical non - resonance conditions : first , it is needed that the product @xmath8 of the step size @xmath9 with the high frequencies ( or @xmath10 for methods that effectively work with different numerical frequencies @xmath11 , such as the strmer  verlet and imex methods ) is bounded away from integral multiples of @xmath12 by a distance substantially larger than @xmath9 , e.g. , by @xmath13 .",
    "numerical experiments , e.g. , in ( * ? ? ?",
    "* chapter xiii ) , show clearly that this numerical non - resonance condition is necessary for a satisfactory numerical energy behaviour .    in this paper",
    "we show that without any further non - resonance condition , the _ slow energy _ ,",
    "i.e. , the total energy minus the oscillatory energy , remains well conserved over long times @xmath14 for an arbitrary integer @xmath15 , in the numerically interesting range @xmath16 , provided the total energy remains bounded over such an interval .    to obtain also near - conservation of the _ total and oscillatory energies _ over times @xmath14 ,",
    "it is required in @xcite and ( * ? ? ?",
    "* chapter xiii ) that sums of @xmath17 with at most @xmath18 terms must stay away from integral multiples of @xmath19 . here",
    "we will show that it suffices that they are away from _ non - zero _ integral multiples of @xmath19 , and we present numerical results that illustrate the necessity of such a non - resonance condition between the step size and the frequencies .",
    "away from numerical near - resonances between the step size and the frequencies , our results will be uniform in the frequencies , without imposing any non - resonance condition among the frequencies .",
    "what enables us to obtain long - time near - conservation of the total , slow and oscillatory energies under much less restrictive conditions than in the existing literature , is that we adopt ideas and techniques from @xcite for the exact solution and combine them with those of @xcite and @xcite for the numerical solution . in @xcite and",
    "more recently also in @xcite it is shown that the oscillatory energy , i.e. , the sum of the harmonic energies @xmath20 over @xmath21 , is nearly conserved over times @xmath22 for arbitrary integers @xmath15 , with estimates that are uniform in the frequencies @xmath23 satisfying ( [ frequencies ] ) . in the proof of this result , integral linear combinations of the frequencies are regrouped into non - resonant and near - resonant ones , with a gap appearing between them whose size depends only on @xmath24 and @xmath15 , and then the frequencies are modified such that the near - resonances become exact resonances . with these modified frequencies ,",
    "one then uses a modulated fourier expansion and its almost - invariants as done previously in the literature",
    ". we will proceed in a similar way in this paper for the numerical problem and prove a numerical counterpart to the analytical result of @xcite and @xcite .    after the preparatory section  [ sect : prep ] we state , in section  [ sect : results ] , our main results on the long - time near - conservation of the slow and oscillatory energies along numerical solutions of ( [ odec ] ) . after some illustrative numerical experiments in section  [ sect : numexp ] ,",
    "the theoretical results are proved in the remaining sections .",
    "we introduce appropriately modified frequencies in section  [ sect : gap ] and use them in the modulated fourier expansion constructed in section  [ sect : mfe ] .",
    "the result on bounds and approximation properties of the modulated fourier expansion , which is stated in section  [ sect : mfe ] , is proved in section  [ sect : proof - mfe ] .",
    "two almost - invariants of the modulation system , which are close to the slow and oscillatory energies , are studied in section  [ sect : invariants ] .",
    "we are then in the position to prove the main results in section  [ sect : proof - thm12 ] .",
    "for momenta @xmath25 and positions @xmath1 with @xmath26 we consider the hamiltonian @xmath27 where the oscillatory and slow - motion energies are given by @xmath28 we assume high frequencies satisfying ( [ frequencies ] ) . if the oscillatory energy is bounded by a constant independent of @xmath5 , then @xmath29 for @xmath21 , and we have that the slow energy @xmath30 is @xmath31 close to the energy of the isolated slow system @xmath32 .    the equations of motion are ( [ odec ] ) or , in vector notation , @xmath33 with the nonlinearity @xmath34 , and where @xmath35 is the diagonal matrix with entries @xmath23 .      for the numerical solution of ( [ ode ] ) we consider trigonometric methods as studied in ( * ? ?",
    "* chapter xiii ) . with the step size @xmath9",
    ", they are given in two - step form by @xmath36 2h { \\,\\hbox{\\rm sinc}}(h{{\\mathbf \\omega } } ) { { \\mathbf p}}_n & = & { { \\mathbf q}}_{n+1 } - { { \\mathbf q}}_{n-1 } , \\end{array}\\ ] ] where @xmath37 and @xmath38 with real - valued bounded functions @xmath39 and @xmath40 satisfying @xmath41 , and @xmath42 . for starting the computation",
    "we put @xmath43 , @xmath44 and we compute the approximation @xmath45 by putting @xmath46 in ( [ trigo ] ) and by eliminating @xmath47 .",
    "this yields @xmath48 it is known from ( * ? ? ?",
    "* section xiii.2.2 ) that the method is symplectic if and only if @xmath49      we further consider methods defined by @xmath50 2h\\ , \\widetilde { { \\boldsymbol \\chi}}\\ , { { \\mathbf p}}_n & = & { { \\mathbf q}}_{n+1 } - { { \\mathbf q}}_{n-1 } , \\end{array}\\ ] ] where @xmath51 is a diagonal matrix with entries @xmath11 such that @xmath52 , @xmath53 , @xmath54 , and @xmath55 with @xmath56 . the choice @xmath57 is proposed in @xcite .",
    "the method is symplectic if and only if @xmath58    an important class of such symplectic methods is given by @xmath59 2h\\ , { { \\mathbf p}}_n & = & ( i + \\alpha h^2 { { \\mathbf \\omega}}^2 ) ( { { \\mathbf q}}_{n+1 } - { { \\mathbf q}}_{n-1 } ) . \\end{array}\\ ] ] this can be written as a method ( [ trigo - mod ] ) by defining @xmath60 $ ] through ( see @xcite ; we omit the subscript @xmath61 ) @xmath62 provided that @xmath63 if @xmath64 , and without any restriction on @xmath65 if @xmath66 . with these modified frequencies ,",
    "the method ( [ trigo - alpha ] ) becomes ( [ trigo - mod ] ) with @xmath67 the strmer  verlet method is the special case @xmath68 of ( [ trigo - alpha ] ) , and the implicit - explicit ( or imex ) integrator of @xcite and @xcite is the special case @xmath69 .",
    "we prove results on numerical energy conservation for trigonometric and modified trigonometric integrators .",
    "the technique of proof is related to that of @xcite where a gap condition is created by suitably modifying the frequencies .",
    "we collect assumptions that are relevant for all theorems to be presented in this work .",
    "* assumption a. in addition to ( [ frequencies ] ) we assume the following : *    * the total energy of the initial values is bounded independently of @xmath70 , @xmath71 * there is a radius @xmath72 and a set @xmath73 such that the potential @xmath74 is bounded and has bounded derivatives of all orders in a @xmath75-neighbourhood of @xmath76 .",
    "we denote this @xmath75-neighbourhood by @xmath77 .",
    "* the numerical solution values @xmath78 ( or @xmath79 ) stay in @xmath80 .",
    "* the step size @xmath9 satisfies @xmath81 . *",
    "the frequencies @xmath23 are such that latexmath:[\\[\\label{eq - nonres }     for modified trigonometric integrators this is assumed for the frequencies @xmath11 instead of @xmath23 .    * assumption b. the filter functions @xmath40 and @xmath39 of the method ( [ trigo ] ) are such that the function @xmath83 is bounded from below and above : @xmath84 or the same estimate holds for @xmath85 instead of @xmath86 . *    the first three items of assumption a are necessary for the following results .",
    "the last two items can be relaxed to the conditions @xmath87 and @xmath88 with positive @xmath89 and @xmath90 smaller than @xmath91 , which lead to weaker estimates .",
    "assumption b is needed in our proofs .",
    "numerical experiments indicate , however , that different signs among the @xmath92 do not necessarily lead to a different energy behaviour .      as in @xcite",
    "we consider the modified oscillatory energy , with @xmath93 from ( [ sigma ] ) , @xmath94 if @xmath95 for @xmath96 , this expression is identical to the oscillatory energy  @xmath97 .",
    "this condition on @xmath86 is equivalent to the symplecticity of the numerical flow defined by ( [ trigo ] ) , see ( [ symplectic ] ) .",
    "[ thm : main ] we fix an arbitrary integer @xmath98 and @xmath99",
    ". then there exists @xmath100 such that under assumptions a and b , the numerical solution obtained by method ( [ trigo ] ) satisfies , for @xmath101 , @xmath102 as long as @xmath103 if , in addition , the step size and the frequencies satisfy the following numerical non - resonance condition : @xmath104 then we further have , with @xmath105 from ( [ eq - nonres ] ) , @xmath106 the constants symbolized by @xmath107 are independent of @xmath108 , @xmath9 , @xmath70 , and @xmath23 , but depend on @xmath24 , @xmath15 , @xmath109 , and the constants in assumptions a and  b. the maximal step size @xmath110 is independent of the frequencies @xmath23 .    for vectors @xmath111 of integers and the vector @xmath112 of frequencies",
    "we write @xmath113 condition ( [ num - nonres ] ) can then be rewritten as @xmath114 is related to the results of @xcite .",
    "a substantial difference is that here we do not require the numerical non - resonance condition from @xcite , which reads @xmath115 with the resonance module @xmath116 .",
    "this condition is more restrictive than the numerical non - resonance condition of assumption a and of ( [ num - nonres ] ) , in particular in that the case @xmath117 is not required in ( [ num - nonres - noamal ] ) .",
    "in contrast to @xcite , where near - resonances among the frequencies are excluded , theorem  [ thm : main ] is uniform in the choice of the frequencies @xmath118 . on the other hand , under the non - resonance condition ( [ num - nonres - altpapier ] ) and under further assumptions on the filter functions ,",
    "the article @xcite gives improved near - conservation estimates .",
    "we note the following direct corollary on the conservation of the total and oscillatory energies .",
    "[ cor : h ] if , in addition to the assumptions of theorem  [ thm : main ] including ( [ num - nonres ] ) , the method ( [ trigo ] ) is symplectic , then @xmath119 h_{{\\boldsymbol \\omega}}({{\\mathbf p}}_n , { { \\mathbf q}}_n ) & = & h_{{\\boldsymbol \\omega}}({{\\mathbf p}}_0 , { { \\mathbf q}}_0 ) +   \\bigo ( h^{1-\\delta}/\\kappa ) \\end{array } \\quad \\hbox{for } \\quad 0 \\le nh \\le h^{-n } .\\ ] ]    if @xmath120 for @xmath21 , the modified oscillatory energy @xmath121 is the oscillatory energy @xmath97 in transformed variables @xmath122 and @xmath123 .",
    "the method ( [ trigo ] ) in these variables is still of the form ( [ trigo ] ) with modified filter functions @xmath124 and @xmath125 .",
    "the method is thus symplectic in the transformed variables .",
    "this indicates why the modified oscillatory energy instead of the oscillatory energy shows up in theorem  [ thm : main ] .",
    "we have the following result for the symplectic class of methods ( [ trigo - alpha ] ) , which contains the strmer  verlet scheme and the imex integrator of @xcite and @xcite as special cases . here",
    "we introduce @xmath126    for this class of methods , the non - resonance condition ( [ eq - nonres ] ) as well as the condition on @xmath86 of assumption  b are satisfied under a step size restriction .",
    "[ thm : main - alpha ] we consider the method ( [ trigo - alpha ] ) .",
    "if @xmath66 , we assume that the step size is restricted by @xmath127 for @xmath96 , and if @xmath128 , we assume that @xmath129 for @xmath21 with @xmath130 .",
    "we fix an arbitrary integer @xmath98 and @xmath99 .",
    "then there exists @xmath131 such that , under assumption a without condition ( [ eq - nonres ] ) , the numerical solution obtained by method ( [ trigo - alpha ] ) satisfies , for @xmath101 under the above step size restriction , @xmath102 as long as @xmath103 if , in addition , the step size @xmath9 and the frequencies @xmath11 satisfy the numerical non - resonance condition ( [ num - nonres ] ) , then we further have , with @xmath105 from ( [ eq - nonres ] ) , @xmath132 the constants symbolized by @xmath107 are independent of @xmath108 , @xmath9 , @xmath70 , and @xmath23 , but depend on @xmath24 , @xmath15 , @xmath109 , @xmath133 and the constants in assumption a. the threshold @xmath110 is independent of the frequencies @xmath23 .",
    "theorem  [ thm : main - alpha ] follows from theorem  [ thm : main ] , using the frequencies @xmath11 instead of @xmath23 and the transformed momenta @xmath134 : since @xmath135 $ ] , condition ( [ eq - nonres ] ) of assumption  a is satisfied with some @xmath105 independent of @xmath9 under the step size restriction of theorem  [ thm : main - alpha ] .",
    "concerning assumption b , the condition on @xmath86 is satisfied under the step size restriction of theorem  [ thm : main - alpha ] .",
    "this also implies that @xmath136 is bounded for @xmath137 , @xmath21 .",
    "the step size restriction thus further ensures that the bounded energy condition  ( [ bound - energy ] ) of assumption  a is also satisfied in the transformed variables and with the numerical frequencies @xmath138 instead of @xmath23 .",
    "a result like corollary [ cor : h ] is not valid for the class of symplectic methods ( [ trigo - alpha ] ) , because @xmath97 and @xmath139 differ by terms of size @xmath140 ; see also @xcite and ( * ? ? ?",
    "* section xiii.8 ) for the strmer  verlet method .",
    "for the imex method ( @xmath69 ) one obtains @xmath141 therefore , corollary  [ cor : h ] is valid for the imex scheme for the special case of a single high frequency .",
    "the following experiments illustrate the numerical energy behaviour in situations , for which condition ( [ num - nonres ] ) in theorem [ thm : main ] is only fulfilled for small values of @xmath15 , so that the time intervals @xmath142 in theorems  [ thm : main ] and [ thm : main - alpha ] are _ not _ very long . it will be observed that _",
    "numerical resonances _ then play a significant role in the preservation of the total oscillatory energy on longer time intervals .",
    "unless otherwise stated we use the symplectic trigonometric integrator ( [ trigo ] ) with filter functions @xcite @xmath143    _ experiment 1 .",
    "problem with one degree of freedom .",
    "we consider the scalar differential equation @xmath144 with initial values @xmath145 and @xmath146 .",
    "figure  [ fig : simpleprob ] shows the deviation of the oscillatory energy as a function of time on the interval @xmath147 $ ] .",
    "the two pictures correspond to the cases @xmath148 and @xmath149 , each one for seven different values of @xmath150 ( large deviations correspond to smaller values of  @xmath151 ) .",
    "the different frequencies are chosen so that for fixed time @xmath152 the difference of two consecutive deviations is nearly constant .",
    "this allows us to guess that the dominant term in the deviation behaves like @xmath153 for @xmath154 , and like @xmath155 for @xmath156 .",
    "we note that condition ( [ num - nonres ] ) is satisfied with @xmath157 for @xmath158 and with @xmath159 for @xmath160 .",
    "the near - preservation of the oscillatory energy on intervals of length @xmath161 , stated in corollary 3.1 , can be observed in the numerical experiment . _    ( 0,0 )    ( 331.4,133.6 ) ( -24.2 , 462.4 ) ( 98.77,594.66)@xmath162 ( 31.80,594.66)@xmath163 ( 98.77,526.37)@xmath164 ( 31.80,526.37)@xmath165    _ experiment 2 .",
    "alternating stiff and soft springs .",
    "we consider the motion of alternating stiff harmonic and soft nonlinear springs as discussed in ( * ? ? ?",
    "* section  i.5 and chapter xiii ) .",
    "the corresponding differential equation is of the form treated in this article with only one high frequency  @xmath166 . along the exact solution of the problem ,",
    "the oscillatory energy satisfies @xmath167 on exponentially long time intervals .",
    "we apply various trigonometric integrators to this problem , and we are mainly interested in using step sizes for which @xmath168 with integer values for  @xmath169 and  @xmath170 . _",
    "figure  [ fig : fpu_ho_ttt ] shows the deviation of the oscillatory energy for method ( [ deuflhard ] ) , applied to the problem with @xmath171 and step size according to @xmath154 .",
    "we observe that the deviation of the oscillatory energy is of size @xmath172 on an interval of length @xmath173 . on longer time intervals",
    "the deviation behaves like a random walk .",
    "this is illustrated by computing trajectories with slightly perturbed initial values .",
    "repeating the experiment with other values of @xmath151 , one finds that the deviation of the numerical oscillatory energy behaves like @xmath174 .",
    "such a random walk behaviour has already been observed with computations by the simplified takahashi ",
    "imada method @xcite .",
    "a similar experiment with @xmath156 leads to a @xmath175 behaviour .",
    "figure  [ fig : fpu_ho_loop ] shows the maximum deviation of the numerical oscillatory energy until a fixed time @xmath176 as a function of @xmath65 .",
    "( 0,0 )    ( 335.6,196.2 ) ( -19.9 , 204.9 ) ( 31.44,337.14)@xmath177 ( 31.44,271.74)@xmath178 ( 31.44,206.21)@xmath179    for the modified trigonometric integrators ( [ trigo - mod ] ) we expect similar results , because they can be interpreted as trigonometric integrators with modified frequencies .",
    "we apply the imex integrator ( [ trigo - alpha ] ) with @xmath180 to the problem with alternating stiff and soft springs , where we take @xmath181 . in figure",
    "[ fig : fpu_ho_imex ] we present the results for two different step sizes : @xmath182 and @xmath183 which , by the relation of section  [ sect : mod - trigo ] , correspond to @xmath184 and @xmath185 , respectively .",
    "similar as for the trigonometric method we observe a random walk behaviour : @xmath174 for @xmath182 , and @xmath175 for @xmath183 .",
    "the additional factor @xmath70 in the second experiment can be guessed from the figures , because a similar quantitative behaviour is observed on an interval that is @xmath186 times longer .",
    "( 0,0 )    ( 334.5 , 63.0 ) ( -4.5 , 259.0 ) ( 33.49,267.40)@xmath187 ( 100.70,267.40)@xmath188 ( 167.79,267.40)@xmath189 ( 235.00,267.40)@xmath190 ( 302.09,267.40)@xmath191    ( 0,0 )    ( 335.5,130.7 ) ( -17.0 , 466.7 ) ( 31.68,533.47)@xmath179 ( 31.68,596.11)@xmath192 ( 31.68,468.07)@xmath193 ( 31.68,530.58)@xmath194    _ experiment 3 .",
    "multi - frequency example .",
    "we consider the oscillatory differential equation ( [ odec ] ) with @xmath195 , @xmath196 , @xmath197 , and quadratic potential @xmath198 we apply two trigonometric methods with initial values @xmath199 , @xmath200 with @xmath201 and step size @xmath202 .",
    "the result can be seen in figure  [ fig : desgaut ] . for the symplectic method ( b ) , with filter functions given by ( [ deuflhard ] ) , we observe a linear growth @xmath203 in the numerical oscillatory energy , which soon turns into a quadratic growth . for method ( a ) of @xcite ( the non - symplectic gautschi method ) , with filter functions @xmath204 and @xmath205 ,",
    "the deviation in the oscillatory energy is much smaller .",
    "_    ( 0,0 )    ( 335.6,150.6 ) ( -7.1 , 441.1 ) ( 11.68,586.59)@xmath206 ( 88.17,586.59)method ( a ) ( 88.17,509.74)method ( b )",
    "in order to decide whether a linear combination of frequencies is almost - resonant or non - resonant , we will use a gap in the linear combinations of frequencies .",
    "similarly as in ( * ? ? ?",
    "3.1 ) we construct new frequencies that satisfy a non - resonance condition outside a resonance module .    for finite @xmath24 we can detect a gap in the values of @xmath207 with small @xmath208 .",
    "[ lemma - gap ] we fix an arbitrary integer @xmath98 and @xmath99 .",
    "there exists @xmath209 depending on @xmath15 , @xmath24 , and @xmath109 , such that for all @xmath210 there exists @xmath211 with @xmath212 depending on the frequencies @xmath23 and the step size @xmath9 such that the set @xmath213 contains no element in the interval @xmath214 $ ] .",
    "this set contains at most @xmath215 elements .",
    "therefore , there exist @xmath211 with @xmath212 depending on the frequencies and the time step size and @xmath216 depending only on @xmath15 , @xmath24 , and @xmath109 , such that this set contains no element in the interval @xmath214 $ ] .",
    "we use this gap to introduce modified frequencies @xmath217 for which near - resonant linear combinations , i.e. , those taking a value below the gap , become exactly resonant .",
    "it is convenient to use the notation @xmath218 .",
    "[ prop - modifiedfrequencies ] let @xmath15 , @xmath109 , and @xmath219 be as in lemma  [ lemma - gap ] .",
    "then there exists @xmath220 such that for fixed @xmath221 satisfying condition   the following holds : there exist modified frequencies @xmath222 and a @xmath223-module @xmath224 such that , with @xmath211 from lemma  [ lemma - gap ] , @xmath225 the module @xmath226 does neither contain the unit vectors @xmath227 nor their doubles @xmath228 ; if , in addition , the numerical non - resonance condition ( [ num - nonres ] ) holds , then the module contains only those @xmath229 with @xmath230 that satisfy @xmath231",
    ". moreover , there exists @xmath232 depending only on @xmath15 and @xmath24 such that latexmath:[\\[\\label{eq - diff - om - omt }     we denote by @xmath226 the @xmath223-module generated by @xmath234 this module is spanned by @xmath235 integer - linearly independent elements @xmath236 ( see , for instance , ( * ? ? ? * chap .",
    "iii , theorem  7.1 ) ) .",
    "since the number of modules generated by some subset @xmath237 depends only on @xmath15 and  @xmath24 , the matrix formed by the basis vectors as well its pseudo - inverse are bounded by a constant only depending on @xmath15 and @xmath24 .",
    "the same is true for the coefficients , when the basis vectors are written as an integer - linear combination of linearly - independent elements of @xmath238 .    for the basis vectors we choose @xmath239 such that @xmath240 is minimal .",
    "since @xmath241 is a linear combination with integer coefficients of elements in ( [ setr ] ) and since @xmath242 , it follows from the addition theorem for sine that @xmath243 with constants @xmath244 depending only on @xmath15 and @xmath24 .",
    "we determine @xmath245 as a solution of minimal norm of @xmath246 and introduce new frequencies @xmath222 as @xmath247 these new frequencies are constructed in such a way that   holds .",
    "in addition , the solution @xmath248 of   is bounded as @xmath249 with @xmath90 depending only on @xmath15 and @xmath24 , so that   holds .",
    "moreover , we have for @xmath250 with @xmath230 by the choice of the module @xmath226 , lemma  [ lemma - gap ] and @xmath251 and hence   holds if @xmath9 satisfies @xmath252",
    ".    the condition is used to show that neither the unit vectors @xmath253 nor their doubles @xmath228 are contained in @xmath226 . indeed , if @xmath254 or @xmath255 , then by   and   @xmath256 this gives a contradiction if @xmath257 .",
    "if , in addition , the numerical non - resonance condition ( [ num - nonres ] ) holds , then we have for @xmath258 with @xmath230 and @xmath259 that , by   and  , @xmath260 this gives a contradiction if @xmath261 .",
    "we fix an arbitrary integer @xmath98 and @xmath262 , and we denote by @xmath211 and @xmath219 the constants of lemma [ lemma - gap ] . for fixed step size",
    "@xmath221 satisfying and with @xmath110 from lemma [ prop - modifiedfrequencies ] , we let @xmath263 be the modified frequencies and @xmath226 the @xmath223-module of lemma [ prop - modifiedfrequencies ] . we denote by @xmath264 a set of representatives of the equivalence classes in @xmath265 , which are chosen such that for each @xmath266 the norm of @xmath267 is minimal in the equivalence class @xmath268={{\\mathbf k}}+{{\\cal m}}$ ] , and with @xmath266 , also @xmath269 .",
    "we further denote @xmath270 .",
    "we make the approximation ansatz ( modulated fourier expansion ) @xmath271 and denote the components of @xmath272 by @xmath273 and those of @xmath274 by @xmath275 for @xmath276 .",
    "we insert the ansatz ( [ mfe ] ) into ( [ trigo ] ) , expand the right - hand side into a taylor series around the smooth function @xmath277 and compare the coefficients of @xmath278 .",
    "this yields @xmath279 where we allow for a small defect @xmath280 . here",
    ", @xmath281 denotes the derivative of @xmath282 with respect to @xmath283 , where the last sum is over multi - indices @xmath284 with @xmath285 and @xmath286 .",
    "the operator @xmath287 in ( [ mfe - equation ] ) is given by @xmath288 & = & \\displaystyle 4s_{{{\\langle j \\rangle}}+{{\\mathbf k}}}s_{{{\\langle j \\rangle}}-{{\\mathbf k}}}z_j^{{{\\mathbf k } } }   ( \\tau )   + 2 \\iu s_{2{{\\mathbf k}}}h^{1-\\alpha } \\dot z_j^{{{\\mathbf k } } } ( \\tau )   + c_{2{{\\mathbf k}}}h^{2(1-\\alpha ) } \\ddot z_j^{{{\\mathbf k } } }   ( \\tau ) + \\ldots ~. \\end{array}\\hspace{-4mm}\\ ] ] here , @xmath289 and @xmath290 , and the dots on @xmath291 represent derivatives with respect to the scaled time @xmath292",
    ". the higher order terms are linear combinations of the @xmath169th derivative of @xmath291 ( for @xmath293 ) multiplied by @xmath294 and containing one of the factors @xmath295 or @xmath296 .    to get initial values we insert the ansatz ( [ mfe ] ) into the relation @xmath43 and into the second formula of ( [ trigo ] ) .",
    "this yields the equations ( for @xmath297 ) @xmath298    the taylor series expansions in the relations ( [ lhd ] ) and ( [ mod - init ] ) are truncated after @xmath299 terms , such that the remainder is of size @xmath300 .",
    "since the following analysis requires estimates for the modulation functions @xmath275 and their derivatives on the interval @xmath301 $ ] ( which corresponds to @xmath302 $ ] ) , we consider for functions @xmath303 the norms @xmath304    [ thm : mfe ] for an arbitrarily fixed @xmath15 and under assumptions a and b the numerical solution @xmath272 of ( [ trigo ] ) admits an expansion @xmath305 where the coefficient functions @xmath306 satisfy @xmath307 and are bounded by @xmath308 and for all other @xmath309 by @xmath310 with some @xmath299 . the functions @xmath275 satisfy the equations ( [ mfe - equation ] ) with a defect bounded for @xmath311 by @xmath312 the remainder term @xmath313 in ( [ mfe - intheorem ] ) is bounded by @xmath314 the generic constant @xmath315 is independent of @xmath70 and the frequencies @xmath316 , but depends on @xmath24 , @xmath15 , and the constants in assumptions a and  b.    details of the proof of theorem  [ thm : mfe ] will be given in section  [ sect : proof - mfe ] below .",
    "it combines the techniques of @xcite for the analytic solution of ( [ ode ] ) and those of @xcite for the numerical solution .",
    "the second formula of ( [ trigo ] ) requires a modulated fourier expansion for the derivative approximation .",
    "[ cor : mfe - derivative ] under the assumptions of theorem  [ thm : mfe ] the derivative approximation of ( [ trigo ] ) satisfies , for @xmath317 and @xmath318 , @xmath319 where @xmath320 and @xmath321 follows from ( [ remainder - thm ] ) and assumption a.",
    "our aim is to construct functions @xmath322 ( @xmath297 and @xmath323 ) such that the defect in equations ( [ mfe - equation ] ) is of size @xmath324 . for this",
    "we truncate the taylor series expansions in ( [ lhd ] ) and ( [ mod - init ] ) after @xmath299 terms , and we consider a picard iteration improving the approximation by a factor @xmath325 in every iteration .",
    "this requires @xmath326 iterations .",
    "we denote by @xmath327^m\\bigr)$ ] the @xmath328th iterate and distinguish between the following cases :    1 .   for @xmath329 and @xmath330",
    "the first two terms in the expansion ( [ lhd ] ) disappear and after division by @xmath331 we iterate with a second order differential equation ( [ mfe - equation ] ) for @xmath332^{m+1}$ ] : @xmath333^{m+1}}{\\d\\tau^2 }   + \\big [ \\frac{2h^{2(1-\\alpha)}}{4 ! } \\ , \\frac{\\d^4z_{0}^{{\\mathbf 0}}}{\\d\\tau^4 } + \\frac{2h^{4(1-\\alpha)}}{6 ! } \\",
    ", \\frac{\\d^6z_{0}^{{\\mathbf 0}}}{\\d\\tau^6 } + \\ldots \\big]^m   =   -   h^{2\\alpha } \\ , \\nabla_0^{-{{\\mathbf 0 } } } { { \\cal u}}({{\\mathbf \\phi}}{{\\mathbf z}}^m ) .\\ ] ] here and in the following equations the three dots indicate a truncation of the series after the term corresponding to the @xmath334th derivative",
    ". the notation @xmath335 should be interpreted so that all appearing @xmath275 ( including @xmath336 ) are replaced by their @xmath328th iterate .",
    "2 .   for @xmath337 and",
    "@xmath338 the first term in ( [ lhd ] ) disappears and we iterate using a first order differential equation for  @xmath339^{m+1}$ ] : @xmath340^{m+1}}{\\d\\tau }   + \\big [ c_{2{{\\langle j \\rangle}}}h^{1-\\alpha } \\frac{\\d^2z_{j}^{\\pm{{\\langle j \\rangle}}}}{\\d\\tau^2 } \\pm",
    "\\iu \\,\\frac{s_{2{{\\langle j \\rangle}}}}3 h^{2(1-\\alpha ) } \\frac{\\d^3z_{j}^{\\pm{{\\langle j \\rangle}}}}{\\d\\tau^3 } + \\ldots \\big]^m \\nonumber \\\\[1 mm ] & & \\hspace{0.1 cm }   =   2 h^{\\alpha -1 } \\bigl ( \\cos ( h\\omega_j ) - \\cos ( h\\varpi_j ) \\bigr )",
    "[ z_j^{\\pm{{\\langle j \\rangle } } } ] ^m    - h^{1+\\alpha } \\psi ( h\\omega_j ) \\nabla_{j}^{\\mp{{\\langle j \\rangle}}}\\ , { { \\cal u}}({{\\mathbf \\phi}}{{\\mathbf z}}^m ) .\\qquad \\label{mod - it - jj } \\end{aligned}\\ ] ] 3 .   in all other cases",
    "we iterate with an explicit equation for  @xmath341^{m+1}$ ] : @xmath342^{m+1 } + \\big [ 2 \\iu \\,s_{2{{\\mathbf k } } } h^{1-\\alpha } \\dot z_j^{{{\\mathbf k } } }   + c_{2{{\\mathbf k}}}h^{2(1-\\alpha ) } \\ddot z_j^{{{\\mathbf k } } }    + \\ldots \\bigr]^m \\label{mod - it - jk }   \\\\[1 mm ] & & \\hspace{1.5 cm }   =    2\\bigl ( \\cos ( h\\omega_j ) - \\cos ( h\\varpi_j ) \\bigr ) [ z_j^{{\\mathbf k}}]^m -   h^2 \\psi ( h\\omega_j ) \\nabla_j^{-{{\\mathbf k } } } { { \\cal u}}({{\\mathbf \\phi}}{{\\mathbf z}}^m ) .",
    "\\nonumber\\end{aligned}\\ ] ]    we need initial values @xmath343^{m+1 } ( 0 ) , \\frac{\\d}{\\d\\tau } [ z_0^{{\\mathbf 0}}]^{m+1 } ( 0)$ ] , and @xmath344^{m+1}(0 ) $ ] for @xmath337 .",
    "note that at the iteration @xmath328 the values @xmath345^m ) ( 0)$ ] together with the derivatives of @xmath341^m$ ] at @xmath346 are known . extracting the dominant terms in ( [ mod - init ] ) ,",
    "the required initial values are determined by the equations @xmath347^{m+1 } ( 0)&= & q_{0,0 } -   \\sum_{{{\\mathbf k}}\\ne{{\\mathbf 0 } } }   [ z_{0}^{{\\mathbf k}}]^{m } ( 0 ) , \\nonumber \\\\[0 mm ]   2 h^{1-\\alpha}[\\dot z_0^{{\\mathbf 0}}]^{m+1 } ( 0 ) & = & 2h p_{0,0 } -   \\sum_{{{\\mathbf k}}\\ne{{\\mathbf 0 } } } \\bigl [ 2\\iu \\,s_{2{{\\mathbf k } } } z_0^{{\\mathbf k}}+   2 \\,c_{2{{\\mathbf k } } } h^{1-\\alpha}\\dot z_0^{{\\mathbf k}}+    \\ldots \\bigr]^{m}(0 ) \\quad   \\label{mod - init2}\\\\   & - & \\bigl [ \\frac 2{3!}\\ , h^{3(1-\\alpha ) } \\frac{\\d^3z_{0}^{{{\\mathbf 0}}}}{\\d\\tau^3 } +    \\frac 2{5!}\\ , h^{5(1-\\alpha ) } \\frac{\\d^5z_{0}^{{{\\mathbf 0}}}}{\\d\\tau^5 } + \\ldots \\bigr]^{m } ( 0 )   \\nonumber\\end{aligned}\\ ] ] and for @xmath21 by @xmath348^{m+1 } ( 0)&= & q_{0,j } -    \\sum_{{{\\mathbf k}}\\ne\\pm{{\\langle j \\rangle } } }   [ z_{j}^{{\\mathbf k}}]^{m } ( 0),\\nonumber \\\\[0 mm ]   2 \\iu \\,s_{2{{\\langle j \\rangle}}}[z_j^{{\\langle j \\rangle}}- z_j^{-{{\\langle j \\rangle } } } ] ^{m+1 } ( 0 ) & = & 2h { \\,\\hbox{\\rm sinc}}(h\\omega_j ) p_{0,j } -   \\sum_{{{\\mathbf k}}\\ne\\pm{{\\langle j \\rangle } } } 2\\iu \\,s_{2{{\\mathbf k } } } [ z_j^{{\\mathbf k}}]^{m}(0)\\label{mod - init3 } \\\\ & - &   \\sum_{{{\\mathbf k}}\\in { { \\cal k } } }   \\bigl [ 2 \\,c_{2{{\\mathbf k } } } h^{1-\\alpha}\\dot z_j^{{\\mathbf k}}+   \\iu \\,s_{2{{\\mathbf k } } } h^{2(1-\\alpha)}\\ddot z_j^{{\\mathbf k}}+\\ldots \\bigr]^{m } ( 0 ) .",
    "\\nonumber\\end{aligned}\\ ] ] the starting iterates are chosen for @xmath349 as @xmath343 ^ 0(\\tau ) = q_{0,0 }   $ ] , and @xmath341 ^ 0(\\tau)=0 $ ] for all other indices @xmath309 .      to get the desired bounds ( [ estimthm-00])([estimthm - jk2 ] ) of theorem  [ thm : mfe ] for the coefficient functions of the modulated fourier expansion , we first study the individual terms appearing in equations ( [ mod - it-0])-([mod - it - jk ] ) .",
    "the coefficients of the terms in ( [ mod - it-0 ] ) corresponding to arguments of the @xmath328th iterate are all small because @xmath350 .",
    "next , we consider the coefficients of the terms in ( [ mod - it - jj ] ) corresponding to arguments of the @xmath328th iterate . since @xmath351 by lemma  [ prop - modifiedfrequencies ] , it follows from ( [ eq - lcbound ] ) that @xmath352 .",
    "this implies that @xmath353 and @xmath354 , which are small for positive @xmath211 and @xmath219 .",
    "we have @xmath355 which , by @xmath356 and by ( [ eq - diff - om - omt ] ) and ( [ eq - lcbound ] ) , is seen to be bounded by @xmath357 .",
    "this implies that , after division by @xmath358 , the coefficients of the terms in ( [ mod - it - jj ] ) are small .",
    "finally , we consider the coefficients of the terms in ( [ mod - it - jk ] ) . from the addition formula for sine",
    "we have @xmath359 for @xmath360 , we have @xmath361 so that the estimate ( [ eq - lcbound ] ) can be applied .",
    "this implies that , after division by @xmath362 , the coefficient of @xmath363^m$ ] in ( [ mod - it - jk ] ) is of size @xmath357 , and that of the second derivative is @xmath364 .",
    "similar computations show that the last two terms have coefficients of size @xmath364 and @xmath365 , respectively .",
    "another useful estimate for the following analysis is latexmath:[\\[\\label{eq - psiest }    which follows from assumption  b.    we now prove by induction on @xmath328 , for @xmath367 , @xmath368 and for all other @xmath309 @xmath369 where @xmath370 . by definition of the starting iterates ,",
    "@xmath343 ^ 0 ( \\tau ) = q_{0,0}$ ] is constant and all other functions vanish , so that the statements hold for @xmath371 .    assuming the bounds to be true at level @xmath328 , ( [ estim - j0 ] ) and ( [ estim - jk1 ] ) follow for the @xmath372th iterate from the previous bounds on the coefficients of the equation ( [ mod - it - jk ] ) and the fact that every summand in @xmath373 contains factors @xmath374 with @xmath375 modulo @xmath226 . the estimate ( [ estim - jk2 ] )",
    "follows by applying the triangular inequality to @xmath376 and using @xmath377 the same argument applied to @xmath378 yields the estimate @xmath379^{m+1 } |_{c^r } \\le c \\omega_j^{-1}$ ] from equation ( [ mod - it - jj ] ) , and we get @xmath380^{m+1 } |_{c^r } \\le ch^{2\\alpha}$ ] from ( [ mod - it-0 ] ) using @xmath381 .    in order to derive estimates of the initial values @xmath343^{m+1}(0)$ ] ,",
    "@xmath382^{m+1}(0)$ ] and @xmath383^{m+1 } ( 0)$ ] , we use that @xmath384 by the bounded energy condition ( [ bound - energy ] ) and the bounds on the potential and the numerical solution of assumption a. from the relations ( [ mod - init2 ] ) , still using the estimates at level @xmath328 and in particular @xmath385^m |_{c^r}\\le c\\eps h^{2\\alpha}$ ] for @xmath386 , we obtain the bounds @xmath387^{m+1}(0)|\\le c$ ] and @xmath388^{m+1}(0)|\\le ch^\\alpha$ ] from the condition @xmath389 . using ( [ eq - psiest ] ) and",
    "the condition @xmath389 of assumption  a we get @xmath390^m |_{c^r }    \\le c \\omega_j^{-1}$ ] and @xmath391^m |_{c^r } / |s_{2{{\\langle j \\rangle } } } |   \\le c \\omega_j^{-1}$ ] for @xmath337 . using in addition ( [ usefulest ] ) we get @xmath392^m |_{c^r } / |s_{2{{\\langle j \\rangle } } } |   \\le c \\omega_j^{-1}$ ] for @xmath337 .",
    "these estimates yield @xmath393^{m+1 } ( 0)|\\le c\\omega_j^{-1}$ ] from ( [ mod - init3 ] )",
    ". the bounds ( [ estim-00 ] ) and ( [ estim - jj ] ) are finally obtained by integration of the relations ( [ mod - it-0 ] ) and ( [ mod - it - jj ] ) , respectively .      here",
    ", we prove the estimate ( [ defect - thm ] ) for the defect @xmath280 in theorem  [ thm : mfe ] . the defect @xmath394 of ( [ mfe - equation ] ) for the @xmath395th iterate of section  [ sect : construction ] is equal to @xmath396^m ( \\tau ) $ ] , where @xmath396^m ( \\tau ) $ ] is the defect in inserting the @xmath328th iterate @xmath397^m)$ ] into the modulation equations ( [ mfe - equation ] ) .",
    "it satisfies for @xmath349 @xmath398^m= -h^{-2\\alpha}\\biggl (   \\frac{\\d^2[z_{0}^{{\\mathbf 0}}]^{m+1}}{\\d\\tau^2 } - \\frac{\\d^2[z_{0}^{{\\mathbf 0}}]^{m}}{\\d\\tau^2 } \\biggr ) , \\ ] ] for @xmath21 and @xmath399 @xmath400^m = \\mp2\\iu \\ , s_{2{{\\langle j \\rangle}}}\\ , h^{-1-\\alpha}\\biggl ( \\frac{\\d[z_{j}^{\\pm{{\\langle j \\rangle}}}]^{m+1}}{\\d\\tau } - \\frac{\\d[z_{j}^{\\pm{{\\langle j \\rangle}}}]^{m}}{\\d\\tau}\\biggr ) , \\ ] ] and for all other @xmath309 @xmath401^m =   -\\frac { 4}{h^2}\\ , s_{{{\\langle j \\rangle}}+{{\\mathbf k } } } s_{{{\\langle j \\rangle}}-{{\\mathbf k}}}\\ ,   \\bigl ( [ z_{j}^{{\\mathbf k}}]^{m+1 } - [ z_{j}^{{\\mathbf k}}]^{m } \\bigr).\\ ] ] with the notation @xmath402 v_0^{{\\mathbf k}}= 4 \\ , s_{{{\\mathbf k}}}^2 h^{-2 } z_0^{{\\mathbf k}}\\quad\\ { { \\mathbf k}}\\ne{{\\mathbf 0}}\\\\[1 mm ] v_j^{\\pm{{\\langle j \\rangle } } } = 2\\ , h\\omega_j\\ , s_{2{{\\langle j \\rangle}}}\\ , h^{-1-\\alpha } z_j^{\\pm{{\\langle j \\rangle } } } , \\quad\\   j=1,\\dots,\\ell \\\\[1 mm ] v_j^{{\\mathbf k}}= 4 \\,h\\omega_j \\ , s_{{{\\langle j \\rangle}}+{{\\mathbf k } } } s_{{{\\langle j \\rangle}}-{{\\mathbf k } } } h^{-2 } z_j^{{\\mathbf k}}\\quad\\ \\hbox{else , } \\end{array } \\right.\\ ] ] and the above formulas for the defect we have in the norm ( [ norm ] ) that @xmath403^m\\bigr| \\le   \\| { { \\mathbf v}}^{m+1 } - { { \\mathbf v}}^m \\|_{c^2 } , \\qquad   \\bigl|[\\delta_j^{{\\mathbf k}}]^m\\bigr| \\le   ( h\\omega_j)^{-1 } \\| { { \\mathbf v}}^{m+1 } - { { \\mathbf v}}^m \\|_{c^1}\\ ] ] for @xmath96 and all @xmath323",
    ". we therefore study @xmath404 and show by induction on @xmath328 that for @xmath405 and @xmath370 , @xmath406 which implies the estimate of the defect in theorem  [ thm : mfe ] if we use @xmath326 iterations for the construction of the modulation functions . in the following estimates we repeatedly use ( [ eq - psiest ] ) to obtain the factor @xmath407 where needed . for @xmath371 ,",
    "the definition of @xmath408 and the bounds of section  [ sect : bounds - mod ] yield @xmath409 ^ 1 - [ v_j^{{\\mathbf k}}]^0 |_{c^{lm+l } } = \\bigo ( h^{-\\alpha})$ ] .    for the induction proof",
    "we first consider the functions @xmath410^m$ ] defined in ( [ mod - it - jk ] ) .",
    "the bounds of section  [ sect : bounds - mod ] yield @xmath411^{m+1 } - [ v_j^{{\\mathbf k}}]^{m } \\bigr|_{c^r } \\le c h^\\mu \\| { { \\mathbf v}}^m - { { \\mathbf v}}^{m-1 } \\|_{c^{r+l}}.\\ ] ] we next consider the diagonal elements @xmath412^m$ ] . from ( [ mod - init3 ] ) we obtain that @xmath413^{m+1}(0 ) - [ v_j^{\\pm{{\\langle j \\rangle}}}]^{m}(0 ) \\bigr|",
    "\\le ch^\\mu \\| { { \\mathbf v}}^m - { { \\mathbf v}}^{m-1 } \\|_{c^l}.\\ ] ] integration of equation ( [ mod - it - jj ] ) then yields @xmath413^{m+1}(\\tau ) - [ v_j^{\\pm{{\\langle j \\rangle}}}]^{m}(\\tau ) \\bigr| \\le c h^\\mu \\| { { \\mathbf v}}^m - { { \\mathbf v}}^{m-1 } \\|_{c^l } , \\quad 0\\le\\tau\\le1 .\\ ] ] repeated differentiation in ( [ mod - it - jj ] ) further shows that @xmath413^{m+1 } - [ v_j^{\\pm{{\\langle j \\rangle}}}]^{m } \\bigr|_{c^r } \\le   c h^\\mu \\| { { \\mathbf v}}^m - { { \\mathbf v}}^{m-1 } \\|_{c^{r+l}}.\\ ] ] using @xmath414 and @xmath415 we also bound @xmath416^{m+1 } - [ v_0^{{\\mathbf 0}}]^{m } \\bigr|_{c^r } \\le c h^\\mu \\| { { \\mathbf v}}^m - { { \\mathbf v}}^{m-1 } \\|_{c^{r+l}}.\\ ] ] summarizing we get @xmath417 this proves and the estimate of the defect of theorem  [ thm : mfe ] .      in this section",
    "we prove the bounds ( [ remainder - thm ] ) , which then completes the proof of theorem  [ thm : mfe ] .",
    "we consider the @xmath395th iterates of the modulation functions ( with @xmath418 ) and omit the superscript @xmath395 on the modulation functions and their defects .",
    "the truncated modulated fourier expansion @xmath419 inserted into the method ( [ trigo ] ) @xmath420 has a defect @xmath421 .",
    "the @xmath61th component of the defect is given by @xmath422 where @xmath280 is defined in ( [ mfe - equation ] ) , @xmath423 denotes the remainder term of the truncated taylor series expansions in ( [ lhd ] ) , and @xmath424 denotes the remainder term in the truncated taylor series expansion of the gradient of @xmath4 around @xmath277 .",
    "the second ( finite ) sum collects those terms that where neglected in the definition of @xmath425 in ( [ calu ] ) , i.e. , @xmath426 is defined as @xmath425 in ( [ calu ] ) but with the last sum over @xmath427 with @xmath428 and @xmath429 .",
    "writing @xmath430 , and omitting the index @xmath108 and the argument @xmath431 we have @xmath432 in the following we work with the weighted norm @xmath433 on @xmath434-intervals of length @xmath91 , which corresponds to @xmath318 , the first term in  ( [ defect ] ) is @xmath300 by definition of the modulation functions ( see section  [ sect : defect ] ) , and the @xmath61th component of the other two terms contains a factor @xmath435 as a consequence of the appearance of sufficiently many factors of @xmath275 . by assumption a ( @xmath81 ) and ( [ eq - psiest ] ) this implies that @xmath436    as for the defect in section  [ sect : defect ] it follows from ( [ mod - init2 ] ) and ( [ mod - init3 ] ) that @xmath437^{m}(0 ) -   [ z_0^{{\\mathbf 0}}]^{m+1}(0 ) \\\\[2 mm ] \\widetilde q_{0,j } - q_{0,j } & = & [ z_j^{{{\\langle j \\rangle } } } + z_j^{-{{\\langle j \\rangle}}}]^{m}(0 ) -    [ z_j^{{{\\langle j \\rangle } } } + z_j^{-{{\\langle j \\rangle}}}]^{m+1}(0 ) .",
    "\\end{array}\\ ] ] the estimate ( [ eq : induction ] ) for @xmath438 proves that @xmath439 .",
    "similarly , for the truncated derivative approximation @xmath440 with components @xmath441 ( see corollary  [ cor : mfe - derivative ] ) , we have ( up to an error of size @xmath442 ) @xmath443^{m}(0 )   -   [ \\dot z_0^{{\\mathbf 0}}]^{m+1}(0 ) \\bigr ) \\\\[2 mm ] h { \\,\\hbox{\\rm sinc}}(h\\omega_j ) ( { \\widetilde p}_{0,j } - p_{0,j } ) & = & \\iu \\,s_{2{{\\langle j \\rangle } } } \\bigl ( [ z_j^{{{\\langle j \\rangle } } } - z_j^{-{{\\langle j \\rangle}}}]^{m}(0 ) -    [ z_j^{{{\\langle j \\rangle } } } - z_j^{-{{\\langle j \\rangle}}}]^{m+1}(0)\\bigr ) . \\end{array}\\ ] ] the estimate ( [ eq : induction ] ) and the relation ( [ trigo - q1 ] ) for @xmath45 yield the bound @xmath444 .",
    "we have used that the nonlinearity @xmath445 is lipschitz - continuous in the norm @xmath446 with a constant that only depends on bounds of the derivatives of the potential @xmath4 . using a discrete gronwall lemma , a standard analysis of the propagation of errors in the method ( [ trigo ] ) ( see ( * ? ? ?",
    "* section xiii.4.1 ) ) then proves the bound of @xmath447 for @xmath448 as stated in theorem  [ thm : mfe ] .",
    "in this section we show that the system for the modulation functions has two almost - invariants  one is related to the slow energy @xmath30 and the other to the oscillatory energy @xmath449 .",
    "we multiply the equation ( [ mfe - equation ] ) by @xmath450 and sum over all @xmath451 and @xmath452 to obtain @xmath453 & & \\hspace{-25mm}\\displaystyle = -~   h^{-\\alpha}\\frac{\\d}{\\d \\tau } { { \\cal u}}({{\\mathbf \\phi}}{{\\mathbf z } } ) +   h^{-\\alpha } \\sum_{j=0}^\\ell\\sum_{{{\\mathbf k}}\\in{{\\cal k } } } \\frac{\\phi ( h\\omega_j ) } { \\psi ( h\\omega_j ) }   ( \\dot z_j^{-{{\\mathbf k}}})^\\t\\delta_j^{{\\mathbf k}}. \\end{array}\\ ] ] as in @xcite the left - hand side of this equation is seen to be a total differential . therefore , there exists a function @xmath454 ( t ) $ ] , which depends on the values at @xmath455 of the function @xmath456 and of its first @xmath334 derivatives , such that @xmath457 ( t ) = \\bigo ( h^{n+2-\\alpha}/\\kappa ) = \\bigo ( h^{n+1 } ) .\\ ] ] here , we have used the bounds of theorem  [ thm : mfe ] for the defect @xmath280 and for the @xmath275 , and the estimate @xmath458 which follows from assumptions a and b.    [ thm : invariant1 ] in the situation of theorem  [ thm : mfe ] we have for @xmath459 @xmath460 ( t ) & = &   { { \\cal e}}[{{\\mathbf z } } ] ( 0 ) +   \\bigo ( t   h^{n+1 } ) \\\\[1 mm ]   { { \\cal e}}[{{\\mathbf z } } ] ( t ) & = & h_{\\rm slow } ( { { \\mathbf p}}_n , { { \\mathbf q}}_n ) +   \\bigo ( \\varepsilon h^{-\\alpha }   ) + \\bigo ( h^{2(1-\\alpha ) } ) .\\end{aligned}\\ ] ]    the first statement follows by integration of ( [ dth ] ) .",
    "we next show that @xmath461 ( t ) = { \\mbox{\\footnotesize$\\displaystyle\\frac{1}{2}$ } } |h^{-\\alpha}\\dot z_0^{{\\mathbf 0}}(\\tau ) |^2 + u({{\\mathbf \\phi}}{{\\mathbf z}}^{{\\mathbf 0 } } ) +   \\bigo ( \\varepsilon h^{-\\alpha }   ) + \\bigo ( h^{2(1-\\alpha ) } ) .\\ ] ] by definition ( [ calu ] ) of @xmath425 and the estimates ( [ estimthm-00])([estimthm - jk2 ] ) on the modulation functions we have @xmath462 .",
    "the term with @xmath329 and @xmath336 in ( [ eq - invarianth ] ) yields @xmath463 .",
    "the term with @xmath329 and @xmath386 gives @xmath464 because of the estimates ( [ eq - lcbound ] ) and ( [ estimthm - jk1 ] ) . for @xmath465 and @xmath338",
    "the dominant term is @xmath466 where we have used the bounds ( [ eq - diff - om - omt ] ) and ( [ estimthm - jj ] ) .",
    "all further terms are smaller .",
    "this proves ( [ mod - hslow ] ) .    to relate the right - hand side of ( [ mod - hslow ] ) to the slow energy @xmath467 we use the modulated fourier expansions from theorem  [ thm : mfe ] and corollary  [ cor : mfe - derivative ] , and the first estimate of lemma  [ lem : deriv ] below .",
    "we note the bound @xmath468 , which gives us @xmath469 .",
    "this yields @xmath470 which together with ( [ mod - hslow ] ) proves the result .",
    "[ lem : deriv ] for @xmath329 we have @xmath471 for @xmath96 we have @xmath472    the estimates follow from corollary  [ cor : mfe - derivative ] and the bounds from theorem  [ thm : mfe ] .",
    "we use the estimate ( [ usefulest ] ) of section  [ sect : bounds - mod ] , and ( [ eq - lcbound ] ) to bound the factors @xmath473 from below .",
    "since the sum in the definition of @xmath474 is over multi - indices @xmath475 with @xmath476 and @xmath286 , we have under condition ( [ num - nonres ] ) by lemma [ prop - modifiedfrequencies ] that then @xmath477 , and therefore @xmath478 differentiating this relation with respect to @xmath133 yields @xmath479 similar as before we multiply the equation ( [ mfe - equation ] ) by @xmath480 and sum over all @xmath451 and @xmath452 to obtain @xmath481 & & \\hspace{-30 mm } = ~ - \\iu~ \\sum_{j=0}^\\ell\\sum_{{{\\mathbf k}}\\in{{\\cal k } } } ( { { \\mathbf k}}\\cdot{{\\boldsymbol \\varpi } } ) \\frac{\\phi ( h\\omega_j ) } { \\psi ( h\\omega_j ) }   ( z_j^{-{{\\mathbf k}}})^\\t\\delta_j^{{\\mathbf k}}.\\nonumber\\end{aligned}\\ ] ] the coefficients of the terms @xmath482 and @xmath483 in this expression have opposite sign and therefore cancel in the sum . consequently , as in section  [ sect : invariant1 ] , the formulas of @xcite show that the left - hand expression is a total differential .",
    "therefore , there exists a function @xmath484 ( t ) $ ] , which depends on the values at @xmath485 of the function @xmath456 and of its first @xmath334 derivatives , such that @xmath486 ( t ) = \\bigo ( h^{n+1}/\\kappa )   =   \\bigo ( h^{n } ) .\\ ] ] for this estimate we use the bounds ( [ estimthm - jj ] ) and ( [ estimthm - jk2 ] ) for @xmath487 , the bound ( [ defect - thm ] ) for @xmath280 , and the estimate ( [ phidurchpsi ] ) .",
    "[ thm : invariant2 ] in the situation of theorem  [ thm : mfe ] we have under condition ( [ num - nonres ] ) for @xmath459 @xmath488 ( t ) & = &   { { \\cal i}}[{{\\mathbf z } } ] ( 0 ) +   \\bigo ( t   h^{n } ) \\\\[1 mm ]   { { \\cal i}}[{{\\mathbf z } } ] ( t ) & = & h_{{{\\boldsymbol \\omega}}}^ * ( { { \\mathbf p}}_n , { { \\mathbf q}}_n ) + \\bigo ( h^{1-\\alpha}/\\kappa ) , \\end{aligned}\\ ] ] where @xmath489 is defined in ( [ mod - energies ] ) .",
    "the first statement follows by integration of ( [ deriv - invariant1 ] ) .",
    "the dominant term of @xmath484 ( t ) $ ] is that for @xmath338 with the lowest derivative . with @xmath93 from ( [ sigma ] )",
    "it is given by @xmath490 using ( [ eq - diff - om - omt ] ) , the expression in brackets is seen to be of the form @xmath491 .",
    "all other terms are at most of size @xmath492 .",
    "theorems [ thm : invariant1 ] and [ thm : invariant2 ] are only valid on a short time interval of length @xmath493 . here , we consider the modulated fourier expansion corresponding to starting values @xmath494 and compare the almost - invariants to those corresponding to @xmath495 .",
    "[ lem : trans ] in the situation of theorem  [ thm : mfe ] , let @xmath306 be the coefficient functions of the modulated fourier expansion for initial data @xmath496 .",
    "we let @xmath497 be the coefficient functions corresponding to @xmath494 for @xmath498 with @xmath493 . then , @xmath499 ( \\nu h )   & = & { { \\cal e}}[\\widetilde { { \\mathbf z } } ] ( 0 ) + \\bigo ( h^{n-1 } ) \\\\[1 mm ] { { \\cal i}}[{{\\mathbf z } } ] ( \\nu h )   & = & { { \\cal i}}[\\widetilde { { \\mathbf z } } ] ( 0 ) + \\bigo ( h^{n-1 } ) .\\end{aligned}\\ ] ]    let @xmath500^m)$ ] be the last iterate in the construction of the modulation function @xmath456 for initial data @xmath496 , and let @xmath501^m)$ ] be the @xmath328th iterate of the modulation function  @xmath502 corresponding to initial data @xmath494 .",
    "we aim in estimating the difference @xmath503 .",
    "the functions @xmath504^m$ ] satisfy the relations of section  [ sect : construction ] with @xmath496 replaced by @xmath505 .",
    "the functions @xmath506^m$ ] satisfy the same relations , where the superscripts @xmath328 and @xmath507 are changed to @xmath395 and the defect @xmath280 is added ( see the formulas of section  [ sect : defect ] ) . for the rescaled differences @xmath508 the same arguments as in section  [ sect : defect ] yield @xmath509 with @xmath510 .",
    "the bounds ( [ defect - thm ] ) for the defect introduce an inhomogeneity of size @xmath300 in ( [ interface ] ) , whereas the bounds ( [ remainder - thm ] ) for the difference between @xmath272 and @xmath511 of ( [ qntilde ] ) and those of ( [ remainderdot ] ) for the derivative approximations introduce an inhomogeneity of size @xmath512 . from ( [ interface ] ) it follows by induction on @xmath328 that @xmath513 since the bounds of theorem  [ thm : mfe ] give @xmath514 , we obtain after @xmath515 iterations that @xmath516 and consequently also @xmath517 using lipschitz estimates for @xmath518 and @xmath519 yields the result .",
    "we put the estimates for many short time intervals of length @xmath520 together to get the long - time result of theorem  [ thm : main ] . for @xmath521 ,",
    "let @xmath522 collect the coefficient functions of the modulated fourier expansion starting from @xmath523 .",
    "since we aim at proving that the modified oscillatory energy @xmath121 remains nearly constant , we consider , instead of the bounded energy assumption ( [ bound - energy ] ) , the condition @xmath524 this condition follows with @xmath525 from assumptions a and b , where @xmath526 denotes the bound of the potential @xmath4 on the set @xmath77 of assumption a. since @xmath527 and all @xmath92 have the same sign , we can use ( [ bound - energy2 ] ) instead of ( [ bound - energy ] ) in the proof of theorem  [ thm : mfe ] ( estimates ( [ bounds - initial ] ) )",
    ".    as long as ( [ bound - energy2 ] ) holds with @xmath528 instead of @xmath529 , theorem  [ thm : invariant2 ] yields for @xmath448 @xmath530 ( nh ) - { { \\cal i } } [ { { \\mathbf z}}_m ] ( 0 ) \\bigr| \\le c nh^{n+1}.\\ ] ] by lemma  [ lem : trans ] , @xmath531 ( \\nu h)-{{\\cal i}}[{{\\mathbf z}}_{m+1 } ] ( 0 ) \\bigr|   \\le c h^{n-1}.\\ ] ] summing up these estimates over @xmath328 and applying the triangle inequality yields , for @xmath532 , @xmath533 ( nh ) -   { { \\cal i}}[{{\\mathbf z}}_0 ] ( 0 ) \\bigr| \\le ( m+(m\\nu + n)h^2)c h^{n-1}.\\ ] ] by theorem  [ thm : invariant2 ] , we have @xmath533 ( nh ) - h_{{{\\boldsymbol \\omega}}}^ * ( { { \\mathbf p}}_{m\\nu + n } , { { \\mathbf q}}_{m\\nu + n})\\bigr| \\le c ' h^{1-\\alpha}/\\kappa .\\ ] ] combining these bounds we obtain for @xmath534 ( and @xmath535 ) @xmath536 which is @xmath537 for @xmath538 . in the same way",
    ", we obtain for @xmath534 ( and @xmath535 ) , using the almost - invariant @xmath518 and theorem [ thm : invariant1 ] instead of @xmath519 and theorem [ thm : invariant2 ] , @xmath539 which is @xmath540 for @xmath541 and @xmath542 for @xmath538 .",
    "these estimates ensure that , for sufficiently small step size , ( [ bound - energy2 ] ) holds with @xmath528 instead of @xmath529 on such time intervals . replacing the arbitrary integer @xmath15 by @xmath543 yields the statements of theorem  [ thm : main ] .",
    "e.  hairer , c.  lubich , and g.  wanner , _ geometric numerical integration .",
    "structure - preserving algorithms for ordinary differential equations _",
    ", 2nd ed . ,",
    "springer series in computational mathematics 31 , springer - verlag , berlin , 2006 ."
  ],
  "abstract_text": [
    "<S> for trigonometric and modified trigonometric integrators applied to oscillatory hamiltonian differential equations with one or several constant high frequencies , near - conservation of the total and oscillatory energies are shown over time scales that cover arbitrary negative powers of the step size . </S>",
    "<S> this requires non - resonance conditions between the step size and the frequencies , but in contrast to previous results the results do not require any non - resonance conditions among the frequencies . </S>",
    "<S> the proof uses modulated fourier expansions with appropriately modified frequencies . </S>"
  ]
}