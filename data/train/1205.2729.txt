{
  "article_text": [
    "the evolution of a collisionless self - gravitating system is described by two coupled equations : the vlasov equation , @xmath1 where @xmath2 is the one - particle distribution function and @xmath3 is the gravitational potential , and poisson s equation , @xmath4 @xmath0-body simulations use a monte - carlo method to solve these equations .",
    "the distribution function is represented by a collection of @xmath0 particles @xcite : @xmath5 where @xmath6 , @xmath7 , and @xmath8 are the mass , position , and velocity of particle @xmath9 . over time , particles move along characteristics of ( [ eq : vlasov ] ) ; at each instant , their positions provide the density needed for ( [ eq : poisson ] ) .    in many collisionless @xmath0-body simulations ,",
    "the equations of motion actually integrated are @xmath10 where @xmath11 is the _",
    "softening length_. these equations reduce to the standard newtonian equations of motion if @xmath12 .",
    "the main reason for setting @xmath13 is to suppress the @xmath14 singularity in the newtonian potential ; this greatly simplifies the task of numerically integrating these equations ( e.g. , * ? ? ?",
    "* ) . by limiting the spatial resolution of the gravitational force ,",
    "softening also helps control fluctuations caused by sampling the distribution function with finite @xmath0 ; however , this comes at a price , since the gravitational field is systematically biased for @xmath13 @xcite .",
    "softening is often described as a modification of newtonian gravity , with the @xmath14 potential replaced by @xmath15 .",
    "the latter is proportional to the potential of a @xcite sphere with scale radius @xmath11 .",
    "this does _ not _ imply that particles interact like plummer spheres @xcite ; the acceleration of particle @xmath9 is computed from the field at the point @xmath7 only .",
    "but it does imply that softening can also be described as a smoothing operation ( e.g. , * ? ? ?",
    "* ) , in which the pointillistic monte - carlo representation of the density field is convolved with the kernel @xmath16 in effect , the source term for poisson s equation ( [ eq : poisson ] ) is replaced with the _ smoothed density _",
    "@xmath17 formally , ( [ eq : nbody ] ) provides a monte - carlo solution to the vlasov equation ( [ eq : vlasov ] ) coupled with @xmath18 thus one may argue that a softened @xmath0-body simulation actually uses standard newtonian gravity , as long as it is clear that the mass distribution generating the gravitational field is derived from the particles via a smoothing process .",
    "although plummer softening is widely used in @xmath0-body simulations , its effects are incompletely understood .",
    "if the underlying density field is featureless on scales of order @xmath11 , softening has relatively little effect .",
    "however , @xmath0-body simulations are often used to model systems with power - law density profiles ; for example , @xcite and ( * ? ? ?",
    "* hereafter nfw ) models , which have @xmath19 at small @xmath20 , are widely used as initial conditions .",
    "one purpose of this paper is to examine how softening modifies such profiles .",
    "assume that the underlying density profile is spherically symmetric and centered on the origin : @xmath21 .",
    "the integrand in ( [ eq : smooth - rho ] ) is unchanged by rotation about the axis containing the origin and the point @xmath22 , so the integral can be simplified by adopting cylindrical coordinates @xmath23 , where @xmath22 is located on the @xmath24-axis at @xmath25 .",
    "the integral over @xmath26 is trivial ; for plummer smoothing , the result is @xmath27 where the second equality holds because the outer integral is taken over the entire @xmath24 axis .",
    "the first step is to examine the effect of plummer smoothing on power - law density profiles , @xmath28 , where @xmath29 .",
    "these profiles are not realistic , since the total mass diverges as @xmath30 .",
    "however , results obtained for power - law profiles help interpret the effects of smoothing on more realistic models .       profile .",
    "dashed line is the underlying density profile ; solid curve is the result of smoothing with @xmath32 .",
    "the smoothed profile slightly exceeds the underlying power - law at large @xmath20 .",
    "[ cusp2 ] ]    to 0.10     profile .",
    "dashed line is the underlying density profile ; solid curve is the result of smoothing with @xmath32 .",
    "the smoothed profile slightly exceeds the underlying power - law at large @xmath20 .",
    "[ cusp2 ] ]    let the density be @xmath33 .",
    "the total mass enclosed within radius @xmath20 is @xmath34 . in this case",
    ", the smoothed density profile can be calculated analytically ; the double integral is @xmath35 this yields a remarkably simple result for the smoothed density , plotted in fig .",
    "[ cusp1 ] , @xmath36 where @xmath37 .",
    "the smoothed mass within radius @xmath20 , hereafter called the _ smoothed mass profile _ ; only density profiles can be smoothed .",
    "] , is @xmath38      let the density be @xmath40 .",
    "the total mass enclosed within radius @xmath20 is @xmath41 .",
    "the integral over @xmath42 can be evaluated , but the result is not particularly informative and the remaining integral must be done numerically .",
    "[ cusp2 ] presents the results . for @xmath43 ,",
    "the smoothed density exceeds the underlying power - law profile .",
    "this occurs because smoothing , in effect , spreads mass from @xmath44 to larger radii , and with the underlying profile dropping away so steeply this redistributed mass makes a relatively large contribution to @xmath45 .",
    "note that as @xmath46 , the smoothed density @xmath47 .",
    "it appears impossible to calculate the smoothed density profile for arbitrary @xmath48 without resorting to numerical methods , but the central density is another matter .",
    "setting @xmath49 , the smoothed density is @xmath50 the central density ratio @xmath51 is plotted as a function of @xmath48 in fig .",
    "[ dzero ] . for @xmath52 and @xmath53 , the ratio @xmath54 and @xmath53 , respectively , in accord with the results above , while as @xmath55 the central density diverges .",
    "the smoothed central density for an arbitrary power - law is useful in devising an approximate expression for the smoothed density profile ( appendix  a.1 ) .",
    "in addition , the central density is related to the shortest dynamical time - scale present in an @xmath0-body simulation , which may in turn be used to estimate a maximum permissible value for the time - step (   4.3.1 ) .",
    "plotted as a function of @xmath48 .",
    "limiting values are @xmath54 as @xmath56 and @xmath57 as @xmath55 .",
    "[ dzero ] ]",
    "as noted above , both of these profiles have @xmath31 as @xmath46 . for this reason ,",
    "they are treated in parallel .",
    "the @xcite model has density and mass profiles @xmath58 where @xmath59 is the scale radius and @xmath60 is the total mass .",
    "the @xcite model has density and mass profiles @xmath61 where @xmath59 is again the scale radius and @xmath62 is a characteristic density .",
    "the double integrals required to evaluate the smoothed versions of these profiles appear intractable analytically but can readily be calculated numerically .",
    "[ rhoh ] and  [ rhonfw ] present results for a range of @xmath11 values between @xmath59 and @xmath63 . for comparison ,",
    "both models are scaled to have the same underlying density profile at @xmath64 .     and density @xmath65 .",
    "lower curves show profiles smoothed with @xmath66 , @xmath67 ,  , @xmath68 ( from top to bottom ) ; heavy curve is @xmath69 , dashed curve is @xmath32 .",
    "inset shows ratio @xmath70 .",
    "[ rhonfw ] ]    to 0.10     and density @xmath65 .",
    "lower curves show profiles smoothed with @xmath66 , @xmath67 ,  , @xmath68 ( from top to bottom ) ; heavy curve is @xmath69 , dashed curve is @xmath32 .",
    "inset shows ratio @xmath70 .",
    "[ rhonfw ] ]    the smoothed profiles shown in figs .",
    "[ rhoh ] and  [ rhonfw ] are , for the most part , easily understood in terms of the results obtained for power - laws . for radii @xmath71 , smoothing transforms central cusps into constant - density cores , just as in fig .",
    "[ cusp1 ] .",
    "if the softening length @xmath11 is much less than the scale length @xmath59 , the smoothed density @xmath72 within @xmath64 is almost independent of the underlying profile at radii @xmath73 .",
    "consequently , the smoothed central density @xmath74 , echoing the result obtained for the power - law @xmath75 .",
    "in addition , the actual curves in figs .  [ rhoh ] and  [ rhonfw ] are shifted versions of the curves in fig .",
    "[ cusp1 ] ; this observation motivates simple approximations to @xmath76 and @xmath77 described in appendix  a.2 .    on the other hand ,",
    "if @xmath11 is comparable to @xmath59 , the quantitative agreement between these profiles and the smoothed @xmath52 profile breaks down ; the smoothed density at small @xmath20 has a non - negligible contribution from the underlying profile beyond the scale radius @xmath59 . as an example , for @xmath32 the central density of the smoothed nfw profile is higher than the central density of the smoothed hernquist profile , because the former receives a larger contribution from mass beyond the scale radius .",
    "a somewhat more subtle result , shown in the insets , is that heavily smoothed profiles _ exceed _ the underlying profiles at radii @xmath78 .",
    "this is basically the same effect found with the @xmath79 power - law profile (   2.2 ) ; with the underlying density dropping rapidly as a function of @xmath20 , the mass spread outward from smaller radii more than makes up for the mass spread to still larger radii .",
    "this effect is more evident for the hernquist profile than for the nfw profile because the former falls off more steeply for @xmath78 .",
    "the @xcite model has density and mass profiles @xmath80 where @xmath59 is the scale radius and @xmath60 is the total mass .",
    "the double integrals required to evaluate the smoothed version of this profile appear intractable analytically but can readily be calculated numerically . fig .",
    "[ rhoj ] present results for a range of @xmath11 values between @xmath59 and @xmath63 .    , [ rhonfw ] , and  [ rhoj ] .",
    "solid lines are underlying profiles ; from bottom to top , they represent jaffe , hernquist , and nfw models , respectively . dashed , dot - dashed , and dotted lines give results for @xmath81 , @xmath82 , and @xmath83 , respectively . [ slope ] ]    to 0.10    , [ rhonfw ] , and  [ rhoj ] .",
    "solid lines are underlying profiles ; from bottom to top , they represent jaffe , hernquist , and nfw models , respectively .",
    "dashed , dot - dashed , and dotted lines give results for @xmath81 , @xmath82 , and @xmath83 , respectively . [ slope ] ]    again , much of the behavior shown in this plot can be understood by reference to the results for the @xmath79 power - law .",
    "in particular , for smoothing lengths @xmath84 , the central density is @xmath85 , and the curves in fig .",
    "[ rhoj ] are shifted versions of the one in fig .",
    "[ cusp2 ] .",
    "as the inset shows , for larger values of @xmath11 the smoothed profiles quite noticeably exceed the underlying profile ; the effect is stronger here than it is for a hernquist model because the jaffe model has more mass within @xmath86 to redistribute .      figs .",
    "[ rhoh ] , [ rhonfw ] , and  [ rhoj ] have interesting implications for @xmath0-body experiments .",
    "one might expect the smoothed profiles to resolve the inner power - laws of the underlying models as long as the softening length @xmath11 is somewhat less than the scale radius @xmath59 , but that is not what these figures show .",
    "profiles smoothed with @xmath87 are essentially constant - density cores attached to power - law outer profiles ; the density within the core depends on @xmath11 , but no inner cusp per se can be seen . for @xmath88 , on the other hand , the smoothed profiles do appear to trace the inner power - laws over some finite range of radii , before flattening out at smaller @xmath20 . only for",
    "@xmath89 can the inner cusps be followed for at least a decade in radius .",
    "[ slope ] helps explain this result .",
    "the underlying jaffe , hernquist , and nfw profiles all roll over gradually from their inner to outer power - law slopes between radii @xmath90 .",
    "thus a resolution somewhat better than @xmath91 is required to see the inner cusps of these models . in practice , this implies the softening parameter @xmath11 must be several times smaller than @xmath91 .",
    "since the formalism developed above is exact , numerical tests of a relation like ( [ eq : plummer - smooth ] ) for the smoothed density @xmath72 may seem superfluous . in practice , such tests can be illuminating  as benchmarks of @xmath0-body technique . in",
    "what follows , the smoothing formalism will be applied to actual @xmath0-body calculations , to check @xmath0-body methodology and to demonstrate that the formalism has real applications .",
    "putting this plan into operation requires some care . to begin with , an @xmath0-body realization of a standard",
    "hernquist or jaffe profile spans a huge range of radii . typically , the innermost particle has radius @xmath92 or @xmath93 for a hernquist or jaffe profile , respectively , while for either profile , the outermost particle has radius @xmath94",
    ". a dynamic range of @xmath95 or  @xmath96 can be awkward to handle numerically ; even gridless tree codes may not accommodate such enormous ranges gracefully .",
    "one simple option is to truncate the particle distribution at some fairly large radius , but it s preferable to smoothly taper the density profile : @xmath97      \\!\\ ! ( 1 + \\mu ) \\ , \\rho _ { * } \\ , ( b / r)^2 \\ , e^{-r / r _ { * } } \\ , , &          r > b \\\\",
    "\\end{array }      \\right .",
    "\\label{eq : tapered - models}\\ ] ] where the taper radius @xmath98 , the values of @xmath99 and @xmath100 are fixed by requiring that @xmath101 and its first derivative are continuous at @xmath102 , and the value of @xmath103 is chosen to preserve the total mass .",
    "let @xmath104 be the logarithmic slope of the density profile at @xmath102 , and @xmath105 be the underlying mass profile ; then @xmath106    , @xmath107 , and @xmath108 , respectively .",
    "[ rhohjt ] ]    to 0.10    , @xmath107 , and @xmath108 , respectively .",
    "[ rhohjt ] ]    fig .",
    "[ rhohjt ] shows how plummer smoothing modifies tapered hernquist and jaffe profiles .",
    "both profiles have scale radius @xmath109 , taper radius @xmath110 , and mass @xmath111 ; these parameters will be used in all subsequent calculations . in each case",
    ", the underlying profile follows the standard curve out to the taper radius @xmath112 , and then rapidly falls away from the outer power law . at radii @xmath113 , the smoothed profiles match those shown in figs .",
    "[ rhoh ] and [ rhoj ] , apart from the factor of @xmath114 used to preserve total mass . at larger radii",
    ", the smoothed profiles initially track the underlying tapered profiles , but then transition to asymptotic @xmath115 power law tails .",
    "this occurs because the plummer smoothing kernel ( [ eq : plummer - kernel ] ) falls off as @xmath116 at large @xmath20 ; in fact , these power laws match @xmath117 , which is the large-@xmath20 approximation for a point mass @xmath60 smoothed with a plummer kernel .",
    "the amount of mass in these @xmath116 tails is negligible .      in principle , it s straightforward to verify that the smoothed profiles above generate potentials matching those obtained from @xmath0-body calculations . for a given density profile @xmath118 ,",
    "construct a realization with @xmath0 particles at positions @xmath7 ; a @xmath0-body force calculation with softening @xmath11 yields the gravitational potential @xmath119 for each particle .",
    "conversely , given the smoothed density profile @xmath72 , compute the smoothed mass profile @xmath120 , and use the result to obtain the _ smoothed potential _ @xmath121 : @xmath122 with boundary condition @xmath123 as @xmath124 . for each particle , the @xmath0-body potential @xmath119",
    "may be compared with the predicted value @xmath125 ; apart from @xmath126 fluctuations , the two should agree .",
    "a major complication is that @xmath126 fluctuations in @xmath0-body realizations imprint spatially coherent perturbations on the gravitational field ; potentials measured at adjacent positions are not statistically independent .",
    "for example , the softened potential at the origin of an @xmath0-body system is @xmath127 if the radii @xmath128 are independently chosen , this expression is a monte carlo integral , which will deviate from @xmath129 by an amount of order @xmath130 ; moreover , everywhere within @xmath131 the potential will deviate upward or downward by roughly as much as it does at @xmath49 .",
    "one way around this is to average over many @xmath0-body realizations , but this is tedious and expensive .",
    "an easier solution is to sample the radial distribution uniformly .",
    "let @xmath105 be the mass profile associated with the underlying density @xmath118 .",
    "assign all particles equal masses , and determine the radius @xmath128 of particle @xmath9 by solving @xmath132 for @xmath133 to @xmath0 .",
    "this eliminates radial fluctuations ; the monte - carlo integral for @xmath134 is replaced with a panel integration uniformly spaced in @xmath105 , and the central potential is obtained with relatively high accuracy .",
    "this trick does not suppress _ non - radial _ fluctuations , so the @xmath0-body potential evaluated at any point @xmath135 still differs from the true @xmath121 . but a non - radial fluctuation which creates an overdensity at some position @xmath136 must borrow mass from elsewhere on the sphere @xmath137",
    "; over - dense and under - dense regions compensate each other when averaged over the entire surface of the sphere .",
    "the resulting potential fluctuations likewise average to zero over the sphere , as one can show by using gauss s theorem to evaluate the average gradient of the potential and integrating inward from @xmath138 .",
    "finally , a subtle bias arises if the particles used to generate the potential are also used to probe the potential , since local overdensities are sampled more heavily . to avoid this",
    ", the potential can be measured at a set of points @xmath139 which are _ independent _ of the particle positions @xmath7 .",
    "then @xmath140 should display some scatter , but average to zero when integrated over test points @xmath139 within a spherical shell .     between @xmath0-body and smoothed potentials for tapered hernquist ( left ) and jaffe ( right ) models ,",
    "normalized by central potential @xmath129 .",
    "vertical dashed lines show value of @xmath69 .",
    "points are results for uniform realizations ; jagged curves shows averages for groups of 32 points .",
    "grey - scale images show typical results for _ random _ realizations .",
    "central potentials are @xmath141 and @xmath142 .",
    "[ deltaphihj ] ]    to 0.10     between @xmath0-body and smoothed potentials for tapered hernquist ( left ) and jaffe ( right ) models , normalized by central potential @xmath129 .",
    "vertical dashed lines show value of @xmath69 .",
    "points are results for uniform realizations ; jagged curves shows averages for groups of 32 points .",
    "grey - scale images show typical results for _ random _ realizations .",
    "central potentials are @xmath141 and @xmath142 .",
    "[ deltaphihj ] ]    fig .",
    "[ deltaphihj ] shows results from direct - sum potential calculations for tapered hernquist and jaffe models , using units with @xmath143 . in each case , the underlying density profile was represented with @xmath144 equal - mass particles , and the potential was measured at @xmath145 points uniformly distributed in @xmath146 between @xmath147 and @xmath148 .",
    "the points show results for uniform radial sampling . while non - radial fluctuations create scatter in @xmath149 , the distribution is fairly symmetric about the line @xmath150 .",
    "the jagged curves are obtained by averaging @xmath151 over radial bins each containing @xmath152 points .",
    "these averages fall near zero , demonstrating very good agreement between the @xmath0-body results and the potentials calculated from the smoothed density profiles .    for comparison , the grey - scale images in fig .",
    "[ deltaphihj ] display representative results for _ random _ realizations of each density profile . in these realizations ,",
    "the radius of particle @xmath9 is computed by solving @xmath153 , where @xmath154 is a random number with @xmath155 yields systematically different @xmath134 values .",
    "the results shown here use the tausworthe generator ` taus2 ` @xcite . ] uniformly distributed between @xmath156 and @xmath68 . to examine the range of outcomes ,",
    "@xmath157 random realizations of each model were generated and ranked by central potential @xmath134 ; since particle radii are chosen independently , the central limit theorem implies that @xmath134 has a normal distribution .",
    "shown here are the @xmath158 percentile and @xmath159 percentile members of these ensembles ; half of all random realizations lie between the two examples presented in each figure .",
    "note that these examples deviate from the true potential by fractional amounts of @xmath160 .",
    "obviously , it s impossible to detect discrepancies between @xmath149 and @xmath161 of less than one part in @xmath162 using random realizations with @xmath163 .",
    "it s instructive , not to mention disconcerting , to try reproducing fig .",
    "[ deltaphihj ] using a tree code @xcite instead of direct summation .",
    "tree codes employ approximations which become less accurate for @xmath164 @xcite ; these systematically bias computed potentials and accelerations ( see appendix  b ) . for example , the code which will shortly be used for dynamical tests , run with an opening angle @xmath165 , yields central potentials which are too deep by a few parts in @xmath162 , depending on the system being modeled .",
    "this systematic error can not be ` swept under the carpet ' when comparing computed and predicted potentials at the level of precision attempted here .",
    "constructing equilibrium configurations is an important element of many @xmath0-body experiments .",
    "approximate equilibria may be generated by a variety of ad hoc methods , but the construction of a true equilibrium @xmath0-body model amounts to drawing particle positions and velocities from an equilibrium distribution function @xmath166 .",
    "however , a configuration based on a distribution function ( df ) derived without allowing for softening will _ not _ be in equilibrium if it is simulated with softening .",
    "assume the model to be constructed is spherical and isotropic .",
    "broadly speaking , there are two options : ( a ) adopt a df @xmath167 which depends on the energy @xmath168 , and solve poisson s equation for the gravitational potential , or ( b ) adopt a mass model @xmath169 , and use eddington s ( @xcite ) formula to solve for the df .",
    "if softening is taken into account , option ( a ) becomes somewhat awkward , since the source term for poisson s equation ( [ eq : smooth - poisson ] ) is non - local - body potentials which implements option ( a ) .",
    "on the other hand , option ( b ) is relatively straightforward ( e.g. , * ? ? ?",
    "starting with a desired density profile @xmath118 , the first step is to compute the smoothed density and mass profiles @xmath72 and @xmath120 , respectively .",
    "since @xmath170 everywhere , equation ( [ eq : potential - equation ] ) guarantees that the smoothed potential @xmath121 is a monotonically increasing function of @xmath20 .",
    "it is therefore possible to express the underlying density profile @xmath118 as a function of @xmath121 , and compute the df : @xmath171 note that in @xmath172 , the quantity @xmath169 is the _ underlying _ density , while @xmath173 is the _ smoothed _ potential , related by poisson s equation to the smoothed density @xmath72 . in effect , the smoothed potential @xmath121 is taken as a given , and ( [ eq : eddington - formula ] ) is used to find what will hereafter be called the _ smoothed distribution function _ @xmath174 ; with this df , the underlying profile @xmath118 is in equilibrium in the adopted potential ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "conversely , setting @xmath12 yields the _ self - consistent distribution function _",
    "@xmath175 which describes a self - gravitating model with the underlying profile @xmath118 .    ; dashed , dot - dashed , and dotted curves : @xmath174 for @xmath66 , @xmath107 , and @xmath108 , respectively .",
    "[ dfhj ] ]    to 0.10    ; dashed , dot - dashed , and dotted curves : @xmath174 for @xmath66 , @xmath107 , and @xmath108 , respectively . [ dfhj ] ]    fig .",
    "[ dfhj ] presents dfs for tapered hernquist and jaffe models . in each case",
    "the solid line shows the self - consistent df ; these match the published dfs @xcite over almost the entire energy range , deviating only for @xmath176 where tapering sets in .",
    "smoothed dfs for jaffe models appear very different from their self - consistent counterpart .",
    "the latter has a logarithmic , infinitely deep potential well , which effectively confines material with constant velocity dispersion in a @xmath39 cusp .",
    "the characteristic phase - space density @xmath177 diverges as @xmath46 ( ie , as @xmath178 ) , but only because @xmath179 does . with @xmath164",
    "the potential well is harmonic at small @xmath20 , and ca nt confine a @xmath39 cusp unless the local velocity dispersion scales as @xmath180 ; thus the phase - space density now diverges as @xmath181 .",
    "moreover , the domain of @xmath174 is limited to to @xmath182 , where @xmath183 .",
    "thus , instead of growing exponentially as a function of @xmath184 , the smoothed df abruptly diverges at some finite energy .    by comparison ,",
    "smoothed dfs for hernquist models look similar to the self - consistent df .",
    "the latter has a potential well of finite depth , and the smoothed profiles generate wells which are only slightly shallower . as the left panel of fig .",
    "[ dfhj ] shows , all the dfs asymptote to @xmath185 as @xmath186 . however , the run of velocity dispersion with @xmath20 is different ; the self - consistent model has @xmath187 , implying @xmath188 . in contrast",
    ", the smoothed models have @xmath180 , implying @xmath189 .",
    "one consequence is that the way in which @xmath190 as @xmath186 is different in the smoothed and self - consistent hernquist models .",
    "the self - consistent model has a linear potential as small @xmath20 , and thus @xmath191 . by comparison ,",
    "the models based on smoothed potentials have harmonic cores , and as a result , @xmath192 .",
    "( this difference is not apparent in fig .",
    "[ dfhj ] but becomes obvious when @xmath193 is plotted against @xmath194 . ) in this respect , the use of a smoothed potential effects a non - trivial change on hernquist models : @xmath195 is a different power - law of @xmath196 . coincidentally ,",
    "the smoothed jaffe models have @xmath197 , just like the self - consistent hernquist model .",
    "@xmath0-body simulations are useful to show that the distribution functions just constructed are actually in dynamical equilibrium with their smoothed potentials . for each model and @xmath11 value",
    ", two ensembles of three random realizations were run . in one ensemble ,",
    "the initial conditions were generated using the self - consistent df @xmath175 .",
    "the other ensemble used initial conditions generated from the smoothed df @xmath174 , which allows for the effects of softening .",
    "each realization contained @xmath198 equal - mass particles .",
    "initial particle radii @xmath128 were selected randomly by solving @xmath153 as described above .",
    "initial particle speeds @xmath199 were selected randomly by rejection sampling @xcite from the distributions @xmath200 or @xmath201 , where the former assumes the self - consistent df , and the latter a smoothed df .",
    "position and velocity vectors for particle @xmath9 are obtained by multiplying @xmath128 and @xmath199 by independent unit vectors drawn from an isotropic distribution . in effect , this procedure treats the 6-d distribution function @xmath202 as a probability density , and selects each particle s coordinates independently .",
    "simulations were run using a hierarchical @xmath0-body code .",
    "an opening angle of @xmath165 , together with quadrupole moments , provided forces with median errors @xmath203 .",
    "particles within @xmath204 have much larger force errors , although these seem to have limited effect in practice ( appendix  b ) .",
    "trajectories were integrated using a time - centered leap - frog , with the same time - step @xmath205 for all particles ( see   4.3.1 ) .",
    "all simulations were run to @xmath206 , which is more than sufficient to test initial equilibrium .",
    "-body simulations of hernquist ( top row ) and jaffe ( bottom row ) models , each run with the @xmath11 value labeled .",
    "solid ( dotted ) curves show results for initial conditions generated from smoothed ( self - consistent ) dfs .",
    "light grey bands show expected @xmath207 variation in central potential for @xmath208 independent particles .",
    "[ phievol ] ]    fig .",
    "[ phievol ] shows how the potential well depth @xmath209 of each simulation evolves as a function of time . here",
    ", well depth is estimated by computing the softened gravitational potential @xmath119 of each particle @xmath9 and taking the minimum ( most negative ) value .",
    "( this is more accurate than evaluating the potential at the origin since the center of the system may wander slightly during a dynamical simulation . )",
    "to better display the observed changes in @xmath209 , the horizontal axis is logarithmic in time .",
    "most of the ensembles set up without allowing for softening ( dotted curves in fig .",
    "[ phievol ] ) are clearly not in equilibrium . in all three of the jaffe models ( bottom row ) ,",
    "the potential wells become dramatically shallower on a time - scale comparable to the dynamical time at @xmath210 .",
    "the reason for this is evident .",
    "the self - consistent jaffe model has a central potential diverging like @xmath211 as @xmath46 ; this potential can confine particles with finite velocity dispersion at arbitrarily small radii .",
    "however , the relatively shallow potential well of a smoothed jaffe model can not confine these particles ; they travel outward in a coherent surge and phase - mix at radii of a few @xmath11 .",
    "their outward surge and subsequent fallback accounts for the rapid rise and partial rebound of the central potential .",
    "similar although less pronounced evolution occurs in the hernquist models ( top row ) with @xmath212 and possibly with @xmath213 as well .",
    "only the self - consistent hernquist models run with @xmath214 appear truly close to equilibrium .",
    "in contrast , all of the ensembles set up with smoothed dfs ( solid curves in fig .  [ phievol ] ) are close to dynamical equilibrium . in equilibrium , gravitational potentials fluctuate as individual particles move along their orbits .",
    "if particles are uncorrelated , the amplitude of these fluctuations should be comparable to the amplitude seen in an ensemble of independent realizations . to check this ,",
    "@xmath157 realizations of each model were generated ; central gravitational potentials @xmath209 were evaluated using the same tree algorithm and parameters used for the self - consistent simulations .",
    "the grey horizontal bands show a range of @xmath207 around the average central potential for each model and choice of @xmath11 . some of the simulations set up using smoothed dfs wander slightly beyond the @xmath215 range .",
    "however , none of them exhibit the dramatic evolution seen in the cases set up using self - consistent dfs .     for simulations run with @xmath66 , @xmath107 , and @xmath108 , respectively ; each is displaced downward by one additional unit in @xmath216 for clarity .",
    "[ rhoprofj ] ]    the central potential is relatively insensitive to changes in the mass distribution on scales @xmath217 . to examine small - scale changes directly , density profiles measured from the initial conditions were compared to profiles measured at @xmath218 time units .",
    "these profiles were derived as follows .",
    "first , sph - style interpolation with an adaptive kernel containing @xmath152 particles was used to estimate the density around each particle .",
    "next , the centroid position @xmath219 of the @xmath152 highest - density particles was determined .",
    "finally , a set of nested spherical shells , centered on @xmath219 , were constructed ; each shell was required to contain at least @xmath220 particles and have an outer radius at least @xmath221 times its inner radius .",
    "[ rhoprofj ] summarizes results for jaffe models , which display the most obvious changes .",
    "the density of each shell is plotted against the average distance from @xmath219 of the particles it contains . in each panel ,",
    "the top set of curves compare initial ( @xmath222 ) numerical results with the underlying tapered jaffe model , always represented by a light grey line .",
    "profiles from three independent @xmath0-body realizations of each model are overplotted . while some scatter from realization to realization is seen , the measured densities track the underlying profile throughout the entire range plotted .",
    "the outermost point is at @xmath223 times the radius of the innermost one ; there are not enough particles to obtain measurements at smaller or larger radii .    ranged below the top curves in fig .",
    "[ rhoprofj ] are numerical results at @xmath206 for softening lengths @xmath66 , @xmath107 , and @xmath108 , each shifted downward by one more unit in @xmath216 .",
    "again , profiles from three independent simulations are overplotted to illustrate run - to - run variations .",
    "simulations set up using the self - consistent df ( left panel ) show significant density evolution ; their initial power - law profiles are rapidly replaced by cores of roughly constant density inside @xmath224 .",
    "in contrast , simulations set up using smoothed dfs ( right panel ) follow the initial profile down to @xmath225 ( although density evolution occurs on smaller scales ) .",
    "this shows that a careful set - up procedure can maintain the initial density profile even on scales much smaller than the softening length .",
    "a similar plot for the hernquist models confirms that most of these simulations start close to equilibrium .",
    "hernquist models set up using smoothed dfs do nt appear to evolve at all , although this statement should be qualified since the profiles of these models ca nt be measured reliably on scales much smaller than @xmath226 .",
    "models set up using the self - consistent df and run with @xmath212 undergo some density evolution ; their profiles fall below the underlying hernquist model at @xmath227 , although they continue rising to the innermost point measured .",
    "simulations run with @xmath69 or less display no obvious changes down to scales of @xmath226 .",
    "it appears that the jaffe models set up using smoothed dfs are not _ completely _ free of long - term evolution .",
    "the right - hand panel of fig .",
    "[ rhoprofj ] shows that the peak density as measured using a fixed number of particles falls by roughly an order of magnitude by @xmath206 .",
    "moreover , a close examination of fig .  [ phievol ] turns some cases with a gradual decrease in potential well depth ; in the smoothed jaffe models with @xmath66 , for example , @xmath209 exhibits an upward trend of @xmath228 percent per unit time",
    ". this evolution may not be due to any flaw in the initial conditions ; the central cusps of such models , which are confined by _ very _ shallow harmonic potentials , are fragile and easily disrupted",
    ". there may be more than one mechanism at work here ; the rate of potential evolution appears to be inversely proportional to particle number @xmath0 , while the rate of density evolution is independent of @xmath0 .",
    "a full examination of this matter is beyond the scope of this paper .",
    "selecting the time - step @xmath229 for an @xmath0-body simulation is a non - trivial problem .",
    "while the choice can usually be justified post - hoc by testing for convergence in a series of experiments with different time - steps , it s clearly convenient to be able to estimate an appropriate @xmath229 a priori .",
    "a general rule governing such estimates is that the time - step should be smaller than the shortest dynamical time - scale present in the simulation .",
    "the central density @xmath230 of a smoothed density profile defines one such time - scale . within the nearly constant - density core of a smoothed profile , the local orbital period is @xmath231 ; this is the shortest orbital period anywhere in the system .",
    "numerical tests show the leap - frog integrator is well - behaved if @xmath232 ( conversely , it becomes unstable if @xmath233 ) . among the models simulated here ,",
    "the jaffe model with @xmath214 has the highest smoothed central density ; for this model , @xmath234 . given this density , @xmath235 and @xmath236 .",
    "the time required for a fast - moving particle to cross the core region defines another time - scale .",
    "if @xmath237 is depth of the central potential well , the maximum speed of a bound particle is @xmath238 , and the core crossing time is @xmath239 .",
    "the smoothed jaffe model with @xmath66 has the deepest potential well . for this model ,",
    "tests of the leap - frog with fast - moving particles on radial orbits show that @xmath240 yields good results , but time - steps a few times longer result in poor energy conservation as particles traverse the core region .",
    "( the relationship between @xmath241 and the maximum acceptable time - step @xmath229 may be somewhat model - dependent . )    thus , for the jaffe model with @xmath66 , both the local criterion based on @xmath242 and the global criterion based on @xmath241 yield similar constraints , one can show that @xmath243 for any smoothed jaffe model ; both criteria yield similar constraints almost independent of @xmath11 . for smoothed hernquist models , on the other hand , @xmath244 ;",
    "the constraint based on @xmath241 is generally stricter . ] on @xmath229 .",
    "it s convenient to round @xmath229 down to the next power of two , implying @xmath205 .",
    "this corresponds to @xmath245 , which is somewhat conservative but helps insure that non - equilibrium changes will be accurately followed .    to see",
    "if this time - step is reasonable , realizations of this model were simulated with various values of @xmath229 between @xmath67 to @xmath246 . at the lower end of this range , the effects of an over - large time - step manifest quickly ;",
    "global energy conservation is violated , and the measured central potential @xmath209 drifts upward over time ( even though the initial conditions , generated from @xmath174 , are near equilibrium ) . with a time - step @xmath247 , for example ; the potential well becomes @xmath248  percent shallower during the first two time - steps , and by @xmath249 its depth has decreased by @xmath250  percent .",
    "these simulations also violate global energy conservation , becoming @xmath251  percent less bound by @xmath249 .",
    "integration errors are reduced  but not entirely eliminated  with a time - step @xmath252 ; by @xmath249 , the potential well becomes @xmath253  percent shallower , while total energy changes by @xmath254  percent . with a time - step of @xmath255 or less ,",
    "global energy conservation is essentially perfect , and variations in @xmath209 appear to be driven largely by particle discreteness as opposed to time - step effects .",
    "plots analogous to fig .",
    "[ rhoprofj ] show that the simulations with time - steps as large as @xmath256 reproduce the inner cusps of jaffe models just as well as those with @xmath205 . with this time - step",
    ", individual particles may not be followed accurately , but their aggregate distribution is not obviously incorrect . on the other hand ,",
    "a time - step @xmath247 yields density profiles which fall below the initial curves for @xmath257 .",
    "softening and smoothing are mathematically equivalent . while the particular form of softening adopted in ( [ eq : nbody ] ) corresponds to smoothing with a plummer kernel ( [ eq : plummer - kernel ] ) , other softening prescriptions can also be described in terms of smoothing operations ( e.g. * ? ? ?",
    "there are two conceptual advantages to thinking about softening as a smoothing process transforming the underlying density field @xmath258 to the smoothed density field @xmath259 .",
    "first , since the gravitational potential @xmath260 is related to @xmath259 by poisson s equation , the powerful mathematical machinery of classical potential theory becomes available to analyze potentials in @xmath0-body simulations .",
    "second , focusing attention on smoothing makes the source term for the gravitational field explicit . from this perspective",
    ", smoothing is not a property of the particles , but a separate step introduced to ameliorate @xmath14 singularities in the potential .",
    "particle themselves are points rather than extended objects ; this insures that their trajectories are characteristics of ( [ eq : vlasov ] ) .",
    "plummer smoothing converts @xmath261 power - laws to cores .",
    "at radii @xmath262 the density profile is essentially unchanged , while at @xmath217 the density approaches a constant value equal to the density of the underlying model at @xmath263 times a factor which depends only on @xmath48 .",
    "for the case @xmath52 , this factor is unity and @xmath264 everywhere .",
    "the effects of plummer smoothing on astrophysically - motivated models with power - law cusps , such as the jaffe , hernquist , and nfw profiles , follow for the most part from the results for pure power - laws .",
    "in particular , for @xmath88 , where @xmath59 is the profile s scale radius , the power - law results are essentially ` grafted ' onto the underlying profile . on the other hand , for @xmath87 ,",
    "the inner power - law is erased by smoothing .",
    "smoothing provides a way to predict the potentials obtained in @xmath0-body calculations to an accuracy limited only by @xmath126 fluctuations .",
    "these predictions offer new and powerful tests of @xmath0-body methodology , exposing subtle systematic effects which may be difficult to diagnose by other means .    given an underlying density profile @xmath118",
    ", it s straightforward to construct an isotropic distribution function @xmath174 such that @xmath118 is in equilibrium with the potential generated by its smoothed counterpart @xmath72 .",
    "such distribution functions can be used to generate high - quality equilibrium initial conditions for @xmath0-body simulations ; they should be particularly effective when realized with ` quiet start ' procedures @xcite .",
    "systems with shallow central cusps , such as hernquist and nfw models , may be set up fairly close to equilibrium without taking softening into account as long as @xmath11 is not too large .",
    "however , it appears impossible to set up a good @xmath0-body realization of a jaffe model without allowing for softening .",
    "it s true that realizations so constructed do nt reproduce the actual dynamics of the underlying models at small radii ( * ? ? ?",
    "* footnote 8) ; to obtain an equilibrium , the velocity dispersion is reduced on scales @xmath224 . but realizations set up _ without _ softening preserve neither the dispersion nor the density at small radii , and the initial relaxation of such a system ca nt be calculated a priori but must be simulated numerically . on the whole , it seems better to get the central density profile right on scales @xmath71 , and know how the central velocity dispersion profile has been modified . even if the dynamics are not believable within @xmath131 , the ability to localize mass on such scales may be advantageous in modeling dynamics on larger scales .",
    "mathematica code to tabulate smoothed models is available at + ` http://www.ifa.hawaii.edu/faculty/barnes/research/smoothing/ ` .",
    "i thank jun makino and lars hernquist for useful and encouraging comments , and an anonymous referee for a positive and constructive report .",
    "mathematica rocks .",
    "barnes , j.e .",
    "1998 , ` dynamics of galaxy interactions ' , in _ galaxies : interactions and induced star formation _ ,",
    "d. friedli , l. martinet , & d. pfenniger .",
    "berlin , springer , p. 275394    debattista , v.p . & sellwood , j.a .",
    "2000 , ` constraints from dynamical friction on the dark matter content of barred galaxies ' , apj , * 543 * , 704721",
    "the power - law density and cumulative mass profiles are @xmath265    plummer smoothing converts power laws with @xmath266 to finite - density cores . at @xmath217",
    "the smoothed density is nearly constant and close to the smoothed central density @xmath267 . within this constant - density region ,",
    "the smoothed mass profile is approximately @xmath268 at @xmath262 , on the other hand , smoothing has little effect on the mass profile , so @xmath269 .",
    "interpolating between these functions yields an approximate expression for the smoothed mass profile : @xmath270 where the shape parameter @xmath271 determines how abruptly the transition from one function to the other takes place .",
    "this expression can be rearranged to give @xmath272 the smoothed density profile is obtained by differentiating the mass profile : @xmath273     profile , computed for @xmath32 using ( [ eq : approx - smooth - mass ] ) and ( [ eq : approx - smooth - rho ] ) .",
    "dark curves show results for @xmath274 ; light grey solid curves show errors in density only for @xmath275 ( above ) and @xmath276 ( below ) .",
    "[ errorcusp2 ] ]    to 0.10     profile , computed for @xmath32 using ( [ eq : approx - smooth - mass ] ) and ( [ eq : approx - smooth - rho ] ) .",
    "dark curves show results for @xmath274 ; light grey solid curves show errors in density only for @xmath275 ( above ) and @xmath276 ( below ) .",
    "[ errorcusp2 ] ]    figs .",
    "[ errorcusp1 ] and  [ errorcusp2 ] present tests of these approximations for @xmath31 and  @xmath277 power - laws , respectively . as in figs .",
    "[ cusp1 ] and  [ cusp2 ] , the smoothed density profile was computed with @xmath32 ; for other values of @xmath11 , the entire pattern simply shifts left or right without changing shape or amplitude .",
    "dashed curves show relative errors in smoothed mass , @xmath278 , while solid curves are relative errors in smoothed density @xmath279 .",
    "the @xmath271 value used for each dark curve is the value which minimizes @xmath280 evaluated at points @xmath128 distributed uniformly in @xmath211 between @xmath281 and  @xmath282 . in light grey ,",
    "plots of @xmath283 for two other @xmath271 illustrate the sensitivity to this parameter . comparing these plots",
    ", it appears that the approximation works better for the @xmath31 power - law than it does for @xmath277 , but even in the latter case the maximum error is only @xmath284% .",
    "because ( [ eq : approx - smooth - mass ] ) modifies the underlying mass profile with a multiplicative factor , it can also be used to approximate effects of softening on non - power - law profiles ( e.g. * ? ? ?",
    "* ) ; for this purpose , both @xmath11 and @xmath271 can be treated as free parameters and adjusted to provide a good fit .",
    "the resulting errors in density , which amount to a few percent near the softening scale , are undesirable but do nt appear to seriously compromise @xmath0-body simulations with @xmath285 .      for @xmath84 ,",
    "smoothing primarily modifies the @xmath286 part of these density profiles .",
    "this , together with the exact solution for the case @xmath19 given in ",
    "2.1 , suggests simple approximations for smoothed hernquist and nfw models : @xmath287 fig .",
    "[ errorrhohnfw ] plots the relative error in density , @xmath288 for both models , adopting @xmath289 . for other values of @xmath11 , these errors scale roughly as @xmath290 .    the general behavior of these approximations is readily understood .",
    "overall , @xmath291 is more accurate than @xmath292 since the nfw profile is closer to @xmath31 at all radii . both curves are approximately flat for @xmath217 , then reach minima for @xmath20 between @xmath11 and the profile scale radius @xmath59 .",
    "these minima arise because the smoothed density approaches or even slightly exceeds the underlying density ( see figs .",
    "[ rhoh ] and [ rhonfw ] ) , while ( [ eq : approx - rho - cusp1 ] ) always yields values below the underlying density .",
    "it s sometimes useful to have the cumulative mass for a smoothed profile .",
    "the approximate profiles in ( [ eq : approx - rho - cusp1 ] ) can be integrated analytically , although the resulting expressions are a bit awkward : @xmath293 and @xmath294 note that because the approximate profiles ( [ eq : approx - rho - cusp1 ] ) systematically underestimate the true smoothed densities , these expressions will likewise systematically underestimate the total smoothed mass .    , plotted vs.  radius @xmath20 , for the approximations given in ( [ eq : approx - rho - cusp1 ] ) .",
    "solid and dashed curves show results for hernquist and nfw profiles , respectively , computed for @xmath289 .",
    "[ errorrhohnfw ] ]",
    "tree codes reduce the computational cost of gravitational force calculation by making explicit approximations @xcite .",
    "the long - range potential due to a localized mass distribution @xmath295 with total mass @xmath60 and center of mass position @xmath296 is approximated as @xmath297 where the higher order terms include quadrupole and possibly higher - order moments ( dipole terms vanish because @xmath296 coincides with the center of mass ) . to implement softening ,",
    "this approximation is typically replaced with @xmath298 this works at large distances , but becomes inaccurate if @xmath299 @xcite . moreover , because the error is introduced at the _ monopole _",
    "level @xcite , higher - order corrections do nt repair the damage .    to appreciate the problem , consider a sphere @xmath300 centered on @xmath296 with radius @xmath42 large enough to enclose @xmath295 . for @xmath12 ,",
    "the inward acceleration averaged over the surface of @xmath300 is easily computed using gauss s theorem : @xmath301 in other words , the monopole term is sufficient to calculate the inward acceleration averaged over the surface of @xmath300 _",
    "exactly_.    suppose we want to compute @xmath302 for @xmath164 .",
    "again using gauss s theorem , we have @xmath303 is the smoothed mass within the sphere .",
    "as before , this is an exact equality .",
    "the tree code approximation ( [ eq : approx - pot - soft ] ) implies that the enclosed mass is @xmath304 this is correct if @xmath295 is simply a point mass located at @xmath296 .",
    "but if @xmath295 has finite extent , then the enclosed mass @xmath305 is _ always _ less than @xmath306 . as a result , ( [ eq : approx - pot - soft ] ) will systematically _ overestimate _ the inward acceleration and depth of the potential well due to @xmath295 .",
    "@xcite demonstrate a similar result by computing the softened potential of a homogeneous sphere ; they find @xmath307 is only the first term in a series .    the inequality @xmath308 is easily verified for plummer softening .",
    "an analogous inequality is likely to hold for other smoothing kernels @xmath309 which monotonically decrease with @xmath20 .",
    "smoothing kernels with compact support @xcite may be better behaved in this regard .    under",
    "what conditions are these errors significant ? for ` reasonable ' values of @xmath11 , most dynamically relevant interactions are on ranges @xmath310 where softening has little effect ; these interactions are not compromised since ( [ eq : approx - pot - soft ] ) is nearly correct at long range . only if a significant fraction of a system s mass lies within a region of size @xmath11 can these errors become important .",
    "this situation was not investigated in early tree code tests ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ) , which generally used mass models with cores instead of central cusps , and even heavily softened hernquist models do nt have much mass within one softening radius .",
    "on the other hand , jaffe models pack more mass into small radii ; a jaffe model with @xmath289 has almost @xmath311  percent of its mass within @xmath210 .",
    "jaffe models should be good test configurations for examining treecode softening errors .",
    "tests were run using tapered jaffe and hernquist models , realized using the same parameters ( @xmath109 , @xmath110 , @xmath111 , and @xmath312 ) used in the dynamical experiments (   4.3 ) . in each model , the gravitational field was sampled at @xmath145 points drawn from the same distribution as the mass . at each test point , results from the tree code with opening angle @xmath165 , including quadrupole terms , were compared with the results of an direct - sum code . as expected , the tests with hernquist models showed relatively little trend of force calculation error with @xmath11 ,",
    "although the errors are somewhat larger for @xmath212 than for smaller values . in contrast , the tests with jaffe models reveal a clear relationship between softening length and force calculation accuracy .     for simulations run with @xmath165 and @xmath313 .",
    "light grey , dark grey , and black show potential differences for @xmath66 , @xmath107 , and @xmath108 , respectively ; three independent realizations are plotted in each case .",
    "[ phidiffj ] ]       for simulations run with @xmath165 and @xmath313 .",
    "light grey , dark grey , and black show potential differences for @xmath66 , @xmath107 , and @xmath108 , respectively ; three independent realizations are plotted in each case .",
    "[ phidiffj ] ]      @xmath11 . here",
    "@xmath315 and @xmath316 are accelerations computed using a tree code and direct summation , respectively .",
    "the grey dots represent measurements of @xmath317 for individual test points , computed using @xmath69 .",
    "the pattern of errors suggests two regimes . at radii @xmath318 ( @xmath319 ) ,",
    "the points fall in a ` sawtooth ' pattern which reflects the hierarchical cell structure used in the force calculation . at smaller radii",
    ", on the other hand , the relative error grows more or less monotonically as @xmath46 .",
    "it appears that errors in the large-@xmath20 regime are due to neglect of moments beyond quadrupole order in computing the potentials of individual cells ; conversely , the errors in the small-@xmath20 regime are due to the tree code s inaccurate treatment of softening .",
    "the direction of the error vectors @xmath320 supports this interpretation ; in the large-@xmath20 regime they are isotropically distributed , while in the small-@xmath20 regime they point toward the center of the system .    the jagged line threading through the dots in fig",
    ".  [ accelerrorj ] , constructed by averaging test points in groups of @xmath220 , shows the overall relationship between acceleration error and radius for @xmath69 .",
    "similar curves are also plotted for @xmath212 ( above ) and @xmath66 ( below ) . at large radii ,",
    "all three curves coincide precisely , implying that force errors are independent of @xmath11 . going to smaller @xmath20 ,",
    "the curve for @xmath212 is the first to diverge , rising above the other two , next the curve for @xmath213 begins to rise , tracking the mean distribution of the plotted dots , and finally the curve for @xmath66 parallels the other two .",
    "each curve begins rising monotonically at a radius @xmath321 ; this is evidently where softening errors begin to dominate other errors in the force calculation . at the softening radius @xmath210 ,",
    "all three curves show mean acceleration errors @xmath322 .",
    "are errors of this magnitude dynamically important ?",
    "in particular , could they explain some of the potential evolution seen in the runs set up with softening ( solid curves ) in fig .",
    "[ phievol ] ?",
    "one possible test is to re - run the simulations using smaller @xmath323 values ; decreasing @xmath323 from @xmath324 to @xmath325 or @xmath313 reduces the tree code acceleration error associated with softening by factors of @xmath284 or @xmath248 , respectively ( albeit at significant computational costs ) .",
    "the new runs were started using exactly the same initial conditions as their @xmath165 counterparts .",
    "this initially allows central potentials @xmath326 to be compared between runs to high accuracy , temporarily circumventing the effects of @xmath126 fluctuations .",
    "[ phidiffj ] compares jaffe model results for @xmath165 and @xmath313 .",
    "initially , the potential difference @xmath327 arises because the treecode systematically overestimates the potential well depth by an amount which is greater for larger values of @xmath323 .",
    "as the simulations run , the excess radial acceleration causes systems run with @xmath165 to contract relative to those run with @xmath328 , causing a further increase in potential well depth .",
    "this contraction takes place on a dynamical time - scale at @xmath329 , occurring first for the @xmath66 simulations ( light grey curves ) . at later times ,",
    "as trajectories in otherwise - identical simulations with different @xmath323 values diverge , short - term fluctuations in @xmath209 de - correlate and the dispersion in potential differences increases markedly .",
    "these results show that force - calculation errors can have measurable , albeit modest , effects on dynamical evolution . extrapolating results for a range of @xmath323 values to @xmath330",
    ", it appears that for @xmath165 the _ dynamical _ response of these jaffe models due to excess radial acceleration deepens central potential wells by about @xmath331  percent . to test this extrapolation",
    ", it would be instructive to repeat these experiments with a direct - summation code .",
    "however , compared to the overall range of @xmath209 variations seen in fig .",
    "[ phievol ] , the perturbations due to force calculation errors seem relatively insignificant . in addition , density profiles measured from runs with @xmath332 or @xmath313 appear similar to those shown in fig .",
    "[ rhoprofj ] , again implying that treecode force calculation errors have little effect on the key results of this study .    the best way to correct ( [ eq : approx - pot - soft ] ) for short - range interactions is not obvious . a simple , ad - hoc option is to reduce the effective opening angle on small scales .",
    "for example , accepting cells which satisfy @xmath333 where @xmath334 is the distance to the cell s center of mass , @xmath335 is the cell s size , measured along any edge , and @xmath336 is the distance between the cell s center of mass and its geometric center @xcite , reduces softening - relating treecode errors by a factor of @xmath284 at a modest cost in computing time .",
    "further experiments with similar expressions may produce better compromises between speed and accuracy ."
  ],
  "abstract_text": [
    "<S> in self - consistent @xmath0-body simulations of collisionless systems , gravitational interactions are modified on small scales to remove singularities and simplify the task of numerically integrating the equations of motion . </S>",
    "<S> this ` gravitational softening ' is sometimes presented as an ad - hoc departure from newtonian gravity . however , softening can also be described as a smoothing operation applied to the mass distribution ; the gravitational potential and the smoothed density obey poisson s equation precisely . while ` softening ' and ` smoothing ' are mathematically equivalent descriptions , the latter has some advantages . </S>",
    "<S> for example , the smoothing description suggests a way to set up @xmath0-body initial conditions in almost perfect dynamical equilibrium .    </S>",
    "<S> methods : numerical  galaxies : kinematics & dynamics </S>"
  ]
}