{
  "article_text": [
    "in many branches of science and engineering , one is faced with the problems of dimension reduction and forecasting of high - dimensional time series .",
    "when these time series are generated by ergodic dynamical systems ( or by ergodic components of non - ergodic systems ) , they posses an important special property , namely that long - time averages are equivalent to expectation values with respect to the invariant measure of the dynamics .",
    "this property enables sampling of the full phase space from long time series and sufficiently high - dimensional observables , and data analysis algorithms can be employed to perform dimension reduction and forecasting of these systems with no a priori knowledge of the equations of motion .",
    "this nonparametric approach is useful in a variety of contexts , such as when the equations of motion are unknown or partially known , when the system can not be feasibly simulated , or when the solutions of the equations of motion are complicated and a decomposition into simpler components ( modes ) is desired .",
    "the vast array of methods developed to address these goals can be broadly categorized as state - space or operator - theoretic methods @xcite .",
    "a popular state - space approach is to approximate a nonlinear dynamical system by a collection of local linear models on the tangent planes of the attractor @xcite ; other approaches construct global nonlinear models for the dynamical evolution map @xcite , or nonlinearly project the attractor to lower - dimensional euclidean spaces and construct reduced models operating in those spaces @xcite .",
    "a common element of these techniques is that the forward operators of the reduced models are defined in state space ; i.e. , they map the state at a given time to another state in the future . on the other hand , operator theoretic techniques",
    "@xcite are based on the framework of koopman @xcite , which characterizes a dynamical system through a group ( or semigroup ) of linear operators on the hilbert space associated with the invariant measure of the dynamics .",
    "the koopman operators act on the observables ( functions of the state ) in that hilbert space by shifts along the dynamical flow , giving a representation of a nonlinear dynamical system in terms of naturally linear operators .",
    "similarly , the perron - frobenius operators ( which are the adjoints of the koopman operators ) , describe the action of the dynamical system on probability densities .",
    "data - driven techniques for mode decomposition based on the koopman formalism were first introduced by mezi and banaszuk  @xcite and mezi  @xcite , and further developed by rowley et al .",
    "@xcite , williams et al .",
    "@xcite , and other authors .",
    "these techniques compute approximate koopman eigenvalues and eigenfunctions and their associated spatial patterns ( called koopman modes ) through krylov and other optimization methods applied to sequences of experimentally acquired or simulated snapshots .",
    "the triplets of eigenvalues , eigenfunctions , and modes are then used to decompose a complex spatiotemporal signal into simpler `` building blocks '' , which are intrinsic to the dynamical system generating the data . in particular , the koopman eigenvalues and eigenfunctions are independent of observation modality , meaning that data acquired from different sensors would yield the same results for the eigenvalues and eigenfunctions , so long as the data contain sufficiently rich information . in contrast , the results of covariance based techniques , such as the principal orthogonal decomposition @xcite , and many nonlinear dimension reduction techniques @xcite , depend on the observation modality .    theoretically , a challenge with koopman eigenfunction techniques is that for systems of high complexity ( mixing ) the spectral properties of the koopman operators are not amenable to eigendecomposition .",
    "for instance , a necessary and sufficient condition for a dynamical system to be weak - mixing ( a weak form of chaos , which implies ergodicity ) is that the koopman operators have no eigenfunctions other than the constant function @xcite .",
    "thus , the properties of numerically computed eigenfunctions become difficult to study in this case as they depend on the continuous part of their spectrum , and similar difficulties arise in systems with both continuous spectra and eigenvalues . in fact",
    ", the measure - theoretic properties of systems with pure point spectra and complete bases of koopman eigenfunctions are equivalent to the rather restrictive class of translations on compact abelian groups ( e.g. , irrational flows on tori ) .    recently , berry et al .",
    "@xcite developed a method for nonparametric forecasting which is based on a galerkin approximation of the kolmogorov and fokker - planck operators ( the analogs of the koopman and perron - frobenius operators , respectively , in stochastic systems ) of stochastic dynamical systems on manifolds .",
    "this method utilizes a smooth orthonormal basis of the @xmath0 space associated with the invariant measure , constructed from time - ordered data using the diffusion maps algorithm @xcite with variable - bandwidth kernels @xcite .",
    "this basis is used in conjunction with the shift map of time series to create matrix representations of the kolmogorov and fokker planck operators , which can be used to evolve probability densities through their spectral expansion in the diffusion maps basis . by keeping track of the full density ,",
    "the method forecasts both the expectation value and variance of observables , and is therefore able to perform uncertainty quantification . in @xcite",
    ", it was found that this approach has comparable skill to ensemble forecasts with the perfect model for stochastic systems on the 2-torus and the lorenz 63 system .",
    "however , eigenfunction techniques for dimension reduction and mode decomposition analogous to @xcite were not explored .    in this work , we present data - driven techniques to approximate the spectra of koopman operators based on the galerkin method developed in @xcite , and use the resulting eigenvalues and eigenfunctions for dimension reduction , mode decomposition , and nonparametric forecasting .",
    "we begin by developing this framework for systems with pure point spectra , where the koopman eigenfunctions form a complete orthonormal basis of the @xmath0 space of the dynamical system .",
    "we then consider systems whose koopman operators do not have pure point spectra , including a class of weak mixing systems with no nonconstant eigenfunctions . there",
    ", a regularization technique inspired from the theory of time change in dynamical systems @xcite is developed which attempts to construct a new dynamical system having the same orbits as the original one , but with improved spectral properties for eigendecomposition and forecasting .",
    "we demonstrate these techniques in analytical and numerical applications to ergodic dynamical systems on the 2- and 3-torus , including systems with mixing @xcite and fixed points @xcite .",
    "our contributions can be summarized as follows .",
    "( 1 ) we formulate the galerkin method for the koopman eigenvalue problem in the appropriate @xmath1 sobolev space on the phase space manifold  this is important in systems with dense eigenvalues on the imaginary line , including pure point spectrum systems , as it eliminates eigenfunctions with large dirichlet energy ( roughness ) from the spectrum through tikhonov regularization .",
    "( 2 ) in systems with pure point spectra , we take advantage of a group structure of the eigenfunctions to generate a complete basis of the @xmath0 space on the manifold recursively from the group generators .",
    "this basis is employed to decompose the vector field of the dynamics into a set of linearly - independent , nowhere - vanishing , mutually commuting vector fields ( i.e. , a set of dynamically independent components ) , and to represent the pushforward map carrying along these vector fields in data space for the given observation modality .",
    "the group generators are also used to construct dimension reduction maps from the phase space manifold to the complex plane , under which the dynamical vector field is projectible , and the dynamics in the image spaces are simple harmonic oscillations .",
    "( 3 ) we utilize the eigenvalues and eigenfunctions of the generator in nonparametric statistical forecasting schemes for probability measures and observables .",
    "this approach is closely related to the method developed in @xcite , with the difference that we advance probability densities using the simple harmonic oscillator structure of the koopman eigenfunctions as opposed to taking powers of the discrete perron - frobenius operator . in particular ,",
    "koopman eigenfunctions of pure point spectrum systems evolve as uncoupled oscillators with frequency given by the corresponding eigenvalue , and by completeness , these eigenfunctions can be used to predict the time evolution of arbitrary probability measures and observables .",
    "( 4 ) in systems with mixing , we perform a time - change transformation aiming to improve the spectral properties of the generator using its norm in the ambient data space as the time - change function .",
    "this technique can be applied to arbitrary dynamical systems as it requires no a priori knowledge of the governing equations , and in special cases it recovers a pure point system with the same orbits as the mixing system generating the data .",
    "we generalize our vector field decomposition and nonparametric forecasting techniques to the time - changed framework , where the vector field components in ( 2 ) become non - commuting , and the simple harmonic oscillators in ( 3 ) acquire couplings and time - dependent frequencies .",
    "this paper is organized as follows . in section  [ secergodicity ]",
    ", we lay out our notation and summarize basic results from ergodic theory . in section  [ secpurepointspectra",
    "] , we formulate our dimension reduction , mode decomposition , and forecasting techniques for systems with pure point spectra .",
    "we discuss the numerical implementation of these techniques , including the galerkin method with diffusion regularization for the koopman eigenvalue problem , in section  [ secgalerkinimplementation ] , where we also present numerical applications to variable - speed flows on the 2-torus . in section  [ sectimechange ]",
    ", we formulate our time - change approach for improving the spectral properties of the koopman group , and present applications to mixing dynamical systems on the 3-torus and fixed - point ergodic flows on the 2-torus .",
    "we conclude in section  [ secconclusions ] .",
    "videos showing the temporal evolution of probability densities in the applications of section  [ secgalerkinimplementation ] and  [ sectimechange ] are included as online supplementary material .",
    "we begin by establishing our notation and outlining certain results from ergodic theory which will be useful throughout the paper .",
    "we refer the reader to one of the many books and reviews on ergodic theory ( e.g. , @xcite ) for more detailed expositions of these results .",
    "let @xmath2 be a closed , connected , compact , orientable , smooth ( of class @xmath3 ) , @xmath4-dimensional manifold with a borel @xmath5-algebra @xmath6 . in what follows , @xmath2 will be the phase space of a continuous - time dynamical system with a smooth , invertible evolution map @xmath7 , @xmath8 .",
    "the evolution map induces a map @xmath9 on measures on @xmath10 such that for a measure @xmath11 and @xmath12 , @xmath13 .",
    "we will take @xmath11 to be a @xmath14-invariant probability measure ( i.e. , @xmath15 and @xmath16 ) , characterized by a smooth , positive density relative to local coordinates .",
    "we consider that the dynamical system is observed at a fixed sampling interval @xmath17 through a smooth , vector - valued observation function @xmath18 .",
    "that is , we have a dataset consisting of time - ordered samples @xmath19 in the @xmath20-dimensional data space , with @xmath21    without loss of generality , we assume that @xmath22 is an embedding of @xmath2 into @xmath23 , i.e. , it is one - to - one and its derivative , @xmath24 , has full rank at every @xmath25 . if @xmath22 is not an embedding , then with high probability an embedding can be constructed from @xmath22 using delay - coordinate maps @xcite , and the methods described below can be applied in that space ( e.g. , @xcite ) .",
    "the embedding of @xmath2 into data space induces a smooth riemannian metric tensor @xmath26 on @xmath2 given by pulling back the canonical inner product of @xmath23 , i.e. , @xmath27 for any two tangent vectors @xmath28 .",
    "we denote the riemannian volume form associated with @xmath26 and the corresponding riemannian measure by @xmath29 and @xmath30 , respectively . from our point of view @xmath22 , @xmath26 , and @xmath30 are extrinsic objects to the dynamical system and we would like the results of our dimension reduction and mode decomposition methods to not depend on them .",
    "next , we introduce the koopman group and its generator which will play a central role in our study .",
    "let @xmath31 be the hilbert space of square - integrable , complex valued functions on @xmath2 with inner product @xmath32 and the corresponding norm @xmath33 .",
    "in general , @xmath31 is different from the hilbert space @xmath34 associated with the riemannian inner product @xmath35 , but because @xmath2 is compact the two spaces are isomorphic .",
    "the koopman operator @xmath36 for time @xmath8 is defined via @xmath37 ; that is , the function @xmath38 evaluated at @xmath25 is equal to @xmath39 evaluated at the shifted point @xmath40 along the dynamics , @xmath41 .",
    "the set of koopman operators @xmath42 forms an abelian group under composition of operators , @xmath43 , with @xmath44 acting as the identity element of the group .",
    "these operators are unitary on @xmath31 with @xmath45 , and therefore they induce an isometry , @xmath46 .",
    "the generator of the group , @xmath47 , is a skew - symmetric operator on @xmath31 with @xmath48 , and one of its important properties is the leibniz rule , @xmath49 therefore , @xmath50 is a smooth vector field in @xmath51 giving the directional derivative of functions along the dynamical flow , @xmath52 .",
    "the set of smooth vector fields on @xmath2 forms a lie algebra with the commutator , @xmath53 = u_1 u_2 - u_2 u_1 $ ] with @xmath54 , acting as the algebraic product .",
    "the generator maps to a vector field @xmath55 in the tangent data space , @xmath56 , and because @xmath56 is canonically isomorphic to @xmath23 , we can intuitively think of @xmath57 as a collection of euclidean vectors ( `` arrows '' ) tangent to the data manifold @xmath58 along the direction of the dynamical flow .",
    "note that @xmath57 can be approximated at @xmath59 accuracy by taking finite differences of the time - ordered snapshots @xmath60 @xcite ; e.g. , @xmath61 is an @xmath62 approximation of @xmath57 at @xmath63 . in section  [ secvectorfield ]",
    ", we will represent the pushforward map @xmath64 in a smooth orthonormal basis of @xmath31 , allowing us to reconstruct arbitrary vector fields on @xmath2 , and in particular , the vector field decomposition of the generator .",
    "[ remtime ] in practical applications , the data is acquired at the finite sampling interval @xmath65 , and we can consider the discrete - time system @xmath66 , where @xmath67 and @xmath68 . in the discrete case ,",
    "the koopman group @xmath69 is generated by @xmath70 so that @xmath71 . while some of the constructions discussed below can also be be made using @xmath72 instead of the vector field @xmath50 ( replacing the eigenvalue @xmath73 in   ahead by @xmath74 ) , it is generally more natural to carry out our analysis in the continuous - time setting , and use finite differences for numerical implementation . in particular ,",
    "the discrete - time generator has neither the leibniz property nor the lie algebraic structure of the vector field , and furthermore can not be reconstructed in data space via the pushforward map .",
    "nevertheless , discrete analogs of these properties can be constructed using finite - difference approximations of @xmath75 , as described in section  [ secgalerkin ] .",
    "the diffusion regularization and time - change techniques of sections  [ secgalerkinimplementation ] are  [ sectimechange ] are also more naturally formulated in the continuous - time setting and implemented with finite - difference approximations .",
    "consider now the eigenvalue equation for the generator , @xmath76 because @xmath50 is skew - symmetric on @xmath31 , for any solution to   we have @xmath77 , where @xmath78 is a real number that corresponds to an intrinsic ( i.e. , independent of observation modality ) frequency of the dynamical system .",
    "thus , the set of eigenvalues lies on the imaginary line , and if @xmath73 is the eigenvalue corresponding to the eigenfunction @xmath79 then @xmath80 is also an eigenvalue corresponding to the eigenfunction @xmath81 .",
    "it also follows from the skew - symmetry of @xmath50 that eigenfunctions corresponding to distinct eigenvalues are orthogonal on @xmath82 .",
    "moreover , by the leibniz property in   ( or by unitarity of the @xmath83 ) , it follows that the eigenvalues and eigenfunctions of @xmath50 have a group structure under addition and multiplication , respectively . specifically , if @xmath84 and @xmath85 are eigenfunctions corresponding to the eigenvalues @xmath86 and @xmath87 , respectively , then @xmath88 is also an eigenfunction corresponding to the eigenvalue @xmath89 . because @xmath50 is a directional derivative operator annihilating constant functions , always has the solution @xmath90 , @xmath91 , where @xmath92 denotes here a constant function equal to one @xmath11-a.e .",
    "when other solutions to   are present ( which , as stated in the introduction , is not necessarily the case ) , this group structure is highly beneficial for mode decomposition and forecasting using @xmath73 and @xmath79 .",
    "note that the spectra of the diffusion operators used traditionally for geometrical analysis of data do not have this group structure , but ( on compact manifolds ) these operators are compact and hence guaranteed to have pure point spectra with the associated complete orthonormal eigenfunctions .",
    "one of the classical results in ergodic theory is that certain measure - theoretic properties of dynamical systems can be equivalently expressed as spectral properties of the koopman group .",
    "we now discuss a number of such properties which will be useful in the sequel .",
    "a continuous - time dynamical system @xmath93 is called ergodic iff :    ( metric characterization ) .",
    "all invariant sets or their complements have either zero or full measure , i.e. , @xmath94 with @xmath12 implies @xmath95 or @xmath96 , where @xmath97 can be either of @xmath98 or @xmath99 .",
    "( spectral characterization ) .",
    "@xmath100 is a simple eigenvalue of the generator @xmath50 corresponding to the constant function , i.e. , @xmath101 implies that @xmath39 is @xmath11-a.e .",
    "constant .",
    "the metric and spectral definitions of ergodicity and weak - mixing in the discrete case are analogous to the above but with @xmath14 replaced by @xmath102 , @xmath50 by @xmath72 , @xmath103 by @xmath104 , and @xmath105 by @xmath106 .",
    "hereafter , we will assume that the continuous - time dynamical system under study is ergodic , and that the discrete - time system for the given sampling interval is also ergodic .",
    "it then follows by birkhoff s pointwise ergodic theorem that for @xmath11-a.e .",
    "@xmath25 and for every @xmath107 the temporal means , @xmath108 and @xmath109 in the continuous- and discrete - time cases , respectively , both converge in @xmath31 to the ergodic average @xmath110 . under these assumptions , inner products on @xmath31 and other related sobolev spaces",
    "can be approximated by monte carlo sums of sampled time series , i.e. , given the time series @xmath111 and @xmath112 with @xmath113 and @xmath114 , then for @xmath11-a.e .",
    "@xmath25 we have @xmath115 this property makes the data - driven techniques in sections  [ secgalerkinimplementation ] and  [ sectimechange ] ahead and in @xcite possible .",
    "note that if the dynamical system is not ergodic but preserves @xmath11 , then the monte carlo sum in   will converge to the @xmath0 inner product over the ergodic component associated with the point @xmath116 , and the techniques developed below can be applied for that component provided that the assumptions laid out in the beginning of section  [ secergodicity ] are satisfied .",
    "another important spectral implication of ergodicity is that the eigenfunctions of @xmath50 have @xmath11-a.e .",
    "constant modulus , i.e. , they can be normalized to lie on the unit circle @xmath117 on the complex plane .",
    "this is because @xmath118 is an eigenfunction with eigenvalue 0 ( due to the group structure of the eigenvalues and eigenfunctions ) and therefore a @xmath11-a.e",
    ".  constant function .",
    "[ defweakmixing]a continuous - time dynamical system @xmath93 is called weak - mixing iff :    ( metric characterization ) . for all",
    "@xmath119 we have @xmath120 .",
    "( spectral characterization ) .",
    "@xmath90 is the only eigenvalue of @xmath50 and this eigenvalue is simple .",
    "the weak - mixing property can be thought of as a weak form of chaos , and this condition is always satisfied by mixing systems , i.e. , systems with the property that @xmath121 for all measurable sets @xmath122 .",
    "also , noting that an alternative metric characterization of ergodicity is that @xmath123 , we see that weak - mixing implies ergodicity .",
    "it follows from the spectral theorem for unitary operators on hilbert spaces @xcite that in mixing systems @xmath50 has continuous spectrum ( but no residual spectrum ) .",
    "this observation , as well as the existence of many known ergodic dynamical systems with exotic spectral behavior ( e.g. , @xcite ) raises concerns about the suitability of data - driven eigendecomposition techniques involving the generator in systems of high complexity . in section  [ sectimechange ]",
    ", we will present a regularization scheme based on the theory of time change in dynamical systems that attempts to transform @xmath50 to a generator of a dynamical system which is more amenable to eigendecomposition via numerical methods . for now , however , we restrict attention to systems with pure point spectra where the spectral properties of @xmath50 are `` optimal '' for both dimension reduction and nonparametric forecasting .    a dynamical system @xmath93 is said to have pure point spectrum if there exists an orthonormal basis of @xmath31 consisting of eigenfunctions of the generator .",
    "we say that the spectrum is generated by @xmath124 basic frequencies if there exist @xmath124 rationally independent real numbers @xmath125 such that the eigenvalues in   can be expressed as @xmath126 denoting the eigenfunction corresponding to the eigenvalue @xmath127 by @xmath128 , where we take @xmath129 by convention , the eigenfunction corresponding to eigenvalue @xmath130 is given by @xmath131 .    in systems with pure point spectra ,",
    "every observable @xmath107 has the fourier expansion @xmath132 whenever convenient , we will use the shorthand notation @xmath133 with @xmath134 . note that by virtue of the group structure of the spectrum , one needs to store only the @xmath4 generating eigenfunctions and the corresponding basic frequencies ; the rest of the basis can be generated recursively whenever needed .",
    "the group structure of the eigenfunctions also leads to a useful convolution relationship giving the expansion coefficients of products of functions ( which we do not quote here in the interest of brevity ) .",
    "moreover , applying the decomposition componentwise to the vector - valued observation map @xmath135 we have @xmath136 where the fourier coefficients are now spatial patterns in @xmath23 . in @xcite ,",
    "the vector - valued expansion coefficients are referred to as koopman modes . in section  [ secvectorfield ]",
    ", we will see that these coefficients also arise naturally in the spectral representation of the pushforward map @xmath64 for vector fields .",
    "a classical result in ergodic theory @xcite states that ergodic dynamical systems with pure point spectra are measure - theoretically isomorphic to translations on compact abelian groups equipped with the haar measure .",
    "in particular , for pure point systems realized through diffeomorphisms of smooth manifolds ( which is the case studied here ) , and possessing @xmath4 basic frequencies and the associated smooth eigenfunctions , the phase space manifold must necessarily be the @xmath4-torus , @xmath137 .",
    "pure - point systems can be constructed from diffeomorphisms of more general smooth manifolds , but these systems have discontinuous eigenfunctions @xcite . throughout this paper ,",
    "the case @xmath138 will be the canonical setting where we develop our dimension reduction and forecasting strategies for pure point spectrum systems , as well as for systems with more general spectral properties .",
    "[ remeigdense]the set of frequencies @xmath139 is countable and therefore has zero lebesgue measure on @xmath140 .",
    "however , for @xmath141 , and by rational independence of the @xmath142 , the set of frequencies is dense in @xmath140 .",
    "moreover , the basic frequencies @xmath143 are non - unique as linear combinations of the @xmath142 with nonzero integer coefficients are also rationally independent .",
    "this fact raises the questions of how to select appropriate generators of the spectrum , and how to ensure the good conditioning of approximate generators obtained via finite - dimensional numerical algorithms .",
    "we will address these issues in section  [ secdimensionreduction ] and  [ secgalerkin ] .",
    "our approach for systems with pure point spectra is to construct a family of nonlinear maps @xmath144 of the phase space manifold @xmath2 ( or , equivalently , its diffeomorphic copy @xmath145 in data space ) to the complex plane , using the generating eigenfunctions @xmath146 from definition  [ defnpurepoint ] as dimension - reduction coordinates .",
    "specifically , we set @xmath147 where , by ergodicity , the image @xmath148 lies on the unit circle in @xmath149 .",
    "these projection maps follow the widely adopted paradigm of applied harmonic analysis and machine learning , which is to perform dimension reduction of data on nonlinear manifolds using eigenfunctions of linear operators on function spaces on these manifolds @xcite . while these methods are typically based on eigenfunctions of diffusion operators or heat kernels , in this case we use eigenfunctions of a skew - symmetric operator intrinsic to the dynamical system generating the data , namely the generator of the koopman group .",
    "we will formulate algorithms for approximating these eigenfunctions from data in section  [ secgalerkin ] .",
    "for now , we discuss the main features of dimension reduction with eigenfunctions of the generator of the koopman group , which follow from basic results of ergodic theory and maps of manifolds . in",
    "what follows , we use the notation @xmath150 for general local coordinates defined in a neighborhood of @xmath25 .",
    "moreover , we denote the corresponding coordinate basis vectors of @xmath151 and their duals by @xmath152 and @xmath153 , respectively , where @xmath154 . in this coordinate system , we have the expansion @xmath155 for the generator , and @xmath156 .",
    "first , the eigenfunctions of @xmath50 are intrinsic to the dynamical system @xmath93 , and in particular do not depend on the observation map @xmath22 and its associated riemannian metric and volume form . as stated in remark  [ remeigdense ] , the generating eigenfunctions and the corresponding basic frequencies are non - unique , but given any two observation maps it is possible to find generating eigenfunctions such that the corresponding projection maps from   are consistent .",
    "this means that the @xmath157 provide a unified space to parameterize data acquired from different sensors ( different choices of @xmath22 ) , but generated by the same dynamical system .",
    "this property has several data analysis applications ( which we do not study here ) , such as fusion and inference of data acquired from different sensors and from potentially distinct states in @xmath2 .    in the setting of a single observation modality",
    ", we choose the generating eigenfunctions with the least oscillatory behavior in the riemannian metric @xmath26 associated with the observation map .",
    "a natural measure to quantify this behavior for a function @xmath39 is the dirichlet energy , @xmath158 , where @xmath159 is the gradient operator associated with @xmath26 and @xmath160 the @xmath0 norm for vector fields",
    ". we will provide more precise definitions for the gradient operator and related hilbert space notions in section  [ secgalerkinprelim ] , but for now it suffices to note that the set of dirichlet energies @xmath161 of the eigenfunctions is discrete in @xmath140 , and therefore a finite collection of eigenfunctions can be stably ordered in order of increasing @xmath162 .",
    "intuitively , we expect that functions with small dirichlet energy can be more accurately approximated from finite datasets than highly oscillatory functions , so our selection criterion for the generating eigenfunctions is to set @xmath163 to the first @xmath4 eigenfunctions in that ordering corresponding to rationally independent frequencies .",
    "we adopt this selection criterion throughout the paper , and discuss its numerical implementation in section  [ secgalerkin ] . in general , the generating eigenfunctions selected in this way will not always agree among different observation modalities , but our selection criterion exhibits some rigidity in the sense that there exist equivalence classes of observation modalities for which the selected generating eigenfunctions and generating frequencies are the same .",
    "further useful properties of the koopman eigenfunctions pertain to the dynamics in the image space from  .",
    "the vector field @xmath50 is projectible under @xmath157 in the sense that for any @xmath164 such that @xmath165 , the equality @xmath166 holds , where @xmath167 is the derivative map of @xmath157 , mapping tangent vectors on @xmath2 to tangent vectors on @xmath149 .",
    "let @xmath168 be the canonical basis of @xmath149 .",
    "this basis can be canonically identified with a basis of @xmath169 so that @xmath170 , where @xmath171 because @xmath172 , we have @xmath173 whenever @xmath165 . in particular , note that @xmath174 and @xmath175 .    that @xmath50 is projectible under @xmath157 is a non - trivial property which is not satisfied by general manifold submersions , and ensures that the time evolution of the data in the image spaces @xmath148 can be described by means of autonomous deterministic dynamical systems , avoiding closure issues .",
    "in this particular case , it is straightforward to check that the projected dynamics are simple harmonic oscillations with frequency @xmath142 .",
    "specifically , introducing the time series @xmath176 we have the ordinary differential equation @xmath177 with the solution @xmath178 it follows from   that the image @xmath179 under each of the projection maps @xmath157 is the full unit circle . recalling that the @xmath142 are rationally independent",
    ", we see that for our canonical case , @xmath138 , the composite map @xmath180 with @xmath181 induces a diffeomorphism of the torus , mapping the original flow ( which can have variable speed ; see section  [ sectorus ] ahead ) to the irrational flow generated by the basic frequencies @xmath143 on @xmath182 .",
    "so far , we have constructed a family of projection maps taking the dynamical vector field @xmath50 on @xmath2 to the vector fields @xmath183 on the circle generating simple harmonic oscillations .",
    "however , given the @xmath183 it is generally not possible to perform the reverse operation and pull them back on @xmath2 . in this section",
    ", we construct a decomposition of @xmath50 into a sum of vector fields which are mutually commuting , and describe `` simpler '' ( but non - ergodic ) dynamics than @xmath50 in that they have non - trivial nullspaces .",
    "[ lemmavdecomp ] let @xmath184 be the linear operator defined through its action on the eigenfunction basis from definition  [ defnpurepoint ] : @xmath185    \\(i ) @xmath186 is a vector field on @xmath2 with nullspace @xmath187 , where @xmath188 are the orthogonal subrings of @xmath31 generated by @xmath189 .",
    "\\(ii ) at every @xmath25 , the @xmath186 are non - vanishing , linearly independent , and have vanishing commutator , @xmath190 = v_i v_j - v_j v_i = 0 $ ] .",
    "\\(iii ) the transformations @xmath191 generated by @xmath186 preserve the invariant measure of the full dynamics .",
    "\\(iv ) the decomposition @xmath192 holds .    to prove that @xmath186 is a vector field , it suffices to show that it obeys the leibniz rule for all @xmath193 , and we will verify that this is the case by direct computation . introducing the multi - indices @xmath194 and @xmath195 with @xmath196 , we have @xmath197 , @xmath198 , and @xmath199 , where @xmath200 and @xmath201",
    ". therefore , @xmath202 , @xmath203 , and @xmath204 the leibniz rule follows directly from the last three equations .",
    "moreover , that @xmath187 follows by noting that @xmath39 in this subspace has the expansion coefficients with @xmath205 for all @xmath206 , and therefore @xmath207 .",
    "this proves part ( i ) of the lemma .",
    "the linear independence of @xmath186 in part  ( ii ) can be checked by noticing that @xmath208 for all @xmath209 , but @xmath210 is nowhere - vanishing on @xmath2 .",
    "thus , @xmath211 can not be expressed as a linear combination of @xmath212 . repeating this argument for all @xmath213 leads to the desired result .",
    "to establish commutativity of the @xmath186 , we use again the decomposition for @xmath214 and compute @xmath215 .",
    "this expression is invariant under permutations of @xmath216 and @xmath217 , leading to @xmath190 f_1 = 0 $ ] and completing the proof of part  ( ii ) .    turning to part  ( iii )",
    ", we first note that starting from any @xmath25 we can follow the integral curves of the @xmath186 for an arbitrary time @xmath8 , and therefore we can construct the flows @xmath218 in the statement of the lemma .",
    "then , a necessary and sufficient condition that these flows are measure preserving is that the functions @xmath219 vanish everywhere on @xmath2 , where @xmath220 is the divergence operator on vector fields associated with the invariant measure @xmath11 ( see   for an expression in local coordinates ) .",
    "the adjoint of @xmath220 is the negative gradient with respect to the ambient space metric @xmath26 , and for any eigenfunction @xmath221 we have @xmath222 where the last equality holds because @xmath223 if @xmath221 is constant , and @xmath224 vanishes if @xmath221 is nonconstant by ergodicity . therefore , @xmath219 vanishes everywhere since it is orthogonal to every element in a complete basis of @xmath31 .    finally , we verify the decomposition in part  ( iv ) by operating with @xmath50 on the function @xmath214 using the leibniz rule , viz .",
    "@xmath225    the vanishing commutator of the @xmath186 from lemma  [ lemmavdecomp ] is an intrinsic ( observation map independent ) dynamical independence property .",
    "this property can also be seen by considering local coordinates @xmath226 constructed through the canonical angle coordinates of the circles @xmath148 from the projection maps in  . in these coordinates",
    ", we have @xmath227 , and the full vector field , @xmath228 , is decomposed into manifestly independent components .",
    "this decomposition has connections with the nonlinear independent component analysis technique of singer and coifman @xcite , which recovers independent components of stochastic differential equations on manifolds using kernel methods . globally on @xmath2 ,",
    "the @xmath186 generate measure - preserving , but non - ergodic , transformations @xmath218 ( together with associated koopman operators ) , giving the full evolution map through the composition @xmath229 , where the order of the components does not matter .",
    "the vector fields @xmath186 are intrinsically defined as differential operators on @xmath2 , and to reconstruct them in data space @xmath23 we apply the pushforward map for tangent vectors introduced in section  [ secergodicity ] .",
    "[ proppushforward ] let @xmath230 be a smooth vector field on @xmath2 , and let @xmath22 be a smooth embedding of @xmath2 into @xmath23 .",
    "then , the image @xmath231 under the pushforward map @xmath232 is given by @xmath233 , where @xmath230 acts on @xmath22 componentwise in a basis of @xmath23 .",
    "let @xmath234 be a basis of @xmath23 ( not necessarily orthonormal ) .",
    "this basis induces a basis of the tangent space @xmath235 at every @xmath236 through the canonical isomorphism @xmath237 , and we have @xmath238 . denoting the components of @xmath230 in local",
    "coordinates @xmath150 on @xmath2 by @xmath239 , for any smooth function @xmath39 we have @xmath240 . in particular , expanding the observation map in the @xmath241 basis , @xmath242 , and using the transformation law for tangent vectors on manifolds , we obtain @xmath243 and therefore @xmath233 .",
    "using proposition  [ proppushforward ] and the fourier expansion of the observation map in  , we compute the reconstructed vector fields @xmath244 where the last equality follows by linearity .",
    "note that @xmath57 can also be approximated from finite differences of time - ordered data as described in section  [ secergodicity ] , but the the components @xmath245 in general can not .",
    "in applications , the @xmath245 can be visualized as spatiotemporal patterns ( movies ) , or if @xmath20 is sufficiently small , as arrow plots on the data manifold @xmath58 .",
    "note that because @xmath64 is a linear map between linear spaces ( even if @xmath22 is nonlinear ) , the @xmath245 are guaranteed to be tangent vector fields to the data manifold ( modulo numerical errors ) . on the other hand , reconstructions of the data by filtered patterns of the form @xmath246 , where @xmath247 is some index set , will generally not lie on @xmath58 .",
    "the availability of the vector fields @xmath245 should help improve the scientific understanding of the operating dynamics underlying high - dimensional time series by decomposing the generator into simpler independent components .",
    "this approach may also have applications in operator splitting techniques ; i.e. , it is possible to decompose the full vector field in data space as @xmath248 and integrate independent dynamical systems for each @xmath245 ( which are guaranteed to remain on the attractor ) .",
    "the availability of the closed form solution in   for the temporal evolution of the koopman eigenfunctions in systems with pure point spectra , together with the fact that they form a complete basis of @xmath31 , makes these eigenfunctions well suited for data - driven nonparametric forecasting . in this section ,",
    "we formulate a technique for forecasting probability densities and expectation values of observables with initial data specified as a probability measure .",
    "our approach follows closely the nonparametric framework developed in @xcite , with the difference that here we use the additional structure in the temporal evolution of the eigenfunctions .",
    "consider the initial data given as a probability measure @xmath249 on @xmath250 with a smooth probability density @xmath251 relative to the invariant measure @xmath11 .",
    "the measure @xmath249 evolves at time @xmath252 according to @xmath253 , and the corresponding density is given by @xmath254 , where @xmath255 is the peron - frobenius operator , i.e. , the adjoint of the koopman operator on @xmath31 .",
    "thus , for an initial density with fourier expansion @xmath256 , where @xmath257 , we have @xmath258 note that the expansion coefficients form the @xmath259 sequence @xmath260 , and we can write the formal solution @xmath261 where @xmath78 is the diagonal operator on @xmath259 such that @xmath262    next , to compute the expectation value @xmath263 of an observable @xmath107 with respect to @xmath264 , we make use of the fact that @xmath265 this leads to the expression @xmath266 where @xmath267 are the expansion coefficients of @xmath39 in the eigenfunction basis . evaluating the mean square forecast @xmath268 using a similar approach ( or the convolution identity mentioned in section  [ secergodicity ] ) , we obtain the variance forecast @xmath269 which is useful for uncertainty quantification .",
    "forecasting with the koopman eigenfunctions can also be performed with initial data given as a single observation @xmath270 in the ambient data space @xmath23 . in this case , we first compute values @xmath271 for the @xmath4 generating eigenfunctions at the point @xmath25 with @xmath272 using out - of - sample extension techniques for functions ( e.g. , @xcite ) , and then evolve the initial values @xmath273 via  .",
    "we then determine the value of other eigenfunctions using their group structure , and reconstruct the observable through its expansion coefficients and the eigenfunction values at the desired lead time .",
    "note that if @xmath58 is the data manifold from an imperfect model with model error , then @xmath270 may not lie on @xmath58 , but extended function values can also be computed in this case .",
    "this approach is closely related to to a kernel analog forecasting framework developed in @xcite . in numerical experiments",
    "not reported here , we have observed comparable skill with this method and the statistical forecast results of section  [ sectorus ] .",
    "we demonstrate the techniques presented in sections  [ secdimensionreduction][secforecasting ] in an analytically solvable example involving an irrational flow on the 2-torus . denoting the azimuthal and polar angles on the 2-torus by @xmath274 , respectively , we consider the dynamical vector field on @xmath275 given by @xmath276 where @xmath277 is a positive angular frequency parameter which is set to an irrational number to produce an ergodic flow .",
    "this dynamical system is observed through the observation map @xmath278 corresponding to the standard embedding of the 2-torus into three - dimensional euclidean space , i.e. , for the point @xmath25 with coordinates @xmath274 , we have @xmath279 , where @xmath280 the equilibrium measure of this system has uniform density relative to the haar ( planar ) measure @xmath11 , where @xmath281 .",
    "moreover , the eigenvalue problem for @xmath50 in   has solutions @xmath282 and @xmath283 , with @xmath284 , @xmath285 .    to select generating eigenfunctions @xmath286 with low roughness on the torus and their corresponding basic frequencies @xmath287 , we compute the dirichlet energy of the eigenfunctions in the induced riemannian geometry from the observation map as described in section  [ secdimensionreduction ] . for the embedding in  , the induced riemannian metric has components @xmath288 , @xmath289 , and @xmath290 in the @xmath291 coordinates , leading to the dirichlet energy values @xmath292 , where @xmath293 and @xmath294 .",
    "thus , in this geometry , the least - rough eigenfunctions corresponding to rationally independent frequencies are those with @xmath295 and @xmath296 , i.e. , we have @xmath297 , @xmath298 , @xmath299 , and @xmath300 . clearly , the image of the torus under each of the projection maps from   is the unit circle , @xmath301 , and the system evolves in these coordinates as a simple harmonic oscillator in accordance with  .",
    "[ remoscillatory ] for every eigenfunction @xmath221 corresponding to the eigenvalue @xmath130 , there exist eigenfunctions with eigenvalues arbitrarily close to @xmath130 and with arbitrarily large dirichlet energy .",
    "this is a consequence of the density of the spectrum of @xmath50 on the real line ( see remark  [ remeigdense ] ) .",
    "for instance , the eigenvalue and dirichlet energy of the constant eigenfunction are both zero , but for any @xmath302 we can find integers @xmath216 and @xmath217 such that for @xmath303 , @xmath304 and @xmath305 .",
    "this behavior is generic , and can adversely affect the conditioning of numerical schemes for koopman eigenvalues and eigenfunctions . in section  [ secgalerkin ] , we will suppress the pathological modes with large @xmath162 by adding a small amount of diffusion to @xmath50 .",
    "next , we reconstruct the vector fields @xmath186 from lemma  [ lemmavdecomp ] associated with the generating eigenfunctions @xmath306 using the spectral expansion of @xmath307 in the @xmath308 basis in accordance with  .",
    "setting @xmath309 , the expansion coefficients are @xmath310 giving @xmath311 with @xmath312 and @xmath313 this decomposition is depicted in fig .",
    "[ figirrationalv ] .",
    "decomposition of the vector field of an irrational flow on the torus into mutually commuting components .",
    "( a ) full vector field ; ( b , c ) the components @xmath314 from lemma  [ lemmavdecomp ] , reconstructed in @xmath315 using the pushforward map from  . ]    consider now statistical forecasting of the irrational - flow system using the nonparametric approach of section  [ secforecasting ] . in this example , we set the initial probability measure @xmath249 to a von mises ( circular gaussian ) distribution on the torus with the density function @xmath316 relative to the equilibrium measure . in  , @xmath317 is the modified bessel function of order @xmath318 , and we use the values @xmath319 and @xmath320 for the location and concentration parameters , respectively .",
    "we take the component @xmath321 of the observation map as the forecast observable @xmath39 , and compute the time - dependent expectation value and standard deviation of @xmath39 using  .",
    "the latter equation can be evaluated analytically using properties of bessel functions and the expansion of @xmath321 in the eigenfunction basis . in particular , using the result @xmath322 , we find @xmath323.\\end{aligned}\\ ] ] the time evolution of @xmath324 and the standard deviation @xmath325 are shown in fig  [ figirrationalforecast ]",
    ".    statistical forecast of the component @xmath326 of the torus embedding in  @xmath315 for the irrational flow with frequencies @xmath327 .",
    "the initial probability measure has the circular gaussian density from   relative to the haar measure with location and concentration parameters @xmath328 and 30 , respectively .",
    "( a ) mean forecast ; ( b ) standard deviation . ]",
    "in this section , we present a galerkin method with regularization for the eigenvalue problem of the generator in an orthonormal basis acquired through the diffusion maps algorithm .",
    "our approach follows closely @xcite , with the difference that we work in the sobolev space @xmath329 appropriate for the weak formulation of the regularized eigenvalue problem ( as opposed to the @xmath31 space employed in @xcite ) .",
    "we also discuss the spectral properties of the regularized operator , including its asymptotic behavior in the weak - diffusion limit  this discussion will also motivate the time - change techniques of section  [ sectimechange ] .",
    "we then describe the implementation of the techniques of section  [ secpurepointspectra ] in the approximate eigenfunction basis acquired via the galerkin scheme , and present numerical applications to a variable - speed ergodic flow on the 2-torus .",
    "let @xmath5 be the @xmath3 density of the invariant measure of the dynamics relative to the riemannian measure inherited from data space ; i.e. , @xmath330 , where @xmath5 is positive and bounded away from zero by compactness of @xmath2 . for data generated by ergodic dynamical systems , @xmath5 is also the sampling density relative to the riemannian measure , though the samples collected from a single time series ( as is the case in  ) are not independent . in general , @xmath5 will be a nonconstant function , and in what follows we work with the conformally transformed metric @xmath331 .",
    "this metric has uniform volume form relative to the invariant measure since @xmath332 .",
    "moreover , @xmath333 can be accessed from data by kernel algorithms as described in section  [ secdatadrivenbasis ] .",
    "associated with this metric is the hilbert space @xmath334 of square - integrable vector fields on @xmath2 ( e.g. , @xcite ) with norm @xmath335 and inner product @xmath336 .",
    "the gradient of a function @xmath337 with respect to @xmath333 is the vector field @xmath338 , where @xmath339 is the covariant derivative associated with @xmath333 having the property @xmath340 , and @xmath341 is the `` inverse metric '' acting on dual vectors .",
    "the divergence operator , @xmath342 , is characterized by the relation @xmath343 for @xmath344 and @xmath345 .",
    "thus , the divergence is the negative of the formal adjoint of the gradient , and as it turns out it depends on @xmath11 and not on @xmath333 ( even if we had @xmath346 ) . in local coordinates",
    ", we have @xmath347 , @xmath348 , and @xmath349    with these definitions , the sobolev space @xmath350 ( henceforth abbreviated as @xmath351 since @xmath352 ) is the hilbert space completion of @xmath353 with respect to the inner product @xmath354 .",
    "similarly , we define @xmath355 through the hilbert space completion of @xmath51 with respect to @xmath356 . in this hilbert space",
    "setting we have @xmath357 , where @xmath220 and @xmath358 are understood as appropriate extensions of the corresponding operators on smooth vector fields and functions , respectively .",
    "moreover , we define the dirichlet energy of functions in @xmath350 as the positive semidefinite functional @xmath359 this functional provides a metric - dependent measure of roughness of functions which can be used to select generators for the spectrum of the koopman group as described in section  [ secdimensionreduction ] .",
    "[ remincompressibility ] the generator @xmath50 of the koopman group is divergence - free , @xmath360 , with respect to the invariant measure of the dynamics .",
    "this property is equivalent to the fact that @xmath14 is @xmath11-preserving , and can be verified using similar arguments as in the proof of part ( iii ) of lemma  [ lemmavdecomp ] .",
    "next , consider the laplace - beltrami operator @xmath361 associated with the riemannian metric @xmath333 .",
    "this operator is positive - semidefinite and self - adjoint on @xmath31 , and there exists an orthonormal basis @xmath362 consisting of the eigenfunctions @xmath363 with the corresponding eigenvalues @xmath364 .",
    "note that while the inner product of @xmath31 is metric - tensor - independent , the gradient operator , and hence @xmath365 , @xmath366 , and @xmath367 , all depend on @xmath333 .",
    "moreover , the eigenfunctions are orthogonal on @xmath351 with @xmath368 , but because @xmath369 exhibits unbounded growth as @xmath370 , functions of the form @xmath371 with @xmath372 are not necessarily in @xmath373 . on the other hand , the rescaled eigenfunctions @xmath374 with @xmath375 for @xmath376 and @xmath377 ,",
    "are orthogonal ( but not orthonormal ) on @xmath378 and have bounded @xmath1 norm , @xmath379 .",
    "therefore , @xmath380 is an orthogonal basis of @xmath373 with the property that every sequence @xmath372 corresponds to a function @xmath381 .",
    "moreover , the dirichlet energies of the basis elements are all equal to one for @xmath382 . due to this property",
    ", @xmath383 will be our basis of choice for a well - conditioned galerkin method for the eigenvalue problem of the koopman generator .",
    "we also note that because @xmath384 and @xmath385 for @xmath386 , the dirichlet energy from   can be conveniently computed from the @xmath259 norm of the expansion coefficients with @xmath387 , i.e. , @xmath388    in @xcite , an orthonormal basis of @xmath31 is constructed using eigenfunctions of the weighted laplacian @xcite , @xmath389 , associated with the invariant measure of the dynamics and the ambient - space metric @xmath26 .",
    "this operator is the generator of a gradient flow on the riemannian manifold @xmath390 with potential @xmath391 , and is also self - adjoint on @xmath31 .",
    "eigenfunctions of @xmath392 can be computed using variable - bandwidth kernels or the canonical formulation of diffusion maps with radial gaussian kernels and the `` @xmath393 '' normalization @xcite .",
    "our galerkin scheme can be applied using eigenfunctions from either of the three approaches , though in practice we find that variable - bandwidth techniques behave more stably in applications with large variations of the sampling density @xmath5 ( including the applications discussed in this paper ) .      to approximate the basis in   from data , we start from the variable - bandwidth kernel @xmath394 given by @xcite @xmath395 where @xmath396 is a positive bandwidth parameter , @xmath397 is a function approximating the sampling density @xmath5 at @xmath398 accuracy , and @xmath4 is the dimension of @xmath2 .",
    "the function @xmath397 can be computed using any suitable density - estimation technique , and in what follows we employ the kernel method described in @xcite .",
    "this method uses an updated formulation of an automatic bandwidth - selection procedure originally developed in @xcite , and also provides an estimate of @xmath4 .",
    "alternatively , @xmath4 can be estimated using one of the dimension estimation techniques available in the literature ( e.g. , @xcite ) .",
    "in the numerical experiments that follow we use a priori known values for @xmath4 , though the estimates from the bandwidth selection algorithm are in good agreement with the true values .",
    "let @xmath399 be the sampling density of the data relative to the invariant measure @xmath11 . throughout this section",
    "we consider that the sampling measure is equal to the invariant measure so that @xmath400 , but we carry out our analysis in the more general setting with nonuniform @xmath399 in anticipation of the time - change techniques of section  [ sectimechange ] .",
    "using the same method to tune the kernel bandwidth parameter as in the density - estimation step , we perform the normalizations originally introduced in diffusion maps @xcite and further developed in @xcite to construct from the kernel in   an integral operator @xmath401 approximating the heat operator on the riemannian manifold @xmath402 .",
    "specifically , we compute the action of @xmath403 on a function @xmath107 through the operations , @xmath404 the operator @xmath403 preserves constant functions ( i.e. , it is an averaging operator with @xmath405 ) , and we have @xmath406 for the markov kernel @xmath407 the role of the normalizations in   is to remove biases due to curvature in @xmath333 and the potentially nonuniform sampling density . in particular , taking taylor expansions of @xmath403 about @xmath408 ( e.g. , @xcite ) , one can show that uniformly on @xmath2 , and independently of @xmath399 , @xmath409 for a constant @xmath410 , so that @xmath403 can be used to approximate the desired eigenfunctions in   even when @xmath399 is nonuniform .    because the markov kernel @xmath411 can be nonsymmetric , @xmath403 is generally not self - adjoint on @xmath31 .",
    "instead , @xmath403 is self - adjoint on the space @xmath412 , where @xmath413 specifically , we have @xmath414 and the self - adjointness of @xmath403 on @xmath412 follows from the fact that the kernel @xmath415 is symmetric . also , it is straightforward to verify that the density @xmath416 is the eigenvector of the adjoint operator @xmath417 on @xmath31 corresponding to eigenvalue 1 ; i.e. , @xmath416 is the invariant density relative to @xmath11 for a discrete - time diffusion process on @xmath2 generated by @xmath411 @xcite .",
    "note that @xmath418 and the eigenfunctions of @xmath403 are orthogonal on @xmath31 at @xmath398 . in the algorithms described below",
    ", we find that including a discrete analog of @xmath416 in inner products involving eigenfunctions from diffusion maps leads to a moderate increase in performance .",
    "turning to the discrete setting , we represent functions on the dataset consisting of the ergodic time series in   by @xmath419-dimensional vectors @xmath420 with components @xmath421 , and the integral operator @xmath403 by an @xmath422 markov matrix @xmath423 such that @xmath424 approximates @xmath425 .",
    "in the presence of nonuniform sampling , sums of the form @xmath426 converge to the integrals @xmath427 @xcite .",
    "therefore , up to unimportant proportionality constants , we approximate @xmath428 and @xmath429 by @xmath430 and @xmath431 , respectively , where @xmath432 , and @xmath433 .",
    "the matrix elements of @xmath423 are then given by @xmath434 .",
    "the leading left eigenvector of @xmath423 , @xmath435 , has elements @xmath436 approximating ( up to a proportionality constant ) the continuous function @xmath437 .",
    "therefore , the weighted inner product @xmath438 converges to @xmath439 as @xmath440 , and moreover @xmath441 converges to the ergodic inner product @xmath442 as @xmath443 .",
    "the limit @xmath440 and @xmath443 with an appropriate scaling relationship @xmath444 corresponds to the limit of large data @xcite .    with these ingredients ,",
    "we approximate the eigenvalues and eigenfunctions of @xmath365 in   using the corresponding eigenvalues and eigenvectors of @xmath423 , @xmath445 and in the limit of large data we have @xmath446 and @xmath447 up to proportionality constants . by convention",
    ", we will work with the normalized eigenvalues @xmath448 .",
    "geometrically , this scaling is equivalent to a uniform scaling of the riemannian metric @xmath333 , which has no influence on the spectrum of @xmath365 other than an unimportant global scaling of the eigenvalues .",
    "the discrete eigenvectors from   form an orthonormal basis for functions @xmath449 on the dataset with respect to the inner product in  , and we have @xmath450 with @xmath451 . this inner product is asymptotically equivalent as @xmath443 to the uniformly - weighted ergodic sum from  , but as mentioned earlier , in practice we find that the mode decomposition and forecasting algorithms presented below exhibit moderate performance gains by including the weights in @xmath452 .",
    "the analog of the dirichlet energy in   for the discrete eigenfunctions is @xmath453 ( whenever @xmath454 ) , and for the function @xmath449 above we have @xmath455 .",
    "again , @xmath456 converges to its continuous counterpart , @xmath457 , in the limit of large data and up to a proportionality constant .",
    "hereafter , whenever there is no risk of confusion with the continuous case we will omit hats and overarrows in our notation for quantities computed for the discrete dataset , such as @xmath458 and @xmath459 .",
    "the construction of our data - driven orthonormal basis of @xmath31 is summarized in algorithm  [ algbasis ] .",
    "this algorithm also includes a summary of the kernel density estimation and bandwidth - parameter tuning procedures .",
    "these procedures require a set @xmath460 of candidate bandwidth parameters and a nearest - neighbor truncation parameter @xmath461 as additional inputs ; see @xcite for complete descriptions .",
    "we note that the content of algorithm  [ algbasis ] and the other algorithms in the paper are intended to be at a conceptual level , and some of the steps would be implemented differently in practice to ensure efficiency .",
    "in particular , in applications with @xmath462 , we can truncate @xmath423 to @xmath463 nearest neighbors ( incurring small loss of accuracy due to exponential decay of @xmath464 ) . also , it is customary for efficiency and stability to obtain the eigenvalues and eigenvectors of @xmath423 from the eigenproblem for the symmetric matrix @xmath465 , where @xmath466 is an @xmath422 diagonal matrix with @xmath467 .",
    "the eigenfunctions of @xmath423 and the inner product weights @xmath468 can be computed from the eigenvectors of @xmath469 through the relationships in the last step of algorithm  [ algbasis ] .",
    "we refer the reader to @xcite for further details on the numerical implementation and error estimates for this class of kernel algorithms .",
    "[ algbasis ]     * inputs * * observed time series @xmath470 , @xmath471 , at sampling interval @xmath65 * * candidate bandwidth parameter values @xmath460 with @xmath472 * * number of nearest neighbors @xmath461 for kernel density estimation * * manifold dimension @xmath4 * * desired number of eigenvalues and eigenfunctions @xmath318 * outputs * * sampling density @xmath473 relative to the riemannian measure * * estimated manifold dimension @xmath474 * * laplace - beltrami eigenfunctions @xmath475 , @xmath476 , and the corresponding eigenvalues @xmath477 * * inner product weights @xmath478 * density estimation phase 1 .   for each @xmath63 ,",
    "compute the ad - hoc bandwidth function @xmath479 , where @xmath480 is the index of the @xmath217-th nearest neighbor of @xmath63 in the dataset .",
    "2 .   for each @xmath481 , compute the sum @xmath482 for the kernel @xmath483 3 .",
    "choose the bandwidth parameter @xmath484 that maximizes @xmath485 .",
    "the estimated manifold dimension is @xmath486 .",
    "4 .   with the bandwidth parameter from step  2 , compute the sampling density @xmath487.\\ ] ] * main calculation phase 1 .   select the bandwidth parameter @xmath396 for the kernel @xmath464 in   using the same method as steps  2 and  3 of the density estimation phase .",
    "2 .   compute the vector @xmath488 with @xmath489 and the @xmath422 matrix @xmath490 with @xmath491 .",
    "3 .   compute the vector @xmath492 with @xmath493 and the @xmath422 symmetric matrix @xmath469 with @xmath494 .",
    "4 .   solve the eigenvalue problem @xmath495 with @xmath496 and @xmath497 .",
    "5 .   set the eigenvalues to @xmath498 , the inner product weights to @xmath499 with @xmath500 , and the eigenfunctions to @xmath501 with @xmath502 .",
    "note that algorithm  [ algbasis ] is not too sensitive to the choice of the nearest neighbor parameter @xmath461 and the candidate bandwidth parameter values .",
    "hereafter , we will always work with the values @xmath503 and @xmath472 with @xmath504 , which were also used in @xcite .",
    "we solve the eigenvalue problem for the koopman generator @xmath50 in weak form in the basis of @xmath329 in  . because the set of eigenvalues is dense on the imaginary line ( see remark  [ remeigdense ] ) , we first regularize the problem by adding a small amount of diffusion to @xmath50 to form the operator @xmath505 qualitatively , the effect of the diffusion term @xmath506 is to suppress highly oscillatory eigenfunctions from the spectrum , which , as stated in remark  [ remoscillatory ] ,",
    "can have arbitrarily small frequencies ( eigenvalues ) . with these pathological modes suppressed from the spectrum ,",
    "we identify the generating frequencies and eigenfunctions by ordering the computed eigenfunctions in order of increasing dirichlet energy .",
    "we will return to a discussion of the effects of diffusion in the spectral properties of @xmath507 in section  [ secspectral ] .",
    "we solve the eigenvalue problem for @xmath507 using spectral galerkin methods for elliptic eigenvalue problems @xcite . to pass from the strong form of the problem , @xmath508 to the weak form ,",
    "we multiply the eigenvalue equation by a test function @xmath509 , integrate by parts with respect to the invariant measure , and require that the resulting integral equation is satisfied for all elements of appropriate trial and test spaces , which we both take to be @xmath510 .",
    "find @xmath511 and @xmath512 such that for any @xmath513 , @xmath514 where @xmath515 and @xmath6 are sesquilinear forms on @xmath516 given by @xmath517    in the discrete formulation of the problem , we formally restrict the trial and test spaces to the @xmath318-dimensional subspaces @xmath518 spanned by the basis functions in  ; i.e. , we have @xmath519 and @xmath520 , where @xmath521 and @xmath522 are complex - valued expansion coefficients .",
    "however , because instead of the true laplace - beltrami eigenfunctions we only have access to the approximate eigenfunctions from algorithm  [ algbasis ] , and furthermore we do not have access to the exact generator @xmath50 , we additionally make the following approximations for the evaluation of the sesquilinear forms in the continuous problem .",
    "[ eqmateig ]    1 .",
    "we approximate the basis function values on the dataset by the vectors @xmath523 with @xmath524 , where @xmath525 and @xmath526 are the eigenvectors and eigenvalues from algorithm  [ algbasis ] .",
    "2 .   in the case of @xmath527",
    ", we put @xmath528 where @xmath466 is the @xmath529 identity matrix since @xmath530 .",
    "3 .   in the case of @xmath6",
    ", we put @xmath531 where @xmath97 is the @xmath529 diagonal matrix with the diagonal entries @xmath532 .",
    "4 .   in the case of @xmath533",
    ", we proceed similarly as with @xmath527 and @xmath6 , but we also approximate the action of the koopman generator @xmath534 on the basis elements using finite differences in time as stated in remark  [ remtime ] .",
    "hereafter , we will use a second - order central scheme for the sampling interval @xmath65 , and make the approximation @xmath535 .",
    "we therefore set @xmath536 where @xmath57 is the @xmath529 matrix with elements @xmath537 .",
    "with these approximations , we define :    find @xmath538 and @xmath539 such that for any @xmath540 , @xmath541 where @xmath542 and @xmath543 are sesquilinear forms on @xmath544 given by @xmath545    the solution to the discrete problem is given by the generalized eigenvalue problem @xmath546    the @xmath383 basis from   and its discrete counterpart @xmath547 are adapted to the @xmath1 regularity of the eigenvalue problem for @xmath507 in the sense that the highest - order sesquilinear form @xmath527 appearing in the weak formulation of the problem is represented by the identity matrix , @xmath548 .",
    "this property ensures that the scheme remains well - conditioned at large spectral order of approximation @xmath318 .",
    "in contrast , the condition number of the @xmath466 matrix would exhibit unbounded growth with @xmath318 if we were to work in the unscaled eigenfunction basis .",
    "this approach of tailoring the approximation basis to the sobolev regularity of the continuous problem is sometimes used in spectral galerkin methods with polynomial basis functions ( e.g. , @xcite ) .",
    "the numerical solution of the generalized eigenvalue problem in   yields @xmath549 ( depending on the numerical algorithm used ) eigenvalue - eigenvector pairs @xmath550 with @xmath551 and the corresponding discretely sampled eigenfunctions @xmath552 with @xmath553",
    ". throughout , we work with the normalization @xmath554 from  , which approximates the normalization @xmath555 on @xmath31 in the continuous case .    to identify a generating set @xmath556 for the eigenfunctions and the corresponding basic frequencies @xmath557 using the approach of section  [ secdimensionreduction ] , we first order the eigenfunctions in order of increasing dirichlet energy , which we compute from discrete analog of  , @xmath558 .",
    "then , we select @xmath559 and @xmath143 from the first @xmath4 nonconstant eigenfunctions in this set with `` numerically rationally independent '' eigenvalues up to some precision . operationally ,",
    "we declare @xmath142 and @xmath560 to be rationally independent at precision @xmath561 if there exist no integers @xmath562 and @xmath563 with absolute value smaller than @xmath564 such that @xmath565 . in practice , it is usually easy to identify rationally independent frequencies from the first few numerical eigenvalues manually .",
    "the numerical procedure to compute the generating frequencies and eigenfunctions can be summarized as follows .",
    "[ alggenerators ]     * inputs * * diffusion eigenvalues @xmath566 eigenfunctions @xmath567 , and invariant measure @xmath468 from algorithm  [ algbasis ] * * manifold dimension @xmath4 * * regularization parameter @xmath396 * outputs * * generating frequencies @xmath568 , @xmath569 , and eigenfunctions @xmath570 , @xmath571 * execution steps 1 .",
    "compute the @xmath529 matrices @xmath466 , @xmath97 , and @xmath57 from  , and form form the matrix @xmath572 .",
    "2 .   solve the generalized eigenvalue problem in  ; obtain the eigenvalues @xmath573 , @xmath574 , and the eigenvectors @xmath575 , @xmath576 , for @xmath549 .",
    "3 .   normalize each eigenvector to unit norm @xmath577 , where @xmath578 .",
    "4 .   compute the dirichlet energies of the eigenvectors , @xmath579 , and order the eigenvectors and eigenvalues in order of increasing @xmath580 .",
    "set @xmath568 to the first @xmath4 rationally independent frequencies @xmath581 and @xmath163 to the corresponding eigenvectors .    using the identified generating sets , we form the product bases @xmath308 and associated frequencies @xmath582 as described in definition  [ defnpurepoint ] .",
    "note that the numerical generators @xmath583 will not lie exactly on the unit circle , and this happens because of sampling errors ( i.e. , errors that vanish as @xmath440 ) , but also bias errors in the markov operator @xmath403 in diffusion maps and the regularized generator @xmath507 occurring at nonzero @xmath396 .",
    "we therefore rescale the generators pointwise to ensure that @xmath584 before taking powers .",
    "experimentally , we find that generating the spectrum recursively from the generators produces more accurate eigenfunctions than the raw solutions of  , presumably because the accuracy of the data - driven basis degrades more rapidly at high eigenfunctions than the loss of accuracy in the @xmath559 products .",
    "the spectral properties of the regularized generator @xmath507 from   are compounded by the facts that ( 1 ) the limit @xmath443 is a singular limit of the corresponding eigenvalue equation ; ( 2 ) apart from special cases ( e.g. , irrational flows on flat tori ) , the operators @xmath50 and @xmath365 do not commute , and as result @xmath507 is nonnormal with @xmath585 = 2 \\epsilon [ v , \\updelta_h ] .\\ ] ] if @xmath50 has smooth eigenfunctions , one can confirm with asymptotic expansions that the influence of the diffusion term on these eigenfunctions is benign . in particular ,",
    "writing @xmath586 and @xmath587 with @xmath588 , and inserting these asymptotic series in the eigenvalue equation  , we obtain the @xmath398 equation @xmath589 this equation can be solved by requiring that @xmath590 is orthogonal to @xmath221 as a solvability condition , i.e. , @xmath591 , giving @xmath592 we therefore see that , at @xmath398 , the diffusion term perturbs the eigenvalues of @xmath50 corresponding to smooth eigenfunctions by a purely real term equal to the dirichlet energy of the unperturbed eigenfunctions .",
    "this provides a more quantitative estimate of the suppression of highly - oscillatory eigenfunctions of @xmath50 from the spectrum of @xmath507 claimed in section  [ secgalerkin ] .",
    "note that the imaginary part of the perturbation to @xmath130 , which is important for nonparametric forecasting , occurs at @xmath593 .",
    "it also follows from these results that the non - orthogonality of the eigenfunctions of @xmath507 can be estimated by @xmath594 , and the coefficients @xmath595 vanish if @xmath596 and @xmath221 are eigenfunctions of both @xmath50 and @xmath365 .",
    "more generally , it follows from the spectral theorem and   that orthogonality and completeness of the eigenfunctions of @xmath507 is guaranteed at all orders in @xmath396 if @xmath50 and @xmath365 are commuting operators .",
    "one situation that this occurs is when the dynamical flow @xmath14 preserves the riemannian metric @xmath333 , i.e. , @xmath50 generates @xmath333-isometries . a necessary and sufficient condition for @xmath50 to generate isometries is that it satisfies killing s equation , @xmath597 , where @xmath598 is the covariant derivative associated with @xmath333 , @xmath599 is the riemannian dual of @xmath50 , @xmath600 is the outer product of tensors , and @xmath601 represents the transpose of type @xmath602 tensors .",
    "one can check that if this equation is satisfied then @xmath603 .",
    "moreover , when @xmath50 generates isometries of a smooth riemannian metric , then it must necessarily have a pure point spectrum @xcite .",
    "this is because the group of diffeomorphisms of a riemannian manifold is a compact lie group containing @xmath604 as an abelian subgroup , and translations on compact abelian groups have pure point spectra ( see section  [ secergodicity ] ) .",
    "these facts suggest that for a system with pure point spectrum one should regularize the generator with diffusion in a riemannian metric preserved by the dynamics in order to preserve orthogonality and completeness of the eigenfunctions , but currently we have no method for constructing this metric from data .",
    "nevertheless , as expected from the asymptotics ( and verified in the experiments in section  [ sectorus ] ahead ) , the effects of noncommutativity of @xmath50 and @xmath365 should have minimal impact on the quality of the numerical eigenfunctions in this case .",
    "what about the behavior of @xmath507 in more general ergodic systems where the generator also has a continuous spectrum , and in particular in weak - mixing and mixing systems where it has no nonconstant eigenfunctions ?",
    "mathematically , @xmath507 has the same structure as a class of advection - diffusion operators arising in incompressible fluid dynamics on compact manifolds ( see remark  [ remincompressibility ] on incompressibility ) , for which theoretical results are available in the literature @xcite . the latter references study the dynamical and spectral properties of operators of the form @xmath605 in the advection dominated regime , @xmath606 , and these operators are equivalent to @xmath607 with @xmath608 .",
    "franke et al .",
    "@xcite show that @xmath609 ( and hence @xmath507 ) has no continuous spectrum irrespective of the mixing properties of @xmath50 . for our purposes",
    ", this is a positive result as it eliminates an important source of numerical instability in the discrete problem .",
    "however , the physical significance of the eigenfunctions of @xmath507 ( and their utility in the dimension reduction and forecasting schemes of sections  [ secpurepointspectra ] and  [ secgalerkinimplementation ] ) becomes questionable , especially in weak - mixing systems where @xmath50 has no nonconstant eigenfunctions .    in @xcite ,",
    "constantin et al .",
    "establish necessary and sufficient conditions for @xmath609 to have the so - called relaxation - enhancing property as @xmath606 , i.e. , the property that the associated kolmogorov semigroup ( the advection - diffusion analog of the koopman group ) will produce relaxation of any function in @xmath610 to its mean value in arbitrarily small time .",
    "they show that @xmath609 is relaxation enhancing if and only if @xmath50 has no eigenfunctions in @xmath329 ; a condition that includes but is not necessarily limited to weak - mixing systems .",
    "the spectral manifestation of the relaxation - enhancing property is that the spectral gap of @xmath609 diverges as @xmath606 @xcite , meaning that @xmath611 will generally exhibit complicated spectral behavior , including the possibility of no eigenvalues with negligible real parts at arbitrarily small @xmath396 . on the other hand ,",
    "if @xmath50 has eigenfunctions in @xmath329 , then @xmath507 must necessarily have a vanishing spectral gap , and the asymptotic behavior described earlier applies .",
    "due to these considerations , rather than attempting to regularize weak - mixing systems by diffusion alone , in section  [ sectimechange ] we will put forward an alternative approach which also involves a time change @xcite attempting to reduce the mixing properties of the system while preserving its orbits .      with the availability of the approximate generators and the corresponding basic frequencies from algorithms  [ algbasis ] and  [ alggenerators ] , algorithms for dimension reduction , mode decomposition , and forecasting of systems with pure point spectra can be constructed following closely the continuous formulation in sections  [ secdimensionreduction ] and  [ secforecasting ] , replacing inner products on @xmath31 with the @xmath468-weighted inner products from  , and representing the action of the generator through finite differences of the diffusion maps basis as described in section  [ secgalerkin ] .",
    "an additional issue that needs to be taken into account is the non - orthogonality of the eigenfunctions of the regularized generator discussed in section  [ secspectral ] . in particular",
    ", the lack of orthogonality of the eigenfunctions leads to a modification of the inverse transforms to reconstruct observables and vector fields . for an observable @xmath39 with expansion coefficients @xmath612",
    "we now have @xmath613 ( as opposed to @xmath614 ) , where @xmath615 , and @xmath616 is the inverse of the gramm matrix @xmath617 .",
    "this matrix will generally fail to be an identity matrix due to both sampling and bias errors , but in applications we find that it is a well conditioned , sparse matrix .",
    "we summarize the main steps in the numerical implementation of the vector field decomposition from lemma  [ lemmavdecomp ] and the statistical forecasting scheme in section  [ secforecasting ] in algorithms  [ algvdecomp ] and  [ algstatisticalforecast ] , respectively . in these algorithms ,",
    "the notation @xmath618 refers to an @xmath422 diagonal matrix with diagonal elements equal to the components @xmath157 of the inner product weight vector @xmath619 .",
    "moreover , in algorithm  [ algstatisticalforecast ] we present our nonaparametric forecast scheme for general vector - valued observables in @xmath620 , instead of the scalar - valued observables discussed in the main text",
    ".    [ algvdecomp ]     * inputs * * observed time series @xmath470 , @xmath471 , at sampling interval @xmath65 * * invariant measure @xmath478 from algorithm  [ algbasis ] * * basic frequencies @xmath568 and generating eigenfunctions @xmath163 from algorithm  [ alggenerators ] * * spectral order parameter @xmath124 * outputs * * vector field components @xmath621 , where @xmath622 , and @xmath623 is a tangent vector at @xmath624 * preparatory steps 1 .",
    "arrange @xmath470 into a @xmath625 data matrix @xmath626 .",
    "2 .   rescale the generators @xmath627 to lie on the unit circle , @xmath628 .",
    "3 .   construct the index set @xmath629 with @xmath630 , @xmath631 and @xmath632 .",
    "4 .   for each @xmath633 form the basis vector @xmath634 with @xmath635 .",
    "arrange the @xmath221 in the @xmath636 matrix @xmath637 .",
    "5 .   compute the gramm matrix @xmath638 with @xmath617 ; in matrix notation , @xmath639 . * execution steps 1 .",
    "compute the expansion coefficient matrix @xmath640 of the observation map s.t .",
    "@xmath641 , @xmath642 . in matrix notation , @xmath643 .",
    "2 .   for @xmath213 compute the diagonal matrix @xmath644 , where @xmath645 and @xmath562 is the @xmath216-th element of the index vector @xmath646 .",
    "3 .   reconstruct the vector fields in   by forming the @xmath625 matrices @xmath647 .",
    "set @xmath648 to the @xmath217-th column of @xmath245 .",
    "[ algstatisticalforecast ]     * inputs * * observable time series @xmath649 , @xmath650 with sampling interval @xmath65 * * invariant measure @xmath478 from algorithm  [ algbasis ] * * discretely sampled initial probability density @xmath651 , normalized such that @xmath652 * * forecast times @xmath653 in multiples of @xmath65 * * basic frequencies @xmath568 and generating eigenfunctions @xmath163 from algorithm  [ alggenerators ] * * spectral order parameter @xmath124 * outputs * * forecast densities @xmath654 , @xmath655 * * expectation values @xmath656 , @xmath657 , of the observable * preparatory steps 1 .",
    "repeat the preparatory steps of algorithm  [ algvdecomp ] .",
    "2 .   compute the frequency @xmath658 corresponding to each index vector @xmath659 . * execution steps 1 .   compute the expansion coefficient matrix @xmath660 of the observable s.t .",
    "2 .   compute the expansion coefficients @xmath662 of the initial density with @xmath663 ; pre - multiply with the inverse gramm matrix to form the coefficients @xmath664 .",
    "3 .   for each forecast time",
    "@xmath665 1 .",
    "advance the expansion coefficients of the density using @xmath666 .",
    "arrange the result in a row vector @xmath667 .",
    "2 .   reconstruct the density @xmath668 using @xmath669 .",
    "3 .   compute the expectation value of the observable @xmath670 .",
    "we apply the dimension reduction , vector field decomposition , and nonparametric forecasting techniques described above to the dynamical system on @xmath671 with the generator ( cf .  )",
    "@xmath672 where @xmath673 are the two angles on the torus , @xmath277 is a frequency parameter set to an irrational number , and @xmath674 $ ] is a parameter controlling the speed of the flow .",
    "this system , which was also studied in @xcite , is ergodic and has pure point spectrum as it can be transformed to an irrational flow with appropriate changes of coordinates .",
    "its unique invariant measure has density @xmath675\\ ] ] relative to the haar measure on @xmath671 , and the orbit @xmath676 passing through @xmath677 at time @xmath678 is given by @xmath679 \\beta^{-1/2 }   \\tan ( \\beta t / 2 ) , \\quad \\cot ( \\theta^2 / 2 ) = ( 1 - \\beta ) ^{1/2 } + \\beta^{1/2 } \\cot ( \\beta^{1/2 } \\alpha t / 2 ) .\\ ] ]    here , we use the same frequency parameter , @xmath680 , as in the irrational flow example of section  [ secirrational ] , and set the parameter @xmath681 to @xmath682 .",
    "we also use the same observation map as in section  [ secirrational ] , i.e. , the standard embedding of the 2-torus into @xmath315 from   with radius parameter @xmath683 . as illustrated in fig .",
    "[ figtorusx ] , with this choice of parameters the system `` slows down '' at @xmath684 and `` speeds up '' at @xmath685 , resulting in a large density contrast @xmath686 relative to the haar measure .",
    "moreover , the system exhibits two timescales which are mixed together in the components of the nonlinear observation map . despite the apparent complexity of these time series ,",
    "the underlying dynamical system is completely integrable and our method is able to detect this structure using no other information than time - ordered data .",
    "observed time series for the variable - speed dynamical system on the 2-torus .",
    "( a ) embedding in @xmath315 ; ( b , c ) components @xmath326 and @xmath687 of the embedding , respectively . ]    in these experiments , we used as training data a time series consisting of 64,000 samples @xmath60 taken from the orbit in   at a timestep @xmath688 . using this data",
    ", we computed 1000 diffusion eigenvalues and eigenfunctions @xmath689 through algorithm  [ algbasis ] , and constructed the generating set @xmath286 and the corresponding basic frequencies @xmath287 using algorithm  [ alggenerators ] with @xmath690 .",
    "we use the true manifold dimension , @xmath691 , as an input to these algorithms , but in this case an accurate dimension estimate can also be obtained from the kernel density estimation procedure in algorithm  [ algbasis ] .",
    "the eigenvalues of the approximate generator @xmath507 corresponding to the basic frequencies are @xmath692 and @xmath693 ( @xmath694 is the complex conjugate of @xmath695 ) , and @xmath696 . according to our convention ,",
    "these eigenvalues are ordered in order of increasing dirichlet energy ; in this case @xmath697 and @xmath698 , and the computed eigenvalues have @xmath699 and @xmath700 , which is in good agreement with the asymptotic result in  .",
    "the generating eigenfunctions from these calculations are displayed in fig .",
    "[ figtorusz ] .",
    "there , it is evident that the projection maps from   based on the eigenfunctions send the data set to a near - exact circle in the complex plane , and the time series @xmath701 from   describe simple harmonic oscillations .",
    "the frequencies of these oscillations ( measured , e.g. , through fft ) are in very good agreement with @xmath142 . as illustrated by the scatterplots in fig .",
    "[ figtorusz](a , b ) , eigenfunctions @xmath702 and @xmath703 vary purely along angles @xmath704 and @xmath705 , respectively .",
    "this is an outcome of the fact that in the induced riemannian geometry from @xmath22 these eigenfunctions have the smallest dirichlet energies , but in other geometries we could have mixtures of the form @xmath706 appearing as the least oscillatory eigenfunctions . compared to their counterparts for the irrational flow in section  [ secirrational ] ( which are pure sinusoids in the @xmath704 and @xmath705 angles ) ,",
    "the generating eigenfunctions for the variable - speed flow exhibit `` compressed '' ( `` expanded '' ) waveforms in the regions of anomalously high ( low ) phase - space speed .",
    "the generating eigenfunctions @xmath702 ( a  c ) and @xmath703 ( d  f ) for the variable - speed dynamical system on the 2-torus . ( a , d ) scatterplots of @xmath707 on the torus ; ( b , e ) time series of @xmath708 and @xmath709 ; ( c , f ) scatterplots of @xmath710 .",
    "the eigenfunctions shown here have not been rescaled to the unit circle  they are the result of step  5 of algorithm  [ alggenerators ] . ]    with these results for the generating eigenfunctions and basic frequencies , we use algorithm  [ algvdecomp ] to decompose @xmath50 into the mutually commuting vector fields @xmath711 from lemma  [ lemmavdecomp ] , and reconstruct these vector fields in data space .",
    "figure  [ figtorusv ] shows the reconstructions obtained with a spectral order parameter @xmath712 , corresponding to @xmath713 eigenfunctions .",
    "the vector fields exhibit the qualitative features expected from the corresponding generating eigenfunctions in fig .",
    "[ figtorusz ] , namely the reconstructed vector fields , @xmath714 and @xmath715 , describe flows purely along the @xmath716 and @xmath705 directions , respectively . as discussed in section  [ secvectorfield ] , these flows preserve the equilibrium measure of the dynamics ( but not the riemannian measure of the torus embedded in @xmath315 ) , and are clearly not ergodic@xmath717 ( @xmath718 ) has a non - trivial nullspace spanned by functions with no @xmath705 ( @xmath719 ) dependence . with this large number of basis functions ,",
    "the time - averaged ( root mean square ) reconstruction error in @xmath720 is 0.2% of the time - averaged norm of the full vector field @xmath57 in @xmath315 .",
    "note that good - quality reconstructions are possible with substantially fewer basis functions ( e.g. , @xmath721 , @xmath722 yields a 5.9% error ) .",
    "moreover , the expansion coefficients of the @xmath245 in the @xmath308 basis exhibit strong sparsity , suggesting that the reconstructed patterns can be efficiently compressed using subsets of the @xmath308 basis as dictionaries .    vector field decomposition for the variable - speed dynamical system on the 2-torus .",
    "( a ) full vector field embedded in @xmath315 ; ( b , c ) mutually commuting components from lemma  [ lemmavdecomp ] corresponding to the generators in fig .  [ figtorusz ] , reconstructed in @xmath315 via the pushforward map in  . ]    next , we consider statistical forecasting of the components @xmath723 and @xmath724 of the state vector in @xmath315 using the nonparametric technique in algorithm  [ algstatisticalforecast ] . as with the irrational - flow example in section  [ secirrational ] , we assign an initial probability measure @xmath249 with a von mises density relative to the haar measure . in this case",
    ", we set the location and concentration parameters @xmath725 and @xmath320 , respectively .",
    "note that the equilibrium measure @xmath11 of the variable - speed system differs from the haar measure on the torus , so the initial density @xmath726 is given by the density in   divided by @xmath5 from  .",
    "we normalize the initial density on the dataset so that @xmath727 , where @xmath728 .",
    "a scatterplot of the initial density on the torus is shown in fig .",
    "[ figtorusrhot](a ) .",
    "we advance this density and the corresponding expectation values and standard deviations for @xmath326 and @xmath687 for the lead times @xmath729 with @xmath730 using algorithm  [ algstatisticalforecast ] .",
    "figure  [ figtorusrhot ] shows representative snapshots of the time - dependent density for these lead times , which is is also visualized as a video in movie  1 .",
    "figure  [ figtorusforecast ] displays the means and standard deviations of @xmath326 and @xmath687 obtained via algorithm  [ algstatisticalforecast ] and an ensemble forecast with the perfect model using 10,000 samples drawn independently from @xmath249 .",
    "time - dependent density @xmath731 for the variable - speed dynamical system on the 2-torus relative to its equilibrium measure computed via the nonparametric method in algorithm  [ algstatisticalforecast ] .",
    "( a ) initial von mises density with location and concentration parameters @xmath732 and @xmath733 , respectively ; ( b  d ) snapshots of @xmath731 illustrating phases of high uncertainty ( b , d ) and a phase of low uncertainty ( c ) . the dynamic evolution of @xmath731 is also shown in movie  1 . ]",
    "statistical forecasts via the nonparametric method in algorithm  [ algstatisticalforecast ] and a 10,000-member ensemble from the perfect model for the variable - speed system on the 2-torus .",
    "the forecast observables are the components @xmath326 ( a , b ) and @xmath734 ( c , d ) of the embedding of the 2-torus into @xmath315 from   with radius parameter @xmath735 .",
    "the initial probability measure has the circular density in fig .",
    "[ figtorusrhot](a ) . ]    following an initial transient stage , the probability density in fig .",
    "[ figtorusrhot ] relaxes to an aperiodic pattern characterized by alternating phases of high ( fig .",
    "[ figtorusrhot](b , d ) ) and low ( fig .",
    "[ figtorusrhot](b ) ) uncertainty , corresponding to the regions with high speed ( low density relative to the haar measure ) and low speed ( high density relative to the haar measure ) , respectively .",
    "qualitatively , the time - dependent measure will eventually explore the full phase space on the torus by ergodicity , but because the system is not mixing , the density @xmath731 retains its coherence and its dirichlet energy is bounded in time . the results in fig .",
    "[ figtorusforecast](a , c ) indicate that the mean forecast with the nonparametric model is in very good agreement with the ensemble forecast .",
    "the standard deviation forecast in fig .",
    "[ figtorusforecast](b , d ) is also in good agreement with the ensemble , but in this case the nonparametric model overestimates the standard deviation in the low - uncertainty periods ( especially for @xmath687 ) . a factor that may be contributing to this discrepancy is that during those periods the density @xmath731 exhibits small - scale behavior and correspondingly large bandwidth in the @xmath308 basis , limiting the accuracy of our finite-@xmath124 truncation .",
    "time change ( e.g. , @xcite ) is a technique in continuous - time dynamical systems which involves scaling the generator @xmath50 by a smooth positive function @xmath736 to create the vector field @xmath737 .",
    "this new vector field generates a flow @xmath738 on @xmath2 having the same orbits as the original flow @xmath14 ( since @xmath739 and @xmath50 are parallel ) , but time flows differently with respect to @xmath738 than it does with respect to @xmath14 .",
    "in particular , for @xmath740 we have @xmath741 . moreover , if @xmath93 is ergodic , then @xmath742 is also ergodic for the invariant probability measure @xmath743 with density @xmath744    while time change preserves ergodicity , the same is not true for mixing  a theorem due to koergin @xcite states that for any ergodic flow there exists a time change by a smooth function which renders it mixing .",
    "heuristically , we can think of mixing by time change in the following way .",
    "suppose that @xmath745 is a measurable set that we picture as a coherent globular object . in the original",
    ", non - mixing system , @xmath746 maintains its coherence in the course of dynamical evolution , but in the time - changed system parts of @xmath98 will lag behind others . for a suitable time - change function , @xmath747 will become increasingly stretched and twisted , and its volume will become asymptotically equidistributed in @xmath2 in accordance with the condition for mixing in section  [ secergodicity ] . as a concrete example , which we will study with numerical experiments in section  [ secmixing3torus ] ahead , fayad @xcite shows that an irrational flow on the 3-torus becomes mixing through the analytic time - change function @xmath748 where @xmath749 are the three angles on @xmath750 .",
    "figure  [ figmixing3torusx ] shows @xmath751 as a time series for the underlying irrational flow @xmath752 with frequencies @xmath753 .",
    "traditionally , time change is used as a technique to improve mixing and stochasticity of dynamical systems . here",
    ", our approach is to use time change as a regularization tool to reduce mixing and improve the spectral properties of the koopman operators for dimension reduction and nonparametric forecasting .",
    "in essence , we will use the eigenfunctions of the time - changed system to decompose the original dynamical system into a collection of non - autonomous oscillators with variable frequency ( as opposed to simple harmonic oscillators ) .",
    "we will also use these eigenfunctions to perform a vector field decomposition analogous to lemma  [ lemmavdecomp ] , but the vector field components in this case will be non - commuting .",
    "finally , we will generalize the forecasting methods of section  [ secforecasting ] to the time - changed framework .",
    "in what follows , @xmath93 will be an ergodic dynamical system on an @xmath4-dimensional manifold @xmath2 with vector field @xmath50 generating the observed data , and @xmath742 will be a time - changed system with vector field @xmath737 and invariant measure @xmath743 with the density in  .",
    "[ proppiprojt]assume that @xmath742 has pure point spectrum with basic frequencies @xmath568 and corresponding orthonormal eigenfunctions @xmath163 on @xmath754 , and define the projection maps @xmath755 as in  , i.e. , @xmath756 .",
    "then , the time series @xmath757 evolves as a non - autonomous variable - frequency oscillator with @xmath758    this equation follows directly from the facts that @xmath759 and @xmath760 when @xmath761 .",
    "proposition  [ proppiprojt ] indicates that if the dynamical system generating the data is related to a system with pure point spectrum by a time change , we can use the spectral properties of that system to perform dimension reduction and forecasting at the expense of introducing additional complexity ( in the case of proposition  [ proppiprojt ] , non - autonomous dynamics ) due to the time change function .",
    "the following lemma , which we state without proof , is the analog of lemma  [ lemmavdecomp ] for time - changed systems .",
    "[ lemmavdecompt ] let @xmath762 be as in proposition  [ proppiprojt ] and let @xmath763 be the vector field decomposition of @xmath739 from lemma  [ lemmavdecomp ] .",
    "then , @xmath50 admits the decomposition @xmath192 into the nowhere - vanishing , linearly independent , @xmath11-preserving vector fields @xmath764 .    unlike lemma  [ lemmavdecomp ] , in this case the vector fields",
    "@xmath186 can be non - commuting due to the presence of @xmath736 , which means that in general we can not view them as generators of independent dynamical processes .",
    "nevertheless , the @xmath186 can still be reconstructed in data space using a pusfhforward operation analogous to  , with the difference that the observation map @xmath22 is now decomposed in the orthonormal basis of @xmath754 associated with @xmath739 .",
    "that is , we write @xmath765 , where @xmath766 , and @xmath767 is the eigenfunction of @xmath739 corresponding to eigenvalue @xmath768 , @xmath769 .",
    "in this basis , the pushforward operation for @xmath186 becomes @xmath770    we proceed similarly to modify the forecasting scheme of section  [ secforecasting ] .",
    "as before , we are interested in forecasting the density @xmath771 of a time - dependent measure @xmath264 relative to @xmath11 given the initial data @xmath251 .",
    "the evolution of the density is still governed by the perron - frobenius operator @xmath772 for the dynamical system @xmath93 , but in this case we treat @xmath731 as a function in @xmath754 and expand it in the orthonormal basis @xmath308 .",
    "that is , substituting the expansion @xmath773 with @xmath774 into the equation @xmath775 we obtain @xmath776 taking now @xmath754 inner products of the last equation with the basis elements @xmath777 , it follows that @xmath778 thus , the uncoupled simple harmonic oscillators of section  [ secdimensionreduction ] are replaced by coupled oscillators in the time - changed setting with coupling coefficients given by the @xmath779 coefficients .",
    "these coefficients can be viewed as the elements of an operator on sequences in @xmath259 , and writing @xmath780 we have @xmath781 where @xmath78 is the diagonal operator on @xmath259 in  .",
    "this last equation has the formal solution ( cf .  ) @xmath782 with this solution , the time - dependent expectation value of an observable @xmath783 can be computed from an analogous expression to  , but with additional coupling terms due to time change , viz .",
    "@xmath784 where the coefficients @xmath785 are given by @xmath786 note that as with  , we can compute @xmath785 using the inner products of either of @xmath31 or @xmath754 .    [ rempredictability ] the coupling of the expansion coefficients @xmath787 can potentially lead to barriers in predictability .",
    "in particular , if @xmath736 is a polynomial in @xmath559 of degree @xmath788 then knowledge of a finite number of expansion coefficients is sufficient to forecast the expectation values of polynomial observables at arbitrarily long times . on the other hand ,",
    "if the number of coefficients needed to represent @xmath736 exactly is infinite ( e.g. , the time - change function in  ) , then prediction of polynomial observables at arbitrarily long times may not be possible with finite numbers of @xmath789 coefficients known at forecast initialization .",
    "note that if the system is mixing then in the course of dynamical evolution @xmath731 develops arbitrarily small lengthscales on @xmath2 and arbitrarily large bandwidth in the eigenfunction basis .",
    "however , the corresponding measures @xmath264 converge to @xmath11 in the sense that @xmath790 for all @xmath107 @xcite .",
    "the analysis in section  [ sectimechangeforecasting ] shows that time - change transformations can extend the applicability of koopman eigenfunction techniques to certain systems that do not posses nonconstant eigenfunctions .",
    "of course , the systems in question have special structure , namely that they are related to pure point systems via time change . even in such cases ,",
    "taking advantage of this special structure from data is challenging without prior information about the time - change function @xmath736 .",
    "nevertheless , motivated from the results of section  [ sectimechangeforecasting ] , in this section , we put forward a time - change scheme whose objective is to improve the spectral properties of the generator for eigendecomposition .",
    "this method employs a time - change function which is empirically accessible from time - ordered data , and recovers @xmath736 in special cases .",
    "let @xmath791 be the norm of the dynamical vector field with respect to the ambient space riemannian metric @xmath26 .",
    "this quantity is nonnegative and measurable , and thus can be used as a time change function to obtain the vector field @xmath792 .",
    "note that @xmath793 vanishes only at fixed points of @xmath50 , which have measure zero by ergodicity . in the special case that @xmath50 is indeed related to a system with pure point spectrum by a time change with function @xmath736 ,",
    "then it follows from lipschitz equivalence of riemannian metrics on compact manifolds that there exists a constant @xmath794 such that @xmath795 .",
    "moreover , there exits a metric @xmath26 ( e.g. , the flat metric on the torus ) such that @xmath796 .",
    "a key property of @xmath793 is that it can be approximated from time - ordered data using finite differences . in particular , we have @xmath797 , where @xmath55 is the pushforward of @xmath50 in data space , and we can approximate @xmath57 via finite differences as described in section  [ secergodicity ] .",
    "our approach is to use @xmath793 as an empirically accessible time - change function , and consider @xmath798 as a candidate vector field with well - behaved eigenfunctions on the hilbert space @xmath799 with @xmath800 , @xmath801 . in what follows",
    ", we will carry out the vector field decomposition in lemma  [ lemmavdecomp ] and the statistical forecasts in   and   using @xmath793 as the time - change function in place of @xmath736 .",
    "proceeding in direct analogy with the methods of section  [ secgalerkin ] , we compute approximate eigenfunctions of @xmath798 by approximating this operator in a basis of eigenfunctions of a laplace - beltrami operator for a suitable riemannian metric @xmath802 . in this case",
    ", the metric should have volume form equivalent to @xmath803 , so we consider the conformal transformation @xmath804 , where , as before , @xmath5 is the density of the invariant measure @xmath11 relative to the riemannian measure @xmath30 of the ambient space metric .",
    "we approximate the laplace - beltrami operator for this geometry using diffusion maps with the modified kernel ( cf .  ) @xmath805 and the same normalization as algorithm  [ algbasis ] .",
    "note that in this case the sampling density @xmath399 relative to the riemannian measure of @xmath802 is nonuniform , but the effects of @xmath399 are canceled out as @xmath443 via normalization as described in section  [ secdatadrivenbasis ] .",
    "applying algorithm  [ algbasis ] with the kernel in  , we obtain an orthonormal basis of @xmath799 from the laplace - beltrami eigenfunctions @xmath806 associated with @xmath802 .",
    "we then construct the associated basis @xmath807 of @xmath808 following  , and compute approximate eigenvalues and eigenfunctions of @xmath798 from the eigenvalue problem for the advection - diffusion operator @xmath809 with an analogous algorithm to algorithm  [ alggenerators ] .    our vector field decomposition and statistical forecasting techniques with time change",
    "can then be carried out using algorithms  [ algvdecomp ] and  [ algstatisticalforecast ] with appropriate modifications to take into account the change of basis and the coupling coefficients in   and  . instead of giving full listings for these modified algorithms , we indicate below the required changes .    *",
    "the eigenfunctions @xmath810 and eigenvalues @xmath811 are for the time - changed operator @xmath812 .",
    "similarly , the discrete inner product weights @xmath157 are for the diffusion eigenfunction basis @xmath806 .",
    "* in step  3 of algorithm  [ algvdecomp ] , the vector components @xmath245 are now given by @xmath813 , where @xmath814 is an @xmath422 diagonal matrix whose @xmath216-th diagonal entry is set to the value of the time - change function at the @xmath216-th data sample , @xmath815 .",
    "* in algorithm  [ algstatisticalforecast ] , we also compute the @xmath529 matrices @xmath816 and @xmath817 approximating the coupling coefficients in   and  , respectively .",
    "note that we avoid division by @xmath815 in the expression for @xmath818 using ergodic sums to approximate the @xmath819 inner product in  . * in step  3(a ) of algorithm  [ algstatisticalforecast ] , the expansion coefficients for the density",
    "are now given by @xmath820 .",
    "similarly , in step  3(c ) , the expectation value of the observable now becomes @xmath821 .        as a first application of our dimension reduction and nonparametric forecasting techniques with time change , we study the mixing system on @xmath822 in @xcite with the time - change function @xmath736 in  , using the underlying irrational flow with angular frequencies @xmath823 . for this set of experiments ,",
    "we generated a time series consisting of @xmath824 samples in @xmath825 taken at a timestep @xmath826 with the canonical embedding @xmath827 , where @xmath828 are the angles corresponding to the point @xmath25 . with this embedding",
    ", the torus inherits the flat metric @xmath26 , and we have @xmath829 .",
    "therefore , in this case , @xmath830 is inversely proportional to the true time - change function @xmath736 , and the method described in section  [ secimplementationt ] is guaranteed to recover an irrational flow on @xmath750 .",
    "this application is therefore a `` best - case scenario '' for the techniques of section  [ secimplementationt ] to perform well , but nevertheless it remains challenging for data - driven eigendecomposition and forecasting techniques due to mixing dynamics .",
    "figure  [ figmixing3torusx ] shows representative time series from this system together with the vector field norm @xmath831 .",
    "qualitatively , @xmath793 exhibits a series of intermittent spikes whose amplitude is modulated by a low - frequency envelope .",
    "these variations in the speed of the flow , whose maxima and minima differ by more than a factor of 10 , produce phase - modulated wavetrains in the observed time series ( see fig .",
    "[ figmixing3torusx](a , b ) ) . as a result ,",
    "the invariant measure @xmath11 has highly nonuniform density relative to the haar measure on the 3-torus .",
    "time series from the mixing system on the 3-torus .",
    "( a , b ) state vector components @xmath326 and @xmath687 , respectively , in the flat embedding of the 3-torus in @xmath825 ; ( c ) magnitude @xmath832 of the dynamical vector field with respect to the ambient - space metric . in this case",
    ", @xmath833 is inversely proportional to the time - change function @xmath736 producing mixing . ]    for comparison , we begin by solving the eigenvalue problem for the generator using the method in section  [ secimplementation ] which does not involve time change . because the system is mixing and @xmath50 has no eigenfunctions , the spectrum of the regularized operator @xmath507 is expected from theory @xcite to deviate significantly from the simple harmonic oscillator patterns arising in systems with pure point spectra , and as shown in fig .",
    "[ figmixing3torusx ] this is indeed the case .",
    "the eigenfunctions in fig .",
    "[ figmixing3torusx ] , which were computed for the regularization parameter @xmath690 , include one with a quasiperiodic time series ( fig .",
    "[ figmixing3torusznot](a ) ) that appears to capture the low - frequency modulating envelope of the time change function ( fig .",
    "[ figmixing3torusx](c ) ) . however , other eigenfunctions ( fig .",
    "[ figmixing3torusznot](b , c ) ) exhibit strong amplitude modulation  a manifestation of the fact that advection and diffusion interact non - trivially in @xmath507 in the presence of mixing and even for small @xmath396 .",
    "note that applying no regularization ( @xmath834 ) results in significantly less coherent patterns than those in fig .",
    "[ figmixing3torusznot ] .    generating eigenfunctions for the mixing system on the 3-torus without time change .",
    "( a ) quasiperiodic pattern associated with the low - frequency envelope in fig .  [ figmixing3torusx](c ) ; ( b , c ) amplitude - modulated patterns . ]",
    "next , we discuss the results obtained via the time - change technique of section  [ secimplementationt ] . as shown in fig .",
    "[ figmixing3torusz ] , the generating eigenfunctions @xmath835 from this method lie on the unit circle to a good approximation ( though with somewhat less fidelity than the eigenfunctions for the 2-torus system in fig .  [ figtorusz ] ) , and , as expected from proposition  [ proppiprojt ] , the corresponding time series have the structure of phase - modulated wavetrains .",
    "the basic frequencies associated with the generating eigenfunctions are @xmath836 ; these values agree to within three significant figures with the frequencies @xmath837 , of the irrational flow @xmath838 . based on this identification , we expect the eigenfunctions corresponding to the @xmath142 to have the structure @xmath839 and to have equal dirichlet energies @xmath840 in the flat metric . indeed , the numerical dirichlet energies for the eigenfunctions in fig .  [ secimplementationt ] are @xmath841 , @xmath842 , and @xmath843 . the real parts of the numerical eigenvalues are @xmath844 in all three cases , indicating that the effects of diffusion in the regularized operator @xmath812 are minimal after time change .    generating eigenfunctions @xmath128 for the mixing system on the 3-torus with time change .",
    "( a  c ) mapping of the 3-torus to the circles @xmath845 on the complex plane ; ( d  f ) time series of the real and imaginary parts of the eigenfunctions exhibiting time - dependent frequency ( cf .",
    "the eigenfunctions in fig .",
    "[ figtorusz ] for the 2-torus system with pure point spectrum ) . ]",
    "figure  [ figmixing3torusv ] displays the vector field decomposition from lemma  [ lemmavdecompt ] for this system using a moderately small spectral order parameter @xmath721 ( see algorithm  [ algvdecomp ] ) , i.e. , @xmath846 eigenfunctions in total .",
    "the vector field components are reconstructed in the six - dimensional data space , and then projected to three - dimensional periodic boxes for visualization . at this spectral order of approximation , the reconstruction error in @xmath847 is @xmath848 in @xmath825 , but note that the visualizations in fig .",
    "[ figmixing3torusv ] are subject to additional projection errors , and therefore appear noisier than the native vector fields in @xmath825 . nevertheless , the plots in fig .",
    "[ figmixing3torusv](b  d ) illustrate clearly that @xmath714 , @xmath715 , and @xmath849 generate flows along the @xmath705 , @xmath704 , and @xmath850 directions , respectively , which is consistent with the identification with the @xmath798 system made earlier .",
    "vector field decomposition for the mixing dynamical system on the 3-torus .",
    "( a ) full vector field ; ( b  d ) vector field components from lemma  [ lemmavdecompt ] .",
    "all vector fields are visualized in a periodic box with the @xmath851 , @xmath270 , and @xmath79 axes corresponding to the normalized angles @xmath852 , @xmath853 , and @xmath854 , respectively , on @xmath750 . to create these plots ,",
    "the vector fields were first reconstructed in data space , @xmath825 , via   and then projected to the periodic box via the inverse derivative map @xmath855 .",
    "this projection step is needed because   can not be applied to reconstruct the vector fields directly in the periodic box ( in that case , the map @xmath856 would be discontinuous ) . because @xmath855 has singularities , the reconstructed arrow plots are more noisy than the natively reconstructed vector fields in @xmath825 . ]",
    "next , we turn to nonparametric forecasting of this system .",
    "we set the initial probability measure @xmath249 to a measure with isotropic circular gaussian density @xmath5 relative to the haar measure on @xmath750 , viz .",
    "@xmath857 which is the three - dimensional analog of  . taking into account the density of the invariant measure relative to the haar measure",
    ", our initial probability measure has density @xmath858 relative to @xmath11 , where @xmath736 and @xmath859 are the time change function and its ergodic mean from  . here",
    ", we use the location and concentration parameters @xmath860 and @xmath320 .",
    "also , we take the components @xmath861 of the observation map as our forecast observables .    figure  [ figmixing3torusforecast ] displays forecast results for the mean and standard deviation of these observables obtained via the method in section  [ secimplementationt ] for @xmath862 ( @xmath863 ) and an ensemble forecast with 10,000 particles using the perfect model . because this system is mixing , expectation values with respect to the time - dependent probability measures",
    "@xmath264 converge to expectation values with respect to @xmath11 ( see remark  [ rempredictability ] ) .",
    "this late - time behavior is clearly evident in the ensemble forecast results , but as it turns out it is particularly challenging to emulate with the nonparametric model consisting of a finite collection of coupled oscillators .",
    "that is , the stochastic behavior of this mixing deterministic system involves the generation of arbitrarily small lengthscales in the time - dependent densities @xmath731 , and as a result any diffusion - free algorithm that attempts to replicate this behavior via a finite collection of deterministic systems will ultimately fail at late times . in fig .",
    "[ figmixing3torusforecast ] , the nonparametric model is able to accurately track the mean and standard deviation of the ensemble forecast over times less than the the equilibrium relaxation time of the perfect model , but eventually develops spurious oscillations .",
    "the latter are possibly due to aliasing effects in the finite - bandwidth representation of @xmath731 , and could be suppressed at a fixed time @xmath252 by increasing @xmath124 .",
    "however , failure to relax to the correct equilibrium should occur at long - enough times for fixed @xmath124 .",
    "note that the consequences of this shortcoming may not be particularly detrimental if the timescale at which the nonparametric model deviates from the perfect model is comparable or exceeds the intrinsic predictability limits for the given initial distribution and forecast observable ( as is the case in fig .",
    "[ figmixing3torusforecast ] ) .",
    "nonparametric and ensemble forecasts of the components @xmath864 ( a , b ) , @xmath865 ( c , d ) , and @xmath866 ( e , f ) of the flat embedding into @xmath825 for the mixing dynamical system on the 3-torus .",
    "the initial probability measure has circular gaussian density relative to the haar measure with location and concentration parameters @xmath867 and @xmath320 , respectively .",
    "the nonparametric forecast is performed via algorithm  [ algstatisticalforecast ] , modified for time change as described in section  [ secimplementationt ] .",
    "the ensemble forecast is based on 10,000 independent samples drawn from the initial probability measure and evolved using the perfect model . ]      in this set of experiments , we consider the dynamical system on the 2-torus with the vector field @xmath868 , where @xmath869 and @xmath277 is an irrational frequency parameter . originally introduced by oxtoby @xcite ,",
    "flows of this class have a fixed point @xmath870 with coordinates @xmath871 , and are ergodic for the haar measure on the 2-torus .",
    "are equivalent to systems with frequency @xmath872 up to an unimportant change of sign in @xmath873 and a constant time change .",
    "] indeed , it is straightforward to check that @xmath874 vanishes everywhere on @xmath671 for the haar measure , which is a necessary and sufficient condition for the flow to be @xmath11-preserving ( see remark  [ remincompressibility ] ) . due to the presence of the fixed point , this system is not uniquely ergodic , but the haar measure is its only invariant borel probability measure for which @xmath875 . besides the haar measure , its only other ergodic borel probability measure is the trivial measure with @xmath876 .",
    "the system is topologically equivalent ( i.e. , equivalent up to homeomorphism ) to a class of dynamical systems on the 2-torus called stepanoff flows .",
    "the latter have the structure of a time - changed linear flow as in section  [ sectimechangeoverview ] , but contain a single fixed point where the time change function diverges .",
    "systems of this type are known to be topologically mixing , but we have not been able to find results on their measure - theoretic mixing properties apart from a conjecture in @xcite that a class of stepanoff flows that includes   is mixing . in summary ,",
    "the system specified in   does not in itself have the structure of a time changed flow , but is connected to a ( singular ) time changed - system system via a continuous transformation .",
    "our objective in this section is to demonstrate how the time - change methods of section  [ secimplementationt ] behave in this more general context .",
    "qualitatively , the orbit of a point @xmath877 under   will pass by the fixed point at arbitrarily small distances , but by incompressibility , the trajectory develops `` bumps '' and circumvents the fixed point when it comes close to it . because the speed of the flow can become arbitrarily slow near the fixed point , the time series of observables of this system exhibit complex behavior over a broad range of timescales , with intervals of rapid evolution separated by quasi - stationary periods .",
    "this behavior is illustrated in figure  [ figfixedpointtorusx ] for the frequency @xmath878 and the standard ( flat ) embedding of the 2-torus in @xmath879 , @xmath880 . in what follows ,",
    "we discuss dimension reduction and forecasting results for this system and observation map using a time series of 128,000 samples initialized at @xmath881 and sampled at a timestep @xmath826 .",
    "time series for the fixed - point system on the 2-torus .",
    "( a ) phase space diagram on a periodic box for 64,000 samples ; ( b , c ) components @xmath882 and @xmath883 of the standard ( flat ) embedding @xmath884 . ]",
    "first , we note that the methods of section  [ secgalerkinimplementation ] with no time change fail in the initial diffusion maps stage , as the laplace - beltrami eigenfunctions computed via algorithm  [ algbasis ] are corrupted by series of spikes ( a hallmark of ill conditioning of the heat kernel matrix @xmath885 ) .",
    "we experimented with different kernels , tuning procedures , and normalizations ( including the standard @xmath886 normalization of diffusion maps that requires no density estimation ) , but in all cases the quality of the eigenfunctions was poor .",
    "this ill - conditioning is likely caused by the behavior of the system near the fixed point , where the sampling density through finite - time trajectories has a singular , `` one - dimensional '' structure ( see fig .",
    "[ figfixedpointtorusx](a ) ) , even though the asymptotic sampling density is uniform with respect to the haar measure . on the other hand , after time change by the empirically accessible phase - space speed function @xmath793 , the quality of the eigenfunctions from diffusion maps improves markedly .",
    "we attribute this improvement to the modified riemannian metric @xmath802 from section  [ secimplementationt ] .",
    "this metric becomes degenerate near the fixed point where @xmath793 vanishes , assigning arbitrarily small norm to all tangent vectors ( this can also be seen from the fact that the kernel in   assigns near - maximal affinity to all pairs of points with small corresponding @xmath887 ) . therefore , the heat kernel associated with @xmath802 produces stronger averaging ( smoothing ) near the fixed point resulting in a well - behaved eigenfunction basis which is crucial to the success of the techniques of section  [ secimplementationt ] .    in what follows ,",
    "we work with the approximate eigenfunctions for the time - changed vector field computed using the advection - diffusion operator @xmath812 from   for the regularization parameter @xmath888 .",
    "we selected this value as a reasonable compromise between bias error and smoothness of the computed eigenfunctions after testing various candidate values of @xmath396 in the interval @xmath889 to @xmath890 .",
    "as shown in fig .",
    "[ figfixedpointtorusz ] , the generating eigenfunctions @xmath286 for this value of @xmath396 do not lie on the unit circle with the same accuracy as the earlier results in figs .  [ figtorusz ] and  [ figmixing3torusz ] . nevertheless , the eigenfunctions lie on a narrow annulus about the unit circle , and the corresponding time series have the structure of phase - modulated waves with weak amplitude modulation .",
    "the basic frequencies and dirichlet energies are @xmath891 and @xmath892 .",
    "the eigenfunction time series exhibit timescale separation , with @xmath702 evolving at faster timescales than @xmath703 , but this timescale separation has a time - dependent nature in the sense that both time series evolve slowly near the fixed point .",
    "the timescale separation between @xmath702 and @xmath703 is also evident from the scatterplots on the torus in fig .",
    "[ figfixedpointtorusz](a , d ) .",
    "there , it can be seen that the level sets of @xmath703 are aligned with the orbits of the dynamics , whereas the level sets of @xmath893 are transverse to the dynamics resulting to rapid oscillations due to frequent level - set crossings .    generating eigenfunctions @xmath702 ( a  c ) and @xmath703 ( d  f ) for the fixed point system on the 2-torus obtained via the time - change technique .",
    "( a , d ) scatterplots of @xmath707 ; ( b , e ) time series of @xmath707 ; ( c , f ) scatterplots of @xmath894 . the imaginary parts of @xmath128 are not shown in ( b , e ) for clarity , but to a good approximation they are @xmath895 phase - shifted versions of @xmath708 apart from near fixed points where that phase relationship holds less accurately . ]    figure  [ figfixedpointtorusz ] shows the vector field decomposition from lemma  [ lemmavdecompt ] associated with the generating eigenfunctions from fig .",
    "[ figfixedpointtorusv ] .",
    "this decomposition was performed using the bandwidth parameter @xmath712 , and similarly to the 3-torus example of section  [ secmixing3torus ] , the results were projected to a periodic box on the plane for visualization . with",
    "this choice of bandwidth , the time - averaged reconstruction error of the full vector field was 7% .",
    "qualitatively , the vector field component @xmath714 corresponding to @xmath702 describes a flow which is primarily directed along the @xmath705 direction , apart from a band centered around the @xmath896 line where the flow turns towards the negative @xmath704 direction and its magnitude is diminished . on the other hand , the flow described by the component @xmath715 has significant magnitude along that band , together with inflow ( outflow ) from the @xmath897 ( @xmath898 ) portions of the torus .",
    "vector field decomposition for the fixed - point system on the 2-torus .",
    "( a ) full vector field ; ( b , c ) vector field components from lemma  [ lemmavdecompt ] .",
    "all vector fields are visualized in a periodic box for the angles @xmath899 . as with fig .",
    "[ figmixing3torusv ] , the vector fields were first reconstructed in data space , @xmath879 , and subsequently projected to the periodic domain . as a result , the arrow plots in ( b , c ) are noisier than the native vector fields in @xmath879 . ]    turning now to nonparametric forecasting , we use an initial probability measure @xmath249 from the same von - mises family as the irrational flow example of section  [ secirrational ] .",
    "that is , @xmath249 has the density function in   relative to the haar measure , and in this case we set the location and concentration parameters to @xmath725 and @xmath320 , respectively",
    ". the dynamic evolution of the density for the time interval @xmath900 $ ] is illustrated with snapshots in fig .",
    "[ figfixedpointtorusrho ] and as a video in  movie  2 . with",
    "the chosen mean and concentration parameter , the initial density function is concentrated away from the fixed at point at @xmath328 . in the course of dynamical evolution , the density function wanders close to the fixed point and becomes increasingly stretched .",
    "eventually ( around @xmath901 ) , the density function appears to break up into disconnected components , but it is possible that these are artifacts caused by truncation to a finite number of basis functions and/or errors in the generating eigenfunctions and basic frequencies .",
    "snapshots of the time - dependent probability density @xmath731 relative to the equilibrium ( haar ) measure for the fixed - point system on the 2-torus .",
    "( a ) at initialization time , the density is strongly concentrated around the point @xmath732 ; ( b , c ) at early times , most of the probability mass is located away from the fixed point at @xmath328 ; ( d ) the peak of the density function approaches the fixed point and becomes highly stretched ; ( e ) eventually , the numerical density function breaks up into disconnected components . ]    to assess the forecast skill of this nonparametric model , we compare its predictions against ensemble forecast obtained from 10,000 independent samples drawn from @xmath251 and evolved using the true model from  , taking the observation - map components @xmath902 and @xmath903 as our forecast observables . as shown in fig .",
    "[ figfixedpointtorusforecast ] , over the time interval @xmath900 $ ] the mean forecast from the nonparametric model is in good agreement with the ensemble forecast .",
    "the nonparametric model also provides a reasonable uncertainty quantification through the predicted standard deviation , but as with the previous experiments the deviations from the ensemble forecast are greater for the standard deviation than the mean . in summary ,",
    "the time - change approach is particularly effective in this class of systems both in terms of the quality of the diffusion maps basis ( which is useful in other contexts besides the koopman operators studied here ) , but also as a regularization tool that transforms the dynamical system to an orbit - equivalent system with improved spectral properties .",
    "nonparametric and ensemble forecasts of the mean and standard deviation of the components @xmath326 ( a , b ) and @xmath904 ( c , d ) of the canonical ( flat ) embedding of the 2-torus in @xmath879 for the fixed - point system .",
    "the initial probability measure has the circular gaussian density in fig .",
    "[ figfixedpointtorusrho](a ) .",
    "the nonparametric forecast is performed via algorithm  [ algstatisticalforecast ] , modified for time change as described in section  [ secimplementationt ] .",
    "the ensemble forecast is based on 10,000 independent samples drawn from the initial probability measure and evolved using the perfect model . ]",
    "in this work , we developed a family of of data analysis techniques for dimension reduction , mode decomposition , and nonparametric forecasting of data generated by ergodic dynamical systems .",
    "our approach is based on the koopman formalism for nonlinear dynamical systems , where the central objects of study are groups of unitary operators governing the evolution of observables and probability measures . in certain classes of systems ( in particular , systems with pure point spectra )",
    ", the spectral properties of these operators naturally lead to algorithms for dimension reduction and mode decomposition of spatiotemporal data , featuring timescale separation and strong invariance properties under changes of observation modality .",
    "the koopman operators also provide algorithms for equation - free forecasting of probability measures and expectation values of observables through their adjoints ( the perron - frobenius operators ) . here , we develop these algorithms using a recent technique @xcite for approximating the generator of the koopman group in a complete orthonormal basis of the @xmath0 space of the dynamical system , acquired from time - ordered data through the diffusion maps algorithm @xcite . placed in context , this work has connections with a line of research by mezi , rowley , williams , kevrikedes , and others on data - driven techniques for koopman operators , with the difference that we employ a representation of the koopman group in the diffusion maps basis .",
    "we also study regularization techniques for the koopman eigenvalue problem in dynamical systems with mixing .",
    "the ability to work in a complete orthonormal basis for the @xmath0 space of the dynamical system with a well - defined notion of smoothness has a number of advantages which enable us to ( 1 ) construct nonlinear dimension reduction maps from koopman eigenfunctions with projectible dynamics and small roughness on the data manifold ; ( 2 ) decompose the generator of the koopman group into a sum of mutually commuting vector fields , which we reconstruct in data space through a spectral representation of the pushforward map for vector fields on manifolds ; ( 3 ) predict the time - evolution of arbitrary probability densities and the expectation values of observables .",
    "these techniques perform best in the setting of systems with pure point spectra , where they lead to a decomposition of nonlinear dynamical systems into uncoupled simple harmonic oscillators .",
    "we demonstrated the efficacy of these methods in numerical experiments with variable - speed flows on the torus with multiple timescales and large contrasts of the sampling density in ambient data space .",
    "another objective of this work has been to study and improve the regularity of numerically approximated eigenvalues and eigenfunctions of the koopman group , particularly for mixing dynamical systems where the generator has no nonconstant eigenfunctions . in systems with pure point spectra , we demonstrated that adding a small amount of diffusion to the generator in an appropriate basis tailored to @xmath1 regularity eliminates oscillatory eigenfunctions with large dirichlet energy for the given observation modality .",
    "this type of regularization is important even in simple systems such as irrational flows , since the spectrum of the generator is dense in the imaginary line , and contains highly oscillatory eigenfunctions near ( in the sense of the corresponding eigenvalues ) eigenfunctions with low roughness .    in mixing systems , rather than regularizing the spectrum of the generator by diffusion alone ( which is known to impart singular changes @xcite that are difficult to analyze in generality )",
    ", we followed a different approach inspired by time - change methods in dynamical systems @xcite .",
    "in particular , we developed a strategy that involves rescaling the generator by its norm in the ambient data space and using the spectrum of the rescaled generator for dimension reduction and forecasting .",
    "this transformation is empirically computable from time - ordered data , and preserves the orbits of the dynamics while changing the flow of time along the orbits . in special cases ,",
    "the transformation formally recovers a system with pure point spectrum from a class of time - changed mixing systems , but can be broadly used as an ad hoc regularization tool .",
    "we constructed analogs of our vector field decomposition and nonparametric forecasting techniques in the time - changed setting , where non - commuting vector fields and coupled oscillators encode the time - change function producing mixing .",
    "we demonstrated this approach in applications to a mixing flow on the 3-torus @xcite , and a challenging ergodic flow on the 2-torus with a fixed point @xcite where diffusion maps fails to produce a well - conditioned basis if no time change is applied .",
    "there is a number areas for future research stemming from this work .",
    "first , the methods and applications discussed in the paper are heavily focused on dynamical systems on tori .",
    "more broadly , we expect the techniques developed here to be useful in dynamical systems with kronecker factors @xcite , i.e. , systems possessing invariant subspaces of their full @xmath0 space spanned by a ( non - complete ) set of eigenfunctions of the koopman group .",
    "also , the time - change regularization strategy based on the empirical norm of the generator could be extended to other transformations having the goal of mapping the system under study to a system with improved spectral properties . at a more operational level ,",
    "the algorithms formulated in this paper are all based on spectral expansions in global tensor product bases of @xmath0 spaces , and these bases are generally inefficient in representing localized objects such as probability densities .",
    "it would be therefore fruitful to explore applications of multiscale bases ( e.g. , @xcite ) as alternatives to the global @xmath0 bases used here and in @xcite .",
    "we plan to study these topics in future work .",
    "the author would like to thank tyrus berry , peter constantin , john harlim , fanghua lin , andrew majda , lai - sang young , and jane zhao for stimulating conversations on this work .",
    "this research was supported by onr dri grant n00014 - 14 - 1 - 0150 and onr muri grant 25 - 74200-f7112 .",
    "10 url # 1`#1`urlprefixhref # 1#2#2 # 1#1        t.  sauer , time series prediction by using delay coordinate embedding , in : a.  s. weigend , n.  a. gerhsenfeld ( eds . ) , time series prediction : forecasting the future and understanding the past , vol .",
    "15 of sfi studies in the sciences of complexity , addison - wesley , 1003 , pp .",
    "175193 .                    m.  o. williams , i.  g. kevrekidis , c.  w. rowley , a data - driven approximation of the koopman operator : extending dynamic mode decomposition , j. nonlinear sci .",
    "http://dx.doi.org/10.1007/s00332-015-9258-5 [ ] .",
    "i.  p. kornfeld , y.  g. sinai , basic notions of ergodic theory and examples , in : y.  g. sinai ( ed . ) , dynamical systems , ergodic theory and applications , 2nd edition , vol .",
    "100 of encyclopedia of mathematical sciences , springer , berlin , 2000 , pp .",
    "230 .",
    "a.  katok , j .-",
    "thouvenot , spectral properties and combinatorial constructions in ergodic theory , in : b.  hasselblatt , a.  katok ( eds . ) , handbook of dynamical systems , vol .",
    "1b , north - holland , amsterdam , 2006 , ch .",
    "649743 .",
    "d.  giannakis , a.  j. majda , nonlinear laplacian spectral analysis for time series with intermittency and low - frequency variability , proc .",
    "109  ( 7 ) ( 2012 ) 22222227 . http://dx.doi.org/10.1073/pnas.1118984109 [ ] .",
    "m.  hein , j .- y .",
    "audibert , u.  von luxburg , from graphs to manifolds  weak and strong pointwise consistency of graph laplacians , in : learning theory , vol .",
    "3559 of lecture notes in computer science , springer , berlin , 2005 , pp . 470485 .",
    "http://dx.doi.org/10.1007/11503415_32 [ ] .",
    "r.  r. coifman , s.  lafon , geometric harmonics : a novel tool for multiscale out - of - sample extension of empirical functions , appl .",
    "21 ( 2006 ) 3152 . http://dx.doi.org/j.acha.2005.07.005 [ ] .",
    "n.  rabin , r.  r. coifman , heterogeneous datasets representation and learning using diffusion maps and laplacian pyramids , in : 12th siam international conference on data mining , 2012 , pp .",
    "http://dx.doi.org/10.1137/1.9781611972825.17 [ ] .",
    "r.  r. coifman , y.  shkolnisky , f.  j. sigworth , a.  singer , graph laplacian tomography from unknown random projections , ieee trans .",
    "image process .",
    "17  ( 10 ) ( 2008 ) 18911899 . http://dx.doi.org/10.1109/tip.2008.2002305 [ ] .",
    "a.  v. little , j.  lee , y .- m .",
    "jung , m.  maggioni , estimation of intrinsic dimensionality of samples from noisy low - dimensional manifolds in high dimensions with multiscale svd , in : proceedings of the 15th ieee / spworkshop on statistical signal processing , 2009 , pp .",
    ". http://dx.doi.org/10.1109/ssp.2009.5278634 [ ] .",
    "i.  babuka , j.  osborn , eigenvalue problems , in : p.  g. ciarlet , j.  l. lions ( eds . ) , finite element methods ( part 1 ) , vol .",
    "ii of handbook of numerical analysis , north - holland , amsterdam , 1991 , pp .",
    "641787 .",
    "d.  giannakis , p.  f. fischer , r.  rosner , a spectral galerkin method for the coupled orr - sommerfeld and induction equations for free - surface mhd , j. comput .",
    "228  ( 4 ) ( 2009 ) 11881233 .",
    "http://dx.doi.org/10.1016/j.jcp.2008.10.016 [ ] .",
    "w.  k. allard , g.  chen , m.  maggioni , multi - scale geometric methods for data sets ii : geometric multi - resolution analysis , appl .",
    "32  ( 3 ) ( 2012 ) 435462 .",
    "http://dx.doi.org/10.1016/j.acha.2011.08.001 [ ] ."
  ],
  "abstract_text": [
    "<S> we develop a framework for dimension reduction , mode decomposition , and nonparametric forecasting of data generated by ergodic dynamical systems . </S>",
    "<S> this framework is based on a representation of the koopman group of unitary operators in a smooth orthonormal basis of the @xmath0 space of the dynamical system , acquired from time - ordered data through the diffusion maps algorithm . using this representation , </S>",
    "<S> we compute koopman eigenfunctions through a regularized advection - diffusion operator , and employ these eigenfunctions in dimension reduction maps with projectible dynamics and high smoothness for the given observation modality . in systems with pure point spectra , we construct a decomposition of the generator of the koopman group into mutually commuting vector fields , which we reconstruct in data space through a representation of the pushforward map in the koopman eigenfunction basis </S>",
    "<S> . we also use a special property of this basis , namely that the basis elements evolve as simple harmonic oscillators , to build nonparametric forecast models for arbitrary probability densities and observables . in systems with more complex spectral behavior , including mixing systems , we develop a method inspired from time change in dynamical systems to transform the generator to a new operator with improved spectral properties , and use that operator for vector field decomposition and nonparametric forecasting .    </S>",
    "<S> koopman operators , ergodic dynamical systems , time change , nonparametric forecasting , kernel methods , diffusion maps </S>"
  ]
}