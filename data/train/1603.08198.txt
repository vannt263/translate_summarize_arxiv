{
  "article_text": [
    "given two ( di)graphs @xmath8 and @xmath3 , an _ @xmath8-tiling _ in @xmath3 is a collection of vertex - disjoint copies of @xmath8 in @xmath3 .",
    "an @xmath8-tiling is called _ perfect _ if it covers all the vertices of @xmath3 .",
    "perfect @xmath8-tilings are also referred to as _",
    "@xmath8-factors _ or _ perfect @xmath8-packings_. if @xmath8 is connected and of order at least three , the problem of deciding whether a graph @xmath3 contains a perfect @xmath8-tiling is np - complete  @xcite . in light of this , it is natural to ask for simple sufficient conditions which force a graph to contain a perfect @xmath8-tiling .",
    "a cornerstone result in extremal graph theory is the following theorem of hajnal and szemerdi  @xcite .",
    "[ hs ] every graph @xmath3 whose order @xmath1 is divisible by @xmath2 and whose minimum degree satisfies @xmath9 contains a perfect @xmath10-tiling .",
    "notice that the minimum degree condition in theorem  [ hs ] is tight .",
    "earlier , corrdi and hajnal  @xcite proved theorem  [ hs ] in the case when @xmath11 .",
    "more recently , kierstead and kostochka  @xcite gave a short proof of the hajnal  szemerdi theorem .",
    "over the last three decades there has been much work on generalising the hajnal  szemerdi theorem .",
    "one highlight in this direction is a result of khn and osthus  @xcite that characterises , up to an additive constant , the minimum degree which ensures that a graph @xmath3 contains a perfect @xmath8-tiling for an _ arbitrary _ graph @xmath8 .",
    "other notable results include an _ ore - type _ analogue of the hajnal  szemerdi theorem of kierstead and kostochka  @xcite and an _ @xmath2-partite _ version of the hajnal  szemerdi theorem of keevash and mycroft  @xcite .",
    "see  @xcite for a survey including many of the results on _ graph _ tiling .    there has also been interest in tiling problems for directed graphs and hypergraphs . a recent survey of zhao  @xcite gives an extensive overview of the latter problem . in this paper",
    "we prove a directed analogue of the hajnal  szemerdi theorem .      throughout this paper ,",
    "the digraphs we consider do not have loops and we allow for at most one edge in each direction between any pair of vertices .",
    "an oriented graph is a digraph without @xmath12-cycles .    for digraphs",
    "there is more than one natural notion of degree : the _ minimum semidegree _",
    "@xmath13 of a digraph @xmath3 is the minimum of its minimum outdegree @xmath14 and its minimum indegree @xmath15 .",
    "the _ minimum degree _",
    "@xmath16 of @xmath3 is the minimum number of edges incident to a vertex in @xmath3 .    for oriented graphs ,",
    "there has been some progress on obtaining degree conditions that force tilings .",
    "denote by @xmath17 the transitive tournament of @xmath2 vertices and by @xmath18 the cyclic triangle .",
    "yuster  @xcite observed that an oriented graph @xmath3 on @xmath19 vertices and with @xmath20 contains a perfect @xmath21-tiling ( and also gave a minimum degree condition which forces a perfect @xmath17-tiling for @xmath22 ) .",
    "more recently , balogh , lo and molla  @xcite determined the minimum semidegree threshold which ensures a perfect @xmath21-tiling in an oriented graph , thereby resolving a conjecture from  @xcite .",
    "keevash and sudakov  @xcite showed that every oriented graph @xmath3 on @xmath1 vertices with @xmath23 contains a @xmath18-tiling covering all but at most @xmath24 vertices .",
    "( there are examples that show even @xmath25 does not guarantee a perfect @xmath18-tiling . )",
    "denote by @xmath26 the set of all tournaments on @xmath2 vertices .",
    "let @xmath27 . for digraphs ,",
    "the minimum semidegree threshold that forces a perfect @xmath28-tiling was characterised in  @xcite .",
    "[ tregthm]@xcite given an integer @xmath29 , there exists an @xmath30 such that the following holds .",
    "suppose @xmath27 and @xmath3 is a digraph on @xmath31 vertices where @xmath2 divides @xmath1 . if @xmath32 then @xmath3 contains a perfect @xmath28-tiling .",
    "notice that the minimum semidegree condition in theorem  [ tregthm ] is tight .",
    "note also that theorem  [ tregthm ] implies the hajnal ",
    "szemerdi theorem for large graphs",
    ". an earlier result of czygrinow , kierstead and molla  @xcite gives an asymptotic version of theorem  [ tregthm ] for perfect @xmath18-tilings .",
    "it is natural to ask whether theorem  [ tregthm ] can be strengthened by replacing the _ minimum semidegree _",
    "condition with a _ minimum degree _ condition .",
    "in particular , can one replace the minimum semidegree condition in theorem  [ tregthm ] with @xmath33 ? however , when @xmath34 the answer is no .",
    "indeed , an example of wang  @xcite shows that @xmath35 does not ensure a perfect @xmath18-tiling . on the other hand",
    ", he showed that minimum degree @xmath36 does force a perfect @xmath18-tiling in a digraph @xmath3 .",
    "this led to the following question being raised in  @xcite .",
    "[ ques1 ] let @xmath37 such that @xmath2 divides @xmath1 .",
    "let @xmath38 .",
    "does every digraph @xmath3 on @xmath1 vertices with @xmath33 contain a perfect @xmath28-tiling ?",
    "czygrinow , debiasio , kierstead and molla  @xcite answered question  [ ques1 ] in the affirmative for perfect @xmath17-tilings and also in the case when    the main result of this paper gives an exact solution to a stronger version of question  [ ques1 ] for _ all _ @xmath39 .",
    "[ mainthm ] given an integer @xmath39 , there exists an @xmath30 such that the following holds .",
    "suppose @xmath3 is a digraph on @xmath31 vertices where @xmath2 divides @xmath1 .",
    "if @xmath40 then @xmath3 contains @xmath5 vertex - disjoint subdigraphs each of which contains every tournament on @xmath2 vertices .    the following theorem from @xcite , in some sense , answers the analogous question when @xmath11 .    [ mainthmr3]@xcite suppose @xmath3 is a digraph on @xmath1 vertices where @xmath24 divides @xmath1 .",
    "if @xmath41 , then there exist @xmath42 vertex - disjoint subdigraphs each of size @xmath24 such that each subdigraph contains a @xmath21 and all but at most one contains @xmath18 as well .",
    "this is best possible in the following two senses : ( i ) there exist digraphs @xmath3 for which @xmath43 and which do not contain a triangle factor of _ any _ kind and ; ( ii ) by wang s example in  @xcite , there exist digraphs such that @xmath44 that do not have a perfect @xmath18-tiling .",
    "however , there is perhaps more to say about the case when @xmath11 , as the following conjecture , which originally appeared in @xcite , suggests .",
    "[ conj:2strong]@xcite suppose @xmath3 is a digraph on @xmath1 vertices where @xmath24 divides @xmath1 .",
    "if @xmath41 and @xmath3 is strongly @xmath12-connected , then there exist @xmath42 vertex - disjoint subdigraphs such that each of these subdigraphs contain both @xmath21 and @xmath18 .",
    "it should be noted that in  @xcite conjecture  [ conj:2strong ] was proven when @xmath45 .",
    "note that when @xmath45 , @xmath3 is strongly @xmath12-connected .      instead of proving theorem  [ mainthm ] directly , we will prove a more general result concerning tilings in multigraphs .",
    "a similar approach was taken in @xcite and @xcite .",
    "suppose that @xmath46 is a multigraph .",
    "the _ minimum degree _",
    "@xmath47 of @xmath46 is the minimum number of edges incident to a vertex in @xmath46 .",
    "for @xmath48 we write @xmath49 to denote the number of edges between @xmath50 and @xmath51 in @xmath46 .",
    "we say that a loopless multigraph @xmath46 is _ standard _ if @xmath52 for all @xmath48 .",
    "given vertices @xmath53 in a standard multigraph @xmath46 we say that @xmath54 is a _ light edge _ if @xmath55 and a _ heavy edge _",
    "if @xmath56 .    given a digraph @xmath3 , the _ underlying multigraph _",
    "@xmath46 of @xmath3 is the standard multigraph obtained from @xmath3 by ignoring the orientations of edges .",
    "given a standard multigraph @xmath46 , an orientation of the edges is _ legal _ if the resulting graph @xmath3 is a digraph ( i.e. there is at most one edge in each direction between any pair of vertices in @xmath3 ) .",
    "a standard multigraph @xmath46 on @xmath2 vertices is _ universal _ if , given any legal orientation @xmath3 of @xmath46 , we have that @xmath57 for _ every _ @xmath27 .",
    "for example , let @xmath46 be a standard multigraph on @xmath2 vertices where @xmath58 for all distinct @xmath59 and the collection of light edges in @xmath46 forms a matching",
    ". then @xmath46 is universal . on the other hand",
    "if @xmath46 is a standard multigraph on @xmath1 vertices that contains a cycle on light edges then @xmath46 is not universal .",
    "( there is a legal orientation of @xmath46 without a copy of @xmath17 . )",
    "write @xmath60 for the set of all universal standard multigraphs on @xmath2 vertices .    given a collection of ( multi)graphs @xmath61 , an _ @xmath61-tiling _ in a ( multi)graph @xmath46 is a collection of vertex - disjoint copies of elements of @xmath61 in @xmath46 .",
    "an @xmath61-tiling is called _ perfect _ if it covers all the vertices of @xmath46 .",
    "we refer to the elements of an @xmath61-tiling as _ tiles_. the next result ( originally conjectured in @xcite ) ensures a standard multigraph of high minimum degree contains a perfect @xmath60-tiling .",
    "[ mainthm2 ] given an integer @xmath39 , there exists an @xmath30 such that the following holds .",
    "suppose @xmath46 is a standard multigraph on @xmath31 vertices where @xmath2 divides @xmath1 .",
    "if @xmath62 then @xmath46 contains a perfect @xmath60-tiling .",
    "notice that theorem  [ mainthm2 ] implies theorem  [ mainthm ] .",
    ", title=\"fig : \" ] , title=\"fig : \" ] , title=\"fig : \" ] , title=\"fig : \" ]    there are four different examples which show that the minimum degree condition in theorem  [ mainthm2 ] is tight .",
    "let @xmath63 and @xmath64 be standard multigraphs on @xmath1 vertices which contain all possible edges except that @xmath63 contains an independent set @xmath65 of size @xmath66 and @xmath64 contains a set @xmath65 of size @xmath67 such that between any two distinct vertices @xmath68 @xmath69 . for both @xmath70 , @xmath71 ,",
    "but @xmath72 does not contain a perfect @xmath60-tiling .",
    "in the case of @xmath63 , this is because every element in @xmath60 has at most @xmath73 vertex in @xmath65 and in the case of @xmath64 , it is because every element in @xmath60 has at most @xmath12 vertices in @xmath65 .",
    "suppose @xmath5 is odd .",
    "we define the standard multigraph @xmath74 on @xmath1 vertices as follows : take two disjoint sets @xmath75 of size @xmath5 . inside the sets @xmath75 place all heavy edges , and between @xmath76 and @xmath77 place no edges . from @xmath78 to the remaining vertices , place all heavy edges .",
    "now partition the remaining @xmath79 vertices into sets of size @xmath5 or @xmath80 . between all such sets ,",
    "place all heavy edges .",
    "inside the sets of size @xmath80 place all light edges and inside the sets of size @xmath5 place no edges .",
    "we have @xmath81 .",
    "if @xmath74 contained a perfect @xmath82-tiling , each copy of @xmath82 would intersect the sets of size @xmath5 from @xmath83 in exactly one vertex and the sets of size @xmath80 in exactly two vertices , and furthermore every copy of @xmath82 has exactly @xmath12 vertices from @xmath76 or exactly @xmath12 vertices from @xmath77 .",
    "however , since @xmath84 and @xmath85 are odd , @xmath74 does not contain a perfect @xmath82-tiling .",
    "suppose @xmath86 .",
    "we form the standard multigraph @xmath87 on @xmath1 vertices similarly : take two disjoint sets @xmath75 of size @xmath80 . inside the sets",
    "@xmath75 place all heavy edges and between @xmath76 and @xmath77 , place all light edges . from @xmath78 to the remaining vertices , place all heavy edges .",
    "now partition the remaining @xmath88 vertices into sets of size @xmath5 or @xmath80 . between all such sets ,",
    "place all heavy edges .",
    "inside the sets of size @xmath80 place all light edges and inside the sets of size @xmath5 place no edges .",
    "we have @xmath89 .",
    "consider the standard multigraph @xmath90 with @xmath2 vertices in which there are all possible edges except that there is a vertex with precisely three light neighbours . if @xmath91 it is easy to check that @xmath90 is not universal ( however , it is universal for @xmath92 ) . with this in mind",
    ", suppose that @xmath91 . then if @xmath87 contained a perfect @xmath82-tiling , each copy of @xmath82 would intersect the sets of size @xmath5 from @xmath93 in exactly one vertex and the sets of size @xmath80 in exactly two vertices , and furthermore every copy of @xmath82 has exactly @xmath94 vertices from @xmath76 or exactly @xmath94 vertices from @xmath77 .",
    "however , since @xmath84 and @xmath85 are not divisible by @xmath94 , @xmath87 does not contain a perfect @xmath82-tiling . note that if @xmath92 then @xmath87 does actually contain a perfect @xmath82-tiling .    throughout the paper , instead of dealing with the set @xmath60 itself , we will mainly work with three subsets of @xmath60 : @xmath95 , @xmath96 and @xmath97 .",
    "the elements of each of these three subsets are obtained from the complete standard multigraph on @xmath2 vertices by removing the edges from a set of vertex - disjoint ( light ) paths @xmath98 where @xmath99 .",
    "the elements of @xmath95 are formed by removing the edges of @xmath98 from the complete standard multigraph on @xmath2 vertices where we stipulate that @xmath100 for all @xmath101 $ ] , i.e.  the elements of @xmath95 are formed by removing a ( light ) matching from the complete standard multigraph on @xmath2 vertices .",
    "the elements of @xmath96 are formed in the same way , but we stipulate that @xmath102 and @xmath100 for all @xmath103 . to form elements of @xmath97 , we stipulate that either @xmath104 and @xmath100 for all @xmath103 , or @xmath105 and @xmath100 for all @xmath106 . in the proof of theorem  [ mainthm2 ]",
    "we ( implicitly ) produce a perfect @xmath60-tiling where _ most _ of the tiles are elements from @xmath95 ( in fact , we actually we produce a perfect @xmath97-tiling ) .",
    "the following example , however , demonstrates that we need the minimum degree to be greater than @xmath107 to guarantee a perfect @xmath95-tiling . for any @xmath108 and @xmath109 , let @xmath3 be a standard multigraph containing @xmath110 vertices constructed in the following way .",
    "let @xmath111 be a partition of @xmath112 such that @xmath113 , @xmath114 and @xmath115 for @xmath116 .",
    "place all possible light edges between @xmath117 and @xmath118 , and for all other pairs of distinct sets @xmath119 and @xmath120 , place all possible heavy edges .",
    "also , inside inside both @xmath121 $ ] and @xmath122 $ ] place all possible heavy edges .",
    "the minimum degree of @xmath3 is @xmath123 , which is witnessed by any @xmath124 .",
    "now suppose that @xmath3 contains @xmath125 vertex - disjoint elements from @xmath95 .",
    "each one of these elements must have exactly @xmath73 vertex in each of @xmath126 and exactly @xmath24 vertices in @xmath127 $ ] ; however , @xmath127 $ ] does not contain a perfect @xmath128-tiling .",
    "note that when @xmath11 , this corresponds to wang s example in @xcite .    as mentioned above ,",
    "in the proof of theorem  [ mainthm2 ] we actually produce a perfect @xmath97-tiling .",
    "notice that for _ any _ @xmath129 , @xmath87 does not contain a perfect @xmath97-tiling .",
    "so this multigraph is an extremal example for the perfect @xmath97-tiling problem for every @xmath129 .",
    "we now prove that @xmath130 for @xmath129 . while this follows from a very strong result of havet and thomass @xcite , which states that every tournament @xmath28 on @xmath1 vertices contains every oriented path @xmath131 on @xmath1 vertices except when @xmath131 is the anti - directed path and @xmath132 ,",
    "we prove it directly as we do not need the full strength of their result .    for @xmath133 , @xmath134 and for @xmath6 , @xmath130 .",
    "let @xmath133 , @xmath28 be a tournament on @xmath2 vertices , and let @xmath135 be a legal orientation of @xmath136 , where @xmath135 has exactly @xmath137 light edges .",
    "form a bijection from @xmath138 to @xmath139 by choosing @xmath140 independent edges in @xmath28 and mapping their endpoints to the light edges of @xmath135 with the correct orientation .",
    "then complete the bijection by mapping all other vertices of @xmath28 to @xmath139 arbitrarily .",
    "since all other edges of @xmath135 are double edges , we have @xmath141 .",
    "let @xmath129 , @xmath28 be a tournament on @xmath2 vertices , and let @xmath135 be a legal orientation of @xmath142 , where the light edges of @xmath135 form @xmath140 vertex - disjoint paths @xmath143 with @xmath144 where either @xmath104 and @xmath100 for all @xmath103 , or @xmath105 and @xmath100 for all @xmath106 .",
    "the statement follows from the following two facts which are straightforward to verify : ( 1 ) every tournament on @xmath94 vertices contains every orientation of a path on @xmath94 vertices ; ( 2 ) every tournament on @xmath145 vertices contains two vertex - disjoint transitive triangles .",
    "we use this to first find an isomorphic copy of @xmath146 and @xmath147 ( if applicable ) in @xmath28 , then we complete the embedding as in the first paragraph .",
    "as with many proofs in the area , the proof of theorem  [ mainthm2 ] divides into _ extremal _ and _ non - extremal _ cases . roughly speaking ,",
    "in the extremal case we consider those standard multigraphs that are ` close ' to the extremal examples @xmath63 , @xmath64 , @xmath74 and @xmath87 that were introduced after the statement of theorem  [ mainthm2 ]",
    ". we deal with these extremal cases in one unified approach in section  [ extremal ] .",
    "suppose that @xmath3 is as in theorem  [ mainthm2 ] .",
    "further , suppose that there is a ` small ' set @xmath148 with the property that both @xmath149 $ ] and @xmath150 $ ] contain perfect @xmath60-tilings for _ any _ ` very small ' set @xmath151 where @xmath152 . then notice that , to find a perfect @xmath60-tiling in @xmath3 , it suffices to find an ` almost ' perfect @xmath60-tiling in @xmath153 .",
    "indeed , suppose that @xmath154 contains a @xmath60-tiling @xmath155 covering all but a very small set of vertices @xmath156 . then by definition of @xmath46 ,",
    "@xmath150 $ ] contains a perfect @xmath60-tiling @xmath157 .",
    "thus , @xmath158 is a perfect @xmath60-tiling in @xmath3 , as desired .",
    "roughly speaking , we refer to such a set @xmath46 as an ` absorbing set ' ( see section  [ secabs ] for the precise definition of such a set ) .",
    "the ` absorbing method ' was first used in  @xcite and has subsequently been applied to numerous embedding problems in extremal graph theory .    in general , a multigraph @xmath3 as in theorem  [ mainthm2 ] may not contain an absorbing set .",
    "indeed , consider the multigraph @xmath3 with disjoint vertex classes @xmath159 each of size @xmath5 in which there are all possible heavy edges except that each @xmath160 is an independent set .",
    "then if @xmath156 is any set of @xmath2 vertices in @xmath161 , there is no set @xmath148 such that both @xmath149 $ ] and @xmath150 $ ] contain perfect @xmath60-tilings .",
    "note that this multigraph is close to the extremal example @xmath63 .",
    "it turns out that when @xmath3 is non - extremal , we can _ always _ find an absorbing set @xmath46 ; we construct this set in section  [ secabs ] .    thus , to complete the proof in the non - extremal case we must find an ` almost ' perfect @xmath60-tiling in @xmath162 . actually in section  [ sec6 ] we prove a result that ensures _ any _ multigraph @xmath3 as in theorem  [ mainthm2 ] contains a @xmath163-tiling covering almost all the vertices of @xmath3 , see corollary  [ almostthm_cor ] . however , this does not quite guarantee a large enough @xmath164-tiling in @xmath162 .",
    "indeed , the leftover set @xmath156 obtained by applying corollary  [ almostthm_cor ] to @xmath162 will be slightly larger than the absorbing set @xmath46 , and thus @xmath46 will not be able to absorb @xmath156 .    to overcome this we again have to use the property that our multigraph @xmath3 is non - extremal .",
    "using the @xmath163-tiling obtained from corollary  [ almostthm_cor ] we build a significantly bigger @xmath165-tiling so that now the leftover set is very small compared to @xmath46 .",
    "this is another delicate part of the proof and is dealt with in section  [ sec7 ] .    in section  [ sec6 ]",
    "we will apply a turn - type result for standard multigraphs ; this is introduced in section  [ secturan ] ( see theorem  [ dituran ] ) .",
    "we also introduce a multigraph regularity lemma in section  [ secreg ] and make use of this in sections  [ sec6 ] and  [ sec7 ] .",
    "for the rest of the paper , when we write multigraph , we mean standard multigraph . let @xmath3 be a multigraph .",
    "we write @xmath166 for the total number of edges in @xmath3 and @xmath167 for the number of heavy edges in @xmath3 . given a subset @xmath168 , we write @xmath169 $ ] for the submultigraph of @xmath3 induced by @xmath76 .",
    "we write @xmath170 for the submultigraph of @xmath3 induced by @xmath171 and define @xmath172 .    in a multigraph @xmath3 , for @xmath70 let @xmath173 and @xmath174 .",
    "let @xmath175 .",
    "we define the _ degree @xmath176 of @xmath177 _ to be the sum of the multiplicities of the edges incident with @xmath177 , i.e. @xmath178 .",
    "note that @xmath179 .",
    "given a set @xmath168 ( or subgraph @xmath76 of @xmath3 ) we write @xmath180 for the total number of edges in @xmath3 incident to @xmath177 whose other endpoint lies in @xmath76 ( or @xmath181 ) .",
    "we define @xmath182 similarly .",
    "given disjoint @xmath183 ( or subgraphs @xmath184 of @xmath3 ) we write @xmath185 for the total number of edges in @xmath3 with one endpoint in @xmath76 ( or @xmath181 ) and the other in @xmath77 ( or @xmath186 ) ; we write @xmath187 for the total number of heavy edges in @xmath3 with one endpoint in @xmath76 ( or @xmath181 ) and the other in @xmath77 ( or @xmath186 ) , and let @xmath188 denote the set of all such edges . in all the aforementioned notation we omit the subscript @xmath3 if the multigraph is clear from the context .",
    "when @xmath189 is a family of multigraphs ( digraphs ) and @xmath3 is a multigraph ( digraph ) we write @xmath190 to mean that some @xmath191 is a subgraph of @xmath3 .",
    "if @xmath191 we say that @xmath65 is a _ copy of @xmath189_. if @xmath189 is a family of multigraphs and @xmath3 is a digraph we write @xmath190 to mean that there is a legal orientation @xmath192 of some @xmath191 such that @xmath192 is a subdigraph of @xmath3 .    given a graph @xmath3",
    "we let @xmath193 denote the graph obtain from @xmath3 by replacing each vertex @xmath194 with a set @xmath195 of @xmath140 vertices so that , for all @xmath196 :    * if @xmath197 then @xmath198 ; * if @xmath199 then there are all possible edges in @xmath193 between @xmath195 and @xmath200 ; * if @xmath201 then there are no edges in @xmath193 between @xmath195 and @xmath200 .    similarly , given a multigraph @xmath3 we let @xmath193 denote the multigraph obtain from @xmath3 by replacing each vertex @xmath194 with a set @xmath195 of @xmath140 vertices so that , for all @xmath196 :    * if @xmath197 then @xmath198 ; * if @xmath202 in @xmath3 then there are all possible heavy edges in @xmath193 between @xmath195 and @xmath200 ; * if @xmath55 in @xmath3 then there are all possible light edges in @xmath193 between @xmath195 and @xmath200 . * if @xmath203 in @xmath3 then there are no edges in @xmath193 between @xmath195 and @xmath200 .    given a set @xmath76 we write , for example @xmath204 , @xmath205 and @xmath206 for @xmath207 , @xmath208 and @xmath209 respectively . similarly given multigraphs @xmath28 , @xmath3 where @xmath210 and @xmath211 , we write , for example , @xmath212 , @xmath213 , @xmath214 for the multigraphs @xmath215 $ ] , @xmath216 $ ] and @xmath217 $ ] respectively .",
    "we define , for example , @xmath218 , @xmath219 , @xmath220 similarly where @xmath183 .    throughout the paper ,",
    "we write @xmath221 to mean that we can choose the constants @xmath222 from right to left . more precisely ,",
    "there are increasing functions @xmath223 and @xmath224 such that , given @xmath225 , whenever we choose @xmath226 and @xmath227 , all calculations needed in our proof are valid .",
    "hierarchies of other lengths are defined in the obvious way .",
    "in this section we determine the density threshold that ensures a standard multigraph contains a universal graph , and therefore determine the threshold that forces a digraph to contain any tournament of a given size .",
    "let @xmath228 be the maximum number of edges in an @xmath229-partite graph on @xmath1 vertices and let @xmath230 be the @xmath229-partite graph that realises this bound .",
    "note that when @xmath231 @xmath232 and for any @xmath1 @xmath233 with equality when @xmath234 divides @xmath1 .",
    "[ obs1 ] let @xmath235 be the digraph obtained by replacing every edge of @xmath230 with two oppositely oriented directed edges and let @xmath236 be the underlying multigraph of @xmath235 .",
    "then @xmath235 contains no tournament on @xmath2 vertices and @xmath236 contains no graph on @xmath2 vertices whose underlying graph is complete .",
    "brown and harary @xcite proved that if a digraph @xmath237 on @xmath1 vertices contains more than @xmath238 edges , then @xmath237 contains every tournament on @xmath2 vertices .",
    "the following theorem strengthens their result by showing that @xmath237 contains subdigraph of @xmath237 on @xmath2 vertices which itself contains every tournament on @xmath2 vertices ; in fact , we prove an even more general result about multigraphs .",
    "[ dituran ] let @xmath133 and let @xmath3 be a multigraph on @xmath1 vertices . if @xmath239 , then @xmath240 .",
    "the proof proceeds by double induction on @xmath2 and @xmath1 .",
    "clearly the result holds for @xmath241 .",
    "let @xmath242 and let @xmath3 be a standard multigraph on @xmath1 vertices such that @xmath243 .",
    "if @xmath244 , then @xmath245 ; so suppose @xmath246 .",
    "either @xmath247 , or by induction , there exists a copy of @xmath248 in @xmath3 ; let @xmath8 be a copy of @xmath248 with the maximum number of edges . if there exists @xmath249 such that @xmath250 , then we can either add @xmath177 to @xmath8 to make a copy of @xmath251 or we can swap @xmath177 with a vertex in @xmath8 to increase the number of edges in @xmath8 ; either way , a contradiction .",
    "so for all @xmath249 we have @xmath252 .",
    "thus by and induction on @xmath1 , @xmath253    [ cc2 ] let @xmath3 be a multigraph on @xmath1 vertices . if @xmath254 or @xmath255 , then @xmath256 .",
    "first note that theorem  [ dituran ] and corollary  [ cc2 ] immediately imply the analogous digraph versions .",
    "observation  [ obs1 ] shows that the density conditions in theorem  [ dituran ] and corollary  [ cc2 ] to force a copy of @xmath257 are best - possible ; however , one may wonder if the same density conditions could force a multigraph @xmath258 whose complement contains a matching on at most @xmath259 light edges .",
    "the following observation shows that this is not the case .",
    "let @xmath258 be a multigraph on @xmath2 vertices such that the complement of @xmath258 is a matching with at most @xmath259 light edges .",
    "if @xmath2 is even , let @xmath260 and if @xmath2 is odd , let @xmath261 . for sufficiently large @xmath1 , there exists a multigraph @xmath3 on @xmath1 vertices with ( significantly ) more than @xmath238 edges for which @xmath262 .",
    "first suppose @xmath2 is even and @xmath263 .",
    "let @xmath3 be an @xmath264-partite multigraph with all parts of size @xmath265 .",
    "inside each part put all possible light edges and between the parts put all possible heavy edges .",
    "we have @xmath266 which is much larger than @xmath267 .",
    "now suppose @xmath2 is odd and @xmath268 .",
    "let @xmath3 be an @xmath269-partite multigraph with all parts of size @xmath270 .",
    "inside each part put all possible light edges and between the parts put all possible heavy edges .",
    "we have @xmath271 which is much larger than @xmath267 .",
    "note that in each case @xmath3 contains no copy of @xmath258 .",
    "finally , we address the issue of the structure of @xmath257-free multigraphs with @xmath238 edges .",
    "let @xmath272 be the family of digraphs obtained by partitioning @xmath1 as @xmath273 such that @xmath274 are positive integers and at most one of the @xmath275s is odd , and taking @xmath276 disjoint copies , @xmath277 of @xmath278 , then adding all edges directed from @xmath279 to @xmath280 for all @xmath281 .",
    "in particular , note that @xmath282 .",
    "brown and harary  @xcite proved that if @xmath283 and @xmath237 is a @xmath28-free digraph on @xmath1 vertices with @xmath238 edges , then @xmath284 unless @xmath34 in which case @xmath285 .",
    "the following observation shows that in our case , there is a whole family of tightness examples .",
    "let @xmath286 be the family of multigraphs underlying the digraphs in @xmath272 .",
    "given @xmath129 , let @xmath287 and let @xmath288 be the family of multigraphs on @xmath1 vertices which can be obtained from @xmath236 by the following process .",
    "take disjoint pairs of colour classes and replace each such pair with a copy of @xmath289 , leaving all other edges between the sets as they were .",
    "then every @xmath290 does not contain @xmath163 .",
    "let @xmath290 , let @xmath291 be the colour classes from @xmath46 which were not modified , and let @xmath292 be the sets from @xmath46 which appeared as a result of merging two of the original colour classes .",
    "we have @xmath293 and thus any copy of @xmath257 must contain at least @xmath12 vertices from some @xmath294 , which is clearly not possible , or at least @xmath24 vertices from some @xmath295 , which would imply that @xmath295 contains a copy of @xmath296 , which is not the case . thus @xmath297 .",
    "it would be interesting to determine whether every @xmath257-free multigraph on @xmath238 edges is a member of @xmath288 , and more generally , whether every @xmath257-free multigraph on @xmath298 edges is sufficiently `` close '' ( in edit - distance ) to some member of @xmath288 .",
    "in the proof of theorems  [ mainthm2 ] and  [ almostthm_stability ] we will apply a version of szemerdi s regularity lemma  @xcite for multigraphs .",
    "before we state it we need some more definitions .",
    "the _ density _ of a bipartite graph @xmath299 with vertex classes  @xmath300 and  @xmath301 is defined to be @xmath302 we will write @xmath303 if this is unambiguous .",
    "given any @xmath304 we say that  @xmath3 is _ @xmath305-regular _ if for all @xmath306 and @xmath307 with @xmath308 .",
    "given disjoint vertex sets  @xmath300 and  @xmath301 in a graph  @xmath3 , we write @xmath309 for the induced bipartite subgraph of  @xmath3 whose vertex classes are  @xmath300 and  @xmath301 . if @xmath3 is a multigraph and @xmath310 are disjoint , then we write @xmath311 for the bipartite _ graph _ with vertex classes @xmath300 and @xmath301 where @xmath312 and @xmath313 are adjacent in @xmath314 precisely if @xmath315 in @xmath3 .",
    "the next well - known observation ( see  @xcite for example ) states that a large subgraph of a regular pair is also regular .",
    "[ slice ] let @xmath316 and @xmath317 .",
    "let @xmath309 be an @xmath318-regular pair of density @xmath319 .",
    "suppose @xmath320 and @xmath321 where @xmath322 and @xmath323 .",
    "then @xmath324 is an @xmath325-regular pair with density @xmath326 where @xmath327 .",
    "the following result will be applied in the proof of theorem  [ almostthm ] .",
    "it is ( for example ) a special case of corollary 2.3 in  @xcite .",
    "[ red ] let @xmath328 and @xmath329 such that @xmath330 and @xmath331 .",
    "let @xmath8 be a graph obtained from @xmath10 by replacing every vertex of @xmath10 with @xmath332 vertices and replacing each edge of @xmath10 with an @xmath333-regular pair of density at least @xmath319 .",
    "then @xmath8 contains a @xmath334-tiling covering all but at most @xmath335 vertices .",
    "we apply the following version of the regularity lemma , which is an immediate corollary of a @xmath12-coloured regularity lemma from  @xcite ( theorem  2.4 ) .",
    "this result in turn is easy to derive from the many - colour regularity lemma presented in  @xcite ( theorem  1.18 ) .",
    "[ 2colordegreeform ] for any @xmath336 and @xmath337 , there exists @xmath338 such that the following holds .",
    "let @xmath3 be a standard multigraph on @xmath1 vertices and let @xmath339 .",
    "then there exists a partition @xmath340 of @xmath112 with @xmath341 and a spanning subgraph @xmath154 of @xmath3 with the following properties :    1 .",
    "@xmath342 ; 2 .",
    "all clusters @xmath160 , @xmath343 $ ] , are of the same size @xmath344 ; 3 .",
    "@xmath345 for all @xmath346 ; 4 .",
    "@xmath347 ) = 0 $ ] for all @xmath348 $ ] ; 5 .   for all @xmath349 and @xmath350 $ ]",
    ", the pair @xmath351 is @xmath352-regular with density either 0 or at least @xmath319 .",
    "we call @xmath353 _ clusters _ , @xmath354 the _ exceptional set _ and @xmath154 the _",
    "pure multigraph_. given a multigraph @xmath3 , and parameters @xmath355 , we define the _ reduced multigraph @xmath356 _ as follows : let @xmath357 be the partition and @xmath154 be the subgraph of @xmath3 obtained from an application of lemma  [ 2colordegreeform ] with parameters @xmath355 .",
    "we let @xmath358 and ( i ) if @xmath359 has density at least @xmath319 we place a heavy edge between @xmath160 and @xmath360 in @xmath356 ; ( ii ) if @xmath359 has density @xmath361 and @xmath362 has density at least @xmath319 we place a light edge between @xmath160 and @xmath360 in @xmath356 ; ( iii ) otherwise @xmath160 and @xmath360 are not adjacent in @xmath356 .",
    "the next result implies that the minimum degree of a multigraph is almost inherited by its reduced multigraph .",
    "[ inherit ] let @xmath336 , @xmath363 $ ] , @xmath364 and let @xmath3 be a multigraph on @xmath1 vertices .",
    "let @xmath154 be the pure multigraph and @xmath356 be the reduced multigraph obtained by applying lemma [ 2colordegreeform ] to @xmath3 with parameters @xmath352 , @xmath319 and @xmath365",
    ". then @xmath366 .",
    "note that for all @xmath367 , @xmath368 let @xmath369 . notice that @xmath370 intersects at least @xmath371 clusters and thus by lemma [ 2colordegreeform ]",
    ", @xmath372 also note that @xmath373 intersects at least @xmath374 clusters and thus by lemma [ 2colordegreeform ] , @xmath375 altogether this gives @xmath376 therefore @xmath366 , as claimed .",
    "in order to prove theorem  [ mainthm2 ] , we will apply ( a corollary of ) the following result . roughly speaking ,",
    "it states that every standard multigraph with minimum degree slightly greater than that in theorem  [ mainthm2 ] contains an almost perfect @xmath377-tiling .",
    "[ almostthm ] let @xmath378 where @xmath379 and @xmath380 such that @xmath381 .",
    "suppose that @xmath3 is a standard multigraph on @xmath1 vertices such that @xmath382 then @xmath3 contains a @xmath257-tiling covering all but at most @xmath383 vertices .",
    "the next result is the key tool in the proof of theorem  [ almostthm ] .",
    "[ expand ] let @xmath384 and @xmath385 be integers such that @xmath386 .",
    "let @xmath3 be a standard multigraph on @xmath1 vertices so that @xmath387 further , suppose that the largest @xmath257-tiling in @xmath3 covers precisely @xmath388 vertices .",
    "then there exists a @xmath389-tiling in @xmath3 that covers at least @xmath390 vertices .",
    "certainly theorem  [ dituran ] and ( [ min ] ) imply that @xmath391 .",
    "let @xmath392 denote a @xmath257-tiling in @xmath3 containing precisely @xmath393 vertices so that the total number of edges in @xmath392 is maximised .",
    "set @xmath394 and @xmath395 .",
    "[ claimy ] there are at least @xmath396 vertices @xmath397 such that @xmath398 .",
    "suppose for a contradiction the claim is false . then by ( [ min ] ) , at least @xmath399 vertices @xmath400 are such that @xmath401 .",
    "thus by theorem  [ dituran ] , @xmath402 contains a copy of some @xmath403 .",
    "but then together with @xmath392 , this forms a @xmath377-tiling on @xmath404 vertices in @xmath3 , a contradiction to the maximality of @xmath392 .",
    "this proves the claim .",
    "given any @xmath397 such that @xmath405 , there are at least @xmath396 elements @xmath65 in @xmath392 so that @xmath406 .",
    "if @xmath407 , then since @xmath403 , @xmath408 spans a copy of an element of @xmath409 in @xmath3 .",
    "otherwise there is precisely one vertex @xmath410 such that @xmath54 is a light edge .",
    "suppose that for some @xmath411 , @xmath412 is a light edge in @xmath3 .",
    "then since there are all possible edges between @xmath50 and @xmath413 , @xmath414 spans a copy of some @xmath415 such that @xmath416 .",
    "this is a contradiction to the choice of @xmath392 .",
    "thus for all @xmath417 , @xmath418 is a heavy edge .",
    "this implies that @xmath419 spans a copy of some @xmath420 .",
    "claim  [ claimy ] implies there are at least @xmath396 vertices @xmath397 such that @xmath421 .",
    "so for at least @xmath396 such vertices @xmath50 , we can pair them off with distinct elements @xmath65 of @xmath392 so that @xmath419 spans a copy of an element of @xmath409 .",
    "this therefore implies that there exists a @xmath389-tiling in @xmath3 that covers at least @xmath390 vertices , as desired .",
    "the next simple observation will be used in the proof of theorem  [ almostthm ] to convert a @xmath422-tiling in the reduced multigraph @xmath356 of @xmath3 into a @xmath95-tiling in the blow - up @xmath423 of @xmath356 .",
    "[ fact2 ] suppose that @xmath424 such that @xmath2 divides @xmath140 .",
    "if @xmath425 then @xmath426 contains a perfect @xmath95-tiling .",
    "we are now ready to prove theorem  [ almostthm ] .",
    "we will repeatedly apply lemma  [ expand ] and fact  [ fact2 ] to obtain an almost perfect @xmath95-tiling in a blow - up of the reduced multigraph of @xmath3 .",
    "applying lemma  [ red ] will then yield an almost perfect @xmath95-tiling in @xmath3 .",
    "arguments of a similar nature were applied in  @xcite .",
    "* proof of theorem  [ almostthm ] . *",
    "define additional constants @xmath427 and @xmath428 so that @xmath429",
    ". set @xmath430 .",
    "apply lemma  [ 2colordegreeform ] with parameters @xmath431 and @xmath365 to @xmath3 to obtain clusters @xmath432 , an exceptional set @xmath354 and a pure multigraph @xmath154 .",
    "set @xmath433 .",
    "let @xmath356 be the reduced multigraph of @xmath3 with parameters @xmath431 and @xmath365 .",
    "lemma  [ inherit ] implies that @xmath434    [ blowclaim ] @xmath435 contains a @xmath95-tiling covering at least @xmath436 vertices .",
    "if @xmath356 contains a @xmath95-tiling covering at least @xmath437 vertices then fact  [ fact2 ] implies that claim  [ blowclaim ] holds .",
    "so suppose that the largest @xmath95-tiling in @xmath356 covers precisely @xmath438 vertices",
    ". then by lemma  [ expand ] , @xmath356 contains a @xmath439-tiling that covers at least @xmath440 vertices .",
    "thus , by fact  [ fact2 ] , @xmath423 contains a @xmath95-tiling covering at least @xmath441 vertices .",
    "( so at least a @xmath225-proportion of the vertices in @xmath423 are covered . )",
    "further , by definition of @xmath442 and ( [ ds * ] ) , @xmath443 if @xmath423 contains a @xmath95-tiling covering at least @xmath444 vertices then again fact  [ fact2 ] implies that the claim holds .",
    "so suppose that the largest @xmath95-tiling in @xmath423 covers precisely @xmath445 vertices .",
    "recall that @xmath446 . by lemma",
    "[ expand ] , @xmath423 contains a @xmath439-tiling that covers at least @xmath447 vertices .",
    "thus , by fact  [ fact2 ] , @xmath448 contains a @xmath95-tiling covering at least @xmath449 vertices .",
    "( so at least a @xmath450-proportion of the vertices in @xmath448 are covered . ) repeating this argument at most @xmath451 times we see that the claim holds .    for each @xmath452 , partition @xmath160 into classes @xmath453 where @xmath454 for all @xmath455 .",
    "since @xmath456 by lemma  [ 2colordegreeform ] , @xmath457    let @xmath350 $ ] .",
    "lemma  [ slice ] implies that if @xmath458 is @xmath318-regular with density at least @xmath319 then @xmath459 is @xmath460-regular with density at least @xmath461 ( for all @xmath462 ) .",
    "in particular , we can label the vertex set of @xmath463 so that @xmath464 where , for @xmath465 $ ] , @xmath466 in @xmath467 implies that @xmath468 is @xmath460-regular with density at least @xmath469 .    by claim  [ blowclaim ]",
    ", @xmath463 has a @xmath95-tiling @xmath392 that contains at least @xmath470 vertices .",
    "consider any element @xmath65 in @xmath392 and let @xmath471 .",
    "set @xmath472 to be the union of @xmath473 .",
    "note that @xmath474 .",
    "thus , lemma  [ red ] implies that @xmath475 $ ] contains a @xmath95-tiling covering all but at most @xmath476 vertices .",
    "( here we are using that a heavy edge in @xmath463 corresponds to a @xmath460-regular pair in @xmath154 consisting only of heavy edges , and a light edge in @xmath463 corresponds to a @xmath460-regular pair in @xmath154 consisting only of light edges . ) by considering each element in @xmath392 we conclude that @xmath477 contains a @xmath95-tiling covering at least @xmath478 vertices , as desired .",
    "the following result is a simple consequence of theorem  [ almostthm ] .",
    "[ almostthm_cor ] let @xmath133 and @xmath479 .",
    "suppose that @xmath3 is a multigraph on @xmath1 vertices such that @xmath480 then @xmath3 contains a @xmath95-tiling covering all but at most @xmath481 vertices .",
    "add @xmath482 vertices to @xmath3 which send out heavy edges to all other vertices ( including each other ) .",
    "call the resulting multigraph @xmath483 . since @xmath484 we can apply theorem  [ almostthm ] to @xmath483 to obtain a @xmath95-tiling in @xmath483 covering all but at most @xmath485 vertices . removing all those tiles that contain vertices from @xmath486",
    ", we obtain a @xmath95-tiling in @xmath3 that covers all but at most @xmath487 of the vertices of @xmath3 , as desired .",
    "suppose that , in the proof of theorem  [ mainthm2 ] we have found a small absorbing set @xmath46 . ideally , we would next like to apply corollary  [ almostthm_cor ] to conclude that @xmath488 contains an almost perfect @xmath60-tiling @xmath392 , and then use @xmath46 to cover the remaining vertices , thereby obtaining a perfect @xmath60-tiling in @xmath3 . however , to achieve this we would require that the set of vertices uncovered by @xmath392 is _ much smaller _ than the size of the absorbing set @xmath46 .",
    "corollary  [ almostthm_cor ] does not guarantee this though .",
    "indeed , this is because the size of the set of uncovered vertices in corollary  [ almostthm_cor ] is _ large _ compared to the parameter @xmath489 .",
    "worst still , it is easy to see that the conclusion of corollary  [ almostthm_cor ] is false if we replace @xmath490 with a term significantly smaller than @xmath383 .",
    "therefore , instead we will show that the conclusion of corollary  [ almostthm_cor ] can be strengthened in the desired way if our multigraph @xmath3 is _ far _ from extremal .",
    "( this strengthening will be at the cost of no longer guaranteeing an almost perfect @xmath95-tiling , but rather an almost perfect @xmath491-tiling . )",
    "this will ensure that we can then use the above approach in the non - extremal case ( we then have to deal with the extremal case separately ) .    to precisely describe the multigraphs that are far from extremal",
    ", we use the following definition .",
    "[ def : extremal ] given @xmath492 and @xmath493 , we say that a multigraph @xmath3 on @xmath1 vertices is",
    "_ @xmath494-extremal _ if    1",
    ".   there exists @xmath495 such that @xmath496 and @xmath497)<\\gamma n^2 $ ] , or 2 .",
    "there exists @xmath495 such that @xmath498 and @xmath499)<\\gamma n^2 $ ] .",
    "the aim of this section is to prove the following result .",
    "[ almostthm_stability ] let @xmath378 where @xmath379 and @xmath500 such that @xmath501 and let @xmath3 be a multigraph on @xmath1 vertices .",
    "if @xmath3 is not @xmath494-extremal and @xmath502 then @xmath3 contains a @xmath503-tiling covering all but at most @xmath504 vertices .",
    "the proof of theorem  [ almostthm_stability ] makes use of corollary  [ almostthm_cor ] .",
    "the next result will be used to convert an almost perfect tiling of a multigraph with universal graphs into a perfect tiling .",
    "[ lem_oneleftover ] let @xmath378 where @xmath379 and @xmath505 such that @xmath506 and let @xmath3 be a multigraph on @xmath1 vertices .",
    "if @xmath3 is not @xmath507-extremal , @xmath508 and there exists a @xmath95-tiling covering all but one vertex , then @xmath3 contains a perfect @xmath509-tiling in which all but at most three of the tiles are copies of @xmath95 .",
    "let @xmath510 be the @xmath95-tiling in @xmath3 and let @xmath511 be the leftover vertex .",
    "if there exists @xmath512 such that @xmath513 , then we obtain a perfect @xmath509-tiling in which all but one of the tiles are copies of @xmath95 .",
    "so suppose that this is not the case .",
    "then for all but at most @xmath514 of the @xmath512 , @xmath515 .",
    "if there exists @xmath512 such that @xmath516 , then we could move @xmath511 into @xmath28 to create a copy of @xmath517 unless :    1 .",
    "there exists @xmath518 such that @xmath519 in @xmath3 or ; 2 .",
    "@xmath520 are light neighbours of @xmath511 in @xmath3 and either 1 .",
    "[ 2a ] @xmath521 is a light edge or ; 2 .",
    "[ 2b ] @xmath522 and @xmath523 are incident with distinct light edges in @xmath28 .",
    "so we may suppose that one of ( @xmath524 ) and ( @xmath525 ) holds whenever @xmath516 .",
    "let @xmath526 set @xmath527 .",
    "let @xmath528 to be the set of tiles in @xmath529 which contain a vertex from @xmath530 .",
    "call an edge of @xmath3 _ useful _ if it either has both endpoints in @xmath531 , or it has one endpoint in @xmath531 and the other in @xmath532 , or it is a heavy edge with both endpoints in @xmath532 .    given distinct @xmath533",
    ", we say that the ordered pair @xmath534 is _ bad _ if    1 .",
    "there exists @xmath535 such that @xmath536 or failing this ; 2 .",
    "there exists some @xmath537 such that @xmath538 , and some @xmath539 such that @xmath540 is not a heavy edge and @xmath541 .",
    "if neither @xmath534 nor @xmath542 are bad , then we say that @xmath543 is _",
    "good_.    first we will show that non - extremality guarantees that there is a useful edge @xmath544 between a good pair @xmath545 .",
    "then we will show how to use such a configuration to get the desired tiling which uses @xmath511 .",
    "define an auxiliary digraph @xmath546 with vertex set @xmath528 where there is an edge from @xmath28 to @xmath547 if @xmath534 is bad .",
    "note that if there exists a @xmath548 where @xmath549 and a @xmath550 such that @xmath551 , then we obtain our desired perfect @xmath509-tiling by moving @xmath552 to @xmath547 to create a @xmath553 and then moving @xmath511 to @xmath28 to create a @xmath96 ( @xmath552 was a problem vertex for @xmath511 ; moving it out of @xmath28 means that we can move @xmath511 in ) .",
    "so we may assume that such a @xmath552 does not exist .",
    "therefore , for all @xmath552 in @xmath530 , by a computation similar to , we have that @xmath554 for all but at most @xmath555 of the @xmath556 . in particular , for a fixed @xmath557 there are at most @xmath558 @xmath559 such that @xmath534 satisfies ( i ) in the definition of bad .    given distinct @xmath533 , suppose there exists @xmath537 such that @xmath538 , and some @xmath539 such that @xmath540 is not a heavy edge and @xmath560 . by the previous paragraph , @xmath561 .",
    "so @xmath562 spans two disjoint copies of @xmath563 and @xmath564 .",
    "( the vertex set of the former tile is @xmath565 , the latter @xmath566 . ) in particular , we obtain our desired perfect @xmath509-tiling .",
    "so we may assume that such an @xmath50 does not exist .",
    "given distinct @xmath533 , suppose there exists @xmath537 such that @xmath538 , and some @xmath539 such that @xmath540 is not a heavy edge .",
    "further , suppose there exists @xmath567 such that @xmath568 .",
    "we can move @xmath50 to @xmath569 to create a @xmath553 , move @xmath570 to @xmath28 to create a @xmath96 and move @xmath511 to @xmath547 to create a @xmath96 .",
    "in particular , we obtain our desired perfect @xmath509-tiling .",
    "thus , we may assume that this is not the case .",
    "fix @xmath557 .",
    "suppose there are at least @xmath571 @xmath572 such that @xmath534 satisfies ( ii ) in the definition of bad .",
    "then there exists some vertex @xmath573 that plays the role of @xmath50 in ( ii ) for at least @xmath574 such @xmath547 .",
    "but then the previous two paragraphs imply that @xmath575 a contradiction .",
    "altogether this implies that @xmath546 has maximum out - degree at most @xmath576 and so @xmath577 .",
    "we will now show that there are more than @xmath578 ( unordered ) pairs @xmath545 where @xmath533 and so that there is a useful edge in @xmath3 with one endpoint in @xmath28 and the other in @xmath547 .",
    "then for at least one such @xmath545 we have that neither @xmath534 nor @xmath542 is a bad pair .    by the non - extremality of @xmath3 ,",
    "if @xmath579 we have at least @xmath580 useful edges in @xmath581 $ ] . if @xmath582 , then we have at least @xmath583 heavy edges in @xmath584 $ ] , all of which are useful ( and at most @xmath1 of these edges go between vertices in the same tile from @xmath585 ) .",
    "note that there are at most @xmath94 useful edges between any @xmath28 and @xmath547 from @xmath585 .",
    "so we can assume that both @xmath586 and @xmath587 .",
    "with the fact that @xmath588 , implies that , @xmath589 so @xmath587 implies that @xmath590 , and @xmath586 implies that @xmath591 .",
    "therefore , each of the at least @xmath592 vertices in @xmath593 is incident to at least @xmath594 useful edges . in total",
    "we have at least @xmath595 useful edges in @xmath3 which ensures we find our desired pair @xmath545 .",
    "now that we have a useful edge between a good pair , the next two claims show that this is sufficient to give us the desired perfect @xmath509-tiling .",
    "[ 2r-2switch ] let @xmath596 be distinct and let @xmath597 and @xmath598 such that for all @xmath599 , @xmath600 and for all @xmath601 , @xmath602 .    1 .   if there exist @xmath599 and @xmath601 such that @xmath603 , then @xmath604 and @xmath605 are both copies of @xmath95 .",
    "2 .   if there exist @xmath599 and @xmath601 such that @xmath606 , then @xmath604 and @xmath605 are both copies of @xmath96 .",
    "3 .   if the bipartite graph of light edges induced by @xmath607 is @xmath12-regular , then @xmath608 and @xmath609 are both copies of @xmath95 .",
    "the claim follows immediately if @xmath603 .",
    "if @xmath606 , then each vertex @xmath610 has one other light neighbour , each of which would create a @xmath96 after the switch . in the last case ,",
    "all of the light neighbours of each vertex @xmath610 are being moved to the other side .",
    "[ caseanalysis ] suppose @xmath596 are distinct and there is a useful edge @xmath544 where @xmath611 , @xmath612 such that @xmath613 and @xmath614 .",
    "further suppose that for all @xmath573 , if @xmath615 is not heavy , then @xmath616 and for all @xmath617 if @xmath618 is not heavy , then @xmath619 .",
    "then there is a @xmath509-tiling in @xmath3 covering precisely the vertices in @xmath620 .",
    "to prove the claim , we split the argument into three cases .",
    "+ * case 1 : * there exists @xmath621 or @xmath622 such that either @xmath623 or @xmath624 . without loss of generality ,",
    "suppose @xmath624 .",
    "switch @xmath570 and @xmath625 . by claim [ 2r-2switch](i ) ,",
    "@xmath626 and @xmath627 are @xmath95s .",
    "since @xmath544 is a useful edge , @xmath511 sends at least @xmath628 edges to @xmath627 .",
    "if @xmath511 sends at least @xmath629 edges to @xmath627 then @xmath630 is a copy of @xmath553 .",
    "if @xmath511 sends precisely @xmath628 edges to @xmath627 then @xmath625 must be a light neighbour of @xmath511 in @xmath3 .",
    "further , as @xmath624 and @xmath616 , we have that @xmath625 sends all possible edges to @xmath627 , i.e. @xmath631 .",
    "in particular , @xmath632 and @xmath633 do not hold ( where @xmath627 is playing the role of @xmath28 ) .",
    "thus , @xmath630 is a copy of @xmath634 .",
    "* case 2 : * @xmath635 or @xmath636 .",
    "+ without loss of generality , suppose @xmath635 . since we are not in the first case , @xmath552 has two light neighbours in @xmath547 . in particular",
    ", there exists @xmath637 that is a light neighbour of @xmath552 .",
    "switch @xmath552 and @xmath638 . by claim [ 2r-2switch](ii ) ,",
    "@xmath639 and @xmath640 are copies of @xmath96 .",
    "in particular , @xmath639 has the property that if @xmath639 contains a light path on @xmath24 vertices , then @xmath638 is an endpoint of this path .",
    "furthermore since @xmath641 and @xmath642 , @xmath511 sends at least @xmath629 edges to @xmath639 .",
    "moreover , if @xmath643 , then @xmath644 and thus @xmath645 is a copy of @xmath517 .     and @xmath547 ( not shown ) form a matching.,title=\"fig : \" ]    and @xmath547 ( not shown ) form a matching.,title=\"fig : \" ]    and @xmath547 ( not shown ) form a matching.,title=\"fig : \" ]    * case 3 : * @xmath646 .",
    "+ let @xmath647 and @xmath648 with @xmath649 and @xmath650 . by the definition of a useful edge , @xmath651 .",
    "since we are not in case 1 , there exists @xmath652 that is a light neighbour of @xmath653 and there exists @xmath654 that is a light neighbour of @xmath655 ( see figure  [ fig : case3](i ) ) . since @xmath656 , we may assume that @xmath657  this implies that the other light neighbour of @xmath638 in @xmath28 must be @xmath658 and that @xmath658 must have a light neighbour in @xmath659 .",
    "similarly , we can assume @xmath660 , so @xmath661 is a light edge and @xmath662 has a ( unique ) light neighbour in @xmath663 .",
    "therefore , both @xmath664 and @xmath665 are heavy edges ( see figure  [ fig : case3](ii ) ) .",
    "suppose @xmath666 is not a light edge , so @xmath653 has a light neighbour @xmath667 .",
    "as in the previous case , since @xmath668 we may assume that @xmath669 .",
    "so it must be that @xmath670 is a light edge .",
    "now @xmath671 forms a @xmath94-cycle of light edges and by claim [ 2r-2switch](iii ) , we can switch @xmath672 for @xmath673 and then add @xmath511 to @xmath674 to obtain disjoint copies of @xmath95 and @xmath675 .",
    "likewise , we would be done if @xmath676 is not a light edge .",
    "so suppose both @xmath677 and @xmath678 are light edges ( see figure  [ fig : case3](iii ) ) .",
    "then @xmath679 forms a @xmath145-cycle of light edges ; we simultaneously switch @xmath680 for @xmath681 to obtain two disjoint copies of @xmath95 .",
    "recall @xmath664 is a heavy edge so they both have distinct light neighbours in @xmath28 .",
    "hence , at most one of @xmath653 and @xmath658 is a light neighbour of @xmath50 .",
    "therefore we can add @xmath511 to @xmath682 to form an element of @xmath517 .",
    "this completes the proof of the claim and thus the lemma .",
    "we now combine corollary  [ almostthm_cor ] and lemma  [ lem_oneleftover ] to obtain the following result .",
    "[ almostthm_reducedstability ] let @xmath378 where @xmath379 and @xmath683 such that @xmath684 and let @xmath3 be a multigraph on @xmath1 vertices .",
    "if @xmath3 is not @xmath685-extremal and @xmath502 then @xmath3 contains a perfect @xmath509-tiling .",
    "choose @xmath686 so that @xmath687 .",
    "by corollary [ almostthm_cor ] there exists a @xmath95-tiling @xmath688 covering all but at most @xmath689 vertices .",
    "set @xmath690 . to construct a perfect @xmath691-tiling in @xmath3 , we perform the following iterative procedure . for each vertex @xmath511 uncovered by @xmath529 we apply lemma  [ lem_oneleftover ] once . in each iteration",
    ", we modify at most three elements of @xmath529 .",
    "each time we apply lemma  [ lem_oneleftover ] , the multigraph under consideration is the subgraph of @xmath3 induced by @xmath692 where @xmath693 is the set of tiles in @xmath529 that have not been modified in any of the previous steps .",
    "suppose we have performed this procedure for every vertex in some @xmath694 .",
    "let @xmath154 be the subgraph under consideration and note that @xmath695 , so @xmath696 furthermore , if @xmath697 and @xmath698 or @xmath699 , then @xmath700 or @xmath701 , respectively .",
    "therefore , @xmath154 is not @xmath507-extremal , because @xmath702 .",
    "hence , we may apply lemma [ lem_oneleftover ] a total of @xmath703 times to complete the proof .",
    "we now apply the regularity lemma together with proposition  [ almostthm_reducedstability ] to prove theorem  [ almostthm_stability ] .",
    "* proof of theorem  [ almostthm_stability ] .",
    "* define additional constants @xmath431 and @xmath428 so that @xmath704 .",
    "apply lemma  [ 2colordegreeform ] with parameters @xmath431 and @xmath365 to @xmath3 to obtain clusters @xmath432 , an exceptional set @xmath354 and a pure multigraph @xmath154 .",
    "set @xmath433 .",
    "let @xmath356 be the reduced multigraph of @xmath3 with parameters @xmath431 and @xmath365 .",
    "lemma  [ inherit ] implies that @xmath705    suppose that there exists @xmath706 such that @xmath707 and @xmath708)<\\gamma k^2 /4 $ ] .",
    "let @xmath709 and @xmath710 .",
    "then @xmath711 and so by lemma  [ 2colordegreeform](ii ) , @xmath712 . moreover , by lemma  [ 2colordegreeform](iv ) and the definition of the reduced multigraph @xmath356 , @xmath713 ) < ( \\gamma k^2/4)\\cdot2m^2 \\leq \\gamma n^2/2 $ ] .",
    "thus , by lemma  [ 2colordegreeform](iii ) , @xmath714 ) < \\gamma n^2 $ ] , a contradiction as @xmath3 is not @xmath685-extremal .",
    "a similar argument shows that there is no set @xmath706 such that @xmath715 and @xmath716)<\\gamma k^2 /4 $ ] .",
    "thus , @xmath356 is not @xmath717-extremal .",
    "therefore , by proposition  [ almostthm_reducedstability ] , @xmath356 contains a perfect @xmath509-tiling @xmath688 .",
    "note that every induced subgraph of a copy of @xmath718 of size @xmath2 is itself a copy of @xmath719 .",
    "since @xmath720 , by repeatedly applying lemma  [ red ] for each of the tiles in @xmath688 we obtain a @xmath503-tiling in @xmath3 covering all but at most @xmath504 vertices , as required .",
    "let @xmath3 be a multigraph and @xmath721 be a collection of multigraphs .",
    "we call a set @xmath148 an _ @xmath721-absorbing set for @xmath722 _ if both @xmath149 $ ] and @xmath723 $ ] contain perfect @xmath721-tilings .",
    "suppose that a non - extremal multigraph @xmath3 as in theorem  [ mainthm2 ] contains a small set @xmath148 that is a @xmath724-absorbing set for any very small set @xmath722 .",
    "theorem  [ almostthm_stability ] ensures that @xmath162 contains an almost perfect @xmath724-tiling ; let @xmath725 denote the set of uncovered vertices in @xmath162 .",
    "then @xmath723 $ ] contains a perfect @xmath724-tiling , and thus @xmath3 contains a perfect @xmath724-tiling , as required .",
    "we will show that such an absorbing set @xmath46 exists if @xmath3 is non - extremal and if additionally , in the case when @xmath726 , @xmath3 is not ` splittable ' .",
    "we use the following definition to make this precise .",
    "[ def : splittable ] given @xmath492 and @xmath727 , a multigraph @xmath3 on @xmath1 vertices is _ _",
    "@xmath685-splittable _ _ if there exist disjoint sets @xmath728 such that    * @xmath729 and ; * if @xmath241 then @xmath730 ; if @xmath726 then @xmath731 .",
    "the next result gives a condition which forces a multigraph to contain an absorbing set .",
    "[ lo ] let @xmath732 and let @xmath492 .",
    "suppose that @xmath721 is a collection of multigraphs , each on @xmath733 vertices .",
    "then there exists an @xmath30 such that the following holds .",
    "suppose that @xmath3 is a multigraph on @xmath31 vertices so that , for any @xmath196 , there are at least @xmath734 @xmath735-sets @xmath168 such that both @xmath736 $ ] and @xmath737 $ ] contain perfect @xmath721-tilings",
    ". then @xmath112 contains a set @xmath46 so that    * @xmath738 ; * @xmath46 is an @xmath721-absorbing set for any @xmath739 such that @xmath740 and @xmath741 .",
    "lo and markstrm  @xcite proved lemma  [ lo ] for hypergraphs , however , the proof of this result for multigraphs is identical . the next result together with lemma  [ lo ] implies our multigraph @xmath3 contains an absorbing set .",
    "[ main - absorb ] let @xmath109 , @xmath742 , and let @xmath3 be a multigraph on @xmath1 vertices",
    ". if @xmath743 and @xmath3 is not @xmath494-extremal and either @xmath744 or @xmath3 is not @xmath494-splittable , then for all distinct @xmath745 there exist at least @xmath746 @xmath229-sets @xmath747 such that @xmath748 $ ] and @xmath749 $ ] both contain @xmath503 .",
    "we will need the following lemma in the proof of lemma  [ main - absorb ] .",
    "[ prop : heavy_triangle_count ] let @xmath750 , and let @xmath3 be a multigraph on @xmath1 vertices with @xmath751 which is not @xmath752-extremal and not @xmath752-splittable .",
    "for any disjoint sets @xmath753 such that @xmath754 , there exists a collection @xmath529 of copies of @xmath128 in @xmath127 $ ] such that @xmath755 and for every @xmath756 , both @xmath757 and @xmath758 are non - empty , and if @xmath28 contains a light edge @xmath521 , then @xmath759 and @xmath760 .    for @xmath761 such that",
    "@xmath762 $ ] , we say that @xmath28 is _ nice _ if both @xmath757 and @xmath758 are non - empty , and either @xmath28 has no light edges or @xmath28 has exactly one light edge @xmath521 with @xmath759 and @xmath760 .",
    "since @xmath3 is not @xmath752-splittable , there exist at least @xmath763 heavy edges in @xmath3 with one endpoint in @xmath117 and one endpoint in @xmath118 . for each such edge @xmath521 , we will either find ( i ) at least @xmath764 vertices @xmath765 such that @xmath766 is a nice @xmath128 , or ( ii ) at least @xmath763 edges @xmath767 such that @xmath768 is a nice @xmath128 for some @xmath769 $ ] .",
    "a simple calculation then implies that we obtain our desired collection of nice @xmath128 .",
    "let @xmath521 be an edge in @xmath770 such that @xmath771 for @xmath769 $ ] .",
    "pick @xmath772 so that @xmath773 and note that @xmath774 so @xmath775 .",
    "since for every @xmath776 , @xmath766 is a nice @xmath128 , if @xmath777 we are done .",
    "otherwise , @xmath778 - \\gamma n/2 \\ge ( 1/2 - \\gamma)n .",
    "\\end{aligned}\\ ] ] therefore , since @xmath3 is not @xmath752-extremal , there are at least @xmath763 heavy edges in @xmath779 $ ] and for each such edge @xmath767 , @xmath768 is a nice @xmath128 .",
    "we are now ready to prove lemma  [ main - absorb ] .",
    "* proof of lemma  [ main - absorb ] . *",
    "define @xmath780 so that @xmath781 .",
    "fix distinct vertices @xmath782 , @xmath783 and let @xmath784 . for any @xmath785 ( with @xmath786 ) and integer @xmath787 , let @xmath788 note that when @xmath789 , we trivially have @xmath790 . by the degree condition , @xmath791 therefore , @xmath792",
    "so since @xmath793 and @xmath794 , @xmath795    call an @xmath229-set @xmath747 _ good _ if both @xmath796 $ ] and @xmath797 $ ] contain @xmath97 . for @xmath798 and @xmath799",
    ", we say that a @xmath140-set @xmath800 is _",
    "@xmath801-acceptable _ if @xmath802 $ ] has exactly @xmath801 light edges and either :    * @xmath803 , * @xmath804 and @xmath802 \\in \\bar{\\k}_t$ ] , or * @xmath805 and @xmath802 \\in \\hat{\\k}_t$ ] .",
    "if @xmath77 is @xmath801-acceptable for some @xmath799 , then we say that @xmath77 is _ acceptable _ ; note that if @xmath77 is an acceptable @xmath140-set , then both @xmath796 $ ] and @xmath797 $ ] contain @xmath806 . for any acceptable @xmath140-set @xmath77 ,",
    "let @xmath807 be the set of vertices @xmath808 such that if @xmath51 is the unique light neighbour of @xmath177 in @xmath77 , then @xmath51 is incident to a light edge in @xmath77 . note that if @xmath77 is an @xmath801-acceptable @xmath140-set , @xmath809 and @xmath51 is unique light neighbour of @xmath177 in @xmath77 , then @xmath810 , is either @xmath811-acceptable or @xmath812-acceptable depending on whether @xmath51 is incident to one or two light edges in @xmath77 . recall that @xmath51 can only be incident to two light edges in @xmath77 if @xmath813 and @xmath51 is the middle vertex of a path on three vertices in @xmath77 that consists of light edges .",
    "for @xmath814 and @xmath799 , say that an @xmath801-acceptable @xmath140-set @xmath77 is _",
    "@xmath780-extendible _ if at least one of the following four conditions holds :    1 .",
    "@xmath803 , @xmath2 is even and @xmath815 ; 2 .",
    "@xmath803 , @xmath726 , and there are at least @xmath816 @xmath24-sets @xmath817 such that @xmath817 is a good @xmath24-set ; 3 .",
    "@xmath818 is even , and there are at least @xmath819 @xmath12-sets @xmath817 such that @xmath820 is either an acceptable @xmath821-set or a good @xmath229-set ; or 4 .",
    "@xmath822 .",
    "if we assume that ( iv ) never holds , then claim  [ claim : extendible ] below will imply that there exists at least @xmath746 good @xmath229-sets . indeed , in this case    *",
    "if @xmath2 is odd , then we can build good @xmath229-sets two vertices at a time by repeatedly using ( iii ) ; * if @xmath2 is even and ( i ) holds , then we can construct good @xmath229-sets by first selecting any of the @xmath823 vertices in @xmath824 and then finish the construction by repeatedly applying ( iii ) ; and * if @xmath2 is even and ( i ) does not hold , then ( ii ) must hold which immediately implies that there are @xmath825 good @xmath229-sets .",
    "[ claim : extendible ] let @xmath814 and @xmath799 , and @xmath77 be an @xmath801-acceptable @xmath140-set .",
    "if @xmath803 or @xmath818 is even , then @xmath77 is @xmath780-extendible .    to prove the claim",
    ", we may assume that ( iv ) does not hold throughout , i.e. @xmath826 note that , by , @xmath827    first assume that @xmath818 is even and let @xmath828 also define @xmath829 when @xmath830 , , and imply that @xmath831    assume that @xmath832 . if @xmath833 , then first pick any @xmath834 , and then pick any vertex @xmath835 and note that @xmath836 is an acceptable @xmath821-set . by , the minimum degree condition and the fact that @xmath837 , we have that there are at least @xmath838 choices for @xmath839 .",
    "note that there are at least @xmath840 choices for @xmath841 , so ( iii ) in the definition of @xmath780-extendible holds , as required .",
    "if @xmath842 , then pick any @xmath843 and let @xmath844 be the unique light neighbour of @xmath451 in @xmath77 .",
    "recall that since @xmath845 , @xmath51 has no light neighbours in @xmath77 . by , @xmath846 and for any of the at least @xmath847 vertices @xmath848 , @xmath836 is an acceptable @xmath821-set .",
    "note that there are at least @xmath849 choices for @xmath841 , so ( iii ) in the definition of @xmath780-extendible holds , as required .",
    "when @xmath850 , implies that @xmath851 and when @xmath805 , and give that @xmath852 therefore , when @xmath853 , @xmath854 we will either find at least @xmath855 light edges @xmath856 where @xmath834 and @xmath857 , or at least @xmath855 heavy edges in @xmath858 $ ] . note that , in either of these two cases , when @xmath859 , @xmath860 \\in \\hat{\\k}_{r-2}$ ] for @xmath769 $ ] , and when @xmath861 , @xmath860 \\in { \\k}'_{r}$ ] for @xmath769 $ ] , so this will prove the claim .",
    "suppose that we can not find at least @xmath855 such edges .",
    "by non - extremality , this implies that @xmath862 and @xmath863 .",
    "hence , by , @xmath864 and @xmath865 .",
    "therefore , by the degree condition , any vertex in @xmath834 , is adjacent to at least @xmath866 vertices @xmath857 , a contradiction .",
    "we will now show that if @xmath2 is even and @xmath803 and ( i ) in the definition of @xmath780-extendible does not hold , then ( ii ) must hold .",
    "so assume @xmath803 , @xmath2 is even and @xmath867 .",
    "this , with , implies that @xmath868 so @xmath3 is not @xmath494-splittable . by the degree condition , @xmath867 implies that @xmath869$}.\\ ] ] therefore , if we let @xmath870$},\\ ] ] then @xmath117 and @xmath118 are disjoint , and @xmath871$}.\\ ] ] by lemma  [ prop : heavy_triangle_count ] , there are at least @xmath872 nice copies of @xmath128 in @xmath873 $ ] ( i.e. , copies of @xmath128 that intersect both @xmath117 and @xmath118 and that have at most one light edge and such a light edge has one endpoint in @xmath117 and the other in @xmath118 ) .",
    "the vertex set of any such nice @xmath128 is a good @xmath229-set , as desired .",
    "this completes the proof of the claim .",
    "assume for a contradiction that there are at most @xmath746 good @xmath229-sets .",
    "let @xmath874 be the maximum @xmath140 for which we have @xmath875 acceptable @xmath140-sets and either @xmath803 or @xmath818 is even .",
    "such a @xmath140 exists , since @xmath876 is an acceptable @xmath361-set .",
    "we can also assume that @xmath804 , since if @xmath877 , then @xmath878 and ( iv ) can not hold , so claim  [ claim : extendible ] implies that one of ( i ) , ( ii ) or ( iii ) must hold , which violates the maximality of @xmath140 or the assumption that there are at most @xmath746 good @xmath229-sets .",
    "let @xmath801 be minimal such that if @xmath879 is the set of @xmath801-acceptable @xmath140-sets , then @xmath880 .",
    "there exists such an @xmath801 , because @xmath881 . by claim  [ claim : extendible",
    "] , each set @xmath882 is @xmath780-extendible in one of two ways , so in particular there is some subset of @xmath879 of order at least @xmath883 for which all elements are extendible in the same way , either ( iii ) , or ( iv ) . if the elements in this subset are all @xmath780-extendible by ( iii ) , then , because @xmath884 , we have at least @xmath885 acceptable @xmath821-sets or , if @xmath886 , more than @xmath746 good @xmath229-sets .",
    "this contradicts the maximality of @xmath140 or the assumption that there are at most @xmath746 good @xmath229-sets .",
    "( we divide by @xmath887 in the above calculation to account for the fact there are @xmath887 different ways a @xmath821-set can be constructed by adding @xmath12 vertices to a @xmath140-set . )",
    "now assume that there are at least @xmath883",
    "@xmath801-acceptable @xmath140-sets that are extendible by ( iv ) .",
    "let @xmath888 be the collection of @xmath811-acceptable and @xmath812-acceptable @xmath140-sets and set @xmath889 our aim is to find a lower bound on @xmath890 which contradicts the minimality of @xmath801 .",
    "let @xmath891 and let @xmath892 and @xmath893 such that @xmath894 .",
    "note that the choice of @xmath77 is not necessarily unique .",
    "let @xmath839 be the unique light neighbour of @xmath451 in @xmath77 and note that @xmath895 is in @xmath888 .",
    "therefore , for every @xmath891 there exists @xmath896 and @xmath897 , such that @xmath898 which implies that @xmath899 .",
    "any @xmath891 is constructed by adding to some @xmath900 a vertex @xmath901 .",
    "so in any @xmath891 there are most four vertices @xmath902 such that there exists @xmath903 such that @xmath904 is a light edge and @xmath905 has at least two light neighbours in @xmath817 .",
    "therefore , for every @xmath906 , there are at most four different pairs @xmath907 such that @xmath892 , @xmath901 and @xmath908 .",
    "this implies that @xmath909 so @xmath910",
    ". therefore , there are at least @xmath911 @xmath811-acceptable @xmath140-sets or @xmath812-acceptable @xmath140-sets , a contradiction to the minimality of @xmath801 .",
    "we now combine lemmas  [ lo ] and  [ main - absorb ] together with theorem  [ almostthm_stability ] to prove the following result which ensures that theorem  [ mainthm2 ] holds in the case when @xmath3 is non - extremal and additionally if @xmath726 , non - splittable .",
    "[ mainthm - stability ] let @xmath378 where @xmath912 divides @xmath1 and define @xmath913 such that @xmath684 .",
    "let @xmath3 be a multigraph on @xmath1 vertices .",
    "if @xmath743 and @xmath3 is not @xmath494-extremal and either @xmath914 or @xmath3 is not @xmath494-splittable , then @xmath3 contains a perfect @xmath503-tiling .",
    "first assume that @xmath109 .",
    "define @xmath915 so that @xmath916 .",
    "let @xmath3 be as in the statement of the theorem .",
    "by lemma  [ main - absorb ] , given any @xmath745 , there exist at least @xmath746 @xmath229-sets @xmath917 such that both @xmath918 $ ] and @xmath919 $ ] contain elements of @xmath97 .",
    "thus , by lemma  [ lo ] , @xmath112 contains a set @xmath46 so that    * @xmath920 ; * @xmath46 is a @xmath97-absorbing set for any @xmath739 such that @xmath921 and @xmath922 .",
    "let @xmath923 and @xmath924 .",
    "so as @xmath925 , @xmath926 further , as @xmath927 , @xmath154 is not @xmath507-extremal .",
    "thus , by theorem  [ almostthm_stability ] , @xmath154 contains a @xmath97-tiling covering all but at most @xmath928 vertices .",
    "let @xmath725 denote the set of these uncovered vertices .",
    "then by definition of @xmath46 , @xmath723 $ ] contains a perfect @xmath97-tiling .",
    "altogether this implies that @xmath3 contains a perfect @xmath97-tiling , as desired .",
    "now assume that @xmath929 . if @xmath930 the theorem is trivial . for @xmath931 ,",
    "we show that there exists a perfect matching in @xmath8 , the graph underlying the multigraph @xmath3 , i.e.  @xmath8 is the graph on @xmath112 in which there is an edge between @xmath50 and @xmath51 if and only if there is either a light or heavy edge between @xmath50 and @xmath51 in @xmath3 .",
    "we have that @xmath1 is even , @xmath932 , @xmath933 , @xmath3 is not @xmath934-extremal and @xmath3 is not @xmath934-splittable .",
    "let @xmath46 be a maximum matching in @xmath8 and suppose @xmath46 is not perfect .",
    "note that the vertices unsaturated by @xmath46 form an independent set .",
    "let @xmath935 be two vertices unsaturated by @xmath46 and for @xmath936 $ ] , define @xmath937 .",
    "note that @xmath938 and there are no edges in @xmath8 with one endpoint in @xmath939 and the other in @xmath940 as this would give us an @xmath46-augmenting path , contradicting the maximality of @xmath46 .",
    "since @xmath3 is not @xmath934-splittable , it can not be the case that @xmath939 and @xmath940 are disjoint , so let @xmath941 .",
    "we have @xmath942 and thus @xmath943 which implies @xmath944 , contradicting the fact that @xmath3 is not @xmath934-extremal .",
    "in this section we prove the following theorem .    [ thm : main_extremal ] for any @xmath945 , there exists @xmath946 such that the following holds .",
    "if @xmath3 is a multigraph on @xmath947 vertices , @xmath1 is divisible by @xmath2 and @xmath948 then @xmath3 contains a perfect @xmath949-tiling .    note that theorem  [ thm : main_extremal ] immediately implies theorem  [ mainthm2 ] ( and thus theorem  [ mainthm ] )",
    ". our results from the previous sections will ensure theorem  [ thm : main_extremal ] holds in the ` non - extremal ' cases .",
    "therefore most of the work in this section concerns the extremal cases .    throughout this section",
    "we consider a standard multigraph @xmath3 on @xmath1 vertices that satisfies the hypothesis of theorem  [ thm : main_extremal ] .",
    "in particular , we may assume @xmath950 .",
    "we denote the vertex set of @xmath3 by @xmath951 .",
    "we will use the following well - known and simple lemma in this section . a proof is included for completeness .",
    "[ lem : matching ] for any graph @xmath8 there is a matching of order at least @xmath952 .",
    "let @xmath46 be a maximal matching in @xmath8 and suppose that @xmath953 .",
    "let @xmath65 be the vertices incident to an edge in @xmath46 and let @xmath954 .",
    "note that @xmath955 and that , by the maximality of @xmath956 , @xmath725 is an independent set .",
    "therefore , there exist distinct @xmath957 where @xmath958 .",
    "hence , there exists @xmath959 such that @xmath960 , and this implies that there exists a matching of order @xmath961 in @xmath8 .",
    "the next claim gives us a minimum degree condition for @xmath962 $ ] where @xmath65 is any set of size close to @xmath963 for some @xmath964 .",
    "[ clm : deg_into_subsets ] suppose @xmath965 and @xmath966 where @xmath967 .",
    "let @xmath968 and @xmath969 . if @xmath970 then @xmath971    when @xmath972 the statement is trivially true , so assume @xmath973 .",
    "therefore , @xmath974 hence , by , @xmath975    let @xmath976 be a constant such that @xmath977 .",
    "we call a set @xmath969 ,    * a _ @xmath978-independent set _ if @xmath979 and @xmath980 ) < c n^2 $ ] , or * a _ @xmath981-independent set _",
    "if @xmath982 and @xmath983 ) < c n^2 $ ] .",
    "if @xmath984 are vertex - disjoint , we say that the pair @xmath985 is    * a _",
    "@xmath978-disconnected pair _ if @xmath986 and @xmath987 , or * a _ @xmath981-disconnected pair _ if @xmath988 and @xmath989 .",
    "if @xmath967 and @xmath969 , we call @xmath65 an _ @xmath990-tolerant set _ when @xmath991 and    * for @xmath992 , @xmath65 does not contain a @xmath993-independent set , and * if @xmath994 , then @xmath65 does not contain an @xmath995-disconnected pair .",
    "the preceding definitions are closely related to the notion of being @xmath494-extremal ( definition  [ def : extremal ] ) or @xmath494-splittable ( definition  [ def : splittable ] ) which the following simple claim makes explicit .",
    "[ clm : tolerant - implies - not - extremal ] let @xmath967 where @xmath966 , @xmath996 , @xmath969 such that @xmath991 and @xmath694 such that @xmath997 .",
    "if @xmath969 is @xmath998-tolerant , then @xmath858 $ ] is not @xmath999-extremal and , when @xmath1000 , @xmath858 $ ] is not @xmath1001-splittable .",
    "suppose that @xmath858 $ ] is @xmath1001-extremal .",
    "so there exists @xmath1002 such that either @xmath1003 ) < \\gamma |u'|^2 $ ] , and @xmath1004 , or @xmath1005 ) < \\gamma |u'|^2 $ ] , and @xmath1006 . because @xmath1007 and @xmath997 , it is easy to see we can add vertices from @xmath65 to @xmath1008 or delete vertices from @xmath1008 to create either a @xmath978-independent or @xmath981-independent set in @xmath65 .",
    "this implies that @xmath65 is not @xmath990-tolerant .",
    "a similar argument implies that when @xmath1000 , if @xmath858 $ ] is @xmath1001-splittable , then @xmath65 is not @xmath990-tolerant .",
    "claim  [ clm : tolerant_sets ] below is meant to capture all of the necessary facts about @xmath990-tolerant sets in a form that will be convenient .",
    "in some sense , claim  [ clm : tolerant_sets ] is just a restatement of the main theorems from the previous sections .    with claim  [ clm : deg_into_subsets ] , ( i ) and ( ii ) follow from corollary  [ almostthm_cor ] , and ( iii ) and ( iv ) follow from proposition  [ almostthm_reducedstability ] and theorem  [ mainthm - stability ] , respectively .",
    "note that , after the proof of this claim , we do not appeal to corollary  [ almostthm_cor ] , proposition  [ almostthm_reducedstability ] and theorem  [ mainthm - stability ] again .",
    "[ clm : tolerant_sets ] let @xmath967 where @xmath966 and suppose @xmath1009 , @xmath969 such that @xmath65 is @xmath1010-tolerant and @xmath1011 such that @xmath1012 .    1 .",
    "[ clm : kbar_in_uprime ] if @xmath1002 such that @xmath1013 then @xmath1014 $ ] contains a copy of @xmath1015 .",
    "[ clm : v_khat_s_plus_1 ] if @xmath968 such that @xmath1016 , then @xmath858 $ ] contains a copy @xmath28 of @xmath1017 to which @xmath177 sends at least @xmath1018 edges , so @xmath1019 $ ] contains a copy of @xmath1020 .",
    "[ clm : large_cliques ] there exist at least @xmath1021 vertex - disjoint copies of @xmath1022 in @xmath858 $ ] .",
    "[ clm : factor ] if @xmath1023 is divisible by @xmath1024 , then there exists a perfect @xmath1025-tiling in @xmath858 $ ] .",
    "note that , by claim  [ clm : deg_into_subsets ] , @xmath1026 ) \\ge 2(1 - 1/s - r\\eta / s)|u'|.\\ ] ]    we first prove ( i ) and ( ii ) , so let @xmath725 and @xmath177 be as in the statement of the claim .",
    "when @xmath973 , corollary  [ almostthm_cor ] and imply that there exists a @xmath1017-tiling @xmath1027 of @xmath858 $ ] on all but at most @xmath1028 vertices , and when @xmath972 , this is trivially true .",
    "let @xmath1029 be the vertices in @xmath1030 that are covered by @xmath1027 .",
    "note that @xmath1031 since @xmath1032 there exists @xmath756 such that @xmath1033 , and this proves ( i ) . because @xmath1034 there exists @xmath756 such that @xmath1035 , so @xmath177 has at most one light neighbour in @xmath28 .",
    "this proves ( ii )",
    ".    we will now prove ( iii ) and ( iv ) . to this end , let @xmath1036 such that @xmath1037 note that @xmath1038 so , by claim  [ clm : deg_into_subsets ] , @xmath1039 ) \\ge 2(1 - 1/s - 3 r \\phi)|u''|.\\ ] ] for @xmath1040 such that @xmath1041 , by claim  [ clm : tolerant - implies - not - extremal ] we have that @xmath1042 $ ] is not @xmath1043-extremal and when @xmath1000 is not @xmath1043-splittable . if @xmath1044 , ( iv ) is vacuously true .",
    "so suppose @xmath1045 .",
    "then proposition  [ almostthm_reducedstability ] implies that @xmath1042 $ ] has a perfect @xmath1046-tiling and , when @xmath1024 divides @xmath1047 , theorem  [ mainthm - stability ] implies that @xmath1042 $ ] has a perfect @xmath1025-tiling .    taking @xmath1048 then gives ( iv ) .",
    "furthermore , we can greedily select @xmath1049 copies of elements from @xmath1022 from @xmath858 $ ] , since any subset of @xmath1030 that has order greater than @xmath1050 contains a copy of @xmath1022 : when @xmath973 , this is true because a perfect @xmath1051-tiling in a multigraph of order not divisible by @xmath1024 implies the existence of an element from @xmath1022 , and , when @xmath972 , this is true because @xmath858 $ ] not being @xmath1052-extremal implies that @xmath858 $ ] contains at least @xmath1053 edges .",
    "this proves ( iii ) .",
    "suppose that @xmath1054 and , in addition , for every @xmath1055 $ ] , we have @xmath1056 and @xmath1057 such that @xmath1058    we start by trying to find , for either @xmath1059 or @xmath1060 , an @xmath1061-independent set which we will call @xmath1062 .",
    "we then try to find , for @xmath1063 or @xmath1064 , an @xmath1065-independent set @xmath1066 disjoint from @xmath1062 .",
    "we continue in this manner for as long as possible , so in the end we have ( a possibly empty , in which case @xmath1067 ) collection of disjoint sets @xmath1068 and integers @xmath1069 , such that @xmath1070 is @xmath1071-independent for each @xmath1072 $ ] .",
    "let @xmath1073 } a_i}$ ] and set @xmath1074 .",
    "if @xmath1075 , then @xmath789 and we set @xmath1076 to indicate this case . if @xmath65 is @xmath1077-tolerant , then set @xmath1078 , @xmath1079 and @xmath1080 . otherwise , @xmath65 is not @xmath1077-tolerant and because the initial process terminated , @xmath65 contains neither a @xmath1081-independent set nor a @xmath1082-independent set . by the definition of a tolerant set , it must therefore be that @xmath1000 and that @xmath65 has a partition @xmath1083 that is @xmath1084-disconnected .",
    "we set @xmath1085 and @xmath1086 , to indicate this case .",
    "if @xmath1087 , set @xmath1088 , @xmath1089 , @xmath1090 and @xmath1091",
    ". otherwise , set @xmath1092 , @xmath1093 , @xmath1094 and @xmath1095 .",
    "therefore , @xmath1096 and we have proved the following claim .",
    "[ clm : first_partition ] there exists a partition @xmath1097 of @xmath951 where @xmath1098 and @xmath1099 , and non - negative integers @xmath1100 such that the following holds :    1 .",
    "@xmath1101 for @xmath1102 $ ] ; 2 .",
    "for every @xmath1072 $ ] , @xmath1103 and @xmath1070 is an @xmath1104-independent set ; 3 .   if @xmath1105 , then @xmath1075 ; 4 .",
    "[ clm : properties_of_a_p+1 ] if @xmath1087 , then @xmath1106 and @xmath1107 is @xmath1010-tolerant ; and 5 .   if @xmath1108 , then @xmath1000 and @xmath1083 is an @xmath1109-disconnected pair .    note the relationship between claim  [ clm : first_partition ] and the examples shown in figure  [ fig : extremalcases ]",
    ".    in order to discuss the case when @xmath1110 and the case when @xmath1111 in a consistent way , we define a permutation @xmath1112 of @xmath1113 $ ] in the following way .",
    "if @xmath1114 we let @xmath1112 be the identity permutation , and if @xmath1108 we let @xmath1112 be the transposition of @xmath1115 and @xmath1116 . note that when @xmath1117 , and @xmath1118 , @xmath1119 .    when @xmath1120 , we let @xmath1121 $ ] , and when @xmath1087 , we let @xmath1122 $ ] .",
    "we say that a vertex @xmath177 is _",
    "@xmath1123-typical _ if @xmath1124 and @xmath1125 or , if @xmath1087 , @xmath1126 and @xmath1127 .",
    "[ clm : typical ] for any @xmath1102 $ ] , if @xmath177 is @xmath1123-typical , then @xmath1128 , and , furthermore , if @xmath1124 and @xmath1129 , then @xmath1130 .",
    "consider any @xmath1102 $ ] and suppose @xmath177 is @xmath1123-typical .",
    "if @xmath1131 and @xmath1126 , then , recalling that @xmath1132 , we have @xmath1133 by definition .    otherwise , using , if @xmath1134 , we have that @xmath1135 and if @xmath1129 , we have that @xmath1136 when @xmath1129 , we also have that @xmath1137    [ clm : nontypical_bound ] for any @xmath1138 and @xmath1102 $ ] , there are at most @xmath1139 vertices in @xmath1070 that are not @xmath1140-typical .",
    "let @xmath1102 $ ] and let @xmath140 be the number of vertices in @xmath1070 that are not @xmath1123-typical .",
    "if @xmath1124 , then we have that @xmath1141 so @xmath1142 . here",
    "we define @xmath1143 and @xmath1144 .",
    "if @xmath1087 and @xmath1126 , then our assumption gives us @xmath1145 so if we can show that @xmath1146 this will imply @xmath1147 , which will prove the claim .",
    "to show , let @xmath1148 $ ] , and recall that @xmath1149 and @xmath1150 . clearly , @xmath1151 therefore , when @xmath1152 , @xmath1153 , and @xmath1154 , so @xmath1155 when @xmath1156 , @xmath1157 , and @xmath1158 , so @xmath1159 therefore , @xmath1160    let @xmath1161 be an ordered collection of @xmath1162 pairwise disjoint subsets of @xmath951 .",
    "we say that an @xmath2-set @xmath1163 is _",
    "@xmath1164-balanced _ ,",
    "if    * @xmath1165 $ ] contains a copy of @xmath97 , * @xmath1166 for all @xmath1072 $ ] , and * @xmath1167 when @xmath1168 .",
    "a set @xmath28 is called _ @xmath1164-well - balanced _ ,",
    "if @xmath28 is @xmath1164-balanced , and when @xmath1108 , @xmath28 intersects exactly one of the two sets @xmath1169 and @xmath1170 , i.e. for some @xmath1171 , @xmath1172 and @xmath1173 .",
    "note that when @xmath1114 every @xmath1164-balanced set is a @xmath1164-well - balanced set .",
    "we say that a vertex is _ excellent for @xmath772 _ if it is @xmath1174-typical and we say that a vertex is _ good for @xmath772 _ if it is @xmath1175-typical . we make the following definitions : @xmath1176 } b_i,\\ ] ] and we let @xmath1177 } c_i.\\ ] ] we let @xmath1178 be the ordered collection @xmath1179 and @xmath1180 be the ordered collection @xmath1181 .",
    "note that , by claim  [ clm : typical ] , every vertex is good for at most one index @xmath1102 $ ] , so the sets @xmath1182 are pairwise disjoint .",
    "note that , for every @xmath1102 $ ] , each vertex @xmath1183 is not good for @xmath772 , so it has a large number of edges into @xmath1184 .",
    "since each vertex @xmath1185 is adjacent to almost everything in @xmath1186 , we can argue below that there exists a set @xmath28 that is @xmath1178-well - balanced and such that @xmath1019 $ ] contains a copy of @xmath1187 . as we will see",
    ", this will allow us to easily distribute the vertices in @xmath1188 to sets in @xmath1180 .",
    "claims  [ clm : typical ] and  [ clm : nontypical_bound ] and the fact that @xmath1189 imply the following claim .",
    "[ clm : second_partition ] the following holds :    1 .",
    "[ clm : size_b_i_c_i ] @xmath1190 , and , in particular , for every @xmath1102 $ ] , @xmath1191 2 .",
    "[ clm : excellent ] for every @xmath1102 $ ] , + @xmath1192 , and + @xmath1193 ; 3 .",
    "[ clm : s_i_equals_2 ] for every @xmath1124 , if @xmath1129 , then @xmath1194    looking ahead , we will construct an ordered collection @xmath1195 such that @xmath1196 is a partition of @xmath951 and such that there exists a perfect @xmath1197-tiling in @xmath3 such that every element in the tiling is @xmath1198-well - balanced .",
    "this trivially implies that @xmath1198 must have the following properties :    1 .",
    "[ proper_std ] for every @xmath1072 $ ] and for @xmath1126 when @xmath1087 , @xmath1199 , 2 .",
    "[ proper_q_equals_2 ] when @xmath1108 , both @xmath1200 and @xmath1201 are divisible by @xmath1024 and @xmath1202 .    for any multigraph @xmath1203 ,",
    "call @xmath1204 a _ proper ordered collection of @xmath154 _ if the sets in @xmath1198 form a partition of @xmath1205 and it meets conditions ( [ proper_std ] ) and ( [ proper_q_equals_2 ] ) ( with @xmath1 replaced by @xmath1206 ) .",
    "let @xmath1207 for every @xmath1102 $ ] , so @xmath1208 .    in order to make the rest of the section easier to understand ,",
    "we now give a brief , informal description of the remainder proof for the case when @xmath1114 .",
    "it is very similar to the approach taken by komls , srkzy and szemerdi in their proof of the alon ",
    "yuster conjecture @xcite .",
    "we ignore the case when @xmath1110 in this description to avoid technical details .",
    "our main goal is to balance the sizes of the sets @xmath1182 .",
    "we begin by considering the sets that are too large , i.e. for every @xmath1102 $ ] such that @xmath1209 , we move exactly @xmath1210 vertices out of @xmath1211 to form the set @xmath279 .",
    "we want to ensure that the vertices which are moved out of @xmath1211 can eventually be covered by a copy of @xmath97 that has @xmath1212 other vertices in @xmath1211 .",
    "therefore , we argue that we can find a @xmath1213-tiling in @xmath1214 $ ] of size @xmath1210 . from each element of this tiling",
    "we arbitrarily select a vertex @xmath177 to remove from @xmath1211 when forming @xmath279 , and , temporarily , place @xmath177 into a set we call @xmath1215 .",
    "then we extend each element of this tiling to form a copy of @xmath1187 that has exactly @xmath1216 vertices in @xmath1217 for each @xmath1218 \\setminus i$ ] , and use the label @xmath1219 for this copy of @xmath1187 .",
    "so @xmath1220 is @xmath1180-well - balanced .",
    "we let @xmath1221 .",
    "note that , after this process has completed , we have that , for every @xmath1222 , @xmath1223 and @xmath1224 .",
    "next , we prepare to distribute the vertices that were not assigned to some set @xmath1211 . to do this , for every such @xmath1183 , we find a @xmath1225-well - balanced @xmath2-set @xmath547 such that @xmath1226 $ ] contains an element of @xmath1187 .",
    "we then label @xmath1227 as @xmath1219 , and add @xmath1219 to @xmath529 . throughout , we ensure that the elements in @xmath529 are vertex - disjoint .",
    "we let @xmath1228 .",
    "note that by claim  [ clm : second_partition]([clm : size_b_i_c_i ] ) , @xmath1229;~c_i < 0 } -c_i \\le       |\\overline{b}| \\le \\beta^2 n.\\ ] ] so we can distribute the small number of vertices in @xmath1230 arbitrarily to every @xmath279 such that @xmath1231 until @xmath1232 for every @xmath1102 $ ] .",
    "suppose @xmath1233 has been assigned to @xmath279 ; so @xmath1219 has exactly @xmath1212 vertices in @xmath1211 and , with @xmath177 , has @xmath1234 vertices in @xmath279 .",
    "we can then arbitrarily remove one element from @xmath1235 to create a @xmath1198-well - balanced set .",
    "after this has been done for every @xmath1233 , we have that @xmath529 is a @xmath97-tiling in which every element corresponds to a @xmath1198-well - balanced @xmath2-set .",
    "we let @xmath1236 and @xmath1237 for every @xmath1102 $ ] .",
    "so @xmath1238 is a proper ordered collection of @xmath154 and @xmath1239 for every @xmath1102 $ ] .",
    "claim  [ clm : proper_partitions ] below will then complete the proof .",
    "when @xmath1108 , our approach is similar .",
    "the main difference is that we have to be somewhat careful to ensure that @xmath1200 and @xmath1201 are both divisible by @xmath1024 .",
    "the details for all cases are in section  [ sec : finishing ] .",
    "we now continue the proof of theorem  [ thm : main_extremal ] by proving claim  [ clm : proper_partitions ] which will be used at the very end of the proof to construct the vast majority of elements of our tiling of @xmath3 .",
    "[ clm : proper_partitions ] let @xmath154 be an induced subgraph of @xmath3 such that @xmath1240 , and let @xmath1241 be a proper ordered collection of @xmath1205 . if @xmath1239 for every @xmath1102 $ ] , then there exists a perfect @xmath97-tiling in @xmath154 .    for @xmath1072 $ ] , we let @xmath1242 be a perfect @xmath1243-tiling of @xmath1244 $ ] .",
    "when @xmath1245 such a tiling trivially exists , and , when @xmath1246 , it exists by claim  [ clm : second_partition]([clm : s_i_equals_2 ] ) . when @xmath1118 , we let @xmath1247 be a perfect @xmath1025-tiling of @xmath1248 $ ] . by claim  [ clm : second_partition]([clm : excellent ] ) , this is easy to find when @xmath1108 by , say , applying the hajnal ",
    "szemerdi theorem to the graph induced by the heavy edges of @xmath1249 and then to the graph induced by the heavy edges of @xmath1250 .",
    "( actually the use of the hajnal  szemerdi theorem here is overkill ; it is very easy to directly argue the desired perfect tiling in @xmath1248 $ ] exists . )",
    "when @xmath1131 , it is implied by claim  [ clm : tolerant_sets]([clm : factor ] ) , because @xmath1251 and @xmath1252    let @xmath1253 when @xmath1254 , or let @xmath1255 , when @xmath1118 , and let @xmath8 be a @xmath140-partite graph with vertex classes @xmath1256 such that , for every distinct @xmath1257 $ ] , @xmath1258 and @xmath1259 , @xmath28 is adjacent to @xmath547 when every vertex in @xmath28 is heavily adjacent to every vertex in @xmath547 .",
    "note that @xmath8 is balanced with each vertex class of size @xmath1260 .",
    "so we are done if there is a perfect @xmath1261-tiling in @xmath8 . by claim  [ clm : second_partition]([clm : excellent ] ) , when @xmath1262 are distinct and @xmath1258 , the number of neighbours of @xmath28 in @xmath1263 is at least @xmath1264    for some @xmath1265 , assume we have a perfect @xmath1266-tiling @xmath1267 of @xmath1268 $ ] .",
    "we extend @xmath1267 to a perfect @xmath1269-tiling of @xmath1270 $ ] by finding a perfect matching in the bipartite graph with vertex classes @xmath1267 and @xmath1271 in which @xmath1272 is adjacent to @xmath1273 when @xmath1274 is a copy of @xmath1275 in @xmath8 . by , this bipartite graph has minimum degree at least @xmath1276 , so hall s theorem implies that it has a perfect matching .",
    "since this holds for every @xmath1277 , there exists a perfect @xmath1261-tiling in @xmath8 .    in claim  [ clm :",
    "extend_partial_clique]([clm : extend_partial_clique_std ] ) below we establish that , for some @xmath1278 $ ] , we can extend a copy of @xmath1279 ( resp .",
    "@xmath1280 ) that is contained in some @xmath1281 where @xmath1282 or extend a copy of @xmath1022 ( resp .",
    "@xmath1283 ) contained in @xmath1284 to a copy of @xmath1187 ( resp .",
    "@xmath1285 ) with the correct number of vertices in every @xmath1217 for @xmath1218 - i$ ] .",
    "this is used when we remove elements from the sets @xmath1281 that are too large as described in the overview above .",
    "when @xmath1108 , we use claim  [ clm : extend_partial_clique]([clm : extend_partial_clique_std ] ) with @xmath803 when @xmath1286 to move vertices between @xmath1287 to @xmath1288 to make the order of both sets divisible by @xmath1024 . the second part of the lemma , ( [ clm : extend_partial_clique_special ] ) , which is only used when @xmath1108 , is similar but we start with a copy of @xmath1279 in some @xmath1281 with @xmath1282 and extend it only into a copy of @xmath97 .",
    "furthermore , for any @xmath1289 , this @xmath97 will have exactly @xmath1290 vertices in @xmath1287 and @xmath1291 vertices in @xmath1288 .",
    "this is used because sometimes when we must move a vertex from some @xmath1281 with order greater than @xmath1292 , to @xmath1287 because the order of @xmath1293 is slightly less than @xmath963 , we may also have to move some vertices in @xmath1288 to @xmath1287 to ensure that both sets are divisible by @xmath1024 .",
    "[ clm : extend_partial_clique ] let @xmath1294 such that @xmath1295 , let @xmath1278 $ ] and @xmath1296 .",
    "when @xmath1282 , let @xmath1297 such that @xmath1298 and when @xmath1299 , let @xmath1300 such that @xmath1301 .",
    "suppose that @xmath1302 $ ] contains an element of @xmath1303 .    1 .",
    "[ clm : extend_partial_clique_std ] there exists a set @xmath28 that avoids @xmath725 such that @xmath1304 is @xmath1305-balanced when @xmath803 , or , when @xmath1306 , @xmath1307 is @xmath1305-balanced for any @xmath1308 .",
    "furthermore , when @xmath1108 , the set @xmath28 does not intersect @xmath1288 .",
    "[ clm : extend_partial_clique_special ] when @xmath1108 , @xmath1306 , and @xmath1309 , for any @xmath1310 and @xmath1311 , there exists a set @xmath28 that avoids @xmath725 such that @xmath1312 $ ] contains an element of @xmath97 , @xmath1313 , @xmath1314 and @xmath1315 for each @xmath1072 - k$ ] .",
    "we will construct @xmath28 iteratively , and throughout , we let @xmath1316 assuming @xmath1317 , claim  [ clm : second_partition]([clm : excellent ] ) implies that for all @xmath772 such that @xmath1318 , @xmath1319    we start the construction by adding vertices from @xmath1320 to @xmath28 .",
    "if @xmath1105 , or @xmath1118 and @xmath1321 , we do not add any vertices from @xmath1320 to @xmath28 .",
    "otherwise , we know @xmath1322 is large by since @xmath1323 . if @xmath1087 , then , since @xmath1324 , claim  [ clm : tolerant_sets]([clm : kbar_in_uprime ] ) and claim  [ clm : second_partition]([clm : size_b_i_c_i ] ) imply that we can let @xmath1325 such that @xmath1326 and @xmath1165 $ ] contains an element of @xmath1327 . to prove ( [ clm : extend_partial_clique_std ] ) when @xmath1108 , note that and claim  [ clm : second_partition]([clm : excellent ] ) , imply that we can let @xmath28 induce a clique of size @xmath1024 on heavy edges in @xmath1328",
    ". to prove ( [ clm : extend_partial_clique_special ] ) , we start by using and claim  [ clm : second_partition]([clm : excellent ] ) to find vertices @xmath1329 that form a clique on heavy edges and add these vertices to @xmath28 .",
    "if @xmath1330 , we are done , so assume that this is not the case , which implies that @xmath1331 .",
    "therefore , claim  [ clm : second_partition]([clm : excellent ] ) and claim  [ clm : second_partition]([clm : s_i_equals_2 ] ) , imply that we can find @xmath1332 vertices in @xmath1333 that form a clique on heavy edges .",
    "we then add these vertices to @xmath28 .",
    "note that in this case when @xmath1334 either @xmath1335 and @xmath1336 or @xmath1337 and @xmath1338 .",
    "so in this case currently @xmath1165 $ ] contains all possible edges except that it may have a light path on @xmath24 vertices .",
    "now , for every @xmath1339 , in turn we use , to add either one vertex , when @xmath1134 , or two adjacent vertices , when @xmath1129 , from @xmath1340 to @xmath28 .",
    "when @xmath1129 we can easily find two adjacent vertices in @xmath1340 using claim  [ clm : second_partition]([clm : s_i_equals_2 ] ) .",
    "further , note that by definition of @xmath1340 , in this step any selected vertices in @xmath1340 send heavy edges to all previously selected elements of @xmath1341 .",
    "this ensures that there are all possible edges in @xmath1342 $ ] except for perhaps a collection of vertex - disjoint light edges , and at most one path on @xmath24 vertices ( in the case when @xmath1334 ) .",
    "that is , @xmath1343 $ ] is a copy of @xmath1344 .",
    "it is now easy to see that the claim holds .",
    "the main purpose of claim  [ clm : extend_overline_c]([clm : extend_overline_c_std ] ) is to help distribute the vertices @xmath1183 .",
    "we construct a @xmath1225-well balanced set @xmath28 such that @xmath1019 $ ] contains an element of @xmath1187 ; thus we can then move @xmath177 to any set @xmath279 and remove any element in @xmath1345 from @xmath28 leaving a @xmath1346-well - balanced set .",
    "when @xmath1110 , we may need to move some @xmath1183 to one of @xmath1347 for @xmath1348 and , at the same time , move some vertices from @xmath1349 to @xmath1347 to ensure that @xmath1350 and @xmath1351 are both divisible by @xmath1024 .",
    "this is the reason for claim  [ clm : extend_overline_c]([clm : extend_overline_c_special ] ) .",
    "note that the following claim is essentially the reason we define both the sets @xmath1352 and the sets @xmath1353 .",
    "[ clm : extend_overline_c ] let @xmath1294 such that @xmath1295 and @xmath1183 .    1 .",
    "[ clm : extend_overline_c_std ] there exists a @xmath1225-well - balanced set @xmath28 that avoids @xmath725 such that @xmath1019 \\in \\k'_{r+1}$ ] .",
    "[ clm : extend_overline_c_special ] when @xmath1108 , for @xmath1310 and @xmath1311 , there exists a set @xmath28 that avoids @xmath725 such that @xmath1019 $ ] contains an element of @xmath97 , @xmath1354 , @xmath1355 and @xmath1356 for each @xmath1072 $ ] .    for any @xmath1102",
    "$ ] , if @xmath1124 , since @xmath177 it not @xmath1175-typical , claim  [ clm : second_partition]([clm : size_b_i_c_i ] ) implies that @xmath1357 similarly , when @xmath1087 , since @xmath177 is not @xmath1358-typical , @xmath1359 and @xmath1360 for @xmath1102 $ ] , let @xmath1361 .",
    "we have that , by claim  [ clm : second_partition]([clm : size_b_i_c_i ] ) , @xmath1362 let @xmath1363 and note that there are at least @xmath1364 vertices in @xmath1365 that are not heavy neighbours of @xmath177 . by , when @xmath1366 , @xmath1367 , so there exists @xmath1368 \\setminus i$ ] , and @xmath1369 hence , in all cases , @xmath1370 , and , for any @xmath1218 \\setminus i$ ] , @xmath1371    we prove ( [ clm : extend_overline_c_std ] ) and ( [ clm : extend_overline_c_special ] ) simultaneously .",
    "let @xmath1296 , so that @xmath1372 is the number of vertices of @xmath28 that will intersect @xmath1373 , i.e.   when we are proving ( [ clm : extend_overline_c_std ] ) we have @xmath1306 and when we are proving ( [ clm : extend_overline_c_special ] ) we have @xmath803 .",
    "we now give a brief overview of our plan for constructing the set @xmath28 .",
    "clearly we must construct @xmath28 so that every pair of vertices in @xmath1374 are adjacent .",
    "we will also have that    * the only light edges in @xmath1019 $ ] that are not incident to @xmath177 , are in the subgraphs @xmath1375 $ ] where @xmath1129 , or are in @xmath1376 $ ] when @xmath1118 ; * @xmath177 is heavily adjacent to every vertex @xmath765 in @xmath1377 when @xmath1378 ; * if @xmath1118 , @xmath1379 $ ] will contain an element of @xmath1380 .",
    "if @xmath177 has at most one light neighbour in @xmath28 , this is enough to give us that @xmath1019 $ ] contains a an element of @xmath1381 , which would prove the claim .",
    "however , we can only ensure that @xmath177 has at most two light neighbours in @xmath28 . to prove the claim",
    ", we will then also meet one of the following conditions when @xmath177 has two light neighbours in @xmath28 :    * the two light neighbours of @xmath177 are in different sets @xmath1382 such that @xmath1383 and @xmath1384 and if @xmath1118 , @xmath1385 $ ] contains an element of @xmath1386 except possibly when @xmath1110 , @xmath1334 , @xmath803 and @xmath1387 , and in this case it contains an element of @xmath1388 ; or * @xmath1108 , @xmath1389 , @xmath1390 , @xmath1391 and the two light neighbours of @xmath177 are in some @xmath1382 where @xmath1383 and these two light neighbours are heavily adjacent ; or * @xmath1108 , @xmath1389 , @xmath1392 , @xmath1393 , @xmath1394 , @xmath177 has one light neighbour in @xmath1395 and the other light neighbour is in some @xmath1382 where @xmath1383 and @xmath1384 ; or * @xmath1131 , @xmath1396 , one light neighbour of @xmath177 is in the set @xmath1382 such that @xmath1383 and the other light neighbour of @xmath177 is in @xmath1397 and @xmath1398 $ ] contains an element of @xmath1399 .",
    "we build the set @xmath28 iteratively .",
    "we start by adding vertices from @xmath1400 to @xmath28 , so when @xmath1105 we do not add anything to @xmath28 .",
    "recall that @xmath1324 .",
    "if @xmath1087 and @xmath1401 , then , and claim  [ clm : tolerant_sets]([clm : v_khat_s_plus_1 ] ) , imply that we can choose @xmath1402 , such that @xmath1326 , @xmath1019 $ ] contains an element of @xmath1020 and in which @xmath177 has one light neighbour . if @xmath1087 and @xmath1393 , then by , , and claim  [ clm : tolerant_sets]([clm : kbar_in_uprime ] ) we can let @xmath1402 be such that @xmath1403 and @xmath1165 $ ] contains an element of @xmath1327 .",
    "now assume @xmath1108 . to prove ( [ clm : extend_overline_c_std ] ) , when @xmath1391 , we pick @xmath1310 arbitrarily , otherwise we let @xmath1404 . recall that @xmath1405 implies that @xmath1406 .",
    "let @xmath1407 when @xmath1405 and let @xmath1408 when @xmath1409 .",
    "note that , @xmath1410 , in either case .",
    "we now use claim  [ clm : second_partition]([clm : excellent ] ) to find an @xmath1024-set @xmath1411 such that @xmath28 induces a clique on heavy edges in @xmath3 .    to prove ( [ clm : extend_overline_c_special ] ) , we assume @xmath1310 is given . note that if @xmath1405 , then we must have that @xmath1406 and @xmath1412 .",
    "again , we let @xmath1413 when @xmath1405 and let @xmath1408 when @xmath1409 , so @xmath1414 .",
    "now we use claim  [ clm : second_partition]([clm : excellent ] ) to find vertices @xmath1415 such that they induce a clique on heavy edges in @xmath3 , and we add these vertices to @xmath28 .",
    "if @xmath1330 , we are done , so assume that this is not the case , which implies that @xmath1331 .",
    "therefore , claim  [ clm : second_partition]([clm : s_i_equals_2 ] ) and claim  [ clm : second_partition]([clm : excellent ] ) , imply that we can find @xmath1332 vertices in @xmath1416 that induce a clique on heavy edges in @xmath3 .",
    "we then add these vertices to @xmath28 .",
    "if @xmath1417 , then @xmath1165 $ ] contains an element of @xmath1418 and when @xmath1419 it is a clique on heavy edges",
    ".    note that in all cases the way we have constructed @xmath28 so far ensures that ( @xmath1420 ) holds .",
    "now , in turn for each @xmath772 with @xmath1421 , we will add @xmath1212 vertices from @xmath1382 to @xmath28 . at each step , when @xmath1383 , we let @xmath1422 ( so the definition of @xmath817 gets updated at each step , as we add more elements to @xmath28 . ) note that , with claim  [ clm : second_partition]([clm : excellent ] ) , @xmath1423 in both cases .",
    "when @xmath1134 , we we add one vertex from @xmath817 to @xmath28 , and when @xmath1129 , we can add two adjacent vertices in @xmath817 to @xmath28 , since claim  [ clm : second_partition]([clm : s_i_equals_2 ] ) implies that there exists an edge in @xmath1424 $ ] .",
    "this completes the construction of @xmath28 .",
    "note that ( @xmath1425 ) and ( @xmath1426 ) immediately hold .",
    "further , one of ( @xmath1427)(@xmath1428 ) holds in each case .",
    "it is easy to see that in any case we obtain a set @xmath28 as desired .",
    "we now finish the proof by constructing @xmath1429 a proper ordered collection of @xmath3 and a collection @xmath529 of vertex - disjoint @xmath1198-well - balanced sets as described above .",
    "we build the collection @xmath529 iteratively , and , at times , it may include @xmath1430-sets , as well as @xmath2-sets .",
    "let @xmath1431 for every @xmath1102 $ ] .",
    "for each @xmath1072 $ ] such that @xmath1222 , we will find a @xmath1432-tiling @xmath1433 of @xmath1214 $ ] containing exactly @xmath1210 elements .",
    "when @xmath1134 , each vertex in @xmath1211 has at least @xmath1434 neighbours in @xmath1211 .",
    "therefore , by lemma  [ lem : matching ] , we can let @xmath1433 be a matching of size @xmath1210 in @xmath1214 $ ] .",
    "similarly , for @xmath1072 $ ] such that @xmath1129 and @xmath1435 , there exists a matching @xmath72 containing at least @xmath1436 heavy edges in @xmath1214 $ ] , and , by claim  [ clm : second_partition]([clm : s_i_equals_2 ] ) , we can pair each edge in @xmath1437 to a distinct vertex @xmath1438 such that @xmath1438 is a neighbour of both endpoints of @xmath767 .",
    "therefore , we have a collection @xmath1433 of @xmath1210 vertex - disjoint elements of @xmath1439 in @xmath1214 $ ] .",
    "we let @xmath1440 be the union of the sets @xmath1433 constructed so far .",
    "if @xmath1087 and @xmath1441 , we can use claim  [ clm : tolerant_sets]([clm : large_cliques ] ) to find a @xmath1022-tiling of size @xmath1442 in @xmath1443 $ ] , we call this tiling @xmath1444 and we add it to @xmath1440",
    ".    now suppose @xmath1108 and @xmath1286 ; we find a tiling consisting of exactly @xmath1445 copies of @xmath1022 in @xmath1287 .",
    "note that this is trivial to do , by claim  [ clm : second_partition]([clm : excellent ] ) .",
    "indeed , we can easily find @xmath1446 vertex disjoint @xmath1447-sets in @xmath1287 , each forming a clique in the heavy edges of @xmath1443 $ ] .",
    "we call this set @xmath1444 and we add the sets in @xmath1444 , to @xmath1440 .",
    "note that there is slack in the argument here : given a single fixed set @xmath1448 where @xmath1449 we can additionally ensure no tile in @xmath1444 intersects @xmath76 .",
    "we will use this property shortly .",
    "we have now completely defined @xmath1450 .",
    "our next goal is to construct the sets @xmath1451 such that @xmath1429 is a proper ordered collection of @xmath3 .",
    "we will first define the @xmath279 for @xmath772 such that @xmath1452 .",
    "once we have done this we will then define the remaining @xmath279 .",
    "suppose that @xmath1108 and @xmath1286 .",
    "remove @xmath1453 vertices from @xmath1287 and call the resulting set @xmath1350 ; we do this in such a way that these removed vertices consist of precisely one vertex from each tile in @xmath1454 .",
    "place these @xmath1453 vertices into a set @xmath1215 .",
    "let @xmath1455 .",
    "this ensures that @xmath1456 .",
    "however , we also need to ensure that both @xmath1200 and @xmath1201 are divisible by @xmath1024 .",
    "therefore , we will find a set @xmath1457 and a set @xmath1458 such that , @xmath1459 , @xmath1460 $ ] contains an element of @xmath1025 , and @xmath1461 we will then move the vertices in @xmath77 from @xmath1351 to @xmath1350 .",
    "we will need the exact minimum degree condition to construct these sets @xmath184 .",
    "so actually formally what we do is first construct @xmath76 and @xmath77 then the collection @xmath1444 as before such that @xmath1444 is disjoint from the set @xmath76 .",
    "also , for consistency , we will construct the sets @xmath76 and @xmath77 even when there is no divisibility issue , i.e.   when @xmath1462 is divisible by @xmath1024 . in this case , we let @xmath877 and @xmath76 be a clique on @xmath1024 vertices in the heavy edges of @xmath1443 $ ] , which can be found easily using claim  [ clm : second_partition]([clm : excellent ] ) .",
    "therefore , it only remains to show how we construct @xmath76 and @xmath77 when @xmath1462 is not divisible by @xmath1024 . if @xmath1406 , then , for some @xmath1463 , @xmath1464 , so @xmath1465 , which implies that every vertex in @xmath1466 has a neighbour in @xmath1211 , and , in particular , there exists an edge @xmath54 such that @xmath1467 and @xmath1468 , and we let @xmath1469 and @xmath1470 . if @xmath1331 , then for some @xmath1171 , @xmath1471 , and @xmath1472 , which implies that every vertex in @xmath1466 has a heavy neighbour in @xmath1211 and we can let @xmath1473 be a heavy edge such that @xmath1474 and @xmath1475 .",
    "let @xmath1476 be such that @xmath1477 and @xmath1478 . by claim  [ clm : second_partition]([clm : excellent])(iii ) , we can find vertices @xmath1479 in @xmath1480 , such that @xmath1481 induces a clique on heavy edges , and then find vertices @xmath1482 in @xmath1483 such that @xmath1484 induces a clique on heavy edges .",
    "note that @xmath1460 $ ] contains an element of @xmath1485 .",
    "we have described how to define @xmath1350 and @xmath1351 in the case when @xmath1110 and @xmath1486 .",
    "we now describe in general how to construct @xmath279 when @xmath1487 . using claim  [ clm : extend_partial_clique]([clm : extend_partial_clique_std ] )",
    ", we can find , for each set in @xmath1488 , a set @xmath547 such that @xmath1489 $ ] contains an element of @xmath1187 and when we arbitrarily select a vertex @xmath1308 , the set @xmath1490 is @xmath1180-balanced .",
    "we let @xmath1215 be the set of these arbitrarily selected vertices . recall that when @xmath1108 , the set @xmath1491 does not intersect @xmath1288 , so @xmath1490 is actually @xmath1180-well - balanced .",
    "we label @xmath1492 as @xmath1219 and @xmath1491 as @xmath1493 . by claim  [ clm : extend_partial_clique]([clm : extend_partial_clique_std ] ) , we can assume that , for every @xmath1494 , the sets @xmath1219 were constructed so as to be vertex - disjoint and , when @xmath1108 , disjoint from @xmath1495 . for every @xmath1494 , we add @xmath1219 to @xmath529 . when @xmath1108 , using claim  [ clm : extend_partial_clique]([clm : extend_partial_clique_std ] ) , we find a set @xmath547 , disjoint from all of the previously constructed sets , such that @xmath1496 $ ] contains an element of @xmath97 and @xmath1497 for each @xmath1072 $ ] , and we add @xmath1498 to @xmath1027 .",
    "we now let @xmath1499$},\\ ] ] and note that for every @xmath1072 $ ] , if @xmath1222 , then @xmath1224 . furthermore , when @xmath1118 and @xmath1500 , we have that @xmath1501 , and , when @xmath1108 , we also have that both @xmath1200 and @xmath1502 are divisible by @xmath1024 .    for each vertex @xmath1183 , we use claim  [ clm : extend_overline_c]([clm : extend_overline_c_std ] ) to find a vertex set @xmath1219 that is @xmath1178-well - balanced and such that @xmath1503 $ ] contains a @xmath1187 .",
    "we add @xmath1504 to @xmath529 and ensure that these sets are disjoint from the sets already in @xmath529 .",
    "let @xmath1505 and recall that , for every @xmath1072 $ ] such that @xmath1506 , we currently have that @xmath1507 .",
    "at this point , every vertex in @xmath951 is either in one of the sets @xmath1196 or is in @xmath1230 .",
    "we now move vertices from @xmath1230 to sets in @xmath1198 that are `` too small '' until we have the desired proper ordered collection .",
    "when we do this we also make small changes to the collection @xmath529 so that every @xmath1508 will be a @xmath1198-well - balanced @xmath2-set .    in detail , for every @xmath1233 and @xmath1102 $ ] , when we say we _",
    "assign @xmath177 to @xmath279 _ we mean that we add @xmath177 to the set @xmath279 and update @xmath1219 by removing one @xmath1509 from @xmath1219 and add @xmath177 to @xmath1219 .",
    "this is only well - defined when there is initially some @xmath1509 in @xmath1219 .",
    "note that in this case the updated version of @xmath1510 is @xmath1198-well - balanced . if initially @xmath1219 contains no element from @xmath1211 then @xmath1108 , @xmath1171 , and @xmath1219 intersects @xmath1511 instead of @xmath1211 .",
    "furthermore , since we are moving a vertex to either @xmath1287 or @xmath1288 from @xmath1230 , it must be that @xmath1512 , and so if @xmath1494 then @xmath1513 for some @xmath1072 $ ] such that @xmath1209 . in this case",
    "when we assign @xmath177 to @xmath279 we instead complete the following process : we first remove @xmath1219 from @xmath529 .",
    "then , if @xmath1183 , we use claim  [ clm : extend_overline_c]([clm : extend_overline_c_special ] ) , to find a set @xmath1514 such that @xmath1515 $ ] contains an element of @xmath97 , @xmath1516 for every @xmath1148 $ ] , @xmath1517 , @xmath1518 .",
    "then let @xmath1519 and add it @xmath529 .",
    "similarly , when @xmath1494 , we use claim  [ clm : extend_partial_clique]([clm : extend_partial_clique_special ] ) to find a set @xmath1520 such that @xmath1521 $ ] contains an element of @xmath97 , @xmath1522 where @xmath1523 $ ] such that @xmath1524 , @xmath1525 for every @xmath1148 - k$ ] , @xmath1526 , @xmath1527 , and let @xmath1528 and add it @xmath529 .",
    "we then add @xmath177 to @xmath279 .",
    "note that now @xmath1219 is @xmath1346-well - balanced . for any @xmath1102 $ ] such that @xmath1529 , we then arbitrarily assign exactly @xmath1530 of the remaining vertices in @xmath1230 to @xmath279 , except when @xmath1108 and @xmath1171 .",
    "when @xmath1108 and @xmath1512 , we again have to be careful to ensure that , in the end , both @xmath1200 and @xmath1201 are divisible by @xmath1024 .",
    "therefore , assume that , when @xmath1108 , we assign vertices from @xmath1230 to @xmath1350 and @xmath1351 before we assign vertices in @xmath1230 to any @xmath279 for @xmath1384 . also , note that , because @xmath1531 , @xmath1532 . to help us organise the assignment of vertices ,",
    "we let @xmath1310 , so that if we let @xmath1533 be such that @xmath1534 then @xmath1535 . if @xmath1536 , we assign @xmath1537 vertices in @xmath1230 to @xmath1538 and then assign vertices from @xmath1230 to @xmath1539 until @xmath1456 . otherwise , we can assume @xmath1540 , which implies @xmath1331 , and @xmath1541 . note that if @xmath1542 , then @xmath1543 , so @xmath1544 . therefore , exactly one of the two following conditions must hold : @xmath1545 in either case , we arbitrarily pick @xmath1233 , add @xmath177 to @xmath1539 and delete @xmath1219 from @xmath529 .",
    "we then use claim  [ clm : extend_overline_c]([clm : extend_overline_c_special ] ) ( if @xmath1183 ) or claim  [ clm : extend_partial_clique]([clm : extend_partial_clique_special ] ) ( if @xmath1494 ) , to construct a @xmath1346-balanced set @xmath1219 containing @xmath177 that has one vertex in @xmath1546 and two vertices in @xmath1547 .",
    "we then move both of the vertices in @xmath1548 from @xmath1538 to @xmath1539 . in both cases",
    ", we now have that @xmath1549 is divisible by @xmath94 , and @xmath1219 is @xmath1198-well - balanced .",
    "we then assign the possibly one remaining vertex in @xmath1230 to @xmath1538 , so @xmath1550 is divisible by @xmath94 as well .    for every @xmath1102 $ ] , we let @xmath1551 , and note that @xmath1239 .",
    "therefore , if @xmath1236 , then @xmath1241 is a proper ordered collection of @xmath154 , so , by claim  [ clm : proper_partitions ] there exists a perfect @xmath97-tiling @xmath1552 of @xmath154 , and @xmath1553 is a perfect @xmath97-tiling of @xmath3 .",
    "this research was partially carried out whilst the last three authors were visiting the institute for mathematics and its applications at the university of minnesota .",
    "the authors would like to thank the institute for the nice working environment .",
    "the last two authors were also supported by the bridge strategic alliance between the university of birmingham and the university of illinois at urbana - champaign , as part of the ` building bridges in mathematics ' bridge seed fund project .",
    "10 n. alon and a. shapira , testing subgraphs in directed graphs , _ j. comput .",
    "system sci . _",
    "* 69 * ( 2004 ) , 354382 .",
    "n.  alon and r.  yuster , almost @xmath8-factors in dense graphs , _",
    "graphs combin . _",
    "* 8 * ( 1992 ) , 95102 .",
    "benevides , t. uczak , a. scott , j. skokan  and m. white , monochromatic cycles in @xmath12-coloured graphs , _ combin .",
    "comput . _  * 21 * ( 2012 ) , 5787 .",
    "a. czygrinow , l. debiasio , h.a .",
    "kierstead and t. molla , an extension of the hajnal  szemerdi theorem to directed graphs , _ combin .",
    "_  * 24 * ( 2015 ) , 754773 .",
    "a. czygrinow , h.a .",
    "kierstead and t. molla , on directed versions of the corrdi ",
    "hajnal corollary , _",
    "european j. combin . _  * 42 * ( 2014 ) , 114 . c. grosu and j. hladk , the extremal function for partial bipartite tilings ,",
    "european j. combin . _",
    "* 33 * ( 2012 ) , 807815 .",
    "a. hajnal and e.  szemerdi , proof of a conjecture of erds , _ combinatorial theory and its applications vol .",
    "ii _  * 4 * ( 1970 ) , 601623 .",
    "f. havet , s. thomass , oriented hamiltonian paths in tournaments : a proof of rosenfeld s conjecture , _ j. combin .",
    "theory b _ * 78 * , ( 2000 ) , 243273 .",
    "p. hell and d.g .",
    "kirkpatrick , on the complexity of general graph factor problems , _ siam j. computing _",
    "* 12 * ( 1983 ) , 601609 .",
    "s. janson , t. uczak  and  a. ruciski , _ random graphs _ , wiley , 2000 .",
    "p. keevash and r. mycroft , a multipartite hajnal  szemerdi theorem , _",
    "j. combin .",
    "theory  b _ * 114 * ( 2015 ) , 187236 .",
    "p. keevash and b. sudakov , triangle packings and 1-factors in oriented graphs , _ j. combin .",
    "theory  b _  * 99 * ( 2009 ) , 709727 . h.a .",
    "kierstead and a.v .",
    "kostochka , an ore - type theorem on equitable coloring ,",
    "_ j. combin .",
    "theory b _",
    "* 98 * ( 2008 ) , 226234 .",
    "kierstead and a.v .",
    "kostochka , a short proof of the hajnal  szemerdi theorem on equitable coloring , _ combin .",
    "_  * 17 * ( 2008 ) , 265270 .",
    "j. komls , tiling turn theorems , _ combinatorica _  * 20 * ( 2000 ) , 203218 .",
    "j.  komls , g.  srkzy , and e.  szemerdi , proof of the alon  yuster conjecture , _ disc .",
    "_  * 235 * ( 2001 ) , 255269 .",
    "d. khn and d. osthus , critical chromatic number and the complexity of perfect packings in graphs , _",
    "17th acm - siam symposium on discrete algorithms _",
    "( soda 2006 ) , 851859 . d. khn and d.",
    "osthus , the minimum degree threshold for perfect graph packings , _ combinatorica _  * 29 * ( 2009 ) , 65107 .    d. khn and d. osthus , embedding large subgraphs into dense graphs , in _ surveys in combinatorics _ ( s. huczynska , j.d .",
    "mitchell and c.m .",
    "roney - dougal eds . ) , _ london math .  soc .",
    "lecture notes _  * 365 * , 137167 , cambridge university press , 2009 .",
    "a. lo and k. markstrm , @xmath1230-factors in hypergraphs via absorption , _ graphs combin . _",
    "* 31 * ( 2015 ) , 679712 .",
    "t.  molla , _ tiling directed graphs with cycles and tournaments _ , ph.d .",
    "thesis , arizona state university , tempe , arizona , 2013 .",
    "v. rdl , a. ruciski and e. szemerdi , a dirac - type theorem for 3-uniform hypergraphs , _ combin .",
    "comput . _  * 15 * ( 2006 ) , 229251 .",
    "e.  szemerdi , regular partitions of graphs , _ problmes combinatoires et thorie des graphes colloques internationaux cnrs _ * 260 * ( 1978 ) , 399401 .      a. treglown , on directed versions of the hajnal  szemerdi theorem , _ combin . probab .",
    "_  * 24 * ( 2015 ) , 873928 .",
    "a.  treglown , a degree sequence hajnal - szemerdi theorem , _ j. combin .",
    "theory  b _ * 118 * ( 2016 ) , 1343 .",
    "h. wang , independent directed triangles in a directed graph , _ graphs combin . _  * 16 * ( 2000 ) , 453462 .",
    "h. wang and d. zhang , disjoint directed quadrilaterals in a directed graph , _ j. graph theory _  * 50 * ( 2005 ) , 91104 .",
    "r. yuster , tiling transitive tournaments and their blow - ups , _ order _  * 20 * ( 2003 ) , 121133 .",
    "y. zhao , recent advances on dirac - type problems for hypergraphs , _ recent trends in combinatorics _ , the i m a volumes in mathematics and its applications 159 .",
    "springer , new york , 2015 ."
  ],
  "abstract_text": [
    "<S> the hajnal  szemerdi theorem states that for any integer @xmath0 and any multiple @xmath1 of @xmath2 , if @xmath3 is a graph on @xmath1 vertices and @xmath4 , then @xmath3 can be partitioned into @xmath5 vertex - disjoint copies of the complete graph on @xmath2 vertices . </S>",
    "<S> we prove a very general analogue of this result for directed graphs : for any integer @xmath6 and any sufficiently large multiple @xmath1 of @xmath2 , if @xmath3 is a directed graph on @xmath1 vertices and every vertex is incident to at least @xmath7 directed edges , then @xmath3 can be partitioned into @xmath5 vertex - disjoint subgraphs of size @xmath2 each of which contain every tournament on @xmath2 vertices . </S>",
    "<S> a related turn - type result is also proven .        </S>",
    "<S> [ firstpage ] </S>"
  ]
}