{
  "article_text": [
    "on account of the recent developments of the grid computing environment , we can use many computer resources more than a thousand cpus .",
    "however , those large distributed resources are accessible only when we pass through some gateway to the grid system after a tedious procedure for grid - enabling of application programs . thus , for scientists in nanoscience to use the grid system as one of the daily tools , it is important to make their applications grid - aware in advance .    on the other hand , the development on high performance computing ( hpc ) environments shows no sign of slowing down , and , within several years , we might reach the scale of peta ( @xmath0 ) in computer resources for scientific computing .",
    "it is expected that the `` peta - scale computer '' exhibits more than a peta flops performance in floating - point calculations , its available memory is more than a peta byte in total , or it has external storages amount to more than a peta byte .",
    "thus , the global trend in hpc is now to study how to realize the peta - scale computing@xcite .",
    "the purpose of this paper is twofold : one is to present our computational results in nanoscience supported by the japanese grid project , national research grid initiative ( naregi)@xcite , and the other is to show a perspective about the hpc applications for peta - scale computing .",
    "this paper is coordinated as follows .",
    "those computational results using the fragment molecular orbital method ( fmo ) on grid computing environments are shown in section [ sec : naregi ] .",
    "the performance prediction of the fmo calculation in a peta - scale computer is shown in section [ sec : prediction - peta ] , and the introduction of the actual implementation of fmo in order to realize peta - scale computing is given in section [ sec : open - fmo ] .",
    "finally in section [ sec : discussion ] , we discuss what is necessary in the actual peta - scale computing for scientific applications .",
    "in this section , we review the results on a grid - enabled version of fmo , and evaluate its effectivity in the grid testbed of naregi@xcite .",
    "our main contribution to the project is to develop large - scale grid - enabled applications in nanoscience .",
    "one of these applications is the grid - fmo which is based on the famous _ ab initio _ molecular orbital ( mo ) package program , gamess@xcite , and is constructed by dividing the package into several independent modules so that they are executed on a grid environment .",
    "the algorithm of fmo and the implementation of grid - fmo is briefly reviewed in the following subsections .",
    "the fmo method developed by dr .",
    "kitaura and co - workers@xcite can execute all electron calculation in large molecules with more than 10 thousands atoms .",
    "the brief overview of the flow of the fragment mo method up to dimer correction is the following : ( 1 ) the molecule to be calculated is divided into fragments , ( 2 ) _ ab initio _",
    "mo calculation@xcite is executed for each fragment ( monomer ) under the electro - static potential made by all the other fragments , and this calculation is repeated until the potential is self - consistently converged , ( 3 ) _ ab initio _ mo calculation is executed for pairs of fragments ( dimer ) , and ( 4 ) the total energy is obtained by summing up all the results .",
    "this algorithm of fmo is implemented in several famous mo packages such as gamess@xcite , abinit - mp@xcite , etc .",
    "although the most time - consuming part of this calculation is _ ab initio _ mo calculations for each fragment and each pair of fragments , these calculations can be executed independently .",
    "thus , fmo is easily executed in parallel computers with high efficiency .",
    "the fmo routines included in those famous packages are already parallelized for cluster machines , and are coordinated so that they exhibit efficient performance .",
    "however , if the program is used in distributed computing environments , we should consider robustness and controllability in addition to the efficiency .",
    "thus , grid - enabling is necessary . among many ways of grid - enabling ,",
    "we choose a strategy to reconfigure the program into a loosely - coupled form in order to satisfy such properties .",
    "we have developed a grid - enabled version of fmo , called a loosely - coupled ( lc ) fmo program@xcite , as part of the naregi project . at first",
    ", we show the procedure to change the gamess - fmo programs into a `` loosely - coupled form , '' where the original fmo in the gamess package is divided into several `` single task '' modules which are connected each other through input / output file transfers .",
    "those modules consists of run.ini for the initialization , run.mon for the fragment calculation ( monomer ) , run.dim for the fragment pair calculation ( dimer ) , and run.tot for the total energy calculation , and are invoked from a script program which also manages the file transfer over distributed computers .",
    "the total flow of the lc - fmo is shown in fig .",
    "[ fig : lc - fmo - flow ] .",
    "another benefit of the loosely - coupled form is the extendibility of its functionality .",
    "in fact , after the first release of the lc - fmo , we have developed two other modules which realize a linkage to the initial density database and a visualization feature of the total molecular orbitals . since the top - level program to invoke modules is lightweight and can be written in script languages , further modification of the total flow is easily performed .      in order to execute lc - fmo on the naregi grid",
    ", we put the flow of the program into naregi workflow tool@xcite .",
    "the graphical representation of the lc - fmo program is shown in fig .",
    "[ fig : wft ] , where modules and input / output files are represented in icons connected each other .",
    "this procedure is simple and straightforward because we have already reconstructed the program into a suitable form for distributed computing .",
    "thus , the important is whether the basic structure of the program is grid - aware or not .",
    "once a program is grid - enabled , we can execute it by the use of the large - scale computing resources over one thousand cpus . from the programmer s points of view",
    ", the most preferable thing is that we are relieved of arranging the resources to execute the program in high efficiency . in naregi testbed system@xcite",
    ", naregi super scheduler can manage the resource rearrangement with the help of naregi information service .",
    "robustness and efficiency are conflicting each other in general . since our reconstruction of fmo to increase the controllability might hurt the efficient execution of the program , it is necessary to evaluate the efficiency of lc - fmo by comparing with the original fmo program in gamess .    in table",
    "[ tbl : lc - fmo - elapsed ] , we show elapsed times for chicken egg white cystatin ( 1cew , 1701 atoms , 106 fragments , shown in fig .  [",
    "fig : lc - fmo - benchmark ] ) by the lc - fmo and the original gamess - fmo codes .",
    "this is obtained on the naregi testbed system which consists of 16 cpus of xeon 3ghz . generally speaking ,",
    "an increase of the total elapsed time is inevitable when we reconstruct some application into a loosely - coupled form , which is considered as a cost for grid - enabling .",
    "as shown in table [ tbl : lc - fmo - elapsed ] , however , the increase of the time is relatively small .",
    "thus , it is evaluated that the lc - fmo is effectively executed on grids .",
    ".the elapsed time for chicken egg white cystatin . [ cols=\"<,>,>\",options=\"header \" , ]      for ibm p5 , @xmath1 for xeon ) .",
    "lines are functions ( a ) @xmath2 , ( b ) @xmath3 , and ( c ) @xmath4 obtained by the least - square method .",
    "[ fig : time ] , title=\"fig : \" ] +   for ibm p5 , @xmath1 for xeon ) .",
    "lines are functions ( a ) @xmath2 , ( b ) @xmath3 , and ( c ) @xmath4 obtained by the least - square method .",
    "[ fig : time ] , title=\"fig : \" ] +   for ibm p5 , @xmath1 for xeon ) .",
    "lines are functions ( a ) @xmath2 , ( b ) @xmath3 , and ( c ) @xmath4 obtained by the least - square method .",
    "[ fig : time ] , title=\"fig : \" ]     by the least - square method . ]      in order to predict the total performance of fmo , it is convenient if the functions @xmath5 and @xmath6 are represented in simple functions of @xmath7 . by the least - square fitting of the data in table [ tbl : ibm ] and [ tbl : xeon ]",
    ", we obtain a function for the number of scf - dimers @xmath8 if we consider a constraint @xmath9 the number of es - dimers is represented in the form @xmath10    if we substitute these functions and parameters into eqs .",
    "( [ eqn : fm ] ) , ( [ eqn : fd ] ) , and ( [ eqn : fes ] ) , the total computational amount of fmo is obtained as a function of @xmath7 . as already seen in the previous section ,",
    "the fmo algorithm is appropriate for parallel executions when the number of fragments is large enough compared to the number of available nodes .",
    "suppose that we have a peta - scale computer with @xmath11 and @xmath12 , i.e. , the number of available nodes is 10,000 and each node has an effective speed 5 times faster than a node of ibm p5 1.9ghz which is used in this paper as a reference machine ( @xmath13 ) .",
    "then , the predicted elapsed time @xmath14 is calculated as a quadratic function of @xmath7 shown in fig . [",
    "fig : peta ] . from the viewpoint of the elapsed time",
    ", we can perform quantum calculations for molecules with more than 100,000 fragments if the peta - scale computer is realized .    according to the effective performance measurements on pcs",
    ", the fmo calculation is executed in 0.5 @xmath15 1.0 giga flops per one cpu of xeon or pentium4 , which means that our reference machine , a node of ibm p5 1.9ghz , exhibits almost 10 giga flops for the program since it is @xmath16 times faster than a xeon .",
    "then , the total performance of fmo calculations for a peta computer with @xmath11 and @xmath12 is considered as 0.5 peta flops .",
    "thus , fmo is considered as a predominant candidate which can record peta - scale performance .     predicted elapsed time of the fmo calculation by gamess as a function of the number of fragments @xmath7 .",
    "this is obtained on the assumption that 10,000 nodes are available , and each node is 5 times faster than a current machine . ]",
    "in spite of the fact that the fmo is a suitable algorithm to achieve the peta - scale performance through large - scale parallel executions , the actual gamess - fmo code can not be executed for the molecule with more than 100,000 fragments .",
    "one of the reason why the current program fails to run is memory consumption in each node , where the current fmo code in gamess tries to allocate two - dimensional arrays with respect to fragments , e.g. , the distance between two fragments .",
    "this exceeds 40 giga bytes even if we consider the symmetry .",
    "the limit of the number of fragment is considered as the order of 10,000 in the current implementation .",
    "thus , the reconstruction of the fmo code is necessary in order to correspond to the peta - scale computing .    in this section ,",
    "we introduce our new project to reconstruct a fmo program from scratch .",
    "the name of this project , openfmo@xcite , stands for the following openness : ( 1 ) names and argument lists of apis constructing the fmo program are opened publicly , ( 2 ) the program structure is also opened to combining other theories of physics and chemistry , i.e. , multi - scale / multi - physics simulations , and ( 3 ) the skeleton program is developed under some open - source licenses and its development process will also be opened to the public . in fig .",
    "[ fig : stack ] , we show a stack structure of this program .",
    "although the main target is still a quantum chemical calculation of molecules , it can be combined with other theories to construct multi - physics / multi - scale simulations ( fig .",
    "[ fig : multiscale ] ) for complex phenomena@xcite .",
    "as already shown in section [ sec : fmo - algorithm ] , the fragment mo method consists of the standard _",
    "ab initio _ mo calculations including the generation of fock matrices with one / two - electron integral calculations . using this property , the usual fmo program",
    "is divided into two layers , the skeleton program which control the whole flow of the fmo algorithm , and the molecular orbital ( mo ) apis to provide the charge distribution of each fragment through _ ab initio _ mo calculations .",
    "since these spec of interfaces between the skeleton and the apis are fixed and opened publicly , either of them can easily be substituted by other programs .",
    "the multi - physics simulation is one of the predominant strategy to construct peta - performance applications for nano - scale materials .",
    "our new implementation of fmo can also be opened for such multi - physics simulations .",
    "since the fmo method is based on electro - static interaction between fragments , we can extend each fragment to the general object which can provide a static charge distribution .",
    "for examples , we often use molecular mechanics representation of atomic clusters which should be given by quantum mechanical description , or the environmental charge distribution surrounding a molecule which models a solvent can be included as a fragment .",
    "thus , the mo - apis for a certain fragment can be substituted to other programs based on the different approximation levels .",
    "in addition to the description in molecular sciences , this is extended to larger - scale simulations through the `` multi - physics / multi - scale simulator '' layer .",
    "this type of extension is widely used for the large - scale computation representing realistic models of molecules in cells or other living organisms .",
    "the source code of the skeleton program of openfmo is publicly opened according to some open - source licenses . at present",
    ", the openfmo project is managed by several core members including the authors of this paper .",
    "once we show the effectiveness of our approach to the open implementation , and the direction of the project is settled properly , we are willing to change the management of the project into so - called open - source - software developments .",
    "in this paper , we showed our results in nanoscience executed on the naregi grid system , and expressed our perspective toward the peta - scale computing . in section",
    "[ sec : prediction - peta ] , we showed that fmo is one of the peta - scale applications .",
    "however , it has been also realized that the actual implementations of the fmo method , at present , does not correspond to the execution in peta - scale environments , i.e. , they does not solve molecules with more than 10 thousand fragments even if peta - scale computers are available . in order to improve the situation",
    ", we started an open - source project for multi - physics simulations including new fmo codes from scratch . generally speaking ,",
    "it is very difficult for scientific applications to be executed in a peta - scale performance since a simple parallel scheme fails in case that the total number of cpus is the order of 1,000,000 .",
    "thus , it will be necessary that the application itself becomes multi - layered in order to use the resources efficiently corresponding to the hardware architecture of peta - scale computers .",
    "the fmo calculation which we have studied in this paper has a two - stage structure in its original algorithm : _ ab initio _ calculations are performed for each fragment and fragment pair while the interactions between these fragments are described by a classical electro - static potentials .",
    "this theoretical reconstruction of the original _ ab initio _ mo method into the layered form is considered as the key to the successful performance of the program .",
    "scientific calculations with layered structures have been carried out as a multi - physics / multi - scale simulation in various fields .",
    "this type of calculations is important not only as a technique of realistic simulations but also as an actual example for the peta - scale computing .",
    "however , we claim that the deep understanding of the physical / chemical theories must be necessary for a proper construction of effective simulations which describes complex aspects of nature .",
    "then , the theoretical and practical way of constructing such simulations should be established before the time when the peta - scale computers are available .",
    "we expect that our implementation of the simulator is one of the solutions for high - performance scientific simulations in the next - generation .",
    "this work is partly supported by the ministry of education , sports , culture , science and technology ( mext ) through the science - grid naregi program under the development and application of advanced high - performance supercomputer project .",
    "k. kitaura , e. ikeo , t. asada , t. nakano , m. uebayasi , `` fragment molecular orbital method : an approximate computational method for large molecules , '' _ chem .",
    "_ , 1999 , vol . * 313 * , pp .",
    "701706 .",
    "t. nakano , t. kaminuma , t. sato , k. fukuzawa , y. akiyama , m.  uebayasi , k.  kitaura , `` fragment molecular orbital method : use of approximate electrostatic potential , '' _ chem .",
    "_ , 2002 , vol .",
    "351 , pp . 475 .",
    "t. takami , j. maki , j. ooba , t. kobayashi , r. nogita , and m. aoyagi , `` interaction and localization of one - electron orbitals in an organic molecule : fictitious parameter analysis for multiphysics simulations , '' j. phys .",
    "soc . jpn . *",
    "76 * , 013001 ( 2007 ) [ 4 pages ] ; e - print nlin.cd/0611042 ."
  ],
  "abstract_text": [
    "<S> we present our perspective and goals on high - performance computing for nanoscience in accordance with the global trend toward `` peta - scale computing . '' after reviewing our results obtained through the grid - enabled version of the fragment molecular orbital method ( fmo ) on the grid testbed by the japanese grid project , national research grid initiative ( naregi ) , we show that fmo is one of the best candidates for peta - scale applications by predicting its effective performance in peta - scale computers . </S>",
    "<S> finally , we introduce our new project constructing a peta - scale application in an open - architecture implementation of fmo in order to realize both goals of high - performance in peta - scale computers and extendibility to multi - physics simulations . </S>"
  ]
}