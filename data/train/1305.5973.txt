{
  "article_text": [
    "the use of pseudopotentials for practical and efficient electronic - structure calculations has a long history in computational condensed - matter physics.@xcite in pseudopotential - based electronic structure calculations , the nuclear potential and core electrons of an atom are replaced by a much softer effective potential felt by the valence electrons , enabling the latter to be described with a relatively small number of basis functions .",
    "thus , the success and popularity of various first - principles density - functional theory@xcite ( dft ) codes using plane - wave basis sets ( e.g. vasp,@xcite quantum - espresso,@xcite abinit@xcite ) depend on the availability of high - quality pseudopotentials .",
    "while the publication and testing of entire pseudopotential libraries also has a long history,@xcite the dominant mode of pseudopotential design and testing has been that of case - by - case construction , with authors typically creating and testing potentials only for a specific application .",
    "this _ ad hoc _ method of pseudopotential design and testing is incompatible with the increasing use of first - principles dft calculations in materials design applications , especially those that make use of high - throughput calculations to explore the properties of ( possibly hypothetical ) materials constructed from atoms across the periodic table.@xcite moreover , the pseudopotentials themselves ( or the input data needed to construct them ) are often not posted or published , and it is even more rare for comprehensive pseudopotential testing data to be made publicly available .",
    "unfortunately , this state of affairs creates practical difficulties in the duplication of previous studies and limits our understanding of the accuracy and transferability of modern pseudopotentials in realistic calculations .",
    "in addition , the lack of an open - source pseudopotential library appropriate for high - quality high - throughput calculations likely limits the adoption of this technique .    in this work",
    "we introduce a new `` gbrv '' open - source pseudopotential library , explaining the design criteria used to construct it and providing a suite of test results to verify its accuracy .",
    "the gbrv library , available at http://physics.rutgers.edu/gbrv , consists of highly accurate ultrasoft@xcite pseudopotentials generated using the vanderbilt pseudopotential generation code.@xcite we provide input files for the pseudopotential generator as well as ultrasoft pseudopotential files which can be used directly with quantum espresso and projector - augmented wave ( paw)@xcite files generated with the uspp2abinit@xcite add - on which can be used directly with abinit .",
    "our library has been designed and optimized for use in high - throughput dft calculations , though it should be appropriate for many applications .",
    "in addition , we test two other paw libraries , the mature but proprietary vasp paw library version 5.2@xcite and the still - under - development pslib 0.3.0 public paw library@xcite generated using the atomic code of the quantum espresso package . versions of the vasp library have been used in the majority of previous pseudopotential - based high - throughput studies , usually with little discussion of its accuracy.@xcite    testing three potential sets allows us to assess the accuracy of our library relative to other choices and also provides some perspective on the limits of current pseudopotential methodology .",
    "we have tested the potentials by comparing with all - electron ( ae ) results from wien2k,@xcite which uses the highly accurate full - potential linearized augmented plane - wave + local orbitals method ( flapw+lo ) .",
    "the manuscript is organized as follows .",
    "our pseudopotential design criteria are presented and discussed in sec .",
    "the tests of the gbrv , vasp and pslib potentials in comparison with ae calculations are presented in sec .",
    "our conclusions are summarized in sec .  iv .",
    "high - throughput dft studies of materials systems present a variety of challenges for pseudopotential design which have informed our choices in creating the gbrv pseudopotential library .",
    "first , by their very nature , high - throughput calculations include a wide variety of atoms and thus require accurate potentials extending throughout the periodic table .",
    "therefore , our library includes all of the elements from h to bi except for the noble gases and the @xmath0-block elements .",
    "second , high - throughput calculations require significant computational resources , which should be minimized if possible . therefore , we designed our potential library so that all of the elements can be run at a relatively low plane - wave cutoff of 40 ry and a charge - density cutoff of 200 ry . using a single low cutoff",
    "greatly simplifies the use of our potentials in high - throughput calculations .",
    "this contrasts with the normal procedure of allowing a variety of plane - wave cutoffs in a single pseudopotential library . in that case ,",
    "one either has to use the highest cutoff in all calculations or else face difficulty in comparing energies of structures containing different combinations of atoms , a procedure that is central to the kind of thermodynamic stability analysis that is often required in high - throughput calculations .",
    "third , high - throughput calculations often place atoms in unusual or novel chemical environments .",
    "therefore , we required that our potentials be highly transferable and able to reproduce metallic , ionic , and covalent bonding behavior . for the purposes of reliable high - throughput calculations , it is crucial that the potential library produces consistently accurate results for all atoms in all reasonable crystal structures .",
    "this requirement led us to include extra semi - core states in normally borderline cases , as a high - throughput study can not verify whether the semicore states are necessary in every structure examined .    finally , on a more technical level",
    ", high - throughput calculations of bulk materials typically require the use of variable unit - cell relaxation algorithms to minimize the stress and optimize lattice parameters .",
    "these calculations present numerical difficulties as they are normally run at a fixed number of plane - waves determined by the initial configuration , rather than at a fixed plane - wave cutoff , and they require accurate determination of stresses , which can be expensive to converge . therefore , we designed our potentials such that when used with a smeared plane - wave cutoff they both produce accurate stresses and converge to an accurate ground state structure when using a variable cell relaxation algorithm ( given a reasonable starting structure ) .",
    "unfortunately , designing a set of pseudopotentials which meets all of the above requirements is very difficult , as the requirements are naturally in conflict with each other .",
    "highly transferable potentials generally require high plane - wave cutoffs and many semi - core states , which is in direct conflict with the requirement of a low plane - wave cutoff .",
    "in addition , a comprehensive set of potentials is both more difficult to design with a single low plane - wave cutoff and allows for many chemical environments , making reliability difficult . given these conflicts , one is naturally led to adopt either ultrasoft or paw potentials , which can provide both higher transferability and lower plane - wave cutoffs than norm - conserving potentials . in the present work , we have chosen to design a library of ultrasoft pseudopotentials .",
    "we describe our procedure for optimizing potentials below ; however , there remain atoms which are particularly difficult to pseudize given the above constraints , which we discuss further when we present our testing data in section [ sec : results ] .",
    "the process of construction of the potentials consisted of optimizing the following parameters : ( a ) a reference atomic configuration ( neutral or slightly ionic ) , ( b ) the number of core and valence states , ( c ) the cutoff radii for each angular momentum channel , ( d ) a local potential and local cutoff radii , ( e ) the inner pseudization and non - linear core correction radii , and ( f ) the energies of any extra projectors.@xcite we began our design by constructing initial potentials from previously - tested potentials if available , using periodic trends to fill in missing elements , and testing each atom first in _ fcc _ and _ bcc _ structures and then using the nacl testing set ( see section [ sec : details ] ) .",
    "we found that expanding our testing to the perovskites and half - heuslers required relatively little additional tuning . while the traditional transferability tests provided by pseudopotential generators , such as comparing the logarithmic derivatives to all - electron results and testing the pseudopotential in multiple atomic configurations , were helpful in narrowing the choices of parameters for our potentials , we found that these tests are rarely sufficient to design a potential which meets the competing goals of our design criteria .",
    "the various parameters of our potentials were adjusted by hand with extensive use of solid - state testing to identify which atoms need improvement and which aspects of those potentials must be modified . when a potential performed poorly in tests , we first adjusted the outer cutoff radii by deciding if the potential was either too hard or too soft",
    ". a potential which is too hard will improve its performance when tested with higher plane - wave and charge - density cutoffs , and requires increasing the cutoff radii of the local potential or non - local projectors , while an excessively soft potential must be adjusted in the opposite direction .",
    "cutoff radii tend to follow periodic trends , with radii decreasing as one moves right across a row and increasing as one moves down a column , although differences in numbers of semicore states complicates this relation .",
    "if an element had poor testing results which were found to be insensitive to the projector cutoff radii , there were several other options which we considered .",
    "first , we added any additional relevant semicore states or a non - linear core correction if there was significant valence / core overlap .",
    "second , we looked in detail at the logarithmic derivatives and adjusted the local potential and the energies of any extra projectors in order to improve agreement in the chemically relevant region .",
    "almost all of our occupied angular momentum channels have at least two projectors , and a few with semi - core states have three .",
    "we found that potentials heavier than fluorine generally require a good description of the @xmath1 channel and the bottom 1 - 2 rows of the periodic table require a reasonable description of the @xmath0 channel , especially for atoms near la - hf .",
    "third , it was sometimes necessary to adjust the inner pseudoization radius ; magnetic moments are often particularly sensitive to this parameter . for most elements",
    ", we were able to achieve potentials which met all of our requirements after a few revisions , and small changes in the parameters would not affect the testing results noticeably .",
    "for a few problematic elements ( li , be , f , na , ni , hf ) we were forced to systematically vary and test certain parameters that were found to be particularly important in balancing the trade - off between accuracy and hardness . in some cases we also had to adjust the local potential or reference configuration in order to find a region of parameter space which met our requirements as closely as possible . having a large solid state testing set was important to prevent over - fitting of these difficult cases to any particular property .",
    "we discuss some of these atoms further in section [ sec : results ] .",
    "in order to gauge the transferability of a general - purpose pseudopotential library , it is necessary to test the potentials in chemical environments that include ionic , covalent , and metallic bonding . for this purpose ,",
    "we have chosen a testing regimen in which the pseudopotential calculations are compared not with experiment , but with all - electron calculations performed under conditions that are as identical as possible .",
    "this allows us to quantify the accuracy of the pseudopotentials themselves , isolated from any complications having to do with actual experimental conditions ( finite temperature , zero - point motion , etc . ) or with theoretical approximations that are common to both the pseudopotential and all - electron calculations .",
    "thus , our pseudopotential and all - electron calculations are always carried out with exactly the same choice of dft exchange - correlation functional , the same k - point sets , and the same smearing temperature .",
    "the pbe exchange - correlation functional@xcite was used throughout .",
    "both the ae calculations and the pseudopotential constructions were scalar - relativistic,@xcite i.e. , without spin - orbit interactions .",
    "we ran all of our testing calculations as non - spin - polarized calculations , except for our calculation of the magnetic moments of the transition metal oxides , which we ran at the all - electron non - spin - polarized lattice constants .    in the same spirit",
    ", we can reduce the computational load associated with the test suite by making some common approximations that still allow systematic comparison .",
    "for example , we ran all of our calculations on an 8@xmath28@xmath28 @xmath3-point density and with 0.002 ry fermi - dirac smearing .",
    "we note that this @xmath3-point and temperature setting is not sufficient to fully converge many of the properties we calculate and , as stated above , the results should not be compared with experiment .",
    "however , by using the same setting for all calculations , we can nevertheless compare the results to each other on an equal footing .",
    "calculations with the gbrv pseudopotential set were run using quantum espresso at our target plane - wave cutoff of 40 ry and a charge density cutoff of 200 ry .",
    "the pslib set provides a variety of suggested plane - wave cutoffs which range up to 78 ry , but most are below 50 ry and we ran all calculations with a cutoff of 50 ry and a charge density cutoff of 450 ry , also using quantum espresso .",
    "this lower - than - recommended cutoff may bias results against pslib , but we think a relatively low cutoff is appropriate given our goal of testing potentials for high - throughput applications .",
    "vasp provides a variety of potentials for each atom ; we chose the potentials with the largest number of semi - core states ( we did not test the new ` gw ' potentials ) .",
    "these potentials have cutoffs of up to 47 ry , although most are below 40 ry . for cases such as o and f which include soft , normal , and hard versions , we chose the normal version .",
    "we ran all vasp calculations using the ` high ' precision setting , which increases the plane - wave cutoff 25% above the suggested values , which is necessary to converge the stress for variable cell calculations .",
    "wien2k calculations were performed at @xmath4 values of 8 - 10 as necessary to converge the lattice constant .",
    "calculations of lattice constants and bulk moduli proceeded by first performing a variable - cell relaxation with the gbrv pseudopotential set to generate an initial guess for the lattice constant , and then performing energy calculations with each of our testing sets at nine points from @xmath51% to 1% of the initial guess and fitting the results to a parabola .",
    "our four testing sets all consist of cubic materials without free internal parameters in order to reduce the computational demands associated with structural relaxation .",
    "our first testing set consists of each of the elements in simple _ fcc _ and _ bcc _ structures .",
    "this set was designed to test the potentials in a metallic bonding environment as well as to allow us to analyze each potential separately , although we note that for many elements these structures are highly unrealistic and represent very demanding test cases .",
    "the second testing set consists of rocksalt structures designed to test ionic bonding .",
    "main group elements are paired to put both elements in preferred oxidation states ; most of these structures are insulating .",
    "all of the transition metal elements , which often have multiple oxidation states , are paired with oxygen ; many of these are metallic .",
    "the third testing set consists of members of the heavily - investigated perovskite family .",
    "this set also largely tests ionic bonding , but includes tests of elements in higher oxidation states than the rocksalt structures .",
    "finally , we test a large set of half - heusler structures ( mgagas structure type , space group @xmath6).@xcite half - heuslers display a complicated combination of ionic , covalent , and metallic bonding , and should give an indication of the accuracy of our potentials in a variety of realistic environments .",
    "both half - heuslers and perovskites were chosen for their simple structure and their common inclusion of elements from throughout the periodic table .",
    "we include almost ninety previously synthesized half - heuslers plus additional hypothetical examples , bringing our half - heusler test set to 138 compounds , which include all of the elements in our pseudopotential set except h and the halogens .",
    ".[tab : summary ] summary of pseudopotential testing results .",
    "all testing data is presented as either rms errors relative to ae calculations or percent of lattice constants outside @xmath7 .",
    "only compounds where all three pseudopotential sets converge are included in rms errors .",
    "[ cols=\"<,<,<,<\",options=\"header \" , ]     finally , note that we have been treating the ae results from wien2k as essentially exact , but this point deserves futher investigation , as prelimiinary tests@xcite indicate that the differences between different ae codes can sometimes be significant on the scale of our comparisons .",
    "in order to achieve broader compatibility with open - source electronic structure codes , specifically abinit , which can perform calculations with paws but not with ultrasoft pseudopotentials , we use the uspp2abinit@xcite add - on to the vanderbilt ultrasoft code to generate paw versions of the gbrv library . while closely related , the formalism of paw and ultrasoft potentials are not the same@xcite , which results in differences between the two gbrv potential sets which are larger than the differences between quantum espresso and abinit when run with identical norm - conserving potentials . for some elements which are particularly sensitive to generation parameters , especially those with many semicore states or core states which are close in energy to valence states , we had to alter the generation parameters in order to make a paw of equal accuracy to the ultrasoft version@xcite .",
    "we find that the gbrv paw and ultrasoft libraries , tested with abinit and quantum espresso respectively , have the same overall accuracy relative to all - electron calculations , and their errors in lattice constant are highly correlated ( e.g. the correlation coefficient between the perovskite lattice constant errors is 0.73 ) .",
    "in conclusion , we have presented design criteria and testing results for the new gbrv pseudopotential library optimized for high - throughput dft calculations . we find that our potentials are both accurate and transferable , performing well in tests of metallic , ionic , and covalent bonding .",
    "in addition , we have compiled testing results for two paw libraries , which also perform well and demonstrate the reliability of carefully designed pseudopotentials in electronic - structure calculations . while calculations using either ultrasoft pseudopotentials or paws are more complicated to implement than those using norm - conserving potentials , almost all modern electronic - structure codes are now capable of using such potentials , with current code development efforts continually expanding the set of features that are compatible with them . in particular , the gbrv potentials , available at http://physics.rutgers.edu/gbrv ,",
    "can be used directly with the actively - developed open - source quantum espresso and abinit packages .    for the properties investigated in this work ,",
    "the gbrv potential set provides better accuracy and robustness than the vasp or pslib paw sets , and at lower computational cost .",
    "in particular , the gbrv potentials are designed to run at a plane - wave cutoff of 40 ry and a charge - density cutoff of 200 ry , which are at least 25% lower than many of the pslib paws as well as lower than three vasp paws when using the ` high ' precision setting recommended for variable cell relaxations .    the gbrv potentials ( like the pslib potentials )",
    "also have the advantage of being open - source , which allows calculations to be easily replicated and enables the potentials to be modified and improved as needed by the electronic structure community .",
    "furthermore , open - source potentials can be used with open - source electronic structure packages , which have active development communities and , like the potentials themselves , can be improved and expanded upon as necessary .",
    "we hope that both the gbrv potential library itself , as well as the design criteria and testing methodology presented here , will improve the use and reliability of pseudopotential - based high - throughput dft calculations for a variety of materials design applications ."
  ],
  "abstract_text": [
    "<S> the increasing use of high - throughput density - functional theory ( dft ) calculations in the computational design and optimization of materials requires the availability of a comprehensive set of soft and transferable pseudopotentials . </S>",
    "<S> here we present design criteria and testing results for a new open - source `` gbrv '' ultrasoft pseudopotential library that has been optimized for use in high - throughput dft calculations . </S>",
    "<S> we benchmark the gbrv potentials , as well as two other pseudopotential sets available in the literature , to all - electron calculations in order to validate their accuracy . </S>",
    "<S> the results allow us to draw conclusions about the accuracy of modern pseudopotentials in a variety of chemical environments . </S>"
  ]
}