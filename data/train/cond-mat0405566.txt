{
  "article_text": [
    "the last few years have seen the publication of a large volume of work in the physics literature on networks of various kinds , particularly computer and information networks like the internet and world wide web , biological networks such as food webs and metabolic networks , and social networks  @xcite .",
    "this work has been divided between empirical studies of the structure of particular networks and theoretical studies focused largely on the creation of mathematical and computational models .",
    "the construction of network models is the topic of this paper .",
    "models of networks can help us to understand the important features of network structure and the interplay of structure with processes that take place on networks , such as the flow of traffic on the internet or the spread of a disease over a social network .",
    "most network models studied in the physics community are of a practical sort . typically one wishes to create a network that displays some feature or features observed in empirical studies .",
    "the principal approach is to list possible mechanisms that might be responsible for creating those features and then make a model incorporating some or all of those mechanisms .",
    "one then either examines the networks produced by the model for rewarding similarity to the real - world systems they are supposed to mimic , or uses them as a substrate for further modeling , for example of traffic flow or disease spread .",
    "classic examples of models of this kind are the small - world model  @xcite and the many different preferential attachment models  @xcite , which model network transitivity and power - law degree distributions respectively .",
    "however , there is another possible approach to the modeling of networks , which has been pursued comparatively little so far .",
    "an instructive analogy can be made here with theories of gases .",
    "there are ( at least ) two different general theories of the properties of gases .",
    "kinetic theory explicitly models collections of individual atoms , their motions and collisions , and attempts to calculate overall properties of the resulting system from basic mechanical principles .",
    "pressure , for instance , is calculated from the mean momentum transfered to the walls of a container by bombarding atoms .",
    "kinetic theory is well motivated , easy to understand , and makes good sense to physicists and laymen alike .",
    "however , kinetic theory rapidly becomes complex and difficult to use if we attempt to make it realistic by the inclusion of accurate intermolecular potentials and similar features . in practice , kinetic theory models either make only rather rough and uncontrolled predictions , or they rely on large - scale computer simulation to achieve accuracy .",
    "if one wants a good calculational tool for studying the properties of gases , therefore , one does not use kinetic theory .",
    "instead , one uses statistical mechanics .",
    "although certainly less intuitive , statistical mechanics is based on rigorous probabilistic arguments and gives accurate and reliable answers for an enormous range of problems , including many , such as problems concerning solids , for which kinetic theory is inapplicable .",
    "equilibrium statistical mechanics provides a general framework for reasoning and a powerful calculational tool for very many problems in statistical physics .",
    "here we argue that the current commonly used models of networks are akin to kinetic theory .",
    "they posit plausible mechanisms or dynamics , and produce results in qualitative agreement with reality , at least in some respects .",
    "they are easy to understand and give us good physical insight . however , like kinetic theory",
    ", they do not make quantitatively accurate predictions and provide no overall framework for modeling , each network model instead concentrating on explaining one or a few features of the system of interest .    in this paper",
    "we discuss exponential random graphs , which are to networks as statistical mechanics is to the study of gases  a well - founded general theory with true predictive power .",
    "these advantages come at a price : exponential random graphs are both mathematically and conceptually sophisticated , and their understanding demands some effort of the reader .",
    "we believe this effort to be more than worthwhile , however .",
    "theoretical techniques based on solid statistical foundations and capable of quantitative predictions have been of extraordinary value in the study of fluid , solid state , and other physical systems , and there is no reason to think they will be any less valuable for networks .",
    "we are by no means the first authors to study exponential random graphs , although our approach is different from that taken by others .",
    "exponential random graphs were first proposed in the early 1980s by holland and leinhardt  @xcite , building on statistical foundations laid by besag  @xcite .",
    "substantial further developments were made by frank and strauss  @xcite , and continued to be made by others throughout the 1990s  @xcite . in recent years a number of physicists , including ourselves , have made theoretical studies of specific cases  @xcite .",
    "today , exponential random graphs are in common use within the statistics and social network analysis communities as a practical tool for modeling networks and several standard computer tools are available for simulating and manipulating them , including prepstar , ergm , and siena  @xcite .",
    "in this paper we aim to do a number of things .",
    "first , we place exponential random graph models on a firm physical foundation , showing that they can be derived from first principles using maximum entropy arguments . in doing so",
    ", we argue that these models are not merely an _ ad hoc _ formulation studied primarily for their mathematical convenience , but a true and correct extension of the statistical mechanics of boltzmann and gibbs to the network world .",
    "second , we take an almost entirely analytic approach in our work , by contrast with the numerical simulations that form the core of most previous studies . we show that the analytic techniques of equilibrium statistical mechanics are ideally suited to the study of these models and can shed much light on their structure and behavior . throughout the paper",
    "we give numerous examples of specific models that are solvable either exactly or approximately , including several that have a long history in network analysis .",
    "nonetheless , the particular examples studied in this paper form only a tiny fraction of the possibilities offered by this class of models .",
    "there are many intriguing avenues for future research on exponential random graphs that are open for exploration , and we highlight a number of these throughout the paper .",
    "the typical scenario addressed in the creation of a network model is this : one has measurements of a number of network properties for a real - world network or networks , such as number of vertices or edges , vertex degrees , clustering coefficients , correlation functions , and so forth , and one wishes to make a model network that has the same or similar values of these properties .",
    "for instance , one might find that a network has a degree sequence with a power - law distribution and wish to create a model network that shows the same power law . or",
    "one might measure a high clustering coefficient in a network and wish to build a model network with similarly high clustering .    essentially all models considered in modern work , and indeed as far back as the 1950s and 1960s , have been ensemble models , meaning that a model is defined to be not a single network , but a probability distribution over many possible networks .",
    "we adopt this approach here as well",
    ". our goal will be to choose a probability distribution such that networks that are a better fit to observed characteristics are accorded higher probability in the model .",
    "consider a set @xmath0 of graphs .",
    "one can use any set  @xmath0 , but in most of the work described in this paper @xmath0 will be the set of all simple graphs without self - loops on @xmath1 vertices .",
    "( a simple graph is a graph having at most a single edge between any pair of vertices .",
    "a self - loop is an edge that connects a vertex to itself . )",
    "certainly there are many other possible choices and we consider some of the others briefly in sections  [ fermibose ] and  [ fixed ] .",
    "the graphs can also be either directed or undirected and we consider both in this paper , although most of our time will be spent on the undirected case .",
    "suppose we have a collection of graph observables @xmath2 , @xmath3 , that we have measured in empirical observation of some real - world network or networks of interest to us .",
    "we will , for the sake of generality , assume that we have an estimate @xmath4 of the expectation value of each observable . in practice",
    "it is often the case that we have only one measurement of an observable .",
    "for instance , we have only one internet , and hence only one measurement of the clustering coefficient of the internet . in that case , however , our best estimate of the expectation value of the clustering coefficient is simply equal to the one measurement that we have .",
    "let @xmath5 be a graph in our set of graphs and let @xmath6 be the probability of that graph within our ensemble .",
    "we would like to choose @xmath6 so that the expectation value of each of our graph observables @xmath2 within that distribution is equal to its observed value , but this is a vastly underdetermined problem in most cases ; the number of degrees of freedom in the definition of the probability distribution is huge compared to the number of constraints imposed by our observations . problems of this type however are commonplace in statistical physics and we know well how to deal with them . the best choice of probability distribution",
    ", in a sense that we will make precise in a moment , is the one that maximizes the gibbs entropy @xmath7 subject to the constraints @xmath8 plus the normalization condition @xmath9 here @xmath10 is the value of @xmath11 in graph  @xmath12 .    introducing lagrange multipliers",
    "@xmath13 , we then find that the maximum entropy is achieved for the distribution satisfying @xmath14 = 0\\end{aligned}\\ ] ] for all graphs  @xmath12 .",
    "this gives @xmath15 or equivalently @xmath16 where @xmath17 is the graph hamiltonian @xmath18 and @xmath19 is the partition function @xmath20 equations  ( [ defspg ] ) to  ( [ defsz ] ) define the exponential random graph model .",
    "the exponential random graph is the distribution over a specified set of graphs that maximizes the entropy subject to the known constraints .",
    "it is also the exact analogue for graphs of the boltzmann distribution of a physical system over its microstates at finite temperature .    using the exponential random graph model involves performing averages over the probability distribution  ( [ defspg ] ) .",
    "the expected value of any graph property  @xmath21 within the model is simply @xmath22 the exponential random graph , like all such maximum entropy ensembles , gives the best prediction of an unknown quantity @xmath21 , given a set of known quantities , eq .",
    "( [ constraints ] ) .",
    "in this precise sense , the exponential random graph is the best ensemble model we can construct for a network given a particular set of observations .    in many cases we may not need to perform the sum  ( [ avx ] ) ; often we need only perform the partition function sum , eq .",
    "( [ defsz ] ) , and the values of other sums can then be deduced by taking appropriate derivatives . just as in conventional equilibrium",
    "statistical mechanics , however , performing even the partition function sum analytically may not be easy . indeed in some cases it may not be possible at all , in which case one may have to turn to monte carlo simulation , to which the model lends itself admirably . as we show in this paper however , there are a variety of tools one can employ to get exact or approximate analytic solutions in cases of interest , including mean - field theory , algebraic transformations , and diagrammatic perturbation theory .",
    "before delving into the more complicated calculations , let us illustrate the use of exponential random graphs with some simple examples .",
    "consider first what is perhaps the simplest of exponential random graphs , at least for the case of fixed number of vertices  @xmath1 considered here .",
    "suppose we know only the expect number of edges @xmath23 that our network should have .",
    "in that case the hamiltonian takes the simple form @xmath24 we can think of the parameter @xmath25 as either a field coupling to the number of edges , or alternatively as an inverse temperature .",
    "let us evaluate the partition function for this hamiltonian for the case of an ensemble of simple undirected graphs on @xmath1 vertices without self - loops .",
    "we define the adjacency matrix @xmath26 to be the symmetric @xmath27 matrix with elements @xmath28 then the number of edges is @xmath29 , and the partition function is @xmath30^{n\\choose2}. \\label{bernoulli}\\end{aligned}\\ ] ]    it is convenient to define the free energy @xmath31 which in this case is @xmath32 ( note that the free energy is extensive not in the number of vertices  @xmath1 , but in the number @xmath33 of pairs of vertices , since this is the number of degrees of freedom in the model . ) then , for instance , the expected number of edges in the model is @xmath34 conventionally we re - express the parameter  @xmath25 in terms of @xmath35 so that @xmath36 .    the probability @xmath6 of a graph in this ensemble can be written @xmath37^{n\\choose2 } }       = p^m ( 1-p)^{{n\\choose2}-m}.\\ ] ] in other words , @xmath6 is simply the probability for a graph in which each of the @xmath33 possible edges appears with independent probability  @xmath38 .",
    "this model is known as the bernoulli random graph , or often just the random graph , and was introduced , in a completely different fashion , by solomonoff and rapoport  @xcite in 1951 and later famously studied by erds and rnyi  @xcite .",
    "today it is one of the best studied of graph models , although , as many authors have pointed out , it is not a good model of most real - world networks  @xcite .",
    "one way in which its inadequacy shows , and one that has been emphasized heavily in networks research in the last few years , is its degree distribution .",
    "since each edge in the model appears with independent probability  @xmath38 , the degree of a vertex , i.e. ,  the number of edges attached to that vertex , follows a binomial distribution , or a poisson distribution in the limit of large  @xmath1 .",
    "most real - world networks however have degree distributions that are far from poissonian , typically being highly right - skewed , with a small proportion of vertices having very high degree .",
    "some of the most interesting networks , including the internet and the world wide web , appear to have degree distributions that follow a power law  @xcite . in the next section",
    "we discuss what happens when we incorporate observations like these into our models .",
    "suppose then that rather than just measuring the total number of edges in a network , we measure the degrees of all the vertices .",
    "let us denote by @xmath39 the degree of vertex  @xmath40 .",
    "the complete set  @xmath41 is called the degree sequence of the network .",
    "note that we do not need to specify independently the number of edges  @xmath42 in the network , since @xmath43 for an undirected graph .",
    "the exponential random graph model appropriate to this set of observations is the model having hamiltonian @xmath44 where we now have one parameter @xmath45 for each vertex  @xmath40 . noting that @xmath46 , this can also be written @xmath47 then the partition function is @xmath48 and the free energy is @xmath49    more generally we could specify a hamiltonian @xmath50 with a separate parameter @xmath51 coupling to each edge  @xcite .",
    "then @xmath52 this allows us for example to calculate the probability of occurrence @xmath53 of an edge between vertices @xmath40 and  @xmath54 : @xmath55 the model of eq .",
    "( [ genrg ] ) is the special case in which @xmath56 and the normal ( bernoulli ) random graph of eq .",
    "( [ bernoulli ] ) corresponds to the case in which the parameters @xmath51 are all equal .",
    "sometimes it is convenient to specify not a degree sequence but a probability distribution over vertex degrees .",
    "this can be achieved by specifying an equivalent distribution over the parameters @xmath45 in  ( [ genrg ] ) .",
    "let us define @xmath57 to be the probability that the parameter @xmath25 for a vertex lies in the range @xmath25 to @xmath58 .",
    "then , averaging over the disorder so introduced , the free energy , eq .",
    "( [ fgenrg ] ) , becomes @xmath59 the part of this free energy due to a single vertex with field parameter  @xmath25 is @xmath60 and the expected degree of vertex  @xmath40 with field  @xmath45 is the derivative of this with respect to  @xmath25 , evaluated at  @xmath45 : @xmath61_{\\theta=\\theta_i } \\nonumber\\\\           & = & ( n-1 ) \\int { \\rho(\\theta')\\,{\\mathrm{d}}\\theta'\\over                           { \\mathrm{e}}^{\\theta_i+\\theta'}+1}. \\label{distkav}\\end{aligned}\\ ] ] by a judicious choice of @xmath62 we can then produce the desired degree distribution .",
    "( see also sec .",
    "[ classical ] . )",
    "we studied this model in a previous paper  @xcite , as a model for degree correlations in the internet and other networks .",
    "we could alternatively specify a probability distribution @xmath63 for the parameters @xmath51 in  ( [ gengenrg ] ) that couple to individual edges . or",
    ", taking the developments a step further , one could define joint distributions for the @xmath51 on different edges , thereby introducing correlations of quite general kinds between the edges in the model .",
    "there are enormous possibilities to be explored in this regard , but we pass over them for now , our interests in the present paper lying in other directions",
    ".    one can calculate many other properties of our models .",
    "for example , for the model of eq .",
    "( [ genrg ] ) , one can calculate the expectation value of any product of vertex degrees from an appropriate derivative of the partition function : @xmath64 z. \\label{disconnected}\\ ] ] such derivatives are correlation functions of degrees within the model .",
    "similarly , derivatives of the free energy give the connected correlation functions :    @xmath65    [ concorrelation ]    and so forth .",
    "for instance , the two - vertex connected correlation is @xmath66 for the case of the bernoulli random graph , which has all @xmath45 equal , this gives @xmath67 for @xmath68 , where we have made use of eq .",
    "( [ defsp ] ) .",
    "thus the degrees of vertices in the random graph are in general positively correlated",
    ". one can understand this as an effect of the one edge that potentially connects the two vertices @xmath40 and  @xmath54 .",
    "the presence or absence of this edge introduces a correlation between the two degrees .",
    "( for a sparse graph , in which @xmath69 , the correlation disappears in the limit of large graph size . )    in order to measure some quantities within exponential random graph models , it may be necessary to introduce additional terms into the hamiltonian .",
    "for instance , to find the expectation value of the clustering coefficient  @xmath70  @xcite , one would like to evaluate @xmath71 which we can do by introducing an extra term linear in the clustering coefficient in the hamiltonian . to measure clustering in the network of eq .",
    "( [ genrg ] ) , for example , we could define @xmath72 then @xmath73 thus it is important , even in the simplest of cases , to be able to solve more general models , and much of the rest of the paper is devoted to the development of techniques to do this .      before we look at more complicated hamiltonians ,",
    "let us look briefly at what happens if we change the graph set  @xmath0 over which our sums are performed .",
    "the first case we examine is that of directed graphs .",
    "we define @xmath0 to be the set of all simple loopless directed graphs , which is parameterized by the asymmetric adjacency matrix @xmath74 thus , for instance , the hamiltonian @xmath75 gives rise to a partition function @xmath76^{2{n\\choose2 } } \\label{directedz}\\ ] ] and a corresponding free energy .",
    "the directed equivalent of the more general model of eq .",
    "( [ genrg ] ) in which we can control the degree of each vertex is a model that now has two separate parameters for each vertex , @xmath77 and @xmath78 , that couple to the in- and out - degrees : @xmath79 then the partition function and free energy are @xmath80    from these we can calculate the expected in- and out - degree of a vertex : @xmath81 we note that @xmath82 , as must be the case for all directed graphs , since every edge on such a graph must both start and end at exactly one vertex .",
    "we can also define a probability distribution @xmath83 for the fields on the vertices , and the developments generalize eqs .",
    "( [ distf][distkav ] ) in a natural fashion .",
    "we give a more complex example of a directed graph model in section  [ reciprocity ] , where we derive a solution to the reciprocity model of holland and leinhardt  @xcite using perturbative methods .",
    "it will by now have occurred to many readers that results like eqs .",
    "( [ fgenrg ] ) and  ( [ distkav ] ) bear a similarity to corresponding results from traditional statistical mechanics for systems of non - interacting fermions .",
    "we can look upon the edges in our networks as being like particles in a quantum gas and pairs of vertices as being like single - particle states .",
    "simple graphs then correspond to the case in which each single - particle state can be occupied by at most one particle , so it should come as no surprise that the results look similar to a system obeying the pauli exclusion principle .",
    "not all networks need have only a single edge between any pair of vertices .",
    "some can have multiple edges or multiedges .",
    "the world wide web is an example  there can be and frequently is more than one link from one page to another .",
    "the internet , airline networks , metabolic networks , neural networks , citation networks , and collaboration networks are other examples of networks that can exhibit multiedges .",
    "there is no problem generalizing our exponential random graphs to this case and , as we might expect , it gives rise to a formalism that resembles the theory of bosons .",
    "let us define our set of graphs  @xmath0 to be the set of all undirected graphs with any number of edges between any pair of vertices ( but still no self - edges , although there is no reason in principle why these can not be included as well ) .",
    "taking for example the hamiltonian , eq .",
    "( [ gengenrg ] ) , and generalizing the adjacency matrix , eq .",
    "( [ adjacency ] ) , so that @xmath84 is now equal to the _ number _ of edges between @xmath40 and @xmath54 , we have @xmath85 and @xmath86 the equivalent of the probability @xmath53 of an edge appearing in the fermionic case is now the expected number of edges @xmath87 between vertices @xmath40 and  @xmath54 , which is given by @xmath88 note that this quantity diverges if we allow @xmath89 , a phenomenon related to bose - einstein condensation in ordinary bose gases .    for the special cases of eqs .",
    "( [ genrg ] ) and  ( [ randomgraph ] ) , we have @xmath90 and @xmath91 respectively .",
    "the connected correlation between the degrees of any two vertices in the latter case is @xmath92 for @xmath68 .",
    "thus the degrees are again positively correlated and the correlation diverges as @xmath93 .      in most real - world networks the number of edges",
    "@xmath42 is quite small .",
    "typically @xmath42 is of the same order as  @xmath1 , rather than being of order  @xmath94 .",
    "such graphs are said to be sparse .",
    "( one possible exception is food webs , which appear to be dense , having @xmath95  @xcite . )",
    "the probability  @xmath53 of an edge appearing between any particular vertex pair @xmath96 is of order  @xmath97 in such networks .",
    "thus , for example , in the fermionic case of the network described by the hamiltonian  ( [ gengenrg ] ) , eq .",
    "( [ edgeprob1 ] ) tells us that @xmath98 must be of order @xmath1 in a sparse graph .",
    "the same is also true for the bosonic network of the previous section .",
    "this allows us to approximate many of our expressions by ignoring terms of order 1 by comparison with terms of order  @xmath98 .",
    "we refer to such approximations as the `` sparse limit '' or the `` classical limit , '' the latter by analogy with the corresponding phenomenon in quantum gases at low density .    in particular , the equivalent of eq .",
    "( [ edgeprob1 ] ) for either fermionic or bosonic graphs in the classical limit is @xmath99 . for the case of eq .",
    "( [ genrg ] ) , it is @xmath100 so that each edge appears with a probability that is a simple product of `` fugacities ''  @xmath101 defined on each vertex . the classical limit of this model has been studied previously by a number of other authors  @xcite , although again developed and justified in a different way from our presentation here ; generally the edge probability  ( [ edgeprob3 ] ) has been taken as an assumption , rather than a derived result .",
    "for a given distribution  @xmath62 of  @xmath25 , the expected degree of a vertex , eq .",
    "( [ distkav ] ) , is @xmath102 which is simply proportional to  @xmath101 .",
    "so we can produce any desired degree distribution by choosing the corresponding distribution for  @xmath25 .",
    "another possible choice of graph set  @xmath0 is the set of graphs with both a fixed number of vertices  @xmath1 and a fixed number of edges  @xmath42 .",
    "models of this kind have been examined occasionally in the literature  @xcite and , if we once more adopt the view of the edges in a graph as particles , they can be considered to be the canonical ensemble of network models , where the variable edge - count models of previous sections are the grand canonical ensemble . as in conventional statistical mechanics ,",
    "the grand ensemble is often simpler to work with than the canonical one , but progress can be made sometimes be made in the canonical case by performing the sum over all graphs regardless of edge count and introducing a kronecker @xmath103-symbol into the partition function to impose the edge constraint : @xmath104 where @xmath105 is the desired number of edges .",
    "for instance , the fixed edge - count version of the generalized random graph , eq .",
    "( [ gengenrg ] ) , would be one in which @xmath106 where we have made use of the integral representation for the @xmath103-function @xmath107 the sum over graphs is now in the form of the partition function for the grand canonical version of the model , but with @xmath108 , giving the field parameters an imaginary part .",
    "thus , from eq .",
    "( [ gengenrgpart ] ) @xmath109 in general the integral can not be done in closed form , which is why fixed edge - count graphs  and canonical ensembles in general  are avoided .",
    "the integral can in principle be carried out term by term for any finite  @xmath1 , but doing so is tantamount to performing the sum over all graphs with @xmath105 edges explicitly , so there is little to be gained by the exercise .",
    "it is also possible to have a bosonic graph with a fixed number of edges  one would simply sum over the set of graphs that have @xmath105 edges with any number of them being permitted to fall between any given pair of vertices .",
    "we will not discuss further either fixed edge - counts or bosonic networks in this paper , concentrating instead on the grand canonical fermionic ones , which are more useful overall .",
    "however , essentially all of the results reported in the remainder of the paper can be generalized , with a little work , to these other cases if necessary .",
    "outside of the models described in the previous sections , and some minor variations on them , we know of few other exponential random graph models that are exactly solvable .",
    "( one exception is the reciprocity model of holland and leinhardt  @xcite , for which we derive an exact solution in sec .",
    "[ reciprocity ] . ) to make further progress one must turn to approximate methods .",
    "there are ( at least ) three types of techniques that can yield approximate analytic solutions for exponential random graph models .",
    "the first and simplest is mean - field theory , which works well in many cases because of the intrinsically high dimensionality of network models ; usually these models have an effective dimensionality that increases with the number of vertices  @xmath1 , so that the thermodynamic limit of @xmath110 also corresponds to the high dimension limit in which mean - field theory becomes accurate .",
    "nonetheless , there are many quantities , such as those depending on fluctuations , about which mean - field theory says nothing , and for these other methods are needed . in some cases one can use non - perturbative approaches based on the hubbard ",
    "stratonovich transform or similar integral transforms , which are very effective and accurate but suitable only for models with hamiltonians of specific forms polynomial in the adjacency matrix .",
    "more generally , one can use perturbation theory , which may involve larger approximations ( although they are usually well controlled ) , but is applicable to hamiltonians of essentially any form .",
    "we discuss all of these approaches here . as an example of their application",
    ", we use one of the oldest and best - studied of exponential random graphs , the 2-star model .",
    "the hamiltonian for the 2-star model is @xmath111 where @xmath42 is the number of edges in the network and @xmath112 is the number of `` 2-stars . ''",
    "a 2-star is two edges connected to a common vertex .",
    "( the minus sign in front of the parameter @xmath113 is introduced for later convenience . )",
    "the quantities @xmath42 and @xmath112 can be rewritten in terms of the degree sequence thus : @xmath114 substituting these expressions into eq .",
    "( [ 2star1 ] ) , we can rewrite the hamiltonian as @xmath115 where @xmath116 and @xmath117 . ( the factor @xmath118 in the definition of @xmath119 is also introduced for convenience later on . )",
    "noticing once again that @xmath120 , where the variables @xmath84 are the elements of the adjacency matrix , we can also write @xmath121 we study the 2-star model in the fermionic case in which each vertex pair can be connected by at most a single edge , and within the grand canonical ensemble where the total number of edges is not fixed .",
    "generalization to the other cases described above is of course possible , if not always easy .",
    "the variables @xmath84 can be thought of as ising spins residing on the edges of a fully connected graph , and hence the 2-star model can be thought of as an ising model on the edge - dual graph of the fully connected graph  @xcite .",
    "( the edge - dual @xmath122 of a graph  @xmath12 is the graph in which each edge in @xmath12 is replaced by a vertex in @xmath122 and two vertices in @xmath122 are connected by an edge if the corresponding edges in @xmath12 share a vertex . )",
    "using this equivalence , the mean - field theory of the 2-star model can be developed in exactly the same way as for the more familiar lattice - based ising model .",
    "we begin by writing out all terms in eq .",
    "( [ 2star3 ] ) that involve a particular spin  @xmath84 : @xmath123,\\ ] ] where we have explicitly taken account of all the ways in which @xmath84 can enter the first term in the hamiltonian .",
    "( we have also dropped the term @xmath124 required to correctly count the terms diagonal in @xmath84 , since it vanishes in the large @xmath1 limit . )    then , in classic mean - field fashion , we approximate the local field by its average : @xmath125 where , as before , @xmath126 is the mean probability of an edge between any pair of vertices , which is also called the connectance of the graph .",
    "then @xmath127 , and we can write a self - consistency condition for @xmath38 of the form @xmath128 rearranging , this then gives us @xmath129",
    ". \\label{meanfield}\\ ] ]    for @xmath130 this equation has only one solution , but for @xmath131 there may either be one solution or , if @xmath132 is sufficiently close to  @xmath133 , there may be three , of which the outer two are stable .",
    "thus when @xmath132 is close to @xmath133 we have a bifurcation at @xmath134 , a continuous phase transition to a symmetry broken state with two phases , one of high density and one of low .",
    "we show in fig .",
    "[ mft ] a plot of the solution of  ( [ meanfield ] ) which displays clearly the characteristic hysteresis loop of the symmetry broken state .    along the `` symmetric line '' @xmath135",
    "there is always a solution @xmath136 to eq .",
    "( [ meanfield ] ) ( although it may be unstable ) , and along this line we can think of @xmath137 as a standard order parameter for the model which is zero in the high - symmetry phase and non - zero in the symmetry - broken phase . we can define a critical exponent @xmath138 in the usual fashion by @xmath139 as @xmath140 , giving @xmath141 , which is the usual ising mean - field value and should come as no surprise , given the equivalence mentioned above between the 2-star model and the ising model .",
    "one can define other critical exponents as well , which are also found to take ising mean - field values .",
    "for instance , as we showed in  @xcite , the variance  @xmath142 of the connectance , which plays the role of a susceptibility , goes as @xmath143 in the vicinity of the phase transition with @xmath144 .",
    "we can go beyond the mean - field approximation of the previous section by making use of techniques borrowed from many - body theory .",
    "the developments of this section follow closely the lines of our previous paper on this topic  @xcite , and rather than duplicate material needlessly , the reader is referred to that paper for details of the calculation . here",
    "we merely summarize the important results .",
    "the evaluation of the partition function for the 2-star model involves a sum of terms of the form @xmath145 .",
    "the study of interacting quantum systems has taught us that such sums can be performed using the hubbard ",
    "stratonovich transform .",
    "we start by noting the well - known result for the gaussian integral : @xmath146 making the substitutions @xmath147 and @xmath148 , and rearranging , this becomes @xmath149 then the partition function is @xmath150^{n/2 }      \\int{\\mathcal{d}}{\\bm{\\phi}}\\>\\exp\\bigl(-(n-1)j\\sum_i\\phi_i^2\\bigr)\\nonumber\\\\    & & \\hspace{3em } \\times \\sum_g \\exp\\bigl(\\sum_i ( 2j\\phi_i+b)k_i\\bigr ) , \\label{2starpart1}\\end{aligned}\\ ] ] where we have interchanged the order of sum and integral .",
    "the sum over graphs now has precisely the form of the partition function sum for the model of eq .",
    "( [ genrg ] ) , and from eq .",
    "( [ genrgpart ] ) we can thus immediately write down the partition function @xmath151 where the quantity @xmath152 is called the effective hamiltonian .    thus we have completed the partition function sum for the 2-star model , but at the expense of introducing the auxiliary fields @xmath153 which must be integrated out to complete the calculation .",
    "the integral can not , as far as we are aware , be evaluated exactly in closed form but , as we showed in  @xcite , it can be evaluated approximately using a saddle - point expansion , with the result that the free energy of the 2-star model is given to leading order in the expansion by @xmath154 where @xmath155 \\label{meanfield2}\\ ] ] is the position of the saddle point , i.e. ,  the maximum of the hamiltonian on the real-@xmath156 line .    note that eq .",
    "( [ meanfield2 ] ) is identical to the mean - field equation , eq .  ( [ meanfield ] ) , for the connectance  @xmath38 of the 2-star model .",
    "thus , @xmath157  is the connectance of the model within the mean - field approximation and the saddle - point expansion , as is typically the case in such calculations , is an expansion about the mean - field solution .    from the free energy we can derive a number of quantities of interest .",
    "we showed in  @xcite , for instance , that the variance of vertex degree in the model is given by @xmath158 which has a gradient discontinuity but no divergence at the phase transition .",
    "( this quantity is , by contrast , zero everywhere within mean - field theory . )",
    "exponential random graphs also lend themselves naturally to treatment using perturbation theory . here",
    "we describe the simplest such theory , which is roughly equivalent to the high - temperature expansions of conventional thermal statistical mechanics .",
    "expansions of this type have been examined previously by burda  _ et  al . _",
    "@xcite for strauss s model of a transitive network  @xcite . here",
    "we develop the theory further for general exponential random graphs .",
    "the fundamental idea of perturbation theory for random graphs is the same as for other perturbative methods : we expand about a solvable model in powers of the coupling parameters @xmath45 in the hamiltonian .",
    "we write the hamiltonian for the full model in the form @xmath159 , where @xmath160 is the hamiltonian for the solvable model and @xmath161 takes whatever form is necessary to give the correct expression for  @xmath162",
    ". then the partition function is  @xcite @xmath163 where @xmath164 is the partition function for the unperturbed hamiltonian , and @xmath165 indicates an ensemble average in the unperturbed model .    the only case that has been investigated in any detail is the one where we expand around a random graph , @xmath166 , so that the averages in eq .",
    "( [ perturb ] ) are averages in the ensemble of the random graph .",
    "( it is possible for @xmath25 to be zero , so this choice for @xmath160 does not place any restriction on the form of the overall hamiltonian . if @xmath167 then the expansion is precisely equivalent to an ordinary high - temperature series . )",
    "however , for hamiltonians  @xmath162 that give significant probability to networks substantially different from random graphs , the perturbation theory can not be expected to give accurate answers at low order . in theory",
    "there is no reason why one could not expand about some other solvable case , although no such calculations have been done as far as we are aware",
    ". one obvious possibility , which we do not pursue here , is to expand around one of the generalized random graph forms , eqs .",
    "( [ genrg ] ) and  ( [ gengenrg ] ) .    typically , to make progress with eq .",
    "( [ perturb ] ) , we will expand the exponential in a power series of the form @xmath168 in practice , @xmath161  normally contains a coupling constant , such as the constant  @xmath119 in the 2-star model of eq .",
    "( [ 2star2 ] ) , and thus our expression for the perturbed partition function is an expansion in powers of the coupling .    in this section ,",
    "we apply the perturbation method to two example models .",
    "first , we study a simple model proposed about a quarter of a century ago by holland and leinhardt  @xcite , which is exactly solvable by this method .",
    "then we illustrate the application of the method to the 2-star model and compare its performance against the approximate saddle - point expansion results of the previous section .",
    "our first example of perturbation theory is a directed graph model . in the real world",
    ", many directed graphs display the phenomenon of reciprocity : a directed edge running from vertex  a to vertex  b predisposes the network to have an edge running from b to  a as well .",
    "put another way , the network has a higher fraction of vertex pairs that are joined in both directions than one would expect on the basis of chance ( `` mutual dyads '' in the parlance of social network analysis ) .",
    "behavior of this kind is seen , for example , in the world wide web , email networks , and neural and metabolic networks  @xcite .",
    "holland and leinhardt  @xcite have proposed a exponential random graph model of reciprocity , which we study here in a simplified version .",
    "as we now show , the perturbation expansion for this model can be written down to all orders and resummed to give an exact expression for the partition function .",
    "the hamiltonian for the model is @xmath169 where @xmath42 is the total number of ( directed ) edges in the graph , and @xmath170 is the number of vertex pairs with edges running between them in both directions .",
    "the unperturbed hamiltonian  @xmath160 is that of an undirected random graph ( sec .",
    "[ directedgraphs ] ) with partition function given by eq .",
    "( [ directedz ] ) and each directed edge present with independent probability @xmath171 .",
    "the perturbation  @xmath161 can be written in terms of the adjacency matrix  ( [ adjacencydirected ] ) as @xmath172 then the perturbation series , eq .",
    "( [ series ] ) , for the full hamiltonian is @xmath173 with @xmath174 thus the partition function is written as an expansion in powers of  @xmath113 whose coefficients are correlation functions of elements of the adjacency matrix , calculated within the ordinary random graph .",
    "if we can evaluate these correlation functions , at least up to some finite order , we can also evaluate the perturbed partition function .    since all edges are present or absent independently of one another in the random graph , the correlation functions factor : @xmath175 and so forth .",
    "the only exception is in cases where two or more of the elements @xmath84 being averaged are the same . in that case , noting that @xmath176 for any  @xmath1 , we have results like @xmath177 to evaluate expressions such as  ( [ correlator ] ) , therefore , we need to count the number of independent elements @xmath84 that appear in each term",
    ". this can be difficult for some models , but for the reciprocity model it is quite straightforward .",
    "the question we need to answer is this : if we choose @xmath178 pairs of vertices @xmath96 from the @xmath33 possible pairs , with duplication allowed , how many ways are there of choosing them such that exactly @xmath179 pairs will be distinct ?",
    "each such way makes a contribution of @xmath180 to the partition function  ( [ recippartition ] ) .",
    "let @xmath181 be the number of ways of choosing the pairs such at a _ particular _ set of @xmath179 distinct pairs are chosen at least once each .",
    "note that @xmath182 for all  @xmath178 .",
    "then , from eqs .",
    "( [ recippartition ] ) and  ( [ correlator ] ) @xmath183 where the function @xmath184 is the exponential generating function for  @xmath181 .",
    "now the number of ways of choosing @xmath178 pairs such that all choices are made from a particular set of size  @xmath179 , but without the constraint that each pair in the set appear at least once , is just @xmath185 .",
    "thus @xmath186 , or equivalently @xmath187 multiplying by @xmath188 and summing over @xmath189 , this gives @xmath190 which immediately implies that @xmath191 , by induction on  ( [ induction ] ) with the initial condition @xmath192 .    substituting this result into eq .",
    "( [ comb ] ) then gives us our solution : @xmath193^{n\\choose 2}.\\ ] ] or , making use of eqs .",
    "( [ bernoulli ] ) and  ( [ defsp ] ) @xmath194^{n\\choose2 } , \\label{hlz}\\ ] ] and @xmath195 in the normal fashion .    from these expressions",
    "we can , for instance , obtain the mean number of edges  @xmath23 and the mean number  @xmath196 of pairs of vertices connected by edges running both ways from @xmath197 a quantity of interest in directed networks is the reciprocity  @xcite , which is the fraction of edges that are reciprocated .",
    "this quantity is found to be on the order of tens of percent in networks such as the world wide web .",
    "the reciprocity for the model of holland and leinhardt  is @xmath198    in fig .",
    "[ rp ] , we show the reciprocity , along with the connectance of the network , as a function of @xmath113 for the case @xmath199 . there is no phase transition or other unexpected behavior in this model : the measured properties are smooth functions of the independent parameters .",
    "notice that there is a substantial range of values of @xmath113 over which the connectance is low and the graph realistically sparse , but the reciprocity is still high , with values similar to those seen in real networks .      as our second example of the application of perturbation theory , we return to the 2-star model introduced at the beginning of sec .  [ morecomplex ] .",
    "unlike the case of the reciprocity model in the preceding section , perturbation theory does not lead to an exact solution of the 2-star model but , as we now show , we can get an approximate solution by studying the perturbation expansion to finite order  a different approximation from the saddle - point expansion of sec .",
    "[ nonperturb ] .",
    "we divide the hamiltonian @xmath200 into an unperturbed part @xmath201 , which is the normal bernoulli random graph , and a perturbation hamiltonian @xmath202 .",
    "then , following eq .",
    "( [ series ] ) , the partition function for the full model is given by @xmath203 the number of 2-stars is @xmath204 and therefore @xmath205    our strategy is to evaluate the series  ( [ 2starpartition ] ) up to some finite order in @xmath113 to get an approximate solution for @xmath19 , but there is a problem .",
    "each term in the series corresponds to states of the graph that have the corresponding number of 2-stars : the term in @xmath206 , for instance , counts the number of graphs that have a 2-star in any position in the graph .",
    "this is not enough for our purposes however .",
    "realistic graphs will have not a finite number but a finite _ density _ of 2-stars in them , and the number of such graphs is counted by terms that appear at infinite order in the perturbation expansion in the limit @xmath110 .",
    "so , without going to infinite order as we did in the reciprocity model , we are never going to get meaningful results from our expansion .",
    "similar problems appear in ordinary statistical mechanics and the solution is well known . instead of expanding the partition function , we form an expansion for the free energy",
    ". we can write the free energy as @xmath207 where @xmath208 is the free energy of the unperturbed network and @xmath209 .",
    "now we expand @xmath210 as a power series in  @xmath113 of the form @xmath211 where we have made use of the fact that @xmath212 when @xmath213 . substituting into @xmath214 , we get @xmath215 and comparing terms with eq .",
    "( [ 2starpartition ] ) , we find    [ cumulants ] @xmath216    and so forth .",
    "these are the cumulants of @xmath112 within the ensemble defined by the unperturbed network . if we expand @xmath112 in the form of eq .",
    "( [ n2stars ] ) then they are connected correlations of elements of the adjacency matrix``connected '' because individual elements of the adjacency matrix are uncorrelated , so that all terms in the cumulants vanish unless they involve sets of 2-stars that share one or more edges .",
    "( note that sharing a vertex , as in the more familiar spin models of traditional statistical mechanics , is not a sufficient condition for being connected .",
    "the fundamental degrees of freedom in a network are the edges . )",
    "we will proceed then as follows .",
    "we calculate the free energy @xmath210 in terms of connected correlations up to some finite order in  @xmath113 and from this we calculate the partition function @xmath217 .",
    "even though @xmath210 is known only to finite order , our expression for @xmath19 will include terms with all powers of the connected correlations in it , via the expansion of the exponential , and hence will include graphs with not only a finite number but a finite density of 2-stars .",
    "this idea , which will be routine for those familiar with conventional diagrammatic many - body theory , is entirely general and can be applied to any model , not just the 2-star model .",
    "in essence , the series given by @xmath218 is a partial resummation to all orders of the partition function , including some but not all of the contributions to @xmath19 from disconnected correlations of arbitrarily high order .",
    "let us see how the calculation proceeds for the case of the 2-star model , to order  @xmath219 , as above .",
    "the leading @xmath220 term in @xmath210 is simple : @xmath221 since we are primarily interested in large networks , we can approximate this expression by its value to leading order in @xmath1 , which is @xmath222 .",
    "the second term , at order  @xmath223 , is more complicated because there are several different ways in which two 2-stars may combine to share one or more edges . in order to keep track of these different contributions ,",
    "we make use of a diagrammatic representation similar to that employed by burda  _ et  al . _  for strauss s transitivity model  @xcite .",
    "figure  [ condia]a shows the single diagram contributing to  @xmath224 , which gives the result in eq .",
    "( [ f1 ] ) . figure  [ condia]b shows the three diagrams that contribute to  @xmath225 .",
    "it is an assumption of our notation that each edge that appears in a diagram is distinct .",
    "thus the third diagram in fig .",
    "[ condia]b , which represents the case in which the two 2-stars fall on top of one another , must be depicted separately , rather than being considered a special case of the first diagram .",
    "this turns out to be a good idea , since this term has a different functional form from the first diagram , and neither diagram is necessarily negligible by comparison with the other .    in general the basic `` feynman rules '' for interpreting the diagrams are :    1 .",
    "each edge contributes a factor of  @xmath38 ; 2 .",
    "each vertex contributes a factor of  @xmath1 ; 3 .",
    "the numerical multiplier is the number of distinct ways in which the diagram can be decomposed into overlapping 2-stars such that each edge occurs at least once , divided by the symmetry factor for the diagram .",
    "( the symmetry factor is the number of distinct permutations of the vertices that leave the diagram unchanged . )",
    "then for the connected correlation functions one must subtract all other ways of composing lower order diagrams to make the given diagram , as in eq .",
    "( [ cumulants ] ) .    to see how these rules work in practice ,",
    "let us apply them to the first diagram in fig .",
    "[ condia]b .",
    "this diagram has four vertices and three edges , which gives a factor of @xmath226 , by the first two rules .",
    "the diagram can be decomposed into two 2-stars in 6 different ways , but the symmetry factor is also 6 , so we end up with @xmath227 .",
    "the contribution to the diagram from the term @xmath228 in eq .",
    "( [ cumulantsb ] ) is @xmath229 , so the final value of the diagram is @xmath230 to leading order in  @xmath1 .",
    "proceeding in a similar fashion , the other diagrams of fig .",
    "[ condia]b contribute @xmath230 and @xmath231 , respectively .",
    "the diagrams for the @xmath232 term are shown in fig .",
    "[ condia]c , and are more complicated , but routine to evaluate using the rules above .",
    "the final expressions for the @xmath233s are :    @xmath234    note that we have retained the leading order terms in @xmath1 separately at each order in  @xmath38 , since we have no knowledge _ a priori _ about the relative magnitude of @xmath1 and  @xmath38 . in a sparse graph",
    ", we expect that @xmath38 will be of order @xmath97 , in which case it may be possible to neglect some terms .",
    "once we have the expansion of  @xmath210 , it is straightforward to calculate statistical averages from derivatives of the free energy in the normal fashion .",
    "for example , the expected number of 2-stars in the network is given by @xmath235 and the expected number of edges is @xmath236.\\nonumber\\\\\\end{aligned}\\ ] ]    in fig .",
    "[ 2star ] , we show the connectance @xmath237 and the density of 2-stars @xmath238 calculated from the saddle - point method of sec .  [ nonperturb ] and from the expressions above , at first , second , and third order . as the figure shows , the perturbation expansion agrees with the non - perturbative method at high and low values of  @xmath116 , and markedly better for the third - order approximation than for the first- and second - order ones .",
    "however , in the region of the phase transition at @xmath134 the agreement is poor , as we would expect . in this region",
    "there will be large critical fluctuations and hence contributions to the free energy from large connected diagrams that are entirely missing from our series expansion . presumably by extending the perturbation series",
    "we can derive successively more accurate answers in the critical region .",
    "we also note that the perturbation expansion gives results only for the sparse phase in the symmetry - broken region .",
    "we have here studied in detail two examples of the treatment of exponential random graphs by perturbation theory ( and another can be found in ref .",
    "the techniques we have used , however , are entirely general and diagrammatic theories similar to these , with similarly simple `` feynman rules , '' can be derived for other examples as well .",
    "in this paper we have discussed exponential random graphs , which in both a figurative and a quantitative sense play the role of a boltzmann ensemble for the study of networks . exponential random graphs are a formally well - founded framework for making predictions about the expected properties of networks given specific measurements of properties of those networks . we have shown in this paper how they can be derived in moderately rigorous fashion from maximum entropy assumptions about probability distributions over graph ensembles .",
    "we have given many examples of particular calculations using exponential random graphs , starting with simple random graph models that have linear hamiltonians , many of which have been presented previously by other authors , albeit it with rather different motivation . in most cases",
    "these linear models can be solved exactly , meaning that we can derive the partition function or equivalently the free energy of the graph ensemble exactly in the limit of large system size .    for nonlinear hamiltonians",
    "it appears possible to find exact solutions only rarely , but we have been able to find approximation solutions in several cases using a number of different methods .",
    "taking the particular example of the 2-star model , we have shown how its behavior can be understood using mean - field theory , perturbation theory , and non - perturbative methods based on the hubbard  stratonovich transform .",
    "we have also given one example , the reciprocity model of holland and leinhardt , that is exactly solvable by evaluating its perturbation expansion to all orders .    the results presented in this paper are only a tiny fraction of what can be done with exponential random graphs .",
    "there are many interesting challenges , both practical and mathematical , posed by this class of models .",
    "exploration of the behavior and predictions of specific models as functions of their free parameters , development of other approximate solution methods , or expansion of those presented here , and the development of models to study network phenomena of particular interest , such as vertex ",
    "vertex correlations , effects of hidden variables , effects of degree distributions , and transitivity , are all excellent directions for further research .",
    "we hope to see some of these topics pursued in the near future .",
    "the authors thank julian besag , mark handcock , and pip pattison for useful conversations .",
    "this work was supported in part by the national science foundation under grant number dms0234188 and by the james s. mcdonnell foundation .",
    "j.  m. kleinberg , s.  r. kumar , p.  raghavan , s.  rajagopalan , and a.  tomkins , the web as a graph : measurements , models and methods . in _ proceedings of the international conference on combinatorics and computing _ , number 1627 in lecture notes in computer science , pp .",
    "118 , springer , berlin ( 1999 ) ."
  ],
  "abstract_text": [
    "<S> we study the family of network models derived by requiring the expected properties of a graph ensemble to match a given set of measurements of a real - world network , while maximizing the entropy of the ensemble . </S>",
    "<S> models of this type play the same role in the study of networks as is played by the boltzmann distribution in classical statistical mechanics ; they offer the best prediction of network properties subject to the constraints imposed by a given set of observations . </S>",
    "<S> we give exact solutions of models within this class that incorporate arbitrary degree distributions and arbitrary but independent edge probabilities . </S>",
    "<S> we also discuss some more complex examples with correlated edges that can be solved approximately or exactly by adapting various familiar methods , including mean - field theory , perturbation theory , and saddle - point expansions . </S>"
  ]
}