{
  "article_text": [
    "artificial intelligence ( ai ) , as described by russell and norvig  @xcite , is the study of general principles of rational agents and components for constructing these agents .",
    "more broadly , it involves building intelligent entities that mimic ` cognitive ' functions we intuitively associate with human minds , such as ` learning ' and ` problem solving . '",
    "we interpret the term ai broadly to include closely - related areas such as machine learning  @xcite .",
    "systems that heavily use ai , henceforth referred to as _ ai - based systems _ , have had a significant impact in society in domains that include healthcare , transportation , social networking , e - commerce , education , etc .",
    "this growing societal - scale impact has brought with it a set of risks and concerns including errors in ai software , cyber - attacks , and safety of ai - based systems  @xcite .",
    "therefore , the question of verification and validation of ai - based systems has begun to demand the attention of the research community .",
    "we define `` _ verified ai _ '' as the goal of designing ai - based systems that are proven to satisfy desired properties specified in a mathematical formalism",
    ". how can we achieve this goal ?",
    "a natural starting point is to consider _ formal methods _  a field of computer science and engineering concerned with the rigorous mathematical specification , design , and verification of systems  @xcite . at its core ,",
    "formal methods is about _ proof _ : formulating specifications that form proof obligations , designing systems to meet those obligations , and verifying , via algorithmic proof search , that the systems indeed meet their specifications .",
    "verification techniques such as model checking  @xcite and theorem proving ( see , e.g.  @xcite ) are used routinely in the computer - aided design of integrated circuits and have been widely applied to find bugs in software , analyze embedded systems , and find security vulnerabilities . at the heart of these advances",
    "are computational proof engines such as boolean satisfiability ( sat ) solvers  @xcite , boolean reasoning and manipulation routines based on binary decision diagrams ( bdds )  @xcite , and satisfiability modulo theories ( smt ) solvers  @xcite .    in this paper , we consider the challenge of verified ai from a formal methods perspective .",
    "that is , we review the manner in which formal methods have traditionally been applied , analyze the challenges this approach may face for ai - based systems , and propose techniques to overcome these challenges . to begin with ,",
    "consider the typical formal verification process as shown in figure  [ fig : formal - verif - flow ] , which begins with the following three inputs :    a model of the system to be verified , @xmath0 ;    a model of the environment , @xmath1 , and    the property to be verified , @xmath2 .",
    "the verifier generates as output a yes / no answer , indicating whether or not @xmath0 satisfies the property @xmath2 in environment @xmath1 .",
    "typically , a no output is accompanied by a counterexample , also called an error trace , which is an execution of the system that indicates how @xmath2 is violated .",
    "some formal verification tools also include a proof or certificate of correctness with a yes answer .",
    "formal verification procedure.,width=384 ]    in this paper , we use the term `` formal verification '' to apply to any verification technique that uses some aspect of formal methods .",
    "for instance , we include simulation - based hardware verification methods that , while based on formal specifications ( assertions ) , employ best - effort heuristics to find violations of those specifications .",
    "( the term `` semi - formal verification '' is sometimes used for such methods . )",
    "such simulation - based verification methods have also found practical use in industrial verification of cyber - physical systems , e.g. , for automotive systems  @xcite .    in order to apply formal verification to ai - based systems , at a minimum",
    ", one must be able to generate the three inputs @xmath0 , @xmath1 and @xmath2 in formalisms for which ( ideally ) there exist decision procedures to answer the yes / no question as described above .",
    "additionally , these decision procedures must be efficient .",
    "meeting these requirements , however , is not straightforward . indeed , in our view , the challenges for verified ai stem directly from these requirements .",
    "we outline these challenges in section  [ sec : challenges ] below , and describe ideas to address each of these challenges in section  [ sec : principles ] .",
    "we identify five major challenges to achieving formally - verified ai - based systems . in this section , we sketch out these challenges , illustrating them with examples from the domain of ( semi-)autonomous driving .      in the traditional success stories for formal verification , such as verifying cache coherence protocols or device drivers , the _ interface _ between the system @xmath0 and its environment @xmath1 is well defined .",
    "moreover , while the environment itself may not be known , it is usually acceptable to model it as a _ non - deterministic _ process subject to constraints specified in a suitable logic or automata - based formalism .",
    "typically such an environment model is `` over - approximate '' , meaning that it may include more environment behaviors than are possible .",
    "we see systems based on ai or machine learning ( ml ) as being quite different .",
    "consider an autonomous vehicle operating in rush - hour traffic in an urban environment .",
    "it may be impossible even to precisely define the interface between the system and environment ( i.e. , to identify the variables / features of the environment that must be modeled ) , let alone to model all possible behaviors of the environment .",
    "even if the interface is known , non - deterministic or over - approximate modeling is likely to produce too many spurious bug reports , rendering the verification process useless in practice .",
    "similarly , for systems involving joint human - machine control , such as semi - autonomous vehicles , human agents are a key part of the environment and/or system .",
    "researchers have attempted modeling humans as non - deterministic or stochastic processes with the goal of verifying the correctness of the overall system  @xcite . given the variability and uncertainty in human behavior ,",
    "a data - driven approach based on machine learning is usually necessary .",
    "such an approach , in turn , is sensitive to the quality of data .",
    "for example , the technique of inverse reinforcement learning  @xcite can be used for learning the reward function of human agents  @xcite .",
    "however , accuracy of the learned reward function depends on the expressivity of the hand - coded features by the designer and the amount and variety of the data collected . in order",
    "to achieve verified ai for such human - in - the - loop systems , we need to address the limitations of the current human modeling techniques and provide guarantees about their _ prediction accuracy and convergence_. when learned models are used , one must represent any _ uncertainty in the learned parameters _ as a first - class entity in the model , and take that into account in verification and control .",
    "the first challenge , then , is to come up with a method of environment modeling that allows one to provide provable guarantees on the system s behavior even when there is considerable uncertainty about the environment .",
    "formal verification critically relies on having a formal specification  a precise , mathematical statement of what the system is supposed to do .",
    "however , the challenge of coming up with a high - quality formal specification is well known , even in application domains in which formal verification has found considerable success ( see , e.g. ,  @xcite ) .",
    "this challenge is only exacerbated in ai - based systems .",
    "consider a module in an autonomous vehicles that performs object recognition , distinguishing humans from other objects .",
    "what is the specification for such a module ? how might it differ from the specifications used in traditional applications of formal methods ? what should the specification language be , and what tools can one use to construct a specification ?",
    "thus , the second challenge is to find an effective method to specify desired and undesired properties of systems that use ai- or ml - based components .      in most traditional applications of formal verification , the system @xmath0 is precisely known : it is a c program , or a circuit described in a hardware description language .",
    "the system modeling problem is primarily concerned with reducing the size of the @xmath0 to a more tractable representation by abstracting away irrelevant details .",
    "ai - based systems lead to a very different challenge for system modeling .",
    "a major challenge is the use of _ machine learning _ , where the system evolves as it encounters new data and new situations .",
    "modeling a deep neural network that has been trained on millions of data points can be challenging enough even if one `` freezes '' the training process : new abstraction techniques will be necessary .",
    "additionally , the verification procedure must account for future changes in the learner as new data arrives .",
    "new techniques must be devised to formally model components based on machine learning .",
    "formal methods has proved effective for the systematic generation of test data in various settings including simulation - based verification of circuits ( e.g. ,  @xcite ) and finding security exploits in commodity software ( e.g. ,  @xcite ) . in these cases , even though the end result is not a proof of correctness of the system @xmath0 , the generated tests raise the level of assurance in the system s correctness .",
    "can the testing of ai - based systems leverage formal methods in a similar manner ?",
    "recent efforts have shown that various machine learning algorithms can fail under small adversarial perturbations  @xcite . learning algorithms promise to generalize from data , but such simple perturbations that fool the algorithms create concerns regarding their use in safety - critical applications such as autonomous driving .",
    "such small perturbations might be even unrecognizable to humans , but drive the algorithm to misclassify the perturbed data .",
    "the fourth challenge we identify is to devise techniques based on formal methods to systematically generate training and testing data for ml - based components .",
    "a constant question asked of formal verification is whether it can scale up to handle industrial designs .",
    "much progress has been made in this regard , especially in the area of hardware verification , where formal methods are a standard part of the design flow .",
    "however , in systems that use ai or ml , the scalability challenge is even greater .",
    "in addition to the scale of systems as measured by traditional metrics ( dimension of state space , number of components , etc . ) , the _ types _ of components can be much more complex .",
    "for instance , in ( semi-)autonomous driving , autonomous vehicles and their controllers need to be modeled as _",
    "hybrid systems _ combining both discrete and continuous dynamics .",
    "moreover , agents in the environment ( humans , other vehicles ) may need to be modeled as _ probabilistic processes_. finally , the requirements may involve not only traditional boolean specifications on safety and liveness , but also _ quantitative requirements _ on system robustness and performance .",
    "for each of the challenges described in the preceding section , we suggest a corresponding set of principles to follow in the design / verification process to address that challenge .",
    "these five principles are :    _ introspect _ on the system to model the environment ;    formally specify _ end - to - end behavior _ of the ai - based system ;    develop _ abstractions _ for and _ explanations _ from ml components ;    create a new class of _ randomized formal methods _ for systematically generating training / test data , and    develop computational engines for _ run - time , quantitative , and learning - based verification_.    we do not attempt to be exhaustive here .",
    "our goal is to bring up ideas that complement other suggestions that have been made in the literature ( e.g. ,  @xcite ) . taken together with other ideas , we believe that the principles we suggest can point a way towards the goal of verified ai .      recall from sec .",
    "[ sec : env - challenge ] the challenge of modeling the environment @xmath1 of an ai - based system @xmath0 .",
    "we believe that a promising strategy to meet this challenge is to develop design and verification methods that are _ introspective _ , i.e. , they identify assumptions @xmath3 that system @xmath0 makes about the environment @xmath1 that are sufficient to guarantee the satisfaction of the specification @xmath2 . the assumptions @xmath3 must be such that , at run time , @xmath0 can _ efficiently monitor _ @xmath3 so as to ensure that they always hold . moreover , if there is a human operator involved , one might want @xmath3 to be translatable into an explanation that is _ human understandable _ , so that @xmath0 can `` explain '' to the human why it may not be able to satisfy the specification @xmath2 .    ideally , the assumptions @xmath3 must be the weakest set of such assumptions that @xmath0 makes about its environment .",
    "however , given the other requirements for @xmath3 to be efficiently monitorable and human understandable , one may need to settle for a stronger assumption .",
    "as an example , consider an autonomous vehicle that is trying to maintain a minimum distance from any other object while being in motion  this forms the specification @xmath2 .",
    "note that @xmath2 defines an interface and a set of sensors that the vehicle @xmath0 must use to check for itself that @xmath2 is satisfied . on top of this",
    "minimal interface , suppose that @xmath0 tracks other features of the environment @xmath1 such as the state of traffic lights , the number of vehicles in its vicinity , their state such as their velocity , whether they are human - driven , an estimate of those human drivers intent and driving style , etc .",
    "it will then need to generate assumptions @xmath3 to monitor over this expanded interface ( as well as its internal state ) so as to ensure that when @xmath3 is satsified , so is @xmath2 .",
    "extracting good assumptions may be easier during the design process , e.g. , while synthesizing a controller for @xmath0 .",
    "preliminary work by the authors has shown that such extraction of monitorable assumptions is feasible in simple cases  @xcite , although much more research is required to make this practical .",
    "writing formal specifications for ai / ml components is hard , even impossible if the task involves a version of the turing test .",
    "how can we address this challenge described in sec .",
    "[ sec : spec - challenge ] ?    as researchers often say : when the problem is too hard , perhaps we should change the problem ! we believe that formally specifying the behavior of an ai / ml component may be unnecessary . instead , one should focus on _ precisely specifying the end - to - end behavior _ of the _ entire ai - based system_. by `` end - to - end '' we mean the specification on the entire system , not just on the ai / ml component ; this is sometimes referred to as a `` system - level '' specification .",
    "we believe that this latter task , in many if not most cases , can be done more easily .",
    "consider again our autonomous vehicle scenario from the previous section .",
    "it should be straightforward to specify the property @xmath2 corresponding to maintaining a minimum distance from any object during motion .",
    "this property says nothing about any component that uses machine learning .    of course",
    ", in order to test the ml - based component , it is useful to have a formal specification on its interface . however , we believe this specification does not need to be exact : a `` likely specification '' could suffice .",
    "we suggest the use of techniques for inferring specifications from behaviors and other artifacts  so - called _ specification mining _ techiques ( e.g. ,  @xcite ) , for this purpose .",
    "let us now consider the challenge , described in sec .",
    "[ sec : sys - challenge ] , of modeling systems @xmath0 that learn from experience .",
    "we believe a combination of _ automated abstraction _ and _ explanation - based learning _ will be needed to model such systems for purposes of formal verification .",
    "first , effective techniques need to be developed to abstract ml components into a formalism for which efficient verification techniques exist or can be developed . since the guarantees many ml",
    "algorithms give are probabilistic , this will require the development of _ probabilistic logics _ and similar formalisms that can capture these guarantees ( e.g. ,  @xcite ) . additionally , if the output of a learning algorithm is accompanied by a measure of _ uncertainty _ about its correctness , then that uncertainty must be propagated to the rest of the system and represented in the model of the overall system .",
    "for example , the formalism of _ convex markov decision processes _",
    "( convex mdps )  @xcite provide a way of representing uncertainty in the values of learned transition probabilities .",
    "algorithms for verification and control may then need to be extended to handle these new abstractions ( see , e.g. ,  @xcite ) .",
    "the task of modeling a learning system can be made easier if the learner accompanies its predictions with _ explanations _ of how those predictions result from the data and background knowledge .",
    "in fact , this idea is not new ",
    "it has long been investigated by the ml community under terms such as _ explanation - based generalization _  @xcite .",
    "when such explanations are made compatible with the modeling languages used in formal methods , the task of system modeling for verification will be considerably easier .",
    "the literature in formal methods on _ explaining failures or counterexamples _ may also be relevant .",
    "for example , assume that a misclassification by a ml component causes a failure of an end - to - end specification . if we can apply techniques from the formal methods literature to localize that failure ( e.g. ,  @xcite ) , then we could identify whether the ml - component was responsible . _ counterfactual reasoning _ has been used in the formal methods literature for explaining failures , and we believe such an approach will also be useful in the context of ai - based systems .",
    "consider the challenge , described in sec .",
    "[ sec : train - challenge ] , of generating training data for a ml component in an ai - based system . more concretely ,",
    "suppose we wish to systematically test a classifier @xmath4 that given a set of data points ( images , audio , etc . )",
    "@xmath5 assigns a real - valued label to them @xmath6 .",
    "one testing problem is to find a perturbation @xmath7 such that the algorithm flips the label it assigns to ( many ) examples upon perturbation , i.e. , @xmath8 .",
    "such perturbations can not be done arbitrarily .",
    "one challenge is to define the space of `` legal '' perturbations so that the resulting examples are still legal inputs that look `` realistic '' .",
    "additionally , one might need to impose constraints on the distribution of the generated examples in order to obtain guarantees about convergence of the learning algorithm to the true concept .",
    "how do we meet all these requirements ?",
    "we believe that the answer may lie in a new class of _ randomized formal methods _  randomized algorithms for generating test inputs subject to formal constraints and distribution requirements . specifically , a recently defined class of techniques , termed _",
    "control improvisation _",
    "@xcite , holds much promise .",
    "an improviser is a generator of random strings ( examples ) @xmath9 that satisfy three constraints : ( i ) a _ hard constraint _ that defines the space of legal @xmath9 ; ( ii ) a _ soft constraint _ defining how the generated @xmath9 must be similar to real - world examples , and ( iii ) a _ randomness requirement _ defining a constraint on the output distribution .",
    "the theory of control improvisation is still in its infancy , and we are just starting to understand the computational complexity and to devise efficient algorithms . much more remains to be done .",
    "another challenge for the systematic generation of training data for ml components is to model those components and their requirements in a suitable manner . to deal with this",
    ", we think techniques for _ black - box test generation _ for cyber - physical systems ( e.g.  @xcite ) can be useful in generating training and test data for ml components .",
    "these methods would treat ml components as black - box components and generate training data using an end - to - end formal specification .",
    "additionally , there has been considerable recent work on _ safe learning - based control _",
    "( e.g. ,  @xcite ) . in this approach ,",
    "a safety envelope is pre - computed and a learning algorithm is used to tune a controller within that envelope .",
    "however , how does one generate `` interesting '' trajectories within the safety envelope to train the learning system well ?",
    "we believe the theory of control improvisation could be useful here .",
    "once effective methods for formalizing @xmath0 , @xmath1 , and @xmath2 are devised for ai - based systems , then one must design engines for deciding whether @xmath0 satisfies the specification @xmath2 in the environment @xmath1 . at this point ,",
    "the scalability challenge described in sec .",
    "[ sec : scale - challenge ] will loom large .",
    "we will need the analogs of sat , bdds , and smt for ai - based systems .",
    "although it is too early to know exactly what formalisms will be best suited for ai - based systems , and therefore what computational engines are needed , we believe a few directions are clear .",
    "first , the complexity and heterogeneity of ai - based systems means that , in general , many decision problems underlying formal verification are likely to be undecidable .",
    "( for example , even deciding whether a state of a linear hybrid system is reachable is undecidable . ) to overcome this obstacle posed by computational complexity , one must either ( i ) find tractable but realistic problem classes , or ( ii ) settle for incomplete or unsound formal verification methods ( i.e. , semi decision procedures ) .",
    "techniques for simulation - based verification or run - time verification can prove very fruitful in this regard , as has been recently demonstrated for industrial automotive systems ( e.g.  @xcite ) .",
    "further , we believe that it will be important to move from verification problems with purely `` boolean '' yes / no answers to problems with quantitative solutions .",
    "such a move is motivated by the use of probabilistic modeling as well as a need for defining cost - based specifications with the goal of minimizing cost . some initial steps",
    "have been taken with the use of logics with quantitative semantics , such as signal temporal logic  @xcite , and automata - theoretic formalisms such as weighted automata  @xcite , but much more remains to be done .",
    "similarly , work on smt solving must be extended to more effectively handle cost constraints  in other words , combining smt solving with optimization methods ( e.g. ,  @xcite ) .",
    "finally , we believe that verification methods themselves are benefiting from the use of inductive learning  @xcite .",
    "an emerging topic in formal methods , termed _ formal inductive synthesis _",
    "@xcite , shows much promise for tackling hard problems in verification and synthesis by leveraging expert human insight in combination with induction and deduction .",
    "taking a formal methods perspective , we have analyzed the challenge of formally verifying systems that use artificial intelligence or machine learning .",
    "we identified five main challenges : environment modeling , formal specification , system modeling , generating training / test data , and scalability .",
    "for each of these five challenges , we have identified corresponding principles for design and verification that hold promise for addressing that challenge .",
    "we are currently engaged in developing the theory behind these principles , and applying them to the design of human cyber - physical systems  @xcite , with a special focus on semi - autonomous driving , and expect to report on the results in the years to come .",
    "the authors work is supported in part by nsf grants ccf-1139138 and ccf-1116993 , by an ndseg fellowship , and by the terraswarm research center , one of six centers supported by the starnet phase of the focus center research program ( fcrp ) a semiconductor research corporation program sponsored by marco and darpa .",
    "we gratefully acknowledge the many colleagues with whom our conversations and collaborations have helped shape this document .",
    "clark barrett , roberto sebastiani , sanjit  a. seshia , and cesare tinelli .",
    "satisfiability modulo theories . in armin biere , hans van maaren , and toby walsh , editors , _ handbook of satisfiability _ ,",
    "volume  4 , chapter  8 .",
    "ios press , 2009 .",
    "nikolaj bjrner , anh - dung phan , and lars fleckenstein .",
    "@xmath10z - an optimizing smt solver . in",
    "international conference on tools and algorithms for the construction and analysis of systems _ , pages 194199 .",
    "springer , 2015 .",
    "m.  chen , j.  f. fisac , s.  sastry , and c.  j. tomlin .",
    "safe sequential path planning of multi - vehicle systems via double - obstacle hamilton - jacobi - isaacs variational inequality . in _",
    "14th european control conference ( ecc ) _ , 2015 .",
    "jyotirmoy deshmukh , alexandre donz , shromona ghosh , xiaoqing jin , garvit juniwal , and sanjit  a. seshia .",
    "robust online monitoring of signal temporal logic . in _ proceedings of the international conference on runtime verification ( rv ) _ ,",
    "volume 9333 of _ lecture notes in computer science _ , pages 5570 .",
    "springer , september 2015 .",
    "daniel  j. fremont , alexandre donz , sanjit  a. seshia , and david wessel .",
    "control improvisation . in _",
    "35th iarcs annual conference on foundations of software technology and theoretical computer science ( fsttcs 2015 ) _ , pages 463474 , 2015 .",
    "shromona ghosh , dorsa sadigh , pierluigi nuzzo , vasumathi raman , alexandre donz , alberto  l. sangiovanni - vincentelli , s.  shankar sastry , and sanjit  a. seshia .",
    "diagnosis and repair for synthesis from signal temporal logic specifications . in _ proceedings of the 9th international conference on hybrid systems : computation and control ( hscc ) _ , april 2016 .          xiaoqing jin , alexandre donz , jyotirmoy deshmukh , and sanjit  a. seshia .",
    "mining requirements from closed - loop control models . in _ proceedings of the international conference on hybrid systems : computation and control ( hscc ) _ , april 2013 .",
    "nathan kitchen and andreas kuehlmann .",
    "stimulus generation for constrained random simulation . in _ proceedings of the 2007 ieee / acm international conference on computer - aided design ( iccad ) _ , pages 258265 .",
    "ieee press , 2007 .",
    "wenchao li , lili dworkin , and sanjit  a. seshia . mining assumptions for synthesis . in _ proceedings of the ninth acm /",
    "ieee international conference on formal methods and models for codesign ( memocode ) _ , pages 4350 , july 2011 .",
    "wenchao li , dorsa sadigh , s.  shankar sastry , and sanjit  a. seshia .",
    "synthesis for human - in - the - loop control systems . in _ proceedings of the 20th international conference on tools and algorithms for the construction and analysis of systems ( tacas ) _",
    ", pages 470484 , april 2014 .",
    "anh nguyen , jason yosinski , and jeff clune .",
    "deep neural networks are easily fooled : high confidence predictions for unrecognizable images . in _",
    "2015 ieee conference on computer vision and pattern recognition ( cvpr ) _ , pages 427436 .",
    "ieee , 2015 .",
    "s.  owre , j.  m. rushby , and n.  shankar . : a prototype verification system . in deepak kapur , editor , _",
    "11th international conference on automated deduction ( cade ) _ , volume 607 of _ lecture notes in artificial intelligence _",
    ", pages 748752 .",
    "springer - verlag , june 1992 .",
    "alberto puggelli , wenchao li , alberto sangiovanni - vincentelli , and sanjit  a. seshia .",
    "polynomial - time verification of pctl properties of mdps with convex uncertainties . in",
    "_ proceedings of the 25th international conference on computer - aided verification ( cav ) _ , july 2013 .",
    "stuart russell , tom dietterich , eric horvitz , bart selman , francesca rossi , demis hassabis , shane legg , mustafa suleyman , dileep george , and scott phoenix .",
    "letter to the editor : research priorities for robust and beneficial artificial intelligence : an open letter .",
    ", 36(4 ) , 2015 .",
    "dorsa sadigh , katherine driggs - campbell , alberto puggelli , wenchao li , victor shia , ruzena bajcsy , alberto  l. sangiovanni - vincentelli , s.  shankar sastry , and sanjit  a. seshia .",
    "data - driven probabilistic modeling and verification of human driver behavior . in _ formal verification and modeling in human - machine systems , aaai spring symposium _ , march 2014 .",
    "yasser shoukry , pierluigi nuzzo , alberto puggelli , alberto  l. sangiovanni - vincentelli , sanjit  a. seshia , mani srivastava , and paulo tabuada . : a satisfiability modulo theory solver for secure state estimation . in _ in 13th international workshop on satisfiability modulo theories ( smt ) _ , july 2015 .",
    "tomoya yamaguchi , tomoyuki kaga , alexandre donze , and sanjit  a. seshia .",
    "combining requirement mining , software model checking , and simulation - based verification for industrial automotive systems .",
    "technical report ucb / eecs-2016 - 124 , eecs department , university of california , berkeley , june 2016 ."
  ],
  "abstract_text": [
    "<S> _ verified artificial intelligence ( ai ) _ is the goal of designing ai - based systems that are provably correct with respect to mathematically - specified requirements . </S>",
    "<S> this paper considers verified ai from a formal methods perspective . </S>",
    "<S> we describe five challenges for achieving verified ai , and five corresponding principles for addressing these challenges . </S>"
  ]
}