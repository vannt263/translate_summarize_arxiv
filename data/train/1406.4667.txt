{
  "article_text": [
    "the born - oppenheimer  @xcite ( bo ) , or adiabatic , approximation is amongst the most fundamental approximations in physics and chemistry , and is at the basis of our understanding of the coupled electron - nuclear dynamics in molecules and solids . at the heart of the bo approximation",
    "lies the assumption that , due to the high ratio between nuclear and electronic masses , the electrons move much faster than the nuclei and adjust instantaneously to the positions of the slower - moving nuclei . a molecule or solid",
    "is then viewed as a set of nuclei moving on a single potential energy surface ( pes ) generated by the electrons in a given eigenstate .",
    "moreover , the fundamental constructs of the bo approach , the bopess , form the launching ground for methods that describe processes beyond the adiabatic regime where the bo approximation itself fails . prominent examples of such electronic non - adiabatic processes appear throughout physics , chemistry and biology , for example vision  @xcite , photo - synthesis  @xcite , photo - voltaics  @xcite , proton - transfer / hydrogen storage  @xcite .    the standard approaches to describe non - adiabatic molecular processes are in terms of coupled bopess and transitions between the corresponding adiabatic electronic states induced by the nuclear motion . in the born - huang expansion",
    ", the exact solution of the time - dependent schrdinger equation ( tdse ) is expanded in the complete set of bo electronic states , leading to a nuclear wave packet with contributions on several bopess that undergo transitions in the regions of strong non - adiabatic coupling .",
    "this formally exact approach is hard to use in practice because of the high computational cost of describing the nuclear time evolution quantum mechanically .",
    "approximate methods that retain a quantum description of nuclei have been successful in some applications ( e.g. multiple - spawning  @xcite , multiconfiguration time - dependent hartree  @xcite , or non - adiabatic bohmian dynamics  @xcite methods ) , but are still limited due to the computational effort required .",
    "therefore , approaches that involve a classical or semi - classical description of the nuclear motion that is non - adiabatically coupled to the ( quantum mechanical ) electrons become methods of choice due to their applicability to large systems .",
    "ubiquitous are the ehrenfest and surface - hopping methods . in developing a mixed quantum - classical approach ,",
    "however , one faces two challenging questions : what are the true classical forces acting on the nuclear subsystem ?",
    "how is the coupling between the nuclear classical trajectories and the electronic subsystem defined ? despite extensive studies of both new and routinely used methods  @xcite , there is still no clear answer to the aforementioned questions .    in recent work",
    "we have resolved the question of what force drives the nuclei  @xcite based on the novel perspective offered by the exact decomposition of electronic and nuclear motion of refs .",
    "the full molecular wave function is represented as a single product of a purely nuclear wave function and an electronic factor that parametrically depends on the nuclear coordinates  @xcite .",
    "we have shown that in this framework , the nuclear dynamics is governed by a tdse that contains a time dependent potential energy surface ( tdpes ) and a time - dependent vector potential .",
    "these potentials are rigorous concepts and provide the exact _ driving forces _ of the nuclear evolution . refs .",
    "@xcite showed that step - like features in these exact potentials mediate coupling between piecewise born - oppenheimer surfaces .",
    "@xcite demonstrated that a classical nuclear trajectory evolving on the exact tdpes can capture accurately averaged observables , such as the mean nuclear position , but fails to capture the splitting of the nuclear wave packet that occurs after passing through an avoided crossing between adiabatic surfaces .",
    "@xcite explored a self - consistent mixed quantum - classical scheme , treating the nuclei classically in both the electronic and nuclear equations of motion , finding reasonable accuracy for averaged observables but again no wave packet splitting .    in the present paper , we analyze in detail a model non - adiabatic charge transfer process within the exact factorization framework when the nuclei are evolved classically .",
    "we consider a one - dimensional ( 1d ) model simple enough to allow for an exact solution of the full tdse , while at the same time exhibiting characteristic features associated with non - adiabatic dynamics .",
    "our main results are threefold .",
    "first , we show that , once an _ ensemble _ of independent classical trajectories is evolved on the exact tdpes , splitting of the nuclear wave packet characterizing a non - adiabatic event can be captured .",
    "this therefore overcomes the limitations of the single trajectory dynamics of ref .",
    "in fact , it turns out that the resulting quasiclassical evolution is essentially identical to the exact quantum nuclear dynamics .",
    "the representation of the quantum nuclear wave packet as an ensemble of independent trajectories is the only approximation we make : the forces acting on the classical nuclei are obtained from the exact potentials acting on the nuclear subsystem , containing , in the parlance of mixed quantum - classical methods , the exact `` quantum electronic back - reaction '' .",
    "the features of the time dependent potential responsible for the splitting , and in general for the evolution of the nuclei , are analyzed in detail and compared with the standard picture in terms of static bopess .",
    "importantly , we highlight the significance of the gauge - dependent contribution to the exact tdpes : without this term the quasiclassical dynamics is poor . in previous work",
    "@xcite the structure of the gauge - independent ( gi ) term has been analyzed for this problem , and it was observed that the gauge - dependent ( gd ) term appears to largely cancel step structures in the gi term .",
    "this brings us to our second main result : we analyze , with the help of some semiclassical arguments , the structure of the gd term , and explain why it consists of piecewise flat segments joined by steps which almost , but not completely , cancel the steps in the gi term .",
    "our third main result concerns the question of what mixed quantum - classical dynamics based on the exact tdpes can tell us about standard approaches such as trajectory surface - hopping ( tsh ) . in particular , how does the exact force on a trajectory evolving on the tdpes compare to the force it experiences in tsh ?",
    "we find several aspects that are somewhat qualitatively in common : after passing through an avoided crossing region , the exact tdpes tracks one bopes or the other piecewise in space ; moreover , it displays an energy adjustment between the surfaces , which can been ( gauge-)transformed to a kinetic energy contribution , reminiscent of the velocity - adjustment in tsh .",
    "we show that the exact tdpes sheds light on the notorious problem of over - coherence in tsh  @xcite by comparing the electronic density - matrix associated to trajectories in each case .",
    "the force resulting from the step features in the tdpes appear to be intimately related to creating decoherence , lacking in tsh",
    ".    the larger context in which these results stand is the eventual development of a new mixed quantum - classical approach to non - adiabatic dynamics based on potentials arising out of the exact factorization of the electron - nuclear wave function . in the present paper",
    "we do not derive an algorithm , but we show the features of the classical force that such a numerical scheme should reproduce . in realistic systems the exact forces acting on the nuclei will need to be approximated , and these approximations should build in the features uncovered in the present work in order to yield accurate dynamics .",
    "further , it is extremely instructive to present our analysis in comparison to other methods , as this comparison gives an idea of the real possibilities of our procedure in perspective to what has been already proposed in the literature .",
    "moreover , being aware of the difficulties in interpreting the new formalism , we try to put our new findings in the light of _ old _ concepts , in order to help the reader understanding the potentiality of the method .",
    "we devote appendix a to a detailed discussion about the connections between the present trajectory - based exact factorization approach and bohmian dynamics ; the point is to stress that despite both theories involve trajectories propagating on a time - dependent potential , the present theory is completely independent of the bohmian approach .",
    "the paper is organized as follows . a general introduction to the exact decomposition of electronic and nuclear motion",
    "is given in section  [ sec : background ] , followed by a discussion about gauge conditions .",
    "the model system is introduced in section  [ sec : model ] and its dynamics , both fully exact quantum and with the classical approximation for nuclei , are analyzed in section  [ sec : cl vs. qm ] , along with the averaged nuclear observables ( section  [ sec : observables ] ) . section  [ sec : gd potentials ] then focusses on the gauge - dependent contribution to the potential , analyzing its structure in the tdpes ( section  [ sec : gd ] ) , and then gauge - transforming it to a vector potential ( section  [ sec : a ] ) for a different perspective of its effect on the dynamics .",
    "section  [ sec : decoherence ] is devoted to the topic of decoherence . our conclusions and perspectives are summarized in section  [ sec : conclusions ] .",
    "the non - relativistic hamiltonian describing a system of interacting electrons and nuclei , in the absence of a time - dependent external field , is @xmath0 where @xmath1 is the nuclear kinetic energy operator and @xmath2 is the standard bo electronic hamiltonian , with electronic kinetic energy @xmath3 , and interaction potentials @xmath4 for electron - electron , @xmath5 for nucleus - nucleus , and @xmath6 for electron - nucleus .",
    "the symbols @xmath7 and @xmath8 are used to collectively indicate the coordinates of @xmath9 electrons and @xmath10 nuclei , respectively .",
    "it has been proved  @xcite , that the full time - dependent electron - nuclear wave function , @xmath11 , that is the solution of the tdse , @xmath12 can be exactly factorized to the correlated product @xmath13 where @xmath14 here @xmath15 is the nuclear wave function and @xmath16 is the electronic wave function which parametrically depends on the nuclear positions and satisfies the partial normalization condition ( pnc ) expressed in eq .",
    "( [ eq : pnc ] ) .",
    "the pnc guarantees the interpretation of @xmath17 as the probability of finding the nuclear configuration @xmath8 at time @xmath18 , and of @xmath19 itself as the conditional probability of finding the electronic configuration @xmath7 at time @xmath18 for nuclear configuration @xmath8 .",
    "further , the pnc makes the factorization  ( [ eqn : factorization ] ) unique up to within a @xmath20-dependent gauge transformation , @xmath21 where @xmath22 is some real function of the nuclear coordinates and time .",
    "the stationary variations  @xcite of the quantum mechanical action with respect to @xmath16 and @xmath15 lead to the derivation of the following equations of motion @xmath23 where the pnc is inserted by means of lagrange multipliers  @xcite . here",
    ", the electronic and nuclear hamiltonians are defined as @xmath24\\ ] ] and @xmath25 ^ 2}{2m_\\nu } + \\epsilon(\\dulr , t),\\ ] ] respectively , with `` electron - nuclear coupling operator '' @xmath26=\\sum_{\\nu=1}^{n_n}\\frac{1}{m_\\nu}\\left [   \\frac{\\left[-i\\hbar\\nabla_\\nu-\\ba_\\nu(\\dulr , t)\\right]^2}{2 } \\right.\\label{eqn : enco } \\\\ & \\left.+\\left(\\frac{-i\\hbar\\nabla_\\nu\\chi}{\\chi}+\\ba_\\nu(\\dulr , t)\\right )   \\left(-i\\hbar\\nabla_\\nu-\\ba_{\\nu}(\\dulr , t)\\right)\\right].\\nonumber\\end{aligned}\\ ] ] the potentials in the theory are the scalar tdpes , @xmath27 , implicitly defined by eq .",
    "( [ eqn : exact electronic eqn ] ) as @xmath28 and the time - dependent vector potential , @xmath29 , defined as @xmath30 the symbol @xmath31 indicates an integration over electronic coordinates only .",
    "the @xmath7-dependence of the electronic wave function is dropped only for formal consistency between the left - hand - side of eqs .",
    "( [ eqn : tdpes ] ) and  ( [ eqn : vector potential ] ) , that do not depend on @xmath7 , and the right - hand - side , where the @xmath7-dependence is integrated out .",
    "the electronic wave function itself remains a parametric function of @xmath8 and a function of @xmath32 . under the gauge transformation  ( [ eqn : gauge ] ) , the scalar potential and the vector potential transform as @xmath33 in eqs .",
    "( [ eqn : exact electronic eqn ] ) and  ( [ eqn : exact nuclear eqn ] ) , @xmath34 $ ] , @xmath27 and @xmath29 are responsible for the coupling between electrons and nuclei in a formally exact way .",
    "it is worth noting that the electron - nuclear coupling operator , @xmath35 $ ] , in the electronic equation  ( [ eqn : exact electronic eqn ] ) , depends on the nuclear wave function and acts on the parametric dependence of @xmath16 as a differential operator .",
    "this `` pseudo - operator '' includes the coupling to the nuclear subsystem beyond the parametric dependence in the bo hamiltonian @xmath36 .",
    "it is worth noting that the shape of tdpes at time @xmath18 depends on the choice of initial electronic state @xmath37 . here",
    ", we have chosen a bo electronic state as the initial electronic wave function to compare the tdpes with the standard picture of static bopess .",
    "the nuclear equation  ( [ eqn : exact nuclear eqn ] ) has the particularly appealing form of a schrdinger equation that contains a time - dependent vector potential  ( [ eqn : vector potential ] ) and a time - dependent scalar potential  ( [ eqn : tdpes ] ) that govern the nuclear dynamics and yield the nuclear wave function .",
    "these potentials are uniquely determined up to within the gauge transformation , given in eqs .",
    "( [ eqn : transformation of epsilon ] ) and  ( [ eqn : transformation of a ] ) .",
    "as expected , the nuclear hamiltonian in eq .",
    "( [ eqn : exact nuclear eqn ] ) is form - invariant under such transformations .",
    "@xmath15 is interpreted as the nuclear wave function since it leads to an @xmath38-body nuclear density , @xmath39 and an @xmath38-body current - density , @xmath40}{m_\\nu},\\ ] ] which reproduce the true nuclear @xmath38-body density and current - density  @xcite obtained from the full wave function @xmath11 .",
    "the uniqueness of @xmath27 and @xmath41 can be straightforwardly proved by following the steps of the current - density version  @xcite of the runge - gross theorem  @xcite , or by referring to the theorems proved in ref .",
    "@xcite .",
    "the results of any calculation do not depend on the choice of gauge in eqs .",
    "( [ eqn : gauge ] ) .",
    "the form of the tdpes and vector potential do depend on the choice , but together their effect on the dynamics , on all observables , electronic populations etc , is gauge - independent .",
    "it is instructive to decompose the tdpes into gauge - invariant ( gi ) and gauge - dependent ( gd ) constituents , @xmath42 where @xmath43 with the second term on the right - hand - side obtained from the action of the electron - nuclear coupling operator in eq .",
    "( [ eqn : enco ] ) on the electronic wave function , and @xmath44 the gi part of the tdpes , @xmath45 , is invariant under the gauge transformation  ( [ eqn : gauge ] ) : @xmath46 . the gd part , on the other hand , transforms as @xmath47 .    for purposes of our analysis ,",
    "to help understand the exact potentials in coupled electron - ion dynamics , and their comparison to traditional methods , we will find two gauges are particularly useful .",
    "first , we note that the model system we study is in 1d , so the vector potential can be gauged away . in general three - dimensional cases where the vector potential is curl - free , also the gauge may be chosen where the vector potential is zero @xmath48 . whether and under which conditions @xmath49 is , at the moment , under investigations  @xcite .",
    "the first gauge we will consider is one where the @xmath48 , and therefore the entire electronic back - reaction is contained in the tdpes . to determine this , consider first that the nuclear wave function is fully determined by its modulus and phase , according to @xmath50 .",
    "the condition @xmath51 on the modulus , automatically satisfies the request that the exact nuclear density calculated from @xmath52 can be also obtained directly from @xmath53 . on the other hand , from eqs .",
    "( [ eqn : gauge ] ) , we notice that the phase @xmath54 of the nuclear wave function is related to the choice of gauge .",
    "if we impose @xmath55 we find @xmath56 as we will now show .",
    "note that here we dropped the bold double - underlined symbols , in order to represent electronic and nuclear coordinates in 1d .",
    "henceforth , the old symbols will be used whenever our statements have general validity and the new symbols will be used for the 1d case only .",
    "it can be easily proved that eq .",
    "( [ eq : nphase ] ) results in a vector - potential - free gauge . to do this",
    ", we insert the factorization  ( [ eqn : factorization ] ) in the expression of the vector potential  ( [ eqn : vector potential ] ) , obtaining  @xcite a relation between the vector potential itself and the nuclear velocity field @xmath57 that in 1d reads @xmath58 .",
    "imposing here @xmath56 leads to eq .",
    "( [ eq : nphase ] ) , which defines the phase of the nuclear wave function .",
    "we then obtain the tdpes , @xmath27 from eq .",
    "( [ eqn : tdpes ] ) , by explicitly calculating the electronic wave function , @xmath59 . alternatively , we may invert the nuclear equation  ( [ eqn : exact nuclear eqn ] ) to find the tdpes .",
    "we have used this vector - potential - free gauge to perform the classical calculations .",
    "the tdpes alone determines the time evolution of @xmath15 and has both gi and gd components , eqs .",
    "( [ eqn : gi tdpes ] ) and  ( [ eqn : gd tdpes ] ) above . in section  [ sec : gd ] , we will discuss the characteristic features of @xmath45 and @xmath60 , with particular attention to the latter .",
    "the former has been extensively analyzed before  @xcite and the main results will be briefly recalled .    the second gauge which we will find instructive to study ( section  [ sec : a ] ) is one where we instead transform the gauge - dependent part of the tdpes , @xmath60 , into a vector potential . in some sense",
    ", this gauge makes a more direct comparison with the tsh methods , and we will see hints of `` velocity adjustment '' used in tsh , appearing in the exact vector potential .      a major theme of this work and the recent papers  @xcite is the relation of the exact tdpes to the bopess .",
    "therefore , we introduce here the bo electronic states , @xmath61 , and bopess , @xmath62 , which are the normalized eigenstates and eigenvalues of the bo electronic hamiltonian  ( [ eqn : boe ] ) , respectively .",
    "if the full wave function is expanded in this basis , @xmath63 then the nuclear density may be written as @xmath64 this relation is obtained by integrating the squared modulus of eq .",
    "( [ eqn : expansion of psi ] ) over the electronic coordinates . the exact electronic wave function",
    "may also be expanded in terms of the bo states , @xmath65 the expansion coefficients in eqs .",
    "( [ eqn : expansion of psi ] ) and  ( [ eqn : expansion of phi ] ) are related , @xmath66 by virtue of the factorization  ( [ eqn : factorization ] ) .",
    "the pnc then reads @xmath67 we point out that even in the case where the nuclear wave packet splits onto more than one bopes the full wave function is still a single product : the nuclear wave function has contributions ( projections ) on different bopes while the electronic wave function is a linear combination of different adiabatic states , but still we may write @xmath68 where the first term in parenthesis is @xmath15 , using eqs .",
    "( [ eq : nphase ] ) and  ( [ eqn : chi and fl ] ) , and the second term in parenthesis is @xmath16 , using eq .",
    "( [ eqn : expansion of phi ] ) . ref .",
    "@xcite provides a visualization of the electronic wave function .",
    "we study here the 1d shin - metiu model  @xcite for non - adiabatic electron transfer .",
    "the system consists of three ions and a single electron , as depicted in fig .",
    "[ fig : metiu model ] .    ) . @xmath69 and @xmath70 indicate the coordinates of the moving ion and electron , respectively , in one dimension .",
    "@xmath71 is the distance between the fixed ions . ]",
    "two ions are fixed at a distance of @xmath72  @xmath73 , the third ion and the electron are free to move in one dimension along the line joining the two fixed ions .",
    "the hamiltonian of this system reads @xmath74 here , the symbols @xmath7 and @xmath8 are replaced by @xmath70 and @xmath69 , the coordinates of the electron and the movable ion measured from the center of the two fixed ions .",
    "the ionic mass is chosen as @xmath75 , the proton mass , whereas the other parameters are tuned in order to make the system essentially a two - electronic - state model .",
    "we present here the results obtained by choosing @xmath76  @xmath73 , @xmath77  @xmath73 and @xmath78  @xmath73 such that the first bopes , @xmath79 , is strongly coupled to the second bopes , @xmath80 , around the avoided crossing at @xmath81 and there is a weak coupling to the rest of the surfaces .",
    "the bo surfaces are shown in fig .",
    "[ fig : bo ] ( left panel ) .",
    "the analysis developed in the following sections is very general and does not depend on the strength of the non - adiabatic coupling , similar to ref .",
    "we show here results from a strong - coupling set of parameters , and the conclusions we draw here extend also to the weaker - coupling case ( not shown ) .",
    "we study the time evolution of this system by choosing the initial wave function as the product of a real - valued normalized gaussian wave packet , centered at @xmath82  @xmath73 with variance @xmath83  @xmath73 ( thin black line in fig .",
    "[ fig : bo ] ) , and the second bo electronic state , @xmath84 . to obtain the tdpes , we first solve the tdse  ( [ eqn : tdse ] ) for the complete system , with hamiltonian  ( [ eqn : metiu - hamiltonian ] ) , and obtain the full wave function , @xmath85 .",
    "this is done by numerical integration of the tdse using the split - operator - technique  @xcite , with time step of @xmath86  fs ( or @xmath87  a.u . ) .",
    "afterwards , according to the procedure discussed in the previous section ( eqs .",
    "( [ eq : modchi])([eq : nphase ] ) ) , we uniquely determine the electronic and nuclear wave functions in the vector - potential - free gauge .    as an example , we show the evolution of the populations of the bo states in fig .",
    "[ fig : bo ] ( right panel ) .",
    "we generate classical trajectories by solving hamilton s equations in the gauge @xmath56 : @xmath88 using the velocity - verlet algorithm with the same time step as in the quantum propagation ( @xmath89  fs ) .",
    "it is worth noting that in an actual algorithm the use of such a small time step in not strictly required .",
    "as we will show later on , the main features of the tdpes , the steps , form quite smoothly as functions of time , therefore their appearance can be captured also with larger time steps .",
    "moreover , it is worth stressing here , that while @xmath90 and @xmath91 separately have steps , their sum , @xmath92 , is very smooth and capturing its shape within a ( fully approximate ) numerical scheme will not represent an issue .    in eq .",
    "( [ eqn : hamilton eom ] ) , the energy @xmath93 is chosen either to be the full tdpes , @xmath94 , or the gi part only of the tdpes , @xmath90 .",
    "we will compare the effect of the resulting dynamics from each .",
    "the reason behind this comparison is the feature of the gi part of the tdpes observed in ref .",
    "@xcite : @xmath90 contains steps that connect its different pieces that are on top of different bopess in different slices of r space .",
    "this feature from a quasi - classical point of view is reminiscent of the jumps that classical trajectories undergo in tsh . in both cases ,",
    "the nuclear force is calculated according to different bopess depending on the position of the classical trajectory .",
    "therefore , the question may arise as whether @xmath90 alone contains enough information to split the trajectories in two branches , as tsh would do .",
    "moreover , the shape of the gi part of the potential is not affected by the gd part outside the step region , thus the force in the asymptotic regions is given by the slope of the gi part .",
    "thus , one may ask how the energy step in @xmath91 affects the trajectories .",
    "such questions are addressed by evolving classical trajectories on both @xmath90 and @xmath92 .",
    "a set of 2000 trajectories is propagated according to eqs .",
    "( [ eqn : hamilton eom ] ) , where the initial conditions are sampled from the wigner phase - space distribution corresponding to @xmath95 .",
    "the nuclear density at later times is reconstructed from the distribution of the classical positions and the good agreement with quantum calculations ( as shown below ) confirms that the number of trajectories is sufficient to extract reliable approximate results .",
    "first we qualitatively analyze the gi and gd components of the tdpes , in connection to the features of the nuclear density .",
    "[ fig : tdpes strong ] shows some snapshots of the potentials , @xmath90 and @xmath91 ( upper panels ) , and of the nuclear density , @xmath96 , along with its bo - projected components , @xmath97 and @xmath98 , ( lower panels ) .",
    "the times , as indicated in the figure , are @xmath99  fs .",
    "the two lowest bo surfaces are shown for reference as solid black lines .",
    "lower panels : the nuclear density @xmath96 ( solid black line ) , and bo - projected densities @xmath97 ( dashed green line ) , @xmath98 ( dashed orange ) . ]    at times @xmath100  fs , the nuclear wave packet evolves on the exact potential that either is equivalent to the second adiabatic surface , on the left of the avoided crossing , or has a diabatic - like behavior , smoothly connecting the two bo surfaces through the avoided crossing . at these times , @xmath91 is a constant function of @xmath69 and it only produces a physically irrelevant rigid shift of @xmath90 that has no effect on the dynamics and could be set to zero .",
    "after the nuclear density branches on to the two surfaces at the avoided crossing ( times @xmath101  fs of fig .",
    "[ fig : tdpes strong ] ) , both terms of the tdpes develop steps .",
    "the gi surface @xmath45 lies on one bo surface or the other , with steps connecting smoothly between the two .",
    "the gd part @xmath60 is piecewise constant in @xmath69 space , affecting the dynamics only in the intermediate region where the step joins the two pieces .",
    "the steps in @xmath45 and @xmath60 appear in the same region and seem to have a similar slope but with opposite sign .",
    "still , the step in @xmath91 does not exactly cancel the step in @xmath90 ( see section  [ sec : gd ] ) and the resulting full tdpes presents a small `` bump '' in this region .",
    "it was shown in refs .",
    "@xcite that the steps in the gi and gd parts appear at the cross - over point , @xmath102 , between @xmath97 and @xmath98 .",
    "we will use this symbol @xmath102 from now on to indicate the center of the step region .",
    "the two branches of the nuclear wave packet undergo different dynamics because of the different slopes of the ( gi part of ) the tdpes under each branch , one being parallel to one bopes and the other parallel to the other , while the extent of the splitting critically depends on the combined effect of the two steps in the gi and gd parts of the exact tdpes , as we will shortly show .",
    "knowing the tdpes allows us to directly test the accuracy of a classical treatment of the nuclei by reconstructing the nuclear dynamics using classical trajectories . by evolving an ensemble of multiple trajectories on the exact tdpes , with a distribution taken from the exact initial nuclear wave packet ( see discussion below eq .",
    "( [ eqn : hamilton eom ] ) ) , we take into account the quantum uncertainty principle in the initial conditions , so the effect of the classical approximation for the dynamics can be tested by itself , and independently of the approximation used for the nuclear forces .",
    "further , we can study the impact of the step structure itself by comparing classical dynamics evolving on @xmath90 and on @xmath92 .",
    "the difference between these two potentials , i.e. @xmath91 , is piecewise constant in @xmath69 .",
    "therefore , its shape does not alter the force calculated from @xmath90 in the regions away from the step , where @xmath90 is equal to one or the other bo surface .    in fig .",
    "[ fig : nuclear densities strong ] the nuclear densities are approximated with histograms constructed from the distributions of classical positions evolving on @xmath90 and on the full tdpes .",
    "the histograms are represented as blue and red linepoints , respectively , and are compared to the exact nuclear density ( solid black lines ) .",
    "fs , as in fig .",
    "[ fig : tdpes strong ] .",
    "the red curves represent the density obtained by propagating classical trajectories on the full tdpes and the blue curves are the results of the propagation on the gi part of the tdpes . for reference ,",
    "the exact nuclear densities are plotted as black lines . ]    evolving on the gi part of the tdpes yields some effect of splitting , but the distribution obtained from the propagation of classical trajectories presents an intense peak localized in the region occupied by the wave packet propagating on the lower surface , with very little density on the left of @xmath102 .",
    "this is clearly not correct , and can be explained from considering the effect of the step in @xmath90 : the classical trajectories `` slide down '' the step that `` opens '' towards the lowest bo surface ( see snapshots at times @xmath103  fs and @xmath104  fs in fig .",
    "[ fig : tdpes strong ] ) , so leaking the density away from the left to the right .",
    "the propagation of classical trajectories on the full tdpes confirms the importance of the gd component of the exact potential , as already suggested in ref .",
    "@xcite . in fig .",
    "[ fig : nuclear densities strong ] , the results from the classical propagation on the exact full tdpes are in excellent agreement with exact fully quantum results , both before and after the splitting of the nuclear wave packet .",
    "this confirms that the splitting of the nuclear wave packet can be captured perfectly with treating the nuclei as classical particles , provided the force on the nuclei is the right one .",
    "the steps in both components of the tdpes , yielding a surface with a resultant `` bump '' , should be correctly reproduced for an accurate description .",
    "the step features in the exact tdpes have been observed in previous work  @xcite but what is new here is that quasiclassical evolution on the exact tdpes correctly captures the splitting of the nuclear wave packet and that the balance between the steps in both the gi and gd part is critical to capture the correct dynamics .",
    "our results are based on the fact that we know , for the simple model of non - adiabatic charge transfer discussed here , the exact potential that governs the nuclear dynamics . therefore , we are able to compute the `` exact '' classical force .",
    "it is crucial for approximations to be able to account for the steps in both @xmath45 and @xmath60 , that we proved to be responsible for the correct splitting of the nuclear wave packet and ensuing dynamics .",
    "we stress once again that the procedure presented so far is not analogous to bohmian dynamics , as discussed in appendix  [ app : bohmian traj ] .",
    "when bohmian trajectories are used to mimic the quantum mechanical evolution of a wave function , an extra contribution , the so - called quantum potential , appears as a time - dependent correction to the standard interaction term , e.g. the coulomb interaction , in the hamiltonian .",
    "the results shown in fig .  [ fig : nuclear densities strong ] are , instead , obtained by only employing the tdpes , without including extra correction terms .",
    "the tdpes is the bare potential in the quantum hamiltonian  ( [ eqn : nuclear hamiltonian ] ) and the tdpes is used to calculate classical forces .",
    "no additional terms are considered .",
    "therefore , it is not a priori obvious that the classical treatment of nuclear motion is a good approximation even if the tdpes is exact .",
    "here we calculate some nuclear observables to demonstrate that measurable quantities can be predicted by evolving classical trajectories under the correct force , i.e. that provided by the exact tdpes .",
    "the observable will be evaluated employing the standard expression @xmath105 when multiple trajectories ( mts ) represent the evolution of the nuclear density .",
    "the total number of trajectories is @xmath106 , @xmath107 is the value of the observable along the @xmath108-th trajectory at time @xmath18 and @xmath109 is the instantaneous average at time @xmath18",
    ". we will compare eq .",
    "( [ eqn : average of observables ] ) with the value of the same observable calculated along a single trajectory ( st ) , whose initial position and momentum are the mean position and momentum of the quantum wave packet and whose evolution is generated according to the force from the tdpes . as already discussed in ref .",
    "@xcite , a st can not capture the spatial splitting of the nuclear density , but can still give information about the observables .",
    "[ fig : observables ] ( left panels ) shows the mean values of the nuclear position ( upper panel ) and momentum ( lower panel ) calculated according to eq .",
    "( [ eqn : average of observables ] ) for the mt scheme ( dashed green lines ) , compared to the st ( dotted red lines ) and exact calculations ( continuous black lines ) . the st results are not bad , but mt enables an almost perfect agreement with the exact for both the position and momentum variables .",
    "this is not surprising given the results presented above .",
    "the spatial extension of the nuclear density is accounted for , in an approximated way , in the mt approach and corrects ( or washes out ) the deviations from st calculations .",
    "( right , lower panel ) .",
    "the black curves represent the quantum mechanical values of the observables . ]",
    "it is instructive to also show the comparison between the nuclear kinetic energy calculated from the full wave function and the corresponding observable estimated from the approximate dynamics .",
    "first , we note that , as discussed in ref .",
    "@xcite , when the factorization  ( [ eqn : factorization ] ) is used in the expression for the expectation value @xmath110 of the nuclear kinetic energy operator at time @xmath18 @xmath111 the following expression is obtained @xmath112 ^ 2}{2m_\\nu } \\chi(\\dulr , t ) \\nonumber\\\\ -&\\int d\\dulr\\ , \\left|\\chi(\\dulr , t)\\right|^2\\sum_{\\nu=1}^{n_n}\\frac{\\hbar^2}{2m_\\nu}\\left\\langle\\nabla_\\nu\\phi_\\dulr(t)\\right|\\left.\\nabla_\\nu\\phi_\\dulr(t)\\right\\rangle_\\dulr\\nonumber \\\\",
    "-&\\int d\\dulr\\ , \\left|\\chi(\\dulr , t)\\right|^2\\sum_{\\nu=1}^{n_n }   \\frac{\\ba_\\nu^2(\\dulr , t)}{2m_\\nu}.\\end{aligned}\\ ] ] in the gauge where @xmath56 only two terms survive , namely @xmath113.\\nonumber\\end{aligned}\\ ] ] in our quasiclassical simulation , this expression is estimated by considering @xmath114 in eq .",
    "( [ eqn : average of observables ] ) , with the first term the `` bare '' nuclear kinetic energy associated to the @xmath108-th trajectory at time @xmath18 and the second term the value of the function @xmath115 evaluated at the classical position @xmath116 along the @xmath108-th trajectory at time @xmath18 . fig .",
    "[ fig : observables ] ( right , upper panel ) shows once again that the results from the propagation of mts on the tdpes perfectly reproduce the quantum expectation value , whereas large deviations are observed for the st calculation . the kinetic energy contribution due to the term @xmath117 , plotted in fig .  [",
    "fig : observables ] ( right , lower panel ) , is a small fraction of the total kinetic energy , and also is well - approximated by the mt result .",
    "an important result of the previous section is that , while yielding a zero force in most regions of space , the force from the gd part of the tdpes is essential to include , due to its step feature , in order to obtain correct dynamics",
    "@xcite explained why the slope of the gi part of the tdpes far from the step tracks that of one or the other bo surface , as well as how the slope in the step region is related to the slope in the coefficients as they switch from one surface to the other .",
    "moreover , characteristic features of the formation and structure of the steps in the gi part of the tdpes were identified . in particular , the steps appear in the region around the crossing point @xmath102 , which is where the moduli of the two coefficients of the expansions of @xmath85 ( and @xmath118 ) on bo states have the same value , @xmath119 , and @xmath120 .",
    "but what about the step - feature in @xmath60 ?",
    "the previous section showed the height of the step in the gd part of the tdpes must be properly accounted for in order to obtain a quantitative good estimate of the splitting , so it is important to characterize its structure as well . in the following subsections ,",
    "we estimate the energy difference the step - feature in the gd term represents , and we look at its effect in terms of velocity - adjustments in comparison to tsh .",
    "we observed earlier that steps in the gd part appear at the same position as in the gi term , but have the opposite direction",
    ". a `` bump '' then results upon adding the gi and gd term to form the full tdpes",
    ". the heights of the steps in these two components of the tdpes are similar but do not quite cancel each other .",
    "we show here why the step in @xmath60 almost compensates the step in @xmath45 .",
    "first , we prove that @xmath91 has a characteristic sigmoid shape resembling an error - function .",
    "this feature is not a result obtained for the particular system studied here or for the particular set of parameters in the hamiltonian  ( [ eqn : metiu - hamiltonian ] ) , but it is rather general in the absence of an external time - dependent field .",
    "we begin by writing the gauge condition @xmath56 , in terms of the two relevant bo states from eqs .",
    "( [ eqn : vector potential ] ) and  ( [ eqn : expansion of phi ] ) @xmath121 where the symbol @xmath122 has been used to indicate the phase of the coefficient @xmath123 of the electronic wave function ( eq .  ( [ eqn : expansion of phi ] ) ) and @xmath124 indicates the non - adiabatic coupling vectors ( nacvs ) in 1d .",
    "the second term on the right - hand - side is identically zero , due to the pnc in eq .",
    "( [ eqn : pnc on bo ] ) , while the third term can be neglected in the region far from the avoided crossing where the nacvs are negligible .",
    "this is the region we are interested in , since @xmath91 is different from a constant function only after the passage of the nuclear wave packet through the avoided crossing .",
    "the remaining term gives @xmath125 which means @xmath126 @xmath127 where @xmath128 while @xmath129 .",
    "similarly , @xmath130 @xmath127 where @xmath131 while @xmath132 .",
    "we conclude @xmath133 , namely the phase of the coefficient @xmath123 is only a function of time ( constant in space ) , in the region where the squared modulus of the corresponding coefficient is equal to unity .",
    "plotted as red line at some time steps after the nuclear wave packet has crossed the non - adiabatic coupling region .",
    "the fitting function in eq .",
    "( [ eqn : fitting function ] ) is shown as black dashed line .",
    "lower panels : @xmath134 for @xmath135 ( green lines ) and @xmath136 ( orange lines ) at the same time steps , with the fitting function shown again as dashed black line .",
    "the fitting parameters @xmath137 and @xmath138 from eq .",
    "( [ eqn : fitting function ] ) are indicated in the upper and lower panels . ]",
    "we confirm this by showing in fig .",
    "[ fig : coefficients and gd ] ( lower panels ) some snapshots of the functions @xmath139 and @xmath140 . in the regions where one of the two coefficients is equal to 1 , the other is 0 .",
    "this means that the electronic wave function has `` collapsed '' onto one adiabatic state , that whose coefficient is non - zero .",
    "( [ eqn : expansion of phi ] ) can then be written as @xmath141 meaning that @xmath118 has a purely adiabatic character for @xmath69 where @xmath134 s are either zero or one , while a linear combination of adiabatic states in the region in between .",
    "the sigmoid - shape of @xmath91 then follows by using eq .",
    "( [ eqn : gd tdpes ] ) , @xmath142 numerical results are shown at different time steps in fig .",
    "[ fig : coefficients and gd ] ( upper panels ) .",
    "the `` collapse '' of the electronic wave function on one or the other adiabatic state is a smooth and continuous process that can be observed in time by looking either at the step formation in the gi ( and gd ) part of the tdpes , for instance in fig .",
    "[ fig : tdpes strong ] , or at the step formation in @xmath134 ( with @xmath143 ) , in fig .  [ fig : coefficients and gd ] .    both @xmath91 and @xmath134 can be fitted via a function @xmath144 of the form @xmath145,\\ ] ] where the time - dependent parameters @xmath146 and @xmath138 are determined by the fitting procedure .",
    "[ fig : coefficients and gd ] shows as thin dashed black line the analytic function eq .",
    "( [ eqn : fitting function ] ) and the values of the parameters indicating the slope of the step , @xmath137 , and the position of the step , @xmath138 . in the lower panels we need only to fit @xmath139 , since due to the pnc , @xmath147 .",
    "we observe that the values of the fitting parameters are very similar for @xmath134 and @xmath91 , meaning that the step in @xmath91 has the same spatial - dependence as that of @xmath134 . in the case of @xmath139",
    "the remaining two parameters , @xmath148 , as expected . in the case of @xmath91",
    ", we analytically derive in the appendix that @xmath149 \\,e^{-\\alpha^2(t)(r - r_0(t))^2},\\label{eqn : leading term bis}\\end{aligned}\\ ] ] while we do not consider @xmath150 since it is only a uniform potential , that has no physical effect on the dynamics . here , the integral is computed with boundaries @xmath151 and we used the property that @xmath139 has an error - function shape in order to analytically determine its spatial derivative as a gaussian .",
    "numerical results are shown in fig .",
    "[ fig : gd height ] , where we compare the value of the height obtained from the fit of @xmath60 via the error - function in eq .",
    "( [ eqn : fitting function ] ) and from eq .",
    "( [ eqn : leading term bis ] ) .     estimated from eq .",
    "( [ eqn : leading term bis ] ) ( red ) and the value calculated from the fitting ( black ) with an error - function . ]    fig .",
    "[ fig : gd height ] shows that the results of our estimate are in good agreement with the fit .    in summary ,",
    "we have explained why @xmath60 is piecewise constant , with a sigmoid structure whose height is an average of the difference between the bo energies weighted by a gaussian centered in the step region , eq .",
    "( [ eqn : leading term bis ] ) . this explains ( i ) why the step in @xmath91 almost compensates the energy difference in @xmath90 and ( ii ) why the slope in the gd part of the tdpes has the opposite sign with respect to the gi part .",
    "the analysis in the previous sections shows that the gd component of the tdpes , @xmath60 , does not affect the force that evolves the classical trajectories on either side of the step ( it is constant in these regions ) .",
    "however , it diminishes the energy separation in @xmath45 between the two sides .",
    "this energy barrier almost disappears in the full tdpes .",
    "however , the tdpes is gauge - dependent , and the question arises as to how does this reduction of the energy difference that we see in @xmath60 appear in other gauges ?",
    "in particular , going to a gauge where @xmath152 means that the non - zero vector potential must compensate the effect of the energy step in the gi part of the tdpes . we will analyze this effect in this section .",
    "the gauge @xmath152 offers an interesting point of view , giving perhaps a more direct interpretation of the tsh scheme in terms of the exact tdpes and vector potential .",
    "in tsh , the force that produces the nuclear evolution is given by the gradient of one of the bopess , and the classical particles evolve adiabatically on the bo surfaces before and after the stochastic jumps take place . in our exact formulation in this gauge , a large component of the classical force driving the nuclear motion is given by the gi part of the exact tdpes , which reduces to the gradient of either one or the other adiabatic surface away from the step region , similar to tsh .",
    "but there is also a component to the force from the time - dependent vector potential .",
    "this appears as a momentum correction , whose effect and interpretation in the perspective of tsh will be shown below .",
    "we apply the gauge - function @xmath153 ( see eqs .",
    "( [ eqn : gauge ] ) ,  ( [ eqn : transformation of epsilon ] ) and  ( [ eqn : transformation of a ] ) ) on the wave functions and potentials of the previous sections , such that in the new gauge , @xmath154 equivalently , @xmath155 from eq .",
    "( [ eqn : transformation of a ] ) , noting that in the previous gauge @xmath156 , @xmath157 that is , the vector potential in the gauge where it absorbs all the gauge - dependence , is the time integral of the force generated by the gd part of the tdpes in the gauge where the vector potential is zero .",
    "the vector potential contributes a term to the nuclear momentum density , that is induced by the coupling to the electrons : @xmath158 where @xmath159 is the phase of the nuclear wave function in the present gauge .",
    "note that the total averaged momentum is the integral of the total current density : @xmath160 , plotted in fig .",
    "[ fig : momentum corrections ] .",
    "fs , to the total nuclear momentum density from the terms @xmath161 ( black line ) and @xmath162 ( blue line ) , from eq .",
    "( [ eqn : p and a ] ) , weighted by the nuclear density .",
    "the dashed - red line represents the term on the left - hand - side in eq .",
    "( [ eqn : p and a ] ) , weighted by the nuclear density . ]    both contributions , @xmath163 and @xmath164 , weighted by the nuclear density , are shown in fig .",
    "[ fig : momentum corrections ] as the black and blue lines . examining alongside @xmath45 shown in fig .",
    "[ fig : tdpes strong ] , we observe that the vector potential lowers the momentum and kinetic energy in the region where the nuclear wave packet evolves on the upper surface .    in tsh different adiabatic surfaces are energetically accessible by the classical nuclei because of the stochastic jumps and the subsequent momentum rescaling : when a jump occurs in the direction of increasing potential energy , e.g. from state 1 to state 2 in our example , the velocity of the classical particle is reduced by the amount determined by imposing energy conservation , along the direction of the nacv between the states involved in the transition . in our scheme based on the exact tdpes , we see a similar effect in two different ways depending on the gauge : either the gd part of the potential is responsible for bringing `` energetically closer '' different bopes , or the vector potential provides the necessary kinetic energy contribution . from the observations reported in the present section",
    ", the vector potential contributes to the nuclear momentum as a reduction of the propagation velocity of the trajectories on the upper surface , with respect to the trajectories on the lower surface .",
    "this is reminiscent of the momentum adjustment in tsh , when the classical particles undergo a non - adiabatic jump from one bo surface to the other .",
    "an interesting development of these qualitative observations would be the analysis , in higher dimensions , of the direction of the momentum adjustment due to the vector potential , in comparison to the direction chosen in the tsh approach , i.e. the direction of the nacvs .",
    "this line of investigation , along with a more quantitative understanding of the connection between the time - dependent vector potential and the velocity corrections in the tsh scheme is currently under investigation .",
    "a consequence of the steps in the gi and gd components of the tdpes is that they allow the nuclear wave packet to feel forces from different bopess in different regions of space at the same instant in time .",
    "this feature signals electronic decoherence .",
    "although tsh shares the feature that wave packets evolving in different spatial regions on different surfaces experience different forces , it does not capture the electronic decoherence that should come hand - in - hand .",
    "there has been extensive and on - going developments to build decoherence into tsh  @xcite but it remains a challenging problem today .",
    "we now ask what we can learn about decoherence from the exact tdpes in relation to tsh .",
    "we will find that the concerted action of the step features in @xmath45 and @xmath60 results in decoherence .",
    "consider the force produced by the gd part of the potential .",
    "the force is a gauge - independent quantity , therefore does not depend on the choice of the gauge . in a gauge where there is zero vector potential ,",
    "the classical nuclear force is the sum of two contributions , @xmath165 where the second term on the right - hand - side can be also written as @xmath166 in the gauge where the entire gd term has been transformed to a vector potential , eq .",
    "( [ eqn : a from gd ] ) . the results shown in fig .",
    "[ fig : coefficients and gd ] for @xmath91 clearly indicate that eq .",
    "( [ eqn : force from a ] ) either is zero or has a gaussian - like shape , since @xmath91 either is constant or has the characteristic sigmoid shape reminiscent of an error - function .",
    "we now consider single trajectories generated according to the fewest - switches algorithm , on one hand , and the trajectories evolving on the tdpes , on the other hand .",
    "we distinguish two classes of trajectories : ( i ) those that in tsh do not hop , thus always propagating on the upper bo surface @xmath167 and ( ii ) those that undergo a single hop , whose evolution after the passage through the avoided crossing takes place along the lower surface @xmath168 . in this analysis",
    "we do not look at all other trajectories , undergoing two or more hops .",
    "-axis and position on @xmath169-axis ) from tsh ( red line ) and from the trajectory on the tdpes ( blue line ) .",
    "lower left panel : the gi - force ( continuous black line ) , the gd - force ( dashed black line ) and their sum ( dashed green line ) , determined by evaluating eqs .",
    "( [ eqn : classical force ] ) and  ( [ eqn : force from a ] ) at the instantaneous position .",
    "lower right panel : squared moduli of the off - diagonal elements of the electronic density matrix @xmath170 , evaluated at the classical positions ( dashed orange lines ) , compared to the corresponding quantity @xmath171 ( black lines ) calculated along the tsh trajectory .",
    "the vertical and horizontal dashed black lines highlight the regions of time and space , respectively , where the effect of the vector potential on the classical trajectory is not zero .",
    "the values associated to these regions are also reported in the plots . ]",
    "we have identified a typical trajectory from each of these classes and matched each up with a classical trajectory evolving on the exact tdpes , that has almost identical initial momentum and position and that either `` ends up '' on the upper surface ( class ( i ) ) or slides over to the lower bo surface ( class ( ii ) ) . since tsh is a stochastic scheme , identical trajectories are difficult to find .",
    "nevertheless , this comparison allows us to classify also the trajectories on the tdpes as class ( i ) or ( ii ) .",
    "these pairs of trajectories are plotted in the upper left panel of figs .",
    "[ fig : strong upper ] ( class ( i ) ) and  [ fig : strong lower ] ( class ( ii ) ) .",
    "these panels verify the similarity of the tsh ( red lines ) and tdpes ( dashed blue lines ) trajectories of each pair .",
    "the other panels represent : ( upper right ) the phase space from tsh and the tdpes ( in this case the momentum is shown on the @xmath172-axis and the position on the @xmath169-axis ) ; ( lower left ) the force from the first term on the right - hand - side of eq .",
    "( [ eqn : classical force ] ) , in the following referred to as gi - force , ( continuous black line ) , the force in eq .",
    "( [ eqn : force from a ] ) , referred to as gd - force , and their sum ( dashed green line ) , determined by evaluating eqs .",
    "( [ eqn : classical force ] ) and  ( [ eqn : force from a ] ) at each time at the classical position along the trajectory propagating on the tdpes ; ( lower right ) the squared moduli of the off - diagonal elements of the electronic density matrix @xmath170 , evaluated at the classical positions ( dashed orange lines ) , as the force in the lower left panel , compared to the corresponding quantity @xmath171 ( black lines ) calculated along the single tsh trajectory shown in the upper - left panels .",
    "but for the trajectory of class ( ii ) . ]    with the classification of the trajectories in mind , we compare the phase space of the trajectories associated to the upper and to the lower surfaces . clearly , for a trajectory in class ( ii ) , the momentum calculated according to tsh will show a discontinuous behavior in the vicinity of the avoided crossing , because it undergoes a hop from @xmath167 to @xmath168 , while the trajectory propagating on the tdpes continues to evolve smoothly .",
    "this is indeed verified in the upper right panel of fig .",
    "[ fig : strong lower ] where the `` kink '' in the red curve near @xmath173  @xmath73 indicates a momentum jump occuring at the corresponding surface hop",
    ". however , after passing through this region , the curves are once again very close to each other .",
    "this suggests that the _ time - integrated _ effects of the forces from the tsh surface - hop and the exact vector potential on the classical trajectory are approximately the same , although their nature is rather different .",
    "both the tsh trajectory and the tdpes trajectory begin evolving under the force from the upper bo surface , but , due to the velocity adjustment , the tsh trajectory experiences an instantaneous @xmath174-function - like force when it hops between the surfaces .",
    "we can interpret this force as arising from a vector potential that turns on sharply at the avoided crossing .",
    "the force on the tdpes trajectory , on the other hand , is always smooth . in the lower left panels of figs .",
    "[ fig : strong upper ] and  [ fig : strong lower ] we observe a peculiar behavior of the classical force in the region within the two dashed vertical lines : outside this region , the gd - force is zero , suggesting that classical dynamics is completely governed by one or the other bopes ; within the region , the effect of the steps in @xmath45 and @xmath60 ( or the appearance of the vector potential according to eq .",
    "( [ eqn : force from a ] ) ) is clearly indicated by the peaks .",
    "the time intervals indicated by the vertical dashed black lines in figs .  [ fig : strong upper ] and  [ fig : strong lower ] give an estimate of the time during which the gd - force has a non - zero effect on the classical trajectory .",
    "the forces in tsh coincide with those of the tdpes only outside these time intervals .",
    "one can see that such intervals coincide with space regions where the phase space from tsh calculations and resulting from the trajectories evolving on the tdpes are qualitatively different .",
    "these regions are indicated by the horizontal dashed black lines .",
    "this time window during the gradual onset and offset of the gd - force infinitely reduces when interpreted in the light of tsh .",
    "although this difference has little net effect on the classical dynamics after the transition region ( the two trajectories end up matching up again ) , it has a profound influence on the electronic amplitudes associated with these trajectories , as we will now argue .",
    "the major consequence of the appearance of the peaks in the gi - force and the gd - force on the tdpes - evolved trajectory , and the associated structure in @xmath175 in the electronic equation , is to induce decoherence , an effect that the instantaneous action of the force on the tsh - evolved trajectory does not capture properly . from a quantum mechanical point of view",
    ", we expect to observe decoherence when the components of the nuclear wave packet associated to different bo states evolve independently from each other on the two adiabatic surfaces . in the mixed quantum - classical picture provided by the classical trajectories propagating on the tdpes , decoherence is correctly observed . in order to quantify this statement ,",
    "we employ , as indicator of decoherence , the off - diagonal elements of the electronic density matrix , i.e. @xmath176 ( dashed orange lines ) in the lower right panels of figs .",
    "[ fig : strong upper ] and  [ fig : strong lower ] . the coefficients @xmath177 with @xmath178 , from the expansion of the electronic wave function on the adiabatic basis , are functions of position and time , and in the expression of @xmath179 they are evaluated at each time at the classical positions along the trajectory @xmath180 . the elements of the density matrix @xmath179 are compared with the corresponding quantity calculated along a given tsh trajectory ( black lines in the lower right panels of figs .  [",
    "fig : strong upper ] and  [ fig : strong lower ] ) , i.e. @xmath181 .    in the same time intervals indicated by the vertical lines in the lower left panels , @xmath179 decays to 0 .",
    "these time intervals , and the corresponding regions of space , can be associated to the decay of the coherences ( @xmath182 ) .",
    "now if we compare these matrix elements with those calculated along a given trajectory according to the tsh scheme , the decay to 0 is clearly absent .",
    "after the transition through the coupling region , tsh predicts for all trajectories approximately the same values of @xmath181 , which , being different from zero , imply a spurious coherence .",
    "since the velocity adjustment in tsh is analogous to the action of an instantaneous vector potential ( or an infinitely steep step in the tdpes ) , decoherence is not induced after the nuclear wave packet , i.e. the trajectory - bundle , crosses the coupling region . the gd - force and",
    "its combined effect with the gi - force can be used to estimate a decoherence time and length and to provide corrections to the problems of tsh . further analysis in this direction",
    "will be investigated .",
    "this work shows the _ best _ results that can be obtained when an ( independent ) trajectory - based mixed quantum - classical procedure is used to simulate the coupled non - adiabatic dynamics of electrons and nuclei . here ,",
    "the electronic effect on the classical nuclei is not approximated , but it is treated exactly by employing the tdpes and the time - dependent vector potential defined in the framework of the exact factorization of the electron - nuclear wave function of refs .",
    "a quasiclassical treatment of nuclear dynamics is sufficient to accurately capture the true quantum dynamics , in particular the splitting of the nuclear wave packet .",
    "critical step and bump features of the exact tdpes are responsible for the correct dynamics , and these were analysed in detail .    envisaging the development of a mixed quantum - classical algorithm from the analysis reported here , we observe that reproducing the step feature in the gi and gd components of the tdpes is crucial to correctly reproduce the splitting of a nuclear wave packet created by an avoided crossing .",
    "in particular , after passage through the avoided crossing , the correct dynamics of the different branches of the nuclear wave packet are caused by the deformation of the full time - dependent potential , that ( i ) becomes parallel to one or the other bo surface in different regions and ( ii ) develops a small bump in the intermediate region .",
    "a detailed analysis of the shape of the gd component was given here , while earlier work had focussed on the gi component  @xcite .",
    "in particular , we explained why the shape is a sigmoid , and why the step in the gd component largely cancels that in the gi component .",
    "the effect of the gd part of the tdpes was analyzed also under a different perspective , by pointing out the qualitative connection with the _ momentum adjustment _ in the tsh procedure . with a suitable change of the gauge ,",
    "i.e. @xmath152 , the time - dependent vector potential appears as a kinetic contribution in the nuclear hamiltonian and its effect is reminiscent of the velocity rescaling of tsh .",
    "we have also discussed the role of the steps in the two components of the tdpes for the correct account of decoherence .",
    "the steps indicate that both the gi - force and gd - force develop a peak , giving a time - interval corresponding to the typical time for the decay of coherences .",
    "these peaks , or equally the steps in the potentials , are essential to reproduce electronic decoherence .",
    "future work will further highlight differences and analogies to existing procedures .",
    "for instance , the decoherence force proposed in the decay - of - mixing method by truhlar and co - workers  @xcite seems to play a similar role as the force ( the peaks in the gi - force and in the gd - force ) arising during the decoherence time window . also , like dynamics on the exact tdpes , the non - adiabatic dynamics scheme based on the meyer - miller - stock - thoss ( mmst ) hamiltonian  @xcite also has classical trajectories evolving on just one potential , and it was shown that when these ehrenfest trajectories are treated semiclassically , including phase information , then wave packet splitting can occur  @xcite .",
    "comparisons of mixed quantum - classical schemes based on the exact factorization and methods such as these will lead to more insight into electron - nuclear correlation .    at longer times ,",
    "not studied here , when multiple passes through avoided crossing regions and reflections become important , the quasiclassical approach is expected to become poor .",
    "however , what our work here demonstrates is that it certainly is able to fundamentally capture the non - adiabatic charge transfer event . a modified approach , based again on an ensemble of classical trajectories but now incorporating phases , such as in the semiclassical dynamics approaches of refs .",
    "@xcite , could prove to be a promising approach in such cases , and is an avenue for further research .",
    "the observations that we have reported here establish the basis for interpreting existing approximated methods that deal with the problem of coupled electron - nuclear dynamics and for understanding how their deficiencies can be cured .",
    "furthermore , our work leads to new insights into the physics of electronic non - adiabatic processes and may lead to the design of new mixed quantum - classical algorithms  @xcite that satisfy exact requirements .",
    "partial support from the deutsche forschungsgemeinschaft ( sfb 762 ) and from the european commission ( fp7-nmp - cronos ) and the us department of energy office of basic energy sciences , division of chemical sciences , geosciences and biosciences under award de- sc0008623 is gratefully acknowledged .",
    "we devote this appendix to a brief overview of the bohmian approach  @xcite to quantum dynamics . even though this procedure might seem somehow connected to the work presented in the paper , as it is based on the propagation of trajectories on a time - dependent potential",
    ", it will become clear here that this is not the case .",
    "also , let us discuss only the adiabatic case , since the non - adiabatic version of bohmian dynamics , recently proposed by tavernelli and co - workers  @xcite , is based on the born - huang expansion of @xmath11 and it is used the evolve the coefficients of this expansion rather than the wave function .",
    "the state of the system is described by the wave function @xmath15 , that evolves according to the tdse @xmath183 with hamiltonian @xmath184 containing a kinetic energy term and a potential term @xmath185 , e.g. the ( static ) coulomb interaction among particles . for the moment ,",
    "no relation between @xmath15 in eq .",
    "( [ eqn : tdse for chi ] ) and the nuclear wave function of eq .",
    "( [ eqn : factorization ] ) is assumed .",
    "we write @xmath15 in polar form , defining its phase @xmath54 and amplitude @xmath186 , both real functions of @xmath187 .",
    "starting from the tdse  ( [ eqn : tdse for chi ] ) and separating the real and imaginary part , two coupled equations are obtained , namely @xmath188 ^ 2}{2m_\\nu } + \\tilde{v}(\\dulr , t ) \\label{eqn : phase eq bohmian adiabatic } \\\\",
    "\\partial_t a(\\dulr , t ) & = -\\sum_\\nu\\frac{\\left[\\nabla_\\nu s(\\dulr , t)\\right]}{m_\\nu}\\cdot \\nabla_\\nu a(\\dulr , t).\\label{eqn : amplitude eq bohmian adiabatic}\\end{aligned}\\ ] ] the sum over the index @xmath189 runs over the particles and the new time - dependent potential @xmath190 is @xmath191 the second term on the right - hand - side is the so - called quantum potential , depending on the amplitude of the wave function and therefore carrying the time - dependence of @xmath190 .",
    "trajectories can be used to solve eq .",
    "( [ eqn : phase eq bohmian adiabatic ] ) , by defining the momentum as @xmath192 , i.e. @xmath193 this newton s equation is exactly equivalent to eq .",
    "( [ eqn : phase eq bohmian adiabatic ] ) .",
    "in contrast to eq .",
    "( [ eqn : tdse for chi ] ) , the hamiltonian given in eq .",
    "( [ eqn : nuclear hamiltonian ] ) and used in the tdse  ( [ eqn : exact nuclear eqn ] ) for the evolution of the nuclear wave function of the factorization does not only contain a static coulomb interaction ( already included in the tdpes ) among particles , but also a time - dependent contribution due to the electrons , that are treated fully dynamically within the exact factorization approach . despite this difference , the above procedure , used to derive bohmian trajectories ,",
    "can be applied to eq .",
    "( [ eqn : exact nuclear eqn ] ) .",
    "we now identify @xmath15 with the nuclear wave function in eq .",
    "( [ eqn : factorization ] ) .",
    "let us restrict ourselves to the case considered throughout the paper , namely with a choice of gauge that sets the vector potential to zero .",
    "the general case is considered in refs .",
    "@xcite . then , eq .  ( [ eqn : phase eq bohmian adiabatic ] ) becomes @xmath194 ^ 2}{2m_\\nu } + \\tilde{\\epsilon}(\\dulr , t ) \\label{eqn : nuclear phase eq bohmian adiabatic}\\end{aligned}\\ ] ] with @xmath195 and @xmath27 given in eq .",
    "( [ eqn : tdpes ] ) . in eq .",
    "( [ eqn : bohmian tdpes ] ) it is clear that the , already time - dependent , potential @xmath27 is corrected by the bohmian quantum potential . from eqs .",
    "( [ eqn : nuclear phase eq bohmian adiabatic ] ) and  ( [ eqn : bohmian tdpes ] ) , newton s equation can be derived , @xmath196 this is not the equation used in section  [ sec : cl vs. qm ] , as the quantum potential is not considered in the calculation of the force ( see eq .",
    "( [ eqn : hamilton eom ] ) for comparison ) .",
    "it follows that it is not a priori expected that the classical trajectories evolving on @xmath27 alone reproduce the quantum nuclear evolution . the presence of the quantum potential in eq .",
    "( [ eqn : bohmian nuclear newton equation ] ) ensures that the trajectory - based treatment of the quantum dynamical problem is exactly , apart from numerical errors , equivalent to a tdse .",
    "when this contribution is neglected , as in the results presented in section  [ sec : cl vs. qm ] , disagreement between exact and trajectory - based results might be observed .",
    "moreover , it is worth stressing that since the quantum potential is totally ignored throughout the paper , our analysis does not focus on understanding the properties of or creating a potential that allows to include quantum nuclear effects within a trajectory - based approach .",
    "we aim at describing the properties of a potential that induces effects , such as the splitting of a nuclear wave packet , related to the non - adiabatic behavior of the electrons that are coupled to the nuclei .",
    "the tdpes itself will not be able to account for purely nuclear quantum effects , such as tunnelling , which can be however expected if the quantum potential is taken into account in eq .",
    "( [ eqn : bohmian nuclear newton equation ] ) .",
    "the expression of the gd part of the tdpes can be rewritten by using the relation for the phase , @xmath198 , of the coefficient of @xmath199 , in terms of the phases , @xmath200 , of @xmath201 and the phase , @xmath202 , of the nuclear wave function : @xmath203 .",
    "together with the pnc , we obtain then an exact expression @xmath204 the phase of the nuclear wave function appears also in the expression for the vector potential , as @xmath205 where we neglected all terms containing the nacvs since they are negligible in the region where the steps form .    the gauge condition , @xmath206 , can be used here to derive an expression for @xmath207 in eq .",
    "( [ eqn : gd with phases ] ) . by setting eq .",
    "( [ eqn : vector potential with phases ] ) equal to 0 , we obtain @xmath208 we insert this expression in eq .",
    "( [ eqn : gd with phases ] ) @xmath209 ( differentiating and integrating the first term on the right - hand - side to get the second inequality ) . throughout , we neglect any spatially - constant term in @xmath91 because it has no physical effect and we are interested in evaluating energy differences .",
    "after the derivatives are applied to all quantities in the sum , the remaining terms are @xmath210\\dot s_l(r',t)\\\\ & -\\int^rdr'\\sum_{l=1,2}\\left[\\partial_t\\left|c_l(r',t)\\right|^2\\right]s_l'(r',t).\\label{eqn : used equation for gd}\\end{aligned}\\ ] ] if the full tdse is expanded on the adiabatic basis , neglecting the contributions from the nacvs and considering only the real part up to within terms @xmath211 , @xmath212 can be expressed as @xmath213 instead , the time derivative of @xmath134 may be written as @xmath214 using the relation eq .",
    "( [ eqn : relation coefficients ] ) .",
    "moreover , the time derivatives of @xmath215 and @xmath216 can be traded for spatial derivatives , by the equation of continuity , from the imaginary part of the tdse expanded on the adiabatic basis , @xmath217 and from eq .",
    "( [ eqn : exact nuclear eqn ] ) , @xmath218 we now replace the explicit expressions for @xmath219 and @xmath220 from eq .",
    "( [ eqn : s from gauge choice ] ) , and eq .  ( [ eqn : dt of c_l ] ) becomes @xmath221 where @xmath222 which follows from eq .",
    "( [ eqn : chi and fl ] ) .",
    "these expressions are used in eq .",
    "( [ eqn : used equation for gd ] ) , and , after some algebra , @xmath91 becomes @xmath223 the three terms in the integral are the @xmath224 term @xmath225 and two small corrections labeled @xmath226 ( first ) @xmath227 ^ 2}{m}\\left[\\frac{\\partial_r|f_1|}{|f_1|}+\\frac{\\partial_r|f_2|}{|f_2|}\\right]|c_1|^2|c_2|^2\\ ] ] and @xmath228 ( second ) @xmath229 ^ 2}{m}|c_1|^2|c_2|^2.\\ ] ] so far , the only approximation has been neglecting the term @xmath230 in the evolution equation  ( [ eqn : dot phi_l ] ) for @xmath231 .",
    "note that the pnc , in the form @xmath232 , has been used in eq .",
    "( [ eqn : leading term in gd ] ) .",
    "the left panel in fig .",
    "[ fig : terms gd height ] show for the times indicated in the plots , the functions in eqs .",
    "( [ eqn : leading term in gd ] ) ,  ( [ eqn : remaining term in gd ] ) and  ( [ eqn : second derivative term in gd ] ) .",
    "it is clear that the @xmath224 term is by far the dominant contribution to @xmath91 and that the contribution from eq .",
    "( [ eqn : second derivative term in gd ] ) can be neglected .    ) , solid lines , eq .",
    "( [ eqn : remaining term in gd ] ) , dashed lines , and eq .",
    "( [ eqn : second derivative term in gd ] ) , dotted lines , at some times after the splitting of the nuclear wave packet .",
    "the figure shows that the average of the bo energies in the region of the step , weighted by @xmath233 is indeed the leading term .",
    "right : approximations to eqs .",
    "( [ eqn : leading term in gd ] ) and  ( [ eqn : remaining term in gd ] ) based on quasiclassical arguments . ]    the right panel in fig .",
    "[ fig : terms gd height ] show an approximation to eqs .",
    "( [ eqn : leading term in gd ] ) and  ( [ eqn : remaining term in gd ] ) . to have an analytic expression for @xmath234 , first we make use of the error - function structure of eq .",
    "( [ eqn : fitting function ] ) .",
    "this means its spatial derivative is a gaussian centered at @xmath102 with variance @xmath235 , namely @xmath236 inserted into eq .",
    "( [ eqn : leading term in gd ] ) , this gives an expression for the dominant contribution to @xmath91 in terms of the bopess , the crossover point @xmath102 and width @xmath137 .",
    "for the correction term eq .",
    "( [ eqn : remaining term in gd ] ) , we use eq .",
    "( [ eqn : dot phi_l ] ) to identify the spatial derivative of the phase @xmath237 , as the momentum associated to the motion of the wave packet on the @xmath238-th bo surface and we approximate @xmath239 , with a gaussian centered in @xmath240 with variance @xmath241 .",
    "therefore , we use the following expression @xmath242 where @xmath243 and @xmath244 are obtained from exact calculations , according to @xmath245 and @xmath246 ^ 2|f_l(r , t)|^2}{\\int dr |f_l(r , t)|^2}.\\ ] ] the height @xmath247 of the steps can be estimated as the energy difference between two points @xmath248 and @xmath249 , chosen far enough from @xmath102 , such that it guarantees that @xmath250 and @xmath251 are constant .",
    "therefore , @xmath252-\\int^{r^-}dr'\\left[\\cdots\\right]\\end{aligned}\\ ] ] where the dots in square brackets represent the function under the integral sign in eq .",
    "( [ eqn : exact gd ] ) . since @xmath253",
    ", we can split the first integral in two parts @xmath254+\\int_{r^-}^{r^+}dr'\\left[\\cdots\\right]-\\int^{r^-}dr'\\left[\\cdots\\right]\\ ] ] and the remaining term is only the integral performed over the region from @xmath255 to @xmath256 .",
    "since the functions in the integral are localized around @xmath102 and rapidly decay to zero ( the gaussian in eq .",
    "( [ eqn : leading term in gd ] ) and the product @xmath257 in eq .",
    "( [ eqn : remaining term in gd ] ) ) , the boundaries of the integral can be set to infinity . the final result , as shown in eq .",
    "( [ eqn : leading term bis ] ) , is @xmath258 with @xmath259 , with correction @xmath260 ^ 2}{4m}\\int_{-\\infty}^{+\\infty } dr\\left|c_1(r , t)\\right|^2\\left|c_2(r , t)\\right|^2 \\nonumber \\\\ \\left[\\frac{r - r_1^{\\textrm{qm}}(t)}{\\sigma_1 ^ 2(t)}+\\frac{r - r_2^{\\textrm{qm}}(t)}{\\sigma_2 ^ 2(t)}\\right].\\end{aligned}\\ ] ]    79ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]  + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * , ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) \\doibase http://dx.doi.org/10.1063/1.4739846 [ * * ,   ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * , ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop _ _ ,  ed .",
    "( ) @noop * * , ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop   @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( )"
  ],
  "abstract_text": [
    "<S> the decomposition of electronic and nuclear motion presented in  [ a. abedi , n. t. maitra , and e. k. u. gross , phys . </S>",
    "<S> rev . </S>",
    "<S> lett . </S>",
    "<S> 105 , 123002 ( 2010 ) ] yields a time - dependent potential that drives the nuclear motion and fully accounts for the coupling to the electronic subsystem . here </S>",
    "<S> we show that propagation of an ensemble of independent classical nuclear trajectories on this exact potential yields dynamics that are essentially indistinguishable from the exact quantum dynamics for a model non - adiabatic charge transfer problem . </S>",
    "<S> we point out the importance of step and bump features in the exact potential that are critical in obtaining the correct splitting of the quasiclassical nuclear wave packet in space after it passes through an avoided crossing between two born - oppenheimer surfaces , and analyze their structure . </S>",
    "<S> lastly , an analysis of the exact potentials in the context of trajectory surface hopping procedure is presented , including preliminary investigations of velocity - adjustment , and the force - induced decoherence effect . </S>"
  ]
}