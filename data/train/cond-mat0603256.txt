{
  "article_text": [
    "wannier functions ( wfs ) can be obtained by a unitary transformation of the extended wavefunctions of a periodic system .",
    "@xcite so far , the effective diffusion / application of wfs in electronic structure calculations was hindered by their intrinsic non - uniqueness .",
    "@xcite in 1997 marzari and vanderbilt proposed a useful approach  @xcite to overcome this drawback : the proposed methodology allows one to extract , from a selected manifold of bands , the set of wfs with the maximum spatial localization , _",
    "i.e. _ the _ maximally localized wannier functions _ ( mlwfs ) . on one hand ,",
    "mlwfs are attractive because they constitute a complete and orthonormal basis set in the real space . on the other hand , with respect to other numerical real - space basis sets ,",
    "they carry also the physical information of the starting bloch functions . indeed , mlwfs may yield the chemical view of molecular bond orbitals , and they can be exploited for the computation of the spontaneous polarization in periodic systems,@xcite becoming very popular to tackle these issues in advanced materials .",
    "@xcite in addition , mlwfs have most recently been proposed to calculate the transport properties of nano - size conductors connected to external electrodes.@xcite    the calculation of mlwfs was originally implemented  @xcite for a projection from bloch orbitals expanded on a plane - wave basis set in density functional theory ( dft ) calculations , within the norm - conserving pseudopotential ( ncpp ) framework .",
    "norm - conserving pseudopotentials ,  @xcite that allow to neglect core electrons in the evaluation of physical observables , are usually characterized by a high transferability of an element to a variety of chemical environments .",
    "however , the norm conservation in the core region is a strong constraint , that affects the computational effort of the dft calculations . as a consequence , only a part of the periodic table elements results numerically accessible : some chemical species , such as first - row elements ( e.g. c , n , o , f ) and especially transition metals ( e.g. mn , fe , co , ni , cu ) and rare earths ( e.g. la , gd , yb ) , would require an extremely high number of basis functions ( _ e.g. _ plane waves ) , in order to be described with a satisfactory accuracy .",
    "unfortunally , the typical systems of interest in nanoscience and specifically in molecular electronics contain atoms of those critical species .",
    "this problem was brilliantly solved within a frozen - core approach by introducing the ultrasoft pseudopotentials ( uspps),@xcite that relax the norm conservation constraint , by compensating with a pseudized charge .",
    "since the computational requirement in the calculation of the dft bloch functions affects also the evaluation of the mlwfs , the generalization of the original marzari - vanderbilt s procedure to the case of uspps becomes necessary , in order to make the mlwfs a powerful tool to tackle realistic systems of high technological and fundamental relevance .",
    "this is the focal aim of the paper .    in pursuing this extension",
    ", we also noted that recent studies mapped  @xcite the uspp procedure into the paw theory .",
    "the latter  @xcite approach was developed by blchl to combine an all - electron description of the system with the simplicity of the frozen - core pseudopotential methods .",
    "the reader is referred to the original articles for a description of the paw scheme and for the matching between paw and uspp .",
    "the uspp can indeed be recast in the paw formalism as an approximation , as we will discuss in the following .",
    "given this equivalence , we developed a theoretical framework within the paw theory to compute wfs from uspp bloch orbitals , as we show by expressing the necessary matrix elements .",
    "the paper is organized as follows : in section  [ sec : formalism ] we first write down the salient quantities of the uspp and paw methods that enter the computation of the wfs , and then obtain and discuss the wf computation ; in section  [ sec : applications ] we report the results of the application of our method to several test cases , that explore both the chemical bonding and the electrical polarization in the pertinent cases ; finally we draw our conclusions in section  [ sec : conclusions ] .",
    "in this section we give a brief introduction to the theory of maximally localized wannier functions .",
    "a more detailed description can be found in the original papers .",
    "@xcite in the case of an isolated band , wannier functions can be defined  @xcite as a combination of the bloch orbitals @xmath0 corresponding to different @xmath1points as follows : @xmath2 where @xmath3 is a @xmath4-dependent phase factor . this definition has been generalized  @xcite to a group of bands leading to the expression : @xmath5 here the extra degrees of freedom related to the phases of the bloch eigenstates are collected in the unitary matrix @xmath6 . in the one - band case it has been demonstrated that a suitable choice of the phases @xmath3 leads to wfs which are real and exponentially decaying in a real space representation .",
    "@xcite in the many - band case  @xcite this theorem does not hold anymore but the arbitrariness in the unitary ( gauge ) transformation @xmath6 can be exploited . following marzari and vanderbilt  @xcite",
    "we define a _ spread",
    "_ functional @xmath7 $ ] , which gives a measure of the degree of localization of the wf set .",
    "it reads : @xmath8=        \\sum_n \\ , \\left [ \\ , \\langle \\hat{r}^2 \\rangle_n - \\langle \\hat{\\mathbf{r } }        \\rangle_n^2 \\ , \\right ] \\",
    ", , \\ ] ] where @xmath9 is the expectation value of a given operator on the @xmath10-th wf calculated using the @xmath6 gauge transformation .",
    "it is therefore possible to define the _ maximally localized _ wannier functions ( mlwfs ) as the wfs resulting from eq .",
    "( [ eq : wannier_definition ] ) by means of the unitary transformation @xmath6 that minimizes the spread functional .    according to the formal analysis of the @xmath11 and @xmath12 terms given by blount ,",
    "@xcite it is possible to demonstrate that the dependence of @xmath13 on the gauge transformation is determined only by the so - called overlap integrals @xmath14 : @xmath15 @xmath16 being the periodic part of the bloch states @xmath17 .",
    "the detailed form of the position expectation values and of the spread functional ( including its gradient wrt to @xmath6 ) in terms of the overlap integrals is reported in appendix  [ app : wannier ] . since the representation of bloch eigenstates enters only the calculation of the @xmath14 integrals , these quantities are the main objects to deal with when using a uspp or paw formalism .",
    "the detailed treatment is reported in section [ sec : wannier_uspp ] .",
    "the paw formalism has been introduced by blchl  @xcite and it has also been demonstrated  @xcite that the vanderbilt ultrasoft pseudopotential ( uspp ) theory  @xcite can be obtained within the paw approach .",
    "blchl s starting point is to partition the volume of the system by setting spherical regions ( atomic spheres ) around each atom . in each sphere",
    "two complete sets of wavelets  @xcite ( @xmath18 where @xmath19 the index @xmath20 runs over different atoms ( _ e.g. _ different atomic spheres ) , while @xmath21 are the projectors  @xcite related to the pseudo wavelets @xmath22 .",
    "the @xmath23 operator acts on the pseudized functions to reconstruct  @xcite the ae ones .",
    "matrix elements and expectation values of a generic operator @xmath24 on the physical ae states can be written as : @xmath25 one of the main results of ref .",
    "[ ] is the explicit expression for @xmath26 , which we report here for the case of local and semilocal operators : @xmath27       \\ , | \\beta_{ii}^ { } \\rangle \\langle \\ , \\beta_{ij}^{}| \\ , .\\end{aligned}\\ ] ] the second term ( @xmath28 ) in the rhs of eq .",
    "( [ eq : expectation_value ] ) takes into account the corrections due to the use of the pseudo functions instead of the ae ones , and from here on it will be called augmentation term . at this point",
    "it is useful to define the quantities @xmath29 and @xmath30 ( augmentation densities and charges respectively ) as : @xmath31 within these definitions , eq .",
    "( [ eq : expectation_value ] ) for local operators @xmath32 can be recast in a more convenient form : @xmath33       \\",
    ", | \\beta_{ii}^ { } \\rangle \\langle \\ , \\beta_{ij}^{}| \\ , .\\ ] ] setting @xmath24 to the identity in eqs .",
    "( [ eq : expectation_value],[eq : expectation_value_local ] ) , scalar products are given by @xmath34 ( that characterizes also the uspp formalism  @xcite ) is given by : @xmath35 in the same way , by setting @xmath36 we obtain an expression for the density : @xmath37 where @xmath38 is the density contribution of the pseudo wavefunctions .",
    "since we are able to express all the quantities of interest in terms of the soft pseudo - states , the quantum problem can be solved directly in this representation . in order to do this ,",
    "it is necessary to _ augment _ the hamiltonian operator : the procedure leads to additional terms which have exactly the same role as that of the pseudopotentials in standard pw calculations .    moving to the uspp framework , the generalization introduced by vanderbilt  @xcite is twofold .",
    "( i ) more than one projector per angular momentum channel can be taken into account : the inclusion of multiple projectors per channel enlarges the energy range  @xcite over which logarithmic derivatives are comparable with the full potential case , thus increasing the overall portability of the pseudopotential .",
    "( ii ) by relaxing the norm - conservation constraint of the pseudo reference - states , the pseudo wavefunctions are smoothened : thus , the required cutoff energy for pw representation can be drastically lowered .",
    "the fact that properties ( i ) and ( ii ) are verified for the paw wavelets @xmath39 establishes the connection between the paw and uspp methods . in fact , ( i ) is naturally valid for the wavelets @xmath40 , because these form a basis set , and therefore have in principle an infinite number of states for each angular momentum channel . (",
    "ii ) is valid as well , and the possibility of non norm - conservation in passing from @xmath41 to @xmath42 is accounted by non null @xmath43 terms in eqs .",
    "( [ eq : augmentation_densities],[eq : augmentation_charges ] ) .",
    "consequently , the paw theory for wavefunction reconstruction can be basically adopted also in the case of uspp .",
    "@xcite    while the paw method is in principle an exact ae ( frozen - core ) approach ,  @xcite the uspp method adopts a further approximation  @xcite represented by the requirement of pseudizing the augmentation densities @xmath44 [ eq .  ( [ eq : augmentation_densities ] ) ] .",
    "since these terms contain the ae reference states , they are not simply writable on a pw basis : the uspp pseudization is done to make them suitable for a pw representation .",
    "this also means that the total density from eq .",
    "( [ eq : density ] ) would be pw representable within such an approach .",
    "even though the augmentation densities are pseudized , they must capture some features of the physical ae density .",
    "consequently , their pw cutoff energy may be larger than the one associated to the pseudo wavefunction density [ @xmath38 in eq .",
    "( [ eq : density ] ) ] .      as mentioned in sec .",
    "[ sec : formalism_wf ] , bloch wavefunctions enter the calculation of mlwf s only through the overlap matrix elements @xmath14 , defined in eq .",
    "( [ eq : overlap ] ) .",
    "therefore , the reconstruction of these integrals from the knowledge of pseudo ( ultrasoft ) functions completely solves the problem of computing mlwf s within a paw / uspp formalism .",
    "once overlap matrices have been calculated , we do not longer distinguish whether the parent bloch wavefunctions were pseudized or not .",
    "being the overlaps @xmath45 [ eq .  ( [ eq : overlap ] ) ] the matrix elements of the local operator @xmath46 , we built up the corresponding augmentation using eq .",
    "( [ eq : expectation_value_local ] ) .",
    "overlaps can be written as : @xmath47 where we have defined @xmath48 and @xmath49 are @xmath4-point symmetrized projectors ( bloch sums ) .",
    "summation over ions @xmath20 is done in a single unit cell .",
    "details about the calculation of these quantities are reported in appendix  [ app : radial_ft ] .",
    "we stress that the scalar product of @xmath50 functions can not be simply augmented by the @xmath51 [ eq .",
    "( [ eq : number_operator ] ) ] operator as those involving @xmath52 s . in order to work with the periodic part @xmath53 of the bloch functions , _ first",
    "_ we have to reconstruct the ae bloch states by means of @xmath23 and _ then _ we can obtain the required @xmath54 states by applying the local operator @xmath55 . since this last operator does not commute with @xmath23 , we are not allowed to directly work on @xmath53 with the reconstruction operator . in the first scalar product of eq .",
    "( [ eq : overlap_augmentation ] ) the number operator @xmath56 has been therefore substituted by the augmented operator @xmath57 .",
    "we thus need to introduce the fourier transform of the augmentation densities @xmath58 instead of the augmentation charges @xmath30 .",
    "we also note that in the thermodynamic limit the @xmath4-point grid becomes a continuum , so that @xmath59 .",
    "this limit leads to identical @xmath51 and @xmath60 operators .",
    "therefore , within discrete @xmath4-meshes the use of @xmath51 instead of @xmath60 is an approximation expected to give the best performance in the limit of a large number of @xmath4-points .",
    "we will refer to this approximation as the thermodynamyc limit approximation ( tla ) .",
    "we will comment more on its numerical aspects in sec .",
    "[ sec : applications ] .",
    "the problem of calculating wannier functions within uspp has also been faced elsewhere in the literature .",
    "@xcite in a first attempt , vanderbilt and king - smith  @xcite extended the calculation of the spontaneous polarization through the berry phase  @xcite to the uspp procedure . since the berry phase  @xcite",
    "is directly related to overlap integrals , an expression for its calculation is reported in eq .",
    "( 23 ) of ref .",
    "[ ] . this expression adopts the @xmath51 number operator instead of @xmath60 .",
    "therefore , the result does not completely agree with the one presented here [ eq .",
    "( [ eq : overlap_augmentation ] ) ] , but it can be read as an approximating formula having the right thermodynamic limit in view of the above discussion .",
    "bernasconi and madden  @xcite derived instead the formalism for mlwfs with uspp in a simplified approach  @xcite valid only in the case of @xmath61-sampled supercells .",
    "although the basic ingredients ( _ e.g. _ overlaps ) are the same , our treatment is valid for generic periodic systems , and recovers the @xmath61-only calculation as a special case .",
    "furthermore , the proof given in ref .",
    "[ ] is not based on a paw reconstruction as we did .",
    "the authors generalized the augmentation operator for the density [ eq .  ( [ eq : density ] ) ] also to the case of the density matrix and then derived the augmentation for the @xmath62 operator . here instead the @xmath63 are the generators of the reciprocal lattice .",
    "we note that the result by bernasconi and madden is coherent with our treatment , while the first one by vanderbilt and king - smith  @xcite is not .",
    "following bernasconi and madden , thygesen and coworkers  @xcite recently derived an expression for overlap matrices within uspp for periodic systems , considering a @xmath61-only supercell containing the whole crystal .    closing this section",
    "we wish to underline that matrix elements of the form @xmath64 enter also other physical problems .",
    "a particularly appealing case is the calculation of one - particle green function in the gw approximation .",
    "@xcite current implementations  @xcite of the method experience dft wavefunctions mainly through the above defined matrix elements ( evaluation of the polarizability ) , while no direct access to the density is required .",
    "the extension of gw calculations to the case of paw  @xcite or uspp is therefore feasible along the same lines we presented here for wannier functions .",
    "we note , however , that the numerical cost is extremely higher due to the larger number of overlaps to be computed .      in this section",
    "we would like to describe some issues related to the numerical performance of the method .",
    "we implemented this formalism in the freely - available want code ,  @xcite for the calculation of electronic and transport properties with wfs .",
    "we also took advantage of the complete integration of the want code with the pwscf package ,  @xcite which explicitly treats the dft problem using uspps . from here on we focus on the uspp formalism , even though a large part of the discussion is still valid also in the paw case .",
    "the most important advantage of using the uspp construction for wannier functions is the scaling of the original dft calculations , which has been described elsewhere  @xcite and we do not repeat now .",
    "however , this scaling has also an effect on the actual computation of wfs and we analyze this aspect in detail .",
    "as we described above , almost the whole amount of changes induced by the uspp description ( relative to ncpp ) in the the calculation of mlwfs is related to the implementation of eq .",
    "( [ eq : overlap_augmentation ] ) .",
    "details on how to compute @xmath65 and @xmath66 are reported in appendix  [ app : radial_ft ] . since no reference to the charge",
    "is made , only the very smooth wavefunction grid is used throughout the calculation . while a linear scaling with the number of plane waves is exploited in the first term ( pseudo overlaps ) of eq .",
    "( [ eq : overlap_augmentation ] ) , scalar products between projectors and pseudo states in the second term ( augmentation overlaps ) are the price to pay for introducing uspps . when we consider that the number of @xmath67-projectors @xmath68 is of the same order of the number of bands @xmath69 ( but usually larger by a factor between one and two ) we see that both pseudo and augmentation overlap terms have the same scaling , namely @xmath70 .",
    "however , the pseudo overlaps turn out to have a larger prefactor  @xcite and represent the leading term .",
    "usually , uspps allow for a reduction of the pw cutoff by a factor of 2 to 3 for first - row elements up to 5 or even more for atoms with @xmath71- or @xmath72-states .",
    "this leads to a reduction of the pw number @xmath73 by a factor of around 3 to 10 or more . even if the scaling wrt @xmath73 is linear , it more than compensates the effort for augmenting overlaps and makes the introduction of uspps numerically advantageous .",
    "our experience shows that uspps avoid the creation of bottlenecks in the computation of overlaps and make the wf localization the leading part of the calculation .",
    "finally , we note that in order to give a guess for the iterative minimizations involved in the mlwf method , it is sometimes required to compute the projections of bloch states onto some starting localized functions .",
    "@xcite the augmentation of scalar products is performed as usual accounting for the @xmath51 number operator [ eq .",
    "[ eq : number_operator ] ] .",
    "projections on the @xmath67-functions are required as well , but they have already been computed and it turned out that scaling is linear wrt the pw number as before . therefore , no implications on the above discussion arise .",
    "in this section we apply the above described formalism to some test cases , ranging from periodic crystals to isolated molecules .",
    "precisely , we study _ fcc _ copper bulk , wurtzite aln , and watson - crick dna base pairs .",
    "we address a number of physical properties connected to wannier functions : interpolation of the electronic structure , calculation of dipole moments and spontaneous polarization , analysis of the chemical bonding .",
    "all the calculations are performed with both norm - conserving and ultra - soft pseudopotentials .",
    "the numerical implications in using the uspp - tla approach for the augmentation of overlaps are also discussed .",
    "we compute mlwfs for _ fcc_-copper , which has already been used as a test case in the literature  @xcite of wfs .",
    "we adopt a @xmath74 mesh of @xmath4-points to sample the brillouin zone and compute six wfs corresponding to the lowest @xmath75 manyfold . in the disentangling procedure  @xcite (",
    "used to get the optimal subspace for wf localization ) we _ freeze _ the bloch eigentates below the fermi energy : this means that the subspace is constructed by these selected states plus a mixture of the states above the fermi level .",
    "we adopt a kinetic energy cutoff for wavefuntions of 120 ry ( 25 ry ) when using ncpp ( uspp ) and of 480 ry ( 200 ry ) for the density .    in fig .",
    "[ fig : copper - bands ] we superimpose the band structure directly computed from a uspp - dft calculation and that obtained from wannier function interpolation  @xcite on the adopted 8@xmath768@xmath768 uniform @xmath4-point grid .",
    "these two sets of bands are almost superimposed below the fermi energy and some slight differences arise only at higher energies .",
    "this is expected due to the choice of the energy window for the frozen states : while the eigenvalues for the @xmath4-points in the adopted regular mesh are the same as those from the dft calculation by construction , it is not trivial that the band structure along a generic brillouin zone line is well reproduced .",
    "this is indeed the case here , being a signature of proper localization of the computed wfs .",
    "the band structure interpolation obtained from ncpp is essentialy the same as the one in fig .",
    "[ fig : copper - bands ] and it is not reported .",
    "some small descrepancies between ncpp and uspp interpolated bands are also present in the starting dft calculations and are not of our interest in this context .    in tab .",
    "[ tab : copper - data ] we report a more detailed description of quantities related to wfs ( spreads , real - space decay of the hamiltonian matrix elements ) in order to compare the ncpp and uspp approaches .",
    "a measure of the hamiltonian decay is defined as : @xmath77 where we defined @xmath78 .",
    "p1 mm l p0 mm r p0 mm r p0 mm r & & & * ncpp * & & * uspp * & & * uspp - tla * +   + & @xmath13 & & 22.434 & & 23.010 & & 18.886 + & @xmath79 & & 14.767 & & 15.629 & & 11.303 + & @xmath80 & & 7.667 & & 7.381 & & 7.583 +   + & @xmath81 & & 0.4876 & & 0.4795 & & 0.4779 + & @xmath82 & & 0.0493 & & 0.0473 & & 0.0476 + & @xmath83 & & 0.0203 & & 0.0207 & & 0.0205 +    uspp results appear to be in very good agreement with those related to ncpp , most of the differences being reasonably due to the pseudopotential generation and not to the wf computation .",
    "the average number of iterations to converge the disentanglement and the localization procedures are almost the same , as well as the singular spread values for each of the wfs .",
    "figure  [ fig : copper - plot ] reports the spatial distribution of wfs from uspp calculations . as in previous works ,  @xcite",
    "we find one interstitial @xmath84-like wf with the largest spread [ fig .",
    "[ fig : copper - plot](a ) ] , and five more localized @xmath71-like wfs [ fig .",
    "[ fig : copper - plot](b  d ) ] , correctly reproducing the physical @xmath75 picture of copper .",
    "fcc_-copper _ : charge distribution for wfs computed using uspp . ( a )",
    "interstitial wf , @xmath85 bohr@xmath86 ; ( b  d ) @xmath71-character wfs , @xmath87 bohr@xmath86 , @xmath88 bohr@xmath86 , @xmath89 bohr@xmath86 .",
    "the two @xmath71-like missing wfs are strictly similar to ( b ) and ( c ) and are not reported .",
    ", scaledwidth=38.0% ]    as a last remark for the case of copper , we analyze the effect of neglecting the @xmath90 term in eq .",
    "( [ eq : overlap_augmentation ] ) , _ i.e. _ the uspp thermodynamic limit approximation ( uspp - tla ) . the theoretical background has already been discussed in sec .",
    "[ sec : wannier_uspp ] , here we focus on the numerical aspects . in tab .  [",
    "tab : copper - data ] the third column reports the resukts of the calculation performed within this approximation : it is evident that the numerical values of the uspp - tla spreads deviate from the ncpp ones much more than the uspp do . on the contrary , the interpolated band structure and the real - space decay hamiltonian matrix elements",
    "are definitely well - suited and comparable with those obtained in the full uspp treatment .",
    "since the tla is known to become exact in the thermodynamic limit , we expect it to work better when incresing the dimension of the @xmath4-point mesh .",
    "we checked the behavior of the approximation with respect to different meshes but no convergence could be reached for grids ranging from @xmath91 to @xmath92 @xmath4-points .",
    "wannier functions have been widely used to characterize the electrostatic properties of several molecular systems ranging from _",
    "e.g. _ water  @xcite and small molecules  @xcite to large biomolecules , such as proteins,@xcite nucleic acids ,  @xcite enzymes  @xcite and ionic channels .",
    "@xcite in fact , the wannier transformation allows one to partition the charge density into localized distributions of charges sitting on the so - called wannier centers @xmath93.@xcite in the case of isolated molecular systems , the dipole moment is a well defined quantity given by @xmath94 with    @xmath95    where @xmath96 and @xmath97 are the ionic and electronic component respectively ; @xmath98 is the electron charge ; the @xmath20 summation is over the ionic sites @xmath99 and @xmath100 is the valence charge of the @xmath101 atom , as defined by the corresponding psudopotential ; the @xmath10 summation is over the doubly occupied valence states .",
    "p1 mm l p0 mm c p0 mm c p0 mm c p0 mm c & & & * uspp * & & * ncpp * & & * hf/6 - 31g@xmath102 * & & * exp . * +   + & g & & 7.1 & & 7.2 & & 7.1 & & 7.1@xmath103 + & c & & 6.7 & & 6.9 & & 7.1 & & 7.0@xmath104 + & a & & 2.3 & & 2.3 & & 2.5 & & 2.5@xmath103 + & t & & 4.2 & & 4.4 & & 4.6 & & 4.1@xmath105 + & g - c & & 4.9 & & 4.9 & & 6.5 & & + & a - t & & 1.7 & & 1.8 & & 2.0 & & +    @xmath106devoe and tinoco ( ref .  ) + @xmath107weber and craven ( ref .  ) + @xmath108kulakowski _ et al . _",
    "( ref .  )    as a key test , we calculated the dipole moments of the four isolated dna bases : guanine ( g ) , cytosine ( c ) , adenine ( a ) and thymine ( t ) , and of the two watson - crick base pairs g - c and a - t , whose structures are reported in fig .",
    "[ fig : dnawf](a ) .",
    "we simulated each system in a large ( @xmath109 ) @xmath110 supercell , which allows us to avoid spurious interactions among neighbor replicas .",
    "for isolated systems , the uniform k - point grid reduces to the case of @xmath61-point only , and the connecting vectors @xmath111 [ eq .",
    "( [ eq : overlap ] ) ] correspond to the generators of the reciprocal lattice vectors .",
    "we expanded the electronic wavefuncions with the kinetic energy cutoff of 25 and 80 ry , using uspp and ncpp respectively .",
    "we first optimized the atomic structure of the two base pairs g - c and a - t until forces on all atoms were lower than 0.03 ev /  , using ultra - soft pseudopotentials .",
    "then , keeping atoms fixed in the relaxed geometry , we calculated the electronic structure and the corresponding mlwfs for both the single bases and the base pairs .",
    "we maintained the same geometries also for the corresponding ncpp calculations . in this case",
    "we have checked that forces on single atoms never exceeded the value of 0.05ev /  .",
    "our results for both sets of calculations are reported in table  [ tab : dna - dipole ] .",
    "we note a very good internal agreement between the uspp and ncpp cases , as well as in comparison with previous quantum chemistry hf/6 - 31g@xmath102 calculations  @xcite and experimental results .",
    "the total spread @xmath13 and its components @xmath79 , @xmath112 ( not shown ) are also very similar in the two set of calculations , while the diagonal term @xmath113 is , by definition ,  @xcite identically zero for isolated systems .",
    "finally , we can take advantage from the calculated wannier functions to further investigate the electronic distribution and the bonding pattern in the molecules .",
    "@xcite for example , as shown in fig .",
    "[ fig : dnawf](b ) for the case of the g - c base pair , we are able to characterize different kinds of bonds .",
    "the sb wannier function represents a single @xmath114 bond : it is centered in the middle point of the c - c bond .",
    "the two db wfs describe instead a double n = c bond : this bond is partially polarized with a slight charge accumulation near the nitrogen atom .",
    "finally , the lp wfs represents two electron lone pairs localized around the oxygen atom of the guanine molecule .",
    "note also that the distribution of single / double bonds correctly reflects the theoretical one reported in fig .",
    "[ fig : dnawf](a ) .",
    "let us remark here that our benchmark to assess the success of the newly developed uspp - wf methodology is its relative performance with respect to the ncpp - wf ( already established ) framework , namely the comparison between columns 2 and 3 in table ii .      here",
    "we move to the calculation of polarization in periodic systems .",
    "we focus on the case of aluminum nitride and compute the spontaneous polarization @xmath115 of the wurtzite phase .",
    "this is a particularly appealing test - case since a large debate exists in the literature and many results are present .",
    "@xcite moreover , nitrogen may be more easily described ( in terms of pw kinetic - energy cutoff ) with uspps than with ncpps , allowing for an advantageous application of the current formalism .",
    "following refs .",
    "[ ] we evaluate the polarization ( electronic and ionic contributions ) for the wurtzite ( wz ) phase taking the zinc - blend ( zb ) structure as a reference .",
    "our calculations adopt the gga - pbe parametrization for the exchange - correlation functional , and uses cutoff energies of 60 ry ( 25 ry ) for ncpp ( uspp ) for wavefunctions and 240 ry ( 200 ry ) for the density .",
    "we relax both the cell dimensions and the atomic positions of the wz phase .",
    "the zb reference is assumed to have ideal atomic positions and the cell is taken equal to the one computed for the wz polytype ( six bilayers are included in the cell ) .",
    "these structural calculations have been performed using uspp and the obtained ( lattice and ionic ) parameters have been used also in the ncpp simulations . using a @xmath116 monkhorst - pack  @xcite mesh of @xmath4-points we obtained the @xmath117 and @xmath118 parameters of the exagonal lattice as @xmath117=3.1144  and @xmath118=1.6109 ( for the standard wz cell including two bilayers , @xmath118=4.8326 for the actual cell we adopted ) .    in tab .  [",
    "tab : aln - polarization ] we report the comparison of uspp and ncpp results in our calculations as well as other results from the literature .    p1 mm l p0 mm c p0 mm c p0 mm c & p@xmath119 & & * ncpp * & & * uspp * & & * uspp - tla * +   + & this work & & -0.095 & & -0.094 & & -0.094 + & ref .",
    "[ ] & & & & & & -0.090 ( -0.099 ) + & ref .",
    "[ ] & & & & -0.120 & & +   + & @xmath120 & & 80.895 & & 80.756 & & 80.271 + & @xmath121 & & 67.683 & & 67.857 & & 67.282 +    the values of spontaneous polarization computed using ncpps are almost identical to those obtained with uspps ( @xmath122 - 0.094 c / m@xmath86 ) .",
    "the uspp - tla behaves very accurately in this case and no difference can be found with respect to the full uspp calculation .",
    "our results are also in very nice agreement with the uspp - tla calculation by bernardini _",
    "et al . _ ,  @xcite who used a berry - phase formalism  @xcite and found a value of @xmath122 - 0.090 c / m@xmath86 .",
    "we thus conclude that the uspp - tla approximation performs well for the computation of the spontaneous polarization in nitrides , relative to a pure uspp treatment without the thermodynamic limit approximation .",
    "these results for the p@xmath119 in aln wurtzite are also in agreement with indirect experimental evidencies as reported in refs .",
    "[ ] . while some earlier experimental fits  @xcite claim for much lower values of p@xmath119 ( ranging from -0.040 to -0.060 c / m@xmath123 ) , later  @xcite works explain this discrepancy as due the neglecting of bowing effects ( non - linearity ) of the p@xmath119 with respect to the composition of the alloy al@xmath124ga@xmath125n employed in the measurements .",
    "in this paper we presented an approach to calculate _ maximally localized wannier functions _ in the _ ab initio _ plane - wave ultrasoft pseudopotential scheme .",
    "our methodology is formulated in the general framework of the paw theory and recovers the uspp framework as a special case .",
    "the main advantage using uspp is the well known reduction of the computational effort in the evaluation of the electronic wavefunctions at the dft level .",
    "this leads to a consequent reduction of computational load also in the calculation of mlwfs .",
    "we demonstrated that the extension to the uspp case does not introduce further approximations in the computation of the mlwfs with respect to the ncpp case .",
    "furthermore , the reformulation within the paw scheme allows us to interface the computation of mlwfs to other popular approaches for the electronic structure calculation .",
    "finally , our method is formulated in the case of a uniform @xmath4-point mesh for the sampling of the brillouin zone , generalizing previous attempts based on @xmath61-only calculations .",
    "this allows us to treat periodic solid - state systems ( such as crystals , surfaces and interfaces ) , which require a full description of the bz , as well as molecular , finite or amorphous systems which are well described with the @xmath61-only representation .    as a first illustration of the capability of this methodology",
    ", we presented the calculation of the mlwfs for a few selected test cases , easily referable to well established theoretical and experimental results .",
    "for each selected system we also compared the results for both uspp and ncpp calculations , underlying a very good agreement between the two cases .",
    "the reduction of the computational cost resulting from uspp calculations opens the way to the exploitation of the mlwfs as a powerful tool to analyze the electronic structure of larger and more realistic nanoscale systems , in particular for transport in nano - junctions .",
    "we acknowledge discussions with giovanni bussi , marco buongiorno nardelli and elisa molinari for the treatment of uspp .",
    "funding was provided by the ec through tmr network `` exciting '' , by infm through `` commissione calcolo parallelo '' , by the italian miur through prin 2004 , and by the regional laboratory of em `` nanofaber '' .",
    "part of the figures has been realized using the xcrysden package .",
    "for sake of completeness we report here the main relations @xcite entering the expression  ( [ eq : spread_functional ] ) for the spread functional @xmath126 $ ] and its first derivative wrt the unitary transformation @xmath127 [ eq .  ( [ eq : wannier_definition ] ) ] .",
    "these are all the quantities involved in the minimization procedure for the calculation of maximally localized wannier functions .",
    "the expectation values of the position operator are : @xmath128           + \\left [ \\text{im } \\ , \\text{ln }           m^{\\mathbf{k},\\mathbf{b}}_{nn } \\right]^2           \\},\\end{aligned}\\ ] ] where @xmath111 vectors connect nearest - neighbor @xmath4-points and @xmath129 are their weights according to appendix b of ref .",
    "the spread functional can be divided into three terms , the invariant ( i ) , the diagonal ( d ) and the off - diagonal ( od ) components :  @xcite @xmath130 = \\omega_i + \\omega_d [ u ] + \\omega_{od } [ u],\\ ] ] their definitions are , respectively : @xmath131",
    "we report the explicit expression for the calculation of the reciprocal space representation of the paw / uspp projectors and the fourier transform of the augmentation densities : @xmath133 these tasks are also required in the evaluation _",
    "e.g. _ of the density in reciprocal space and are therefore performed in standard plane - waves dft codes .",
    "the index @xmath134 in @xmath135 and @xmath136 stand for radial and angular numbers , _",
    "e.g. _ @xmath137 .",
    "projectors and augmentation densities are explicitly written as a product of a radial part times ( real ) spherical harmonics : @xmath138 first we focus on the expression for @xmath67 projectors",
    ". functions of the form @xmath139 have a known semi - analytical fourier transform which is given by : @xmath140 where @xmath141 is the spherical bessel function of order @xmath142 .",
    "the problem for @xmath67 projectors is therefore directly solved once we add the structure factors accounting for the acutal positions of the ion : @xmath143 moving to the case of the augmentation densities , we note that the product of two spherical harmonics can be expressed as a linear combination of single spherical harmonics using clebsch - gordan coefficients : @xmath144 this allows to follow the same strategy as before also for eq .",
    "( [ eq : augmentation_densities_expanded ] ) .",
    "putting eqs .",
    "( [ eq : clebsch - gordan]-[eq : radial_ft ] ) together , the final expression for @xmath145 reads : @xmath146 where @xmath147 indexes run as in eq .",
    "( [ eq : clebsch - gordan ] ) .",
    "this fact comes first due to the presence of the sum over @xmath111-vectors ( giving a prefactor from 3 to 6 ) and secondly because the coupling of different @xmath4-points for pseudo overlaps makes wavefunction managing more cumbersome .",
    "o.  ambacher , j.  smart , j.  r. shealy , n.  g. weimann , k.  chu , m.  murphy , w.  j. schaff , l.  f. eastman , r.  dimitrov , l.  wittmer , m.  stutzmann , w.  rieger , and j.  hilsenbeck , j.  appl .",
    "phys .   * 85 * , 3222 ( 1999 ) ."
  ],
  "abstract_text": [
    "<S> we report a theoretical scheme that enables the calculation of maximally localized wannier functions in the formalism of projector - augmented - waves ( paw ) which also includes the ultrasoft - pseudopotential ( uspp ) approach . </S>",
    "<S> we give a description of the basic underlying formalism and explicitly write all the required matrix elements from the common ingredients of the paw / uspp theory . </S>",
    "<S> we report an implementation of the method in a form suitable to accept the input electronic structure from uspp plane - wave dft simulations . </S>",
    "<S> we apply the method to the calculation of wannier functions , dipole moments and spontaneous polarizations in a range of test cases . </S>",
    "<S> comparison with norm - conserving pseudopotentials is reported as a benchmark . </S>"
  ]
}