{
  "article_text": [
    "the @xmath0cdm cosmological model is specified by a small number of parameters most of which are accurately constrained by a combination of data from the cosmic microwave background and large - scale structure @xcite .",
    "thus , the initial conditions for the formation of structure are well determined and the subsequent hierarchical growth of structure , involving the formation and merging of dark matter halos , can be simulated with considerable rigour using large cosmological n - body simulations .",
    "however , because of their computational expense or in order to extrapolate to different parameter values , frequent use is made of approximate analytic and monte - carlo descriptions of halo formation and halo mergers .    in this paper",
    ", we extract statistical properties of the merger histories of dark matter halos in the millennium simulation ( ms , * ? ? ?",
    "* ) and compare them to extended press - schechter ( eps ) formalism @xcite and to the monte - carlo algorithm for generating dark matter halo merger trees that is incorporated in the galform semi - analytic model of galaxy formation @xcite . in this way one can determine the strengths and weaknesses of the current descriptions and provide the information required to test future improvements to such models .",
    "the merger history of a dark matter halo is perhaps best visualised as a merger tree ( e.g. see the schematic figure  6 in * ? ? ?",
    "* ) in which small halos present at some early redshift @xmath1 come together through a series of merger events to form a single halo by redshift @xmath2 .",
    "the most widely used statistical description of these merger trees is the eps formalism introduced by @xcite and @xcite and developed by @xcite . for a given set of cosmological model parameters ,",
    "this analytic model predicts the ensemble average properties of sets of merger trees as a function of the final halo mass .",
    "thus , for instance , one can take a galaxy cluster of mass @xmath3  m@xmath4  today and ask , on average , how many of its progenitor halos ( the halos that merged to form it ) at redshift @xmath5 had masses greater than @xmath6  m@xmath4 . however , eps formalism alone will not yield any information about the distribution around this mean , such as how often there are @xmath7 such progenitors . to build algorithms capable of generating sets of individual merger trees and",
    "so be able to make predictions for any such statistics requires further assumptions .",
    "this has been done in various ways @xcite .",
    "it is important to test these algorithms and not just the eps formalism as many interesting observational questions , such as what fraction of galaxy halos undergo major mergers in the last @xmath8  gyr , depend not on the mean of the distribution , but on the properties of the tails .",
    "thus , here we not only update the tests of the eps formalism made in @xcite , but also look at various statistics that test the progenitor distributions predicted by the monte - carlo algorithm often used in the galform semi - analytic code @xcite .    in section  [ sec : simulation ]",
    "we briefly describe the properties of the ms and how we identify halos and build merger trees .",
    "the theoretical models to which we compare our results are reviewed in section  [ sec : models ] .",
    "section  [ sec : results ] presents a series of statistical measures of the merger histories , comparing each to the model predictions and includes , in section  [ sec : cmf ] , the examination of a new empirical model for the conditional mass function .",
    "we conclude in section  [ sec : conc ] .",
    "the millennium simulation follows the gravitational evolution of @xmath9 particles in a comoving periodic cube of side @xmath10  mpc .",
    "the initial conditions are a gaussian random field with a power spectrum consistent with the combined analysis of the 2dfgrs @xcite and first year wmap data @xcite . specifically , the total matter , baryon and cosmological constant density parameters are @xmath11 , @xmath12 and @xmath13 , respectively ; the slope of the primordial power spectrum is @xmath14 ; the hubble parameter @xmath15 ; and the amplitude of the density fluctuations , expressed as the linear rms mass fluctuation in spheres of radius @xmath16  mpc at @xmath17 , is @xmath18 .",
    "the resulting particle mass in the simulation is @xmath19  m@xmath20 and the force softening ( plummer equivalent ) is @xmath21  kpc .",
    "the simulation was performed with a special , memory efficient version of the gadget-2 code @xcite .",
    "further details of the ms can be found in @xcite .",
    "the ms produced outputs , including catalogues of friends - of - friends ( fof , * ? ? ? * ) ) groups of @xmath22 or more particles defined using a linking length parameter @xmath23 , at approximately @xmath24 redshifts .",
    "the substructure within each of these groups was quantified using the subfind algorithm @xcite which identifies self - bound overdensities within each group . to follow halo formation one must follow the descendants of each halo from one timestep to the next . linking ms halos together in this way to form merger trees",
    "has been done in a variety of different ways .",
    "the merger trees used in the semi - analytic models of the munich group @xcite use as their basic unit the sub - halos found by subfind and link these between timesteps .",
    "in contrast , the merger trees used by the durham group @xcite primarily link fof groups between timesteps , but make use of the subfind information both to split fof groups that become prematurely or temporarily linked by low density bridges ( for a description of how this is done see * ? ? ? * ) and to follow the location of galaxies within the halos .    here , we have decided to analyse merger trees based solely on linking fof groups . for each fof group at one timestep , we trace the most bound 10% of the particles ( or the ten most bound particles , if 10% would be fewer than ten particles ) in the most massive subhalo and adopt as the descendant at the next timestep the halo that contains the largest number of these particles . normally , the vast majority are in the same halo .",
    "this choice has the virtue of being simple and easily reproducible .",
    "also , the occasional splitting of halos performed in the more complicated merger trees used in @xcite , while important for the formation of individual halos and galaxies , has very little effect on most of the statistical quantities we present in this paper .",
    "we have , in fact , also analysed the merger trees used in @xcite and , wherever there is a significant difference , we comment appropriately .",
    "the original @xcite theory was just a model for the mass function , @xmath25 \\left\\vert \\frac{d\\ln\\sigma}{d\\ln m } \\right\\vert \\ , d\\ln m , \\ ] ] of halos as a function of redshift . here",
    ", @xmath26 is the fraction of mass in halos of mass @xmath27 ; @xmath28 is the linear density threshold for spherical collapse at redshift @xmath1 ; and @xmath29 is the rms amplitude of linear density fluctuations when smoothed on a mass scale @xmath27 . for comparison with the ms we adopt @xmath28 for a @xmath0cdm cosmology as calculated by @xcite and @xmath29 computed from the linear power spectrum used to create the ms initial conditions , with a real - space spherical top - hat window window function .",
    "if one defines the variable @xmath30 , then the press - schechter mass function can be written compactly as @xmath31 where @xmath32    the alternative derivation of the press & schechter model by @xcite using an excursion set approach placed the theory on a firmer footing and also showed how the model could be extended to yield conditional mass functions describing the progenitors of halos of different final masses ( see * ? ? ? * for an alternative derivation of this result ) .",
    "the @xcite derivation makes several assumptions .",
    "it computes the threshold overdensity for collapse using the pure spherical collapse model ; the linear overdensity at a given point in space is assumed to vary with the smoothing scale as an uncorrelated ( brownian ) random walk ( the sharp @xmath33-space filtering approximation ) ; when assigning mass points to halos of mass @xmath27 no condition is set to demand that these mass points should lie in spatially localised regions capable of forming halos of that mass .",
    "it is thus no surprise that the model does not exactly match the results of the large non - linear n - body simulations that current technology allows @xcite .",
    "in fact , it is perhaps surprising that the theory performs as well as it does .",
    "this may be because despite the approximations made in deriving the model , it has the scaling properties that make it fully consistent with self - similar evolution ( for example , see * ? ? ? * ) and is fully self - consistent .",
    "@xcite and @xcite showed that by dropping the first assumption described above and modelling the density threshold for collapse using an elliptical model one could modify the press - schechter mass function to be in excellent agreement with n - body simulations .",
    "this modification considerably complicates the model and , in particular , destroys the symmetry that allows the conditional mass functions to be derived analytically .",
    "also , for small time intervals , @xcite found that their model predicted conditional mass functions which are in worse agreement with the simulation data than the original eps model .",
    "thus , by completely removing the inaccuracy of the mass function by revising just one of the three simplifying assumptions of the eps model other aspects of the model are made worse .    here",
    ", because of its simplicity and because it is still the only analytic model that lends itself to the generation of individual merger trees , we compare the ms with the original eps formalism @xcite .",
    "the monte - carlo algorithm whose merger trees we compare with those of the ms is that described in section  3.1 of @xcite .",
    "this algorithm is derived by computing , using the eps formalism , the distribution of progenitors in the limit of an infinitesimally small timestep .",
    "this is used to compute both the probability that a halo of mass @xmath34 at redshift @xmath1 splits into two progenitors at time @xmath35 earlier and the probability that one of the progenitors has mass @xmath36 .",
    "implicit in this algorithm is the assumption that the probability of having a progenitor of mass @xmath36 should be equal to that of having one of mass @xmath37 , since the two progenitors must add up to the mass of the final object .",
    "however , in general , the progenitor mass distribution given by the eps theory does not respect this symmetry . in fact , only in the case of poisson initial conditions ( @xmath38 with @xmath39 ) is this symmetry reproduced by the eps theory ( e.g. * ? ? ?",
    ". only in this one special case is the tree generating algorithm in @xcite exact and the average properties of the merger trees it produces are in exact agreement with the conditional mass functions produced by the eps theory . for the case of poisson initial conditions , algorithms for generating merger trees",
    "were first presented by @xcite and @xcite , while @xcite computed analytic expressions for the higher order moments of such trees .",
    "for the more relevant cases such as the @xmath0cdm model we investigate here , the inconsistency of the monte - carlo algorithm with the eps theory causes the progenitor mass function to evolve with redshift a little more rapidly than it should .",
    "we illustrate this below by comparing the conditional mass functions of eps theory both with the ms results and with those derived from the monte - carlo algorithm .",
    "in the following subsections we look at a variety of statistics that probe complementary aspects of the merger statistics of forming dark matter halos .      fig .",
    "[ fig : cmf ] shows the conditional mass functions at redshifts @xmath40 and  @xmath41 , for halos which at redshift @xmath42 , have mass @xmath43 , @xmath44 and @xmath45  m@xmath20 .",
    "we choose these three mass bins , separated by @xmath46 in mass , to span the dynamic range of the ms . in each bin",
    ", we average over halos within a factor of @xmath47 of the central mass . in order of increasing mass ,",
    "this gives samples of @xmath48 , @xmath49 and  @xmath50 halos in the three bins .",
    "the fraction plotted on the @xmath51-axis is the fraction of the final halo mass that is in progenitors of mass @xmath36 per unit bin in @xmath52 .",
    "plotted on the @xmath53-axis is @xmath54 which avoids the histograms being smoothed due to the variation in @xmath55 .",
    "the @xmath22  particle mass resolution limit of the ms is indicated in each panel by the vertical dotted line .",
    "the n - body results are truncated below this mass , but this truncation is not completely sharp because of the range of @xmath55 used in each sample . in a completely hierarchical model , @xmath36 should always be less than @xmath55 , but there are rare occasions in the ms where a progenitor looses mass .",
    "this can occur when two halos are in the process of merging and they are temporarily linked by the fof algorithm .",
    "most of these cases are identified and removed by the more complicated merger tree building algorithm used with the semi - analytic galaxy formation models , but here , with the simple fof scheme , they give rise to two populated bins with @xmath56 at @xmath57 .",
    "the solid curves show the analytic predictions of the eps theory , @xmath58^{3/2 } } } \\ , \\times } & & \\nonumber \\\\ & & \\displaystyle { \\exp\\left [ - \\frac{1}{2 } \\frac{(\\delta_1-\\delta_2)^2}{(\\sigma_1 ^ 2-\\sigma_2 ^ 2)}\\right ] \\left\\vert \\frac{d\\ln\\sigma}{d\\ln m_1 } \\right\\vert \\ , d\\ln m_1 } , \\label{eq : cmff}\\end{aligned}\\ ] ] where @xmath59 is the threshold for collapse at the redshift being considered and @xmath60 the corresponding threshold at redshift @xmath2 .",
    "the amplitude of the rms density fluctuations smoothed on scales @xmath36 and @xmath55 are denoted as @xmath61 and @xmath62 respectively . in @xcite this formula",
    "was derived by a very simple coordinate transformation and can be written neatly as @xmath63 where @xmath64 and @xmath65 is as defined in equation  ( [ eq : ps ] ) .    at low redshift",
    ", the ms conditional mass functions peak close to @xmath66 and are narrow with steep low mass tails . at increasingly high redshift ,",
    "the distributions peak at smaller ratios of @xmath67 and broaden with shallower , more extended low mass tails  though these are truncated by the mass resolution of the simulation .",
    "these general features are all reproduced by the eps formalism , but there is a general trend for the theory to predict both too large a tail of low mass progenitors and to evolve too rapidly with redshift .",
    "thus , by redshift @xmath68 , the eps formalism significantly underestimates the mass fraction in high mass progenitors .",
    "this difference in the rate of evolution predicted by the eps formalism and found in n - body simulations has been noted previously ( e.g * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "recently @xcite , who compared the eps prediction with results from the virgo simulation of @xcite , have argued that the slower evolution is consistent with the elliptical collapse model of @xcite .",
    "the dashed curves show the conditional mass function found by analysing an ensemble of merger trees generated with the galform monte - carlo algorithm . in each case , a set of @xmath69 halos was generated with final masses spanning a factor of @xmath47 either side of the central value and weighted by their expected abundance . when generating the merger trees , the mass resolution of the algorithm , @xmath70 , was set to the mass corresponding to @xmath22  particles so as to match approximately the mass resolution of the simulation .",
    "the monte - carlo algorithm is very fast and so higher resolution trees can easily be generated . in this case , for high masses , the mass functions are identical to the ones plotted in fig .  [",
    "fig : cmf ] , but instead of rolling over at low mass they continue with a near power - law slope which matches that of the corresponding eps curves . for low redshift ,",
    "the plotted monte - carlo mass functions are in excellent agreement with the eps formalism , but at higher redshifts they progressively underestimate more and more the abundance of the most massive progenitors which were already underestimated by the eps formalism .",
    "this shortcoming is well known and its effects on the properties of semi - analytic model galaxies at high redshift are often ameliorated by starting the construction of the merger trees of such galaxies at the redshift at which they are observed rather than at @xmath2 or , as in @xcite and @xcite , by modifying the collapse threshold , @xmath60",
    ".     expressed in terms of the variable @xmath64 .",
    "the linked triangles , squares , pentagons and hexagons are the data from redshifts @xmath71 , @xmath72 , @xmath8 and @xmath41 respectively . in the top panel",
    "these scaled conditional mass functions are plotted logarithmically and compared to analytic functions .",
    "the solid curve is the eps prediction , the dashed curve is the sheth - tormen mass function and the dotted curve is the global fit , @xmath73 ( equation  [ eq : cmf_fit ] ) . the lower panel shows the ratio of each of the n - body estimates to the global fit , @xmath73 , on a linear scale , width=321 ]    fig .  [ fig : scmf ] shows all the conditional mass functions of fig .",
    "[ fig : cmf ] as a function of the variable @xmath64 . for each curve ,",
    "the two lowest mass bins of fig .",
    "[ fig : cmf ] , which are effected by the mass resolution of the simulation , are not plotted .",
    "also , any occupied bins where @xmath56 are ignored as @xmath74 as @xmath75 . in the eps formalism the conditional mass functions expressed in terms of this variable are universal .",
    "the eps prediction is just @xmath76 and is shown by the solid curve .",
    "we see that the ms curves are not truly universal in that there is significant real scatter in this plot",
    ". however , the majority of the curves scatter around quite a tight locus which , however , is not well fit by the eps curve .",
    "the dashed curve in fig .  [ fig : scmf ] shows the function @xmath77 \\nu \\exp(-a \\nu^2/2 ) , \\label{eq : st}\\ ] ] with @xmath78 , @xmath79 and @xmath80 .",
    "if this function is used instead of @xmath81 in equation  ( [ eq : mf ] ) , the result is the @xcite mass function which provides an excellent match to the mass function found in a wide range of n - body simulations @xcite .",
    "@xmath82 is not intended to be used as a model for the conditional mass function because the elliptical collapse model which motivates its form breaks the symmetry which we have invoked in writing the conditional mass functions as a function of @xmath83 ( see section  2.5 of * ? ? ?",
    "nevertheless , it is interesting to see whether , when abused in this way , it provides a good model . examining fig .",
    "[ fig : scmf ] , we see that it does better than eps at fitting the peak of the scaled conditional mass function , but it is too high at low @xmath83 .",
    "the dotted curve in fig  [ fig : scmf ] , labelled ` global fit ' , shows the fitting function , @xmath84 while the factor @xmath85 in the exponential does not seem natural for gaussian initial conditions , this was the simplest functional form we tried that sucessfully reproduces the low-@xmath83 power - law slope found in the ms and the position and sharpness of the high-@xmath83 peak and cutoff .",
    "the results of using this function instead of @xmath86 in equation  ( [ eq : cmf ] ) are shown by the dotted curves in fig .",
    "[ fig : cmf ] .",
    "we see that over the mass and redshift range probed , this function provides quite a good fit to all the conditional mass functions in the ms and is a very significant improvement over the predictions of eps formalism .",
    "the @xmath87 and @xmath88 functions both satisfy the normalization property , @xmath89 but , for this fitting formula , @xmath90 this means that @xmath91% of the mass is not accounted for by this model of the progenitor mass function . since @xmath92 is just a fit over the range @xmath93 this could mean that the true function becomes shallower for @xmath94 or that some fraction of the mass is accreted as a truly smooth component . for many applications this distinction is of little importance .    , at redshifts @xmath95 and  @xmath41 , compared with the scaled mass functions computed by combining two models of the conditional mass function in equation ( [ eq : mf_constraint ] ) with the sheth - tormen mass function at redshift @xmath42 . in each panel ,",
    "the dashed curve is the sheth - tormen mass function .",
    "the solid curve is the result of using the eps conditional mass function and the dotted curve the result of using our fit , @xmath73 .",
    "the upper panel shows redshift @xmath68 and the lower panel @xmath95 .",
    ", width=321 ]    in a self - consistent model , the overall mass function @xmath26 and the conditional mass function @xmath96 must satisfy the constraint equation @xmath97 in other words , the total fraction of mass at the earlier epoch , @xmath98 , in halos of mass @xmath36 must equal the fraction of mass of progenitors of mass @xmath36 coming from all the halos of mass @xmath55 at the later epoch , @xmath99 .",
    "for the eps formalism , equations ( [ eq : mf ] ) and ( [ eq : cmff ] ) , this is exactly true . if one considers scale - free models , i.e. a flat @xmath100 model with power - law initial conditions , @xmath101 , then self - similarity ( e.g. see * ? ? ?",
    "* ) requires that this constraint equation can be written in the form @xmath102 where @xmath103 and @xmath104 are as defined earlier . in general",
    ", the form of the function @xmath105 could depend on the slope of the power spectrum , and hence on @xmath106 , but one might hope this dependence is very weak in just the same way that the overall mass function , @xmath26 , is , to a very good approximation , universal when expressed as @xmath107 @xcite . in seeking a universal conditional mass function in terms of the variable @xmath83 , we are making the additional assumption that @xmath108 can be replaced using the following substitution : @xmath109 where @xmath83 can be expressed as @xmath110 .",
    "this assumption , motivated by the extended press - schechter case , is not guaranteed to be true even in the self - similar case .",
    "nevertheless , it is interesting to see how close our fitted universal conditional mass function , equation  ( [ eq : cmf_fit ] ) , comes to satisfying the constraint , when combined with the accurate sheth - tormen formula , equation  ( [ eq : st ] ) , for both @xmath111 and @xmath112 .",
    "note that in this case the constraint can be written as @xmath113 which has no dependence on the form of @xmath29 and hence no dependence on the power spectrum .",
    "thus , if one were to find a function , @xmath114 , that satisfied this equation , it would produce a self - consistent conditional mass function for all power spectra and redshifts . here",
    ", we merely examine the result of adopting the @xmath73 that we have found empirically by fitting to the ms data .",
    "the fact that @xmath73 does not satisfy the normalization constraint of equation  ( [ eq : norm ] ) implies that it can not satisfy equations ( [ eq : mf_constraint ] ) or ( [ eq : smf_constraint ] ) for all @xmath115 .",
    "however , this does not necessarily prevent it from being accurate and self - consistent for the more massive progenitors , which are inherently the most interesting .    in fig .",
    "[ fig : mf_test ] we perform this comparison .",
    "the mass functions at the epochs @xmath95 and  @xmath41 are plotted in terms of the scaled variable @xmath103 . in this variable ,",
    "the sheth - tormen mass function is the same at all redshifts and for all power spectra .",
    "these mass functions are compared with the result of computing @xmath111 from equation  ( [ eq : smf_constraint ] ) using both the eps conditional mass function and our global fit .",
    "we see that neither is fully consistent , but that our fit does a better job of matching the sheth - tormen curve than using the eps formula and is particularly good for the highest masses ( high @xmath103 ) .",
    "experimentation showed that it is possible to find a modified @xmath114 that leads to results more consistent with the sheth - tormen mass function , but in that case @xmath114 produces noticeably poorer matches to the ms conditional mass functions plotted in fig .",
    "[ fig : cmf ] .",
    "we take this as an indication that in reality the conditional mass function is not strictly universal and that the ansatz  ( [ eq : ansatz ] ) is an imperfect approximation .",
    "however , it remains true that our fitting function , equation  ( [ eq : cmf_fit ] ) , is a good approximation to the ms results over the mass and redshift range probed in fig .",
    "[ fig : cmf ] and that , when applied to all masses , it continues to produce results that are more self - consistent than using the equivalent eps formula , as indicated in fig .",
    "[ fig : mf_test ] .",
    "we would expect this improvement over the eps formula to continue to hold for all variants of the @xmath0cdm model and even for hierarchical models with very different power spectra .",
    "-1 cm          although the conditional mass functions discussed above are interesting functions which can be modelled analytically , often of more importance in galaxy formation models are the properties of the most massive progenitors of a given halo .",
    "fig  [ fig : mpmf ] shows the mass distribution of the first and second most massive progenitors for the same final halo masses and redshifts as in fig .",
    "[ fig : cmf ] .",
    "these mass functions are subsets of the overall conditional mass function in the sense that @xmath116 .",
    "the functions @xmath117 and @xmath118 can easily be related to the probability distributions for the masses of the first and second ranked progenitors .",
    "for instance , for a halo of mass @xmath55 at redshift @xmath42 , the probability that its most massive progenitor at redshift @xmath98 has mass @xmath36 in the interval @xmath119 is proportional to @xmath120 .    in the ms",
    "we see normal hierarchical behaviour with the typical mass of both the first and second most massive progenitors decreasing with redshift .",
    "this rate of decrease is greatest for the halos with the largest present day mass , i.e. for high @xmath121 halos ( where as usual the characteristic mass , @xmath122 , is defined by @xmath123 ) .",
    "it is striking that the mass distribution of the 1st ranked progenitors becomes very narrow at high redshift for high mass descendants .",
    "however , this is to be expected when the most massive progenitor is much less massive than the final object ",
    "one has many progenitors to choose from and the most massive one will always be close to the upper mass exponential cut off of the distribution . by comparing to the dotted curves , which show the `` global fit '' to the total mass functions of fig .",
    "[ fig : cmf ] , we can see the mass ranges over which the first and second most massive progenitor make the dominate contribution to the overall conditional mass functions .",
    "the dashed curves show the corresponding results for the galform monte - carlo merger trees .",
    "these agree very well with the ms at low redshift .",
    "the typical widths of the distributions of both the first and second ranked progenitors and the relative masses of their peaks all exhibit similar mass and redshift dependence to the simulation . however , as was the case for the overall conditional mass function , the evolution of the typical mass with redshift is too rapid . at redshift @xmath68 the typical mass of both the first and second ranked progenitor is about a factor two less than the corresponding mass found in the ms .      in relating observations of the high redshift universe to the present day",
    "one would often like to know where , for a given class of observed high redshift object , will their descendant reside today .",
    "one step towards answering this question is to quantify the fate of high redshift halos in terms of the halos into which they become incorporated by the present day .",
    "thus , we have selected halos of mass @xmath36 at redshift @xmath98 and followed their merger histories until the present , @xmath42 , and for each one recorded the final halo mass @xmath55 .",
    "fig  [ fig : fmf ] shows the probability distribution , @xmath124 , that this final mass is in a given range of @xmath125 and is plotted for initial redshifts @xmath126 and  @xmath41 and initial masses @xmath127 , @xmath128 and  @xmath129  m@xmath4 . for low redshifts",
    "@xmath98 , the distributions have the form of a peak around the original halo mass plus a shoulder extending up to the mass of the highest mass halos present at @xmath2 . as the redshift increases the low mass peak declines and the shoulder grows until it dominates the distribution .",
    "these general features are reproduced well by both the eps formalism and the galform monte - carlo algorithm whose distributions are shown , respectively , by the solid and dashed curves on fig  [ fig : fmf ] , but both have shoulders that slope somewhat more steeply than those of the ms distributions .",
    "consistent with the mismatch that was noted between the galform and eps distributions in fig  [ fig : cmf ] , we see that the galform distributions are shifted slightly to higher masses than the corresponding eps distribution .",
    "this eps prediction for the probability @xmath124 is simply proportional to the fraction of mass that is in halos of mass @xmath36 at @xmath98 that ends up in halos of @xmath55 at @xmath99 and can be computed using the probability product rule @xmath130 @xcite . using the notation defined above this",
    "can be written as @xmath131 it is interesting to see the effect of replacing @xmath76 with the fitting function that we obtained for the conditional mass function ( equation  [ eq : cmf_fit ] ) and the other two occurrences of @xmath65 with sheth & tormen s fit to the mass function .",
    "the resulting distribution @xmath132 is shown by dotted curves shown in fig .  [ fig : fmf ] . while not perfect , this function is in distinctly better agreement with the ms results than the eps formalism and should serve as a useful analytic description of the fate of high redshift dark matter halos in @xmath0cdm models .    .",
    "the solid curves show the distributions for the ms halos and the dashed curves the corresponding distributions from the galform monte - carlo algorithm .",
    ", width=321 ]     as a function of redshift for halos within a factor of two of the final masses @xmath43 , @xmath133 and  @xmath134  m@xmath4 .",
    "the heavy solid curve shows the median rates for @xmath135 and the outer lighter solid curves indicate the 20 and 80 percentiles of the distribution .",
    "the heavy and light dashed curves shows the corresponding results for the galform monte - carlo method .",
    ", width=321 ]      major mergers of comparable mass halos and comparable mass galaxies play an important role in many galaxy formation models .",
    "such mergers are usually invoked to explain the formation of galactic bulges and elliptical galaxies .",
    "the frequency and redshift distribution of major mergers are of particular interest .",
    "[ fig : maj_merg ] shows the distribution , for halos of final mass @xmath55 , of the redshift at which their most massive progenitor most recently underwent a merger with another halo of mass greater than @xmath136 times its own mass .",
    "the distribution is broadest for low mass halos , such that , for halos of mass @xmath137m@xmath4 , 10% have a major merger at @xmath138 while another 10% have not had one since @xmath139 . as the mass of the final halo increases",
    ", the most recent major merger tends to occur more and more recently although even for halos of mass @xmath140  m@xmath4the redshift distribution is still quite extended .",
    "the dashed lines in fig  [ fig : maj_merg ] show the corresponding predictions of the galform monte - carlo algorithm .",
    "while the mass dependence of the widths of the distributions is reproduced , the predictions differ significantly from the ms results .",
    "the monte - carlo algorithm significantly overestimates the number of recent major mergers .",
    "this is in the same sense as the overly rapid evolution of the conditional mass functions seen in fig .",
    "[ fig : cmf ] , but is more pronounced .",
    "although in the @xmath0cdm cosmology halos buildup via mergers , the mass distribution of the merging fragments is very broad and even at redshift @xmath2 a significant fraction of a halo s mass is accreted as small objects .",
    "the statistics on which we have focused above stress the role of the more massive progenitors in a halo merger tree , but sometimes the lower mass progenitors can bring in significant amounts of mass and play an important role .",
    "* for instance , accretion rates derived from the eps formalism were computed by @xcite and compared to high redshift n - body simulations by @xcite with the aim of obtaining accretion rates onto supermassive black holes and studying reionization . also , * if photoionization prevents cooling and consequently star formation in halos below a certain mass ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ) , then the accretion of such low mass halos can be an important source of primordial unenriched material . in fig .",
    "[ fig : accr ] we plot a normalized accretion rate as a function of redshift for halos of various final masses .",
    "we have set a mass threshold of @xmath135 times @xmath55 and consider the accretion of mass in all halos below this threshold onto halos with masses greater than this threshold .    in fig .",
    "[ fig : accr ] , we see some significant differences between the results for the galform monte - carlo algorithm and the ms merger trees",
    ". both sets of trees show the same trend for the accretion to be more concentrated at low redshifts for the highest mass halos .",
    "the median accretion rates of the two sets of trees are in good a agreement at intermediate redshifts , but the mc algorithm underpredicts the accretion at both high and low redshift .",
    "however , we note that estimating this statistic from the ms is problematic . as noted earlier , for our simple fof merger trees , there are occasions when halo growth is not hierarchical and halo masses can go down as well as up .",
    "for instance , this can happen when halos are temporarily linked by the fof algorithm before splitting apart and then perhaps merging again later on .",
    "since we are plotting a differential statistic this `` noise '' does not average out over time . as noted in the discussion of fig .",
    "[ fig : cmf ] , the problem is largely confined to low mass halos , but since we are focusing here on the lowest mass halos it can have a significant effect .",
    "in fact , the reason that no 20 percentile line is visible in the upper panel of fig .  [",
    "fig : accr ] is that for these low mass merger trees 20 per cent loose mass in a given time step .",
    "the millennium simulation ( ms , * ? ? ? * ) is a powerful resource for the statistical study of the hierarchical growth of structure . for ease of reproduction and clarity of definition",
    ", we have studied halos defined by the friends - of - friends group finding algorithm @xcite with a linking length parameter @xmath23 . for these halos",
    "the statistics we have presented represent a comprehensive summary of their formation histories and are all available in electronic form at http://star-www.dur.ac.uk/@xmath141cole/merger_trees .",
    "their comparison with the predictions of extended press - schechter ( eps ) formalism and the galform monte - carlo extension are illuminating .",
    "all the models to which we compare the simulation data make the assumption that halo merger histories depend solely on the final halo mass and not on any additional property such as its environment .",
    "however , previous studies of the ms @xcite have shown that this is not the case . @xcite",
    "found that the two - point correlation function of halos of a given mass depends on halo formation time , while @xcite reached a similar conclusion using a marked correlation function analysis to probe the environmental dependence of halo formation time ( see also * ? ? ?",
    "nevertheless , for many applications it is adequate to ignore such dependencies and merely have a model that fits the mean statistics averaged over all environments .",
    "for instance , the prediction of galaxy luminosity functions and how they evolve with redshift does not require modelling the environmental dependence .",
    "on the other hand , the environmental dependence of halo merger trees is important when making predictions of halo or galaxy clustering @xcite , although the effects are weak for all but special subsets of galaxies . even in these cases",
    ", there are techniques that allow one to make use of the average merger trees studied here ( e.g. by using an effective mass that is modulated by environment * ? ? ?",
    "the eps theory represents the only fully analytic model of the hierarchical growth of structure .",
    "while its derivation requires making several gross approximations and assumptions @xcite , it is remarkable that it captures well the qualitative dependences of progenitor mass distributions on redshift and final halo mass and of final halo mass distributions on initial progenitor mass and redshift .",
    "however , its accuracy is not sufficient for the present era of precision cosmology .",
    "for example , at high redshift , @xmath142 , it can underestimate the typical progenitor mass by factors of @xmath143 or @xmath41 , or equivalently the abundance of the most massive progenitors by factors of a few ( see fig .",
    "[ fig : cmf ] ) .",
    "hence , just as the fits of @xcite and @xcite have become the descriptions of choice for the halo mass function , there is now a need for a more accurate description of these conditional mass functions .",
    "the analytic fitting function we have presented here largely achieves this .",
    "while the conditional mass functions when expressed in the scaling parameter , @xmath144 , do exhibit systematic deviations from a universal form , the deviations are relatively small . in particular , their scatter is smaller than the systematic offset between them and the eps prediction . hence , adopting our fit and using it as a universal conditional mass function results in quite accurate reproductions of all the halo conditional progenitor and descendant mass distributions .",
    "although this fit was made using just one @xmath0cdm simulation and so is probably not optimal for models with significantly different power spectra , we would still , even in these cases , expect it to be a significant improvement over the eps theory .",
    "realizations of individual halo merger trees or predictions of more complex statistical properties of halo merger trees can not be made using eps theory ( or our fitted universal conditional mass function ) without making additional assumptions and approximations . in the case of the galform monte - carlo algorithm , whose trees",
    "we have compared with those of the ms , these additional assumptions prevent it from being fully self - consistent with the eps theory .",
    "the root of this inconsistency is the asymmetry in the predicted merger rate of halos of mass @xmath27 and @xmath145 when forming a halo of mass @xmath55 @xcite that is implicit in the eps formalism .",
    "the practical consequence of this is that the typical halo mass in the monte - carlo trees evolves more rapidly with redshift than the corresponding eps prediction .",
    "this increases the discrepancy between the conditional mass functions of the model and those of the ms .",
    "this is the main shortcoming of the galform monte - carlo algorithm , as in other statistical properties that can not be predicted by the pure eps theory , it continues to provide a good qualitative description of the ms halo statistics .",
    "for instance , the distributions of the first and second most massive progenitors have shapes , widths and relative positions that mirror well those of the ms , but are systematically displaced to lower masses at high redshift .",
    "overcoming this one shortcoming of the algorithm would produce much better agreement with the simulation results .",
    "however , the task of defining a fully self - consistent algorithm is extremely challenging @xcite . instead , in @xcite",
    ", we will take a more pragmatic approach and explore whether minor modifications to the galform monte - carlo algorithm can produce a better match to the ms data .",
    "we thank simon white and the referee , ravi sheth , for comments that improved the paper .",
    "the millennium simulation used in this paper was carried out as part of the programme of the virgo consortium on the regatta supercomputer of the computing centre of the max - planck - society in garching .",
    "data for the halo population in this simulation , as well as for the galaxies produced by several different galaxy formation models , are publically available at http://www.mpa-garching.mpg.de/millennium and under the `` downloads '' button at http://www.virgo.dur.ac.uk/new .",
    "this work was supported in part by the pparc rolling grant for extragalactic and cosmology research at durham .",
    "csf acknowledges a royal society wolfson research merit award ."
  ],
  "abstract_text": [
    "<S> we present a comparison of the statistical properties of dark matter halo merger trees extracted from the millennium simulation with extended press - schechter ( eps ) formalism and the related galform monte - carlo method for generating ensembles of merger trees . </S>",
    "<S> the volume , mass resolution and output frequency make the millennium simulation a unique resource for the study of the hierarchical growth of structure . </S>",
    "<S> we construct the merger trees of present day friends - of - friends groups and calculate a variety of statistics that quantify the masses of their progenitors as a function of redshift ; accretion rates ; and the redshift distribution of their most recent major merger . </S>",
    "<S> we also look in the forward direction and quantify the present day mass distribution of halos into which high redshift progenitors of a specific mass become incorporated . </S>",
    "<S> we find that eps formalism and its monte - carlo extension capture the qualitative behaviour of all these statistics but , as redshift increases they systematically underestimate the masses of the most massive progenitors . </S>",
    "<S> this shortcoming is worst for the monte - carlo algorithm . </S>",
    "<S> we present a fitting function to a scaled version of the progenitor mass distribution and show how it can be used to make more accurate predictions of both progenitor and final halo mass distributions .    </S>",
    "<S> cosmology : theory , cosmology : dark matter , methods : numerical </S>"
  ]
}