{
  "article_text": [
    "many properties of magnetic systems can be understood at the classical level by studying their magnetic structure and behavior on the sub - micron lengthscale ( micromagnetics ) or atomistically ( atomistic spin dynamics @xcite ) . in these approaches ,",
    "the dynamics of the microscopic magnetic moments is described by the landau ",
    "lifshitz  gilbert ( llg ) equation @xcite .",
    "the various competing interactions ( exchange , anisotropy , dipolar , zeeman ,   )  in micromagnetic models often result in a rich energy landscape with multiple local energy minima and hysteresis @xcite .",
    "nontrivial magnetic configurations may be very stable , for instance if they contain topological defects such as domain walls or magnetic skyrmion bubbles @xcite .",
    "it is often useful to study the dynamics of small - amplitude deviations from a given magnetic equilibrium configuration ( linearization ) .",
    "the eigenmodes of the linearized llg equation are known as magnetic normal modes . in homogeneous systems ,",
    "the magnetic normal modes are spin waves , which propagate through the material @xcite .",
    "the presence of inhomogeneities , whether intrinsic ( lattice defects , boundaries ) or configurational ( domain walls , skyrmions ) , changes this picture .",
    "such defects do not only affect the dynamics of the spin waves ; they also often give rise to special low - energy normal modes that are _ localized _ near the defect @xcite .",
    "the modes localized on configurational defects are particularly interesting .",
    "they provide valuable insight into the dynamics of domain walls @xcite and other topological defects , a sound understanding of which will be important for the development of novel magnetic - storage technologies such as racetrack memory @xcite .",
    "the low - energy modes also provide a channel for dissipation @xcite .",
    "microscopic magnetic elements , such as ferromagnetic rings , are another class of systems with potential for technological application @xcite .",
    "the spin - wave mode spectrum of these elements can be determined experimentally using magnetic - response measurements or brillouin light scattering , providing a very direct test of micromagnetic models @xcite .",
    "while exact or approximate analytical solutions of the magnetic normal - mode problem do exist in certain special cases @xcite , in general it can be solved only numerically . in some cases ,",
    "the magnetic normal modes can be obtained by a ` brute - force ' method : numerically integrating the llg equation over a certain time interval and performing a fast fourier transformation ( fft ) in the time domain @xcite . while in principle effective , this approach is limited to relatively small systems by the large amounts of cpu power and memory storage it requires , especially if a good frequency resolution is to be achieved ( long simulation times ) .",
    "moreover , it requires some manual tuning ( reasonable settings for the initial amplitudes and sampling frequencies ) and it fails to detect zero - frequency and degenerate modes . in this work",
    ", we present a direct numerical procedure that can be used to find the magnetic normal modes of any spin system near any given equilibrium configuration ( more precisely , near any local energy minimum ) .",
    "it can deal efficiently and scalably with any type of interaction , including long - range interactions , and does not assume that the material is homogeneous or that the equilibrium configuration is collinear @xcite .    an efficient approach should somehow be based on a direct calculation of the eigenvectors and eigenvalues of the dynamical matrix that results from linearization of the llg equation @xcite",
    ". however , we shall see that this dynamical matrix is not necessarily diagonalizable , so that eigenvectors in the usual sense may not even exist .",
    "diagonalizability can only be guaranteed if no zero - frequency modes ( zero modes ) are present . to the best of our knowledge",
    ", this fact has been overlooked in all previous works describing general methods for the magnetic normal - mode problem @xcite .",
    "while there certainly are many cases in which this issue does not occur @xcite , we shall see that zero modes appear in many relevant physical systems . indeed ,",
    "precisely these zero modes are often the most important for the dynamics of topological defects .",
    "for example , we shall see that it is the zero modes that determine whether the dynamics of a topological defect is inertial , and if so , with what effective mass .",
    "our method has a firm basis in the general theory of hamiltonian systems @xcite .",
    "we shall show that the normal - mode problem of an _ arbitrary _ ( conservative ) hamiltonian system at a local energy minimum can be cast in the form of a _ hermitian definite generalized eigenvalue problem _ ( hdgep ) @xcite , @xmath0 , where the matrices @xmath1 and @xmath2 are hermitian and @xmath2 is positive definite , which can be solved particularly efficiently .",
    "the most popular methods for large eigenvalue problems ( lanczos , conjugate - gradient nonlinear optimization ,   )  require the problem to be of this form . important features of these methods are that they operate in an incremental fashion ( the lowest modes are calculated first ) and that they can be implemented in a matrix - free manner @xcite ( they are krylov - subspace methods @xcite ) .",
    "these features make the hdgep methods considerably scalable .",
    "first , the low modes of a very large system , which are often the most physically relevant , may be obtained without solving the full eigenvalue problem for all eigenvectors , which would obviously take at least @xmath3 time .",
    "second , it is not necessary to store the interaction matrix in explicit form , which will contain @xmath3 nonzero values if the long - range dipolar interactions are taken into account .",
    "it is sufficient to provide a routine that evaluates the forces or torques for any given specific configuration .",
    "when implemented using fft or multigrid techniques , such a routine can run in @xmath4 instead of @xmath3 time @xcite .",
    "we obtain a solution method for the normal - mode problem of the conservative ( zero damping ) spin system as an immediate special case of our method for general hamiltonian systems .",
    "a similar reduction of the conservative magnetic normal - mode problem to the hdgep was proposed in ref .",
    "[ ] by assuming , wrongly , that the hessian matrix of a function is always positive definite at a local minimum .",
    "a particular strong point of our approach is that it also works if the hessian matrix of the hamiltonian at the equilibrium configuration is not positive definite but merely positive semidefinite ( also called nonnegative definite ) , as it is in the presence of zero modes .",
    "an additional advantage of our method is that it may be used directly in cartesian coordinates , in which the micromagnetic hamiltonians normally take a very simple form ( often quadratic ) .",
    "we do not need to go over to spherical coordinates , which are more computationally expensive and have singularities at certain points .    for the spin system with damping ,",
    "we derive explicit expressions for the normal modes by treating the damping term of the llg equation as a perturbation . in this way",
    "we can obtain the damped modes and decay rates to a good approximation without the need for solving non - hermitian eigenvalue problems .",
    "this paper is organized as follows . in sec .",
    "[ sec : hamsysbrief ] , we state some general properties of the normal modes of linearized hamiltonian systems that are essential for what follows .",
    "here we introduce the nomenclature of _ special _ and _ inertial _ zero modes and specify their distinct dynamics . a more detailed discussion is provided in the appendix . in sec .",
    "[ sec : spincons ] , we make the definitions of sec .",
    "[ sec : hamsysbrief ] explicit for the conservative spin system .",
    "section  [ sec : redhdgep ] then shows how the normal - mode problem of a hamiltonian system , such as the conservative spin system , near a local energy minimum can be reduced to the hdgep .",
    "we specifically show how to deal with zero modes in a robust way .",
    "we present perturbative expressions for the spin system with damping in sec .",
    "[ sec : spindamped ] .",
    "section  [ sec : implementation ] explains how the method can be efficiently implemented in a computer code .",
    "section  [ sec : examples ] provides examples of magnetic normal modes in various spin systems , highlighting some key features of magnetic normal modes . in subsec .",
    "[ sec : inertial ] , we focus on the two qualitatively different types of effective dynamical behavior ( inertial and noninertial ) that may be found when a magnetic equilibrium configuration containing some ( topological ) defect is perturbed by an external force .",
    "we show how a normal - mode analysis that includes zero modes immediately provides the equations of motion and effective masses of such magnetic structures .",
    "section  [ sec : summary ] summarizes our results .",
    "this section states some results from the theory of hamiltonian systems that are essential for the following sections . in particular",
    ", we introduce our nomenclature for the three types of normal modes ( positive , special zero , inertial zero ) that may appear in systems with a positive semidefinite hamiltonian .",
    "a more thorough discussion with explanations and references is provided in the appendix .",
    "let us consider a time - invariant dynamical system near an equilibrium point , which we take to lie at @xmath5 .",
    "its equation of motion is given by @xmath6 where @xmath7 represent a nonsingular system of coordinates and the dot denotes the time derivative . our goal is to find the eigenvalues and eigenvectors of @xmath8 .",
    "this can not normally be accomplished by a diagonalization of @xmath8 , because    in general , @xmath8 is very large but not symmetric , so that the efficient iterative methods for the hdgep can not be used ; and    @xmath8 might not be diagonalizable at all ( it may be _ defective _ ) .",
    "however , if the dynamical system is a linear or nonlinear hamiltonian system , we shall see that we can bypass these problems by introducing a certain antisymmetric matrix @xmath9 .",
    "the elements of @xmath9 are given by @xmath10 the value at the equilibrium point of the poisson bracket between the coordinates @xmath11 and @xmath12 .",
    "it can be shown ( see appendix ) that for a hamiltonian system , the matrix @xmath8 is such that @xmath13 is symmetric .    for certain physical systems ,",
    "hamiltonian dynamics takes place only on a subspace of the space where the coordinates are defined .",
    "an example is the spin system : while a magnetic moment @xmath14 is defined on @xmath15 , its dynamics is restricted to a subset of the form @xmath16 for some @xmath17 .",
    "the dimension of this ` accessible subspace ' ( _ symplectic leaf _",
    "@xcite ) is always even .",
    "for a system of @xmath18 spins in cartesian coordinates , we have @xmath19 , while the dimension of the symplectic leaf is only @xmath20 .",
    "we remind the reader that the _ image space _ of a matrix @xmath21 consists of all vectors @xmath22 that can be written as @xmath23 for some vector @xmath24 ; the dimension of this linear subspace is denoted by @xmath25 .",
    "the image space of @xmath9 , which has dimension @xmath26 , is identical to the tangent space of the symplectic leaf at @xmath5 .",
    "vectors that are not contained in the image space of @xmath9 correspond to an infinitesimal displacement of the system out of the symplectic leaf and are unphysical .",
    "we may thus restrict the matrices @xmath9 and @xmath13 to the image space of @xmath9 .",
    "we shall denote these restricted matrices by @xmath27 and @xmath28 ; that is , we define @xmath29 where @xmath30 is an @xmath31 matrix whose columns form an orthonormal basis of the image space of @xmath9 .",
    "since the image space of @xmath13 is contained in the image space of @xmath9 , these restrictions are well defined and without loss .",
    "notice that the matrix @xmath27 is invertible by definition . in this paper",
    ", we shall implicitly convert between vectors in @xmath32 and vectors in the image space of @xmath9 without writing @xmath30 .",
    "it is unnecessary to explicitly construct @xmath30 in a computer code ( see sec .",
    "[ sec : implementation ] ) .",
    "it can be shown ( see appendix ) that the @xmath33 matrix @xmath28 is the hessian matrix ( the matrix of second - order partial derivatives ) at @xmath5 of the restriction of the hamiltonian @xmath34 to the symplectic leaf ( for a certain parametrization of the symplectic leaf ) . therefore ,",
    "if @xmath5 is a constrained local minimum of @xmath34 on the symplectic leaf , the hessian matrix @xmath28 is guaranteed to be positive _ _ semi__definite .",
    "however , it may not be assumed ( compare ref .",
    "[ ] ) that @xmath28 is also positive definite . to see this , consider the following simple counterexamples with @xmath35 : @xmath36 , @xmath37 and @xmath38 all have minima at @xmath39 but not positive - definite hessians at that point .",
    "color ) fundamental solutions @xmath40 and @xmath41 of the linearized equation of motion corresponding to the three types of normal modes of a hamiltonian system : ( a )  positive , ( b )  special zero and ( c )  inertial zero modes .",
    "the dynamical variables @xmath42 and @xmath43 are the amplitudes of the vectors @xmath44 and @xmath45 respectively , as defined in eq .  .",
    "dashed lines : effect of damping with the indicated decay time @xmath46 ( see sec .  [",
    "sec : spindamped ] ) . ]",
    "if @xmath28 is positive semidefinite , the normal modes of @xmath8 may be of three distinct types ( see appendix ) .",
    "we introduce the following names for these three types of modes .    1 .",
    "a _ positive normal mode _ of @xmath8 is a pair @xmath47 of vectors in the image space of @xmath9 that satisfy @xmath48 for some @xmath49 .",
    "the corresponding fundamental solutions of the linearization of eq .",
    "are ( see fig .",
    "[ fig : fundsols](a ) ) @xmath50 each positive normal mode corresponds to a pair of eigenvectors of @xmath8 .",
    "the eigenvectors are @xmath51 ( eigenvalue @xmath52 ) and @xmath53 ( eigenvalue @xmath54 ) .",
    "a _ special zero normal mode _ is a pair @xmath47 of vectors in the image space of @xmath9 that satisfy @xmath55 the corresponding fundamental solutions are ( see fig .",
    "[ fig : fundsols](b ) ) @xmath56 ( constant functions ) .",
    "a special zero normal mode also corresponds to a pair of linearly independent eigenvectors of @xmath8 ( @xmath44 and @xmath45 ) .",
    "an _ inertial zero normal mode _ is a pair @xmath57 of vectors in the image space of @xmath9 that satisfy @xmath58 the corresponding fundamental solutions are ( see fig .",
    "[ fig : fundsols](c ) ) @xmath59 this type of mode results from a nondiagonalizable ( defective ) matrix @xmath8 .",
    "technically , an inertial zero mode corresponds to a jordan block of size @xmath60 in the jordan normal form of @xmath8 .",
    "the nomenclature chosen for the three types of modes ( positive , special and inertial ) is explained below .",
    "notice that different types of modes may have different units : for an inertial zero normal mode @xmath61 has units of time , while for a positive normal mode @xmath61 is dimensionless . since each mode contains two vectors , the total number of independent modes @xmath18 is one half of the dimension of the symplectic leaf . if @xmath28 is positive definite , all normal modes are positive normal modes",
    ".    we may write the vectors that make up a normal mode as @xmath62 for certain vectors @xmath63 and @xmath64 in the image space of @xmath9",
    ". section  [ sec : redhdgep ] presents an efficient procedure by which suitable vector pairs @xmath65 may be found .",
    "all normal modes can and should be chosen to satisfy the relations    @xmath66    where @xmath67 index the modes . as a result",
    ", we may decompose an arbitrary vector @xmath22 in the image space of @xmath9 in terms of the normal modes as @xmath68 \\text{.}\\ ] ] using the fundamental solutions , and , such a decomposition immediately yields a solution of the initial - value problem for eq .   in the linear approximation .",
    "given a state vector @xmath69 the quadratic part of the hamiltonian is given by @xmath70 where the first sum is taken over the positive normal modes and the second sum over the inertial zero normal modes .",
    "special zero modes do not contribute to eq .  .",
    "the variables @xmath71 and @xmath72 in eq .   are canonically conjugate momenta and coordinates ( see appendix ) .",
    "notice that for a given configuration @xmath73 , the values of these momenta and coordinates can be determined , to first order , using eq .  .",
    "we find , in the linear limit , that for a special zero normal mode @xmath74 while for an inertial zero normal mode @xmath75 the latter type of dynamics corresponds ( after a suitable scaling of @xmath71 and @xmath72 ) to the dynamics of a free massive particle , which explains our choice of the name ` inertial zero normal mode ' .",
    "the former type of dynamics does not occur in conventional newtonian systems such as systems of coupled oscillators ( see appendix ) , whence the name ` special zero normal mode ' .",
    "the conservative dynamics of a spin system is described by the llg equation without damping , @xmath76 where @xmath77 represents the magnetic moment with position index @xmath78 , @xmath34 is the hamiltonian , and @xmath79 is a physical constant .",
    "notice that the magnitude @xmath80 of each magnetic moment is constant in time .",
    "these magnitudes are fixed by the physics of the system .",
    "equation   is equivalent to @xmath81 the generalized form of hamilton s equations applied to the ( time - invariant ) variables @xmath82 , for the poisson bracket @xmath83 where greek indices represent cartesian coordinates @xmath84 and @xmath85 is the levi - civita symbol .",
    "thus , the dynamics of the conservative spin system is hamiltonian .    for convenience",
    ", we shall write eq .   as @xmath86\\text{.}\\ ] ] the variable @xmath87 can be seen as a compound vector that assigns to every position @xmath78 a vector @xmath77 .",
    "the square brackets in eq .",
    "denote an elementwise cross product : given @xmath88 , we define @xmath89 \\in \\mathbb{r}^{3n}$ ] such that @xmath90 for each position @xmath91 .",
    "in other words , it is just the ordinary cross product ( vector product ) performed @xmath18 times . for small deviations @xmath92 from some fixed configuration @xmath93 , eq .",
    "becomes @xmath94 + mx + { \\mathcal{o}}({\\| x \\|}^2)\\text{,}\\ ] ] where @xmath95 is the effective field at @xmath93 .",
    "the matrix @xmath8 is given by @xmath96 + \\tilde\\gamma [ h , x ] \\text{,}\\ ] ] where @xmath97 is the @xmath98 hessian matrix of @xmath34 at @xmath93 . to be explicit , let us mention that the elements of @xmath8 are given by @xmath99 ( summation is implied for repeated greek indices but not for repeated roman indices . ) since we work in cartesian coordinates , @xmath21 is typically of a relatively simple form . indeed",
    ", many micromagnetic models use a hamiltonian that is quadratic in the cartesian coordinates , in which case @xmath21 does not depend on @xmath93 .",
    "we assume that @xmath93 is an equilibrium configuration , @xmath100=0 $ ] . as a result ,",
    "is of the form .",
    "the matrix @xmath9 is given by @xmath101 or equivalently , @xmath102\\text{.}\\ ] ] the @xmath20-dimensional image space of @xmath9 consists of vectors @xmath103 for which the displacement @xmath104 is orthogonal at each position @xmath91 to the equilibrium direction @xmath105 .",
    "notice also that the equilibrium effective field @xmath106 must be parallel at each position @xmath91 to the equilibrium direction @xmath105 . combining eqs .   and  , the matrix @xmath13 , which is symmetric ( see sec .  [",
    "sec : hamsysbrief ] ) , is given by @xmath107 + [ h,[m_0,x ] ] \\bigr ) = \\bigl ( \\omega^{\\mathsf{t}}a \\omega + \\tilde\\gamma[h,\\cdot ] \\omega   \\bigr ) x\\text{.}\\ ] ] the second term , which contains @xmath108 , originates from the fact that the hessian matrix @xmath21 is calculated in cartesian coordinates , while the symplectic leaf ( a product of @xmath18 spheres ) is curved .",
    "in this section , we present a method for the normal - mode problem of a general hamiltonian system near a local minimum of the hamiltonian .",
    "this includes the normal - mode problem of the conservative spin system as a special case .",
    "we show that the normal - mode problem can be reduced to the hdgep , in which form it can be efficiently solved ( see sec .",
    "[ sec : implementation ] ) .",
    "our method calculates both the positive modes and any zero modes of the system .",
    "if zero modes are present , the method detects these and automatically determines their types ( special or inertial ) .",
    "the conservative spin system differs from an important subclass of hamiltonian systems , which includes systems of coupled point masses , for which the normal - mode problem can be written as a _",
    "symmetric definite generalized eigenvalue problem _ ( sdgep ) in an obvious way ( see appendix ) .",
    "such hamiltonian systems are defined on a natural set of canonical momenta and coordinates . in terms of these",
    ", the hamiltonian is of the form @xmath109 , where the potential - energy term @xmath110 depends only on the coordinates @xmath111 , while the kinetic - energy term @xmath112 is a positive - definite quadratic function depending only on the momenta @xmath113 ( typically , @xmath114 ) .",
    "the spin system is not of this special form .",
    "all that is given is the poisson bracket and the hamiltonian @xmath115 as a function of the magnetic moments @xmath116 . even though it is possible to construct canonical momenta and coordinates @xcite for this system , an _ a priori _ separation of kinetic energy and potential energy",
    "is not normally known .",
    "we shall first consider the case that @xmath28 is positive definite ( no zero modes ) . later in this section ,",
    "we treat the general case where @xmath28 is positive semidefinite .",
    "this generalization is essential for spin systems such as those discussed in subsecs .",
    "[ sec : inertial][sec : exskyrmion ] .",
    "we remind the reader that an hdgep has the general form @xmath117 where @xmath1 is hermitian and @xmath2 is hermitian and positive definite , which requirements guarantee that all eigenvalues @xmath118 are real . the usual hermitian eigenvalue problem is a special case of the hdgep ( set @xmath119 ) .",
    "if @xmath1 and @xmath2 are real matrices , so that @xmath1 and @xmath2 are symmetric , we use the abbreviation sdgep . the eigenvectors @xmath120 of a hdgep may be chosen to satisfy @xmath121 , a generalized orthonormality relation .",
    "alternatively , we may choose to normalize the eigenvectors @xmath120 in such a way that @xmath122 provided that @xmath1 is invertible , in which case the eigenvalues @xmath118 are nonzero .",
    "let us represent a positive normal mode as a single vector @xmath123 where @xmath63 and @xmath64 are such that @xmath124 it is easy to see that in this notation , a solution of the generalized eigenvalue problem @xmath125 with @xmath126 is also a solution of eq .",
    "( after conversion of the vectors in @xmath32 to vectors in the image space of @xmath9 ) : take real and imaginary parts .",
    "if we _ assume _ that @xmath28 is positive definite , eq .   is a hdgep with @xmath127 , @xmath128 and @xmath129 , since @xmath9 is antisymmetric and @xmath13 is symmetric ( see sec .  [",
    "sec : hamsysbrief ] ) .",
    "the hdgep form makes the problem suitable for efficient numerical computation .",
    "notice that @xmath130 , since @xmath27 is invertible .",
    "notice also that each positive normal mode gives rise to two independent solutions of eq .",
    ": if @xmath131 is an eigenvector with eigenvalue @xmath49 , then @xmath132 is an eigenvector with eigenvalue @xmath133 . by eq .",
    ", we may normalize the eigenvectors so that they satisfy    @xmath134    which equations together are equivalent to eqs .   and  .",
    "equation   can be seen as a generalization of eqs .",
    "2730 in ref .",
    "[ ] , which were given for the normal - mode problem of the conservative spin system , to a general hamiltonian system .",
    "our formulation has the additional advantage that it does not require the use of spherical coordinates . by itself",
    ", the method only works if @xmath28 is positive definite . if @xmath28 is merely positive semidefinite , eq .",
    "is no longer a hdgep .",
    "zero normal modes may appear and the matrix @xmath8 is not even guaranteed to be diagonalizable .",
    "these zero modes have important consequences for the dynamics of , for example , domain walls or skyrmions in magnetic systems ( see subsecs .",
    "[ sec : inertial][sec : exskyrmion ] ) .",
    "we present here a robust scheme that also works in this more general case .",
    "thus , our method can solve the normal - mode problem of _ any _ hamiltonian system linearized at a local minimum of the hamiltonian .",
    "the main idea of our approach is that we first find the special and inertial zero normal modes and then exclude them from the problem .",
    "the algorithm consists of the steps outlined below .",
    "the only two ` large ' ( @xmath20-dimensional ) problems in this procedure are steps  [ itm : findnullspace ] and  [ itm : solvemj ] . in step  [ itm :",
    "findnullspace ] , we need to find the lowest eigenvalues and corresponding eigenvectors of a symmetric matrix . in step  [ itm :",
    "solvemj ] , we need to solve a symmetric linear system . both sub - problems can be efficiently solved using iterative methods .",
    "how this may be done is discussed in more detail in sec .",
    "[ sec : implementation ] .",
    "the diagonalizations in steps  [ itm : diagnullj ] and  [ itm : diagnullmj ] concern small matrices and can be performed using standard routines .    1 .",
    "[ itm : findnullspace ] sequentially find the eigenvectors @xmath135 of @xmath28 that correspond to the lowest eigenvalues ( see sec .",
    "[ sec : implementation ] ) .",
    "stop when an eigenvector appears with an eigenvalue that is larger than zero ( by a certain small tolerance ) .",
    "notice that this is an ordinary ( nongeneralized ) symmetric eigenvalue problem , so that the fact that @xmath28 is not necessarily positive definite is not a problem . by positive semidefiniteness of @xmath28 , all eigenvalues are larger than or equal to zero .",
    "suppose that there are @xmath136 eigenvectors with eigenvalue zero .",
    "then @xmath137 form a basis of the null space of @xmath28 . in most cases",
    ", @xmath136 will be a small number .",
    "remember that thanks to the restriction of @xmath13 to @xmath28 , we have already excluded all null vectors of @xmath13 that are also null vectors of @xmath9 and thus correspond to a displacement of the system out of the symplectic leaf .",
    "[ itm : diagnullj ] define the @xmath138 matrix @xmath139}}_{ij } = y_i^{\\mathsf{t}}\\langle \\omega \\rangle y_j$ ] . since @xmath139}}_{ij}$ ] is antisymmetric , @xmath140}}_{ij}$ ]",
    "is hermitian and can be diagonalized by a standard routine for hermitian matrices , which guarantees that the eigenvectors are orthonormal .",
    "let @xmath141 be the number of independent eigenvectors @xmath142 of @xmath139}}_{ij}$ ] with eigenvalue zero ( up to a small tolerance ) .",
    "we have @xmath143}}_{ij } b_{j(k ) } = 0 $ ] for @xmath144 .",
    "we may take these eigenvectors @xmath142 to be real .",
    "the remaining nonnull eigenvectors come in @xmath145 pairs .",
    "let @xmath146 be an eigenvector of @xmath139}}_{ij}$ ] with eigenvalue @xmath147 , where @xmath148 and @xmath149 and @xmath150 are real .",
    "we have @xmath143}}_{ij } ( c_{j(l ) } + i d_{j(l ) } ) = i\\lambda_{(l ) } ( c_{i(l ) } + i d_{i(l ) } ) $ ] for @xmath151 .",
    "then @xmath152 is an eigenvector with eigenvalue @xmath153 .",
    "the total number of eigenvectors is @xmath154 .",
    "3 .   construct the vectors @xmath155 and @xmath156 for @xmath151 and @xmath157 for @xmath144 .",
    "notice that we have @xmath158 for @xmath159 and @xmath160 .",
    "moreover , for all @xmath161 we have @xmath162 , @xmath163 and @xmath164 .",
    "[ itm : solvemj ] for each @xmath144 , find a vector @xmath165 such that @xmath166 ( see sec .  [ sec : implementation ] ) .",
    "we know that such a vector exists , since by construction @xmath167 lies in the orthogonal complement of the null space of @xmath28 , a symmetric matrix , and hence in the image space of @xmath28 .",
    "although this vector @xmath165 is not uniquely defined , there is a unique solution @xmath165 that lies in the image space of @xmath28 , which is the solution that is obtained by the method given in sec .",
    "[ sec : implementation ] .",
    "[ itm : diagnullmj ] define the symmetric @xmath168 matrix @xmath169}}_{kk ' } = \\bar{a}_k^{\\mathsf{t}}\\langle m\\omega \\rangle \\bar{a}_{k'}$ ] and diagonalize it using a standard routine for symmetric matrices .",
    "let the orthonormal eigenvectors be @xmath170 .",
    "we have @xmath171}}_{ij } g_{j(k ) } = \\mu_{(k ) } g_{i(k)}$ ] with @xmath172 for @xmath144 .",
    "the eigenvalues @xmath173 are positive , since @xmath28 is positive semidefinite and the vectors @xmath165 are independent vectors in the image space of @xmath28 . 6 .",
    "construct the vectors @xmath174 and @xmath175 for @xmath144 . since @xmath176",
    ", we have @xmath177 for @xmath178 and @xmath179 . 7 .",
    "redefine @xmath180 as @xmath181 , @xmath182 as @xmath183 , @xmath184 as @xmath185 and @xmath186 as @xmath187 , where @xmath188 and @xmath189 .",
    "this normalizes the modes so that @xmath190 for each @xmath191 and @xmath192 for each @xmath193 . 8 .",
    "set @xmath194 .",
    "we have @xmath195 for all @xmath196 .",
    "9 .   set @xmath197 .",
    "we have @xmath198 for all @xmath199",
    "[ itm : zeroconclusion ] the pairs @xmath200 are the inertial zero normal modes .",
    "the pairs @xmath201 are the special zero normal modes .",
    "all zero normal modes now satisfy the relations   and  eq .  .",
    "let us define the zero normal modes , of which there are @xmath202 , as the first modes in the list of all modes : set @xmath203 , @xmath204 for @xmath205 and @xmath206 , @xmath207 for @xmath208 .",
    "all normal modes must satisfy the relations   and  , which are equivalent to eqs .   and  .",
    "once the zero normal modes have been obtained , we may thus restrict the generalized eigenvalue problem to trial vectors @xmath209 that satisfy    @xmath210    for all zero normal modes @xmath211 .",
    "these constraints can be implemented in the iterative hdgep solver in a very natural way ( see sec .",
    "[ sec : implementation ] ) . on this subspace , eq .",
    "constitutes an hdgep , so we can efficiently find the remaining modes @xmath212 .",
    "we have seen that the magnetic normal modes of a conservative spin system , which is hamiltonian , can be obtained by solving a hdgep . however , typical magnetic systems can be modeled more realistically using the llg equation @xcite with a nonzero damping parameter @xmath213 , @xmath214 ( compare eq .  ) .",
    "note that some texts write the llg equation with damping in a somewhat different , explicit form @xcite .",
    "the damping term affects the magnetic normal modes and the eigenfrequencies @xmath215 , which now acquire an imaginary part .",
    "our method for the magnetic normal - mode problem can be used even in this nonconservative case if we treat the damping term of the llg equation as a perturbation .",
    "we are justified in doing so , since @xmath216 is often small ( @xmath217 , where @xmath218 is the typical magnitude @xmath219 of the spins ) . in this section ,",
    "we derive expressions for the damped modes in first - order perturbation theory .",
    "in particular , we obtain very simple and elegant first - order expressions   and   for the decay rate of the amplitude of a mode under damping .",
    "decay rates of modes are especially important as they determine the widths of the corresponding peaks in dynamic magnetic susceptibility functions ( see fig .",
    "[ fig : respfunc ] ) , which can be measured .",
    "our expressions for the first - order corrections to the modes also cover those cases where special or inertial zero normal modes are present , or where the unperturbed normal modes are degenerate .",
    "again considering the deviation @xmath220 from a fixed equilibrium configuration @xmath93 in cartesian coordinates ( see sec .  [",
    "sec : spincons ] ) , the llg equation with damping becomes , using that @xmath221 , @xmath222 with @xmath8 and @xmath9 as defined in eqs .   and  .",
    "we can write this in explicit form as @xmath223 , where @xmath224 we see that to first order in @xmath216 , the matrix @xmath225 results from perturbation of @xmath13 by a term @xmath226 . since the llg equation with damping respects the constraint that the magnitude @xmath80 of each magnetic moment be constant , we may still assume that the physically relevant vectors @xmath227 lie in the @xmath20-dimensional image space of @xmath9 .",
    "the presence of ( a not too large amount of ) damping modifies the three types of normal modes as follows .",
    "we use primes for the modes of the damped system .    1 .",
    "a postive normal mode becomes a damped mode of the form @xmath228 the fundamental solutions that correspond to a damped positive mode are @xmath229\\text{,}\\\\ x_2(t ) = e^{-\\xi ' t}\\left [          - \\sin(\\omega ' t)u'_1 + \\cos(\\omega ' t)u'_2\\right]\\text{. } \\end{array}\\ ] ] 2 .",
    "a special zero normal mode remains unchanged in the presence of damping .",
    "3 .   an inertial zero normal mode becomes a damped mode of the form @xmath230 the corresponding fundamental solutions are @xmath231 u_2\\text{,}\\\\ x_2(t ) = u_2\\text{. } \\end{array}\\ ] ] notice that the @xmath45 part of an inertial normal mode remains unchanged in the presence of damping .",
    "equation   is equivalent to eq .   if we replace @xmath8 in eq .   with @xmath232 and @xmath215 with @xmath233 ; it is in this sense that the frequency of a damped positive mode acquires an imaginary part .",
    "notice that with damping , eq .",
    "is no longer a hdgep . as a result",
    ", the damped modes do not necessarily satisfy the relations   and  .    in first - order perturbation theory , we write a damped positive mode as    @xmath234    where @xmath191 is the mode index and @xmath235 , @xmath236 and @xmath237 is the unperturbed normal mode and frequency .",
    "we assume that the vectors @xmath65 of all unperturbed normal modes satisfy the relations   and  .",
    "moreover , we assume that if any of the unperturbed normal modes are degenerate , they satisfy certain additional conditions ( stated below ) . using these assumptions and the definitions  , and  ,",
    "it can be derived , by a rather lengthy calculation , that the first - order corrections to a positive mode @xmath191 are given by @xmath238    @xmath239 \\\\    & +         \\sum_{l \\ , ( \\omega_l\\neq\\omega_k ) } \\frac{1}{2 } \\omega_k \\bigl [            \\bigl ( \\phantom{- } \\frac{u_{1l}^{\\mathsf{t}}u_{2k } - u_{2l}^{\\mathsf{t}}u_{1k}}{\\omega_k-\\omega_l } - \\frac{u_{1l}^{\\mathsf{t}}u_{2k } + u_{2l}^{\\mathsf{t}}u_{1k}}{\\omega_k+\\omega_l } \\bigr)u_{1l } \\\\    & \\phantom{\\sum_{l \\ , ( \\omega_l\\neq\\omega_k ) } \\frac{1}{2 } \\omega_k \\bigl [ }          + \\bigl ( \\phantom{- } \\frac{u_{1l}^{\\mathsf{t}}u_{1k } + u_{2l}^{\\mathsf{t}}u_{2k}}{\\omega_k-\\omega_l } + \\frac{u_{1l}^{\\mathsf{t}}u_{1k } - u_{2l}^{\\mathsf{t}}u_{2k}}{\\omega_k+\\omega_l } \\bigr)u_{2l } \\bigr ] \\\\    & + \\sum_{l\\text { ord . } } \\left [ -(u_{2l}^{\\mathsf{t}}u_{1k})u_{1l } + ( u_{1l}^{\\mathsf{t}}u_{1k})u_{2l } \\right ] \\\\    & + \\sum_{l\\text { def . } } \\left [ -(u_{2l}^{\\mathsf{t}}u_{1k})u_{1l } + ( u_{1l}^{\\mathsf{t}}u_{1k } + \\omega_k^{-1 } u_{2l}^{\\mathsf{t}}u_{2k})u_{2l } \\right ] \\end{split } \\\\",
    "\\begin{split } \\label{eq : poscorrv } u_{2k}^{(1 ) } =    & \\sum_{l \\ , ( \\omega_l =   \\omega_k ) } \\frac{1}{4}\\left [ ( u_{1l}^{\\mathsf{t}}u_{1k } - u_{2l}^{\\mathsf{t}}u_{2k})u_{1l } + ( u_{1l}^{\\mathsf{t}}u_{2k } + u_{2l}^{\\mathsf{t}}u_{1k})u_{2l } \\right ] \\\\    & +         \\sum_{l \\ , ( \\omega_l\\neq\\omega_k ) } \\frac{1}{2 } \\omega_k \\bigl [            \\bigl ( - \\frac{u_{1l}^{\\mathsf{t}}u_{1k } + u_{2l}^{\\mathsf{t}}u_{2k}}{\\omega_k-\\omega_l } + \\frac{u_{1l}^{\\mathsf{t}}u_{1k } - u_{2l}^{\\mathsf{t}}u_{2k}}{\\omega_k+\\omega_l } \\bigr)u_{1l } \\\\    & \\phantom{\\sum_{l \\ , ( \\omega_l\\neq\\omega_k ) } \\frac{1}{2 } \\omega_k \\bigl [ }          + \\bigl(\\phantom{- } \\frac{u_{1l}^{\\mathsf{t}}u_{2k } - u_{2l}^{\\mathsf{t}}u_{1k}}{\\omega_k-\\omega_l } + \\frac{u_{1l}^{\\mathsf{t}}u_{2k } + u_{2l}^{\\mathsf{t}}u_{1k}}{\\omega_k+\\omega_l } \\bigr)u_{2l } \\bigr ] \\\\    & + \\sum_{l\\text { ord . } } \\left [ -(u_{2l}^{\\mathsf{t}}u_{2k})u_{1l } + ( u_{1l}^{\\mathsf{t}}u_{2k})u_{2l } \\right ] \\\\    & + \\sum_{l\\text { def . } } \\left [ -(u_{2l}^{\\mathsf{t}}u_{2k})u_{1l } + ( u_{1l}^{\\mathsf{t}}u_{2k } - \\omega_k^{-1 } u_{2l}^{\\mathsf{t}}u_{1k})u_{2l } \\right]\\text { , } \\end{split}\\end{aligned}\\ ] ]    where the first sum in eq .   or   is over any modes @xmath193 that are degenerate with the positive normal mode @xmath191 , plus @xmath191 itself ; the second sum is over all other positive normal modes ; the third sum is over the special zero normal modes ; and the fourth sum is over the inertial zero normal modes . for the damped inertial zero mode ,",
    "we have    @xmath240    the first - order corrections are given by @xmath241 @xmath242   + \\sum_{l\\text { def .",
    "} } -(u_{1l}^{\\mathsf{t}}u_{2k})u_{1l } \\text{,}\\ ] ] where the first sum in eq .",
    "is over all positive normal modes and the second sum is over all inertial zero normal modes .",
    "we see that in both cases   and  , @xmath243 is guaranteed to be positive : for a positive damping parameter @xmath216 , amplitudes of modes decrease in time .",
    "notice that the frequency @xmath244 of a damped positive mode is constant to first order in @xmath216 ; however , there will be a second - order correction ( normally negative ) .",
    "if all magnetic moments in the equilibrium configuration @xmath93 have the same magnitude @xmath245 , we have @xmath246 , and eq .",
    "becomes @xmath247 we can then often further reduce the residual error in the damped positive modes , which is of second order in @xmath216 , simply by dividing the @xmath244 and @xmath248 as obtained to first order by @xmath249 . for a damped inertial zero mode ,",
    "divide the value @xmath248 by @xmath249 and multiply the vector @xmath250 by the same factor .",
    "these corrections do not eliminate the error of second order completely , but are very easy to implement .",
    "if there are several distinct positive normal modes with the same frequency @xmath215 , or if the dimension @xmath136 of the null space of @xmath28 is larger than one , the normal - mode problem is degenerate .",
    "the damping perturbation may lift this degeneracy . for the correctness of the expressions for the first - order corrections",
    "it is essential to choose the degenerate unperturbed normal modes in such a way that the perturbation does not mix them .",
    "we amend the procedure of sec .",
    "[ sec : redhdgep ] as follows .",
    "given any symmetric and positive - definite matrix @xmath21 , we may choose the null - space vectors @xmath137 in step  [ itm : findnullspace ] of sec .",
    "[ sec : redhdgep ] in such a way that they satisfy @xmath251 .",
    "for the spin system with damping , we must use @xmath252 .",
    "the rest of the algorithm then automatically ensures that the vectors @xmath182 , @xmath184 and @xmath186 ( see step [ itm : zeroconclusion ] ) of the zero normal modes satisfy    @xmath253    where @xmath199 index the inertial zero normal modes and @xmath254 index the special zero normal modes .",
    "for example ,",
    ".   is equivalent to the condition that @xmath255 for all pairs of special zero normal modes @xmath254 . as for the positive normal modes , if we have a block of @xmath256 degenerate modes at frequency @xmath49 , we can , without breaking the conditions   and  , choose them in such a way that the hermitian @xmath257 matrix @xmath258}}_{ij } = ( w_{1i } + iw_{2i})^\\dagger a ( w_{1j } + iw_{2j})$ ] is diagonal . here",
    "@xmath259 index those modes that are part of the degenerate block .",
    "again , we must use @xmath252 . as a result , the components @xmath260 and @xmath261 satisfy    @xmath262    for example , eq .",
    "is equivalent to the condition that @xmath263 for all pairs of positive normal modes @xmath259 that are part of the degenerate block .",
    "the procedure for finding the magnetic normal modes can be summarized as follows .",
    "a.   [ itm : procminconf ] find a configuration @xmath264 that is a local minimum of the hamiltonian @xmath34 , under the constraint that @xmath265 for each position @xmath91 .",
    "b.   [ itm : proczero ] if necessary , follow the procedure in sec .",
    "[ sec : redhdgep ] to detect and compute any zero normal modes .",
    "c.   [ itm : procpos ] solve the hdgep of eq .   to find the ( low - energy ) positive normal modes .",
    "d.   [ itm : procdamp ] if a damping parameter @xmath213 is used , correct the normal modes using the expressions in sec .",
    "[ sec : spindamped ] .",
    "all important steps can be efficiently implemented using iterative methods for large hermitian problems . for concreteness",
    ", we shall discuss the iterative methods based on conjugate gradients in a bit more detail .",
    "alternative approaches , such as matrix - free versions of the lanczos eigenvalue algorithm @xcite , have similar properties .",
    "let us first remark that our scheme can also be used to find the magnetic normal modes near a local energy minimum of some continuum model .",
    "one discretizes the system using , for example , the finite - difference method or a geometric finite - element method @xcite , which give effective systems that are mathematically equivalent to a finite system @xcite .",
    "it is important to use a mesh that is smooth enough , to avoid effects such as an artificial peierls pinning of domain walls @xcite .",
    "( this effect decreases exponentially in the inverse lattice constant @xcite , so there is no fundamental problem . )    in its simplest form , the conjugate - gradient method @xcite is an iterative method for solving systems of linear equations , @xmath266 where @xmath21 is a symmetric or hermitian @xmath267 matrix and @xmath22 and @xmath268 are vectors in @xmath269 or @xmath270 . @xmath21 and @xmath268",
    "are given ; @xmath22 is asked .",
    "equation   is considered solved when the magnitude @xmath271 of the _ residual vector _",
    "@xmath272 is less than a certain ( very small ) tolerance . in each iteration @xmath273 ,",
    "the trial solution @xmath120 is updated , @xmath274 where @xmath275 a more detailed discussion of the algorithm , with expressions for the coefficients @xmath276 and @xmath277 , can be found in most textbooks on numerical methods @xcite .",
    "what is relevant here is the following .    we do not need to store the @xmath278 elements of @xmath21 .",
    "all we need is a routine that can evaluate @xmath279 for any given @xmath22 ( the _ action _ @xmath280 of @xmath21 ) .",
    "the conjugate - gradient algorithms use this routine as a ` black box ' .",
    "every trial solution @xmath120 is a linear combination of @xmath281 ; the conjugate - gradient method is a _ krylov - subspace method_.    a variant of the conjugate - gradient method can be used to solve nonlinear optimization problems @xcite , where a local minimum of a multivariate function @xmath282 is asked . here",
    "the gradient @xmath283 plays the role of the residual vector .",
    "this method is also suitable for minimization problems under constraints @xmath284 . in that case",
    ", one should project the residual vector @xmath256 onto the tangent space : @xmath285 where @xmath286 is a lagrange multiplier .",
    "the conjugate - gradient eigenvalue algorithm @xcite can be seen as a special case of constrained nonlinear optimization .",
    "if we minimize the function @xmath287 under the constraint @xmath288 where @xmath1 and @xmath2 are hermitian matrices , we obtain the lowest eigenvalue @xmath289 and the corresponding eigenvector @xmath40 of the hdgep @xmath290 .",
    "( the sdgep case , where @xmath1 , @xmath2 and @xmath22 are real , is entirely analogous . ) @xmath2 must be positive definite to guarantee that a minimum exists .",
    "once we have the first eigenvector @xmath40 , we can obtain the next eigenvector by repeating the minimization under an additional constraint : @xmath291 for @xmath130 , this is equivalent to the constraint @xmath292 once we have found the second eigenvector , we move on to the third , and so on , applying constraints of the form for all previously obtained eigenvectors .",
    "we continue until we have found as many eigenvectors @xmath293 with eigenvalues @xmath294 as we need .",
    "the fact that we do not need to explicitly store the matrices in memory is a crucial advantage . for simplicity ,",
    "let us first consider a one - dimensional @xmath18-spin chain with only exchange and uniaxial anisotropy energy , @xmath295 the hessian matrix @xmath21 ( see sec .",
    "[ sec : spincons ] ) is given by @xmath296 equivalently , it may be defined by its action @xmath280 , @xmath297 where we take @xmath298 for @xmath299 and @xmath300 .",
    "we see that the evaluation of the action of @xmath21 on an arbitrary vector @xmath22 takes only @xmath301 time , while any manipulation with or decomposition of the @xmath302 matrix @xmath21 obviously takes at least @xmath3 time if it is explicitly stored in memory in full .",
    "that is why krylov - subspace methods are a popular choice for linear equations or eigenvalue problems of sparse matrices @xcite .",
    "if long - range interactions are taken into consideration , the matrix @xmath21 is dense .",
    "nevertheless , the action of @xmath21 can still be evaluated in much less than @xmath3 time , as follows . for nearly all physical systems",
    ", @xmath21 can be separated into a short - ranged part @xmath303 such as eq .  , which is sparse , and a long - ranged part @xmath304 , which is invariant under spatial translations ( it is a convolution ) @xcite .",
    "to perform the action on a given vector @xmath22 , we separately evaluate the contributions @xmath305 and @xmath306 and then add them up to obtain @xmath307 . in typical magnetic systems , the relevant long - range interaction is the dipolar interaction .",
    "we can evaluate @xmath306 by performing the convolution in the fourier representation of @xmath22 , where it becomes a simple elementwise multiplication .",
    "the two fourier transformations that are necessary take @xmath308 time @xcite .",
    "a similar mixed real - space  reciprocal - space approach is taken in most plane - wave electronic - structure codes @xcite .",
    "even if the system is not perfectly translationally invariant , for instance because it has some nonrectangular finite geometry , we can efficiently evaluate @xmath306 by reducing the dipolar problem to the poisson problem @xcite and solving it using multigrid methods @xcite .",
    "the complexity analysis is similar .",
    "it is thus possible to implement a routine that can evaluate @xmath279 , and hence @xmath309 , for any given @xmath22 in @xmath308 rather than @xmath3 time .    in the remainder of this section",
    ", we discuss the specific implementation of each of the four stages listed above .",
    "[ [ stageitmprocminconf . ] ] stage  [ itm : procminconf ] .",
    "+ + + + + + + + + + + + + + + + + + + + + + + +    a minimum - energy configuration @xmath93 can be found using , for example , the nonlinear conjugate - gradient optimization method , which is implemented in existing micromagnetics codes .",
    "note that many magnetic systems have multiple local energy minima . in this article",
    ", we regard one particular @xmath93 as given .    [ [ stageitmproczero - stepitmfindnullspace . ] ] stage  [ itm : proczero ]  step  [ itm : findnullspace ] .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    in step  [ itm : findnullspace ] of sec .  [",
    "sec : redhdgep ] , we need to calculate the null vectors @xmath137 of @xmath28 .",
    "this is in fact a symmetric eigenvalue problem .",
    "it might be solved as a particular case of the conjugate - gradient sdgep algorithm ( set @xmath310 and @xmath119 ) .",
    "the sequential nature of this method means that we can efficiently obtain the lowest few eigenvectors .",
    "we stop once we find the first positive eigenvalue . the eigenvectors with eigenvalue",
    "zero constitute a basis of the null space of @xmath28 .    in our definition of the restricted matrix @xmath28",
    ", we formally require construction of a basis of the image space of @xmath9 . in practice",
    ", we do not normally need to construct the basis explicitly .",
    "we may simply set @xmath311 , provided our initial guess @xmath312 is in the image space of @xmath9 ( that is , we set @xmath313 , where @xmath314 is a random vector ) . since @xmath312 , @xmath315 , @xmath316 , @xmath317 , etc .",
    "all lie in the image space of @xmath9 , the minimization will automatically be restricted to trial solutions in this space .",
    "we remark that for numerical stability , it may be necessary occasionally to project the trial vector @xmath120 back onto the image space of @xmath9 .",
    "[ [ stageitmproczero - stepitmsolvemj . ] ] stage  [ itm : proczero ]",
    " step  [ itm : solvemj ] .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    in step  [ itm : solvemj ] of sec .  [",
    "sec : redhdgep ] , we need to solve the linear system @xmath318 , where @xmath319 . this problem may seem ill posed , since @xmath28 is not invertible ( even with the angular brackets ) .",
    "however , we know that a solution exists ( @xmath320 lies in the image space of @xmath28 ) . since the solution - vector iterates are always linear combinations of @xmath321 , we in effect restrict our search to trial solutions @xmath22 in the image space of @xmath28 . in this linear subspace ,",
    "the solution @xmath22 is unique .    in practice",
    ", @xmath320 will not lie in the image space of @xmath28 numerically exactly , but only up to a small tolerance , so that the solver may fail once the magnitude of the residual vector becomes on the order of this tolerance .",
    "we may remedy this as follows .",
    "project @xmath320 onto the orthogonal complement of @xmath322 , and do the same for @xmath323 in each iteration .",
    "effectively , we now find a solution of @xmath324 , where @xmath325 ( symmetric ) performs the projection .    for the sake of completeness , we remark that again , we may use @xmath13 instead of @xmath28 , as the image space of @xmath13 is contained in the image space of @xmath9 .",
    "[ [ stageitmprocpos . ] ] stage  [ itm : procpos ] .",
    "+ + + + + + + + + + + + + + + + + + + +    the problem can be solved using the conjugate - gradient hdgep scheme , where in eq .",
    "we set @xmath326 notice that we only need the ( action of the ) matrices @xmath9 and @xmath13 , which have simple forms   and  .",
    "again , we do not need to implement the restrictions @xmath327 explicitly , provided that our initial guess is in the image space of @xmath9 . for each positive normal mode , there are two solutions of eq .",
    ": one with @xmath328 and one with @xmath329 .",
    "we obviously need to find only one of the two .",
    "if we find a negative-@xmath330 solution @xmath22 , we must take the complex conjugate of @xmath22 to obtain the positive-@xmath330 solution .",
    "notice that the eigenvalue @xmath330 that the hdgep algorithm finds is the reciprocal of the angular frequency @xmath215 .",
    "the hdgep algorithm normalizes the solutions @xmath22 so that @xmath331 . to obtain the correct normalization",
    ", we must divide each ( positive-@xmath330 ) solution @xmath120 by @xmath332 ; we have @xmath333 where @xmath260 and @xmath261 are the real vectors defined in eq .  .",
    "the eigenvalues @xmath330 at the extremes of the spectrum are @xmath334 and @xmath335 , where @xmath336 is the angular frequency of the lowest - frequency positive normal mode .",
    "hdgep algorithms such as the conjugate - gradient scheme find the solutions of eq .   with either the lowest or the highest eigenvalues @xmath330 .",
    "we see that it does not matter if we let the algorithm minimize @xmath330 ( as we do above ) or maximize @xmath330 : in either case , we obtain the _ lowest - frequency _ normal modes first .",
    "if we minimize the eigenvalue @xmath330 , we find the negative-@xmath330 solutions and we must apply to the trial solution @xmath22 a constraint @xmath337 for each previously obtained positive normal mode @xmath191 ( see eq .  ) .",
    "if we choose to maximize the eigenvalue @xmath330 , we must apply a constraint @xmath338 for each previously obtained positive normal mode @xmath191 .",
    "if any zero normal modes were found in stage  [ itm : proczero ] , we need to eliminate those from the problem to ensure that @xmath339 is positive definite on the space of trial solutions . the constraints   and   that accomplish this are of exactly the same form as the constraints for previously obtained positive normal modes .    the simple conjugate - gradient hdgep scheme outlined above may be improved in several ways .",
    "it is well known that matrix - free eigenvalue methods require good preconditioning to be efficient @xcite .",
    "indeed , we find that preconditioning as described below greatly improves performance , especially if the exchange constant between adjacent sites is large as compared to the anisotropy constant .",
    "this is the case in most atomistic simulations and in continuum systems discretized with a reasonably high spatial resolution .",
    "( only for relatively modest systems , say @xmath340 , preconditioning is unnecessary ; methods that use explicit matrix decompositions @xcite are likely to be more efficient . ) how a preconditioner can be incorporated into the conjugate - gradient hdgep scheme is described in many texts @xcite .",
    "in addition , efficiency may be improved by using a _ simultaneous _ conjugate - gradient scheme @xcite , especially if some of the eigenvalues are closely spaced .",
    "we use a preconditioner that is based on an inversion of the spin - wave dispersion relation in reciprocal space , similar to the preconditioners used to solve the schrdinger equation in electronic - structure calculations @xcite . in other words",
    ", the preconditioner approximates the spectrum of the system with the spin - wave spectrum of a homogeneous system and uses this to speed up convergence of the trial solution . note that since a typical spin - wave dispersion relation has no zeros ( see fig .",
    "[ fig : dispperfect ] ) , the preconditioner acts in real space as a convolution with some kernel that decays exponentially , with a characteristic decay distance on the order of the domain - wall width .",
    "thus , we could in principle even implement the preconditioner in @xmath301 rather than @xmath308 time .",
    "if the explicit restrictions @xmath327 of @xmath13 and @xmath9 are not used , it is of course important to ensure that the preconditioned reciprocal vector is projected back onto the image space of @xmath9 in order to ensure that the trial solution @xmath22 does not move out of the image space of @xmath9 .",
    "preconditioning can also greatly speed up convergence for steps  [ itm : findnullspace ] and  [ itm : solvemj ] of stage  [ itm : proczero ] .",
    "[ [ stageitmprocdamp . ] ] stage  [ itm : procdamp ] .",
    "+ + + + + + + + + + + + + + + + + + + + +    in principle , the full set of unperturbed magnetic normal modes needs to be available to calculate the correction due to damping for any given mode .",
    "this could be a problem , since we usually know only the normal modes near the bottom of the spectrum .",
    "this forces us to truncate the sums in eqs .  , and  .",
    "we verify in subsec .",
    "[ sec : accuracy ] for a realistic system that this approximation is justified . in practice ,",
    "the high - wavenumber spin - wave modes are increasingly oscillatory and have an overlap with the lower , smoother modes that decreases exponentially in wavenumber .",
    "notice that the damped modes do not , in general , satisfy the relations   and  . to carry out a mode analysis of some configuration near @xmath93 ,",
    "first obtain the coefficients of the unperturbed modes using eq .   and then use eqs .  , and   to convert these into the coefficients of the damped modes .",
    "in this section , we study some key examples that are illustrative of the general properties of magnetic normal modes and make evident the fundamental distinction between inertial and special zero normal modes .",
    "we also discuss how to calculate effective masses for the inertial zero normal modes .",
    "figure  [ fig : dispersion ] provides an overview of the spectra of all systems we consider here .",
    "we begin by studying the one - dimensional ( 1d ) spin chain , possibly with a defect , in subsec .",
    "[ sec : experfectchain ] .",
    "we specifically look at the effect the effect of damping ( subsec .",
    "[ sec : respfunc ] ) , and we demonstrate how the expressions in sec .  [",
    "sec : spindamped ] can be used to calculate dynamical magnetic susceptibilities . in subsec .",
    "[ sec : inertial ] , we discuss how the fundamentally different types of dynamics of magnetic structures can be related to the two types of zero modes ( special and inertial ) . in particular , we show how to calculate effective masses .",
    "we focus on the properties of zero modes in spin systems with a 1d or 2d domain wall or a skyrmion ( subsecs .",
    "[ sec:1ddw][sec : exskyrmion ] ) , and we investigate a general relation between zero modes and the dispersion relations of extended systems ( subsec .",
    "[ sec:2ddw ] ) .",
    "subsection  [ sec : accuracy ] evaluates the accuracy of our perturbative treatment of damping .",
    "the 2d systems are of a size ( @xmath341 spins ) for which we begin to appreciate the scalability of the iterative hdgep methods ( see sec .",
    "[ sec : implementation ] ) . with our code , we are able to find the 20 or 30 lowest modes of these systems in a matter of minutes on just a single cpu core .",
    "( we remark that the calculation time could be reduced further by parallelization .",
    "matrix - free iterative methods such as the conjugate - gradient hdgep scheme , especially the simultaneous versions , are known for being highly parallelizable @xcite . )",
    "while for the sake of simplicity the examples only take short - range interactions into account , they could be extended to include magnetostatic ( dipolar ) and other interactions .",
    "this may be done in an efficient manner without any fundamental change to the method ( see sec .  [",
    "sec : implementation ] ) .",
    "inclusion of magnetostatic interactions in rectangular systems of a similar size would not lead to much longer calculation times , since for the purpose of preconditioning our present code already performs a full fft of the trial solution in each iteration .",
    "we first consider a finite , @xmath18-atom spin chain without defects .",
    "we set @xmath342 for all spins .",
    "the hamiltonian @xmath343 consists of nearest - neighbor exchange coupling @xmath344 with an exchange constant @xmath345 ( ferromagnetic ) and uniaxial anisotropy @xmath346 with @xmath347 ( easy - axis type ) .",
    "we number the spins as @xmath78 .",
    "there is no external magnetic field .",
    "we linearize around the uniform , collinear equilibrium configuration @xmath348 , shown in fig .",
    "[ fig : spinwaves ] , which is one of the two ground - state configurations ( @xmath349 is the other ) .",
    "our truncation of the exchange couplings at the ends of the chain results in neumann boundary conditions for the spin waves .",
    "color ) normal modes of a 1d ferromagnetic spin chain with neumann boundary conditions . only a part of the chain is shown .",
    "the big straight arrows indicate the equilibrium orientations of the spins .",
    "the circular arrows indicate the path traced by the spins if the normal mode is excited .",
    "while the normal modes are calculated in the linear ( small - amplitude ) approximation , we show them with a large amplitude for clarity .",
    "( a )  a spin - wave mode with @xmath350 in a perfect spin chain .",
    "( b )  the lowest mode in a spin chain with a defect , located at the site shown in blue , where the anisotropy is reduced from @xmath351 to @xmath352 . ]    the magnetic normal modes of a 1d spin chain are well known , but we reproduce them here for comparison ( see figs .  [",
    "fig : dispersion](a ) , [ fig : spinwaves](a ) , [ fig : dispperfect ] and  [ fig : waveforms](a ) ) . by taking a general linear combination of the fundamental solutions",
    ", we see that the dynamics of any positive normal mode is given by @xmath353 where @xmath21 is the amplitude and @xmath354 is the phase of the mode .",
    "the variable @xmath355 is the deviation of the magnetic moment at site @xmath91 from its equilibrium position . for the 1d collinear spin chain with neumann - type boundary conditions",
    ", we have spin - wave modes with @xmath356 where @xmath357\\ ] ] ( standing waves ) .",
    "the dispersion relation is given by @xmath358\\text{,}\\ ] ] where @xmath191 is the wavenumber and @xmath359 is the spacing between lattice sites .",
    "the bottom of the spin wave continuum is thus at @xmath360 .",
    "the wavenumber of the mode with index @xmath361 is given by @xmath362 .",
    "color ) dispersion @xmath363 of the perfect 1d spin chain .",
    "the wavenumber @xmath191 is given in units of @xmath364 .",
    "the angular frequency @xmath215 is given in units of @xmath365 .",
    "the solid line is the analytical dispersion relation and the dots show the spectrum of a @xmath366-spin chain .",
    "the hamiltonian consists of exchange and uniaxial anisotropy with @xmath351 .",
    "the area in the rectangle is expanded in fig .",
    "[ fig : dispersion](a ) .",
    "the colored dots correspond to fig .",
    "[ fig : waveforms](a ) . ]",
    "our code finds the right frequencies @xmath367 ( see fig .  [",
    "fig : dispperfect ] ) and the right form of the spin waves ( see fig .",
    "[ fig : waveforms](a ) ) .",
    "color ) amplitude profiles @xmath368 for some low - energy normal modes of a 1d @xmath366-spin chain , ( a )  without and ( b )  with a defect .",
    "the spin chain with defect is different from the perfect spin chain only at a single site @xmath369 , where @xmath352 instead of @xmath370 .",
    "notice that the defect gives rise to a localized mode ( see also figs .",
    "[ fig : dispersion](b ) and  [ fig : spinwaves](b ) ) . ]",
    "we now consider the effect of a defect , modeled by reducing the anisotropy constant @xmath371 at a single site .",
    "the normal modes are still of the form , but have different profiles @xmath368 ( see fig .",
    "[ fig : waveforms](b ) )",
    ". the lowest mode is localized at the defect site and decays exponentially away from it ( evanescent spin wave ; see also fig .",
    "[ fig : spinwaves](b ) ) ; its frequency is just below the spin wave continuum ( see fig .  [",
    "fig : dispersion](b ) ) .",
    "the other @xmath372 modes are spin - wave modes .",
    "they are perturbed with respect to the normal modes of the perfect spin chain . since in the example of fig .",
    "[ fig : waveforms](b ) we place the defect almost in the middle ( @xmath369 ) of a chain of @xmath373 spins , the odd - numbered spin - wave modes have a ` kink ' at the defect site while the even - numbered spin - wave modes are almost identical to those of the perfect spin chain .       color ) absolute value of the magnetic susceptibility function @xmath374 of the 1d 50-spin chain with a defect ( @xmath352 at site @xmath369 ; @xmath351 everywhere else ) , for three different values of the damping parameter @xmath216 . the driving frequency @xmath215 is given in units of @xmath365 , @xmath375 in @xmath376 and @xmath216 in @xmath377",
    ". the absolute value of the contribution of each mode is plotted alongside the overall magnetic susceptibility function as obtained in spin - dynamics simulations .",
    "the width of the peak that corresponds to a mode @xmath193 is proportional to its decay rate @xmath378 .",
    "we find an excellent agreement between the peak widths calculated by means of eq .   and the results from spin - dynamics simulations .",
    "the discrepancy in between peaks is due to the fact that the contributions of all modes must be added up with their complex phases and may interfere with each other . in this particular example , only the modes 1 , 3 and 5 contribute significantly to the dynamical susceptibility .",
    "other modes generate a magnetization that is negligible when integrated over the whole length of the chain ( see , for example , mode 2 in fig .",
    "[ fig : waveforms](b ) ) . ]    response functions , such as dynamical magnetic susceptibilities , allow comparison of calculated spectra to experimental observables ( see , for example , ref .  [ ] ) . using the expressions in sec .",
    "[ sec : spindamped ] , our scheme allows one to calculate dynamical susceptibility functions in a way that is usually much less computationally expensive than with spin - dynamics simulations .",
    "here we consider the response of the magnetization in the @xmath379-direction ( perpendicular to the equilibrium magnetization , which is in the @xmath380-direction ) to an oscillating external magnetic field , also in the @xmath379-direction .",
    "the dynamical susceptibility @xmath375 is the ratio between the complex amplitudes of the applied field and the resulting magnetization .",
    "each positive mode contributes to @xmath375 a term @xmath381 @xcite , where @xmath382 and @xmath378 are the frequency and decay rate of mode @xmath193 and @xmath215 is the driving frequency .",
    "this means that the width of a peak in the dynamical magnetic susceptibility function is directly proportional to the decay rate @xmath378 .",
    "the same mode gives a similar contribution near @xmath383 .    in fig .",
    "[ fig : respfunc ] , we plot the absolute value of the dynamical susceptibility @xmath374 of the @xmath366-spin system with defect ( see subsec .",
    "[ sec : experfectchain ] and fig .  [ fig : waveforms](b ) ) , for several values of the damping parameter @xmath216 .",
    "we have obtained @xmath374 from spin - dynamics simulations , where we integrate the llg equation using the implicit - midpoint timestepping scheme @xcite ( no stochastic term ) .",
    "we compare this to the contributions from the individual modes calculated using our scheme .",
    "we see that the contribution of each mode to @xmath374 is very well approximated by calculating @xmath378 by means of eq .  .      the fundamental distinction between inertial and special zero normal modes described in sec .",
    "[ sec : hamsysbrief ] is further clarified by examining the effect of an external potential on the dynamics of a topological defect .",
    "the general considerations we present here are applied to specific systems in subsecs .",
    "[ sec:1ddw][sec : exskyrmion ] .",
    "zero modes typically appear as a consequence of a broken continuous symmetry of the system . for example , the energy of a system with a domain wall ( see subsecs .  [ sec:1ddw ] and  [ sec:2ddw ] ) or a skyrmion ( see subsec .",
    "[ sec : exskyrmion ] ) in a homogeneous material is invariant under translation of the topological defect . since no microscopic energy scale is associated with changes of the system that respect the symmetry , weak external perturbations of the hamiltonian that couple to such changes can have a significant effect over time . by studying the response of the system to such external forces , we establish its effective ( that is , low - energy or long - time ) dynamics .",
    "for example , an effective force on a topological defect may result from an external magnetic field or from dipolar interactions within the system .",
    "we consider the dynamics of just a single degree of freedom , corresponding to a zero normal mode @xmath47 . the deviation @xmath384 of the system from its equilibrium configuration",
    "is given by ( see eq .  ) @xmath385 we write @xmath386 instead of just @xmath42 to emphasize that this variable is canonically conjugate to @xmath43 .",
    "let us for concreteness assume that the vector @xmath45 generates an infinitesimal translation of a topological defect .",
    "thus we have , for a certain constant @xmath387 , @xmath388 where @xmath136 is the position of the center of the defect , in units of length .",
    "using eq .  , it is straightforward to obtain the coefficient @xmath387 from the calculated normal mode .",
    "the variable canonically conjugate to @xmath136 is @xmath389    let us first consider the case that the zero normal mode is _",
    "inertial_. the unperturbed hamiltonian is then given , to second order , by ( see eq .  ) @xmath390 where we have @xmath391 the _ effective mass _ of the degree of freedom .",
    "suppose that the hamiltonian is perturbed by an external potential @xmath392 which depends only on the position of the defect , so that we have @xmath393 .",
    "we get @xmath394 which is newton s equation of motion .    for a _ special _ zero normal mode",
    ", the picture is different .",
    "the unperturbed hamiltonian is then given , to second order , by ( see eq .  ) @xmath395 which implies , in a sense , an infinite effective mass .",
    "since for the special zero mode no energy term is associated with @xmath396 , an effective force in the @xmath136-direction does not , by itself , cause an acceleration in the @xmath136-direction .",
    "it does generate a motion in the canonically conjugate variable ; however , here the first , not second , time derivative is proportional to the force .",
    "let us consider a case where @xmath386 and @xmath43 correspond to orthogonal displacements of a 2d magnetic defect , such as a skyrmion ( see subsec .  [",
    "sec : exskyrmion ] ) .",
    "we have , for certain constants @xmath387 and @xmath397 , @xmath398 where @xmath399 and @xmath400 respectively represent the @xmath22- and @xmath24-coordinate of the position of the defect .",
    "again , we can straightforwardly obtain @xmath387 and @xmath397 from the calculated normal mode using eq .  .",
    "if the hamiltonian is perturbed by an external potential @xmath401 , we get @xmath402 notice that the velocity ( not acceleration ! ) in the @xmath400-direction is proportional to the force in the positive @xmath399-direction , while the velocity in the @xmath399 direction is proportional to the force in the negative @xmath400-direction with the same constant of proportionality .",
    "we see that we can interpret effective dynamical behavior described by thiele s equation of motion @xcite as a direct consequence of the existence of a special zero mode .",
    "color ) spin chain with domain wall .",
    "the domain wall separates two domains , magnetized in either the positive or the negative @xmath380-direction .",
    "only one in every three spins is shown in the picture ; the spin chain should be considered as effectively continuous .",
    "we set @xmath403 , giving the domain wall a characteristic width @xcite of @xmath404 .",
    "the big arrows show the equilibrium configuration @xmath93 .",
    "the vectors @xmath44 and @xmath45 of the zero mode of the domain wall are indicated in  ( a ) with red ( @xmath44 ) and gray ( @xmath45 ) arrows .",
    "the actual magnitudes of @xmath44 and @xmath45 depend on the type of mode ( special or inertial ) and the effective mass .",
    "( b )  top view of the domain wall .",
    "the position @xmath405 of the domain wall and the angle @xmath406 are indicated .",
    "( c )  spin - wave mode with @xmath407 for @xmath408 . ]     color ) spin chain with domain wall .",
    "the domain wall separates two domains , magnetized in either the positive or the negative @xmath380-direction .",
    "only one in every three spins is shown in the picture ; the spin chain should be considered as effectively continuous .",
    "we set @xmath403 , giving the domain wall a characteristic width @xcite of @xmath404 .",
    "the big arrows show the equilibrium configuration @xmath93 .",
    "the vectors @xmath44 and @xmath45 of the zero mode of the domain wall are indicated in  ( a ) with red ( @xmath44 ) and gray ( @xmath45 ) arrows .",
    "the actual magnitudes of @xmath44 and @xmath45 depend on the type of mode ( special or inertial ) and the effective mass .",
    "( b )  top view of the domain wall .",
    "the position @xmath405 of the domain wall and the angle @xmath406 are indicated .",
    "( c )  spin - wave mode with @xmath407 for @xmath408 . ]     color ) spin chain with domain wall .",
    "the domain wall separates two domains , magnetized in either the positive or the negative @xmath380-direction .",
    "only one in every three spins is shown in the picture ; the spin chain should be considered as effectively continuous .",
    "we set @xmath403 , giving the domain wall a characteristic width @xcite of @xmath404 .",
    "the big arrows show the equilibrium configuration @xmath93 .",
    "the vectors @xmath44 and @xmath45 of the zero mode of the domain wall are indicated in  ( a ) with red ( @xmath44 ) and gray ( @xmath45 ) arrows .",
    "the actual magnitudes of @xmath44 and @xmath45 depend on the type of mode ( special or inertial ) and the effective mass .",
    "( b )  top view of the domain wall .",
    "the position @xmath405 of the domain wall and the angle @xmath406 are indicated .",
    "( c )  spin - wave mode with @xmath407 for @xmath408 . ]",
    "even if the hamiltonian as such is translationally invariant ( the material properties are homogeneous ) , translational symmetry may be broken by the equilibrium configuration @xmath93 , for instance if @xmath93 contains a domain wall .",
    "we consider a 1d spin chain with a domain wall like the one in fig .",
    "[ fig : dw1ddef ] .",
    "we ensure that the equilibrium width of the domain wall is large enough to make the system effectively continuous ( peierls pinning @xcite is negligible ) .",
    "the 1d domain wall is the simplest case where the two types of zero modes arise . as in the previous examples , the hamiltonian consists of exchange and anisotropy terms , which are taken the same for all spins in the system .",
    "we will consider , however , two types of anisotropy that yield one or the other type of zero mode .",
    "we shall see that the inertial dynamics of many domain walls @xcite can be interpreted as a consequence of the existence of an inertial zero mode .    for a 1d domain wall",
    ", we find below the spin - wave continuum only a single zero mode ( see fig .  [ fig : dispersion](c ) ) .",
    "if the hamiltonian is the form considered up to now , with exchange and uniaxial anisotropy , this mode is a _ special _ zero mode . in fig .",
    "[ fig : dw1ddef](a ) we show the two components @xmath44 and @xmath45 of the zero mode .",
    "the component @xmath45 generates an infinitesimal increase of the position @xmath405 of the domain wall whereas @xmath44 generates an infinitesimal increase of the angle @xmath406 ( see fig .",
    "[ fig : dw1ddef](b ) ) .",
    "an angle @xmath409 or @xmath410 corresponds to a bloch domain wall , whereas @xmath411 corresponds to a nel domain wall @xcite .",
    "the coordinate @xmath405 is canonically conjugate @xcite to @xmath412     color ) time evolution of @xmath405 and @xmath406 in the presence of an external magnetic field @xmath413 , for @xmath403 . due to the external field , the domain wall experiences an effective external potential .",
    "the position @xmath405 is given in units of @xmath359 , angle @xmath406 in radians and time @xmath414 in units of @xmath415 .",
    "the plots have been obtained in spin - dynamics simulations .",
    "( a )  behavior of a domain wall with a special zero mode for @xmath416 .",
    "( b )  behavior of a domain wall with an inertial zero mode for @xmath417 .",
    "the dotted line is a quadratic fit to the behavior of @xmath405 , which satisfies newton s law in the limit of small @xmath406 .",
    "the shaded area indicates where deviations occur ( see text ) . ]",
    "if we apply an external magnetic field in the @xmath380-direction , which adds to the hamiltonian a contribution ( zeeman energy ) of the form @xmath418 the domain wall experiences an effective force that acts on the @xmath405 coordinate .",
    "in fact , a displacement of the domain wall by one site ( distance @xmath359 ) leads to one more spin aligned along the field and one fewer spin antialigned .",
    "this results in an effective external potential @xmath419 nevertheless , the domain wall position @xmath405 remains constant , as shown in fig .",
    "[ fig : dwdynamics](a ) .",
    "the conjugated @xmath406 increases linearly ( the spins near the center of the domain wall rotate around the @xmath380 axis ) .",
    "this is in line with the general dynamical behavior predicted for systems with a special zero mode ( see sec .",
    "[ sec : inertial ] ) .",
    "motion of the domain wall in an external magnetic field along @xmath380 occurs if we add to the hamiltonian a term that breaks the symmetry under rotation of the magnetic moments around @xmath380 . in many magnetic systems ,",
    "magnetostatic interactions favor bloch domain walls , where the magnetization is in the plane of the domain wall .",
    "we model this effect by introducing a second term to the anisotropy energy .",
    "we use @xcite @xmath420\\ ] ] with @xmath421 . in this case",
    ", we find an _ inertial _ zero mode , with the components @xmath44 and @xmath45 again as in fig .",
    "[ fig : dw1ddef](a ) but with a different dynamics . even in the absence of an external field ,",
    "a small deviation of @xmath406 from its equilibrium value @xmath409 now causes a linear motion of the domain wall , @xmath422 . in the presence of an external magnetic field in the @xmath380-direction , which creates a constant effective force @xmath423 , we find that @xmath405 initially increases quadratically in time ( see fig .  [",
    "fig : dwdynamics](b ) ) , in perfect agreement with the general dynamical behavior predicted for inertial zero modes .     inverse dring effective mass @xcite of a domain wall as a function of @xmath424 , for @xmath425 .",
    "we determine the effective masses from the calculated zero modes using eq .  .",
    "@xmath424 is given in units of @xmath426 , @xmath427 in units of @xmath428 . ]    in fig .",
    "[ fig : effmass ] we show how the presence of nonuniaxial anisotropy leads to a finite effective mass , transforming a special zero mode ( @xmath416 ) into an inertial zero mode ( @xmath429 ) .",
    "the notion of the effective mass of a domain wall was first introduced by dring @xcite .",
    "the deviations from quadratic behavior calculated at large times ( shaded area in fig .  [ fig : dwdynamics](b ) ) are beyond the linearized approach . in principle , the effective mass , defined as the inverse of the second derivative of the hamiltonian @xmath34 with respect to the momentum",
    "@xmath430 conjugate to @xmath405 , depends on @xmath406 .",
    "eventually , in a conservative system the domain wall starts reverting to its original position when @xmath406 reaches @xmath431 .",
    "this type of motion of the domain wall , which occurs when damping is absent or small as compared to the effective force , is responsible for the phenomenon called walker breakdown @xcite .",
    "color ) spin - wave modes in a 1d uniaxial ( @xmath425 , @xmath416 ) 200-spin chain with a domain wall at the center .",
    "we compare the numerical results ( thick solid lines ) to the analytical form @xcite for the continuum model ( thin dashed lines ) .",
    "away from the domain wall , in the shaded area , the spin - wave modes resemble those of a perfect chain and can be characterized by a wavevector @xmath191 .",
    "in addition to the spin - wave modes , the system has a localized special zero normal mode ( not shown here ; see fig .",
    "[ fig : dw1ddef](a ) ) . ]    in addition to the zero mode , we have a spin - wave continuum ( see fig .  [",
    "fig : dispersion](c ) ) . in general , it is hard to find analytical solutions of the magnetic normal - mode problem for systems such as these , where the magnetic moments in the equilibrium configuration are not collinear .",
    "however , in this simple case , an analytical solution for the spin - wave modes has been found @xcite , which we can use to verify the numerical results . in fig .",
    "[ fig : dw1dwaveforms ] , we compare the calculated spin - wave modes successfully to this analytical solution .",
    "it is convenient to express the analytical solution in the coordinate system @xcite @xmath432 in this system the equilibrium configuration @xmath93 of the domain wall is given by the linear functions @xmath433 and @xmath434 , where @xmath435 is the index of the spin , @xmath436 is the position of the center of the domain wall and @xmath437 is the characteristic domain - wall length .",
    "we convert the cartesian deviations from the equilibrium orientations , @xmath438 , into values @xmath439 in the coordinate system . for any given mode @xmath193 , both functions @xmath439 and both parts @xmath440 of the normal mode",
    "all have a common shape @xmath441 , though the amplitudes may be different .",
    "we plot @xmath442 .",
    "the fundamental solutions are given by @xmath443e^{ik\\zeta_j}$ ] @xcite , where @xmath444 is the wavenumber of the spin wave away from the domain wall , in units of @xmath445 . in our finite system , the spin - wave spectrum is discretized .",
    "we calculate the right @xmath191-values for the analytical solutions from the numerically obtained values of @xmath215 via eq .  .",
    "a linear combination of the solutions for @xmath191 and @xmath446 is taken in such a way that a real solution is obtained with a vanishing derivative at the boundaries of the chain .",
    "if a domain wall is extended to two dimensions , the zero mode of the 1d domain wall turns into a continuum of low - frequency modes @xcite .",
    "sketches of the lowest modes of ( a )  the 2d domain wall and ( b )  the skyrmion .",
    "the modes are shown in order of increasing frequency . in both cases ,",
    "the lowest mode is a zero mode that corresponds to an infinitesimal translation of the defect . for our choice of parameters ( see text ) , the four lowest modes of the skyrmion are 1 )  @xmath447 , 2 )  @xmath448 , 3 )  @xmath449 , and 4 )  @xmath450 ( see fig .  [",
    "fig : dispersion](e ) ) . ]",
    "these modes correspond to bending of the domain wall , as sketched in fig .",
    "[ fig : schematic](a ) ; in other words , they represent small spatial variations of the position @xmath405 of the domain wall .",
    "the domain - wall modes , which form a one - dimensional continuum with a vanishing frequency in the low-@xmath191 limit , exist alongside the two - dimensional continuum of spin - wave modes ( see fig .",
    "[ fig : dispersion](d ) ) .",
    "a domain - wall mode can only exist if its frequency is below the bottom of the spin - wave continuum , which puts a maximum on its wavenumber .",
    "the dispersion relation of the domain - wall modes in a system with arbitrary ( possibly nonuniaxial ) anisotropy was derived in ref .",
    "[ ] . here we show , using very general arguments , that the qualitative features of this dispersion relation follow immediately from the type of zero mode present in the system .    the domain - wall modes are a good example of physically interesting low - energy excitations of large systems , which can be found very efficiently using our method .        the domain - wall mode in fig .",
    "[ fig : locdwmode ] was calculated in a system of @xmath451 spins ( square lattice ) with exchange and uniaxial anisotropy ( @xmath452 ) . as in subsec .",
    "[ sec : experfectchain ] , our truncation of the expression for the exchange energy results in neumann boundary conditions .",
    "we find that the lowest 26 modes ( including the zero mode ) of this system are domain - wall modes ( see fig .",
    "[ fig : dispersion](d ) ) .",
    "the distinction between special and inertial zero modes has important consequences for the dispersion relations that correspond to them , as we show in the following . for the case with uniaxial anisotropy , shown in fig .",
    "[ fig : dispersion](d ) , we see that the zero mode of the domain wall , which is a _ special _ zero mode , turns into a continuum with _",
    "quadratic _ dispersion .",
    "color ) dispersion curves of the domain - wall modes @xcite of a 2d system with uniaxial anisotropy ( @xmath403 , @xmath416 ; see fig .",
    "[ fig : dispersion](d ) ) or nonuniaxial anisotropy ( @xmath403 , @xmath453 ) .",
    "the wavenumber @xmath191 is in units of @xmath364 and the angular frequency @xmath215 in units of @xmath454 . in the uniaxial case , where the domain wall has a special zero mode ,",
    "the dispersion is quadratic . in the nonuniaxial case , where the domain wall has an inertial zero mode , the dispersion is linear in the limit of small @xmath191 .",
    "the modes were calculated in a system of @xmath455 spins . ]    in fig .",
    "[ fig : dwdispersions ] , we compare this case to a similar system with nonuniaxial anisotropy . for @xmath429 , where the domain wall has an _ inertial _ zero mode ,",
    "the dispersion relation @xmath363 is _ linear _ in @xmath191 in the limit of low wavenumber @xmath191 .",
    "this suggests that long - wavelength waves in a system with an inertial zero mode propagate with a finite group velocity .",
    "indeed , a finite group velocity is also observed for acoustic waves in crystals , which agrees with the fact that zero modes of systems of coupled point masses are always inertial ( see appendix ) .",
    "it is easy to understand the link between the type of zero mode and the low-@xmath191 behavior of the dispersion relation .",
    "suppose we have a system with a zero mode , such as the 1d spin chain with a domain wall .",
    "we describe the relevant dynamics of this system with just two variables , the canonical momentum @xmath42 and coordinate @xmath43 corresponding to the zero mode . in the case of the domain wall ,",
    "@xmath42 and @xmath43 are proportional to @xmath405 and @xmath406 respectively ( see subsec .  [ sec:1ddw ] ) .",
    "we now extend the system to a higher dimension .",
    "the variables @xmath42 and @xmath43 become functions of position : we have @xmath456 and @xmath457 .",
    "( in the case of the 2d domain wall , @xmath458 represents a position along the length of the domain wall . )",
    "it is reasonable to assume that for functions @xmath456 and @xmath457 that vary very smoothly in @xmath459 and for short - range interactions , the hamiltonian of the system can be approximated by the functional @xmath460 \\,d\\mathbf{r}\\ ] ] for certain constants @xmath461 . in the limit of small @xmath42 and",
    "@xmath43 we have that @xmath462 for a special zero mode , @xmath463 for an inertial zero mode and @xmath464 for a positive mode ( see eq .  ) .",
    "after fourier transformation in @xmath465 , spatial variations with different wavevectors @xmath466 decouple and we get @xmath467 for the system with a special zero mode and @xmath468 for the system with an inertial zero mode , where we define @xmath469 .",
    "it follows immediately from hamilton s equations that for @xmath470 , we get @xmath471 while for @xmath472 , we get @xmath473 the momenta @xmath474 can be eliminated from both systems of equations , yielding equations of motion of the form @xmath475 for the special zero mode we get a quadratic dispersion relation @xmath476 whereas for the inertial zero mode we get a linear dispersion relation @xmath477}^{1/2 } \\| \\mathbf k",
    "\\| = \\sqrt{\\sigma } \\| \\mathbf k \\| + { \\mathcal{o}}({\\| \\mathbf k \\|}^2)\\text{.}\\ ] ]      magnetic bubbles or skyrmions can be seen as circular domain walls ( see fig .",
    "[ fig : skyrmionxy ] ) .",
    "the dynamics of a skyrmion in an effective potential can be understood very well in terms of its normal modes @xcite .",
    "we shall see that our algorithm for normal - mode analysis provides a direct way to calculate the effective mass @xmath478 and gyrocoupling constant @xmath479 of any skyrmion , regardless of the details of the interactions present in the system .",
    "this is another example of how a normal - mode analysis that includes the zero modes gives the effective equation of motion of some magnetic structure almost immediately .",
    "skyrmion structures can be stabilized by magnetostatic interactions @xcite or by the dzyaloshinskii ",
    "moriya ( dm ) interaction @xcite . in the latter case , which we shall consider here ,",
    "the equilibrium radius is fixed by the material parameters .            in the example shown in fig .",
    "[ fig : skyrmionxy ] , we consider a system of @xmath480 spins ( square lattice ) with only exchange , uniaxial anisotropy ( @xmath481 ) and dm interactions ( no external field ) .",
    "we write the dm interaction as @xcite @xmath482 where @xmath483 is the magnetic moment at the lattice site @xmath484 , @xmath485 sums over the directions of the nearest neighbors in the square lattice ( @xmath486 ) , @xmath359 is the lattice constant and @xmath1 is the interaction strength . here",
    ", we set @xmath487 .",
    "we use periodic boundary conditions .",
    "we construct a skyrmion configuration and relax it . for the given parameters , we get an equilibrium radius of @xmath488 . we find 10 normal modes below the spin - wave continuum ( edge modes @xcite ) , as shown in fig .  [",
    "fig : dispersion](e ) .",
    "we may interpret these modes as domain - wall modes traveling around the skyrmion ( see fig .",
    "[ fig : schematic](b ) ) .",
    "the edge modes can be identified by the number of periods @xmath489 seen when going around the skyrmion once .",
    "we use a positive or negative value of @xmath489 to indicate the direction in which the wave travels around the skyrmion @xcite . as pointed out in ref .",
    "[ ] , the edge - mode spectrum is chiral : it is not symmetric for positive and negative @xmath489 ( see fig .  [",
    "fig : dispersion](e ) ) .",
    "the system has translational symmetry in two spatial directions .",
    "this symmetry gives rise to a special zero mode ( @xmath447 ) .",
    "the vector @xmath44 of this mode generates an infinitesimal translation in the @xmath490-direction and the vector @xmath45 generates an infinitesimal translation in the @xmath379-direction ( see fig .",
    "[ fig : skyrmionxy](a ) ) .",
    "the existence of this special zero mode suggests that the dynamical behavior of the position of the skyrmion in an external potential is described by the noninertial equation of motion , which is equivalent to thiele s equation @xcite without damping .",
    "it has recently been observed that the actual behavior of the skyrmion position is more accurately described by an equation which has an additional inertial term @xcite , a result which seems to contradict our statement that the skyrmion possesses a special zero mode and has noninertial character .",
    "it is therefore important to make a detailed comparison with the interesting findings of ref .",
    "[ ] , as we do in the following .",
    "an analysis of the normal modes indicates that the inertial term results in this case from the positive mode @xmath491 @xcite . despite its finite frequency",
    ", this mode gives rise to a displacement of the skyrmion similar to that of the @xmath447 zero mode , albeit with a concomitant change of the skyrmion configuration ( see fig .",
    "[ fig : skyrmionxy](b ) ) .",
    "a derivation of the equation of motion of the skyrmion was given in the lagrangian formalism in ref .",
    "here we reproduce this result in the hamiltonian formalism and show how the parameters @xmath479 and @xmath478 of the equation of motion can be obtained immediately from the normal - mode calculation .    the crucial observation , which also underlies the derivation in ref .",
    "[ ] , is that if we define the position of the skyrmion as @xmath492 as was done in ref .",
    "[ ] , then not only the @xmath447 zero mode ( see fig .  [",
    "fig : skyrmionxy](a ) ) but also the @xmath491 mode ( see fig .  [",
    "fig : skyrmionxy](b ) ) , which is a positive mode , generates a change in position .",
    "in fact , we find from our normal - mode calculation that @xmath493 where @xmath494 are the canonical momentum and coordinate corresponding to the special zero mode @xmath447 , @xmath495 correspond to the positive mode @xmath491 , @xmath496 is the position of the skyrmion in the equilibrium configuration and @xmath387 is a constant that can be obtained easily from the calculated normal modes . in our calculation",
    ", we find @xmath497 .",
    "since the system is rotationally invariant , the normal modes output by the computer code may be oriented in any direction but we can always rotate them to satisfy eq .  .",
    "since we consider only the modes @xmath498 that couple to position , the unperturbed hamiltonian is given , to second order , by ( see eq .  ) @xmath499 where @xmath215 is the angular frequency of the positive mode @xmath491 ( in our example , @xmath500 ) .",
    "there is no energy term associated with the special zero mode @xmath447 . if we introduce an external potential that depends only on the position @xmath501 , eq .",
    "becomes @xmath502 using hamilton s equations , eq .",
    "gives @xmath503 from which it follows that @xmath504 again taking the time derivative and applying hamilton s equations , this becomes @xmath505 these equations of motion are equivalent to eq .",
    "3 in ref .",
    "[ ] if we set @xmath506 the equations of motion consist of a ` gyrocoupling ' term , which is also present in thiele s equation , and an additional inertial term , which gives a contribution to the acceleration proportional to the force . for the parameters used in our example , we find @xmath507 and @xmath508 . for @xmath479 ,",
    "an analytical expression was given in refs .",
    "[ ] and  [ ] , with which our calculated value is in excellent agreement . from eqs .",
    "and   we also recover @xmath509 , which is indeed the frequency of the @xmath491 mode found in eq .  4 in ref .",
    "[ ] in the absence of an external potential ( set @xmath510 in that equation ) .",
    "notice that the above derivation does not contradict the general statement made in subsec .",
    "[ sec : inertial ] that a system with a special zero mode should have noninertial dynamics . in eq .",
    ", we defined the position @xmath511 in terms of a perfect translation of the magnetic structure . the positive mode @xmath491 , however , simultaneously induces a change in the configuration of the skyrmion and is not a perfect translation .",
    "in fact , the @xmath491 mode causes the spins in the center of the circular domain wall to deviate from their bloch - type equilibrium orientation , which is tangential to the domain wall .",
    "this mode therefore does not represent a change in @xmath511 , while it does represent a change in the skyrmion position @xmath501 in the sense of eq .  .",
    "if we define the position according to eq .",
    ", one obtains the partially inertial behavior derived above . in many practical situations",
    "@xmath501 is the right definition of position , since the effective potential couples to the location of the bubble domain and is mostly insensitive to the domain wall .",
    "however , on timescales much longer than @xmath215 the cyclic effect of the positive mode on the position averages out , and @xmath511 is again the best representation of the position of the skyrmion .",
    "if we introduce damping ( @xmath512 ) , this has an effect not only on the amplitudes of the modes , which now decay in time , but also on the mode vectors @xmath440 ( see sec .",
    "[ sec : spindamped ] ) .",
    "since for large systems we can usually only calculate a number of the lowest modes of the system , which are of the greatest interest , we are forced to truncate the perturbative expressions  , and   for these corrections to those modes that are available . in principle , this approximation is uncontrolled .",
    "however , we may argue that modes with very different frequencies also have very different characteristic wavelengths and hence have a very small overlap , so that the contribution of high - frequency modes to the damping correction of the low - frequency modes that we are interested in is likely to be negligible . here , we test the accuracy of the damping correction by comparing the actual time evolution of a skyrmion system to the linearized solutions obtained from normal - mode analysis .",
    "this also serves as a test of the expressions  , and  .",
    "color ) accuracy of the linearized solution of an initial - value problem for the llg equation ( see text ) .",
    "( a )  error as a function of the amplitude @xmath21 for zero damping . ( b )  error as a function of the damping parameter @xmath216 for a very small , fixed initial amplitude @xmath513 .",
    "we consider three different levels of correction for damping in the linearized solution .",
    "red :  damping is not taken into account at all .",
    "green :  the decay rate @xmath248 from first - order perturbation theory is taken into account , but the zero - damping modes @xmath47 are used .",
    "blue :  both the modes @xmath514 and the decay rate @xmath248 are corrected to first order of perturbation theory . for a fair comparison between different values of @xmath216",
    ", we have scaled the errors by the decay factor between the initial and final amplitudes , as indicated by the upper horizontal curve .",
    "the lower horizontal line indicates the accuracy of the numerical timestepping solution . ]",
    "we consider the time evolution of an initial configuration @xmath515 , where mode @xmath191 is given an initial amplitude @xmath21 .",
    "the details of the simulated system are specified below . in fig .",
    "[ fig : accuracy ] , we plot the difference between the results of a numerical time integration of the llg equation and the linearized solution or . since the error in the numerical solution can be made very small , we may use this difference to evaluate the accuracy of the normal modes .",
    "the error stems from two sources .",
    "first , the linearization of the llg equation necessary for normal - mode analysis results in an error of second order in the amplitude @xmath21 .",
    "second , the fact that the modes of a damped system are calculated in perturbation theory gives an additional error that depends on the damping parameter @xmath216 .",
    "figure  [ fig : accuracy](a ) shows the error as a function of the amplitude @xmath21 for a conservative spin system ( @xmath516 ) .",
    "we find a quadratic dependence , as expected .",
    "figure  [ fig : accuracy](b ) shows the error as a function of @xmath216 , for an amplitude @xmath21 that is chosen so small that the error from nonlinearity is smaller than the error in the numerical solution .",
    "the error that we see in the plot is thus due to the error in the perturbative solution of the damped modes .",
    "we see that if we do not take damping into account at all , the error in the solution is of first order in @xmath216 , as expected .",
    "if we take damping into account by using the calculated decay rate @xmath248 , but without correcting the modes @xmath47 , the error is much smaller , but it is still of first order in @xmath216 . if we also correct the modes @xmath514 , so that we use the full first - order perturbation theory , we get an error of second order in @xmath216 .",
    "notice that we get this order of accuracy even though we use only the contributions of the lowest modes to the perturbative correction .",
    "we conclude that , at least in this case , any first - order error due to this truncation is so small as to be insignificant .    the results in fig .",
    "[ fig : accuracy ] are obtained in a system of @xmath517 spins ( square lattice ) with uniaxial anisotropy ( @xmath518 ) and the dm interaction ( @xmath519 ) .",
    "we use an equilibrium configuration @xmath93 containing a single skyrmion .",
    "after relaxation , the skyrmion is similar to the one in fig .",
    "[ fig : skyrmionxy ] but has a different radius ( owing to the different interaction parameters used ) .",
    "we construct a configuration @xmath515 in which the second mode ( @xmath520 , @xmath521 ) is given a finite initial amplitude @xmath21 .",
    "the magnitudes of the magnetic moments are normalized to @xmath218 .",
    "we then numerically integrate the llg equation starting from this initial configuration , using the implicit - midpoint timestepping scheme @xcite with @xmath522 where @xmath415 .",
    "the simulated time is @xmath523 .",
    "the above results suggest that it is useful to take into account damping in a calculation of the normal modes . using the expressions in sec .",
    "[ sec : spindamped ] , this can be done relatively easily and at a low computational cost . it is already very useful to take into account the decay rate @xmath248 calculated to first order .",
    "an even better accuracy can be achieved by also using the first - order corrections to the modes @xmath514 .",
    "we find that in practice , we get an error of second order in @xmath216 in the time evolution of a low - frequency mode even when only a relatively small set of other low - frequency modes were used to calculate the correction .",
    "the results also suggest that it is unnecessary to go beyond first - order perturbation theory for damping unless @xmath216 is unusually large .",
    "using explicitly the symplectic structure of the dynamical spin system , we have developed a method that allows us to solve the magnetic normal - mode problem in a very general situation , with the only assumption that the equilibrium magnetic structure corresponds to a local minimum of the hamiltonian .",
    "the examples we have considered ( 1d and 2d domain walls , skyrmions ) clearly demonstrate that zero modes are an essential part of this normal - mode analysis and can be very useful for understanding dynamics .",
    "systems with zero modes were difficult to treat within the framework of previous approaches for the magnetic normal - mode problem . to our knowledge , all previous approaches assume that the dynamical matrix of the spin system is diagonalizable .",
    "this is not the case when inertial zero modes are present , which may occur even for the 1d domain wall .",
    "our approach allows one to calculate , in an efficient and scalable manner , all magnetic normal modes , including the spin - wave modes and those modes that are related , for example , to the motion of localized or extended defects ( domain walls , skyrmions ,   ) . for the latter case",
    ", we give a clear and computationally efficient procedure to calculate the parameters that determine the motion under external forces , such as effective masses .",
    "last but not least , we have developed an efficient perturbation scheme to take into account dissipation effects and calculate dynamical magnetic susceptibilities .",
    "we believe that this approach can be useful in many further problems of spin dynamics , especially those dealing with the motion of skyrmions and other defects in the magnetic configuration under an external field , their collision ( momentum transfer ) , pinning , dissipation , and so on .",
    "in this appendix , we investigate the general properties of linear and nonlinear hamiltonian systems and their normal modes . an advantage of our general approach is that it _ explains why _ it is possible to reduce the magnetic normal - mode problem to the hdgep : this is a natural consequence of the symplectic structure of the conservative spin system .",
    "moreover , it means that the same method may be reused for other kinds of hamiltonian systems .",
    "the best - known example of a linear hamiltonian system is a set of point masses coupled by harmonic springs . for this system",
    "the normal - mode problem can be reduced to the symmetric definite generalized eigenvalue problem ( sdgep ) in an obvious way ( see subsec .",
    "a.[app : harmpointmass ] ) .",
    "however , the general normal - mode problem of linear hamiltonian systems is much richer @xcite .",
    "we consider here the normal - mode problem of a linear hamiltonian system with a postive semidefinite hamiltonian , as results from the linearization of a general hamiltonian system near an energy minimum .",
    "this appendix is organized as follows . in subsec .",
    "a.[app : linhamsys ] , we reproduce the definition of a linear hamiltonian system and consider the types of normal modes that it may have .",
    "we also explain how the hamiltonian structure can be used to efficiently perform mode analysis on a given state vector once the normal modes of the system have been calculated . for comparison , we discuss the well - known special case of a system of coupled point masses in subsec .",
    "a.[app : harmpointmass ] . in subsec .",
    "a.[app : genhamsys ] , we generalize the results to a nonlinear hamiltonian system , possibly defined on a poisson manifold rather than a symplectic manifold .",
    "we show that the linearization of a general hamiltonian system near a local energy minimum results in a linear hamiltonian system with a positive - semidefinite matrix @xmath28 ( defined in sec .",
    "[ sec : hamsysbrief ] ) .",
    "let us first reproduce the definition of a linear hamiltonian system on the vector space @xmath32 . fix some arbitrary basis set @xmath524 , and let @xmath525 represent the coefficients of a vector @xmath484 in this basis .",
    "let the matrix @xmath9 be antisymmetric ( @xmath526 ) and invertible .",
    "( we will relax the latter condition in subsec .",
    "a.[app : genhamsys ] . ) then the _ symplectic form _ @xmath527 defines a symplectic structure on @xmath32 .",
    "since symplectic forms are bilinear , eq .   fixes the value of the form for any pair of vectors .",
    "the symplectic structure induces a _ poisson bracket _",
    "@xmath528 between the variables @xmath529 ; more generally , for any two functions @xmath530 , @xmath531 the condition that @xmath9 be invertible ensures that the symplectic form on @xmath32 is _ nondegenerate_. in the special case that the @xmath12 with @xmath532 represent canonical momenta and the @xmath12 with @xmath533 represent the corresponding canonical coordinates , @xmath9 takes the familiar form @xmath534\\text{,}\\ ] ] where @xmath535 is the identity matrix , and in particular , @xmath9 is orthogonal ( @xmath536 , where we define @xmath537 ) ; but we shall not make this assumption in this paper .",
    "it is always possible in principle to construct a system of canonical momenta and coordinates of a symplectic vector space .",
    "let us write our momenta and coordinates as linear combinations @xmath538 of the variables @xmath12 for certain vectors @xmath539 and @xmath540 . by definition , we must have @xmath541 and @xmath542 for all @xmath543 . using eq .",
    ", this can be rewritten as            let us return to the original system of variables @xmath525 ( not necessarily canonical ) of our symplectic vector space .",
    "we define a ( time - invariant ) hamiltonian function @xmath548 where @xmath549 is symmetric . using the generalized form of hamilton s equations and the properties of poisson brackets ,",
    "we now derive the equation of motion @xmath550 where the dot denotes the time derivative .",
    "we may rewrite eq .",
    "as @xmath551 with @xmath552 we see that for a linear hamiltonian system , @xmath553 is symmetric .",
    "conversely , if a given matrix @xmath8 is such that @xmath13 is symmetric ( or equivalently , if @xmath554 ) , it is is called a _ hamiltonian matrix _ @xcite .",
    "the dynamical system is then a linear hamiltonian system on the symplectic vector space defined by @xmath9 . in subsec .",
    "a.[app : genhamsys ] , we generalize the result that @xmath13 is symmetric to hamiltonian systems that are nonlinear or for which @xmath9 is not necessarily invertible .",
    "the matrix @xmath8 describes the dynamical behavior of the linear hamiltonian system .",
    "this matrix is not necessarily diagonalizable @xcite ; its jordan normal form may contain jordan blocks of high order .",
    "moreover , the eigenvalues of these blocks , which often but not always appear in pairs or quadruples , may be zero , real , imaginary or complex .",
    "linear hamiltonian systems may thus display a wide variety of inequivalent types of motion .",
    "an exhaustive list of possibilities is given in ref .",
    "[ ] . in this paper , we restrict ourselves to systems where @xmath13 is positive semidefinite .",
    "even though this condition considerably limits the forms the normal modes may take , we shall see that three inequivalent types still need to be distinguished .",
    "it can be shown that any linear hamiltonian system admits a special symplectic basis in which the hamiltonian takes its _ normal form _ @xcite . in terms of the momenta @xmath555 and coordinates @xmath556 that correspond to this special symplectic basis , the hamiltonian is a direct sum of simple terms , each of which belongs to one of the families listed in ref .",
    "note that many of those types of irreducible terms depend on not just one but two or more pairs of canonical momenta and coordinates .",
    "here we consider hamiltonians that are positive semidefinite , for which the possibilities are more limited . indeed",
    ", we have verified that for all but three types , the irreducible term can not be positive semidefinite by finding a counterexample where the term takes a negative value .",
    "the only three exceptions , which are positive semidefinite , are      where in eq .",
    ", @xmath558 ; a term of this type is in fact positive definite .",
    "we introduce the names _ positive _ , _ special zero _ and _ inertial zero _ respectively for the three types of terms that may appear in the normal form of a positive - semidefinite hamiltonian .",
    "it follows immediately from eqs .   and   that eq",
    ".   corresponds to a positive normal mode with @xmath562 , that eq",
    ".   corresponds to a special zero normal mode and that eq",
    ".   corresponds to a inertial zero normal mode , as defined in sec .",
    "[ sec : hamsysbrief ] , if we set @xmath563 .",
    "an important practical consequence of the fact that the normal modes of a hamiltonian system form a symplectic basis is that we have a direct expression for the decomposition of an arbitrary state vector into a linear combination of the normal modes .",
    "while the special zero normal mode can be interpreted as the @xmath564 limit of the positive normal mode , the inertial zero normal mode is fundamentally different",
    ". one might interpret it as the @xmath564 limit of @xmath565 which for @xmath49 is equivalent to eq .",
    "if one sets @xmath566 and @xmath567 .",
    "notice that even if the original dynamical variables @xmath12 represent canonical momenta and coordinates ( which is not necessary ) , the special canonical momenta @xmath555 and canonical coordinates @xmath556 of the normal form are still , in principle , linear combinations of _ all _ of the @xmath12 .",
    "there is thus no guarantee that @xmath555 is a linear combination of the original momenta , or that @xmath556 is a linear combination of the original coordinates , unless the system is of the special form discussed in subsec .",
    "a.[app : harmpointmass ] .      the variety in the types of dynamics that linear hamiltonian systems display ( see subsec .",
    "a.[app : linhamsys ] and ref .",
    "[ ] ) may seem surprising .",
    "such variety is not seen in the archetypal example of a linear hamiltonian system , a collection of point masses coupled by harmonic springs , for which it is obvious how the normal - mode problem can be cast in the form of a sdgep .",
    "we shall see that this type of system is considerably simplified by the special structure of its hamiltonian , which is not present in all linear hamiltonian systems .",
    "we discuss the system of coupled oscillators here to show how it is special and to explain why the most common method for solving the normal - mode problem can not be used in the more general case discussed in sec .",
    "[ sec : hamsysbrief ] and subsec .",
    "a.[app : linhamsys ] .",
    "the hamiltonian of a system of harmonically coupled point masses is given by @xmath568 , where @xmath1 is the _ force - constant matrix _ and @xmath2 is the _ mass matrix_. the matrix @xmath2 is positive definite ; both matrices are symmetric . in the simplest case",
    ", we have @xmath569 , where @xmath489 is the mass of a single particle . the variables @xmath113 and @xmath111 represent the momentum and the displacement of particle @xmath78 .",
    "( in multidimensional systems , we let @xmath91 represent the spatial direction as well as the particle index ; this does not affect the mathematical structure . )",
    "if we write the state of the system as a single vector @xmath570 \\in \\mathbb{r}^{2n}\\text{,}\\ ] ] the matrix @xmath9 takes its standard form , since the variables @xmath113 and @xmath111 form a canonical system .",
    "the hamiltonian takes the form if we set @xmath571\\text{.}\\ ] ] notice that @xmath549 is block diagonal : the hamiltonian does not contain any terms that couple coordinates to momenta .",
    "the equation of motion is given by @xmath572 = m \\left[\\begin{array}{c } p \\\\",
    "q \\end{array}\\right ] = \\left[\\begin{array}{cc } 0 & -d \\\\ s^{-1 } & 0 \\end{array}\\right ]   \\left[\\begin{array}{c } p \\\\",
    "q \\end{array}\\right]\\text{,}\\ ] ] where we have used eq .  .",
    "the structure of eq .",
    "is such that we can derive equations of motion for the momenta and for the coordinates separately . for the coordinates",
    ", we have @xmath573 the fundamental solutions of this equation may be found by calculating the eigenvectors @xmath574 , which satisfy @xmath575 .",
    "this equation is equivalent to the sdgep @xmath576 if we assume that the hamiltonian is positive semidefinite , so that the the classification of subsec .",
    "a.[app : linhamsys ] is applicable , then @xmath1 must also be positive semidefinite .",
    "we have that @xmath577 , and the vector pair @xmath578 , \\left[\\begin{array}{c } 0 \\\\ q^ * \\end{array}\\right ] \\right)\\ ] ] satisfies eq .   with @xmath579 .",
    "if @xmath49 , this is a positive normal mode ; if @xmath580 , it is a inertial zero normal mode .",
    "notice that special zero normal modes do not occur in a system of coupled point masses .",
    "we see that the normal - mode problem of a system of coupled point masses can be reduced to the sdgep , as is well known .",
    "the same is true for the normal - mode problems of the wave equation or in elasticity theory , which have a similar mathematical structure ( and are in a sense continuum analogues of systems of harmonically coupled masses ) .",
    "however , the same reduction can not be applied to arbitrary linear hamiltonian systems .",
    "what makes the system of coupled point masses special is that      [ itm : reqsepham ] in this canonical system , the hamiltonian is the sum of a kinetic - energy term , which depends only on the momenta , and a potential - energy term , which depends only on the coordinates ; and      as for the spin system , while it is not hard to construct a system of canonical momenta and coordinates ( condition  [ itm : reqnatsys ] ; see ref .  [ ] ) , in this system the hamiltonian generally does not separate into a kinetic - energy and a potential - energy part ( condition  [ itm : reqsepham ] ) , especially if the equilibrium configuration is not collinear .",
    "one might remark that if the hamiltonian is positive semidefinite a system of momenta and coordinates that satisfies condition  [ itm : reqsepham ] must exist : such a system is a by - product of the solution of the normal - mode problem ( see subsec .",
    "a.[app : linhamsys ] ) .",
    "the issue , of course , is that we do not know this system when we start .",
    "moreover , the kinetic - energy term is not guaranteed to be positive definite ( condition  [ itm : reqposdef ] ) unless the hamiltonian is positive definite .",
    "section  [ sec : redhdgep ] presents a way in which the normal - mode problem of any linear hamiltonian system can be reduced to the hdgep , provided that its hamiltonian is positive semidefinite .      in this subsection , we generalize the approach of subsec .",
    "a.[app : linhamsys ] in two ways .",
    "first , we allow the hamiltonian system to be nonlinear .",
    "second , we no longer require that the matrix @xmath9 defining the poisson bracket at @xmath5 is invertible . in the language of symplectic geometry , the latter generalization means that the hamiltonian system may be defined on a poisson manifold rather than a symplectic manifold .",
    "while any symplectic manifold is also a poisson manifold , the converse is not true .",
    "the spin system in cartesian coordinates ( see sec .",
    "[ sec : spincons ] ) is an important example .",
    "we shall show that even under these relaxed conditions , linearization of the equation of motion of a general hamiltonian system near an equilibrium point @xmath581 results in a linear hamiltonian system .",
    "in particular , we shall show that the matrix @xmath13 ( see sec .  [ sec : hamsysbrief ] ) is symmetric .",
    "moreover , we show that @xmath28 can be interpreted as the hessian matrix at the equilibrium point of the restriction of the hamiltonian function to the symplectic leaf that contains @xmath5 .",
    "this implies that @xmath28 is indeed guaranteed to be positive semidefinite , as we require , provided that we linearize at a constrained local minimum of the hamiltonian .",
    "we fix a nonsingular local system of variables @xmath7 in such a way that @xmath581 is an equilibrium point . in this system of variables",
    ", we expand the hamiltonian @xmath34 to second order in @xmath22 as @xmath582 for a constant scalar @xmath583 , vector @xmath584 , and symmetric matrix @xmath585 .",
    "we expand the poisson bracket to first order as @xmath586 the properties of the poisson bracket ( antisymmetry , jacobi identity ) give the following conditions on the coefficients of this expansion : @xmath587 must be antisymmetric ( @xmath588 ) ; @xmath589 must be antisymmetric in the first two indices ( @xmath590 ) ; and we must have @xcite @xmath591 the last condition follows from the jacobi identity , @xmath592 which holds for any poisson bracket @xmath593 . from eq .  , we get @xmath594 since this expression holds at any point @xmath22",
    ", we obtain eq .   by collecting the constant parts of the three cyclic permutations of it that appear in eq .  .",
    "using eqs .   and   and the general properties of poisson brackets , we derive the equation of motion to first order from the generalized hamilton equations , @xmath595 where @xmath596 equation   may be considered as the equivalent of eq .",
    "for a general hamiltonian system . since @xmath597 at @xmath598 , we must have @xmath599 . from this fact and eq .",
    ", we can derive that @xmath13 is symmetric , as follows .",
    "we may write @xmath600 , where @xmath601 is given by @xmath602 and @xmath603 is given by @xmath604 @xmath601 is obviously symmetric ( @xmath605 is symmetric ) .",
    "we can see that @xmath603 is symmetric by rewriting it as @xmath606 where we have used eq .  .",
    "if @xmath5 is an equilibrium position , eq .   implies @xmath607 and the last term vanishes .",
    "the other two terms together are explicitly symmetric under @xmath608 .    except for the fact that @xmath9 is not necessarily invertible",
    ", we could conclude from the symmetry of @xmath13 that the linearization @xmath609 of a general hamiltonian system near an equilibrium point is a linear hamiltonian system in the sense of subsec .",
    "a.[app : linhamsys ] . to be explicit , the matrix @xmath9 of this linear hamiltonian system is defined , according to eq .  , by @xmath610 which is the value of the poisson bracket between @xmath11 and @xmath12 at @xmath5 , while the symmetric matrix @xmath13 is given by @xmath611 since @xmath9 is antisymmetric ,",
    "its rank is always even .",
    "we write @xmath612 . if @xmath613 ( @xmath9 is not invertible )",
    ", we can make @xmath9 invertible by interpreting the matrices @xmath9 and @xmath13 as _ restricted _ to the @xmath20-dimensional image space of @xmath9 . in the notation of sec .",
    "[ sec : hamsysbrief ] , we get @xmath27 and @xmath28",
    ". we may do this because the image space of @xmath13 is contained in the image space of @xmath9 .",
    "thus , the matrices @xmath28 and @xmath27 together define a proper linear hamiltonian system .",
    "our method for the normal - mode problem requires that @xmath28 be positive semidefinite ( see sec .",
    "[ sec : redhdgep ] ) . we can show that it is if @xmath5 is a ( constrained ) local minimum of the hamiltonian @xmath34 . for simplicity",
    ", we first consider the case @xmath614 ( @xmath9 is invertible ) .",
    "if @xmath9 is invertible , we have @xmath615 , so that @xmath616 .",
    "evidently , @xmath13 is positive ( semi)definite if and only if @xmath21 , the hessian matrix of @xmath34 , is positive ( semi)definite .",
    "consequently , if @xmath5 is a local minimum of @xmath34 , then @xmath13 is positive semidefinite .    for @xmath613 ,",
    "the dynamical matrix is no longer determined only by the hessian matrix @xmath21 of @xmath34 ; there is an additional @xmath108-dependent term , which is essential .",
    "we shall see that the matrix @xmath28 can be interpreted as the hessian matrix of the restriction of the hamiltonian function @xmath34 to a certain @xmath20-dimensional submanifold containing @xmath5 .",
    "for example , while the hamiltonian @xmath617 has no local minimum on @xmath618 , is has a constrained minimum at @xmath619 on the set @xmath620 . for positive semidefiniteness of @xmath28",
    "we do not require that @xmath5 be an actual local minimum of @xmath34 ; it is sufficient that @xmath5 be a _ constrained _ local minimum on this submanifold . to define the relevant submanifold in a general setting ,",
    "it is necessary to use some elements from the theory of symplectic structures and poisson structures @xcite .    in a symplectic manifold ,",
    "any point ( that is , any state of the system ) may be reached from any other point by following the trajectory generated by a suitably chosen hamiltonian function @xmath34 , or a finite sequence of such trajectories . in a poisson manifold , this is not necessarily the case . however , by the splitting theorem on poisson manifolds @xcite , a poisson manifold can be divided into _ equivalence classes _ of points for which this is possible .",
    "these equivalence classes are symplectic submanifolds of the poisson manifold and are called _",
    "symplectic leaves_. two points of a poisson manifold are in the same symplectic leaf if one can get from one point to the other through a finite sequence of trajectories induced by hamiltonian functions .",
    "for example , consider a conservative spin system ( see sec .",
    "[ sec : spincons ] ) with a single spin @xmath621 , which is governed by the equation of motion @xmath622 .",
    "since this equation conserves @xmath623 , a spin in position @xmath624 will never end up in position @xmath625 , regardless of the choice of @xmath34 .",
    "however , it may at some point in time reach @xmath626 , for instance if the hamiltonian is given by @xmath627 .",
    "thus , the poisson manifold of the conservative single - spin system ( that is , @xmath618 equipped with the spin poisson bracket ; see sec .",
    "[ sec : spincons ] ) splits into symplectic leaves of the form @xmath628 for @xmath17 .",
    "it can be shown that the @xmath20-dimensional symplectic leaf containing the equilibrium point @xmath5 can locally be parametrized by a vector @xmath629 , which we require to lie in the image space of @xmath587 , as @xmath630 if we assume that the poisson bracket of the poisson manifold is of the form . by substitution of this expression into",
    ", we find that in terms of @xmath631 , the hamiltonian becomes @xmath632 here we have used that @xmath633 : the fact that @xmath631 lies in the image space of @xmath9 guarantees @xmath634 in eq .  . if @xmath5 is an equilibrium point , the linear term in eq .",
    "vanishes ( @xmath635 ) .",
    "the matrix of the quadratic term in eq .  , which is identical to the hessian matrix of the hamiltonian @xmath34 restricted to the symplectic leaf , is identical to @xmath28 .",
    "( we must write the angular brackets @xmath327 here because @xmath631 was assumed to lie in the image space of @xmath9 . ) thus , if @xmath5 is a local minimum of @xmath34 on the symplectic leaf that contains the point @xmath5 , the matrix @xmath28 is positive semidefinite and the method presented in sec .",
    "[ sec : redhdgep ] can be used .",
    "60ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]",
    " + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty @noop _ _ ( ,  ) @noop _ _ ,  ed .",
    "( ,  ) in @noop _ _ ,  ( ,  )  pp .",
    "@noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) `` , ''   ( ,  )  chap .  , pp .",
    "@noop * * ,   ( ) @noop _ _ ( ,  ) @noop _ _ , vol .",
    "( , ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) in  @noop _ _ ,  ( ,  )   @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * , ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop _ _ ,  ed .",
    "( ,  )  pp .   , , ,",
    ",  and  ,  eds . ,  @noop _ _  ( ,  )  chap .   in  @noop",
    "_ _ ,  ( ,  )  chap .",
    "@noop _ _ ,  ed .",
    "( ,  ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) _ _ ,  @noop ph.d . thesis ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * , ( ) @noop _ _ ,  ( ,  ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( )"
  ],
  "abstract_text": [
    "<S> the presence of topological defects in magnetic media often leads to normal modes with zero frequency ( zero modes ) . </S>",
    "<S> such modes are crucial for long - time behavior , describing , for example , the motion of a domain wall as a whole . </S>",
    "<S> conventional numerical methods to calculate the spin - wave spectrum in magnetic media are either inefficient or they fail for systems with zero modes . </S>",
    "<S> we present a new efficient computational scheme that reduces the magnetic normal - mode problem to a generalized hermitian eigenvalue problem also in the presence of zero modes . </S>",
    "<S> we apply our scheme to several examples , including two - dimensional domain walls and skyrmions , and show how the effective masses that determine the dynamics can be calculated directly . </S>",
    "<S> these systems highlight the fundamental distinction between the two types of zero modes that can occur in spin systems , which we call _ special _ and _ inertial _ zero modes . </S>",
    "<S> our method is suitable for both conservative and dissipative systems . for the latter case , </S>",
    "<S> we present a perturbative scheme to take into account damping , which can also be used to calculate dynamical susceptibilities . </S>"
  ]
}